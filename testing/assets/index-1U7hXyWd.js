(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function o(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=o(s);fetch(s.href,i)}})();function Pu(e){const t=Object.create(null);for(const o of e.split(","))t[o]=1;return o=>o in t}const Ot={},Mi=[],Xo=()=>{},mf=()=>!1,jr=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Du=e=>e.startsWith("onUpdate:"),fn=Object.assign,Ru=(e,t)=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},mm=Object.prototype.hasOwnProperty,Pt=(e,t)=>mm.call(e,t),it=Array.isArray,Ai=e=>Nl(e)==="[object Map]",zi=e=>Nl(e)==="[object Set]",xd=e=>Nl(e)==="[object Date]",ut=e=>typeof e=="function",Jt=e=>typeof e=="string",es=e=>typeof e=="symbol",Rt=e=>e!==null&&typeof e=="object",gf=e=>(Rt(e)||ut(e))&&ut(e.then)&&ut(e.catch),yf=Object.prototype.toString,Nl=e=>yf.call(e),gm=e=>Nl(e).slice(8,-1),kf=e=>Nl(e)==="[object Object]",Zr=e=>Jt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,pl=Pu(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),qr=e=>{const t=Object.create(null);return(o=>t[o]||(t[o]=e(o)))},ym=/-\w/g,Ro=qr(e=>e.replace(ym,t=>t.slice(1).toUpperCase())),km=/\B([A-Z])/g,La=qr(e=>e.replace(km,"-$1").toLowerCase()),Wr=qr(e=>e.charAt(0).toUpperCase()+e.slice(1)),Mc=qr(e=>e?`on${Wr(e)}`:""),ka=(e,t)=>!Object.is(e,t),pr=(e,...t)=>{for(let o=0;o<e.length;o++)e[o](...t)},_f=(e,t,o,a=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:a,value:o})},Kr=e=>{const t=parseFloat(e);return isNaN(t)?e:t},_m=e=>{const t=Jt(e)?Number(e):NaN;return isNaN(t)?e:t};let Id;const Jr=()=>Id||(Id=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Qe(e){if(it(e)){const t={};for(let o=0;o<e.length;o++){const a=e[o],s=Jt(a)?Lm(a):Qe(a);if(s)for(const i in s)t[i]=s[i]}return t}else if(Jt(e)||Rt(e))return e}const bm=/;(?![^(]*\))/g,wm=/:([^]+)/,Cm=/\/\*[^]*?\*\//g;function Lm(e){const t={};return e.replace(Cm,"").split(bm).forEach(o=>{if(o){const a=o.split(wm);a.length>1&&(t[a[0].trim()]=a[1].trim())}}),t}function ce(e){let t="";if(Jt(e))t=e;else if(it(e))for(let o=0;o<e.length;o++){const a=ce(e[o]);a&&(t+=a+" ")}else if(Rt(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}const Sm="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",xm=Pu(Sm);function bf(e){return!!e||e===""}function Im(e,t){if(e.length!==t.length)return!1;let o=!0;for(let a=0;o&&a<e.length;a++)o=si(e[a],t[a]);return o}function si(e,t){if(e===t)return!0;let o=xd(e),a=xd(t);if(o||a)return o&&a?e.getTime()===t.getTime():!1;if(o=es(e),a=es(t),o||a)return e===t;if(o=it(e),a=it(t),o||a)return o&&a?Im(e,t):!1;if(o=Rt(e),a=Rt(t),o||a){if(!o||!a)return!1;const s=Object.keys(e).length,i=Object.keys(t).length;if(s!==i)return!1;for(const l in e){const u=e.hasOwnProperty(l),d=t.hasOwnProperty(l);if(u&&!d||!u&&d||!si(e[l],t[l]))return!1}}return String(e)===String(t)}function Ou(e,t){return e.findIndex(o=>si(o,t))}const wf=e=>!!(e&&e.__v_isRef===!0),C=e=>Jt(e)?e:e==null?"":it(e)||Rt(e)&&(e.toString===yf||!ut(e.toString))?wf(e)?C(e.value):JSON.stringify(e,Cf,2):String(e),Cf=(e,t)=>wf(t)?Cf(e,t.value):Ai(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((o,[a,s],i)=>(o[Ac(a,i)+" =>"]=s,o),{})}:zi(t)?{[`Set(${t.size})`]:[...t.values()].map(o=>Ac(o))}:es(t)?Ac(t):Rt(t)&&!it(t)&&!kf(t)?String(t):t,Ac=(e,t="")=>{var o;return es(e)?`Symbol(${(o=e.description)!=null?o:t})`:e};function $m(e){return e==null?"initial":typeof e=="string"?e===""?" ":e:String(e)}let Dn;class Lf{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Dn,!t&&Dn&&(this.index=(Dn.scopes||(Dn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].pause();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].resume();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].resume()}}run(t){if(this._active){const o=Dn;try{return Dn=this,t()}finally{Dn=o}}}on(){++this._on===1&&(this.prevScope=Dn,Dn=this)}off(){this._on>0&&--this._on===0&&(Dn=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let o,a;for(o=0,a=this.effects.length;o<a;o++)this.effects[o].stop();for(this.effects.length=0,o=0,a=this.cleanups.length;o<a;o++)this.cleanups[o]();if(this.cleanups.length=0,this.scopes){for(o=0,a=this.scopes.length;o<a;o++)this.scopes[o].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function Sf(e){return new Lf(e)}function xf(){return Dn}function Tm(e,t=!1){Dn&&Dn.cleanups.push(e)}let Ht;const Ec=new WeakSet;class If{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Dn&&Dn.active&&Dn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Ec.has(this)&&(Ec.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Tf(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,$d(this),Mf(this);const t=Ht,o=Qo;Ht=this,Qo=!0;try{return this.fn()}finally{Af(this),Ht=t,Qo=o,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Fu(t);this.deps=this.depsTail=void 0,$d(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Ec.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Qc(this)&&this.run()}get dirty(){return Qc(this)}}let $f=0,vl,ml;function Tf(e,t=!1){if(e.flags|=8,t){e.next=ml,ml=e;return}e.next=vl,vl=e}function Bu(){$f++}function Nu(){if(--$f>0)return;if(ml){let t=ml;for(ml=void 0;t;){const o=t.next;t.next=void 0,t.flags&=-9,t=o}}let e;for(;vl;){let t=vl;for(vl=void 0;t;){const o=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(a){e||(e=a)}t=o}}if(e)throw e}function Mf(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Af(e){let t,o=e.depsTail,a=o;for(;a;){const s=a.prevDep;a.version===-1?(a===o&&(o=s),Fu(a),Mm(a)):t=a,a.dep.activeLink=a.prevActiveLink,a.prevActiveLink=void 0,a=s}e.deps=t,e.depsTail=o}function Qc(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Ef(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Ef(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Sl)||(e.globalVersion=Sl,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!Qc(e))))return;e.flags|=2;const t=e.dep,o=Ht,a=Qo;Ht=e,Qo=!0;try{Mf(e);const s=e.fn(e._value);(t.version===0||ka(s,e._value))&&(e.flags|=128,e._value=s,t.version++)}catch(s){throw t.version++,s}finally{Ht=o,Qo=a,Af(e),e.flags&=-3}}function Fu(e,t=!1){const{dep:o,prevSub:a,nextSub:s}=e;if(a&&(a.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=a,e.nextSub=void 0),o.subs===e&&(o.subs=a,!a&&o.computed)){o.computed.flags&=-5;for(let i=o.computed.deps;i;i=i.nextDep)Fu(i,!0)}!t&&!--o.sc&&o.map&&o.map.delete(o.key)}function Mm(e){const{prevDep:t,nextDep:o}=e;t&&(t.nextDep=o,e.prevDep=void 0),o&&(o.prevDep=t,e.nextDep=void 0)}let Qo=!0;const Pf=[];function Us(){Pf.push(Qo),Qo=!1}function zs(){const e=Pf.pop();Qo=e===void 0?!0:e}function $d(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const o=Ht;Ht=void 0;try{t()}finally{Ht=o}}}let Sl=0;class Am{constructor(t,o){this.sub=t,this.dep=o,this.version=o.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Uu{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!Ht||!Qo||Ht===this.computed)return;let o=this.activeLink;if(o===void 0||o.sub!==Ht)o=this.activeLink=new Am(Ht,this),Ht.deps?(o.prevDep=Ht.depsTail,Ht.depsTail.nextDep=o,Ht.depsTail=o):Ht.deps=Ht.depsTail=o,Df(o);else if(o.version===-1&&(o.version=this.version,o.nextDep)){const a=o.nextDep;a.prevDep=o.prevDep,o.prevDep&&(o.prevDep.nextDep=a),o.prevDep=Ht.depsTail,o.nextDep=void 0,Ht.depsTail.nextDep=o,Ht.depsTail=o,Ht.deps===o&&(Ht.deps=a)}return o}trigger(t){this.version++,Sl++,this.notify(t)}notify(t){Bu();try{for(let o=this.subs;o;o=o.prevSub)o.sub.notify()&&o.sub.dep.notify()}finally{Nu()}}}function Df(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let a=t.deps;a;a=a.nextDep)Df(a)}const o=e.dep.subs;o!==e&&(e.prevSub=o,o&&(o.nextSub=e)),e.dep.subs=e}}const Cr=new WeakMap,ei=Symbol(""),eu=Symbol(""),xl=Symbol("");function On(e,t,o){if(Qo&&Ht){let a=Cr.get(e);a||Cr.set(e,a=new Map);let s=a.get(o);s||(a.set(o,s=new Uu),s.map=a,s.key=o),s.track()}}function Ps(e,t,o,a,s,i){const l=Cr.get(e);if(!l){Sl++;return}const u=d=>{d&&d.trigger()};if(Bu(),t==="clear")l.forEach(u);else{const d=it(e),f=d&&Zr(o);if(d&&o==="length"){const p=Number(a);l.forEach((g,y)=>{(y==="length"||y===xl||!es(y)&&y>=p)&&u(g)})}else switch((o!==void 0||l.has(void 0))&&u(l.get(o)),f&&u(l.get(xl)),t){case"add":d?f&&u(l.get("length")):(u(l.get(ei)),Ai(e)&&u(l.get(eu)));break;case"delete":d||(u(l.get(ei)),Ai(e)&&u(l.get(eu)));break;case"set":Ai(e)&&u(l.get(ei));break}}Nu()}function Em(e,t){const o=Cr.get(e);return o&&o.get(t)}function Ci(e){const t=Tt(e);return t===e?t:(On(t,"iterate",xl),wo(e)?t:t.map(ts))}function Yr(e){return On(e=Tt(e),"iterate",xl),e}function ha(e,t){return Hs(e)?Fs(e)?Ri(ts(t)):Ri(t):ts(t)}const Pm={__proto__:null,[Symbol.iterator](){return Pc(this,Symbol.iterator,e=>ha(this,e))},concat(...e){return Ci(this).concat(...e.map(t=>it(t)?Ci(t):t))},entries(){return Pc(this,"entries",e=>(e[1]=ha(this,e[1]),e))},every(e,t){return Is(this,"every",e,t,void 0,arguments)},filter(e,t){return Is(this,"filter",e,t,o=>o.map(a=>ha(this,a)),arguments)},find(e,t){return Is(this,"find",e,t,o=>ha(this,o),arguments)},findIndex(e,t){return Is(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Is(this,"findLast",e,t,o=>ha(this,o),arguments)},findLastIndex(e,t){return Is(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Is(this,"forEach",e,t,void 0,arguments)},includes(...e){return Dc(this,"includes",e)},indexOf(...e){return Dc(this,"indexOf",e)},join(e){return Ci(this).join(e)},lastIndexOf(...e){return Dc(this,"lastIndexOf",e)},map(e,t){return Is(this,"map",e,t,void 0,arguments)},pop(){return sl(this,"pop")},push(...e){return sl(this,"push",e)},reduce(e,...t){return Td(this,"reduce",e,t)},reduceRight(e,...t){return Td(this,"reduceRight",e,t)},shift(){return sl(this,"shift")},some(e,t){return Is(this,"some",e,t,void 0,arguments)},splice(...e){return sl(this,"splice",e)},toReversed(){return Ci(this).toReversed()},toSorted(e){return Ci(this).toSorted(e)},toSpliced(...e){return Ci(this).toSpliced(...e)},unshift(...e){return sl(this,"unshift",e)},values(){return Pc(this,"values",e=>ha(this,e))}};function Pc(e,t,o){const a=Yr(e),s=a[t]();return a!==e&&!wo(e)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.done||(i.value=o(i.value)),i}),s}const Dm=Array.prototype;function Is(e,t,o,a,s,i){const l=Yr(e),u=l!==e&&!wo(e),d=l[t];if(d!==Dm[t]){const g=d.apply(e,i);return u?ts(g):g}let f=o;l!==e&&(u?f=function(g,y){return o.call(this,ha(e,g),y,e)}:o.length>2&&(f=function(g,y){return o.call(this,g,y,e)}));const p=d.call(l,f,a);return u&&s?s(p):p}function Td(e,t,o,a){const s=Yr(e);let i=o;return s!==e&&(wo(e)?o.length>3&&(i=function(l,u,d){return o.call(this,l,u,d,e)}):i=function(l,u,d){return o.call(this,l,ha(e,u),d,e)}),s[t](i,...a)}function Dc(e,t,o){const a=Tt(e);On(a,"iterate",xl);const s=a[t](...o);return(s===-1||s===!1)&&Xr(o[0])?(o[0]=Tt(o[0]),a[t](...o)):s}function sl(e,t,o=[]){Us(),Bu();const a=Tt(e)[t].apply(e,o);return Nu(),zs(),a}const Rm=Pu("__proto__,__v_isRef,__isVue"),Rf=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(es));function Om(e){es(e)||(e=String(e));const t=Tt(this);return On(t,"has",e),t.hasOwnProperty(e)}class Of{constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,a){if(o==="__v_skip")return t.__v_skip;const s=this._isReadonly,i=this._isShallow;if(o==="__v_isReactive")return!s;if(o==="__v_isReadonly")return s;if(o==="__v_isShallow")return i;if(o==="__v_raw")return a===(s?i?Zm:Uf:i?Ff:Nf).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(a)?t:void 0;const l=it(t);if(!s){let d;if(l&&(d=Pm[o]))return d;if(o==="hasOwnProperty")return Om}const u=Reflect.get(t,o,Kt(t)?t:a);if((es(o)?Rf.has(o):Rm(o))||(s||On(t,"get",o),i))return u;if(Kt(u)){const d=l&&Zr(o)?u:u.value;return s&&Rt(d)?nu(d):d}return Rt(u)?s?nu(u):ii(u):u}}class Bf extends Of{constructor(t=!1){super(!1,t)}set(t,o,a,s){let i=t[o];const l=it(t)&&Zr(o);if(!this._isShallow){const f=Hs(i);if(!wo(a)&&!Hs(a)&&(i=Tt(i),a=Tt(a)),!l&&Kt(i)&&!Kt(a))return f||(i.value=a),!0}const u=l?Number(o)<t.length:Pt(t,o),d=Reflect.set(t,o,a,Kt(t)?t:s);return t===Tt(s)&&(u?ka(a,i)&&Ps(t,"set",o,a):Ps(t,"add",o,a)),d}deleteProperty(t,o){const a=Pt(t,o);t[o];const s=Reflect.deleteProperty(t,o);return s&&a&&Ps(t,"delete",o,void 0),s}has(t,o){const a=Reflect.has(t,o);return(!es(o)||!Rf.has(o))&&On(t,"has",o),a}ownKeys(t){return On(t,"iterate",it(t)?"length":ei),Reflect.ownKeys(t)}}class Bm extends Of{constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const Nm=new Bf,Fm=new Bm,Um=new Bf(!0);const tu=e=>e,ar=e=>Reflect.getPrototypeOf(e);function zm(e,t,o){return function(...a){const s=this.__v_raw,i=Tt(s),l=Ai(i),u=e==="entries"||e===Symbol.iterator&&l,d=e==="keys"&&l,f=s[e](...a),p=o?tu:t?Ri:ts;return!t&&On(i,"iterate",d?eu:ei),{next(){const{value:g,done:y}=f.next();return y?{value:g,done:y}:{value:u?[p(g[0]),p(g[1])]:p(g),done:y}},[Symbol.iterator](){return this}}}}function ir(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Hm(e,t){const o={get(s){const i=this.__v_raw,l=Tt(i),u=Tt(s);e||(ka(s,u)&&On(l,"get",s),On(l,"get",u));const{has:d}=ar(l),f=t?tu:e?Ri:ts;if(d.call(l,s))return f(i.get(s));if(d.call(l,u))return f(i.get(u));i!==l&&i.get(s)},get size(){const s=this.__v_raw;return!e&&On(Tt(s),"iterate",ei),s.size},has(s){const i=this.__v_raw,l=Tt(i),u=Tt(s);return e||(ka(s,u)&&On(l,"has",s),On(l,"has",u)),s===u?i.has(s):i.has(s)||i.has(u)},forEach(s,i){const l=this,u=l.__v_raw,d=Tt(u),f=t?tu:e?Ri:ts;return!e&&On(d,"iterate",ei),u.forEach((p,g)=>s.call(i,f(p),f(g),l))}};return fn(o,e?{add:ir("add"),set:ir("set"),delete:ir("delete"),clear:ir("clear")}:{add(s){!t&&!wo(s)&&!Hs(s)&&(s=Tt(s));const i=Tt(this);return ar(i).has.call(i,s)||(i.add(s),Ps(i,"add",s,s)),this},set(s,i){!t&&!wo(i)&&!Hs(i)&&(i=Tt(i));const l=Tt(this),{has:u,get:d}=ar(l);let f=u.call(l,s);f||(s=Tt(s),f=u.call(l,s));const p=d.call(l,s);return l.set(s,i),f?ka(i,p)&&Ps(l,"set",s,i):Ps(l,"add",s,i),this},delete(s){const i=Tt(this),{has:l,get:u}=ar(i);let d=l.call(i,s);d||(s=Tt(s),d=l.call(i,s)),u&&u.call(i,s);const f=i.delete(s);return d&&Ps(i,"delete",s,void 0),f},clear(){const s=Tt(this),i=s.size!==0,l=s.clear();return i&&Ps(s,"clear",void 0,void 0),l}}),["keys","values","entries",Symbol.iterator].forEach(s=>{o[s]=zm(s,e,t)}),o}function zu(e,t){const o=Hm(e,t);return(a,s,i)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?a:Reflect.get(Pt(o,s)&&s in a?o:a,s,i)}const Vm={get:zu(!1,!1)},Gm={get:zu(!1,!0)},jm={get:zu(!0,!1)};const Nf=new WeakMap,Ff=new WeakMap,Uf=new WeakMap,Zm=new WeakMap;function qm(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Wm(e){return e.__v_skip||!Object.isExtensible(e)?0:qm(gm(e))}function ii(e){return Hs(e)?e:Hu(e,!1,Nm,Vm,Nf)}function zf(e){return Hu(e,!1,Um,Gm,Ff)}function nu(e){return Hu(e,!0,Fm,jm,Uf)}function Hu(e,t,o,a,s){if(!Rt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=Wm(e);if(i===0)return e;const l=s.get(e);if(l)return l;const u=new Proxy(e,i===2?a:o);return s.set(e,u),u}function Fs(e){return Hs(e)?Fs(e.__v_raw):!!(e&&e.__v_isReactive)}function Hs(e){return!!(e&&e.__v_isReadonly)}function wo(e){return!!(e&&e.__v_isShallow)}function Xr(e){return e?!!e.__v_raw:!1}function Tt(e){const t=e&&e.__v_raw;return t?Tt(t):e}function Vu(e){return!Pt(e,"__v_skip")&&Object.isExtensible(e)&&_f(e,"__v_skip",!0),e}const ts=e=>Rt(e)?ii(e):e,Ri=e=>Rt(e)?nu(e):e;function Kt(e){return e?e.__v_isRef===!0:!1}function $(e){return Hf(e,!1)}function Km(e){return Hf(e,!0)}function Hf(e,t){return Kt(e)?e:new Jm(e,t)}class Jm{constructor(t,o){this.dep=new Uu,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=o?t:Tt(t),this._value=o?t:ts(t),this.__v_isShallow=o}get value(){return this.dep.track(),this._value}set value(t){const o=this._rawValue,a=this.__v_isShallow||wo(t)||Hs(t);t=a?t:Tt(t),ka(t,o)&&(this._rawValue=t,this._value=a?t:ts(t),this.dep.trigger())}}function B(e){return Kt(e)?e.value:e}function Lr(e){return ut(e)?e():B(e)}const Ym={get:(e,t,o)=>t==="__v_raw"?e:B(Reflect.get(e,t,o)),set:(e,t,o,a)=>{const s=e[t];return Kt(s)&&!Kt(o)?(s.value=o,!0):Reflect.set(e,t,o,a)}};function Vf(e){return Fs(e)?e:new Proxy(e,Ym)}function Xm(e){const t=it(e)?new Array(e.length):{};for(const o in e)t[o]=eg(e,o);return t}class Qm{constructor(t,o,a){this._object=t,this._key=o,this._defaultValue=a,this.__v_isRef=!0,this._value=void 0,this._raw=Tt(t);let s=!0,i=t;if(!it(t)||!Zr(String(o)))do s=!Xr(i)||wo(i);while(s&&(i=i.__v_raw));this._shallow=s}get value(){let t=this._object[this._key];return this._shallow&&(t=B(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&Kt(this._raw[this._key])){const o=this._object[this._key];if(Kt(o)){o.value=t;return}}this._object[this._key]=t}get dep(){return Em(this._raw,this._key)}}function eg(e,t,o){return new Qm(e,t,o)}class tg{constructor(t,o,a){this.fn=t,this.setter=o,this._value=void 0,this.dep=new Uu(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Sl-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!o,this.isSSR=a}notify(){if(this.flags|=16,!(this.flags&8)&&Ht!==this)return Tf(this,!0),!0}get value(){const t=this.dep.track();return Ef(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function ng(e,t,o=!1){let a,s;return ut(e)?a=e:(a=e.get,s=e.set),new tg(a,s,o)}const lr={},Sr=new WeakMap;let Wa;function og(e,t=!1,o=Wa){if(o){let a=Sr.get(o);a||Sr.set(o,a=[]),a.push(e)}}function sg(e,t,o=Ot){const{immediate:a,deep:s,once:i,scheduler:l,augmentJob:u,call:d}=o,f=P=>s?P:wo(P)||s===!1||s===0?Ds(P,1):Ds(P);let p,g,y,k,_=!1,w=!1;if(Kt(e)?(g=()=>e.value,_=wo(e)):Fs(e)?(g=()=>f(e),_=!0):it(e)?(w=!0,_=e.some(P=>Fs(P)||wo(P)),g=()=>e.map(P=>{if(Kt(P))return P.value;if(Fs(P))return f(P);if(ut(P))return d?d(P,2):P()})):ut(e)?t?g=d?()=>d(e,2):e:g=()=>{if(y){Us();try{y()}finally{zs()}}const P=Wa;Wa=p;try{return d?d(e,3,[k]):e(k)}finally{Wa=P}}:g=Xo,t&&s){const P=g,O=s===!0?1/0:s;g=()=>Ds(P(),O)}const S=xf(),A=()=>{p.stop(),S&&S.active&&Ru(S.effects,p)};if(i&&t){const P=t;t=(...O)=>{P(...O),A()}}let T=w?new Array(e.length).fill(lr):lr;const x=P=>{if(!(!(p.flags&1)||!p.dirty&&!P))if(t){const O=p.run();if(s||_||(w?O.some((F,E)=>ka(F,T[E])):ka(O,T))){y&&y();const F=Wa;Wa=p;try{const E=[O,T===lr?void 0:w&&T[0]===lr?[]:T,k];T=O,d?d(t,3,E):t(...E)}finally{Wa=F}}}else p.run()};return u&&u(x),p=new If(g),p.scheduler=l?()=>l(x,!1):x,k=P=>og(P,!1,p),y=p.onStop=()=>{const P=Sr.get(p);if(P){if(d)d(P,4);else for(const O of P)O();Sr.delete(p)}},t?a?x(!0):T=p.run():l?l(x.bind(null,!0),!0):p.run(),A.pause=p.pause.bind(p),A.resume=p.resume.bind(p),A.stop=A,A}function Ds(e,t=1/0,o){if(t<=0||!Rt(e)||e.__v_skip||(o=o||new Map,(o.get(e)||0)>=t))return e;if(o.set(e,t),t--,Kt(e))Ds(e.value,t,o);else if(it(e))for(let a=0;a<e.length;a++)Ds(e[a],t,o);else if(zi(e)||Ai(e))e.forEach(a=>{Ds(a,t,o)});else if(kf(e)){for(const a in e)Ds(e[a],t,o);for(const a of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,a)&&Ds(e[a],t,o)}return e}function Fl(e,t,o,a){try{return a?e(...a):e()}catch(s){Qr(s,t,o)}}function ns(e,t,o,a){if(ut(e)){const s=Fl(e,t,o,a);return s&&gf(s)&&s.catch(i=>{Qr(i,t,o)}),s}if(it(e)){const s=[];for(let i=0;i<e.length;i++)s.push(ns(e[i],t,o,a));return s}}function Qr(e,t,o,a=!0){const s=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:l}=t&&t.appContext.config||Ot;if(t){let u=t.parent;const d=t.proxy,f=`https://vuejs.org/error-reference/#runtime-${o}`;for(;u;){const p=u.ec;if(p){for(let g=0;g<p.length;g++)if(p[g](e,d,f)===!1)return}u=u.parent}if(i){Us(),Fl(i,null,10,[e,d,f]),zs();return}}ag(e,o,s,a,l)}function ag(e,t,o,a=!0,s=!1){if(s)throw e;console.error(e)}const Kn=[];let hs=-1;const Ei=[];let fa=null,Si=0;const Gf=Promise.resolve();let xr=null;function un(e){const t=xr||Gf;return e?t.then(this?e.bind(this):e):t}function ig(e){let t=hs+1,o=Kn.length;for(;t<o;){const a=t+o>>>1,s=Kn[a],i=Il(s);i<e||i===e&&s.flags&2?t=a+1:o=a}return t}function Gu(e){if(!(e.flags&1)){const t=Il(e),o=Kn[Kn.length-1];!o||!(e.flags&2)&&t>=Il(o)?Kn.push(e):Kn.splice(ig(t),0,e),e.flags|=1,jf()}}function jf(){xr||(xr=Gf.then(Wf))}function Zf(e){it(e)?Ei.push(...e):fa&&e.id===-1?fa.splice(Si+1,0,e):e.flags&1||(Ei.push(e),e.flags|=1),jf()}function Md(e,t,o=hs+1){for(;o<Kn.length;o++){const a=Kn[o];if(a&&a.flags&2){if(e&&a.id!==e.uid)continue;Kn.splice(o,1),o--,a.flags&4&&(a.flags&=-2),a(),a.flags&4||(a.flags&=-2)}}}function qf(e){if(Ei.length){const t=[...new Set(Ei)].sort((o,a)=>Il(o)-Il(a));if(Ei.length=0,fa){fa.push(...t);return}for(fa=t,Si=0;Si<fa.length;Si++){const o=fa[Si];o.flags&4&&(o.flags&=-2),o.flags&8||o(),o.flags&=-2}fa=null,Si=0}}const Il=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Wf(e){try{for(hs=0;hs<Kn.length;hs++){const t=Kn[hs];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Fl(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;hs<Kn.length;hs++){const t=Kn[hs];t&&(t.flags&=-2)}hs=-1,Kn.length=0,qf(),xr=null,(Kn.length||Ei.length)&&Wf()}}let In=null,Kf=null;function Ir(e){const t=In;return In=e,Kf=e&&e.type.__scopeId||null,t}function ze(e,t=In,o){if(!t||e._n)return e;const a=(...s)=>{a._d&&Mr(-1);const i=Ir(t);let l;try{l=e(...s)}finally{Ir(i),a._d&&Mr(1)}return l};return a._n=!0,a._c=!0,a._d=!0,a}function He(e,t){if(In===null)return e;const o=ac(In),a=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[i,l,u,d=Ot]=t[s];i&&(ut(i)&&(i={mounted:i,updated:i}),i.deep&&Ds(l),a.push({dir:i,instance:o,value:l,oldValue:void 0,arg:u,modifiers:d}))}return e}function Va(e,t,o,a){const s=e.dirs,i=t&&t.dirs;for(let l=0;l<s.length;l++){const u=s[l];i&&(u.oldValue=i[l].value);let d=u.dir[a];d&&(Us(),ns(d,o,8,[e.el,u,e,t]),zs())}}function gl(e,t){if(Nn){let o=Nn.provides;const a=Nn.parent&&Nn.parent.provides;a===o&&(o=Nn.provides=Object.create(a)),o[e]=t}}function lo(e,t,o=!1){const a=sc();if(a||ti){let s=ti?ti._context.provides:a?a.parent==null||a.ce?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return o&&ut(t)?t.call(a&&a.proxy):t}}function lg(){return!!(sc()||ti)}const rg=Symbol.for("v-scx"),cg=()=>lo(rg);function qe(e,t,o){return Jf(e,t,o)}function Jf(e,t,o=Ot){const{immediate:a,deep:s,flush:i,once:l}=o,u=fn({},o),d=t&&a||!t&&i!=="post";let f;if(El){if(i==="sync"){const k=cg();f=k.__watcherHandles||(k.__watcherHandles=[])}else if(!d){const k=()=>{};return k.stop=Xo,k.resume=Xo,k.pause=Xo,k}}const p=Nn;u.call=(k,_,w)=>ns(k,p,_,w);let g=!1;i==="post"?u.scheduler=k=>{qn(k,p&&p.suspense)}:i!=="sync"&&(g=!0,u.scheduler=(k,_)=>{_?k():Gu(k)}),u.augmentJob=k=>{t&&(k.flags|=4),g&&(k.flags|=2,p&&(k.id=p.uid,k.i=p))};const y=sg(e,t,u);return El&&(f?f.push(y):d&&y()),y}function ug(e,t,o){const a=this.proxy,s=Jt(e)?e.includes(".")?Yf(a,e):()=>a[e]:e.bind(a,a);let i;ut(t)?i=t:(i=t.handler,o=t);const l=Ul(this),u=Jf(s,i.bind(a),o);return l(),u}function Yf(e,t){const o=t.split(".");return()=>{let a=e;for(let s=0;s<o.length&&a;s++)a=a[o[s]];return a}}const Xf=Symbol("_vte"),Qf=e=>e.__isTeleport,yl=e=>e&&(e.disabled||e.disabled===""),Ad=e=>e&&(e.defer||e.defer===""),Ed=e=>typeof SVGElement<"u"&&e instanceof SVGElement,Pd=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,ou=(e,t)=>{const o=e&&e.to;return Jt(o)?t?t(o):null:o},ep={name:"Teleport",__isTeleport:!0,process(e,t,o,a,s,i,l,u,d,f){const{mc:p,pc:g,pbc:y,o:{insert:k,querySelector:_,createText:w,createComment:S}}=f,A=yl(t.props);let{shapeFlag:T,children:x,dynamicChildren:P}=t;if(e==null){const O=t.el=w(""),F=t.anchor=w("");k(O,o,a),k(F,o,a);const E=(D,j)=>{T&16&&p(x,D,j,s,i,l,u,d)},N=()=>{const D=t.target=ou(t.props,_),j=tp(D,t,w,k);D&&(l!=="svg"&&Ed(D)?l="svg":l!=="mathml"&&Pd(D)&&(l="mathml"),s&&s.isCE&&(s.ce._teleportTargets||(s.ce._teleportTargets=new Set)).add(D),A||(E(D,j),vr(t,!1)))};A&&(E(o,F),vr(t,!0)),Ad(t.props)?(t.el.__isMounted=!1,qn(()=>{N(),delete t.el.__isMounted},i)):N()}else{if(Ad(t.props)&&e.el.__isMounted===!1){qn(()=>{ep.process(e,t,o,a,s,i,l,u,d,f)},i);return}t.el=e.el,t.targetStart=e.targetStart;const O=t.anchor=e.anchor,F=t.target=e.target,E=t.targetAnchor=e.targetAnchor,N=yl(e.props),D=N?o:F,j=N?O:E;if(l==="svg"||Ed(F)?l="svg":(l==="mathml"||Pd(F))&&(l="mathml"),P?(y(e.dynamicChildren,P,D,s,i,l,u),Wu(e,t,!0)):d||g(e,t,D,j,s,i,l,u,!1),A)N?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):rr(t,o,O,f,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const R=t.target=ou(t.props,_);R&&rr(t,R,null,f,0)}else N&&rr(t,F,E,f,1);vr(t,A)}},remove(e,t,o,{um:a,o:{remove:s}},i){const{shapeFlag:l,children:u,anchor:d,targetStart:f,targetAnchor:p,target:g,props:y}=e;if(g&&(s(f),s(p)),i&&s(d),l&16){const k=i||!yl(y);for(let _=0;_<u.length;_++){const w=u[_];a(w,t,o,k,!!w.dynamicChildren)}}},move:rr,hydrate:dg};function rr(e,t,o,{o:{insert:a},m:s},i=2){i===0&&a(e.targetAnchor,t,o);const{el:l,anchor:u,shapeFlag:d,children:f,props:p}=e,g=i===2;if(g&&a(l,t,o),(!g||yl(p))&&d&16)for(let y=0;y<f.length;y++)s(f[y],t,o,2);g&&a(u,t,o)}function dg(e,t,o,a,s,i,{o:{nextSibling:l,parentNode:u,querySelector:d,insert:f,createText:p}},g){function y(w,S,A,T){S.anchor=g(l(w),S,u(w),o,a,s,i),S.targetStart=A,S.targetAnchor=T}const k=t.target=ou(t.props,d),_=yl(t.props);if(k){const w=k._lpa||k.firstChild;if(t.shapeFlag&16)if(_)y(e,t,w,w&&l(w));else{t.anchor=l(e);let S=w;for(;S;){if(S&&S.nodeType===8){if(S.data==="teleport start anchor")t.targetStart=S;else if(S.data==="teleport anchor"){t.targetAnchor=S,k._lpa=t.targetAnchor&&l(t.targetAnchor);break}}S=l(S)}t.targetAnchor||tp(k,t,p,f),g(w&&l(w),t,k,o,a,s,i)}vr(t,_)}else _&&t.shapeFlag&16&&y(e,t,e,l(e));return t.anchor&&l(t.anchor)}const $l=ep;function vr(e,t){const o=e.ctx;if(o&&o.ut){let a,s;for(t?(a=e.el,s=e.anchor):(a=e.targetStart,s=e.targetAnchor);a&&a!==s;)a.nodeType===1&&a.setAttribute("data-v-owner",o.uid),a=a.nextSibling;o.ut()}}function tp(e,t,o,a){const s=t.targetStart=o(""),i=t.targetAnchor=o("");return s[Xf]=i,e&&(a(s,e),a(i,e)),i}const As=Symbol("_leaveCb"),cr=Symbol("_enterCb");function hg(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return on(()=>{e.isMounted=!0}),dp(()=>{e.isUnmounting=!0}),e}const Po=[Function,Array],np={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Po,onEnter:Po,onAfterEnter:Po,onEnterCancelled:Po,onBeforeLeave:Po,onLeave:Po,onAfterLeave:Po,onLeaveCancelled:Po,onBeforeAppear:Po,onAppear:Po,onAfterAppear:Po,onAppearCancelled:Po},op=e=>{const t=e.subTree;return t.component?op(t.component):t},fg={name:"BaseTransition",props:np,setup(e,{slots:t}){const o=sc(),a=hg();return()=>{const s=t.default&&ip(t.default(),!0);if(!s||!s.length)return;const i=sp(s),l=Tt(e),{mode:u}=l;if(a.isLeaving)return Rc(i);const d=Dd(i);if(!d)return Rc(i);let f=su(d,l,a,o,g=>f=g);d.type!==Bn&&Tl(d,f);let p=o.subTree&&Dd(o.subTree);if(p&&p.type!==Bn&&!Ka(p,d)&&op(o).type!==Bn){let g=su(p,l,a,o);if(Tl(p,g),u==="out-in"&&d.type!==Bn)return a.isLeaving=!0,g.afterLeave=()=>{a.isLeaving=!1,o.job.flags&8||o.update(),delete g.afterLeave,p=void 0},Rc(i);u==="in-out"&&d.type!==Bn?g.delayLeave=(y,k,_)=>{const w=ap(a,p);w[String(p.key)]=p,y[As]=()=>{k(),y[As]=void 0,delete f.delayedLeave,p=void 0},f.delayedLeave=()=>{_(),delete f.delayedLeave,p=void 0}}:p=void 0}else p&&(p=void 0);return i}}};function sp(e){let t=e[0];if(e.length>1){for(const o of e)if(o.type!==Bn){t=o;break}}return t}const pg=fg;function ap(e,t){const{leavingVNodes:o}=e;let a=o.get(t.type);return a||(a=Object.create(null),o.set(t.type,a)),a}function su(e,t,o,a,s){const{appear:i,mode:l,persisted:u=!1,onBeforeEnter:d,onEnter:f,onAfterEnter:p,onEnterCancelled:g,onBeforeLeave:y,onLeave:k,onAfterLeave:_,onLeaveCancelled:w,onBeforeAppear:S,onAppear:A,onAfterAppear:T,onAppearCancelled:x}=t,P=String(e.key),O=ap(o,e),F=(D,j)=>{D&&ns(D,a,9,j)},E=(D,j)=>{const R=j[1];F(D,j),it(D)?D.every(W=>W.length<=1)&&R():D.length<=1&&R()},N={mode:l,persisted:u,beforeEnter(D){let j=d;if(!o.isMounted)if(i)j=S||d;else return;D[As]&&D[As](!0);const R=O[P];R&&Ka(e,R)&&R.el[As]&&R.el[As](),F(j,[D])},enter(D){let j=f,R=p,W=g;if(!o.isMounted)if(i)j=A||f,R=T||p,W=x||g;else return;let ne=!1;const ue=D[cr]=K=>{ne||(ne=!0,K?F(W,[D]):F(R,[D]),N.delayedLeave&&N.delayedLeave(),D[cr]=void 0)};j?E(j,[D,ue]):ue()},leave(D,j){const R=String(e.key);if(D[cr]&&D[cr](!0),o.isUnmounting)return j();F(y,[D]);let W=!1;const ne=D[As]=ue=>{W||(W=!0,j(),ue?F(w,[D]):F(_,[D]),D[As]=void 0,O[R]===e&&delete O[R])};O[R]=e,k?E(k,[D,ne]):ne()},clone(D){const j=su(D,t,o,a,s);return s&&s(j),j}};return N}function Rc(e){if(ec(e))return e=wa(e),e.children=null,e}function Dd(e){if(!ec(e))return Qf(e.type)&&e.children?sp(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:o}=e;if(o){if(t&16)return o[0];if(t&32&&ut(o.default))return o.default()}}function Tl(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Tl(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function ip(e,t=!1,o){let a=[],s=0;for(let i=0;i<e.length;i++){let l=e[i];const u=o==null?l.key:String(o)+String(l.key!=null?l.key:i);l.type===Se?(l.patchFlag&128&&s++,a=a.concat(ip(l.children,t,u))):(t||l.type!==Bn)&&a.push(u!=null?wa(l,{key:u}):l)}if(s>1)for(let i=0;i<a.length;i++)a[i].patchFlag=-2;return a}function lp(e,t){return ut(e)?fn({name:e.name},t,{setup:e}):e}function rp(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const $r=new WeakMap;function kl(e,t,o,a,s=!1){if(it(e)){e.forEach((_,w)=>kl(_,t&&(it(t)?t[w]:t),o,a,s));return}if(Pi(a)&&!s){a.shapeFlag&512&&a.type.__asyncResolved&&a.component.subTree.component&&kl(e,t,o,a.component.subTree);return}const i=a.shapeFlag&4?ac(a.component):a.el,l=s?null:i,{i:u,r:d}=e,f=t&&t.r,p=u.refs===Ot?u.refs={}:u.refs,g=u.setupState,y=Tt(g),k=g===Ot?mf:_=>Pt(y,_);if(f!=null&&f!==d){if(Rd(t),Jt(f))p[f]=null,k(f)&&(g[f]=null);else if(Kt(f)){f.value=null;const _=t;_.k&&(p[_.k]=null)}}if(ut(d))Fl(d,u,12,[l,p]);else{const _=Jt(d),w=Kt(d);if(_||w){const S=()=>{if(e.f){const A=_?k(d)?g[d]:p[d]:d.value;if(s)it(A)&&Ru(A,i);else if(it(A))A.includes(i)||A.push(i);else if(_)p[d]=[i],k(d)&&(g[d]=p[d]);else{const T=[i];d.value=T,e.k&&(p[e.k]=T)}}else _?(p[d]=l,k(d)&&(g[d]=l)):w&&(d.value=l,e.k&&(p[e.k]=l))};if(l){const A=()=>{S(),$r.delete(e)};A.id=-1,$r.set(e,A),qn(A,o)}else Rd(e),S()}}}function Rd(e){const t=$r.get(e);t&&(t.flags|=8,$r.delete(e))}Jr().requestIdleCallback;Jr().cancelIdleCallback;const Pi=e=>!!e.type.__asyncLoader,ec=e=>e.type.__isKeepAlive;function vg(e,t){cp(e,"a",t)}function mg(e,t){cp(e,"da",t)}function cp(e,t,o=Nn){const a=e.__wdc||(e.__wdc=()=>{let s=o;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(tc(t,a,o),o){let s=o.parent;for(;s&&s.parent;)ec(s.parent.vnode)&&gg(a,t,o,s),s=s.parent}}function gg(e,t,o,a){const s=tc(t,e,a,!0);$n(()=>{Ru(a[t],s)},o)}function tc(e,t,o=Nn,a=!1){if(o){const s=o[e]||(o[e]=[]),i=t.__weh||(t.__weh=(...l)=>{Us();const u=Ul(o),d=ns(t,o,e,l);return u(),zs(),d});return a?s.unshift(i):s.push(i),i}}const Gs=e=>(t,o=Nn)=>{(!El||e==="sp")&&tc(e,(...a)=>t(...a),o)},yg=Gs("bm"),on=Gs("m"),up=Gs("bu"),kg=Gs("u"),dp=Gs("bum"),$n=Gs("um"),_g=Gs("sp"),bg=Gs("rtg"),wg=Gs("rtc");function Cg(e,t=Nn){tc("ec",e,t)}const hp="components";function ju(e,t){return pp(hp,e,!0,t)||e}const fp=Symbol.for("v-ndc");function Lg(e){return Jt(e)?pp(hp,e,!1)||e:e||fp}function pp(e,t,o=!0,a=!1){const s=In||Nn;if(s){const i=s.type;{const u=ly(i,!1);if(u&&(u===t||u===Ro(t)||u===Wr(Ro(t))))return i}const l=Od(s[e]||i[e],t)||Od(s.appContext[e],t);return!l&&a?i:l}}function Od(e,t){return e&&(e[t]||e[Ro(t)]||e[Wr(Ro(t))])}function Ne(e,t,o,a){let s;const i=o,l=it(e);if(l||Jt(e)){const u=l&&Fs(e);let d=!1,f=!1;u&&(d=!wo(e),f=Hs(e),e=Yr(e)),s=new Array(e.length);for(let p=0,g=e.length;p<g;p++)s[p]=t(d?f?Ri(ts(e[p])):ts(e[p]):e[p],p,void 0,i)}else if(typeof e=="number"){s=new Array(e);for(let u=0;u<e;u++)s[u]=t(u+1,u,void 0,i)}else if(Rt(e))if(e[Symbol.iterator])s=Array.from(e,(u,d)=>t(u,d,void 0,i));else{const u=Object.keys(e);s=new Array(u.length);for(let d=0,f=u.length;d<f;d++){const p=u[d];s[d]=t(e[p],p,d,i)}}else s=[];return s}function vp(e,t){for(let o=0;o<t.length;o++){const a=t[o];if(it(a))for(let s=0;s<a.length;s++)e[a[s].name]=a[s].fn;else a&&(e[a.name]=a.key?(...s)=>{const i=a.fn(...s);return i&&(i.key=a.key),i}:a.fn)}return e}function io(e,t,o={},a,s){if(In.ce||In.parent&&Pi(In.parent)&&In.parent.ce){const f=Object.keys(o).length>0;return t!=="default"&&(o.name=t),v(),Ze(Se,null,[Ae("slot",o,a&&a())],f?-2:64)}let i=e[t];i&&i._c&&(i._d=!1),v();const l=i&&mp(i(o)),u=o.key||l&&l.key,d=Ze(Se,{key:(u&&!es(u)?u:`_${t}`)+(!l&&a?"_fb":"")},l||(a?a():[]),l&&e._===1?64:-2);return i&&i._c&&(i._d=!0),d}function mp(e){return e.some(t=>Al(t)?!(t.type===Bn||t.type===Se&&!mp(t.children)):!0)?e:null}const au=e=>e?Rp(e)?ac(e):au(e.parent):null,_l=fn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>au(e.parent),$root:e=>au(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>yp(e),$forceUpdate:e=>e.f||(e.f=()=>{Gu(e.update)}),$nextTick:e=>e.n||(e.n=un.bind(e.proxy)),$watch:e=>ug.bind(e)}),Oc=(e,t)=>e!==Ot&&!e.__isScriptSetup&&Pt(e,t),Sg={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:o,setupState:a,data:s,props:i,accessCache:l,type:u,appContext:d}=e;if(t[0]!=="$"){const y=l[t];if(y!==void 0)switch(y){case 1:return a[t];case 2:return s[t];case 4:return o[t];case 3:return i[t]}else{if(Oc(a,t))return l[t]=1,a[t];if(s!==Ot&&Pt(s,t))return l[t]=2,s[t];if(Pt(i,t))return l[t]=3,i[t];if(o!==Ot&&Pt(o,t))return l[t]=4,o[t];iu&&(l[t]=0)}}const f=_l[t];let p,g;if(f)return t==="$attrs"&&On(e.attrs,"get",""),f(e);if((p=u.__cssModules)&&(p=p[t]))return p;if(o!==Ot&&Pt(o,t))return l[t]=4,o[t];if(g=d.config.globalProperties,Pt(g,t))return g[t]},set({_:e},t,o){const{data:a,setupState:s,ctx:i}=e;return Oc(s,t)?(s[t]=o,!0):a!==Ot&&Pt(a,t)?(a[t]=o,!0):Pt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=o,!0)},has({_:{data:e,setupState:t,accessCache:o,ctx:a,appContext:s,props:i,type:l}},u){let d;return!!(o[u]||e!==Ot&&u[0]!=="$"&&Pt(e,u)||Oc(t,u)||Pt(i,u)||Pt(a,u)||Pt(_l,u)||Pt(s.config.globalProperties,u)||(d=l.__cssModules)&&d[u])},defineProperty(e,t,o){return o.get!=null?e._.accessCache[t]=0:Pt(o,"value")&&this.set(e,t,o.value,null),Reflect.defineProperty(e,t,o)}};function Bd(e){return it(e)?e.reduce((t,o)=>(t[o]=null,t),{}):e}let iu=!0;function xg(e){const t=yp(e),o=e.proxy,a=e.ctx;iu=!1,t.beforeCreate&&Nd(t.beforeCreate,e,"bc");const{data:s,computed:i,methods:l,watch:u,provide:d,inject:f,created:p,beforeMount:g,mounted:y,beforeUpdate:k,updated:_,activated:w,deactivated:S,beforeDestroy:A,beforeUnmount:T,destroyed:x,unmounted:P,render:O,renderTracked:F,renderTriggered:E,errorCaptured:N,serverPrefetch:D,expose:j,inheritAttrs:R,components:W,directives:ne,filters:ue}=t;if(f&&Ig(f,a,null),l)for(const he in l){const U=l[he];ut(U)&&(a[he]=U.bind(o))}if(s){const he=s.call(o,o);Rt(he)&&(e.data=ii(he))}if(iu=!0,i)for(const he in i){const U=i[he],ee=ut(U)?U.bind(o,o):ut(U.get)?U.get.bind(o,o):Xo,de=!ut(U)&&ut(U.set)?U.set.bind(o):Xo,re=G({get:ee,set:de});Object.defineProperty(a,he,{enumerable:!0,configurable:!0,get:()=>re.value,set:De=>re.value=De})}if(u)for(const he in u)gp(u[he],a,o,he);if(d){const he=ut(d)?d.call(o):d;Reflect.ownKeys(he).forEach(U=>{gl(U,he[U])})}p&&Nd(p,e,"c");function Q(he,U){it(U)?U.forEach(ee=>he(ee.bind(o))):U&&he(U.bind(o))}if(Q(yg,g),Q(on,y),Q(up,k),Q(kg,_),Q(vg,w),Q(mg,S),Q(Cg,N),Q(wg,F),Q(bg,E),Q(dp,T),Q($n,P),Q(_g,D),it(j))if(j.length){const he=e.exposed||(e.exposed={});j.forEach(U=>{Object.defineProperty(he,U,{get:()=>o[U],set:ee=>o[U]=ee,enumerable:!0})})}else e.exposed||(e.exposed={});O&&e.render===Xo&&(e.render=O),R!=null&&(e.inheritAttrs=R),W&&(e.components=W),ne&&(e.directives=ne),D&&rp(e)}function Ig(e,t,o=Xo){it(e)&&(e=lu(e));for(const a in e){const s=e[a];let i;Rt(s)?"default"in s?i=lo(s.from||a,s.default,!0):i=lo(s.from||a):i=lo(s),Kt(i)?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>i.value,set:l=>i.value=l}):t[a]=i}}function Nd(e,t,o){ns(it(e)?e.map(a=>a.bind(t.proxy)):e.bind(t.proxy),t,o)}function gp(e,t,o,a){let s=a.includes(".")?Yf(o,a):()=>o[a];if(Jt(e)){const i=t[e];ut(i)&&qe(s,i)}else if(ut(e))qe(s,e.bind(o));else if(Rt(e))if(it(e))e.forEach(i=>gp(i,t,o,a));else{const i=ut(e.handler)?e.handler.bind(o):t[e.handler];ut(i)&&qe(s,i,e)}}function yp(e){const t=e.type,{mixins:o,extends:a}=t,{mixins:s,optionsCache:i,config:{optionMergeStrategies:l}}=e.appContext,u=i.get(t);let d;return u?d=u:!s.length&&!o&&!a?d=t:(d={},s.length&&s.forEach(f=>Tr(d,f,l,!0)),Tr(d,t,l)),Rt(t)&&i.set(t,d),d}function Tr(e,t,o,a=!1){const{mixins:s,extends:i}=t;i&&Tr(e,i,o,!0),s&&s.forEach(l=>Tr(e,l,o,!0));for(const l in t)if(!(a&&l==="expose")){const u=$g[l]||o&&o[l];e[l]=u?u(e[l],t[l]):t[l]}return e}const $g={data:Fd,props:Ud,emits:Ud,methods:cl,computed:cl,beforeCreate:Zn,created:Zn,beforeMount:Zn,mounted:Zn,beforeUpdate:Zn,updated:Zn,beforeDestroy:Zn,beforeUnmount:Zn,destroyed:Zn,unmounted:Zn,activated:Zn,deactivated:Zn,errorCaptured:Zn,serverPrefetch:Zn,components:cl,directives:cl,watch:Mg,provide:Fd,inject:Tg};function Fd(e,t){return t?e?function(){return fn(ut(e)?e.call(this,this):e,ut(t)?t.call(this,this):t)}:t:e}function Tg(e,t){return cl(lu(e),lu(t))}function lu(e){if(it(e)){const t={};for(let o=0;o<e.length;o++)t[e[o]]=e[o];return t}return e}function Zn(e,t){return e?[...new Set([].concat(e,t))]:t}function cl(e,t){return e?fn(Object.create(null),e,t):t}function Ud(e,t){return e?it(e)&&it(t)?[...new Set([...e,...t])]:fn(Object.create(null),Bd(e),Bd(t??{})):t}function Mg(e,t){if(!e)return t;if(!t)return e;const o=fn(Object.create(null),e);for(const a in t)o[a]=Zn(e[a],t[a]);return o}function kp(){return{app:null,config:{isNativeTag:mf,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ag=0;function Eg(e,t){return function(a,s=null){ut(a)||(a=fn({},a)),s!=null&&!Rt(s)&&(s=null);const i=kp(),l=new WeakSet,u=[];let d=!1;const f=i.app={_uid:Ag++,_component:a,_props:s,_container:null,_context:i,_instance:null,version:cy,get config(){return i.config},set config(p){},use(p,...g){return l.has(p)||(p&&ut(p.install)?(l.add(p),p.install(f,...g)):ut(p)&&(l.add(p),p(f,...g))),f},mixin(p){return i.mixins.includes(p)||i.mixins.push(p),f},component(p,g){return g?(i.components[p]=g,f):i.components[p]},directive(p,g){return g?(i.directives[p]=g,f):i.directives[p]},mount(p,g,y){if(!d){const k=f._ceVNode||Ae(a,s);return k.appContext=i,y===!0?y="svg":y===!1&&(y=void 0),e(k,p,y),d=!0,f._container=p,p.__vue_app__=f,ac(k.component)}},onUnmount(p){u.push(p)},unmount(){d&&(ns(u,f._instance,16),e(null,f._container),delete f._container.__vue_app__)},provide(p,g){return i.provides[p]=g,f},runWithContext(p){const g=ti;ti=f;try{return p()}finally{ti=g}}};return f}}let ti=null;const Pg=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Ro(t)}Modifiers`]||e[`${La(t)}Modifiers`];function Dg(e,t,...o){if(e.isUnmounted)return;const a=e.vnode.props||Ot;let s=o;const i=t.startsWith("update:"),l=i&&Pg(a,t.slice(7));l&&(l.trim&&(s=o.map(p=>Jt(p)?p.trim():p)),l.number&&(s=o.map(Kr)));let u,d=a[u=Mc(t)]||a[u=Mc(Ro(t))];!d&&i&&(d=a[u=Mc(La(t))]),d&&ns(d,e,6,s);const f=a[u+"Once"];if(f){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,ns(f,e,6,s)}}const Rg=new WeakMap;function _p(e,t,o=!1){const a=o?Rg:t.emitsCache,s=a.get(e);if(s!==void 0)return s;const i=e.emits;let l={},u=!1;if(!ut(e)){const d=f=>{const p=_p(f,t,!0);p&&(u=!0,fn(l,p))};!o&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}return!i&&!u?(Rt(e)&&a.set(e,null),null):(it(i)?i.forEach(d=>l[d]=null):fn(l,i),Rt(e)&&a.set(e,l),l)}function nc(e,t){return!e||!jr(t)?!1:(t=t.slice(2).replace(/Once$/,""),Pt(e,t[0].toLowerCase()+t.slice(1))||Pt(e,La(t))||Pt(e,t))}function zd(e){const{type:t,vnode:o,proxy:a,withProxy:s,propsOptions:[i],slots:l,attrs:u,emit:d,render:f,renderCache:p,props:g,data:y,setupState:k,ctx:_,inheritAttrs:w}=e,S=Ir(e);let A,T;try{if(o.shapeFlag&4){const P=s||a,O=P;A=fs(f.call(O,P,p,g,k,y,_)),T=u}else{const P=t;A=fs(P.length>1?P(g,{attrs:u,slots:l,emit:d}):P(g,null)),T=t.props?u:Og(u)}}catch(P){wl.length=0,Qr(P,e,1),A=Ae(Bn)}let x=A;if(T&&w!==!1){const P=Object.keys(T),{shapeFlag:O}=x;P.length&&O&7&&(i&&P.some(Du)&&(T=Bg(T,i)),x=wa(x,T,!1,!0))}return o.dirs&&(x=wa(x,null,!1,!0),x.dirs=x.dirs?x.dirs.concat(o.dirs):o.dirs),o.transition&&Tl(x,o.transition),A=x,Ir(S),A}const Og=e=>{let t;for(const o in e)(o==="class"||o==="style"||jr(o))&&((t||(t={}))[o]=e[o]);return t},Bg=(e,t)=>{const o={};for(const a in e)(!Du(a)||!(a.slice(9)in t))&&(o[a]=e[a]);return o};function Ng(e,t,o){const{props:a,children:s,component:i}=e,{props:l,children:u,patchFlag:d}=t,f=i.emitsOptions;if(t.dirs||t.transition)return!0;if(o&&d>=0){if(d&1024)return!0;if(d&16)return a?Hd(a,l,f):!!l;if(d&8){const p=t.dynamicProps;for(let g=0;g<p.length;g++){const y=p[g];if(l[y]!==a[y]&&!nc(f,y))return!0}}}else return(s||u)&&(!u||!u.$stable)?!0:a===l?!1:a?l?Hd(a,l,f):!0:!!l;return!1}function Hd(e,t,o){const a=Object.keys(t);if(a.length!==Object.keys(e).length)return!0;for(let s=0;s<a.length;s++){const i=a[s];if(t[i]!==e[i]&&!nc(o,i))return!0}return!1}function Fg({vnode:e,parent:t},o){for(;t;){const a=t.subTree;if(a.suspense&&a.suspense.activeBranch===e&&(a.el=e.el),a===e)(e=t.vnode).el=o,t=t.parent;else break}}const bp={},wp=()=>Object.create(bp),Cp=e=>Object.getPrototypeOf(e)===bp;function Ug(e,t,o,a=!1){const s={},i=wp();e.propsDefaults=Object.create(null),Lp(e,t,s,i);for(const l in e.propsOptions[0])l in s||(s[l]=void 0);o?e.props=a?s:zf(s):e.type.props?e.props=s:e.props=i,e.attrs=i}function zg(e,t,o,a){const{props:s,attrs:i,vnode:{patchFlag:l}}=e,u=Tt(s),[d]=e.propsOptions;let f=!1;if((a||l>0)&&!(l&16)){if(l&8){const p=e.vnode.dynamicProps;for(let g=0;g<p.length;g++){let y=p[g];if(nc(e.emitsOptions,y))continue;const k=t[y];if(d)if(Pt(i,y))k!==i[y]&&(i[y]=k,f=!0);else{const _=Ro(y);s[_]=ru(d,u,_,k,e,!1)}else k!==i[y]&&(i[y]=k,f=!0)}}}else{Lp(e,t,s,i)&&(f=!0);let p;for(const g in u)(!t||!Pt(t,g)&&((p=La(g))===g||!Pt(t,p)))&&(d?o&&(o[g]!==void 0||o[p]!==void 0)&&(s[g]=ru(d,u,g,void 0,e,!0)):delete s[g]);if(i!==u)for(const g in i)(!t||!Pt(t,g))&&(delete i[g],f=!0)}f&&Ps(e.attrs,"set","")}function Lp(e,t,o,a){const[s,i]=e.propsOptions;let l=!1,u;if(t)for(let d in t){if(pl(d))continue;const f=t[d];let p;s&&Pt(s,p=Ro(d))?!i||!i.includes(p)?o[p]=f:(u||(u={}))[p]=f:nc(e.emitsOptions,d)||(!(d in a)||f!==a[d])&&(a[d]=f,l=!0)}if(i){const d=Tt(o),f=u||Ot;for(let p=0;p<i.length;p++){const g=i[p];o[g]=ru(s,d,g,f[g],e,!Pt(f,g))}}return l}function ru(e,t,o,a,s,i){const l=e[o];if(l!=null){const u=Pt(l,"default");if(u&&a===void 0){const d=l.default;if(l.type!==Function&&!l.skipFactory&&ut(d)){const{propsDefaults:f}=s;if(o in f)a=f[o];else{const p=Ul(s);a=f[o]=d.call(null,t),p()}}else a=d;s.ce&&s.ce._setProp(o,a)}l[0]&&(i&&!u?a=!1:l[1]&&(a===""||a===La(o))&&(a=!0))}return a}const Hg=new WeakMap;function Sp(e,t,o=!1){const a=o?Hg:t.propsCache,s=a.get(e);if(s)return s;const i=e.props,l={},u=[];let d=!1;if(!ut(e)){const p=g=>{d=!0;const[y,k]=Sp(g,t,!0);fn(l,y),k&&u.push(...k)};!o&&t.mixins.length&&t.mixins.forEach(p),e.extends&&p(e.extends),e.mixins&&e.mixins.forEach(p)}if(!i&&!d)return Rt(e)&&a.set(e,Mi),Mi;if(it(i))for(let p=0;p<i.length;p++){const g=Ro(i[p]);Vd(g)&&(l[g]=Ot)}else if(i)for(const p in i){const g=Ro(p);if(Vd(g)){const y=i[p],k=l[g]=it(y)||ut(y)?{type:y}:fn({},y),_=k.type;let w=!1,S=!0;if(it(_))for(let A=0;A<_.length;++A){const T=_[A],x=ut(T)&&T.name;if(x==="Boolean"){w=!0;break}else x==="String"&&(S=!1)}else w=ut(_)&&_.name==="Boolean";k[0]=w,k[1]=S,(w||Pt(k,"default"))&&u.push(g)}}const f=[l,u];return Rt(e)&&a.set(e,f),f}function Vd(e){return e[0]!=="$"&&!pl(e)}const Zu=e=>e==="_"||e==="_ctx"||e==="$stable",qu=e=>it(e)?e.map(fs):[fs(e)],Vg=(e,t,o)=>{if(t._n)return t;const a=ze((...s)=>qu(t(...s)),o);return a._c=!1,a},xp=(e,t,o)=>{const a=e._ctx;for(const s in e){if(Zu(s))continue;const i=e[s];if(ut(i))t[s]=Vg(s,i,a);else if(i!=null){const l=qu(i);t[s]=()=>l}}},Ip=(e,t)=>{const o=qu(t);e.slots.default=()=>o},$p=(e,t,o)=>{for(const a in t)(o||!Zu(a))&&(e[a]=t[a])},Gg=(e,t,o)=>{const a=e.slots=wp();if(e.vnode.shapeFlag&32){const s=t._;s?($p(a,t,o),o&&_f(a,"_",s,!0)):xp(t,a)}else t&&Ip(e,t)},jg=(e,t,o)=>{const{vnode:a,slots:s}=e;let i=!0,l=Ot;if(a.shapeFlag&32){const u=t._;u?o&&u===1?i=!1:$p(s,t,o):(i=!t.$stable,xp(t,s)),l=t}else t&&(Ip(e,t),l={default:1});if(i)for(const u in s)!Zu(u)&&l[u]==null&&delete s[u]},qn=Jg;function Zg(e){return qg(e)}function qg(e,t){const o=Jr();o.__VUE__=!0;const{insert:a,remove:s,patchProp:i,createElement:l,createText:u,createComment:d,setText:f,setElementText:p,parentNode:g,nextSibling:y,setScopeId:k=Xo,insertStaticContent:_}=e,w=(q,X,fe,we=null,Y=null,V=null,J=void 0,Me=null,Re=!!X.dynamicChildren)=>{if(q===X)return;q&&!Ka(q,X)&&(we=_e(q),De(q,Y,V,!0),q=null),X.patchFlag===-2&&(Re=!1,X.dynamicChildren=null);const{type:Ce,ref:be,shapeFlag:me}=X;switch(Ce){case oc:S(q,X,fe,we);break;case Bn:A(q,X,fe,we);break;case bl:q==null&&T(X,fe,we,J);break;case Se:W(q,X,fe,we,Y,V,J,Me,Re);break;default:me&1?O(q,X,fe,we,Y,V,J,Me,Re):me&6?ne(q,X,fe,we,Y,V,J,Me,Re):(me&64||me&128)&&Ce.process(q,X,fe,we,Y,V,J,Me,Re,Le)}be!=null&&Y?kl(be,q&&q.ref,V,X||q,!X):be==null&&q&&q.ref!=null&&kl(q.ref,null,V,q,!0)},S=(q,X,fe,we)=>{if(q==null)a(X.el=u(X.children),fe,we);else{const Y=X.el=q.el;X.children!==q.children&&f(Y,X.children)}},A=(q,X,fe,we)=>{q==null?a(X.el=d(X.children||""),fe,we):X.el=q.el},T=(q,X,fe,we)=>{[q.el,q.anchor]=_(q.children,X,fe,we,q.el,q.anchor)},x=({el:q,anchor:X},fe,we)=>{let Y;for(;q&&q!==X;)Y=y(q),a(q,fe,we),q=Y;a(X,fe,we)},P=({el:q,anchor:X})=>{let fe;for(;q&&q!==X;)fe=y(q),s(q),q=fe;s(X)},O=(q,X,fe,we,Y,V,J,Me,Re)=>{if(X.type==="svg"?J="svg":X.type==="math"&&(J="mathml"),q==null)F(X,fe,we,Y,V,J,Me,Re);else{const Ce=q.el&&q.el._isVueCE?q.el:null;try{Ce&&Ce._beginPatch(),D(q,X,Y,V,J,Me,Re)}finally{Ce&&Ce._endPatch()}}},F=(q,X,fe,we,Y,V,J,Me)=>{let Re,Ce;const{props:be,shapeFlag:me,transition:Z,dirs:oe}=q;if(Re=q.el=l(q.type,V,be&&be.is,be),me&8?p(Re,q.children):me&16&&N(q.children,Re,null,we,Y,Bc(q,V),J,Me),oe&&Va(q,null,we,"created"),E(Re,q,q.scopeId,J,we),be){for(const Te in be)Te!=="value"&&!pl(Te)&&i(Re,Te,null,be[Te],V,we);"value"in be&&i(Re,"value",null,be.value,V),(Ce=be.onVnodeBeforeMount)&&us(Ce,we,q)}oe&&Va(q,null,we,"beforeMount");const le=Wg(Y,Z);le&&Z.beforeEnter(Re),a(Re,X,fe),((Ce=be&&be.onVnodeMounted)||le||oe)&&qn(()=>{Ce&&us(Ce,we,q),le&&Z.enter(Re),oe&&Va(q,null,we,"mounted")},Y)},E=(q,X,fe,we,Y)=>{if(fe&&k(q,fe),we)for(let V=0;V<we.length;V++)k(q,we[V]);if(Y){let V=Y.subTree;if(X===V||Ap(V.type)&&(V.ssContent===X||V.ssFallback===X)){const J=Y.vnode;E(q,J,J.scopeId,J.slotScopeIds,Y.parent)}}},N=(q,X,fe,we,Y,V,J,Me,Re=0)=>{for(let Ce=Re;Ce<q.length;Ce++){const be=q[Ce]=Me?pa(q[Ce]):fs(q[Ce]);w(null,be,X,fe,we,Y,V,J,Me)}},D=(q,X,fe,we,Y,V,J)=>{const Me=X.el=q.el;let{patchFlag:Re,dynamicChildren:Ce,dirs:be}=X;Re|=q.patchFlag&16;const me=q.props||Ot,Z=X.props||Ot;let oe;if(fe&&Ga(fe,!1),(oe=Z.onVnodeBeforeUpdate)&&us(oe,fe,X,q),be&&Va(X,q,fe,"beforeUpdate"),fe&&Ga(fe,!0),(me.innerHTML&&Z.innerHTML==null||me.textContent&&Z.textContent==null)&&p(Me,""),Ce?j(q.dynamicChildren,Ce,Me,fe,we,Bc(X,Y),V):J||U(q,X,Me,null,fe,we,Bc(X,Y),V,!1),Re>0){if(Re&16)R(Me,me,Z,fe,Y);else if(Re&2&&me.class!==Z.class&&i(Me,"class",null,Z.class,Y),Re&4&&i(Me,"style",me.style,Z.style,Y),Re&8){const le=X.dynamicProps;for(let Te=0;Te<le.length;Te++){const Oe=le[Te],Be=me[Oe],Xe=Z[Oe];(Xe!==Be||Oe==="value")&&i(Me,Oe,Be,Xe,Y,fe)}}Re&1&&q.children!==X.children&&p(Me,X.children)}else!J&&Ce==null&&R(Me,me,Z,fe,Y);((oe=Z.onVnodeUpdated)||be)&&qn(()=>{oe&&us(oe,fe,X,q),be&&Va(X,q,fe,"updated")},we)},j=(q,X,fe,we,Y,V,J)=>{for(let Me=0;Me<X.length;Me++){const Re=q[Me],Ce=X[Me],be=Re.el&&(Re.type===Se||!Ka(Re,Ce)||Re.shapeFlag&198)?g(Re.el):fe;w(Re,Ce,be,null,we,Y,V,J,!0)}},R=(q,X,fe,we,Y)=>{if(X!==fe){if(X!==Ot)for(const V in X)!pl(V)&&!(V in fe)&&i(q,V,X[V],null,Y,we);for(const V in fe){if(pl(V))continue;const J=fe[V],Me=X[V];J!==Me&&V!=="value"&&i(q,V,Me,J,Y,we)}"value"in fe&&i(q,"value",X.value,fe.value,Y)}},W=(q,X,fe,we,Y,V,J,Me,Re)=>{const Ce=X.el=q?q.el:u(""),be=X.anchor=q?q.anchor:u("");let{patchFlag:me,dynamicChildren:Z,slotScopeIds:oe}=X;oe&&(Me=Me?Me.concat(oe):oe),q==null?(a(Ce,fe,we),a(be,fe,we),N(X.children||[],fe,be,Y,V,J,Me,Re)):me>0&&me&64&&Z&&q.dynamicChildren&&q.dynamicChildren.length===Z.length?(j(q.dynamicChildren,Z,fe,Y,V,J,Me),(X.key!=null||Y&&X===Y.subTree)&&Wu(q,X,!0)):U(q,X,fe,be,Y,V,J,Me,Re)},ne=(q,X,fe,we,Y,V,J,Me,Re)=>{X.slotScopeIds=Me,q==null?X.shapeFlag&512?Y.ctx.activate(X,fe,we,J,Re):ue(X,fe,we,Y,V,J,Re):K(q,X,Re)},ue=(q,X,fe,we,Y,V,J)=>{const Me=q.component=ny(q,we,Y);if(ec(q)&&(Me.ctx.renderer=Le),oy(Me,!1,J),Me.asyncDep){if(Y&&Y.registerDep(Me,Q,J),!q.el){const Re=Me.subTree=Ae(Bn);A(null,Re,X,fe),q.placeholder=Re.el}}else Q(Me,q,X,fe,Y,V,J)},K=(q,X,fe)=>{const we=X.component=q.component;if(Ng(q,X,fe))if(we.asyncDep&&!we.asyncResolved){he(we,X,fe);return}else we.next=X,we.update();else X.el=q.el,we.vnode=X},Q=(q,X,fe,we,Y,V,J)=>{const Me=()=>{if(q.isMounted){let{next:me,bu:Z,u:oe,parent:le,vnode:Te}=q;{const _t=Tp(q);if(_t){me&&(me.el=Te.el,he(q,me,J)),_t.asyncDep.then(()=>{q.isUnmounted||Me()});return}}let Oe=me,Be;Ga(q,!1),me?(me.el=Te.el,he(q,me,J)):me=Te,Z&&pr(Z),(Be=me.props&&me.props.onVnodeBeforeUpdate)&&us(Be,le,me,Te),Ga(q,!0);const Xe=zd(q),mt=q.subTree;q.subTree=Xe,w(mt,Xe,g(mt.el),_e(mt),q,Y,V),me.el=Xe.el,Oe===null&&Fg(q,Xe.el),oe&&qn(oe,Y),(Be=me.props&&me.props.onVnodeUpdated)&&qn(()=>us(Be,le,me,Te),Y)}else{let me;const{el:Z,props:oe}=X,{bm:le,m:Te,parent:Oe,root:Be,type:Xe}=q,mt=Pi(X);Ga(q,!1),le&&pr(le),!mt&&(me=oe&&oe.onVnodeBeforeMount)&&us(me,Oe,X),Ga(q,!0);{Be.ce&&Be.ce._def.shadowRoot!==!1&&Be.ce._injectChildStyle(Xe);const _t=q.subTree=zd(q);w(null,_t,fe,we,q,Y,V),X.el=_t.el}if(Te&&qn(Te,Y),!mt&&(me=oe&&oe.onVnodeMounted)){const _t=X;qn(()=>us(me,Oe,_t),Y)}(X.shapeFlag&256||Oe&&Pi(Oe.vnode)&&Oe.vnode.shapeFlag&256)&&q.a&&qn(q.a,Y),q.isMounted=!0,X=fe=we=null}};q.scope.on();const Re=q.effect=new If(Me);q.scope.off();const Ce=q.update=Re.run.bind(Re),be=q.job=Re.runIfDirty.bind(Re);be.i=q,be.id=q.uid,Re.scheduler=()=>Gu(be),Ga(q,!0),Ce()},he=(q,X,fe)=>{X.component=q;const we=q.vnode.props;q.vnode=X,q.next=null,zg(q,X.props,we,fe),jg(q,X.children,fe),Us(),Md(q),zs()},U=(q,X,fe,we,Y,V,J,Me,Re=!1)=>{const Ce=q&&q.children,be=q?q.shapeFlag:0,me=X.children,{patchFlag:Z,shapeFlag:oe}=X;if(Z>0){if(Z&128){de(Ce,me,fe,we,Y,V,J,Me,Re);return}else if(Z&256){ee(Ce,me,fe,we,Y,V,J,Me,Re);return}}oe&8?(be&16&&Ke(Ce,Y,V),me!==Ce&&p(fe,me)):be&16?oe&16?de(Ce,me,fe,we,Y,V,J,Me,Re):Ke(Ce,Y,V,!0):(be&8&&p(fe,""),oe&16&&N(me,fe,we,Y,V,J,Me,Re))},ee=(q,X,fe,we,Y,V,J,Me,Re)=>{q=q||Mi,X=X||Mi;const Ce=q.length,be=X.length,me=Math.min(Ce,be);let Z;for(Z=0;Z<me;Z++){const oe=X[Z]=Re?pa(X[Z]):fs(X[Z]);w(q[Z],oe,fe,null,Y,V,J,Me,Re)}Ce>be?Ke(q,Y,V,!0,!1,me):N(X,fe,we,Y,V,J,Me,Re,me)},de=(q,X,fe,we,Y,V,J,Me,Re)=>{let Ce=0;const be=X.length;let me=q.length-1,Z=be-1;for(;Ce<=me&&Ce<=Z;){const oe=q[Ce],le=X[Ce]=Re?pa(X[Ce]):fs(X[Ce]);if(Ka(oe,le))w(oe,le,fe,null,Y,V,J,Me,Re);else break;Ce++}for(;Ce<=me&&Ce<=Z;){const oe=q[me],le=X[Z]=Re?pa(X[Z]):fs(X[Z]);if(Ka(oe,le))w(oe,le,fe,null,Y,V,J,Me,Re);else break;me--,Z--}if(Ce>me){if(Ce<=Z){const oe=Z+1,le=oe<be?X[oe].el:we;for(;Ce<=Z;)w(null,X[Ce]=Re?pa(X[Ce]):fs(X[Ce]),fe,le,Y,V,J,Me,Re),Ce++}}else if(Ce>Z)for(;Ce<=me;)De(q[Ce],Y,V,!0),Ce++;else{const oe=Ce,le=Ce,Te=new Map;for(Ce=le;Ce<=Z;Ce++){const Ct=X[Ce]=Re?pa(X[Ce]):fs(X[Ce]);Ct.key!=null&&Te.set(Ct.key,Ce)}let Oe,Be=0;const Xe=Z-le+1;let mt=!1,_t=0;const bt=new Array(Xe);for(Ce=0;Ce<Xe;Ce++)bt[Ce]=0;for(Ce=oe;Ce<=me;Ce++){const Ct=q[Ce];if(Be>=Xe){De(Ct,Y,V,!0);continue}let Bt;if(Ct.key!=null)Bt=Te.get(Ct.key);else for(Oe=le;Oe<=Z;Oe++)if(bt[Oe-le]===0&&Ka(Ct,X[Oe])){Bt=Oe;break}Bt===void 0?De(Ct,Y,V,!0):(bt[Bt-le]=Ce+1,Bt>=_t?_t=Bt:mt=!0,w(Ct,X[Bt],fe,null,Y,V,J,Me,Re),Be++)}const Mt=mt?Kg(bt):Mi;for(Oe=Mt.length-1,Ce=Xe-1;Ce>=0;Ce--){const Ct=le+Ce,Bt=X[Ct],Nt=X[Ct+1],zn=Ct+1<be?Nt.el||Mp(Nt):we;bt[Ce]===0?w(null,Bt,fe,zn,Y,V,J,Me,Re):mt&&(Oe<0||Ce!==Mt[Oe]?re(Bt,fe,zn,2):Oe--)}}},re=(q,X,fe,we,Y=null)=>{const{el:V,type:J,transition:Me,children:Re,shapeFlag:Ce}=q;if(Ce&6){re(q.component.subTree,X,fe,we);return}if(Ce&128){q.suspense.move(X,fe,we);return}if(Ce&64){J.move(q,X,fe,Le);return}if(J===Se){a(V,X,fe);for(let me=0;me<Re.length;me++)re(Re[me],X,fe,we);a(q.anchor,X,fe);return}if(J===bl){x(q,X,fe);return}if(we!==2&&Ce&1&&Me)if(we===0)Me.beforeEnter(V),a(V,X,fe),qn(()=>Me.enter(V),Y);else{const{leave:me,delayLeave:Z,afterLeave:oe}=Me,le=()=>{q.ctx.isUnmounted?s(V):a(V,X,fe)},Te=()=>{V._isLeaving&&V[As](!0),me(V,()=>{le(),oe&&oe()})};Z?Z(V,le,Te):Te()}else a(V,X,fe)},De=(q,X,fe,we=!1,Y=!1)=>{const{type:V,props:J,ref:Me,children:Re,dynamicChildren:Ce,shapeFlag:be,patchFlag:me,dirs:Z,cacheIndex:oe}=q;if(me===-2&&(Y=!1),Me!=null&&(Us(),kl(Me,null,fe,q,!0),zs()),oe!=null&&(X.renderCache[oe]=void 0),be&256){X.ctx.deactivate(q);return}const le=be&1&&Z,Te=!Pi(q);let Oe;if(Te&&(Oe=J&&J.onVnodeBeforeUnmount)&&us(Oe,X,q),be&6)Fe(q.component,fe,we);else{if(be&128){q.suspense.unmount(fe,we);return}le&&Va(q,null,X,"beforeUnmount"),be&64?q.type.remove(q,X,fe,Le,we):Ce&&!Ce.hasOnce&&(V!==Se||me>0&&me&64)?Ke(Ce,X,fe,!1,!0):(V===Se&&me&384||!Y&&be&16)&&Ke(Re,X,fe),we&&et(q)}(Te&&(Oe=J&&J.onVnodeUnmounted)||le)&&qn(()=>{Oe&&us(Oe,X,q),le&&Va(q,null,X,"unmounted")},fe)},et=q=>{const{type:X,el:fe,anchor:we,transition:Y}=q;if(X===Se){Je(fe,we);return}if(X===bl){P(q);return}const V=()=>{s(fe),Y&&!Y.persisted&&Y.afterLeave&&Y.afterLeave()};if(q.shapeFlag&1&&Y&&!Y.persisted){const{leave:J,delayLeave:Me}=Y,Re=()=>J(fe,V);Me?Me(q.el,V,Re):Re()}else V()},Je=(q,X)=>{let fe;for(;q!==X;)fe=y(q),s(q),q=fe;s(X)},Fe=(q,X,fe)=>{const{bum:we,scope:Y,job:V,subTree:J,um:Me,m:Re,a:Ce}=q;Gd(Re),Gd(Ce),we&&pr(we),Y.stop(),V&&(V.flags|=8,De(J,q,X,fe)),Me&&qn(Me,X),qn(()=>{q.isUnmounted=!0},X)},Ke=(q,X,fe,we=!1,Y=!1,V=0)=>{for(let J=V;J<q.length;J++)De(q[J],X,fe,we,Y)},_e=q=>{if(q.shapeFlag&6)return _e(q.component.subTree);if(q.shapeFlag&128)return q.suspense.next();const X=y(q.anchor||q.el),fe=X&&X[Xf];return fe?y(fe):X};let Ve=!1;const pe=(q,X,fe)=>{let we;q==null?X._vnode&&(De(X._vnode,null,null,!0),we=X._vnode.component):w(X._vnode||null,q,X,null,null,null,fe),X._vnode=q,Ve||(Ve=!0,Md(we),qf(),Ve=!1)},Le={p:w,um:De,m:re,r:et,mt:ue,mc:N,pc:U,pbc:j,n:_e,o:e};return{render:pe,hydrate:void 0,createApp:Eg(pe)}}function Bc({type:e,props:t},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:o}function Ga({effect:e,job:t},o){o?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Wg(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function Wu(e,t,o=!1){const a=e.children,s=t.children;if(it(a)&&it(s))for(let i=0;i<a.length;i++){const l=a[i];let u=s[i];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=s[i]=pa(s[i]),u.el=l.el),!o&&u.patchFlag!==-2&&Wu(l,u)),u.type===oc&&(u.patchFlag!==-1?u.el=l.el:u.__elIndex=i+(e.type===Se?1:0)),u.type===Bn&&!u.el&&(u.el=l.el)}}function Kg(e){const t=e.slice(),o=[0];let a,s,i,l,u;const d=e.length;for(a=0;a<d;a++){const f=e[a];if(f!==0){if(s=o[o.length-1],e[s]<f){t[a]=s,o.push(a);continue}for(i=0,l=o.length-1;i<l;)u=i+l>>1,e[o[u]]<f?i=u+1:l=u;f<e[o[i]]&&(i>0&&(t[a]=o[i-1]),o[i]=a)}}for(i=o.length,l=o[i-1];i-- >0;)o[i]=l,l=t[l];return o}function Tp(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Tp(t)}function Gd(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function Mp(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?Mp(t.subTree):null}const Ap=e=>e.__isSuspense;function Jg(e,t){t&&t.pendingBranch?it(e)?t.effects.push(...e):t.effects.push(e):Zf(e)}const Se=Symbol.for("v-fgt"),oc=Symbol.for("v-txt"),Bn=Symbol.for("v-cmt"),bl=Symbol.for("v-stc"),wl=[];let bo=null;function v(e=!1){wl.push(bo=e?null:[])}function Yg(){wl.pop(),bo=wl[wl.length-1]||null}let Ml=1;function Mr(e,t=!1){Ml+=e,e<0&&bo&&t&&(bo.hasOnce=!0)}function Ep(e){return e.dynamicChildren=Ml>0?bo||Mi:null,Yg(),Ml>0&&bo&&bo.push(e),e}function m(e,t,o,a,s,i){return Ep(r(e,t,o,a,s,i,!0))}function Ze(e,t,o,a,s){return Ep(Ae(e,t,o,a,s,!0))}function Al(e){return e?e.__v_isVNode===!0:!1}function Ka(e,t){return e.type===t.type&&e.key===t.key}const Pp=({key:e})=>e??null,mr=({ref:e,ref_key:t,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?Jt(e)||Kt(e)||ut(e)?{i:In,r:e,k:t,f:!!o}:e:null);function r(e,t=null,o=null,a=0,s=null,i=e===Se?0:1,l=!1,u=!1){const d={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Pp(t),ref:t&&mr(t),scopeId:Kf,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:a,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:In};return u?(Ku(d,o),i&128&&e.normalize(d)):o&&(d.shapeFlag|=Jt(o)?8:16),Ml>0&&!l&&bo&&(d.patchFlag>0||i&6)&&d.patchFlag!==32&&bo.push(d),d}const Ae=Xg;function Xg(e,t=null,o=null,a=0,s=null,i=!1){if((!e||e===fp)&&(e=Bn),Al(e)){const u=wa(e,t,!0);return o&&Ku(u,o),Ml>0&&!i&&bo&&(u.shapeFlag&6?bo[bo.indexOf(e)]=u:bo.push(u)),u.patchFlag=-2,u}if(ry(e)&&(e=e.__vccOpts),t){t=Qg(t);let{class:u,style:d}=t;u&&!Jt(u)&&(t.class=ce(u)),Rt(d)&&(Xr(d)&&!it(d)&&(d=fn({},d)),t.style=Qe(d))}const l=Jt(e)?1:Ap(e)?128:Qf(e)?64:Rt(e)?4:ut(e)?2:0;return r(e,t,o,a,s,l,i,!0)}function Qg(e){return e?Xr(e)||Cp(e)?fn({},e):e:null}function wa(e,t,o=!1,a=!1){const{props:s,ref:i,patchFlag:l,children:u,transition:d}=e,f=t?Dp(s||{},t):s,p={__v_isVNode:!0,__v_skip:!0,type:e.type,props:f,key:f&&Pp(f),ref:t&&t.ref?o&&i?it(i)?i.concat(mr(t)):[i,mr(t)]:mr(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Se?l===-1?16:l|16:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:d,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&wa(e.ssContent),ssFallback:e.ssFallback&&wa(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return d&&a&&Tl(p,d.clone(p)),p}function Ye(e=" ",t=0){return Ae(oc,null,e,t)}function Ar(e,t){const o=Ae(bl,null,e);return o.staticCount=t,o}function M(e="",t=!1){return t?(v(),Ze(Bn,null,e)):Ae(Bn,null,e)}function fs(e){return e==null||typeof e=="boolean"?Ae(Bn):it(e)?Ae(Se,null,e.slice()):Al(e)?pa(e):Ae(oc,null,String(e))}function pa(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:wa(e)}function Ku(e,t){let o=0;const{shapeFlag:a}=e;if(t==null)t=null;else if(it(t))o=16;else if(typeof t=="object")if(a&65){const s=t.default;s&&(s._c&&(s._d=!1),Ku(e,s()),s._c&&(s._d=!0));return}else{o=32;const s=t._;!s&&!Cp(t)?t._ctx=In:s===3&&In&&(In.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else ut(t)?(t={default:t,_ctx:In},o=32):(t=String(t),a&64?(o=16,t=[Ye(t)]):o=8);e.children=t,e.shapeFlag|=o}function Dp(...e){const t={};for(let o=0;o<e.length;o++){const a=e[o];for(const s in a)if(s==="class")t.class!==a.class&&(t.class=ce([t.class,a.class]));else if(s==="style")t.style=Qe([t.style,a.style]);else if(jr(s)){const i=t[s],l=a[s];l&&i!==l&&!(it(i)&&i.includes(l))&&(t[s]=i?[].concat(i,l):l)}else s!==""&&(t[s]=a[s])}return t}function us(e,t,o,a=null){ns(e,t,7,[o,a])}const ey=kp();let ty=0;function ny(e,t,o){const a=e.type,s=(t?t.appContext:e.appContext)||ey,i={uid:ty++,vnode:e,type:a,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Lf(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Sp(a,s),emitsOptions:_p(a,s),emit:null,emitted:null,propsDefaults:Ot,inheritAttrs:a.inheritAttrs,ctx:Ot,data:Ot,props:Ot,attrs:Ot,slots:Ot,refs:Ot,setupState:Ot,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=Dg.bind(null,i),e.ce&&e.ce(i),i}let Nn=null;const sc=()=>Nn||In;let Er,cu;{const e=Jr(),t=(o,a)=>{let s;return(s=e[o])||(s=e[o]=[]),s.push(a),i=>{s.length>1?s.forEach(l=>l(i)):s[0](i)}};Er=t("__VUE_INSTANCE_SETTERS__",o=>Nn=o),cu=t("__VUE_SSR_SETTERS__",o=>El=o)}const Ul=e=>{const t=Nn;return Er(e),e.scope.on(),()=>{e.scope.off(),Er(t)}},jd=()=>{Nn&&Nn.scope.off(),Er(null)};function Rp(e){return e.vnode.shapeFlag&4}let El=!1;function oy(e,t=!1,o=!1){t&&cu(t);const{props:a,children:s}=e.vnode,i=Rp(e);Ug(e,a,i,t),Gg(e,s,o||t);const l=i?sy(e,t):void 0;return t&&cu(!1),l}function sy(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Sg);const{setup:a}=o;if(a){Us();const s=e.setupContext=a.length>1?iy(e):null,i=Ul(e),l=Fl(a,e,0,[e.props,s]),u=gf(l);if(zs(),i(),(u||e.sp)&&!Pi(e)&&rp(e),u){if(l.then(jd,jd),t)return l.then(d=>{Zd(e,d)}).catch(d=>{Qr(d,e,0)});e.asyncDep=l}else Zd(e,l)}else Op(e)}function Zd(e,t,o){ut(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Rt(t)&&(e.setupState=Vf(t)),Op(e)}function Op(e,t,o){const a=e.type;e.render||(e.render=a.render||Xo);{const s=Ul(e);Us();try{xg(e)}finally{zs(),s()}}}const ay={get(e,t){return On(e,"get",""),e[t]}};function iy(e){const t=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,ay),slots:e.slots,emit:e.emit,expose:t}}function ac(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Vf(Vu(e.exposed)),{get(t,o){if(o in t)return t[o];if(o in _l)return _l[o](e)},has(t,o){return o in t||o in _l}})):e.proxy}function ly(e,t=!0){return ut(e)?e.displayName||e.name:e.name||t&&e.__name}function ry(e){return ut(e)&&"__vccOpts"in e}const G=(e,t)=>ng(e,t,El);function Ju(e,t,o){try{Mr(-1);const a=arguments.length;return a===2?Rt(t)&&!it(t)?Al(t)?Ae(e,null,[t]):Ae(e,t):Ae(e,null,t):(a>3?o=Array.prototype.slice.call(arguments,2):a===3&&Al(o)&&(o=[o]),Ae(e,t,o))}finally{Mr(1)}}const cy="3.5.26";let uu;const qd=typeof window<"u"&&window.trustedTypes;if(qd)try{uu=qd.createPolicy("vue",{createHTML:e=>e})}catch{}const Bp=uu?e=>uu.createHTML(e):e=>e,uy="http://www.w3.org/2000/svg",dy="http://www.w3.org/1998/Math/MathML",Ms=typeof document<"u"?document:null,Wd=Ms&&Ms.createElement("template"),hy={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,a)=>{const s=t==="svg"?Ms.createElementNS(uy,e):t==="mathml"?Ms.createElementNS(dy,e):o?Ms.createElement(e,{is:o}):Ms.createElement(e);return e==="select"&&a&&a.multiple!=null&&s.setAttribute("multiple",a.multiple),s},createText:e=>Ms.createTextNode(e),createComment:e=>Ms.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Ms.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,o,a,s,i){const l=o?o.previousSibling:t.lastChild;if(s&&(s===i||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),o),!(s===i||!(s=s.nextSibling)););else{Wd.innerHTML=Bp(a==="svg"?`<svg>${e}</svg>`:a==="mathml"?`<math>${e}</math>`:e);const u=Wd.content;if(a==="svg"||a==="mathml"){const d=u.firstChild;for(;d.firstChild;)u.appendChild(d.firstChild);u.removeChild(d)}t.insertBefore(u,o)}return[l?l.nextSibling:t.firstChild,o?o.previousSibling:t.lastChild]}},ra="transition",al="animation",Pl=Symbol("_vtc"),Np={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},fy=fn({},np,Np),py=e=>(e.displayName="Transition",e.props=fy,e),ys=py((e,{slots:t})=>Ju(pg,vy(e),t)),ja=(e,t=[])=>{it(e)?e.forEach(o=>o(...t)):e&&e(...t)},Kd=e=>e?it(e)?e.some(t=>t.length>1):e.length>1:!1;function vy(e){const t={};for(const W in e)W in Np||(t[W]=e[W]);if(e.css===!1)return t;const{name:o="v",type:a,duration:s,enterFromClass:i=`${o}-enter-from`,enterActiveClass:l=`${o}-enter-active`,enterToClass:u=`${o}-enter-to`,appearFromClass:d=i,appearActiveClass:f=l,appearToClass:p=u,leaveFromClass:g=`${o}-leave-from`,leaveActiveClass:y=`${o}-leave-active`,leaveToClass:k=`${o}-leave-to`}=e,_=my(s),w=_&&_[0],S=_&&_[1],{onBeforeEnter:A,onEnter:T,onEnterCancelled:x,onLeave:P,onLeaveCancelled:O,onBeforeAppear:F=A,onAppear:E=T,onAppearCancelled:N=x}=t,D=(W,ne,ue,K)=>{W._enterCancelled=K,Za(W,ne?p:u),Za(W,ne?f:l),ue&&ue()},j=(W,ne)=>{W._isLeaving=!1,Za(W,g),Za(W,k),Za(W,y),ne&&ne()},R=W=>(ne,ue)=>{const K=W?E:T,Q=()=>D(ne,W,ue);ja(K,[ne,Q]),Jd(()=>{Za(ne,W?d:i),$s(ne,W?p:u),Kd(K)||Yd(ne,a,w,Q)})};return fn(t,{onBeforeEnter(W){ja(A,[W]),$s(W,i),$s(W,l)},onBeforeAppear(W){ja(F,[W]),$s(W,d),$s(W,f)},onEnter:R(!1),onAppear:R(!0),onLeave(W,ne){W._isLeaving=!0;const ue=()=>j(W,ne);$s(W,g),W._enterCancelled?($s(W,y),eh(W)):(eh(W),$s(W,y)),Jd(()=>{W._isLeaving&&(Za(W,g),$s(W,k),Kd(P)||Yd(W,a,S,ue))}),ja(P,[W,ue])},onEnterCancelled(W){D(W,!1,void 0,!0),ja(x,[W])},onAppearCancelled(W){D(W,!0,void 0,!0),ja(N,[W])},onLeaveCancelled(W){j(W),ja(O,[W])}})}function my(e){if(e==null)return null;if(Rt(e))return[Nc(e.enter),Nc(e.leave)];{const t=Nc(e);return[t,t]}}function Nc(e){return _m(e)}function $s(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e[Pl]||(e[Pl]=new Set)).add(t)}function Za(e,t){t.split(/\s+/).forEach(a=>a&&e.classList.remove(a));const o=e[Pl];o&&(o.delete(t),o.size||(e[Pl]=void 0))}function Jd(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let gy=0;function Yd(e,t,o,a){const s=e._endId=++gy,i=()=>{s===e._endId&&a()};if(o!=null)return setTimeout(i,o);const{type:l,timeout:u,propCount:d}=yy(e,t);if(!l)return a();const f=l+"end";let p=0;const g=()=>{e.removeEventListener(f,y),i()},y=k=>{k.target===e&&++p>=d&&g()};setTimeout(()=>{p<d&&g()},u+1),e.addEventListener(f,y)}function yy(e,t){const o=window.getComputedStyle(e),a=_=>(o[_]||"").split(", "),s=a(`${ra}Delay`),i=a(`${ra}Duration`),l=Xd(s,i),u=a(`${al}Delay`),d=a(`${al}Duration`),f=Xd(u,d);let p=null,g=0,y=0;t===ra?l>0&&(p=ra,g=l,y=i.length):t===al?f>0&&(p=al,g=f,y=d.length):(g=Math.max(l,f),p=g>0?l>f?ra:al:null,y=p?p===ra?i.length:d.length:0);const k=p===ra&&/\b(?:transform|all)(?:,|$)/.test(a(`${ra}Property`).toString());return{type:p,timeout:g,propCount:y,hasTransform:k}}function Xd(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((o,a)=>Qd(o)+Qd(e[a])))}function Qd(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function eh(e){return(e?e.ownerDocument:document).body.offsetHeight}function ky(e,t,o){const a=e[Pl];a&&(t=(t?[t,...a]:[...a]).join(" ")),t==null?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}const Pr=Symbol("_vod"),Fp=Symbol("_vsh"),ks={name:"show",beforeMount(e,{value:t},{transition:o}){e[Pr]=e.style.display==="none"?"":e.style.display,o&&t?o.beforeEnter(e):il(e,t)},mounted(e,{value:t},{transition:o}){o&&t&&o.enter(e)},updated(e,{value:t,oldValue:o},{transition:a}){!t!=!o&&(a?t?(a.beforeEnter(e),il(e,!0),a.enter(e)):a.leave(e,()=>{il(e,!1)}):il(e,t))},beforeUnmount(e,{value:t}){il(e,t)}};function il(e,t){e.style.display=t?e[Pr]:"none",e[Fp]=!t}const Up=Symbol("");function _y(e){const t=sc();if(!t)return;const o=t.ut=(s=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(i=>Dr(i,s))},a=()=>{const s=e(t.proxy);t.ce?Dr(t.ce,s):du(t.subTree,s),o(s)};up(()=>{Zf(a)}),on(()=>{qe(a,Xo,{flush:"post"});const s=new MutationObserver(a);s.observe(t.subTree.el.parentNode,{childList:!0}),$n(()=>s.disconnect())})}function du(e,t){if(e.shapeFlag&128){const o=e.suspense;e=o.activeBranch,o.pendingBranch&&!o.isHydrating&&o.effects.push(()=>{du(o.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)Dr(e.el,t);else if(e.type===Se)e.children.forEach(o=>du(o,t));else if(e.type===bl){let{el:o,anchor:a}=e;for(;o&&(Dr(o,t),o!==a);)o=o.nextSibling}}function Dr(e,t){if(e.nodeType===1){const o=e.style;let a="";for(const s in t){const i=$m(t[s]);o.setProperty(`--${s}`,i),a+=`--${s}: ${i};`}o[Up]=a}}const by=/(?:^|;)\s*display\s*:/;function wy(e,t,o){const a=e.style,s=Jt(o);let i=!1;if(o&&!s){if(t)if(Jt(t))for(const l of t.split(";")){const u=l.slice(0,l.indexOf(":")).trim();o[u]==null&&gr(a,u,"")}else for(const l in t)o[l]==null&&gr(a,l,"");for(const l in o)l==="display"&&(i=!0),gr(a,l,o[l])}else if(s){if(t!==o){const l=a[Up];l&&(o+=";"+l),a.cssText=o,i=by.test(o)}}else t&&e.removeAttribute("style");Pr in e&&(e[Pr]=i?a.display:"",e[Fp]&&(a.display="none"))}const th=/\s*!important$/;function gr(e,t,o){if(it(o))o.forEach(a=>gr(e,t,a));else if(o==null&&(o=""),t.startsWith("--"))e.setProperty(t,o);else{const a=Cy(e,t);th.test(o)?e.setProperty(La(a),o.replace(th,""),"important"):e[a]=o}}const nh=["Webkit","Moz","ms"],Fc={};function Cy(e,t){const o=Fc[t];if(o)return o;let a=Ro(t);if(a!=="filter"&&a in e)return Fc[t]=a;a=Wr(a);for(let s=0;s<nh.length;s++){const i=nh[s]+a;if(i in e)return Fc[t]=i}return t}const oh="http://www.w3.org/1999/xlink";function sh(e,t,o,a,s,i=xm(t)){a&&t.startsWith("xlink:")?o==null?e.removeAttributeNS(oh,t.slice(6,t.length)):e.setAttributeNS(oh,t,o):o==null||i&&!bf(o)?e.removeAttribute(t):e.setAttribute(t,i?"":es(o)?String(o):o)}function ah(e,t,o,a,s){if(t==="innerHTML"||t==="textContent"){o!=null&&(e[t]=t==="innerHTML"?Bp(o):o);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const u=i==="OPTION"?e.getAttribute("value")||"":e.value,d=o==null?e.type==="checkbox"?"on":"":String(o);(u!==d||!("_value"in e))&&(e.value=d),o==null&&e.removeAttribute(t),e._value=o;return}let l=!1;if(o===""||o==null){const u=typeof e[t];u==="boolean"?o=bf(o):o==null&&u==="string"?(o="",l=!0):u==="number"&&(o=0,l=!0)}try{e[t]=o}catch{}l&&e.removeAttribute(s||t)}function Rs(e,t,o,a){e.addEventListener(t,o,a)}function Ly(e,t,o,a){e.removeEventListener(t,o,a)}const ih=Symbol("_vei");function Sy(e,t,o,a,s=null){const i=e[ih]||(e[ih]={}),l=i[t];if(a&&l)l.value=a;else{const[u,d]=xy(t);if(a){const f=i[t]=Ty(a,s);Rs(e,u,f,d)}else l&&(Ly(e,u,l,d),i[t]=void 0)}}const lh=/(?:Once|Passive|Capture)$/;function xy(e){let t;if(lh.test(e)){t={};let a;for(;a=e.match(lh);)e=e.slice(0,e.length-a[0].length),t[a[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):La(e.slice(2)),t]}let Uc=0;const Iy=Promise.resolve(),$y=()=>Uc||(Iy.then(()=>Uc=0),Uc=Date.now());function Ty(e,t){const o=a=>{if(!a._vts)a._vts=Date.now();else if(a._vts<=o.attached)return;ns(My(a,o.value),t,5,[a])};return o.value=e,o.attached=$y(),o}function My(e,t){if(it(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map(a=>s=>!s._stopped&&a&&a(s))}else return t}const rh=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Ay=(e,t,o,a,s,i)=>{const l=s==="svg";t==="class"?ky(e,a,l):t==="style"?wy(e,o,a):jr(t)?Du(t)||Sy(e,t,o,a,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Ey(e,t,a,l))?(ah(e,t,a),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&sh(e,t,a,l,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Jt(a))?ah(e,Ro(t),a,i,t):(t==="true-value"?e._trueValue=a:t==="false-value"&&(e._falseValue=a),sh(e,t,a,l))};function Ey(e,t,o,a){if(a)return!!(t==="innerHTML"||t==="textContent"||t in e&&rh(t)&&ut(o));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return rh(t)&&Jt(o)?!1:t in e}const Ca=e=>{const t=e.props["onUpdate:modelValue"]||!1;return it(t)?o=>pr(t,o):t};function Py(e){e.target.composing=!0}function ch(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Do=Symbol("_assign");function uh(e,t,o){return t&&(e=e.trim()),o&&(e=Kr(e)),e}const st={created(e,{modifiers:{lazy:t,trim:o,number:a}},s){e[Do]=Ca(s);const i=a||s.props&&s.props.type==="number";Rs(e,t?"change":"input",l=>{l.target.composing||e[Do](uh(e.value,o,i))}),(o||i)&&Rs(e,"change",()=>{e.value=uh(e.value,o,i)}),t||(Rs(e,"compositionstart",Py),Rs(e,"compositionend",ch),Rs(e,"change",ch))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:o,modifiers:{lazy:a,trim:s,number:i}},l){if(e[Do]=Ca(l),e.composing)return;const u=(i||e.type==="number")&&!/^0\d/.test(e.value)?Kr(e.value):e.value,d=t??"";u!==d&&(document.activeElement===e&&e.type!=="range"&&(a&&t===o||s&&e.value.trim()===d)||(e.value=d))}},Oi={deep:!0,created(e,t,o){e[Do]=Ca(o),Rs(e,"change",()=>{const a=e._modelValue,s=Bi(e),i=e.checked,l=e[Do];if(it(a)){const u=Ou(a,s),d=u!==-1;if(i&&!d)l(a.concat(s));else if(!i&&d){const f=[...a];f.splice(u,1),l(f)}}else if(zi(a)){const u=new Set(a);i?u.add(s):u.delete(s),l(u)}else l(zp(e,i))})},mounted:dh,beforeUpdate(e,t,o){e[Do]=Ca(o),dh(e,t,o)}};function dh(e,{value:t,oldValue:o},a){e._modelValue=t;let s;if(it(t))s=Ou(t,a.props.value)>-1;else if(zi(t))s=t.has(a.props.value);else{if(t===o)return;s=si(t,zp(e,!0))}e.checked!==s&&(e.checked=s)}const hh={created(e,{value:t},o){e.checked=si(t,o.props.value),e[Do]=Ca(o),Rs(e,"change",()=>{e[Do](Bi(e))})},beforeUpdate(e,{value:t,oldValue:o},a){e[Do]=Ca(a),t!==o&&(e.checked=si(t,a.props.value))}},Fn={deep:!0,created(e,{value:t,modifiers:{number:o}},a){const s=zi(t);Rs(e,"change",()=>{const i=Array.prototype.filter.call(e.options,l=>l.selected).map(l=>o?Kr(Bi(l)):Bi(l));e[Do](e.multiple?s?new Set(i):i:i[0]),e._assigning=!0,un(()=>{e._assigning=!1})}),e[Do]=Ca(a)},mounted(e,{value:t}){fh(e,t)},beforeUpdate(e,t,o){e[Do]=Ca(o)},updated(e,{value:t}){e._assigning||fh(e,t)}};function fh(e,t){const o=e.multiple,a=it(t);if(!(o&&!a&&!zi(t))){for(let s=0,i=e.options.length;s<i;s++){const l=e.options[s],u=Bi(l);if(o)if(a){const d=typeof u;d==="string"||d==="number"?l.selected=t.some(f=>String(f)===String(u)):l.selected=Ou(t,u)>-1}else l.selected=t.has(u);else if(si(Bi(l),t)){e.selectedIndex!==s&&(e.selectedIndex=s);return}}!o&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Bi(e){return"_value"in e?e._value:e.value}function zp(e,t){const o=t?"_trueValue":"_falseValue";return o in e?e[o]:t}const Dy=["ctrl","shift","alt","meta"],Ry={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Dy.some(o=>e[`${o}Key`]&&!t.includes(o))},rt=(e,t)=>{const o=e._withMods||(e._withMods={}),a=t.join(".");return o[a]||(o[a]=((s,...i)=>{for(let l=0;l<t.length;l++){const u=Ry[t[l]];if(u&&u(s,t))return}return e(s,...i)}))},Oy={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},vs=(e,t)=>{const o=e._withKeys||(e._withKeys={}),a=t.join(".");return o[a]||(o[a]=(s=>{if(!("key"in s))return;const i=La(s.key);if(t.some(l=>l===i||Oy[l]===i))return e(s)}))},By=fn({patchProp:Ay},hy);let ph;function Ny(){return ph||(ph=Zg(By))}const Fy=((...e)=>{const t=Ny().createApp(...e),{mount:o}=t;return t.mount=a=>{const s=zy(a);if(!s)return;const i=t._component;!ut(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const l=o(s,!1,Uy(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),l},t});function Uy(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function zy(e){return Jt(e)?document.querySelector(e):e}let Hp;const ic=e=>Hp=e,Vp=Symbol();function hu(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Cl;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Cl||(Cl={}));function Hy(){const e=Sf(!0),t=e.run(()=>$({}));let o=[],a=[];const s=Vu({install(i){ic(s),s._a=i,i.provide(Vp,s),i.config.globalProperties.$pinia=s,a.forEach(l=>o.push(l)),a=[]},use(i){return this._a?o.push(i):a.push(i),this},_p:o,_a:null,_e:e,_s:new Map,state:t});return s}const Gp=()=>{};function vh(e,t,o,a=Gp){e.add(t);const s=()=>{e.delete(t)&&a()};return!o&&xf()&&Tm(s),s}function Li(e,...t){e.forEach(o=>{o(...t)})}const Vy=e=>e(),mh=Symbol(),zc=Symbol();function fu(e,t){e instanceof Map&&t instanceof Map?t.forEach((o,a)=>e.set(a,o)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const o in t){if(!t.hasOwnProperty(o))continue;const a=t[o],s=e[o];hu(s)&&hu(a)&&e.hasOwnProperty(o)&&!Kt(a)&&!Fs(a)?e[o]=fu(s,a):e[o]=a}return e}const Gy=Symbol();function jy(e){return!hu(e)||!Object.prototype.hasOwnProperty.call(e,Gy)}const{assign:ua}=Object;function Zy(e){return!!(Kt(e)&&e.effect)}function qy(e,t,o,a){const{state:s,actions:i,getters:l}=t,u=o.state.value[e];let d;function f(){u||(o.state.value[e]=s?s():{});const p=Xm(o.state.value[e]);return ua(p,i,Object.keys(l||{}).reduce((g,y)=>(g[y]=Vu(G(()=>{ic(o);const k=o._s.get(e);return l[y].call(k,k)})),g),{}))}return d=jp(e,f,t,o,a,!0),d}function jp(e,t,o={},a,s,i){let l;const u=ua({actions:{}},o),d={deep:!0};let f,p,g=new Set,y=new Set,k;const _=a.state.value[e];!i&&!_&&(a.state.value[e]={}),$({});let w;function S(N){let D;f=p=!1,typeof N=="function"?(N(a.state.value[e]),D={type:Cl.patchFunction,storeId:e,events:k}):(fu(a.state.value[e],N),D={type:Cl.patchObject,payload:N,storeId:e,events:k});const j=w=Symbol();un().then(()=>{w===j&&(f=!0)}),p=!0,Li(g,D,a.state.value[e])}const A=i?function(){const{state:D}=o,j=D?D():{};this.$patch(R=>{ua(R,j)})}:Gp;function T(){l.stop(),g.clear(),y.clear(),a._s.delete(e)}const x=(N,D="")=>{if(mh in N)return N[zc]=D,N;const j=function(){ic(a);const R=Array.from(arguments),W=new Set,ne=new Set;function ue(he){W.add(he)}function K(he){ne.add(he)}Li(y,{args:R,name:j[zc],store:O,after:ue,onError:K});let Q;try{Q=N.apply(this&&this.$id===e?this:O,R)}catch(he){throw Li(ne,he),he}return Q instanceof Promise?Q.then(he=>(Li(W,he),he)).catch(he=>(Li(ne,he),Promise.reject(he))):(Li(W,Q),Q)};return j[mh]=!0,j[zc]=D,j},P={_p:a,$id:e,$onAction:vh.bind(null,y),$patch:S,$reset:A,$subscribe(N,D={}){const j=vh(g,N,D.detached,()=>R()),R=l.run(()=>qe(()=>a.state.value[e],W=>{(D.flush==="sync"?p:f)&&N({storeId:e,type:Cl.direct,events:k},W)},ua({},d,D)));return j},$dispose:T},O=ii(P);a._s.set(e,O);const E=(a._a&&a._a.runWithContext||Vy)(()=>a._e.run(()=>(l=Sf()).run(()=>t({action:x}))));for(const N in E){const D=E[N];if(Kt(D)&&!Zy(D)||Fs(D))i||(_&&jy(D)&&(Kt(D)?D.value=_[N]:fu(D,_[N])),a.state.value[e][N]=D);else if(typeof D=="function"){const j=x(D,N);E[N]=j,u.actions[N]=D}}return ua(O,E),ua(Tt(O),E),Object.defineProperty(O,"$state",{get:()=>a.state.value[e],set:N=>{S(D=>{ua(D,N)})}}),a._p.forEach(N=>{ua(O,l.run(()=>N({store:O,app:a._a,pinia:a,options:u})))}),_&&i&&o.hydrate&&o.hydrate(O.$state,_),f=!0,p=!0,O}function Yu(e,t,o){let a;const s=typeof t=="function";a=s?o:t;function i(l,u){const d=lg();return l=l||(d?lo(Vp,null):null),l&&ic(l),l=Hp,l._s.has(e)||(s?jp(e,t,a,l):qy(e,a,l)),l._s.get(e)}return i.$id=e,i}const xi=typeof document<"u";function Zp(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Wy(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&Zp(e.default)}const Et=Object.assign;function Hc(e,t){const o={};for(const a in t){const s=t[a];o[a]=os(s)?s.map(e):e(s)}return o}const Ll=()=>{},os=Array.isArray;function gh(e,t){const o={};for(const a in e)o[a]=a in t?t[a]:e[a];return o}const qp=/#/g,Ky=/&/g,Jy=/\//g,Yy=/=/g,Xy=/\?/g,Wp=/\+/g,Qy=/%5B/g,e1=/%5D/g,Kp=/%5E/g,t1=/%60/g,Jp=/%7B/g,n1=/%7C/g,Yp=/%7D/g,o1=/%20/g;function Xu(e){return e==null?"":encodeURI(""+e).replace(n1,"|").replace(Qy,"[").replace(e1,"]")}function s1(e){return Xu(e).replace(Jp,"{").replace(Yp,"}").replace(Kp,"^")}function pu(e){return Xu(e).replace(Wp,"%2B").replace(o1,"+").replace(qp,"%23").replace(Ky,"%26").replace(t1,"`").replace(Jp,"{").replace(Yp,"}").replace(Kp,"^")}function a1(e){return pu(e).replace(Yy,"%3D")}function i1(e){return Xu(e).replace(qp,"%23").replace(Xy,"%3F")}function l1(e){return i1(e).replace(Jy,"%2F")}function Dl(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const r1=/\/$/,c1=e=>e.replace(r1,"");function Vc(e,t,o="/"){let a,s={},i="",l="";const u=t.indexOf("#");let d=t.indexOf("?");return d=u>=0&&d>u?-1:d,d>=0&&(a=t.slice(0,d),i=t.slice(d,u>0?u:t.length),s=e(i.slice(1))),u>=0&&(a=a||t.slice(0,u),l=t.slice(u,t.length)),a=f1(a??t,o),{fullPath:a+i+l,path:a,query:s,hash:Dl(l)}}function u1(e,t){const o=t.query?e(t.query):"";return t.path+(o&&"?")+o+(t.hash||"")}function yh(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function d1(e,t,o){const a=t.matched.length-1,s=o.matched.length-1;return a>-1&&a===s&&Ni(t.matched[a],o.matched[s])&&Xp(t.params,o.params)&&e(t.query)===e(o.query)&&t.hash===o.hash}function Ni(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Xp(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var o in e)if(!h1(e[o],t[o]))return!1;return!0}function h1(e,t){return os(e)?kh(e,t):os(t)?kh(t,e):e?.valueOf()===t?.valueOf()}function kh(e,t){return os(t)?e.length===t.length&&e.every((o,a)=>o===t[a]):e.length===1&&e[0]===t}function f1(e,t){if(e.startsWith("/"))return e;if(!e)return t;const o=t.split("/"),a=e.split("/"),s=a[a.length-1];(s===".."||s===".")&&a.push("");let i=o.length-1,l,u;for(l=0;l<a.length;l++)if(u=a[l],u!==".")if(u==="..")i>1&&i--;else break;return o.slice(0,i).join("/")+"/"+a.slice(l).join("/")}const ca={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let vu=(function(e){return e.pop="pop",e.push="push",e})({}),Gc=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function p1(e){if(!e)if(xi){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),c1(e)}const v1=/^[^#]+#/;function m1(e,t){return e.replace(v1,"#")+t}function g1(e,t){const o=document.documentElement.getBoundingClientRect(),a=e.getBoundingClientRect();return{behavior:t.behavior,left:a.left-o.left-(t.left||0),top:a.top-o.top-(t.top||0)}}const lc=()=>({left:window.scrollX,top:window.scrollY});function y1(e){let t;if("el"in e){const o=e.el,a=typeof o=="string"&&o.startsWith("#"),s=typeof o=="string"?a?document.getElementById(o.slice(1)):document.querySelector(o):o;if(!s)return;t=g1(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function _h(e,t){return(history.state?history.state.position-t:-1)+e}const mu=new Map;function k1(e,t){mu.set(e,t)}function _1(e){const t=mu.get(e);return mu.delete(e),t}function b1(e){return typeof e=="string"||e&&typeof e=="object"}function Qp(e){return typeof e=="string"||typeof e=="symbol"}let nn=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const ev=Symbol("");nn.MATCHER_NOT_FOUND+"",nn.NAVIGATION_GUARD_REDIRECT+"",nn.NAVIGATION_ABORTED+"",nn.NAVIGATION_CANCELLED+"",nn.NAVIGATION_DUPLICATED+"";function Fi(e,t){return Et(new Error,{type:e,[ev]:!0},t)}function Ts(e,t){return e instanceof Error&&ev in e&&(t==null||!!(e.type&t))}const w1=["params","query","hash"];function C1(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const o of w1)o in e&&(t[o]=e[o]);return JSON.stringify(t,null,2)}function L1(e){const t={};if(e===""||e==="?")return t;const o=(e[0]==="?"?e.slice(1):e).split("&");for(let a=0;a<o.length;++a){const s=o[a].replace(Wp," "),i=s.indexOf("="),l=Dl(i<0?s:s.slice(0,i)),u=i<0?null:Dl(s.slice(i+1));if(l in t){let d=t[l];os(d)||(d=t[l]=[d]),d.push(u)}else t[l]=u}return t}function bh(e){let t="";for(let o in e){const a=e[o];if(o=a1(o),a==null){a!==void 0&&(t+=(t.length?"&":"")+o);continue}(os(a)?a.map(s=>s&&pu(s)):[a&&pu(a)]).forEach(s=>{s!==void 0&&(t+=(t.length?"&":"")+o,s!=null&&(t+="="+s))})}return t}function S1(e){const t={};for(const o in e){const a=e[o];a!==void 0&&(t[o]=os(a)?a.map(s=>s==null?null:""+s):a==null?a:""+a)}return t}const x1=Symbol(""),wh=Symbol(""),rc=Symbol(""),Qu=Symbol(""),gu=Symbol("");function ll(){let e=[];function t(a){return e.push(a),()=>{const s=e.indexOf(a);s>-1&&e.splice(s,1)}}function o(){e=[]}return{add:t,list:()=>e.slice(),reset:o}}function va(e,t,o,a,s,i=l=>l()){const l=a&&(a.enterCallbacks[s]=a.enterCallbacks[s]||[]);return()=>new Promise((u,d)=>{const f=y=>{y===!1?d(Fi(nn.NAVIGATION_ABORTED,{from:o,to:t})):y instanceof Error?d(y):b1(y)?d(Fi(nn.NAVIGATION_GUARD_REDIRECT,{from:t,to:y})):(l&&a.enterCallbacks[s]===l&&typeof y=="function"&&l.push(y),u())},p=i(()=>e.call(a&&a.instances[s],t,o,f));let g=Promise.resolve(p);e.length<3&&(g=g.then(f)),g.catch(y=>d(y))})}function jc(e,t,o,a,s=i=>i()){const i=[];for(const l of e)for(const u in l.components){let d=l.components[u];if(!(t!=="beforeRouteEnter"&&!l.instances[u]))if(Zp(d)){const f=(d.__vccOpts||d)[t];f&&i.push(va(f,o,a,l,u,s))}else{let f=d();i.push(()=>f.then(p=>{if(!p)throw new Error(`Couldn't resolve component "${u}" at "${l.path}"`);const g=Wy(p)?p.default:p;l.mods[u]=p,l.components[u]=g;const y=(g.__vccOpts||g)[t];return y&&va(y,o,a,l,u,s)()}))}}return i}function I1(e,t){const o=[],a=[],s=[],i=Math.max(t.matched.length,e.matched.length);for(let l=0;l<i;l++){const u=t.matched[l];u&&(e.matched.find(f=>Ni(f,u))?a.push(u):o.push(u));const d=e.matched[l];d&&(t.matched.find(f=>Ni(f,d))||s.push(d))}return[o,a,s]}let $1=()=>location.protocol+"//"+location.host;function tv(e,t){const{pathname:o,search:a,hash:s}=t,i=e.indexOf("#");if(i>-1){let l=s.includes(e.slice(i))?e.slice(i).length:1,u=s.slice(l);return u[0]!=="/"&&(u="/"+u),yh(u,"")}return yh(o,e)+a+s}function T1(e,t,o,a){let s=[],i=[],l=null;const u=({state:y})=>{const k=tv(e,location),_=o.value,w=t.value;let S=0;if(y){if(o.value=k,t.value=y,l&&l===_){l=null;return}S=w?y.position-w.position:0}else a(k);s.forEach(A=>{A(o.value,_,{delta:S,type:vu.pop,direction:S?S>0?Gc.forward:Gc.back:Gc.unknown})})};function d(){l=o.value}function f(y){s.push(y);const k=()=>{const _=s.indexOf(y);_>-1&&s.splice(_,1)};return i.push(k),k}function p(){if(document.visibilityState==="hidden"){const{history:y}=window;if(!y.state)return;y.replaceState(Et({},y.state,{scroll:lc()}),"")}}function g(){for(const y of i)y();i=[],window.removeEventListener("popstate",u),window.removeEventListener("pagehide",p),document.removeEventListener("visibilitychange",p)}return window.addEventListener("popstate",u),window.addEventListener("pagehide",p),document.addEventListener("visibilitychange",p),{pauseListeners:d,listen:f,destroy:g}}function Ch(e,t,o,a=!1,s=!1){return{back:e,current:t,forward:o,replaced:a,position:window.history.length,scroll:s?lc():null}}function M1(e){const{history:t,location:o}=window,a={value:tv(e,o)},s={value:t.state};s.value||i(a.value,{back:null,current:a.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(d,f,p){const g=e.indexOf("#"),y=g>-1?(o.host&&document.querySelector("base")?e:e.slice(g))+d:$1()+e+d;try{t[p?"replaceState":"pushState"](f,"",y),s.value=f}catch(k){console.error(k),o[p?"replace":"assign"](y)}}function l(d,f){i(d,Et({},t.state,Ch(s.value.back,d,s.value.forward,!0),f,{position:s.value.position}),!0),a.value=d}function u(d,f){const p=Et({},s.value,t.state,{forward:d,scroll:lc()});i(p.current,p,!0),i(d,Et({},Ch(a.value,d,null),{position:p.position+1},f),!1),a.value=d}return{location:a,state:s,push:u,replace:l}}function A1(e){e=p1(e);const t=M1(e),o=T1(e,t.state,t.location,t.replace);function a(i,l=!0){l||o.pauseListeners(),history.go(i)}const s=Et({location:"",base:e,go:a,createHref:m1.bind(null,e)},t,o);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function E1(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),A1(e)}let Xa=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var cn=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(cn||{});const P1={type:Xa.Static,value:""},D1=/[a-zA-Z0-9_]/;function R1(e){if(!e)return[[]];if(e==="/")return[[P1]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(k){throw new Error(`ERR (${o})/"${f}": ${k}`)}let o=cn.Static,a=o;const s=[];let i;function l(){i&&s.push(i),i=[]}let u=0,d,f="",p="";function g(){f&&(o===cn.Static?i.push({type:Xa.Static,value:f}):o===cn.Param||o===cn.ParamRegExp||o===cn.ParamRegExpEnd?(i.length>1&&(d==="*"||d==="+")&&t(`A repeatable param (${f}) must be alone in its segment. eg: '/:ids+.`),i.push({type:Xa.Param,value:f,regexp:p,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):t("Invalid state to consume buffer"),f="")}function y(){f+=d}for(;u<e.length;){if(d=e[u++],d==="\\"&&o!==cn.ParamRegExp){a=o,o=cn.EscapeNext;continue}switch(o){case cn.Static:d==="/"?(f&&g(),l()):d===":"?(g(),o=cn.Param):y();break;case cn.EscapeNext:y(),o=a;break;case cn.Param:d==="("?o=cn.ParamRegExp:D1.test(d)?y():(g(),o=cn.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--);break;case cn.ParamRegExp:d===")"?p[p.length-1]=="\\"?p=p.slice(0,-1)+d:o=cn.ParamRegExpEnd:p+=d;break;case cn.ParamRegExpEnd:g(),o=cn.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--,p="";break;default:t("Unknown state");break}}return o===cn.ParamRegExp&&t(`Unfinished custom RegExp for param "${f}"`),g(),l(),s}const Lh="[^/]+?",O1={sensitive:!1,strict:!1,start:!0,end:!0};var Wn=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(Wn||{});const B1=/[.+*?^${}()[\]/\\]/g;function N1(e,t){const o=Et({},O1,t),a=[];let s=o.start?"^":"";const i=[];for(const f of e){const p=f.length?[]:[Wn.Root];o.strict&&!f.length&&(s+="/");for(let g=0;g<f.length;g++){const y=f[g];let k=Wn.Segment+(o.sensitive?Wn.BonusCaseSensitive:0);if(y.type===Xa.Static)g||(s+="/"),s+=y.value.replace(B1,"\\$&"),k+=Wn.Static;else if(y.type===Xa.Param){const{value:_,repeatable:w,optional:S,regexp:A}=y;i.push({name:_,repeatable:w,optional:S});const T=A||Lh;if(T!==Lh){k+=Wn.BonusCustomRegExp;try{`${T}`}catch(P){throw new Error(`Invalid custom RegExp for param "${_}" (${T}): `+P.message)}}let x=w?`((?:${T})(?:/(?:${T}))*)`:`(${T})`;g||(x=S&&f.length<2?`(?:/${x})`:"/"+x),S&&(x+="?"),s+=x,k+=Wn.Dynamic,S&&(k+=Wn.BonusOptional),w&&(k+=Wn.BonusRepeatable),T===".*"&&(k+=Wn.BonusWildcard)}p.push(k)}a.push(p)}if(o.strict&&o.end){const f=a.length-1;a[f][a[f].length-1]+=Wn.BonusStrict}o.strict||(s+="/?"),o.end?s+="$":o.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const l=new RegExp(s,o.sensitive?"":"i");function u(f){const p=f.match(l),g={};if(!p)return null;for(let y=1;y<p.length;y++){const k=p[y]||"",_=i[y-1];g[_.name]=k&&_.repeatable?k.split("/"):k}return g}function d(f){let p="",g=!1;for(const y of e){(!g||!p.endsWith("/"))&&(p+="/"),g=!1;for(const k of y)if(k.type===Xa.Static)p+=k.value;else if(k.type===Xa.Param){const{value:_,repeatable:w,optional:S}=k,A=_ in f?f[_]:"";if(os(A)&&!w)throw new Error(`Provided param "${_}" is an array but it is not repeatable (* or + modifiers)`);const T=os(A)?A.join("/"):A;if(!T)if(S)y.length<2&&(p.endsWith("/")?p=p.slice(0,-1):g=!0);else throw new Error(`Missing required param "${_}"`);p+=T}}return p||"/"}return{re:l,score:a,keys:i,parse:u,stringify:d}}function F1(e,t){let o=0;for(;o<e.length&&o<t.length;){const a=t[o]-e[o];if(a)return a;o++}return e.length<t.length?e.length===1&&e[0]===Wn.Static+Wn.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===Wn.Static+Wn.Segment?1:-1:0}function nv(e,t){let o=0;const a=e.score,s=t.score;for(;o<a.length&&o<s.length;){const i=F1(a[o],s[o]);if(i)return i;o++}if(Math.abs(s.length-a.length)===1){if(Sh(a))return 1;if(Sh(s))return-1}return s.length-a.length}function Sh(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const U1={strict:!1,end:!0,sensitive:!1};function z1(e,t,o){const a=N1(R1(e.path),o),s=Et(a,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function H1(e,t){const o=[],a=new Map;t=gh(U1,t);function s(g){return a.get(g)}function i(g,y,k){const _=!k,w=Ih(g);w.aliasOf=k&&k.record;const S=gh(t,g),A=[w];if("alias"in g){const P=typeof g.alias=="string"?[g.alias]:g.alias;for(const O of P)A.push(Ih(Et({},w,{components:k?k.record.components:w.components,path:O,aliasOf:k?k.record:w})))}let T,x;for(const P of A){const{path:O}=P;if(y&&O[0]!=="/"){const F=y.record.path,E=F[F.length-1]==="/"?"":"/";P.path=y.record.path+(O&&E+O)}if(T=z1(P,y,S),k?k.alias.push(T):(x=x||T,x!==T&&x.alias.push(T),_&&g.name&&!$h(T)&&l(g.name)),ov(T)&&d(T),w.children){const F=w.children;for(let E=0;E<F.length;E++)i(F[E],T,k&&k.children[E])}k=k||T}return x?()=>{l(x)}:Ll}function l(g){if(Qp(g)){const y=a.get(g);y&&(a.delete(g),o.splice(o.indexOf(y),1),y.children.forEach(l),y.alias.forEach(l))}else{const y=o.indexOf(g);y>-1&&(o.splice(y,1),g.record.name&&a.delete(g.record.name),g.children.forEach(l),g.alias.forEach(l))}}function u(){return o}function d(g){const y=j1(g,o);o.splice(y,0,g),g.record.name&&!$h(g)&&a.set(g.record.name,g)}function f(g,y){let k,_={},w,S;if("name"in g&&g.name){if(k=a.get(g.name),!k)throw Fi(nn.MATCHER_NOT_FOUND,{location:g});S=k.record.name,_=Et(xh(y.params,k.keys.filter(x=>!x.optional).concat(k.parent?k.parent.keys.filter(x=>x.optional):[]).map(x=>x.name)),g.params&&xh(g.params,k.keys.map(x=>x.name))),w=k.stringify(_)}else if(g.path!=null)w=g.path,k=o.find(x=>x.re.test(w)),k&&(_=k.parse(w),S=k.record.name);else{if(k=y.name?a.get(y.name):o.find(x=>x.re.test(y.path)),!k)throw Fi(nn.MATCHER_NOT_FOUND,{location:g,currentLocation:y});S=k.record.name,_=Et({},y.params,g.params),w=k.stringify(_)}const A=[];let T=k;for(;T;)A.unshift(T.record),T=T.parent;return{name:S,path:w,params:_,matched:A,meta:G1(A)}}e.forEach(g=>i(g));function p(){o.length=0,a.clear()}return{addRoute:i,resolve:f,removeRoute:l,clearRoutes:p,getRoutes:u,getRecordMatcher:s}}function xh(e,t){const o={};for(const a of t)a in e&&(o[a]=e[a]);return o}function Ih(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:V1(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function V1(e){const t={},o=e.props||!1;if("component"in e)t.default=o;else for(const a in e.components)t[a]=typeof o=="object"?o[a]:o;return t}function $h(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function G1(e){return e.reduce((t,o)=>Et(t,o.meta),{})}function j1(e,t){let o=0,a=t.length;for(;o!==a;){const i=o+a>>1;nv(e,t[i])<0?a=i:o=i+1}const s=Z1(e);return s&&(a=t.lastIndexOf(s,a-1)),a}function Z1(e){let t=e;for(;t=t.parent;)if(ov(t)&&nv(e,t)===0)return t}function ov({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Th(e){const t=lo(rc),o=lo(Qu),a=G(()=>{const d=B(e.to);return t.resolve(d)}),s=G(()=>{const{matched:d}=a.value,{length:f}=d,p=d[f-1],g=o.matched;if(!p||!g.length)return-1;const y=g.findIndex(Ni.bind(null,p));if(y>-1)return y;const k=Mh(d[f-2]);return f>1&&Mh(p)===k&&g[g.length-1].path!==k?g.findIndex(Ni.bind(null,d[f-2])):y}),i=G(()=>s.value>-1&&Y1(o.params,a.value.params)),l=G(()=>s.value>-1&&s.value===o.matched.length-1&&Xp(o.params,a.value.params));function u(d={}){if(J1(d)){const f=t[B(e.replace)?"replace":"push"](B(e.to)).catch(Ll);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>f),f}return Promise.resolve()}return{route:a,href:G(()=>a.value.href),isActive:i,isExactActive:l,navigate:u}}function q1(e){return e.length===1?e[0]:e}const W1=lp({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Th,setup(e,{slots:t}){const o=ii(Th(e)),{options:a}=lo(rc),s=G(()=>({[Ah(e.activeClass,a.linkActiveClass,"router-link-active")]:o.isActive,[Ah(e.exactActiveClass,a.linkExactActiveClass,"router-link-exact-active")]:o.isExactActive}));return()=>{const i=t.default&&q1(t.default(o));return e.custom?i:Ju("a",{"aria-current":o.isExactActive?e.ariaCurrentValue:null,href:o.href,onClick:o.navigate,class:s.value},i)}}}),K1=W1;function J1(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function Y1(e,t){for(const o in t){const a=t[o],s=e[o];if(typeof a=="string"){if(a!==s)return!1}else if(!os(s)||s.length!==a.length||a.some((i,l)=>i.valueOf()!==s[l].valueOf()))return!1}return!0}function Mh(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Ah=(e,t,o)=>e??t??o,X1=lp({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:o}){const a=lo(gu),s=G(()=>e.route||a.value),i=lo(wh,0),l=G(()=>{let f=B(i);const{matched:p}=s.value;let g;for(;(g=p[f])&&!g.components;)f++;return f}),u=G(()=>s.value.matched[l.value]);gl(wh,G(()=>l.value+1)),gl(x1,u),gl(gu,s);const d=$();return qe(()=>[d.value,u.value,e.name],([f,p,g],[y,k,_])=>{p&&(p.instances[g]=f,k&&k!==p&&f&&f===y&&(p.leaveGuards.size||(p.leaveGuards=k.leaveGuards),p.updateGuards.size||(p.updateGuards=k.updateGuards))),f&&p&&(!k||!Ni(p,k)||!y)&&(p.enterCallbacks[g]||[]).forEach(w=>w(f))},{flush:"post"}),()=>{const f=s.value,p=e.name,g=u.value,y=g&&g.components[p];if(!y)return Eh(o.default,{Component:y,route:f});const k=g.props[p],_=k?k===!0?f.params:typeof k=="function"?k(f):k:null,S=Ju(y,Et({},_,t,{onVnodeUnmounted:A=>{A.component.isUnmounted&&(g.instances[p]=null)},ref:d}));return Eh(o.default,{Component:S,route:f})||S}}});function Eh(e,t){if(!e)return null;const o=e(t);return o.length===1?o[0]:o}const Q1=X1;function ek(e){const t=H1(e.routes,e),o=e.parseQuery||L1,a=e.stringifyQuery||bh,s=e.history,i=ll(),l=ll(),u=ll(),d=Km(ca);let f=ca;xi&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const p=Hc.bind(null,_e=>""+_e),g=Hc.bind(null,l1),y=Hc.bind(null,Dl);function k(_e,Ve){let pe,Le;return Qp(_e)?(pe=t.getRecordMatcher(_e),Le=Ve):Le=_e,t.addRoute(Le,pe)}function _(_e){const Ve=t.getRecordMatcher(_e);Ve&&t.removeRoute(Ve)}function w(){return t.getRoutes().map(_e=>_e.record)}function S(_e){return!!t.getRecordMatcher(_e)}function A(_e,Ve){if(Ve=Et({},Ve||d.value),typeof _e=="string"){const fe=Vc(o,_e,Ve.path),we=t.resolve({path:fe.path},Ve),Y=s.createHref(fe.fullPath);return Et(fe,we,{params:y(we.params),hash:Dl(fe.hash),redirectedFrom:void 0,href:Y})}let pe;if(_e.path!=null)pe=Et({},_e,{path:Vc(o,_e.path,Ve.path).path});else{const fe=Et({},_e.params);for(const we in fe)fe[we]==null&&delete fe[we];pe=Et({},_e,{params:g(fe)}),Ve.params=g(Ve.params)}const Le=t.resolve(pe,Ve),Pe=_e.hash||"";Le.params=p(y(Le.params));const q=u1(a,Et({},_e,{hash:s1(Pe),path:Le.path})),X=s.createHref(q);return Et({fullPath:q,hash:Pe,query:a===bh?S1(_e.query):_e.query||{}},Le,{redirectedFrom:void 0,href:X})}function T(_e){return typeof _e=="string"?Vc(o,_e,d.value.path):Et({},_e)}function x(_e,Ve){if(f!==_e)return Fi(nn.NAVIGATION_CANCELLED,{from:Ve,to:_e})}function P(_e){return E(_e)}function O(_e){return P(Et(T(_e),{replace:!0}))}function F(_e,Ve){const pe=_e.matched[_e.matched.length-1];if(pe&&pe.redirect){const{redirect:Le}=pe;let Pe=typeof Le=="function"?Le(_e,Ve):Le;return typeof Pe=="string"&&(Pe=Pe.includes("?")||Pe.includes("#")?Pe=T(Pe):{path:Pe},Pe.params={}),Et({query:_e.query,hash:_e.hash,params:Pe.path!=null?{}:_e.params},Pe)}}function E(_e,Ve){const pe=f=A(_e),Le=d.value,Pe=_e.state,q=_e.force,X=_e.replace===!0,fe=F(pe,Le);if(fe)return E(Et(T(fe),{state:typeof fe=="object"?Et({},Pe,fe.state):Pe,force:q,replace:X}),Ve||pe);const we=pe;we.redirectedFrom=Ve;let Y;return!q&&d1(a,Le,pe)&&(Y=Fi(nn.NAVIGATION_DUPLICATED,{to:we,from:Le}),re(Le,Le,!0,!1)),(Y?Promise.resolve(Y):j(we,Le)).catch(V=>Ts(V)?Ts(V,nn.NAVIGATION_GUARD_REDIRECT)?V:de(V):U(V,we,Le)).then(V=>{if(V){if(Ts(V,nn.NAVIGATION_GUARD_REDIRECT))return E(Et({replace:X},T(V.to),{state:typeof V.to=="object"?Et({},Pe,V.to.state):Pe,force:q}),Ve||we)}else V=W(we,Le,!0,X,Pe);return R(we,Le,V),V})}function N(_e,Ve){const pe=x(_e,Ve);return pe?Promise.reject(pe):Promise.resolve()}function D(_e){const Ve=Je.values().next().value;return Ve&&typeof Ve.runWithContext=="function"?Ve.runWithContext(_e):_e()}function j(_e,Ve){let pe;const[Le,Pe,q]=I1(_e,Ve);pe=jc(Le.reverse(),"beforeRouteLeave",_e,Ve);for(const fe of Le)fe.leaveGuards.forEach(we=>{pe.push(va(we,_e,Ve))});const X=N.bind(null,_e,Ve);return pe.push(X),Ke(pe).then(()=>{pe=[];for(const fe of i.list())pe.push(va(fe,_e,Ve));return pe.push(X),Ke(pe)}).then(()=>{pe=jc(Pe,"beforeRouteUpdate",_e,Ve);for(const fe of Pe)fe.updateGuards.forEach(we=>{pe.push(va(we,_e,Ve))});return pe.push(X),Ke(pe)}).then(()=>{pe=[];for(const fe of q)if(fe.beforeEnter)if(os(fe.beforeEnter))for(const we of fe.beforeEnter)pe.push(va(we,_e,Ve));else pe.push(va(fe.beforeEnter,_e,Ve));return pe.push(X),Ke(pe)}).then(()=>(_e.matched.forEach(fe=>fe.enterCallbacks={}),pe=jc(q,"beforeRouteEnter",_e,Ve,D),pe.push(X),Ke(pe))).then(()=>{pe=[];for(const fe of l.list())pe.push(va(fe,_e,Ve));return pe.push(X),Ke(pe)}).catch(fe=>Ts(fe,nn.NAVIGATION_CANCELLED)?fe:Promise.reject(fe))}function R(_e,Ve,pe){u.list().forEach(Le=>D(()=>Le(_e,Ve,pe)))}function W(_e,Ve,pe,Le,Pe){const q=x(_e,Ve);if(q)return q;const X=Ve===ca,fe=xi?history.state:{};pe&&(Le||X?s.replace(_e.fullPath,Et({scroll:X&&fe&&fe.scroll},Pe)):s.push(_e.fullPath,Pe)),d.value=_e,re(_e,Ve,pe,X),de()}let ne;function ue(){ne||(ne=s.listen((_e,Ve,pe)=>{if(!Fe.listening)return;const Le=A(_e),Pe=F(Le,Fe.currentRoute.value);if(Pe){E(Et(Pe,{replace:!0,force:!0}),Le).catch(Ll);return}f=Le;const q=d.value;xi&&k1(_h(q.fullPath,pe.delta),lc()),j(Le,q).catch(X=>Ts(X,nn.NAVIGATION_ABORTED|nn.NAVIGATION_CANCELLED)?X:Ts(X,nn.NAVIGATION_GUARD_REDIRECT)?(E(Et(T(X.to),{force:!0}),Le).then(fe=>{Ts(fe,nn.NAVIGATION_ABORTED|nn.NAVIGATION_DUPLICATED)&&!pe.delta&&pe.type===vu.pop&&s.go(-1,!1)}).catch(Ll),Promise.reject()):(pe.delta&&s.go(-pe.delta,!1),U(X,Le,q))).then(X=>{X=X||W(Le,q,!1),X&&(pe.delta&&!Ts(X,nn.NAVIGATION_CANCELLED)?s.go(-pe.delta,!1):pe.type===vu.pop&&Ts(X,nn.NAVIGATION_ABORTED|nn.NAVIGATION_DUPLICATED)&&s.go(-1,!1)),R(Le,q,X)}).catch(Ll)}))}let K=ll(),Q=ll(),he;function U(_e,Ve,pe){de(_e);const Le=Q.list();return Le.length?Le.forEach(Pe=>Pe(_e,Ve,pe)):console.error(_e),Promise.reject(_e)}function ee(){return he&&d.value!==ca?Promise.resolve():new Promise((_e,Ve)=>{K.add([_e,Ve])})}function de(_e){return he||(he=!_e,ue(),K.list().forEach(([Ve,pe])=>_e?pe(_e):Ve()),K.reset()),_e}function re(_e,Ve,pe,Le){const{scrollBehavior:Pe}=e;if(!xi||!Pe)return Promise.resolve();const q=!pe&&_1(_h(_e.fullPath,0))||(Le||!pe)&&history.state&&history.state.scroll||null;return un().then(()=>Pe(_e,Ve,q)).then(X=>X&&y1(X)).catch(X=>U(X,_e,Ve))}const De=_e=>s.go(_e);let et;const Je=new Set,Fe={currentRoute:d,listening:!0,addRoute:k,removeRoute:_,clearRoutes:t.clearRoutes,hasRoute:S,getRoutes:w,resolve:A,options:e,push:P,replace:O,go:De,back:()=>De(-1),forward:()=>De(1),beforeEach:i.add,beforeResolve:l.add,afterEach:u.add,onError:Q.add,isReady:ee,install(_e){_e.component("RouterLink",K1),_e.component("RouterView",Q1),_e.config.globalProperties.$router=Fe,Object.defineProperty(_e.config.globalProperties,"$route",{enumerable:!0,get:()=>B(d)}),xi&&!et&&d.value===ca&&(et=!0,P(s.location).catch(Le=>{}));const Ve={};for(const Le in ca)Object.defineProperty(Ve,Le,{get:()=>d.value[Le],enumerable:!0});_e.provide(rc,Fe),_e.provide(Qu,zf(Ve)),_e.provide(gu,d);const pe=_e.unmount;Je.add(_e),_e.unmount=function(){Je.delete(_e),Je.size<1&&(f=ca,ne&&ne(),ne=null,d.value=ca,et=!1,he=!1),pe()}}};function Ke(_e){return _e.reduce((Ve,pe)=>Ve.then(()=>D(pe)),Promise.resolve())}return Fe}function Hi(){return lo(rc)}function cc(e){return lo(Qu)}const tk={__name:"App",setup(e){const t=Hi(),o=$(""),a=["/","/sessions"];return qe(()=>t.currentRoute.value,(s,i)=>{if(!i?.path){o.value="";return}const l=a.indexOf(s.path),u=a.indexOf(i.path);l!==-1&&u!==-1?o.value=l>u?"slide-left":"slide-right":o.value=""},{immediate:!0}),(s,i)=>{const l=ju("router-view");return v(),Ze(l,null,{default:ze(({Component:u,route:d})=>[Ae(ys,{name:o.value,mode:"out-in"},{default:ze(()=>[(v(),Ze(Lg(u),{key:d.path}))]),_:2},1032,["name"])]),_:1})}}},Vi="marshalSessions",nk=30;function Rr(e,t){return`${e}:${t}`}function ed(e){const[t,o]=e.split(":");return{eventId:t,marshalId:o}}function Sa(){try{return JSON.parse(localStorage.getItem(Vi)||"{}")}catch{return{}}}function Or(e){const t=Sa(),o=Object.entries(t).filter(([a])=>a.startsWith(`${e}:`)).map(([a,s])=>({sessionKey:a,...s}));return o.length===0?null:(o.sort((a,s)=>new Date(s.lastAccessed)-new Date(a.lastAccessed)),o[0])}function Ph(e,t){if(!t.marshalId){console.error("Cannot save session without marshalId");return}const o=Sa(),a=Rr(e,t.marshalId);o[a]={...o[a],...t,eventId:e,lastAccessed:new Date().toISOString()},localStorage.setItem(Vi,JSON.stringify(o))}function yu(e){const t=Sa(),{eventId:o,marshalId:a}=ed(e);delete t[e],localStorage.setItem(Vi,JSON.stringify(t)),localStorage.removeItem(`marshalCode_${o}_${a}`)}function sv(e,t){const o=Sa(),a=Rr(e,t);o[a]&&(o[a].lastAccessed=new Date().toISOString(),localStorage.setItem(Vi,JSON.stringify(o)))}function av(){const e=Sa(),t=new Date;t.setDate(t.getDate()-nk);let o=!1;for(const a of Object.keys(e))if(new Date(e[a].lastAccessed)<t){const{eventId:i,marshalId:l}=ed(a);delete e[a],localStorage.removeItem(`marshalCode_${i}_${l}`),o=!0}o&&localStorage.setItem(Vi,JSON.stringify(e))}function iv(){const e=Sa(),t=[];for(let a=0;a<localStorage.length;a++){const s=localStorage.key(a);if(s&&s.startsWith("marshal_")&&!s.startsWith("marshalCode_")&&!s.startsWith("marshalSessions")){const i=s.replace("marshal_",""),l=localStorage.getItem(s);if(l){const u=Rr(i,l);e[u]||(e[u]={marshalId:l,eventId:i,token:null,lastAccessed:new Date().toISOString()})}t.push(s)}}const o=Object.keys(e).filter(a=>!a.includes(":"));for(const a of o){const s=e[a];if(s&&s.marshalId){const i=Rr(a,s.marshalId);e[i]||(e[i]={...s,eventId:a}),delete e[a]}}(t.length>0||o.length>0)&&(localStorage.setItem(Vi,JSON.stringify(e)),t.forEach(a=>localStorage.removeItem(a)))}function ok(){const e=Sa();return Object.entries(e).map(([t,o])=>{const{eventId:a,marshalId:s}=ed(t);return{sessionKey:t,eventId:a,marshalId:s,...o}}).filter(t=>t.token).sort((t,o)=>t.eventDate&&o.eventDate?new Date(t.eventDate)-new Date(o.eventDate):new Date(o.lastAccessed)-new Date(t.lastAccessed))}function lv(){const e=Sa();return Object.values(e).some(t=>t.token)}function rv(e,t){const o=`marshalCode_${e}_${t}`,a=localStorage.getItem(o);return a||localStorage.getItem(`marshalCode_${e}`)}function sk(e,t,o){localStorage.setItem(`marshalCode_${e}_${t}`,o)}function cv(e,t){return function(){return e.apply(t,arguments)}}const{toString:ak}=Object.prototype,{getPrototypeOf:td}=Object,{iterator:uc,toStringTag:uv}=Symbol,dc=(e=>t=>{const o=ak.call(t);return e[o]||(e[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),ss=e=>(e=e.toLowerCase(),t=>dc(t)===e),hc=e=>t=>typeof t===e,{isArray:Gi}=Array,Ui=hc("undefined");function zl(e){return e!==null&&!Ui(e)&&e.constructor!==null&&!Ui(e.constructor)&&ro(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const dv=ss("ArrayBuffer");function ik(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&dv(e.buffer),t}const lk=hc("string"),ro=hc("function"),hv=hc("number"),Hl=e=>e!==null&&typeof e=="object",rk=e=>e===!0||e===!1,yr=e=>{if(dc(e)!=="object")return!1;const t=td(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(uv in e)&&!(uc in e)},ck=e=>{if(!Hl(e)||zl(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},uk=ss("Date"),dk=ss("File"),hk=ss("Blob"),fk=ss("FileList"),pk=e=>Hl(e)&&ro(e.pipe),vk=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ro(e.append)&&((t=dc(e))==="formdata"||t==="object"&&ro(e.toString)&&e.toString()==="[object FormData]"))},mk=ss("URLSearchParams"),[gk,yk,kk,_k]=["ReadableStream","Request","Response","Headers"].map(ss),bk=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Vl(e,t,{allOwnKeys:o=!1}={}){if(e===null||typeof e>"u")return;let a,s;if(typeof e!="object"&&(e=[e]),Gi(e))for(a=0,s=e.length;a<s;a++)t.call(null,e[a],a,e);else{if(zl(e))return;const i=o?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let u;for(a=0;a<l;a++)u=i[a],t.call(null,e[u],u,e)}}function fv(e,t){if(zl(e))return null;t=t.toLowerCase();const o=Object.keys(e);let a=o.length,s;for(;a-- >0;)if(s=o[a],t===s.toLowerCase())return s;return null}const Qa=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,pv=e=>!Ui(e)&&e!==Qa;function ku(){const{caseless:e,skipUndefined:t}=pv(this)&&this||{},o={},a=(s,i)=>{const l=e&&fv(o,i)||i;yr(o[l])&&yr(s)?o[l]=ku(o[l],s):yr(s)?o[l]=ku({},s):Gi(s)?o[l]=s.slice():(!t||!Ui(s))&&(o[l]=s)};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&Vl(arguments[s],a);return o}const wk=(e,t,o,{allOwnKeys:a}={})=>(Vl(t,(s,i)=>{o&&ro(s)?e[i]=cv(s,o):e[i]=s},{allOwnKeys:a}),e),Ck=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Lk=(e,t,o,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),o&&Object.assign(e.prototype,o)},Sk=(e,t,o,a)=>{let s,i,l;const u={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)l=s[i],(!a||a(l,e,t))&&!u[l]&&(t[l]=e[l],u[l]=!0);e=o!==!1&&td(e)}while(e&&(!o||o(e,t))&&e!==Object.prototype);return t},xk=(e,t,o)=>{e=String(e),(o===void 0||o>e.length)&&(o=e.length),o-=t.length;const a=e.indexOf(t,o);return a!==-1&&a===o},Ik=e=>{if(!e)return null;if(Gi(e))return e;let t=e.length;if(!hv(t))return null;const o=new Array(t);for(;t-- >0;)o[t]=e[t];return o},$k=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&td(Uint8Array)),Tk=(e,t)=>{const a=(e&&e[uc]).call(e);let s;for(;(s=a.next())&&!s.done;){const i=s.value;t.call(e,i[0],i[1])}},Mk=(e,t)=>{let o;const a=[];for(;(o=e.exec(t))!==null;)a.push(o);return a},Ak=ss("HTMLFormElement"),Ek=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,a,s){return a.toUpperCase()+s}),Dh=(({hasOwnProperty:e})=>(t,o)=>e.call(t,o))(Object.prototype),Pk=ss("RegExp"),vv=(e,t)=>{const o=Object.getOwnPropertyDescriptors(e),a={};Vl(o,(s,i)=>{let l;(l=t(s,i,e))!==!1&&(a[i]=l||s)}),Object.defineProperties(e,a)},Dk=e=>{vv(e,(t,o)=>{if(ro(e)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const a=e[o];if(ro(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},Rk=(e,t)=>{const o={},a=s=>{s.forEach(i=>{o[i]=!0})};return Gi(e)?a(e):a(String(e).split(t)),o},Ok=()=>{},Bk=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Nk(e){return!!(e&&ro(e.append)&&e[uv]==="FormData"&&e[uc])}const Fk=e=>{const t=new Array(10),o=(a,s)=>{if(Hl(a)){if(t.indexOf(a)>=0)return;if(zl(a))return a;if(!("toJSON"in a)){t[s]=a;const i=Gi(a)?[]:{};return Vl(a,(l,u)=>{const d=o(l,s+1);!Ui(d)&&(i[u]=d)}),t[s]=void 0,i}}return a};return o(e,0)},Uk=ss("AsyncFunction"),zk=e=>e&&(Hl(e)||ro(e))&&ro(e.then)&&ro(e.catch),mv=((e,t)=>e?setImmediate:t?((o,a)=>(Qa.addEventListener("message",({source:s,data:i})=>{s===Qa&&i===o&&a.length&&a.shift()()},!1),s=>{a.push(s),Qa.postMessage(o,"*")}))(`axios@${Math.random()}`,[]):o=>setTimeout(o))(typeof setImmediate=="function",ro(Qa.postMessage)),Hk=typeof queueMicrotask<"u"?queueMicrotask.bind(Qa):typeof process<"u"&&process.nextTick||mv,Vk=e=>e!=null&&ro(e[uc]),Ie={isArray:Gi,isArrayBuffer:dv,isBuffer:zl,isFormData:vk,isArrayBufferView:ik,isString:lk,isNumber:hv,isBoolean:rk,isObject:Hl,isPlainObject:yr,isEmptyObject:ck,isReadableStream:gk,isRequest:yk,isResponse:kk,isHeaders:_k,isUndefined:Ui,isDate:uk,isFile:dk,isBlob:hk,isRegExp:Pk,isFunction:ro,isStream:pk,isURLSearchParams:mk,isTypedArray:$k,isFileList:fk,forEach:Vl,merge:ku,extend:wk,trim:bk,stripBOM:Ck,inherits:Lk,toFlatObject:Sk,kindOf:dc,kindOfTest:ss,endsWith:xk,toArray:Ik,forEachEntry:Tk,matchAll:Mk,isHTMLForm:Ak,hasOwnProperty:Dh,hasOwnProp:Dh,reduceDescriptors:vv,freezeMethods:Dk,toObjectSet:Rk,toCamelCase:Ek,noop:Ok,toFiniteNumber:Bk,findKey:fv,global:Qa,isContextDefined:pv,isSpecCompliantForm:Nk,toJSONObject:Fk,isAsyncFn:Uk,isThenable:zk,setImmediate:mv,asap:Hk,isIterable:Vk};function ft(e,t,o,a,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),o&&(this.config=o),a&&(this.request=a),s&&(this.response=s,this.status=s.status?s.status:null)}Ie.inherits(ft,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ie.toJSONObject(this.config),code:this.code,status:this.status}}});const gv=ft.prototype,yv={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{yv[e]={value:e}});Object.defineProperties(ft,yv);Object.defineProperty(gv,"isAxiosError",{value:!0});ft.from=(e,t,o,a,s,i)=>{const l=Object.create(gv);Ie.toFlatObject(e,l,function(p){return p!==Error.prototype},f=>f!=="isAxiosError");const u=e&&e.message?e.message:"Error",d=t==null&&e?e.code:t;return ft.call(l,u,d,o,a,s),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",i&&Object.assign(l,i),l};const Gk=null;function _u(e){return Ie.isPlainObject(e)||Ie.isArray(e)}function kv(e){return Ie.endsWith(e,"[]")?e.slice(0,-2):e}function Rh(e,t,o){return e?e.concat(t).map(function(s,i){return s=kv(s),!o&&i?"["+s+"]":s}).join(o?".":""):t}function jk(e){return Ie.isArray(e)&&!e.some(_u)}const Zk=Ie.toFlatObject(Ie,{},null,function(t){return/^is[A-Z]/.test(t)});function fc(e,t,o){if(!Ie.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,o=Ie.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,S){return!Ie.isUndefined(S[w])});const a=o.metaTokens,s=o.visitor||p,i=o.dots,l=o.indexes,d=(o.Blob||typeof Blob<"u"&&Blob)&&Ie.isSpecCompliantForm(t);if(!Ie.isFunction(s))throw new TypeError("visitor must be a function");function f(_){if(_===null)return"";if(Ie.isDate(_))return _.toISOString();if(Ie.isBoolean(_))return _.toString();if(!d&&Ie.isBlob(_))throw new ft("Blob is not supported. Use a Buffer instead.");return Ie.isArrayBuffer(_)||Ie.isTypedArray(_)?d&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function p(_,w,S){let A=_;if(_&&!S&&typeof _=="object"){if(Ie.endsWith(w,"{}"))w=a?w:w.slice(0,-2),_=JSON.stringify(_);else if(Ie.isArray(_)&&jk(_)||(Ie.isFileList(_)||Ie.endsWith(w,"[]"))&&(A=Ie.toArray(_)))return w=kv(w),A.forEach(function(x,P){!(Ie.isUndefined(x)||x===null)&&t.append(l===!0?Rh([w],P,i):l===null?w:w+"[]",f(x))}),!1}return _u(_)?!0:(t.append(Rh(S,w,i),f(_)),!1)}const g=[],y=Object.assign(Zk,{defaultVisitor:p,convertValue:f,isVisitable:_u});function k(_,w){if(!Ie.isUndefined(_)){if(g.indexOf(_)!==-1)throw Error("Circular reference detected in "+w.join("."));g.push(_),Ie.forEach(_,function(A,T){(!(Ie.isUndefined(A)||A===null)&&s.call(t,A,Ie.isString(T)?T.trim():T,w,y))===!0&&k(A,w?w.concat(T):[T])}),g.pop()}}if(!Ie.isObject(e))throw new TypeError("data must be an object");return k(e),t}function Oh(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function nd(e,t){this._pairs=[],e&&fc(e,this,t)}const _v=nd.prototype;_v.append=function(t,o){this._pairs.push([t,o])};_v.toString=function(t){const o=t?function(a){return t.call(this,a,Oh)}:Oh;return this._pairs.map(function(s){return o(s[0])+"="+o(s[1])},"").join("&")};function qk(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function bv(e,t,o){if(!t)return e;const a=o&&o.encode||qk;Ie.isFunction(o)&&(o={serialize:o});const s=o&&o.serialize;let i;if(s?i=s(t,o):i=Ie.isURLSearchParams(t)?t.toString():new nd(t,o).toString(a),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class Bh{constructor(){this.handlers=[]}use(t,o,a){return this.handlers.push({fulfilled:t,rejected:o,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Ie.forEach(this.handlers,function(a){a!==null&&t(a)})}}const wv={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Wk=typeof URLSearchParams<"u"?URLSearchParams:nd,Kk=typeof FormData<"u"?FormData:null,Jk=typeof Blob<"u"?Blob:null,Yk={isBrowser:!0,classes:{URLSearchParams:Wk,FormData:Kk,Blob:Jk},protocols:["http","https","file","blob","url","data"]},od=typeof window<"u"&&typeof document<"u",bu=typeof navigator=="object"&&navigator||void 0,Xk=od&&(!bu||["ReactNative","NativeScript","NS"].indexOf(bu.product)<0),Qk=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",e_=od&&window.location.href||"http://localhost",t_=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:od,hasStandardBrowserEnv:Xk,hasStandardBrowserWebWorkerEnv:Qk,navigator:bu,origin:e_},Symbol.toStringTag,{value:"Module"})),Un={...t_,...Yk};function n_(e,t){return fc(e,new Un.classes.URLSearchParams,{visitor:function(o,a,s,i){return Un.isNode&&Ie.isBuffer(o)?(this.append(a,o.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function o_(e){return Ie.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function s_(e){const t={},o=Object.keys(e);let a;const s=o.length;let i;for(a=0;a<s;a++)i=o[a],t[i]=e[i];return t}function Cv(e){function t(o,a,s,i){let l=o[i++];if(l==="__proto__")return!0;const u=Number.isFinite(+l),d=i>=o.length;return l=!l&&Ie.isArray(s)?s.length:l,d?(Ie.hasOwnProp(s,l)?s[l]=[s[l],a]:s[l]=a,!u):((!s[l]||!Ie.isObject(s[l]))&&(s[l]=[]),t(o,a,s[l],i)&&Ie.isArray(s[l])&&(s[l]=s_(s[l])),!u)}if(Ie.isFormData(e)&&Ie.isFunction(e.entries)){const o={};return Ie.forEachEntry(e,(a,s)=>{t(o_(a),s,o,0)}),o}return null}function a_(e,t,o){if(Ie.isString(e))try{return(t||JSON.parse)(e),Ie.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(o||JSON.stringify)(e)}const Gl={transitional:wv,adapter:["xhr","http","fetch"],transformRequest:[function(t,o){const a=o.getContentType()||"",s=a.indexOf("application/json")>-1,i=Ie.isObject(t);if(i&&Ie.isHTMLForm(t)&&(t=new FormData(t)),Ie.isFormData(t))return s?JSON.stringify(Cv(t)):t;if(Ie.isArrayBuffer(t)||Ie.isBuffer(t)||Ie.isStream(t)||Ie.isFile(t)||Ie.isBlob(t)||Ie.isReadableStream(t))return t;if(Ie.isArrayBufferView(t))return t.buffer;if(Ie.isURLSearchParams(t))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return n_(t,this.formSerializer).toString();if((u=Ie.isFileList(t))||a.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return fc(u?{"files[]":t}:t,d&&new d,this.formSerializer)}}return i||s?(o.setContentType("application/json",!1),a_(t)):t}],transformResponse:[function(t){const o=this.transitional||Gl.transitional,a=o&&o.forcedJSONParsing,s=this.responseType==="json";if(Ie.isResponse(t)||Ie.isReadableStream(t))return t;if(t&&Ie.isString(t)&&(a&&!this.responseType||s)){const l=!(o&&o.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(u){if(l)throw u.name==="SyntaxError"?ft.from(u,ft.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Un.classes.FormData,Blob:Un.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ie.forEach(["delete","get","head","post","put","patch"],e=>{Gl.headers[e]={}});const i_=Ie.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),l_=e=>{const t={};let o,a,s;return e&&e.split(`
`).forEach(function(l){s=l.indexOf(":"),o=l.substring(0,s).trim().toLowerCase(),a=l.substring(s+1).trim(),!(!o||t[o]&&i_[o])&&(o==="set-cookie"?t[o]?t[o].push(a):t[o]=[a]:t[o]=t[o]?t[o]+", "+a:a)}),t},Nh=Symbol("internals");function rl(e){return e&&String(e).trim().toLowerCase()}function kr(e){return e===!1||e==null?e:Ie.isArray(e)?e.map(kr):String(e)}function r_(e){const t=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=o.exec(e);)t[a[1]]=a[2];return t}const c_=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Zc(e,t,o,a,s){if(Ie.isFunction(a))return a.call(this,t,o);if(s&&(t=o),!!Ie.isString(t)){if(Ie.isString(a))return t.indexOf(a)!==-1;if(Ie.isRegExp(a))return a.test(t)}}function u_(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,o,a)=>o.toUpperCase()+a)}function d_(e,t){const o=Ie.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+o,{value:function(s,i,l){return this[a].call(this,t,s,i,l)},configurable:!0})})}let co=class{constructor(t){t&&this.set(t)}set(t,o,a){const s=this;function i(u,d,f){const p=rl(d);if(!p)throw new Error("header name must be a non-empty string");const g=Ie.findKey(s,p);(!g||s[g]===void 0||f===!0||f===void 0&&s[g]!==!1)&&(s[g||d]=kr(u))}const l=(u,d)=>Ie.forEach(u,(f,p)=>i(f,p,d));if(Ie.isPlainObject(t)||t instanceof this.constructor)l(t,o);else if(Ie.isString(t)&&(t=t.trim())&&!c_(t))l(l_(t),o);else if(Ie.isObject(t)&&Ie.isIterable(t)){let u={},d,f;for(const p of t){if(!Ie.isArray(p))throw TypeError("Object iterator must return a key-value pair");u[f=p[0]]=(d=u[f])?Ie.isArray(d)?[...d,p[1]]:[d,p[1]]:p[1]}l(u,o)}else t!=null&&i(o,t,a);return this}get(t,o){if(t=rl(t),t){const a=Ie.findKey(this,t);if(a){const s=this[a];if(!o)return s;if(o===!0)return r_(s);if(Ie.isFunction(o))return o.call(this,s,a);if(Ie.isRegExp(o))return o.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,o){if(t=rl(t),t){const a=Ie.findKey(this,t);return!!(a&&this[a]!==void 0&&(!o||Zc(this,this[a],a,o)))}return!1}delete(t,o){const a=this;let s=!1;function i(l){if(l=rl(l),l){const u=Ie.findKey(a,l);u&&(!o||Zc(a,a[u],u,o))&&(delete a[u],s=!0)}}return Ie.isArray(t)?t.forEach(i):i(t),s}clear(t){const o=Object.keys(this);let a=o.length,s=!1;for(;a--;){const i=o[a];(!t||Zc(this,this[i],i,t,!0))&&(delete this[i],s=!0)}return s}normalize(t){const o=this,a={};return Ie.forEach(this,(s,i)=>{const l=Ie.findKey(a,i);if(l){o[l]=kr(s),delete o[i];return}const u=t?u_(i):String(i).trim();u!==i&&delete o[i],o[u]=kr(s),a[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const o=Object.create(null);return Ie.forEach(this,(a,s)=>{a!=null&&a!==!1&&(o[s]=t&&Ie.isArray(a)?a.join(", "):a)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,o])=>t+": "+o).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...o){const a=new this(t);return o.forEach(s=>a.set(s)),a}static accessor(t){const a=(this[Nh]=this[Nh]={accessors:{}}).accessors,s=this.prototype;function i(l){const u=rl(l);a[u]||(d_(s,l),a[u]=!0)}return Ie.isArray(t)?t.forEach(i):i(t),this}};co.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ie.reduceDescriptors(co.prototype,({value:e},t)=>{let o=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[o]=a}}});Ie.freezeMethods(co);function qc(e,t){const o=this||Gl,a=t||o,s=co.from(a.headers);let i=a.data;return Ie.forEach(e,function(u){i=u.call(o,i,s.normalize(),t?t.status:void 0)}),s.normalize(),i}function Lv(e){return!!(e&&e.__CANCEL__)}function ji(e,t,o){ft.call(this,e??"canceled",ft.ERR_CANCELED,t,o),this.name="CanceledError"}Ie.inherits(ji,ft,{__CANCEL__:!0});function Sv(e,t,o){const a=o.config.validateStatus;!o.status||!a||a(o.status)?e(o):t(new ft("Request failed with status code "+o.status,[ft.ERR_BAD_REQUEST,ft.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}function h_(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function f_(e,t){e=e||10;const o=new Array(e),a=new Array(e);let s=0,i=0,l;return t=t!==void 0?t:1e3,function(d){const f=Date.now(),p=a[i];l||(l=f),o[s]=d,a[s]=f;let g=i,y=0;for(;g!==s;)y+=o[g++],g=g%e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),f-l<t)return;const k=p&&f-p;return k?Math.round(y*1e3/k):void 0}}function p_(e,t){let o=0,a=1e3/t,s,i;const l=(f,p=Date.now())=>{o=p,s=null,i&&(clearTimeout(i),i=null),e(...f)};return[(...f)=>{const p=Date.now(),g=p-o;g>=a?l(f,p):(s=f,i||(i=setTimeout(()=>{i=null,l(s)},a-g)))},()=>s&&l(s)]}const Br=(e,t,o=3)=>{let a=0;const s=f_(50,250);return p_(i=>{const l=i.loaded,u=i.lengthComputable?i.total:void 0,d=l-a,f=s(d),p=l<=u;a=l;const g={loaded:l,total:u,progress:u?l/u:void 0,bytes:d,rate:f||void 0,estimated:f&&u&&p?(u-l)/f:void 0,event:i,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(g)},o)},Fh=(e,t)=>{const o=e!=null;return[a=>t[0]({lengthComputable:o,total:e,loaded:a}),t[1]]},Uh=e=>(...t)=>Ie.asap(()=>e(...t)),v_=Un.hasStandardBrowserEnv?((e,t)=>o=>(o=new URL(o,Un.origin),e.protocol===o.protocol&&e.host===o.host&&(t||e.port===o.port)))(new URL(Un.origin),Un.navigator&&/(msie|trident)/i.test(Un.navigator.userAgent)):()=>!0,m_=Un.hasStandardBrowserEnv?{write(e,t,o,a,s,i,l){if(typeof document>"u")return;const u=[`${e}=${encodeURIComponent(t)}`];Ie.isNumber(o)&&u.push(`expires=${new Date(o).toUTCString()}`),Ie.isString(a)&&u.push(`path=${a}`),Ie.isString(s)&&u.push(`domain=${s}`),i===!0&&u.push("secure"),Ie.isString(l)&&u.push(`SameSite=${l}`),document.cookie=u.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function g_(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function y_(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function xv(e,t,o){let a=!g_(t);return e&&(a||o==!1)?y_(e,t):t}const zh=e=>e instanceof co?{...e}:e;function ai(e,t){t=t||{};const o={};function a(f,p,g,y){return Ie.isPlainObject(f)&&Ie.isPlainObject(p)?Ie.merge.call({caseless:y},f,p):Ie.isPlainObject(p)?Ie.merge({},p):Ie.isArray(p)?p.slice():p}function s(f,p,g,y){if(Ie.isUndefined(p)){if(!Ie.isUndefined(f))return a(void 0,f,g,y)}else return a(f,p,g,y)}function i(f,p){if(!Ie.isUndefined(p))return a(void 0,p)}function l(f,p){if(Ie.isUndefined(p)){if(!Ie.isUndefined(f))return a(void 0,f)}else return a(void 0,p)}function u(f,p,g){if(g in t)return a(f,p);if(g in e)return a(void 0,f)}const d={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:u,headers:(f,p,g)=>s(zh(f),zh(p),g,!0)};return Ie.forEach(Object.keys({...e,...t}),function(p){const g=d[p]||s,y=g(e[p],t[p],p);Ie.isUndefined(y)&&g!==u||(o[p]=y)}),o}const Iv=e=>{const t=ai({},e);let{data:o,withXSRFToken:a,xsrfHeaderName:s,xsrfCookieName:i,headers:l,auth:u}=t;if(t.headers=l=co.from(l),t.url=bv(xv(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&l.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),Ie.isFormData(o)){if(Un.hasStandardBrowserEnv||Un.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(Ie.isFunction(o.getHeaders)){const d=o.getHeaders(),f=["content-type","content-length"];Object.entries(d).forEach(([p,g])=>{f.includes(p.toLowerCase())&&l.set(p,g)})}}if(Un.hasStandardBrowserEnv&&(a&&Ie.isFunction(a)&&(a=a(t)),a||a!==!1&&v_(t.url))){const d=s&&i&&m_.read(i);d&&l.set(s,d)}return t},k_=typeof XMLHttpRequest<"u",__=k_&&function(e){return new Promise(function(o,a){const s=Iv(e);let i=s.data;const l=co.from(s.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:f}=s,p,g,y,k,_;function w(){k&&k(),_&&_(),s.cancelToken&&s.cancelToken.unsubscribe(p),s.signal&&s.signal.removeEventListener("abort",p)}let S=new XMLHttpRequest;S.open(s.method.toUpperCase(),s.url,!0),S.timeout=s.timeout;function A(){if(!S)return;const x=co.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders()),O={data:!u||u==="text"||u==="json"?S.responseText:S.response,status:S.status,statusText:S.statusText,headers:x,config:e,request:S};Sv(function(E){o(E),w()},function(E){a(E),w()},O),S=null}"onloadend"in S?S.onloadend=A:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(A)},S.onabort=function(){S&&(a(new ft("Request aborted",ft.ECONNABORTED,e,S)),S=null)},S.onerror=function(P){const O=P&&P.message?P.message:"Network Error",F=new ft(O,ft.ERR_NETWORK,e,S);F.event=P||null,a(F),S=null},S.ontimeout=function(){let P=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const O=s.transitional||wv;s.timeoutErrorMessage&&(P=s.timeoutErrorMessage),a(new ft(P,O.clarifyTimeoutError?ft.ETIMEDOUT:ft.ECONNABORTED,e,S)),S=null},i===void 0&&l.setContentType(null),"setRequestHeader"in S&&Ie.forEach(l.toJSON(),function(P,O){S.setRequestHeader(O,P)}),Ie.isUndefined(s.withCredentials)||(S.withCredentials=!!s.withCredentials),u&&u!=="json"&&(S.responseType=s.responseType),f&&([y,_]=Br(f,!0),S.addEventListener("progress",y)),d&&S.upload&&([g,k]=Br(d),S.upload.addEventListener("progress",g),S.upload.addEventListener("loadend",k)),(s.cancelToken||s.signal)&&(p=x=>{S&&(a(!x||x.type?new ji(null,e,S):x),S.abort(),S=null)},s.cancelToken&&s.cancelToken.subscribe(p),s.signal&&(s.signal.aborted?p():s.signal.addEventListener("abort",p)));const T=h_(s.url);if(T&&Un.protocols.indexOf(T)===-1){a(new ft("Unsupported protocol "+T+":",ft.ERR_BAD_REQUEST,e));return}S.send(i||null)})},b_=(e,t)=>{const{length:o}=e=e?e.filter(Boolean):[];if(t||o){let a=new AbortController,s;const i=function(f){if(!s){s=!0,u();const p=f instanceof Error?f:this.reason;a.abort(p instanceof ft?p:new ji(p instanceof Error?p.message:p))}};let l=t&&setTimeout(()=>{l=null,i(new ft(`timeout ${t} of ms exceeded`,ft.ETIMEDOUT))},t);const u=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(i):f.removeEventListener("abort",i)}),e=null)};e.forEach(f=>f.addEventListener("abort",i));const{signal:d}=a;return d.unsubscribe=()=>Ie.asap(u),d}},w_=function*(e,t){let o=e.byteLength;if(o<t){yield e;return}let a=0,s;for(;a<o;)s=a+t,yield e.slice(a,s),a=s},C_=async function*(e,t){for await(const o of L_(e))yield*w_(o,t)},L_=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:o,value:a}=await t.read();if(o)break;yield a}}finally{await t.cancel()}},Hh=(e,t,o,a)=>{const s=C_(e,t);let i=0,l,u=d=>{l||(l=!0,a&&a(d))};return new ReadableStream({async pull(d){try{const{done:f,value:p}=await s.next();if(f){u(),d.close();return}let g=p.byteLength;if(o){let y=i+=g;o(y)}d.enqueue(new Uint8Array(p))}catch(f){throw u(f),f}},cancel(d){return u(d),s.return()}},{highWaterMark:2})},Vh=64*1024,{isFunction:ur}=Ie,S_=(({Request:e,Response:t})=>({Request:e,Response:t}))(Ie.global),{ReadableStream:Gh,TextEncoder:jh}=Ie.global,Zh=(e,...t)=>{try{return!!e(...t)}catch{return!1}},x_=e=>{e=Ie.merge.call({skipUndefined:!0},S_,e);const{fetch:t,Request:o,Response:a}=e,s=t?ur(t):typeof fetch=="function",i=ur(o),l=ur(a);if(!s)return!1;const u=s&&ur(Gh),d=s&&(typeof jh=="function"?(_=>w=>_.encode(w))(new jh):async _=>new Uint8Array(await new o(_).arrayBuffer())),f=i&&u&&Zh(()=>{let _=!1;const w=new o(Un.origin,{body:new Gh,method:"POST",get duplex(){return _=!0,"half"}}).headers.has("Content-Type");return _&&!w}),p=l&&u&&Zh(()=>Ie.isReadableStream(new a("").body)),g={stream:p&&(_=>_.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(_=>{!g[_]&&(g[_]=(w,S)=>{let A=w&&w[_];if(A)return A.call(w);throw new ft(`Response type '${_}' is not supported`,ft.ERR_NOT_SUPPORT,S)})});const y=async _=>{if(_==null)return 0;if(Ie.isBlob(_))return _.size;if(Ie.isSpecCompliantForm(_))return(await new o(Un.origin,{method:"POST",body:_}).arrayBuffer()).byteLength;if(Ie.isArrayBufferView(_)||Ie.isArrayBuffer(_))return _.byteLength;if(Ie.isURLSearchParams(_)&&(_=_+""),Ie.isString(_))return(await d(_)).byteLength},k=async(_,w)=>{const S=Ie.toFiniteNumber(_.getContentLength());return S??y(w)};return async _=>{let{url:w,method:S,data:A,signal:T,cancelToken:x,timeout:P,onDownloadProgress:O,onUploadProgress:F,responseType:E,headers:N,withCredentials:D="same-origin",fetchOptions:j}=Iv(_),R=t||fetch;E=E?(E+"").toLowerCase():"text";let W=b_([T,x&&x.toAbortSignal()],P),ne=null;const ue=W&&W.unsubscribe&&(()=>{W.unsubscribe()});let K;try{if(F&&f&&S!=="get"&&S!=="head"&&(K=await k(N,A))!==0){let re=new o(w,{method:"POST",body:A,duplex:"half"}),De;if(Ie.isFormData(A)&&(De=re.headers.get("content-type"))&&N.setContentType(De),re.body){const[et,Je]=Fh(K,Br(Uh(F)));A=Hh(re.body,Vh,et,Je)}}Ie.isString(D)||(D=D?"include":"omit");const Q=i&&"credentials"in o.prototype,he={...j,signal:W,method:S.toUpperCase(),headers:N.normalize().toJSON(),body:A,duplex:"half",credentials:Q?D:void 0};ne=i&&new o(w,he);let U=await(i?R(ne,j):R(w,he));const ee=p&&(E==="stream"||E==="response");if(p&&(O||ee&&ue)){const re={};["status","statusText","headers"].forEach(Fe=>{re[Fe]=U[Fe]});const De=Ie.toFiniteNumber(U.headers.get("content-length")),[et,Je]=O&&Fh(De,Br(Uh(O),!0))||[];U=new a(Hh(U.body,Vh,et,()=>{Je&&Je(),ue&&ue()}),re)}E=E||"text";let de=await g[Ie.findKey(g,E)||"text"](U,_);return!ee&&ue&&ue(),await new Promise((re,De)=>{Sv(re,De,{data:de,headers:co.from(U.headers),status:U.status,statusText:U.statusText,config:_,request:ne})})}catch(Q){throw ue&&ue(),Q&&Q.name==="TypeError"&&/Load failed|fetch/i.test(Q.message)?Object.assign(new ft("Network Error",ft.ERR_NETWORK,_,ne),{cause:Q.cause||Q}):ft.from(Q,Q&&Q.code,_,ne)}}},I_=new Map,$v=e=>{let t=e&&e.env||{};const{fetch:o,Request:a,Response:s}=t,i=[a,s,o];let l=i.length,u=l,d,f,p=I_;for(;u--;)d=i[u],f=p.get(d),f===void 0&&p.set(d,f=u?new Map:x_(t)),p=f;return f};$v();const sd={http:Gk,xhr:__,fetch:{get:$v}};Ie.forEach(sd,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const qh=e=>`- ${e}`,$_=e=>Ie.isFunction(e)||e===null||e===!1;function T_(e,t){e=Ie.isArray(e)?e:[e];const{length:o}=e;let a,s;const i={};for(let l=0;l<o;l++){a=e[l];let u;if(s=a,!$_(a)&&(s=sd[(u=String(a)).toLowerCase()],s===void 0))throw new ft(`Unknown adapter '${u}'`);if(s&&(Ie.isFunction(s)||(s=s.get(t))))break;i[u||"#"+l]=s}if(!s){const l=Object.entries(i).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let u=o?l.length>1?`since :
`+l.map(qh).join(`
`):" "+qh(l[0]):"as no adapter specified";throw new ft("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return s}const Tv={getAdapter:T_,adapters:sd};function Wc(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ji(null,e)}function Wh(e){return Wc(e),e.headers=co.from(e.headers),e.data=qc.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Tv.getAdapter(e.adapter||Gl.adapter,e)(e).then(function(a){return Wc(e),a.data=qc.call(e,e.transformResponse,a),a.headers=co.from(a.headers),a},function(a){return Lv(a)||(Wc(e),a&&a.response&&(a.response.data=qc.call(e,e.transformResponse,a.response),a.response.headers=co.from(a.response.headers))),Promise.reject(a)})}const Mv="1.13.2",pc={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{pc[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const Kh={};pc.transitional=function(t,o,a){function s(i,l){return"[Axios v"+Mv+"] Transitional option '"+i+"'"+l+(a?". "+a:"")}return(i,l,u)=>{if(t===!1)throw new ft(s(l," has been removed"+(o?" in "+o:"")),ft.ERR_DEPRECATED);return o&&!Kh[l]&&(Kh[l]=!0,console.warn(s(l," has been deprecated since v"+o+" and will be removed in the near future"))),t?t(i,l,u):!0}};pc.spelling=function(t){return(o,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function M_(e,t,o){if(typeof e!="object")throw new ft("options must be an object",ft.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let s=a.length;for(;s-- >0;){const i=a[s],l=t[i];if(l){const u=e[i],d=u===void 0||l(u,i,e);if(d!==!0)throw new ft("option "+i+" must be "+d,ft.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new ft("Unknown option "+i,ft.ERR_BAD_OPTION)}}const _r={assertOptions:M_,validators:pc},ds=_r.validators;let ni=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Bh,response:new Bh}}async request(t,o){try{return await this._request(t,o)}catch(a){if(a instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(t,o){typeof t=="string"?(o=o||{},o.url=t):o=t||{},o=ai(this.defaults,o);const{transitional:a,paramsSerializer:s,headers:i}=o;a!==void 0&&_r.assertOptions(a,{silentJSONParsing:ds.transitional(ds.boolean),forcedJSONParsing:ds.transitional(ds.boolean),clarifyTimeoutError:ds.transitional(ds.boolean)},!1),s!=null&&(Ie.isFunction(s)?o.paramsSerializer={serialize:s}:_r.assertOptions(s,{encode:ds.function,serialize:ds.function},!0)),o.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?o.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:o.allowAbsoluteUrls=!0),_r.assertOptions(o,{baseUrl:ds.spelling("baseURL"),withXsrfToken:ds.spelling("withXSRFToken")},!0),o.method=(o.method||this.defaults.method||"get").toLowerCase();let l=i&&Ie.merge(i.common,i[o.method]);i&&Ie.forEach(["delete","get","head","post","put","patch","common"],_=>{delete i[_]}),o.headers=co.concat(l,i);const u=[];let d=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(o)===!1||(d=d&&w.synchronous,u.unshift(w.fulfilled,w.rejected))});const f=[];this.interceptors.response.forEach(function(w){f.push(w.fulfilled,w.rejected)});let p,g=0,y;if(!d){const _=[Wh.bind(this),void 0];for(_.unshift(...u),_.push(...f),y=_.length,p=Promise.resolve(o);g<y;)p=p.then(_[g++],_[g++]);return p}y=u.length;let k=o;for(;g<y;){const _=u[g++],w=u[g++];try{k=_(k)}catch(S){w.call(this,S);break}}try{p=Wh.call(this,k)}catch(_){return Promise.reject(_)}for(g=0,y=f.length;g<y;)p=p.then(f[g++],f[g++]);return p}getUri(t){t=ai(this.defaults,t);const o=xv(t.baseURL,t.url,t.allowAbsoluteUrls);return bv(o,t.params,t.paramsSerializer)}};Ie.forEach(["delete","get","head","options"],function(t){ni.prototype[t]=function(o,a){return this.request(ai(a||{},{method:t,url:o,data:(a||{}).data}))}});Ie.forEach(["post","put","patch"],function(t){function o(a){return function(i,l,u){return this.request(ai(u||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}ni.prototype[t]=o(),ni.prototype[t+"Form"]=o(!0)});let A_=class Av{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(i){o=i});const a=this;this.promise.then(s=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](s);a._listeners=null}),this.promise.then=s=>{let i;const l=new Promise(u=>{a.subscribe(u),i=u}).then(s);return l.cancel=function(){a.unsubscribe(i)},l},t(function(i,l,u){a.reason||(a.reason=new ji(i,l,u),o(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const o=this._listeners.indexOf(t);o!==-1&&this._listeners.splice(o,1)}toAbortSignal(){const t=new AbortController,o=a=>{t.abort(a)};return this.subscribe(o),t.signal.unsubscribe=()=>this.unsubscribe(o),t.signal}static source(){let t;return{token:new Av(function(s){t=s}),cancel:t}}};function E_(e){return function(o){return e.apply(null,o)}}function P_(e){return Ie.isObject(e)&&e.isAxiosError===!0}const wu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(wu).forEach(([e,t])=>{wu[t]=e});function Ev(e){const t=new ni(e),o=cv(ni.prototype.request,t);return Ie.extend(o,ni.prototype,t,{allOwnKeys:!0}),Ie.extend(o,t,null,{allOwnKeys:!0}),o.create=function(s){return Ev(ai(e,s))},o}const an=Ev(Gl);an.Axios=ni;an.CanceledError=ji;an.CancelToken=A_;an.isCancel=Lv;an.VERSION=Mv;an.toFormData=fc;an.AxiosError=ft;an.Cancel=an.CanceledError;an.all=function(t){return Promise.all(t)};an.spread=E_;an.isAxiosError=P_;an.mergeConfig=ai;an.AxiosHeaders=co;an.formToJSON=e=>Cv(Ie.isHTMLForm(e)?new FormData(e):e);an.getAdapter=Tv.getAdapter;an.HttpStatusCode=wu;an.default=an;const{Axios:qz,AxiosError:Wz,CanceledError:Kz,isCancel:Jz,CancelToken:Yz,VERSION:Xz,all:Qz,Cancel:eH,isAxiosError:tH,spread:nH,toFormData:oH,AxiosHeaders:sH,HttpStatusCode:aH,formToJSON:iH,getAdapter:lH,mergeConfig:rH}=an,ul="https://sterobson-volunteercheckin-testing.azurewebsites.net/api",D_="VolunteerCheckinOffline",R_=1;let Yo=null;async function js(){return Yo||new Promise((e,t)=>{const o=indexedDB.open(D_,R_);o.onerror=()=>{console.error("Failed to open IndexedDB:",o.error),t(o.error)},o.onsuccess=()=>{Yo=o.result,e(Yo)},o.onupgradeneeded=a=>{const s=a.target.result;s.objectStoreNames.contains("eventData")||s.createObjectStore("eventData",{keyPath:"eventId"}),s.objectStoreNames.contains("pendingActions")||s.createObjectStore("pendingActions",{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),s.objectStoreNames.contains("syncMeta")||s.createObjectStore("syncMeta",{keyPath:"key"})}})}async function Rl(e,t){return await js(),new Promise((o,a)=>{const s=Yo.transaction(["eventData","syncMeta"],"readwrite"),i=s.objectStore("eventData"),l=s.objectStore("syncMeta"),u={eventId:e,...t,cachedAt:new Date().toISOString()};i.put(u),l.put({key:`lastSync_${e}`,value:new Date().toISOString()}),s.oncomplete=()=>o(),s.onerror=()=>a(s.error)})}async function _a(e){return await js(),new Promise((t,o)=>{const i=Yo.transaction(["eventData"],"readonly").objectStore("eventData").get(e);i.onsuccess=()=>t(i.result||null),i.onerror=()=>o(i.error)})}async function br(e,t,o){const a=await _a(e);a&&(a[t]=o,a.cachedAt=new Date().toISOString(),await Rl(e,a))}async function O_(e){return await js(),new Promise((t,o)=>{const s=Yo.transaction(["pendingActions"],"readwrite").objectStore("pendingActions"),i={...e,createdAt:new Date().toISOString(),attempts:0,lastAttempt:null,status:"pending"},l=s.add(i);l.onsuccess=()=>t(l.result),l.onerror=()=>o(l.error)})}async function Pv(){return await js(),new Promise((e,t)=>{const i=Yo.transaction(["pendingActions"],"readonly").objectStore("pendingActions").index("createdAt").getAll();i.onsuccess=()=>{const l=i.result.filter(u=>u.status==="pending"||u.status==="retrying");e(l)},i.onerror=()=>t(i.error)})}async function Nr(){return(await Pv()).length}async function Jh(e,t){return await js(),new Promise((o,a)=>{const s=Yo.transaction(["pendingActions"],"readwrite"),i=s.objectStore("pendingActions"),l=i.get(e);l.onsuccess=()=>{const u=l.result;u&&(Object.assign(u,t),i.put(u))},s.oncomplete=()=>o(),s.onerror=()=>a(s.error)})}async function Yh(e){return await js(),new Promise((t,o)=>{const i=Yo.transaction(["pendingActions"],"readwrite").objectStore("pendingActions").delete(e);i.onsuccess=()=>t(),i.onerror=()=>o(i.error)})}async function B_(e){return await js(),new Promise((t,o)=>{const i=Yo.transaction(["syncMeta"],"readonly").objectStore("syncMeta").get(`lastSync_${e}`);i.onsuccess=()=>t(i.result?.value||null),i.onerror=()=>o(i.error)})}const We=an.create({baseURL:ul,headers:{"Content-Type":"application/json"},timeout:15e3});let Cu=!1,Dv={type:null,eventId:null};function _o(e,t=null){Dv={type:e,eventId:t}}async function N_(){}function Xh(e){const t=[/\/events\/([^/]+)/,/\/assignments\/([^/]+)/,/\/locations\/([^/]+)/,/\/checklist-items\/([^/]+)/,/\/areas\/([^/]+)/,/\/marshals\/([^/]+)/];for(const o of t){const a=e.match(o);if(a)return a[1]}return null}function F_(e){return!!(!e.response&&e.request||e.response&&e.response.status>=500||e.code==="ECONNABORTED")}function Rv(){const e=window.location.hash||"";if(e.includes("/admin/"))return{type:"admin",eventId:null};const t=e.match(/#\/event\/([^/?]+)/);return t?{type:"marshal",eventId:t[1]}:e.includes("/marshal")?{type:null,eventId:null}:Dv}const U_=["/auth/marshal-login","/auth/request-login","/auth/verify-token","/auth/instant-login"];We.interceptors.request.use(e=>{if(U_.some(i=>e.url?.includes(i)))return e;const o=localStorage.getItem("adminEmail");o&&(e.headers["X-Admin-Email"]=o);const a=Rv();let s=null;if(a.type==="marshal"&&a.eventId){const i=Or(a.eventId);i?.token&&(s=i.token)}return s||(s=localStorage.getItem("sessionToken")),s&&(e.headers.Authorization=`Bearer ${s}`),e});let Fr=0;const z_=2;function H_(){if(Fr++,Fr>=z_&&Rv().type!=="marshal"){localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken");const t=window.location.hash||"";!t.includes("login")&&!t.includes("/verify")&&(window.location.href="/VolunteerCheckin/testing/#/?login=true")}}function V_(){Fr=0}function Kc(){Fr=0}function G_(e){if(!e?.url)return!1;const t=localStorage.getItem("sessionToken"),o=e.headers?.Authorization||e.headers?.authorization;if(o&&t&&o.replace("Bearer ","")!==t||(e.url||"").includes("/auth/marshal-login"))return!0;const s=window.location.hash||"";return!!(s.match(/#\/event\/[^/?]+/)||s==="#/marshal"||s.startsWith("#/marshal?"))}We.interceptors.response.use(e=>{Cu=!1,V_();const t=e.config.url,o=Xh(t);return e.config.method,e},async e=>{const t=e.config;if(e.response&&(e.response.status===401||e.response.status===403))return G_(t)||H_(),Promise.reject(e);if(F_(e)&&(Cu=!0,t.method==="get")){const o=Xh(t.url);if(o){const a=await _a(o);if(a)return console.log("Returning cached data for:",t.url),Promise.resolve({data:a,status:200,statusText:"OK (cached)",headers:{},config:t,cached:!0})}}return Promise.reject(e)});async function ko(e,t,o){return await O_({type:e,payload:t,eventId:t.eventId}),await N_(),{data:o,status:200,statusText:"OK (queued)",queued:!0}}function Rn(){return Cu||!navigator.onLine}const j_={check:()=>We.head("/health")},Lu=()=>"https://sterobson.github.io/VolunteerCheckin/testing".replace(/\/?#?\/?$/,""),ms={requestLogin:e=>We.post("/auth/request-login",{email:e,frontendUrl:Lu()}),verifyToken:e=>We.post("/auth/verify-token",{token:e}),instantLogin:e=>We.post("/auth/instant-login",{email:e}),createAdmin:e=>We.post("/auth/create-admin",{email:e}),marshalLogin:(e,t)=>We.post("/auth/marshal-login",{eventId:e,magicCode:t}),getMe:e=>We.get("/auth/me",{params:{eventId:e}}),logout:()=>We.post("/auth/logout")},dr={getProfile:()=>We.get("/auth/profile"),updateProfile:e=>We.put("/auth/profile",e),getPerson:(e,t)=>We.get(`/people/${e}`,{params:{eventId:t}}),updatePerson:(e,t,o)=>We.put(`/people/${e}`,o,{params:{eventId:t}})},ma={create:e=>We.post("/events",e),getAll:()=>We.get("/events"),getById:e=>We.get(`/events/${e}`),update:(e,t)=>We.put(`/events/${e}`,t),delete:e=>We.delete(`/events/${e}`),uploadGpx:(e,t)=>{const o=new FormData;return o.append("gpx",t),We.post(`/events/${e}/upload-gpx`,o,{headers:{"Content-Type":"multipart/form-data"}})}},Jn={create:e=>We.post("/locations",e),getById:(e,t)=>We.get(`/locations/${e}/${t}`),getByEvent:e=>We.get(`/events/${e}/locations`),update:(e,t,o)=>We.put(`/locations/${e}/${t}`,o),delete:(e,t)=>We.delete(`/locations/${e}/${t}`),importCsv:(e,t,o)=>{const a=new FormData;return a.append("csv",t),We.post(`/locations/import/${e}?deleteExisting=${o}`,a,{headers:{"Content-Type":"multipart/form-data"}})},bulkUpdateTimes:(e,t)=>We.post(`/locations/bulk-update-times/${e}`,{timeDelta:t}),updatePosition:(e,t,o)=>We.post(`/locations/${e}/${t}/update-position`,o),getDynamicCheckpoints:e=>We.get(`/events/${e}/dynamic-checkpoints`)},dl={create:e=>We.post("/assignments",e),getById:(e,t)=>We.get(`/assignments/${e}/${t}`),getByEvent:e=>We.get(`/assignments/event/${e}`),delete:(e,t)=>We.delete(`/assignments/${e}/${t}`),getEventStatus:e=>We.get(`/events/${e}/status`)},ba={checkIn:e=>We.post("/checkin",e),toggleCheckIn:(e,t,{latitude:o,longitude:a,action:s}={})=>We.post(`/checkin/${e}/${t}/toggle`,{latitude:o??null,longitude:a??null,action:s??null}),adminCheckIn:(e,t)=>We.post(`/checkin/admin/${e}/${t}`)},Jc={getAdmins:e=>We.get(`/events/${e}/admins`),addAdmin:(e,t)=>We.post(`/events/${e}/admins`,{userEmail:t}),removeAdmin:(e,t)=>We.delete(`/events/${e}/admins/${t}`)},gs={create:e=>We.post("/marshals",e),getByEvent:e=>We.get(`/events/${e}/marshals`),getById:(e,t)=>We.get(`/marshals/${e}/${t}`),update:(e,t,o)=>We.put(`/marshals/${e}/${t}`,o),delete:(e,t)=>We.delete(`/marshals/${e}/${t}`),getMagicLink:(e,t)=>We.get(`/marshals/${e}/${t}/magic-link`,{params:{frontendUrl:Lu()}}),sendMagicLink:(e,t)=>We.post(`/marshals/${e}/${t}/send-magic-link`,{frontendUrl:Lu()}),importCsv:(e,t)=>{const o=new FormData;return o.append("csv",t),We.post(`/marshals/import/${e}`,o,{headers:{"Content-Type":"multipart/form-data"}})}},ga={create:e=>We.post("/areas",e),getByEvent:e=>We.get(`/events/${e}/areas`),getById:(e,t)=>We.get(`/areas/${e}/${t}`),update:(e,t,o)=>We.put(`/areas/${e}/${t}`,o),delete:(e,t)=>We.delete(`/areas/${e}/${t}`),recalculate:e=>We.post(`/areas/recalculate/${e}`),getCheckpoints:(e,t)=>We.get(`/areas/${e}/${t}/locations`),getAreaLeadDashboard:e=>We.get(`/events/${e}/area-lead-dashboard`)},Dt={create:(e,t)=>We.post(`/events/${e}/checklist-items`,t),getByEvent:e=>We.get(`/events/${e}/checklist-items`),getById:(e,t)=>We.get(`/checklist-items/${e}/${t}`),update:(e,t,o)=>We.put(`/checklist-items/${e}/${t}`,o),delete:(e,t)=>We.delete(`/checklist-items/${e}/${t}`),getReport:e=>We.get(`/events/${e}/checklist-report`),getMarshalChecklist:(e,t)=>We.get(`/events/${e}/marshals/${t}/checklist`),getCheckpointChecklist:(e,t)=>We.get(`/events/${e}/locations/${t}/checklist`),getAreaChecklist:(e,t)=>We.get(`/events/${e}/areas/${t}/checklist`),complete:(e,t,o)=>We.post(`/checklist-items/${e}/${t}/complete`,o),uncomplete:(e,t,o)=>We.post(`/checklist-items/${e}/${t}/uncomplete`,o)},Es={create:(e,t)=>We.post(`/events/${e}/notes`,t),getByEvent:e=>We.get(`/events/${e}/notes`),getById:(e,t)=>We.get(`/events/${e}/notes/${t}`),update:(e,t,o)=>We.put(`/events/${e}/notes/${t}`,o),delete:(e,t)=>We.delete(`/events/${e}/notes/${t}`),getMarshalNotes:(e,t)=>We.get(`/events/${e}/marshals/${t}/notes`),getMyNotes:e=>We.get(`/events/${e}/my-notes`)},da={create:(e,t)=>We.post(`/events/${e}/contacts`,t),getByEvent:e=>We.get(`/events/${e}/contacts`),getById:(e,t)=>We.get(`/events/${e}/contacts/${t}`),update:(e,t,o)=>We.put(`/events/${e}/contacts/${t}`,o),delete:(e,t)=>We.delete(`/events/${e}/contacts/${t}`),getRoles:e=>We.get(`/events/${e}/contact-roles`),getMarshalContacts:(e,t)=>We.get(`/events/${e}/marshals/${t}/contacts`),getMyContacts:e=>We.get(`/events/${e}/my-contacts`)},ps={create:(e,t)=>We.post(`/events/${e}/incidents`,t),getAll:(e,t={})=>We.get(`/events/${e}/incidents`,{params:t}),getForArea:(e,t)=>We.get(`/events/${e}/areas/${t}/incidents`),get:(e,t)=>We.get(`/events/${e}/incidents/${t}`),updateStatus:(e,t,o)=>We.patch(`/events/${e}/incidents/${t}`,o),addNote:(e,t,o)=>We.post(`/events/${e}/incidents/${t}/notes`,{note:o})},je=(e,t)=>{const o=e.__vccOpts||e;for(const[a,s]of t)o[a]=s;return o},Z_={class:"hero-animation-container"},q_={__name:"HeroMapAnimation",props:{animate:{type:Boolean,default:!0}},setup(e){const t=e,o=$(!1);return on(()=>{t.animate?requestAnimationFrame(()=>{o.value=!0}):o.value=!0}),(a,s)=>(v(),m("div",Z_,[(v(),m("svg",{viewBox:"0 0 400 350",class:ce(["hero-map-svg",{animate:o.value&&e.animate,"no-animate":o.value&&!e.animate}])},[...s[0]||(s[0]=[Ar(`<defs data-v-cec8ae43><clipPath id="mapClip" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" data-v-cec8ae43></polygon></clipPath></defs><g class="map-group" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" fill="#c8e6c0" stroke="#8fbc8f" stroke-width="3" data-v-cec8ae43></polygon><g clip-path="url(#mapClip)" class="contours" data-v-cec8ae43><ellipse cx="300" cy="60" rx="35" ry="12" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="25" ry="8" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="15" ry="5" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="80" ry="40" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="55" ry="28" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="50" ry="25" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse></g><g clip-path="url(#mapClip)" class="roads" data-v-cec8ae43><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#1a5276" stroke-width="18" stroke-linecap="round" data-v-cec8ae43></path><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#5dade2" stroke-width="12" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#cc8800" stroke-width="10" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#ffcc00" stroke-width="6" stroke-linecap="round" data-v-cec8ae43></path></g><path id="routePath" d="M 60,360
             L 200,250
             L 150,150
             L 280,100
             L 450,60" fill="none" stroke="none" data-v-cec8ae43></path><g class="trail-segments" data-v-cec8ae43><path class="trail-seg trail-seg-1" d="M 60,360 L 200,250" fill="none" stroke="#dc3545" stroke-width="12" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-2" d="M 200,250 L 150,150" fill="none" stroke="#dc3545" stroke-width="9" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-3" d="M 150,150 L 280,100" fill="none" stroke="#dc3545" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-4" d="M 280,100 L 450,60" fill="none" stroke="#dc3545" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path></g><g class="checkpoint checkpoint-1" transform="translate(200, 250)" data-v-cec8ae43><ellipse cx="0" cy="8" rx="40" ry="12" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="4" rx="30" ry="10" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="25" ry="8" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-2" transform="translate(150, 150)" data-v-cec8ae43><ellipse cx="0" cy="6" rx="18" ry="8" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="3" rx="15" ry="6" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="12" ry="5" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-3" transform="translate(280, 100)" data-v-cec8ae43><ellipse cx="0" cy="4" rx="12" ry="5" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="2" rx="10" ry="4" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="8" ry="3" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="marshal marshal-1" transform="translate(200, 250)" data-v-cec8ae43><circle cx="0" cy="-28" r="12" fill="#444" data-v-cec8ae43></circle><path d="M 20,0 v-8 a12 12 0 0 0-12-12 h-16 a12 12 0 0 0-12 12 v8" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-2" transform="translate(150, 150)" data-v-cec8ae43><circle cx="0" cy="-18" r="8" fill="#444" data-v-cec8ae43></circle><path d="M 12,0 v-5 a8 8 0 0 0-8-8 h-8 a8 8 0 0 0-8 8 v5" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-3" transform="translate(280, 100)" data-v-cec8ae43><circle cx="0" cy="-12" r="6" fill="#444" data-v-cec8ae43></circle><path d="M 9,0 v-4 a6 6 0 0 0-6-6 h-6 a6 6 0 0 0-6 6 v4" fill="#444" data-v-cec8ae43></path></g><g clip-path="url(#mapClip)" class="trees" data-v-cec8ae43><g transform="translate(45, 280)" data-v-cec8ae43><polygon points="0,-20 12,0 -12,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-34 10,-12 -10,-12" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-46 8,-26 -8,-26" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-3" y="0" width="6" height="8" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(75, 255)" data-v-cec8ae43><polygon points="0,-18 10,0 -10,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-30 8,-10 -8,-10" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-40 6,-22 -6,-22" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="6" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(350, 230)" data-v-cec8ae43><polygon points="0,-20 11,0 -11,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-33 9,-11 -9,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-44 7,-24 -7,-24" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="7" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(60, 140)" data-v-cec8ae43><polygon points="0,-12 7,0 -7,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-20 5.5,-8 -5.5,-8" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-27 4,-15 -4,-15" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="4" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 70)" data-v-cec8ae43><polygon points="0,-9 5,0 -5,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-15 4,-6 -4,-6" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-20 3,-11 -3,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-1" y="0" width="2" height="3" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 140)" data-v-cec8ae43><polygon points="0,-14 8,0 -8,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-24 6,-9 -6,-9" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-32 5,-18 -5,-18" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="5" fill="#5d4037" data-v-cec8ae43></rect></g></g></g>`,2)])],2))]))}},W_=je(q_,[["__scopeId","data-v-cec8ae43"]]),K_={class:"hero-header"},J_={__name:"HeroHeader",props:{title:{type:String,default:""}},setup(e){const t=$(!1);return on(()=>{window.__heroAnimationPlayed?t.value=!1:(t.value=!0,window.__heroAnimationPlayed=!0)}),(o,a)=>(v(),m("div",K_,[Ae(W_,{animate:t.value},null,8,["animate"]),e.title?(v(),m("div",{key:0,class:ce(["hero-overlay",{"no-animate":!t.value}])},[r("h1",null,C(e.title),1)],2)):M("",!0)]))}},Ov=je(J_,[["__scopeId","data-v-c824ab01"]]),jl=Yu("auth",()=>{const e=$(localStorage.getItem("adminEmail")||null),t=$(!!e.value),o=$(!1);return{adminEmail:e,isAuthenticated:t,loginPending:o,requestLogin:async u=>{const d=await ms.requestLogin(u);return d.data.success&&(o.value=!0),d.data},verifyToken:async u=>{const d=await ms.verifyToken(u);return d.data.success&&(e.value=d.data.person?.email,t.value=!0,o.value=!1,localStorage.setItem("adminEmail",d.data.person?.email),localStorage.setItem("sessionToken",d.data.sessionToken),_o("admin")),d.data},instantLogin:async u=>{const d=await ms.instantLogin(u);return d.data.success&&(e.value=d.data.email,t.value=!0,localStorage.setItem("adminEmail",d.data.email),d.data.sessionToken&&localStorage.setItem("sessionToken",d.data.sessionToken),_o("admin")),d.data},logout:async()=>{try{await ms.logout()}catch{}e.value=null,t.value=!1,o.value=!1,localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken"),_o(null)}}}),Y_={class:"modal-card"},X_={key:0,class:"email-sent"},Q_={key:1},eb={class:"form-group"},tb=["disabled"],nb={key:0,class:"error"},ob={__name:"LoginModal",props:{show:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3}},emits:["close","success"],setup(e,{emit:t}){const o=e,a=t,s=jl(),i=$(""),l=$(!1),u=$(null),d=$(!1);async function f(){l.value=!0,u.value=null;try{const y=await s.requestLogin(i.value);y.success?(d.value=!0,a("success",i.value)):u.value=y.message||"Failed to send login link. Please try again."}catch{u.value="Failed to send login link. Please try again."}finally{l.value=!1}}function p(){i.value="",d.value=!1,u.value=null}function g(){a("close")}return qe(()=>o.show,y=>{y||setTimeout(()=>{p()},200)}),(y,k)=>(v(),Ze($l,{to:"body"},[Ae(ys,{name:"modal"},{default:ze(()=>[e.show?(v(),m("div",{key:0,class:"modal-overlay",style:Qe({zIndex:e.zIndex}),onClick:rt(g,["self"])},[r("div",Y_,[r("button",{class:"modal-close",onClick:g},""),d.value?(v(),m("div",X_,[k[2]||(k[2]=r("div",{class:"check-icon"},"",-1)),k[3]||(k[3]=r("h3",null,"Check your email!",-1)),r("p",null,[k[1]||(k[1]=Ye("We've sent a login link to ",-1)),r("strong",null,C(i.value),1)]),k[4]||(k[4]=r("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),r("button",{onClick:p,class:"btn btn-secondary"}," Use a different email ")])):(v(),m("div",Q_,[k[5]||(k[5]=r("h2",null,"Join us or login",-1)),k[6]||(k[6]=r("p",{class:"instruction"},"Enter your email to receive a login link",-1)),r("form",{onSubmit:rt(f,["prevent"])},[r("div",eb,[He(r("input",{"onUpdate:modelValue":k[0]||(k[0]=_=>i.value=_),type:"email",placeholder:"you@example.com",required:"",class:"form-input"},null,512),[[st,i.value]])]),r("button",{type:"submit",class:"btn btn-primary btn-full",disabled:l.value},C(l.value?"Sending...":"Send login link"),9,tb)],32),u.value?(v(),m("div",nb,C(u.value),1)):M("",!0)]))])],4)):M("",!0)]),_:1})]))}},Bv=je(ob,[["__scopeId","data-v-7c646305"]]),sb={class:"home"},ab={class:"hero-section"},ib={class:"content-section"},lb={class:"container"},rb={class:"carousel"},cb={class:"carousel-indicators"},ub=["onClick"],db={__name:"Home",setup(e){const t=cc(),o=Hi();function a(){const y=!!localStorage.getItem("adminEmail"),k=lv();return y||k}function s(){a()?o.push("/sessions"):p.value=!0}const i=$(0);let l=null;function u(y){i.value=y,f()}function d(){i.value=(i.value+1)%2}function f(){l&&clearInterval(l),l=setInterval(d,1e4)}const p=$(!1);function g(){p.value=!1,t.query.login&&o.replace({query:{}})}return on(()=>{f(),t.query.login&&(a()?o.replace("/sessions"):p.value=!0)}),$n(()=>{l&&clearInterval(l)}),(y,k)=>(v(),m("div",sb,[r("section",ab,[Ae(Ov,{title:"OnTheDay"}),k[0]||(k[0]=r("p",{class:"subtitle"},"Manage your event's marshals and volunteers with ease",-1)),r("button",{class:"btn btn-primary",onClick:s}," Join us or login ")]),r("section",ib,[r("div",lb,[k[2]||(k[2]=Ar('<div class="features-grid" data-v-c615012d><div class="feature-card" data-v-c615012d><h3 data-v-c615012d>For admins</h3><ul data-v-c615012d><li data-v-c615012d>Create and manage events</li><li data-v-c615012d>Define marshal locations</li><li data-v-c615012d>Real-time check-in monitoring</li><li data-v-c615012d>Map view of everything in your event</li><li data-v-c615012d>Manage incidents</li></ul></div><div class="feature-card" data-v-c615012d><h3 data-v-c615012d>For marshals</h3><ul data-v-c615012d><li data-v-c615012d>View the entire route</li><li data-v-c615012d>View your assigned location</li><li data-v-c615012d>Check in with GPS verification</li><li data-v-c615012d>Access emergency contact info</li><li data-v-c615012d>Record incidents</li></ul></div></div>',1)),r("div",rb,[r("div",{class:"carousel-track",style:Qe({transform:`translateX(-${i.value*100}%)`})},[...k[1]||(k[1]=[Ar('<div class="feature-card" data-v-c615012d><h3 data-v-c615012d>For admins</h3><ul data-v-c615012d><li data-v-c615012d>Create and manage events</li><li data-v-c615012d>Define marshal locations</li><li data-v-c615012d>Real-time check-in monitoring</li><li data-v-c615012d>Map view of everything in your event</li><li data-v-c615012d>Manage incidents</li></ul></div><div class="feature-card" data-v-c615012d><h3 data-v-c615012d>For marshals</h3><ul data-v-c615012d><li data-v-c615012d>View the entire route</li><li data-v-c615012d>View your assigned location</li><li data-v-c615012d>Check in with GPS verification</li><li data-v-c615012d>Access emergency contact info</li><li data-v-c615012d>Record incidents</li></ul></div>',2)])],4),r("div",cb,[(v(),m(Se,null,Ne(2,(_,w)=>r("button",{key:w,class:ce(["indicator",{active:i.value===w}]),onClick:S=>u(w)},null,10,ub)),64))])])])]),Ae(Bv,{show:p.value,onClose:g},null,8,["show"])]))}},hb=je(db,[["__scopeId","data-v-c615012d"]]),fb={class:"admin-login"},pb={class:"login-card"},vb={key:0,class:"email-sent"},mb={class:"form-group"},gb=["disabled"],yb={key:0,class:"error"},kb={__name:"AdminLogin",setup(e){const t=jl(),o=$(""),a=$(!1),s=$(null),i=$(!1),l=async()=>{a.value=!0,s.value=null;try{const d=await t.requestLogin(o.value);d.success?i.value=!0:s.value=d.message||"Failed to send login link. Please try again."}catch{s.value="Failed to send login link. Please try again."}finally{a.value=!1}},u=()=>{o.value="",i.value=!1,s.value=null};return(d,f)=>{const p=ju("router-link");return v(),m("div",fb,[r("div",pb,[f[7]||(f[7]=r("h2",null,"Admin login",-1)),i.value?(v(),m("div",vb,[f[2]||(f[2]=r("div",{class:"check-icon"},"",-1)),f[3]||(f[3]=r("h3",null,"Check your email!",-1)),r("p",null,[f[1]||(f[1]=Ye("We've sent a login link to ",-1)),r("strong",null,C(o.value),1)]),f[4]||(f[4]=r("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),r("button",{onClick:u,class:"btn btn-secondary"}," Use a different email ")])):(v(),m(Se,{key:1},[f[5]||(f[5]=r("p",{class:"instruction"},"Enter your email to receive a login link",-1)),r("form",{onSubmit:rt(l,["prevent"])},[r("div",mb,[He(r("input",{"onUpdate:modelValue":f[0]||(f[0]=g=>o.value=g),type:"email",placeholder:"admin@example.com",required:"",class:"form-input"},null,512),[[st,o.value]])]),r("button",{type:"submit",class:"btn btn-primary",disabled:a.value},C(a.value?"Sending...":"Send login link"),9,gb)],32),s.value?(v(),m("div",yb,C(s.value),1)):M("",!0)],64)),Ae(p,{to:"/",class:"back-link"},{default:ze(()=>[...f[6]||(f[6]=[Ye(" Back to Home",-1)])]),_:1})])])}}},_b=je(kb,[["__scopeId","data-v-5d0a88c2"]]),bb={class:"admin-verify"},wb={class:"verify-card"},Cb={key:0,class:"status"},Lb={key:1,class:"status error"},Sb={key:2,class:"status success"},xb={__name:"AdminVerify",setup(e){const t=Hi(),o=cc(),a=jl(),s=$(!0),i=$(null);return on(async()=>{const l=o.query.token;if(!l){i.value="No login token provided. Please request a new login link.",s.value=!1;return}try{const u=await a.verifyToken(l);u.success?setTimeout(()=>{t.push({name:"Sessions"})},1e3):i.value=u.message||"Invalid or expired login link. Please request a new one."}catch(u){console.error("Verification error:",u),i.value="Failed to verify login. Please try again."}finally{s.value=!1}}),(l,u)=>{const d=ju("router-link");return v(),m("div",bb,[r("div",wb,[s.value?(v(),m("div",Cb,[...u[0]||(u[0]=[r("div",{class:"spinner"},null,-1),r("h2",null,"Verifying your login...",-1),r("p",null,"Please wait while we confirm your identity.",-1)])])):i.value?(v(),m("div",Lb,[u[2]||(u[2]=r("h2",null,"Login failed",-1)),r("p",null,C(i.value),1),Ae(d,{to:{name:"Home",query:{login:"true"}},class:"btn btn-primary"},{default:ze(()=>[...u[1]||(u[1]=[Ye(" Try again ",-1)])]),_:1})])):(v(),m("div",Sb,[...u[3]||(u[3]=[r("h2",null,"Login successful!",-1),r("p",null,"Redirecting to your sessions...",-1)])]))])])}}},Ib=je(xb,[["__scopeId","data-v-b2435a84"]]),Nv=Yu("events",()=>{const e=$([]),t=$(null),o=$([]),a=$([]),s=$(null),i=$(!1),l=$(null),u=async()=>{i.value=!0,l.value=null;try{const F=await ma.getAll();e.value=F.data}catch(F){throw l.value=F.message,F}finally{i.value=!1}},d=async F=>{i.value=!0,l.value=null;try{const E=await ma.getById(F);t.value=E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},f=async F=>{i.value=!0,l.value=null;try{const E=await ma.create(F);return e.value.push(E.data),E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},p=async(F,E)=>{i.value=!0,l.value=null;try{const N=await ma.update(F,E),D=e.value.findIndex(j=>j.id===F);return D!==-1&&(e.value[D]=N.data),t.value?.id===F&&(t.value=N.data),N.data}catch(N){throw l.value=N.message,N}finally{i.value=!1}},g=async F=>{i.value=!0,l.value=null;try{await ma.delete(F),e.value=e.value.filter(E=>E.id!==F)}catch(E){throw l.value=E.message,E}finally{i.value=!1}},y=async F=>{i.value=!0,l.value=null;try{const E=await Jn.getByEvent(F);o.value=E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}};return{events:e,currentEvent:t,locations:o,assignments:a,eventStatus:s,loading:i,error:l,fetchEvents:u,fetchEvent:d,createEvent:f,updateEvent:p,deleteEvent:g,fetchLocations:y,createLocation:async F=>{i.value=!0,l.value=null;try{const E=await Jn.create(F);return o.value.push(E.data),E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},updateLocation:async(F,E,N)=>{i.value=!0,l.value=null;try{const D=await Jn.update(F,E,N),j=o.value.findIndex(R=>R.id===E);return j!==-1&&(o.value[j]=D.data),D.data}catch(D){throw l.value=D.message,D}finally{i.value=!1}},deleteLocation:async(F,E)=>{i.value=!0,l.value=null;try{await Jn.delete(F,E),o.value=o.value.filter(N=>N.id!==E)}catch(N){throw l.value=N.message,N}finally{i.value=!1}},bulkUpdateLocationTimes:async(F,E)=>{i.value=!0,l.value=null;try{const N=await Jn.bulkUpdateTimes(F,E);return await y(F),N.data}catch(N){throw l.value=N.message,N}finally{i.value=!1}},fetchAssignments:async F=>{i.value=!0,l.value=null;try{const E=await dl.getByEvent(F);a.value=E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},createAssignment:async F=>{i.value=!0,l.value=null;try{const E=await dl.create(F);return a.value.push(E.data),E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},deleteAssignment:async(F,E)=>{i.value=!0,l.value=null;try{await dl.delete(F,E),a.value=a.value.filter(N=>N.id!==E)}catch(N){throw l.value=N.message,N}finally{i.value=!1}},fetchEventStatus:async F=>{i.value=!0,l.value=null;try{const E=await dl.getEventStatus(F);return s.value=E.data,E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},updateAssignmentCheckIn:F=>{const E=a.value.findIndex(N=>N.id===F.id);E!==-1&&(a.value[E]=F),s.value&&s.value.locations.forEach(N=>{const D=N.assignments.findIndex(j=>j.id===F.id);D!==-1&&(N.assignments[D]=F,N.checkedInCount=N.assignments.filter(j=>j.isCheckedIn).length)})}}});function Fv(e="details",t=[]){const o=$(e),a=g=>{o.value=g},s=()=>{o.value=e},i=g=>o.value===g,l=G(()=>t.length===0?-1:t.indexOf(o.value)),u=(g=!1)=>{if(t.length===0)return;const y=l.value;if(y===-1)return;const k=y+1;k<t.length?o.value=t[k]:g&&(o.value=t[0])},d=(g=!1)=>{if(t.length===0)return;const y=l.value;if(y===-1)return;const k=y-1;k>=0?o.value=t[k]:g&&(o.value=t[t.length-1])},f=G(()=>{if(t.length===0)return!1;const g=l.value;return g!==-1&&g<t.length-1}),p=G(()=>t.length===0?!1:l.value>0);return{activeTab:o,activeTabIndex:l,hasNextTab:f,hasPreviousTab:p,switchTab:a,resetTab:s,isActiveTab:i,nextTab:u,previousTab:d}}function $b(){const e=$(!1),t=$(""),o=$(""),a=$(null),s=$(!1),i=$("OK");return{showConfirmModal:e,confirmModalTitle:t,confirmModalMessage:o,confirmModalIsDanger:s,confirmModalConfirmText:i,showConfirm:(p,g,y,k={})=>{t.value=p,o.value=g,a.value=y,s.value=k.isDanger||!1,i.value=k.confirmText||"OK",e.value=!0},handleConfirmModalConfirm:()=>{e.value=!1,a.value&&(a.value(),a.value=null)},handleConfirmModalCancel:()=>{e.value=!1,a.value=null},closeConfirmModal:()=>{e.value=!1,a.value=null}}}const Ii=$({people:"Marshals",checkpoint:"Checkpoints",area:"Areas",checklist:"Checklists",course:"Course"}),Bs={people:{People:{singular:"Person",plural:"People"},Marshals:{singular:"Marshal",plural:"Marshals"},Volunteers:{singular:"Volunteer",plural:"Volunteers"},Helpers:{singular:"Helper",plural:"Helpers"},Staff:{singular:"Staff member",plural:"Staff"},Stewards:{singular:"Steward",plural:"Stewards"},"Team members":{singular:"Team member",plural:"Team members"},Drivers:{singular:"Driver",plural:"Drivers"},Pilots:{singular:"Pilot",plural:"Pilots"}},checkpoint:{Checkpoints:{singular:"Checkpoint",plural:"Checkpoints"},Stations:{singular:"Station",plural:"Stations"},Locations:{singular:"Location",plural:"Locations"},"Feed stations":{singular:"Feed station",plural:"Feed stations"},"Aid stations":{singular:"Aid station",plural:"Aid stations"},"Water stations":{singular:"Water station",plural:"Water stations"},"Person points":{singular:null,plural:null,dynamic:!0}},area:{Areas:{singular:"Area",plural:"Areas"},Regions:{singular:"Region",plural:"Regions"},Zones:{singular:"Zone",plural:"Zones"}},checklist:{Checklists:{singular:"Checklist",plural:"Checklists"},Tasks:{singular:"Task",plural:"Tasks"},Jobs:{singular:"Job",plural:"Jobs"}},course:{Course:{singular:"Course",plural:"Courses"},Route:{singular:"Route",plural:"Routes"},Track:{singular:"Track",plural:"Tracks"},Trail:{singular:"Trail",plural:"Trails"},Path:{singular:"Path",plural:"Paths"}}},Os={people:["Drivers","Helpers","Marshals","People","Pilots","Staff","Stewards","Team members","Volunteers"],checkpoint:["Aid stations","Checkpoints","Feed stations","Locations","Person points","Stations","Water stations"],area:["Areas","Regions","Zones"],checklist:["Checklists","Jobs","Tasks"],course:["Course","Path","Route","Track","Trail"]};function Ja(e,t,o="Marshals"){if(!t)return"";const a=Bs[e]?.[t];return e==="checkpoint"&&t==="Person points"?`${Bs.people[o]?.singular||"Person"} point`:a?.singular?a.singular:t.endsWith("s")&&!t.endsWith("ss")?t.slice(0,-1):t}function Uv(e,t,o="Marshals"){if(!t)return"";const a=Bs[e]?.[t];return t==="Person points"?`${Bs.people[o]?.singular||"Person"} points`:a?.plural?a.plural:t}function Su(e,t){return e==="Person points"?`${Bs.people[t]?.singular||"Person"} points`:e}function xu(e){e&&(Ii.value={people:e.peopleTerm||"Marshals",checkpoint:e.checkpointTerm||"Checkpoints",area:e.areaTerm||"Areas",checklist:e.checklistTerm||"Checklists",course:e.courseTerm||"Course"})}const Wo=e=>e.toLowerCase(),Ko=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();function ht(){const e=p=>{const g=Ii.value[p],y=Bs[p]?.[g];if(p==="checkpoint"&&g==="Person points"){const k=Ii.value.people;return`${Bs.people[k]?.singular||"Person"} point`}return y?.singular||g},t=p=>{const g=Ii.value[p],y=Bs[p]?.[g];if(p==="checkpoint"&&g==="Person points"){const k=Ii.value.people;return`${Bs.people[k]?.singular||"Person"} points`}return y?.plural||g},o=G(()=>({person:e("people"),checkpoint:e("checkpoint"),area:e("area"),checklist:e("checklist"),course:e("course"),people:t("people"),checkpoints:t("checkpoint"),areas:t("area"),checklists:t("checklist"),courses:t("course")})),a=G(()=>({person:Wo(e("people")),checkpoint:Wo(e("checkpoint")),area:Wo(e("area")),checklist:Wo(e("checklist")),course:Wo(e("course")),people:Wo(t("people")),checkpoints:Wo(t("checkpoint")),areas:Wo(t("area")),checklists:Wo(t("checklist")),courses:Wo(t("course"))})),s=G(()=>({person:Ko(e("people")),checkpoint:Ko(e("checkpoint")),area:Ko(e("area")),checklist:Ko(e("checklist")),course:Ko(e("course")),people:Ko(t("people")),checkpoints:Ko(t("checkpoint")),areas:Ko(t("area")),checklists:Ko(t("checklist")),courses:Ko(t("course"))})),i=G(()=>({course:o.value.course,checkpoints:o.value.checkpoints,areas:o.value.areas,marshals:o.value.people,checklists:o.value.checklists,notes:"Notes",details:"Event details"}));return{terms:o,termsLower:a,termsSentence:s,tabLabels:i,singular:e,plural:t,formatCount:(p,g)=>g===1?`1 ${e(p)}`:`${g} ${t(p)}`,lower:(p,g=!0)=>Wo(g?t(p):e(p)),title:(p,g=!0)=>g?t(p):e(p),sentence:(p,g=!0)=>Ko(g?t(p):e(p)),terminology:Ii}}function Tb(){const e=$(!1),t=$(null),o=$({}),a=$(null),s=$(null),i=$([]),l=$(null),u=$(null),d=$(!1),f=$(!1),p=$(1),g=G(()=>t.value==="place-checkpoint"||t.value==="move-checkpoint"?a.value!==null:t.value==="draw-area"?s.value&&s.value.length>=3:t.value==="add-multiple"),y=ne=>{if(ne){const ue=ne.getMapCenter?.(),K=ne.getMapZoom?.();ue&&K!==null&&(l.value=ue,u.value=K)}},k=(ne={})=>{a.value=null,e.value=!0,t.value="place-checkpoint",o.value={title:ne.title||"Select checkpoint location",description:ne.description||"Click on the map to set the location. Click again to reposition."}},_=(ne,ue="checkpoint")=>{a.value=null,e.value=!0,t.value="move-checkpoint",o.value={title:`Move ${ue}: ${ne}`,description:"Click on the map to set the new location"}},w=(ne={})=>{e.value=!0,t.value="draw-area",d.value=!0,o.value={title:ne.title||"Draw area boundary",description:ne.description||"Click to add points. Click Done when finished to complete the area."}},S=(ne=1)=>{p.value=ne,i.value=[],e.value=!0,t.value="add-multiple",f.value=!0,o.value={title:"Add multiple checkpoints",description:`Click on map to add checkpoints. Next: Checkpoint ${p.value}`}},A=ne=>{t.value==="place-checkpoint"||t.value==="move-checkpoint"?a.value=ne:t.value==="add-multiple"&&T(ne)},T=ne=>{i.value.push({id:`temp-${p.value}`,name:`Checkpoint ${p.value}`,description:"",latitude:ne.lat,longitude:ne.lng,requiredMarshals:1,what3Words:"",assignments:[],isTemporary:!0}),p.value++,o.value={...o.value,description:`Click on map to add checkpoints. Next: Checkpoint ${p.value}`}},x=ne=>{s.value=ne},P=()=>s.value&&s.value.length>=3?s.value.map(ne=>({lat:ne.lat,lng:ne.lng})):null,O=()=>{e.value=!1,t.value=null,o.value={},a.value=null,l.value=null,u.value=null,s.value=null,d.value&&(d.value=!1)};return{isFullscreenMapActive:e,fullscreenMode:t,fullscreenContext:o,tempLocationCoords:a,currentDrawingPolygon:s,tempCheckpoints:i,savedMapCenter:l,savedMapZoom:u,isDrawingAreaBoundary:d,isAddingMultipleCheckpoints:f,multiCheckpointCounter:p,canCompleteFullscreen:g,saveMapState:y,enterPlaceCheckpointMode:k,enterMoveCheckpointMode:_,enterDrawAreaMode:w,enterAddMultipleMode:S,handleFullscreenMapClick:A,handlePolygonDrawing:x,getCompletedPolygon:P,exitFullscreen:O,cancelFullscreen:()=>{t.value==="add-multiple"?(i.value=[],f.value=!1):t.value==="draw-area"&&(d.value=!1,s.value=null),O()},getTempCheckpoints:()=>[...i.value],clearTempCheckpoints:()=>{i.value=[],f.value=!1},getPlacedCoords:()=>a.value,createDisplayCheckpoints:(ne,ue,K)=>G(()=>{const Q=[...ne.value];return t.value==="place-checkpoint"&&a.value&&Q.push({id:"temp-single",name:ue.value?.name||"New Checkpoint",latitude:a.value.lat,longitude:a.value.lng,requiredMarshals:ue.value?.requiredMarshals||1,assignments:[],isTemporary:!0}),t.value==="move-checkpoint"&&a.value&&K.value&&Q.push({id:"temp-move",name:K.value.name+" (new position)",latitude:a.value.lat,longitude:a.value.lng,requiredMarshals:K.value.requiredMarshals,assignments:[],isTemporary:!0}),t.value==="add-multiple"&&Q.push(...i.value),Q}),createDisplayAreas:(ne,ue)=>G(()=>{const K=[...ne.value];if(t.value==="draw-area"&&ue.value?.polygon?.length>0){const Q=K.findIndex(he=>he.id===ue.value.id);Q>=0?K[Q]={...ue.value}:K.push({...ue.value,id:ue.value.id||"temp-area"})}return K}),calculateStartingNumber:ne=>{const ue=ne.value.map(K=>{const Q=K.name.match(/^Checkpoint (\d+)$/);return Q?parseInt(Q[1]):0}).filter(K=>K>0);return ue.length>0?Math.max(...ue)+1:1}}}function Mb(e){const t=$([]),o=$(!1);return{eventAdmins:t,showAddAdmin:o,loadEventAdmins:async()=>{try{const d=await Jc.getAdmins(e.value);return t.value=d.data,d.data}catch(d){throw console.error("Failed to load event admins:",d),d}},openAddAdminModal:()=>{o.value=!0},closeAddAdminModal:()=>{o.value=!1},addAdmin:async d=>{await Jc.addAdmin(e.value,d)},removeAdmin:async d=>{await Jc.removeAdmin(e.value,d)}}}function Ab(e){const t=$(!1),o=$(!1),a=$(!1),s=$(!1),i=$(!1),l=$(!1),u=$(null),d=$(null),f=$(null),p=$(null);return{showUploadRoute:t,showImportLocations:o,showImportMarshals:a,uploading:s,importing:i,importingMarshals:l,uploadError:u,importError:d,importResult:f,importMarshalsResult:p,openUploadRouteModal:()=>{u.value=null,t.value=!0},closeUploadRouteModal:()=>{t.value=!1,u.value=null},uploadRoute:async O=>{if(!O)return u.value="Please select a GPX file",null;s.value=!0,u.value=null;try{return await ma.uploadGpx(e.value,O),!0}catch(F){return console.error("Failed to upload route:",F),u.value=F.response?.data?.message||"Failed to upload route. Please try again.",null}finally{s.value=!1}},openImportLocationsModal:()=>{d.value=null,f.value=null,o.value=!0},closeImportLocationsModal:()=>{o.value=!1,d.value=null,f.value=null},importLocations:async(O,F)=>{if(!O)return d.value="Please select a CSV file",null;i.value=!0,d.value=null,f.value=null;try{const E=await Jn.importCsv(e.value,O,F);return f.value=E.data,E.data}catch(E){return console.error("Failed to import locations:",E),d.value=E.response?.data?.message||"Failed to import locations. Please try again.",null}finally{i.value=!1}},openImportMarshalsModal:()=>{d.value=null,p.value=null,a.value=!0},closeImportMarshalsModal:()=>{a.value=!1,d.value=null,p.value=null},importMarshals:async O=>{if(!O)return d.value="Please select a CSV file",null;l.value=!0,d.value=null,p.value=null;try{const F=await gs.importCsv(e.value,O);return p.value=F.data,F.data}catch(F){return console.error("Failed to import marshals:",F),d.value=F.response?.data?.message||"Failed to import marshals. Please try again.",null}finally{l.value=!1}},formatImportResultMessage:(O,F="location")=>{const E=F==="location"?"location(s)":"marshal(s)";let D=`<p>Created <strong>${O[F==="location"?"locationsCreated":"marshalsCreated"]}</strong> ${E} and <strong>${O.assignmentsCreated}</strong> assignment(s)</p>`;return O.errors&&O.errors.length>0&&(D+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',O.errors.forEach(j=>{D+=`<li>${j}</li>`}),D+="</ul>"),D}}}const zv="admin-theme-preference",qa=$(Eb());function Eb(){return typeof window>"u"?"system":localStorage.getItem(zv)||"system"}function Pb(e){localStorage.setItem(zv,e)}function Hv(){const e=G(()=>qa.value==="system"?"light dark":qa.value),t=(s,i=!0)=>{i&&typeof document<"u"&&(document.documentElement.classList.add("theme-transitioning"),setTimeout(()=>{document.documentElement.classList.remove("theme-transitioning")},1e3)),qa.value=s,Pb(s)},o=()=>{const s=["system","light","dark"],l=(s.indexOf(qa.value)+1)%s.length;t(s[l])},a=G(()=>qa.value==="dark"?!0:qa.value==="light"?!1:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1);return{theme:qa,colorScheme:e,isDark:a,setTheme:t,cycleTheme:o}}const Vv=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",Ol=e=>{if(!e)return"";const t=new Date(e),o=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0");return`${o}-${a}-${s}T${i}:${l}`},Ur=e=>{if(!e||e.trim()==="")return!0;if(!/^[a-z]{1,20}[./][a-z]{1,20}[./][a-z]{1,20}$/.test(e))return!1;const o=e.includes("."),a=e.includes("/");return o!==a},Db=(e,t,o,a)=>{const i=e*Math.PI/180,l=o*Math.PI/180,u=(o-e)*Math.PI/180,d=(a-t)*Math.PI/180,f=Math.sin(u/2)*Math.sin(u/2)+Math.cos(i)*Math.cos(l)*Math.sin(d/2)*Math.sin(d/2);return 6371e3*(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)))},Rb=e=>!e&&e!==0?"":e<1e3?`${Math.round(e)} m`:`${(e/1e3).toFixed(2)} km`;function Ob(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var hl={exports:{}};var Bb=hl.exports,Qh;function Nb(){return Qh||(Qh=1,(function(e,t){(function(o,a){a(t)})(Bb,(function(o){var a="1.9.4";function s(n){var c,h,b,I;for(h=1,b=arguments.length;h<b;h++){I=arguments[h];for(c in I)n[c]=I[c]}return n}var i=Object.create||(function(){function n(){}return function(c){return n.prototype=c,new n}})();function l(n,c){var h=Array.prototype.slice;if(n.bind)return n.bind.apply(n,h.call(arguments,1));var b=h.call(arguments,2);return function(){return n.apply(c,b.length?b.concat(h.call(arguments)):arguments)}}var u=0;function d(n){return"_leaflet_id"in n||(n._leaflet_id=++u),n._leaflet_id}function f(n,c,h){var b,I,z,te;return te=function(){b=!1,I&&(z.apply(h,I),I=!1)},z=function(){b?I=arguments:(n.apply(h,arguments),setTimeout(te,c),b=!0)},z}function p(n,c,h){var b=c[1],I=c[0],z=b-I;return n===b&&h?n:((n-I)%z+z)%z+I}function g(){return!1}function y(n,c){if(c===!1)return n;var h=Math.pow(10,c===void 0?6:c);return Math.round(n*h)/h}function k(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function _(n){return k(n).split(/\s+/)}function w(n,c){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?i(n.options):{});for(var h in c)n.options[h]=c[h];return n.options}function S(n,c,h){var b=[];for(var I in n)b.push(encodeURIComponent(h?I.toUpperCase():I)+"="+encodeURIComponent(n[I]));return(!c||c.indexOf("?")===-1?"?":"&")+b.join("&")}var A=/\{ *([\w_ -]+) *\}/g;function T(n,c){return n.replace(A,function(h,b){var I=c[b];if(I===void 0)throw new Error("No value provided for variable "+h);return typeof I=="function"&&(I=I(c)),I})}var x=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function P(n,c){for(var h=0;h<n.length;h++)if(n[h]===c)return h;return-1}var O="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function F(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var E=0;function N(n){var c=+new Date,h=Math.max(0,16-(c-E));return E=c+h,window.setTimeout(n,h)}var D=window.requestAnimationFrame||F("RequestAnimationFrame")||N,j=window.cancelAnimationFrame||F("CancelAnimationFrame")||F("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function R(n,c,h){if(h&&D===N)n.call(c);else return D.call(window,l(n,c))}function W(n){n&&j.call(window,n)}var ne={__proto__:null,extend:s,create:i,bind:l,get lastId(){return u},stamp:d,throttle:f,wrapNum:p,falseFn:g,formatNum:y,trim:k,splitWords:_,setOptions:w,getParamString:S,template:T,isArray:x,indexOf:P,emptyImageUrl:O,requestFn:D,cancelFn:j,requestAnimFrame:R,cancelAnimFrame:W};function ue(){}ue.extend=function(n){var c=function(){w(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=c.__super__=this.prototype,b=i(h);b.constructor=c,c.prototype=b;for(var I in this)Object.prototype.hasOwnProperty.call(this,I)&&I!=="prototype"&&I!=="__super__"&&(c[I]=this[I]);return n.statics&&s(c,n.statics),n.includes&&(K(n.includes),s.apply(null,[b].concat(n.includes))),s(b,n),delete b.statics,delete b.includes,b.options&&(b.options=h.options?i(h.options):{},s(b.options,n.options)),b._initHooks=[],b.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var z=0,te=b._initHooks.length;z<te;z++)b._initHooks[z].call(this)}},c},ue.include=function(n){var c=this.prototype.options;return s(this.prototype,n),n.options&&(this.prototype.options=c,this.mergeOptions(n.options)),this},ue.mergeOptions=function(n){return s(this.prototype.options,n),this},ue.addInitHook=function(n){var c=Array.prototype.slice.call(arguments,1),h=typeof n=="function"?n:function(){this[n].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function K(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=x(n)?n:[n];for(var c=0;c<n.length;c++)n[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Q={on:function(n,c,h){if(typeof n=="object")for(var b in n)this._on(b,n[b],c);else{n=_(n);for(var I=0,z=n.length;I<z;I++)this._on(n[I],c,h)}return this},off:function(n,c,h){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var b in n)this._off(b,n[b],c);else{n=_(n);for(var I=arguments.length===1,z=0,te=n.length;z<te;z++)I?this._off(n[z]):this._off(n[z],c,h)}return this},_on:function(n,c,h,b){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(n,c,h)===!1){h===this&&(h=void 0);var I={fn:c,ctx:h};b&&(I.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(I)}},_off:function(n,c,h){var b,I,z;if(this._events&&(b=this._events[n],!!b)){if(arguments.length===1){if(this._firingCount)for(I=0,z=b.length;I<z;I++)b[I].fn=g;delete this._events[n];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var te=this._listens(n,c,h);if(te!==!1){var ke=b[te];this._firingCount&&(ke.fn=g,this._events[n]=b=b.slice()),b.splice(te,1)}}},fire:function(n,c,h){if(!this.listens(n,h))return this;var b=s({},c,{type:n,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var I=this._events[n];if(I){this._firingCount=this._firingCount+1||1;for(var z=0,te=I.length;z<te;z++){var ke=I[z],xe=ke.fn;ke.once&&this.off(n,xe,ke.ctx),xe.call(ke.ctx||this,b)}this._firingCount--}}return h&&this._propagateEvent(b),this},listens:function(n,c,h,b){typeof n!="string"&&console.warn('"string" type argument expected');var I=c;typeof c!="function"&&(b=!!c,I=void 0,h=void 0);var z=this._events&&this._events[n];if(z&&z.length&&this._listens(n,I,h)!==!1)return!0;if(b){for(var te in this._eventParents)if(this._eventParents[te].listens(n,c,h,b))return!0}return!1},_listens:function(n,c,h){if(!this._events)return!1;var b=this._events[n]||[];if(!c)return!!b.length;h===this&&(h=void 0);for(var I=0,z=b.length;I<z;I++)if(b[I].fn===c&&b[I].ctx===h)return I;return!1},once:function(n,c,h){if(typeof n=="object")for(var b in n)this._on(b,n[b],c,!0);else{n=_(n);for(var I=0,z=n.length;I<z;I++)this._on(n[I],c,h,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[d(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[d(n)],this},_propagateEvent:function(n){for(var c in this._eventParents)this._eventParents[c].fire(n.type,s({layer:n.target,propagatedFrom:n.target},n),!0)}};Q.addEventListener=Q.on,Q.removeEventListener=Q.clearAllEventListeners=Q.off,Q.addOneTimeEventListener=Q.once,Q.fireEvent=Q.fire,Q.hasEventListeners=Q.listens;var he=ue.extend(Q);function U(n,c,h){this.x=h?Math.round(n):n,this.y=h?Math.round(c):c}var ee=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};U.prototype={clone:function(){return new U(this.x,this.y)},add:function(n){return this.clone()._add(de(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(de(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new U(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new U(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ee(this.x),this.y=ee(this.y),this},distanceTo:function(n){n=de(n);var c=n.x-this.x,h=n.y-this.y;return Math.sqrt(c*c+h*h)},equals:function(n){return n=de(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=de(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+y(this.x)+", "+y(this.y)+")"}};function de(n,c,h){return n instanceof U?n:x(n)?new U(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new U(n.x,n.y):new U(n,c,h)}function re(n,c){if(n)for(var h=c?[n,c]:n,b=0,I=h.length;b<I;b++)this.extend(h[b])}re.prototype={extend:function(n){var c,h;if(!n)return this;if(n instanceof U||typeof n[0]=="number"||"x"in n)c=h=de(n);else if(n=De(n),c=n.min,h=n.max,!c||!h)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=h.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(n){return de((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return de(this.min.x,this.max.y)},getTopRight:function(){return de(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var c,h;return typeof n[0]=="number"||n instanceof U?n=de(n):n=De(n),n instanceof re?(c=n.min,h=n.max):c=h=n,c.x>=this.min.x&&h.x<=this.max.x&&c.y>=this.min.y&&h.y<=this.max.y},intersects:function(n){n=De(n);var c=this.min,h=this.max,b=n.min,I=n.max,z=I.x>=c.x&&b.x<=h.x,te=I.y>=c.y&&b.y<=h.y;return z&&te},overlaps:function(n){n=De(n);var c=this.min,h=this.max,b=n.min,I=n.max,z=I.x>c.x&&b.x<h.x,te=I.y>c.y&&b.y<h.y;return z&&te},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var c=this.min,h=this.max,b=Math.abs(c.x-h.x)*n,I=Math.abs(c.y-h.y)*n;return De(de(c.x-b,c.y-I),de(h.x+b,h.y+I))},equals:function(n){return n?(n=De(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function De(n,c){return!n||n instanceof re?n:new re(n,c)}function et(n,c){if(n)for(var h=c?[n,c]:n,b=0,I=h.length;b<I;b++)this.extend(h[b])}et.prototype={extend:function(n){var c=this._southWest,h=this._northEast,b,I;if(n instanceof Fe)b=n,I=n;else if(n instanceof et){if(b=n._southWest,I=n._northEast,!b||!I)return this}else return n?this.extend(Ke(n)||Je(n)):this;return!c&&!h?(this._southWest=new Fe(b.lat,b.lng),this._northEast=new Fe(I.lat,I.lng)):(c.lat=Math.min(b.lat,c.lat),c.lng=Math.min(b.lng,c.lng),h.lat=Math.max(I.lat,h.lat),h.lng=Math.max(I.lng,h.lng)),this},pad:function(n){var c=this._southWest,h=this._northEast,b=Math.abs(c.lat-h.lat)*n,I=Math.abs(c.lng-h.lng)*n;return new et(new Fe(c.lat-b,c.lng-I),new Fe(h.lat+b,h.lng+I))},getCenter:function(){return new Fe((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Fe(this.getNorth(),this.getWest())},getSouthEast:function(){return new Fe(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof Fe||"lat"in n?n=Ke(n):n=Je(n);var c=this._southWest,h=this._northEast,b,I;return n instanceof et?(b=n.getSouthWest(),I=n.getNorthEast()):b=I=n,b.lat>=c.lat&&I.lat<=h.lat&&b.lng>=c.lng&&I.lng<=h.lng},intersects:function(n){n=Je(n);var c=this._southWest,h=this._northEast,b=n.getSouthWest(),I=n.getNorthEast(),z=I.lat>=c.lat&&b.lat<=h.lat,te=I.lng>=c.lng&&b.lng<=h.lng;return z&&te},overlaps:function(n){n=Je(n);var c=this._southWest,h=this._northEast,b=n.getSouthWest(),I=n.getNorthEast(),z=I.lat>c.lat&&b.lat<h.lat,te=I.lng>c.lng&&b.lng<h.lng;return z&&te},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,c){return n?(n=Je(n),this._southWest.equals(n.getSouthWest(),c)&&this._northEast.equals(n.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Je(n,c){return n instanceof et?n:new et(n,c)}function Fe(n,c,h){if(isNaN(n)||isNaN(c))throw new Error("Invalid LatLng object: ("+n+", "+c+")");this.lat=+n,this.lng=+c,h!==void 0&&(this.alt=+h)}Fe.prototype={equals:function(n,c){if(!n)return!1;n=Ke(n);var h=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return h<=(c===void 0?1e-9:c)},toString:function(n){return"LatLng("+y(this.lat,n)+", "+y(this.lng,n)+")"},distanceTo:function(n){return Ve.distance(this,Ke(n))},wrap:function(){return Ve.wrapLatLng(this)},toBounds:function(n){var c=180*n/40075017,h=c/Math.cos(Math.PI/180*this.lat);return Je([this.lat-c,this.lng-h],[this.lat+c,this.lng+h])},clone:function(){return new Fe(this.lat,this.lng,this.alt)}};function Ke(n,c,h){return n instanceof Fe?n:x(n)&&typeof n[0]!="object"?n.length===3?new Fe(n[0],n[1],n[2]):n.length===2?new Fe(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new Fe(n.lat,"lng"in n?n.lng:n.lon,n.alt):c===void 0?null:new Fe(n,c,h)}var _e={latLngToPoint:function(n,c){var h=this.projection.project(n),b=this.scale(c);return this.transformation._transform(h,b)},pointToLatLng:function(n,c){var h=this.scale(c),b=this.transformation.untransform(n,h);return this.projection.unproject(b)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var c=this.projection.bounds,h=this.scale(n),b=this.transformation.transform(c.min,h),I=this.transformation.transform(c.max,h);return new re(b,I)},infinite:!1,wrapLatLng:function(n){var c=this.wrapLng?p(n.lng,this.wrapLng,!0):n.lng,h=this.wrapLat?p(n.lat,this.wrapLat,!0):n.lat,b=n.alt;return new Fe(h,c,b)},wrapLatLngBounds:function(n){var c=n.getCenter(),h=this.wrapLatLng(c),b=c.lat-h.lat,I=c.lng-h.lng;if(b===0&&I===0)return n;var z=n.getSouthWest(),te=n.getNorthEast(),ke=new Fe(z.lat-b,z.lng-I),xe=new Fe(te.lat-b,te.lng-I);return new et(ke,xe)}},Ve=s({},_e,{wrapLng:[-180,180],R:6371e3,distance:function(n,c){var h=Math.PI/180,b=n.lat*h,I=c.lat*h,z=Math.sin((c.lat-n.lat)*h/2),te=Math.sin((c.lng-n.lng)*h/2),ke=z*z+Math.cos(b)*Math.cos(I)*te*te,xe=2*Math.atan2(Math.sqrt(ke),Math.sqrt(1-ke));return this.R*xe}}),pe=6378137,Le={R:pe,MAX_LATITUDE:85.0511287798,project:function(n){var c=Math.PI/180,h=this.MAX_LATITUDE,b=Math.max(Math.min(h,n.lat),-h),I=Math.sin(b*c);return new U(this.R*n.lng*c,this.R*Math.log((1+I)/(1-I))/2)},unproject:function(n){var c=180/Math.PI;return new Fe((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*c,n.x*c/this.R)},bounds:(function(){var n=pe*Math.PI;return new re([-n,-n],[n,n])})()};function Pe(n,c,h,b){if(x(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=c,this._c=h,this._d=b}Pe.prototype={transform:function(n,c){return this._transform(n.clone(),c)},_transform:function(n,c){return c=c||1,n.x=c*(this._a*n.x+this._b),n.y=c*(this._c*n.y+this._d),n},untransform:function(n,c){return c=c||1,new U((n.x/c-this._b)/this._a,(n.y/c-this._d)/this._c)}};function q(n,c,h,b){return new Pe(n,c,h,b)}var X=s({},Ve,{code:"EPSG:3857",projection:Le,transformation:(function(){var n=.5/(Math.PI*Le.R);return q(n,.5,-n,.5)})()}),fe=s({},X,{code:"EPSG:900913"});function we(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function Y(n,c){var h="",b,I,z,te,ke,xe;for(b=0,z=n.length;b<z;b++){for(ke=n[b],I=0,te=ke.length;I<te;I++)xe=ke[I],h+=(I?"L":"M")+xe.x+" "+xe.y;h+=c?Ge.svg?"z":"x":""}return h||"M0 0"}var V=document.documentElement.style,J="ActiveXObject"in window,Me=J&&!document.addEventListener,Re="msLaunchUri"in navigator&&!("documentMode"in document),Ce=ot("webkit"),be=ot("android"),me=ot("android 2")||ot("android 3"),Z=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),oe=be&&ot("Google")&&Z<537&&!("AudioNode"in window),le=!!window.opera,Te=!Re&&ot("chrome"),Oe=ot("gecko")&&!Ce&&!le&&!J,Be=!Te&&ot("safari"),Xe=ot("phantom"),mt="OTransition"in V,_t=navigator.platform.indexOf("Win")===0,bt=J&&"transition"in V,Mt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!me,Ct="MozPerspective"in V,Bt=!window.L_DISABLE_3D&&(bt||Mt||Ct)&&!mt&&!Xe,Nt=typeof orientation<"u"||ot("mobile"),zn=Nt&&Ce,Xn=Nt&&Mt,pn=!window.PointerEvent&&window.MSPointerEvent,Gt=!!(window.PointerEvent||pn),gt="ontouchstart"in window||!!window.TouchEvent,Qn=!window.L_NO_TOUCH&&(gt||Gt),Hn=Nt&&le,eo=Nt&&Oe,vn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,jt=(function(){var n=!1;try{var c=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",g,c),window.removeEventListener("testPassiveEventSupport",g,c)}catch{}return n})(),_s=(function(){return!!document.createElement("canvas").getContext})(),to=!!(document.createElementNS&&we("svg").createSVGRect),Co=!!to&&(function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),ae=!to&&(function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var c=n.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}})(),ie=navigator.platform.indexOf("Mac")===0,ve=navigator.platform.indexOf("Linux")===0;function ot(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var Ge={ie:J,ielt9:Me,edge:Re,webkit:Ce,android:be,android23:me,androidStock:oe,opera:le,chrome:Te,gecko:Oe,safari:Be,phantom:Xe,opera12:mt,win:_t,ie3d:bt,webkit3d:Mt,gecko3d:Ct,any3d:Bt,mobile:Nt,mobileWebkit:zn,mobileWebkit3d:Xn,msPointer:pn,pointer:Gt,touch:Qn,touchNative:gt,mobileOpera:Hn,mobileGecko:eo,retina:vn,passiveEvents:jt,canvas:_s,svg:to,vml:ae,inlineSvg:Co,mac:ie,linux:ve},St=Ge.msPointer?"MSPointerDown":"pointerdown",qt=Ge.msPointer?"MSPointerMove":"pointermove",Yt=Ge.msPointer?"MSPointerUp":"pointerup",Oo=Ge.msPointer?"MSPointerCancel":"pointercancel",uo={touchstart:St,touchmove:qt,touchend:Yt,touchcancel:Oo},Bo={touchstart:So,touchmove:sn,touchend:sn,touchcancel:sn},Vn={},xa=!1;function No(n,c,h){return c==="touchstart"&&Fo(),Bo[c]?(h=Bo[c].bind(this,h),n.addEventListener(uo[c],h,!1),h):(console.warn("wrong event specified:",c),g)}function Lo(n,c,h){if(!uo[c]){console.warn("wrong event specified:",c);return}n.removeEventListener(uo[c],h,!1)}function Zs(n){Vn[n.pointerId]=n}function qs(n){Vn[n.pointerId]&&(Vn[n.pointerId]=n)}function mn(n){delete Vn[n.pointerId]}function Fo(){xa||(document.addEventListener(St,Zs,!0),document.addEventListener(qt,qs,!0),document.addEventListener(Yt,mn,!0),document.addEventListener(Oo,mn,!0),xa=!0)}function sn(n,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var h in Vn)c.touches.push(Vn[h]);c.changedTouches=[c],n(c)}}function So(n,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&Wt(c),sn(n,c)}function ho(n){var c={},h,b;for(b in n)h=n[b],c[b]=h&&h.bind?h.bind(n):h;return n=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var bs=200;function xo(n,c){n.addEventListener("dblclick",c);var h=0,b;function I(z){if(z.detail!==1){b=z.detail;return}if(!(z.pointerType==="mouse"||z.sourceCapabilities&&!z.sourceCapabilities.firesTouchEvents)){var te=ci(z);if(!(te.some(function(xe){return xe instanceof HTMLLabelElement&&xe.attributes.for})&&!te.some(function(xe){return xe instanceof HTMLInputElement||xe instanceof HTMLSelectElement}))){var ke=Date.now();ke-h<=bs?(b++,b===2&&c(ho(z))):b=1,h=ke}}}return n.addEventListener("click",I),{dblclick:c,simDblclick:I}}function ws(n,c){n.removeEventListener("dblclick",c.dblclick),n.removeEventListener("click",c.simDblclick)}var Io=Ws(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Uo=Ws(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),gn=Uo==="webkitTransition"||Uo==="OTransition"?Uo+"End":"transitionend";function $o(n){return typeof n=="string"?document.getElementById(n):n}function Gn(n,c){var h=n.style[c]||n.currentStyle&&n.currentStyle[c];if((!h||h==="auto")&&document.defaultView){var b=document.defaultView.getComputedStyle(n,null);h=b?b[c]:null}return h==="auto"?null:h}function pt(n,c,h){var b=document.createElement(n);return b.className=c||"",h&&h.appendChild(b),b}function xt(n){var c=n.parentNode;c&&c.removeChild(n)}function To(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function fo(n){var c=n.parentNode;c&&c.lastChild!==n&&c.appendChild(n)}function zo(n){var c=n.parentNode;c&&c.firstChild!==n&&c.insertBefore(n,c.firstChild)}function Ia(n,c){if(n.classList!==void 0)return n.classList.contains(c);var h=Ho(n);return h.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(h)}function dt(n,c){if(n.classList!==void 0)for(var h=_(c),b=0,I=h.length;b<I;b++)n.classList.add(h[b]);else if(!Ia(n,c)){var z=Ho(n);$a(n,(z?z+" ":"")+c)}}function Ft(n,c){n.classList!==void 0?n.classList.remove(c):$a(n,k((" "+Ho(n)+" ").replace(" "+c+" "," ")))}function $a(n,c){n.className.baseVal===void 0?n.className=c:n.className.baseVal=c}function Ho(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function yn(n,c){"opacity"in n.style?n.style.opacity=c:"filter"in n.style&&ri(n,c)}function ri(n,c){var h=!1,b="DXImageTransform.Microsoft.Alpha";try{h=n.filters.item(b)}catch{if(c===1)return}c=Math.round(c*100),h?(h.Enabled=c!==100,h.Opacity=c):n.style.filter+=" progid:"+b+"(opacity="+c+")"}function Ws(n){for(var c=document.documentElement.style,h=0;h<n.length;h++)if(n[h]in c)return n[h];return!1}function po(n,c,h){var b=c||new U(0,0);n.style[Io]=(Ge.ie3d?"translate("+b.x+"px,"+b.y+"px)":"translate3d("+b.x+"px,"+b.y+"px,0)")+(h?" scale("+h+")":"")}function Zt(n,c){n._leaflet_pos=c,Ge.any3d?po(n,c):(n.style.left=c.x+"px",n.style.top=c.y+"px")}function Vo(n){return n._leaflet_pos||new U(0,0)}var kn,Tn,Ta;if("onselectstart"in document)kn=function(){lt(window,"selectstart",Wt)},Tn=function(){It(window,"selectstart",Wt)};else{var _n=Ws(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);kn=function(){if(_n){var n=document.documentElement.style;Ta=n[_n],n[_n]="none"}},Tn=function(){_n&&(document.documentElement.style[_n]=Ta,Ta=void 0)}}function Ma(){lt(window,"dragstart",Wt)}function Ut(){It(window,"dragstart",Wt)}var Cs,Ks;function Js(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(Ys(),Cs=n,Ks=n.style.outlineStyle,n.style.outlineStyle="none",lt(window,"keydown",Ys))}function Ys(){Cs&&(Cs.style.outlineStyle=Ks,Cs=void 0,Ks=void 0,It(window,"keydown",Ys))}function Aa(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function Mn(n){var c=n.getBoundingClientRect();return{x:c.width/n.offsetWidth||1,y:c.height/n.offsetHeight||1,boundingClientRect:c}}var Go={__proto__:null,TRANSFORM:Io,TRANSITION:Uo,TRANSITION_END:gn,get:$o,getStyle:Gn,create:pt,remove:xt,empty:To,toFront:fo,toBack:zo,hasClass:Ia,addClass:dt,removeClass:Ft,setClass:$a,getClass:Ho,setOpacity:yn,testProp:Ws,setTransform:po,setPosition:Zt,getPosition:Vo,get disableTextSelection(){return kn},get enableTextSelection(){return Tn},disableImageDrag:Ma,enableImageDrag:Ut,preventOutline:Js,restoreOutline:Ys,getSizedParentNode:Aa,getScale:Mn};function lt(n,c,h,b){if(c&&typeof c=="object")for(var I in c)mo(n,I,c[I],h);else{c=_(c);for(var z=0,te=c.length;z<te;z++)mo(n,c[z],h,b)}return this}var bn="_leaflet_events";function It(n,c,h,b){if(arguments.length===1)no(n),delete n[bn];else if(c&&typeof c=="object")for(var I in c)as(n,I,c[I],h);else if(c=_(c),arguments.length===2)no(n,function(ke){return P(c,ke)!==-1});else for(var z=0,te=c.length;z<te;z++)as(n,c[z],h,b);return this}function no(n,c){for(var h in n[bn]){var b=h.split(/\d/)[0];(!c||c(b))&&as(n,b,null,null,h)}}var vo={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function mo(n,c,h,b){var I=c+d(h)+(b?"_"+d(b):"");if(n[bn]&&n[bn][I])return this;var z=function(ke){return h.call(b||n,ke||window.event)},te=z;!Ge.touchNative&&Ge.pointer&&c.indexOf("touch")===0?z=No(n,c,z):Ge.touch&&c==="dblclick"?z=xo(n,z):"addEventListener"in n?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?n.addEventListener(vo[c]||c,z,Ge.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(z=function(ke){ke=ke||window.event,Qs(n,ke)&&te(ke)},n.addEventListener(vo[c],z,!1)):n.addEventListener(c,te,!1):n.attachEvent("on"+c,z),n[bn]=n[bn]||{},n[bn][I]=z}function as(n,c,h,b,I){I=I||c+d(h)+(b?"_"+d(b):"");var z=n[bn]&&n[bn][I];if(!z)return this;!Ge.touchNative&&Ge.pointer&&c.indexOf("touch")===0?Lo(n,c,z):Ge.touch&&c==="dblclick"?ws(n,z):"removeEventListener"in n?n.removeEventListener(vo[c]||c,z,!1):n.detachEvent("on"+c,z),n[bn][I]=null}function go(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function Ea(n){return mo(n,"wheel",go),this}function is(n){return lt(n,"mousedown touchstart dblclick contextmenu",go),n._leaflet_disable_click=!0,this}function Wt(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function Mo(n){return Wt(n),go(n),this}function ci(n){if(n.composedPath)return n.composedPath();for(var c=[],h=n.target;h;)c.push(h),h=h.parentNode;return c}function Xs(n,c){if(!c)return new U(n.clientX,n.clientY);var h=Mn(c),b=h.boundingClientRect;return new U((n.clientX-b.left)/h.x-c.clientLeft,(n.clientY-b.top)/h.y-c.clientTop)}var qi=Ge.linux&&Ge.chrome?window.devicePixelRatio:Ge.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Pa(n){return Ge.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/qi:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function Qs(n,c){var h=c.relatedTarget;if(!h)return!0;try{for(;h&&h!==n;)h=h.parentNode}catch{return!1}return h!==n}var Da={__proto__:null,on:lt,off:It,stopPropagation:go,disableScrollPropagation:Ea,disableClickPropagation:is,preventDefault:Wt,stop:Mo,getPropagationPath:ci,getMousePosition:Xs,getWheelDelta:Pa,isExternalTarget:Qs,addListener:lt,removeListener:It},Ra=he.extend({run:function(n,c,h,b){this.stop(),this._el=n,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(b||.5,.2),this._startPos=Vo(n),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=R(this._animate,this),this._step()},_step:function(n){var c=+new Date-this._startTime,h=this._duration*1e3;c<h?this._runFrame(this._easeOut(c/h),n):(this._runFrame(1),this._complete())},_runFrame:function(n,c){var h=this._startPos.add(this._offset.multiplyBy(n));c&&h._round(),Zt(this._el,h),this.fire("step")},_complete:function(){W(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),yt=he.extend({options:{crs:X,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,c){c=w(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(Ke(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Uo&&Ge.any3d&&!Ge.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),lt(this._proxy,gn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,c,h){if(c=c===void 0?this._zoom:this._limitZoom(c),n=this._limitCenter(Ke(n),c,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=s({animate:h.animate},h.zoom),h.pan=s({animate:h.animate,duration:h.duration},h.pan));var b=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,c,h.zoom):this._tryAnimatedPan(n,h.pan);if(b)return clearTimeout(this._sizeTimer),this}return this._resetView(n,c,h.pan&&h.pan.noMoveStart),this},setZoom:function(n,c){return this._loaded?this.setView(this.getCenter(),n,{zoom:c}):(this._zoom=n,this)},zoomIn:function(n,c){return n=n||(Ge.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,c)},zoomOut:function(n,c){return n=n||(Ge.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,c)},setZoomAround:function(n,c,h){var b=this.getZoomScale(c),I=this.getSize().divideBy(2),z=n instanceof U?n:this.latLngToContainerPoint(n),te=z.subtract(I).multiplyBy(1-1/b),ke=this.containerPointToLatLng(I.add(te));return this.setView(ke,c,{zoom:h})},_getBoundsCenterZoom:function(n,c){c=c||{},n=n.getBounds?n.getBounds():Je(n);var h=de(c.paddingTopLeft||c.padding||[0,0]),b=de(c.paddingBottomRight||c.padding||[0,0]),I=this.getBoundsZoom(n,!1,h.add(b));if(I=typeof c.maxZoom=="number"?Math.min(c.maxZoom,I):I,I===1/0)return{center:n.getCenter(),zoom:I};var z=b.subtract(h).divideBy(2),te=this.project(n.getSouthWest(),I),ke=this.project(n.getNorthEast(),I),xe=this.unproject(te.add(ke).divideBy(2).add(z),I);return{center:xe,zoom:I}},fitBounds:function(n,c){if(n=Je(n),!n.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(n,c);return this.setView(h.center,h.zoom,c)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,c){return this.setView(n,this._zoom,{pan:c})},panBy:function(n,c){if(n=de(n).round(),c=c||{},!n.x&&!n.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ra,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){dt(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,h,c.duration||.25,c.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,c,h){if(h=h||{},h.animate===!1||!Ge.any3d)return this.setView(n,c,h);this._stop();var b=this.project(this.getCenter()),I=this.project(n),z=this.getSize(),te=this._zoom;n=Ke(n),c=c===void 0?te:c;var ke=Math.max(z.x,z.y),xe=ke*this.getZoomScale(te,c),Ue=I.distanceTo(b)||1,nt=1.42,ct=nt*nt;function kt(ln){var sr=ln?-1:1,hm=ln?xe:ke,fm=xe*xe-ke*ke+sr*ct*ct*Ue*Ue,pm=2*hm*ct*Ue,Tc=fm/pm,Sd=Math.sqrt(Tc*Tc+1)-Tc,vm=Sd<1e-9?-18:Math.log(Sd);return vm}function jn(ln){return(Math.exp(ln)-Math.exp(-ln))/2}function hn(ln){return(Math.exp(ln)+Math.exp(-ln))/2}function Eo(ln){return jn(ln)/hn(ln)}var ao=kt(0);function wi(ln){return ke*(hn(ao)/hn(ao+nt*ln))}function rm(ln){return ke*(hn(ao)*Eo(ao+nt*ln)-jn(ao))/ct}function cm(ln){return 1-Math.pow(1-ln,1.5)}var um=Date.now(),Cd=(kt(1)-ao)/nt,dm=h.duration?1e3*h.duration:1e3*Cd*.8;function Ld(){var ln=(Date.now()-um)/dm,sr=cm(ln)*Cd;ln<=1?(this._flyToFrame=R(Ld,this),this._move(this.unproject(b.add(I.subtract(b).multiplyBy(rm(sr)/Ue)),te),this.getScaleZoom(ke/wi(sr),te),{flyTo:!0})):this._move(n,c)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),Ld.call(this),this},flyToBounds:function(n,c){var h=this._getBoundsCenterZoom(n,c);return this.flyTo(h.center,h.zoom,c)},setMaxBounds:function(n){return n=Je(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var c=this.options.minZoom;return this.options.minZoom=n,this._loaded&&c!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var c=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&c!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,c){this._enforcingBounds=!0;var h=this.getCenter(),b=this._limitCenter(h,this._zoom,Je(n));return h.equals(b)||this.panTo(b,c),this._enforcingBounds=!1,this},panInside:function(n,c){c=c||{};var h=de(c.paddingTopLeft||c.padding||[0,0]),b=de(c.paddingBottomRight||c.padding||[0,0]),I=this.project(this.getCenter()),z=this.project(n),te=this.getPixelBounds(),ke=De([te.min.add(h),te.max.subtract(b)]),xe=ke.getSize();if(!ke.contains(z)){this._enforcingBounds=!0;var Ue=z.subtract(ke.getCenter()),nt=ke.extend(z).getSize().subtract(xe);I.x+=Ue.x<0?-nt.x:nt.x,I.y+=Ue.y<0?-nt.y:nt.y,this.panTo(this.unproject(I),c),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=s({animate:!1,pan:!0},n===!0?{animate:!0}:n);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),b=c.divideBy(2).round(),I=h.divideBy(2).round(),z=b.subtract(I);return!z.x&&!z.y?this:(n.animate&&n.pan?this.panBy(z):(n.pan&&this._rawPanBy(z),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=s({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=l(this._handleGeolocationResponse,this),h=l(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,h,n):navigator.geolocation.getCurrentPosition(c,h,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var c=n.code,h=n.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var c=n.coords.latitude,h=n.coords.longitude,b=new Fe(c,h),I=b.toBounds(n.coords.accuracy*2),z=this._locateOptions;if(z.setView){var te=this.getBoundsZoom(I);this.setView(b,z.maxZoom?Math.min(te,z.maxZoom):te)}var ke={latlng:b,bounds:I,timestamp:n.timestamp};for(var xe in n.coords)typeof n.coords[xe]=="number"&&(ke[xe]=n.coords[xe]);this.fire("locationfound",ke)}},addHandler:function(n,c){if(!c)return this;var h=this[n]=new c(this);return this._handlers.push(h),this.options[n]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),xt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(W(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)xt(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,c){var h="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),b=pt("div",h,c||this._mapPane);return n&&(this._panes[n]=b),b},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),c=this.unproject(n.getBottomLeft()),h=this.unproject(n.getTopRight());return new et(c,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,c,h){n=Je(n),h=de(h||[0,0]);var b=this.getZoom()||0,I=this.getMinZoom(),z=this.getMaxZoom(),te=n.getNorthWest(),ke=n.getSouthEast(),xe=this.getSize().subtract(h),Ue=De(this.project(ke,b),this.project(te,b)).getSize(),nt=Ge.any3d?this.options.zoomSnap:1,ct=xe.x/Ue.x,kt=xe.y/Ue.y,jn=c?Math.max(ct,kt):Math.min(ct,kt);return b=this.getScaleZoom(jn,b),nt&&(b=Math.round(b/(nt/100))*(nt/100),b=c?Math.ceil(b/nt)*nt:Math.floor(b/nt)*nt),Math.max(I,Math.min(z,b))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new U(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,c){var h=this._getTopLeftPoint(n,c);return new re(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,c){var h=this.options.crs;return c=c===void 0?this._zoom:c,h.scale(n)/h.scale(c)},getScaleZoom:function(n,c){var h=this.options.crs;c=c===void 0?this._zoom:c;var b=h.zoom(n*h.scale(c));return isNaN(b)?1/0:b},project:function(n,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(Ke(n),c)},unproject:function(n,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(de(n),c)},layerPointToLatLng:function(n){var c=de(n).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(n){var c=this.project(Ke(n))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(Ke(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(Je(n))},distance:function(n,c){return this.options.crs.distance(Ke(n),Ke(c))},containerPointToLayerPoint:function(n){return de(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return de(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var c=this.containerPointToLayerPoint(de(n));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Ke(n)))},mouseEventToContainerPoint:function(n){return Xs(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var c=this._container=$o(n);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");lt(c,"scroll",this._onScroll,this),this._containerId=d(c)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ge.any3d,dt(n,"leaflet-container"+(Ge.touch?" leaflet-touch":"")+(Ge.retina?" leaflet-retina":"")+(Ge.ielt9?" leaflet-oldie":"")+(Ge.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=Gn(n,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Zt(this._mapPane,new U(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(dt(n.markerPane,"leaflet-zoom-hide"),dt(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,c,h){Zt(this._mapPane,new U(0,0));var b=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var I=this._zoom!==c;this._moveStart(I,h)._move(n,c)._moveEnd(I),this.fire("viewreset"),b&&this.fire("load")},_moveStart:function(n,c){return n&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(n,c,h,b){c===void 0&&(c=this._zoom);var I=this._zoom!==c;return this._zoom=c,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),b?h&&h.pinch&&this.fire("zoom",h):((I||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return W(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){Zt(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[d(this._container)]=this;var c=n?It:lt;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),Ge.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){W(this._resizeRequest),this._resizeRequest=R(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,c){for(var h=[],b,I=c==="mouseout"||c==="mouseover",z=n.target||n.srcElement,te=!1;z;){if(b=this._targets[d(z)],b&&(c==="click"||c==="preclick")&&this._draggableMoved(b)){te=!0;break}if(b&&b.listens(c,!0)&&(I&&!Qs(z,n)||(h.push(b),I))||z===this._container)break;z=z.parentNode}return!h.length&&!te&&!I&&this.listens(c,!0)&&(h=[this]),h},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var c=n.target||n.srcElement;if(!(!this._loaded||c._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(c))){var h=n.type;h==="mousedown"&&Js(c),this._fireDOMEvent(n,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,c,h){if(n.type==="click"){var b=s({},n);b.type="preclick",this._fireDOMEvent(b,b.type,h)}var I=this._findEventTargets(n,c);if(h){for(var z=[],te=0;te<h.length;te++)h[te].listens(c,!0)&&z.push(h[te]);I=z.concat(I)}if(I.length){c==="contextmenu"&&Wt(n);var ke=I[0],xe={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var Ue=ke.getLatLng&&(!ke._radius||ke._radius<=10);xe.containerPoint=Ue?this.latLngToContainerPoint(ke.getLatLng()):this.mouseEventToContainerPoint(n),xe.layerPoint=this.containerPointToLayerPoint(xe.containerPoint),xe.latlng=Ue?ke.getLatLng():this.layerPointToLatLng(xe.layerPoint)}for(te=0;te<I.length;te++)if(I[te].fire(c,xe,!0),xe.originalEvent._stopped||I[te].options.bubblingMouseEvents===!1&&P(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,c=this._handlers.length;n<c;n++)this._handlers[n].disable()},whenReady:function(n,c){return this._loaded?n.call(c||this,{target:this}):this.on("load",n,c),this},_getMapPanePos:function(){return Vo(this._mapPane)||new U(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,c){var h=n&&c!==void 0?this._getNewPixelOrigin(n,c):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,c){var h=this.getSize()._divideBy(2);return this.project(n,c)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,c,h){var b=this._getNewPixelOrigin(h,c);return this.project(n,c)._subtract(b)},_latLngBoundsToNewLayerBounds:function(n,c,h){var b=this._getNewPixelOrigin(h,c);return De([this.project(n.getSouthWest(),c)._subtract(b),this.project(n.getNorthWest(),c)._subtract(b),this.project(n.getSouthEast(),c)._subtract(b),this.project(n.getNorthEast(),c)._subtract(b)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,c,h){if(!h)return n;var b=this.project(n,c),I=this.getSize().divideBy(2),z=new re(b.subtract(I),b.add(I)),te=this._getBoundsOffset(z,h,c);return Math.abs(te.x)<=1&&Math.abs(te.y)<=1?n:this.unproject(b.add(te),c)},_limitOffset:function(n,c){if(!c)return n;var h=this.getPixelBounds(),b=new re(h.min.add(n),h.max.add(n));return n.add(this._getBoundsOffset(b,c))},_getBoundsOffset:function(n,c,h){var b=De(this.project(c.getNorthEast(),h),this.project(c.getSouthWest(),h)),I=b.min.subtract(n.min),z=b.max.subtract(n.max),te=this._rebound(I.x,-z.x),ke=this._rebound(I.y,-z.y);return new U(te,ke)},_rebound:function(n,c){return n+c>0?Math.round(n-c)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(c))},_limitZoom:function(n){var c=this.getMinZoom(),h=this.getMaxZoom(),b=Ge.any3d?this.options.zoomSnap:1;return b&&(n=Math.round(n/b)*b),Math.max(c,Math.min(h,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Ft(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,c){var h=this._getCenterOffset(n)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,c),!0)},_createAnimProxy:function(){var n=this._proxy=pt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(c){var h=Io,b=this._proxy.style[h];po(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),b===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){xt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),c=this.getZoom();po(this._proxy,this.project(n,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,c,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var b=this.getZoomScale(c),I=this._getCenterOffset(n)._divideBy(1-1/b);return h.animate!==!0&&!this.getSize().contains(I)?!1:(R(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(n,c,!0)},this),!0)},_animateZoom:function(n,c,h,b){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=c,dt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:c,noUpdate:b}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Ft(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Wi(n,c){return new yt(n,c)}var wn=ue.extend({options:{position:"topright"},initialize:function(n){w(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var c=this._map;return c&&c.removeControl(this),this.options.position=n,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var c=this._container=this.onAdd(n),h=this.getPosition(),b=n._controlCorners[h];return dt(c,"leaflet-control"),h.indexOf("bottom")!==-1?b.insertBefore(c,b.firstChild):b.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(xt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),ls=function(n){return new wn(n)};yt.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},c="leaflet-",h=this._controlContainer=pt("div",c+"control-container",this._container);function b(I,z){var te=c+I+" "+c+z;n[I+z]=pt("div",te,h)}b("top","left"),b("top","right"),b("bottom","left"),b("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)xt(this._controlCorners[n]);xt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Oa=wn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,c,h,b){return h<b?-1:b<h?1:0}},initialize:function(n,c,h){w(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var b in n)this._addLayer(n[b],b);for(b in c)this._addLayer(c[b],b,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return wn.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,c){return this._addLayer(n,c),this._map?this._update():this},addOverlay:function(n,c){return this._addLayer(n,c,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var c=this._getLayer(d(n));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){dt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(dt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):Ft(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Ft(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",c=this._container=pt("div",n),h=this.options.collapsed;c.setAttribute("aria-haspopup",!0),is(c),Ea(c);var b=this._section=pt("section",n+"-list");h&&(this._map.on("click",this.collapse,this),lt(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var I=this._layersLink=pt("a",n+"-toggle",c);I.href="#",I.title="Layers",I.setAttribute("role","button"),lt(I,{keydown:function(z){z.keyCode===13&&this._expandSafely()},click:function(z){Wt(z),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=pt("div",n+"-base",b),this._separator=pt("div",n+"-separator",b),this._overlaysList=pt("div",n+"-overlays",b),c.appendChild(b)},_getLayer:function(n){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&d(this._layers[c].layer)===n)return this._layers[c]},_addLayer:function(n,c,h){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:c,overlay:h}),this.options.sortLayers&&this._layers.sort(l(function(b,I){return this.options.sortFunction(b.layer,I.layer,b.name,I.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;To(this._baseLayersList),To(this._overlaysList),this._layerControlInputs=[];var n,c,h,b,I=0;for(h=0;h<this._layers.length;h++)b=this._layers[h],this._addItem(b),c=c||b.overlay,n=n||!b.overlay,I+=b.overlay?0:1;return this.options.hideSingleBase&&(n=n&&I>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=c&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var c=this._getLayer(d(n.target)),h=c.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;h&&this._map.fire(h,c)},_createRadioElement:function(n,c){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(c?' checked="checked"':"")+"/>",b=document.createElement("div");return b.innerHTML=h,b.firstChild},_addItem:function(n){var c=document.createElement("label"),h=this._map.hasLayer(n.layer),b;n.overlay?(b=document.createElement("input"),b.type="checkbox",b.className="leaflet-control-layers-selector",b.defaultChecked=h):b=this._createRadioElement("leaflet-base-layers_"+d(this),h),this._layerControlInputs.push(b),b.layerId=d(n.layer),lt(b,"click",this._onInputClick,this);var I=document.createElement("span");I.innerHTML=" "+n.name;var z=document.createElement("span");c.appendChild(z),z.appendChild(b),z.appendChild(I);var te=n.overlay?this._overlaysList:this._baseLayersList;return te.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,c,h,b=[],I=[];this._handlingClick=!0;for(var z=n.length-1;z>=0;z--)c=n[z],h=this._getLayer(c.layerId).layer,c.checked?b.push(h):c.checked||I.push(h);for(z=0;z<I.length;z++)this._map.hasLayer(I[z])&&this._map.removeLayer(I[z]);for(z=0;z<b.length;z++)this._map.hasLayer(b[z])||this._map.addLayer(b[z]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,c,h,b=this._map.getZoom(),I=n.length-1;I>=0;I--)c=n[I],h=this._getLayer(c.layerId).layer,c.disabled=h.options.minZoom!==void 0&&b<h.options.minZoom||h.options.maxZoom!==void 0&&b>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,lt(n,"click",Wt),this.expand();var c=this;setTimeout(function(){It(n,"click",Wt),c._preventClick=!1})}}),ui=function(n,c,h){return new Oa(n,c,h)},Ba=wn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var c="leaflet-control-zoom",h=pt("div",c+" leaflet-bar"),b=this.options;return this._zoomInButton=this._createButton(b.zoomInText,b.zoomInTitle,c+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(b.zoomOutText,b.zoomOutTitle,c+"-out",h,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,c,h,b,I){var z=pt("a",h,b);return z.innerHTML=n,z.href="#",z.title=c,z.setAttribute("role","button"),z.setAttribute("aria-label",c),is(z),lt(z,"click",Mo),lt(z,"click",I,this),lt(z,"click",this._refocusOnMap,this),z},_updateDisabled:function(){var n=this._map,c="leaflet-disabled";Ft(this._zoomInButton,c),Ft(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(dt(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(dt(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});yt.mergeOptions({zoomControl:!0}),yt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ba,this.addControl(this.zoomControl))});var Ee=function(n){return new Ba(n)},$e=wn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var c="leaflet-control-scale",h=pt("div",c),b=this.options;return this._addScales(b,c+"-line",h),n.on(b.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),h},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,c,h){n.metric&&(this._mScale=pt("div",c,h)),n.imperial&&(this._iScale=pt("div",c,h))},_update:function(){var n=this._map,c=n.getSize().y/2,h=n.distance(n.containerPointToLatLng([0,c]),n.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(h)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var c=this._getRoundNum(n),h=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,h,c/n)},_updateImperial:function(n){var c=n*3.2808399,h,b,I;c>5280?(h=c/5280,b=this._getRoundNum(h),this._updateScale(this._iScale,b+" mi",b/h)):(I=this._getRoundNum(c),this._updateScale(this._iScale,I+" ft",I/c))},_updateScale:function(n,c,h){n.style.width=Math.round(this.options.maxWidth*h)+"px",n.innerHTML=c},_getRoundNum:function(n){var c=Math.pow(10,(Math.floor(n)+"").length-1),h=n/c;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,c*h}}),at=function(n){return new $e(n)},vt='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',wt=wn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ge.inlineSvg?vt+" ":"")+"Leaflet</a>"},initialize:function(n){w(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=pt("div","leaflet-control-attribution"),is(this._container);for(var c in n._layers)n._layers[c].getAttribution&&this.addAttribution(n._layers[c].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var c in this._attributions)this._attributions[c]&&n.push(c);var h=[];this.options.prefix&&h.push(this.options.prefix),n.length&&h.push(n.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});yt.mergeOptions({attributionControl:!0}),yt.addInitHook(function(){this.options.attributionControl&&new wt().addTo(this)});var Cn=function(n){return new wt(n)};wn.Layers=Oa,wn.Zoom=Ba,wn.Scale=$e,wn.Attribution=wt,ls.layers=ui,ls.zoom=Ee,ls.scale=at,ls.attribution=Cn;var Xt=ue.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Xt.addTo=function(n,c){return n.addHandler(c,this),this};var An={Events:Q},zt=Ge.touch?"touchstart mousedown":"mousedown",Qt=he.extend({options:{clickTolerance:3},initialize:function(n,c,h,b){w(this,b),this._element=n,this._dragStartTarget=c||n,this._preventOutline=h},enable:function(){this._enabled||(lt(this._dragStartTarget,zt,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Qt._dragging===this&&this.finishDrag(!0),It(this._dragStartTarget,zt,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!Ia(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){Qt._dragging===this&&this.finishDrag();return}if(!(Qt._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(Qt._dragging=this,this._preventOutline&&Js(this._element),Ma(),kn(),!this._moving)){this.fire("down");var c=n.touches?n.touches[0]:n,h=Aa(this._element);this._startPoint=new U(c.clientX,c.clientY),this._startPos=Vo(this._element),this._parentScale=Mn(h);var b=n.type==="mousedown";lt(document,b?"mousemove":"touchmove",this._onMove,this),lt(document,b?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var c=n.touches&&n.touches.length===1?n.touches[0]:n,h=new U(c.clientX,c.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,Wt(n),this._moved||(this.fire("dragstart"),this._moved=!0,dt(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),dt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),Zt(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){Ft(document.body,"leaflet-dragging"),this._lastTarget&&(Ft(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),It(document,"mousemove touchmove",this._onMove,this),It(document,"mouseup touchend touchcancel",this._onUp,this),Ut(),Tn();var c=this._moved&&this._moving;this._moving=!1,Qt._dragging=!1,c&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function $t(n,c,h){var b,I=[1,4,2,8],z,te,ke,xe,Ue,nt,ct,kt;for(z=0,nt=n.length;z<nt;z++)n[z]._code=rs(n[z],c);for(ke=0;ke<4;ke++){for(ct=I[ke],b=[],z=0,nt=n.length,te=nt-1;z<nt;te=z++)xe=n[z],Ue=n[te],xe._code&ct?Ue._code&ct||(kt=di(Ue,xe,ct,c,h),kt._code=rs(kt,c),b.push(kt)):(Ue._code&ct&&(kt=di(Ue,xe,ct,c,h),kt._code=rs(kt,c),b.push(kt)),b.push(xe));n=b}return n}function en(n,c){var h,b,I,z,te,ke,xe,Ue,nt;if(!n||n.length===0)throw new Error("latlngs not passed");so(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var ct=Ke([0,0]),kt=Je(n),jn=kt.getNorthWest().distanceTo(kt.getSouthWest())*kt.getNorthEast().distanceTo(kt.getNorthWest());jn<1700&&(ct=En(n));var hn=n.length,Eo=[];for(h=0;h<hn;h++){var ao=Ke(n[h]);Eo.push(c.project(Ke([ao.lat-ct.lat,ao.lng-ct.lng])))}for(ke=xe=Ue=0,h=0,b=hn-1;h<hn;b=h++)I=Eo[h],z=Eo[b],te=I.y*z.x-z.y*I.x,xe+=(I.x+z.x)*te,Ue+=(I.y+z.y)*te,ke+=te*3;ke===0?nt=Eo[0]:nt=[xe/ke,Ue/ke];var wi=c.unproject(de(nt));return Ke([wi.lat+ct.lat,wi.lng+ct.lng])}function En(n){for(var c=0,h=0,b=0,I=0;I<n.length;I++){var z=Ke(n[I]);c+=z.lat,h+=z.lng,b++}return Ke([c/b,h/b])}var Ao={__proto__:null,clipPolygon:$t,polygonCenter:en,centroid:En};function oo(n,c){if(!c||!n.length)return n.slice();var h=c*c;return n=kc(n,h),n=yc(n,h),n}function ea(n,c,h){return Math.sqrt(ta(n,c,h,!0))}function Ki(n,c,h){return ta(n,c,h)}function yc(n,c){var h=n.length,b=typeof Uint8Array<"u"?Uint8Array:Array,I=new b(h);I[0]=I[h-1]=1,Na(n,I,c,0,h-1);var z,te=[];for(z=0;z<h;z++)I[z]&&te.push(n[z]);return te}function Na(n,c,h,b,I){var z=0,te,ke,xe;for(ke=b+1;ke<=I-1;ke++)xe=ta(n[ke],n[b],n[I],!0),xe>z&&(te=ke,z=xe);z>h&&(c[te]=1,Na(n,c,h,b,te),Na(n,c,h,te,I))}function kc(n,c){for(var h=[n[0]],b=1,I=0,z=n.length;b<z;b++)_c(n[b],n[I])>c&&(h.push(n[b]),I=b);return I<z-1&&h.push(n[z-1]),h}var Wl;function Ji(n,c,h,b,I){var z=b?Wl:rs(n,h),te=rs(c,h),ke,xe,Ue;for(Wl=te;;){if(!(z|te))return[n,c];if(z&te)return!1;ke=z||te,xe=di(n,c,ke,h,I),Ue=rs(xe,h),ke===z?(n=xe,z=Ue):(c=xe,te=Ue)}}function di(n,c,h,b,I){var z=c.x-n.x,te=c.y-n.y,ke=b.min,xe=b.max,Ue,nt;return h&8?(Ue=n.x+z*(xe.y-n.y)/te,nt=xe.y):h&4?(Ue=n.x+z*(ke.y-n.y)/te,nt=ke.y):h&2?(Ue=xe.x,nt=n.y+te*(xe.x-n.x)/z):h&1&&(Ue=ke.x,nt=n.y+te*(ke.x-n.x)/z),new U(Ue,nt,I)}function rs(n,c){var h=0;return n.x<c.min.x?h|=1:n.x>c.max.x&&(h|=2),n.y<c.min.y?h|=4:n.y>c.max.y&&(h|=8),h}function _c(n,c){var h=c.x-n.x,b=c.y-n.y;return h*h+b*b}function ta(n,c,h,b){var I=c.x,z=c.y,te=h.x-I,ke=h.y-z,xe=te*te+ke*ke,Ue;return xe>0&&(Ue=((n.x-I)*te+(n.y-z)*ke)/xe,Ue>1?(I=h.x,z=h.y):Ue>0&&(I+=te*Ue,z+=ke*Ue)),te=n.x-I,ke=n.y-z,b?te*te+ke*ke:new U(I,z)}function so(n){return!x(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function Kl(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),so(n)}function Jl(n,c){var h,b,I,z,te,ke,xe,Ue;if(!n||n.length===0)throw new Error("latlngs not passed");so(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var nt=Ke([0,0]),ct=Je(n),kt=ct.getNorthWest().distanceTo(ct.getSouthWest())*ct.getNorthEast().distanceTo(ct.getNorthWest());kt<1700&&(nt=En(n));var jn=n.length,hn=[];for(h=0;h<jn;h++){var Eo=Ke(n[h]);hn.push(c.project(Ke([Eo.lat-nt.lat,Eo.lng-nt.lng])))}for(h=0,b=0;h<jn-1;h++)b+=hn[h].distanceTo(hn[h+1])/2;if(b===0)Ue=hn[0];else for(h=0,z=0;h<jn-1;h++)if(te=hn[h],ke=hn[h+1],I=te.distanceTo(ke),z+=I,z>b){xe=(z-b)/I,Ue=[ke.x-xe*(ke.x-te.x),ke.y-xe*(ke.y-te.y)];break}var ao=c.unproject(de(Ue));return Ke([ao.lat+nt.lat,ao.lng+nt.lng])}var bc={__proto__:null,simplify:oo,pointToSegmentDistance:ea,closestPointOnSegment:Ki,clipSegment:Ji,_getEdgeIntersection:di,_getBitCode:rs,_sqClosestPointOnSegment:ta,isFlat:so,_flat:Kl,polylineCenter:Jl},Yi={project:function(n){return new U(n.lng,n.lat)},unproject:function(n){return new Fe(n.y,n.x)},bounds:new re([-180,-90],[180,90])},Xi={R:6378137,R_MINOR:6356752314245179e-9,bounds:new re([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var c=Math.PI/180,h=this.R,b=n.lat*c,I=this.R_MINOR/h,z=Math.sqrt(1-I*I),te=z*Math.sin(b),ke=Math.tan(Math.PI/4-b/2)/Math.pow((1-te)/(1+te),z/2);return b=-h*Math.log(Math.max(ke,1e-10)),new U(n.lng*c*h,b)},unproject:function(n){for(var c=180/Math.PI,h=this.R,b=this.R_MINOR/h,I=Math.sqrt(1-b*b),z=Math.exp(-n.y/h),te=Math.PI/2-2*Math.atan(z),ke=0,xe=.1,Ue;ke<15&&Math.abs(xe)>1e-7;ke++)Ue=I*Math.sin(te),Ue=Math.pow((1-Ue)/(1+Ue),I/2),xe=Math.PI/2-2*Math.atan(z*Ue)-te,te+=xe;return new Fe(te*c,n.x*c/h)}},wc={__proto__:null,LonLat:Yi,Mercator:Xi,SphericalMercator:Le},Cc=s({},Ve,{code:"EPSG:3395",projection:Xi,transformation:(function(){var n=.5/(Math.PI*Xi.R);return q(n,.5,-n,.5)})()}),Yl=s({},Ve,{code:"EPSG:4326",projection:Yi,transformation:q(1/180,1,-1/180,.5)}),Lc=s({},_e,{projection:Yi,transformation:q(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,c){var h=c.lng-n.lng,b=c.lat-n.lat;return Math.sqrt(h*h+b*b)},infinite:!0});_e.Earth=Ve,_e.EPSG3395=Cc,_e.EPSG3857=X,_e.EPSG900913=fe,_e.EPSG4326=Yl,_e.Simple=Lc;var yo=he.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[d(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[d(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var c=n.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var h=this.getEvents();c.on(h,this),this.once("remove",function(){c.off(h,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});yt.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var c=d(n);return this._layers[c]?this:(this._layers[c]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var c=d(n);return this._layers[c]?(this._loaded&&n.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return d(n)in this._layers},eachLayer:function(n,c){for(var h in this._layers)n.call(c,this._layers[h]);return this},_addLayers:function(n){n=n?x(n)?n:[n]:[];for(var c=0,h=n.length;c<h;c++)this.addLayer(n[c])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[d(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var c=d(n);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,c=-1/0,h=this._getZoomSpan();for(var b in this._zoomBoundLayers){var I=this._zoomBoundLayers[b].options;n=I.minZoom===void 0?n:Math.min(n,I.minZoom),c=I.maxZoom===void 0?c:Math.max(c,I.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=n===1/0?void 0:n,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var na=yo.extend({initialize:function(n,c){w(this,c),this._layers={};var h,b;if(n)for(h=0,b=n.length;h<b;h++)this.addLayer(n[h])},addLayer:function(n){var c=this.getLayerId(n);return this._layers[c]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var c=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(n){var c=typeof n=="number"?n:this.getLayerId(n);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var c=Array.prototype.slice.call(arguments,1),h,b;for(h in this._layers)b=this._layers[h],b[n]&&b[n].apply(b,c);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,c){for(var h in this._layers)n.call(c,this._layers[h]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return d(n)}}),hi=function(n,c){return new na(n,c)},jo=na.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),na.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),na.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new et;for(var c in this._layers){var h=this._layers[c];n.extend(h.getBounds?h.getBounds():h.getLatLng())}return n}}),fi=function(n,c){return new jo(n,c)},oa=ue.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){w(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,c){var h=this._getIconUrl(n);if(!h){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var b=this._createImg(h,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(b,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(b.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),b},_setIconStyles:function(n,c){var h=this.options,b=h[c+"Size"];typeof b=="number"&&(b=[b,b]);var I=de(b),z=de(c==="shadow"&&h.shadowAnchor||h.iconAnchor||I&&I.divideBy(2,!0));n.className="leaflet-marker-"+c+" "+(h.className||""),z&&(n.style.marginLeft=-z.x+"px",n.style.marginTop=-z.y+"px"),I&&(n.style.width=I.x+"px",n.style.height=I.y+"px")},_createImg:function(n,c){return c=c||document.createElement("img"),c.src=n,c},_getIconUrl:function(n){return Ge.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function Xl(n){return new oa(n)}var Ls=oa.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof Ls.imagePath!="string"&&(Ls.imagePath=this._detectIconPath()),(this.options.imagePath||Ls.imagePath)+oa.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var c=function(h,b,I){var z=b.exec(h);return z&&z[I]};return n=c(n,/^url\((['"])?(.+)\1\)$/,2),n&&c(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=pt("div","leaflet-default-icon-path",document.body),c=Gn(n,"background-image")||Gn(n,"backgroundImage");if(document.body.removeChild(n),c=this._stripUrl(c),c)return c;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),pi=Xt.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new Qt(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),dt(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Ft(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var c=this._marker,h=c._map,b=this._marker.options.autoPanSpeed,I=this._marker.options.autoPanPadding,z=Vo(c._icon),te=h.getPixelBounds(),ke=h.getPixelOrigin(),xe=De(te.min._subtract(ke).add(I),te.max._subtract(ke).subtract(I));if(!xe.contains(z)){var Ue=de((Math.max(xe.max.x,z.x)-xe.max.x)/(te.max.x-xe.max.x)-(Math.min(xe.min.x,z.x)-xe.min.x)/(te.min.x-xe.min.x),(Math.max(xe.max.y,z.y)-xe.max.y)/(te.max.y-xe.max.y)-(Math.min(xe.min.y,z.y)-xe.min.y)/(te.min.y-xe.min.y)).multiplyBy(b);h.panBy(Ue,{animate:!1}),this._draggable._newPos._add(Ue),this._draggable._startPos._add(Ue),Zt(c._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=R(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(W(this._panRequest),this._panRequest=R(this._adjustPan.bind(this,n)))},_onDrag:function(n){var c=this._marker,h=c._shadow,b=Vo(c._icon),I=c._map.layerPointToLatLng(b);h&&Zt(h,b),c._latlng=I,n.latlng=I,n.oldLatLng=this._oldLatLng,c.fire("move",n).fire("drag",n)},_onDragEnd:function(n){W(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),vi=yo.extend({options:{icon:new Ls,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,c){w(this,c),this._latlng=Ke(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var c=this._latlng;return this._latlng=Ke(n),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=n.icon.createIcon(this._icon),b=!1;h!==this._icon&&(this._icon&&this._removeIcon(),b=!0,n.title&&(h.title=n.title),h.tagName==="IMG"&&(h.alt=n.alt||"")),dt(h,c),n.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&lt(h,"focus",this._panOnFocus,this);var I=n.icon.createShadow(this._shadow),z=!1;I!==this._shadow&&(this._removeShadow(),z=!0),I&&(dt(I,c),I.alt=""),this._shadow=I,n.opacity<1&&this._updateOpacity(),b&&this.getPane().appendChild(this._icon),this._initInteraction(),I&&z&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&It(this._icon,"focus",this._panOnFocus,this),xt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&xt(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&Zt(this._icon,n),this._shadow&&Zt(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var c=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(dt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),pi)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new pi(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&yn(this._icon,n),this._shadow&&yn(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var c=this.options.icon.options,h=c.iconSize?de(c.iconSize):de(0,0),b=c.iconAnchor?de(c.iconAnchor):de(0,0);n.panInside(this._latlng,{paddingTopLeft:b,paddingBottomRight:h.subtract(b)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Sc(n,c){return new vi(n,c)}var cs=yo.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return w(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),mi=cs.extend({options:{fill:!0,radius:10},initialize:function(n,c){w(this,c),this._latlng=Ke(n),this._radius=this.options.radius},setLatLng:function(n){var c=this._latlng;return this._latlng=Ke(n),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var c=n&&n.radius||this._radius;return cs.prototype.setStyle.call(this,n),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,c=this._radiusY||n,h=this._clickTolerance(),b=[n+h,c+h];this._pxBounds=new re(this._point.subtract(b),this._point.add(b))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function xc(n,c){return new mi(n,c)}var Qi=mi.extend({initialize:function(n,c,h){if(typeof c=="number"&&(c=s({},h,{radius:c})),w(this,c),this._latlng=Ke(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new et(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:cs.prototype.setStyle,_project:function(){var n=this._latlng.lng,c=this._latlng.lat,h=this._map,b=h.options.crs;if(b.distance===Ve.distance){var I=Math.PI/180,z=this._mRadius/Ve.R/I,te=h.project([c+z,n]),ke=h.project([c-z,n]),xe=te.add(ke).divideBy(2),Ue=h.unproject(xe).lat,nt=Math.acos((Math.cos(z*I)-Math.sin(c*I)*Math.sin(Ue*I))/(Math.cos(c*I)*Math.cos(Ue*I)))/I;(isNaN(nt)||nt===0)&&(nt=z/Math.cos(Math.PI/180*c)),this._point=xe.subtract(h.getPixelOrigin()),this._radius=isNaN(nt)?0:xe.x-h.project([Ue,n-nt]).x,this._radiusY=xe.y-te.y}else{var ct=b.unproject(b.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(ct).x}this._updateBounds()}});function Ic(n,c,h){return new Qi(n,c,h)}var Zo=cs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,c){w(this,c),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var c=1/0,h=null,b=ta,I,z,te=0,ke=this._parts.length;te<ke;te++)for(var xe=this._parts[te],Ue=1,nt=xe.length;Ue<nt;Ue++){I=xe[Ue-1],z=xe[Ue];var ct=b(n,I,z,!0);ct<c&&(c=ct,h=b(n,I,z))}return h&&(h.distance=Math.sqrt(c)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Jl(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,c){return c=c||this._defaultShape(),n=Ke(n),c.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new et,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return so(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var c=[],h=so(n),b=0,I=n.length;b<I;b++)h?(c[b]=Ke(n[b]),this._bounds.extend(c[b])):c[b]=this._convertLatLngs(n[b]);return c},_project:function(){var n=new re;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),c=new U(n,n);this._rawPxBounds&&(this._pxBounds=new re([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(n,c,h){var b=n[0]instanceof Fe,I=n.length,z,te;if(b){for(te=[],z=0;z<I;z++)te[z]=this._map.latLngToLayerPoint(n[z]),h.extend(te[z]);c.push(te)}else for(z=0;z<I;z++)this._projectLatlngs(n[z],c,h)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,h,b,I,z,te,ke,xe;for(h=0,I=0,z=this._rings.length;h<z;h++)for(xe=this._rings[h],b=0,te=xe.length;b<te-1;b++)ke=Ji(xe[b],xe[b+1],n,b,!0),ke&&(c[I]=c[I]||[],c[I].push(ke[0]),(ke[1]!==xe[b+1]||b===te-2)&&(c[I].push(ke[1]),I++))}},_simplifyPoints:function(){for(var n=this._parts,c=this.options.smoothFactor,h=0,b=n.length;h<b;h++)n[h]=oo(n[h],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,c){var h,b,I,z,te,ke,xe=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(h=0,z=this._parts.length;h<z;h++)for(ke=this._parts[h],b=0,te=ke.length,I=te-1;b<te;I=b++)if(!(!c&&b===0)&&ea(n,ke[I],ke[b])<=xe)return!0;return!1}});function $c(n,c){return new Zo(n,c)}Zo._flat=Kl;var sa=Zo.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return en(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var c=Zo.prototype._convertLatLngs.call(this,n),h=c.length;return h>=2&&c[0]instanceof Fe&&c[0].equals(c[h-1])&&c.pop(),c},_setLatLngs:function(n){Zo.prototype._setLatLngs.call(this,n),so(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return so(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,c=this.options.weight,h=new U(c,c);if(n=new re(n.min.subtract(h),n.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var b=0,I=this._rings.length,z;b<I;b++)z=$t(this._rings[b],n,!0),z.length&&this._parts.push(z)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var c=!1,h,b,I,z,te,ke,xe,Ue;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(z=0,xe=this._parts.length;z<xe;z++)for(h=this._parts[z],te=0,Ue=h.length,ke=Ue-1;te<Ue;ke=te++)b=h[te],I=h[ke],b.y>n.y!=I.y>n.y&&n.x<(I.x-b.x)*(n.y-b.y)/(I.y-b.y)+b.x&&(c=!c);return c||Zo.prototype._containsPoint.call(this,n,!0)}});function Ql(n,c){return new sa(n,c)}var qo=jo.extend({initialize:function(n,c){w(this,c),this._layers={},n&&this.addData(n)},addData:function(n){var c=x(n)?n:n.features,h,b,I;if(c){for(h=0,b=c.length;h<b;h++)I=c[h],(I.geometries||I.geometry||I.features||I.coordinates)&&this.addData(I);return this}var z=this.options;if(z.filter&&!z.filter(n))return this;var te=Fa(n,z);return te?(te.feature=ki(n),te.defaultOptions=te.options,this.resetStyle(te),z.onEachFeature&&z.onEachFeature(n,te),this.addLayer(te)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=s({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(c){this._setLayerStyle(c,n)},this)},_setLayerStyle:function(n,c){n.setStyle&&(typeof c=="function"&&(c=c(n.feature)),n.setStyle(c))}});function Fa(n,c){var h=n.type==="Feature"?n.geometry:n,b=h?h.coordinates:null,I=[],z=c&&c.pointToLayer,te=c&&c.coordsToLatLng||el,ke,xe,Ue,nt;if(!b&&!h)return null;switch(h.type){case"Point":return ke=te(b),er(z,n,ke,c);case"MultiPoint":for(Ue=0,nt=b.length;Ue<nt;Ue++)ke=te(b[Ue]),I.push(er(z,n,ke,c));return new jo(I);case"LineString":case"MultiLineString":return xe=gi(b,h.type==="LineString"?0:1,te),new Zo(xe,c);case"Polygon":case"MultiPolygon":return xe=gi(b,h.type==="Polygon"?1:2,te),new sa(xe,c);case"GeometryCollection":for(Ue=0,nt=h.geometries.length;Ue<nt;Ue++){var ct=Fa({geometry:h.geometries[Ue],type:"Feature",properties:n.properties},c);ct&&I.push(ct)}return new jo(I);case"FeatureCollection":for(Ue=0,nt=h.features.length;Ue<nt;Ue++){var kt=Fa(h.features[Ue],c);kt&&I.push(kt)}return new jo(I);default:throw new Error("Invalid GeoJSON object.")}}function er(n,c,h,b){return n?n(c,h):new vi(h,b&&b.markersInheritOptions&&b)}function el(n){return new Fe(n[1],n[0],n[2])}function gi(n,c,h){for(var b=[],I=0,z=n.length,te;I<z;I++)te=c?gi(n[I],c-1,h):(h||el)(n[I]),b.push(te);return b}function Ua(n,c){return n=Ke(n),n.alt!==void 0?[y(n.lng,c),y(n.lat,c),y(n.alt,c)]:[y(n.lng,c),y(n.lat,c)]}function yi(n,c,h,b){for(var I=[],z=0,te=n.length;z<te;z++)I.push(c?yi(n[z],so(n[z])?0:c-1,h,b):Ua(n[z],b));return!c&&h&&I.length>0&&I.push(I[0].slice()),I}function aa(n,c){return n.feature?s({},n.feature,{geometry:c}):ki(c)}function ki(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var _i={toGeoJSON:function(n){return aa(this,{type:"Point",coordinates:Ua(this.getLatLng(),n)})}};vi.include(_i),Qi.include(_i),mi.include(_i),Zo.include({toGeoJSON:function(n){var c=!so(this._latlngs),h=yi(this._latlngs,c?1:0,!1,n);return aa(this,{type:(c?"Multi":"")+"LineString",coordinates:h})}}),sa.include({toGeoJSON:function(n){var c=!so(this._latlngs),h=c&&!so(this._latlngs[0]),b=yi(this._latlngs,h?2:c?1:0,!0,n);return c||(b=[b]),aa(this,{type:(h?"Multi":"")+"Polygon",coordinates:b})}}),na.include({toMultiPoint:function(n){var c=[];return this.eachLayer(function(h){c.push(h.toGeoJSON(n).geometry.coordinates)}),aa(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(n){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(n);var h=c==="GeometryCollection",b=[];return this.eachLayer(function(I){if(I.toGeoJSON){var z=I.toGeoJSON(n);if(h)b.push(z.geometry);else{var te=ki(z);te.type==="FeatureCollection"?b.push.apply(b,te.features):b.push(te)}}}),h?aa(this,{geometries:b,type:"GeometryCollection"}):{type:"FeatureCollection",features:b}}});function tr(n,c){return new qo(n,c)}var za=tr,Ha=yo.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,c,h){this._url=n,this._bounds=Je(c),w(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(dt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){xt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&fo(this._image),this},bringToBack:function(){return this._map&&zo(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=Je(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",c=this._image=n?this._url:pt("img");if(dt(c,"leaflet-image-layer"),this._zoomAnimated&&dt(c,"leaflet-zoom-animated"),this.options.className&&dt(c,this.options.className),c.onselectstart=g,c.onmousemove=g,c.onload=l(this.fire,this,"load"),c.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(n){var c=this._map.getZoomScale(n.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;po(this._image,h,c)},_reset:function(){var n=this._image,c=new re(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=c.getSize();Zt(n,c.min),n.style.width=h.x+"px",n.style.height=h.y+"px"},_updateOpacity:function(){yn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),nr=function(n,c,h){return new Ha(n,c,h)},tl=Ha.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",c=this._image=n?this._url:pt("video");if(dt(c,"leaflet-image-layer"),this._zoomAnimated&&dt(c,"leaflet-zoom-animated"),this.options.className&&dt(c,this.options.className),c.onselectstart=g,c.onmousemove=g,c.onloadeddata=l(this.fire,this,"load"),n){for(var h=c.getElementsByTagName("source"),b=[],I=0;I<h.length;I++)b.push(h[I].src);this._url=h.length>0?b:[c.src];return}x(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var z=0;z<this._url.length;z++){var te=pt("source");te.src=this._url[z],c.appendChild(te)}}});function H(n,c,h){return new tl(n,c,h)}var se=Ha.extend({_initImage:function(){var n=this._image=this._url;dt(n,"leaflet-image-layer"),this._zoomAnimated&&dt(n,"leaflet-zoom-animated"),this.options.className&&dt(n,this.options.className),n.onselectstart=g,n.onmousemove=g}});function ge(n,c,h){return new se(n,c,h)}var ye=yo.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,c){n&&(n instanceof Fe||x(n))?(this._latlng=Ke(n),w(this,c)):(w(this,n),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&yn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&yn(this._container,1),this.bringToFront(),this.options.interactive&&(dt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(yn(this._container,0),this._removeTimeout=setTimeout(l(xt,void 0,this._container),200)):xt(this._container),this.options.interactive&&(Ft(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=Ke(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&fo(this._container),this},bringToBack:function(){return this._map&&zo(this._container),this},_prepareOpen:function(n){var c=this._source;if(!c._map)return!1;if(c instanceof jo){c=null;var h=this._source._layers;for(var b in h)if(h[b]._map){c=h[b];break}if(!c)return!1;this._source=c}if(!n)if(c.getCenter)n=c.getCenter();else if(c.getLatLng)n=c.getLatLng();else if(c.getBounds)n=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")n.innerHTML=c;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),c=de(this.options.offset),h=this._getAnchor();this._zoomAnimated?Zt(this._container,n.add(h)):c=c.add(n).add(h);var b=this._containerBottom=-c.y,I=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=b+"px",this._container.style.left=I+"px"}},_getAnchor:function(){return[0,0]}});yt.include({_initOverlay:function(n,c,h,b){var I=c;return I instanceof n||(I=new n(b).setContent(c)),h&&I.setLatLng(h),I}}),yo.include({_initOverlay:function(n,c,h,b){var I=h;return I instanceof n?(w(I,b),I._source=this):(I=c&&!b?c:new n(b,this),I.setContent(h)),I}});var tt=ye.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,ye.prototype.openOn.call(this,n)},onAdd:function(n){ye.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof cs||this._source.on("preclick",go))},onRemove:function(n){ye.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof cs||this._source.off("preclick",go))},getEvents:function(){var n=ye.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",c=this._container=pt("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=pt("div",n+"-content-wrapper",c);if(this._contentNode=pt("div",n+"-content",h),is(c),Ea(this._contentNode),lt(c,"contextmenu",go),this._tipContainer=pt("div",n+"-tip-container",c),this._tip=pt("div",n+"-tip",this._tipContainer),this.options.closeButton){var b=this._closeButton=pt("a",n+"-close-button",c);b.setAttribute("role","button"),b.setAttribute("aria-label","Close popup"),b.href="#close",b.innerHTML='<span aria-hidden="true">&#215;</span>',lt(b,"click",function(I){Wt(I),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,c=n.style;c.width="",c.whiteSpace="nowrap";var h=n.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),c.width=h+1+"px",c.whiteSpace="",c.height="";var b=n.offsetHeight,I=this.options.maxHeight,z="leaflet-popup-scrolled";I&&b>I?(c.height=I+"px",dt(n,z)):Ft(n,z),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var c=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),h=this._getAnchor();Zt(this._container,c.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,c=parseInt(Gn(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+c,b=this._containerWidth,I=new U(this._containerLeft,-h-this._containerBottom);I._add(Vo(this._container));var z=n.layerPointToContainerPoint(I),te=de(this.options.autoPanPadding),ke=de(this.options.autoPanPaddingTopLeft||te),xe=de(this.options.autoPanPaddingBottomRight||te),Ue=n.getSize(),nt=0,ct=0;z.x+b+xe.x>Ue.x&&(nt=z.x+b-Ue.x+xe.x),z.x-nt-ke.x<0&&(nt=z.x-ke.x),z.y+h+xe.y>Ue.y&&(ct=z.y+h-Ue.y+xe.y),z.y-ct-ke.y<0&&(ct=z.y-ke.y),(nt||ct)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([nt,ct]))}},_getAnchor:function(){return de(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Lt=function(n,c){return new tt(n,c)};yt.mergeOptions({closePopupOnClick:!0}),yt.include({openPopup:function(n,c,h){return this._initOverlay(tt,n,c,h).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),yo.include({bindPopup:function(n,c){return this._popup=this._initOverlay(tt,this._popup,n,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof jo||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){Mo(n);var c=n.layer||n.target;if(this._popup._source===c&&!(c instanceof cs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=c,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var At=ye.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){ye.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){ye.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=ye.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",c=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=pt("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var c,h,b=this._map,I=this._container,z=b.latLngToContainerPoint(b.getCenter()),te=b.layerPointToContainerPoint(n),ke=this.options.direction,xe=I.offsetWidth,Ue=I.offsetHeight,nt=de(this.options.offset),ct=this._getAnchor();ke==="top"?(c=xe/2,h=Ue):ke==="bottom"?(c=xe/2,h=0):ke==="center"?(c=xe/2,h=Ue/2):ke==="right"?(c=0,h=Ue/2):ke==="left"?(c=xe,h=Ue/2):te.x<z.x?(ke="right",c=0,h=Ue/2):(ke="left",c=xe+(nt.x+ct.x)*2,h=Ue/2),n=n.subtract(de(c,h,!0)).add(nt).add(ct),Ft(I,"leaflet-tooltip-right"),Ft(I,"leaflet-tooltip-left"),Ft(I,"leaflet-tooltip-top"),Ft(I,"leaflet-tooltip-bottom"),dt(I,"leaflet-tooltip-"+ke),Zt(I,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&yn(this._container,n)},_animateZoom:function(n){var c=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(c)},_getAnchor:function(){return de(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),dn=function(n,c){return new At(n,c)};yt.include({openTooltip:function(n,c,h){return this._initOverlay(At,n,c,h).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),yo.include({bindTooltip:function(n,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(At,this._tooltip,n,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var c=n?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[c](h),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof jo||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var c=typeof n.getElement=="function"&&n.getElement();c&&(lt(c,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),lt(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var c=typeof n.getElement=="function"&&n.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var c=n.latlng,h,b;this._tooltip.options.sticky&&n.originalEvent&&(h=this._map.mouseEventToContainerPoint(n.originalEvent),b=this._map.containerPointToLayerPoint(h),c=this._map.layerPointToLatLng(b)),this._tooltip.setLatLng(c)}});var ia=oa.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var c=n&&n.tagName==="DIV"?n:document.createElement("div"),h=this.options;if(h.html instanceof Element?(To(c),c.appendChild(h.html)):c.innerHTML=h.html!==!1?h.html:"",h.bgPos){var b=de(h.bgPos);c.style.backgroundPosition=-b.x+"px "+-b.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function bi(n){return new ia(n)}oa.Default=Ls;var Ss=yo.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ge.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){w(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),xt(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(fo(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(zo(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof U?n:new U(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var c=this.getPane().children,h=-n(-1/0,1/0),b=0,I=c.length,z;b<I;b++)z=c[b].style.zIndex,c[b]!==this._container&&z&&(h=n(h,+z));isFinite(h)&&(this.options.zIndex=h+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ge.ielt9){yn(this._container,this.options.opacity);var n=+new Date,c=!1,h=!1;for(var b in this._tiles){var I=this._tiles[b];if(!(!I.current||!I.loaded)){var z=Math.min(1,(n-I.loaded)/200);yn(I.el,z),z<1?c=!0:(I.active?h=!0:this._onOpaqueTile(I),I.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),c&&(W(this._fadeFrame),this._fadeFrame=R(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=pt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,c=this.options.maxZoom;if(n!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===n?(this._levels[h].el.style.zIndex=c-Math.abs(n-h),this._onUpdateLevel(h)):(xt(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var b=this._levels[n],I=this._map;return b||(b=this._levels[n]={},b.el=pt("div","leaflet-tile-container leaflet-zoom-animated",this._container),b.el.style.zIndex=c,b.origin=I.project(I.unproject(I.getPixelOrigin()),n).round(),b.zoom=n,this._setZoomTransform(b,I.getCenter(),I.getZoom()),g(b.el.offsetWidth),this._onCreateLevel(b)),this._level=b,b}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var n,c,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)c=this._tiles[n],c.retain=c.current;for(n in this._tiles)if(c=this._tiles[n],c.current&&!c.active){var b=c.coords;this._retainParent(b.x,b.y,b.z,b.z-5)||this._retainChildren(b.x,b.y,b.z,b.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var c in this._tiles)this._tiles[c].coords.z===n&&this._removeTile(c)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)xt(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,c,h,b){var I=Math.floor(n/2),z=Math.floor(c/2),te=h-1,ke=new U(+I,+z);ke.z=+te;var xe=this._tileCoordsToKey(ke),Ue=this._tiles[xe];return Ue&&Ue.active?(Ue.retain=!0,!0):(Ue&&Ue.loaded&&(Ue.retain=!0),te>b?this._retainParent(I,z,te,b):!1)},_retainChildren:function(n,c,h,b){for(var I=2*n;I<2*n+2;I++)for(var z=2*c;z<2*c+2;z++){var te=new U(I,z);te.z=h+1;var ke=this._tileCoordsToKey(te),xe=this._tiles[ke];if(xe&&xe.active){xe.retain=!0;continue}else xe&&xe.loaded&&(xe.retain=!0);h+1<b&&this._retainChildren(I,z,h+1,b)}},_resetView:function(n){var c=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var c=this.options;return c.minNativeZoom!==void 0&&n<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<n?c.maxNativeZoom:n},_setView:function(n,c,h,b){var I=Math.round(c);this.options.maxZoom!==void 0&&I>this.options.maxZoom||this.options.minZoom!==void 0&&I<this.options.minZoom?I=void 0:I=this._clampZoom(I);var z=this.options.updateWhenZooming&&I!==this._tileZoom;(!b||z)&&(this._tileZoom=I,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),I!==void 0&&this._update(n),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(n,c)},_setZoomTransforms:function(n,c){for(var h in this._levels)this._setZoomTransform(this._levels[h],n,c)},_setZoomTransform:function(n,c,h){var b=this._map.getZoomScale(h,n.zoom),I=n.origin.multiplyBy(b).subtract(this._map._getNewPixelOrigin(c,h)).round();Ge.any3d?po(n.el,I,b):Zt(n.el,I)},_resetGrid:function(){var n=this._map,c=n.options.crs,h=this._tileSize=this.getTileSize(),b=this._tileZoom,I=this._map.getPixelWorldBounds(this._tileZoom);I&&(this._globalTileRange=this._pxBoundsToTileRange(I)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,c.wrapLng[0]],b).x/h.x),Math.ceil(n.project([0,c.wrapLng[1]],b).x/h.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([c.wrapLat[0],0],b).y/h.x),Math.ceil(n.project([c.wrapLat[1],0],b).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var c=this._map,h=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),b=c.getZoomScale(h,this._tileZoom),I=c.project(n,this._tileZoom).floor(),z=c.getSize().divideBy(b*2);return new re(I.subtract(z),I.add(z))},_update:function(n){var c=this._map;if(c){var h=this._clampZoom(c.getZoom());if(n===void 0&&(n=c.getCenter()),this._tileZoom!==void 0){var b=this._getTiledPixelBounds(n),I=this._pxBoundsToTileRange(b),z=I.getCenter(),te=[],ke=this.options.keepBuffer,xe=new re(I.getBottomLeft().subtract([ke,-ke]),I.getTopRight().add([ke,-ke]));if(!(isFinite(I.min.x)&&isFinite(I.min.y)&&isFinite(I.max.x)&&isFinite(I.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ue in this._tiles){var nt=this._tiles[Ue].coords;(nt.z!==this._tileZoom||!xe.contains(new U(nt.x,nt.y)))&&(this._tiles[Ue].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(n,h);return}for(var ct=I.min.y;ct<=I.max.y;ct++)for(var kt=I.min.x;kt<=I.max.x;kt++){var jn=new U(kt,ct);if(jn.z=this._tileZoom,!!this._isValidTile(jn)){var hn=this._tiles[this._tileCoordsToKey(jn)];hn?hn.current=!0:te.push(jn)}}if(te.sort(function(ao,wi){return ao.distanceTo(z)-wi.distanceTo(z)}),te.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Eo=document.createDocumentFragment();for(kt=0;kt<te.length;kt++)this._addTile(te[kt],Eo);this._level.el.appendChild(Eo)}}}},_isValidTile:function(n){var c=this._map.options.crs;if(!c.infinite){var h=this._globalTileRange;if(!c.wrapLng&&(n.x<h.min.x||n.x>h.max.x)||!c.wrapLat&&(n.y<h.min.y||n.y>h.max.y))return!1}if(!this.options.bounds)return!0;var b=this._tileCoordsToBounds(n);return Je(this.options.bounds).overlaps(b)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var c=this._map,h=this.getTileSize(),b=n.scaleBy(h),I=b.add(h),z=c.unproject(b,n.z),te=c.unproject(I,n.z);return[z,te]},_tileCoordsToBounds:function(n){var c=this._tileCoordsToNwSe(n),h=new et(c[0],c[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var c=n.split(":"),h=new U(+c[0],+c[1]);return h.z=+c[2],h},_removeTile:function(n){var c=this._tiles[n];c&&(xt(c.el),delete this._tiles[n],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){dt(n,"leaflet-tile");var c=this.getTileSize();n.style.width=c.x+"px",n.style.height=c.y+"px",n.onselectstart=g,n.onmousemove=g,Ge.ielt9&&this.options.opacity<1&&yn(n,this.options.opacity)},_addTile:function(n,c){var h=this._getTilePos(n),b=this._tileCoordsToKey(n),I=this.createTile(this._wrapCoords(n),l(this._tileReady,this,n));this._initTile(I),this.createTile.length<2&&R(l(this._tileReady,this,n,null,I)),Zt(I,h),this._tiles[b]={el:I,coords:n,current:!0},c.appendChild(I),this.fire("tileloadstart",{tile:I,coords:n})},_tileReady:function(n,c,h){c&&this.fire("tileerror",{error:c,tile:h,coords:n});var b=this._tileCoordsToKey(n);h=this._tiles[b],h&&(h.loaded=+new Date,this._map._fadeAnimated?(yn(h.el,0),W(this._fadeFrame),this._fadeFrame=R(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),c||(dt(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ge.ielt9||!this._map._fadeAnimated?R(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var c=new U(this._wrapX?p(n.x,this._wrapX):n.x,this._wrapY?p(n.y,this._wrapY):n.y);return c.z=n.z,c},_pxBoundsToTileRange:function(n){var c=this.getTileSize();return new re(n.min.unscaleBy(c).floor(),n.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function la(n){return new Ss(n)}var Ln=Ss.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,c){this._url=n,c=w(this,c),c.detectRetina&&Ge.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,c){return this._url===n&&c===void 0&&(c=!0),this._url=n,c||this.redraw(),this},createTile:function(n,c){var h=document.createElement("img");return lt(h,"load",l(this._tileOnLoad,this,c,h)),lt(h,"error",l(this._tileOnError,this,c,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(n),h},getTileUrl:function(n){var c={r:Ge.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-n.y;this.options.tms&&(c.y=h),c["-y"]=h}return T(this._url,s(c,this.options))},_tileOnLoad:function(n,c){Ge.ielt9?setTimeout(l(n,this,null,c),0):n(null,c)},_tileOnError:function(n,c,h){var b=this.options.errorTileUrl;b&&c.getAttribute("src")!==b&&(c.src=b),n(h,c)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,c=this.options.maxZoom,h=this.options.zoomReverse,b=this.options.zoomOffset;return h&&(n=c-n),n+b},_getSubdomain:function(n){var c=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var n,c;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(c=this._tiles[n].el,c.onload=g,c.onerror=g,!c.complete)){c.src=O;var h=this._tiles[n].coords;xt(c),delete this._tiles[n],this.fire("tileabort",{tile:c,coords:h})}},_removeTile:function(n){var c=this._tiles[n];if(c)return c.el.setAttribute("src",O),Ss.prototype._removeTile.call(this,n)},_tileReady:function(n,c,h){if(!(!this._map||h&&h.getAttribute("src")===O))return Ss.prototype._tileReady.call(this,n,c,h)}});function ud(n,c){return new Ln(n,c)}var dd=Ln.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,c){this._url=n;var h=s({},this.defaultWmsParams);for(var b in c)b in this.options||(h[b]=c[b]);c=w(this,c);var I=c.detectRetina&&Ge.retina?2:1,z=this.getTileSize();h.width=z.x*I,h.height=z.y*I,this.wmsParams=h},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,Ln.prototype.onAdd.call(this,n)},getTileUrl:function(n){var c=this._tileCoordsToNwSe(n),h=this._crs,b=De(h.project(c[0]),h.project(c[1])),I=b.min,z=b.max,te=(this._wmsVersion>=1.3&&this._crs===Yl?[I.y,I.x,z.y,z.x]:[I.x,I.y,z.x,z.y]).join(","),ke=Ln.prototype.getTileUrl.call(this,n);return ke+S(this.wmsParams,ke,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+te},setParams:function(n,c){return s(this.wmsParams,n),c||this.redraw(),this}});function om(n,c){return new dd(n,c)}Ln.WMS=dd,ud.wms=om;var xs=yo.extend({options:{padding:.1},initialize:function(n){w(this,n),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),dt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,c){var h=this._map.getZoomScale(c,this._zoom),b=this._map.getSize().multiplyBy(.5+this.options.padding),I=this._map.project(this._center,c),z=b.multiplyBy(-h).add(I).subtract(this._map._getNewPixelOrigin(n,c));Ge.any3d?po(this._container,z,h):Zt(this._container,z)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,c=this._map.getSize(),h=this._map.containerPointToLayerPoint(c.multiplyBy(-n)).round();this._bounds=new re(h,h.add(c.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),hd=xs.extend({options:{tolerance:0},getEvents:function(){var n=xs.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){xs.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");lt(n,"mousemove",this._onMouseMove,this),lt(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),lt(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){W(this._redrawRequest),delete this._ctx,xt(this._container),It(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var c in this._layers)n=this._layers[c],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){xs.prototype._update.call(this);var n=this._bounds,c=this._container,h=n.getSize(),b=Ge.retina?2:1;Zt(c,n.min),c.width=b*h.x,c.height=b*h.y,c.style.width=h.x+"px",c.style.height=h.y+"px",Ge.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){xs.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[d(n)]=n;var c=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var c=n._order,h=c.next,b=c.prev;h?h.prev=b:this._drawLast=b,b?b.next=h:this._drawFirst=h,delete n._order,delete this._layers[d(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var c=n.options.dashArray.split(/[, ]+/),h=[],b,I;for(I=0;I<c.length;I++){if(b=Number(c[I]),isNaN(b))return;h.push(b)}n.options._dashArray=h}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||R(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var c=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new re,this._redrawBounds.extend(n._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(n._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var c=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,c=this._redrawBounds;if(this._ctx.save(),c){var h=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var b=this._drawFirst;b;b=b.next)n=b.layer,(!c||n._pxBounds&&n._pxBounds.intersects(c))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,c){if(this._drawing){var h,b,I,z,te=n._parts,ke=te.length,xe=this._ctx;if(ke){for(xe.beginPath(),h=0;h<ke;h++){for(b=0,I=te[h].length;b<I;b++)z=te[h][b],xe[b?"lineTo":"moveTo"](z.x,z.y);c&&xe.closePath()}this._fillStroke(xe,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var c=n._point,h=this._ctx,b=Math.max(Math.round(n._radius),1),I=(Math.max(Math.round(n._radiusY),1)||b)/b;I!==1&&(h.save(),h.scale(1,I)),h.beginPath(),h.arc(c.x,c.y/I,b,0,Math.PI*2,!1),I!==1&&h.restore(),this._fillStroke(h,n)}},_fillStroke:function(n,c){var h=c.options;h.fill&&(n.globalAlpha=h.fillOpacity,n.fillStyle=h.fillColor||h.color,n.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(n.setLineDash&&n.setLineDash(c.options&&c.options._dashArray||[]),n.globalAlpha=h.opacity,n.lineWidth=h.weight,n.strokeStyle=h.color,n.lineCap=h.lineCap,n.lineJoin=h.lineJoin,n.stroke())},_onClick:function(n){for(var c=this._map.mouseEventToLayerPoint(n),h,b,I=this._drawFirst;I;I=I.next)h=I.layer,h.options.interactive&&h._containsPoint(c)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(h))&&(b=h);this._fireEvent(b?[b]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,c)}},_handleMouseOut:function(n){var c=this._hoveredLayer;c&&(Ft(this._container,"leaflet-interactive"),this._fireEvent([c],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,c){if(!this._mouseHoverThrottled){for(var h,b,I=this._drawFirst;I;I=I.next)h=I.layer,h.options.interactive&&h._containsPoint(c)&&(b=h);b!==this._hoveredLayer&&(this._handleMouseOut(n),b&&(dt(this._container,"leaflet-interactive"),this._fireEvent([b],n,"mouseover"),this._hoveredLayer=b)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,c,h){this._map._fireDOMEvent(c,h||c.type,n)},_bringToFront:function(n){var c=n._order;if(c){var h=c.next,b=c.prev;if(h)h.prev=b;else return;b?b.next=h:h&&(this._drawFirst=h),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(n)}},_bringToBack:function(n){var c=n._order;if(c){var h=c.next,b=c.prev;if(b)b.next=h;else return;h?h.prev=b:b&&(this._drawLast=b),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(n)}}});function fd(n){return Ge.canvas?new hd(n):null}var nl=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),sm={_initContainer:function(){this._container=pt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(xs.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var c=n._container=nl("shape");dt(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",n._path=nl("path"),c.appendChild(n._path),this._updateStyle(n),this._layers[d(n)]=n},_addPath:function(n){var c=n._container;this._container.appendChild(c),n.options.interactive&&n.addInteractiveTarget(c)},_removePath:function(n){var c=n._container;xt(c),n.removeInteractiveTarget(c),delete this._layers[d(n)]},_updateStyle:function(n){var c=n._stroke,h=n._fill,b=n.options,I=n._container;I.stroked=!!b.stroke,I.filled=!!b.fill,b.stroke?(c||(c=n._stroke=nl("stroke")),I.appendChild(c),c.weight=b.weight+"px",c.color=b.color,c.opacity=b.opacity,b.dashArray?c.dashStyle=x(b.dashArray)?b.dashArray.join(" "):b.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=b.lineCap.replace("butt","flat"),c.joinstyle=b.lineJoin):c&&(I.removeChild(c),n._stroke=null),b.fill?(h||(h=n._fill=nl("fill")),I.appendChild(h),h.color=b.fillColor||b.color,h.opacity=b.fillOpacity):h&&(I.removeChild(h),n._fill=null)},_updateCircle:function(n){var c=n._point.round(),h=Math.round(n._radius),b=Math.round(n._radiusY||h);this._setPath(n,n._empty()?"M0 0":"AL "+c.x+","+c.y+" "+h+","+b+" 0,"+65535*360)},_setPath:function(n,c){n._path.v=c},_bringToFront:function(n){fo(n._container)},_bringToBack:function(n){zo(n._container)}},or=Ge.vml?nl:we,ol=xs.extend({_initContainer:function(){this._container=or("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=or("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){xt(this._container),It(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){xs.prototype._update.call(this);var n=this._bounds,c=n.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,h.setAttribute("width",c.x),h.setAttribute("height",c.y)),Zt(h,n.min),h.setAttribute("viewBox",[n.min.x,n.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(n){var c=n._path=or("path");n.options.className&&dt(c,n.options.className),n.options.interactive&&dt(c,"leaflet-interactive"),this._updateStyle(n),this._layers[d(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){xt(n._path),n.removeInteractiveTarget(n._path),delete this._layers[d(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var c=n._path,h=n.options;c&&(h.stroke?(c.setAttribute("stroke",h.color),c.setAttribute("stroke-opacity",h.opacity),c.setAttribute("stroke-width",h.weight),c.setAttribute("stroke-linecap",h.lineCap),c.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?c.setAttribute("stroke-dasharray",h.dashArray):c.removeAttribute("stroke-dasharray"),h.dashOffset?c.setAttribute("stroke-dashoffset",h.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),h.fill?(c.setAttribute("fill",h.fillColor||h.color),c.setAttribute("fill-opacity",h.fillOpacity),c.setAttribute("fill-rule",h.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(n,c){this._setPath(n,Y(n._parts,c))},_updateCircle:function(n){var c=n._point,h=Math.max(Math.round(n._radius),1),b=Math.max(Math.round(n._radiusY),1)||h,I="a"+h+","+b+" 0 1,0 ",z=n._empty()?"M0 0":"M"+(c.x-h)+","+c.y+I+h*2+",0 "+I+-h*2+",0 ";this._setPath(n,z)},_setPath:function(n,c){n._path.setAttribute("d",c)},_bringToFront:function(n){fo(n._path)},_bringToBack:function(n){zo(n._path)}});Ge.vml&&ol.include(sm);function pd(n){return Ge.svg||Ge.vml?new ol(n):null}yt.include({getRenderer:function(n){var c=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var c=this._paneRenderers[n];return c===void 0&&(c=this._createRenderer({pane:n}),this._paneRenderers[n]=c),c},_createRenderer:function(n){return this.options.preferCanvas&&fd(n)||pd(n)}});var vd=sa.extend({initialize:function(n,c){sa.prototype.initialize.call(this,this._boundsToLatLngs(n),c)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=Je(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function am(n,c){return new vd(n,c)}ol.create=or,ol.pointsToPath=Y,qo.geometryToLayer=Fa,qo.coordsToLatLng=el,qo.coordsToLatLngs=gi,qo.latLngToCoords=Ua,qo.latLngsToCoords=yi,qo.getFeature=aa,qo.asFeature=ki,yt.mergeOptions({boxZoom:!0});var md=Xt.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){lt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){It(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){xt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),kn(),Ma(),this._startPoint=this._map.mouseEventToContainerPoint(n),lt(document,{contextmenu:Mo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=pt("div","leaflet-zoom-box",this._container),dt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var c=new re(this._point,this._startPoint),h=c.getSize();Zt(this._box,c.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(xt(this._box),Ft(this._container,"leaflet-crosshair")),Tn(),Ut(),It(document,{contextmenu:Mo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var c=new et(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});yt.addInitHook("addHandler","boxZoom",md),yt.mergeOptions({doubleClickZoom:!0});var gd=Xt.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var c=this._map,h=c.getZoom(),b=c.options.zoomDelta,I=n.originalEvent.shiftKey?h-b:h+b;c.options.doubleClickZoom==="center"?c.setZoom(I):c.setZoomAround(n.containerPoint,I)}});yt.addInitHook("addHandler","doubleClickZoom",gd),yt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var yd=Xt.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new Qt(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}dt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Ft(this._map._container,"leaflet-grab"),Ft(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=Je(this._map.options.maxBounds);this._offsetLimit=De(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var c=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(c),this._prunePositions(c)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,c){return n-(n-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;n.x<c.min.x&&(n.x=this._viscousLimit(n.x,c.min.x)),n.y<c.min.y&&(n.y=this._viscousLimit(n.y,c.min.y)),n.x>c.max.x&&(n.x=this._viscousLimit(n.x,c.max.x)),n.y>c.max.y&&(n.y=this._viscousLimit(n.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,c=Math.round(n/2),h=this._initialWorldOffset,b=this._draggable._newPos.x,I=(b-c+h)%n+c-h,z=(b+c+h)%n-c-h,te=Math.abs(I+h)<Math.abs(z+h)?I:z;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=te},_onDragEnd:function(n){var c=this._map,h=c.options,b=!h.inertia||n.noInertia||this._times.length<2;if(c.fire("dragend",n),b)c.fire("moveend");else{this._prunePositions(+new Date);var I=this._lastPos.subtract(this._positions[0]),z=(this._lastTime-this._times[0])/1e3,te=h.easeLinearity,ke=I.multiplyBy(te/z),xe=ke.distanceTo([0,0]),Ue=Math.min(h.inertiaMaxSpeed,xe),nt=ke.multiplyBy(Ue/xe),ct=Ue/(h.inertiaDeceleration*te),kt=nt.multiplyBy(-ct/2).round();!kt.x&&!kt.y?c.fire("moveend"):(kt=c._limitOffset(kt,c.options.maxBounds),R(function(){c.panBy(kt,{duration:ct,easeLinearity:te,noMoveStart:!0,animate:!0})}))}}});yt.addInitHook("addHandler","dragging",yd),yt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var kd=Xt.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),lt(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),It(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,c=document.documentElement,h=n.scrollTop||c.scrollTop,b=n.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(b,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var c=this._panKeys={},h=this.keyCodes,b,I;for(b=0,I=h.left.length;b<I;b++)c[h.left[b]]=[-1*n,0];for(b=0,I=h.right.length;b<I;b++)c[h.right[b]]=[n,0];for(b=0,I=h.down.length;b<I;b++)c[h.down[b]]=[0,n];for(b=0,I=h.up.length;b<I;b++)c[h.up[b]]=[0,-1*n]},_setZoomDelta:function(n){var c=this._zoomKeys={},h=this.keyCodes,b,I;for(b=0,I=h.zoomIn.length;b<I;b++)c[h.zoomIn[b]]=n;for(b=0,I=h.zoomOut.length;b<I;b++)c[h.zoomOut[b]]=-n},_addHooks:function(){lt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){It(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var c=n.keyCode,h=this._map,b;if(c in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(b=this._panKeys[c],n.shiftKey&&(b=de(b).multiplyBy(3)),h.options.maxBounds&&(b=h._limitOffset(de(b),h.options.maxBounds)),h.options.worldCopyJump){var I=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(b)));h.panTo(I)}else h.panBy(b)}else if(c in this._zoomKeys)h.setZoom(h.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;Mo(n)}}});yt.addInitHook("addHandler","keyboard",kd),yt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var _d=Xt.extend({addHooks:function(){lt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){It(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var c=Pa(n),h=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var b=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),b),Mo(n)},_performZoom:function(){var n=this._map,c=n.getZoom(),h=this._map.options.zoomSnap||0;n._stop();var b=this._delta/(this._map.options.wheelPxPerZoomLevel*4),I=4*Math.log(2/(1+Math.exp(-Math.abs(b))))/Math.LN2,z=h?Math.ceil(I/h)*h:I,te=n._limitZoom(c+(this._delta>0?z:-z))-c;this._delta=0,this._startTime=null,te&&(n.options.scrollWheelZoom==="center"?n.setZoom(c+te):n.setZoomAround(this._lastMousePos,c+te))}});yt.addInitHook("addHandler","scrollWheelZoom",_d);var im=600;yt.mergeOptions({tapHold:Ge.touchNative&&Ge.safari&&Ge.mobile,tapTolerance:15});var bd=Xt.extend({addHooks:function(){lt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){It(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var c=n.touches[0];this._startPos=this._newPos=new U(c.clientX,c.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(lt(document,"touchend",Wt),lt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),im),lt(document,"touchend touchcancel contextmenu",this._cancel,this),lt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){It(document,"touchend",Wt),It(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),It(document,"touchend touchcancel contextmenu",this._cancel,this),It(document,"touchmove",this._onMove,this)},_onMove:function(n){var c=n.touches[0];this._newPos=new U(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,c){var h=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});h._simulated=!0,c.target.dispatchEvent(h)}});yt.addInitHook("addHandler","tapHold",bd),yt.mergeOptions({touchZoom:Ge.touch,bounceAtZoomLimits:!0});var wd=Xt.extend({addHooks:function(){dt(this._map._container,"leaflet-touch-zoom"),lt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Ft(this._map._container,"leaflet-touch-zoom"),It(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var c=this._map;if(!(!n.touches||n.touches.length!==2||c._animatingZoom||this._zooming)){var h=c.mouseEventToContainerPoint(n.touches[0]),b=c.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(h.add(b)._divideBy(2))),this._startDist=h.distanceTo(b),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),lt(document,"touchmove",this._onTouchMove,this),lt(document,"touchend touchcancel",this._onTouchEnd,this),Wt(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var c=this._map,h=c.mouseEventToContainerPoint(n.touches[0]),b=c.mouseEventToContainerPoint(n.touches[1]),I=h.distanceTo(b)/this._startDist;if(this._zoom=c.getScaleZoom(I,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&I<1||this._zoom>c.getMaxZoom()&&I>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,I===1)return}else{var z=h._add(b)._divideBy(2)._subtract(this._centerPoint);if(I===1&&z.x===0&&z.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(z),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),W(this._animRequest);var te=l(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=R(te,this,!0),Wt(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,W(this._animRequest),It(document,"touchmove",this._onTouchMove,this),It(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});yt.addInitHook("addHandler","touchZoom",wd),yt.BoxZoom=md,yt.DoubleClickZoom=gd,yt.Drag=yd,yt.Keyboard=kd,yt.ScrollWheelZoom=_d,yt.TapHold=bd,yt.TouchZoom=wd,o.Bounds=re,o.Browser=Ge,o.CRS=_e,o.Canvas=hd,o.Circle=Qi,o.CircleMarker=mi,o.Class=ue,o.Control=wn,o.DivIcon=ia,o.DivOverlay=ye,o.DomEvent=Da,o.DomUtil=Go,o.Draggable=Qt,o.Evented=he,o.FeatureGroup=jo,o.GeoJSON=qo,o.GridLayer=Ss,o.Handler=Xt,o.Icon=oa,o.ImageOverlay=Ha,o.LatLng=Fe,o.LatLngBounds=et,o.Layer=yo,o.LayerGroup=na,o.LineUtil=bc,o.Map=yt,o.Marker=vi,o.Mixin=An,o.Path=cs,o.Point=U,o.PolyUtil=Ao,o.Polygon=sa,o.Polyline=Zo,o.Popup=tt,o.PosAnimation=Ra,o.Projection=wc,o.Rectangle=vd,o.Renderer=xs,o.SVG=ol,o.SVGOverlay=se,o.TileLayer=Ln,o.Tooltip=At,o.Transformation=Pe,o.Util=ne,o.VideoOverlay=tl,o.bind=l,o.bounds=De,o.canvas=fd,o.circle=Ic,o.circleMarker=xc,o.control=ls,o.divIcon=bi,o.extend=s,o.featureGroup=fi,o.geoJSON=tr,o.geoJson=za,o.gridLayer=la,o.icon=Xl,o.imageOverlay=nr,o.latLng=Ke,o.latLngBounds=Je,o.layerGroup=hi,o.map=Wi,o.marker=Sc,o.point=de,o.polygon=Ql,o.polyline=$c,o.popup=Lt,o.rectangle=am,o.setOptions=w,o.stamp=d,o.svg=pd,o.svgOverlay=ge,o.tileLayer=ud,o.tooltip=dn,o.transformation=q,o.version=a,o.videoOverlay=H;var lm=window.L;o.noConflict=function(){return window.L=lm,this},window.L=o}))})(hl,hl.exports)),hl.exports}var Fb=Nb();const tn=Ob(Fb);(function(e,t,o){function a(s,i){for(;(s=s.parentElement)&&!s.classList.contains(i););return s}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(s,i){this._map=s,this._container=s._container,this._overlayPane=s._panes.overlayPane,this._popupPane=s._panes.popupPane,i&&i.shapeOptions&&(i.shapeOptions=L.Util.extend({},this.options.shapeOptions,i.shapeOptions)),L.setOptions(this,i);var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(L.DomUtil.disableTextSelection(),s.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(s){L.setOptions(this,s)},_fireCreatedEvent:function(s){this._map.fire(L.Draw.Event.CREATED,{layer:s,layerType:this.type})},_cancelDrawing:function(s){s.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(s,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,s,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var s=this._markers.pop(),i=this._poly,l=i.getLatLngs(),u=l.splice(-1,1)[0];this._poly.setLatLngs(l),this._markerGroup.removeLayer(s),i.getLatLngs().length<2&&this._map.removeLayer(i),this._vertexChanged(u,!1)}},addVertex:function(s){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(s))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(s)),this._poly.addLatLng(s),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(s,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var s=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),i=this._poly.newLatLngIntersects(s[s.length-1]);if(!this.options.allowIntersection&&i||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(s){var i=this._map.mouseEventToLayerPoint(s.originalEvent),l=this._map.layerPointToLatLng(i);this._currentLatLng=l,this._updateTooltip(l),this._updateGuide(i),this._mouseMarker.setLatLng(l),L.DomEvent.preventDefault(s.originalEvent)},_vertexChanged:function(s,i){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(s,i),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(s){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(s),this._clickHandled=!0,this._disableNewMarkers();var i=s.originalEvent,l=i.clientX,u=i.clientY;this._startPoint.call(this,l,u)}},_startPoint:function(s,i){this._mouseDownOrigin=L.point(s,i)},_onMouseUp:function(s){var i=s.originalEvent,l=i.clientX,u=i.clientY;this._endPoint.call(this,l,u,s),this._clickHandled=null},_endPoint:function(s,i,l){if(this._mouseDownOrigin){var u=L.point(s,i).distanceTo(this._mouseDownOrigin),d=this._calculateFinishDistance(l.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(l.latlng),this._finishShape()):d<10&&L.Browser.touch?this._finishShape():Math.abs(u)<9*(e.devicePixelRatio||1)&&this.addVertex(l.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(s){var i,l,u=s.originalEvent;!u.touches||!u.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(i=u.touches[0].clientX,l=u.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,i,l),this._endPoint.call(this,i,l,s),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(s){var i;if(this._markers.length>0){var l;if(this.type===L.Draw.Polyline.TYPE)l=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;l=this._markers[0]}var u=this._map.latLngToContainerPoint(l.getLatLng()),d=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),f=this._map.latLngToContainerPoint(d.getLatLng());i=u.distanceTo(f)}else i=1/0;return i},_updateFinishHandler:function(){var s=this._markers.length;s>1&&this._markers[s-1].on("click",this._finishShape,this),s>2&&this._markers[s-2].off("click",this._finishShape,this)},_createMarker:function(s){var i=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(i),i},_updateGuide:function(s){var i=this._markers?this._markers.length:0;i>0&&(s=s||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[i-1].getLatLng()),s))},_updateTooltip:function(s){var i=this._getTooltipText();s&&this._tooltip.updatePosition(s),this._errorShown||this._tooltip.updateContent(i)},_drawGuide:function(s,i){var l,u,d,f=Math.floor(Math.sqrt(Math.pow(i.x-s.x,2)+Math.pow(i.y-s.y,2))),p=this.options.guidelineDistance,g=this.options.maxGuideLineLength,y=f>g?f-g:p;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));y<f;y+=this.options.guidelineDistance)l=y/f,u={x:Math.floor(s.x*(1-l)+l*i.x),y:Math.floor(s.y*(1-l)+l*i.y)},d=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),d.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(d,u)},_updateGuideColor:function(s){if(this._guidesContainer)for(var i=0,l=this._guidesContainer.childNodes.length;i<l;i++)this._guidesContainer.childNodes[i].style.backgroundColor=s},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var s,i,l=this.options.showLength;return this._markers.length===0?s={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(i=l?this._getMeasurementString():"",s=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:i}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:i}),s},_updateRunningMeasure:function(s,i){var l,u,d=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(l=d-(i?2:1),u=L.GeometryUtil.isVersion07x()?s.distanceTo(this._markers[l].getLatLng())*(this.options.factor||1):this._map.distance(s,this._markers[l].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=u*(i?1:-1))},_getMeasurementString:function(){var s,i=this._currentLatLng,l=this._markers[this._markers.length-1].getLatLng();return s=L.GeometryUtil.isVersion07x()?l&&i&&i.distanceTo?this._measurementRunningTotal+i.distanceTo(l)*(this.options.factor||1):this._measurementRunningTotal||0:l&&i?this._measurementRunningTotal+this._map.distance(i,l)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(s,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var s=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(s,i){L.Draw.Polyline.prototype.initialize.call(this,s,i),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var s=this._markers.length;s===1&&this._markers[0].on("click",this._finishShape,this),s>2&&(this._markers[s-1].on("dblclick",this._finishShape,this),s>3&&this._markers[s-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var s,i;return this._markers.length===0?s=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(s=L.drawLocal.draw.handlers.polygon.tooltip.cont,i=this._getMeasurementString()):(s=L.drawLocal.draw.handlers.polygon.tooltip.end,i=this._getMeasurementString()),{text:s,subtext:i}},_getMeasurementString:function(){var s=this._area,i="";return s||this.options.showLength?(this.options.showLength&&(i=L.Draw.Polyline.prototype._getMeasurementString.call(this)),s&&(i+="<br>"+L.GeometryUtil.readableArea(s,this.options.metric,this.options.precision)),i):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(s,i){var l;!this.options.allowIntersection&&this.options.showArea&&(l=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(l)),L.Draw.Polyline.prototype._vertexChanged.call(this,s,i)},_cleanUpShape:function(){var s=this._markers.length;s>0&&(this._markers[0].off("click",this._finishShape,this),s>2&&this._markers[s-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(s,i){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,s,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(s){this._isDrawing=!0,this._startLatLng=s.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(s.originalEvent)},_onMouseMove:function(s){var i=s.latlng;this._tooltip.updatePosition(i),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(i))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(s,i){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,i)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(s){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!a(s.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(s){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,s)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,s),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_getTooltipText:function(){var s,i,l,u=L.Draw.SimpleShape.prototype._getTooltipText.call(this),d=this._shape,f=this.options.showArea;return d&&(s=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),i=L.GeometryUtil.geodesicArea(s),l=f?L.GeometryUtil.readableArea(i,this.options.metric):""),{text:u.text,subtext:l}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(s,i){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(s){var i=s.latlng;this._tooltip.updatePosition(i),this._mouseMarker.setLatLng(i),this._marker?(i=this._mouseMarker.getLatLng(),this._marker.setLatLng(i)):(this._marker=this._createMarker(i),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(s){return new L.Marker(s,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(s){this._onMouseMove(s),this._onClick()},_fireCreatedEvent:function(){var s=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(s,i){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,i)},_fireCreatedEvent:function(){var s=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)},_createMarker:function(s){return new L.CircleMarker(s,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(s,i){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,i)},_drawShape:function(s){if(L.GeometryUtil.isVersion07x())var i=this._startLatLng.distanceTo(s);else var i=this._map.distance(this._startLatLng,s);this._shape?this._shape.setRadius(i):(this._shape=new L.Circle(this._startLatLng,i,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_onMouseMove:function(s){var i,l=s.latlng,u=this.options.showRadius,d=this.options.metric;if(this._tooltip.updatePosition(l),this._isDrawing){this._drawShape(l),i=this._shape.getRadius().toFixed(1);var f="";u&&(f=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(i,d,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:f})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(s,i){this._marker=s,L.setOptions(this,i)},addHooks:function(){var s=this._marker;s.dragging.enable(),s.on("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},removeHooks:function(){var s=this._marker;s.dragging.disable(),s.off("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},_onDragEnd:function(s){var i=s.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_toggleMarkerHighlight:function(){var s=this._marker._icon;s&&(s.style.display="none",L.DomUtil.hasClass(s,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,-4)):(L.DomUtil.addClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,4)),s.style.display="")},_offsetMarker:function(s,i){var l=parseInt(s.style.marginTop,10)-i,u=parseInt(s.style.marginLeft,10)-i;s.style.marginTop=l+"px",s.style.marginLeft=u+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(s){this.latlngs=[s._latlngs],s._holes&&(this.latlngs=this.latlngs.concat(s._holes)),this._poly=s,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(s){for(var i=0;i<this._verticesHandlers.length;i++)s(this._verticesHandlers[i])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(s){s.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(s){s.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(s){s.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var s=0;s<this.latlngs.length;s++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[s],this._poly.options.poly))},_updateLatLngs:function(s){this.latlngs=[s.layer._latlngs],s.layer._holes&&(this.latlngs=this.latlngs.concat(s.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(s,i,l){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=s,l&&l.drawError&&(l.drawError=L.Util.extend({},this.options.drawError,l.drawError)),this._latlngs=i,L.setOptions(this,l)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var s=this._poly,i=s._path;s instanceof L.Polygon||(s.options.fill=!1,s.options.editing&&(s.options.editing.fill=!1)),i&&s.options.editing&&s.options.editing.className&&(s.options.original.className&&s.options.original.className.split(" ").forEach(function(l){L.DomUtil.removeClass(i,l)}),s.options.editing.className.split(" ").forEach(function(l){L.DomUtil.addClass(i,l)})),s.setStyle(s.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var s=this._poly,i=s._path;i&&s.options.editing&&s.options.editing.className&&(s.options.editing.className.split(" ").forEach(function(l){L.DomUtil.removeClass(i,l)}),s.options.original.className&&s.options.original.className.split(" ").forEach(function(l){L.DomUtil.addClass(i,l)})),s.setStyle(s.options.original),s._map&&(s._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var s,i,l,u,d=this._defaultShape();for(s=0,l=d.length;s<l;s++)u=this._createMarker(d[s],s),u.on("click",this._onMarkerClick,this),u.on("contextmenu",this._onContextMenu,this),this._markers.push(u);var f,p;for(s=0,i=l-1;s<l;i=s++)(s!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(f=this._markers[i],p=this._markers[s],this._createMiddleMarker(f,p),this._updatePrevNext(f,p))},_createMarker:function(s,i){var l=new L.Marker.Touch(s,{draggable:!0,icon:this.options.icon});return l._origLatLng=s,l._index=i,l.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(l),l},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var s=this._defaultShape(),i=[].splice.apply(s,arguments);return this._poly._convertLatLngs(s,!0),this._poly.redraw(),i},_removeMarker:function(s){var i=s._index;this._markerGroup.removeLayer(s),this._markers.splice(i,1),this._spliceLatLngs(i,1),this._updateIndexes(i,-1),s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(s){var i=s.target,l=this._poly,u=L.LatLngUtil.cloneLatLng(i._origLatLng);if(L.extend(i._origLatLng,i._latlng),l.options.poly){var d=l._map._editTooltip;if(!l.options.poly.allowIntersection&&l.intersects()){L.extend(i._origLatLng,u),i.setLatLng(u);var f=l.options.color;l.setStyle({color:this.options.drawError.color}),d&&d.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){l.setStyle({color:f}),d&&d.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}i._middleLeft&&i._middleLeft.setLatLng(this._getMiddleLatLng(i._prev,i)),i._middleRight&&i._middleRight.setLatLng(this._getMiddleLatLng(i,i._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var p=this._poly.getLatLngs();this._poly._convertLatLngs(p,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(s){var i=L.Polygon&&this._poly instanceof L.Polygon?4:3,l=s.target;this._defaultShape().length<i||(this._removeMarker(l),this._updatePrevNext(l._prev,l._next),l._middleLeft&&this._markerGroup.removeLayer(l._middleLeft),l._middleRight&&this._markerGroup.removeLayer(l._middleRight),l._prev&&l._next?this._createMiddleMarker(l._prev,l._next):l._prev?l._next||(l._prev._middleRight=null):l._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(s){var i=s.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:i,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(s){var i=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),l=this._map.layerPointToLatLng(i),u=s.target;L.extend(u._origLatLng,l),u._middleLeft&&u._middleLeft.setLatLng(this._getMiddleLatLng(u._prev,u)),u._middleRight&&u._middleRight.setLatLng(this._getMiddleLatLng(u,u._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(s,i){this._markerGroup.eachLayer(function(l){l._index>s&&(l._index+=i)})},_createMiddleMarker:function(s,i){var l,u,d,f=this._getMiddleLatLng(s,i),p=this._createMarker(f);p.setOpacity(.6),s._middleRight=i._middleLeft=p,u=function(){p.off("touchmove",u,this);var g=i._index;p._index=g,p.off("click",l,this).on("click",this._onMarkerClick,this),f.lat=p.getLatLng().lat,f.lng=p.getLatLng().lng,this._spliceLatLngs(g,0,f),this._markers.splice(g,0,p),p.setOpacity(1),this._updateIndexes(g,1),i._index++,this._updatePrevNext(s,p),this._updatePrevNext(p,i),this._poly.fire("editstart")},d=function(){p.off("dragstart",u,this),p.off("dragend",d,this),p.off("touchmove",u,this),this._createMiddleMarker(s,p),this._createMiddleMarker(p,i)},l=function(){u.call(this),d.call(this),this._fireEdit()},p.on("click",l,this).on("dragstart",u,this).on("dragend",d,this).on("touchmove",u,this),this._markerGroup.addLayer(p)},_updatePrevNext:function(s,i){s&&(s._next=i),i&&(i._prev=s)},_getMiddleLatLng:function(s,i){var l=this._poly._map,u=l.project(s.getLatLng()),d=l.project(i.getLatLng());return l.unproject(u._add(d)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(s,i){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=s,L.Util.setOptions(this,i)},addHooks:function(){var s=this._shape;this._shape._map&&(this._map=this._shape._map,s.setStyle(s.options.editing),s._map&&(this._map=s._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var s=this._shape;if(s.setStyle(s.options.original),s._map){this._unbindMarker(this._moveMarker);for(var i=0,l=this._resizeMarkers.length;i<l;i++)this._unbindMarker(this._resizeMarkers[i]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(s,i){var l=new L.Marker.Touch(s,{draggable:!0,icon:i,zIndexOffset:10});return this._bindMarker(l),this._markerGroup.addLayer(l),l},_bindMarker:function(s){s.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(s){s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(s){s.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(s){var i=s.target,l=i.getLatLng();i===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(s){s.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(s){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s),typeof this._getCorners=="function"){var i=this._getCorners(),l=s.target,u=l._cornerIndex;l.setOpacity(0),this._oppositeCorner=i[(u+2)%4],this._toggleCornerMarkers(0,u)}this._shape.fire("editstart")},_onTouchMove:function(s){var i=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),l=this._map.layerPointToLatLng(i);return s.target===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),!1},_onTouchEnd:function(s){s.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getBounds(),i=s.getCenter();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){var s=this._getCorners();this._resizeMarkers=[];for(var i=0,l=s.length;i<l;i++)this._resizeMarkers.push(this._createMarker(s[i],this.options.resizeIcon)),this._resizeMarkers[i]._cornerIndex=i},_onMarkerDragStart:function(s){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s);var i=this._getCorners(),l=s.target,u=l._cornerIndex;this._oppositeCorner=i[(u+2)%4],this._toggleCornerMarkers(0,u)},_onMarkerDragEnd:function(s){var i,l,u=s.target;u===this._moveMarker&&(i=this._shape.getBounds(),l=i.getCenter(),u.setLatLng(l)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,s)},_move:function(s){for(var i,l=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),u=this._shape.getBounds(),d=u.getCenter(),f=[],p=0,g=l.length;p<g;p++)i=[l[p].lat-d.lat,l[p].lng-d.lng],f.push([s.lat+i[0],s.lng+i[1]]);this._shape.setLatLngs(f),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(s){var i;this._shape.setBounds(L.latLngBounds(s,this._oppositeCorner)),i=this._shape.getBounds(),this._moveMarker.setLatLng(i.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var s=this._shape.getBounds();return[s.getNorthWest(),s.getNorthEast(),s.getSouthEast(),s.getSouthWest()]},_toggleCornerMarkers:function(s){for(var i=0,l=this._resizeMarkers.length;i<l;i++)this._resizeMarkers[i].setOpacity(s)},_repositionCornerMarkers:function(){for(var s=this._getCorners(),i=0,l=this._resizeMarkers.length;i<l;i++)this._resizeMarkers[i].setLatLng(s[i])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getLatLng();this._moveMarker=this._createMarker(s,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(s){if(this._resizeMarkers.length){var i=this._getResizeMarkerPoint(s);this._resizeMarkers[0].setLatLng(i)}this._shape.setLatLng(s),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var s=this._shape.getLatLng(),i=this._getResizeMarkerPoint(s);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(i,this.options.resizeIcon))},_getResizeMarkerPoint:function(s){var i=this._shape._radius*Math.cos(Math.PI/4),l=this._map.project(s);return this._map.unproject([l.x+i,l.y-i])},_resize:function(s){var i=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=i.distanceTo(s):radius=this._map.distance(i,s),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(s,i){var l={};if(s.touches!==void 0){if(!s.touches.length)return;l=s.touches[0]}else if(s.pointerType!=="touch"||(l=s,!this._filterClick(s)))return;var u=this._map.mouseEventToContainerPoint(l),d=this._map.mouseEventToLayerPoint(l),f=this._map.layerPointToLatLng(d);this._map.fire(i,{latlng:f,layerPoint:d,containerPoint:u,pageX:l.pageX,pageY:l.pageY,originalEvent:s})},_filterClick:function(s){var i=s.timeStamp||s.originalEvent.timeStamp,l=L.DomEvent._lastClick&&i-L.DomEvent._lastClick;return l&&l>100&&l<500||s.target._simulatedClick&&!s._simulated?(L.DomEvent.stop(s),!1):(L.DomEvent._lastClick=i,!0)},_onTouchStart:function(s){this._map._loaded&&this._touchEvent(s,"touchstart")},_onTouchEnd:function(s){this._map._loaded&&this._touchEvent(s,"touchend")},_onTouchCancel:function(s){if(this._map._loaded){var i="touchcancel";this._detectIE()&&(i="pointercancel"),this._touchEvent(s,i)}},_onTouchLeave:function(s){this._map._loaded&&this._touchEvent(s,"touchleave")},_onTouchMove:function(s){this._map._loaded&&this._touchEvent(s,"touchmove")},_detectIE:function(){var s=e.navigator.userAgent,i=s.indexOf("MSIE ");if(i>0)return parseInt(s.substring(i+5,s.indexOf(".",i)),10);if(s.indexOf("Trident/")>0){var l=s.indexOf("rv:");return parseInt(s.substring(l+3,s.indexOf(".",l)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var s=this._icon,i=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?i.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):i.concat(["touchcancel"]),L.DomUtil.addClass(s,"leaflet-clickable"),L.DomEvent.on(s,"click",this._onMouseClick,this),L.DomEvent.on(s,"keypress",this._onKeyPress,this);for(var l=0;l<i.length;l++)L.DomEvent.on(s,i[l],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var s=e.navigator.userAgent,i=s.indexOf("MSIE ");if(i>0)return parseInt(s.substring(i+5,s.indexOf(".",i)),10);if(s.indexOf("Trident/")>0){var l=s.indexOf("rv:");return parseInt(s.substring(l+3,s.indexOf(".",l)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.LatLngUtil={cloneLatLngs:function(s){for(var i=[],l=0,u=s.length;l<u;l++)Array.isArray(s[l])?i.push(L.LatLngUtil.cloneLatLngs(s[l])):i.push(this.cloneLatLng(s[l]));return i},cloneLatLng:function(s){return L.latLng(s.lat,s.lng)}},(function(){var s={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(i){var l,u,d=i.length,f=0,p=Math.PI/180;if(d>2){for(var g=0;g<d;g++)l=i[g],u=i[(g+1)%d],f+=(u.lng-l.lng)*p*(2+Math.sin(l.lat*p)+Math.sin(u.lat*p));f=6378137*f*6378137/2}return Math.abs(f)},formattedNumber:function(i,l){var u=parseFloat(i).toFixed(l),d=L.drawLocal.format&&L.drawLocal.format.numeric,f=d&&d.delimiters,p=f&&f.thousands,g=f&&f.decimal;if(p||g){var y=u.split(".");u=p?y[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+p):y[0],g=g||".",y.length>1&&(u=u+g+y[1])}return u},readableArea:function(i,l,p){var d,f,p=L.Util.extend({},s,p);return l?(f=["ha","m"],type=typeof l,type==="string"?f=[l]:type!=="boolean"&&(f=l),d=i>=1e6&&f.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*i,p.km)+" km":i>=1e4&&f.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*i,p.ha)+" ha":L.GeometryUtil.formattedNumber(i,p.m)+" m"):(i/=.836127,d=i>=3097600?L.GeometryUtil.formattedNumber(i/3097600,p.mi)+" mi":i>=4840?L.GeometryUtil.formattedNumber(i/4840,p.ac)+" acres":L.GeometryUtil.formattedNumber(i,p.yd)+" yd"),d},readableDistance:function(i,l,u,d,g){var p,g=L.Util.extend({},s,g);switch(l?typeof l=="string"?l:"metric":u?"feet":d?"nauticalMile":"yards"){case"metric":p=i>1e3?L.GeometryUtil.formattedNumber(i/1e3,g.km)+" km":L.GeometryUtil.formattedNumber(i,g.m)+" m";break;case"feet":i*=3.28083,p=L.GeometryUtil.formattedNumber(i,g.ft)+" ft";break;case"nauticalMile":i*=.53996,p=L.GeometryUtil.formattedNumber(i/1e3,g.nm)+" nm";break;default:i*=1.09361,p=i>1760?L.GeometryUtil.formattedNumber(i/1760,g.mi)+" miles":L.GeometryUtil.formattedNumber(i,g.yd)+" yd"}return p},isVersion07x:function(){var i=L.version.split(".");return parseInt(i[0],10)===0&&parseInt(i[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(s,i,l,u){return this._checkCounterclockwise(s,l,u)!==this._checkCounterclockwise(i,l,u)&&this._checkCounterclockwise(s,i,l)!==this._checkCounterclockwise(s,i,u)},_checkCounterclockwise:function(s,i,l){return(l.y-s.y)*(i.x-s.x)>(i.y-s.y)*(l.x-s.x)}}),L.Polyline.include({intersects:function(){var s,i,l,u=this._getProjectedPoints(),d=u?u.length:0;if(this._tooFewPointsForIntersection())return!1;for(s=d-1;s>=3;s--)if(i=u[s-1],l=u[s],this._lineSegmentsIntersectsRange(i,l,s-2))return!0;return!1},newLatLngIntersects:function(s,i){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(s),i)},newPointIntersects:function(s,i){var l=this._getProjectedPoints(),u=l?l.length:0,d=l?l[u-1]:null,f=u-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(d,s,f,i?1:0)},_tooFewPointsForIntersection:function(s){var i=this._getProjectedPoints(),l=i?i.length:0;return l+=s||0,!i||l<=3},_lineSegmentsIntersectsRange:function(s,i,l,u){var d,f,p=this._getProjectedPoints();u=u||0;for(var g=l;g>u;g--)if(d=p[g-1],f=p[g],L.LineUtil.segmentsIntersect(s,i,d,f))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var s=[],i=this._defaultShape(),l=0;l<i.length;l++)s.push(this._map.latLngToLayerPoint(i[l]));return s}}),L.Polygon.include({intersects:function(){var s,i,l,u,d=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(s=d.length,i=d[0],l=d[s-1],u=s-2,this._lineSegmentsIntersectsRange(l,i,u,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(s){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,s);var i;this._toolbars={},L.DrawToolbar&&this.options.draw&&(i=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=i,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(i=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=i,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(s){var i,l=L.DomUtil.create("div","leaflet-draw"),u=!1;for(var d in this._toolbars)this._toolbars.hasOwnProperty(d)&&(i=this._toolbars[d].addToolbar(s))&&(u||(L.DomUtil.hasClass(i,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(i.childNodes[0],"leaflet-draw-toolbar-top"),u=!0),l.appendChild(i));return l},onRemove:function(){for(var s in this._toolbars)this._toolbars.hasOwnProperty(s)&&this._toolbars[s].removeToolbar()},setDrawingOptions:function(s){for(var i in this._toolbars)this._toolbars[i]instanceof L.DrawToolbar&&this._toolbars[i].setOptions(s)},_toolbarEnabled:function(s){var i=s.target;for(var l in this._toolbars)this._toolbars[l]!==i&&this._toolbars[l].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(s){L.setOptions(this,s),this._modes={},this._actionButtons=[],this._activeMode=null;var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(s){var i,l=L.DomUtil.create("div","leaflet-draw-section"),u=0,d=this._toolbarClass||"",f=this.getModeHandlers(s);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=s,i=0;i<f.length;i++)f[i].enabled&&this._initModeHandler(f[i].handler,this._toolbarContainer,u++,d,f[i].title);if(u)return this._lastButtonIndex=--u,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),l.appendChild(this._toolbarContainer),l.appendChild(this._actionsContainer),l},removeToolbar:function(){for(var s in this._modes)this._modes.hasOwnProperty(s)&&(this._disposeButton(this._modes[s].button,this._modes[s].handler.enable,this._modes[s].handler),this._modes[s].handler.disable(),this._modes[s].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var i=0,l=this._actionButtons.length;i<l;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(s,i,l,u,d){var f=s.type;this._modes[f]={},this._modes[f].handler=s,this._modes[f].button=this._createButton({type:f,title:d,className:u+"-"+f,container:i,callback:this._modes[f].handler.enable,context:this._modes[f].handler}),this._modes[f].buttonIndex=l,this._modes[f].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(s){var i=L.DomUtil.create("a",s.className||"",s.container),l=L.DomUtil.create("span","sr-only",s.container);i.href="#",i.appendChild(l),s.title&&(i.title=s.title,l.innerHTML=s.title),s.text&&(i.innerHTML=s.text,l.innerHTML=s.text);var u=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(i,"click",L.DomEvent.stopPropagation).on(i,"mousedown",L.DomEvent.stopPropagation).on(i,"dblclick",L.DomEvent.stopPropagation).on(i,"touchstart",L.DomEvent.stopPropagation).on(i,"click",L.DomEvent.preventDefault).on(i,u,s.callback,s.context),i},_disposeButton:function(s,i){var l=this._detectIOS()?"touchstart":"click";L.DomEvent.off(s,"click",L.DomEvent.stopPropagation).off(s,"mousedown",L.DomEvent.stopPropagation).off(s,"dblclick",L.DomEvent.stopPropagation).off(s,"touchstart",L.DomEvent.stopPropagation).off(s,"click",L.DomEvent.preventDefault).off(s,l,i)},_handlerActivated:function(s){this.disable(),this._activeMode=this._modes[s.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(s){var i,l,u,d,f=this._actionsContainer,p=this.getActions(s),g=p.length;for(l=0,u=this._actionButtons.length;l<u;l++)this._disposeButton(this._actionButtons[l].button,this._actionButtons[l].callback);for(this._actionButtons=[];f.firstChild;)f.removeChild(f.firstChild);for(var y=0;y<g;y++)"enabled"in p[y]&&!p[y].enabled||(i=L.DomUtil.create("li","",f),d=this._createButton({title:p[y].title,text:p[y].text,container:i,callback:p[y].callback,context:p[y].context}),this._actionButtons.push({button:d,callback:p[y].callback}))},_showActionsToolbar:function(){var s=this._activeMode.buttonIndex,i=this._lastButtonIndex,l=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=l+"px",s===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),s===i&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(s){this._map=s,this._popupPane=s._panes.popupPane,this._visible=!1,this._container=s.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(s){return this._container?(s.subtext=s.subtext||"",s.subtext.length!==0||this._singleLineLabel?s.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(s.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+s.subtext+"</span><br />":"")+"<span>"+s.text+"</span>",s.text||s.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(s){var i=this._map.latLngToLayerPoint(s),l=this._container;return this._container&&(this._visible&&(l.style.visibility="inherit"),L.DomUtil.setPosition(l,i)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(s){for(var i in this.options)this.options.hasOwnProperty(i)&&s[i]&&(s[i]=L.extend({},this.options[i],s[i]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,s)},getModeHandlers:function(s){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(s,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(s,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(s,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(s,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(s,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(s,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(s){return[{enabled:s.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:s.completeShape,context:s},{enabled:s.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:s.deleteLastVertex,context:s},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(s){L.setOptions(this,s);for(var i in this._modes)this._modes.hasOwnProperty(i)&&s.hasOwnProperty(i)&&this._modes[i].handler.setOptions(s[i])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(s){s.edit&&(s.edit.selectedPathOptions===void 0&&(s.edit.selectedPathOptions=this.options.edit.selectedPathOptions),s.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,s.edit.selectedPathOptions)),s.remove&&(s.remove=L.extend({},this.options.remove,s.remove)),s.poly&&(s.poly=L.extend({},this.options.poly,s.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,s),this._selectedFeatureCount=0},getModeHandlers:function(s){var i=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(s,{featureGroup:i,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(s,{featureGroup:i}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(s){var i=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return s.removeAllLayers&&i.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),i},addToolbar:function(s){var i=L.Toolbar.prototype.addToolbar.call(this,s);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),i},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var s,i=this.options.featureGroup,l=i.getLayers().length!==0;this.options.edit&&(s=this._modes[L.EditToolbar.Edit.TYPE].button,l?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(s=this._modes[L.EditToolbar.Delete.TYPE].button,l?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(s,i){if(L.Handler.prototype.initialize.call(this,s),L.setOptions(this,i),this._featureGroup=i.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),s._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(s){this._revertLayer(s)},this)},save:function(){var s=new L.LayerGroup;this._featureGroup.eachLayer(function(i){i.edited&&(s.addLayer(i),i.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:s})},_backupLayer:function(s){var i=L.Util.stamp(s);this._uneditedLayerProps[i]||(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?this._uneditedLayerProps[i]={latlngs:L.LatLngUtil.cloneLatLngs(s.getLatLngs())}:s instanceof L.Circle?this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng()),radius:s.getRadius()}:(s instanceof L.Marker||s instanceof L.CircleMarker)&&(this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(s){var i=L.Util.stamp(s);s.edited=!1,this._uneditedLayerProps.hasOwnProperty(i)&&(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?s.setLatLngs(this._uneditedLayerProps[i].latlngs):s instanceof L.Circle?(s.setLatLng(this._uneditedLayerProps[i].latlng),s.setRadius(this._uneditedLayerProps[i].radius)):(s instanceof L.Marker||s instanceof L.CircleMarker)&&s.setLatLng(this._uneditedLayerProps[i].latlng),s.fire("revert-edited",{layer:s}))},_enableLayerEdit:function(s){var i,l,u=s.layer||s.target||s;this._backupLayer(u),this.options.poly&&(l=L.Util.extend({},this.options.poly),u.options.poly=l),this.options.selectedPathOptions&&(i=L.Util.extend({},this.options.selectedPathOptions),i.maintainColor&&(i.color=u.options.color,i.fillColor=u.options.fillColor),u.options.original=L.extend({},u.options),u.options.editing=i),u instanceof L.Marker?(u.editing&&u.editing.enable(),u.dragging.enable(),u.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):u.editing.enable()},_disableLayerEdit:function(s){var i=s.layer||s.target||s;i.edited=!1,i.editing&&i.editing.disable(),delete i.options.editing,delete i.options.original,this._selectedPathOptions&&(i instanceof L.Marker?this._toggleMarkerHighlight(i):(i.setStyle(i.options.previousOptions),delete i.options.previousOptions)),i instanceof L.Marker?(i.dragging.disable(),i.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):i.editing.disable()},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_onMarkerDragEnd:function(s){var i=s.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_onTouchMove:function(s){var i=s.originalEvent.changedTouches[0],l=this._map.mouseEventToLayerPoint(i),u=this._map.layerPointToLatLng(l);s.target.setLatLng(u)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(s,i){if(L.Handler.prototype.initialize.call(this,s),L.Util.setOptions(this,i),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(s){this._deletableLayers.addLayer(s),s.fire("revert-deleted",{layer:s})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(s){this._removeLayer({layer:s})},this),this.save()},_enableLayerDelete:function(s){(s.layer||s.target||s).on("click",this._removeLayer,this)},_disableLayerDelete:function(s){var i=s.layer||s.target||s;i.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(i)},_removeLayer:function(s){var i=s.layer||s.target||s;this._deletableLayers.removeLayer(i),this._deletedLayers.addLayer(i),i.fire("deleted")},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const Gv=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"",ef=e=>e.length*6+12,Yc=(e,t)=>!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom),Ub=(e,t)=>{if(!e||t.length===0)return new Set;const o=[],a=e.getBounds();t.forEach(l=>{if(a.contains(l.getLatLng())){const u=e.latLngToContainerPoint(l.getLatLng()),d=l.locationData;d&&o.push({marker:l,pixelPos:u,location:d})}});const s=o.map(({marker:l,pixelPos:u,location:d})=>{const g=ef(d.name),y=d.description?ef(`${d.name}: ${Gv(d.description,50)}`):g;return{marker:l,location:d,markerBox:{left:u.x-15,right:u.x+15,top:u.y-15,bottom:u.y+15},baseLabelBox:{left:u.x-g/2,right:u.x+g/2,top:u.y+15+2,bottom:u.y+15+2+20},descLabelBox:d.description?{left:u.x-y/2,right:u.x+y/2,top:u.y+15+2,bottom:u.y+15+2+20}:null}}),i=new Set;return s.forEach(({marker:l,location:u,markerBox:d,baseLabelBox:f,descLabelBox:p},g)=>{if(!u.description)return;let y=!1;for(let k=0;k<s.length;k++){if(g===k)continue;const _=s[k];if(Yc(p,_.markerBox)||Yc(p,_.baseLabelBox)){y=!0;break}if(_.descLabelBox&&i.has(_.location.id)&&Yc(p,_.descLabelBox)){y=!0;break}}y||i.add(u.id)}),i},hr=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"hexagon",label:"Hexagon"},{value:"pentagon",label:"Pentagon"},{value:"diamond",label:"Diamond"},{value:"star",label:"Star"},{value:"dot",label:"Dot"},{value:"none",label:"None"}],zb=[{value:"33",label:"Small (33%)"},{value:"66",label:"Medium (66%)"},{value:"100",label:"Normal (100%)"},{value:"150",label:"Large (150%)"}],zr=[{value:"default",label:"Default",isShapeOnly:!1,category:"default"},{value:"dot",label:"Dot",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"circle",label:"Circle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"square",label:"Square",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"triangle",label:"Triangle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"diamond",label:"Diamond",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"star",label:"Star",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"hexagon",label:"Hexagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"pentagon",label:"Pentagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"car",label:"Car",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"bike",label:"Bike",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"water",label:"Water",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"food",label:"Food",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"medical",label:"Medical",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"photo",label:"Photo",isShapeOnly:!1,category:"content",defaultColor:"#8B5CF6"},{value:"music",label:"Music",isShapeOnly:!1,category:"content",defaultColor:"#EC4899"},{value:"start",label:"Start",isShapeOnly:!1,category:"content",defaultColor:"#10B981"},{value:"finish",label:"Finish",isShapeOnly:!1,category:"content",defaultColor:"#1F2937"},{value:"toilet",label:"Toilet",isShapeOnly:!1,category:"content",defaultColor:"#6366F1"},{value:"shower",label:"Shower",isShapeOnly:!1,category:"content",defaultColor:"#06B6D4"},{value:"bus",label:"Bus",isShapeOnly:!1,category:"content",defaultColor:"#F97316"},{value:"info",label:"Information",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"merch",label:"Merchandise",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"cone",label:"Road closure",isShapeOnly:!1,category:"content",defaultColor:"#FF6B00"},{value:"traffic",label:"Traffic management",isShapeOnly:!1,category:"content",defaultColor:"#374151"},{value:"track",label:"Track",isShapeOnly:!1,category:"content",defaultColor:"#78716C"},{value:"tunnel",label:"Tunnel",isShapeOnly:!1,category:"content",defaultColor:"#57534E"},{value:"bridge",label:"Bridge",isShapeOnly:!1,category:"content",defaultColor:"#0284C7"},{value:"plane",label:"Plane",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"hill",label:"Hill",isShapeOnly:!1,category:"content",defaultColor:"#65A30D"},{value:"baggage",label:"Baggage",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"crown",label:"Crown",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"crossing",label:"Crossing point",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"trees",label:"Trees",isShapeOnly:!1,category:"content",defaultColor:"#22C55E"},{value:"arrow-uturn-left",label:"Left u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-left",label:"Left turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-left",label:"Slight left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-straight",label:"Straight ahead",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-right",label:"Slight right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-right",label:"Right turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-uturn-right",label:"Right u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-left",label:"Left fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-right",label:"Right fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-left",label:"Keep left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-right",label:"Keep right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"}];function oi(e){return zr.find(t=>t.value===e)||zr[0]}function Hb(e){return oi(e).defaultColor||"#667eea"}function Vb(e,t){return t||Hb(e)}const Iu={dot:(e,t=32)=>{const o=(t/2-2)*.33;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="1.5"/>
    </svg>`},circle:(e,t=32)=>{const o=t/2-2;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`},square:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect x="4" y="4" width="${t-8}" height="${t-8}" rx="4" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`,triangle:(e,t=32)=>{const o=t/2,a=4,s=t-4,i=4,l=t-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${a} ${l},${s} ${i},${s}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},diamond:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${a-s} ${o+s},${a} ${o},${a+s} ${o-s},${a}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},star:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-3,i=s*.4,l=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;l.push(`${o+s*Math.cos(d)},${a+s*Math.sin(d)}`);const f=d+Math.PI/5;l.push(`${o+i*Math.cos(f)},${a+i*Math.sin(f)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${l.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},hexagon:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-4,i=[];for(let l=0;l<6;l++){const u=Math.PI/6+l*Math.PI/3;i.push(`${o+s*Math.cos(u)},${a+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},pentagon:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-4,i=[];for(let l=0;l<5;l++){const u=Math.PI/2*-1+l*2*Math.PI/5;i.push(`${o+s*Math.cos(u)},${a+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},car:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Car body -->
      <rect x="6" y="13" width="20" height="8" rx="2" fill="#fff"/>
      <!-- Car roof/cabin -->
      <path d="M10 13 L12 9 L20 9 L22 13" fill="#fff" stroke="#fff" stroke-width="1"/>
      <!-- Windows -->
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${e}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${e}"/>
      <!-- Tires (always black) -->
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <!-- Wheel centers -->
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>
    </svg>`,bike:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Tires (same color as bike) -->
      <circle cx="9" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <!-- Wheel centers -->
      <circle cx="9" cy="20" r="1" fill="#fff"/>
      <circle cx="23" cy="20" r="1" fill="#fff"/>
      <!-- Frame -->
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
      <!-- Handlebars -->
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <!-- Seat -->
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="#fff"/>
    </svg>`},tf={water:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="#fff"/>
    </svg>`,food:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="#fff"/>
      <path d="M21 9v14h2V9h-2z" fill="#fff"/>
    </svg>`,medical:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#fff" stroke-width="2"/>
      <rect x="14" y="8" width="4" height="16" rx="1" fill="#fff"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="#fff"/>
    </svg>`,photo:(e=32)=>{const t="#8B5CF6";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="8" y="10" width="16" height="12" rx="2" fill="#fff"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" y="13" r="1" fill="${t}"/>
    </svg>`},music:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EC4899" stroke="#fff" stroke-width="2"/>
      <path d="M12 22c1.66 0 3-1.34 3-3v-9h5v4h-3v5c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.35 0 .69.07 1 .18V10c0-.55.45-1 1-1h5c.55 0 1 .45 1 1v6h-5v5c0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.7 0 1.37.15 2 .41" fill="#fff"/>
      <ellipse cx="12" cy="21" rx="2.5" ry="2" fill="#fff"/>
      <rect x="14" y="10" width="2" height="9" fill="#fff"/>
      <rect x="14" y="10" width="6" height="2" fill="#fff"/>
    </svg>`,start:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#10B981" stroke="#fff" stroke-width="2"/>
      <path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="#fff"/>
    </svg>`,finish:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#1F2937" stroke="#fff" stroke-width="2"/>
      <rect x="10" y="8" width="4" height="4" fill="#fff"/>
      <rect x="14" y="12" width="4" height="4" fill="#fff"/>
      <rect x="18" y="8" width="4" height="4" fill="#fff"/>
      <rect x="10" y="16" width="4" height="4" fill="#fff"/>
      <rect x="18" y="16" width="4" height="4" fill="#fff"/>
      <rect x="14" y="20" width="4" height="4" fill="#fff"/>
    </svg>`,toilet:(e=32)=>{const t="#6366F1";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="11" y="7" width="10" height="3" rx="1" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>
    </svg>`},shower:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#06B6D4" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="3" fill="#fff"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="#fff"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
    </svg>`,bus:(e=32)=>{const t="#F97316";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="9" y="9" width="14" height="12" rx="2" fill="#fff"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="#fff"/>
      <circle cx="12" cy="21" r="1.5" fill="#fff"/>
      <circle cx="20" cy="21" r="1.5" fill="#fff"/>
    </svg>`},info:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#0EA5E9" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="2" fill="#fff"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="#fff"/>
    </svg>`,merch:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#A855F7" stroke="#fff" stroke-width="2"/>
      <path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="#fff"/>
      <path d="M13 10 L16 7 L19 10" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>`,cone:(e=32)=>{const t="#FF6B00";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L21 22 H11 L16 6Z" fill="#fff"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="#fff"/>
    </svg>`},traffic:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#374151" stroke="#fff" stroke-width="2"/>
      <rect x="12" y="6" width="8" height="20" rx="2" fill="#fff"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>
    </svg>`,crown:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="#fff"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="#fff"/>
    </svg>`,crossing:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="#fff" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="#fff" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="#fff"/>
      <path d="M16 10 L16 16" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
    </svg>`,trees:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#22C55E" stroke="#fff" stroke-width="2"/>
      <!-- Left tree -->
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="#fff"/>
      <!-- Right tree -->
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="#fff"/>
    </svg>`,"arrow-uturn-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on right, curve left, down on left -->
      <path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on left side -->
      <path d="M7 15 L12 21 L17 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="#fff"/>
    </svg>`,"arrow-slight-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-straight":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
    </svg>`,"arrow-slight-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="#fff"/>
    </svg>`,"arrow-uturn-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on left, curve right, down on right -->
      <path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on right side -->
      <path d="M15 15 L20 21 L25 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-fork-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (correct way - with arrow) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M10 12 L6 10 L8 16 Z" fill="#fff"/>
      <!-- Right fork (wrong way - with X) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
    </svg>`,"arrow-fork-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (wrong way - with X) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <!-- Right fork (correct way - with arrow) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M22 12 L26 10 L24 16 Z" fill="#fff"/>
    </svg>`,"arrow-keep-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-keep-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`},$i={circle:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="14" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,square:({backgroundColor:e,borderColor:t})=>`<rect x="4" y="4" width="24" height="24" rx="4" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,hexagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",a=t==="none"?0:2,s=[];for(let i=0;i<6;i++){const l=Math.PI/6+i*Math.PI/3;s.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${a}" stroke-linejoin="round"/>`},pentagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",a=t==="none"?0:2,s=[];for(let i=0;i<5;i++){const l=Math.PI/2*-1+i*2*Math.PI/5;s.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${a}" stroke-linejoin="round"/>`},diamond:({backgroundColor:e,borderColor:t})=>`<polygon points="16,4 28,16 16,28 4,16" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}" stroke-linejoin="round"/>`,star:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",a=t==="none"?0:2,s=13,i=s*.4,l=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;l.push(`${16+s*Math.cos(d)},${16+s*Math.sin(d)}`);const f=d+Math.PI/5;l.push(`${16+i*Math.cos(f)},${16+i*Math.sin(f)}`)}return`<polygon points="${l.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${a}" stroke-linejoin="round"/>`},dot:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="5" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:1.5}"/>`,none:()=>""},nf={water:(e="#fff")=>`<path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="${e}"/>`,food:(e="#fff")=>`<path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="${e}"/>
      <path d="M21 9v14h2V9h-2z" fill="${e}"/>`,medical:(e="#fff")=>`<rect x="14" y="8" width="4" height="16" rx="1" fill="${e}"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="${e}"/>`,photo:(e="#fff",t="#667eea")=>`<rect x="8" y="10" width="16" height="12" rx="2" fill="${e}"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" cy="13" r="1" fill="${t}"/>`,music:(e="#fff")=>`<ellipse cx="12" cy="21" rx="2.5" ry="2" fill="${e}"/>
      <rect x="14" y="10" width="2" height="9" fill="${e}"/>
      <rect x="14" y="10" width="6" height="2" fill="${e}"/>`,start:(e="#fff")=>`<path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="${e}"/>`,finish:(e="#fff")=>`<rect x="10" y="8" width="4" height="4" fill="${e}"/>
      <rect x="14" y="12" width="4" height="4" fill="${e}"/>
      <rect x="18" y="8" width="4" height="4" fill="${e}"/>
      <rect x="10" y="16" width="4" height="4" fill="${e}"/>
      <rect x="18" y="16" width="4" height="4" fill="${e}"/>
      <rect x="14" y="20" width="4" height="4" fill="${e}"/>`,toilet:(e="#fff",t="#667eea")=>`<rect x="11" y="7" width="10" height="3" rx="1" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="${e}" stroke-width="2" fill="none" stroke-linecap="round"/>`,shower:(e="#fff")=>`<circle cx="16" cy="10" r="3" fill="${e}"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="${e}"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>`,bus:(e="#fff",t="#667eea")=>`<rect x="9" y="9" width="14" height="12" rx="2" fill="${e}"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="${e}"/>
      <circle cx="12" cy="21" r="1.5" fill="${e}"/>
      <circle cx="20" cy="21" r="1.5" fill="${e}"/>`,info:(e="#fff")=>`<circle cx="16" cy="10" r="2" fill="${e}"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="${e}"/>`,merch:(e="#fff")=>`<path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="${e}"/>
      <path d="M13 10 L16 7 L19 10" stroke="${e}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`,cone:(e="#fff",t="#667eea")=>`<path d="M16 6 L21 22 H11 L16 6Z" fill="${e}"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="${e}"/>`,traffic:(e="#fff")=>`<rect x="12" y="6" width="8" height="20" rx="2" fill="${e}"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>`,car:(e="#fff",t="#667eea")=>`<rect x="6" y="13" width="20" height="8" rx="2" fill="${e}"/>
      <path d="M10 13 L12 9 L20 9 L22 13" fill="${e}" stroke="${e}" stroke-width="1"/>
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${t}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${t}"/>
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>`,bike:(e="#fff")=>`<circle cx="9" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="9" cy="20" r="1" fill="${e}"/>
      <circle cx="23" cy="20" r="1" fill="${e}"/>
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="${e}" stroke-width="2" stroke-linejoin="round"/>
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="${e}"/>`,"arrow-uturn-left":(e="#fff")=>`<path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7 15 L12 21 L17 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-left":(e="#fff")=>`<path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="${e}"/>`,"arrow-slight-left":(e="#fff")=>`<g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-straight":(e="#fff")=>`<path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>`,"arrow-slight-right":(e="#fff")=>`<g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-right":(e="#fff")=>`<path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="${e}"/>`,"arrow-uturn-right":(e="#fff")=>`<path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 15 L20 21 L25 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-fork-left":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Left arrowhead -->
      <path d="M10 12 L6 10 L8 16 Z" fill="${e}"/>
      <!-- Wrong way indicator on right -->
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>`,"arrow-fork-right":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <!-- Wrong way indicator on left -->
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Right arrowhead -->
      <path d="M22 12 L26 10 L24 16 Z" fill="${e}"/>`,"arrow-keep-left":(e="#fff")=>`<g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-keep-right":(e="#fff")=>`<g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,track:(e="#fff")=>`
      <rect x="10" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="19.5" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="8" y="9" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="14.5" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="20" width="16" height="2.5" rx="0.5" fill="${e}"/>`,tunnel:(e="#fff")=>`
      <path d="M7 25 L7 14 C7 8 11 5 16 5 C21 5 25 8 25 14 L25 25" fill="none" stroke="${e}" stroke-width="2.5"/>
      <path d="M11 25 L11 16 C11 12 13 10 16 10 C19 10 21 12 21 16 L21 25" fill="none" stroke="${e}" stroke-width="1.5" opacity="0.6"/>`,bridge:(e="#fff")=>`
      <rect x="5" y="18" width="22" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="7" y="10" width="2" height="8" fill="${e}"/>
      <rect x="23" y="10" width="2" height="8" fill="${e}"/>
      <path d="M8 10 Q16 6 24 10" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <line x1="12" y1="13" x2="12" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="16" y1="11.5" x2="16" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="20" y1="13" x2="20" y2="18" stroke="${e}" stroke-width="1.5"/>`,plane:(e="#fff")=>`
      <g fill="${e}">
        <!-- Fuselage body -->
        <path d="M27 16 L24 14 L8 14 Q4 16 8 18 L24 18 L27 16 Z"/>
        <!-- Nose cone -->
        <path d="M8 14 Q4 16 8 18 L8 14 Z"/>
        <!-- Tail fin -->
        <path d="M26 14 L26 9 L22 14 Z"/>
        <!-- Main wing -->
        <path d="M20 16 L16 10 L14 10 L16 16 L14 22 L16 22 L20 16 Z"/>
        <!-- Cockpit window -->
        <ellipse cx="10" cy="16" rx="1.5" ry="1" fill="none" stroke="${e}" stroke-width="0.5" opacity="0.6"/>
      </g>`,hill:(e="#fff")=>`
      <path d="M6 24 L13 12 L16 16 L20 10 L26 24 Z" fill="${e}"/>
      <path d="M20 10 L22 13 L18 13 Z" fill="${e}" opacity="0.6"/>`,baggage:(e="#fff")=>`
      <rect x="8" y="12" width="16" height="12" rx="2" fill="${e}"/>
      <rect x="12" y="8" width="8" height="4" rx="1" fill="none" stroke="${e}" stroke-width="2"/>
      <line x1="12" y1="16" x2="20" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
      <line x1="12" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>`,crown:(e="#fff")=>`
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="${e}"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="${e}"/>`,crossing:(e="#fff")=>`
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="${e}" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="${e}" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="${e}"/>
      <path d="M16 10 L16 16" stroke="${e}" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>`,trees:(e="#fff")=>`
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="${e}"/>
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="${e}"/>`};function Sn({type:e,backgroundShape:t="circle",backgroundColor:o,borderColor:a,iconColor:s,size:i="100",outputSize:l=null}){if(!e||e==="default"){if(!(o||a||s||t&&t!=="circle"&&t!=="default"))return null;e=t&&t!=="default"?t:"circle"}const u=oi(e),d=parseInt(i,10)/100,f=l||Math.round(32*d);let p="";if(u.isShapeOnly){const g=o||u.defaultColor||"#667eea",y=a||"#fff";if($i[e])p=$i[e]({backgroundColor:g,borderColor:y});else return Iu[e]?.(g,f)||null}else{const g=o||"#667eea",y=a||"#fff",k=s||"#fff",_=t||"circle";_!=="none"&&$i[_]&&(p+=$i[_]({backgroundColor:g,borderColor:y})),nf[e]&&(p+=nf[e](k,g))}return`<svg width="${f}" height="${f}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
    ${p}
  </svg>`}const Gb={full:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#10B981" stroke="#fff" stroke-width="1.5"/>
    <path d="M4 7l2 2 4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </svg>`,partial:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#F59E0B" stroke="#fff" stroke-width="1.5"/>
    <rect x="6" y="3.5" width="2" height="4.5" rx="1" fill="#fff"/>
    <circle cx="7" cy="10" r="1" fill="#fff"/>
  </svg>`,missing:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#EF4444" stroke="#fff" stroke-width="1.5"/>
    <path d="M4.5 4.5l5 5M9.5 4.5l-5 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
  </svg>`};function jb(e,t){return e===0?"missing":e>=t?"full":"partial"}function $u(e,t){const o=jb(e,t);return Gb[o]}function Zb(e,t,o=32){if(e==="default")return null;if(tf[e])return tf[e](o);if(Iu[e]){const a=t||"#667eea";return Iu[e](a,o)}return null}const qb=["circle","square","hexagon","pentagon"];function Wb(e){return qb.includes(e)}function Kb(e,t,o,a,s=32,i=!0){const l=Zb(e,t,s),u=$u(o,a);if(!l)return null;const d=i&&Wb(e),f=Vb(e,t),p=Yb(f),g=jv(f)?"0 1px 2px rgba(255,255,255,0.5)":"0 1px 2px rgba(0,0,0,0.5)",y=s>=36?"12px":"10px",k=d?`
    <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: ${p};
      font-weight: bold;
      font-size: ${y};
      text-shadow: ${g};
      pointer-events: none;
    ">${o}/${a}</div>
  `:"";return`
    <div style="position: relative; width: ${s}px; height: ${s}px;">
      ${l}
      ${k}
      <div style="position: absolute; bottom: -4px; right: -4px;">
        ${u}
      </div>
    </div>
  `}function Jb(e){const t=e.replace("#",""),o=parseInt(t.substr(0,2),16)/255,a=parseInt(t.substr(2,2),16)/255,s=parseInt(t.substr(4,2),16)/255,i=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),l=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*i+.7152*l+.0722*u}function jv(e){return!e||e.length<6?!1:Jb(e)>.4}function Yb(e){return jv(e)?"#1F2937":"#FFFFFF"}const Xb={class:"map-container-wrapper"},Qb="#667eea",e0={__name:"MapView",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},clickable:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1},editingPolygon:{type:Array,default:null},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","polygon-complete","polygon-drawing","polygon-update","visibility-change"],setup(e,{expose:t,emit:o}){const a=e,s=o,i=$(null);let l=null;const u=$([]),d=$([]),f=$([]);let p=null,g=null;const y=$([]);let k=null,_=null,w=!1;const S=$(!1),A=()=>{if(l){const be=l.getCenter();return{lat:be.lat,lng:be.lng}}return null},T=()=>l?l.getZoom():null,x=()=>{if(u.value.length>0){f.value.push([...u.value]);const be=d.value.pop()||[];u.value=be,we(),s("polygon-drawing",u.value)}},P=()=>{if(f.value.length>0){d.value.push([...u.value]);const be=f.value.pop();u.value=be,we(),s("polygon-drawing",u.value)}},O=()=>u.value.length>0,F=()=>f.value.length>0,E=()=>u.value.length,N=()=>{u.value.length>=3&&(s("polygon-complete",[...u.value]),D())},D=()=>{u.value=[],d.value=[],f.value=[],we()},j=()=>{!l||!a.userLocation||(l.setView([a.userLocation.lat,a.userLocation.lng],l.getZoom(),{animate:!0,duration:.5}),S.value=!0)},R=(be,me,Z=null)=>{if(!l||be==null||me==null)return;l.setView([be,me],Z??l.getZoom(),{animate:!0,duration:.5});const oe=a.center&&Math.abs(a.center.lat-be)<1e-4&&Math.abs(a.center.lng-me)<1e-4;S.value=!oe},W=$(!0),ne=$(!0),ue=(be,me)=>{if(!l||be==null||me==null)return!0;const Z=l.getBounds(),oe=tn.latLng(be,me);return Z.contains(oe)};t({getMapCenter:A,getMapZoom:T,undoPolygonPoint:x,redoPolygonPoint:P,canUndo:O,canRedo:F,getPolygonPointCount:E,completePolygon:N,clearPolygonDrawing:D,recenterOnUserLocation:j,recenterOnLocation:R,isLocationInView:ue,userLocationInView:ne,highlightedLocationInView:W});const K=$([]);let Q=null;const he=$(!0),U=$(!1),ee=$(new Set),de=$([]);let re=null,De=null;const et=G(()=>a.hideRecenterButton||!a.highlightLocationId||!S.value?!1:!W.value),Je=$({}),Fe=()=>{const be={};if(a.highlightLocationId){const me=a.locations.find(Z=>Z.id===a.highlightLocationId);if(me?.latitude&&me?.longitude){const Z=ue(me.latitude,me.longitude);W.value=Z,be[a.highlightLocationId]=Z,Je.value=be;return}}if(a.highlightLocationIds&&a.highlightLocationIds.length>0){let me=!0;for(const Z of a.highlightLocationIds){const oe=a.locations.find(le=>le.id===Z);if(oe?.latitude&&oe?.longitude){const le=ue(oe.latitude,oe.longitude);be[Z]=le,le||(me=!1)}else be[Z]=!0}W.value=me,Je.value=be;return}if(!l){W.value=!0,Je.value={};return}W.value=!0,Je.value={}},Ke=()=>{if(!l||!a.userLocation){ne.value=!0;return}ne.value=ue(a.userLocation.lat,a.userLocation.lng)},_e=()=>{Fe(),Ke(),s("visibility-change",{userLocationInView:ne.value,highlightedLocationInView:W.value,highlightedLocationsVisibility:Je.value})},Ve=()=>{if(!l||!a.highlightLocationId)return;const be=a.locations.find(me=>me.id===a.highlightLocationId);!be||!be.latitude||!be.longitude||(l.setView([be.latitude,be.longitude],l.getZoom(),{animate:!0,duration:.5}),S.value=!1,W.value=!0)},pe=(be,me,Z,oe,le=!1)=>{const Te=Z?"36px":oe?"20px":"30px",Oe=Z?"#667eea":"white",Be=le?"":$u(be,me);return`
    <div style="position: relative; width: ${Te}; height: ${Te};">
      <div style="
        background-color: ${Qb};
        width: ${Te};
        height: ${Te};
        border-radius: 50%;
        border: 3px solid ${Oe};
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      "></div>
      ${le?"":`<div style="position: absolute; bottom: -4px; right: -4px;">
        ${Be}
      </div>`}
    </div>
  `},Le=()=>{if(!l)return;const be=Ub(l,K.value),me=Array.from(ee.value).sort().join(","),Z=Array.from(be).sort().join(",");me!==Z&&(ee.value=be,Ce())},Pe=()=>{if(De&&(De.remove(),De=null),!l||!a.userLocation)return;const be=tn.divIcon({className:"user-location-marker",html:`
      <div style="
        position: relative;
        width: 20px;
        height: 20px;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #4285f4;
          border: 3px solid white;
          border-radius: 50%;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        "></div>
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 40px;
          height: 40px;
          background-color: rgba(66, 133, 244, 0.2);
          border-radius: 50%;
          animation: pulse 2s ease-out infinite;
        "></div>
      </div>
    `,iconSize:[40,40],iconAnchor:[20,20]});De=tn.marker([a.userLocation.lat,a.userLocation.lng],{icon:be}).addTo(l).bindPopup("Your location")},q=()=>{if(!i.value)return;let be=51.505,me=-.09,Z=13;const oe=a.allLocationsForBounds.length>0?a.allLocationsForBounds:a.locations,le=(Oe,Be)=>Oe!=null&&Be!=null&&!(Oe===0&&Be===0),Te=[];oe.length>0&&Te.push(...oe.filter(Oe=>le(Oe.latitude,Oe.longitude)).map(Oe=>({lat:Oe.latitude,lng:Oe.longitude}))),a.route&&a.route.length>0&&Te.push(...a.route.filter(Oe=>le(Oe.lat,Oe.lng)).map(Oe=>({lat:Oe.lat,lng:Oe.lng}))),a.center?(be=a.center.lat,me=a.center.lng,Z=a.zoom??13):Te.length>0&&(be=Te.reduce((Oe,Be)=>Oe+Be.lat,0)/Te.length,me=Te.reduce((Oe,Be)=>Oe+Be.lng,0)/Te.length,Z=10),l=tn.map(i.value).setView([be,me],Z),tn.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(l),a.clickable&&l.on("click",Oe=>{a.drawingMode||s("map-click",{lat:Oe.latlng.lat,lng:Oe.latlng.lng})}),l.on("zoomstart",()=>{Re=!0}),l.on("zoomend moveend",()=>{Re=!1,Me?Ce():Le(),_e()}),l.on("dragstart",()=>{S.value=!0}),Ce(),X(),fe(),Pe(),J(),V(),l.whenReady(()=>{_e()})},X=()=>{if(Q&&(Q.remove(),Q=null),!l||a.route.length===0)return;const be=a.route.map(me=>[me.lat,me.lng]);Q=tn.polyline(be,{color:"blue",weight:4,opacity:.7}).addTo(l)},fe=()=>{de.value.forEach(be=>be.remove()),de.value=[],!(!l||a.areas.length===0)&&a.areas.forEach(be=>{const me=typeof be.polygon=="string"?JSON.parse(be.polygon):be.polygon;if(!me||me.length===0)return;const Z=me.map(Oe=>[Oe.lat,Oe.lng]),oe=be.id===a.selectedAreaId,le=be.color||"#667eea",Te=tn.polygon(Z,{color:le,fillColor:le,fillOpacity:oe?.4:.2,weight:oe?3:2,opacity:.8}).addTo(l);Te.setStyle({pane:"overlayPane"}),a.drawingMode||(Te.on("click",()=>s("area-click",be)),Te.on("mouseover",()=>{Te.setStyle({fillOpacity:.4})}),Te.on("mouseout",()=>{Te.setStyle({fillOpacity:oe?.4:.2})})),de.value.push(Te)})},we=()=>{if(l&&(p&&(p.remove(),p=null),g&&(g.remove(),g=null),u.value.length!==0&&(g=tn.layerGroup().addTo(l),u.value.forEach((be,me)=>{const Z=me===0,oe=me===u.value.length-1,le=tn.divIcon({className:"polygon-point-marker",html:`<div style="
        width: ${Z?"16px":"12px"};
        height: ${Z?"16px":"12px"};
        background-color: ${Z?"#667eea":oe?"#ff9800":"white"};
        border: 3px solid #667eea;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      "></div>`,iconSize:[Z?16:12,Z?16:12],iconAnchor:[Z?8:6,Z?8:6]});tn.marker([be.lat,be.lng],{icon:le,interactive:!1}).addTo(g)}),u.value.length>=2))){const be=u.value.map(me=>[me.lat,me.lng]);u.value.length>=3&&be.push(be[0]),p=tn.polyline(be,{color:"#667eea",weight:3,opacity:.8,dashArray:u.value.length<3?"10, 10":null}).addTo(l)}},Y=()=>{if(!l||(k&&(k.remove(),k=null),_&&(_.remove(),_=null),y.value.length===0))return;const be=y.value.map(Z=>[Z.lat,Z.lng]);k=tn.polygon(be,{color:"#667eea",fillColor:"#667eea",fillOpacity:.2,weight:3,opacity:.8,pane:"overlayPane"}).addTo(l),k.bringToFront(),_=tn.layerGroup({pane:"markerPane"}).addTo(l);const me=Z=>{y.value.length<=3||(y.value.splice(Z,1),w=!0,s("polygon-update",[...y.value]),Y())};y.value.forEach((Z,oe)=>{const le=y.value.length>3,Te=tn.divIcon({className:"polygon-edit-marker",html:`<div class="vertex-marker" style="
        position: relative;
        width: 16px;
        height: 16px;
        background-color: #667eea;
        border: 3px solid white;
        border-radius: 50%;
        box-shadow: 0 2px 6px rgba(0,0,0,0.4);
        cursor: move;
      "></div>`,iconSize:[16,16],iconAnchor:[8,8]}),Oe=tn.marker([Z.lat,Z.lng],{icon:Te,draggable:!0}).addTo(_);if(Oe.on("drag",Be=>{const Xe=Be.target.getLatLng();y.value[oe]={lat:Xe.lat,lng:Xe.lng};const mt=y.value.map(_t=>[_t.lat,_t.lng]);k.setLatLngs(mt)}),Oe.on("dragend",()=>{w=!0,s("polygon-update",[...y.value])}),Oe.on("contextmenu",Be=>{tn.DomEvent.preventDefault(Be),le&&me(oe)}),le){const Be=document.createElement("div"),Xe=document.createElement("button");Xe.textContent="Delete point",Xe.style.cssText=`
        background: #dc3545;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9rem;
      `;const mt=_t=>{_t.preventDefault(),_t.stopPropagation(),Oe.closePopup(),me(oe)};Xe.addEventListener("click",mt),Xe.addEventListener("touchend",mt),Be.appendChild(Xe),Oe.bindPopup(Be,{closeButton:!1,className:"vertex-popup"})}})},V=(be=!0)=>{if(l){if(!a.editingPolygon||a.editingPolygon.length===0){k&&(k.remove(),k=null),_&&(_.remove(),_=null),y.value=[];return}if(y.value=a.editingPolygon.map(me=>({lat:me.lat,lng:me.lng})),Y(),be&&y.value.length>=3){const me=tn.latLngBounds(y.value.map(Z=>[Z.lat,Z.lng]));l.fitBounds(me,{padding:[50,50]})}}},J=()=>{if(!l)return;if(re||(re=new tn.FeatureGroup,l.addLayer(re)),l._customDrawingHandlers&&(l.off("click",l._customDrawingHandlers.handleClick),l.getContainer().removeEventListener("touchstart",l._customDrawingHandlers.handleTouchStart),l.getContainer().removeEventListener("touchend",l._customDrawingHandlers.handleTouchEnd),l.getContainer().removeEventListener("touchmove",l._customDrawingHandlers.handleTouchMove),delete l._customDrawingHandlers),!a.drawingMode){D(),re&&re.clearLayers();return}let be=0,me=null,Z=!1,oe=!1;const le=300,Te=15,Oe=bt=>{d.value.push([...u.value]),f.value=[],u.value.push({lat:bt.lat,lng:bt.lng}),we(),s("polygon-drawing",u.value)},Be=bt=>{bt.originalEvent&&bt.originalEvent.sourceCapabilities?.firesTouchEvents||Oe(bt.latlng)},Xe=bt=>{if(bt.touches.length>1){oe=!0;return}oe=!1,be=Date.now(),me={x:bt.touches[0].clientX,y:bt.touches[0].clientY},Z=!1},mt=bt=>{if(!me||oe)return;const Mt=bt.touches[0].clientX-me.x,Ct=bt.touches[0].clientY-me.y;Math.sqrt(Mt*Mt+Ct*Ct)>Te&&(Z=!0)},_t=bt=>{if(oe){oe=!1,me=null;return}if(Date.now()-be<le&&!Z&&me){const Ct=bt.changedTouches[0],Bt=tn.point(Ct.clientX-l.getContainer().getBoundingClientRect().left,Ct.clientY-l.getContainer().getBoundingClientRect().top),Nt=l.containerPointToLatLng(Bt);bt.preventDefault(),bt.stopPropagation(),Oe(Nt)}me=null,Z=!1};l.on("click",Be),l.getContainer().addEventListener("touchstart",Xe,{passive:!0}),l.getContainer().addEventListener("touchmove",mt,{passive:!0}),l.getContainer().addEventListener("touchend",_t,{passive:!1}),l._customDrawingHandlers={handleClick:Be,handleTouchStart:Xe,handleTouchMove:mt,handleTouchEnd:_t},we()};let Me=!1,Re=!1;const Ce=()=>{if(l&&(l._animatingZoom||Re)){Me=!0;return}if(Me=!1,K.value.forEach(Z=>{Z._map&&(Z.off(),Z.remove())}),K.value=[],!l)return;const be=i.value?.clientWidth||400,me=Math.floor(be*.75);if(a.locations.forEach(Z=>{const oe=Z.latitude??Z.Latitude,le=Z.longitude??Z.Longitude;if(oe==null||le==null||oe===0&&le===0)return;const Te=Z.checkedInCount||0,Oe=Z.requiredMarshals||1,Be=a.highlightLocationId===Z.id||a.highlightLocationIds.includes(Z.id),Xe=a.simplifyNonHighlighted&&!Be,mt=Z.resolvedStyleType||Z.ResolvedStyleType,_t=Z.resolvedStyleBackgroundColor||Z.ResolvedStyleBackgroundColor||Z.resolvedStyleColor||Z.ResolvedStyleColor,bt=Z.resolvedStyleBorderColor||Z.ResolvedStyleBorderColor,Mt=Z.resolvedStyleIconColor||Z.ResolvedStyleIconColor,Ct=Z.resolvedStyleBackgroundShape||Z.ResolvedStyleBackgroundShape,Bt=mt&&mt!=="default"||_t||bt||Mt||Ct&&Ct!=="circle"&&Ct!=="default",Nt=Z.resolvedStyleMapRotation??Z.ResolvedStyleMapRotation??Z.styleMapRotation??Z.StyleMapRotation??0,zn=parseInt(Nt,10)||0,Xn=Z.areaColor||"#999",pn=Z.areaId&&!a.marshalMode,gt=ee.value.has(Z.id)&&Z.description?`${Z.name}: ${Gv(Z.description,50)}`:Z.name,Qn=Be?`
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid #667eea;
        border-radius: 50%;
        animation: highlight-pulse 1.5s ease-out infinite;
      "></div>
    `:"",Hn=Be?"#667eea":Xe?"#e0e0e0":"white",eo=Be?"white":Xe?"#888":"#333";let vn;if(Xe){const ot="20px";vn=`
        <div style="
          background-color: #999;
          width: ${ot};
          height: ${ot};
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        "></div>
      `}const jt=!a.marshalMode,_s=$u(Te,Oe),to=jt?`<div style="
      position: absolute;
      bottom: -2px;
      right: -6px;
      background-color: white;
      border-radius: 8px;
      padding: 1px 4px;
      font-size: 9px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    ">${Te}/${Oe}</div>`:"";if(!Xe&&Bt){const ot=Be?40:32,Ge=Z.resolvedStyleSize||Z.ResolvedStyleSize||"100",St=Sn({type:Z.resolvedStyleType||Z.ResolvedStyleType,backgroundShape:Z.resolvedStyleBackgroundShape||Z.ResolvedStyleBackgroundShape||"circle",backgroundColor:Z.resolvedStyleBackgroundColor||Z.ResolvedStyleBackgroundColor||Z.resolvedStyleColor||Z.ResolvedStyleColor||"",borderColor:Z.resolvedStyleBorderColor||Z.ResolvedStyleBorderColor||"",iconColor:Z.resolvedStyleIconColor||Z.ResolvedStyleIconColor||"",size:Ge});St?vn=St:vn=Kb(Z.resolvedStyleType,Z.resolvedStyleColor,Te,Oe,ot,jt)||pe(Te,Oe,Be,a.marshalMode,!0)}else Xe||(vn=pe(Te,Oe,Be,a.marshalMode,!0));const Co=zn!==0?`transform: rotate(${zn}deg);`:"",ae=tn.divIcon({className:"custom-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
          ${Qn}
          <div style="position: relative; display: flex; align-items: center; gap: 4px;">
            ${pn?`<div style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background-color: ${Xn};
              border: 2px solid white;
              box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            "></div>`:""}
            <div style="position: relative; display: inline-block;">
              <div style="${Co}">
                ${vn}
              </div>
              ${Xe?"":`<div style="position: absolute; top: -4px; right: -4px;">
                ${_s}
              </div>`}
              ${Xe?"":to}
            </div>
          </div>
          <div style="
            background-color: ${Hn};
            padding: 2px 6px;
            border-radius: 3px;
            font-size: ${Be?"12px":"11px"};
            font-weight: bold;
            color: ${eo};
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: ${me}px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${gt}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]}),ie=a.marshalMode?`<b>${Z.name}</b>${Z.description?`<br>${Z.description}`:""}`:`<b>${Z.name}</b><br>${Z.description||""}<br>Checked in: ${Te}/${Oe}`,ve=tn.marker([Z.latitude,Z.longitude],{icon:ae}).addTo(l).bindPopup(ie);ve.on("click",()=>{s("location-click",Z)}),ve.locationData=Z,K.value.push(ve)}),l&&he.value&&!a.center&&!U.value){const Z=[],oe=a.allLocationsForBounds.length>0?a.allLocationsForBounds:a.locations,le=(Te,Oe)=>Te!=null&&Oe!=null&&!(Te===0&&Oe===0);if(oe.length>0&&Z.push(...oe.filter(Te=>le(Te.latitude,Te.longitude)).map(Te=>[Te.latitude,Te.longitude])),a.route.length>0&&Z.push(...a.route.filter(Te=>le(Te.lat,Te.lng)).map(Te=>[Te.lat,Te.lng])),Z.length>0){const Te=tn.latLngBounds(Z);l.fitBounds(Te,{padding:[50,50]}),he.value=!1,U.value=!0}}else a.center&&(he.value=!1);setTimeout(()=>{l&&!l._animatingZoom&&Le()},100)};return on(()=>{U.value=!1,he.value=!0,q();let be,me=0,Z=0;const oe=new ResizeObserver(le=>{if(l&&le.length>0){const{width:Te,height:Oe}=le[0].contentRect;(Math.abs(Te-me)>10||Math.abs(Oe-Z)>10)&&(me=Te,Z=Oe,clearTimeout(be),be=setTimeout(()=>{l.invalidateSize()},150))}});i.value&&oe.observe(i.value),$n(()=>{clearTimeout(be),oe.disconnect()})}),qe(()=>a.locations,be=>{if(Ce(),l&&!U.value&&be.length>0&&!a.center){const me=be.map(Te=>Te.latitude),Z=be.map(Te=>Te.longitude),oe=me.reduce((Te,Oe)=>Te+Oe,0)/me.length,le=Z.reduce((Te,Oe)=>Te+Oe,0)/Z.length;l.setView([oe,le],10),U.value=!0,he.value=!1}l&&setTimeout(()=>_e(),50)},{deep:!0}),qe(()=>a.route,be=>{if(X(),Ce(),l&&!U.value&&be&&be.length>0&&!a.center){const me=be.map(Te=>Te.lat),Z=be.map(Te=>Te.lng),oe=me.reduce((Te,Oe)=>Te+Oe,0)/me.length,le=Z.reduce((Te,Oe)=>Te+Oe,0)/Z.length;l.setView([oe,le],10),U.value=!0,he.value=!1}},{deep:!0}),qe(()=>a.center,(be,me)=>{l&&!S.value&&(!me||Math.abs(be.lat-me.lat)>1e-6||Math.abs(be.lng-me.lng)>1e-6)&&l.setView([be.lat,be.lng],a.zoom)}),qe(()=>a.areas,()=>{fe()},{deep:!0}),qe(()=>a.selectedAreaId,()=>{fe()}),qe(()=>a.drawingMode,()=>{J()}),qe(()=>a.editingPolygon,()=>{if(w){w=!1;return}V()},{deep:!0}),qe(()=>a.userLocation,()=>{Pe()},{deep:!0}),qe(()=>a.highlightLocationId,()=>{Ce()}),qe(()=>a.highlightLocationIds,()=>{Ce(),l&&setTimeout(()=>_e(),50)},{deep:!0}),qe(()=>a.marshalMode,()=>{Ce()}),qe(()=>a.simplifyNonHighlighted,()=>{Ce()}),qe(()=>a.clickable,be=>{l&&(l.off("click"),be&&l.on("click",me=>{a.drawingMode||s("map-click",{lat:me.latlng.lat,lng:me.latlng.lng})}))}),(be,me)=>(v(),m("div",Xb,[r("div",{ref_key:"mapContainer",ref:i,class:"map-container"},null,512),et.value?(v(),m("button",{key:0,class:"recenter-btn",onClick:Ve,title:"Recenter on checkpoint"},[...me[0]||(me[0]=[r("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),r("span",null,"Recenter",-1)])])):M("",!0)]))}},Tu=je(e0,[["__scopeId","data-v-91272c81"]]);function Vs(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}const t0={class:"areas-selection"},n0={key:0,class:"areas-selection-header"},o0={class:"areas-list"},s0=["checked","onChange"],a0={__name:"AreasSelection",props:{areas:{type:Array,default:()=>[]},selectedAreaIds:{type:Array,default:()=>[]}},emits:["update:selectedAreaIds"],setup(e,{emit:t}){const o=e,a=t,s=G(()=>[...o.areas].sort((d,f)=>d.displayOrder!==f.displayOrder?d.displayOrder-f.displayOrder:Vs(d.name,f.name))),i=G(()=>o.areas.length>0&&o.selectedAreaIds.length===o.areas.length),l=d=>{const f=[...o.selectedAreaIds],p=f.indexOf(d);p>=0?f.splice(p,1):f.push(d),a("update:selectedAreaIds",f)},u=()=>{i.value?a("update:selectedAreaIds",[]):a("update:selectedAreaIds",o.areas.map(d=>d.id))};return(d,f)=>(v(),m("div",t0,[e.areas.length>1?(v(),m("div",n0,[r("button",{onClick:u,class:"toggle-all-btn"},C(i.value?"Deselect all":"Select all"),1)])):M("",!0),r("div",o0,[(v(!0),m(Se,null,Ne(s.value,p=>(v(),m("label",{class:"area-checkbox",key:p.id},[r("input",{type:"checkbox",checked:e.selectedAreaIds.includes(p.id),onChange:g=>l(p.id)},null,40,s0),r("span",{class:"area-color-dot",style:Qe({backgroundColor:p.color||"#667eea"})},null,4),Ye(" "+C(p.name),1)]))),128))])]))}},i0=je(a0,[["__scopeId","data-v-ba19009b"]]),l0={key:1,class:"toolbar-btn-wrapper filters-wrapper"},r0={key:1,class:"dropdown-content filters-dropdown"},c0={class:"filters-header"},u0={class:"filter-section"},d0={class:"filter-checkbox"},h0=["checked"],f0={class:"filter-section"},p0={class:"filter-checkbox"},v0=["checked"],m0={class:"filter-checkbox"},g0=["checked"],y0={class:"filter-checkbox"},k0=["checked"],_0={key:0,class:"filter-section"},b0=["onClick","title"],w0={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},C0={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},L0=["innerHTML"],S0={key:0,class:"dropdown-content action-dropdown"},x0=["onClick"],I0={__name:"MapToolbar",props:{showFullscreen:{type:Boolean,default:!1},showFilters:{type:Boolean,default:!1},filters:{type:Object,default:()=>({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},areas:{type:Array,default:()=>[]},actions:{type:Array,default:()=>[]},position:{type:String,default:"top-right",validator:e=>["top-right","top-left"].includes(e)}},emits:["fullscreen-click","filter-change","action-click"],setup(e,{expose:t,emit:o}){const{terms:a}=ht(),s=e,i=o,l=$(!1),u=$(null),d=G(()=>u.value!==null),f=()=>{l.value=!l.value,l.value&&(u.value=null)},p=(_,w)=>{i("filter-change",{...s.filters,[_]:w})},g=_=>{_.items&&_.items.length>0?u.value===_.id?u.value=null:(u.value=_.id,l.value=!1):i("action-click",{actionId:_.id})},y=(_,w)=>{u.value=null,i("action-click",{actionId:_,itemId:w})};return t({closeDropdowns:()=>{l.value=!1,u.value=null}}),(_,w)=>(v(),m("div",{class:ce(["map-toolbar",[`position-${e.position}`]])},[e.showFullscreen?(v(),m("button",{key:0,class:"toolbar-btn",onClick:w[0]||(w[0]=S=>_.$emit("fullscreen-click")),title:"Fullscreen"},[...w[8]||(w[8]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})],-1)])])):M("",!0),e.showFilters&&!d.value?(v(),m("div",l0,[l.value?(v(),m("div",{key:0,class:"mobile-backdrop",onClick:w[1]||(w[1]=S=>l.value=!1)})):M("",!0),r("button",{class:ce(["toolbar-btn",{active:l.value}]),onClick:f,title:"Show/hide options"},[...w[9]||(w[9]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),r("circle",{cx:"12",cy:"12",r:"3"})],-1)])],2),l.value?(v(),m("div",r0,[r("div",c0,[w[11]||(w[11]=r("span",{class:"filters-title"},"Map filters",-1)),r("button",{class:"close-filters-btn",onClick:w[2]||(w[2]=S=>l.value=!1),title:"Close"},[...w[10]||(w[10]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])]),r("div",u0,[w[12]||(w[12]=r("h4",null,"Display",-1)),r("label",d0,[r("input",{type:"checkbox",checked:e.filters.showRoute,onChange:w[3]||(w[3]=S=>p("showRoute",S.target.checked))},null,40,h0),r("span",null,C(B(a).course)+" line",1)])]),r("div",f0,[r("h4",null,C(B(a).checkpoints),1),r("label",p0,[r("input",{type:"checkbox",checked:e.filters.showUncheckedIn,onChange:w[4]||(w[4]=S=>p("showUncheckedIn",S.target.checked))},null,40,v0),w[13]||(w[13]=r("span",{class:"status-indicator unchecked"},null,-1)),w[14]||(w[14]=r("span",null,"Unchecked-in",-1))]),r("label",m0,[r("input",{type:"checkbox",checked:e.filters.showPartiallyCheckedIn,onChange:w[5]||(w[5]=S=>p("showPartiallyCheckedIn",S.target.checked))},null,40,g0),w[15]||(w[15]=r("span",{class:"status-indicator partial"},null,-1)),w[16]||(w[16]=r("span",null,"Partially checked-in",-1))]),r("label",y0,[r("input",{type:"checkbox",checked:e.filters.showFullyCheckedIn,onChange:w[6]||(w[6]=S=>p("showFullyCheckedIn",S.target.checked))},null,40,k0),w[17]||(w[17]=r("span",{class:"status-indicator full"},null,-1)),w[18]||(w[18]=r("span",null,"Fully checked-in",-1))])]),e.areas.length>0?(v(),m("div",_0,[r("h4",null,C(B(a).areas),1),Ae(i0,{areas:e.areas,"selected-area-ids":e.filters.selectedAreaIds,"onUpdate:selectedAreaIds":w[7]||(w[7]=S=>p("selectedAreaIds",S))},null,8,["areas","selected-area-ids"])])):M("",!0)])):M("",!0)])):M("",!0),(v(!0),m(Se,null,Ne(e.actions,S=>(v(),m("div",{key:S.id,class:ce(["toolbar-btn-wrapper",{hidden:l.value}])},[r("button",{class:ce(["toolbar-btn",{active:u.value===S.id}]),onClick:A=>g(S),title:S.label||S.id},[S.icon==="plus"?(v(),m("svg",w0,[...w[19]||(w[19]=[r("line",{x1:"12",y1:"5",x2:"12",y2:"19"},null,-1),r("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1)])])):S.icon==="edit"?(v(),m("svg",C0,[...w[20]||(w[20]=[r("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},null,-1),r("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1)])])):S.icon==="custom"?(v(),m("span",{key:2,innerHTML:S.customIcon},null,8,L0)):M("",!0)],10,b0),S.items&&u.value===S.id?(v(),m("div",S0,[(v(!0),m(Se,null,Ne(S.items,A=>(v(),m("button",{key:A.id,onClick:T=>y(S.id,A.id),class:"dropdown-item"},C(A.label),9,x0))),128))])):M("",!0)],2))),128))],2))}},$0=je(I0,[["__scopeId","data-v-d04b549d"]]),T0={key:0,class:"drawing-controls"},M0={class:"point-count"},A0={class:"undo-redo-buttons"},E0=["disabled"],P0=["disabled"],D0={__name:"MapDrawingControls",props:{pointCount:{type:Number,default:0},canUndo:{type:Boolean,default:!1},canRedo:{type:Boolean,default:!1},show:{type:Boolean,default:!0}},emits:["undo","redo"],setup(e,{emit:t}){const o=e,a=t,s=G(()=>o.show&&o.pointCount>0),i=l=>{if(!s.value)return;const d=navigator.platform.toUpperCase().indexOf("MAC")>=0?l.metaKey:l.ctrlKey;d&&l.key==="z"&&!l.shiftKey?(l.preventDefault(),o.canUndo&&a("undo")):d&&(l.key==="y"||l.key==="z"&&l.shiftKey)&&(l.preventDefault(),o.canRedo&&a("redo"))};return on(()=>{document.addEventListener("keydown",i)}),$n(()=>{document.removeEventListener("keydown",i)}),(l,u)=>s.value?(v(),m("div",T0,[r("div",M0,C(e.pointCount)+" point"+C(e.pointCount!==1?"s":""),1),r("div",A0,[r("button",{onClick:u[0]||(u[0]=d=>l.$emit("undo")),class:"btn-drawing undo-btn",disabled:!e.canUndo,title:"Undo last point (Ctrl+Z)"},"  Undo ",8,E0),r("button",{onClick:u[1]||(u[1]=d=>l.$emit("redo")),class:"btn-drawing redo-btn",disabled:!e.canRedo,title:"Redo point (Ctrl+Y)"}," Redo  ",8,P0)])])):M("",!0)}},of=je(D0,[["__scopeId","data-v-6cd009cb"]]),R0={class:"context-info"},O0={class:"action-buttons"},B0=["disabled"],N0={key:0,class:"fullscreen-map-banner"},F0={class:"fullscreen-map-container"},U0={key:1,class:"fullscreen-map-footer"},z0={__name:"MapFullscreenModal",props:{show:{type:Boolean,required:!0},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},title:{type:String,default:""},description:{type:String,default:""},canComplete:{type:Boolean,default:!1},headerStyle:{type:Object,default:()=>({})},headerTextColor:{type:String,default:""}},emits:["done","cancel","close"],setup(e,{emit:t}){const o=e,a=G(()=>o.headerTextColor?{color:o.headerTextColor}:{}),s=t,i=()=>{s("done")},l=()=>{s("cancel")},u=()=>{s("close")},d=f=>{f.key==="Escape"&&o.show&&(o.mode==="view"?u():l())};return qe(()=>o.show,f=>{f?(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"):(document.body.style.overflow="",document.documentElement.style.overflow="")},{immediate:!0}),on(()=>{document.addEventListener("keydown",d)}),$n(()=>{document.removeEventListener("keydown",d),document.body.style.overflow="",document.documentElement.style.overflow=""}),(f,p)=>(v(),Ze($l,{to:"body"},[e.show?(v(),m("div",{key:0,class:"fullscreen-map-overlay",onTouchmove:p[0]||(p[0]=rt(()=>{},["prevent","self"]))},[r("div",{class:"fullscreen-map-header",style:Qe(e.headerStyle)},[r("div",R0,[r("h3",{style:Qe({color:e.headerTextColor})},C(e.title),5),e.description?(v(),m("p",{key:0,style:Qe({color:e.headerTextColor,opacity:.85})},C(e.description),5)):M("",!0)]),r("div",O0,[io(f.$slots,"actions",{},void 0),e.mode==="view"?(v(),m("button",{key:0,type:"button",onClick:rt(u,["stop"]),class:"btn btn-close-x",style:Qe(a.value),title:"Close"},[...p[1]||(p[1]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"24",height:"24"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])],4)):(v(),m(Se,{key:1},[r("button",{type:"button",onClick:l,class:"btn btn-cancel"}," Cancel "),r("button",{type:"button",onClick:i,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,B0)],64))])],4),f.$slots.banner?(v(),m("div",N0,[io(f.$slots,"banner",{},void 0)])):M("",!0),r("div",F0,[io(f.$slots,"default",{},void 0)]),f.$slots.footer?(v(),m("div",U0,[io(f.$slots,"footer",{},void 0)])):M("",!0)],32)):M("",!0)]))}},H0=je(z0,[["__scopeId","data-v-b5d05af4"]]),V0={class:"map-wrapper"},G0={class:"fullscreen-map-wrapper"},j0={__name:"CommonMap",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},editingPolygon:{type:Array,default:null},height:{type:String,default:"400px"},showFullscreen:{type:Boolean,default:!0},showFilters:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]},toolbarPosition:{type:String,default:"top-right"},filters:{type:Object,default:()=>({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},fullscreenTitle:{type:String,default:""},fullscreenDescription:{type:String,default:""},fullscreenHeaderStyle:{type:Object,default:()=>({})},fullscreenHeaderTextColor:{type:String,default:""},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","visibility-change","point-selected","polygon-complete","polygon-drawing","polygon-update","fullscreen-change","filter-change","action-click","fullscreen-done","fullscreen-cancel"],setup(e,{expose:t,emit:o}){const a=e,s=o,i=$(null),l=$(null),u=$(null),d=$(!1),f=$(0),p=$(!1),g=$(!1),y=$({...a.filters});qe(()=>a.filters,K=>{y.value={...K}},{deep:!0}),qe(()=>a.areas,K=>{a.showFilters&&K.length>0&&(!y.value.selectedAreaIds||y.value.selectedAreaIds.length===0)&&(y.value.selectedAreaIds=K.map(Q=>Q.id))},{immediate:!0});const k=G(()=>a.showFilters?a.locations.filter(K=>{const Q=K.checkedInCount||0,he=K.requiredMarshals||1,U=Q===0,ee=Q>0&&Q<he,de=Q>=he;if(U&&!y.value.showUncheckedIn||ee&&!y.value.showPartiallyCheckedIn||de&&!y.value.showFullyCheckedIn)return!1;const re=K.areaIds||K.AreaIds||[];return!(a.areas.length>0&&re.length>0&&(!y.value.selectedAreaIds||y.value.selectedAreaIds.length===0||!re.some(et=>y.value.selectedAreaIds.includes(et))))}):a.locations),_=G(()=>a.showFilters?y.value.showRoute?a.route:[]:a.route),w=G(()=>a.showFilters?y.value.selectedAreaIds&&y.value.selectedAreaIds.length>0?a.areas.filter(K=>y.value.selectedAreaIds.includes(K.id)):a.areas.length>0?[]:a.areas:a.areas),S=G(()=>a.mode==="select-point"?!0:a.mode==="draw-polygon"?f.value>=3:!0),A=()=>d.value?l.value:i.value,T=()=>{d.value=!0,s("fullscreen-change",!0)},x=()=>{d.value=!1,s("fullscreen-change",!1)},P=()=>{if(a.mode==="draw-polygon"){const K=A();K&&K.clearPolygonDrawing(),f.value=0,p.value=!1,g.value=!1}d.value=!1,s("fullscreen-cancel"),s("fullscreen-change",!1)},O=()=>{if(a.mode==="draw-polygon"&&f.value>=3){const K=A();K&&K.completePolygon()}d.value=!1,s("fullscreen-done"),s("fullscreen-change",!1)},F=K=>{y.value=K,s("filter-change",K)},E=K=>{a.mode==="select-point"&&s("point-selected",K),s("map-click",K)},N=K=>{f.value=K?.length||0,R(),s("polygon-drawing",K)},D=K=>{s("polygon-complete",K),f.value=0,p.value=!1,g.value=!1},j=K=>{s("polygon-update",K)},R=()=>{const K=A();K&&(p.value=K.canUndo?K.canUndo():!1,g.value=K.canRedo?K.canRedo():!1)},W=()=>{const K=A();K&&K.undoPolygonPoint&&(K.undoPolygonPoint(),R())},ne=()=>{const K=A();K&&K.redoPolygonPoint&&(K.redoPolygonPoint(),R())};return t({getMapCenter:()=>A()?.getMapCenter?.(),getMapZoom:()=>A()?.getMapZoom?.(),undoPolygonPoint:W,redoPolygonPoint:ne,canUndo:()=>p.value,canRedo:()=>g.value,getPolygonPointCount:()=>f.value,completePolygon:()=>A()?.completePolygon?.(),clearPolygonDrawing:()=>{A()?.clearPolygonDrawing?.(),f.value=0,p.value=!1,g.value=!1},recenterOnUserLocation:()=>A()?.recenterOnUserLocation?.(),recenterOnLocation:(K,Q,he)=>A()?.recenterOnLocation?.(K,Q,he),isLocationInView:(K,Q)=>A()?.isLocationInView?.(K,Q)??!0,getUserLocationInView:()=>A()?.userLocationInView?.value??!0,getHighlightedLocationInView:()=>A()?.highlightedLocationInView?.value??!0,openFullscreen:()=>{d.value=!0,s("fullscreen-change",!0)},closeFullscreen:x,closeDropdowns:()=>{u.value&&u.value.closeDropdowns()}}),(K,Q)=>(v(),m("div",{class:"common-map",style:Qe({height:e.height})},[r("div",V0,[Ae(Tu,{ref_key:"mapViewRef",ref:i,locations:k.value,route:_.value,areas:w.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:Q[0]||(Q[0]=he=>K.$emit("location-click",he)),onMapClick:E,onAreaClick:Q[1]||(Q[1]=he=>K.$emit("area-click",he)),onPolygonComplete:D,onPolygonDrawing:N,onPolygonUpdate:j,onVisibilityChange:Q[2]||(Q[2]=he=>K.$emit("visibility-change",he))},null,8,["locations","route","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Ae($0,{ref_key:"toolbarRef",ref:u,"show-fullscreen":e.showFullscreen,"show-filters":e.showFilters,filters:y.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFullscreenClick:T,onFilterChange:F,onActionClick:Q[3]||(Q[3]=he=>K.$emit("action-click",he))},null,8,["show-fullscreen","show-filters","filters","areas","actions","position"]),Ae(of,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":p.value,"can-redo":g.value,onUndo:W,onRedo:ne},null,8,["show","point-count","can-undo","can-redo"])]),Ae(H0,{show:d.value,mode:e.mode,title:e.fullscreenTitle,description:e.fullscreenDescription,"can-complete":S.value,"header-style":e.fullscreenHeaderStyle,"header-text-color":e.fullscreenHeaderTextColor,onDone:O,onCancel:P,onClose:x},{actions:ze(()=>[io(K.$slots,"fullscreen-actions",{},void 0,!0)]),banner:ze(()=>[io(K.$slots,"fullscreen-banner",{},void 0,!0)]),footer:ze(()=>[io(K.$slots,"fullscreen-footer",{},void 0,!0)]),default:ze(()=>[r("div",G0,[Ae(Tu,{ref_key:"fullscreenMapViewRef",ref:l,locations:k.value,route:_.value,areas:w.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:Q[4]||(Q[4]=he=>K.$emit("location-click",he)),onMapClick:E,onAreaClick:Q[5]||(Q[5]=he=>K.$emit("area-click",he)),onPolygonComplete:D,onPolygonDrawing:N,onPolygonUpdate:j,onVisibilityChange:Q[6]||(Q[6]=he=>K.$emit("visibility-change",he))},null,8,["locations","route","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Ae(of,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":p.value,"can-redo":g.value,onUndo:W,onRedo:ne},null,8,["show","point-count","can-undo","can-redo"])])]),_:3},8,["show","mode","title","description","can-complete","header-style","header-text-color"])],4))}},li=je(j0,[["__scopeId","data-v-d6bcac0e"]]),Z0={class:"course-areas-tab"},q0={__name:"CourseAreasTab",props:{checkpoints:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1}},emits:["map-click","location-click","area-click","import-checkpoints","upload-route","select-location","add-area","select-area","polygon-complete","cancel-drawing","add-checkpoint-from-map","add-many-checkpoints-from-map","add-area-from-map"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=ht(),i=e,l=o,u=$(null),d=$(null),f=$(0),p=$({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]}),g=G(()=>[{id:"add",icon:"plus",label:"Add",items:[{id:"checkpoint",label:a.value.checkpoint},{id:"many-checkpoints",label:`Many ${s.value.checkpoints}`},{id:"area",label:a.value.area},{id:"import",label:`Import ${s.value.checkpoints}...`},{id:"upload",label:`Upload ${s.value.course}...`}]}]),y=({actionId:T,itemId:x})=>{T==="add"&&(x==="checkpoint"?(l("add-checkpoint-from-map"),w()):x==="many-checkpoints"?(l("add-many-checkpoints-from-map"),w()):x==="area"?(l("add-area-from-map"),w()):x==="import"?l("import-checkpoints"):x==="upload"&&l("upload-route"))},k=T=>{p.value=T},_=T=>{f.value=T?.length||0},w=()=>{u.value&&u.value.scrollIntoView({behavior:"smooth",block:"start"})};return t({scrollMapIntoView:w,getMapCenter:()=>d.value?.getMapCenter()||null,getMapZoom:()=>d.value?.getMapZoom()||null}),qe(()=>i.areas,T=>{if(T.length>0){const x=new Set(p.value.selectedAreaIds);T.forEach(P=>{x.has(P.id)||p.value.selectedAreaIds.push(P.id)}),p.value.selectedAreaIds=p.value.selectedAreaIds.filter(P=>T.some(O=>O.id===P))}},{immediate:!0}),qe(()=>i.drawingMode,T=>{T||(f.value=0)}),(T,x)=>(v(),m("div",Z0,[r("div",{class:"map-section",ref_key:"mapSection",ref:u},[Ae(li,{ref_key:"commonMapRef",ref:d,locations:e.checkpoints,route:e.route,areas:e.areas,"all-locations-for-bounds":e.checkpoints,"selected-area-id":e.selectedAreaId,clickable:!0,mode:e.drawingMode?"draw-polygon":"view",height:"100%","show-filters":"",filters:p.value,"toolbar-actions":g.value,"fullscreen-title":e.drawingMode?`Draw ${B(s).area} boundary`:B(a).course,"fullscreen-description":e.drawingMode?"Click on the map to draw the boundary":"",onMapClick:x[0]||(x[0]=P=>T.$emit("map-click",P)),onLocationClick:x[1]||(x[1]=P=>T.$emit("location-click",P)),onAreaClick:x[2]||(x[2]=P=>T.$emit("area-click",P)),onPolygonComplete:x[3]||(x[3]=P=>T.$emit("polygon-complete",P)),onPolygonDrawing:_,onFilterChange:k,onActionClick:y},null,8,["locations","route","areas","all-locations-for-bounds","selected-area-id","mode","filters","toolbar-actions","fullscreen-title","fullscreen-description"])],512)]))}},W0=je(q0,[["__scopeId","data-v-c0e54ae9"]]),K0=(e,t)=>{const o=String(e).trim(),a=String(t).trim(),s=parseFloat(o),i=parseFloat(a),l=!isNaN(s)&&String(s)===o,u=!isNaN(i)&&String(i)===a;return l&&u?s-i:o.localeCompare(a,void 0,{numeric:!0,sensitivity:"base"})},J0={__name:"StatusPill",props:{variant:{type:String,default:"neutral",validator:e=>["neutral","success","warning","danger","info","purple"].includes(e)},active:{type:Boolean,default:!1}},emits:["click"],setup(e){return(t,o)=>(v(),m("button",{class:ce(["status-pill",[e.variant,{active:e.active}]]),onClick:o[0]||(o[0]=a=>t.$emit("click"))},[io(t.$slots,"default",{},void 0)],2))}},xn=je(J0,[["__scopeId","data-v-a94deea5"]]),Y0={class:"check-in-toggle-container"},X0=["disabled"],Q0={key:0,class:"toggle-spinner"},ew={key:1,class:"toggle-icon"},tw={class:"toggle-label"},nw={key:0,class:"check-in-details"},ow={key:0,class:"check-in-method"},sw={__name:"CheckInToggleButton",props:{isCheckedIn:{type:Boolean,default:!1},checkInTime:{type:String,default:null},checkInMethod:{type:String,default:null},checkedInBy:{type:String,default:null},marshalName:{type:String,default:null},isLoading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["toggle"],setup(e){const t=e,o=G(()=>t.isLoading?t.isCheckedIn?"Checking out...":"Checking in...":t.isCheckedIn?"Checked in":"Check in"),a=G(()=>{const{checkedInBy:i,checkInMethod:l,marshalName:u}=t;return i&&i!==u?i:l||""}),s=i=>i?new Date(i).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"";return(i,l)=>(v(),m("div",Y0,[r("button",{class:ce(["check-in-toggle",{"is-checked-in":e.isCheckedIn}]),disabled:e.disabled||e.isLoading,onClick:l[0]||(l[0]=u=>i.$emit("toggle"))},[e.isLoading?(v(),m("span",Q0)):e.isCheckedIn?(v(),m("span",ew,"")):M("",!0),r("span",tw,C(o.value),1)],10,X0),e.isCheckedIn&&e.checkInTime&&!e.isLoading?(v(),m("span",nw,[Ye(C(s(e.checkInTime))+" ",1),a.value?(v(),m("span",ow,"("+C(a.value)+")",1)):M("",!0)])):M("",!0)]))}},Hr=je(sw,[["__scopeId","data-v-95f8f1cc"]]),aw={class:"marshals-tab"},iw={class:"tab-header"},lw={class:"button-group"},rw={key:0,class:"status-pills"},cw={class:"filters-section"},uw={class:"search-group"},dw={class:"marshals-grid"},hw={class:"marshals-table"},fw={key:0,class:"sort-indicator"},pw={key:0,class:"sort-indicator"},vw={key:0,class:"sort-indicator"},mw={key:0,class:"sort-indicator"},gw=["onClick"],yw=["rowspan"],kw={class:"checkpoint-cell"},_w={class:"checkpoint-name"},bw={key:0,class:"checkpoint-description"},ww=["rowspan"],Cw={key:0,class:"last-active-text"},Lw={key:1,class:"last-active-never"},Sw=["onClick"],xw={class:"no-checkpoint-text"},Iw={class:"hide-on-mobile last-active-cell"},$w={key:0,class:"last-active-text"},Tw={key:1,class:"last-active-never"},Mw={__name:"MarshalsTab",props:{marshals:{type:Array,required:!0},assignments:{type:Array,required:!0},locations:{type:Array,required:!0}},emits:["add-marshal","import-marshals","select-marshal","delete-marshal","toggle-check-in"],setup(e,{expose:t,emit:o}){const{terms:a}=ht(),s=e,i=$(null);t({setCheckingIn:j=>{i.value=j}});const u=$("name"),d=$("asc"),f=$(""),p=$("all"),g=j=>{p.value=j},y=j=>{u.value===j?d.value=d.value==="asc"?"desc":"asc":(u.value=j,d.value="asc")},k=j=>s.assignments.filter(R=>R.marshalId===j),_=G(()=>new Set(s.assignments.filter(j=>j.isCheckedIn).map(j=>j.marshalId))),w=G(()=>new Set(s.assignments.map(j=>j.marshalId))),S=G(()=>_.value.size),A=G(()=>s.marshals.filter(j=>!w.value.has(j.id)).length),T=G(()=>s.marshals.filter(j=>w.value.has(j.id)&&!_.value.has(j.id)).length),x=j=>s.locations.find(R=>R.id===j),P=j=>{const R=x(j);return R?R.name:"Unknown"},O=j=>{const R=x(j);return R?R.description:""},F=j=>{const R=s.marshals.find(W=>W.id===j);return R?R.name:""},E=j=>{if(!j)return"";const R=new Date(j),ne=new Date-R,ue=Math.floor(ne/6e4),K=Math.floor(ue/60),Q=Math.floor(K/24);return ue<1?"just now":ue<60?`${ue}m ago`:K<24?`${K}h ago`:Q===1?"yesterday":Q<7?`${Q}d ago`:R.toLocaleDateString()},N=G(()=>{let j=s.marshals;if(p.value==="unassigned"?j=j.filter(R=>!w.value.has(R.id)):p.value==="checked-in"?j=j.filter(R=>_.value.has(R.id)):p.value==="not-checked-in"&&(j=j.filter(R=>w.value.has(R.id)&&!_.value.has(R.id))),f.value.trim()){const R=f.value.toLowerCase().trim().split(/\s+/);j=j.filter(W=>{const ue=k(W.id).map(Q=>{const he=x(Q.locationId);return he?`${he.name||""} ${he.description||""}`:""}).join(" "),K=`${W.name} ${ue}`.toLowerCase();return R.every(Q=>K.includes(Q))})}return j}),D=G(()=>{const j=[...N.value];return j.sort((R,W)=>{let ne=0;if(u.value==="name")ne=R.name.localeCompare(W.name);else if(u.value==="checkpoint"){const ue=k(R.id),K=k(W.id),Q=ue.length>0?P(ue[0].locationId):"",he=K.length>0?P(K[0].locationId):"";ne=K0(Q,he)}else if(u.value==="status"){const ue=k(R.id),K=k(W.id),Q=ue.length>0&&ue[0].isCheckedIn?1:0;ne=(K.length>0&&K[0].isCheckedIn?1:0)-Q}else if(u.value==="lastActive"){const ue=R.lastAccessedDate?new Date(R.lastAccessedDate).getTime():0;ne=(W.lastAccessedDate?new Date(W.lastAccessedDate).getTime():0)-ue}return d.value==="asc"?ne:-ne}),j});return(j,R)=>(v(),m("div",aw,[r("div",iw,[r("div",lw,[r("button",{onClick:R[0]||(R[0]=W=>j.$emit("add-marshal")),class:"btn btn-primary"}," Add "+C(B(a).person.toLowerCase()),1),r("button",{onClick:R[1]||(R[1]=W=>j.$emit("import-marshals")),class:"btn btn-secondary"}," Import CSV ")]),e.marshals.length>0?(v(),m("div",rw,[Ae(xn,{variant:"neutral",active:p.value==="all",onClick:R[2]||(R[2]=W=>g("all"))},{default:ze(()=>[Ye(C(e.marshals.length)+" total ",1)]),_:1},8,["active"]),A.value>0?(v(),Ze(xn,{key:0,variant:"warning",active:p.value==="unassigned",onClick:R[3]||(R[3]=W=>g("unassigned"))},{default:ze(()=>[Ye(C(A.value)+" unassigned ",1)]),_:1},8,["active"])):M("",!0),S.value>0?(v(),Ze(xn,{key:1,variant:"success",active:p.value==="checked-in",onClick:R[4]||(R[4]=W=>g("checked-in"))},{default:ze(()=>[Ye(C(S.value)+" checked in ",1)]),_:1},8,["active"])):M("",!0),T.value>0?(v(),Ze(xn,{key:2,variant:"danger",active:p.value==="not-checked-in",onClick:R[5]||(R[5]=W=>g("not-checked-in"))},{default:ze(()=>[Ye(C(T.value)+" not checked in ",1)]),_:1},8,["active"])):M("",!0)])):M("",!0)]),r("div",cw,[r("div",uw,[He(r("input",{"onUpdate:modelValue":R[6]||(R[6]=W=>f.value=W),type:"text",class:"search-input",placeholder:"Search by name, checkpoint, or description..."},null,512),[[st,f.value]])])]),r("div",dw,[r("table",hw,[r("thead",null,[r("tr",null,[r("th",{onClick:R[7]||(R[7]=W=>y("name")),class:"sortable"},[R[12]||(R[12]=Ye(" Name ",-1)),u.value==="name"?(v(),m("span",fw,C(d.value==="asc"?"":""),1)):M("",!0)]),r("th",{onClick:R[8]||(R[8]=W=>y("checkpoint")),class:"sortable"},[Ye(C(B(a).checkpoint)+" ",1),u.value==="checkpoint"?(v(),m("span",pw,C(d.value==="asc"?"":""),1)):M("",!0)]),r("th",{onClick:R[9]||(R[9]=W=>y("status")),class:"sortable"},[R[13]||(R[13]=Ye(" Status ",-1)),u.value==="status"?(v(),m("span",vw,C(d.value==="asc"?"":""),1)):M("",!0)]),r("th",{onClick:R[10]||(R[10]=W=>y("lastActive")),class:"sortable hide-on-mobile"},[R[14]||(R[14]=Ye(" Last active ",-1)),u.value==="lastActive"?(v(),m("span",mw,C(d.value==="asc"?"":""),1)):M("",!0)])])]),r("tbody",null,[(v(!0),m(Se,null,Ne(D.value,W=>(v(),m(Se,{key:W.id},[k(W.id).length>0?(v(!0),m(Se,{key:0},Ne(k(W.id),(ne,ue)=>(v(),m("tr",{key:`${W.id}-${ne.id}`,class:"marshal-row",onClick:K=>j.$emit("select-marshal",W)},[ue===0?(v(),m("td",{key:0,rowspan:k(W.id).length},C(W.name),9,yw)):M("",!0),r("td",kw,[r("div",_w,C(P(ne.locationId)),1),O(ne.locationId)?(v(),m("div",bw,C(O(ne.locationId)),1)):M("",!0)]),r("td",{onClick:R[11]||(R[11]=rt(()=>{},["stop"])),class:"check-in-cell"},[Ae(Hr,{"is-checked-in":ne.isCheckedIn,"check-in-time":ne.checkInTime,"check-in-method":ne.checkInMethod,"checked-in-by":ne.checkedInBy,"marshal-name":F(ne.marshalId),"is-loading":i.value===ne.id,onToggle:K=>j.$emit("toggle-check-in",ne)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"])]),ue===0?(v(),m("td",{key:1,rowspan:k(W.id).length,class:"hide-on-mobile last-active-cell"},[W.lastAccessedDate?(v(),m("span",Cw,C(E(W.lastAccessedDate)),1)):(v(),m("span",Lw,"Never"))],8,ww)):M("",!0)],8,gw))),128)):(v(),m("tr",{key:1,class:"marshal-row",onClick:ne=>j.$emit("select-marshal",W)},[r("td",null,C(W.name),1),r("td",xw,"No "+C(B(a).checkpoint.toLowerCase())+" assigned",1),R[15]||(R[15]=r("td",null,[r("span",{class:"hide-on-mobile"},"-"),r("span",{class:"status-icon show-on-mobile no-checkpoint-text"},"-")],-1)),r("td",Iw,[W.lastAccessedDate?(v(),m("span",$w,C(E(W.lastAccessedDate)),1)):(v(),m("span",Tw,"Never"))])],8,Sw))],64))),128))])])])]))}},Aw=je(Mw,[["__scopeId","data-v-c3a36b99"]]),Ew={class:"checklists-tab"},Pw={class:"checklists-tab-header"},Dw={class:"button-group"},Rw={class:"filters-section"},Ow={class:"search-group"},Bw=["placeholder"],Nw={class:"checklist-items-list"},Fw={key:0,class:"empty-state"},Uw={class:"checklist-item-content"},zw=["onClick"],Hw={class:"checklist-item-scopes"},Vw=["onClick"],Gw={__name:"ChecklistsTab",props:{checklistItems:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},completionReport:{type:Object,default:null}},emits:["add-checklist-item","select-checklist-item"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ht(),s=e,i=$(""),l=G(()=>{if(!i.value.trim())return s.checklistItems;const p=i.value.toLowerCase().trim().split(/\s+/);return s.checklistItems.filter(g=>{const y=(g.text||"").toLowerCase();return p.every(k=>y.includes(k))})}),u=G(()=>[...l.value].sort((p,g)=>p.displayOrder!==g.displayOrder?p.displayOrder-g.displayOrder:Vs(p.text,g.text))),d=p=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${a.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${a.value.checkpoints}`,SpecificPeople:`Specific ${a.value.people}`,OnePerArea:`One per ${a.value.area}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,EveryAreaLead:`Every ${a.value.area} lead`,OneLeadPerArea:`One lead per ${a.value.area}`,AreaLead:`${o.value.area} lead`})[p]||p,f=p=>{if(!p)return"";const g=d(p.scope);if(p.itemType===null)return g;const y=p.ids||[];if(y.includes("ALL_MARSHALS"))return`${g} (Everyone)`;if(y.includes("ALL_AREAS"))return`${g} (All ${a.value.areas})`;if(y.includes("ALL_CHECKPOINTS"))return`${g} (All ${a.value.checkpoints})`;const k=y.length;return k===0?g:`${g} (${k})`};return(p,g)=>(v(),m("div",Ew,[r("div",Pw,[r("div",Dw,[r("button",{onClick:g[0]||(g[0]=y=>p.$emit("add-checklist-item")),class:"btn btn-primary"}," Add "+C(B(a).checklist),1)])]),r("div",Rw,[r("div",Ow,[He(r("input",{"onUpdate:modelValue":g[1]||(g[1]=y=>i.value=y),type:"text",class:"search-input",placeholder:`Search ${B(a).checklists}...`},null,8,Bw),[[st,i.value]])])]),r("div",Nw,[l.value.length===0?(v(),m("div",Fw,[r("p",null,C(i.value?`No ${B(a).checklists} match your search.`:`No ${B(a).checklists} yet. Create one to get started!`),1)])):M("",!0),(v(!0),m(Se,null,Ne(u.value,y=>(v(),m("div",{key:y.itemId,class:"checklist-item-card"},[r("div",Uw,[r("div",{class:"checklist-item-title",onClick:k=>p.$emit("select-checklist-item",y,"details")},[r("strong",null,C(y.text),1)],8,zw),r("div",Hw,[(v(!0),m(Se,null,Ne(y.scopeConfigurations,(k,_)=>(v(),m("span",{key:_,class:"scope-badge",onClick:w=>p.$emit("select-checklist-item",y,"visibility")},C(f(k)),9,Vw))),128))])])]))),128))])]))}},jw=je(Gw,[["__scopeId","data-v-123b7338"]]),Zw={class:"notes-tab"},qw={class:"tab-header"},Ww={class:"button-group"},Kw={class:"filters-section"},Jw={class:"search-group"},Yw={class:"notes-list"},Xw={key:0,class:"empty-state"},Qw=["onClick"],eC={class:"note-header"},tC={class:"note-title-row"},nC={key:0,class:"pin-icon",title:"Pinned"},oC={class:"note-meta"},sC={key:0,class:"category-badge"},aC={class:"created-info"},iC={key:0,class:"note-preview"},lC={class:"note-scopes"},rC={__name:"NotesTab",props:{notes:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["add-note","select-note"],setup(e,{emit:t}){const{termsLower:o}=ht(),a=e,s=$(""),i=G(()=>{if(!s.value.trim())return a.notes;const g=s.value.toLowerCase().trim().split(/\s+/);return a.notes.filter(y=>{const k=`${y.title||""} ${y.content||""} ${y.priority||""}`.toLowerCase();return g.every(_=>k.includes(_))})}),l=G(()=>{const g={Urgent:0,High:1,Normal:2,Low:3};return[...i.value].sort((y,k)=>{if(y.isPinned!==k.isPinned)return y.isPinned?-1:1;const _=g[y.priority]??2,w=g[k.priority]??2;return _!==w?_-w:y.displayOrder!==k.displayOrder?y.displayOrder-k.displayOrder:Vs(y.title,k.title)})}),u=g=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${o.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${o.value.checkpoints}`,SpecificPeople:`Specific ${o.value.people}`,EveryAreaLead:`Every ${o.value.area} lead`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,OnePerArea:`One per ${o.value.area}`,OneLeadPerArea:`One lead per ${o.value.area}`})[g]||g,d=g=>{if(!g)return"";const y=u(g.scope);if(g.itemType===null)return y;const k=g.ids||[];if(k.includes("ALL_MARSHALS"))return`${y} (Everyone)`;if(k.includes("ALL_AREAS"))return`${y} (All ${o.value.areas})`;if(k.includes("ALL_CHECKPOINTS"))return`${y} (All ${o.value.checkpoints})`;const _=k.length;return _===0?y:`${y} (${_})`},f=g=>{if(!g)return"";const y=150;return g.length<=y?g:g.substring(0,y)+"..."},p=g=>{if(!g)return"";const y=new Date(g),_=new Date-y,w=Math.floor(_/6e4),S=Math.floor(_/36e5),A=Math.floor(_/864e5);return w<1?"Just now":w<60?`${w}m ago`:S<24?`${S}h ago`:A<7?`${A}d ago`:y.toLocaleDateString()};return(g,y)=>(v(),m("div",Zw,[r("div",qw,[r("div",Ww,[r("button",{onClick:y[0]||(y[0]=k=>g.$emit("add-note")),class:"btn btn-primary"}," Add note ")])]),r("div",Kw,[r("div",Jw,[He(r("input",{"onUpdate:modelValue":y[1]||(y[1]=k=>s.value=k),type:"text",class:"search-input",placeholder:"Search by title, content, or priority..."},null,512),[[st,s.value]])])]),r("div",Yw,[i.value.length===0?(v(),m("div",Xw,[r("p",null,C(s.value?"No notes match your search.":"No notes yet. Create one to get started!"),1)])):M("",!0),(v(!0),m(Se,null,Ne(l.value,k=>(v(),m("div",{key:k.noteId,class:ce(["note-card",{pinned:k.isPinned}]),onClick:_=>g.$emit("select-note",k)},[r("div",eC,[r("div",tC,[k.isPinned?(v(),m("span",nC,"")):M("",!0),r("span",{class:ce(["priority-indicator",k.priority?.toLowerCase()||"normal"])},null,2),r("strong",null,C(k.title),1)]),r("div",oC,[k.category?(v(),m("span",sC,C(k.category),1)):M("",!0),r("span",aC,C(p(k.createdAt)),1)])]),k.content?(v(),m("div",iC,C(f(k.content)),1)):M("",!0),r("div",lC,[(v(!0),m(Se,null,Ne(k.scopeConfigurations,(_,w)=>(v(),m("span",{key:w,class:"scope-badge"},C(d(_)),1))),128))])],10,Qw))),128))])]))}},cC=je(rC,[["__scopeId","data-v-6449d7cc"]]),uC={key:0,class:"empty-state"},dC={key:0,class:"empty-hint"},hC={__name:"CardsGrid",props:{isEmpty:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No items."},emptyHint:{type:String,default:""},gridClass:{type:String,default:""}},setup(e){return(t,o)=>e.isEmpty?(v(),m("div",uC,[r("p",null,C(e.emptyMessage),1),e.emptyHint?(v(),m("p",dC,C(e.emptyHint),1)):M("",!0)])):(v(),m("div",{key:1,class:ce(["cards-grid",e.gridClass])},[io(t.$slots,"default",{},void 0)],2))}},Zl=je(hC,[["__scopeId","data-v-a842b7b1"]]),fC={class:"contact-card-header"},pC={class:"contact-name-row"},vC={key:0,class:"primary-badge",title:"Primary contact"},mC={class:"contact-name"},gC={key:0,class:"contact-role"},yC={key:0,class:"no-scope-warning",title:"This contact has no visibility scope configured"},kC=["title"],_C={key:0,class:"contact-card-details"},bC={key:0,class:"contact-phone"},wC={key:1,class:"contact-email"},CC={key:1,class:"contact-card-notes"},LC={key:2,class:"contact-card-scopes"},SC={key:3,class:"contact-card-badge"},xC={key:4,class:"contact-card-badge"},IC={__name:"ContactCard",props:{contact:{type:Object,required:!0},isPending:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:String,default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},clickable:{type:Boolean,default:!0}},emits:["click","remove","undo-remove"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ht(),s=e,i=t,l=G(()=>{const y=s.contact.scopeConfigurations;return!y||y.length===0}),u=()=>{s.clickable&&!s.isPending&&!s.isMarkedForRemoval&&i("click",s.contact)},d=y=>y?y==="AreaLead"?`${o.value.area} Lead`:y.replace(/([A-Z])/g," $1").replace(/^./,k=>k.toUpperCase()).trim():"",f=y=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${a.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${a.value.checkpoints}`,SpecificPeople:`Specific ${a.value.people}`,EveryAreaLead:`Every ${a.value.area} lead`})[y]||y,p=y=>{if(!y)return"";const k=f(y.scope);if(y.itemType===null)return k;const _=y.ids||[];if(_.includes("ALL_MARSHALS"))return`${k} (Everyone)`;if(_.includes("ALL_AREAS"))return`${k} (All ${a.value.areas})`;if(_.includes("ALL_CHECKPOINTS"))return`${k} (All ${a.value.checkpoints})`;const w=_.length;return w===0?k:`${k} (${w})`},g=y=>{if(!y)return"";const k=100;return y.length<=k?y:y.substring(0,k)+"..."};return(y,k)=>(v(),m("div",{class:ce(["contact-card",{"is-pending":e.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-primary":e.contact.isPrimary&&!e.isMarkedForRemoval,"is-clickable":e.clickable&&!e.isMarkedForRemoval}]),onClick:u},[r("div",fC,[r("div",{class:ce(["contact-card-title",{clickable:e.clickable&&!e.isMarkedForRemoval}])},[r("div",pC,[e.contact.isPrimary&&!e.isMarkedForRemoval?(v(),m("span",vC,"")):M("",!0),r("span",mC,C(e.contact.name),1)]),e.contact.role?(v(),m("span",gC,C(d(e.contact.role)),1)):M("",!0)],2),l.value&&!e.isMarkedForRemoval&&!e.isPending?(v(),m("span",yC,"!")):M("",!0),e.showRemoveButton&&!e.isMarkedForRemoval?(v(),m("button",{key:1,type:"button",class:"contact-remove-btn",title:e.removeTitle,onClick:k[0]||(k[0]=rt(_=>y.$emit("remove",e.contact.contactId),["stop"]))},"  ",8,kC)):M("",!0),e.isMarkedForRemoval?(v(),m("button",{key:2,type:"button",class:"contact-undo-btn",title:"Cancel removal",onClick:k[1]||(k[1]=rt(_=>y.$emit("undo-remove",e.contact.contactId),["stop"]))}," Undo ")):M("",!0)]),e.contact.phone||e.contact.email?(v(),m("div",_C,[e.contact.phone?(v(),m("span",bC,C(e.contact.phone),1)):M("",!0),e.contact.email?(v(),m("span",wC,C(e.contact.email),1)):M("",!0)])):M("",!0),e.contact.notes&&e.showNotes?(v(),m("div",CC,C(g(e.contact.notes)),1)):M("",!0),e.showScopes&&e.contact.scopeConfigurations?.length>0&&!e.isMarkedForRemoval?(v(),m("div",LC,[(v(!0),m(Se,null,Ne(e.contact.scopeConfigurations,(_,w)=>(v(),m("span",{key:w,class:"scope-badge"},C(p(_)),1))),128))])):M("",!0),e.isPending?(v(),m("div",SC,[...k[2]||(k[2]=[r("span",{class:"pending-indicator"},"Will be added on save",-1)])])):M("",!0),e.isMarkedForRemoval?(v(),m("div",xC,[...k[3]||(k[3]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):M("",!0)],2))}},$C=je(IC,[["__scopeId","data-v-86c5c2b6"]]),Zv={__name:"ContactsGrid",props:{contacts:{type:Array,required:!0},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:[String,Function],default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No contacts."},emptyHint:{type:String,default:""}},emits:["select","remove","undo-remove"],setup(e){const t=e,o=s=>typeof t.removeTitle=="function"?t.removeTitle(s):t.removeTitle,a=s=>!s.isPending;return(s,i)=>(v(),Ze(Zl,{"is-empty":e.contacts.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:ze(()=>[(v(!0),m(Se,null,Ne(e.contacts,l=>(v(),Ze($C,{key:l.contactId,contact:l,"is-pending":l.isPending,"is-marked-for-removal":l.isMarkedForRemoval,"show-remove-button":e.showRemoveButton,"remove-title":o(l),"show-notes":e.showNotes,"show-scopes":e.showScopes,clickable:a(l),onClick:u=>s.$emit("select",l),onRemove:i[0]||(i[0]=u=>s.$emit("remove",u)),onUndoRemove:i[1]||(i[1]=u=>s.$emit("undo-remove",u))},null,8,["contact","is-pending","is-marked-for-removal","show-remove-button","remove-title","show-notes","show-scopes","clickable","onClick"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},TC={class:"contacts-tab"},MC={class:"tab-header"},AC={class:"button-group"},EC={key:0,class:"status-pills"},PC={class:"filters-section"},DC={class:"search-group"},RC={__name:"ContactsTab",props:{contacts:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})}},emits:["add-contact","select-contact"],setup(e,{emit:t}){const o=e,a=$(""),s=$("all"),i=G(()=>o.contacts.filter(k=>!k.scopeConfigurations||k.scopeConfigurations.length===0).length),l=G(()=>o.contacts.filter(k=>k.scopeConfigurations&&k.scopeConfigurations.length>0).length),u=k=>{s.value=k},d=k=>k?k.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",f=k=>k?k.replace(/([A-Z])/g," $1").replace(/^./,_=>_.toUpperCase()).trim():"",p=G(()=>{let k=o.contacts;if(s.value==="no-scope"?k=k.filter(_=>!_.scopeConfigurations||_.scopeConfigurations.length===0):s.value==="with-scope"&&(k=k.filter(_=>_.scopeConfigurations&&_.scopeConfigurations.length>0)),a.value.trim()){const w=d(a.value).split(" ").filter(S=>S.length>0);k=k.filter(S=>{const A=f(S.role),T=d(`${S.name||""} ${A} ${S.email||""} ${S.phone||""}`);return w.every(x=>T.includes(x))})}return k}),g=G(()=>[...p.value].sort((k,_)=>(k.name||"").localeCompare(_.name||"",void 0,{sensitivity:"base"}))),y=G(()=>{const k=a.value.trim();return s.value==="no-scope"?k?"No unassigned contacts match your search.":"All contacts are assigned.":s.value==="with-scope"?k?"No assigned contacts match your search.":"No contacts are assigned yet.":k?"No contacts match your search.":"No contacts yet. Create one to get started!"});return(k,_)=>(v(),m("div",TC,[r("div",MC,[r("div",AC,[r("button",{onClick:_[0]||(_[0]=w=>k.$emit("add-contact")),class:"btn btn-primary"}," Add contact ")]),e.contacts.length>0?(v(),m("div",EC,[Ae(xn,{variant:"neutral",active:s.value==="all",onClick:_[1]||(_[1]=w=>u("all"))},{default:ze(()=>[Ye(C(e.contacts.length)+" total ",1)]),_:1},8,["active"]),l.value>0?(v(),Ze(xn,{key:0,variant:"success",active:s.value==="with-scope",onClick:_[2]||(_[2]=w=>u("with-scope"))},{default:ze(()=>[Ye(C(l.value)+" assigned ",1)]),_:1},8,["active"])):M("",!0),i.value>0?(v(),Ze(xn,{key:1,variant:"danger",active:s.value==="no-scope",onClick:_[3]||(_[3]=w=>u("no-scope"))},{default:ze(()=>[Ye(C(i.value)+" unassigned ",1)]),_:1},8,["active"])):M("",!0)])):M("",!0)]),r("div",PC,[r("div",DC,[He(r("input",{"onUpdate:modelValue":_[4]||(_[4]=w=>a.value=w),type:"text",class:"search-input",placeholder:"Search by name, role, email, or phone..."},null,512),[[st,a.value]])])]),Ae(Zv,{contacts:g.value,"show-notes":!0,"show-scopes":!0,"empty-message":y.value,onSelect:_[5]||(_[5]=w=>k.$emit("select-contact",w))},null,8,["contacts","empty-message"])]))}},OC=je(RC,[["__scopeId","data-v-ca4b1b77"]]),qv=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET/CEST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Australia/Sydney",label:"Sydney (AEDT/AEST)"}],BC={class:"event-details-tab"},NC={class:"event-info-card"},FC={class:"form-group"},UC={class:"form-group"},zC={class:"form-row"},HC={class:"form-group"},VC={class:"form-group"},GC=["value"],jC={class:"form-actions"},ZC=["disabled"],qC={__name:"EventDetailsTab",props:{eventData:{type:Object,required:!0},formDirty:{type:Boolean,default:!1}},emits:["submit","update:formDirty"],setup(e,{emit:t}){const o=e,a=t,s=$({...o.eventData});qe(()=>o.eventData,u=>{s.value={...u}},{deep:!0});const i=()=>{a("update:formDirty",!0)},l=()=>{a("submit",{...s.value})};return(u,d)=>(v(),m("div",BC,[r("div",NC,[r("form",{onSubmit:rt(l,["prevent"]),class:"event-details-form"},[r("div",FC,[d[4]||(d[4]=r("label",null,"Event name",-1)),He(r("input",{"onUpdate:modelValue":d[0]||(d[0]=f=>s.value.name=f),type:"text",required:"",class:"form-input",onInput:i},null,544),[[st,s.value.name]])]),r("div",UC,[d[5]||(d[5]=r("label",null,"Description",-1)),He(r("textarea",{"onUpdate:modelValue":d[1]||(d[1]=f=>s.value.description=f),rows:"3",class:"form-input",onInput:i},null,544),[[st,s.value.description]])]),r("div",zC,[r("div",HC,[d[6]||(d[6]=r("label",null,"Event date & time",-1)),He(r("input",{"onUpdate:modelValue":d[2]||(d[2]=f=>s.value.eventDate=f),type:"datetime-local",required:"",class:"form-input",onInput:i},null,544),[[st,s.value.eventDate]])]),r("div",VC,[d[7]||(d[7]=r("label",null,"Time zone",-1)),He(r("select",{"onUpdate:modelValue":d[3]||(d[3]=f=>s.value.timeZoneId=f),required:"",class:"form-input",onChange:i},[(v(!0),m(Se,null,Ne(B(qv),f=>(v(),m("option",{key:f.value,value:f.value},C(f.label),9,GC))),128))],544),[[Fn,s.value.timeZoneId]])])]),r("div",jC,[r("button",{type:"submit",class:"btn btn-save",disabled:!e.formDirty}," Save ",8,ZC)])],32)])]))}},WC=je(qC,[["__scopeId","data-v-2754c3cc"]]),KC={class:"admins-list"},JC={class:"admin-info"},YC={class:"admin-role"},XC=["onClick"],QC={__name:"AdminsList",props:{admins:{type:Array,required:!0}},emits:["add-admin","remove-admin"],setup(e){return(t,o)=>(v(),m("div",null,[r("button",{onClick:o[0]||(o[0]=a=>t.$emit("add-admin")),class:"btn btn-small btn-primary"}," Add administrator "),r("div",KC,[(v(!0),m(Se,null,Ne(e.admins,a=>(v(),m("div",{key:a.userEmail,class:"admin-item"},[r("div",JC,[r("strong",null,C(a.userEmail),1),r("span",YC,C(a.role),1)]),e.admins.length>1?(v(),m("button",{key:0,onClick:s=>t.$emit("remove-admin",a.userEmail),class:"btn btn-small btn-danger"}," Remove ",8,XC)):M("",!0)]))),128))])]))}},e2=je(QC,[["__scopeId","data-v-e526860b"]]),Pn=[{name:"Charcoal",hex:"#2d3748"},{name:"Dark Gray",hex:"#4a5568"},{name:"Gray",hex:"#718096"},{name:"Red",hex:"#f56565"},{name:"Coral",hex:"#ff6b6b"},{name:"Rose",hex:"#fb7185"},{name:"Pink",hex:"#ed64a6"},{name:"Magenta",hex:"#d946ef"},{name:"Fuchsia",hex:"#e879f9"},{name:"Purple",hex:"#9f7aea"},{name:"Violet",hex:"#a78bfa"},{name:"Lavender",hex:"#b197fc"},{name:"Indigo",hex:"#5a67d8"},{name:"Navy",hex:"#4263eb"},{name:"Blue",hex:"#667eea"},{name:"Sky",hex:"#0ea5e9"},{name:"Cyan",hex:"#0bc5ea"},{name:"Aqua",hex:"#22d3ee"},{name:"Teal",hex:"#38b2ac"},{name:"Emerald",hex:"#10b981"},{name:"Green",hex:"#48bb78"},{name:"Mint",hex:"#51cf66"},{name:"Lime",hex:"#84cc16"},{name:"Olive",hex:"#a3b18a"},{name:"Yellow",hex:"#ecc94b"},{name:"Amber",hex:"#f59e0b"},{name:"Orange",hex:"#ed8936"},{name:"Peach",hex:"#ff922b"},{name:"Light Gray",hex:"#cbd5e0"},{name:"Silver",hex:"#e2e8f0"},{name:"Cream",hex:"#f7fafc"}],wr="#667eea";function t2(e){const t=e.map(a=>a.color);return Pn.find(a=>!t.includes(a.hex))?.hex||wr}const n2={class:"modal-content"},o2={class:"modal-body"},s2={class:"preview-section"},a2={class:"map-preview"},i2=["innerHTML"],l2={class:"options-grid"},r2={class:"option-button-content"},c2={class:"option-button-value icon-value"},u2=["innerHTML"],d2={class:"option-button-content"},h2={class:"option-button-value color-value"},f2=["disabled"],p2={class:"option-button-content"},v2={class:"option-button-value color-value"},m2={class:"option-button-content"},g2={class:"option-button-value icon-value"},y2=["innerHTML"],k2=["disabled"],_2={class:"option-button-content"},b2={class:"option-button-value color-value"},w2={class:"option-button-content"},C2={class:"option-button-value"},L2={class:"option-button-content"},S2={class:"option-button-value"},x2={key:0,class:"centered-popup"},I2={class:"popup-grid"},$2=["onClick"],T2=["innerHTML"],M2={key:0},A2={key:1,class:"centered-popup"},E2={class:"popup-grid"},P2=["title","onClick"],D2=["innerHTML"],R2={key:0},O2={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},B2={key:1,class:"custom-check-mark"},N2={key:0,class:"custom-hex-input"},F2={class:"hex-input-row"},U2=["disabled"],z2={key:0,class:"hex-error"},H2={key:2,class:"centered-popup"},V2={class:"popup-grid"},G2=["title","onClick"],j2=["innerHTML"],Z2={key:0},q2={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},W2={key:1,class:"custom-check-mark"},K2={key:0,class:"custom-hex-input"},J2={class:"hex-input-row"},Y2=["disabled"],X2={key:0,class:"hex-error"},Q2={key:3,class:"centered-popup icon-popup"},eL={class:"popup-grid"},tL=["onClick"],nL=["innerHTML"],oL={key:0},sL={key:4,class:"centered-popup"},aL={class:"popup-grid"},iL=["title","onClick"],lL=["innerHTML"],rL={key:0},cL={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},uL={key:1,class:"custom-check-mark"},dL={key:0,class:"custom-hex-input"},hL={class:"hex-input-row"},fL=["disabled"],pL={key:0,class:"hex-error"},vL={key:5,class:"centered-popup"},mL={class:"size-grid"},gL=["onClick"],yL=["innerHTML"],kL={key:6,class:"centered-popup"},_L={class:"rotation-content"},bL={class:"rotation-preview-container"},wL=["innerHTML"],CL={class:"rotation-control"},LL={class:"rotation-slider-container"},SL=["value"],xL={class:"rotation-value"},IL={class:"rotation-presets"},$L="#667eea",TL={__name:"IconCustomizationModal",props:{isOpen:{type:Boolean,default:!1},iconType:{type:String,default:"none"},backgroundShape:{type:String,default:"circle"},backgroundColor:{type:String,default:""},borderColor:{type:String,default:""},iconColor:{type:String,default:""},size:{type:String,default:"100"},mapRotation:{type:[String,Number],default:""},level:{type:String,default:"checkpoint"},inheritedType:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""}},emits:["update:isOpen","apply","cancel"],setup(e,{emit:t}){const o=e,a=t,s=$(o.backgroundShape||"circle"),i=$(o.iconType||"none"),l=$(o.backgroundColor||""),u=$(o.borderColor||""),d=$(o.iconColor||""),f=$(o.size||"100"),p=$(o.mapRotation??""),g=$(null),y=$(!1),k=$(!1),_=$(!1),w=$(""),S=$(""),A=$(""),T=$(null),x=$(null),P=$(null),O=ae=>ae==="default"?o.inheritedBackgroundShape||"circle":ae==="none"?"none":ae||"circle",F=ae=>ae==="default"||!ae?U():ae==="none"?"transparent":ae,E=ae=>ae==="default"?o.inheritedBorderColor||"#ffffff":ae==="none"||!ae?"transparent":ae,N=ae=>{if(ae==="default"){const ie=o.inheritedType;return ie&&ie!=="default"&&oi(ie).category==="content"?ie:"none"}return ae==="none"||!ae?"none":ae},D=ae=>ae==="default"||!ae?o.inheritedIconColor||"#ffffff":ae==="none"?"transparent":ae,j=ae=>ae==="default"?o.inheritedSize||"100":ae||"100",R=ae=>{if(ae==="default"||ae===""){const ie=o.inheritedMapRotation;return ie!==""&&ie!==void 0&&ie!==null&&parseInt(ie,10)||0}return parseInt(ae,10)||0},W=G(()=>{const ae=o.inheritedBackgroundShape||"circle",ie=hr.find(ve=>ve.value===ae)?.label||"Circle";return[{value:"none",label:"None",showLabel:!0},{value:"default",label:`Default (${ie})`,showLabel:!0},...hr.filter(ve=>ve.value!=="none").map(ve=>({...ve,showLabel:!1}))]}),ne=G(()=>{const ae=zr.filter(ot=>ot.category==="content"),ie=[{value:"none",label:"None",category:"content",showLabel:!0}],ve=o.inheritedType;if(ve&&ve!=="default"){const ot=oi(ve);ot.category==="content"&&ie.push({value:"default",label:`Default (${ot.label||ve})`,category:"content",showLabel:!0})}return ie.push(...ae.map(ot=>({...ot,showLabel:!1}))),ie}),ue=G(()=>{const ae={33:"Small",66:"Medium",100:"Normal",150:"Large"};return[{value:"default",label:`Default (${ae[o.inheritedSize]||"Normal"})`},...zb.map(ve=>({value:ve.value,label:ae[ve.value]||ve.label}))]}),K=G(()=>O(s.value)!=="none"),Q=G(()=>N(i.value)!=="none"),he=G(()=>{const ae=o.inheritedBackgroundColor;return ae&&ae!=="default"&&ae.startsWith("#")?ae:$L}),U=()=>he.value,ee=G(()=>l.value&&l.value!=="default"?l.value:U()),de=G(()=>u.value==="none"?"transparent":u.value?u.value:o.inheritedBorderColor&&o.inheritedBorderColor!=="none"?o.inheritedBorderColor:"#ffffff"),re=G(()=>d.value?d.value:o.inheritedIconColor?o.inheritedIconColor:"#ffffff"),De=G(()=>{const ae=he.value,ie=Pn.find(ve=>ve.hex.toLowerCase()===ae.toLowerCase())?.name||"Custom";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ie})`,showLabel:!0},...Pn.map(ve=>({hex:ve.hex,name:ve.name,showLabel:!1}))]}),et=G(()=>{const ae=o.inheritedBorderColor||"#ffffff",ie=ae==="#ffffff"?"White":Pn.find(ve=>ve.hex===ae)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ie})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Pn.filter(ve=>ve.hex!=="#ffffff").map(ve=>({hex:ve.hex,name:ve.name,showLabel:!1}))]}),Je=G(()=>{const ae=o.inheritedIconColor||"#ffffff",ie=ae==="#ffffff"?"White":Pn.find(ve=>ve.hex===ae)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ie})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Pn.filter(ve=>ve.hex!=="#ffffff").map(ve=>({hex:ve.hex,name:ve.name,showLabel:!1}))]}),Fe=ae=>ae==="default"?!l.value||l.value==="default":l.value===ae,Ke=ae=>ae==="#ffffff"?!d.value||d.value==="#ffffff":d.value===ae,_e=G(()=>{const ae=l.value;return!ae||ae==="default"||ae==="none"?!1:!Pn.some(ie=>ie.hex.toLowerCase()===ae.toLowerCase())}),Ve=G(()=>{const ae=u.value;return!ae||ae==="default"||ae==="none"||ae==="#ffffff"||ae==="#000000"?!1:!Pn.some(ie=>ie.hex.toLowerCase()===ae.toLowerCase())}),pe=G(()=>{const ae=d.value;return!ae||ae==="default"||ae==="none"||ae==="#ffffff"||ae==="#000000"?!1:!Pn.some(ie=>ie.hex.toLowerCase()===ae.toLowerCase())}),Le=G(()=>{if(!w.value)return!1;const ae=w.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(ae)||/^[0-9A-Fa-f]{3}$/.test(ae)}),Pe=G(()=>{if(!S.value)return!1;const ae=S.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(ae)||/^[0-9A-Fa-f]{3}$/.test(ae)}),q=G(()=>{if(!A.value)return!1;const ae=A.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(ae)||/^[0-9A-Fa-f]{3}$/.test(ae)}),X=ae=>{if(ae==="none")return"None";if(ae==="default"){const ve=o.inheritedBackgroundShape;return ve?`Default (${hr.find(Ge=>Ge.value===ve)?.label||"Circle"})`:"Default (Circle)"}const ie=hr.find(ve=>ve.value===ae);return ie?ie.label:"Circle"},fe=ae=>{if(ae==="none")return"None";if(ae==="default"){const ve=o.inheritedType;if(ve&&ve!=="default"){const ot=oi(ve);if(ot.category==="content")return`Default (${ot.label||ve})`}return"Default"}const ie=zr.find(ve=>ve.value===ae);return ie?ie.label:"None"},we=ae=>{if(ae==="none")return"None";if(!ae||ae==="default"){const ve=he.value;return`Default (${Pn.find(Ge=>Ge.hex.toLowerCase()===ve.toLowerCase())?.name||"Custom"})`}const ie=[...Pn].find(ve=>ve.hex.toLowerCase()===ae.toLowerCase());return ie?ie.name:ae},Y=ae=>{if(ae==="none")return"None";if(ae==="default"){const ve=o.inheritedBorderColor;return ve&&ve!=="none"?`Default (${ve==="#ffffff"?"White":Pn.find(Ge=>Ge.hex===ve)?.name||"Custom"})`:"Default (White)"}if(!ae||ae==="#ffffff")return"White";const ie=[...et.value].find(ve=>ve.hex===ae);return ie?ie.name:ae},V=ae=>{if(ae==="none")return"None";if(ae==="default"){const ve=o.inheritedIconColor;return ve?`Default (${ve==="#ffffff"?"White":Pn.find(Ge=>Ge.hex===ve)?.name||"Custom"})`:"Default (White)"}if(!ae||ae==="#ffffff")return"White";const ie=[...Je.value].find(ve=>ve.hex===ae);return ie?ie.name:ae},J=ae=>{const ie={33:"Small",66:"Medium",100:"Normal",150:"Large"};if(ae==="default"){const ve=o.inheritedSize;return`Default (${ie[ve]||"Normal"})`}return ie[ae]||"Normal"},Me=ae=>{if(ae==="default"||ae===""||ae===void 0||ae===null){const ie=o.inheritedMapRotation;return ie!==""&&ie!==void 0&&ie!==null?`Default (${ie})`:"Default (0)"}return`${ae}`},Re=ae=>{if(ae==="none")return`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`;const ie=O(ae),ve=F(l.value),ot=E(u.value);return $i[ie]?`<svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">${$i[ie]({backgroundColor:ve,borderColor:ot==="transparent"?"none":ot})}</svg>`:""},Ce=ae=>{const ie=N(ae);return ie==="none"?`<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
      <rect x="1" y="1" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`:Sn({type:ie,backgroundShape:"circle",backgroundColor:"#94a3b8",borderColor:"none",iconColor:"#fff",size:"75"})},be=ae=>{const ie=O(ae);if(ie==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="none" stroke="#ccc" stroke-width="2" stroke-dasharray="4"/>
    </svg>`;const ve=F(l.value),ot=E(u.value),Ge=N(i.value),St=D(d.value);return Sn({type:Ge!=="none"?Ge:ie,backgroundShape:ie,backgroundColor:ve,borderColor:ot==="transparent"?"none":ot,iconColor:St,size:"100",outputSize:28})},me=ae=>{const ie=F(ae),ve=O(s.value),ot=E(u.value),Ge=N(i.value),St=D(d.value);return ve==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ie==="transparent"?"#e2e8f0":ie}"/>
    </svg>`:Sn({type:Ge!=="none"?Ge:ve,backgroundShape:ve,backgroundColor:ie==="transparent"?"#e2e8f0":ie,borderColor:ot==="transparent"?"none":ot,iconColor:St,size:"100",outputSize:28})},Z=ae=>{const ie=E(ae),ve=O(s.value),ot=F(l.value),Ge=N(i.value),St=D(d.value);return ve==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0" stroke="${ie}" stroke-width="2"/>
    </svg>`:Sn({type:Ge!=="none"?Ge:ve,backgroundShape:ve,backgroundColor:ot,borderColor:ie==="transparent"?"none":ie,iconColor:St,size:"100",outputSize:28})},oe=ae=>{const ie=N(ae),ve=O(s.value),ot=F(l.value),Ge=E(u.value),St=D(d.value);if(ie==="none"&&ve==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0"/>
      <line x1="8" y1="8" x2="20" y2="20" stroke="#a0aec0" stroke-width="2" stroke-linecap="round"/>
    </svg>`;const qt=ve!=="none"?ve:"circle";return Sn({type:ie!=="none"?ie:qt,backgroundShape:qt,backgroundColor:ot,borderColor:Ge==="transparent"?"none":Ge,iconColor:St,size:"100",outputSize:42})},le=ae=>{const ie=D(ae),ve=O(s.value),ot=F(l.value),Ge=E(u.value),St=N(i.value);return St==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ie==="transparent"?"#e2e8f0":ie}"/>
    </svg>`:Sn({type:St,backgroundShape:ve!=="none"?ve:"circle",backgroundColor:ot,borderColor:Ge==="transparent"?"none":Ge,iconColor:ie==="transparent"?"#e2e8f0":ie,size:"100",outputSize:28})},Te=ae=>{const ie=j(ae),ve=O(s.value),ot=F(l.value),Ge=E(u.value),St=N(i.value),qt=D(d.value);if(ve==="none"&&St==="none")return"";const Yt=ve!=="none"?ve:"circle";return Sn({type:St!=="none"?St:Yt,backgroundShape:Yt,backgroundColor:ot,borderColor:Ge==="transparent"?"none":Ge,iconColor:qt,size:ie})},Oe=G(()=>{const ae=O(s.value),ie=F(l.value),ve=E(u.value),ot=N(i.value),Ge=D(d.value),St=j(f.value);return ae==="none"&&ot==="none"?"":Sn(ae==="none"&&ot!=="none"?{type:ot,backgroundShape:"none",backgroundColor:ie,borderColor:"none",iconColor:Ge,size:St}:{type:ot!=="none"?ot:ae,backgroundShape:ae,backgroundColor:ie,borderColor:ve==="transparent"?"none":ve,iconColor:Ge,size:St})}),Be=ae=>{g.value=g.value===ae?null:ae},Xe=()=>{g.value=null,y.value=!1,k.value=!1,_.value=!1},mt=ae=>{s.value=ae,Xe()},_t=ae=>{l.value=ae,Xe()},bt=ae=>{u.value=ae,Xe()},Mt=ae=>{i.value=ae,Xe()},Ct=ae=>{d.value=ae,Xe()},Bt=ae=>{f.value=ae,Xe()},Nt=ae=>{p.value=ae,Xe()},zn=()=>{y.value=!y.value,y.value&&(_e.value?w.value=l.value.replace(/^#/,""):w.value="",un(()=>T.value?.focus()))},Xn=()=>{k.value=!k.value,k.value&&(Ve.value?S.value=u.value.replace(/^#/,""):S.value="",un(()=>x.value?.focus()))},pn=()=>{_.value=!_.value,_.value&&(pe.value?A.value=d.value.replace(/^#/,""):A.value="",un(()=>P.value?.focus()))},Gt=()=>{w.value=w.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},gt=()=>{S.value=S.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},Qn=()=>{A.value=A.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},Hn=ae=>ae.length===3?ae[0]+ae[0]+ae[1]+ae[1]+ae[2]+ae[2]:ae,eo=()=>{if(!Le.value)return;const ae=Hn(w.value);l.value="#"+ae,y.value=!1,Xe()},vn=()=>{if(!Pe.value)return;const ae=Hn(S.value);u.value="#"+ae,k.value=!1,Xe()},jt=()=>{if(!q.value)return;const ae=Hn(A.value);d.value="#"+ae,_.value=!1,Xe()},_s=ae=>{p.value=ae};qe(()=>o.isOpen,ae=>{if(ae){const ie=o.backgroundShape&&o.backgroundShape!=="default"&&o.backgroundShape!=="circle",ve=o.iconType&&o.iconType!=="none"&&o.iconType!=="default",ot=o.backgroundColor&&o.backgroundColor!=="",Ge=o.borderColor&&o.borderColor!=="",St=o.iconColor&&o.iconColor!=="",qt=o.size&&o.size!==""&&o.size!=="100",Yt=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null&&o.mapRotation!==0;ie||ve||ot||Ge||St||qt||Yt?(s.value=o.backgroundShape||"default",i.value=o.iconType||"default",l.value=o.backgroundColor||"default",u.value=o.borderColor||"default",d.value=o.iconColor||"default",f.value=o.size||"default",p.value=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null?o.mapRotation:"default"):(s.value="default",i.value="default",l.value="default",u.value="default",d.value="default",f.value="default",p.value="default"),g.value=null}});const to=()=>{Xe(),a("update:isOpen",!1),a("cancel")},Co=()=>{Xe();const ae=ot=>ot==="default"?"":ot;let ie="";i.value==="none"?ie="none":i.value&&i.value!=="default"&&(ie=i.value);let ve="";p.value!=="default"&&p.value!==""&&p.value!==void 0&&(ve=parseInt(p.value,10)||0),a("apply",{iconType:ie,backgroundShape:ae(s.value),backgroundColor:ae(l.value),borderColor:ae(u.value),iconColor:ae(d.value),size:ae(f.value),mapRotation:ve}),a("update:isOpen",!1)};return(ae,ie)=>e.isOpen?(v(),m("div",{key:0,class:"modal-overlay",onClick:rt(to,["self"])},[r("div",n2,[r("div",{class:"modal-header"},[ie[18]||(ie[18]=r("h3",null,"Customise marker style",-1)),r("button",{class:"close-btn",onClick:to},"")]),r("div",o2,[r("div",s2,[r("div",a2,[ie[19]||(ie[19]=r("div",{class:"map-background"},null,-1)),r("div",{class:"preview-icon",style:Qe({transform:`rotate(${R(p.value)}deg)`}),innerHTML:Oe.value},null,12,i2)])]),r("div",l2,[r("button",{type:"button",class:ce(["option-button",{active:g.value==="shape"}]),onClick:ie[0]||(ie[0]=ve=>Be("shape"))},[r("div",r2,[ie[20]||(ie[20]=r("span",{class:"option-button-label"},"Shape",-1)),r("div",c2,[r("div",{class:"icon-preview-small",innerHTML:Re(s.value)},null,8,u2),r("span",null,C(X(s.value)),1)])]),ie[21]||(ie[21]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:ce(["option-button",{active:g.value==="bgColor"}]),onClick:ie[1]||(ie[1]=ve=>Be("bgColor"))},[r("div",d2,[ie[22]||(ie[22]=r("span",{class:"option-button-label"},"Background",-1)),r("div",h2,[r("span",{class:"color-swatch",style:Qe({backgroundColor:ee.value})},null,4),r("span",null,C(we(l.value)),1)])]),ie[23]||(ie[23]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:ce(["option-button",{active:g.value==="borderColor",disabled:!K.value}]),disabled:!K.value,onClick:ie[2]||(ie[2]=ve=>Be("borderColor"))},[r("div",p2,[ie[24]||(ie[24]=r("span",{class:"option-button-label"},"Border",-1)),r("div",v2,[r("span",{class:ce(["color-swatch",{"no-border":u.value==="none"}]),style:Qe(u.value!=="none"?{backgroundColor:de.value}:{})},null,6),r("span",null,C(Y(u.value)),1)])]),ie[25]||(ie[25]=r("span",{class:"option-button-arrow"},"",-1))],10,f2),r("button",{type:"button",class:ce(["option-button",{active:g.value==="icon"}]),onClick:ie[3]||(ie[3]=ve=>Be("icon"))},[r("div",m2,[ie[26]||(ie[26]=r("span",{class:"option-button-label"},"Icon",-1)),r("div",g2,[r("div",{class:"icon-preview-small",innerHTML:Ce(i.value)},null,8,y2),r("span",null,C(fe(i.value)),1)])]),ie[27]||(ie[27]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:ce(["option-button",{active:g.value==="iconColor",disabled:!Q.value}]),disabled:!Q.value,onClick:ie[4]||(ie[4]=ve=>Be("iconColor"))},[r("div",_2,[ie[28]||(ie[28]=r("span",{class:"option-button-label"},"Colour",-1)),r("div",b2,[r("span",{class:"color-swatch",style:Qe({backgroundColor:re.value})},null,4),r("span",null,C(V(d.value)),1)])]),ie[29]||(ie[29]=r("span",{class:"option-button-arrow"},"",-1))],10,k2),r("button",{type:"button",class:ce(["option-button",{active:g.value==="size"}]),onClick:ie[5]||(ie[5]=ve=>Be("size"))},[r("div",w2,[ie[30]||(ie[30]=r("span",{class:"option-button-label"},"Size",-1)),r("span",C2,C(J(f.value)),1)]),ie[31]||(ie[31]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:ce(["option-button option-button-full",{active:g.value==="mapRotation"}]),onClick:ie[6]||(ie[6]=ve=>Be("mapRotation"))},[r("div",L2,[ie[32]||(ie[32]=r("span",{class:"option-button-label"},"Map rotation",-1)),r("span",S2,C(Me(p.value)),1)]),ie[33]||(ie[33]=r("span",{class:"option-button-arrow"},"",-1))],2)]),g.value==="shape"?(v(),m("div",x2,[r("div",{class:"popup-header"},[ie[34]||(ie[34]=r("span",null,"Select shape",-1)),r("button",{type:"button",class:"popup-close",onClick:Xe},"")]),r("div",I2,[(v(!0),m(Se,null,Ne(W.value,ve=>(v(),m("button",{key:ve.value,type:"button",class:ce(["popup-grid-item",{selected:s.value===ve.value}]),onClick:ot=>mt(ve.value)},[r("div",{class:"popup-item-preview",innerHTML:be(ve.value)},null,8,T2),ve.showLabel?(v(),m("span",M2,C(ve.label),1)):M("",!0)],10,$2))),128))])])):M("",!0),g.value==="bgColor"?(v(),m("div",A2,[r("div",{class:"popup-header"},[ie[35]||(ie[35]=r("span",null,"Select background",-1)),r("button",{type:"button",class:"popup-close",onClick:Xe},"")]),r("div",E2,[(v(!0),m(Se,null,Ne(De.value,ve=>(v(),m("button",{key:ve.hex,type:"button",class:ce(["popup-grid-item",{selected:Fe(ve.hex)}]),title:ve.name,onClick:ot=>_t(ve.hex)},[r("div",{class:"popup-item-preview",innerHTML:me(ve.hex)},null,8,D2),ve.showLabel?(v(),m("span",R2,C(ve.name),1)):M("",!0)],10,P2))),128)),r("button",{type:"button",class:ce(["popup-grid-item custom-color-option",{selected:_e.value}]),style:Qe(_e.value?{"--custom-color":l.value}:{}),title:"Custom colour",onClick:zn},[r("div",{class:"popup-item-preview custom-color-preview",style:Qe(_e.value?{backgroundColor:l.value}:{})},[_e.value?M("",!0):(v(),m("svg",O2,[...ie[36]||(ie[36]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),_e.value?(v(),m("span",B2,"")):M("",!0)],4),ie[37]||(ie[37]=r("span",null,"Custom",-1))],6)]),y.value?(v(),m("div",N2,[ie[39]||(ie[39]=r("label",null,"Enter hex code",-1)),r("div",F2,[ie[38]||(ie[38]=r("span",{class:"hex-prefix"},"#",-1)),He(r("input",{ref_key:"bgHexInput",ref:T,"onUpdate:modelValue":ie[7]||(ie[7]=ve=>w.value=ve),type:"text",maxlength:"6",placeholder:"000000",class:ce(["hex-input",{invalid:w.value&&!Le.value}]),onInput:Gt,onKeydown:vs(eo,["enter"])},null,34),[[st,w.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:Le.value?"#"+w.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!Le.value,onClick:eo}," Apply ",8,U2)]),w.value&&!Le.value?(v(),m("span",z2," Invalid hex code ")):M("",!0)])):M("",!0)])):M("",!0),g.value==="borderColor"?(v(),m("div",H2,[r("div",{class:"popup-header"},[ie[40]||(ie[40]=r("span",null,"Select border",-1)),r("button",{type:"button",class:"popup-close",onClick:Xe},"")]),r("div",V2,[(v(!0),m(Se,null,Ne(et.value,ve=>(v(),m("button",{key:ve.hex,type:"button",class:ce(["popup-grid-item",{selected:u.value===ve.hex}]),title:ve.name,onClick:ot=>bt(ve.hex)},[r("div",{class:"popup-item-preview",innerHTML:Z(ve.hex)},null,8,j2),ve.showLabel?(v(),m("span",Z2,C(ve.name),1)):M("",!0)],10,G2))),128)),r("button",{type:"button",class:ce(["popup-grid-item custom-color-option",{selected:Ve.value}]),style:Qe(Ve.value?{"--custom-color":u.value}:{}),title:"Custom colour",onClick:Xn},[r("div",{class:"popup-item-preview custom-color-preview",style:Qe(Ve.value?{backgroundColor:u.value}:{})},[Ve.value?M("",!0):(v(),m("svg",q2,[...ie[41]||(ie[41]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),Ve.value?(v(),m("span",W2,"")):M("",!0)],4),ie[42]||(ie[42]=r("span",null,"Custom",-1))],6)]),k.value?(v(),m("div",K2,[ie[44]||(ie[44]=r("label",null,"Enter hex code",-1)),r("div",J2,[ie[43]||(ie[43]=r("span",{class:"hex-prefix"},"#",-1)),He(r("input",{ref_key:"borderHexInput",ref:x,"onUpdate:modelValue":ie[8]||(ie[8]=ve=>S.value=ve),type:"text",maxlength:"6",placeholder:"000000",class:ce(["hex-input",{invalid:S.value&&!Pe.value}]),onInput:gt,onKeydown:vs(vn,["enter"])},null,34),[[st,S.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:Pe.value?"#"+S.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!Pe.value,onClick:vn}," Apply ",8,Y2)]),S.value&&!Pe.value?(v(),m("span",X2," Invalid hex code ")):M("",!0)])):M("",!0)])):M("",!0),g.value==="icon"?(v(),m("div",Q2,[r("div",{class:"popup-header"},[ie[45]||(ie[45]=r("span",null,"Select icon",-1)),r("button",{type:"button",class:"popup-close",onClick:Xe},"")]),r("div",eL,[(v(!0),m(Se,null,Ne(ne.value,ve=>(v(),m("button",{key:ve.value,type:"button",class:ce(["popup-grid-item",{selected:i.value===ve.value}]),onClick:ot=>Mt(ve.value)},[r("div",{class:"popup-item-preview",innerHTML:oe(ve.value)},null,8,nL),ve.showLabel?(v(),m("span",oL,C(ve.label),1)):M("",!0)],10,tL))),128))])])):M("",!0),g.value==="iconColor"?(v(),m("div",sL,[r("div",{class:"popup-header"},[ie[46]||(ie[46]=r("span",null,"Select colour",-1)),r("button",{type:"button",class:"popup-close",onClick:Xe},"")]),r("div",aL,[(v(!0),m(Se,null,Ne(Je.value,ve=>(v(),m("button",{key:ve.hex,type:"button",class:ce(["popup-grid-item",{selected:Ke(ve.hex)}]),title:ve.name,onClick:ot=>Ct(ve.hex)},[r("div",{class:"popup-item-preview",innerHTML:le(ve.hex)},null,8,lL),ve.showLabel?(v(),m("span",rL,C(ve.name),1)):M("",!0)],10,iL))),128)),r("button",{type:"button",class:ce(["popup-grid-item custom-color-option",{selected:pe.value}]),style:Qe(pe.value?{"--custom-color":d.value}:{}),title:"Custom colour",onClick:pn},[r("div",{class:"popup-item-preview custom-color-preview",style:Qe(pe.value?{backgroundColor:d.value}:{})},[pe.value?M("",!0):(v(),m("svg",cL,[...ie[47]||(ie[47]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),pe.value?(v(),m("span",uL,"")):M("",!0)],4),ie[48]||(ie[48]=r("span",null,"Custom",-1))],6)]),_.value?(v(),m("div",dL,[ie[50]||(ie[50]=r("label",null,"Enter hex code",-1)),r("div",hL,[ie[49]||(ie[49]=r("span",{class:"hex-prefix"},"#",-1)),He(r("input",{ref_key:"iconHexInput",ref:P,"onUpdate:modelValue":ie[9]||(ie[9]=ve=>A.value=ve),type:"text",maxlength:"6",placeholder:"000000",class:ce(["hex-input",{invalid:A.value&&!q.value}]),onInput:Qn,onKeydown:vs(jt,["enter"])},null,34),[[st,A.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:q.value?"#"+A.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!q.value,onClick:jt}," Apply ",8,fL)]),A.value&&!q.value?(v(),m("span",pL," Invalid hex code ")):M("",!0)])):M("",!0)])):M("",!0),g.value==="size"?(v(),m("div",vL,[r("div",{class:"popup-header"},[ie[51]||(ie[51]=r("span",null,"Select size",-1)),r("button",{type:"button",class:"popup-close",onClick:Xe},"")]),r("div",mL,[(v(!0),m(Se,null,Ne(ue.value,ve=>(v(),m("button",{key:ve.value,type:"button",class:ce(["size-grid-item",{selected:f.value===ve.value}]),onClick:ot=>Bt(ve.value)},[r("div",{class:"size-preview",innerHTML:Te(ve.value)},null,8,yL),r("span",null,C(ve.label),1)],10,gL))),128))])])):M("",!0),g.value==="mapRotation"?(v(),m("div",kL,[r("div",{class:"popup-header"},[ie[52]||(ie[52]=r("span",null,"Set map rotation",-1)),r("button",{type:"button",class:"popup-close",onClick:Xe},"")]),r("div",_L,[r("div",bL,[r("div",{class:"rotation-preview-icon",style:Qe({transform:`rotate(${R(p.value)}deg)`}),innerHTML:Oe.value},null,12,wL)]),ie[53]||(ie[53]=r("p",{class:"rotation-description"}," Rotate the marker on the map. This rotation is added to any map rotation. ",-1)),r("div",CL,[r("button",{type:"button",class:ce(["rotation-preset",{selected:p.value==="default"||p.value===""}]),onClick:ie[10]||(ie[10]=ve=>Nt("default"))}," Default ",2),r("div",LL,[r("input",{type:"range",min:"-180",max:"180",step:"5",class:"rotation-slider",value:p.value==="default"||p.value===""?0:p.value,onInput:ie[11]||(ie[11]=ve=>_s(parseInt(ve.target.value,10)))},null,40,SL),r("div",xL,C(p.value==="default"||p.value===""?"0":p.value)+" ",1)])]),r("div",IL,[r("button",{type:"button",class:ce(["rotation-preset-btn",{selected:p.value===-90}]),onClick:ie[12]||(ie[12]=ve=>Nt(-90))},"-90",2),r("button",{type:"button",class:ce(["rotation-preset-btn",{selected:p.value===-45}]),onClick:ie[13]||(ie[13]=ve=>Nt(-45))},"-45",2),r("button",{type:"button",class:ce(["rotation-preset-btn",{selected:p.value===0}]),onClick:ie[14]||(ie[14]=ve=>Nt(0))},"0",2),r("button",{type:"button",class:ce(["rotation-preset-btn",{selected:p.value===45}]),onClick:ie[15]||(ie[15]=ve=>Nt(45))},"+45",2),r("button",{type:"button",class:ce(["rotation-preset-btn",{selected:p.value===90}]),onClick:ie[16]||(ie[16]=ve=>Nt(90))},"+90",2),r("button",{type:"button",class:ce(["rotation-preset-btn",{selected:p.value===180}]),onClick:ie[17]||(ie[17]=ve=>Nt(180))},"180",2)])])])):M("",!0)]),r("div",{class:"modal-footer"},[r("button",{type:"button",class:"btn-cancel",onClick:to},"Cancel"),r("button",{type:"button",class:"btn-apply",onClick:Co},"Apply")])])])):M("",!0)}},ML=je(TL,[["__scopeId","data-v-bbab1a46"]]),AL={class:"checkpoint-style-picker"},EL={class:"form-group"},PL={class:"style-options"},DL=["innerHTML"],RL={class:"option-label"},OL=["innerHTML"],BL="#667eea",NL={__name:"CheckpointStylePicker",props:{styleType:{type:String,default:"default"},styleColor:{type:String,default:""},styleBackgroundShape:{type:String,default:""},styleBackgroundColor:{type:String,default:""},styleBorderColor:{type:String,default:""},styleIconColor:{type:String,default:""},styleSize:{type:String,default:""},styleMapRotation:{type:[String,Number],default:""},iconLabel:{type:String,default:"Marker style"},showPreview:{type:Boolean,default:!0},inheritedStyleType:{type:String,default:"default"},inheritedStyleColor:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""},defaultLabel:{type:String,default:"Default"},level:{type:String,default:"checkpoint"}},emits:["update:styleType","update:styleColor","update:styleBackgroundShape","update:styleBackgroundColor","update:styleBorderColor","update:styleIconColor","update:styleSize","update:styleMapRotation","change"],setup(e,{emit:t}){const o=e,a=t,s=$(o.styleType),i=$(o.styleColor||""),l=$(o.styleBackgroundShape||"default"),u=$(o.styleBackgroundColor||""),d=$(o.styleBorderColor||""),f=$(o.styleIconColor||""),p=$(o.styleSize||"default"),g=$(o.styleMapRotation||""),y=R=>!R||R==="default"?!1:oi(R).category==="content",k=$(o.styleType&&o.styleType!=="default"&&o.styleType!=="custom"&&y(o.styleType)?o.styleType:"default"),_=$(!1),w=G(()=>!!(s.value&&s.value!=="default"||l.value&&l.value!=="default"&&l.value!=="circle"||u.value||d.value||f.value||p.value&&p.value!=="default"&&p.value!=="100")),S=R=>R&&R!==""&&R!=="default",A=R=>R&&R.startsWith("#"),T=G(()=>{const W=S(o.inheritedStyleType),ne=S(o.inheritedBackgroundShape),ue=A(o.inheritedBackgroundColor)||A(o.inheritedStyleColor),K=A(o.inheritedBorderColor),Q=A(o.inheritedIconColor),he=S(o.inheritedSize);if(W||ne||ue||K||Q||he){const ee=W?o.inheritedStyleType:ne?o.inheritedBackgroundShape:"circle",de=(A(o.inheritedBackgroundColor)?o.inheritedBackgroundColor:null)||(A(o.inheritedStyleColor)?o.inheritedStyleColor:null)||BL;return Sn({type:ee,backgroundShape:o.inheritedBackgroundShape||"circle",backgroundColor:de,borderColor:o.inheritedBorderColor||"#ffffff",iconColor:o.inheritedIconColor||"#ffffff",size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#10B981"/>
        <stop offset="50%" style="stop-color:#F59E0B"/>
        <stop offset="100%" style="stop-color:#EF4444"/>
      </linearGradient>
    </defs>
    <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#defaultGradient)" stroke="#fff" stroke-width="1.5"/>
  </svg>`}),x=G(()=>{const R=o.inheritedMapRotation;return R!==""&&R!==void 0&&R!==null&&R!==0?{transform:`rotate(${R}deg)`}:{}}),P=G(()=>{if(g.value!==""&&g.value!==void 0&&g.value!==null){const W=parseInt(g.value,10)||0;if(W!==0)return{transform:`rotate(${W}deg)`}}const R=o.inheritedMapRotation;return R!==""&&R!==void 0&&R!==null&&R!==0?{transform:`rotate(${R}deg)`}:{}}),O=G(()=>{if(w.value){const R=k.value&&k.value!=="none"&&k.value!=="default";let W=null;o.inheritedStyleType&&o.inheritedStyleType!=="default"&&o.inheritedStyleType!=="custom"&&oi(o.inheritedStyleType).category==="content"&&(W=o.inheritedStyleType);const ne=k.value==="default"&&W,ue=R||ne,K=R?k.value:ne?W:null,Q=l.value&&l.value!=="default"?l.value:o.inheritedBackgroundShape||"circle",he=ue?K:Q,U=u.value||o.inheritedBackgroundColor||o.inheritedStyleColor||"#667eea",ee=d.value||o.inheritedBorderColor||"#ffffff",de=f.value||o.inheritedIconColor||"#ffffff";return Sn({type:he,backgroundShape:Q,backgroundColor:U,borderColor:ee,iconColor:de,size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#e2e8f0" stroke="#cbd5e0" stroke-width="1.5"/>
    <path d="M12 8v8M8 12h8" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
  </svg>`}),F=()=>{s.value="default",k.value="default",a("update:styleType","default"),l.value="default",u.value="",i.value="",d.value="",f.value="",p.value="default",g.value="",a("update:styleBackgroundShape",""),a("update:styleBackgroundColor",""),a("update:styleColor",""),a("update:styleBorderColor",""),a("update:styleIconColor",""),a("update:styleSize",""),a("update:styleMapRotation",""),j()},E=()=>{_.value=!0},N=R=>{R.iconType==="none"?k.value="none":R.iconType?k.value=R.iconType:k.value="default",l.value=R.backgroundShape||"default",u.value=R.backgroundColor||"",d.value=R.borderColor||"",f.value=R.iconColor||"",p.value=R.size||"default",g.value=R.mapRotation??"";const W=R.iconType==="none"||R.iconType&&R.iconType!==""||R.backgroundShape||R.backgroundColor||R.borderColor||R.iconColor||R.size||R.mapRotation!==""&&R.mapRotation!==0;R.iconType&&R.iconType!=="none"?s.value=R.iconType:W?s.value="custom":s.value="default",a("update:styleType",s.value),a("update:styleBackgroundShape",R.backgroundShape),a("update:styleBackgroundColor",R.backgroundColor),a("update:styleBorderColor",R.borderColor),a("update:styleIconColor",R.iconColor),a("update:styleSize",R.size),a("update:styleMapRotation",R.mapRotation??""),j()},D=()=>{},j=()=>{a("change",{styleType:s.value,styleColor:u.value||i.value,styleBackgroundShape:l.value,styleBackgroundColor:u.value,styleBorderColor:d.value,styleIconColor:f.value,styleSize:p.value,styleMapRotation:g.value})};return qe(()=>o.styleType,R=>{s.value=R,R&&R!=="default"&&R!=="custom"&&y(R)?k.value=R:k.value="default"}),qe(()=>o.styleColor,R=>{i.value=R||""}),qe(()=>o.styleBackgroundShape,R=>{l.value=R||"default"}),qe(()=>o.styleBackgroundColor,R=>{u.value=R||""}),qe(()=>o.styleBorderColor,R=>{d.value=R||""}),qe(()=>o.styleIconColor,R=>{f.value=R||""}),qe(()=>o.styleSize,R=>{p.value=R||"default"}),qe(()=>o.styleMapRotation,R=>{g.value=R??""}),(R,W)=>(v(),m("div",AL,[r("div",EL,[r("label",null,C(e.iconLabel),1),r("div",PL,[r("button",{type:"button",class:ce(["style-option-button",{selected:!w.value}]),onClick:F},[r("div",{class:"option-preview",style:Qe(x.value),innerHTML:T.value},null,12,DL),r("span",RL,C(e.defaultLabel),1)],2),r("button",{type:"button",class:ce(["style-option-button",{selected:w.value}]),onClick:E},[r("div",{class:"option-preview",style:Qe(P.value),innerHTML:O.value},null,12,OL),W[1]||(W[1]=r("span",{class:"option-label"},"Custom",-1))],2)])]),Ae(ML,{isOpen:_.value,"onUpdate:isOpen":W[0]||(W[0]=ne=>_.value=ne),"icon-type":k.value,"background-shape":l.value,"background-color":u.value,"border-color":d.value,"icon-color":f.value,size:p.value,"map-rotation":g.value,level:e.level,"inherited-type":e.inheritedStyleType,"inherited-background-shape":e.inheritedBackgroundShape,"inherited-background-color":e.inheritedBackgroundColor||e.inheritedStyleColor,"inherited-border-color":e.inheritedBorderColor,"inherited-icon-color":e.inheritedIconColor,"inherited-size":e.inheritedSize,"inherited-map-rotation":e.inheritedMapRotation,onApply:N,onCancel:D},null,8,["isOpen","icon-type","background-shape","background-color","border-color","icon-color","size","map-rotation","level","inherited-type","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])]))}},ad=je(NL,[["__scopeId","data-v-c066da64"]]),FL={class:"logo-uploader"},UL={key:0,class:"logo-preview"},zL=["src"],HL=["disabled"],VL={key:0,class:"upload-progress"},GL={key:1,class:"upload-prompt"},jL={key:2,class:"error-message"},sf=5*1024*1024,ZL={__name:"LogoUploader",props:{modelValue:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0},staged:{type:Boolean,default:!1}},emits:["update:modelValue","staged-change"],setup(e,{expose:t,emit:o}){const a=e;function s(){const K={},Q=localStorage.getItem("adminEmail");Q&&(K["X-Admin-Email"]=Q);const he=localStorage.getItem("sessionToken");return he&&(K.Authorization=`Bearer ${he}`),K}const i=o;function l(){i("staged-change",{hasPendingChanges:y.value!==null||_.value,isPendingDelete:_.value,displayUrl:k.value||(_.value?"":a.modelValue)||""})}const u=$(null),d=$(!1),f=$(!1),p=$(""),g=$(Date.now()),y=$(null),k=$(""),_=$(!1),w=G(()=>{if(a.staged){if(k.value)return!0;if(_.value)return!1}return!!a.modelValue}),S=G(()=>{if(a.staged&&_.value)return"";if(a.staged&&k.value)return k.value;if(!a.modelValue)return"";const K=a.modelValue.includes("?")?"&":"?";return`${a.modelValue}${K}_t=${g.value}`});function A(){k.value&&(URL.revokeObjectURL(k.value),k.value="")}$n(()=>{A()});const T=["image/png","image/jpeg","image/svg+xml","image/gif","image/webp"];function x(){d.value||u.value?.click()}function P(K){const Q=K.target.files?.[0];Q&&F(Q),u.value&&(u.value.value="")}function O(K){f.value=!1;const Q=K.dataTransfer?.files?.[0];Q&&F(Q)}async function F(K){if(p.value="",!T.includes(K.type)){p.value="Invalid file type. Please use PNG, JPEG, SVG, GIF, or WebP.";return}if(K.size>sf){p.value=`File too large. Maximum size is ${sf/(1024*1024)}MB.`;return}if(a.staged){A(),y.value=K,k.value=URL.createObjectURL(K),_.value=!1,l();return}d.value=!0;try{const Q=await fetch(`${ul}/events/${a.eventId}/logo`,{method:"POST",headers:{"Content-Type":K.type,...s()},body:K});if(!Q.ok){const U=await Q.text().catch(()=>"");let ee=`Upload failed (${Q.status})`;try{ee=JSON.parse(U).message||ee}catch{U&&(ee=U)}throw new Error(ee)}const he=await Q.json();g.value=Date.now(),i("update:modelValue",he.logoUrl)}catch(Q){console.error("Logo upload error:",Q),Q.name==="TypeError"&&Q.message==="Failed to fetch"?p.value="Network error. Check your connection or try a smaller file.":Q.message?.includes("401")||Q.message?.includes("403")?p.value="Not authorized. Please refresh the page and try again.":p.value=Q.message||"Failed to upload logo. Please try again."}finally{d.value=!1}}async function E(){if(p.value="",a.staged){y.value?(A(),y.value=null):a.modelValue&&(_.value=!0),l();return}d.value=!0;try{const K=await fetch(`${ul}/events/${a.eventId}/logo`,{method:"DELETE",headers:s()});if(!K.ok){const Q=await K.json().catch(()=>({}));throw new Error(Q.message||"Delete failed")}i("update:modelValue","")}catch(K){console.error("Logo delete error:",K),p.value=K.message||"Failed to remove logo. Please try again."}finally{d.value=!1}}async function N(){if(!y.value)return{success:!0,logoUrl:_.value?"":a.modelValue};d.value=!0,p.value="";try{const K=await fetch(`${ul}/events/${a.eventId}/logo`,{method:"POST",headers:{"Content-Type":y.value.type,...s()},body:y.value});if(!K.ok){const he=await K.text().catch(()=>"");let U=`Upload failed (${K.status})`;try{U=JSON.parse(he).message||U}catch{he&&(U=he)}throw new Error(U)}const Q=await K.json();return g.value=Date.now(),A(),y.value=null,_.value=!1,{success:!0,logoUrl:Q.logoUrl}}catch(K){return console.error("Logo upload error:",K),p.value=K.message||"Failed to upload logo. Please try again.",{success:!1,error:K.message}}finally{d.value=!1}}async function D(){if(!_.value)return{success:!0};d.value=!0,p.value="";try{const K=await fetch(`${ul}/events/${a.eventId}/logo`,{method:"DELETE",headers:s()});if(!K.ok){const Q=await K.json().catch(()=>({}));throw new Error(Q.message||"Delete failed")}return _.value=!1,{success:!0}}catch(K){return console.error("Logo delete error:",K),p.value=K.message||"Failed to remove logo. Please try again.",{success:!1,error:K.message}}finally{d.value=!1}}function j(){return y.value!==null||_.value}function R(){return y.value}function W(){return _.value}function ne(){return k.value?k.value:_.value?"":a.modelValue||""}function ue(){A(),y.value=null,_.value=!1}return t({uploadStagedFile:N,deleteStagedLogo:D,hasPendingChanges:j,getStagedFile:R,isPendingDelete:W,getDisplayUrl:ne,resetStagedState:ue}),(K,Q)=>(v(),m("div",FL,[Q[4]||(Q[4]=r("label",{class:"uploader-label"},"Event Logo",-1)),w.value?(v(),m("div",UL,[r("img",{src:S.value,alt:"Event logo",class:"logo-image"},null,8,zL),r("button",{type:"button",class:"remove-btn",onClick:E,disabled:d.value}," Remove ",8,HL)])):(v(),m("div",{key:1,class:ce(["upload-area",{"drag-over":f.value,uploading:d.value}]),onDragover:Q[0]||(Q[0]=rt(he=>f.value=!0,["prevent"])),onDragleave:Q[1]||(Q[1]=rt(he=>f.value=!1,["prevent"])),onDrop:rt(O,["prevent"]),onClick:x},[r("input",{ref_key:"fileInput",ref:u,type:"file",accept:"image/png,image/jpeg,image/svg+xml,image/gif,image/webp",class:"file-input",onChange:P},null,544),d.value?(v(),m("div",VL,[...Q[2]||(Q[2]=[r("div",{class:"spinner"},null,-1),r("span",null,"Uploading...",-1)])])):(v(),m("div",GL,[...Q[3]||(Q[3]=[r("div",{class:"upload-icon"},"+",-1),r("span",{class:"upload-text"},"Click or drag to upload logo",-1),r("span",{class:"upload-hint"},"PNG, JPEG, SVG, GIF, WebP (max 5MB)",-1)])]))],34)),p.value?(v(),m("div",jL,C(p.value),1)):M("",!0)]))}},qL=je(ZL,[["__scopeId","data-v-3cdaec2f"]]),Wv=[{name:"Default",headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},{name:"Wasp",headerGradientStart:"#333333",headerGradientEnd:"#333333",accentColor:"#FFD700",pageGradientStart:"#FFD700",pageGradientEnd:"#333333"},{name:"Ocean",headerGradientStart:"#0077be",headerGradientEnd:"#00a8e8",accentColor:"#0077be",pageGradientStart:"#0077be",pageGradientEnd:"#00a8e8"},{name:"Forest",headerGradientStart:"#228b22",headerGradientEnd:"#32cd32",accentColor:"#228b22",pageGradientStart:"#228b22",pageGradientEnd:"#32cd32"},{name:"Sunset",headerGradientStart:"#ff6b35",headerGradientEnd:"#f7931e",accentColor:"#ff6b35",pageGradientStart:"#ff6b35",pageGradientEnd:"#f7931e"},{name:"Berry",headerGradientStart:"#8e2de2",headerGradientEnd:"#4a00e0",accentColor:"#8e2de2",pageGradientStart:"#8e2de2",pageGradientEnd:"#4a00e0"},{name:"Coral",headerGradientStart:"#ff758c",headerGradientEnd:"#ff7eb3",accentColor:"#ff758c",pageGradientStart:"#ff758c",pageGradientEnd:"#ff7eb3"},{name:"Steel",headerGradientStart:"#485563",headerGradientEnd:"#29323c",accentColor:"#485563",pageGradientStart:"#485563",pageGradientEnd:"#29323c"},{name:"Mint",headerGradientStart:"#11998e",headerGradientEnd:"#38ef7d",accentColor:"#11998e",pageGradientStart:"#11998e",pageGradientEnd:"#38ef7d"},{name:"Cherry",headerGradientStart:"#eb3349",headerGradientEnd:"#f45c43",accentColor:"#eb3349",pageGradientStart:"#eb3349",pageGradientEnd:"#f45c43"},{name:"Midnight",headerGradientStart:"#232526",headerGradientEnd:"#414345",accentColor:"#5c5c5c",pageGradientStart:"#232526",pageGradientEnd:"#414345"},{name:"Lavender",headerGradientStart:"#a18cd1",headerGradientEnd:"#fbc2eb",accentColor:"#a18cd1",pageGradientStart:"#a18cd1",pageGradientEnd:"#fbc2eb"},{name:"Gold",headerGradientStart:"#f7971e",headerGradientEnd:"#ffd200",accentColor:"#f7971e",pageGradientStart:"#f7971e",pageGradientEnd:"#ffd200"}];function WL(){return{...Wv[0]}}function KL(e,t){return{...e,headerGradientStart:t.headerGradientStart,headerGradientEnd:t.headerGradientEnd,accentColor:t.accentColor,pageGradientStart:t.pageGradientStart,pageGradientEnd:t.pageGradientEnd,logoUrl:e.logoUrl||"",logoPosition:e.logoPosition||""}}function Mu(e){const t=e.replace("#",""),o=parseInt(t.slice(0,2),16)/255,a=parseInt(t.slice(2,4),16)/255,s=parseInt(t.slice(4,6),16)/255,i=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),l=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*i+.7152*l+.0722*u}function Au(e){return!e||e===""?"#ffffff":Mu(e)>.179?"#333333":"#ffffff"}function Kv(e,t){const o=e||rn.headerGradientStart,a=t||rn.headerGradientEnd,s=Mu(o),i=Mu(a);return(s+i)/2>.35?"#333333":"#ffffff"}const rn={headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},JL={class:"marshal-mockup-container"},YL={class:"presets-section"},XL={class:"presets-row"},QL=["title","onClick"],eS={class:"preset-name"},tS={class:"mockup-frame"},nS={key:0,class:"logo-cover-bg"},oS=["src"],sS=["src"],aS={class:"header-center"},iS={class:"event-name"},lS={class:"mockup-buttons"},rS=["src"],cS={class:"mockup-body"},uS={class:"mockup-card"},dS={class:"card-content"},hS={class:"editor-header"},fS={class:"editor-content"},pS={class:"color-grid-inline"},vS={class:"color-field"},mS={class:"color-swatches"},gS=["title","onClick"],yS={key:0,class:"check"},kS={class:"custom-color-wrapper"},_S={class:"hex-popup-header"},bS={class:"hex-input-row"},wS=["disabled"],CS={key:0,class:"hex-error"},LS={class:"gradient-toggle"},SS={key:0,class:"color-field"},xS={class:"color-swatches"},IS=["title","onClick"],$S={key:0,class:"check"},TS={class:"custom-color-wrapper"},MS={class:"hex-popup-header"},AS={class:"hex-input-row"},ES=["disabled"],PS={key:0,class:"hex-error"},DS={key:1,class:"logo-position-section"},RS={class:"position-buttons"},OS={class:"color-swatches"},BS=["title","onClick"],NS={key:0,class:"check"},FS={class:"custom-color-wrapper"},US={class:"hex-popup-header"},zS={class:"hex-input-row"},HS=["disabled"],VS={key:0,class:"hex-error"},GS={class:"color-grid-inline"},jS={class:"color-field"},ZS={class:"color-swatches"},qS=["title","onClick"],WS={key:0,class:"check"},KS={class:"custom-color-wrapper"},JS={class:"hex-popup-header"},YS={class:"hex-input-row"},XS=["disabled"],QS={key:0,class:"hex-error"},ex={class:"gradient-toggle"},tx={key:0,class:"color-field"},nx={class:"color-swatches"},ox=["title","onClick"],sx={key:0,class:"check"},ax={class:"custom-color-wrapper"},ix={class:"hex-popup-header"},lx={class:"hex-input-row"},rx=["disabled"],cx={key:0,class:"hex-error"},ux={class:"editor-footer"},dx={__name:"MarshalModeMockup",props:{branding:{type:Object,required:!0},eventName:{type:String,default:""},eventDate:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:branding","logo-staged-change"],setup(e,{expose:t,emit:o}){const a=Pn,s=e,i=o,l=$(null),u=Wv,d=$(!1),f=$(!1),p=$(null),g=$(!1),y=$(""),k=Y=>{typeof Y=="object"&&Y!==null?(g.value=Y.isPendingDelete,y.value=Y.displayUrl||"",i("logo-staged-change",Y.hasPendingChanges)):(p.value&&(g.value=p.value.isPendingDelete(),y.value=p.value.getDisplayUrl()||""),i("logo-staged-change",!!Y))},_=$(null),w=$(""),S=$(null),A=$(null),T=$({left:"50%",right:"auto",transform:"translateX(-50%)"}),x=Y=>Y?!a.some(V=>V.hex.toLowerCase()===Y.toLowerCase()):!1,P=Y=>!Y||!x(Y)?"#666666":Au(Y),O=Y=>!Y||!x(Y)?"#e0e0e0":Y,F=G(()=>{if(!w.value)return!1;const Y=w.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(Y)||/^[0-9A-Fa-f]{3}$/.test(Y)}),E=(Y,V)=>{if(_.value===Y)_.value=null;else{_.value=Y;let J="";switch(Y){case"headerStart":J=s.branding.headerGradientStart;break;case"headerEnd":J=s.branding.headerGradientEnd;break;case"pageStart":J=s.branding.pageGradientStart;break;case"pageEnd":J=s.branding.pageGradientEnd;break;case"accent":J=s.branding.accentColor;break}if(J&&x(J)?w.value=J.replace(/^#/,""):w.value="",V&&A.value){const Me=V.currentTarget,Re=A.value,Ce=Me.getBoundingClientRect(),be=Re.getBoundingClientRect(),me=220,Z=12,oe=Ce.left+Ce.width/2-be.left,le=be.width,Te=oe-me/2;oe+me/2>le-Z?T.value={left:"auto",right:"0",transform:"none"}:Te<Z?T.value={left:"0",right:"auto",transform:"none"}:T.value={left:"50%",right:"auto",transform:"translateX(-50%)"}}un(()=>S.value?.focus())}},N=()=>{w.value=w.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},D=()=>{if(!F.value||!_.value)return;let Y=w.value;Y.length===3&&(Y=Y[0]+Y[0]+Y[1]+Y[1]+Y[2]+Y[2]);const V="#"+Y;switch(_.value){case"headerStart":Ke("start",V);break;case"headerEnd":Fe("headerGradientEnd",V);break;case"pageStart":_e("start",V);break;case"pageEnd":Fe("pageGradientEnd",V);break;case"accent":Fe("accentColor",V);break}_.value=null};qe(l,Y=>{if(_.value=null,w.value="",Y==="header"){const V=s.branding.headerGradientStart||rn.headerGradientStart,J=s.branding.headerGradientEnd||rn.headerGradientEnd;d.value=V!==J}else if(Y==="page"){const V=s.branding.pageGradientStart||rn.pageGradientStart,J=s.branding.pageGradientEnd||rn.pageGradientEnd;f.value=V!==J}});const j={header:"Header colour",logo:"Event logo",accent:"Accent colour",page:"Page background"},R=G(()=>s.branding.headerGradientStart||rn.headerGradientStart),W=G(()=>s.branding.headerGradientEnd||rn.headerGradientEnd),ne=G(()=>s.branding.accentColor||rn.accentColor),ue=G(()=>s.branding.pageGradientStart||rn.pageGradientStart),K=G(()=>s.branding.pageGradientEnd||rn.pageGradientEnd),Q=G(()=>s.branding.logoPosition||"left"),he=$(Date.now());qe(()=>s.branding.logoUrl,()=>{he.value=Date.now(),g.value=!1,y.value=""});const U=G(()=>g.value?!1:!!(y.value||s.branding.logoUrl)),ee=G(()=>{if(g.value)return"";if(y.value){if(y.value.startsWith("blob:"))return y.value;const V=y.value.includes("?")?"&":"?";return`${y.value}${V}_t=${he.value}`}if(!s.branding.logoUrl)return"";const Y=s.branding.logoUrl.includes("?")?"&":"?";return`${s.branding.logoUrl}${Y}_t=${he.value}`}),de=G(()=>({background:`linear-gradient(135deg, ${R.value} 0%, ${W.value} 100%)`})),re=G(()=>Kv(R.value,W.value)),De=G(()=>({background:ne.value,color:Au(ne.value)})),et=G(()=>({background:`linear-gradient(135deg, ${ue.value} 0%, ${K.value} 100%)`}));function Je(Y){l.value=l.value===Y?null:Y}function Fe(Y,V){i("update:branding",{...s.branding,[Y]:V})}function Ke(Y,V){d.value?Fe("headerGradientStart",V):i("update:branding",{...s.branding,headerGradientStart:V,headerGradientEnd:V})}function _e(Y,V){f.value?Fe("pageGradientStart",V):i("update:branding",{...s.branding,pageGradientStart:V,pageGradientEnd:V})}function Ve(){if(!d.value){const Y=s.branding.headerGradientStart||rn.headerGradientStart;Fe("headerGradientEnd",Y)}}function pe(){if(!f.value){const Y=s.branding.pageGradientStart||rn.pageGradientStart;Fe("pageGradientEnd",Y)}}function Le(Y){i("update:branding",KL(s.branding,Y)),l.value=null}async function Pe(){return p.value?await p.value.uploadStagedFile():{success:!0,logoUrl:s.branding.logoUrl}}async function q(){return p.value?await p.value.deleteStagedLogo():{success:!0}}function X(){return p.value?.hasPendingChanges()||!1}function fe(){return p.value?.isPendingDelete()||!1}function we(){p.value&&p.value.resetStagedState(),g.value=!1,y.value=""}return t({uploadStagedLogo:Pe,deleteStagedLogo:q,hasLogoChanges:X,isLogoPendingDelete:fe,resetLogo:we}),(Y,V)=>(v(),m("div",JL,[r("div",YL,[V[32]||(V[32]=r("span",{class:"presets-label"},"Quick themes:",-1)),r("div",XL,[(v(!0),m(Se,null,Ne(B(u),J=>(v(),m("button",{key:J.name,type:"button",class:"preset-btn",title:J.name,onClick:Me=>Le(J)},[r("span",{class:"preset-preview",style:Qe({background:`linear-gradient(135deg, ${J.pageGradientStart} 0%, ${J.pageGradientEnd} 100%)`})},null,4),r("span",eS,C(J.name),1)],8,QL))),128))])]),r("div",tS,[r("div",{class:ce(["mockup-page",{"region-active":l.value==="page"}]),style:Qe(et.value),onClick:V[7]||(V[7]=J=>Je("page"))},[r("div",{class:ce(["mockup-header",[{"region-active":l.value==="header"},U.value?`logo-${Q.value}`:"logo-none"]]),style:Qe(de.value),onClick:V[5]||(V[5]=rt(J=>Je("header"),["stop"]))},[U.value&&Q.value==="cover"?(v(),m("div",nS,[r("img",{src:ee.value,alt:"Logo",class:"logo-cover-img"},null,8,oS)])):M("",!0),U.value&&Q.value==="cover"?(v(),m("button",{key:1,type:"button",class:ce(["logo-cover-edit-btn",{"region-active":l.value==="logo"}]),onClick:V[0]||(V[0]=rt(J=>Je("logo"),["stop"])),title:"Edit logo"},[...V[33]||(V[33]=[r("span",null,"",-1)])],2)):M("",!0),U.value&&Q.value==="left"?(v(),m("div",{key:2,class:ce(["mockup-logo logo-left",{"region-active":l.value==="logo"}]),onClick:V[1]||(V[1]=rt(J=>Je("logo"),["stop"]))},[r("img",{src:ee.value,alt:"Logo",class:"logo-img"},null,8,sS)],2)):M("",!0),U.value?M("",!0):(v(),m("div",{key:3,class:ce(["logo-add-area logo-add-left",{"region-active":l.value==="logo"}]),onClick:V[2]||(V[2]=rt(J=>Je("logo"),["stop"]))},[...V[34]||(V[34]=[r("span",{class:"logo-add-text"},"+ Logo",-1)])],2)),r("div",aS,[r("div",{class:"mockup-title",style:Qe({color:re.value})},[r("span",iS,C(e.eventName||"Event Name"),1)],4),r("div",{class:"mockup-date",style:Qe({color:re.value})},C(e.eventDate||"Event Date"),5),r("div",lS,[V[35]||(V[35]=r("span",{class:"btn-emergency"},"Emergency",-1)),r("span",{class:"btn-logout",style:Qe({color:re.value})},"Logout",4)])]),U.value&&Q.value==="right"?(v(),m("div",{key:4,class:ce(["mockup-logo logo-right",{"region-active":l.value==="logo"}]),onClick:V[3]||(V[3]=rt(J=>Je("logo"),["stop"]))},[r("img",{src:ee.value,alt:"Logo",class:"logo-img"},null,8,rS)],2)):M("",!0),U.value?M("",!0):(v(),m("div",{key:5,class:ce(["logo-add-area logo-add-right",{"region-active":l.value==="logo"}]),onClick:V[4]||(V[4]=rt(J=>Je("logo"),["stop"]))},[...V[36]||(V[36]=[r("span",{class:"logo-add-text"},"+ Logo",-1)])],2))],6),r("div",cS,[r("div",uS,[V[37]||(V[37]=r("div",{class:"card-header"},"Your checkpoints (2)",-1)),r("div",dS,[r("div",{class:ce(["mockup-checkin-btn",{"region-active":l.value==="accent"}]),style:Qe(De.value),onClick:V[6]||(V[6]=rt(J=>Je("accent"),["stop"]))}," GPS Check-In ",6)])])])],6)]),He(r("div",{class:"editor-overlay",onClick:V[31]||(V[31]=rt(J=>l.value=null,["self"]))},[r("div",{ref_key:"editorModalRef",ref:A,class:"editor-modal"},[r("div",hS,[r("span",null,C(j[l.value]),1),r("button",{type:"button",class:"editor-close",onClick:V[8]||(V[8]=J=>l.value=null)},"")]),r("div",fS,[l.value==="header"?(v(),m(Se,{key:0},[V[46]||(V[46]=r("p",{class:"editor-description"},"Choose the colour for the header.",-1)),r("div",pS,[r("div",vS,[r("label",null,C(d.value?"Start colour":"Colour"),1),r("div",mS,[(v(!0),m(Se,null,Ne(B(a),J=>(v(),m("button",{key:"hs-"+J.hex,type:"button",class:ce(["color-swatch-btn",{selected:e.branding.headerGradientStart===J.hex}]),style:Qe({backgroundColor:J.hex}),title:J.name,onClick:Me=>Ke("start",J.hex)},[e.branding.headerGradientStart===J.hex?(v(),m("span",yS,"")):M("",!0)],14,gS))),128)),r("div",kS,[r("button",{type:"button",class:ce(["color-swatch-btn custom-color-btn",{selected:x(e.branding.headerGradientStart)}]),style:Qe({backgroundColor:O(e.branding.headerGradientStart)}),title:"Custom colour",onClick:V[9]||(V[9]=J=>E("headerStart",J))},[(v(),m("svg",{class:"custom-icon",style:Qe({color:P(e.branding.headerGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...V[38]||(V[38]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),_.value==="headerStart"?(v(),m("div",{key:0,class:"custom-hex-popup",style:Qe(T.value)},[r("div",_S,[V[39]||(V[39]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:V[10]||(V[10]=J=>_.value=null)},"")]),r("div",bS,[V[40]||(V[40]=r("span",{class:"hex-prefix"},"#",-1)),He(r("input",{ref_key:"hexInputRef",ref:S,"onUpdate:modelValue":V[11]||(V[11]=J=>w.value=J),type:"text",maxlength:"6",placeholder:"000000",class:ce(["hex-input",{invalid:w.value&&!F.value}]),onInput:N,onKeydown:vs(D,["enter"])},null,34),[[st,w.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:F.value?"#"+w.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!F.value,onClick:D}," Apply ",8,wS)]),w.value&&!F.value?(v(),m("span",CS,"Invalid hex code")):M("",!0)],4)):M("",!0)])]),r("label",LS,[He(r("input",{type:"checkbox","onUpdate:modelValue":V[12]||(V[12]=J=>d.value=J),onChange:Ve},null,544),[[Oi,d.value]]),V[41]||(V[41]=r("span",null,"Use gradient",-1))])]),d.value?(v(),m("div",SS,[V[45]||(V[45]=r("label",null,"End colour",-1)),r("div",xS,[(v(!0),m(Se,null,Ne(B(a),J=>(v(),m("button",{key:"he-"+J.hex,type:"button",class:ce(["color-swatch-btn",{selected:e.branding.headerGradientEnd===J.hex}]),style:Qe({backgroundColor:J.hex}),title:J.name,onClick:Me=>Fe("headerGradientEnd",J.hex)},[e.branding.headerGradientEnd===J.hex?(v(),m("span",$S,"")):M("",!0)],14,IS))),128)),r("div",TS,[r("button",{type:"button",class:ce(["color-swatch-btn custom-color-btn",{selected:x(e.branding.headerGradientEnd)}]),style:Qe({backgroundColor:O(e.branding.headerGradientEnd)}),title:"Custom colour",onClick:V[13]||(V[13]=J=>E("headerEnd",J))},[(v(),m("svg",{class:"custom-icon",style:Qe({color:P(e.branding.headerGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...V[42]||(V[42]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),_.value==="headerEnd"?(v(),m("div",{key:0,class:"custom-hex-popup",style:Qe(T.value)},[r("div",MS,[V[43]||(V[43]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:V[14]||(V[14]=J=>_.value=null)},"")]),r("div",AS,[V[44]||(V[44]=r("span",{class:"hex-prefix"},"#",-1)),He(r("input",{ref_key:"hexInputRef",ref:S,"onUpdate:modelValue":V[15]||(V[15]=J=>w.value=J),type:"text",maxlength:"6",placeholder:"000000",class:ce(["hex-input",{invalid:w.value&&!F.value}]),onInput:N,onKeydown:vs(D,["enter"])},null,34),[[st,w.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:F.value?"#"+w.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!F.value,onClick:D}," Apply ",8,ES)]),w.value&&!F.value?(v(),m("span",PS,"Invalid hex code")):M("",!0)],4)):M("",!0)])])])):M("",!0)])],64)):M("",!0),l.value==="logo"?(v(),m("div",DS,[V[47]||(V[47]=r("label",{class:"editor-label"},"Position",-1)),r("div",RS,[r("button",{type:"button",class:ce(["position-btn",{selected:Q.value==="left"}]),onClick:V[16]||(V[16]=J=>Fe("logoPosition","left"))}," Left ",2),r("button",{type:"button",class:ce(["position-btn",{selected:Q.value==="cover"}]),onClick:V[17]||(V[17]=J=>Fe("logoPosition","cover"))}," Cover ",2),r("button",{type:"button",class:ce(["position-btn",{selected:Q.value==="right"}]),onClick:V[18]||(V[18]=J=>Fe("logoPosition","right"))}," Right ",2)])])):M("",!0),He(Ae(qL,{ref_key:"logoUploaderRef",ref:p,"model-value":e.branding.logoUrl,"event-id":e.eventId,"admin-email":e.adminEmail,staged:"","onUpdate:modelValue":V[19]||(V[19]=J=>Fe("logoUrl",J)),onStagedChange:k},null,8,["model-value","event-id","admin-email"]),[[ks,l.value==="logo"]]),l.value==="accent"?(v(),m(Se,{key:2},[V[51]||(V[51]=r("p",{class:"editor-description"},"Choose the accent colour for buttons.",-1)),r("div",OS,[(v(!0),m(Se,null,Ne(B(a),J=>(v(),m("button",{key:"ac-"+J.hex,type:"button",class:ce(["color-swatch-btn",{selected:e.branding.accentColor===J.hex}]),style:Qe({backgroundColor:J.hex}),title:J.name,onClick:Me=>Fe("accentColor",J.hex)},[e.branding.accentColor===J.hex?(v(),m("span",NS,"")):M("",!0)],14,BS))),128)),r("div",FS,[r("button",{type:"button",class:ce(["color-swatch-btn custom-color-btn",{selected:x(e.branding.accentColor)}]),style:Qe({backgroundColor:O(e.branding.accentColor)}),title:"Custom colour",onClick:V[20]||(V[20]=J=>E("accent",J))},[(v(),m("svg",{class:"custom-icon",style:Qe({color:P(e.branding.accentColor)}),viewBox:"0 0 24 24",fill:"currentColor"},[...V[48]||(V[48]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),_.value==="accent"?(v(),m("div",{key:0,class:"custom-hex-popup",style:Qe(T.value)},[r("div",US,[V[49]||(V[49]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:V[21]||(V[21]=J=>_.value=null)},"")]),r("div",zS,[V[50]||(V[50]=r("span",{class:"hex-prefix"},"#",-1)),He(r("input",{ref_key:"hexInputRef",ref:S,"onUpdate:modelValue":V[22]||(V[22]=J=>w.value=J),type:"text",maxlength:"6",placeholder:"000000",class:ce(["hex-input",{invalid:w.value&&!F.value}]),onInput:N,onKeydown:vs(D,["enter"])},null,34),[[st,w.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:F.value?"#"+w.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!F.value,onClick:D}," Apply ",8,HS)]),w.value&&!F.value?(v(),m("span",VS,"Invalid hex code")):M("",!0)],4)):M("",!0)])])],64)):M("",!0),l.value==="page"?(v(),m(Se,{key:3},[V[60]||(V[60]=r("p",{class:"editor-description"},"Choose the colour for the page background.",-1)),r("div",GS,[r("div",jS,[r("label",null,C(f.value?"Start colour":"Colour"),1),r("div",ZS,[(v(!0),m(Se,null,Ne(B(a),J=>(v(),m("button",{key:"ps-"+J.hex,type:"button",class:ce(["color-swatch-btn",{selected:e.branding.pageGradientStart===J.hex}]),style:Qe({backgroundColor:J.hex}),title:J.name,onClick:Me=>_e("start",J.hex)},[e.branding.pageGradientStart===J.hex?(v(),m("span",WS,"")):M("",!0)],14,qS))),128)),r("div",KS,[r("button",{type:"button",class:ce(["color-swatch-btn custom-color-btn",{selected:x(e.branding.pageGradientStart)}]),style:Qe({backgroundColor:O(e.branding.pageGradientStart)}),title:"Custom colour",onClick:V[23]||(V[23]=J=>E("pageStart",J))},[(v(),m("svg",{class:"custom-icon",style:Qe({color:P(e.branding.pageGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...V[52]||(V[52]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),_.value==="pageStart"?(v(),m("div",{key:0,class:"custom-hex-popup",style:Qe(T.value)},[r("div",JS,[V[53]||(V[53]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:V[24]||(V[24]=J=>_.value=null)},"")]),r("div",YS,[V[54]||(V[54]=r("span",{class:"hex-prefix"},"#",-1)),He(r("input",{ref_key:"hexInputRef",ref:S,"onUpdate:modelValue":V[25]||(V[25]=J=>w.value=J),type:"text",maxlength:"6",placeholder:"000000",class:ce(["hex-input",{invalid:w.value&&!F.value}]),onInput:N,onKeydown:vs(D,["enter"])},null,34),[[st,w.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:F.value?"#"+w.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!F.value,onClick:D}," Apply ",8,XS)]),w.value&&!F.value?(v(),m("span",QS,"Invalid hex code")):M("",!0)],4)):M("",!0)])]),r("label",ex,[He(r("input",{type:"checkbox","onUpdate:modelValue":V[26]||(V[26]=J=>f.value=J),onChange:pe},null,544),[[Oi,f.value]]),V[55]||(V[55]=r("span",null,"Use gradient",-1))])]),f.value?(v(),m("div",tx,[V[59]||(V[59]=r("label",null,"End colour",-1)),r("div",nx,[(v(!0),m(Se,null,Ne(B(a),J=>(v(),m("button",{key:"pe-"+J.hex,type:"button",class:ce(["color-swatch-btn",{selected:e.branding.pageGradientEnd===J.hex}]),style:Qe({backgroundColor:J.hex}),title:J.name,onClick:Me=>Fe("pageGradientEnd",J.hex)},[e.branding.pageGradientEnd===J.hex?(v(),m("span",sx,"")):M("",!0)],14,ox))),128)),r("div",ax,[r("button",{type:"button",class:ce(["color-swatch-btn custom-color-btn",{selected:x(e.branding.pageGradientEnd)}]),style:Qe({backgroundColor:O(e.branding.pageGradientEnd)}),title:"Custom colour",onClick:V[27]||(V[27]=J=>E("pageEnd",J))},[(v(),m("svg",{class:"custom-icon",style:Qe({color:P(e.branding.pageGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...V[56]||(V[56]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),_.value==="pageEnd"?(v(),m("div",{key:0,class:"custom-hex-popup",style:Qe(T.value)},[r("div",ix,[V[57]||(V[57]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:V[28]||(V[28]=J=>_.value=null)},"")]),r("div",lx,[V[58]||(V[58]=r("span",{class:"hex-prefix"},"#",-1)),He(r("input",{ref_key:"hexInputRef",ref:S,"onUpdate:modelValue":V[29]||(V[29]=J=>w.value=J),type:"text",maxlength:"6",placeholder:"000000",class:ce(["hex-input",{invalid:w.value&&!F.value}]),onInput:N,onKeydown:vs(D,["enter"])},null,34),[[st,w.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:F.value?"#"+w.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!F.value,onClick:D}," Apply ",8,rx)]),w.value&&!F.value?(v(),m("span",cx,"Invalid hex code")):M("",!0)],4)):M("",!0)])])])):M("",!0)])],64)):M("",!0)]),r("div",ux,[r("button",{type:"button",class:"btn-done",onClick:V[30]||(V[30]=J=>l.value=null)},"Done")])],512)],512),[[ks,l.value]]),V[61]||(V[61]=r("p",{class:"instructions"}," Click on different parts of the preview to customise them. The emergency button stays red for safety. ",-1))]))}},hx=je(dx,[["__scopeId","data-v-2c2f0816"]]),fx={class:"settings-tab"},px={class:"accordion"},vx={class:"accordion-section"},mx={class:"accordion-title"},gx={class:"accordion-icon"},yx={key:0,class:"accordion-content"},kx={class:"accordion-section"},_x={class:"accordion-icon"},bx={key:0,class:"accordion-content"},wx={class:"terminology-grid"},Cx={class:"term-group"},Lx=["value"],Sx={class:"term-group"},xx=["value"],Ix={class:"term-group"},$x=["value"],Tx={class:"term-group"},Mx=["value"],Ax={class:"term-group"},Ex=["value"],Px={class:"form-actions"},Dx=["disabled"],Rx={class:"accordion-section"},Ox={class:"accordion-title"},Bx={class:"accordion-icon"},Nx={key:0,class:"accordion-content"},Fx={class:"section-description"},Ux={class:"form-actions"},zx=["disabled"],Hx={class:"accordion-section"},Vx={class:"accordion-title"},Gx={class:"accordion-icon"},jx={key:0,class:"accordion-content"},Zx={class:"section-description"},qx={class:"form-actions"},Wx=["disabled"],Kx=["disabled"],af="admin_settings_accordion",Jx={__name:"SettingsTab",props:{eventData:{type:Object,required:!0},admins:{type:Array,default:()=>[]},formDirty:{type:Boolean,default:!1},eventId:{type:String,default:""}},emits:["submit","add-admin","remove-admin","update:formDirty"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ht(),s=jl(),i=G(()=>s.adminEmail||""),l=e,u=t,d=$({...l.eventData}),f=$(null),p=$(!1),g=()=>l.eventId?`${af}_${l.eventId}`:af,y=$(null);on(()=>{const E=localStorage.getItem(g());E&&(y.value=E)});const k=G(()=>{const E=d.value.peopleTerm||"Marshals";return Os.checkpoint.map(N=>({value:N,label:Su(N,E)}))}),_=E=>{const N=y.value===E?null:E;y.value=N,N?localStorage.setItem(g(),N):localStorage.removeItem(g())};qe(()=>l.eventData,E=>{d.value={...E},T.value=!1},{deep:!0});const w=()=>{u("update:formDirty",!0)},S=(E,N)=>{d.value[E]=N,w()},A=G(()=>({headerGradientStart:d.value.brandingHeaderGradientStart||"",headerGradientEnd:d.value.brandingHeaderGradientEnd||"",logoUrl:d.value.brandingLogoUrl||"",logoPosition:d.value.brandingLogoPosition||"",accentColor:d.value.brandingAccentColor||"",pageGradientStart:d.value.brandingPageGradientStart||"",pageGradientEnd:d.value.brandingPageGradientEnd||""})),T=$(!1),x=E=>{T.value=E},P=E=>{d.value.brandingHeaderGradientStart=E.headerGradientStart,d.value.brandingHeaderGradientEnd=E.headerGradientEnd,d.value.brandingLogoUrl=E.logoUrl,d.value.brandingLogoPosition=E.logoPosition,d.value.brandingAccentColor=E.accentColor,d.value.brandingPageGradientStart=E.pageGradientStart,d.value.brandingPageGradientEnd=E.pageGradientEnd,w()},O=()=>{WL(),d.value.brandingHeaderGradientStart="",d.value.brandingHeaderGradientEnd="",d.value.brandingLogoUrl="",d.value.brandingLogoPosition="",d.value.brandingAccentColor="",d.value.brandingPageGradientStart="",d.value.brandingPageGradientEnd="",T.value=!1,f.value?.resetLogo(),w()},F=async()=>{if(!p.value){p.value=!0;try{if(T.value&&f.value){if(f.value.isLogoPendingDelete()){const N=await f.value.deleteStagedLogo();if(!N.success){console.error("Failed to delete logo:",N.error);return}d.value.brandingLogoUrl=""}else{const N=await f.value.uploadStagedLogo();if(!N.success){console.error("Failed to upload logo:",N.error);return}N.logoUrl&&!N.logoUrl.startsWith("blob:")&&(d.value.brandingLogoUrl=N.logoUrl)}T.value=!1}u("submit",{...d.value})}finally{p.value=!1}}};return(E,N)=>(v(),m("div",fx,[r("div",px,[r("div",vx,[r("button",{class:ce(["accordion-header",{active:y.value==="admins"}]),onClick:N[0]||(N[0]=D=>_("admins"))},[r("span",mx,"Administrators ("+C(e.admins.length)+")",1),r("span",gx,C(y.value==="admins"?"-":"+"),1)],2),y.value==="admins"?(v(),m("div",yx,[Ae(e2,{admins:e.admins,onAddAdmin:N[1]||(N[1]=D=>E.$emit("add-admin")),onRemoveAdmin:N[2]||(N[2]=D=>E.$emit("remove-admin",D))},null,8,["admins"])])):M("",!0)]),r("div",kx,[r("button",{class:ce(["accordion-header",{active:y.value==="terminology"}]),onClick:N[3]||(N[3]=D=>_("terminology"))},[N[19]||(N[19]=r("span",{class:"accordion-title"},"Terminology",-1)),r("span",_x,C(y.value==="terminology"?"-":"+"),1)],2),y.value==="terminology"?(v(),m("div",bx,[N[20]||(N[20]=r("p",{class:"section-description"}," Customise how things are named throughout the application. ",-1)),r("div",wx,[r("div",Cx,[r("label",null,C(B(o).people)+" are called",1),He(r("select",{"onUpdate:modelValue":N[4]||(N[4]=D=>d.value.peopleTerm=D),class:"form-input",onChange:w},[(v(!0),m(Se,null,Ne(B(Os).people,D=>(v(),m("option",{key:D,value:D},C(D),9,Lx))),128))],544),[[Fn,d.value.peopleTerm]])]),r("div",Sx,[r("label",null,C(B(o).checkpoints)+" are called",1),He(r("select",{"onUpdate:modelValue":N[5]||(N[5]=D=>d.value.checkpointTerm=D),class:"form-input",onChange:w},[(v(!0),m(Se,null,Ne(k.value,D=>(v(),m("option",{key:D.value,value:D.value},C(D.label),9,xx))),128))],544),[[Fn,d.value.checkpointTerm]])]),r("div",Ix,[r("label",null,C(B(o).areas)+" are called",1),He(r("select",{"onUpdate:modelValue":N[6]||(N[6]=D=>d.value.areaTerm=D),class:"form-input",onChange:w},[(v(!0),m(Se,null,Ne(B(Os).area,D=>(v(),m("option",{key:D,value:D},C(D),9,$x))),128))],544),[[Fn,d.value.areaTerm]])]),r("div",Tx,[r("label",null,C(B(o).checklists)+" are called",1),He(r("select",{"onUpdate:modelValue":N[7]||(N[7]=D=>d.value.checklistTerm=D),class:"form-input",onChange:w},[(v(!0),m(Se,null,Ne(B(Os).checklist,D=>(v(),m("option",{key:D,value:D},C(D),9,Mx))),128))],544),[[Fn,d.value.checklistTerm]])]),r("div",Ax,[r("label",null,C(B(o).course)+" is called",1),He(r("select",{"onUpdate:modelValue":N[8]||(N[8]=D=>d.value.courseTerm=D),class:"form-input",onChange:w},[(v(!0),m(Se,null,Ne(B(Os).course,D=>(v(),m("option",{key:D,value:D},C(D),9,Ex))),128))],544),[[Fn,d.value.courseTerm]])])]),r("div",Px,[r("button",{onClick:F,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,Dx)])])):M("",!0)]),r("div",Rx,[r("button",{class:ce(["accordion-header",{active:y.value==="appearance"}]),onClick:N[9]||(N[9]=D=>_("appearance"))},[r("span",Ox,C(B(o).checkpoint)+" appearance",1),r("span",Bx,C(y.value==="appearance"?"-":"+"),1)],2),y.value==="appearance"?(v(),m("div",Nx,[r("p",Fx," Set the default marker style for all "+C(B(a).checkpoints)+" in this event. Individual "+C(B(a).areas)+" and "+C(B(a).checkpoints)+" can override this setting. ",1),Ae(ad,{"style-type":d.value.defaultCheckpointStyleType||"default","style-color":d.value.defaultCheckpointStyleColor||"","style-background-shape":d.value.defaultCheckpointStyleBackgroundShape||"","style-background-color":d.value.defaultCheckpointStyleBackgroundColor||"","style-border-color":d.value.defaultCheckpointStyleBorderColor||"","style-icon-color":d.value.defaultCheckpointStyleIconColor||"","style-size":d.value.defaultCheckpointStyleSize||"","style-map-rotation":d.value.defaultCheckpointStyleMapRotation??"","icon-label":"Default marker style",level:"event","show-preview":!0,"onUpdate:styleType":N[10]||(N[10]=D=>S("defaultCheckpointStyleType",D)),"onUpdate:styleColor":N[11]||(N[11]=D=>S("defaultCheckpointStyleColor",D)),"onUpdate:styleBackgroundShape":N[12]||(N[12]=D=>S("defaultCheckpointStyleBackgroundShape",D)),"onUpdate:styleBackgroundColor":N[13]||(N[13]=D=>S("defaultCheckpointStyleBackgroundColor",D)),"onUpdate:styleBorderColor":N[14]||(N[14]=D=>S("defaultCheckpointStyleBorderColor",D)),"onUpdate:styleIconColor":N[15]||(N[15]=D=>S("defaultCheckpointStyleIconColor",D)),"onUpdate:styleSize":N[16]||(N[16]=D=>S("defaultCheckpointStyleSize",D)),"onUpdate:styleMapRotation":N[17]||(N[17]=D=>S("defaultCheckpointStyleMapRotation",D))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation"]),r("div",Ux,[r("button",{onClick:F,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,zx)])])):M("",!0)]),r("div",Hx,[r("button",{class:ce(["accordion-header",{active:y.value==="branding"}]),onClick:N[18]||(N[18]=D=>_("branding"))},[r("span",Vx,C(B(o).person)+" branding",1),r("span",Gx,C(y.value==="branding"?"-":"+"),1)],2),y.value==="branding"?(v(),m("div",jx,[r("p",Zx," Customise the appearance of the "+C(B(a).person)+" view to match your organisation's branding. ",1),Ae(hx,{ref_key:"brandingMockupRef",ref:f,branding:A.value,"event-name":d.value.name,"event-date":B(Vv)(d.value.eventDate),"event-id":e.eventId,"admin-email":i.value,"onUpdate:branding":P,onLogoStagedChange:x},null,8,["branding","event-name","event-date","event-id","admin-email"]),r("div",qx,[r("button",{onClick:O,class:"btn btn-secondary",disabled:p.value}," Reset to default ",8,Wx),r("button",{onClick:F,class:"btn btn-primary",disabled:!e.formDirty&&!T.value||p.value},C(p.value?"Saving...":"Save"),9,Kx)])])):M("",!0)])])]))}},Yx=je(Jx,[["__scopeId","data-v-bb7e241a"]]),Xx={class:"incident-header"},Qx={class:"incident-title-row"},eI={class:"incident-title"},tI={class:"incident-badges"},nI={key:0,class:"incident-description"},oI={class:"incident-context"},sI={key:0,class:"context-item"},aI={key:1,class:"context-item"},iI={key:2,class:"context-item"},lI={class:"incident-footer"},rI={class:"reporter-info"},cI={class:"time-info"},uI={__name:"IncidentCard",props:{incident:{type:Object,required:!0}},emits:["select"],setup(e){const t=e,o=G(()=>{if(t.incident.title)return t.incident.title;const u=t.incident.description||"";return u.length<=60?u:u.substring(0,57).trim()+"..."}),a=u=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[u]||u,s=u=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[u]||u,i=(u,d=120)=>!u||u.length<=d?u:u.substring(0,d).trim()+"...",l=u=>{if(!u)return"";const d=new Date(u),p=new Date-d,g=Math.floor(p/6e4),y=Math.floor(p/36e5),k=Math.floor(p/864e5);return g<1?"just now":g<60?`${g}m ago`:y<24?`${y}h ago`:k<7?`${k}d ago`:d.toLocaleDateString()};return(u,d)=>(v(),m("div",{class:ce(["incident-card",[`severity-${e.incident.severity}`,`status-${e.incident.status}`]]),onClick:d[0]||(d[0]=f=>u.$emit("select",e.incident))},[r("div",Xx,[r("div",Qx,[r("span",{class:ce(["severity-indicator",e.incident.severity])},null,2),r("strong",eI,C(o.value),1)]),r("div",tI,[r("span",{class:ce(["severity-badge",e.incident.severity])},C(a(e.incident.severity)),3),r("span",{class:ce(["status-badge",e.incident.status])},C(s(e.incident.status)),3)])]),e.incident.title&&e.incident.description?(v(),m("div",nI,C(i(e.incident.description)),1)):M("",!0),r("div",oI,[e.incident.context?.checkpoint?(v(),m("div",sI,[d[1]||(d[1]=r("span",{class:"context-icon"},"",-1)),r("span",null,C(e.incident.context.checkpoint.name),1)])):e.incident.latitude&&e.incident.longitude?(v(),m("div",aI,[...d[2]||(d[2]=[r("span",{class:"context-icon"},"",-1),r("span",null,"GPS Location",-1)])])):M("",!0),e.incident.area?(v(),m("div",iI,[d[3]||(d[3]=r("span",{class:"context-icon"},"",-1)),r("span",null,C(e.incident.area.areaName),1)])):M("",!0)]),r("div",lI,[r("span",rI," Reported by "+C(e.incident.reportedBy?.name||"Unknown"),1),r("span",cI,C(l(e.incident.incidentTime||e.incident.createdAt)),1)])],2))}},ql=je(uI,[["__scopeId","data-v-690fd385"]]),dI={class:"incidents-tab"},hI={class:"tab-header"},fI={class:"button-group"},pI={key:0,class:"status-pills"},vI={class:"filters-section"},mI={class:"search-group"},gI={class:"incidents-list"},yI={key:0,class:"loading-state"},kI={key:1,class:"empty-state"},_I={__name:"IncidentsTab",props:{incidents:{type:Array,required:!0},areas:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["select-incident","report-incident"],setup(e,{emit:t}){const o=e,a=$(""),s=$("all"),i=y=>{s.value=y},l=G(()=>o.incidents.filter(y=>y.status==="open").length),u=G(()=>o.incidents.filter(y=>y.status==="in_progress"||y.status==="acknowledged").length),d=G(()=>o.incidents.filter(y=>y.status==="resolved").length),f=G(()=>o.incidents.filter(y=>y.status==="closed").length),p=G(()=>{let y=o.incidents;if(s.value==="open"?y=y.filter(k=>k.status==="open"):s.value==="in-progress"?y=y.filter(k=>k.status==="in_progress"||k.status==="acknowledged"):s.value==="resolved"?y=y.filter(k=>k.status==="resolved"):s.value==="closed"&&(y=y.filter(k=>k.status==="closed")),a.value.trim()){const k=a.value.toLowerCase().trim().split(/\s+/);y=y.filter(_=>{const w=`${_.context?.checkpoint?.name||""} ${_.context?.checkpoint?.description||""}`,S=_.area?.areaName||"",A=[_.reportedBy?.name||"",...(_.context?.peopleAtCheckpoint||[]).map(P=>P.name||"")].join(" "),T=(_.updates||[]).map(P=>P.note||"").join(" "),x=`${_.title||""} ${_.description||""} ${w} ${S} ${A} ${T}`.toLowerCase();return k.every(P=>x.includes(P))})}return y}),g=G(()=>[...p.value].sort((y,k)=>new Date(k.incidentTime||k.createdAt)-new Date(y.incidentTime||y.createdAt)));return(y,k)=>(v(),m("div",dI,[r("div",hI,[r("div",fI,[r("button",{onClick:k[0]||(k[0]=_=>y.$emit("report-incident")),class:"btn btn-primary"}," Report incident ")]),e.incidents.length>0?(v(),m("div",pI,[Ae(xn,{variant:"neutral",active:s.value==="all",onClick:k[1]||(k[1]=_=>i("all"))},{default:ze(()=>[Ye(C(e.incidents.length)+" total ",1)]),_:1},8,["active"]),l.value>0?(v(),Ze(xn,{key:0,variant:"info",active:s.value==="open",onClick:k[2]||(k[2]=_=>i("open"))},{default:ze(()=>[Ye(C(l.value)+" open ",1)]),_:1},8,["active"])):M("",!0),u.value>0?(v(),Ze(xn,{key:1,variant:"purple",active:s.value==="in-progress",onClick:k[3]||(k[3]=_=>i("in-progress"))},{default:ze(()=>[Ye(C(u.value)+" in progress ",1)]),_:1},8,["active"])):M("",!0),d.value>0?(v(),Ze(xn,{key:2,variant:"success",active:s.value==="resolved",onClick:k[4]||(k[4]=_=>i("resolved"))},{default:ze(()=>[Ye(C(d.value)+" resolved ",1)]),_:1},8,["active"])):M("",!0),f.value>0?(v(),Ze(xn,{key:3,variant:"neutral",active:s.value==="closed",onClick:k[5]||(k[5]=_=>i("closed"))},{default:ze(()=>[Ye(C(f.value)+" closed ",1)]),_:1},8,["active"])):M("",!0)])):M("",!0)]),r("div",vI,[r("div",mI,[He(r("input",{"onUpdate:modelValue":k[6]||(k[6]=_=>a.value=_),type:"text",class:"search-input",placeholder:"Search by title, description, location, area, or person..."},null,512),[[st,a.value]])])]),r("div",gI,[e.loading?(v(),m("div",yI," Loading incidents... ")):p.value.length===0?(v(),m("div",kI,[r("p",null,C(a.value||s.value!=="all"?"No incidents match your search or filter.":"No incidents reported yet."),1)])):M("",!0),(v(!0),m(Se,null,Ne(g.value,_=>(v(),Ze(ql,{key:_.incidentId,incident:_,onSelect:w=>y.$emit("select-incident",_)},null,8,["incident","onSelect"]))),128))])]))}},bI=je(_I,[["__scopeId","data-v-56bde653"]]),wI={class:"checkpoint-card-header"},CI={class:"checkpoint-name-row"},LI=["innerHTML"],SI={class:"checkpoint-name"},xI={key:0,class:"checkpoint-description"},II={key:0,class:"checkpoint-card-areas"},$I={class:"checkpoint-card-stats"},TI={key:1,class:"checkpoint-card-marshals"},MI={__name:"CheckpointCard",props:{checkpoint:{type:Object,required:!0},areas:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const o=e,a=t,s=G(()=>o.checkpoint.areaIds||o.checkpoint.AreaIds||[]),i=S=>{const A=o.areas.find(T=>T.id===S);return A?A.name:null},l=S=>{const A=o.areas.find(T=>T.id===S);return A?A.color:"#999"},u=G(()=>{const S=o.checkpoint,A=S.resolvedStyleBackgroundColor||S.ResolvedStyleBackgroundColor||S.resolvedStyleColor||S.ResolvedStyleColor;return A||(s.value.length>0?l(s.value[0]):"#667eea")}),d=G(()=>{const S=o.checkpoint;return S.requiredMarshals===0?null:S.checkedInCount>=S.requiredMarshals?"full":S.checkedInCount>0?"partial":"none"}),f=G(()=>[...o.checkpoint.assignments||[]].sort((A,T)=>(A.marshalName||"").localeCompare(T.marshalName||"",void 0,{sensitivity:"base"}))),p=G(()=>(o.checkpoint.assignments||[]).length),g=G(()=>(o.checkpoint.assignments||[]).filter(S=>S.isCheckedIn).length),y=G(()=>d.value?`staffing-${d.value}`:""),k=G(()=>{const S=p.value,A=g.value;return S===0?"":A===0?"checkin-none":A>=S?"checkin-full":"checkin-partial"}),_=G(()=>{const S=o.checkpoint,A=S.resolvedStyleType||S.ResolvedStyleType,T=S.resolvedStyleBackgroundColor||S.ResolvedStyleBackgroundColor||S.resolvedStyleColor||S.ResolvedStyleColor,x=S.resolvedStyleBorderColor||S.ResolvedStyleBorderColor,P=S.resolvedStyleIconColor||S.ResolvedStyleIconColor,O=S.resolvedStyleBackgroundShape||S.ResolvedStyleBackgroundShape;return A&&A!=="default"||T||x||P||O&&O!=="circle"?Sn({type:A||"circle",backgroundShape:O||"circle",backgroundColor:T||"#667eea",borderColor:x||"#ffffff",iconColor:P||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),w=()=>{o.clickable&&a("click",o.checkpoint)};return(S,A)=>(v(),m("div",{class:ce(["checkpoint-card",{"is-clickable":e.clickable,"staffed-full":d.value==="full","staffed-partial":d.value==="partial","staffed-none":d.value==="none"}]),style:Qe({borderLeftColor:u.value}),onClick:w},[r("div",wI,[r("div",{class:ce(["checkpoint-card-title",{clickable:e.clickable}])},[r("span",CI,[r("span",{class:"checkpoint-icon",innerHTML:_.value},null,8,LI),r("span",SI,C(e.checkpoint.name),1),e.checkpoint.description?(v(),m("span",xI,"  "+C(e.checkpoint.description),1)):M("",!0)])],2)]),s.value.length>0?(v(),m("div",II,[(v(!0),m(Se,null,Ne(s.value,T=>(v(),m("span",{key:T,class:"area-badge",style:Qe({backgroundColor:l(T)})},C(i(T)),5))),128))])):M("",!0),r("div",$I,[r("span",{class:ce(["stat-badge staffing-badge",y.value])},C(e.checkpoint.checkedInCount)+"/"+C(e.checkpoint.requiredMarshals)+" staffed ",3),p.value>0?(v(),m("span",{key:0,class:ce(["stat-badge",k.value])},C(g.value)+"/"+C(p.value)+" checked in ",3)):M("",!0)]),f.value.length>0?(v(),m("div",TI,[(v(!0),m(Se,null,Ne(f.value,T=>(v(),m("span",{key:T.id,class:ce(["marshal-badge",{"checked-in":T.isCheckedIn}])},C(T.marshalName),3))),128))])):M("",!0)],6))}},AI=je(MI,[["__scopeId","data-v-da001590"]]),Jv={__name:"CheckpointsGrid",props:{checkpoints:{type:Array,required:!0},areas:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No checkpoints."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,o)=>(v(),Ze(Zl,{"is-empty":e.checkpoints.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:ze(()=>[(v(!0),m(Se,null,Ne(e.checkpoints,a=>(v(),Ze(AI,{key:a.id,checkpoint:a,areas:e.areas,clickable:!0,onClick:o[0]||(o[0]=s=>t.$emit("select",s))},null,8,["checkpoint","areas"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},EI={class:"checkpoints-tab"},PI={class:"tab-header"},DI={class:"button-group"},RI={key:0,class:"status-pills"},OI={class:"filters-section"},BI={class:"search-group"},NI=["placeholder"],FI={__name:"CheckpointsList",props:{locations:{type:Array,required:!0},areas:{type:Array,default:()=>[]}},emits:["add-checkpoint-manually","import-checkpoints","select-location"],setup(e){const{termsLower:t}=ht(),o=e,a=$(""),s=$("all"),i=k=>{s.value=k},l=G(()=>o.locations.filter(k=>k.checkedInCount>=k.requiredMarshals&&k.requiredMarshals>0).length),u=G(()=>o.locations.filter(k=>k.checkedInCount>0&&k.checkedInCount<k.requiredMarshals).length),d=G(()=>o.locations.filter(k=>k.checkedInCount===0&&k.requiredMarshals>0).length),f=k=>{const _=o.areas.find(w=>w.id===k);return _?_.name:null},p=G(()=>{let k=o.locations;if(s.value==="full"?k=k.filter(_=>_.checkedInCount>=_.requiredMarshals&&_.requiredMarshals>0):s.value==="partial"?k=k.filter(_=>_.checkedInCount>0&&_.checkedInCount<_.requiredMarshals):s.value==="missing"&&(k=k.filter(_=>_.checkedInCount===0&&_.requiredMarshals>0)),a.value.trim()){const _=a.value.toLowerCase().trim().split(/\s+/);k=k.filter(w=>{const A=(w.areaIds||w.AreaIds||[]).map(P=>f(P)||"").join(" "),T=(w.assignments||[]).map(P=>P.marshalName||"").join(" "),x=`${w.name||""} ${w.description||""} ${A} ${T}`.toLowerCase();return _.every(P=>x.includes(P))})}return k}),g=G(()=>[...p.value].sort((k,_)=>Vs(k.name,_.name))),y=G(()=>{const k=a.value.trim();return s.value==="full"?k?`No fully staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully staffed.`:s.value==="partial"?k?`No partially staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially staffed.`:s.value==="missing"?k?`No unstaffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are unstaffed.`:k?`No ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} yet. Add one to get started!`});return(k,_)=>(v(),m("div",EI,[r("div",PI,[r("div",DI,[r("button",{onClick:_[0]||(_[0]=w=>k.$emit("add-checkpoint-manually")),class:"btn btn-primary"}," Add "+C(B(t).checkpoint),1),r("button",{onClick:_[1]||(_[1]=w=>k.$emit("import-checkpoints")),class:"btn btn-secondary"}," Import CSV ")]),e.locations.length>0?(v(),m("div",RI,[Ae(xn,{variant:"neutral",active:s.value==="all",onClick:_[2]||(_[2]=w=>i("all"))},{default:ze(()=>[Ye(C(e.locations.length)+" total ",1)]),_:1},8,["active"]),l.value>0?(v(),Ze(xn,{key:0,variant:"success",active:s.value==="full",onClick:_[3]||(_[3]=w=>i("full"))},{default:ze(()=>[Ye(C(l.value)+" fully staffed ",1)]),_:1},8,["active"])):M("",!0),u.value>0?(v(),Ze(xn,{key:1,variant:"warning",active:s.value==="partial",onClick:_[4]||(_[4]=w=>i("partial"))},{default:ze(()=>[Ye(C(u.value)+" partial ",1)]),_:1},8,["active"])):M("",!0),d.value>0?(v(),Ze(xn,{key:2,variant:"danger",active:s.value==="missing",onClick:_[5]||(_[5]=w=>i("missing"))},{default:ze(()=>[Ye(C(d.value)+" unstaffed ",1)]),_:1},8,["active"])):M("",!0)])):M("",!0)]),r("div",OI,[r("div",BI,[He(r("input",{"onUpdate:modelValue":_[6]||(_[6]=w=>a.value=w),type:"text",class:"search-input",placeholder:`Search by name, description, ${B(t).area}, or ${B(t).person}...`},null,8,NI),[[st,a.value]])])]),Ae(Jv,{checkpoints:g.value,areas:e.areas,"empty-message":y.value,onSelect:_[7]||(_[7]=w=>k.$emit("select-location",w))},null,8,["checkpoints","areas","empty-message"])]))}},UI=je(FI,[["__scopeId","data-v-35be2364"]]),zI={class:"area-card-header"},HI={class:"area-name-row"},VI={class:"area-name"},GI={key:0,class:"default-badge"},jI={key:0,class:"area-description"},ZI={class:"area-card-stats"},qI={class:"stat-badge"},WI={class:"stat-badge"},KI={__name:"AreaCard",props:{area:{type:Object,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const o=e,a=t,s=G(()=>o.area.checkpointCount!==void 0?o.area.checkpointCount:o.checkpoints.filter(p=>(p.areaIds||p.AreaIds||[]).includes(o.area.id)||p.areaId===o.area.id).length),i=G(()=>o.contacts.filter(p=>p.scopeConfigurations?p.scopeConfigurations.some(g=>g.scope==="EveryoneInAreas"&&g.itemType==="Area"?g.ids?.includes("ALL_AREAS")?!0:g.ids?.includes(o.area.id):!1):!1).length),l=G(()=>o.area.peopleTerm||o.eventPeopleTerm||"Marshals"),u=G(()=>{const p=o.area.checkpointTerm||o.eventCheckpointTerm||"Checkpoints";return s.value===1?Ja("checkpoint",p,l.value):Uv("checkpoint",p,l.value)}),d=G(()=>`${s.value} ${u.value.toLowerCase()}`),f=()=>{o.clickable&&a("click",o.area)};return(p,g)=>(v(),m("div",{class:ce(["area-card",{"is-clickable":e.clickable,"is-default":e.area.isDefault}]),style:Qe({borderLeftColor:e.area.color||"#667eea"}),onClick:f},[r("div",zI,[r("div",{class:ce(["area-card-title",{clickable:e.clickable}])},[r("div",HI,[r("span",VI,C(e.area.name),1),e.area.isDefault?(v(),m("span",GI,"Default")):M("",!0)]),e.area.description?(v(),m("span",jI,C(e.area.description),1)):M("",!0)],2)]),r("div",ZI,[r("span",qI,C(d.value),1),r("span",WI,C(i.value)+" contact"+C(i.value===1?"":"s"),1)])],6))}},JI=je(KI,[["__scopeId","data-v-8ac20bf2"]]),YI={__name:"AreasGrid",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},emptyMessage:{type:String,default:"No areas."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,o)=>(v(),Ze(Zl,{"is-empty":e.areas.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:ze(()=>[(v(!0),m(Se,null,Ne(e.areas,a=>(v(),Ze(JI,{key:a.id,area:a,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,clickable:!0,onClick:o[0]||(o[0]=s=>t.$emit("select",s))},null,8,["area","checkpoints","contacts","event-people-term","event-checkpoint-term"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},XI={class:"areas-tab"},QI={class:"tab-header"},e$={class:"button-group"},t$={key:0,class:"status-pills"},n$={class:"filters-section"},o$={class:"search-group"},s$=["placeholder"],a$={__name:"AreasList",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["add-area","select-area"],setup(e){const{termsLower:t}=ht(),o=e,a=$(""),s=d=>o.checkpoints.filter(f=>(f.areaIds||f.AreaIds||[]).includes(d)||f.areaId===d),i=G(()=>{if(!a.value.trim())return o.areas;const d=a.value.toLowerCase().trim().split(/\s+/);return o.areas.filter(f=>{const g=s(f.id).map(k=>`${k.name||""} ${k.description||""}`).join(" "),y=`${f.name||""} ${f.description||""} ${g}`.toLowerCase();return d.every(k=>y.includes(k))})}),l=G(()=>[...i.value].sort((d,f)=>d.displayOrder!==f.displayOrder?d.displayOrder-f.displayOrder:Vs(d.name,f.name))),u=G(()=>a.value.trim()?`No ${t.value.areas} match your search.`:`No ${t.value.areas} yet. Click "Add ${t.value.area}" to create one.`);return(d,f)=>(v(),m("div",XI,[r("div",QI,[r("div",e$,[r("button",{onClick:f[0]||(f[0]=p=>d.$emit("add-area")),class:"btn btn-primary"}," Add "+C(B(t).area),1)]),e.areas.length>0?(v(),m("div",t$,[Ae(xn,{variant:"neutral",active:!1},{default:ze(()=>[Ye(C(e.areas.length)+" "+C(e.areas.length===1?B(t).area:B(t).areas),1)]),_:1})])):M("",!0)]),r("div",n$,[r("div",o$,[He(r("input",{"onUpdate:modelValue":f[1]||(f[1]=p=>a.value=p),type:"text",class:"search-input",placeholder:`Search by ${B(t).area} name or ${B(t).checkpoint} name...`},null,8,s$),[[st,a.value]])])]),Ae(YI,{areas:l.value,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,"empty-message":u.value,onSelect:f[2]||(f[2]=p=>d.$emit("select-area",p))},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term","empty-message"])]))}},i$=je(a$,[["__scopeId","data-v-203f9606"]]),l$={course:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>',checkpoint:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',area:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',marshal:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',checklist:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>',notes:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/></svg>',incidents:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>',details:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16h6"/></svg>',location:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',contacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>',people:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polygon points="22 8 19.5 10 20.5 13 18 11.5 15.5 13 16.5 10 14 8 17 8 18 5 19 8 22 8" fill="currentColor"/></svg>',eventContacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 8V6a2 2 0 0 0-2-2h-2"/><path d="M22 12v2a2 2 0 0 1-2 2h-2"/></svg>',event:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>',appearance:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12.5" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>',logout:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>'},Yn=e=>l$[e]||"",r$={class:"responsive-tabs"},c$=["onClick"],u$=["innerHTML"],d$=["innerHTML"],h$={class:"hamburger-label"},f$=["onClick"],p$=["innerHTML"],v$={__name:"ResponsiveTabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,a=t,s=$(null),i=$(null),l=$(null),u=$(!1),d=$({}),f=$(!1),p=G(()=>o.tabs.find(A=>A.value===o.modelValue)),g=G(()=>p.value?p.value.label:"Menu"),y=()=>{if(u.value=!u.value,u.value&&i.value){const A=i.value.getBoundingClientRect();d.value={top:`${A.bottom+4}px`}}},k=A=>{a("update:modelValue",A),u.value=!1},_=A=>{if(!s.value)return;const T=s.value.contains(A.target);u.value&&!T&&(u.value=!1)},w=()=>{if(!l.value)return;const A=l.value,T=f.value;T&&(A.style.visibility="visible",A.style.position="static");const x=A.scrollWidth>A.clientWidth;T&&(A.style.visibility="",A.style.position=""),f.value=x};let S=null;return on(()=>{document.addEventListener("click",_),un(()=>{w()}),un(()=>{const A=l.value?.parentElement;A&&(S=new ResizeObserver(()=>{w()}),S.observe(A))})}),$n(()=>{document.removeEventListener("click",_),S&&S.disconnect()}),qe(()=>o.tabs,()=>{un(()=>{w()})},{deep:!0}),(A,T)=>(v(),m("div",r$,[r("div",{ref_key:"visibleTabsRef",ref:l,class:ce(["visible-tabs",{"is-hidden":f.value}])},[(v(!0),m(Se,null,Ne(e.tabs,x=>(v(),m("button",{key:x.value,class:ce(["tab-button",{active:e.modelValue===x.value}]),onClick:P=>A.$emit("update:modelValue",x.value),type:"button"},[x.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:B(Yn)(x.icon)},null,8,u$)):M("",!0),Ye(" "+C(x.label),1)],10,c$))),128))],2),r("div",{class:ce(["hamburger-only",{"is-visible":f.value}])},[r("div",{class:"hamburger-menu",ref_key:"hamburgerMenu",ref:s},[r("button",{ref_key:"hamburgerButton",ref:i,class:ce(["hamburger-button",{active:u.value}]),onClick:rt(y,["stop"]),type:"button"},[T[1]||(T[1]=r("span",{class:"hamburger-icon"},"",-1)),p.value?.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:B(Yn)(p.value.icon)},null,8,d$)):M("",!0),r("span",h$,C(g.value),1)],2),u.value?(v(),m("div",{key:0,class:"hamburger-dropdown",style:Qe(d.value),onClick:T[0]||(T[0]=rt(()=>{},["stop"]))},[(v(!0),m(Se,null,Ne(e.tabs,x=>(v(),m("button",{key:x.value,class:ce(["dropdown-item",{active:e.modelValue===x.value}]),onClick:rt(P=>k(x.value),["stop"]),type:"button"},[x.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:B(Yn)(x.icon)},null,8,p$)):M("",!0),Ye(" "+C(x.label),1)],10,f$))),128))],4)):M("",!0)],512)],2)]))}},m$=je(v$,[["__scopeId","data-v-2467c6fc"]]),g$={class:"confirm-modal"},y$={class:"confirm-actions"},k$={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},showCancel:{type:Boolean,default:!0},isDanger:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(e,{emit:t}){const o=t,a=()=>{o("confirm")},s=()=>{o("cancel")};return(i,l)=>e.show?(v(),m("div",{key:0,class:"modal-overlay",onClick:rt(s,["self"])},[r("div",g$,[r("h3",null,C(e.title),1),r("p",null,C(e.message),1),r("div",y$,[e.showCancel?(v(),m("button",{key:0,onClick:s,class:"btn btn-secondary"},C(e.cancelText),1)):M("",!0),r("button",{onClick:a,class:ce(["btn",e.isDanger?"btn-danger":"btn-primary"])},C(e.confirmText),3)])])])):M("",!0)}},Bl=je(k$,[["__scopeId","data-v-bead7a29"]]),_$={class:"base-modal-header"},b$={class:"base-modal-header-content"},w$={key:0,class:"base-modal-title"},C$={key:0,class:"base-modal-tab-header"},L$={key:1,class:"base-modal-footer"},S$={key:0,class:"base-modal-actions"},x$={__name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},variant:{type:String,default:"center",validator:e=>["center","sidebar"].includes(e)},zIndex:{type:Number,default:1e3},closeOnOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},confirmOnClose:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=()=>{const x=document.documentElement,P=getComputedStyle(x).getPropertyValue("--modal-resize-duration").trim();return P.endsWith("s")?parseFloat(P)*1e3:300},a=e,s=t,i=$(!1),l=$(!1),u=$(null),d=$(null);let f=null,p=!1,g=0;const y=()=>{if(!d.value||!u.value||p)return;const x=d.value.scrollHeight,P=g;if(P===x||g===0){g=x;return}p=!0,d.value.style.height=`${P}px`,d.value.style.overflow="hidden",d.value.offsetHeight,d.value.style.transition="height var(--modal-resize-duration, 0.3s) ease",d.value.style.height=`${x}px`;const O=o();setTimeout(()=>{d.value&&(d.value.style.height="",d.value.style.overflow="",d.value.style.transition=""),p=!1,g=x},O)},k=()=>{!u.value||typeof MutationObserver>"u"||(d.value&&(g=d.value.scrollHeight),f=new MutationObserver(()=>{un(()=>{y()})}),f.observe(u.value,{childList:!0,subtree:!0,attributes:!0,characterData:!0}))},_=()=>{f&&(f.disconnect(),f=null)};on(()=>{un(()=>{a.show&&k()})}),$n(()=>{_()}),qe(()=>a.show,x=>{x?un(()=>{g=0,k()}):_()});const w=()=>{a.closeOnOverlay&&S()},S=()=>{a.confirmOnClose&&a.isDirty?i.value=!0:s("close")},A=()=>{i.value=!1,s("close")},T=()=>{i.value=!1};return(x,P)=>(v(),Ze(ys,{name:"modal",appear:""},{default:ze(()=>[e.show?(v(),m("div",{key:0,class:"base-modal-overlay",style:Qe({zIndex:e.zIndex}),onClick:rt(w,["self"])},[r("div",{class:ce(["base-modal",[`base-modal--${e.size}`,`base-modal--${e.variant}`]])},[r("div",_$,[r("div",b$,[io(x.$slots,"header",{},()=>[e.title?(v(),m("h2",w$,C(e.title),1)):M("",!0)],!0)]),e.showCloseButton?(v(),m("button",{key:0,onClick:S,class:"base-modal-close",type:"button","aria-label":"Close"},"  ")):M("",!0)]),x.$slots["tab-header"]?(v(),m("div",C$,[io(x.$slots,"tab-header",{},void 0,!0)])):M("",!0),r("div",{class:"base-modal-body",ref_key:"bodyRef",ref:u},[r("div",{class:"base-modal-body-content",ref_key:"contentRef",ref:d},[io(x.$slots,"default",{},void 0,!0)],512)],512),x.$slots.footer||x.$slots.actions?(v(),m("div",L$,[io(x.$slots,"footer",{},()=>[x.$slots.actions?(v(),m("div",S$,[io(x.$slots,"actions",{},void 0,!0)])):M("",!0)],!0)])):M("",!0)],2),e.confirmOnClose&&!l.value?(v(),Ze(Bl,{key:0,show:i.value,title:"Unsaved changes",message:"You have unsaved changes. Are you sure you want to close?",onConfirm:A,onCancel:T},null,8,["show"])):M("",!0)],4)):M("",!0)]),_:3}))}},Vt=je(x$,[["__scopeId","data-v-141bdab1"]]),I$={class:"share-link-container"},$$=["value"],T$={__name:"ShareLinkModal",props:{show:{type:Boolean,default:!1},link:{type:String,required:!0},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=t,a=$(!1),s=$(null),i=()=>{s.value&&(s.value.select(),document.execCommand("copy"),a.value=!0,setTimeout(()=>{a.value=!1},2e3))},l=()=>{o("close")};return(u,d)=>(v(),Ze(Vt,{show:e.show,title:"Marshal check-in link",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:l},{actions:ze(()=>[r("button",{onClick:l,class:"btn btn-secondary"},"Close")]),default:ze(()=>[d[0]||(d[0]=r("p",{class:"instruction"},"Share this link with marshals so they can check in:",-1)),r("div",I$,[r("input",{value:e.link,readonly:"",class:"form-input",ref_key:"linkInput",ref:s},null,8,$$),r("button",{onClick:i,class:"btn btn-primary"},C(a.value?"Copied!":"Copy"),1)])]),_:1},8,["show","is-dirty"]))}},M$=je(T$,[["__scopeId","data-v-98fe71d6"]]),A$={class:"success-content"},E$={class:"success-message"},P$={class:"link-section"},D$={class:"help-text"},R$={key:0,class:"loading-text"},O$={key:1,class:"magic-link-container"},B$=["value"],N$={class:"magic-link-actions"},F$=["disabled"],U$={key:0,class:"success-text"},z$={key:1,class:"error-text"},H$={key:2,class:"error-text"},V$={__name:"MarshalCreatedModal",props:{show:{type:Boolean,default:!1},eventId:{type:String,required:!0},marshalId:{type:String,default:null},marshalName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const{terms:o}=ht(),a=e,s=t,i=$(""),l=$(!1),u=$(!1),d=$(""),f=$(!1),p=$(!1),g=$(!1),y=$(""),k=async()=>{if(!(!a.eventId||!a.marshalId)){u.value=!0,d.value="";try{const A=await gs.getMagicLink(a.eventId,a.marshalId);i.value=A.data.magicLink,l.value=A.data.hasEmail}catch(A){console.error("Failed to fetch magic link:",A),d.value="Failed to load login link"}finally{u.value=!1}}},_=async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(i.value);else{const A=document.createElement("textarea");A.value=i.value,A.style.position="fixed",A.style.left="-9999px",document.body.appendChild(A),A.select(),document.execCommand("copy"),document.body.removeChild(A)}f.value=!0,setTimeout(()=>{f.value=!1},2e3)}catch(A){console.error("Failed to copy:",A)}},w=async()=>{if(!(!a.eventId||!a.marshalId)){p.value=!0,g.value=!1,y.value="";try{await gs.sendMagicLink(a.eventId,a.marshalId),g.value=!0,setTimeout(()=>{g.value=!1},3e3)}catch(A){console.error("Failed to send email:",A),y.value=A.response?.data?.message||"Failed to send email"}finally{p.value=!1}}},S=()=>{s("close")};return qe(()=>a.show,A=>{A&&a.marshalId?k():(i.value="",l.value=!1,d.value="",f.value=!1,g.value=!1,y.value="")},{immediate:!0}),(A,T)=>(v(),Ze(Vt,{show:e.show,title:`${B(o).person} created`,size:"medium","confirm-on-close":!1,"is-dirty":!1,onClose:S},{actions:ze(()=>[r("button",{onClick:S,class:"btn btn-primary"},"Done")]),default:ze(()=>[r("div",A$,[T[2]||(T[2]=r("div",{class:"success-icon"},"",-1)),r("p",E$,[r("strong",null,C(e.marshalName),1),T[1]||(T[1]=Ye(" has been added successfully. ",-1))])]),r("div",P$,[T[3]||(T[3]=r("label",null,"Login link",-1)),r("p",D$," Share this unique link with "+C(e.marshalName)+" so they can access their dashboard and check in. ",1),u.value?(v(),m("div",R$,"Loading link...")):i.value?(v(),m("div",O$,[r("input",{type:"text",value:i.value,readonly:"",class:"form-input magic-link-input",onFocus:T[0]||(T[0]=x=>x.target.select())},null,40,B$),r("div",N$,[r("button",{type:"button",class:"btn btn-secondary",onClick:_},C(f.value?"Copied!":"Copy link"),1),l.value?(v(),m("button",{key:0,type:"button",class:"btn btn-primary",disabled:p.value,onClick:w},C(p.value?"Sending...":"Send via email"),9,F$)):M("",!0)]),g.value?(v(),m("p",U$,"Email sent successfully!")):M("",!0),y.value?(v(),m("p",z$,C(y.value),1)):M("",!0)])):d.value?(v(),m("div",H$,C(d.value),1)):M("",!0)])]),_:1},8,["show","title"]))}},G$=je(V$,[["__scopeId","data-v-e99677e9"]]),j$={class:"form-group"},Z$={__name:"AddAdminModal",props:{show:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,s=$("");qe(()=>o.show,d=>{d||(s.value="")});const i=()=>{a("update:isDirty",!0)},l=()=>{a("submit",s.value)},u=()=>{a("close")};return(d,f)=>(v(),Ze(Vt,{show:e.show,title:"Add event administrator",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:ze(()=>[r("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-primary"}," Add administrator ")]),default:ze(()=>[f[2]||(f[2]=r("p",{class:"instruction"},"Enter the email address of the administrator to add",-1)),r("form",{onSubmit:rt(l,["prevent"])},[r("div",j$,[f[1]||(f[1]=r("label",null,"Email address",-1)),He(r("input",{"onUpdate:modelValue":f[0]||(f[0]=p=>s.value=p),type:"email",required:"",class:"form-input",placeholder:"admin@example.com",onInput:i},null,544),[[st,s.value]])])],32)]),_:1},8,["show","is-dirty"]))}},q$=je(Z$,[["__scopeId","data-v-a82da194"]]),W$={class:"form-group"},K$={key:0,class:"error"},J$=["disabled"],Y$={__name:"UploadRouteModal",props:{show:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},error:{type:String,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,s=$(null);qe(()=>o.show,d=>{d||(s.value=null)});const i=d=>{s.value=d.target.files[0],a("update:isDirty",!0)},l=()=>{s.value&&a("submit",s.value)},u=()=>{a("close")};return(d,f)=>(v(),Ze(Vt,{show:e.show,title:"Upload GPX route",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:ze(()=>[r("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-primary",disabled:e.uploading},C(e.uploading?"Uploading...":"Upload route"),9,J$)]),default:ze(()=>[f[1]||(f[1]=r("p",{class:"instruction"},"Upload a GPX file to display the event route on the map",-1)),r("form",{onSubmit:rt(l,["prevent"])},[r("div",W$,[f[0]||(f[0]=r("label",null,"GPX file",-1)),r("input",{type:"file",accept:".gpx",onChange:i,required:"",class:"form-input"},null,32)]),e.error?(v(),m("div",K$,C(e.error),1)):M("",!0)],32)]),_:1},8,["show","is-dirty"]))}},X$=je(Y$,[["__scopeId","data-v-317975db"]]),Q$={class:"instruction"},eT={class:"form-group"},tT={class:"form-group"},nT={class:"checkbox-label"},oT={key:0,class:"error"},sT={key:1,class:"import-result"},aT={key:0,class:"import-errors"},iT=["disabled"],lT={__name:"ImportLocationsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ht(),s=e,i=t,l=$(null),u=$(!1);qe(()=>s.show,y=>{y||(l.value=null,u.value=!1)});const d=y=>{l.value=y.target.files[0],i("update:isDirty",!0)},f=()=>{i("update:isDirty",!0)},p=()=>{l.value&&i("submit",{file:l.value,deleteExisting:u.value})},g=()=>{i("close")};return(y,k)=>(v(),Ze(Vt,{show:e.show,title:`Import ${B(a).checkpoints} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:g},{actions:ze(()=>[r("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:p,class:"btn btn-primary",disabled:e.importing},C(e.importing?"Importing...":`Import ${B(a).checkpoints}`),9,iT)]),default:ze(()=>[r("p",Q$,"Upload a CSV file with columns: Label, Lat/Latitude, Long/Longitude, What3Words (optional), "+C(B(o).people)+" (optional)",1),k[3]||(k[3]=r("div",{class:"csv-example"},[r("strong",null,"Example CSV format:"),r("pre",null,`Label,Latitude,Longitude,What3Words,Marshals
Checkpoint 1,51.505,-0.09,filled.count.soap,"John Doe, Jane Smith"
Checkpoint 2,51.510,-0.10,index.home.raft,Bob Wilson`)],-1)),r("form",{onSubmit:rt(p,["prevent"])},[r("div",eT,[k[1]||(k[1]=r("label",null,"CSV file",-1)),r("input",{type:"file",accept:".csv",onChange:d,required:"",class:"form-input"},null,32)]),r("div",tT,[r("label",nT,[He(r("input",{type:"checkbox","onUpdate:modelValue":k[0]||(k[0]=_=>u.value=_),onChange:f},null,544),[[Oi,u.value]]),Ye(" Delete existing "+C(B(a).checkpoints)+" before import ",1)])]),e.error?(v(),m("div",oT,C(e.error),1)):M("",!0),e.result?(v(),m("div",sT,[r("p",null,"Created "+C(e.result.locationsCreated)+" "+C(B(a).checkpoints)+" and "+C(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),m("div",aT,[k[2]||(k[2]=r("strong",null,"Errors:",-1)),r("ul",null,[(v(!0),m(Se,null,Ne(e.result.errors,(_,w)=>(v(),m("li",{key:w},C(_),1))),128))])])):M("",!0)])):M("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},rT=je(lT,[["__scopeId","data-v-75c79d31"]]),cT={class:"instruction"},uT={class:"form-group"},dT={key:0,class:"error"},hT={key:1,class:"import-result"},fT={key:0,class:"import-errors"},pT=["disabled"],vT={__name:"ImportMarshalsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ht(),s=e,i=t,l=$(null);qe(()=>s.show,p=>{p||(l.value=null)});const u=p=>{l.value=p.target.files[0],i("update:isDirty",!0)},d=()=>{l.value&&i("submit",l.value)},f=()=>{i("close")};return(p,g)=>(v(),Ze(Vt,{show:e.show,title:`Import ${B(a).people} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:f},{actions:ze(()=>[r("button",{type:"button",onClick:f,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:d,class:"btn btn-primary",disabled:e.importing},C(e.importing?"Importing...":`Import ${B(a).people}`),9,pT)]),default:ze(()=>[r("p",cT,"Upload a CSV file with columns: Name, Email (optional), Phone (optional), "+C(B(o).checkpoint)+" (optional)",1),g[2]||(g[2]=r("div",{class:"csv-example"},[r("strong",null,"Example CSV format:"),r("pre",null,`Name,Email,Phone,Checkpoint
John Doe,john@example.com,555-1234,Checkpoint 1
Jane Smith,jane@example.com,555-5678,Checkpoint 2`)],-1)),r("form",{onSubmit:rt(d,["prevent"])},[r("div",uT,[g[0]||(g[0]=r("label",null,"CSV file",-1)),r("input",{type:"file",accept:".csv",onChange:u,required:"",class:"form-input"},null,32)]),e.error?(v(),m("div",dT,C(e.error),1)):M("",!0),e.result?(v(),m("div",hT,[r("p",null,"Imported "+C(e.result.marshalsCreated)+" "+C(B(a).people)+" and "+C(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),m("div",fT,[g[1]||(g[1]=r("strong",null,"Errors:",-1)),r("ul",null,[(v(!0),m(Se,null,Ne(e.result.errors,(y,k)=>(v(),m("li",{key:k},C(y),1))),128))])])):M("",!0)])):M("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},mT=je(vT,[["__scopeId","data-v-be89bf1f"]]),gT=["onClick"],yT=["innerHTML"],kT={class:"hamburger-nav"},_T=["disabled"],bT=["innerHTML"],wT={class:"current-tab-label"},CT=["disabled"],LT={key:0,class:"hamburger-menu"},ST=["onClick"],xT=["innerHTML"],IT=400,$T={__name:"TabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,a=t,s=$(null),i=$(null),l=$(null),u=$(!1),d=$(!1),f=G(()=>{const O=o.tabs.find(F=>F.value===o.modelValue);return O?O.label:""}),p=G(()=>o.tabs.find(F=>F.value===o.modelValue)?.icon||null),g=G(()=>o.tabs.findIndex(O=>O.value===o.modelValue)),y=G(()=>g.value>0),k=G(()=>g.value<o.tabs.length-1),_=()=>{y.value&&a("update:modelValue",o.tabs[g.value-1].value)},w=()=>{k.value&&a("update:modelValue",o.tabs[g.value+1].value)},S=()=>{if(!s.value)return;const O=s.value.clientWidth;if(O<IT){u.value=!0;return}if(i.value&&!u.value){i.value.scrollWidth>O&&(u.value=!0);return}const F=o.tabs.some(D=>D.icon)?110:90,E=o.tabs.length*F,N=(o.tabs.length-1)*8;E+N<=O&&(u.value=!1,un(()=>{i.value&&i.value.scrollWidth>O&&(u.value=!0)}))},A=()=>{d.value=!d.value},T=O=>{a("update:modelValue",O),d.value=!1},x=O=>{l.value&&!l.value.contains(O.target)&&(d.value=!1)};let P=null;return on(()=>{un(()=>{S(),s.value&&typeof ResizeObserver<"u"&&(P=new ResizeObserver(()=>{S()}),P.observe(s.value)),document.addEventListener("click",x)})}),$n(()=>{P&&P.disconnect(),document.removeEventListener("click",x)}),qe(()=>o.tabs,()=>{un(()=>{S()})},{deep:!0}),(O,F)=>(v(),m("div",{class:"tabs-container",ref_key:"containerRef",ref:s},[u.value?(v(),m("div",{key:1,class:"hamburger-container",ref_key:"hamburgerRef",ref:l},[r("div",kT,[r("button",{class:ce(["nav-arrow",{invisible:!y.value}]),onClick:_,type:"button","aria-label":"Previous tab",disabled:!y.value},"  ",10,_T),r("button",{class:"hamburger-button",onClick:A,type:"button","aria-label":"Tab menu"},[p.value?(v(),m("span",{key:0,class:"current-tab-icon",innerHTML:B(Yn)(p.value)},null,8,bT)):M("",!0),r("span",wT,C(f.value),1),F[0]||(F[0]=r("span",{class:"hamburger-chevron"},"",-1))]),r("button",{class:ce(["nav-arrow",{invisible:!k.value}]),onClick:w,type:"button","aria-label":"Next tab",disabled:!k.value},"  ",10,CT)]),d.value?(v(),m("div",LT,[(v(!0),m(Se,null,Ne(e.tabs,E=>(v(),m("button",{key:E.value,class:ce(["menu-item",{active:e.modelValue===E.value}]),onClick:N=>T(E.value),type:"button"},[E.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:B(Yn)(E.icon)},null,8,xT)):M("",!0),Ye(" "+C(E.label),1)],10,ST))),128))])):M("",!0)],512)):(v(),m("div",{key:0,class:"tabs",ref_key:"tabsRef",ref:i},[(v(!0),m(Se,null,Ne(e.tabs,E=>(v(),m("button",{key:E.value,class:ce(["tab-button",{active:e.modelValue===E.value}]),onClick:N=>O.$emit("update:modelValue",E.value),type:"button"},[E.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:B(Yn)(E.icon)},null,8,yT)):M("",!0),Ye(" "+C(E.label),1)],10,gT))),128))],512))],512))}},Zi=je($T,[["__scopeId","data-v-736c5d0a"]]),TT={class:"tab-content"},MT={class:"form-group"},AT=["value"],ET={class:"form-group"},PT=["value"],DT={class:"form-group"},RT={class:"area-display"},OT={key:0,class:"no-area"},BT={class:"form-help"},NT={class:"form-group checkbox-group"},FT={class:"checkbox-label"},UT=["checked"],zT={class:"form-help"},HT={key:0,class:"custom-times-section"},VT={class:"form-group"},GT=["value"],jT={class:"form-help"},ZT={class:"form-group"},qT=["value"],WT={class:"form-help"},KT={__name:"LocationDetailsTab",props:{form:{type:Object,required:!0},areas:{type:Array,default:()=>[]},eventDate:{type:String,default:""},areaTermSingular:{type:String,default:"Area"},areaTermPlural:{type:String,default:"Areas"},checkpointTermSingular:{type:String,default:"checkpoint"},peopleTermPlural:{type:String,default:"marshals"}},emits:["update:form","input","save"],setup(e,{emit:t}){const o=e,a=t,s=G(()=>(o.form.areaIds||o.form.AreaIds||[]).map(d=>o.areas.find(f=>f.id===d)).filter(d=>d!==void 0)),i=(u,d)=>{a("update:form",{...o.form,[u]:d}),a("input")},l=u=>{const d={...o.form,useCustomTimes:u};if(!u)d.startTime="",d.endTime="";else if(!d.startTime&&!d.endTime&&o.eventDate){const f=Ol(o.eventDate);d.startTime=f,d.endTime=f}a("update:form",d),a("input")};return(u,d)=>(v(),m("div",TT,[r("form",{onSubmit:d[5]||(d[5]=rt(f=>u.$emit("save"),["prevent"]))},[r("div",MT,[d[6]||(d[6]=r("label",null,"Name",-1)),r("input",{value:e.form.name,onInput:d[0]||(d[0]=f=>i("name",f.target.value)),type:"text",required:"",class:"form-input"},null,40,AT)]),r("div",ET,[d[7]||(d[7]=r("label",null,"Description (optional)",-1)),r("input",{value:e.form.description,onInput:d[1]||(d[1]=f=>i("description",f.target.value)),type:"text",class:"form-input"},null,40,PT)]),r("div",DT,[r("label",null,C(e.areaTermSingular)+" (auto-assigned by location)",1),r("div",RT,[s.value.length===0?(v(),m("span",OT," Not in any "+C(e.areaTermSingular.toLowerCase())+" polygon ",1)):M("",!0),(v(!0),m(Se,null,Ne(s.value,f=>(v(),m("span",{key:f.id,class:"area-badge",style:Qe({backgroundColor:f.color||"var(--brand-primary)"})},C(f.name),5))),128))]),r("small",BT,C(e.areaTermPlural)+" are automatically assigned based on "+C(e.checkpointTermSingular.toLowerCase())+" location within "+C(e.areaTermSingular.toLowerCase())+" boundaries ",1)]),r("div",NT,[r("label",FT,[r("input",{checked:e.form.useCustomTimes,onChange:d[2]||(d[2]=f=>l(f.target.checked)),type:"checkbox"},null,40,UT),r("span",null,"Use custom date/time for this "+C(e.checkpointTermSingular.toLowerCase()),1)]),r("small",zT," By default, "+C(e.peopleTermPlural.toLowerCase())+" are expected during the event date/time. Enable this to set a specific time range. ",1)]),e.form.useCustomTimes?(v(),m("div",HT,[r("div",VT,[d[8]||(d[8]=r("label",null,"Start date & time (optional)",-1)),r("input",{value:e.form.startTime,onInput:d[3]||(d[3]=f=>i("startTime",f.target.value)),type:"datetime-local",class:"form-input"},null,40,GT),r("small",jT," When "+C(e.peopleTermPlural.toLowerCase())+" should arrive at this "+C(e.checkpointTermSingular.toLowerCase()),1)]),r("div",ZT,[d[9]||(d[9]=r("label",null,"End date & time (optional)",-1)),r("input",{value:e.form.endTime,onInput:d[4]||(d[4]=f=>i("endTime",f.target.value)),type:"datetime-local",class:"form-input"},null,40,qT),r("small",WT," When "+C(e.peopleTermPlural.toLowerCase())+" can leave this "+C(e.checkpointTermSingular.toLowerCase()),1)])])):M("",!0)],32)]))}},JT=je(KT,[["__scopeId","data-v-aa628901"]]),YT={class:"scope-configuration-editor"},XT={class:"editor-header"},QT={class:"scope-types-list"},eM=["onClick"],tM={class:"scope-type-label"},nM={class:"scope-type-pill"},oM={class:"expand-label"},sM={class:"expand-icon"},aM={class:"modal-content"},iM={class:"modal-header"},lM={class:"modal-body"},rM={class:"scope-help"},cM={key:0,class:"form-group"},uM={class:"checkbox-label special-option"},dM=["checked"],hM={key:0,class:"specific-selection"},fM=["placeholder"],pM={class:"checkbox-group scrollable"},vM=["checked","onChange"],mM={key:1,class:"form-group"},gM={class:"checkbox-label special-option"},yM=["checked"],kM={key:0,class:"specific-selection"},_M={class:"checkbox-group scrollable"},bM=["checked","onChange"],wM={key:2,class:"form-group"},CM={class:"checkbox-label special-option"},LM=["checked"],SM={key:0,class:"specific-selection"},xM=["placeholder"],IM={class:"checkbox-group scrollable"},$M={key:0,class:"checkbox-label this-checkpoint-option"},TM=["checked"],MM={class:"checkpoint-info"},AM={class:"checkpoint-name"},EM=["checked","onChange"],PM={class:"checkpoint-info"},DM={class:"checkpoint-name"},RM={key:0,class:"checkpoint-description"},OM={__name:"ScopeConfigurationEditor",props:{modelValue:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},excludeScopes:{type:Array,default:()=>[]},headerText:{type:String,default:""},intent:{type:String,default:"completion",validator:e=>["completion","location-update"].includes(e)},currentCheckpointId:{type:String,default:null}},emits:["update:modelValue","user-changed"],setup(e,{emit:t}){const{termsLower:o}=ht(),a=e,s=t,i=G(()=>[{scope:"SpecificPeople",label:`Specific ${o.value.people}`},{scope:"EveryoneAtCheckpoints",label:`Every ${o.value.person} at specified ${o.value.checkpoints}`},{scope:"OnePerCheckpoint",label:`One ${o.value.person} at each specified ${o.value.checkpoint}`},{scope:"OnePerArea",label:`One ${o.value.person} in specified ${o.value.areas}`},{scope:"EveryoneInAreas",label:`Everyone in specified ${o.value.areas}`},{scope:"EveryAreaLead",label:`Every ${o.value.area} lead at specified ${o.value.areas}`},{scope:"OneLeadPerArea",label:`One lead per specified ${o.value.area}`}]),l=$({SpecificPeople:{enabled:!0,ids:["ALL_MARSHALS"]},EveryoneInAreas:{enabled:!1,ids:[]},EveryoneAtCheckpoints:{enabled:!1,ids:[]},OnePerCheckpoint:{enabled:!1,ids:[]},OnePerArea:{enabled:!1,ids:[]},EveryAreaLead:{enabled:!1,ids:[]},OneLeadPerArea:{enabled:!1,ids:[]}}),u=$(null),d=$(""),f=$(""),p=$(!a.isEditing);let g=!0,y=!1;const k=G(()=>i.value.filter(pe=>!a.excludeScopes.includes(pe.scope))),_=G(()=>p.value?k.value:k.value.filter(pe=>j(pe.scope))),w=G(()=>k.value.filter(Le=>j(Le.scope)).length<k.value.length),S=G(()=>{const pe=k.value.filter(Le=>j(Le.scope)).length;return k.value.length-pe}),A=G(()=>!a.currentCheckpointId&&a.intent==="location-update");qe(()=>a.modelValue,pe=>{if(pe){if(y){y=!1;return}g=!0,Object.keys(l.value).forEach(Le=>{l.value[Le]={enabled:!1,ids:[]}}),pe.forEach(Le=>{Le.scope==="Everyone"?l.value.SpecificPeople={enabled:!0,ids:["ALL_MARSHALS"]}:Le.scope==="AreaLead"?l.value.EveryAreaLead={enabled:!0,ids:[...Le.ids]}:l.value[Le.scope]&&(l.value[Le.scope]={enabled:!0,ids:[...Le.ids]})}),g=!1}},{immediate:!0});const T=()=>{const pe=[];return Object.keys(l.value).forEach(Le=>{const Pe=l.value[Le];if(Pe.enabled){const q={scope:Le,itemType:x(Le),ids:[...Pe.ids]};pe.push(q)}}),pe};qe(l,()=>{if(g)return;if(Object.keys(l.value).some(Pe=>Pe!=="SpecificPeople"&&l.value[Pe].enabled)&&l.value.SpecificPeople?.ids.includes("ALL_MARSHALS")){const Pe=l.value.SpecificPeople.ids.indexOf("ALL_MARSHALS");l.value.SpecificPeople.ids.splice(Pe,1),l.value.SpecificPeople.ids.length===0&&(l.value.SpecificPeople.enabled=!1)}y=!0;const Le=T();s("update:modelValue",Le),s("user-changed")},{deep:!0});const x=pe=>P(pe)?"Area":O(pe)?"Checkpoint":F(pe)?"Marshal":null,P=pe=>pe==="EveryoneInAreas"||pe==="OnePerArea"||pe==="EveryAreaLead"||pe==="OneLeadPerArea",O=pe=>pe==="EveryoneAtCheckpoints"||pe==="OnePerCheckpoint",F=pe=>pe==="SpecificPeople",E=pe=>{const Le=i.value.find(Pe=>Pe.scope===pe);return Le?Le.label:pe},N=G(()=>a.headerText?a.headerText:a.intent==="location-update"?"Who can update this location?":"Who can see and complete this item?"),D=pe=>a.intent==="location-update"?{SpecificPeople:`Select "Everyone" or choose specific ${o.value.people} who can update the location`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} can update the location`,OnePerCheckpoint:`Any ${o.value.person} at each selected ${o.value.checkpoint} can update the location`,OnePerArea:`Any ${o.value.person} in each selected ${o.value.area} can update the location`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} can update the location`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} can update the location`,OneLeadPerArea:`Any ${o.value.area} lead at the selected ${o.value.areas} can update the location`}[pe]||"":{SpecificPeople:`Select "Everyone at the event" or choose specific ${o.value.people} who must complete this (personal completion)`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} must complete this (personal completion)`,OnePerCheckpoint:`One completion needed at each selected ${o.value.checkpoint} (shared completion)`,OnePerArea:`One completion needed in each selected ${o.value.area} (shared completion)`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} must complete this (personal completion)`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} must complete this individually (personal completion)`,OneLeadPerArea:`One completion per ${o.value.area}, only ${o.value.area} leads can complete (shared among leads)`}[pe]||"",j=pe=>l.value[pe]?.enabled||!1,R=pe=>{const Le=l.value[pe];if(!Le||!Le.enabled)return"No";const Pe=Le.ids||[];if(P(pe)){if(Pe.includes("ALL_AREAS"))return`All ${o.value.areas}`;const q=Pe.length;return q>0?`${q} ${q!==1?o.value.areas:o.value.area}`:`Select ${o.value.areas}...`}if(O(pe)){if(Pe.includes("ALL_CHECKPOINTS"))return`All ${o.value.checkpoints}`;if(Pe.length===1&&Pe[0]==="THIS_CHECKPOINT")return`This ${o.value.checkpoint}`;const q=Pe.length;return q>0?`${q} ${q!==1?o.value.checkpoints:o.value.checkpoint}`:`Select ${o.value.checkpoints}...`}if(F(pe)){if(Pe.includes("ALL_MARSHALS"))return"Everyone";const q=Pe.length;return q>0?`${q} ${q!==1?o.value.people:o.value.person}`:`Select ${o.value.people}...`}return"Configured"},W=pe=>{u.value=pe,d.value="",f.value=""},ne=()=>{u.value=null},ue=()=>{u.value&&(l.value[u.value]={enabled:!1,ids:[]}),ne()},K=()=>u.value&&l.value[u.value]?.ids.includes("ALL_MARSHALS"),Q=()=>{if(!u.value)return;const pe=l.value[u.value];K()?(pe.ids=[],pe.enabled=!1):(pe.ids=["ALL_MARSHALS"],pe.enabled=!0)},he=pe=>u.value&&l.value[u.value]?.ids.includes(pe),U=pe=>{if(!u.value)return;const Le=l.value[u.value],Pe=Le.ids.indexOf(pe);Pe>=0?(Le.ids.splice(Pe,1),Le.ids.length===0&&(Le.enabled=!1)):(Le.ids.push(pe),Le.enabled=!0)},ee=G(()=>{if(!f.value)return a.marshals;const pe=f.value.toLowerCase();return a.marshals.filter(Le=>Le.name.toLowerCase().includes(pe)||Le.email&&Le.email.toLowerCase().includes(pe))}),de=()=>u.value&&l.value[u.value]?.ids.includes("ALL_AREAS"),re=()=>{if(!u.value)return;const pe=l.value[u.value];de()?(pe.ids=[],pe.enabled=!1):(pe.ids=["ALL_AREAS"],pe.enabled=!0)},De=pe=>u.value&&l.value[u.value]?.ids.includes(pe),et=pe=>{if(!u.value)return;const Le=l.value[u.value],Pe=Le.ids.indexOf(pe);Pe>=0?(Le.ids.splice(Pe,1),Le.ids.length===0&&(Le.enabled=!1)):(Le.ids.push(pe),Le.enabled=!0)},Je=()=>u.value&&l.value[u.value]?.ids.includes("ALL_CHECKPOINTS"),Fe=()=>{if(!u.value)return;const pe=l.value[u.value];Je()?(pe.ids=[],pe.enabled=!1):(pe.ids=["ALL_CHECKPOINTS"],pe.enabled=!0)},Ke=pe=>u.value&&l.value[u.value]?.ids.includes(pe),_e=pe=>{if(!u.value)return;const Le=l.value[u.value],Pe=Le.ids.indexOf(pe);Pe>=0?(Le.ids.splice(Pe,1),Le.ids.length===0&&(Le.enabled=!1)):(Le.ids.push(pe),Le.enabled=!0)},Ve=G(()=>{let pe=a.locations;if(d.value){const Le=d.value.toLowerCase();pe=pe.filter(Pe=>Pe.name.toLowerCase().includes(Le)||Pe.description&&Pe.description.toLowerCase().includes(Le))}return[...pe].sort((Le,Pe)=>Vs(Le.name,Pe.name))});return(pe,Le)=>(v(),m("div",YT,[r("div",XT,[r("h4",null,C(N.value),1)]),r("div",QT,[(v(!0),m(Se,null,Ne(_.value,Pe=>(v(),m("div",{key:Pe.scope,class:ce(["scope-type-row",{active:j(Pe.scope)}]),onClick:q=>W(Pe.scope)},[r("div",tM,C(Pe.label),1),r("div",nM,C(R(Pe.scope)),1)],10,eM))),128)),w.value?(v(),m("div",{key:0,class:"expand-row",onClick:Le[0]||(Le[0]=Pe=>p.value=!p.value)},[r("div",oM,C(p.value?"Show less":`Show ${S.value} more option${S.value!==1?"s":""}...`),1),r("div",sM,C(p.value?"":""),1)])):M("",!0)]),u.value?(v(),m("div",{key:0,class:"scope-config-modal",onClick:rt(ne,["self"])},[r("div",aM,[r("div",iM,[r("h5",null,C(E(u.value)),1),r("button",{onClick:ne,class:"btn-close",type:"button"},"")]),r("div",lM,[r("p",rM,C(D(u.value)),1),F(u.value)?(v(),m("div",cM,[r("label",uM,[r("input",{type:"checkbox",checked:K(),onChange:Q},null,40,dM),r("span",null,[Le[4]||(Le[4]=r("strong",null,"Everyone at the event",-1)),Ye(" (all current and future "+C(B(o).people)+")",1)])]),K()?M("",!0):(v(),m("div",hM,[He(r("input",{"onUpdate:modelValue":Le[1]||(Le[1]=Pe=>f.value=Pe),type:"text",placeholder:`Search ${B(o).people}...`,class:"search-input"},null,8,fM),[[st,f.value]]),r("div",pM,[(v(!0),m(Se,null,Ne(ee.value,Pe=>(v(),m("label",{key:Pe.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:he(Pe.id),onChange:q=>U(Pe.id)},null,40,vM),r("span",null,C(Pe.name),1)]))),128))])]))])):M("",!0),P(u.value)?(v(),m("div",mM,[r("label",gM,[r("input",{type:"checkbox",checked:de(),onChange:re},null,40,yM),r("span",null,[r("strong",null,"All "+C(B(o).areas),1),Ye(" (includes future "+C(B(o).areas)+")",1)])]),de()?M("",!0):(v(),m("div",kM,[r("div",_M,[(v(!0),m(Se,null,Ne(e.areas,Pe=>(v(),m("label",{key:Pe.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:De(Pe.id),onChange:q=>et(Pe.id)},null,40,bM),r("span",{class:"area-color-dot",style:Qe({backgroundColor:Pe.color||"#667eea"})},null,4),r("span",null,C(Pe.name),1)]))),128))])]))])):M("",!0),O(u.value)?(v(),m("div",wM,[r("label",CM,[r("input",{type:"checkbox",checked:Je(),onChange:Fe},null,40,LM),r("span",null,[r("strong",null,"All "+C(B(o).checkpoints),1),Ye(" (includes future "+C(B(o).checkpoints)+")",1)])]),Je()?M("",!0):(v(),m("div",SM,[He(r("input",{"onUpdate:modelValue":Le[2]||(Le[2]=Pe=>d.value=Pe),type:"text",placeholder:`Search ${B(o).checkpoints}...`,class:"search-input"},null,8,xM),[[st,d.value]]),r("div",IM,[A.value?(v(),m("label",$M,[r("input",{type:"checkbox",checked:Ke("THIS_CHECKPOINT"),onChange:Le[3]||(Le[3]=Pe=>_e("THIS_CHECKPOINT"))},null,40,TM),r("div",MM,[r("span",AM,[r("strong",null,"This "+C(B(o).checkpoint),1)])])])):M("",!0),(v(!0),m(Se,null,Ne(Ve.value,Pe=>(v(),m("label",{key:Pe.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:Ke(Pe.id),onChange:q=>_e(Pe.id)},null,40,EM),r("div",PM,[r("span",DM,C(Pe.name),1),Pe.description?(v(),m("span",RM," - "+C(Pe.description),1)):M("",!0)])]))),128))])]))])):M("",!0)]),r("div",{class:"modal-footer"},[r("button",{onClick:ue,class:"btn btn-secondary",type:"button"},"Deselect all"),r("button",{onClick:ne,class:"btn btn-primary",type:"button"},"Done")])])])):M("",!0)]))}},vc=je(OM,[["__scopeId","data-v-ad360dec"]]),BM={class:"tab-content"},NM={class:"form-group"},FM=["value"],UM={key:0,class:"form-error"},zM={class:"form-row"},HM={class:"form-group"},VM=["disabled"],GM={class:"form-group"},jM=["disabled"],ZM={class:"form-group"},qM={class:"accordion-item"},WM={class:"accordion-preview"},KM={class:"accordion-arrow"},JM={key:0,class:"accordion-content"},YM={class:"section-description"},XM={class:"dynamic-checkbox"},QM=["checked"],eA={key:0,class:"dynamic-settings"},tA={__name:"LocationCoordinatesTab",props:{form:{type:Object,required:!0},isMoving:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:"Checkpoint"},peopleTermPlural:{type:String,default:"Marshals"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:form","input","save","move-location"],setup(e,{emit:t}){const o=e,a=t,s=$(!1),i=$(""),l=$(""),u=k=>k==null||k===""||isNaN(k)?"":Number(k).toFixed(6);qe(()=>o.form.longitude,k=>{i.value=u(k)},{immediate:!0}),qe(()=>o.form.latitude,k=>{l.value=u(k)},{immediate:!0});const d=k=>{const _=k==="longitude"?i:l,w=parseFloat(_.value);isNaN(w)?_.value.trim()===""&&(a("update:form",{...o.form,[k]:0}),a("input"),_.value=u(0)):(a("update:form",{...o.form,[k]:w}),a("input"),_.value=u(w))},f=(k,_)=>{a("update:form",{...o.form,[k]:_}),a("input")},p=k=>{if(k){const _=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],w=o.form.locationUpdateScopeConfigurations||[],S=w.length>0?w:_;a("update:form",{...o.form,isDynamic:!0,latitude:0,longitude:0,locationUpdateScopeConfigurations:S})}else a("update:form",{...o.form,isDynamic:!1});a("input")},g=k=>{a("update:form",{...o.form,locationUpdateScopeConfigurations:k}),a("input")},y=k=>{if(!k)return!0;const _=k.includes(".")?k.split("."):k.split("/");if(_.length!==3)return!1;const w=/^[a-z]{1,20}$/;return _.every(S=>w.test(S))};return(k,_)=>(v(),m("div",BM,[r("form",{onSubmit:_[6]||(_[6]=rt(w=>k.$emit("save"),["prevent"]))},[r("div",NM,[_[10]||(_[10]=r("label",null,"What3Words (optional)",-1)),r("input",{value:e.form.what3Words,onInput:_[0]||(_[0]=w=>f("what3Words",w.target.value)),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap"},null,40,FM),e.form.what3Words&&!y(e.form.what3Words)?(v(),m("small",UM," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):M("",!0)]),e.form.isDynamic?M("",!0):(v(),m(Se,{key:0},[r("div",zM,[r("div",HM,[_[11]||(_[11]=r("label",null,"Longitude",-1)),He(r("input",{"onUpdate:modelValue":_[1]||(_[1]=w=>i.value=w),onBlur:_[2]||(_[2]=w=>d("longitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., -0.091234"},null,40,VM),[[st,i.value]])]),r("div",GM,[_[12]||(_[12]=r("label",null,"Latitude",-1)),He(r("input",{"onUpdate:modelValue":_[3]||(_[3]=w=>l.value=w),onBlur:_[4]||(_[4]=w=>d("latitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., 51.505123"},null,40,jM),[[st,l.value]])])]),r("div",ZM,[r("button",{type:"button",onClick:_[5]||(_[5]=w=>k.$emit("move-location")),class:ce(["btn btn-secondary btn-with-icon",{"btn-primary":e.isMoving}])},[_[13]||(_[13]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),Ye(" "+C(e.isMoving?"Click on map to set new location...":`Move ${e.checkpointTermSingular.toLowerCase()}...`),1)],2)])],64))],32),r("div",qM,[r("button",{type:"button",class:ce(["accordion-header",{expanded:s.value}]),onClick:_[7]||(_[7]=w=>s.value=!s.value)},[_[14]||(_[14]=Ar('<div class="accordion-icon" data-v-c3ce308d><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-c3ce308d><path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="#F59E0B" opacity="0.3" data-v-c3ce308d></path><path d="M12 6L13.5 9L17 9.5L14.5 12L15 15.5L12 14L9 15.5L9.5 12L7 9.5L10.5 9L12 6Z" fill="#F59E0B" data-v-c3ce308d></path><circle cx="12" cy="11" r="2" fill="white" data-v-c3ce308d></circle></svg></div><span class="accordion-title" data-v-c3ce308d>Dynamic location</span>',2)),r("span",WM,C(e.form.isDynamic?"Enabled":"Disabled"),1),r("span",KM,C(s.value?"":""),1)],2),s.value?(v(),m("div",JM,[r("p",YM," Enable this for lead cars, sweep vehicles, or other moving "+C(e.checkpointTermSingular.toLowerCase())+"s whose location can be updated by designated "+C(e.peopleTermPlural.toLowerCase())+" during the event. ",1),r("label",XM,[r("input",{type:"checkbox",checked:e.form.isDynamic,onChange:_[8]||(_[8]=w=>p(w.target.checked))},null,40,QM),r("span",null,"This "+C(e.checkpointTermSingular.toLowerCase())+" can move",1)]),e.form.isDynamic?(v(),m("div",eA,[Ae(vc,{"model-value":e.form.locationUpdateScopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":e.isEditing,"header-text":`Who can update this ${e.checkpointTermSingular.toLowerCase()}'s location?`,"exclude-scopes":["OnePerCheckpoint","OneLeadPerArea","OnePerArea"],intent:"location-update","current-checkpoint-id":e.form.id,"onUpdate:modelValue":g,onUserChanged:_[9]||(_[9]=w=>k.$emit("input"))},null,8,["model-value","areas","locations","marshals","is-editing","header-text","current-checkpoint-id"])])):M("",!0)])):M("",!0)])]))}},nA=je(tA,[["__scopeId","data-v-c3ce308d"]]);function Yv(e){const t=$(new Map),o=p=>t.value.has(p.id)?t.value.get(p.id):p.isCheckedIn;return{pendingCheckInChanges:t,getEffectiveCheckInStatus:o,handleToggleCheckIn:p=>{const y=!o(p);y===p.isCheckedIn?t.value.delete(p.id):t.value.set(p.id,y),e&&e()},getStatusIcon:p=>o(p)?"":"",getStatusColor:p=>o(p)?"#28a745":"#dc3545",getStatusText:p=>o(p)?"Checked in":"Not checked in",formatTime:p=>p?new Date(p).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",clearPendingChanges:()=>{t.value.clear()},getPendingChanges:()=>Array.from(t.value.entries()).map(([p,g])=>({assignmentId:p,shouldBeCheckedIn:g}))}}const oA={class:"card-main"},sA={class:"card-title"},aA={class:"marshal-name"},iA={key:0,class:"card-check-in"},lA={class:"toggle-icon"},rA={class:"toggle-label"},cA={key:0,class:"check-in-time"},uA={key:0,class:"check-in-method"},dA={key:1,class:"unsaved-indicator"},hA={key:1,class:"card-status-readonly"},fA={class:"status-icon"},pA={key:0,class:"check-in-time"},vA={key:0,class:"check-in-method"},mA={key:2,class:"card-badge"},gA={key:3,class:"card-badge"},yA={__name:"MarshalAssignmentCard",props:{assignment:{type:Object,required:!0},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},location:{type:Object,default:null}},emits:["click","toggle-check-in","remove","undo-remove"],setup(e,{emit:t}){const o=e,a=t,s=g=>g?new Date(g).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",i=G(()=>{const{checkedInBy:g,checkInMethod:y,marshalName:k}=o.assignment;return g&&g!==k?g:y||""}),l=G(()=>!o.assignment.isPending&&!o.isMarkedForRemoval&&!o.readOnly),u=G(()=>{const{checkInLatitude:g,checkInLongitude:y}=o.assignment,k=o.location;return!g||!y||!k?.latitude||!k?.longitude?null:Db(g,y,k.latitude,k.longitude)}),d=G(()=>u.value===null?null:Rb(u.value)),f=G(()=>u.value===null?"":u.value<=50?"distance-close":u.value<=100?"distance-medium":"distance-far"),p=()=>{l.value&&a("click",o.assignment)};return(g,y)=>(v(),m("div",{class:ce(["marshal-assignment-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-clickable":l.value}]),onClick:p},[r("div",oA,[r("div",sA,[r("span",aA,C(e.assignment.marshalName),1)]),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.readOnly?(v(),m("div",iA,[r("button",{class:ce(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:y[0]||(y[0]=rt(k=>g.$emit("toggle-check-in",e.assignment),["stop"]))},[r("span",lA,C(e.effectiveCheckInStatus?"":""),1),r("span",rA,C(e.effectiveCheckInStatus?"Checked in":"Check in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(v(),m("span",cA,[Ye(C(s(e.assignment.checkInTime))+" ",1),i.value?(v(),m("span",uA,"("+C(i.value)+")",1)):M("",!0),d.value?(v(),m("span",{key:1,class:ce(["check-in-distance",f.value])},C(d.value),3)):M("",!0)])):e.hasUnsavedChanges?(v(),m("span",dA," Unsaved ")):M("",!0)])):M("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&e.readOnly?(v(),m("div",hA,[r("span",{class:ce(["status-badge",e.effectiveCheckInStatus?"status-checked-in":"status-not-checked-in"])},[r("span",fA,C(e.effectiveCheckInStatus?"":""),1),Ye(" "+C(e.effectiveCheckInStatus?"Checked in":"Not checked in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime?(v(),m("span",pA,[Ye(C(s(e.assignment.checkInTime))+" ",1),i.value?(v(),m("span",vA,"("+C(i.value)+")",1)):M("",!0),d.value?(v(),m("span",{key:1,class:ce(["check-in-distance",f.value])},C(d.value),3)):M("",!0)])):M("",!0)])):M("",!0),e.assignment.isPending?(v(),m("div",mA,[...y[3]||(y[3]=[r("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):M("",!0),e.isMarkedForRemoval?(v(),m("div",gA,[...y[4]||(y[4]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):M("",!0)]),!e.readOnly&&!e.isMarkedForRemoval?(v(),m("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:y[1]||(y[1]=rt(k=>g.$emit("remove",e.assignment),["stop"]))},"  ")):M("",!0),e.isMarkedForRemoval?(v(),m("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:y[2]||(y[2]=rt(k=>g.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):M("",!0)],2))}},kA=je(yA,[["__scopeId","data-v-6e808532"]]),_A={class:"tab-content"},bA={key:0,class:"read-only-notice"},wA={key:1,class:"form-group"},CA=["value"],LA={class:"section-title"},SA={key:2,class:"assign-section"},xA={__name:"LocationAssignmentsTab",props:{form:{type:Object,required:!0},assignments:{type:Array,default:()=>[]},peopleTerm:{type:String,default:"Marshals"},personTerm:{type:String,default:"Marshal"},checkpointTerm:{type:String,default:"Checkpoint"},readOnly:{type:Boolean,default:!1}},emits:["update:form","input","remove-assignment","open-assign-modal","select-marshal"],setup(e,{expose:t,emit:o}){const a=e,s=G(()=>a.peopleTerm.toLowerCase()),i=G(()=>a.personTerm.toLowerCase()),l=G(()=>a.checkpointTerm.toLowerCase()),u=o,{pendingCheckInChanges:d,getEffectiveCheckInStatus:f,handleToggleCheckIn:p}=Yv(()=>u("input")),g=$(new Set),y=G(()=>a.assignments?.length||0),k=G(()=>a.assignments?[...a.assignments].sort((P,O)=>(P.marshalName||"").localeCompare(O.marshalName||"",void 0,{sensitivity:"base"})):[]),_=P=>g.value.has(P),w=P=>{P.isPending||u("select-marshal",P)},S=P=>{p(P)},A=P=>{P.isPending?u("remove-assignment",P):(g.value.add(P.id),u("input"))},T=P=>{g.value.delete(P.id),u("input")},x=(P,O)=>{u("update:form",{...a.form,[P]:Number(O)}),u("input")};return t({pendingCheckInChanges:d,clearPendingChanges:()=>{d.value.clear(),g.value.clear()},getPendingChanges:()=>Array.from(d.value.entries()).map(([P,O])=>({assignmentId:P,shouldBeCheckedIn:O})),getMarkedForRemoval:()=>Array.from(g.value)}),(P,O)=>(v(),m("div",_A,[e.readOnly?(v(),m("div",bA," Viewing from "+C(i.value)+" - "+C(s.value)+" cannot be modified here. ",1)):M("",!0),e.readOnly?M("",!0):(v(),m("div",wA,[r("label",null,"Required "+C(s.value),1),r("input",{value:e.form.requiredMarshals,onInput:O[0]||(O[0]=F=>x("requiredMarshals",F.target.value)),type:"number",min:"1",required:"",class:"form-input"},null,40,CA)])),r("h3",LA,"Assigned "+C(s.value)+" ("+C(y.value)+")",1),Ae(Zl,{"is-empty":e.assignments.length===0,"empty-message":`No ${s.value} assigned yet.`,"empty-hint":`Use the button below to assign ${s.value} to this ${l.value}.`},{default:ze(()=>[(v(!0),m(Se,null,Ne(k.value,F=>(v(),Ze(kA,{key:F.id,assignment:F,"effective-check-in-status":B(f)(F),"has-unsaved-changes":B(d).has(F.id),"is-marked-for-removal":_(F.id),"read-only":e.readOnly,location:e.form,onClick:w,onToggleCheckIn:S,onRemove:A,onUndoRemove:T},null,8,["assignment","effective-check-in-status","has-unsaved-changes","is-marked-for-removal","read-only","location"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),e.readOnly?M("",!0):(v(),m("div",SA,[r("button",{type:"button",class:"btn btn-primary assign-btn",onClick:O[1]||(O[1]=F=>P.$emit("open-assign-modal"))}," + Assign "+C(i.value)+"... ",1)]))]))}},IA=je(xA,[["__scopeId","data-v-a4e77b95"]]),$A={class:"grouped-tasks-list"},TA={key:0,class:"empty-state"},MA={key:1,class:"task-groups"},AA=["onClick"],EA={class:"task-header-content"},PA={class:"task-checkbox-area"},DA={class:"task-info"},RA={class:"task-name"},OA={class:"task-summary"},BA={key:0,class:"modified-badge"},NA={class:"task-scope"},FA=["title"],UA={class:"expand-arrow"},zA={key:0,class:"task-group-details"},HA={class:"detail-checkbox"},VA=["checked","disabled","onChange"],GA={class:"detail-content"},jA={class:"detail-context"},ZA={key:0,class:"detail-completion"},qA={key:0,class:"pending-text"},WA={class:"completion-text"},KA={class:"completion-time"},JA={key:1,class:"detail-uncomplete"},YA={key:2,class:"detail-disabled"},XA={__name:"GroupedTasksList",props:{items:{type:Array,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["toggle-complete"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ht(),s=e,i=$(new Set),l=G(()=>{const _=new Map;for(const w of s.items){_.has(w.itemId)||_.set(w.itemId,{itemId:w.itemId,text:w.text,items:[],totalCount:0,completedCount:0,allCompleted:!1,hasModified:!1});const S=_.get(w.itemId);S.items.push(w),S.totalCount++,w.localIsCompleted&&S.completedCount++,w.isModified&&(S.hasModified=!0)}for(const w of _.values())w.allCompleted=w.completedCount===w.totalCount,w.items.sort((S,A)=>{const T=y(S),x=y(A);return T.localeCompare(x,void 0,{numeric:!0,sensitivity:"base"})});return Array.from(_.values()).sort((w,S)=>w.text.localeCompare(S.text,void 0,{sensitivity:"base"}))}),u=_=>{i.value.has(_)?i.value.delete(_):i.value.add(_),i.value=new Set(i.value)},d=_=>_.hasModified?"status-modified":_.allCompleted?"status-completed":_.completedCount>0?"status-partial":"status-pending",f=_=>_.allCompleted?"":_.completedCount>0?"":"",p=_=>({Everyone:"Everyone",SpecificPeople:"Assigned individually",EveryoneInAreas:`Per ${a.value.area}`,EveryoneAtCheckpoints:`Per ${a.value.checkpoint}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,OnePerArea:`One per ${a.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${a.value.area}`})[_.matchedScope]||_.matchedScope,g=_=>({Everyone:"This task is for everyone at the event",SpecificPeople:"This task is specifically assigned to certain people",EveryoneInAreas:`This task is for everyone in certain ${a.value.areas}`,EveryoneAtCheckpoints:`This task is for everyone at certain ${a.value.checkpoints}`,OnePerCheckpoint:`One person at the ${a.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${a.value.area} needs to complete this`,EveryAreaLead:`This task is for ${a.value.area} leads only`,OneLeadPerArea:`One ${a.value.area} lead needs to complete this`})[_.matchedScope]||"",y=_=>{if(!_.completionContextType||!_.completionContextId)return"Everyone";if(_.completionContextType==="Checkpoint"){const w=s.locations.find(S=>S.id===_.completionContextId);return w?w.description?`${w.name} - ${w.description}`:w.name:`${o.value.checkpoint} (unknown)`}if(_.completionContextType==="Area"){const w=s.areas.find(S=>S.id===_.completionContextId);return w?w.name:`${o.value.area} (unknown)`}if(_.completionContextType==="Personal"){if(_.contextOwnerName)return _.contextOwnerName;if(_.completionContextId&&s.marshals.length>0){const w=s.marshals.find(S=>S.id===_.completionContextId||S.marshalId===_.completionContextId);if(w)return w.name||w.marshalName}return"Assigned individually"}return _.completionContextType},k=_=>_?new Date(_).toLocaleString():"";return(_,w)=>(v(),m("div",$A,[l.value.length===0?(v(),m("div",TA,[...w[0]||(w[0]=[r("p",null,"No tasks available.",-1)])])):(v(),m("div",MA,[(v(!0),m(Se,null,Ne(l.value,S=>(v(),m("div",{key:S.itemId,class:ce(["task-group",{"all-completed":S.allCompleted,"has-modified":S.hasModified}])},[r("button",{type:"button",class:"task-group-header",onClick:A=>u(S.itemId)},[r("div",EA,[r("div",PA,[r("span",{class:ce(["task-status-icon",d(S)])},C(f(S)),3)]),r("div",DA,[r("div",RA,C(S.text),1),r("div",OA,[r("span",{class:ce(["completion-count",{"all-done":S.allCompleted}])},C(S.completedCount)+"/"+C(S.totalCount)+" completed ",3),S.hasModified?(v(),m("span",BA," Modified ")):M("",!0)])]),r("div",NA,[r("span",{class:"scope-pill",title:g(S.items[0])},C(p(S.items[0])),9,FA)])]),r("span",UA,C(i.value.has(S.itemId)?"":""),1)],8,AA),i.value.has(S.itemId)?(v(),m("div",zA,[(v(!0),m(Se,null,Ne(S.items,A=>(v(),m("div",{key:`${A.itemId}-${A.completionContextId}`,class:ce(["task-detail-item",{"item-completed":A.localIsCompleted,"item-modified":A.isModified}])},[r("div",HA,[r("input",{type:"checkbox",checked:A.localIsCompleted,disabled:!A.canBeCompletedByMe&&!A.localIsCompleted,onChange:T=>_.$emit("toggle-complete",A)},null,40,VA)]),r("div",GA,[r("div",jA,C(y(A)),1),A.localIsCompleted?(v(),m("div",ZA,[A.isModified&&!A.isCompleted?(v(),m("span",qA," Will be marked as completed ")):(v(),m(Se,{key:1},[r("span",WA,C(A.completedByActorName||"Unknown"),1),r("span",KA,C(k(A.completedAt)),1)],64))])):A.isModified&&A.isCompleted?(v(),m("div",JA,[...w[1]||(w[1]=[r("span",{class:"pending-text"},"Will be marked as incomplete",-1)])])):A.canBeCompletedByMe?M("",!0):(v(),m("div",YA," Already completed by someone else "))])],2))),128))])):M("",!0)],2))),128))]))]))}},id=je(XA,[["__scopeId","data-v-409a65e7"]]),QA={class:"checkpoint-checklist-view"},eE={key:0,class:"loading-state"},tE={key:1,class:"error-state"},nE={key:2,class:"empty-state"},oE={key:3,class:"empty-state"},sE={__name:"CheckpointChecklistView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{termsLower:a}=ht(),s=e,i=o,l=$([]),u=$(!1),d=$(null),f=$(new Map),p=G(()=>s.assignments.length===0),g=G(()=>l.value.map(S=>{const A=f.value.get(`${S.itemId}|||${S.completionContextId}`),T=A!==void 0?A.complete:S.isCompleted,x=A!==void 0&&A.complete!==S.isCompleted;return{...S,localIsCompleted:T,isModified:x}})),y=async()=>{if(!(!s.eventId||!s.locationId&&!s.areaId)){u.value=!0,d.value=null;try{const S=s.locationId?await Dt.getCheckpointChecklist(s.eventId,s.locationId):await Dt.getAreaChecklist(s.eventId,s.areaId);if(l.value=S.data||[],s.modelValue&&s.modelValue.length>0){const A=new Map;s.modelValue.forEach(T=>{A.set(`${T.itemId}|||${T.contextId}`,{complete:T.complete,contextType:T.contextType,contextId:T.contextId})}),f.value=A}}catch(S){console.error("Failed to load checklist:",S),d.value=S.response?.data?.message||"Failed to load checklist"}finally{u.value=!1}}},k=S=>{const A=S.contextOwnerMarshalId||(s.assignments.length>0?s.assignments[0].marshalId:null);if(!A)return;const T=`${S.itemId}|||${S.completionContextId}`,x=f.value.get(T),P=x!==void 0?x.complete:S.isCompleted;f.value.set(T,{complete:!P,contextType:S.completionContextType,contextId:S.completionContextId,marshalId:A}),_()},_=()=>{const S=[];for(const[A,T]of f.value.entries()){const[x,P]=A.split("|||"),O=l.value.find(F=>F.itemId===x&&F.completionContextId===P);O&&T.complete!==O.isCompleted&&S.push({itemId:x,complete:T.complete,contextType:T.contextType,contextId:T.contextId,marshalId:T.marshalId})}i("update:modelValue",S),i("change",S)};return t({resetLocalState:()=>{if(f.value=new Map,s.modelValue&&s.modelValue.length>0){const S=new Map;s.modelValue.forEach(A=>{S.set(`${A.itemId}|||${A.contextId}`,{complete:A.complete,contextType:A.contextType,contextId:A.contextId,marshalId:A.marshalId})}),f.value=S}},loadChecklist:y}),qe(()=>[s.eventId,s.locationId,s.areaId],()=>{y()},{immediate:!0}),(S,A)=>(v(),m("div",QA,[u.value?(v(),m("div",eE," Loading checklist... ")):d.value?(v(),m("div",tE,[r("p",null,C(d.value),1),r("button",{onClick:y,class:"btn btn-secondary btn-small"}," Retry ")])):p.value?(v(),m("div",nE,[...A[0]||(A[0]=[r("p",null,"No marshals assigned to this checkpoint yet.",-1),r("p",{class:"help-text"},"Assign marshals to enable checklist completion.",-1)])])):l.value.length===0?(v(),m("div",oE,[r("p",null,"No checklist items for this "+C(B(a).checkpoint)+".",1)])):(v(),Ze(id,{key:4,items:g.value,locations:e.locations,areas:e.areas,onToggleComplete:k},null,8,["items","locations","areas"]))]))}},Xv=je(sE,[["__scopeId","data-v-9206ecb2"]]),aE={class:"notes-view"},iE={key:0,class:"loading-state"},lE={key:1,class:"error-state"},rE={key:2,class:"empty-state"},cE={key:3,class:"notes-list"},uE={class:"note-header"},dE={class:"note-title-row"},hE={key:0,class:"pin-icon",title:"Pinned"},fE={class:"note-title"},pE={class:"note-meta"},vE={key:0,class:"category-badge"},mE={key:0,class:"note-content"},gE={class:"note-footer"},yE={class:"created-info"},kE={key:0,class:"scope-info"},_E={__name:"NotesView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},marshalId:{type:String,default:null},allNotes:{type:Array,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},showScope:{type:Boolean,default:!0}},setup(e,{expose:t}){const o=e,a=$([]),s=$(!1),i=$(null),l=G(()=>o.marshalId?"No notes for this marshal.":o.areaId?"No notes for this area.":o.locationId?"No notes for this checkpoint.":"No notes available."),u=G(()=>o.areaId?o.locations.filter(A=>A.areaIds&&A.areaIds.includes(o.areaId)):[]),d=G(()=>u.value.map(A=>A.id)),f=G(()=>{if(!o.areaId)return[];const A=new Set;return o.assignments.filter(T=>d.value.includes(T.locationId)).forEach(T=>A.add(T.marshalId)),Array.from(A)}),p=A=>o.assignments.filter(T=>T.marshalId===A).map(T=>T.locationId),g=A=>{const T=p(A),x=new Set;for(const P of T){const O=o.locations.find(F=>F.id===P);O?.areaIds&&O.areaIds.forEach(F=>x.add(F))}return Array.from(x)},y=(A,T)=>{if(!A.scopeConfigurations)return null;for(const x of A.scopeConfigurations){if(x.itemType==="Area"){if(T.type==="area"&&(x.ids.includes(T.areaId)||x.ids.includes("ALL_AREAS")))return{matched:!0,scope:x.scope==="EveryAreaLead"?"Area leads":"Area"};if(T.type==="checkpoint"){const O=o.locations.find(F=>F.id===T.locationId)?.areaIds||[];if(x.ids.includes("ALL_AREAS")||O.some(F=>x.ids.includes(F)))return{matched:!0,scope:x.scope==="EveryAreaLead"?"Area leads":"Area"}}}if(x.itemType==="Checkpoint"){if(T.type==="checkpoint"&&(x.ids.includes(T.locationId)||x.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint"};if(T.type==="area"&&T.checkpointIds.some(O=>x.ids.includes(O)||x.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint in area"}}if(x.itemType==="Marshal"){if(T.type==="marshal"&&(x.ids.includes(T.marshalId)||x.ids.includes("ALL_MARSHALS")))return{matched:!0,scope:"Marshal"};if(T.type==="checkpoint"){const P=o.assignments.filter(F=>F.locationId===T.locationId).map(F=>F.marshalId);if(x.ids.includes("ALL_MARSHALS")||P.some(F=>x.ids.includes(F)))return{matched:!0,scope:"Marshal at checkpoint"}}if(T.type==="area"&&(x.ids.includes("ALL_MARSHALS")||T.marshalIds.some(O=>x.ids.includes(O))))return{matched:!0,scope:"Marshal in area"}}if(T.type==="marshal"&&T.checkpointIds&&T.areaIds){if(x.itemType==="Checkpoint"&&(x.ids.includes("ALL_CHECKPOINTS")||T.checkpointIds.some(O=>x.ids.includes(O))))return{matched:!0,scope:"Assigned checkpoint"};if(x.itemType==="Area"&&(x.ids.includes("ALL_AREAS")||T.areaIds.some(O=>x.ids.includes(O))))return{matched:!0,scope:x.scope==="EveryAreaLead"?"Area lead":"Area"}}}return null},k=G(()=>{const A=o.allNotes||a.value;if(!A||A.length===0)return[];if(o.areaId&&o.allNotes){const T={type:"area",areaId:o.areaId,checkpointIds:d.value,marshalIds:f.value},x=[],P=new Set;for(const O of A){if(P.has(O.noteId))continue;const F=y(O,T);F&&(P.add(O.noteId),x.push({...O,matchedScope:F.scope}))}return x}if(o.locationId&&o.allNotes){const T={type:"checkpoint",locationId:o.locationId},x=[],P=new Set;for(const O of A){if(P.has(O.noteId))continue;const F=y(O,T);F&&(P.add(O.noteId),x.push({...O,matchedScope:F.scope}))}return x}if(o.marshalId&&o.allNotes){const T=p(o.marshalId),x=g(o.marshalId),P={type:"marshal",marshalId:o.marshalId,checkpointIds:T,areaIds:x},O=[],F=new Set;for(const E of A){if(F.has(E.noteId))continue;const N=y(E,P);N&&(F.add(E.noteId),O.push({...E,matchedScope:N.scope}))}return O}return A}),_=G(()=>{const A={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return[...k.value].sort((T,x)=>{if(T.isPinned!==x.isPinned)return T.isPinned?-1:1;const P=A[T.priority]??2,O=A[x.priority]??2;return P!==O?P-O:T.displayOrder!==x.displayOrder?T.displayOrder-x.displayOrder:new Date(x.createdAt)-new Date(T.createdAt)})}),w=async()=>{if(o.allNotes===null&&o.eventId){s.value=!0,i.value=null;try{let A;o.marshalId?A=await Es.getMarshalNotes(o.eventId,o.marshalId):A=await Es.getByEvent(o.eventId),a.value=A.data||[]}catch(A){console.error("Failed to load notes:",A),i.value=A.response?.data?.message||"Failed to load notes"}finally{s.value=!1}}};qe(()=>[o.eventId,o.locationId,o.areaId,o.marshalId],()=>{o.allNotes===null&&w()},{immediate:!0});const S=A=>{if(!A)return"";const T=new Date(A),P=new Date-T,O=Math.floor(P/6e4),F=Math.floor(P/36e5),E=Math.floor(P/864e5);return O<1?"just now":O<60?`${O}m ago`:F<24?`${F}h ago`:E<7?`${E}d ago`:T.toLocaleDateString()};return t({loadNotes:w}),(A,T)=>(v(),m("div",aE,[s.value?(v(),m("div",iE," Loading notes... ")):i.value?(v(),m("div",lE,[r("p",null,C(i.value),1),r("button",{onClick:w,class:"btn btn-secondary btn-small"}," Retry ")])):k.value.length===0?(v(),m("div",rE,[r("p",null,C(l.value),1)])):(v(),m("div",cE,[(v(!0),m(Se,null,Ne(_.value,x=>(v(),m("div",{key:x.noteId,class:ce(["note-item",{pinned:x.isPinned}])},[r("div",uE,[r("div",dE,[x.isPinned?(v(),m("span",hE,"")):M("",!0),r("span",{class:ce(["priority-indicator",(x.priority||"Normal").toLowerCase()])},null,2),r("strong",fE,C(x.title),1)]),r("div",pE,[x.category?(v(),m("span",vE,C(x.category),1)):M("",!0),r("span",{class:ce(["priority-badge",(x.priority||"Normal").toLowerCase()])},C(x.priority||"Normal"),3)])]),x.content?(v(),m("div",mE,C(x.content),1)):M("",!0),r("div",gE,[r("span",yE," Created by "+C(x.createdByName||"Unknown")+"  "+C(S(x.createdAt)),1),x.matchedScope&&e.showScope?(v(),m("span",kE,C(x.matchedScope),1)):M("",!0)])],2))),128))]))]))}},mc=je(_E,[["__scopeId","data-v-9fdf0b0b"]]),bE={class:"checklist-preview"},wE={class:"preview-actions"},CE={class:"preview-header"},LE={key:0,class:"add-item-form"},SE=["placeholder"],xE=["disabled"],IE={key:1,class:"pending-items"},$E={class:"item-content"},TE={class:"item-header"},ME={class:"item-text"},AE={class:"item-scope"},EE=["onClick"],PE={key:2,class:"empty-state"},DE={key:0,class:"help-text"},RE={key:3,class:"checklist-items"},OE={class:"item-content"},BE={class:"item-header"},NE={class:"item-text"},FE={class:"item-scope"},UE=["title"],zE={key:0,class:"item-context"},HE={__name:"ChecklistPreviewForLocation",props:{allChecklistItems:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ht(),s=e,i=G(()=>s.checkpointTermSingular?s.checkpointTermSingular.toLowerCase():a.value.checkpoint),l=t,u=$(!1),d=$(""),f=$([...s.modelValue]);qe(()=>s.modelValue,x=>{f.value=[...x]},{deep:!0});const p=()=>{d.value.trim()&&(f.value.push({text:d.value.trim(),isNew:!0}),d.value="",u.value=!1,y())},g=x=>{f.value.splice(x,1),y()},y=()=>{l("update:modelValue",[...f.value]),l("change")},k=x=>{const P=x.scope,O=x.itemType,F=x.ids||[];return(P==="EveryoneAtCheckpoints"||P==="OnePerCheckpoint")&&O==="Checkpoint"?F.includes("ALL_CHECKPOINTS"):P==="OnePerCheckpoint"&&O==="Area"?F.includes("ALL_AREAS")?!0:F.some(E=>s.pendingAreaIds.includes(E)):(P==="EveryoneInAreas"||P==="OnePerArea"||P==="EveryAreaLead"||P==="OneLeadPerArea")&&O==="Area"?F.includes("ALL_AREAS")?!0:F.some(E=>s.pendingAreaIds.includes(E)):!1},_=G(()=>s.allChecklistItems.filter(x=>x.scopeConfigurations&&x.scopeConfigurations.length>0?x.scopeConfigurations.some(P=>k(P)):!1)),w=x=>({EveryoneAtCheckpoints:`All at ${a.value.checkpoints}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,EveryoneInAreas:`All in ${a.value.areas}`,OnePerArea:`One per ${a.value.area}`,EveryAreaLead:`${a.value.area} leads`,OneLeadPerArea:`One lead per ${a.value.area}`})[x]||x,S=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"Unknown";const P=x.scopeConfigurations.find(F=>k(F));if(!P)return w(x.scopeConfigurations[0].scope);const O=P.ids||[];return O.includes("ALL_CHECKPOINTS")?`All ${a.value.checkpoints}`:O.includes("ALL_AREAS")?`All ${a.value.areas}`:w(P.scope)},A=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"";const P=x.scopeConfigurations.find(F=>k(F));return P&&{EveryoneAtCheckpoints:`This item is for everyone at specified ${a.value.checkpoints}`,OnePerCheckpoint:`One person at each ${a.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${a.value.areas}`,OnePerArea:`One person in each ${a.value.area} needs to complete this`,EveryAreaLead:`This item is for ${a.value.area} leads only`,OneLeadPerArea:`One ${a.value.area} lead needs to complete this`}[P.scope]||""},T=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return null;const P=x.scopeConfigurations.find(E=>k(E));if(!P)return null;const O=P.itemType,F=P.ids||[];if(F.includes("ALL_CHECKPOINTS")||F.includes("ALL_AREAS"))return null;if(O==="Area"){const E=s.areas.filter(N=>F.includes(N.id)&&s.pendingAreaIds.includes(N.id)).map(N=>N.name);if(E.length>0)return`In: ${E.join(", ")}`}return null};return(x,P)=>(v(),m("div",bE,[r("div",wE,[r("p",CE,C(e.isEditing?`Add new ${B(a).checklist} for this ${i.value}:`:`${B(o).checklists} that will apply at this ${i.value}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:P[0]||(P[0]=O=>u.value=!u.value)},C(u.value?"Cancel":`Add ${B(a).checklist}`),1)]),u.value?(v(),m("div",LE,[He(r("input",{"onUpdate:modelValue":P[1]||(P[1]=O=>d.value=O),type:"text",placeholder:`Enter ${B(a).checklist} text...`,class:"add-item-input",onKeyup:vs(p,["enter"])},null,40,SE),[[st,d.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!d.value.trim(),onClick:p}," Add ",8,xE)])):M("",!0),f.value.length>0?(v(),m("div",IE,[(v(!0),m(Se,null,Ne(f.value,(O,F)=>(v(),m("div",{key:`pending-${F}`,class:"checklist-item pending"},[P[3]||(P[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",$E,[r("div",TE,[r("div",ME,C(O.text),1),r("div",AE,[P[2]||(P[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:E=>g(F),title:"Remove"},"  ",8,EE)])])])]))),128))])):M("",!0),!e.isEditing&&_.value.length===0&&f.value.length===0?(v(),m("div",PE,[r("p",null,"No "+C(B(a).checklists)+" will apply based on the current "+C(B(a).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),m("p",DE," Assign "+C(B(a).areas)+" to see relevant "+C(B(a).checklists)+". ",1)):M("",!0)])):M("",!0),!e.isEditing&&_.value.length>0?(v(),m("div",RE,[(v(!0),m(Se,null,Ne(_.value,O=>(v(),m("div",{key:O.id,class:"checklist-item"},[P[4]||(P[4]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",OE,[r("div",BE,[r("div",NE,C(O.text),1),r("div",FE,[r("span",{class:"scope-pill",title:A(O)},C(S(O)),9,UE)])]),T(O)?(v(),m("div",zE,C(T(O)),1)):M("",!0)])]))),128))])):M("",!0)]))}},VE=je(HE,[["__scopeId","data-v-7d943b21"]]),GE={class:"notes-preview"},jE={class:"preview-actions"},ZE={class:"preview-header"},qE={key:0,class:"add-item-form"},WE={class:"add-form-fields"},KE=["disabled"],JE={key:1,class:"pending-items"},YE={class:"note-header"},XE={class:"note-title"},QE={class:"note-actions"},e4=["onClick"],t4={key:0,class:"note-content"},n4={key:2,class:"empty-state"},o4={key:0,class:"help-text"},s4={key:3,class:"notes-list"},a4={class:"note-header"},i4={class:"note-title"},l4=["title"],r4={key:0,class:"note-content"},c4={key:1,class:"note-context"},u4={__name:"NotesPreviewForLocation",props:{allNotes:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ht(),a=e,s=t,i=G(()=>a.checkpointTermSingular?a.checkpointTermSingular.toLowerCase():o.value.checkpoint),l=$(!1),u=$(""),d=$(""),f=$([...a.modelValue]);qe(()=>a.modelValue,x=>{f.value=[...x]},{deep:!0});const p=()=>{!u.value.trim()&&!d.value.trim()||(f.value.push({title:u.value.trim(),content:d.value.trim(),isNew:!0}),u.value="",d.value="",l.value=!1,y())},g=x=>{f.value.splice(x,1),y()},y=()=>{s("update:modelValue",[...f.value]),s("change")},k=x=>{const P=x.scope,O=x.itemType,F=x.ids||[];return P==="EveryoneAtCheckpoints"&&O==="Checkpoint"?F.includes("ALL_CHECKPOINTS"):P==="EveryoneInAreas"&&O==="Area"?F.includes("ALL_AREAS")?!0:F.some(E=>a.pendingAreaIds.includes(E)):!1},_=G(()=>a.allNotes.filter(x=>x.scopeConfigurations&&x.scopeConfigurations.length>0?x.scopeConfigurations.some(P=>k(P)):!1)),w=x=>({EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[x]||x,S=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"Unknown";const P=x.scopeConfigurations.find(F=>k(F));if(!P)return w(x.scopeConfigurations[0].scope);const O=P.ids||[];return O.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:O.includes("ALL_AREAS")?`All ${o.value.areas}`:w(P.scope)},A=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"";const P=x.scopeConfigurations.find(F=>k(F));return P&&{EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[P.scope]||""},T=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return null;const P=x.scopeConfigurations.find(E=>k(E));if(!P)return null;const O=P.itemType,F=P.ids||[];if(F.includes("ALL_CHECKPOINTS")||F.includes("ALL_AREAS"))return null;if(O==="Area"){const E=a.areas.filter(N=>F.includes(N.id)&&a.pendingAreaIds.includes(N.id)).map(N=>N.name);if(E.length>0)return`In: ${E.join(", ")}`}return null};return(x,P)=>(v(),m("div",GE,[r("div",jE,[r("p",ZE,C(e.isEditing?`Add new note for this ${i.value}:`:`Notes that will be visible at this ${i.value}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:P[0]||(P[0]=O=>l.value=!l.value)},C(l.value?"Cancel":"Add note"),1)]),l.value?(v(),m("div",qE,[r("div",WE,[He(r("input",{"onUpdate:modelValue":P[1]||(P[1]=O=>u.value=O),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[st,u.value]]),He(r("textarea",{"onUpdate:modelValue":P[2]||(P[2]=O=>d.value=O),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[st,d.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!u.value.trim()&&!d.value.trim(),onClick:p}," Add ",8,KE)])):M("",!0),f.value.length>0?(v(),m("div",JE,[(v(!0),m(Se,null,Ne(f.value,(O,F)=>(v(),m("div",{key:`pending-${F}`,class:"note-item pending"},[r("div",YE,[r("span",XE,C(O.title||"Untitled"),1),r("div",QE,[P[3]||(P[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:E=>g(F),title:"Remove"},"  ",8,e4)])]),O.content?(v(),m("div",t4,C(O.content),1)):M("",!0)]))),128))])):M("",!0),!e.isEditing&&_.value.length===0&&f.value.length===0?(v(),m("div",n4,[r("p",null,"No notes will apply based on the current "+C(B(o).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),m("p",o4," Assign "+C(B(o).areas)+" to see relevant notes. ",1)):M("",!0)])):M("",!0),!e.isEditing&&_.value.length>0?(v(),m("div",s4,[(v(!0),m(Se,null,Ne(_.value,O=>(v(),m("div",{key:O.id,class:"note-item"},[r("div",a4,[r("span",i4,C(O.title||"Untitled"),1),r("span",{class:"scope-pill",title:A(O)},C(S(O)),9,l4)]),O.content?(v(),m("div",r4,C(O.content),1)):M("",!0),T(O)?(v(),m("div",c4,C(T(O)),1)):M("",!0)]))),128))])):M("",!0)]))}},d4=je(u4,[["__scopeId","data-v-71646c3f"]]),h4={class:"base-modal-title modal-title-with-icon"},f4=["innerHTML"],p4={key:7,class:"tab-content appearance-tab"},v4={class:"accordion-item"},m4=["innerHTML"],g4={class:"accordion-title"},y4={class:"accordion-arrow"},k4={key:0,class:"accordion-content"},_4={class:"section-description"},b4={class:"accordion-item"},w4={class:"accordion-preview"},C4={class:"accordion-arrow"},L4={key:0,class:"accordion-content"},S4={class:"section-description"},x4={class:"terminology-row"},I4={class:"terminology-field"},$4=["value"],T4={value:""},M4=["value"],A4={class:"terminology-field"},E4=["value"],P4={value:""},D4=["value"],R4={key:8,class:"tab-content incidents-tab"},O4={class:"incidents-list"},B4={class:"custom-footer"},N4={class:"footer-left"},lf="edit_location_accordion",F4={__name:"EditLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:null},assignments:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventDate:{type:String,default:""},areas:{type:Array,default:()=>[]},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},availableMarshals:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},zIndex:{type:Number,default:1e3},incidents:{type:Array,default:()=>[]},lockedFromMarshal:{type:Boolean,default:!1}},emits:["close","save","delete","move-location","toggle-check-in","remove-assignment","open-assign-modal","update:isDirty","select-incident","select-marshal"],setup(e,{emit:t}){const{terms:o}=ht(),a=e,s=t,i=$("details"),l=$(!1),u=$(null),d=$(null),f=$([]),p=$([]),g=$([]),y=$({id:null,name:"",description:"",what3Words:"",latitude:0,longitude:0,requiredMarshals:1,useCustomTimes:!1,startTime:"",endTime:"",areaIds:[],styleType:"default",styleColor:"",styleBackgroundShape:"",styleBackgroundColor:"",styleBorderColor:"",styleIconColor:"",styleSize:"",styleMapRotation:"",peopleTerm:"",checkpointTerm:"",isDynamic:!1,locationUpdateScopeConfigurations:[]}),k=()=>a.eventId?`${lf}_${a.eventId}`:lf,_=$({iconStyle:!1,terminology:!1});on(()=>{const Y=localStorage.getItem(k());if(Y)try{const V=JSON.parse(Y);_.value={..._.value,...V}}catch{}});const w=Y=>{_.value[Y]=!_.value[Y],localStorage.setItem(k(),JSON.stringify(_.value))},S=G(()=>{const Y=y.value.areaIds||[];if(Y.length>0){const V=a.areas.filter(J=>Y.includes(J.id)&&J.peopleTerm).sort((J,Me)=>(J.checkpointCount||0)-(Me.checkpointCount||0));if(V.length>0)return V[0].peopleTerm}return a.eventPeopleTerm||"Marshals"}),A=G(()=>y.value.peopleTerm?y.value.peopleTerm:S.value),T=G(()=>{const Y=y.value.areaIds||[];if(Y.length>0){const V=a.areas.filter(J=>Y.includes(J.id)&&J.checkpointTerm).sort((J,Me)=>(J.checkpointCount||0)-(Me.checkpointCount||0));if(V.length>0)return V[0].checkpointTerm}return o.value.checkpoint});G(()=>T.value.toLowerCase());const x=G(()=>{const Y=y.value.checkpointTerm||a.location?.checkpointTerm||a.location?.CheckpointTerm;if(Y)return Ja("checkpoint",Y,A.value);const V=y.value.areaIds||[];let J=null;if(V.length>0){const Me=a.areas.filter(Re=>V.includes(Re.id)&&Re.checkpointTerm).sort((Re,Ce)=>(Re.checkpointCount||0)-(Ce.checkpointCount||0));Me.length>0&&(J=Me[0].checkpointTerm)}return J?Ja("checkpoint",J,A.value):o.value.checkpoint}),P=G(()=>x.value.toLowerCase()),O=G(()=>{const Y=A.value;return Ja("people",Y)});G(()=>O.value.toLowerCase());const F=G(()=>o.value.area);G(()=>F.value.toLowerCase());const E=G(()=>o.value.area),N=G(()=>E.value.toLowerCase()),D=G(()=>o.value.areas),j=G(()=>!!(a.location&&a.location.id)),R=G(()=>j.value?`Edit ${P.value}: ${a.location?.name||""}`:`Add ${P.value}`),W=G(()=>{const Y=[{value:"details",label:"Details",icon:"details"},{value:"location",label:"Location",icon:"location"},{value:"marshals",label:A.value,icon:"marshal"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return a.incidents&&a.incidents.length>0&&Y.push({value:"incidents",label:"Incidents",icon:"incidents"}),Y}),ne=G(()=>W.value.findIndex(Y=>Y.value===i.value)),ue=G(()=>ne.value===W.value.length-1),K=G(()=>{const Y=y.value.areaIds||[],V=a.areas.filter(Be=>Y.includes(Be.id)).sort((Be,Xe)=>(Be.checkpointCount||0)-(Xe.checkpointCount||0)),J=(Be,Xe)=>{for(const mt of V){const _t=Be(mt);if(_t&&_t!=="default")return{value:_t,source:"area"}}return Xe&&Xe!=="default"?{value:Xe,source:"event"}:{value:"",source:"none"}},Me=J(Be=>Be.checkpointStyleType||Be.CheckpointStyleType,a.eventDefaultStyleType),Re=J(Be=>Be.checkpointStyleColor||Be.CheckpointStyleColor,a.eventDefaultStyleColor),Ce=J(Be=>Be.checkpointStyleBackgroundShape||Be.CheckpointStyleBackgroundShape,a.eventDefaultStyleBackgroundShape),be=J(Be=>Be.checkpointStyleBackgroundColor||Be.CheckpointStyleBackgroundColor||Be.checkpointStyleColor||Be.CheckpointStyleColor,a.eventDefaultStyleBackgroundColor||a.eventDefaultStyleColor),me=J(Be=>Be.checkpointStyleBorderColor||Be.CheckpointStyleBorderColor,a.eventDefaultStyleBorderColor),Z=J(Be=>Be.checkpointStyleIconColor||Be.CheckpointStyleIconColor,a.eventDefaultStyleIconColor),oe=J(Be=>Be.checkpointStyleSize||Be.CheckpointStyleSize,a.eventDefaultStyleSize),le=J(Be=>Be.checkpointStyleMapRotation??Be.CheckpointStyleMapRotation,a.eventDefaultStyleMapRotation),Oe=[Me,Ce,be,me,Z,oe,le].some(Be=>Be.source==="area");return{type:Me.value||"default",color:Re.value,backgroundShape:Ce.value,backgroundColor:be.value,borderColor:me.value,iconColor:Z.value,size:oe.value,mapRotation:le.value,source:Oe?"area":Me.value?"event":"none"}}),Q=G(()=>K.value.source==="area"?`${E.value} default`:"Event default"),he=G(()=>{const Y=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:K.value.type,V=y.value.styleBackgroundShape||K.value.backgroundShape||"circle",J=y.value.styleBackgroundColor||K.value.backgroundColor||"#667eea",Me=y.value.styleBorderColor||K.value.borderColor||"#ffffff",Re=y.value.styleIconColor||K.value.iconColor||"#ffffff";return Sn({type:Y||"circle",backgroundShape:V,backgroundColor:J,borderColor:Me,iconColor:Re,size:"100"})}),U=G(()=>{let Y,V,J,Me,Re;return j.value&&a.location?(Y=a.location.resolvedStyleType||a.location.ResolvedStyleType,V=a.location.resolvedStyleBackgroundShape||a.location.ResolvedStyleBackgroundShape||"circle",J=a.location.resolvedStyleBackgroundColor||a.location.ResolvedStyleBackgroundColor||a.location.resolvedStyleColor||a.location.ResolvedStyleColor||"#667eea",Me=a.location.resolvedStyleBorderColor||a.location.ResolvedStyleBorderColor||"#ffffff",Re=a.location.resolvedStyleIconColor||a.location.ResolvedStyleIconColor||"#ffffff"):(Y=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:K.value.type,V=y.value.styleBackgroundShape||K.value.backgroundShape||"circle",J=y.value.styleBackgroundColor||K.value.backgroundColor||"#667eea",Me=y.value.styleBorderColor||K.value.borderColor||"#ffffff",Re=y.value.styleIconColor||K.value.iconColor||"#ffffff"),Sn({type:Y||"circle",backgroundShape:V,backgroundColor:J,borderColor:Me,iconColor:Re,size:"100",outputSize:28})}),ee=G(()=>{const Y=!!y.value.checkpointTerm,V=!!y.value.peopleTerm;return Y&&V?`${Ja("checkpoint",y.value.checkpointTerm,y.value.peopleTerm)}, ${y.value.peopleTerm}`:Y?Ja("checkpoint",y.value.checkpointTerm,A.value):V?y.value.peopleTerm:"Using defaults"}),de=G(()=>ue.value?null:W.value[ne.value+1]),re=G(()=>de.value?`${de.value.label}...`:""),De=$(!1),et=$(null);qe(()=>a.location,Y=>{if(Y){const V=Y.id||"new";if(et.value!==V){et.value=V,De.value=!0;let J="",Me="";Y.startTime&&(J=Ol(Y.startTime)),Y.endTime&&(Me=Ol(Y.endTime)),y.value={id:Y.id||null,name:Y.name||"",description:Y.description||"",what3Words:Y.what3Words||"",latitude:Y.latitude||0,longitude:Y.longitude||0,requiredMarshals:Y.requiredMarshals||1,useCustomTimes:!!(Y.startTime||Y.endTime),startTime:J,endTime:Me,areaIds:Y.areaIds||Y.AreaIds||[],styleType:Y.styleType||Y.StyleType||"default",styleColor:Y.styleColor||Y.StyleColor||"",styleBackgroundShape:Y.styleBackgroundShape||Y.StyleBackgroundShape||"",styleBackgroundColor:Y.styleBackgroundColor||Y.StyleBackgroundColor||"",styleBorderColor:Y.styleBorderColor||Y.StyleBorderColor||"",styleIconColor:Y.styleIconColor||Y.StyleIconColor||"",styleSize:Y.styleSize||Y.StyleSize||"",styleMapRotation:Y.styleMapRotation??Y.StyleMapRotation??"",peopleTerm:Y.peopleTerm||"",checkpointTerm:Y.checkpointTerm||"",isDynamic:Y.isDynamic||!1,locationUpdateScopeConfigurations:Y.locationUpdateScopeConfigurations||[]}}}},{immediate:!0,deep:!0}),qe(()=>a.show,Y=>{Y?(i.value="details",l.value=!1,f.value=[],p.value=[],g.value=[],u.value?.clearPendingChanges&&u.value.clearPendingChanges(),d.value?.resetLocalState&&d.value.resetLocalState()):(et.value=null,De.value=!1)});const Je=Y=>{y.value=Y},Fe=()=>{s("update:isDirty",!0)},Ke=()=>{l.value=!l.value,s("move-location",{isMoving:l.value,formData:{...y.value}})},_e=Y=>{f.value=Y,Fe()},Ve=()=>{de.value&&(i.value=de.value.value)},pe=()=>{const Y={...y.value,startTime:y.value.useCustomTimes&&y.value.startTime?new Date(y.value.startTime).toISOString():null,endTime:y.value.useCustomTimes&&y.value.endTime?new Date(y.value.endTime).toISOString():null,checkInChanges:u.value?.getPendingChanges?.()||[],assignmentsToRemove:u.value?.getMarkedForRemoval?.()||[],checklistChanges:f.value||[],pendingAssignments:a.assignments.filter(V=>V.isPending).map(V=>({marshalId:V.marshalId})),pendingNewChecklistItems:p.value,pendingNewNotes:g.value};s("save",Y)},Le=()=>{a.location&&a.location.id&&s("delete",a.location.id)},Pe=Y=>{s("remove-assignment",Y)},q=()=>{s("open-assign-modal")},X=Y=>{s("select-marshal",Y)},fe=()=>{s("close")},we=(Y,V)=>{y.value[Y]=V,Fe()};return(Y,V)=>(v(),Ze(Vt,{show:e.show,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:fe},{header:ze(()=>[r("h2",h4,[U.value?(v(),m("span",{key:0,class:"modal-title-icon",innerHTML:U.value},null,8,f4)):M("",!0),Ye(" "+C(R.value),1)])]),"tab-header":ze(()=>[Ae(Zi,{modelValue:i.value,"onUpdate:modelValue":V[0]||(V[0]=J=>i.value=J),tabs:W.value},null,8,["modelValue","tabs"])]),footer:ze(()=>[r("div",B4,[r("div",N4,[j.value&&!e.lockedFromMarshal?(v(),m("button",{key:0,type:"button",onClick:Le,class:"btn btn-danger"}," Delete ")):M("",!0),!j.value&&!ue.value?(v(),m("button",{key:1,type:"button",onClick:Ve,class:"btn btn-secondary mobile-only"},C(re.value),1)):M("",!0)]),r("button",{type:"button",onClick:pe,class:"btn btn-success"}," Save ")])]),default:ze(()=>[i.value==="details"?(v(),Ze(JT,{key:0,form:y.value,areas:e.areas,"event-date":e.eventDate,"area-term-singular":E.value,"area-term-plural":D.value,"checkpoint-term-singular":x.value,"people-term-plural":A.value,"onUpdate:form":Je,onInput:Fe,onSave:pe},null,8,["form","areas","event-date","area-term-singular","area-term-plural","checkpoint-term-singular","people-term-plural"])):M("",!0),i.value==="location"?(v(),Ze(nA,{key:1,form:y.value,"is-moving":l.value,"checkpoint-term-singular":x.value,"people-term-plural":A.value,areas:e.areas,locations:e.allLocations,marshals:e.availableMarshals,"is-editing":j.value,"onUpdate:form":Je,onInput:Fe,onSave:pe,onMoveLocation:Ke},null,8,["form","is-moving","checkpoint-term-singular","people-term-plural","areas","locations","marshals","is-editing"])):M("",!0),i.value==="marshals"?(v(),Ze(IA,{key:2,ref_key:"assignmentsTabRef",ref:u,form:y.value,assignments:e.assignments,"people-term":A.value,"person-term":O.value,"checkpoint-term":x.value,"read-only":e.lockedFromMarshal,"onUpdate:form":Je,onInput:Fe,onRemoveAssignment:Pe,onOpenAssignModal:q,onSelectMarshal:X},null,8,["form","assignments","people-term","person-term","checkpoint-term","read-only"])):M("",!0),i.value==="checklists"&&j.value?(v(),Ze(Xv,{key:3,ref_key:"checklistTabRef",ref:d,modelValue:f.value,"onUpdate:modelValue":V[1]||(V[1]=J=>f.value=J),"event-id":e.eventId,"location-id":e.location.id,locations:e.allLocations,areas:e.areas,assignments:e.assignments,onChange:_e},null,8,["modelValue","event-id","location-id","locations","areas","assignments"])):M("",!0),i.value==="checklists"?(v(),Ze(VE,{key:4,modelValue:p.value,"onUpdate:modelValue":V[2]||(V[2]=J=>p.value=J),"all-checklist-items":e.allChecklistItems,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":j.value,"checkpoint-term-singular":x.value,onChange:Fe},null,8,["modelValue","all-checklist-items","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):M("",!0),i.value==="notes"&&j.value?(v(),Ze(mc,{key:5,"event-id":e.eventId,"location-id":e.location?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","location-id","all-notes","locations","areas","assignments"])):M("",!0),i.value==="notes"?(v(),Ze(d4,{key:6,modelValue:g.value,"onUpdate:modelValue":V[3]||(V[3]=J=>g.value=J),"all-notes":e.notes,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":j.value,"checkpoint-term-singular":x.value,onChange:Fe},null,8,["modelValue","all-notes","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):M("",!0),i.value==="appearance"?(v(),m("div",p4,[r("div",v4,[r("button",{type:"button",class:ce(["accordion-header",{expanded:_.value.iconStyle}]),onClick:V[4]||(V[4]=J=>w("iconStyle"))},[r("div",{class:"accordion-icon",innerHTML:he.value},null,8,m4),r("span",g4,C(x.value)+" marker style",1),r("span",y4,C(_.value.iconStyle?"":""),1)],2),_.value.iconStyle?(v(),m("div",k4,[r("p",_4," Choose a custom icon for this "+C(P.value)+", or leave as Default to inherit from "+C(N.value)+" or event settings. ",1),Ae(ad,{"style-type":y.value.styleType||"default","style-color":y.value.styleColor||"","style-background-shape":y.value.styleBackgroundShape||"","style-background-color":y.value.styleBackgroundColor||"","style-border-color":y.value.styleBorderColor||"","style-icon-color":y.value.styleIconColor||"","style-size":y.value.styleSize||"","style-map-rotation":y.value.styleMapRotation??"","inherited-style-type":K.value.type,"inherited-style-color":K.value.color,"inherited-background-shape":K.value.backgroundShape||"","inherited-background-color":K.value.backgroundColor||K.value.color||"","inherited-border-color":K.value.borderColor||"","inherited-icon-color":K.value.iconColor||"","inherited-size":K.value.size||"","inherited-map-rotation":K.value.mapRotation??"","default-label":Q.value,"icon-label":"Marker style",level:"checkpoint","show-preview":!0,"onUpdate:styleType":V[5]||(V[5]=J=>we("styleType",J)),"onUpdate:styleColor":V[6]||(V[6]=J=>we("styleColor",J)),"onUpdate:styleBackgroundShape":V[7]||(V[7]=J=>we("styleBackgroundShape",J)),"onUpdate:styleBackgroundColor":V[8]||(V[8]=J=>we("styleBackgroundColor",J)),"onUpdate:styleBorderColor":V[9]||(V[9]=J=>we("styleBorderColor",J)),"onUpdate:styleIconColor":V[10]||(V[10]=J=>we("styleIconColor",J)),"onUpdate:styleSize":V[11]||(V[11]=J=>we("styleSize",J)),"onUpdate:styleMapRotation":V[12]||(V[12]=J=>we("styleMapRotation",J))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation","default-label"])])):M("",!0)]),r("div",b4,[r("button",{type:"button",class:ce(["accordion-header",{expanded:_.value.terminology}]),onClick:V[13]||(V[13]=J=>w("terminology"))},[V[17]||(V[17]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("circle",{cx:"9",cy:"8",r:"3",fill:"#6366F1"}),r("path",{d:"M3 18c0-3.3 2.7-6 6-6s6 2.7 6 6",fill:"#6366F1",opacity:"0.5"}),r("circle",{cx:"17",cy:"14",r:"5",fill:"#10B981",opacity:"0.3"}),r("circle",{cx:"17",cy:"14",r:"3",fill:"#10B981"}),r("circle",{cx:"17",cy:"14",r:"1",fill:"white"})])],-1)),V[18]||(V[18]=r("span",{class:"accordion-title"},"Terminology",-1)),r("span",w4,C(ee.value),1),r("span",C4,C(_.value.terminology?"":""),1)],2),_.value.terminology?(v(),m("div",L4,[r("p",S4," Customise what this "+C(P.value)+" and its "+C(A.value.toLowerCase())+" are called. ",1),r("div",x4,[r("div",I4,[r("label",null,"What is this "+C(P.value)+" called?",1),r("select",{value:y.value.checkpointTerm,class:"form-input",onChange:V[14]||(V[14]=J=>{Je({...y.value,checkpointTerm:J.target.value}),Fe()})},[r("option",T4,"Use "+C(N.value)+" default ("+C(x.value)+")",1),V[19]||(V[19]=r("option",{value:"Vehicle"},"Vehicle",-1)),V[20]||(V[20]=r("option",{value:"Car"},"Car",-1)),V[21]||(V[21]=r("option",{value:"Bike"},"Bike",-1)),(v(!0),m(Se,null,Ne(B(Os).checkpoint,J=>(v(),m("option",{key:J,value:J},C(J),9,M4))),128))],40,$4)]),r("div",A4,[r("label",null,"What are "+C(A.value.toLowerCase())+" called here?",1),r("select",{value:y.value.peopleTerm,class:"form-input",onChange:V[15]||(V[15]=J=>{Je({...y.value,peopleTerm:J.target.value}),Fe()})},[r("option",P4,"Use "+C(N.value)+" default ("+C(S.value)+")",1),(v(!0),m(Se,null,Ne(B(Os).people,J=>(v(),m("option",{key:J,value:J},C(J),9,D4))),128))],40,E4)])])])):M("",!0)])])):M("",!0),i.value==="incidents"?(v(),m("div",R4,[r("div",O4,[(v(!0),m(Se,null,Ne(e.incidents,J=>(v(),Ze(ql,{key:J.incidentId,incident:J,onSelect:V[16]||(V[16]=Me=>Y.$emit("select-incident",Me))},null,8,["incident"]))),128))])])):M("",!0)]),_:1},8,["show","is-dirty","z-index"]))}},U4=je(F4,[["__scopeId","data-v-61f1a81f"]]),z4={class:"tab-content"},H4={key:0,class:"error-banner"},V4=["value"],G4={key:0,class:"field-error"},j4={class:"contact-row"},Z4=["value"],q4={key:0,class:"field-error"},W4=["value"],K4={key:0,class:"field-error"},J4=["value"],Y4={key:0,class:"field-error"},X4={key:1,class:"magic-link-section"},Q4={key:0,class:"loading-text"},e3={key:1,class:"magic-link-container"},t3={class:"magic-link-row"},n3=["value"],o3={key:0,class:"error-text"},s3={key:1,class:"magic-link-actions"},a3=["disabled"],i3={key:2,class:"success-text"},l3={key:3,class:"error-text"},r3={key:2,class:"error-text"},c3={__name:"MarshalDetailsTab",props:{form:{type:Object,required:!0},eventId:{type:String,default:null},marshalId:{type:String,default:null},validationErrors:{type:Object,default:()=>({})}},emits:["update:form","input"],setup(e,{expose:t,emit:o}){const a=e,s=o,i=$(null),l=$(null),u=$(null),d=$(null),f=$(""),p=$(!1),g=$(!1),y=$(""),k=$(!1),_=$(!1),w=$(!1),S=$(""),A=(E,N)=>{s("update:form",{...a.form,[E]:N}),s("input")},T=async()=>{if(!(!a.eventId||!a.marshalId)){g.value=!0,y.value="";try{const E=await gs.getMagicLink(a.eventId,a.marshalId);f.value=E.data.magicLink,p.value=E.data.hasEmail}catch(E){console.error("Failed to fetch magic link:",E),y.value="Failed to load login link"}finally{g.value=!1}}},x=$(""),P=async()=>{x.value="";try{if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(f.value),k.value=!0,setTimeout(()=>{k.value=!1},2e3);return}}catch(E){console.warn("Clipboard API failed, trying fallback:",E)}try{const E=document.createElement("textarea");E.value=f.value,E.style.position="fixed",E.style.left="-9999px",E.style.top="0",document.body.appendChild(E),E.focus(),E.select();const N=document.execCommand("copy");document.body.removeChild(E),N?(k.value=!0,setTimeout(()=>{k.value=!1},2e3)):(x.value="Copy failed. Please select and copy the link manually.",setTimeout(()=>{x.value=""},4e3))}catch(E){console.error("Fallback copy failed:",E),x.value="Copy not supported. Please select and copy the link manually.",setTimeout(()=>{x.value=""},4e3)}},O=async()=>{if(!(!a.eventId||!a.marshalId)){_.value=!0,w.value=!1,S.value="";try{await gs.sendMagicLink(a.eventId,a.marshalId),w.value=!0,setTimeout(()=>{w.value=!1},3e3)}catch(E){console.error("Failed to send email:",E),S.value=E.response?.data?.message||"Failed to send email"}finally{_.value=!1}}};return qe(()=>a.marshalId,E=>{E?T():(f.value="",p.value=!1)},{immediate:!0}),t({focusField:E=>{un(()=>{const D={name:i,email:l,phoneNumber:u,notes:d}[E];D?.value&&(D.value.focus(),D.value.scrollIntoView({behavior:"smooth",block:"center"}))})}}),(E,N)=>(v(),m("div",z4,[e.validationErrors.general?(v(),m("div",H4,C(e.validationErrors.general),1)):M("",!0),r("div",{class:ce(["form-group",{"has-error":e.validationErrors.name}])},[N[5]||(N[5]=r("label",null,"Name *",-1)),r("input",{ref_key:"nameInputRef",ref:i,value:e.form.name,onInput:N[0]||(N[0]=D=>A("name",D.target.value)),type:"text",required:"",class:ce(["form-input",{"input-error":e.validationErrors.name}])},null,42,V4),e.validationErrors.name?(v(),m("span",G4,C(e.validationErrors.name),1)):M("",!0)],2),r("div",j4,[r("div",{class:ce(["form-group contact-email",{"has-error":e.validationErrors.email}])},[N[6]||(N[6]=r("label",null,"Email",-1)),r("input",{ref_key:"emailInputRef",ref:l,value:e.form.email,onInput:N[1]||(N[1]=D=>A("email",D.target.value)),type:"email",class:ce(["form-input",{"input-error":e.validationErrors.email}])},null,42,Z4),e.validationErrors.email?(v(),m("span",q4,C(e.validationErrors.email),1)):M("",!0)],2),r("div",{class:ce(["form-group contact-phone",{"has-error":e.validationErrors.phoneNumber}])},[N[7]||(N[7]=r("label",null,"Phone number",-1)),r("input",{ref_key:"phoneInputRef",ref:u,value:e.form.phoneNumber,onInput:N[2]||(N[2]=D=>A("phoneNumber",D.target.value)),type:"tel",class:ce(["form-input",{"input-error":e.validationErrors.phoneNumber}])},null,42,W4),e.validationErrors.phoneNumber?(v(),m("span",K4,C(e.validationErrors.phoneNumber),1)):M("",!0)],2)]),r("div",{class:ce(["form-group",{"has-error":e.validationErrors.notes}])},[N[8]||(N[8]=r("label",null,"Notes",-1)),r("textarea",{ref_key:"notesInputRef",ref:d,value:e.form.notes,onInput:N[3]||(N[3]=D=>A("notes",D.target.value)),class:ce(["form-input",{"input-error":e.validationErrors.notes}]),rows:"3",placeholder:"e.g., Needs to leave by 11am"},null,42,J4),e.validationErrors.notes?(v(),m("span",Y4,C(e.validationErrors.notes),1)):M("",!0)],2),e.marshalId?(v(),m("div",X4,[N[9]||(N[9]=r("label",null,"Login link",-1)),N[10]||(N[10]=r("p",{class:"help-text"},"Share this unique link with the marshal so they can access their dashboard.",-1)),g.value?(v(),m("div",Q4,"Loading link...")):f.value?(v(),m("div",e3,[r("div",t3,[r("input",{type:"text",value:f.value,readonly:"",class:"form-input magic-link-input",onFocus:N[4]||(N[4]=D=>D.target.select())},null,40,n3),r("button",{type:"button",class:"btn btn-secondary",onClick:P},C(k.value?"Copied!":"Copy link"),1)]),x.value?(v(),m("p",o3,C(x.value),1)):M("",!0),p.value?(v(),m("div",s3,[r("button",{type:"button",class:"btn btn-primary",disabled:_.value,onClick:O},C(_.value?"Sending...":"Send via email"),9,a3)])):M("",!0),w.value?(v(),m("p",i3,"Email sent successfully!")):M("",!0),S.value?(v(),m("p",l3,C(S.value),1)):M("",!0)])):y.value?(v(),m("div",r3,C(y.value),1)):M("",!0)])):M("",!0)]))}},u3=je(c3,[["__scopeId","data-v-16ffb81b"]]),d3={class:"card-header"},h3={class:"checkpoint-name-row"},f3=["innerHTML"],p3={class:"checkpoint-name"},v3={key:0,class:"checkpoint-description"},m3={key:0,class:"card-areas"},g3={key:1,class:"card-check-in"},y3={key:0,class:"check-in-time"},k3={key:0,class:"check-in-method"},_3={key:1,class:"unsaved-indicator"},b3={key:2,class:"card-locked"},w3={class:"locked-badge"},C3={key:3,class:"card-badge"},L3={key:4,class:"card-badge"},S3={__name:"MarshalCheckpointCard",props:{assignment:{type:Object,required:!0},location:{type:Object,default:null},areas:{type:Array,default:()=>[]},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isLocked:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1}},emits:["click","toggle-check-in","remove","undo-remove"],setup(e,{emit:t}){const{termsLower:o}=ht(),a=e,s=t,i=G(()=>a.location?a.location.areaIds||a.location.AreaIds||[]:[]),l=G(()=>i.value.map(k=>{const _=a.areas.find(w=>w.id===k);return _?_.name:null}).filter(Boolean)),u=G(()=>i.value.map(k=>{const _=a.areas.find(w=>w.id===k);return _?_.color:"#999"})),d=G(()=>{if(!a.location)return"#667eea";const k=a.location,_=k.resolvedStyleBackgroundColor||k.ResolvedStyleBackgroundColor||k.resolvedStyleColor||k.ResolvedStyleColor;if(_)return _;if(i.value.length>0){const w=a.areas.find(S=>S.id===i.value[0]);if(w)return w.color}return"#667eea"}),f=G(()=>{if(!a.location)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
    </svg>`;const k=a.location,_=k.resolvedStyleType||k.ResolvedStyleType,w=k.resolvedStyleBackgroundColor||k.ResolvedStyleBackgroundColor||k.resolvedStyleColor||k.ResolvedStyleColor,S=k.resolvedStyleBorderColor||k.ResolvedStyleBorderColor,A=k.resolvedStyleIconColor||k.ResolvedStyleIconColor,T=k.resolvedStyleBackgroundShape||k.ResolvedStyleBackgroundShape;return _&&_!=="default"||w||S||A||T&&T!=="circle"?Sn({type:_||"circle",backgroundShape:T||"circle",backgroundColor:w||"#667eea",borderColor:S||"#ffffff",iconColor:A||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),p=k=>k?new Date(k).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",g=G(()=>{const{checkedInBy:k,checkInMethod:_,marshalName:w}=a.assignment;return k&&k!==w?k:_||""}),y=()=>{!a.assignment.isPending&&!a.isMarkedForRemoval&&!a.isLocked&&s("click",a.assignment)};return(k,_)=>(v(),m("div",{class:ce(["marshal-checkpoint-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-locked":e.isLocked}]),style:Qe({borderLeftColor:e.isMarkedForRemoval?void 0:d.value})},[r("div",d3,[r("div",{class:"card-title",onClick:y},[r("span",h3,[r("span",{class:"checkpoint-icon",innerHTML:f.value},null,8,f3),r("span",p3,C(e.assignment.locationName),1),e.assignment.locationDescription?(v(),m("span",v3,"  "+C(e.assignment.locationDescription),1)):M("",!0)])]),!e.isLocked&&!e.isMarkedForRemoval?(v(),m("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:_[0]||(_[0]=rt(w=>k.$emit("remove",e.assignment),["stop"]))},"  ")):M("",!0),e.isMarkedForRemoval?(v(),m("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:_[1]||(_[1]=rt(w=>k.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):M("",!0)]),l.value.length>0&&!e.isMarkedForRemoval?(v(),m("div",m3,[(v(!0),m(Se,null,Ne(l.value,(w,S)=>(v(),m("span",{key:S,class:"area-badge",style:Qe({backgroundColor:u.value[S]})},C(w),5))),128))])):M("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.isLocked?(v(),m("div",g3,[r("button",{class:ce(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:_[2]||(_[2]=w=>k.$emit("toggle-check-in",e.assignment))},[..._[3]||(_[3]=[r("span",{class:"toggle-icon"},"",-1),r("span",{class:"toggle-label-wrapper"},[r("span",{class:"toggle-label toggle-label-check-in"},"Check in"),r("span",{class:"toggle-label toggle-label-checked-in"},"Checked in")],-1)])],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(v(),m("span",y3,[Ye(C(p(e.assignment.checkInTime))+" ",1),g.value?(v(),m("span",k3,"("+C(g.value)+")",1)):M("",!0)])):e.hasUnsavedChanges?(v(),m("span",_3," Unsaved ")):M("",!0)])):M("",!0),e.isLocked&&!e.isMarkedForRemoval?(v(),m("div",b3,[r("span",w3,"Viewing from this "+C(B(o).checkpoint),1)])):M("",!0),e.assignment.isPending?(v(),m("div",C3,[..._[4]||(_[4]=[r("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):M("",!0),e.isMarkedForRemoval?(v(),m("div",L3,[..._[5]||(_[5]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):M("",!0)],6))}},x3=je(S3,[["__scopeId","data-v-df38bf23"]]),I3={class:"tab-content"},$3={key:0,class:"read-only-notice"},T3={class:"section-title"},M3={key:1,class:"form-group",style:{"margin-top":"1.5rem"}},A3={value:""},E3=["value"],P3={__name:"MarshalCheckpointsTab",props:{assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isNewMarshal:{type:Boolean,default:!1},lockedCheckpointId:{type:String,default:null}},emits:["input","remove-assignment","assign-to-location","select-checkpoint"],setup(e,{expose:t,emit:o}){const{termsLower:a}=ht(),s=e,i=o,{pendingCheckInChanges:l,getEffectiveCheckInStatus:u,handleToggleCheckIn:d}=Yv(()=>i("input")),f=$(""),p=$(new Set),g=G(()=>s.assignments?.length||0),y=O=>s.allLocations&&s.allLocations.find(F=>F.id===O)||null,k=G(()=>[...s.assignments].sort((O,F)=>(O.locationName||"").localeCompare(F.locationName||"",void 0,{numeric:!0,sensitivity:"base"}))),_=O=>p.value.has(O),w=O=>{O.isPending||i("select-checkpoint",O)},S=O=>{d(O)},A=O=>{O.isPending?i("remove-assignment",O):(p.value.add(O.id),i("input"))},T=O=>{p.value.delete(O.id),i("input")},x=G(()=>{const O=[...s.availableLocations];return O.sort((F,E)=>F.name.localeCompare(E.name,void 0,{numeric:!0,sensitivity:"base"})),O}),P=()=>{f.value&&(i("assign-to-location",f.value),f.value="")};return t({pendingCheckInChanges:l,clearPendingChanges:()=>{l.value.clear(),p.value.clear(),f.value=""},getPendingChanges:()=>Array.from(l.value.entries()).map(([O,F])=>({assignmentId:O,shouldBeCheckedIn:F})),getMarkedForRemoval:()=>Array.from(p.value)}),(O,F)=>(v(),m("div",I3,[e.lockedCheckpointId?(v(),m("div",$3," Viewing from "+C(B(a).checkpoint)+" - "+C(B(a).checkpoints)+" cannot be modified here. ",1)):M("",!0),r("h3",T3,"Assigned "+C(B(a).checkpoints)+" ("+C(g.value)+")",1),Ae(Zl,{"is-empty":e.assignments.length===0,"empty-message":`No ${B(a).checkpoints} assigned yet.`,"empty-hint":e.lockedCheckpointId?"":`Use the dropdown below to assign this ${B(a).person} to ${B(a).checkpoints}.`},{default:ze(()=>[(v(!0),m(Se,null,Ne(k.value,E=>(v(),Ze(x3,{key:E.id,assignment:E,location:y(E.locationId),areas:e.areas,"effective-check-in-status":B(u)(E),"has-unsaved-changes":B(l).has(E.id),"is-locked":!!e.lockedCheckpointId,"is-marked-for-removal":_(E.id),onClick:w,onToggleCheckIn:S,onRemove:A,onUndoRemove:T},null,8,["assignment","location","areas","effective-check-in-status","has-unsaved-changes","is-locked","is-marked-for-removal"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),!e.lockedCheckpointId&&x.value.length>0?(v(),m("div",M3,[r("label",null,"Assign to "+C(B(a).checkpoint),1),He(r("select",{"onUpdate:modelValue":F[0]||(F[0]=E=>f.value=E),class:"form-input",onChange:P},[r("option",A3,"Select a "+C(B(a).checkpoint)+"...",1),(v(!0),m(Se,null,Ne(x.value,E=>(v(),m("option",{key:E.id,value:E.id},[Ye(C(E.name),1),E.description?(v(),m(Se,{key:0},[Ye(" - "+C(E.description),1)],64)):M("",!0)],8,E3))),128))],544),[[Fn,f.value]])])):M("",!0)]))}},D3=je(P3,[["__scopeId","data-v-f60fc06e"]]),R3={class:"marshal-checklist-view"},O3={key:0,class:"loading-state"},B3={key:1,class:"error-state"},N3={key:2,class:"empty-state"},F3={__name:"MarshalChecklistView",props:{eventId:{type:String,required:!0},marshalId:{type:String,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{termsLower:a}=ht(),s=e,i=o,l=$([]),u=$(!1),d=$(null),f=$(new Map),p=G(()=>l.value.map(w=>{const S=f.value.get(w.itemId),A=S!==void 0?S.complete:w.isCompleted,T=S!==void 0&&S.complete!==w.isCompleted;return{...w,localIsCompleted:A,isModified:T}})),g=async()=>{if(!(!s.eventId||!s.marshalId)){u.value=!0,d.value=null;try{const w=await Dt.getMarshalChecklist(s.eventId,s.marshalId);if(l.value=w.data||[],s.modelValue&&s.modelValue.length>0){const S=new Map;s.modelValue.forEach(A=>{S.set(A.itemId,{complete:A.complete,contextType:A.contextType,contextId:A.contextId})}),f.value=S}}catch(w){console.error("Failed to load checklist:",w),d.value=w.response?.data?.message||"Failed to load checklist"}finally{u.value=!1}}},y=w=>{const S=f.value.get(w.itemId),A=S!==void 0?S.complete:w.isCompleted;f.value.set(w.itemId,{complete:!A,contextType:w.completionContextType,contextId:w.completionContextId}),k()},k=()=>{const w=[];for(const[S,A]of f.value.entries()){const T=l.value.find(x=>x.itemId===S);T&&A.complete!==T.isCompleted&&w.push({itemId:S,complete:A.complete,contextType:A.contextType,contextId:A.contextId})}i("update:modelValue",w),i("change",w)};return t({resetLocalState:()=>{if(f.value=new Map,s.modelValue&&s.modelValue.length>0){const w=new Map;s.modelValue.forEach(S=>{w.set(S.itemId,{complete:S.complete,contextType:S.contextType,contextId:S.contextId})}),f.value=w}},loadChecklist:g}),qe(()=>[s.eventId,s.marshalId],()=>{g()},{immediate:!0}),(w,S)=>(v(),m("div",R3,[u.value?(v(),m("div",O3," Loading checklist... ")):d.value?(v(),m("div",B3,[r("p",null,C(d.value),1),r("button",{onClick:g,class:"btn btn-secondary btn-small"}," Retry ")])):l.value.length===0?(v(),m("div",N3,[r("p",null,"No checklist items for this "+C(B(a).person)+".",1)])):(v(),Ze(id,{key:3,items:p.value,locations:e.locations,areas:e.areas,onToggleComplete:y},null,8,["items","locations","areas"]))]))}},U3=je(F3,[["__scopeId","data-v-7460304c"]]),z3={class:"checklist-preview"},H3={class:"preview-actions"},V3={class:"preview-header"},G3={key:0,class:"add-item-form"},j3=["placeholder"],Z3=["disabled"],q3={key:1,class:"pending-items"},W3={class:"item-content"},K3={class:"item-header"},J3={class:"item-text"},Y3={class:"item-scope"},X3=["onClick"],Q3={key:2,class:"empty-state"},eP={key:0,class:"help-text"},tP={key:3,class:"checklist-items"},nP={class:"item-content"},oP={class:"item-header"},sP={class:"item-text"},aP={class:"item-scope"},iP=["title"],lP={key:0,class:"item-context"},rP={__name:"ChecklistPreview",props:{allChecklistItems:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ht(),a=e,s=t,i=$(!1),l=$(""),u=$([...a.modelValue]);qe(()=>a.modelValue,T=>{u.value=[...T]},{deep:!0});const d=()=>{l.value.trim()&&(u.value.push({text:l.value.trim(),isNew:!0}),l.value="",i.value=!1,p())},f=T=>{u.value.splice(T,1),p()},p=()=>{s("update:modelValue",[...u.value]),s("change")},g=G(()=>{const T=new Set;for(const x of a.pendingLocationIds){const P=a.allLocations.find(O=>O.id===x);P&&(P.areaIds||P.AreaIds||[]).forEach(F=>T.add(F))}return[...T]}),y=T=>{const x=T.scope,P=T.itemType,O=T.ids||[];return x==="SpecificPeople"&&P==="Marshal"?O.includes("ALL_MARSHALS"):(x==="EveryoneAtCheckpoints"||x==="OnePerCheckpoint")&&P==="Checkpoint"?O.includes("ALL_CHECKPOINTS")?!0:O.some(F=>a.pendingLocationIds.includes(F)):x==="OnePerCheckpoint"&&P==="Area"?O.includes("ALL_AREAS")?!0:O.some(F=>g.value.includes(F)):(x==="EveryoneInAreas"||x==="OnePerArea"||x==="EveryAreaLead"||x==="OneLeadPerArea")&&P==="Area"?O.includes("ALL_AREAS")?!0:O.some(F=>g.value.includes(F)):!1},k=G(()=>a.allChecklistItems.filter(T=>T.scopeConfigurations&&T.scopeConfigurations.length>0?T.scopeConfigurations.some(x=>y(x)):!1)),_=T=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,EveryoneInAreas:`All in ${o.value.areas}`,OnePerArea:`One per ${o.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${o.value.area}`})[T]||T,w=T=>{if(!T.scopeConfigurations||T.scopeConfigurations.length===0)return"Unknown";const x=T.scopeConfigurations.find(O=>y(O));if(!x)return _(T.scopeConfigurations[0].scope);const P=x.ids||[];return P.includes("ALL_MARSHALS")?"Everyone":P.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:P.includes("ALL_AREAS")?`All ${o.value.areas}`:_(x.scope)},S=T=>{if(!T.scopeConfigurations||T.scopeConfigurations.length===0)return"";const x=T.scopeConfigurations.find(O=>y(O));return x&&{SpecificPeople:"This item is for everyone at the event",EveryoneAtCheckpoints:`This item is for everyone at specified ${o.value.checkpoints}`,OnePerCheckpoint:`One person at each ${o.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${o.value.areas}`,OnePerArea:`One person in each ${o.value.area} needs to complete this`,EveryAreaLead:`This item is for ${o.value.area} leads only`,OneLeadPerArea:`One ${o.value.area} lead needs to complete this`}[x.scope]||""},A=T=>{if(!T.scopeConfigurations||T.scopeConfigurations.length===0)return null;const x=T.scopeConfigurations.find(F=>y(F));if(!x)return null;const P=x.itemType,O=x.ids||[];if(O.includes("ALL_MARSHALS")||O.includes("ALL_CHECKPOINTS")||O.includes("ALL_AREAS"))return null;if(P==="Checkpoint"){const F=a.allLocations.filter(E=>O.includes(E.id)&&a.pendingLocationIds.includes(E.id)).map(E=>E.name);if(F.length>0)return`At: ${F.join(", ")}`}if(P==="Area"){const F=a.areas.filter(E=>O.includes(E.id)&&g.value.includes(E.id)).map(E=>E.name);if(F.length>0)return`In: ${F.join(", ")}`}return null};return(T,x)=>(v(),m("div",z3,[r("div",H3,[r("p",V3,C(e.isEditing?`Add new ${B(o).checklist} for this ${B(o).person}:`:`${B(o).checklists} that will apply to this ${B(o).person}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:x[0]||(x[0]=P=>i.value=!i.value)},C(i.value?"Cancel":`Add ${B(o).checklist}`),1)]),i.value?(v(),m("div",G3,[He(r("input",{"onUpdate:modelValue":x[1]||(x[1]=P=>l.value=P),type:"text",placeholder:`Enter ${B(o).checklist} text...`,class:"add-item-input",onKeyup:vs(d,["enter"])},null,40,j3),[[st,l.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim(),onClick:d}," Add ",8,Z3)])):M("",!0),u.value.length>0?(v(),m("div",q3,[(v(!0),m(Se,null,Ne(u.value,(P,O)=>(v(),m("div",{key:`pending-${O}`,class:"checklist-item pending"},[x[3]||(x[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",W3,[r("div",K3,[r("div",J3,C(P.text),1),r("div",Y3,[x[2]||(x[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:F=>f(O),title:"Remove"},"  ",8,X3)])])])]))),128))])):M("",!0),!e.isEditing&&k.value.length===0&&u.value.length===0?(v(),m("div",Q3,[r("p",null,"No "+C(B(o).checklists)+" will apply based on the current "+C(B(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),m("p",eP," Assign "+C(B(o).checkpoints)+" to see relevant "+C(B(o).checklists)+". ",1)):M("",!0)])):M("",!0),!e.isEditing&&k.value.length>0?(v(),m("div",tP,[(v(!0),m(Se,null,Ne(k.value,P=>(v(),m("div",{key:P.id,class:"checklist-item"},[x[4]||(x[4]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",nP,[r("div",oP,[r("div",sP,C(P.text),1),r("div",aP,[r("span",{class:"scope-pill",title:S(P)},C(w(P)),9,iP)])]),A(P)?(v(),m("div",lP,C(A(P)),1)):M("",!0)])]))),128))])):M("",!0)]))}},cP=je(rP,[["__scopeId","data-v-6deaacc2"]]),uP={class:"notes-preview"},dP={class:"preview-actions"},hP={class:"preview-header"},fP={key:0,class:"add-item-form"},pP={class:"add-form-fields"},vP=["disabled"],mP={key:1,class:"pending-items"},gP={class:"note-header"},yP={class:"note-title"},kP={class:"note-actions"},_P=["onClick"],bP={key:0,class:"note-content"},wP={key:2,class:"empty-state"},CP={key:0,class:"help-text"},LP={key:3,class:"notes-list"},SP={class:"note-header"},xP={class:"note-title"},IP=["title"],$P={key:0,class:"note-content"},TP={key:1,class:"note-context"},MP={__name:"NotesPreview",props:{allNotes:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ht(),a=e,s=t,i=$(!1),l=$(""),u=$(""),d=$([...a.modelValue]);qe(()=>a.modelValue,x=>{d.value=[...x]},{deep:!0});const f=()=>{!l.value.trim()&&!u.value.trim()||(d.value.push({title:l.value.trim(),content:u.value.trim(),isNew:!0}),l.value="",u.value="",i.value=!1,g())},p=x=>{d.value.splice(x,1),g()},g=()=>{s("update:modelValue",[...d.value]),s("change")},y=G(()=>{const x=new Set;for(const P of a.pendingLocationIds){const O=a.allLocations.find(F=>F.id===P);O&&(O.areaIds||O.AreaIds||[]).forEach(E=>x.add(E))}return[...x]}),k=x=>{const P=x.scope,O=x.itemType,F=x.ids||[];return P==="SpecificPeople"&&O==="Marshal"?F.includes("ALL_MARSHALS"):P==="EveryoneAtCheckpoints"&&O==="Checkpoint"?F.includes("ALL_CHECKPOINTS")?!0:F.some(E=>a.pendingLocationIds.includes(E)):P==="EveryoneInAreas"&&O==="Area"?F.includes("ALL_AREAS")?!0:F.some(E=>y.value.includes(E)):!1},_=G(()=>a.allNotes.filter(x=>x.scopeConfigurations&&x.scopeConfigurations.length>0?x.scopeConfigurations.some(P=>k(P)):!1)),w=x=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[x]||x,S=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"Unknown";const P=x.scopeConfigurations.find(F=>k(F));if(!P)return w(x.scopeConfigurations[0].scope);const O=P.ids||[];return O.includes("ALL_MARSHALS")?"Everyone":O.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:O.includes("ALL_AREAS")?`All ${o.value.areas}`:w(P.scope)},A=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"";const P=x.scopeConfigurations.find(F=>k(F));return P&&{SpecificPeople:"This note is for everyone at the event",EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[P.scope]||""},T=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return null;const P=x.scopeConfigurations.find(E=>k(E));if(!P)return null;const O=P.itemType,F=P.ids||[];if(F.includes("ALL_MARSHALS")||F.includes("ALL_CHECKPOINTS")||F.includes("ALL_AREAS"))return null;if(O==="Checkpoint"){const E=a.allLocations.filter(N=>F.includes(N.id)&&a.pendingLocationIds.includes(N.id)).map(N=>N.name);if(E.length>0)return`At: ${E.join(", ")}`}if(O==="Area"){const E=a.areas.filter(N=>F.includes(N.id)&&y.value.includes(N.id)).map(N=>N.name);if(E.length>0)return`In: ${E.join(", ")}`}return null};return(x,P)=>(v(),m("div",uP,[r("div",dP,[r("p",hP,C(e.isEditing?`Add new note for this ${B(o).person}:`:`Notes that will be visible to this ${B(o).person}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:P[0]||(P[0]=O=>i.value=!i.value)},C(i.value?"Cancel":"Add note"),1)]),i.value?(v(),m("div",fP,[r("div",pP,[He(r("input",{"onUpdate:modelValue":P[1]||(P[1]=O=>l.value=O),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[st,l.value]]),He(r("textarea",{"onUpdate:modelValue":P[2]||(P[2]=O=>u.value=O),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[st,u.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim()&&!u.value.trim(),onClick:f}," Add ",8,vP)])):M("",!0),d.value.length>0?(v(),m("div",mP,[(v(!0),m(Se,null,Ne(d.value,(O,F)=>(v(),m("div",{key:`pending-${F}`,class:"note-item pending"},[r("div",gP,[r("span",yP,C(O.title||"Untitled"),1),r("div",kP,[P[3]||(P[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:E=>p(F),title:"Remove"},"  ",8,_P)])]),O.content?(v(),m("div",bP,C(O.content),1)):M("",!0)]))),128))])):M("",!0),!e.isEditing&&_.value.length===0&&d.value.length===0?(v(),m("div",wP,[r("p",null,"No notes will be visible based on the current "+C(B(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),m("p",CP," Assign "+C(B(o).checkpoints)+" to see relevant notes. ",1)):M("",!0)])):M("",!0),!e.isEditing&&_.value.length>0?(v(),m("div",LP,[(v(!0),m(Se,null,Ne(_.value,O=>(v(),m("div",{key:O.id,class:"note-item"},[r("div",SP,[r("span",xP,C(O.title||"Untitled"),1),r("span",{class:"scope-pill",title:A(O)},C(S(O)),9,IP)]),O.content?(v(),m("div",$P,C(O.content),1)):M("",!0),T(O)?(v(),m("div",TP,C(T(O)),1)):M("",!0)]))),128))])):M("",!0)]))}},AP=je(MP,[["__scopeId","data-v-e8e0946a"]]),EP={key:6,class:"tab-content incidents-tab"},PP={class:"incidents-list"},DP={class:"custom-footer"},RP={class:"footer-left"},OP={__name:"EditMarshalModal",props:{show:{type:Boolean,default:!1},marshal:{type:Object,default:null},eventId:{type:String,required:!0},assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1},eventNotes:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},incidents:{type:Array,default:()=>[]},validationErrors:{type:Object,default:()=>({})},lockedCheckpointId:{type:String,default:null},zIndex:{type:Number,default:1e3}},emits:["close","save","delete","toggle-check-in","remove-assignment","assign-to-location","update:isDirty","select-incident","select-checkpoint"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=ht(),i=e,l=o,u=$("details"),d=$(null),f=$(null),p=$(null),g=$([]),y=$([]),k=$([]),_=$([]),w=$({name:"",email:"",phoneNumber:"",notes:""}),S=G(()=>{const re=i.isEditing?`Edit ${s.value.person}`:`Create ${s.value.person}`,De=w.value.name?.trim();return De?`${re} - ${De}`:re}),A=G(()=>{const re=[{value:"details",label:"Details",icon:"details"},{value:"checkpoints",label:a.value.checkpoints,icon:"checkpoint"},{value:"checklists",label:a.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}];return i.incidents&&i.incidents.length>0&&re.push({value:"incidents",label:"Incidents",icon:"incidents"}),re}),T=G(()=>A.value.findIndex(re=>re.value===u.value)),x=G(()=>T.value===A.value.length-1),P=G(()=>x.value?null:A.value[T.value+1]),O=G(()=>P.value?`${P.value.label}...`:""),F=G(()=>y.value.map(re=>re.locationId)),E=G(()=>i.isEditing?i.assignments:y.value.map(re=>({id:`pending-${re.locationId}`,locationId:re.locationId,locationName:i.allLocations.find(De=>De.id===re.locationId)?.name||"Unknown",isPending:!0}))),N=G(()=>{if(i.isEditing)return i.availableLocations;const re=y.value.map(De=>De.locationId);return i.allLocations.filter(De=>!re.includes(De.id))});qe(()=>i.marshal,re=>{re?w.value={name:re.name||"",email:re.email||"",phoneNumber:re.phoneNumber||"",notes:re.notes||""}:w.value={name:"",email:"",phoneNumber:"",notes:""}},{immediate:!0,deep:!0}),qe(()=>i.show,re=>{re&&(u.value="details",g.value=[],y.value=[],k.value=[],_.value=[],i.isEditing||(w.value={name:"",email:"",phoneNumber:"",notes:""}),f.value?.clearPendingChanges&&f.value.clearPendingChanges(),p.value?.resetLocalState&&p.value.resetLocalState())});const D=re=>{w.value=re},j=()=>{l("update:isDirty",!0)},R=()=>{l("update:isDirty",!0)},W=()=>{P.value&&(u.value=P.value.value)},ne=()=>{const re={...w.value,checkInChanges:f.value?.getPendingChanges?.()||[],assignmentsToRemove:f.value?.getMarkedForRemoval?.()||[],checklistChanges:g.value||[],pendingAssignments:i.isEditing?[]:y.value,pendingNewChecklistItems:k.value,pendingNewNotes:_.value};l("save",re)},ue=()=>{l("delete")},K=re=>{!i.isEditing&&re.isPending?y.value=y.value.filter(De=>De.locationId!==re.locationId):l("remove-assignment",re)},Q=re=>{i.isEditing?l("assign-to-location",re):(y.value.push({locationId:re}),l("update:isDirty",!0))},he=re=>{l("select-checkpoint",re)},U=()=>{l("close")};return t({switchToTab:re=>{u.value=re},focusField:re=>{d.value?.focusField&&d.value.focusField(re)}}),(re,De)=>(v(),Ze(Vt,{show:e.show,title:S.value,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:U},{"tab-header":ze(()=>[Ae(Zi,{modelValue:u.value,"onUpdate:modelValue":De[0]||(De[0]=et=>u.value=et),tabs:A.value},null,8,["modelValue","tabs"])]),footer:ze(()=>[r("div",DP,[r("div",RP,[e.isEditing&&!e.lockedCheckpointId?(v(),m("button",{key:0,type:"button",onClick:ue,class:"btn btn-danger"}," Delete ")):M("",!0),!e.isEditing&&!x.value?(v(),m("button",{key:1,type:"button",onClick:W,class:"btn btn-secondary mobile-only"},C(O.value),1)):M("",!0)]),r("button",{type:"button",onClick:ne,class:"btn btn-success"}," Save ")])]),default:ze(()=>[u.value==="details"?(v(),Ze(u3,{key:0,ref_key:"detailsTabRef",ref:d,form:w.value,"event-id":e.eventId,"marshal-id":e.isEditing?e.marshal?.id:null,"validation-errors":e.validationErrors,"onUpdate:form":D,onInput:j},null,8,["form","event-id","marshal-id","validation-errors"])):M("",!0),u.value==="checkpoints"?(v(),Ze(D3,{key:1,ref_key:"checkpointsTabRef",ref:f,assignments:E.value,"available-locations":N.value,"all-locations":e.allLocations,areas:e.areas,"is-new-marshal":!e.isEditing,"locked-checkpoint-id":e.lockedCheckpointId,onInput:j,onRemoveAssignment:K,onAssignToLocation:Q,onSelectCheckpoint:he},null,8,["assignments","available-locations","all-locations","areas","is-new-marshal","locked-checkpoint-id"])):M("",!0),u.value==="checklists"&&e.isEditing?(v(),Ze(U3,{key:2,ref_key:"checklistTabRef",ref:p,modelValue:g.value,"onUpdate:modelValue":De[1]||(De[1]=et=>g.value=et),"event-id":e.eventId,"marshal-id":e.marshal.id,locations:e.allLocations,areas:e.areas,onChange:R},null,8,["modelValue","event-id","marshal-id","locations","areas"])):M("",!0),u.value==="checklists"?(v(),Ze(cP,{key:3,modelValue:k.value,"onUpdate:modelValue":De[2]||(De[2]=et=>k.value=et),"all-checklist-items":e.allChecklistItems,"pending-location-ids":F.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:j},null,8,["modelValue","all-checklist-items","pending-location-ids","all-locations","areas","is-editing"])):M("",!0),u.value==="notes"&&e.isEditing?(v(),Ze(mc,{key:4,"event-id":e.eventId,"marshal-id":e.marshal?.id,"all-notes":e.eventNotes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","marshal-id","all-notes","locations","areas","assignments"])):M("",!0),u.value==="notes"?(v(),Ze(AP,{key:5,modelValue:_.value,"onUpdate:modelValue":De[3]||(De[3]=et=>_.value=et),"all-notes":e.eventNotes,"pending-location-ids":F.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:j},null,8,["modelValue","all-notes","pending-location-ids","all-locations","areas","is-editing"])):M("",!0),u.value==="incidents"?(v(),m("div",EP,[r("div",PP,[(v(!0),m(Se,null,Ne(e.incidents,et=>(v(),Ze(ql,{key:et.incidentId,incident:et,onSelect:De[4]||(De[4]=Je=>re.$emit("select-incident",Je))},null,8,["incident"]))),128))])])):M("",!0)]),_:1},8,["show","title","is-dirty","z-index"]))}},BP=je(OP,[["__scopeId","data-v-dd9a44f3"]]),NP={class:"locations-list"},FP={class:"conflict-actions"},UP={__name:"AssignmentConflictModal",props:{show:{type:Boolean,default:!1},conflictData:{type:Object,default:()=>({marshalName:"",locations:[]})}},emits:["close","choice"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ht(),s=t,i=u=>{s("choice",u)},l=()=>{s("close")};return(u,d)=>(v(),Ze(Vt,{show:e.show,title:`${B(o).person} already assigned`,size:"medium","z-index":1100,onClose:l},{actions:ze(()=>[r("div",FP,[r("button",{onClick:d[0]||(d[0]=f=>i("move")),class:"btn btn-primary btn-full"}," Move to this "+C(B(a).checkpoint)+" (remove from others) ",1),r("button",{onClick:d[1]||(d[1]=f=>i("both")),class:"btn btn-secondary btn-full"}," Assign to both (keep existing assignments) "),r("button",{onClick:d[2]||(d[2]=f=>i("choose-other")),class:"btn btn-secondary btn-full"}," Choose someone else "),r("button",{onClick:d[3]||(d[3]=f=>i("cancel")),class:"btn btn-secondary btn-full"}," Cancel ")])]),default:ze(()=>[r("p",null,[r("strong",null,C(e.conflictData.marshalName),1),d[4]||(d[4]=Ye(" is currently assigned to: ",-1))]),r("ul",NP,[(v(!0),m(Se,null,Ne(e.conflictData.locations,f=>(v(),m("li",{key:f},C(f),1))),128))]),d[5]||(d[5]=r("p",null,"What would you like to do?",-1))]),_:1},8,["show","title"]))}},zP=je(UP,[["__scopeId","data-v-997e8aaa"]]),HP={key:0,class:"assign-marshal-section"},VP={value:""},GP=["value"],jP=["disabled"],ZP={key:1,class:"assign-marshal-section create-mode"},qP={class:"form-group"},WP={class:"form-group"},KP={class:"form-group"},JP={__name:"AssignMarshalModal",props:{show:{type:Boolean,default:!1},locationName:{type:String,default:""},marshals:{type:Array,default:()=>[]}},emits:["close","assign-existing","create-and-assign"],setup(e,{emit:t}){const{termsLower:o}=ht(),a=e,s=t,i=$(!1),l=$(""),u=$({name:"",email:"",phoneNumber:""});qe(()=>a.show,k=>{k||(i.value=!1,l.value="",u.value={name:"",email:"",phoneNumber:""})});const d=()=>{i.value=!0},f=()=>{l.value&&s("assign-existing",l.value)},p=()=>{u.value.name&&s("create-and-assign",{...u.value})},g=()=>{i.value=!1,u.value={name:"",email:"",phoneNumber:""}},y=()=>{s("close")};return(k,_)=>(v(),Ze(Vt,{show:e.show,title:i.value?`Create new ${B(o).person}`:`Assign ${B(o).person} to ${e.locationName}`,size:"medium",onClose:y},{actions:ze(()=>[i.value?(v(),m(Se,{key:0},[r("button",{onClick:g,class:"btn btn-secondary"}," Cancel "),r("button",{onClick:p,class:"btn btn-primary"}," Create & assign ")],64)):M("",!0)]),default:ze(()=>[i.value?(v(),m("div",ZP,[r("h3",null,"Create new "+C(B(o).person),1),r("div",qP,[_[5]||(_[5]=r("label",null,"Name *",-1)),He(r("input",{"onUpdate:modelValue":_[1]||(_[1]=w=>u.value.name=w),type:"text",required:"",class:"form-input"},null,512),[[st,u.value.name]])]),r("div",WP,[_[6]||(_[6]=r("label",null,"Email",-1)),He(r("input",{"onUpdate:modelValue":_[2]||(_[2]=w=>u.value.email=w),type:"email",class:"form-input"},null,512),[[st,u.value.email]])]),r("div",KP,[_[7]||(_[7]=r("label",null,"Phone",-1)),He(r("input",{"onUpdate:modelValue":_[3]||(_[3]=w=>u.value.phoneNumber=w),type:"tel",class:"form-input"},null,512),[[st,u.value.phoneNumber]])])])):(v(),m("div",HP,[r("h3",null,"Select existing "+C(B(o).person),1),He(r("select",{"onUpdate:modelValue":_[0]||(_[0]=w=>l.value=w),class:"form-input"},[r("option",VP,"Choose a "+C(B(o).person)+"...",1),(v(!0),m(Se,null,Ne(e.marshals,w=>(v(),m("option",{key:w.id,value:w.id},[Ye(C(w.name)+" ",1),w.assignedLocationIds&&w.assignedLocationIds.length>0?(v(),m(Se,{key:0},[Ye(" (assigned to "+C(w.assignedLocationIds.length)+" "+C(w.assignedLocationIds.length>1?B(o).checkpoints:B(o).checkpoint)+") ",1)],64)):M("",!0)],8,GP))),128))],512),[[Fn,l.value]]),r("button",{onClick:f,class:"btn btn-primary btn-full",style:{"margin-top":"1rem"},disabled:!l.value}," Assign selected "+C(B(o).person),9,jP),_[4]||(_[4]=r("div",{class:"divider"},"OR",-1)),r("button",{onClick:d,class:"btn btn-secondary btn-full"}," Create new "+C(B(o).person),1)]))]),_:1},8,["show","title"]))}},YP=je(JP,[["__scopeId","data-v-fa70b913"]]),XP={class:"shift-times-content"},QP={class:"info-text"},e6={class:"time-delta-info"},t6={class:"delta-detail"},n6={class:"delta-detail"},o6={class:"delta-summary"},s6={class:"affected-checkpoints"},a6={class:"option-selection"},i6={class:"radio-option"},l6={class:"radio-option"},r6={__name:"ShiftCheckpointTimesModal",props:{show:{type:Boolean,default:!1},oldEventDate:{type:String,required:!0},newEventDate:{type:String,required:!0},affectedCheckpointsCount:{type:Number,default:0}},emits:["confirm","cancel"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ht(),s=e,i=t,l=$("shift"),u=G(()=>{const y=new Date(s.oldEventDate);return new Date(s.newEventDate)-y}),d=y=>new Date(y).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),f=y=>{const k=Math.abs(y),_=y>=0?"+":"-",w=Math.floor(k/(1e3*60*60*24)),S=Math.floor(k%(1e3*60*60*24)/(1e3*60*60)),A=Math.floor(k%(1e3*60*60)/(1e3*60)),T=[];return w>0&&T.push(`${w}d`),S>0&&T.push(`${S}h`),A>0&&T.push(`${A}m`),`${_}${T.join(" ")}`},p=()=>{i("confirm",{shouldShift:l.value==="shift",timeDelta:u.value})},g=()=>{i("cancel")};return(y,k)=>(v(),Ze(Vt,{show:e.show,title:`Shift ${B(o).checkpoint} Times?`,size:"medium",onClose:g},{actions:ze(()=>[r("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:p,class:"btn btn-primary"},C(l.value==="shift"?"Shift Times":"Keep Times"),1)]),default:ze(()=>[r("div",XP,[r("p",QP," You've changed the event date/time. Some "+C(B(a).checkpoints)+" have custom times set. ",1),r("div",e6,[k[2]||(k[2]=r("strong",null,"Event time change:",-1)),r("div",t6," Old: "+C(d(e.oldEventDate)),1),r("div",n6," New: "+C(d(e.newEventDate)),1),r("div",o6," Delta: "+C(f(u.value)),1)]),r("p",s6,[r("strong",null,C(e.affectedCheckpointsCount)+" "+C(e.affectedCheckpointsCount===1?B(a).checkpoint:B(a).checkpoints),1),k[3]||(k[3]=Ye(" with custom times will be shifted by the same amount. ",-1))]),r("div",a6,[r("label",i6,[He(r("input",{"onUpdate:modelValue":k[0]||(k[0]=_=>l.value=_),type:"radio",value:"shift",name:"shift-option"},null,512),[[hh,l.value]]),r("div",null,[r("strong",null,"Shift all "+C(B(a).checkpoint)+" times",1),k[4]||(k[4]=r("small",null,"Recommended: Maintains relative timing",-1))])]),r("label",l6,[He(r("input",{"onUpdate:modelValue":k[1]||(k[1]=_=>l.value=_),type:"radio",value:"keep",name:"shift-option"},null,512),[[hh,l.value]]),r("div",null,[r("strong",null,"Keep "+C(B(a).checkpoint)+" times unchanged",1),r("small",null,C(B(o).checkpoint)+" times will stay at their current values",1)])])])])]),_:1},8,["show","title"]))}},c6=je(r6,[["__scopeId","data-v-a6454aff"]]),u6={class:"search-section"},d6={class:"form-group"},h6={class:"suggestions-list"},f6={class:"suggestion-content"},p6={key:0,class:"suggestion-detail"},v6=["onClick"],m6={class:"suggestion-content"},g6={class:"suggestion-name"},y6={key:0,class:"suggestion-detail"},k6=["onClick"],_6={class:"suggestion-content"},b6={class:"suggestion-name"},w6={key:0,class:"suggestion-detail"},C6={key:1,class:"no-results"},L6={key:2,class:"no-results"},S6={__name:"AddAreaContactModal",props:{show:{type:Boolean,default:!1},areaName:{type:String,default:""},areaId:{type:String,default:""},contacts:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},excludeContactIds:{type:Array,default:()=>[]}},emits:["close","select-contact","create-from-marshal","create-new"],setup(e,{emit:t}){const{terms:o}=ht(),a=e,s=t,i=$(""),l=$(null),u=G(()=>a.contacts.filter(E=>a.excludeContactIds.includes(E.contactId)&&E.marshalId).map(E=>E.marshalId)),d=G(()=>a.contacts.filter(E=>E.marshalId).map(E=>E.marshalId)),f=G(()=>a.contacts.filter(E=>!a.excludeContactIds.includes(E.contactId))),p=G(()=>a.marshals.filter(E=>!u.value.includes(E.id)&&!d.value.includes(E.id))),g=E=>E?E.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",y=G(()=>{const E=g(i.value);return E?E.split(" ").filter(N=>N.length>0):[]}),k=(E,N)=>{if(N.length===0)return{score:1,isPartial:!1};const D=g(E);let j=0;for(const R of N)D.includes(R)&&j++;return{score:j,isPartial:j>0&&j<N.length,isFullMatch:j===N.length}},_=G(()=>{const E=y.value,N=[];return f.value.forEach(D=>{const j=`${D.name||""} ${D.role||""}`,R=k(j,E);(E.length===0||R.score>0)&&N.push({key:`contact-${D.contactId}`,type:"contact",name:D.name,detail:D.role?F(D.role):null,data:D,matchScore:R.score,isPartial:R.isPartial,isFullMatch:R.isFullMatch})}),p.value.forEach(D=>{const j=`${D.name||""} ${D.email||""}`,R=k(j,E);(E.length===0||R.score>0)&&N.push({key:`marshal-${D.id}`,type:"marshal",name:D.name,detail:D.email||D.phoneNumber||null,data:D,matchScore:R.score,isPartial:R.isPartial,isFullMatch:R.isFullMatch})}),N.sort((D,j)=>j.matchScore!==D.matchScore?j.matchScore-D.matchScore:D.name.localeCompare(j.name,void 0,{sensitivity:"base"})),N}),w=G(()=>y.value.length===0?_.value:_.value.filter(E=>E.isFullMatch)),S=G(()=>y.value.length===0?[]:_.value.filter(E=>E.isPartial)),A=G(()=>S.value.length>0);qe(()=>a.show,async E=>{E&&(i.value="",await un(),l.value?.focus())});const T=E=>{const N=a.contacts.find(D=>D.marshalId===E.id);if(N){if(a.excludeContactIds.includes(N.contactId))return;s("select-contact",N)}else s("create-from-marshal",E)},x=E=>{s("select-contact",E)},P=()=>{s("create-new",i.value.trim())},O=()=>{s("close")},F=E=>E?E.replace(/([A-Z])/g," $1").replace(/^./,N=>N.toUpperCase()).trim():"";return(E,N)=>(v(),Ze(Vt,{show:e.show,title:`Add contact to ${e.areaName}`,size:"medium",onClose:O},{actions:ze(()=>[r("button",{onClick:O,class:"btn btn-secondary"}," Cancel ")]),default:ze(()=>[r("div",u6,[r("div",d6,[N[1]||(N[1]=r("label",null,"Search or create",-1)),He(r("input",{ref_key:"searchInputRef",ref:l,"onUpdate:modelValue":N[0]||(N[0]=D=>i.value=D),type:"text",class:"form-input",placeholder:"Filter by name..."},null,512),[[st,i.value]])]),r("div",h6,[r("div",{class:"suggestion-item create-new",onClick:P},[N[3]||(N[3]=r("span",{class:"suggestion-icon create-icon"},"+",-1)),r("div",f6,[N[2]||(N[2]=r("span",{class:"suggestion-name"},"Create new contact",-1)),i.value.trim()?(v(),m("span",p6,'"'+C(i.value.trim())+'"',1)):M("",!0)])]),(v(!0),m(Se,null,Ne(w.value,D=>(v(),m("div",{key:D.key,class:"suggestion-item",onClick:j=>D.type==="marshal"?T(D.data):x(D.data)},[r("span",{class:ce(["suggestion-icon",D.type==="marshal"?"marshal-icon":"contact-icon"])},C(D.type==="marshal"?"M":"C"),3),r("div",m6,[r("span",g6,C(D.name),1),D.detail?(v(),m("span",y6,C(D.detail),1)):M("",!0)]),r("span",{class:ce(["suggestion-badge",{"contact-badge":D.type==="contact"}])},C(D.type==="marshal"?B(o).person:"Contact"),3)],8,v6))),128)),A.value?(v(),m(Se,{key:0},[N[4]||(N[4]=r("div",{class:"suggestion-section-header"},"Partial matches",-1)),(v(!0),m(Se,null,Ne(S.value,D=>(v(),m("div",{key:D.key,class:"suggestion-item",onClick:j=>D.type==="marshal"?T(D.data):x(D.data)},[r("span",{class:ce(["suggestion-icon",D.type==="marshal"?"marshal-icon":"contact-icon"])},C(D.type==="marshal"?"M":"C"),3),r("div",_6,[r("span",b6,C(D.name),1),D.detail?(v(),m("span",w6,C(D.detail),1)):M("",!0)]),r("span",{class:ce(["suggestion-badge",{"contact-badge":D.type==="contact"}])},C(D.type==="marshal"?B(o).person:"Contact"),3)],8,k6))),128))],64)):M("",!0),i.value.trim()&&w.value.length===0&&S.value.length===0?(v(),m("div",C6," No matching "+C(B(o).people.toLowerCase())+" or contacts found. ",1)):M("",!0),!i.value.trim()&&w.value.length===0?(v(),m("div",L6," No "+C(B(o).people.toLowerCase())+" or contacts available to add. ",1)):M("",!0)])])]),_:1},8,["show","title"]))}},x6=je(S6,[["__scopeId","data-v-e25ca97b"]]),I6={key:0,class:"tab-content"},$6={class:"form-group"},T6=["disabled"],M6={class:"form-group"},A6={key:1,class:"tab-content"},E6={class:"boundary-section"},P6={key:0,class:"boundary-preview"},D6={class:"boundary-actions"},R6={key:2,class:"tab-content"},O6={class:"contacts-header"},B6={class:"section-title"},N6={key:3,class:"tab-content"},F6={class:"section-title"},U6={key:4,class:"placeholder-message"},z6={key:6,class:"placeholder-message"},H6={key:8,class:"placeholder-message"},V6={key:9,class:"tab-content appearance-tab"},G6={class:"accordion-item"},j6=["innerHTML"],Z6={class:"accordion-title"},q6={class:"accordion-arrow"},W6={key:0,class:"accordion-content"},K6={class:"section-description"},J6={class:"color-picker"},Y6=["title","onClick"],X6={class:"accordion-item"},Q6=["innerHTML"],e5={class:"accordion-title"},t5={class:"accordion-arrow"},n5={key:0,class:"accordion-content"},o5={class:"section-description"},s5={class:"accordion-item"},a5={class:"accordion-title"},i5={class:"accordion-preview"},l5={class:"accordion-arrow"},r5={key:0,class:"accordion-content"},c5={class:"section-description"},u5={class:"form-group"},d5={value:""},h5=["value"],f5={class:"accordion-item"},p5={class:"accordion-title"},v5={class:"accordion-preview"},m5={class:"accordion-arrow"},g5={key:0,class:"accordion-content"},y5={class:"section-description"},k5={class:"form-group"},_5={value:""},b5=["value"],w5={key:10,class:"tab-content incidents-tab"},C5={class:"incidents-list"},L5={class:"custom-footer"},S5={class:"footer-left"},rf="edit_area_accordion",x5={__name:"EditAreaModal",props:{show:{type:Boolean,default:!1},area:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},incidents:{type:Array,default:()=>[]},initialTab:{type:String,default:"details"},route:{type:Array,default:()=>[]}},emits:["close","save","delete","draw-boundary","update:isDirty","select-checkpoint","create-contact-from-marshal","create-new-contact","edit-contact","select-incident"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=ht(),i=()=>x.value.peopleTerm?x.value.peopleTerm:d.eventPeopleTerm||"Marshals",l=(Z=!0)=>{const oe=x.value.checkpointTerm||d.eventCheckpointTerm||"Checkpoints",le=i();return Z?Uv("checkpoint",oe,le):Ja("checkpoint",oe,le)},u=(Z=!0)=>l(Z).toLowerCase(),d=e,f=o,p=$("details"),g=$(null),y=$([]),k=$({}),_=$({}),w=$(!1),S=$(!1),A=$([]),T=$([]),x=$({name:"",description:"",color:wr,displayOrder:0,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),P=()=>({name:"",description:"",color:t2(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),O=()=>d.eventId?`${rf}_${d.eventId}`:rf,F=$({polygonColor:!1,iconStyle:!1,peopleTerm:!1,checkpointTerm:!1});on(()=>{const Z=localStorage.getItem(O());if(Z)try{const oe=JSON.parse(Z);F.value={...F.value,...oe}}catch{}});const E=Z=>{F.value[Z]=!F.value[Z],localStorage.setItem(O(),JSON.stringify(F.value))},N=G(()=>`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <polygon points="4,8 7,3 14,2 20,5 22,12 19,18 12,21 5,19 2,14" fill="${x.value.color||wr}" stroke="#fff" stroke-width="1.5" opacity="0.8"/>
  </svg>`),D=G(()=>{const Z=x.value.checkpointStyleType!=="default"||x.value.checkpointStyleBackgroundShape||x.value.checkpointStyleBackgroundColor||x.value.checkpointStyleBorderColor||x.value.checkpointStyleIconColor||x.value.checkpointStyleSize,oe=d.eventDefaultStyleType!=="default"||d.eventDefaultStyleBackgroundShape||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||d.eventDefaultStyleBorderColor||d.eventDefaultStyleIconColor||d.eventDefaultStyleSize;if(!Z&&!oe)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="areaDefaultGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981"/>
          <stop offset="50%" style="stop-color:#F59E0B"/>
          <stop offset="100%" style="stop-color:#EF4444"/>
        </linearGradient>
      </defs>
      <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#areaDefaultGrad)" stroke="#fff" stroke-width="1.5"/>
    </svg>`;const le=x.value.checkpointStyleType&&x.value.checkpointStyleType!=="default"?x.value.checkpointStyleType:d.eventDefaultStyleType&&d.eventDefaultStyleType!=="default"?d.eventDefaultStyleType:"default",Te=x.value.checkpointStyleBackgroundShape||d.eventDefaultStyleBackgroundShape||"circle",Oe=x.value.checkpointStyleBackgroundColor||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||"#667eea",Be=x.value.checkpointStyleBorderColor||d.eventDefaultStyleBorderColor||"#ffffff",Xe=x.value.checkpointStyleIconColor||d.eventDefaultStyleIconColor||"#ffffff",mt=x.value.checkpointStyleSize||d.eventDefaultStyleSize||"100";return Sn({type:le!=="default"?le:Te,backgroundShape:Te,backgroundColor:Oe,borderColor:Be,iconColor:Xe,size:mt,outputSize:24})}),j=G(()=>d.area&&d.area.id),R=G(()=>!x.value.polygon||x.value.polygon.length===0?[]:x.value.polygon.map((Z,oe)=>({id:`polygon-point-${oe}`,latitude:Z.lat,longitude:Z.lng}))),W=G(()=>d.area?.id?d.areas.filter(Z=>Z.id!==d.area.id).map(Z=>({...Z,color:"#999999"})):d.areas.map(Z=>({...Z,color:"#999999"})));G(()=>ee.value.map(Z=>Z.id));const ne=G(()=>{const Z=[{value:"details",label:"Details",icon:"details"},{value:"boundary",label:"Boundary",icon:"area"},{value:"contacts",label:"Contacts",icon:"marshal"},{value:"checkpoints",label:l(),icon:"checkpoint"},{value:"checklists",label:a.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return d.incidents&&d.incidents.length>0&&Z.push({value:"incidents",label:"Incidents",icon:"incidents"}),Z}),ue=G(()=>ne.value.findIndex(Z=>Z.value===p.value)),K=G(()=>ue.value===ne.value.length-1),Q=G(()=>K.value?null:ne.value[ue.value+1]),he=G(()=>Q.value?`${Q.value.label}...`:""),U=G(()=>{if(!d.area||!d.area.id)return[];const Z=d.checkpoints.filter(oe=>oe.areaIds&&oe.areaIds.includes(d.area.id)).map(oe=>oe.id);return d.assignments.filter(oe=>Z.includes(oe.locationId))}),ee=G(()=>!d.area||!d.area.id?[]:d.checkpoints.filter(Z=>Z.areaIds&&Z.areaIds.includes(d.area.id))),de=G(()=>{const Z=[...ee.value];return Z.sort((oe,le)=>{const Te=oe.name.match(/^(\d+)/),Oe=le.name.match(/^(\d+)/);if(Te&&Oe){const Be=parseInt(Te[1]),Xe=parseInt(Oe[1]);if(Be!==Xe)return Be-Xe}return oe.name.localeCompare(le.name,void 0,{numeric:!0,sensitivity:"base"})}),Z}),re=G(()=>!d.area||!d.area.id?[]:d.contacts.filter(Z=>Z.scopeConfigurations?Z.scopeConfigurations.some(oe=>oe.scope==="EveryoneInAreas"&&oe.itemType==="Area"?oe.ids?.includes("ALL_AREAS")?!0:oe.ids?.includes(d.area.id):!1):!1)),De=G(()=>{const Z=new Set(re.value.map(Te=>Te.contactId)),oe=re.value.map(Te=>({...Te,isPending:!1,isExisting:!0,isMarkedForRemoval:T.value.includes(Te.contactId)})),le=A.value.filter(Te=>!Z.has(Te.contactId)).map(Te=>({...Te,isPending:!0,isExisting:!1,isMarkedForRemoval:!1}));return[...oe,...le].sort((Te,Oe)=>Te.name.localeCompare(Oe.name,void 0,{sensitivity:"base"}))}),et=G(()=>{const Z=re.value.map(le=>le.contactId),oe=A.value.map(le=>le.contactId);return[...Z,...oe]}),Je=async Z=>{if(!(k.value[Z]||_.value[Z])){_.value[Z]=!0;try{const le=(await Dt.getCheckpointChecklist(d.eventId,Z)).data||[];k.value[Z]={total:le.length,completed:le.filter(Te=>Te.isCompleted).length}}catch(oe){console.error("Failed to load checklist status for checkpoint:",Z,oe),k.value[Z]={total:0,completed:0}}finally{_.value[Z]=!1}}};qe(()=>d.area,Z=>{if(Z){const oe=Z.polygon?typeof Z.polygon=="string"?JSON.parse(Z.polygon):Z.polygon:[];x.value={name:Z.name||"",description:Z.description||"",color:Z.color||wr,displayOrder:Z.displayOrder||0,isDefault:Z.isDefault||!1,polygon:oe,checkpointStyleType:Z.checkpointStyleType||"default",checkpointStyleColor:Z.checkpointStyleColor||"",checkpointStyleBackgroundShape:Z.checkpointStyleBackgroundShape||"",checkpointStyleBackgroundColor:Z.checkpointStyleBackgroundColor||"",checkpointStyleBorderColor:Z.checkpointStyleBorderColor||"",checkpointStyleIconColor:Z.checkpointStyleIconColor||"",checkpointStyleSize:Z.checkpointStyleSize||"",checkpointStyleMapRotation:Z.checkpointStyleMapRotation??"",peopleTerm:Z.peopleTerm||"",checkpointTerm:Z.checkpointTerm||""}}else x.value=P()},{immediate:!0,deep:!0}),qe(()=>d.show,Z=>{Z&&(p.value=d.initialTab||"details",y.value=[],k.value={},_.value={},A.value=[],T.value=[],S.value=!1,j.value||(x.value=P()),g.value?.resetLocalState&&g.value.resetLocalState())}),qe(p,Z=>{Z==="checkpoints"&&d.area&&d.area.id&&ee.value.forEach(oe=>{setTimeout(()=>Je(oe.id),0)})});const Fe=()=>{f("update:isDirty",!0)},Ke=Z=>{x.value.color=Z,Fe()},_e=(Z,oe)=>{x.value[Z]=oe,Fe()},Ve=()=>{f("draw-boundary",x.value)},pe=Z=>{x.value.polygon=Z,Fe()},Le=()=>{x.value.polygon=[],w.value=!1,Fe()},Pe=Z=>{S.value=!1,f("create-contact-from-marshal",{marshal:Z,area:d.area})},q=Z=>{S.value=!1,f("create-new-contact",{name:Z,area:d.area})},X=Z=>{A.value.find(oe=>oe.contactId===Z.contactId)||(A.value.push(Z),Fe()),S.value=!1},fe=Z=>{A.value=A.value.filter(oe=>oe.contactId!==Z),Fe()},we=Z=>{T.value.includes(Z)||(T.value.push(Z),Fe())},Y=Z=>Z.isPending?"Remove pending contact":`Remove from ${s.value.area}`,V=Z=>{De.value.find(le=>le.contactId===Z)?.isPending?fe(Z):we(Z)},J=Z=>{T.value=T.value.filter(oe=>oe!==Z),Fe()},Me=Z=>{y.value=Z,Fe()},Re=()=>{Q.value&&(p.value=Q.value.value)},Ce=()=>{const Z=d.area?{name:x.value.name,description:x.value.description,color:x.value.color,polygon:x.value.polygon.length>0?x.value.polygon:null,displayOrder:x.value.displayOrder,checkpointStyleType:x.value.checkpointStyleType,checkpointStyleColor:x.value.checkpointStyleColor,checkpointStyleBackgroundShape:x.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:x.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:x.value.checkpointStyleBorderColor,checkpointStyleIconColor:x.value.checkpointStyleIconColor,checkpointStyleSize:x.value.checkpointStyleSize,checkpointStyleMapRotation:x.value.checkpointStyleMapRotation!=null&&x.value.checkpointStyleMapRotation!==""?String(x.value.checkpointStyleMapRotation):null,peopleTerm:x.value.peopleTerm,checkpointTerm:x.value.checkpointTerm,checklistChanges:y.value||[],pendingContacts:A.value||[],contactsToRemove:T.value||[]}:{name:x.value.name,description:x.value.description,color:x.value.color,polygon:x.value.polygon.length>0?x.value.polygon:null,checkpointStyleType:x.value.checkpointStyleType,checkpointStyleColor:x.value.checkpointStyleColor,checkpointStyleBackgroundShape:x.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:x.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:x.value.checkpointStyleBorderColor,checkpointStyleIconColor:x.value.checkpointStyleIconColor,checkpointStyleSize:x.value.checkpointStyleSize,checkpointStyleMapRotation:x.value.checkpointStyleMapRotation!=null&&x.value.checkpointStyleMapRotation!==""?String(x.value.checkpointStyleMapRotation):null,peopleTerm:x.value.peopleTerm,checkpointTerm:x.value.checkpointTerm,pendingContacts:A.value||[]};f("save",Z)},be=()=>{f("delete",d.area.id)},me=()=>{f("close")};return t({addPendingContact:Z=>{Z&&!A.value.find(oe=>oe.contactId===Z.contactId)&&(A.value.push(Z),Fe())},removeContactById:Z=>{const oe=A.value.some(le=>le.contactId===Z);A.value=A.value.filter(le=>le.contactId!==Z),T.value=T.value.filter(le=>le!==Z),oe&&Fe()}}),(Z,oe)=>(v(),Ze(Vt,{show:e.show,title:e.area&&e.area.id?`Edit ${B(s).area}: ${e.area.name}`:`Create new ${B(s).area}`,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:me},{"tab-header":ze(()=>[Ae(Zi,{modelValue:p.value,"onUpdate:modelValue":oe[0]||(oe[0]=le=>p.value=le),tabs:ne.value},null,8,["modelValue","tabs"])]),footer:ze(()=>[r("div",L5,[r("div",S5,[j.value&&!x.value.isDefault?(v(),m("button",{key:0,type:"button",onClick:be,class:"btn btn-danger"}," Delete ")):M("",!0),!j.value&&!K.value?(v(),m("button",{key:1,type:"button",onClick:Re,class:"btn btn-secondary mobile-only"},C(he.value),1)):M("",!0)]),r("button",{type:"button",onClick:Ce,class:"btn btn-success"}," Save ")])]),default:ze(()=>[p.value==="details"?(v(),m("div",I6,[r("form",{onSubmit:rt(Ce,["prevent"])},[r("div",$6,[oe[25]||(oe[25]=r("label",null,"Name *",-1)),He(r("input",{"onUpdate:modelValue":oe[1]||(oe[1]=le=>x.value.name=le),type:"text",required:"",class:"form-input",disabled:x.value.isDefault,onInput:Fe},null,40,T6),[[st,x.value.name]])]),r("div",M6,[oe[26]||(oe[26]=r("label",null,"Description",-1)),He(r("textarea",{"onUpdate:modelValue":oe[2]||(oe[2]=le=>x.value.description=le),class:"form-input",rows:"3",onInput:Fe},null,544),[[st,x.value.description]])])],32)])):M("",!0),p.value==="boundary"?(v(),m("div",A6,[r("div",E6,[x.value.polygon&&x.value.polygon.length>0?(v(),m("div",P6,[Ae(li,{mode:"edit-polygon","editing-polygon":x.value.polygon,route:e.route,locations:e.checkpoints,areas:W.value,"all-locations-for-bounds":R.value,height:"300px",onPolygonUpdate:pe},null,8,["editing-polygon","route","locations","areas","all-locations-for-bounds"]),oe[27]||(oe[27]=r("p",{class:"boundary-hint"},"Drag points to move them. Click a point to delete it (minimum 3 required).",-1))])):M("",!0),r("div",D6,[!x.value.polygon||x.value.polygon.length===0?(v(),m("button",{key:0,onClick:Ve,class:"btn btn-primary btn-full"}," Draw on map ")):(v(),m(Se,{key:1},[r("button",{onClick:Ve,class:"btn btn-secondary"}," Redraw "),r("button",{onClick:oe[3]||(oe[3]=le=>w.value=!0),class:"btn btn-danger"}," Delete boundary ")],64))])])])):M("",!0),Ae(Bl,{show:w.value,title:"Delete boundary",message:"Are you sure you want to delete this boundary? This cannot be undone.","confirm-text":"Delete","is-danger":!0,onConfirm:Le,onCancel:oe[4]||(oe[4]=le=>w.value=!1)},null,8,["show"]),p.value==="contacts"?(v(),m("div",R6,[r("div",O6,[r("h3",B6,C(B(a).area)+" contacts ("+C(De.value.length)+")",1),r("button",{onClick:oe[5]||(oe[5]=le=>S.value=!0),class:"btn btn-primary btn-small"}," Add contact ")]),Ae(Zv,{contacts:De.value,"show-remove-button":!0,"remove-title":Y,"empty-message":`No contacts assigned to this ${B(s).area}.`,"empty-hint":`Click 'Add contact' to assign contacts who will be visible to ${B(s).people} in this ${B(s).area}.`,onSelect:oe[6]||(oe[6]=le=>Z.$emit("edit-contact",le)),onRemove:V,onUndoRemove:J},null,8,["contacts","empty-message","empty-hint"])])):M("",!0),Ae(x6,{show:S.value,"area-name":x.value.name||"this "+B(s).area,"area-id":d.area?.id||"",contacts:d.contacts,marshals:d.marshals,"exclude-contact-ids":et.value,onClose:oe[7]||(oe[7]=le=>S.value=!1),onSelectContact:X,onCreateFromMarshal:Pe,onCreateNew:q},null,8,["show","area-name","area-id","contacts","marshals","exclude-contact-ids"]),p.value==="checkpoints"&&j.value?(v(),m("div",N6,[r("h3",F6,C(l())+" in "+C(e.area?.name)+" ("+C(ee.value.length)+")",1),Ae(Jv,{checkpoints:de.value,areas:e.areas,"empty-message":`No ${u()} in this ${B(s).area} yet.`,onSelect:oe[8]||(oe[8]=le=>Z.$emit("select-checkpoint",le))},null,8,["checkpoints","areas","empty-message"])])):M("",!0),p.value==="checkpoints"&&!j.value?(v(),m("div",U6,[r("p",null,C(l())+" will be automatically assigned based on boundaries after the "+C(B(s).area)+" is created.",1)])):M("",!0),p.value==="checklists"&&j.value?(v(),Ze(Xv,{key:5,ref_key:"checklistTabRef",ref:g,modelValue:y.value,"onUpdate:modelValue":oe[9]||(oe[9]=le=>y.value=le),"event-id":e.eventId,"area-id":e.area.id,locations:e.allLocations,areas:e.areas,assignments:U.value,onChange:Me},null,8,["modelValue","event-id","area-id","locations","areas","assignments"])):M("",!0),p.value==="checklists"&&!j.value?(v(),m("div",z6,[r("p",null,C(B(a).checklists)+" can be assigned after the "+C(B(s).area)+" is created.",1)])):M("",!0),p.value==="notes"&&j.value?(v(),Ze(mc,{key:7,"event-id":e.eventId,"area-id":e.area?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","area-id","all-notes","locations","areas","assignments"])):M("",!0),p.value==="notes"&&!j.value?(v(),m("div",H6,[r("p",null,"Notes can be viewed after the "+C(B(s).area)+" is created.",1)])):M("",!0),p.value==="appearance"?(v(),m("div",V6,[r("div",G6,[r("button",{type:"button",class:ce(["accordion-header",{expanded:F.value.polygonColor}]),onClick:oe[10]||(oe[10]=le=>E("polygonColor"))},[r("div",{class:"accordion-icon",innerHTML:N.value},null,8,j6),r("span",Z6,C(B(a).area)+" polygon colour",1),r("span",q6,C(F.value.polygonColor?"":""),1)],2),F.value.polygonColor?(v(),m("div",W6,[r("p",K6," Choose a colour for this "+C(B(s).area)+"'s boundary on the map. ",1),r("div",J6,[(v(!0),m(Se,null,Ne(B(Pn),le=>(v(),m("div",{key:le.hex,class:ce(["color-swatch",{selected:x.value.color===le.hex}]),style:Qe({backgroundColor:le.hex}),title:le.name,onClick:Te=>Ke(le.hex)},null,14,Y6))),128))])])):M("",!0)]),r("div",X6,[r("button",{type:"button",class:ce(["accordion-header",{expanded:F.value.iconStyle}]),onClick:oe[11]||(oe[11]=le=>E("iconStyle"))},[r("div",{class:"accordion-icon",innerHTML:D.value},null,8,Q6),r("span",e5,C(l(!1))+" marker style",1),r("span",t5,C(F.value.iconStyle?"":""),1)],2),F.value.iconStyle?(v(),m("div",n5,[r("p",o5," Set a default marker style for all "+C(u())+" in this "+C(B(s).area)+". Individual "+C(u())+" can override this setting. ",1),Ae(ad,{"style-type":x.value.checkpointStyleType||"default","style-color":x.value.checkpointStyleColor||"","style-background-shape":x.value.checkpointStyleBackgroundShape||"","style-background-color":x.value.checkpointStyleBackgroundColor||"","style-border-color":x.value.checkpointStyleBorderColor||"","style-icon-color":x.value.checkpointStyleIconColor||"","style-size":x.value.checkpointStyleSize||"","style-map-rotation":x.value.checkpointStyleMapRotation??"","inherited-style-type":e.eventDefaultStyleType,"inherited-style-color":e.eventDefaultStyleColor,"inherited-background-shape":e.eventDefaultStyleBackgroundShape||"","inherited-background-color":e.eventDefaultStyleBackgroundColor||e.eventDefaultStyleColor||"","inherited-border-color":e.eventDefaultStyleBorderColor||"","inherited-icon-color":e.eventDefaultStyleIconColor||"","inherited-size":e.eventDefaultStyleSize||"","inherited-map-rotation":e.eventDefaultStyleMapRotation??"","default-label":"Event default","icon-label":"Marker style",level:"area","show-preview":!0,"onUpdate:styleType":oe[12]||(oe[12]=le=>_e("checkpointStyleType",le)),"onUpdate:styleColor":oe[13]||(oe[13]=le=>_e("checkpointStyleColor",le)),"onUpdate:styleBackgroundShape":oe[14]||(oe[14]=le=>_e("checkpointStyleBackgroundShape",le)),"onUpdate:styleBackgroundColor":oe[15]||(oe[15]=le=>_e("checkpointStyleBackgroundColor",le)),"onUpdate:styleBorderColor":oe[16]||(oe[16]=le=>_e("checkpointStyleBorderColor",le)),"onUpdate:styleIconColor":oe[17]||(oe[17]=le=>_e("checkpointStyleIconColor",le)),"onUpdate:styleSize":oe[18]||(oe[18]=le=>_e("checkpointStyleSize",le)),"onUpdate:styleMapRotation":oe[19]||(oe[19]=le=>_e("checkpointStyleMapRotation",le))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])])):M("",!0)]),r("div",s5,[r("button",{type:"button",class:ce(["accordion-header",{expanded:F.value.peopleTerm}]),onClick:oe[20]||(oe[20]=le=>E("peopleTerm"))},[oe[28]||(oe[28]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("circle",{cx:"12",cy:"8",r:"4",fill:"#6366F1"}),r("path",{d:"M4 20c0-4.4 3.6-8 8-8s8 3.6 8 8",fill:"#6366F1",opacity:"0.6"})])],-1)),r("span",a5,C(i())+" terminology",1),r("span",i5,C(x.value.peopleTerm||`${e.eventPeopleTerm} (event default)`),1),r("span",l5,C(F.value.peopleTerm?"":""),1)],2),F.value.peopleTerm?(v(),m("div",r5,[r("p",c5," Choose what "+C(i().toLowerCase())+" are called in this "+C(B(s).area)+". This will be inherited by "+C(u())+" unless they override it. ",1),r("div",u5,[oe[29]||(oe[29]=r("label",null,"What are people called?",-1)),He(r("select",{"onUpdate:modelValue":oe[21]||(oe[21]=le=>x.value.peopleTerm=le),class:"form-input",onChange:Fe},[r("option",d5,"Use event default ("+C(e.eventPeopleTerm)+")",1),(v(!0),m(Se,null,Ne(B(Os).people,le=>(v(),m("option",{key:le,value:le},C(le),9,h5))),128))],544),[[Fn,x.value.peopleTerm]])])])):M("",!0)]),r("div",f5,[r("button",{type:"button",class:ce(["accordion-header",{expanded:F.value.checkpointTerm}]),onClick:oe[22]||(oe[22]=le=>E("checkpointTerm"))},[oe[30]||(oe[30]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z",fill:"#10B981"}),r("circle",{cx:"12",cy:"9",r:"2.5",fill:"white"})])],-1)),r("span",p5,C(l(!1))+" terminology",1),r("span",v5,C(x.value.checkpointTerm?B(Su)(x.value.checkpointTerm,i()):`${e.eventCheckpointTerm} (event default)`),1),r("span",m5,C(F.value.checkpointTerm?"":""),1)],2),F.value.checkpointTerm?(v(),m("div",g5,[r("p",y5," Choose what "+C(u())+" are called in this "+C(B(s).area)+". ",1),r("div",k5,[r("label",null,"What are "+C(u())+" called?",1),He(r("select",{"onUpdate:modelValue":oe[23]||(oe[23]=le=>x.value.checkpointTerm=le),class:"form-input",onChange:Fe},[r("option",_5,"Use event default ("+C(e.eventCheckpointTerm)+")",1),(v(!0),m(Se,null,Ne(B(Os).checkpoint,le=>(v(),m("option",{key:le,value:le},C(B(Su)(le,i())),9,b5))),128))],544),[[Fn,x.value.checkpointTerm]])])])):M("",!0)])])):M("",!0),p.value==="incidents"?(v(),m("div",w5,[r("div",C5,[(v(!0),m(Se,null,Ne(e.incidents,le=>(v(),Ze(ql,{key:le.incidentId,incident:le,onSelect:oe[24]||(oe[24]=Te=>Z.$emit("select-incident",Te))},null,8,["incident"]))),128))])])):M("",!0)]),_:1},8,["show","title","is-dirty"]))}},I5=je(x5,[["__scopeId","data-v-94cf46bf"]]),$5=["innerHTML"],T5={__name:"InfoModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Information"},message:{type:String,required:!0},okText:{type:String,default:"OK"}},emits:["close"],setup(e,{emit:t}){const o=t,a=()=>{o("close")};return(s,i)=>(v(),Ze(Vt,{show:e.show,title:e.title,size:"small","z-index":2e3,onClose:a},{actions:ze(()=>[r("button",{onClick:a,class:"btn btn-primary"},C(e.okText),1)]),default:ze(()=>[r("div",{class:"info-content",innerHTML:e.message},null,8,$5)]),_:1},8,["show","title"]))}},gc=je(T5,[["__scopeId","data-v-a6e7148c"]]),M5={class:"tab-content"},A5={class:"form-group"},E5=["placeholder"],P5={key:0,class:"checkbox-label-inline create-separate-items"},D5={class:"tab-content"},R5={class:"custom-footer"},O5={class:"footer-left"},B5={__name:"EditChecklistItemModal",props:{show:{type:Boolean,default:!1},checklistItem:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,s=$(!1),i=$(""),l=$("details"),u=$({text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0}),d=G(()=>!!o.checklistItem),f=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],p=G(()=>f.findIndex(O=>O.value===l.value)),g=G(()=>p.value===f.length-1),y=G(()=>g.value?"":f[p.value+1]?.label||"");qe(()=>o.show,O=>{O&&(l.value=o.initialTab,o.checklistItem?u.value={text:o.checklistItem.text||"",scopeConfigurations:o.checklistItem.scopeConfigurations?JSON.parse(JSON.stringify(o.checklistItem.scopeConfigurations)):[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:o.checklistItem.displayOrder||0,isRequired:o.checklistItem.isRequired!==!1,visibleFrom:o.checklistItem.visibleFrom?k(o.checklistItem.visibleFrom):null,visibleUntil:o.checklistItem.visibleUntil?k(o.checklistItem.visibleUntil):null,mustCompleteBy:o.checklistItem.mustCompleteBy?k(o.checklistItem.mustCompleteBy):null,createSeparateItems:!1}:u.value={text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0},a("update:isDirty",!1))});const k=O=>{if(!O)return null;const F=new Date(O),E=F.getTimezoneOffset();return new Date(F.getTime()-E*60*1e3).toISOString().slice(0,16)},_=O=>O?new Date(O).toISOString():null,w=()=>{a("update:isDirty",!0)},S=()=>{a("close")},A=()=>{g.value||(l.value=f[p.value+1].value)},T=O=>{i.value=O,s.value=!0},x=()=>{if(!u.value.text||!u.value.text.trim()){T("Please enter checklist item text");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){T("Please select at least one scope");return}if(!u.value.scopeConfigurations.some(E=>!(E.itemType!==null&&(!E.ids||E.ids.length===0)))){T("Please configure at least one scope with valid selections");return}const F={text:u.value.text,scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,isRequired:u.value.isRequired,visibleFrom:_(u.value.visibleFrom),visibleUntil:_(u.value.visibleUntil),mustCompleteBy:_(u.value.mustCompleteBy)};d.value||(F.createSeparateItems=u.value.createSeparateItems),a("save",F)},P=()=>{a("delete",o.checklistItem.itemId)};return(O,F)=>(v(),m(Se,null,[Ae(Vt,{show:e.show,title:d.value?"Edit checklist item":"Create checklist item",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:S},{"tab-header":ze(()=>[Ae(Zi,{modelValue:l.value,"onUpdate:modelValue":F[0]||(F[0]=E=>l.value=E),tabs:f},null,8,["modelValue"])]),footer:ze(()=>[r("div",R5,[r("div",O5,[d.value?(v(),m("button",{key:0,type:"button",onClick:P,class:"btn btn-danger"}," Delete ")):M("",!0),!d.value&&!g.value?(v(),m("button",{key:1,type:"button",onClick:A,class:"btn btn-secondary mobile-only"},C(y.value)+"... ",1)):M("",!0)]),r("button",{type:"button",onClick:x,class:"btn btn-success"}," Save ")])]),default:ze(()=>[r("form",{onSubmit:rt(x,["prevent"]),class:"checklist-form"},[He(r("div",M5,[r("div",A5,[F[6]||(F[6]=r("label",{for:"text"},"Checklist text: *",-1)),He(r("textarea",{id:"text","onUpdate:modelValue":F[1]||(F[1]=E=>u.value.text=E),onInput:w,required:"",rows:"3",placeholder:u.value.createSeparateItems?"Enter checklist items, one per line...":"Enter the checklist item text..."},null,40,E5),[[st,u.value.text]]),d.value?M("",!0):(v(),m("label",P5,[He(r("input",{type:"checkbox","onUpdate:modelValue":F[2]||(F[2]=E=>u.value.createSeparateItems=E),onChange:w},null,544),[[Oi,u.value.createSeparateItems]]),F[5]||(F[5]=r("span",null,"Each line creates a new item",-1))]))])],512),[[ks,l.value==="details"]]),He(r("div",D5,[Ae(vc,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":F[3]||(F[3]=E=>u.value.scopeConfigurations=E),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":d.value,onUserChanged:w},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ks,l.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ae(gc,{show:s.value,title:"Validation error",message:i.value,onClose:F[4]||(F[4]=E=>s.value=!1)},null,8,["show","message"])],64))}},N5=je(B5,[["__scopeId","data-v-1384b208"]]),F5={class:"tab-content"},U5={class:"form-group"},z5={class:"form-group"},H5={class:"form-row"},V5={class:"form-group"},G5={class:"form-group"},j5={class:"form-row"},Z5={class:"form-group"},q5={class:"form-group checkbox-group-inline"},W5={class:"checkbox-label-inline"},K5={class:"tab-content"},J5={class:"custom-footer"},Y5={class:"footer-left"},X5={__name:"EditNoteModal",props:{show:{type:Boolean,default:!1},note:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,s=$(!1),i=$(""),l=$("details"),u=$({title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1}),d=G(()=>!!o.note),f=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],p=G(()=>f.findIndex(x=>x.value===l.value)),g=G(()=>p.value===f.length-1),y=G(()=>g.value?"":f[p.value+1]?.label||"");qe(()=>o.show,x=>{x&&(l.value=o.initialTab,o.note?u.value={title:o.note.title||"",content:o.note.content||"",scopeConfigurations:o.note.scopeConfigurations?JSON.parse(JSON.stringify(o.note.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:o.note.displayOrder||0,priority:o.note.priority||"Normal",category:o.note.category||"",isPinned:o.note.isPinned||!1}:u.value={title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1},a("update:isDirty",!1))});const k=()=>{a("update:isDirty",!0)},_=()=>{a("close")},w=()=>{g.value||(l.value=f[p.value+1].value)},S=x=>{i.value=x,s.value=!0},A=()=>{if(!u.value.title||!u.value.title.trim()){S("Please enter a note title");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){S("Please select at least one visibility scope");return}if(!u.value.scopeConfigurations.some(O=>!(O.itemType!==null&&(!O.ids||O.ids.length===0)))){S("Please configure at least one scope with valid selections");return}const P={title:u.value.title.trim(),content:u.value.content||"",scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,priority:u.value.priority||"Normal",category:u.value.category?.trim()||null,isPinned:u.value.isPinned||!1};a("save",P)},T=()=>{a("delete",o.note.noteId)};return(x,P)=>(v(),m(Se,null,[Ae(Vt,{show:e.show,title:d.value?"Edit note":"Create note",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:_},{"tab-header":ze(()=>[Ae(Zi,{modelValue:l.value,"onUpdate:modelValue":P[0]||(P[0]=O=>l.value=O),tabs:f},null,8,["modelValue"])]),footer:ze(()=>[r("div",J5,[r("div",Y5,[d.value?(v(),m("button",{key:0,type:"button",onClick:T,class:"btn btn-danger"}," Delete ")):M("",!0),!d.value&&!g.value?(v(),m("button",{key:1,type:"button",onClick:w,class:"btn btn-secondary mobile-only"},C(y.value)+"... ",1)):M("",!0)]),r("button",{type:"button",onClick:A,class:"btn btn-success"}," Save ")])]),default:ze(()=>[r("form",{onSubmit:rt(A,["prevent"]),class:"note-form"},[He(r("div",F5,[r("div",U5,[P[9]||(P[9]=r("label",{for:"title"},"Title: *",-1)),He(r("input",{id:"title","onUpdate:modelValue":P[1]||(P[1]=O=>u.value.title=O),type:"text",onInput:k,required:"",placeholder:"Enter note title..."},null,544),[[st,u.value.title]])]),r("div",z5,[P[10]||(P[10]=r("label",{for:"content"},"Content:",-1)),He(r("textarea",{id:"content","onUpdate:modelValue":P[2]||(P[2]=O=>u.value.content=O),onInput:k,rows:"6",placeholder:"Enter note content (supports markdown)..."},null,544),[[st,u.value.content]])]),r("div",H5,[r("div",V5,[P[12]||(P[12]=r("label",{for:"priority"},"Priority:",-1)),He(r("select",{id:"priority","onUpdate:modelValue":P[3]||(P[3]=O=>u.value.priority=O),onChange:k},[...P[11]||(P[11]=[r("option",{value:"Emergency"},"Emergency",-1),r("option",{value:"Urgent"},"Urgent",-1),r("option",{value:"High"},"High",-1),r("option",{value:"Normal"},"Normal",-1),r("option",{value:"Low"},"Low",-1)])],544),[[Fn,u.value.priority]])]),r("div",G5,[P[13]||(P[13]=r("label",{for:"category"},"Category:",-1)),He(r("input",{id:"category","onUpdate:modelValue":P[4]||(P[4]=O=>u.value.category=O),type:"text",onInput:k,placeholder:"e.g., Safety, Logistics..."},null,544),[[st,u.value.category]])])]),r("div",j5,[r("div",Z5,[P[14]||(P[14]=r("label",{for:"displayOrder"},"Display order:",-1)),He(r("input",{id:"displayOrder","onUpdate:modelValue":P[5]||(P[5]=O=>u.value.displayOrder=O),type:"number",onInput:k,min:"0"},null,544),[[st,u.value.displayOrder,void 0,{number:!0}]]),P[15]||(P[15]=r("span",{class:"help-text"},"Lower numbers appear first",-1))]),r("div",q5,[r("label",W5,[He(r("input",{type:"checkbox","onUpdate:modelValue":P[6]||(P[6]=O=>u.value.isPinned=O),onChange:k},null,544),[[Oi,u.value.isPinned]]),P[16]||(P[16]=r("span",null,"Pin to top",-1))]),P[17]||(P[17]=r("span",{class:"help-text"},"Pinned notes always appear at the top",-1))])])],512),[[ks,l.value==="details"]]),He(r("div",K5,[Ae(vc,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":P[7]||(P[7]=O=>u.value.scopeConfigurations=O),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":d.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this note?",onUserChanged:k},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ks,l.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ae(gc,{show:s.value,title:"Validation error",message:i.value,onClose:P[8]||(P[8]=O=>s.value=!1)},null,8,["show","message"])],64))}},Q5=je(X5,[["__scopeId","data-v-aa4ca951"]]),e8={class:"incident-detail-header"},t8={class:"header-title-row"},n8={class:"modal-title"},o8={class:"header-badges"},s8=["disabled"],a8={key:0,class:"status-dropdown-menu"},i8=["onClick","disabled"],l8={key:0,class:"incident-detail-content"},r8={class:"accordion-section"},c8={class:"accordion-arrow"},u8={key:0,class:"accordion-content"},d8={class:"description-text"},h8={class:"accordion-section"},f8={class:"accordion-arrow"},p8={key:0,class:"accordion-content"},v8={class:"info-grid"},m8={class:"info-item"},g8={class:"info-value"},y8={class:"info-item"},k8={class:"info-value"},_8={key:0,class:"info-item"},b8={class:"info-value"},w8={key:1,class:"info-item"},C8={class:"info-value"},L8={key:2,class:"info-item"},S8={class:"info-value"},x8={key:0,class:"incident-map-container"},I8={class:"accordion-section"},$8={class:"accordion-preview"},T8={class:"accordion-arrow"},M8={key:0,class:"accordion-content"},A8={class:"reporter-info"},E8={class:"reporter-name"},P8={key:0,class:"accordion-section"},D8={class:"accordion-preview"},R8={class:"accordion-arrow"},O8={key:0,class:"accordion-content"},B8={class:"marshals-list"},N8={class:"marshal-name"},F8={key:0,class:"checkin-badge success"},U8={key:1,class:"checkin-badge not-checked-in"},z8={class:"accordion-section"},H8={key:0,class:"accordion-preview"},V8={class:"accordion-arrow"},G8={key:0,class:"accordion-content"},j8={key:0,class:"notes-timeline"},Z8={class:"note-header"},q8={class:"note-author"},W8={class:"note-time"},K8={key:0,class:"note-status-change"},J8={key:1,class:"note-text"},Y8={key:1,class:"no-notes"},X8={__name:"IncidentDetailModal",props:{show:{type:Boolean,required:!0},incident:{type:Object,default:null},canManage:{type:Boolean,default:!1},route:{type:Array,default:()=>[]},checkpoints:{type:Array,default:()=>[]}},emits:["close","status-change","open-add-note"],setup(e,{emit:t}){const o=e,a=t,s=$(!1),i=$(!1),l=$(null),u=$({description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1});qe(()=>o.show,N=>{N&&(u.value={description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1},i.value=!1)});const d=N=>{l.value&&!l.value.contains(N.target)&&(i.value=!1)};qe(i,N=>{N?document.addEventListener("click",d):document.removeEventListener("click",d)});const f=()=>{i.value=!i.value},p=N=>{o.incident?.status!==N&&(i.value=!1,E(N))},g=N=>{const D=u.value[N];Object.keys(u.value).forEach(j=>{u.value[j]=!1}),D||(u.value[N]=!0)},y=G(()=>o.incident?.latitude!=null&&o.incident?.longitude!=null),k=G(()=>y.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),_=G(()=>y.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),w=G(()=>{if(!o.incident)return"Incident Details";if(o.incident.title)return o.incident.title;const N=o.incident.description||"";return N.length<=50?N:N.substring(0,47)+"..."}),S=G(()=>[...o.incident?.context?.marshalsPresentAtCheckpoint||[]].sort((D,j)=>(D.name||"").localeCompare(j.name||"",void 0,{sensitivity:"base"}))),A=[{value:"open",label:"Open"},{value:"acknowledged",label:"Acknowledged"},{value:"in_progress",label:"In Progress"},{value:"resolved",label:"Resolved"},{value:"closed",label:"Closed"}],T=N=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[N]||N,x=N=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[N]||N,P=N=>{if(!N)return"";let D=N.name||"";if(N.description){const j=N.description,R=40,W=j.length>R?j.substring(0,R-3)+"...":j;D+=` - ${W}`}return D},O=N=>N?new Date(N).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",F=N=>{if(!N)return"";const D=new Date(N),R=new Date-D,W=Math.floor(R/6e4),ne=Math.floor(R/36e5),ue=Math.floor(R/864e5);return W<1?"just now":W<60?`${W}m ago`:ne<24?`${ne}h ago`:ue<7?`${ue}d ago`:D.toLocaleDateString()},E=async N=>{if(o.incident?.status!==N){s.value=!0;try{a("status-change",{incidentId:o.incident.incidentId,status:N})}finally{s.value=!1}}};return(N,D)=>(v(),Ze(Vt,{show:e.show,title:w.value,size:"large",onClose:D[7]||(D[7]=j=>N.$emit("close"))},{header:ze(()=>[r("div",e8,[r("div",t8,[r("span",{class:ce(["severity-indicator",e.incident?.severity])},null,2),r("h2",n8,C(w.value),1)]),r("div",o8,[r("span",{class:ce(["severity-badge",e.incident?.severity])},C(T(e.incident?.severity)),3),e.canManage?(v(),m("div",{key:0,class:"status-dropdown-container",ref_key:"statusDropdownRef",ref:l},[r("button",{type:"button",class:ce(["status-badge status-dropdown-trigger",e.incident?.status]),onClick:f,disabled:s.value},[Ye(C(x(e.incident?.status))+" ",1),D[8]||(D[8]=r("span",{class:"dropdown-arrow"},"",-1))],10,s8),i.value?(v(),m("div",a8,[(v(),m(Se,null,Ne(A,j=>r("button",{key:j.value,type:"button",class:ce(["status-dropdown-item",{active:e.incident?.status===j.value}]),onClick:R=>p(j.value),disabled:e.incident?.status===j.value},[r("span",{class:ce(["status-dot",j.value])},null,2),Ye(" "+C(j.label),1)],10,i8)),64))])):M("",!0)],512)):(v(),m("span",{key:1,class:ce(["status-badge",e.incident?.status])},C(x(e.incident?.status)),3))])])]),footer:ze(()=>[r("button",{class:"btn btn-secondary",onClick:D[6]||(D[6]=j=>N.$emit("close"))},"Close")]),default:ze(()=>[e.incident?(v(),m("div",l8,[r("div",r8,[r("button",{type:"button",class:ce(["accordion-header",{expanded:u.value.description}]),onClick:D[0]||(D[0]=j=>g("description"))},[D[9]||(D[9]=r("span",{class:"accordion-title"},"Description",-1)),r("span",c8,C(u.value.description?"":""),1)],2),u.value.description?(v(),m("div",u8,[r("p",d8,C(e.incident.description),1)])):M("",!0)]),r("div",h8,[r("button",{type:"button",class:ce(["accordion-header",{expanded:u.value.timeLocation}]),onClick:D[1]||(D[1]=j=>g("timeLocation"))},[D[10]||(D[10]=r("span",{class:"accordion-title"},"Time & location",-1)),r("span",f8,C(u.value.timeLocation?"":""),1)],2),u.value.timeLocation?(v(),m("div",p8,[r("div",v8,[r("div",m8,[D[11]||(D[11]=r("span",{class:"info-label"},"Incident time",-1)),r("span",g8,C(O(e.incident.incidentTime)),1)]),r("div",y8,[D[12]||(D[12]=r("span",{class:"info-label"},"Reported at",-1)),r("span",k8,C(O(e.incident.createdAt)),1)]),e.incident.context?.checkpoint?(v(),m("div",_8,[D[13]||(D[13]=r("span",{class:"info-label"},"Checkpoint",-1)),r("span",b8,C(P(e.incident.context.checkpoint)),1)])):M("",!0),e.incident.area?(v(),m("div",w8,[D[14]||(D[14]=r("span",{class:"info-label"},"Area",-1)),r("span",C8,C(e.incident.area.areaName),1)])):M("",!0),y.value?(v(),m("div",L8,[D[15]||(D[15]=r("span",{class:"info-label"},"GPS location",-1)),r("span",S8,C(e.incident.latitude.toFixed(6))+", "+C(e.incident.longitude.toFixed(6)),1)])):M("",!0)]),y.value?(v(),m("div",x8,[Ae(li,{locations:e.checkpoints,route:e.route,center:k.value,zoom:15,"user-location":_.value,height:"200px"},null,8,["locations","route","center","user-location"])])):M("",!0)])):M("",!0)]),r("div",I8,[r("button",{type:"button",class:ce(["accordion-header",{expanded:u.value.reporter}]),onClick:D[2]||(D[2]=j=>g("reporter"))},[D[16]||(D[16]=r("span",{class:"accordion-title"},"Reported by",-1)),r("span",$8,C(e.incident.reportedBy?.name||"Unknown"),1),r("span",T8,C(u.value.reporter?"":""),1)],2),u.value.reporter?(v(),m("div",M8,[r("div",A8,[r("span",E8,C(e.incident.reportedBy?.name||"Unknown"),1)])])):M("",!0)]),S.value.length?(v(),m("div",P8,[r("button",{type:"button",class:ce(["accordion-header",{expanded:u.value.marshals}]),onClick:D[3]||(D[3]=j=>g("marshals"))},[D[17]||(D[17]=r("span",{class:"accordion-title"},"Marshals at checkpoint",-1)),r("span",D8,C(S.value.length),1),r("span",R8,C(u.value.marshals?"":""),1)],2),u.value.marshals?(v(),m("div",O8,[r("div",B8,[(v(!0),m(Se,null,Ne(S.value,j=>(v(),m("div",{key:j.marshalId,class:ce(["marshal-item",{"checked-in":j.wasCheckedIn}])},[r("span",N8,C(j.name),1),j.wasCheckedIn?(v(),m("span",F8," Checked in "+C(F(j.checkInTime)),1)):(v(),m("span",U8," Not checked in "))],2))),128))])])):M("",!0)])):M("",!0),r("div",z8,[r("button",{type:"button",class:ce(["accordion-header",{expanded:u.value.notes}]),onClick:D[4]||(D[4]=j=>g("notes"))},[D[18]||(D[18]=r("span",{class:"accordion-title"},"Updates",-1)),e.incident.updates?.length?(v(),m("span",H8,C(e.incident.updates.length),1)):M("",!0),r("span",V8,C(u.value.notes?"":""),1)],2),u.value.notes?(v(),m("div",G8,[e.incident.updates?.length?(v(),m("div",j8,[(v(!0),m(Se,null,Ne(e.incident.updates,(j,R)=>(v(),m("div",{key:R,class:"note-item"},[r("div",Z8,[r("span",q8,C(j.authorName||"System"),1),r("span",W8,C(F(j.timestamp)),1)]),j.statusChange?(v(),m("div",K8,[D[19]||(D[19]=Ye(" Status changed to ",-1)),r("span",{class:ce(["status-badge",j.statusChange])},C(x(j.statusChange)),3)])):j.note?(v(),m("p",J8,C(j.note),1)):M("",!0)]))),128))])):(v(),m("div",Y8," No updates yet. ")),r("button",{type:"button",class:"btn btn-primary add-note-btn",onClick:D[5]||(D[5]=j=>N.$emit("open-add-note"))}," Add update ")])):M("",!0)])])):M("",!0)]),_:1},8,["show","title"]))}},Qv=je(X8,[["__scopeId","data-v-442b7089"]]),Q8={class:"form-group"},eD={class:"form-group"},tD={class:"form-row"},nD={class:"form-group form-group-half"},oD=["value"],sD={class:"form-group form-group-half"},aD={key:0,class:"form-group"},iD=["value"],lD={key:1,class:"form-group"},rD={class:"checkpoint-toggle"},cD={class:"checkbox-label"},uD={class:"checkpoint-name"},dD={key:0,class:"checkpoint-description"},hD={class:"form-group"},fD={class:"location-options"},pD={class:"location-buttons"},vD={key:0,class:"location-status"},mD={key:0,class:"location-getting"},gD={key:1,class:"location-display"},yD={key:0,class:"location-accuracy"},kD={key:2,class:"location-error"},_D={key:1,class:"map-picker-container"},bD={key:0,class:"map-picker-hint"},wD={key:2,class:"location-display"},CD={key:2,class:"error-message"},LD={class:"modal-actions"},SD=["disabled"],xD={__name:"ReportIncidentModal",props:{show:{type:Boolean,required:!0},eventId:{type:String,required:!0},checkpoint:{type:Object,default:null},initialLocation:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]}},emits:["close","submit"],setup(e,{emit:t}){const o=e,a=t,s=$({title:"",description:"",severity:"medium",incidentTime:""}),i=$(""),l=$(!0),u=$("none"),d=$(!1),f=$(null),p=$(null),g=$(null),y=$(!1),k=$(!1),_=$(null),w=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],S=()=>{const R=new Date,W=R.getFullYear(),ne=String(R.getMonth()+1).padStart(2,"0"),ue=String(R.getDate()).padStart(2,"0"),K=String(R.getHours()).padStart(2,"0"),Q=String(R.getMinutes()).padStart(2,"0");return`${W}-${ne}-${ue}T${K}:${Q}`},A=R=>R?new Date(R).toISOString():null,T=G(()=>o.checkpoints||[]),x=G(()=>{if(f.value?.latitude!=null)return{lat:f.value.latitude,lng:f.value.longitude};if(i.value){const R=T.value.find(W=>W.id===i.value);if(R?.latitude!=null)return{lat:R.latitude,lng:R.longitude}}if(o.initialLocation?.latitude!=null)return{lat:o.initialLocation.latitude,lng:o.initialLocation.longitude};if(o.checkpoint?.latitude!=null)return{lat:o.checkpoint.latitude,lng:o.checkpoint.longitude};if(T.value.length>0){const R=T.value[0];if(R.latitude!=null)return{lat:R.latitude,lng:R.longitude}}if(o.route?.length>0){const R=o.route[0];if(R?.lat!=null)return{lat:R.lat,lng:R.lng}}return{lat:-33.9,lng:151.2}}),P=G(()=>s.value.description.trim()!==""),O=G(()=>s.value.description.trim()!=="");qe(()=>o.show,R=>{R&&(s.value={title:"",description:"",severity:"medium",incidentTime:S()},i.value="",l.value=!0,k.value=!1,_.value=null,g.value=null,f.value=null,p.value=null,o.initialLocation&&o.initialLocation.latitude!=null?(f.value={latitude:o.initialLocation.latitude,longitude:o.initialLocation.longitude},p.value=o.initialLocation.accuracy,u.value="gps",d.value=!1):(u.value="none",d.value=!1),o.checkpoint&&(i.value=o.checkpoint.locationId||o.checkpoint.id||""))});const F=R=>{g.value=null,R==="map"?u.value==="map"?d.value=!d.value:(u.value="map",d.value=!0,p.value=null):R==="gps"?(u.value="gps",d.value=!1,N()):(u.value="none",d.value=!1,f.value=null,p.value=null)},E=R=>{f.value={latitude:R.lat,longitude:R.lng},p.value=null,d.value=!1},N=()=>{if(o.initialLocation&&o.initialLocation.latitude!=null){f.value={latitude:o.initialLocation.latitude,longitude:o.initialLocation.longitude},p.value=o.initialLocation.accuracy;return}if(!navigator.geolocation){g.value="GPS is not available on this device.";return}y.value=!0,navigator.geolocation.getCurrentPosition(R=>{f.value={latitude:R.coords.latitude,longitude:R.coords.longitude},p.value=R.coords.accuracy,y.value=!1},R=>{g.value="Unable to get your location.",y.value=!1},{enableHighAccuracy:!0,timeout:1e4})},D=async()=>{if(!(!O.value||k.value)){k.value=!0,_.value=null;try{const R=(u.value==="gps"||u.value==="map")&&f.value;let W=null,ne=!1;T.value.length>0?i.value?W=i.value:ne=!0:o.checkpoint&&(l.value?W=o.checkpoint.locationId||o.checkpoint.id||null:ne=!0);const ue={title:s.value.title.trim()||null,description:s.value.description.trim(),severity:s.value.severity,incidentTime:A(s.value.incidentTime),latitude:R?f.value.latitude:null,longitude:R?f.value.longitude:null,checkpointId:W,skipCheckpointAutoAssign:ne};a("submit",ue)}catch(R){_.value=R.message||"Failed to report incident. Please try again.",k.value=!1}}},j=()=>{a("close")};return(R,W)=>(v(),Ze(Vt,{show:e.show,title:"Report Incident",size:"medium","confirm-on-close":!0,"is-dirty":P.value,onClose:j},{footer:ze(()=>[r("div",LD,[r("button",{type:"button",class:"btn btn-secondary",onClick:j}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:D,disabled:!O.value||k.value},C(k.value?"Reporting...":"Report Incident"),9,SD)])]),default:ze(()=>[r("form",{onSubmit:rt(D,["prevent"]),class:"incident-form"},[r("div",Q8,[W[10]||(W[10]=r("label",{for:"title",class:"form-label"},"Title",-1)),He(r("input",{id:"title","onUpdate:modelValue":W[0]||(W[0]=ne=>s.value.title=ne),type:"text",class:"form-input",placeholder:"Brief summary (optional)"},null,512),[[st,s.value.title]])]),r("div",eD,[W[11]||(W[11]=r("label",{for:"description",class:"form-label"},[Ye("Description "),r("span",{class:"required"},"*")],-1)),He(r("textarea",{id:"description","onUpdate:modelValue":W[1]||(W[1]=ne=>s.value.description=ne),class:"form-input form-textarea",placeholder:"Describe what happened...",rows:"3",required:""},null,512),[[st,s.value.description]])]),r("div",tD,[r("div",nD,[W[12]||(W[12]=r("label",{for:"severity",class:"form-label"},"Severity",-1)),He(r("select",{id:"severity","onUpdate:modelValue":W[2]||(W[2]=ne=>s.value.severity=ne),class:"form-input form-select"},[(v(),m(Se,null,Ne(w,ne=>r("option",{key:ne.value,value:ne.value},C(ne.label),9,oD)),64))],512),[[Fn,s.value.severity]])]),r("div",sD,[W[13]||(W[13]=r("label",{for:"incidentTime",class:"form-label"},"When",-1)),He(r("input",{id:"incidentTime","onUpdate:modelValue":W[3]||(W[3]=ne=>s.value.incidentTime=ne),type:"datetime-local",class:"form-input"},null,512),[[st,s.value.incidentTime]])])]),T.value.length>0?(v(),m("div",aD,[W[15]||(W[15]=r("label",{for:"checkpoint",class:"form-label"},"Checkpoint",-1)),He(r("select",{id:"checkpoint","onUpdate:modelValue":W[4]||(W[4]=ne=>i.value=ne),class:"form-input form-select"},[W[14]||(W[14]=r("option",{value:""},"-- None / Unknown --",-1)),(v(!0),m(Se,null,Ne(T.value,ne=>(v(),m("option",{key:ne.id,value:ne.id},C(ne.name)+C(ne.description?` - ${ne.description}`:""),9,iD))),128))],512),[[Fn,i.value]])])):e.checkpoint?(v(),m("div",lD,[W[16]||(W[16]=r("label",{class:"form-label"},"Checkpoint",-1)),r("div",rD,[r("label",cD,[He(r("input",{type:"checkbox","onUpdate:modelValue":W[5]||(W[5]=ne=>l.value=ne)},null,512),[[Oi,l.value]]),r("span",uD,C(e.checkpoint.name),1),e.checkpoint.description?(v(),m("span",dD," - "+C(e.checkpoint.description),1)):M("",!0)])])])):M("",!0),r("div",hD,[W[17]||(W[17]=r("label",{class:"form-label"},"Location (optional)",-1)),r("div",fD,[r("div",pD,[r("button",{type:"button",class:ce(["location-btn",{active:u.value==="gps"}]),onClick:W[6]||(W[6]=ne=>F("gps"))}," GPS ",2),r("button",{type:"button",class:ce(["location-btn",{active:u.value==="map"}]),onClick:W[7]||(W[7]=ne=>F("map"))}," Pick on map ",2),r("button",{type:"button",class:ce(["location-btn",{active:u.value==="none"}]),onClick:W[8]||(W[8]=ne=>F("none"))}," None ",2)]),u.value==="gps"?(v(),m("div",vD,[y.value?(v(),m("div",mD," Getting location... ")):f.value&&f.value.latitude!=null?(v(),m("div",gD,[r("span",null,C(f.value.latitude.toFixed(5))+", "+C(f.value.longitude.toFixed(5)),1),p.value?(v(),m("span",yD,"("+C(Math.round(p.value))+"m)",1)):M("",!0)])):g.value?(v(),m("div",kD,C(g.value),1)):M("",!0)])):M("",!0),u.value==="map"?(v(),m("div",_D,[d.value?(v(),m("div",bD,"Tap to select location")):M("",!0),d.value?(v(),Ze(li,{key:1,locations:T.value,route:e.route,center:x.value,zoom:14,mode:"select-point","user-location":e.initialLocation,"highlight-location-id":i.value,height:"150px",onPointSelected:E},null,8,["locations","route","center","user-location","highlight-location-id"])):M("",!0),f.value&&f.value.latitude!=null?(v(),m("div",wD,[r("span",null,C(f.value.latitude.toFixed(5))+", "+C(f.value.longitude.toFixed(5)),1),d.value?M("",!0):(v(),m("button",{key:0,type:"button",class:"location-edit-btn",onClick:W[9]||(W[9]=ne=>d.value=!0)},"Edit"))])):M("",!0)])):M("",!0)])]),_.value?(v(),m("div",CD,C(_.value),1)):M("",!0)],32)]),_:1},8,["show","is-dirty"]))}},em=je(xD,[["__scopeId","data-v-0896cfc4"]]),ID={class:"tab-content"},$D={key:0,class:"form-group"},TD={for:"marshalId"},MD=["value"],AD={class:"help-text"},ED={key:1,class:"form-group"},PD={class:"linked-marshal-info"},DD={class:"linked-marshal-name"},RD={class:"linked-marshal-hint"},OD={class:"form-group"},BD=["disabled"],ND={class:"form-group"},FD={class:"role-input-group"},UD={key:0,label:"Built-in Roles"},zD=["value"],HD={key:1,label:"Custom Roles"},VD=["value"],GD={class:"form-row"},jD={class:"form-group"},ZD={class:"form-group"},qD={class:"form-group"},WD={class:"tab-content"},KD={class:"custom-footer"},JD={class:"footer-left"},YD=["disabled"],XD={__name:"EditContactModal",props:{show:{type:Boolean,default:!1},contact:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},isDirty:{type:Boolean,default:!1},preselectedArea:{type:Object,default:null},prefilledName:{type:String,default:""},prefilledMarshalId:{type:String,default:null},createFromAreaContext:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{terms:o}=ht(),a=e,s=t,i=$(!1),l=$(""),u=$("details"),d=$(!1),f=$({role:"",name:"",phone:"",email:"",notes:"",marshalId:null,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}),p=G(()=>!!a.contact),g=G(()=>a.createFromAreaContext?[{value:"details",label:"Details"}]:[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}]),y=G(()=>!!f.value.marshalId),k=G(()=>!p.value&&!!a.prefilledMarshalId),_=G(()=>p.value&&!!a.contact?.marshalId),w=G(()=>a.contact?.marshalId?a.marshals.find(j=>j.id===a.contact.marshalId)?.name||"Unknown":""),S=G(()=>[...a.marshals].sort((D,j)=>Vs(D.name,j.name)));qe(()=>a.show,D=>{if(D){if(u.value=a.initialTab,a.contact){const j=[...a.availableRoles.builtInRoles||[],...a.availableRoles.customRoles||[]];d.value=a.contact.role&&!j.includes(a.contact.role),f.value={role:a.contact.role||"",name:a.contact.name||"",phone:a.contact.phone||"",email:a.contact.email||"",notes:a.contact.notes||"",marshalId:a.contact.marshalId||null,scopeConfigurations:a.contact.scopeConfigurations?JSON.parse(JSON.stringify(a.contact.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}}else{d.value=!1;let j;a.createFromAreaContext?j=[]:a.preselectedArea?j=[{scope:"EveryoneInAreas",itemType:"Area",ids:[a.preselectedArea.id]}]:j=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}];let R={name:a.prefilledName||"",phone:"",email:""};if(a.prefilledMarshalId){const W=a.marshals.find(ne=>ne.id===a.prefilledMarshalId);W&&(R={name:W.name||"",phone:W.phoneNumber||"",email:W.email||""})}f.value={role:"",name:R.name,phone:R.phone,email:R.email,notes:"",marshalId:a.prefilledMarshalId||null,scopeConfigurations:j}}s("update:isDirty",!1)}});const A=D=>D?D==="AreaLead"?`${o.value.area} Lead`:D.replace(/([A-Z])/g," $1").replace(/^./,j=>j.toUpperCase()).trim():"",T=()=>{s("update:isDirty",!0)},x=()=>{if(f.value.marshalId){const D=a.marshals.find(j=>j.id===f.value.marshalId);D&&(f.value.name=D.name,!f.value.phone&&D.phoneNumber&&(f.value.phone=D.phoneNumber),!f.value.email&&D.email&&(f.value.email=D.email))}T()},P=()=>{s("close")},O=()=>{if(!f.value.role||!f.value.role.trim()){F("Please select or enter a role");return}if(!f.value.name||!f.value.name.trim()){F("Please enter a contact name");return}u.value="visibility"},F=D=>{l.value=D,i.value=!0},E=()=>{if(!f.value.role||!f.value.role.trim()){F("Please select or enter a role");return}if(!f.value.name||!f.value.name.trim()){F("Please enter a contact name");return}if(!a.createFromAreaContext){if(!f.value.scopeConfigurations||f.value.scopeConfigurations.length===0){F("Please select at least one visibility scope");return}if(!f.value.scopeConfigurations.some(R=>!(R.itemType!==null&&(!R.ids||R.ids.length===0)))){F("Please configure at least one scope with valid selections");return}}const D={role:f.value.role.trim(),name:f.value.name.trim(),phone:f.value.phone?.trim()||null,email:f.value.email?.trim()||null,notes:f.value.notes?.trim()||null,marshalId:f.value.marshalId||null,scopeConfigurations:f.value.scopeConfigurations};s("save",D)},N=()=>{s("delete",a.contact.contactId)};return(D,j)=>(v(),m(Se,null,[Ae(Vt,{show:e.show,title:p.value?"Edit contact":"Create contact",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:P},{"tab-header":ze(()=>[Ae(Zi,{modelValue:u.value,"onUpdate:modelValue":j[0]||(j[0]=R=>u.value=R),tabs:g.value},null,8,["modelValue","tabs"])]),footer:ze(()=>[r("div",KD,[r("div",JD,[p.value?(v(),m("button",{key:0,type:"button",onClick:N,class:"btn btn-danger"}," Delete ")):M("",!0),!p.value&&u.value==="details"?(v(),m("button",{key:1,type:"button",onClick:O,class:"btn btn-secondary mobile-only"}," Visibility... ")):M("",!0)]),r("button",{type:"button",onClick:E,class:"btn btn-success",disabled:p.value&&!e.isDirty}," Save ",8,YD)])]),default:ze(()=>[r("form",{onSubmit:rt(E,["prevent"]),class:"contact-form"},[He(r("div",ID,[!k.value&&!_.value?(v(),m("div",$D,[r("label",TD,"Link to "+C(B(o).person.toLowerCase())+":",1),He(r("select",{id:"marshalId","onUpdate:modelValue":j[1]||(j[1]=R=>f.value.marshalId=R),onChange:x},[j[11]||(j[11]=r("option",{value:null},"-- Not linked --",-1)),(v(!0),m(Se,null,Ne(S.value,R=>(v(),m("option",{key:R.id,value:R.id},C(R.name),9,MD))),128))],544),[[Fn,f.value.marshalId]]),r("span",AD,"Optionally link to an existing "+C(B(o).person.toLowerCase())+" in the system",1)])):M("",!0),_.value?(v(),m("div",ED,[r("label",null,"Linked "+C(B(o).person.toLowerCase())+":",1),r("div",PD,[r("span",DD,C(w.value),1),r("span",RD,"Contact details are synced with this "+C(B(o).person.toLowerCase()),1)])])):M("",!0),r("div",OD,[j[12]||(j[12]=r("label",{for:"name"},"Name: *",-1)),He(r("input",{id:"name","onUpdate:modelValue":j[2]||(j[2]=R=>f.value.name=R),type:"text",onInput:T,disabled:y.value,class:ce({"input-disabled":y.value}),placeholder:"Contact name..."},null,42,BD),[[st,f.value.name]])]),r("div",ND,[j[14]||(j[14]=r("label",{for:"role"},"Role: *",-1)),r("div",FD,[d.value?He((v(),m("input",{key:1,id:"customRole","onUpdate:modelValue":j[4]||(j[4]=R=>f.value.role=R),type:"text",onInput:T,placeholder:"Enter custom role name..."},null,544)),[[st,f.value.role]]):He((v(),m("select",{key:0,id:"role","onUpdate:modelValue":j[3]||(j[3]=R=>f.value.role=R),onChange:T},[j[13]||(j[13]=r("option",{value:"",disabled:""},"Select a role...",-1)),e.availableRoles.builtInRoles?.length>0?(v(),m("optgroup",UD,[(v(!0),m(Se,null,Ne(e.availableRoles.builtInRoles,R=>(v(),m("option",{key:R,value:R},C(A(R)),9,zD))),128))])):M("",!0),e.availableRoles.customRoles?.length>0?(v(),m("optgroup",HD,[(v(!0),m(Se,null,Ne(e.availableRoles.customRoles,R=>(v(),m("option",{key:R,value:R},C(A(R)),9,VD))),128))])):M("",!0)],544)),[[Fn,f.value.role]]),r("button",{type:"button",class:"toggle-custom-btn",onClick:j[5]||(j[5]=R=>d.value=!d.value)},C(d.value?"Use existing":"Custom"),1)])]),r("div",GD,[r("div",jD,[j[15]||(j[15]=r("label",{for:"phone"},"Phone:",-1)),He(r("input",{id:"phone","onUpdate:modelValue":j[6]||(j[6]=R=>f.value.phone=R),type:"tel",onInput:T,placeholder:"Phone number..."},null,544),[[st,f.value.phone]])]),r("div",ZD,[j[16]||(j[16]=r("label",{for:"email"},"Email:",-1)),He(r("input",{id:"email","onUpdate:modelValue":j[7]||(j[7]=R=>f.value.email=R),type:"email",onInput:T,placeholder:"Email address..."},null,544),[[st,f.value.email]])])]),r("div",qD,[j[17]||(j[17]=r("label",{for:"notes"},"Notes / Instructions:",-1)),He(r("textarea",{id:"notes","onUpdate:modelValue":j[8]||(j[8]=R=>f.value.notes=R),onInput:T,rows:"3",placeholder:"Additional notes or instructions for when to contact..."},null,544),[[st,f.value.notes]])])],512),[[ks,u.value==="details"]]),He(r("div",WD,[Ae(vc,{modelValue:f.value.scopeConfigurations,"onUpdate:modelValue":j[9]||(j[9]=R=>f.value.scopeConfigurations=R),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":p.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this contact?",onUserChanged:T},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ks,u.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ae(gc,{show:i.value,title:"Validation error",message:l.value,onClose:j[10]||(j[10]=R=>i.value=!1)},null,8,["show","message"])],64))}},QD=je(XD,[["__scopeId","data-v-c14f87b7"]]),eR={key:0,class:"fullscreen-map-overlay"},tR={class:"fullscreen-map-header"},nR={class:"context-info"},oR={key:0},sR={class:"action-buttons"},aR=["disabled"],iR={class:"fullscreen-map-container"},lR={key:0,class:"drawing-controls"},rR={class:"point-count"},cR={class:"undo-redo-buttons"},uR=["disabled"],dR=["disabled"],hR=Object.assign({inheritAttrs:!1},{__name:"FullscreenMapOverlay",props:{show:{type:Boolean,required:!0},mode:{type:String,validator:e=>["place-checkpoint","move-checkpoint","draw-area","add-multiple","view"].includes(e)},contextTitle:{type:String,default:""},contextDescription:{type:String,default:""},canComplete:{type:Boolean,default:!1},drawingMode:{type:Boolean,default:!1}},emits:["done","cancel","map-click","polygon-complete","polygon-drawing","location-click","area-click"],setup(e,{emit:t}){const o=e,a=t,s=$(null),i=$(0),l=$(!1),u=$(!1),d=()=>{a("done")},f=()=>{a("cancel")},p=w=>{i.value=w?.length||0,g(),a("polygon-drawing",w)},g=()=>{s.value&&(l.value=s.value.canUndo(),u.value=s.value.canRedo())},y=()=>{s.value&&(s.value.undoPolygonPoint(),g())},k=()=>{s.value&&(s.value.redoPolygonPoint(),g())};qe(()=>o.show,w=>{w||(i.value=0,l.value=!1,u.value=!1)});const _=w=>{w.key==="Escape"&&o.show&&f(),o.show&&o.drawingMode&&((w.ctrlKey||w.metaKey)&&w.key==="z"&&!w.shiftKey?(w.preventDefault(),y()):(w.ctrlKey||w.metaKey)&&(w.key==="y"||w.key==="z"&&w.shiftKey)&&(w.preventDefault(),k()))};return on(()=>{document.addEventListener("keydown",_)}),$n(()=>{document.removeEventListener("keydown",_)}),(w,S)=>(v(),Ze($l,{to:"body"},[e.show?(v(),m("div",eR,[r("div",tR,[r("div",nR,[r("h3",null,C(e.contextTitle),1),e.contextDescription?(v(),m("p",oR,C(e.contextDescription),1)):M("",!0)]),r("div",sR,[e.mode==="view"?(v(),m("button",{key:0,onClick:f,class:"btn btn-done"}," Close ")):(v(),m(Se,{key:1},[r("button",{onClick:f,class:"btn btn-cancel"}," Cancel "),r("button",{onClick:d,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,aR)],64))])]),r("div",iR,[Ae(Tu,Dp({ref_key:"mapViewRef",ref:s,"drawing-mode":e.drawingMode},w.$attrs,{onMapClick:S[0]||(S[0]=A=>w.$emit("map-click",A)),onPolygonComplete:S[1]||(S[1]=A=>w.$emit("polygon-complete",A)),onPolygonDrawing:p,onLocationClick:S[2]||(S[2]=A=>w.$emit("location-click",A)),onAreaClick:S[3]||(S[3]=A=>w.$emit("area-click",A))}),null,16,["drawing-mode"]),e.drawingMode&&i.value>0?(v(),m("div",lR,[r("div",rR,C(i.value)+" point"+C(i.value!==1?"s":""),1),r("div",cR,[r("button",{onClick:y,class:"btn-drawing undo-btn",disabled:!l.value,title:"Undo last point"},"  Undo ",8,uR),r("button",{onClick:k,class:"btn-drawing redo-btn",disabled:!u.value,title:"Redo point"}," Redo  ",8,dR)])])):M("",!0)])])):M("",!0)]))}}),fR=je(hR,[["__scopeId","data-v-9ce62b55"]]),pR={class:"form-group"},vR={class:"form-group"},mR={class:"form-group"},gR={key:0,class:"form-error"},yR={class:"form-row"},kR={class:"form-group",style:{flex:"1"}},_R={class:"form-group",style:{flex:"1"}},bR={class:"form-group",style:{flex:"0 0 auto"}},wR={class:"form-group"},CR={__name:"AddLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:()=>({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""})},isDirty:{type:Boolean,default:!1}},emits:["close","save","set-on-map","update:isDirty","update:location"],setup(e,{emit:t}){const{termsLower:o}=ht(),a=e,s=t,i=$({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""});qe(()=>a.location,f=>{f&&(i.value={...f})},{immediate:!0,deep:!0});const l=()=>{s("update:isDirty",!0),s("update:location",{...i.value})},u=()=>{if(!Ur(i.value.what3Words)&&i.value.what3Words){alert("Invalid What3Words format.");return}s("save",i.value)},d=()=>{s("close")};return(f,p)=>(v(),Ze(Vt,{show:e.show,title:`Add ${B(o).checkpoint}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:ze(()=>[r("button",{type:"button",onClick:d,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:u,class:"btn btn-primary"}," Add "+C(B(o).checkpoint),1)]),default:ze(()=>[r("form",{onSubmit:rt(u,["prevent"])},[r("div",pR,[p[7]||(p[7]=r("label",null,"Name",-1)),He(r("input",{"onUpdate:modelValue":p[0]||(p[0]=g=>i.value.name=g),type:"text",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.name]])]),r("div",vR,[p[8]||(p[8]=r("label",null,"Description",-1)),He(r("input",{"onUpdate:modelValue":p[1]||(p[1]=g=>i.value.description=g),type:"text",class:"form-input",onInput:l},null,544),[[st,i.value.description]])]),r("div",mR,[p[9]||(p[9]=r("label",null,"What3Words (optional)",-1)),He(r("input",{"onUpdate:modelValue":p[2]||(p[2]=g=>i.value.what3Words=g),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap",onInput:l},null,544),[[st,i.value.what3Words]]),i.value.what3Words&&!B(Ur)(i.value.what3Words)?(v(),m("small",gR," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):M("",!0)]),r("div",yR,[r("div",kR,[p[10]||(p[10]=r("label",null,"Longitude",-1)),He(r("input",{"onUpdate:modelValue":p[3]||(p[3]=g=>i.value.longitude=g),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.longitude,void 0,{number:!0}]])]),r("div",_R,[p[11]||(p[11]=r("label",null,"Latitude",-1)),He(r("input",{"onUpdate:modelValue":p[4]||(p[4]=g=>i.value.latitude=g),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.latitude,void 0,{number:!0}]])]),r("div",bR,[p[12]||(p[12]=r("label",null,"",-1)),r("button",{type:"button",class:"icon-btn",title:"Set location on map",onClick:p[5]||(p[5]=g=>f.$emit("set-on-map"))},"  ")])]),r("div",wR,[r("label",null,"Required "+C(B(o).people),1),He(r("input",{"onUpdate:modelValue":p[6]||(p[6]=g=>i.value.requiredMarshals=g),type:"number",min:"1",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.requiredMarshals,void 0,{number:!0}]])])],32)]),_:1},8,["show","title","is-dirty"]))}},LR=je(CR,[["__scopeId","data-v-fb51fed0"]]),SR=["aria-expanded","title"],xR=["innerHTML"],IR={key:0,class:"dropdown-menu"},$R=["onClick"],TR=["innerHTML"],MR={__name:"ThemeToggle",setup(e){const{theme:t,isDark:o,setTheme:a}=Hv(),s=$(!1),i=$(null),l={light:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
  </svg>`,dark:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
  </svg>`,system:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
    <line x1="8" y1="21" x2="16" y2="21"></line>
    <line x1="12" y1="17" x2="12" y2="21"></line>
  </svg>`},u=[{value:"system",label:"System",icon:l.system},{value:"light",label:"Light",icon:l.light},{value:"dark",label:"Dark",icon:l.dark}],d=G(()=>o.value?l.dark:l.light),f=()=>{s.value=!s.value},p=y=>{a(y),s.value=!1},g=y=>{i.value&&!i.value.contains(y.target)&&(s.value=!1)};return on(()=>{document.addEventListener("click",g)}),$n(()=>{document.removeEventListener("click",g)}),(y,k)=>(v(),m("div",{class:"theme-dropdown",ref_key:"dropdownRef",ref:i},[r("button",{class:"theme-toggle-btn",onClick:f,type:"button","aria-expanded":s.value,title:B(o)?"Dark mode":"Light mode"},[r("span",{class:"theme-icon",innerHTML:d.value},null,8,xR)],8,SR),s.value?(v(),m("div",IR,[(v(),m(Se,null,Ne(u,_=>r("button",{key:_.value,class:ce(["dropdown-item",{active:B(t)===_.value}]),onClick:w=>p(_.value)},[r("span",{class:"option-icon",innerHTML:_.icon},null,8,TR),r("span",null,C(_.label),1)],10,$R)),64))])):M("",!0)],512))}},AR=je(MR,[["__scopeId","data-v-969124a4"]]),ER={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"app-logo"},PR=["id"],DR=["filter"],RR={__name:"AppLogo",props:{size:{type:[Number,String],default:48},animate:{type:Boolean,default:!1}},setup(e){_y(o=>({v1c2199cd:typeof e.size=="number"?e.size+"px":e.size}));const t=G(()=>`discShadow-${Math.random().toString(36).substr(2,9)}`);return(o,a)=>(v(),m("svg",ER,[r("defs",null,[r("filter",{id:t.value,x:"-20%",y:"-20%",width:"140%",height:"140%"},[...a[0]||(a[0]=[r("feDropShadow",{dx:"0",dy:"6",stdDeviation:"8","flood-color":"#000","flood-opacity":"0.25"},null,-1)])],8,PR)]),r("ellipse",{cx:"256",cy:"400",rx:"220",ry:"70",fill:"#667eea",filter:`url(#${t.value})`},null,8,DR),a[2]||(a[2]=r("ellipse",{cx:"256",cy:"394",rx:"185",ry:"55",fill:"none",stroke:"rgba(255,255,255,0.3)","stroke-width":"4"},null,-1)),r("g",{class:ce({"marshal-figure":e.animate})},[...a[1]||(a[1]=[r("circle",{cx:"256",cy:"160",r:"55",fill:"currentColor"},null,-1),r("path",{d:"M365 380 v-30 a55 55 0 0 0-55-55 H202 a55 55 0 0 0-55 55 v30",fill:"currentColor"},null,-1)])],2)]))}},OR=je(RR,[["__scopeId","data-v-3e647831"]]),BR={class:"header"},NR={class:"header-left"},FR={key:0},UR={class:"event-date"},zR={class:"header-actions"},HR={class:"container"},VR={class:"tabs-nav"},GR={class:"tab-content-wrapper"},jR={class:"add-note-form"},ZR={class:"modal-footer-actions"},qR=["disabled"],WR=6e4,KR={__name:"AdminEventManage",setup(e){const t=cc(),o=Hi(),a=Nv(),s=G(()=>t.params.eventId),{activeTab:i,switchTab:l}=Fv("details",["details","course","areas","checkpoints","marshals","notes","checklists","contacts","settings"]),{showConfirmModal:u,confirmModalTitle:d,confirmModalMessage:f,confirmModalIsDanger:p,confirmModalConfirmText:g,showConfirm:y,handleConfirmModalConfirm:k,handleConfirmModalCancel:_}=$b(),{tabLabels:w,terms:S,termsLower:A}=ht(),T=Tb(),x=Ab(s),P=Mb(s),{colorScheme:O}=Hv(),F=G(()=>[{value:"details",label:"Event details",icon:"details"},{value:"course",label:w.value.course,icon:"course"},{value:"areas",label:w.value.areas,icon:"area"},{value:"checkpoints",label:w.value.checkpoints,icon:"checkpoint"},{value:"marshals",label:w.value.marshals,icon:"marshal"},{value:"notes",label:"Notes",icon:"notes"},{value:"incidents",label:"Incidents",icon:"incidents"},{value:"checklists",label:w.value.checklists,icon:"checklist"},{value:"contacts",label:"Contacts",icon:"contacts"},{value:"settings",label:"Settings",icon:"settings"}]),E=$(null),N=$([]),D=$([]),j=$({marshals:0,areas:0,checkpoints:0,checklists:0,notes:0,incidents:0,contacts:0}),R=$(null),W=$(!1),ne=$(!1),ue=$(null),K=$(null),Q=$(!1),he=$(!1),U=$(null),ee=$(""),de=P.eventAdmins,re=P.showAddAdmin,De=x.showUploadRoute,et=x.uploading,Je=x.uploadError,Fe=x.showImportLocations,Ke=x.showImportMarshals,_e=x.importing,Ve=x.importingMarshals,pe=x.importError,Le=x.importResult,Pe=x.importMarshalsResult,q=$(!1),X=$(!1),fe=$({id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),we=$(!1),Y=$(!1),V=$({marshalName:"",locations:[],marshal:null}),J=$(null),Me=$([]),Re=$(!1),Ce=$(null),be=$(null),me=$(null),Z=$({}),oe=$({id:"",name:"",email:"",phoneNumber:"",notes:""}),le=$(!1),Te=$([]),Oe=$([]),Be=$([]),Xe=$([]),mt=$(!1),_t=$(""),bt=$(""),Mt=$({name:"",description:"",eventDate:"",timeZoneId:"UTC",peopleTerm:"Marshals",defaultCheckpointStyleBackgroundShape:"",defaultCheckpointStyleBackgroundColor:"",defaultCheckpointStyleBorderColor:"",defaultCheckpointStyleIconColor:"",defaultCheckpointStyleSize:"",defaultCheckpointStyleMapRotation:"",checkpointTerm:"Checkpoints",areaTerm:"Areas",checklistTerm:"Checklists",courseTerm:"Course",defaultCheckpointStyleType:"default",defaultCheckpointStyleColor:""}),Ct=$(!1),Bt=$(!1),Nt=$(""),zn=$(""),Xn=$(0),pn=$({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Gt=$([]),gt=$(null),Qn=$(!1),Hn=$("details"),eo=$(null),vn=$(null),jt=$(null),_s=T.isAddingMultipleCheckpoints,to=T.multiCheckpointCounter,Co=T.isFullscreenMapActive,ae=T.fullscreenMode,ie=T.fullscreenContext,ve=T.tempLocationCoords,ot=T.tempCheckpoints,Ge=T.savedMapCenter,St=T.savedMapZoom,qt=T.isDrawingAreaBoundary,Yt=$(null),Oo=$([]),uo=$(null),Bo=$(!1),Vn=$("details"),xa=$(null),No=$([]),Lo=$(null),Zs=$(!1),qs=$("details"),mn=$([]),Fo=$(!1),sn=$(null),So=$(!1),ho=$(!1),bs=$(!1),xo=$(""),ws=$(!1),Io=$([]),Uo=$({builtInRoles:[],customRoles:[]}),gn=$(null),$o=$(!1),Gn=$("details"),pt=$(null),xt=$(""),To=$(null),fo=$(null),zo=G(()=>fo.value?.marshalId!=null),Ia=()=>{o.push(`/event/${t.params.eventId}`)},dt=G(()=>`${window.location.origin}/#/event/${t.params.eventId}`),Ft=G(()=>{const H=[];return D.value.forEach(se=>{se.assignments&&H.push(...se.assignments)}),H}),$a=G(()=>{if(!Ce.value)return D.value;const H=Ce.value.assignedLocationIds||[],se=Be.value.map(ye=>ye.locationId),ge=Xe.value;return D.value.filter(ye=>!H.includes(ye.id)&&!se.includes(ye.id)||ge.includes(ye.id))}),Ho=G(()=>{let H=Me.value;if(R.value){const se=R.value.assignments.map(ye=>ye.marshalName),ge=Te.value.map(ye=>ye.marshalName);H=Me.value.filter(ye=>!se.includes(ye.name)&&!ge.includes(ye.name))}return H.slice().sort((se,ge)=>se.name.localeCompare(ge.name))}),yn=G(()=>ae.value==="draw-area"&&gt.value?.polygon?.length>0||T.canCompleteFullscreen.value),ri=G(()=>ae.value==="move-checkpoint"&&R.value?.id?R.value.id:null),Ws=G(()=>{const H=[...D.value];return ae.value==="place-checkpoint"&&ve.value&&H.push({id:"temp-single",name:pn.value.name||"New Checkpoint",latitude:ve.value.lat,longitude:ve.value.lng,requiredMarshals:pn.value.requiredMarshals||1,assignments:[],isTemporary:!0}),ae.value==="move-checkpoint"&&ve.value&&R.value&&H.push({id:"temp-move",name:R.value.name+" (new position)",latitude:ve.value.lat,longitude:ve.value.lng,requiredMarshals:R.value.requiredMarshals,assignments:[],isTemporary:!0}),ae.value==="add-multiple"&&H.push(...ot.value),H}),po=G(()=>{let H=[...Gt.value];return ae.value==="draw-area"&&gt.value?.id&&(H=H.filter(se=>se.id!==gt.value.id)),ae.value==="draw-area"&&gt.value?.polygon?.length>0&&H.push({...gt.value,id:gt.value.id||"temp-area"}),H}),Zt=G(()=>{if(!Ce.value||!mn.value.length)return[];const H=Ce.value.id,se=Ce.value.assignedLocationIds||[];return mn.value.filter(ge=>{if(ge.reportedBy?.marshalId===H)return!0;const ye=ge.context?.checkpoint?.checkpointId;return!!(ye&&se.includes(ye))}).sort((ge,ye)=>new Date(ye.incidentTime||ye.createdAt)-new Date(ge.incidentTime||ge.createdAt))}),Vo=G(()=>{if(!R.value||!mn.value.length)return[];const H=R.value.id;return mn.value.filter(se=>se.context?.checkpoint?.checkpointId===H).sort((se,ge)=>new Date(ge.incidentTime||ge.createdAt)-new Date(se.incidentTime||se.createdAt))}),kn=G(()=>{if(!gt.value||!mn.value.length)return[];const H=gt.value.id,se=D.value.filter(ge=>ge.areaIds&&ge.areaIds.includes(H)).map(ge=>ge.id);return mn.value.filter(ge=>{const ye=ge.context?.checkpoint?.checkpointId;return ye&&se.includes(ye)}).sort((ge,ye)=>new Date(ye.incidentTime||ye.createdAt)-new Date(ge.incidentTime||ge.createdAt))}),Tn=H=>{sn.value=H,So.value=!0},Ta=H=>{sn.value=H,So.value=!0},_n=H=>{sn.value=H,So.value=!0},Ma=()=>{o.push("/sessions")},Ut=(H=!0)=>{le.value=H},Cs=()=>{Ct.value=!0},Ks=async H=>{try{H&&(Mt.value={...H});const se=Ol(E.value.eventDate),ge=Mt.value.eventDate;if(se!==ge){const ye=N.value.filter(tt=>tt.startTime||tt.endTime);if(ye.length>0){Nt.value=se,zn.value=ge,Xn.value=ye.length,Bt.value=!0;return}}await Js(!1,null)}catch(se){console.error("Failed to update event:",se),alert("Failed to update event. Please try again.")}},Js=async(H,se)=>{try{if(await a.updateEvent(t.params.eventId,{...Mt.value,defaultCheckpointStyleMapRotation:Mt.value.defaultCheckpointStyleMapRotation!=null?String(Mt.value.defaultCheckpointStyleMapRotation):null}),H&&se!==null){const ge=Math.floor(Math.abs(se)/1e3),ye=se<0,tt=Math.floor(ge/3600),Lt=Math.floor(ge%3600/60),At=ge%60,dn=`${ye?"-":""}${tt.toString().padStart(2,"0")}:${Lt.toString().padStart(2,"0")}:${At.toString().padStart(2,"0")}`;await a.bulkUpdateLocationTimes(t.params.eventId,dn)}await Mn(),Ct.value=!1}catch(ge){console.error("Failed to update event:",ge),alert("Failed to update event. Please try again.")}},Ys=async({shouldShift:H,timeDelta:se})=>{Bt.value=!1,await Js(H,se)},Aa=()=>{Bt.value=!1,Mn()},Mn=async()=>{try{await a.fetchEvent(t.params.eventId),E.value=a.currentEvent,E.value&&(Mt.value={name:E.value.name||"",description:E.value.description||"",eventDate:Ol(E.value.eventDate),timeZoneId:E.value.timeZoneId||"UTC",peopleTerm:E.value.peopleTerm||"Marshals",checkpointTerm:E.value.checkpointTerm||"Checkpoints",areaTerm:E.value.areaTerm||"Areas",checklistTerm:E.value.checklistTerm||"Checklists",courseTerm:E.value.courseTerm||"Course",defaultCheckpointStyleType:E.value.defaultCheckpointStyleType||"default",defaultCheckpointStyleColor:E.value.defaultCheckpointStyleColor||"",defaultCheckpointStyleBackgroundShape:E.value.defaultCheckpointStyleBackgroundShape||"",defaultCheckpointStyleBackgroundColor:E.value.defaultCheckpointStyleBackgroundColor||"",defaultCheckpointStyleBorderColor:E.value.defaultCheckpointStyleBorderColor||"",defaultCheckpointStyleIconColor:E.value.defaultCheckpointStyleIconColor||"",defaultCheckpointStyleSize:E.value.defaultCheckpointStyleSize||"",defaultCheckpointStyleMapRotation:E.value.defaultCheckpointStyleMapRotation??"",brandingHeaderGradientStart:E.value.brandingHeaderGradientStart||"",brandingHeaderGradientEnd:E.value.brandingHeaderGradientEnd||"",brandingLogoUrl:E.value.brandingLogoUrl||"",brandingLogoPosition:E.value.brandingLogoPosition||"",brandingAccentColor:E.value.brandingAccentColor||"",brandingPageGradientStart:E.value.brandingPageGradientStart||"",brandingPageGradientEnd:E.value.brandingPageGradientEnd||""},Ct.value=!1,xu(E.value));const H=await Promise.allSettled([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId),Na(),Go(),lt(),bn(),It(),no(),vo()]);N.value=a.locations,D.value=a.eventStatus.locations,H.forEach((se,ge)=>{se.status==="rejected"&&console.error(`Failed to load ${["locations","eventStatus","admins","marshals","areas","checklists","notes","contacts"][ge]}:`,se.reason)})}catch(H){console.error("Failed to load event data:",H)}},Go=async()=>{try{const H=await gs.getByEvent(t.params.eventId);Me.value=H.data,j.value.marshals=Date.now()}catch(H){console.error("Failed to load marshals:",H)}},lt=async()=>{try{const H=await ga.getByEvent(t.params.eventId);Gt.value=H.data,j.value.areas=Date.now()}catch(H){console.error("Failed to load areas:",H)}},bn=async()=>{try{const[H,se]=await Promise.all([Dt.getByEvent(t.params.eventId),Dt.getReport(t.params.eventId)]);Oo.value=H.data,xa.value=se.data,j.value.checklists=Date.now()}catch(H){console.error("Failed to load checklists:",H)}},It=async()=>{try{const H=await Es.getByEvent(t.params.eventId);No.value=H.data,j.value.notes=Date.now()}catch(H){console.error("Failed to load notes:",H)}},no=async()=>{Fo.value=!0;try{const H=await ps.getAll(t.params.eventId);mn.value=H.data.incidents||[],j.value.incidents=Date.now()}catch(H){console.error("Failed to load incidents:",H)}finally{Fo.value=!1}},vo=async()=>{try{const[H,se]=await Promise.all([da.getByEvent(t.params.eventId),da.getRoles(t.params.eventId)]);Io.value=H.data,Uo.value=se.data,j.value.contacts=Date.now()}catch(H){console.error("Failed to load contacts:",H)}},mo=async()=>{await Promise.all([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId)]),N.value=a.locations,j.value.checkpoints=Date.now(),D.value=a.eventStatus.locations},as=async()=>{await Promise.all([Go(),a.fetchEventStatus(t.params.eventId)]),D.value=a.eventStatus.locations},go=async()=>{await Promise.all([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId),lt()]),N.value=a.locations,D.value=a.eventStatus.locations},Ea=async()=>{await a.fetchEventStatus(t.params.eventId),D.value=a.eventStatus.locations},is=()=>{gt.value=null,Hn.value="details",le.value=!1,Qn.value=!0},Wt=H=>{gt.value=H,vn.value=H.id,Hn.value="details",le.value=!1,Qn.value=!0},Mo=async H=>{try{let se;if(gt.value&&gt.value.id){if(se=gt.value.id,await ga.update(t.params.eventId,se,H),H.checklistChanges&&H.checklistChanges.length>0)for(const ge of H.checklistChanges)try{ge.complete?await Dt.complete(t.params.eventId,ge.itemId,{marshalId:ge.marshalId,contextType:ge.contextType,contextId:ge.contextId}):await Dt.uncomplete(t.params.eventId,ge.itemId,{marshalId:ge.marshalId,contextType:ge.contextType,contextId:ge.contextId})}catch(ye){console.error("Failed to update checklist item:",ge,ye)}}else se=(await ga.create({eventId:t.params.eventId,...H})).data.id;if(H.pendingContacts&&H.pendingContacts.length>0&&se)for(const ge of H.pendingContacts)try{const ye=ge.scopeConfigurations?JSON.parse(JSON.stringify(ge.scopeConfigurations)):[],tt=ye.find(Lt=>Lt.scope==="EveryoneInAreas"&&Lt.itemType==="Area");tt?(tt.ids||(tt.ids=[]),tt.ids.includes(se)||tt.ids.push(se)):ye.push({scope:"EveryoneInAreas",itemType:"Area",ids:[se]}),await da.update(t.params.eventId,ge.contactId,{...ge,scopeConfigurations:ye})}catch(ye){console.error("Failed to add area to contact:",ge,ye)}if(H.contactsToRemove&&H.contactsToRemove.length>0&&se)for(const ge of H.contactsToRemove)try{const ye=Io.value.find(At=>At.contactId===ge);if(!ye)continue;const tt=ye.scopeConfigurations?JSON.parse(JSON.stringify(ye.scopeConfigurations)):[],Lt=tt.find(At=>At.scope==="EveryoneInAreas"&&At.itemType==="Area");if(Lt&&Lt.ids){Lt.ids=Lt.ids.filter(dn=>dn!==se);const At=Lt.ids.length>0?tt:tt.filter(dn=>!(dn.scope==="EveryoneInAreas"&&dn.itemType==="Area"));await da.update(t.params.eventId,ge,{...ye,scopeConfigurations:At})}}catch(ye){console.error("Failed to remove area from contact:",ge,ye)}(H.pendingContacts&&H.pendingContacts.length>0||H.contactsToRemove&&H.contactsToRemove.length>0)&&await vo(),await lt(),await Mn(),Xs()}catch(se){console.error("Failed to save area:",se),alert(se.response?.data?.message||"Failed to save area. Please try again.")}},ci=async H=>{y(`Delete ${A.value.area}`,`Are you sure you want to delete this ${A.value.area}? ${S.value.checkpoints} will be automatically reassigned.`,async()=>{try{await ga.delete(t.params.eventId,H),await ga.recalculate(t.params.eventId),await lt(),await Mn(),Xs()}catch(se){console.error(`Failed to delete ${A.value.area}:`,se),alert(se.response?.data?.message||`Failed to delete ${A.value.area}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Xs=()=>{Qn.value=!1,gt.value=null,vn.value=null,le.value=!1,qt.value=!1,jt.value=null},qi=({marshal:H,area:se})=>{gn.value=null,Gn.value="details",le.value=!1,pt.value=se,xt.value="",To.value=H.id,$o.value=!0},Pa=({name:H,area:se})=>{gn.value=null,Gn.value="details",le.value=!1,pt.value=se,xt.value=H,To.value=null,$o.value=!0},Qs=H=>{gn.value=H,Gn.value="details",le.value=!1,$o.value=!0},Da=()=>{uo.value=null,Vn.value="details",le.value=!1,Bo.value=!0},Ra=(H,se="details")=>{uo.value=H,Vn.value=se,le.value=!1,Bo.value=!0},yt=async H=>{try{if(uo.value&&uo.value.itemId)await Dt.update(t.params.eventId,uo.value.itemId,H);else{const se=await Dt.create(t.params.eventId,H);se.data.count&&se.data.count>1&&(_t.value="Checklist Items Created",bt.value=`Successfully created ${se.data.count} checklist items.`,mt.value=!0)}await bn(),wn()}catch(se){console.error("Failed to save checklist item:",se);const ge=se.response?.data?.message||"Failed to save checklist item. Please try again.";alert(ge)}},Wi=async H=>{y(`Delete ${A.value.checklist}`,`Are you sure you want to delete this ${A.value.checklist}?`,async()=>{try{await Dt.delete(t.params.eventId,H),await bn(),wn()}catch(se){console.error(`Failed to delete ${A.value.checklist}:`,se),alert(se.response?.data?.message||`Failed to delete ${A.value.checklist}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},wn=()=>{Bo.value=!1,uo.value=null,le.value=!1},ls=()=>{Lo.value=null,qs.value="details",le.value=!1,Zs.value=!0},Oa=H=>{Lo.value=H,qs.value="details",le.value=!1,Zs.value=!0},ui=async H=>{try{Lo.value&&Lo.value.noteId?await Es.update(t.params.eventId,Lo.value.noteId,H):await Es.create(t.params.eventId,H),await It(),Ee()}catch(se){console.error("Failed to save note:",se);const ge=se.response?.data?.message||"Failed to save note. Please try again.";alert(ge)}},Ba=async H=>{y("Delete note","Are you sure you want to delete this note?",async()=>{try{await Es.delete(t.params.eventId,H),await It(),Ee()}catch(se){console.error("Failed to delete note:",se),alert(se.response?.data?.message||"Failed to delete note. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Ee=()=>{Zs.value=!1,Lo.value=null,le.value=!1},$e=()=>{ho.value=!0},at=async H=>{try{await ps.create(t.params.eventId,H),ho.value=!1,await no()}catch(se){console.error("Failed to report incident:",se),alert(se.response?.data?.message||"Failed to report incident. Please try again.")}},vt=H=>{sn.value=H,So.value=!0},wt=()=>{So.value=!1,sn.value=null},Cn=async({incidentId:H,status:se})=>{try{if(await ps.updateStatus(t.params.eventId,H,{status:se}),await no(),sn.value?.incidentId===H){const ge=mn.value.find(ye=>ye.incidentId===H);ge&&(sn.value=ge)}}catch(ge){console.error("Failed to update incident status:",ge),alert(ge.response?.data?.message||"Failed to update status. Please try again.")}},Xt=()=>{xo.value="",bs.value=!0},An=()=>{bs.value=!1,xo.value=""},zt=async()=>{if(!(!xo.value.trim()||!sn.value)){ws.value=!0;try{await ps.addNote(t.params.eventId,sn.value.incidentId,xo.value.trim()),An(),await no();const H=mn.value.find(se=>se.incidentId===sn.value.incidentId);H&&(sn.value=H)}catch(H){console.error("Failed to add note to incident:",H),alert(H.response?.data?.message||"Failed to add note. Please try again.")}finally{ws.value=!1}}},Qt=()=>{gn.value=null,Gn.value="details",pt.value=null,le.value=!1,$o.value=!0},$t=H=>{gn.value=H,Gn.value="details",le.value=!1,$o.value=!0},en=async H=>{try{let se=null;const ge=!gn.value||!gn.value.contactId,ye=!!pt.value;if(gn.value&&gn.value.contactId)await da.update(t.params.eventId,gn.value.contactId,H);else{const tt=await da.create(t.params.eventId,H);se=tt.data?.contactId||tt.data?.id}if(await vo(),ge&&ye&&se&&eo.value){const tt=Io.value.find(Lt=>Lt.contactId===se);tt&&eo.value.addPendingContact(tt)}Ao()}catch(se){console.error("Failed to save contact:",se);const ge=se.response?.data?.message||"Failed to save contact. Please try again.";alert(ge)}},En=async H=>{y("Delete contact","Are you sure you want to delete this contact?",async()=>{try{await da.delete(t.params.eventId,H),await vo(),eo.value&&eo.value.removeContactById(H),Ao()}catch(se){console.error("Failed to delete contact:",se),alert(se.response?.data?.message||"Failed to delete contact. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Ao=()=>{$o.value=!1,gn.value=null,pt.value=null,xt.value="",To.value=null,le.value=!1},oo=H=>{jt.value={...H,id:gt.value?.id};const se={...H,id:gt.value?.id,polygon:[]};gt.value=se;let ge=!1;if(H.polygon&&H.polygon.length>0){const ye=H.polygon.map(Ln=>Ln.lat||Ln[0]),tt=H.polygon.map(Ln=>Ln.lng||Ln[1]),Lt=Math.min(...ye),At=Math.max(...ye),dn=Math.min(...tt),ia=Math.max(...tt);Ge.value={lat:(Lt+At)/2,lng:(dn+ia)/2};const bi=At-Lt,Ss=ia-dn,la=Math.max(bi,Ss);St.value=la<.005?17:la<.01?16:la<.02?15:la<.05?14:13,ge=!0}if(!ge&&H.checkpointIds&&H.checkpointIds.length>0){const ye=D.value.filter(tt=>H.checkpointIds.includes(tt.id));if(ye.length>0){const tt=ye.map(At=>At.latitude).filter(Boolean),Lt=ye.map(At=>At.longitude).filter(Boolean);if(tt.length>0&&Lt.length>0){const At=Math.min(...tt),dn=Math.max(...tt),ia=Math.min(...Lt),bi=Math.max(...Lt);Ge.value={lat:(At+dn)/2,lng:(ia+bi)/2};const Ss=dn-At,la=bi-ia,Ln=Math.max(Ss,la);St.value=Ln<.005?16:Ln<.01?15:Ln<.02?14:Ln<.05?13:12,ge=!0}}}if(!ge&&ue.value){const ye=ue.value.getMapCenter(),tt=ue.value.getMapZoom();ye&&tt!==null&&(Ge.value=ye,St.value=tt)}Co.value=!0,ae.value="draw-area",qt.value=!0,ie.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},ea=H=>{jt.value?gt.value={...gt.value||{},...jt.value,polygon:H}:gt.value={...gt.value,polygon:H}},Ki=H=>{T.handlePolygonDrawing(H)},yc=()=>{qt.value=!1,jt.value&&(gt.value=jt.value,Qn.value=!0,jt.value=null)},Na=()=>P.loadEventAdmins(),kc=async H=>{try{await P.addAdmin(H),await Na(),Ji()}catch(se){console.error("Failed to add admin:",se),alert(se.response?.data?.message||"Failed to add administrator. Please try again.")}},Wl=async H=>{y("Remove administrator",`Remove ${H} as an administrator?`,async()=>{try{await P.removeAdmin(H),await Na()}catch(se){console.error("Failed to remove admin:",se),alert(se.response?.data?.message||"Failed to remove administrator. Please try again.")}},{isDanger:!0,confirmText:"Remove"})},Ji=()=>{P.closeAddAdminModal(),le.value=!1},di=async H=>{await x.uploadRoute(H)&&(await mo(),rs())},rs=()=>{x.closeUploadRouteModal()},_c=async({file:H,deleteExisting:se})=>{const ge=await x.importLocations(H,se);if(ge){await go(),ta();const ye=x.formatImportResultMessage(ge,"location");_t.value="Import Complete",bt.value=ye,mt.value=!0}},ta=()=>{x.closeImportLocationsModal()},so=async H=>{if(ne.value)pn.value.latitude=H.lat,pn.value.longitude=H.lng;else if(X.value)fe.value.latitude=H.lat,fe.value.longitude=H.lng,R.value&&(R.value={...R.value,latitude:H.lat,longitude:H.lng}),X.value=!1,q.value=!0,Ut();else if(_s.value)try{await a.createLocation({eventId:t.params.eventId,name:`Checkpoint ${to.value}`,description:"",latitude:H.lat,longitude:H.lng,requiredMarshals:1,what3Words:""}),to.value++,await Mn()}catch(se){console.error("Failed to create checkpoint:",se),alert("Failed to create checkpoint. Please try again.")}},Kl=H=>{T.handleFullscreenMapClick(H)},Jl=H=>{pn.value={...H}},bc=()=>{ne.value=!1,T.enterPlaceCheckpointMode()},Yi=()=>{T.saveMapState(ue.value),pn.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},T.enterPlaceCheckpointMode()},Xi=()=>{T.saveMapState(ue.value),Co.value=!0,ae.value="view",ie.value={title:"Course map",description:""}},wc=()=>{T.saveMapState(ue.value),gt.value={id:null,name:"",description:"",color:"#667eea",polygon:[],checkpointIds:[],marshalIds:[],displayOrder:Gt.value.length},T.enterDrawAreaMode()},Cc=()=>{R.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},fe.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},Te.value=[],Oe.value=[],le.value=!1,q.value=!0},Yl=()=>{const H=T.calculateStartingNumber(D);T.saveMapState(ue.value),T.enterAddMultipleMode(H)},Lc=()=>{if(ae.value==="place-checkpoint"){const H=T.getPlacedCoords()||{lat:0,lng:0};R.value={id:null,name:"",description:"",latitude:H.lat,longitude:H.lng,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},fe.value={id:null,name:"",description:"",latitude:H.lat,longitude:H.lng,requiredMarshals:1,what3Words:""},Te.value=[],Oe.value=[],le.value=!1,hi(),q.value=!0}else if(ae.value==="move-checkpoint"){const H=T.getPlacedCoords();H&&(fe.value.latitude=H.lat,fe.value.longitude=H.lng,R.value&&(R.value={...R.value,...Yt.value||{},latitude:H.lat,longitude:H.lng}),Ut()),Yt.value=null,hi(),q.value=!0}else if(ae.value==="draw-area"){const H=T.getCompletedPolygon();H&&(jt.value?gt.value={...gt.value||{},...jt.value,polygon:H}:gt.value={...gt.value||{},polygon:H}),jt.value=null,hi()}else ae.value==="add-multiple"&&yo()},yo=async()=>{const H=T.getTempCheckpoints();try{for(const se of H)await a.createLocation({eventId:t.params.eventId,name:se.name,description:se.description,latitude:se.latitude,longitude:se.longitude,requiredMarshals:se.requiredMarshals,what3Words:se.what3Words});T.clearTempCheckpoints(),hi(),await Mn()}catch(se){console.error("Failed to create checkpoints:",se),alert("Failed to create checkpoints. Please try again.")}},na=()=>{ae.value==="draw-area"?jt.value&&(gt.value=jt.value,jt.value=null):ae.value==="move-checkpoint"&&(Yt.value&&R.value&&Object.assign(R.value,Yt.value),q.value=!0,X.value=!1),T.cancelFullscreen()},hi=()=>{T.exitFullscreen()},jo=H=>{fi(H)},fi=H=>{R.value=H,fe.value={id:H.id,name:H.name,description:H.description||"",latitude:H.latitude,longitude:H.longitude,requiredMarshals:H.requiredMarshals,what3Words:H.what3Words||""},Te.value=[],Oe.value=[],le.value=!1,q.value=!0,setTimeout(()=>{ue.value?.scrollMapIntoView()},100)},oa=async H=>{if(!Ur(H.what3Words)){alert("Invalid What3Words format. Please use word.word.word or word/word/word (lowercase letters only, 1-20 characters each)");return}try{await a.createLocation({eventId:t.params.eventId,...H}),await Mn(),Xl()}catch(se){console.error("Failed to save location:",se),alert("Failed to save location. Please try again.")}},Xl=()=>{ne.value=!1,pn.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},le.value=!1,le.value=!1},Ls=()=>{q.value=!1,R.value=null,W.value=!1,X.value=!1,we.value=!1,Yt.value=null,fe.value={id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},Te.value=[],Oe.value=[],le.value=!1},pi=()=>{we.value=!1},vi=()=>{we.value=!0},Sc=H=>{H?.formData&&(Yt.value=H.formData),q.value=!1,ve.value=null;const se=Yt.value?.latitude??R.value?.latitude,ge=Yt.value?.longitude??R.value?.longitude;if(se&&ge)Ge.value={lat:se,lng:ge},St.value=16;else if(ue.value){const tt=ue.value.getMapCenter(),Lt=ue.value.getMapZoom();tt&&Lt!==null&&(Ge.value=tt,St.value=Lt)}const ye=Yt.value?.name||R.value?.name;Co.value=!0,ae.value="move-checkpoint",ie.value={title:`Move ${A.value.checkpoint}: ${ye}`,description:"Click on the map to set the new location"}},cs=async H=>{if(!Ur(H.what3Words)){alert("Invalid What3Words format.");return}try{const se=!R.value.id;if(se){const ge=await a.createLocation({eventId:t.params.eventId,name:H.name,description:H.description,latitude:H.latitude,longitude:H.longitude,requiredMarshals:H.requiredMarshals,what3Words:H.what3Words||null,startTime:H.startTime,endTime:H.endTime,styleType:H.styleType,styleColor:H.styleColor,styleBackgroundShape:H.styleBackgroundShape,styleBackgroundColor:H.styleBackgroundColor,styleBorderColor:H.styleBorderColor,styleIconColor:H.styleIconColor,styleSize:H.styleSize,styleMapRotation:H.styleMapRotation!=null?String(H.styleMapRotation):null,peopleTerm:H.peopleTerm,checkpointTerm:H.checkpointTerm,isDynamic:H.isDynamic||!1,locationUpdateScopeConfigurations:H.locationUpdateScopeConfigurations||[],pendingNewChecklistItems:H.pendingNewChecklistItems||[],pendingNewNotes:H.pendingNewNotes||[]});if(H.pendingAssignments&&H.pendingAssignments.length>0)for(const ye of H.pendingAssignments)await a.createAssignment({eventId:t.params.eventId,locationId:ge.id,marshalId:ye.marshalId})}else{const ge=R.value.id;if(await Jn.update(t.params.eventId,ge,{eventId:t.params.eventId,name:H.name,description:H.description,latitude:H.latitude,longitude:H.longitude,requiredMarshals:H.requiredMarshals,what3Words:H.what3Words||null,startTime:H.startTime,endTime:H.endTime,styleType:H.styleType,styleColor:H.styleColor,styleBackgroundShape:H.styleBackgroundShape,styleBackgroundColor:H.styleBackgroundColor,styleBorderColor:H.styleBorderColor,styleIconColor:H.styleIconColor,styleSize:H.styleSize,styleMapRotation:H.styleMapRotation!=null?String(H.styleMapRotation):null,peopleTerm:H.peopleTerm,checkpointTerm:H.checkpointTerm,isDynamic:H.isDynamic||!1,locationUpdateScopeConfigurations:H.locationUpdateScopeConfigurations||[]}),H.pendingNewChecklistItems&&H.pendingNewChecklistItems.length>0)for(const ye of H.pendingNewChecklistItems)ye.text?.trim()&&await Dt.create(t.params.eventId,{text:ye.text,scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[ge]}],displayOrder:0,isRequired:!1});if(H.pendingNewNotes&&H.pendingNewNotes.length>0)for(const ye of H.pendingNewNotes)!ye.title?.trim()&&!ye.content?.trim()||await Es.create(t.params.eventId,{title:ye.title||"Untitled",content:ye.content||"",scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[ge]}],displayOrder:0,priority:"Normal",isPinned:!1});for(const ye of Oe.value)await a.deleteAssignment(t.params.eventId,ye);if(H.assignmentsToRemove&&H.assignmentsToRemove.length>0)for(const ye of H.assignmentsToRemove)await a.deleteAssignment(t.params.eventId,ye);for(const ye of Te.value)await a.createAssignment({eventId:t.params.eventId,locationId:R.value.id,marshalId:ye.marshalId});if(H.checkInChanges&&H.checkInChanges.length>0)for(const ye of H.checkInChanges){const tt=R.value.assignments.find(Lt=>Lt.id===ye.assignmentId);tt&&tt.isCheckedIn!==ye.shouldBeCheckedIn&&await ba.adminCheckIn(t.params.eventId,ye.assignmentId)}}if(!se&&H.checklistChanges&&H.checklistChanges.length>0)for(const ge of H.checklistChanges)try{ge.complete?await Dt.complete(t.params.eventId,ge.itemId,{marshalId:ge.marshalId,contextType:ge.contextType,contextId:ge.contextId}):await Dt.uncomplete(t.params.eventId,ge.itemId,{marshalId:ge.marshalId,contextType:ge.contextType,contextId:ge.contextId})}catch(ye){console.error("Failed to update checklist item:",ge,ye)}await Mn(),Ls()}catch(se){console.error("Failed to update location:",se),alert("Failed to update location. Please try again.")}},mi=async H=>{y(`Delete ${A.value.checkpoint}`,`Are you sure you want to delete this ${A.value.checkpoint}?`,async()=>{try{await Jn.delete(t.params.eventId,H),await go(),Ls()}catch(se){console.error(`Failed to delete ${A.value.checkpoint}:`,se),alert(`Failed to delete ${A.value.checkpoint}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},xc=async H=>{try{if(K.value&&K.value.setCheckingIn(H.id),await ba.adminCheckIn(t.params.eventId,H.id),await Ea(),R.value){const se=D.value.find(ge=>ge.id===R.value.id);se&&(R.value=se)}}catch(se){console.error("Failed to toggle check-in:",se),alert("Failed to toggle check-in. Please try again.")}finally{K.value&&K.value.setCheckingIn(null)}},Qi=H=>{const se=H?.id??H;if(se?.toString().startsWith("temp-")){const ge=R.value.assignments.find(ye=>ye.id===se);ge&&(Te.value=Te.value.filter(ye=>ye.marshalId!==ge.marshalId)),R.value.assignments=R.value.assignments.filter(ye=>ye.id!==se),Ut()}else Oe.value.includes(se)||(Oe.value.push(se),R.value.assignments=R.value.assignments.filter(ge=>ge.id!==se),Ut())},Ic=async H=>{const se=Me.value.find(ye=>ye.id===H);if(!se)return;const ge=D.value.filter(ye=>ye.assignments?.some(tt=>tt.marshalId===H&&ye.id!==R.value.id));if(ge.length>0){V.value={marshalName:se.name,locations:ge.map(tt=>tt.name),marshal:se};const ye=await new Promise(tt=>{J.value=tt,Y.value=!0});if(ye==="cancel"||ye==="choose-other")return;if(ye==="move")for(const tt of ge){const Lt=tt.assignments.find(At=>At.marshalId===H);if(Lt){Oe.value.push(Lt.id);const At=D.value.findIndex(dn=>dn.id===tt.id);At!==-1&&(D.value[At].assignments=D.value[At].assignments.filter(dn=>dn.id!==Lt.id))}}}Te.value.push({marshalId:se.id,marshalName:se.name}),R.value.assignments||(R.value.assignments=[]),R.value.assignments.push({id:`temp-${Date.now()}`,marshalId:se.id,marshalName:se.name,locationId:R.value.id,isCheckedIn:!1,isPending:!0}),Ut(),pi()},Zo=async H=>{try{const ge=(await gs.create({eventId:t.params.eventId,name:H.name,email:H.email,phoneNumber:H.phoneNumber})).data;await Go(),Te.value.push({marshalId:ge.id,marshalName:ge.name}),R.value&&(R.value.assignments||(R.value.assignments=[]),R.value.assignments.push({id:`temp-${Date.now()}`,marshalId:ge.id,marshalName:ge.name,locationId:R.value.id,isCheckedIn:!1,isPending:!0})),Ut(),pi()}catch(se){console.error("Failed to create marshal:",se),alert("Failed to create marshal. Please try again.")}},$c=()=>{Ce.value=null,Z.value={},oe.value={id:"",name:"",email:"",phoneNumber:"",notes:""},Be.value=[],Xe.value=[],le.value=!1,Re.value=!0},sa=H=>{Ce.value=H,Z.value={},oe.value={id:H.id,name:H.name,email:H.email||"",phoneNumber:H.phoneNumber||"",notes:H.notes||""},Be.value=[],Xe.value=[],le.value=!1,Re.value=!0},Ql=G(()=>{if(!Ce.value)return[];const H=[];return D.value.forEach(se=>{se.assignments.filter(ye=>ye.marshalName===Ce.value.name&&!Xe.value.includes(ye.id)).forEach(ye=>{H.push({...ye,locationName:se.name,locationDescription:se.description||""})})}),Be.value.forEach((se,ge)=>{const ye=D.value.find(tt=>tt.id===se.locationId);ye&&H.push({id:`pending-${ge}`,locationId:se.locationId,locationName:ye.name,locationDescription:ye.description||"",marshalId:Ce.value.id,marshalName:Ce.value.name,isCheckedIn:!1,isPending:!0})}),H}),qo=async H=>{try{let se=Ce.value?.id,ge=!1;if(Ce.value){if(await gs.update(t.params.eventId,Ce.value.id,{name:H.name,email:H.email,phoneNumber:H.phoneNumber,notes:H.notes}),H.pendingNewChecklistItems&&H.pendingNewChecklistItems.length>0)for(const ye of H.pendingNewChecklistItems)ye.text?.trim()&&await Dt.create(t.params.eventId,{text:ye.text,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[se]}],displayOrder:0,isRequired:!1});if(H.pendingNewNotes&&H.pendingNewNotes.length>0)for(const ye of H.pendingNewNotes)!ye.title?.trim()&&!ye.content?.trim()||await Es.create(t.params.eventId,{title:ye.title||"Untitled",content:ye.content||"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[se]}],displayOrder:0,priority:"Normal",isPinned:!1})}else se=(await gs.create({eventId:t.params.eventId,name:H.name,email:H.email,phoneNumber:H.phoneNumber,notes:H.notes,pendingNewChecklistItems:H.pendingNewChecklistItems||[],pendingNewNotes:H.pendingNewNotes||[]})).data.id,ge=!0;for(const ye of Xe.value)await a.deleteAssignment(t.params.eventId,ye);if(H.assignmentsToRemove&&H.assignmentsToRemove.length>0)for(const ye of H.assignmentsToRemove)await a.deleteAssignment(t.params.eventId,ye);for(const ye of Be.value)await a.createAssignment({eventId:t.params.eventId,locationId:ye.locationId,marshalId:se});if(H.pendingAssignments&&H.pendingAssignments.length>0)for(const ye of H.pendingAssignments)await a.createAssignment({eventId:t.params.eventId,locationId:ye.locationId,marshalId:se});if(H.checkInChanges&&H.checkInChanges.length>0){const ye=Ql.value;for(const tt of H.checkInChanges){const Lt=ye.find(At=>At.id===tt.assignmentId);Lt&&Lt.isCheckedIn!==tt.shouldBeCheckedIn&&await ba.adminCheckIn(t.params.eventId,tt.assignmentId)}}if(H.checklistChanges&&H.checklistChanges.length>0)for(const ye of H.checklistChanges)try{const tt={marshalId:se};ye.contextType&&ye.contextId&&(tt.contextType=ye.contextType,tt.contextId=ye.contextId),ye.complete?await Dt.complete(t.params.eventId,ye.itemId,tt):await Dt.uncomplete(t.params.eventId,ye.itemId,tt)}catch(tt){console.error("Failed to process checklist change:",tt);const Lt=tt.response?.data?.message||"Failed to update checklist item";alert(`Error: ${Lt}`)}if(await Mn(),R.value){const ye=D.value.find(tt=>tt.id===R.value.id);ye&&(R.value=ye)}Ua(),ge&&(U.value=se,ee.value=H.name,he.value=!0)}catch(se){console.error("Failed to save marshal:",se);const ge=se.response?.data?.message||"Failed to save marshal. Please try again.";if(se.response?.status===400){const ye=ge.toLowerCase();ye.includes("name")?(Z.value={name:ge},me.value&&(me.value.switchToTab("details"),me.value.focusField("name"))):ye.includes("email")?(Z.value={email:ge},me.value&&(me.value.switchToTab("details"),me.value.focusField("email"))):(Z.value={general:ge},me.value&&me.value.switchToTab("details"))}else Z.value={general:ge},me.value&&me.value.switchToTab("details")}},Fa=async H=>{const se=H||Ce.value?.id;if(!se){console.error("No marshal ID to delete");return}const ge=A.value.person;y(`Delete ${ge}`,`Are you sure you want to delete this ${ge}?`,async()=>{try{await gs.delete(t.params.eventId,se),await as(),Ua()}catch(ye){console.error(`Failed to delete ${ge}:`,ye),alert(`Failed to delete ${ge}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},er=H=>{Fa(H.id)},el=H=>{const se=H?.id??H;if(se?.toString().startsWith("pending-")){const ge=H?.locationId;ge&&(Be.value=Be.value.filter(ye=>ye.locationId!==ge)),Ut()}else Xe.value.includes(se)||(Xe.value.push(se),Ut())},gi=H=>{Be.value.push({locationId:H}),Ut()},Ua=()=>{Re.value=!1,Ce.value=null,be.value=null,Z.value={},oe.value={id:"",name:"",email:"",phoneNumber:"",notes:""},Be.value=[],Xe.value=[],le.value=!1},yi=async H=>{const se=Me.value.find(ge=>ge.id===H.marshalId);if(!se){console.error("Marshal not found:",H.marshalId);return}be.value=R.value?.id||null,le.value=!1,Ce.value=se,Re.value=!0},aa=H=>{const se=D.value.find(ge=>ge.id===H.locationId);if(!se){console.error("Location not found:",H.locationId);return}W.value=!0,le.value=!1,R.value=se,q.value=!0},ki=async({file:H})=>{const se=await x.importMarshals(H);if(se){await as(),_i();const ge=x.formatImportResultMessage(se,"marshal");_t.value="Import Complete",bt.value=ge,mt.value=!0}},_i=()=>{x.closeImportMarshalsModal()},tr=H=>{J.value&&(J.value(H),J.value=null),Y.value=!1};let za=null;const Ha=async()=>{try{const H=t.params.eventId,se=await Jn.getDynamicCheckpoints(H);if(se.data&&Array.isArray(se.data))for(const ge of se.data){const ye=D.value.find(tt=>tt.id===ge.checkpointId);ye&&(ye.latitude=ge.latitude,ye.longitude=ge.longitude,ye.lastLocationUpdate=ge.lastLocationUpdate)}}catch(H){console.warn("Failed to poll dynamic checkpoints:",H)}},nr=()=>{za||!D.value.some(se=>se.isDynamic||se.IsDynamic)||(Ha(),za=setInterval(Ha,6e4))},tl=()=>{za&&(clearInterval(za),za=null)};return qe(i,H=>{H==="course"?nr():tl();const se=Date.now(),ge=ye=>se-j.value[ye]>WR;switch(H){case"marshals":ge("marshals")&&Go();break;case"areas":ge("areas")&&lt();break;case"checkpoints":ge("checkpoints")&&mo();break;case"checklists":ge("checklists")&&bn();break;case"notes":ge("notes")&&It();break;case"incidents":ge("incidents")&&no();break;case"contacts":ge("contacts")&&vo();break}}),on(async()=>{await Mn();try{const H=await ms.getMe(t.params.eventId);fo.value=H.data}catch(H){console.warn("Failed to fetch user claims:",H)}i.value==="course"&&nr()}),qe(E,H=>{H&&(document.title="OnTheDay App - Admin")},{immediate:!0}),$n(()=>{tl()}),(H,se)=>(v(),m("div",{class:"admin-event-manage",style:Qe({colorScheme:B(O)})},[r("header",BR,[r("div",NR,[r("button",{onClick:Ma,class:"btn-back",title:"Back to sessions"},[Ae(OR,{size:48,animate:""})]),E.value?(v(),m("div",FR,[r("h1",null,C(E.value.name),1),r("p",UR,C(B(Vv)(E.value.eventDate)),1)])):M("",!0)]),r("div",zR,[zo.value?(v(),m("button",{key:0,onClick:Ia,class:"btn btn-marshal-mode"}," Switch to Marshal ")):M("",!0)]),Ae(AR,{class:"theme-toggle-fixed"})]),r("div",HR,[r("div",VR,[Ae(m$,{tabs:F.value,"model-value":B(i),"onUpdate:modelValue":B(l)},null,8,["tabs","model-value","onUpdate:modelValue"])]),r("div",GR,[B(i)==="course"?(v(),Ze(W0,{key:0,ref_key:"courseAreasTab",ref:ue,checkpoints:D.value,areas:Gt.value,route:E.value?.route||[],"selected-area-id":vn.value,"drawing-mode":B(qt),onMapClick:so,onLocationClick:jo,onAreaClick:Wt,onImportCheckpoints:se[0]||(se[0]=ge=>Fe.value=!0),onUploadRoute:se[1]||(se[1]=ge=>De.value=!0),onSelectLocation:fi,onAddArea:is,onSelectArea:Wt,onPolygonComplete:ea,onCancelDrawing:yc,onAddCheckpointFromMap:Yi,onAddManyCheckpointsFromMap:Yl,onAddAreaFromMap:wc,onFullscreen:Xi},null,8,["checkpoints","areas","route","selected-area-id","drawing-mode"])):M("",!0),B(i)==="checkpoints"?(v(),Ze(UI,{key:1,locations:D.value,areas:Gt.value,onAddCheckpointManually:Cc,onImportCheckpoints:se[2]||(se[2]=ge=>Fe.value=!0),onSelectLocation:fi},null,8,["locations","areas"])):M("",!0),B(i)==="areas"?(v(),Ze(i$,{key:2,areas:Gt.value,checkpoints:D.value,contacts:Io.value,"event-people-term":E.value?.peopleTerm||"Marshals","event-checkpoint-term":E.value?.checkpointTerm||"Checkpoints",onAddArea:is,onSelectArea:Wt},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term"])):M("",!0),B(i)==="marshals"?(v(),Ze(Aw,{key:3,ref_key:"marshalsTabRef",ref:K,marshals:Me.value,assignments:Ft.value,locations:D.value,onAddMarshal:$c,onImportMarshals:se[3]||(se[3]=ge=>Ke.value=!0),onSelectMarshal:sa,onDeleteMarshal:er,onToggleCheckIn:xc},null,8,["marshals","assignments","locations"])):M("",!0),B(i)==="checklists"?(v(),Ze(jw,{key:4,"checklist-items":Oo.value,areas:Gt.value,locations:D.value,marshals:Me.value,"completion-report":xa.value,onAddChecklistItem:Da,onSelectChecklistItem:Ra},null,8,["checklist-items","areas","locations","marshals","completion-report"])):M("",!0),B(i)==="notes"?(v(),Ze(cC,{key:5,notes:No.value,areas:Gt.value,locations:D.value,marshals:Me.value,onAddNote:ls,onSelectNote:Oa},null,8,["notes","areas","locations","marshals"])):M("",!0),B(i)==="incidents"?(v(),Ze(bI,{key:6,incidents:mn.value,areas:Gt.value,loading:Fo.value,onSelectIncident:vt,onReportIncident:$e},null,8,["incidents","areas","loading"])):M("",!0),B(i)==="contacts"?(v(),Ze(OC,{key:7,contacts:Io.value,areas:Gt.value,locations:D.value,marshals:Me.value,"available-roles":Uo.value,onAddContact:Qt,onSelectContact:$t},null,8,["contacts","areas","locations","marshals","available-roles"])):M("",!0),B(i)==="details"?(v(),Ze(WC,{key:8,"event-data":Mt.value,"form-dirty":Ct.value,onSubmit:Ks,"onUpdate:formDirty":Cs},null,8,["event-data","form-dirty"])):M("",!0),B(i)==="settings"?(v(),Ze(Yx,{key:9,"event-data":Mt.value,"event-id":B(t).params.eventId,admins:B(de),"form-dirty":Ct.value,onSubmit:Ks,onAddAdmin:se[4]||(se[4]=ge=>re.value=!0),onRemoveAdmin:Wl,"onUpdate:formDirty":Cs},null,8,["event-data","event-id","admins","form-dirty"])):M("",!0)])]),Ae(LR,{show:ne.value,location:pn.value,"is-dirty":le.value,onClose:Xl,onSave:oa,onSetOnMap:bc,"onUpdate:isDirty":Ut,"onUpdate:location":Jl},null,8,["show","location","is-dirty"]),Ae(U4,{show:q.value,location:R.value,assignments:R.value?.assignments||[],"event-date":E.value?.eventDate||"",areas:Gt.value,"event-id":B(t).params.eventId,"all-locations":D.value,notes:No.value,"available-marshals":Ho.value,"all-checklist-items":Oo.value,incidents:Vo.value,"is-dirty":le.value,"event-default-style-type":E.value?.defaultCheckpointStyleType||E.value?.DefaultCheckpointStyleType||"default","event-default-style-color":E.value?.defaultCheckpointStyleColor||E.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":E.value?.defaultCheckpointStyleBackgroundShape||E.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":E.value?.defaultCheckpointStyleBackgroundColor||E.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":E.value?.defaultCheckpointStyleBorderColor||E.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":E.value?.defaultCheckpointStyleIconColor||E.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":E.value?.defaultCheckpointStyleSize||E.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":E.value?.defaultCheckpointStyleMapRotation??E.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":E.value?.peopleTerm||"Marshals","z-index":Qn.value?1200:W.value?1100:1e3,"locked-from-marshal":W.value,onClose:Ls,onSave:cs,onDelete:mi,onMoveLocation:Sc,onRemoveAssignment:Qi,onOpenAssignModal:vi,"onUpdate:isDirty":Ut,onSelectIncident:Ta,onSelectMarshal:yi},null,8,["show","location","assignments","event-date","areas","event-id","all-locations","notes","available-marshals","all-checklist-items","incidents","is-dirty","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","z-index","locked-from-marshal"]),Ae(M$,{show:Q.value,link:dt.value,"is-dirty":!1,onClose:se[5]||(se[5]=ge=>Q.value=!1)},null,8,["show","link"]),Ae(G$,{show:he.value,"event-id":B(t).params.eventId,"marshal-id":U.value,"marshal-name":ee.value,onClose:se[6]||(se[6]=ge=>he.value=!1)},null,8,["show","event-id","marshal-id","marshal-name"]),Ae(q$,{show:B(re),"is-dirty":le.value,onClose:Ji,onSubmit:kc,"onUpdate:isDirty":Ut},null,8,["show","is-dirty"]),Ae(X$,{show:B(De),uploading:B(et),error:B(Je),"is-dirty":le.value,onClose:rs,onSubmit:di,"onUpdate:isDirty":Ut},null,8,["show","uploading","error","is-dirty"]),Ae(rT,{show:B(Fe),importing:B(_e),error:B(pe),result:B(Le),"is-dirty":le.value,onClose:ta,onSubmit:_c,"onUpdate:isDirty":Ut},null,8,["show","importing","error","result","is-dirty"]),Ae(BP,{ref_key:"editMarshalModalRef",ref:me,show:Re.value,marshal:Ce.value,"event-id":B(t).params.eventId,assignments:Ql.value,"available-locations":$a.value,"all-locations":D.value,areas:Gt.value,"is-editing":!!Ce.value,"event-notes":No.value,"all-checklist-items":Oo.value,incidents:Zt.value,"is-dirty":le.value,"validation-errors":Z.value,"locked-checkpoint-id":be.value,"z-index":be.value?1100:1e3,onClose:Ua,onSave:qo,onDelete:Fa,onRemoveAssignment:el,onAssignToLocation:gi,"onUpdate:isDirty":Ut,onSelectIncident:Tn,onSelectCheckpoint:aa},null,8,["show","marshal","event-id","assignments","available-locations","all-locations","areas","is-editing","event-notes","all-checklist-items","incidents","is-dirty","validation-errors","locked-checkpoint-id","z-index"]),Ae(mT,{show:B(Ke),importing:B(Ve),error:B(pe),result:B(Pe),"is-dirty":le.value,onClose:_i,onSubmit:ki,"onUpdate:isDirty":Ut},null,8,["show","importing","error","result","is-dirty"]),Ae(zP,{show:Y.value,"conflict-data":V.value,onClose:se[7]||(se[7]=ge=>Y.value=!1),onChoice:tr},null,8,["show","conflict-data"]),Ae(YP,{show:we.value,"location-name":R.value?.name||"",marshals:Ho.value,onClose:pi,onAssignExisting:Ic,onCreateAndAssign:Zo},null,8,["show","location-name","marshals"]),Ae(c6,{show:Bt.value,"old-event-date":Nt.value,"new-event-date":zn.value,"affected-checkpoints-count":Xn.value,onConfirm:Ys,onCancel:Aa},null,8,["show","old-event-date","new-event-date","affected-checkpoints-count"]),Ae(I5,{ref_key:"editAreaModalRef",ref:eo,show:Qn.value,area:gt.value,"initial-tab":Hn.value,checkpoints:D.value,marshals:Me.value,areas:Gt.value,route:E.value?.route||[],"is-dirty":le.value,"event-id":B(t).params.eventId,"all-locations":D.value,assignments:Ft.value,notes:No.value,contacts:Io.value,incidents:kn.value,"event-default-style-type":E.value?.defaultCheckpointStyleType||E.value?.DefaultCheckpointStyleType||"default","event-default-style-color":E.value?.defaultCheckpointStyleColor||E.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":E.value?.defaultCheckpointStyleBackgroundShape||E.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":E.value?.defaultCheckpointStyleBackgroundColor||E.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":E.value?.defaultCheckpointStyleBorderColor||E.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":E.value?.defaultCheckpointStyleIconColor||E.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":E.value?.defaultCheckpointStyleSize||E.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":E.value?.defaultCheckpointStyleMapRotation??E.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":E.value?.peopleTerm||"Marshals","event-checkpoint-term":E.value?.checkpointTerm||"Checkpoints",onClose:Xs,onSave:Mo,onDelete:ci,onDrawBoundary:oo,"onUpdate:isDirty":Ut,onSelectCheckpoint:fi,onCreateContactFromMarshal:qi,onCreateNewContact:Pa,onEditContact:Qs,onSelectIncident:_n},null,8,["show","area","initial-tab","checkpoints","marshals","areas","route","is-dirty","event-id","all-locations","assignments","notes","contacts","incidents","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","event-checkpoint-term"]),Ae(N5,{show:Bo.value,"checklist-item":uo.value,"initial-tab":Vn.value,areas:Gt.value,locations:D.value,marshals:Me.value,"is-dirty":le.value,onClose:wn,onSave:yt,onDelete:Wi,"onUpdate:isDirty":Ut},null,8,["show","checklist-item","initial-tab","areas","locations","marshals","is-dirty"]),Ae(Q5,{show:Zs.value,note:Lo.value,"initial-tab":qs.value,areas:Gt.value,locations:D.value,marshals:Me.value,"is-dirty":le.value,onClose:Ee,onSave:ui,onDelete:Ba,"onUpdate:isDirty":Ut},null,8,["show","note","initial-tab","areas","locations","marshals","is-dirty"]),Ae(Qv,{show:So.value,incident:sn.value,route:E.value?.route||[],checkpoints:D.value,"can-manage":!0,onClose:wt,onStatusChange:Cn,onOpenAddNote:Xt},null,8,["show","incident","route","checkpoints"]),Ae(Vt,{show:bs.value,title:"Add update",size:"small",onClose:An},{footer:ze(()=>[r("div",ZR,[r("button",{type:"button",class:"btn btn-secondary",onClick:An}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:zt,disabled:!xo.value.trim()||ws.value},C(ws.value?"Adding...":"Add update"),9,qR)])]),default:ze(()=>[r("div",jR,[He(r("textarea",{"onUpdate:modelValue":se[8]||(se[8]=ge=>xo.value=ge),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[st,xo.value]])])]),_:1},8,["show"]),Ae(em,{show:ho.value,"event-id":B(t).params.eventId,checkpoint:null,"initial-location":null,checkpoints:D.value,route:E.value?.route||[],onClose:se[9]||(se[9]=ge=>ho.value=!1),onSubmit:at},null,8,["show","event-id","checkpoints","route"]),Ae(QD,{show:$o.value,contact:gn.value,"initial-tab":Gn.value,areas:Gt.value,locations:D.value,marshals:Me.value,"available-roles":Uo.value,"is-dirty":le.value,"prefilled-name":xt.value,"prefilled-marshal-id":To.value,"create-from-area-context":!!pt.value,onClose:Ao,onSave:en,onDelete:En,"onUpdate:isDirty":Ut},null,8,["show","contact","initial-tab","areas","locations","marshals","available-roles","is-dirty","prefilled-name","prefilled-marshal-id","create-from-area-context"]),Ae(fR,{show:B(Co),mode:B(ae),"context-title":B(ie).title,"context-description":B(ie).description,"can-complete":yn.value,clickable:B(ae)!=="draw-area","drawing-mode":B(ae)==="draw-area"&&B(qt),locations:Ws.value,areas:po.value,route:E.value?.route||[],"selected-area-id":vn.value,center:B(Ge),zoom:B(St),"highlight-location-id":ri.value,onMapClick:Kl,onPolygonComplete:ea,onPolygonDrawing:Ki,onDone:Lc,onCancel:na},null,8,["show","mode","context-title","context-description","can-complete","clickable","drawing-mode","locations","areas","route","selected-area-id","center","zoom","highlight-location-id"]),Ae(gc,{show:mt.value,title:_t.value,message:bt.value,onClose:se[10]||(se[10]=ge=>mt.value=!1)},null,8,["show","title","message"]),Ae(Bl,{show:B(u),title:B(d),message:B(f),"is-danger":B(p),"confirm-text":B(g),onConfirm:B(k),onCancel:B(_)},null,8,["show","title","message","is-danger","confirm-text","onConfirm","onCancel"])],4))}},JR=je(KR,[["__scopeId","data-v-d8917ba7"]]),YR={key:0,class:"emergency-notes-section"},XR={class:"emergency-notes-list"},QR={class:"note-header"},eO={key:0,class:"note-content"},tO={key:1,class:"emergency-contacts-section"},nO={class:"emergency-contacts-list"},oO={class:"contact-header"},sO={key:0,class:"role-badge"},aO={class:"contact-details"},iO={key:0,class:"info-section"},lO=["href"],rO={key:1,class:"info-section"},cO=["href"],uO={key:2,class:"info-section"},dO=["href"],hO={key:2,class:"no-contacts"},fO={__name:"EmergencyContactModal",props:{show:{type:Boolean,default:!1},contacts:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const o=e,a=t,s=G(()=>o.notes?[...o.notes].sort((u,d)=>{const f=u.priority||u.Priority,p=d.priority||d.Priority;return f==="Emergency"&&p!=="Emergency"?-1:p==="Emergency"&&f!=="Emergency"?1:0}):[]),i=()=>{a("close")},l=u=>u?{EmergencyContact:"Emergency Contact",EventDirector:"Event Director",MedicalLead:"Medical Lead",SafetyOfficer:"Safety Officer",Logistics:"Logistics"}[u]||u.replace(/([A-Z])/g," $1").trim():"";return(u,d)=>(v(),Ze(Vt,{show:e.show,title:"Emergency information",size:"medium",onClose:i},{actions:ze(()=>[r("button",{onClick:i,class:"btn btn-secondary"},"Close")]),default:ze(()=>[e.notes&&e.notes.length>0?(v(),m("div",YR,[d[0]||(d[0]=r("h2",{class:"section-header"},"Emergency notes",-1)),r("div",XR,[(v(!0),m(Se,null,Ne(s.value,f=>(v(),m("div",{key:f.noteId||f.NoteId,class:ce(["emergency-note-item",{"is-emergency":(f.priority||f.Priority)==="Emergency"}])},[r("div",QR,[r("h3",null,C(f.title||f.Title),1),r("span",{class:ce(["priority-badge",(f.priority||f.Priority).toLowerCase()])},C(f.priority||f.Priority),3)]),f.content||f.Content?(v(),m("div",eO,C(f.content||f.Content),1)):M("",!0)],2))),128))])])):M("",!0),e.contacts&&e.contacts.length>0?(v(),m("div",tO,[d[4]||(d[4]=r("h2",{class:"section-header"},"Emergency contacts",-1)),r("div",nO,[(v(!0),m(Se,null,Ne(e.contacts,f=>(v(),m("div",{key:f.contactId||f.name,class:"emergency-contact-item"},[r("div",oO,[r("h3",null,C(f.name),1),f.role?(v(),m("span",sO,C(l(f.role)),1)):M("",!0)]),r("div",aO,[f.phone?(v(),m("div",iO,[d[1]||(d[1]=r("label",null,"Phone number",-1)),r("a",{href:`tel:${f.phone}`,class:"phone-link"},C(f.phone),9,lO)])):M("",!0),f.email?(v(),m("div",rO,[d[2]||(d[2]=r("label",null,"Email",-1)),r("a",{href:`mailto:${f.email}`,class:"email-link"},C(f.email),9,cO)])):M("",!0),f.notes||f.details?(v(),m("div",uO,[d[3]||(d[3]=r("label",null,"Details",-1)),r("p",null,C(f.notes||f.details),1)])):M("",!0)]),f.phone?(v(),m("a",{key:0,href:`tel:${f.phone}`,class:"btn btn-danger btn-full"}," Call "+C(f.name),9,dO)):M("",!0)]))),128))])])):M("",!0),(!e.contacts||e.contacts.length===0)&&(!e.notes||e.notes.length===0)?(v(),m("div",hO,[...d[5]||(d[5]=[r("p",null,"No emergency information has been set up for this event.",-1)])])):M("",!0)]),_:1},8,["show"]))}},pO=je(fO,[["__scopeId","data-v-77c03c7e"]]),fl=$(navigator.onLine),Ns=$(!0),ya=$(0),fr=$(null),Ya=$("idle"),Di=$(null),Eu=$(!1);let cf=null,Xc=!1,Jo=null,uf=0;function vO(e=1e3,t=1e4){return Math.floor(Math.random()*(t-e+1))+e}function Vr(){Jo&&(clearTimeout(Jo),Jo=null);const e=vO(1e3,1e4);console.log(`Scheduling auto-sync in ${e}ms`),Jo=setTimeout(async()=>{if(Jo=null,!navigator.onLine){console.log("Auto-sync cancelled: offline");return}if(await Nr()===0){console.log("Auto-sync cancelled: no pending actions");return}console.log("Starting auto-sync..."),await Gr();const o=await Nr();o>0&&navigator.onLine&&(console.log(`${o} actions remaining, scheduling retry...`),Vr())},e)}async function Ti(){if(!navigator.onLine)return Ns.value=!1,!1;try{return await j_.check(),Ns.value=!0,!0}catch(e){return e.response?.status===404?(Ns.value=!0,!0):(e.code==="ECONNABORTED"&&console.warn("Server health check timed out"),Ns.value=!1,!1)}}async function ld(){const e=Date.now();if(e-uf<2e3)return;uf=e;const t=navigator.onLine;if(fl.value=t,!t){Ns.value=!1;return}Eu.value=!0;try{await Ti()&&ya.value>0&&Vr()}finally{Eu.value=!1}}function df(){document.visibilityState==="visible"&&(console.log("Page became visible, checking connectivity..."),ld())}function hf(){console.log("Window focused, checking connectivity..."),ld()}async function mO(e){try{switch(e.type){case"checkin":await ba.checkIn(e.payload);break;case"checkin_toggle":await ba.toggleCheckIn(e.payload.eventId,e.payload.assignmentId,e.payload.gpsData||{});break;case"checkin_admin":await ba.adminCheckIn(e.payload.eventId,e.payload.assignmentId);break;case"checklist_complete":await Dt.complete(e.payload.eventId,e.payload.itemId,e.payload.data);break;case"checklist_uncomplete":await Dt.uncomplete(e.payload.eventId,e.payload.itemId,e.payload.data);break;default:return console.warn("Unknown action type:",e.type),!1}return!0}catch(t){if(console.error("Failed to sync action:",e,t),t.response&&t.response.status===400){const o=t.response.data?.message||t.response.data||"",a=typeof o=="string"?o.toLowerCase():"";if(a.includes("already checked in"))return console.log("Action already completed (already checked in), treating as success"),!0;if(a.includes("already completed")||a.includes("already uncompleted"))return console.log("Action already completed (checklist state), treating as success"),!0}return t.response&&t.response.status>=400&&t.response.status<500?"permanent_failure":!1}}async function Gr(){if(!Xc&&navigator.onLine){Xc=!0,Ya.value="syncing",Di.value=null;try{const e=await Pv();if(e.length===0){Ya.value="success",ya.value=0;return}let t=0,o=0;for(const a of e){const s=await mO(a);if(s===!0)await Yh(a.id),t++;else if(s==="permanent_failure")await Yh(a.id),o++;else{const i=(a.attempts||0)+1;i>=5?(await Jh(a.id,{status:"failed",attempts:i,lastAttempt:new Date().toISOString()}),o++):await Jh(a.id,{status:"retrying",attempts:i,lastAttempt:new Date().toISOString()})}}ya.value=await Nr(),o>0?(Ya.value="error",Di.value=`${o} action(s) failed to sync`):Ya.value="success"}catch(e){console.error("Sync error:",e),Ya.value="error",Di.value="Failed to sync pending actions"}finally{Xc=!1}}}function gO(){cf||(cf=setInterval(async()=>{navigator.onLine&&(await Ti(),Ns.value&&ya.value>0&&await Gr())},3e4))}function rd(){const e=G(()=>fl.value&&Ns.value);async function t(){ya.value=await Nr()}async function o(){fl.value=!0,await Ti()&&ya.value>0&&Vr()}function a(){fl.value=!1,Ns.value=!1,Jo&&(clearTimeout(Jo),Jo=null)}on(async()=>{await js(),await t(),window.addEventListener("online",o),window.addEventListener("offline",a),document.addEventListener("visibilitychange",df),window.addEventListener("focus",hf),navigator.onLine&&await Ti()&&ya.value>0&&Vr(),gO()}),$n(()=>{window.removeEventListener("online",o),window.removeEventListener("offline",a),document.removeEventListener("visibilitychange",df),window.removeEventListener("focus",hf),Jo&&(clearTimeout(Jo),Jo=null)});async function s(d,f){if(!e.value)return console.warn("Cannot refresh cache while offline"),!1;try{const p=await f();return await Rl(d,p),fr.value=new Date().toISOString(),!0}catch(p){return console.error("Failed to refresh cache:",p),!1}}async function i(d){const f=await _a(d);return f&&(fr.value=f.cachedAt),f}async function l(d){fr.value=await B_(d)}async function u(){return navigator.onLine?await Ti()?(await Gr(),Ya.value==="success"):(Di.value="Server is not responding",!1):(Di.value="Cannot sync while offline",!1)}return{isOnline:fl,isServerHealthy:Ns,isFullyOnline:e,isCheckingStatus:Eu,pendingActionsCount:ya,lastSyncTime:fr,syncStatus:Ya,syncError:Di,checkServerHealth:Ti,quickConnectivityCheck:ld,syncPendingActions:Gr,updatePendingCount:t,refreshCache:s,getCachedData:i,loadLastSyncTime:l,forcSync:u}}const yO={class:"offline-indicator-container"},kO={class:"offline-icon"},_O={key:0,viewBox:"0 0 24 24",fill:"currentColor"},bO={key:1,class:"spinner",viewBox:"0 0 24 24",fill:"currentColor"},wO={class:"offline-text"},CO={key:0,class:"last-sync"},LO={class:"pending-text"},SO={key:0,class:"pending-subtext"},xO={key:1,class:"syncing-text"},IO={__name:"OfflineIndicator",setup(e){const{isOnline:t,isFullyOnline:o,isCheckingStatus:a,pendingActionsCount:s,lastSyncTime:i,syncStatus:l,syncError:u,forcSync:d}=rd(),f=$(!1),p=$(""),g=$(""),y=G(()=>{if(!i.value)return"";const _=new Date(i.value),S=new Date-_,A=Math.floor(S/6e4),T=Math.floor(A/60);return A<1?"just now":A<60?`${A}m ago`:T<24?`${T}h ago`:_.toLocaleDateString()}),k=async()=>{await d()};return qe(l,_=>{_==="success"&&s.value===0?(p.value="All actions synced successfully!",g.value="success",f.value=!0,setTimeout(()=>{f.value=!1},3e3)):_==="error"&&(p.value=u.value||"Sync failed",g.value="error",f.value=!0,setTimeout(()=>{f.value=!1},5e3))}),(_,w)=>(v(),m("div",yO,[Ae(ys,{name:"slide"},{default:ze(()=>[B(o)?M("",!0):(v(),m("div",{key:0,class:ce(["offline-banner",{checking:B(a)}])},[r("span",kO,[B(a)?(v(),m("svg",bO,[...w[1]||(w[1]=[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8z"},null,-1)])])):(v(),m("svg",_O,[...w[0]||(w[0]=[r("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"},null,-1)])]))]),r("span",wO,C(B(a)?"Checking connection...":B(t)?"Server unavailable":"You're offline"),1),B(i)&&!B(a)?(v(),m("span",CO," Last synced: "+C(y.value),1)):M("",!0)],2))]),_:1}),Ae(ys,{name:"fade"},{default:ze(()=>[B(s)>0?(v(),m("div",{key:0,class:ce(["pending-banner",{"offline-pending":!B(o)}])},[w[2]||(w[2]=r("span",{class:"pending-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})])],-1)),r("span",LO,[Ye(C(B(s))+" pending action"+C(B(s)!==1?"s":"")+" ",1),B(o)?M("",!0):(v(),m("span",SO,"(will sync when online)"))]),B(o)&&B(l)!=="syncing"?(v(),m("button",{key:0,onClick:k,class:"sync-button"}," Sync Now ")):B(l)==="syncing"?(v(),m("span",xO,"Syncing...")):M("",!0)],2)):M("",!0)]),_:1}),Ae(ys,{name:"fade"},{default:ze(()=>[f.value?(v(),m("div",{key:0,class:ce(["sync-toast",g.value])},C(p.value),3)):M("",!0)]),_:1})]))}},$O=je(IO,[["__scopeId","data-v-9c1e58f4"]]),TO={class:"modal-content check-in-reminder-modal"},MO={class:"modal-header warning"},AO={class:"modal-body"},EO={class:"reminder-message"},PO={key:0},DO={class:"reminder-hint"},RO={class:"modal-footer"},OO={__name:"CheckInReminderModal",props:{show:{type:Boolean,required:!0},checkpoint:{type:Object,default:null},accentButtonStyle:{type:Object,default:()=>({})}},emits:["dismiss","go-to-checkpoint"],setup(e){const{termsLower:t}=ht();return(o,a)=>(v(),Ze(ys,{name:"modal"},{default:ze(()=>[e.show&&e.checkpoint?(v(),m("div",{key:0,class:"modal-overlay",onClick:a[3]||(a[3]=rt(s=>o.$emit("dismiss"),["self"]))},[r("div",TO,[r("div",MO,[a[4]||(a[4]=r("h3",null,"Check-in reminder",-1)),r("button",{class:"modal-close",onClick:a[0]||(a[0]=s=>o.$emit("dismiss"))},"")]),r("div",AO,[a[6]||(a[6]=r("div",{class:"reminder-icon"},"",-1)),r("p",EO,[Ye(" You have not checked in yet to "+C(B(t).checkpoint)+" ",1),r("strong",null,C(e.checkpoint.location?.name),1),e.checkpoint.location?.description?(v(),m("span",PO," - "+C(e.checkpoint.location.description),1)):M("",!0),a[5]||(a[5]=Ye(". ",-1))]),r("p",DO," Please check in when you arrive at your "+C(B(t).checkpoint)+". ",1)]),r("div",RO,[r("button",{onClick:a[1]||(a[1]=s=>o.$emit("dismiss")),class:"btn btn-secondary"}," Dismiss "),r("button",{onClick:a[2]||(a[2]=s=>o.$emit("go-to-checkpoint")),class:"btn btn-primary",style:Qe(e.accentButtonStyle)}," Go to "+C(B(t).checkpoint),5)])])])):M("",!0)]),_:1}))}},BO=je(OO,[["__scopeId","data-v-4761fdb9"]]),NO={class:"modal-content location-update-modal"},FO={class:"modal-header"},UO={class:"modal-body"},zO={key:0,class:"success-message"},HO={key:1},VO={class:"modal-description"},GO={key:0,class:"last-update-info"},jO={key:1,class:"gps-status active"},ZO={class:"update-option"},qO=["disabled"],WO={class:"update-option auto-update-option"},KO={class:"checkbox-label"},JO=["checked"],YO={class:"option-hint"},XO={class:"update-option"},QO=["disabled"],eB={class:"update-option"},tB={class:"option-label"},nB={key:0,class:"checkpoint-list"},oB=["onClick","disabled"],sB={key:1,class:"no-checkpoints"},aB={key:2,class:"error"},iB={class:"modal-footer"},lB={__name:"LocationUpdateModal",props:{show:{type:Boolean,required:!0},assignment:{type:Object,default:null},userLocation:{type:Object,default:null},autoUpdateEnabled:{type:Boolean,default:!1},updating:{type:Boolean,default:!1},error:{type:String,default:""},success:{type:String,default:""},availableCheckpoints:{type:Array,default:()=>[]},accentButtonStyle:{type:Object,default:()=>({})}},emits:["close","update-gps","toggle-auto-update","select-on-map","copy-from-checkpoint"],setup(e){const{termsLower:t}=ht(),o=a=>a?new Date(a).toLocaleString():"";return(a,s)=>(v(),Ze(ys,{name:"modal"},{default:ze(()=>[e.show?(v(),m("div",{key:0,class:"modal-overlay",onClick:s[5]||(s[5]=rt(i=>a.$emit("close"),["self"]))},[r("div",NO,[r("div",FO,[r("h3",null,"Update "+C(B(t).checkpoint)+" location",1),r("button",{class:"modal-close",onClick:s[0]||(s[0]=i=>a.$emit("close"))},"")]),r("div",UO,[e.success?(v(),m("div",zO,C(e.success),1)):(v(),m("div",HO,[r("p",VO,[s[6]||(s[6]=Ye(" Update the position of ",-1)),r("strong",null,C(e.assignment?.location?.name),1)]),e.assignment?.location?.lastLocationUpdate?(v(),m("div",GO," Last updated: "+C(o(e.assignment.location.lastLocationUpdate)),1)):M("",!0),e.userLocation?(v(),m("div",jO,[...s[7]||(s[7]=[r("svg",{class:"status-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),Ye(" GPS active ",-1)])])):M("",!0),r("div",ZO,[r("button",{onClick:s[1]||(s[1]=i=>a.$emit("update-gps")),class:"btn btn-primary btn-full",disabled:e.updating,style:Qe(e.accentButtonStyle)},[s[8]||(s[8]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),Ye(" "+C(e.updating?"Updating...":"Use current GPS location"),1)],12,qO)]),r("div",WO,[r("label",KO,[r("input",{type:"checkbox",checked:e.autoUpdateEnabled,onChange:s[2]||(s[2]=i=>a.$emit("toggle-auto-update"))},null,40,JO),s[9]||(s[9]=r("span",null,"Auto-update every 60 seconds",-1))]),r("p",YO,"Automatically updates the "+C(B(t).checkpoint)+" location using your GPS every minute.",1)]),r("div",XO,[r("button",{onClick:s[3]||(s[3]=i=>a.$emit("select-on-map")),class:"btn btn-secondary btn-full",disabled:e.updating},[...s[10]||(s[10]=[r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"})],-1),Ye(" Select location on map ",-1)])],8,QO)]),r("div",eB,[r("label",tB,"Or copy location from another "+C(B(t).checkpoint)+":",1),e.availableCheckpoints.length>0?(v(),m("div",nB,[(v(!0),m(Se,null,Ne(e.availableCheckpoints,i=>(v(),m("button",{key:i.id,onClick:l=>a.$emit("copy-from-checkpoint",i.id),class:"btn btn-secondary btn-checkpoint-source",disabled:e.updating},C(i.name),9,oB))),128))])):(v(),m("p",sB," No other "+C(B(t).checkpoints)+" available to copy from. ",1))]),e.error?(v(),m("div",aB,C(e.error),1)):M("",!0)]))]),r("div",iB,[r("button",{onClick:s[4]||(s[4]=i=>a.$emit("close")),class:"btn btn-secondary"}," Cancel ")])])])):M("",!0)]),_:1}))}},rB=je(lB,[["__scopeId","data-v-93b6a4a2"]]),cB={class:"contact-info"},uB={class:"contact-name-row"},dB={key:0,class:"primary-badge"},hB={class:"contact-name"},fB={key:0,class:"contact-notes-text"},pB={key:1,class:"contact-detail"},vB={key:2,class:"contact-detail"},mB={class:"contact-actions"},gB=["href"],yB=["href"],kB=["href"],_B={__name:"ContactCard",props:{name:{type:String,required:!0},role:{type:String,default:""},phone:{type:String,default:""},email:{type:String,default:""},notes:{type:String,default:""},isPrimary:{type:Boolean,default:!1}},setup(e){const t=e,o=["Emergency","Safety","Medical","First Aid"],a=G(()=>t.role?o.some(i=>t.role.toLowerCase().includes(i.toLowerCase())):!1),s=G(()=>t.role?t.role.replace(/([A-Z])/g," $1").replace(/^./,i=>i.toUpperCase()).trim():"");return(i,l)=>(v(),m("div",{class:ce(["contact-item",{"primary-contact":e.isPrimary}])},[r("div",cB,[r("div",uB,[e.isPrimary?(v(),m("span",dB,"")):M("",!0),r("span",hB,C(e.name),1),e.role?(v(),m("span",{key:1,class:ce(["contact-role-badge",{"emergency-role":a.value}])},C(s.value),3)):M("",!0)]),e.notes?(v(),m("div",fB,C(e.notes),1)):M("",!0),e.phone?(v(),m("div",pB,C(e.phone),1)):M("",!0),e.email?(v(),m("div",vB,C(e.email),1)):M("",!0)]),r("div",mB,[e.phone?(v(),m("a",{key:0,href:`tel:${e.phone}`,class:"contact-link"},[...l[0]||(l[0]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Ye(" Call ",-1)])],8,gB)):M("",!0),e.phone?(v(),m("a",{key:1,href:`sms:${e.phone}`,class:"contact-link"},[...l[1]||(l[1]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Ye(" Text ",-1)])],8,yB)):M("",!0),e.email?(v(),m("a",{key:2,href:`mailto:${e.email}`,class:"contact-link"},[...l[2]||(l[2]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Ye(" Email ",-1)])],8,kB)):M("",!0)])],2))}},tm=je(_B,[["__scopeId","data-v-6cf4fca2"]]),bB={key:0,class:"accordion-section"},wB={class:"accordion-title"},CB=["innerHTML"],LB={class:"accordion-icon"},SB={key:0,class:"accordion-content"},xB={key:0,class:"loading"},IB={key:1,class:"contact-list"},$B={__name:"MarshalContactsSection",props:{contacts:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){return(t,o)=>e.contacts.length>0||e.loading?(v(),m("div",bB,[r("button",{class:ce(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=a=>t.$emit("toggle"))},[r("span",wB,[r("span",{class:"section-icon",innerHTML:B(Yn)("contacts")},null,8,CB),Ye(" Your "+C(e.contacts.length===1?"contact":"contacts")+C(e.contacts.length>1?` (${e.contacts.length})`:""),1)]),r("span",LB,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",SB,[e.loading?(v(),m("div",xB,"Loading contacts...")):(v(),m("div",IB,[(v(!0),m(Se,null,Ne(e.contacts,a=>(v(),Ze(tm,{key:a.contactId,name:a.name,role:a.role,phone:a.phone,email:a.email,notes:a.notes,"is-primary":a.isPrimary},null,8,["name","role","phone","email","notes","is-primary"]))),128))]))])):M("",!0)])):M("",!0)}},TB=je($B,[["__scopeId","data-v-246302be"]]),MB={key:0,class:"accordion-section"},AB={class:"accordion-title"},EB=["innerHTML"],PB={class:"accordion-icon"},DB={key:0,class:"accordion-content"},RB={key:0,class:"loading-state"},OB={key:1,class:"empty-state"},BB={key:2,class:"incidents-list"},NB={__name:"MarshalIncidentsSection",props:{incidents:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle","select-incident"],setup(e){return(t,o)=>e.incidents.length>0||e.loading?(v(),m("div",MB,[r("button",{class:ce(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=a=>t.$emit("toggle"))},[r("span",AB,[r("span",{class:"section-icon",innerHTML:B(Yn)("incidents")},null,8,EB),Ye(" Your "+C(e.incidents.length===1?"incident":"incidents")+C(e.incidents.length>1?` (${e.incidents.length})`:""),1)]),r("span",PB,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",DB,[e.loading?(v(),m("div",RB," Loading incidents... ")):e.incidents.length===0?(v(),m("div",OB,[...o[1]||(o[1]=[r("p",null,"No incidents to show.",-1)])])):(v(),m("div",BB,[(v(!0),m(Se,null,Ne(e.incidents,a=>(v(),Ze(ql,{key:a.incidentId,incident:a,onSelect:s=>t.$emit("select-incident",a)},null,8,["incident","onSelect"]))),128))]))])):M("",!0)])):M("",!0)}},FB=je(NB,[["__scopeId","data-v-e84cbdf1"]]),UB={key:0,class:"accordion-section"},zB={class:"accordion-title"},HB=["innerHTML"],VB={class:"accordion-icon"},GB={key:0,class:"accordion-content"},jB={class:"event-details"},ZB={key:0,class:"event-detail-row"},qB={class:"detail-value"},WB={key:1,class:"event-description"},KB={class:"detail-value"},JB={__name:"MarshalEventDetailsSection",props:{eventDate:{type:String,default:null},description:{type:String,default:""},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){const t=o=>o?new Date(o).toLocaleString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"}):"";return(o,a)=>e.eventDate||e.description?(v(),m("div",UB,[r("button",{class:ce(["accordion-header",{active:e.isExpanded}]),onClick:a[0]||(a[0]=s=>o.$emit("toggle"))},[r("span",zB,[r("span",{class:"section-icon",innerHTML:B(Yn)("event")},null,8,HB),a[1]||(a[1]=Ye(" Event details ",-1))]),r("span",VB,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",GB,[r("div",jB,[e.eventDate?(v(),m("div",ZB,[a[2]||(a[2]=r("span",{class:"detail-label"},"Date and time",-1)),r("span",qB,C(t(e.eventDate)),1)])):M("",!0),e.description?(v(),m("div",WB,[a[3]||(a[3]=r("span",{class:"detail-label"},"Description",-1)),r("p",KB,C(e.description),1)])):M("",!0)])])):M("",!0)])):M("",!0)}},YB=je(JB,[["__scopeId","data-v-7c880ad1"]]),XB={class:"accordion-section"},QB={class:"accordion-title"},eN=["innerHTML"],tN={class:"accordion-icon"},nN={key:0,class:"accordion-content"},oN={key:0,class:"loading"},sN={key:1,class:"error"},aN={key:2,class:"empty-state"},iN={class:"checklist-section"},lN={key:0,class:"empty-state small"},rN={key:1,class:"my-jobs-list"},cN=["checked","disabled","onChange"],uN={key:0,class:"checklist-section"},dN={class:"checklist-section-title"},hN={key:0,class:"checklist-items"},fN={class:"item-checkbox"},pN=["checked","disabled","onChange"],vN={class:"item-content"},mN={key:0,class:"item-context"},gN={key:1,class:"completion-info"},yN={class:"completion-text"},kN={class:"completion-time"},_N={key:1,class:"checklist-groups"},bN=["onClick"],wN={class:"group-title"},CN={class:"group-status"},LN={class:"group-count"},SN={class:"group-expand-icon"},xN={key:0,class:"checklist-group-items"},IN={class:"item-checkbox"},$N=["checked","disabled","onChange"],TN={class:"item-content"},MN={key:0,class:"completion-info"},AN={class:"completion-text"},EN={class:"completion-time"},PN={__name:"MarshalChecklistSection",props:{loading:{type:Boolean,default:!1},error:{type:String,default:""},isExpanded:{type:Boolean,default:!1},isAreaLead:{type:Boolean,default:!1},myItems:{type:Array,default:()=>[]},areaItems:{type:Array,default:()=>[]},areaItemsWithLocalState:{type:Array,default:()=>[]},visibleItems:{type:Array,default:()=>[]},groupedItems:{type:Array,default:()=>[]},completedCount:{type:Number,default:0},saving:{type:Boolean,default:!1},effectiveGroupBy:{type:String,default:"none"},expandedGroup:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},getContextName:{type:Function,default:()=>""}},emits:["toggle","toggle-item","toggle-group"],setup(e){const{termsLower:t}=ht(),o=e,a=G(()=>o.visibleItems.length),s=i=>i?new Date(i).toLocaleString():"";return(i,l)=>(v(),m("div",XB,[r("button",{class:ce(["accordion-header",{active:e.isExpanded}]),onClick:l[0]||(l[0]=u=>i.$emit("toggle"))},[r("span",QB,[r("span",{class:"section-icon",innerHTML:B(Yn)("checklist")},null,8,eN),Ye(" Your "+C(B(t).checklists)+" ("+C(e.completedCount)+" of "+C(a.value)+" complete) ",1)]),r("span",tN,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",nN,[e.loading?(v(),m("div",oN,"Loading checklist...")):e.error?(v(),m("div",sN,C(e.error),1)):a.value===0?(v(),m("div",aN,[r("p",null,"No "+C(B(t).checklists)+" for you.",1)])):e.isAreaLead?(v(),m(Se,{key:3},[r("div",iN,[l[3]||(l[3]=r("h4",{class:"checklist-section-title"},"Your jobs",-1)),e.myItems.length===0?(v(),m("div",lN,[...l[2]||(l[2]=[r("p",null,"No jobs assigned to you.",-1)])])):(v(),m("div",rN,[(v(!0),m(Se,null,Ne(e.myItems,u=>(v(),m("div",{key:`${u.itemId}_${u.completionContextType}_${u.completionContextId}`,class:"my-job-item"},[r("input",{type:"checkbox",checked:u.isCompleted,disabled:e.saving,onChange:d=>i.$emit("toggle-item",u)},null,40,cN),r("span",{class:ce(["my-job-text",{completed:u.isCompleted}])},C(u.text),3)]))),128))]))]),e.areaItems.length>0?(v(),m("div",uN,[r("h4",dN,"Your "+C(B(t).area)+"'s jobs",1),Ae(id,{items:e.areaItemsWithLocalState,locations:e.locations,areas:e.areas,marshals:e.marshals,onToggleComplete:l[1]||(l[1]=u=>i.$emit("toggle-item",u))},null,8,["items","locations","areas","marshals"])])):M("",!0)],64)):(v(),m(Se,{key:4},[e.effectiveGroupBy==="none"?(v(),m("div",hN,[(v(!0),m(Se,null,Ne(e.visibleItems,u=>(v(),m("div",{key:`${u.itemId}_${u.completionContextType}_${u.completionContextId}`,class:ce(["checklist-item",{"item-completed":u.isCompleted}])},[r("div",fN,[r("input",{type:"checkbox",checked:u.isCompleted,disabled:!u.canBeCompletedByMe||e.saving,onChange:d=>i.$emit("toggle-item",u)},null,40,pN)]),r("div",vN,[r("div",{class:ce(["item-text",{"text-completed":u.isCompleted}])},C(u.text),3),e.getContextName(u)?(v(),m("div",mN,C(e.getContextName(u)),1)):M("",!0),u.isCompleted?(v(),m("div",gN,[r("span",yN," Completed by "+C(u.completedByActorName||"Unknown"),1),r("span",kN,C(s(u.completedAt)),1)])):M("",!0)])],2))),128))])):(v(),m("div",_N,[(v(!0),m(Se,null,Ne(e.groupedItems,u=>(v(),m("div",{key:u.key,class:"checklist-group"},[r("button",{class:ce(["checklist-group-header",{expanded:e.expandedGroup===u.key,"all-complete":u.completedCount===u.items.length}]),onClick:d=>i.$emit("toggle-group",u.key)},[r("span",wN,C(u.name),1),r("span",CN,[r("span",LN,C(u.completedCount)+"/"+C(u.items.length),1),r("span",SN,C(e.expandedGroup===u.key?"":"+"),1)])],10,bN),e.expandedGroup===u.key?(v(),m("div",xN,[(v(!0),m(Se,null,Ne(u.items,d=>(v(),m("div",{key:`${d.itemId}_${d.completionContextType}_${d.completionContextId}`,class:ce(["checklist-item",{"item-completed":d.isCompleted}])},[r("div",IN,[r("input",{type:"checkbox",checked:d.isCompleted,disabled:!d.canBeCompletedByMe||e.saving,onChange:f=>i.$emit("toggle-item",d)},null,40,$N)]),r("div",TN,[r("div",{class:ce(["item-text",{"text-completed":d.isCompleted}])},C(d.text),3),d.isCompleted?(v(),m("div",MN,[r("span",AN,C(d.completedByActorName||"Unknown"),1),r("span",EN,C(s(d.completedAt)),1)])):M("",!0)])],2))),128))])):M("",!0)]))),128))]))],64))])):M("",!0)]))}},DN=je(PN,[["__scopeId","data-v-b2878e4f"]]),RN={class:"accordion-section"},ON={class:"accordion-title"},BN=["innerHTML"],NN={class:"accordion-icon"},FN={key:0,class:"accordion-content"},UN={__name:"MarshalNotesSection",props:{eventId:{type:String,required:!0},notes:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},isExpanded:{type:Boolean,default:!1}},emits:["toggle","notes-changed"],setup(e){return(t,o)=>(v(),m("div",RN,[r("button",{class:ce(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=a=>t.$emit("toggle"))},[r("span",ON,[r("span",{class:"section-icon",innerHTML:B(Yn)("notes")},null,8,BN),Ye(" Your "+C(e.notes.length===1?"note":"notes")+C(e.notes.length>1?` (${e.notes.length})`:""),1)]),r("span",NN,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",FN,[Ae(mc,{"event-id":e.eventId,"all-notes":e.notes,locations:e.locations,areas:e.areas,assignments:e.assignments,"show-scope":!1,onNotesChanged:o[1]||(o[1]=a=>t.$emit("notes-changed"))},null,8,["event-id","all-notes","locations","areas","assignments"])])):M("",!0)]))}},zN=je(UN,[["__scopeId","data-v-10b7523a"]]),HN={class:"accordion-section"},VN={class:"accordion-title"},GN=["innerHTML"],jN={key:0,class:"location-status active"},ZN={key:1,class:"location-status"},qN={class:"accordion-icon"},WN={key:0,class:"accordion-content map-content"},KN={key:0,class:"map-selection-banner"},JN={class:"map-wrapper"},YN={__name:"MarshalRouteSection",props:{isExpanded:{type:Boolean,default:!1},userLocation:{type:Object,default:null},selectingLocation:{type:Boolean,default:!1},selectingLocationName:{type:String,default:""},locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},highlightLocationIds:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]}},emits:["toggle","cancel-select","map-click","location-click","action-click","visibility-change"],setup(e,{expose:t}){const{terms:o}=ht(),a=lo("marshalBranding",{headerStyle:{},headerTextColor:""}),s=ii({headerStyle:G(()=>Lr(a.headerStyle)),headerTextColor:G(()=>Lr(a.headerTextColor))}),i=$(null);return t({mapRef:i,recenterOnLocation:(l,u,d)=>i.value?.recenterOnLocation?.(l,u,d),recenterOnUserLocation:()=>i.value?.recenterOnUserLocation?.()}),(l,u)=>(v(),m("div",HN,[r("button",{class:ce(["accordion-header",{active:e.isExpanded}]),onClick:u[0]||(u[0]=d=>l.$emit("toggle"))},[r("span",VN,[r("span",{class:"section-icon",innerHTML:B(Yn)("course")},null,8,GN),Ye(" "+C(B(o).course)+" ",1),e.userLocation?(v(),m("span",jN,"GPS Active")):(v(),m("span",ZN,"GPS Inactive"))]),r("span",qN,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",WN,[e.selectingLocation?(v(),m("div",KN,[r("span",null,[u[7]||(u[7]=Ye("Click on the map to set the new location for ",-1)),r("strong",null,C(e.selectingLocationName),1)]),r("button",{onClick:u[1]||(u[1]=d=>l.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")])):M("",!0),r("div",JN,[Ae(li,{ref_key:"mapRef",ref:i,locations:e.locations,route:e.route,center:e.center,zoom:15,"user-location":e.userLocation,"highlight-location-ids":e.highlightLocationIds,"marshal-mode":!0,clickable:e.clickable,"show-fullscreen":!0,"fullscreen-title":B(o).course,"fullscreen-header-style":s.headerStyle,"fullscreen-header-text-color":s.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,class:ce({"selecting-location":e.selectingLocation}),height:"100%",onMapClick:u[3]||(u[3]=d=>l.$emit("map-click",d)),onLocationClick:u[4]||(u[4]=d=>l.$emit("location-click",d)),onActionClick:u[5]||(u[5]=d=>l.$emit("action-click",d)),onVisibilityChange:u[6]||(u[6]=d=>l.$emit("visibility-change",d))},vp({_:2},[e.selectingLocation?{name:"fullscreen-banner",fn:ze(()=>[r("span",null,[u[8]||(u[8]=Ye("Click on the map to set the new location for ",-1)),r("strong",null,C(e.selectingLocationName),1)]),r("button",{onClick:u[2]||(u[2]=d=>l.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")]),key:"0"}:void 0]),1032,["locations","route","center","user-location","highlight-location-ids","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions","class"])])])):M("",!0)]))}},XN=je(YN,[["__scopeId","data-v-97a9b1f4"]]),QN={class:"area-lead-content"},e9={key:0,class:"loading-state"},t9={key:1,class:"error-state"},n9={key:2,class:"empty-state"},o9={key:3,class:"checkpoint-accordion"},s9=["onClick"],a9={class:"checkpoint-header-content"},i9={class:"checkpoint-title-row"},l9={class:"checkpoint-name"},r9={key:0,class:"area-badge"},c9={key:0,class:"checkpoint-description-preview"},u9={class:"checkpoint-status-row"},d9={class:"status-badge marshals-status"},h9={key:0,class:"status-badge tasks-status"},f9={class:"accordion-icon"},p9={key:0,class:"checkpoint-accordion-content"},v9={class:"checkpoint-mini-map"},m9={class:"checkpoint-marshals-section"},g9={class:"marshals-label"},y9={key:0,class:"empty-state"},k9={key:1,class:"marshals-list"},_9=["onClick"],b9={class:"marshal-header"},w9={class:"marshal-name-row"},C9={class:"marshal-name"},L9={key:0,class:"task-count"},S9={class:"check-status-row"},x9=["onClick","disabled"],I9={key:0,class:"check-in-time"},$9={key:0},T9={key:1,class:"last-access-time"},M9={key:0,class:"checkpoint-tasks-section"},A9={class:"marshals-label"},E9={class:"tasks-list"},P9=["disabled","onChange"],D9={class:"task-text"},R9=["disabled","onChange"],O9={class:"task-text"},B9={key:0,class:"marshal-details-modal"},N9={class:"details-section"},F9={class:"contact-info"},U9={key:0,class:"contact-row"},z9=["href"],H9={key:1,class:"contact-row"},V9=["href"],G9={key:2,class:"no-contact"},j9={class:"details-section"},Z9={key:0,class:"checked-in-section"},q9={class:"checked-in-details"},W9={class:"check-time-detail"},K9={key:0,class:"check-method"},J9=["disabled"],Y9={key:1,class:"not-checked-in-section"},X9=["disabled"],Q9={key:2,class:"last-access-detail"},eF={class:"details-section"},tF={key:0,class:"no-tasks"},nF={key:1,class:"tasks-list modal-tasks"},oF=["disabled","onChange"],sF={class:"task-text"},aF={class:"details-section contact-actions-section"},iF={class:"contact-buttons"},lF=["href"],rF=["href"],cF=["href"],uF={__name:"AreaLeadSection",props:{eventId:{type:String,required:!0},areaIds:{type:Array,default:()=>[]},marshalId:{type:String,required:!0},route:{type:Array,default:()=>[]}},emits:["checklist-updated","loaded","checkin-updated"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=ht(),{updatePendingCount:i}=rd(),l=e,u=o,d=$(!1),f=$(null),p=$([]),g=$([]),y=$(null),k=$(!1),_=$(null),w=G(()=>{const U=new Set(l.areaIds);return U.size===0?[...g.value].sort((ee,de)=>Vs(ee.name,de.name)):g.value.filter(ee=>(ee.areaIds||[]).some(re=>U.has(re))).sort((ee,de)=>Vs(ee.name,de.name))}),S=(U,ee=60)=>U?U.length<=ee?U:U.substring(0,ee).trim()+"...":"",A=$(!1),T=$(null),x=$(null),P=async()=>{if(!(!l.eventId||l.areaIds.length===0)){if(d.value=!0,f.value=null,Rn()){try{const U=await _a(l.eventId);if(U?.areaLeadDashboard){p.value=U.areaLeadDashboard.areas||[],g.value=U.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(U){console.warn("Failed to load cached dashboard:",U)}f.value="Offline - no cached data available",d.value=!1;return}try{const U=await ga.getAreaLeadDashboard(l.eventId);p.value=U.data.areas||[],g.value=U.data.checkpoints||[];try{const ee=JSON.parse(JSON.stringify({areas:p.value,checkpoints:g.value}));await _a(l.eventId)?await br(l.eventId,"areaLeadDashboard",ee):await Rl(l.eventId,{areaLeadDashboard:ee})}catch(ee){console.warn("Failed to cache dashboard:",ee)}}catch(U){console.error("Failed to load area lead dashboard:",U);try{const ee=await _a(l.eventId);if(ee?.areaLeadDashboard){console.log("Loading area lead dashboard from cache after error"),p.value=ee.areaLeadDashboard.areas||[],g.value=ee.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(ee){console.warn("Failed to load cached dashboard:",ee)}f.value=U.response?.data?.message||"Failed to load dashboard"}finally{d.value=!1}}},O=U=>{y.value=y.value===U?null:U},F=U=>U.marshals.filter(ee=>ee.isCheckedIn).length,E=U=>{const ee=U.marshals.reduce((de,re)=>de+re.outstandingTaskCount,0);return U.outstandingTaskCount+ee},N=(U,ee)=>{T.value=U,x.value=ee,A.value=!0},D=()=>{A.value=!1,T.value=null,x.value=null},j=async(U,ee)=>{if(_.value)return;const de=U.assignmentId||U.id;if(!de){console.error("No assignment ID found for marshal:",U);return}_.value=U.marshalId;try{if(Rn())await ko("checkin_toggle",{eventId:l.eventId,assignmentId:de}),U.isCheckedIn=!0,U.checkInTime=new Date().toISOString(),U.checkInMethod="AreaLead (pending)",await i(),u("checkin-updated");else if(await ba.toggleCheckIn(l.eventId,de),await P(),u("checkin-updated"),T.value?.marshalId===U.marshalId&&x.value){const re=g.value.find(De=>De.checkpointId===x.value.checkpointId);if(re){const De=re.marshals.find(et=>et.marshalId===U.marshalId);De&&(T.value=De)}}}catch(re){console.error("Failed to check in marshal:",re),(Rn()||!re.response)&&(await ko("checkin_toggle",{eventId:l.eventId,assignmentId:de}),U.isCheckedIn=!0,U.checkInTime=new Date().toISOString(),U.checkInMethod="AreaLead (pending)",await i(),u("checkin-updated"))}finally{_.value=null}},R=async(U,ee)=>{if(k.value)return;k.value=!0;const re={marshalId:ee.marshals.length>0?ee.marshals[0].marshalId:l.marshalId,contextType:U.contextType,contextId:U.contextId};try{Rn()?(await ko("checklist_complete",{eventId:l.eventId,itemId:U.itemId,data:re}),ee.outstandingTasks=ee.outstandingTasks.filter(De=>De.itemId!==U.itemId),ee.outstandingTaskCount=Math.max(0,ee.outstandingTaskCount-1),await i(),u("checklist-updated")):(await Dt.complete(l.eventId,U.itemId,re),await P(),u("checklist-updated"))}catch(De){console.error("Failed to complete task:",De),(Rn()||!De.response)&&(await ko("checklist_complete",{eventId:l.eventId,itemId:U.itemId,data:re}),ee.outstandingTasks=ee.outstandingTasks.filter(et=>et.itemId!==U.itemId),ee.outstandingTaskCount=Math.max(0,ee.outstandingTaskCount-1),await i(),u("checklist-updated"))}finally{k.value=!1}},W=async(U,ee)=>{if(k.value)return;k.value=!0;const re={marshalId:ee.marshals.length>0?ee.marshals[0].marshalId:l.marshalId,contextType:U.contextType,contextId:U.contextId,actorMarshalId:l.marshalId};try{Rn()?(await ko("checklist_uncomplete",{eventId:l.eventId,itemId:U.itemId,data:re}),ee.completedTasks&&(ee.completedTasks=ee.completedTasks.filter(De=>De.itemId!==U.itemId)),ee.outstandingTasks||(ee.outstandingTasks=[]),ee.outstandingTasks.push(U),ee.outstandingTaskCount=(ee.outstandingTaskCount||0)+1,await i(),u("checklist-updated")):(await Dt.uncomplete(l.eventId,U.itemId,re),await P(),u("checklist-updated"))}catch(De){console.error("Failed to uncomplete task:",De),(Rn()||!De.response)&&(await ko("checklist_uncomplete",{eventId:l.eventId,itemId:U.itemId,data:re}),ee.completedTasks&&(ee.completedTasks=ee.completedTasks.filter(et=>et.itemId!==U.itemId)),ee.outstandingTasks||(ee.outstandingTasks=[]),ee.outstandingTasks.push(U),ee.outstandingTaskCount=(ee.outstandingTaskCount||0)+1,await i(),u("checklist-updated"))}finally{k.value=!1}},ne=async U=>{if(k.value||!T.value)return;k.value=!0;const ee={marshalId:T.value.marshalId,contextType:U.contextType,contextId:U.contextId};try{if(Rn())await ko("checklist_complete",{eventId:l.eventId,itemId:U.itemId,data:ee}),T.value.outstandingTasks=T.value.outstandingTasks.filter(de=>de.itemId!==U.itemId),T.value.outstandingTaskCount=Math.max(0,T.value.outstandingTaskCount-1),await i(),u("checklist-updated");else{if(await Dt.complete(l.eventId,U.itemId,ee),await P(),T.value&&x.value){const de=g.value.find(re=>re.checkpointId===x.value.checkpointId);if(de){const re=de.marshals.find(De=>De.marshalId===T.value.marshalId);re&&(T.value=re)}}u("checklist-updated")}}catch(de){console.error("Failed to complete task:",de),(Rn()||!de.response)&&(await ko("checklist_complete",{eventId:l.eventId,itemId:U.itemId,data:ee}),T.value.outstandingTasks=T.value.outstandingTasks.filter(re=>re.itemId!==U.itemId),T.value.outstandingTaskCount=Math.max(0,T.value.outstandingTaskCount-1),await i(),u("checklist-updated"))}finally{k.value=!1}},ue=U=>U?new Date(U).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",K=U=>U?new Date(U).toLocaleString():"",Q=U=>{if(!U)return"";const ee=new Date(U),re=new Date-ee,De=Math.floor(re/6e4),et=Math.floor(De/60),Je=Math.floor(et/24);return De<1?"just now":De<60?`${De}m ago`:et<24?`${et}h ago`:Je===1?"yesterday":Je<7?`${Je}d ago`:ee.toLocaleDateString()},he=U=>({GPS:"GPS",Manual:"Manual",Admin:"Admin",AreaLead:`${a.value.area} Lead`})[U]||U;return t({areas:p,checkpoints:g,loading:d,loadDashboard:P}),qe(()=>l.eventId,()=>{P()},{immediate:!0}),(U,ee)=>(v(),m("div",QN,[d.value?(v(),m("div",e9," Loading dashboard... ")):f.value?(v(),m("div",t9,[r("p",null,C(f.value),1),r("button",{onClick:P,class:"btn btn-secondary"},"Retry")])):w.value.length===0?(v(),m("div",n9,[r("p",null,"No "+C(B(s).checkpoints)+" in your "+C(B(s).areas)+".",1)])):(v(),m("div",o9,[(v(!0),m(Se,null,Ne(w.value,de=>(v(),m("div",{key:de.checkpointId,class:"checkpoint-accordion-section"},[r("button",{class:ce(["checkpoint-accordion-header",{active:y.value===de.checkpointId}]),onClick:re=>O(de.checkpointId)},[r("div",a9,[r("div",i9,[r("span",l9,C(de.name),1),de.areaName?(v(),m("span",r9,C(de.areaName),1)):M("",!0)]),de.description?(v(),m("div",c9,C(S(de.description)),1)):M("",!0),r("div",u9,[r("span",d9,C(F(de))+" / "+C(de.marshals.length)+" checked in ",1),E(de)>0?(v(),m("span",h9,C(E(de))+" tasks ",1)):M("",!0)])]),r("span",f9,C(y.value===de.checkpointId?"":"+"),1)],10,s9),y.value===de.checkpointId?(v(),m("div",p9,[r("div",v9,[Ae(li,{locations:[{id:de.checkpointId,name:de.name,description:de.description,latitude:de.latitude,longitude:de.longitude}],route:e.route,center:{lat:de.latitude,lng:de.longitude},zoom:16,"highlight-location-id":de.checkpointId,"marshal-mode":!0,height:"280px"},null,8,["locations","route","center","highlight-location-id"])]),r("div",m9,[r("div",g9,C(B(a).people)+" ("+C(de.marshals.length)+")",1),de.marshals.length===0?(v(),m("div",y9," No "+C(B(s).people)+" assigned to this "+C(B(s).checkpoint)+". ",1)):(v(),m("div",k9,[(v(!0),m(Se,null,Ne(de.marshals,re=>(v(),m("div",{key:re.marshalId,class:ce(["marshal-card",{"is-checked-in":re.isCheckedIn}]),onClick:De=>N(re,de)},[r("div",b9,[r("div",w9,[r("span",C9,C(re.name),1),re.outstandingTaskCount>0?(v(),m("span",L9,C(re.outstandingTaskCount)+" tasks ",1)):M("",!0)]),r("div",S9,[r("div",{class:ce(["check-status",{"checked-in":re.isCheckedIn}])},C(re.isCheckedIn?" Checked In":"Not Checked In"),3),r("button",{onClick:rt(De=>j(re),["stop"]),class:ce(["quick-checkin-btn",{"undo-btn":re.isCheckedIn}]),disabled:_.value===re.marshalId},C(_.value===re.marshalId?"...":re.isCheckedIn?"Undo":"Check In"),11,x9)])]),re.isCheckedIn&&re.checkInTime?(v(),m("div",I9,[Ye(C(ue(re.checkInTime))+" ",1),re.checkInMethod?(v(),m("span",$9," ("+C(he(re.checkInMethod))+")",1)):M("",!0)])):M("",!0),re.lastAccessedAt?(v(),m("div",T9," Last active: "+C(Q(re.lastAccessedAt)),1)):M("",!0)],10,_9))),128))]))]),de.outstandingTaskCount>0||de.completedTasks&&de.completedTasks.length>0?(v(),m("div",M9,[r("div",A9,C(B(a).checkpoint)+" tasks",1),r("div",E9,[(v(!0),m(Se,null,Ne(de.outstandingTasks,re=>(v(),m("div",{key:re.itemId,class:"task-item"},[r("input",{type:"checkbox",disabled:k.value,onChange:De=>R(re,de)},null,40,P9),r("span",D9,C(re.text),1)]))),128)),(v(!0),m(Se,null,Ne(de.completedTasks||[],re=>(v(),m("div",{key:`completed-${re.itemId}`,class:"task-item task-completed"},[r("input",{type:"checkbox",checked:"",disabled:k.value,onChange:De=>W(re,de)},null,40,R9),r("span",O9,C(re.text),1)]))),128))])])):M("",!0)])):M("",!0)]))),128))])),Ae(Vt,{show:A.value,title:T.value?.name||"Marshal Details",size:"large",onClose:D},{actions:ze(()=>[r("button",{onClick:D,class:"btn btn-secondary"},"Close")]),default:ze(()=>[T.value?(v(),m("div",B9,[r("div",N9,[ee[4]||(ee[4]=r("h4",null,"Contact Details",-1)),r("div",F9,[T.value.email?(v(),m("div",U9,[ee[2]||(ee[2]=r("span",{class:"contact-label"},"Email:",-1)),r("a",{href:`mailto:${T.value.email}`},C(T.value.email),9,z9)])):M("",!0),T.value.phoneNumber?(v(),m("div",H9,[ee[3]||(ee[3]=r("span",{class:"contact-label"},"Phone:",-1)),r("a",{href:`tel:${T.value.phoneNumber}`},C(T.value.phoneNumber),9,V9)])):M("",!0),!T.value.email&&!T.value.phoneNumber?(v(),m("div",G9," No contact details available. ")):M("",!0)])]),r("div",j9,[ee[8]||(ee[8]=r("h4",null,"Check-in Status",-1)),T.value.isCheckedIn?(v(),m("div",Z9,[r("div",q9,[ee[6]||(ee[6]=r("span",{class:"check-icon"},"",-1)),r("div",null,[ee[5]||(ee[5]=r("strong",null,"Checked In",-1)),r("p",W9,C(K(T.value.checkInTime)),1),T.value.checkInMethod?(v(),m("p",K9," Method: "+C(he(T.value.checkInMethod)),1)):M("",!0)])]),r("button",{onClick:ee[0]||(ee[0]=de=>j(T.value,x.value)),class:"btn btn-secondary undo-checkin-btn",disabled:_.value===T.value.marshalId},C(_.value===T.value.marshalId?"Undoing...":"Undo Check-in"),9,J9)])):(v(),m("div",Y9,[ee[7]||(ee[7]=r("div",{class:"not-checked-in"},[r("span",{class:"not-checked-icon"},""),r("span",null,"Not checked in")],-1)),r("button",{onClick:ee[1]||(ee[1]=de=>j(T.value,x.value)),class:"btn btn-primary check-in-btn",disabled:_.value===T.value.marshalId},C(_.value===T.value.marshalId?"Checking in...":"Check In"),9,X9)])),T.value.lastAccessedAt?(v(),m("div",Q9," Last active: "+C(Q(T.value.lastAccessedAt)),1)):M("",!0)]),r("div",eF,[r("h4",null,C(B(a).checklists)+" ("+C(T.value.outstandingTasks?.length||0)+" outstanding)",1),!T.value.outstandingTasks||T.value.outstandingTasks.length===0?(v(),m("div",tF," No outstanding tasks. ")):(v(),m("div",nF,[(v(!0),m(Se,null,Ne(T.value.outstandingTasks,de=>(v(),m("div",{key:de.itemId,class:"task-item"},[r("input",{type:"checkbox",disabled:k.value,onChange:re=>ne(de)},null,40,oF),r("span",sF,C(de.text),1)]))),128))]))]),r("div",aF,[r("div",iF,[T.value.phoneNumber?(v(),m("a",{key:0,href:`tel:${T.value.phoneNumber}`,class:"btn btn-primary"}," Call ",8,lF)):M("",!0),T.value.phoneNumber?(v(),m("a",{key:1,href:`sms:${T.value.phoneNumber}`,class:"btn btn-secondary"}," Text ",8,rF)):M("",!0),T.value.email?(v(),m("a",{key:2,href:`mailto:${T.value.email}`,class:"btn btn-secondary"}," Email ",8,cF)):M("",!0)])])])):M("",!0)]),_:1},8,["show","title"])]))}},dF=je(uF,[["__scopeId","data-v-067e0528"]]),hF={key:0,class:"accordion-section"},fF={class:"accordion-title"},pF=["innerHTML"],vF={class:"accordion-icon"},mF={key:0,class:"accordion-content area-lead-accordion-content"},gF={key:0,class:"area-filter-pills"},yF=["onClick"],kF={__name:"MarshalAreaLeadSection",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedFilters:{type:Set,default:()=>new Set},filteredAreaIds:{type:Array,default:()=>[]},eventId:{type:String,required:!0},marshalId:{type:String,default:""},route:{type:Array,default:()=>[]}},emits:["toggle","toggle-filter","checklist-updated"],setup(e,{expose:t}){const{termsLower:o}=ht(),a=$(null);return t({areaLeadRef:a}),(s,i)=>e.isAreaLead?(v(),m("div",hF,[r("button",{class:ce(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=l=>s.$emit("toggle"))},[r("span",fF,[r("span",{class:"section-icon",innerHTML:B(Yn)("area")},null,8,pF),Ye(" Your "+C(e.areas.length===1?B(o).area:B(o).areas)+C(e.areas.length>1?` (${e.areas.length})`:""),1)]),r("span",vF,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",mF,[e.areas.length>1?(v(),m("div",gF,[(v(!0),m(Se,null,Ne(e.areas,l=>(v(),m("button",{key:l.areaId,class:ce(["area-filter-pill",{selected:e.selectedFilters.has(l.areaId)}]),style:Qe(e.selectedFilters.has(l.areaId)?{backgroundColor:l.color||"#667eea",borderColor:l.color||"#667eea"}:{}),onClick:u=>s.$emit("toggle-filter",l.areaId)},C(l.name),15,yF))),128))])):M("",!0),Ae(dF,{ref_key:"areaLeadRef",ref:a,"event-id":e.eventId,"area-ids":e.filteredAreaIds,"marshal-id":e.marshalId,route:e.route,onChecklistUpdated:i[1]||(i[1]=l=>s.$emit("checklist-updated"))},null,8,["event-id","area-ids","marshal-id","route"])])):M("",!0)])):M("",!0)}},_F=je(kF,[["__scopeId","data-v-9278e6a8"]]),bF={key:0,class:"accordion-section"},wF={class:"accordion-title"},CF=["innerHTML"],LF={class:"accordion-icon"},SF={key:0,class:"accordion-content area-lead-marshals-content"},xF={class:"area-lead-marshals-list"},IF=["onClick"],$F={class:"marshal-header-info"},TF={class:"marshal-name-row"},MF={class:"marshal-name"},AF={class:"marshal-meta"},EF={class:"marshal-checkpoint"},PF={key:0,class:"marshal-task-count"},DF={class:"accordion-icon"},RF={key:0,class:"area-lead-marshal-content"},OF={class:"marshal-checkin-section"},BF={key:0,class:"marshal-contact-section"},NF=["href"],FF=["href"],UF={key:1,class:"marshal-tasks-section"},zF={class:"tasks-label"},HF={class:"tasks-list"},VF=["checked","disabled","onChange"],GF={class:"task-text"},jF={key:2,class:"no-tasks-message"},ZF={__name:"MarshalMarshalsList",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},marshals:{type:Array,default:()=>[]},expandedMarshalId:{type:String,default:null},checkingInMarshalId:{type:String,default:null},savingTask:{type:Boolean,default:!1}},emits:["toggle","toggle-marshal","check-in","toggle-task"],setup(e){const{terms:t,termsLower:o}=ht(),a=s=>!s||s.length===0?"":s.length===1?s[0].name:s.map(i=>i.name).join(", ");return(s,i)=>e.isAreaLead&&e.marshals.length>0?(v(),m("div",bF,[r("button",{class:ce(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=l=>s.$emit("toggle"))},[r("span",wF,[r("span",{class:"section-icon",innerHTML:B(Yn)("marshal")},null,8,CF),Ye(" Your "+C(e.marshals.length===1?B(o).person:B(o).people)+C(e.marshals.length>1?` (${e.marshals.length})`:""),1)]),r("span",LF,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",SF,[r("div",xF,[(v(!0),m(Se,null,Ne(e.marshals,l=>(v(),m("div",{key:l.marshalId,class:"area-lead-marshal-item"},[r("button",{class:ce(["area-lead-marshal-header",{active:e.expandedMarshalId===l.marshalId,"is-checked-in":l.isCheckedIn}]),onClick:u=>s.$emit("toggle-marshal",l.marshalId)},[r("div",$F,[r("div",TF,[r("span",MF,C(l.name),1),r("span",{class:ce(["check-status-badge",{"checked-in":l.isCheckedIn}])},C(l.isCheckedIn?"":""),3)]),r("div",AF,[r("span",EF,C(a(l.checkpoints)),1),l.totalTaskCount>0?(v(),m("span",PF,C(l.completedTaskCount)+" / "+C(l.totalTaskCount)+" "+C(B(o).checklists)+" complete ",1)):M("",!0)])]),r("span",DF,C(e.expandedMarshalId===l.marshalId?"":"+"),1)],10,IF),e.expandedMarshalId===l.marshalId?(v(),m("div",RF,[r("div",OF,[Ae(Hr,{"is-checked-in":l.isCheckedIn,"check-in-time":l.checkInTime,"check-in-method":l.checkInMethod,"checked-in-by":l.checkedInBy,"marshal-name":l.marshalName,"is-loading":e.checkingInMarshalId===l.id,onToggle:u=>s.$emit("check-in",l)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"])]),l.email||l.phoneNumber?(v(),m("div",BF,[l.phoneNumber?(v(),m("a",{key:0,href:`tel:${l.phoneNumber}`,class:"contact-link"},C(l.phoneNumber),9,NF)):M("",!0),l.email?(v(),m("a",{key:1,href:`mailto:${l.email}`,class:"contact-link"},C(l.email),9,FF)):M("",!0)])):M("",!0),l.allTasks.length>0?(v(),m("div",UF,[r("div",zF,C(B(t).checklists),1),r("div",HF,[(v(!0),m(Se,null,Ne(l.allTasks,u=>(v(),m("div",{key:`${u.itemId}-${u.contextId}`,class:ce(["task-item",{"task-completed":u.isCompleted}])},[r("input",{type:"checkbox",checked:u.isCompleted,disabled:e.savingTask,onChange:d=>s.$emit("toggle-task",u,l)},null,40,VF),r("span",GF,C(u.text),1)],2))),128))])])):(v(),m("div",jF," No "+C(B(o).checklists)+" assigned. ",1))])):M("",!0)]))),128))])])):M("",!0)])):M("",!0)}},qF=je(ZF,[["__scopeId","data-v-49a1421b"]]),WF={class:"checkpoint-note-header"},KF={key:0,class:"pin-icon",title:"Pinned"},JF={class:"checkpoint-note-title"},YF={key:0,class:"checkpoint-note-content"},XF={__name:"NoteCard",props:{title:{type:String,required:!0},content:{type:String,default:""},priority:{type:String,default:"Normal"},isPinned:{type:Boolean,default:!1}},setup(e){const t=e,o=G(()=>(t.priority||"Normal").toLowerCase());return(a,s)=>(v(),m("div",{class:ce(["checkpoint-note-item",o.value])},[r("div",WF,[e.isPinned?(v(),m("span",KF,"")):M("",!0),r("span",{class:ce(["priority-indicator",o.value])},null,2),r("strong",JF,C(e.title),1),r("span",{class:ce(["priority-badge",o.value])},C(e.priority),3)]),e.content?(v(),m("div",YF,C(e.content),1)):M("",!0)],2))}},QF=je(XF,[["__scopeId","data-v-5f2df920"]]),e7={class:"checkpoint-accordion-section"},t7={class:"checkpoint-header-content"},n7={class:"checkpoint-title-row"},o7=["innerHTML"],s7={key:0,class:"checkpoint-check-icon"},a7={class:"checkpoint-name"},i7={key:1,class:"area-badge"},l7={key:2,class:"checkpoint-time-badge"},r7={key:0,class:"checkpoint-description-preview"},c7={class:"accordion-icon"},u7={key:0,class:"checkpoint-accordion-content"},d7={key:0,class:"checkpoint-mini-map"},h7={viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",style:{"margin-right":"0.5rem"}},f7={class:"my-checkin-section"},p7={key:0,class:"check-in-error"},v7={class:"checkpoint-marshals"},m7={class:"marshals-label"},g7={key:0,class:"marshals-list"},y7={key:0,class:"check-badge"},k7={key:1,class:"marshals-list-expanded"},_7=["onClick"],b7={class:"marshal-name-text"},w7={class:"marshal-status-icons"},C7={key:0,class:"check-badge"},L7={class:"expand-icon"},S7={key:0,class:"marshal-details-panel"},x7={class:"detail-row"},I7={key:0,class:"detail-row"},$7={key:1,class:"detail-row"},T7={key:2,class:"detail-row"},M7=["href"],A7={key:3,class:"detail-row"},E7=["href"],P7={key:4,class:"contact-buttons-mini"},D7=["href"],R7=["href"],O7=["href"],B7={key:5,class:"checkpoint-marshal-checkin"},N7={key:1,class:"checkpoint-area-contacts"},F7={class:"marshals-label"},U7={class:"contact-list"},z7={key:2,class:"checkpoint-notes"},H7={class:"checkpoint-notes-list"},V7={key:3,class:"dynamic-location-section"},G7={class:"dynamic-location-header"},j7={class:"dynamic-badge"},Z7={key:0,class:"last-update"},q7={class:"dynamic-location-actions"},W7=["disabled"],K7=["title"],J7={__name:"CheckpointCard",props:{assignment:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},userLocation:{type:Object,default:null},toolbarActions:{type:Array,default:()=>[]},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},isCheckingIn:{type:Boolean,default:!1},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},isAreaLeadForCheckpoint:{type:Boolean,default:!1},expandedMarshalId:{type:String,default:null},notes:{type:Array,default:()=>[]},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1}},emits:["toggle","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update"],setup(e,{expose:t}){const{terms:o,termsLower:a}=ht(),s=lo("marshalBranding",{headerStyle:{},headerTextColor:""}),i=ii({headerStyle:G(()=>Lr(s.headerStyle)),headerTextColor:G(()=>Lr(s.headerTextColor))}),l=e,u=$(null),d=G(()=>l.assignment.location?.isDynamic);t({mapRef:u});const f=_=>{const w=_?.iconType||"checkpoint",S=_?.iconColor||"#667eea",A={checkpoint:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>`,flag:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"/></svg>`,star:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>`,water:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M12 2c-5.33 4.55-8 8.48-8 11.8 0 4.98 3.8 8.2 8 8.2s8-3.22 8-8.2c0-3.32-2.67-7.25-8-11.8z"/></svg>`,medical:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4v4z"/></svg>`};return A[w]||A.checkpoint},p=(_,w)=>{const S=A=>A?new Date(A).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"";return _&&w?`${S(_)} - ${S(w)}`:_?`from ${S(_)}`:w?`until ${S(w)}`:""},g=_=>_?new Date(_).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"",y=_=>({manual:"Manual",qr:"QR Code",gps:"GPS",admin:"Admin"})[_]||_,k=_=>_?new Date(_).toLocaleString():"";return(_,w)=>(v(),m("div",e7,[r("button",{class:ce(["checkpoint-accordion-header",{active:e.isExpanded,"checked-in":e.assignment.effectiveIsCheckedIn}]),onClick:w[0]||(w[0]=S=>_.$emit("toggle"))},[r("div",t7,[r("div",n7,[r("span",{class:"checkpoint-icon",innerHTML:f(e.assignment.location)},null,8,o7),e.assignment.effectiveIsCheckedIn?(v(),m("span",s7,"")):M("",!0),r("span",a7,C(e.assignment.location?.name||e.assignment.locationName),1),e.assignment.areaName?(v(),m("span",i7,C(e.assignment.areaName),1)):M("",!0),e.assignment.location?.startTime||e.assignment.location?.endTime?(v(),m("span",l7,C(p(e.assignment.location.startTime,e.assignment.location.endTime)),1)):M("",!0)]),e.assignment.location?.description?(v(),m("div",r7,C(e.assignment.location.description),1)):M("",!0)]),r("span",c7,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",u7,[e.assignment.location?(v(),m("div",d7,[Ae(li,{ref_key:"mapRef",ref:u,locations:e.allLocations,route:e.route,center:{lat:e.assignment.location.latitude,lng:e.assignment.location.longitude},zoom:16,"user-location":e.userLocation,"highlight-location-id":e.assignment.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:e.hasDynamicAssignment,"show-fullscreen":!0,"fullscreen-title":e.assignment.location?.name||e.assignment.locationName,"fullscreen-header-style":i.headerStyle,"fullscreen-header-text-color":i.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,height:"280px",onMapClick:w[2]||(w[2]=S=>_.$emit("map-click",S)),onLocationClick:w[3]||(w[3]=S=>_.$emit("location-click",S)),onActionClick:w[4]||(w[4]=S=>_.$emit("action-click",S)),onVisibilityChange:w[5]||(w[5]=S=>_.$emit("visibility-change",S))},vp({_:2},[e.assignment.location?.isDynamic?{name:"fullscreen-footer",fn:ze(()=>[r("button",{class:"btn btn-primary",onClick:w[1]||(w[1]=S=>_.$emit("update-location"))},[(v(),m("svg",h7,[...w[9]||(w[9]=[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"},null,-1)])])),w[10]||(w[10]=Ye(" Update location ",-1))])]),key:"0"}:void 0]),1032,["locations","route","center","user-location","highlight-location-id","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions"])])):M("",!0),r("div",f7,[Ae(Hr,{"is-checked-in":e.assignment.effectiveIsCheckedIn,"check-in-time":e.assignment.checkInTime,"check-in-method":e.assignment.checkInMethod,"checked-in-by":e.assignment.checkedInBy,"marshal-name":e.currentMarshalName,"is-loading":e.isCheckingIn,onToggle:w[6]||(w[6]=S=>_.$emit("check-in"))},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading"]),e.checkInError?(v(),m("div",p7,C(e.checkInError),1)):M("",!0)]),r("div",v7,[r("div",m7,C(B(o).people)+":",1),e.isAreaLeadForCheckpoint?(v(),m("div",k7,[(v(!0),m(Se,null,Ne(e.assignment.allMarshals,S=>(v(),m("div",{key:S.marshalId,class:ce(["marshal-card-mini",{"is-you":S.marshalId===e.currentMarshalId,"checked-in":S.effectiveIsCheckedIn,expanded:e.expandedMarshalId===S.marshalId}])},[r("button",{class:"marshal-card-header",onClick:A=>_.$emit("toggle-marshal",S.marshalId)},[r("span",b7,C(S.marshalName)+C(S.marshalId===e.currentMarshalId?" (you)":""),1),r("span",w7,[S.effectiveIsCheckedIn?(v(),m("span",C7,"")):M("",!0),r("span",L7,C(e.expandedMarshalId===S.marshalId?"":"+"),1)])],8,_7),e.expandedMarshalId===S.marshalId?(v(),m("div",S7,[r("div",x7,[w[11]||(w[11]=r("span",{class:"detail-label"},"Status:",-1)),r("span",{class:ce(S.effectiveIsCheckedIn?"status-checked-in":"status-not-checked-in")},C(S.effectiveIsCheckedIn?"Checked in":"Not checked in"),3)]),S.effectiveIsCheckedIn&&S.checkInTime?(v(),m("div",I7,[w[12]||(w[12]=r("span",{class:"detail-label"},"Check-in time:",-1)),r("span",null,C(g(S.checkInTime)),1)])):M("",!0),S.checkInMethod?(v(),m("div",$7,[w[13]||(w[13]=r("span",{class:"detail-label"},"Method:",-1)),r("span",null,C(y(S.checkInMethod)),1)])):M("",!0),S.email?(v(),m("div",T7,[w[14]||(w[14]=r("span",{class:"detail-label"},"Email:",-1)),r("a",{href:"mailto:"+S.email},C(S.email),9,M7)])):M("",!0),S.phoneNumber?(v(),m("div",A7,[w[15]||(w[15]=r("span",{class:"detail-label"},"Phone:",-1)),r("a",{href:"tel:"+S.phoneNumber},C(S.phoneNumber),9,E7)])):M("",!0),S.email||S.phoneNumber?(v(),m("div",P7,[S.phoneNumber?(v(),m("a",{key:0,href:"tel:"+S.phoneNumber,class:"btn btn-sm btn-primary"},"Call",8,D7)):M("",!0),S.phoneNumber?(v(),m("a",{key:1,href:"sms:"+S.phoneNumber,class:"btn btn-sm btn-secondary"},"Text",8,R7)):M("",!0),S.email?(v(),m("a",{key:2,href:"mailto:"+S.email,class:"btn btn-sm btn-secondary"},"Email",8,O7)):M("",!0)])):M("",!0),S.marshalId!==e.currentMarshalId?(v(),m("div",B7,[Ae(Hr,{"is-checked-in":S.effectiveIsCheckedIn,"check-in-time":S.checkInTime,"check-in-method":S.checkInMethod,"checked-in-by":S.checkedInBy,"marshal-name":S.marshalName,"is-loading":e.checkingInMarshalId===S.id,onToggle:A=>_.$emit("marshal-check-in",S)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"])])):M("",!0)])):M("",!0)],2))),128))])):(v(),m("div",g7,[(v(!0),m(Se,null,Ne(e.assignment.allMarshals,S=>(v(),m("span",{key:S.marshalId,class:ce(["marshal-tag",{"is-you":S.marshalId===e.currentMarshalId,"checked-in":S.effectiveIsCheckedIn}])},[Ye(C(S.marshalName)+C(S.marshalId===e.currentMarshalId?" (you)":"")+" ",1),S.effectiveIsCheckedIn?(v(),m("span",y7,"")):M("",!0)],2))),128))]))]),e.assignment.areaContacts.length>0?(v(),m("div",N7,[r("div",F7,C(B(o).area)+" contacts:",1),r("div",U7,[(v(!0),m(Se,null,Ne(e.assignment.areaContacts,S=>(v(),Ze(tm,{key:S.marshalId,name:S.marshalName,role:S.role,phone:S.phone,email:S.email},null,8,["name","role","phone","email"]))),128))])])):M("",!0),e.notes.length>0?(v(),m("div",z7,[w[16]||(w[16]=r("div",{class:"marshals-label"},"Notes:",-1)),r("div",H7,[(v(!0),m(Se,null,Ne(e.notes,S=>(v(),Ze(QF,{key:S.noteId,title:S.title,content:S.content,priority:S.priority,"is-pinned":S.isPinned},null,8,["title","content","priority","is-pinned"]))),128))])])):M("",!0),d.value?(v(),m("div",V7,[r("div",G7,[r("span",j7,"Dynamic "+C(e.assignment.location.resolvedCheckpointTerm||B(a).checkpoint),1),e.assignment.location.lastLocationUpdate?(v(),m("span",Z7," Last updated: "+C(k(e.assignment.location.lastLocationUpdate)),1)):M("",!0)]),r("div",q7,[r("button",{onClick:w[7]||(w[7]=S=>_.$emit("update-location")),class:"btn btn-update-location",disabled:e.updatingLocation},[...w[17]||(w[17]=[r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1),Ye(" Update location ",-1)])],8,W7),r("button",{onClick:w[8]||(w[8]=S=>_.$emit("toggle-auto-update")),class:ce(["btn btn-auto-update",{active:e.autoUpdateEnabled}]),title:e.autoUpdateEnabled?"Stop auto-updating":"Auto-update every 60 seconds"},[w[18]||(w[18]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})],-1)),Ye(" "+C(e.autoUpdateEnabled?"Stop":"Auto"),1)],10,K7)])])):M("",!0)])):M("",!0)]))}},Y7=je(J7,[["__scopeId","data-v-01c1d6e0"]]),X7={class:"accordion-section"},Q7={class:"accordion-title"},eU=["innerHTML"],tU={class:"accordion-icon"},nU={key:0,class:"accordion-content assignments-accordion-content"},oU={key:0,class:"empty-state"},sU={key:1,class:"checkpoint-accordion"},aU={__name:"MarshalAssignmentsSection",props:{isExpanded:{type:Boolean,default:!1},assignments:{type:Array,default:()=>[]},expandedCheckpointId:{type:String,default:null},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},userLocation:{type:Object,default:null},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},checkingInId:{type:String,default:null},checkingInAssignmentId:{type:String,default:null},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},expandedMarshalId:{type:String,default:null},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},getToolbarActions:{type:Function,default:()=>[]},isAreaLeadForAreas:{type:Function,default:()=>!1},getNotesForCheckpoint:{type:Function,default:()=>[]}},emits:["toggle","toggle-checkpoint","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update"],setup(e,{expose:t}){const{termsLower:o}=ht(),a={},s=(i,l)=>{l?a[i]=l:delete a[i]};return t({checkpointRefs:a}),(i,l)=>(v(),m("div",X7,[r("button",{class:ce(["accordion-header",{active:e.isExpanded}]),onClick:l[0]||(l[0]=u=>i.$emit("toggle"))},[r("span",Q7,[r("span",{class:"section-icon",innerHTML:B(Yn)("checkpoint")},null,8,eU),Ye(" Your "+C(e.assignments.length===1?B(o).checkpoint:B(o).checkpoints)+C(e.assignments.length>1?` (${e.assignments.length})`:""),1)]),r("span",tU,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",nU,[e.assignments.length===0?(v(),m("div",oU,[r("p",null,"You don't have any "+C(B(o).checkpoint)+" assignments yet.",1)])):(v(),m("div",sU,[(v(!0),m(Se,null,Ne(e.assignments,u=>(v(),Ze(Y7,{key:u.id,ref_for:!0,ref:d=>s(u.id,d),assignment:u,"is-expanded":e.expandedCheckpointId===u.id,"all-locations":e.allLocations,route:e.route,"user-location":e.userLocation,"toolbar-actions":e.getToolbarActions(u.id),"has-dynamic-assignment":e.hasDynamicAssignment,"current-marshal-id":e.currentMarshalId,"current-marshal-name":e.currentMarshalName,"is-checking-in":e.checkingInId===u.id,"check-in-error":e.checkingInAssignmentId===u.id?e.checkInError:"","checking-in-marshal-id":e.checkingInMarshalId,"is-area-lead-for-checkpoint":e.isAreaLeadForAreas(u.areaIds),"expanded-marshal-id":e.expandedMarshalId,notes:e.getNotesForCheckpoint(u.locationId,u.areaIds),"updating-location":e.updatingLocation,"auto-update-enabled":e.autoUpdateEnabled,onToggle:d=>i.$emit("toggle-checkpoint",u.id),onMapClick:l[1]||(l[1]=d=>i.$emit("map-click",d)),onLocationClick:l[2]||(l[2]=d=>i.$emit("location-click",d)),onActionClick:d=>i.$emit("action-click",u,d),onVisibilityChange:d=>i.$emit("visibility-change",u.id,d),onUpdateLocation:d=>i.$emit("update-location",u),onCheckIn:d=>i.$emit("check-in",u),onToggleMarshal:l[3]||(l[3]=d=>i.$emit("toggle-marshal",d)),onMarshalCheckIn:d=>i.$emit("marshal-check-in",d,u.locationId),onToggleAutoUpdate:d=>i.$emit("toggle-auto-update",u)},null,8,["assignment","is-expanded","all-locations","route","user-location","toolbar-actions","has-dynamic-assignment","current-marshal-id","current-marshal-name","is-checking-in","check-in-error","checking-in-marshal-id","is-area-lead-for-checkpoint","expanded-marshal-id","notes","updating-location","auto-update-enabled","onToggle","onActionClick","onVisibilityChange","onUpdateLocation","onCheckIn","onMarshalCheckIn","onToggleAutoUpdate"]))),128))]))])):M("",!0)]))}},iU=je(aU,[["__scopeId","data-v-d18e3955"]]);function lU(e){const t=G(()=>{const f=e.value?.brandingPageGradientStart||rn.pageGradientStart,p=e.value?.brandingPageGradientEnd||rn.pageGradientEnd;return{background:`linear-gradient(135deg, ${f} 0%, ${p} 100%)`}}),o=G(()=>{const f=e.value?.brandingHeaderGradientStart||rn.headerGradientStart,p=e.value?.brandingHeaderGradientEnd||rn.headerGradientEnd;return{background:`linear-gradient(135deg, ${f} 0%, ${p} 100%)`}}),a=G(()=>{const f=e.value?.brandingHeaderGradientStart||rn.headerGradientStart,p=e.value?.brandingHeaderGradientEnd||rn.headerGradientEnd;return Kv(f,p)}),s=G(()=>e.value?.brandingAccentColor||rn.accentColor),i=G(()=>Au(s.value)),l=G(()=>({background:s.value,color:i.value})),u=G(()=>e.value?.brandingLogoUrl||""),d=G(()=>e.value?.brandingLogoPosition||"left");return{pageBackgroundStyle:t,headerStyle:o,headerTextColor:a,accentColor:s,accentTextColor:i,accentButtonStyle:l,brandingLogoUrl:u,brandingLogoPosition:d}}function rU(){const e=$(null),t=$(null);let o=null;const a=()=>{if(!("geolocation"in navigator)){console.warn("Geolocation not supported");return}console.log("Starting location tracking..."),o=navigator.geolocation.watchPosition(i=>{e.value={lat:i.coords.latitude,lng:i.coords.longitude},t.value=Date.now()},i=>{console.warn("Geolocation error:",{1:"Location permission denied. Please allow location access in your browser settings.",2:"Location unavailable. Make sure GPS is enabled on your device.",3:"Location request timed out. Please try again."}[i.code]||i.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},s=()=>{o!==null&&(navigator.geolocation.clearWatch(o),o=null)};return $n(()=>{s()}),{userLocation:e,locationLastUpdated:t,startLocationTracking:a,stopLocationTracking:s}}function cU({eventId:e,currentMarshalId:t,currentPerson:o,assignments:a,areaLeadAreaIds:s,isAreaLead:i,allLocations:l,areas:u,terms:d,termsLower:f,areaLeadRef:p,areaLeadCheckpoints:g,sectionLastLoadedAt:y,updateCachedField:k,updatePendingCount:_}){const w=$([]),S=$(!1),A=$(null),T=$(!1),x=$("person"),P=$(null),O=G(()=>w.value.filter(U=>U.isCompleted&&["OnePerCheckpoint","OnePerArea","OneLeadPerArea"].includes(U.matchedScope)?U.completedByActorId===t.value:!0)),F=G(()=>O.value.filter(U=>U.isCompleted).length),E=G(()=>{const U=a.value.map(ee=>ee.locationId);return O.value.filter(ee=>ee.completionContextType==="Personal"?ee.contextOwnerMarshalId===t.value:ee.completionContextType==="Checkpoint"?U.includes(ee.completionContextId):ee.completionContextType==="Area"?s.value.includes(ee.completionContextId):!0)}),N=G(()=>{if(!i.value)return[];const U=a.value.map(ee=>ee.locationId);return O.value.filter(ee=>ee.completionContextType==="Personal"?ee.contextOwnerMarshalId!==t.value:ee.completionContextType==="Checkpoint"?!U.includes(ee.completionContextId):ee.completionContextType==="Area"?!s.value.includes(ee.completionContextId):!1)}),D=G(()=>E.value.map(U=>({...U,localIsCompleted:U.isCompleted,isModified:!1}))),j=G(()=>N.value.map(U=>({...U,localIsCompleted:U.isCompleted,isModified:!1}))),R=G(()=>{const U=p.value?.checkpoints||g.value||[];if(U.length===0)return[];const ee=[],de=new Set;for(const re of U)for(const De of re.marshals||[])de.has(De.marshalId)||(de.add(De.marshalId),ee.push(De));return ee}),W=G(()=>{if(i.value)return"none";const U=O.value,ee=new Set;for(const de of U)de.completionContextType==="Checkpoint"&&de.completionContextId&&ee.add(de.completionContextId);return ee.size>1?"checkpoint":"none"}),ne=G(()=>{const U=O.value,ee={};for(const de of U){let re,De;de.completionContextType==="Checkpoint"&&de.completionContextId?(re=`checkpoint_${de.completionContextId}`,De=l.value.find(Je=>Je.id===de.completionContextId)?.name||"Unknown "+d.value.checkpoint):de.completionContextType==="Area"&&de.completionContextId?(re=`area_${de.completionContextId}`,De=u.value.find(Je=>Je.id===de.completionContextId)?.name||"Unknown "+d.value.area):(re="personal",De="Personal"),ee[re]||(ee[re]={key:re,name:De,items:[],completedCount:0}),ee[re].items.push(de),de.isCompleted&&ee[re].completedCount++}return Object.values(ee).sort((de,re)=>de.name.localeCompare(re.name,void 0,{numeric:!0,sensitivity:"base"}))}),ue=U=>{P.value=P.value===U?null:U},K=U=>{if(!U.completionContextType||!U.completionContextId)return null;if(U.completionContextType==="Checkpoint"){const ee=l.value.find(re=>re.id===U.completionContextId);if(!ee)return null;const de=ee.description?` - ${ee.description}`:"";return`At ${f.value.checkpoint} ${ee.name}${de}`}if(U.completionContextType==="Area"){const ee=u.value.find(de=>de.id===U.completionContextId);return ee?`At ${f.value.area} ${ee.name}`:null}return U.completionContextType==="Personal"?"Personal item":null},Q=async(U=!1)=>{if(!t.value){console.warn("No marshal ID, skipping checklist load");return}U||(S.value=!0),A.value=null;try{const ee=e.value;console.log("Fetching checklist for marshal:",t.value);let re=(await Dt.getMarshalChecklist(ee,t.value)).data||[];if(i.value&&s.value.length>0){console.log("Fetching area checklists for areas:",s.value);const De=s.value.map(Fe=>Dt.getAreaChecklist(ee,Fe).catch(Ke=>(console.warn(`Failed to fetch checklist for area ${Fe}:`,Ke),{data:[]}))),et=await Promise.all(De),Je=new Map;for(const Fe of re){const Ke=`${Fe.itemId}_${Fe.completionContextType}_${Fe.completionContextId}`;Je.set(Ke,Fe)}for(const Fe of et)for(const Ke of Fe.data||[]){const _e=`${Ke.itemId}_${Ke.completionContextType}_${Ke.completionContextId}`;Je.has(_e)||Je.set(_e,Ke)}re=Array.from(Je.values()),console.log("Merged checklist items:",re.length)}w.value=re,y?.value&&(y.value.checklist=Date.now()),console.log("Checklist loaded:",w.value.length,"items")}catch(ee){console.error("Failed to load checklist:",ee.response?.status,ee.response?.data),A.value=ee.response?.data?.message||"Failed to load checklist"}finally{U||(S.value=!1)}};return{checklistItems:w,checklistLoading:S,checklistError:A,savingChecklist:T,checklistGroupBy:x,expandedChecklistGroup:P,visibleChecklistItems:O,completedChecklistCount:F,myChecklistItems:E,areaChecklistItems:N,myChecklistItemsWithLocalState:D,areaChecklistItemsWithLocalState:j,areaMarshalsForChecklist:R,effectiveChecklistGroupBy:W,groupedChecklistItems:ne,loadChecklist:Q,handleToggleChecklist:async U=>{if(T.value)return;T.value=!0;const ee=e.value,de={marshalId:U.contextOwnerMarshalId||t.value,contextType:U.completionContextType,contextId:U.completionContextId,actorMarshalId:t.value};try{U.isCompleted?Rn()?(await ko("checklist_uncomplete",{eventId:ee,itemId:U.itemId,data:de}),U.isCompleted=!1,U.completedAt=null,U.completedByActorName=null,_&&await _()):(await Dt.uncomplete(ee,U.itemId,de),await Q(!0)):Rn()?(await ko("checklist_complete",{eventId:ee,itemId:U.itemId,data:de}),U.isCompleted=!0,U.completedAt=new Date().toISOString(),U.completedByActorName=o.value?.name||"You",_&&await _()):(await Dt.complete(ee,U.itemId,de),await Q(!0)),k&&await k(ee,"checklist",JSON.parse(JSON.stringify(w.value)))}catch(re){if(console.error("Failed to toggle checklist item:",re),Rn()||!re.response){const De=U.isCompleted?"checklist_uncomplete":"checklist_complete";await ko(De,{eventId:ee,itemId:U.itemId,data:de}),U.isCompleted?(U.isCompleted=!1,U.completedAt=null,U.completedByActorName=null):(U.isCompleted=!0,U.completedAt=new Date().toISOString(),U.completedByActorName=o.value?.name||"You"),_&&await _(),k&&await k(ee,"checklist",JSON.parse(JSON.stringify(w.value)))}}finally{T.value=!1}},toggleChecklistGroup:ue,getContextName:K}}function uU({eventId:e,allLocations:t,userLocation:o,locationLastUpdated:a}){const s=$(!1),i=$(null),l=$(null),u=$(null),d=$(!1),f=$(!1),p=$(!1);let g=null,y=null;const k=ue=>ue?.isDynamic===!0||ue?.IsDynamic===!0,_=(ue,K,Q,he)=>{const U=t.value.find(ee=>ee.id===ue);U&&(U.latitude=K,U.longitude=Q,U.lastLocationUpdate=he)},w=ue=>{i.value=ue,l.value=null,u.value=null,s.value=!0},S=()=>{s.value=!1,i.value=null,l.value=null,u.value=null,p.value=!1},A=()=>{s.value=!1,p.value=!0},T=()=>{p.value=!1,s.value=!0},x=async(ue,K,Q,he,U=null)=>{d.value=!0;try{const ee=e.value,de={latitude:K,longitude:Q,sourceType:he};U&&(de.sourceCheckpointId=U);const re=await Jn.updatePosition(ee,ue,de);re.data.success&&(f.value&&D(),_(ue,re.data.latitude,re.data.longitude,re.data.lastLocationUpdate))}catch(ee){console.error("Failed to update location:",ee),ee.response?.status===403?alert("You do not have permission to update this location."):alert("Failed to update location. Please try again.")}finally{d.value=!1}},P=async()=>{if(i.value){d.value=!0,l.value=null;try{let ue,K;if(o.value&&a?.value&&Date.now()-a.value<3e4&&(ue=o.value.lat,K=o.value.lng),!ue||!K){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const ee=await new Promise((de,re)=>{navigator.geolocation.getCurrentPosition(de,re,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4})});ue=ee.coords.latitude,K=ee.coords.longitude}const Q=e.value,he=i.value.locationId,U=await Jn.updatePosition(Q,he,{latitude:ue,longitude:K,sourceType:"gps"});U.data.success&&(u.value="Location updated successfully!",_(he,U.data.latitude,U.data.longitude,U.data.lastLocationUpdate),setTimeout(()=>S(),1500))}catch(ue){console.error("Failed to update location with GPS:",ue),ue.response?.status===403?l.value="You do not have permission to update this location.":ue.code===1?l.value="Location access denied. Please enable location permissions.":ue.code===2?l.value="Unable to determine your location. Please try again.":ue.code===3||ue.message?.includes("Timeout")?l.value="GPS timed out. Please ensure location services are enabled and try again.":l.value="Failed to update location. Please try again."}finally{d.value=!1}}},O=async ue=>{if(!i.value)return;const K=t.value.find(Q=>Q.id===ue);if(!K){l.value="Source checkpoint not found.";return}d.value=!0,l.value=null;try{const Q=e.value,he=i.value.locationId,U=await Jn.updatePosition(Q,he,{latitude:K.latitude,longitude:K.longitude,sourceType:"checkpoint",sourceCheckpointId:ue});U.data.success&&(f.value&&D(),u.value=`Location copied from ${K.name}!`,_(he,U.data.latitude,U.data.longitude,U.data.lastLocationUpdate),setTimeout(()=>S(),1500))}catch(Q){console.error("Failed to copy location from checkpoint:",Q),Q.response?.status===403?l.value="You do not have permission to update this location.":l.value="Failed to update location. Please try again."}finally{d.value=!1}},F=async(ue,K)=>{if(i.value){d.value=!0,l.value=null;try{const Q=e.value,he=i.value.locationId,U=await Jn.updatePosition(Q,he,{latitude:ue,longitude:K,sourceType:"manual"});U.data.success&&(u.value="Location updated successfully!",_(he,U.data.latitude,U.data.longitude,U.data.lastLocationUpdate),setTimeout(()=>S(),1500))}catch(Q){console.error("Failed to update location manually:",Q),Q.response?.status===403?l.value="You do not have permission to update this location.":l.value="Failed to update location. Please try again."}finally{d.value=!1}}},E=async ue=>{if(!(!ue||!("geolocation"in navigator)))try{const K=await new Promise((U,ee)=>{navigator.geolocation.getCurrentPosition(U,ee,{enableHighAccuracy:!0,timeout:15e3})}),Q=e.value,he=ue.locationId;await Jn.updatePosition(Q,he,{latitude:K.coords.latitude,longitude:K.coords.longitude,sourceType:"gps"}),_(he,K.coords.latitude,K.coords.longitude,new Date().toISOString())}catch(K){console.warn("Auto-update location failed:",K)}},N=ue=>{f.value=!0,E(ue),g=setInterval(()=>{E(ue)},6e4)},D=()=>{f.value=!1,g&&(clearInterval(g),g=null)};return{showLocationUpdateModal:s,updatingLocationFor:i,locationUpdateError:l,locationUpdateSuccess:u,updatingLocation:d,autoUpdateEnabled:f,selectingLocationOnMap:p,isDynamicCheckpoint:k,openLocationUpdateModal:w,closeLocationUpdateModal:S,startMapLocationSelect:A,cancelMapLocationSelect:T,updateDynamicCheckpointLocation:x,updateLocationWithGps:P,updateLocationFromCheckpoint:O,updateLocationManually:F,toggleAutoUpdate:ue=>{f.value?D():N(ue)},startAutoUpdate:N,stopAutoUpdate:D,startDynamicCheckpointPolling:()=>{y||!t.value.some(K=>K.isDynamic||K.IsDynamic)||(y=setInterval(async()=>{try{const K=e.value,Q=await Jn.getDynamicCheckpoints(K);if(Q.data&&Array.isArray(Q.data))for(const he of Q.data){const U=t.value.find(ee=>ee.id===he.checkpointId);U&&(U.latitude=he.latitude,U.longitude=he.longitude,U.lastLocationUpdate=he.lastLocationUpdate)}}catch(K){console.warn("Failed to poll dynamic checkpoints:",K)}},6e4))},stopDynamicCheckpointPolling:()=>{y&&(clearInterval(y),y=null)},handleMapClickForLocation:ue=>{p.value&&i.value&&(x(i.value.locationId,ue.lat,ue.lng,"manual"),p.value=!1)}}}function dU({eventId:e,assignments:t,allLocations:o,areaLeadRef:a,areaLeadCheckpoints:s,areaLeadMarshalDataVersion:i,updatePendingCount:l,updateCachedField:u}){const d=$(null),f=$(null),p=$(null),g=$(!1),y=$(null),k=$(new Set),_=P=>{if(!P)return!0;const O=new Date(P);return(new Date-O)/(1e3*60*60)>24},w=P=>P?new Date(P).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",S=P=>{if(!P)return"";switch(P){case"GPS":return"GPS";case"Manual":return"Manual";case"AreaLead":return"By area lead";default:return P}},A=P=>{k.value.add(P),g.value=!1,y.value=null},T=async(P,O=!0,F=null)=>{d.value=P.id,f.value=P.id,p.value=null;const E=e.value,N=P.effectiveIsCheckedIn!==void 0?P.effectiveIsCheckedIn:P.isCheckedIn&&!_(P.checkInTime),D=N?"check-out":"check-in",j=!N;let R=null,W=null,ne="Manual";if(O&&!N&&"geolocation"in navigator)try{const K=await new Promise((Q,he)=>{navigator.geolocation.getCurrentPosition(Q,he,{enableHighAccuracy:!0,timeout:5e3})});R=K.coords.latitude,W=K.coords.longitude,ne="GPS"}catch(K){console.log("GPS unavailable, using manual check-in:",K.message)}const ue={latitude:R,longitude:W,action:D};try{if(Rn()){await ko("checkin_toggle",{eventId:E,assignmentId:P.id,gpsData:ue});const K=t.value.findIndex(Q=>Q.id===P.id);if(K!==-1&&(t.value[K]={...t.value[K],isCheckedIn:j,checkInTime:j?new Date().toISOString():null,checkInMethod:j?`${ne} (pending)`:null,checkInLatitude:R,checkInLongitude:W}),F){const Q=o.value.find(he=>he.id===F);if(Q?.assignments){const he=Q.assignments.find(U=>U.id===P.id||U.marshalId===P.marshalId);he&&(he.isCheckedIn=j,he.checkInTime=j?new Date().toISOString():null)}}l&&await l(),u&&await u(E,"locations",o.value)}else{const K=await ba.toggleCheckIn(E,P.id,ue),Q=t.value.findIndex(he=>he.id===P.id);if(Q!==-1&&(t.value[Q]=K.data),F){const he=o.value.find(U=>U.id===F);if(he?.assignments){const U=he.assignments.find(ee=>ee.id===P.id||ee.marshalId===P.marshalId);U&&Object.assign(U,K.data)}}}F&&a?.value?.loadDashboard&&await a.value.loadDashboard(),i&&i.value++}catch(K){if(Rn()||!K.response){await ko("checkin_toggle",{eventId:E,assignmentId:P.id,gpsData:ue});const Q=t.value.findIndex(he=>he.id===P.id);Q!==-1&&(t.value[Q]={...t.value[Q],isCheckedIn:j,checkInTime:j?new Date().toISOString():null,checkInMethod:j?"Manual (pending)":null}),l&&await l()}else K.response?.data?.message?p.value=K.response.data.message:K.message?p.value=K.message:p.value=`Failed to ${D}. Please try again.`}finally{d.value=null,f.value=null}};return{checkingIn:d,checkingInAssignment:f,checkInError:p,showCheckInReminderModal:g,checkInReminderCheckpoint:y,dismissedCheckInReminders:k,isCheckInStale:_,formatCheckInTime:w,formatCheckInMethod:S,handleCheckInToggle:T,handleAreaLeadMarshalCheckIn:async P=>{const F=(a?.value?.checkpoints||s?.value||[]).find(j=>j.marshals?.some(R=>R.marshalId===P.marshalId));if(!F){console.error("Could not find checkpoint for marshal:",P);return}const E=F.marshals.find(j=>j.marshalId===P.marshalId);if(!E)return;const N=E.assignmentId||E.id;if(!N){console.error("No assignment ID found for marshal:",E);return}const D={id:N,marshalId:P.marshalId,isCheckedIn:P.isCheckedIn,effectiveIsCheckedIn:P.isCheckedIn};await T(D,!1,F.locationId)},dismissCheckInReminder:A}}function hU({eventId:e,currentMarshalId:t,isAreaLead:o,areaLeadAreaIds:a,sectionLastLoadedAt:s,showMessage:i}){const l=$([]),u=$(!1),d=$(null),f=$(!1),p=$(!1),g=$(""),y=$(!1),k=$(!1),_=$(!1),w=G(()=>l.value.filter(N=>N.status==="open"||N.status==="acknowledged"||N.status==="in_progress").length),S=async()=>{const N=e.value;u.value=!0;try{const D=new Map;if(o.value&&a.value.length>0)for(const j of a.value)try{const W=(await ps.getForArea(N,j)).data.incidents||[];for(const ne of W)D.set(ne.incidentId,ne)}catch(R){console.warn(`Failed to load incidents for area ${j}:`,R)}try{const R=(await ps.getAll(N)).data.incidents||[];for(const W of R)W.reportedBy?.marshalId===t.value&&D.set(W.incidentId,W)}catch(j){console.debug("Could not load all incidents:",j)}l.value=Array.from(D.values()).sort((j,R)=>new Date(R.incidentTime||R.createdAt)-new Date(j.incidentTime||j.createdAt)),s?.value&&(s.value.incidents=Date.now()),console.log("My incidents loaded:",l.value.length)}catch(D){console.error("Failed to load incidents:",D)}finally{u.value=!1}},A=async N=>{_.value=!0;try{await ps.create(e.value,N),k.value=!1,S(),i&&i("Incident Reported","An administrator will review it shortly.")}catch(D){console.error("Failed to report incident:",D),i&&i("Error",D.response?.data?.message||"Failed to report incident. Please try again.")}finally{_.value=!1}},T=N=>{d.value=N,f.value=!0},x=()=>{f.value=!1,d.value=null},P=async({incidentId:N,status:D})=>{try{await ps.updateStatus(e.value,N,{status:D});const j=l.value.find(R=>R.incidentId===N);j&&(j.status=D),d.value?.incidentId===N&&(d.value.status=D)}catch(j){console.error("Failed to update incident status:",j),i&&i("Error","Failed to update status. Please try again.")}},O=()=>{g.value="",p.value=!0},F=()=>{p.value=!1,g.value=""};return{myIncidents:l,incidentsLoading:u,selectedIncident:d,showIncidentDetail:f,showAddIncidentNoteModal:p,incidentNoteText:g,submittingIncidentNote:y,showReportIncident:k,reportingIncident:_,openIncidentsCount:w,loadMyIncidents:S,handleReportIncident:A,openIncidentDetail:T,closeIncidentDetail:x,handleIncidentStatusChange:P,openAddIncidentNoteModal:O,closeAddIncidentNoteModal:F,submitIncidentNote:async()=>{if(!(!g.value.trim()||!d.value)){y.value=!0;try{await ps.addNote(e.value,d.value.incidentId,g.value.trim()),F(),S();const N=await ps.get(e.value,d.value.incidentId);d.value=N.data}catch(N){console.error("Failed to add note:",N),i&&i("Error","Failed to add note. Please try again.")}finally{y.value=!1}}}}}const ff='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><circle cx="12" cy="12" r="4"/><path d="M13 4.069V2h-2v2.069A8.01 8.01 0 0 0 4.069 11H2v2h2.069A8.008 8.008 0 0 0 11 19.931V22h2v-2.069A8.007 8.007 0 0 0 19.931 13H22v-2h-2.069A8.008 8.008 0 0 0 13 4.069zM12 18c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6z"/></svg>',pf='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>';function fU({userLocation:e,assignmentsWithDetails:t,courseMapRef:o}){const{termsLower:a}=ht(),s=$({userLocationInView:!1,highlightedLocationInView:!1,highlightedLocationsVisibility:{}}),i=$(-1),l=$({}),u={},d=G(()=>t.value.filter(S=>S.location?.latitude&&S.location?.longitude&&!(S.location.latitude===0&&S.location.longitude===0))),f=G(()=>{const S=[];return e.value&&!s.value.userLocationInView&&S.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:ff}),d.value.length>0&&!s.value.highlightedLocationInView&&S.push({id:"recenter-checkpoint",label:"My "+a.value.checkpoint,icon:"custom",customIcon:pf}),S}),p=S=>{const A=s.value,T=A.userLocationInView!==S.userLocationInView||A.highlightedLocationInView!==S.highlightedLocationInView,x=JSON.stringify(A.highlightedLocationsVisibility)!==JSON.stringify(S.highlightedLocationsVisibility||{});(T||x)&&(s.value={...S,highlightedLocationsVisibility:S.highlightedLocationsVisibility||{}})},g=()=>{const S=d.value;if(S.length===0)return null;if(S.length===1)return i.value=0,S[0];const A=s.value.highlightedLocationsVisibility||{},T=[];for(let O=0;O<S.length;O++){const F=S[O].locationId;A[F]===!1&&T.push(O)}if(T.length===0)return i.value=0,S[0];if(T.length===1)return i.value=T[0],S[T[0]];const x=i.value;let P=-1;for(const O of T)if(O>x){P=O;break}return P===-1&&(P=T[0]),i.value=P,S[P]};return{courseMapVisibility:s,courseMapActions:f,handleCourseMapVisibilityChange:p,handleCourseMapAction:({actionId:S})=>{if(S==="recenter-user"&&e.value)o.value?.recenterOnUserLocation();else if(S==="recenter-checkpoint"){const A=g();A?.location&&o.value?.recenterOnLocation(A.location.latitude,A.location.longitude)}},checkpointMapVisibility:l,checkpointMapRefs:u,getCheckpointMapActions:S=>{const A=[],T=l.value[S]||{userLocationInView:!1,highlightedLocationInView:!1};return e.value&&!T.userLocationInView&&A.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:ff}),T.highlightedLocationInView||A.push({id:"recenter-checkpoint",label:a.value.checkpoint.charAt(0).toUpperCase()+a.value.checkpoint.slice(1),icon:"custom",customIcon:pf}),A},handleCheckpointMapVisibilityChange:(S,A)=>{const T=l.value[S];(!T||T.userLocationInView!==A.userLocationInView||T.highlightedLocationInView!==A.highlightedLocationInView)&&(l.value={...l.value,[S]:A})},handleCheckpointMapAction:(S,{actionId:A})=>{const T=u[S.id];A==="recenter-user"&&e.value?T?.recenterOnUserLocation():A==="recenter-checkpoint"&&S.location&&T?.recenterOnLocation(S.location.latitude,S.location.longitude)}}}function pU({eventId:e,currentMarshalId:t,areaLeadRef:o,areaLeadCheckpoints:a,loadChecklist:s}){const i=$(null),l=$(!1),u=$(0),d=g=>{i.value=i.value===g?null:g},f=G(()=>{u.value;const g=o?.value?.checkpoints||a?.value||[],y=new Map;for(const k of g)for(const _ of k.marshals||[]){y.has(_.marshalId)||y.set(_.marshalId,{..._,checkpoints:[],allTasks:[],totalTaskCount:0,completedTaskCount:0});const w=y.get(_.marshalId);if(w.checkpoints.push({checkpointId:k.checkpointId,name:k.name,description:k.description}),_.outstandingTasks)for(const S of _.outstandingTasks)w.allTasks.push({...S,isCompleted:!1,checkpointName:k.name}),w.totalTaskCount++;if(_.completedTasks)for(const S of _.completedTasks)w.allTasks.push({...S,isCompleted:!0,checkpointName:k.name}),w.totalTaskCount++,w.completedTaskCount++}return Array.from(y.values()).sort((k,_)=>(k.name||"").localeCompare(_.name||"",void 0,{sensitivity:"base"}))});return{expandedAreaLeadMarshal:i,savingAreaLeadMarshalTask:l,areaLeadMarshalDataVersion:u,allAreaLeadMarshals:f,toggleAreaLeadMarshalExpansion:d,toggleAreaLeadMarshalTask:async(g,y)=>{if(l.value)return;l.value=!0;const k={marshalId:y.marshalId,contextType:g.contextType,contextId:g.contextId,actorMarshalId:t.value};try{g.isCompleted?await Dt.uncomplete(e.value,g.itemId,k):await Dt.complete(e.value,g.itemId,k),o?.value?.loadDashboard&&await o.value.loadDashboard(),u.value++,s&&await s(!0)}catch(_){console.error("Failed to toggle area lead marshal task:",_)}finally{l.value=!1}}}}function vU({router:e,route:t,onAuthSuccess:o}){const a=$(!1),s=$(!1),i=$(null),l=$(null),u=$(null),d=$(null),f=G(()=>l.value?.name||null),p=G(()=>d.value?.eventRoles?d.value.eventRoles.filter(D=>D.role==="EventAreaLead").flatMap(D=>D.areaIds||[]):[]),g=G(()=>p.value.length>0),y=G(()=>d.value?.eventRoles?d.value.eventRoles.some(N=>N.role==="EventAdmin"):!1),k=G(()=>d.value?.authMethod==="SecureEmailLink"&&y.value),_=G(()=>d.value?.authMethod==="MarshalMagicCode"&&y.value);let w=null;const S=()=>{w||(w=setInterval(async()=>{if(d.value?.marshalId)try{await ms.getMe(t.params.eventId)}catch(N){console.debug("Heartbeat failed:",N)}},300*1e3))},A=()=>{w&&(clearInterval(w),w=null)},T=async(N,D,j=!1)=>{s.value=!0,i.value=null,console.log("Authenticating with magic code:",{eventId:N,code:D,isReauth:j}),Kc();try{_o("marshal",N);const R=await ms.marshalLogin(N,D);if(console.log("Auth response:",R.data),R.data.success){Ph(N,{token:R.data.sessionToken,marshalId:R.data.marshalId,marshalName:R.data.person?.name||null}),sk(N,R.data.marshalId,D),l.value=R.data.person,u.value=R.data.marshalId,a.value=!0,console.log("Authenticated as marshal:",u.value,l.value?.name);try{const W=await ms.getMe(N);d.value=W.data,console.log("User claims:",d.value)}catch(W){console.warn("Failed to fetch claims:",W)}e.replace({path:t.path,query:{}}),S(),o&&await o()}else i.value=R.data.message||"Authentication failed"}catch(R){console.error("Authentication failed:",R),i.value=R.response?.data?.message||"Invalid or expired login link"}finally{s.value=!1}};return{isAuthenticated:a,authenticating:s,loginError:i,currentPerson:l,currentMarshalId:u,userClaims:d,currentMarshalName:f,areaLeadAreaIds:p,isAreaLead:g,isEventAdmin:y,canSwitchToAdmin:k,isAdminButNeedsReauth:_,authenticateWithMagicCode:T,checkExistingSession:async N=>{_o("marshal",N);const D=Or(N),j=D?.marshalId,R=j?rv(N,j):null;if(!D?.token)return R?(console.log("No session but have stored code, attempting re-authentication..."),Kc(),await T(N,R,!0),a.value):!1;try{const W=await ms.getMe(N);if(W.data&&W.data.marshalId)return d.value=W.data,l.value={personId:W.data.personId,name:W.data.personName,email:W.data.personEmail},u.value=W.data.marshalId,a.value=!0,sv(N,W.data.marshalId),S(),!0}catch(W){if(console.log("Session validation failed, attempting re-authentication...",W),R)try{if(Kc(),await T(N,R,!0),a.value)return console.log("Re-authentication successful"),!0}catch(ne){console.error("Re-authentication failed:",ne)}D?.sessionKey&&yu(D.sessionKey)}return!1},handleClose:N=>{A(),_o(null),a.value=!1,l.value=null,u.value=null,d.value=null,N&&N(),e.push("/marshal")},handleRemoveSession:async N=>{const[D]=N.split(":");_o("marshal",D);try{await ms.logout()}catch{}yu(N),_o(null)},updateSessionEventInfo:(N,D,j)=>{const R=Or(N);R&&R.marshalId&&Ph(N,{marshalId:R.marshalId,marshalName:R.marshalName,token:R.token,eventName:D,eventDate:j})},switchToAdminMode:()=>{e.push(`/admin/events/${t.params.eventId}`)},startHeartbeat:S,stopHeartbeat:A}}const mU={key:0,class:"header-logo-cover"},gU=["src"],yU={key:2,class:"header-logo header-logo-left"},kU=["src"],_U={class:"header-center"},bU={key:0},wU={key:1,class:"header-event-date"},CU={key:0,class:"header-actions"},LU={key:3,class:"header-logo header-logo-right"},SU=["src"],xU={class:"container"},IU={key:0,class:"selection-card"},$U={key:1,class:"selection-card"},TU={key:0,class:"loading"},MU={key:2,class:"selection-card error-card"},AU={class:"error"},EU={key:3,class:"dashboard"},PU={key:0,class:"welcome-bar"},DU={class:"welcome-info"},RU={key:0,class:"welcome-email"},OU={key:0,class:"mode-switch"},BU={key:1,class:"mode-switch"},NU={class:"accordion"},FU={class:"add-note-form"},UU={class:"modal-actions"},zU=["disabled"],HU=6e4,VU={__name:"MarshalView",setup(e){const{terms:t,termsLower:o}=ht(),{updatePendingCount:a}=rd(),s=cc(),i=Hi(),l=G(()=>s.params.eventId),u={onAuthSuccess:null},{isAuthenticated:d,authenticating:f,loginError:p,currentPerson:g,currentMarshalId:y,currentMarshalName:k,areaLeadAreaIds:_,isAreaLead:w,canSwitchToAdmin:S,isAdminButNeedsReauth:A,authenticateWithMagicCode:T,checkExistingSession:x,handleClose:P,updateSessionEventInfo:O,switchToAdminMode:F,stopHeartbeat:E}=vU({router:i,route:s,onAuthSuccess:()=>u.onAuthSuccess?.()}),N=$(new Set),D=G(()=>_.value.length?Q.value.filter(Ee=>_.value.includes(Ee.id)).map(Ee=>({areaId:Ee.id,name:Ee.name,color:Ee.color})).sort((Ee,$e)=>(Ee.name||"").localeCompare($e.name||"",void 0,{numeric:!0,sensitivity:"base"})):[]);qe(D,Ee=>{Ee.length>0&&N.value.size===0&&(N.value=new Set(Ee.map($e=>$e.areaId)))},{immediate:!0});const j=G(()=>_.value.filter(Ee=>N.value.has(Ee))),R=Ee=>{const $e=new Set(N.value);$e.has(Ee)?$e.delete(Ee):$e.add(Ee),N.value=$e},W=G(()=>{const Ee=_n.value.find(at=>at.isCheckedIn&&!No(at.checkInTime)&&at.location);if(Ee?.location)return{id:Ee.location.id,locationId:Ee.location.id,name:Ee.location.name,description:Ee.location.description};if(Tn.value){const at=_n.value.find(vt=>vt.id===Tn.value);if(at?.location)return{id:at.location.id,locationId:at.location.id,name:at.location.name,description:at.location.description}}const $e=_n.value[0];return $e?.location?{id:$e.location.id,locationId:$e.location.id,name:$e.location.name,description:$e.location.description}:null}),ne=$(null),ue=$([]),K=$([]),Q=$([]),he=$(!0),{pageBackgroundStyle:U,headerStyle:ee,headerTextColor:de,accentColor:re,accentTextColor:De,accentButtonStyle:et,brandingLogoUrl:Je,brandingLogoPosition:Fe}=lU(ne);gl("marshalBranding",{headerStyle:ee,headerTextColor:de,accentButtonStyle:et,accentColor:re,accentTextColor:De});const Ke=$("assignments"),_e=$({checklist:0,notes:0,incidents:0,eventContacts:0}),Ve=$([]),pe=$([]),Le=$(null),Pe=G(()=>Le.value?.areaLeadRef?.value),{checklistItems:q,checklistLoading:X,checklistError:fe,savingChecklist:we,expandedChecklistGroup:Y,visibleChecklistItems:V,completedChecklistCount:J,myChecklistItems:Me,areaChecklistItems:Re,areaChecklistItemsWithLocalState:Ce,areaMarshalsForChecklist:be,effectiveChecklistGroupBy:me,groupedChecklistItems:Z,loadChecklist:oe,handleToggleChecklist:le,toggleChecklistGroup:Te,getContextName:Oe}=cU({eventId:l,currentMarshalId:y,currentPerson:g,assignments:K,areaLeadAreaIds:_,isAreaLead:w,allLocations:ue,areas:Q,terms:t,termsLower:o,areaLeadRef:Pe,areaLeadCheckpoints:Ve,sectionLastLoadedAt:_e,updateCachedField:br,updatePendingCount:a}),{userLocation:Be,locationLastUpdated:Xe,startLocationTracking:mt,stopLocationTracking:_t}=rU(),{showLocationUpdateModal:bt,updatingLocationFor:Mt,locationUpdateError:Ct,locationUpdateSuccess:Bt,updatingLocation:Nt,autoUpdateEnabled:zn,selectingLocationOnMap:Xn,openLocationUpdateModal:pn,closeLocationUpdateModal:Gt,startMapLocationSelect:gt,cancelMapLocationSelect:Qn,updateDynamicCheckpointLocation:Hn,updateLocationWithGps:eo,updateLocationFromCheckpoint:vn,toggleAutoUpdate:jt,stopAutoUpdate:_s,startDynamicCheckpointPolling:to,stopDynamicCheckpointPolling:Co}=uU({eventId:l,allLocations:ue,userLocation:Be,locationLastUpdated:Xe}),ae=()=>{gt(),Ke.value="map"},{expandedAreaLeadMarshal:ie,savingAreaLeadMarshalTask:ve,areaLeadMarshalDataVersion:ot,allAreaLeadMarshals:Ge,toggleAreaLeadMarshalExpansion:St,toggleAreaLeadMarshalTask:qt}=pU({eventId:l,currentMarshalId:y,areaLeadRef:Pe,areaLeadCheckpoints:Ve,loadChecklist:oe}),{checkingIn:Yt,checkingInAssignment:Oo,checkInError:uo,showCheckInReminderModal:Bo,checkInReminderCheckpoint:Vn,dismissedCheckInReminders:xa,isCheckInStale:No,handleCheckInToggle:Lo,handleAreaLeadMarshalCheckIn:Zs,dismissCheckInReminder:qs}=dU({eventId:l,assignments:K,allLocations:ue,areaLeadRef:Pe,areaLeadCheckpoints:Ve,areaLeadMarshalDataVersion:ot,updatePendingCount:a,updateCachedField:br}),mn=$(!1),Fo=$(!1),sn=$(""),So=$(""),ho=$(null),bs=$(!1),xo=$(""),ws=$(""),Io=(Ee,$e)=>{xo.value=Ee,ws.value=$e,bs.value=!0},{myIncidents:Uo,incidentsLoading:gn,selectedIncident:$o,showIncidentDetail:Gn,showAddIncidentNoteModal:pt,incidentNoteText:xt,submittingIncidentNote:To,showReportIncident:fo,loadMyIncidents:zo,handleReportIncident:Ia,openIncidentDetail:dt,handleIncidentStatusChange:Ft,openAddIncidentNoteModal:$a,closeAddIncidentNoteModal:Ho,submitIncidentNote:yn}=hU({eventId:l,currentMarshalId:y,isAreaLead:w,areaLeadAreaIds:_,sectionLastLoadedAt:_e,showMessage:Io}),ri=$(null),Ws=G(()=>ri.value),po=$(null),Zt=Ee=>!Ee||Ee.length===0?!1:Ee.some($e=>_.value.includes($e)),Vo=Ee=>{po.value=po.value===Ee?null:Ee},kn=Ee=>{const $e=Ke.value===Ee;if(Ke.value=$e?null:Ee,!$e){const at=Date.now(),vt=wt=>at-_e.value[wt]>HU;switch(Ee){case"checklist":vt("checklist")&&oe();break;case"notes":vt("notes")&&Da();break;case"incidents":vt("incidents")&&zo();break;case"eventContacts":vt("eventContacts")&&Ra();break}}},Tn=$(null),Ta=Ee=>{Tn.value=Tn.value===Ee?null:Ee};qe(()=>K.value,Ee=>{Ee.length===1&&Tn.value===null&&(Tn.value=Ee[0].id)},{immediate:!0});const _n=G(()=>K.value.map(Ee=>{const $e=ue.value.find($t=>$t.id===Ee.locationId),at=$e?.areaIds||$e?.AreaIds||[];let vt=null;at.length>0&&Q.value.length>0&&(vt=Q.value.find(en=>at.includes(en.id))?.name);const Cn=($e?.assignments||[]).map($t=>({...$t,effectiveIsCheckedIn:$t.isCheckedIn&&!No($t.checkInTime)})).sort(($t,en)=>($t.marshalName||"").localeCompare(en.marshalName||"",void 0,{sensitivity:"base"})),Xt=Mo.value.filter($t=>at.includes($t.areaId)&&(!$t.marshalId||$t.marshalId!==y.value)),An=new Set,zt=Xt.filter($t=>{const en=JSON.stringify({name:$t.name||"",marshalId:$t.marshalId||"",role:$t.role||"",phone:$t.phone||"",email:$t.email||"",notes:$t.notes||""});return An.has(en)?!1:(An.add(en),!0)}).sort(($t,en)=>($t.marshalName||$t.name||"").localeCompare(en.marshalName||en.name||"",void 0,{sensitivity:"base"})),Qt=Ee.isCheckedIn&&!No(Ee.checkInTime);return{...Ee,location:$e,areaName:vt,areaIds:at,allMarshals:Cn,areaContacts:zt,locationName:$e?.name||"Unknown Location",effectiveIsCheckedIn:Qt}})),{courseMapActions:Ma,handleCourseMapVisibilityChange:Ut,handleCourseMapAction:Cs,getCheckpointMapActions:Ks,handleCheckpointMapVisibilityChange:Js,handleCheckpointMapAction:Ys}=fU({userLocation:Be,assignmentsWithDetails:_n,courseMapRef:Ws}),Aa=G(()=>K.value.length>0?K.value[0]:null),Mn=G(()=>K.value.map(Ee=>Ee.locationId)),Go=G(()=>_n.value.some(Ee=>Ee.location?.isDynamic||Ee.location?.IsDynamic)),lt=G(()=>_n.value.find(Ee=>Ee.location?.isDynamic||Ee.location?.IsDynamic)),bn=G(()=>{if(!ne.value||!_n.value.length)return[];const Ee=new Date,$e=ne.value.eventDate?new Date(ne.value.eventDate):null;return _n.value.filter(at=>{if(at.effectiveIsCheckedIn||xa.value.has(at.id))return!1;const vt=at.location;if(!vt)return!1;const wt=vt.startTime?new Date(vt.startTime):$e;if(!wt)return!1;let Cn;if(vt.endTime)Cn=new Date(vt.endTime);else if($e)Cn=new Date($e.getTime()+7200*1e3);else return!1;return Ee>=wt&&Ee<Cn})});qe(bn,Ee=>{Ee.length>0&&!Bo.value&&(Vn.value=Ee[0],Bo.value=!0)},{immediate:!0});const It=()=>{const Ee=Vn.value;Ee&&(qs(Ee.id),Ke.value="assignments",Tn.value=Ee.id)},no=G(()=>ne.value?.route?(typeof ne.value.route=="string"?JSON.parse(ne.value.route):ne.value.route)||[]:[]),vo=G(()=>!Aa.value||!ue.value.length?null:ue.value.find(Ee=>Ee.id===Aa.value.locationId)),mo=$([]),as=$(!1),go=G(()=>{const Ee=mo.value.filter(vt=>!vt.marshalId||vt.marshalId!==y.value),$e=new Set;return Ee.filter(vt=>{const wt=JSON.stringify({name:vt.name||"",marshalId:vt.marshalId||"",role:vt.role||"",phone:vt.phone||"",email:vt.email||"",notes:vt.notes||""});return $e.has(wt)?!1:($e.add(wt),!0)}).sort((vt,wt)=>(vt.name||"").localeCompare(wt.name||"",void 0,{sensitivity:"base"}))}),Ea=G(()=>{const Ee=["EmergencyContact","EventDirector","MedicalLead","SafetyOfficer"];return go.value.filter($e=>Ee.includes($e.role))}),is=G(()=>pe.value.filter(Ee=>{const $e=Ee.priority||Ee.Priority;return $e==="Emergency"||$e==="Urgent"})),Wt=(Ee,$e=[])=>{if(!pe.value||pe.value.length===0)return[];const at=ue.value.find(zt=>zt.id===Ee),vt=at?.areaIds||at?.AreaIds||[],wt=$e.length>0?$e:vt,Cn=[],Xt=new Set;for(const zt of pe.value){const Qt=zt.noteId||zt.NoteId||zt.id;if(Xt.has(Qt))continue;const $t=zt.scopeConfigurations||zt.ScopeConfigurations||[];let en=!1;if($t.length>0)for(const En of $t){const Ao=En.itemType||En.ItemType,oo=En.ids||En.Ids||[];if(Ao==="Checkpoint"&&(oo.includes(Ee)||oo.includes("ALL_CHECKPOINTS"))){en=!0;break}if(Ao==="Area"&&(oo.includes("ALL_AREAS")||wt.length>0&&wt.some(Ki=>oo.includes(Ki)))){en=!0;break}}else{const En=zt.matchedScope||zt.MatchedScope||"";["EveryoneInAreas","EveryAreaLead","EveryoneAtCheckpoints","Area","Checkpoint"].some(oo=>En.includes(oo)||En===oo)&&(en=!0)}en&&(Xt.add(Qt),Cn.push(zt))}const An={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return Cn.sort((zt,Qt)=>{const $t=zt.isPinned||zt.IsPinned,en=Qt.isPinned||Qt.IsPinned;if($t&&!en)return-1;if(!$t&&en)return 1;const En=An[zt.priority||zt.Priority||"Normal"]??3,Ao=An[Qt.priority||Qt.Priority||"Normal"]??3;if(En!==Ao)return En-Ao;const oo=zt.createdAt||zt.CreatedAt,ea=Qt.createdAt||Qt.CreatedAt;return new Date(ea)-new Date(oo)})},Mo=$([]),ci=(Ee,$e)=>Ee.localeCompare($e,void 0,{numeric:!0,sensitivity:"base"}),Xs=G(()=>{if(!Mt.value)return[];const Ee=Mt.value.locationId;return ue.value.filter($e=>$e.id!==Ee&&$e.latitude!==0&&$e.longitude!==0).sort(($e,at)=>ci($e.name,at.name))}),qi=G(()=>vo.value?{lat:vo.value.latitude,lng:vo.value.longitude}:Be.value?Be.value:ue.value.length>0?{lat:ue.value[0].latitude,lng:ue.value[0].longitude}:{lat:51.505,lng:-.09}),Pa=async()=>{const Ee=s.params.eventId;if(console.log("Loading event data for:",{eventId:Ee,marshalId:y.value}),Rn()){console.log("Offline mode detected, attempting to load from cache...");const wt=await _a(Ee);if(wt){if(console.log("Loaded cached data from:",wt.cachedAt),ne.value=wt.event,Q.value=wt.areas||[],ue.value=wt.locations||[],q.value=wt.checklist||[],mo.value=wt.contacts||[],pe.value=wt.notes||[],wt.areaLeadDashboard?.checkpoints&&(Ve.value=wt.areaLeadDashboard.checkpoints),ne.value&&xu(ne.value),y.value){const Cn=[];for(const Xt of ue.value){const An=Xt.assignments?.find(zt=>zt.marshalId===y.value);An&&Cn.push(An)}K.value=Cn}return}else console.warn("No cached data available while offline")}console.log("Fetching event data in parallel...");const[$e,at,vt]=await Promise.allSettled([ma.getById(Ee),ga.getByEvent(Ee),dl.getEventStatus(Ee)]);if($e.status==="fulfilled"?(ne.value=$e.value.data,console.log("Event loaded:",ne.value?.name),ne.value&&(xu(ne.value),O(Ee,ne.value.name,ne.value.eventDate))):console.error("Failed to load event:",$e.reason),at.status==="fulfilled"?(Q.value=at.value.data||[],console.log("Areas loaded:",Q.value.length)):console.error("Failed to load areas:",at.reason),vt.status==="fulfilled"){if(ue.value=vt.value.data?.locations||[],console.log("Locations loaded:",ue.value.length),y.value){const wt=[];for(const Cn of ue.value){const Xt=Cn.assignments?.find(An=>An.marshalId===y.value);Xt&&wt.push(Xt)}K.value=wt,console.log("Total assignments found:",K.value.length)}}else console.error("Failed to load event status:",vt.reason);await Promise.allSettled([oe(),Ra(),Da(),zo()]);try{const wt=JSON.parse(JSON.stringify({event:ne.value,areas:Q.value,locations:ue.value,checklist:q.value,contacts:mo.value,notes:pe.value,marshalId:y.value}));await Rl(Ee,wt),console.log("Event data cached for offline access")}catch(wt){console.warn("Failed to cache event data:",wt)}to()};u.onAuthSuccess=Pa;const Qs=async()=>{const Ee=s.params.eventId;if(Rn()){console.log("Skipping background preload: offline");return}console.log("Starting background preload for offline data...");try{const $e=await ga.getAreaLeadDashboard(Ee);if($e.data){Ve.value=$e.data.checkpoints||[];const at=JSON.parse(JSON.stringify({areas:$e.data.areas||[],checkpoints:$e.data.checkpoints||[]}));await _a(Ee)?await br(Ee,"areaLeadDashboard",at):await Rl(Ee,{areaLeadDashboard:at}),console.log("Area lead dashboard cached for offline access")}}catch($e){$e.response?.status!==403&&console.warn("Failed to preload area lead dashboard:",$e)}console.log("Background preload complete")},Da=async()=>{const Ee=s.params.eventId;try{const $e=await Es.getMyNotes(Ee);pe.value=$e.data||[],_e.value.notes=Date.now(),console.log("Notes loaded:",pe.value.length)}catch($e){console.error("Failed to load notes:",$e)}},Ra=async()=>{const Ee=s.params.eventId;as.value=!0;try{const $e=await da.getMyContacts(Ee);mo.value=$e.data||[],_e.value.eventContacts=Date.now(),console.log("Contacts loaded:",mo.value.length)}catch($e){console.warn("Failed to load contacts:",$e),mo.value=[]}finally{as.value=!1}},yt=()=>{Fo.value=!1,ho.value&&(ho.value(),ho.value=null)},Wi=()=>{Fo.value=!1,ho.value=null},wn=()=>{bs.value=!1},ls=Ee=>{if(Xn.value&&Mt.value){Hn(Mt.value.locationId,Ee.lat,Ee.lng,"manual"),Xn.value=!1,Mt.value=null;return}if(Go.value&&lt.value){const $e=lt.value;sn.value="Update location",So.value=`Update ${$e.location?.name||"dynamic checkpoint"} to this location?`,ho.value=async()=>{await Hn($e.locationId,Ee.lat,Ee.lng,"manual")},Fo.value=!0}},Oa=Ee=>{if(!Xn.value&&Go.value&&lt.value){const $e=lt.value;if(Ee.id===$e.locationId)return;sn.value="Copy location",So.value=`Copy location from "${Ee.name}" to ${$e.location?.name||"your dynamic checkpoint"}?`,ho.value=async()=>{await Hn($e.locationId,Ee.latitude,Ee.longitude,"checkpoint",Ee.id)},Fo.value=!0}},ui=()=>{P(()=>{K.value=[],q.value=[],Mo.value=[]})},Ba=Ee=>Ee?new Date(Ee).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return on(async()=>{const Ee=s.params.eventId,$e=s.query.code;he.value=!0;try{$e?await T(Ee,$e):await x(Ee)&&await Pa()}finally{he.value=!1}d.value&&(mt(),"requestIdleCallback"in window?requestIdleCallback(()=>{Qs()},{timeout:5e3}):setTimeout(()=>{Qs()},2e3))}),qe(d,Ee=>{Ee?mt():_t()}),qe(()=>s.query.code,async Ee=>{if(Ee&&d.value){he.value=!0;try{await T(s.params.eventId,Ee)}finally{he.value=!1}}}),qe(ne,Ee=>{Ee&&(document.title=`OnTheDay App - ${t.value.person}`)},{immediate:!0}),$n(()=>{E(),_s(),Co()}),(Ee,$e)=>(v(),m("div",{class:"marshal-view",style:Qe(B(U))},[Ae($O),r("header",{class:ce(["header",`logo-${B(Fe)}`]),style:Qe(B(ee))},[B(Je)&&B(Fe)==="cover"?(v(),m("div",mU,[r("img",{src:B(Je),alt:"Event logo",class:"header-logo-cover-img"},null,8,gU)])):M("",!0),B(d)&&B(Fe)==="right"?(v(),m("button",{key:1,onClick:ui,class:"btn-close-session btn-close-left",style:Qe({color:B(de)}),title:"Close session"},"  ",4)):M("",!0),B(Je)&&B(Fe)==="left"?(v(),m("div",yU,[r("img",{src:B(Je),alt:"Event logo",class:"header-logo-img"},null,8,kU)])):M("",!0),r("div",_U,[r("div",{class:"header-title",style:Qe({color:B(de)})},[ne.value?(v(),m("h1",bU,C(ne.value.name),1)):M("",!0),ne.value?.eventDate?(v(),m("div",wU,C(Ba(ne.value.eventDate)),1)):M("",!0)],4),B(d)?(v(),m("div",CU,[r("button",{onClick:$e[0]||($e[0]=at=>fo.value=!0),class:"btn-header-action btn-report-incident"}," Report Incident "),r("button",{onClick:$e[1]||($e[1]=at=>mn.value=!0),class:"btn-header-action btn-emergency"}," Emergency Info ")])):M("",!0)]),B(Je)&&B(Fe)==="right"?(v(),m("div",LU,[r("img",{src:B(Je),alt:"Event logo",class:"header-logo-img"},null,8,SU)])):M("",!0),B(d)&&B(Fe)!=="right"?(v(),m("button",{key:4,onClick:ui,class:"btn-close-session btn-close-right",style:Qe({color:B(de)}),title:"Close session"},"  ",4)):M("",!0)],6),r("div",xU,[he.value?(v(),m("div",IU,[...$e[22]||($e[22]=[r("div",{class:"loading"},"Loading...",-1)])])):!B(d)&&!B(p)?(v(),m("div",$U,[$e[23]||($e[23]=r("h2",null,"Welcome",-1)),$e[24]||($e[24]=r("p",{class:"instruction"},"Please use the login link sent to you to access your marshal dashboard.",-1)),B(f)?(v(),m("p",TU,"Authenticating...")):M("",!0)])):B(p)?(v(),m("div",MU,[$e[25]||($e[25]=r("h2",null,"Login failed",-1)),r("p",AU,C(B(p)),1),$e[26]||($e[26]=r("p",{class:"instruction"},"Please contact the event organiser for a new login link.",-1))])):(v(),m("div",EU,[B(S)||B(A)?(v(),m("div",PU,[r("div",DU,[B(g)?.email?(v(),m("span",RU,C(B(g).email),1)):M("",!0)]),B(S)?(v(),m("div",OU,[r("button",{onClick:$e[2]||($e[2]=(...at)=>B(F)&&B(F)(...at)),class:"btn-mode-switch"}," Switch to Admin ")])):B(A)?(v(),m("div",BU,[...$e[27]||($e[27]=[r("span",{class:"reauth-hint",title:"Login via admin flow to access admin features"}," Admin access requires re-login ",-1)])])):M("",!0)])):M("",!0),r("div",NU,[Ae(iU,{ref:"assignmentsSectionRef","is-expanded":Ke.value==="assignments",assignments:_n.value,"expanded-checkpoint-id":Tn.value,"all-locations":ue.value,route:no.value,"user-location":B(Be),"has-dynamic-assignment":Go.value,"current-marshal-id":B(y),"current-marshal-name":B(k),"checking-in-id":B(Yt),"checking-in-assignment-id":B(Oo),"check-in-error":B(uo),"checking-in-marshal-id":B(Yt),"expanded-marshal-id":po.value,"updating-location":B(Nt),"auto-update-enabled":B(zn),"get-toolbar-actions":B(Ks),"is-area-lead-for-areas":Zt,"get-notes-for-checkpoint":Wt,onToggle:$e[3]||($e[3]=at=>kn("assignments")),onToggleCheckpoint:Ta,onMapClick:ls,onLocationClick:Oa,onActionClick:B(Ys),onVisibilityChange:B(Js),onUpdateLocation:B(pn),onCheckIn:$e[4]||($e[4]=at=>B(Lo)(at,!0)),onToggleMarshal:Vo,onMarshalCheckIn:$e[5]||($e[5]=(at,vt)=>B(Lo)(at,!1,vt)),onToggleAutoUpdate:B(jt)},null,8,["is-expanded","assignments","expanded-checkpoint-id","all-locations","route","user-location","has-dynamic-assignment","current-marshal-id","current-marshal-name","checking-in-id","checking-in-assignment-id","check-in-error","checking-in-marshal-id","expanded-marshal-id","updating-location","auto-update-enabled","get-toolbar-actions","onActionClick","onVisibilityChange","onUpdateLocation","onToggleAutoUpdate"]),Ae(DN,{loading:B(X),error:B(fe),"is-expanded":Ke.value==="checklist","is-area-lead":B(w),"my-items":B(Me),"area-items":B(Re),"area-items-with-local-state":B(Ce),"visible-items":B(V),"grouped-items":B(Z),"completed-count":B(J),saving:B(we),"effective-group-by":B(me),"expanded-group":B(Y),locations:ue.value,areas:Q.value,marshals:B(be),"get-context-name":B(Oe),onToggle:$e[6]||($e[6]=at=>kn("checklist")),onToggleItem:B(le),onToggleGroup:B(Te)},null,8,["loading","error","is-expanded","is-area-lead","my-items","area-items","area-items-with-local-state","visible-items","grouped-items","completed-count","saving","effective-group-by","expanded-group","locations","areas","marshals","get-context-name","onToggleItem","onToggleGroup"]),Ae(zN,{"event-id":B(s).params.eventId,notes:pe.value,locations:ue.value,areas:Q.value,assignments:K.value,"is-expanded":Ke.value==="notes",onToggle:$e[7]||($e[7]=at=>kn("notes")),onNotesChanged:Da},null,8,["event-id","notes","locations","areas","assignments","is-expanded"]),Ae(TB,{contacts:go.value,loading:as.value,"is-expanded":Ke.value==="eventContacts",onToggle:$e[8]||($e[8]=at=>kn("eventContacts"))},null,8,["contacts","loading","is-expanded"]),Ae(FB,{incidents:B(Uo),loading:B(gn),"is-expanded":Ke.value==="incidents",onToggle:$e[9]||($e[9]=at=>kn("incidents")),onSelectIncident:B(dt)},null,8,["incidents","loading","is-expanded","onSelectIncident"]),Ae(_F,{ref_key:"areaLeadSectionRef",ref:Le,"is-area-lead":B(w),"is-expanded":Ke.value==="areaLead",areas:D.value,"selected-filters":N.value,"filtered-area-ids":j.value,"event-id":B(s).params.eventId,"marshal-id":B(y),route:no.value,onToggle:$e[10]||($e[10]=at=>kn("areaLead")),onToggleFilter:R,onChecklistUpdated:B(oe)},null,8,["is-area-lead","is-expanded","areas","selected-filters","filtered-area-ids","event-id","marshal-id","route","onChecklistUpdated"]),Ae(qF,{"is-area-lead":B(w),"is-expanded":Ke.value==="areaLeadMarshals",marshals:B(Ge),"expanded-marshal-id":B(ie),"checking-in-marshal-id":B(Yt),"saving-task":B(ve),onToggle:$e[11]||($e[11]=at=>kn("areaLeadMarshals")),onToggleMarshal:B(St),onCheckIn:B(Zs),onToggleTask:B(qt)},null,8,["is-area-lead","is-expanded","marshals","expanded-marshal-id","checking-in-marshal-id","saving-task","onToggleMarshal","onCheckIn","onToggleTask"]),Ae(XN,{ref_key:"routeSectionRef",ref:ri,"is-expanded":Ke.value==="map","user-location":B(Be),"selecting-location":B(Xn),"selecting-location-name":B(Mt)?.location?.name||"",locations:ue.value,route:no.value,center:qi.value,"highlight-location-ids":Mn.value,clickable:B(Xn)||Go.value,"toolbar-actions":B(Ma),onToggle:$e[12]||($e[12]=at=>kn("map")),onCancelSelect:B(Qn),onMapClick:ls,onLocationClick:Oa,onActionClick:B(Cs),onVisibilityChange:B(Ut)},null,8,["is-expanded","user-location","selecting-location","selecting-location-name","locations","route","center","highlight-location-ids","clickable","toolbar-actions","onCancelSelect","onActionClick","onVisibilityChange"]),Ae(YB,{"event-date":ne.value?.eventDate,description:ne.value?.description,"is-expanded":Ke.value==="eventDetails",onToggle:$e[13]||($e[13]=at=>kn("eventDetails"))},null,8,["event-date","description","is-expanded"])])]))]),Ae(pO,{show:mn.value,contacts:Ea.value,notes:is.value,onClose:$e[14]||($e[14]=at=>mn.value=!1)},null,8,["show","contacts","notes"]),Ae(em,{show:B(fo),"event-id":l.value||"",checkpoint:W.value,"initial-location":B(Be),checkpoints:ue.value,route:no.value,onClose:$e[15]||($e[15]=at=>fo.value=!1),onSubmit:B(Ia)},null,8,["show","event-id","checkpoint","initial-location","checkpoints","route","onSubmit"]),Ae(Qv,{show:B(Gn),incident:B($o),route:no.value,checkpoints:ue.value,"can-manage":B(w),onClose:$e[16]||($e[16]=at=>Gn.value=!1),onStatusChange:B(Ft),onOpenAddNote:B($a)},null,8,["show","incident","route","checkpoints","can-manage","onStatusChange","onOpenAddNote"]),Ae(Vt,{show:B(pt),title:"Add update",size:"small",onClose:B(Ho)},{footer:ze(()=>[r("div",UU,[r("button",{type:"button",class:"btn btn-secondary",onClick:$e[18]||($e[18]=(...at)=>B(Ho)&&B(Ho)(...at))}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:$e[19]||($e[19]=(...at)=>B(yn)&&B(yn)(...at)),disabled:!B(xt).trim()||B(To)},C(B(To)?"Adding...":"Add update"),9,zU)])]),default:ze(()=>[r("div",FU,[He(r("textarea",{"onUpdate:modelValue":$e[17]||($e[17]=at=>Kt(xt)?xt.value=at:null),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[st,B(xt)]])])]),_:1},8,["show","onClose"]),Ae(Bl,{show:Fo.value,title:sn.value,message:So.value,onConfirm:yt,onCancel:Wi},null,8,["show","title","message"]),Ae(Bl,{show:bs.value,title:xo.value,message:ws.value,"show-cancel":!1,onConfirm:wn},null,8,["show","title","message"]),Ae(BO,{show:B(Bo),checkpoint:B(Vn),"accent-button-style":B(et),onDismiss:$e[20]||($e[20]=at=>B(qs)(B(Vn)?.id)),onGoToCheckpoint:It},null,8,["show","checkpoint","accent-button-style"]),Ae(rB,{show:B(bt),assignment:B(Mt),"user-location":B(Be),"auto-update-enabled":B(zn),updating:B(Nt),error:B(Ct),success:B(Bt),"available-checkpoints":Xs.value,"accent-button-style":B(et),onClose:B(Gt),onUpdateGps:B(eo),onToggleAutoUpdate:$e[21]||($e[21]=at=>B(jt)(B(Mt))),onSelectOnMap:ae,onCopyFromCheckpoint:B(vn)},null,8,["show","assignment","user-location","auto-update-enabled","updating","error","success","available-checkpoints","accent-button-style","onClose","onUpdateGps","onCopyFromCheckpoint"])],4))}},GU=je(VU,[["__scopeId","data-v-9680a209"]]),jU={class:"form-group"},ZU={class:"form-group"},qU={class:"form-group"},WU={class:"actions-left"},KU={__name:"EditProfileModal",props:{show:{type:Boolean,default:!1},profile:{type:Object,default:null},isDirty:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3},showLogout:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty","logout"],setup(e,{emit:t}){const o=e,a=t,s=$({name:"",email:"",phone:""});qe(()=>o.profile,f=>{f&&(s.value={name:f.name||"",email:f.email||"",phone:f.phone||""})},{immediate:!0,deep:!0}),qe(()=>o.show,f=>{f&&o.profile&&(s.value={name:o.profile.name||"",email:o.profile.email||"",phone:o.profile.phone||""})});const i=()=>{a("update:isDirty",!0)},l=()=>{if(!s.value.name.trim()){alert("Name is required");return}if(!s.value.email.trim()){alert("Email is required");return}a("submit",{name:s.value.name.trim(),email:s.value.email.trim(),phone:s.value.phone?.trim()||""})},u=()=>{a("close")},d=()=>{a("logout")};return(f,p)=>(v(),Ze(Vt,{show:e.show,title:"Edit profile",size:"medium","z-index":e.zIndex,"confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:ze(()=>[r("div",WU,[e.showLogout?(v(),m("button",{key:0,type:"button",onClick:d,class:"btn btn-danger"}," Log out ")):M("",!0)]),r("button",{type:"button",onClick:l,class:"btn btn-success"}," Save ")]),default:ze(()=>[r("form",{onSubmit:rt(l,["prevent"])},[r("div",jU,[p[3]||(p[3]=r("label",null,"Name *",-1)),He(r("input",{"onUpdate:modelValue":p[0]||(p[0]=g=>s.value.name=g),type:"text",required:"",class:"form-input",placeholder:"Your name",onInput:i},null,544),[[st,s.value.name]])]),r("div",ZU,[p[4]||(p[4]=r("label",null,"Email *",-1)),He(r("input",{"onUpdate:modelValue":p[1]||(p[1]=g=>s.value.email=g),type:"email",required:"",class:"form-input",placeholder:"Your email address",onInput:i},null,544),[[st,s.value.email]])]),r("div",qU,[p[5]||(p[5]=r("label",null,"Phone",-1)),He(r("input",{"onUpdate:modelValue":p[2]||(p[2]=g=>s.value.phone=g),type:"tel",class:"form-input",placeholder:"Your phone number",onInput:i},null,544),[[st,s.value.phone]])])],32)]),_:1},8,["show","z-index","is-dirty"]))}},JU=je(KU,[["__scopeId","data-v-178e5f48"]]),YU={class:"tabs"},XU={class:"tab-content"},QU={class:"form-group"},ez={class:"form-group"},tz={class:"form-group"},nz={class:"form-group"},oz=["value"],sz={class:"tab-content"},az={class:"emergency-contacts-section"},iz={key:0,class:"empty-state"},lz={class:"card-header"},rz=["onClick"],cz={class:"form-group"},uz=["onUpdate:modelValue"],dz={class:"form-group"},hz=["onUpdate:modelValue"],fz={class:"form-group"},pz=["onUpdate:modelValue"],vz={__name:"EventFormModal",props:{show:{type:Boolean,default:!1},eventData:{type:Object,default:()=>({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]})},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const o=e,a=t,{activeTab:s,switchTab:i,resetTab:l}=Fv("basic",["basic","emergency"]),u=$({...o.eventData});qe(()=>o.eventData,y=>{u.value={...y},u.value.emergencyContacts||(u.value.emergencyContacts=[])},{deep:!0}),qe(()=>o.show,y=>{y&&l()});const d=()=>{u.value.emergencyContacts.push({name:"",phone:"",details:""})},f=y=>{u.value.emergencyContacts.splice(y,1)},p=()=>{a("submit",{...u.value})},g=()=>{a("close")};return(y,k)=>(v(),Ze(Vt,{show:e.show,title:e.isEditing?"Edit event":"Create new event",size:"large",onClose:g},{"tab-header":ze(()=>[r("div",YU,[r("button",{type:"button",onClick:k[0]||(k[0]=_=>B(i)("basic")),class:ce(["tab-button",{active:B(s)==="basic"}])}," Basic details ",2),r("button",{type:"button",onClick:k[1]||(k[1]=_=>B(i)("emergency")),class:ce(["tab-button",{active:B(s)==="emergency"}])}," Emergency contacts ",2)])]),actions:ze(()=>[r("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:p,class:"btn btn-success"}," Save ")]),default:ze(()=>[r("form",{onSubmit:rt(p,["prevent"])},[He(r("div",XU,[r("div",QU,[k[6]||(k[6]=r("label",null,"Event name *",-1)),He(r("input",{"onUpdate:modelValue":k[2]||(k[2]=_=>u.value.name=_),type:"text",required:"",class:"form-input"},null,512),[[st,u.value.name]])]),r("div",ez,[k[7]||(k[7]=r("label",null,"Description",-1)),He(r("textarea",{"onUpdate:modelValue":k[3]||(k[3]=_=>u.value.description=_),rows:"3",class:"form-input"},null,512),[[st,u.value.description]])]),r("div",tz,[k[8]||(k[8]=r("label",null,"Event date *",-1)),He(r("input",{"onUpdate:modelValue":k[4]||(k[4]=_=>u.value.eventDate=_),type:"datetime-local",required:"",class:"form-input"},null,512),[[st,u.value.eventDate]])]),r("div",nz,[k[9]||(k[9]=r("label",null,"Time zone *",-1)),He(r("select",{"onUpdate:modelValue":k[5]||(k[5]=_=>u.value.timeZoneId=_),required:"",class:"form-input"},[(v(!0),m(Se,null,Ne(B(qv),_=>(v(),m("option",{key:_.value,value:_.value},C(_.label),9,oz))),128))],512),[[Fn,u.value.timeZoneId]])])],512),[[ks,B(s)==="basic"]]),He(r("div",sz,[r("div",az,[r("div",{class:"section-header-small"},[k[10]||(k[10]=r("h3",null,"Emergency contacts",-1)),r("button",{type:"button",onClick:d,class:"btn btn-small btn-primary"}," Add contact ")]),u.value.emergencyContacts.length===0?(v(),m("div",iz,[...k[11]||(k[11]=[r("p",null,'No emergency contacts added yet. Click "Add contact" to add one.',-1)])])):M("",!0),(v(!0),m(Se,null,Ne(u.value.emergencyContacts,(_,w)=>(v(),m("div",{key:w,class:"emergency-contact-card"},[r("div",lz,[r("h4",null,"Contact "+C(w+1),1),r("button",{type:"button",onClick:S=>f(w),class:"btn-remove"},"  ",8,rz)]),r("div",cz,[k[12]||(k[12]=r("label",null,"Name *",-1)),He(r("input",{"onUpdate:modelValue":S=>_.name=S,type:"text",required:"",class:"form-input",placeholder:"Contact person name"},null,8,uz),[[st,_.name]])]),r("div",dz,[k[13]||(k[13]=r("label",null,"Phone *",-1)),He(r("input",{"onUpdate:modelValue":S=>_.phone=S,type:"tel",required:"",class:"form-input",placeholder:"+1 (555) 123-4567"},null,8,hz),[[st,_.phone]])]),r("div",fz,[k[14]||(k[14]=r("label",null,"Additional details",-1)),He(r("textarea",{"onUpdate:modelValue":S=>_.details=S,rows:"2",class:"form-input",placeholder:"Role, availability, or other important information..."},null,8,pz),[[st,_.details]])])]))),128))])],512),[[ks,B(s)==="emergency"]])],32)]),_:1},8,["show","title"]))}},mz=je(vz,[["__scopeId","data-v-d820eb4f"]]),gz=Yu("profile",()=>{const e=$(null),t=$(!1),o=$(null);return{profile:e,loading:t,error:o,fetchProfile:async()=>{t.value=!0,o.value=null;try{const d=await dr.getProfile();return e.value=d.data,d.data}catch(d){throw o.value=d.response?.data?.message||"Failed to load profile",d}finally{t.value=!1}},updateProfile:async d=>{t.value=!0,o.value=null;try{const f=await dr.updateProfile(d);return e.value=f.data,f.data}catch(f){throw o.value=f.response?.data?.message||"Failed to update profile",f}finally{t.value=!1}},fetchPerson:async(d,f)=>{t.value=!0,o.value=null;try{return(await dr.getPerson(d,f)).data}catch(p){throw o.value=p.response?.data?.message||"Failed to load person",p}finally{t.value=!1}},updatePerson:async(d,f,p)=>{t.value=!0,o.value=null;try{return(await dr.updatePerson(d,f,p)).data}catch(g){throw o.value=g.response?.data?.message||"Failed to update person",g}finally{t.value=!1}},clearProfile:()=>{e.value=null,o.value=null}}}),yz={class:"sessions-view"},kz={class:"sessions-container"},_z={key:0,class:"loading-state"},bz={key:1,class:"empty-state"},wz={key:2,class:"sessions-list"},Cz={class:"section-header"},Lz={class:"section-actions"},Sz=["onClick"],xz={class:"session-info"},Iz={class:"event-name"},$z={key:0,class:"event-date"},Tz={key:1,class:"sign-in-section"},Mz={key:2,class:"section-header"},Az=["onClick"],Ez={class:"session-info"},Pz={class:"event-name"},Dz={class:"role-name"},Rz={key:0,class:"event-date"},Oz=["onClick"],Bz={class:"modal-card"},Nz={class:"modal-actions"},Fz={class:"modal-card"},Uz={class:"modal-actions"},zz={__name:"SessionsView",setup(e){const t=Hi(),o=jl(),a=Nv(),s=gz(),i=$([]),l=$([]),u=$(!0),d=$(!1),f=$(!1),p=$(!1),g=$(!1),y=$(null),k=$(!1),_=$({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}),w=G(()=>localStorage.getItem("adminEmail")),S=G(()=>!!w.value),A=()=>{i.value=ok()},T=he=>{sv(he.eventId,he.marshalId),t.push(`/event/${he.eventId}`)},x=he=>{y.value=he,p.value=!0},P=async()=>{if(!y.value)return;const{sessionKey:he,eventId:U}=y.value;try{_o("marshal",U),await authApi.logout()}catch{}yu(he),_o(null),A(),p.value=!1,y.value=null},O=()=>{g.value=!0},F=async()=>{await o.logout(),l.value=[],g.value=!1},E=async()=>{if(f.value=!0,!s.profile)try{await s.fetchProfile()}catch(he){console.error("Failed to load profile:",he)}},N=async he=>{try{await s.updateProfile(he),f.value=!1}catch(U){console.error("Failed to save profile:",U),alert("Failed to save profile. Please try again.")}},D=async()=>{await o.logout(),l.value=[],f.value=!1},j=he=>he?new Date(he).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric"}):"",R=async()=>{if(S.value)try{_o("admin");const he=await ma.getAll();l.value=he.data||[]}catch(he){console.error("Failed to load admin events:",he),l.value=[]}},W=he=>{t.push(`/admin/event/${he}`)},ne=()=>{t.push("/")},ue=()=>{},K=()=>{k.value=!1,_.value={name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}},Q=async he=>{try{const U={...he,adminEmail:o.adminEmail};await a.createEvent(U),K(),await R()}catch(U){console.error("Failed to create event:",U),alert("Failed to create event. Please try again.")}};return on(async()=>{document.title="OnTheDay App - Sessions",iv(),av(),A(),await R(),u.value=!1}),(he,U)=>(v(),m("div",yz,[r("div",kz,[Ae(Ov,{title:"Your sessions"}),u.value?(v(),m("div",_z,[...U[9]||(U[9]=[r("p",null,"Loading sessions...",-1)])])):i.value.length===0&&l.value.length===0?(v(),m("div",bz,[U[10]||(U[10]=r("p",null,"No active sessions.",-1)),U[11]||(U[11]=r("p",{class:"hint"},"Sign in to access your events, or use a login link from your event organiser.",-1)),r("button",{class:"btn btn-primary",onClick:U[0]||(U[0]=ee=>d.value=!0)}," Sign in ")])):(v(),m("div",wz,[S.value?(v(),m(Se,{key:0},[r("div",Cz,[U[12]||(U[12]=r("span",{class:"section-label"},"Admin events",-1)),r("div",Lz,[r("button",{class:"btn btn-small btn-primary",onClick:E}," Profile "),r("button",{class:"btn btn-small btn-primary",onClick:U[1]||(U[1]=ee=>k.value=!0)}," Create event ")])]),(v(!0),m(Se,null,Ne(l.value,ee=>(v(),m("div",{key:"admin-"+ee.id,class:"session-card admin-card",onClick:de=>W(ee.id)},[U[14]||(U[14]=r("div",{class:"card-icon admin-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"})])],-1)),r("div",xz,[r("div",Iz,C(ee.name),1),U[13]||(U[13]=r("div",{class:"role-name"},"Admin",-1)),ee.eventDate?(v(),m("div",$z,C(j(ee.eventDate)),1)):M("",!0)]),r("button",{class:"btn-logout",onClick:rt(O,["stop"]),title:"Log out as admin"},"  ")],8,Sz))),128))],64)):(v(),m("div",Tz,[r("button",{class:"btn btn-primary",onClick:U[2]||(U[2]=ee=>d.value=!0)}," Sign in ")])),i.value.length>0?(v(),m("div",Mz,[...U[15]||(U[15]=[r("span",{class:"section-label"},"Marshal sessions",-1)])])):M("",!0),(v(!0),m(Se,null,Ne(i.value,ee=>(v(),m("div",{key:ee.sessionKey,class:"session-card",onClick:de=>T(ee)},[U[16]||(U[16]=r("div",{class:"card-icon marshal-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})])],-1)),r("div",Ez,[r("div",Pz,C(ee.eventName||"Event"),1),r("div",Dz,C(ee.marshalName||"Marshal"),1),ee.eventDate?(v(),m("div",Rz,C(j(ee.eventDate)),1)):M("",!0)]),r("button",{class:"btn-logout",onClick:rt(de=>x(ee),["stop"]),title:"Log out from this session"},"  ",8,Oz)],8,Az))),128))])),r("button",{class:"btn-back-home",onClick:ne,title:"Back to home"},"  ")]),Ae(Bv,{show:d.value,onClose:U[3]||(U[3]=ee=>d.value=!1),onSuccess:ue},null,8,["show"]),Ae(JU,{show:f.value,profile:B(s).profile,"show-logout":!0,onClose:U[4]||(U[4]=ee=>f.value=!1),onSubmit:N,onLogout:D},null,8,["show","profile"]),Ae(mz,{show:k.value,"event-data":_.value,"is-editing":!1,onClose:K,onSubmit:Q},null,8,["show","event-data"]),(v(),Ze($l,{to:"body"},[Ae(ys,{name:"modal"},{default:ze(()=>[g.value?(v(),m("div",{key:0,class:"modal-overlay",onClick:U[6]||(U[6]=rt(ee=>g.value=!1,["self"]))},[r("div",Bz,[U[17]||(U[17]=r("h3",null,"Log out as admin?",-1)),U[18]||(U[18]=r("p",null,"This will log you out from all admin events.",-1)),U[19]||(U[19]=r("p",{class:"hint"},"You can log back in using the sign-in button.",-1)),r("div",Nz,[r("button",{class:"btn btn-secondary",onClick:U[5]||(U[5]=ee=>g.value=!1)},"Cancel"),r("button",{class:"btn btn-danger",onClick:F},"Log out")])])])):M("",!0)]),_:1})])),(v(),Ze($l,{to:"body"},[Ae(ys,{name:"modal"},{default:ze(()=>[p.value?(v(),m("div",{key:0,class:"modal-overlay",onClick:U[8]||(U[8]=rt(ee=>p.value=!1,["self"]))},[r("div",Fz,[U[22]||(U[22]=r("h3",null,"Log out from session?",-1)),r("p",null,[U[20]||(U[20]=Ye("This will log you out from ",-1)),r("strong",null,C(y.value?.eventName||"this event"),1),U[21]||(U[21]=Ye(".",-1))]),U[23]||(U[23]=r("p",{class:"hint"},"You can log back in using the link from your event organiser.",-1)),r("div",Uz,[r("button",{class:"btn btn-secondary",onClick:U[7]||(U[7]=ee=>p.value=!1)},"Cancel"),r("button",{class:"btn btn-danger",onClick:P},"Log out")])])])):M("",!0)]),_:1})]))]))}},Hz=je(zz,[["__scopeId","data-v-add55e1c"]]);let vf=!1;function Vz(){vf||(vf=!0,iv(),av())}const Gz=[{path:"/",name:"Home",component:hb},{path:"/admin/login",name:"AdminLogin",component:_b},{path:"/admin/verify",name:"AdminVerify",component:Ib},{path:"/sessions",name:"Sessions",component:Hz},{path:"/admin/dashboard",redirect:"/sessions"},{path:"/admin/profile",redirect:"/sessions"},{path:"/admin/event/:eventId",name:"AdminEventManage",component:JR,meta:{requiresAuth:!0}},{path:"/marshal",redirect:"/sessions"},{path:"/event/:eventId",name:"MarshalView",component:GU},{path:"/:pathMatch(.*)*",redirect:"/"}],nm=ek({history:E1("/VolunteerCheckin/testing/"),routes:Gz});nm.beforeEach((e,t,o)=>{Vz();const a=localStorage.getItem("adminEmail");if(e.meta.requiresAuth&&!a){o({name:"AdminLogin"});return}if(e.meta.requiresAuth?_o("admin"):e.name!=="MarshalView"&&e.name!=="Sessions"&&_o(null),e.name==="MarshalView"){const s=e.params.eventId,i=!!e.query.code,l=Or(s),u=l?.marshalId?rv(s,l.marshalId):null;if(i){o();return}if(l?.token){o();return}if(u){o();return}if(lv()){o({name:"Sessions"});return}}o()});js().then(()=>{console.log("Offline database initialized")}).catch(e=>{console.warn("Failed to initialize offline database:",e)});const cd=Fy(tk);cd.use(Hy());cd.use(nm);cd.mount("#app");
