(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function o(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=o(s);fetch(s.href,a)}})();function yu(e){const t=Object.create(null);for(const o of e.split(","))t[o]=1;return o=>o in t}const Bt={},Ca=[],Ko=()=>{},tf=()=>!1,Ar=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),ku=e=>e.startsWith("onUpdate:"),yn=Object.assign,_u=(e,t)=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},Kv=Object.prototype.hasOwnProperty,Et=(e,t)=>Kv.call(e,t),it=Array.isArray,La=e=>Ml(e)==="[object Map]",Da=e=>Ml(e)==="[object Set]",fd=e=>Ml(e)==="[object Date]",ft=e=>typeof e=="function",Xt=e=>typeof e=="string",Jo=e=>typeof e=="symbol",Ot=e=>e!==null&&typeof e=="object",nf=e=>(Ot(e)||ft(e))&&ft(e.then)&&ft(e.catch),of=Object.prototype.toString,Ml=e=>of.call(e),Yv=e=>Ml(e).slice(8,-1),sf=e=>Ml(e)==="[object Object]",Er=e=>Xt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,cl=yu(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Pr=e=>{const t=Object.create(null);return(o=>t[o]||(t[o]=e(o)))},Jv=/-\w/g,Ao=Pr(e=>e.replace(Jv,t=>t.slice(1).toUpperCase())),Xv=/\B([A-Z])/g,Ci=Pr(e=>e.replace(Xv,"-$1").toLowerCase()),Dr=Pr(e=>e.charAt(0).toUpperCase()+e.slice(1)),vc=Pr(e=>e?`on${Dr(e)}`:""),yi=(e,t)=>!Object.is(e,t),sr=(e,...t)=>{for(let o=0;o<e.length;o++)e[o](...t)},af=(e,t,o,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:o})},Rr=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Qv=e=>{const t=Xt(e)?Number(e):NaN;return isNaN(t)?e:t};let pd;const Or=()=>pd||(pd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function ut(e){if(it(e)){const t={};for(let o=0;o<e.length;o++){const i=e[o],s=Xt(i)?om(i):ut(i);if(s)for(const a in s)t[a]=s[a]}return t}else if(Xt(e)||Ot(e))return e}const em=/;(?![^(]*\))/g,tm=/:([^]+)/,nm=/\/\*[^]*?\*\//g;function om(e){const t={};return e.replace(nm,"").split(em).forEach(o=>{if(o){const i=o.split(tm);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function ue(e){let t="";if(Xt(e))t=e;else if(it(e))for(let o=0;o<e.length;o++){const i=ue(e[o]);i&&(t+=i+" ")}else if(Ot(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}const sm="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",im=yu(sm);function lf(e){return!!e||e===""}function am(e,t){if(e.length!==t.length)return!1;let o=!0;for(let i=0;o&&i<e.length;i++)o=ta(e[i],t[i]);return o}function ta(e,t){if(e===t)return!0;let o=fd(e),i=fd(t);if(o||i)return o&&i?e.getTime()===t.getTime():!1;if(o=Jo(e),i=Jo(t),o||i)return e===t;if(o=it(e),i=it(t),o||i)return o&&i?am(e,t):!1;if(o=Ot(e),i=Ot(t),o||i){if(!o||!i)return!1;const s=Object.keys(e).length,a=Object.keys(t).length;if(s!==a)return!1;for(const l in e){const u=e.hasOwnProperty(l),d=t.hasOwnProperty(l);if(u&&!d||!u&&d||!ta(e[l],t[l]))return!1}}return String(e)===String(t)}function bu(e,t){return e.findIndex(o=>ta(o,t))}const rf=e=>!!(e&&e.__v_isRef===!0),w=e=>Xt(e)?e:e==null?"":it(e)||Ot(e)&&(e.toString===of||!ft(e.toString))?rf(e)?w(e.value):JSON.stringify(e,cf,2):String(e),cf=(e,t)=>rf(t)?cf(e,t.value):La(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((o,[i,s],a)=>(o[mc(i,a)+" =>"]=s,o),{})}:Da(t)?{[`Set(${t.size})`]:[...t.values()].map(o=>mc(o))}:Jo(t)?mc(t):Ot(t)&&!it(t)&&!sf(t)?String(t):t,mc=(e,t="")=>{var o;return Jo(e)?`Symbol(${(o=e.description)!=null?o:t})`:e};function lm(e){return e==null?"initial":typeof e=="string"?e===""?" ":e:String(e)}let Tn;class uf{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Tn,!t&&Tn&&(this.index=(Tn.scopes||(Tn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].pause();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].resume();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].resume()}}run(t){if(this._active){const o=Tn;try{return Tn=this,t()}finally{Tn=o}}}on(){++this._on===1&&(this.prevScope=Tn,Tn=this)}off(){this._on>0&&--this._on===0&&(Tn=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let o,i;for(o=0,i=this.effects.length;o<i;o++)this.effects[o].stop();for(this.effects.length=0,o=0,i=this.cleanups.length;o<i;o++)this.cleanups[o]();if(this.cleanups.length=0,this.scopes){for(o=0,i=this.scopes.length;o<i;o++)this.scopes[o].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function df(e){return new uf(e)}function hf(){return Tn}function rm(e,t=!1){Tn&&Tn.cleanups.push(e)}let Ut;const gc=new WeakSet;class ff{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Tn&&Tn.active&&Tn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,gc.has(this)&&(gc.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||vf(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,vd(this),mf(this);const t=Ut,o=Yo;Ut=this,Yo=!0;try{return this.fn()}finally{gf(this),Ut=t,Yo=o,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Lu(t);this.deps=this.depsTail=void 0,vd(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?gc.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Bc(this)&&this.run()}get dirty(){return Bc(this)}}let pf=0,ul,dl;function vf(e,t=!1){if(e.flags|=8,t){e.next=dl,dl=e;return}e.next=ul,ul=e}function wu(){pf++}function Cu(){if(--pf>0)return;if(dl){let t=dl;for(dl=void 0;t;){const o=t.next;t.next=void 0,t.flags&=-9,t=o}}let e;for(;ul;){let t=ul;for(ul=void 0;t;){const o=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){e||(e=i)}t=o}}if(e)throw e}function mf(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function gf(e){let t,o=e.depsTail,i=o;for(;i;){const s=i.prevDep;i.version===-1?(i===o&&(o=s),Lu(i),cm(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=s}e.deps=t,e.depsTail=o}function Bc(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(yf(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function yf(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===kl)||(e.globalVersion=kl,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!Bc(e))))return;e.flags|=2;const t=e.dep,o=Ut,i=Yo;Ut=e,Yo=!0;try{mf(e);const s=e.fn(e._value);(t.version===0||yi(s,e._value))&&(e.flags|=128,e._value=s,t.version++)}catch(s){throw t.version++,s}finally{Ut=o,Yo=i,gf(e),e.flags&=-3}}function Lu(e,t=!1){const{dep:o,prevSub:i,nextSub:s}=e;if(i&&(i.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=i,e.nextSub=void 0),o.subs===e&&(o.subs=i,!i&&o.computed)){o.computed.flags&=-5;for(let a=o.computed.deps;a;a=a.nextDep)Lu(a,!0)}!t&&!--o.sc&&o.map&&o.map.delete(o.key)}function cm(e){const{prevDep:t,nextDep:o}=e;t&&(t.nextDep=o,e.prevDep=void 0),o&&(o.prevDep=t,e.nextDep=void 0)}let Yo=!0;const kf=[];function Hs(){kf.push(Yo),Yo=!1}function Vs(){const e=kf.pop();Yo=e===void 0?!0:e}function vd(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const o=Ut;Ut=void 0;try{t()}finally{Ut=o}}}let kl=0;class um{constructor(t,o){this.sub=t,this.dep=o,this.version=o.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Su{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!Ut||!Yo||Ut===this.computed)return;let o=this.activeLink;if(o===void 0||o.sub!==Ut)o=this.activeLink=new um(Ut,this),Ut.deps?(o.prevDep=Ut.depsTail,Ut.depsTail.nextDep=o,Ut.depsTail=o):Ut.deps=Ut.depsTail=o,_f(o);else if(o.version===-1&&(o.version=this.version,o.nextDep)){const i=o.nextDep;i.prevDep=o.prevDep,o.prevDep&&(o.prevDep.nextDep=i),o.prevDep=Ut.depsTail,o.nextDep=void 0,Ut.depsTail.nextDep=o,Ut.depsTail=o,Ut.deps===o&&(Ut.deps=i)}return o}trigger(t){this.version++,kl++,this.notify(t)}notify(t){wu();try{for(let o=this.subs;o;o=o.prevSub)o.sub.notify()&&o.sub.dep.notify()}finally{Cu()}}}function _f(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)_f(i)}const o=e.dep.subs;o!==e&&(e.prevSub=o,o&&(o.nextSub=e)),e.dep.subs=e}}const pr=new WeakMap,Yi=Symbol(""),Nc=Symbol(""),_l=Symbol("");function An(e,t,o){if(Yo&&Ut){let i=pr.get(e);i||pr.set(e,i=new Map);let s=i.get(o);s||(i.set(o,s=new Su),s.map=i,s.key=o),s.track()}}function Ds(e,t,o,i,s,a){const l=pr.get(e);if(!l){kl++;return}const u=d=>{d&&d.trigger()};if(wu(),t==="clear")l.forEach(u);else{const d=it(e),p=d&&Er(o);if(d&&o==="length"){const f=Number(i);l.forEach((m,y)=>{(y==="length"||y===_l||!Jo(y)&&y>=f)&&u(m)})}else switch((o!==void 0||l.has(void 0))&&u(l.get(o)),p&&u(l.get(_l)),t){case"add":d?p&&u(l.get("length")):(u(l.get(Yi)),La(e)&&u(l.get(Nc)));break;case"delete":d||(u(l.get(Yi)),La(e)&&u(l.get(Nc)));break;case"set":La(e)&&u(l.get(Yi));break}}Cu()}function dm(e,t){const o=pr.get(e);return o&&o.get(t)}function ma(e){const t=xt(e);return t===e?t:(An(t,"iterate",_l),mo(e)?t:t.map(Xo))}function Br(e){return An(e=xt(e),"iterate",_l),e}function hi(e,t){return Gs(e)?zs(e)?$a(Xo(t)):$a(t):Xo(t)}const hm={__proto__:null,[Symbol.iterator](){return yc(this,Symbol.iterator,e=>hi(this,e))},concat(...e){return ma(this).concat(...e.map(t=>it(t)?ma(t):t))},entries(){return yc(this,"entries",e=>(e[1]=hi(this,e[1]),e))},every(e,t){return $s(this,"every",e,t,void 0,arguments)},filter(e,t){return $s(this,"filter",e,t,o=>o.map(i=>hi(this,i)),arguments)},find(e,t){return $s(this,"find",e,t,o=>hi(this,o),arguments)},findIndex(e,t){return $s(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return $s(this,"findLast",e,t,o=>hi(this,o),arguments)},findLastIndex(e,t){return $s(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return $s(this,"forEach",e,t,void 0,arguments)},includes(...e){return kc(this,"includes",e)},indexOf(...e){return kc(this,"indexOf",e)},join(e){return ma(this).join(e)},lastIndexOf(...e){return kc(this,"lastIndexOf",e)},map(e,t){return $s(this,"map",e,t,void 0,arguments)},pop(){return el(this,"pop")},push(...e){return el(this,"push",e)},reduce(e,...t){return md(this,"reduce",e,t)},reduceRight(e,...t){return md(this,"reduceRight",e,t)},shift(){return el(this,"shift")},some(e,t){return $s(this,"some",e,t,void 0,arguments)},splice(...e){return el(this,"splice",e)},toReversed(){return ma(this).toReversed()},toSorted(e){return ma(this).toSorted(e)},toSpliced(...e){return ma(this).toSpliced(...e)},unshift(...e){return el(this,"unshift",e)},values(){return yc(this,"values",e=>hi(this,e))}};function yc(e,t,o){const i=Br(e),s=i[t]();return i!==e&&!mo(e)&&(s._next=s.next,s.next=()=>{const a=s._next();return a.done||(a.value=o(a.value)),a}),s}const fm=Array.prototype;function $s(e,t,o,i,s,a){const l=Br(e),u=l!==e&&!mo(e),d=l[t];if(d!==fm[t]){const m=d.apply(e,a);return u?Xo(m):m}let p=o;l!==e&&(u?p=function(m,y){return o.call(this,hi(e,m),y,e)}:o.length>2&&(p=function(m,y){return o.call(this,m,y,e)}));const f=d.call(l,p,i);return u&&s?s(f):f}function md(e,t,o,i){const s=Br(e);let a=o;return s!==e&&(mo(e)?o.length>3&&(a=function(l,u,d){return o.call(this,l,u,d,e)}):a=function(l,u,d){return o.call(this,l,hi(e,u),d,e)}),s[t](a,...i)}function kc(e,t,o){const i=xt(e);An(i,"iterate",_l);const s=i[t](...o);return(s===-1||s===!1)&&Nr(o[0])?(o[0]=xt(o[0]),i[t](...o)):s}function el(e,t,o=[]){Hs(),wu();const i=xt(e)[t].apply(e,o);return Cu(),Vs(),i}const pm=yu("__proto__,__v_isRef,__isVue"),bf=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Jo));function vm(e){Jo(e)||(e=String(e));const t=xt(this);return An(t,"has",e),t.hasOwnProperty(e)}class wf{constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,i){if(o==="__v_skip")return t.__v_skip;const s=this._isReadonly,a=this._isShallow;if(o==="__v_isReactive")return!s;if(o==="__v_isReadonly")return s;if(o==="__v_isShallow")return a;if(o==="__v_raw")return i===(s?a?Sm:xf:a?Sf:Lf).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const l=it(t);if(!s){let d;if(l&&(d=hm[o]))return d;if(o==="hasOwnProperty")return vm}const u=Reflect.get(t,o,Jt(t)?t:i);if((Jo(o)?bf.has(o):pm(o))||(s||An(t,"get",o),a))return u;if(Jt(u)){const d=l&&Er(o)?u:u.value;return s&&Ot(d)?Uc(d):d}return Ot(u)?s?Uc(u):Al(u):u}}class Cf extends wf{constructor(t=!1){super(!1,t)}set(t,o,i,s){let a=t[o];const l=it(t)&&Er(o);if(!this._isShallow){const p=Gs(a);if(!mo(i)&&!Gs(i)&&(a=xt(a),i=xt(i)),!l&&Jt(a)&&!Jt(i))return p||(a.value=i),!0}const u=l?Number(o)<t.length:Et(t,o),d=Reflect.set(t,o,i,Jt(t)?t:s);return t===xt(s)&&(u?yi(i,a)&&Ds(t,"set",o,i):Ds(t,"add",o,i)),d}deleteProperty(t,o){const i=Et(t,o);t[o];const s=Reflect.deleteProperty(t,o);return s&&i&&Ds(t,"delete",o,void 0),s}has(t,o){const i=Reflect.has(t,o);return(!Jo(o)||!bf.has(o))&&An(t,"has",o),i}ownKeys(t){return An(t,"iterate",it(t)?"length":Yi),Reflect.ownKeys(t)}}class mm extends wf{constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const gm=new Cf,ym=new mm,km=new Cf(!0);const Fc=e=>e,Kl=e=>Reflect.getPrototypeOf(e);function _m(e,t,o){return function(...i){const s=this.__v_raw,a=xt(s),l=La(a),u=e==="entries"||e===Symbol.iterator&&l,d=e==="keys"&&l,p=s[e](...i),f=o?Fc:t?$a:Xo;return!t&&An(a,"iterate",d?Nc:Yi),{next(){const{value:m,done:y}=p.next();return y?{value:m,done:y}:{value:u?[f(m[0]),f(m[1])]:f(m),done:y}},[Symbol.iterator](){return this}}}}function Yl(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function bm(e,t){const o={get(s){const a=this.__v_raw,l=xt(a),u=xt(s);e||(yi(s,u)&&An(l,"get",s),An(l,"get",u));const{has:d}=Kl(l),p=t?Fc:e?$a:Xo;if(d.call(l,s))return p(a.get(s));if(d.call(l,u))return p(a.get(u));a!==l&&a.get(s)},get size(){const s=this.__v_raw;return!e&&An(xt(s),"iterate",Yi),s.size},has(s){const a=this.__v_raw,l=xt(a),u=xt(s);return e||(yi(s,u)&&An(l,"has",s),An(l,"has",u)),s===u?a.has(s):a.has(s)||a.has(u)},forEach(s,a){const l=this,u=l.__v_raw,d=xt(u),p=t?Fc:e?$a:Xo;return!e&&An(d,"iterate",Yi),u.forEach((f,m)=>s.call(a,p(f),p(m),l))}};return yn(o,e?{add:Yl("add"),set:Yl("set"),delete:Yl("delete"),clear:Yl("clear")}:{add(s){!t&&!mo(s)&&!Gs(s)&&(s=xt(s));const a=xt(this);return Kl(a).has.call(a,s)||(a.add(s),Ds(a,"add",s,s)),this},set(s,a){!t&&!mo(a)&&!Gs(a)&&(a=xt(a));const l=xt(this),{has:u,get:d}=Kl(l);let p=u.call(l,s);p||(s=xt(s),p=u.call(l,s));const f=d.call(l,s);return l.set(s,a),p?yi(a,f)&&Ds(l,"set",s,a):Ds(l,"add",s,a),this},delete(s){const a=xt(this),{has:l,get:u}=Kl(a);let d=l.call(a,s);d||(s=xt(s),d=l.call(a,s)),u&&u.call(a,s);const p=a.delete(s);return d&&Ds(a,"delete",s,void 0),p},clear(){const s=xt(this),a=s.size!==0,l=s.clear();return a&&Ds(s,"clear",void 0,void 0),l}}),["keys","values","entries",Symbol.iterator].forEach(s=>{o[s]=_m(s,e,t)}),o}function xu(e,t){const o=bm(e,t);return(i,s,a)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?i:Reflect.get(Et(o,s)&&s in i?o:i,s,a)}const wm={get:xu(!1,!1)},Cm={get:xu(!1,!0)},Lm={get:xu(!0,!1)};const Lf=new WeakMap,Sf=new WeakMap,xf=new WeakMap,Sm=new WeakMap;function xm(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Im(e){return e.__v_skip||!Object.isExtensible(e)?0:xm(Yv(e))}function Al(e){return Gs(e)?e:Iu(e,!1,gm,wm,Lf)}function If(e){return Iu(e,!1,km,Cm,Sf)}function Uc(e){return Iu(e,!0,ym,Lm,xf)}function Iu(e,t,o,i,s){if(!Ot(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=Im(e);if(a===0)return e;const l=s.get(e);if(l)return l;const u=new Proxy(e,a===2?i:o);return s.set(e,u),u}function zs(e){return Gs(e)?zs(e.__v_raw):!!(e&&e.__v_isReactive)}function Gs(e){return!!(e&&e.__v_isReadonly)}function mo(e){return!!(e&&e.__v_isShallow)}function Nr(e){return e?!!e.__v_raw:!1}function xt(e){const t=e&&e.__v_raw;return t?xt(t):e}function $u(e){return!Et(e,"__v_skip")&&Object.isExtensible(e)&&af(e,"__v_skip",!0),e}const Xo=e=>Ot(e)?Al(e):e,$a=e=>Ot(e)?Uc(e):e;function Jt(e){return e?e.__v_isRef===!0:!1}function M(e){return $f(e,!1)}function $m(e){return $f(e,!0)}function $f(e,t){return Jt(e)?e:new Tm(e,t)}class Tm{constructor(t,o){this.dep=new Su,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=o?t:xt(t),this._value=o?t:Xo(t),this.__v_isShallow=o}get value(){return this.dep.track(),this._value}set value(t){const o=this._rawValue,i=this.__v_isShallow||mo(t)||Gs(t);t=i?t:xt(t),yi(t,o)&&(this._rawValue=t,this._value=i?t:Xo(t),this.dep.trigger())}}function V(e){return Jt(e)?e.value:e}const Mm={get:(e,t,o)=>t==="__v_raw"?e:V(Reflect.get(e,t,o)),set:(e,t,o,i)=>{const s=e[t];return Jt(s)&&!Jt(o)?(s.value=o,!0):Reflect.set(e,t,o,i)}};function Tf(e){return zs(e)?e:new Proxy(e,Mm)}function Am(e){const t=it(e)?new Array(e.length):{};for(const o in e)t[o]=Pm(e,o);return t}class Em{constructor(t,o,i){this._object=t,this._key=o,this._defaultValue=i,this.__v_isRef=!0,this._value=void 0,this._raw=xt(t);let s=!0,a=t;if(!it(t)||!Er(String(o)))do s=!Nr(a)||mo(a);while(s&&(a=a.__v_raw));this._shallow=s}get value(){let t=this._object[this._key];return this._shallow&&(t=V(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&Jt(this._raw[this._key])){const o=this._object[this._key];if(Jt(o)){o.value=t;return}}this._object[this._key]=t}get dep(){return dm(this._raw,this._key)}}function Pm(e,t,o){return new Em(e,t,o)}class Dm{constructor(t,o,i){this.fn=t,this.setter=o,this._value=void 0,this.dep=new Su(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=kl-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!o,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&Ut!==this)return vf(this,!0),!0}get value(){const t=this.dep.track();return yf(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Rm(e,t,o=!1){let i,s;return ft(e)?i=e:(i=e.get,s=e.set),new Dm(i,s,o)}const Jl={},vr=new WeakMap;let Vi;function Om(e,t=!1,o=Vi){if(o){let i=vr.get(o);i||vr.set(o,i=[]),i.push(e)}}function Bm(e,t,o=Bt){const{immediate:i,deep:s,once:a,scheduler:l,augmentJob:u,call:d}=o,p=A=>s?A:mo(A)||s===!1||s===0?Rs(A,1):Rs(A);let f,m,y,_,b=!1,S=!1;if(Jt(e)?(m=()=>e.value,b=mo(e)):zs(e)?(m=()=>p(e),b=!0):it(e)?(S=!0,b=e.some(A=>zs(A)||mo(A)),m=()=>e.map(A=>{if(Jt(A))return A.value;if(zs(A))return p(A);if(ft(A))return d?d(A,2):A()})):ft(e)?t?m=d?()=>d(e,2):e:m=()=>{if(y){Hs();try{y()}finally{Vs()}}const A=Vi;Vi=f;try{return d?d(e,3,[_]):e(_)}finally{Vi=A}}:m=Ko,t&&s){const A=m,E=s===!0?1/0:s;m=()=>Rs(A(),E)}const T=hf(),D=()=>{f.stop(),T&&T.active&&_u(T.effects,f)};if(a&&t){const A=t;t=(...E)=>{A(...E),D()}}let I=S?new Array(e.length).fill(Jl):Jl;const C=A=>{if(!(!(f.flags&1)||!f.dirty&&!A))if(t){const E=f.run();if(s||b||(S?E.some((N,$)=>yi(N,I[$])):yi(E,I))){y&&y();const N=Vi;Vi=f;try{const $=[E,I===Jl?void 0:S&&I[0]===Jl?[]:I,_];I=E,d?d(t,3,$):t(...$)}finally{Vi=N}}}else f.run()};return u&&u(C),f=new ff(m),f.scheduler=l?()=>l(C,!1):C,_=A=>Om(A,!1,f),y=f.onStop=()=>{const A=vr.get(f);if(A){if(d)d(A,4);else for(const E of A)E();vr.delete(f)}},t?i?C(!0):I=f.run():l?l(C.bind(null,!0),!0):f.run(),D.pause=f.pause.bind(f),D.resume=f.resume.bind(f),D.stop=D,D}function Rs(e,t=1/0,o){if(t<=0||!Ot(e)||e.__v_skip||(o=o||new Map,(o.get(e)||0)>=t))return e;if(o.set(e,t),t--,Jt(e))Rs(e.value,t,o);else if(it(e))for(let i=0;i<e.length;i++)Rs(e[i],t,o);else if(Da(e)||La(e))e.forEach(i=>{Rs(i,t,o)});else if(sf(e)){for(const i in e)Rs(e[i],t,o);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&Rs(e[i],t,o)}return e}function El(e,t,o,i){try{return i?e(...i):e()}catch(s){Fr(s,t,o)}}function Qo(e,t,o,i){if(ft(e)){const s=El(e,t,o,i);return s&&nf(s)&&s.catch(a=>{Fr(a,t,o)}),s}if(it(e)){const s=[];for(let a=0;a<e.length;a++)s.push(Qo(e[a],t,o,i));return s}}function Fr(e,t,o,i=!0){const s=t?t.vnode:null,{errorHandler:a,throwUnhandledErrorInProduction:l}=t&&t.appContext.config||Bt;if(t){let u=t.parent;const d=t.proxy,p=`https://vuejs.org/error-reference/#runtime-${o}`;for(;u;){const f=u.ec;if(f){for(let m=0;m<f.length;m++)if(f[m](e,d,p)===!1)return}u=u.parent}if(a){Hs(),El(a,null,10,[e,d,p]),Vs();return}}Nm(e,o,s,i,l)}function Nm(e,t,o,i=!0,s=!1){if(s)throw e;console.error(e)}const Zn=[];let rs=-1;const Sa=[];let fi=null,ya=0;const Mf=Promise.resolve();let mr=null;function qn(e){const t=mr||Mf;return e?t.then(this?e.bind(this):e):t}function Fm(e){let t=rs+1,o=Zn.length;for(;t<o;){const i=t+o>>>1,s=Zn[i],a=bl(s);a<e||a===e&&s.flags&2?t=i+1:o=i}return t}function Tu(e){if(!(e.flags&1)){const t=bl(e),o=Zn[Zn.length-1];!o||!(e.flags&2)&&t>=bl(o)?Zn.push(e):Zn.splice(Fm(t),0,e),e.flags|=1,Af()}}function Af(){mr||(mr=Mf.then(Df))}function Ef(e){it(e)?Sa.push(...e):fi&&e.id===-1?fi.splice(ya+1,0,e):e.flags&1||(Sa.push(e),e.flags|=1),Af()}function gd(e,t,o=rs+1){for(;o<Zn.length;o++){const i=Zn[o];if(i&&i.flags&2){if(e&&i.id!==e.uid)continue;Zn.splice(o,1),o--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function Pf(e){if(Sa.length){const t=[...new Set(Sa)].sort((o,i)=>bl(o)-bl(i));if(Sa.length=0,fi){fi.push(...t);return}for(fi=t,ya=0;ya<fi.length;ya++){const o=fi[ya];o.flags&4&&(o.flags&=-2),o.flags&8||o(),o.flags&=-2}fi=null,ya=0}}const bl=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Df(e){try{for(rs=0;rs<Zn.length;rs++){const t=Zn[rs];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),El(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;rs<Zn.length;rs++){const t=Zn[rs];t&&(t.flags&=-2)}rs=-1,Zn.length=0,Pf(),mr=null,(Zn.length||Sa.length)&&Df()}}let Ln=null,Rf=null;function gr(e){const t=Ln;return Ln=e,Rf=e&&e.type.__scopeId||null,t}function Ue(e,t=Ln,o){if(!t||e._n)return e;const i=(...s)=>{i._d&&_r(-1);const a=gr(t);let l;try{l=e(...s)}finally{gr(a),i._d&&_r(1)}return l};return i._n=!0,i._c=!0,i._d=!0,i}function Ve(e,t){if(Ln===null)return e;const o=jr(Ln),i=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[a,l,u,d=Bt]=t[s];a&&(ft(a)&&(a={mounted:a,updated:a}),a.deep&&Rs(l),i.push({dir:a,instance:o,value:l,oldValue:void 0,arg:u,modifiers:d}))}return e}function Ni(e,t,o,i){const s=e.dirs,a=t&&t.dirs;for(let l=0;l<s.length;l++){const u=s[l];a&&(u.oldValue=a[l].value);let d=u.dir[i];d&&(Hs(),Qo(d,o,8,[e.el,u,e,t]),Vs())}}function ir(e,t){if(Pn){let o=Pn.provides;const i=Pn.parent&&Pn.parent.provides;i===o&&(o=Pn.provides=Object.create(i)),o[e]=t}}function To(e,t,o=!1){const i=Gr();if(i||Ji){let s=Ji?Ji._context.provides:i?i.parent==null||i.ce?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return o&&ft(t)?t.call(i&&i.proxy):t}}function Um(){return!!(Gr()||Ji)}const zm=Symbol.for("v-scx"),Hm=()=>To(zm);function Ze(e,t,o){return Of(e,t,o)}function Of(e,t,o=Bt){const{immediate:i,deep:s,flush:a,once:l}=o,u=yn({},o),d=t&&i||!t&&a!=="post";let p;if(Sl){if(a==="sync"){const _=Hm();p=_.__watcherHandles||(_.__watcherHandles=[])}else if(!d){const _=()=>{};return _.stop=Ko,_.resume=Ko,_.pause=Ko,_}}const f=Pn;u.call=(_,b,S)=>Qo(_,f,b,S);let m=!1;a==="post"?u.scheduler=_=>{Gn(_,f&&f.suspense)}:a!=="sync"&&(m=!0,u.scheduler=(_,b)=>{b?_():Tu(_)}),u.augmentJob=_=>{t&&(_.flags|=4),m&&(_.flags|=2,f&&(_.id=f.uid,_.i=f))};const y=Bm(e,t,u);return Sl&&(p?p.push(y):d&&y()),y}function Vm(e,t,o){const i=this.proxy,s=Xt(e)?e.includes(".")?Bf(i,e):()=>i[e]:e.bind(i,i);let a;ft(t)?a=t:(a=t.handler,o=t);const l=Pl(this),u=Of(s,a.bind(i),o);return l(),u}function Bf(e,t){const o=t.split(".");return()=>{let i=e;for(let s=0;s<o.length&&i;s++)i=i[o[s]];return i}}const Nf=Symbol("_vte"),Ff=e=>e.__isTeleport,hl=e=>e&&(e.disabled||e.disabled===""),yd=e=>e&&(e.defer||e.defer===""),kd=e=>typeof SVGElement<"u"&&e instanceof SVGElement,_d=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,zc=(e,t)=>{const o=e&&e.to;return Xt(o)?t?t(o):null:o},Uf={name:"Teleport",__isTeleport:!0,process(e,t,o,i,s,a,l,u,d,p){const{mc:f,pc:m,pbc:y,o:{insert:_,querySelector:b,createText:S,createComment:T}}=p,D=hl(t.props);let{shapeFlag:I,children:C,dynamicChildren:A}=t;if(e==null){const E=t.el=S(""),N=t.anchor=S("");_(E,o,i),_(N,o,i);const $=(R,Z)=>{I&16&&f(C,R,Z,s,a,l,u,d)},G=()=>{const R=t.target=zc(t.props,b),Z=zf(R,t,S,_);R&&(l!=="svg"&&kd(R)?l="svg":l!=="mathml"&&_d(R)&&(l="mathml"),s&&s.isCE&&(s.ce._teleportTargets||(s.ce._teleportTargets=new Set)).add(R),D||($(R,Z),ar(t,!1)))};D&&($(o,N),ar(t,!0)),yd(t.props)?(t.el.__isMounted=!1,Gn(()=>{G(),delete t.el.__isMounted},a)):G()}else{if(yd(t.props)&&e.el.__isMounted===!1){Gn(()=>{Uf.process(e,t,o,i,s,a,l,u,d,p)},a);return}t.el=e.el,t.targetStart=e.targetStart;const E=t.anchor=e.anchor,N=t.target=e.target,$=t.targetAnchor=e.targetAnchor,G=hl(e.props),R=G?o:N,Z=G?E:$;if(l==="svg"||kd(N)?l="svg":(l==="mathml"||_d(N))&&(l="mathml"),A?(y(e.dynamicChildren,A,R,s,a,l,u),Du(e,t,!0)):d||m(e,t,R,Z,s,a,l,u,!1),D)G?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):Xl(t,o,E,p,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const U=t.target=zc(t.props,b);U&&Xl(t,U,null,p,0)}else G&&Xl(t,N,$,p,1);ar(t,D)}},remove(e,t,o,{um:i,o:{remove:s}},a){const{shapeFlag:l,children:u,anchor:d,targetStart:p,targetAnchor:f,target:m,props:y}=e;if(m&&(s(p),s(f)),a&&s(d),l&16){const _=a||!hl(y);for(let b=0;b<u.length;b++){const S=u[b];i(S,t,o,_,!!S.dynamicChildren)}}},move:Xl,hydrate:Gm};function Xl(e,t,o,{o:{insert:i},m:s},a=2){a===0&&i(e.targetAnchor,t,o);const{el:l,anchor:u,shapeFlag:d,children:p,props:f}=e,m=a===2;if(m&&i(l,t,o),(!m||hl(f))&&d&16)for(let y=0;y<p.length;y++)s(p[y],t,o,2);m&&i(u,t,o)}function Gm(e,t,o,i,s,a,{o:{nextSibling:l,parentNode:u,querySelector:d,insert:p,createText:f}},m){function y(S,T,D,I){T.anchor=m(l(S),T,u(S),o,i,s,a),T.targetStart=D,T.targetAnchor=I}const _=t.target=zc(t.props,d),b=hl(t.props);if(_){const S=_._lpa||_.firstChild;if(t.shapeFlag&16)if(b)y(e,t,S,S&&l(S));else{t.anchor=l(e);let T=S;for(;T;){if(T&&T.nodeType===8){if(T.data==="teleport start anchor")t.targetStart=T;else if(T.data==="teleport anchor"){t.targetAnchor=T,_._lpa=t.targetAnchor&&l(t.targetAnchor);break}}T=l(T)}t.targetAnchor||zf(_,t,f,p),m(S&&l(S),t,_,o,i,s,a)}ar(t,b)}else b&&t.shapeFlag&16&&y(e,t,e,l(e));return t.anchor&&l(t.anchor)}const Mu=Uf;function ar(e,t){const o=e.ctx;if(o&&o.ut){let i,s;for(t?(i=e.el,s=e.anchor):(i=e.targetStart,s=e.targetAnchor);i&&i!==s;)i.nodeType===1&&i.setAttribute("data-v-owner",o.uid),i=i.nextSibling;o.ut()}}function zf(e,t,o,i){const s=t.targetStart=o(""),a=t.targetAnchor=o("");return s[Nf]=a,e&&(i(s,e),i(a,e)),a}const Es=Symbol("_leaveCb"),Ql=Symbol("_enterCb");function jm(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Qt(()=>{e.isMounted=!0}),Jf(()=>{e.isUnmounting=!0}),e}const $o=[Function,Array],Hf={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:$o,onEnter:$o,onAfterEnter:$o,onEnterCancelled:$o,onBeforeLeave:$o,onLeave:$o,onAfterLeave:$o,onLeaveCancelled:$o,onBeforeAppear:$o,onAppear:$o,onAfterAppear:$o,onAppearCancelled:$o},Vf=e=>{const t=e.subTree;return t.component?Vf(t.component):t},Zm={name:"BaseTransition",props:Hf,setup(e,{slots:t}){const o=Gr(),i=jm();return()=>{const s=t.default&&Zf(t.default(),!0);if(!s||!s.length)return;const a=Gf(s),l=xt(e),{mode:u}=l;if(i.isLeaving)return _c(a);const d=bd(a);if(!d)return _c(a);let p=Hc(d,l,i,o,m=>p=m);d.type!==En&&wl(d,p);let f=o.subTree&&bd(o.subTree);if(f&&f.type!==En&&!Gi(f,d)&&Vf(o).type!==En){let m=Hc(f,l,i,o);if(wl(f,m),u==="out-in"&&d.type!==En)return i.isLeaving=!0,m.afterLeave=()=>{i.isLeaving=!1,o.job.flags&8||o.update(),delete m.afterLeave,f=void 0},_c(a);u==="in-out"&&d.type!==En?m.delayLeave=(y,_,b)=>{const S=jf(i,f);S[String(f.key)]=f,y[Es]=()=>{_(),y[Es]=void 0,delete p.delayedLeave,f=void 0},p.delayedLeave=()=>{b(),delete p.delayedLeave,f=void 0}}:f=void 0}else f&&(f=void 0);return a}}};function Gf(e){let t=e[0];if(e.length>1){for(const o of e)if(o.type!==En){t=o;break}}return t}const qm=Zm;function jf(e,t){const{leavingVNodes:o}=e;let i=o.get(t.type);return i||(i=Object.create(null),o.set(t.type,i)),i}function Hc(e,t,o,i,s){const{appear:a,mode:l,persisted:u=!1,onBeforeEnter:d,onEnter:p,onAfterEnter:f,onEnterCancelled:m,onBeforeLeave:y,onLeave:_,onAfterLeave:b,onLeaveCancelled:S,onBeforeAppear:T,onAppear:D,onAfterAppear:I,onAppearCancelled:C}=t,A=String(e.key),E=jf(o,e),N=(R,Z)=>{R&&Qo(R,i,9,Z)},$=(R,Z)=>{const U=Z[1];N(R,Z),it(R)?R.every(K=>K.length<=1)&&U():R.length<=1&&U()},G={mode:l,persisted:u,beforeEnter(R){let Z=d;if(!o.isMounted)if(a)Z=T||d;else return;R[Es]&&R[Es](!0);const U=E[A];U&&Gi(e,U)&&U.el[Es]&&U.el[Es](),N(Z,[R])},enter(R){let Z=p,U=f,K=m;if(!o.isMounted)if(a)Z=D||p,U=I||f,K=C||m;else return;let re=!1;const Pe=R[Ql]=me=>{re||(re=!0,me?N(K,[R]):N(U,[R]),G.delayedLeave&&G.delayedLeave(),R[Ql]=void 0)};Z?$(Z,[R,Pe]):Pe()},leave(R,Z){const U=String(e.key);if(R[Ql]&&R[Ql](!0),o.isUnmounting)return Z();N(y,[R]);let K=!1;const re=R[Es]=Pe=>{K||(K=!0,Z(),Pe?N(S,[R]):N(b,[R]),R[Es]=void 0,E[U]===e&&delete E[U])};E[U]=e,_?$(_,[R,re]):re()},clone(R){const Z=Hc(R,t,o,i,s);return s&&s(Z),Z}};return G}function _c(e){if(Ur(e))return e=_i(e),e.children=null,e}function bd(e){if(!Ur(e))return Ff(e.type)&&e.children?Gf(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:o}=e;if(o){if(t&16)return o[0];if(t&32&&ft(o.default))return o.default()}}function wl(e,t){e.shapeFlag&6&&e.component?(e.transition=t,wl(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Zf(e,t=!1,o){let i=[],s=0;for(let a=0;a<e.length;a++){let l=e[a];const u=o==null?l.key:String(o)+String(l.key!=null?l.key:a);l.type===xe?(l.patchFlag&128&&s++,i=i.concat(Zf(l.children,t,u))):(t||l.type!==En)&&i.push(u!=null?_i(l,{key:u}):l)}if(s>1)for(let a=0;a<i.length;a++)i[a].patchFlag=-2;return i}function qf(e,t){return ft(e)?yn({name:e.name},t,{setup:e}):e}function Wf(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const yr=new WeakMap;function fl(e,t,o,i,s=!1){if(it(e)){e.forEach((b,S)=>fl(b,t&&(it(t)?t[S]:t),o,i,s));return}if(xa(i)&&!s){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&fl(e,t,o,i.component.subTree);return}const a=i.shapeFlag&4?jr(i.component):i.el,l=s?null:a,{i:u,r:d}=e,p=t&&t.r,f=u.refs===Bt?u.refs={}:u.refs,m=u.setupState,y=xt(m),_=m===Bt?tf:b=>Et(y,b);if(p!=null&&p!==d){if(wd(t),Xt(p))f[p]=null,_(p)&&(m[p]=null);else if(Jt(p)){p.value=null;const b=t;b.k&&(f[b.k]=null)}}if(ft(d))El(d,u,12,[l,f]);else{const b=Xt(d),S=Jt(d);if(b||S){const T=()=>{if(e.f){const D=b?_(d)?m[d]:f[d]:d.value;if(s)it(D)&&_u(D,a);else if(it(D))D.includes(a)||D.push(a);else if(b)f[d]=[a],_(d)&&(m[d]=f[d]);else{const I=[a];d.value=I,e.k&&(f[e.k]=I)}}else b?(f[d]=l,_(d)&&(m[d]=l)):S&&(d.value=l,e.k&&(f[e.k]=l))};if(l){const D=()=>{T(),yr.delete(e)};D.id=-1,yr.set(e,D),Gn(D,o)}else wd(e),T()}}}function wd(e){const t=yr.get(e);t&&(t.flags|=8,yr.delete(e))}Or().requestIdleCallback;Or().cancelIdleCallback;const xa=e=>!!e.type.__asyncLoader,Ur=e=>e.type.__isKeepAlive;function Wm(e,t){Kf(e,"a",t)}function Km(e,t){Kf(e,"da",t)}function Kf(e,t,o=Pn){const i=e.__wdc||(e.__wdc=()=>{let s=o;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(zr(t,i,o),o){let s=o.parent;for(;s&&s.parent;)Ur(s.parent.vnode)&&Ym(i,t,o,s),s=s.parent}}function Ym(e,t,o,i){const s=zr(t,e,i,!0);On(()=>{_u(i[t],s)},o)}function zr(e,t,o=Pn,i=!1){if(o){const s=o[e]||(o[e]=[]),a=t.__weh||(t.__weh=(...l)=>{Hs();const u=Pl(o),d=Qo(t,o,e,l);return u(),Vs(),d});return i?s.unshift(a):s.push(a),a}}const Zs=e=>(t,o=Pn)=>{(!Sl||e==="sp")&&zr(e,(...i)=>t(...i),o)},Jm=Zs("bm"),Qt=Zs("m"),Yf=Zs("bu"),Xm=Zs("u"),Jf=Zs("bum"),On=Zs("um"),Qm=Zs("sp"),eg=Zs("rtg"),tg=Zs("rtc");function ng(e,t=Pn){zr("ec",e,t)}const og="components";function Au(e,t){return ig(og,e,!0,t)||e}const sg=Symbol.for("v-ndc");function ig(e,t,o=!0,i=!1){const s=Ln||Pn;if(s){const a=s.type;{const u=Hg(a,!1);if(u&&(u===t||u===Ao(t)||u===Dr(Ao(t))))return a}const l=Cd(s[e]||a[e],t)||Cd(s.appContext[e],t);return!l&&i?a:l}}function Cd(e,t){return e&&(e[t]||e[Ao(t)]||e[Dr(Ao(t))])}function Be(e,t,o,i){let s;const a=o,l=it(e);if(l||Xt(e)){const u=l&&zs(e);let d=!1,p=!1;u&&(d=!mo(e),p=Gs(e),e=Br(e)),s=new Array(e.length);for(let f=0,m=e.length;f<m;f++)s[f]=t(d?p?$a(Xo(e[f])):Xo(e[f]):e[f],f,void 0,a)}else if(typeof e=="number"){s=new Array(e);for(let u=0;u<e;u++)s[u]=t(u+1,u,void 0,a)}else if(Ot(e))if(e[Symbol.iterator])s=Array.from(e,(u,d)=>t(u,d,void 0,a));else{const u=Object.keys(e);s=new Array(u.length);for(let d=0,p=u.length;d<p;d++){const f=u[d];s[d]=t(e[f],f,d,a)}}else s=[];return s}function Xf(e,t){for(let o=0;o<t.length;o++){const i=t[o];if(it(i))for(let s=0;s<i.length;s++)e[i[s].name]=i[s].fn;else i&&(e[i.name]=i.key?(...s)=>{const a=i.fn(...s);return a&&(a.key=i.key),a}:i.fn)}return e}function to(e,t,o={},i,s){if(Ln.ce||Ln.parent&&xa(Ln.parent)&&Ln.parent.ce){const p=Object.keys(o).length>0;return t!=="default"&&(o.name=t),v(),je(xe,null,[Ee("slot",o,i&&i())],p?-2:64)}let a=e[t];a&&a._c&&(a._d=!1),v();const l=a&&Qf(a(o)),u=o.key||l&&l.key,d=je(xe,{key:(u&&!Jo(u)?u:`_${t}`)+(!l&&i?"_fb":"")},l||(i?i():[]),l&&e._===1?64:-2);return a&&a._c&&(a._d=!0),d}function Qf(e){return e.some(t=>Ll(t)?!(t.type===En||t.type===xe&&!Qf(t.children)):!0)?e:null}const Vc=e=>e?yp(e)?jr(e):Vc(e.parent):null,pl=yn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Vc(e.parent),$root:e=>Vc(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>tp(e),$forceUpdate:e=>e.f||(e.f=()=>{Tu(e.update)}),$nextTick:e=>e.n||(e.n=qn.bind(e.proxy)),$watch:e=>Vm.bind(e)}),bc=(e,t)=>e!==Bt&&!e.__isScriptSetup&&Et(e,t),ag={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:o,setupState:i,data:s,props:a,accessCache:l,type:u,appContext:d}=e;if(t[0]!=="$"){const y=l[t];if(y!==void 0)switch(y){case 1:return i[t];case 2:return s[t];case 4:return o[t];case 3:return a[t]}else{if(bc(i,t))return l[t]=1,i[t];if(s!==Bt&&Et(s,t))return l[t]=2,s[t];if(Et(a,t))return l[t]=3,a[t];if(o!==Bt&&Et(o,t))return l[t]=4,o[t];Gc&&(l[t]=0)}}const p=pl[t];let f,m;if(p)return t==="$attrs"&&An(e.attrs,"get",""),p(e);if((f=u.__cssModules)&&(f=f[t]))return f;if(o!==Bt&&Et(o,t))return l[t]=4,o[t];if(m=d.config.globalProperties,Et(m,t))return m[t]},set({_:e},t,o){const{data:i,setupState:s,ctx:a}=e;return bc(s,t)?(s[t]=o,!0):i!==Bt&&Et(i,t)?(i[t]=o,!0):Et(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=o,!0)},has({_:{data:e,setupState:t,accessCache:o,ctx:i,appContext:s,props:a,type:l}},u){let d;return!!(o[u]||e!==Bt&&u[0]!=="$"&&Et(e,u)||bc(t,u)||Et(a,u)||Et(i,u)||Et(pl,u)||Et(s.config.globalProperties,u)||(d=l.__cssModules)&&d[u])},defineProperty(e,t,o){return o.get!=null?e._.accessCache[t]=0:Et(o,"value")&&this.set(e,t,o.value,null),Reflect.defineProperty(e,t,o)}};function Ld(e){return it(e)?e.reduce((t,o)=>(t[o]=null,t),{}):e}let Gc=!0;function lg(e){const t=tp(e),o=e.proxy,i=e.ctx;Gc=!1,t.beforeCreate&&Sd(t.beforeCreate,e,"bc");const{data:s,computed:a,methods:l,watch:u,provide:d,inject:p,created:f,beforeMount:m,mounted:y,beforeUpdate:_,updated:b,activated:S,deactivated:T,beforeDestroy:D,beforeUnmount:I,destroyed:C,unmounted:A,render:E,renderTracked:N,renderTriggered:$,errorCaptured:G,serverPrefetch:R,expose:Z,inheritAttrs:U,components:K,directives:re,filters:Pe}=t;if(p&&rg(p,i,null),l)for(const Fe in l){const ae=l[Fe];ft(ae)&&(i[Fe]=ae.bind(o))}if(s){const Fe=s.call(o,o);Ot(Fe)&&(e.data=Al(Fe))}if(Gc=!0,a)for(const Fe in a){const ae=a[Fe],Me=ft(ae)?ae.bind(o,o):ft(ae.get)?ae.get.bind(o,o):Ko,ge=!ft(ae)&&ft(ae.set)?ae.set.bind(o):Ko,de=H({get:Me,set:ge});Object.defineProperty(i,Fe,{enumerable:!0,configurable:!0,get:()=>de.value,set:Oe=>de.value=Oe})}if(u)for(const Fe in u)ep(u[Fe],i,o,Fe);if(d){const Fe=ft(d)?d.call(o):d;Reflect.ownKeys(Fe).forEach(ae=>{ir(ae,Fe[ae])})}f&&Sd(f,e,"c");function Ae(Fe,ae){it(ae)?ae.forEach(Me=>Fe(Me.bind(o))):ae&&Fe(ae.bind(o))}if(Ae(Jm,m),Ae(Qt,y),Ae(Yf,_),Ae(Xm,b),Ae(Wm,S),Ae(Km,T),Ae(ng,G),Ae(tg,N),Ae(eg,$),Ae(Jf,I),Ae(On,A),Ae(Qm,R),it(Z))if(Z.length){const Fe=e.exposed||(e.exposed={});Z.forEach(ae=>{Object.defineProperty(Fe,ae,{get:()=>o[ae],set:Me=>o[ae]=Me,enumerable:!0})})}else e.exposed||(e.exposed={});E&&e.render===Ko&&(e.render=E),U!=null&&(e.inheritAttrs=U),K&&(e.components=K),re&&(e.directives=re),R&&Wf(e)}function rg(e,t,o=Ko){it(e)&&(e=jc(e));for(const i in e){const s=e[i];let a;Ot(s)?"default"in s?a=To(s.from||i,s.default,!0):a=To(s.from||i):a=To(s),Jt(a)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>a.value,set:l=>a.value=l}):t[i]=a}}function Sd(e,t,o){Qo(it(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,o)}function ep(e,t,o,i){let s=i.includes(".")?Bf(o,i):()=>o[i];if(Xt(e)){const a=t[e];ft(a)&&Ze(s,a)}else if(ft(e))Ze(s,e.bind(o));else if(Ot(e))if(it(e))e.forEach(a=>ep(a,t,o,i));else{const a=ft(e.handler)?e.handler.bind(o):t[e.handler];ft(a)&&Ze(s,a,e)}}function tp(e){const t=e.type,{mixins:o,extends:i}=t,{mixins:s,optionsCache:a,config:{optionMergeStrategies:l}}=e.appContext,u=a.get(t);let d;return u?d=u:!s.length&&!o&&!i?d=t:(d={},s.length&&s.forEach(p=>kr(d,p,l,!0)),kr(d,t,l)),Ot(t)&&a.set(t,d),d}function kr(e,t,o,i=!1){const{mixins:s,extends:a}=t;a&&kr(e,a,o,!0),s&&s.forEach(l=>kr(e,l,o,!0));for(const l in t)if(!(i&&l==="expose")){const u=cg[l]||o&&o[l];e[l]=u?u(e[l],t[l]):t[l]}return e}const cg={data:xd,props:Id,emits:Id,methods:il,computed:il,beforeCreate:Vn,created:Vn,beforeMount:Vn,mounted:Vn,beforeUpdate:Vn,updated:Vn,beforeDestroy:Vn,beforeUnmount:Vn,destroyed:Vn,unmounted:Vn,activated:Vn,deactivated:Vn,errorCaptured:Vn,serverPrefetch:Vn,components:il,directives:il,watch:dg,provide:xd,inject:ug};function xd(e,t){return t?e?function(){return yn(ft(e)?e.call(this,this):e,ft(t)?t.call(this,this):t)}:t:e}function ug(e,t){return il(jc(e),jc(t))}function jc(e){if(it(e)){const t={};for(let o=0;o<e.length;o++)t[e[o]]=e[o];return t}return e}function Vn(e,t){return e?[...new Set([].concat(e,t))]:t}function il(e,t){return e?yn(Object.create(null),e,t):t}function Id(e,t){return e?it(e)&&it(t)?[...new Set([...e,...t])]:yn(Object.create(null),Ld(e),Ld(t??{})):t}function dg(e,t){if(!e)return t;if(!t)return e;const o=yn(Object.create(null),e);for(const i in t)o[i]=Vn(e[i],t[i]);return o}function np(){return{app:null,config:{isNativeTag:tf,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let hg=0;function fg(e,t){return function(i,s=null){ft(i)||(i=yn({},i)),s!=null&&!Ot(s)&&(s=null);const a=np(),l=new WeakSet,u=[];let d=!1;const p=a.app={_uid:hg++,_component:i,_props:s,_container:null,_context:a,_instance:null,version:Gg,get config(){return a.config},set config(f){},use(f,...m){return l.has(f)||(f&&ft(f.install)?(l.add(f),f.install(p,...m)):ft(f)&&(l.add(f),f(p,...m))),p},mixin(f){return a.mixins.includes(f)||a.mixins.push(f),p},component(f,m){return m?(a.components[f]=m,p):a.components[f]},directive(f,m){return m?(a.directives[f]=m,p):a.directives[f]},mount(f,m,y){if(!d){const _=p._ceVNode||Ee(i,s);return _.appContext=a,y===!0?y="svg":y===!1&&(y=void 0),e(_,f,y),d=!0,p._container=f,f.__vue_app__=p,jr(_.component)}},onUnmount(f){u.push(f)},unmount(){d&&(Qo(u,p._instance,16),e(null,p._container),delete p._container.__vue_app__)},provide(f,m){return a.provides[f]=m,p},runWithContext(f){const m=Ji;Ji=p;try{return f()}finally{Ji=m}}};return p}}let Ji=null;const pg=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Ao(t)}Modifiers`]||e[`${Ci(t)}Modifiers`];function vg(e,t,...o){if(e.isUnmounted)return;const i=e.vnode.props||Bt;let s=o;const a=t.startsWith("update:"),l=a&&pg(i,t.slice(7));l&&(l.trim&&(s=o.map(f=>Xt(f)?f.trim():f)),l.number&&(s=o.map(Rr)));let u,d=i[u=vc(t)]||i[u=vc(Ao(t))];!d&&a&&(d=i[u=vc(Ci(t))]),d&&Qo(d,e,6,s);const p=i[u+"Once"];if(p){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,Qo(p,e,6,s)}}const mg=new WeakMap;function op(e,t,o=!1){const i=o?mg:t.emitsCache,s=i.get(e);if(s!==void 0)return s;const a=e.emits;let l={},u=!1;if(!ft(e)){const d=p=>{const f=op(p,t,!0);f&&(u=!0,yn(l,f))};!o&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}return!a&&!u?(Ot(e)&&i.set(e,null),null):(it(a)?a.forEach(d=>l[d]=null):yn(l,a),Ot(e)&&i.set(e,l),l)}function Hr(e,t){return!e||!Ar(t)?!1:(t=t.slice(2).replace(/Once$/,""),Et(e,t[0].toLowerCase()+t.slice(1))||Et(e,Ci(t))||Et(e,t))}function $d(e){const{type:t,vnode:o,proxy:i,withProxy:s,propsOptions:[a],slots:l,attrs:u,emit:d,render:p,renderCache:f,props:m,data:y,setupState:_,ctx:b,inheritAttrs:S}=e,T=gr(e);let D,I;try{if(o.shapeFlag&4){const A=s||i,E=A;D=cs(p.call(E,A,f,m,_,y,b)),I=u}else{const A=t;D=cs(A.length>1?A(m,{attrs:u,slots:l,emit:d}):A(m,null)),I=t.props?u:gg(u)}}catch(A){ml.length=0,Fr(A,e,1),D=Ee(En)}let C=D;if(I&&S!==!1){const A=Object.keys(I),{shapeFlag:E}=C;A.length&&E&7&&(a&&A.some(ku)&&(I=yg(I,a)),C=_i(C,I,!1,!0))}return o.dirs&&(C=_i(C,null,!1,!0),C.dirs=C.dirs?C.dirs.concat(o.dirs):o.dirs),o.transition&&wl(C,o.transition),D=C,gr(T),D}const gg=e=>{let t;for(const o in e)(o==="class"||o==="style"||Ar(o))&&((t||(t={}))[o]=e[o]);return t},yg=(e,t)=>{const o={};for(const i in e)(!ku(i)||!(i.slice(9)in t))&&(o[i]=e[i]);return o};function kg(e,t,o){const{props:i,children:s,component:a}=e,{props:l,children:u,patchFlag:d}=t,p=a.emitsOptions;if(t.dirs||t.transition)return!0;if(o&&d>=0){if(d&1024)return!0;if(d&16)return i?Td(i,l,p):!!l;if(d&8){const f=t.dynamicProps;for(let m=0;m<f.length;m++){const y=f[m];if(l[y]!==i[y]&&!Hr(p,y))return!0}}}else return(s||u)&&(!u||!u.$stable)?!0:i===l?!1:i?l?Td(i,l,p):!0:!!l;return!1}function Td(e,t,o){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let s=0;s<i.length;s++){const a=i[s];if(t[a]!==e[a]&&!Hr(o,a))return!0}return!1}function _g({vnode:e,parent:t},o){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=o,t=t.parent;else break}}const sp={},ip=()=>Object.create(sp),ap=e=>Object.getPrototypeOf(e)===sp;function bg(e,t,o,i=!1){const s={},a=ip();e.propsDefaults=Object.create(null),lp(e,t,s,a);for(const l in e.propsOptions[0])l in s||(s[l]=void 0);o?e.props=i?s:If(s):e.type.props?e.props=s:e.props=a,e.attrs=a}function wg(e,t,o,i){const{props:s,attrs:a,vnode:{patchFlag:l}}=e,u=xt(s),[d]=e.propsOptions;let p=!1;if((i||l>0)&&!(l&16)){if(l&8){const f=e.vnode.dynamicProps;for(let m=0;m<f.length;m++){let y=f[m];if(Hr(e.emitsOptions,y))continue;const _=t[y];if(d)if(Et(a,y))_!==a[y]&&(a[y]=_,p=!0);else{const b=Ao(y);s[b]=Zc(d,u,b,_,e,!1)}else _!==a[y]&&(a[y]=_,p=!0)}}}else{lp(e,t,s,a)&&(p=!0);let f;for(const m in u)(!t||!Et(t,m)&&((f=Ci(m))===m||!Et(t,f)))&&(d?o&&(o[m]!==void 0||o[f]!==void 0)&&(s[m]=Zc(d,u,m,void 0,e,!0)):delete s[m]);if(a!==u)for(const m in a)(!t||!Et(t,m))&&(delete a[m],p=!0)}p&&Ds(e.attrs,"set","")}function lp(e,t,o,i){const[s,a]=e.propsOptions;let l=!1,u;if(t)for(let d in t){if(cl(d))continue;const p=t[d];let f;s&&Et(s,f=Ao(d))?!a||!a.includes(f)?o[f]=p:(u||(u={}))[f]=p:Hr(e.emitsOptions,d)||(!(d in i)||p!==i[d])&&(i[d]=p,l=!0)}if(a){const d=xt(o),p=u||Bt;for(let f=0;f<a.length;f++){const m=a[f];o[m]=Zc(s,d,m,p[m],e,!Et(p,m))}}return l}function Zc(e,t,o,i,s,a){const l=e[o];if(l!=null){const u=Et(l,"default");if(u&&i===void 0){const d=l.default;if(l.type!==Function&&!l.skipFactory&&ft(d)){const{propsDefaults:p}=s;if(o in p)i=p[o];else{const f=Pl(s);i=p[o]=d.call(null,t),f()}}else i=d;s.ce&&s.ce._setProp(o,i)}l[0]&&(a&&!u?i=!1:l[1]&&(i===""||i===Ci(o))&&(i=!0))}return i}const Cg=new WeakMap;function rp(e,t,o=!1){const i=o?Cg:t.propsCache,s=i.get(e);if(s)return s;const a=e.props,l={},u=[];let d=!1;if(!ft(e)){const f=m=>{d=!0;const[y,_]=rp(m,t,!0);yn(l,y),_&&u.push(..._)};!o&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}if(!a&&!d)return Ot(e)&&i.set(e,Ca),Ca;if(it(a))for(let f=0;f<a.length;f++){const m=Ao(a[f]);Md(m)&&(l[m]=Bt)}else if(a)for(const f in a){const m=Ao(f);if(Md(m)){const y=a[f],_=l[m]=it(y)||ft(y)?{type:y}:yn({},y),b=_.type;let S=!1,T=!0;if(it(b))for(let D=0;D<b.length;++D){const I=b[D],C=ft(I)&&I.name;if(C==="Boolean"){S=!0;break}else C==="String"&&(T=!1)}else S=ft(b)&&b.name==="Boolean";_[0]=S,_[1]=T,(S||Et(_,"default"))&&u.push(m)}}const p=[l,u];return Ot(e)&&i.set(e,p),p}function Md(e){return e[0]!=="$"&&!cl(e)}const Eu=e=>e==="_"||e==="_ctx"||e==="$stable",Pu=e=>it(e)?e.map(cs):[cs(e)],Lg=(e,t,o)=>{if(t._n)return t;const i=Ue((...s)=>Pu(t(...s)),o);return i._c=!1,i},cp=(e,t,o)=>{const i=e._ctx;for(const s in e){if(Eu(s))continue;const a=e[s];if(ft(a))t[s]=Lg(s,a,i);else if(a!=null){const l=Pu(a);t[s]=()=>l}}},up=(e,t)=>{const o=Pu(t);e.slots.default=()=>o},dp=(e,t,o)=>{for(const i in t)(o||!Eu(i))&&(e[i]=t[i])},Sg=(e,t,o)=>{const i=e.slots=ip();if(e.vnode.shapeFlag&32){const s=t._;s?(dp(i,t,o),o&&af(i,"_",s,!0)):cp(t,i)}else t&&up(e,t)},xg=(e,t,o)=>{const{vnode:i,slots:s}=e;let a=!0,l=Bt;if(i.shapeFlag&32){const u=t._;u?o&&u===1?a=!1:dp(s,t,o):(a=!t.$stable,cp(t,s)),l=t}else t&&(up(e,t),l={default:1});if(a)for(const u in s)!Eu(u)&&l[u]==null&&delete s[u]},Gn=Ag;function Ig(e){return $g(e)}function $g(e,t){const o=Or();o.__VUE__=!0;const{insert:i,remove:s,patchProp:a,createElement:l,createText:u,createComment:d,setText:p,setElementText:f,parentNode:m,nextSibling:y,setScopeId:_=Ko,insertStaticContent:b}=e,S=(W,Y,le,ye=null,ie=null,oe=null,ce=void 0,De=null,we=!!Y.dynamicChildren)=>{if(W===Y)return;W&&!Gi(W,Y)&&(ye=be(W),Oe(W,ie,oe,!0),W=null),Y.patchFlag===-2&&(we=!1,Y.dynamicChildren=null);const{type:te,ref:ke,shapeFlag:se}=Y;switch(te){case Vr:T(W,Y,le,ye);break;case En:D(W,Y,le,ye);break;case vl:W==null&&I(Y,le,ye,ce);break;case xe:K(W,Y,le,ye,ie,oe,ce,De,we);break;default:se&1?E(W,Y,le,ye,ie,oe,ce,De,we):se&6?re(W,Y,le,ye,ie,oe,ce,De,we):(se&64||se&128)&&te.process(W,Y,le,ye,ie,oe,ce,De,we,Ie)}ke!=null&&ie?fl(ke,W&&W.ref,oe,Y||W,!Y):ke==null&&W&&W.ref!=null&&fl(W.ref,null,oe,W,!0)},T=(W,Y,le,ye)=>{if(W==null)i(Y.el=u(Y.children),le,ye);else{const ie=Y.el=W.el;Y.children!==W.children&&p(ie,Y.children)}},D=(W,Y,le,ye)=>{W==null?i(Y.el=d(Y.children||""),le,ye):Y.el=W.el},I=(W,Y,le,ye)=>{[W.el,W.anchor]=b(W.children,Y,le,ye,W.el,W.anchor)},C=({el:W,anchor:Y},le,ye)=>{let ie;for(;W&&W!==Y;)ie=y(W),i(W,le,ye),W=ie;i(Y,le,ye)},A=({el:W,anchor:Y})=>{let le;for(;W&&W!==Y;)le=y(W),s(W),W=le;s(Y)},E=(W,Y,le,ye,ie,oe,ce,De,we)=>{if(Y.type==="svg"?ce="svg":Y.type==="math"&&(ce="mathml"),W==null)N(Y,le,ye,ie,oe,ce,De,we);else{const te=W.el&&W.el._isVueCE?W.el:null;try{te&&te._beginPatch(),R(W,Y,ie,oe,ce,De,we)}finally{te&&te._endPatch()}}},N=(W,Y,le,ye,ie,oe,ce,De)=>{let we,te;const{props:ke,shapeFlag:se,transition:Q,dirs:X}=W;if(we=W.el=l(W.type,oe,ke&&ke.is,ke),se&8?f(we,W.children):se&16&&G(W.children,we,null,ye,ie,wc(W,oe),ce,De),X&&Ni(W,null,ye,"created"),$(we,W,W.scopeId,ce,ye),ke){for(const q in ke)q!=="value"&&!cl(q)&&a(we,q,null,ke[q],oe,ye);"value"in ke&&a(we,"value",null,ke.value,oe),(te=ke.onVnodeBeforeMount)&&as(te,ye,W)}X&&Ni(W,null,ye,"beforeMount");const O=Tg(ie,Q);O&&Q.beforeEnter(we),i(we,Y,le),((te=ke&&ke.onVnodeMounted)||O||X)&&Gn(()=>{te&&as(te,ye,W),O&&Q.enter(we),X&&Ni(W,null,ye,"mounted")},ie)},$=(W,Y,le,ye,ie)=>{if(le&&_(W,le),ye)for(let oe=0;oe<ye.length;oe++)_(W,ye[oe]);if(ie){let oe=ie.subTree;if(Y===oe||pp(oe.type)&&(oe.ssContent===Y||oe.ssFallback===Y)){const ce=ie.vnode;$(W,ce,ce.scopeId,ce.slotScopeIds,ie.parent)}}},G=(W,Y,le,ye,ie,oe,ce,De,we=0)=>{for(let te=we;te<W.length;te++){const ke=W[te]=De?pi(W[te]):cs(W[te]);S(null,ke,Y,le,ye,ie,oe,ce,De)}},R=(W,Y,le,ye,ie,oe,ce)=>{const De=Y.el=W.el;let{patchFlag:we,dynamicChildren:te,dirs:ke}=Y;we|=W.patchFlag&16;const se=W.props||Bt,Q=Y.props||Bt;let X;if(le&&Fi(le,!1),(X=Q.onVnodeBeforeUpdate)&&as(X,le,Y,W),ke&&Ni(Y,W,le,"beforeUpdate"),le&&Fi(le,!0),(se.innerHTML&&Q.innerHTML==null||se.textContent&&Q.textContent==null)&&f(De,""),te?Z(W.dynamicChildren,te,De,le,ye,wc(Y,ie),oe):ce||ae(W,Y,De,null,le,ye,wc(Y,ie),oe,!1),we>0){if(we&16)U(De,se,Q,le,ie);else if(we&2&&se.class!==Q.class&&a(De,"class",null,Q.class,ie),we&4&&a(De,"style",se.style,Q.style,ie),we&8){const O=Y.dynamicProps;for(let q=0;q<O.length;q++){const J=O[q],$e=se[J],We=Q[J];(We!==$e||J==="value")&&a(De,J,$e,We,ie,le)}}we&1&&W.children!==Y.children&&f(De,Y.children)}else!ce&&te==null&&U(De,se,Q,le,ie);((X=Q.onVnodeUpdated)||ke)&&Gn(()=>{X&&as(X,le,Y,W),ke&&Ni(Y,W,le,"updated")},ye)},Z=(W,Y,le,ye,ie,oe,ce)=>{for(let De=0;De<Y.length;De++){const we=W[De],te=Y[De],ke=we.el&&(we.type===xe||!Gi(we,te)||we.shapeFlag&198)?m(we.el):le;S(we,te,ke,null,ye,ie,oe,ce,!0)}},U=(W,Y,le,ye,ie)=>{if(Y!==le){if(Y!==Bt)for(const oe in Y)!cl(oe)&&!(oe in le)&&a(W,oe,Y[oe],null,ie,ye);for(const oe in le){if(cl(oe))continue;const ce=le[oe],De=Y[oe];ce!==De&&oe!=="value"&&a(W,oe,De,ce,ie,ye)}"value"in le&&a(W,"value",Y.value,le.value,ie)}},K=(W,Y,le,ye,ie,oe,ce,De,we)=>{const te=Y.el=W?W.el:u(""),ke=Y.anchor=W?W.anchor:u("");let{patchFlag:se,dynamicChildren:Q,slotScopeIds:X}=Y;X&&(De=De?De.concat(X):X),W==null?(i(te,le,ye),i(ke,le,ye),G(Y.children||[],le,ke,ie,oe,ce,De,we)):se>0&&se&64&&Q&&W.dynamicChildren&&W.dynamicChildren.length===Q.length?(Z(W.dynamicChildren,Q,le,ie,oe,ce,De),(Y.key!=null||ie&&Y===ie.subTree)&&Du(W,Y,!0)):ae(W,Y,le,ke,ie,oe,ce,De,we)},re=(W,Y,le,ye,ie,oe,ce,De,we)=>{Y.slotScopeIds=De,W==null?Y.shapeFlag&512?ie.ctx.activate(Y,le,ye,ce,we):Pe(Y,le,ye,ie,oe,ce,we):me(W,Y,we)},Pe=(W,Y,le,ye,ie,oe,ce)=>{const De=W.component=Bg(W,ye,ie);if(Ur(W)&&(De.ctx.renderer=Ie),Ng(De,!1,ce),De.asyncDep){if(ie&&ie.registerDep(De,Ae,ce),!W.el){const we=De.subTree=Ee(En);D(null,we,Y,le),W.placeholder=we.el}}else Ae(De,W,Y,le,ie,oe,ce)},me=(W,Y,le)=>{const ye=Y.component=W.component;if(kg(W,Y,le))if(ye.asyncDep&&!ye.asyncResolved){Fe(ye,Y,le);return}else ye.next=Y,ye.update();else Y.el=W.el,ye.vnode=Y},Ae=(W,Y,le,ye,ie,oe,ce)=>{const De=()=>{if(W.isMounted){let{next:se,bu:Q,u:X,parent:O,vnode:q}=W;{const st=hp(W);if(st){se&&(se.el=q.el,Fe(W,se,ce)),st.asyncDep.then(()=>{W.isUnmounted||De()});return}}let J=se,$e;Fi(W,!1),se?(se.el=q.el,Fe(W,se,ce)):se=q,Q&&sr(Q),($e=se.props&&se.props.onVnodeBeforeUpdate)&&as($e,O,se,q),Fi(W,!0);const We=$d(W),ot=W.subTree;W.subTree=We,S(ot,We,m(ot.el),be(ot),W,ie,oe),se.el=We.el,J===null&&_g(W,We.el),X&&Gn(X,ie),($e=se.props&&se.props.onVnodeUpdated)&&Gn(()=>as($e,O,se,q),ie)}else{let se;const{el:Q,props:X}=Y,{bm:O,m:q,parent:J,root:$e,type:We}=W,ot=xa(Y);Fi(W,!1),O&&sr(O),!ot&&(se=X&&X.onVnodeBeforeMount)&&as(se,J,Y),Fi(W,!0);{$e.ce&&$e.ce._def.shadowRoot!==!1&&$e.ce._injectChildStyle(We);const st=W.subTree=$d(W);S(null,st,le,ye,W,ie,oe),Y.el=st.el}if(q&&Gn(q,ie),!ot&&(se=X&&X.onVnodeMounted)){const st=Y;Gn(()=>as(se,J,st),ie)}(Y.shapeFlag&256||J&&xa(J.vnode)&&J.vnode.shapeFlag&256)&&W.a&&Gn(W.a,ie),W.isMounted=!0,Y=le=ye=null}};W.scope.on();const we=W.effect=new ff(De);W.scope.off();const te=W.update=we.run.bind(we),ke=W.job=we.runIfDirty.bind(we);ke.i=W,ke.id=W.uid,we.scheduler=()=>Tu(ke),Fi(W,!0),te()},Fe=(W,Y,le)=>{Y.component=W;const ye=W.vnode.props;W.vnode=Y,W.next=null,wg(W,Y.props,ye,le),xg(W,Y.children,le),Hs(),gd(W),Vs()},ae=(W,Y,le,ye,ie,oe,ce,De,we=!1)=>{const te=W&&W.children,ke=W?W.shapeFlag:0,se=Y.children,{patchFlag:Q,shapeFlag:X}=Y;if(Q>0){if(Q&128){ge(te,se,le,ye,ie,oe,ce,De,we);return}else if(Q&256){Me(te,se,le,ye,ie,oe,ce,De,we);return}}X&8?(ke&16&&tt(te,ie,oe),se!==te&&f(le,se)):ke&16?X&16?ge(te,se,le,ye,ie,oe,ce,De,we):tt(te,ie,oe,!0):(ke&8&&f(le,""),X&16&&G(se,le,ye,ie,oe,ce,De,we))},Me=(W,Y,le,ye,ie,oe,ce,De,we)=>{W=W||Ca,Y=Y||Ca;const te=W.length,ke=Y.length,se=Math.min(te,ke);let Q;for(Q=0;Q<se;Q++){const X=Y[Q]=we?pi(Y[Q]):cs(Y[Q]);S(W[Q],X,le,null,ie,oe,ce,De,we)}te>ke?tt(W,ie,oe,!0,!1,se):G(Y,le,ye,ie,oe,ce,De,we,se)},ge=(W,Y,le,ye,ie,oe,ce,De,we)=>{let te=0;const ke=Y.length;let se=W.length-1,Q=ke-1;for(;te<=se&&te<=Q;){const X=W[te],O=Y[te]=we?pi(Y[te]):cs(Y[te]);if(Gi(X,O))S(X,O,le,null,ie,oe,ce,De,we);else break;te++}for(;te<=se&&te<=Q;){const X=W[se],O=Y[Q]=we?pi(Y[Q]):cs(Y[Q]);if(Gi(X,O))S(X,O,le,null,ie,oe,ce,De,we);else break;se--,Q--}if(te>se){if(te<=Q){const X=Q+1,O=X<ke?Y[X].el:ye;for(;te<=Q;)S(null,Y[te]=we?pi(Y[te]):cs(Y[te]),le,O,ie,oe,ce,De,we),te++}}else if(te>Q)for(;te<=se;)Oe(W[te],ie,oe,!0),te++;else{const X=te,O=te,q=new Map;for(te=O;te<=Q;te++){const Pt=Y[te]=we?pi(Y[te]):cs(Y[te]);Pt.key!=null&&q.set(Pt.key,te)}let J,$e=0;const We=Q-O+1;let ot=!1,st=0;const $t=new Array(We);for(te=0;te<We;te++)$t[te]=0;for(te=X;te<=se;te++){const Pt=W[te];if($e>=We){Oe(Pt,ie,oe,!0);continue}let jt;if(Pt.key!=null)jt=q.get(Pt.key);else for(J=O;J<=Q;J++)if($t[J-O]===0&&Gi(Pt,Y[J])){jt=J;break}jt===void 0?Oe(Pt,ie,oe,!0):($t[jt-O]=te+1,jt>=st?st=jt:ot=!0,S(Pt,Y[jt],le,null,ie,oe,ce,De,we),$e++)}const Nt=ot?Mg($t):Ca;for(J=Nt.length-1,te=We-1;te>=0;te--){const Pt=O+te,jt=Y[Pt],cn=Y[Pt+1],go=Pt+1<ke?cn.el||fp(cn):ye;$t[te]===0?S(null,jt,le,go,ie,oe,ce,De,we):ot&&(J<0||te!==Nt[J]?de(jt,le,go,2):J--)}}},de=(W,Y,le,ye,ie=null)=>{const{el:oe,type:ce,transition:De,children:we,shapeFlag:te}=W;if(te&6){de(W.component.subTree,Y,le,ye);return}if(te&128){W.suspense.move(Y,le,ye);return}if(te&64){ce.move(W,Y,le,Ie);return}if(ce===xe){i(oe,Y,le);for(let se=0;se<we.length;se++)de(we[se],Y,le,ye);i(W.anchor,Y,le);return}if(ce===vl){C(W,Y,le);return}if(ye!==2&&te&1&&De)if(ye===0)De.beforeEnter(oe),i(oe,Y,le),Gn(()=>De.enter(oe),ie);else{const{leave:se,delayLeave:Q,afterLeave:X}=De,O=()=>{W.ctx.isUnmounted?s(oe):i(oe,Y,le)},q=()=>{oe._isLeaving&&oe[Es](!0),se(oe,()=>{O(),X&&X()})};Q?Q(oe,O,q):q()}else i(oe,Y,le)},Oe=(W,Y,le,ye=!1,ie=!1)=>{const{type:oe,props:ce,ref:De,children:we,dynamicChildren:te,shapeFlag:ke,patchFlag:se,dirs:Q,cacheIndex:X}=W;if(se===-2&&(ie=!1),De!=null&&(Hs(),fl(De,null,le,W,!0),Vs()),X!=null&&(Y.renderCache[X]=void 0),ke&256){Y.ctx.deactivate(W);return}const O=ke&1&&Q,q=!xa(W);let J;if(q&&(J=ce&&ce.onVnodeBeforeUnmount)&&as(J,Y,W),ke&6)qe(W.component,le,ye);else{if(ke&128){W.suspense.unmount(le,ye);return}O&&Ni(W,null,Y,"beforeUnmount"),ke&64?W.type.remove(W,Y,le,Ie,ye):te&&!te.hasOnce&&(oe!==xe||se>0&&se&64)?tt(te,Y,le,!1,!0):(oe===xe&&se&384||!ie&&ke&16)&&tt(we,Y,le),ye&&Xe(W)}(q&&(J=ce&&ce.onVnodeUnmounted)||O)&&Gn(()=>{J&&as(J,Y,W),O&&Ni(W,null,Y,"unmounted")},le)},Xe=W=>{const{type:Y,el:le,anchor:ye,transition:ie}=W;if(Y===xe){et(le,ye);return}if(Y===vl){A(W);return}const oe=()=>{s(le),ie&&!ie.persisted&&ie.afterLeave&&ie.afterLeave()};if(W.shapeFlag&1&&ie&&!ie.persisted){const{leave:ce,delayLeave:De}=ie,we=()=>ce(le,oe);De?De(W.el,oe,we):we()}else oe()},et=(W,Y)=>{let le;for(;W!==Y;)le=y(W),s(W),W=le;s(Y)},qe=(W,Y,le)=>{const{bum:ye,scope:ie,job:oe,subTree:ce,um:De,m:we,a:te}=W;Ad(we),Ad(te),ye&&sr(ye),ie.stop(),oe&&(oe.flags|=8,Oe(ce,W,Y,le)),De&&Gn(De,Y),Gn(()=>{W.isUnmounted=!0},Y)},tt=(W,Y,le,ye=!1,ie=!1,oe=0)=>{for(let ce=oe;ce<W.length;ce++)Oe(W[ce],Y,le,ye,ie)},be=W=>{if(W.shapeFlag&6)return be(W.component.subTree);if(W.shapeFlag&128)return W.suspense.next();const Y=y(W.anchor||W.el),le=Y&&Y[Nf];return le?y(le):Y};let He=!1;const fe=(W,Y,le)=>{let ye;W==null?Y._vnode&&(Oe(Y._vnode,null,null,!0),ye=Y._vnode.component):S(Y._vnode||null,W,Y,null,null,null,le),Y._vnode=W,He||(He=!0,gd(ye),Pf(),He=!1)},Ie={p:S,um:Oe,m:de,r:Xe,mt:Pe,mc:G,pc:ae,pbc:Z,n:be,o:e};return{render:fe,hydrate:void 0,createApp:fg(fe)}}function wc({type:e,props:t},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:o}function Fi({effect:e,job:t},o){o?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Tg(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function Du(e,t,o=!1){const i=e.children,s=t.children;if(it(i)&&it(s))for(let a=0;a<i.length;a++){const l=i[a];let u=s[a];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=s[a]=pi(s[a]),u.el=l.el),!o&&u.patchFlag!==-2&&Du(l,u)),u.type===Vr&&(u.patchFlag!==-1?u.el=l.el:u.__elIndex=a+(e.type===xe?1:0)),u.type===En&&!u.el&&(u.el=l.el)}}function Mg(e){const t=e.slice(),o=[0];let i,s,a,l,u;const d=e.length;for(i=0;i<d;i++){const p=e[i];if(p!==0){if(s=o[o.length-1],e[s]<p){t[i]=s,o.push(i);continue}for(a=0,l=o.length-1;a<l;)u=a+l>>1,e[o[u]]<p?a=u+1:l=u;p<e[o[a]]&&(a>0&&(t[i]=o[a-1]),o[a]=i)}}for(a=o.length,l=o[a-1];a-- >0;)o[a]=l,l=t[l];return o}function hp(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:hp(t)}function Ad(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function fp(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?fp(t.subTree):null}const pp=e=>e.__isSuspense;function Ag(e,t){t&&t.pendingBranch?it(e)?t.effects.push(...e):t.effects.push(e):Ef(e)}const xe=Symbol.for("v-fgt"),Vr=Symbol.for("v-txt"),En=Symbol.for("v-cmt"),vl=Symbol.for("v-stc"),ml=[];let vo=null;function v(e=!1){ml.push(vo=e?null:[])}function Eg(){ml.pop(),vo=ml[ml.length-1]||null}let Cl=1;function _r(e,t=!1){Cl+=e,e<0&&vo&&t&&(vo.hasOnce=!0)}function vp(e){return e.dynamicChildren=Cl>0?vo||Ca:null,Eg(),Cl>0&&vo&&vo.push(e),e}function g(e,t,o,i,s,a){return vp(r(e,t,o,i,s,a,!0))}function je(e,t,o,i,s){return vp(Ee(e,t,o,i,s,!0))}function Ll(e){return e?e.__v_isVNode===!0:!1}function Gi(e,t){return e.type===t.type&&e.key===t.key}const mp=({key:e})=>e??null,lr=({ref:e,ref_key:t,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?Xt(e)||Jt(e)||ft(e)?{i:Ln,r:e,k:t,f:!!o}:e:null);function r(e,t=null,o=null,i=0,s=null,a=e===xe?0:1,l=!1,u=!1){const d={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&mp(t),ref:t&&lr(t),scopeId:Rf,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Ln};return u?(Ru(d,o),a&128&&e.normalize(d)):o&&(d.shapeFlag|=Xt(o)?8:16),Cl>0&&!l&&vo&&(d.patchFlag>0||a&6)&&d.patchFlag!==32&&vo.push(d),d}const Ee=Pg;function Pg(e,t=null,o=null,i=0,s=null,a=!1){if((!e||e===sg)&&(e=En),Ll(e)){const u=_i(e,t,!0);return o&&Ru(u,o),Cl>0&&!a&&vo&&(u.shapeFlag&6?vo[vo.indexOf(e)]=u:vo.push(u)),u.patchFlag=-2,u}if(Vg(e)&&(e=e.__vccOpts),t){t=Dg(t);let{class:u,style:d}=t;u&&!Xt(u)&&(t.class=ue(u)),Ot(d)&&(Nr(d)&&!it(d)&&(d=yn({},d)),t.style=ut(d))}const l=Xt(e)?1:pp(e)?128:Ff(e)?64:Ot(e)?4:ft(e)?2:0;return r(e,t,o,i,s,l,a,!0)}function Dg(e){return e?Nr(e)||ap(e)?yn({},e):e:null}function _i(e,t,o=!1,i=!1){const{props:s,ref:a,patchFlag:l,children:u,transition:d}=e,p=t?gp(s||{},t):s,f={__v_isVNode:!0,__v_skip:!0,type:e.type,props:p,key:p&&mp(p),ref:t&&t.ref?o&&a?it(a)?a.concat(lr(t)):[a,lr(t)]:lr(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==xe?l===-1?16:l|16:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:d,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&_i(e.ssContent),ssFallback:e.ssFallback&&_i(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return d&&i&&wl(f,d.clone(f)),f}function Ke(e=" ",t=0){return Ee(Vr,null,e,t)}function br(e,t){const o=Ee(vl,null,e);return o.staticCount=t,o}function P(e="",t=!1){return t?(v(),je(En,null,e)):Ee(En,null,e)}function cs(e){return e==null||typeof e=="boolean"?Ee(En):it(e)?Ee(xe,null,e.slice()):Ll(e)?pi(e):Ee(Vr,null,String(e))}function pi(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:_i(e)}function Ru(e,t){let o=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(it(t))o=16;else if(typeof t=="object")if(i&65){const s=t.default;s&&(s._c&&(s._d=!1),Ru(e,s()),s._c&&(s._d=!0));return}else{o=32;const s=t._;!s&&!ap(t)?t._ctx=Ln:s===3&&Ln&&(Ln.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else ft(t)?(t={default:t,_ctx:Ln},o=32):(t=String(t),i&64?(o=16,t=[Ke(t)]):o=8);e.children=t,e.shapeFlag|=o}function gp(...e){const t={};for(let o=0;o<e.length;o++){const i=e[o];for(const s in i)if(s==="class")t.class!==i.class&&(t.class=ue([t.class,i.class]));else if(s==="style")t.style=ut([t.style,i.style]);else if(Ar(s)){const a=t[s],l=i[s];l&&a!==l&&!(it(a)&&a.includes(l))&&(t[s]=a?[].concat(a,l):l)}else s!==""&&(t[s]=i[s])}return t}function as(e,t,o,i=null){Qo(e,t,7,[o,i])}const Rg=np();let Og=0;function Bg(e,t,o){const i=e.type,s=(t?t.appContext:e.appContext)||Rg,a={uid:Og++,vnode:e,type:i,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new uf(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:rp(i,s),emitsOptions:op(i,s),emit:null,emitted:null,propsDefaults:Bt,inheritAttrs:i.inheritAttrs,ctx:Bt,data:Bt,props:Bt,attrs:Bt,slots:Bt,refs:Bt,setupState:Bt,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=vg.bind(null,a),e.ce&&e.ce(a),a}let Pn=null;const Gr=()=>Pn||Ln;let wr,qc;{const e=Or(),t=(o,i)=>{let s;return(s=e[o])||(s=e[o]=[]),s.push(i),a=>{s.length>1?s.forEach(l=>l(a)):s[0](a)}};wr=t("__VUE_INSTANCE_SETTERS__",o=>Pn=o),qc=t("__VUE_SSR_SETTERS__",o=>Sl=o)}const Pl=e=>{const t=Pn;return wr(e),e.scope.on(),()=>{e.scope.off(),wr(t)}},Ed=()=>{Pn&&Pn.scope.off(),wr(null)};function yp(e){return e.vnode.shapeFlag&4}let Sl=!1;function Ng(e,t=!1,o=!1){t&&qc(t);const{props:i,children:s}=e.vnode,a=yp(e);bg(e,i,a,t),Sg(e,s,o||t);const l=a?Fg(e,t):void 0;return t&&qc(!1),l}function Fg(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,ag);const{setup:i}=o;if(i){Hs();const s=e.setupContext=i.length>1?zg(e):null,a=Pl(e),l=El(i,e,0,[e.props,s]),u=nf(l);if(Vs(),a(),(u||e.sp)&&!xa(e)&&Wf(e),u){if(l.then(Ed,Ed),t)return l.then(d=>{Pd(e,d)}).catch(d=>{Fr(d,e,0)});e.asyncDep=l}else Pd(e,l)}else kp(e)}function Pd(e,t,o){ft(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Ot(t)&&(e.setupState=Tf(t)),kp(e)}function kp(e,t,o){const i=e.type;e.render||(e.render=i.render||Ko);{const s=Pl(e);Hs();try{lg(e)}finally{Vs(),s()}}}const Ug={get(e,t){return An(e,"get",""),e[t]}};function zg(e){const t=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,Ug),slots:e.slots,emit:e.emit,expose:t}}function jr(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Tf($u(e.exposed)),{get(t,o){if(o in t)return t[o];if(o in pl)return pl[o](e)},has(t,o){return o in t||o in pl}})):e.proxy}function Hg(e,t=!0){return ft(e)?e.displayName||e.name:e.name||t&&e.__name}function Vg(e){return ft(e)&&"__vccOpts"in e}const H=(e,t)=>Rm(e,t,Sl);function Ou(e,t,o){try{_r(-1);const i=arguments.length;return i===2?Ot(t)&&!it(t)?Ll(t)?Ee(e,null,[t]):Ee(e,t):Ee(e,null,t):(i>3?o=Array.prototype.slice.call(arguments,2):i===3&&Ll(o)&&(o=[o]),Ee(e,t,o))}finally{_r(1)}}const Gg="3.5.26";let Wc;const Dd=typeof window<"u"&&window.trustedTypes;if(Dd)try{Wc=Dd.createPolicy("vue",{createHTML:e=>e})}catch{}const _p=Wc?e=>Wc.createHTML(e):e=>e,jg="http://www.w3.org/2000/svg",Zg="http://www.w3.org/1998/Math/MathML",As=typeof document<"u"?document:null,Rd=As&&As.createElement("template"),qg={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,i)=>{const s=t==="svg"?As.createElementNS(jg,e):t==="mathml"?As.createElementNS(Zg,e):o?As.createElement(e,{is:o}):As.createElement(e);return e==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:e=>As.createTextNode(e),createComment:e=>As.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>As.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,o,i,s,a){const l=o?o.previousSibling:t.lastChild;if(s&&(s===a||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),o),!(s===a||!(s=s.nextSibling)););else{Rd.innerHTML=_p(i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e);const u=Rd.content;if(i==="svg"||i==="mathml"){const d=u.firstChild;for(;d.firstChild;)u.appendChild(d.firstChild);u.removeChild(d)}t.insertBefore(u,o)}return[l?l.nextSibling:t.firstChild,o?o.previousSibling:t.lastChild]}},ri="transition",tl="animation",xl=Symbol("_vtc"),bp={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Wg=yn({},Hf,bp),Kg=e=>(e.displayName="Transition",e.props=Wg,e),Xi=Kg((e,{slots:t})=>Ou(qm,Yg(e),t)),Ui=(e,t=[])=>{it(e)?e.forEach(o=>o(...t)):e&&e(...t)},Od=e=>e?it(e)?e.some(t=>t.length>1):e.length>1:!1;function Yg(e){const t={};for(const K in e)K in bp||(t[K]=e[K]);if(e.css===!1)return t;const{name:o="v",type:i,duration:s,enterFromClass:a=`${o}-enter-from`,enterActiveClass:l=`${o}-enter-active`,enterToClass:u=`${o}-enter-to`,appearFromClass:d=a,appearActiveClass:p=l,appearToClass:f=u,leaveFromClass:m=`${o}-leave-from`,leaveActiveClass:y=`${o}-leave-active`,leaveToClass:_=`${o}-leave-to`}=e,b=Jg(s),S=b&&b[0],T=b&&b[1],{onBeforeEnter:D,onEnter:I,onEnterCancelled:C,onLeave:A,onLeaveCancelled:E,onBeforeAppear:N=D,onAppear:$=I,onAppearCancelled:G=C}=t,R=(K,re,Pe,me)=>{K._enterCancelled=me,zi(K,re?f:u),zi(K,re?p:l),Pe&&Pe()},Z=(K,re)=>{K._isLeaving=!1,zi(K,m),zi(K,_),zi(K,y),re&&re()},U=K=>(re,Pe)=>{const me=K?$:I,Ae=()=>R(re,K,Pe);Ui(me,[re,Ae]),Bd(()=>{zi(re,K?d:a),Ts(re,K?f:u),Od(me)||Nd(re,i,S,Ae)})};return yn(t,{onBeforeEnter(K){Ui(D,[K]),Ts(K,a),Ts(K,l)},onBeforeAppear(K){Ui(N,[K]),Ts(K,d),Ts(K,p)},onEnter:U(!1),onAppear:U(!0),onLeave(K,re){K._isLeaving=!0;const Pe=()=>Z(K,re);Ts(K,m),K._enterCancelled?(Ts(K,y),zd(K)):(zd(K),Ts(K,y)),Bd(()=>{K._isLeaving&&(zi(K,m),Ts(K,_),Od(A)||Nd(K,i,T,Pe))}),Ui(A,[K,Pe])},onEnterCancelled(K){R(K,!1,void 0,!0),Ui(C,[K])},onAppearCancelled(K){R(K,!0,void 0,!0),Ui(G,[K])},onLeaveCancelled(K){Z(K),Ui(E,[K])}})}function Jg(e){if(e==null)return null;if(Ot(e))return[Cc(e.enter),Cc(e.leave)];{const t=Cc(e);return[t,t]}}function Cc(e){return Qv(e)}function Ts(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e[xl]||(e[xl]=new Set)).add(t)}function zi(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const o=e[xl];o&&(o.delete(t),o.size||(e[xl]=void 0))}function Bd(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Xg=0;function Nd(e,t,o,i){const s=e._endId=++Xg,a=()=>{s===e._endId&&i()};if(o!=null)return setTimeout(a,o);const{type:l,timeout:u,propCount:d}=Qg(e,t);if(!l)return i();const p=l+"end";let f=0;const m=()=>{e.removeEventListener(p,y),a()},y=_=>{_.target===e&&++f>=d&&m()};setTimeout(()=>{f<d&&m()},u+1),e.addEventListener(p,y)}function Qg(e,t){const o=window.getComputedStyle(e),i=b=>(o[b]||"").split(", "),s=i(`${ri}Delay`),a=i(`${ri}Duration`),l=Fd(s,a),u=i(`${tl}Delay`),d=i(`${tl}Duration`),p=Fd(u,d);let f=null,m=0,y=0;t===ri?l>0&&(f=ri,m=l,y=a.length):t===tl?p>0&&(f=tl,m=p,y=d.length):(m=Math.max(l,p),f=m>0?l>p?ri:tl:null,y=f?f===ri?a.length:d.length:0);const _=f===ri&&/\b(?:transform|all)(?:,|$)/.test(i(`${ri}Property`).toString());return{type:f,timeout:m,propCount:y,hasTransform:_}}function Fd(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((o,i)=>Ud(o)+Ud(e[i])))}function Ud(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function zd(e){return(e?e.ownerDocument:document).body.offsetHeight}function ey(e,t,o){const i=e[xl];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}const Cr=Symbol("_vod"),wp=Symbol("_vsh"),bi={name:"show",beforeMount(e,{value:t},{transition:o}){e[Cr]=e.style.display==="none"?"":e.style.display,o&&t?o.beforeEnter(e):nl(e,t)},mounted(e,{value:t},{transition:o}){o&&t&&o.enter(e)},updated(e,{value:t,oldValue:o},{transition:i}){!t!=!o&&(i?t?(i.beforeEnter(e),nl(e,!0),i.enter(e)):i.leave(e,()=>{nl(e,!1)}):nl(e,t))},beforeUnmount(e,{value:t}){nl(e,t)}};function nl(e,t){e.style.display=t?e[Cr]:"none",e[wp]=!t}const Cp=Symbol("");function ty(e){const t=Gr();if(!t)return;const o=t.ut=(s=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(a=>Lr(a,s))},i=()=>{const s=e(t.proxy);t.ce?Lr(t.ce,s):Kc(t.subTree,s),o(s)};Yf(()=>{Ef(i)}),Qt(()=>{Ze(i,Ko,{flush:"post"});const s=new MutationObserver(i);s.observe(t.subTree.el.parentNode,{childList:!0}),On(()=>s.disconnect())})}function Kc(e,t){if(e.shapeFlag&128){const o=e.suspense;e=o.activeBranch,o.pendingBranch&&!o.isHydrating&&o.effects.push(()=>{Kc(o.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)Lr(e.el,t);else if(e.type===xe)e.children.forEach(o=>Kc(o,t));else if(e.type===vl){let{el:o,anchor:i}=e;for(;o&&(Lr(o,t),o!==i);)o=o.nextSibling}}function Lr(e,t){if(e.nodeType===1){const o=e.style;let i="";for(const s in t){const a=lm(t[s]);o.setProperty(`--${s}`,a),i+=`--${s}: ${a};`}o[Cp]=i}}const ny=/(?:^|;)\s*display\s*:/;function oy(e,t,o){const i=e.style,s=Xt(o);let a=!1;if(o&&!s){if(t)if(Xt(t))for(const l of t.split(";")){const u=l.slice(0,l.indexOf(":")).trim();o[u]==null&&rr(i,u,"")}else for(const l in t)o[l]==null&&rr(i,l,"");for(const l in o)l==="display"&&(a=!0),rr(i,l,o[l])}else if(s){if(t!==o){const l=i[Cp];l&&(o+=";"+l),i.cssText=o,a=ny.test(o)}}else t&&e.removeAttribute("style");Cr in e&&(e[Cr]=a?i.display:"",e[wp]&&(i.display="none"))}const Hd=/\s*!important$/;function rr(e,t,o){if(it(o))o.forEach(i=>rr(e,t,i));else if(o==null&&(o=""),t.startsWith("--"))e.setProperty(t,o);else{const i=sy(e,t);Hd.test(o)?e.setProperty(Ci(i),o.replace(Hd,""),"important"):e[i]=o}}const Vd=["Webkit","Moz","ms"],Lc={};function sy(e,t){const o=Lc[t];if(o)return o;let i=Ao(t);if(i!=="filter"&&i in e)return Lc[t]=i;i=Dr(i);for(let s=0;s<Vd.length;s++){const a=Vd[s]+i;if(a in e)return Lc[t]=a}return t}const Gd="http://www.w3.org/1999/xlink";function jd(e,t,o,i,s,a=im(t)){i&&t.startsWith("xlink:")?o==null?e.removeAttributeNS(Gd,t.slice(6,t.length)):e.setAttributeNS(Gd,t,o):o==null||a&&!lf(o)?e.removeAttribute(t):e.setAttribute(t,a?"":Jo(o)?String(o):o)}function Zd(e,t,o,i,s){if(t==="innerHTML"||t==="textContent"){o!=null&&(e[t]=t==="innerHTML"?_p(o):o);return}const a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){const u=a==="OPTION"?e.getAttribute("value")||"":e.value,d=o==null?e.type==="checkbox"?"on":"":String(o);(u!==d||!("_value"in e))&&(e.value=d),o==null&&e.removeAttribute(t),e._value=o;return}let l=!1;if(o===""||o==null){const u=typeof e[t];u==="boolean"?o=lf(o):o==null&&u==="string"?(o="",l=!0):u==="number"&&(o=0,l=!0)}try{e[t]=o}catch{}l&&e.removeAttribute(s||t)}function Os(e,t,o,i){e.addEventListener(t,o,i)}function iy(e,t,o,i){e.removeEventListener(t,o,i)}const qd=Symbol("_vei");function ay(e,t,o,i,s=null){const a=e[qd]||(e[qd]={}),l=a[t];if(i&&l)l.value=i;else{const[u,d]=ly(t);if(i){const p=a[t]=uy(i,s);Os(e,u,p,d)}else l&&(iy(e,u,l,d),a[t]=void 0)}}const Wd=/(?:Once|Passive|Capture)$/;function ly(e){let t;if(Wd.test(e)){t={};let i;for(;i=e.match(Wd);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Ci(e.slice(2)),t]}let Sc=0;const ry=Promise.resolve(),cy=()=>Sc||(ry.then(()=>Sc=0),Sc=Date.now());function uy(e,t){const o=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=o.attached)return;Qo(dy(i,o.value),t,5,[i])};return o.value=e,o.attached=cy(),o}function dy(e,t){if(it(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map(i=>s=>!s._stopped&&i&&i(s))}else return t}const Kd=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,hy=(e,t,o,i,s,a)=>{const l=s==="svg";t==="class"?ey(e,i,l):t==="style"?oy(e,o,i):Ar(t)?ku(t)||ay(e,t,o,i,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):fy(e,t,i,l))?(Zd(e,t,i),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&jd(e,t,i,l,a,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Xt(i))?Zd(e,Ao(t),i,a,t):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),jd(e,t,i,l))};function fy(e,t,o,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&Kd(t)&&ft(o));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Kd(t)&&Xt(o)?!1:t in e}const wi=e=>{const t=e.props["onUpdate:modelValue"]||!1;return it(t)?o=>sr(t,o):t};function py(e){e.target.composing=!0}function Yd(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Mo=Symbol("_assign");function Jd(e,t,o){return t&&(e=e.trim()),o&&(e=Rr(e)),e}const nt={created(e,{modifiers:{lazy:t,trim:o,number:i}},s){e[Mo]=wi(s);const a=i||s.props&&s.props.type==="number";Os(e,t?"change":"input",l=>{l.target.composing||e[Mo](Jd(e.value,o,a))}),(o||a)&&Os(e,"change",()=>{e.value=Jd(e.value,o,a)}),t||(Os(e,"compositionstart",py),Os(e,"compositionend",Yd),Os(e,"change",Yd))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:o,modifiers:{lazy:i,trim:s,number:a}},l){if(e[Mo]=wi(l),e.composing)return;const u=(a||e.type==="number")&&!/^0\d/.test(e.value)?Rr(e.value):e.value,d=t??"";u!==d&&(document.activeElement===e&&e.type!=="range"&&(i&&t===o||s&&e.value.trim()===d)||(e.value=d))}},Zr={deep:!0,created(e,t,o){e[Mo]=wi(o),Os(e,"change",()=>{const i=e._modelValue,s=Ta(e),a=e.checked,l=e[Mo];if(it(i)){const u=bu(i,s),d=u!==-1;if(a&&!d)l(i.concat(s));else if(!a&&d){const p=[...i];p.splice(u,1),l(p)}}else if(Da(i)){const u=new Set(i);a?u.add(s):u.delete(s),l(u)}else l(Lp(e,a))})},mounted:Xd,beforeUpdate(e,t,o){e[Mo]=wi(o),Xd(e,t,o)}};function Xd(e,{value:t,oldValue:o},i){e._modelValue=t;let s;if(it(t))s=bu(t,i.props.value)>-1;else if(Da(t))s=t.has(i.props.value);else{if(t===o)return;s=ta(t,Lp(e,!0))}e.checked!==s&&(e.checked=s)}const Qd={created(e,{value:t},o){e.checked=ta(t,o.props.value),e[Mo]=wi(o),Os(e,"change",()=>{e[Mo](Ta(e))})},beforeUpdate(e,{value:t,oldValue:o},i){e[Mo]=wi(i),t!==o&&(e.checked=ta(t,i.props.value))}},Dn={deep:!0,created(e,{value:t,modifiers:{number:o}},i){const s=Da(t);Os(e,"change",()=>{const a=Array.prototype.filter.call(e.options,l=>l.selected).map(l=>o?Rr(Ta(l)):Ta(l));e[Mo](e.multiple?s?new Set(a):a:a[0]),e._assigning=!0,qn(()=>{e._assigning=!1})}),e[Mo]=wi(i)},mounted(e,{value:t}){eh(e,t)},beforeUpdate(e,t,o){e[Mo]=wi(o)},updated(e,{value:t}){e._assigning||eh(e,t)}};function eh(e,t){const o=e.multiple,i=it(t);if(!(o&&!i&&!Da(t))){for(let s=0,a=e.options.length;s<a;s++){const l=e.options[s],u=Ta(l);if(o)if(i){const d=typeof u;d==="string"||d==="number"?l.selected=t.some(p=>String(p)===String(u)):l.selected=bu(t,u)>-1}else l.selected=t.has(u);else if(ta(Ta(l),t)){e.selectedIndex!==s&&(e.selectedIndex=s);return}}!o&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Ta(e){return"_value"in e?e._value:e.value}function Lp(e,t){const o=t?"_trueValue":"_falseValue";return o in e?e[o]:t}const vy=["ctrl","shift","alt","meta"],my={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>vy.some(o=>e[`${o}Key`]&&!t.includes(o))},dt=(e,t)=>{const o=e._withMods||(e._withMods={}),i=t.join(".");return o[i]||(o[i]=((s,...a)=>{for(let l=0;l<t.length;l++){const u=my[t[l]];if(u&&u(s,t))return}return e(s,...a)}))},gy={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Sp=(e,t)=>{const o=e._withKeys||(e._withKeys={}),i=t.join(".");return o[i]||(o[i]=(s=>{if(!("key"in s))return;const a=Ci(s.key);if(t.some(l=>l===a||gy[l]===a))return e(s)}))},yy=yn({patchProp:hy},qg);let th;function ky(){return th||(th=Ig(yy))}const _y=((...e)=>{const t=ky().createApp(...e),{mount:o}=t;return t.mount=i=>{const s=wy(i);if(!s)return;const a=t._component;!ft(a)&&!a.render&&!a.template&&(a.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const l=o(s,!1,by(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),l},t});function by(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function wy(e){return Xt(e)?document.querySelector(e):e}let xp;const qr=e=>xp=e,Ip=Symbol();function Yc(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var gl;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(gl||(gl={}));function Cy(){const e=df(!0),t=e.run(()=>M({}));let o=[],i=[];const s=$u({install(a){qr(s),s._a=a,a.provide(Ip,s),a.config.globalProperties.$pinia=s,i.forEach(l=>o.push(l)),i=[]},use(a){return this._a?o.push(a):i.push(a),this},_p:o,_a:null,_e:e,_s:new Map,state:t});return s}const $p=()=>{};function nh(e,t,o,i=$p){e.add(t);const s=()=>{e.delete(t)&&i()};return!o&&hf()&&rm(s),s}function ga(e,...t){e.forEach(o=>{o(...t)})}const Ly=e=>e(),oh=Symbol(),xc=Symbol();function Jc(e,t){e instanceof Map&&t instanceof Map?t.forEach((o,i)=>e.set(i,o)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const o in t){if(!t.hasOwnProperty(o))continue;const i=t[o],s=e[o];Yc(s)&&Yc(i)&&e.hasOwnProperty(o)&&!Jt(i)&&!zs(i)?e[o]=Jc(s,i):e[o]=i}return e}const Sy=Symbol();function xy(e){return!Yc(e)||!Object.prototype.hasOwnProperty.call(e,Sy)}const{assign:ui}=Object;function Iy(e){return!!(Jt(e)&&e.effect)}function $y(e,t,o,i){const{state:s,actions:a,getters:l}=t,u=o.state.value[e];let d;function p(){u||(o.state.value[e]=s?s():{});const f=Am(o.state.value[e]);return ui(f,a,Object.keys(l||{}).reduce((m,y)=>(m[y]=$u(H(()=>{qr(o);const _=o._s.get(e);return l[y].call(_,_)})),m),{}))}return d=Tp(e,p,t,o,i,!0),d}function Tp(e,t,o={},i,s,a){let l;const u=ui({actions:{}},o),d={deep:!0};let p,f,m=new Set,y=new Set,_;const b=i.state.value[e];!a&&!b&&(i.state.value[e]={}),M({});let S;function T(G){let R;p=f=!1,typeof G=="function"?(G(i.state.value[e]),R={type:gl.patchFunction,storeId:e,events:_}):(Jc(i.state.value[e],G),R={type:gl.patchObject,payload:G,storeId:e,events:_});const Z=S=Symbol();qn().then(()=>{S===Z&&(p=!0)}),f=!0,ga(m,R,i.state.value[e])}const D=a?function(){const{state:R}=o,Z=R?R():{};this.$patch(U=>{ui(U,Z)})}:$p;function I(){l.stop(),m.clear(),y.clear(),i._s.delete(e)}const C=(G,R="")=>{if(oh in G)return G[xc]=R,G;const Z=function(){qr(i);const U=Array.from(arguments),K=new Set,re=new Set;function Pe(Fe){K.add(Fe)}function me(Fe){re.add(Fe)}ga(y,{args:U,name:Z[xc],store:E,after:Pe,onError:me});let Ae;try{Ae=G.apply(this&&this.$id===e?this:E,U)}catch(Fe){throw ga(re,Fe),Fe}return Ae instanceof Promise?Ae.then(Fe=>(ga(K,Fe),Fe)).catch(Fe=>(ga(re,Fe),Promise.reject(Fe))):(ga(K,Ae),Ae)};return Z[oh]=!0,Z[xc]=R,Z},A={_p:i,$id:e,$onAction:nh.bind(null,y),$patch:T,$reset:D,$subscribe(G,R={}){const Z=nh(m,G,R.detached,()=>U()),U=l.run(()=>Ze(()=>i.state.value[e],K=>{(R.flush==="sync"?f:p)&&G({storeId:e,type:gl.direct,events:_},K)},ui({},d,R)));return Z},$dispose:I},E=Al(A);i._s.set(e,E);const $=(i._a&&i._a.runWithContext||Ly)(()=>i._e.run(()=>(l=df()).run(()=>t({action:C}))));for(const G in $){const R=$[G];if(Jt(R)&&!Iy(R)||zs(R))a||(b&&xy(R)&&(Jt(R)?R.value=b[G]:Jc(R,b[G])),i.state.value[e][G]=R);else if(typeof R=="function"){const Z=C(R,G);$[G]=Z,u.actions[G]=R}}return ui(E,$),ui(xt(E),$),Object.defineProperty(E,"$state",{get:()=>i.state.value[e],set:G=>{T(R=>{ui(R,G)})}}),i._p.forEach(G=>{ui(E,l.run(()=>G({store:E,app:i._a,pinia:i,options:u})))}),b&&a&&o.hydrate&&o.hydrate(E.$state,b),p=!0,f=!0,E}function Bu(e,t,o){let i;const s=typeof t=="function";i=s?o:t;function a(l,u){const d=Um();return l=l||(d?To(Ip,null):null),l&&qr(l),l=xp,l._s.has(e)||(s?Tp(e,t,i,l):$y(e,i,l)),l._s.get(e)}return a.$id=e,a}const ze=(e,t)=>{const o=e.__vccOpts||e;for(const[i,s]of t)o[i]=s;return o},Ty={};function My(e,t){const o=Au("router-view");return v(),je(o)}const Ay=ze(Ty,[["render",My]]);const ka=typeof document<"u";function Mp(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Ey(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&Mp(e.default)}const At=Object.assign;function Ic(e,t){const o={};for(const i in t){const s=t[i];o[i]=es(s)?s.map(e):e(s)}return o}const yl=()=>{},es=Array.isArray;function sh(e,t){const o={};for(const i in e)o[i]=i in t?t[i]:e[i];return o}const Ap=/#/g,Py=/&/g,Dy=/\//g,Ry=/=/g,Oy=/\?/g,Ep=/\+/g,By=/%5B/g,Ny=/%5D/g,Pp=/%5E/g,Fy=/%60/g,Dp=/%7B/g,Uy=/%7C/g,Rp=/%7D/g,zy=/%20/g;function Nu(e){return e==null?"":encodeURI(""+e).replace(Uy,"|").replace(By,"[").replace(Ny,"]")}function Hy(e){return Nu(e).replace(Dp,"{").replace(Rp,"}").replace(Pp,"^")}function Xc(e){return Nu(e).replace(Ep,"%2B").replace(zy,"+").replace(Ap,"%23").replace(Py,"%26").replace(Fy,"`").replace(Dp,"{").replace(Rp,"}").replace(Pp,"^")}function Vy(e){return Xc(e).replace(Ry,"%3D")}function Gy(e){return Nu(e).replace(Ap,"%23").replace(Oy,"%3F")}function jy(e){return Gy(e).replace(Dy,"%2F")}function Il(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const Zy=/\/$/,qy=e=>e.replace(Zy,"");function $c(e,t,o="/"){let i,s={},a="",l="";const u=t.indexOf("#");let d=t.indexOf("?");return d=u>=0&&d>u?-1:d,d>=0&&(i=t.slice(0,d),a=t.slice(d,u>0?u:t.length),s=e(a.slice(1))),u>=0&&(i=i||t.slice(0,u),l=t.slice(u,t.length)),i=Jy(i??t,o),{fullPath:i+a+l,path:i,query:s,hash:Il(l)}}function Wy(e,t){const o=t.query?e(t.query):"";return t.path+(o&&"?")+o+(t.hash||"")}function ih(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Ky(e,t,o){const i=t.matched.length-1,s=o.matched.length-1;return i>-1&&i===s&&Ma(t.matched[i],o.matched[s])&&Op(t.params,o.params)&&e(t.query)===e(o.query)&&t.hash===o.hash}function Ma(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Op(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var o in e)if(!Yy(e[o],t[o]))return!1;return!0}function Yy(e,t){return es(e)?ah(e,t):es(t)?ah(t,e):e?.valueOf()===t?.valueOf()}function ah(e,t){return es(t)?e.length===t.length&&e.every((o,i)=>o===t[i]):e.length===1&&e[0]===t}function Jy(e,t){if(e.startsWith("/"))return e;if(!e)return t;const o=t.split("/"),i=e.split("/"),s=i[i.length-1];(s===".."||s===".")&&i.push("");let a=o.length-1,l,u;for(l=0;l<i.length;l++)if(u=i[l],u!==".")if(u==="..")a>1&&a--;else break;return o.slice(0,a).join("/")+"/"+i.slice(l).join("/")}const ci={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let Qc=(function(e){return e.pop="pop",e.push="push",e})({}),Tc=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function Xy(e){if(!e)if(ka){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),qy(e)}const Qy=/^[^#]+#/;function ek(e,t){return e.replace(Qy,"#")+t}function tk(e,t){const o=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-o.left-(t.left||0),top:i.top-o.top-(t.top||0)}}const Wr=()=>({left:window.scrollX,top:window.scrollY});function nk(e){let t;if("el"in e){const o=e.el,i=typeof o=="string"&&o.startsWith("#"),s=typeof o=="string"?i?document.getElementById(o.slice(1)):document.querySelector(o):o;if(!s)return;t=tk(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function lh(e,t){return(history.state?history.state.position-t:-1)+e}const eu=new Map;function ok(e,t){eu.set(e,t)}function sk(e){const t=eu.get(e);return eu.delete(e),t}function ik(e){return typeof e=="string"||e&&typeof e=="object"}function Bp(e){return typeof e=="string"||typeof e=="symbol"}let Yt=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const Np=Symbol("");Yt.MATCHER_NOT_FOUND+"",Yt.NAVIGATION_GUARD_REDIRECT+"",Yt.NAVIGATION_ABORTED+"",Yt.NAVIGATION_CANCELLED+"",Yt.NAVIGATION_DUPLICATED+"";function Aa(e,t){return At(new Error,{type:e,[Np]:!0},t)}function Ms(e,t){return e instanceof Error&&Np in e&&(t==null||!!(e.type&t))}const ak=["params","query","hash"];function lk(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const o of ak)o in e&&(t[o]=e[o]);return JSON.stringify(t,null,2)}function rk(e){const t={};if(e===""||e==="?")return t;const o=(e[0]==="?"?e.slice(1):e).split("&");for(let i=0;i<o.length;++i){const s=o[i].replace(Ep," "),a=s.indexOf("="),l=Il(a<0?s:s.slice(0,a)),u=a<0?null:Il(s.slice(a+1));if(l in t){let d=t[l];es(d)||(d=t[l]=[d]),d.push(u)}else t[l]=u}return t}function rh(e){let t="";for(let o in e){const i=e[o];if(o=Vy(o),i==null){i!==void 0&&(t+=(t.length?"&":"")+o);continue}(es(i)?i.map(s=>s&&Xc(s)):[i&&Xc(i)]).forEach(s=>{s!==void 0&&(t+=(t.length?"&":"")+o,s!=null&&(t+="="+s))})}return t}function ck(e){const t={};for(const o in e){const i=e[o];i!==void 0&&(t[o]=es(i)?i.map(s=>s==null?null:""+s):i==null?i:""+i)}return t}const uk=Symbol(""),ch=Symbol(""),Kr=Symbol(""),Fu=Symbol(""),tu=Symbol("");function ol(){let e=[];function t(i){return e.push(i),()=>{const s=e.indexOf(i);s>-1&&e.splice(s,1)}}function o(){e=[]}return{add:t,list:()=>e.slice(),reset:o}}function vi(e,t,o,i,s,a=l=>l()){const l=i&&(i.enterCallbacks[s]=i.enterCallbacks[s]||[]);return()=>new Promise((u,d)=>{const p=y=>{y===!1?d(Aa(Yt.NAVIGATION_ABORTED,{from:o,to:t})):y instanceof Error?d(y):ik(y)?d(Aa(Yt.NAVIGATION_GUARD_REDIRECT,{from:t,to:y})):(l&&i.enterCallbacks[s]===l&&typeof y=="function"&&l.push(y),u())},f=a(()=>e.call(i&&i.instances[s],t,o,p));let m=Promise.resolve(f);e.length<3&&(m=m.then(p)),m.catch(y=>d(y))})}function Mc(e,t,o,i,s=a=>a()){const a=[];for(const l of e)for(const u in l.components){let d=l.components[u];if(!(t!=="beforeRouteEnter"&&!l.instances[u]))if(Mp(d)){const p=(d.__vccOpts||d)[t];p&&a.push(vi(p,o,i,l,u,s))}else{let p=d();a.push(()=>p.then(f=>{if(!f)throw new Error(`Couldn't resolve component "${u}" at "${l.path}"`);const m=Ey(f)?f.default:f;l.mods[u]=f,l.components[u]=m;const y=(m.__vccOpts||m)[t];return y&&vi(y,o,i,l,u,s)()}))}}return a}function dk(e,t){const o=[],i=[],s=[],a=Math.max(t.matched.length,e.matched.length);for(let l=0;l<a;l++){const u=t.matched[l];u&&(e.matched.find(p=>Ma(p,u))?i.push(u):o.push(u));const d=e.matched[l];d&&(t.matched.find(p=>Ma(p,d))||s.push(d))}return[o,i,s]}let hk=()=>location.protocol+"//"+location.host;function Fp(e,t){const{pathname:o,search:i,hash:s}=t,a=e.indexOf("#");if(a>-1){let l=s.includes(e.slice(a))?e.slice(a).length:1,u=s.slice(l);return u[0]!=="/"&&(u="/"+u),ih(u,"")}return ih(o,e)+i+s}function fk(e,t,o,i){let s=[],a=[],l=null;const u=({state:y})=>{const _=Fp(e,location),b=o.value,S=t.value;let T=0;if(y){if(o.value=_,t.value=y,l&&l===b){l=null;return}T=S?y.position-S.position:0}else i(_);s.forEach(D=>{D(o.value,b,{delta:T,type:Qc.pop,direction:T?T>0?Tc.forward:Tc.back:Tc.unknown})})};function d(){l=o.value}function p(y){s.push(y);const _=()=>{const b=s.indexOf(y);b>-1&&s.splice(b,1)};return a.push(_),_}function f(){if(document.visibilityState==="hidden"){const{history:y}=window;if(!y.state)return;y.replaceState(At({},y.state,{scroll:Wr()}),"")}}function m(){for(const y of a)y();a=[],window.removeEventListener("popstate",u),window.removeEventListener("pagehide",f),document.removeEventListener("visibilitychange",f)}return window.addEventListener("popstate",u),window.addEventListener("pagehide",f),document.addEventListener("visibilitychange",f),{pauseListeners:d,listen:p,destroy:m}}function uh(e,t,o,i=!1,s=!1){return{back:e,current:t,forward:o,replaced:i,position:window.history.length,scroll:s?Wr():null}}function pk(e){const{history:t,location:o}=window,i={value:Fp(e,o)},s={value:t.state};s.value||a(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function a(d,p,f){const m=e.indexOf("#"),y=m>-1?(o.host&&document.querySelector("base")?e:e.slice(m))+d:hk()+e+d;try{t[f?"replaceState":"pushState"](p,"",y),s.value=p}catch(_){console.error(_),o[f?"replace":"assign"](y)}}function l(d,p){a(d,At({},t.state,uh(s.value.back,d,s.value.forward,!0),p,{position:s.value.position}),!0),i.value=d}function u(d,p){const f=At({},s.value,t.state,{forward:d,scroll:Wr()});a(f.current,f,!0),a(d,At({},uh(i.value,d,null),{position:f.position+1},p),!1),i.value=d}return{location:i,state:s,push:u,replace:l}}function vk(e){e=Xy(e);const t=pk(e),o=fk(e,t.state,t.location,t.replace);function i(a,l=!0){l||o.pauseListeners(),history.go(a)}const s=At({location:"",base:e,go:i,createHref:ek.bind(null,e)},t,o);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function mk(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),vk(e)}let Wi=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var pn=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(pn||{});const gk={type:Wi.Static,value:""},yk=/[a-zA-Z0-9_]/;function kk(e){if(!e)return[[]];if(e==="/")return[[gk]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(_){throw new Error(`ERR (${o})/"${p}": ${_}`)}let o=pn.Static,i=o;const s=[];let a;function l(){a&&s.push(a),a=[]}let u=0,d,p="",f="";function m(){p&&(o===pn.Static?a.push({type:Wi.Static,value:p}):o===pn.Param||o===pn.ParamRegExp||o===pn.ParamRegExpEnd?(a.length>1&&(d==="*"||d==="+")&&t(`A repeatable param (${p}) must be alone in its segment. eg: '/:ids+.`),a.push({type:Wi.Param,value:p,regexp:f,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):t("Invalid state to consume buffer"),p="")}function y(){p+=d}for(;u<e.length;){if(d=e[u++],d==="\\"&&o!==pn.ParamRegExp){i=o,o=pn.EscapeNext;continue}switch(o){case pn.Static:d==="/"?(p&&m(),l()):d===":"?(m(),o=pn.Param):y();break;case pn.EscapeNext:y(),o=i;break;case pn.Param:d==="("?o=pn.ParamRegExp:yk.test(d)?y():(m(),o=pn.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--);break;case pn.ParamRegExp:d===")"?f[f.length-1]=="\\"?f=f.slice(0,-1)+d:o=pn.ParamRegExpEnd:f+=d;break;case pn.ParamRegExpEnd:m(),o=pn.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--,f="";break;default:t("Unknown state");break}}return o===pn.ParamRegExp&&t(`Unfinished custom RegExp for param "${p}"`),m(),l(),s}const dh="[^/]+?",_k={sensitive:!1,strict:!1,start:!0,end:!0};var jn=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(jn||{});const bk=/[.+*?^${}()[\]/\\]/g;function wk(e,t){const o=At({},_k,t),i=[];let s=o.start?"^":"";const a=[];for(const p of e){const f=p.length?[]:[jn.Root];o.strict&&!p.length&&(s+="/");for(let m=0;m<p.length;m++){const y=p[m];let _=jn.Segment+(o.sensitive?jn.BonusCaseSensitive:0);if(y.type===Wi.Static)m||(s+="/"),s+=y.value.replace(bk,"\\$&"),_+=jn.Static;else if(y.type===Wi.Param){const{value:b,repeatable:S,optional:T,regexp:D}=y;a.push({name:b,repeatable:S,optional:T});const I=D||dh;if(I!==dh){_+=jn.BonusCustomRegExp;try{`${I}`}catch(A){throw new Error(`Invalid custom RegExp for param "${b}" (${I}): `+A.message)}}let C=S?`((?:${I})(?:/(?:${I}))*)`:`(${I})`;m||(C=T&&p.length<2?`(?:/${C})`:"/"+C),T&&(C+="?"),s+=C,_+=jn.Dynamic,T&&(_+=jn.BonusOptional),S&&(_+=jn.BonusRepeatable),I===".*"&&(_+=jn.BonusWildcard)}f.push(_)}i.push(f)}if(o.strict&&o.end){const p=i.length-1;i[p][i[p].length-1]+=jn.BonusStrict}o.strict||(s+="/?"),o.end?s+="$":o.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const l=new RegExp(s,o.sensitive?"":"i");function u(p){const f=p.match(l),m={};if(!f)return null;for(let y=1;y<f.length;y++){const _=f[y]||"",b=a[y-1];m[b.name]=_&&b.repeatable?_.split("/"):_}return m}function d(p){let f="",m=!1;for(const y of e){(!m||!f.endsWith("/"))&&(f+="/"),m=!1;for(const _ of y)if(_.type===Wi.Static)f+=_.value;else if(_.type===Wi.Param){const{value:b,repeatable:S,optional:T}=_,D=b in p?p[b]:"";if(es(D)&&!S)throw new Error(`Provided param "${b}" is an array but it is not repeatable (* or + modifiers)`);const I=es(D)?D.join("/"):D;if(!I)if(T)y.length<2&&(f.endsWith("/")?f=f.slice(0,-1):m=!0);else throw new Error(`Missing required param "${b}"`);f+=I}}return f||"/"}return{re:l,score:i,keys:a,parse:u,stringify:d}}function Ck(e,t){let o=0;for(;o<e.length&&o<t.length;){const i=t[o]-e[o];if(i)return i;o++}return e.length<t.length?e.length===1&&e[0]===jn.Static+jn.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===jn.Static+jn.Segment?1:-1:0}function Up(e,t){let o=0;const i=e.score,s=t.score;for(;o<i.length&&o<s.length;){const a=Ck(i[o],s[o]);if(a)return a;o++}if(Math.abs(s.length-i.length)===1){if(hh(i))return 1;if(hh(s))return-1}return s.length-i.length}function hh(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const Lk={strict:!1,end:!0,sensitive:!1};function Sk(e,t,o){const i=wk(kk(e.path),o),s=At(i,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function xk(e,t){const o=[],i=new Map;t=sh(Lk,t);function s(m){return i.get(m)}function a(m,y,_){const b=!_,S=ph(m);S.aliasOf=_&&_.record;const T=sh(t,m),D=[S];if("alias"in m){const A=typeof m.alias=="string"?[m.alias]:m.alias;for(const E of A)D.push(ph(At({},S,{components:_?_.record.components:S.components,path:E,aliasOf:_?_.record:S})))}let I,C;for(const A of D){const{path:E}=A;if(y&&E[0]!=="/"){const N=y.record.path,$=N[N.length-1]==="/"?"":"/";A.path=y.record.path+(E&&$+E)}if(I=Sk(A,y,T),_?_.alias.push(I):(C=C||I,C!==I&&C.alias.push(I),b&&m.name&&!vh(I)&&l(m.name)),zp(I)&&d(I),S.children){const N=S.children;for(let $=0;$<N.length;$++)a(N[$],I,_&&_.children[$])}_=_||I}return C?()=>{l(C)}:yl}function l(m){if(Bp(m)){const y=i.get(m);y&&(i.delete(m),o.splice(o.indexOf(y),1),y.children.forEach(l),y.alias.forEach(l))}else{const y=o.indexOf(m);y>-1&&(o.splice(y,1),m.record.name&&i.delete(m.record.name),m.children.forEach(l),m.alias.forEach(l))}}function u(){return o}function d(m){const y=Tk(m,o);o.splice(y,0,m),m.record.name&&!vh(m)&&i.set(m.record.name,m)}function p(m,y){let _,b={},S,T;if("name"in m&&m.name){if(_=i.get(m.name),!_)throw Aa(Yt.MATCHER_NOT_FOUND,{location:m});T=_.record.name,b=At(fh(y.params,_.keys.filter(C=>!C.optional).concat(_.parent?_.parent.keys.filter(C=>C.optional):[]).map(C=>C.name)),m.params&&fh(m.params,_.keys.map(C=>C.name))),S=_.stringify(b)}else if(m.path!=null)S=m.path,_=o.find(C=>C.re.test(S)),_&&(b=_.parse(S),T=_.record.name);else{if(_=y.name?i.get(y.name):o.find(C=>C.re.test(y.path)),!_)throw Aa(Yt.MATCHER_NOT_FOUND,{location:m,currentLocation:y});T=_.record.name,b=At({},y.params,m.params),S=_.stringify(b)}const D=[];let I=_;for(;I;)D.unshift(I.record),I=I.parent;return{name:T,path:S,params:b,matched:D,meta:$k(D)}}e.forEach(m=>a(m));function f(){o.length=0,i.clear()}return{addRoute:a,resolve:p,removeRoute:l,clearRoutes:f,getRoutes:u,getRecordMatcher:s}}function fh(e,t){const o={};for(const i of t)i in e&&(o[i]=e[i]);return o}function ph(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:Ik(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function Ik(e){const t={},o=e.props||!1;if("component"in e)t.default=o;else for(const i in e.components)t[i]=typeof o=="object"?o[i]:o;return t}function vh(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function $k(e){return e.reduce((t,o)=>At(t,o.meta),{})}function Tk(e,t){let o=0,i=t.length;for(;o!==i;){const a=o+i>>1;Up(e,t[a])<0?i=a:o=a+1}const s=Mk(e);return s&&(i=t.lastIndexOf(s,i-1)),i}function Mk(e){let t=e;for(;t=t.parent;)if(zp(t)&&Up(e,t)===0)return t}function zp({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function mh(e){const t=To(Kr),o=To(Fu),i=H(()=>{const d=V(e.to);return t.resolve(d)}),s=H(()=>{const{matched:d}=i.value,{length:p}=d,f=d[p-1],m=o.matched;if(!f||!m.length)return-1;const y=m.findIndex(Ma.bind(null,f));if(y>-1)return y;const _=gh(d[p-2]);return p>1&&gh(f)===_&&m[m.length-1].path!==_?m.findIndex(Ma.bind(null,d[p-2])):y}),a=H(()=>s.value>-1&&Rk(o.params,i.value.params)),l=H(()=>s.value>-1&&s.value===o.matched.length-1&&Op(o.params,i.value.params));function u(d={}){if(Dk(d)){const p=t[V(e.replace)?"replace":"push"](V(e.to)).catch(yl);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>p),p}return Promise.resolve()}return{route:i,href:H(()=>i.value.href),isActive:a,isExactActive:l,navigate:u}}function Ak(e){return e.length===1?e[0]:e}const Ek=qf({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:mh,setup(e,{slots:t}){const o=Al(mh(e)),{options:i}=To(Kr),s=H(()=>({[yh(e.activeClass,i.linkActiveClass,"router-link-active")]:o.isActive,[yh(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:o.isExactActive}));return()=>{const a=t.default&&Ak(t.default(o));return e.custom?a:Ou("a",{"aria-current":o.isExactActive?e.ariaCurrentValue:null,href:o.href,onClick:o.navigate,class:s.value},a)}}}),Pk=Ek;function Dk(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function Rk(e,t){for(const o in t){const i=t[o],s=e[o];if(typeof i=="string"){if(i!==s)return!1}else if(!es(s)||s.length!==i.length||i.some((a,l)=>a.valueOf()!==s[l].valueOf()))return!1}return!0}function gh(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const yh=(e,t,o)=>e??t??o,Ok=qf({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:o}){const i=To(tu),s=H(()=>e.route||i.value),a=To(ch,0),l=H(()=>{let p=V(a);const{matched:f}=s.value;let m;for(;(m=f[p])&&!m.components;)p++;return p}),u=H(()=>s.value.matched[l.value]);ir(ch,H(()=>l.value+1)),ir(uk,u),ir(tu,s);const d=M();return Ze(()=>[d.value,u.value,e.name],([p,f,m],[y,_,b])=>{f&&(f.instances[m]=p,_&&_!==f&&p&&p===y&&(f.leaveGuards.size||(f.leaveGuards=_.leaveGuards),f.updateGuards.size||(f.updateGuards=_.updateGuards))),p&&f&&(!_||!Ma(f,_)||!y)&&(f.enterCallbacks[m]||[]).forEach(S=>S(p))},{flush:"post"}),()=>{const p=s.value,f=e.name,m=u.value,y=m&&m.components[f];if(!y)return kh(o.default,{Component:y,route:p});const _=m.props[f],b=_?_===!0?p.params:typeof _=="function"?_(p):_:null,T=Ou(y,At({},b,t,{onVnodeUnmounted:D=>{D.component.isUnmounted&&(m.instances[f]=null)},ref:d}));return kh(o.default,{Component:T,route:p})||T}}});function kh(e,t){if(!e)return null;const o=e(t);return o.length===1?o[0]:o}const Bk=Ok;function Nk(e){const t=xk(e.routes,e),o=e.parseQuery||rk,i=e.stringifyQuery||rh,s=e.history,a=ol(),l=ol(),u=ol(),d=$m(ci);let p=ci;ka&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const f=Ic.bind(null,be=>""+be),m=Ic.bind(null,jy),y=Ic.bind(null,Il);function _(be,He){let fe,Ie;return Bp(be)?(fe=t.getRecordMatcher(be),Ie=He):Ie=be,t.addRoute(Ie,fe)}function b(be){const He=t.getRecordMatcher(be);He&&t.removeRoute(He)}function S(){return t.getRoutes().map(be=>be.record)}function T(be){return!!t.getRecordMatcher(be)}function D(be,He){if(He=At({},He||d.value),typeof be=="string"){const le=$c(o,be,He.path),ye=t.resolve({path:le.path},He),ie=s.createHref(le.fullPath);return At(le,ye,{params:y(ye.params),hash:Il(le.hash),redirectedFrom:void 0,href:ie})}let fe;if(be.path!=null)fe=At({},be,{path:$c(o,be.path,He.path).path});else{const le=At({},be.params);for(const ye in le)le[ye]==null&&delete le[ye];fe=At({},be,{params:m(le)}),He.params=m(He.params)}const Ie=t.resolve(fe,He),Te=be.hash||"";Ie.params=f(y(Ie.params));const W=Wy(i,At({},be,{hash:Hy(Te),path:Ie.path})),Y=s.createHref(W);return At({fullPath:W,hash:Te,query:i===rh?ck(be.query):be.query||{}},Ie,{redirectedFrom:void 0,href:Y})}function I(be){return typeof be=="string"?$c(o,be,d.value.path):At({},be)}function C(be,He){if(p!==be)return Aa(Yt.NAVIGATION_CANCELLED,{from:He,to:be})}function A(be){return $(be)}function E(be){return A(At(I(be),{replace:!0}))}function N(be,He){const fe=be.matched[be.matched.length-1];if(fe&&fe.redirect){const{redirect:Ie}=fe;let Te=typeof Ie=="function"?Ie(be,He):Ie;return typeof Te=="string"&&(Te=Te.includes("?")||Te.includes("#")?Te=I(Te):{path:Te},Te.params={}),At({query:be.query,hash:be.hash,params:Te.path!=null?{}:be.params},Te)}}function $(be,He){const fe=p=D(be),Ie=d.value,Te=be.state,W=be.force,Y=be.replace===!0,le=N(fe,Ie);if(le)return $(At(I(le),{state:typeof le=="object"?At({},Te,le.state):Te,force:W,replace:Y}),He||fe);const ye=fe;ye.redirectedFrom=He;let ie;return!W&&Ky(i,Ie,fe)&&(ie=Aa(Yt.NAVIGATION_DUPLICATED,{to:ye,from:Ie}),de(Ie,Ie,!0,!1)),(ie?Promise.resolve(ie):Z(ye,Ie)).catch(oe=>Ms(oe)?Ms(oe,Yt.NAVIGATION_GUARD_REDIRECT)?oe:ge(oe):ae(oe,ye,Ie)).then(oe=>{if(oe){if(Ms(oe,Yt.NAVIGATION_GUARD_REDIRECT))return $(At({replace:Y},I(oe.to),{state:typeof oe.to=="object"?At({},Te,oe.to.state):Te,force:W}),He||ye)}else oe=K(ye,Ie,!0,Y,Te);return U(ye,Ie,oe),oe})}function G(be,He){const fe=C(be,He);return fe?Promise.reject(fe):Promise.resolve()}function R(be){const He=et.values().next().value;return He&&typeof He.runWithContext=="function"?He.runWithContext(be):be()}function Z(be,He){let fe;const[Ie,Te,W]=dk(be,He);fe=Mc(Ie.reverse(),"beforeRouteLeave",be,He);for(const le of Ie)le.leaveGuards.forEach(ye=>{fe.push(vi(ye,be,He))});const Y=G.bind(null,be,He);return fe.push(Y),tt(fe).then(()=>{fe=[];for(const le of a.list())fe.push(vi(le,be,He));return fe.push(Y),tt(fe)}).then(()=>{fe=Mc(Te,"beforeRouteUpdate",be,He);for(const le of Te)le.updateGuards.forEach(ye=>{fe.push(vi(ye,be,He))});return fe.push(Y),tt(fe)}).then(()=>{fe=[];for(const le of W)if(le.beforeEnter)if(es(le.beforeEnter))for(const ye of le.beforeEnter)fe.push(vi(ye,be,He));else fe.push(vi(le.beforeEnter,be,He));return fe.push(Y),tt(fe)}).then(()=>(be.matched.forEach(le=>le.enterCallbacks={}),fe=Mc(W,"beforeRouteEnter",be,He,R),fe.push(Y),tt(fe))).then(()=>{fe=[];for(const le of l.list())fe.push(vi(le,be,He));return fe.push(Y),tt(fe)}).catch(le=>Ms(le,Yt.NAVIGATION_CANCELLED)?le:Promise.reject(le))}function U(be,He,fe){u.list().forEach(Ie=>R(()=>Ie(be,He,fe)))}function K(be,He,fe,Ie,Te){const W=C(be,He);if(W)return W;const Y=He===ci,le=ka?history.state:{};fe&&(Ie||Y?s.replace(be.fullPath,At({scroll:Y&&le&&le.scroll},Te)):s.push(be.fullPath,Te)),d.value=be,de(be,He,fe,Y),ge()}let re;function Pe(){re||(re=s.listen((be,He,fe)=>{if(!qe.listening)return;const Ie=D(be),Te=N(Ie,qe.currentRoute.value);if(Te){$(At(Te,{replace:!0,force:!0}),Ie).catch(yl);return}p=Ie;const W=d.value;ka&&ok(lh(W.fullPath,fe.delta),Wr()),Z(Ie,W).catch(Y=>Ms(Y,Yt.NAVIGATION_ABORTED|Yt.NAVIGATION_CANCELLED)?Y:Ms(Y,Yt.NAVIGATION_GUARD_REDIRECT)?($(At(I(Y.to),{force:!0}),Ie).then(le=>{Ms(le,Yt.NAVIGATION_ABORTED|Yt.NAVIGATION_DUPLICATED)&&!fe.delta&&fe.type===Qc.pop&&s.go(-1,!1)}).catch(yl),Promise.reject()):(fe.delta&&s.go(-fe.delta,!1),ae(Y,Ie,W))).then(Y=>{Y=Y||K(Ie,W,!1),Y&&(fe.delta&&!Ms(Y,Yt.NAVIGATION_CANCELLED)?s.go(-fe.delta,!1):fe.type===Qc.pop&&Ms(Y,Yt.NAVIGATION_ABORTED|Yt.NAVIGATION_DUPLICATED)&&s.go(-1,!1)),U(Ie,W,Y)}).catch(yl)}))}let me=ol(),Ae=ol(),Fe;function ae(be,He,fe){ge(be);const Ie=Ae.list();return Ie.length?Ie.forEach(Te=>Te(be,He,fe)):console.error(be),Promise.reject(be)}function Me(){return Fe&&d.value!==ci?Promise.resolve():new Promise((be,He)=>{me.add([be,He])})}function ge(be){return Fe||(Fe=!be,Pe(),me.list().forEach(([He,fe])=>be?fe(be):He()),me.reset()),be}function de(be,He,fe,Ie){const{scrollBehavior:Te}=e;if(!ka||!Te)return Promise.resolve();const W=!fe&&sk(lh(be.fullPath,0))||(Ie||!fe)&&history.state&&history.state.scroll||null;return qn().then(()=>Te(be,He,W)).then(Y=>Y&&nk(Y)).catch(Y=>ae(Y,be,He))}const Oe=be=>s.go(be);let Xe;const et=new Set,qe={currentRoute:d,listening:!0,addRoute:_,removeRoute:b,clearRoutes:t.clearRoutes,hasRoute:T,getRoutes:S,resolve:D,options:e,push:A,replace:E,go:Oe,back:()=>Oe(-1),forward:()=>Oe(1),beforeEach:a.add,beforeResolve:l.add,afterEach:u.add,onError:Ae.add,isReady:Me,install(be){be.component("RouterLink",Pk),be.component("RouterView",Bk),be.config.globalProperties.$router=qe,Object.defineProperty(be.config.globalProperties,"$route",{enumerable:!0,get:()=>V(d)}),ka&&!Xe&&d.value===ci&&(Xe=!0,A(s.location).catch(Ie=>{}));const He={};for(const Ie in ci)Object.defineProperty(He,Ie,{get:()=>d.value[Ie],enumerable:!0});be.provide(Kr,qe),be.provide(Fu,If(He)),be.provide(tu,d);const fe=be.unmount;et.add(be),be.unmount=function(){et.delete(be),et.size<1&&(p=ci,re&&re(),re=null,d.value=ci,Xe=!1,Fe=!1),fe()}}};function tt(be){return be.reduce((He,fe)=>He.then(()=>R(fe)),Promise.resolve())}return qe}function Ra(){return To(Kr)}function Yr(e){return To(Fu)}const Fk={class:"hero-animation-container"},Uk={__name:"HeroMapAnimation",setup(e){const t=M(!1);return Qt(()=>{requestAnimationFrame(()=>{t.value=!0})}),(o,i)=>(v(),g("div",Fk,[(v(),g("svg",{viewBox:"0 0 400 350",class:ue(["hero-map-svg",{animate:t.value}])},[...i[0]||(i[0]=[br(`<defs data-v-1b7f6f65><clipPath id="mapClip" data-v-1b7f6f65><polygon points="80,0 320,0 420,350 -20,350" data-v-1b7f6f65></polygon></clipPath></defs><g class="map-group" data-v-1b7f6f65><polygon points="80,0 320,0 420,350 -20,350" fill="#c8e6c0" stroke="#8fbc8f" stroke-width="3" data-v-1b7f6f65></polygon><g clip-path="url(#mapClip)" class="contours" data-v-1b7f6f65><ellipse cx="300" cy="60" rx="35" ry="12" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="300" cy="60" rx="25" ry="8" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="300" cy="60" rx="15" ry="5" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="80" cy="220" rx="80" ry="40" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="80" cy="220" rx="55" ry="28" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="80" cy="220" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="320" cy="180" rx="50" ry="25" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="320" cy="180" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse></g><g clip-path="url(#mapClip)" class="roads" data-v-1b7f6f65><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#1a5276" stroke-width="18" stroke-linecap="round" data-v-1b7f6f65></path><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#5dade2" stroke-width="12" stroke-linecap="round" data-v-1b7f6f65></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#cc8800" stroke-width="10" stroke-linecap="round" data-v-1b7f6f65></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#ffcc00" stroke-width="6" stroke-linecap="round" data-v-1b7f6f65></path></g><path id="routePath" d="M 60,360
             L 200,250
             L 150,150
             L 280,100
             L 450,60" fill="none" stroke="none" data-v-1b7f6f65></path><g class="trail-segments" data-v-1b7f6f65><path class="trail-seg trail-seg-1" d="M 60,360 L 200,250" fill="none" stroke="#dc3545" stroke-width="12" stroke-linecap="round" stroke-linejoin="round" data-v-1b7f6f65></path><path class="trail-seg trail-seg-2" d="M 200,250 L 150,150" fill="none" stroke="#dc3545" stroke-width="9" stroke-linecap="round" stroke-linejoin="round" data-v-1b7f6f65></path><path class="trail-seg trail-seg-3" d="M 150,150 L 280,100" fill="none" stroke="#dc3545" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" data-v-1b7f6f65></path><path class="trail-seg trail-seg-4" d="M 280,100 L 450,60" fill="none" stroke="#dc3545" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" data-v-1b7f6f65></path></g><g class="checkpoint checkpoint-1" transform="translate(200, 250)" data-v-1b7f6f65><ellipse cx="0" cy="8" rx="40" ry="12" fill="#4a5aba" opacity="0.4" data-v-1b7f6f65></ellipse><ellipse cx="0" cy="4" rx="30" ry="10" fill="#667eea" data-v-1b7f6f65></ellipse><ellipse cx="0" cy="0" rx="25" ry="8" fill="#8b9ff0" data-v-1b7f6f65></ellipse></g><g class="checkpoint checkpoint-2" transform="translate(150, 150)" data-v-1b7f6f65><ellipse cx="0" cy="6" rx="18" ry="8" fill="#4a5aba" opacity="0.4" data-v-1b7f6f65></ellipse><ellipse cx="0" cy="3" rx="15" ry="6" fill="#667eea" data-v-1b7f6f65></ellipse><ellipse cx="0" cy="0" rx="12" ry="5" fill="#8b9ff0" data-v-1b7f6f65></ellipse></g><g class="checkpoint checkpoint-3" transform="translate(280, 100)" data-v-1b7f6f65><ellipse cx="0" cy="4" rx="12" ry="5" fill="#4a5aba" opacity="0.4" data-v-1b7f6f65></ellipse><ellipse cx="0" cy="2" rx="10" ry="4" fill="#667eea" data-v-1b7f6f65></ellipse><ellipse cx="0" cy="0" rx="8" ry="3" fill="#8b9ff0" data-v-1b7f6f65></ellipse></g><g class="marshal marshal-1" transform="translate(200, 250)" data-v-1b7f6f65><circle cx="0" cy="-28" r="12" fill="#444" data-v-1b7f6f65></circle><path d="M 20,0 v-8 a12 12 0 0 0-12-12 h-16 a12 12 0 0 0-12 12 v8" fill="#444" data-v-1b7f6f65></path></g><g class="marshal marshal-2" transform="translate(150, 150)" data-v-1b7f6f65><circle cx="0" cy="-18" r="8" fill="#444" data-v-1b7f6f65></circle><path d="M 12,0 v-5 a8 8 0 0 0-8-8 h-8 a8 8 0 0 0-8 8 v5" fill="#444" data-v-1b7f6f65></path></g><g class="marshal marshal-3" transform="translate(280, 100)" data-v-1b7f6f65><circle cx="0" cy="-12" r="6" fill="#444" data-v-1b7f6f65></circle><path d="M 9,0 v-4 a6 6 0 0 0-6-6 h-6 a6 6 0 0 0-6 6 v4" fill="#444" data-v-1b7f6f65></path></g><g clip-path="url(#mapClip)" class="trees" data-v-1b7f6f65><g transform="translate(45, 280)" data-v-1b7f6f65><polygon points="0,-20 12,0 -12,0" fill="#2d5a2d" data-v-1b7f6f65></polygon><polygon points="0,-34 10,-12 -10,-12" fill="#2d5a2d" data-v-1b7f6f65></polygon><polygon points="0,-46 8,-26 -8,-26" fill="#2d5a2d" data-v-1b7f6f65></polygon><rect x="-3" y="0" width="6" height="8" fill="#5d4037" data-v-1b7f6f65></rect></g><g transform="translate(75, 255)" data-v-1b7f6f65><polygon points="0,-18 10,0 -10,0" fill="#3d6a3d" data-v-1b7f6f65></polygon><polygon points="0,-30 8,-10 -8,-10" fill="#3d6a3d" data-v-1b7f6f65></polygon><polygon points="0,-40 6,-22 -6,-22" fill="#3d6a3d" data-v-1b7f6f65></polygon><rect x="-2.5" y="0" width="5" height="6" fill="#5d4037" data-v-1b7f6f65></rect></g><g transform="translate(350, 230)" data-v-1b7f6f65><polygon points="0,-20 11,0 -11,0" fill="#2d5a2d" data-v-1b7f6f65></polygon><polygon points="0,-33 9,-11 -9,-11" fill="#2d5a2d" data-v-1b7f6f65></polygon><polygon points="0,-44 7,-24 -7,-24" fill="#2d5a2d" data-v-1b7f6f65></polygon><rect x="-2.5" y="0" width="5" height="7" fill="#5d4037" data-v-1b7f6f65></rect></g><g transform="translate(60, 140)" data-v-1b7f6f65><polygon points="0,-12 7,0 -7,0" fill="#3d6a3d" data-v-1b7f6f65></polygon><polygon points="0,-20 5.5,-8 -5.5,-8" fill="#3d6a3d" data-v-1b7f6f65></polygon><polygon points="0,-27 4,-15 -4,-15" fill="#3d6a3d" data-v-1b7f6f65></polygon><rect x="-1.5" y="0" width="3" height="4" fill="#5d4037" data-v-1b7f6f65></rect></g><g transform="translate(320, 70)" data-v-1b7f6f65><polygon points="0,-9 5,0 -5,0" fill="#2d5a2d" data-v-1b7f6f65></polygon><polygon points="0,-15 4,-6 -4,-6" fill="#2d5a2d" data-v-1b7f6f65></polygon><polygon points="0,-20 3,-11 -3,-11" fill="#2d5a2d" data-v-1b7f6f65></polygon><rect x="-1" y="0" width="2" height="3" fill="#5d4037" data-v-1b7f6f65></rect></g><g transform="translate(320, 140)" data-v-1b7f6f65><polygon points="0,-14 8,0 -8,0" fill="#3d6a3d" data-v-1b7f6f65></polygon><polygon points="0,-24 6,-9 -6,-9" fill="#3d6a3d" data-v-1b7f6f65></polygon><polygon points="0,-32 5,-18 -5,-18" fill="#3d6a3d" data-v-1b7f6f65></polygon><rect x="-1.5" y="0" width="3" height="5" fill="#5d4037" data-v-1b7f6f65></rect></g></g></g>`,2)])],2))]))}},zk=ze(Uk,[["__scopeId","data-v-1b7f6f65"]]);function Hp(e,t){return function(){return e.apply(t,arguments)}}const{toString:Hk}=Object.prototype,{getPrototypeOf:Uu}=Object,{iterator:Jr,toStringTag:Vp}=Symbol,Xr=(e=>t=>{const o=Hk.call(t);return e[o]||(e[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),ts=e=>(e=e.toLowerCase(),t=>Xr(t)===e),Qr=e=>t=>typeof t===e,{isArray:Oa}=Array,Ea=Qr("undefined");function Dl(e){return e!==null&&!Ea(e)&&e.constructor!==null&&!Ea(e.constructor)&&oo(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Gp=ts("ArrayBuffer");function Vk(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Gp(e.buffer),t}const Gk=Qr("string"),oo=Qr("function"),jp=Qr("number"),Rl=e=>e!==null&&typeof e=="object",jk=e=>e===!0||e===!1,cr=e=>{if(Xr(e)!=="object")return!1;const t=Uu(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Vp in e)&&!(Jr in e)},Zk=e=>{if(!Rl(e)||Dl(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},qk=ts("Date"),Wk=ts("File"),Kk=ts("Blob"),Yk=ts("FileList"),Jk=e=>Rl(e)&&oo(e.pipe),Xk=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||oo(e.append)&&((t=Xr(e))==="formdata"||t==="object"&&oo(e.toString)&&e.toString()==="[object FormData]"))},Qk=ts("URLSearchParams"),[e1,t1,n1,o1]=["ReadableStream","Request","Response","Headers"].map(ts),s1=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ol(e,t,{allOwnKeys:o=!1}={}){if(e===null||typeof e>"u")return;let i,s;if(typeof e!="object"&&(e=[e]),Oa(e))for(i=0,s=e.length;i<s;i++)t.call(null,e[i],i,e);else{if(Dl(e))return;const a=o?Object.getOwnPropertyNames(e):Object.keys(e),l=a.length;let u;for(i=0;i<l;i++)u=a[i],t.call(null,e[u],u,e)}}function Zp(e,t){if(Dl(e))return null;t=t.toLowerCase();const o=Object.keys(e);let i=o.length,s;for(;i-- >0;)if(s=o[i],t===s.toLowerCase())return s;return null}const Ki=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,qp=e=>!Ea(e)&&e!==Ki;function nu(){const{caseless:e,skipUndefined:t}=qp(this)&&this||{},o={},i=(s,a)=>{const l=e&&Zp(o,a)||a;cr(o[l])&&cr(s)?o[l]=nu(o[l],s):cr(s)?o[l]=nu({},s):Oa(s)?o[l]=s.slice():(!t||!Ea(s))&&(o[l]=s)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&Ol(arguments[s],i);return o}const i1=(e,t,o,{allOwnKeys:i}={})=>(Ol(t,(s,a)=>{o&&oo(s)?e[a]=Hp(s,o):e[a]=s},{allOwnKeys:i}),e),a1=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),l1=(e,t,o,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),o&&Object.assign(e.prototype,o)},r1=(e,t,o,i)=>{let s,a,l;const u={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),a=s.length;a-- >0;)l=s[a],(!i||i(l,e,t))&&!u[l]&&(t[l]=e[l],u[l]=!0);e=o!==!1&&Uu(e)}while(e&&(!o||o(e,t))&&e!==Object.prototype);return t},c1=(e,t,o)=>{e=String(e),(o===void 0||o>e.length)&&(o=e.length),o-=t.length;const i=e.indexOf(t,o);return i!==-1&&i===o},u1=e=>{if(!e)return null;if(Oa(e))return e;let t=e.length;if(!jp(t))return null;const o=new Array(t);for(;t-- >0;)o[t]=e[t];return o},d1=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Uu(Uint8Array)),h1=(e,t)=>{const i=(e&&e[Jr]).call(e);let s;for(;(s=i.next())&&!s.done;){const a=s.value;t.call(e,a[0],a[1])}},f1=(e,t)=>{let o;const i=[];for(;(o=e.exec(t))!==null;)i.push(o);return i},p1=ts("HTMLFormElement"),v1=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,i,s){return i.toUpperCase()+s}),_h=(({hasOwnProperty:e})=>(t,o)=>e.call(t,o))(Object.prototype),m1=ts("RegExp"),Wp=(e,t)=>{const o=Object.getOwnPropertyDescriptors(e),i={};Ol(o,(s,a)=>{let l;(l=t(s,a,e))!==!1&&(i[a]=l||s)}),Object.defineProperties(e,i)},g1=e=>{Wp(e,(t,o)=>{if(oo(e)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const i=e[o];if(oo(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},y1=(e,t)=>{const o={},i=s=>{s.forEach(a=>{o[a]=!0})};return Oa(e)?i(e):i(String(e).split(t)),o},k1=()=>{},_1=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function b1(e){return!!(e&&oo(e.append)&&e[Vp]==="FormData"&&e[Jr])}const w1=e=>{const t=new Array(10),o=(i,s)=>{if(Rl(i)){if(t.indexOf(i)>=0)return;if(Dl(i))return i;if(!("toJSON"in i)){t[s]=i;const a=Oa(i)?[]:{};return Ol(i,(l,u)=>{const d=o(l,s+1);!Ea(d)&&(a[u]=d)}),t[s]=void 0,a}}return i};return o(e,0)},C1=ts("AsyncFunction"),L1=e=>e&&(Rl(e)||oo(e))&&oo(e.then)&&oo(e.catch),Kp=((e,t)=>e?setImmediate:t?((o,i)=>(Ki.addEventListener("message",({source:s,data:a})=>{s===Ki&&a===o&&i.length&&i.shift()()},!1),s=>{i.push(s),Ki.postMessage(o,"*")}))(`axios@${Math.random()}`,[]):o=>setTimeout(o))(typeof setImmediate=="function",oo(Ki.postMessage)),S1=typeof queueMicrotask<"u"?queueMicrotask.bind(Ki):typeof process<"u"&&process.nextTick||Kp,x1=e=>e!=null&&oo(e[Jr]),Se={isArray:Oa,isArrayBuffer:Gp,isBuffer:Dl,isFormData:Xk,isArrayBufferView:Vk,isString:Gk,isNumber:jp,isBoolean:jk,isObject:Rl,isPlainObject:cr,isEmptyObject:Zk,isReadableStream:e1,isRequest:t1,isResponse:n1,isHeaders:o1,isUndefined:Ea,isDate:qk,isFile:Wk,isBlob:Kk,isRegExp:m1,isFunction:oo,isStream:Jk,isURLSearchParams:Qk,isTypedArray:d1,isFileList:Yk,forEach:Ol,merge:nu,extend:i1,trim:s1,stripBOM:a1,inherits:l1,toFlatObject:r1,kindOf:Xr,kindOfTest:ts,endsWith:c1,toArray:u1,forEachEntry:h1,matchAll:f1,isHTMLForm:p1,hasOwnProperty:_h,hasOwnProp:_h,reduceDescriptors:Wp,freezeMethods:g1,toObjectSet:y1,toCamelCase:v1,noop:k1,toFiniteNumber:_1,findKey:Zp,global:Ki,isContextDefined:qp,isSpecCompliantForm:b1,toJSONObject:w1,isAsyncFn:C1,isThenable:L1,setImmediate:Kp,asap:S1,isIterable:x1};function vt(e,t,o,i,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),o&&(this.config=o),i&&(this.request=i),s&&(this.response=s,this.status=s.status?s.status:null)}Se.inherits(vt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Se.toJSONObject(this.config),code:this.code,status:this.status}}});const Yp=vt.prototype,Jp={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Jp[e]={value:e}});Object.defineProperties(vt,Jp);Object.defineProperty(Yp,"isAxiosError",{value:!0});vt.from=(e,t,o,i,s,a)=>{const l=Object.create(Yp);Se.toFlatObject(e,l,function(f){return f!==Error.prototype},p=>p!=="isAxiosError");const u=e&&e.message?e.message:"Error",d=t==null&&e?e.code:t;return vt.call(l,u,d,o,i,s),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",a&&Object.assign(l,a),l};const I1=null;function ou(e){return Se.isPlainObject(e)||Se.isArray(e)}function Xp(e){return Se.endsWith(e,"[]")?e.slice(0,-2):e}function bh(e,t,o){return e?e.concat(t).map(function(s,a){return s=Xp(s),!o&&a?"["+s+"]":s}).join(o?".":""):t}function $1(e){return Se.isArray(e)&&!e.some(ou)}const T1=Se.toFlatObject(Se,{},null,function(t){return/^is[A-Z]/.test(t)});function ec(e,t,o){if(!Se.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,o=Se.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,T){return!Se.isUndefined(T[S])});const i=o.metaTokens,s=o.visitor||f,a=o.dots,l=o.indexes,d=(o.Blob||typeof Blob<"u"&&Blob)&&Se.isSpecCompliantForm(t);if(!Se.isFunction(s))throw new TypeError("visitor must be a function");function p(b){if(b===null)return"";if(Se.isDate(b))return b.toISOString();if(Se.isBoolean(b))return b.toString();if(!d&&Se.isBlob(b))throw new vt("Blob is not supported. Use a Buffer instead.");return Se.isArrayBuffer(b)||Se.isTypedArray(b)?d&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function f(b,S,T){let D=b;if(b&&!T&&typeof b=="object"){if(Se.endsWith(S,"{}"))S=i?S:S.slice(0,-2),b=JSON.stringify(b);else if(Se.isArray(b)&&$1(b)||(Se.isFileList(b)||Se.endsWith(S,"[]"))&&(D=Se.toArray(b)))return S=Xp(S),D.forEach(function(C,A){!(Se.isUndefined(C)||C===null)&&t.append(l===!0?bh([S],A,a):l===null?S:S+"[]",p(C))}),!1}return ou(b)?!0:(t.append(bh(T,S,a),p(b)),!1)}const m=[],y=Object.assign(T1,{defaultVisitor:f,convertValue:p,isVisitable:ou});function _(b,S){if(!Se.isUndefined(b)){if(m.indexOf(b)!==-1)throw Error("Circular reference detected in "+S.join("."));m.push(b),Se.forEach(b,function(D,I){(!(Se.isUndefined(D)||D===null)&&s.call(t,D,Se.isString(I)?I.trim():I,S,y))===!0&&_(D,S?S.concat(I):[I])}),m.pop()}}if(!Se.isObject(e))throw new TypeError("data must be an object");return _(e),t}function wh(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function zu(e,t){this._pairs=[],e&&ec(e,this,t)}const Qp=zu.prototype;Qp.append=function(t,o){this._pairs.push([t,o])};Qp.toString=function(t){const o=t?function(i){return t.call(this,i,wh)}:wh;return this._pairs.map(function(s){return o(s[0])+"="+o(s[1])},"").join("&")};function M1(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function ev(e,t,o){if(!t)return e;const i=o&&o.encode||M1;Se.isFunction(o)&&(o={serialize:o});const s=o&&o.serialize;let a;if(s?a=s(t,o):a=Se.isURLSearchParams(t)?t.toString():new zu(t,o).toString(i),a){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class Ch{constructor(){this.handlers=[]}use(t,o,i){return this.handlers.push({fulfilled:t,rejected:o,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Se.forEach(this.handlers,function(i){i!==null&&t(i)})}}const tv={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},A1=typeof URLSearchParams<"u"?URLSearchParams:zu,E1=typeof FormData<"u"?FormData:null,P1=typeof Blob<"u"?Blob:null,D1={isBrowser:!0,classes:{URLSearchParams:A1,FormData:E1,Blob:P1},protocols:["http","https","file","blob","url","data"]},Hu=typeof window<"u"&&typeof document<"u",su=typeof navigator=="object"&&navigator||void 0,R1=Hu&&(!su||["ReactNative","NativeScript","NS"].indexOf(su.product)<0),O1=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",B1=Hu&&window.location.href||"http://localhost",N1=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Hu,hasStandardBrowserEnv:R1,hasStandardBrowserWebWorkerEnv:O1,navigator:su,origin:B1},Symbol.toStringTag,{value:"Module"})),Rn={...N1,...D1};function F1(e,t){return ec(e,new Rn.classes.URLSearchParams,{visitor:function(o,i,s,a){return Rn.isNode&&Se.isBuffer(o)?(this.append(i,o.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function U1(e){return Se.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function z1(e){const t={},o=Object.keys(e);let i;const s=o.length;let a;for(i=0;i<s;i++)a=o[i],t[a]=e[a];return t}function nv(e){function t(o,i,s,a){let l=o[a++];if(l==="__proto__")return!0;const u=Number.isFinite(+l),d=a>=o.length;return l=!l&&Se.isArray(s)?s.length:l,d?(Se.hasOwnProp(s,l)?s[l]=[s[l],i]:s[l]=i,!u):((!s[l]||!Se.isObject(s[l]))&&(s[l]=[]),t(o,i,s[l],a)&&Se.isArray(s[l])&&(s[l]=z1(s[l])),!u)}if(Se.isFormData(e)&&Se.isFunction(e.entries)){const o={};return Se.forEachEntry(e,(i,s)=>{t(U1(i),s,o,0)}),o}return null}function H1(e,t,o){if(Se.isString(e))try{return(t||JSON.parse)(e),Se.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(o||JSON.stringify)(e)}const Bl={transitional:tv,adapter:["xhr","http","fetch"],transformRequest:[function(t,o){const i=o.getContentType()||"",s=i.indexOf("application/json")>-1,a=Se.isObject(t);if(a&&Se.isHTMLForm(t)&&(t=new FormData(t)),Se.isFormData(t))return s?JSON.stringify(nv(t)):t;if(Se.isArrayBuffer(t)||Se.isBuffer(t)||Se.isStream(t)||Se.isFile(t)||Se.isBlob(t)||Se.isReadableStream(t))return t;if(Se.isArrayBufferView(t))return t.buffer;if(Se.isURLSearchParams(t))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(a){if(i.indexOf("application/x-www-form-urlencoded")>-1)return F1(t,this.formSerializer).toString();if((u=Se.isFileList(t))||i.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return ec(u?{"files[]":t}:t,d&&new d,this.formSerializer)}}return a||s?(o.setContentType("application/json",!1),H1(t)):t}],transformResponse:[function(t){const o=this.transitional||Bl.transitional,i=o&&o.forcedJSONParsing,s=this.responseType==="json";if(Se.isResponse(t)||Se.isReadableStream(t))return t;if(t&&Se.isString(t)&&(i&&!this.responseType||s)){const l=!(o&&o.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(u){if(l)throw u.name==="SyntaxError"?vt.from(u,vt.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Rn.classes.FormData,Blob:Rn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Se.forEach(["delete","get","head","post","put","patch"],e=>{Bl.headers[e]={}});const V1=Se.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),G1=e=>{const t={};let o,i,s;return e&&e.split(`
`).forEach(function(l){s=l.indexOf(":"),o=l.substring(0,s).trim().toLowerCase(),i=l.substring(s+1).trim(),!(!o||t[o]&&V1[o])&&(o==="set-cookie"?t[o]?t[o].push(i):t[o]=[i]:t[o]=t[o]?t[o]+", "+i:i)}),t},Lh=Symbol("internals");function sl(e){return e&&String(e).trim().toLowerCase()}function ur(e){return e===!1||e==null?e:Se.isArray(e)?e.map(ur):String(e)}function j1(e){const t=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=o.exec(e);)t[i[1]]=i[2];return t}const Z1=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Ac(e,t,o,i,s){if(Se.isFunction(i))return i.call(this,t,o);if(s&&(t=o),!!Se.isString(t)){if(Se.isString(i))return t.indexOf(i)!==-1;if(Se.isRegExp(i))return i.test(t)}}function q1(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,o,i)=>o.toUpperCase()+i)}function W1(e,t){const o=Se.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+o,{value:function(s,a,l){return this[i].call(this,t,s,a,l)},configurable:!0})})}let so=class{constructor(t){t&&this.set(t)}set(t,o,i){const s=this;function a(u,d,p){const f=sl(d);if(!f)throw new Error("header name must be a non-empty string");const m=Se.findKey(s,f);(!m||s[m]===void 0||p===!0||p===void 0&&s[m]!==!1)&&(s[m||d]=ur(u))}const l=(u,d)=>Se.forEach(u,(p,f)=>a(p,f,d));if(Se.isPlainObject(t)||t instanceof this.constructor)l(t,o);else if(Se.isString(t)&&(t=t.trim())&&!Z1(t))l(G1(t),o);else if(Se.isObject(t)&&Se.isIterable(t)){let u={},d,p;for(const f of t){if(!Se.isArray(f))throw TypeError("Object iterator must return a key-value pair");u[p=f[0]]=(d=u[p])?Se.isArray(d)?[...d,f[1]]:[d,f[1]]:f[1]}l(u,o)}else t!=null&&a(o,t,i);return this}get(t,o){if(t=sl(t),t){const i=Se.findKey(this,t);if(i){const s=this[i];if(!o)return s;if(o===!0)return j1(s);if(Se.isFunction(o))return o.call(this,s,i);if(Se.isRegExp(o))return o.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,o){if(t=sl(t),t){const i=Se.findKey(this,t);return!!(i&&this[i]!==void 0&&(!o||Ac(this,this[i],i,o)))}return!1}delete(t,o){const i=this;let s=!1;function a(l){if(l=sl(l),l){const u=Se.findKey(i,l);u&&(!o||Ac(i,i[u],u,o))&&(delete i[u],s=!0)}}return Se.isArray(t)?t.forEach(a):a(t),s}clear(t){const o=Object.keys(this);let i=o.length,s=!1;for(;i--;){const a=o[i];(!t||Ac(this,this[a],a,t,!0))&&(delete this[a],s=!0)}return s}normalize(t){const o=this,i={};return Se.forEach(this,(s,a)=>{const l=Se.findKey(i,a);if(l){o[l]=ur(s),delete o[a];return}const u=t?q1(a):String(a).trim();u!==a&&delete o[a],o[u]=ur(s),i[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const o=Object.create(null);return Se.forEach(this,(i,s)=>{i!=null&&i!==!1&&(o[s]=t&&Se.isArray(i)?i.join(", "):i)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,o])=>t+": "+o).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...o){const i=new this(t);return o.forEach(s=>i.set(s)),i}static accessor(t){const i=(this[Lh]=this[Lh]={accessors:{}}).accessors,s=this.prototype;function a(l){const u=sl(l);i[u]||(W1(s,l),i[u]=!0)}return Se.isArray(t)?t.forEach(a):a(t),this}};so.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Se.reduceDescriptors(so.prototype,({value:e},t)=>{let o=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[o]=i}}});Se.freezeMethods(so);function Ec(e,t){const o=this||Bl,i=t||o,s=so.from(i.headers);let a=i.data;return Se.forEach(e,function(u){a=u.call(o,a,s.normalize(),t?t.status:void 0)}),s.normalize(),a}function ov(e){return!!(e&&e.__CANCEL__)}function Ba(e,t,o){vt.call(this,e??"canceled",vt.ERR_CANCELED,t,o),this.name="CanceledError"}Se.inherits(Ba,vt,{__CANCEL__:!0});function sv(e,t,o){const i=o.config.validateStatus;!o.status||!i||i(o.status)?e(o):t(new vt("Request failed with status code "+o.status,[vt.ERR_BAD_REQUEST,vt.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}function K1(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Y1(e,t){e=e||10;const o=new Array(e),i=new Array(e);let s=0,a=0,l;return t=t!==void 0?t:1e3,function(d){const p=Date.now(),f=i[a];l||(l=p),o[s]=d,i[s]=p;let m=a,y=0;for(;m!==s;)y+=o[m++],m=m%e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),p-l<t)return;const _=f&&p-f;return _?Math.round(y*1e3/_):void 0}}function J1(e,t){let o=0,i=1e3/t,s,a;const l=(p,f=Date.now())=>{o=f,s=null,a&&(clearTimeout(a),a=null),e(...p)};return[(...p)=>{const f=Date.now(),m=f-o;m>=i?l(p,f):(s=p,a||(a=setTimeout(()=>{a=null,l(s)},i-m)))},()=>s&&l(s)]}const Sr=(e,t,o=3)=>{let i=0;const s=Y1(50,250);return J1(a=>{const l=a.loaded,u=a.lengthComputable?a.total:void 0,d=l-i,p=s(d),f=l<=u;i=l;const m={loaded:l,total:u,progress:u?l/u:void 0,bytes:d,rate:p||void 0,estimated:p&&u&&f?(u-l)/p:void 0,event:a,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(m)},o)},Sh=(e,t)=>{const o=e!=null;return[i=>t[0]({lengthComputable:o,total:e,loaded:i}),t[1]]},xh=e=>(...t)=>Se.asap(()=>e(...t)),X1=Rn.hasStandardBrowserEnv?((e,t)=>o=>(o=new URL(o,Rn.origin),e.protocol===o.protocol&&e.host===o.host&&(t||e.port===o.port)))(new URL(Rn.origin),Rn.navigator&&/(msie|trident)/i.test(Rn.navigator.userAgent)):()=>!0,Q1=Rn.hasStandardBrowserEnv?{write(e,t,o,i,s,a,l){if(typeof document>"u")return;const u=[`${e}=${encodeURIComponent(t)}`];Se.isNumber(o)&&u.push(`expires=${new Date(o).toUTCString()}`),Se.isString(i)&&u.push(`path=${i}`),Se.isString(s)&&u.push(`domain=${s}`),a===!0&&u.push("secure"),Se.isString(l)&&u.push(`SameSite=${l}`),document.cookie=u.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function e_(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function t_(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function iv(e,t,o){let i=!e_(t);return e&&(i||o==!1)?t_(e,t):t}const Ih=e=>e instanceof so?{...e}:e;function na(e,t){t=t||{};const o={};function i(p,f,m,y){return Se.isPlainObject(p)&&Se.isPlainObject(f)?Se.merge.call({caseless:y},p,f):Se.isPlainObject(f)?Se.merge({},f):Se.isArray(f)?f.slice():f}function s(p,f,m,y){if(Se.isUndefined(f)){if(!Se.isUndefined(p))return i(void 0,p,m,y)}else return i(p,f,m,y)}function a(p,f){if(!Se.isUndefined(f))return i(void 0,f)}function l(p,f){if(Se.isUndefined(f)){if(!Se.isUndefined(p))return i(void 0,p)}else return i(void 0,f)}function u(p,f,m){if(m in t)return i(p,f);if(m in e)return i(void 0,p)}const d={url:a,method:a,data:a,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:u,headers:(p,f,m)=>s(Ih(p),Ih(f),m,!0)};return Se.forEach(Object.keys({...e,...t}),function(f){const m=d[f]||s,y=m(e[f],t[f],f);Se.isUndefined(y)&&m!==u||(o[f]=y)}),o}const av=e=>{const t=na({},e);let{data:o,withXSRFToken:i,xsrfHeaderName:s,xsrfCookieName:a,headers:l,auth:u}=t;if(t.headers=l=so.from(l),t.url=ev(iv(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&l.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),Se.isFormData(o)){if(Rn.hasStandardBrowserEnv||Rn.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(Se.isFunction(o.getHeaders)){const d=o.getHeaders(),p=["content-type","content-length"];Object.entries(d).forEach(([f,m])=>{p.includes(f.toLowerCase())&&l.set(f,m)})}}if(Rn.hasStandardBrowserEnv&&(i&&Se.isFunction(i)&&(i=i(t)),i||i!==!1&&X1(t.url))){const d=s&&a&&Q1.read(a);d&&l.set(s,d)}return t},n_=typeof XMLHttpRequest<"u",o_=n_&&function(e){return new Promise(function(o,i){const s=av(e);let a=s.data;const l=so.from(s.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:p}=s,f,m,y,_,b;function S(){_&&_(),b&&b(),s.cancelToken&&s.cancelToken.unsubscribe(f),s.signal&&s.signal.removeEventListener("abort",f)}let T=new XMLHttpRequest;T.open(s.method.toUpperCase(),s.url,!0),T.timeout=s.timeout;function D(){if(!T)return;const C=so.from("getAllResponseHeaders"in T&&T.getAllResponseHeaders()),E={data:!u||u==="text"||u==="json"?T.responseText:T.response,status:T.status,statusText:T.statusText,headers:C,config:e,request:T};sv(function($){o($),S()},function($){i($),S()},E),T=null}"onloadend"in T?T.onloadend=D:T.onreadystatechange=function(){!T||T.readyState!==4||T.status===0&&!(T.responseURL&&T.responseURL.indexOf("file:")===0)||setTimeout(D)},T.onabort=function(){T&&(i(new vt("Request aborted",vt.ECONNABORTED,e,T)),T=null)},T.onerror=function(A){const E=A&&A.message?A.message:"Network Error",N=new vt(E,vt.ERR_NETWORK,e,T);N.event=A||null,i(N),T=null},T.ontimeout=function(){let A=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const E=s.transitional||tv;s.timeoutErrorMessage&&(A=s.timeoutErrorMessage),i(new vt(A,E.clarifyTimeoutError?vt.ETIMEDOUT:vt.ECONNABORTED,e,T)),T=null},a===void 0&&l.setContentType(null),"setRequestHeader"in T&&Se.forEach(l.toJSON(),function(A,E){T.setRequestHeader(E,A)}),Se.isUndefined(s.withCredentials)||(T.withCredentials=!!s.withCredentials),u&&u!=="json"&&(T.responseType=s.responseType),p&&([y,b]=Sr(p,!0),T.addEventListener("progress",y)),d&&T.upload&&([m,_]=Sr(d),T.upload.addEventListener("progress",m),T.upload.addEventListener("loadend",_)),(s.cancelToken||s.signal)&&(f=C=>{T&&(i(!C||C.type?new Ba(null,e,T):C),T.abort(),T=null)},s.cancelToken&&s.cancelToken.subscribe(f),s.signal&&(s.signal.aborted?f():s.signal.addEventListener("abort",f)));const I=K1(s.url);if(I&&Rn.protocols.indexOf(I)===-1){i(new vt("Unsupported protocol "+I+":",vt.ERR_BAD_REQUEST,e));return}T.send(a||null)})},s_=(e,t)=>{const{length:o}=e=e?e.filter(Boolean):[];if(t||o){let i=new AbortController,s;const a=function(p){if(!s){s=!0,u();const f=p instanceof Error?p:this.reason;i.abort(f instanceof vt?f:new Ba(f instanceof Error?f.message:f))}};let l=t&&setTimeout(()=>{l=null,a(new vt(`timeout ${t} of ms exceeded`,vt.ETIMEDOUT))},t);const u=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(p=>{p.unsubscribe?p.unsubscribe(a):p.removeEventListener("abort",a)}),e=null)};e.forEach(p=>p.addEventListener("abort",a));const{signal:d}=i;return d.unsubscribe=()=>Se.asap(u),d}},i_=function*(e,t){let o=e.byteLength;if(o<t){yield e;return}let i=0,s;for(;i<o;)s=i+t,yield e.slice(i,s),i=s},a_=async function*(e,t){for await(const o of l_(e))yield*i_(o,t)},l_=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:o,value:i}=await t.read();if(o)break;yield i}}finally{await t.cancel()}},$h=(e,t,o,i)=>{const s=a_(e,t);let a=0,l,u=d=>{l||(l=!0,i&&i(d))};return new ReadableStream({async pull(d){try{const{done:p,value:f}=await s.next();if(p){u(),d.close();return}let m=f.byteLength;if(o){let y=a+=m;o(y)}d.enqueue(new Uint8Array(f))}catch(p){throw u(p),p}},cancel(d){return u(d),s.return()}},{highWaterMark:2})},Th=64*1024,{isFunction:er}=Se,r_=(({Request:e,Response:t})=>({Request:e,Response:t}))(Se.global),{ReadableStream:Mh,TextEncoder:Ah}=Se.global,Eh=(e,...t)=>{try{return!!e(...t)}catch{return!1}},c_=e=>{e=Se.merge.call({skipUndefined:!0},r_,e);const{fetch:t,Request:o,Response:i}=e,s=t?er(t):typeof fetch=="function",a=er(o),l=er(i);if(!s)return!1;const u=s&&er(Mh),d=s&&(typeof Ah=="function"?(b=>S=>b.encode(S))(new Ah):async b=>new Uint8Array(await new o(b).arrayBuffer())),p=a&&u&&Eh(()=>{let b=!1;const S=new o(Rn.origin,{body:new Mh,method:"POST",get duplex(){return b=!0,"half"}}).headers.has("Content-Type");return b&&!S}),f=l&&u&&Eh(()=>Se.isReadableStream(new i("").body)),m={stream:f&&(b=>b.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(b=>{!m[b]&&(m[b]=(S,T)=>{let D=S&&S[b];if(D)return D.call(S);throw new vt(`Response type '${b}' is not supported`,vt.ERR_NOT_SUPPORT,T)})});const y=async b=>{if(b==null)return 0;if(Se.isBlob(b))return b.size;if(Se.isSpecCompliantForm(b))return(await new o(Rn.origin,{method:"POST",body:b}).arrayBuffer()).byteLength;if(Se.isArrayBufferView(b)||Se.isArrayBuffer(b))return b.byteLength;if(Se.isURLSearchParams(b)&&(b=b+""),Se.isString(b))return(await d(b)).byteLength},_=async(b,S)=>{const T=Se.toFiniteNumber(b.getContentLength());return T??y(S)};return async b=>{let{url:S,method:T,data:D,signal:I,cancelToken:C,timeout:A,onDownloadProgress:E,onUploadProgress:N,responseType:$,headers:G,withCredentials:R="same-origin",fetchOptions:Z}=av(b),U=t||fetch;$=$?($+"").toLowerCase():"text";let K=s_([I,C&&C.toAbortSignal()],A),re=null;const Pe=K&&K.unsubscribe&&(()=>{K.unsubscribe()});let me;try{if(N&&p&&T!=="get"&&T!=="head"&&(me=await _(G,D))!==0){let de=new o(S,{method:"POST",body:D,duplex:"half"}),Oe;if(Se.isFormData(D)&&(Oe=de.headers.get("content-type"))&&G.setContentType(Oe),de.body){const[Xe,et]=Sh(me,Sr(xh(N)));D=$h(de.body,Th,Xe,et)}}Se.isString(R)||(R=R?"include":"omit");const Ae=a&&"credentials"in o.prototype,Fe={...Z,signal:K,method:T.toUpperCase(),headers:G.normalize().toJSON(),body:D,duplex:"half",credentials:Ae?R:void 0};re=a&&new o(S,Fe);let ae=await(a?U(re,Z):U(S,Fe));const Me=f&&($==="stream"||$==="response");if(f&&(E||Me&&Pe)){const de={};["status","statusText","headers"].forEach(qe=>{de[qe]=ae[qe]});const Oe=Se.toFiniteNumber(ae.headers.get("content-length")),[Xe,et]=E&&Sh(Oe,Sr(xh(E),!0))||[];ae=new i($h(ae.body,Th,Xe,()=>{et&&et(),Pe&&Pe()}),de)}$=$||"text";let ge=await m[Se.findKey(m,$)||"text"](ae,b);return!Me&&Pe&&Pe(),await new Promise((de,Oe)=>{sv(de,Oe,{data:ge,headers:so.from(ae.headers),status:ae.status,statusText:ae.statusText,config:b,request:re})})}catch(Ae){throw Pe&&Pe(),Ae&&Ae.name==="TypeError"&&/Load failed|fetch/i.test(Ae.message)?Object.assign(new vt("Network Error",vt.ERR_NETWORK,b,re),{cause:Ae.cause||Ae}):vt.from(Ae,Ae&&Ae.code,b,re)}}},u_=new Map,lv=e=>{let t=e&&e.env||{};const{fetch:o,Request:i,Response:s}=t,a=[i,s,o];let l=a.length,u=l,d,p,f=u_;for(;u--;)d=a[u],p=f.get(d),p===void 0&&f.set(d,p=u?new Map:c_(t)),f=p;return p};lv();const Vu={http:I1,xhr:o_,fetch:{get:lv}};Se.forEach(Vu,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Ph=e=>`- ${e}`,d_=e=>Se.isFunction(e)||e===null||e===!1;function h_(e,t){e=Se.isArray(e)?e:[e];const{length:o}=e;let i,s;const a={};for(let l=0;l<o;l++){i=e[l];let u;if(s=i,!d_(i)&&(s=Vu[(u=String(i)).toLowerCase()],s===void 0))throw new vt(`Unknown adapter '${u}'`);if(s&&(Se.isFunction(s)||(s=s.get(t))))break;a[u||"#"+l]=s}if(!s){const l=Object.entries(a).map(([d,p])=>`adapter ${d} `+(p===!1?"is not supported by the environment":"is not available in the build"));let u=o?l.length>1?`since :
`+l.map(Ph).join(`
`):" "+Ph(l[0]):"as no adapter specified";throw new vt("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return s}const rv={getAdapter:h_,adapters:Vu};function Pc(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ba(null,e)}function Dh(e){return Pc(e),e.headers=so.from(e.headers),e.data=Ec.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),rv.getAdapter(e.adapter||Bl.adapter,e)(e).then(function(i){return Pc(e),i.data=Ec.call(e,e.transformResponse,i),i.headers=so.from(i.headers),i},function(i){return ov(i)||(Pc(e),i&&i.response&&(i.response.data=Ec.call(e,e.transformResponse,i.response),i.response.headers=so.from(i.response.headers))),Promise.reject(i)})}const cv="1.13.2",tc={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{tc[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});const Rh={};tc.transitional=function(t,o,i){function s(a,l){return"[Axios v"+cv+"] Transitional option '"+a+"'"+l+(i?". "+i:"")}return(a,l,u)=>{if(t===!1)throw new vt(s(l," has been removed"+(o?" in "+o:"")),vt.ERR_DEPRECATED);return o&&!Rh[l]&&(Rh[l]=!0,console.warn(s(l," has been deprecated since v"+o+" and will be removed in the near future"))),t?t(a,l,u):!0}};tc.spelling=function(t){return(o,i)=>(console.warn(`${i} is likely a misspelling of ${t}`),!0)};function f_(e,t,o){if(typeof e!="object")throw new vt("options must be an object",vt.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let s=i.length;for(;s-- >0;){const a=i[s],l=t[a];if(l){const u=e[a],d=u===void 0||l(u,a,e);if(d!==!0)throw new vt("option "+a+" must be "+d,vt.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new vt("Unknown option "+a,vt.ERR_BAD_OPTION)}}const dr={assertOptions:f_,validators:tc},ls=dr.validators;let Qi=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Ch,response:new Ch}}async request(t,o){try{return await this._request(t,o)}catch(i){if(i instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{i.stack?a&&!String(i.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+a):i.stack=a}catch{}}throw i}}_request(t,o){typeof t=="string"?(o=o||{},o.url=t):o=t||{},o=na(this.defaults,o);const{transitional:i,paramsSerializer:s,headers:a}=o;i!==void 0&&dr.assertOptions(i,{silentJSONParsing:ls.transitional(ls.boolean),forcedJSONParsing:ls.transitional(ls.boolean),clarifyTimeoutError:ls.transitional(ls.boolean)},!1),s!=null&&(Se.isFunction(s)?o.paramsSerializer={serialize:s}:dr.assertOptions(s,{encode:ls.function,serialize:ls.function},!0)),o.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?o.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:o.allowAbsoluteUrls=!0),dr.assertOptions(o,{baseUrl:ls.spelling("baseURL"),withXsrfToken:ls.spelling("withXSRFToken")},!0),o.method=(o.method||this.defaults.method||"get").toLowerCase();let l=a&&Se.merge(a.common,a[o.method]);a&&Se.forEach(["delete","get","head","post","put","patch","common"],b=>{delete a[b]}),o.headers=so.concat(l,a);const u=[];let d=!0;this.interceptors.request.forEach(function(S){typeof S.runWhen=="function"&&S.runWhen(o)===!1||(d=d&&S.synchronous,u.unshift(S.fulfilled,S.rejected))});const p=[];this.interceptors.response.forEach(function(S){p.push(S.fulfilled,S.rejected)});let f,m=0,y;if(!d){const b=[Dh.bind(this),void 0];for(b.unshift(...u),b.push(...p),y=b.length,f=Promise.resolve(o);m<y;)f=f.then(b[m++],b[m++]);return f}y=u.length;let _=o;for(;m<y;){const b=u[m++],S=u[m++];try{_=b(_)}catch(T){S.call(this,T);break}}try{f=Dh.call(this,_)}catch(b){return Promise.reject(b)}for(m=0,y=p.length;m<y;)f=f.then(p[m++],p[m++]);return f}getUri(t){t=na(this.defaults,t);const o=iv(t.baseURL,t.url,t.allowAbsoluteUrls);return ev(o,t.params,t.paramsSerializer)}};Se.forEach(["delete","get","head","options"],function(t){Qi.prototype[t]=function(o,i){return this.request(na(i||{},{method:t,url:o,data:(i||{}).data}))}});Se.forEach(["post","put","patch"],function(t){function o(i){return function(a,l,u){return this.request(na(u||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}Qi.prototype[t]=o(),Qi.prototype[t+"Form"]=o(!0)});let p_=class uv{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(a){o=a});const i=this;this.promise.then(s=>{if(!i._listeners)return;let a=i._listeners.length;for(;a-- >0;)i._listeners[a](s);i._listeners=null}),this.promise.then=s=>{let a;const l=new Promise(u=>{i.subscribe(u),a=u}).then(s);return l.cancel=function(){i.unsubscribe(a)},l},t(function(a,l,u){i.reason||(i.reason=new Ba(a,l,u),o(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const o=this._listeners.indexOf(t);o!==-1&&this._listeners.splice(o,1)}toAbortSignal(){const t=new AbortController,o=i=>{t.abort(i)};return this.subscribe(o),t.signal.unsubscribe=()=>this.unsubscribe(o),t.signal}static source(){let t;return{token:new uv(function(s){t=s}),cancel:t}}};function v_(e){return function(o){return e.apply(null,o)}}function m_(e){return Se.isObject(e)&&e.isAxiosError===!0}const iu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(iu).forEach(([e,t])=>{iu[t]=e});function dv(e){const t=new Qi(e),o=Hp(Qi.prototype.request,t);return Se.extend(o,Qi.prototype,t,{allOwnKeys:!0}),Se.extend(o,t,null,{allOwnKeys:!0}),o.create=function(s){return dv(na(e,s))},o}const an=dv(Bl);an.Axios=Qi;an.CanceledError=Ba;an.CancelToken=p_;an.isCancel=ov;an.VERSION=cv;an.toFormData=ec;an.AxiosError=vt;an.Cancel=an.CanceledError;an.all=function(t){return Promise.all(t)};an.spread=v_;an.isAxiosError=m_;an.mergeConfig=na;an.AxiosHeaders=so;an.formToJSON=e=>nv(Se.isHTMLForm(e)?new FormData(e):e);an.getAdapter=rv.getAdapter;an.HttpStatusCode=iu;an.default=an;const{Axios:UU,AxiosError:zU,CanceledError:HU,isCancel:VU,CancelToken:GU,VERSION:jU,all:ZU,Cancel:qU,isAxiosError:WU,spread:KU,toFormData:YU,AxiosHeaders:JU,HttpStatusCode:XU,formToJSON:QU,getAdapter:ez,mergeConfig:tz}=an,au="https://sterobson-volunteercheckin-testing.azurewebsites.net/api",g_="VolunteerCheckinOffline",y_=1;let Wo=null;async function qs(){return Wo||new Promise((e,t)=>{const o=indexedDB.open(g_,y_);o.onerror=()=>{console.error("Failed to open IndexedDB:",o.error),t(o.error)},o.onsuccess=()=>{Wo=o.result,e(Wo)},o.onupgradeneeded=i=>{const s=i.target.result;s.objectStoreNames.contains("eventData")||s.createObjectStore("eventData",{keyPath:"eventId"}),s.objectStoreNames.contains("pendingActions")||s.createObjectStore("pendingActions",{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),s.objectStoreNames.contains("syncMeta")||s.createObjectStore("syncMeta",{keyPath:"key"})}})}async function $l(e,t){return await qs(),new Promise((o,i)=>{const s=Wo.transaction(["eventData","syncMeta"],"readwrite"),a=s.objectStore("eventData"),l=s.objectStore("syncMeta"),u={eventId:e,...t,cachedAt:new Date().toISOString()};a.put(u),l.put({key:`lastSync_${e}`,value:new Date().toISOString()}),s.oncomplete=()=>o(),s.onerror=()=>i(s.error)})}async function ki(e){return await qs(),new Promise((t,o)=>{const a=Wo.transaction(["eventData"],"readonly").objectStore("eventData").get(e);a.onsuccess=()=>t(a.result||null),a.onerror=()=>o(a.error)})}async function hr(e,t,o){const i=await ki(e);i&&(i[t]=o,i.cachedAt=new Date().toISOString(),await $l(e,i))}async function k_(e){return await qs(),new Promise((t,o)=>{const s=Wo.transaction(["pendingActions"],"readwrite").objectStore("pendingActions"),a={...e,createdAt:new Date().toISOString(),attempts:0,lastAttempt:null,status:"pending"},l=s.add(a);l.onsuccess=()=>t(l.result),l.onerror=()=>o(l.error)})}async function hv(){return await qs(),new Promise((e,t)=>{const a=Wo.transaction(["pendingActions"],"readonly").objectStore("pendingActions").index("createdAt").getAll();a.onsuccess=()=>{const l=a.result.filter(u=>u.status==="pending"||u.status==="retrying");e(l)},a.onerror=()=>t(a.error)})}async function xr(){return(await hv()).length}async function Oh(e,t){return await qs(),new Promise((o,i)=>{const s=Wo.transaction(["pendingActions"],"readwrite"),a=s.objectStore("pendingActions"),l=a.get(e);l.onsuccess=()=>{const u=l.result;u&&(Object.assign(u,t),a.put(u))},s.oncomplete=()=>o(),s.onerror=()=>i(s.error)})}async function Bh(e){return await qs(),new Promise((t,o)=>{const a=Wo.transaction(["pendingActions"],"readwrite").objectStore("pendingActions").delete(e);a.onsuccess=()=>t(),a.onerror=()=>o(a.error)})}async function __(e){return await qs(),new Promise((t,o)=>{const a=Wo.transaction(["syncMeta"],"readonly").objectStore("syncMeta").get(`lastSync_${e}`);a.onsuccess=()=>t(a.result?.value||null),a.onerror=()=>o(a.error)})}const Ge=an.create({baseURL:au,headers:{"Content-Type":"application/json"},timeout:15e3});let lu=!1;async function b_(){}function Nh(e){const t=[/\/events\/([^/]+)/,/\/assignments\/([^/]+)/,/\/locations\/([^/]+)/,/\/checklist-items\/([^/]+)/,/\/areas\/([^/]+)/,/\/marshals\/([^/]+)/];for(const o of t){const i=e.match(o);if(i)return i[1]}return null}function w_(e){return!!(!e.response&&e.request||e.response&&e.response.status>=500||e.code==="ECONNABORTED")}Ge.interceptors.request.use(e=>{const t=localStorage.getItem("adminEmail");t&&(e.headers["X-Admin-Email"]=t);const o=localStorage.getItem("sessionToken");return o&&(e.headers.Authorization=`Bearer ${o}`),e});let ru=0;const C_=2;function L_(){if(ru++,ru>=C_){localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken");const e=window.location.hash||"";!e.includes("login")&&!e.includes("/verify")&&(window.location.href="/VolunteerCheckin/testing/#/?login=true")}}function S_(){ru=0}Ge.interceptors.response.use(e=>{lu=!1,S_();const t=e.config.url,o=Nh(t);return e.config.method,e},async e=>{const t=e.config;if(e.response&&(e.response.status===401||e.response.status===403))return L_(),Promise.reject(e);if(w_(e)&&(lu=!0,t.method==="get")){const o=Nh(t.url);if(o){const i=await ki(o);if(i)return console.log("Returning cached data for:",t.url),Promise.resolve({data:i,status:200,statusText:"OK (cached)",headers:{},config:t,cached:!0})}}return Promise.reject(e)});async function po(e,t,o){return await k_({type:e,payload:t,eventId:t.eventId}),await b_(),{data:o,status:200,statusText:"OK (queued)",queued:!0}}function Mn(){return lu||!navigator.onLine}const x_={check:()=>Ge.head("/health")},cu=()=>"https://sterobson.github.io/VolunteerCheckin/testing".replace(/\/?#?\/?$/,""),ds={requestLogin:e=>Ge.post("/auth/request-login",{email:e,frontendUrl:cu()}),verifyToken:e=>Ge.post("/auth/verify-token",{token:e}),instantLogin:e=>Ge.post("/auth/instant-login",{email:e}),createAdmin:e=>Ge.post("/auth/create-admin",{email:e}),marshalLogin:(e,t)=>Ge.post("/auth/marshal-login",{eventId:e,magicCode:t}),getMe:e=>Ge.get("/auth/me",{params:{eventId:e}}),logout:()=>Ge.post("/auth/logout")},tr={getProfile:()=>Ge.get("/auth/profile"),updateProfile:e=>Ge.put("/auth/profile",e),getPerson:(e,t)=>Ge.get(`/people/${e}`,{params:{eventId:t}}),updatePerson:(e,t,o)=>Ge.put(`/people/${e}`,o,{params:{eventId:t}})},ji={create:e=>Ge.post("/events",e),getAll:()=>Ge.get("/events"),getById:e=>Ge.get(`/events/${e}`),update:(e,t)=>Ge.put(`/events/${e}`,t),delete:e=>Ge.delete(`/events/${e}`),uploadGpx:(e,t)=>{const o=new FormData;return o.append("gpx",t),Ge.post(`/events/${e}/upload-gpx`,o,{headers:{"Content-Type":"multipart/form-data"}})}},no={create:e=>Ge.post("/locations",e),getById:(e,t)=>Ge.get(`/locations/${e}/${t}`),getByEvent:e=>Ge.get(`/events/${e}/locations`),update:(e,t,o)=>Ge.put(`/locations/${e}/${t}`,o),delete:(e,t)=>Ge.delete(`/locations/${e}/${t}`),importCsv:(e,t,o)=>{const i=new FormData;return i.append("csv",t),Ge.post(`/locations/import/${e}?deleteExisting=${o}`,i,{headers:{"Content-Type":"multipart/form-data"}})},bulkUpdateTimes:(e,t)=>Ge.post(`/locations/bulk-update-times/${e}`,{timeDelta:t}),updatePosition:(e,t,o)=>Ge.post(`/locations/${e}/${t}/update-position`,o),getDynamicCheckpoints:e=>Ge.get(`/events/${e}/dynamic-checkpoints`)},al={create:e=>Ge.post("/assignments",e),getById:(e,t)=>Ge.get(`/assignments/${e}/${t}`),getByEvent:e=>Ge.get(`/assignments/event/${e}`),delete:(e,t)=>Ge.delete(`/assignments/${e}/${t}`),getEventStatus:e=>Ge.get(`/events/${e}/status`)},Ns={checkIn:e=>Ge.post("/checkin",e),toggleCheckIn:(e,t,{latitude:o,longitude:i,action:s}={})=>Ge.post(`/checkin/${e}/${t}/toggle`,{latitude:o??null,longitude:i??null,action:s??null}),adminCheckIn:(e,t)=>Ge.post(`/checkin/admin/${e}/${t}`)},Dc={getAdmins:e=>Ge.get(`/events/${e}/admins`),addAdmin:(e,t)=>Ge.post(`/events/${e}/admins`,{userEmail:t}),removeAdmin:(e,t)=>Ge.delete(`/events/${e}/admins/${t}`)},hs={create:e=>Ge.post("/marshals",e),getByEvent:e=>Ge.get(`/events/${e}/marshals`),getById:(e,t)=>Ge.get(`/marshals/${e}/${t}`),update:(e,t,o)=>Ge.put(`/marshals/${e}/${t}`,o),delete:(e,t)=>Ge.delete(`/marshals/${e}/${t}`),getMagicLink:(e,t)=>Ge.get(`/marshals/${e}/${t}/magic-link`,{params:{frontendUrl:cu()}}),sendMagicLink:(e,t)=>Ge.post(`/marshals/${e}/${t}/send-magic-link`,{frontendUrl:cu()}),importCsv:(e,t)=>{const o=new FormData;return o.append("csv",t),Ge.post(`/marshals/import/${e}`,o,{headers:{"Content-Type":"multipart/form-data"}})}},mi={create:e=>Ge.post("/areas",e),getByEvent:e=>Ge.get(`/events/${e}/areas`),getById:(e,t)=>Ge.get(`/areas/${e}/${t}`),update:(e,t,o)=>Ge.put(`/areas/${e}/${t}`,o),delete:(e,t)=>Ge.delete(`/areas/${e}/${t}`),recalculate:e=>Ge.post(`/areas/recalculate/${e}`),getCheckpoints:(e,t)=>Ge.get(`/areas/${e}/${t}/locations`),getAreaLeadDashboard:e=>Ge.get(`/events/${e}/area-lead-dashboard`)},Rt={create:(e,t)=>Ge.post(`/events/${e}/checklist-items`,t),getByEvent:e=>Ge.get(`/events/${e}/checklist-items`),getById:(e,t)=>Ge.get(`/checklist-items/${e}/${t}`),update:(e,t,o)=>Ge.put(`/checklist-items/${e}/${t}`,o),delete:(e,t)=>Ge.delete(`/checklist-items/${e}/${t}`),getReport:e=>Ge.get(`/events/${e}/checklist-report`),getMarshalChecklist:(e,t)=>Ge.get(`/events/${e}/marshals/${t}/checklist`),getCheckpointChecklist:(e,t)=>Ge.get(`/events/${e}/locations/${t}/checklist`),getAreaChecklist:(e,t)=>Ge.get(`/events/${e}/areas/${t}/checklist`),complete:(e,t,o)=>Ge.post(`/checklist-items/${e}/${t}/complete`,o),uncomplete:(e,t,o)=>Ge.post(`/checklist-items/${e}/${t}/uncomplete`,o)},Ps={create:(e,t)=>Ge.post(`/events/${e}/notes`,t),getByEvent:e=>Ge.get(`/events/${e}/notes`),getById:(e,t)=>Ge.get(`/events/${e}/notes/${t}`),update:(e,t,o)=>Ge.put(`/events/${e}/notes/${t}`,o),delete:(e,t)=>Ge.delete(`/events/${e}/notes/${t}`),getMarshalNotes:(e,t)=>Ge.get(`/events/${e}/marshals/${t}/notes`),getMyNotes:e=>Ge.get(`/events/${e}/my-notes`)},di={create:(e,t)=>Ge.post(`/events/${e}/contacts`,t),getByEvent:e=>Ge.get(`/events/${e}/contacts`),getById:(e,t)=>Ge.get(`/events/${e}/contacts/${t}`),update:(e,t,o)=>Ge.put(`/events/${e}/contacts/${t}`,o),delete:(e,t)=>Ge.delete(`/events/${e}/contacts/${t}`),getRoles:e=>Ge.get(`/events/${e}/contact-roles`),getMarshalContacts:(e,t)=>Ge.get(`/events/${e}/marshals/${t}/contacts`),getMyContacts:e=>Ge.get(`/events/${e}/my-contacts`)},us={create:(e,t)=>Ge.post(`/events/${e}/incidents`,t),getAll:(e,t={})=>Ge.get(`/events/${e}/incidents`,{params:t}),getForArea:(e,t)=>Ge.get(`/events/${e}/areas/${t}/incidents`),get:(e,t)=>Ge.get(`/events/${e}/incidents/${t}`),updateStatus:(e,t,o)=>Ge.patch(`/events/${e}/incidents/${t}`,o),addNote:(e,t,o)=>Ge.post(`/events/${e}/incidents/${t}/notes`,{note:o})},Na=Bu("auth",()=>{const e=M(localStorage.getItem("adminEmail")||null),t=M(!!e.value),o=M(!1);return{adminEmail:e,isAuthenticated:t,loginPending:o,requestLogin:async u=>{const d=await ds.requestLogin(u);return d.data.success&&(o.value=!0),d.data},verifyToken:async u=>{const d=await ds.verifyToken(u);return d.data.success&&(e.value=d.data.person?.email,t.value=!0,o.value=!1,localStorage.setItem("adminEmail",d.data.person?.email),localStorage.setItem("sessionToken",d.data.sessionToken)),d.data},instantLogin:async u=>{const d=await ds.instantLogin(u);return d.data.success&&(e.value=d.data.email,t.value=!0,localStorage.setItem("adminEmail",d.data.email),d.data.sessionToken&&localStorage.setItem("sessionToken",d.data.sessionToken)),d.data},logout:async()=>{try{await ds.logout()}catch{}e.value=null,t.value=!1,o.value=!1,localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken")}}}),I_={class:"home"},$_={class:"hero-section"},T_={class:"hero-content"},M_={class:"content-section"},A_={class:"container"},E_={class:"carousel"},P_={class:"carousel-indicators"},D_=["onClick"],R_={class:"modal-card"},O_={key:0,class:"email-sent"},B_={key:1},N_={class:"form-group"},F_=["disabled"],U_={key:0,class:"error"},z_={__name:"Home",setup(e){const t=Yr(),o=Ra(),i=Na(),s=M(0);let a=null;function l(D){s.value=D,d()}function u(){s.value=(s.value+1)%2}function d(){a&&clearInterval(a),a=setInterval(u,1e4)}const p=M(!1),f=M(""),m=M(!1),y=M(null),_=M(!1);async function b(){m.value=!0,y.value=null;try{const D=await i.requestLogin(f.value);D.success?_.value=!0:y.value=D.message||"Failed to send login link. Please try again."}catch{y.value="Failed to send login link. Please try again."}finally{m.value=!1}}function S(){f.value="",_.value=!1,y.value=null}function T(){p.value=!1,t.query.login&&o.replace({query:{}})}return Qt(()=>{d(),t.query.login&&(p.value=!0)}),On(()=>{a&&clearInterval(a)}),(D,I)=>(v(),g("div",I_,[r("section",$_,[r("div",T_,[Ee(zk),I[2]||(I[2]=r("div",{class:"hero-overlay"},[r("h1",null,"OnTheDay")],-1))]),I[3]||(I[3]=r("p",{class:"subtitle"},"Manage your event's marshals and volunteers with ease",-1)),r("button",{class:"btn btn-primary",onClick:I[0]||(I[0]=C=>p.value=!0)}," Join us or login ")]),r("section",M_,[r("div",A_,[I[5]||(I[5]=br('<div class="features-grid" data-v-f75bc50b><div class="feature-card" data-v-f75bc50b><h3 data-v-f75bc50b>For admins</h3><ul data-v-f75bc50b><li data-v-f75bc50b>Create and manage events</li><li data-v-f75bc50b>Define marshal locations</li><li data-v-f75bc50b>Real-time check-in monitoring</li><li data-v-f75bc50b>Map view of everything in your event</li><li data-v-f75bc50b>Manage incidents</li></ul></div><div class="feature-card" data-v-f75bc50b><h3 data-v-f75bc50b>For marshals</h3><ul data-v-f75bc50b><li data-v-f75bc50b>View the entire route</li><li data-v-f75bc50b>View your assigned location</li><li data-v-f75bc50b>Check in with GPS verification</li><li data-v-f75bc50b>Access emergency contact info</li><li data-v-f75bc50b>Record incidents</li></ul></div></div>',1)),r("div",E_,[r("div",{class:"carousel-track",style:ut({transform:`translateX(-${s.value*100}%)`})},[...I[4]||(I[4]=[br('<div class="feature-card" data-v-f75bc50b><h3 data-v-f75bc50b>For admins</h3><ul data-v-f75bc50b><li data-v-f75bc50b>Create and manage events</li><li data-v-f75bc50b>Define marshal locations</li><li data-v-f75bc50b>Real-time check-in monitoring</li><li data-v-f75bc50b>Map view of everything in your event</li><li data-v-f75bc50b>Manage incidents</li></ul></div><div class="feature-card" data-v-f75bc50b><h3 data-v-f75bc50b>For marshals</h3><ul data-v-f75bc50b><li data-v-f75bc50b>View the entire route</li><li data-v-f75bc50b>View your assigned location</li><li data-v-f75bc50b>Check in with GPS verification</li><li data-v-f75bc50b>Access emergency contact info</li><li data-v-f75bc50b>Record incidents</li></ul></div>',2)])],4),r("div",P_,[(v(),g(xe,null,Be(2,(C,A)=>r("button",{key:A,class:ue(["indicator",{active:s.value===A}]),onClick:E=>l(A)},null,10,D_)),64))])])])]),(v(),je(Mu,{to:"body"},[Ee(Xi,{name:"modal"},{default:Ue(()=>[p.value?(v(),g("div",{key:0,class:"modal-overlay",onClick:dt(T,["self"])},[r("div",R_,[r("button",{class:"modal-close",onClick:T},""),_.value?(v(),g("div",O_,[I[7]||(I[7]=r("div",{class:"check-icon"},"",-1)),I[8]||(I[8]=r("h3",null,"Check your email!",-1)),r("p",null,[I[6]||(I[6]=Ke("We've sent a login link to ",-1)),r("strong",null,w(f.value),1)]),I[9]||(I[9]=r("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),r("button",{onClick:S,class:"btn btn-secondary"}," Use a different email ")])):(v(),g("div",B_,[I[10]||(I[10]=r("h2",null,"Join us or login",-1)),I[11]||(I[11]=r("p",{class:"instruction"},"Enter your email to receive a login link",-1)),r("form",{onSubmit:dt(b,["prevent"])},[r("div",N_,[Ve(r("input",{"onUpdate:modelValue":I[1]||(I[1]=C=>f.value=C),type:"email",placeholder:"you@example.com",required:"",class:"form-input"},null,512),[[nt,f.value]])]),r("button",{type:"submit",class:"btn btn-primary btn-full",disabled:m.value},w(m.value?"Sending...":"Send login link"),9,F_)],32),y.value?(v(),g("div",U_,w(y.value),1)):P("",!0)]))])])):P("",!0)]),_:1})]))]))}},H_=ze(z_,[["__scopeId","data-v-f75bc50b"]]),V_={class:"admin-login"},G_={class:"login-card"},j_={key:0,class:"email-sent"},Z_={class:"form-group"},q_=["disabled"],W_={key:0,class:"error"},K_={__name:"AdminLogin",setup(e){const t=Na(),o=M(""),i=M(!1),s=M(null),a=M(!1),l=async()=>{i.value=!0,s.value=null;try{const d=await t.requestLogin(o.value);d.success?a.value=!0:s.value=d.message||"Failed to send login link. Please try again."}catch{s.value="Failed to send login link. Please try again."}finally{i.value=!1}},u=()=>{o.value="",a.value=!1,s.value=null};return(d,p)=>{const f=Au("router-link");return v(),g("div",V_,[r("div",G_,[p[7]||(p[7]=r("h2",null,"Admin login",-1)),a.value?(v(),g("div",j_,[p[2]||(p[2]=r("div",{class:"check-icon"},"",-1)),p[3]||(p[3]=r("h3",null,"Check your email!",-1)),r("p",null,[p[1]||(p[1]=Ke("We've sent a login link to ",-1)),r("strong",null,w(o.value),1)]),p[4]||(p[4]=r("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),r("button",{onClick:u,class:"btn btn-secondary"}," Use a different email ")])):(v(),g(xe,{key:1},[p[5]||(p[5]=r("p",{class:"instruction"},"Enter your email to receive a login link",-1)),r("form",{onSubmit:dt(l,["prevent"])},[r("div",Z_,[Ve(r("input",{"onUpdate:modelValue":p[0]||(p[0]=m=>o.value=m),type:"email",placeholder:"admin@example.com",required:"",class:"form-input"},null,512),[[nt,o.value]])]),r("button",{type:"submit",class:"btn btn-primary",disabled:i.value},w(i.value?"Sending...":"Send login link"),9,q_)],32),s.value?(v(),g("div",W_,w(s.value),1)):P("",!0)],64)),Ee(f,{to:"/",class:"back-link"},{default:Ue(()=>[...p[6]||(p[6]=[Ke(" Back to Home",-1)])]),_:1})])])}}},Y_=ze(K_,[["__scopeId","data-v-5d0a88c2"]]),J_={class:"admin-verify"},X_={class:"verify-card"},Q_={key:0,class:"status"},eb={key:1,class:"status error"},tb={key:2,class:"status success"},nb={__name:"AdminVerify",setup(e){const t=Ra(),o=Yr(),i=Na(),s=M(!0),a=M(null);return Qt(async()=>{const l=o.query.token;if(!l){a.value="No login token provided. Please request a new login link.",s.value=!1;return}try{const u=await i.verifyToken(l);u.success?setTimeout(()=>{t.push({name:"AdminDashboard"})},1e3):a.value=u.message||"Invalid or expired login link. Please request a new one."}catch(u){console.error("Verification error:",u),a.value="Failed to verify login. Please try again."}finally{s.value=!1}}),(l,u)=>{const d=Au("router-link");return v(),g("div",J_,[r("div",X_,[s.value?(v(),g("div",Q_,[...u[0]||(u[0]=[r("div",{class:"spinner"},null,-1),r("h2",null,"Verifying your login...",-1),r("p",null,"Please wait while we confirm your identity.",-1)])])):a.value?(v(),g("div",eb,[u[2]||(u[2]=r("h2",null,"Login failed",-1)),r("p",null,w(a.value),1),Ee(d,{to:{name:"Home",query:{login:"true"}},class:"btn btn-primary"},{default:Ue(()=>[...u[1]||(u[1]=[Ke(" Try again ",-1)])]),_:1})])):(v(),g("div",tb,[...u[3]||(u[3]=[r("h2",null,"Login successful!",-1),r("p",null,"Redirecting to dashboard...",-1)])]))])])}}},ob=ze(nb,[["__scopeId","data-v-76177495"]]),fv=Bu("events",()=>{const e=M([]),t=M(null),o=M([]),i=M([]),s=M(null),a=M(!1),l=M(null),u=async()=>{a.value=!0,l.value=null;try{const N=await ji.getAll();e.value=N.data}catch(N){throw l.value=N.message,N}finally{a.value=!1}},d=async N=>{a.value=!0,l.value=null;try{const $=await ji.getById(N);t.value=$.data}catch($){throw l.value=$.message,$}finally{a.value=!1}},p=async N=>{a.value=!0,l.value=null;try{const $=await ji.create(N);return e.value.push($.data),$.data}catch($){throw l.value=$.message,$}finally{a.value=!1}},f=async(N,$)=>{a.value=!0,l.value=null;try{const G=await ji.update(N,$),R=e.value.findIndex(Z=>Z.id===N);return R!==-1&&(e.value[R]=G.data),t.value?.id===N&&(t.value=G.data),G.data}catch(G){throw l.value=G.message,G}finally{a.value=!1}},m=async N=>{a.value=!0,l.value=null;try{await ji.delete(N),e.value=e.value.filter($=>$.id!==N)}catch($){throw l.value=$.message,$}finally{a.value=!1}},y=async N=>{a.value=!0,l.value=null;try{const $=await no.getByEvent(N);o.value=$.data}catch($){throw l.value=$.message,$}finally{a.value=!1}};return{events:e,currentEvent:t,locations:o,assignments:i,eventStatus:s,loading:a,error:l,fetchEvents:u,fetchEvent:d,createEvent:p,updateEvent:f,deleteEvent:m,fetchLocations:y,createLocation:async N=>{a.value=!0,l.value=null;try{const $=await no.create(N);return o.value.push($.data),$.data}catch($){throw l.value=$.message,$}finally{a.value=!1}},updateLocation:async(N,$,G)=>{a.value=!0,l.value=null;try{const R=await no.update(N,$,G),Z=o.value.findIndex(U=>U.id===$);return Z!==-1&&(o.value[Z]=R.data),R.data}catch(R){throw l.value=R.message,R}finally{a.value=!1}},deleteLocation:async(N,$)=>{a.value=!0,l.value=null;try{await no.delete(N,$),o.value=o.value.filter(G=>G.id!==$)}catch(G){throw l.value=G.message,G}finally{a.value=!1}},bulkUpdateLocationTimes:async(N,$)=>{a.value=!0,l.value=null;try{const G=await no.bulkUpdateTimes(N,$);return await y(N),G.data}catch(G){throw l.value=G.message,G}finally{a.value=!1}},fetchAssignments:async N=>{a.value=!0,l.value=null;try{const $=await al.getByEvent(N);i.value=$.data}catch($){throw l.value=$.message,$}finally{a.value=!1}},createAssignment:async N=>{a.value=!0,l.value=null;try{const $=await al.create(N);return i.value.push($.data),$.data}catch($){throw l.value=$.message,$}finally{a.value=!1}},deleteAssignment:async(N,$)=>{a.value=!0,l.value=null;try{await al.delete(N,$),i.value=i.value.filter(G=>G.id!==$)}catch(G){throw l.value=G.message,G}finally{a.value=!1}},fetchEventStatus:async N=>{a.value=!0,l.value=null;try{const $=await al.getEventStatus(N);return s.value=$.data,$.data}catch($){throw l.value=$.message,$}finally{a.value=!1}},updateAssignmentCheckIn:N=>{const $=i.value.findIndex(G=>G.id===N.id);$!==-1&&(i.value[$]=N),s.value&&s.value.locations.forEach(G=>{const R=G.assignments.findIndex(Z=>Z.id===N.id);R!==-1&&(G.assignments[R]=N,G.checkedInCount=G.assignments.filter(Z=>Z.isCheckedIn).length)})}}}),sb={class:"confirm-modal"},ib={class:"confirm-actions"},ab={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},showCancel:{type:Boolean,default:!0},isDanger:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(e,{emit:t}){const o=t,i=()=>{o("confirm")},s=()=>{o("cancel")};return(a,l)=>e.show?(v(),g("div",{key:0,class:"modal-overlay",onClick:dt(s,["self"])},[r("div",sb,[r("h3",null,w(e.title),1),r("p",null,w(e.message),1),r("div",ib,[e.showCancel?(v(),g("button",{key:0,onClick:s,class:"btn btn-secondary"},w(e.cancelText),1)):P("",!0),r("button",{onClick:i,class:ue(["btn",e.isDanger?"btn-danger":"btn-primary"])},w(e.confirmText),3)])])])):P("",!0)}},Pa=ze(ab,[["__scopeId","data-v-bead7a29"]]),lb={class:"base-modal-header"},rb={class:"base-modal-header-content"},cb={key:0,class:"base-modal-title"},ub={key:0,class:"base-modal-tab-header"},db={key:1,class:"base-modal-footer"},hb={key:0,class:"base-modal-actions"},fb={__name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},variant:{type:String,default:"center",validator:e=>["center","sidebar"].includes(e)},zIndex:{type:Number,default:1e3},closeOnOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},confirmOnClose:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=()=>{const C=document.documentElement,A=getComputedStyle(C).getPropertyValue("--modal-resize-duration").trim();return A.endsWith("s")?parseFloat(A)*1e3:300},i=e,s=t,a=M(!1),l=M(!1),u=M(null),d=M(null);let p=null,f=!1,m=0;const y=()=>{if(!d.value||!u.value||f)return;const C=d.value.scrollHeight,A=m;if(A===C||m===0){m=C;return}f=!0,d.value.style.height=`${A}px`,d.value.style.overflow="hidden",d.value.offsetHeight,d.value.style.transition="height var(--modal-resize-duration, 0.3s) ease",d.value.style.height=`${C}px`;const E=o();setTimeout(()=>{d.value&&(d.value.style.height="",d.value.style.overflow="",d.value.style.transition=""),f=!1,m=C},E)},_=()=>{!u.value||typeof MutationObserver>"u"||(d.value&&(m=d.value.scrollHeight),p=new MutationObserver(()=>{qn(()=>{y()})}),p.observe(u.value,{childList:!0,subtree:!0,attributes:!0,characterData:!0}))},b=()=>{p&&(p.disconnect(),p=null)};Qt(()=>{qn(()=>{i.show&&_()})}),On(()=>{b()}),Ze(()=>i.show,C=>{C?qn(()=>{m=0,_()}):b()});const S=()=>{i.closeOnOverlay&&T()},T=()=>{i.confirmOnClose&&i.isDirty?a.value=!0:s("close")},D=()=>{a.value=!1,s("close")},I=()=>{a.value=!1};return(C,A)=>(v(),je(Xi,{name:"modal",appear:""},{default:Ue(()=>[e.show?(v(),g("div",{key:0,class:"base-modal-overlay",style:ut({zIndex:e.zIndex}),onClick:dt(S,["self"])},[r("div",{class:ue(["base-modal",[`base-modal--${e.size}`,`base-modal--${e.variant}`]])},[r("div",lb,[r("div",rb,[to(C.$slots,"header",{},()=>[e.title?(v(),g("h2",cb,w(e.title),1)):P("",!0)],!0)]),e.showCloseButton?(v(),g("button",{key:0,onClick:T,class:"base-modal-close",type:"button","aria-label":"Close"},"  ")):P("",!0)]),C.$slots["tab-header"]?(v(),g("div",ub,[to(C.$slots,"tab-header",{},void 0,!0)])):P("",!0),r("div",{class:"base-modal-body",ref_key:"bodyRef",ref:u},[r("div",{class:"base-modal-body-content",ref_key:"contentRef",ref:d},[to(C.$slots,"default",{},void 0,!0)],512)],512),C.$slots.footer||C.$slots.actions?(v(),g("div",db,[to(C.$slots,"footer",{},()=>[C.$slots.actions?(v(),g("div",hb,[to(C.$slots,"actions",{},void 0,!0)])):P("",!0)],!0)])):P("",!0)],2),e.confirmOnClose&&!l.value?(v(),je(Pa,{key:0,show:a.value,title:"Unsaved changes",message:"You have unsaved changes. Are you sure you want to close?",onConfirm:D,onCancel:I},null,8,["show"])):P("",!0)],4)):P("",!0)]),_:3}))}},zt=ze(fb,[["__scopeId","data-v-e609c0f6"]]);function pv(e="details",t=[]){const o=M(e),i=m=>{o.value=m},s=()=>{o.value=e},a=m=>o.value===m,l=H(()=>t.length===0?-1:t.indexOf(o.value)),u=(m=!1)=>{if(t.length===0)return;const y=l.value;if(y===-1)return;const _=y+1;_<t.length?o.value=t[_]:m&&(o.value=t[0])},d=(m=!1)=>{if(t.length===0)return;const y=l.value;if(y===-1)return;const _=y-1;_>=0?o.value=t[_]:m&&(o.value=t[t.length-1])},p=H(()=>{if(t.length===0)return!1;const m=l.value;return m!==-1&&m<t.length-1}),f=H(()=>t.length===0?!1:l.value>0);return{activeTab:o,activeTabIndex:l,hasNextTab:p,hasPreviousTab:f,switchTab:i,resetTab:s,isActiveTab:a,nextTab:u,previousTab:d}}const vv=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET/CEST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Australia/Sydney",label:"Sydney (AEDT/AEST)"}],pb={class:"tabs"},vb={class:"tab-content"},mb={class:"form-group"},gb={class:"form-group"},yb={class:"form-group"},kb={class:"form-group"},_b=["value"],bb={class:"tab-content"},wb={class:"emergency-contacts-section"},Cb={key:0,class:"empty-state"},Lb={class:"card-header"},Sb=["onClick"],xb={class:"form-group"},Ib=["onUpdate:modelValue"],$b={class:"form-group"},Tb=["onUpdate:modelValue"],Mb={class:"form-group"},Ab=["onUpdate:modelValue"],Eb={__name:"EventFormModal",props:{show:{type:Boolean,default:!1},eventData:{type:Object,default:()=>({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]})},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const o=e,i=t,{activeTab:s,switchTab:a,resetTab:l}=pv("basic",["basic","emergency"]),u=M({...o.eventData});Ze(()=>o.eventData,y=>{u.value={...y},u.value.emergencyContacts||(u.value.emergencyContacts=[])},{deep:!0}),Ze(()=>o.show,y=>{y&&l()});const d=()=>{u.value.emergencyContacts.push({name:"",phone:"",details:""})},p=y=>{u.value.emergencyContacts.splice(y,1)},f=()=>{i("submit",{...u.value})},m=()=>{i("close")};return(y,_)=>(v(),je(zt,{show:e.show,title:e.isEditing?"Edit event":"Create new event",size:"large",onClose:m},{"tab-header":Ue(()=>[r("div",pb,[r("button",{type:"button",onClick:_[0]||(_[0]=b=>V(a)("basic")),class:ue(["tab-button",{active:V(s)==="basic"}])}," Basic details ",2),r("button",{type:"button",onClick:_[1]||(_[1]=b=>V(a)("emergency")),class:ue(["tab-button",{active:V(s)==="emergency"}])}," Emergency contacts ",2)])]),actions:Ue(()=>[r("button",{type:"button",onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-success"}," Save ")]),default:Ue(()=>[r("form",{onSubmit:dt(f,["prevent"])},[Ve(r("div",vb,[r("div",mb,[_[6]||(_[6]=r("label",null,"Event name *",-1)),Ve(r("input",{"onUpdate:modelValue":_[2]||(_[2]=b=>u.value.name=b),type:"text",required:"",class:"form-input"},null,512),[[nt,u.value.name]])]),r("div",gb,[_[7]||(_[7]=r("label",null,"Description",-1)),Ve(r("textarea",{"onUpdate:modelValue":_[3]||(_[3]=b=>u.value.description=b),rows:"3",class:"form-input"},null,512),[[nt,u.value.description]])]),r("div",yb,[_[8]||(_[8]=r("label",null,"Event date *",-1)),Ve(r("input",{"onUpdate:modelValue":_[4]||(_[4]=b=>u.value.eventDate=b),type:"datetime-local",required:"",class:"form-input"},null,512),[[nt,u.value.eventDate]])]),r("div",kb,[_[9]||(_[9]=r("label",null,"Time zone *",-1)),Ve(r("select",{"onUpdate:modelValue":_[5]||(_[5]=b=>u.value.timeZoneId=b),required:"",class:"form-input"},[(v(!0),g(xe,null,Be(V(vv),b=>(v(),g("option",{key:b.value,value:b.value},w(b.label),9,_b))),128))],512),[[Dn,u.value.timeZoneId]])])],512),[[bi,V(s)==="basic"]]),Ve(r("div",bb,[r("div",wb,[r("div",{class:"section-header-small"},[_[10]||(_[10]=r("h3",null,"Emergency contacts",-1)),r("button",{type:"button",onClick:d,class:"btn btn-small btn-primary"}," Add contact ")]),u.value.emergencyContacts.length===0?(v(),g("div",Cb,[..._[11]||(_[11]=[r("p",null,'No emergency contacts added yet. Click "Add contact" to add one.',-1)])])):P("",!0),(v(!0),g(xe,null,Be(u.value.emergencyContacts,(b,S)=>(v(),g("div",{key:S,class:"emergency-contact-card"},[r("div",Lb,[r("h4",null,"Contact "+w(S+1),1),r("button",{type:"button",onClick:T=>p(S),class:"btn-remove"},"  ",8,Sb)]),r("div",xb,[_[12]||(_[12]=r("label",null,"Name *",-1)),Ve(r("input",{"onUpdate:modelValue":T=>b.name=T,type:"text",required:"",class:"form-input",placeholder:"Contact person name"},null,8,Ib),[[nt,b.name]])]),r("div",$b,[_[13]||(_[13]=r("label",null,"Phone *",-1)),Ve(r("input",{"onUpdate:modelValue":T=>b.phone=T,type:"tel",required:"",class:"form-input",placeholder:"+1 (555) 123-4567"},null,8,Tb),[[nt,b.phone]])]),r("div",Mb,[_[14]||(_[14]=r("label",null,"Additional details",-1)),Ve(r("textarea",{"onUpdate:modelValue":T=>b.details=T,rows:"2",class:"form-input",placeholder:"Role, availability, or other important information..."},null,8,Ab),[[nt,b.details]])])]))),128))])],512),[[bi,V(s)==="emergency"]])],32)]),_:1},8,["show","title"]))}},Pb=ze(Eb,[["__scopeId","data-v-d820eb4f"]]),mv="admin-theme-preference",Hi=M(Db());function Db(){return typeof window>"u"?"system":localStorage.getItem(mv)||"system"}function Rb(e){localStorage.setItem(mv,e)}function Gu(){const e=H(()=>Hi.value==="system"?"light dark":Hi.value),t=(s,a=!0)=>{a&&typeof document<"u"&&(document.documentElement.classList.add("theme-transitioning"),setTimeout(()=>{document.documentElement.classList.remove("theme-transitioning")},1e3)),Hi.value=s,Rb(s)},o=()=>{const s=["system","light","dark"],l=(s.indexOf(Hi.value)+1)%s.length;t(s[l])},i=H(()=>Hi.value==="dark"?!0:Hi.value==="light"?!1:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1);return{theme:Hi,colorScheme:e,isDark:i,setTheme:t,cycleTheme:o}}const Ob=["aria-expanded","title"],Bb=["innerHTML"],Nb={key:0,class:"dropdown-menu"},Fb=["onClick"],Ub=["innerHTML"],zb={__name:"ThemeToggle",setup(e){const{theme:t,isDark:o,setTheme:i}=Gu(),s=M(!1),a=M(null),l={light:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
  </svg>`,dark:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
  </svg>`,system:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
    <line x1="8" y1="21" x2="16" y2="21"></line>
    <line x1="12" y1="17" x2="12" y2="21"></line>
  </svg>`},u=[{value:"system",label:"System",icon:l.system},{value:"light",label:"Light",icon:l.light},{value:"dark",label:"Dark",icon:l.dark}],d=H(()=>o.value?l.dark:l.light),p=()=>{s.value=!s.value},f=y=>{i(y),s.value=!1},m=y=>{a.value&&!a.value.contains(y.target)&&(s.value=!1)};return Qt(()=>{document.addEventListener("click",m)}),On(()=>{document.removeEventListener("click",m)}),(y,_)=>(v(),g("div",{class:"theme-dropdown",ref_key:"dropdownRef",ref:a},[r("button",{class:"theme-toggle-btn",onClick:p,type:"button","aria-expanded":s.value,title:V(o)?"Dark mode":"Light mode"},[r("span",{class:"theme-icon",innerHTML:d.value},null,8,Bb)],8,Ob),s.value?(v(),g("div",Nb,[(v(),g(xe,null,Be(u,b=>r("button",{key:b.value,class:ue(["dropdown-item",{active:V(t)===b.value}]),onClick:S=>f(b.value)},[r("span",{class:"option-icon",innerHTML:b.icon},null,8,Ub),r("span",null,w(b.label),1)],10,Fb)),64))])):P("",!0)],512))}},gv=ze(zb,[["__scopeId","data-v-969124a4"]]),Hb={class:"header"},Vb={class:"header-actions"},Gb={class:"user-email"},jb={class:"container"},Zb={class:"section"},qb={class:"section-header"},Wb={key:0,class:"loading"},Kb={key:1,class:"empty"},Yb={key:2,class:"events-grid"},Jb=["onClick"],Xb={class:"event-date"},Qb={class:"event-desc"},e0={class:"event-actions"},t0=["onClick"],n0=["onClick"],o0={__name:"AdminDashboard",setup(e){const t=Ra(),{colorScheme:o}=Gu(),i=Na(),s=fv(),a=M(!0),l=M(!1),u=M(null),d=M({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}),p=M([]),f=M(!1),m=M(""),y=M(""),_=M(null),b=M(!1),S=M("OK"),T=async()=>{a.value=!0;try{await s.fetchEvents(),p.value=s.events}catch(K){console.error("Failed to load events:",K)}finally{a.value=!1}},D=async K=>{try{const re={...K,adminEmail:i.adminEmail};u.value?await s.updateEvent(u.value.id,re):await s.createEvent(re),p.value=s.events,N()}catch(re){console.error("Failed to save event:",re),alert("Failed to save event. Please try again.")}},I=K=>{u.value=K,d.value={name:K.name,description:K.description,eventDate:U(K.eventDate),timeZoneId:K.timeZoneId||"UTC",emergencyContacts:K.emergencyContacts?JSON.parse(JSON.stringify(K.emergencyContacts)):[]}},C=async K=>{m.value="Delete event",y.value=`Are you sure you want to delete "${K.name}"?`,b.value=!0,S.value="Delete",_.value=async()=>{try{await s.deleteEvent(K.id),p.value=s.events}catch(re){console.error("Failed to delete event:",re),alert("Failed to delete event. Please try again.")}},f.value=!0},A=()=>{f.value=!1,_.value&&(_.value(),_.value=null)},E=()=>{f.value=!1,_.value=null},N=()=>{l.value=!1,u.value=null,d.value={name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}},$=K=>{if(!K){console.error("Cannot navigate to event: eventId is undefined");return}t.push({name:"AdminEventManage",params:{eventId:K}})},G=()=>{t.push({name:"AdminProfile"})},R=()=>{i.logout(),t.push({name:"Home"})},Z=K=>new Date(K).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),U=K=>{const re=new Date(K),Pe=re.getFullYear(),me=String(re.getMonth()+1).padStart(2,"0"),Ae=String(re.getDate()).padStart(2,"0"),Fe=String(re.getHours()).padStart(2,"0"),ae=String(re.getMinutes()).padStart(2,"0");return`${Pe}-${me}-${Ae}T${Fe}:${ae}`};return Qt(()=>{T()}),(K,re)=>(v(),g("div",{class:"admin-dashboard",style:ut({colorScheme:V(o)})},[r("header",Hb,[re[1]||(re[1]=r("h1",null,"Admin dashboard",-1)),r("div",Vb,[r("span",Gb,w(V(i).adminEmail),1),r("button",{onClick:G,class:"btn btn-secondary"},"Profile"),r("button",{onClick:R,class:"btn btn-secondary"},"Logout"),Ee(gv)])]),r("div",jb,[r("div",Zb,[r("div",qb,[re[2]||(re[2]=r("h2",null,"Your events",-1)),r("button",{onClick:re[0]||(re[0]=Pe=>l.value=!0),class:"btn btn-primary"}," Create new event ")]),a.value?(v(),g("div",Wb,"Loading events...")):p.value.length===0?(v(),g("div",Kb,[...re[3]||(re[3]=[r("p",null,"No events yet. Create your first event to get started!",-1)])])):(v(),g("div",Yb,[(v(!0),g(xe,null,Be(p.value,Pe=>(v(),g("div",{key:Pe.id,class:"event-card",onClick:me=>$(Pe.id)},[r("h3",null,w(Pe.name),1),r("p",Xb,w(Z(Pe.eventDate)),1),r("p",Qb,w(Pe.description),1),r("div",e0,[r("button",{onClick:dt(me=>I(Pe),["stop"]),class:"btn btn-small btn-secondary"}," Edit ",8,t0),r("button",{onClick:dt(me=>C(Pe),["stop"]),class:"btn btn-small btn-danger"}," Delete ",8,n0)])],8,Jb))),128))]))])]),Ee(Pb,{show:l.value||!!u.value,"event-data":d.value,"is-editing":!!u.value,onClose:N,onSubmit:D},null,8,["show","event-data","is-editing"]),Ee(Pa,{show:f.value,title:m.value,message:y.value,"is-danger":b.value,"confirm-text":S.value,onConfirm:A,onCancel:E},null,8,["show","title","message","is-danger","confirm-text"])],4))}},s0=ze(o0,[["__scopeId","data-v-16db0525"]]),i0=Bu("profile",()=>{const e=M(null),t=M(!1),o=M(null);return{profile:e,loading:t,error:o,fetchProfile:async()=>{t.value=!0,o.value=null;try{const d=await tr.getProfile();return e.value=d.data,d.data}catch(d){throw o.value=d.response?.data?.message||"Failed to load profile",d}finally{t.value=!1}},updateProfile:async d=>{t.value=!0,o.value=null;try{const p=await tr.updateProfile(d);return e.value=p.data,p.data}catch(p){throw o.value=p.response?.data?.message||"Failed to update profile",p}finally{t.value=!1}},fetchPerson:async(d,p)=>{t.value=!0,o.value=null;try{return(await tr.getPerson(d,p)).data}catch(f){throw o.value=f.response?.data?.message||"Failed to load person",f}finally{t.value=!1}},updatePerson:async(d,p,f)=>{t.value=!0,o.value=null;try{return(await tr.updatePerson(d,p,f)).data}catch(m){throw o.value=m.response?.data?.message||"Failed to update person",m}finally{t.value=!1}},clearProfile:()=>{e.value=null,o.value=null}}}),a0={class:"form-group"},l0={class:"form-group"},r0={class:"form-group"},c0={__name:"EditProfileModal",props:{show:{type:Boolean,default:!1},profile:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=M({name:"",email:"",phone:""});Ze(()=>o.profile,d=>{d&&(s.value={name:d.name||"",email:d.email||"",phone:d.phone||""})},{immediate:!0,deep:!0}),Ze(()=>o.show,d=>{d&&o.profile&&(s.value={name:o.profile.name||"",email:o.profile.email||"",phone:o.profile.phone||""})});const a=()=>{i("update:isDirty",!0)},l=()=>{if(!s.value.name.trim()){alert("Name is required");return}if(!s.value.email.trim()){alert("Email is required");return}i("submit",{name:s.value.name.trim(),email:s.value.email.trim(),phone:s.value.phone?.trim()||""})},u=()=>{i("close")};return(d,p)=>(v(),je(zt,{show:e.show,title:"Edit profile",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:Ue(()=>[r("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-success"}," Save ")]),default:Ue(()=>[r("form",{onSubmit:dt(l,["prevent"])},[r("div",a0,[p[3]||(p[3]=r("label",null,"Name *",-1)),Ve(r("input",{"onUpdate:modelValue":p[0]||(p[0]=f=>s.value.name=f),type:"text",required:"",class:"form-input",placeholder:"Your name",onInput:a},null,544),[[nt,s.value.name]])]),r("div",l0,[p[4]||(p[4]=r("label",null,"Email *",-1)),Ve(r("input",{"onUpdate:modelValue":p[1]||(p[1]=f=>s.value.email=f),type:"email",required:"",class:"form-input",placeholder:"Your email address",onInput:a},null,544),[[nt,s.value.email]])]),r("div",r0,[p[5]||(p[5]=r("label",null,"Phone",-1)),Ve(r("input",{"onUpdate:modelValue":p[2]||(p[2]=f=>s.value.phone=f),type:"tel",class:"form-input",placeholder:"Your phone number",onInput:a},null,544),[[nt,s.value.phone]])])],32)]),_:1},8,["show","is-dirty"]))}},u0=ze(c0,[["__scopeId","data-v-fe46b0f5"]]),d0={class:"admin-profile"},h0={class:"header"},f0={class:"header-actions"},p0={class:"user-email"},v0={class:"container"},m0={class:"section"},g0={class:"section-header"},y0={key:0,class:"loading"},k0={key:1,class:"error"},_0={key:2,class:"profile-details"},b0={class:"profile-field"},w0={class:"field-value"},C0={class:"profile-field"},L0={class:"field-value"},S0={class:"profile-field"},x0={class:"field-value"},I0={class:"profile-field"},$0={class:"field-value"},T0={__name:"AdminProfile",setup(e){const t=Ra(),o=Na(),i=i0(),s=M(!1),a=async()=>{try{await i.fetchProfile()}catch(p){console.error("Failed to load profile:",p)}},l=async p=>{try{await i.updateProfile(p),s.value=!1}catch(f){console.error("Failed to save profile:",f),alert("Failed to save profile. Please try again.")}},u=()=>{o.logout(),t.push({name:"Home"})},d=()=>{t.push({name:"AdminDashboard"})};return Qt(()=>{a()}),(p,f)=>(v(),g("div",d0,[r("header",h0,[f[2]||(f[2]=r("h1",null,"My profile",-1)),r("div",f0,[r("span",p0,w(V(o).adminEmail),1),r("button",{onClick:u,class:"btn btn-secondary"},"Logout")])]),r("div",v0,[r("div",m0,[r("div",g0,[f[3]||(f[3]=r("h2",null,"Profile information",-1)),r("button",{onClick:f[0]||(f[0]=m=>s.value=!0),class:"btn btn-primary"}," Edit profile ")]),V(i).loading?(v(),g("div",y0,"Loading profile...")):V(i).error?(v(),g("div",k0,[r("p",null,w(V(i).error),1),r("button",{onClick:a,class:"btn btn-secondary"},"Retry")])):V(i).profile?(v(),g("div",_0,[r("div",b0,[f[4]||(f[4]=r("label",null,"Name",-1)),r("div",w0,w(V(i).profile.name||""),1)]),r("div",C0,[f[5]||(f[5]=r("label",null,"Email",-1)),r("div",L0,w(V(i).profile.email||""),1)]),r("div",S0,[f[6]||(f[6]=r("label",null,"Phone",-1)),r("div",x0,w(V(i).profile.phone||""),1)]),r("div",I0,[f[7]||(f[7]=r("label",null,"System admin",-1)),r("div",$0,[r("span",{class:ue(["badge",V(i).profile.isSystemAdmin?"badge-success":"badge-secondary"])},w(V(i).profile.isSystemAdmin?"Yes":"No"),3)])])])):P("",!0)]),r("div",{class:"section"},[r("button",{onClick:d,class:"btn btn-secondary"}," Back to Dashboard ")])]),Ee(u0,{show:s.value,profile:V(i).profile,onClose:f[1]||(f[1]=m=>s.value=!1),onSubmit:l},null,8,["show","profile"])]))}},M0=ze(T0,[["__scopeId","data-v-fdbd980a"]]);function A0(){const e=M(!1),t=M(""),o=M(""),i=M(null),s=M(!1),a=M("OK");return{showConfirmModal:e,confirmModalTitle:t,confirmModalMessage:o,confirmModalIsDanger:s,confirmModalConfirmText:a,showConfirm:(f,m,y,_={})=>{t.value=f,o.value=m,i.value=y,s.value=_.isDanger||!1,a.value=_.confirmText||"OK",e.value=!0},handleConfirmModalConfirm:()=>{e.value=!1,i.value&&(i.value(),i.value=null)},handleConfirmModalCancel:()=>{e.value=!1,i.value=null},closeConfirmModal:()=>{e.value=!1,i.value=null}}}const _a=M({people:"Marshals",checkpoint:"Checkpoints",area:"Areas",checklist:"Checklists",course:"Course"}),Fs={people:{People:{singular:"Person",plural:"People"},Marshals:{singular:"Marshal",plural:"Marshals"},Volunteers:{singular:"Volunteer",plural:"Volunteers"},Helpers:{singular:"Helper",plural:"Helpers"},Staff:{singular:"Staff member",plural:"Staff"},Stewards:{singular:"Steward",plural:"Stewards"},"Team members":{singular:"Team member",plural:"Team members"},Drivers:{singular:"Driver",plural:"Drivers"},Pilots:{singular:"Pilot",plural:"Pilots"}},checkpoint:{Checkpoints:{singular:"Checkpoint",plural:"Checkpoints"},Stations:{singular:"Station",plural:"Stations"},Locations:{singular:"Location",plural:"Locations"},"Feed stations":{singular:"Feed station",plural:"Feed stations"},"Aid stations":{singular:"Aid station",plural:"Aid stations"},"Water stations":{singular:"Water station",plural:"Water stations"},"Person points":{singular:null,plural:null,dynamic:!0}},area:{Areas:{singular:"Area",plural:"Areas"},Regions:{singular:"Region",plural:"Regions"},Zones:{singular:"Zone",plural:"Zones"}},checklist:{Checklists:{singular:"Checklist",plural:"Checklists"},Tasks:{singular:"Task",plural:"Tasks"},Jobs:{singular:"Job",plural:"Jobs"}},course:{Course:{singular:"Course",plural:"Courses"},Route:{singular:"Route",plural:"Routes"},Track:{singular:"Track",plural:"Tracks"},Trail:{singular:"Trail",plural:"Trails"},Path:{singular:"Path",plural:"Paths"}}},Bs={people:["Drivers","Helpers","Marshals","People","Pilots","Staff","Stewards","Team members","Volunteers"],checkpoint:["Aid stations","Checkpoints","Feed stations","Locations","Person points","Stations","Water stations"],area:["Areas","Regions","Zones"],checklist:["Checklists","Jobs","Tasks"],course:["Course","Path","Route","Track","Trail"]};function Zi(e,t,o="Marshals"){if(!t)return"";const i=Fs[e]?.[t];return e==="checkpoint"&&t==="Person points"?`${Fs.people[o]?.singular||"Person"} point`:i?.singular?i.singular:t.endsWith("s")&&!t.endsWith("ss")?t.slice(0,-1):t}function yv(e,t,o="Marshals"){if(!t)return"";const i=Fs[e]?.[t];return t==="Person points"?`${Fs.people[o]?.singular||"Person"} points`:i?.plural?i.plural:t}function uu(e,t){return e==="Person points"?`${Fs.people[t]?.singular||"Person"} points`:e}function du(e){e&&(_a.value={people:e.peopleTerm||"Marshals",checkpoint:e.checkpointTerm||"Checkpoints",area:e.areaTerm||"Areas",checklist:e.checklistTerm||"Checklists",course:e.courseTerm||"Course"})}const jo=e=>e.toLowerCase(),Zo=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();function St(){const e=f=>{const m=_a.value[f],y=Fs[f]?.[m];if(f==="checkpoint"&&m==="Person points"){const _=_a.value.people;return`${Fs.people[_]?.singular||"Person"} point`}return y?.singular||m},t=f=>{const m=_a.value[f],y=Fs[f]?.[m];if(f==="checkpoint"&&m==="Person points"){const _=_a.value.people;return`${Fs.people[_]?.singular||"Person"} points`}return y?.plural||m},o=H(()=>({person:e("people"),checkpoint:e("checkpoint"),area:e("area"),checklist:e("checklist"),course:e("course"),people:t("people"),checkpoints:t("checkpoint"),areas:t("area"),checklists:t("checklist"),courses:t("course")})),i=H(()=>({person:jo(e("people")),checkpoint:jo(e("checkpoint")),area:jo(e("area")),checklist:jo(e("checklist")),course:jo(e("course")),people:jo(t("people")),checkpoints:jo(t("checkpoint")),areas:jo(t("area")),checklists:jo(t("checklist")),courses:jo(t("course"))})),s=H(()=>({person:Zo(e("people")),checkpoint:Zo(e("checkpoint")),area:Zo(e("area")),checklist:Zo(e("checklist")),course:Zo(e("course")),people:Zo(t("people")),checkpoints:Zo(t("checkpoint")),areas:Zo(t("area")),checklists:Zo(t("checklist")),courses:Zo(t("course"))})),a=H(()=>({course:o.value.course,checkpoints:o.value.checkpoints,areas:o.value.areas,marshals:o.value.people,checklists:o.value.checklists,notes:"Notes",details:"Event details"}));return{terms:o,termsLower:i,termsSentence:s,tabLabels:a,singular:e,plural:t,formatCount:(f,m)=>m===1?`1 ${e(f)}`:`${m} ${t(f)}`,lower:(f,m=!0)=>jo(m?t(f):e(f)),title:(f,m=!0)=>m?t(f):e(f),sentence:(f,m=!0)=>Zo(m?t(f):e(f)),terminology:_a}}function E0(){const e=M(!1),t=M(null),o=M({}),i=M(null),s=M(null),a=M([]),l=M(null),u=M(null),d=M(!1),p=M(!1),f=M(1),m=H(()=>t.value==="place-checkpoint"||t.value==="move-checkpoint"?i.value!==null:t.value==="draw-area"?s.value&&s.value.length>=3:t.value==="add-multiple"),y=re=>{if(re){const Pe=re.getMapCenter?.(),me=re.getMapZoom?.();Pe&&me!==null&&(l.value=Pe,u.value=me)}},_=(re={})=>{i.value=null,e.value=!0,t.value="place-checkpoint",o.value={title:re.title||"Select checkpoint location",description:re.description||"Click on the map to set the location. Click again to reposition."}},b=(re,Pe="checkpoint")=>{i.value=null,e.value=!0,t.value="move-checkpoint",o.value={title:`Move ${Pe}: ${re}`,description:"Click on the map to set the new location"}},S=(re={})=>{e.value=!0,t.value="draw-area",d.value=!0,o.value={title:re.title||"Draw area boundary",description:re.description||"Click to add points. Click Done when finished to complete the area."}},T=(re=1)=>{f.value=re,a.value=[],e.value=!0,t.value="add-multiple",p.value=!0,o.value={title:"Add multiple checkpoints",description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},D=re=>{t.value==="place-checkpoint"||t.value==="move-checkpoint"?i.value=re:t.value==="add-multiple"&&I(re)},I=re=>{a.value.push({id:`temp-${f.value}`,name:`Checkpoint ${f.value}`,description:"",latitude:re.lat,longitude:re.lng,requiredMarshals:1,what3Words:"",assignments:[],isTemporary:!0}),f.value++,o.value={...o.value,description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},C=re=>{s.value=re},A=()=>s.value&&s.value.length>=3?s.value.map(re=>({lat:re.lat,lng:re.lng})):null,E=()=>{e.value=!1,t.value=null,o.value={},i.value=null,l.value=null,u.value=null,s.value=null,d.value&&(d.value=!1)};return{isFullscreenMapActive:e,fullscreenMode:t,fullscreenContext:o,tempLocationCoords:i,currentDrawingPolygon:s,tempCheckpoints:a,savedMapCenter:l,savedMapZoom:u,isDrawingAreaBoundary:d,isAddingMultipleCheckpoints:p,multiCheckpointCounter:f,canCompleteFullscreen:m,saveMapState:y,enterPlaceCheckpointMode:_,enterMoveCheckpointMode:b,enterDrawAreaMode:S,enterAddMultipleMode:T,handleFullscreenMapClick:D,handlePolygonDrawing:C,getCompletedPolygon:A,exitFullscreen:E,cancelFullscreen:()=>{t.value==="add-multiple"?(a.value=[],p.value=!1):t.value==="draw-area"&&(d.value=!1,s.value=null),E()},getTempCheckpoints:()=>[...a.value],clearTempCheckpoints:()=>{a.value=[],p.value=!1},getPlacedCoords:()=>i.value,createDisplayCheckpoints:(re,Pe,me)=>H(()=>{const Ae=[...re.value];return t.value==="place-checkpoint"&&i.value&&Ae.push({id:"temp-single",name:Pe.value?.name||"New Checkpoint",latitude:i.value.lat,longitude:i.value.lng,requiredMarshals:Pe.value?.requiredMarshals||1,assignments:[],isTemporary:!0}),t.value==="move-checkpoint"&&i.value&&me.value&&Ae.push({id:"temp-move",name:me.value.name+" (new position)",latitude:i.value.lat,longitude:i.value.lng,requiredMarshals:me.value.requiredMarshals,assignments:[],isTemporary:!0}),t.value==="add-multiple"&&Ae.push(...a.value),Ae}),createDisplayAreas:(re,Pe)=>H(()=>{const me=[...re.value];if(t.value==="draw-area"&&Pe.value?.polygon?.length>0){const Ae=me.findIndex(Fe=>Fe.id===Pe.value.id);Ae>=0?me[Ae]={...Pe.value}:me.push({...Pe.value,id:Pe.value.id||"temp-area"})}return me}),calculateStartingNumber:re=>{const Pe=re.value.map(me=>{const Ae=me.name.match(/^Checkpoint (\d+)$/);return Ae?parseInt(Ae[1]):0}).filter(me=>me>0);return Pe.length>0?Math.max(...Pe)+1:1}}}function P0(e){const t=M([]),o=M(!1);return{eventAdmins:t,showAddAdmin:o,loadEventAdmins:async()=>{try{const d=await Dc.getAdmins(e.value);return t.value=d.data,d.data}catch(d){throw console.error("Failed to load event admins:",d),d}},openAddAdminModal:()=>{o.value=!0},closeAddAdminModal:()=>{o.value=!1},addAdmin:async d=>{await Dc.addAdmin(e.value,d)},removeAdmin:async d=>{await Dc.removeAdmin(e.value,d)}}}function D0(e){const t=M(!1),o=M(!1),i=M(!1),s=M(!1),a=M(!1),l=M(!1),u=M(null),d=M(null),p=M(null),f=M(null);return{showUploadRoute:t,showImportLocations:o,showImportMarshals:i,uploading:s,importing:a,importingMarshals:l,uploadError:u,importError:d,importResult:p,importMarshalsResult:f,openUploadRouteModal:()=>{u.value=null,t.value=!0},closeUploadRouteModal:()=>{t.value=!1,u.value=null},uploadRoute:async E=>{if(!E)return u.value="Please select a GPX file",null;s.value=!0,u.value=null;try{return await ji.uploadGpx(e.value,E),!0}catch(N){return console.error("Failed to upload route:",N),u.value=N.response?.data?.message||"Failed to upload route. Please try again.",null}finally{s.value=!1}},openImportLocationsModal:()=>{d.value=null,p.value=null,o.value=!0},closeImportLocationsModal:()=>{o.value=!1,d.value=null,p.value=null},importLocations:async(E,N)=>{if(!E)return d.value="Please select a CSV file",null;a.value=!0,d.value=null,p.value=null;try{const $=await no.importCsv(e.value,E,N);return p.value=$.data,$.data}catch($){return console.error("Failed to import locations:",$),d.value=$.response?.data?.message||"Failed to import locations. Please try again.",null}finally{a.value=!1}},openImportMarshalsModal:()=>{d.value=null,f.value=null,i.value=!0},closeImportMarshalsModal:()=>{i.value=!1,d.value=null,f.value=null},importMarshals:async E=>{if(!E)return d.value="Please select a CSV file",null;l.value=!0,d.value=null,f.value=null;try{const N=await hs.importCsv(e.value,E);return f.value=N.data,N.data}catch(N){return console.error("Failed to import marshals:",N),d.value=N.response?.data?.message||"Failed to import marshals. Please try again.",null}finally{l.value=!1}},formatImportResultMessage:(E,N="location")=>{const $=N==="location"?"location(s)":"marshal(s)";let R=`<p>Created <strong>${E[N==="location"?"locationsCreated":"marshalsCreated"]}</strong> ${$} and <strong>${E.assignmentsCreated}</strong> assignment(s)</p>`;return E.errors&&E.errors.length>0&&(R+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',E.errors.forEach(Z=>{R+=`<li>${Z}</li>`}),R+="</ul>"),R}}}const kv=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",Tl=e=>{if(!e)return"";const t=new Date(e),o=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0");return`${o}-${i}-${s}T${a}:${l}`},Ir=e=>{if(!e||e.trim()==="")return!0;if(!/^[a-z]{1,20}[./][a-z]{1,20}[./][a-z]{1,20}$/.test(e))return!1;const o=e.includes("."),i=e.includes("/");return o!==i},R0=(e,t,o,i)=>{const a=e*Math.PI/180,l=o*Math.PI/180,u=(o-e)*Math.PI/180,d=(i-t)*Math.PI/180,p=Math.sin(u/2)*Math.sin(u/2)+Math.cos(a)*Math.cos(l)*Math.sin(d/2)*Math.sin(d/2);return 6371e3*(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)))},O0=e=>!e&&e!==0?"":e<1e3?`${Math.round(e)} m`:`${(e/1e3).toFixed(2)} km`;function B0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ll={exports:{}};var N0=ll.exports,Fh;function F0(){return Fh||(Fh=1,(function(e,t){(function(o,i){i(t)})(N0,(function(o){var i="1.9.4";function s(n){var c,h,k,x;for(h=1,k=arguments.length;h<k;h++){x=arguments[h];for(c in x)n[c]=x[c]}return n}var a=Object.create||(function(){function n(){}return function(c){return n.prototype=c,new n}})();function l(n,c){var h=Array.prototype.slice;if(n.bind)return n.bind.apply(n,h.call(arguments,1));var k=h.call(arguments,2);return function(){return n.apply(c,k.length?k.concat(h.call(arguments)):arguments)}}var u=0;function d(n){return"_leaflet_id"in n||(n._leaflet_id=++u),n._leaflet_id}function p(n,c,h){var k,x,B,ee;return ee=function(){k=!1,x&&(B.apply(h,x),x=!1)},B=function(){k?x=arguments:(n.apply(h,arguments),setTimeout(ee,c),k=!0)},B}function f(n,c,h){var k=c[1],x=c[0],B=k-x;return n===k&&h?n:((n-x)%B+B)%B+x}function m(){return!1}function y(n,c){if(c===!1)return n;var h=Math.pow(10,c===void 0?6:c);return Math.round(n*h)/h}function _(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function b(n){return _(n).split(/\s+/)}function S(n,c){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?a(n.options):{});for(var h in c)n.options[h]=c[h];return n.options}function T(n,c,h){var k=[];for(var x in n)k.push(encodeURIComponent(h?x.toUpperCase():x)+"="+encodeURIComponent(n[x]));return(!c||c.indexOf("?")===-1?"?":"&")+k.join("&")}var D=/\{ *([\w_ -]+) *\}/g;function I(n,c){return n.replace(D,function(h,k){var x=c[k];if(x===void 0)throw new Error("No value provided for variable "+h);return typeof x=="function"&&(x=x(c)),x})}var C=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function A(n,c){for(var h=0;h<n.length;h++)if(n[h]===c)return h;return-1}var E="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function N(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var $=0;function G(n){var c=+new Date,h=Math.max(0,16-(c-$));return $=c+h,window.setTimeout(n,h)}var R=window.requestAnimationFrame||N("RequestAnimationFrame")||G,Z=window.cancelAnimationFrame||N("CancelAnimationFrame")||N("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function U(n,c,h){if(h&&R===G)n.call(c);else return R.call(window,l(n,c))}function K(n){n&&Z.call(window,n)}var re={__proto__:null,extend:s,create:a,bind:l,get lastId(){return u},stamp:d,throttle:p,wrapNum:f,falseFn:m,formatNum:y,trim:_,splitWords:b,setOptions:S,getParamString:T,template:I,isArray:C,indexOf:A,emptyImageUrl:E,requestFn:R,cancelFn:Z,requestAnimFrame:U,cancelAnimFrame:K};function Pe(){}Pe.extend=function(n){var c=function(){S(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=c.__super__=this.prototype,k=a(h);k.constructor=c,c.prototype=k;for(var x in this)Object.prototype.hasOwnProperty.call(this,x)&&x!=="prototype"&&x!=="__super__"&&(c[x]=this[x]);return n.statics&&s(c,n.statics),n.includes&&(me(n.includes),s.apply(null,[k].concat(n.includes))),s(k,n),delete k.statics,delete k.includes,k.options&&(k.options=h.options?a(h.options):{},s(k.options,n.options)),k._initHooks=[],k.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var B=0,ee=k._initHooks.length;B<ee;B++)k._initHooks[B].call(this)}},c},Pe.include=function(n){var c=this.prototype.options;return s(this.prototype,n),n.options&&(this.prototype.options=c,this.mergeOptions(n.options)),this},Pe.mergeOptions=function(n){return s(this.prototype.options,n),this},Pe.addInitHook=function(n){var c=Array.prototype.slice.call(arguments,1),h=typeof n=="function"?n:function(){this[n].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function me(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=C(n)?n:[n];for(var c=0;c<n.length;c++)n[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Ae={on:function(n,c,h){if(typeof n=="object")for(var k in n)this._on(k,n[k],c);else{n=b(n);for(var x=0,B=n.length;x<B;x++)this._on(n[x],c,h)}return this},off:function(n,c,h){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var k in n)this._off(k,n[k],c);else{n=b(n);for(var x=arguments.length===1,B=0,ee=n.length;B<ee;B++)x?this._off(n[B]):this._off(n[B],c,h)}return this},_on:function(n,c,h,k){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(n,c,h)===!1){h===this&&(h=void 0);var x={fn:c,ctx:h};k&&(x.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(x)}},_off:function(n,c,h){var k,x,B;if(this._events&&(k=this._events[n],!!k)){if(arguments.length===1){if(this._firingCount)for(x=0,B=k.length;x<B;x++)k[x].fn=m;delete this._events[n];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var ee=this._listens(n,c,h);if(ee!==!1){var ve=k[ee];this._firingCount&&(ve.fn=m,this._events[n]=k=k.slice()),k.splice(ee,1)}}},fire:function(n,c,h){if(!this.listens(n,h))return this;var k=s({},c,{type:n,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var x=this._events[n];if(x){this._firingCount=this._firingCount+1||1;for(var B=0,ee=x.length;B<ee;B++){var ve=x[B],Le=ve.fn;ve.once&&this.off(n,Le,ve.ctx),Le.call(ve.ctx||this,k)}this._firingCount--}}return h&&this._propagateEvent(k),this},listens:function(n,c,h,k){typeof n!="string"&&console.warn('"string" type argument expected');var x=c;typeof c!="function"&&(k=!!c,x=void 0,h=void 0);var B=this._events&&this._events[n];if(B&&B.length&&this._listens(n,x,h)!==!1)return!0;if(k){for(var ee in this._eventParents)if(this._eventParents[ee].listens(n,c,h,k))return!0}return!1},_listens:function(n,c,h){if(!this._events)return!1;var k=this._events[n]||[];if(!c)return!!k.length;h===this&&(h=void 0);for(var x=0,B=k.length;x<B;x++)if(k[x].fn===c&&k[x].ctx===h)return x;return!1},once:function(n,c,h){if(typeof n=="object")for(var k in n)this._on(k,n[k],c,!0);else{n=b(n);for(var x=0,B=n.length;x<B;x++)this._on(n[x],c,h,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[d(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[d(n)],this},_propagateEvent:function(n){for(var c in this._eventParents)this._eventParents[c].fire(n.type,s({layer:n.target,propagatedFrom:n.target},n),!0)}};Ae.addEventListener=Ae.on,Ae.removeEventListener=Ae.clearAllEventListeners=Ae.off,Ae.addOneTimeEventListener=Ae.once,Ae.fireEvent=Ae.fire,Ae.hasEventListeners=Ae.listens;var Fe=Pe.extend(Ae);function ae(n,c,h){this.x=h?Math.round(n):n,this.y=h?Math.round(c):c}var Me=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};ae.prototype={clone:function(){return new ae(this.x,this.y)},add:function(n){return this.clone()._add(ge(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(ge(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new ae(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new ae(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Me(this.x),this.y=Me(this.y),this},distanceTo:function(n){n=ge(n);var c=n.x-this.x,h=n.y-this.y;return Math.sqrt(c*c+h*h)},equals:function(n){return n=ge(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=ge(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+y(this.x)+", "+y(this.y)+")"}};function ge(n,c,h){return n instanceof ae?n:C(n)?new ae(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new ae(n.x,n.y):new ae(n,c,h)}function de(n,c){if(n)for(var h=c?[n,c]:n,k=0,x=h.length;k<x;k++)this.extend(h[k])}de.prototype={extend:function(n){var c,h;if(!n)return this;if(n instanceof ae||typeof n[0]=="number"||"x"in n)c=h=ge(n);else if(n=Oe(n),c=n.min,h=n.max,!c||!h)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=h.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(n){return ge((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return ge(this.min.x,this.max.y)},getTopRight:function(){return ge(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var c,h;return typeof n[0]=="number"||n instanceof ae?n=ge(n):n=Oe(n),n instanceof de?(c=n.min,h=n.max):c=h=n,c.x>=this.min.x&&h.x<=this.max.x&&c.y>=this.min.y&&h.y<=this.max.y},intersects:function(n){n=Oe(n);var c=this.min,h=this.max,k=n.min,x=n.max,B=x.x>=c.x&&k.x<=h.x,ee=x.y>=c.y&&k.y<=h.y;return B&&ee},overlaps:function(n){n=Oe(n);var c=this.min,h=this.max,k=n.min,x=n.max,B=x.x>c.x&&k.x<h.x,ee=x.y>c.y&&k.y<h.y;return B&&ee},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var c=this.min,h=this.max,k=Math.abs(c.x-h.x)*n,x=Math.abs(c.y-h.y)*n;return Oe(ge(c.x-k,c.y-x),ge(h.x+k,h.y+x))},equals:function(n){return n?(n=Oe(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function Oe(n,c){return!n||n instanceof de?n:new de(n,c)}function Xe(n,c){if(n)for(var h=c?[n,c]:n,k=0,x=h.length;k<x;k++)this.extend(h[k])}Xe.prototype={extend:function(n){var c=this._southWest,h=this._northEast,k,x;if(n instanceof qe)k=n,x=n;else if(n instanceof Xe){if(k=n._southWest,x=n._northEast,!k||!x)return this}else return n?this.extend(tt(n)||et(n)):this;return!c&&!h?(this._southWest=new qe(k.lat,k.lng),this._northEast=new qe(x.lat,x.lng)):(c.lat=Math.min(k.lat,c.lat),c.lng=Math.min(k.lng,c.lng),h.lat=Math.max(x.lat,h.lat),h.lng=Math.max(x.lng,h.lng)),this},pad:function(n){var c=this._southWest,h=this._northEast,k=Math.abs(c.lat-h.lat)*n,x=Math.abs(c.lng-h.lng)*n;return new Xe(new qe(c.lat-k,c.lng-x),new qe(h.lat+k,h.lng+x))},getCenter:function(){return new qe((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new qe(this.getNorth(),this.getWest())},getSouthEast:function(){return new qe(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof qe||"lat"in n?n=tt(n):n=et(n);var c=this._southWest,h=this._northEast,k,x;return n instanceof Xe?(k=n.getSouthWest(),x=n.getNorthEast()):k=x=n,k.lat>=c.lat&&x.lat<=h.lat&&k.lng>=c.lng&&x.lng<=h.lng},intersects:function(n){n=et(n);var c=this._southWest,h=this._northEast,k=n.getSouthWest(),x=n.getNorthEast(),B=x.lat>=c.lat&&k.lat<=h.lat,ee=x.lng>=c.lng&&k.lng<=h.lng;return B&&ee},overlaps:function(n){n=et(n);var c=this._southWest,h=this._northEast,k=n.getSouthWest(),x=n.getNorthEast(),B=x.lat>c.lat&&k.lat<h.lat,ee=x.lng>c.lng&&k.lng<h.lng;return B&&ee},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,c){return n?(n=et(n),this._southWest.equals(n.getSouthWest(),c)&&this._northEast.equals(n.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function et(n,c){return n instanceof Xe?n:new Xe(n,c)}function qe(n,c,h){if(isNaN(n)||isNaN(c))throw new Error("Invalid LatLng object: ("+n+", "+c+")");this.lat=+n,this.lng=+c,h!==void 0&&(this.alt=+h)}qe.prototype={equals:function(n,c){if(!n)return!1;n=tt(n);var h=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return h<=(c===void 0?1e-9:c)},toString:function(n){return"LatLng("+y(this.lat,n)+", "+y(this.lng,n)+")"},distanceTo:function(n){return He.distance(this,tt(n))},wrap:function(){return He.wrapLatLng(this)},toBounds:function(n){var c=180*n/40075017,h=c/Math.cos(Math.PI/180*this.lat);return et([this.lat-c,this.lng-h],[this.lat+c,this.lng+h])},clone:function(){return new qe(this.lat,this.lng,this.alt)}};function tt(n,c,h){return n instanceof qe?n:C(n)&&typeof n[0]!="object"?n.length===3?new qe(n[0],n[1],n[2]):n.length===2?new qe(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new qe(n.lat,"lng"in n?n.lng:n.lon,n.alt):c===void 0?null:new qe(n,c,h)}var be={latLngToPoint:function(n,c){var h=this.projection.project(n),k=this.scale(c);return this.transformation._transform(h,k)},pointToLatLng:function(n,c){var h=this.scale(c),k=this.transformation.untransform(n,h);return this.projection.unproject(k)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var c=this.projection.bounds,h=this.scale(n),k=this.transformation.transform(c.min,h),x=this.transformation.transform(c.max,h);return new de(k,x)},infinite:!1,wrapLatLng:function(n){var c=this.wrapLng?f(n.lng,this.wrapLng,!0):n.lng,h=this.wrapLat?f(n.lat,this.wrapLat,!0):n.lat,k=n.alt;return new qe(h,c,k)},wrapLatLngBounds:function(n){var c=n.getCenter(),h=this.wrapLatLng(c),k=c.lat-h.lat,x=c.lng-h.lng;if(k===0&&x===0)return n;var B=n.getSouthWest(),ee=n.getNorthEast(),ve=new qe(B.lat-k,B.lng-x),Le=new qe(ee.lat-k,ee.lng-x);return new Xe(ve,Le)}},He=s({},be,{wrapLng:[-180,180],R:6371e3,distance:function(n,c){var h=Math.PI/180,k=n.lat*h,x=c.lat*h,B=Math.sin((c.lat-n.lat)*h/2),ee=Math.sin((c.lng-n.lng)*h/2),ve=B*B+Math.cos(k)*Math.cos(x)*ee*ee,Le=2*Math.atan2(Math.sqrt(ve),Math.sqrt(1-ve));return this.R*Le}}),fe=6378137,Ie={R:fe,MAX_LATITUDE:85.0511287798,project:function(n){var c=Math.PI/180,h=this.MAX_LATITUDE,k=Math.max(Math.min(h,n.lat),-h),x=Math.sin(k*c);return new ae(this.R*n.lng*c,this.R*Math.log((1+x)/(1-x))/2)},unproject:function(n){var c=180/Math.PI;return new qe((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*c,n.x*c/this.R)},bounds:(function(){var n=fe*Math.PI;return new de([-n,-n],[n,n])})()};function Te(n,c,h,k){if(C(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=c,this._c=h,this._d=k}Te.prototype={transform:function(n,c){return this._transform(n.clone(),c)},_transform:function(n,c){return c=c||1,n.x=c*(this._a*n.x+this._b),n.y=c*(this._c*n.y+this._d),n},untransform:function(n,c){return c=c||1,new ae((n.x/c-this._b)/this._a,(n.y/c-this._d)/this._c)}};function W(n,c,h,k){return new Te(n,c,h,k)}var Y=s({},He,{code:"EPSG:3857",projection:Ie,transformation:(function(){var n=.5/(Math.PI*Ie.R);return W(n,.5,-n,.5)})()}),le=s({},Y,{code:"EPSG:900913"});function ye(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function ie(n,c){var h="",k,x,B,ee,ve,Le;for(k=0,B=n.length;k<B;k++){for(ve=n[k],x=0,ee=ve.length;x<ee;x++)Le=ve[x],h+=(x?"L":"M")+Le.x+" "+Le.y;h+=c?Qe.svg?"z":"x":""}return h||"M0 0"}var oe=document.documentElement.style,ce="ActiveXObject"in window,De=ce&&!document.addEventListener,we="msLaunchUri"in navigator&&!("documentMode"in document),te=ln("webkit"),ke=ln("android"),se=ln("android 2")||ln("android 3"),Q=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),X=ke&&ln("Google")&&Q<537&&!("AudioNode"in window),O=!!window.opera,q=!we&&ln("chrome"),J=ln("gecko")&&!te&&!O&&!ce,$e=!q&&ln("safari"),We=ln("phantom"),ot="OTransition"in oe,st=navigator.platform.indexOf("Win")===0,$t=ce&&"transition"in oe,Nt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!se,Pt="MozPerspective"in oe,jt=!window.L_DISABLE_3D&&($t||Nt||Pt)&&!ot&&!We,cn=typeof orientation<"u"||ln("mobile"),go=cn&&te,un=cn&&Nt,Ht=!window.PointerEvent&&window.MSPointerEvent,bt=!!(window.PointerEvent||Ht),qt="ontouchstart"in window||!!window.TouchEvent,yo=!window.L_NO_TOUCH&&(qt||bt),ko=cn&&O,Bn=cn&&J,Zt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Eo=(function(){var n=!1;try{var c=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",m,c),window.removeEventListener("testPassiveEventSupport",m,c)}catch{}return n})(),fs=(function(){return!!document.createElement("canvas").getContext})(),io=!!(document.createElementNS&&ye("svg").createSVGRect),Vt=!!io&&(function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Wn=!io&&(function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var c=n.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}})(),vn=navigator.platform.indexOf("Mac")===0,ns=navigator.platform.indexOf("Linux")===0;function ln(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var Qe={ie:ce,ielt9:De,edge:we,webkit:te,android:ke,android23:se,androidStock:X,opera:O,chrome:q,gecko:J,safari:$e,phantom:We,opera12:ot,win:st,ie3d:$t,webkit3d:Nt,gecko3d:Pt,any3d:jt,mobile:cn,mobileWebkit:go,mobileWebkit3d:un,msPointer:Ht,pointer:bt,touch:yo,touchNative:qt,mobileOpera:ko,mobileGecko:Bn,retina:Zt,passiveEvents:Eo,canvas:fs,svg:io,vml:Wn,inlineSvg:Vt,mac:vn,linux:ns},Po=Qe.msPointer?"MSPointerDown":"pointerdown",Kn=Qe.msPointer?"MSPointerMove":"pointermove",en=Qe.msPointer?"MSPointerUp":"pointerup",ao=Qe.msPointer?"MSPointerCancel":"pointercancel",Do={touchstart:Po,touchmove:Kn,touchend:en,touchcancel:ao},Ws={touchstart:ps,touchmove:lo,touchend:lo,touchcancel:lo},dn={},kn=!1;function Ro(n,c,h){return c==="touchstart"&&hn(),Ws[c]?(h=Ws[c].bind(this,h),n.addEventListener(Do[c],h,!1),h):(console.warn("wrong event specified:",c),m)}function _n(n,c,h){if(!Do[c]){console.warn("wrong event specified:",c);return}n.removeEventListener(Do[c],h,!1)}function Ks(n){dn[n.pointerId]=n}function Yn(n){dn[n.pointerId]&&(dn[n.pointerId]=n)}function Oo(n){delete dn[n.pointerId]}function hn(){kn||(document.addEventListener(Po,Ks,!0),document.addEventListener(Kn,Yn,!0),document.addEventListener(en,Oo,!0),document.addEventListener(ao,Oo,!0),kn=!0)}function lo(n,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var h in dn)c.touches.push(dn[h]);c.changedTouches=[c],n(c)}}function ps(n,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&nn(c),lo(n,c)}function Li(n){var c={},h,k;for(k in n)h=n[k],c[k]=h&&h.bind?h.bind(n):h;return n=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var Nn=200;function os(n,c){n.addEventListener("dblclick",c);var h=0,k;function x(B){if(B.detail!==1){k=B.detail;return}if(!(B.pointerType==="mouse"||B.sourceCapabilities&&!B.sourceCapabilities.firesTouchEvents)){var ee=sa(B);if(!(ee.some(function(Le){return Le instanceof HTMLLabelElement&&Le.attributes.for})&&!ee.some(function(Le){return Le instanceof HTMLInputElement||Le instanceof HTMLSelectElement}))){var ve=Date.now();ve-h<=Nn?(k++,k===2&&c(Li(B))):k=1,h=ve}}}return n.addEventListener("click",x),{dblclick:c,simDblclick:x}}function bn(n,c){n.removeEventListener("dblclick",c.dblclick),n.removeEventListener("click",c.simDblclick)}var vs=Xs(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),tn=Xs(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ro=tn==="webkitTransition"||tn==="OTransition"?tn+"End":"transitionend";function Bo(n){return typeof n=="string"?document.getElementById(n):n}function Jn(n,c){var h=n.style[c]||n.currentStyle&&n.currentStyle[c];if((!h||h==="auto")&&document.defaultView){var k=document.defaultView.getComputedStyle(n,null);h=k?k[c]:null}return h==="auto"?null:h}function kt(n,c,h){var k=document.createElement(n);return k.className=c||"",h&&h.appendChild(k),k}function Mt(n){var c=n.parentNode;c&&c.removeChild(n)}function ms(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function Fn(n){var c=n.parentNode;c&&c.lastChild!==n&&c.appendChild(n)}function _o(n){var c=n.parentNode;c&&c.firstChild!==n&&c.insertBefore(n,c.firstChild)}function Ys(n,c){if(n.classList!==void 0)return n.classList.contains(c);var h=No(n);return h.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(h)}function ht(n,c){if(n.classList!==void 0)for(var h=b(c),k=0,x=h.length;k<x;k++)n.classList.add(h[k]);else if(!Ys(n,c)){var B=No(n);Js(n,(B?B+" ":"")+c)}}function Gt(n,c){n.classList!==void 0?n.classList.remove(c):Js(n,_((" "+No(n)+" ").replace(" "+c+" "," ")))}function Js(n,c){n.className.baseVal===void 0?n.className=c:n.className.baseVal=c}function No(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function xn(n,c){"opacity"in n.style?n.style.opacity=c:"filter"in n.style&&Ua(n,c)}function Ua(n,c){var h=!1,k="DXImageTransform.Microsoft.Alpha";try{h=n.filters.item(k)}catch{if(c===1)return}c=Math.round(c*100),h?(h.Enabled=c!==100,h.Opacity=c):n.style.filter+=" progid:"+k+"(opacity="+c+")"}function Xs(n){for(var c=document.documentElement.style,h=0;h<n.length;h++)if(n[h]in c)return n[h];return!1}function Fo(n,c,h){var k=c||new ae(0,0);n.style[vs]=(Qe.ie3d?"translate("+k.x+"px,"+k.y+"px)":"translate3d("+k.x+"px,"+k.y+"px,0)")+(h?" scale("+h+")":"")}function Ft(n,c){n._leaflet_pos=c,Qe.any3d?Fo(n,c):(n.style.left=c.x+"px",n.style.top=c.y+"px")}function Uo(n){return n._leaflet_pos||new ae(0,0)}var gs,ys,Si;if("onselectstart"in document)gs=function(){rt(window,"selectstart",nn)},ys=function(){Ct(window,"selectstart",nn)};else{var Dt=Xs(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);gs=function(){if(Dt){var n=document.documentElement.style;Si=n[Dt],n[Dt]="none"}},ys=function(){Dt&&(document.documentElement.style[Dt]=Si,Si=void 0)}}function Qs(){rt(window,"dragstart",nn)}function zo(){Ct(window,"dragstart",nn)}var ks,ei;function ti(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(fn(),ks=n,ei=n.style.outlineStyle,n.style.outlineStyle="none",rt(window,"keydown",fn))}function fn(){ks&&(ks.style.outlineStyle=ei,ks=void 0,ei=void 0,Ct(window,"keydown",fn))}function bo(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function wo(n){var c=n.getBoundingClientRect();return{x:c.width/n.offsetWidth||1,y:c.height/n.offsetHeight||1,boundingClientRect:c}}var co={__proto__:null,TRANSFORM:vs,TRANSITION:tn,TRANSITION_END:ro,get:Bo,getStyle:Jn,create:kt,remove:Mt,empty:ms,toFront:Fn,toBack:_o,hasClass:Ys,addClass:ht,removeClass:Gt,setClass:Js,getClass:No,setOpacity:xn,testProp:Xs,setTransform:Fo,setPosition:Ft,getPosition:Uo,get disableTextSelection(){return gs},get enableTextSelection(){return ys},disableImageDrag:Qs,enableImageDrag:zo,preventOutline:ti,restoreOutline:fn,getSizedParentNode:bo,getScale:wo};function rt(n,c,h,k){if(c&&typeof c=="object")for(var x in c)Ho(n,x,c[x],h);else{c=b(c);for(var B=0,ee=c.length;B<ee;B++)Ho(n,c[B],h,k)}return this}var mn="_leaflet_events";function Ct(n,c,h,k){if(arguments.length===1)xi(n),delete n[mn];else if(c&&typeof c=="object")for(var x in c)Ii(n,x,c[x],h);else if(c=b(c),arguments.length===2)xi(n,function(ve){return A(c,ve)!==-1});else for(var B=0,ee=c.length;B<ee;B++)Ii(n,c[B],h,k);return this}function xi(n,c){for(var h in n[mn]){var k=h.split(/\d/)[0];(!c||c(k))&&Ii(n,k,null,null,h)}}var ni={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ho(n,c,h,k){var x=c+d(h)+(k?"_"+d(k):"");if(n[mn]&&n[mn][x])return this;var B=function(ve){return h.call(k||n,ve||window.event)},ee=B;!Qe.touchNative&&Qe.pointer&&c.indexOf("touch")===0?B=Ro(n,c,B):Qe.touch&&c==="dblclick"?B=os(n,B):"addEventListener"in n?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?n.addEventListener(ni[c]||c,B,Qe.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(B=function(ve){ve=ve||window.event,Ti(n,ve)&&ee(ve)},n.addEventListener(ni[c],B,!1)):n.addEventListener(c,ee,!1):n.attachEvent("on"+c,B),n[mn]=n[mn]||{},n[mn][x]=B}function Ii(n,c,h,k,x){x=x||c+d(h)+(k?"_"+d(k):"");var B=n[mn]&&n[mn][x];if(!B)return this;!Qe.touchNative&&Qe.pointer&&c.indexOf("touch")===0?_n(n,c,B):Qe.touch&&c==="dblclick"?bn(n,B):"removeEventListener"in n?n.removeEventListener(ni[c]||c,B,!1):n.detachEvent("on"+c,B),n[mn][x]=null}function Co(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function _s(n){return Ho(n,"wheel",Co),this}function bs(n){return rt(n,"mousedown touchstart dblclick contextmenu",Co),n._leaflet_disable_click=!0,this}function nn(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function Un(n){return nn(n),Co(n),this}function sa(n){if(n.composedPath)return n.composedPath();for(var c=[],h=n.target;h;)c.push(h),h=h.parentNode;return c}function ia(n,c){if(!c)return new ae(n.clientX,n.clientY);var h=wo(c),k=h.boundingClientRect;return new ae((n.clientX-k.left)/h.x-c.clientLeft,(n.clientY-k.top)/h.y-c.clientTop)}var $i=Qe.linux&&Qe.chrome?window.devicePixelRatio:Qe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function uo(n){return Qe.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/$i:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function Ti(n,c){var h=c.relatedTarget;if(!h)return!0;try{for(;h&&h!==n;)h=h.parentNode}catch{return!1}return h!==n}var aa={__proto__:null,on:rt,off:Ct,stopPropagation:Co,disableScrollPropagation:_s,disableClickPropagation:bs,preventDefault:nn,stop:Un,getPropagationPath:sa,getMousePosition:ia,getWheelDelta:uo,isExternalTarget:Ti,addListener:rt,removeListener:Ct},Mi=Fe.extend({run:function(n,c,h,k){this.stop(),this._el=n,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(k||.5,.2),this._startPos=Uo(n),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=U(this._animate,this),this._step()},_step:function(n){var c=+new Date-this._startTime,h=this._duration*1e3;c<h?this._runFrame(this._easeOut(c/h),n):(this._runFrame(1),this._complete())},_runFrame:function(n,c){var h=this._startPos.add(this._offset.multiplyBy(n));c&&h._round(),Ft(this._el,h),this.fire("step")},_complete:function(){K(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),pt=Fe.extend({options:{crs:Y,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,c){c=S(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(tt(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=tn&&Qe.any3d&&!Qe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),rt(this._proxy,ro,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,c,h){if(c=c===void 0?this._zoom:this._limitZoom(c),n=this._limitCenter(tt(n),c,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=s({animate:h.animate},h.zoom),h.pan=s({animate:h.animate,duration:h.duration},h.pan));var k=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,c,h.zoom):this._tryAnimatedPan(n,h.pan);if(k)return clearTimeout(this._sizeTimer),this}return this._resetView(n,c,h.pan&&h.pan.noMoveStart),this},setZoom:function(n,c){return this._loaded?this.setView(this.getCenter(),n,{zoom:c}):(this._zoom=n,this)},zoomIn:function(n,c){return n=n||(Qe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,c)},zoomOut:function(n,c){return n=n||(Qe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,c)},setZoomAround:function(n,c,h){var k=this.getZoomScale(c),x=this.getSize().divideBy(2),B=n instanceof ae?n:this.latLngToContainerPoint(n),ee=B.subtract(x).multiplyBy(1-1/k),ve=this.containerPointToLatLng(x.add(ee));return this.setView(ve,c,{zoom:h})},_getBoundsCenterZoom:function(n,c){c=c||{},n=n.getBounds?n.getBounds():et(n);var h=ge(c.paddingTopLeft||c.padding||[0,0]),k=ge(c.paddingBottomRight||c.padding||[0,0]),x=this.getBoundsZoom(n,!1,h.add(k));if(x=typeof c.maxZoom=="number"?Math.min(c.maxZoom,x):x,x===1/0)return{center:n.getCenter(),zoom:x};var B=k.subtract(h).divideBy(2),ee=this.project(n.getSouthWest(),x),ve=this.project(n.getNorthEast(),x),Le=this.unproject(ee.add(ve).divideBy(2).add(B),x);return{center:Le,zoom:x}},fitBounds:function(n,c){if(n=et(n),!n.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(n,c);return this.setView(h.center,h.zoom,c)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,c){return this.setView(n,this._zoom,{pan:c})},panBy:function(n,c){if(n=ge(n).round(),c=c||{},!n.x&&!n.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Mi,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){ht(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,h,c.duration||.25,c.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,c,h){if(h=h||{},h.animate===!1||!Qe.any3d)return this.setView(n,c,h);this._stop();var k=this.project(this.getCenter()),x=this.project(n),B=this.getSize(),ee=this._zoom;n=tt(n),c=c===void 0?ee:c;var ve=Math.max(B.x,B.y),Le=ve*this.getZoomScale(ee,c),Ne=x.distanceTo(k)||1,Ye=1.42,ct=Ye*Ye;function _t(rn){var Wl=rn?-1:1,jv=rn?Le:ve,Zv=Le*Le-ve*ve+Wl*ct*ct*Ne*Ne,qv=2*jv*ct*Ne,pc=Zv/qv,hd=Math.sqrt(pc*pc+1)-pc,Wv=hd<1e-9?-18:Math.log(hd);return Wv}function Hn(rn){return(Math.exp(rn)-Math.exp(-rn))/2}function gn(rn){return(Math.exp(rn)+Math.exp(-rn))/2}function Io(rn){return Hn(rn)/gn(rn)}var Qn=_t(0);function va(rn){return ve*(gn(Qn)/gn(Qn+Ye*rn))}function zv(rn){return ve*(gn(Qn)*Io(Qn+Ye*rn)-Hn(Qn))/ct}function Hv(rn){return 1-Math.pow(1-rn,1.5)}var Vv=Date.now(),ud=(_t(1)-Qn)/Ye,Gv=h.duration?1e3*h.duration:1e3*ud*.8;function dd(){var rn=(Date.now()-Vv)/Gv,Wl=Hv(rn)*ud;rn<=1?(this._flyToFrame=U(dd,this),this._move(this.unproject(k.add(x.subtract(k).multiplyBy(zv(Wl)/Ne)),ee),this.getScaleZoom(ve/va(Wl),ee),{flyTo:!0})):this._move(n,c)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),dd.call(this),this},flyToBounds:function(n,c){var h=this._getBoundsCenterZoom(n,c);return this.flyTo(h.center,h.zoom,c)},setMaxBounds:function(n){return n=et(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var c=this.options.minZoom;return this.options.minZoom=n,this._loaded&&c!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var c=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&c!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,c){this._enforcingBounds=!0;var h=this.getCenter(),k=this._limitCenter(h,this._zoom,et(n));return h.equals(k)||this.panTo(k,c),this._enforcingBounds=!1,this},panInside:function(n,c){c=c||{};var h=ge(c.paddingTopLeft||c.padding||[0,0]),k=ge(c.paddingBottomRight||c.padding||[0,0]),x=this.project(this.getCenter()),B=this.project(n),ee=this.getPixelBounds(),ve=Oe([ee.min.add(h),ee.max.subtract(k)]),Le=ve.getSize();if(!ve.contains(B)){this._enforcingBounds=!0;var Ne=B.subtract(ve.getCenter()),Ye=ve.extend(B).getSize().subtract(Le);x.x+=Ne.x<0?-Ye.x:Ye.x,x.y+=Ne.y<0?-Ye.y:Ye.y,this.panTo(this.unproject(x),c),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=s({animate:!1,pan:!0},n===!0?{animate:!0}:n);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),k=c.divideBy(2).round(),x=h.divideBy(2).round(),B=k.subtract(x);return!B.x&&!B.y?this:(n.animate&&n.pan?this.panBy(B):(n.pan&&this._rawPanBy(B),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=s({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=l(this._handleGeolocationResponse,this),h=l(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,h,n):navigator.geolocation.getCurrentPosition(c,h,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var c=n.code,h=n.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var c=n.coords.latitude,h=n.coords.longitude,k=new qe(c,h),x=k.toBounds(n.coords.accuracy*2),B=this._locateOptions;if(B.setView){var ee=this.getBoundsZoom(x);this.setView(k,B.maxZoom?Math.min(ee,B.maxZoom):ee)}var ve={latlng:k,bounds:x,timestamp:n.timestamp};for(var Le in n.coords)typeof n.coords[Le]=="number"&&(ve[Le]=n.coords[Le]);this.fire("locationfound",ve)}},addHandler:function(n,c){if(!c)return this;var h=this[n]=new c(this);return this._handlers.push(h),this.options[n]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Mt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(K(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)Mt(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,c){var h="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),k=kt("div",h,c||this._mapPane);return n&&(this._panes[n]=k),k},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),c=this.unproject(n.getBottomLeft()),h=this.unproject(n.getTopRight());return new Xe(c,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,c,h){n=et(n),h=ge(h||[0,0]);var k=this.getZoom()||0,x=this.getMinZoom(),B=this.getMaxZoom(),ee=n.getNorthWest(),ve=n.getSouthEast(),Le=this.getSize().subtract(h),Ne=Oe(this.project(ve,k),this.project(ee,k)).getSize(),Ye=Qe.any3d?this.options.zoomSnap:1,ct=Le.x/Ne.x,_t=Le.y/Ne.y,Hn=c?Math.max(ct,_t):Math.min(ct,_t);return k=this.getScaleZoom(Hn,k),Ye&&(k=Math.round(k/(Ye/100))*(Ye/100),k=c?Math.ceil(k/Ye)*Ye:Math.floor(k/Ye)*Ye),Math.max(x,Math.min(B,k))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ae(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,c){var h=this._getTopLeftPoint(n,c);return new de(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,c){var h=this.options.crs;return c=c===void 0?this._zoom:c,h.scale(n)/h.scale(c)},getScaleZoom:function(n,c){var h=this.options.crs;c=c===void 0?this._zoom:c;var k=h.zoom(n*h.scale(c));return isNaN(k)?1/0:k},project:function(n,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(tt(n),c)},unproject:function(n,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(ge(n),c)},layerPointToLatLng:function(n){var c=ge(n).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(n){var c=this.project(tt(n))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(tt(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(et(n))},distance:function(n,c){return this.options.crs.distance(tt(n),tt(c))},containerPointToLayerPoint:function(n){return ge(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return ge(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var c=this.containerPointToLayerPoint(ge(n));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(tt(n)))},mouseEventToContainerPoint:function(n){return ia(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var c=this._container=Bo(n);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");rt(c,"scroll",this._onScroll,this),this._containerId=d(c)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&Qe.any3d,ht(n,"leaflet-container"+(Qe.touch?" leaflet-touch":"")+(Qe.retina?" leaflet-retina":"")+(Qe.ielt9?" leaflet-oldie":"")+(Qe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=Jn(n,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ft(this._mapPane,new ae(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ht(n.markerPane,"leaflet-zoom-hide"),ht(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,c,h){Ft(this._mapPane,new ae(0,0));var k=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var x=this._zoom!==c;this._moveStart(x,h)._move(n,c)._moveEnd(x),this.fire("viewreset"),k&&this.fire("load")},_moveStart:function(n,c){return n&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(n,c,h,k){c===void 0&&(c=this._zoom);var x=this._zoom!==c;return this._zoom=c,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),k?h&&h.pinch&&this.fire("zoom",h):((x||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return K(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){Ft(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[d(this._container)]=this;var c=n?Ct:rt;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),Qe.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){K(this._resizeRequest),this._resizeRequest=U(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,c){for(var h=[],k,x=c==="mouseout"||c==="mouseover",B=n.target||n.srcElement,ee=!1;B;){if(k=this._targets[d(B)],k&&(c==="click"||c==="preclick")&&this._draggableMoved(k)){ee=!0;break}if(k&&k.listens(c,!0)&&(x&&!Ti(B,n)||(h.push(k),x))||B===this._container)break;B=B.parentNode}return!h.length&&!ee&&!x&&this.listens(c,!0)&&(h=[this]),h},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var c=n.target||n.srcElement;if(!(!this._loaded||c._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(c))){var h=n.type;h==="mousedown"&&ti(c),this._fireDOMEvent(n,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,c,h){if(n.type==="click"){var k=s({},n);k.type="preclick",this._fireDOMEvent(k,k.type,h)}var x=this._findEventTargets(n,c);if(h){for(var B=[],ee=0;ee<h.length;ee++)h[ee].listens(c,!0)&&B.push(h[ee]);x=B.concat(x)}if(x.length){c==="contextmenu"&&nn(n);var ve=x[0],Le={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var Ne=ve.getLatLng&&(!ve._radius||ve._radius<=10);Le.containerPoint=Ne?this.latLngToContainerPoint(ve.getLatLng()):this.mouseEventToContainerPoint(n),Le.layerPoint=this.containerPointToLayerPoint(Le.containerPoint),Le.latlng=Ne?ve.getLatLng():this.layerPointToLatLng(Le.layerPoint)}for(ee=0;ee<x.length;ee++)if(x[ee].fire(c,Le,!0),Le.originalEvent._stopped||x[ee].options.bubblingMouseEvents===!1&&A(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,c=this._handlers.length;n<c;n++)this._handlers[n].disable()},whenReady:function(n,c){return this._loaded?n.call(c||this,{target:this}):this.on("load",n,c),this},_getMapPanePos:function(){return Uo(this._mapPane)||new ae(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,c){var h=n&&c!==void 0?this._getNewPixelOrigin(n,c):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,c){var h=this.getSize()._divideBy(2);return this.project(n,c)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,c,h){var k=this._getNewPixelOrigin(h,c);return this.project(n,c)._subtract(k)},_latLngBoundsToNewLayerBounds:function(n,c,h){var k=this._getNewPixelOrigin(h,c);return Oe([this.project(n.getSouthWest(),c)._subtract(k),this.project(n.getNorthWest(),c)._subtract(k),this.project(n.getSouthEast(),c)._subtract(k),this.project(n.getNorthEast(),c)._subtract(k)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,c,h){if(!h)return n;var k=this.project(n,c),x=this.getSize().divideBy(2),B=new de(k.subtract(x),k.add(x)),ee=this._getBoundsOffset(B,h,c);return Math.abs(ee.x)<=1&&Math.abs(ee.y)<=1?n:this.unproject(k.add(ee),c)},_limitOffset:function(n,c){if(!c)return n;var h=this.getPixelBounds(),k=new de(h.min.add(n),h.max.add(n));return n.add(this._getBoundsOffset(k,c))},_getBoundsOffset:function(n,c,h){var k=Oe(this.project(c.getNorthEast(),h),this.project(c.getSouthWest(),h)),x=k.min.subtract(n.min),B=k.max.subtract(n.max),ee=this._rebound(x.x,-B.x),ve=this._rebound(x.y,-B.y);return new ae(ee,ve)},_rebound:function(n,c){return n+c>0?Math.round(n-c)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(c))},_limitZoom:function(n){var c=this.getMinZoom(),h=this.getMaxZoom(),k=Qe.any3d?this.options.zoomSnap:1;return k&&(n=Math.round(n/k)*k),Math.max(c,Math.min(h,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Gt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,c){var h=this._getCenterOffset(n)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,c),!0)},_createAnimProxy:function(){var n=this._proxy=kt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(c){var h=vs,k=this._proxy.style[h];Fo(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),k===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Mt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),c=this.getZoom();Fo(this._proxy,this.project(n,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,c,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var k=this.getZoomScale(c),x=this._getCenterOffset(n)._divideBy(1-1/k);return h.animate!==!0&&!this.getSize().contains(x)?!1:(U(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(n,c,!0)},this),!0)},_animateZoom:function(n,c,h,k){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=c,ht(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:c,noUpdate:k}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Gt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function za(n,c){return new pt(n,c)}var zn=Pe.extend({options:{position:"topright"},initialize:function(n){S(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var c=this._map;return c&&c.removeControl(this),this.options.position=n,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var c=this._container=this.onAdd(n),h=this.getPosition(),k=n._controlCorners[h];return ht(c,"leaflet-control"),h.indexOf("bottom")!==-1?k.insertBefore(c,k.firstChild):k.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Mt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),ws=function(n){return new zn(n)};pt.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},c="leaflet-",h=this._controlContainer=kt("div",c+"control-container",this._container);function k(x,B){var ee=c+x+" "+c+B;n[x+B]=kt("div",ee,h)}k("top","left"),k("top","right"),k("bottom","left"),k("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)Mt(this._controlCorners[n]);Mt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Cs=zn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,c,h,k){return h<k?-1:k<h?1:0}},initialize:function(n,c,h){S(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var k in n)this._addLayer(n[k],k);for(k in c)this._addLayer(c[k],k,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return zn.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,c){return this._addLayer(n,c),this._map?this._update():this},addOverlay:function(n,c){return this._addLayer(n,c,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var c=this._getLayer(d(n));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){ht(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(ht(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):Gt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Gt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",c=this._container=kt("div",n),h=this.options.collapsed;c.setAttribute("aria-haspopup",!0),bs(c),_s(c);var k=this._section=kt("section",n+"-list");h&&(this._map.on("click",this.collapse,this),rt(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var x=this._layersLink=kt("a",n+"-toggle",c);x.href="#",x.title="Layers",x.setAttribute("role","button"),rt(x,{keydown:function(B){B.keyCode===13&&this._expandSafely()},click:function(B){nn(B),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=kt("div",n+"-base",k),this._separator=kt("div",n+"-separator",k),this._overlaysList=kt("div",n+"-overlays",k),c.appendChild(k)},_getLayer:function(n){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&d(this._layers[c].layer)===n)return this._layers[c]},_addLayer:function(n,c,h){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:c,overlay:h}),this.options.sortLayers&&this._layers.sort(l(function(k,x){return this.options.sortFunction(k.layer,x.layer,k.name,x.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ms(this._baseLayersList),ms(this._overlaysList),this._layerControlInputs=[];var n,c,h,k,x=0;for(h=0;h<this._layers.length;h++)k=this._layers[h],this._addItem(k),c=c||k.overlay,n=n||!k.overlay,x+=k.overlay?0:1;return this.options.hideSingleBase&&(n=n&&x>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=c&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var c=this._getLayer(d(n.target)),h=c.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;h&&this._map.fire(h,c)},_createRadioElement:function(n,c){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(c?' checked="checked"':"")+"/>",k=document.createElement("div");return k.innerHTML=h,k.firstChild},_addItem:function(n){var c=document.createElement("label"),h=this._map.hasLayer(n.layer),k;n.overlay?(k=document.createElement("input"),k.type="checkbox",k.className="leaflet-control-layers-selector",k.defaultChecked=h):k=this._createRadioElement("leaflet-base-layers_"+d(this),h),this._layerControlInputs.push(k),k.layerId=d(n.layer),rt(k,"click",this._onInputClick,this);var x=document.createElement("span");x.innerHTML=" "+n.name;var B=document.createElement("span");c.appendChild(B),B.appendChild(k),B.appendChild(x);var ee=n.overlay?this._overlaysList:this._baseLayersList;return ee.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,c,h,k=[],x=[];this._handlingClick=!0;for(var B=n.length-1;B>=0;B--)c=n[B],h=this._getLayer(c.layerId).layer,c.checked?k.push(h):c.checked||x.push(h);for(B=0;B<x.length;B++)this._map.hasLayer(x[B])&&this._map.removeLayer(x[B]);for(B=0;B<k.length;B++)this._map.hasLayer(k[B])||this._map.addLayer(k[B]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,c,h,k=this._map.getZoom(),x=n.length-1;x>=0;x--)c=n[x],h=this._getLayer(c.layerId).layer,c.disabled=h.options.minZoom!==void 0&&k<h.options.minZoom||h.options.maxZoom!==void 0&&k>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,rt(n,"click",nn),this.expand();var c=this;setTimeout(function(){Ct(n,"click",nn),c._preventClick=!1})}}),oi=function(n,c,h){return new Cs(n,c,h)},Ai=zn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var c="leaflet-control-zoom",h=kt("div",c+" leaflet-bar"),k=this.options;return this._zoomInButton=this._createButton(k.zoomInText,k.zoomInTitle,c+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(k.zoomOutText,k.zoomOutTitle,c+"-out",h,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,c,h,k,x){var B=kt("a",h,k);return B.innerHTML=n,B.href="#",B.title=c,B.setAttribute("role","button"),B.setAttribute("aria-label",c),bs(B),rt(B,"click",Un),rt(B,"click",x,this),rt(B,"click",this._refocusOnMap,this),B},_updateDisabled:function(){var n=this._map,c="leaflet-disabled";Gt(this._zoomInButton,c),Gt(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(ht(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(ht(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});pt.mergeOptions({zoomControl:!0}),pt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ai,this.addControl(this.zoomControl))});var si=function(n){return new Ai(n)},Ei=zn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var c="leaflet-control-scale",h=kt("div",c),k=this.options;return this._addScales(k,c+"-line",h),n.on(k.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),h},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,c,h){n.metric&&(this._mScale=kt("div",c,h)),n.imperial&&(this._iScale=kt("div",c,h))},_update:function(){var n=this._map,c=n.getSize().y/2,h=n.distance(n.containerPointToLatLng([0,c]),n.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(h)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var c=this._getRoundNum(n),h=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,h,c/n)},_updateImperial:function(n){var c=n*3.2808399,h,k,x;c>5280?(h=c/5280,k=this._getRoundNum(h),this._updateScale(this._iScale,k+" mi",k/h)):(x=this._getRoundNum(c),this._updateScale(this._iScale,x+" ft",x/c))},_updateScale:function(n,c,h){n.style.width=Math.round(this.options.maxWidth*h)+"px",n.innerHTML=c},_getRoundNum:function(n){var c=Math.pow(10,(Math.floor(n)+"").length-1),h=n/c;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,c*h}}),Ha=function(n){return new Ei(n)},Va='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Pi=zn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Qe.inlineSvg?Va+" ":"")+"Leaflet</a>"},initialize:function(n){S(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=kt("div","leaflet-control-attribution"),bs(this._container);for(var c in n._layers)n._layers[c].getAttribution&&this.addAttribution(n._layers[c].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var c in this._attributions)this._attributions[c]&&n.push(c);var h=[];this.options.prefix&&h.push(this.options.prefix),n.length&&h.push(n.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});pt.mergeOptions({attributionControl:!0}),pt.addInitHook(function(){this.options.attributionControl&&new Pi().addTo(this)});var ii=function(n){return new Pi(n)};zn.Layers=Cs,zn.Zoom=Ai,zn.Scale=Ei,zn.Attribution=Pi,ws.layers=oi,ws.zoom=si,ws.scale=Ha,ws.attribution=ii;var Xn=Pe.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Xn.addTo=function(n,c){return n.addHandler(c,this),this};var Ls={Events:Ae},Di=Qe.touch?"touchstart mousedown":"mousedown",Lo=Fe.extend({options:{clickTolerance:3},initialize:function(n,c,h,k){S(this,k),this._element=n,this._dragStartTarget=c||n,this._preventOutline=h},enable:function(){this._enabled||(rt(this._dragStartTarget,Di,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Lo._dragging===this&&this.finishDrag(!0),Ct(this._dragStartTarget,Di,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!Ys(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){Lo._dragging===this&&this.finishDrag();return}if(!(Lo._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(Lo._dragging=this,this._preventOutline&&ti(this._element),Qs(),gs(),!this._moving)){this.fire("down");var c=n.touches?n.touches[0]:n,h=bo(this._element);this._startPoint=new ae(c.clientX,c.clientY),this._startPos=Uo(this._element),this._parentScale=wo(h);var k=n.type==="mousedown";rt(document,k?"mousemove":"touchmove",this._onMove,this),rt(document,k?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var c=n.touches&&n.touches.length===1?n.touches[0]:n,h=new ae(c.clientX,c.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,nn(n),this._moved||(this.fire("dragstart"),this._moved=!0,ht(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ht(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),Ft(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){Gt(document.body,"leaflet-dragging"),this._lastTarget&&(Gt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ct(document,"mousemove touchmove",this._onMove,this),Ct(document,"mouseup touchend touchcancel",this._onUp,this),zo(),ys();var c=this._moved&&this._moving;this._moving=!1,Lo._dragging=!1,c&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function z(n,c,h){var k,x=[1,4,2,8],B,ee,ve,Le,Ne,Ye,ct,_t;for(B=0,Ye=n.length;B<Ye;B++)n[B]._code=It(n[B],c);for(ve=0;ve<4;ve++){for(ct=x[ve],k=[],B=0,Ye=n.length,ee=Ye-1;B<Ye;ee=B++)Le=n[B],Ne=n[ee],Le._code&ct?Ne._code&ct||(_t=Tt(Ne,Le,ct,c,h),_t._code=It(_t,c),k.push(_t)):(Ne._code&ct&&(_t=Tt(Ne,Le,ct,c,h),_t._code=It(_t,c),k.push(_t)),k.push(Le));n=k}return n}function j(n,c){var h,k,x,B,ee,ve,Le,Ne,Ye;if(!n||n.length===0)throw new Error("latlngs not passed");In(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var ct=tt([0,0]),_t=et(n),Hn=_t.getNorthWest().distanceTo(_t.getSouthWest())*_t.getNorthEast().distanceTo(_t.getNorthWest());Hn<1700&&(ct=he(n));var gn=n.length,Io=[];for(h=0;h<gn;h++){var Qn=tt(n[h]);Io.push(c.project(tt([Qn.lat-ct.lat,Qn.lng-ct.lng])))}for(ve=Le=Ne=0,h=0,k=gn-1;h<gn;k=h++)x=Io[h],B=Io[k],ee=x.y*B.x-B.y*x.x,Le+=(x.x+B.x)*ee,Ne+=(x.y+B.y)*ee,ve+=ee*3;ve===0?Ye=Io[0]:Ye=[Le/ve,Ne/ve];var va=c.unproject(ge(Ye));return tt([va.lat+ct.lat,va.lng+ct.lng])}function he(n){for(var c=0,h=0,k=0,x=0;x<n.length;x++){var B=tt(n[x]);c+=B.lat,h+=B.lng,k++}return tt([c/k,h/k])}var Ce={__proto__:null,clipPolygon:z,polygonCenter:j,centroid:he};function Re(n,c){if(!c||!n.length)return n.slice();var h=c*c;return n=Wt(n,h),n=gt(n,h),n}function Je(n,c,h){return Math.sqrt(ho(n,c,h,!0))}function at(n,c,h){return ho(n,c,h)}function gt(n,c){var h=n.length,k=typeof Uint8Array<"u"?Uint8Array:Array,x=new k(h);x[0]=x[h-1]=1,yt(n,x,c,0,h-1);var B,ee=[];for(B=0;B<h;B++)x[B]&&ee.push(n[B]);return ee}function yt(n,c,h,k,x){var B=0,ee,ve,Le;for(ve=k+1;ve<=x-1;ve++)Le=ho(n[ve],n[k],n[x],!0),Le>B&&(ee=ve,B=Le);B>h&&(c[ee]=1,yt(n,c,h,k,ee),yt(n,c,h,ee,x))}function Wt(n,c){for(var h=[n[0]],k=1,x=0,B=n.length;k<B;k++)on(n[k],n[x])>c&&(h.push(n[k]),x=k);return x<B-1&&h.push(n[B-1]),h}var wt;function mt(n,c,h,k,x){var B=k?wt:It(n,h),ee=It(c,h),ve,Le,Ne;for(wt=ee;;){if(!(B|ee))return[n,c];if(B&ee)return!1;ve=B||ee,Le=Tt(n,c,ve,h,x),Ne=It(Le,h),ve===B?(n=Le,B=Ne):(c=Le,ee=Ne)}}function Tt(n,c,h,k,x){var B=c.x-n.x,ee=c.y-n.y,ve=k.min,Le=k.max,Ne,Ye;return h&8?(Ne=n.x+B*(Le.y-n.y)/ee,Ye=Le.y):h&4?(Ne=n.x+B*(ve.y-n.y)/ee,Ye=ve.y):h&2?(Ne=Le.x,Ye=n.y+ee*(Le.x-n.x)/B):h&1&&(Ne=ve.x,Ye=n.y+ee*(ve.x-n.x)/B),new ae(Ne,Ye,x)}function It(n,c){var h=0;return n.x<c.min.x?h|=1:n.x>c.max.x&&(h|=2),n.y<c.min.y?h|=4:n.y>c.max.y&&(h|=8),h}function on(n,c){var h=c.x-n.x,k=c.y-n.y;return h*h+k*k}function ho(n,c,h,k){var x=c.x,B=c.y,ee=h.x-x,ve=h.y-B,Le=ee*ee+ve*ve,Ne;return Le>0&&(Ne=((n.x-x)*ee+(n.y-B)*ve)/Le,Ne>1?(x=h.x,B=h.y):Ne>0&&(x+=ee*Ne,B+=ve*Ne)),ee=n.x-x,ve=n.y-B,k?ee*ee+ve*ve:new ae(x,B)}function In(n){return!C(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function Ul(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),In(n)}function zl(n,c){var h,k,x,B,ee,ve,Le,Ne;if(!n||n.length===0)throw new Error("latlngs not passed");In(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var Ye=tt([0,0]),ct=et(n),_t=ct.getNorthWest().distanceTo(ct.getSouthWest())*ct.getNorthEast().distanceTo(ct.getNorthWest());_t<1700&&(Ye=he(n));var Hn=n.length,gn=[];for(h=0;h<Hn;h++){var Io=tt(n[h]);gn.push(c.project(tt([Io.lat-Ye.lat,Io.lng-Ye.lng])))}for(h=0,k=0;h<Hn-1;h++)k+=gn[h].distanceTo(gn[h+1])/2;if(k===0)Ne=gn[0];else for(h=0,B=0;h<Hn-1;h++)if(ee=gn[h],ve=gn[h+1],x=ee.distanceTo(ve),B+=x,B>k){Le=(B-k)/x,Ne=[ve.x-Le*(ve.x-ee.x),ve.y-Le*(ve.y-ee.y)];break}var Qn=c.unproject(ge(Ne));return tt([Qn.lat+Ye.lat,Qn.lng+Ye.lng])}var ic={__proto__:null,simplify:Re,pointToSegmentDistance:Je,closestPointOnSegment:at,clipSegment:mt,_getEdgeIntersection:Tt,_getBitCode:It,_sqClosestPointOnSegment:ho,isFlat:In,_flat:Ul,polylineCenter:zl},Ga={project:function(n){return new ae(n.lng,n.lat)},unproject:function(n){return new qe(n.y,n.x)},bounds:new de([-180,-90],[180,90])},ja={R:6378137,R_MINOR:6356752314245179e-9,bounds:new de([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var c=Math.PI/180,h=this.R,k=n.lat*c,x=this.R_MINOR/h,B=Math.sqrt(1-x*x),ee=B*Math.sin(k),ve=Math.tan(Math.PI/4-k/2)/Math.pow((1-ee)/(1+ee),B/2);return k=-h*Math.log(Math.max(ve,1e-10)),new ae(n.lng*c*h,k)},unproject:function(n){for(var c=180/Math.PI,h=this.R,k=this.R_MINOR/h,x=Math.sqrt(1-k*k),B=Math.exp(-n.y/h),ee=Math.PI/2-2*Math.atan(B),ve=0,Le=.1,Ne;ve<15&&Math.abs(Le)>1e-7;ve++)Ne=x*Math.sin(ee),Ne=Math.pow((1-Ne)/(1+Ne),x/2),Le=Math.PI/2-2*Math.atan(B*Ne)-ee,ee+=Le;return new qe(ee*c,n.x*c/h)}},ac={__proto__:null,LonLat:Ga,Mercator:ja,SphericalMercator:Ie},lc=s({},He,{code:"EPSG:3395",projection:ja,transformation:(function(){var n=.5/(Math.PI*ja.R);return W(n,.5,-n,.5)})()}),Hl=s({},He,{code:"EPSG:4326",projection:Ga,transformation:W(1/180,1,-1/180,.5)}),rc=s({},be,{projection:Ga,transformation:W(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,c){var h=c.lng-n.lng,k=c.lat-n.lat;return Math.sqrt(h*h+k*k)},infinite:!0});be.Earth=He,be.EPSG3395=lc,be.EPSG3857=Y,be.EPSG900913=le,be.EPSG4326=Hl,be.Simple=rc;var $n=Fe.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[d(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[d(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var c=n.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var h=this.getEvents();c.on(h,this),this.once("remove",function(){c.off(h,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});pt.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var c=d(n);return this._layers[c]?this:(this._layers[c]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var c=d(n);return this._layers[c]?(this._loaded&&n.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return d(n)in this._layers},eachLayer:function(n,c){for(var h in this._layers)n.call(c,this._layers[h]);return this},_addLayers:function(n){n=n?C(n)?n:[n]:[];for(var c=0,h=n.length;c<h;c++)this.addLayer(n[c])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[d(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var c=d(n);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,c=-1/0,h=this._getZoomSpan();for(var k in this._zoomBoundLayers){var x=this._zoomBoundLayers[k].options;n=x.minZoom===void 0?n:Math.min(n,x.minZoom),c=x.maxZoom===void 0?c:Math.max(c,x.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=n===1/0?void 0:n,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ai=$n.extend({initialize:function(n,c){S(this,c),this._layers={};var h,k;if(n)for(h=0,k=n.length;h<k;h++)this.addLayer(n[h])},addLayer:function(n){var c=this.getLayerId(n);return this._layers[c]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var c=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(n){var c=typeof n=="number"?n:this.getLayerId(n);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var c=Array.prototype.slice.call(arguments,1),h,k;for(h in this._layers)k=this._layers[h],k[n]&&k[n].apply(k,c);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,c){for(var h in this._layers)n.call(c,this._layers[h]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return d(n)}}),la=function(n,c){return new ai(n,c)},Vo=ai.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),ai.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),ai.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new Xe;for(var c in this._layers){var h=this._layers[c];n.extend(h.getBounds?h.getBounds():h.getLatLng())}return n}}),Vl=function(n,c){return new Vo(n,c)},ss=Pe.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){S(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,c){var h=this._getIconUrl(n);if(!h){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var k=this._createImg(h,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(k,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(k.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),k},_setIconStyles:function(n,c){var h=this.options,k=h[c+"Size"];typeof k=="number"&&(k=[k,k]);var x=ge(k),B=ge(c==="shadow"&&h.shadowAnchor||h.iconAnchor||x&&x.divideBy(2,!0));n.className="leaflet-marker-"+c+" "+(h.className||""),B&&(n.style.marginLeft=-B.x+"px",n.style.marginTop=-B.y+"px"),x&&(n.style.width=x.x+"px",n.style.height=x.y+"px")},_createImg:function(n,c){return c=c||document.createElement("img"),c.src=n,c},_getIconUrl:function(n){return Qe.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function Za(n){return new ss(n)}var Ri=ss.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof Ri.imagePath!="string"&&(Ri.imagePath=this._detectIconPath()),(this.options.imagePath||Ri.imagePath)+ss.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var c=function(h,k,x){var B=k.exec(h);return B&&B[x]};return n=c(n,/^url\((['"])?(.+)\1\)$/,2),n&&c(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=kt("div","leaflet-default-icon-path",document.body),c=Jn(n,"background-image")||Jn(n,"backgroundImage");if(document.body.removeChild(n),c=this._stripUrl(c),c)return c;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),Gl=Xn.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new Lo(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ht(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Gt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var c=this._marker,h=c._map,k=this._marker.options.autoPanSpeed,x=this._marker.options.autoPanPadding,B=Uo(c._icon),ee=h.getPixelBounds(),ve=h.getPixelOrigin(),Le=Oe(ee.min._subtract(ve).add(x),ee.max._subtract(ve).subtract(x));if(!Le.contains(B)){var Ne=ge((Math.max(Le.max.x,B.x)-Le.max.x)/(ee.max.x-Le.max.x)-(Math.min(Le.min.x,B.x)-Le.min.x)/(ee.min.x-Le.min.x),(Math.max(Le.max.y,B.y)-Le.max.y)/(ee.max.y-Le.max.y)-(Math.min(Le.min.y,B.y)-Le.min.y)/(ee.min.y-Le.min.y)).multiplyBy(k);h.panBy(Ne,{animate:!1}),this._draggable._newPos._add(Ne),this._draggable._startPos._add(Ne),Ft(c._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=U(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(K(this._panRequest),this._panRequest=U(this._adjustPan.bind(this,n)))},_onDrag:function(n){var c=this._marker,h=c._shadow,k=Uo(c._icon),x=c._map.layerPointToLatLng(k);h&&Ft(h,k),c._latlng=x,n.latlng=x,n.oldLatLng=this._oldLatLng,c.fire("move",n).fire("drag",n)},_onDragEnd:function(n){K(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),ra=$n.extend({options:{icon:new Ri,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,c){S(this,c),this._latlng=tt(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var c=this._latlng;return this._latlng=tt(n),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=n.icon.createIcon(this._icon),k=!1;h!==this._icon&&(this._icon&&this._removeIcon(),k=!0,n.title&&(h.title=n.title),h.tagName==="IMG"&&(h.alt=n.alt||"")),ht(h,c),n.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&rt(h,"focus",this._panOnFocus,this);var x=n.icon.createShadow(this._shadow),B=!1;x!==this._shadow&&(this._removeShadow(),B=!0),x&&(ht(x,c),x.alt=""),this._shadow=x,n.opacity<1&&this._updateOpacity(),k&&this.getPane().appendChild(this._icon),this._initInteraction(),x&&B&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ct(this._icon,"focus",this._panOnFocus,this),Mt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Mt(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&Ft(this._icon,n),this._shadow&&Ft(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var c=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(ht(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Gl)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Gl(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&xn(this._icon,n),this._shadow&&xn(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var c=this.options.icon.options,h=c.iconSize?ge(c.iconSize):ge(0,0),k=c.iconAnchor?ge(c.iconAnchor):ge(0,0);n.panInside(this._latlng,{paddingTopLeft:k,paddingBottomRight:h.subtract(k)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function cc(n,c){return new ra(n,c)}var is=$n.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return S(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ca=is.extend({options:{fill:!0,radius:10},initialize:function(n,c){S(this,c),this._latlng=tt(n),this._radius=this.options.radius},setLatLng:function(n){var c=this._latlng;return this._latlng=tt(n),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var c=n&&n.radius||this._radius;return is.prototype.setStyle.call(this,n),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,c=this._radiusY||n,h=this._clickTolerance(),k=[n+h,c+h];this._pxBounds=new de(this._point.subtract(k),this._point.add(k))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function uc(n,c){return new ca(n,c)}var qa=ca.extend({initialize:function(n,c,h){if(typeof c=="number"&&(c=s({},h,{radius:c})),S(this,c),this._latlng=tt(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new Xe(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:is.prototype.setStyle,_project:function(){var n=this._latlng.lng,c=this._latlng.lat,h=this._map,k=h.options.crs;if(k.distance===He.distance){var x=Math.PI/180,B=this._mRadius/He.R/x,ee=h.project([c+B,n]),ve=h.project([c-B,n]),Le=ee.add(ve).divideBy(2),Ne=h.unproject(Le).lat,Ye=Math.acos((Math.cos(B*x)-Math.sin(c*x)*Math.sin(Ne*x))/(Math.cos(c*x)*Math.cos(Ne*x)))/x;(isNaN(Ye)||Ye===0)&&(Ye=B/Math.cos(Math.PI/180*c)),this._point=Le.subtract(h.getPixelOrigin()),this._radius=isNaN(Ye)?0:Le.x-h.project([Ne,n-Ye]).x,this._radiusY=Le.y-ee.y}else{var ct=k.unproject(k.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(ct).x}this._updateBounds()}});function dc(n,c,h){return new qa(n,c,h)}var So=is.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,c){S(this,c),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var c=1/0,h=null,k=ho,x,B,ee=0,ve=this._parts.length;ee<ve;ee++)for(var Le=this._parts[ee],Ne=1,Ye=Le.length;Ne<Ye;Ne++){x=Le[Ne-1],B=Le[Ne];var ct=k(n,x,B,!0);ct<c&&(c=ct,h=k(n,x,B))}return h&&(h.distance=Math.sqrt(c)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return zl(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,c){return c=c||this._defaultShape(),n=tt(n),c.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new Xe,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return In(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var c=[],h=In(n),k=0,x=n.length;k<x;k++)h?(c[k]=tt(n[k]),this._bounds.extend(c[k])):c[k]=this._convertLatLngs(n[k]);return c},_project:function(){var n=new de;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),c=new ae(n,n);this._rawPxBounds&&(this._pxBounds=new de([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(n,c,h){var k=n[0]instanceof qe,x=n.length,B,ee;if(k){for(ee=[],B=0;B<x;B++)ee[B]=this._map.latLngToLayerPoint(n[B]),h.extend(ee[B]);c.push(ee)}else for(B=0;B<x;B++)this._projectLatlngs(n[B],c,h)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,h,k,x,B,ee,ve,Le;for(h=0,x=0,B=this._rings.length;h<B;h++)for(Le=this._rings[h],k=0,ee=Le.length;k<ee-1;k++)ve=mt(Le[k],Le[k+1],n,k,!0),ve&&(c[x]=c[x]||[],c[x].push(ve[0]),(ve[1]!==Le[k+1]||k===ee-2)&&(c[x].push(ve[1]),x++))}},_simplifyPoints:function(){for(var n=this._parts,c=this.options.smoothFactor,h=0,k=n.length;h<k;h++)n[h]=Re(n[h],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,c){var h,k,x,B,ee,ve,Le=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(h=0,B=this._parts.length;h<B;h++)for(ve=this._parts[h],k=0,ee=ve.length,x=ee-1;k<ee;x=k++)if(!(!c&&k===0)&&Je(n,ve[x],ve[k])<=Le)return!0;return!1}});function hc(n,c){return new So(n,c)}So._flat=Ul;var Ss=So.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return j(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var c=So.prototype._convertLatLngs.call(this,n),h=c.length;return h>=2&&c[0]instanceof qe&&c[0].equals(c[h-1])&&c.pop(),c},_setLatLngs:function(n){So.prototype._setLatLngs.call(this,n),In(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return In(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,c=this.options.weight,h=new ae(c,c);if(n=new de(n.min.subtract(h),n.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var k=0,x=this._rings.length,B;k<x;k++)B=z(this._rings[k],n,!0),B.length&&this._parts.push(B)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var c=!1,h,k,x,B,ee,ve,Le,Ne;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(B=0,Le=this._parts.length;B<Le;B++)for(h=this._parts[B],ee=0,Ne=h.length,ve=Ne-1;ee<Ne;ve=ee++)k=h[ee],x=h[ve],k.y>n.y!=x.y>n.y&&n.x<(x.x-k.x)*(n.y-k.y)/(x.y-k.y)+k.x&&(c=!c);return c||So.prototype._containsPoint.call(this,n,!0)}});function fc(n,c){return new Ss(n,c)}var Go=Vo.extend({initialize:function(n,c){S(this,c),this._layers={},n&&this.addData(n)},addData:function(n){var c=C(n)?n:n.features,h,k,x;if(c){for(h=0,k=c.length;h<k;h++)x=c[h],(x.geometries||x.geometry||x.features||x.coordinates)&&this.addData(x);return this}var B=this.options;if(B.filter&&!B.filter(n))return this;var ee=ua(n,B);return ee?(ee.feature=fa(n),ee.defaultOptions=ee.options,this.resetStyle(ee),B.onEachFeature&&B.onEachFeature(n,ee),this.addLayer(ee)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=s({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(c){this._setLayerStyle(c,n)},this)},_setLayerStyle:function(n,c){n.setStyle&&(typeof c=="function"&&(c=c(n.feature)),n.setStyle(c))}});function ua(n,c){var h=n.type==="Feature"?n.geometry:n,k=h?h.coordinates:null,x=[],B=c&&c.pointToLayer,ee=c&&c.coordsToLatLng||Wa,ve,Le,Ne,Ye;if(!k&&!h)return null;switch(h.type){case"Point":return ve=ee(k),da(B,n,ve,c);case"MultiPoint":for(Ne=0,Ye=k.length;Ne<Ye;Ne++)ve=ee(k[Ne]),x.push(da(B,n,ve,c));return new Vo(x);case"LineString":case"MultiLineString":return Le=ha(k,h.type==="LineString"?0:1,ee),new So(Le,c);case"Polygon":case"MultiPolygon":return Le=ha(k,h.type==="Polygon"?1:2,ee),new Ss(Le,c);case"GeometryCollection":for(Ne=0,Ye=h.geometries.length;Ne<Ye;Ne++){var ct=ua({geometry:h.geometries[Ne],type:"Feature",properties:n.properties},c);ct&&x.push(ct)}return new Vo(x);case"FeatureCollection":for(Ne=0,Ye=h.features.length;Ne<Ye;Ne++){var _t=ua(h.features[Ne],c);_t&&x.push(_t)}return new Vo(x);default:throw new Error("Invalid GeoJSON object.")}}function da(n,c,h,k){return n?n(c,h):new ra(h,k&&k.markersInheritOptions&&k)}function Wa(n){return new qe(n[1],n[0],n[2])}function ha(n,c,h){for(var k=[],x=0,B=n.length,ee;x<B;x++)ee=c?ha(n[x],c-1,h):(h||Wa)(n[x]),k.push(ee);return k}function Ka(n,c){return n=tt(n),n.alt!==void 0?[y(n.lng,c),y(n.lat,c),y(n.alt,c)]:[y(n.lng,c),y(n.lat,c)]}function Oi(n,c,h,k){for(var x=[],B=0,ee=n.length;B<ee;B++)x.push(c?Oi(n[B],In(n[B])?0:c-1,h,k):Ka(n[B],k));return!c&&h&&x.length>0&&x.push(x[0].slice()),x}function li(n,c){return n.feature?s({},n.feature,{geometry:c}):fa(c)}function fa(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var xs={toGeoJSON:function(n){return li(this,{type:"Point",coordinates:Ka(this.getLatLng(),n)})}};ra.include(xs),qa.include(xs),ca.include(xs),So.include({toGeoJSON:function(n){var c=!In(this._latlngs),h=Oi(this._latlngs,c?1:0,!1,n);return li(this,{type:(c?"Multi":"")+"LineString",coordinates:h})}}),Ss.include({toGeoJSON:function(n){var c=!In(this._latlngs),h=c&&!In(this._latlngs[0]),k=Oi(this._latlngs,h?2:c?1:0,!0,n);return c||(k=[k]),li(this,{type:(h?"Multi":"")+"Polygon",coordinates:k})}}),ai.include({toMultiPoint:function(n){var c=[];return this.eachLayer(function(h){c.push(h.toGeoJSON(n).geometry.coordinates)}),li(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(n){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(n);var h=c==="GeometryCollection",k=[];return this.eachLayer(function(x){if(x.toGeoJSON){var B=x.toGeoJSON(n);if(h)k.push(B.geometry);else{var ee=fa(B);ee.type==="FeatureCollection"?k.push.apply(k,ee.features):k.push(ee)}}}),h?li(this,{geometries:k,type:"GeometryCollection"}):{type:"FeatureCollection",features:k}}});function Ya(n,c){return new Go(n,c)}var jl=Ya,Bi=$n.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,c,h){this._url=n,this._bounds=et(c),S(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ht(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Mt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&Fn(this._image),this},bringToBack:function(){return this._map&&_o(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=et(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",c=this._image=n?this._url:kt("img");if(ht(c,"leaflet-image-layer"),this._zoomAnimated&&ht(c,"leaflet-zoom-animated"),this.options.className&&ht(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onload=l(this.fire,this,"load"),c.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(n){var c=this._map.getZoomScale(n.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;Fo(this._image,h,c)},_reset:function(){var n=this._image,c=new de(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=c.getSize();Ft(n,c.min),n.style.width=h.x+"px",n.style.height=h.y+"px"},_updateOpacity:function(){xn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),F=function(n,c,h){return new Bi(n,c,h)},ne=Bi.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",c=this._image=n?this._url:kt("video");if(ht(c,"leaflet-image-layer"),this._zoomAnimated&&ht(c,"leaflet-zoom-animated"),this.options.className&&ht(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onloadeddata=l(this.fire,this,"load"),n){for(var h=c.getElementsByTagName("source"),k=[],x=0;x<h.length;x++)k.push(h[x].src);this._url=h.length>0?k:[c.src];return}C(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var B=0;B<this._url.length;B++){var ee=kt("source");ee.src=this._url[B],c.appendChild(ee)}}});function pe(n,c,h){return new ne(n,c,h)}var _e=Bi.extend({_initImage:function(){var n=this._image=this._url;ht(n,"leaflet-image-layer"),this._zoomAnimated&&ht(n,"leaflet-zoom-animated"),this.options.className&&ht(n,this.options.className),n.onselectstart=m,n.onmousemove=m}});function lt(n,c,h){return new _e(n,c,h)}var Lt=$n.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,c){n&&(n instanceof qe||C(n))?(this._latlng=tt(n),S(this,c)):(S(this,n),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&xn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&xn(this._container,1),this.bringToFront(),this.options.interactive&&(ht(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(xn(this._container,0),this._removeTimeout=setTimeout(l(Mt,void 0,this._container),200)):Mt(this._container),this.options.interactive&&(Gt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=tt(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Fn(this._container),this},bringToBack:function(){return this._map&&_o(this._container),this},_prepareOpen:function(n){var c=this._source;if(!c._map)return!1;if(c instanceof Vo){c=null;var h=this._source._layers;for(var k in h)if(h[k]._map){c=h[k];break}if(!c)return!1;this._source=c}if(!n)if(c.getCenter)n=c.getCenter();else if(c.getLatLng)n=c.getLatLng();else if(c.getBounds)n=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")n.innerHTML=c;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),c=ge(this.options.offset),h=this._getAnchor();this._zoomAnimated?Ft(this._container,n.add(h)):c=c.add(n).add(h);var k=this._containerBottom=-c.y,x=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=k+"px",this._container.style.left=x+"px"}},_getAnchor:function(){return[0,0]}});pt.include({_initOverlay:function(n,c,h,k){var x=c;return x instanceof n||(x=new n(k).setContent(c)),h&&x.setLatLng(h),x}}),$n.include({_initOverlay:function(n,c,h,k){var x=h;return x instanceof n?(S(x,k),x._source=this):(x=c&&!k?c:new n(k,this),x.setContent(h)),x}});var sn=Lt.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,Lt.prototype.openOn.call(this,n)},onAdd:function(n){Lt.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof is||this._source.on("preclick",Co))},onRemove:function(n){Lt.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof is||this._source.off("preclick",Co))},getEvents:function(){var n=Lt.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",c=this._container=kt("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=kt("div",n+"-content-wrapper",c);if(this._contentNode=kt("div",n+"-content",h),bs(c),_s(this._contentNode),rt(c,"contextmenu",Co),this._tipContainer=kt("div",n+"-tip-container",c),this._tip=kt("div",n+"-tip",this._tipContainer),this.options.closeButton){var k=this._closeButton=kt("a",n+"-close-button",c);k.setAttribute("role","button"),k.setAttribute("aria-label","Close popup"),k.href="#close",k.innerHTML='<span aria-hidden="true">&#215;</span>',rt(k,"click",function(x){nn(x),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,c=n.style;c.width="",c.whiteSpace="nowrap";var h=n.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),c.width=h+1+"px",c.whiteSpace="",c.height="";var k=n.offsetHeight,x=this.options.maxHeight,B="leaflet-popup-scrolled";x&&k>x?(c.height=x+"px",ht(n,B)):Gt(n,B),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var c=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),h=this._getAnchor();Ft(this._container,c.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,c=parseInt(Jn(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+c,k=this._containerWidth,x=new ae(this._containerLeft,-h-this._containerBottom);x._add(Uo(this._container));var B=n.layerPointToContainerPoint(x),ee=ge(this.options.autoPanPadding),ve=ge(this.options.autoPanPaddingTopLeft||ee),Le=ge(this.options.autoPanPaddingBottomRight||ee),Ne=n.getSize(),Ye=0,ct=0;B.x+k+Le.x>Ne.x&&(Ye=B.x+k-Ne.x+Le.x),B.x-Ye-ve.x<0&&(Ye=B.x-ve.x),B.y+h+Le.y>Ne.y&&(ct=B.y+h-Ne.y+Le.y),B.y-ct-ve.y<0&&(ct=B.y-ve.y),(Ye||ct)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([Ye,ct]))}},_getAnchor:function(){return ge(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),xo=function(n,c){return new sn(n,c)};pt.mergeOptions({closePopupOnClick:!0}),pt.include({openPopup:function(n,c,h){return this._initOverlay(sn,n,c,h).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),$n.include({bindPopup:function(n,c){return this._popup=this._initOverlay(sn,this._popup,n,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof Vo||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){Un(n);var c=n.layer||n.target;if(this._popup._source===c&&!(c instanceof is)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=c,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var Zl=Lt.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){Lt.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){Lt.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=Lt.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",c=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=kt("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var c,h,k=this._map,x=this._container,B=k.latLngToContainerPoint(k.getCenter()),ee=k.layerPointToContainerPoint(n),ve=this.options.direction,Le=x.offsetWidth,Ne=x.offsetHeight,Ye=ge(this.options.offset),ct=this._getAnchor();ve==="top"?(c=Le/2,h=Ne):ve==="bottom"?(c=Le/2,h=0):ve==="center"?(c=Le/2,h=Ne/2):ve==="right"?(c=0,h=Ne/2):ve==="left"?(c=Le,h=Ne/2):ee.x<B.x?(ve="right",c=0,h=Ne/2):(ve="left",c=Le+(Ye.x+ct.x)*2,h=Ne/2),n=n.subtract(ge(c,h,!0)).add(Ye).add(ct),Gt(x,"leaflet-tooltip-right"),Gt(x,"leaflet-tooltip-left"),Gt(x,"leaflet-tooltip-top"),Gt(x,"leaflet-tooltip-bottom"),ht(x,"leaflet-tooltip-"+ve),Ft(x,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&xn(this._container,n)},_animateZoom:function(n){var c=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(c)},_getAnchor:function(){return ge(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Pv=function(n,c){return new Zl(n,c)};pt.include({openTooltip:function(n,c,h){return this._initOverlay(Zl,n,c,h).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),$n.include({bindTooltip:function(n,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Zl,this._tooltip,n,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var c=n?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[c](h),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof Vo||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var c=typeof n.getElement=="function"&&n.getElement();c&&(rt(c,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),rt(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var c=typeof n.getElement=="function"&&n.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var c=n.latlng,h,k;this._tooltip.options.sticky&&n.originalEvent&&(h=this._map.mouseEventToContainerPoint(n.originalEvent),k=this._map.containerPointToLayerPoint(h),c=this._map.layerPointToLatLng(k)),this._tooltip.setLatLng(c)}});var Yu=ss.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var c=n&&n.tagName==="DIV"?n:document.createElement("div"),h=this.options;if(h.html instanceof Element?(ms(c),c.appendChild(h.html)):c.innerHTML=h.html!==!1?h.html:"",h.bgPos){var k=ge(h.bgPos);c.style.backgroundPosition=-k.x+"px "+-k.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function Dv(n){return new Yu(n)}ss.Default=Ri;var Ja=$n.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Qe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){S(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),Mt(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Fn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(_o(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof ae?n:new ae(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var c=this.getPane().children,h=-n(-1/0,1/0),k=0,x=c.length,B;k<x;k++)B=c[k].style.zIndex,c[k]!==this._container&&B&&(h=n(h,+B));isFinite(h)&&(this.options.zIndex=h+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Qe.ielt9){xn(this._container,this.options.opacity);var n=+new Date,c=!1,h=!1;for(var k in this._tiles){var x=this._tiles[k];if(!(!x.current||!x.loaded)){var B=Math.min(1,(n-x.loaded)/200);xn(x.el,B),B<1?c=!0:(x.active?h=!0:this._onOpaqueTile(x),x.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),c&&(K(this._fadeFrame),this._fadeFrame=U(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=kt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,c=this.options.maxZoom;if(n!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===n?(this._levels[h].el.style.zIndex=c-Math.abs(n-h),this._onUpdateLevel(h)):(Mt(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var k=this._levels[n],x=this._map;return k||(k=this._levels[n]={},k.el=kt("div","leaflet-tile-container leaflet-zoom-animated",this._container),k.el.style.zIndex=c,k.origin=x.project(x.unproject(x.getPixelOrigin()),n).round(),k.zoom=n,this._setZoomTransform(k,x.getCenter(),x.getZoom()),m(k.el.offsetWidth),this._onCreateLevel(k)),this._level=k,k}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var n,c,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)c=this._tiles[n],c.retain=c.current;for(n in this._tiles)if(c=this._tiles[n],c.current&&!c.active){var k=c.coords;this._retainParent(k.x,k.y,k.z,k.z-5)||this._retainChildren(k.x,k.y,k.z,k.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var c in this._tiles)this._tiles[c].coords.z===n&&this._removeTile(c)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)Mt(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,c,h,k){var x=Math.floor(n/2),B=Math.floor(c/2),ee=h-1,ve=new ae(+x,+B);ve.z=+ee;var Le=this._tileCoordsToKey(ve),Ne=this._tiles[Le];return Ne&&Ne.active?(Ne.retain=!0,!0):(Ne&&Ne.loaded&&(Ne.retain=!0),ee>k?this._retainParent(x,B,ee,k):!1)},_retainChildren:function(n,c,h,k){for(var x=2*n;x<2*n+2;x++)for(var B=2*c;B<2*c+2;B++){var ee=new ae(x,B);ee.z=h+1;var ve=this._tileCoordsToKey(ee),Le=this._tiles[ve];if(Le&&Le.active){Le.retain=!0;continue}else Le&&Le.loaded&&(Le.retain=!0);h+1<k&&this._retainChildren(x,B,h+1,k)}},_resetView:function(n){var c=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var c=this.options;return c.minNativeZoom!==void 0&&n<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<n?c.maxNativeZoom:n},_setView:function(n,c,h,k){var x=Math.round(c);this.options.maxZoom!==void 0&&x>this.options.maxZoom||this.options.minZoom!==void 0&&x<this.options.minZoom?x=void 0:x=this._clampZoom(x);var B=this.options.updateWhenZooming&&x!==this._tileZoom;(!k||B)&&(this._tileZoom=x,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),x!==void 0&&this._update(n),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(n,c)},_setZoomTransforms:function(n,c){for(var h in this._levels)this._setZoomTransform(this._levels[h],n,c)},_setZoomTransform:function(n,c,h){var k=this._map.getZoomScale(h,n.zoom),x=n.origin.multiplyBy(k).subtract(this._map._getNewPixelOrigin(c,h)).round();Qe.any3d?Fo(n.el,x,k):Ft(n.el,x)},_resetGrid:function(){var n=this._map,c=n.options.crs,h=this._tileSize=this.getTileSize(),k=this._tileZoom,x=this._map.getPixelWorldBounds(this._tileZoom);x&&(this._globalTileRange=this._pxBoundsToTileRange(x)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,c.wrapLng[0]],k).x/h.x),Math.ceil(n.project([0,c.wrapLng[1]],k).x/h.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([c.wrapLat[0],0],k).y/h.x),Math.ceil(n.project([c.wrapLat[1],0],k).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var c=this._map,h=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),k=c.getZoomScale(h,this._tileZoom),x=c.project(n,this._tileZoom).floor(),B=c.getSize().divideBy(k*2);return new de(x.subtract(B),x.add(B))},_update:function(n){var c=this._map;if(c){var h=this._clampZoom(c.getZoom());if(n===void 0&&(n=c.getCenter()),this._tileZoom!==void 0){var k=this._getTiledPixelBounds(n),x=this._pxBoundsToTileRange(k),B=x.getCenter(),ee=[],ve=this.options.keepBuffer,Le=new de(x.getBottomLeft().subtract([ve,-ve]),x.getTopRight().add([ve,-ve]));if(!(isFinite(x.min.x)&&isFinite(x.min.y)&&isFinite(x.max.x)&&isFinite(x.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ne in this._tiles){var Ye=this._tiles[Ne].coords;(Ye.z!==this._tileZoom||!Le.contains(new ae(Ye.x,Ye.y)))&&(this._tiles[Ne].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(n,h);return}for(var ct=x.min.y;ct<=x.max.y;ct++)for(var _t=x.min.x;_t<=x.max.x;_t++){var Hn=new ae(_t,ct);if(Hn.z=this._tileZoom,!!this._isValidTile(Hn)){var gn=this._tiles[this._tileCoordsToKey(Hn)];gn?gn.current=!0:ee.push(Hn)}}if(ee.sort(function(Qn,va){return Qn.distanceTo(B)-va.distanceTo(B)}),ee.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Io=document.createDocumentFragment();for(_t=0;_t<ee.length;_t++)this._addTile(ee[_t],Io);this._level.el.appendChild(Io)}}}},_isValidTile:function(n){var c=this._map.options.crs;if(!c.infinite){var h=this._globalTileRange;if(!c.wrapLng&&(n.x<h.min.x||n.x>h.max.x)||!c.wrapLat&&(n.y<h.min.y||n.y>h.max.y))return!1}if(!this.options.bounds)return!0;var k=this._tileCoordsToBounds(n);return et(this.options.bounds).overlaps(k)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var c=this._map,h=this.getTileSize(),k=n.scaleBy(h),x=k.add(h),B=c.unproject(k,n.z),ee=c.unproject(x,n.z);return[B,ee]},_tileCoordsToBounds:function(n){var c=this._tileCoordsToNwSe(n),h=new Xe(c[0],c[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var c=n.split(":"),h=new ae(+c[0],+c[1]);return h.z=+c[2],h},_removeTile:function(n){var c=this._tiles[n];c&&(Mt(c.el),delete this._tiles[n],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){ht(n,"leaflet-tile");var c=this.getTileSize();n.style.width=c.x+"px",n.style.height=c.y+"px",n.onselectstart=m,n.onmousemove=m,Qe.ielt9&&this.options.opacity<1&&xn(n,this.options.opacity)},_addTile:function(n,c){var h=this._getTilePos(n),k=this._tileCoordsToKey(n),x=this.createTile(this._wrapCoords(n),l(this._tileReady,this,n));this._initTile(x),this.createTile.length<2&&U(l(this._tileReady,this,n,null,x)),Ft(x,h),this._tiles[k]={el:x,coords:n,current:!0},c.appendChild(x),this.fire("tileloadstart",{tile:x,coords:n})},_tileReady:function(n,c,h){c&&this.fire("tileerror",{error:c,tile:h,coords:n});var k=this._tileCoordsToKey(n);h=this._tiles[k],h&&(h.loaded=+new Date,this._map._fadeAnimated?(xn(h.el,0),K(this._fadeFrame),this._fadeFrame=U(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),c||(ht(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Qe.ielt9||!this._map._fadeAnimated?U(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var c=new ae(this._wrapX?f(n.x,this._wrapX):n.x,this._wrapY?f(n.y,this._wrapY):n.y);return c.z=n.z,c},_pxBoundsToTileRange:function(n){var c=this.getTileSize();return new de(n.min.unscaleBy(c).floor(),n.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function Rv(n){return new Ja(n)}var pa=Ja.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,c){this._url=n,c=S(this,c),c.detectRetina&&Qe.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,c){return this._url===n&&c===void 0&&(c=!0),this._url=n,c||this.redraw(),this},createTile:function(n,c){var h=document.createElement("img");return rt(h,"load",l(this._tileOnLoad,this,c,h)),rt(h,"error",l(this._tileOnError,this,c,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(n),h},getTileUrl:function(n){var c={r:Qe.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-n.y;this.options.tms&&(c.y=h),c["-y"]=h}return I(this._url,s(c,this.options))},_tileOnLoad:function(n,c){Qe.ielt9?setTimeout(l(n,this,null,c),0):n(null,c)},_tileOnError:function(n,c,h){var k=this.options.errorTileUrl;k&&c.getAttribute("src")!==k&&(c.src=k),n(h,c)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,c=this.options.maxZoom,h=this.options.zoomReverse,k=this.options.zoomOffset;return h&&(n=c-n),n+k},_getSubdomain:function(n){var c=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var n,c;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(c=this._tiles[n].el,c.onload=m,c.onerror=m,!c.complete)){c.src=E;var h=this._tiles[n].coords;Mt(c),delete this._tiles[n],this.fire("tileabort",{tile:c,coords:h})}},_removeTile:function(n){var c=this._tiles[n];if(c)return c.el.setAttribute("src",E),Ja.prototype._removeTile.call(this,n)},_tileReady:function(n,c,h){if(!(!this._map||h&&h.getAttribute("src")===E))return Ja.prototype._tileReady.call(this,n,c,h)}});function Ju(n,c){return new pa(n,c)}var Xu=pa.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,c){this._url=n;var h=s({},this.defaultWmsParams);for(var k in c)k in this.options||(h[k]=c[k]);c=S(this,c);var x=c.detectRetina&&Qe.retina?2:1,B=this.getTileSize();h.width=B.x*x,h.height=B.y*x,this.wmsParams=h},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,pa.prototype.onAdd.call(this,n)},getTileUrl:function(n){var c=this._tileCoordsToNwSe(n),h=this._crs,k=Oe(h.project(c[0]),h.project(c[1])),x=k.min,B=k.max,ee=(this._wmsVersion>=1.3&&this._crs===Hl?[x.y,x.x,B.y,B.x]:[x.x,x.y,B.x,B.y]).join(","),ve=pa.prototype.getTileUrl.call(this,n);return ve+T(this.wmsParams,ve,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ee},setParams:function(n,c){return s(this.wmsParams,n),c||this.redraw(),this}});function Ov(n,c){return new Xu(n,c)}pa.WMS=Xu,Ju.wms=Ov;var Is=$n.extend({options:{padding:.1},initialize:function(n){S(this,n),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ht(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,c){var h=this._map.getZoomScale(c,this._zoom),k=this._map.getSize().multiplyBy(.5+this.options.padding),x=this._map.project(this._center,c),B=k.multiplyBy(-h).add(x).subtract(this._map._getNewPixelOrigin(n,c));Qe.any3d?Fo(this._container,B,h):Ft(this._container,B)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,c=this._map.getSize(),h=this._map.containerPointToLayerPoint(c.multiplyBy(-n)).round();this._bounds=new de(h,h.add(c.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Qu=Is.extend({options:{tolerance:0},getEvents:function(){var n=Is.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Is.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");rt(n,"mousemove",this._onMouseMove,this),rt(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),rt(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){K(this._redrawRequest),delete this._ctx,Mt(this._container),Ct(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var c in this._layers)n=this._layers[c],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Is.prototype._update.call(this);var n=this._bounds,c=this._container,h=n.getSize(),k=Qe.retina?2:1;Ft(c,n.min),c.width=k*h.x,c.height=k*h.y,c.style.width=h.x+"px",c.style.height=h.y+"px",Qe.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){Is.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[d(n)]=n;var c=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var c=n._order,h=c.next,k=c.prev;h?h.prev=k:this._drawLast=k,k?k.next=h:this._drawFirst=h,delete n._order,delete this._layers[d(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var c=n.options.dashArray.split(/[, ]+/),h=[],k,x;for(x=0;x<c.length;x++){if(k=Number(c[x]),isNaN(k))return;h.push(k)}n.options._dashArray=h}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||U(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var c=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new de,this._redrawBounds.extend(n._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(n._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var c=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,c=this._redrawBounds;if(this._ctx.save(),c){var h=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var k=this._drawFirst;k;k=k.next)n=k.layer,(!c||n._pxBounds&&n._pxBounds.intersects(c))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,c){if(this._drawing){var h,k,x,B,ee=n._parts,ve=ee.length,Le=this._ctx;if(ve){for(Le.beginPath(),h=0;h<ve;h++){for(k=0,x=ee[h].length;k<x;k++)B=ee[h][k],Le[k?"lineTo":"moveTo"](B.x,B.y);c&&Le.closePath()}this._fillStroke(Le,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var c=n._point,h=this._ctx,k=Math.max(Math.round(n._radius),1),x=(Math.max(Math.round(n._radiusY),1)||k)/k;x!==1&&(h.save(),h.scale(1,x)),h.beginPath(),h.arc(c.x,c.y/x,k,0,Math.PI*2,!1),x!==1&&h.restore(),this._fillStroke(h,n)}},_fillStroke:function(n,c){var h=c.options;h.fill&&(n.globalAlpha=h.fillOpacity,n.fillStyle=h.fillColor||h.color,n.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(n.setLineDash&&n.setLineDash(c.options&&c.options._dashArray||[]),n.globalAlpha=h.opacity,n.lineWidth=h.weight,n.strokeStyle=h.color,n.lineCap=h.lineCap,n.lineJoin=h.lineJoin,n.stroke())},_onClick:function(n){for(var c=this._map.mouseEventToLayerPoint(n),h,k,x=this._drawFirst;x;x=x.next)h=x.layer,h.options.interactive&&h._containsPoint(c)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(h))&&(k=h);this._fireEvent(k?[k]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,c)}},_handleMouseOut:function(n){var c=this._hoveredLayer;c&&(Gt(this._container,"leaflet-interactive"),this._fireEvent([c],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,c){if(!this._mouseHoverThrottled){for(var h,k,x=this._drawFirst;x;x=x.next)h=x.layer,h.options.interactive&&h._containsPoint(c)&&(k=h);k!==this._hoveredLayer&&(this._handleMouseOut(n),k&&(ht(this._container,"leaflet-interactive"),this._fireEvent([k],n,"mouseover"),this._hoveredLayer=k)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,c,h){this._map._fireDOMEvent(c,h||c.type,n)},_bringToFront:function(n){var c=n._order;if(c){var h=c.next,k=c.prev;if(h)h.prev=k;else return;k?k.next=h:h&&(this._drawFirst=h),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(n)}},_bringToBack:function(n){var c=n._order;if(c){var h=c.next,k=c.prev;if(k)k.next=h;else return;h?h.prev=k:k&&(this._drawLast=k),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(n)}}});function ed(n){return Qe.canvas?new Qu(n):null}var Xa=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Bv={_initContainer:function(){this._container=kt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Is.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var c=n._container=Xa("shape");ht(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",n._path=Xa("path"),c.appendChild(n._path),this._updateStyle(n),this._layers[d(n)]=n},_addPath:function(n){var c=n._container;this._container.appendChild(c),n.options.interactive&&n.addInteractiveTarget(c)},_removePath:function(n){var c=n._container;Mt(c),n.removeInteractiveTarget(c),delete this._layers[d(n)]},_updateStyle:function(n){var c=n._stroke,h=n._fill,k=n.options,x=n._container;x.stroked=!!k.stroke,x.filled=!!k.fill,k.stroke?(c||(c=n._stroke=Xa("stroke")),x.appendChild(c),c.weight=k.weight+"px",c.color=k.color,c.opacity=k.opacity,k.dashArray?c.dashStyle=C(k.dashArray)?k.dashArray.join(" "):k.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=k.lineCap.replace("butt","flat"),c.joinstyle=k.lineJoin):c&&(x.removeChild(c),n._stroke=null),k.fill?(h||(h=n._fill=Xa("fill")),x.appendChild(h),h.color=k.fillColor||k.color,h.opacity=k.fillOpacity):h&&(x.removeChild(h),n._fill=null)},_updateCircle:function(n){var c=n._point.round(),h=Math.round(n._radius),k=Math.round(n._radiusY||h);this._setPath(n,n._empty()?"M0 0":"AL "+c.x+","+c.y+" "+h+","+k+" 0,"+65535*360)},_setPath:function(n,c){n._path.v=c},_bringToFront:function(n){Fn(n._container)},_bringToBack:function(n){_o(n._container)}},ql=Qe.vml?Xa:ye,Qa=Is.extend({_initContainer:function(){this._container=ql("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ql("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Mt(this._container),Ct(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Is.prototype._update.call(this);var n=this._bounds,c=n.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,h.setAttribute("width",c.x),h.setAttribute("height",c.y)),Ft(h,n.min),h.setAttribute("viewBox",[n.min.x,n.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(n){var c=n._path=ql("path");n.options.className&&ht(c,n.options.className),n.options.interactive&&ht(c,"leaflet-interactive"),this._updateStyle(n),this._layers[d(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){Mt(n._path),n.removeInteractiveTarget(n._path),delete this._layers[d(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var c=n._path,h=n.options;c&&(h.stroke?(c.setAttribute("stroke",h.color),c.setAttribute("stroke-opacity",h.opacity),c.setAttribute("stroke-width",h.weight),c.setAttribute("stroke-linecap",h.lineCap),c.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?c.setAttribute("stroke-dasharray",h.dashArray):c.removeAttribute("stroke-dasharray"),h.dashOffset?c.setAttribute("stroke-dashoffset",h.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),h.fill?(c.setAttribute("fill",h.fillColor||h.color),c.setAttribute("fill-opacity",h.fillOpacity),c.setAttribute("fill-rule",h.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(n,c){this._setPath(n,ie(n._parts,c))},_updateCircle:function(n){var c=n._point,h=Math.max(Math.round(n._radius),1),k=Math.max(Math.round(n._radiusY),1)||h,x="a"+h+","+k+" 0 1,0 ",B=n._empty()?"M0 0":"M"+(c.x-h)+","+c.y+x+h*2+",0 "+x+-h*2+",0 ";this._setPath(n,B)},_setPath:function(n,c){n._path.setAttribute("d",c)},_bringToFront:function(n){Fn(n._path)},_bringToBack:function(n){_o(n._path)}});Qe.vml&&Qa.include(Bv);function td(n){return Qe.svg||Qe.vml?new Qa(n):null}pt.include({getRenderer:function(n){var c=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var c=this._paneRenderers[n];return c===void 0&&(c=this._createRenderer({pane:n}),this._paneRenderers[n]=c),c},_createRenderer:function(n){return this.options.preferCanvas&&ed(n)||td(n)}});var nd=Ss.extend({initialize:function(n,c){Ss.prototype.initialize.call(this,this._boundsToLatLngs(n),c)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=et(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function Nv(n,c){return new nd(n,c)}Qa.create=ql,Qa.pointsToPath=ie,Go.geometryToLayer=ua,Go.coordsToLatLng=Wa,Go.coordsToLatLngs=ha,Go.latLngToCoords=Ka,Go.latLngsToCoords=Oi,Go.getFeature=li,Go.asFeature=fa,pt.mergeOptions({boxZoom:!0});var od=Xn.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){rt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ct(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Mt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),gs(),Qs(),this._startPoint=this._map.mouseEventToContainerPoint(n),rt(document,{contextmenu:Un,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=kt("div","leaflet-zoom-box",this._container),ht(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var c=new de(this._point,this._startPoint),h=c.getSize();Ft(this._box,c.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(Mt(this._box),Gt(this._container,"leaflet-crosshair")),ys(),zo(),Ct(document,{contextmenu:Un,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var c=new Xe(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});pt.addInitHook("addHandler","boxZoom",od),pt.mergeOptions({doubleClickZoom:!0});var sd=Xn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var c=this._map,h=c.getZoom(),k=c.options.zoomDelta,x=n.originalEvent.shiftKey?h-k:h+k;c.options.doubleClickZoom==="center"?c.setZoom(x):c.setZoomAround(n.containerPoint,x)}});pt.addInitHook("addHandler","doubleClickZoom",sd),pt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var id=Xn.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new Lo(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}ht(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Gt(this._map._container,"leaflet-grab"),Gt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=et(this._map.options.maxBounds);this._offsetLimit=Oe(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var c=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(c),this._prunePositions(c)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,c){return n-(n-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;n.x<c.min.x&&(n.x=this._viscousLimit(n.x,c.min.x)),n.y<c.min.y&&(n.y=this._viscousLimit(n.y,c.min.y)),n.x>c.max.x&&(n.x=this._viscousLimit(n.x,c.max.x)),n.y>c.max.y&&(n.y=this._viscousLimit(n.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,c=Math.round(n/2),h=this._initialWorldOffset,k=this._draggable._newPos.x,x=(k-c+h)%n+c-h,B=(k+c+h)%n-c-h,ee=Math.abs(x+h)<Math.abs(B+h)?x:B;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ee},_onDragEnd:function(n){var c=this._map,h=c.options,k=!h.inertia||n.noInertia||this._times.length<2;if(c.fire("dragend",n),k)c.fire("moveend");else{this._prunePositions(+new Date);var x=this._lastPos.subtract(this._positions[0]),B=(this._lastTime-this._times[0])/1e3,ee=h.easeLinearity,ve=x.multiplyBy(ee/B),Le=ve.distanceTo([0,0]),Ne=Math.min(h.inertiaMaxSpeed,Le),Ye=ve.multiplyBy(Ne/Le),ct=Ne/(h.inertiaDeceleration*ee),_t=Ye.multiplyBy(-ct/2).round();!_t.x&&!_t.y?c.fire("moveend"):(_t=c._limitOffset(_t,c.options.maxBounds),U(function(){c.panBy(_t,{duration:ct,easeLinearity:ee,noMoveStart:!0,animate:!0})}))}}});pt.addInitHook("addHandler","dragging",id),pt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ad=Xn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),rt(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ct(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,c=document.documentElement,h=n.scrollTop||c.scrollTop,k=n.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(k,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var c=this._panKeys={},h=this.keyCodes,k,x;for(k=0,x=h.left.length;k<x;k++)c[h.left[k]]=[-1*n,0];for(k=0,x=h.right.length;k<x;k++)c[h.right[k]]=[n,0];for(k=0,x=h.down.length;k<x;k++)c[h.down[k]]=[0,n];for(k=0,x=h.up.length;k<x;k++)c[h.up[k]]=[0,-1*n]},_setZoomDelta:function(n){var c=this._zoomKeys={},h=this.keyCodes,k,x;for(k=0,x=h.zoomIn.length;k<x;k++)c[h.zoomIn[k]]=n;for(k=0,x=h.zoomOut.length;k<x;k++)c[h.zoomOut[k]]=-n},_addHooks:function(){rt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ct(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var c=n.keyCode,h=this._map,k;if(c in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(k=this._panKeys[c],n.shiftKey&&(k=ge(k).multiplyBy(3)),h.options.maxBounds&&(k=h._limitOffset(ge(k),h.options.maxBounds)),h.options.worldCopyJump){var x=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(k)));h.panTo(x)}else h.panBy(k)}else if(c in this._zoomKeys)h.setZoom(h.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;Un(n)}}});pt.addInitHook("addHandler","keyboard",ad),pt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ld=Xn.extend({addHooks:function(){rt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ct(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var c=uo(n),h=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var k=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),k),Un(n)},_performZoom:function(){var n=this._map,c=n.getZoom(),h=this._map.options.zoomSnap||0;n._stop();var k=this._delta/(this._map.options.wheelPxPerZoomLevel*4),x=4*Math.log(2/(1+Math.exp(-Math.abs(k))))/Math.LN2,B=h?Math.ceil(x/h)*h:x,ee=n._limitZoom(c+(this._delta>0?B:-B))-c;this._delta=0,this._startTime=null,ee&&(n.options.scrollWheelZoom==="center"?n.setZoom(c+ee):n.setZoomAround(this._lastMousePos,c+ee))}});pt.addInitHook("addHandler","scrollWheelZoom",ld);var Fv=600;pt.mergeOptions({tapHold:Qe.touchNative&&Qe.safari&&Qe.mobile,tapTolerance:15});var rd=Xn.extend({addHooks:function(){rt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ct(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var c=n.touches[0];this._startPos=this._newPos=new ae(c.clientX,c.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(rt(document,"touchend",nn),rt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),Fv),rt(document,"touchend touchcancel contextmenu",this._cancel,this),rt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){Ct(document,"touchend",nn),Ct(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),Ct(document,"touchend touchcancel contextmenu",this._cancel,this),Ct(document,"touchmove",this._onMove,this)},_onMove:function(n){var c=n.touches[0];this._newPos=new ae(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,c){var h=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});h._simulated=!0,c.target.dispatchEvent(h)}});pt.addInitHook("addHandler","tapHold",rd),pt.mergeOptions({touchZoom:Qe.touch,bounceAtZoomLimits:!0});var cd=Xn.extend({addHooks:function(){ht(this._map._container,"leaflet-touch-zoom"),rt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Gt(this._map._container,"leaflet-touch-zoom"),Ct(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var c=this._map;if(!(!n.touches||n.touches.length!==2||c._animatingZoom||this._zooming)){var h=c.mouseEventToContainerPoint(n.touches[0]),k=c.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(h.add(k)._divideBy(2))),this._startDist=h.distanceTo(k),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),rt(document,"touchmove",this._onTouchMove,this),rt(document,"touchend touchcancel",this._onTouchEnd,this),nn(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var c=this._map,h=c.mouseEventToContainerPoint(n.touches[0]),k=c.mouseEventToContainerPoint(n.touches[1]),x=h.distanceTo(k)/this._startDist;if(this._zoom=c.getScaleZoom(x,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&x<1||this._zoom>c.getMaxZoom()&&x>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,x===1)return}else{var B=h._add(k)._divideBy(2)._subtract(this._centerPoint);if(x===1&&B.x===0&&B.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(B),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),K(this._animRequest);var ee=l(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=U(ee,this,!0),nn(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,K(this._animRequest),Ct(document,"touchmove",this._onTouchMove,this),Ct(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});pt.addInitHook("addHandler","touchZoom",cd),pt.BoxZoom=od,pt.DoubleClickZoom=sd,pt.Drag=id,pt.Keyboard=ad,pt.ScrollWheelZoom=ld,pt.TapHold=rd,pt.TouchZoom=cd,o.Bounds=de,o.Browser=Qe,o.CRS=be,o.Canvas=Qu,o.Circle=qa,o.CircleMarker=ca,o.Class=Pe,o.Control=zn,o.DivIcon=Yu,o.DivOverlay=Lt,o.DomEvent=aa,o.DomUtil=co,o.Draggable=Lo,o.Evented=Fe,o.FeatureGroup=Vo,o.GeoJSON=Go,o.GridLayer=Ja,o.Handler=Xn,o.Icon=ss,o.ImageOverlay=Bi,o.LatLng=qe,o.LatLngBounds=Xe,o.Layer=$n,o.LayerGroup=ai,o.LineUtil=ic,o.Map=pt,o.Marker=ra,o.Mixin=Ls,o.Path=is,o.Point=ae,o.PolyUtil=Ce,o.Polygon=Ss,o.Polyline=So,o.Popup=sn,o.PosAnimation=Mi,o.Projection=ac,o.Rectangle=nd,o.Renderer=Is,o.SVG=Qa,o.SVGOverlay=_e,o.TileLayer=pa,o.Tooltip=Zl,o.Transformation=Te,o.Util=re,o.VideoOverlay=ne,o.bind=l,o.bounds=Oe,o.canvas=ed,o.circle=dc,o.circleMarker=uc,o.control=ws,o.divIcon=Dv,o.extend=s,o.featureGroup=Vl,o.geoJSON=Ya,o.geoJson=jl,o.gridLayer=Rv,o.icon=Za,o.imageOverlay=F,o.latLng=tt,o.latLngBounds=et,o.layerGroup=la,o.map=za,o.marker=cc,o.point=ge,o.polygon=fc,o.polyline=hc,o.popup=xo,o.rectangle=Nv,o.setOptions=S,o.stamp=d,o.svg=td,o.svgOverlay=lt,o.tileLayer=Ju,o.tooltip=Pv,o.transformation=W,o.version=i,o.videoOverlay=pe;var Uv=window.L;o.noConflict=function(){return window.L=Uv,this},window.L=o}))})(ll,ll.exports)),ll.exports}var U0=F0();const Kt=B0(U0);(function(e,t,o){function i(s,a){for(;(s=s.parentElement)&&!s.classList.contains(a););return s}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(s,a){this._map=s,this._container=s._container,this._overlayPane=s._panes.overlayPane,this._popupPane=s._panes.popupPane,a&&a.shapeOptions&&(a.shapeOptions=L.Util.extend({},this.options.shapeOptions,a.shapeOptions)),L.setOptions(this,a);var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(L.DomUtil.disableTextSelection(),s.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(s){L.setOptions(this,s)},_fireCreatedEvent:function(s){this._map.fire(L.Draw.Event.CREATED,{layer:s,layerType:this.type})},_cancelDrawing:function(s){s.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(s,a){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,a&&a.drawError&&(a.drawError=L.Util.extend({},this.options.drawError,a.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var s=this._markers.pop(),a=this._poly,l=a.getLatLngs(),u=l.splice(-1,1)[0];this._poly.setLatLngs(l),this._markerGroup.removeLayer(s),a.getLatLngs().length<2&&this._map.removeLayer(a),this._vertexChanged(u,!1)}},addVertex:function(s){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(s))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(s)),this._poly.addLatLng(s),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(s,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var s=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),a=this._poly.newLatLngIntersects(s[s.length-1]);if(!this.options.allowIntersection&&a||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent),l=this._map.layerPointToLatLng(a);this._currentLatLng=l,this._updateTooltip(l),this._updateGuide(a),this._mouseMarker.setLatLng(l),L.DomEvent.preventDefault(s.originalEvent)},_vertexChanged:function(s,a){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(s,a),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(s){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(s),this._clickHandled=!0,this._disableNewMarkers();var a=s.originalEvent,l=a.clientX,u=a.clientY;this._startPoint.call(this,l,u)}},_startPoint:function(s,a){this._mouseDownOrigin=L.point(s,a)},_onMouseUp:function(s){var a=s.originalEvent,l=a.clientX,u=a.clientY;this._endPoint.call(this,l,u,s),this._clickHandled=null},_endPoint:function(s,a,l){if(this._mouseDownOrigin){var u=L.point(s,a).distanceTo(this._mouseDownOrigin),d=this._calculateFinishDistance(l.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(l.latlng),this._finishShape()):d<10&&L.Browser.touch?this._finishShape():Math.abs(u)<9*(e.devicePixelRatio||1)&&this.addVertex(l.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(s){var a,l,u=s.originalEvent;!u.touches||!u.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(a=u.touches[0].clientX,l=u.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,a,l),this._endPoint.call(this,a,l,s),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(s){var a;if(this._markers.length>0){var l;if(this.type===L.Draw.Polyline.TYPE)l=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;l=this._markers[0]}var u=this._map.latLngToContainerPoint(l.getLatLng()),d=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),p=this._map.latLngToContainerPoint(d.getLatLng());a=u.distanceTo(p)}else a=1/0;return a},_updateFinishHandler:function(){var s=this._markers.length;s>1&&this._markers[s-1].on("click",this._finishShape,this),s>2&&this._markers[s-2].off("click",this._finishShape,this)},_createMarker:function(s){var a=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(a),a},_updateGuide:function(s){var a=this._markers?this._markers.length:0;a>0&&(s=s||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[a-1].getLatLng()),s))},_updateTooltip:function(s){var a=this._getTooltipText();s&&this._tooltip.updatePosition(s),this._errorShown||this._tooltip.updateContent(a)},_drawGuide:function(s,a){var l,u,d,p=Math.floor(Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))),f=this.options.guidelineDistance,m=this.options.maxGuideLineLength,y=p>m?p-m:f;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));y<p;y+=this.options.guidelineDistance)l=y/p,u={x:Math.floor(s.x*(1-l)+l*a.x),y:Math.floor(s.y*(1-l)+l*a.y)},d=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),d.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(d,u)},_updateGuideColor:function(s){if(this._guidesContainer)for(var a=0,l=this._guidesContainer.childNodes.length;a<l;a++)this._guidesContainer.childNodes[a].style.backgroundColor=s},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var s,a,l=this.options.showLength;return this._markers.length===0?s={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(a=l?this._getMeasurementString():"",s=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:a}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:a}),s},_updateRunningMeasure:function(s,a){var l,u,d=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(l=d-(a?2:1),u=L.GeometryUtil.isVersion07x()?s.distanceTo(this._markers[l].getLatLng())*(this.options.factor||1):this._map.distance(s,this._markers[l].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=u*(a?1:-1))},_getMeasurementString:function(){var s,a=this._currentLatLng,l=this._markers[this._markers.length-1].getLatLng();return s=L.GeometryUtil.isVersion07x()?l&&a&&a.distanceTo?this._measurementRunningTotal+a.distanceTo(l)*(this.options.factor||1):this._measurementRunningTotal||0:l&&a?this._measurementRunningTotal+this._map.distance(a,l)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(s,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var s=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(s,a){L.Draw.Polyline.prototype.initialize.call(this,s,a),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var s=this._markers.length;s===1&&this._markers[0].on("click",this._finishShape,this),s>2&&(this._markers[s-1].on("dblclick",this._finishShape,this),s>3&&this._markers[s-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var s,a;return this._markers.length===0?s=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(s=L.drawLocal.draw.handlers.polygon.tooltip.cont,a=this._getMeasurementString()):(s=L.drawLocal.draw.handlers.polygon.tooltip.end,a=this._getMeasurementString()),{text:s,subtext:a}},_getMeasurementString:function(){var s=this._area,a="";return s||this.options.showLength?(this.options.showLength&&(a=L.Draw.Polyline.prototype._getMeasurementString.call(this)),s&&(a+="<br>"+L.GeometryUtil.readableArea(s,this.options.metric,this.options.precision)),a):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(s,a){var l;!this.options.allowIntersection&&this.options.showArea&&(l=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(l)),L.Draw.Polyline.prototype._vertexChanged.call(this,s,a)},_cleanUpShape:function(){var s=this._markers.length;s>0&&(this._markers[0].off("click",this._finishShape,this),s>2&&this._markers[s-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(s,a){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(s){this._isDrawing=!0,this._startLatLng=s.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(s.originalEvent)},_onMouseMove:function(s){var a=s.latlng;this._tooltip.updatePosition(a),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(a))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(s,a){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,a)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(s){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!i(s.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(s){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,s)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,s),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_getTooltipText:function(){var s,a,l,u=L.Draw.SimpleShape.prototype._getTooltipText.call(this),d=this._shape,p=this.options.showArea;return d&&(s=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),a=L.GeometryUtil.geodesicArea(s),l=p?L.GeometryUtil.readableArea(a,this.options.metric):""),{text:u.text,subtext:l}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(s,a){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(s){var a=s.latlng;this._tooltip.updatePosition(a),this._mouseMarker.setLatLng(a),this._marker?(a=this._mouseMarker.getLatLng(),this._marker.setLatLng(a)):(this._marker=this._createMarker(a),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(s){return new L.Marker(s,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(s){this._onMouseMove(s),this._onClick()},_fireCreatedEvent:function(){var s=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(s,a){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,a)},_fireCreatedEvent:function(){var s=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)},_createMarker:function(s){return new L.CircleMarker(s,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(s,a){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,a)},_drawShape:function(s){if(L.GeometryUtil.isVersion07x())var a=this._startLatLng.distanceTo(s);else var a=this._map.distance(this._startLatLng,s);this._shape?this._shape.setRadius(a):(this._shape=new L.Circle(this._startLatLng,a,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_onMouseMove:function(s){var a,l=s.latlng,u=this.options.showRadius,d=this.options.metric;if(this._tooltip.updatePosition(l),this._isDrawing){this._drawShape(l),a=this._shape.getRadius().toFixed(1);var p="";u&&(p=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(a,d,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:p})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(s,a){this._marker=s,L.setOptions(this,a)},addHooks:function(){var s=this._marker;s.dragging.enable(),s.on("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},removeHooks:function(){var s=this._marker;s.dragging.disable(),s.off("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},_onDragEnd:function(s){var a=s.target;a.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:a})},_toggleMarkerHighlight:function(){var s=this._marker._icon;s&&(s.style.display="none",L.DomUtil.hasClass(s,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,-4)):(L.DomUtil.addClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,4)),s.style.display="")},_offsetMarker:function(s,a){var l=parseInt(s.style.marginTop,10)-a,u=parseInt(s.style.marginLeft,10)-a;s.style.marginTop=l+"px",s.style.marginLeft=u+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(s){this.latlngs=[s._latlngs],s._holes&&(this.latlngs=this.latlngs.concat(s._holes)),this._poly=s,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(s){for(var a=0;a<this._verticesHandlers.length;a++)s(this._verticesHandlers[a])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(s){s.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(s){s.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(s){s.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var s=0;s<this.latlngs.length;s++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[s],this._poly.options.poly))},_updateLatLngs:function(s){this.latlngs=[s.layer._latlngs],s.layer._holes&&(this.latlngs=this.latlngs.concat(s.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(s,a,l){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=s,l&&l.drawError&&(l.drawError=L.Util.extend({},this.options.drawError,l.drawError)),this._latlngs=a,L.setOptions(this,l)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var s=this._poly,a=s._path;s instanceof L.Polygon||(s.options.fill=!1,s.options.editing&&(s.options.editing.fill=!1)),a&&s.options.editing&&s.options.editing.className&&(s.options.original.className&&s.options.original.className.split(" ").forEach(function(l){L.DomUtil.removeClass(a,l)}),s.options.editing.className.split(" ").forEach(function(l){L.DomUtil.addClass(a,l)})),s.setStyle(s.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var s=this._poly,a=s._path;a&&s.options.editing&&s.options.editing.className&&(s.options.editing.className.split(" ").forEach(function(l){L.DomUtil.removeClass(a,l)}),s.options.original.className&&s.options.original.className.split(" ").forEach(function(l){L.DomUtil.addClass(a,l)})),s.setStyle(s.options.original),s._map&&(s._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var s,a,l,u,d=this._defaultShape();for(s=0,l=d.length;s<l;s++)u=this._createMarker(d[s],s),u.on("click",this._onMarkerClick,this),u.on("contextmenu",this._onContextMenu,this),this._markers.push(u);var p,f;for(s=0,a=l-1;s<l;a=s++)(s!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(p=this._markers[a],f=this._markers[s],this._createMiddleMarker(p,f),this._updatePrevNext(p,f))},_createMarker:function(s,a){var l=new L.Marker.Touch(s,{draggable:!0,icon:this.options.icon});return l._origLatLng=s,l._index=a,l.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(l),l},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var s=this._defaultShape(),a=[].splice.apply(s,arguments);return this._poly._convertLatLngs(s,!0),this._poly.redraw(),a},_removeMarker:function(s){var a=s._index;this._markerGroup.removeLayer(s),this._markers.splice(a,1),this._spliceLatLngs(a,1),this._updateIndexes(a,-1),s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(s){var a=s.target,l=this._poly,u=L.LatLngUtil.cloneLatLng(a._origLatLng);if(L.extend(a._origLatLng,a._latlng),l.options.poly){var d=l._map._editTooltip;if(!l.options.poly.allowIntersection&&l.intersects()){L.extend(a._origLatLng,u),a.setLatLng(u);var p=l.options.color;l.setStyle({color:this.options.drawError.color}),d&&d.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){l.setStyle({color:p}),d&&d.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}a._middleLeft&&a._middleLeft.setLatLng(this._getMiddleLatLng(a._prev,a)),a._middleRight&&a._middleRight.setLatLng(this._getMiddleLatLng(a,a._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var f=this._poly.getLatLngs();this._poly._convertLatLngs(f,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(s){var a=L.Polygon&&this._poly instanceof L.Polygon?4:3,l=s.target;this._defaultShape().length<a||(this._removeMarker(l),this._updatePrevNext(l._prev,l._next),l._middleLeft&&this._markerGroup.removeLayer(l._middleLeft),l._middleRight&&this._markerGroup.removeLayer(l._middleRight),l._prev&&l._next?this._createMiddleMarker(l._prev,l._next):l._prev?l._next||(l._prev._middleRight=null):l._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(s){var a=s.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:a,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),l=this._map.layerPointToLatLng(a),u=s.target;L.extend(u._origLatLng,l),u._middleLeft&&u._middleLeft.setLatLng(this._getMiddleLatLng(u._prev,u)),u._middleRight&&u._middleRight.setLatLng(this._getMiddleLatLng(u,u._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(s,a){this._markerGroup.eachLayer(function(l){l._index>s&&(l._index+=a)})},_createMiddleMarker:function(s,a){var l,u,d,p=this._getMiddleLatLng(s,a),f=this._createMarker(p);f.setOpacity(.6),s._middleRight=a._middleLeft=f,u=function(){f.off("touchmove",u,this);var m=a._index;f._index=m,f.off("click",l,this).on("click",this._onMarkerClick,this),p.lat=f.getLatLng().lat,p.lng=f.getLatLng().lng,this._spliceLatLngs(m,0,p),this._markers.splice(m,0,f),f.setOpacity(1),this._updateIndexes(m,1),a._index++,this._updatePrevNext(s,f),this._updatePrevNext(f,a),this._poly.fire("editstart")},d=function(){f.off("dragstart",u,this),f.off("dragend",d,this),f.off("touchmove",u,this),this._createMiddleMarker(s,f),this._createMiddleMarker(f,a)},l=function(){u.call(this),d.call(this),this._fireEdit()},f.on("click",l,this).on("dragstart",u,this).on("dragend",d,this).on("touchmove",u,this),this._markerGroup.addLayer(f)},_updatePrevNext:function(s,a){s&&(s._next=a),a&&(a._prev=s)},_getMiddleLatLng:function(s,a){var l=this._poly._map,u=l.project(s.getLatLng()),d=l.project(a.getLatLng());return l.unproject(u._add(d)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(s,a){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=s,L.Util.setOptions(this,a)},addHooks:function(){var s=this._shape;this._shape._map&&(this._map=this._shape._map,s.setStyle(s.options.editing),s._map&&(this._map=s._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var s=this._shape;if(s.setStyle(s.options.original),s._map){this._unbindMarker(this._moveMarker);for(var a=0,l=this._resizeMarkers.length;a<l;a++)this._unbindMarker(this._resizeMarkers[a]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(s,a){var l=new L.Marker.Touch(s,{draggable:!0,icon:a,zIndexOffset:10});return this._bindMarker(l),this._markerGroup.addLayer(l),l},_bindMarker:function(s){s.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(s){s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(s){s.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(s){var a=s.target,l=a.getLatLng();a===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(s){s.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(s){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s),typeof this._getCorners=="function"){var a=this._getCorners(),l=s.target,u=l._cornerIndex;l.setOpacity(0),this._oppositeCorner=a[(u+2)%4],this._toggleCornerMarkers(0,u)}this._shape.fire("editstart")},_onTouchMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),l=this._map.layerPointToLatLng(a);return s.target===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),!1},_onTouchEnd:function(s){s.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getBounds(),a=s.getCenter();this._moveMarker=this._createMarker(a,this.options.moveIcon)},_createResizeMarker:function(){var s=this._getCorners();this._resizeMarkers=[];for(var a=0,l=s.length;a<l;a++)this._resizeMarkers.push(this._createMarker(s[a],this.options.resizeIcon)),this._resizeMarkers[a]._cornerIndex=a},_onMarkerDragStart:function(s){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s);var a=this._getCorners(),l=s.target,u=l._cornerIndex;this._oppositeCorner=a[(u+2)%4],this._toggleCornerMarkers(0,u)},_onMarkerDragEnd:function(s){var a,l,u=s.target;u===this._moveMarker&&(a=this._shape.getBounds(),l=a.getCenter(),u.setLatLng(l)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,s)},_move:function(s){for(var a,l=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),u=this._shape.getBounds(),d=u.getCenter(),p=[],f=0,m=l.length;f<m;f++)a=[l[f].lat-d.lat,l[f].lng-d.lng],p.push([s.lat+a[0],s.lng+a[1]]);this._shape.setLatLngs(p),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(s){var a;this._shape.setBounds(L.latLngBounds(s,this._oppositeCorner)),a=this._shape.getBounds(),this._moveMarker.setLatLng(a.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var s=this._shape.getBounds();return[s.getNorthWest(),s.getNorthEast(),s.getSouthEast(),s.getSouthWest()]},_toggleCornerMarkers:function(s){for(var a=0,l=this._resizeMarkers.length;a<l;a++)this._resizeMarkers[a].setOpacity(s)},_repositionCornerMarkers:function(){for(var s=this._getCorners(),a=0,l=this._resizeMarkers.length;a<l;a++)this._resizeMarkers[a].setLatLng(s[a])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getLatLng();this._moveMarker=this._createMarker(s,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(s){if(this._resizeMarkers.length){var a=this._getResizeMarkerPoint(s);this._resizeMarkers[0].setLatLng(a)}this._shape.setLatLng(s),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var s=this._shape.getLatLng(),a=this._getResizeMarkerPoint(s);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(a,this.options.resizeIcon))},_getResizeMarkerPoint:function(s){var a=this._shape._radius*Math.cos(Math.PI/4),l=this._map.project(s);return this._map.unproject([l.x+a,l.y-a])},_resize:function(s){var a=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=a.distanceTo(s):radius=this._map.distance(a,s),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(s,a){var l={};if(s.touches!==void 0){if(!s.touches.length)return;l=s.touches[0]}else if(s.pointerType!=="touch"||(l=s,!this._filterClick(s)))return;var u=this._map.mouseEventToContainerPoint(l),d=this._map.mouseEventToLayerPoint(l),p=this._map.layerPointToLatLng(d);this._map.fire(a,{latlng:p,layerPoint:d,containerPoint:u,pageX:l.pageX,pageY:l.pageY,originalEvent:s})},_filterClick:function(s){var a=s.timeStamp||s.originalEvent.timeStamp,l=L.DomEvent._lastClick&&a-L.DomEvent._lastClick;return l&&l>100&&l<500||s.target._simulatedClick&&!s._simulated?(L.DomEvent.stop(s),!1):(L.DomEvent._lastClick=a,!0)},_onTouchStart:function(s){this._map._loaded&&this._touchEvent(s,"touchstart")},_onTouchEnd:function(s){this._map._loaded&&this._touchEvent(s,"touchend")},_onTouchCancel:function(s){if(this._map._loaded){var a="touchcancel";this._detectIE()&&(a="pointercancel"),this._touchEvent(s,a)}},_onTouchLeave:function(s){this._map._loaded&&this._touchEvent(s,"touchleave")},_onTouchMove:function(s){this._map._loaded&&this._touchEvent(s,"touchmove")},_detectIE:function(){var s=e.navigator.userAgent,a=s.indexOf("MSIE ");if(a>0)return parseInt(s.substring(a+5,s.indexOf(".",a)),10);if(s.indexOf("Trident/")>0){var l=s.indexOf("rv:");return parseInt(s.substring(l+3,s.indexOf(".",l)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var s=this._icon,a=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?a.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):a.concat(["touchcancel"]),L.DomUtil.addClass(s,"leaflet-clickable"),L.DomEvent.on(s,"click",this._onMouseClick,this),L.DomEvent.on(s,"keypress",this._onKeyPress,this);for(var l=0;l<a.length;l++)L.DomEvent.on(s,a[l],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var s=e.navigator.userAgent,a=s.indexOf("MSIE ");if(a>0)return parseInt(s.substring(a+5,s.indexOf(".",a)),10);if(s.indexOf("Trident/")>0){var l=s.indexOf("rv:");return parseInt(s.substring(l+3,s.indexOf(".",l)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.LatLngUtil={cloneLatLngs:function(s){for(var a=[],l=0,u=s.length;l<u;l++)Array.isArray(s[l])?a.push(L.LatLngUtil.cloneLatLngs(s[l])):a.push(this.cloneLatLng(s[l]));return a},cloneLatLng:function(s){return L.latLng(s.lat,s.lng)}},(function(){var s={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(a){var l,u,d=a.length,p=0,f=Math.PI/180;if(d>2){for(var m=0;m<d;m++)l=a[m],u=a[(m+1)%d],p+=(u.lng-l.lng)*f*(2+Math.sin(l.lat*f)+Math.sin(u.lat*f));p=6378137*p*6378137/2}return Math.abs(p)},formattedNumber:function(a,l){var u=parseFloat(a).toFixed(l),d=L.drawLocal.format&&L.drawLocal.format.numeric,p=d&&d.delimiters,f=p&&p.thousands,m=p&&p.decimal;if(f||m){var y=u.split(".");u=f?y[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+f):y[0],m=m||".",y.length>1&&(u=u+m+y[1])}return u},readableArea:function(a,l,f){var d,p,f=L.Util.extend({},s,f);return l?(p=["ha","m"],type=typeof l,type==="string"?p=[l]:type!=="boolean"&&(p=l),d=a>=1e6&&p.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*a,f.km)+" km":a>=1e4&&p.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*a,f.ha)+" ha":L.GeometryUtil.formattedNumber(a,f.m)+" m"):(a/=.836127,d=a>=3097600?L.GeometryUtil.formattedNumber(a/3097600,f.mi)+" mi":a>=4840?L.GeometryUtil.formattedNumber(a/4840,f.ac)+" acres":L.GeometryUtil.formattedNumber(a,f.yd)+" yd"),d},readableDistance:function(a,l,u,d,m){var f,m=L.Util.extend({},s,m);switch(l?typeof l=="string"?l:"metric":u?"feet":d?"nauticalMile":"yards"){case"metric":f=a>1e3?L.GeometryUtil.formattedNumber(a/1e3,m.km)+" km":L.GeometryUtil.formattedNumber(a,m.m)+" m";break;case"feet":a*=3.28083,f=L.GeometryUtil.formattedNumber(a,m.ft)+" ft";break;case"nauticalMile":a*=.53996,f=L.GeometryUtil.formattedNumber(a/1e3,m.nm)+" nm";break;default:a*=1.09361,f=a>1760?L.GeometryUtil.formattedNumber(a/1760,m.mi)+" miles":L.GeometryUtil.formattedNumber(a,m.yd)+" yd"}return f},isVersion07x:function(){var a=L.version.split(".");return parseInt(a[0],10)===0&&parseInt(a[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(s,a,l,u){return this._checkCounterclockwise(s,l,u)!==this._checkCounterclockwise(a,l,u)&&this._checkCounterclockwise(s,a,l)!==this._checkCounterclockwise(s,a,u)},_checkCounterclockwise:function(s,a,l){return(l.y-s.y)*(a.x-s.x)>(a.y-s.y)*(l.x-s.x)}}),L.Polyline.include({intersects:function(){var s,a,l,u=this._getProjectedPoints(),d=u?u.length:0;if(this._tooFewPointsForIntersection())return!1;for(s=d-1;s>=3;s--)if(a=u[s-1],l=u[s],this._lineSegmentsIntersectsRange(a,l,s-2))return!0;return!1},newLatLngIntersects:function(s,a){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(s),a)},newPointIntersects:function(s,a){var l=this._getProjectedPoints(),u=l?l.length:0,d=l?l[u-1]:null,p=u-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(d,s,p,a?1:0)},_tooFewPointsForIntersection:function(s){var a=this._getProjectedPoints(),l=a?a.length:0;return l+=s||0,!a||l<=3},_lineSegmentsIntersectsRange:function(s,a,l,u){var d,p,f=this._getProjectedPoints();u=u||0;for(var m=l;m>u;m--)if(d=f[m-1],p=f[m],L.LineUtil.segmentsIntersect(s,a,d,p))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var s=[],a=this._defaultShape(),l=0;l<a.length;l++)s.push(this._map.latLngToLayerPoint(a[l]));return s}}),L.Polygon.include({intersects:function(){var s,a,l,u,d=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(s=d.length,a=d[0],l=d[s-1],u=s-2,this._lineSegmentsIntersectsRange(l,a,u,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(s){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,s);var a;this._toolbars={},L.DrawToolbar&&this.options.draw&&(a=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=a,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(a=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=a,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(s){var a,l=L.DomUtil.create("div","leaflet-draw"),u=!1;for(var d in this._toolbars)this._toolbars.hasOwnProperty(d)&&(a=this._toolbars[d].addToolbar(s))&&(u||(L.DomUtil.hasClass(a,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(a.childNodes[0],"leaflet-draw-toolbar-top"),u=!0),l.appendChild(a));return l},onRemove:function(){for(var s in this._toolbars)this._toolbars.hasOwnProperty(s)&&this._toolbars[s].removeToolbar()},setDrawingOptions:function(s){for(var a in this._toolbars)this._toolbars[a]instanceof L.DrawToolbar&&this._toolbars[a].setOptions(s)},_toolbarEnabled:function(s){var a=s.target;for(var l in this._toolbars)this._toolbars[l]!==a&&this._toolbars[l].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(s){L.setOptions(this,s),this._modes={},this._actionButtons=[],this._activeMode=null;var a=L.version.split(".");parseInt(a[0],10)===1&&parseInt(a[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(s){var a,l=L.DomUtil.create("div","leaflet-draw-section"),u=0,d=this._toolbarClass||"",p=this.getModeHandlers(s);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=s,a=0;a<p.length;a++)p[a].enabled&&this._initModeHandler(p[a].handler,this._toolbarContainer,u++,d,p[a].title);if(u)return this._lastButtonIndex=--u,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),l.appendChild(this._toolbarContainer),l.appendChild(this._actionsContainer),l},removeToolbar:function(){for(var s in this._modes)this._modes.hasOwnProperty(s)&&(this._disposeButton(this._modes[s].button,this._modes[s].handler.enable,this._modes[s].handler),this._modes[s].handler.disable(),this._modes[s].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var a=0,l=this._actionButtons.length;a<l;a++)this._disposeButton(this._actionButtons[a].button,this._actionButtons[a].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(s,a,l,u,d){var p=s.type;this._modes[p]={},this._modes[p].handler=s,this._modes[p].button=this._createButton({type:p,title:d,className:u+"-"+p,container:a,callback:this._modes[p].handler.enable,context:this._modes[p].handler}),this._modes[p].buttonIndex=l,this._modes[p].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(s){var a=L.DomUtil.create("a",s.className||"",s.container),l=L.DomUtil.create("span","sr-only",s.container);a.href="#",a.appendChild(l),s.title&&(a.title=s.title,l.innerHTML=s.title),s.text&&(a.innerHTML=s.text,l.innerHTML=s.text);var u=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(a,"click",L.DomEvent.stopPropagation).on(a,"mousedown",L.DomEvent.stopPropagation).on(a,"dblclick",L.DomEvent.stopPropagation).on(a,"touchstart",L.DomEvent.stopPropagation).on(a,"click",L.DomEvent.preventDefault).on(a,u,s.callback,s.context),a},_disposeButton:function(s,a){var l=this._detectIOS()?"touchstart":"click";L.DomEvent.off(s,"click",L.DomEvent.stopPropagation).off(s,"mousedown",L.DomEvent.stopPropagation).off(s,"dblclick",L.DomEvent.stopPropagation).off(s,"touchstart",L.DomEvent.stopPropagation).off(s,"click",L.DomEvent.preventDefault).off(s,l,a)},_handlerActivated:function(s){this.disable(),this._activeMode=this._modes[s.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(s){var a,l,u,d,p=this._actionsContainer,f=this.getActions(s),m=f.length;for(l=0,u=this._actionButtons.length;l<u;l++)this._disposeButton(this._actionButtons[l].button,this._actionButtons[l].callback);for(this._actionButtons=[];p.firstChild;)p.removeChild(p.firstChild);for(var y=0;y<m;y++)"enabled"in f[y]&&!f[y].enabled||(a=L.DomUtil.create("li","",p),d=this._createButton({title:f[y].title,text:f[y].text,container:a,callback:f[y].callback,context:f[y].context}),this._actionButtons.push({button:d,callback:f[y].callback}))},_showActionsToolbar:function(){var s=this._activeMode.buttonIndex,a=this._lastButtonIndex,l=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=l+"px",s===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),s===a&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(s){this._map=s,this._popupPane=s._panes.popupPane,this._visible=!1,this._container=s.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(s){return this._container?(s.subtext=s.subtext||"",s.subtext.length!==0||this._singleLineLabel?s.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(s.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+s.subtext+"</span><br />":"")+"<span>"+s.text+"</span>",s.text||s.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(s){var a=this._map.latLngToLayerPoint(s),l=this._container;return this._container&&(this._visible&&(l.style.visibility="inherit"),L.DomUtil.setPosition(l,a)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(s){for(var a in this.options)this.options.hasOwnProperty(a)&&s[a]&&(s[a]=L.extend({},this.options[a],s[a]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,s)},getModeHandlers:function(s){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(s,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(s,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(s,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(s,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(s,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(s,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(s){return[{enabled:s.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:s.completeShape,context:s},{enabled:s.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:s.deleteLastVertex,context:s},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(s){L.setOptions(this,s);for(var a in this._modes)this._modes.hasOwnProperty(a)&&s.hasOwnProperty(a)&&this._modes[a].handler.setOptions(s[a])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(s){s.edit&&(s.edit.selectedPathOptions===void 0&&(s.edit.selectedPathOptions=this.options.edit.selectedPathOptions),s.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,s.edit.selectedPathOptions)),s.remove&&(s.remove=L.extend({},this.options.remove,s.remove)),s.poly&&(s.poly=L.extend({},this.options.poly,s.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,s),this._selectedFeatureCount=0},getModeHandlers:function(s){var a=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(s,{featureGroup:a,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(s,{featureGroup:a}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(s){var a=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return s.removeAllLayers&&a.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),a},addToolbar:function(s){var a=L.Toolbar.prototype.addToolbar.call(this,s);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),a},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var s,a=this.options.featureGroup,l=a.getLayers().length!==0;this.options.edit&&(s=this._modes[L.EditToolbar.Edit.TYPE].button,l?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(s=this._modes[L.EditToolbar.Delete.TYPE].button,l?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(s,a){if(L.Handler.prototype.initialize.call(this,s),L.setOptions(this,a),this._featureGroup=a.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),s._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(s){this._revertLayer(s)},this)},save:function(){var s=new L.LayerGroup;this._featureGroup.eachLayer(function(a){a.edited&&(s.addLayer(a),a.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:s})},_backupLayer:function(s){var a=L.Util.stamp(s);this._uneditedLayerProps[a]||(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?this._uneditedLayerProps[a]={latlngs:L.LatLngUtil.cloneLatLngs(s.getLatLngs())}:s instanceof L.Circle?this._uneditedLayerProps[a]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng()),radius:s.getRadius()}:(s instanceof L.Marker||s instanceof L.CircleMarker)&&(this._uneditedLayerProps[a]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(s){var a=L.Util.stamp(s);s.edited=!1,this._uneditedLayerProps.hasOwnProperty(a)&&(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?s.setLatLngs(this._uneditedLayerProps[a].latlngs):s instanceof L.Circle?(s.setLatLng(this._uneditedLayerProps[a].latlng),s.setRadius(this._uneditedLayerProps[a].radius)):(s instanceof L.Marker||s instanceof L.CircleMarker)&&s.setLatLng(this._uneditedLayerProps[a].latlng),s.fire("revert-edited",{layer:s}))},_enableLayerEdit:function(s){var a,l,u=s.layer||s.target||s;this._backupLayer(u),this.options.poly&&(l=L.Util.extend({},this.options.poly),u.options.poly=l),this.options.selectedPathOptions&&(a=L.Util.extend({},this.options.selectedPathOptions),a.maintainColor&&(a.color=u.options.color,a.fillColor=u.options.fillColor),u.options.original=L.extend({},u.options),u.options.editing=a),u instanceof L.Marker?(u.editing&&u.editing.enable(),u.dragging.enable(),u.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):u.editing.enable()},_disableLayerEdit:function(s){var a=s.layer||s.target||s;a.edited=!1,a.editing&&a.editing.disable(),delete a.options.editing,delete a.options.original,this._selectedPathOptions&&(a instanceof L.Marker?this._toggleMarkerHighlight(a):(a.setStyle(a.options.previousOptions),delete a.options.previousOptions)),a instanceof L.Marker?(a.dragging.disable(),a.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):a.editing.disable()},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_onMarkerDragEnd:function(s){var a=s.target;a.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:a})},_onTouchMove:function(s){var a=s.originalEvent.changedTouches[0],l=this._map.mouseEventToLayerPoint(a),u=this._map.layerPointToLatLng(l);s.target.setLatLng(u)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(s,a){if(L.Handler.prototype.initialize.call(this,s),L.Util.setOptions(this,a),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(s){this._deletableLayers.addLayer(s),s.fire("revert-deleted",{layer:s})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(s){this._removeLayer({layer:s})},this),this.save()},_enableLayerDelete:function(s){(s.layer||s.target||s).on("click",this._removeLayer,this)},_disableLayerDelete:function(s){var a=s.layer||s.target||s;a.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(a)},_removeLayer:function(s){var a=s.layer||s.target||s;this._deletableLayers.removeLayer(a),this._deletedLayers.addLayer(a),a.fire("deleted")},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const _v=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"",Uh=e=>e.length*6+12,Rc=(e,t)=>!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom),z0=(e,t)=>{if(!e||t.length===0)return new Set;const o=[],i=e.getBounds();t.forEach(l=>{if(i.contains(l.getLatLng())){const u=e.latLngToContainerPoint(l.getLatLng()),d=l.locationData;d&&o.push({marker:l,pixelPos:u,location:d})}});const s=o.map(({marker:l,pixelPos:u,location:d})=>{const m=Uh(d.name),y=d.description?Uh(`${d.name}: ${_v(d.description,50)}`):m;return{marker:l,location:d,markerBox:{left:u.x-15,right:u.x+15,top:u.y-15,bottom:u.y+15},baseLabelBox:{left:u.x-m/2,right:u.x+m/2,top:u.y+15+2,bottom:u.y+15+2+20},descLabelBox:d.description?{left:u.x-y/2,right:u.x+y/2,top:u.y+15+2,bottom:u.y+15+2+20}:null}}),a=new Set;return s.forEach(({marker:l,location:u,markerBox:d,baseLabelBox:p,descLabelBox:f},m)=>{if(!u.description)return;let y=!1;for(let _=0;_<s.length;_++){if(m===_)continue;const b=s[_];if(Rc(f,b.markerBox)||Rc(f,b.baseLabelBox)){y=!0;break}if(b.descLabelBox&&a.has(b.location.id)&&Rc(f,b.descLabelBox)){y=!0;break}}y||a.add(u.id)}),a},nr=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"hexagon",label:"Hexagon"},{value:"pentagon",label:"Pentagon"},{value:"diamond",label:"Diamond"},{value:"star",label:"Star"},{value:"dot",label:"Dot"},{value:"none",label:"None"}],H0=[{value:"33",label:"Small (33%)"},{value:"66",label:"Medium (66%)"},{value:"100",label:"Normal (100%)"},{value:"150",label:"Large (150%)"}],$r=[{value:"default",label:"Default",isShapeOnly:!1,category:"default"},{value:"dot",label:"Dot",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"circle",label:"Circle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"square",label:"Square",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"triangle",label:"Triangle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"diamond",label:"Diamond",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"star",label:"Star",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"hexagon",label:"Hexagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"pentagon",label:"Pentagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"car",label:"Car",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"bike",label:"Bike",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"water",label:"Water",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"food",label:"Food",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"medical",label:"Medical",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"photo",label:"Photo",isShapeOnly:!1,category:"content",defaultColor:"#8B5CF6"},{value:"music",label:"Music",isShapeOnly:!1,category:"content",defaultColor:"#EC4899"},{value:"start",label:"Start",isShapeOnly:!1,category:"content",defaultColor:"#10B981"},{value:"finish",label:"Finish",isShapeOnly:!1,category:"content",defaultColor:"#1F2937"},{value:"toilet",label:"Toilet",isShapeOnly:!1,category:"content",defaultColor:"#6366F1"},{value:"shower",label:"Shower",isShapeOnly:!1,category:"content",defaultColor:"#06B6D4"},{value:"bus",label:"Bus",isShapeOnly:!1,category:"content",defaultColor:"#F97316"},{value:"info",label:"Information",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"merch",label:"Merchandise",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"cone",label:"Road closure",isShapeOnly:!1,category:"content",defaultColor:"#FF6B00"},{value:"traffic",label:"Traffic management",isShapeOnly:!1,category:"content",defaultColor:"#374151"},{value:"track",label:"Track",isShapeOnly:!1,category:"content",defaultColor:"#78716C"},{value:"tunnel",label:"Tunnel",isShapeOnly:!1,category:"content",defaultColor:"#57534E"},{value:"bridge",label:"Bridge",isShapeOnly:!1,category:"content",defaultColor:"#0284C7"},{value:"plane",label:"Plane",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"hill",label:"Hill",isShapeOnly:!1,category:"content",defaultColor:"#65A30D"},{value:"baggage",label:"Baggage",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"crown",label:"Crown",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"crossing",label:"Crossing point",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"trees",label:"Trees",isShapeOnly:!1,category:"content",defaultColor:"#22C55E"},{value:"arrow-uturn-left",label:"Left u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-left",label:"Left turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-left",label:"Slight left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-straight",label:"Straight ahead",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-right",label:"Slight right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-right",label:"Right turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-uturn-right",label:"Right u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-left",label:"Left fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-right",label:"Right fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-left",label:"Keep left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-right",label:"Keep right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"}];function ea(e){return $r.find(t=>t.value===e)||$r[0]}function V0(e){return ea(e).defaultColor||"#667eea"}function G0(e,t){return t||V0(e)}const hu={dot:(e,t=32)=>{const o=(t/2-2)*.33;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="1.5"/>
    </svg>`},circle:(e,t=32)=>{const o=t/2-2;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`},square:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect x="4" y="4" width="${t-8}" height="${t-8}" rx="4" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`,triangle:(e,t=32)=>{const o=t/2,i=4,s=t-4,a=4,l=t-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${i} ${l},${s} ${a},${s}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},diamond:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${i-s} ${o+s},${i} ${o},${i+s} ${o-s},${i}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},star:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-3,a=s*.4,l=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;l.push(`${o+s*Math.cos(d)},${i+s*Math.sin(d)}`);const p=d+Math.PI/5;l.push(`${o+a*Math.cos(p)},${i+a*Math.sin(p)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${l.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},hexagon:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4,a=[];for(let l=0;l<6;l++){const u=Math.PI/6+l*Math.PI/3;a.push(`${o+s*Math.cos(u)},${i+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${a.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},pentagon:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4,a=[];for(let l=0;l<5;l++){const u=Math.PI/2*-1+l*2*Math.PI/5;a.push(`${o+s*Math.cos(u)},${i+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${a.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},car:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Car body -->
      <rect x="6" y="13" width="20" height="8" rx="2" fill="#fff"/>
      <!-- Car roof/cabin -->
      <path d="M10 13 L12 9 L20 9 L22 13" fill="#fff" stroke="#fff" stroke-width="1"/>
      <!-- Windows -->
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${e}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${e}"/>
      <!-- Tires (always black) -->
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <!-- Wheel centers -->
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>
    </svg>`,bike:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Tires (same color as bike) -->
      <circle cx="9" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <!-- Wheel centers -->
      <circle cx="9" cy="20" r="1" fill="#fff"/>
      <circle cx="23" cy="20" r="1" fill="#fff"/>
      <!-- Frame -->
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
      <!-- Handlebars -->
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <!-- Seat -->
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="#fff"/>
    </svg>`},zh={water:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="#fff"/>
    </svg>`,food:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="#fff"/>
      <path d="M21 9v14h2V9h-2z" fill="#fff"/>
    </svg>`,medical:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#fff" stroke-width="2"/>
      <rect x="14" y="8" width="4" height="16" rx="1" fill="#fff"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="#fff"/>
    </svg>`,photo:(e=32)=>{const t="#8B5CF6";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="8" y="10" width="16" height="12" rx="2" fill="#fff"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" y="13" r="1" fill="${t}"/>
    </svg>`},music:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EC4899" stroke="#fff" stroke-width="2"/>
      <path d="M12 22c1.66 0 3-1.34 3-3v-9h5v4h-3v5c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.35 0 .69.07 1 .18V10c0-.55.45-1 1-1h5c.55 0 1 .45 1 1v6h-5v5c0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.7 0 1.37.15 2 .41" fill="#fff"/>
      <ellipse cx="12" cy="21" rx="2.5" ry="2" fill="#fff"/>
      <rect x="14" y="10" width="2" height="9" fill="#fff"/>
      <rect x="14" y="10" width="6" height="2" fill="#fff"/>
    </svg>`,start:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#10B981" stroke="#fff" stroke-width="2"/>
      <path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="#fff"/>
    </svg>`,finish:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#1F2937" stroke="#fff" stroke-width="2"/>
      <rect x="10" y="8" width="4" height="4" fill="#fff"/>
      <rect x="14" y="12" width="4" height="4" fill="#fff"/>
      <rect x="18" y="8" width="4" height="4" fill="#fff"/>
      <rect x="10" y="16" width="4" height="4" fill="#fff"/>
      <rect x="18" y="16" width="4" height="4" fill="#fff"/>
      <rect x="14" y="20" width="4" height="4" fill="#fff"/>
    </svg>`,toilet:(e=32)=>{const t="#6366F1";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="11" y="7" width="10" height="3" rx="1" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>
    </svg>`},shower:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#06B6D4" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="3" fill="#fff"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="#fff"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
    </svg>`,bus:(e=32)=>{const t="#F97316";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="9" y="9" width="14" height="12" rx="2" fill="#fff"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="#fff"/>
      <circle cx="12" cy="21" r="1.5" fill="#fff"/>
      <circle cx="20" cy="21" r="1.5" fill="#fff"/>
    </svg>`},info:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#0EA5E9" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="2" fill="#fff"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="#fff"/>
    </svg>`,merch:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#A855F7" stroke="#fff" stroke-width="2"/>
      <path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="#fff"/>
      <path d="M13 10 L16 7 L19 10" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>`,cone:(e=32)=>{const t="#FF6B00";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L21 22 H11 L16 6Z" fill="#fff"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="#fff"/>
    </svg>`},traffic:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#374151" stroke="#fff" stroke-width="2"/>
      <rect x="12" y="6" width="8" height="20" rx="2" fill="#fff"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>
    </svg>`,crown:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="#fff"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="#fff"/>
    </svg>`,crossing:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="#fff" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="#fff" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="#fff"/>
      <path d="M16 10 L16 16" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
    </svg>`,trees:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#22C55E" stroke="#fff" stroke-width="2"/>
      <!-- Left tree -->
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="#fff"/>
      <!-- Right tree -->
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="#fff"/>
    </svg>`,"arrow-uturn-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on right, curve left, down on left -->
      <path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on left side -->
      <path d="M7 15 L12 21 L17 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="#fff"/>
    </svg>`,"arrow-slight-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-straight":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
    </svg>`,"arrow-slight-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="#fff"/>
    </svg>`,"arrow-uturn-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on left, curve right, down on right -->
      <path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on right side -->
      <path d="M15 15 L20 21 L25 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-fork-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (correct way - with arrow) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M10 12 L6 10 L8 16 Z" fill="#fff"/>
      <!-- Right fork (wrong way - with X) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
    </svg>`,"arrow-fork-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (wrong way - with X) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <!-- Right fork (correct way - with arrow) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M22 12 L26 10 L24 16 Z" fill="#fff"/>
    </svg>`,"arrow-keep-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-keep-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`},ba={circle:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="14" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,square:({backgroundColor:e,borderColor:t})=>`<rect x="4" y="4" width="24" height="24" rx="4" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,hexagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=[];for(let a=0;a<6;a++){const l=Math.PI/6+a*Math.PI/3;s.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},pentagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=[];for(let a=0;a<5;a++){const l=Math.PI/2*-1+a*2*Math.PI/5;s.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},diamond:({backgroundColor:e,borderColor:t})=>`<polygon points="16,4 28,16 16,28 4,16" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}" stroke-linejoin="round"/>`,star:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=13,a=s*.4,l=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;l.push(`${16+s*Math.cos(d)},${16+s*Math.sin(d)}`);const p=d+Math.PI/5;l.push(`${16+a*Math.cos(p)},${16+a*Math.sin(p)}`)}return`<polygon points="${l.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},dot:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="5" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:1.5}"/>`,none:()=>""},Hh={water:(e="#fff")=>`<path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="${e}"/>`,food:(e="#fff")=>`<path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="${e}"/>
      <path d="M21 9v14h2V9h-2z" fill="${e}"/>`,medical:(e="#fff")=>`<rect x="14" y="8" width="4" height="16" rx="1" fill="${e}"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="${e}"/>`,photo:(e="#fff",t="#667eea")=>`<rect x="8" y="10" width="16" height="12" rx="2" fill="${e}"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" cy="13" r="1" fill="${t}"/>`,music:(e="#fff")=>`<ellipse cx="12" cy="21" rx="2.5" ry="2" fill="${e}"/>
      <rect x="14" y="10" width="2" height="9" fill="${e}"/>
      <rect x="14" y="10" width="6" height="2" fill="${e}"/>`,start:(e="#fff")=>`<path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="${e}"/>`,finish:(e="#fff")=>`<rect x="10" y="8" width="4" height="4" fill="${e}"/>
      <rect x="14" y="12" width="4" height="4" fill="${e}"/>
      <rect x="18" y="8" width="4" height="4" fill="${e}"/>
      <rect x="10" y="16" width="4" height="4" fill="${e}"/>
      <rect x="18" y="16" width="4" height="4" fill="${e}"/>
      <rect x="14" y="20" width="4" height="4" fill="${e}"/>`,toilet:(e="#fff",t="#667eea")=>`<rect x="11" y="7" width="10" height="3" rx="1" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="${e}" stroke-width="2" fill="none" stroke-linecap="round"/>`,shower:(e="#fff")=>`<circle cx="16" cy="10" r="3" fill="${e}"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="${e}"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>`,bus:(e="#fff",t="#667eea")=>`<rect x="9" y="9" width="14" height="12" rx="2" fill="${e}"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="${e}"/>
      <circle cx="12" cy="21" r="1.5" fill="${e}"/>
      <circle cx="20" cy="21" r="1.5" fill="${e}"/>`,info:(e="#fff")=>`<circle cx="16" cy="10" r="2" fill="${e}"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="${e}"/>`,merch:(e="#fff")=>`<path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="${e}"/>
      <path d="M13 10 L16 7 L19 10" stroke="${e}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`,cone:(e="#fff",t="#667eea")=>`<path d="M16 6 L21 22 H11 L16 6Z" fill="${e}"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="${e}"/>`,traffic:(e="#fff")=>`<rect x="12" y="6" width="8" height="20" rx="2" fill="${e}"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>`,car:(e="#fff",t="#667eea")=>`<rect x="6" y="13" width="20" height="8" rx="2" fill="${e}"/>
      <path d="M10 13 L12 9 L20 9 L22 13" fill="${e}" stroke="${e}" stroke-width="1"/>
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${t}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${t}"/>
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>`,bike:(e="#fff")=>`<circle cx="9" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="9" cy="20" r="1" fill="${e}"/>
      <circle cx="23" cy="20" r="1" fill="${e}"/>
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="${e}" stroke-width="2" stroke-linejoin="round"/>
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="${e}"/>`,"arrow-uturn-left":(e="#fff")=>`<path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7 15 L12 21 L17 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-left":(e="#fff")=>`<path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="${e}"/>`,"arrow-slight-left":(e="#fff")=>`<g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-straight":(e="#fff")=>`<path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>`,"arrow-slight-right":(e="#fff")=>`<g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-right":(e="#fff")=>`<path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="${e}"/>`,"arrow-uturn-right":(e="#fff")=>`<path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 15 L20 21 L25 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-fork-left":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Left arrowhead -->
      <path d="M10 12 L6 10 L8 16 Z" fill="${e}"/>
      <!-- Wrong way indicator on right -->
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>`,"arrow-fork-right":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <!-- Wrong way indicator on left -->
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Right arrowhead -->
      <path d="M22 12 L26 10 L24 16 Z" fill="${e}"/>`,"arrow-keep-left":(e="#fff")=>`<g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-keep-right":(e="#fff")=>`<g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,track:(e="#fff")=>`
      <rect x="10" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="19.5" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="8" y="9" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="14.5" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="20" width="16" height="2.5" rx="0.5" fill="${e}"/>`,tunnel:(e="#fff")=>`
      <path d="M7 25 L7 14 C7 8 11 5 16 5 C21 5 25 8 25 14 L25 25" fill="none" stroke="${e}" stroke-width="2.5"/>
      <path d="M11 25 L11 16 C11 12 13 10 16 10 C19 10 21 12 21 16 L21 25" fill="none" stroke="${e}" stroke-width="1.5" opacity="0.6"/>`,bridge:(e="#fff")=>`
      <rect x="5" y="18" width="22" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="7" y="10" width="2" height="8" fill="${e}"/>
      <rect x="23" y="10" width="2" height="8" fill="${e}"/>
      <path d="M8 10 Q16 6 24 10" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <line x1="12" y1="13" x2="12" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="16" y1="11.5" x2="16" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="20" y1="13" x2="20" y2="18" stroke="${e}" stroke-width="1.5"/>`,plane:(e="#fff")=>`
      <g fill="${e}">
        <!-- Fuselage body -->
        <path d="M27 16 L24 14 L8 14 Q4 16 8 18 L24 18 L27 16 Z"/>
        <!-- Nose cone -->
        <path d="M8 14 Q4 16 8 18 L8 14 Z"/>
        <!-- Tail fin -->
        <path d="M26 14 L26 9 L22 14 Z"/>
        <!-- Main wing -->
        <path d="M20 16 L16 10 L14 10 L16 16 L14 22 L16 22 L20 16 Z"/>
        <!-- Cockpit window -->
        <ellipse cx="10" cy="16" rx="1.5" ry="1" fill="none" stroke="${e}" stroke-width="0.5" opacity="0.6"/>
      </g>`,hill:(e="#fff")=>`
      <path d="M6 24 L13 12 L16 16 L20 10 L26 24 Z" fill="${e}"/>
      <path d="M20 10 L22 13 L18 13 Z" fill="${e}" opacity="0.6"/>`,baggage:(e="#fff")=>`
      <rect x="8" y="12" width="16" height="12" rx="2" fill="${e}"/>
      <rect x="12" y="8" width="8" height="4" rx="1" fill="none" stroke="${e}" stroke-width="2"/>
      <line x1="12" y1="16" x2="20" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
      <line x1="12" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>`,crown:(e="#fff")=>`
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="${e}"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="${e}"/>`,crossing:(e="#fff")=>`
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="${e}" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="${e}" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="${e}"/>
      <path d="M16 10 L16 16" stroke="${e}" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>`,trees:(e="#fff")=>`
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="${e}"/>
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="${e}"/>`};function wn({type:e,backgroundShape:t="circle",backgroundColor:o,borderColor:i,iconColor:s,size:a="100",outputSize:l=null}){if(!e||e==="default"){if(!(o||i||s||t&&t!=="circle"&&t!=="default"))return null;e=t&&t!=="default"?t:"circle"}const u=ea(e),d=parseInt(a,10)/100,p=l||Math.round(32*d);let f="";if(u.isShapeOnly){const m=o||u.defaultColor||"#667eea",y=i||"#fff";if(ba[e])f=ba[e]({backgroundColor:m,borderColor:y});else return hu[e]?.(m,p)||null}else{const m=o||"#667eea",y=i||"#fff",_=s||"#fff",b=t||"circle";b!=="none"&&ba[b]&&(f+=ba[b]({backgroundColor:m,borderColor:y})),Hh[e]&&(f+=Hh[e](_,m))}return`<svg width="${p}" height="${p}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
    ${f}
  </svg>`}const j0={full:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#10B981" stroke="#fff" stroke-width="1.5"/>
    <path d="M4 7l2 2 4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </svg>`,partial:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#F59E0B" stroke="#fff" stroke-width="1.5"/>
    <rect x="6" y="3.5" width="2" height="4.5" rx="1" fill="#fff"/>
    <circle cx="7" cy="10" r="1" fill="#fff"/>
  </svg>`,missing:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#EF4444" stroke="#fff" stroke-width="1.5"/>
    <path d="M4.5 4.5l5 5M9.5 4.5l-5 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
  </svg>`};function Z0(e,t){return e===0?"missing":e>=t?"full":"partial"}function fu(e,t){const o=Z0(e,t);return j0[o]}function q0(e,t,o=32){if(e==="default")return null;if(zh[e])return zh[e](o);if(hu[e]){const i=t||"#667eea";return hu[e](i,o)}return null}const W0=["circle","square","hexagon","pentagon"];function K0(e){return W0.includes(e)}function Y0(e,t,o,i,s=32,a=!0){const l=q0(e,t,s),u=fu(o,i);if(!l)return null;const d=a&&K0(e),p=G0(e,t),f=X0(p),m=bv(p)?"0 1px 2px rgba(255,255,255,0.5)":"0 1px 2px rgba(0,0,0,0.5)",y=s>=36?"12px":"10px",_=d?`
    <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: ${f};
      font-weight: bold;
      font-size: ${y};
      text-shadow: ${m};
      pointer-events: none;
    ">${o}/${i}</div>
  `:"";return`
    <div style="position: relative; width: ${s}px; height: ${s}px;">
      ${l}
      ${_}
      <div style="position: absolute; bottom: -4px; right: -4px;">
        ${u}
      </div>
    </div>
  `}function J0(e){const t=e.replace("#",""),o=parseInt(t.substr(0,2),16)/255,i=parseInt(t.substr(2,2),16)/255,s=parseInt(t.substr(4,2),16)/255,a=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),l=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*a+.7152*l+.0722*u}function bv(e){return!e||e.length<6?!1:J0(e)>.4}function X0(e){return bv(e)?"#1F2937":"#FFFFFF"}const Q0={class:"map-container-wrapper"},ew="#667eea",tw={__name:"MapView",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},clickable:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1},editingPolygon:{type:Array,default:null},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","polygon-complete","polygon-drawing","polygon-update","visibility-change"],setup(e,{expose:t,emit:o}){const i=e,s=o,a=M(null);let l=null;const u=M([]),d=M([]),p=M([]);let f=null,m=null;const y=M([]);let _=null,b=null,S=!1;const T=M(!1),D=()=>{if(l){const te=l.getCenter();return{lat:te.lat,lng:te.lng}}return null},I=()=>l?l.getZoom():null,C=()=>{if(u.value.length>0){p.value.push([...u.value]);const te=d.value.pop()||[];u.value=te,le(),s("polygon-drawing",u.value)}},A=()=>{if(p.value.length>0){d.value.push([...u.value]);const te=p.value.pop();u.value=te,le(),s("polygon-drawing",u.value)}},E=()=>u.value.length>0,N=()=>p.value.length>0,$=()=>u.value.length,G=()=>{u.value.length>=3&&(s("polygon-complete",[...u.value]),R())},R=()=>{u.value=[],d.value=[],p.value=[],le()},Z=()=>{!l||!i.userLocation||(l.setView([i.userLocation.lat,i.userLocation.lng],l.getZoom(),{animate:!0,duration:.5}),T.value=!0)},U=(te,ke,se=null)=>{if(!l||te==null||ke==null)return;l.setView([te,ke],se??l.getZoom(),{animate:!0,duration:.5});const Q=i.center&&Math.abs(i.center.lat-te)<1e-4&&Math.abs(i.center.lng-ke)<1e-4;T.value=!Q},K=M(!0),re=M(!0),Pe=(te,ke)=>{if(!l||te==null||ke==null)return!0;const se=l.getBounds(),Q=Kt.latLng(te,ke);return se.contains(Q)};t({getMapCenter:D,getMapZoom:I,undoPolygonPoint:C,redoPolygonPoint:A,canUndo:E,canRedo:N,getPolygonPointCount:$,completePolygon:G,clearPolygonDrawing:R,recenterOnUserLocation:Z,recenterOnLocation:U,isLocationInView:Pe,userLocationInView:re,highlightedLocationInView:K});const me=M([]);let Ae=null;const Fe=M(!0),ae=M(!1),Me=M(new Set),ge=M([]);let de=null,Oe=null;const Xe=H(()=>i.hideRecenterButton||!i.highlightLocationId||!T.value?!1:!K.value),et=()=>{if(i.highlightLocationId){const te=i.locations.find(ke=>ke.id===i.highlightLocationId);if(te?.latitude&&te?.longitude){K.value=Pe(te.latitude,te.longitude);return}}if(i.highlightLocationIds&&i.highlightLocationIds.length>0){const te=i.highlightLocationIds[0],ke=i.locations.find(se=>se.id===te);if(ke?.latitude&&ke?.longitude){K.value=Pe(ke.latitude,ke.longitude);return}}if(!l){K.value=!0;return}K.value=!0},qe=()=>{if(!l||!i.userLocation){re.value=!0;return}re.value=Pe(i.userLocation.lat,i.userLocation.lng)},tt=()=>{et(),qe(),s("visibility-change",{userLocationInView:re.value,highlightedLocationInView:K.value})},be=()=>{if(!l||!i.highlightLocationId)return;const te=i.locations.find(ke=>ke.id===i.highlightLocationId);!te||!te.latitude||!te.longitude||(l.setView([te.latitude,te.longitude],l.getZoom(),{animate:!0,duration:.5}),T.value=!1,K.value=!0)},He=(te,ke,se,Q,X=!1)=>{const O=se?"36px":Q?"20px":"30px",q=se?"#667eea":"white",J=X?"":fu(te,ke);return`
    <div style="position: relative; width: ${O}; height: ${O};">
      <div style="
        background-color: ${ew};
        width: ${O};
        height: ${O};
        border-radius: 50%;
        border: 3px solid ${q};
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      "></div>
      ${X?"":`<div style="position: absolute; bottom: -4px; right: -4px;">
        ${J}
      </div>`}
    </div>
  `},fe=()=>{if(!l)return;const te=z0(l,me.value),ke=Array.from(Me.value).sort().join(","),se=Array.from(te).sort().join(",");ke!==se&&(Me.value=te,we())},Ie=()=>{if(Oe&&(Oe.remove(),Oe=null),!l||!i.userLocation)return;const te=Kt.divIcon({className:"user-location-marker",html:`
      <div style="
        position: relative;
        width: 20px;
        height: 20px;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #4285f4;
          border: 3px solid white;
          border-radius: 50%;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        "></div>
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 40px;
          height: 40px;
          background-color: rgba(66, 133, 244, 0.2);
          border-radius: 50%;
          animation: pulse 2s ease-out infinite;
        "></div>
      </div>
    `,iconSize:[40,40],iconAnchor:[20,20]});Oe=Kt.marker([i.userLocation.lat,i.userLocation.lng],{icon:te}).addTo(l).bindPopup("Your location")},Te=()=>{if(!a.value)return;let te=51.505,ke=-.09,se=13;const Q=i.allLocationsForBounds.length>0?i.allLocationsForBounds:i.locations,X=(q,J)=>q!=null&&J!=null&&!(q===0&&J===0),O=[];Q.length>0&&O.push(...Q.filter(q=>X(q.latitude,q.longitude)).map(q=>({lat:q.latitude,lng:q.longitude}))),i.route&&i.route.length>0&&O.push(...i.route.filter(q=>X(q.lat,q.lng)).map(q=>({lat:q.lat,lng:q.lng}))),i.center?(te=i.center.lat,ke=i.center.lng,se=i.zoom??13):O.length>0&&(te=O.reduce((q,J)=>q+J.lat,0)/O.length,ke=O.reduce((q,J)=>q+J.lng,0)/O.length,se=10),l=Kt.map(a.value).setView([te,ke],se),Kt.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(l),i.clickable&&l.on("click",q=>{i.drawingMode||s("map-click",{lat:q.latlng.lat,lng:q.latlng.lng})}),l.on("zoomstart",()=>{De=!0}),l.on("zoomend moveend",()=>{De=!1,ce?we():fe(),tt()}),l.on("dragstart",()=>{T.value=!0}),we(),W(),Y(),Ie(),oe(),ie()},W=()=>{if(Ae&&(Ae.remove(),Ae=null),!l||i.route.length===0)return;const te=i.route.map(ke=>[ke.lat,ke.lng]);Ae=Kt.polyline(te,{color:"blue",weight:4,opacity:.7}).addTo(l)},Y=()=>{ge.value.forEach(te=>te.remove()),ge.value=[],!(!l||i.areas.length===0)&&i.areas.forEach(te=>{const ke=typeof te.polygon=="string"?JSON.parse(te.polygon):te.polygon;if(!ke||ke.length===0)return;const se=ke.map(q=>[q.lat,q.lng]),Q=te.id===i.selectedAreaId,X=te.color||"#667eea",O=Kt.polygon(se,{color:X,fillColor:X,fillOpacity:Q?.4:.2,weight:Q?3:2,opacity:.8}).addTo(l);O.setStyle({pane:"overlayPane"}),i.drawingMode||(O.on("click",()=>s("area-click",te)),O.on("mouseover",()=>{O.setStyle({fillOpacity:.4})}),O.on("mouseout",()=>{O.setStyle({fillOpacity:Q?.4:.2})})),ge.value.push(O)})},le=()=>{if(l&&(f&&(f.remove(),f=null),m&&(m.remove(),m=null),u.value.length!==0&&(m=Kt.layerGroup().addTo(l),u.value.forEach((te,ke)=>{const se=ke===0,Q=ke===u.value.length-1,X=Kt.divIcon({className:"polygon-point-marker",html:`<div style="
        width: ${se?"16px":"12px"};
        height: ${se?"16px":"12px"};
        background-color: ${se?"#667eea":Q?"#ff9800":"white"};
        border: 3px solid #667eea;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      "></div>`,iconSize:[se?16:12,se?16:12],iconAnchor:[se?8:6,se?8:6]});Kt.marker([te.lat,te.lng],{icon:X,interactive:!1}).addTo(m)}),u.value.length>=2))){const te=u.value.map(ke=>[ke.lat,ke.lng]);u.value.length>=3&&te.push(te[0]),f=Kt.polyline(te,{color:"#667eea",weight:3,opacity:.8,dashArray:u.value.length<3?"10, 10":null}).addTo(l)}},ye=()=>{if(!l||(_&&(_.remove(),_=null),b&&(b.remove(),b=null),y.value.length===0))return;const te=y.value.map(se=>[se.lat,se.lng]);_=Kt.polygon(te,{color:"#667eea",fillColor:"#667eea",fillOpacity:.2,weight:3,opacity:.8,pane:"overlayPane"}).addTo(l),_.bringToFront(),b=Kt.layerGroup({pane:"markerPane"}).addTo(l);const ke=se=>{y.value.length<=3||(y.value.splice(se,1),S=!0,s("polygon-update",[...y.value]),ye())};y.value.forEach((se,Q)=>{const X=y.value.length>3,O=Kt.divIcon({className:"polygon-edit-marker",html:`<div class="vertex-marker" style="
        position: relative;
        width: 16px;
        height: 16px;
        background-color: #667eea;
        border: 3px solid white;
        border-radius: 50%;
        box-shadow: 0 2px 6px rgba(0,0,0,0.4);
        cursor: move;
      "></div>`,iconSize:[16,16],iconAnchor:[8,8]}),q=Kt.marker([se.lat,se.lng],{icon:O,draggable:!0}).addTo(b);if(q.on("drag",J=>{const $e=J.target.getLatLng();y.value[Q]={lat:$e.lat,lng:$e.lng};const We=y.value.map(ot=>[ot.lat,ot.lng]);_.setLatLngs(We)}),q.on("dragend",()=>{S=!0,s("polygon-update",[...y.value])}),q.on("contextmenu",J=>{Kt.DomEvent.preventDefault(J),X&&ke(Q)}),X){const J=document.createElement("div"),$e=document.createElement("button");$e.textContent="Delete point",$e.style.cssText=`
        background: #dc3545;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9rem;
      `;const We=ot=>{ot.preventDefault(),ot.stopPropagation(),q.closePopup(),ke(Q)};$e.addEventListener("click",We),$e.addEventListener("touchend",We),J.appendChild($e),q.bindPopup(J,{closeButton:!1,className:"vertex-popup"})}})},ie=(te=!0)=>{if(l){if(!i.editingPolygon||i.editingPolygon.length===0){_&&(_.remove(),_=null),b&&(b.remove(),b=null),y.value=[];return}if(y.value=i.editingPolygon.map(ke=>({lat:ke.lat,lng:ke.lng})),ye(),te&&y.value.length>=3){const ke=Kt.latLngBounds(y.value.map(se=>[se.lat,se.lng]));l.fitBounds(ke,{padding:[50,50]})}}},oe=()=>{if(!l)return;if(de||(de=new Kt.FeatureGroup,l.addLayer(de)),l._customDrawingHandlers&&(l.off("click",l._customDrawingHandlers.handleClick),l.getContainer().removeEventListener("touchstart",l._customDrawingHandlers.handleTouchStart),l.getContainer().removeEventListener("touchend",l._customDrawingHandlers.handleTouchEnd),l.getContainer().removeEventListener("touchmove",l._customDrawingHandlers.handleTouchMove),delete l._customDrawingHandlers),!i.drawingMode){R(),de&&de.clearLayers();return}let te=0,ke=null,se=!1,Q=!1;const X=300,O=15,q=st=>{d.value.push([...u.value]),p.value=[],u.value.push({lat:st.lat,lng:st.lng}),le(),s("polygon-drawing",u.value)},J=st=>{st.originalEvent&&st.originalEvent.sourceCapabilities?.firesTouchEvents||q(st.latlng)},$e=st=>{if(st.touches.length>1){Q=!0;return}Q=!1,te=Date.now(),ke={x:st.touches[0].clientX,y:st.touches[0].clientY},se=!1},We=st=>{if(!ke||Q)return;const $t=st.touches[0].clientX-ke.x,Nt=st.touches[0].clientY-ke.y;Math.sqrt($t*$t+Nt*Nt)>O&&(se=!0)},ot=st=>{if(Q){Q=!1,ke=null;return}if(Date.now()-te<X&&!se&&ke){const Nt=st.changedTouches[0],Pt=Kt.point(Nt.clientX-l.getContainer().getBoundingClientRect().left,Nt.clientY-l.getContainer().getBoundingClientRect().top),jt=l.containerPointToLatLng(Pt);st.preventDefault(),st.stopPropagation(),q(jt)}ke=null,se=!1};l.on("click",J),l.getContainer().addEventListener("touchstart",$e,{passive:!0}),l.getContainer().addEventListener("touchmove",We,{passive:!0}),l.getContainer().addEventListener("touchend",ot,{passive:!1}),l._customDrawingHandlers={handleClick:J,handleTouchStart:$e,handleTouchMove:We,handleTouchEnd:ot},le()};let ce=!1,De=!1;const we=()=>{if(l&&(l._animatingZoom||De)){ce=!0;return}if(ce=!1,me.value.forEach(se=>{se._map&&(se.off(),se.remove())}),me.value=[],!l)return;const te=a.value?.clientWidth||400,ke=Math.floor(te*.75);if(i.locations.forEach(se=>{const Q=se.latitude??se.Latitude,X=se.longitude??se.Longitude;if(Q==null||X==null||Q===0&&X===0)return;const O=se.checkedInCount||0,q=se.requiredMarshals||1,J=i.highlightLocationId===se.id||i.highlightLocationIds.includes(se.id),$e=i.simplifyNonHighlighted&&!J,We=se.resolvedStyleType||se.ResolvedStyleType,ot=se.resolvedStyleBackgroundColor||se.ResolvedStyleBackgroundColor||se.resolvedStyleColor||se.ResolvedStyleColor,st=se.resolvedStyleBorderColor||se.ResolvedStyleBorderColor,$t=se.resolvedStyleIconColor||se.ResolvedStyleIconColor,Nt=se.resolvedStyleBackgroundShape||se.ResolvedStyleBackgroundShape,Pt=We&&We!=="default"||ot||st||$t||Nt&&Nt!=="circle"&&Nt!=="default",jt=se.resolvedStyleMapRotation??se.ResolvedStyleMapRotation??se.styleMapRotation??se.StyleMapRotation??0,cn=parseInt(jt,10)||0,go=se.areaColor||"#999",un=se.areaId&&!i.marshalMode,bt=Me.value.has(se.id)&&se.description?`${se.name}: ${_v(se.description,50)}`:se.name,qt=J?`
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid #667eea;
        border-radius: 50%;
        animation: highlight-pulse 1.5s ease-out infinite;
      "></div>
    `:"",yo=J?"#667eea":$e?"#e0e0e0":"white",ko=J?"white":$e?"#888":"#333";let Bn;if($e){const ns="20px";Bn=`
        <div style="
          background-color: #999;
          width: ${ns};
          height: ${ns};
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        "></div>
      `}const Zt=!i.marshalMode,Eo=fu(O,q),fs=Zt?`<div style="
      position: absolute;
      bottom: -2px;
      right: -6px;
      background-color: white;
      border-radius: 8px;
      padding: 1px 4px;
      font-size: 9px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    ">${O}/${q}</div>`:"";if(!$e&&Pt){const ns=J?40:32,ln=se.resolvedStyleSize||se.ResolvedStyleSize||"100",Qe=wn({type:se.resolvedStyleType||se.ResolvedStyleType,backgroundShape:se.resolvedStyleBackgroundShape||se.ResolvedStyleBackgroundShape||"circle",backgroundColor:se.resolvedStyleBackgroundColor||se.ResolvedStyleBackgroundColor||se.resolvedStyleColor||se.ResolvedStyleColor||"",borderColor:se.resolvedStyleBorderColor||se.ResolvedStyleBorderColor||"",iconColor:se.resolvedStyleIconColor||se.ResolvedStyleIconColor||"",size:ln});Qe?Bn=Qe:Bn=Y0(se.resolvedStyleType,se.resolvedStyleColor,O,q,ns,Zt)||He(O,q,J,i.marshalMode,!0)}else $e||(Bn=He(O,q,J,i.marshalMode,!0));const io=cn!==0?`transform: rotate(${cn}deg);`:"",Vt=Kt.divIcon({className:"custom-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
          ${qt}
          <div style="position: relative; display: flex; align-items: center; gap: 4px;">
            ${un?`<div style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background-color: ${go};
              border: 2px solid white;
              box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            "></div>`:""}
            <div style="position: relative; display: inline-block;">
              <div style="${io}">
                ${Bn}
              </div>
              ${$e?"":`<div style="position: absolute; top: -4px; right: -4px;">
                ${Eo}
              </div>`}
              ${$e?"":fs}
            </div>
          </div>
          <div style="
            background-color: ${yo};
            padding: 2px 6px;
            border-radius: 3px;
            font-size: ${J?"12px":"11px"};
            font-weight: bold;
            color: ${ko};
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: ${ke}px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${bt}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]}),Wn=i.marshalMode?`<b>${se.name}</b>${se.description?`<br>${se.description}`:""}`:`<b>${se.name}</b><br>${se.description||""}<br>Checked in: ${O}/${q}`,vn=Kt.marker([se.latitude,se.longitude],{icon:Vt}).addTo(l).bindPopup(Wn);vn.on("click",()=>{s("location-click",se)}),vn.locationData=se,me.value.push(vn)}),l&&Fe.value&&!i.center&&!ae.value){const se=[],Q=i.allLocationsForBounds.length>0?i.allLocationsForBounds:i.locations,X=(O,q)=>O!=null&&q!=null&&!(O===0&&q===0);if(Q.length>0&&se.push(...Q.filter(O=>X(O.latitude,O.longitude)).map(O=>[O.latitude,O.longitude])),i.route.length>0&&se.push(...i.route.filter(O=>X(O.lat,O.lng)).map(O=>[O.lat,O.lng])),se.length>0){const O=Kt.latLngBounds(se);l.fitBounds(O,{padding:[50,50]}),Fe.value=!1,ae.value=!0}}else i.center&&(Fe.value=!1);setTimeout(()=>{l&&!l._animatingZoom&&fe()},100)};return Qt(()=>{ae.value=!1,Fe.value=!0,Te();let te,ke=0,se=0;const Q=new ResizeObserver(X=>{if(l&&X.length>0){const{width:O,height:q}=X[0].contentRect;(Math.abs(O-ke)>10||Math.abs(q-se)>10)&&(ke=O,se=q,clearTimeout(te),te=setTimeout(()=>{l.invalidateSize()},150))}});a.value&&Q.observe(a.value),On(()=>{clearTimeout(te),Q.disconnect()})}),Ze(()=>i.locations,te=>{if(we(),l&&!ae.value&&te.length>0&&!i.center){const ke=te.map(O=>O.latitude),se=te.map(O=>O.longitude),Q=ke.reduce((O,q)=>O+q,0)/ke.length,X=se.reduce((O,q)=>O+q,0)/se.length;l.setView([Q,X],10),ae.value=!0,Fe.value=!1}},{deep:!0}),Ze(()=>i.route,te=>{if(W(),we(),l&&!ae.value&&te&&te.length>0&&!i.center){const ke=te.map(O=>O.lat),se=te.map(O=>O.lng),Q=ke.reduce((O,q)=>O+q,0)/ke.length,X=se.reduce((O,q)=>O+q,0)/se.length;l.setView([Q,X],10),ae.value=!0,Fe.value=!1}},{deep:!0}),Ze(()=>i.center,(te,ke)=>{l&&!T.value&&(!ke||Math.abs(te.lat-ke.lat)>1e-6||Math.abs(te.lng-ke.lng)>1e-6)&&l.setView([te.lat,te.lng],i.zoom)}),Ze(()=>i.areas,()=>{Y()},{deep:!0}),Ze(()=>i.selectedAreaId,()=>{Y()}),Ze(()=>i.drawingMode,()=>{oe()}),Ze(()=>i.editingPolygon,()=>{if(S){S=!1;return}ie()},{deep:!0}),Ze(()=>i.userLocation,()=>{Ie()},{deep:!0}),Ze(()=>i.highlightLocationId,()=>{we()}),Ze(()=>i.highlightLocationIds,()=>{we()},{deep:!0}),Ze(()=>i.marshalMode,()=>{we()}),Ze(()=>i.simplifyNonHighlighted,()=>{we()}),Ze(()=>i.clickable,te=>{l&&(l.off("click"),te&&l.on("click",ke=>{i.drawingMode||s("map-click",{lat:ke.latlng.lat,lng:ke.latlng.lng})}))}),(te,ke)=>(v(),g("div",Q0,[r("div",{ref_key:"mapContainer",ref:a,class:"map-container"},null,512),Xe.value?(v(),g("button",{key:0,class:"recenter-btn",onClick:be,title:"Recenter on checkpoint"},[...ke[0]||(ke[0]=[r("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),r("span",null,"Recenter",-1)])])):P("",!0)]))}},pu=ze(tw,[["__scopeId","data-v-1730680b"]]);function js(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}const nw={class:"areas-selection"},ow={key:0,class:"areas-selection-header"},sw={class:"areas-list"},iw=["checked","onChange"],aw={__name:"AreasSelection",props:{areas:{type:Array,default:()=>[]},selectedAreaIds:{type:Array,default:()=>[]}},emits:["update:selectedAreaIds"],setup(e,{emit:t}){const o=e,i=t,s=H(()=>[...o.areas].sort((d,p)=>d.displayOrder!==p.displayOrder?d.displayOrder-p.displayOrder:js(d.name,p.name))),a=H(()=>o.areas.length>0&&o.selectedAreaIds.length===o.areas.length),l=d=>{const p=[...o.selectedAreaIds],f=p.indexOf(d);f>=0?p.splice(f,1):p.push(d),i("update:selectedAreaIds",p)},u=()=>{a.value?i("update:selectedAreaIds",[]):i("update:selectedAreaIds",o.areas.map(d=>d.id))};return(d,p)=>(v(),g("div",nw,[e.areas.length>1?(v(),g("div",ow,[r("button",{onClick:u,class:"toggle-all-btn"},w(a.value?"Deselect all":"Select all"),1)])):P("",!0),r("div",sw,[(v(!0),g(xe,null,Be(s.value,f=>(v(),g("label",{class:"area-checkbox",key:f.id},[r("input",{type:"checkbox",checked:e.selectedAreaIds.includes(f.id),onChange:m=>l(f.id)},null,40,iw),r("span",{class:"area-color-dot",style:ut({backgroundColor:f.color||"#667eea"})},null,4),Ke(" "+w(f.name),1)]))),128))])]))}},lw=ze(aw,[["__scopeId","data-v-ba19009b"]]),rw={key:1,class:"toolbar-btn-wrapper filters-wrapper"},cw={key:1,class:"dropdown-content filters-dropdown"},uw={class:"filters-header"},dw={class:"filter-section"},hw={class:"filter-checkbox"},fw=["checked"],pw={class:"filter-section"},vw={class:"filter-checkbox"},mw=["checked"],gw={class:"filter-checkbox"},yw=["checked"],kw={class:"filter-checkbox"},_w=["checked"],bw={key:0,class:"filter-section"},ww=["onClick","title"],Cw={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Lw={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Sw=["innerHTML"],xw={key:0,class:"dropdown-content action-dropdown"},Iw=["onClick"],$w={__name:"MapToolbar",props:{showFullscreen:{type:Boolean,default:!1},showFilters:{type:Boolean,default:!1},filters:{type:Object,default:()=>({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},areas:{type:Array,default:()=>[]},actions:{type:Array,default:()=>[]},position:{type:String,default:"top-right",validator:e=>["top-right","top-left"].includes(e)}},emits:["fullscreen-click","filter-change","action-click"],setup(e,{expose:t,emit:o}){const{terms:i}=St(),s=e,a=o,l=M(!1),u=M(null),d=H(()=>u.value!==null),p=()=>{l.value=!l.value,l.value&&(u.value=null)},f=(b,S)=>{a("filter-change",{...s.filters,[b]:S})},m=b=>{b.items&&b.items.length>0?u.value===b.id?u.value=null:(u.value=b.id,l.value=!1):a("action-click",{actionId:b.id})},y=(b,S)=>{u.value=null,a("action-click",{actionId:b,itemId:S})};return t({closeDropdowns:()=>{l.value=!1,u.value=null}}),(b,S)=>(v(),g("div",{class:ue(["map-toolbar",[`position-${e.position}`]])},[e.showFullscreen?(v(),g("button",{key:0,class:"toolbar-btn",onClick:S[0]||(S[0]=T=>b.$emit("fullscreen-click")),title:"Fullscreen"},[...S[8]||(S[8]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})],-1)])])):P("",!0),e.showFilters&&!d.value?(v(),g("div",rw,[l.value?(v(),g("div",{key:0,class:"mobile-backdrop",onClick:S[1]||(S[1]=T=>l.value=!1)})):P("",!0),r("button",{class:ue(["toolbar-btn",{active:l.value}]),onClick:p,title:"Show/hide options"},[...S[9]||(S[9]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),r("circle",{cx:"12",cy:"12",r:"3"})],-1)])],2),l.value?(v(),g("div",cw,[r("div",uw,[S[11]||(S[11]=r("span",{class:"filters-title"},"Map filters",-1)),r("button",{class:"close-filters-btn",onClick:S[2]||(S[2]=T=>l.value=!1),title:"Close"},[...S[10]||(S[10]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])]),r("div",dw,[S[12]||(S[12]=r("h4",null,"Display",-1)),r("label",hw,[r("input",{type:"checkbox",checked:e.filters.showRoute,onChange:S[3]||(S[3]=T=>f("showRoute",T.target.checked))},null,40,fw),r("span",null,w(V(i).course)+" line",1)])]),r("div",pw,[r("h4",null,w(V(i).checkpoints),1),r("label",vw,[r("input",{type:"checkbox",checked:e.filters.showUncheckedIn,onChange:S[4]||(S[4]=T=>f("showUncheckedIn",T.target.checked))},null,40,mw),S[13]||(S[13]=r("span",{class:"status-indicator unchecked"},null,-1)),S[14]||(S[14]=r("span",null,"Unchecked-in",-1))]),r("label",gw,[r("input",{type:"checkbox",checked:e.filters.showPartiallyCheckedIn,onChange:S[5]||(S[5]=T=>f("showPartiallyCheckedIn",T.target.checked))},null,40,yw),S[15]||(S[15]=r("span",{class:"status-indicator partial"},null,-1)),S[16]||(S[16]=r("span",null,"Partially checked-in",-1))]),r("label",kw,[r("input",{type:"checkbox",checked:e.filters.showFullyCheckedIn,onChange:S[6]||(S[6]=T=>f("showFullyCheckedIn",T.target.checked))},null,40,_w),S[17]||(S[17]=r("span",{class:"status-indicator full"},null,-1)),S[18]||(S[18]=r("span",null,"Fully checked-in",-1))])]),e.areas.length>0?(v(),g("div",bw,[r("h4",null,w(V(i).areas),1),Ee(lw,{areas:e.areas,"selected-area-ids":e.filters.selectedAreaIds,"onUpdate:selectedAreaIds":S[7]||(S[7]=T=>f("selectedAreaIds",T))},null,8,["areas","selected-area-ids"])])):P("",!0)])):P("",!0)])):P("",!0),(v(!0),g(xe,null,Be(e.actions,T=>(v(),g("div",{key:T.id,class:ue(["toolbar-btn-wrapper",{hidden:l.value}])},[r("button",{class:ue(["toolbar-btn",{active:u.value===T.id}]),onClick:D=>m(T),title:T.label||T.id},[T.icon==="plus"?(v(),g("svg",Cw,[...S[19]||(S[19]=[r("line",{x1:"12",y1:"5",x2:"12",y2:"19"},null,-1),r("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1)])])):T.icon==="edit"?(v(),g("svg",Lw,[...S[20]||(S[20]=[r("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},null,-1),r("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1)])])):T.icon==="custom"?(v(),g("span",{key:2,innerHTML:T.customIcon},null,8,Sw)):P("",!0)],10,ww),T.items&&u.value===T.id?(v(),g("div",xw,[(v(!0),g(xe,null,Be(T.items,D=>(v(),g("button",{key:D.id,onClick:I=>y(T.id,D.id),class:"dropdown-item"},w(D.label),9,Iw))),128))])):P("",!0)],2))),128))],2))}},Tw=ze($w,[["__scopeId","data-v-d04b549d"]]),Mw={key:0,class:"drawing-controls"},Aw={class:"point-count"},Ew={class:"undo-redo-buttons"},Pw=["disabled"],Dw=["disabled"],Rw={__name:"MapDrawingControls",props:{pointCount:{type:Number,default:0},canUndo:{type:Boolean,default:!1},canRedo:{type:Boolean,default:!1},show:{type:Boolean,default:!0}},emits:["undo","redo"],setup(e,{emit:t}){const o=e,i=t,s=H(()=>o.show&&o.pointCount>0),a=l=>{if(!s.value)return;const d=navigator.platform.toUpperCase().indexOf("MAC")>=0?l.metaKey:l.ctrlKey;d&&l.key==="z"&&!l.shiftKey?(l.preventDefault(),o.canUndo&&i("undo")):d&&(l.key==="y"||l.key==="z"&&l.shiftKey)&&(l.preventDefault(),o.canRedo&&i("redo"))};return Qt(()=>{document.addEventListener("keydown",a)}),On(()=>{document.removeEventListener("keydown",a)}),(l,u)=>s.value?(v(),g("div",Mw,[r("div",Aw,w(e.pointCount)+" point"+w(e.pointCount!==1?"s":""),1),r("div",Ew,[r("button",{onClick:u[0]||(u[0]=d=>l.$emit("undo")),class:"btn-drawing undo-btn",disabled:!e.canUndo,title:"Undo last point (Ctrl+Z)"},"  Undo ",8,Pw),r("button",{onClick:u[1]||(u[1]=d=>l.$emit("redo")),class:"btn-drawing redo-btn",disabled:!e.canRedo,title:"Redo point (Ctrl+Y)"}," Redo  ",8,Dw)])])):P("",!0)}},Vh=ze(Rw,[["__scopeId","data-v-6cd009cb"]]),Ow={class:"context-info"},Bw={class:"action-buttons"},Nw=["disabled"],Fw={key:0,class:"fullscreen-map-banner"},Uw={class:"fullscreen-map-container"},zw={key:1,class:"fullscreen-map-footer"},Hw={__name:"MapFullscreenModal",props:{show:{type:Boolean,required:!0},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},title:{type:String,default:""},description:{type:String,default:""},canComplete:{type:Boolean,default:!1},headerStyle:{type:Object,default:()=>({})},headerTextColor:{type:String,default:""}},emits:["done","cancel","close"],setup(e,{emit:t}){const o=e,i=H(()=>o.headerTextColor?{color:o.headerTextColor}:{}),s=t,a=()=>{s("done")},l=()=>{s("cancel")},u=()=>{s("close")},d=p=>{p.key==="Escape"&&o.show&&(o.mode==="view"?u():l())};return Ze(()=>o.show,p=>{p?(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"):(document.body.style.overflow="",document.documentElement.style.overflow="")},{immediate:!0}),Qt(()=>{document.addEventListener("keydown",d)}),On(()=>{document.removeEventListener("keydown",d),document.body.style.overflow="",document.documentElement.style.overflow=""}),(p,f)=>(v(),je(Mu,{to:"body"},[e.show?(v(),g("div",{key:0,class:"fullscreen-map-overlay",onTouchmove:f[0]||(f[0]=dt(()=>{},["prevent","self"]))},[r("div",{class:"fullscreen-map-header",style:ut(e.headerStyle)},[r("div",Ow,[r("h3",{style:ut({color:e.headerTextColor})},w(e.title),5),e.description?(v(),g("p",{key:0,style:ut({color:e.headerTextColor,opacity:.85})},w(e.description),5)):P("",!0)]),r("div",Bw,[to(p.$slots,"actions",{},void 0),e.mode==="view"?(v(),g("button",{key:0,type:"button",onClick:dt(u,["stop"]),class:"btn btn-close-x",style:ut(i.value),title:"Close"},[...f[1]||(f[1]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"24",height:"24"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])],4)):(v(),g(xe,{key:1},[r("button",{type:"button",onClick:l,class:"btn btn-cancel"}," Cancel "),r("button",{type:"button",onClick:a,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,Nw)],64))])],4),p.$slots.banner?(v(),g("div",Fw,[to(p.$slots,"banner",{},void 0)])):P("",!0),r("div",Uw,[to(p.$slots,"default",{},void 0)]),p.$slots.footer?(v(),g("div",zw,[to(p.$slots,"footer",{},void 0)])):P("",!0)],32)):P("",!0)]))}},Vw=ze(Hw,[["__scopeId","data-v-b5d05af4"]]),Gw={class:"map-wrapper"},jw={class:"fullscreen-map-wrapper"},Zw={__name:"CommonMap",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},editingPolygon:{type:Array,default:null},height:{type:String,default:"400px"},showFullscreen:{type:Boolean,default:!0},showFilters:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]},toolbarPosition:{type:String,default:"top-right"},filters:{type:Object,default:()=>({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},fullscreenTitle:{type:String,default:""},fullscreenDescription:{type:String,default:""},fullscreenHeaderStyle:{type:Object,default:()=>({})},fullscreenHeaderTextColor:{type:String,default:""},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","visibility-change","point-selected","polygon-complete","polygon-drawing","polygon-update","fullscreen-change","filter-change","action-click","fullscreen-done","fullscreen-cancel"],setup(e,{expose:t,emit:o}){const i=e,s=o,a=M(null),l=M(null),u=M(null),d=M(!1),p=M(0),f=M(!1),m=M(!1),y=M({...i.filters});Ze(()=>i.filters,me=>{y.value={...me}},{deep:!0}),Ze(()=>i.areas,me=>{i.showFilters&&me.length>0&&(!y.value.selectedAreaIds||y.value.selectedAreaIds.length===0)&&(y.value.selectedAreaIds=me.map(Ae=>Ae.id))},{immediate:!0});const _=H(()=>i.showFilters?i.locations.filter(me=>{const Ae=me.checkedInCount||0,Fe=me.requiredMarshals||1,ae=Ae===0,Me=Ae>0&&Ae<Fe,ge=Ae>=Fe;if(ae&&!y.value.showUncheckedIn||Me&&!y.value.showPartiallyCheckedIn||ge&&!y.value.showFullyCheckedIn)return!1;const de=me.areaIds||me.AreaIds||[];return!(i.areas.length>0&&de.length>0&&(!y.value.selectedAreaIds||y.value.selectedAreaIds.length===0||!de.some(Xe=>y.value.selectedAreaIds.includes(Xe))))}):i.locations),b=H(()=>i.showFilters?y.value.showRoute?i.route:[]:i.route),S=H(()=>i.showFilters?y.value.selectedAreaIds&&y.value.selectedAreaIds.length>0?i.areas.filter(me=>y.value.selectedAreaIds.includes(me.id)):i.areas.length>0?[]:i.areas:i.areas),T=H(()=>i.mode==="select-point"?!0:i.mode==="draw-polygon"?p.value>=3:!0),D=()=>d.value?l.value:a.value,I=()=>{d.value=!0,s("fullscreen-change",!0)},C=()=>{d.value=!1,s("fullscreen-change",!1)},A=()=>{if(i.mode==="draw-polygon"){const me=D();me&&me.clearPolygonDrawing(),p.value=0,f.value=!1,m.value=!1}d.value=!1,s("fullscreen-cancel"),s("fullscreen-change",!1)},E=()=>{if(i.mode==="draw-polygon"&&p.value>=3){const me=D();me&&me.completePolygon()}d.value=!1,s("fullscreen-done"),s("fullscreen-change",!1)},N=me=>{y.value=me,s("filter-change",me)},$=me=>{i.mode==="select-point"&&s("point-selected",me),s("map-click",me)},G=me=>{p.value=me?.length||0,U(),s("polygon-drawing",me)},R=me=>{s("polygon-complete",me),p.value=0,f.value=!1,m.value=!1},Z=me=>{s("polygon-update",me)},U=()=>{const me=D();me&&(f.value=me.canUndo?me.canUndo():!1,m.value=me.canRedo?me.canRedo():!1)},K=()=>{const me=D();me&&me.undoPolygonPoint&&(me.undoPolygonPoint(),U())},re=()=>{const me=D();me&&me.redoPolygonPoint&&(me.redoPolygonPoint(),U())};return t({getMapCenter:()=>D()?.getMapCenter?.(),getMapZoom:()=>D()?.getMapZoom?.(),undoPolygonPoint:K,redoPolygonPoint:re,canUndo:()=>f.value,canRedo:()=>m.value,getPolygonPointCount:()=>p.value,completePolygon:()=>D()?.completePolygon?.(),clearPolygonDrawing:()=>{D()?.clearPolygonDrawing?.(),p.value=0,f.value=!1,m.value=!1},recenterOnUserLocation:()=>D()?.recenterOnUserLocation?.(),recenterOnLocation:(me,Ae,Fe)=>D()?.recenterOnLocation?.(me,Ae,Fe),isLocationInView:(me,Ae)=>D()?.isLocationInView?.(me,Ae)??!0,getUserLocationInView:()=>D()?.userLocationInView?.value??!0,getHighlightedLocationInView:()=>D()?.highlightedLocationInView?.value??!0,openFullscreen:()=>{d.value=!0,s("fullscreen-change",!0)},closeFullscreen:C,closeDropdowns:()=>{u.value&&u.value.closeDropdowns()}}),(me,Ae)=>(v(),g("div",{class:"common-map",style:ut({height:e.height})},[r("div",Gw,[Ee(pu,{ref_key:"mapViewRef",ref:a,locations:_.value,route:b.value,areas:S.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:Ae[0]||(Ae[0]=Fe=>me.$emit("location-click",Fe)),onMapClick:$,onAreaClick:Ae[1]||(Ae[1]=Fe=>me.$emit("area-click",Fe)),onPolygonComplete:R,onPolygonDrawing:G,onPolygonUpdate:Z,onVisibilityChange:Ae[2]||(Ae[2]=Fe=>me.$emit("visibility-change",Fe))},null,8,["locations","route","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Ee(Tw,{ref_key:"toolbarRef",ref:u,"show-fullscreen":e.showFullscreen,"show-filters":e.showFilters,filters:y.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFullscreenClick:I,onFilterChange:N,onActionClick:Ae[3]||(Ae[3]=Fe=>me.$emit("action-click",Fe))},null,8,["show-fullscreen","show-filters","filters","areas","actions","position"]),Ee(Vh,{show:e.mode==="draw-polygon","point-count":p.value,"can-undo":f.value,"can-redo":m.value,onUndo:K,onRedo:re},null,8,["show","point-count","can-undo","can-redo"])]),Ee(Vw,{show:d.value,mode:e.mode,title:e.fullscreenTitle,description:e.fullscreenDescription,"can-complete":T.value,"header-style":e.fullscreenHeaderStyle,"header-text-color":e.fullscreenHeaderTextColor,onDone:E,onCancel:A,onClose:C},{actions:Ue(()=>[to(me.$slots,"fullscreen-actions",{},void 0,!0)]),banner:Ue(()=>[to(me.$slots,"fullscreen-banner",{},void 0,!0)]),footer:Ue(()=>[to(me.$slots,"fullscreen-footer",{},void 0,!0)]),default:Ue(()=>[r("div",jw,[Ee(pu,{ref_key:"fullscreenMapViewRef",ref:l,locations:_.value,route:b.value,areas:S.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:Ae[4]||(Ae[4]=Fe=>me.$emit("location-click",Fe)),onMapClick:$,onAreaClick:Ae[5]||(Ae[5]=Fe=>me.$emit("area-click",Fe)),onPolygonComplete:R,onPolygonDrawing:G,onPolygonUpdate:Z,onVisibilityChange:Ae[6]||(Ae[6]=Fe=>me.$emit("visibility-change",Fe))},null,8,["locations","route","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Ee(Vh,{show:e.mode==="draw-polygon","point-count":p.value,"can-undo":f.value,"can-redo":m.value,onUndo:K,onRedo:re},null,8,["show","point-count","can-undo","can-redo"])])]),_:3},8,["show","mode","title","description","can-complete","header-style","header-text-color"])],4))}},oa=ze(Zw,[["__scopeId","data-v-d6bcac0e"]]),qw={class:"course-areas-tab"},Ww={__name:"CourseAreasTab",props:{checkpoints:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1}},emits:["map-click","location-click","area-click","import-checkpoints","upload-route","select-location","add-area","select-area","polygon-complete","cancel-drawing","add-checkpoint-from-map","add-many-checkpoints-from-map","add-area-from-map"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=St(),a=e,l=o,u=M(null),d=M(null),p=M(0),f=M({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]}),m=H(()=>[{id:"add",icon:"plus",label:"Add",items:[{id:"checkpoint",label:i.value.checkpoint},{id:"many-checkpoints",label:`Many ${s.value.checkpoints}`},{id:"area",label:i.value.area},{id:"import",label:`Import ${s.value.checkpoints}...`},{id:"upload",label:`Upload ${s.value.course}...`}]}]),y=({actionId:I,itemId:C})=>{I==="add"&&(C==="checkpoint"?(l("add-checkpoint-from-map"),S()):C==="many-checkpoints"?(l("add-many-checkpoints-from-map"),S()):C==="area"?(l("add-area-from-map"),S()):C==="import"?l("import-checkpoints"):C==="upload"&&l("upload-route"))},_=I=>{f.value=I},b=I=>{p.value=I?.length||0},S=()=>{u.value&&u.value.scrollIntoView({behavior:"smooth",block:"start"})};return t({scrollMapIntoView:S,getMapCenter:()=>d.value?.getMapCenter()||null,getMapZoom:()=>d.value?.getMapZoom()||null}),Ze(()=>a.areas,I=>{if(I.length>0){const C=new Set(f.value.selectedAreaIds);I.forEach(A=>{C.has(A.id)||f.value.selectedAreaIds.push(A.id)}),f.value.selectedAreaIds=f.value.selectedAreaIds.filter(A=>I.some(E=>E.id===A))}},{immediate:!0}),Ze(()=>a.drawingMode,I=>{I||(p.value=0)}),(I,C)=>(v(),g("div",qw,[r("div",{class:"map-section",ref_key:"mapSection",ref:u},[Ee(oa,{ref_key:"commonMapRef",ref:d,locations:e.checkpoints,route:e.route,areas:e.areas,"all-locations-for-bounds":e.checkpoints,"selected-area-id":e.selectedAreaId,clickable:!0,mode:e.drawingMode?"draw-polygon":"view",height:"100%","show-filters":"",filters:f.value,"toolbar-actions":m.value,"fullscreen-title":e.drawingMode?`Draw ${V(s).area} boundary`:V(i).course,"fullscreen-description":e.drawingMode?"Click on the map to draw the boundary":"",onMapClick:C[0]||(C[0]=A=>I.$emit("map-click",A)),onLocationClick:C[1]||(C[1]=A=>I.$emit("location-click",A)),onAreaClick:C[2]||(C[2]=A=>I.$emit("area-click",A)),onPolygonComplete:C[3]||(C[3]=A=>I.$emit("polygon-complete",A)),onPolygonDrawing:b,onFilterChange:_,onActionClick:y},null,8,["locations","route","areas","all-locations-for-bounds","selected-area-id","mode","filters","toolbar-actions","fullscreen-title","fullscreen-description"])],512)]))}},Kw=ze(Ww,[["__scopeId","data-v-c0e54ae9"]]),Yw=(e,t)=>{const o=String(e).trim(),i=String(t).trim(),s=parseFloat(o),a=parseFloat(i),l=!isNaN(s)&&String(s)===o,u=!isNaN(a)&&String(a)===i;return l&&u?s-a:o.localeCompare(i,void 0,{numeric:!0,sensitivity:"base"})},Jw=e=>e&&e.isCheckedIn?"":"",Xw={__name:"StatusPill",props:{variant:{type:String,default:"neutral",validator:e=>["neutral","success","warning","danger","info","purple"].includes(e)},active:{type:Boolean,default:!1}},emits:["click"],setup(e){return(t,o)=>(v(),g("button",{class:ue(["status-pill",[e.variant,{active:e.active}]]),onClick:o[0]||(o[0]=i=>t.$emit("click"))},[to(t.$slots,"default",{},void 0)],2))}},Cn=ze(Xw,[["__scopeId","data-v-a94deea5"]]),Qw={class:"marshals-tab"},eC={class:"tab-header"},tC={class:"button-group"},nC={key:0,class:"status-pills"},oC={class:"filters-section"},sC={class:"search-group"},iC={class:"marshals-grid"},aC={class:"marshals-table"},lC={key:0,class:"sort-indicator"},rC={key:0,class:"sort-indicator"},cC={key:0,class:"sort-indicator"},uC={key:0,class:"sort-indicator"},dC=["onClick"],hC=["rowspan"],fC={class:"checkpoint-cell"},pC={class:"checkpoint-name"},vC={key:0,class:"checkpoint-description"},mC=["value","onChange"],gC=["rowspan"],yC={key:0,class:"last-active-text"},kC={key:1,class:"last-active-never"},_C=["onClick"],bC={class:"no-checkpoint-text"},wC={class:"hide-on-mobile last-active-cell"},CC={key:0,class:"last-active-text"},LC={key:1,class:"last-active-never"},SC={__name:"MarshalsTab",props:{marshals:{type:Array,required:!0},assignments:{type:Array,required:!0},locations:{type:Array,required:!0}},emits:["add-marshal","import-marshals","select-marshal","delete-marshal","change-assignment-status"],setup(e,{emit:t}){const{terms:o}=St(),i=e,s=M("name"),a=M("asc"),l=M(""),u=M("all"),d=G=>{u.value=G},p=G=>{s.value===G?a.value=a.value==="asc"?"desc":"asc":(s.value=G,a.value="asc")},f=G=>i.assignments.filter(R=>R.marshalId===G),m=H(()=>new Set(i.assignments.filter(G=>G.isCheckedIn).map(G=>G.marshalId))),y=H(()=>new Set(i.assignments.map(G=>G.marshalId))),_=H(()=>m.value.size),b=H(()=>i.marshals.filter(G=>!y.value.has(G.id)).length),S=H(()=>i.marshals.filter(G=>y.value.has(G.id)&&!m.value.has(G.id)).length),T=G=>i.locations.find(R=>R.id===G),D=G=>{const R=T(G);return R?R.name:"Unknown"},I=G=>{const R=T(G);return R?R.description:""},C=G=>{if(!G)return"";const R=new Date(G),U=new Date-R,K=Math.floor(U/6e4),re=Math.floor(K/60),Pe=Math.floor(re/24);return K<1?"just now":K<60?`${K}m ago`:re<24?`${re}h ago`:Pe===1?"yesterday":Pe<7?`${Pe}d ago`:R.toLocaleDateString()},A=H(()=>{let G=i.marshals;if(u.value==="unassigned"?G=G.filter(R=>!y.value.has(R.id)):u.value==="checked-in"?G=G.filter(R=>m.value.has(R.id)):u.value==="not-checked-in"&&(G=G.filter(R=>y.value.has(R.id)&&!m.value.has(R.id))),l.value.trim()){const R=l.value.toLowerCase().trim().split(/\s+/);G=G.filter(Z=>{const K=f(Z.id).map(Pe=>{const me=T(Pe.locationId);return me?`${me.name||""} ${me.description||""}`:""}).join(" "),re=`${Z.name} ${K}`.toLowerCase();return R.every(Pe=>re.includes(Pe))})}return G}),E=H(()=>{const G=[...A.value];return G.sort((R,Z)=>{let U=0;if(s.value==="name")U=R.name.localeCompare(Z.name);else if(s.value==="checkpoint"){const K=f(R.id),re=f(Z.id),Pe=K.length>0?D(K[0].locationId):"",me=re.length>0?D(re[0].locationId):"";U=Yw(Pe,me)}else if(s.value==="status"){const K=f(R.id),re=f(Z.id),Pe=K.length>0&&K[0].isCheckedIn?1:0;U=(re.length>0&&re[0].isCheckedIn?1:0)-Pe}else if(s.value==="lastActive"){const K=R.lastAccessedDate?new Date(R.lastAccessedDate).getTime():0;U=(Z.lastAccessedDate?new Date(Z.lastAccessedDate).getTime():0)-K}return a.value==="asc"?U:-U}),G}),N=G=>G.isAdminCheckedIn?"admin-checked-in":G.isWrongLocation?"wrong-location":G.isCheckedIn?"checked-in":"not-checked-in",$=G=>G.isCheckedIn?"status-checked-in":"status-not-checked-in";return(G,R)=>(v(),g("div",Qw,[r("div",eC,[r("div",tC,[r("button",{onClick:R[0]||(R[0]=Z=>G.$emit("add-marshal")),class:"btn btn-primary"}," Add "+w(V(o).person.toLowerCase()),1),r("button",{onClick:R[1]||(R[1]=Z=>G.$emit("import-marshals")),class:"btn btn-secondary"}," Import CSV ")]),e.marshals.length>0?(v(),g("div",nC,[Ee(Cn,{variant:"neutral",active:u.value==="all",onClick:R[2]||(R[2]=Z=>d("all"))},{default:Ue(()=>[Ke(w(e.marshals.length)+" total ",1)]),_:1},8,["active"]),b.value>0?(v(),je(Cn,{key:0,variant:"warning",active:u.value==="unassigned",onClick:R[3]||(R[3]=Z=>d("unassigned"))},{default:Ue(()=>[Ke(w(b.value)+" unassigned ",1)]),_:1},8,["active"])):P("",!0),_.value>0?(v(),je(Cn,{key:1,variant:"success",active:u.value==="checked-in",onClick:R[4]||(R[4]=Z=>d("checked-in"))},{default:Ue(()=>[Ke(w(_.value)+" checked in ",1)]),_:1},8,["active"])):P("",!0),S.value>0?(v(),je(Cn,{key:2,variant:"danger",active:u.value==="not-checked-in",onClick:R[5]||(R[5]=Z=>d("not-checked-in"))},{default:Ue(()=>[Ke(w(S.value)+" not checked in ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",oC,[r("div",sC,[Ve(r("input",{"onUpdate:modelValue":R[6]||(R[6]=Z=>l.value=Z),type:"text",class:"search-input",placeholder:"Search by name, checkpoint, or description..."},null,512),[[nt,l.value]])])]),r("div",iC,[r("table",aC,[r("thead",null,[r("tr",null,[r("th",{onClick:R[7]||(R[7]=Z=>p("name")),class:"sortable"},[R[12]||(R[12]=Ke(" Name ",-1)),s.value==="name"?(v(),g("span",lC,w(a.value==="asc"?"":""),1)):P("",!0)]),r("th",{onClick:R[8]||(R[8]=Z=>p("checkpoint")),class:"sortable"},[Ke(w(V(o).checkpoint)+" ",1),s.value==="checkpoint"?(v(),g("span",rC,w(a.value==="asc"?"":""),1)):P("",!0)]),r("th",{onClick:R[9]||(R[9]=Z=>p("status")),class:"sortable"},[R[13]||(R[13]=Ke(" Status ",-1)),s.value==="status"?(v(),g("span",cC,w(a.value==="asc"?"":""),1)):P("",!0)]),r("th",{onClick:R[10]||(R[10]=Z=>p("lastActive")),class:"sortable hide-on-mobile"},[R[14]||(R[14]=Ke(" Last active ",-1)),s.value==="lastActive"?(v(),g("span",uC,w(a.value==="asc"?"":""),1)):P("",!0)])])]),r("tbody",null,[(v(!0),g(xe,null,Be(E.value,Z=>(v(),g(xe,{key:Z.id},[f(Z.id).length>0?(v(!0),g(xe,{key:0},Be(f(Z.id),(U,K)=>(v(),g("tr",{key:`${Z.id}-${U.id}`,class:"marshal-row",onClick:re=>G.$emit("select-marshal",Z)},[K===0?(v(),g("td",{key:0,rowspan:f(Z.id).length},w(Z.name),9,hC)):P("",!0),r("td",fC,[r("div",pC,w(D(U.locationId)),1),I(U.locationId)?(v(),g("div",vC,w(I(U.locationId)),1)):P("",!0)]),r("td",{onClick:R[11]||(R[11]=dt(()=>{},["stop"]))},[r("select",{value:N(U),onChange:re=>G.$emit("change-assignment-status",{assignment:U,status:re.target.value}),class:ue(["status-select hide-on-mobile",$(U)])},[...R[15]||(R[15]=[r("option",{value:"not-checked-in"},"Not checked-in",-1),r("option",{value:"checked-in"},"Checked-in",-1),r("option",{value:"admin-checked-in"},"Admin checked-in",-1),r("option",{value:"wrong-location"},"Checked-in but not at correct location",-1)])],42,mC),r("span",{class:ue(["status-icon show-on-mobile",$(U)])},w(V(Jw)(U)),3)]),K===0?(v(),g("td",{key:1,rowspan:f(Z.id).length,class:"hide-on-mobile last-active-cell"},[Z.lastAccessedDate?(v(),g("span",yC,w(C(Z.lastAccessedDate)),1)):(v(),g("span",kC,"Never"))],8,gC)):P("",!0)],8,dC))),128)):(v(),g("tr",{key:1,class:"marshal-row",onClick:U=>G.$emit("select-marshal",Z)},[r("td",null,w(Z.name),1),r("td",bC,"No "+w(V(o).checkpoint.toLowerCase())+" assigned",1),R[16]||(R[16]=r("td",null,[r("span",{class:"hide-on-mobile"},"-"),r("span",{class:"status-icon show-on-mobile no-checkpoint-text"},"-")],-1)),r("td",wC,[Z.lastAccessedDate?(v(),g("span",CC,w(C(Z.lastAccessedDate)),1)):(v(),g("span",LC,"Never"))])],8,_C))],64))),128))])])])]))}},xC=ze(SC,[["__scopeId","data-v-618e1dbe"]]),IC={class:"checklists-tab"},$C={class:"checklists-tab-header"},TC={class:"button-group"},MC={class:"filters-section"},AC={class:"search-group"},EC=["placeholder"],PC={class:"checklist-items-list"},DC={key:0,class:"empty-state"},RC={class:"checklist-item-content"},OC=["onClick"],BC={class:"checklist-item-scopes"},NC=["onClick"],FC={__name:"ChecklistsTab",props:{checklistItems:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},completionReport:{type:Object,default:null}},emits:["add-checklist-item","select-checklist-item"],setup(e,{emit:t}){const{terms:o,termsLower:i}=St(),s=e,a=M(""),l=H(()=>{if(!a.value.trim())return s.checklistItems;const f=a.value.toLowerCase().trim().split(/\s+/);return s.checklistItems.filter(m=>{const y=(m.text||"").toLowerCase();return f.every(_=>y.includes(_))})}),u=H(()=>[...l.value].sort((f,m)=>f.displayOrder!==m.displayOrder?f.displayOrder-m.displayOrder:js(f.text,m.text))),d=f=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${i.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${i.value.checkpoints}`,SpecificPeople:`Specific ${i.value.people}`,OnePerArea:`One per ${i.value.area}`,OnePerCheckpoint:`One per ${i.value.checkpoint}`,EveryAreaLead:`Every ${i.value.area} lead`,OneLeadPerArea:`One lead per ${i.value.area}`,AreaLead:`${o.value.area} lead`})[f]||f,p=f=>{if(!f)return"";const m=d(f.scope);if(f.itemType===null)return m;const y=f.ids||[];if(y.includes("ALL_MARSHALS"))return`${m} (Everyone)`;if(y.includes("ALL_AREAS"))return`${m} (All ${i.value.areas})`;if(y.includes("ALL_CHECKPOINTS"))return`${m} (All ${i.value.checkpoints})`;const _=y.length;return _===0?m:`${m} (${_})`};return(f,m)=>(v(),g("div",IC,[r("div",$C,[r("div",TC,[r("button",{onClick:m[0]||(m[0]=y=>f.$emit("add-checklist-item")),class:"btn btn-primary"}," Add "+w(V(i).checklist),1)])]),r("div",MC,[r("div",AC,[Ve(r("input",{"onUpdate:modelValue":m[1]||(m[1]=y=>a.value=y),type:"text",class:"search-input",placeholder:`Search ${V(i).checklists}...`},null,8,EC),[[nt,a.value]])])]),r("div",PC,[l.value.length===0?(v(),g("div",DC,[r("p",null,w(a.value?`No ${V(i).checklists} match your search.`:`No ${V(i).checklists} yet. Create one to get started!`),1)])):P("",!0),(v(!0),g(xe,null,Be(u.value,y=>(v(),g("div",{key:y.itemId,class:"checklist-item-card"},[r("div",RC,[r("div",{class:"checklist-item-title",onClick:_=>f.$emit("select-checklist-item",y,"details")},[r("strong",null,w(y.text),1)],8,OC),r("div",BC,[(v(!0),g(xe,null,Be(y.scopeConfigurations,(_,b)=>(v(),g("span",{key:b,class:"scope-badge",onClick:S=>f.$emit("select-checklist-item",y,"visibility")},w(p(_)),9,NC))),128))])])]))),128))])]))}},UC=ze(FC,[["__scopeId","data-v-123b7338"]]),zC={class:"notes-tab"},HC={class:"tab-header"},VC={class:"button-group"},GC={class:"filters-section"},jC={class:"search-group"},ZC={class:"notes-list"},qC={key:0,class:"empty-state"},WC=["onClick"],KC={class:"note-header"},YC={class:"note-title-row"},JC={key:0,class:"pin-icon",title:"Pinned"},XC={class:"note-meta"},QC={key:0,class:"category-badge"},e2={class:"created-info"},t2={key:0,class:"note-preview"},n2={class:"note-scopes"},o2={__name:"NotesTab",props:{notes:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["add-note","select-note"],setup(e,{emit:t}){const{termsLower:o}=St(),i=e,s=M(""),a=H(()=>{if(!s.value.trim())return i.notes;const m=s.value.toLowerCase().trim().split(/\s+/);return i.notes.filter(y=>{const _=`${y.title||""} ${y.content||""} ${y.priority||""}`.toLowerCase();return m.every(b=>_.includes(b))})}),l=H(()=>{const m={Urgent:0,High:1,Normal:2,Low:3};return[...a.value].sort((y,_)=>{if(y.isPinned!==_.isPinned)return y.isPinned?-1:1;const b=m[y.priority]??2,S=m[_.priority]??2;return b!==S?b-S:y.displayOrder!==_.displayOrder?y.displayOrder-_.displayOrder:js(y.title,_.title)})}),u=m=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${o.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${o.value.checkpoints}`,SpecificPeople:`Specific ${o.value.people}`,EveryAreaLead:`Every ${o.value.area} lead`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,OnePerArea:`One per ${o.value.area}`,OneLeadPerArea:`One lead per ${o.value.area}`})[m]||m,d=m=>{if(!m)return"";const y=u(m.scope);if(m.itemType===null)return y;const _=m.ids||[];if(_.includes("ALL_MARSHALS"))return`${y} (Everyone)`;if(_.includes("ALL_AREAS"))return`${y} (All ${o.value.areas})`;if(_.includes("ALL_CHECKPOINTS"))return`${y} (All ${o.value.checkpoints})`;const b=_.length;return b===0?y:`${y} (${b})`},p=m=>{if(!m)return"";const y=150;return m.length<=y?m:m.substring(0,y)+"..."},f=m=>{if(!m)return"";const y=new Date(m),b=new Date-y,S=Math.floor(b/6e4),T=Math.floor(b/36e5),D=Math.floor(b/864e5);return S<1?"Just now":S<60?`${S}m ago`:T<24?`${T}h ago`:D<7?`${D}d ago`:y.toLocaleDateString()};return(m,y)=>(v(),g("div",zC,[r("div",HC,[r("div",VC,[r("button",{onClick:y[0]||(y[0]=_=>m.$emit("add-note")),class:"btn btn-primary"}," Add note ")])]),r("div",GC,[r("div",jC,[Ve(r("input",{"onUpdate:modelValue":y[1]||(y[1]=_=>s.value=_),type:"text",class:"search-input",placeholder:"Search by title, content, or priority..."},null,512),[[nt,s.value]])])]),r("div",ZC,[a.value.length===0?(v(),g("div",qC,[r("p",null,w(s.value?"No notes match your search.":"No notes yet. Create one to get started!"),1)])):P("",!0),(v(!0),g(xe,null,Be(l.value,_=>(v(),g("div",{key:_.noteId,class:ue(["note-card",{pinned:_.isPinned}]),onClick:b=>m.$emit("select-note",_)},[r("div",KC,[r("div",YC,[_.isPinned?(v(),g("span",JC,"")):P("",!0),r("span",{class:ue(["priority-indicator",_.priority?.toLowerCase()||"normal"])},null,2),r("strong",null,w(_.title),1)]),r("div",XC,[_.category?(v(),g("span",QC,w(_.category),1)):P("",!0),r("span",e2,w(f(_.createdAt)),1)])]),_.content?(v(),g("div",t2,w(p(_.content)),1)):P("",!0),r("div",n2,[(v(!0),g(xe,null,Be(_.scopeConfigurations,(b,S)=>(v(),g("span",{key:S,class:"scope-badge"},w(d(b)),1))),128))])],10,WC))),128))])]))}},s2=ze(o2,[["__scopeId","data-v-6449d7cc"]]),i2={key:0,class:"empty-state"},a2={key:0,class:"empty-hint"},l2={__name:"CardsGrid",props:{isEmpty:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No items."},emptyHint:{type:String,default:""},gridClass:{type:String,default:""}},setup(e){return(t,o)=>e.isEmpty?(v(),g("div",i2,[r("p",null,w(e.emptyMessage),1),e.emptyHint?(v(),g("p",a2,w(e.emptyHint),1)):P("",!0)])):(v(),g("div",{key:1,class:ue(["cards-grid",e.gridClass])},[to(t.$slots,"default",{},void 0)],2))}},Nl=ze(l2,[["__scopeId","data-v-a842b7b1"]]),r2={class:"contact-card-header"},c2={class:"contact-name-row"},u2={key:0,class:"primary-badge",title:"Primary contact"},d2={class:"contact-name"},h2={key:0,class:"contact-role"},f2={key:0,class:"no-scope-warning",title:"This contact has no visibility scope configured"},p2=["title"],v2={key:0,class:"contact-card-details"},m2={key:0,class:"contact-phone"},g2={key:1,class:"contact-email"},y2={key:1,class:"contact-card-notes"},k2={key:2,class:"contact-card-scopes"},_2={key:3,class:"contact-card-badge"},b2={key:4,class:"contact-card-badge"},w2={__name:"ContactCard",props:{contact:{type:Object,required:!0},isPending:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:String,default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},clickable:{type:Boolean,default:!0}},emits:["click","remove","undo-remove"],setup(e,{emit:t}){const{terms:o,termsLower:i}=St(),s=e,a=t,l=H(()=>{const y=s.contact.scopeConfigurations;return!y||y.length===0}),u=()=>{s.clickable&&!s.isPending&&!s.isMarkedForRemoval&&a("click",s.contact)},d=y=>y?y==="AreaLead"?`${o.value.area} Lead`:y.replace(/([A-Z])/g," $1").replace(/^./,_=>_.toUpperCase()).trim():"",p=y=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${i.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${i.value.checkpoints}`,SpecificPeople:`Specific ${i.value.people}`,EveryAreaLead:`Every ${i.value.area} lead`})[y]||y,f=y=>{if(!y)return"";const _=p(y.scope);if(y.itemType===null)return _;const b=y.ids||[];if(b.includes("ALL_MARSHALS"))return`${_} (Everyone)`;if(b.includes("ALL_AREAS"))return`${_} (All ${i.value.areas})`;if(b.includes("ALL_CHECKPOINTS"))return`${_} (All ${i.value.checkpoints})`;const S=b.length;return S===0?_:`${_} (${S})`},m=y=>{if(!y)return"";const _=100;return y.length<=_?y:y.substring(0,_)+"..."};return(y,_)=>(v(),g("div",{class:ue(["contact-card",{"is-pending":e.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-primary":e.contact.isPrimary&&!e.isMarkedForRemoval,"is-clickable":e.clickable&&!e.isMarkedForRemoval}]),onClick:u},[r("div",r2,[r("div",{class:ue(["contact-card-title",{clickable:e.clickable&&!e.isMarkedForRemoval}])},[r("div",c2,[e.contact.isPrimary&&!e.isMarkedForRemoval?(v(),g("span",u2,"")):P("",!0),r("span",d2,w(e.contact.name),1)]),e.contact.role?(v(),g("span",h2,w(d(e.contact.role)),1)):P("",!0)],2),l.value&&!e.isMarkedForRemoval&&!e.isPending?(v(),g("span",f2,"!")):P("",!0),e.showRemoveButton&&!e.isMarkedForRemoval?(v(),g("button",{key:1,type:"button",class:"contact-remove-btn",title:e.removeTitle,onClick:_[0]||(_[0]=dt(b=>y.$emit("remove",e.contact.contactId),["stop"]))},"  ",8,p2)):P("",!0),e.isMarkedForRemoval?(v(),g("button",{key:2,type:"button",class:"contact-undo-btn",title:"Cancel removal",onClick:_[1]||(_[1]=dt(b=>y.$emit("undo-remove",e.contact.contactId),["stop"]))}," Undo ")):P("",!0)]),e.contact.phone||e.contact.email?(v(),g("div",v2,[e.contact.phone?(v(),g("span",m2,w(e.contact.phone),1)):P("",!0),e.contact.email?(v(),g("span",g2,w(e.contact.email),1)):P("",!0)])):P("",!0),e.contact.notes&&e.showNotes?(v(),g("div",y2,w(m(e.contact.notes)),1)):P("",!0),e.showScopes&&e.contact.scopeConfigurations?.length>0&&!e.isMarkedForRemoval?(v(),g("div",k2,[(v(!0),g(xe,null,Be(e.contact.scopeConfigurations,(b,S)=>(v(),g("span",{key:S,class:"scope-badge"},w(f(b)),1))),128))])):P("",!0),e.isPending?(v(),g("div",_2,[..._[2]||(_[2]=[r("span",{class:"pending-indicator"},"Will be added on save",-1)])])):P("",!0),e.isMarkedForRemoval?(v(),g("div",b2,[..._[3]||(_[3]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):P("",!0)],2))}},C2=ze(w2,[["__scopeId","data-v-86c5c2b6"]]),wv={__name:"ContactsGrid",props:{contacts:{type:Array,required:!0},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:[String,Function],default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No contacts."},emptyHint:{type:String,default:""}},emits:["select","remove","undo-remove"],setup(e){const t=e,o=s=>typeof t.removeTitle=="function"?t.removeTitle(s):t.removeTitle,i=s=>!s.isPending;return(s,a)=>(v(),je(Nl,{"is-empty":e.contacts.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ue(()=>[(v(!0),g(xe,null,Be(e.contacts,l=>(v(),je(C2,{key:l.contactId,contact:l,"is-pending":l.isPending,"is-marked-for-removal":l.isMarkedForRemoval,"show-remove-button":e.showRemoveButton,"remove-title":o(l),"show-notes":e.showNotes,"show-scopes":e.showScopes,clickable:i(l),onClick:u=>s.$emit("select",l),onRemove:a[0]||(a[0]=u=>s.$emit("remove",u)),onUndoRemove:a[1]||(a[1]=u=>s.$emit("undo-remove",u))},null,8,["contact","is-pending","is-marked-for-removal","show-remove-button","remove-title","show-notes","show-scopes","clickable","onClick"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},L2={class:"contacts-tab"},S2={class:"tab-header"},x2={class:"button-group"},I2={key:0,class:"status-pills"},$2={class:"filters-section"},T2={class:"search-group"},M2={__name:"ContactsTab",props:{contacts:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})}},emits:["add-contact","select-contact"],setup(e,{emit:t}){const o=e,i=M(""),s=M("all"),a=H(()=>o.contacts.filter(_=>!_.scopeConfigurations||_.scopeConfigurations.length===0).length),l=H(()=>o.contacts.filter(_=>_.scopeConfigurations&&_.scopeConfigurations.length>0).length),u=_=>{s.value=_},d=_=>_?_.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",p=_=>_?_.replace(/([A-Z])/g," $1").replace(/^./,b=>b.toUpperCase()).trim():"",f=H(()=>{let _=o.contacts;if(s.value==="no-scope"?_=_.filter(b=>!b.scopeConfigurations||b.scopeConfigurations.length===0):s.value==="with-scope"&&(_=_.filter(b=>b.scopeConfigurations&&b.scopeConfigurations.length>0)),i.value.trim()){const S=d(i.value).split(" ").filter(T=>T.length>0);_=_.filter(T=>{const D=p(T.role),I=d(`${T.name||""} ${D} ${T.email||""} ${T.phone||""}`);return S.every(C=>I.includes(C))})}return _}),m=H(()=>[...f.value].sort((_,b)=>(_.name||"").localeCompare(b.name||"",void 0,{sensitivity:"base"}))),y=H(()=>{const _=i.value.trim();return s.value==="no-scope"?_?"No unassigned contacts match your search.":"All contacts are assigned.":s.value==="with-scope"?_?"No assigned contacts match your search.":"No contacts are assigned yet.":_?"No contacts match your search.":"No contacts yet. Create one to get started!"});return(_,b)=>(v(),g("div",L2,[r("div",S2,[r("div",x2,[r("button",{onClick:b[0]||(b[0]=S=>_.$emit("add-contact")),class:"btn btn-primary"}," Add contact ")]),e.contacts.length>0?(v(),g("div",I2,[Ee(Cn,{variant:"neutral",active:s.value==="all",onClick:b[1]||(b[1]=S=>u("all"))},{default:Ue(()=>[Ke(w(e.contacts.length)+" total ",1)]),_:1},8,["active"]),l.value>0?(v(),je(Cn,{key:0,variant:"success",active:s.value==="with-scope",onClick:b[2]||(b[2]=S=>u("with-scope"))},{default:Ue(()=>[Ke(w(l.value)+" assigned ",1)]),_:1},8,["active"])):P("",!0),a.value>0?(v(),je(Cn,{key:1,variant:"danger",active:s.value==="no-scope",onClick:b[3]||(b[3]=S=>u("no-scope"))},{default:Ue(()=>[Ke(w(a.value)+" unassigned ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",$2,[r("div",T2,[Ve(r("input",{"onUpdate:modelValue":b[4]||(b[4]=S=>i.value=S),type:"text",class:"search-input",placeholder:"Search by name, role, email, or phone..."},null,512),[[nt,i.value]])])]),Ee(wv,{contacts:m.value,"show-notes":!0,"show-scopes":!0,"empty-message":y.value,onSelect:b[5]||(b[5]=S=>_.$emit("select-contact",S))},null,8,["contacts","empty-message"])]))}},A2=ze(M2,[["__scopeId","data-v-ca4b1b77"]]),E2={class:"event-details-tab"},P2={class:"event-info-card"},D2={class:"form-group"},R2={class:"form-group"},O2={class:"form-row"},B2={class:"form-group"},N2={class:"form-group"},F2=["value"],U2={class:"form-actions"},z2=["disabled"],H2={__name:"EventDetailsTab",props:{eventData:{type:Object,required:!0},formDirty:{type:Boolean,default:!1}},emits:["submit","update:formDirty"],setup(e,{emit:t}){const o=e,i=t,s=M({...o.eventData});Ze(()=>o.eventData,u=>{s.value={...u}},{deep:!0});const a=()=>{i("update:formDirty",!0)},l=()=>{i("submit",{...s.value})};return(u,d)=>(v(),g("div",E2,[r("div",P2,[r("form",{onSubmit:dt(l,["prevent"]),class:"event-details-form"},[r("div",D2,[d[4]||(d[4]=r("label",null,"Event name",-1)),Ve(r("input",{"onUpdate:modelValue":d[0]||(d[0]=p=>s.value.name=p),type:"text",required:"",class:"form-input",onInput:a},null,544),[[nt,s.value.name]])]),r("div",R2,[d[5]||(d[5]=r("label",null,"Description",-1)),Ve(r("textarea",{"onUpdate:modelValue":d[1]||(d[1]=p=>s.value.description=p),rows:"3",class:"form-input",onInput:a},null,544),[[nt,s.value.description]])]),r("div",O2,[r("div",B2,[d[6]||(d[6]=r("label",null,"Event date & time",-1)),Ve(r("input",{"onUpdate:modelValue":d[2]||(d[2]=p=>s.value.eventDate=p),type:"datetime-local",required:"",class:"form-input",onInput:a},null,544),[[nt,s.value.eventDate]])]),r("div",N2,[d[7]||(d[7]=r("label",null,"Time zone",-1)),Ve(r("select",{"onUpdate:modelValue":d[3]||(d[3]=p=>s.value.timeZoneId=p),required:"",class:"form-input",onChange:a},[(v(!0),g(xe,null,Be(V(vv),p=>(v(),g("option",{key:p.value,value:p.value},w(p.label),9,F2))),128))],544),[[Dn,s.value.timeZoneId]])])]),r("div",U2,[r("button",{type:"submit",class:"btn btn-save",disabled:!e.formDirty}," Save ",8,z2)])],32)])]))}},V2=ze(H2,[["__scopeId","data-v-2754c3cc"]]),G2={class:"admins-list"},j2={class:"admin-info"},Z2={class:"admin-role"},q2=["onClick"],W2={__name:"AdminsList",props:{admins:{type:Array,required:!0}},emits:["add-admin","remove-admin"],setup(e){return(t,o)=>(v(),g("div",null,[r("button",{onClick:o[0]||(o[0]=i=>t.$emit("add-admin")),class:"btn btn-small btn-primary"}," Add administrator "),r("div",G2,[(v(!0),g(xe,null,Be(e.admins,i=>(v(),g("div",{key:i.userEmail,class:"admin-item"},[r("div",j2,[r("strong",null,w(i.userEmail),1),r("span",Z2,w(i.role),1)]),e.admins.length>1?(v(),g("button",{key:0,onClick:s=>t.$emit("remove-admin",i.userEmail),class:"btn btn-small btn-danger"}," Remove ",8,q2)):P("",!0)]))),128))])]))}},K2=ze(W2,[["__scopeId","data-v-e526860b"]]),fo=[{name:"Charcoal",hex:"#2d3748"},{name:"Dark Gray",hex:"#4a5568"},{name:"Gray",hex:"#718096"},{name:"Red",hex:"#f56565"},{name:"Coral",hex:"#ff6b6b"},{name:"Rose",hex:"#fb7185"},{name:"Pink",hex:"#ed64a6"},{name:"Magenta",hex:"#d946ef"},{name:"Fuchsia",hex:"#e879f9"},{name:"Purple",hex:"#9f7aea"},{name:"Violet",hex:"#a78bfa"},{name:"Lavender",hex:"#b197fc"},{name:"Indigo",hex:"#5a67d8"},{name:"Navy",hex:"#4263eb"},{name:"Blue",hex:"#667eea"},{name:"Sky",hex:"#0ea5e9"},{name:"Cyan",hex:"#0bc5ea"},{name:"Aqua",hex:"#22d3ee"},{name:"Teal",hex:"#38b2ac"},{name:"Emerald",hex:"#10b981"},{name:"Green",hex:"#48bb78"},{name:"Mint",hex:"#51cf66"},{name:"Lime",hex:"#84cc16"},{name:"Olive",hex:"#a3b18a"},{name:"Yellow",hex:"#ecc94b"},{name:"Amber",hex:"#f59e0b"},{name:"Orange",hex:"#ed8936"},{name:"Peach",hex:"#ff922b"},{name:"Light Gray",hex:"#cbd5e0"},{name:"Silver",hex:"#e2e8f0"},{name:"Cream",hex:"#f7fafc"}],fr="#667eea";function Gh(e){const t=e.map(i=>i.color);return fo.find(i=>!t.includes(i.hex))?.hex||fr}const Y2={class:"modal-content"},J2={class:"modal-body"},X2={class:"preview-section"},Q2={class:"map-preview"},eL=["innerHTML"],tL={class:"options-grid"},nL={class:"option-button-content"},oL={class:"option-button-value icon-value"},sL=["innerHTML"],iL={class:"option-button-content"},aL={class:"option-button-value color-value"},lL=["disabled"],rL={class:"option-button-content"},cL={class:"option-button-value color-value"},uL={class:"option-button-content"},dL={class:"option-button-value icon-value"},hL=["innerHTML"],fL=["disabled"],pL={class:"option-button-content"},vL={class:"option-button-value color-value"},mL={class:"option-button-content"},gL={class:"option-button-value"},yL={class:"option-button-content"},kL={class:"option-button-value"},_L={key:0,class:"centered-popup"},bL={class:"popup-grid"},wL=["onClick"],CL=["innerHTML"],LL={key:0},SL={key:1,class:"centered-popup"},xL={class:"popup-grid"},IL=["title","onClick"],$L=["innerHTML"],TL={key:0},ML={key:2,class:"centered-popup"},AL={class:"popup-grid"},EL=["title","onClick"],PL=["innerHTML"],DL={key:0},RL={key:3,class:"centered-popup icon-popup"},OL={class:"popup-grid"},BL=["onClick"],NL=["innerHTML"],FL={key:0},UL={key:4,class:"centered-popup"},zL={class:"popup-grid"},HL=["title","onClick"],VL=["innerHTML"],GL={key:0},jL={key:5,class:"centered-popup"},ZL={class:"size-grid"},qL=["onClick"],WL=["innerHTML"],KL={key:6,class:"centered-popup"},YL={class:"rotation-content"},JL={class:"rotation-preview-container"},XL=["innerHTML"],QL={class:"rotation-control"},eS={class:"rotation-slider-container"},tS=["value"],nS={class:"rotation-value"},oS={class:"rotation-presets"},sS="#667eea",iS={__name:"IconCustomizationModal",props:{isOpen:{type:Boolean,default:!1},iconType:{type:String,default:"none"},backgroundShape:{type:String,default:"circle"},backgroundColor:{type:String,default:""},borderColor:{type:String,default:""},iconColor:{type:String,default:""},size:{type:String,default:"100"},mapRotation:{type:[String,Number],default:""},level:{type:String,default:"checkpoint"},inheritedType:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""}},emits:["update:isOpen","apply","cancel"],setup(e,{emit:t}){const o=e,i=t,s=M(o.backgroundShape||"circle"),a=M(o.iconType||"none"),l=M(o.backgroundColor||""),u=M(o.borderColor||""),d=M(o.iconColor||""),p=M(o.size||"100"),f=M(o.mapRotation??""),m=M(null),y=O=>O==="default"?o.inheritedBackgroundShape||"circle":O==="none"?"none":O||"circle",_=O=>O==="default"||!O?R():O==="none"?"transparent":O,b=O=>O==="default"?o.inheritedBorderColor||"#ffffff":O==="none"||!O?"transparent":O,S=O=>{if(O==="default"){const q=o.inheritedType;return q&&q!=="default"&&ea(q).category==="content"?q:"none"}return O==="none"||!O?"none":O},T=O=>O==="default"||!O?o.inheritedIconColor||"#ffffff":O==="none"?"transparent":O,D=O=>O==="default"?o.inheritedSize||"100":O||"100",I=O=>{if(O==="default"||O===""){const q=o.inheritedMapRotation;return q!==""&&q!==void 0&&q!==null&&parseInt(q,10)||0}return parseInt(O,10)||0},C=H(()=>{const O=o.inheritedBackgroundShape||"circle",q=nr.find(J=>J.value===O)?.label||"Circle";return[{value:"none",label:"None",showLabel:!0},{value:"default",label:`Default (${q})`,showLabel:!0},...nr.filter(J=>J.value!=="none").map(J=>({...J,showLabel:!1}))]}),A=H(()=>{const O=$r.filter($e=>$e.category==="content"),q=[{value:"none",label:"None",category:"content",showLabel:!0}],J=o.inheritedType;if(J&&J!=="default"){const $e=ea(J);$e.category==="content"&&q.push({value:"default",label:`Default (${$e.label||J})`,category:"content",showLabel:!0})}return q.push(...O.map($e=>({...$e,showLabel:!1}))),q}),E=H(()=>{const O={33:"Small",66:"Medium",100:"Normal",150:"Large"};return[{value:"default",label:`Default (${O[o.inheritedSize]||"Normal"})`},...H0.map(J=>({value:J.value,label:O[J.value]||J.label}))]}),N=H(()=>y(s.value)!=="none"),$=H(()=>S(a.value)!=="none"),G=H(()=>{const O=o.inheritedBackgroundColor;return O&&O!=="default"&&O.startsWith("#")?O:sS}),R=()=>G.value,Z=H(()=>l.value&&l.value!=="default"?l.value:R()),U=H(()=>u.value==="none"?"transparent":u.value?u.value:o.inheritedBorderColor&&o.inheritedBorderColor!=="none"?o.inheritedBorderColor:"#ffffff"),K=H(()=>d.value?d.value:o.inheritedIconColor?o.inheritedIconColor:"#ffffff"),re=H(()=>{const O=G.value,q=fo.find(J=>J.hex.toLowerCase()===O.toLowerCase())?.name||"Custom";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${q})`,showLabel:!0},...fo.map(J=>({hex:J.hex,name:J.name,showLabel:!1}))]}),Pe=H(()=>{const O=o.inheritedBorderColor||"#ffffff",q=O==="#ffffff"?"White":fo.find(J=>J.hex===O)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${q})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...fo.filter(J=>J.hex!=="#ffffff").map(J=>({hex:J.hex,name:J.name,showLabel:!1}))]}),me=H(()=>{const O=o.inheritedIconColor||"#ffffff",q=O==="#ffffff"?"White":fo.find(J=>J.hex===O)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${q})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...fo.filter(J=>J.hex!=="#ffffff").map(J=>({hex:J.hex,name:J.name,showLabel:!1}))]}),Ae=O=>O==="default"?!l.value||l.value==="default":l.value===O,Fe=O=>O==="#ffffff"?!d.value||d.value==="#ffffff":d.value===O,ae=O=>{if(O==="none")return"None";if(O==="default"){const J=o.inheritedBackgroundShape;return J?`Default (${nr.find(We=>We.value===J)?.label||"Circle"})`:"Default (Circle)"}const q=nr.find(J=>J.value===O);return q?q.label:"Circle"},Me=O=>{if(O==="none")return"None";if(O==="default"){const J=o.inheritedType;if(J&&J!=="default"){const $e=ea(J);if($e.category==="content")return`Default (${$e.label||J})`}return"Default"}const q=$r.find(J=>J.value===O);return q?q.label:"None"},ge=O=>{if(O==="none")return"None";if(!O||O==="default"){const J=G.value;return`Default (${fo.find(We=>We.hex.toLowerCase()===J.toLowerCase())?.name||"Custom"})`}const q=[...fo].find(J=>J.hex.toLowerCase()===O.toLowerCase());return q?q.name:O},de=O=>{if(O==="none")return"None";if(O==="default"){const J=o.inheritedBorderColor;return J&&J!=="none"?`Default (${J==="#ffffff"?"White":fo.find(We=>We.hex===J)?.name||"Custom"})`:"Default (White)"}if(!O||O==="#ffffff")return"White";const q=[...Pe.value].find(J=>J.hex===O);return q?q.name:O},Oe=O=>{if(O==="none")return"None";if(O==="default"){const J=o.inheritedIconColor;return J?`Default (${J==="#ffffff"?"White":fo.find(We=>We.hex===J)?.name||"Custom"})`:"Default (White)"}if(!O||O==="#ffffff")return"White";const q=[...me.value].find(J=>J.hex===O);return q?q.name:O},Xe=O=>{const q={33:"Small",66:"Medium",100:"Normal",150:"Large"};if(O==="default"){const J=o.inheritedSize;return`Default (${q[J]||"Normal"})`}return q[O]||"Normal"},et=O=>{if(O==="default"||O===""||O===void 0||O===null){const q=o.inheritedMapRotation;return q!==""&&q!==void 0&&q!==null?`Default (${q})`:"Default (0)"}return`${O}`},qe=O=>{if(O==="none")return`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`;const q=y(O),J=_(l.value),$e=b(u.value);return ba[q]?`<svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">${ba[q]({backgroundColor:J,borderColor:$e==="transparent"?"none":$e})}</svg>`:""},tt=O=>{const q=S(O);return q==="none"?`<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
      <rect x="1" y="1" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`:wn({type:q,backgroundShape:"circle",backgroundColor:"#94a3b8",borderColor:"none",iconColor:"#fff",size:"75"})},be=O=>{const q=y(O);if(q==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="none" stroke="#ccc" stroke-width="2" stroke-dasharray="4"/>
    </svg>`;const J=_(l.value),$e=b(u.value),We=S(a.value),ot=T(d.value);return wn({type:We!=="none"?We:q,backgroundShape:q,backgroundColor:J,borderColor:$e==="transparent"?"none":$e,iconColor:ot,size:"100",outputSize:28})},He=O=>{const q=_(O),J=y(s.value),$e=b(u.value),We=S(a.value),ot=T(d.value);return J==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${q==="transparent"?"#e2e8f0":q}"/>
    </svg>`:wn({type:We!=="none"?We:J,backgroundShape:J,backgroundColor:q==="transparent"?"#e2e8f0":q,borderColor:$e==="transparent"?"none":$e,iconColor:ot,size:"100",outputSize:28})},fe=O=>{const q=b(O),J=y(s.value),$e=_(l.value),We=S(a.value),ot=T(d.value);return J==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0" stroke="${q}" stroke-width="2"/>
    </svg>`:wn({type:We!=="none"?We:J,backgroundShape:J,backgroundColor:$e,borderColor:q==="transparent"?"none":q,iconColor:ot,size:"100",outputSize:28})},Ie=O=>{const q=S(O),J=y(s.value),$e=_(l.value),We=b(u.value),ot=T(d.value);if(q==="none"&&J==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0"/>
      <line x1="8" y1="8" x2="20" y2="20" stroke="#a0aec0" stroke-width="2" stroke-linecap="round"/>
    </svg>`;const st=J!=="none"?J:"circle";return wn({type:q!=="none"?q:st,backgroundShape:st,backgroundColor:$e,borderColor:We==="transparent"?"none":We,iconColor:ot,size:"100",outputSize:42})},Te=O=>{const q=T(O),J=y(s.value),$e=_(l.value),We=b(u.value),ot=S(a.value);return ot==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${q==="transparent"?"#e2e8f0":q}"/>
    </svg>`:wn({type:ot,backgroundShape:J!=="none"?J:"circle",backgroundColor:$e,borderColor:We==="transparent"?"none":We,iconColor:q==="transparent"?"#e2e8f0":q,size:"100",outputSize:28})},W=O=>{const q=D(O),J=y(s.value),$e=_(l.value),We=b(u.value),ot=S(a.value),st=T(d.value);if(J==="none"&&ot==="none")return"";const $t=J!=="none"?J:"circle";return wn({type:ot!=="none"?ot:$t,backgroundShape:$t,backgroundColor:$e,borderColor:We==="transparent"?"none":We,iconColor:st,size:q})},Y=H(()=>{const O=y(s.value),q=_(l.value),J=b(u.value),$e=S(a.value),We=T(d.value),ot=D(p.value);return O==="none"&&$e==="none"?"":wn(O==="none"&&$e!=="none"?{type:$e,backgroundShape:"none",backgroundColor:q,borderColor:"none",iconColor:We,size:ot}:{type:$e!=="none"?$e:O,backgroundShape:O,backgroundColor:q,borderColor:J==="transparent"?"none":J,iconColor:We,size:ot})}),le=O=>{m.value=m.value===O?null:O},ye=()=>{m.value=null},ie=O=>{s.value=O,ye()},oe=O=>{l.value=O,ye()},ce=O=>{u.value=O,ye()},De=O=>{a.value=O,ye()},we=O=>{d.value=O,ye()},te=O=>{p.value=O,ye()},ke=O=>{f.value=O,ye()},se=O=>{f.value=O};Ze(()=>o.isOpen,O=>{if(O){const q=o.backgroundShape&&o.backgroundShape!=="default"&&o.backgroundShape!=="circle",J=o.iconType&&o.iconType!=="none"&&o.iconType!=="default",$e=o.backgroundColor&&o.backgroundColor!=="",We=o.borderColor&&o.borderColor!=="",ot=o.iconColor&&o.iconColor!=="",st=o.size&&o.size!==""&&o.size!=="100",$t=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null&&o.mapRotation!==0;q||J||$e||We||ot||st||$t?(s.value=o.backgroundShape||"default",a.value=o.iconType||"default",l.value=o.backgroundColor||"default",u.value=o.borderColor||"default",d.value=o.iconColor||"default",p.value=o.size||"default",f.value=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null?o.mapRotation:"default"):(s.value="default",a.value="default",l.value="default",u.value="default",d.value="default",p.value="default",f.value="default"),m.value=null}});const Q=()=>{ye(),i("update:isOpen",!1),i("cancel")},X=()=>{ye();const O=$e=>$e==="default"?"":$e;let q="";a.value==="none"?q="none":a.value&&a.value!=="default"&&(q=a.value);let J="";f.value!=="default"&&f.value!==""&&f.value!==void 0&&(J=parseInt(f.value,10)||0),i("apply",{iconType:q,backgroundShape:O(s.value),backgroundColor:O(l.value),borderColor:O(u.value),iconColor:O(d.value),size:O(p.value),mapRotation:J}),i("update:isOpen",!1)};return(O,q)=>e.isOpen?(v(),g("div",{key:0,class:"modal-overlay",onClick:dt(Q,["self"])},[r("div",Y2,[r("div",{class:"modal-header"},[q[15]||(q[15]=r("h3",null,"Customise marker style",-1)),r("button",{class:"close-btn",onClick:Q},"")]),r("div",J2,[r("div",X2,[r("div",Q2,[q[16]||(q[16]=r("div",{class:"map-background"},null,-1)),r("div",{class:"preview-icon",style:ut({transform:`rotate(${I(f.value)}deg)`}),innerHTML:Y.value},null,12,eL)])]),r("div",tL,[r("button",{type:"button",class:ue(["option-button",{active:m.value==="shape"}]),onClick:q[0]||(q[0]=J=>le("shape"))},[r("div",nL,[q[17]||(q[17]=r("span",{class:"option-button-label"},"Shape",-1)),r("div",oL,[r("div",{class:"icon-preview-small",innerHTML:qe(s.value)},null,8,sL),r("span",null,w(ae(s.value)),1)])]),q[18]||(q[18]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:ue(["option-button",{active:m.value==="bgColor"}]),onClick:q[1]||(q[1]=J=>le("bgColor"))},[r("div",iL,[q[19]||(q[19]=r("span",{class:"option-button-label"},"Background",-1)),r("div",aL,[r("span",{class:"color-swatch",style:ut({backgroundColor:Z.value})},null,4),r("span",null,w(ge(l.value)),1)])]),q[20]||(q[20]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:ue(["option-button",{active:m.value==="borderColor",disabled:!N.value}]),disabled:!N.value,onClick:q[2]||(q[2]=J=>le("borderColor"))},[r("div",rL,[q[21]||(q[21]=r("span",{class:"option-button-label"},"Border",-1)),r("div",cL,[r("span",{class:ue(["color-swatch",{"no-border":u.value==="none"}]),style:ut(u.value!=="none"?{backgroundColor:U.value}:{})},null,6),r("span",null,w(de(u.value)),1)])]),q[22]||(q[22]=r("span",{class:"option-button-arrow"},"",-1))],10,lL),r("button",{type:"button",class:ue(["option-button",{active:m.value==="icon"}]),onClick:q[3]||(q[3]=J=>le("icon"))},[r("div",uL,[q[23]||(q[23]=r("span",{class:"option-button-label"},"Icon",-1)),r("div",dL,[r("div",{class:"icon-preview-small",innerHTML:tt(a.value)},null,8,hL),r("span",null,w(Me(a.value)),1)])]),q[24]||(q[24]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:ue(["option-button",{active:m.value==="iconColor",disabled:!$.value}]),disabled:!$.value,onClick:q[4]||(q[4]=J=>le("iconColor"))},[r("div",pL,[q[25]||(q[25]=r("span",{class:"option-button-label"},"Colour",-1)),r("div",vL,[r("span",{class:"color-swatch",style:ut({backgroundColor:K.value})},null,4),r("span",null,w(Oe(d.value)),1)])]),q[26]||(q[26]=r("span",{class:"option-button-arrow"},"",-1))],10,fL),r("button",{type:"button",class:ue(["option-button",{active:m.value==="size"}]),onClick:q[5]||(q[5]=J=>le("size"))},[r("div",mL,[q[27]||(q[27]=r("span",{class:"option-button-label"},"Size",-1)),r("span",gL,w(Xe(p.value)),1)]),q[28]||(q[28]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:ue(["option-button option-button-full",{active:m.value==="mapRotation"}]),onClick:q[6]||(q[6]=J=>le("mapRotation"))},[r("div",yL,[q[29]||(q[29]=r("span",{class:"option-button-label"},"Map rotation",-1)),r("span",kL,w(et(f.value)),1)]),q[30]||(q[30]=r("span",{class:"option-button-arrow"},"",-1))],2)]),m.value==="shape"?(v(),g("div",_L,[r("div",{class:"popup-header"},[q[31]||(q[31]=r("span",null,"Select shape",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",bL,[(v(!0),g(xe,null,Be(C.value,J=>(v(),g("button",{key:J.value,type:"button",class:ue(["popup-grid-item",{selected:s.value===J.value}]),onClick:$e=>ie(J.value)},[r("div",{class:"popup-item-preview",innerHTML:be(J.value)},null,8,CL),J.showLabel?(v(),g("span",LL,w(J.label),1)):P("",!0)],10,wL))),128))])])):P("",!0),m.value==="bgColor"?(v(),g("div",SL,[r("div",{class:"popup-header"},[q[32]||(q[32]=r("span",null,"Select background",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",xL,[(v(!0),g(xe,null,Be(re.value,J=>(v(),g("button",{key:J.hex,type:"button",class:ue(["popup-grid-item",{selected:Ae(J.hex)}]),title:J.name,onClick:$e=>oe(J.hex)},[r("div",{class:"popup-item-preview",innerHTML:He(J.hex)},null,8,$L),J.showLabel?(v(),g("span",TL,w(J.name),1)):P("",!0)],10,IL))),128))])])):P("",!0),m.value==="borderColor"?(v(),g("div",ML,[r("div",{class:"popup-header"},[q[33]||(q[33]=r("span",null,"Select border",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",AL,[(v(!0),g(xe,null,Be(Pe.value,J=>(v(),g("button",{key:J.hex,type:"button",class:ue(["popup-grid-item",{selected:u.value===J.hex}]),title:J.name,onClick:$e=>ce(J.hex)},[r("div",{class:"popup-item-preview",innerHTML:fe(J.hex)},null,8,PL),J.showLabel?(v(),g("span",DL,w(J.name),1)):P("",!0)],10,EL))),128))])])):P("",!0),m.value==="icon"?(v(),g("div",RL,[r("div",{class:"popup-header"},[q[34]||(q[34]=r("span",null,"Select icon",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",OL,[(v(!0),g(xe,null,Be(A.value,J=>(v(),g("button",{key:J.value,type:"button",class:ue(["popup-grid-item",{selected:a.value===J.value}]),onClick:$e=>De(J.value)},[r("div",{class:"popup-item-preview",innerHTML:Ie(J.value)},null,8,NL),J.showLabel?(v(),g("span",FL,w(J.label),1)):P("",!0)],10,BL))),128))])])):P("",!0),m.value==="iconColor"?(v(),g("div",UL,[r("div",{class:"popup-header"},[q[35]||(q[35]=r("span",null,"Select colour",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",zL,[(v(!0),g(xe,null,Be(me.value,J=>(v(),g("button",{key:J.hex,type:"button",class:ue(["popup-grid-item",{selected:Fe(J.hex)}]),title:J.name,onClick:$e=>we(J.hex)},[r("div",{class:"popup-item-preview",innerHTML:Te(J.hex)},null,8,VL),J.showLabel?(v(),g("span",GL,w(J.name),1)):P("",!0)],10,HL))),128))])])):P("",!0),m.value==="size"?(v(),g("div",jL,[r("div",{class:"popup-header"},[q[36]||(q[36]=r("span",null,"Select size",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",ZL,[(v(!0),g(xe,null,Be(E.value,J=>(v(),g("button",{key:J.value,type:"button",class:ue(["size-grid-item",{selected:p.value===J.value}]),onClick:$e=>te(J.value)},[r("div",{class:"size-preview",innerHTML:W(J.value)},null,8,WL),r("span",null,w(J.label),1)],10,qL))),128))])])):P("",!0),m.value==="mapRotation"?(v(),g("div",KL,[r("div",{class:"popup-header"},[q[37]||(q[37]=r("span",null,"Set map rotation",-1)),r("button",{type:"button",class:"popup-close",onClick:ye},"")]),r("div",YL,[r("div",JL,[r("div",{class:"rotation-preview-icon",style:ut({transform:`rotate(${I(f.value)}deg)`}),innerHTML:Y.value},null,12,XL)]),q[38]||(q[38]=r("p",{class:"rotation-description"}," Rotate the marker on the map. This rotation is added to any map rotation. ",-1)),r("div",QL,[r("button",{type:"button",class:ue(["rotation-preset",{selected:f.value==="default"||f.value===""}]),onClick:q[7]||(q[7]=J=>ke("default"))}," Default ",2),r("div",eS,[r("input",{type:"range",min:"-180",max:"180",step:"5",class:"rotation-slider",value:f.value==="default"||f.value===""?0:f.value,onInput:q[8]||(q[8]=J=>se(parseInt(J.target.value,10)))},null,40,tS),r("div",nS,w(f.value==="default"||f.value===""?"0":f.value)+" ",1)])]),r("div",oS,[r("button",{type:"button",class:ue(["rotation-preset-btn",{selected:f.value===-90}]),onClick:q[9]||(q[9]=J=>ke(-90))},"-90",2),r("button",{type:"button",class:ue(["rotation-preset-btn",{selected:f.value===-45}]),onClick:q[10]||(q[10]=J=>ke(-45))},"-45",2),r("button",{type:"button",class:ue(["rotation-preset-btn",{selected:f.value===0}]),onClick:q[11]||(q[11]=J=>ke(0))},"0",2),r("button",{type:"button",class:ue(["rotation-preset-btn",{selected:f.value===45}]),onClick:q[12]||(q[12]=J=>ke(45))},"+45",2),r("button",{type:"button",class:ue(["rotation-preset-btn",{selected:f.value===90}]),onClick:q[13]||(q[13]=J=>ke(90))},"+90",2),r("button",{type:"button",class:ue(["rotation-preset-btn",{selected:f.value===180}]),onClick:q[14]||(q[14]=J=>ke(180))},"180",2)])])])):P("",!0)]),r("div",{class:"modal-footer"},[r("button",{type:"button",class:"btn-cancel",onClick:Q},"Cancel"),r("button",{type:"button",class:"btn-apply",onClick:X},"Apply")])])])):P("",!0)}},aS=ze(iS,[["__scopeId","data-v-d83aaf03"]]),lS={class:"checkpoint-style-picker"},rS={class:"form-group"},cS={class:"style-options"},uS=["innerHTML"],dS={class:"option-label"},hS=["innerHTML"],fS="#667eea",pS={__name:"CheckpointStylePicker",props:{styleType:{type:String,default:"default"},styleColor:{type:String,default:""},styleBackgroundShape:{type:String,default:""},styleBackgroundColor:{type:String,default:""},styleBorderColor:{type:String,default:""},styleIconColor:{type:String,default:""},styleSize:{type:String,default:""},styleMapRotation:{type:[String,Number],default:""},iconLabel:{type:String,default:"Marker style"},showPreview:{type:Boolean,default:!0},inheritedStyleType:{type:String,default:"default"},inheritedStyleColor:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""},defaultLabel:{type:String,default:"Default"},level:{type:String,default:"checkpoint"}},emits:["update:styleType","update:styleColor","update:styleBackgroundShape","update:styleBackgroundColor","update:styleBorderColor","update:styleIconColor","update:styleSize","update:styleMapRotation","change"],setup(e,{emit:t}){const o=e,i=t,s=M(o.styleType),a=M(o.styleColor||""),l=M(o.styleBackgroundShape||"default"),u=M(o.styleBackgroundColor||""),d=M(o.styleBorderColor||""),p=M(o.styleIconColor||""),f=M(o.styleSize||"default"),m=M(o.styleMapRotation||""),y=U=>!U||U==="default"?!1:ea(U).category==="content",_=M(o.styleType&&o.styleType!=="default"&&o.styleType!=="custom"&&y(o.styleType)?o.styleType:"default"),b=M(!1),S=H(()=>!!(s.value&&s.value!=="default"||l.value&&l.value!=="default"&&l.value!=="circle"||u.value||d.value||p.value||f.value&&f.value!=="default"&&f.value!=="100")),T=U=>U&&U!==""&&U!=="default",D=U=>U&&U.startsWith("#"),I=H(()=>{const K=T(o.inheritedStyleType),re=T(o.inheritedBackgroundShape),Pe=D(o.inheritedBackgroundColor)||D(o.inheritedStyleColor),me=D(o.inheritedBorderColor),Ae=D(o.inheritedIconColor),Fe=T(o.inheritedSize);if(K||re||Pe||me||Ae||Fe){const Me=K?o.inheritedStyleType:re?o.inheritedBackgroundShape:"circle",ge=(D(o.inheritedBackgroundColor)?o.inheritedBackgroundColor:null)||(D(o.inheritedStyleColor)?o.inheritedStyleColor:null)||fS;return wn({type:Me,backgroundShape:o.inheritedBackgroundShape||"circle",backgroundColor:ge,borderColor:o.inheritedBorderColor||"#ffffff",iconColor:o.inheritedIconColor||"#ffffff",size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#10B981"/>
        <stop offset="50%" style="stop-color:#F59E0B"/>
        <stop offset="100%" style="stop-color:#EF4444"/>
      </linearGradient>
    </defs>
    <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#defaultGradient)" stroke="#fff" stroke-width="1.5"/>
  </svg>`}),C=H(()=>{const U=o.inheritedMapRotation;return U!==""&&U!==void 0&&U!==null&&U!==0?{transform:`rotate(${U}deg)`}:{}}),A=H(()=>{if(m.value!==""&&m.value!==void 0&&m.value!==null){const K=parseInt(m.value,10)||0;if(K!==0)return{transform:`rotate(${K}deg)`}}const U=o.inheritedMapRotation;return U!==""&&U!==void 0&&U!==null&&U!==0?{transform:`rotate(${U}deg)`}:{}}),E=H(()=>{if(S.value){const U=_.value&&_.value!=="none"&&_.value!=="default";let K=null;o.inheritedStyleType&&o.inheritedStyleType!=="default"&&o.inheritedStyleType!=="custom"&&ea(o.inheritedStyleType).category==="content"&&(K=o.inheritedStyleType);const re=_.value==="default"&&K,Pe=U||re,me=U?_.value:re?K:null,Ae=l.value&&l.value!=="default"?l.value:o.inheritedBackgroundShape||"circle",Fe=Pe?me:Ae,ae=u.value||o.inheritedBackgroundColor||o.inheritedStyleColor||"#667eea",Me=d.value||o.inheritedBorderColor||"#ffffff",ge=p.value||o.inheritedIconColor||"#ffffff";return wn({type:Fe,backgroundShape:Ae,backgroundColor:ae,borderColor:Me,iconColor:ge,size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#e2e8f0" stroke="#cbd5e0" stroke-width="1.5"/>
    <path d="M12 8v8M8 12h8" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
  </svg>`}),N=()=>{s.value="default",_.value="default",i("update:styleType","default"),l.value="default",u.value="",a.value="",d.value="",p.value="",f.value="default",m.value="",i("update:styleBackgroundShape",""),i("update:styleBackgroundColor",""),i("update:styleColor",""),i("update:styleBorderColor",""),i("update:styleIconColor",""),i("update:styleSize",""),i("update:styleMapRotation",""),Z()},$=()=>{b.value=!0},G=U=>{U.iconType==="none"?_.value="none":U.iconType?_.value=U.iconType:_.value="default",l.value=U.backgroundShape||"default",u.value=U.backgroundColor||"",d.value=U.borderColor||"",p.value=U.iconColor||"",f.value=U.size||"default",m.value=U.mapRotation??"";const K=U.iconType==="none"||U.iconType&&U.iconType!==""||U.backgroundShape||U.backgroundColor||U.borderColor||U.iconColor||U.size||U.mapRotation!==""&&U.mapRotation!==0;U.iconType&&U.iconType!=="none"?s.value=U.iconType:K?s.value="custom":s.value="default",i("update:styleType",s.value),i("update:styleBackgroundShape",U.backgroundShape),i("update:styleBackgroundColor",U.backgroundColor),i("update:styleBorderColor",U.borderColor),i("update:styleIconColor",U.iconColor),i("update:styleSize",U.size),i("update:styleMapRotation",U.mapRotation??""),Z()},R=()=>{},Z=()=>{i("change",{styleType:s.value,styleColor:u.value||a.value,styleBackgroundShape:l.value,styleBackgroundColor:u.value,styleBorderColor:d.value,styleIconColor:p.value,styleSize:f.value,styleMapRotation:m.value})};return Ze(()=>o.styleType,U=>{s.value=U,U&&U!=="default"&&U!=="custom"&&y(U)?_.value=U:_.value="default"}),Ze(()=>o.styleColor,U=>{a.value=U||""}),Ze(()=>o.styleBackgroundShape,U=>{l.value=U||"default"}),Ze(()=>o.styleBackgroundColor,U=>{u.value=U||""}),Ze(()=>o.styleBorderColor,U=>{d.value=U||""}),Ze(()=>o.styleIconColor,U=>{p.value=U||""}),Ze(()=>o.styleSize,U=>{f.value=U||"default"}),Ze(()=>o.styleMapRotation,U=>{m.value=U??""}),(U,K)=>(v(),g("div",lS,[r("div",rS,[r("label",null,w(e.iconLabel),1),r("div",cS,[r("button",{type:"button",class:ue(["style-option-button",{selected:!S.value}]),onClick:N},[r("div",{class:"option-preview",style:ut(C.value),innerHTML:I.value},null,12,uS),r("span",dS,w(e.defaultLabel),1)],2),r("button",{type:"button",class:ue(["style-option-button",{selected:S.value}]),onClick:$},[r("div",{class:"option-preview",style:ut(A.value),innerHTML:E.value},null,12,hS),K[1]||(K[1]=r("span",{class:"option-label"},"Custom",-1))],2)])]),Ee(aS,{isOpen:b.value,"onUpdate:isOpen":K[0]||(K[0]=re=>b.value=re),"icon-type":_.value,"background-shape":l.value,"background-color":u.value,"border-color":d.value,"icon-color":p.value,size:f.value,"map-rotation":m.value,level:e.level,"inherited-type":e.inheritedStyleType,"inherited-background-shape":e.inheritedBackgroundShape,"inherited-background-color":e.inheritedBackgroundColor||e.inheritedStyleColor,"inherited-border-color":e.inheritedBorderColor,"inherited-icon-color":e.inheritedIconColor,"inherited-size":e.inheritedSize,"inherited-map-rotation":e.inheritedMapRotation,onApply:G,onCancel:R},null,8,["isOpen","icon-type","background-shape","background-color","border-color","icon-color","size","map-rotation","level","inherited-type","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])]))}},ju=ze(pS,[["__scopeId","data-v-c066da64"]]),vS={class:"logo-uploader"},mS={key:0,class:"logo-preview"},gS=["src"],yS=["disabled"],kS={key:0,class:"upload-progress"},_S={key:1,class:"upload-prompt"},bS={key:2,class:"error-message"},jh=5*1024*1024,wS={__name:"LogoUploader",props:{modelValue:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e;function i(){const S={},T=localStorage.getItem("adminEmail");T&&(S["X-Admin-Email"]=T);const D=localStorage.getItem("sessionToken");return D&&(S.Authorization=`Bearer ${D}`),S}const s=t,a=M(null),l=M(!1),u=M(!1),d=M(""),p=["image/png","image/jpeg","image/svg+xml","image/gif","image/webp"];function f(){l.value||a.value?.click()}function m(S){const T=S.target.files?.[0];T&&_(T),a.value&&(a.value.value="")}function y(S){u.value=!1;const T=S.dataTransfer?.files?.[0];T&&_(T)}async function _(S){if(d.value="",!p.includes(S.type)){d.value="Invalid file type. Please use PNG, JPEG, SVG, GIF, or WebP.";return}if(S.size>jh){d.value=`File too large. Maximum size is ${jh/(1024*1024)}MB.`;return}l.value=!0;try{const T=await fetch(`${au}/events/${o.eventId}/logo`,{method:"POST",headers:{"Content-Type":S.type,...i()},body:S});if(!T.ok){const I=await T.json().catch(()=>({}));throw new Error(I.message||"Upload failed")}const D=await T.json();s("update:modelValue",D.logoUrl)}catch(T){console.error("Logo upload error:",T),T.name==="TypeError"&&T.message==="Failed to fetch"?d.value="Network error. The file may be too large or the server is unavailable.":d.value=T.message||"Failed to upload logo. Please try again."}finally{l.value=!1}}async function b(){d.value="",l.value=!0;try{const S=await fetch(`${au}/events/${o.eventId}/logo`,{method:"DELETE",headers:i()});if(!S.ok){const T=await S.json().catch(()=>({}));throw new Error(T.message||"Delete failed")}s("update:modelValue","")}catch(S){console.error("Logo delete error:",S),d.value=S.message||"Failed to remove logo. Please try again."}finally{l.value=!1}}return(S,T)=>(v(),g("div",vS,[T[4]||(T[4]=r("label",{class:"uploader-label"},"Event Logo",-1)),e.modelValue?(v(),g("div",mS,[r("img",{src:e.modelValue,alt:"Event logo",class:"logo-image"},null,8,gS),r("button",{type:"button",class:"remove-btn",onClick:b,disabled:l.value}," Remove ",8,yS)])):(v(),g("div",{key:1,class:ue(["upload-area",{"drag-over":u.value,uploading:l.value}]),onDragover:T[0]||(T[0]=dt(D=>u.value=!0,["prevent"])),onDragleave:T[1]||(T[1]=dt(D=>u.value=!1,["prevent"])),onDrop:dt(y,["prevent"]),onClick:f},[r("input",{ref_key:"fileInput",ref:a,type:"file",accept:"image/png,image/jpeg,image/svg+xml,image/gif,image/webp",class:"file-input",onChange:m},null,544),l.value?(v(),g("div",kS,[...T[2]||(T[2]=[r("div",{class:"spinner"},null,-1),r("span",null,"Uploading...",-1)])])):(v(),g("div",_S,[...T[3]||(T[3]=[r("div",{class:"upload-icon"},"+",-1),r("span",{class:"upload-text"},"Click or drag to upload logo",-1),r("span",{class:"upload-hint"},"PNG, JPEG, SVG, GIF, WebP (max 5MB)",-1)])]))],34)),d.value?(v(),g("div",bS,w(d.value),1)):P("",!0)]))}},CS=ze(wS,[["__scopeId","data-v-7f31cd0c"]]),Cv=[{name:"Default",headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},{name:"Wasp",headerGradientStart:"#333333",headerGradientEnd:"#333333",accentColor:"#FFD700",pageGradientStart:"#FFD700",pageGradientEnd:"#333333"},{name:"Ocean",headerGradientStart:"#0077be",headerGradientEnd:"#00a8e8",accentColor:"#0077be",pageGradientStart:"#0077be",pageGradientEnd:"#00a8e8"},{name:"Forest",headerGradientStart:"#228b22",headerGradientEnd:"#32cd32",accentColor:"#228b22",pageGradientStart:"#228b22",pageGradientEnd:"#32cd32"},{name:"Sunset",headerGradientStart:"#ff6b35",headerGradientEnd:"#f7931e",accentColor:"#ff6b35",pageGradientStart:"#ff6b35",pageGradientEnd:"#f7931e"},{name:"Berry",headerGradientStart:"#8e2de2",headerGradientEnd:"#4a00e0",accentColor:"#8e2de2",pageGradientStart:"#8e2de2",pageGradientEnd:"#4a00e0"},{name:"Coral",headerGradientStart:"#ff758c",headerGradientEnd:"#ff7eb3",accentColor:"#ff758c",pageGradientStart:"#ff758c",pageGradientEnd:"#ff7eb3"},{name:"Steel",headerGradientStart:"#485563",headerGradientEnd:"#29323c",accentColor:"#485563",pageGradientStart:"#485563",pageGradientEnd:"#29323c"},{name:"Mint",headerGradientStart:"#11998e",headerGradientEnd:"#38ef7d",accentColor:"#11998e",pageGradientStart:"#11998e",pageGradientEnd:"#38ef7d"},{name:"Cherry",headerGradientStart:"#eb3349",headerGradientEnd:"#f45c43",accentColor:"#eb3349",pageGradientStart:"#eb3349",pageGradientEnd:"#f45c43"},{name:"Midnight",headerGradientStart:"#232526",headerGradientEnd:"#414345",accentColor:"#5c5c5c",pageGradientStart:"#232526",pageGradientEnd:"#414345"},{name:"Lavender",headerGradientStart:"#a18cd1",headerGradientEnd:"#fbc2eb",accentColor:"#a18cd1",pageGradientStart:"#a18cd1",pageGradientEnd:"#fbc2eb"},{name:"Gold",headerGradientStart:"#f7971e",headerGradientEnd:"#ffd200",accentColor:"#f7971e",pageGradientStart:"#f7971e",pageGradientEnd:"#ffd200"}];function LS(){return{...Cv[0]}}function SS(e,t){return{...e,headerGradientStart:t.headerGradientStart,headerGradientEnd:t.headerGradientEnd,accentColor:t.accentColor,pageGradientStart:t.pageGradientStart,pageGradientEnd:t.pageGradientEnd,logoUrl:"",logoPosition:""}}function vu(e){const t=e.replace("#",""),o=parseInt(t.slice(0,2),16)/255,i=parseInt(t.slice(2,4),16)/255,s=parseInt(t.slice(4,6),16)/255,a=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),l=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*a+.7152*l+.0722*u}function Lv(e){return!e||e===""?"#ffffff":vu(e)>.179?"#333333":"#ffffff"}function Sv(e,t){const o=e||eo.headerGradientStart,i=t||eo.headerGradientEnd,s=vu(o),a=vu(i);return(s+a)/2>.35?"#333333":"#ffffff"}const eo={headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},xS={class:"marshal-mockup-container"},IS={class:"presets-section"},$S={class:"presets-row"},TS=["title","onClick"],MS={class:"preset-name"},AS={class:"mockup-frame"},ES={key:0,class:"logo-cover-bg"},PS=["src"],DS=["src"],RS={key:1,class:"logo-placeholder"},OS={class:"event-name"},BS={class:"mockup-buttons"},NS=["src"],FS={key:1,class:"logo-placeholder"},US={class:"mockup-body"},zS={class:"mockup-card"},HS={class:"card-content"},VS={class:"editor-modal"},GS={class:"editor-header"},jS={class:"editor-content"},ZS={class:"color-grid-inline"},qS={class:"color-field"},WS={class:"color-swatches"},KS=["title","onClick"],YS={key:0,class:"check"},JS={class:"color-field"},XS={class:"color-swatches"},QS=["title","onClick"],ex={key:0,class:"check"},tx={class:"logo-position-section"},nx={class:"position-buttons"},ox={class:"color-swatches"},sx=["title","onClick"],ix={key:0,class:"check"},ax={class:"color-grid-inline"},lx={class:"color-field"},rx={class:"color-swatches"},cx=["title","onClick"],ux={key:0,class:"check"},dx={class:"color-field"},hx={class:"color-swatches"},fx=["title","onClick"],px={key:0,class:"check"},vx={class:"editor-footer"},mx={__name:"MarshalModeMockup",props:{branding:{type:Object,required:!0},eventName:{type:String,default:""},eventDate:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:branding"],setup(e,{emit:t}){const o=fo,i=e,s=t,a=M(null),l=Cv,u={header:"Header gradient",logo:"Event logo",accent:"Accent colour",page:"Page background"},d=H(()=>i.branding.headerGradientStart||eo.headerGradientStart),p=H(()=>i.branding.headerGradientEnd||eo.headerGradientEnd),f=H(()=>i.branding.accentColor||eo.accentColor),m=H(()=>i.branding.pageGradientStart||eo.pageGradientStart),y=H(()=>i.branding.pageGradientEnd||eo.pageGradientEnd),_=H(()=>i.branding.logoPosition||"left"),b=H(()=>({background:`linear-gradient(135deg, ${d.value} 0%, ${p.value} 100%)`})),S=H(()=>Sv(d.value,p.value)),T=H(()=>({background:f.value,color:Lv(f.value)})),D=H(()=>({background:`linear-gradient(135deg, ${m.value} 0%, ${y.value} 100%)`}));function I(E){a.value=a.value===E?null:E}function C(E,N){s("update:branding",{...i.branding,[E]:N})}function A(E){s("update:branding",SS(i.branding,E)),a.value=null}return(E,N)=>(v(),g("div",xS,[r("div",IS,[N[13]||(N[13]=r("span",{class:"presets-label"},"Quick themes:",-1)),r("div",$S,[(v(!0),g(xe,null,Be(V(l),$=>(v(),g("button",{key:$.name,type:"button",class:"preset-btn",title:$.name,onClick:G=>A($)},[r("span",{class:"preset-preview",style:ut({background:`linear-gradient(135deg, ${$.pageGradientStart} 0%, ${$.pageGradientEnd} 100%)`})},null,4),r("span",MS,w($.name),1)],8,TS))),128))])]),r("div",AS,[r("div",{class:ue(["mockup-page",{"region-active":a.value==="page"}]),style:ut(D.value),onClick:N[5]||(N[5]=$=>I("page"))},[r("div",{class:ue(["mockup-header",[{"region-active":a.value==="header"},`logo-${_.value}`]]),style:ut(b.value),onClick:N[3]||(N[3]=dt($=>I("header"),["stop"]))},[e.branding.logoUrl&&_.value==="cover"?(v(),g("div",ES,[r("img",{src:e.branding.logoUrl,alt:"Logo",class:"logo-cover-img"},null,8,PS)])):P("",!0),_.value==="left"?(v(),g("div",{key:1,class:ue(["mockup-logo logo-left",{"region-active":a.value==="logo"}]),onClick:N[0]||(N[0]=dt($=>I("logo"),["stop"]))},[e.branding.logoUrl?(v(),g("img",{key:0,src:e.branding.logoUrl,alt:"Logo",class:"logo-img"},null,8,DS)):(v(),g("span",RS,"+ Logo"))],2)):P("",!0),r("div",{class:ue(["header-center",{"region-active":a.value==="logo"&&!e.branding.logoUrl&&_.value!=="left"&&_.value!=="right"}]),onClick:N[1]||(N[1]=dt($=>I("logo"),["stop"]))},[r("div",{class:"mockup-title",style:ut({color:S.value})},[r("span",OS,w(e.eventName||"Event Name"),1)],4),r("div",{class:"mockup-date",style:ut({color:S.value})},w(e.eventDate||"Event Date"),5),r("div",BS,[N[14]||(N[14]=r("span",{class:"btn-emergency"},"Emergency",-1)),r("span",{class:"btn-logout",style:ut({color:S.value})},"Logout",4)])],2),_.value==="right"?(v(),g("div",{key:2,class:ue(["mockup-logo logo-right",{"region-active":a.value==="logo"}]),onClick:N[2]||(N[2]=dt($=>I("logo"),["stop"]))},[e.branding.logoUrl?(v(),g("img",{key:0,src:e.branding.logoUrl,alt:"Logo",class:"logo-img"},null,8,NS)):(v(),g("span",FS,"+ Logo"))],2)):P("",!0)],6),r("div",US,[r("div",zS,[N[15]||(N[15]=r("div",{class:"card-header"},"Your checkpoints (2)",-1)),r("div",HS,[r("div",{class:ue(["mockup-checkin-btn",{"region-active":a.value==="accent"}]),style:ut(T.value),onClick:N[4]||(N[4]=dt($=>I("accent"),["stop"]))}," GPS Check-In ",6)])])])],6)]),a.value?(v(),g("div",{key:0,class:"editor-overlay",onClick:N[12]||(N[12]=dt($=>a.value=null,["self"]))},[r("div",VS,[r("div",GS,[r("span",null,w(u[a.value]),1),r("button",{type:"button",class:"editor-close",onClick:N[6]||(N[6]=$=>a.value=null)},"")]),r("div",jS,[a.value==="header"?(v(),g(xe,{key:0},[N[18]||(N[18]=r("p",{class:"editor-description"},"Choose the colours for the header gradient.",-1)),r("div",ZS,[r("div",qS,[N[16]||(N[16]=r("label",null,"Start colour",-1)),r("div",WS,[(v(!0),g(xe,null,Be(V(o),$=>(v(),g("button",{key:"hs-"+$.hex,type:"button",class:ue(["color-swatch-btn",{selected:e.branding.headerGradientStart===$.hex}]),style:ut({backgroundColor:$.hex}),title:$.name,onClick:G=>C("headerGradientStart",$.hex)},[e.branding.headerGradientStart===$.hex?(v(),g("span",YS,"")):P("",!0)],14,KS))),128))])]),r("div",JS,[N[17]||(N[17]=r("label",null,"End colour",-1)),r("div",XS,[(v(!0),g(xe,null,Be(V(o),$=>(v(),g("button",{key:"he-"+$.hex,type:"button",class:ue(["color-swatch-btn",{selected:e.branding.headerGradientEnd===$.hex}]),style:ut({backgroundColor:$.hex}),title:$.name,onClick:G=>C("headerGradientEnd",$.hex)},[e.branding.headerGradientEnd===$.hex?(v(),g("span",ex,"")):P("",!0)],14,QS))),128))])])])],64)):P("",!0),a.value==="logo"?(v(),g(xe,{key:1},[r("div",tx,[N[19]||(N[19]=r("label",{class:"editor-label"},"Position",-1)),r("div",nx,[r("button",{type:"button",class:ue(["position-btn",{selected:_.value==="left"}]),onClick:N[7]||(N[7]=$=>C("logoPosition","left"))}," Left ",2),r("button",{type:"button",class:ue(["position-btn",{selected:_.value==="cover"}]),onClick:N[8]||(N[8]=$=>C("logoPosition","cover"))}," Cover ",2),r("button",{type:"button",class:ue(["position-btn",{selected:_.value==="right"}]),onClick:N[9]||(N[9]=$=>C("logoPosition","right"))}," Right ",2)])]),Ee(CS,{"model-value":e.branding.logoUrl,"event-id":e.eventId,"admin-email":e.adminEmail,"onUpdate:modelValue":N[10]||(N[10]=$=>C("logoUrl",$))},null,8,["model-value","event-id","admin-email"])],64)):P("",!0),a.value==="accent"?(v(),g(xe,{key:2},[N[20]||(N[20]=r("p",{class:"editor-description"},"Choose the accent colour for buttons.",-1)),r("div",ox,[(v(!0),g(xe,null,Be(V(o),$=>(v(),g("button",{key:"ac-"+$.hex,type:"button",class:ue(["color-swatch-btn",{selected:e.branding.accentColor===$.hex}]),style:ut({backgroundColor:$.hex}),title:$.name,onClick:G=>C("accentColor",$.hex)},[e.branding.accentColor===$.hex?(v(),g("span",ix,"")):P("",!0)],14,sx))),128))])],64)):P("",!0),a.value==="page"?(v(),g(xe,{key:3},[N[23]||(N[23]=r("p",{class:"editor-description"},"Choose the colours for the page background gradient.",-1)),r("div",ax,[r("div",lx,[N[21]||(N[21]=r("label",null,"Start colour",-1)),r("div",rx,[(v(!0),g(xe,null,Be(V(o),$=>(v(),g("button",{key:"ps-"+$.hex,type:"button",class:ue(["color-swatch-btn",{selected:e.branding.pageGradientStart===$.hex}]),style:ut({backgroundColor:$.hex}),title:$.name,onClick:G=>C("pageGradientStart",$.hex)},[e.branding.pageGradientStart===$.hex?(v(),g("span",ux,"")):P("",!0)],14,cx))),128))])]),r("div",dx,[N[22]||(N[22]=r("label",null,"End colour",-1)),r("div",hx,[(v(!0),g(xe,null,Be(V(o),$=>(v(),g("button",{key:"pe-"+$.hex,type:"button",class:ue(["color-swatch-btn",{selected:e.branding.pageGradientEnd===$.hex}]),style:ut({backgroundColor:$.hex}),title:$.name,onClick:G=>C("pageGradientEnd",$.hex)},[e.branding.pageGradientEnd===$.hex?(v(),g("span",px,"")):P("",!0)],14,fx))),128))])])])],64)):P("",!0)]),r("div",vx,[r("button",{type:"button",class:"btn-done",onClick:N[11]||(N[11]=$=>a.value=null)},"Done")])])])):P("",!0),N[24]||(N[24]=r("p",{class:"instructions"}," Click on different parts of the preview to customise them. The emergency button stays red for safety. ",-1))]))}},gx=ze(mx,[["__scopeId","data-v-55faf78c"]]),yx={class:"settings-tab"},kx={class:"accordion"},_x={class:"accordion-section"},bx={class:"accordion-title"},wx={class:"accordion-icon"},Cx={key:0,class:"accordion-content"},Lx={class:"accordion-section"},Sx={class:"accordion-icon"},xx={key:0,class:"accordion-content"},Ix={class:"terminology-grid"},$x={class:"term-group"},Tx=["value"],Mx={class:"term-group"},Ax=["value"],Ex={class:"term-group"},Px=["value"],Dx={class:"term-group"},Rx=["value"],Ox={class:"term-group"},Bx=["value"],Nx={class:"form-actions"},Fx=["disabled"],Ux={class:"accordion-section"},zx={class:"accordion-title"},Hx={class:"accordion-icon"},Vx={key:0,class:"accordion-content"},Gx={class:"section-description"},jx={class:"form-actions"},Zx=["disabled"],qx={class:"accordion-section"},Wx={class:"accordion-title"},Kx={class:"accordion-icon"},Yx={key:0,class:"accordion-content"},Jx={class:"section-description"},Xx={class:"form-actions"},Qx=["disabled"],Zh="admin_settings_accordion",eI={__name:"SettingsTab",props:{eventData:{type:Object,required:!0},admins:{type:Array,default:()=>[]},formDirty:{type:Boolean,default:!1},eventId:{type:String,default:""}},emits:["submit","add-admin","remove-admin","update:formDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=St(),s=Na(),a=H(()=>s.adminEmail||""),l=e,u=t,d=M({...l.eventData}),p=()=>l.eventId?`${Zh}_${l.eventId}`:Zh,f=M(null);Qt(()=>{const C=localStorage.getItem(p());C&&(f.value=C)});const m=H(()=>{const C=d.value.peopleTerm||"Marshals";return Bs.checkpoint.map(A=>({value:A,label:uu(A,C)}))}),y=C=>{const A=f.value===C?null:C;f.value=A,A?localStorage.setItem(p(),A):localStorage.removeItem(p())};Ze(()=>l.eventData,C=>{d.value={...C}},{deep:!0});const _=()=>{u("update:formDirty",!0)},b=(C,A)=>{d.value[C]=A,_()},S=H(()=>({headerGradientStart:d.value.brandingHeaderGradientStart||"",headerGradientEnd:d.value.brandingHeaderGradientEnd||"",logoUrl:d.value.brandingLogoUrl||"",logoPosition:d.value.brandingLogoPosition||"",accentColor:d.value.brandingAccentColor||"",pageGradientStart:d.value.brandingPageGradientStart||"",pageGradientEnd:d.value.brandingPageGradientEnd||""})),T=C=>{d.value.brandingHeaderGradientStart=C.headerGradientStart,d.value.brandingHeaderGradientEnd=C.headerGradientEnd,d.value.brandingLogoUrl=C.logoUrl,d.value.brandingLogoPosition=C.logoPosition,d.value.brandingAccentColor=C.accentColor,d.value.brandingPageGradientStart=C.pageGradientStart,d.value.brandingPageGradientEnd=C.pageGradientEnd,_()},D=()=>{LS(),d.value.brandingHeaderGradientStart="",d.value.brandingHeaderGradientEnd="",d.value.brandingLogoUrl="",d.value.brandingLogoPosition="",d.value.brandingAccentColor="",d.value.brandingPageGradientStart="",d.value.brandingPageGradientEnd="",_()},I=()=>{u("submit",{...d.value})};return(C,A)=>(v(),g("div",yx,[r("div",kx,[r("div",_x,[r("button",{class:ue(["accordion-header",{active:f.value==="admins"}]),onClick:A[0]||(A[0]=E=>y("admins"))},[r("span",bx,"Administrators ("+w(e.admins.length)+")",1),r("span",wx,w(f.value==="admins"?"-":"+"),1)],2),f.value==="admins"?(v(),g("div",Cx,[Ee(K2,{admins:e.admins,onAddAdmin:A[1]||(A[1]=E=>C.$emit("add-admin")),onRemoveAdmin:A[2]||(A[2]=E=>C.$emit("remove-admin",E))},null,8,["admins"])])):P("",!0)]),r("div",Lx,[r("button",{class:ue(["accordion-header",{active:f.value==="terminology"}]),onClick:A[3]||(A[3]=E=>y("terminology"))},[A[19]||(A[19]=r("span",{class:"accordion-title"},"Terminology",-1)),r("span",Sx,w(f.value==="terminology"?"-":"+"),1)],2),f.value==="terminology"?(v(),g("div",xx,[A[20]||(A[20]=r("p",{class:"section-description"}," Customise how things are named throughout the application. ",-1)),r("div",Ix,[r("div",$x,[r("label",null,w(V(o).people)+" are called",1),Ve(r("select",{"onUpdate:modelValue":A[4]||(A[4]=E=>d.value.peopleTerm=E),class:"form-input",onChange:_},[(v(!0),g(xe,null,Be(V(Bs).people,E=>(v(),g("option",{key:E,value:E},w(E),9,Tx))),128))],544),[[Dn,d.value.peopleTerm]])]),r("div",Mx,[r("label",null,w(V(o).checkpoints)+" are called",1),Ve(r("select",{"onUpdate:modelValue":A[5]||(A[5]=E=>d.value.checkpointTerm=E),class:"form-input",onChange:_},[(v(!0),g(xe,null,Be(m.value,E=>(v(),g("option",{key:E.value,value:E.value},w(E.label),9,Ax))),128))],544),[[Dn,d.value.checkpointTerm]])]),r("div",Ex,[r("label",null,w(V(o).areas)+" are called",1),Ve(r("select",{"onUpdate:modelValue":A[6]||(A[6]=E=>d.value.areaTerm=E),class:"form-input",onChange:_},[(v(!0),g(xe,null,Be(V(Bs).area,E=>(v(),g("option",{key:E,value:E},w(E),9,Px))),128))],544),[[Dn,d.value.areaTerm]])]),r("div",Dx,[r("label",null,w(V(o).checklists)+" are called",1),Ve(r("select",{"onUpdate:modelValue":A[7]||(A[7]=E=>d.value.checklistTerm=E),class:"form-input",onChange:_},[(v(!0),g(xe,null,Be(V(Bs).checklist,E=>(v(),g("option",{key:E,value:E},w(E),9,Rx))),128))],544),[[Dn,d.value.checklistTerm]])]),r("div",Ox,[r("label",null,w(V(o).course)+" is called",1),Ve(r("select",{"onUpdate:modelValue":A[8]||(A[8]=E=>d.value.courseTerm=E),class:"form-input",onChange:_},[(v(!0),g(xe,null,Be(V(Bs).course,E=>(v(),g("option",{key:E,value:E},w(E),9,Bx))),128))],544),[[Dn,d.value.courseTerm]])])]),r("div",Nx,[r("button",{onClick:I,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,Fx)])])):P("",!0)]),r("div",Ux,[r("button",{class:ue(["accordion-header",{active:f.value==="appearance"}]),onClick:A[9]||(A[9]=E=>y("appearance"))},[r("span",zx,w(V(o).checkpoint)+" appearance",1),r("span",Hx,w(f.value==="appearance"?"-":"+"),1)],2),f.value==="appearance"?(v(),g("div",Vx,[r("p",Gx," Set the default marker style for all "+w(V(i).checkpoints)+" in this event. Individual "+w(V(i).areas)+" and "+w(V(i).checkpoints)+" can override this setting. ",1),Ee(ju,{"style-type":d.value.defaultCheckpointStyleType||"default","style-color":d.value.defaultCheckpointStyleColor||"","style-background-shape":d.value.defaultCheckpointStyleBackgroundShape||"","style-background-color":d.value.defaultCheckpointStyleBackgroundColor||"","style-border-color":d.value.defaultCheckpointStyleBorderColor||"","style-icon-color":d.value.defaultCheckpointStyleIconColor||"","style-size":d.value.defaultCheckpointStyleSize||"","style-map-rotation":d.value.defaultCheckpointStyleMapRotation??"","icon-label":"Default marker style",level:"event","show-preview":!0,"onUpdate:styleType":A[10]||(A[10]=E=>b("defaultCheckpointStyleType",E)),"onUpdate:styleColor":A[11]||(A[11]=E=>b("defaultCheckpointStyleColor",E)),"onUpdate:styleBackgroundShape":A[12]||(A[12]=E=>b("defaultCheckpointStyleBackgroundShape",E)),"onUpdate:styleBackgroundColor":A[13]||(A[13]=E=>b("defaultCheckpointStyleBackgroundColor",E)),"onUpdate:styleBorderColor":A[14]||(A[14]=E=>b("defaultCheckpointStyleBorderColor",E)),"onUpdate:styleIconColor":A[15]||(A[15]=E=>b("defaultCheckpointStyleIconColor",E)),"onUpdate:styleSize":A[16]||(A[16]=E=>b("defaultCheckpointStyleSize",E)),"onUpdate:styleMapRotation":A[17]||(A[17]=E=>b("defaultCheckpointStyleMapRotation",E))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation"]),r("div",jx,[r("button",{onClick:I,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,Zx)])])):P("",!0)]),r("div",qx,[r("button",{class:ue(["accordion-header",{active:f.value==="branding"}]),onClick:A[18]||(A[18]=E=>y("branding"))},[r("span",Wx,w(V(o).person)+" branding",1),r("span",Kx,w(f.value==="branding"?"-":"+"),1)],2),f.value==="branding"?(v(),g("div",Yx,[r("p",Jx," Customise the appearance of the "+w(V(i).person)+" view to match your organisation's branding. ",1),Ee(gx,{branding:S.value,"event-name":d.value.name,"event-date":V(kv)(d.value.eventDate),"event-id":e.eventId,"admin-email":a.value,"onUpdate:branding":T},null,8,["branding","event-name","event-date","event-id","admin-email"]),r("div",Xx,[r("button",{onClick:D,class:"btn btn-secondary"}," Reset to default "),r("button",{onClick:I,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,Qx)])])):P("",!0)])])]))}},tI=ze(eI,[["__scopeId","data-v-c04b872a"]]),nI={class:"incident-header"},oI={class:"incident-title-row"},sI={class:"incident-title"},iI={class:"incident-badges"},aI={key:0,class:"incident-description"},lI={class:"incident-context"},rI={key:0,class:"context-item"},cI={key:1,class:"context-item"},uI={key:2,class:"context-item"},dI={class:"incident-footer"},hI={class:"reporter-info"},fI={class:"time-info"},pI={__name:"IncidentCard",props:{incident:{type:Object,required:!0}},emits:["select"],setup(e){const t=e,o=H(()=>{if(t.incident.title)return t.incident.title;const u=t.incident.description||"";return u.length<=60?u:u.substring(0,57).trim()+"..."}),i=u=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[u]||u,s=u=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[u]||u,a=(u,d=120)=>!u||u.length<=d?u:u.substring(0,d).trim()+"...",l=u=>{if(!u)return"";const d=new Date(u),f=new Date-d,m=Math.floor(f/6e4),y=Math.floor(f/36e5),_=Math.floor(f/864e5);return m<1?"just now":m<60?`${m}m ago`:y<24?`${y}h ago`:_<7?`${_}d ago`:d.toLocaleDateString()};return(u,d)=>(v(),g("div",{class:ue(["incident-card",[`severity-${e.incident.severity}`,`status-${e.incident.status}`]]),onClick:d[0]||(d[0]=p=>u.$emit("select",e.incident))},[r("div",nI,[r("div",oI,[r("span",{class:ue(["severity-indicator",e.incident.severity])},null,2),r("strong",sI,w(o.value),1)]),r("div",iI,[r("span",{class:ue(["severity-badge",e.incident.severity])},w(i(e.incident.severity)),3),r("span",{class:ue(["status-badge",e.incident.status])},w(s(e.incident.status)),3)])]),e.incident.title&&e.incident.description?(v(),g("div",aI,w(a(e.incident.description)),1)):P("",!0),r("div",lI,[e.incident.context?.checkpoint?(v(),g("div",rI,[d[1]||(d[1]=r("span",{class:"context-icon"},"",-1)),r("span",null,w(e.incident.context.checkpoint.name),1)])):e.incident.latitude&&e.incident.longitude?(v(),g("div",cI,[...d[2]||(d[2]=[r("span",{class:"context-icon"},"",-1),r("span",null,"GPS Location",-1)])])):P("",!0),e.incident.area?(v(),g("div",uI,[d[3]||(d[3]=r("span",{class:"context-icon"},"",-1)),r("span",null,w(e.incident.area.areaName),1)])):P("",!0)]),r("div",dI,[r("span",hI," Reported by "+w(e.incident.reportedBy?.name||"Unknown"),1),r("span",fI,w(l(e.incident.incidentTime||e.incident.createdAt)),1)])],2))}},Fl=ze(pI,[["__scopeId","data-v-690fd385"]]),vI={class:"incidents-tab"},mI={class:"tab-header"},gI={class:"button-group"},yI={key:0,class:"status-pills"},kI={class:"filters-section"},_I={class:"search-group"},bI={class:"incidents-list"},wI={key:0,class:"loading-state"},CI={key:1,class:"empty-state"},LI={__name:"IncidentsTab",props:{incidents:{type:Array,required:!0},areas:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["select-incident","report-incident"],setup(e,{emit:t}){const o=e,i=M(""),s=M("all"),a=y=>{s.value=y},l=H(()=>o.incidents.filter(y=>y.status==="open").length),u=H(()=>o.incidents.filter(y=>y.status==="in_progress"||y.status==="acknowledged").length),d=H(()=>o.incidents.filter(y=>y.status==="resolved").length),p=H(()=>o.incidents.filter(y=>y.status==="closed").length),f=H(()=>{let y=o.incidents;if(s.value==="open"?y=y.filter(_=>_.status==="open"):s.value==="in-progress"?y=y.filter(_=>_.status==="in_progress"||_.status==="acknowledged"):s.value==="resolved"?y=y.filter(_=>_.status==="resolved"):s.value==="closed"&&(y=y.filter(_=>_.status==="closed")),i.value.trim()){const _=i.value.toLowerCase().trim().split(/\s+/);y=y.filter(b=>{const S=`${b.context?.checkpoint?.name||""} ${b.context?.checkpoint?.description||""}`,T=b.area?.areaName||"",D=[b.reportedBy?.name||"",...(b.context?.peopleAtCheckpoint||[]).map(A=>A.name||"")].join(" "),I=(b.updates||[]).map(A=>A.note||"").join(" "),C=`${b.title||""} ${b.description||""} ${S} ${T} ${D} ${I}`.toLowerCase();return _.every(A=>C.includes(A))})}return y}),m=H(()=>[...f.value].sort((y,_)=>new Date(_.incidentTime||_.createdAt)-new Date(y.incidentTime||y.createdAt)));return(y,_)=>(v(),g("div",vI,[r("div",mI,[r("div",gI,[r("button",{onClick:_[0]||(_[0]=b=>y.$emit("report-incident")),class:"btn btn-primary"}," Report incident ")]),e.incidents.length>0?(v(),g("div",yI,[Ee(Cn,{variant:"neutral",active:s.value==="all",onClick:_[1]||(_[1]=b=>a("all"))},{default:Ue(()=>[Ke(w(e.incidents.length)+" total ",1)]),_:1},8,["active"]),l.value>0?(v(),je(Cn,{key:0,variant:"info",active:s.value==="open",onClick:_[2]||(_[2]=b=>a("open"))},{default:Ue(()=>[Ke(w(l.value)+" open ",1)]),_:1},8,["active"])):P("",!0),u.value>0?(v(),je(Cn,{key:1,variant:"purple",active:s.value==="in-progress",onClick:_[3]||(_[3]=b=>a("in-progress"))},{default:Ue(()=>[Ke(w(u.value)+" in progress ",1)]),_:1},8,["active"])):P("",!0),d.value>0?(v(),je(Cn,{key:2,variant:"success",active:s.value==="resolved",onClick:_[4]||(_[4]=b=>a("resolved"))},{default:Ue(()=>[Ke(w(d.value)+" resolved ",1)]),_:1},8,["active"])):P("",!0),p.value>0?(v(),je(Cn,{key:3,variant:"neutral",active:s.value==="closed",onClick:_[5]||(_[5]=b=>a("closed"))},{default:Ue(()=>[Ke(w(p.value)+" closed ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",kI,[r("div",_I,[Ve(r("input",{"onUpdate:modelValue":_[6]||(_[6]=b=>i.value=b),type:"text",class:"search-input",placeholder:"Search by title, description, location, area, or person..."},null,512),[[nt,i.value]])])]),r("div",bI,[e.loading?(v(),g("div",wI," Loading incidents... ")):f.value.length===0?(v(),g("div",CI,[r("p",null,w(i.value||s.value!=="all"?"No incidents match your search or filter.":"No incidents reported yet."),1)])):P("",!0),(v(!0),g(xe,null,Be(m.value,b=>(v(),je(Fl,{key:b.incidentId,incident:b,onSelect:S=>y.$emit("select-incident",b)},null,8,["incident","onSelect"]))),128))])]))}},SI=ze(LI,[["__scopeId","data-v-56bde653"]]),xI={class:"checkpoint-card-header"},II={class:"checkpoint-name-row"},$I=["innerHTML"],TI={class:"checkpoint-name"},MI={key:0,class:"checkpoint-description"},AI={key:0,class:"checkpoint-card-areas"},EI={class:"checkpoint-card-stats"},PI={key:1,class:"checkpoint-card-marshals"},DI={__name:"CheckpointCard",props:{checkpoint:{type:Object,required:!0},areas:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const o=e,i=t,s=H(()=>o.checkpoint.areaIds||o.checkpoint.AreaIds||[]),a=T=>{const D=o.areas.find(I=>I.id===T);return D?D.name:null},l=T=>{const D=o.areas.find(I=>I.id===T);return D?D.color:"#999"},u=H(()=>{const T=o.checkpoint,D=T.resolvedStyleBackgroundColor||T.ResolvedStyleBackgroundColor||T.resolvedStyleColor||T.ResolvedStyleColor;return D||(s.value.length>0?l(s.value[0]):"#667eea")}),d=H(()=>{const T=o.checkpoint;return T.requiredMarshals===0?null:T.checkedInCount>=T.requiredMarshals?"full":T.checkedInCount>0?"partial":"none"}),p=H(()=>[...o.checkpoint.assignments||[]].sort((D,I)=>(D.marshalName||"").localeCompare(I.marshalName||"",void 0,{sensitivity:"base"}))),f=H(()=>(o.checkpoint.assignments||[]).length),m=H(()=>(o.checkpoint.assignments||[]).filter(T=>T.isCheckedIn).length),y=H(()=>d.value?`staffing-${d.value}`:""),_=H(()=>{const T=f.value,D=m.value;return T===0?"":D===0?"checkin-none":D>=T?"checkin-full":"checkin-partial"}),b=H(()=>{const T=o.checkpoint,D=T.resolvedStyleType||T.ResolvedStyleType,I=T.resolvedStyleBackgroundColor||T.ResolvedStyleBackgroundColor||T.resolvedStyleColor||T.ResolvedStyleColor,C=T.resolvedStyleBorderColor||T.ResolvedStyleBorderColor,A=T.resolvedStyleIconColor||T.ResolvedStyleIconColor,E=T.resolvedStyleBackgroundShape||T.ResolvedStyleBackgroundShape;return D&&D!=="default"||I||C||A||E&&E!=="circle"?wn({type:D||"circle",backgroundShape:E||"circle",backgroundColor:I||"#667eea",borderColor:C||"#ffffff",iconColor:A||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),S=()=>{o.clickable&&i("click",o.checkpoint)};return(T,D)=>(v(),g("div",{class:ue(["checkpoint-card",{"is-clickable":e.clickable,"staffed-full":d.value==="full","staffed-partial":d.value==="partial","staffed-none":d.value==="none"}]),style:ut({borderLeftColor:u.value}),onClick:S},[r("div",xI,[r("div",{class:ue(["checkpoint-card-title",{clickable:e.clickable}])},[r("span",II,[r("span",{class:"checkpoint-icon",innerHTML:b.value},null,8,$I),r("span",TI,w(e.checkpoint.name),1),e.checkpoint.description?(v(),g("span",MI,"  "+w(e.checkpoint.description),1)):P("",!0)])],2)]),s.value.length>0?(v(),g("div",AI,[(v(!0),g(xe,null,Be(s.value,I=>(v(),g("span",{key:I,class:"area-badge",style:ut({backgroundColor:l(I)})},w(a(I)),5))),128))])):P("",!0),r("div",EI,[r("span",{class:ue(["stat-badge staffing-badge",y.value])},w(e.checkpoint.checkedInCount)+"/"+w(e.checkpoint.requiredMarshals)+" staffed ",3),f.value>0?(v(),g("span",{key:0,class:ue(["stat-badge",_.value])},w(m.value)+"/"+w(f.value)+" checked in ",3)):P("",!0)]),p.value.length>0?(v(),g("div",PI,[(v(!0),g(xe,null,Be(p.value,I=>(v(),g("span",{key:I.id,class:ue(["marshal-badge",{"checked-in":I.isCheckedIn}])},w(I.marshalName),3))),128))])):P("",!0)],6))}},RI=ze(DI,[["__scopeId","data-v-da001590"]]),xv={__name:"CheckpointsGrid",props:{checkpoints:{type:Array,required:!0},areas:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No checkpoints."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,o)=>(v(),je(Nl,{"is-empty":e.checkpoints.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ue(()=>[(v(!0),g(xe,null,Be(e.checkpoints,i=>(v(),je(RI,{key:i.id,checkpoint:i,areas:e.areas,clickable:!0,onClick:o[0]||(o[0]=s=>t.$emit("select",s))},null,8,["checkpoint","areas"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},OI={class:"checkpoints-tab"},BI={class:"tab-header"},NI={class:"button-group"},FI={key:0,class:"status-pills"},UI={class:"filters-section"},zI={class:"search-group"},HI=["placeholder"],VI={__name:"CheckpointsList",props:{locations:{type:Array,required:!0},areas:{type:Array,default:()=>[]}},emits:["add-checkpoint-manually","import-checkpoints","select-location"],setup(e){const{termsLower:t}=St(),o=e,i=M(""),s=M("all"),a=_=>{s.value=_},l=H(()=>o.locations.filter(_=>_.checkedInCount>=_.requiredMarshals&&_.requiredMarshals>0).length),u=H(()=>o.locations.filter(_=>_.checkedInCount>0&&_.checkedInCount<_.requiredMarshals).length),d=H(()=>o.locations.filter(_=>_.checkedInCount===0&&_.requiredMarshals>0).length),p=_=>{const b=o.areas.find(S=>S.id===_);return b?b.name:null},f=H(()=>{let _=o.locations;if(s.value==="full"?_=_.filter(b=>b.checkedInCount>=b.requiredMarshals&&b.requiredMarshals>0):s.value==="partial"?_=_.filter(b=>b.checkedInCount>0&&b.checkedInCount<b.requiredMarshals):s.value==="missing"&&(_=_.filter(b=>b.checkedInCount===0&&b.requiredMarshals>0)),i.value.trim()){const b=i.value.toLowerCase().trim().split(/\s+/);_=_.filter(S=>{const D=(S.areaIds||S.AreaIds||[]).map(A=>p(A)||"").join(" "),I=(S.assignments||[]).map(A=>A.marshalName||"").join(" "),C=`${S.name||""} ${S.description||""} ${D} ${I}`.toLowerCase();return b.every(A=>C.includes(A))})}return _}),m=H(()=>[...f.value].sort((_,b)=>js(_.name,b.name))),y=H(()=>{const _=i.value.trim();return s.value==="full"?_?`No fully staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully staffed.`:s.value==="partial"?_?`No partially staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially staffed.`:s.value==="missing"?_?`No unstaffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are unstaffed.`:_?`No ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} yet. Add one to get started!`});return(_,b)=>(v(),g("div",OI,[r("div",BI,[r("div",NI,[r("button",{onClick:b[0]||(b[0]=S=>_.$emit("add-checkpoint-manually")),class:"btn btn-primary"}," Add "+w(V(t).checkpoint),1),r("button",{onClick:b[1]||(b[1]=S=>_.$emit("import-checkpoints")),class:"btn btn-secondary"}," Import CSV ")]),e.locations.length>0?(v(),g("div",FI,[Ee(Cn,{variant:"neutral",active:s.value==="all",onClick:b[2]||(b[2]=S=>a("all"))},{default:Ue(()=>[Ke(w(e.locations.length)+" total ",1)]),_:1},8,["active"]),l.value>0?(v(),je(Cn,{key:0,variant:"success",active:s.value==="full",onClick:b[3]||(b[3]=S=>a("full"))},{default:Ue(()=>[Ke(w(l.value)+" fully staffed ",1)]),_:1},8,["active"])):P("",!0),u.value>0?(v(),je(Cn,{key:1,variant:"warning",active:s.value==="partial",onClick:b[4]||(b[4]=S=>a("partial"))},{default:Ue(()=>[Ke(w(u.value)+" partial ",1)]),_:1},8,["active"])):P("",!0),d.value>0?(v(),je(Cn,{key:2,variant:"danger",active:s.value==="missing",onClick:b[5]||(b[5]=S=>a("missing"))},{default:Ue(()=>[Ke(w(d.value)+" unstaffed ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),r("div",UI,[r("div",zI,[Ve(r("input",{"onUpdate:modelValue":b[6]||(b[6]=S=>i.value=S),type:"text",class:"search-input",placeholder:`Search by name, description, ${V(t).area}, or ${V(t).person}...`},null,8,HI),[[nt,i.value]])])]),Ee(xv,{checkpoints:m.value,areas:e.areas,"empty-message":y.value,onSelect:b[7]||(b[7]=S=>_.$emit("select-location",S))},null,8,["checkpoints","areas","empty-message"])]))}},GI=ze(VI,[["__scopeId","data-v-35be2364"]]),jI={class:"area-card-header"},ZI={class:"area-name-row"},qI={class:"area-name"},WI={key:0,class:"default-badge"},KI={key:0,class:"area-description"},YI={class:"area-card-stats"},JI={class:"stat-badge"},XI={class:"stat-badge"},QI={__name:"AreaCard",props:{area:{type:Object,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const o=e,i=t,s=H(()=>o.area.checkpointCount!==void 0?o.area.checkpointCount:o.checkpoints.filter(f=>(f.areaIds||f.AreaIds||[]).includes(o.area.id)||f.areaId===o.area.id).length),a=H(()=>o.contacts.filter(f=>f.scopeConfigurations?f.scopeConfigurations.some(m=>m.scope==="EveryoneInAreas"&&m.itemType==="Area"?m.ids?.includes("ALL_AREAS")?!0:m.ids?.includes(o.area.id):!1):!1).length),l=H(()=>o.area.peopleTerm||o.eventPeopleTerm||"Marshals"),u=H(()=>{const f=o.area.checkpointTerm||o.eventCheckpointTerm||"Checkpoints";return s.value===1?Zi("checkpoint",f,l.value):yv("checkpoint",f,l.value)}),d=H(()=>`${s.value} ${u.value.toLowerCase()}`),p=()=>{o.clickable&&i("click",o.area)};return(f,m)=>(v(),g("div",{class:ue(["area-card",{"is-clickable":e.clickable,"is-default":e.area.isDefault}]),style:ut({borderLeftColor:e.area.color||"#667eea"}),onClick:p},[r("div",jI,[r("div",{class:ue(["area-card-title",{clickable:e.clickable}])},[r("div",ZI,[r("span",qI,w(e.area.name),1),e.area.isDefault?(v(),g("span",WI,"Default")):P("",!0)]),e.area.description?(v(),g("span",KI,w(e.area.description),1)):P("",!0)],2)]),r("div",YI,[r("span",JI,w(d.value),1),r("span",XI,w(a.value)+" contact"+w(a.value===1?"":"s"),1)])],6))}},e$=ze(QI,[["__scopeId","data-v-8ac20bf2"]]),t$={__name:"AreasGrid",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},emptyMessage:{type:String,default:"No areas."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,o)=>(v(),je(Nl,{"is-empty":e.areas.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ue(()=>[(v(!0),g(xe,null,Be(e.areas,i=>(v(),je(e$,{key:i.id,area:i,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,clickable:!0,onClick:o[0]||(o[0]=s=>t.$emit("select",s))},null,8,["area","checkpoints","contacts","event-people-term","event-checkpoint-term"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},n$={class:"areas-tab"},o$={class:"tab-header"},s$={class:"button-group"},i$={key:0,class:"status-pills"},a$={class:"filters-section"},l$={class:"search-group"},r$=["placeholder"],c$={__name:"AreasList",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["add-area","select-area"],setup(e){const{termsLower:t}=St(),o=e,i=M(""),s=d=>o.checkpoints.filter(p=>(p.areaIds||p.AreaIds||[]).includes(d)||p.areaId===d),a=H(()=>{if(!i.value.trim())return o.areas;const d=i.value.toLowerCase().trim().split(/\s+/);return o.areas.filter(p=>{const m=s(p.id).map(_=>`${_.name||""} ${_.description||""}`).join(" "),y=`${p.name||""} ${p.description||""} ${m}`.toLowerCase();return d.every(_=>y.includes(_))})}),l=H(()=>[...a.value].sort((d,p)=>d.displayOrder!==p.displayOrder?d.displayOrder-p.displayOrder:js(d.name,p.name))),u=H(()=>i.value.trim()?`No ${t.value.areas} match your search.`:`No ${t.value.areas} yet. Click "Add ${t.value.area}" to create one.`);return(d,p)=>(v(),g("div",n$,[r("div",o$,[r("div",s$,[r("button",{onClick:p[0]||(p[0]=f=>d.$emit("add-area")),class:"btn btn-primary"}," Add "+w(V(t).area),1)]),e.areas.length>0?(v(),g("div",i$,[Ee(Cn,{variant:"neutral",active:!1},{default:Ue(()=>[Ke(w(e.areas.length)+" "+w(e.areas.length===1?V(t).area:V(t).areas),1)]),_:1})])):P("",!0)]),r("div",a$,[r("div",l$,[Ve(r("input",{"onUpdate:modelValue":p[1]||(p[1]=f=>i.value=f),type:"text",class:"search-input",placeholder:`Search by ${V(t).area} name or ${V(t).checkpoint} name...`},null,8,r$),[[nt,i.value]])])]),Ee(t$,{areas:l.value,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,"empty-message":u.value,onSelect:p[2]||(p[2]=f=>d.$emit("select-area",f))},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term","empty-message"])]))}},u$=ze(c$,[["__scopeId","data-v-203f9606"]]),d$={course:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>',checkpoint:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',area:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',marshal:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',checklist:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>',notes:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/></svg>',incidents:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>',details:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16h6"/></svg>',location:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',contacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>',people:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polygon points="22 8 19.5 10 20.5 13 18 11.5 15.5 13 16.5 10 14 8 17 8 18 5 19 8 22 8" fill="currentColor"/></svg>',eventContacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 8V6a2 2 0 0 0-2-2h-2"/><path d="M22 12v2a2 2 0 0 1-2 2h-2"/></svg>',event:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>',appearance:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12.5" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>',logout:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>'},Sn=e=>d$[e]||"",h$={class:"responsive-tabs"},f$=["onClick"],p$=["innerHTML"],v$=["innerHTML"],m$={class:"hamburger-label"},g$=["onClick"],y$=["innerHTML"],k$={__name:"ResponsiveTabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,i=t,s=M(null),a=M(null),l=M(null),u=M(!1),d=M({}),p=M(!1),f=H(()=>o.tabs.find(D=>D.value===o.modelValue)),m=H(()=>f.value?f.value.label:"Menu"),y=()=>{if(u.value=!u.value,u.value&&a.value){const D=a.value.getBoundingClientRect();d.value={top:`${D.bottom+4}px`}}},_=D=>{i("update:modelValue",D),u.value=!1},b=D=>{if(!s.value)return;const I=s.value.contains(D.target);u.value&&!I&&(u.value=!1)},S=()=>{if(!l.value)return;const D=l.value,I=p.value;I&&(D.style.visibility="visible",D.style.position="static");const C=D.scrollWidth>D.clientWidth;I&&(D.style.visibility="",D.style.position=""),p.value=C};let T=null;return Qt(()=>{document.addEventListener("click",b),qn(()=>{S()}),qn(()=>{const D=l.value?.parentElement;D&&(T=new ResizeObserver(()=>{S()}),T.observe(D))})}),On(()=>{document.removeEventListener("click",b),T&&T.disconnect()}),Ze(()=>o.tabs,()=>{qn(()=>{S()})},{deep:!0}),(D,I)=>(v(),g("div",h$,[r("div",{ref_key:"visibleTabsRef",ref:l,class:ue(["visible-tabs",{"is-hidden":p.value}])},[(v(!0),g(xe,null,Be(e.tabs,C=>(v(),g("button",{key:C.value,class:ue(["tab-button",{active:e.modelValue===C.value}]),onClick:A=>D.$emit("update:modelValue",C.value),type:"button"},[C.icon?(v(),g("span",{key:0,class:"tab-icon",innerHTML:V(Sn)(C.icon)},null,8,p$)):P("",!0),Ke(" "+w(C.label),1)],10,f$))),128))],2),r("div",{class:ue(["hamburger-only",{"is-visible":p.value}])},[r("div",{class:"hamburger-menu",ref_key:"hamburgerMenu",ref:s},[r("button",{ref_key:"hamburgerButton",ref:a,class:ue(["hamburger-button",{active:u.value}]),onClick:dt(y,["stop"]),type:"button"},[I[1]||(I[1]=r("span",{class:"hamburger-icon"},"",-1)),f.value?.icon?(v(),g("span",{key:0,class:"tab-icon",innerHTML:V(Sn)(f.value.icon)},null,8,v$)):P("",!0),r("span",m$,w(m.value),1)],2),u.value?(v(),g("div",{key:0,class:"hamburger-dropdown",style:ut(d.value),onClick:I[0]||(I[0]=dt(()=>{},["stop"]))},[(v(!0),g(xe,null,Be(e.tabs,C=>(v(),g("button",{key:C.value,class:ue(["dropdown-item",{active:e.modelValue===C.value}]),onClick:dt(A=>_(C.value),["stop"]),type:"button"},[C.icon?(v(),g("span",{key:0,class:"tab-icon",innerHTML:V(Sn)(C.icon)},null,8,y$)):P("",!0),Ke(" "+w(C.label),1)],10,g$))),128))],4)):P("",!0)],512)],2)]))}},_$=ze(k$,[["__scopeId","data-v-2467c6fc"]]),b$={class:"share-link-container"},w$=["value"],C$={__name:"ShareLinkModal",props:{show:{type:Boolean,default:!1},link:{type:String,required:!0},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=t,i=M(!1),s=M(null),a=()=>{s.value&&(s.value.select(),document.execCommand("copy"),i.value=!0,setTimeout(()=>{i.value=!1},2e3))},l=()=>{o("close")};return(u,d)=>(v(),je(zt,{show:e.show,title:"Marshal check-in link",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:l},{actions:Ue(()=>[r("button",{onClick:l,class:"btn btn-secondary"},"Close")]),default:Ue(()=>[d[0]||(d[0]=r("p",{class:"instruction"},"Share this link with marshals so they can check in:",-1)),r("div",b$,[r("input",{value:e.link,readonly:"",class:"form-input",ref_key:"linkInput",ref:s},null,8,w$),r("button",{onClick:a,class:"btn btn-primary"},w(i.value?"Copied!":"Copy"),1)])]),_:1},8,["show","is-dirty"]))}},L$=ze(C$,[["__scopeId","data-v-98fe71d6"]]),S$={class:"success-content"},x$={class:"success-message"},I$={class:"link-section"},$$={class:"help-text"},T$={key:0,class:"loading-text"},M$={key:1,class:"magic-link-container"},A$=["value"],E$={class:"magic-link-actions"},P$=["disabled"],D$={key:0,class:"success-text"},R$={key:1,class:"error-text"},O$={key:2,class:"error-text"},B$={__name:"MarshalCreatedModal",props:{show:{type:Boolean,default:!1},eventId:{type:String,required:!0},marshalId:{type:String,default:null},marshalName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const{terms:o}=St(),i=e,s=t,a=M(""),l=M(!1),u=M(!1),d=M(""),p=M(!1),f=M(!1),m=M(!1),y=M(""),_=async()=>{if(!(!i.eventId||!i.marshalId)){u.value=!0,d.value="";try{const D=await hs.getMagicLink(i.eventId,i.marshalId);a.value=D.data.magicLink,l.value=D.data.hasEmail}catch(D){console.error("Failed to fetch magic link:",D),d.value="Failed to load login link"}finally{u.value=!1}}},b=async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(a.value);else{const D=document.createElement("textarea");D.value=a.value,D.style.position="fixed",D.style.left="-9999px",document.body.appendChild(D),D.select(),document.execCommand("copy"),document.body.removeChild(D)}p.value=!0,setTimeout(()=>{p.value=!1},2e3)}catch(D){console.error("Failed to copy:",D)}},S=async()=>{if(!(!i.eventId||!i.marshalId)){f.value=!0,m.value=!1,y.value="";try{await hs.sendMagicLink(i.eventId,i.marshalId),m.value=!0,setTimeout(()=>{m.value=!1},3e3)}catch(D){console.error("Failed to send email:",D),y.value=D.response?.data?.message||"Failed to send email"}finally{f.value=!1}}},T=()=>{s("close")};return Ze(()=>i.show,D=>{D&&i.marshalId?_():(a.value="",l.value=!1,d.value="",p.value=!1,m.value=!1,y.value="")},{immediate:!0}),(D,I)=>(v(),je(zt,{show:e.show,title:`${V(o).person} created`,size:"medium","confirm-on-close":!1,"is-dirty":!1,onClose:T},{actions:Ue(()=>[r("button",{onClick:T,class:"btn btn-primary"},"Done")]),default:Ue(()=>[r("div",S$,[I[2]||(I[2]=r("div",{class:"success-icon"},"",-1)),r("p",x$,[r("strong",null,w(e.marshalName),1),I[1]||(I[1]=Ke(" has been added successfully. ",-1))])]),r("div",I$,[I[3]||(I[3]=r("label",null,"Login link",-1)),r("p",$$," Share this unique link with "+w(e.marshalName)+" so they can access their dashboard and check in. ",1),u.value?(v(),g("div",T$,"Loading link...")):a.value?(v(),g("div",M$,[r("input",{type:"text",value:a.value,readonly:"",class:"form-input magic-link-input",onFocus:I[0]||(I[0]=C=>C.target.select())},null,40,A$),r("div",E$,[r("button",{type:"button",class:"btn btn-secondary",onClick:b},w(p.value?"Copied!":"Copy link"),1),l.value?(v(),g("button",{key:0,type:"button",class:"btn btn-primary",disabled:f.value,onClick:S},w(f.value?"Sending...":"Send via email"),9,P$)):P("",!0)]),m.value?(v(),g("p",D$,"Email sent successfully!")):P("",!0),y.value?(v(),g("p",R$,w(y.value),1)):P("",!0)])):d.value?(v(),g("div",O$,w(d.value),1)):P("",!0)])]),_:1},8,["show","title"]))}},N$=ze(B$,[["__scopeId","data-v-e99677e9"]]),F$={class:"form-group"},U$={__name:"AddAdminModal",props:{show:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=M("");Ze(()=>o.show,d=>{d||(s.value="")});const a=()=>{i("update:isDirty",!0)},l=()=>{i("submit",s.value)},u=()=>{i("close")};return(d,p)=>(v(),je(zt,{show:e.show,title:"Add event administrator",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:Ue(()=>[r("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-primary"}," Add administrator ")]),default:Ue(()=>[p[2]||(p[2]=r("p",{class:"instruction"},"Enter the email address of the administrator to add",-1)),r("form",{onSubmit:dt(l,["prevent"])},[r("div",F$,[p[1]||(p[1]=r("label",null,"Email address",-1)),Ve(r("input",{"onUpdate:modelValue":p[0]||(p[0]=f=>s.value=f),type:"email",required:"",class:"form-input",placeholder:"admin@example.com",onInput:a},null,544),[[nt,s.value]])])],32)]),_:1},8,["show","is-dirty"]))}},z$=ze(U$,[["__scopeId","data-v-a82da194"]]),H$={class:"form-group"},V$={key:0,class:"error"},G$=["disabled"],j$={__name:"UploadRouteModal",props:{show:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},error:{type:String,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=M(null);Ze(()=>o.show,d=>{d||(s.value=null)});const a=d=>{s.value=d.target.files[0],i("update:isDirty",!0)},l=()=>{s.value&&i("submit",s.value)},u=()=>{i("close")};return(d,p)=>(v(),je(zt,{show:e.show,title:"Upload GPX route",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:Ue(()=>[r("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-primary",disabled:e.uploading},w(e.uploading?"Uploading...":"Upload route"),9,G$)]),default:Ue(()=>[p[1]||(p[1]=r("p",{class:"instruction"},"Upload a GPX file to display the event route on the map",-1)),r("form",{onSubmit:dt(l,["prevent"])},[r("div",H$,[p[0]||(p[0]=r("label",null,"GPX file",-1)),r("input",{type:"file",accept:".gpx",onChange:a,required:"",class:"form-input"},null,32)]),e.error?(v(),g("div",V$,w(e.error),1)):P("",!0)],32)]),_:1},8,["show","is-dirty"]))}},Z$=ze(j$,[["__scopeId","data-v-317975db"]]),q$={class:"instruction"},W$={class:"form-group"},K$={class:"form-group"},Y$={class:"checkbox-label"},J$={key:0,class:"error"},X$={key:1,class:"import-result"},Q$={key:0,class:"import-errors"},eT=["disabled"],tT={__name:"ImportLocationsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=St(),s=e,a=t,l=M(null),u=M(!1);Ze(()=>s.show,y=>{y||(l.value=null,u.value=!1)});const d=y=>{l.value=y.target.files[0],a("update:isDirty",!0)},p=()=>{a("update:isDirty",!0)},f=()=>{l.value&&a("submit",{file:l.value,deleteExisting:u.value})},m=()=>{a("close")};return(y,_)=>(v(),je(zt,{show:e.show,title:`Import ${V(i).checkpoints} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:m},{actions:Ue(()=>[r("button",{type:"button",onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-primary",disabled:e.importing},w(e.importing?"Importing...":`Import ${V(i).checkpoints}`),9,eT)]),default:Ue(()=>[r("p",q$,"Upload a CSV file with columns: Label, Lat/Latitude, Long/Longitude, What3Words (optional), "+w(V(o).people)+" (optional)",1),_[3]||(_[3]=r("div",{class:"csv-example"},[r("strong",null,"Example CSV format:"),r("pre",null,`Label,Latitude,Longitude,What3Words,Marshals
Checkpoint 1,51.505,-0.09,filled.count.soap,"John Doe, Jane Smith"
Checkpoint 2,51.510,-0.10,index.home.raft,Bob Wilson`)],-1)),r("form",{onSubmit:dt(f,["prevent"])},[r("div",W$,[_[1]||(_[1]=r("label",null,"CSV file",-1)),r("input",{type:"file",accept:".csv",onChange:d,required:"",class:"form-input"},null,32)]),r("div",K$,[r("label",Y$,[Ve(r("input",{type:"checkbox","onUpdate:modelValue":_[0]||(_[0]=b=>u.value=b),onChange:p},null,544),[[Zr,u.value]]),Ke(" Delete existing "+w(V(i).checkpoints)+" before import ",1)])]),e.error?(v(),g("div",J$,w(e.error),1)):P("",!0),e.result?(v(),g("div",X$,[r("p",null,"Created "+w(e.result.locationsCreated)+" "+w(V(i).checkpoints)+" and "+w(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),g("div",Q$,[_[2]||(_[2]=r("strong",null,"Errors:",-1)),r("ul",null,[(v(!0),g(xe,null,Be(e.result.errors,(b,S)=>(v(),g("li",{key:S},w(b),1))),128))])])):P("",!0)])):P("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},nT=ze(tT,[["__scopeId","data-v-75c79d31"]]),oT={class:"instruction"},sT={class:"form-group"},iT={key:0,class:"error"},aT={key:1,class:"import-result"},lT={key:0,class:"import-errors"},rT=["disabled"],cT={__name:"ImportMarshalsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=St(),s=e,a=t,l=M(null);Ze(()=>s.show,f=>{f||(l.value=null)});const u=f=>{l.value=f.target.files[0],a("update:isDirty",!0)},d=()=>{l.value&&a("submit",l.value)},p=()=>{a("close")};return(f,m)=>(v(),je(zt,{show:e.show,title:`Import ${V(i).people} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:p},{actions:Ue(()=>[r("button",{type:"button",onClick:p,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:d,class:"btn btn-primary",disabled:e.importing},w(e.importing?"Importing...":`Import ${V(i).people}`),9,rT)]),default:Ue(()=>[r("p",oT,"Upload a CSV file with columns: Name, Email (optional), Phone (optional), "+w(V(o).checkpoint)+" (optional)",1),m[2]||(m[2]=r("div",{class:"csv-example"},[r("strong",null,"Example CSV format:"),r("pre",null,`Name,Email,Phone,Checkpoint
John Doe,john@example.com,555-1234,Checkpoint 1
Jane Smith,jane@example.com,555-5678,Checkpoint 2`)],-1)),r("form",{onSubmit:dt(d,["prevent"])},[r("div",sT,[m[0]||(m[0]=r("label",null,"CSV file",-1)),r("input",{type:"file",accept:".csv",onChange:u,required:"",class:"form-input"},null,32)]),e.error?(v(),g("div",iT,w(e.error),1)):P("",!0),e.result?(v(),g("div",aT,[r("p",null,"Imported "+w(e.result.marshalsCreated)+" "+w(V(i).people)+" and "+w(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),g("div",lT,[m[1]||(m[1]=r("strong",null,"Errors:",-1)),r("ul",null,[(v(!0),g(xe,null,Be(e.result.errors,(y,_)=>(v(),g("li",{key:_},w(y),1))),128))])])):P("",!0)])):P("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},uT=ze(cT,[["__scopeId","data-v-be89bf1f"]]),dT=["onClick"],hT=["innerHTML"],fT={class:"hamburger-nav"},pT=["disabled"],vT=["innerHTML"],mT={class:"current-tab-label"},gT=["disabled"],yT={key:0,class:"hamburger-menu"},kT=["onClick"],_T=["innerHTML"],bT=400,wT={__name:"TabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,i=t,s=M(null),a=M(null),l=M(null),u=M(!1),d=M(!1),p=H(()=>{const E=o.tabs.find(N=>N.value===o.modelValue);return E?E.label:""}),f=H(()=>o.tabs.find(N=>N.value===o.modelValue)?.icon||null),m=H(()=>o.tabs.findIndex(E=>E.value===o.modelValue)),y=H(()=>m.value>0),_=H(()=>m.value<o.tabs.length-1),b=()=>{y.value&&i("update:modelValue",o.tabs[m.value-1].value)},S=()=>{_.value&&i("update:modelValue",o.tabs[m.value+1].value)},T=()=>{if(!s.value)return;const E=s.value.clientWidth;if(E<bT){u.value=!0;return}if(a.value&&!u.value){a.value.scrollWidth>E&&(u.value=!0);return}const N=o.tabs.some(R=>R.icon)?110:90,$=o.tabs.length*N,G=(o.tabs.length-1)*8;$+G<=E&&(u.value=!1,qn(()=>{a.value&&a.value.scrollWidth>E&&(u.value=!0)}))},D=()=>{d.value=!d.value},I=E=>{i("update:modelValue",E),d.value=!1},C=E=>{l.value&&!l.value.contains(E.target)&&(d.value=!1)};let A=null;return Qt(()=>{qn(()=>{T(),s.value&&typeof ResizeObserver<"u"&&(A=new ResizeObserver(()=>{T()}),A.observe(s.value)),document.addEventListener("click",C)})}),On(()=>{A&&A.disconnect(),document.removeEventListener("click",C)}),Ze(()=>o.tabs,()=>{qn(()=>{T()})},{deep:!0}),(E,N)=>(v(),g("div",{class:"tabs-container",ref_key:"containerRef",ref:s},[u.value?(v(),g("div",{key:1,class:"hamburger-container",ref_key:"hamburgerRef",ref:l},[r("div",fT,[r("button",{class:ue(["nav-arrow",{invisible:!y.value}]),onClick:b,type:"button","aria-label":"Previous tab",disabled:!y.value},"  ",10,pT),r("button",{class:"hamburger-button",onClick:D,type:"button","aria-label":"Tab menu"},[f.value?(v(),g("span",{key:0,class:"current-tab-icon",innerHTML:V(Sn)(f.value)},null,8,vT)):P("",!0),r("span",mT,w(p.value),1),N[0]||(N[0]=r("span",{class:"hamburger-chevron"},"",-1))]),r("button",{class:ue(["nav-arrow",{invisible:!_.value}]),onClick:S,type:"button","aria-label":"Next tab",disabled:!_.value},"  ",10,gT)]),d.value?(v(),g("div",yT,[(v(!0),g(xe,null,Be(e.tabs,$=>(v(),g("button",{key:$.value,class:ue(["menu-item",{active:e.modelValue===$.value}]),onClick:G=>I($.value),type:"button"},[$.icon?(v(),g("span",{key:0,class:"tab-icon",innerHTML:V(Sn)($.icon)},null,8,_T)):P("",!0),Ke(" "+w($.label),1)],10,kT))),128))])):P("",!0)],512)):(v(),g("div",{key:0,class:"tabs",ref_key:"tabsRef",ref:a},[(v(!0),g(xe,null,Be(e.tabs,$=>(v(),g("button",{key:$.value,class:ue(["tab-button",{active:e.modelValue===$.value}]),onClick:G=>E.$emit("update:modelValue",$.value),type:"button"},[$.icon?(v(),g("span",{key:0,class:"tab-icon",innerHTML:V(Sn)($.icon)},null,8,hT)):P("",!0),Ke(" "+w($.label),1)],10,dT))),128))],512))],512))}},Fa=ze(wT,[["__scopeId","data-v-736c5d0a"]]),CT={class:"tab-content"},LT={class:"form-group"},ST=["value"],xT={class:"form-group"},IT=["value"],$T={class:"form-group"},TT={class:"area-display"},MT={key:0,class:"no-area"},AT={class:"form-help"},ET={class:"form-group checkbox-group"},PT={class:"checkbox-label"},DT=["checked"],RT={class:"form-help"},OT={key:0,class:"custom-times-section"},BT={class:"form-group"},NT=["value"],FT={class:"form-help"},UT={class:"form-group"},zT=["value"],HT={class:"form-help"},VT={__name:"LocationDetailsTab",props:{form:{type:Object,required:!0},areas:{type:Array,default:()=>[]},eventDate:{type:String,default:""},areaTermSingular:{type:String,default:"Area"},areaTermPlural:{type:String,default:"Areas"},checkpointTermSingular:{type:String,default:"checkpoint"},peopleTermPlural:{type:String,default:"marshals"}},emits:["update:form","input","save"],setup(e,{emit:t}){const o=e,i=t,s=H(()=>(o.form.areaIds||o.form.AreaIds||[]).map(d=>o.areas.find(p=>p.id===d)).filter(d=>d!==void 0)),a=(u,d)=>{i("update:form",{...o.form,[u]:d}),i("input")},l=u=>{const d={...o.form,useCustomTimes:u};if(!u)d.startTime="",d.endTime="";else if(!d.startTime&&!d.endTime&&o.eventDate){const p=Tl(o.eventDate);d.startTime=p,d.endTime=p}i("update:form",d),i("input")};return(u,d)=>(v(),g("div",CT,[r("form",{onSubmit:d[5]||(d[5]=dt(p=>u.$emit("save"),["prevent"]))},[r("div",LT,[d[6]||(d[6]=r("label",null,"Name",-1)),r("input",{value:e.form.name,onInput:d[0]||(d[0]=p=>a("name",p.target.value)),type:"text",required:"",class:"form-input"},null,40,ST)]),r("div",xT,[d[7]||(d[7]=r("label",null,"Description (optional)",-1)),r("input",{value:e.form.description,onInput:d[1]||(d[1]=p=>a("description",p.target.value)),type:"text",class:"form-input"},null,40,IT)]),r("div",$T,[r("label",null,w(e.areaTermSingular)+" (auto-assigned by location)",1),r("div",TT,[s.value.length===0?(v(),g("span",MT," Not in any "+w(e.areaTermSingular.toLowerCase())+" polygon ",1)):P("",!0),(v(!0),g(xe,null,Be(s.value,p=>(v(),g("span",{key:p.id,class:"area-badge",style:ut({backgroundColor:p.color||"var(--brand-primary)"})},w(p.name),5))),128))]),r("small",AT,w(e.areaTermPlural)+" are automatically assigned based on "+w(e.checkpointTermSingular.toLowerCase())+" location within "+w(e.areaTermSingular.toLowerCase())+" boundaries ",1)]),r("div",ET,[r("label",PT,[r("input",{checked:e.form.useCustomTimes,onChange:d[2]||(d[2]=p=>l(p.target.checked)),type:"checkbox"},null,40,DT),r("span",null,"Use custom date/time for this "+w(e.checkpointTermSingular.toLowerCase()),1)]),r("small",RT," By default, "+w(e.peopleTermPlural.toLowerCase())+" are expected during the event date/time. Enable this to set a specific time range. ",1)]),e.form.useCustomTimes?(v(),g("div",OT,[r("div",BT,[d[8]||(d[8]=r("label",null,"Start date & time (optional)",-1)),r("input",{value:e.form.startTime,onInput:d[3]||(d[3]=p=>a("startTime",p.target.value)),type:"datetime-local",class:"form-input"},null,40,NT),r("small",FT," When "+w(e.peopleTermPlural.toLowerCase())+" should arrive at this "+w(e.checkpointTermSingular.toLowerCase()),1)]),r("div",UT,[d[9]||(d[9]=r("label",null,"End date & time (optional)",-1)),r("input",{value:e.form.endTime,onInput:d[4]||(d[4]=p=>a("endTime",p.target.value)),type:"datetime-local",class:"form-input"},null,40,zT),r("small",HT," When "+w(e.peopleTermPlural.toLowerCase())+" can leave this "+w(e.checkpointTermSingular.toLowerCase()),1)])])):P("",!0)],32)]))}},GT=ze(VT,[["__scopeId","data-v-aa628901"]]),jT={class:"scope-configuration-editor"},ZT={class:"editor-header"},qT={class:"scope-types-list"},WT=["onClick"],KT={class:"scope-type-label"},YT={class:"scope-type-pill"},JT={class:"expand-label"},XT={class:"expand-icon"},QT={class:"modal-content"},eM={class:"modal-header"},tM={class:"modal-body"},nM={class:"scope-help"},oM={key:0,class:"form-group"},sM={class:"checkbox-label special-option"},iM=["checked"],aM={key:0,class:"specific-selection"},lM=["placeholder"],rM={class:"checkbox-group scrollable"},cM=["checked","onChange"],uM={key:1,class:"form-group"},dM={class:"checkbox-label special-option"},hM=["checked"],fM={key:0,class:"specific-selection"},pM={class:"checkbox-group scrollable"},vM=["checked","onChange"],mM={key:2,class:"form-group"},gM={class:"checkbox-label special-option"},yM=["checked"],kM={key:0,class:"specific-selection"},_M=["placeholder"],bM={class:"checkbox-group scrollable"},wM={key:0,class:"checkbox-label this-checkpoint-option"},CM=["checked"],LM={class:"checkpoint-info"},SM={class:"checkpoint-name"},xM=["checked","onChange"],IM={class:"checkpoint-info"},$M={class:"checkpoint-name"},TM={key:0,class:"checkpoint-description"},MM={__name:"ScopeConfigurationEditor",props:{modelValue:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},excludeScopes:{type:Array,default:()=>[]},headerText:{type:String,default:""},intent:{type:String,default:"completion",validator:e=>["completion","location-update"].includes(e)},currentCheckpointId:{type:String,default:null}},emits:["update:modelValue","user-changed"],setup(e,{emit:t}){const{termsLower:o}=St(),i=e,s=t,a=H(()=>[{scope:"SpecificPeople",label:`Specific ${o.value.people}`},{scope:"EveryoneAtCheckpoints",label:`Every ${o.value.person} at specified ${o.value.checkpoints}`},{scope:"OnePerCheckpoint",label:`One ${o.value.person} at each specified ${o.value.checkpoint}`},{scope:"OnePerArea",label:`One ${o.value.person} in specified ${o.value.areas}`},{scope:"EveryoneInAreas",label:`Everyone in specified ${o.value.areas}`},{scope:"EveryAreaLead",label:`Every ${o.value.area} lead at specified ${o.value.areas}`},{scope:"OneLeadPerArea",label:`One lead per specified ${o.value.area}`}]),l=M({SpecificPeople:{enabled:!0,ids:["ALL_MARSHALS"]},EveryoneInAreas:{enabled:!1,ids:[]},EveryoneAtCheckpoints:{enabled:!1,ids:[]},OnePerCheckpoint:{enabled:!1,ids:[]},OnePerArea:{enabled:!1,ids:[]},EveryAreaLead:{enabled:!1,ids:[]},OneLeadPerArea:{enabled:!1,ids:[]}}),u=M(null),d=M(""),p=M(""),f=M(!i.isEditing);let m=!0,y=!1;const _=H(()=>a.value.filter(fe=>!i.excludeScopes.includes(fe.scope))),b=H(()=>f.value?_.value:_.value.filter(fe=>Z(fe.scope))),S=H(()=>_.value.filter(Ie=>Z(Ie.scope)).length<_.value.length),T=H(()=>{const fe=_.value.filter(Ie=>Z(Ie.scope)).length;return _.value.length-fe}),D=H(()=>!i.currentCheckpointId&&i.intent==="location-update");Ze(()=>i.modelValue,fe=>{if(fe){if(y){y=!1;return}m=!0,Object.keys(l.value).forEach(Ie=>{l.value[Ie]={enabled:!1,ids:[]}}),fe.forEach(Ie=>{Ie.scope==="Everyone"?l.value.SpecificPeople={enabled:!0,ids:["ALL_MARSHALS"]}:Ie.scope==="AreaLead"?l.value.EveryAreaLead={enabled:!0,ids:[...Ie.ids]}:l.value[Ie.scope]&&(l.value[Ie.scope]={enabled:!0,ids:[...Ie.ids]})}),m=!1}},{immediate:!0});const I=()=>{const fe=[];return Object.keys(l.value).forEach(Ie=>{const Te=l.value[Ie];if(Te.enabled){const W={scope:Ie,itemType:C(Ie),ids:[...Te.ids]};fe.push(W)}}),fe};Ze(l,()=>{if(m)return;if(Object.keys(l.value).some(Te=>Te!=="SpecificPeople"&&l.value[Te].enabled)&&l.value.SpecificPeople?.ids.includes("ALL_MARSHALS")){const Te=l.value.SpecificPeople.ids.indexOf("ALL_MARSHALS");l.value.SpecificPeople.ids.splice(Te,1),l.value.SpecificPeople.ids.length===0&&(l.value.SpecificPeople.enabled=!1)}y=!0;const Ie=I();s("update:modelValue",Ie),s("user-changed")},{deep:!0});const C=fe=>A(fe)?"Area":E(fe)?"Checkpoint":N(fe)?"Marshal":null,A=fe=>fe==="EveryoneInAreas"||fe==="OnePerArea"||fe==="EveryAreaLead"||fe==="OneLeadPerArea",E=fe=>fe==="EveryoneAtCheckpoints"||fe==="OnePerCheckpoint",N=fe=>fe==="SpecificPeople",$=fe=>{const Ie=a.value.find(Te=>Te.scope===fe);return Ie?Ie.label:fe},G=H(()=>i.headerText?i.headerText:i.intent==="location-update"?"Who can update this location?":"Who can see and complete this item?"),R=fe=>i.intent==="location-update"?{SpecificPeople:`Select "Everyone" or choose specific ${o.value.people} who can update the location`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} can update the location`,OnePerCheckpoint:`Any ${o.value.person} at each selected ${o.value.checkpoint} can update the location`,OnePerArea:`Any ${o.value.person} in each selected ${o.value.area} can update the location`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} can update the location`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} can update the location`,OneLeadPerArea:`Any ${o.value.area} lead at the selected ${o.value.areas} can update the location`}[fe]||"":{SpecificPeople:`Select "Everyone at the event" or choose specific ${o.value.people} who must complete this (personal completion)`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} must complete this (personal completion)`,OnePerCheckpoint:`One completion needed at each selected ${o.value.checkpoint} (shared completion)`,OnePerArea:`One completion needed in each selected ${o.value.area} (shared completion)`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} must complete this (personal completion)`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} must complete this individually (personal completion)`,OneLeadPerArea:`One completion per ${o.value.area}, only ${o.value.area} leads can complete (shared among leads)`}[fe]||"",Z=fe=>l.value[fe]?.enabled||!1,U=fe=>{const Ie=l.value[fe];if(!Ie||!Ie.enabled)return"No";const Te=Ie.ids||[];if(A(fe)){if(Te.includes("ALL_AREAS"))return`All ${o.value.areas}`;const W=Te.length;return W>0?`${W} ${W!==1?o.value.areas:o.value.area}`:`Select ${o.value.areas}...`}if(E(fe)){if(Te.includes("ALL_CHECKPOINTS"))return`All ${o.value.checkpoints}`;if(Te.length===1&&Te[0]==="THIS_CHECKPOINT")return`This ${o.value.checkpoint}`;const W=Te.length;return W>0?`${W} ${W!==1?o.value.checkpoints:o.value.checkpoint}`:`Select ${o.value.checkpoints}...`}if(N(fe)){if(Te.includes("ALL_MARSHALS"))return"Everyone";const W=Te.length;return W>0?`${W} ${W!==1?o.value.people:o.value.person}`:`Select ${o.value.people}...`}return"Configured"},K=fe=>{u.value=fe,d.value="",p.value=""},re=()=>{u.value=null},Pe=()=>{u.value&&(l.value[u.value]={enabled:!1,ids:[]}),re()},me=()=>u.value&&l.value[u.value]?.ids.includes("ALL_MARSHALS"),Ae=()=>{if(!u.value)return;const fe=l.value[u.value];me()?(fe.ids=[],fe.enabled=!1):(fe.ids=["ALL_MARSHALS"],fe.enabled=!0)},Fe=fe=>u.value&&l.value[u.value]?.ids.includes(fe),ae=fe=>{if(!u.value)return;const Ie=l.value[u.value],Te=Ie.ids.indexOf(fe);Te>=0?(Ie.ids.splice(Te,1),Ie.ids.length===0&&(Ie.enabled=!1)):(Ie.ids.push(fe),Ie.enabled=!0)},Me=H(()=>{if(!p.value)return i.marshals;const fe=p.value.toLowerCase();return i.marshals.filter(Ie=>Ie.name.toLowerCase().includes(fe)||Ie.email&&Ie.email.toLowerCase().includes(fe))}),ge=()=>u.value&&l.value[u.value]?.ids.includes("ALL_AREAS"),de=()=>{if(!u.value)return;const fe=l.value[u.value];ge()?(fe.ids=[],fe.enabled=!1):(fe.ids=["ALL_AREAS"],fe.enabled=!0)},Oe=fe=>u.value&&l.value[u.value]?.ids.includes(fe),Xe=fe=>{if(!u.value)return;const Ie=l.value[u.value],Te=Ie.ids.indexOf(fe);Te>=0?(Ie.ids.splice(Te,1),Ie.ids.length===0&&(Ie.enabled=!1)):(Ie.ids.push(fe),Ie.enabled=!0)},et=()=>u.value&&l.value[u.value]?.ids.includes("ALL_CHECKPOINTS"),qe=()=>{if(!u.value)return;const fe=l.value[u.value];et()?(fe.ids=[],fe.enabled=!1):(fe.ids=["ALL_CHECKPOINTS"],fe.enabled=!0)},tt=fe=>u.value&&l.value[u.value]?.ids.includes(fe),be=fe=>{if(!u.value)return;const Ie=l.value[u.value],Te=Ie.ids.indexOf(fe);Te>=0?(Ie.ids.splice(Te,1),Ie.ids.length===0&&(Ie.enabled=!1)):(Ie.ids.push(fe),Ie.enabled=!0)},He=H(()=>{let fe=i.locations;if(d.value){const Ie=d.value.toLowerCase();fe=fe.filter(Te=>Te.name.toLowerCase().includes(Ie)||Te.description&&Te.description.toLowerCase().includes(Ie))}return[...fe].sort((Ie,Te)=>js(Ie.name,Te.name))});return(fe,Ie)=>(v(),g("div",jT,[r("div",ZT,[r("h4",null,w(G.value),1)]),r("div",qT,[(v(!0),g(xe,null,Be(b.value,Te=>(v(),g("div",{key:Te.scope,class:ue(["scope-type-row",{active:Z(Te.scope)}]),onClick:W=>K(Te.scope)},[r("div",KT,w(Te.label),1),r("div",YT,w(U(Te.scope)),1)],10,WT))),128)),S.value?(v(),g("div",{key:0,class:"expand-row",onClick:Ie[0]||(Ie[0]=Te=>f.value=!f.value)},[r("div",JT,w(f.value?"Show less":`Show ${T.value} more option${T.value!==1?"s":""}...`),1),r("div",XT,w(f.value?"":""),1)])):P("",!0)]),u.value?(v(),g("div",{key:0,class:"scope-config-modal",onClick:dt(re,["self"])},[r("div",QT,[r("div",eM,[r("h5",null,w($(u.value)),1),r("button",{onClick:re,class:"btn-close",type:"button"},"")]),r("div",tM,[r("p",nM,w(R(u.value)),1),N(u.value)?(v(),g("div",oM,[r("label",sM,[r("input",{type:"checkbox",checked:me(),onChange:Ae},null,40,iM),r("span",null,[Ie[4]||(Ie[4]=r("strong",null,"Everyone at the event",-1)),Ke(" (all current and future "+w(V(o).people)+")",1)])]),me()?P("",!0):(v(),g("div",aM,[Ve(r("input",{"onUpdate:modelValue":Ie[1]||(Ie[1]=Te=>p.value=Te),type:"text",placeholder:`Search ${V(o).people}...`,class:"search-input"},null,8,lM),[[nt,p.value]]),r("div",rM,[(v(!0),g(xe,null,Be(Me.value,Te=>(v(),g("label",{key:Te.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:Fe(Te.id),onChange:W=>ae(Te.id)},null,40,cM),r("span",null,w(Te.name),1)]))),128))])]))])):P("",!0),A(u.value)?(v(),g("div",uM,[r("label",dM,[r("input",{type:"checkbox",checked:ge(),onChange:de},null,40,hM),r("span",null,[r("strong",null,"All "+w(V(o).areas),1),Ke(" (includes future "+w(V(o).areas)+")",1)])]),ge()?P("",!0):(v(),g("div",fM,[r("div",pM,[(v(!0),g(xe,null,Be(e.areas,Te=>(v(),g("label",{key:Te.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:Oe(Te.id),onChange:W=>Xe(Te.id)},null,40,vM),r("span",{class:"area-color-dot",style:ut({backgroundColor:Te.color||"#667eea"})},null,4),r("span",null,w(Te.name),1)]))),128))])]))])):P("",!0),E(u.value)?(v(),g("div",mM,[r("label",gM,[r("input",{type:"checkbox",checked:et(),onChange:qe},null,40,yM),r("span",null,[r("strong",null,"All "+w(V(o).checkpoints),1),Ke(" (includes future "+w(V(o).checkpoints)+")",1)])]),et()?P("",!0):(v(),g("div",kM,[Ve(r("input",{"onUpdate:modelValue":Ie[2]||(Ie[2]=Te=>d.value=Te),type:"text",placeholder:`Search ${V(o).checkpoints}...`,class:"search-input"},null,8,_M),[[nt,d.value]]),r("div",bM,[D.value?(v(),g("label",wM,[r("input",{type:"checkbox",checked:tt("THIS_CHECKPOINT"),onChange:Ie[3]||(Ie[3]=Te=>be("THIS_CHECKPOINT"))},null,40,CM),r("div",LM,[r("span",SM,[r("strong",null,"This "+w(V(o).checkpoint),1)])])])):P("",!0),(v(!0),g(xe,null,Be(He.value,Te=>(v(),g("label",{key:Te.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:tt(Te.id),onChange:W=>be(Te.id)},null,40,xM),r("div",IM,[r("span",$M,w(Te.name),1),Te.description?(v(),g("span",TM," - "+w(Te.description),1)):P("",!0)])]))),128))])]))])):P("",!0)]),r("div",{class:"modal-footer"},[r("button",{onClick:Pe,class:"btn btn-secondary",type:"button"},"Deselect all"),r("button",{onClick:re,class:"btn btn-primary",type:"button"},"Done")])])])):P("",!0)]))}},nc=ze(MM,[["__scopeId","data-v-ad360dec"]]),AM={class:"tab-content"},EM={class:"form-group"},PM=["value"],DM={key:0,class:"form-error"},RM={class:"form-row"},OM={class:"form-group"},BM=["disabled"],NM={class:"form-group"},FM=["disabled"],UM={class:"form-group"},zM={class:"accordion-item"},HM={class:"accordion-preview"},VM={class:"accordion-arrow"},GM={key:0,class:"accordion-content"},jM={class:"section-description"},ZM={class:"dynamic-checkbox"},qM=["checked"],WM={key:0,class:"dynamic-settings"},KM={__name:"LocationCoordinatesTab",props:{form:{type:Object,required:!0},isMoving:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:"Checkpoint"},peopleTermPlural:{type:String,default:"Marshals"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:form","input","save","move-location"],setup(e,{emit:t}){const o=e,i=t,s=M(!1),a=M(""),l=M(""),u=_=>_==null||_===""||isNaN(_)?"":Number(_).toFixed(6);Ze(()=>o.form.longitude,_=>{a.value=u(_)},{immediate:!0}),Ze(()=>o.form.latitude,_=>{l.value=u(_)},{immediate:!0});const d=_=>{const b=_==="longitude"?a:l,S=parseFloat(b.value);isNaN(S)?b.value.trim()===""&&(i("update:form",{...o.form,[_]:0}),i("input"),b.value=u(0)):(i("update:form",{...o.form,[_]:S}),i("input"),b.value=u(S))},p=(_,b)=>{i("update:form",{...o.form,[_]:b}),i("input")},f=_=>{if(_){const b=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],S=o.form.locationUpdateScopeConfigurations||[],T=S.length>0?S:b;i("update:form",{...o.form,isDynamic:!0,latitude:0,longitude:0,locationUpdateScopeConfigurations:T})}else i("update:form",{...o.form,isDynamic:!1});i("input")},m=_=>{i("update:form",{...o.form,locationUpdateScopeConfigurations:_}),i("input")},y=_=>{if(!_)return!0;const b=_.includes(".")?_.split("."):_.split("/");if(b.length!==3)return!1;const S=/^[a-z]{1,20}$/;return b.every(T=>S.test(T))};return(_,b)=>(v(),g("div",AM,[r("form",{onSubmit:b[6]||(b[6]=dt(S=>_.$emit("save"),["prevent"]))},[r("div",EM,[b[10]||(b[10]=r("label",null,"What3Words (optional)",-1)),r("input",{value:e.form.what3Words,onInput:b[0]||(b[0]=S=>p("what3Words",S.target.value)),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap"},null,40,PM),e.form.what3Words&&!y(e.form.what3Words)?(v(),g("small",DM," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):P("",!0)]),e.form.isDynamic?P("",!0):(v(),g(xe,{key:0},[r("div",RM,[r("div",OM,[b[11]||(b[11]=r("label",null,"Longitude",-1)),Ve(r("input",{"onUpdate:modelValue":b[1]||(b[1]=S=>a.value=S),onBlur:b[2]||(b[2]=S=>d("longitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., -0.091234"},null,40,BM),[[nt,a.value]])]),r("div",NM,[b[12]||(b[12]=r("label",null,"Latitude",-1)),Ve(r("input",{"onUpdate:modelValue":b[3]||(b[3]=S=>l.value=S),onBlur:b[4]||(b[4]=S=>d("latitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., 51.505123"},null,40,FM),[[nt,l.value]])])]),r("div",UM,[r("button",{type:"button",onClick:b[5]||(b[5]=S=>_.$emit("move-location")),class:ue(["btn btn-secondary btn-with-icon",{"btn-primary":e.isMoving}])},[b[13]||(b[13]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),Ke(" "+w(e.isMoving?"Click on map to set new location...":`Move ${e.checkpointTermSingular.toLowerCase()}...`),1)],2)])],64))],32),r("div",zM,[r("button",{type:"button",class:ue(["accordion-header",{expanded:s.value}]),onClick:b[7]||(b[7]=S=>s.value=!s.value)},[b[14]||(b[14]=br('<div class="accordion-icon" data-v-c3ce308d><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-c3ce308d><path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="#F59E0B" opacity="0.3" data-v-c3ce308d></path><path d="M12 6L13.5 9L17 9.5L14.5 12L15 15.5L12 14L9 15.5L9.5 12L7 9.5L10.5 9L12 6Z" fill="#F59E0B" data-v-c3ce308d></path><circle cx="12" cy="11" r="2" fill="white" data-v-c3ce308d></circle></svg></div><span class="accordion-title" data-v-c3ce308d>Dynamic location</span>',2)),r("span",HM,w(e.form.isDynamic?"Enabled":"Disabled"),1),r("span",VM,w(s.value?"":""),1)],2),s.value?(v(),g("div",GM,[r("p",jM," Enable this for lead cars, sweep vehicles, or other moving "+w(e.checkpointTermSingular.toLowerCase())+"s whose location can be updated by designated "+w(e.peopleTermPlural.toLowerCase())+" during the event. ",1),r("label",ZM,[r("input",{type:"checkbox",checked:e.form.isDynamic,onChange:b[8]||(b[8]=S=>f(S.target.checked))},null,40,qM),r("span",null,"This "+w(e.checkpointTermSingular.toLowerCase())+" can move",1)]),e.form.isDynamic?(v(),g("div",WM,[Ee(nc,{"model-value":e.form.locationUpdateScopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":e.isEditing,"header-text":`Who can update this ${e.checkpointTermSingular.toLowerCase()}'s location?`,"exclude-scopes":["OnePerCheckpoint","OneLeadPerArea","OnePerArea"],intent:"location-update","current-checkpoint-id":e.form.id,"onUpdate:modelValue":m,onUserChanged:b[9]||(b[9]=S=>_.$emit("input"))},null,8,["model-value","areas","locations","marshals","is-editing","header-text","current-checkpoint-id"])])):P("",!0)])):P("",!0)])]))}},YM=ze(KM,[["__scopeId","data-v-c3ce308d"]]);function Iv(e){const t=M(new Map),o=f=>t.value.has(f.id)?t.value.get(f.id):f.isCheckedIn;return{pendingCheckInChanges:t,getEffectiveCheckInStatus:o,handleToggleCheckIn:f=>{const y=!o(f);y===f.isCheckedIn?t.value.delete(f.id):t.value.set(f.id,y),e&&e()},getStatusIcon:f=>o(f)?"":"",getStatusColor:f=>o(f)?"#28a745":"#dc3545",getStatusText:f=>o(f)?"Checked in":"Not checked in",formatTime:f=>f?new Date(f).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",clearPendingChanges:()=>{t.value.clear()},getPendingChanges:()=>Array.from(t.value.entries()).map(([f,m])=>({assignmentId:f,shouldBeCheckedIn:m}))}}const JM={class:"card-main"},XM={class:"card-title"},QM={class:"marshal-name"},eA={key:0,class:"card-check-in"},tA={class:"toggle-icon"},nA={class:"toggle-label"},oA={key:0,class:"check-in-time"},sA={key:0,class:"check-in-method"},iA={key:1,class:"unsaved-indicator"},aA={key:1,class:"card-status-readonly"},lA={class:"status-icon"},rA={key:0,class:"check-in-time"},cA={key:0,class:"check-in-method"},uA={key:2,class:"card-badge"},dA={key:3,class:"card-badge"},hA={__name:"MarshalAssignmentCard",props:{assignment:{type:Object,required:!0},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},location:{type:Object,default:null}},emits:["click","toggle-check-in","remove","undo-remove"],setup(e,{emit:t}){const o=e,i=t,s=m=>m?new Date(m).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",a=H(()=>{const{checkedInBy:m,checkInMethod:y,marshalName:_}=o.assignment;return m&&m!==_?m:y||""}),l=H(()=>!o.assignment.isPending&&!o.isMarkedForRemoval&&!o.readOnly),u=H(()=>{const{checkInLatitude:m,checkInLongitude:y}=o.assignment,_=o.location;return!m||!y||!_?.latitude||!_?.longitude?null:R0(m,y,_.latitude,_.longitude)}),d=H(()=>u.value===null?null:O0(u.value)),p=H(()=>u.value===null?"":u.value<=50?"distance-close":u.value<=100?"distance-medium":"distance-far"),f=()=>{l.value&&i("click",o.assignment)};return(m,y)=>(v(),g("div",{class:ue(["marshal-assignment-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-clickable":l.value}]),onClick:f},[r("div",JM,[r("div",XM,[r("span",QM,w(e.assignment.marshalName),1)]),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.readOnly?(v(),g("div",eA,[r("button",{class:ue(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:y[0]||(y[0]=dt(_=>m.$emit("toggle-check-in",e.assignment),["stop"]))},[r("span",tA,w(e.effectiveCheckInStatus?"":""),1),r("span",nA,w(e.effectiveCheckInStatus?"Checked in":"Check in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(v(),g("span",oA,[Ke(w(s(e.assignment.checkInTime))+" ",1),a.value?(v(),g("span",sA,"("+w(a.value)+")",1)):P("",!0),d.value?(v(),g("span",{key:1,class:ue(["check-in-distance",p.value])},w(d.value),3)):P("",!0)])):e.hasUnsavedChanges?(v(),g("span",iA," Unsaved ")):P("",!0)])):P("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&e.readOnly?(v(),g("div",aA,[r("span",{class:ue(["status-badge",e.effectiveCheckInStatus?"status-checked-in":"status-not-checked-in"])},[r("span",lA,w(e.effectiveCheckInStatus?"":""),1),Ke(" "+w(e.effectiveCheckInStatus?"Checked in":"Not checked in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime?(v(),g("span",rA,[Ke(w(s(e.assignment.checkInTime))+" ",1),a.value?(v(),g("span",cA,"("+w(a.value)+")",1)):P("",!0),d.value?(v(),g("span",{key:1,class:ue(["check-in-distance",p.value])},w(d.value),3)):P("",!0)])):P("",!0)])):P("",!0),e.assignment.isPending?(v(),g("div",uA,[...y[3]||(y[3]=[r("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):P("",!0),e.isMarkedForRemoval?(v(),g("div",dA,[...y[4]||(y[4]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):P("",!0)]),!e.readOnly&&!e.isMarkedForRemoval?(v(),g("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:y[1]||(y[1]=dt(_=>m.$emit("remove",e.assignment),["stop"]))},"  ")):P("",!0),e.isMarkedForRemoval?(v(),g("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:y[2]||(y[2]=dt(_=>m.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):P("",!0)],2))}},fA=ze(hA,[["__scopeId","data-v-6e808532"]]),pA={class:"tab-content"},vA={key:0,class:"read-only-notice"},mA={key:1,class:"form-group"},gA=["value"],yA={class:"section-title"},kA={key:2,class:"assign-section"},_A={__name:"LocationAssignmentsTab",props:{form:{type:Object,required:!0},assignments:{type:Array,default:()=>[]},peopleTerm:{type:String,default:"Marshals"},personTerm:{type:String,default:"Marshal"},checkpointTerm:{type:String,default:"Checkpoint"},readOnly:{type:Boolean,default:!1}},emits:["update:form","input","remove-assignment","open-assign-modal","select-marshal"],setup(e,{expose:t,emit:o}){const i=e,s=H(()=>i.peopleTerm.toLowerCase()),a=H(()=>i.personTerm.toLowerCase()),l=H(()=>i.checkpointTerm.toLowerCase()),u=o,{pendingCheckInChanges:d,getEffectiveCheckInStatus:p,handleToggleCheckIn:f}=Iv(()=>u("input")),m=M(new Set),y=H(()=>i.assignments?.length||0),_=H(()=>i.assignments?[...i.assignments].sort((A,E)=>(A.marshalName||"").localeCompare(E.marshalName||"",void 0,{sensitivity:"base"})):[]),b=A=>m.value.has(A),S=A=>{A.isPending||u("select-marshal",A)},T=A=>{f(A)},D=A=>{A.isPending?u("remove-assignment",A):(m.value.add(A.id),u("input"))},I=A=>{m.value.delete(A.id),u("input")},C=(A,E)=>{u("update:form",{...i.form,[A]:Number(E)}),u("input")};return t({pendingCheckInChanges:d,clearPendingChanges:()=>{d.value.clear(),m.value.clear()},getPendingChanges:()=>Array.from(d.value.entries()).map(([A,E])=>({assignmentId:A,shouldBeCheckedIn:E})),getMarkedForRemoval:()=>Array.from(m.value)}),(A,E)=>(v(),g("div",pA,[e.readOnly?(v(),g("div",vA," Viewing from "+w(a.value)+" - "+w(s.value)+" cannot be modified here. ",1)):P("",!0),e.readOnly?P("",!0):(v(),g("div",mA,[r("label",null,"Required "+w(s.value),1),r("input",{value:e.form.requiredMarshals,onInput:E[0]||(E[0]=N=>C("requiredMarshals",N.target.value)),type:"number",min:"1",required:"",class:"form-input"},null,40,gA)])),r("h3",yA,"Assigned "+w(s.value)+" ("+w(y.value)+")",1),Ee(Nl,{"is-empty":e.assignments.length===0,"empty-message":`No ${s.value} assigned yet.`,"empty-hint":`Use the button below to assign ${s.value} to this ${l.value}.`},{default:Ue(()=>[(v(!0),g(xe,null,Be(_.value,N=>(v(),je(fA,{key:N.id,assignment:N,"effective-check-in-status":V(p)(N),"has-unsaved-changes":V(d).has(N.id),"is-marked-for-removal":b(N.id),"read-only":e.readOnly,location:e.form,onClick:S,onToggleCheckIn:T,onRemove:D,onUndoRemove:I},null,8,["assignment","effective-check-in-status","has-unsaved-changes","is-marked-for-removal","read-only","location"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),e.readOnly?P("",!0):(v(),g("div",kA,[r("button",{type:"button",class:"btn btn-primary assign-btn",onClick:E[1]||(E[1]=N=>A.$emit("open-assign-modal"))}," + Assign "+w(a.value)+"... ",1)]))]))}},bA=ze(_A,[["__scopeId","data-v-ac0629d4"]]),wA={class:"grouped-tasks-list"},CA={key:0,class:"empty-state"},LA={key:1,class:"task-groups"},SA=["onClick"],xA={class:"task-header-content"},IA={class:"task-checkbox-area"},$A={class:"task-info"},TA={class:"task-name"},MA={class:"task-summary"},AA={key:0,class:"modified-badge"},EA={class:"task-scope"},PA=["title"],DA={class:"expand-arrow"},RA={key:0,class:"task-group-details"},OA={class:"detail-checkbox"},BA=["checked","disabled","onChange"],NA={class:"detail-content"},FA={class:"detail-context"},UA={key:0,class:"detail-completion"},zA={key:0,class:"pending-text"},HA={class:"completion-text"},VA={class:"completion-time"},GA={key:1,class:"detail-uncomplete"},jA={key:2,class:"detail-disabled"},ZA={__name:"GroupedTasksList",props:{items:{type:Array,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["toggle-complete"],setup(e,{emit:t}){const{terms:o,termsLower:i}=St(),s=e,a=M(new Set),l=H(()=>{const b=new Map;for(const S of s.items){b.has(S.itemId)||b.set(S.itemId,{itemId:S.itemId,text:S.text,items:[],totalCount:0,completedCount:0,allCompleted:!1,hasModified:!1});const T=b.get(S.itemId);T.items.push(S),T.totalCount++,S.localIsCompleted&&T.completedCount++,S.isModified&&(T.hasModified=!0)}for(const S of b.values())S.allCompleted=S.completedCount===S.totalCount,S.items.sort((T,D)=>{const I=y(T),C=y(D);return I.localeCompare(C,void 0,{numeric:!0,sensitivity:"base"})});return Array.from(b.values()).sort((S,T)=>S.text.localeCompare(T.text,void 0,{sensitivity:"base"}))}),u=b=>{a.value.has(b)?a.value.delete(b):a.value.add(b),a.value=new Set(a.value)},d=b=>b.hasModified?"status-modified":b.allCompleted?"status-completed":b.completedCount>0?"status-partial":"status-pending",p=b=>b.allCompleted?"":b.completedCount>0?"":"",f=b=>({Everyone:"Everyone",SpecificPeople:"Assigned individually",EveryoneInAreas:`Per ${i.value.area}`,EveryoneAtCheckpoints:`Per ${i.value.checkpoint}`,OnePerCheckpoint:`One per ${i.value.checkpoint}`,OnePerArea:`One per ${i.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${i.value.area}`})[b.matchedScope]||b.matchedScope,m=b=>({Everyone:"This task is for everyone at the event",SpecificPeople:"This task is specifically assigned to certain people",EveryoneInAreas:`This task is for everyone in certain ${i.value.areas}`,EveryoneAtCheckpoints:`This task is for everyone at certain ${i.value.checkpoints}`,OnePerCheckpoint:`One person at the ${i.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${i.value.area} needs to complete this`,EveryAreaLead:`This task is for ${i.value.area} leads only`,OneLeadPerArea:`One ${i.value.area} lead needs to complete this`})[b.matchedScope]||"",y=b=>{if(!b.completionContextType||!b.completionContextId)return"Everyone";if(b.completionContextType==="Checkpoint"){const S=s.locations.find(T=>T.id===b.completionContextId);return S?S.description?`${S.name} - ${S.description}`:S.name:`${o.value.checkpoint} (unknown)`}if(b.completionContextType==="Area"){const S=s.areas.find(T=>T.id===b.completionContextId);return S?S.name:`${o.value.area} (unknown)`}if(b.completionContextType==="Personal"){if(b.contextOwnerName)return b.contextOwnerName;if(b.completionContextId&&s.marshals.length>0){const S=s.marshals.find(T=>T.id===b.completionContextId||T.marshalId===b.completionContextId);if(S)return S.name||S.marshalName}return"Assigned individually"}return b.completionContextType},_=b=>b?new Date(b).toLocaleString():"";return(b,S)=>(v(),g("div",wA,[l.value.length===0?(v(),g("div",CA,[...S[0]||(S[0]=[r("p",null,"No tasks available.",-1)])])):(v(),g("div",LA,[(v(!0),g(xe,null,Be(l.value,T=>(v(),g("div",{key:T.itemId,class:ue(["task-group",{"all-completed":T.allCompleted,"has-modified":T.hasModified}])},[r("button",{type:"button",class:"task-group-header",onClick:D=>u(T.itemId)},[r("div",xA,[r("div",IA,[r("span",{class:ue(["task-status-icon",d(T)])},w(p(T)),3)]),r("div",$A,[r("div",TA,w(T.text),1),r("div",MA,[r("span",{class:ue(["completion-count",{"all-done":T.allCompleted}])},w(T.completedCount)+"/"+w(T.totalCount)+" completed ",3),T.hasModified?(v(),g("span",AA," Modified ")):P("",!0)])]),r("div",EA,[r("span",{class:"scope-pill",title:m(T.items[0])},w(f(T.items[0])),9,PA)])]),r("span",DA,w(a.value.has(T.itemId)?"":""),1)],8,SA),a.value.has(T.itemId)?(v(),g("div",RA,[(v(!0),g(xe,null,Be(T.items,D=>(v(),g("div",{key:`${D.itemId}-${D.completionContextId}`,class:ue(["task-detail-item",{"item-completed":D.localIsCompleted,"item-modified":D.isModified}])},[r("div",OA,[r("input",{type:"checkbox",checked:D.localIsCompleted,disabled:!D.canBeCompletedByMe&&!D.localIsCompleted,onChange:I=>b.$emit("toggle-complete",D)},null,40,BA)]),r("div",NA,[r("div",FA,w(y(D)),1),D.localIsCompleted?(v(),g("div",UA,[D.isModified&&!D.isCompleted?(v(),g("span",zA," Will be marked as completed ")):(v(),g(xe,{key:1},[r("span",HA,w(D.completedByActorName||"Unknown"),1),r("span",VA,w(_(D.completedAt)),1)],64))])):D.isModified&&D.isCompleted?(v(),g("div",GA,[...S[1]||(S[1]=[r("span",{class:"pending-text"},"Will be marked as incomplete",-1)])])):D.canBeCompletedByMe?P("",!0):(v(),g("div",jA," Already completed by someone else "))])],2))),128))])):P("",!0)],2))),128))]))]))}},Zu=ze(ZA,[["__scopeId","data-v-409a65e7"]]),qA={class:"checkpoint-checklist-view"},WA={key:0,class:"loading-state"},KA={key:1,class:"error-state"},YA={key:2,class:"empty-state"},JA={key:3,class:"empty-state"},XA={__name:"CheckpointChecklistView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{termsLower:i}=St(),s=e,a=o,l=M([]),u=M(!1),d=M(null),p=M(new Map),f=H(()=>s.assignments.length===0),m=H(()=>l.value.map(T=>{const D=p.value.get(`${T.itemId}|||${T.completionContextId}`),I=D!==void 0?D.complete:T.isCompleted,C=D!==void 0&&D.complete!==T.isCompleted;return{...T,localIsCompleted:I,isModified:C}})),y=async()=>{if(!(!s.eventId||!s.locationId&&!s.areaId)){u.value=!0,d.value=null;try{const T=s.locationId?await Rt.getCheckpointChecklist(s.eventId,s.locationId):await Rt.getAreaChecklist(s.eventId,s.areaId);if(l.value=T.data||[],s.modelValue&&s.modelValue.length>0){const D=new Map;s.modelValue.forEach(I=>{D.set(`${I.itemId}|||${I.contextId}`,{complete:I.complete,contextType:I.contextType,contextId:I.contextId})}),p.value=D}}catch(T){console.error("Failed to load checklist:",T),d.value=T.response?.data?.message||"Failed to load checklist"}finally{u.value=!1}}},_=T=>{const D=T.contextOwnerMarshalId||(s.assignments.length>0?s.assignments[0].marshalId:null);if(!D)return;const I=`${T.itemId}|||${T.completionContextId}`,C=p.value.get(I),A=C!==void 0?C.complete:T.isCompleted;p.value.set(I,{complete:!A,contextType:T.completionContextType,contextId:T.completionContextId,marshalId:D}),b()},b=()=>{const T=[];for(const[D,I]of p.value.entries()){const[C,A]=D.split("|||"),E=l.value.find(N=>N.itemId===C&&N.completionContextId===A);E&&I.complete!==E.isCompleted&&T.push({itemId:C,complete:I.complete,contextType:I.contextType,contextId:I.contextId,marshalId:I.marshalId})}a("update:modelValue",T),a("change",T)};return t({resetLocalState:()=>{if(p.value=new Map,s.modelValue&&s.modelValue.length>0){const T=new Map;s.modelValue.forEach(D=>{T.set(`${D.itemId}|||${D.contextId}`,{complete:D.complete,contextType:D.contextType,contextId:D.contextId,marshalId:D.marshalId})}),p.value=T}},loadChecklist:y}),Ze(()=>[s.eventId,s.locationId,s.areaId],()=>{y()},{immediate:!0}),(T,D)=>(v(),g("div",qA,[u.value?(v(),g("div",WA," Loading checklist... ")):d.value?(v(),g("div",KA,[r("p",null,w(d.value),1),r("button",{onClick:y,class:"btn btn-secondary btn-small"}," Retry ")])):f.value?(v(),g("div",YA,[...D[0]||(D[0]=[r("p",null,"No marshals assigned to this checkpoint yet.",-1),r("p",{class:"help-text"},"Assign marshals to enable checklist completion.",-1)])])):l.value.length===0?(v(),g("div",JA,[r("p",null,"No checklist items for this "+w(V(i).checkpoint)+".",1)])):(v(),je(Zu,{key:4,items:m.value,locations:e.locations,areas:e.areas,onToggleComplete:_},null,8,["items","locations","areas"]))]))}},$v=ze(XA,[["__scopeId","data-v-9206ecb2"]]),QA={class:"notes-view"},eE={key:0,class:"loading-state"},tE={key:1,class:"error-state"},nE={key:2,class:"empty-state"},oE={key:3,class:"notes-list"},sE={class:"note-header"},iE={class:"note-title-row"},aE={key:0,class:"pin-icon",title:"Pinned"},lE={class:"note-title"},rE={class:"note-meta"},cE={key:0,class:"category-badge"},uE={key:0,class:"note-content"},dE={class:"note-footer"},hE={class:"created-info"},fE={key:0,class:"scope-info"},pE={__name:"NotesView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},marshalId:{type:String,default:null},allNotes:{type:Array,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},showScope:{type:Boolean,default:!0}},setup(e,{expose:t}){const o=e,i=M([]),s=M(!1),a=M(null),l=H(()=>o.marshalId?"No notes for this marshal.":o.areaId?"No notes for this area.":o.locationId?"No notes for this checkpoint.":"No notes available."),u=H(()=>o.areaId?o.locations.filter(D=>D.areaIds&&D.areaIds.includes(o.areaId)):[]),d=H(()=>u.value.map(D=>D.id)),p=H(()=>{if(!o.areaId)return[];const D=new Set;return o.assignments.filter(I=>d.value.includes(I.locationId)).forEach(I=>D.add(I.marshalId)),Array.from(D)}),f=D=>o.assignments.filter(I=>I.marshalId===D).map(I=>I.locationId),m=D=>{const I=f(D),C=new Set;for(const A of I){const E=o.locations.find(N=>N.id===A);E?.areaIds&&E.areaIds.forEach(N=>C.add(N))}return Array.from(C)},y=(D,I)=>{if(!D.scopeConfigurations)return null;for(const C of D.scopeConfigurations){if(C.itemType==="Area"){if(I.type==="area"&&(C.ids.includes(I.areaId)||C.ids.includes("ALL_AREAS")))return{matched:!0,scope:C.scope==="EveryAreaLead"?"Area leads":"Area"};if(I.type==="checkpoint"){const E=o.locations.find(N=>N.id===I.locationId)?.areaIds||[];if(C.ids.includes("ALL_AREAS")||E.some(N=>C.ids.includes(N)))return{matched:!0,scope:C.scope==="EveryAreaLead"?"Area leads":"Area"}}}if(C.itemType==="Checkpoint"){if(I.type==="checkpoint"&&(C.ids.includes(I.locationId)||C.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint"};if(I.type==="area"&&I.checkpointIds.some(E=>C.ids.includes(E)||C.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint in area"}}if(C.itemType==="Marshal"){if(I.type==="marshal"&&(C.ids.includes(I.marshalId)||C.ids.includes("ALL_MARSHALS")))return{matched:!0,scope:"Marshal"};if(I.type==="checkpoint"){const A=o.assignments.filter(N=>N.locationId===I.locationId).map(N=>N.marshalId);if(C.ids.includes("ALL_MARSHALS")||A.some(N=>C.ids.includes(N)))return{matched:!0,scope:"Marshal at checkpoint"}}if(I.type==="area"&&(C.ids.includes("ALL_MARSHALS")||I.marshalIds.some(E=>C.ids.includes(E))))return{matched:!0,scope:"Marshal in area"}}if(I.type==="marshal"&&I.checkpointIds&&I.areaIds){if(C.itemType==="Checkpoint"&&(C.ids.includes("ALL_CHECKPOINTS")||I.checkpointIds.some(E=>C.ids.includes(E))))return{matched:!0,scope:"Assigned checkpoint"};if(C.itemType==="Area"&&(C.ids.includes("ALL_AREAS")||I.areaIds.some(E=>C.ids.includes(E))))return{matched:!0,scope:C.scope==="EveryAreaLead"?"Area lead":"Area"}}}return null},_=H(()=>{const D=o.allNotes||i.value;if(!D||D.length===0)return[];if(o.areaId&&o.allNotes){const I={type:"area",areaId:o.areaId,checkpointIds:d.value,marshalIds:p.value},C=[],A=new Set;for(const E of D){if(A.has(E.noteId))continue;const N=y(E,I);N&&(A.add(E.noteId),C.push({...E,matchedScope:N.scope}))}return C}if(o.locationId&&o.allNotes){const I={type:"checkpoint",locationId:o.locationId},C=[],A=new Set;for(const E of D){if(A.has(E.noteId))continue;const N=y(E,I);N&&(A.add(E.noteId),C.push({...E,matchedScope:N.scope}))}return C}if(o.marshalId&&o.allNotes){const I=f(o.marshalId),C=m(o.marshalId),A={type:"marshal",marshalId:o.marshalId,checkpointIds:I,areaIds:C},E=[],N=new Set;for(const $ of D){if(N.has($.noteId))continue;const G=y($,A);G&&(N.add($.noteId),E.push({...$,matchedScope:G.scope}))}return E}return D}),b=H(()=>{const D={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return[..._.value].sort((I,C)=>{if(I.isPinned!==C.isPinned)return I.isPinned?-1:1;const A=D[I.priority]??2,E=D[C.priority]??2;return A!==E?A-E:I.displayOrder!==C.displayOrder?I.displayOrder-C.displayOrder:new Date(C.createdAt)-new Date(I.createdAt)})}),S=async()=>{if(o.allNotes===null&&o.eventId){s.value=!0,a.value=null;try{let D;o.marshalId?D=await Ps.getMarshalNotes(o.eventId,o.marshalId):D=await Ps.getByEvent(o.eventId),i.value=D.data||[]}catch(D){console.error("Failed to load notes:",D),a.value=D.response?.data?.message||"Failed to load notes"}finally{s.value=!1}}};Ze(()=>[o.eventId,o.locationId,o.areaId,o.marshalId],()=>{o.allNotes===null&&S()},{immediate:!0});const T=D=>{if(!D)return"";const I=new Date(D),A=new Date-I,E=Math.floor(A/6e4),N=Math.floor(A/36e5),$=Math.floor(A/864e5);return E<1?"just now":E<60?`${E}m ago`:N<24?`${N}h ago`:$<7?`${$}d ago`:I.toLocaleDateString()};return t({loadNotes:S}),(D,I)=>(v(),g("div",QA,[s.value?(v(),g("div",eE," Loading notes... ")):a.value?(v(),g("div",tE,[r("p",null,w(a.value),1),r("button",{onClick:S,class:"btn btn-secondary btn-small"}," Retry ")])):_.value.length===0?(v(),g("div",nE,[r("p",null,w(l.value),1)])):(v(),g("div",oE,[(v(!0),g(xe,null,Be(b.value,C=>(v(),g("div",{key:C.noteId,class:ue(["note-item",{pinned:C.isPinned}])},[r("div",sE,[r("div",iE,[C.isPinned?(v(),g("span",aE,"")):P("",!0),r("span",{class:ue(["priority-indicator",(C.priority||"Normal").toLowerCase()])},null,2),r("strong",lE,w(C.title),1)]),r("div",rE,[C.category?(v(),g("span",cE,w(C.category),1)):P("",!0),r("span",{class:ue(["priority-badge",(C.priority||"Normal").toLowerCase()])},w(C.priority||"Normal"),3)])]),C.content?(v(),g("div",uE,w(C.content),1)):P("",!0),r("div",dE,[r("span",hE," Created by "+w(C.createdByName||"Unknown")+"  "+w(T(C.createdAt)),1),C.matchedScope&&e.showScope?(v(),g("span",fE,w(C.matchedScope),1)):P("",!0)])],2))),128))]))]))}},oc=ze(pE,[["__scopeId","data-v-9fdf0b0b"]]),vE={class:"checklist-preview"},mE={class:"preview-actions"},gE={class:"preview-header"},yE={key:0,class:"add-item-form"},kE=["placeholder"],_E=["disabled"],bE={key:1,class:"pending-items"},wE={class:"item-content"},CE={class:"item-header"},LE={class:"item-text"},SE={class:"item-scope"},xE=["onClick"],IE={key:2,class:"empty-state"},$E={key:0,class:"help-text"},TE={key:3,class:"checklist-items"},ME={class:"item-content"},AE={class:"item-header"},EE={class:"item-text"},PE={class:"item-scope"},DE=["title"],RE={key:0,class:"item-context"},OE={__name:"ChecklistPreviewForLocation",props:{allChecklistItems:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{terms:o,termsLower:i}=St(),s=e,a=H(()=>s.checkpointTermSingular?s.checkpointTermSingular.toLowerCase():i.value.checkpoint),l=t,u=M(!1),d=M(""),p=M([...s.modelValue]);Ze(()=>s.modelValue,C=>{p.value=[...C]},{deep:!0});const f=()=>{d.value.trim()&&(p.value.push({text:d.value.trim(),isNew:!0}),d.value="",u.value=!1,y())},m=C=>{p.value.splice(C,1),y()},y=()=>{l("update:modelValue",[...p.value]),l("change")},_=C=>{const A=C.scope,E=C.itemType,N=C.ids||[];return(A==="EveryoneAtCheckpoints"||A==="OnePerCheckpoint")&&E==="Checkpoint"?N.includes("ALL_CHECKPOINTS"):A==="OnePerCheckpoint"&&E==="Area"?N.includes("ALL_AREAS")?!0:N.some($=>s.pendingAreaIds.includes($)):(A==="EveryoneInAreas"||A==="OnePerArea"||A==="EveryAreaLead"||A==="OneLeadPerArea")&&E==="Area"?N.includes("ALL_AREAS")?!0:N.some($=>s.pendingAreaIds.includes($)):!1},b=H(()=>s.allChecklistItems.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(A=>_(A)):!1)),S=C=>({EveryoneAtCheckpoints:`All at ${i.value.checkpoints}`,OnePerCheckpoint:`One per ${i.value.checkpoint}`,EveryoneInAreas:`All in ${i.value.areas}`,OnePerArea:`One per ${i.value.area}`,EveryAreaLead:`${i.value.area} leads`,OneLeadPerArea:`One lead per ${i.value.area}`})[C]||C,T=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const A=C.scopeConfigurations.find(N=>_(N));if(!A)return S(C.scopeConfigurations[0].scope);const E=A.ids||[];return E.includes("ALL_CHECKPOINTS")?`All ${i.value.checkpoints}`:E.includes("ALL_AREAS")?`All ${i.value.areas}`:S(A.scope)},D=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const A=C.scopeConfigurations.find(N=>_(N));return A&&{EveryoneAtCheckpoints:`This item is for everyone at specified ${i.value.checkpoints}`,OnePerCheckpoint:`One person at each ${i.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${i.value.areas}`,OnePerArea:`One person in each ${i.value.area} needs to complete this`,EveryAreaLead:`This item is for ${i.value.area} leads only`,OneLeadPerArea:`One ${i.value.area} lead needs to complete this`}[A.scope]||""},I=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const A=C.scopeConfigurations.find($=>_($));if(!A)return null;const E=A.itemType,N=A.ids||[];if(N.includes("ALL_CHECKPOINTS")||N.includes("ALL_AREAS"))return null;if(E==="Area"){const $=s.areas.filter(G=>N.includes(G.id)&&s.pendingAreaIds.includes(G.id)).map(G=>G.name);if($.length>0)return`In: ${$.join(", ")}`}return null};return(C,A)=>(v(),g("div",vE,[r("div",mE,[r("p",gE,w(e.isEditing?`Add new ${V(i).checklist} for this ${a.value}:`:`${V(o).checklists} that will apply at this ${a.value}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:A[0]||(A[0]=E=>u.value=!u.value)},w(u.value?"Cancel":`Add ${V(i).checklist}`),1)]),u.value?(v(),g("div",yE,[Ve(r("input",{"onUpdate:modelValue":A[1]||(A[1]=E=>d.value=E),type:"text",placeholder:`Enter ${V(i).checklist} text...`,class:"add-item-input",onKeyup:Sp(f,["enter"])},null,40,kE),[[nt,d.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!d.value.trim(),onClick:f}," Add ",8,_E)])):P("",!0),p.value.length>0?(v(),g("div",bE,[(v(!0),g(xe,null,Be(p.value,(E,N)=>(v(),g("div",{key:`pending-${N}`,class:"checklist-item pending"},[A[3]||(A[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",wE,[r("div",CE,[r("div",LE,w(E.text),1),r("div",SE,[A[2]||(A[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:$=>m(N),title:"Remove"},"  ",8,xE)])])])]))),128))])):P("",!0),!e.isEditing&&b.value.length===0&&p.value.length===0?(v(),g("div",IE,[r("p",null,"No "+w(V(i).checklists)+" will apply based on the current "+w(V(i).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),g("p",$E," Assign "+w(V(i).areas)+" to see relevant "+w(V(i).checklists)+". ",1)):P("",!0)])):P("",!0),!e.isEditing&&b.value.length>0?(v(),g("div",TE,[(v(!0),g(xe,null,Be(b.value,E=>(v(),g("div",{key:E.id,class:"checklist-item"},[A[4]||(A[4]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",ME,[r("div",AE,[r("div",EE,w(E.text),1),r("div",PE,[r("span",{class:"scope-pill",title:D(E)},w(T(E)),9,DE)])]),I(E)?(v(),g("div",RE,w(I(E)),1)):P("",!0)])]))),128))])):P("",!0)]))}},BE=ze(OE,[["__scopeId","data-v-7d943b21"]]),NE={class:"notes-preview"},FE={class:"preview-actions"},UE={class:"preview-header"},zE={key:0,class:"add-item-form"},HE={class:"add-form-fields"},VE=["disabled"],GE={key:1,class:"pending-items"},jE={class:"note-header"},ZE={class:"note-title"},qE={class:"note-actions"},WE=["onClick"],KE={key:0,class:"note-content"},YE={key:2,class:"empty-state"},JE={key:0,class:"help-text"},XE={key:3,class:"notes-list"},QE={class:"note-header"},eP={class:"note-title"},tP=["title"],nP={key:0,class:"note-content"},oP={key:1,class:"note-context"},sP={__name:"NotesPreviewForLocation",props:{allNotes:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=St(),i=e,s=t,a=H(()=>i.checkpointTermSingular?i.checkpointTermSingular.toLowerCase():o.value.checkpoint),l=M(!1),u=M(""),d=M(""),p=M([...i.modelValue]);Ze(()=>i.modelValue,C=>{p.value=[...C]},{deep:!0});const f=()=>{!u.value.trim()&&!d.value.trim()||(p.value.push({title:u.value.trim(),content:d.value.trim(),isNew:!0}),u.value="",d.value="",l.value=!1,y())},m=C=>{p.value.splice(C,1),y()},y=()=>{s("update:modelValue",[...p.value]),s("change")},_=C=>{const A=C.scope,E=C.itemType,N=C.ids||[];return A==="EveryoneAtCheckpoints"&&E==="Checkpoint"?N.includes("ALL_CHECKPOINTS"):A==="EveryoneInAreas"&&E==="Area"?N.includes("ALL_AREAS")?!0:N.some($=>i.pendingAreaIds.includes($)):!1},b=H(()=>i.allNotes.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(A=>_(A)):!1)),S=C=>({EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[C]||C,T=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const A=C.scopeConfigurations.find(N=>_(N));if(!A)return S(C.scopeConfigurations[0].scope);const E=A.ids||[];return E.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:E.includes("ALL_AREAS")?`All ${o.value.areas}`:S(A.scope)},D=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const A=C.scopeConfigurations.find(N=>_(N));return A&&{EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[A.scope]||""},I=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const A=C.scopeConfigurations.find($=>_($));if(!A)return null;const E=A.itemType,N=A.ids||[];if(N.includes("ALL_CHECKPOINTS")||N.includes("ALL_AREAS"))return null;if(E==="Area"){const $=i.areas.filter(G=>N.includes(G.id)&&i.pendingAreaIds.includes(G.id)).map(G=>G.name);if($.length>0)return`In: ${$.join(", ")}`}return null};return(C,A)=>(v(),g("div",NE,[r("div",FE,[r("p",UE,w(e.isEditing?`Add new note for this ${a.value}:`:`Notes that will be visible at this ${a.value}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:A[0]||(A[0]=E=>l.value=!l.value)},w(l.value?"Cancel":"Add note"),1)]),l.value?(v(),g("div",zE,[r("div",HE,[Ve(r("input",{"onUpdate:modelValue":A[1]||(A[1]=E=>u.value=E),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[nt,u.value]]),Ve(r("textarea",{"onUpdate:modelValue":A[2]||(A[2]=E=>d.value=E),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[nt,d.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!u.value.trim()&&!d.value.trim(),onClick:f}," Add ",8,VE)])):P("",!0),p.value.length>0?(v(),g("div",GE,[(v(!0),g(xe,null,Be(p.value,(E,N)=>(v(),g("div",{key:`pending-${N}`,class:"note-item pending"},[r("div",jE,[r("span",ZE,w(E.title||"Untitled"),1),r("div",qE,[A[3]||(A[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:$=>m(N),title:"Remove"},"  ",8,WE)])]),E.content?(v(),g("div",KE,w(E.content),1)):P("",!0)]))),128))])):P("",!0),!e.isEditing&&b.value.length===0&&p.value.length===0?(v(),g("div",YE,[r("p",null,"No notes will apply based on the current "+w(V(o).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),g("p",JE," Assign "+w(V(o).areas)+" to see relevant notes. ",1)):P("",!0)])):P("",!0),!e.isEditing&&b.value.length>0?(v(),g("div",XE,[(v(!0),g(xe,null,Be(b.value,E=>(v(),g("div",{key:E.id,class:"note-item"},[r("div",QE,[r("span",eP,w(E.title||"Untitled"),1),r("span",{class:"scope-pill",title:D(E)},w(T(E)),9,tP)]),E.content?(v(),g("div",nP,w(E.content),1)):P("",!0),I(E)?(v(),g("div",oP,w(I(E)),1)):P("",!0)]))),128))])):P("",!0)]))}},iP=ze(sP,[["__scopeId","data-v-71646c3f"]]),aP={class:"base-modal-title modal-title-with-icon"},lP=["innerHTML"],rP={key:7,class:"tab-content appearance-tab"},cP={class:"accordion-item"},uP=["innerHTML"],dP={class:"accordion-title"},hP={class:"accordion-arrow"},fP={key:0,class:"accordion-content"},pP={class:"section-description"},vP={class:"accordion-item"},mP={class:"accordion-preview"},gP={class:"accordion-arrow"},yP={key:0,class:"accordion-content"},kP={class:"section-description"},_P={class:"terminology-row"},bP={class:"terminology-field"},wP=["value"],CP={value:""},LP=["value"],SP={class:"terminology-field"},xP=["value"],IP={value:""},$P=["value"],TP={key:8,class:"tab-content incidents-tab"},MP={class:"incidents-list"},AP={class:"custom-footer"},EP={class:"footer-left"},qh="edit_location_accordion",PP={__name:"EditLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:null},assignments:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventDate:{type:String,default:""},areas:{type:Array,default:()=>[]},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},availableMarshals:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},zIndex:{type:Number,default:1e3},incidents:{type:Array,default:()=>[]},lockedFromMarshal:{type:Boolean,default:!1}},emits:["close","save","delete","move-location","toggle-check-in","remove-assignment","open-assign-modal","update:isDirty","select-incident","select-marshal"],setup(e,{emit:t}){const{terms:o}=St(),i=e,s=t,a=M("details"),l=M(!1),u=M(null),d=M(null),p=M([]),f=M([]),m=M([]),y=M({id:null,name:"",description:"",what3Words:"",latitude:0,longitude:0,requiredMarshals:1,useCustomTimes:!1,startTime:"",endTime:"",areaIds:[],styleType:"default",styleColor:"",styleBackgroundShape:"",styleBackgroundColor:"",styleBorderColor:"",styleIconColor:"",styleSize:"",styleMapRotation:"",peopleTerm:"",checkpointTerm:"",isDynamic:!1,locationUpdateScopeConfigurations:[]}),_=()=>i.eventId?`${qh}_${i.eventId}`:qh,b=M({iconStyle:!1,terminology:!1});Qt(()=>{const ie=localStorage.getItem(_());if(ie)try{const oe=JSON.parse(ie);b.value={...b.value,...oe}}catch{}});const S=ie=>{b.value[ie]=!b.value[ie],localStorage.setItem(_(),JSON.stringify(b.value))},T=H(()=>{const ie=y.value.areaIds||[];if(ie.length>0){const oe=i.areas.filter(ce=>ie.includes(ce.id)&&ce.peopleTerm).sort((ce,De)=>(ce.checkpointCount||0)-(De.checkpointCount||0));if(oe.length>0)return oe[0].peopleTerm}return i.eventPeopleTerm||"Marshals"}),D=H(()=>y.value.peopleTerm?y.value.peopleTerm:T.value),I=H(()=>{const ie=y.value.areaIds||[];if(ie.length>0){const oe=i.areas.filter(ce=>ie.includes(ce.id)&&ce.checkpointTerm).sort((ce,De)=>(ce.checkpointCount||0)-(De.checkpointCount||0));if(oe.length>0)return oe[0].checkpointTerm}return o.value.checkpoint});H(()=>I.value.toLowerCase());const C=H(()=>{const ie=y.value.checkpointTerm||i.location?.checkpointTerm||i.location?.CheckpointTerm;if(ie)return Zi("checkpoint",ie,D.value);const oe=y.value.areaIds||[];let ce=null;if(oe.length>0){const De=i.areas.filter(we=>oe.includes(we.id)&&we.checkpointTerm).sort((we,te)=>(we.checkpointCount||0)-(te.checkpointCount||0));De.length>0&&(ce=De[0].checkpointTerm)}return ce?Zi("checkpoint",ce,D.value):o.value.checkpoint}),A=H(()=>C.value.toLowerCase()),E=H(()=>{const ie=D.value;return Zi("people",ie)});H(()=>E.value.toLowerCase());const N=H(()=>o.value.area);H(()=>N.value.toLowerCase());const $=H(()=>o.value.area),G=H(()=>$.value.toLowerCase()),R=H(()=>o.value.areas),Z=H(()=>!!(i.location&&i.location.id)),U=H(()=>Z.value?`Edit ${A.value}: ${i.location?.name||""}`:`Add ${A.value}`),K=H(()=>{const ie=[{value:"details",label:"Details",icon:"details"},{value:"location",label:"Location",icon:"location"},{value:"marshals",label:D.value,icon:"marshal"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return i.incidents&&i.incidents.length>0&&ie.push({value:"incidents",label:"Incidents",icon:"incidents"}),ie}),re=H(()=>K.value.findIndex(ie=>ie.value===a.value)),Pe=H(()=>re.value===K.value.length-1),me=H(()=>{const ie=y.value.areaIds||[],oe=i.areas.filter($e=>ie.includes($e.id)).sort(($e,We)=>($e.checkpointCount||0)-(We.checkpointCount||0)),ce=($e,We)=>{for(const ot of oe){const st=$e(ot);if(st&&st!=="default")return{value:st,source:"area"}}return We&&We!=="default"?{value:We,source:"event"}:{value:"",source:"none"}},De=ce($e=>$e.checkpointStyleType||$e.CheckpointStyleType,i.eventDefaultStyleType),we=ce($e=>$e.checkpointStyleColor||$e.CheckpointStyleColor,i.eventDefaultStyleColor),te=ce($e=>$e.checkpointStyleBackgroundShape||$e.CheckpointStyleBackgroundShape,i.eventDefaultStyleBackgroundShape),ke=ce($e=>$e.checkpointStyleBackgroundColor||$e.CheckpointStyleBackgroundColor||$e.checkpointStyleColor||$e.CheckpointStyleColor,i.eventDefaultStyleBackgroundColor||i.eventDefaultStyleColor),se=ce($e=>$e.checkpointStyleBorderColor||$e.CheckpointStyleBorderColor,i.eventDefaultStyleBorderColor),Q=ce($e=>$e.checkpointStyleIconColor||$e.CheckpointStyleIconColor,i.eventDefaultStyleIconColor),X=ce($e=>$e.checkpointStyleSize||$e.CheckpointStyleSize,i.eventDefaultStyleSize),O=ce($e=>$e.checkpointStyleMapRotation??$e.CheckpointStyleMapRotation,i.eventDefaultStyleMapRotation),J=[De,te,ke,se,Q,X,O].some($e=>$e.source==="area");return{type:De.value||"default",color:we.value,backgroundShape:te.value,backgroundColor:ke.value,borderColor:se.value,iconColor:Q.value,size:X.value,mapRotation:O.value,source:J?"area":De.value?"event":"none"}}),Ae=H(()=>me.value.source==="area"?`${$.value} default`:"Event default"),Fe=H(()=>{const ie=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:me.value.type,oe=y.value.styleBackgroundShape||me.value.backgroundShape||"circle",ce=y.value.styleBackgroundColor||me.value.backgroundColor||"#667eea",De=y.value.styleBorderColor||me.value.borderColor||"#ffffff",we=y.value.styleIconColor||me.value.iconColor||"#ffffff";return wn({type:ie||"circle",backgroundShape:oe,backgroundColor:ce,borderColor:De,iconColor:we,size:"100"})}),ae=H(()=>{let ie,oe,ce,De,we;return Z.value&&i.location?(ie=i.location.resolvedStyleType||i.location.ResolvedStyleType,oe=i.location.resolvedStyleBackgroundShape||i.location.ResolvedStyleBackgroundShape||"circle",ce=i.location.resolvedStyleBackgroundColor||i.location.ResolvedStyleBackgroundColor||i.location.resolvedStyleColor||i.location.ResolvedStyleColor||"#667eea",De=i.location.resolvedStyleBorderColor||i.location.ResolvedStyleBorderColor||"#ffffff",we=i.location.resolvedStyleIconColor||i.location.ResolvedStyleIconColor||"#ffffff"):(ie=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:me.value.type,oe=y.value.styleBackgroundShape||me.value.backgroundShape||"circle",ce=y.value.styleBackgroundColor||me.value.backgroundColor||"#667eea",De=y.value.styleBorderColor||me.value.borderColor||"#ffffff",we=y.value.styleIconColor||me.value.iconColor||"#ffffff"),wn({type:ie||"circle",backgroundShape:oe,backgroundColor:ce,borderColor:De,iconColor:we,size:"100",outputSize:28})}),Me=H(()=>{const ie=!!y.value.checkpointTerm,oe=!!y.value.peopleTerm;return ie&&oe?`${Zi("checkpoint",y.value.checkpointTerm,y.value.peopleTerm)}, ${y.value.peopleTerm}`:ie?Zi("checkpoint",y.value.checkpointTerm,D.value):oe?y.value.peopleTerm:"Using defaults"}),ge=H(()=>Pe.value?null:K.value[re.value+1]),de=H(()=>ge.value?`${ge.value.label}...`:""),Oe=M(!1),Xe=M(null);Ze(()=>i.location,ie=>{if(ie){const oe=ie.id||"new";if(Xe.value!==oe){Xe.value=oe,Oe.value=!0;let ce="",De="";ie.startTime&&(ce=Tl(ie.startTime)),ie.endTime&&(De=Tl(ie.endTime)),y.value={id:ie.id||null,name:ie.name||"",description:ie.description||"",what3Words:ie.what3Words||"",latitude:ie.latitude||0,longitude:ie.longitude||0,requiredMarshals:ie.requiredMarshals||1,useCustomTimes:!!(ie.startTime||ie.endTime),startTime:ce,endTime:De,areaIds:ie.areaIds||ie.AreaIds||[],styleType:ie.styleType||ie.StyleType||"default",styleColor:ie.styleColor||ie.StyleColor||"",styleBackgroundShape:ie.styleBackgroundShape||ie.StyleBackgroundShape||"",styleBackgroundColor:ie.styleBackgroundColor||ie.StyleBackgroundColor||"",styleBorderColor:ie.styleBorderColor||ie.StyleBorderColor||"",styleIconColor:ie.styleIconColor||ie.StyleIconColor||"",styleSize:ie.styleSize||ie.StyleSize||"",styleMapRotation:ie.styleMapRotation??ie.StyleMapRotation??"",peopleTerm:ie.peopleTerm||"",checkpointTerm:ie.checkpointTerm||"",isDynamic:ie.isDynamic||!1,locationUpdateScopeConfigurations:ie.locationUpdateScopeConfigurations||[]}}}},{immediate:!0,deep:!0}),Ze(()=>i.show,ie=>{ie?(a.value="details",l.value=!1,p.value=[],f.value=[],m.value=[],u.value?.clearPendingChanges&&u.value.clearPendingChanges(),d.value?.resetLocalState&&d.value.resetLocalState()):(Xe.value=null,Oe.value=!1)});const et=ie=>{y.value=ie},qe=()=>{s("update:isDirty",!0)},tt=()=>{l.value=!l.value,s("move-location",{isMoving:l.value,formData:{...y.value}})},be=ie=>{p.value=ie,qe()},He=()=>{ge.value&&(a.value=ge.value.value)},fe=()=>{const ie={...y.value,startTime:y.value.useCustomTimes&&y.value.startTime?new Date(y.value.startTime).toISOString():null,endTime:y.value.useCustomTimes&&y.value.endTime?new Date(y.value.endTime).toISOString():null,checkInChanges:u.value?.getPendingChanges?.()||[],assignmentsToRemove:u.value?.getMarkedForRemoval?.()||[],checklistChanges:p.value||[],pendingAssignments:i.assignments.filter(oe=>oe.isPending).map(oe=>({marshalId:oe.marshalId})),pendingNewChecklistItems:f.value,pendingNewNotes:m.value};s("save",ie)},Ie=()=>{i.location&&i.location.id&&s("delete",i.location.id)},Te=ie=>{s("remove-assignment",ie)},W=()=>{s("open-assign-modal")},Y=ie=>{s("select-marshal",ie)},le=()=>{s("close")},ye=(ie,oe)=>{y.value[ie]=oe,qe()};return(ie,oe)=>(v(),je(zt,{show:e.show,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:le},{header:Ue(()=>[r("h2",aP,[ae.value?(v(),g("span",{key:0,class:"modal-title-icon",innerHTML:ae.value},null,8,lP)):P("",!0),Ke(" "+w(U.value),1)])]),"tab-header":Ue(()=>[Ee(Fa,{modelValue:a.value,"onUpdate:modelValue":oe[0]||(oe[0]=ce=>a.value=ce),tabs:K.value},null,8,["modelValue","tabs"])]),footer:Ue(()=>[r("div",AP,[r("div",EP,[Z.value&&!e.lockedFromMarshal?(v(),g("button",{key:0,type:"button",onClick:Ie,class:"btn btn-danger"}," Delete ")):P("",!0),!Z.value&&!Pe.value?(v(),g("button",{key:1,type:"button",onClick:He,class:"btn btn-secondary mobile-only"},w(de.value),1)):P("",!0)]),r("button",{type:"button",onClick:fe,class:"btn btn-success"}," Save ")])]),default:Ue(()=>[a.value==="details"?(v(),je(GT,{key:0,form:y.value,areas:e.areas,"event-date":e.eventDate,"area-term-singular":$.value,"area-term-plural":R.value,"checkpoint-term-singular":C.value,"people-term-plural":D.value,"onUpdate:form":et,onInput:qe,onSave:fe},null,8,["form","areas","event-date","area-term-singular","area-term-plural","checkpoint-term-singular","people-term-plural"])):P("",!0),a.value==="location"?(v(),je(YM,{key:1,form:y.value,"is-moving":l.value,"checkpoint-term-singular":C.value,"people-term-plural":D.value,areas:e.areas,locations:e.allLocations,marshals:e.availableMarshals,"is-editing":Z.value,"onUpdate:form":et,onInput:qe,onSave:fe,onMoveLocation:tt},null,8,["form","is-moving","checkpoint-term-singular","people-term-plural","areas","locations","marshals","is-editing"])):P("",!0),a.value==="marshals"?(v(),je(bA,{key:2,ref_key:"assignmentsTabRef",ref:u,form:y.value,assignments:e.assignments,"people-term":D.value,"person-term":E.value,"checkpoint-term":C.value,"read-only":e.lockedFromMarshal,"onUpdate:form":et,onInput:qe,onRemoveAssignment:Te,onOpenAssignModal:W,onSelectMarshal:Y},null,8,["form","assignments","people-term","person-term","checkpoint-term","read-only"])):P("",!0),a.value==="checklists"&&Z.value?(v(),je($v,{key:3,ref_key:"checklistTabRef",ref:d,modelValue:p.value,"onUpdate:modelValue":oe[1]||(oe[1]=ce=>p.value=ce),"event-id":e.eventId,"location-id":e.location.id,locations:e.allLocations,areas:e.areas,assignments:e.assignments,onChange:be},null,8,["modelValue","event-id","location-id","locations","areas","assignments"])):P("",!0),a.value==="checklists"?(v(),je(BE,{key:4,modelValue:f.value,"onUpdate:modelValue":oe[2]||(oe[2]=ce=>f.value=ce),"all-checklist-items":e.allChecklistItems,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":Z.value,"checkpoint-term-singular":C.value,onChange:qe},null,8,["modelValue","all-checklist-items","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):P("",!0),a.value==="notes"&&Z.value?(v(),je(oc,{key:5,"event-id":e.eventId,"location-id":e.location?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","location-id","all-notes","locations","areas","assignments"])):P("",!0),a.value==="notes"?(v(),je(iP,{key:6,modelValue:m.value,"onUpdate:modelValue":oe[3]||(oe[3]=ce=>m.value=ce),"all-notes":e.notes,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":Z.value,"checkpoint-term-singular":C.value,onChange:qe},null,8,["modelValue","all-notes","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):P("",!0),a.value==="appearance"?(v(),g("div",rP,[r("div",cP,[r("button",{type:"button",class:ue(["accordion-header",{expanded:b.value.iconStyle}]),onClick:oe[4]||(oe[4]=ce=>S("iconStyle"))},[r("div",{class:"accordion-icon",innerHTML:Fe.value},null,8,uP),r("span",dP,w(C.value)+" marker style",1),r("span",hP,w(b.value.iconStyle?"":""),1)],2),b.value.iconStyle?(v(),g("div",fP,[r("p",pP," Choose a custom icon for this "+w(A.value)+", or leave as Default to inherit from "+w(G.value)+" or event settings. ",1),Ee(ju,{"style-type":y.value.styleType||"default","style-color":y.value.styleColor||"","style-background-shape":y.value.styleBackgroundShape||"","style-background-color":y.value.styleBackgroundColor||"","style-border-color":y.value.styleBorderColor||"","style-icon-color":y.value.styleIconColor||"","style-size":y.value.styleSize||"","style-map-rotation":y.value.styleMapRotation??"","inherited-style-type":me.value.type,"inherited-style-color":me.value.color,"inherited-background-shape":me.value.backgroundShape||"","inherited-background-color":me.value.backgroundColor||me.value.color||"","inherited-border-color":me.value.borderColor||"","inherited-icon-color":me.value.iconColor||"","inherited-size":me.value.size||"","inherited-map-rotation":me.value.mapRotation??"","default-label":Ae.value,"icon-label":"Marker style",level:"checkpoint","show-preview":!0,"onUpdate:styleType":oe[5]||(oe[5]=ce=>ye("styleType",ce)),"onUpdate:styleColor":oe[6]||(oe[6]=ce=>ye("styleColor",ce)),"onUpdate:styleBackgroundShape":oe[7]||(oe[7]=ce=>ye("styleBackgroundShape",ce)),"onUpdate:styleBackgroundColor":oe[8]||(oe[8]=ce=>ye("styleBackgroundColor",ce)),"onUpdate:styleBorderColor":oe[9]||(oe[9]=ce=>ye("styleBorderColor",ce)),"onUpdate:styleIconColor":oe[10]||(oe[10]=ce=>ye("styleIconColor",ce)),"onUpdate:styleSize":oe[11]||(oe[11]=ce=>ye("styleSize",ce)),"onUpdate:styleMapRotation":oe[12]||(oe[12]=ce=>ye("styleMapRotation",ce))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation","default-label"])])):P("",!0)]),r("div",vP,[r("button",{type:"button",class:ue(["accordion-header",{expanded:b.value.terminology}]),onClick:oe[13]||(oe[13]=ce=>S("terminology"))},[oe[17]||(oe[17]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("circle",{cx:"9",cy:"8",r:"3",fill:"#6366F1"}),r("path",{d:"M3 18c0-3.3 2.7-6 6-6s6 2.7 6 6",fill:"#6366F1",opacity:"0.5"}),r("circle",{cx:"17",cy:"14",r:"5",fill:"#10B981",opacity:"0.3"}),r("circle",{cx:"17",cy:"14",r:"3",fill:"#10B981"}),r("circle",{cx:"17",cy:"14",r:"1",fill:"white"})])],-1)),oe[18]||(oe[18]=r("span",{class:"accordion-title"},"Terminology",-1)),r("span",mP,w(Me.value),1),r("span",gP,w(b.value.terminology?"":""),1)],2),b.value.terminology?(v(),g("div",yP,[r("p",kP," Customise what this "+w(A.value)+" and its "+w(D.value.toLowerCase())+" are called. ",1),r("div",_P,[r("div",bP,[r("label",null,"What is this "+w(A.value)+" called?",1),r("select",{value:y.value.checkpointTerm,class:"form-input",onChange:oe[14]||(oe[14]=ce=>{et({...y.value,checkpointTerm:ce.target.value}),qe()})},[r("option",CP,"Use "+w(G.value)+" default ("+w(C.value)+")",1),oe[19]||(oe[19]=r("option",{value:"Vehicle"},"Vehicle",-1)),oe[20]||(oe[20]=r("option",{value:"Car"},"Car",-1)),oe[21]||(oe[21]=r("option",{value:"Bike"},"Bike",-1)),(v(!0),g(xe,null,Be(V(Bs).checkpoint,ce=>(v(),g("option",{key:ce,value:ce},w(ce),9,LP))),128))],40,wP)]),r("div",SP,[r("label",null,"What are "+w(D.value.toLowerCase())+" called here?",1),r("select",{value:y.value.peopleTerm,class:"form-input",onChange:oe[15]||(oe[15]=ce=>{et({...y.value,peopleTerm:ce.target.value}),qe()})},[r("option",IP,"Use "+w(G.value)+" default ("+w(T.value)+")",1),(v(!0),g(xe,null,Be(V(Bs).people,ce=>(v(),g("option",{key:ce,value:ce},w(ce),9,$P))),128))],40,xP)])])])):P("",!0)])])):P("",!0),a.value==="incidents"?(v(),g("div",TP,[r("div",MP,[(v(!0),g(xe,null,Be(e.incidents,ce=>(v(),je(Fl,{key:ce.incidentId,incident:ce,onSelect:oe[16]||(oe[16]=De=>ie.$emit("select-incident",De))},null,8,["incident"]))),128))])])):P("",!0)]),_:1},8,["show","is-dirty","z-index"]))}},DP=ze(PP,[["__scopeId","data-v-61f1a81f"]]),RP={class:"tab-content"},OP={key:0,class:"error-banner"},BP=["value"],NP={key:0,class:"field-error"},FP={class:"contact-row"},UP=["value"],zP={key:0,class:"field-error"},HP=["value"],VP={key:0,class:"field-error"},GP=["value"],jP={key:0,class:"field-error"},ZP={key:1,class:"magic-link-section"},qP={key:0,class:"loading-text"},WP={key:1,class:"magic-link-container"},KP={class:"magic-link-row"},YP=["value"],JP={key:0,class:"error-text"},XP={key:1,class:"magic-link-actions"},QP=["disabled"],e3={key:2,class:"success-text"},t3={key:3,class:"error-text"},n3={key:2,class:"error-text"},o3={__name:"MarshalDetailsTab",props:{form:{type:Object,required:!0},eventId:{type:String,default:null},marshalId:{type:String,default:null},validationErrors:{type:Object,default:()=>({})}},emits:["update:form","input"],setup(e,{expose:t,emit:o}){const i=e,s=o,a=M(null),l=M(null),u=M(null),d=M(null),p=M(""),f=M(!1),m=M(!1),y=M(""),_=M(!1),b=M(!1),S=M(!1),T=M(""),D=($,G)=>{s("update:form",{...i.form,[$]:G}),s("input")},I=async()=>{if(!(!i.eventId||!i.marshalId)){m.value=!0,y.value="";try{const $=await hs.getMagicLink(i.eventId,i.marshalId);p.value=$.data.magicLink,f.value=$.data.hasEmail}catch($){console.error("Failed to fetch magic link:",$),y.value="Failed to load login link"}finally{m.value=!1}}},C=M(""),A=async()=>{C.value="";try{if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(p.value),_.value=!0,setTimeout(()=>{_.value=!1},2e3);return}}catch($){console.warn("Clipboard API failed, trying fallback:",$)}try{const $=document.createElement("textarea");$.value=p.value,$.style.position="fixed",$.style.left="-9999px",$.style.top="0",document.body.appendChild($),$.focus(),$.select();const G=document.execCommand("copy");document.body.removeChild($),G?(_.value=!0,setTimeout(()=>{_.value=!1},2e3)):(C.value="Copy failed. Please select and copy the link manually.",setTimeout(()=>{C.value=""},4e3))}catch($){console.error("Fallback copy failed:",$),C.value="Copy not supported. Please select and copy the link manually.",setTimeout(()=>{C.value=""},4e3)}},E=async()=>{if(!(!i.eventId||!i.marshalId)){b.value=!0,S.value=!1,T.value="";try{await hs.sendMagicLink(i.eventId,i.marshalId),S.value=!0,setTimeout(()=>{S.value=!1},3e3)}catch($){console.error("Failed to send email:",$),T.value=$.response?.data?.message||"Failed to send email"}finally{b.value=!1}}};return Ze(()=>i.marshalId,$=>{$?I():(p.value="",f.value=!1)},{immediate:!0}),t({focusField:$=>{qn(()=>{const R={name:a,email:l,phoneNumber:u,notes:d}[$];R?.value&&(R.value.focus(),R.value.scrollIntoView({behavior:"smooth",block:"center"}))})}}),($,G)=>(v(),g("div",RP,[e.validationErrors.general?(v(),g("div",OP,w(e.validationErrors.general),1)):P("",!0),r("div",{class:ue(["form-group",{"has-error":e.validationErrors.name}])},[G[5]||(G[5]=r("label",null,"Name *",-1)),r("input",{ref_key:"nameInputRef",ref:a,value:e.form.name,onInput:G[0]||(G[0]=R=>D("name",R.target.value)),type:"text",required:"",class:ue(["form-input",{"input-error":e.validationErrors.name}])},null,42,BP),e.validationErrors.name?(v(),g("span",NP,w(e.validationErrors.name),1)):P("",!0)],2),r("div",FP,[r("div",{class:ue(["form-group contact-email",{"has-error":e.validationErrors.email}])},[G[6]||(G[6]=r("label",null,"Email",-1)),r("input",{ref_key:"emailInputRef",ref:l,value:e.form.email,onInput:G[1]||(G[1]=R=>D("email",R.target.value)),type:"email",class:ue(["form-input",{"input-error":e.validationErrors.email}])},null,42,UP),e.validationErrors.email?(v(),g("span",zP,w(e.validationErrors.email),1)):P("",!0)],2),r("div",{class:ue(["form-group contact-phone",{"has-error":e.validationErrors.phoneNumber}])},[G[7]||(G[7]=r("label",null,"Phone number",-1)),r("input",{ref_key:"phoneInputRef",ref:u,value:e.form.phoneNumber,onInput:G[2]||(G[2]=R=>D("phoneNumber",R.target.value)),type:"tel",class:ue(["form-input",{"input-error":e.validationErrors.phoneNumber}])},null,42,HP),e.validationErrors.phoneNumber?(v(),g("span",VP,w(e.validationErrors.phoneNumber),1)):P("",!0)],2)]),r("div",{class:ue(["form-group",{"has-error":e.validationErrors.notes}])},[G[8]||(G[8]=r("label",null,"Notes",-1)),r("textarea",{ref_key:"notesInputRef",ref:d,value:e.form.notes,onInput:G[3]||(G[3]=R=>D("notes",R.target.value)),class:ue(["form-input",{"input-error":e.validationErrors.notes}]),rows:"3",placeholder:"e.g., Needs to leave by 11am"},null,42,GP),e.validationErrors.notes?(v(),g("span",jP,w(e.validationErrors.notes),1)):P("",!0)],2),e.marshalId?(v(),g("div",ZP,[G[9]||(G[9]=r("label",null,"Login link",-1)),G[10]||(G[10]=r("p",{class:"help-text"},"Share this unique link with the marshal so they can access their dashboard.",-1)),m.value?(v(),g("div",qP,"Loading link...")):p.value?(v(),g("div",WP,[r("div",KP,[r("input",{type:"text",value:p.value,readonly:"",class:"form-input magic-link-input",onFocus:G[4]||(G[4]=R=>R.target.select())},null,40,YP),r("button",{type:"button",class:"btn btn-secondary",onClick:A},w(_.value?"Copied!":"Copy link"),1)]),C.value?(v(),g("p",JP,w(C.value),1)):P("",!0),f.value?(v(),g("div",XP,[r("button",{type:"button",class:"btn btn-primary",disabled:b.value,onClick:E},w(b.value?"Sending...":"Send via email"),9,QP)])):P("",!0),S.value?(v(),g("p",e3,"Email sent successfully!")):P("",!0),T.value?(v(),g("p",t3,w(T.value),1)):P("",!0)])):y.value?(v(),g("div",n3,w(y.value),1)):P("",!0)])):P("",!0)]))}},s3=ze(o3,[["__scopeId","data-v-16ffb81b"]]),i3={class:"card-header"},a3={class:"checkpoint-name-row"},l3=["innerHTML"],r3={class:"checkpoint-name"},c3={key:0,class:"checkpoint-description"},u3={key:0,class:"card-areas"},d3={key:1,class:"card-check-in"},h3={key:0,class:"check-in-time"},f3={key:0,class:"check-in-method"},p3={key:1,class:"unsaved-indicator"},v3={key:2,class:"card-locked"},m3={class:"locked-badge"},g3={key:3,class:"card-badge"},y3={key:4,class:"card-badge"},k3={__name:"MarshalCheckpointCard",props:{assignment:{type:Object,required:!0},location:{type:Object,default:null},areas:{type:Array,default:()=>[]},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isLocked:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1}},emits:["click","toggle-check-in","remove","undo-remove"],setup(e,{emit:t}){const{termsLower:o}=St(),i=e,s=t,a=H(()=>i.location?i.location.areaIds||i.location.AreaIds||[]:[]),l=H(()=>a.value.map(_=>{const b=i.areas.find(S=>S.id===_);return b?b.name:null}).filter(Boolean)),u=H(()=>a.value.map(_=>{const b=i.areas.find(S=>S.id===_);return b?b.color:"#999"})),d=H(()=>{if(!i.location)return"#667eea";const _=i.location,b=_.resolvedStyleBackgroundColor||_.ResolvedStyleBackgroundColor||_.resolvedStyleColor||_.ResolvedStyleColor;if(b)return b;if(a.value.length>0){const S=i.areas.find(T=>T.id===a.value[0]);if(S)return S.color}return"#667eea"}),p=H(()=>{if(!i.location)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
    </svg>`;const _=i.location,b=_.resolvedStyleType||_.ResolvedStyleType,S=_.resolvedStyleBackgroundColor||_.ResolvedStyleBackgroundColor||_.resolvedStyleColor||_.ResolvedStyleColor,T=_.resolvedStyleBorderColor||_.ResolvedStyleBorderColor,D=_.resolvedStyleIconColor||_.ResolvedStyleIconColor,I=_.resolvedStyleBackgroundShape||_.ResolvedStyleBackgroundShape;return b&&b!=="default"||S||T||D||I&&I!=="circle"?wn({type:b||"circle",backgroundShape:I||"circle",backgroundColor:S||"#667eea",borderColor:T||"#ffffff",iconColor:D||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),f=_=>_?new Date(_).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",m=H(()=>{const{checkedInBy:_,checkInMethod:b,marshalName:S}=i.assignment;return _&&_!==S?_:b||""}),y=()=>{!i.assignment.isPending&&!i.isMarkedForRemoval&&!i.isLocked&&s("click",i.assignment)};return(_,b)=>(v(),g("div",{class:ue(["marshal-checkpoint-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-locked":e.isLocked}]),style:ut({borderLeftColor:e.isMarkedForRemoval?void 0:d.value})},[r("div",i3,[r("div",{class:"card-title",onClick:y},[r("span",a3,[r("span",{class:"checkpoint-icon",innerHTML:p.value},null,8,l3),r("span",r3,w(e.assignment.locationName),1),e.assignment.locationDescription?(v(),g("span",c3,"  "+w(e.assignment.locationDescription),1)):P("",!0)])]),!e.isLocked&&!e.isMarkedForRemoval?(v(),g("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:b[0]||(b[0]=dt(S=>_.$emit("remove",e.assignment),["stop"]))},"  ")):P("",!0),e.isMarkedForRemoval?(v(),g("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:b[1]||(b[1]=dt(S=>_.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):P("",!0)]),l.value.length>0&&!e.isMarkedForRemoval?(v(),g("div",u3,[(v(!0),g(xe,null,Be(l.value,(S,T)=>(v(),g("span",{key:T,class:"area-badge",style:ut({backgroundColor:u.value[T]})},w(S),5))),128))])):P("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.isLocked?(v(),g("div",d3,[r("button",{class:ue(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:b[2]||(b[2]=S=>_.$emit("toggle-check-in",e.assignment))},[...b[3]||(b[3]=[r("span",{class:"toggle-icon"},"",-1),r("span",{class:"toggle-label-wrapper"},[r("span",{class:"toggle-label toggle-label-check-in"},"Check in"),r("span",{class:"toggle-label toggle-label-checked-in"},"Checked in")],-1)])],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(v(),g("span",h3,[Ke(w(f(e.assignment.checkInTime))+" ",1),m.value?(v(),g("span",f3,"("+w(m.value)+")",1)):P("",!0)])):e.hasUnsavedChanges?(v(),g("span",p3," Unsaved ")):P("",!0)])):P("",!0),e.isLocked&&!e.isMarkedForRemoval?(v(),g("div",v3,[r("span",m3,"Viewing from this "+w(V(o).checkpoint),1)])):P("",!0),e.assignment.isPending?(v(),g("div",g3,[...b[4]||(b[4]=[r("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):P("",!0),e.isMarkedForRemoval?(v(),g("div",y3,[...b[5]||(b[5]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):P("",!0)],6))}},_3=ze(k3,[["__scopeId","data-v-df38bf23"]]),b3={class:"tab-content"},w3={key:0,class:"read-only-notice"},C3={class:"section-title"},L3={key:1,class:"form-group",style:{"margin-top":"1.5rem"}},S3={value:""},x3=["value"],I3={__name:"MarshalCheckpointsTab",props:{assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isNewMarshal:{type:Boolean,default:!1},lockedCheckpointId:{type:String,default:null}},emits:["input","remove-assignment","assign-to-location","select-checkpoint"],setup(e,{expose:t,emit:o}){const{termsLower:i}=St(),s=e,a=o,{pendingCheckInChanges:l,getEffectiveCheckInStatus:u,handleToggleCheckIn:d}=Iv(()=>a("input")),p=M(""),f=M(new Set),m=H(()=>s.assignments?.length||0),y=E=>s.allLocations&&s.allLocations.find(N=>N.id===E)||null,_=H(()=>[...s.assignments].sort((E,N)=>(E.locationName||"").localeCompare(N.locationName||"",void 0,{numeric:!0,sensitivity:"base"}))),b=E=>f.value.has(E),S=E=>{E.isPending||a("select-checkpoint",E)},T=E=>{d(E)},D=E=>{E.isPending?a("remove-assignment",E):(f.value.add(E.id),a("input"))},I=E=>{f.value.delete(E.id),a("input")},C=H(()=>{const E=[...s.availableLocations];return E.sort((N,$)=>N.name.localeCompare($.name,void 0,{numeric:!0,sensitivity:"base"})),E}),A=()=>{p.value&&(a("assign-to-location",p.value),p.value="")};return t({pendingCheckInChanges:l,clearPendingChanges:()=>{l.value.clear(),f.value.clear(),p.value=""},getPendingChanges:()=>Array.from(l.value.entries()).map(([E,N])=>({assignmentId:E,shouldBeCheckedIn:N})),getMarkedForRemoval:()=>Array.from(f.value)}),(E,N)=>(v(),g("div",b3,[e.lockedCheckpointId?(v(),g("div",w3," Viewing from "+w(V(i).checkpoint)+" - "+w(V(i).checkpoints)+" cannot be modified here. ",1)):P("",!0),r("h3",C3,"Assigned "+w(V(i).checkpoints)+" ("+w(m.value)+")",1),Ee(Nl,{"is-empty":e.assignments.length===0,"empty-message":`No ${V(i).checkpoints} assigned yet.`,"empty-hint":e.lockedCheckpointId?"":`Use the dropdown below to assign this ${V(i).person} to ${V(i).checkpoints}.`},{default:Ue(()=>[(v(!0),g(xe,null,Be(_.value,$=>(v(),je(_3,{key:$.id,assignment:$,location:y($.locationId),areas:e.areas,"effective-check-in-status":V(u)($),"has-unsaved-changes":V(l).has($.id),"is-locked":!!e.lockedCheckpointId,"is-marked-for-removal":b($.id),onClick:S,onToggleCheckIn:T,onRemove:D,onUndoRemove:I},null,8,["assignment","location","areas","effective-check-in-status","has-unsaved-changes","is-locked","is-marked-for-removal"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),!e.lockedCheckpointId&&C.value.length>0?(v(),g("div",L3,[r("label",null,"Assign to "+w(V(i).checkpoint),1),Ve(r("select",{"onUpdate:modelValue":N[0]||(N[0]=$=>p.value=$),class:"form-input",onChange:A},[r("option",S3,"Select a "+w(V(i).checkpoint)+"...",1),(v(!0),g(xe,null,Be(C.value,$=>(v(),g("option",{key:$.id,value:$.id},[Ke(w($.name),1),$.description?(v(),g(xe,{key:0},[Ke(" - "+w($.description),1)],64)):P("",!0)],8,x3))),128))],544),[[Dn,p.value]])])):P("",!0)]))}},$3=ze(I3,[["__scopeId","data-v-7a6b154e"]]),T3={class:"marshal-checklist-view"},M3={key:0,class:"loading-state"},A3={key:1,class:"error-state"},E3={key:2,class:"empty-state"},P3={__name:"MarshalChecklistView",props:{eventId:{type:String,required:!0},marshalId:{type:String,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{termsLower:i}=St(),s=e,a=o,l=M([]),u=M(!1),d=M(null),p=M(new Map),f=H(()=>l.value.map(S=>{const T=p.value.get(S.itemId),D=T!==void 0?T.complete:S.isCompleted,I=T!==void 0&&T.complete!==S.isCompleted;return{...S,localIsCompleted:D,isModified:I}})),m=async()=>{if(!(!s.eventId||!s.marshalId)){u.value=!0,d.value=null;try{const S=await Rt.getMarshalChecklist(s.eventId,s.marshalId);if(l.value=S.data||[],s.modelValue&&s.modelValue.length>0){const T=new Map;s.modelValue.forEach(D=>{T.set(D.itemId,{complete:D.complete,contextType:D.contextType,contextId:D.contextId})}),p.value=T}}catch(S){console.error("Failed to load checklist:",S),d.value=S.response?.data?.message||"Failed to load checklist"}finally{u.value=!1}}},y=S=>{const T=p.value.get(S.itemId),D=T!==void 0?T.complete:S.isCompleted;p.value.set(S.itemId,{complete:!D,contextType:S.completionContextType,contextId:S.completionContextId}),_()},_=()=>{const S=[];for(const[T,D]of p.value.entries()){const I=l.value.find(C=>C.itemId===T);I&&D.complete!==I.isCompleted&&S.push({itemId:T,complete:D.complete,contextType:D.contextType,contextId:D.contextId})}a("update:modelValue",S),a("change",S)};return t({resetLocalState:()=>{if(p.value=new Map,s.modelValue&&s.modelValue.length>0){const S=new Map;s.modelValue.forEach(T=>{S.set(T.itemId,{complete:T.complete,contextType:T.contextType,contextId:T.contextId})}),p.value=S}},loadChecklist:m}),Ze(()=>[s.eventId,s.marshalId],()=>{m()},{immediate:!0}),(S,T)=>(v(),g("div",T3,[u.value?(v(),g("div",M3," Loading checklist... ")):d.value?(v(),g("div",A3,[r("p",null,w(d.value),1),r("button",{onClick:m,class:"btn btn-secondary btn-small"}," Retry ")])):l.value.length===0?(v(),g("div",E3,[r("p",null,"No checklist items for this "+w(V(i).person)+".",1)])):(v(),je(Zu,{key:3,items:f.value,locations:e.locations,areas:e.areas,onToggleComplete:y},null,8,["items","locations","areas"]))]))}},D3=ze(P3,[["__scopeId","data-v-7460304c"]]),R3={class:"checklist-preview"},O3={class:"preview-actions"},B3={class:"preview-header"},N3={key:0,class:"add-item-form"},F3=["placeholder"],U3=["disabled"],z3={key:1,class:"pending-items"},H3={class:"item-content"},V3={class:"item-header"},G3={class:"item-text"},j3={class:"item-scope"},Z3=["onClick"],q3={key:2,class:"empty-state"},W3={key:0,class:"help-text"},K3={key:3,class:"checklist-items"},Y3={class:"item-content"},J3={class:"item-header"},X3={class:"item-text"},Q3={class:"item-scope"},e4=["title"],t4={key:0,class:"item-context"},n4={__name:"ChecklistPreview",props:{allChecklistItems:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=St(),i=e,s=t,a=M(!1),l=M(""),u=M([...i.modelValue]);Ze(()=>i.modelValue,I=>{u.value=[...I]},{deep:!0});const d=()=>{l.value.trim()&&(u.value.push({text:l.value.trim(),isNew:!0}),l.value="",a.value=!1,f())},p=I=>{u.value.splice(I,1),f()},f=()=>{s("update:modelValue",[...u.value]),s("change")},m=H(()=>{const I=new Set;for(const C of i.pendingLocationIds){const A=i.allLocations.find(E=>E.id===C);A&&(A.areaIds||A.AreaIds||[]).forEach(N=>I.add(N))}return[...I]}),y=I=>{const C=I.scope,A=I.itemType,E=I.ids||[];return C==="SpecificPeople"&&A==="Marshal"?E.includes("ALL_MARSHALS"):(C==="EveryoneAtCheckpoints"||C==="OnePerCheckpoint")&&A==="Checkpoint"?E.includes("ALL_CHECKPOINTS")?!0:E.some(N=>i.pendingLocationIds.includes(N)):C==="OnePerCheckpoint"&&A==="Area"?E.includes("ALL_AREAS")?!0:E.some(N=>m.value.includes(N)):(C==="EveryoneInAreas"||C==="OnePerArea"||C==="EveryAreaLead"||C==="OneLeadPerArea")&&A==="Area"?E.includes("ALL_AREAS")?!0:E.some(N=>m.value.includes(N)):!1},_=H(()=>i.allChecklistItems.filter(I=>I.scopeConfigurations&&I.scopeConfigurations.length>0?I.scopeConfigurations.some(C=>y(C)):!1)),b=I=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,EveryoneInAreas:`All in ${o.value.areas}`,OnePerArea:`One per ${o.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${o.value.area}`})[I]||I,S=I=>{if(!I.scopeConfigurations||I.scopeConfigurations.length===0)return"Unknown";const C=I.scopeConfigurations.find(E=>y(E));if(!C)return b(I.scopeConfigurations[0].scope);const A=C.ids||[];return A.includes("ALL_MARSHALS")?"Everyone":A.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:A.includes("ALL_AREAS")?`All ${o.value.areas}`:b(C.scope)},T=I=>{if(!I.scopeConfigurations||I.scopeConfigurations.length===0)return"";const C=I.scopeConfigurations.find(E=>y(E));return C&&{SpecificPeople:"This item is for everyone at the event",EveryoneAtCheckpoints:`This item is for everyone at specified ${o.value.checkpoints}`,OnePerCheckpoint:`One person at each ${o.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${o.value.areas}`,OnePerArea:`One person in each ${o.value.area} needs to complete this`,EveryAreaLead:`This item is for ${o.value.area} leads only`,OneLeadPerArea:`One ${o.value.area} lead needs to complete this`}[C.scope]||""},D=I=>{if(!I.scopeConfigurations||I.scopeConfigurations.length===0)return null;const C=I.scopeConfigurations.find(N=>y(N));if(!C)return null;const A=C.itemType,E=C.ids||[];if(E.includes("ALL_MARSHALS")||E.includes("ALL_CHECKPOINTS")||E.includes("ALL_AREAS"))return null;if(A==="Checkpoint"){const N=i.allLocations.filter($=>E.includes($.id)&&i.pendingLocationIds.includes($.id)).map($=>$.name);if(N.length>0)return`At: ${N.join(", ")}`}if(A==="Area"){const N=i.areas.filter($=>E.includes($.id)&&m.value.includes($.id)).map($=>$.name);if(N.length>0)return`In: ${N.join(", ")}`}return null};return(I,C)=>(v(),g("div",R3,[r("div",O3,[r("p",B3,w(e.isEditing?`Add new ${V(o).checklist} for this ${V(o).person}:`:`${V(o).checklists} that will apply to this ${V(o).person}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:C[0]||(C[0]=A=>a.value=!a.value)},w(a.value?"Cancel":`Add ${V(o).checklist}`),1)]),a.value?(v(),g("div",N3,[Ve(r("input",{"onUpdate:modelValue":C[1]||(C[1]=A=>l.value=A),type:"text",placeholder:`Enter ${V(o).checklist} text...`,class:"add-item-input",onKeyup:Sp(d,["enter"])},null,40,F3),[[nt,l.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim(),onClick:d}," Add ",8,U3)])):P("",!0),u.value.length>0?(v(),g("div",z3,[(v(!0),g(xe,null,Be(u.value,(A,E)=>(v(),g("div",{key:`pending-${E}`,class:"checklist-item pending"},[C[3]||(C[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",H3,[r("div",V3,[r("div",G3,w(A.text),1),r("div",j3,[C[2]||(C[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:N=>p(E),title:"Remove"},"  ",8,Z3)])])])]))),128))])):P("",!0),!e.isEditing&&_.value.length===0&&u.value.length===0?(v(),g("div",q3,[r("p",null,"No "+w(V(o).checklists)+" will apply based on the current "+w(V(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),g("p",W3," Assign "+w(V(o).checkpoints)+" to see relevant "+w(V(o).checklists)+". ",1)):P("",!0)])):P("",!0),!e.isEditing&&_.value.length>0?(v(),g("div",K3,[(v(!0),g(xe,null,Be(_.value,A=>(v(),g("div",{key:A.id,class:"checklist-item"},[C[4]||(C[4]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",Y3,[r("div",J3,[r("div",X3,w(A.text),1),r("div",Q3,[r("span",{class:"scope-pill",title:T(A)},w(S(A)),9,e4)])]),D(A)?(v(),g("div",t4,w(D(A)),1)):P("",!0)])]))),128))])):P("",!0)]))}},o4=ze(n4,[["__scopeId","data-v-6deaacc2"]]),s4={class:"notes-preview"},i4={class:"preview-actions"},a4={class:"preview-header"},l4={key:0,class:"add-item-form"},r4={class:"add-form-fields"},c4=["disabled"],u4={key:1,class:"pending-items"},d4={class:"note-header"},h4={class:"note-title"},f4={class:"note-actions"},p4=["onClick"],v4={key:0,class:"note-content"},m4={key:2,class:"empty-state"},g4={key:0,class:"help-text"},y4={key:3,class:"notes-list"},k4={class:"note-header"},_4={class:"note-title"},b4=["title"],w4={key:0,class:"note-content"},C4={key:1,class:"note-context"},L4={__name:"NotesPreview",props:{allNotes:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=St(),i=e,s=t,a=M(!1),l=M(""),u=M(""),d=M([...i.modelValue]);Ze(()=>i.modelValue,C=>{d.value=[...C]},{deep:!0});const p=()=>{!l.value.trim()&&!u.value.trim()||(d.value.push({title:l.value.trim(),content:u.value.trim(),isNew:!0}),l.value="",u.value="",a.value=!1,m())},f=C=>{d.value.splice(C,1),m()},m=()=>{s("update:modelValue",[...d.value]),s("change")},y=H(()=>{const C=new Set;for(const A of i.pendingLocationIds){const E=i.allLocations.find(N=>N.id===A);E&&(E.areaIds||E.AreaIds||[]).forEach($=>C.add($))}return[...C]}),_=C=>{const A=C.scope,E=C.itemType,N=C.ids||[];return A==="SpecificPeople"&&E==="Marshal"?N.includes("ALL_MARSHALS"):A==="EveryoneAtCheckpoints"&&E==="Checkpoint"?N.includes("ALL_CHECKPOINTS")?!0:N.some($=>i.pendingLocationIds.includes($)):A==="EveryoneInAreas"&&E==="Area"?N.includes("ALL_AREAS")?!0:N.some($=>y.value.includes($)):!1},b=H(()=>i.allNotes.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(A=>_(A)):!1)),S=C=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[C]||C,T=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const A=C.scopeConfigurations.find(N=>_(N));if(!A)return S(C.scopeConfigurations[0].scope);const E=A.ids||[];return E.includes("ALL_MARSHALS")?"Everyone":E.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:E.includes("ALL_AREAS")?`All ${o.value.areas}`:S(A.scope)},D=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const A=C.scopeConfigurations.find(N=>_(N));return A&&{SpecificPeople:"This note is for everyone at the event",EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[A.scope]||""},I=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const A=C.scopeConfigurations.find($=>_($));if(!A)return null;const E=A.itemType,N=A.ids||[];if(N.includes("ALL_MARSHALS")||N.includes("ALL_CHECKPOINTS")||N.includes("ALL_AREAS"))return null;if(E==="Checkpoint"){const $=i.allLocations.filter(G=>N.includes(G.id)&&i.pendingLocationIds.includes(G.id)).map(G=>G.name);if($.length>0)return`At: ${$.join(", ")}`}if(E==="Area"){const $=i.areas.filter(G=>N.includes(G.id)&&y.value.includes(G.id)).map(G=>G.name);if($.length>0)return`In: ${$.join(", ")}`}return null};return(C,A)=>(v(),g("div",s4,[r("div",i4,[r("p",a4,w(e.isEditing?`Add new note for this ${V(o).person}:`:`Notes that will be visible to this ${V(o).person}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:A[0]||(A[0]=E=>a.value=!a.value)},w(a.value?"Cancel":"Add note"),1)]),a.value?(v(),g("div",l4,[r("div",r4,[Ve(r("input",{"onUpdate:modelValue":A[1]||(A[1]=E=>l.value=E),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[nt,l.value]]),Ve(r("textarea",{"onUpdate:modelValue":A[2]||(A[2]=E=>u.value=E),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[nt,u.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim()&&!u.value.trim(),onClick:p}," Add ",8,c4)])):P("",!0),d.value.length>0?(v(),g("div",u4,[(v(!0),g(xe,null,Be(d.value,(E,N)=>(v(),g("div",{key:`pending-${N}`,class:"note-item pending"},[r("div",d4,[r("span",h4,w(E.title||"Untitled"),1),r("div",f4,[A[3]||(A[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:$=>f(N),title:"Remove"},"  ",8,p4)])]),E.content?(v(),g("div",v4,w(E.content),1)):P("",!0)]))),128))])):P("",!0),!e.isEditing&&b.value.length===0&&d.value.length===0?(v(),g("div",m4,[r("p",null,"No notes will be visible based on the current "+w(V(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),g("p",g4," Assign "+w(V(o).checkpoints)+" to see relevant notes. ",1)):P("",!0)])):P("",!0),!e.isEditing&&b.value.length>0?(v(),g("div",y4,[(v(!0),g(xe,null,Be(b.value,E=>(v(),g("div",{key:E.id,class:"note-item"},[r("div",k4,[r("span",_4,w(E.title||"Untitled"),1),r("span",{class:"scope-pill",title:D(E)},w(T(E)),9,b4)]),E.content?(v(),g("div",w4,w(E.content),1)):P("",!0),I(E)?(v(),g("div",C4,w(I(E)),1)):P("",!0)]))),128))])):P("",!0)]))}},S4=ze(L4,[["__scopeId","data-v-e8e0946a"]]),x4={key:6,class:"tab-content incidents-tab"},I4={class:"incidents-list"},$4={class:"custom-footer"},T4={class:"footer-left"},M4={__name:"EditMarshalModal",props:{show:{type:Boolean,default:!1},marshal:{type:Object,default:null},eventId:{type:String,required:!0},assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1},eventNotes:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},incidents:{type:Array,default:()=>[]},validationErrors:{type:Object,default:()=>({})},lockedCheckpointId:{type:String,default:null},zIndex:{type:Number,default:1e3}},emits:["close","save","delete","toggle-check-in","remove-assignment","assign-to-location","update:isDirty","select-incident","select-checkpoint"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=St(),a=e,l=o,u=M("details"),d=M(null),p=M(null),f=M(null),m=M([]),y=M([]),_=M([]),b=M([]),S=M({name:"",email:"",phoneNumber:"",notes:""}),T=H(()=>{const de=a.isEditing?`Edit ${s.value.person}`:`Create ${s.value.person}`,Oe=S.value.name?.trim();return Oe?`${de} - ${Oe}`:de}),D=H(()=>{const de=[{value:"details",label:"Details",icon:"details"},{value:"checkpoints",label:i.value.checkpoints,icon:"checkpoint"},{value:"checklists",label:i.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}];return a.incidents&&a.incidents.length>0&&de.push({value:"incidents",label:"Incidents",icon:"incidents"}),de}),I=H(()=>D.value.findIndex(de=>de.value===u.value)),C=H(()=>I.value===D.value.length-1),A=H(()=>C.value?null:D.value[I.value+1]),E=H(()=>A.value?`${A.value.label}...`:""),N=H(()=>y.value.map(de=>de.locationId)),$=H(()=>a.isEditing?a.assignments:y.value.map(de=>({id:`pending-${de.locationId}`,locationId:de.locationId,locationName:a.allLocations.find(Oe=>Oe.id===de.locationId)?.name||"Unknown",isPending:!0}))),G=H(()=>{if(a.isEditing)return a.availableLocations;const de=y.value.map(Oe=>Oe.locationId);return a.allLocations.filter(Oe=>!de.includes(Oe.id))});Ze(()=>a.marshal,de=>{de?S.value={name:de.name||"",email:de.email||"",phoneNumber:de.phoneNumber||"",notes:de.notes||""}:S.value={name:"",email:"",phoneNumber:"",notes:""}},{immediate:!0,deep:!0}),Ze(()=>a.show,de=>{de&&(u.value="details",m.value=[],y.value=[],_.value=[],b.value=[],a.isEditing||(S.value={name:"",email:"",phoneNumber:"",notes:""}),p.value?.clearPendingChanges&&p.value.clearPendingChanges(),f.value?.resetLocalState&&f.value.resetLocalState())});const R=de=>{S.value=de},Z=()=>{l("update:isDirty",!0)},U=()=>{l("update:isDirty",!0)},K=()=>{A.value&&(u.value=A.value.value)},re=()=>{const de={...S.value,checkInChanges:p.value?.getPendingChanges?.()||[],assignmentsToRemove:p.value?.getMarkedForRemoval?.()||[],checklistChanges:m.value||[],pendingAssignments:a.isEditing?[]:y.value,pendingNewChecklistItems:_.value,pendingNewNotes:b.value};l("save",de)},Pe=()=>{l("delete")},me=de=>{!a.isEditing&&de.isPending?y.value=y.value.filter(Oe=>Oe.locationId!==de.locationId):l("remove-assignment",de)},Ae=de=>{a.isEditing?l("assign-to-location",de):(y.value.push({locationId:de}),l("update:isDirty",!0))},Fe=de=>{l("select-checkpoint",de)},ae=()=>{l("close")};return t({switchToTab:de=>{u.value=de},focusField:de=>{d.value?.focusField&&d.value.focusField(de)}}),(de,Oe)=>(v(),je(zt,{show:e.show,title:T.value,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:ae},{"tab-header":Ue(()=>[Ee(Fa,{modelValue:u.value,"onUpdate:modelValue":Oe[0]||(Oe[0]=Xe=>u.value=Xe),tabs:D.value},null,8,["modelValue","tabs"])]),footer:Ue(()=>[r("div",$4,[r("div",T4,[e.isEditing&&!e.lockedCheckpointId?(v(),g("button",{key:0,type:"button",onClick:Pe,class:"btn btn-danger"}," Delete ")):P("",!0),!e.isEditing&&!C.value?(v(),g("button",{key:1,type:"button",onClick:K,class:"btn btn-secondary mobile-only"},w(E.value),1)):P("",!0)]),r("button",{type:"button",onClick:re,class:"btn btn-success"}," Save ")])]),default:Ue(()=>[u.value==="details"?(v(),je(s3,{key:0,ref_key:"detailsTabRef",ref:d,form:S.value,"event-id":e.eventId,"marshal-id":e.isEditing?e.marshal?.id:null,"validation-errors":e.validationErrors,"onUpdate:form":R,onInput:Z},null,8,["form","event-id","marshal-id","validation-errors"])):P("",!0),u.value==="checkpoints"?(v(),je($3,{key:1,ref_key:"checkpointsTabRef",ref:p,assignments:$.value,"available-locations":G.value,"all-locations":e.allLocations,areas:e.areas,"is-new-marshal":!e.isEditing,"locked-checkpoint-id":e.lockedCheckpointId,onInput:Z,onRemoveAssignment:me,onAssignToLocation:Ae,onSelectCheckpoint:Fe},null,8,["assignments","available-locations","all-locations","areas","is-new-marshal","locked-checkpoint-id"])):P("",!0),u.value==="checklists"&&e.isEditing?(v(),je(D3,{key:2,ref_key:"checklistTabRef",ref:f,modelValue:m.value,"onUpdate:modelValue":Oe[1]||(Oe[1]=Xe=>m.value=Xe),"event-id":e.eventId,"marshal-id":e.marshal.id,locations:e.allLocations,areas:e.areas,onChange:U},null,8,["modelValue","event-id","marshal-id","locations","areas"])):P("",!0),u.value==="checklists"?(v(),je(o4,{key:3,modelValue:_.value,"onUpdate:modelValue":Oe[2]||(Oe[2]=Xe=>_.value=Xe),"all-checklist-items":e.allChecklistItems,"pending-location-ids":N.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:Z},null,8,["modelValue","all-checklist-items","pending-location-ids","all-locations","areas","is-editing"])):P("",!0),u.value==="notes"&&e.isEditing?(v(),je(oc,{key:4,"event-id":e.eventId,"marshal-id":e.marshal?.id,"all-notes":e.eventNotes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","marshal-id","all-notes","locations","areas","assignments"])):P("",!0),u.value==="notes"?(v(),je(S4,{key:5,modelValue:b.value,"onUpdate:modelValue":Oe[3]||(Oe[3]=Xe=>b.value=Xe),"all-notes":e.eventNotes,"pending-location-ids":N.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:Z},null,8,["modelValue","all-notes","pending-location-ids","all-locations","areas","is-editing"])):P("",!0),u.value==="incidents"?(v(),g("div",x4,[r("div",I4,[(v(!0),g(xe,null,Be(e.incidents,Xe=>(v(),je(Fl,{key:Xe.incidentId,incident:Xe,onSelect:Oe[4]||(Oe[4]=et=>de.$emit("select-incident",et))},null,8,["incident"]))),128))])])):P("",!0)]),_:1},8,["show","title","is-dirty","z-index"]))}},A4=ze(M4,[["__scopeId","data-v-dd9a44f3"]]),E4={class:"locations-list"},P4={class:"conflict-actions"},D4={__name:"AssignmentConflictModal",props:{show:{type:Boolean,default:!1},conflictData:{type:Object,default:()=>({marshalName:"",locations:[]})}},emits:["close","choice"],setup(e,{emit:t}){const{terms:o,termsLower:i}=St(),s=t,a=u=>{s("choice",u)},l=()=>{s("close")};return(u,d)=>(v(),je(zt,{show:e.show,title:`${V(o).person} already assigned`,size:"medium","z-index":1100,onClose:l},{actions:Ue(()=>[r("div",P4,[r("button",{onClick:d[0]||(d[0]=p=>a("move")),class:"btn btn-primary btn-full"}," Move to this "+w(V(i).checkpoint)+" (remove from others) ",1),r("button",{onClick:d[1]||(d[1]=p=>a("both")),class:"btn btn-secondary btn-full"}," Assign to both (keep existing assignments) "),r("button",{onClick:d[2]||(d[2]=p=>a("choose-other")),class:"btn btn-secondary btn-full"}," Choose someone else "),r("button",{onClick:d[3]||(d[3]=p=>a("cancel")),class:"btn btn-secondary btn-full"}," Cancel ")])]),default:Ue(()=>[r("p",null,[r("strong",null,w(e.conflictData.marshalName),1),d[4]||(d[4]=Ke(" is currently assigned to: ",-1))]),r("ul",E4,[(v(!0),g(xe,null,Be(e.conflictData.locations,p=>(v(),g("li",{key:p},w(p),1))),128))]),d[5]||(d[5]=r("p",null,"What would you like to do?",-1))]),_:1},8,["show","title"]))}},R4=ze(D4,[["__scopeId","data-v-997e8aaa"]]),O4={key:0,class:"assign-marshal-section"},B4={value:""},N4=["value"],F4=["disabled"],U4={key:1,class:"assign-marshal-section create-mode"},z4={class:"form-group"},H4={class:"form-group"},V4={class:"form-group"},G4={__name:"AssignMarshalModal",props:{show:{type:Boolean,default:!1},locationName:{type:String,default:""},marshals:{type:Array,default:()=>[]}},emits:["close","assign-existing","create-and-assign"],setup(e,{emit:t}){const{termsLower:o}=St(),i=e,s=t,a=M(!1),l=M(""),u=M({name:"",email:"",phoneNumber:""});Ze(()=>i.show,_=>{_||(a.value=!1,l.value="",u.value={name:"",email:"",phoneNumber:""})});const d=()=>{a.value=!0},p=()=>{l.value&&s("assign-existing",l.value)},f=()=>{u.value.name&&s("create-and-assign",{...u.value})},m=()=>{a.value=!1,u.value={name:"",email:"",phoneNumber:""}},y=()=>{s("close")};return(_,b)=>(v(),je(zt,{show:e.show,title:a.value?`Create new ${V(o).person}`:`Assign ${V(o).person} to ${e.locationName}`,size:"medium",onClose:y},{actions:Ue(()=>[a.value?(v(),g(xe,{key:0},[r("button",{onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{onClick:f,class:"btn btn-primary"}," Create & assign ")],64)):P("",!0)]),default:Ue(()=>[a.value?(v(),g("div",U4,[r("h3",null,"Create new "+w(V(o).person),1),r("div",z4,[b[5]||(b[5]=r("label",null,"Name *",-1)),Ve(r("input",{"onUpdate:modelValue":b[1]||(b[1]=S=>u.value.name=S),type:"text",required:"",class:"form-input"},null,512),[[nt,u.value.name]])]),r("div",H4,[b[6]||(b[6]=r("label",null,"Email",-1)),Ve(r("input",{"onUpdate:modelValue":b[2]||(b[2]=S=>u.value.email=S),type:"email",class:"form-input"},null,512),[[nt,u.value.email]])]),r("div",V4,[b[7]||(b[7]=r("label",null,"Phone",-1)),Ve(r("input",{"onUpdate:modelValue":b[3]||(b[3]=S=>u.value.phoneNumber=S),type:"tel",class:"form-input"},null,512),[[nt,u.value.phoneNumber]])])])):(v(),g("div",O4,[r("h3",null,"Select existing "+w(V(o).person),1),Ve(r("select",{"onUpdate:modelValue":b[0]||(b[0]=S=>l.value=S),class:"form-input"},[r("option",B4,"Choose a "+w(V(o).person)+"...",1),(v(!0),g(xe,null,Be(e.marshals,S=>(v(),g("option",{key:S.id,value:S.id},[Ke(w(S.name)+" ",1),S.assignedLocationIds&&S.assignedLocationIds.length>0?(v(),g(xe,{key:0},[Ke(" (assigned to "+w(S.assignedLocationIds.length)+" "+w(S.assignedLocationIds.length>1?V(o).checkpoints:V(o).checkpoint)+") ",1)],64)):P("",!0)],8,N4))),128))],512),[[Dn,l.value]]),r("button",{onClick:p,class:"btn btn-primary btn-full",style:{"margin-top":"1rem"},disabled:!l.value}," Assign selected "+w(V(o).person),9,F4),b[4]||(b[4]=r("div",{class:"divider"},"OR",-1)),r("button",{onClick:d,class:"btn btn-secondary btn-full"}," Create new "+w(V(o).person),1)]))]),_:1},8,["show","title"]))}},j4=ze(G4,[["__scopeId","data-v-fa70b913"]]),Z4={class:"shift-times-content"},q4={class:"info-text"},W4={class:"time-delta-info"},K4={class:"delta-detail"},Y4={class:"delta-detail"},J4={class:"delta-summary"},X4={class:"affected-checkpoints"},Q4={class:"option-selection"},e6={class:"radio-option"},t6={class:"radio-option"},n6={__name:"ShiftCheckpointTimesModal",props:{show:{type:Boolean,default:!1},oldEventDate:{type:String,required:!0},newEventDate:{type:String,required:!0},affectedCheckpointsCount:{type:Number,default:0}},emits:["confirm","cancel"],setup(e,{emit:t}){const{terms:o,termsLower:i}=St(),s=e,a=t,l=M("shift"),u=H(()=>{const y=new Date(s.oldEventDate);return new Date(s.newEventDate)-y}),d=y=>new Date(y).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),p=y=>{const _=Math.abs(y),b=y>=0?"+":"-",S=Math.floor(_/(1e3*60*60*24)),T=Math.floor(_%(1e3*60*60*24)/(1e3*60*60)),D=Math.floor(_%(1e3*60*60)/(1e3*60)),I=[];return S>0&&I.push(`${S}d`),T>0&&I.push(`${T}h`),D>0&&I.push(`${D}m`),`${b}${I.join(" ")}`},f=()=>{a("confirm",{shouldShift:l.value==="shift",timeDelta:u.value})},m=()=>{a("cancel")};return(y,_)=>(v(),je(zt,{show:e.show,title:`Shift ${V(o).checkpoint} Times?`,size:"medium",onClose:m},{actions:Ue(()=>[r("button",{type:"button",onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-primary"},w(l.value==="shift"?"Shift Times":"Keep Times"),1)]),default:Ue(()=>[r("div",Z4,[r("p",q4," You've changed the event date/time. Some "+w(V(i).checkpoints)+" have custom times set. ",1),r("div",W4,[_[2]||(_[2]=r("strong",null,"Event time change:",-1)),r("div",K4," Old: "+w(d(e.oldEventDate)),1),r("div",Y4," New: "+w(d(e.newEventDate)),1),r("div",J4," Delta: "+w(p(u.value)),1)]),r("p",X4,[r("strong",null,w(e.affectedCheckpointsCount)+" "+w(e.affectedCheckpointsCount===1?V(i).checkpoint:V(i).checkpoints),1),_[3]||(_[3]=Ke(" with custom times will be shifted by the same amount. ",-1))]),r("div",Q4,[r("label",e6,[Ve(r("input",{"onUpdate:modelValue":_[0]||(_[0]=b=>l.value=b),type:"radio",value:"shift",name:"shift-option"},null,512),[[Qd,l.value]]),r("div",null,[r("strong",null,"Shift all "+w(V(i).checkpoint)+" times",1),_[4]||(_[4]=r("small",null,"Recommended: Maintains relative timing",-1))])]),r("label",t6,[Ve(r("input",{"onUpdate:modelValue":_[1]||(_[1]=b=>l.value=b),type:"radio",value:"keep",name:"shift-option"},null,512),[[Qd,l.value]]),r("div",null,[r("strong",null,"Keep "+w(V(i).checkpoint)+" times unchanged",1),r("small",null,w(V(o).checkpoint)+" times will stay at their current values",1)])])])])]),_:1},8,["show","title"]))}},o6=ze(n6,[["__scopeId","data-v-a6454aff"]]),s6={class:"search-section"},i6={class:"form-group"},a6={class:"suggestions-list"},l6={class:"suggestion-content"},r6={key:0,class:"suggestion-detail"},c6=["onClick"],u6={class:"suggestion-content"},d6={class:"suggestion-name"},h6={key:0,class:"suggestion-detail"},f6=["onClick"],p6={class:"suggestion-content"},v6={class:"suggestion-name"},m6={key:0,class:"suggestion-detail"},g6={key:1,class:"no-results"},y6={key:2,class:"no-results"},k6={__name:"AddAreaContactModal",props:{show:{type:Boolean,default:!1},areaName:{type:String,default:""},areaId:{type:String,default:""},contacts:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},excludeContactIds:{type:Array,default:()=>[]}},emits:["close","select-contact","create-from-marshal","create-new"],setup(e,{emit:t}){const{terms:o}=St(),i=e,s=t,a=M(""),l=M(null),u=H(()=>i.contacts.filter($=>i.excludeContactIds.includes($.contactId)&&$.marshalId).map($=>$.marshalId)),d=H(()=>i.contacts.filter($=>$.marshalId).map($=>$.marshalId)),p=H(()=>i.contacts.filter($=>!i.excludeContactIds.includes($.contactId))),f=H(()=>i.marshals.filter($=>!u.value.includes($.id)&&!d.value.includes($.id))),m=$=>$?$.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",y=H(()=>{const $=m(a.value);return $?$.split(" ").filter(G=>G.length>0):[]}),_=($,G)=>{if(G.length===0)return{score:1,isPartial:!1};const R=m($);let Z=0;for(const U of G)R.includes(U)&&Z++;return{score:Z,isPartial:Z>0&&Z<G.length,isFullMatch:Z===G.length}},b=H(()=>{const $=y.value,G=[];return p.value.forEach(R=>{const Z=`${R.name||""} ${R.role||""}`,U=_(Z,$);($.length===0||U.score>0)&&G.push({key:`contact-${R.contactId}`,type:"contact",name:R.name,detail:R.role?N(R.role):null,data:R,matchScore:U.score,isPartial:U.isPartial,isFullMatch:U.isFullMatch})}),f.value.forEach(R=>{const Z=`${R.name||""} ${R.email||""}`,U=_(Z,$);($.length===0||U.score>0)&&G.push({key:`marshal-${R.id}`,type:"marshal",name:R.name,detail:R.email||R.phoneNumber||null,data:R,matchScore:U.score,isPartial:U.isPartial,isFullMatch:U.isFullMatch})}),G.sort((R,Z)=>Z.matchScore!==R.matchScore?Z.matchScore-R.matchScore:R.name.localeCompare(Z.name,void 0,{sensitivity:"base"})),G}),S=H(()=>y.value.length===0?b.value:b.value.filter($=>$.isFullMatch)),T=H(()=>y.value.length===0?[]:b.value.filter($=>$.isPartial)),D=H(()=>T.value.length>0);Ze(()=>i.show,async $=>{$&&(a.value="",await qn(),l.value?.focus())});const I=$=>{const G=i.contacts.find(R=>R.marshalId===$.id);if(G){if(i.excludeContactIds.includes(G.contactId))return;s("select-contact",G)}else s("create-from-marshal",$)},C=$=>{s("select-contact",$)},A=()=>{s("create-new",a.value.trim())},E=()=>{s("close")},N=$=>$?$.replace(/([A-Z])/g," $1").replace(/^./,G=>G.toUpperCase()).trim():"";return($,G)=>(v(),je(zt,{show:e.show,title:`Add contact to ${e.areaName}`,size:"medium",onClose:E},{actions:Ue(()=>[r("button",{onClick:E,class:"btn btn-secondary"}," Cancel ")]),default:Ue(()=>[r("div",s6,[r("div",i6,[G[1]||(G[1]=r("label",null,"Search or create",-1)),Ve(r("input",{ref_key:"searchInputRef",ref:l,"onUpdate:modelValue":G[0]||(G[0]=R=>a.value=R),type:"text",class:"form-input",placeholder:"Filter by name..."},null,512),[[nt,a.value]])]),r("div",a6,[r("div",{class:"suggestion-item create-new",onClick:A},[G[3]||(G[3]=r("span",{class:"suggestion-icon create-icon"},"+",-1)),r("div",l6,[G[2]||(G[2]=r("span",{class:"suggestion-name"},"Create new contact",-1)),a.value.trim()?(v(),g("span",r6,'"'+w(a.value.trim())+'"',1)):P("",!0)])]),(v(!0),g(xe,null,Be(S.value,R=>(v(),g("div",{key:R.key,class:"suggestion-item",onClick:Z=>R.type==="marshal"?I(R.data):C(R.data)},[r("span",{class:ue(["suggestion-icon",R.type==="marshal"?"marshal-icon":"contact-icon"])},w(R.type==="marshal"?"M":"C"),3),r("div",u6,[r("span",d6,w(R.name),1),R.detail?(v(),g("span",h6,w(R.detail),1)):P("",!0)]),r("span",{class:ue(["suggestion-badge",{"contact-badge":R.type==="contact"}])},w(R.type==="marshal"?V(o).person:"Contact"),3)],8,c6))),128)),D.value?(v(),g(xe,{key:0},[G[4]||(G[4]=r("div",{class:"suggestion-section-header"},"Partial matches",-1)),(v(!0),g(xe,null,Be(T.value,R=>(v(),g("div",{key:R.key,class:"suggestion-item",onClick:Z=>R.type==="marshal"?I(R.data):C(R.data)},[r("span",{class:ue(["suggestion-icon",R.type==="marshal"?"marshal-icon":"contact-icon"])},w(R.type==="marshal"?"M":"C"),3),r("div",p6,[r("span",v6,w(R.name),1),R.detail?(v(),g("span",m6,w(R.detail),1)):P("",!0)]),r("span",{class:ue(["suggestion-badge",{"contact-badge":R.type==="contact"}])},w(R.type==="marshal"?V(o).person:"Contact"),3)],8,f6))),128))],64)):P("",!0),a.value.trim()&&S.value.length===0&&T.value.length===0?(v(),g("div",g6," No matching "+w(V(o).people.toLowerCase())+" or contacts found. ",1)):P("",!0),!a.value.trim()&&S.value.length===0?(v(),g("div",y6," No "+w(V(o).people.toLowerCase())+" or contacts available to add. ",1)):P("",!0)])])]),_:1},8,["show","title"]))}},_6=ze(k6,[["__scopeId","data-v-e25ca97b"]]),b6={key:0,class:"tab-content"},w6={class:"form-group"},C6=["disabled"],L6={class:"form-group"},S6={key:1,class:"tab-content"},x6={class:"boundary-section"},I6={key:0,class:"boundary-preview"},$6={class:"boundary-actions"},T6={key:2,class:"tab-content"},M6={class:"contacts-header"},A6={class:"section-title"},E6={key:3,class:"tab-content"},P6={class:"section-title"},D6={key:4,class:"placeholder-message"},R6={key:6,class:"placeholder-message"},O6={key:8,class:"placeholder-message"},B6={key:9,class:"tab-content appearance-tab"},N6={class:"accordion-item"},F6=["innerHTML"],U6={class:"accordion-title"},z6={class:"accordion-arrow"},H6={key:0,class:"accordion-content"},V6={class:"section-description"},G6={class:"color-picker"},j6=["title","onClick"],Z6={class:"accordion-item"},q6=["innerHTML"],W6={class:"accordion-title"},K6={class:"accordion-arrow"},Y6={key:0,class:"accordion-content"},J6={class:"section-description"},X6={class:"accordion-item"},Q6={class:"accordion-title"},e5={class:"accordion-preview"},t5={class:"accordion-arrow"},n5={key:0,class:"accordion-content"},o5={class:"section-description"},s5={class:"form-group"},i5={value:""},a5=["value"],l5={class:"accordion-item"},r5={class:"accordion-title"},c5={class:"accordion-preview"},u5={class:"accordion-arrow"},d5={key:0,class:"accordion-content"},h5={class:"section-description"},f5={class:"form-group"},p5={value:""},v5=["value"],m5={key:10,class:"tab-content incidents-tab"},g5={class:"incidents-list"},y5={class:"custom-footer"},k5={class:"footer-left"},Wh="edit_area_accordion",_5={__name:"EditAreaModal",props:{show:{type:Boolean,default:!1},area:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},incidents:{type:Array,default:()=>[]},initialTab:{type:String,default:"details"},route:{type:Array,default:()=>[]}},emits:["close","save","delete","draw-boundary","update:isDirty","select-checkpoint","create-contact-from-marshal","create-new-contact","edit-contact","select-incident"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=St(),a=()=>C.value.peopleTerm?C.value.peopleTerm:d.eventPeopleTerm||"Marshals",l=(Q=!0)=>{const X=C.value.checkpointTerm||d.eventCheckpointTerm||"Checkpoints",O=a();return Q?yv("checkpoint",X,O):Zi("checkpoint",X,O)},u=(Q=!0)=>l(Q).toLowerCase(),d=e,p=o,f=M("details"),m=M(null),y=M([]),_=M({}),b=M({}),S=M(!1),T=M(!1),D=M([]),I=M([]),C=M({name:"",description:"",color:fr,displayOrder:0,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),A=()=>d.eventId?`${Wh}_${d.eventId}`:Wh,E=M({polygonColor:!1,iconStyle:!1,peopleTerm:!1,checkpointTerm:!1});Qt(()=>{const Q=localStorage.getItem(A());if(Q)try{const X=JSON.parse(Q);E.value={...E.value,...X}}catch{}});const N=Q=>{E.value[Q]=!E.value[Q],localStorage.setItem(A(),JSON.stringify(E.value))},$=H(()=>`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <polygon points="4,8 7,3 14,2 20,5 22,12 19,18 12,21 5,19 2,14" fill="${C.value.color||fr}" stroke="#fff" stroke-width="1.5" opacity="0.8"/>
  </svg>`),G=H(()=>{const Q=C.value.checkpointStyleType!=="default"||C.value.checkpointStyleBackgroundShape||C.value.checkpointStyleBackgroundColor||C.value.checkpointStyleBorderColor||C.value.checkpointStyleIconColor||C.value.checkpointStyleSize,X=d.eventDefaultStyleType!=="default"||d.eventDefaultStyleBackgroundShape||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||d.eventDefaultStyleBorderColor||d.eventDefaultStyleIconColor||d.eventDefaultStyleSize;if(!Q&&!X)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="areaDefaultGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981"/>
          <stop offset="50%" style="stop-color:#F59E0B"/>
          <stop offset="100%" style="stop-color:#EF4444"/>
        </linearGradient>
      </defs>
      <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#areaDefaultGrad)" stroke="#fff" stroke-width="1.5"/>
    </svg>`;const O=C.value.checkpointStyleType&&C.value.checkpointStyleType!=="default"?C.value.checkpointStyleType:d.eventDefaultStyleType&&d.eventDefaultStyleType!=="default"?d.eventDefaultStyleType:"default",q=C.value.checkpointStyleBackgroundShape||d.eventDefaultStyleBackgroundShape||"circle",J=C.value.checkpointStyleBackgroundColor||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||"#667eea",$e=C.value.checkpointStyleBorderColor||d.eventDefaultStyleBorderColor||"#ffffff",We=C.value.checkpointStyleIconColor||d.eventDefaultStyleIconColor||"#ffffff",ot=C.value.checkpointStyleSize||d.eventDefaultStyleSize||"100";return wn({type:O!=="default"?O:q,backgroundShape:q,backgroundColor:J,borderColor:$e,iconColor:We,size:ot,outputSize:24})}),R=H(()=>d.area&&d.area.id);H(()=>{if(!C.value.polygon||C.value.polygon.length===0)return{lat:0,lng:0};const Q=C.value.polygon.map(O=>O.lat),X=C.value.polygon.map(O=>O.lng);return{lat:Q.reduce((O,q)=>O+q,0)/Q.length,lng:X.reduce((O,q)=>O+q,0)/X.length}});const Z=H(()=>!C.value.polygon||C.value.polygon.length===0?[]:C.value.polygon.map((Q,X)=>({id:`polygon-point-${X}`,latitude:Q.lat,longitude:Q.lng}))),U=H(()=>d.area?.id?d.areas.filter(Q=>Q.id!==d.area.id).map(Q=>({...Q,color:"#999999"})):d.areas.map(Q=>({...Q,color:"#999999"}))),K=H(()=>Me.value.map(Q=>Q.id)),re=H(()=>{const Q=[{value:"details",label:"Details",icon:"details"},{value:"boundary",label:"Boundary",icon:"area"},{value:"contacts",label:"Contacts",icon:"marshal"},{value:"checkpoints",label:l(),icon:"checkpoint"},{value:"checklists",label:i.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return d.incidents&&d.incidents.length>0&&Q.push({value:"incidents",label:"Incidents",icon:"incidents"}),Q}),Pe=H(()=>re.value.findIndex(Q=>Q.value===f.value)),me=H(()=>Pe.value===re.value.length-1),Ae=H(()=>me.value?null:re.value[Pe.value+1]),Fe=H(()=>Ae.value?`${Ae.value.label}...`:""),ae=H(()=>{if(!d.area||!d.area.id)return[];const Q=d.checkpoints.filter(X=>X.areaIds&&X.areaIds.includes(d.area.id)).map(X=>X.id);return d.assignments.filter(X=>Q.includes(X.locationId))}),Me=H(()=>!d.area||!d.area.id?[]:d.checkpoints.filter(Q=>Q.areaIds&&Q.areaIds.includes(d.area.id))),ge=H(()=>{const Q=[...Me.value];return Q.sort((X,O)=>{const q=X.name.match(/^(\d+)/),J=O.name.match(/^(\d+)/);if(q&&J){const $e=parseInt(q[1]),We=parseInt(J[1]);if($e!==We)return $e-We}return X.name.localeCompare(O.name,void 0,{numeric:!0,sensitivity:"base"})}),Q}),de=H(()=>!d.area||!d.area.id?[]:d.contacts.filter(Q=>Q.scopeConfigurations?Q.scopeConfigurations.some(X=>X.scope==="EveryoneInAreas"&&X.itemType==="Area"?X.ids?.includes("ALL_AREAS")?!0:X.ids?.includes(d.area.id):!1):!1)),Oe=H(()=>{const Q=new Set(de.value.map(q=>q.contactId)),X=de.value.map(q=>({...q,isPending:!1,isExisting:!0,isMarkedForRemoval:I.value.includes(q.contactId)})),O=D.value.filter(q=>!Q.has(q.contactId)).map(q=>({...q,isPending:!0,isExisting:!1,isMarkedForRemoval:!1}));return[...X,...O].sort((q,J)=>q.name.localeCompare(J.name,void 0,{sensitivity:"base"}))}),Xe=H(()=>{const Q=de.value.map(O=>O.contactId),X=D.value.map(O=>O.contactId);return[...Q,...X]}),et=async Q=>{if(!(_.value[Q]||b.value[Q])){b.value[Q]=!0;try{const O=(await Rt.getCheckpointChecklist(d.eventId,Q)).data||[];_.value[Q]={total:O.length,completed:O.filter(q=>q.isCompleted).length}}catch(X){console.error("Failed to load checklist status for checkpoint:",Q,X),_.value[Q]={total:0,completed:0}}finally{b.value[Q]=!1}}};Ze(()=>d.area,Q=>{if(Q){const X=Q.polygon?typeof Q.polygon=="string"?JSON.parse(Q.polygon):Q.polygon:[];C.value={name:Q.name||"",description:Q.description||"",color:Q.color||fr,displayOrder:Q.displayOrder||0,isDefault:Q.isDefault||!1,polygon:X,checkpointStyleType:Q.checkpointStyleType||"default",checkpointStyleColor:Q.checkpointStyleColor||"",checkpointStyleBackgroundShape:Q.checkpointStyleBackgroundShape||"",checkpointStyleBackgroundColor:Q.checkpointStyleBackgroundColor||"",checkpointStyleBorderColor:Q.checkpointStyleBorderColor||"",checkpointStyleIconColor:Q.checkpointStyleIconColor||"",checkpointStyleSize:Q.checkpointStyleSize||"",checkpointStyleMapRotation:Q.checkpointStyleMapRotation??"",peopleTerm:Q.peopleTerm||"",checkpointTerm:Q.checkpointTerm||""}}else C.value={name:"",description:"",color:Gh(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}},{immediate:!0,deep:!0}),Ze(()=>d.show,Q=>{Q&&(f.value=d.initialTab||"details",y.value=[],_.value={},b.value={},D.value=[],I.value=[],T.value=!1,R.value||(C.value={name:"",description:"",color:Gh(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),m.value?.resetLocalState&&m.value.resetLocalState())}),Ze(f,Q=>{Q==="checkpoints"&&d.area&&d.area.id&&Me.value.forEach(X=>{setTimeout(()=>et(X.id),0)})});const qe=()=>{p("update:isDirty",!0)},tt=Q=>{C.value.color=Q,qe()},be=(Q,X)=>{C.value[Q]=X,qe()},He=()=>{p("draw-boundary",C.value)},fe=Q=>{C.value.polygon=Q,qe()},Ie=()=>{C.value.polygon=[],S.value=!1,qe()},Te=Q=>{T.value=!1,p("create-contact-from-marshal",{marshal:Q,area:d.area})},W=Q=>{T.value=!1,p("create-new-contact",{name:Q,area:d.area})},Y=Q=>{D.value.find(X=>X.contactId===Q.contactId)||(D.value.push(Q),qe()),T.value=!1},le=Q=>{D.value=D.value.filter(X=>X.contactId!==Q),qe()},ye=Q=>{I.value.includes(Q)||(I.value.push(Q),qe())},ie=Q=>Q.isPending?"Remove pending contact":`Remove from ${s.value.area}`,oe=Q=>{Oe.value.find(O=>O.contactId===Q)?.isPending?le(Q):ye(Q)},ce=Q=>{I.value=I.value.filter(X=>X!==Q),qe()},De=Q=>{y.value=Q,qe()},we=()=>{Ae.value&&(f.value=Ae.value.value)},te=()=>{const Q=d.area?{name:C.value.name,description:C.value.description,color:C.value.color,polygon:C.value.polygon.length>0?C.value.polygon:null,displayOrder:C.value.displayOrder,checkpointStyleType:C.value.checkpointStyleType,checkpointStyleColor:C.value.checkpointStyleColor,checkpointStyleBackgroundShape:C.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:C.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:C.value.checkpointStyleBorderColor,checkpointStyleIconColor:C.value.checkpointStyleIconColor,checkpointStyleSize:C.value.checkpointStyleSize,checkpointStyleMapRotation:C.value.checkpointStyleMapRotation!=null&&C.value.checkpointStyleMapRotation!==""?String(C.value.checkpointStyleMapRotation):null,peopleTerm:C.value.peopleTerm,checkpointTerm:C.value.checkpointTerm,checklistChanges:y.value||[],pendingContacts:D.value||[],contactsToRemove:I.value||[]}:{name:C.value.name,description:C.value.description,color:C.value.color,polygon:C.value.polygon.length>0?C.value.polygon:null,checkpointStyleType:C.value.checkpointStyleType,checkpointStyleColor:C.value.checkpointStyleColor,checkpointStyleBackgroundShape:C.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:C.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:C.value.checkpointStyleBorderColor,checkpointStyleIconColor:C.value.checkpointStyleIconColor,checkpointStyleSize:C.value.checkpointStyleSize,checkpointStyleMapRotation:C.value.checkpointStyleMapRotation!=null&&C.value.checkpointStyleMapRotation!==""?String(C.value.checkpointStyleMapRotation):null,peopleTerm:C.value.peopleTerm,checkpointTerm:C.value.checkpointTerm,pendingContacts:D.value||[]};p("save",Q)},ke=()=>{p("delete",d.area.id)},se=()=>{p("close")};return t({addPendingContact:Q=>{Q&&!D.value.find(X=>X.contactId===Q.contactId)&&(D.value.push(Q),qe())},removeContactById:Q=>{const X=D.value.some(O=>O.contactId===Q);D.value=D.value.filter(O=>O.contactId!==Q),I.value=I.value.filter(O=>O!==Q),X&&qe()}}),(Q,X)=>(v(),je(zt,{show:e.show,title:e.area&&e.area.id?`Edit ${V(s).area}: ${e.area.name}`:`Create new ${V(s).area}`,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:se},{"tab-header":Ue(()=>[Ee(Fa,{modelValue:f.value,"onUpdate:modelValue":X[0]||(X[0]=O=>f.value=O),tabs:re.value},null,8,["modelValue","tabs"])]),footer:Ue(()=>[r("div",y5,[r("div",k5,[R.value&&!C.value.isDefault?(v(),g("button",{key:0,type:"button",onClick:ke,class:"btn btn-danger"}," Delete ")):P("",!0),!R.value&&!me.value?(v(),g("button",{key:1,type:"button",onClick:we,class:"btn btn-secondary mobile-only"},w(Fe.value),1)):P("",!0)]),r("button",{type:"button",onClick:te,class:"btn btn-success"}," Save ")])]),default:Ue(()=>[f.value==="details"?(v(),g("div",b6,[r("form",{onSubmit:dt(te,["prevent"])},[r("div",w6,[X[25]||(X[25]=r("label",null,"Name *",-1)),Ve(r("input",{"onUpdate:modelValue":X[1]||(X[1]=O=>C.value.name=O),type:"text",required:"",class:"form-input",disabled:C.value.isDefault,onInput:qe},null,40,C6),[[nt,C.value.name]])]),r("div",L6,[X[26]||(X[26]=r("label",null,"Description",-1)),Ve(r("textarea",{"onUpdate:modelValue":X[2]||(X[2]=O=>C.value.description=O),class:"form-input",rows:"3",onInput:qe},null,544),[[nt,C.value.description]])])],32)])):P("",!0),f.value==="boundary"?(v(),g("div",S6,[r("div",x6,[C.value.polygon&&C.value.polygon.length>0?(v(),g("div",I6,[Ee(oa,{mode:"edit-polygon","editing-polygon":C.value.polygon,route:e.route,locations:e.checkpoints,areas:U.value,"highlight-location-ids":K.value,"simplify-non-highlighted":!0,"all-locations-for-bounds":Z.value,height:"300px",onPolygonUpdate:fe},null,8,["editing-polygon","route","locations","areas","highlight-location-ids","all-locations-for-bounds"]),X[27]||(X[27]=r("p",{class:"boundary-hint"},"Drag points to move them. Click a point to delete it (minimum 3 required).",-1))])):P("",!0),r("div",$6,[!C.value.polygon||C.value.polygon.length===0?(v(),g("button",{key:0,onClick:He,class:"btn btn-primary btn-full"}," Draw on map ")):(v(),g(xe,{key:1},[r("button",{onClick:He,class:"btn btn-secondary"}," Redraw "),r("button",{onClick:X[3]||(X[3]=O=>S.value=!0),class:"btn btn-danger"}," Delete boundary ")],64))])])])):P("",!0),Ee(Pa,{show:S.value,title:"Delete boundary",message:"Are you sure you want to delete this boundary? This cannot be undone.","confirm-text":"Delete","is-danger":!0,onConfirm:Ie,onCancel:X[4]||(X[4]=O=>S.value=!1)},null,8,["show"]),f.value==="contacts"?(v(),g("div",T6,[r("div",M6,[r("h3",A6,w(V(i).area)+" contacts ("+w(Oe.value.length)+")",1),r("button",{onClick:X[5]||(X[5]=O=>T.value=!0),class:"btn btn-primary btn-small"}," Add contact ")]),Ee(wv,{contacts:Oe.value,"show-remove-button":!0,"remove-title":ie,"empty-message":`No contacts assigned to this ${V(s).area}.`,"empty-hint":`Click 'Add contact' to assign contacts who will be visible to ${V(s).people} in this ${V(s).area}.`,onSelect:X[6]||(X[6]=O=>Q.$emit("edit-contact",O)),onRemove:oe,onUndoRemove:ce},null,8,["contacts","empty-message","empty-hint"])])):P("",!0),Ee(_6,{show:T.value,"area-name":C.value.name||"this "+V(s).area,"area-id":d.area?.id||"",contacts:d.contacts,marshals:d.marshals,"exclude-contact-ids":Xe.value,onClose:X[7]||(X[7]=O=>T.value=!1),onSelectContact:Y,onCreateFromMarshal:Te,onCreateNew:W},null,8,["show","area-name","area-id","contacts","marshals","exclude-contact-ids"]),f.value==="checkpoints"&&R.value?(v(),g("div",E6,[r("h3",P6,w(l())+" in "+w(e.area?.name)+" ("+w(Me.value.length)+")",1),Ee(xv,{checkpoints:ge.value,areas:e.areas,"empty-message":`No ${u()} in this ${V(s).area} yet.`,onSelect:X[8]||(X[8]=O=>Q.$emit("select-checkpoint",O))},null,8,["checkpoints","areas","empty-message"])])):P("",!0),f.value==="checkpoints"&&!R.value?(v(),g("div",D6,[r("p",null,w(l())+" will be automatically assigned based on boundaries after the "+w(V(s).area)+" is created.",1)])):P("",!0),f.value==="checklists"&&R.value?(v(),je($v,{key:5,ref_key:"checklistTabRef",ref:m,modelValue:y.value,"onUpdate:modelValue":X[9]||(X[9]=O=>y.value=O),"event-id":e.eventId,"area-id":e.area.id,locations:e.allLocations,areas:e.areas,assignments:ae.value,onChange:De},null,8,["modelValue","event-id","area-id","locations","areas","assignments"])):P("",!0),f.value==="checklists"&&!R.value?(v(),g("div",R6,[r("p",null,w(V(i).checklists)+" can be assigned after the "+w(V(s).area)+" is created.",1)])):P("",!0),f.value==="notes"&&R.value?(v(),je(oc,{key:7,"event-id":e.eventId,"area-id":e.area?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","area-id","all-notes","locations","areas","assignments"])):P("",!0),f.value==="notes"&&!R.value?(v(),g("div",O6,[r("p",null,"Notes can be viewed after the "+w(V(s).area)+" is created.",1)])):P("",!0),f.value==="appearance"?(v(),g("div",B6,[r("div",N6,[r("button",{type:"button",class:ue(["accordion-header",{expanded:E.value.polygonColor}]),onClick:X[10]||(X[10]=O=>N("polygonColor"))},[r("div",{class:"accordion-icon",innerHTML:$.value},null,8,F6),r("span",U6,w(V(i).area)+" polygon colour",1),r("span",z6,w(E.value.polygonColor?"":""),1)],2),E.value.polygonColor?(v(),g("div",H6,[r("p",V6," Choose a colour for this "+w(V(s).area)+"'s boundary on the map. ",1),r("div",G6,[(v(!0),g(xe,null,Be(V(fo),O=>(v(),g("div",{key:O.hex,class:ue(["color-swatch",{selected:C.value.color===O.hex}]),style:ut({backgroundColor:O.hex}),title:O.name,onClick:q=>tt(O.hex)},null,14,j6))),128))])])):P("",!0)]),r("div",Z6,[r("button",{type:"button",class:ue(["accordion-header",{expanded:E.value.iconStyle}]),onClick:X[11]||(X[11]=O=>N("iconStyle"))},[r("div",{class:"accordion-icon",innerHTML:G.value},null,8,q6),r("span",W6,w(l(!1))+" marker style",1),r("span",K6,w(E.value.iconStyle?"":""),1)],2),E.value.iconStyle?(v(),g("div",Y6,[r("p",J6," Set a default marker style for all "+w(u())+" in this "+w(V(s).area)+". Individual "+w(u())+" can override this setting. ",1),Ee(ju,{"style-type":C.value.checkpointStyleType||"default","style-color":C.value.checkpointStyleColor||"","style-background-shape":C.value.checkpointStyleBackgroundShape||"","style-background-color":C.value.checkpointStyleBackgroundColor||"","style-border-color":C.value.checkpointStyleBorderColor||"","style-icon-color":C.value.checkpointStyleIconColor||"","style-size":C.value.checkpointStyleSize||"","style-map-rotation":C.value.checkpointStyleMapRotation??"","inherited-style-type":e.eventDefaultStyleType,"inherited-style-color":e.eventDefaultStyleColor,"inherited-background-shape":e.eventDefaultStyleBackgroundShape||"","inherited-background-color":e.eventDefaultStyleBackgroundColor||e.eventDefaultStyleColor||"","inherited-border-color":e.eventDefaultStyleBorderColor||"","inherited-icon-color":e.eventDefaultStyleIconColor||"","inherited-size":e.eventDefaultStyleSize||"","inherited-map-rotation":e.eventDefaultStyleMapRotation??"","default-label":"Event default","icon-label":"Marker style",level:"area","show-preview":!0,"onUpdate:styleType":X[12]||(X[12]=O=>be("checkpointStyleType",O)),"onUpdate:styleColor":X[13]||(X[13]=O=>be("checkpointStyleColor",O)),"onUpdate:styleBackgroundShape":X[14]||(X[14]=O=>be("checkpointStyleBackgroundShape",O)),"onUpdate:styleBackgroundColor":X[15]||(X[15]=O=>be("checkpointStyleBackgroundColor",O)),"onUpdate:styleBorderColor":X[16]||(X[16]=O=>be("checkpointStyleBorderColor",O)),"onUpdate:styleIconColor":X[17]||(X[17]=O=>be("checkpointStyleIconColor",O)),"onUpdate:styleSize":X[18]||(X[18]=O=>be("checkpointStyleSize",O)),"onUpdate:styleMapRotation":X[19]||(X[19]=O=>be("checkpointStyleMapRotation",O))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])])):P("",!0)]),r("div",X6,[r("button",{type:"button",class:ue(["accordion-header",{expanded:E.value.peopleTerm}]),onClick:X[20]||(X[20]=O=>N("peopleTerm"))},[X[28]||(X[28]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("circle",{cx:"12",cy:"8",r:"4",fill:"#6366F1"}),r("path",{d:"M4 20c0-4.4 3.6-8 8-8s8 3.6 8 8",fill:"#6366F1",opacity:"0.6"})])],-1)),r("span",Q6,w(a())+" terminology",1),r("span",e5,w(C.value.peopleTerm||`${e.eventPeopleTerm} (event default)`),1),r("span",t5,w(E.value.peopleTerm?"":""),1)],2),E.value.peopleTerm?(v(),g("div",n5,[r("p",o5," Choose what "+w(a().toLowerCase())+" are called in this "+w(V(s).area)+". This will be inherited by "+w(u())+" unless they override it. ",1),r("div",s5,[X[29]||(X[29]=r("label",null,"What are people called?",-1)),Ve(r("select",{"onUpdate:modelValue":X[21]||(X[21]=O=>C.value.peopleTerm=O),class:"form-input",onChange:qe},[r("option",i5,"Use event default ("+w(e.eventPeopleTerm)+")",1),(v(!0),g(xe,null,Be(V(Bs).people,O=>(v(),g("option",{key:O,value:O},w(O),9,a5))),128))],544),[[Dn,C.value.peopleTerm]])])])):P("",!0)]),r("div",l5,[r("button",{type:"button",class:ue(["accordion-header",{expanded:E.value.checkpointTerm}]),onClick:X[22]||(X[22]=O=>N("checkpointTerm"))},[X[30]||(X[30]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z",fill:"#10B981"}),r("circle",{cx:"12",cy:"9",r:"2.5",fill:"white"})])],-1)),r("span",r5,w(l(!1))+" terminology",1),r("span",c5,w(C.value.checkpointTerm?V(uu)(C.value.checkpointTerm,a()):`${e.eventCheckpointTerm} (event default)`),1),r("span",u5,w(E.value.checkpointTerm?"":""),1)],2),E.value.checkpointTerm?(v(),g("div",d5,[r("p",h5," Choose what "+w(u())+" are called in this "+w(V(s).area)+". ",1),r("div",f5,[r("label",null,"What are "+w(u())+" called?",1),Ve(r("select",{"onUpdate:modelValue":X[23]||(X[23]=O=>C.value.checkpointTerm=O),class:"form-input",onChange:qe},[r("option",p5,"Use event default ("+w(e.eventCheckpointTerm)+")",1),(v(!0),g(xe,null,Be(V(Bs).checkpoint,O=>(v(),g("option",{key:O,value:O},w(V(uu)(O,a())),9,v5))),128))],544),[[Dn,C.value.checkpointTerm]])])])):P("",!0)])])):P("",!0),f.value==="incidents"?(v(),g("div",m5,[r("div",g5,[(v(!0),g(xe,null,Be(e.incidents,O=>(v(),je(Fl,{key:O.incidentId,incident:O,onSelect:X[24]||(X[24]=q=>Q.$emit("select-incident",q))},null,8,["incident"]))),128))])])):P("",!0)]),_:1},8,["show","title","is-dirty"]))}},b5=ze(_5,[["__scopeId","data-v-8daa5ea1"]]),w5=["innerHTML"],C5={__name:"InfoModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Information"},message:{type:String,required:!0},okText:{type:String,default:"OK"}},emits:["close"],setup(e,{emit:t}){const o=t,i=()=>{o("close")};return(s,a)=>(v(),je(zt,{show:e.show,title:e.title,size:"small","z-index":2e3,onClose:i},{actions:Ue(()=>[r("button",{onClick:i,class:"btn btn-primary"},w(e.okText),1)]),default:Ue(()=>[r("div",{class:"info-content",innerHTML:e.message},null,8,w5)]),_:1},8,["show","title"]))}},sc=ze(C5,[["__scopeId","data-v-a6e7148c"]]),L5={class:"tab-content"},S5={class:"form-group"},x5=["placeholder"],I5={key:0,class:"checkbox-label-inline create-separate-items"},$5={class:"tab-content"},T5={class:"custom-footer"},M5={class:"footer-left"},A5={__name:"EditChecklistItemModal",props:{show:{type:Boolean,default:!1},checklistItem:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=M(!1),a=M(""),l=M("details"),u=M({text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0}),d=H(()=>!!o.checklistItem),p=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],f=H(()=>p.findIndex(E=>E.value===l.value)),m=H(()=>f.value===p.length-1),y=H(()=>m.value?"":p[f.value+1]?.label||"");Ze(()=>o.show,E=>{E&&(l.value=o.initialTab,o.checklistItem?u.value={text:o.checklistItem.text||"",scopeConfigurations:o.checklistItem.scopeConfigurations?JSON.parse(JSON.stringify(o.checklistItem.scopeConfigurations)):[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:o.checklistItem.displayOrder||0,isRequired:o.checklistItem.isRequired!==!1,visibleFrom:o.checklistItem.visibleFrom?_(o.checklistItem.visibleFrom):null,visibleUntil:o.checklistItem.visibleUntil?_(o.checklistItem.visibleUntil):null,mustCompleteBy:o.checklistItem.mustCompleteBy?_(o.checklistItem.mustCompleteBy):null,createSeparateItems:!1}:u.value={text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0},i("update:isDirty",!1))});const _=E=>{if(!E)return null;const N=new Date(E),$=N.getTimezoneOffset();return new Date(N.getTime()-$*60*1e3).toISOString().slice(0,16)},b=E=>E?new Date(E).toISOString():null,S=()=>{i("update:isDirty",!0)},T=()=>{i("close")},D=()=>{m.value||(l.value=p[f.value+1].value)},I=E=>{a.value=E,s.value=!0},C=()=>{if(!u.value.text||!u.value.text.trim()){I("Please enter checklist item text");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){I("Please select at least one scope");return}if(!u.value.scopeConfigurations.some($=>!($.itemType!==null&&(!$.ids||$.ids.length===0)))){I("Please configure at least one scope with valid selections");return}const N={text:u.value.text,scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,isRequired:u.value.isRequired,visibleFrom:b(u.value.visibleFrom),visibleUntil:b(u.value.visibleUntil),mustCompleteBy:b(u.value.mustCompleteBy)};d.value||(N.createSeparateItems=u.value.createSeparateItems),i("save",N)},A=()=>{i("delete",o.checklistItem.itemId)};return(E,N)=>(v(),g(xe,null,[Ee(zt,{show:e.show,title:d.value?"Edit checklist item":"Create checklist item",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:T},{"tab-header":Ue(()=>[Ee(Fa,{modelValue:l.value,"onUpdate:modelValue":N[0]||(N[0]=$=>l.value=$),tabs:p},null,8,["modelValue"])]),footer:Ue(()=>[r("div",T5,[r("div",M5,[d.value?(v(),g("button",{key:0,type:"button",onClick:A,class:"btn btn-danger"}," Delete ")):P("",!0),!d.value&&!m.value?(v(),g("button",{key:1,type:"button",onClick:D,class:"btn btn-secondary mobile-only"},w(y.value)+"... ",1)):P("",!0)]),r("button",{type:"button",onClick:C,class:"btn btn-success"}," Save ")])]),default:Ue(()=>[r("form",{onSubmit:dt(C,["prevent"]),class:"checklist-form"},[Ve(r("div",L5,[r("div",S5,[N[6]||(N[6]=r("label",{for:"text"},"Checklist text: *",-1)),Ve(r("textarea",{id:"text","onUpdate:modelValue":N[1]||(N[1]=$=>u.value.text=$),onInput:S,required:"",rows:"3",placeholder:u.value.createSeparateItems?"Enter checklist items, one per line...":"Enter the checklist item text..."},null,40,x5),[[nt,u.value.text]]),d.value?P("",!0):(v(),g("label",I5,[Ve(r("input",{type:"checkbox","onUpdate:modelValue":N[2]||(N[2]=$=>u.value.createSeparateItems=$),onChange:S},null,544),[[Zr,u.value.createSeparateItems]]),N[5]||(N[5]=r("span",null,"Each line creates a new item",-1))]))])],512),[[bi,l.value==="details"]]),Ve(r("div",$5,[Ee(nc,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":N[3]||(N[3]=$=>u.value.scopeConfigurations=$),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":d.value,onUserChanged:S},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[bi,l.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ee(sc,{show:s.value,title:"Validation error",message:a.value,onClose:N[4]||(N[4]=$=>s.value=!1)},null,8,["show","message"])],64))}},E5=ze(A5,[["__scopeId","data-v-1384b208"]]),P5={class:"tab-content"},D5={class:"form-group"},R5={class:"form-group"},O5={class:"form-row"},B5={class:"form-group"},N5={class:"form-group"},F5={class:"form-row"},U5={class:"form-group"},z5={class:"form-group checkbox-group-inline"},H5={class:"checkbox-label-inline"},V5={class:"tab-content"},G5={class:"custom-footer"},j5={class:"footer-left"},Z5={__name:"EditNoteModal",props:{show:{type:Boolean,default:!1},note:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=M(!1),a=M(""),l=M("details"),u=M({title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1}),d=H(()=>!!o.note),p=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],f=H(()=>p.findIndex(C=>C.value===l.value)),m=H(()=>f.value===p.length-1),y=H(()=>m.value?"":p[f.value+1]?.label||"");Ze(()=>o.show,C=>{C&&(l.value=o.initialTab,o.note?u.value={title:o.note.title||"",content:o.note.content||"",scopeConfigurations:o.note.scopeConfigurations?JSON.parse(JSON.stringify(o.note.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:o.note.displayOrder||0,priority:o.note.priority||"Normal",category:o.note.category||"",isPinned:o.note.isPinned||!1}:u.value={title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1},i("update:isDirty",!1))});const _=()=>{i("update:isDirty",!0)},b=()=>{i("close")},S=()=>{m.value||(l.value=p[f.value+1].value)},T=C=>{a.value=C,s.value=!0},D=()=>{if(!u.value.title||!u.value.title.trim()){T("Please enter a note title");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){T("Please select at least one visibility scope");return}if(!u.value.scopeConfigurations.some(E=>!(E.itemType!==null&&(!E.ids||E.ids.length===0)))){T("Please configure at least one scope with valid selections");return}const A={title:u.value.title.trim(),content:u.value.content||"",scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,priority:u.value.priority||"Normal",category:u.value.category?.trim()||null,isPinned:u.value.isPinned||!1};i("save",A)},I=()=>{i("delete",o.note.noteId)};return(C,A)=>(v(),g(xe,null,[Ee(zt,{show:e.show,title:d.value?"Edit note":"Create note",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:b},{"tab-header":Ue(()=>[Ee(Fa,{modelValue:l.value,"onUpdate:modelValue":A[0]||(A[0]=E=>l.value=E),tabs:p},null,8,["modelValue"])]),footer:Ue(()=>[r("div",G5,[r("div",j5,[d.value?(v(),g("button",{key:0,type:"button",onClick:I,class:"btn btn-danger"}," Delete ")):P("",!0),!d.value&&!m.value?(v(),g("button",{key:1,type:"button",onClick:S,class:"btn btn-secondary mobile-only"},w(y.value)+"... ",1)):P("",!0)]),r("button",{type:"button",onClick:D,class:"btn btn-success"}," Save ")])]),default:Ue(()=>[r("form",{onSubmit:dt(D,["prevent"]),class:"note-form"},[Ve(r("div",P5,[r("div",D5,[A[9]||(A[9]=r("label",{for:"title"},"Title: *",-1)),Ve(r("input",{id:"title","onUpdate:modelValue":A[1]||(A[1]=E=>u.value.title=E),type:"text",onInput:_,required:"",placeholder:"Enter note title..."},null,544),[[nt,u.value.title]])]),r("div",R5,[A[10]||(A[10]=r("label",{for:"content"},"Content:",-1)),Ve(r("textarea",{id:"content","onUpdate:modelValue":A[2]||(A[2]=E=>u.value.content=E),onInput:_,rows:"6",placeholder:"Enter note content (supports markdown)..."},null,544),[[nt,u.value.content]])]),r("div",O5,[r("div",B5,[A[12]||(A[12]=r("label",{for:"priority"},"Priority:",-1)),Ve(r("select",{id:"priority","onUpdate:modelValue":A[3]||(A[3]=E=>u.value.priority=E),onChange:_},[...A[11]||(A[11]=[r("option",{value:"Emergency"},"Emergency",-1),r("option",{value:"Urgent"},"Urgent",-1),r("option",{value:"High"},"High",-1),r("option",{value:"Normal"},"Normal",-1),r("option",{value:"Low"},"Low",-1)])],544),[[Dn,u.value.priority]])]),r("div",N5,[A[13]||(A[13]=r("label",{for:"category"},"Category:",-1)),Ve(r("input",{id:"category","onUpdate:modelValue":A[4]||(A[4]=E=>u.value.category=E),type:"text",onInput:_,placeholder:"e.g., Safety, Logistics..."},null,544),[[nt,u.value.category]])])]),r("div",F5,[r("div",U5,[A[14]||(A[14]=r("label",{for:"displayOrder"},"Display order:",-1)),Ve(r("input",{id:"displayOrder","onUpdate:modelValue":A[5]||(A[5]=E=>u.value.displayOrder=E),type:"number",onInput:_,min:"0"},null,544),[[nt,u.value.displayOrder,void 0,{number:!0}]]),A[15]||(A[15]=r("span",{class:"help-text"},"Lower numbers appear first",-1))]),r("div",z5,[r("label",H5,[Ve(r("input",{type:"checkbox","onUpdate:modelValue":A[6]||(A[6]=E=>u.value.isPinned=E),onChange:_},null,544),[[Zr,u.value.isPinned]]),A[16]||(A[16]=r("span",null,"Pin to top",-1))]),A[17]||(A[17]=r("span",{class:"help-text"},"Pinned notes always appear at the top",-1))])])],512),[[bi,l.value==="details"]]),Ve(r("div",V5,[Ee(nc,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":A[7]||(A[7]=E=>u.value.scopeConfigurations=E),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":d.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this note?",onUserChanged:_},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[bi,l.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ee(sc,{show:s.value,title:"Validation error",message:a.value,onClose:A[8]||(A[8]=E=>s.value=!1)},null,8,["show","message"])],64))}},q5=ze(Z5,[["__scopeId","data-v-aa4ca951"]]),W5={class:"incident-detail-header"},K5={class:"header-title-row"},Y5={class:"modal-title"},J5={class:"header-badges"},X5=["disabled"],Q5={key:0,class:"status-dropdown-menu"},eD=["onClick","disabled"],tD={key:0,class:"incident-detail-content"},nD={class:"accordion-section"},oD={class:"accordion-arrow"},sD={key:0,class:"accordion-content"},iD={class:"description-text"},aD={class:"accordion-section"},lD={class:"accordion-arrow"},rD={key:0,class:"accordion-content"},cD={class:"info-grid"},uD={class:"info-item"},dD={class:"info-value"},hD={class:"info-item"},fD={class:"info-value"},pD={key:0,class:"info-item"},vD={class:"info-value"},mD={key:1,class:"info-item"},gD={class:"info-value"},yD={key:2,class:"info-item"},kD={class:"info-value"},_D={key:0,class:"incident-map-container"},bD={class:"accordion-section"},wD={class:"accordion-preview"},CD={class:"accordion-arrow"},LD={key:0,class:"accordion-content"},SD={class:"reporter-info"},xD={class:"reporter-name"},ID={key:0,class:"accordion-section"},$D={class:"accordion-preview"},TD={class:"accordion-arrow"},MD={key:0,class:"accordion-content"},AD={class:"marshals-list"},ED={class:"marshal-name"},PD={key:0,class:"checkin-badge success"},DD={key:1,class:"checkin-badge not-checked-in"},RD={class:"accordion-section"},OD={key:0,class:"accordion-preview"},BD={class:"accordion-arrow"},ND={key:0,class:"accordion-content"},FD={key:0,class:"notes-timeline"},UD={class:"note-header"},zD={class:"note-author"},HD={class:"note-time"},VD={key:0,class:"note-status-change"},GD={key:1,class:"note-text"},jD={key:1,class:"no-notes"},ZD={__name:"IncidentDetailModal",props:{show:{type:Boolean,required:!0},incident:{type:Object,default:null},canManage:{type:Boolean,default:!1},route:{type:Array,default:()=>[]},checkpoints:{type:Array,default:()=>[]}},emits:["close","status-change","open-add-note"],setup(e,{emit:t}){const o=e,i=t,s=M(!1),a=M(!1),l=M(null),u=M({description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1});Ze(()=>o.show,G=>{G&&(u.value={description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1},a.value=!1)});const d=G=>{l.value&&!l.value.contains(G.target)&&(a.value=!1)};Ze(a,G=>{G?document.addEventListener("click",d):document.removeEventListener("click",d)});const p=()=>{a.value=!a.value},f=G=>{o.incident?.status!==G&&(a.value=!1,$(G))},m=G=>{const R=u.value[G];Object.keys(u.value).forEach(Z=>{u.value[Z]=!1}),R||(u.value[G]=!0)},y=H(()=>o.incident?.latitude!=null&&o.incident?.longitude!=null),_=H(()=>y.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),b=H(()=>y.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),S=H(()=>{if(!o.incident)return"Incident Details";if(o.incident.title)return o.incident.title;const G=o.incident.description||"";return G.length<=50?G:G.substring(0,47)+"..."}),T=H(()=>[...o.incident?.context?.marshalsPresentAtCheckpoint||[]].sort((R,Z)=>(R.name||"").localeCompare(Z.name||"",void 0,{sensitivity:"base"}))),D=[{value:"open",label:"Open"},{value:"acknowledged",label:"Acknowledged"},{value:"in_progress",label:"In Progress"},{value:"resolved",label:"Resolved"},{value:"closed",label:"Closed"}],I=G=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[G]||G,C=G=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[G]||G,A=G=>{if(!G)return"";let R=G.name||"";if(G.description){const Z=G.description,U=40,K=Z.length>U?Z.substring(0,U-3)+"...":Z;R+=` - ${K}`}return R},E=G=>G?new Date(G).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",N=G=>{if(!G)return"";const R=new Date(G),U=new Date-R,K=Math.floor(U/6e4),re=Math.floor(U/36e5),Pe=Math.floor(U/864e5);return K<1?"just now":K<60?`${K}m ago`:re<24?`${re}h ago`:Pe<7?`${Pe}d ago`:R.toLocaleDateString()},$=async G=>{if(o.incident?.status!==G){s.value=!0;try{i("status-change",{incidentId:o.incident.incidentId,status:G})}finally{s.value=!1}}};return(G,R)=>(v(),je(zt,{show:e.show,title:S.value,size:"large",onClose:R[7]||(R[7]=Z=>G.$emit("close"))},{header:Ue(()=>[r("div",W5,[r("div",K5,[r("span",{class:ue(["severity-indicator",e.incident?.severity])},null,2),r("h2",Y5,w(S.value),1)]),r("div",J5,[r("span",{class:ue(["severity-badge",e.incident?.severity])},w(I(e.incident?.severity)),3),e.canManage?(v(),g("div",{key:0,class:"status-dropdown-container",ref_key:"statusDropdownRef",ref:l},[r("button",{type:"button",class:ue(["status-badge status-dropdown-trigger",e.incident?.status]),onClick:p,disabled:s.value},[Ke(w(C(e.incident?.status))+" ",1),R[8]||(R[8]=r("span",{class:"dropdown-arrow"},"",-1))],10,X5),a.value?(v(),g("div",Q5,[(v(),g(xe,null,Be(D,Z=>r("button",{key:Z.value,type:"button",class:ue(["status-dropdown-item",{active:e.incident?.status===Z.value}]),onClick:U=>f(Z.value),disabled:e.incident?.status===Z.value},[r("span",{class:ue(["status-dot",Z.value])},null,2),Ke(" "+w(Z.label),1)],10,eD)),64))])):P("",!0)],512)):(v(),g("span",{key:1,class:ue(["status-badge",e.incident?.status])},w(C(e.incident?.status)),3))])])]),footer:Ue(()=>[r("button",{class:"btn btn-secondary",onClick:R[6]||(R[6]=Z=>G.$emit("close"))},"Close")]),default:Ue(()=>[e.incident?(v(),g("div",tD,[r("div",nD,[r("button",{type:"button",class:ue(["accordion-header",{expanded:u.value.description}]),onClick:R[0]||(R[0]=Z=>m("description"))},[R[9]||(R[9]=r("span",{class:"accordion-title"},"Description",-1)),r("span",oD,w(u.value.description?"":""),1)],2),u.value.description?(v(),g("div",sD,[r("p",iD,w(e.incident.description),1)])):P("",!0)]),r("div",aD,[r("button",{type:"button",class:ue(["accordion-header",{expanded:u.value.timeLocation}]),onClick:R[1]||(R[1]=Z=>m("timeLocation"))},[R[10]||(R[10]=r("span",{class:"accordion-title"},"Time & location",-1)),r("span",lD,w(u.value.timeLocation?"":""),1)],2),u.value.timeLocation?(v(),g("div",rD,[r("div",cD,[r("div",uD,[R[11]||(R[11]=r("span",{class:"info-label"},"Incident time",-1)),r("span",dD,w(E(e.incident.incidentTime)),1)]),r("div",hD,[R[12]||(R[12]=r("span",{class:"info-label"},"Reported at",-1)),r("span",fD,w(E(e.incident.createdAt)),1)]),e.incident.context?.checkpoint?(v(),g("div",pD,[R[13]||(R[13]=r("span",{class:"info-label"},"Checkpoint",-1)),r("span",vD,w(A(e.incident.context.checkpoint)),1)])):P("",!0),e.incident.area?(v(),g("div",mD,[R[14]||(R[14]=r("span",{class:"info-label"},"Area",-1)),r("span",gD,w(e.incident.area.areaName),1)])):P("",!0),y.value?(v(),g("div",yD,[R[15]||(R[15]=r("span",{class:"info-label"},"GPS location",-1)),r("span",kD,w(e.incident.latitude.toFixed(6))+", "+w(e.incident.longitude.toFixed(6)),1)])):P("",!0)]),y.value?(v(),g("div",_D,[Ee(oa,{locations:e.checkpoints,route:e.route,center:_.value,zoom:15,"user-location":b.value,height:"200px"},null,8,["locations","route","center","user-location"])])):P("",!0)])):P("",!0)]),r("div",bD,[r("button",{type:"button",class:ue(["accordion-header",{expanded:u.value.reporter}]),onClick:R[2]||(R[2]=Z=>m("reporter"))},[R[16]||(R[16]=r("span",{class:"accordion-title"},"Reported by",-1)),r("span",wD,w(e.incident.reportedBy?.name||"Unknown"),1),r("span",CD,w(u.value.reporter?"":""),1)],2),u.value.reporter?(v(),g("div",LD,[r("div",SD,[r("span",xD,w(e.incident.reportedBy?.name||"Unknown"),1)])])):P("",!0)]),T.value.length?(v(),g("div",ID,[r("button",{type:"button",class:ue(["accordion-header",{expanded:u.value.marshals}]),onClick:R[3]||(R[3]=Z=>m("marshals"))},[R[17]||(R[17]=r("span",{class:"accordion-title"},"Marshals at checkpoint",-1)),r("span",$D,w(T.value.length),1),r("span",TD,w(u.value.marshals?"":""),1)],2),u.value.marshals?(v(),g("div",MD,[r("div",AD,[(v(!0),g(xe,null,Be(T.value,Z=>(v(),g("div",{key:Z.marshalId,class:ue(["marshal-item",{"checked-in":Z.wasCheckedIn}])},[r("span",ED,w(Z.name),1),Z.wasCheckedIn?(v(),g("span",PD," Checked in "+w(N(Z.checkInTime)),1)):(v(),g("span",DD," Not checked in "))],2))),128))])])):P("",!0)])):P("",!0),r("div",RD,[r("button",{type:"button",class:ue(["accordion-header",{expanded:u.value.notes}]),onClick:R[4]||(R[4]=Z=>m("notes"))},[R[18]||(R[18]=r("span",{class:"accordion-title"},"Updates",-1)),e.incident.updates?.length?(v(),g("span",OD,w(e.incident.updates.length),1)):P("",!0),r("span",BD,w(u.value.notes?"":""),1)],2),u.value.notes?(v(),g("div",ND,[e.incident.updates?.length?(v(),g("div",FD,[(v(!0),g(xe,null,Be(e.incident.updates,(Z,U)=>(v(),g("div",{key:U,class:"note-item"},[r("div",UD,[r("span",zD,w(Z.authorName||"System"),1),r("span",HD,w(N(Z.timestamp)),1)]),Z.statusChange?(v(),g("div",VD,[R[19]||(R[19]=Ke(" Status changed to ",-1)),r("span",{class:ue(["status-badge",Z.statusChange])},w(C(Z.statusChange)),3)])):Z.note?(v(),g("p",GD,w(Z.note),1)):P("",!0)]))),128))])):(v(),g("div",jD," No updates yet. ")),r("button",{type:"button",class:"btn btn-primary add-note-btn",onClick:R[5]||(R[5]=Z=>G.$emit("open-add-note"))}," Add update ")])):P("",!0)])])):P("",!0)]),_:1},8,["show","title"]))}},Tv=ze(ZD,[["__scopeId","data-v-442b7089"]]),qD={class:"form-group"},WD={class:"form-group"},KD={class:"form-row"},YD={class:"form-group form-group-half"},JD=["value"],XD={class:"form-group form-group-half"},QD={key:0,class:"form-group"},e8=["value"],t8={key:1,class:"form-group"},n8={class:"checkpoint-toggle"},o8={class:"checkbox-label"},s8={class:"checkpoint-name"},i8={key:0,class:"checkpoint-description"},a8={class:"form-group"},l8={class:"location-options"},r8={class:"location-buttons"},c8={key:0,class:"location-status"},u8={key:0,class:"location-getting"},d8={key:1,class:"location-display"},h8={key:0,class:"location-accuracy"},f8={key:2,class:"location-error"},p8={key:1,class:"map-picker-container"},v8={key:0,class:"map-picker-hint"},m8={key:2,class:"location-display"},g8={key:2,class:"error-message"},y8={class:"modal-actions"},k8=["disabled"],_8={__name:"ReportIncidentModal",props:{show:{type:Boolean,required:!0},eventId:{type:String,required:!0},checkpoint:{type:Object,default:null},initialLocation:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]}},emits:["close","submit"],setup(e,{emit:t}){const o=e,i=t,s=M({title:"",description:"",severity:"medium",incidentTime:""}),a=M(""),l=M(!0),u=M("none"),d=M(!1),p=M(null),f=M(null),m=M(null),y=M(!1),_=M(!1),b=M(null),S=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],T=()=>{const U=new Date,K=U.getFullYear(),re=String(U.getMonth()+1).padStart(2,"0"),Pe=String(U.getDate()).padStart(2,"0"),me=String(U.getHours()).padStart(2,"0"),Ae=String(U.getMinutes()).padStart(2,"0");return`${K}-${re}-${Pe}T${me}:${Ae}`},D=U=>U?new Date(U).toISOString():null,I=H(()=>o.checkpoints||[]),C=H(()=>{if(p.value?.latitude!=null)return{lat:p.value.latitude,lng:p.value.longitude};if(a.value){const U=I.value.find(K=>K.id===a.value);if(U?.latitude!=null)return{lat:U.latitude,lng:U.longitude}}if(o.initialLocation?.latitude!=null)return{lat:o.initialLocation.latitude,lng:o.initialLocation.longitude};if(o.checkpoint?.latitude!=null)return{lat:o.checkpoint.latitude,lng:o.checkpoint.longitude};if(I.value.length>0){const U=I.value[0];if(U.latitude!=null)return{lat:U.latitude,lng:U.longitude}}if(o.route?.length>0){const U=o.route[0];if(U?.lat!=null)return{lat:U.lat,lng:U.lng}}return{lat:-33.9,lng:151.2}}),A=H(()=>s.value.description.trim()!==""),E=H(()=>s.value.description.trim()!=="");Ze(()=>o.show,U=>{U&&(s.value={title:"",description:"",severity:"medium",incidentTime:T()},a.value="",l.value=!0,_.value=!1,b.value=null,m.value=null,p.value=null,f.value=null,o.initialLocation&&o.initialLocation.latitude!=null?(p.value={latitude:o.initialLocation.latitude,longitude:o.initialLocation.longitude},f.value=o.initialLocation.accuracy,u.value="gps",d.value=!1):(u.value="none",d.value=!1),o.checkpoint&&(a.value=o.checkpoint.locationId||o.checkpoint.id||""))});const N=U=>{m.value=null,U==="map"?u.value==="map"?d.value=!d.value:(u.value="map",d.value=!0,f.value=null):U==="gps"?(u.value="gps",d.value=!1,G()):(u.value="none",d.value=!1,p.value=null,f.value=null)},$=U=>{p.value={latitude:U.lat,longitude:U.lng},f.value=null,d.value=!1},G=()=>{if(o.initialLocation&&o.initialLocation.latitude!=null){p.value={latitude:o.initialLocation.latitude,longitude:o.initialLocation.longitude},f.value=o.initialLocation.accuracy;return}if(!navigator.geolocation){m.value="GPS is not available on this device.";return}y.value=!0,navigator.geolocation.getCurrentPosition(U=>{p.value={latitude:U.coords.latitude,longitude:U.coords.longitude},f.value=U.coords.accuracy,y.value=!1},U=>{m.value="Unable to get your location.",y.value=!1},{enableHighAccuracy:!0,timeout:1e4})},R=async()=>{if(!(!E.value||_.value)){_.value=!0,b.value=null;try{const U=(u.value==="gps"||u.value==="map")&&p.value;let K=null,re=!1;I.value.length>0?a.value?K=a.value:re=!0:o.checkpoint&&(l.value?K=o.checkpoint.locationId||o.checkpoint.id||null:re=!0);const Pe={title:s.value.title.trim()||null,description:s.value.description.trim(),severity:s.value.severity,incidentTime:D(s.value.incidentTime),latitude:U?p.value.latitude:null,longitude:U?p.value.longitude:null,checkpointId:K,skipCheckpointAutoAssign:re};i("submit",Pe)}catch(U){b.value=U.message||"Failed to report incident. Please try again.",_.value=!1}}},Z=()=>{i("close")};return(U,K)=>(v(),je(zt,{show:e.show,title:"Report Incident",size:"medium","confirm-on-close":!0,"is-dirty":A.value,onClose:Z},{footer:Ue(()=>[r("div",y8,[r("button",{type:"button",class:"btn btn-secondary",onClick:Z}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:R,disabled:!E.value||_.value},w(_.value?"Reporting...":"Report Incident"),9,k8)])]),default:Ue(()=>[r("form",{onSubmit:dt(R,["prevent"]),class:"incident-form"},[r("div",qD,[K[10]||(K[10]=r("label",{for:"title",class:"form-label"},"Title",-1)),Ve(r("input",{id:"title","onUpdate:modelValue":K[0]||(K[0]=re=>s.value.title=re),type:"text",class:"form-input",placeholder:"Brief summary (optional)"},null,512),[[nt,s.value.title]])]),r("div",WD,[K[11]||(K[11]=r("label",{for:"description",class:"form-label"},[Ke("Description "),r("span",{class:"required"},"*")],-1)),Ve(r("textarea",{id:"description","onUpdate:modelValue":K[1]||(K[1]=re=>s.value.description=re),class:"form-input form-textarea",placeholder:"Describe what happened...",rows:"3",required:""},null,512),[[nt,s.value.description]])]),r("div",KD,[r("div",YD,[K[12]||(K[12]=r("label",{for:"severity",class:"form-label"},"Severity",-1)),Ve(r("select",{id:"severity","onUpdate:modelValue":K[2]||(K[2]=re=>s.value.severity=re),class:"form-input form-select"},[(v(),g(xe,null,Be(S,re=>r("option",{key:re.value,value:re.value},w(re.label),9,JD)),64))],512),[[Dn,s.value.severity]])]),r("div",XD,[K[13]||(K[13]=r("label",{for:"incidentTime",class:"form-label"},"When",-1)),Ve(r("input",{id:"incidentTime","onUpdate:modelValue":K[3]||(K[3]=re=>s.value.incidentTime=re),type:"datetime-local",class:"form-input"},null,512),[[nt,s.value.incidentTime]])])]),I.value.length>0?(v(),g("div",QD,[K[15]||(K[15]=r("label",{for:"checkpoint",class:"form-label"},"Checkpoint",-1)),Ve(r("select",{id:"checkpoint","onUpdate:modelValue":K[4]||(K[4]=re=>a.value=re),class:"form-input form-select"},[K[14]||(K[14]=r("option",{value:""},"-- None / Unknown --",-1)),(v(!0),g(xe,null,Be(I.value,re=>(v(),g("option",{key:re.id,value:re.id},w(re.name)+w(re.description?` - ${re.description}`:""),9,e8))),128))],512),[[Dn,a.value]])])):e.checkpoint?(v(),g("div",t8,[K[16]||(K[16]=r("label",{class:"form-label"},"Checkpoint",-1)),r("div",n8,[r("label",o8,[Ve(r("input",{type:"checkbox","onUpdate:modelValue":K[5]||(K[5]=re=>l.value=re)},null,512),[[Zr,l.value]]),r("span",s8,w(e.checkpoint.name),1),e.checkpoint.description?(v(),g("span",i8," - "+w(e.checkpoint.description),1)):P("",!0)])])])):P("",!0),r("div",a8,[K[17]||(K[17]=r("label",{class:"form-label"},"Location (optional)",-1)),r("div",l8,[r("div",r8,[r("button",{type:"button",class:ue(["location-btn",{active:u.value==="gps"}]),onClick:K[6]||(K[6]=re=>N("gps"))}," GPS ",2),r("button",{type:"button",class:ue(["location-btn",{active:u.value==="map"}]),onClick:K[7]||(K[7]=re=>N("map"))}," Pick on map ",2),r("button",{type:"button",class:ue(["location-btn",{active:u.value==="none"}]),onClick:K[8]||(K[8]=re=>N("none"))}," None ",2)]),u.value==="gps"?(v(),g("div",c8,[y.value?(v(),g("div",u8," Getting location... ")):p.value&&p.value.latitude!=null?(v(),g("div",d8,[r("span",null,w(p.value.latitude.toFixed(5))+", "+w(p.value.longitude.toFixed(5)),1),f.value?(v(),g("span",h8,"("+w(Math.round(f.value))+"m)",1)):P("",!0)])):m.value?(v(),g("div",f8,w(m.value),1)):P("",!0)])):P("",!0),u.value==="map"?(v(),g("div",p8,[d.value?(v(),g("div",v8,"Tap to select location")):P("",!0),d.value?(v(),je(oa,{key:1,locations:I.value,route:e.route,center:C.value,zoom:14,mode:"select-point","user-location":e.initialLocation,"highlight-location-id":a.value,height:"150px",onPointSelected:$},null,8,["locations","route","center","user-location","highlight-location-id"])):P("",!0),p.value&&p.value.latitude!=null?(v(),g("div",m8,[r("span",null,w(p.value.latitude.toFixed(5))+", "+w(p.value.longitude.toFixed(5)),1),d.value?P("",!0):(v(),g("button",{key:0,type:"button",class:"location-edit-btn",onClick:K[9]||(K[9]=re=>d.value=!0)},"Edit"))])):P("",!0)])):P("",!0)])]),b.value?(v(),g("div",g8,w(b.value),1)):P("",!0)],32)]),_:1},8,["show","is-dirty"]))}},Mv=ze(_8,[["__scopeId","data-v-0896cfc4"]]),b8={class:"tab-content"},w8={key:0,class:"form-group"},C8={for:"marshalId"},L8=["value"],S8={class:"help-text"},x8={key:1,class:"form-group"},I8={class:"linked-marshal-info"},$8={class:"linked-marshal-name"},T8={class:"linked-marshal-hint"},M8={class:"form-group"},A8=["disabled"],E8={class:"form-group"},P8={class:"role-input-group"},D8={key:0,label:"Built-in Roles"},R8=["value"],O8={key:1,label:"Custom Roles"},B8=["value"],N8={class:"form-row"},F8={class:"form-group"},U8={class:"form-group"},z8={class:"form-group"},H8={class:"tab-content"},V8={class:"custom-footer"},G8={class:"footer-left"},j8=["disabled"],Z8={__name:"EditContactModal",props:{show:{type:Boolean,default:!1},contact:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},isDirty:{type:Boolean,default:!1},preselectedArea:{type:Object,default:null},prefilledName:{type:String,default:""},prefilledMarshalId:{type:String,default:null},createFromAreaContext:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{terms:o}=St(),i=e,s=t,a=M(!1),l=M(""),u=M("details"),d=M(!1),p=M({role:"",name:"",phone:"",email:"",notes:"",marshalId:null,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}),f=H(()=>!!i.contact),m=H(()=>i.createFromAreaContext?[{value:"details",label:"Details"}]:[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}]),y=H(()=>!!p.value.marshalId),_=H(()=>!f.value&&!!i.prefilledMarshalId),b=H(()=>f.value&&!!i.contact?.marshalId),S=H(()=>i.contact?.marshalId?i.marshals.find(Z=>Z.id===i.contact.marshalId)?.name||"Unknown":""),T=H(()=>[...i.marshals].sort((R,Z)=>js(R.name,Z.name)));Ze(()=>i.show,R=>{if(R){if(u.value=i.initialTab,i.contact){const Z=[...i.availableRoles.builtInRoles||[],...i.availableRoles.customRoles||[]];d.value=i.contact.role&&!Z.includes(i.contact.role),p.value={role:i.contact.role||"",name:i.contact.name||"",phone:i.contact.phone||"",email:i.contact.email||"",notes:i.contact.notes||"",marshalId:i.contact.marshalId||null,scopeConfigurations:i.contact.scopeConfigurations?JSON.parse(JSON.stringify(i.contact.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}}else{d.value=!1;let Z;i.createFromAreaContext?Z=[]:i.preselectedArea?Z=[{scope:"EveryoneInAreas",itemType:"Area",ids:[i.preselectedArea.id]}]:Z=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}];let U={name:i.prefilledName||"",phone:"",email:""};if(i.prefilledMarshalId){const K=i.marshals.find(re=>re.id===i.prefilledMarshalId);K&&(U={name:K.name||"",phone:K.phoneNumber||"",email:K.email||""})}p.value={role:"",name:U.name,phone:U.phone,email:U.email,notes:"",marshalId:i.prefilledMarshalId||null,scopeConfigurations:Z}}s("update:isDirty",!1)}});const D=R=>R?R==="AreaLead"?`${o.value.area} Lead`:R.replace(/([A-Z])/g," $1").replace(/^./,Z=>Z.toUpperCase()).trim():"",I=()=>{s("update:isDirty",!0)},C=()=>{if(p.value.marshalId){const R=i.marshals.find(Z=>Z.id===p.value.marshalId);R&&(p.value.name=R.name,!p.value.phone&&R.phoneNumber&&(p.value.phone=R.phoneNumber),!p.value.email&&R.email&&(p.value.email=R.email))}I()},A=()=>{s("close")},E=()=>{if(!p.value.role||!p.value.role.trim()){N("Please select or enter a role");return}if(!p.value.name||!p.value.name.trim()){N("Please enter a contact name");return}u.value="visibility"},N=R=>{l.value=R,a.value=!0},$=()=>{if(!p.value.role||!p.value.role.trim()){N("Please select or enter a role");return}if(!p.value.name||!p.value.name.trim()){N("Please enter a contact name");return}if(!i.createFromAreaContext){if(!p.value.scopeConfigurations||p.value.scopeConfigurations.length===0){N("Please select at least one visibility scope");return}if(!p.value.scopeConfigurations.some(U=>!(U.itemType!==null&&(!U.ids||U.ids.length===0)))){N("Please configure at least one scope with valid selections");return}}const R={role:p.value.role.trim(),name:p.value.name.trim(),phone:p.value.phone?.trim()||null,email:p.value.email?.trim()||null,notes:p.value.notes?.trim()||null,marshalId:p.value.marshalId||null,scopeConfigurations:p.value.scopeConfigurations};s("save",R)},G=()=>{s("delete",i.contact.contactId)};return(R,Z)=>(v(),g(xe,null,[Ee(zt,{show:e.show,title:f.value?"Edit contact":"Create contact",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:A},{"tab-header":Ue(()=>[Ee(Fa,{modelValue:u.value,"onUpdate:modelValue":Z[0]||(Z[0]=U=>u.value=U),tabs:m.value},null,8,["modelValue","tabs"])]),footer:Ue(()=>[r("div",V8,[r("div",G8,[f.value?(v(),g("button",{key:0,type:"button",onClick:G,class:"btn btn-danger"}," Delete ")):P("",!0),!f.value&&u.value==="details"?(v(),g("button",{key:1,type:"button",onClick:E,class:"btn btn-secondary mobile-only"}," Visibility... ")):P("",!0)]),r("button",{type:"button",onClick:$,class:"btn btn-success",disabled:f.value&&!e.isDirty}," Save ",8,j8)])]),default:Ue(()=>[r("form",{onSubmit:dt($,["prevent"]),class:"contact-form"},[Ve(r("div",b8,[!_.value&&!b.value?(v(),g("div",w8,[r("label",C8,"Link to "+w(V(o).person.toLowerCase())+":",1),Ve(r("select",{id:"marshalId","onUpdate:modelValue":Z[1]||(Z[1]=U=>p.value.marshalId=U),onChange:C},[Z[11]||(Z[11]=r("option",{value:null},"-- Not linked --",-1)),(v(!0),g(xe,null,Be(T.value,U=>(v(),g("option",{key:U.id,value:U.id},w(U.name),9,L8))),128))],544),[[Dn,p.value.marshalId]]),r("span",S8,"Optionally link to an existing "+w(V(o).person.toLowerCase())+" in the system",1)])):P("",!0),b.value?(v(),g("div",x8,[r("label",null,"Linked "+w(V(o).person.toLowerCase())+":",1),r("div",I8,[r("span",$8,w(S.value),1),r("span",T8,"Contact details are synced with this "+w(V(o).person.toLowerCase()),1)])])):P("",!0),r("div",M8,[Z[12]||(Z[12]=r("label",{for:"name"},"Name: *",-1)),Ve(r("input",{id:"name","onUpdate:modelValue":Z[2]||(Z[2]=U=>p.value.name=U),type:"text",onInput:I,disabled:y.value,class:ue({"input-disabled":y.value}),placeholder:"Contact name..."},null,42,A8),[[nt,p.value.name]])]),r("div",E8,[Z[14]||(Z[14]=r("label",{for:"role"},"Role: *",-1)),r("div",P8,[d.value?Ve((v(),g("input",{key:1,id:"customRole","onUpdate:modelValue":Z[4]||(Z[4]=U=>p.value.role=U),type:"text",onInput:I,placeholder:"Enter custom role name..."},null,544)),[[nt,p.value.role]]):Ve((v(),g("select",{key:0,id:"role","onUpdate:modelValue":Z[3]||(Z[3]=U=>p.value.role=U),onChange:I},[Z[13]||(Z[13]=r("option",{value:"",disabled:""},"Select a role...",-1)),e.availableRoles.builtInRoles?.length>0?(v(),g("optgroup",D8,[(v(!0),g(xe,null,Be(e.availableRoles.builtInRoles,U=>(v(),g("option",{key:U,value:U},w(D(U)),9,R8))),128))])):P("",!0),e.availableRoles.customRoles?.length>0?(v(),g("optgroup",O8,[(v(!0),g(xe,null,Be(e.availableRoles.customRoles,U=>(v(),g("option",{key:U,value:U},w(D(U)),9,B8))),128))])):P("",!0)],544)),[[Dn,p.value.role]]),r("button",{type:"button",class:"toggle-custom-btn",onClick:Z[5]||(Z[5]=U=>d.value=!d.value)},w(d.value?"Use existing":"Custom"),1)])]),r("div",N8,[r("div",F8,[Z[15]||(Z[15]=r("label",{for:"phone"},"Phone:",-1)),Ve(r("input",{id:"phone","onUpdate:modelValue":Z[6]||(Z[6]=U=>p.value.phone=U),type:"tel",onInput:I,placeholder:"Phone number..."},null,544),[[nt,p.value.phone]])]),r("div",U8,[Z[16]||(Z[16]=r("label",{for:"email"},"Email:",-1)),Ve(r("input",{id:"email","onUpdate:modelValue":Z[7]||(Z[7]=U=>p.value.email=U),type:"email",onInput:I,placeholder:"Email address..."},null,544),[[nt,p.value.email]])])]),r("div",z8,[Z[17]||(Z[17]=r("label",{for:"notes"},"Notes / Instructions:",-1)),Ve(r("textarea",{id:"notes","onUpdate:modelValue":Z[8]||(Z[8]=U=>p.value.notes=U),onInput:I,rows:"3",placeholder:"Additional notes or instructions for when to contact..."},null,544),[[nt,p.value.notes]])])],512),[[bi,u.value==="details"]]),Ve(r("div",H8,[Ee(nc,{modelValue:p.value.scopeConfigurations,"onUpdate:modelValue":Z[9]||(Z[9]=U=>p.value.scopeConfigurations=U),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":f.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this contact?",onUserChanged:I},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[bi,u.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ee(sc,{show:a.value,title:"Validation error",message:l.value,onClose:Z[10]||(Z[10]=U=>a.value=!1)},null,8,["show","message"])],64))}},q8=ze(Z8,[["__scopeId","data-v-933c59e2"]]),W8={key:0,class:"fullscreen-map-overlay"},K8={class:"fullscreen-map-header"},Y8={class:"context-info"},J8={key:0},X8={class:"action-buttons"},Q8=["disabled"],eR={class:"fullscreen-map-container"},tR={key:0,class:"drawing-controls"},nR={class:"point-count"},oR={class:"undo-redo-buttons"},sR=["disabled"],iR=["disabled"],aR=Object.assign({inheritAttrs:!1},{__name:"FullscreenMapOverlay",props:{show:{type:Boolean,required:!0},mode:{type:String,validator:e=>["place-checkpoint","move-checkpoint","draw-area","add-multiple","view"].includes(e)},contextTitle:{type:String,default:""},contextDescription:{type:String,default:""},canComplete:{type:Boolean,default:!1},drawingMode:{type:Boolean,default:!1}},emits:["done","cancel","map-click","polygon-complete","polygon-drawing","location-click","area-click"],setup(e,{emit:t}){const o=e,i=t,s=M(null),a=M(0),l=M(!1),u=M(!1),d=()=>{i("done")},p=()=>{i("cancel")},f=S=>{a.value=S?.length||0,m(),i("polygon-drawing",S)},m=()=>{s.value&&(l.value=s.value.canUndo(),u.value=s.value.canRedo())},y=()=>{s.value&&(s.value.undoPolygonPoint(),m())},_=()=>{s.value&&(s.value.redoPolygonPoint(),m())};Ze(()=>o.show,S=>{S||(a.value=0,l.value=!1,u.value=!1)});const b=S=>{S.key==="Escape"&&o.show&&p(),o.show&&o.drawingMode&&((S.ctrlKey||S.metaKey)&&S.key==="z"&&!S.shiftKey?(S.preventDefault(),y()):(S.ctrlKey||S.metaKey)&&(S.key==="y"||S.key==="z"&&S.shiftKey)&&(S.preventDefault(),_()))};return Qt(()=>{document.addEventListener("keydown",b)}),On(()=>{document.removeEventListener("keydown",b)}),(S,T)=>(v(),je(Mu,{to:"body"},[e.show?(v(),g("div",W8,[r("div",K8,[r("div",Y8,[r("h3",null,w(e.contextTitle),1),e.contextDescription?(v(),g("p",J8,w(e.contextDescription),1)):P("",!0)]),r("div",X8,[e.mode==="view"?(v(),g("button",{key:0,onClick:p,class:"btn btn-done"}," Close ")):(v(),g(xe,{key:1},[r("button",{onClick:p,class:"btn btn-cancel"}," Cancel "),r("button",{onClick:d,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,Q8)],64))])]),r("div",eR,[Ee(pu,gp({ref_key:"mapViewRef",ref:s,"drawing-mode":e.drawingMode},S.$attrs,{onMapClick:T[0]||(T[0]=D=>S.$emit("map-click",D)),onPolygonComplete:T[1]||(T[1]=D=>S.$emit("polygon-complete",D)),onPolygonDrawing:f,onLocationClick:T[2]||(T[2]=D=>S.$emit("location-click",D)),onAreaClick:T[3]||(T[3]=D=>S.$emit("area-click",D))}),null,16,["drawing-mode"]),e.drawingMode&&a.value>0?(v(),g("div",tR,[r("div",nR,w(a.value)+" point"+w(a.value!==1?"s":""),1),r("div",oR,[r("button",{onClick:y,class:"btn-drawing undo-btn",disabled:!l.value,title:"Undo last point"},"  Undo ",8,sR),r("button",{onClick:_,class:"btn-drawing redo-btn",disabled:!u.value,title:"Redo point"}," Redo  ",8,iR)])])):P("",!0)])])):P("",!0)]))}}),lR=ze(aR,[["__scopeId","data-v-9ce62b55"]]),rR={class:"form-group"},cR={class:"form-group"},uR={class:"form-group"},dR={key:0,class:"form-error"},hR={class:"form-row"},fR={class:"form-group",style:{flex:"1"}},pR={class:"form-group",style:{flex:"1"}},vR={class:"form-group",style:{flex:"0 0 auto"}},mR={class:"form-group"},gR={__name:"AddLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:()=>({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""})},isDirty:{type:Boolean,default:!1}},emits:["close","save","set-on-map","update:isDirty","update:location"],setup(e,{emit:t}){const{termsLower:o}=St(),i=e,s=t,a=M({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""});Ze(()=>i.location,p=>{p&&(a.value={...p})},{immediate:!0,deep:!0});const l=()=>{s("update:isDirty",!0),s("update:location",{...a.value})},u=()=>{if(!Ir(a.value.what3Words)&&a.value.what3Words){alert("Invalid What3Words format.");return}s("save",a.value)},d=()=>{s("close")};return(p,f)=>(v(),je(zt,{show:e.show,title:`Add ${V(o).checkpoint}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:Ue(()=>[r("button",{type:"button",onClick:d,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:u,class:"btn btn-primary"}," Add "+w(V(o).checkpoint),1)]),default:Ue(()=>[r("form",{onSubmit:dt(u,["prevent"])},[r("div",rR,[f[7]||(f[7]=r("label",null,"Name",-1)),Ve(r("input",{"onUpdate:modelValue":f[0]||(f[0]=m=>a.value.name=m),type:"text",required:"",class:"form-input",onInput:l},null,544),[[nt,a.value.name]])]),r("div",cR,[f[8]||(f[8]=r("label",null,"Description",-1)),Ve(r("input",{"onUpdate:modelValue":f[1]||(f[1]=m=>a.value.description=m),type:"text",class:"form-input",onInput:l},null,544),[[nt,a.value.description]])]),r("div",uR,[f[9]||(f[9]=r("label",null,"What3Words (optional)",-1)),Ve(r("input",{"onUpdate:modelValue":f[2]||(f[2]=m=>a.value.what3Words=m),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap",onInput:l},null,544),[[nt,a.value.what3Words]]),a.value.what3Words&&!V(Ir)(a.value.what3Words)?(v(),g("small",dR," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):P("",!0)]),r("div",hR,[r("div",fR,[f[10]||(f[10]=r("label",null,"Longitude",-1)),Ve(r("input",{"onUpdate:modelValue":f[3]||(f[3]=m=>a.value.longitude=m),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[nt,a.value.longitude,void 0,{number:!0}]])]),r("div",pR,[f[11]||(f[11]=r("label",null,"Latitude",-1)),Ve(r("input",{"onUpdate:modelValue":f[4]||(f[4]=m=>a.value.latitude=m),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[nt,a.value.latitude,void 0,{number:!0}]])]),r("div",vR,[f[12]||(f[12]=r("label",null,"",-1)),r("button",{type:"button",class:"icon-btn",title:"Set location on map",onClick:f[5]||(f[5]=m=>p.$emit("set-on-map"))},"  ")])]),r("div",mR,[r("label",null,"Required "+w(V(o).people),1),Ve(r("input",{"onUpdate:modelValue":f[6]||(f[6]=m=>a.value.requiredMarshals=m),type:"number",min:"1",required:"",class:"form-input",onInput:l},null,544),[[nt,a.value.requiredMarshals,void 0,{number:!0}]])])],32)]),_:1},8,["show","title","is-dirty"]))}},yR=ze(gR,[["__scopeId","data-v-fb51fed0"]]),kR={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"app-logo"},_R=["id"],bR=["filter"],wR={__name:"AppLogo",props:{size:{type:[Number,String],default:48},animate:{type:Boolean,default:!1}},setup(e){ty(o=>({v1c2199cd:typeof e.size=="number"?e.size+"px":e.size}));const t=H(()=>`discShadow-${Math.random().toString(36).substr(2,9)}`);return(o,i)=>(v(),g("svg",kR,[r("defs",null,[r("filter",{id:t.value,x:"-20%",y:"-20%",width:"140%",height:"140%"},[...i[0]||(i[0]=[r("feDropShadow",{dx:"0",dy:"6",stdDeviation:"8","flood-color":"#000","flood-opacity":"0.25"},null,-1)])],8,_R)]),r("ellipse",{cx:"256",cy:"400",rx:"220",ry:"70",fill:"#667eea",filter:`url(#${t.value})`},null,8,bR),i[2]||(i[2]=r("ellipse",{cx:"256",cy:"394",rx:"185",ry:"55",fill:"none",stroke:"rgba(255,255,255,0.3)","stroke-width":"4"},null,-1)),r("g",{class:ue({"marshal-figure":e.animate})},[...i[1]||(i[1]=[r("circle",{cx:"256",cy:"160",r:"55",fill:"currentColor"},null,-1),r("path",{d:"M365 380 v-30 a55 55 0 0 0-55-55 H202 a55 55 0 0 0-55 55 v30",fill:"currentColor"},null,-1)])],2)]))}},CR=ze(wR,[["__scopeId","data-v-3e647831"]]),LR={class:"header"},SR={class:"header-left"},xR={key:0},IR={class:"event-date"},$R={class:"header-actions"},TR={class:"container"},MR={class:"tabs-nav"},AR={class:"tab-content-wrapper"},ER={class:"add-note-form"},PR={class:"modal-footer-actions"},DR=["disabled"],RR=6e4,OR={__name:"AdminEventManage",setup(e){const t=Yr(),o=Ra(),i=fv(),s=H(()=>t.params.eventId),{activeTab:a,switchTab:l}=pv("details",["details","course","areas","checkpoints","marshals","notes","checklists","contacts","settings"]),{showConfirmModal:u,confirmModalTitle:d,confirmModalMessage:p,confirmModalIsDanger:f,confirmModalConfirmText:m,showConfirm:y,handleConfirmModalConfirm:_,handleConfirmModalCancel:b}=A0(),{tabLabels:S,terms:T,termsLower:D}=St(),I=E0(),C=D0(s),A=P0(s),{colorScheme:E}=Gu(),N=H(()=>[{value:"details",label:"Event details",icon:"details"},{value:"course",label:S.value.course,icon:"course"},{value:"areas",label:S.value.areas,icon:"area"},{value:"checkpoints",label:S.value.checkpoints,icon:"checkpoint"},{value:"marshals",label:S.value.marshals,icon:"marshal"},{value:"notes",label:"Notes",icon:"notes"},{value:"incidents",label:"Incidents",icon:"incidents"},{value:"checklists",label:S.value.checklists,icon:"checklist"},{value:"contacts",label:"Contacts",icon:"contacts"},{value:"settings",label:"Settings",icon:"settings"}]),$=M(null),G=M([]),R=M([]),Z=M({marshals:0,areas:0,checkpoints:0,checklists:0,notes:0,incidents:0,contacts:0}),U=M(null),K=M(!1),re=M(!1),Pe=M(null),me=M(!1),Ae=M(!1),Fe=M(null),ae=M(""),Me=A.eventAdmins,ge=A.showAddAdmin,de=C.showUploadRoute,Oe=C.uploading,Xe=C.uploadError,et=C.showImportLocations,qe=C.showImportMarshals,tt=C.importing,be=C.importingMarshals,He=C.importError,fe=C.importResult,Ie=C.importMarshalsResult,Te=M(!1),W=M(!1),Y=M({id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),le=M(!1),ye=M(!1),ie=M({marshalName:"",locations:[],marshal:null}),oe=M(null),ce=M([]),De=M(!1),we=M(null),te=M(null),ke=M(null),se=M({}),Q=M({id:"",name:"",email:"",phoneNumber:"",notes:""}),X=M(!1),O=M([]),q=M([]),J=M([]),$e=M([]),We=M(!1),ot=M(""),st=M(""),$t=M({name:"",description:"",eventDate:"",timeZoneId:"UTC",peopleTerm:"Marshals",defaultCheckpointStyleBackgroundShape:"",defaultCheckpointStyleBackgroundColor:"",defaultCheckpointStyleBorderColor:"",defaultCheckpointStyleIconColor:"",defaultCheckpointStyleSize:"",defaultCheckpointStyleMapRotation:"",checkpointTerm:"Checkpoints",areaTerm:"Areas",checklistTerm:"Checklists",courseTerm:"Course",defaultCheckpointStyleType:"default",defaultCheckpointStyleColor:""}),Nt=M(!1),Pt=M(!1),jt=M(""),cn=M(""),go=M(0),un=M({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Ht=M([]),bt=M(null),qt=M(!1),yo=M("details"),ko=M(null),Bn=M(null),Zt=M(null),Eo=I.isAddingMultipleCheckpoints,fs=I.multiCheckpointCounter,io=I.isFullscreenMapActive,Vt=I.fullscreenMode,Wn=I.fullscreenContext,vn=I.tempLocationCoords,ns=I.tempCheckpoints,ln=I.savedMapCenter,Qe=I.savedMapZoom,Po=I.isDrawingAreaBoundary,Kn=M(null),en=M([]),ao=M(null),Do=M(!1),Ws=M("details"),dn=M(null),kn=M([]),Ro=M(null),_n=M(!1),Ks=M("details"),Yn=M([]),Oo=M(!1),hn=M(null),lo=M(!1),ps=M(!1),Li=M(!1),Nn=M(""),os=M(!1),bn=M([]),vs=M({builtInRoles:[],customRoles:[]}),tn=M(null),ro=M(!1),Bo=M("details"),Jn=M(null),kt=M(""),Mt=M(null),ms=M(null),Fn=H(()=>ms.value?.marshalId!=null),_o=()=>{o.push(`/event/${t.params.eventId}`)},Ys=H(()=>`${window.location.origin}/#/event/${t.params.eventId}`),ht=H(()=>{const F=[];return R.value.forEach(ne=>{ne.assignments&&F.push(...ne.assignments)}),F}),Gt=H(()=>{if(!we.value)return R.value;const F=we.value.assignedLocationIds||[],ne=J.value.map(_e=>_e.locationId),pe=$e.value;return R.value.filter(_e=>!F.includes(_e.id)&&!ne.includes(_e.id)||pe.includes(_e.id))}),Js=H(()=>{let F=ce.value;if(U.value){const ne=U.value.assignments.map(_e=>_e.marshalName),pe=O.value.map(_e=>_e.marshalName);F=ce.value.filter(_e=>!ne.includes(_e.name)&&!pe.includes(_e.name))}return F.slice().sort((ne,pe)=>ne.name.localeCompare(pe.name))}),No=H(()=>Vt.value==="draw-area"&&bt.value?.polygon?.length>0||I.canCompleteFullscreen.value),xn=H(()=>{const F=[...R.value];return Vt.value==="place-checkpoint"&&vn.value&&F.push({id:"temp-single",name:un.value.name||"New Checkpoint",latitude:vn.value.lat,longitude:vn.value.lng,requiredMarshals:un.value.requiredMarshals||1,assignments:[],isTemporary:!0}),Vt.value==="move-checkpoint"&&vn.value&&U.value&&F.push({id:"temp-move",name:U.value.name+" (new position)",latitude:vn.value.lat,longitude:vn.value.lng,requiredMarshals:U.value.requiredMarshals,assignments:[],isTemporary:!0}),Vt.value==="add-multiple"&&F.push(...ns.value),F}),Ua=H(()=>{let F=[...Ht.value];return Vt.value==="draw-area"&&bt.value?.id&&(F=F.filter(ne=>ne.id!==bt.value.id)),Vt.value==="draw-area"&&bt.value?.polygon?.length>0&&F.push({...bt.value,id:bt.value.id||"temp-area"}),F}),Xs=H(()=>{if(!we.value||!Yn.value.length)return[];const F=we.value.id,ne=we.value.assignedLocationIds||[];return Yn.value.filter(pe=>{if(pe.reportedBy?.marshalId===F)return!0;const _e=pe.context?.checkpoint?.checkpointId;return!!(_e&&ne.includes(_e))}).sort((pe,_e)=>new Date(_e.incidentTime||_e.createdAt)-new Date(pe.incidentTime||pe.createdAt))}),Fo=H(()=>{if(!U.value||!Yn.value.length)return[];const F=U.value.id;return Yn.value.filter(ne=>ne.context?.checkpoint?.checkpointId===F).sort((ne,pe)=>new Date(pe.incidentTime||pe.createdAt)-new Date(ne.incidentTime||ne.createdAt))}),Ft=H(()=>{if(!bt.value||!Yn.value.length)return[];const F=bt.value.id,ne=R.value.filter(pe=>pe.areaIds&&pe.areaIds.includes(F)).map(pe=>pe.id);return Yn.value.filter(pe=>{const _e=pe.context?.checkpoint?.checkpointId;return _e&&ne.includes(_e)}).sort((pe,_e)=>new Date(_e.incidentTime||_e.createdAt)-new Date(pe.incidentTime||pe.createdAt))}),Uo=F=>{hn.value=F,lo.value=!0},gs=F=>{hn.value=F,lo.value=!0},ys=F=>{hn.value=F,lo.value=!0},Si=()=>{o.push("/admin/dashboard")},Dt=(F=!0)=>{X.value=F},Qs=()=>{Nt.value=!0},zo=async F=>{try{F&&($t.value={...F});const ne=Tl($.value.eventDate),pe=$t.value.eventDate;if(ne!==pe){const _e=G.value.filter(lt=>lt.startTime||lt.endTime);if(_e.length>0){jt.value=ne,cn.value=pe,go.value=_e.length,Pt.value=!0;return}}await ks(!1,null)}catch(ne){console.error("Failed to update event:",ne),alert("Failed to update event. Please try again.")}},ks=async(F,ne)=>{try{if(await i.updateEvent(t.params.eventId,{...$t.value,defaultCheckpointStyleMapRotation:$t.value.defaultCheckpointStyleMapRotation!=null?String($t.value.defaultCheckpointStyleMapRotation):null}),F&&ne!==null){const pe=Math.floor(Math.abs(ne)/1e3),_e=ne<0,lt=Math.floor(pe/3600),Lt=Math.floor(pe%3600/60),sn=pe%60,xo=`${_e?"-":""}${lt.toString().padStart(2,"0")}:${Lt.toString().padStart(2,"0")}:${sn.toString().padStart(2,"0")}`;await i.bulkUpdateLocationTimes(t.params.eventId,xo)}await fn(),Nt.value=!1}catch(pe){console.error("Failed to update event:",pe),alert("Failed to update event. Please try again.")}},ei=async({shouldShift:F,timeDelta:ne})=>{Pt.value=!1,await ks(F,ne)},ti=()=>{Pt.value=!1,fn()},fn=async()=>{try{await i.fetchEvent(t.params.eventId),$.value=i.currentEvent,$.value&&($t.value={name:$.value.name||"",description:$.value.description||"",eventDate:Tl($.value.eventDate),timeZoneId:$.value.timeZoneId||"UTC",peopleTerm:$.value.peopleTerm||"Marshals",checkpointTerm:$.value.checkpointTerm||"Checkpoints",areaTerm:$.value.areaTerm||"Areas",checklistTerm:$.value.checklistTerm||"Checklists",courseTerm:$.value.courseTerm||"Course",defaultCheckpointStyleType:$.value.defaultCheckpointStyleType||"default",defaultCheckpointStyleColor:$.value.defaultCheckpointStyleColor||"",defaultCheckpointStyleBackgroundShape:$.value.defaultCheckpointStyleBackgroundShape||"",defaultCheckpointStyleBackgroundColor:$.value.defaultCheckpointStyleBackgroundColor||"",defaultCheckpointStyleBorderColor:$.value.defaultCheckpointStyleBorderColor||"",defaultCheckpointStyleIconColor:$.value.defaultCheckpointStyleIconColor||"",defaultCheckpointStyleSize:$.value.defaultCheckpointStyleSize||"",defaultCheckpointStyleMapRotation:$.value.defaultCheckpointStyleMapRotation??"",brandingHeaderGradientStart:$.value.brandingHeaderGradientStart||"",brandingHeaderGradientEnd:$.value.brandingHeaderGradientEnd||"",brandingLogoUrl:$.value.brandingLogoUrl||"",brandingLogoPosition:$.value.brandingLogoPosition||"",brandingAccentColor:$.value.brandingAccentColor||"",brandingPageGradientStart:$.value.brandingPageGradientStart||"",brandingPageGradientEnd:$.value.brandingPageGradientEnd||""},Nt.value=!1,du($.value));const F=await Promise.allSettled([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId),at(),bo(),wo(),co(),rt(),mn(),Ct()]);G.value=i.locations,R.value=i.eventStatus.locations,F.forEach((ne,pe)=>{ne.status==="rejected"&&console.error(`Failed to load ${["locations","eventStatus","admins","marshals","areas","checklists","notes","contacts"][pe]}:`,ne.reason)})}catch(F){console.error("Failed to load event data:",F)}},bo=async()=>{try{const F=await hs.getByEvent(t.params.eventId);ce.value=F.data,Z.value.marshals=Date.now()}catch(F){console.error("Failed to load marshals:",F)}},wo=async()=>{try{const F=await mi.getByEvent(t.params.eventId);Ht.value=F.data,Z.value.areas=Date.now()}catch(F){console.error("Failed to load areas:",F)}},co=async()=>{try{const[F,ne]=await Promise.all([Rt.getByEvent(t.params.eventId),Rt.getReport(t.params.eventId)]);en.value=F.data,dn.value=ne.data,Z.value.checklists=Date.now()}catch(F){console.error("Failed to load checklists:",F)}},rt=async()=>{try{const F=await Ps.getByEvent(t.params.eventId);kn.value=F.data,Z.value.notes=Date.now()}catch(F){console.error("Failed to load notes:",F)}},mn=async()=>{Oo.value=!0;try{const F=await us.getAll(t.params.eventId);Yn.value=F.data.incidents||[],Z.value.incidents=Date.now()}catch(F){console.error("Failed to load incidents:",F)}finally{Oo.value=!1}},Ct=async()=>{try{const[F,ne]=await Promise.all([di.getByEvent(t.params.eventId),di.getRoles(t.params.eventId)]);bn.value=F.data,vs.value=ne.data,Z.value.contacts=Date.now()}catch(F){console.error("Failed to load contacts:",F)}},xi=async()=>{await Promise.all([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId)]),G.value=i.locations,Z.value.checkpoints=Date.now(),R.value=i.eventStatus.locations},ni=async()=>{await Promise.all([bo(),i.fetchEventStatus(t.params.eventId)]),R.value=i.eventStatus.locations},Ho=async()=>{await Promise.all([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId),wo()]),G.value=i.locations,R.value=i.eventStatus.locations},Ii=async()=>{await i.fetchEventStatus(t.params.eventId),R.value=i.eventStatus.locations},Co=()=>{bt.value=null,yo.value="details",X.value=!1,qt.value=!0},_s=F=>{bt.value=F,Bn.value=F.id,yo.value="details",X.value=!1,qt.value=!0},bs=async F=>{try{let ne;if(bt.value&&bt.value.id){if(ne=bt.value.id,await mi.update(t.params.eventId,ne,F),F.checklistChanges&&F.checklistChanges.length>0)for(const pe of F.checklistChanges)try{pe.complete?await Rt.complete(t.params.eventId,pe.itemId,{marshalId:pe.marshalId,contextType:pe.contextType,contextId:pe.contextId}):await Rt.uncomplete(t.params.eventId,pe.itemId,{marshalId:pe.marshalId,contextType:pe.contextType,contextId:pe.contextId})}catch(_e){console.error("Failed to update checklist item:",pe,_e)}}else ne=(await mi.create({eventId:t.params.eventId,...F})).data.id;if(F.pendingContacts&&F.pendingContacts.length>0&&ne)for(const pe of F.pendingContacts)try{const _e=pe.scopeConfigurations?JSON.parse(JSON.stringify(pe.scopeConfigurations)):[],lt=_e.find(Lt=>Lt.scope==="EveryoneInAreas"&&Lt.itemType==="Area");lt?(lt.ids||(lt.ids=[]),lt.ids.includes(ne)||lt.ids.push(ne)):_e.push({scope:"EveryoneInAreas",itemType:"Area",ids:[ne]}),await di.update(t.params.eventId,pe.contactId,{...pe,scopeConfigurations:_e})}catch(_e){console.error("Failed to add area to contact:",pe,_e)}if(F.contactsToRemove&&F.contactsToRemove.length>0&&ne)for(const pe of F.contactsToRemove)try{const _e=bn.value.find(sn=>sn.contactId===pe);if(!_e)continue;const lt=_e.scopeConfigurations?JSON.parse(JSON.stringify(_e.scopeConfigurations)):[],Lt=lt.find(sn=>sn.scope==="EveryoneInAreas"&&sn.itemType==="Area");if(Lt&&Lt.ids){Lt.ids=Lt.ids.filter(xo=>xo!==ne);const sn=Lt.ids.length>0?lt:lt.filter(xo=>!(xo.scope==="EveryoneInAreas"&&xo.itemType==="Area"));await di.update(t.params.eventId,pe,{..._e,scopeConfigurations:sn})}}catch(_e){console.error("Failed to remove area from contact:",pe,_e)}(F.pendingContacts&&F.pendingContacts.length>0||F.contactsToRemove&&F.contactsToRemove.length>0)&&await Ct(),await wo(),await fn(),Un()}catch(ne){console.error("Failed to save area:",ne),alert(ne.response?.data?.message||"Failed to save area. Please try again.")}},nn=async F=>{y(`Delete ${D.value.area}`,`Are you sure you want to delete this ${D.value.area}? ${T.value.checkpoints} will be automatically reassigned.`,async()=>{try{await mi.delete(t.params.eventId,F),await mi.recalculate(t.params.eventId),await wo(),await fn(),Un()}catch(ne){console.error(`Failed to delete ${D.value.area}:`,ne),alert(ne.response?.data?.message||`Failed to delete ${D.value.area}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Un=()=>{qt.value=!1,bt.value=null,Bn.value=null,X.value=!1,Po.value=!1,Zt.value=null},sa=({marshal:F,area:ne})=>{tn.value=null,Bo.value="details",X.value=!1,Jn.value=ne,kt.value="",Mt.value=F.id,ro.value=!0},ia=({name:F,area:ne})=>{tn.value=null,Bo.value="details",X.value=!1,Jn.value=ne,kt.value=F,Mt.value=null,ro.value=!0},$i=F=>{tn.value=F,Bo.value="details",X.value=!1,ro.value=!0},uo=()=>{ao.value=null,Ws.value="details",X.value=!1,Do.value=!0},Ti=(F,ne="details")=>{ao.value=F,Ws.value=ne,X.value=!1,Do.value=!0},aa=async F=>{try{if(ao.value&&ao.value.itemId)await Rt.update(t.params.eventId,ao.value.itemId,F);else{const ne=await Rt.create(t.params.eventId,F);ne.data.count&&ne.data.count>1&&(ot.value="Checklist Items Created",st.value=`Successfully created ${ne.data.count} checklist items.`,We.value=!0)}await co(),pt()}catch(ne){console.error("Failed to save checklist item:",ne);const pe=ne.response?.data?.message||"Failed to save checklist item. Please try again.";alert(pe)}},Mi=async F=>{y(`Delete ${D.value.checklist}`,`Are you sure you want to delete this ${D.value.checklist}?`,async()=>{try{await Rt.delete(t.params.eventId,F),await co(),pt()}catch(ne){console.error(`Failed to delete ${D.value.checklist}:`,ne),alert(ne.response?.data?.message||`Failed to delete ${D.value.checklist}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},pt=()=>{Do.value=!1,ao.value=null,X.value=!1},za=()=>{Ro.value=null,Ks.value="details",X.value=!1,_n.value=!0},zn=F=>{Ro.value=F,Ks.value="details",X.value=!1,_n.value=!0},ws=async F=>{try{Ro.value&&Ro.value.noteId?await Ps.update(t.params.eventId,Ro.value.noteId,F):await Ps.create(t.params.eventId,F),await rt(),oi()}catch(ne){console.error("Failed to save note:",ne);const pe=ne.response?.data?.message||"Failed to save note. Please try again.";alert(pe)}},Cs=async F=>{y("Delete note","Are you sure you want to delete this note?",async()=>{try{await Ps.delete(t.params.eventId,F),await rt(),oi()}catch(ne){console.error("Failed to delete note:",ne),alert(ne.response?.data?.message||"Failed to delete note. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},oi=()=>{_n.value=!1,Ro.value=null,X.value=!1},Ai=()=>{ps.value=!0},si=async F=>{try{await us.create(t.params.eventId,F),ps.value=!1,await mn()}catch(ne){console.error("Failed to report incident:",ne),alert(ne.response?.data?.message||"Failed to report incident. Please try again.")}},Ei=F=>{hn.value=F,lo.value=!0},Ha=()=>{lo.value=!1,hn.value=null},Va=async({incidentId:F,status:ne})=>{try{if(await us.updateStatus(t.params.eventId,F,{status:ne}),await mn(),hn.value?.incidentId===F){const pe=Yn.value.find(_e=>_e.incidentId===F);pe&&(hn.value=pe)}}catch(pe){console.error("Failed to update incident status:",pe),alert(pe.response?.data?.message||"Failed to update status. Please try again.")}},Pi=()=>{Nn.value="",Li.value=!0},ii=()=>{Li.value=!1,Nn.value=""},Xn=async()=>{if(!(!Nn.value.trim()||!hn.value)){os.value=!0;try{await us.addNote(t.params.eventId,hn.value.incidentId,Nn.value.trim()),ii(),await mn();const F=Yn.value.find(ne=>ne.incidentId===hn.value.incidentId);F&&(hn.value=F)}catch(F){console.error("Failed to add note to incident:",F),alert(F.response?.data?.message||"Failed to add note. Please try again.")}finally{os.value=!1}}},Ls=()=>{tn.value=null,Bo.value="details",Jn.value=null,X.value=!1,ro.value=!0},Di=F=>{tn.value=F,Bo.value="details",X.value=!1,ro.value=!0},Lo=async F=>{try{let ne=null;const pe=!tn.value||!tn.value.contactId,_e=!!Jn.value;if(tn.value&&tn.value.contactId)await di.update(t.params.eventId,tn.value.contactId,F);else{const lt=await di.create(t.params.eventId,F);ne=lt.data?.contactId||lt.data?.id}if(await Ct(),pe&&_e&&ne&&ko.value){const lt=bn.value.find(Lt=>Lt.contactId===ne);lt&&ko.value.addPendingContact(lt)}j()}catch(ne){console.error("Failed to save contact:",ne);const pe=ne.response?.data?.message||"Failed to save contact. Please try again.";alert(pe)}},z=async F=>{y("Delete contact","Are you sure you want to delete this contact?",async()=>{try{await di.delete(t.params.eventId,F),await Ct(),ko.value&&ko.value.removeContactById(F),j()}catch(ne){console.error("Failed to delete contact:",ne),alert(ne.response?.data?.message||"Failed to delete contact. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},j=()=>{ro.value=!1,tn.value=null,Jn.value=null,kt.value="",Mt.value=null,X.value=!1},he=F=>{const ne={...F,polygon:[]};if(Zt.value=ne,bt.value=ne,qt.value=!1,Pe.value){const pe=Pe.value.getMapCenter(),_e=Pe.value.getMapZoom();pe&&_e!==null&&(ln.value=pe,Qe.value=_e)}io.value=!0,Vt.value="draw-area",Po.value=!0,Wn.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},Ce=F=>{Zt.value?bt.value={...bt.value||{},...Zt.value,polygon:F}:bt.value={...bt.value,polygon:F}},Re=F=>{I.handlePolygonDrawing(F)},Je=()=>{Po.value=!1,Zt.value&&(bt.value=Zt.value,qt.value=!0,Zt.value=null)},at=()=>A.loadEventAdmins(),gt=async F=>{try{await A.addAdmin(F),await at(),Wt()}catch(ne){console.error("Failed to add admin:",ne),alert(ne.response?.data?.message||"Failed to add administrator. Please try again.")}},yt=async F=>{y("Remove administrator",`Remove ${F} as an administrator?`,async()=>{try{await A.removeAdmin(F),await at()}catch(ne){console.error("Failed to remove admin:",ne),alert(ne.response?.data?.message||"Failed to remove administrator. Please try again.")}},{isDanger:!0,confirmText:"Remove"})},Wt=()=>{A.closeAddAdminModal(),X.value=!1},wt=async F=>{await C.uploadRoute(F)&&(await xi(),mt())},mt=()=>{C.closeUploadRouteModal()},Tt=async({file:F,deleteExisting:ne})=>{const pe=await C.importLocations(F,ne);if(pe){await Ho(),It();const _e=C.formatImportResultMessage(pe,"location");ot.value="Import Complete",st.value=_e,We.value=!0}},It=()=>{C.closeImportLocationsModal()},on=async F=>{if(re.value)un.value.latitude=F.lat,un.value.longitude=F.lng;else if(W.value)Y.value.latitude=F.lat,Y.value.longitude=F.lng,U.value&&(U.value={...U.value,latitude:F.lat,longitude:F.lng}),W.value=!1,Te.value=!0,Dt();else if(Eo.value)try{await i.createLocation({eventId:t.params.eventId,name:`Checkpoint ${fs.value}`,description:"",latitude:F.lat,longitude:F.lng,requiredMarshals:1,what3Words:""}),fs.value++,await fn()}catch(ne){console.error("Failed to create checkpoint:",ne),alert("Failed to create checkpoint. Please try again.")}},ho=F=>{I.handleFullscreenMapClick(F)},In=F=>{un.value={...F}},Ul=()=>{re.value=!1,I.enterPlaceCheckpointMode()},zl=()=>{I.saveMapState(Pe.value),un.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},I.enterPlaceCheckpointMode()},ic=()=>{I.saveMapState(Pe.value),io.value=!0,Vt.value="view",Wn.value={title:"Course map",description:""}},Ga=()=>{I.saveMapState(Pe.value),bt.value={id:null,name:"",description:"",color:"#667eea",polygon:[],checkpointIds:[],marshalIds:[],displayOrder:Ht.value.length},I.enterDrawAreaMode()},ja=()=>{U.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},Y.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},O.value=[],q.value=[],X.value=!1,Te.value=!0},ac=()=>{const F=I.calculateStartingNumber(R);I.saveMapState(Pe.value),I.enterAddMultipleMode(F)},lc=()=>{if(Vt.value==="place-checkpoint"){const F=I.getPlacedCoords()||{lat:0,lng:0};U.value={id:null,name:"",description:"",latitude:F.lat,longitude:F.lng,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},Y.value={id:null,name:"",description:"",latitude:F.lat,longitude:F.lng,requiredMarshals:1,what3Words:""},O.value=[],q.value=[],X.value=!1,$n(),Te.value=!0}else if(Vt.value==="move-checkpoint"){const F=I.getPlacedCoords();F&&(Y.value.latitude=F.lat,Y.value.longitude=F.lng,U.value&&(U.value={...U.value,...Kn.value||{},latitude:F.lat,longitude:F.lng}),Dt()),Kn.value=null,$n(),Te.value=!0}else if(Vt.value==="draw-area"){const F=I.getCompletedPolygon();F&&(Zt.value?bt.value={...bt.value||{},...Zt.value,polygon:F}:bt.value={...bt.value||{},polygon:F}),$n(),yo.value="boundary",qt.value=!0,Zt.value=null}else Vt.value==="add-multiple"&&Hl()},Hl=async()=>{const F=I.getTempCheckpoints();try{for(const ne of F)await i.createLocation({eventId:t.params.eventId,name:ne.name,description:ne.description,latitude:ne.latitude,longitude:ne.longitude,requiredMarshals:ne.requiredMarshals,what3Words:ne.what3Words});I.clearTempCheckpoints(),$n(),await fn()}catch(ne){console.error("Failed to create checkpoints:",ne),alert("Failed to create checkpoints. Please try again.")}},rc=()=>{Vt.value==="draw-area"?Zt.value&&(bt.value=Zt.value,qt.value=!0,Zt.value=null):Vt.value==="move-checkpoint"&&(Kn.value&&U.value&&Object.assign(U.value,Kn.value),Te.value=!0,W.value=!1),I.cancelFullscreen()},$n=()=>{I.exitFullscreen()},ai=F=>{la(F)},la=F=>{U.value=F,Y.value={id:F.id,name:F.name,description:F.description||"",latitude:F.latitude,longitude:F.longitude,requiredMarshals:F.requiredMarshals,what3Words:F.what3Words||""},O.value=[],q.value=[],X.value=!1,Te.value=!0,setTimeout(()=>{Pe.value?.scrollMapIntoView()},100)},Vo=async F=>{if(!Ir(F.what3Words)){alert("Invalid What3Words format. Please use word.word.word or word/word/word (lowercase letters only, 1-20 characters each)");return}try{await i.createLocation({eventId:t.params.eventId,...F}),await fn(),Vl()}catch(ne){console.error("Failed to save location:",ne),alert("Failed to save location. Please try again.")}},Vl=()=>{re.value=!1,un.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},X.value=!1,X.value=!1},ss=()=>{Te.value=!1,U.value=null,K.value=!1,W.value=!1,le.value=!1,Kn.value=null,Y.value={id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},O.value=[],q.value=[],X.value=!1},Za=()=>{le.value=!1},Ri=()=>{le.value=!0},Gl=F=>{if(F?.formData&&(Kn.value=F.formData),Te.value=!1,vn.value=null,Pe.value){const pe=Pe.value.getMapCenter(),_e=Pe.value.getMapZoom();pe&&_e!==null&&(ln.value=pe,Qe.value=_e)}const ne=Kn.value?.name||U.value?.name;io.value=!0,Vt.value="move-checkpoint",Wn.value={title:`Move ${D.value.checkpoint}: ${ne}`,description:"Click on the map to set the new location"}},ra=async F=>{if(!Ir(F.what3Words)){alert("Invalid What3Words format.");return}try{const ne=!U.value.id;if(ne){const pe=await i.createLocation({eventId:t.params.eventId,name:F.name,description:F.description,latitude:F.latitude,longitude:F.longitude,requiredMarshals:F.requiredMarshals,what3Words:F.what3Words||null,startTime:F.startTime,endTime:F.endTime,styleType:F.styleType,styleColor:F.styleColor,styleBackgroundShape:F.styleBackgroundShape,styleBackgroundColor:F.styleBackgroundColor,styleBorderColor:F.styleBorderColor,styleIconColor:F.styleIconColor,styleSize:F.styleSize,styleMapRotation:F.styleMapRotation!=null?String(F.styleMapRotation):null,peopleTerm:F.peopleTerm,checkpointTerm:F.checkpointTerm,isDynamic:F.isDynamic||!1,locationUpdateScopeConfigurations:F.locationUpdateScopeConfigurations||[],pendingNewChecklistItems:F.pendingNewChecklistItems||[],pendingNewNotes:F.pendingNewNotes||[]});if(F.pendingAssignments&&F.pendingAssignments.length>0)for(const _e of F.pendingAssignments)await i.createAssignment({eventId:t.params.eventId,locationId:pe.id,marshalId:_e.marshalId})}else{const pe=U.value.id;if(await no.update(t.params.eventId,pe,{eventId:t.params.eventId,name:F.name,description:F.description,latitude:F.latitude,longitude:F.longitude,requiredMarshals:F.requiredMarshals,what3Words:F.what3Words||null,startTime:F.startTime,endTime:F.endTime,styleType:F.styleType,styleColor:F.styleColor,styleBackgroundShape:F.styleBackgroundShape,styleBackgroundColor:F.styleBackgroundColor,styleBorderColor:F.styleBorderColor,styleIconColor:F.styleIconColor,styleSize:F.styleSize,styleMapRotation:F.styleMapRotation!=null?String(F.styleMapRotation):null,peopleTerm:F.peopleTerm,checkpointTerm:F.checkpointTerm,isDynamic:F.isDynamic||!1,locationUpdateScopeConfigurations:F.locationUpdateScopeConfigurations||[]}),F.pendingNewChecklistItems&&F.pendingNewChecklistItems.length>0)for(const _e of F.pendingNewChecklistItems)_e.text?.trim()&&await Rt.create(t.params.eventId,{text:_e.text,scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[pe]}],displayOrder:0,isRequired:!1});if(F.pendingNewNotes&&F.pendingNewNotes.length>0)for(const _e of F.pendingNewNotes)!_e.title?.trim()&&!_e.content?.trim()||await Ps.create(t.params.eventId,{title:_e.title||"Untitled",content:_e.content||"",scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[pe]}],displayOrder:0,priority:"Normal",isPinned:!1});for(const _e of q.value)await i.deleteAssignment(t.params.eventId,_e);if(F.assignmentsToRemove&&F.assignmentsToRemove.length>0)for(const _e of F.assignmentsToRemove)await i.deleteAssignment(t.params.eventId,_e);for(const _e of O.value)await i.createAssignment({eventId:t.params.eventId,locationId:U.value.id,marshalId:_e.marshalId});if(F.checkInChanges&&F.checkInChanges.length>0)for(const _e of F.checkInChanges){const lt=U.value.assignments.find(Lt=>Lt.id===_e.assignmentId);lt&&lt.isCheckedIn!==_e.shouldBeCheckedIn&&await Ns.adminCheckIn(t.params.eventId,_e.assignmentId)}}if(!ne&&F.checklistChanges&&F.checklistChanges.length>0)for(const pe of F.checklistChanges)try{pe.complete?await Rt.complete(t.params.eventId,pe.itemId,{marshalId:pe.marshalId,contextType:pe.contextType,contextId:pe.contextId}):await Rt.uncomplete(t.params.eventId,pe.itemId,{marshalId:pe.marshalId,contextType:pe.contextType,contextId:pe.contextId})}catch(_e){console.error("Failed to update checklist item:",pe,_e)}await fn(),ss()}catch(ne){console.error("Failed to update location:",ne),alert("Failed to update location. Please try again.")}},cc=async F=>{y(`Delete ${D.value.checkpoint}`,`Are you sure you want to delete this ${D.value.checkpoint}?`,async()=>{try{await no.delete(t.params.eventId,F),await Ho(),ss()}catch(ne){console.error(`Failed to delete ${D.value.checkpoint}:`,ne),alert(`Failed to delete ${D.value.checkpoint}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},is=F=>{const ne=F?.id??F;if(ne?.toString().startsWith("temp-")){const pe=U.value.assignments.find(_e=>_e.id===ne);pe&&(O.value=O.value.filter(_e=>_e.marshalId!==pe.marshalId)),U.value.assignments=U.value.assignments.filter(_e=>_e.id!==ne),Dt()}else q.value.includes(ne)||(q.value.push(ne),U.value.assignments=U.value.assignments.filter(pe=>pe.id!==ne),Dt())},ca=async F=>{const ne=ce.value.find(_e=>_e.id===F);if(!ne)return;const pe=R.value.filter(_e=>_e.assignments?.some(lt=>lt.marshalId===F&&_e.id!==U.value.id));if(pe.length>0){ie.value={marshalName:ne.name,locations:pe.map(lt=>lt.name),marshal:ne};const _e=await new Promise(lt=>{oe.value=lt,ye.value=!0});if(_e==="cancel"||_e==="choose-other")return;if(_e==="move")for(const lt of pe){const Lt=lt.assignments.find(sn=>sn.marshalId===F);if(Lt){q.value.push(Lt.id);const sn=R.value.findIndex(xo=>xo.id===lt.id);sn!==-1&&(R.value[sn].assignments=R.value[sn].assignments.filter(xo=>xo.id!==Lt.id))}}}O.value.push({marshalId:ne.id,marshalName:ne.name}),U.value.assignments||(U.value.assignments=[]),U.value.assignments.push({id:`temp-${Date.now()}`,marshalId:ne.id,marshalName:ne.name,locationId:U.value.id,isCheckedIn:!1,isPending:!0}),Dt(),Za()},uc=async F=>{try{const pe=(await hs.create({eventId:t.params.eventId,name:F.name,email:F.email,phoneNumber:F.phoneNumber})).data;await bo(),O.value.push({marshalId:pe.id,marshalName:pe.name}),U.value&&(U.value.assignments||(U.value.assignments=[]),U.value.assignments.push({id:`temp-${Date.now()}`,marshalId:pe.id,marshalName:pe.name,locationId:U.value.id,isCheckedIn:!1,isPending:!0})),Dt(),Za()}catch(ne){console.error("Failed to create marshal:",ne),alert("Failed to create marshal. Please try again.")}},qa=()=>{we.value=null,se.value={},Q.value={id:"",name:"",email:"",phoneNumber:"",notes:""},J.value=[],$e.value=[],X.value=!1,De.value=!0},dc=F=>{we.value=F,se.value={},Q.value={id:F.id,name:F.name,email:F.email||"",phoneNumber:F.phoneNumber||"",notes:F.notes||""},J.value=[],$e.value=[],X.value=!1,De.value=!0},So=H(()=>{if(!we.value)return[];const F=[];return R.value.forEach(ne=>{ne.assignments.filter(_e=>_e.marshalName===we.value.name&&!$e.value.includes(_e.id)).forEach(_e=>{F.push({..._e,locationName:ne.name,locationDescription:ne.description||""})})}),J.value.forEach((ne,pe)=>{const _e=R.value.find(lt=>lt.id===ne.locationId);_e&&F.push({id:`pending-${pe}`,locationId:ne.locationId,locationName:_e.name,locationDescription:_e.description||"",marshalId:we.value.id,marshalName:we.value.name,isCheckedIn:!1,isPending:!0})}),F}),hc=async F=>{try{let ne=we.value?.id,pe=!1;if(we.value){if(await hs.update(t.params.eventId,we.value.id,{name:F.name,email:F.email,phoneNumber:F.phoneNumber,notes:F.notes}),F.pendingNewChecklistItems&&F.pendingNewChecklistItems.length>0)for(const _e of F.pendingNewChecklistItems)_e.text?.trim()&&await Rt.create(t.params.eventId,{text:_e.text,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[ne]}],displayOrder:0,isRequired:!1});if(F.pendingNewNotes&&F.pendingNewNotes.length>0)for(const _e of F.pendingNewNotes)!_e.title?.trim()&&!_e.content?.trim()||await Ps.create(t.params.eventId,{title:_e.title||"Untitled",content:_e.content||"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[ne]}],displayOrder:0,priority:"Normal",isPinned:!1})}else ne=(await hs.create({eventId:t.params.eventId,name:F.name,email:F.email,phoneNumber:F.phoneNumber,notes:F.notes,pendingNewChecklistItems:F.pendingNewChecklistItems||[],pendingNewNotes:F.pendingNewNotes||[]})).data.id,pe=!0;for(const _e of $e.value)await i.deleteAssignment(t.params.eventId,_e);if(F.assignmentsToRemove&&F.assignmentsToRemove.length>0)for(const _e of F.assignmentsToRemove)await i.deleteAssignment(t.params.eventId,_e);for(const _e of J.value)await i.createAssignment({eventId:t.params.eventId,locationId:_e.locationId,marshalId:ne});if(F.pendingAssignments&&F.pendingAssignments.length>0)for(const _e of F.pendingAssignments)await i.createAssignment({eventId:t.params.eventId,locationId:_e.locationId,marshalId:ne});if(F.checkInChanges&&F.checkInChanges.length>0){const _e=So.value;for(const lt of F.checkInChanges){const Lt=_e.find(sn=>sn.id===lt.assignmentId);Lt&&Lt.isCheckedIn!==lt.shouldBeCheckedIn&&await Ns.adminCheckIn(t.params.eventId,lt.assignmentId)}}if(F.checklistChanges&&F.checklistChanges.length>0)for(const _e of F.checklistChanges)try{const lt={marshalId:ne};_e.contextType&&_e.contextId&&(lt.contextType=_e.contextType,lt.contextId=_e.contextId),_e.complete?await Rt.complete(t.params.eventId,_e.itemId,lt):await Rt.uncomplete(t.params.eventId,_e.itemId,lt)}catch(lt){console.error("Failed to process checklist change:",lt);const Lt=lt.response?.data?.message||"Failed to update checklist item";alert(`Error: ${Lt}`)}if(await fn(),U.value){const _e=R.value.find(lt=>lt.id===U.value.id);_e&&(U.value=_e)}da(),pe&&(Fe.value=ne,ae.value=F.name,Ae.value=!0)}catch(ne){console.error("Failed to save marshal:",ne);const pe=ne.response?.data?.message||"Failed to save marshal. Please try again.";if(ne.response?.status===400){const _e=pe.toLowerCase();_e.includes("name")?(se.value={name:pe},ke.value&&(ke.value.switchToTab("details"),ke.value.focusField("name"))):_e.includes("email")?(se.value={email:pe},ke.value&&(ke.value.switchToTab("details"),ke.value.focusField("email"))):(se.value={general:pe},ke.value&&ke.value.switchToTab("details"))}else se.value={general:pe},ke.value&&ke.value.switchToTab("details")}},Ss=async F=>{const ne=F||we.value?.id;if(!ne){console.error("No marshal ID to delete");return}const pe=D.value.person;y(`Delete ${pe}`,`Are you sure you want to delete this ${pe}?`,async()=>{try{await hs.delete(t.params.eventId,ne),await ni(),da()}catch(_e){console.error(`Failed to delete ${pe}:`,_e),alert(`Failed to delete ${pe}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},fc=F=>{Ss(F.id)},Go=F=>{const ne=F?.id??F;if(ne?.toString().startsWith("pending-")){const pe=F?.locationId;pe&&(J.value=J.value.filter(_e=>_e.locationId!==pe)),Dt()}else $e.value.includes(ne)||($e.value.push(ne),Dt())},ua=F=>{J.value.push({locationId:F}),Dt()},da=()=>{De.value=!1,we.value=null,te.value=null,se.value={},Q.value={id:"",name:"",email:"",phoneNumber:"",notes:""},J.value=[],$e.value=[],X.value=!1},Wa=async F=>{const ne=ce.value.find(pe=>pe.id===F.marshalId);if(!ne){console.error("Marshal not found:",F.marshalId);return}te.value=U.value?.id||null,X.value=!1,we.value=ne,De.value=!0},ha=F=>{const ne=R.value.find(pe=>pe.id===F.locationId);if(!ne){console.error("Location not found:",F.locationId);return}K.value=!0,X.value=!1,U.value=ne,Te.value=!0},Ka=async({file:F})=>{const ne=await C.importMarshals(F);if(ne){await ni(),Oi();const pe=C.formatImportResultMessage(ne,"marshal");ot.value="Import Complete",st.value=pe,We.value=!0}},Oi=()=>{C.closeImportMarshalsModal()},li=F=>{oe.value&&(oe.value(F),oe.value=null),ye.value=!1},fa=async({assignment:F,status:ne})=>{try{if(ne==="not-checked-in"?F.isCheckedIn&&await Ns.adminCheckIn(t.params.eventId,F.id):F.isCheckedIn||await Ns.adminCheckIn(t.params.eventId,F.id),await Ii(),U.value){const pe=R.value.find(_e=>_e.id===U.value.id);pe&&(U.value=pe)}}catch(pe){console.error("Failed to change assignment status:",pe),alert("Failed to change status. Please try again.")}};let xs=null;const Ya=async()=>{try{const F=t.params.eventId,ne=await no.getDynamicCheckpoints(F);if(ne.data&&Array.isArray(ne.data))for(const pe of ne.data){const _e=R.value.find(lt=>lt.id===pe.checkpointId);_e&&(_e.latitude=pe.latitude,_e.longitude=pe.longitude,_e.lastLocationUpdate=pe.lastLocationUpdate)}}catch(F){console.warn("Failed to poll dynamic checkpoints:",F)}},jl=()=>{xs||!R.value.some(ne=>ne.isDynamic||ne.IsDynamic)||(Ya(),xs=setInterval(Ya,6e4))},Bi=()=>{xs&&(clearInterval(xs),xs=null)};return Ze(a,F=>{F==="course"?jl():Bi();const ne=Date.now(),pe=_e=>ne-Z.value[_e]>RR;switch(F){case"marshals":pe("marshals")&&bo();break;case"areas":pe("areas")&&wo();break;case"checkpoints":pe("checkpoints")&&xi();break;case"checklists":pe("checklists")&&co();break;case"notes":pe("notes")&&rt();break;case"incidents":pe("incidents")&&mn();break;case"contacts":pe("contacts")&&Ct();break}}),Qt(async()=>{await fn();try{const F=await ds.getMe(t.params.eventId);ms.value=F.data}catch(F){console.warn("Failed to fetch user claims:",F)}a.value==="course"&&jl()}),Ze($,F=>{F&&(document.title="OnTheDay App - Admin")},{immediate:!0}),On(()=>{Bi()}),(F,ne)=>(v(),g("div",{class:"admin-event-manage",style:ut({colorScheme:V(E)})},[r("header",LR,[r("div",SR,[r("button",{onClick:Si,class:"btn-back",title:"Back to Dashboard"},[Ee(CR,{size:48,animate:""})]),$.value?(v(),g("div",xR,[r("h1",null,w($.value.name),1),r("p",IR,w(V(kv)($.value.eventDate)),1)])):P("",!0)]),r("div",$R,[Fn.value?(v(),g("button",{key:0,onClick:_o,class:"btn btn-marshal-mode"}," Switch to Marshal ")):P("",!0)]),Ee(gv,{class:"theme-toggle-fixed"})]),r("div",TR,[r("div",MR,[Ee(_$,{tabs:N.value,"model-value":V(a),"onUpdate:modelValue":V(l)},null,8,["tabs","model-value","onUpdate:modelValue"])]),r("div",AR,[V(a)==="course"?(v(),je(Kw,{key:0,ref_key:"courseAreasTab",ref:Pe,checkpoints:R.value,areas:Ht.value,route:$.value?.route||[],"selected-area-id":Bn.value,"drawing-mode":V(Po),onMapClick:on,onLocationClick:ai,onAreaClick:_s,onImportCheckpoints:ne[0]||(ne[0]=pe=>et.value=!0),onUploadRoute:ne[1]||(ne[1]=pe=>de.value=!0),onSelectLocation:la,onAddArea:Co,onSelectArea:_s,onPolygonComplete:Ce,onCancelDrawing:Je,onAddCheckpointFromMap:zl,onAddManyCheckpointsFromMap:ac,onAddAreaFromMap:Ga,onFullscreen:ic},null,8,["checkpoints","areas","route","selected-area-id","drawing-mode"])):P("",!0),V(a)==="checkpoints"?(v(),je(GI,{key:1,locations:R.value,areas:Ht.value,onAddCheckpointManually:ja,onImportCheckpoints:ne[2]||(ne[2]=pe=>et.value=!0),onSelectLocation:la},null,8,["locations","areas"])):P("",!0),V(a)==="areas"?(v(),je(u$,{key:2,areas:Ht.value,checkpoints:R.value,contacts:bn.value,"event-people-term":$.value?.peopleTerm||"Marshals","event-checkpoint-term":$.value?.checkpointTerm||"Checkpoints",onAddArea:Co,onSelectArea:_s},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term"])):P("",!0),V(a)==="marshals"?(v(),je(xC,{key:3,marshals:ce.value,assignments:ht.value,locations:R.value,onAddMarshal:qa,onImportMarshals:ne[3]||(ne[3]=pe=>qe.value=!0),onSelectMarshal:dc,onDeleteMarshal:fc,onChangeAssignmentStatus:fa},null,8,["marshals","assignments","locations"])):P("",!0),V(a)==="checklists"?(v(),je(UC,{key:4,"checklist-items":en.value,areas:Ht.value,locations:R.value,marshals:ce.value,"completion-report":dn.value,onAddChecklistItem:uo,onSelectChecklistItem:Ti},null,8,["checklist-items","areas","locations","marshals","completion-report"])):P("",!0),V(a)==="notes"?(v(),je(s2,{key:5,notes:kn.value,areas:Ht.value,locations:R.value,marshals:ce.value,onAddNote:za,onSelectNote:zn},null,8,["notes","areas","locations","marshals"])):P("",!0),V(a)==="incidents"?(v(),je(SI,{key:6,incidents:Yn.value,areas:Ht.value,loading:Oo.value,onSelectIncident:Ei,onReportIncident:Ai},null,8,["incidents","areas","loading"])):P("",!0),V(a)==="contacts"?(v(),je(A2,{key:7,contacts:bn.value,areas:Ht.value,locations:R.value,marshals:ce.value,"available-roles":vs.value,onAddContact:Ls,onSelectContact:Di},null,8,["contacts","areas","locations","marshals","available-roles"])):P("",!0),V(a)==="details"?(v(),je(V2,{key:8,"event-data":$t.value,"form-dirty":Nt.value,onSubmit:zo,"onUpdate:formDirty":Qs},null,8,["event-data","form-dirty"])):P("",!0),V(a)==="settings"?(v(),je(tI,{key:9,"event-data":$t.value,"event-id":V(t).params.eventId,admins:V(Me),"form-dirty":Nt.value,onSubmit:zo,onAddAdmin:ne[4]||(ne[4]=pe=>ge.value=!0),onRemoveAdmin:yt,"onUpdate:formDirty":Qs},null,8,["event-data","event-id","admins","form-dirty"])):P("",!0)])]),Ee(yR,{show:re.value,location:un.value,"is-dirty":X.value,onClose:Vl,onSave:Vo,onSetOnMap:Ul,"onUpdate:isDirty":Dt,"onUpdate:location":In},null,8,["show","location","is-dirty"]),Ee(DP,{show:Te.value,location:U.value,assignments:U.value?.assignments||[],"event-date":$.value?.eventDate||"",areas:Ht.value,"event-id":V(t).params.eventId,"all-locations":R.value,notes:kn.value,"available-marshals":Js.value,"all-checklist-items":en.value,incidents:Fo.value,"is-dirty":X.value,"event-default-style-type":$.value?.defaultCheckpointStyleType||$.value?.DefaultCheckpointStyleType||"default","event-default-style-color":$.value?.defaultCheckpointStyleColor||$.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":$.value?.defaultCheckpointStyleBackgroundShape||$.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":$.value?.defaultCheckpointStyleBackgroundColor||$.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":$.value?.defaultCheckpointStyleBorderColor||$.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":$.value?.defaultCheckpointStyleIconColor||$.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":$.value?.defaultCheckpointStyleSize||$.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":$.value?.defaultCheckpointStyleMapRotation??$.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":$.value?.peopleTerm||"Marshals","z-index":qt.value?1200:K.value?1100:1e3,"locked-from-marshal":K.value,onClose:ss,onSave:ra,onDelete:cc,onMoveLocation:Gl,onRemoveAssignment:is,onOpenAssignModal:Ri,"onUpdate:isDirty":Dt,onSelectIncident:gs,onSelectMarshal:Wa},null,8,["show","location","assignments","event-date","areas","event-id","all-locations","notes","available-marshals","all-checklist-items","incidents","is-dirty","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","z-index","locked-from-marshal"]),Ee(L$,{show:me.value,link:Ys.value,"is-dirty":!1,onClose:ne[5]||(ne[5]=pe=>me.value=!1)},null,8,["show","link"]),Ee(N$,{show:Ae.value,"event-id":V(t).params.eventId,"marshal-id":Fe.value,"marshal-name":ae.value,onClose:ne[6]||(ne[6]=pe=>Ae.value=!1)},null,8,["show","event-id","marshal-id","marshal-name"]),Ee(z$,{show:V(ge),"is-dirty":X.value,onClose:Wt,onSubmit:gt,"onUpdate:isDirty":Dt},null,8,["show","is-dirty"]),Ee(Z$,{show:V(de),uploading:V(Oe),error:V(Xe),"is-dirty":X.value,onClose:mt,onSubmit:wt,"onUpdate:isDirty":Dt},null,8,["show","uploading","error","is-dirty"]),Ee(nT,{show:V(et),importing:V(tt),error:V(He),result:V(fe),"is-dirty":X.value,onClose:It,onSubmit:Tt,"onUpdate:isDirty":Dt},null,8,["show","importing","error","result","is-dirty"]),Ee(A4,{ref_key:"editMarshalModalRef",ref:ke,show:De.value,marshal:we.value,"event-id":V(t).params.eventId,assignments:So.value,"available-locations":Gt.value,"all-locations":R.value,areas:Ht.value,"is-editing":!!we.value,"event-notes":kn.value,"all-checklist-items":en.value,incidents:Xs.value,"is-dirty":X.value,"validation-errors":se.value,"locked-checkpoint-id":te.value,"z-index":te.value?1100:1e3,onClose:da,onSave:hc,onDelete:Ss,onRemoveAssignment:Go,onAssignToLocation:ua,"onUpdate:isDirty":Dt,onSelectIncident:Uo,onSelectCheckpoint:ha},null,8,["show","marshal","event-id","assignments","available-locations","all-locations","areas","is-editing","event-notes","all-checklist-items","incidents","is-dirty","validation-errors","locked-checkpoint-id","z-index"]),Ee(uT,{show:V(qe),importing:V(be),error:V(He),result:V(Ie),"is-dirty":X.value,onClose:Oi,onSubmit:Ka,"onUpdate:isDirty":Dt},null,8,["show","importing","error","result","is-dirty"]),Ee(R4,{show:ye.value,"conflict-data":ie.value,onClose:ne[7]||(ne[7]=pe=>ye.value=!1),onChoice:li},null,8,["show","conflict-data"]),Ee(j4,{show:le.value,"location-name":U.value?.name||"",marshals:Js.value,onClose:Za,onAssignExisting:ca,onCreateAndAssign:uc},null,8,["show","location-name","marshals"]),Ee(o6,{show:Pt.value,"old-event-date":jt.value,"new-event-date":cn.value,"affected-checkpoints-count":go.value,onConfirm:ei,onCancel:ti},null,8,["show","old-event-date","new-event-date","affected-checkpoints-count"]),Ee(b5,{ref_key:"editAreaModalRef",ref:ko,show:qt.value,area:bt.value,"initial-tab":yo.value,checkpoints:R.value,marshals:ce.value,areas:Ht.value,route:$.value?.route||[],"is-dirty":X.value,"event-id":V(t).params.eventId,"all-locations":R.value,assignments:ht.value,notes:kn.value,contacts:bn.value,incidents:Ft.value,"event-default-style-type":$.value?.defaultCheckpointStyleType||$.value?.DefaultCheckpointStyleType||"default","event-default-style-color":$.value?.defaultCheckpointStyleColor||$.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":$.value?.defaultCheckpointStyleBackgroundShape||$.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":$.value?.defaultCheckpointStyleBackgroundColor||$.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":$.value?.defaultCheckpointStyleBorderColor||$.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":$.value?.defaultCheckpointStyleIconColor||$.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":$.value?.defaultCheckpointStyleSize||$.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":$.value?.defaultCheckpointStyleMapRotation??$.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":$.value?.peopleTerm||"Marshals","event-checkpoint-term":$.value?.checkpointTerm||"Checkpoints",onClose:Un,onSave:bs,onDelete:nn,onDrawBoundary:he,"onUpdate:isDirty":Dt,onSelectCheckpoint:la,onCreateContactFromMarshal:sa,onCreateNewContact:ia,onEditContact:$i,onSelectIncident:ys},null,8,["show","area","initial-tab","checkpoints","marshals","areas","route","is-dirty","event-id","all-locations","assignments","notes","contacts","incidents","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","event-checkpoint-term"]),Ee(E5,{show:Do.value,"checklist-item":ao.value,"initial-tab":Ws.value,areas:Ht.value,locations:R.value,marshals:ce.value,"is-dirty":X.value,onClose:pt,onSave:aa,onDelete:Mi,"onUpdate:isDirty":Dt},null,8,["show","checklist-item","initial-tab","areas","locations","marshals","is-dirty"]),Ee(q5,{show:_n.value,note:Ro.value,"initial-tab":Ks.value,areas:Ht.value,locations:R.value,marshals:ce.value,"is-dirty":X.value,onClose:oi,onSave:ws,onDelete:Cs,"onUpdate:isDirty":Dt},null,8,["show","note","initial-tab","areas","locations","marshals","is-dirty"]),Ee(Tv,{show:lo.value,incident:hn.value,route:$.value?.route||[],checkpoints:R.value,"can-manage":!0,onClose:Ha,onStatusChange:Va,onOpenAddNote:Pi},null,8,["show","incident","route","checkpoints"]),Ee(zt,{show:Li.value,title:"Add update",size:"small",onClose:ii},{footer:Ue(()=>[r("div",PR,[r("button",{type:"button",class:"btn btn-secondary",onClick:ii}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:Xn,disabled:!Nn.value.trim()||os.value},w(os.value?"Adding...":"Add update"),9,DR)])]),default:Ue(()=>[r("div",ER,[Ve(r("textarea",{"onUpdate:modelValue":ne[8]||(ne[8]=pe=>Nn.value=pe),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[nt,Nn.value]])])]),_:1},8,["show"]),Ee(Mv,{show:ps.value,"event-id":V(t).params.eventId,checkpoint:null,"initial-location":null,checkpoints:R.value,route:$.value?.route||[],onClose:ne[9]||(ne[9]=pe=>ps.value=!1),onSubmit:si},null,8,["show","event-id","checkpoints","route"]),Ee(q8,{show:ro.value,contact:tn.value,"initial-tab":Bo.value,areas:Ht.value,locations:R.value,marshals:ce.value,"available-roles":vs.value,"is-dirty":X.value,"prefilled-name":kt.value,"prefilled-marshal-id":Mt.value,"create-from-area-context":!!Jn.value,onClose:j,onSave:Lo,onDelete:z,"onUpdate:isDirty":Dt},null,8,["show","contact","initial-tab","areas","locations","marshals","available-roles","is-dirty","prefilled-name","prefilled-marshal-id","create-from-area-context"]),Ee(lR,{show:V(io),mode:V(Vt),"context-title":V(Wn).title,"context-description":V(Wn).description,"can-complete":No.value,clickable:V(Vt)!=="draw-area","drawing-mode":V(Vt)==="draw-area"&&V(Po),locations:xn.value,areas:Ua.value,route:$.value?.route||[],"selected-area-id":Bn.value,center:V(ln),zoom:V(Qe),onMapClick:ho,onPolygonComplete:Ce,onPolygonDrawing:Re,onDone:lc,onCancel:rc},null,8,["show","mode","context-title","context-description","can-complete","clickable","drawing-mode","locations","areas","route","selected-area-id","center","zoom"]),Ee(sc,{show:We.value,title:ot.value,message:st.value,onClose:ne[10]||(ne[10]=pe=>We.value=!1)},null,8,["show","title","message"]),Ee(Pa,{show:V(u),title:V(d),message:V(p),"is-danger":V(f),"confirm-text":V(m),onConfirm:V(_),onCancel:V(b)},null,8,["show","title","message","is-danger","confirm-text","onConfirm","onCancel"])],4))}},BR=ze(OR,[["__scopeId","data-v-d9934d60"]]),NR={key:0,class:"emergency-notes-section"},FR={class:"emergency-notes-list"},UR={class:"note-header"},zR={key:0,class:"note-content"},HR={key:1,class:"emergency-contacts-section"},VR={class:"emergency-contacts-list"},GR={class:"contact-header"},jR={key:0,class:"role-badge"},ZR={class:"contact-details"},qR={key:0,class:"info-section"},WR=["href"],KR={key:1,class:"info-section"},YR=["href"],JR={key:2,class:"info-section"},XR=["href"],QR={key:2,class:"no-contacts"},eO={__name:"EmergencyContactModal",props:{show:{type:Boolean,default:!1},contacts:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const o=e,i=t,s=H(()=>o.notes?[...o.notes].sort((u,d)=>{const p=u.priority||u.Priority,f=d.priority||d.Priority;return p==="Emergency"&&f!=="Emergency"?-1:f==="Emergency"&&p!=="Emergency"?1:0}):[]),a=()=>{i("close")},l=u=>u?{EmergencyContact:"Emergency Contact",EventDirector:"Event Director",MedicalLead:"Medical Lead",SafetyOfficer:"Safety Officer",Logistics:"Logistics"}[u]||u.replace(/([A-Z])/g," $1").trim():"";return(u,d)=>(v(),je(zt,{show:e.show,title:"Emergency information",size:"medium",onClose:a},{actions:Ue(()=>[r("button",{onClick:a,class:"btn btn-secondary"},"Close")]),default:Ue(()=>[e.notes&&e.notes.length>0?(v(),g("div",NR,[d[0]||(d[0]=r("h2",{class:"section-header"},"Emergency notes",-1)),r("div",FR,[(v(!0),g(xe,null,Be(s.value,p=>(v(),g("div",{key:p.noteId||p.NoteId,class:ue(["emergency-note-item",{"is-emergency":(p.priority||p.Priority)==="Emergency"}])},[r("div",UR,[r("h3",null,w(p.title||p.Title),1),r("span",{class:ue(["priority-badge",(p.priority||p.Priority).toLowerCase()])},w(p.priority||p.Priority),3)]),p.content||p.Content?(v(),g("div",zR,w(p.content||p.Content),1)):P("",!0)],2))),128))])])):P("",!0),e.contacts&&e.contacts.length>0?(v(),g("div",HR,[d[4]||(d[4]=r("h2",{class:"section-header"},"Emergency contacts",-1)),r("div",VR,[(v(!0),g(xe,null,Be(e.contacts,p=>(v(),g("div",{key:p.contactId||p.name,class:"emergency-contact-item"},[r("div",GR,[r("h3",null,w(p.name),1),p.role?(v(),g("span",jR,w(l(p.role)),1)):P("",!0)]),r("div",ZR,[p.phone?(v(),g("div",qR,[d[1]||(d[1]=r("label",null,"Phone number",-1)),r("a",{href:`tel:${p.phone}`,class:"phone-link"},w(p.phone),9,WR)])):P("",!0),p.email?(v(),g("div",KR,[d[2]||(d[2]=r("label",null,"Email",-1)),r("a",{href:`mailto:${p.email}`,class:"email-link"},w(p.email),9,YR)])):P("",!0),p.notes||p.details?(v(),g("div",JR,[d[3]||(d[3]=r("label",null,"Details",-1)),r("p",null,w(p.notes||p.details),1)])):P("",!0)]),p.phone?(v(),g("a",{key:0,href:`tel:${p.phone}`,class:"btn btn-danger btn-full"}," Call "+w(p.name),9,XR)):P("",!0)]))),128))])])):P("",!0),(!e.contacts||e.contacts.length===0)&&(!e.notes||e.notes.length===0)?(v(),g("div",QR,[...d[5]||(d[5]=[r("p",null,"No emergency information has been set up for this event.",-1)])])):P("",!0)]),_:1},8,["show"]))}},tO=ze(eO,[["__scopeId","data-v-77c03c7e"]]),rl=M(navigator.onLine),Us=M(!0),gi=M(0),or=M(null),qi=M("idle"),Ia=M(null),mu=M(!1);let Kh=null,Oc=!1,qo=null,Yh=0;function nO(e=1e3,t=1e4){return Math.floor(Math.random()*(t-e+1))+e}function Tr(){qo&&(clearTimeout(qo),qo=null);const e=nO(1e3,1e4);console.log(`Scheduling auto-sync in ${e}ms`),qo=setTimeout(async()=>{if(qo=null,!navigator.onLine){console.log("Auto-sync cancelled: offline");return}if(await xr()===0){console.log("Auto-sync cancelled: no pending actions");return}console.log("Starting auto-sync..."),await Mr();const o=await xr();o>0&&navigator.onLine&&(console.log(`${o} actions remaining, scheduling retry...`),Tr())},e)}async function wa(){if(!navigator.onLine)return Us.value=!1,!1;try{return await x_.check(),Us.value=!0,!0}catch(e){return e.response?.status===404?(Us.value=!0,!0):(e.code==="ECONNABORTED"&&console.warn("Server health check timed out"),Us.value=!1,!1)}}async function qu(){const e=Date.now();if(e-Yh<2e3)return;Yh=e;const t=navigator.onLine;if(rl.value=t,!t){Us.value=!1;return}mu.value=!0;try{await wa()&&gi.value>0&&Tr()}finally{mu.value=!1}}function Jh(){document.visibilityState==="visible"&&(console.log("Page became visible, checking connectivity..."),qu())}function Xh(){console.log("Window focused, checking connectivity..."),qu()}async function oO(e){try{switch(e.type){case"checkin":await Ns.checkIn(e.payload);break;case"checkin_toggle":await Ns.toggleCheckIn(e.payload.eventId,e.payload.assignmentId,e.payload.gpsData||{});break;case"checkin_admin":await Ns.adminCheckIn(e.payload.eventId,e.payload.assignmentId);break;case"checklist_complete":await Rt.complete(e.payload.eventId,e.payload.itemId,e.payload.data);break;case"checklist_uncomplete":await Rt.uncomplete(e.payload.eventId,e.payload.itemId,e.payload.data);break;default:return console.warn("Unknown action type:",e.type),!1}return!0}catch(t){if(console.error("Failed to sync action:",e,t),t.response&&t.response.status===400){const o=t.response.data?.message||t.response.data||"",i=typeof o=="string"?o.toLowerCase():"";if(i.includes("already checked in"))return console.log("Action already completed (already checked in), treating as success"),!0;if(i.includes("already completed")||i.includes("already uncompleted"))return console.log("Action already completed (checklist state), treating as success"),!0}return t.response&&t.response.status>=400&&t.response.status<500?"permanent_failure":!1}}async function Mr(){if(!Oc&&navigator.onLine){Oc=!0,qi.value="syncing",Ia.value=null;try{const e=await hv();if(e.length===0){qi.value="success",gi.value=0;return}let t=0,o=0;for(const i of e){const s=await oO(i);if(s===!0)await Bh(i.id),t++;else if(s==="permanent_failure")await Bh(i.id),o++;else{const a=(i.attempts||0)+1;a>=5?(await Oh(i.id,{status:"failed",attempts:a,lastAttempt:new Date().toISOString()}),o++):await Oh(i.id,{status:"retrying",attempts:a,lastAttempt:new Date().toISOString()})}}gi.value=await xr(),o>0?(qi.value="error",Ia.value=`${o} action(s) failed to sync`):qi.value="success"}catch(e){console.error("Sync error:",e),qi.value="error",Ia.value="Failed to sync pending actions"}finally{Oc=!1}}}function sO(){Kh||(Kh=setInterval(async()=>{navigator.onLine&&(await wa(),Us.value&&gi.value>0&&await Mr())},3e4))}function Wu(){const e=H(()=>rl.value&&Us.value);async function t(){gi.value=await xr()}async function o(){rl.value=!0,await wa()&&gi.value>0&&Tr()}function i(){rl.value=!1,Us.value=!1,qo&&(clearTimeout(qo),qo=null)}Qt(async()=>{await qs(),await t(),window.addEventListener("online",o),window.addEventListener("offline",i),document.addEventListener("visibilitychange",Jh),window.addEventListener("focus",Xh),navigator.onLine&&await wa()&&gi.value>0&&Tr(),sO()}),On(()=>{window.removeEventListener("online",o),window.removeEventListener("offline",i),document.removeEventListener("visibilitychange",Jh),window.removeEventListener("focus",Xh),qo&&(clearTimeout(qo),qo=null)});async function s(d,p){if(!e.value)return console.warn("Cannot refresh cache while offline"),!1;try{const f=await p();return await $l(d,f),or.value=new Date().toISOString(),!0}catch(f){return console.error("Failed to refresh cache:",f),!1}}async function a(d){const p=await ki(d);return p&&(or.value=p.cachedAt),p}async function l(d){or.value=await __(d)}async function u(){return navigator.onLine?await wa()?(await Mr(),qi.value==="success"):(Ia.value="Server is not responding",!1):(Ia.value="Cannot sync while offline",!1)}return{isOnline:rl,isServerHealthy:Us,isFullyOnline:e,isCheckingStatus:mu,pendingActionsCount:gi,lastSyncTime:or,syncStatus:qi,syncError:Ia,checkServerHealth:wa,quickConnectivityCheck:qu,syncPendingActions:Mr,updatePendingCount:t,refreshCache:s,getCachedData:a,loadLastSyncTime:l,forcSync:u}}const iO={class:"area-lead-content"},aO={key:0,class:"loading-state"},lO={key:1,class:"error-state"},rO={key:2,class:"empty-state"},cO={key:3,class:"checkpoint-accordion"},uO=["onClick"],dO={class:"checkpoint-header-content"},hO={class:"checkpoint-title-row"},fO={class:"checkpoint-name"},pO={key:0,class:"area-badge"},vO={key:0,class:"checkpoint-description-preview"},mO={class:"checkpoint-status-row"},gO={class:"status-badge marshals-status"},yO={key:0,class:"status-badge tasks-status"},kO={class:"accordion-icon"},_O={key:0,class:"checkpoint-accordion-content"},bO={class:"checkpoint-mini-map"},wO={class:"checkpoint-marshals-section"},CO={class:"marshals-label"},LO={key:0,class:"empty-state"},SO={key:1,class:"marshals-list"},xO=["onClick"],IO={class:"marshal-header"},$O={class:"marshal-name-row"},TO={class:"marshal-name"},MO={key:0,class:"task-count"},AO={class:"check-status-row"},EO=["onClick","disabled"],PO={key:0,class:"check-in-time"},DO={key:0},RO={key:1,class:"last-access-time"},OO={key:0,class:"checkpoint-tasks-section"},BO={class:"marshals-label"},NO={class:"tasks-list"},FO=["disabled","onChange"],UO={class:"task-text"},zO=["disabled","onChange"],HO={class:"task-text"},VO={key:0,class:"marshal-details-modal"},GO={class:"details-section"},jO={class:"contact-info"},ZO={key:0,class:"contact-row"},qO=["href"],WO={key:1,class:"contact-row"},KO=["href"],YO={key:2,class:"no-contact"},JO={class:"details-section"},XO={key:0,class:"checked-in-section"},QO={class:"checked-in-details"},eB={class:"check-time-detail"},tB={key:0,class:"check-method"},nB=["disabled"],oB={key:1,class:"not-checked-in-section"},sB=["disabled"],iB={key:2,class:"last-access-detail"},aB={class:"details-section"},lB={key:0,class:"no-tasks"},rB={key:1,class:"tasks-list modal-tasks"},cB=["disabled","onChange"],uB={class:"task-text"},dB={class:"details-section contact-actions-section"},hB={class:"contact-buttons"},fB=["href"],pB=["href"],vB=["href"],mB={__name:"AreaLeadSection",props:{eventId:{type:String,required:!0},areaIds:{type:Array,default:()=>[]},marshalId:{type:String,required:!0},route:{type:Array,default:()=>[]}},emits:["checklist-updated","loaded","checkin-updated"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=St(),{updatePendingCount:a}=Wu(),l=e,u=o,d=M(!1),p=M(null),f=M([]),m=M([]),y=M(null),_=M(!1),b=M(null),S=H(()=>{const ae=new Set(l.areaIds);return ae.size===0?[...m.value].sort((Me,ge)=>js(Me.name,ge.name)):m.value.filter(Me=>(Me.areaIds||[]).some(de=>ae.has(de))).sort((Me,ge)=>js(Me.name,ge.name))}),T=(ae,Me=60)=>ae?ae.length<=Me?ae:ae.substring(0,Me).trim()+"...":"",D=M(!1),I=M(null),C=M(null),A=async()=>{if(!(!l.eventId||l.areaIds.length===0)){if(d.value=!0,p.value=null,Mn()){try{const ae=await ki(l.eventId);if(ae?.areaLeadDashboard){f.value=ae.areaLeadDashboard.areas||[],m.value=ae.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(ae){console.warn("Failed to load cached dashboard:",ae)}p.value="Offline - no cached data available",d.value=!1;return}try{const ae=await mi.getAreaLeadDashboard(l.eventId);f.value=ae.data.areas||[],m.value=ae.data.checkpoints||[];try{const Me=JSON.parse(JSON.stringify({areas:f.value,checkpoints:m.value}));await ki(l.eventId)?await hr(l.eventId,"areaLeadDashboard",Me):await $l(l.eventId,{areaLeadDashboard:Me})}catch(Me){console.warn("Failed to cache dashboard:",Me)}}catch(ae){console.error("Failed to load area lead dashboard:",ae);try{const Me=await ki(l.eventId);if(Me?.areaLeadDashboard){console.log("Loading area lead dashboard from cache after error"),f.value=Me.areaLeadDashboard.areas||[],m.value=Me.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(Me){console.warn("Failed to load cached dashboard:",Me)}p.value=ae.response?.data?.message||"Failed to load dashboard"}finally{d.value=!1}}},E=ae=>{y.value=y.value===ae?null:ae},N=ae=>ae.marshals.filter(Me=>Me.isCheckedIn).length,$=ae=>{const Me=ae.marshals.reduce((ge,de)=>ge+de.outstandingTaskCount,0);return ae.outstandingTaskCount+Me},G=(ae,Me)=>{I.value=ae,C.value=Me,D.value=!0},R=()=>{D.value=!1,I.value=null,C.value=null},Z=async(ae,Me)=>{if(b.value)return;const ge=ae.assignmentId||ae.id;if(!ge){console.error("No assignment ID found for marshal:",ae);return}b.value=ae.marshalId;try{if(Mn())await po("checkin_toggle",{eventId:l.eventId,assignmentId:ge}),ae.isCheckedIn=!0,ae.checkInTime=new Date().toISOString(),ae.checkInMethod="AreaLead (pending)",await a(),u("checkin-updated");else if(await Ns.toggleCheckIn(l.eventId,ge),await A(),u("checkin-updated"),I.value?.marshalId===ae.marshalId&&C.value){const de=m.value.find(Oe=>Oe.checkpointId===C.value.checkpointId);if(de){const Oe=de.marshals.find(Xe=>Xe.marshalId===ae.marshalId);Oe&&(I.value=Oe)}}}catch(de){console.error("Failed to check in marshal:",de),(Mn()||!de.response)&&(await po("checkin_toggle",{eventId:l.eventId,assignmentId:ge}),ae.isCheckedIn=!0,ae.checkInTime=new Date().toISOString(),ae.checkInMethod="AreaLead (pending)",await a(),u("checkin-updated"))}finally{b.value=null}},U=async(ae,Me)=>{if(_.value)return;_.value=!0;const de={marshalId:Me.marshals.length>0?Me.marshals[0].marshalId:l.marshalId,contextType:ae.contextType,contextId:ae.contextId};try{Mn()?(await po("checklist_complete",{eventId:l.eventId,itemId:ae.itemId,data:de}),Me.outstandingTasks=Me.outstandingTasks.filter(Oe=>Oe.itemId!==ae.itemId),Me.outstandingTaskCount=Math.max(0,Me.outstandingTaskCount-1),await a(),u("checklist-updated")):(await Rt.complete(l.eventId,ae.itemId,de),await A(),u("checklist-updated"))}catch(Oe){console.error("Failed to complete task:",Oe),(Mn()||!Oe.response)&&(await po("checklist_complete",{eventId:l.eventId,itemId:ae.itemId,data:de}),Me.outstandingTasks=Me.outstandingTasks.filter(Xe=>Xe.itemId!==ae.itemId),Me.outstandingTaskCount=Math.max(0,Me.outstandingTaskCount-1),await a(),u("checklist-updated"))}finally{_.value=!1}},K=async(ae,Me)=>{if(_.value)return;_.value=!0;const de={marshalId:Me.marshals.length>0?Me.marshals[0].marshalId:l.marshalId,contextType:ae.contextType,contextId:ae.contextId,actorMarshalId:l.marshalId};try{Mn()?(await po("checklist_uncomplete",{eventId:l.eventId,itemId:ae.itemId,data:de}),Me.completedTasks&&(Me.completedTasks=Me.completedTasks.filter(Oe=>Oe.itemId!==ae.itemId)),Me.outstandingTasks||(Me.outstandingTasks=[]),Me.outstandingTasks.push(ae),Me.outstandingTaskCount=(Me.outstandingTaskCount||0)+1,await a(),u("checklist-updated")):(await Rt.uncomplete(l.eventId,ae.itemId,de),await A(),u("checklist-updated"))}catch(Oe){console.error("Failed to uncomplete task:",Oe),(Mn()||!Oe.response)&&(await po("checklist_uncomplete",{eventId:l.eventId,itemId:ae.itemId,data:de}),Me.completedTasks&&(Me.completedTasks=Me.completedTasks.filter(Xe=>Xe.itemId!==ae.itemId)),Me.outstandingTasks||(Me.outstandingTasks=[]),Me.outstandingTasks.push(ae),Me.outstandingTaskCount=(Me.outstandingTaskCount||0)+1,await a(),u("checklist-updated"))}finally{_.value=!1}},re=async ae=>{if(_.value||!I.value)return;_.value=!0;const Me={marshalId:I.value.marshalId,contextType:ae.contextType,contextId:ae.contextId};try{if(Mn())await po("checklist_complete",{eventId:l.eventId,itemId:ae.itemId,data:Me}),I.value.outstandingTasks=I.value.outstandingTasks.filter(ge=>ge.itemId!==ae.itemId),I.value.outstandingTaskCount=Math.max(0,I.value.outstandingTaskCount-1),await a(),u("checklist-updated");else{if(await Rt.complete(l.eventId,ae.itemId,Me),await A(),I.value&&C.value){const ge=m.value.find(de=>de.checkpointId===C.value.checkpointId);if(ge){const de=ge.marshals.find(Oe=>Oe.marshalId===I.value.marshalId);de&&(I.value=de)}}u("checklist-updated")}}catch(ge){console.error("Failed to complete task:",ge),(Mn()||!ge.response)&&(await po("checklist_complete",{eventId:l.eventId,itemId:ae.itemId,data:Me}),I.value.outstandingTasks=I.value.outstandingTasks.filter(de=>de.itemId!==ae.itemId),I.value.outstandingTaskCount=Math.max(0,I.value.outstandingTaskCount-1),await a(),u("checklist-updated"))}finally{_.value=!1}},Pe=ae=>ae?new Date(ae).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",me=ae=>ae?new Date(ae).toLocaleString():"",Ae=ae=>{if(!ae)return"";const Me=new Date(ae),de=new Date-Me,Oe=Math.floor(de/6e4),Xe=Math.floor(Oe/60),et=Math.floor(Xe/24);return Oe<1?"just now":Oe<60?`${Oe}m ago`:Xe<24?`${Xe}h ago`:et===1?"yesterday":et<7?`${et}d ago`:Me.toLocaleDateString()},Fe=ae=>({GPS:"GPS",Manual:"Manual",Admin:"Admin",AreaLead:`${i.value.area} Lead`})[ae]||ae;return t({areas:f,checkpoints:m,loading:d,loadDashboard:A}),Ze(()=>l.eventId,()=>{A()},{immediate:!0}),(ae,Me)=>(v(),g("div",iO,[d.value?(v(),g("div",aO," Loading dashboard... ")):p.value?(v(),g("div",lO,[r("p",null,w(p.value),1),r("button",{onClick:A,class:"btn btn-secondary"},"Retry")])):S.value.length===0?(v(),g("div",rO,[r("p",null,"No "+w(V(s).checkpoints)+" in your "+w(V(s).areas)+".",1)])):(v(),g("div",cO,[(v(!0),g(xe,null,Be(S.value,ge=>(v(),g("div",{key:ge.checkpointId,class:"checkpoint-accordion-section"},[r("button",{class:ue(["checkpoint-accordion-header",{active:y.value===ge.checkpointId}]),onClick:de=>E(ge.checkpointId)},[r("div",dO,[r("div",hO,[r("span",fO,w(ge.name),1),ge.areaName?(v(),g("span",pO,w(ge.areaName),1)):P("",!0)]),ge.description?(v(),g("div",vO,w(T(ge.description)),1)):P("",!0),r("div",mO,[r("span",gO,w(N(ge))+" / "+w(ge.marshals.length)+" checked in ",1),$(ge)>0?(v(),g("span",yO,w($(ge))+" tasks ",1)):P("",!0)])]),r("span",kO,w(y.value===ge.checkpointId?"":"+"),1)],10,uO),y.value===ge.checkpointId?(v(),g("div",_O,[r("div",bO,[Ee(oa,{locations:[{id:ge.checkpointId,name:ge.name,description:ge.description,latitude:ge.latitude,longitude:ge.longitude}],route:e.route,center:{lat:ge.latitude,lng:ge.longitude},zoom:16,"highlight-location-id":ge.checkpointId,"marshal-mode":!0,height:"280px"},null,8,["locations","route","center","highlight-location-id"])]),r("div",wO,[r("div",CO,w(V(i).people)+" ("+w(ge.marshals.length)+")",1),ge.marshals.length===0?(v(),g("div",LO," No "+w(V(s).people)+" assigned to this "+w(V(s).checkpoint)+". ",1)):(v(),g("div",SO,[(v(!0),g(xe,null,Be(ge.marshals,de=>(v(),g("div",{key:de.marshalId,class:ue(["marshal-card",{"is-checked-in":de.isCheckedIn}]),onClick:Oe=>G(de,ge)},[r("div",IO,[r("div",$O,[r("span",TO,w(de.name),1),de.outstandingTaskCount>0?(v(),g("span",MO,w(de.outstandingTaskCount)+" tasks ",1)):P("",!0)]),r("div",AO,[r("div",{class:ue(["check-status",{"checked-in":de.isCheckedIn}])},w(de.isCheckedIn?" Checked In":"Not Checked In"),3),r("button",{onClick:dt(Oe=>Z(de),["stop"]),class:ue(["quick-checkin-btn",{"undo-btn":de.isCheckedIn}]),disabled:b.value===de.marshalId},w(b.value===de.marshalId?"...":de.isCheckedIn?"Undo":"Check In"),11,EO)])]),de.isCheckedIn&&de.checkInTime?(v(),g("div",PO,[Ke(w(Pe(de.checkInTime))+" ",1),de.checkInMethod?(v(),g("span",DO," ("+w(Fe(de.checkInMethod))+")",1)):P("",!0)])):P("",!0),de.lastAccessedAt?(v(),g("div",RO," Last active: "+w(Ae(de.lastAccessedAt)),1)):P("",!0)],10,xO))),128))]))]),ge.outstandingTaskCount>0||ge.completedTasks&&ge.completedTasks.length>0?(v(),g("div",OO,[r("div",BO,w(V(i).checkpoint)+" tasks",1),r("div",NO,[(v(!0),g(xe,null,Be(ge.outstandingTasks,de=>(v(),g("div",{key:de.itemId,class:"task-item"},[r("input",{type:"checkbox",disabled:_.value,onChange:Oe=>U(de,ge)},null,40,FO),r("span",UO,w(de.text),1)]))),128)),(v(!0),g(xe,null,Be(ge.completedTasks||[],de=>(v(),g("div",{key:`completed-${de.itemId}`,class:"task-item task-completed"},[r("input",{type:"checkbox",checked:"",disabled:_.value,onChange:Oe=>K(de,ge)},null,40,zO),r("span",HO,w(de.text),1)]))),128))])])):P("",!0)])):P("",!0)]))),128))])),Ee(zt,{show:D.value,title:I.value?.name||"Marshal Details",size:"large",onClose:R},{actions:Ue(()=>[r("button",{onClick:R,class:"btn btn-secondary"},"Close")]),default:Ue(()=>[I.value?(v(),g("div",VO,[r("div",GO,[Me[4]||(Me[4]=r("h4",null,"Contact Details",-1)),r("div",jO,[I.value.email?(v(),g("div",ZO,[Me[2]||(Me[2]=r("span",{class:"contact-label"},"Email:",-1)),r("a",{href:`mailto:${I.value.email}`},w(I.value.email),9,qO)])):P("",!0),I.value.phoneNumber?(v(),g("div",WO,[Me[3]||(Me[3]=r("span",{class:"contact-label"},"Phone:",-1)),r("a",{href:`tel:${I.value.phoneNumber}`},w(I.value.phoneNumber),9,KO)])):P("",!0),!I.value.email&&!I.value.phoneNumber?(v(),g("div",YO," No contact details available. ")):P("",!0)])]),r("div",JO,[Me[8]||(Me[8]=r("h4",null,"Check-in Status",-1)),I.value.isCheckedIn?(v(),g("div",XO,[r("div",QO,[Me[6]||(Me[6]=r("span",{class:"check-icon"},"",-1)),r("div",null,[Me[5]||(Me[5]=r("strong",null,"Checked In",-1)),r("p",eB,w(me(I.value.checkInTime)),1),I.value.checkInMethod?(v(),g("p",tB," Method: "+w(Fe(I.value.checkInMethod)),1)):P("",!0)])]),r("button",{onClick:Me[0]||(Me[0]=ge=>Z(I.value,C.value)),class:"btn btn-secondary undo-checkin-btn",disabled:b.value===I.value.marshalId},w(b.value===I.value.marshalId?"Undoing...":"Undo Check-in"),9,nB)])):(v(),g("div",oB,[Me[7]||(Me[7]=r("div",{class:"not-checked-in"},[r("span",{class:"not-checked-icon"},""),r("span",null,"Not checked in")],-1)),r("button",{onClick:Me[1]||(Me[1]=ge=>Z(I.value,C.value)),class:"btn btn-primary check-in-btn",disabled:b.value===I.value.marshalId},w(b.value===I.value.marshalId?"Checking in...":"Check In"),9,sB)])),I.value.lastAccessedAt?(v(),g("div",iB," Last active: "+w(Ae(I.value.lastAccessedAt)),1)):P("",!0)]),r("div",aB,[r("h4",null,w(V(i).checklists)+" ("+w(I.value.outstandingTasks?.length||0)+" outstanding)",1),!I.value.outstandingTasks||I.value.outstandingTasks.length===0?(v(),g("div",lB," No outstanding tasks. ")):(v(),g("div",rB,[(v(!0),g(xe,null,Be(I.value.outstandingTasks,ge=>(v(),g("div",{key:ge.itemId,class:"task-item"},[r("input",{type:"checkbox",disabled:_.value,onChange:de=>re(ge)},null,40,cB),r("span",uB,w(ge.text),1)]))),128))]))]),r("div",dB,[r("div",hB,[I.value.phoneNumber?(v(),g("a",{key:0,href:`tel:${I.value.phoneNumber}`,class:"btn btn-primary"}," Call ",8,fB)):P("",!0),I.value.phoneNumber?(v(),g("a",{key:1,href:`sms:${I.value.phoneNumber}`,class:"btn btn-secondary"}," Text ",8,pB)):P("",!0),I.value.email?(v(),g("a",{key:2,href:`mailto:${I.value.email}`,class:"btn btn-secondary"}," Email ",8,vB)):P("",!0)])])])):P("",!0)]),_:1},8,["show","title"])]))}},gB=ze(mB,[["__scopeId","data-v-067e0528"]]),yB={class:"offline-indicator-container"},kB={class:"offline-icon"},_B={key:0,viewBox:"0 0 24 24",fill:"currentColor"},bB={key:1,class:"spinner",viewBox:"0 0 24 24",fill:"currentColor"},wB={class:"offline-text"},CB={key:0,class:"last-sync"},LB={class:"pending-text"},SB={key:0,class:"pending-subtext"},xB={key:1,class:"syncing-text"},IB={__name:"OfflineIndicator",setup(e){const{isOnline:t,isFullyOnline:o,isCheckingStatus:i,pendingActionsCount:s,lastSyncTime:a,syncStatus:l,syncError:u,forcSync:d}=Wu(),p=M(!1),f=M(""),m=M(""),y=H(()=>{if(!a.value)return"";const b=new Date(a.value),T=new Date-b,D=Math.floor(T/6e4),I=Math.floor(D/60);return D<1?"just now":D<60?`${D}m ago`:I<24?`${I}h ago`:b.toLocaleDateString()}),_=async()=>{await d()};return Ze(l,b=>{b==="success"&&s.value===0?(f.value="All actions synced successfully!",m.value="success",p.value=!0,setTimeout(()=>{p.value=!1},3e3)):b==="error"&&(f.value=u.value||"Sync failed",m.value="error",p.value=!0,setTimeout(()=>{p.value=!1},5e3))}),(b,S)=>(v(),g("div",yB,[Ee(Xi,{name:"slide"},{default:Ue(()=>[V(o)?P("",!0):(v(),g("div",{key:0,class:ue(["offline-banner",{checking:V(i)}])},[r("span",kB,[V(i)?(v(),g("svg",bB,[...S[1]||(S[1]=[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8z"},null,-1)])])):(v(),g("svg",_B,[...S[0]||(S[0]=[r("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"},null,-1)])]))]),r("span",wB,w(V(i)?"Checking connection...":V(t)?"Server unavailable":"You're offline"),1),V(a)&&!V(i)?(v(),g("span",CB," Last synced: "+w(y.value),1)):P("",!0)],2))]),_:1}),Ee(Xi,{name:"fade"},{default:Ue(()=>[V(s)>0?(v(),g("div",{key:0,class:ue(["pending-banner",{"offline-pending":!V(o)}])},[S[2]||(S[2]=r("span",{class:"pending-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})])],-1)),r("span",LB,[Ke(w(V(s))+" pending action"+w(V(s)!==1?"s":"")+" ",1),V(o)?P("",!0):(v(),g("span",SB,"(will sync when online)"))]),V(o)&&V(l)!=="syncing"?(v(),g("button",{key:0,onClick:_,class:"sync-button"}," Sync Now ")):V(l)==="syncing"?(v(),g("span",xB,"Syncing...")):P("",!0)],2)):P("",!0)]),_:1}),Ee(Xi,{name:"fade"},{default:Ue(()=>[p.value?(v(),g("div",{key:0,class:ue(["sync-toast",m.value])},w(f.value),3)):P("",!0)]),_:1})]))}},$B=ze(IB,[["__scopeId","data-v-9c1e58f4"]]),TB={class:"check-in-toggle-container"},MB=["disabled"],AB={key:0,class:"toggle-spinner"},EB={key:1,class:"toggle-icon"},PB={class:"toggle-label"},DB={key:0,class:"check-in-details"},RB={key:0,class:"check-in-method"},OB={__name:"CheckInToggleButton",props:{isCheckedIn:{type:Boolean,default:!1},checkInTime:{type:String,default:null},checkInMethod:{type:String,default:null},checkedInBy:{type:String,default:null},marshalName:{type:String,default:null},isLoading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["toggle"],setup(e){const t=e,o=H(()=>t.isLoading?t.isCheckedIn?"Checking out...":"Checking in...":t.isCheckedIn?"Checked in":"Check in"),i=H(()=>{const{checkedInBy:a,checkInMethod:l,marshalName:u}=t;return a&&a!==u?a:l||""}),s=a=>a?new Date(a).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"";return(a,l)=>(v(),g("div",TB,[r("button",{class:ue(["check-in-toggle",{"is-checked-in":e.isCheckedIn}]),disabled:e.disabled||e.isLoading,onClick:l[0]||(l[0]=u=>a.$emit("toggle"))},[e.isLoading?(v(),g("span",AB)):e.isCheckedIn?(v(),g("span",EB,"")):P("",!0),r("span",PB,w(o.value),1)],10,MB),e.isCheckedIn&&e.checkInTime&&!e.isLoading?(v(),g("span",DB,[Ke(w(s(e.checkInTime))+" ",1),i.value?(v(),g("span",RB,"("+w(i.value)+")",1)):P("",!0)])):P("",!0)]))}},gu=ze(OB,[["__scopeId","data-v-95f8f1cc"]]),BB={class:"modal-content check-in-reminder-modal"},NB={class:"modal-header warning"},FB={class:"modal-body"},UB={class:"reminder-message"},zB={key:0},HB={class:"reminder-hint"},VB={class:"modal-footer"},GB={__name:"CheckInReminderModal",props:{show:{type:Boolean,required:!0},checkpoint:{type:Object,default:null},checkpointTerm:{type:String,default:"Checkpoint"},accentButtonStyle:{type:Object,default:()=>({})}},emits:["dismiss","go-to-checkpoint"],setup(e){return(t,o)=>(v(),je(Xi,{name:"modal"},{default:Ue(()=>[e.show&&e.checkpoint?(v(),g("div",{key:0,class:"modal-overlay",onClick:o[3]||(o[3]=dt(i=>t.$emit("dismiss"),["self"]))},[r("div",BB,[r("div",NB,[o[4]||(o[4]=r("h3",null,"Check-in reminder",-1)),r("button",{class:"modal-close",onClick:o[0]||(o[0]=i=>t.$emit("dismiss"))},"")]),r("div",FB,[o[6]||(o[6]=r("div",{class:"reminder-icon"},"",-1)),r("p",UB,[Ke(" You have not checked in yet to "+w(e.checkpointTerm.toLowerCase())+" ",1),r("strong",null,w(e.checkpoint.location?.name),1),e.checkpoint.location?.description?(v(),g("span",zB," - "+w(e.checkpoint.location.description),1)):P("",!0),o[5]||(o[5]=Ke(". ",-1))]),r("p",HB," Please check in when you arrive at your "+w(e.checkpointTerm.toLowerCase())+". ",1)]),r("div",VB,[r("button",{onClick:o[1]||(o[1]=i=>t.$emit("dismiss")),class:"btn btn-secondary"}," Dismiss "),r("button",{onClick:o[2]||(o[2]=i=>t.$emit("go-to-checkpoint")),class:"btn btn-primary",style:ut(e.accentButtonStyle)}," Go to "+w(e.checkpointTerm),5)])])])):P("",!0)]),_:1}))}},jB=ze(GB,[["__scopeId","data-v-0e7c79a6"]]),ZB={class:"modal-content location-update-modal"},qB={class:"modal-header"},WB={class:"modal-body"},KB={key:0,class:"success-message"},YB={key:1},JB={class:"modal-description"},XB={key:0,class:"last-update-info"},QB={key:1,class:"gps-status active"},eN={class:"update-option"},tN=["disabled"],nN={class:"update-option auto-update-option"},oN={class:"checkbox-label"},sN=["checked"],iN={class:"option-hint"},aN={class:"update-option"},lN=["disabled"],rN={class:"update-option"},cN={class:"option-label"},uN={key:0,class:"checkpoint-list"},dN=["onClick","disabled"],hN={key:1,class:"no-checkpoints"},fN={key:2,class:"error"},pN={class:"modal-footer"},vN={__name:"LocationUpdateModal",props:{show:{type:Boolean,required:!0},assignment:{type:Object,default:null},userLocation:{type:Object,default:null},autoUpdateEnabled:{type:Boolean,default:!1},updating:{type:Boolean,default:!1},error:{type:String,default:""},success:{type:String,default:""},availableCheckpoints:{type:Array,default:()=>[]},checkpointTerm:{type:String,default:"Checkpoint"},checkpointTermPlural:{type:String,default:"Checkpoints"},accentButtonStyle:{type:Object,default:()=>({})}},emits:["close","update-gps","toggle-auto-update","select-on-map","copy-from-checkpoint"],setup(e){const t=e,o=H(()=>t.checkpointTerm.toLowerCase()),i=H(()=>t.checkpointTermPlural.toLowerCase()),s=a=>a?new Date(a).toLocaleString():"";return(a,l)=>(v(),je(Xi,{name:"modal"},{default:Ue(()=>[e.show?(v(),g("div",{key:0,class:"modal-overlay",onClick:l[5]||(l[5]=dt(u=>a.$emit("close"),["self"]))},[r("div",ZB,[r("div",qB,[r("h3",null,"Update "+w(o.value)+" location",1),r("button",{class:"modal-close",onClick:l[0]||(l[0]=u=>a.$emit("close"))},"")]),r("div",WB,[e.success?(v(),g("div",KB,w(e.success),1)):(v(),g("div",YB,[r("p",JB,[l[6]||(l[6]=Ke(" Update the position of ",-1)),r("strong",null,w(e.assignment?.location?.name),1)]),e.assignment?.location?.lastLocationUpdate?(v(),g("div",XB," Last updated: "+w(s(e.assignment.location.lastLocationUpdate)),1)):P("",!0),e.userLocation?(v(),g("div",QB,[...l[7]||(l[7]=[r("svg",{class:"status-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),Ke(" GPS active ",-1)])])):P("",!0),r("div",eN,[r("button",{onClick:l[1]||(l[1]=u=>a.$emit("update-gps")),class:"btn btn-primary btn-full",disabled:e.updating,style:ut(e.accentButtonStyle)},[l[8]||(l[8]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),Ke(" "+w(e.updating?"Updating...":"Use current GPS location"),1)],12,tN)]),r("div",nN,[r("label",oN,[r("input",{type:"checkbox",checked:e.autoUpdateEnabled,onChange:l[2]||(l[2]=u=>a.$emit("toggle-auto-update"))},null,40,sN),l[9]||(l[9]=r("span",null,"Auto-update every 60 seconds",-1))]),r("p",iN,"Automatically updates the "+w(o.value)+" location using your GPS every minute.",1)]),r("div",aN,[r("button",{onClick:l[3]||(l[3]=u=>a.$emit("select-on-map")),class:"btn btn-secondary btn-full",disabled:e.updating},[...l[10]||(l[10]=[r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"})],-1),Ke(" Select location on map ",-1)])],8,lN)]),r("div",rN,[r("label",cN,"Or copy location from another "+w(o.value)+":",1),e.availableCheckpoints.length>0?(v(),g("div",uN,[(v(!0),g(xe,null,Be(e.availableCheckpoints,u=>(v(),g("button",{key:u.id,onClick:d=>a.$emit("copy-from-checkpoint",u.id),class:"btn btn-secondary btn-checkpoint-source",disabled:e.updating},w(u.name),9,dN))),128))])):(v(),g("p",hN," No other "+w(i.value)+" available to copy from. ",1))]),e.error?(v(),g("div",fN,w(e.error),1)):P("",!0)]))]),r("div",pN,[r("button",{onClick:l[4]||(l[4]=u=>a.$emit("close")),class:"btn btn-secondary"}," Cancel ")])])])):P("",!0)]),_:1}))}},mN=ze(vN,[["__scopeId","data-v-ab7e1505"]]),gN={class:"contact-info"},yN={class:"contact-name-row"},kN={key:0,class:"primary-badge"},_N={class:"contact-name"},bN={key:0,class:"contact-notes-text"},wN={key:1,class:"contact-detail"},CN={key:2,class:"contact-detail"},LN={class:"contact-actions"},SN=["href"],xN=["href"],IN=["href"],$N={__name:"ContactCard",props:{name:{type:String,required:!0},role:{type:String,default:""},phone:{type:String,default:""},email:{type:String,default:""},notes:{type:String,default:""},isPrimary:{type:Boolean,default:!1}},setup(e){const t=e,o=["Emergency","Safety","Medical","First Aid"],i=H(()=>t.role?o.some(a=>t.role.toLowerCase().includes(a.toLowerCase())):!1),s=H(()=>t.role?t.role.replace(/([A-Z])/g," $1").replace(/^./,a=>a.toUpperCase()).trim():"");return(a,l)=>(v(),g("div",{class:ue(["contact-item",{"primary-contact":e.isPrimary}])},[r("div",gN,[r("div",yN,[e.isPrimary?(v(),g("span",kN,"")):P("",!0),r("span",_N,w(e.name),1),e.role?(v(),g("span",{key:1,class:ue(["contact-role-badge",{"emergency-role":i.value}])},w(s.value),3)):P("",!0)]),e.notes?(v(),g("div",bN,w(e.notes),1)):P("",!0),e.phone?(v(),g("div",wN,w(e.phone),1)):P("",!0),e.email?(v(),g("div",CN,w(e.email),1)):P("",!0)]),r("div",LN,[e.phone?(v(),g("a",{key:0,href:`tel:${e.phone}`,class:"contact-link"},[...l[0]||(l[0]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Ke(" Call ",-1)])],8,SN)):P("",!0),e.phone?(v(),g("a",{key:1,href:`sms:${e.phone}`,class:"contact-link"},[...l[1]||(l[1]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Ke(" Text ",-1)])],8,xN)):P("",!0),e.email?(v(),g("a",{key:2,href:`mailto:${e.email}`,class:"contact-link"},[...l[2]||(l[2]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Ke(" Email ",-1)])],8,IN)):P("",!0)])],2))}},Av=ze($N,[["__scopeId","data-v-6cf4fca2"]]),TN={key:0,class:"accordion-section"},MN={class:"accordion-title"},AN=["innerHTML"],EN={class:"accordion-icon"},PN={key:0,class:"accordion-content"},DN={key:0,class:"loading"},RN={key:1,class:"contact-list"},ON={__name:"MarshalContactsSection",props:{contacts:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){return(t,o)=>e.contacts.length>0||e.loading?(v(),g("div",TN,[r("button",{class:ue(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=i=>t.$emit("toggle"))},[r("span",MN,[r("span",{class:"section-icon",innerHTML:V(Sn)("contacts")},null,8,AN),Ke(" Your "+w(e.contacts.length===1?"contact":"contacts")+w(e.contacts.length>1?` (${e.contacts.length})`:""),1)]),r("span",EN,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",PN,[e.loading?(v(),g("div",DN,"Loading contacts...")):(v(),g("div",RN,[(v(!0),g(xe,null,Be(e.contacts,i=>(v(),je(Av,{key:i.contactId,name:i.name,role:i.role,phone:i.phone,email:i.email,notes:i.notes,"is-primary":i.isPrimary},null,8,["name","role","phone","email","notes","is-primary"]))),128))]))])):P("",!0)])):P("",!0)}},BN=ze(ON,[["__scopeId","data-v-246302be"]]),NN={key:0,class:"accordion-section"},FN={class:"accordion-title"},UN=["innerHTML"],zN={class:"accordion-icon"},HN={key:0,class:"accordion-content"},VN={key:0,class:"loading-state"},GN={key:1,class:"empty-state"},jN={key:2,class:"incidents-list"},ZN={__name:"MarshalIncidentsSection",props:{incidents:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle","select-incident"],setup(e){return(t,o)=>e.incidents.length>0||e.loading?(v(),g("div",NN,[r("button",{class:ue(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=i=>t.$emit("toggle"))},[r("span",FN,[r("span",{class:"section-icon",innerHTML:V(Sn)("incidents")},null,8,UN),Ke(" Your "+w(e.incidents.length===1?"incident":"incidents")+w(e.incidents.length>1?` (${e.incidents.length})`:""),1)]),r("span",zN,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",HN,[e.loading?(v(),g("div",VN," Loading incidents... ")):e.incidents.length===0?(v(),g("div",GN,[...o[1]||(o[1]=[r("p",null,"No incidents to show.",-1)])])):(v(),g("div",jN,[(v(!0),g(xe,null,Be(e.incidents,i=>(v(),je(Fl,{key:i.incidentId,incident:i,onSelect:s=>t.$emit("select-incident",i)},null,8,["incident","onSelect"]))),128))]))])):P("",!0)])):P("",!0)}},qN=ze(ZN,[["__scopeId","data-v-e84cbdf1"]]),WN={key:0,class:"accordion-section"},KN={class:"accordion-title"},YN=["innerHTML"],JN={class:"accordion-icon"},XN={key:0,class:"accordion-content"},QN={class:"event-details"},e7={key:0,class:"event-detail-row"},t7={class:"detail-value"},n7={key:1,class:"event-description"},o7={class:"detail-value"},s7={__name:"MarshalEventDetailsSection",props:{eventDate:{type:String,default:null},description:{type:String,default:""},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){const t=o=>o?new Date(o).toLocaleString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"}):"";return(o,i)=>e.eventDate||e.description?(v(),g("div",WN,[r("button",{class:ue(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=s=>o.$emit("toggle"))},[r("span",KN,[r("span",{class:"section-icon",innerHTML:V(Sn)("event")},null,8,YN),i[1]||(i[1]=Ke(" Event details ",-1))]),r("span",JN,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",XN,[r("div",QN,[e.eventDate?(v(),g("div",e7,[i[2]||(i[2]=r("span",{class:"detail-label"},"Date and time",-1)),r("span",t7,w(t(e.eventDate)),1)])):P("",!0),e.description?(v(),g("div",n7,[i[3]||(i[3]=r("span",{class:"detail-label"},"Description",-1)),r("p",o7,w(e.description),1)])):P("",!0)])])):P("",!0)])):P("",!0)}},i7=ze(s7,[["__scopeId","data-v-7c880ad1"]]),a7={class:"accordion-section"},l7={class:"accordion-title"},r7=["innerHTML"],c7={class:"accordion-icon"},u7={key:0,class:"accordion-content"},d7={key:0,class:"loading"},h7={key:1,class:"error"},f7={key:2,class:"empty-state"},p7={class:"checklist-section"},v7={key:0,class:"empty-state small"},m7={key:1,class:"my-jobs-list"},g7=["checked","disabled","onChange"],y7={key:0,class:"checklist-section"},k7={class:"checklist-section-title"},_7={key:0,class:"checklist-items"},b7={class:"item-checkbox"},w7=["checked","disabled","onChange"],C7={class:"item-content"},L7={key:0,class:"item-context"},S7={key:1,class:"completion-info"},x7={class:"completion-text"},I7={class:"completion-time"},$7={key:1,class:"checklist-groups"},T7=["onClick"],M7={class:"group-title"},A7={class:"group-status"},E7={class:"group-count"},P7={class:"group-expand-icon"},D7={key:0,class:"checklist-group-items"},R7={class:"item-checkbox"},O7=["checked","disabled","onChange"],B7={class:"item-content"},N7={key:0,class:"completion-info"},F7={class:"completion-text"},U7={class:"completion-time"},z7={__name:"MarshalChecklistSection",props:{loading:{type:Boolean,default:!1},error:{type:String,default:""},isExpanded:{type:Boolean,default:!1},checklistTerm:{type:String,default:"checklists"},areaTerm:{type:String,default:"area"},isAreaLead:{type:Boolean,default:!1},myItems:{type:Array,default:()=>[]},areaItems:{type:Array,default:()=>[]},areaItemsWithLocalState:{type:Array,default:()=>[]},visibleItems:{type:Array,default:()=>[]},groupedItems:{type:Array,default:()=>[]},completedCount:{type:Number,default:0},saving:{type:Boolean,default:!1},effectiveGroupBy:{type:String,default:"none"},expandedGroup:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},getContextName:{type:Function,default:()=>""}},emits:["toggle","toggle-item","toggle-group"],setup(e){const t=e,o=H(()=>t.visibleItems.length),i=s=>s?new Date(s).toLocaleString():"";return(s,a)=>(v(),g("div",a7,[r("button",{class:ue(["accordion-header",{active:e.isExpanded}]),onClick:a[0]||(a[0]=l=>s.$emit("toggle"))},[r("span",l7,[r("span",{class:"section-icon",innerHTML:V(Sn)("checklist")},null,8,r7),Ke(" Your "+w(e.checklistTerm)+" ("+w(e.completedCount)+" of "+w(o.value)+" complete) ",1)]),r("span",c7,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",u7,[e.loading?(v(),g("div",d7,"Loading checklist...")):e.error?(v(),g("div",h7,w(e.error),1)):o.value===0?(v(),g("div",f7,[r("p",null,"No "+w(e.checklistTerm)+" for you.",1)])):e.isAreaLead?(v(),g(xe,{key:3},[r("div",p7,[a[3]||(a[3]=r("h4",{class:"checklist-section-title"},"Your jobs",-1)),e.myItems.length===0?(v(),g("div",v7,[...a[2]||(a[2]=[r("p",null,"No jobs assigned to you.",-1)])])):(v(),g("div",m7,[(v(!0),g(xe,null,Be(e.myItems,l=>(v(),g("div",{key:`${l.itemId}_${l.completionContextType}_${l.completionContextId}`,class:"my-job-item"},[r("input",{type:"checkbox",checked:l.isCompleted,disabled:e.saving,onChange:u=>s.$emit("toggle-item",l)},null,40,g7),r("span",{class:ue(["my-job-text",{completed:l.isCompleted}])},w(l.text),3)]))),128))]))]),e.areaItems.length>0?(v(),g("div",y7,[r("h4",k7,"Your "+w(e.areaTerm)+"'s jobs",1),Ee(Zu,{items:e.areaItemsWithLocalState,locations:e.locations,areas:e.areas,marshals:e.marshals,onToggleComplete:a[1]||(a[1]=l=>s.$emit("toggle-item",l))},null,8,["items","locations","areas","marshals"])])):P("",!0)],64)):(v(),g(xe,{key:4},[e.effectiveGroupBy==="none"?(v(),g("div",_7,[(v(!0),g(xe,null,Be(e.visibleItems,l=>(v(),g("div",{key:`${l.itemId}_${l.completionContextType}_${l.completionContextId}`,class:ue(["checklist-item",{"item-completed":l.isCompleted}])},[r("div",b7,[r("input",{type:"checkbox",checked:l.isCompleted,disabled:!l.canBeCompletedByMe||e.saving,onChange:u=>s.$emit("toggle-item",l)},null,40,w7)]),r("div",C7,[r("div",{class:ue(["item-text",{"text-completed":l.isCompleted}])},w(l.text),3),e.getContextName(l)?(v(),g("div",L7,w(e.getContextName(l)),1)):P("",!0),l.isCompleted?(v(),g("div",S7,[r("span",x7," Completed by "+w(l.completedByActorName||"Unknown"),1),r("span",I7,w(i(l.completedAt)),1)])):P("",!0)])],2))),128))])):(v(),g("div",$7,[(v(!0),g(xe,null,Be(e.groupedItems,l=>(v(),g("div",{key:l.key,class:"checklist-group"},[r("button",{class:ue(["checklist-group-header",{expanded:e.expandedGroup===l.key,"all-complete":l.completedCount===l.items.length}]),onClick:u=>s.$emit("toggle-group",l.key)},[r("span",M7,w(l.name),1),r("span",A7,[r("span",E7,w(l.completedCount)+"/"+w(l.items.length),1),r("span",P7,w(e.expandedGroup===l.key?"":"+"),1)])],10,T7),e.expandedGroup===l.key?(v(),g("div",D7,[(v(!0),g(xe,null,Be(l.items,u=>(v(),g("div",{key:`${u.itemId}_${u.completionContextType}_${u.completionContextId}`,class:ue(["checklist-item",{"item-completed":u.isCompleted}])},[r("div",R7,[r("input",{type:"checkbox",checked:u.isCompleted,disabled:!u.canBeCompletedByMe||e.saving,onChange:d=>s.$emit("toggle-item",u)},null,40,O7)]),r("div",B7,[r("div",{class:ue(["item-text",{"text-completed":u.isCompleted}])},w(u.text),3),u.isCompleted?(v(),g("div",N7,[r("span",F7,w(u.completedByActorName||"Unknown"),1),r("span",U7,w(i(u.completedAt)),1)])):P("",!0)])],2))),128))])):P("",!0)]))),128))]))],64))])):P("",!0)]))}},H7=ze(z7,[["__scopeId","data-v-132515da"]]),V7={class:"accordion-section"},G7={class:"accordion-title"},j7=["innerHTML"],Z7={class:"accordion-icon"},q7={key:0,class:"accordion-content"},W7={__name:"MarshalNotesSection",props:{eventId:{type:String,required:!0},notes:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},isExpanded:{type:Boolean,default:!1}},emits:["toggle","notes-changed"],setup(e){return(t,o)=>(v(),g("div",V7,[r("button",{class:ue(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=i=>t.$emit("toggle"))},[r("span",G7,[r("span",{class:"section-icon",innerHTML:V(Sn)("notes")},null,8,j7),Ke(" Your "+w(e.notes.length===1?"note":"notes")+w(e.notes.length>1?` (${e.notes.length})`:""),1)]),r("span",Z7,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",q7,[Ee(oc,{"event-id":e.eventId,"all-notes":e.notes,locations:e.locations,areas:e.areas,assignments:e.assignments,"show-scope":!1,onNotesChanged:o[1]||(o[1]=i=>t.$emit("notes-changed"))},null,8,["event-id","all-notes","locations","areas","assignments"])])):P("",!0)]))}},K7=ze(W7,[["__scopeId","data-v-10b7523a"]]),Y7={class:"accordion-section"},J7={class:"accordion-title"},X7=["innerHTML"],Q7={key:0,class:"location-status active"},eF={key:1,class:"location-status"},tF={class:"accordion-icon"},nF={key:0,class:"accordion-content map-content"},oF={key:0,class:"map-selection-banner"},sF={class:"map-wrapper"},iF={__name:"MarshalRouteSection",props:{isExpanded:{type:Boolean,default:!1},courseTerm:{type:String,default:"Course"},userLocation:{type:Object,default:null},selectingLocation:{type:Boolean,default:!1},selectingLocationName:{type:String,default:""},locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},highlightLocationIds:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!1},headerStyle:{type:Object,default:()=>({})},headerTextColor:{type:String,default:""},toolbarActions:{type:Array,default:()=>[]}},emits:["toggle","cancel-select","map-click","location-click","action-click","visibility-change"],setup(e,{expose:t}){const o=M(null);return t({mapRef:o}),(i,s)=>(v(),g("div",Y7,[r("button",{class:ue(["accordion-header",{active:e.isExpanded}]),onClick:s[0]||(s[0]=a=>i.$emit("toggle"))},[r("span",J7,[r("span",{class:"section-icon",innerHTML:V(Sn)("course")},null,8,X7),Ke(" "+w(e.courseTerm)+" ",1),e.userLocation?(v(),g("span",Q7,"GPS Active")):(v(),g("span",eF,"GPS Inactive"))]),r("span",tF,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",nF,[e.selectingLocation?(v(),g("div",oF,[r("span",null,[s[7]||(s[7]=Ke("Click on the map to set the new location for ",-1)),r("strong",null,w(e.selectingLocationName),1)]),r("button",{onClick:s[1]||(s[1]=a=>i.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")])):P("",!0),r("div",sF,[Ee(oa,{ref_key:"mapRef",ref:o,locations:e.locations,route:e.route,center:e.center,zoom:15,"user-location":e.userLocation,"highlight-location-ids":e.highlightLocationIds,"marshal-mode":!0,clickable:e.clickable,"show-fullscreen":!0,"fullscreen-title":e.courseTerm,"fullscreen-header-style":e.headerStyle,"fullscreen-header-text-color":e.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,class:ue({"selecting-location":e.selectingLocation}),height:"100%",onMapClick:s[3]||(s[3]=a=>i.$emit("map-click",a)),onLocationClick:s[4]||(s[4]=a=>i.$emit("location-click",a)),onActionClick:s[5]||(s[5]=a=>i.$emit("action-click",a)),onVisibilityChange:s[6]||(s[6]=a=>i.$emit("visibility-change",a))},Xf({_:2},[e.selectingLocation?{name:"fullscreen-banner",fn:Ue(()=>[r("span",null,[s[8]||(s[8]=Ke("Click on the map to set the new location for ",-1)),r("strong",null,w(e.selectingLocationName),1)]),r("button",{onClick:s[2]||(s[2]=a=>i.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")]),key:"0"}:void 0]),1032,["locations","route","center","user-location","highlight-location-ids","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions","class"])])])):P("",!0)]))}},aF=ze(iF,[["__scopeId","data-v-b912beb5"]]),lF={key:0,class:"accordion-section"},rF={class:"accordion-title"},cF=["innerHTML"],uF={class:"accordion-icon"},dF={key:0,class:"accordion-content area-lead-accordion-content"},hF={key:0,class:"area-filter-pills"},fF=["onClick"],pF={__name:"MarshalAreaLeadSection",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},areaTerm:{type:String,default:"area"},areaTermPlural:{type:String,default:"areas"},selectedFilters:{type:Set,default:()=>new Set},filteredAreaIds:{type:Array,default:()=>[]},eventId:{type:String,required:!0},marshalId:{type:String,default:""},route:{type:Array,default:()=>[]}},emits:["toggle","toggle-filter","checklist-updated"],setup(e,{expose:t}){const o=M(null);return t({areaLeadRef:o}),(i,s)=>e.isAreaLead?(v(),g("div",lF,[r("button",{class:ue(["accordion-header",{active:e.isExpanded}]),onClick:s[0]||(s[0]=a=>i.$emit("toggle"))},[r("span",rF,[r("span",{class:"section-icon",innerHTML:V(Sn)("area")},null,8,cF),Ke(" Your "+w(e.areas.length===1?e.areaTerm:e.areaTermPlural)+w(e.areas.length>1?` (${e.areas.length})`:""),1)]),r("span",uF,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",dF,[e.areas.length>1?(v(),g("div",hF,[(v(!0),g(xe,null,Be(e.areas,a=>(v(),g("button",{key:a.areaId,class:ue(["area-filter-pill",{selected:e.selectedFilters.has(a.areaId)}]),style:ut(e.selectedFilters.has(a.areaId)?{backgroundColor:a.color||"#667eea",borderColor:a.color||"#667eea"}:{}),onClick:l=>i.$emit("toggle-filter",a.areaId)},w(a.name),15,fF))),128))])):P("",!0),Ee(gB,{ref_key:"areaLeadRef",ref:o,"event-id":e.eventId,"area-ids":e.filteredAreaIds,"marshal-id":e.marshalId,route:e.route,onChecklistUpdated:s[1]||(s[1]=a=>i.$emit("checklist-updated"))},null,8,["event-id","area-ids","marshal-id","route"])])):P("",!0)])):P("",!0)}},vF=ze(pF,[["__scopeId","data-v-730e605e"]]),mF={key:0,class:"accordion-section"},gF={class:"accordion-title"},yF=["innerHTML"],kF={class:"accordion-icon"},_F={key:0,class:"accordion-content area-lead-marshals-content"},bF={class:"area-lead-marshals-list"},wF=["onClick"],CF={class:"marshal-header-info"},LF={class:"marshal-name-row"},SF={class:"marshal-name"},xF={class:"marshal-meta"},IF={class:"marshal-checkpoint"},$F={key:0,class:"marshal-task-count"},TF={class:"accordion-icon"},MF={key:0,class:"area-lead-marshal-content"},AF={class:"marshal-checkin-section"},EF={key:0,class:"marshal-contact-section"},PF=["href"],DF=["href"],RF={key:1,class:"marshal-tasks-section"},OF={class:"tasks-label"},BF={class:"tasks-list"},NF=["checked","disabled","onChange"],FF={class:"task-text"},UF={key:2,class:"no-tasks-message"},zF={__name:"MarshalMarshalsList",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},marshals:{type:Array,default:()=>[]},expandedMarshalId:{type:String,default:null},personTerm:{type:String,default:"person"},peopleTerm:{type:String,default:"people"},checklistTerm:{type:String,default:"Checklists"},checklistTermLower:{type:String,default:"checklists"},checkingInMarshalId:{type:String,default:null},savingTask:{type:Boolean,default:!1}},emits:["toggle","toggle-marshal","check-in","toggle-task"],setup(e){const t=o=>!o||o.length===0?"":o.length===1?o[0].name:o.map(i=>i.name).join(", ");return(o,i)=>e.isAreaLead&&e.marshals.length>0?(v(),g("div",mF,[r("button",{class:ue(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=s=>o.$emit("toggle"))},[r("span",gF,[r("span",{class:"section-icon",innerHTML:V(Sn)("marshal")},null,8,yF),Ke(" Your "+w(e.marshals.length===1?e.personTerm:e.peopleTerm)+w(e.marshals.length>1?` (${e.marshals.length})`:""),1)]),r("span",kF,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",_F,[r("div",bF,[(v(!0),g(xe,null,Be(e.marshals,s=>(v(),g("div",{key:s.marshalId,class:"area-lead-marshal-item"},[r("button",{class:ue(["area-lead-marshal-header",{active:e.expandedMarshalId===s.marshalId,"is-checked-in":s.isCheckedIn}]),onClick:a=>o.$emit("toggle-marshal",s.marshalId)},[r("div",CF,[r("div",LF,[r("span",SF,w(s.name),1),r("span",{class:ue(["check-status-badge",{"checked-in":s.isCheckedIn}])},w(s.isCheckedIn?"":""),3)]),r("div",xF,[r("span",IF,w(t(s.checkpoints)),1),s.totalTaskCount>0?(v(),g("span",$F,w(s.completedTaskCount)+" / "+w(s.totalTaskCount)+" "+w(e.checklistTermLower)+" complete ",1)):P("",!0)])]),r("span",TF,w(e.expandedMarshalId===s.marshalId?"":"+"),1)],10,wF),e.expandedMarshalId===s.marshalId?(v(),g("div",MF,[r("div",AF,[Ee(gu,{"is-checked-in":s.isCheckedIn,"check-in-time":s.checkInTime,"check-in-method":s.checkInMethod,"checked-in-by":s.checkedInBy,"marshal-name":s.marshalName,"is-loading":e.checkingInMarshalId===s.id,onToggle:a=>o.$emit("check-in",s)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"])]),s.email||s.phoneNumber?(v(),g("div",EF,[s.phoneNumber?(v(),g("a",{key:0,href:`tel:${s.phoneNumber}`,class:"contact-link"},w(s.phoneNumber),9,PF)):P("",!0),s.email?(v(),g("a",{key:1,href:`mailto:${s.email}`,class:"contact-link"},w(s.email),9,DF)):P("",!0)])):P("",!0),s.allTasks.length>0?(v(),g("div",RF,[r("div",OF,w(e.checklistTerm),1),r("div",BF,[(v(!0),g(xe,null,Be(s.allTasks,a=>(v(),g("div",{key:`${a.itemId}-${a.contextId}`,class:ue(["task-item",{"task-completed":a.isCompleted}])},[r("input",{type:"checkbox",checked:a.isCompleted,disabled:e.savingTask,onChange:l=>o.$emit("toggle-task",a,s)},null,40,NF),r("span",FF,w(a.text),1)],2))),128))])])):(v(),g("div",UF," No "+w(e.checklistTermLower)+" assigned. ",1))])):P("",!0)]))),128))])])):P("",!0)])):P("",!0)}},HF=ze(zF,[["__scopeId","data-v-b47ca884"]]),VF={class:"checkpoint-note-header"},GF={key:0,class:"pin-icon",title:"Pinned"},jF={class:"checkpoint-note-title"},ZF={key:0,class:"checkpoint-note-content"},qF={__name:"NoteCard",props:{title:{type:String,required:!0},content:{type:String,default:""},priority:{type:String,default:"Normal"},isPinned:{type:Boolean,default:!1}},setup(e){const t=e,o=H(()=>(t.priority||"Normal").toLowerCase());return(i,s)=>(v(),g("div",{class:ue(["checkpoint-note-item",o.value])},[r("div",VF,[e.isPinned?(v(),g("span",GF,"")):P("",!0),r("span",{class:ue(["priority-indicator",o.value])},null,2),r("strong",jF,w(e.title),1),r("span",{class:ue(["priority-badge",o.value])},w(e.priority),3)]),e.content?(v(),g("div",ZF,w(e.content),1)):P("",!0)],2))}},WF=ze(qF,[["__scopeId","data-v-5f2df920"]]),KF={class:"checkpoint-accordion-section"},YF={class:"checkpoint-header-content"},JF={class:"checkpoint-title-row"},XF=["innerHTML"],QF={key:0,class:"checkpoint-check-icon"},e9={class:"checkpoint-name"},t9={key:1,class:"area-badge"},n9={key:2,class:"checkpoint-time-badge"},o9={key:0,class:"checkpoint-description-preview"},s9={class:"accordion-icon"},i9={key:0,class:"checkpoint-accordion-content"},a9={key:0,class:"checkpoint-mini-map"},l9={viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",style:{"margin-right":"0.5rem"}},r9={class:"my-checkin-section"},c9={key:0,class:"check-in-error"},u9={class:"checkpoint-marshals"},d9={class:"marshals-label"},h9={key:0,class:"marshals-list"},f9={key:0,class:"check-badge"},p9={key:1,class:"marshals-list-expanded"},v9=["onClick"],m9={class:"marshal-name-text"},g9={class:"marshal-status-icons"},y9={key:0,class:"check-badge"},k9={class:"expand-icon"},_9={key:0,class:"marshal-details-panel"},b9={class:"detail-row"},w9={key:0,class:"detail-row"},C9={key:1,class:"detail-row"},L9={key:2,class:"detail-row"},S9=["href"],x9={key:3,class:"detail-row"},I9=["href"],$9={key:4,class:"contact-buttons-mini"},T9=["href"],M9=["href"],A9=["href"],E9={key:5,class:"checkpoint-marshal-checkin"},P9={key:1,class:"checkpoint-area-contacts"},D9={class:"marshals-label"},R9={class:"contact-list"},O9={key:2,class:"checkpoint-notes"},B9={class:"checkpoint-notes-list"},N9={key:3,class:"dynamic-location-section"},F9={class:"dynamic-location-header"},U9={class:"dynamic-badge"},z9={key:0,class:"last-update"},H9={class:"dynamic-location-actions"},V9=["disabled"],G9=["title"],j9={__name:"CheckpointCard",props:{assignment:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},userLocation:{type:Object,default:null},headerStyle:{type:Object,default:()=>({})},headerTextColor:{type:String,default:""},toolbarActions:{type:Array,default:()=>[]},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},isCheckingIn:{type:Boolean,default:!1},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},isAreaLeadForCheckpoint:{type:Boolean,default:!1},expandedMarshalId:{type:String,default:null},notes:{type:Array,default:()=>[]},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},peopleTerm:{type:String,default:"People"},areaTerm:{type:String,default:"Area"},checkpointTerm:{type:String,default:"checkpoint"}},emits:["toggle","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update"],setup(e,{expose:t}){const o=e,i=M(null),s=H(()=>o.assignment.location?.isDynamic);t({mapRef:i});const a=f=>{const m=f?.iconType||"checkpoint",y=f?.iconColor||"#667eea",_={checkpoint:`<svg viewBox="0 0 24 24" fill="${y}" width="20" height="20"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>`,flag:`<svg viewBox="0 0 24 24" fill="${y}" width="20" height="20"><path d="M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"/></svg>`,star:`<svg viewBox="0 0 24 24" fill="${y}" width="20" height="20"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>`,water:`<svg viewBox="0 0 24 24" fill="${y}" width="20" height="20"><path d="M12 2c-5.33 4.55-8 8.48-8 11.8 0 4.98 3.8 8.2 8 8.2s8-3.22 8-8.2c0-3.32-2.67-7.25-8-11.8z"/></svg>`,medical:`<svg viewBox="0 0 24 24" fill="${y}" width="20" height="20"><path d="M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4v4z"/></svg>`};return _[m]||_.checkpoint},l=(f,m)=>{const y=_=>_?new Date(_).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"";return f&&m?`${y(f)} - ${y(m)}`:f?`from ${y(f)}`:m?`until ${y(m)}`:""},u=f=>f?new Date(f).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"",d=f=>({manual:"Manual",qr:"QR Code",gps:"GPS",admin:"Admin"})[f]||f,p=f=>f?new Date(f).toLocaleString():"";return(f,m)=>(v(),g("div",KF,[r("button",{class:ue(["checkpoint-accordion-header",{active:e.isExpanded,"checked-in":e.assignment.effectiveIsCheckedIn}]),onClick:m[0]||(m[0]=y=>f.$emit("toggle"))},[r("div",YF,[r("div",JF,[r("span",{class:"checkpoint-icon",innerHTML:a(e.assignment.location)},null,8,XF),e.assignment.effectiveIsCheckedIn?(v(),g("span",QF,"")):P("",!0),r("span",e9,w(e.assignment.location?.name||e.assignment.locationName),1),e.assignment.areaName?(v(),g("span",t9,w(e.assignment.areaName),1)):P("",!0),e.assignment.location?.startTime||e.assignment.location?.endTime?(v(),g("span",n9,w(l(e.assignment.location.startTime,e.assignment.location.endTime)),1)):P("",!0)]),e.assignment.location?.description?(v(),g("div",o9,w(e.assignment.location.description),1)):P("",!0)]),r("span",s9,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",i9,[e.assignment.location?(v(),g("div",a9,[Ee(oa,{ref_key:"mapRef",ref:i,locations:e.allLocations,route:e.route,center:{lat:e.assignment.location.latitude,lng:e.assignment.location.longitude},zoom:16,"user-location":e.userLocation,"highlight-location-id":e.assignment.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:e.hasDynamicAssignment,"show-fullscreen":!0,"fullscreen-title":e.assignment.location?.name||e.assignment.locationName,"fullscreen-header-style":e.headerStyle,"fullscreen-header-text-color":e.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,height:"280px",onMapClick:m[2]||(m[2]=y=>f.$emit("map-click",y)),onLocationClick:m[3]||(m[3]=y=>f.$emit("location-click",y)),onActionClick:m[4]||(m[4]=y=>f.$emit("action-click",y)),onVisibilityChange:m[5]||(m[5]=y=>f.$emit("visibility-change",y))},Xf({_:2},[e.assignment.location?.isDynamic?{name:"fullscreen-footer",fn:Ue(()=>[r("button",{class:"btn btn-primary",onClick:m[1]||(m[1]=y=>f.$emit("update-location"))},[(v(),g("svg",l9,[...m[9]||(m[9]=[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"},null,-1)])])),m[10]||(m[10]=Ke(" Update location ",-1))])]),key:"0"}:void 0]),1032,["locations","route","center","user-location","highlight-location-id","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions"])])):P("",!0),r("div",r9,[Ee(gu,{"is-checked-in":e.assignment.effectiveIsCheckedIn,"check-in-time":e.assignment.checkInTime,"check-in-method":e.assignment.checkInMethod,"checked-in-by":e.assignment.checkedInBy,"marshal-name":e.currentMarshalName,"is-loading":e.isCheckingIn,onToggle:m[6]||(m[6]=y=>f.$emit("check-in"))},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading"]),e.checkInError?(v(),g("div",c9,w(e.checkInError),1)):P("",!0)]),r("div",u9,[r("div",d9,w(e.peopleTerm)+":",1),e.isAreaLeadForCheckpoint?(v(),g("div",p9,[(v(!0),g(xe,null,Be(e.assignment.allMarshals,y=>(v(),g("div",{key:y.marshalId,class:ue(["marshal-card-mini",{"is-you":y.marshalId===e.currentMarshalId,"checked-in":y.effectiveIsCheckedIn,expanded:e.expandedMarshalId===y.marshalId}])},[r("button",{class:"marshal-card-header",onClick:_=>f.$emit("toggle-marshal",y.marshalId)},[r("span",m9,w(y.marshalName)+w(y.marshalId===e.currentMarshalId?" (you)":""),1),r("span",g9,[y.effectiveIsCheckedIn?(v(),g("span",y9,"")):P("",!0),r("span",k9,w(e.expandedMarshalId===y.marshalId?"":"+"),1)])],8,v9),e.expandedMarshalId===y.marshalId?(v(),g("div",_9,[r("div",b9,[m[11]||(m[11]=r("span",{class:"detail-label"},"Status:",-1)),r("span",{class:ue(y.effectiveIsCheckedIn?"status-checked-in":"status-not-checked-in")},w(y.effectiveIsCheckedIn?"Checked in":"Not checked in"),3)]),y.effectiveIsCheckedIn&&y.checkInTime?(v(),g("div",w9,[m[12]||(m[12]=r("span",{class:"detail-label"},"Check-in time:",-1)),r("span",null,w(u(y.checkInTime)),1)])):P("",!0),y.checkInMethod?(v(),g("div",C9,[m[13]||(m[13]=r("span",{class:"detail-label"},"Method:",-1)),r("span",null,w(d(y.checkInMethod)),1)])):P("",!0),y.email?(v(),g("div",L9,[m[14]||(m[14]=r("span",{class:"detail-label"},"Email:",-1)),r("a",{href:"mailto:"+y.email},w(y.email),9,S9)])):P("",!0),y.phoneNumber?(v(),g("div",x9,[m[15]||(m[15]=r("span",{class:"detail-label"},"Phone:",-1)),r("a",{href:"tel:"+y.phoneNumber},w(y.phoneNumber),9,I9)])):P("",!0),y.email||y.phoneNumber?(v(),g("div",$9,[y.phoneNumber?(v(),g("a",{key:0,href:"tel:"+y.phoneNumber,class:"btn btn-sm btn-primary"},"Call",8,T9)):P("",!0),y.phoneNumber?(v(),g("a",{key:1,href:"sms:"+y.phoneNumber,class:"btn btn-sm btn-secondary"},"Text",8,M9)):P("",!0),y.email?(v(),g("a",{key:2,href:"mailto:"+y.email,class:"btn btn-sm btn-secondary"},"Email",8,A9)):P("",!0)])):P("",!0),y.marshalId!==e.currentMarshalId?(v(),g("div",E9,[Ee(gu,{"is-checked-in":y.effectiveIsCheckedIn,"check-in-time":y.checkInTime,"check-in-method":y.checkInMethod,"checked-in-by":y.checkedInBy,"marshal-name":y.marshalName,"is-loading":e.checkingInMarshalId===y.id,onToggle:_=>f.$emit("marshal-check-in",y)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"])])):P("",!0)])):P("",!0)],2))),128))])):(v(),g("div",h9,[(v(!0),g(xe,null,Be(e.assignment.allMarshals,y=>(v(),g("span",{key:y.marshalId,class:ue(["marshal-tag",{"is-you":y.marshalId===e.currentMarshalId,"checked-in":y.effectiveIsCheckedIn}])},[Ke(w(y.marshalName)+w(y.marshalId===e.currentMarshalId?" (you)":"")+" ",1),y.effectiveIsCheckedIn?(v(),g("span",f9,"")):P("",!0)],2))),128))]))]),e.assignment.areaContacts.length>0?(v(),g("div",P9,[r("div",D9,w(e.areaTerm)+" contacts:",1),r("div",R9,[(v(!0),g(xe,null,Be(e.assignment.areaContacts,y=>(v(),je(Av,{key:y.marshalId,name:y.marshalName,role:y.role,phone:y.phone,email:y.email},null,8,["name","role","phone","email"]))),128))])])):P("",!0),e.notes.length>0?(v(),g("div",O9,[m[16]||(m[16]=r("div",{class:"marshals-label"},"Notes:",-1)),r("div",B9,[(v(!0),g(xe,null,Be(e.notes,y=>(v(),je(WF,{key:y.noteId,title:y.title,content:y.content,priority:y.priority,"is-pinned":y.isPinned},null,8,["title","content","priority","is-pinned"]))),128))])])):P("",!0),s.value?(v(),g("div",N9,[r("div",F9,[r("span",U9,"Dynamic "+w(e.assignment.location.resolvedCheckpointTerm||e.checkpointTerm),1),e.assignment.location.lastLocationUpdate?(v(),g("span",z9," Last updated: "+w(p(e.assignment.location.lastLocationUpdate)),1)):P("",!0)]),r("div",H9,[r("button",{onClick:m[7]||(m[7]=y=>f.$emit("update-location")),class:"btn btn-update-location",disabled:e.updatingLocation},[...m[17]||(m[17]=[r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1),Ke(" Update location ",-1)])],8,V9),r("button",{onClick:m[8]||(m[8]=y=>f.$emit("toggle-auto-update")),class:ue(["btn btn-auto-update",{active:e.autoUpdateEnabled}]),title:e.autoUpdateEnabled?"Stop auto-updating":"Auto-update every 60 seconds"},[m[18]||(m[18]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})],-1)),Ke(" "+w(e.autoUpdateEnabled?"Stop":"Auto"),1)],10,G9)])])):P("",!0)])):P("",!0)]))}},Z9=ze(j9,[["__scopeId","data-v-1248a6eb"]]),q9={class:"accordion-section"},W9={class:"accordion-title"},K9=["innerHTML"],Y9={class:"accordion-icon"},J9={key:0,class:"accordion-content assignments-accordion-content"},X9={key:0,class:"empty-state"},Q9={key:1,class:"checkpoint-accordion"},eU={__name:"MarshalAssignmentsSection",props:{isExpanded:{type:Boolean,default:!1},assignments:{type:Array,default:()=>[]},expandedCheckpointId:{type:String,default:null},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},userLocation:{type:Object,default:null},headerStyle:{type:Object,default:()=>({})},headerTextColor:{type:String,default:""},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},checkingInId:{type:String,default:null},checkingInAssignmentId:{type:String,default:null},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},expandedMarshalId:{type:String,default:null},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},checkpointTerm:{type:String,default:"checkpoint"},checkpointTermPlural:{type:String,default:"checkpoints"},peopleTerm:{type:String,default:"People"},areaTerm:{type:String,default:"Area"},getToolbarActions:{type:Function,default:()=>[]},isAreaLeadForAreas:{type:Function,default:()=>!1},getNotesForCheckpoint:{type:Function,default:()=>[]}},emits:["toggle","toggle-checkpoint","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update"],setup(e,{expose:t}){const o={},i=(s,a)=>{a?o[s]=a:delete o[s]};return t({checkpointRefs:o}),(s,a)=>(v(),g("div",q9,[r("button",{class:ue(["accordion-header",{active:e.isExpanded}]),onClick:a[0]||(a[0]=l=>s.$emit("toggle"))},[r("span",W9,[r("span",{class:"section-icon",innerHTML:V(Sn)("checkpoint")},null,8,K9),Ke(" Your "+w(e.assignments.length===1?e.checkpointTerm:e.checkpointTermPlural)+w(e.assignments.length>1?` (${e.assignments.length})`:""),1)]),r("span",Y9,w(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",J9,[e.assignments.length===0?(v(),g("div",X9,[r("p",null,"You don't have any "+w(e.checkpointTerm)+" assignments yet.",1)])):(v(),g("div",Q9,[(v(!0),g(xe,null,Be(e.assignments,l=>(v(),je(Z9,{key:l.id,ref_for:!0,ref:u=>i(l.id,u),assignment:l,"is-expanded":e.expandedCheckpointId===l.id,"all-locations":e.allLocations,route:e.route,"user-location":e.userLocation,"header-style":e.headerStyle,"header-text-color":e.headerTextColor,"toolbar-actions":e.getToolbarActions(l.id),"has-dynamic-assignment":e.hasDynamicAssignment,"current-marshal-id":e.currentMarshalId,"current-marshal-name":e.currentMarshalName,"is-checking-in":e.checkingInId===l.id,"check-in-error":e.checkingInAssignmentId===l.id?e.checkInError:"","checking-in-marshal-id":e.checkingInMarshalId,"is-area-lead-for-checkpoint":e.isAreaLeadForAreas(l.areaIds),"expanded-marshal-id":e.expandedMarshalId,notes:e.getNotesForCheckpoint(l.locationId,l.areaIds),"updating-location":e.updatingLocation,"auto-update-enabled":e.autoUpdateEnabled,"people-term":e.peopleTerm,"area-term":e.areaTerm,"checkpoint-term":e.checkpointTerm,onToggle:u=>s.$emit("toggle-checkpoint",l.id),onMapClick:a[1]||(a[1]=u=>s.$emit("map-click",u)),onLocationClick:a[2]||(a[2]=u=>s.$emit("location-click",u)),onActionClick:u=>s.$emit("action-click",l,u),onVisibilityChange:u=>s.$emit("visibility-change",l.id,u),onUpdateLocation:u=>s.$emit("update-location",l),onCheckIn:u=>s.$emit("check-in",l),onToggleMarshal:a[3]||(a[3]=u=>s.$emit("toggle-marshal",u)),onMarshalCheckIn:u=>s.$emit("marshal-check-in",u,l.locationId),onToggleAutoUpdate:u=>s.$emit("toggle-auto-update",l)},null,8,["assignment","is-expanded","all-locations","route","user-location","header-style","header-text-color","toolbar-actions","has-dynamic-assignment","current-marshal-id","current-marshal-name","is-checking-in","check-in-error","checking-in-marshal-id","is-area-lead-for-checkpoint","expanded-marshal-id","notes","updating-location","auto-update-enabled","people-term","area-term","checkpoint-term","onToggle","onActionClick","onVisibilityChange","onUpdateLocation","onCheckIn","onMarshalCheckIn","onToggleAutoUpdate"]))),128))]))])):P("",!0)]))}},tU=ze(eU,[["__scopeId","data-v-97fcbe4e"]]);function nU(e){const t=H(()=>{const p=e.value?.brandingPageGradientStart||eo.pageGradientStart,f=e.value?.brandingPageGradientEnd||eo.pageGradientEnd;return{background:`linear-gradient(135deg, ${p} 0%, ${f} 100%)`}}),o=H(()=>{const p=e.value?.brandingHeaderGradientStart||eo.headerGradientStart,f=e.value?.brandingHeaderGradientEnd||eo.headerGradientEnd;return{background:`linear-gradient(135deg, ${p} 0%, ${f} 100%)`}}),i=H(()=>{const p=e.value?.brandingHeaderGradientStart||eo.headerGradientStart,f=e.value?.brandingHeaderGradientEnd||eo.headerGradientEnd;return Sv(p,f)}),s=H(()=>e.value?.brandingAccentColor||eo.accentColor),a=H(()=>Lv(s.value)),l=H(()=>({background:s.value,color:a.value})),u=H(()=>e.value?.brandingLogoUrl||""),d=H(()=>e.value?.brandingLogoPosition||"left");return{pageBackgroundStyle:t,headerStyle:o,headerTextColor:i,accentColor:s,accentTextColor:a,accentButtonStyle:l,brandingLogoUrl:u,brandingLogoPosition:d}}function oU(){const e=M(null),t=M(null);let o=null;const i=()=>{if(!("geolocation"in navigator)){console.warn("Geolocation not supported");return}console.log("Starting location tracking..."),o=navigator.geolocation.watchPosition(a=>{e.value={lat:a.coords.latitude,lng:a.coords.longitude},t.value=Date.now()},a=>{console.warn("Geolocation error:",{1:"Location permission denied. Please allow location access in your browser settings.",2:"Location unavailable. Make sure GPS is enabled on your device.",3:"Location request timed out. Please try again."}[a.code]||a.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},s=()=>{o!==null&&(navigator.geolocation.clearWatch(o),o=null)};return On(()=>{s()}),{userLocation:e,locationLastUpdated:t,startLocationTracking:i,stopLocationTracking:s}}const sU={key:0,class:"header-logo-cover"},iU=["src"],aU=["title"],lU=["innerHTML"],rU={key:2,class:"header-logo header-logo-left"},cU=["src"],uU={class:"header-center"},dU={key:0},hU={key:1,class:"header-event-date"},fU={key:0,class:"header-actions"},pU={key:3,class:"header-logo header-logo-right"},vU=["src"],mU=["title"],gU=["innerHTML"],yU={class:"container"},kU={key:0,class:"selection-card"},_U={key:1,class:"selection-card"},bU={key:0,class:"loading"},wU={key:2,class:"selection-card error-card"},CU={class:"error"},LU={key:3,class:"dashboard"},SU={key:0,class:"welcome-bar"},xU={class:"welcome-info"},IU={key:0,class:"welcome-email"},$U={key:0,class:"mode-switch"},TU={key:1,class:"mode-switch"},MU={class:"accordion"},AU={class:"add-note-form"},EU={class:"modal-actions"},PU=["disabled"],DU=6e4,Qh='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><circle cx="12" cy="12" r="4"/><path d="M13 4.069V2h-2v2.069A8.01 8.01 0 0 0 4.069 11H2v2h2.069A8.008 8.008 0 0 0 11 19.931V22h2v-2.069A8.007 8.007 0 0 0 19.931 13H22v-2h-2.069A8.008 8.008 0 0 0 13 4.069zM12 18c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6z"/></svg>',ef='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>',RU={__name:"MarshalView",setup(e){const{terms:t,termsLower:o}=St(),{updatePendingCount:i}=Wu(),s=Yr(),a=Ra(),l=H(()=>s.params.eventId),u=M(!1),d=M(!1),p=M(null),f=M(null),m=M(null),y=M(null),_=H(()=>f.value?.name||null),b=H(()=>y.value?.eventRoles?y.value.eventRoles.filter(j=>j.role==="EventAreaLead").flatMap(j=>j.areaIds||[]):[]),S=H(()=>b.value.length>0),T=M(new Set),D=H(()=>b.value.length?K.value.filter(z=>b.value.includes(z.id)).map(z=>({areaId:z.id,name:z.name,color:z.color})).sort((z,j)=>(z.name||"").localeCompare(j.name||"",void 0,{numeric:!0,sensitivity:"base"})):[]);Ze(D,z=>{z.length>0&&T.value.size===0&&(T.value=new Set(z.map(j=>j.areaId)))},{immediate:!0});const I=H(()=>b.value.filter(z=>T.value.has(z))),C=z=>{const j=new Set(T.value);j.has(z)?j.delete(z):j.add(z),T.value=j};H(()=>{const z=new Map;for(const j of _n.value)j.location&&z.set(j.location.id,{id:j.location.id,name:j.location.name,description:j.location.description,order:j.location.order??999});if(S.value)for(const j of Z.value){if(z.has(j.id))continue;(j.areaIds||j.AreaIds||[]).some(Ce=>b.value.includes(Ce))&&z.set(j.id,{id:j.id,name:j.name,description:j.description,order:j.order??999})}return Array.from(z.values()).sort((j,he)=>j.order!==he.order?j.order-he.order:(j.name||"").localeCompare(he.name||"",void 0,{numeric:!0,sensitivity:"base"}))});const A=H(()=>{const z=_n.value.find(he=>he.isCheckedIn&&!Kn(he.checkInTime)&&he.location);if(z?.location)return{id:z.location.id,locationId:z.location.id,name:z.location.name,description:z.location.description};if(kn.value){const he=_n.value.find(Ce=>Ce.id===kn.value);if(he?.location)return{id:he.location.id,locationId:he.location.id,name:he.location.name,description:he.location.description}}const j=_n.value[0];return j?.location?{id:j.location.id,locationId:j.location.id,name:j.location.name,description:j.location.description}:null}),E=H(()=>y.value?.eventRoles?y.value.eventRoles.some(z=>z.role==="EventAdmin"):!1),N=H(()=>y.value?.authMethod==="SecureEmailLink"&&E.value),$=H(()=>y.value?.authMethod==="MarshalMagicCode"&&E.value),G=()=>{a.push(`/admin/events/${s.params.eventId}`)},R=M(null),Z=M([]),U=M([]),K=M([]),re=M(!0),{pageBackgroundStyle:Pe,headerStyle:me,headerTextColor:Ae,accentButtonStyle:Fe,brandingLogoUrl:ae,brandingLogoPosition:Me}=nU(R),ge=M("assignments"),de=M({checklist:0,notes:0,incidents:0,eventContacts:0}),Oe=M(null),Xe=M(null),et=M(null),qe=M([]),tt=M(!1),be=M(null),He=M(!1);M("person");const fe=M(null),Ie=M([]),Te=M([]),W=M([]),Y=M(!1),le=M(null),ye=M(!1),ie=M(!1),oe=M(""),ce=M(!1);H(()=>W.value.filter(z=>z.status==="open"||z.status==="acknowledged"||z.status==="in_progress").length);const De=M(!1),we=M(null),te=M(null),ke=M(null),se=M(!1),Q=M(!1);let X=null,O=null;const q=M(null),J=H(()=>q.value?.areaLeadRef?.value),$e=M(null),We=M(!1),ot=M(0),st=z=>{$e.value=$e.value===z?null:z},$t=H(()=>{ot.value;const z=J.value?.checkpoints||Ie.value||[],j=new Map;for(const he of z)for(const Ce of he.marshals||[]){j.has(Ce.marshalId)||j.set(Ce.marshalId,{...Ce,checkpoints:[],allTasks:[],totalTaskCount:0,completedTaskCount:0});const Re=j.get(Ce.marshalId);if(Re.checkpoints.push({checkpointId:he.checkpointId,name:he.name,description:he.description}),Ce.outstandingTasks)for(const Je of Ce.outstandingTasks)Re.allTasks.push({...Je,isCompleted:!1,checkpointName:he.name}),Re.totalTaskCount++;if(Ce.completedTasks)for(const Je of Ce.completedTasks)Re.allTasks.push({...Je,isCompleted:!0,checkpointName:he.name}),Re.totalTaskCount++,Re.completedTaskCount++}return Array.from(j.values()).sort((he,Ce)=>(he.name||"").localeCompare(Ce.name||"",void 0,{sensitivity:"base"}))}),Nt=async z=>{const he=(J.value?.checkpoints||Ie.value||[]).find(at=>at.marshals?.some(gt=>gt.marshalId===z.marshalId));if(!he){console.error("Could not find checkpoint for marshal:",z);return}const Ce=he.marshals.find(at=>at.marshalId===z.marshalId);if(!Ce)return;const Re=Ce.assignmentId||Ce.id;if(!Re){console.error("No assignment ID found for marshal:",Ce);return}const Je={id:Re,marshalId:z.marshalId,isCheckedIn:z.isCheckedIn,effectiveIsCheckedIn:z.isCheckedIn};await Ct(Je,!1,he.locationId)},Pt=async(z,j)=>{if(We.value)return;We.value=!0;const he={marshalId:j.marshalId,contextType:z.contextType,contextId:z.contextId,actorMarshalId:m.value};try{z.isCompleted?await Rt.uncomplete(l.value,z.itemId,he):await Rt.complete(l.value,z.itemId,he),J.value?.loadDashboard&&await J.value.loadDashboard(),ot.value++,await co(!0)}catch(Ce){console.error("Failed to toggle task:",Ce)}finally{We.value=!1}},jt=M(!1),cn=M(!1),go=M(!1),un=M(!1),Ht=M(""),bt=M(""),qt=M(null),yo=M(!1),ko=M(""),Bn=M(""),Zt=M(!1),Eo=M(null),fs=M(new Set),io=M(null),Vt=H(()=>io.value?.mapRef?.value),Wn=M({userLocationInView:!1,highlightedLocationInView:!1}),vn=M({}),ns={},ln=M(null),Qe=z=>!z||z.length===0?!1:z.some(j=>b.value.includes(j)),Po=z=>{ln.value=ln.value===z?null:z},Kn=z=>{if(!z)return!0;const j=new Date(z);return(new Date-j)/(1e3*60*60)>24},{userLocation:en,locationLastUpdated:ao,startLocationTracking:Do,stopLocationTracking:Ws}=oU(),dn=z=>{const j=ge.value===z;if(ge.value=j?null:z,!j){const he=Date.now(),Ce=Re=>he-de.value[Re]>DU;switch(z){case"checklist":Ce("checklist")&&co();break;case"notes":Ce("notes")&&fn();break;case"incidents":Ce("incidents")&&bo();break;case"eventContacts":Ce("eventContacts")&&wo();break}}},kn=M(null),Ro=z=>{kn.value=kn.value===z?null:z};Ze(()=>U.value,z=>{z.length===1&&kn.value===null&&(kn.value=z[0].id)},{immediate:!0});const _n=H(()=>U.value.map(z=>{const j=Z.value.find(wt=>wt.id===z.locationId),he=j?.areaIds||j?.AreaIds||[];let Ce=null;he.length>0&&K.value.length>0&&(Ce=K.value.find(mt=>he.includes(mt.id))?.name);const Je=(j?.assignments||[]).map(wt=>({...wt,effectiveIsCheckedIn:wt.isCheckedIn&&!Kn(wt.checkInTime)})).sort((wt,mt)=>(wt.marshalName||"").localeCompare(mt.marshalName||"",void 0,{sensitivity:"base"})),at=No.value.filter(wt=>he.includes(wt.areaId)&&(!wt.marshalId||wt.marshalId!==m.value)),gt=new Set,yt=at.filter(wt=>{const mt=JSON.stringify({name:wt.name||"",marshalId:wt.marshalId||"",role:wt.role||"",phone:wt.phone||"",email:wt.email||"",notes:wt.notes||""});return gt.has(mt)?!1:(gt.add(mt),!0)}).sort((wt,mt)=>(wt.marshalName||wt.name||"").localeCompare(mt.marshalName||mt.name||"",void 0,{sensitivity:"base"})),Wt=z.isCheckedIn&&!Kn(z.checkInTime);return{...z,location:j,areaName:Ce,areaIds:he,allMarshals:Je,areaContacts:yt,locationName:j?.name||"Unknown Location",effectiveIsCheckedIn:Wt}})),Ks=H(()=>U.value.length>0?U.value[0]:null),Yn=H(()=>U.value.map(z=>z.locationId)),Oo=H(()=>_n.value.some(z=>z.location?.isDynamic||z.location?.IsDynamic)),hn=H(()=>_n.value.find(z=>z.location?.isDynamic||z.location?.IsDynamic)),lo=H(()=>{if(!R.value||!_n.value.length)return[];const z=new Date,j=R.value.eventDate?new Date(R.value.eventDate):null;return _n.value.filter(he=>{if(he.effectiveIsCheckedIn||fs.value.has(he.id))return!1;const Ce=he.location;if(!Ce)return!1;const Re=Ce.startTime?new Date(Ce.startTime):j;if(!Re)return!1;let Je;if(Ce.endTime)Je=new Date(Ce.endTime);else if(j)Je=new Date(j.getTime()+7200*1e3);else return!1;return z>=Re&&z<Je})});Ze(lo,z=>{z.length>0&&!Zt.value&&(Eo.value=z[0],Zt.value=!0)},{immediate:!0});const ps=z=>{fs.value.add(z),Zt.value=!1,Eo.value=null},Li=()=>{const z=Eo.value;z&&(ps(z.id),ge.value="assignments",kn.value=z.id)},Nn=H(()=>R.value?.route?(typeof R.value.route=="string"?JSON.parse(R.value.route):R.value.route)||[]:[]),os=H(()=>!Ks.value||!Z.value.length?null:Z.value.find(z=>z.id===Ks.value.locationId)),bn=H(()=>qe.value.filter(z=>z.isCompleted&&["OnePerCheckpoint","OnePerArea","OneLeadPerArea"].includes(z.matchedScope)?z.completedByActorId===m.value:!0)),vs=H(()=>bn.value.filter(z=>z.isCompleted).length),tn=H(()=>{const z=U.value.map(j=>j.locationId);return bn.value.filter(j=>j.completionContextType==="Personal"?j.contextOwnerMarshalId===m.value:j.completionContextType==="Checkpoint"?z.includes(j.completionContextId):j.completionContextType==="Area"?b.value.includes(j.completionContextId):!0)}),ro=H(()=>{if(!S.value)return[];const z=U.value.map(j=>j.locationId);return bn.value.filter(j=>j.completionContextType==="Personal"?j.contextOwnerMarshalId!==m.value:j.completionContextType==="Checkpoint"?!z.includes(j.completionContextId):j.completionContextType==="Area"?!b.value.includes(j.completionContextId):!1)});H(()=>tn.value.map(z=>({...z,localIsCompleted:z.isCompleted,isModified:!1})));const Bo=H(()=>ro.value.map(z=>({...z,localIsCompleted:z.isCompleted,isModified:!1})));H(()=>bn.value.map(z=>({...z,localIsCompleted:z.isCompleted,isModified:!1})));const Jn=H(()=>{const z=J.value?.checkpoints||Ie.value||[];if(z.length===0)return[];const j=[],he=new Set;for(const Ce of z)for(const Re of Ce.marshals||[])he.has(Re.marshalId)||(he.add(Re.marshalId),j.push(Re));return j});H(()=>{const z=bn.value;if(z.length<=1)return!1;const j=new Set,he=new Set;for(const Ce of z)Ce.completionContextType==="Checkpoint"&&Ce.completionContextId&&j.add(Ce.completionContextId),he.add(Ce.text);return j.size>1||he.size>1});const kt=H(()=>{if(S.value)return"none";const z=bn.value,j=new Set;for(const he of z)he.completionContextType==="Checkpoint"&&he.completionContextId&&j.add(he.completionContextId);return j.size>1?"checkpoint":"none"}),Mt=H(()=>{const z=bn.value,j={};for(const he of z){let Ce,Re;he.completionContextType==="Checkpoint"&&he.completionContextId?(Ce=`checkpoint_${he.completionContextId}`,Re=Z.value.find(at=>at.id===he.completionContextId)?.name||"Unknown "+t.value.checkpoint):he.completionContextType==="Area"&&he.completionContextId?(Ce=`area_${he.completionContextId}`,Re=K.value.find(at=>at.id===he.completionContextId)?.name||"Unknown "+t.value.area):(Ce="personal",Re="Personal"),j[Ce]||(j[Ce]={key:Ce,name:Re,items:[],completedCount:0}),j[Ce].items.push(he),he.isCompleted&&j[Ce].completedCount++}return Object.values(j).sort((he,Ce)=>he.name.localeCompare(Ce.name,void 0,{numeric:!0,sensitivity:"base"}))}),ms=z=>{fe.value=fe.value===z?null:z},Fn=M([]),_o=M(!1),Ys=H(()=>{const z=Fn.value.filter(Ce=>!Ce.marshalId||Ce.marshalId!==m.value),j=new Set;return z.filter(Ce=>{const Re=JSON.stringify({name:Ce.name||"",marshalId:Ce.marshalId||"",role:Ce.role||"",phone:Ce.phone||"",email:Ce.email||"",notes:Ce.notes||""});return j.has(Re)?!1:(j.add(Re),!0)}).sort((Ce,Re)=>(Ce.name||"").localeCompare(Re.name||"",void 0,{sensitivity:"base"}))}),ht=H(()=>{const z=["EmergencyContact","EventDirector","MedicalLead","SafetyOfficer"];return Ys.value.filter(j=>z.includes(j.role))}),Gt=H(()=>Te.value.filter(z=>{const j=z.priority||z.Priority;return j==="Emergency"||j==="Urgent"})),Js=(z,j=[])=>{if(!Te.value||Te.value.length===0)return[];const he=Z.value.find(yt=>yt.id===z),Ce=he?.areaIds||he?.AreaIds||[],Re=j.length>0?j:Ce,Je=[],at=new Set;for(const yt of Te.value){const Wt=yt.noteId||yt.NoteId||yt.id;if(at.has(Wt))continue;const wt=yt.scopeConfigurations||yt.ScopeConfigurations||[];let mt=!1;if(wt.length>0)for(const Tt of wt){const It=Tt.itemType||Tt.ItemType,on=Tt.ids||Tt.Ids||[];if(It==="Checkpoint"&&(on.includes(z)||on.includes("ALL_CHECKPOINTS"))){mt=!0;break}if(It==="Area"&&(on.includes("ALL_AREAS")||Re.length>0&&Re.some(In=>on.includes(In)))){mt=!0;break}}else{const Tt=yt.matchedScope||yt.MatchedScope||"";["EveryoneInAreas","EveryAreaLead","EveryoneAtCheckpoints","Area","Checkpoint"].some(on=>Tt.includes(on)||Tt===on)&&(mt=!0)}mt&&(at.add(Wt),Je.push(yt))}const gt={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return Je.sort((yt,Wt)=>{const wt=yt.isPinned||yt.IsPinned,mt=Wt.isPinned||Wt.IsPinned;if(wt&&!mt)return-1;if(!wt&&mt)return 1;const Tt=gt[yt.priority||yt.Priority||"Normal"]??3,It=gt[Wt.priority||Wt.Priority||"Normal"]??3;if(Tt!==It)return Tt-It;const on=yt.createdAt||yt.CreatedAt,ho=Wt.createdAt||Wt.CreatedAt;return new Date(ho)-new Date(on)})},No=M([]),xn=H(()=>{if(No.value.length===0)return[];const z=No.value.filter(Je=>!Je.marshalId||Je.marshalId!==m.value),j=new Set,he=z.filter(Je=>{const at=JSON.stringify({name:Je.name||"",marshalId:Je.marshalId||"",role:Je.role||"",phone:Je.phone||"",email:Je.email||"",notes:Je.notes||"",areaId:Je.areaId||""});return j.has(at)?!1:(j.add(at),!0)}),Ce={};for(const Je of he){const at=Je.areaId||"unknown";Ce[at]||(Ce[at]={areaId:Je.areaId,areaName:Je.areaName||"Unknown Area",contacts:[]}),Ce[at].contacts.push(Je)}const Re=Object.values(Ce);for(const Je of Re)Je.contacts.sort((at,gt)=>(at.marshalName||at.name||"").localeCompare(gt.marshalName||gt.name||"",void 0,{sensitivity:"base"}));return Re});H(()=>xn.value.reduce((z,j)=>z+j.contacts.length,0));const Ua=(z,j)=>z.localeCompare(j,void 0,{numeric:!0,sensitivity:"base"}),Xs=H(()=>{if(!we.value)return[];const z=we.value.locationId;return Z.value.filter(j=>j.id!==z&&j.latitude!==0&&j.longitude!==0).sort((j,he)=>Ua(j.name,he.name))}),Fo=H(()=>os.value?{lat:os.value.latitude,lng:os.value.longitude}:en.value?en.value:Z.value.length>0?{lat:Z.value[0].latitude,lng:Z.value[0].longitude}:{lat:51.505,lng:-.09}),Ft=H(()=>_n.value.find(z=>z.location?.latitude&&z.location?.longitude&&!(z.location.latitude===0&&z.location.longitude===0))),Uo=H(()=>{const z=[];return en.value&&!Wn.value.userLocationInView&&z.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:Qh}),Ft.value&&!Wn.value.highlightedLocationInView&&z.push({id:"recenter-checkpoint",label:"My "+o.value.checkpoint,icon:"custom",customIcon:ef}),z}),gs=z=>{const j=Wn.value;(j.userLocationInView!==z.userLocationInView||j.highlightedLocationInView!==z.highlightedLocationInView)&&(Wn.value=z)},ys=({actionId:z})=>{if(z==="recenter-user"&&en.value)Vt.value?.recenterOnUserLocation();else if(z==="recenter-checkpoint"&&Ft.value){const j=Ft.value.location;Vt.value?.recenterOnLocation(j.latitude,j.longitude)}},Si=z=>{const j=[],he=vn.value[z]||{userLocationInView:!1,highlightedLocationInView:!1};return en.value&&!he.userLocationInView&&j.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:Qh}),he.highlightedLocationInView||j.push({id:"recenter-checkpoint",label:o.value.checkpoint.charAt(0).toUpperCase()+o.value.checkpoint.slice(1),icon:"custom",customIcon:ef}),j},Dt=(z,j)=>{const he=vn.value[z];(!he||he.userLocationInView!==j.userLocationInView||he.highlightedLocationInView!==j.highlightedLocationInView)&&(vn.value={...vn.value,[z]:j})},Qs=(z,{actionId:j})=>{const he=ns[z.id];j==="recenter-user"&&en.value?he?.recenterOnUserLocation():j==="recenter-checkpoint"&&z.location&&he?.recenterOnLocation(z.location.latitude,z.location.longitude)},zo=async(z,j,he=!1)=>{d.value=!0,p.value=null,console.log("Authenticating with magic code:",{eventId:z,code:j,isReauth:he});try{const Ce=await ds.marshalLogin(z,j);if(console.log("Auth response:",Ce.data),Ce.data.success){localStorage.setItem("sessionToken",Ce.data.sessionToken),localStorage.setItem(`marshal_${z}`,Ce.data.marshalId),localStorage.setItem(`marshalCode_${z}`,j),f.value=Ce.data.person,m.value=Ce.data.marshalId,u.value=!0,console.log("Authenticated as marshal:",m.value,f.value?.name);try{const Re=await ds.getMe(z);y.value=Re.data,console.log("User claims:",y.value)}catch(Re){console.warn("Failed to fetch claims:",Re)}a.replace({path:s.path,query:{}}),Di(),await ei()}else p.value=Ce.data.message||"Authentication failed"}catch(Ce){console.error("Authentication failed:",Ce),p.value=Ce.response?.data?.message||"Invalid or expired login link"}finally{d.value=!1}},ks=async z=>{const j=localStorage.getItem("sessionToken"),he=localStorage.getItem(`marshal_${z}`),Ce=localStorage.getItem(`marshalCode_${z}`);if(!j||!he)return Ce?(console.log("No session but have stored code, attempting re-authentication..."),await zo(z,Ce,!0),u.value):!1;try{const Re=await ds.getMe(z);if(Re.data&&Re.data.marshalId)return y.value=Re.data,f.value={personId:Re.data.personId,name:Re.data.personName,email:Re.data.personEmail},m.value=Re.data.marshalId,u.value=!0,Di(),!0}catch(Re){if(console.log("Session validation failed, attempting re-authentication...",Re),Ce)try{if(await zo(z,Ce,!0),u.value)return console.log("Re-authentication successful"),!0}catch(Je){console.error("Re-authentication failed:",Je)}localStorage.removeItem("sessionToken"),localStorage.removeItem(`marshal_${z}`),localStorage.removeItem(`marshalCode_${z}`)}return!1},ei=async()=>{const z=s.params.eventId;if(console.log("Loading event data for:",{eventId:z,marshalId:m.value}),Mn()){console.log("Offline mode detected, attempting to load from cache...");const Re=await ki(z);if(Re){if(console.log("Loaded cached data from:",Re.cachedAt),R.value=Re.event,K.value=Re.areas||[],Z.value=Re.locations||[],qe.value=Re.checklist||[],Fn.value=Re.contacts||[],Te.value=Re.notes||[],Re.areaLeadDashboard?.checkpoints&&(Ie.value=Re.areaLeadDashboard.checkpoints),R.value&&du(R.value),m.value){const Je=[];for(const at of Z.value){const gt=at.assignments?.find(yt=>yt.marshalId===m.value);gt&&Je.push(gt)}U.value=Je}return}else console.warn("No cached data available while offline")}console.log("Fetching event data in parallel...");const[j,he,Ce]=await Promise.allSettled([ji.getById(z),mi.getByEvent(z),al.getEventStatus(z)]);if(j.status==="fulfilled"?(R.value=j.value.data,console.log("Event loaded:",R.value?.name),R.value&&du(R.value)):console.error("Failed to load event:",j.reason),he.status==="fulfilled"?(K.value=he.value.data||[],console.log("Areas loaded:",K.value.length)):console.error("Failed to load areas:",he.reason),Ce.status==="fulfilled"){if(Z.value=Ce.value.data?.locations||[],console.log("Locations loaded:",Z.value.length),m.value){const Re=[];for(const Je of Z.value){const at=Je.assignments?.find(gt=>gt.marshalId===m.value);at&&Re.push(at)}U.value=Re,console.log("Total assignments found:",U.value.length)}}else console.error("Failed to load event status:",Ce.reason);await Promise.allSettled([co(),wo(),fn(),bo()]);try{const Re=JSON.parse(JSON.stringify({event:R.value,areas:K.value,locations:Z.value,checklist:qe.value,contacts:Fn.value,notes:Te.value,marshalId:m.value}));await $l(z,Re),console.log("Event data cached for offline access")}catch(Re){console.warn("Failed to cache event data:",Re)}Ha()},ti=async()=>{const z=s.params.eventId;if(Mn()){console.log("Skipping background preload: offline");return}console.log("Starting background preload for offline data...");try{const j=await mi.getAreaLeadDashboard(z);if(j.data){Ie.value=j.data.checkpoints||[];const he=JSON.parse(JSON.stringify({areas:j.data.areas||[],checkpoints:j.data.checkpoints||[]}));await ki(z)?await hr(z,"areaLeadDashboard",he):await $l(z,{areaLeadDashboard:he}),console.log("Area lead dashboard cached for offline access")}}catch(j){j.response?.status!==403&&console.warn("Failed to preload area lead dashboard:",j)}console.log("Background preload complete")},fn=async()=>{const z=s.params.eventId;try{const j=await Ps.getMyNotes(z);Te.value=j.data||[],de.value.notes=Date.now(),console.log("Notes loaded:",Te.value.length)}catch(j){console.error("Failed to load notes:",j)}},bo=async()=>{const z=s.params.eventId;Y.value=!0;try{const j=new Map;if(S.value&&b.value.length>0)for(const he of b.value)try{const Re=(await us.getForArea(z,he)).data.incidents||[];for(const Je of Re)j.set(Je.incidentId,Je)}catch(Ce){console.warn(`Failed to load incidents for area ${he}:`,Ce)}try{const Ce=(await us.getAll(z)).data.incidents||[];for(const Re of Ce)Re.reportedBy?.marshalId===m.value&&j.set(Re.incidentId,Re)}catch(he){console.debug("Could not load all incidents:",he)}W.value=Array.from(j.values()).sort((he,Ce)=>new Date(Ce.incidentTime||Ce.createdAt)-new Date(he.incidentTime||he.createdAt)),de.value.incidents=Date.now(),console.log("My incidents loaded:",W.value.length)}catch(j){console.error("Failed to load incidents:",j)}finally{Y.value=!1}},wo=async()=>{const z=s.params.eventId;_o.value=!0;try{const j=await di.getMyContacts(z);Fn.value=j.data||[],de.value.eventContacts=Date.now(),console.log("Contacts loaded:",Fn.value.length)}catch(j){console.warn("Failed to load contacts:",j),Fn.value=[]}finally{_o.value=!1}},co=async(z=!1)=>{if(!m.value){console.warn("No marshal ID, skipping checklist load");return}z||(tt.value=!0),be.value=null;try{const j=s.params.eventId;console.log("Fetching checklist for marshal:",m.value);let Ce=(await Rt.getMarshalChecklist(j,m.value)).data||[];if(S.value&&b.value.length>0){console.log("Fetching area checklists for areas:",b.value);const Re=b.value.map(gt=>Rt.getAreaChecklist(j,gt).catch(yt=>(console.warn(`Failed to fetch checklist for area ${gt}:`,yt),{data:[]}))),Je=await Promise.all(Re),at=new Map;for(const gt of Ce){const yt=`${gt.itemId}_${gt.completionContextType}_${gt.completionContextId}`;at.set(yt,gt)}for(const gt of Je)for(const yt of gt.data||[]){const Wt=`${yt.itemId}_${yt.completionContextType}_${yt.completionContextId}`;at.has(Wt)||at.set(Wt,yt)}Ce=Array.from(at.values()),console.log("Merged checklist items:",Ce.length)}qe.value=Ce,de.value.checklist=Date.now(),console.log("Checklist loaded:",qe.value.length,"items")}catch(j){console.error("Failed to load checklist:",j.response?.status,j.response?.data),be.value=j.response?.data?.message||"Failed to load checklist"}finally{z||(tt.value=!1)}},rt=async z=>{if(He.value)return;He.value=!0;const j=s.params.eventId,he={marshalId:z.contextOwnerMarshalId||m.value,contextType:z.completionContextType,contextId:z.completionContextId,actorMarshalId:m.value};try{z.isCompleted?Mn()?(await po("checklist_uncomplete",{eventId:j,itemId:z.itemId,data:he}),z.isCompleted=!1,z.completedAt=null,z.completedByActorName=null,await i()):(await Rt.uncomplete(j,z.itemId,he),await co(!0)):Mn()?(await po("checklist_complete",{eventId:j,itemId:z.itemId,data:he}),z.isCompleted=!0,z.completedAt=new Date().toISOString(),z.completedByActorName=f.value?.name||"You",await i()):(await Rt.complete(j,z.itemId,he),await co(!0)),await hr(j,"checklist",JSON.parse(JSON.stringify(qe.value)))}catch(Ce){if(console.error("Failed to toggle checklist item:",Ce),Mn()||!Ce.response){const Re=z.isCompleted?"checklist_uncomplete":"checklist_complete";await po(Re,{eventId:j,itemId:z.itemId,data:he}),z.isCompleted=!z.isCompleted,await i()}else be.value=Ce.response?.data?.message||"Failed to update checklist",setTimeout(()=>{be.value=null},3e3)}finally{He.value=!1}},mn=z=>{if(!z.completionContextType||!z.completionContextId)return null;if(z.completionContextType==="Checkpoint"){const j=Z.value.find(Ce=>Ce.id===z.completionContextId);if(!j)return null;const he=j.description?` - ${j.description}`:"";return`At ${o.value.checkpoint} ${j.name}${he}`}if(z.completionContextType==="Area"){const j=K.value.find(he=>he.id===z.completionContextId);return j?`At ${o.value.area} ${j.name}`:null}return z.completionContextType==="Personal"?"Personal item":null},Ct=async(z,j=!0,he=null)=>{Oe.value=z.id,Xe.value=z.id,et.value=null;const Ce=s.params.eventId,Re=z.effectiveIsCheckedIn||z.isCheckedIn,Je=Re?"check-out":"check-in",at=!Re;let gt=null,yt=null,Wt="Manual";if(j&&!Re&&"geolocation"in navigator)try{const mt=await new Promise((Tt,It)=>{navigator.geolocation.getCurrentPosition(Tt,It,{enableHighAccuracy:!0,timeout:5e3})});gt=mt.coords.latitude,yt=mt.coords.longitude,Wt="GPS"}catch(mt){console.log("GPS unavailable, using manual check-in:",mt.message)}const wt={latitude:gt,longitude:yt,action:Je};try{if(Mn()){await po("checkin_toggle",{eventId:Ce,assignmentId:z.id,gpsData:wt});const mt=U.value.findIndex(Tt=>Tt.id===z.id);if(mt!==-1&&(U.value[mt]={...U.value[mt],isCheckedIn:at,checkInTime:at?new Date().toISOString():null,checkInMethod:at?`${Wt} (pending)`:null,checkInLatitude:gt,checkInLongitude:yt}),he){const Tt=Z.value.find(It=>It.id===he);if(Tt?.assignments){const It=Tt.assignments.find(on=>on.id===z.id||on.marshalId===z.marshalId);It&&(It.isCheckedIn=at,It.checkInTime=at?new Date().toISOString():null)}}await i(),await hr(Ce,"locations",Z.value)}else{const mt=await Ns.toggleCheckIn(Ce,z.id,wt),Tt=U.value.findIndex(It=>It.id===z.id);if(Tt!==-1&&(U.value[Tt]=mt.data),he){const It=Z.value.find(on=>on.id===he);if(It?.assignments){const on=It.assignments.find(ho=>ho.id===z.id||ho.marshalId===z.marshalId);on&&Object.assign(on,mt.data)}}}he&&J.value?.loadDashboard&&await J.value.loadDashboard(),ot.value++}catch(mt){if(Mn()||!mt.response){await po("checkin_toggle",{eventId:Ce,assignmentId:z.id,gpsData:wt});const Tt=U.value.findIndex(It=>It.id===z.id);Tt!==-1&&(U.value[Tt]={...U.value[Tt],isCheckedIn:at,checkInTime:at?new Date().toISOString():null,checkInMethod:at?"Manual (pending)":null}),await i()}else mt.response?.data?.message?et.value=mt.response.data.message:mt.message?et.value=mt.message:et.value=`Failed to ${Je}. Please try again.`}finally{Oe.value=null,Xe.value=null}},xi=()=>{un.value=!1,qt.value&&(qt.value(),qt.value=null)},ni=()=>{un.value=!1,qt.value=null},Ho=(z,j)=>{ko.value=z,Bn.value=j,yo.value=!0},Ii=()=>{yo.value=!1},Co=async z=>{go.value=!0;try{await us.create(l.value,z),cn.value=!1,bo(),Ho("Incident Reported","An administrator will review it shortly.")}catch(j){console.error("Failed to report incident:",j),Ho("Error",j.response?.data?.message||"Failed to report incident. Please try again.")}finally{go.value=!1}},_s=z=>{le.value=z,ye.value=!0},bs=async({incidentId:z,status:j})=>{try{await us.updateStatus(l.value,z,{status:j});const he=W.value.find(Ce=>Ce.incidentId===z);he&&(he.status=j),le.value?.incidentId===z&&(le.value.status=j)}catch(he){console.error("Failed to update incident status:",he),Ho("Error","Failed to update status. Please try again.")}},nn=()=>{oe.value="",ie.value=!0},Un=()=>{ie.value=!1,oe.value=""},sa=async()=>{if(!(!oe.value.trim()||!le.value)){ce.value=!0;try{await us.addNote(l.value,le.value.incidentId,oe.value.trim()),Un(),bo();const z=await us.get(l.value,le.value.incidentId);le.value=z.data}catch(z){console.error("Failed to add note:",z),Ho("Error","Failed to add note. Please try again.")}finally{ce.value=!1}}},ia=z=>{we.value=z,te.value=null,ke.value=null,De.value=!0},$i=()=>{De.value=!1,we.value=null,te.value=null,ke.value=null,uo.value=!1},uo=M(!1),Ti=()=>{uo.value=!0,De.value=!1,ge.value="map"},aa=z=>{if(uo.value&&we.value){pt(we.value.locationId,z.lat,z.lng,"manual"),uo.value=!1,we.value=null;return}if(Oo.value&&hn.value){const j=hn.value;Ht.value="Update location",bt.value=`Update ${j.location?.name||"dynamic checkpoint"} to this location?`,qt.value=async()=>{await pt(j.locationId,z.lat,z.lng,"manual")},un.value=!0}},Mi=z=>{if(!uo.value&&Oo.value&&hn.value){const j=hn.value;if(z.id===j.locationId)return;Ht.value="Copy location",bt.value=`Copy location from "${z.name}" to ${j.location?.name||"your dynamic checkpoint"}?`,qt.value=async()=>{await pt(j.locationId,z.latitude,z.longitude,"checkpoint",z.id)},un.value=!0}},pt=async(z,j,he,Ce,Re=null)=>{se.value=!0;try{const Je=s.params.eventId,at={latitude:j,longitude:he,sourceType:Ce};Re&&(at.sourceCheckpointId=Re);const gt=await no.updatePosition(Je,z,at);gt.data.success&&(Q.value&&si(),Cs(z,gt.data.latitude,gt.data.longitude,gt.data.lastLocationUpdate))}catch(Je){console.error("Failed to update location:",Je),Je.response?.status===403?alert("You do not have permission to update this location."):alert("Failed to update location. Please try again.")}finally{se.value=!1}},za=()=>{uo.value=!1,De.value=!0},zn=async()=>{if(we.value){se.value=!0,te.value=null;try{let z,j;if(en.value&&ao.value&&Date.now()-ao.value<3e4&&(z=en.value.lat,j=en.value.lng),!z||!j){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const Je=await new Promise((at,gt)=>{navigator.geolocation.getCurrentPosition(at,gt,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4})});z=Je.coords.latitude,j=Je.coords.longitude}const he=s.params.eventId,Ce=we.value.locationId,Re=await no.updatePosition(he,Ce,{latitude:z,longitude:j,sourceType:"gps"});Re.data.success&&(ke.value="Location updated successfully!",Cs(Ce,Re.data.latitude,Re.data.longitude,Re.data.lastLocationUpdate),setTimeout(()=>$i(),1500))}catch(z){console.error("Failed to update location with GPS:",z),z.response?.status===403?te.value="You do not have permission to update this location.":z.code===1?te.value="Location access denied. Please enable location permissions.":z.code===2?te.value="Unable to determine your location. Please try again.":z.code===3||z.message?.includes("Timeout")?te.value="GPS timed out. Please ensure location services are enabled and try again.":te.value="Failed to update location. Please try again."}finally{se.value=!1}}},ws=async z=>{if(!we.value)return;const j=Z.value.find(he=>he.id===z);if(!j){te.value="Source checkpoint not found.";return}se.value=!0,te.value=null;try{const he=s.params.eventId,Ce=we.value.locationId,Re=await no.updatePosition(he,Ce,{latitude:j.latitude,longitude:j.longitude,sourceType:"checkpoint",sourceCheckpointId:z});Re.data.success&&(Q.value&&si(),ke.value=`Location copied from ${j.name}!`,Cs(Ce,Re.data.latitude,Re.data.longitude,Re.data.lastLocationUpdate),setTimeout(()=>$i(),1500))}catch(he){console.error("Failed to copy location from checkpoint:",he),he.response?.status===403?te.value="You do not have permission to update this location.":te.value="Failed to update location. Please try again."}finally{se.value=!1}},Cs=(z,j,he,Ce)=>{const Re=Z.value.find(Je=>Je.id===z);Re&&(Re.latitude=j,Re.longitude=he,Re.lastLocationUpdate=Ce)},oi=z=>{Q.value?si():Ai(z)},Ai=z=>{Q.value=!0,Ei(z),X=setInterval(()=>{Ei(z)},6e4)},si=()=>{Q.value=!1,X&&(clearInterval(X),X=null)},Ei=async z=>{if(!(!z||!("geolocation"in navigator)))try{const j=await new Promise((Re,Je)=>{navigator.geolocation.getCurrentPosition(Re,Je,{enableHighAccuracy:!0,timeout:15e3})}),he=s.params.eventId,Ce=z.locationId;await no.updatePosition(he,Ce,{latitude:j.coords.latitude,longitude:j.coords.longitude,sourceType:"gps"}),Cs(Ce,j.coords.latitude,j.coords.longitude,new Date().toISOString())}catch(j){console.warn("Auto-update location failed:",j)}},Ha=()=>{O||!Z.value.some(j=>j.isDynamic||j.IsDynamic)||(O=setInterval(async()=>{try{const j=s.params.eventId,he=await no.getDynamicCheckpoints(j);if(he.data&&Array.isArray(he.data))for(const Ce of he.data){const Re=Z.value.find(Je=>Je.id===Ce.checkpointId);Re&&(Re.latitude=Ce.latitude,Re.longitude=Ce.longitude,Re.lastLocationUpdate=Ce.lastLocationUpdate)}}catch(j){console.warn("Failed to poll dynamic checkpoints:",j)}},6e4))},Va=()=>{O&&(clearInterval(O),O=null)},Pi=async()=>{try{await ds.logout()}catch{}const z=s.params.eventId;localStorage.removeItem("sessionToken"),localStorage.removeItem(`marshal_${z}`),localStorage.removeItem(`marshalCode_${z}`),u.value=!1,f.value=null,m.value=null,U.value=[],qe.value=[],No.value=[],a.push("/")},ii=()=>{Ht.value="Logout",bt.value=`Are you sure you want to logout${f.value?.name?`, ${f.value.name}`:""}?`,qt.value=Pi,un.value=!0},Xn=z=>z?new Date(z).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";Qt(async()=>{const z=s.params.eventId,j=s.query.code;re.value=!0;try{j?await zo(z,j):await ks(z)&&await ei()}finally{re.value=!1}u.value&&(Do(),"requestIdleCallback"in window?requestIdleCallback(()=>{ti()},{timeout:5e3}):setTimeout(()=>{ti()},2e3))}),Ze(u,z=>{z?Do():Ws()}),Ze(()=>s.query.code,async z=>{if(z&&u.value){re.value=!0;try{await zo(s.params.eventId,z)}finally{re.value=!1}}}),Ze(R,z=>{z&&(document.title=`OnTheDay App - ${t.value.person}`)},{immediate:!0});let Ls=null;const Di=()=>{Ls||(Ls=setInterval(async()=>{if(y.value?.marshalId)try{await ds.getMe(s.params.eventId)}catch(z){console.debug("Heartbeat failed:",z)}},300*1e3))},Lo=()=>{Ls&&(clearInterval(Ls),Ls=null)};return On(()=>{Lo(),si(),Va()}),(z,j)=>(v(),g("div",{class:"marshal-view",style:ut(V(Pe))},[Ee($B),r("header",{class:ue(["header",`logo-${V(Me)}`]),style:ut(V(me))},[V(ae)&&V(Me)==="cover"?(v(),g("div",sU,[r("img",{src:V(ae),alt:"Event logo",class:"header-logo-cover-img"},null,8,iU)])):P("",!0),u.value&&V(Me)==="right"?(v(),g("button",{key:1,onClick:ii,class:"btn-logout-icon btn-logout-left",style:ut({color:V(Ae)}),title:`Logout ${f.value?.name||""}`},[r("span",{innerHTML:V(Sn)("logout")},null,8,lU)],12,aU)):P("",!0),V(ae)&&V(Me)==="left"?(v(),g("div",rU,[r("img",{src:V(ae),alt:"Event logo",class:"header-logo-img"},null,8,cU)])):P("",!0),r("div",uU,[r("div",{class:"header-title",style:ut({color:V(Ae)})},[R.value?(v(),g("h1",dU,w(R.value.name),1)):P("",!0),R.value?.eventDate?(v(),g("div",hU,w(Xn(R.value.eventDate)),1)):P("",!0)],4),u.value?(v(),g("div",fU,[r("button",{onClick:j[0]||(j[0]=he=>cn.value=!0),class:"btn-header-action btn-report-incident"}," Report Incident "),r("button",{onClick:j[1]||(j[1]=he=>jt.value=!0),class:"btn-header-action btn-emergency"}," Emergency Info ")])):P("",!0)]),V(ae)&&V(Me)==="right"?(v(),g("div",pU,[r("img",{src:V(ae),alt:"Event logo",class:"header-logo-img"},null,8,vU)])):P("",!0),u.value&&V(Me)!=="right"?(v(),g("button",{key:4,onClick:ii,class:"btn-logout-icon btn-logout-right",style:ut({color:V(Ae)}),title:`Logout ${f.value?.name||""}`},[r("span",{innerHTML:V(Sn)("logout")},null,8,gU)],12,mU)):P("",!0)],6),r("div",yU,[re.value?(v(),g("div",kU,[...j[19]||(j[19]=[r("div",{class:"loading"},"Loading...",-1)])])):!u.value&&!p.value?(v(),g("div",_U,[j[20]||(j[20]=r("h2",null,"Welcome",-1)),j[21]||(j[21]=r("p",{class:"instruction"},"Please use the login link sent to you to access your marshal dashboard.",-1)),d.value?(v(),g("p",bU,"Authenticating...")):P("",!0)])):p.value?(v(),g("div",wU,[j[22]||(j[22]=r("h2",null,"Login failed",-1)),r("p",CU,w(p.value),1),j[23]||(j[23]=r("p",{class:"instruction"},"Please contact the event organiser for a new login link.",-1))])):(v(),g("div",LU,[N.value||$.value?(v(),g("div",SU,[r("div",xU,[f.value?.email?(v(),g("span",IU,w(f.value.email),1)):P("",!0)]),N.value?(v(),g("div",$U,[r("button",{onClick:G,class:"btn-mode-switch"}," Switch to Admin ")])):$.value?(v(),g("div",TU,[...j[24]||(j[24]=[r("span",{class:"reauth-hint",title:"Login via admin flow to access admin features"}," Admin access requires re-login ",-1)])])):P("",!0)])):P("",!0),r("div",MU,[Ee(tU,{ref:"assignmentsSectionRef","is-expanded":ge.value==="assignments",assignments:_n.value,"expanded-checkpoint-id":kn.value,"all-locations":Z.value,route:Nn.value,"user-location":V(en),"header-style":V(me),"header-text-color":V(Ae),"has-dynamic-assignment":Oo.value,"current-marshal-id":m.value,"current-marshal-name":_.value,"checking-in-id":Oe.value,"checking-in-assignment-id":Xe.value,"check-in-error":et.value,"checking-in-marshal-id":Oe.value,"expanded-marshal-id":ln.value,"updating-location":se.value,"auto-update-enabled":Q.value,"checkpoint-term":V(o).checkpoint,"checkpoint-term-plural":V(o).checkpoints,"people-term":V(t).people,"area-term":V(t).area,"get-toolbar-actions":Si,"is-area-lead-for-areas":Qe,"get-notes-for-checkpoint":Js,onToggle:j[2]||(j[2]=he=>dn("assignments")),onToggleCheckpoint:Ro,onMapClick:aa,onLocationClick:Mi,onActionClick:Qs,onVisibilityChange:Dt,onUpdateLocation:ia,onCheckIn:j[3]||(j[3]=he=>Ct(he,!0)),onToggleMarshal:Po,onMarshalCheckIn:j[4]||(j[4]=(he,Ce)=>Ct(he,!1,Ce)),onToggleAutoUpdate:oi},null,8,["is-expanded","assignments","expanded-checkpoint-id","all-locations","route","user-location","header-style","header-text-color","has-dynamic-assignment","current-marshal-id","current-marshal-name","checking-in-id","checking-in-assignment-id","check-in-error","checking-in-marshal-id","expanded-marshal-id","updating-location","auto-update-enabled","checkpoint-term","checkpoint-term-plural","people-term","area-term"]),Ee(H7,{loading:tt.value,error:be.value,"is-expanded":ge.value==="checklist","checklist-term":V(o).checklists,"area-term":V(o).area,"is-area-lead":S.value,"my-items":tn.value,"area-items":ro.value,"area-items-with-local-state":Bo.value,"visible-items":bn.value,"grouped-items":Mt.value,"completed-count":vs.value,saving:He.value,"effective-group-by":kt.value,"expanded-group":fe.value,locations:Z.value,areas:K.value,marshals:Jn.value,"get-context-name":mn,onToggle:j[5]||(j[5]=he=>dn("checklist")),onToggleItem:rt,onToggleGroup:ms},null,8,["loading","error","is-expanded","checklist-term","area-term","is-area-lead","my-items","area-items","area-items-with-local-state","visible-items","grouped-items","completed-count","saving","effective-group-by","expanded-group","locations","areas","marshals"]),Ee(K7,{"event-id":V(s).params.eventId,notes:Te.value,locations:Z.value,areas:K.value,assignments:U.value,"is-expanded":ge.value==="notes",onToggle:j[6]||(j[6]=he=>dn("notes")),onNotesChanged:fn},null,8,["event-id","notes","locations","areas","assignments","is-expanded"]),Ee(BN,{contacts:Ys.value,loading:_o.value,"is-expanded":ge.value==="eventContacts",onToggle:j[7]||(j[7]=he=>dn("eventContacts"))},null,8,["contacts","loading","is-expanded"]),Ee(qN,{incidents:W.value,loading:Y.value,"is-expanded":ge.value==="incidents",onToggle:j[8]||(j[8]=he=>dn("incidents")),onSelectIncident:_s},null,8,["incidents","loading","is-expanded"]),Ee(vF,{ref_key:"areaLeadSectionRef",ref:q,"is-area-lead":S.value,"is-expanded":ge.value==="areaLead",areas:D.value,"area-term":V(o).area,"area-term-plural":V(o).areas,"selected-filters":T.value,"filtered-area-ids":I.value,"event-id":V(s).params.eventId,"marshal-id":m.value,route:Nn.value,onToggle:j[9]||(j[9]=he=>dn("areaLead")),onToggleFilter:C,onChecklistUpdated:co},null,8,["is-area-lead","is-expanded","areas","area-term","area-term-plural","selected-filters","filtered-area-ids","event-id","marshal-id","route"]),Ee(HF,{"is-area-lead":S.value,"is-expanded":ge.value==="areaLeadMarshals",marshals:$t.value,"expanded-marshal-id":$e.value,"person-term":V(o).person,"people-term":V(o).people,"checklist-term":V(t).checklists,"checklist-term-lower":V(o).checklists,"checking-in-marshal-id":Oe.value,"saving-task":We.value,onToggle:j[10]||(j[10]=he=>dn("areaLeadMarshals")),onToggleMarshal:st,onCheckIn:Nt,onToggleTask:Pt},null,8,["is-area-lead","is-expanded","marshals","expanded-marshal-id","person-term","people-term","checklist-term","checklist-term-lower","checking-in-marshal-id","saving-task"]),Ee(aF,{ref_key:"routeSectionRef",ref:io,"is-expanded":ge.value==="map","course-term":V(t).course,"user-location":V(en),"selecting-location":uo.value,"selecting-location-name":we.value?.location?.name||"",locations:Z.value,route:Nn.value,center:Fo.value,"highlight-location-ids":Yn.value,clickable:uo.value||Oo.value,"header-style":V(me),"header-text-color":V(Ae),"toolbar-actions":Uo.value,onToggle:j[11]||(j[11]=he=>dn("map")),onCancelSelect:za,onMapClick:aa,onLocationClick:Mi,onActionClick:ys,onVisibilityChange:gs},null,8,["is-expanded","course-term","user-location","selecting-location","selecting-location-name","locations","route","center","highlight-location-ids","clickable","header-style","header-text-color","toolbar-actions"]),Ee(i7,{"event-date":R.value?.eventDate,description:R.value?.description,"is-expanded":ge.value==="eventDetails",onToggle:j[12]||(j[12]=he=>dn("eventDetails"))},null,8,["event-date","description","is-expanded"])])]))]),Ee(tO,{show:jt.value,contacts:ht.value,notes:Gt.value,onClose:j[13]||(j[13]=he=>jt.value=!1)},null,8,["show","contacts","notes"]),Ee(Mv,{show:cn.value,"event-id":l.value||"",checkpoint:A.value,"initial-location":V(en),checkpoints:Z.value,route:Nn.value,onClose:j[14]||(j[14]=he=>cn.value=!1),onSubmit:Co},null,8,["show","event-id","checkpoint","initial-location","checkpoints","route"]),Ee(Tv,{show:ye.value,incident:le.value,route:Nn.value,checkpoints:Z.value,"can-manage":S.value,onClose:j[15]||(j[15]=he=>ye.value=!1),onStatusChange:bs,onOpenAddNote:nn},null,8,["show","incident","route","checkpoints","can-manage"]),Ee(zt,{show:ie.value,title:"Add update",size:"small",onClose:Un},{footer:Ue(()=>[r("div",EU,[r("button",{type:"button",class:"btn btn-secondary",onClick:Un}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:sa,disabled:!oe.value.trim()||ce.value},w(ce.value?"Adding...":"Add update"),9,PU)])]),default:Ue(()=>[r("div",AU,[Ve(r("textarea",{"onUpdate:modelValue":j[16]||(j[16]=he=>oe.value=he),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[nt,oe.value]])])]),_:1},8,["show"]),Ee(Pa,{show:un.value,title:Ht.value,message:bt.value,onConfirm:xi,onCancel:ni},null,8,["show","title","message"]),Ee(Pa,{show:yo.value,title:ko.value,message:Bn.value,"show-cancel":!1,onConfirm:Ii},null,8,["show","title","message"]),Ee(jB,{show:Zt.value,checkpoint:Eo.value,"checkpoint-term":V(t).checkpoint,"accent-button-style":V(Fe),onDismiss:j[17]||(j[17]=he=>ps(Eo.value?.id)),onGoToCheckpoint:Li},null,8,["show","checkpoint","checkpoint-term","accent-button-style"]),Ee(mN,{show:De.value,assignment:we.value,"user-location":V(en),"auto-update-enabled":Q.value,updating:se.value,error:te.value,success:ke.value,"available-checkpoints":Xs.value,"checkpoint-term":we.value?.location?.resolvedCheckpointTerm||V(t).checkpoint,"checkpoint-term-plural":V(o).checkpoints,"accent-button-style":V(Fe),onClose:$i,onUpdateGps:zn,onToggleAutoUpdate:j[18]||(j[18]=he=>oi(we.value)),onSelectOnMap:Ti,onCopyFromCheckpoint:ws},null,8,["show","assignment","user-location","auto-update-enabled","updating","error","success","available-checkpoints","checkpoint-term","checkpoint-term-plural","accent-button-style"])],4))}},OU=ze(RU,[["__scopeId","data-v-6a7c80a9"]]),BU=[{path:"/",name:"Home",component:H_},{path:"/admin/login",name:"AdminLogin",component:Y_},{path:"/admin/verify",name:"AdminVerify",component:ob},{path:"/admin/dashboard",name:"AdminDashboard",component:s0,meta:{requiresAuth:!0}},{path:"/admin/profile",name:"AdminProfile",component:M0,meta:{requiresAuth:!0}},{path:"/admin/event/:eventId",name:"AdminEventManage",component:BR,meta:{requiresAuth:!0}},{path:"/event/:eventId",name:"MarshalView",component:OU},{path:"/:pathMatch(.*)*",redirect:"/"}],Ev=Nk({history:mk("/VolunteerCheckin/testing/"),routes:BU});Ev.beforeEach((e,t,o)=>{const i=localStorage.getItem("adminEmail");e.meta.requiresAuth&&!i?o({name:"AdminLogin"}):o()});qs().then(()=>{console.log("Offline database initialized")}).catch(e=>{console.warn("Failed to initialize offline database:",e)});const Ku=_y(Ay);Ku.use(Cy());Ku.use(Ev);Ku.mount("#app");
