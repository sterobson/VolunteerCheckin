(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function o(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=o(s);fetch(s.href,i)}})();function Pu(e){const t=Object.create(null);for(const o of e.split(","))t[o]=1;return o=>o in t}const Bt={},Ei=[],Qo=()=>{},mf=()=>!1,Zr=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Du=e=>e.startsWith("onUpdate:"),hn=Object.assign,Ru=(e,t)=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},mm=Object.prototype.hasOwnProperty,Dt=(e,t)=>mm.call(e,t),it=Array.isArray,Pi=e=>Fl(e)==="[object Map]",Hi=e=>Fl(e)==="[object Set]",xd=e=>Fl(e)==="[object Date]",dt=e=>typeof e=="function",Xt=e=>typeof e=="string",ts=e=>typeof e=="symbol",Ot=e=>e!==null&&typeof e=="object",gf=e=>(Ot(e)||dt(e))&&dt(e.then)&&dt(e.catch),yf=Object.prototype.toString,Fl=e=>yf.call(e),gm=e=>Fl(e).slice(8,-1),kf=e=>Fl(e)==="[object Object]",qr=e=>Xt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,vl=Pu(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Wr=e=>{const t=Object.create(null);return(o=>t[o]||(t[o]=e(o)))},ym=/-\w/g,Po=Wr(e=>e.replace(ym,t=>t.slice(1).toUpperCase())),km=/\B([A-Z])/g,Ia=Wr(e=>e.replace(km,"-$1").toLowerCase()),Kr=Wr(e=>e.charAt(0).toUpperCase()+e.slice(1)),Mc=Wr(e=>e?`on${Kr(e)}`:""),ba=(e,t)=>!Object.is(e,t),vr=(e,...t)=>{for(let o=0;o<e.length;o++)e[o](...t)},_f=(e,t,o,a=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:a,value:o})},Jr=e=>{const t=parseFloat(e);return isNaN(t)?e:t},_m=e=>{const t=Xt(e)?Number(e):NaN;return isNaN(t)?e:t};let Id;const Yr=()=>Id||(Id=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Qe(e){if(it(e)){const t={};for(let o=0;o<e.length;o++){const a=e[o],s=Xt(a)?Lm(a):Qe(a);if(s)for(const i in s)t[i]=s[i]}return t}else if(Xt(e)||Ot(e))return e}const bm=/;(?![^(]*\))/g,wm=/:([^]+)/,Cm=/\/\*[^]*?\*\//g;function Lm(e){const t={};return e.replace(Cm,"").split(bm).forEach(o=>{if(o){const a=o.split(wm);a.length>1&&(t[a[0].trim()]=a[1].trim())}}),t}function de(e){let t="";if(Xt(e))t=e;else if(it(e))for(let o=0;o<e.length;o++){const a=de(e[o]);a&&(t+=a+" ")}else if(Ot(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}const Sm="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",xm=Pu(Sm);function bf(e){return!!e||e===""}function Im(e,t){if(e.length!==t.length)return!1;let o=!0;for(let a=0;o&&a<e.length;a++)o=si(e[a],t[a]);return o}function si(e,t){if(e===t)return!0;let o=xd(e),a=xd(t);if(o||a)return o&&a?e.getTime()===t.getTime():!1;if(o=ts(e),a=ts(t),o||a)return e===t;if(o=it(e),a=it(t),o||a)return o&&a?Im(e,t):!1;if(o=Ot(e),a=Ot(t),o||a){if(!o||!a)return!1;const s=Object.keys(e).length,i=Object.keys(t).length;if(s!==i)return!1;for(const l in e){const u=e.hasOwnProperty(l),d=t.hasOwnProperty(l);if(u&&!d||!u&&d||!si(e[l],t[l]))return!1}}return String(e)===String(t)}function Ou(e,t){return e.findIndex(o=>si(o,t))}const wf=e=>!!(e&&e.__v_isRef===!0),C=e=>Xt(e)?e:e==null?"":it(e)||Ot(e)&&(e.toString===yf||!dt(e.toString))?wf(e)?C(e.value):JSON.stringify(e,Cf,2):String(e),Cf=(e,t)=>wf(t)?Cf(e,t.value):Pi(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((o,[a,s],i)=>(o[Ac(a,i)+" =>"]=s,o),{})}:Hi(t)?{[`Set(${t.size})`]:[...t.values()].map(o=>Ac(o))}:ts(t)?Ac(t):Ot(t)&&!it(t)&&!kf(t)?String(t):t,Ac=(e,t="")=>{var o;return ts(e)?`Symbol(${(o=e.description)!=null?o:t})`:e};function $m(e){return e==null?"initial":typeof e=="string"?e===""?" ":e:String(e)}let En;class Lf{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=En,!t&&En&&(this.index=(En.scopes||(En.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].pause();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].resume();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].resume()}}run(t){if(this._active){const o=En;try{return En=this,t()}finally{En=o}}}on(){++this._on===1&&(this.prevScope=En,En=this)}off(){this._on>0&&--this._on===0&&(En=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let o,a;for(o=0,a=this.effects.length;o<a;o++)this.effects[o].stop();for(this.effects.length=0,o=0,a=this.cleanups.length;o<a;o++)this.cleanups[o]();if(this.cleanups.length=0,this.scopes){for(o=0,a=this.scopes.length;o<a;o++)this.scopes[o].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function Sf(e){return new Lf(e)}function xf(){return En}function Tm(e,t=!1){En&&En.cleanups.push(e)}let Vt;const Ec=new WeakSet;class If{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,En&&En.active&&En.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Ec.has(this)&&(Ec.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Tf(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,$d(this),Mf(this);const t=Vt,o=es;Vt=this,es=!0;try{return this.fn()}finally{Af(this),Vt=t,es=o,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Fu(t);this.deps=this.depsTail=void 0,$d(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Ec.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Qc(this)&&this.run()}get dirty(){return Qc(this)}}let $f=0,ml,gl;function Tf(e,t=!1){if(e.flags|=8,t){e.next=gl,gl=e;return}e.next=ml,ml=e}function Bu(){$f++}function Nu(){if(--$f>0)return;if(gl){let t=gl;for(gl=void 0;t;){const o=t.next;t.next=void 0,t.flags&=-9,t=o}}let e;for(;ml;){let t=ml;for(ml=void 0;t;){const o=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(a){e||(e=a)}t=o}}if(e)throw e}function Mf(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Af(e){let t,o=e.depsTail,a=o;for(;a;){const s=a.prevDep;a.version===-1?(a===o&&(o=s),Fu(a),Mm(a)):t=a,a.dep.activeLink=a.prevActiveLink,a.prevActiveLink=void 0,a=s}e.deps=t,e.depsTail=o}function Qc(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Ef(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Ef(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===xl)||(e.globalVersion=xl,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!Qc(e))))return;e.flags|=2;const t=e.dep,o=Vt,a=es;Vt=e,es=!0;try{Mf(e);const s=e.fn(e._value);(t.version===0||ba(s,e._value))&&(e.flags|=128,e._value=s,t.version++)}catch(s){throw t.version++,s}finally{Vt=o,es=a,Af(e),e.flags&=-3}}function Fu(e,t=!1){const{dep:o,prevSub:a,nextSub:s}=e;if(a&&(a.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=a,e.nextSub=void 0),o.subs===e&&(o.subs=a,!a&&o.computed)){o.computed.flags&=-5;for(let i=o.computed.deps;i;i=i.nextDep)Fu(i,!0)}!t&&!--o.sc&&o.map&&o.map.delete(o.key)}function Mm(e){const{prevDep:t,nextDep:o}=e;t&&(t.nextDep=o,e.prevDep=void 0),o&&(o.prevDep=t,e.nextDep=void 0)}let es=!0;const Pf=[];function Us(){Pf.push(es),es=!1}function zs(){const e=Pf.pop();es=e===void 0?!0:e}function $d(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const o=Vt;Vt=void 0;try{t()}finally{Vt=o}}}let xl=0;class Am{constructor(t,o){this.sub=t,this.dep=o,this.version=o.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Uu{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!Vt||!es||Vt===this.computed)return;let o=this.activeLink;if(o===void 0||o.sub!==Vt)o=this.activeLink=new Am(Vt,this),Vt.deps?(o.prevDep=Vt.depsTail,Vt.depsTail.nextDep=o,Vt.depsTail=o):Vt.deps=Vt.depsTail=o,Df(o);else if(o.version===-1&&(o.version=this.version,o.nextDep)){const a=o.nextDep;a.prevDep=o.prevDep,o.prevDep&&(o.prevDep.nextDep=a),o.prevDep=Vt.depsTail,o.nextDep=void 0,Vt.depsTail.nextDep=o,Vt.depsTail=o,Vt.deps===o&&(Vt.deps=a)}return o}trigger(t){this.version++,xl++,this.notify(t)}notify(t){Bu();try{for(let o=this.subs;o;o=o.prevSub)o.sub.notify()&&o.sub.dep.notify()}finally{Nu()}}}function Df(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let a=t.deps;a;a=a.nextDep)Df(a)}const o=e.dep.subs;o!==e&&(e.prevSub=o,o&&(o.nextSub=e)),e.dep.subs=e}}const Lr=new WeakMap,ei=Symbol(""),eu=Symbol(""),Il=Symbol("");function Dn(e,t,o){if(es&&Vt){let a=Lr.get(e);a||Lr.set(e,a=new Map);let s=a.get(o);s||(a.set(o,s=new Uu),s.map=a,s.key=o),s.track()}}function Ps(e,t,o,a,s,i){const l=Lr.get(e);if(!l){xl++;return}const u=d=>{d&&d.trigger()};if(Bu(),t==="clear")l.forEach(u);else{const d=it(e),p=d&&qr(o);if(d&&o==="length"){const f=Number(a);l.forEach((g,y)=>{(y==="length"||y===Il||!ts(y)&&y>=f)&&u(g)})}else switch((o!==void 0||l.has(void 0))&&u(l.get(o)),p&&u(l.get(Il)),t){case"add":d?p&&u(l.get("length")):(u(l.get(ei)),Pi(e)&&u(l.get(eu)));break;case"delete":d||(u(l.get(ei)),Pi(e)&&u(l.get(eu)));break;case"set":Pi(e)&&u(l.get(ei));break}}Nu()}function Em(e,t){const o=Lr.get(e);return o&&o.get(t)}function Si(e){const t=Tt(e);return t===e?t:(Dn(t,"iterate",Il),wo(e)?t:t.map(ns))}function Xr(e){return Dn(e=Tt(e),"iterate",Il),e}function pa(e,t){return Hs(e)?Fs(e)?Bi(ns(t)):Bi(t):ns(t)}const Pm={__proto__:null,[Symbol.iterator](){return Pc(this,Symbol.iterator,e=>pa(this,e))},concat(...e){return Si(this).concat(...e.map(t=>it(t)?Si(t):t))},entries(){return Pc(this,"entries",e=>(e[1]=pa(this,e[1]),e))},every(e,t){return Is(this,"every",e,t,void 0,arguments)},filter(e,t){return Is(this,"filter",e,t,o=>o.map(a=>pa(this,a)),arguments)},find(e,t){return Is(this,"find",e,t,o=>pa(this,o),arguments)},findIndex(e,t){return Is(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Is(this,"findLast",e,t,o=>pa(this,o),arguments)},findLastIndex(e,t){return Is(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Is(this,"forEach",e,t,void 0,arguments)},includes(...e){return Dc(this,"includes",e)},indexOf(...e){return Dc(this,"indexOf",e)},join(e){return Si(this).join(e)},lastIndexOf(...e){return Dc(this,"lastIndexOf",e)},map(e,t){return Is(this,"map",e,t,void 0,arguments)},pop(){return al(this,"pop")},push(...e){return al(this,"push",e)},reduce(e,...t){return Td(this,"reduce",e,t)},reduceRight(e,...t){return Td(this,"reduceRight",e,t)},shift(){return al(this,"shift")},some(e,t){return Is(this,"some",e,t,void 0,arguments)},splice(...e){return al(this,"splice",e)},toReversed(){return Si(this).toReversed()},toSorted(e){return Si(this).toSorted(e)},toSpliced(...e){return Si(this).toSpliced(...e)},unshift(...e){return al(this,"unshift",e)},values(){return Pc(this,"values",e=>pa(this,e))}};function Pc(e,t,o){const a=Xr(e),s=a[t]();return a!==e&&!wo(e)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.done||(i.value=o(i.value)),i}),s}const Dm=Array.prototype;function Is(e,t,o,a,s,i){const l=Xr(e),u=l!==e&&!wo(e),d=l[t];if(d!==Dm[t]){const g=d.apply(e,i);return u?ns(g):g}let p=o;l!==e&&(u?p=function(g,y){return o.call(this,pa(e,g),y,e)}:o.length>2&&(p=function(g,y){return o.call(this,g,y,e)}));const f=d.call(l,p,a);return u&&s?s(f):f}function Td(e,t,o,a){const s=Xr(e);let i=o;return s!==e&&(wo(e)?o.length>3&&(i=function(l,u,d){return o.call(this,l,u,d,e)}):i=function(l,u,d){return o.call(this,l,pa(e,u),d,e)}),s[t](i,...a)}function Dc(e,t,o){const a=Tt(e);Dn(a,"iterate",Il);const s=a[t](...o);return(s===-1||s===!1)&&Qr(o[0])?(o[0]=Tt(o[0]),a[t](...o)):s}function al(e,t,o=[]){Us(),Bu();const a=Tt(e)[t].apply(e,o);return Nu(),zs(),a}const Rm=Pu("__proto__,__v_isRef,__isVue"),Rf=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(ts));function Om(e){ts(e)||(e=String(e));const t=Tt(this);return Dn(t,"has",e),t.hasOwnProperty(e)}class Of{constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,a){if(o==="__v_skip")return t.__v_skip;const s=this._isReadonly,i=this._isShallow;if(o==="__v_isReactive")return!s;if(o==="__v_isReadonly")return s;if(o==="__v_isShallow")return i;if(o==="__v_raw")return a===(s?i?Zm:Uf:i?Ff:Nf).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(a)?t:void 0;const l=it(t);if(!s){let d;if(l&&(d=Pm[o]))return d;if(o==="hasOwnProperty")return Om}const u=Reflect.get(t,o,Yt(t)?t:a);if((ts(o)?Rf.has(o):Rm(o))||(s||Dn(t,"get",o),i))return u;if(Yt(u)){const d=l&&qr(o)?u:u.value;return s&&Ot(d)?nu(d):d}return Ot(u)?s?nu(u):ii(u):u}}class Bf extends Of{constructor(t=!1){super(!1,t)}set(t,o,a,s){let i=t[o];const l=it(t)&&qr(o);if(!this._isShallow){const p=Hs(i);if(!wo(a)&&!Hs(a)&&(i=Tt(i),a=Tt(a)),!l&&Yt(i)&&!Yt(a))return p||(i.value=a),!0}const u=l?Number(o)<t.length:Dt(t,o),d=Reflect.set(t,o,a,Yt(t)?t:s);return t===Tt(s)&&(u?ba(a,i)&&Ps(t,"set",o,a):Ps(t,"add",o,a)),d}deleteProperty(t,o){const a=Dt(t,o);t[o];const s=Reflect.deleteProperty(t,o);return s&&a&&Ps(t,"delete",o,void 0),s}has(t,o){const a=Reflect.has(t,o);return(!ts(o)||!Rf.has(o))&&Dn(t,"has",o),a}ownKeys(t){return Dn(t,"iterate",it(t)?"length":ei),Reflect.ownKeys(t)}}class Bm extends Of{constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const Nm=new Bf,Fm=new Bm,Um=new Bf(!0);const tu=e=>e,ir=e=>Reflect.getPrototypeOf(e);function zm(e,t,o){return function(...a){const s=this.__v_raw,i=Tt(s),l=Pi(i),u=e==="entries"||e===Symbol.iterator&&l,d=e==="keys"&&l,p=s[e](...a),f=o?tu:t?Bi:ns;return!t&&Dn(i,"iterate",d?eu:ei),{next(){const{value:g,done:y}=p.next();return y?{value:g,done:y}:{value:u?[f(g[0]),f(g[1])]:f(g),done:y}},[Symbol.iterator](){return this}}}}function lr(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Hm(e,t){const o={get(s){const i=this.__v_raw,l=Tt(i),u=Tt(s);e||(ba(s,u)&&Dn(l,"get",s),Dn(l,"get",u));const{has:d}=ir(l),p=t?tu:e?Bi:ns;if(d.call(l,s))return p(i.get(s));if(d.call(l,u))return p(i.get(u));i!==l&&i.get(s)},get size(){const s=this.__v_raw;return!e&&Dn(Tt(s),"iterate",ei),s.size},has(s){const i=this.__v_raw,l=Tt(i),u=Tt(s);return e||(ba(s,u)&&Dn(l,"has",s),Dn(l,"has",u)),s===u?i.has(s):i.has(s)||i.has(u)},forEach(s,i){const l=this,u=l.__v_raw,d=Tt(u),p=t?tu:e?Bi:ns;return!e&&Dn(d,"iterate",ei),u.forEach((f,g)=>s.call(i,p(f),p(g),l))}};return hn(o,e?{add:lr("add"),set:lr("set"),delete:lr("delete"),clear:lr("clear")}:{add(s){!t&&!wo(s)&&!Hs(s)&&(s=Tt(s));const i=Tt(this);return ir(i).has.call(i,s)||(i.add(s),Ps(i,"add",s,s)),this},set(s,i){!t&&!wo(i)&&!Hs(i)&&(i=Tt(i));const l=Tt(this),{has:u,get:d}=ir(l);let p=u.call(l,s);p||(s=Tt(s),p=u.call(l,s));const f=d.call(l,s);return l.set(s,i),p?ba(i,f)&&Ps(l,"set",s,i):Ps(l,"add",s,i),this},delete(s){const i=Tt(this),{has:l,get:u}=ir(i);let d=l.call(i,s);d||(s=Tt(s),d=l.call(i,s)),u&&u.call(i,s);const p=i.delete(s);return d&&Ps(i,"delete",s,void 0),p},clear(){const s=Tt(this),i=s.size!==0,l=s.clear();return i&&Ps(s,"clear",void 0,void 0),l}}),["keys","values","entries",Symbol.iterator].forEach(s=>{o[s]=zm(s,e,t)}),o}function zu(e,t){const o=Hm(e,t);return(a,s,i)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?a:Reflect.get(Dt(o,s)&&s in a?o:a,s,i)}const Vm={get:zu(!1,!1)},Gm={get:zu(!1,!0)},jm={get:zu(!0,!1)};const Nf=new WeakMap,Ff=new WeakMap,Uf=new WeakMap,Zm=new WeakMap;function qm(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Wm(e){return e.__v_skip||!Object.isExtensible(e)?0:qm(gm(e))}function ii(e){return Hs(e)?e:Hu(e,!1,Nm,Vm,Nf)}function zf(e){return Hu(e,!1,Um,Gm,Ff)}function nu(e){return Hu(e,!0,Fm,jm,Uf)}function Hu(e,t,o,a,s){if(!Ot(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=Wm(e);if(i===0)return e;const l=s.get(e);if(l)return l;const u=new Proxy(e,i===2?a:o);return s.set(e,u),u}function Fs(e){return Hs(e)?Fs(e.__v_raw):!!(e&&e.__v_isReactive)}function Hs(e){return!!(e&&e.__v_isReadonly)}function wo(e){return!!(e&&e.__v_isShallow)}function Qr(e){return e?!!e.__v_raw:!1}function Tt(e){const t=e&&e.__v_raw;return t?Tt(t):e}function Vu(e){return!Dt(e,"__v_skip")&&Object.isExtensible(e)&&_f(e,"__v_skip",!0),e}const ns=e=>Ot(e)?ii(e):e,Bi=e=>Ot(e)?nu(e):e;function Yt(e){return e?e.__v_isRef===!0:!1}function $(e){return Hf(e,!1)}function Km(e){return Hf(e,!0)}function Hf(e,t){return Yt(e)?e:new Jm(e,t)}class Jm{constructor(t,o){this.dep=new Uu,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=o?t:Tt(t),this._value=o?t:ns(t),this.__v_isShallow=o}get value(){return this.dep.track(),this._value}set value(t){const o=this._rawValue,a=this.__v_isShallow||wo(t)||Hs(t);t=a?t:Tt(t),ba(t,o)&&(this._rawValue=t,this._value=a?t:ns(t),this.dep.trigger())}}function O(e){return Yt(e)?e.value:e}function Sr(e){return dt(e)?e():O(e)}const Ym={get:(e,t,o)=>t==="__v_raw"?e:O(Reflect.get(e,t,o)),set:(e,t,o,a)=>{const s=e[t];return Yt(s)&&!Yt(o)?(s.value=o,!0):Reflect.set(e,t,o,a)}};function Vf(e){return Fs(e)?e:new Proxy(e,Ym)}function Xm(e){const t=it(e)?new Array(e.length):{};for(const o in e)t[o]=eg(e,o);return t}class Qm{constructor(t,o,a){this._object=t,this._key=o,this._defaultValue=a,this.__v_isRef=!0,this._value=void 0,this._raw=Tt(t);let s=!0,i=t;if(!it(t)||!qr(String(o)))do s=!Qr(i)||wo(i);while(s&&(i=i.__v_raw));this._shallow=s}get value(){let t=this._object[this._key];return this._shallow&&(t=O(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&Yt(this._raw[this._key])){const o=this._object[this._key];if(Yt(o)){o.value=t;return}}this._object[this._key]=t}get dep(){return Em(this._raw,this._key)}}function eg(e,t,o){return new Qm(e,t,o)}class tg{constructor(t,o,a){this.fn=t,this.setter=o,this._value=void 0,this.dep=new Uu(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=xl-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!o,this.isSSR=a}notify(){if(this.flags|=16,!(this.flags&8)&&Vt!==this)return Tf(this,!0),!0}get value(){const t=this.dep.track();return Ef(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function ng(e,t,o=!1){let a,s;return dt(e)?a=e:(a=e.get,s=e.set),new tg(a,s,o)}const rr={},xr=new WeakMap;let Wa;function og(e,t=!1,o=Wa){if(o){let a=xr.get(o);a||xr.set(o,a=[]),a.push(e)}}function sg(e,t,o=Bt){const{immediate:a,deep:s,once:i,scheduler:l,augmentJob:u,call:d}=o,p=D=>s?D:wo(D)||s===!1||s===0?Ds(D,1):Ds(D);let f,g,y,_,k=!1,w=!1;if(Yt(e)?(g=()=>e.value,k=wo(e)):Fs(e)?(g=()=>p(e),k=!0):it(e)?(w=!0,k=e.some(D=>Fs(D)||wo(D)),g=()=>e.map(D=>{if(Yt(D))return D.value;if(Fs(D))return p(D);if(dt(D))return d?d(D,2):D()})):dt(e)?t?g=d?()=>d(e,2):e:g=()=>{if(y){Us();try{y()}finally{zs()}}const D=Wa;Wa=f;try{return d?d(e,3,[_]):e(_)}finally{Wa=D}}:g=Qo,t&&s){const D=g,R=s===!0?1/0:s;g=()=>Ds(D(),R)}const S=xf(),E=()=>{f.stop(),S&&S.active&&Ru(S.effects,f)};if(i&&t){const D=t;t=(...R)=>{D(...R),E()}}let A=w?new Array(e.length).fill(rr):rr;const x=D=>{if(!(!(f.flags&1)||!f.dirty&&!D))if(t){const R=f.run();if(s||k||(w?R.some((F,T)=>ba(F,A[T])):ba(R,A))){y&&y();const F=Wa;Wa=f;try{const T=[R,A===rr?void 0:w&&A[0]===rr?[]:A,_];A=R,d?d(t,3,T):t(...T)}finally{Wa=F}}}else f.run()};return u&&u(x),f=new If(g),f.scheduler=l?()=>l(x,!1):x,_=D=>og(D,!1,f),y=f.onStop=()=>{const D=xr.get(f);if(D){if(d)d(D,4);else for(const R of D)R();xr.delete(f)}},t?a?x(!0):A=f.run():l?l(x.bind(null,!0),!0):f.run(),E.pause=f.pause.bind(f),E.resume=f.resume.bind(f),E.stop=E,E}function Ds(e,t=1/0,o){if(t<=0||!Ot(e)||e.__v_skip||(o=o||new Map,(o.get(e)||0)>=t))return e;if(o.set(e,t),t--,Yt(e))Ds(e.value,t,o);else if(it(e))for(let a=0;a<e.length;a++)Ds(e[a],t,o);else if(Hi(e)||Pi(e))e.forEach(a=>{Ds(a,t,o)});else if(kf(e)){for(const a in e)Ds(e[a],t,o);for(const a of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,a)&&Ds(e[a],t,o)}return e}function Ul(e,t,o,a){try{return a?e(...a):e()}catch(s){ec(s,t,o)}}function os(e,t,o,a){if(dt(e)){const s=Ul(e,t,o,a);return s&&gf(s)&&s.catch(i=>{ec(i,t,o)}),s}if(it(e)){const s=[];for(let i=0;i<e.length;i++)s.push(os(e[i],t,o,a));return s}}function ec(e,t,o,a=!0){const s=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:l}=t&&t.appContext.config||Bt;if(t){let u=t.parent;const d=t.proxy,p=`https://vuejs.org/error-reference/#runtime-${o}`;for(;u;){const f=u.ec;if(f){for(let g=0;g<f.length;g++)if(f[g](e,d,p)===!1)return}u=u.parent}if(i){Us(),Ul(i,null,10,[e,d,p]),zs();return}}ag(e,o,s,a,l)}function ag(e,t,o,a=!0,s=!1){if(s)throw e;console.error(e)}const Jn=[];let ds=-1;const Di=[];let va=null,Ii=0;const Gf=Promise.resolve();let Ir=null;function cn(e){const t=Ir||Gf;return e?t.then(this?e.bind(this):e):t}function ig(e){let t=ds+1,o=Jn.length;for(;t<o;){const a=t+o>>>1,s=Jn[a],i=$l(s);i<e||i===e&&s.flags&2?t=a+1:o=a}return t}function Gu(e){if(!(e.flags&1)){const t=$l(e),o=Jn[Jn.length-1];!o||!(e.flags&2)&&t>=$l(o)?Jn.push(e):Jn.splice(ig(t),0,e),e.flags|=1,jf()}}function jf(){Ir||(Ir=Gf.then(Wf))}function Zf(e){it(e)?Di.push(...e):va&&e.id===-1?va.splice(Ii+1,0,e):e.flags&1||(Di.push(e),e.flags|=1),jf()}function Md(e,t,o=ds+1){for(;o<Jn.length;o++){const a=Jn[o];if(a&&a.flags&2){if(e&&a.id!==e.uid)continue;Jn.splice(o,1),o--,a.flags&4&&(a.flags&=-2),a(),a.flags&4||(a.flags&=-2)}}}function qf(e){if(Di.length){const t=[...new Set(Di)].sort((o,a)=>$l(o)-$l(a));if(Di.length=0,va){va.push(...t);return}for(va=t,Ii=0;Ii<va.length;Ii++){const o=va[Ii];o.flags&4&&(o.flags&=-2),o.flags&8||o(),o.flags&=-2}va=null,Ii=0}}const $l=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Wf(e){try{for(ds=0;ds<Jn.length;ds++){const t=Jn[ds];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Ul(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;ds<Jn.length;ds++){const t=Jn[ds];t&&(t.flags&=-2)}ds=-1,Jn.length=0,qf(),Ir=null,(Jn.length||Di.length)&&Wf()}}let Sn=null,Kf=null;function $r(e){const t=Sn;return Sn=e,Kf=e&&e.type.__scopeId||null,t}function ze(e,t=Sn,o){if(!t||e._n)return e;const a=(...s)=>{a._d&&Ar(-1);const i=$r(t);let l;try{l=e(...s)}finally{$r(i),a._d&&Ar(1)}return l};return a._n=!0,a._c=!0,a._d=!0,a}function Ue(e,t){if(Sn===null)return e;const o=ic(Sn),a=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[i,l,u,d=Bt]=t[s];i&&(dt(i)&&(i={mounted:i,updated:i}),i.deep&&Ds(l),a.push({dir:i,instance:o,value:l,oldValue:void 0,arg:u,modifiers:d}))}return e}function Va(e,t,o,a){const s=e.dirs,i=t&&t.dirs;for(let l=0;l<s.length;l++){const u=s[l];i&&(u.oldValue=i[l].value);let d=u.dir[a];d&&(Us(),os(d,o,8,[e.el,u,e,t]),zs())}}function yl(e,t){if(On){let o=On.provides;const a=On.parent&&On.parent.provides;a===o&&(o=On.provides=Object.create(a)),o[e]=t}}function lo(e,t,o=!1){const a=ac();if(a||ti){let s=ti?ti._context.provides:a?a.parent==null||a.ce?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return o&&dt(t)?t.call(a&&a.proxy):t}}function lg(){return!!(ac()||ti)}const rg=Symbol.for("v-scx"),cg=()=>lo(rg);function qe(e,t,o){return Jf(e,t,o)}function Jf(e,t,o=Bt){const{immediate:a,deep:s,flush:i,once:l}=o,u=hn({},o),d=t&&a||!t&&i!=="post";let p;if(Pl){if(i==="sync"){const _=cg();p=_.__watcherHandles||(_.__watcherHandles=[])}else if(!d){const _=()=>{};return _.stop=Qo,_.resume=Qo,_.pause=Qo,_}}const f=On;u.call=(_,k,w)=>os(_,f,k,w);let g=!1;i==="post"?u.scheduler=_=>{Wn(_,f&&f.suspense)}:i!=="sync"&&(g=!0,u.scheduler=(_,k)=>{k?_():Gu(_)}),u.augmentJob=_=>{t&&(_.flags|=4),g&&(_.flags|=2,f&&(_.id=f.uid,_.i=f))};const y=sg(e,t,u);return Pl&&(p?p.push(y):d&&y()),y}function ug(e,t,o){const a=this.proxy,s=Xt(e)?e.includes(".")?Yf(a,e):()=>a[e]:e.bind(a,a);let i;dt(t)?i=t:(i=t.handler,o=t);const l=zl(this),u=Jf(s,i.bind(a),o);return l(),u}function Yf(e,t){const o=t.split(".");return()=>{let a=e;for(let s=0;s<o.length&&a;s++)a=a[o[s]];return a}}const Xf=Symbol("_vte"),Qf=e=>e.__isTeleport,kl=e=>e&&(e.disabled||e.disabled===""),Ad=e=>e&&(e.defer||e.defer===""),Ed=e=>typeof SVGElement<"u"&&e instanceof SVGElement,Pd=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,ou=(e,t)=>{const o=e&&e.to;return Xt(o)?t?t(o):null:o},ep={name:"Teleport",__isTeleport:!0,process(e,t,o,a,s,i,l,u,d,p){const{mc:f,pc:g,pbc:y,o:{insert:_,querySelector:k,createText:w,createComment:S}}=p,E=kl(t.props);let{shapeFlag:A,children:x,dynamicChildren:D}=t;if(e==null){const R=t.el=w(""),F=t.anchor=w("");_(R,o,a),_(F,o,a);const T=(B,q)=>{A&16&&f(x,B,q,s,i,l,u,d)},N=()=>{const B=t.target=ou(t.props,k),q=tp(B,t,w,_);B&&(l!=="svg"&&Ed(B)?l="svg":l!=="mathml"&&Pd(B)&&(l="mathml"),s&&s.isCE&&(s.ce._teleportTargets||(s.ce._teleportTargets=new Set)).add(B),E||(T(B,q),mr(t,!1)))};E&&(T(o,F),mr(t,!0)),Ad(t.props)?(t.el.__isMounted=!1,Wn(()=>{N(),delete t.el.__isMounted},i)):N()}else{if(Ad(t.props)&&e.el.__isMounted===!1){Wn(()=>{ep.process(e,t,o,a,s,i,l,u,d,p)},i);return}t.el=e.el,t.targetStart=e.targetStart;const R=t.anchor=e.anchor,F=t.target=e.target,T=t.targetAnchor=e.targetAnchor,N=kl(e.props),B=N?o:F,q=N?R:T;if(l==="svg"||Ed(F)?l="svg":(l==="mathml"||Pd(F))&&(l="mathml"),D?(y(e.dynamicChildren,D,B,s,i,l,u),Wu(e,t,!0)):d||g(e,t,B,q,s,i,l,u,!1),E)N?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):cr(t,o,R,p,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const P=t.target=ou(t.props,k);P&&cr(t,P,null,p,0)}else N&&cr(t,F,T,p,1);mr(t,E)}},remove(e,t,o,{um:a,o:{remove:s}},i){const{shapeFlag:l,children:u,anchor:d,targetStart:p,targetAnchor:f,target:g,props:y}=e;if(g&&(s(p),s(f)),i&&s(d),l&16){const _=i||!kl(y);for(let k=0;k<u.length;k++){const w=u[k];a(w,t,o,_,!!w.dynamicChildren)}}},move:cr,hydrate:dg};function cr(e,t,o,{o:{insert:a},m:s},i=2){i===0&&a(e.targetAnchor,t,o);const{el:l,anchor:u,shapeFlag:d,children:p,props:f}=e,g=i===2;if(g&&a(l,t,o),(!g||kl(f))&&d&16)for(let y=0;y<p.length;y++)s(p[y],t,o,2);g&&a(u,t,o)}function dg(e,t,o,a,s,i,{o:{nextSibling:l,parentNode:u,querySelector:d,insert:p,createText:f}},g){function y(w,S,E,A){S.anchor=g(l(w),S,u(w),o,a,s,i),S.targetStart=E,S.targetAnchor=A}const _=t.target=ou(t.props,d),k=kl(t.props);if(_){const w=_._lpa||_.firstChild;if(t.shapeFlag&16)if(k)y(e,t,w,w&&l(w));else{t.anchor=l(e);let S=w;for(;S;){if(S&&S.nodeType===8){if(S.data==="teleport start anchor")t.targetStart=S;else if(S.data==="teleport anchor"){t.targetAnchor=S,_._lpa=t.targetAnchor&&l(t.targetAnchor);break}}S=l(S)}t.targetAnchor||tp(_,t,f,p),g(w&&l(w),t,_,o,a,s,i)}mr(t,k)}else k&&t.shapeFlag&16&&y(e,t,e,l(e));return t.anchor&&l(t.anchor)}const Tl=ep;function mr(e,t){const o=e.ctx;if(o&&o.ut){let a,s;for(t?(a=e.el,s=e.anchor):(a=e.targetStart,s=e.targetAnchor);a&&a!==s;)a.nodeType===1&&a.setAttribute("data-v-owner",o.uid),a=a.nextSibling;o.ut()}}function tp(e,t,o,a){const s=t.targetStart=o(""),i=t.targetAnchor=o("");return s[Xf]=i,e&&(a(s,e),a(i,e)),i}const As=Symbol("_leaveCb"),ur=Symbol("_enterCb");function hg(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return nn(()=>{e.isMounted=!0}),dp(()=>{e.isUnmounting=!0}),e}const Ao=[Function,Array],np={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ao,onEnter:Ao,onAfterEnter:Ao,onEnterCancelled:Ao,onBeforeLeave:Ao,onLeave:Ao,onAfterLeave:Ao,onLeaveCancelled:Ao,onBeforeAppear:Ao,onAppear:Ao,onAfterAppear:Ao,onAppearCancelled:Ao},op=e=>{const t=e.subTree;return t.component?op(t.component):t},fg={name:"BaseTransition",props:np,setup(e,{slots:t}){const o=ac(),a=hg();return()=>{const s=t.default&&ip(t.default(),!0);if(!s||!s.length)return;const i=sp(s),l=Tt(e),{mode:u}=l;if(a.isLeaving)return Rc(i);const d=Dd(i);if(!d)return Rc(i);let p=su(d,l,a,o,g=>p=g);d.type!==Rn&&Ml(d,p);let f=o.subTree&&Dd(o.subTree);if(f&&f.type!==Rn&&!Ka(f,d)&&op(o).type!==Rn){let g=su(f,l,a,o);if(Ml(f,g),u==="out-in"&&d.type!==Rn)return a.isLeaving=!0,g.afterLeave=()=>{a.isLeaving=!1,o.job.flags&8||o.update(),delete g.afterLeave,f=void 0},Rc(i);u==="in-out"&&d.type!==Rn?g.delayLeave=(y,_,k)=>{const w=ap(a,f);w[String(f.key)]=f,y[As]=()=>{_(),y[As]=void 0,delete p.delayedLeave,f=void 0},p.delayedLeave=()=>{k(),delete p.delayedLeave,f=void 0}}:f=void 0}else f&&(f=void 0);return i}}};function sp(e){let t=e[0];if(e.length>1){for(const o of e)if(o.type!==Rn){t=o;break}}return t}const pg=fg;function ap(e,t){const{leavingVNodes:o}=e;let a=o.get(t.type);return a||(a=Object.create(null),o.set(t.type,a)),a}function su(e,t,o,a,s){const{appear:i,mode:l,persisted:u=!1,onBeforeEnter:d,onEnter:p,onAfterEnter:f,onEnterCancelled:g,onBeforeLeave:y,onLeave:_,onAfterLeave:k,onLeaveCancelled:w,onBeforeAppear:S,onAppear:E,onAfterAppear:A,onAppearCancelled:x}=t,D=String(e.key),R=ap(o,e),F=(B,q)=>{B&&os(B,a,9,q)},T=(B,q)=>{const P=q[1];F(B,q),it(B)?B.every(G=>G.length<=1)&&P():B.length<=1&&P()},N={mode:l,persisted:u,beforeEnter(B){let q=d;if(!o.isMounted)if(i)q=S||d;else return;B[As]&&B[As](!0);const P=R[D];P&&Ka(e,P)&&P.el[As]&&P.el[As](),F(q,[B])},enter(B){let q=p,P=f,G=g;if(!o.isMounted)if(i)q=E||p,P=A||f,G=x||g;else return;let X=!1;const ne=B[ur]=K=>{X||(X=!0,K?F(G,[B]):F(P,[B]),N.delayedLeave&&N.delayedLeave(),B[ur]=void 0)};q?T(q,[B,ne]):ne()},leave(B,q){const P=String(e.key);if(B[ur]&&B[ur](!0),o.isUnmounting)return q();F(y,[B]);let G=!1;const X=B[As]=ne=>{G||(G=!0,q(),ne?F(w,[B]):F(k,[B]),B[As]=void 0,R[P]===e&&delete R[P])};R[P]=e,_?T(_,[B,X]):X()},clone(B){const q=su(B,t,o,a,s);return s&&s(q),q}};return N}function Rc(e){if(tc(e))return e=La(e),e.children=null,e}function Dd(e){if(!tc(e))return Qf(e.type)&&e.children?sp(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:o}=e;if(o){if(t&16)return o[0];if(t&32&&dt(o.default))return o.default()}}function Ml(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Ml(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function ip(e,t=!1,o){let a=[],s=0;for(let i=0;i<e.length;i++){let l=e[i];const u=o==null?l.key:String(o)+String(l.key!=null?l.key:i);l.type===xe?(l.patchFlag&128&&s++,a=a.concat(ip(l.children,t,u))):(t||l.type!==Rn)&&a.push(u!=null?La(l,{key:u}):l)}if(s>1)for(let i=0;i<a.length;i++)a[i].patchFlag=-2;return a}function lp(e,t){return dt(e)?hn({name:e.name},t,{setup:e}):e}function rp(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const Tr=new WeakMap;function _l(e,t,o,a,s=!1){if(it(e)){e.forEach((k,w)=>_l(k,t&&(it(t)?t[w]:t),o,a,s));return}if(Ri(a)&&!s){a.shapeFlag&512&&a.type.__asyncResolved&&a.component.subTree.component&&_l(e,t,o,a.component.subTree);return}const i=a.shapeFlag&4?ic(a.component):a.el,l=s?null:i,{i:u,r:d}=e,p=t&&t.r,f=u.refs===Bt?u.refs={}:u.refs,g=u.setupState,y=Tt(g),_=g===Bt?mf:k=>Dt(y,k);if(p!=null&&p!==d){if(Rd(t),Xt(p))f[p]=null,_(p)&&(g[p]=null);else if(Yt(p)){p.value=null;const k=t;k.k&&(f[k.k]=null)}}if(dt(d))Ul(d,u,12,[l,f]);else{const k=Xt(d),w=Yt(d);if(k||w){const S=()=>{if(e.f){const E=k?_(d)?g[d]:f[d]:d.value;if(s)it(E)&&Ru(E,i);else if(it(E))E.includes(i)||E.push(i);else if(k)f[d]=[i],_(d)&&(g[d]=f[d]);else{const A=[i];d.value=A,e.k&&(f[e.k]=A)}}else k?(f[d]=l,_(d)&&(g[d]=l)):w&&(d.value=l,e.k&&(f[e.k]=l))};if(l){const E=()=>{S(),Tr.delete(e)};E.id=-1,Tr.set(e,E),Wn(E,o)}else Rd(e),S()}}}function Rd(e){const t=Tr.get(e);t&&(t.flags|=8,Tr.delete(e))}Yr().requestIdleCallback;Yr().cancelIdleCallback;const Ri=e=>!!e.type.__asyncLoader,tc=e=>e.type.__isKeepAlive;function vg(e,t){cp(e,"a",t)}function mg(e,t){cp(e,"da",t)}function cp(e,t,o=On){const a=e.__wdc||(e.__wdc=()=>{let s=o;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(nc(t,a,o),o){let s=o.parent;for(;s&&s.parent;)tc(s.parent.vnode)&&gg(a,t,o,s),s=s.parent}}function gg(e,t,o,a){const s=nc(t,e,a,!0);xn(()=>{Ru(a[t],s)},o)}function nc(e,t,o=On,a=!1){if(o){const s=o[e]||(o[e]=[]),i=t.__weh||(t.__weh=(...l)=>{Us();const u=zl(o),d=os(t,o,e,l);return u(),zs(),d});return a?s.unshift(i):s.push(i),i}}const Gs=e=>(t,o=On)=>{(!Pl||e==="sp")&&nc(e,(...a)=>t(...a),o)},yg=Gs("bm"),nn=Gs("m"),up=Gs("bu"),kg=Gs("u"),dp=Gs("bum"),xn=Gs("um"),_g=Gs("sp"),bg=Gs("rtg"),wg=Gs("rtc");function Cg(e,t=On){nc("ec",e,t)}const hp="components";function ju(e,t){return pp(hp,e,!0,t)||e}const fp=Symbol.for("v-ndc");function Lg(e){return Xt(e)?pp(hp,e,!1)||e:e||fp}function pp(e,t,o=!0,a=!1){const s=Sn||On;if(s){const i=s.type;{const u=ly(i,!1);if(u&&(u===t||u===Po(t)||u===Kr(Po(t))))return i}const l=Od(s[e]||i[e],t)||Od(s.appContext[e],t);return!l&&a?i:l}}function Od(e,t){return e&&(e[t]||e[Po(t)]||e[Kr(Po(t))])}function Ne(e,t,o,a){let s;const i=o,l=it(e);if(l||Xt(e)){const u=l&&Fs(e);let d=!1,p=!1;u&&(d=!wo(e),p=Hs(e),e=Xr(e)),s=new Array(e.length);for(let f=0,g=e.length;f<g;f++)s[f]=t(d?p?Bi(ns(e[f])):ns(e[f]):e[f],f,void 0,i)}else if(typeof e=="number"){s=new Array(e);for(let u=0;u<e;u++)s[u]=t(u+1,u,void 0,i)}else if(Ot(e))if(e[Symbol.iterator])s=Array.from(e,(u,d)=>t(u,d,void 0,i));else{const u=Object.keys(e);s=new Array(u.length);for(let d=0,p=u.length;d<p;d++){const f=u[d];s[d]=t(e[f],f,d,i)}}else s=[];return s}function vp(e,t){for(let o=0;o<t.length;o++){const a=t[o];if(it(a))for(let s=0;s<a.length;s++)e[a[s].name]=a[s].fn;else a&&(e[a.name]=a.key?(...s)=>{const i=a.fn(...s);return i&&(i.key=a.key),i}:a.fn)}return e}function io(e,t,o={},a,s){if(Sn.ce||Sn.parent&&Ri(Sn.parent)&&Sn.parent.ce){const p=Object.keys(o).length>0;return t!=="default"&&(o.name=t),v(),We(xe,null,[Ae("slot",o,a&&a())],p?-2:64)}let i=e[t];i&&i._c&&(i._d=!1),v();const l=i&&mp(i(o)),u=o.key||l&&l.key,d=We(xe,{key:(u&&!ts(u)?u:`_${t}`)+(!l&&a?"_fb":"")},l||(a?a():[]),l&&e._===1?64:-2);return i&&i._c&&(i._d=!0),d}function mp(e){return e.some(t=>El(t)?!(t.type===Rn||t.type===xe&&!mp(t.children)):!0)?e:null}const au=e=>e?Rp(e)?ic(e):au(e.parent):null,bl=hn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>au(e.parent),$root:e=>au(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>yp(e),$forceUpdate:e=>e.f||(e.f=()=>{Gu(e.update)}),$nextTick:e=>e.n||(e.n=cn.bind(e.proxy)),$watch:e=>ug.bind(e)}),Oc=(e,t)=>e!==Bt&&!e.__isScriptSetup&&Dt(e,t),Sg={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:o,setupState:a,data:s,props:i,accessCache:l,type:u,appContext:d}=e;if(t[0]!=="$"){const y=l[t];if(y!==void 0)switch(y){case 1:return a[t];case 2:return s[t];case 4:return o[t];case 3:return i[t]}else{if(Oc(a,t))return l[t]=1,a[t];if(s!==Bt&&Dt(s,t))return l[t]=2,s[t];if(Dt(i,t))return l[t]=3,i[t];if(o!==Bt&&Dt(o,t))return l[t]=4,o[t];iu&&(l[t]=0)}}const p=bl[t];let f,g;if(p)return t==="$attrs"&&Dn(e.attrs,"get",""),p(e);if((f=u.__cssModules)&&(f=f[t]))return f;if(o!==Bt&&Dt(o,t))return l[t]=4,o[t];if(g=d.config.globalProperties,Dt(g,t))return g[t]},set({_:e},t,o){const{data:a,setupState:s,ctx:i}=e;return Oc(s,t)?(s[t]=o,!0):a!==Bt&&Dt(a,t)?(a[t]=o,!0):Dt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=o,!0)},has({_:{data:e,setupState:t,accessCache:o,ctx:a,appContext:s,props:i,type:l}},u){let d;return!!(o[u]||e!==Bt&&u[0]!=="$"&&Dt(e,u)||Oc(t,u)||Dt(i,u)||Dt(a,u)||Dt(bl,u)||Dt(s.config.globalProperties,u)||(d=l.__cssModules)&&d[u])},defineProperty(e,t,o){return o.get!=null?e._.accessCache[t]=0:Dt(o,"value")&&this.set(e,t,o.value,null),Reflect.defineProperty(e,t,o)}};function Bd(e){return it(e)?e.reduce((t,o)=>(t[o]=null,t),{}):e}let iu=!0;function xg(e){const t=yp(e),o=e.proxy,a=e.ctx;iu=!1,t.beforeCreate&&Nd(t.beforeCreate,e,"bc");const{data:s,computed:i,methods:l,watch:u,provide:d,inject:p,created:f,beforeMount:g,mounted:y,beforeUpdate:_,updated:k,activated:w,deactivated:S,beforeDestroy:E,beforeUnmount:A,destroyed:x,unmounted:D,render:R,renderTracked:F,renderTriggered:T,errorCaptured:N,serverPrefetch:B,expose:q,inheritAttrs:P,components:G,directives:X,filters:ne}=t;if(p&&Ig(p,a,null),l)for(const he in l){const U=l[he];dt(U)&&(a[he]=U.bind(o))}if(s){const he=s.call(o,o);Ot(he)&&(e.data=ii(he))}if(iu=!0,i)for(const he in i){const U=i[he],ee=dt(U)?U.bind(o,o):dt(U.get)?U.get.bind(o,o):Qo,fe=!dt(U)&&dt(U.set)?U.set.bind(o):Qo,ue=V({get:ee,set:fe});Object.defineProperty(a,he,{enumerable:!0,configurable:!0,get:()=>ue.value,set:De=>ue.value=De})}if(u)for(const he in u)gp(u[he],a,o,he);if(d){const he=dt(d)?d.call(o):d;Reflect.ownKeys(he).forEach(U=>{yl(U,he[U])})}f&&Nd(f,e,"c");function Q(he,U){it(U)?U.forEach(ee=>he(ee.bind(o))):U&&he(U.bind(o))}if(Q(yg,g),Q(nn,y),Q(up,_),Q(kg,k),Q(vg,w),Q(mg,S),Q(Cg,N),Q(wg,F),Q(bg,T),Q(dp,A),Q(xn,D),Q(_g,B),it(q))if(q.length){const he=e.exposed||(e.exposed={});q.forEach(U=>{Object.defineProperty(he,U,{get:()=>o[U],set:ee=>o[U]=ee,enumerable:!0})})}else e.exposed||(e.exposed={});R&&e.render===Qo&&(e.render=R),P!=null&&(e.inheritAttrs=P),G&&(e.components=G),X&&(e.directives=X),B&&rp(e)}function Ig(e,t,o=Qo){it(e)&&(e=lu(e));for(const a in e){const s=e[a];let i;Ot(s)?"default"in s?i=lo(s.from||a,s.default,!0):i=lo(s.from||a):i=lo(s),Yt(i)?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>i.value,set:l=>i.value=l}):t[a]=i}}function Nd(e,t,o){os(it(e)?e.map(a=>a.bind(t.proxy)):e.bind(t.proxy),t,o)}function gp(e,t,o,a){let s=a.includes(".")?Yf(o,a):()=>o[a];if(Xt(e)){const i=t[e];dt(i)&&qe(s,i)}else if(dt(e))qe(s,e.bind(o));else if(Ot(e))if(it(e))e.forEach(i=>gp(i,t,o,a));else{const i=dt(e.handler)?e.handler.bind(o):t[e.handler];dt(i)&&qe(s,i,e)}}function yp(e){const t=e.type,{mixins:o,extends:a}=t,{mixins:s,optionsCache:i,config:{optionMergeStrategies:l}}=e.appContext,u=i.get(t);let d;return u?d=u:!s.length&&!o&&!a?d=t:(d={},s.length&&s.forEach(p=>Mr(d,p,l,!0)),Mr(d,t,l)),Ot(t)&&i.set(t,d),d}function Mr(e,t,o,a=!1){const{mixins:s,extends:i}=t;i&&Mr(e,i,o,!0),s&&s.forEach(l=>Mr(e,l,o,!0));for(const l in t)if(!(a&&l==="expose")){const u=$g[l]||o&&o[l];e[l]=u?u(e[l],t[l]):t[l]}return e}const $g={data:Fd,props:Ud,emits:Ud,methods:ul,computed:ul,beforeCreate:qn,created:qn,beforeMount:qn,mounted:qn,beforeUpdate:qn,updated:qn,beforeDestroy:qn,beforeUnmount:qn,destroyed:qn,unmounted:qn,activated:qn,deactivated:qn,errorCaptured:qn,serverPrefetch:qn,components:ul,directives:ul,watch:Mg,provide:Fd,inject:Tg};function Fd(e,t){return t?e?function(){return hn(dt(e)?e.call(this,this):e,dt(t)?t.call(this,this):t)}:t:e}function Tg(e,t){return ul(lu(e),lu(t))}function lu(e){if(it(e)){const t={};for(let o=0;o<e.length;o++)t[e[o]]=e[o];return t}return e}function qn(e,t){return e?[...new Set([].concat(e,t))]:t}function ul(e,t){return e?hn(Object.create(null),e,t):t}function Ud(e,t){return e?it(e)&&it(t)?[...new Set([...e,...t])]:hn(Object.create(null),Bd(e),Bd(t??{})):t}function Mg(e,t){if(!e)return t;if(!t)return e;const o=hn(Object.create(null),e);for(const a in t)o[a]=qn(e[a],t[a]);return o}function kp(){return{app:null,config:{isNativeTag:mf,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ag=0;function Eg(e,t){return function(a,s=null){dt(a)||(a=hn({},a)),s!=null&&!Ot(s)&&(s=null);const i=kp(),l=new WeakSet,u=[];let d=!1;const p=i.app={_uid:Ag++,_component:a,_props:s,_container:null,_context:i,_instance:null,version:cy,get config(){return i.config},set config(f){},use(f,...g){return l.has(f)||(f&&dt(f.install)?(l.add(f),f.install(p,...g)):dt(f)&&(l.add(f),f(p,...g))),p},mixin(f){return i.mixins.includes(f)||i.mixins.push(f),p},component(f,g){return g?(i.components[f]=g,p):i.components[f]},directive(f,g){return g?(i.directives[f]=g,p):i.directives[f]},mount(f,g,y){if(!d){const _=p._ceVNode||Ae(a,s);return _.appContext=i,y===!0?y="svg":y===!1&&(y=void 0),e(_,f,y),d=!0,p._container=f,f.__vue_app__=p,ic(_.component)}},onUnmount(f){u.push(f)},unmount(){d&&(os(u,p._instance,16),e(null,p._container),delete p._container.__vue_app__)},provide(f,g){return i.provides[f]=g,p},runWithContext(f){const g=ti;ti=p;try{return f()}finally{ti=g}}};return p}}let ti=null;const Pg=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Po(t)}Modifiers`]||e[`${Ia(t)}Modifiers`];function Dg(e,t,...o){if(e.isUnmounted)return;const a=e.vnode.props||Bt;let s=o;const i=t.startsWith("update:"),l=i&&Pg(a,t.slice(7));l&&(l.trim&&(s=o.map(f=>Xt(f)?f.trim():f)),l.number&&(s=o.map(Jr)));let u,d=a[u=Mc(t)]||a[u=Mc(Po(t))];!d&&i&&(d=a[u=Mc(Ia(t))]),d&&os(d,e,6,s);const p=a[u+"Once"];if(p){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,os(p,e,6,s)}}const Rg=new WeakMap;function _p(e,t,o=!1){const a=o?Rg:t.emitsCache,s=a.get(e);if(s!==void 0)return s;const i=e.emits;let l={},u=!1;if(!dt(e)){const d=p=>{const f=_p(p,t,!0);f&&(u=!0,hn(l,f))};!o&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}return!i&&!u?(Ot(e)&&a.set(e,null),null):(it(i)?i.forEach(d=>l[d]=null):hn(l,i),Ot(e)&&a.set(e,l),l)}function oc(e,t){return!e||!Zr(t)?!1:(t=t.slice(2).replace(/Once$/,""),Dt(e,t[0].toLowerCase()+t.slice(1))||Dt(e,Ia(t))||Dt(e,t))}function zd(e){const{type:t,vnode:o,proxy:a,withProxy:s,propsOptions:[i],slots:l,attrs:u,emit:d,render:p,renderCache:f,props:g,data:y,setupState:_,ctx:k,inheritAttrs:w}=e,S=$r(e);let E,A;try{if(o.shapeFlag&4){const D=s||a,R=D;E=hs(p.call(R,D,f,g,_,y,k)),A=u}else{const D=t;E=hs(D.length>1?D(g,{attrs:u,slots:l,emit:d}):D(g,null)),A=t.props?u:Og(u)}}catch(D){Cl.length=0,ec(D,e,1),E=Ae(Rn)}let x=E;if(A&&w!==!1){const D=Object.keys(A),{shapeFlag:R}=x;D.length&&R&7&&(i&&D.some(Du)&&(A=Bg(A,i)),x=La(x,A,!1,!0))}return o.dirs&&(x=La(x,null,!1,!0),x.dirs=x.dirs?x.dirs.concat(o.dirs):o.dirs),o.transition&&Ml(x,o.transition),E=x,$r(S),E}const Og=e=>{let t;for(const o in e)(o==="class"||o==="style"||Zr(o))&&((t||(t={}))[o]=e[o]);return t},Bg=(e,t)=>{const o={};for(const a in e)(!Du(a)||!(a.slice(9)in t))&&(o[a]=e[a]);return o};function Ng(e,t,o){const{props:a,children:s,component:i}=e,{props:l,children:u,patchFlag:d}=t,p=i.emitsOptions;if(t.dirs||t.transition)return!0;if(o&&d>=0){if(d&1024)return!0;if(d&16)return a?Hd(a,l,p):!!l;if(d&8){const f=t.dynamicProps;for(let g=0;g<f.length;g++){const y=f[g];if(l[y]!==a[y]&&!oc(p,y))return!0}}}else return(s||u)&&(!u||!u.$stable)?!0:a===l?!1:a?l?Hd(a,l,p):!0:!!l;return!1}function Hd(e,t,o){const a=Object.keys(t);if(a.length!==Object.keys(e).length)return!0;for(let s=0;s<a.length;s++){const i=a[s];if(t[i]!==e[i]&&!oc(o,i))return!0}return!1}function Fg({vnode:e,parent:t},o){for(;t;){const a=t.subTree;if(a.suspense&&a.suspense.activeBranch===e&&(a.el=e.el),a===e)(e=t.vnode).el=o,t=t.parent;else break}}const bp={},wp=()=>Object.create(bp),Cp=e=>Object.getPrototypeOf(e)===bp;function Ug(e,t,o,a=!1){const s={},i=wp();e.propsDefaults=Object.create(null),Lp(e,t,s,i);for(const l in e.propsOptions[0])l in s||(s[l]=void 0);o?e.props=a?s:zf(s):e.type.props?e.props=s:e.props=i,e.attrs=i}function zg(e,t,o,a){const{props:s,attrs:i,vnode:{patchFlag:l}}=e,u=Tt(s),[d]=e.propsOptions;let p=!1;if((a||l>0)&&!(l&16)){if(l&8){const f=e.vnode.dynamicProps;for(let g=0;g<f.length;g++){let y=f[g];if(oc(e.emitsOptions,y))continue;const _=t[y];if(d)if(Dt(i,y))_!==i[y]&&(i[y]=_,p=!0);else{const k=Po(y);s[k]=ru(d,u,k,_,e,!1)}else _!==i[y]&&(i[y]=_,p=!0)}}}else{Lp(e,t,s,i)&&(p=!0);let f;for(const g in u)(!t||!Dt(t,g)&&((f=Ia(g))===g||!Dt(t,f)))&&(d?o&&(o[g]!==void 0||o[f]!==void 0)&&(s[g]=ru(d,u,g,void 0,e,!0)):delete s[g]);if(i!==u)for(const g in i)(!t||!Dt(t,g))&&(delete i[g],p=!0)}p&&Ps(e.attrs,"set","")}function Lp(e,t,o,a){const[s,i]=e.propsOptions;let l=!1,u;if(t)for(let d in t){if(vl(d))continue;const p=t[d];let f;s&&Dt(s,f=Po(d))?!i||!i.includes(f)?o[f]=p:(u||(u={}))[f]=p:oc(e.emitsOptions,d)||(!(d in a)||p!==a[d])&&(a[d]=p,l=!0)}if(i){const d=Tt(o),p=u||Bt;for(let f=0;f<i.length;f++){const g=i[f];o[g]=ru(s,d,g,p[g],e,!Dt(p,g))}}return l}function ru(e,t,o,a,s,i){const l=e[o];if(l!=null){const u=Dt(l,"default");if(u&&a===void 0){const d=l.default;if(l.type!==Function&&!l.skipFactory&&dt(d)){const{propsDefaults:p}=s;if(o in p)a=p[o];else{const f=zl(s);a=p[o]=d.call(null,t),f()}}else a=d;s.ce&&s.ce._setProp(o,a)}l[0]&&(i&&!u?a=!1:l[1]&&(a===""||a===Ia(o))&&(a=!0))}return a}const Hg=new WeakMap;function Sp(e,t,o=!1){const a=o?Hg:t.propsCache,s=a.get(e);if(s)return s;const i=e.props,l={},u=[];let d=!1;if(!dt(e)){const f=g=>{d=!0;const[y,_]=Sp(g,t,!0);hn(l,y),_&&u.push(..._)};!o&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}if(!i&&!d)return Ot(e)&&a.set(e,Ei),Ei;if(it(i))for(let f=0;f<i.length;f++){const g=Po(i[f]);Vd(g)&&(l[g]=Bt)}else if(i)for(const f in i){const g=Po(f);if(Vd(g)){const y=i[f],_=l[g]=it(y)||dt(y)?{type:y}:hn({},y),k=_.type;let w=!1,S=!0;if(it(k))for(let E=0;E<k.length;++E){const A=k[E],x=dt(A)&&A.name;if(x==="Boolean"){w=!0;break}else x==="String"&&(S=!1)}else w=dt(k)&&k.name==="Boolean";_[0]=w,_[1]=S,(w||Dt(_,"default"))&&u.push(g)}}const p=[l,u];return Ot(e)&&a.set(e,p),p}function Vd(e){return e[0]!=="$"&&!vl(e)}const Zu=e=>e==="_"||e==="_ctx"||e==="$stable",qu=e=>it(e)?e.map(hs):[hs(e)],Vg=(e,t,o)=>{if(t._n)return t;const a=ze((...s)=>qu(t(...s)),o);return a._c=!1,a},xp=(e,t,o)=>{const a=e._ctx;for(const s in e){if(Zu(s))continue;const i=e[s];if(dt(i))t[s]=Vg(s,i,a);else if(i!=null){const l=qu(i);t[s]=()=>l}}},Ip=(e,t)=>{const o=qu(t);e.slots.default=()=>o},$p=(e,t,o)=>{for(const a in t)(o||!Zu(a))&&(e[a]=t[a])},Gg=(e,t,o)=>{const a=e.slots=wp();if(e.vnode.shapeFlag&32){const s=t._;s?($p(a,t,o),o&&_f(a,"_",s,!0)):xp(t,a)}else t&&Ip(e,t)},jg=(e,t,o)=>{const{vnode:a,slots:s}=e;let i=!0,l=Bt;if(a.shapeFlag&32){const u=t._;u?o&&u===1?i=!1:$p(s,t,o):(i=!t.$stable,xp(t,s)),l=t}else t&&(Ip(e,t),l={default:1});if(i)for(const u in s)!Zu(u)&&l[u]==null&&delete s[u]},Wn=Jg;function Zg(e){return qg(e)}function qg(e,t){const o=Yr();o.__VUE__=!0;const{insert:a,remove:s,patchProp:i,createElement:l,createText:u,createComment:d,setText:p,setElementText:f,parentNode:g,nextSibling:y,setScopeId:_=Qo,insertStaticContent:k}=e,w=(W,Y,pe,Ce=null,le=null,J=null,j=void 0,te=null,Re=!!Y.dynamicChildren)=>{if(W===Y)return;W&&!Ka(W,Y)&&(Ce=be(W),De(W,le,J,!0),W=null),Y.patchFlag===-2&&(Re=!1,Y.dynamicChildren=null);const{type:Se,ref:we,shapeFlag:ge}=Y;switch(Se){case sc:S(W,Y,pe,Ce);break;case Rn:E(W,Y,pe,Ce);break;case wl:W==null&&A(Y,pe,Ce,j);break;case xe:G(W,Y,pe,Ce,le,J,j,te,Re);break;default:ge&1?R(W,Y,pe,Ce,le,J,j,te,Re):ge&6?X(W,Y,pe,Ce,le,J,j,te,Re):(ge&64||ge&128)&&Se.process(W,Y,pe,Ce,le,J,j,te,Re,Le)}we!=null&&le?_l(we,W&&W.ref,J,Y||W,!Y):we==null&&W&&W.ref!=null&&_l(W.ref,null,J,W,!0)},S=(W,Y,pe,Ce)=>{if(W==null)a(Y.el=u(Y.children),pe,Ce);else{const le=Y.el=W.el;Y.children!==W.children&&p(le,Y.children)}},E=(W,Y,pe,Ce)=>{W==null?a(Y.el=d(Y.children||""),pe,Ce):Y.el=W.el},A=(W,Y,pe,Ce)=>{[W.el,W.anchor]=k(W.children,Y,pe,Ce,W.el,W.anchor)},x=({el:W,anchor:Y},pe,Ce)=>{let le;for(;W&&W!==Y;)le=y(W),a(W,pe,Ce),W=le;a(Y,pe,Ce)},D=({el:W,anchor:Y})=>{let pe;for(;W&&W!==Y;)pe=y(W),s(W),W=pe;s(Y)},R=(W,Y,pe,Ce,le,J,j,te,Re)=>{if(Y.type==="svg"?j="svg":Y.type==="math"&&(j="mathml"),W==null)F(Y,pe,Ce,le,J,j,te,Re);else{const Se=W.el&&W.el._isVueCE?W.el:null;try{Se&&Se._beginPatch(),B(W,Y,le,J,j,te,Re)}finally{Se&&Se._endPatch()}}},F=(W,Y,pe,Ce,le,J,j,te)=>{let Re,Se;const{props:we,shapeFlag:ge,transition:Z,dirs:se}=W;if(Re=W.el=l(W.type,J,we&&we.is,we),ge&8?f(Re,W.children):ge&16&&N(W.children,Re,null,Ce,le,Bc(W,J),j,te),se&&Va(W,null,Ce,"created"),T(Re,W,W.scopeId,j,Ce),we){for(const Te in we)Te!=="value"&&!vl(Te)&&i(Re,Te,null,we[Te],J,Ce);"value"in we&&i(Re,"value",null,we.value,J),(Se=we.onVnodeBeforeMount)&&cs(Se,Ce,W)}se&&Va(W,null,Ce,"beforeMount");const ce=Wg(le,Z);ce&&Z.beforeEnter(Re),a(Re,Y,pe),((Se=we&&we.onVnodeMounted)||ce||se)&&Wn(()=>{Se&&cs(Se,Ce,W),ce&&Z.enter(Re),se&&Va(W,null,Ce,"mounted")},le)},T=(W,Y,pe,Ce,le)=>{if(pe&&_(W,pe),Ce)for(let J=0;J<Ce.length;J++)_(W,Ce[J]);if(le){let J=le.subTree;if(Y===J||Ap(J.type)&&(J.ssContent===Y||J.ssFallback===Y)){const j=le.vnode;T(W,j,j.scopeId,j.slotScopeIds,le.parent)}}},N=(W,Y,pe,Ce,le,J,j,te,Re=0)=>{for(let Se=Re;Se<W.length;Se++){const we=W[Se]=te?ma(W[Se]):hs(W[Se]);w(null,we,Y,pe,Ce,le,J,j,te)}},B=(W,Y,pe,Ce,le,J,j)=>{const te=Y.el=W.el;let{patchFlag:Re,dynamicChildren:Se,dirs:we}=Y;Re|=W.patchFlag&16;const ge=W.props||Bt,Z=Y.props||Bt;let se;if(pe&&Ga(pe,!1),(se=Z.onVnodeBeforeUpdate)&&cs(se,pe,Y,W),we&&Va(Y,W,pe,"beforeUpdate"),pe&&Ga(pe,!0),(ge.innerHTML&&Z.innerHTML==null||ge.textContent&&Z.textContent==null)&&f(te,""),Se?q(W.dynamicChildren,Se,te,pe,Ce,Bc(Y,le),J):j||U(W,Y,te,null,pe,Ce,Bc(Y,le),J,!1),Re>0){if(Re&16)P(te,ge,Z,pe,le);else if(Re&2&&ge.class!==Z.class&&i(te,"class",null,Z.class,le),Re&4&&i(te,"style",ge.style,Z.style,le),Re&8){const ce=Y.dynamicProps;for(let Te=0;Te<ce.length;Te++){const Oe=ce[Te],Be=ge[Oe],Xe=Z[Oe];(Xe!==Be||Oe==="value")&&i(te,Oe,Be,Xe,le,pe)}}Re&1&&W.children!==Y.children&&f(te,Y.children)}else!j&&Se==null&&P(te,ge,Z,pe,le);((se=Z.onVnodeUpdated)||we)&&Wn(()=>{se&&cs(se,pe,Y,W),we&&Va(Y,W,pe,"updated")},Ce)},q=(W,Y,pe,Ce,le,J,j)=>{for(let te=0;te<Y.length;te++){const Re=W[te],Se=Y[te],we=Re.el&&(Re.type===xe||!Ka(Re,Se)||Re.shapeFlag&198)?g(Re.el):pe;w(Re,Se,we,null,Ce,le,J,j,!0)}},P=(W,Y,pe,Ce,le)=>{if(Y!==pe){if(Y!==Bt)for(const J in Y)!vl(J)&&!(J in pe)&&i(W,J,Y[J],null,le,Ce);for(const J in pe){if(vl(J))continue;const j=pe[J],te=Y[J];j!==te&&J!=="value"&&i(W,J,te,j,le,Ce)}"value"in pe&&i(W,"value",Y.value,pe.value,le)}},G=(W,Y,pe,Ce,le,J,j,te,Re)=>{const Se=Y.el=W?W.el:u(""),we=Y.anchor=W?W.anchor:u("");let{patchFlag:ge,dynamicChildren:Z,slotScopeIds:se}=Y;se&&(te=te?te.concat(se):se),W==null?(a(Se,pe,Ce),a(we,pe,Ce),N(Y.children||[],pe,we,le,J,j,te,Re)):ge>0&&ge&64&&Z&&W.dynamicChildren&&W.dynamicChildren.length===Z.length?(q(W.dynamicChildren,Z,pe,le,J,j,te),(Y.key!=null||le&&Y===le.subTree)&&Wu(W,Y,!0)):U(W,Y,pe,we,le,J,j,te,Re)},X=(W,Y,pe,Ce,le,J,j,te,Re)=>{Y.slotScopeIds=te,W==null?Y.shapeFlag&512?le.ctx.activate(Y,pe,Ce,j,Re):ne(Y,pe,Ce,le,J,j,Re):K(W,Y,Re)},ne=(W,Y,pe,Ce,le,J,j)=>{const te=W.component=ny(W,Ce,le);if(tc(W)&&(te.ctx.renderer=Le),oy(te,!1,j),te.asyncDep){if(le&&le.registerDep(te,Q,j),!W.el){const Re=te.subTree=Ae(Rn);E(null,Re,Y,pe),W.placeholder=Re.el}}else Q(te,W,Y,pe,le,J,j)},K=(W,Y,pe)=>{const Ce=Y.component=W.component;if(Ng(W,Y,pe))if(Ce.asyncDep&&!Ce.asyncResolved){he(Ce,Y,pe);return}else Ce.next=Y,Ce.update();else Y.el=W.el,Ce.vnode=Y},Q=(W,Y,pe,Ce,le,J,j)=>{const te=()=>{if(W.isMounted){let{next:ge,bu:Z,u:se,parent:ce,vnode:Te}=W;{const _t=Tp(W);if(_t){ge&&(ge.el=Te.el,he(W,ge,j)),_t.asyncDep.then(()=>{W.isUnmounted||te()});return}}let Oe=ge,Be;Ga(W,!1),ge?(ge.el=Te.el,he(W,ge,j)):ge=Te,Z&&vr(Z),(Be=ge.props&&ge.props.onVnodeBeforeUpdate)&&cs(Be,ce,ge,Te),Ga(W,!0);const Xe=zd(W),mt=W.subTree;W.subTree=Xe,w(mt,Xe,g(mt.el),be(mt),W,le,J),ge.el=Xe.el,Oe===null&&Fg(W,Xe.el),se&&Wn(se,le),(Be=ge.props&&ge.props.onVnodeUpdated)&&Wn(()=>cs(Be,ce,ge,Te),le)}else{let ge;const{el:Z,props:se}=Y,{bm:ce,m:Te,parent:Oe,root:Be,type:Xe}=W,mt=Ri(Y);Ga(W,!1),ce&&vr(ce),!mt&&(ge=se&&se.onVnodeBeforeMount)&&cs(ge,Oe,Y),Ga(W,!0);{Be.ce&&Be.ce._def.shadowRoot!==!1&&Be.ce._injectChildStyle(Xe);const _t=W.subTree=zd(W);w(null,_t,pe,Ce,W,le,J),Y.el=_t.el}if(Te&&Wn(Te,le),!mt&&(ge=se&&se.onVnodeMounted)){const _t=Y;Wn(()=>cs(ge,Oe,_t),le)}(Y.shapeFlag&256||Oe&&Ri(Oe.vnode)&&Oe.vnode.shapeFlag&256)&&W.a&&Wn(W.a,le),W.isMounted=!0,Y=pe=Ce=null}};W.scope.on();const Re=W.effect=new If(te);W.scope.off();const Se=W.update=Re.run.bind(Re),we=W.job=Re.runIfDirty.bind(Re);we.i=W,we.id=W.uid,Re.scheduler=()=>Gu(we),Ga(W,!0),Se()},he=(W,Y,pe)=>{Y.component=W;const Ce=W.vnode.props;W.vnode=Y,W.next=null,zg(W,Y.props,Ce,pe),jg(W,Y.children,pe),Us(),Md(W),zs()},U=(W,Y,pe,Ce,le,J,j,te,Re=!1)=>{const Se=W&&W.children,we=W?W.shapeFlag:0,ge=Y.children,{patchFlag:Z,shapeFlag:se}=Y;if(Z>0){if(Z&128){fe(Se,ge,pe,Ce,le,J,j,te,Re);return}else if(Z&256){ee(Se,ge,pe,Ce,le,J,j,te,Re);return}}se&8?(we&16&&He(Se,le,J),ge!==Se&&f(pe,ge)):we&16?se&16?fe(Se,ge,pe,Ce,le,J,j,te,Re):He(Se,le,J,!0):(we&8&&f(pe,""),se&16&&N(ge,pe,Ce,le,J,j,te,Re))},ee=(W,Y,pe,Ce,le,J,j,te,Re)=>{W=W||Ei,Y=Y||Ei;const Se=W.length,we=Y.length,ge=Math.min(Se,we);let Z;for(Z=0;Z<ge;Z++){const se=Y[Z]=Re?ma(Y[Z]):hs(Y[Z]);w(W[Z],se,pe,null,le,J,j,te,Re)}Se>we?He(W,le,J,!0,!1,ge):N(Y,pe,Ce,le,J,j,te,Re,ge)},fe=(W,Y,pe,Ce,le,J,j,te,Re)=>{let Se=0;const we=Y.length;let ge=W.length-1,Z=we-1;for(;Se<=ge&&Se<=Z;){const se=W[Se],ce=Y[Se]=Re?ma(Y[Se]):hs(Y[Se]);if(Ka(se,ce))w(se,ce,pe,null,le,J,j,te,Re);else break;Se++}for(;Se<=ge&&Se<=Z;){const se=W[ge],ce=Y[Z]=Re?ma(Y[Z]):hs(Y[Z]);if(Ka(se,ce))w(se,ce,pe,null,le,J,j,te,Re);else break;ge--,Z--}if(Se>ge){if(Se<=Z){const se=Z+1,ce=se<we?Y[se].el:Ce;for(;Se<=Z;)w(null,Y[Se]=Re?ma(Y[Se]):hs(Y[Se]),pe,ce,le,J,j,te,Re),Se++}}else if(Se>Z)for(;Se<=ge;)De(W[Se],le,J,!0),Se++;else{const se=Se,ce=Se,Te=new Map;for(Se=ce;Se<=Z;Se++){const wt=Y[Se]=Re?ma(Y[Se]):hs(Y[Se]);wt.key!=null&&Te.set(wt.key,Se)}let Oe,Be=0;const Xe=Z-ce+1;let mt=!1,_t=0;const bt=new Array(Xe);for(Se=0;Se<Xe;Se++)bt[Se]=0;for(Se=se;Se<=ge;Se++){const wt=W[Se];if(Be>=Xe){De(wt,le,J,!0);continue}let Nt;if(wt.key!=null)Nt=Te.get(wt.key);else for(Oe=ce;Oe<=Z;Oe++)if(bt[Oe-ce]===0&&Ka(wt,Y[Oe])){Nt=Oe;break}Nt===void 0?De(wt,le,J,!0):(bt[Nt-ce]=Se+1,Nt>=_t?_t=Nt:mt=!0,w(wt,Y[Nt],pe,null,le,J,j,te,Re),Be++)}const Mt=mt?Kg(bt):Ei;for(Oe=Mt.length-1,Se=Xe-1;Se>=0;Se--){const wt=ce+Se,Nt=Y[wt],Ft=Y[wt+1],Fn=wt+1<we?Ft.el||Mp(Ft):Ce;bt[Se]===0?w(null,Nt,pe,Fn,le,J,j,te,Re):mt&&(Oe<0||Se!==Mt[Oe]?ue(Nt,pe,Fn,2):Oe--)}}},ue=(W,Y,pe,Ce,le=null)=>{const{el:J,type:j,transition:te,children:Re,shapeFlag:Se}=W;if(Se&6){ue(W.component.subTree,Y,pe,Ce);return}if(Se&128){W.suspense.move(Y,pe,Ce);return}if(Se&64){j.move(W,Y,pe,Le);return}if(j===xe){a(J,Y,pe);for(let ge=0;ge<Re.length;ge++)ue(Re[ge],Y,pe,Ce);a(W.anchor,Y,pe);return}if(j===wl){x(W,Y,pe);return}if(Ce!==2&&Se&1&&te)if(Ce===0)te.beforeEnter(J),a(J,Y,pe),Wn(()=>te.enter(J),le);else{const{leave:ge,delayLeave:Z,afterLeave:se}=te,ce=()=>{W.ctx.isUnmounted?s(J):a(J,Y,pe)},Te=()=>{J._isLeaving&&J[As](!0),ge(J,()=>{ce(),se&&se()})};Z?Z(J,ce,Te):Te()}else a(J,Y,pe)},De=(W,Y,pe,Ce=!1,le=!1)=>{const{type:J,props:j,ref:te,children:Re,dynamicChildren:Se,shapeFlag:we,patchFlag:ge,dirs:Z,cacheIndex:se}=W;if(ge===-2&&(le=!1),te!=null&&(Us(),_l(te,null,pe,W,!0),zs()),se!=null&&(Y.renderCache[se]=void 0),we&256){Y.ctx.deactivate(W);return}const ce=we&1&&Z,Te=!Ri(W);let Oe;if(Te&&(Oe=j&&j.onVnodeBeforeUnmount)&&cs(Oe,Y,W),we&6)Ze(W.component,pe,Ce);else{if(we&128){W.suspense.unmount(pe,Ce);return}ce&&Va(W,null,Y,"beforeUnmount"),we&64?W.type.remove(W,Y,pe,Le,Ce):Se&&!Se.hasOnce&&(J!==xe||ge>0&&ge&64)?He(Se,Y,pe,!1,!0):(J===xe&&ge&384||!le&&we&16)&&He(Re,Y,pe),Ce&&et(W)}(Te&&(Oe=j&&j.onVnodeUnmounted)||ce)&&Wn(()=>{Oe&&cs(Oe,Y,W),ce&&Va(W,null,Y,"unmounted")},pe)},et=W=>{const{type:Y,el:pe,anchor:Ce,transition:le}=W;if(Y===xe){Je(pe,Ce);return}if(Y===wl){D(W);return}const J=()=>{s(pe),le&&!le.persisted&&le.afterLeave&&le.afterLeave()};if(W.shapeFlag&1&&le&&!le.persisted){const{leave:j,delayLeave:te}=le,Re=()=>j(pe,J);te?te(W.el,J,Re):Re()}else J()},Je=(W,Y)=>{let pe;for(;W!==Y;)pe=y(W),s(W),W=pe;s(Y)},Ze=(W,Y,pe)=>{const{bum:Ce,scope:le,job:J,subTree:j,um:te,m:Re,a:Se}=W;Gd(Re),Gd(Se),Ce&&vr(Ce),le.stop(),J&&(J.flags|=8,De(j,W,Y,pe)),te&&Wn(te,Y),Wn(()=>{W.isUnmounted=!0},Y)},He=(W,Y,pe,Ce=!1,le=!1,J=0)=>{for(let j=J;j<W.length;j++)De(W[j],Y,pe,Ce,le)},be=W=>{if(W.shapeFlag&6)return be(W.component.subTree);if(W.shapeFlag&128)return W.suspense.next();const Y=y(W.anchor||W.el),pe=Y&&Y[Xf];return pe?y(pe):Y};let Ve=!1;const ve=(W,Y,pe)=>{let Ce;W==null?Y._vnode&&(De(Y._vnode,null,null,!0),Ce=Y._vnode.component):w(Y._vnode||null,W,Y,null,null,null,pe),Y._vnode=W,Ve||(Ve=!0,Md(Ce),qf(),Ve=!1)},Le={p:w,um:De,m:ue,r:et,mt:ne,mc:N,pc:U,pbc:q,n:be,o:e};return{render:ve,hydrate:void 0,createApp:Eg(ve)}}function Bc({type:e,props:t},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:o}function Ga({effect:e,job:t},o){o?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Wg(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function Wu(e,t,o=!1){const a=e.children,s=t.children;if(it(a)&&it(s))for(let i=0;i<a.length;i++){const l=a[i];let u=s[i];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=s[i]=ma(s[i]),u.el=l.el),!o&&u.patchFlag!==-2&&Wu(l,u)),u.type===sc&&(u.patchFlag!==-1?u.el=l.el:u.__elIndex=i+(e.type===xe?1:0)),u.type===Rn&&!u.el&&(u.el=l.el)}}function Kg(e){const t=e.slice(),o=[0];let a,s,i,l,u;const d=e.length;for(a=0;a<d;a++){const p=e[a];if(p!==0){if(s=o[o.length-1],e[s]<p){t[a]=s,o.push(a);continue}for(i=0,l=o.length-1;i<l;)u=i+l>>1,e[o[u]]<p?i=u+1:l=u;p<e[o[i]]&&(i>0&&(t[a]=o[i-1]),o[i]=a)}}for(i=o.length,l=o[i-1];i-- >0;)o[i]=l,l=t[l];return o}function Tp(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Tp(t)}function Gd(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function Mp(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?Mp(t.subTree):null}const Ap=e=>e.__isSuspense;function Jg(e,t){t&&t.pendingBranch?it(e)?t.effects.push(...e):t.effects.push(e):Zf(e)}const xe=Symbol.for("v-fgt"),sc=Symbol.for("v-txt"),Rn=Symbol.for("v-cmt"),wl=Symbol.for("v-stc"),Cl=[];let bo=null;function v(e=!1){Cl.push(bo=e?null:[])}function Yg(){Cl.pop(),bo=Cl[Cl.length-1]||null}let Al=1;function Ar(e,t=!1){Al+=e,e<0&&bo&&t&&(bo.hasOnce=!0)}function Ep(e){return e.dynamicChildren=Al>0?bo||Ei:null,Yg(),Al>0&&bo&&bo.push(e),e}function m(e,t,o,a,s,i){return Ep(r(e,t,o,a,s,i,!0))}function We(e,t,o,a,s){return Ep(Ae(e,t,o,a,s,!0))}function El(e){return e?e.__v_isVNode===!0:!1}function Ka(e,t){return e.type===t.type&&e.key===t.key}const Pp=({key:e})=>e??null,gr=({ref:e,ref_key:t,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?Xt(e)||Yt(e)||dt(e)?{i:Sn,r:e,k:t,f:!!o}:e:null);function r(e,t=null,o=null,a=0,s=null,i=e===xe?0:1,l=!1,u=!1){const d={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Pp(t),ref:t&&gr(t),scopeId:Kf,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:a,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Sn};return u?(Ku(d,o),i&128&&e.normalize(d)):o&&(d.shapeFlag|=Xt(o)?8:16),Al>0&&!l&&bo&&(d.patchFlag>0||i&6)&&d.patchFlag!==32&&bo.push(d),d}const Ae=Xg;function Xg(e,t=null,o=null,a=0,s=null,i=!1){if((!e||e===fp)&&(e=Rn),El(e)){const u=La(e,t,!0);return o&&Ku(u,o),Al>0&&!i&&bo&&(u.shapeFlag&6?bo[bo.indexOf(e)]=u:bo.push(u)),u.patchFlag=-2,u}if(ry(e)&&(e=e.__vccOpts),t){t=Qg(t);let{class:u,style:d}=t;u&&!Xt(u)&&(t.class=de(u)),Ot(d)&&(Qr(d)&&!it(d)&&(d=hn({},d)),t.style=Qe(d))}const l=Xt(e)?1:Ap(e)?128:Qf(e)?64:Ot(e)?4:dt(e)?2:0;return r(e,t,o,a,s,l,i,!0)}function Qg(e){return e?Qr(e)||Cp(e)?hn({},e):e:null}function La(e,t,o=!1,a=!1){const{props:s,ref:i,patchFlag:l,children:u,transition:d}=e,p=t?Dp(s||{},t):s,f={__v_isVNode:!0,__v_skip:!0,type:e.type,props:p,key:p&&Pp(p),ref:t&&t.ref?o&&i?it(i)?i.concat(gr(t)):[i,gr(t)]:gr(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==xe?l===-1?16:l|16:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:d,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&La(e.ssContent),ssFallback:e.ssFallback&&La(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return d&&a&&Ml(f,d.clone(f)),f}function Ye(e=" ",t=0){return Ae(sc,null,e,t)}function Er(e,t){const o=Ae(wl,null,e);return o.staticCount=t,o}function M(e="",t=!1){return t?(v(),We(Rn,null,e)):Ae(Rn,null,e)}function hs(e){return e==null||typeof e=="boolean"?Ae(Rn):it(e)?Ae(xe,null,e.slice()):El(e)?ma(e):Ae(sc,null,String(e))}function ma(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:La(e)}function Ku(e,t){let o=0;const{shapeFlag:a}=e;if(t==null)t=null;else if(it(t))o=16;else if(typeof t=="object")if(a&65){const s=t.default;s&&(s._c&&(s._d=!1),Ku(e,s()),s._c&&(s._d=!0));return}else{o=32;const s=t._;!s&&!Cp(t)?t._ctx=Sn:s===3&&Sn&&(Sn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else dt(t)?(t={default:t,_ctx:Sn},o=32):(t=String(t),a&64?(o=16,t=[Ye(t)]):o=8);e.children=t,e.shapeFlag|=o}function Dp(...e){const t={};for(let o=0;o<e.length;o++){const a=e[o];for(const s in a)if(s==="class")t.class!==a.class&&(t.class=de([t.class,a.class]));else if(s==="style")t.style=Qe([t.style,a.style]);else if(Zr(s)){const i=t[s],l=a[s];l&&i!==l&&!(it(i)&&i.includes(l))&&(t[s]=i?[].concat(i,l):l)}else s!==""&&(t[s]=a[s])}return t}function cs(e,t,o,a=null){os(e,t,7,[o,a])}const ey=kp();let ty=0;function ny(e,t,o){const a=e.type,s=(t?t.appContext:e.appContext)||ey,i={uid:ty++,vnode:e,type:a,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Lf(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Sp(a,s),emitsOptions:_p(a,s),emit:null,emitted:null,propsDefaults:Bt,inheritAttrs:a.inheritAttrs,ctx:Bt,data:Bt,props:Bt,attrs:Bt,slots:Bt,refs:Bt,setupState:Bt,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=Dg.bind(null,i),e.ce&&e.ce(i),i}let On=null;const ac=()=>On||Sn;let Pr,cu;{const e=Yr(),t=(o,a)=>{let s;return(s=e[o])||(s=e[o]=[]),s.push(a),i=>{s.length>1?s.forEach(l=>l(i)):s[0](i)}};Pr=t("__VUE_INSTANCE_SETTERS__",o=>On=o),cu=t("__VUE_SSR_SETTERS__",o=>Pl=o)}const zl=e=>{const t=On;return Pr(e),e.scope.on(),()=>{e.scope.off(),Pr(t)}},jd=()=>{On&&On.scope.off(),Pr(null)};function Rp(e){return e.vnode.shapeFlag&4}let Pl=!1;function oy(e,t=!1,o=!1){t&&cu(t);const{props:a,children:s}=e.vnode,i=Rp(e);Ug(e,a,i,t),Gg(e,s,o||t);const l=i?sy(e,t):void 0;return t&&cu(!1),l}function sy(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Sg);const{setup:a}=o;if(a){Us();const s=e.setupContext=a.length>1?iy(e):null,i=zl(e),l=Ul(a,e,0,[e.props,s]),u=gf(l);if(zs(),i(),(u||e.sp)&&!Ri(e)&&rp(e),u){if(l.then(jd,jd),t)return l.then(d=>{Zd(e,d)}).catch(d=>{ec(d,e,0)});e.asyncDep=l}else Zd(e,l)}else Op(e)}function Zd(e,t,o){dt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Ot(t)&&(e.setupState=Vf(t)),Op(e)}function Op(e,t,o){const a=e.type;e.render||(e.render=a.render||Qo);{const s=zl(e);Us();try{xg(e)}finally{zs(),s()}}}const ay={get(e,t){return Dn(e,"get",""),e[t]}};function iy(e){const t=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,ay),slots:e.slots,emit:e.emit,expose:t}}function ic(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Vf(Vu(e.exposed)),{get(t,o){if(o in t)return t[o];if(o in bl)return bl[o](e)},has(t,o){return o in t||o in bl}})):e.proxy}function ly(e,t=!0){return dt(e)?e.displayName||e.name:e.name||t&&e.__name}function ry(e){return dt(e)&&"__vccOpts"in e}const V=(e,t)=>ng(e,t,Pl);function Ju(e,t,o){try{Ar(-1);const a=arguments.length;return a===2?Ot(t)&&!it(t)?El(t)?Ae(e,null,[t]):Ae(e,t):Ae(e,null,t):(a>3?o=Array.prototype.slice.call(arguments,2):a===3&&El(o)&&(o=[o]),Ae(e,t,o))}finally{Ar(1)}}const cy="3.5.26";let uu;const qd=typeof window<"u"&&window.trustedTypes;if(qd)try{uu=qd.createPolicy("vue",{createHTML:e=>e})}catch{}const Bp=uu?e=>uu.createHTML(e):e=>e,uy="http://www.w3.org/2000/svg",dy="http://www.w3.org/1998/Math/MathML",Ms=typeof document<"u"?document:null,Wd=Ms&&Ms.createElement("template"),hy={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,a)=>{const s=t==="svg"?Ms.createElementNS(uy,e):t==="mathml"?Ms.createElementNS(dy,e):o?Ms.createElement(e,{is:o}):Ms.createElement(e);return e==="select"&&a&&a.multiple!=null&&s.setAttribute("multiple",a.multiple),s},createText:e=>Ms.createTextNode(e),createComment:e=>Ms.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Ms.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,o,a,s,i){const l=o?o.previousSibling:t.lastChild;if(s&&(s===i||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),o),!(s===i||!(s=s.nextSibling)););else{Wd.innerHTML=Bp(a==="svg"?`<svg>${e}</svg>`:a==="mathml"?`<math>${e}</math>`:e);const u=Wd.content;if(a==="svg"||a==="mathml"){const d=u.firstChild;for(;d.firstChild;)u.appendChild(d.firstChild);u.removeChild(d)}t.insertBefore(u,o)}return[l?l.nextSibling:t.firstChild,o?o.previousSibling:t.lastChild]}},ua="transition",il="animation",Dl=Symbol("_vtc"),Np={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},fy=hn({},np,Np),py=e=>(e.displayName="Transition",e.props=fy,e),gs=py((e,{slots:t})=>Ju(pg,vy(e),t)),ja=(e,t=[])=>{it(e)?e.forEach(o=>o(...t)):e&&e(...t)},Kd=e=>e?it(e)?e.some(t=>t.length>1):e.length>1:!1;function vy(e){const t={};for(const G in e)G in Np||(t[G]=e[G]);if(e.css===!1)return t;const{name:o="v",type:a,duration:s,enterFromClass:i=`${o}-enter-from`,enterActiveClass:l=`${o}-enter-active`,enterToClass:u=`${o}-enter-to`,appearFromClass:d=i,appearActiveClass:p=l,appearToClass:f=u,leaveFromClass:g=`${o}-leave-from`,leaveActiveClass:y=`${o}-leave-active`,leaveToClass:_=`${o}-leave-to`}=e,k=my(s),w=k&&k[0],S=k&&k[1],{onBeforeEnter:E,onEnter:A,onEnterCancelled:x,onLeave:D,onLeaveCancelled:R,onBeforeAppear:F=E,onAppear:T=A,onAppearCancelled:N=x}=t,B=(G,X,ne,K)=>{G._enterCancelled=K,Za(G,X?f:u),Za(G,X?p:l),ne&&ne()},q=(G,X)=>{G._isLeaving=!1,Za(G,g),Za(G,_),Za(G,y),X&&X()},P=G=>(X,ne)=>{const K=G?T:A,Q=()=>B(X,G,ne);ja(K,[X,Q]),Jd(()=>{Za(X,G?d:i),$s(X,G?f:u),Kd(K)||Yd(X,a,w,Q)})};return hn(t,{onBeforeEnter(G){ja(E,[G]),$s(G,i),$s(G,l)},onBeforeAppear(G){ja(F,[G]),$s(G,d),$s(G,p)},onEnter:P(!1),onAppear:P(!0),onLeave(G,X){G._isLeaving=!0;const ne=()=>q(G,X);$s(G,g),G._enterCancelled?($s(G,y),eh(G)):(eh(G),$s(G,y)),Jd(()=>{G._isLeaving&&(Za(G,g),$s(G,_),Kd(D)||Yd(G,a,S,ne))}),ja(D,[G,ne])},onEnterCancelled(G){B(G,!1,void 0,!0),ja(x,[G])},onAppearCancelled(G){B(G,!0,void 0,!0),ja(N,[G])},onLeaveCancelled(G){q(G),ja(R,[G])}})}function my(e){if(e==null)return null;if(Ot(e))return[Nc(e.enter),Nc(e.leave)];{const t=Nc(e);return[t,t]}}function Nc(e){return _m(e)}function $s(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e[Dl]||(e[Dl]=new Set)).add(t)}function Za(e,t){t.split(/\s+/).forEach(a=>a&&e.classList.remove(a));const o=e[Dl];o&&(o.delete(t),o.size||(e[Dl]=void 0))}function Jd(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let gy=0;function Yd(e,t,o,a){const s=e._endId=++gy,i=()=>{s===e._endId&&a()};if(o!=null)return setTimeout(i,o);const{type:l,timeout:u,propCount:d}=yy(e,t);if(!l)return a();const p=l+"end";let f=0;const g=()=>{e.removeEventListener(p,y),i()},y=_=>{_.target===e&&++f>=d&&g()};setTimeout(()=>{f<d&&g()},u+1),e.addEventListener(p,y)}function yy(e,t){const o=window.getComputedStyle(e),a=k=>(o[k]||"").split(", "),s=a(`${ua}Delay`),i=a(`${ua}Duration`),l=Xd(s,i),u=a(`${il}Delay`),d=a(`${il}Duration`),p=Xd(u,d);let f=null,g=0,y=0;t===ua?l>0&&(f=ua,g=l,y=i.length):t===il?p>0&&(f=il,g=p,y=d.length):(g=Math.max(l,p),f=g>0?l>p?ua:il:null,y=f?f===ua?i.length:d.length:0);const _=f===ua&&/\b(?:transform|all)(?:,|$)/.test(a(`${ua}Property`).toString());return{type:f,timeout:g,propCount:y,hasTransform:_}}function Xd(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((o,a)=>Qd(o)+Qd(e[a])))}function Qd(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function eh(e){return(e?e.ownerDocument:document).body.offsetHeight}function ky(e,t,o){const a=e[Dl];a&&(t=(t?[t,...a]:[...a]).join(" ")),t==null?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}const Dr=Symbol("_vod"),Fp=Symbol("_vsh"),ys={name:"show",beforeMount(e,{value:t},{transition:o}){e[Dr]=e.style.display==="none"?"":e.style.display,o&&t?o.beforeEnter(e):ll(e,t)},mounted(e,{value:t},{transition:o}){o&&t&&o.enter(e)},updated(e,{value:t,oldValue:o},{transition:a}){!t!=!o&&(a?t?(a.beforeEnter(e),ll(e,!0),a.enter(e)):a.leave(e,()=>{ll(e,!1)}):ll(e,t))},beforeUnmount(e,{value:t}){ll(e,t)}};function ll(e,t){e.style.display=t?e[Dr]:"none",e[Fp]=!t}const Up=Symbol("");function _y(e){const t=ac();if(!t)return;const o=t.ut=(s=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(i=>Rr(i,s))},a=()=>{const s=e(t.proxy);t.ce?Rr(t.ce,s):du(t.subTree,s),o(s)};up(()=>{Zf(a)}),nn(()=>{qe(a,Qo,{flush:"post"});const s=new MutationObserver(a);s.observe(t.subTree.el.parentNode,{childList:!0}),xn(()=>s.disconnect())})}function du(e,t){if(e.shapeFlag&128){const o=e.suspense;e=o.activeBranch,o.pendingBranch&&!o.isHydrating&&o.effects.push(()=>{du(o.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)Rr(e.el,t);else if(e.type===xe)e.children.forEach(o=>du(o,t));else if(e.type===wl){let{el:o,anchor:a}=e;for(;o&&(Rr(o,t),o!==a);)o=o.nextSibling}}function Rr(e,t){if(e.nodeType===1){const o=e.style;let a="";for(const s in t){const i=$m(t[s]);o.setProperty(`--${s}`,i),a+=`--${s}: ${i};`}o[Up]=a}}const by=/(?:^|;)\s*display\s*:/;function wy(e,t,o){const a=e.style,s=Xt(o);let i=!1;if(o&&!s){if(t)if(Xt(t))for(const l of t.split(";")){const u=l.slice(0,l.indexOf(":")).trim();o[u]==null&&yr(a,u,"")}else for(const l in t)o[l]==null&&yr(a,l,"");for(const l in o)l==="display"&&(i=!0),yr(a,l,o[l])}else if(s){if(t!==o){const l=a[Up];l&&(o+=";"+l),a.cssText=o,i=by.test(o)}}else t&&e.removeAttribute("style");Dr in e&&(e[Dr]=i?a.display:"",e[Fp]&&(a.display="none"))}const th=/\s*!important$/;function yr(e,t,o){if(it(o))o.forEach(a=>yr(e,t,a));else if(o==null&&(o=""),t.startsWith("--"))e.setProperty(t,o);else{const a=Cy(e,t);th.test(o)?e.setProperty(Ia(a),o.replace(th,""),"important"):e[a]=o}}const nh=["Webkit","Moz","ms"],Fc={};function Cy(e,t){const o=Fc[t];if(o)return o;let a=Po(t);if(a!=="filter"&&a in e)return Fc[t]=a;a=Kr(a);for(let s=0;s<nh.length;s++){const i=nh[s]+a;if(i in e)return Fc[t]=i}return t}const oh="http://www.w3.org/1999/xlink";function sh(e,t,o,a,s,i=xm(t)){a&&t.startsWith("xlink:")?o==null?e.removeAttributeNS(oh,t.slice(6,t.length)):e.setAttributeNS(oh,t,o):o==null||i&&!bf(o)?e.removeAttribute(t):e.setAttribute(t,i?"":ts(o)?String(o):o)}function ah(e,t,o,a,s){if(t==="innerHTML"||t==="textContent"){o!=null&&(e[t]=t==="innerHTML"?Bp(o):o);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const u=i==="OPTION"?e.getAttribute("value")||"":e.value,d=o==null?e.type==="checkbox"?"on":"":String(o);(u!==d||!("_value"in e))&&(e.value=d),o==null&&e.removeAttribute(t),e._value=o;return}let l=!1;if(o===""||o==null){const u=typeof e[t];u==="boolean"?o=bf(o):o==null&&u==="string"?(o="",l=!0):u==="number"&&(o=0,l=!0)}try{e[t]=o}catch{}l&&e.removeAttribute(s||t)}function Rs(e,t,o,a){e.addEventListener(t,o,a)}function Ly(e,t,o,a){e.removeEventListener(t,o,a)}const ih=Symbol("_vei");function Sy(e,t,o,a,s=null){const i=e[ih]||(e[ih]={}),l=i[t];if(a&&l)l.value=a;else{const[u,d]=xy(t);if(a){const p=i[t]=Ty(a,s);Rs(e,u,p,d)}else l&&(Ly(e,u,l,d),i[t]=void 0)}}const lh=/(?:Once|Passive|Capture)$/;function xy(e){let t;if(lh.test(e)){t={};let a;for(;a=e.match(lh);)e=e.slice(0,e.length-a[0].length),t[a[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Ia(e.slice(2)),t]}let Uc=0;const Iy=Promise.resolve(),$y=()=>Uc||(Iy.then(()=>Uc=0),Uc=Date.now());function Ty(e,t){const o=a=>{if(!a._vts)a._vts=Date.now();else if(a._vts<=o.attached)return;os(My(a,o.value),t,5,[a])};return o.value=e,o.attached=$y(),o}function My(e,t){if(it(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map(a=>s=>!s._stopped&&a&&a(s))}else return t}const rh=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Ay=(e,t,o,a,s,i)=>{const l=s==="svg";t==="class"?ky(e,a,l):t==="style"?wy(e,o,a):Zr(t)?Du(t)||Sy(e,t,o,a,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Ey(e,t,a,l))?(ah(e,t,a),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&sh(e,t,a,l,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Xt(a))?ah(e,Po(t),a,i,t):(t==="true-value"?e._trueValue=a:t==="false-value"&&(e._falseValue=a),sh(e,t,a,l))};function Ey(e,t,o,a){if(a)return!!(t==="innerHTML"||t==="textContent"||t in e&&rh(t)&&dt(o));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return rh(t)&&Xt(o)?!1:t in e}const Sa=e=>{const t=e.props["onUpdate:modelValue"]||!1;return it(t)?o=>vr(t,o):t};function Py(e){e.target.composing=!0}function ch(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Eo=Symbol("_assign");function uh(e,t,o){return t&&(e=e.trim()),o&&(e=Jr(e)),e}const st={created(e,{modifiers:{lazy:t,trim:o,number:a}},s){e[Eo]=Sa(s);const i=a||s.props&&s.props.type==="number";Rs(e,t?"change":"input",l=>{l.target.composing||e[Eo](uh(e.value,o,i))}),(o||i)&&Rs(e,"change",()=>{e.value=uh(e.value,o,i)}),t||(Rs(e,"compositionstart",Py),Rs(e,"compositionend",ch),Rs(e,"change",ch))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:o,modifiers:{lazy:a,trim:s,number:i}},l){if(e[Eo]=Sa(l),e.composing)return;const u=(i||e.type==="number")&&!/^0\d/.test(e.value)?Jr(e.value):e.value,d=t??"";u!==d&&(document.activeElement===e&&e.type!=="range"&&(a&&t===o||s&&e.value.trim()===d)||(e.value=d))}},xa={deep:!0,created(e,t,o){e[Eo]=Sa(o),Rs(e,"change",()=>{const a=e._modelValue,s=Ni(e),i=e.checked,l=e[Eo];if(it(a)){const u=Ou(a,s),d=u!==-1;if(i&&!d)l(a.concat(s));else if(!i&&d){const p=[...a];p.splice(u,1),l(p)}}else if(Hi(a)){const u=new Set(a);i?u.add(s):u.delete(s),l(u)}else l(zp(e,i))})},mounted:dh,beforeUpdate(e,t,o){e[Eo]=Sa(o),dh(e,t,o)}};function dh(e,{value:t,oldValue:o},a){e._modelValue=t;let s;if(it(t))s=Ou(t,a.props.value)>-1;else if(Hi(t))s=t.has(a.props.value);else{if(t===o)return;s=si(t,zp(e,!0))}e.checked!==s&&(e.checked=s)}const hh={created(e,{value:t},o){e.checked=si(t,o.props.value),e[Eo]=Sa(o),Rs(e,"change",()=>{e[Eo](Ni(e))})},beforeUpdate(e,{value:t,oldValue:o},a){e[Eo]=Sa(a),t!==o&&(e.checked=si(t,a.props.value))}},Bn={deep:!0,created(e,{value:t,modifiers:{number:o}},a){const s=Hi(t);Rs(e,"change",()=>{const i=Array.prototype.filter.call(e.options,l=>l.selected).map(l=>o?Jr(Ni(l)):Ni(l));e[Eo](e.multiple?s?new Set(i):i:i[0]),e._assigning=!0,cn(()=>{e._assigning=!1})}),e[Eo]=Sa(a)},mounted(e,{value:t}){fh(e,t)},beforeUpdate(e,t,o){e[Eo]=Sa(o)},updated(e,{value:t}){e._assigning||fh(e,t)}};function fh(e,t){const o=e.multiple,a=it(t);if(!(o&&!a&&!Hi(t))){for(let s=0,i=e.options.length;s<i;s++){const l=e.options[s],u=Ni(l);if(o)if(a){const d=typeof u;d==="string"||d==="number"?l.selected=t.some(p=>String(p)===String(u)):l.selected=Ou(t,u)>-1}else l.selected=t.has(u);else if(si(Ni(l),t)){e.selectedIndex!==s&&(e.selectedIndex=s);return}}!o&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Ni(e){return"_value"in e?e._value:e.value}function zp(e,t){const o=t?"_trueValue":"_falseValue";return o in e?e[o]:t}const Dy=["ctrl","shift","alt","meta"],Ry={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Dy.some(o=>e[`${o}Key`]&&!t.includes(o))},rt=(e,t)=>{const o=e._withMods||(e._withMods={}),a=t.join(".");return o[a]||(o[a]=((s,...i)=>{for(let l=0;l<t.length;l++){const u=Ry[t[l]];if(u&&u(s,t))return}return e(s,...i)}))},Oy={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},ps=(e,t)=>{const o=e._withKeys||(e._withKeys={}),a=t.join(".");return o[a]||(o[a]=(s=>{if(!("key"in s))return;const i=Ia(s.key);if(t.some(l=>l===i||Oy[l]===i))return e(s)}))},By=hn({patchProp:Ay},hy);let ph;function Ny(){return ph||(ph=Zg(By))}const Fy=((...e)=>{const t=Ny().createApp(...e),{mount:o}=t;return t.mount=a=>{const s=zy(a);if(!s)return;const i=t._component;!dt(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const l=o(s,!1,Uy(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),l},t});function Uy(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function zy(e){return Xt(e)?document.querySelector(e):e}let Hp;const lc=e=>Hp=e,Vp=Symbol();function hu(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Ll;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Ll||(Ll={}));function Hy(){const e=Sf(!0),t=e.run(()=>$({}));let o=[],a=[];const s=Vu({install(i){lc(s),s._a=i,i.provide(Vp,s),i.config.globalProperties.$pinia=s,a.forEach(l=>o.push(l)),a=[]},use(i){return this._a?o.push(i):a.push(i),this},_p:o,_a:null,_e:e,_s:new Map,state:t});return s}const Gp=()=>{};function vh(e,t,o,a=Gp){e.add(t);const s=()=>{e.delete(t)&&a()};return!o&&xf()&&Tm(s),s}function xi(e,...t){e.forEach(o=>{o(...t)})}const Vy=e=>e(),mh=Symbol(),zc=Symbol();function fu(e,t){e instanceof Map&&t instanceof Map?t.forEach((o,a)=>e.set(a,o)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const o in t){if(!t.hasOwnProperty(o))continue;const a=t[o],s=e[o];hu(s)&&hu(a)&&e.hasOwnProperty(o)&&!Yt(a)&&!Fs(a)?e[o]=fu(s,a):e[o]=a}return e}const Gy=Symbol();function jy(e){return!hu(e)||!Object.prototype.hasOwnProperty.call(e,Gy)}const{assign:ha}=Object;function Zy(e){return!!(Yt(e)&&e.effect)}function qy(e,t,o,a){const{state:s,actions:i,getters:l}=t,u=o.state.value[e];let d;function p(){u||(o.state.value[e]=s?s():{});const f=Xm(o.state.value[e]);return ha(f,i,Object.keys(l||{}).reduce((g,y)=>(g[y]=Vu(V(()=>{lc(o);const _=o._s.get(e);return l[y].call(_,_)})),g),{}))}return d=jp(e,p,t,o,a,!0),d}function jp(e,t,o={},a,s,i){let l;const u=ha({actions:{}},o),d={deep:!0};let p,f,g=new Set,y=new Set,_;const k=a.state.value[e];!i&&!k&&(a.state.value[e]={}),$({});let w;function S(N){let B;p=f=!1,typeof N=="function"?(N(a.state.value[e]),B={type:Ll.patchFunction,storeId:e,events:_}):(fu(a.state.value[e],N),B={type:Ll.patchObject,payload:N,storeId:e,events:_});const q=w=Symbol();cn().then(()=>{w===q&&(p=!0)}),f=!0,xi(g,B,a.state.value[e])}const E=i?function(){const{state:B}=o,q=B?B():{};this.$patch(P=>{ha(P,q)})}:Gp;function A(){l.stop(),g.clear(),y.clear(),a._s.delete(e)}const x=(N,B="")=>{if(mh in N)return N[zc]=B,N;const q=function(){lc(a);const P=Array.from(arguments),G=new Set,X=new Set;function ne(he){G.add(he)}function K(he){X.add(he)}xi(y,{args:P,name:q[zc],store:R,after:ne,onError:K});let Q;try{Q=N.apply(this&&this.$id===e?this:R,P)}catch(he){throw xi(X,he),he}return Q instanceof Promise?Q.then(he=>(xi(G,he),he)).catch(he=>(xi(X,he),Promise.reject(he))):(xi(G,Q),Q)};return q[mh]=!0,q[zc]=B,q},D={_p:a,$id:e,$onAction:vh.bind(null,y),$patch:S,$reset:E,$subscribe(N,B={}){const q=vh(g,N,B.detached,()=>P()),P=l.run(()=>qe(()=>a.state.value[e],G=>{(B.flush==="sync"?f:p)&&N({storeId:e,type:Ll.direct,events:_},G)},ha({},d,B)));return q},$dispose:A},R=ii(D);a._s.set(e,R);const T=(a._a&&a._a.runWithContext||Vy)(()=>a._e.run(()=>(l=Sf()).run(()=>t({action:x}))));for(const N in T){const B=T[N];if(Yt(B)&&!Zy(B)||Fs(B))i||(k&&jy(B)&&(Yt(B)?B.value=k[N]:fu(B,k[N])),a.state.value[e][N]=B);else if(typeof B=="function"){const q=x(B,N);T[N]=q,u.actions[N]=B}}return ha(R,T),ha(Tt(R),T),Object.defineProperty(R,"$state",{get:()=>a.state.value[e],set:N=>{S(B=>{ha(B,N)})}}),a._p.forEach(N=>{ha(R,l.run(()=>N({store:R,app:a._a,pinia:a,options:u})))}),k&&i&&o.hydrate&&o.hydrate(R.$state,k),p=!0,f=!0,R}function Yu(e,t,o){let a;const s=typeof t=="function";a=s?o:t;function i(l,u){const d=lg();return l=l||(d?lo(Vp,null):null),l&&lc(l),l=Hp,l._s.has(e)||(s?jp(e,t,a,l):qy(e,a,l)),l._s.get(e)}return i.$id=e,i}const $i=typeof document<"u";function Zp(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Wy(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&Zp(e.default)}const Pt=Object.assign;function Hc(e,t){const o={};for(const a in t){const s=t[a];o[a]=ss(s)?s.map(e):e(s)}return o}const Sl=()=>{},ss=Array.isArray;function gh(e,t){const o={};for(const a in e)o[a]=a in t?t[a]:e[a];return o}const qp=/#/g,Ky=/&/g,Jy=/\//g,Yy=/=/g,Xy=/\?/g,Wp=/\+/g,Qy=/%5B/g,e1=/%5D/g,Kp=/%5E/g,t1=/%60/g,Jp=/%7B/g,n1=/%7C/g,Yp=/%7D/g,o1=/%20/g;function Xu(e){return e==null?"":encodeURI(""+e).replace(n1,"|").replace(Qy,"[").replace(e1,"]")}function s1(e){return Xu(e).replace(Jp,"{").replace(Yp,"}").replace(Kp,"^")}function pu(e){return Xu(e).replace(Wp,"%2B").replace(o1,"+").replace(qp,"%23").replace(Ky,"%26").replace(t1,"`").replace(Jp,"{").replace(Yp,"}").replace(Kp,"^")}function a1(e){return pu(e).replace(Yy,"%3D")}function i1(e){return Xu(e).replace(qp,"%23").replace(Xy,"%3F")}function l1(e){return i1(e).replace(Jy,"%2F")}function Rl(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const r1=/\/$/,c1=e=>e.replace(r1,"");function Vc(e,t,o="/"){let a,s={},i="",l="";const u=t.indexOf("#");let d=t.indexOf("?");return d=u>=0&&d>u?-1:d,d>=0&&(a=t.slice(0,d),i=t.slice(d,u>0?u:t.length),s=e(i.slice(1))),u>=0&&(a=a||t.slice(0,u),l=t.slice(u,t.length)),a=f1(a??t,o),{fullPath:a+i+l,path:a,query:s,hash:Rl(l)}}function u1(e,t){const o=t.query?e(t.query):"";return t.path+(o&&"?")+o+(t.hash||"")}function yh(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function d1(e,t,o){const a=t.matched.length-1,s=o.matched.length-1;return a>-1&&a===s&&Fi(t.matched[a],o.matched[s])&&Xp(t.params,o.params)&&e(t.query)===e(o.query)&&t.hash===o.hash}function Fi(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Xp(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var o in e)if(!h1(e[o],t[o]))return!1;return!0}function h1(e,t){return ss(e)?kh(e,t):ss(t)?kh(t,e):e?.valueOf()===t?.valueOf()}function kh(e,t){return ss(t)?e.length===t.length&&e.every((o,a)=>o===t[a]):e.length===1&&e[0]===t}function f1(e,t){if(e.startsWith("/"))return e;if(!e)return t;const o=t.split("/"),a=e.split("/"),s=a[a.length-1];(s===".."||s===".")&&a.push("");let i=o.length-1,l,u;for(l=0;l<a.length;l++)if(u=a[l],u!==".")if(u==="..")i>1&&i--;else break;return o.slice(0,i).join("/")+"/"+a.slice(l).join("/")}const da={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let vu=(function(e){return e.pop="pop",e.push="push",e})({}),Gc=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function p1(e){if(!e)if($i){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),c1(e)}const v1=/^[^#]+#/;function m1(e,t){return e.replace(v1,"#")+t}function g1(e,t){const o=document.documentElement.getBoundingClientRect(),a=e.getBoundingClientRect();return{behavior:t.behavior,left:a.left-o.left-(t.left||0),top:a.top-o.top-(t.top||0)}}const rc=()=>({left:window.scrollX,top:window.scrollY});function y1(e){let t;if("el"in e){const o=e.el,a=typeof o=="string"&&o.startsWith("#"),s=typeof o=="string"?a?document.getElementById(o.slice(1)):document.querySelector(o):o;if(!s)return;t=g1(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function _h(e,t){return(history.state?history.state.position-t:-1)+e}const mu=new Map;function k1(e,t){mu.set(e,t)}function _1(e){const t=mu.get(e);return mu.delete(e),t}function b1(e){return typeof e=="string"||e&&typeof e=="object"}function Qp(e){return typeof e=="string"||typeof e=="symbol"}let tn=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const ev=Symbol("");tn.MATCHER_NOT_FOUND+"",tn.NAVIGATION_GUARD_REDIRECT+"",tn.NAVIGATION_ABORTED+"",tn.NAVIGATION_CANCELLED+"",tn.NAVIGATION_DUPLICATED+"";function Ui(e,t){return Pt(new Error,{type:e,[ev]:!0},t)}function Ts(e,t){return e instanceof Error&&ev in e&&(t==null||!!(e.type&t))}const w1=["params","query","hash"];function C1(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const o of w1)o in e&&(t[o]=e[o]);return JSON.stringify(t,null,2)}function L1(e){const t={};if(e===""||e==="?")return t;const o=(e[0]==="?"?e.slice(1):e).split("&");for(let a=0;a<o.length;++a){const s=o[a].replace(Wp," "),i=s.indexOf("="),l=Rl(i<0?s:s.slice(0,i)),u=i<0?null:Rl(s.slice(i+1));if(l in t){let d=t[l];ss(d)||(d=t[l]=[d]),d.push(u)}else t[l]=u}return t}function bh(e){let t="";for(let o in e){const a=e[o];if(o=a1(o),a==null){a!==void 0&&(t+=(t.length?"&":"")+o);continue}(ss(a)?a.map(s=>s&&pu(s)):[a&&pu(a)]).forEach(s=>{s!==void 0&&(t+=(t.length?"&":"")+o,s!=null&&(t+="="+s))})}return t}function S1(e){const t={};for(const o in e){const a=e[o];a!==void 0&&(t[o]=ss(a)?a.map(s=>s==null?null:""+s):a==null?a:""+a)}return t}const x1=Symbol(""),wh=Symbol(""),cc=Symbol(""),Qu=Symbol(""),gu=Symbol("");function rl(){let e=[];function t(a){return e.push(a),()=>{const s=e.indexOf(a);s>-1&&e.splice(s,1)}}function o(){e=[]}return{add:t,list:()=>e.slice(),reset:o}}function ga(e,t,o,a,s,i=l=>l()){const l=a&&(a.enterCallbacks[s]=a.enterCallbacks[s]||[]);return()=>new Promise((u,d)=>{const p=y=>{y===!1?d(Ui(tn.NAVIGATION_ABORTED,{from:o,to:t})):y instanceof Error?d(y):b1(y)?d(Ui(tn.NAVIGATION_GUARD_REDIRECT,{from:t,to:y})):(l&&a.enterCallbacks[s]===l&&typeof y=="function"&&l.push(y),u())},f=i(()=>e.call(a&&a.instances[s],t,o,p));let g=Promise.resolve(f);e.length<3&&(g=g.then(p)),g.catch(y=>d(y))})}function jc(e,t,o,a,s=i=>i()){const i=[];for(const l of e)for(const u in l.components){let d=l.components[u];if(!(t!=="beforeRouteEnter"&&!l.instances[u]))if(Zp(d)){const p=(d.__vccOpts||d)[t];p&&i.push(ga(p,o,a,l,u,s))}else{let p=d();i.push(()=>p.then(f=>{if(!f)throw new Error(`Couldn't resolve component "${u}" at "${l.path}"`);const g=Wy(f)?f.default:f;l.mods[u]=f,l.components[u]=g;const y=(g.__vccOpts||g)[t];return y&&ga(y,o,a,l,u,s)()}))}}return i}function I1(e,t){const o=[],a=[],s=[],i=Math.max(t.matched.length,e.matched.length);for(let l=0;l<i;l++){const u=t.matched[l];u&&(e.matched.find(p=>Fi(p,u))?a.push(u):o.push(u));const d=e.matched[l];d&&(t.matched.find(p=>Fi(p,d))||s.push(d))}return[o,a,s]}let $1=()=>location.protocol+"//"+location.host;function tv(e,t){const{pathname:o,search:a,hash:s}=t,i=e.indexOf("#");if(i>-1){let l=s.includes(e.slice(i))?e.slice(i).length:1,u=s.slice(l);return u[0]!=="/"&&(u="/"+u),yh(u,"")}return yh(o,e)+a+s}function T1(e,t,o,a){let s=[],i=[],l=null;const u=({state:y})=>{const _=tv(e,location),k=o.value,w=t.value;let S=0;if(y){if(o.value=_,t.value=y,l&&l===k){l=null;return}S=w?y.position-w.position:0}else a(_);s.forEach(E=>{E(o.value,k,{delta:S,type:vu.pop,direction:S?S>0?Gc.forward:Gc.back:Gc.unknown})})};function d(){l=o.value}function p(y){s.push(y);const _=()=>{const k=s.indexOf(y);k>-1&&s.splice(k,1)};return i.push(_),_}function f(){if(document.visibilityState==="hidden"){const{history:y}=window;if(!y.state)return;y.replaceState(Pt({},y.state,{scroll:rc()}),"")}}function g(){for(const y of i)y();i=[],window.removeEventListener("popstate",u),window.removeEventListener("pagehide",f),document.removeEventListener("visibilitychange",f)}return window.addEventListener("popstate",u),window.addEventListener("pagehide",f),document.addEventListener("visibilitychange",f),{pauseListeners:d,listen:p,destroy:g}}function Ch(e,t,o,a=!1,s=!1){return{back:e,current:t,forward:o,replaced:a,position:window.history.length,scroll:s?rc():null}}function M1(e){const{history:t,location:o}=window,a={value:tv(e,o)},s={value:t.state};s.value||i(a.value,{back:null,current:a.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(d,p,f){const g=e.indexOf("#"),y=g>-1?(o.host&&document.querySelector("base")?e:e.slice(g))+d:$1()+e+d;try{t[f?"replaceState":"pushState"](p,"",y),s.value=p}catch(_){console.error(_),o[f?"replace":"assign"](y)}}function l(d,p){i(d,Pt({},t.state,Ch(s.value.back,d,s.value.forward,!0),p,{position:s.value.position}),!0),a.value=d}function u(d,p){const f=Pt({},s.value,t.state,{forward:d,scroll:rc()});i(f.current,f,!0),i(d,Pt({},Ch(a.value,d,null),{position:f.position+1},p),!1),a.value=d}return{location:a,state:s,push:u,replace:l}}function A1(e){e=p1(e);const t=M1(e),o=T1(e,t.state,t.location,t.replace);function a(i,l=!0){l||o.pauseListeners(),history.go(i)}const s=Pt({location:"",base:e,go:a,createHref:m1.bind(null,e)},t,o);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function E1(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),A1(e)}let Xa=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var rn=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(rn||{});const P1={type:Xa.Static,value:""},D1=/[a-zA-Z0-9_]/;function R1(e){if(!e)return[[]];if(e==="/")return[[P1]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(_){throw new Error(`ERR (${o})/"${p}": ${_}`)}let o=rn.Static,a=o;const s=[];let i;function l(){i&&s.push(i),i=[]}let u=0,d,p="",f="";function g(){p&&(o===rn.Static?i.push({type:Xa.Static,value:p}):o===rn.Param||o===rn.ParamRegExp||o===rn.ParamRegExpEnd?(i.length>1&&(d==="*"||d==="+")&&t(`A repeatable param (${p}) must be alone in its segment. eg: '/:ids+.`),i.push({type:Xa.Param,value:p,regexp:f,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):t("Invalid state to consume buffer"),p="")}function y(){p+=d}for(;u<e.length;){if(d=e[u++],d==="\\"&&o!==rn.ParamRegExp){a=o,o=rn.EscapeNext;continue}switch(o){case rn.Static:d==="/"?(p&&g(),l()):d===":"?(g(),o=rn.Param):y();break;case rn.EscapeNext:y(),o=a;break;case rn.Param:d==="("?o=rn.ParamRegExp:D1.test(d)?y():(g(),o=rn.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--);break;case rn.ParamRegExp:d===")"?f[f.length-1]=="\\"?f=f.slice(0,-1)+d:o=rn.ParamRegExpEnd:f+=d;break;case rn.ParamRegExpEnd:g(),o=rn.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--,f="";break;default:t("Unknown state");break}}return o===rn.ParamRegExp&&t(`Unfinished custom RegExp for param "${p}"`),g(),l(),s}const Lh="[^/]+?",O1={sensitive:!1,strict:!1,start:!0,end:!0};var Kn=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(Kn||{});const B1=/[.+*?^${}()[\]/\\]/g;function N1(e,t){const o=Pt({},O1,t),a=[];let s=o.start?"^":"";const i=[];for(const p of e){const f=p.length?[]:[Kn.Root];o.strict&&!p.length&&(s+="/");for(let g=0;g<p.length;g++){const y=p[g];let _=Kn.Segment+(o.sensitive?Kn.BonusCaseSensitive:0);if(y.type===Xa.Static)g||(s+="/"),s+=y.value.replace(B1,"\\$&"),_+=Kn.Static;else if(y.type===Xa.Param){const{value:k,repeatable:w,optional:S,regexp:E}=y;i.push({name:k,repeatable:w,optional:S});const A=E||Lh;if(A!==Lh){_+=Kn.BonusCustomRegExp;try{`${A}`}catch(D){throw new Error(`Invalid custom RegExp for param "${k}" (${A}): `+D.message)}}let x=w?`((?:${A})(?:/(?:${A}))*)`:`(${A})`;g||(x=S&&p.length<2?`(?:/${x})`:"/"+x),S&&(x+="?"),s+=x,_+=Kn.Dynamic,S&&(_+=Kn.BonusOptional),w&&(_+=Kn.BonusRepeatable),A===".*"&&(_+=Kn.BonusWildcard)}f.push(_)}a.push(f)}if(o.strict&&o.end){const p=a.length-1;a[p][a[p].length-1]+=Kn.BonusStrict}o.strict||(s+="/?"),o.end?s+="$":o.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const l=new RegExp(s,o.sensitive?"":"i");function u(p){const f=p.match(l),g={};if(!f)return null;for(let y=1;y<f.length;y++){const _=f[y]||"",k=i[y-1];g[k.name]=_&&k.repeatable?_.split("/"):_}return g}function d(p){let f="",g=!1;for(const y of e){(!g||!f.endsWith("/"))&&(f+="/"),g=!1;for(const _ of y)if(_.type===Xa.Static)f+=_.value;else if(_.type===Xa.Param){const{value:k,repeatable:w,optional:S}=_,E=k in p?p[k]:"";if(ss(E)&&!w)throw new Error(`Provided param "${k}" is an array but it is not repeatable (* or + modifiers)`);const A=ss(E)?E.join("/"):E;if(!A)if(S)y.length<2&&(f.endsWith("/")?f=f.slice(0,-1):g=!0);else throw new Error(`Missing required param "${k}"`);f+=A}}return f||"/"}return{re:l,score:a,keys:i,parse:u,stringify:d}}function F1(e,t){let o=0;for(;o<e.length&&o<t.length;){const a=t[o]-e[o];if(a)return a;o++}return e.length<t.length?e.length===1&&e[0]===Kn.Static+Kn.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===Kn.Static+Kn.Segment?1:-1:0}function nv(e,t){let o=0;const a=e.score,s=t.score;for(;o<a.length&&o<s.length;){const i=F1(a[o],s[o]);if(i)return i;o++}if(Math.abs(s.length-a.length)===1){if(Sh(a))return 1;if(Sh(s))return-1}return s.length-a.length}function Sh(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const U1={strict:!1,end:!0,sensitive:!1};function z1(e,t,o){const a=N1(R1(e.path),o),s=Pt(a,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function H1(e,t){const o=[],a=new Map;t=gh(U1,t);function s(g){return a.get(g)}function i(g,y,_){const k=!_,w=Ih(g);w.aliasOf=_&&_.record;const S=gh(t,g),E=[w];if("alias"in g){const D=typeof g.alias=="string"?[g.alias]:g.alias;for(const R of D)E.push(Ih(Pt({},w,{components:_?_.record.components:w.components,path:R,aliasOf:_?_.record:w})))}let A,x;for(const D of E){const{path:R}=D;if(y&&R[0]!=="/"){const F=y.record.path,T=F[F.length-1]==="/"?"":"/";D.path=y.record.path+(R&&T+R)}if(A=z1(D,y,S),_?_.alias.push(A):(x=x||A,x!==A&&x.alias.push(A),k&&g.name&&!$h(A)&&l(g.name)),ov(A)&&d(A),w.children){const F=w.children;for(let T=0;T<F.length;T++)i(F[T],A,_&&_.children[T])}_=_||A}return x?()=>{l(x)}:Sl}function l(g){if(Qp(g)){const y=a.get(g);y&&(a.delete(g),o.splice(o.indexOf(y),1),y.children.forEach(l),y.alias.forEach(l))}else{const y=o.indexOf(g);y>-1&&(o.splice(y,1),g.record.name&&a.delete(g.record.name),g.children.forEach(l),g.alias.forEach(l))}}function u(){return o}function d(g){const y=j1(g,o);o.splice(y,0,g),g.record.name&&!$h(g)&&a.set(g.record.name,g)}function p(g,y){let _,k={},w,S;if("name"in g&&g.name){if(_=a.get(g.name),!_)throw Ui(tn.MATCHER_NOT_FOUND,{location:g});S=_.record.name,k=Pt(xh(y.params,_.keys.filter(x=>!x.optional).concat(_.parent?_.parent.keys.filter(x=>x.optional):[]).map(x=>x.name)),g.params&&xh(g.params,_.keys.map(x=>x.name))),w=_.stringify(k)}else if(g.path!=null)w=g.path,_=o.find(x=>x.re.test(w)),_&&(k=_.parse(w),S=_.record.name);else{if(_=y.name?a.get(y.name):o.find(x=>x.re.test(y.path)),!_)throw Ui(tn.MATCHER_NOT_FOUND,{location:g,currentLocation:y});S=_.record.name,k=Pt({},y.params,g.params),w=_.stringify(k)}const E=[];let A=_;for(;A;)E.unshift(A.record),A=A.parent;return{name:S,path:w,params:k,matched:E,meta:G1(E)}}e.forEach(g=>i(g));function f(){o.length=0,a.clear()}return{addRoute:i,resolve:p,removeRoute:l,clearRoutes:f,getRoutes:u,getRecordMatcher:s}}function xh(e,t){const o={};for(const a of t)a in e&&(o[a]=e[a]);return o}function Ih(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:V1(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function V1(e){const t={},o=e.props||!1;if("component"in e)t.default=o;else for(const a in e.components)t[a]=typeof o=="object"?o[a]:o;return t}function $h(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function G1(e){return e.reduce((t,o)=>Pt(t,o.meta),{})}function j1(e,t){let o=0,a=t.length;for(;o!==a;){const i=o+a>>1;nv(e,t[i])<0?a=i:o=i+1}const s=Z1(e);return s&&(a=t.lastIndexOf(s,a-1)),a}function Z1(e){let t=e;for(;t=t.parent;)if(ov(t)&&nv(e,t)===0)return t}function ov({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Th(e){const t=lo(cc),o=lo(Qu),a=V(()=>{const d=O(e.to);return t.resolve(d)}),s=V(()=>{const{matched:d}=a.value,{length:p}=d,f=d[p-1],g=o.matched;if(!f||!g.length)return-1;const y=g.findIndex(Fi.bind(null,f));if(y>-1)return y;const _=Mh(d[p-2]);return p>1&&Mh(f)===_&&g[g.length-1].path!==_?g.findIndex(Fi.bind(null,d[p-2])):y}),i=V(()=>s.value>-1&&Y1(o.params,a.value.params)),l=V(()=>s.value>-1&&s.value===o.matched.length-1&&Xp(o.params,a.value.params));function u(d={}){if(J1(d)){const p=t[O(e.replace)?"replace":"push"](O(e.to)).catch(Sl);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>p),p}return Promise.resolve()}return{route:a,href:V(()=>a.value.href),isActive:i,isExactActive:l,navigate:u}}function q1(e){return e.length===1?e[0]:e}const W1=lp({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Th,setup(e,{slots:t}){const o=ii(Th(e)),{options:a}=lo(cc),s=V(()=>({[Ah(e.activeClass,a.linkActiveClass,"router-link-active")]:o.isActive,[Ah(e.exactActiveClass,a.linkExactActiveClass,"router-link-exact-active")]:o.isExactActive}));return()=>{const i=t.default&&q1(t.default(o));return e.custom?i:Ju("a",{"aria-current":o.isExactActive?e.ariaCurrentValue:null,href:o.href,onClick:o.navigate,class:s.value},i)}}}),K1=W1;function J1(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function Y1(e,t){for(const o in t){const a=t[o],s=e[o];if(typeof a=="string"){if(a!==s)return!1}else if(!ss(s)||s.length!==a.length||a.some((i,l)=>i.valueOf()!==s[l].valueOf()))return!1}return!0}function Mh(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Ah=(e,t,o)=>e??t??o,X1=lp({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:o}){const a=lo(gu),s=V(()=>e.route||a.value),i=lo(wh,0),l=V(()=>{let p=O(i);const{matched:f}=s.value;let g;for(;(g=f[p])&&!g.components;)p++;return p}),u=V(()=>s.value.matched[l.value]);yl(wh,V(()=>l.value+1)),yl(x1,u),yl(gu,s);const d=$();return qe(()=>[d.value,u.value,e.name],([p,f,g],[y,_,k])=>{f&&(f.instances[g]=p,_&&_!==f&&p&&p===y&&(f.leaveGuards.size||(f.leaveGuards=_.leaveGuards),f.updateGuards.size||(f.updateGuards=_.updateGuards))),p&&f&&(!_||!Fi(f,_)||!y)&&(f.enterCallbacks[g]||[]).forEach(w=>w(p))},{flush:"post"}),()=>{const p=s.value,f=e.name,g=u.value,y=g&&g.components[f];if(!y)return Eh(o.default,{Component:y,route:p});const _=g.props[f],k=_?_===!0?p.params:typeof _=="function"?_(p):_:null,S=Ju(y,Pt({},k,t,{onVnodeUnmounted:E=>{E.component.isUnmounted&&(g.instances[f]=null)},ref:d}));return Eh(o.default,{Component:S,route:p})||S}}});function Eh(e,t){if(!e)return null;const o=e(t);return o.length===1?o[0]:o}const Q1=X1;function ek(e){const t=H1(e.routes,e),o=e.parseQuery||L1,a=e.stringifyQuery||bh,s=e.history,i=rl(),l=rl(),u=rl(),d=Km(da);let p=da;$i&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const f=Hc.bind(null,be=>""+be),g=Hc.bind(null,l1),y=Hc.bind(null,Rl);function _(be,Ve){let ve,Le;return Qp(be)?(ve=t.getRecordMatcher(be),Le=Ve):Le=be,t.addRoute(Le,ve)}function k(be){const Ve=t.getRecordMatcher(be);Ve&&t.removeRoute(Ve)}function w(){return t.getRoutes().map(be=>be.record)}function S(be){return!!t.getRecordMatcher(be)}function E(be,Ve){if(Ve=Pt({},Ve||d.value),typeof be=="string"){const pe=Vc(o,be,Ve.path),Ce=t.resolve({path:pe.path},Ve),le=s.createHref(pe.fullPath);return Pt(pe,Ce,{params:y(Ce.params),hash:Rl(pe.hash),redirectedFrom:void 0,href:le})}let ve;if(be.path!=null)ve=Pt({},be,{path:Vc(o,be.path,Ve.path).path});else{const pe=Pt({},be.params);for(const Ce in pe)pe[Ce]==null&&delete pe[Ce];ve=Pt({},be,{params:g(pe)}),Ve.params=g(Ve.params)}const Le=t.resolve(ve,Ve),Pe=be.hash||"";Le.params=f(y(Le.params));const W=u1(a,Pt({},be,{hash:s1(Pe),path:Le.path})),Y=s.createHref(W);return Pt({fullPath:W,hash:Pe,query:a===bh?S1(be.query):be.query||{}},Le,{redirectedFrom:void 0,href:Y})}function A(be){return typeof be=="string"?Vc(o,be,d.value.path):Pt({},be)}function x(be,Ve){if(p!==be)return Ui(tn.NAVIGATION_CANCELLED,{from:Ve,to:be})}function D(be){return T(be)}function R(be){return D(Pt(A(be),{replace:!0}))}function F(be,Ve){const ve=be.matched[be.matched.length-1];if(ve&&ve.redirect){const{redirect:Le}=ve;let Pe=typeof Le=="function"?Le(be,Ve):Le;return typeof Pe=="string"&&(Pe=Pe.includes("?")||Pe.includes("#")?Pe=A(Pe):{path:Pe},Pe.params={}),Pt({query:be.query,hash:be.hash,params:Pe.path!=null?{}:be.params},Pe)}}function T(be,Ve){const ve=p=E(be),Le=d.value,Pe=be.state,W=be.force,Y=be.replace===!0,pe=F(ve,Le);if(pe)return T(Pt(A(pe),{state:typeof pe=="object"?Pt({},Pe,pe.state):Pe,force:W,replace:Y}),Ve||ve);const Ce=ve;Ce.redirectedFrom=Ve;let le;return!W&&d1(a,Le,ve)&&(le=Ui(tn.NAVIGATION_DUPLICATED,{to:Ce,from:Le}),ue(Le,Le,!0,!1)),(le?Promise.resolve(le):q(Ce,Le)).catch(J=>Ts(J)?Ts(J,tn.NAVIGATION_GUARD_REDIRECT)?J:fe(J):U(J,Ce,Le)).then(J=>{if(J){if(Ts(J,tn.NAVIGATION_GUARD_REDIRECT))return T(Pt({replace:Y},A(J.to),{state:typeof J.to=="object"?Pt({},Pe,J.to.state):Pe,force:W}),Ve||Ce)}else J=G(Ce,Le,!0,Y,Pe);return P(Ce,Le,J),J})}function N(be,Ve){const ve=x(be,Ve);return ve?Promise.reject(ve):Promise.resolve()}function B(be){const Ve=Je.values().next().value;return Ve&&typeof Ve.runWithContext=="function"?Ve.runWithContext(be):be()}function q(be,Ve){let ve;const[Le,Pe,W]=I1(be,Ve);ve=jc(Le.reverse(),"beforeRouteLeave",be,Ve);for(const pe of Le)pe.leaveGuards.forEach(Ce=>{ve.push(ga(Ce,be,Ve))});const Y=N.bind(null,be,Ve);return ve.push(Y),He(ve).then(()=>{ve=[];for(const pe of i.list())ve.push(ga(pe,be,Ve));return ve.push(Y),He(ve)}).then(()=>{ve=jc(Pe,"beforeRouteUpdate",be,Ve);for(const pe of Pe)pe.updateGuards.forEach(Ce=>{ve.push(ga(Ce,be,Ve))});return ve.push(Y),He(ve)}).then(()=>{ve=[];for(const pe of W)if(pe.beforeEnter)if(ss(pe.beforeEnter))for(const Ce of pe.beforeEnter)ve.push(ga(Ce,be,Ve));else ve.push(ga(pe.beforeEnter,be,Ve));return ve.push(Y),He(ve)}).then(()=>(be.matched.forEach(pe=>pe.enterCallbacks={}),ve=jc(W,"beforeRouteEnter",be,Ve,B),ve.push(Y),He(ve))).then(()=>{ve=[];for(const pe of l.list())ve.push(ga(pe,be,Ve));return ve.push(Y),He(ve)}).catch(pe=>Ts(pe,tn.NAVIGATION_CANCELLED)?pe:Promise.reject(pe))}function P(be,Ve,ve){u.list().forEach(Le=>B(()=>Le(be,Ve,ve)))}function G(be,Ve,ve,Le,Pe){const W=x(be,Ve);if(W)return W;const Y=Ve===da,pe=$i?history.state:{};ve&&(Le||Y?s.replace(be.fullPath,Pt({scroll:Y&&pe&&pe.scroll},Pe)):s.push(be.fullPath,Pe)),d.value=be,ue(be,Ve,ve,Y),fe()}let X;function ne(){X||(X=s.listen((be,Ve,ve)=>{if(!Ze.listening)return;const Le=E(be),Pe=F(Le,Ze.currentRoute.value);if(Pe){T(Pt(Pe,{replace:!0,force:!0}),Le).catch(Sl);return}p=Le;const W=d.value;$i&&k1(_h(W.fullPath,ve.delta),rc()),q(Le,W).catch(Y=>Ts(Y,tn.NAVIGATION_ABORTED|tn.NAVIGATION_CANCELLED)?Y:Ts(Y,tn.NAVIGATION_GUARD_REDIRECT)?(T(Pt(A(Y.to),{force:!0}),Le).then(pe=>{Ts(pe,tn.NAVIGATION_ABORTED|tn.NAVIGATION_DUPLICATED)&&!ve.delta&&ve.type===vu.pop&&s.go(-1,!1)}).catch(Sl),Promise.reject()):(ve.delta&&s.go(-ve.delta,!1),U(Y,Le,W))).then(Y=>{Y=Y||G(Le,W,!1),Y&&(ve.delta&&!Ts(Y,tn.NAVIGATION_CANCELLED)?s.go(-ve.delta,!1):ve.type===vu.pop&&Ts(Y,tn.NAVIGATION_ABORTED|tn.NAVIGATION_DUPLICATED)&&s.go(-1,!1)),P(Le,W,Y)}).catch(Sl)}))}let K=rl(),Q=rl(),he;function U(be,Ve,ve){fe(be);const Le=Q.list();return Le.length?Le.forEach(Pe=>Pe(be,Ve,ve)):console.error(be),Promise.reject(be)}function ee(){return he&&d.value!==da?Promise.resolve():new Promise((be,Ve)=>{K.add([be,Ve])})}function fe(be){return he||(he=!be,ne(),K.list().forEach(([Ve,ve])=>be?ve(be):Ve()),K.reset()),be}function ue(be,Ve,ve,Le){const{scrollBehavior:Pe}=e;if(!$i||!Pe)return Promise.resolve();const W=!ve&&_1(_h(be.fullPath,0))||(Le||!ve)&&history.state&&history.state.scroll||null;return cn().then(()=>Pe(be,Ve,W)).then(Y=>Y&&y1(Y)).catch(Y=>U(Y,be,Ve))}const De=be=>s.go(be);let et;const Je=new Set,Ze={currentRoute:d,listening:!0,addRoute:_,removeRoute:k,clearRoutes:t.clearRoutes,hasRoute:S,getRoutes:w,resolve:E,options:e,push:D,replace:R,go:De,back:()=>De(-1),forward:()=>De(1),beforeEach:i.add,beforeResolve:l.add,afterEach:u.add,onError:Q.add,isReady:ee,install(be){be.component("RouterLink",K1),be.component("RouterView",Q1),be.config.globalProperties.$router=Ze,Object.defineProperty(be.config.globalProperties,"$route",{enumerable:!0,get:()=>O(d)}),$i&&!et&&d.value===da&&(et=!0,D(s.location).catch(Le=>{}));const Ve={};for(const Le in da)Object.defineProperty(Ve,Le,{get:()=>d.value[Le],enumerable:!0});be.provide(cc,Ze),be.provide(Qu,zf(Ve)),be.provide(gu,d);const ve=be.unmount;Je.add(be),be.unmount=function(){Je.delete(be),Je.size<1&&(p=da,X&&X(),X=null,d.value=da,et=!1,he=!1),ve()}}};function He(be){return be.reduce((Ve,ve)=>Ve.then(()=>B(ve)),Promise.resolve())}return Ze}function Vi(){return lo(cc)}function uc(e){return lo(Qu)}const tk={__name:"App",setup(e){const t=Vi(),o=$(""),a=["/","/sessions"];return qe(()=>t.currentRoute.value,(s,i)=>{if(!i?.path){o.value="";return}const l=a.indexOf(s.path),u=a.indexOf(i.path);l!==-1&&u!==-1?o.value=l>u?"slide-left":"slide-right":o.value=""},{immediate:!0}),(s,i)=>{const l=ju("router-view");return v(),We(l,null,{default:ze(({Component:u,route:d})=>[Ae(gs,{name:o.value,mode:"out-in"},{default:ze(()=>[(v(),We(Lg(u),{key:d.path}))]),_:2},1032,["name"])]),_:1})}}},Gi="marshalSessions",nk=30;function Or(e,t){return`${e}:${t}`}function ed(e){const[t,o]=e.split(":");return{eventId:t,marshalId:o}}function $a(){try{return JSON.parse(localStorage.getItem(Gi)||"{}")}catch{return{}}}function Br(e){const t=$a(),o=Object.entries(t).filter(([a])=>a.startsWith(`${e}:`)).map(([a,s])=>({sessionKey:a,...s}));return o.length===0?null:(o.sort((a,s)=>new Date(s.lastAccessed)-new Date(a.lastAccessed)),o[0])}function Ph(e,t){if(!t.marshalId){console.error("Cannot save session without marshalId");return}const o=$a(),a=Or(e,t.marshalId);o[a]={...o[a],...t,eventId:e,lastAccessed:new Date().toISOString()},localStorage.setItem(Gi,JSON.stringify(o))}function yu(e){const t=$a(),{eventId:o,marshalId:a}=ed(e);delete t[e],localStorage.setItem(Gi,JSON.stringify(t)),localStorage.removeItem(`marshalCode_${o}_${a}`)}function sv(e,t){const o=$a(),a=Or(e,t);o[a]&&(o[a].lastAccessed=new Date().toISOString(),localStorage.setItem(Gi,JSON.stringify(o)))}function av(){const e=$a(),t=new Date;t.setDate(t.getDate()-nk);let o=!1;for(const a of Object.keys(e))if(new Date(e[a].lastAccessed)<t){const{eventId:i,marshalId:l}=ed(a);delete e[a],localStorage.removeItem(`marshalCode_${i}_${l}`),o=!0}o&&localStorage.setItem(Gi,JSON.stringify(e))}function iv(){const e=$a(),t=[];for(let a=0;a<localStorage.length;a++){const s=localStorage.key(a);if(s&&s.startsWith("marshal_")&&!s.startsWith("marshalCode_")&&!s.startsWith("marshalSessions")){const i=s.replace("marshal_",""),l=localStorage.getItem(s);if(l){const u=Or(i,l);e[u]||(e[u]={marshalId:l,eventId:i,token:null,lastAccessed:new Date().toISOString()})}t.push(s)}}const o=Object.keys(e).filter(a=>!a.includes(":"));for(const a of o){const s=e[a];if(s&&s.marshalId){const i=Or(a,s.marshalId);e[i]||(e[i]={...s,eventId:a}),delete e[a]}}(t.length>0||o.length>0)&&(localStorage.setItem(Gi,JSON.stringify(e)),t.forEach(a=>localStorage.removeItem(a)))}function ok(){const e=$a();return Object.entries(e).map(([t,o])=>{const{eventId:a,marshalId:s}=ed(t);return{sessionKey:t,eventId:a,marshalId:s,...o}}).filter(t=>t.token).sort((t,o)=>t.eventDate&&o.eventDate?new Date(t.eventDate)-new Date(o.eventDate):new Date(o.lastAccessed)-new Date(t.lastAccessed))}function lv(){const e=$a();return Object.values(e).some(t=>t.token)}function rv(e,t){const o=`marshalCode_${e}_${t}`,a=localStorage.getItem(o);return a||localStorage.getItem(`marshalCode_${e}`)}function sk(e,t,o){localStorage.setItem(`marshalCode_${e}_${t}`,o)}function cv(e,t){return function(){return e.apply(t,arguments)}}const{toString:ak}=Object.prototype,{getPrototypeOf:td}=Object,{iterator:dc,toStringTag:uv}=Symbol,hc=(e=>t=>{const o=ak.call(t);return e[o]||(e[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),as=e=>(e=e.toLowerCase(),t=>hc(t)===e),fc=e=>t=>typeof t===e,{isArray:ji}=Array,zi=fc("undefined");function Hl(e){return e!==null&&!zi(e)&&e.constructor!==null&&!zi(e.constructor)&&ro(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const dv=as("ArrayBuffer");function ik(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&dv(e.buffer),t}const lk=fc("string"),ro=fc("function"),hv=fc("number"),Vl=e=>e!==null&&typeof e=="object",rk=e=>e===!0||e===!1,kr=e=>{if(hc(e)!=="object")return!1;const t=td(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(uv in e)&&!(dc in e)},ck=e=>{if(!Vl(e)||Hl(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},uk=as("Date"),dk=as("File"),hk=as("Blob"),fk=as("FileList"),pk=e=>Vl(e)&&ro(e.pipe),vk=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ro(e.append)&&((t=hc(e))==="formdata"||t==="object"&&ro(e.toString)&&e.toString()==="[object FormData]"))},mk=as("URLSearchParams"),[gk,yk,kk,_k]=["ReadableStream","Request","Response","Headers"].map(as),bk=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Gl(e,t,{allOwnKeys:o=!1}={}){if(e===null||typeof e>"u")return;let a,s;if(typeof e!="object"&&(e=[e]),ji(e))for(a=0,s=e.length;a<s;a++)t.call(null,e[a],a,e);else{if(Hl(e))return;const i=o?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let u;for(a=0;a<l;a++)u=i[a],t.call(null,e[u],u,e)}}function fv(e,t){if(Hl(e))return null;t=t.toLowerCase();const o=Object.keys(e);let a=o.length,s;for(;a-- >0;)if(s=o[a],t===s.toLowerCase())return s;return null}const Qa=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,pv=e=>!zi(e)&&e!==Qa;function ku(){const{caseless:e,skipUndefined:t}=pv(this)&&this||{},o={},a=(s,i)=>{const l=e&&fv(o,i)||i;kr(o[l])&&kr(s)?o[l]=ku(o[l],s):kr(s)?o[l]=ku({},s):ji(s)?o[l]=s.slice():(!t||!zi(s))&&(o[l]=s)};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&Gl(arguments[s],a);return o}const wk=(e,t,o,{allOwnKeys:a}={})=>(Gl(t,(s,i)=>{o&&ro(s)?e[i]=cv(s,o):e[i]=s},{allOwnKeys:a}),e),Ck=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Lk=(e,t,o,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),o&&Object.assign(e.prototype,o)},Sk=(e,t,o,a)=>{let s,i,l;const u={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)l=s[i],(!a||a(l,e,t))&&!u[l]&&(t[l]=e[l],u[l]=!0);e=o!==!1&&td(e)}while(e&&(!o||o(e,t))&&e!==Object.prototype);return t},xk=(e,t,o)=>{e=String(e),(o===void 0||o>e.length)&&(o=e.length),o-=t.length;const a=e.indexOf(t,o);return a!==-1&&a===o},Ik=e=>{if(!e)return null;if(ji(e))return e;let t=e.length;if(!hv(t))return null;const o=new Array(t);for(;t-- >0;)o[t]=e[t];return o},$k=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&td(Uint8Array)),Tk=(e,t)=>{const a=(e&&e[dc]).call(e);let s;for(;(s=a.next())&&!s.done;){const i=s.value;t.call(e,i[0],i[1])}},Mk=(e,t)=>{let o;const a=[];for(;(o=e.exec(t))!==null;)a.push(o);return a},Ak=as("HTMLFormElement"),Ek=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,a,s){return a.toUpperCase()+s}),Dh=(({hasOwnProperty:e})=>(t,o)=>e.call(t,o))(Object.prototype),Pk=as("RegExp"),vv=(e,t)=>{const o=Object.getOwnPropertyDescriptors(e),a={};Gl(o,(s,i)=>{let l;(l=t(s,i,e))!==!1&&(a[i]=l||s)}),Object.defineProperties(e,a)},Dk=e=>{vv(e,(t,o)=>{if(ro(e)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const a=e[o];if(ro(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},Rk=(e,t)=>{const o={},a=s=>{s.forEach(i=>{o[i]=!0})};return ji(e)?a(e):a(String(e).split(t)),o},Ok=()=>{},Bk=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Nk(e){return!!(e&&ro(e.append)&&e[uv]==="FormData"&&e[dc])}const Fk=e=>{const t=new Array(10),o=(a,s)=>{if(Vl(a)){if(t.indexOf(a)>=0)return;if(Hl(a))return a;if(!("toJSON"in a)){t[s]=a;const i=ji(a)?[]:{};return Gl(a,(l,u)=>{const d=o(l,s+1);!zi(d)&&(i[u]=d)}),t[s]=void 0,i}}return a};return o(e,0)},Uk=as("AsyncFunction"),zk=e=>e&&(Vl(e)||ro(e))&&ro(e.then)&&ro(e.catch),mv=((e,t)=>e?setImmediate:t?((o,a)=>(Qa.addEventListener("message",({source:s,data:i})=>{s===Qa&&i===o&&a.length&&a.shift()()},!1),s=>{a.push(s),Qa.postMessage(o,"*")}))(`axios@${Math.random()}`,[]):o=>setTimeout(o))(typeof setImmediate=="function",ro(Qa.postMessage)),Hk=typeof queueMicrotask<"u"?queueMicrotask.bind(Qa):typeof process<"u"&&process.nextTick||mv,Vk=e=>e!=null&&ro(e[dc]),$e={isArray:ji,isArrayBuffer:dv,isBuffer:Hl,isFormData:vk,isArrayBufferView:ik,isString:lk,isNumber:hv,isBoolean:rk,isObject:Vl,isPlainObject:kr,isEmptyObject:ck,isReadableStream:gk,isRequest:yk,isResponse:kk,isHeaders:_k,isUndefined:zi,isDate:uk,isFile:dk,isBlob:hk,isRegExp:Pk,isFunction:ro,isStream:pk,isURLSearchParams:mk,isTypedArray:$k,isFileList:fk,forEach:Gl,merge:ku,extend:wk,trim:bk,stripBOM:Ck,inherits:Lk,toFlatObject:Sk,kindOf:hc,kindOfTest:as,endsWith:xk,toArray:Ik,forEachEntry:Tk,matchAll:Mk,isHTMLForm:Ak,hasOwnProperty:Dh,hasOwnProp:Dh,reduceDescriptors:vv,freezeMethods:Dk,toObjectSet:Rk,toCamelCase:Ek,noop:Ok,toFiniteNumber:Bk,findKey:fv,global:Qa,isContextDefined:pv,isSpecCompliantForm:Nk,toJSONObject:Fk,isAsyncFn:Uk,isThenable:zk,setImmediate:mv,asap:Hk,isIterable:Vk};function pt(e,t,o,a,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),o&&(this.config=o),a&&(this.request=a),s&&(this.response=s,this.status=s.status?s.status:null)}$e.inherits(pt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:$e.toJSONObject(this.config),code:this.code,status:this.status}}});const gv=pt.prototype,yv={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{yv[e]={value:e}});Object.defineProperties(pt,yv);Object.defineProperty(gv,"isAxiosError",{value:!0});pt.from=(e,t,o,a,s,i)=>{const l=Object.create(gv);$e.toFlatObject(e,l,function(f){return f!==Error.prototype},p=>p!=="isAxiosError");const u=e&&e.message?e.message:"Error",d=t==null&&e?e.code:t;return pt.call(l,u,d,o,a,s),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",i&&Object.assign(l,i),l};const Gk=null;function _u(e){return $e.isPlainObject(e)||$e.isArray(e)}function kv(e){return $e.endsWith(e,"[]")?e.slice(0,-2):e}function Rh(e,t,o){return e?e.concat(t).map(function(s,i){return s=kv(s),!o&&i?"["+s+"]":s}).join(o?".":""):t}function jk(e){return $e.isArray(e)&&!e.some(_u)}const Zk=$e.toFlatObject($e,{},null,function(t){return/^is[A-Z]/.test(t)});function pc(e,t,o){if(!$e.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,o=$e.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,S){return!$e.isUndefined(S[w])});const a=o.metaTokens,s=o.visitor||f,i=o.dots,l=o.indexes,d=(o.Blob||typeof Blob<"u"&&Blob)&&$e.isSpecCompliantForm(t);if(!$e.isFunction(s))throw new TypeError("visitor must be a function");function p(k){if(k===null)return"";if($e.isDate(k))return k.toISOString();if($e.isBoolean(k))return k.toString();if(!d&&$e.isBlob(k))throw new pt("Blob is not supported. Use a Buffer instead.");return $e.isArrayBuffer(k)||$e.isTypedArray(k)?d&&typeof Blob=="function"?new Blob([k]):Buffer.from(k):k}function f(k,w,S){let E=k;if(k&&!S&&typeof k=="object"){if($e.endsWith(w,"{}"))w=a?w:w.slice(0,-2),k=JSON.stringify(k);else if($e.isArray(k)&&jk(k)||($e.isFileList(k)||$e.endsWith(w,"[]"))&&(E=$e.toArray(k)))return w=kv(w),E.forEach(function(x,D){!($e.isUndefined(x)||x===null)&&t.append(l===!0?Rh([w],D,i):l===null?w:w+"[]",p(x))}),!1}return _u(k)?!0:(t.append(Rh(S,w,i),p(k)),!1)}const g=[],y=Object.assign(Zk,{defaultVisitor:f,convertValue:p,isVisitable:_u});function _(k,w){if(!$e.isUndefined(k)){if(g.indexOf(k)!==-1)throw Error("Circular reference detected in "+w.join("."));g.push(k),$e.forEach(k,function(E,A){(!($e.isUndefined(E)||E===null)&&s.call(t,E,$e.isString(A)?A.trim():A,w,y))===!0&&_(E,w?w.concat(A):[A])}),g.pop()}}if(!$e.isObject(e))throw new TypeError("data must be an object");return _(e),t}function Oh(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function nd(e,t){this._pairs=[],e&&pc(e,this,t)}const _v=nd.prototype;_v.append=function(t,o){this._pairs.push([t,o])};_v.toString=function(t){const o=t?function(a){return t.call(this,a,Oh)}:Oh;return this._pairs.map(function(s){return o(s[0])+"="+o(s[1])},"").join("&")};function qk(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function bv(e,t,o){if(!t)return e;const a=o&&o.encode||qk;$e.isFunction(o)&&(o={serialize:o});const s=o&&o.serialize;let i;if(s?i=s(t,o):i=$e.isURLSearchParams(t)?t.toString():new nd(t,o).toString(a),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class Bh{constructor(){this.handlers=[]}use(t,o,a){return this.handlers.push({fulfilled:t,rejected:o,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){$e.forEach(this.handlers,function(a){a!==null&&t(a)})}}const wv={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Wk=typeof URLSearchParams<"u"?URLSearchParams:nd,Kk=typeof FormData<"u"?FormData:null,Jk=typeof Blob<"u"?Blob:null,Yk={isBrowser:!0,classes:{URLSearchParams:Wk,FormData:Kk,Blob:Jk},protocols:["http","https","file","blob","url","data"]},od=typeof window<"u"&&typeof document<"u",bu=typeof navigator=="object"&&navigator||void 0,Xk=od&&(!bu||["ReactNative","NativeScript","NS"].indexOf(bu.product)<0),Qk=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",e_=od&&window.location.href||"http://localhost",t_=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:od,hasStandardBrowserEnv:Xk,hasStandardBrowserWebWorkerEnv:Qk,navigator:bu,origin:e_},Symbol.toStringTag,{value:"Module"})),Nn={...t_,...Yk};function n_(e,t){return pc(e,new Nn.classes.URLSearchParams,{visitor:function(o,a,s,i){return Nn.isNode&&$e.isBuffer(o)?(this.append(a,o.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function o_(e){return $e.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function s_(e){const t={},o=Object.keys(e);let a;const s=o.length;let i;for(a=0;a<s;a++)i=o[a],t[i]=e[i];return t}function Cv(e){function t(o,a,s,i){let l=o[i++];if(l==="__proto__")return!0;const u=Number.isFinite(+l),d=i>=o.length;return l=!l&&$e.isArray(s)?s.length:l,d?($e.hasOwnProp(s,l)?s[l]=[s[l],a]:s[l]=a,!u):((!s[l]||!$e.isObject(s[l]))&&(s[l]=[]),t(o,a,s[l],i)&&$e.isArray(s[l])&&(s[l]=s_(s[l])),!u)}if($e.isFormData(e)&&$e.isFunction(e.entries)){const o={};return $e.forEachEntry(e,(a,s)=>{t(o_(a),s,o,0)}),o}return null}function a_(e,t,o){if($e.isString(e))try{return(t||JSON.parse)(e),$e.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(o||JSON.stringify)(e)}const jl={transitional:wv,adapter:["xhr","http","fetch"],transformRequest:[function(t,o){const a=o.getContentType()||"",s=a.indexOf("application/json")>-1,i=$e.isObject(t);if(i&&$e.isHTMLForm(t)&&(t=new FormData(t)),$e.isFormData(t))return s?JSON.stringify(Cv(t)):t;if($e.isArrayBuffer(t)||$e.isBuffer(t)||$e.isStream(t)||$e.isFile(t)||$e.isBlob(t)||$e.isReadableStream(t))return t;if($e.isArrayBufferView(t))return t.buffer;if($e.isURLSearchParams(t))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return n_(t,this.formSerializer).toString();if((u=$e.isFileList(t))||a.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return pc(u?{"files[]":t}:t,d&&new d,this.formSerializer)}}return i||s?(o.setContentType("application/json",!1),a_(t)):t}],transformResponse:[function(t){const o=this.transitional||jl.transitional,a=o&&o.forcedJSONParsing,s=this.responseType==="json";if($e.isResponse(t)||$e.isReadableStream(t))return t;if(t&&$e.isString(t)&&(a&&!this.responseType||s)){const l=!(o&&o.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(u){if(l)throw u.name==="SyntaxError"?pt.from(u,pt.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Nn.classes.FormData,Blob:Nn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};$e.forEach(["delete","get","head","post","put","patch"],e=>{jl.headers[e]={}});const i_=$e.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),l_=e=>{const t={};let o,a,s;return e&&e.split(`
`).forEach(function(l){s=l.indexOf(":"),o=l.substring(0,s).trim().toLowerCase(),a=l.substring(s+1).trim(),!(!o||t[o]&&i_[o])&&(o==="set-cookie"?t[o]?t[o].push(a):t[o]=[a]:t[o]=t[o]?t[o]+", "+a:a)}),t},Nh=Symbol("internals");function cl(e){return e&&String(e).trim().toLowerCase()}function _r(e){return e===!1||e==null?e:$e.isArray(e)?e.map(_r):String(e)}function r_(e){const t=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=o.exec(e);)t[a[1]]=a[2];return t}const c_=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Zc(e,t,o,a,s){if($e.isFunction(a))return a.call(this,t,o);if(s&&(t=o),!!$e.isString(t)){if($e.isString(a))return t.indexOf(a)!==-1;if($e.isRegExp(a))return a.test(t)}}function u_(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,o,a)=>o.toUpperCase()+a)}function d_(e,t){const o=$e.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+o,{value:function(s,i,l){return this[a].call(this,t,s,i,l)},configurable:!0})})}let co=class{constructor(t){t&&this.set(t)}set(t,o,a){const s=this;function i(u,d,p){const f=cl(d);if(!f)throw new Error("header name must be a non-empty string");const g=$e.findKey(s,f);(!g||s[g]===void 0||p===!0||p===void 0&&s[g]!==!1)&&(s[g||d]=_r(u))}const l=(u,d)=>$e.forEach(u,(p,f)=>i(p,f,d));if($e.isPlainObject(t)||t instanceof this.constructor)l(t,o);else if($e.isString(t)&&(t=t.trim())&&!c_(t))l(l_(t),o);else if($e.isObject(t)&&$e.isIterable(t)){let u={},d,p;for(const f of t){if(!$e.isArray(f))throw TypeError("Object iterator must return a key-value pair");u[p=f[0]]=(d=u[p])?$e.isArray(d)?[...d,f[1]]:[d,f[1]]:f[1]}l(u,o)}else t!=null&&i(o,t,a);return this}get(t,o){if(t=cl(t),t){const a=$e.findKey(this,t);if(a){const s=this[a];if(!o)return s;if(o===!0)return r_(s);if($e.isFunction(o))return o.call(this,s,a);if($e.isRegExp(o))return o.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,o){if(t=cl(t),t){const a=$e.findKey(this,t);return!!(a&&this[a]!==void 0&&(!o||Zc(this,this[a],a,o)))}return!1}delete(t,o){const a=this;let s=!1;function i(l){if(l=cl(l),l){const u=$e.findKey(a,l);u&&(!o||Zc(a,a[u],u,o))&&(delete a[u],s=!0)}}return $e.isArray(t)?t.forEach(i):i(t),s}clear(t){const o=Object.keys(this);let a=o.length,s=!1;for(;a--;){const i=o[a];(!t||Zc(this,this[i],i,t,!0))&&(delete this[i],s=!0)}return s}normalize(t){const o=this,a={};return $e.forEach(this,(s,i)=>{const l=$e.findKey(a,i);if(l){o[l]=_r(s),delete o[i];return}const u=t?u_(i):String(i).trim();u!==i&&delete o[i],o[u]=_r(s),a[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const o=Object.create(null);return $e.forEach(this,(a,s)=>{a!=null&&a!==!1&&(o[s]=t&&$e.isArray(a)?a.join(", "):a)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,o])=>t+": "+o).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...o){const a=new this(t);return o.forEach(s=>a.set(s)),a}static accessor(t){const a=(this[Nh]=this[Nh]={accessors:{}}).accessors,s=this.prototype;function i(l){const u=cl(l);a[u]||(d_(s,l),a[u]=!0)}return $e.isArray(t)?t.forEach(i):i(t),this}};co.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);$e.reduceDescriptors(co.prototype,({value:e},t)=>{let o=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[o]=a}}});$e.freezeMethods(co);function qc(e,t){const o=this||jl,a=t||o,s=co.from(a.headers);let i=a.data;return $e.forEach(e,function(u){i=u.call(o,i,s.normalize(),t?t.status:void 0)}),s.normalize(),i}function Lv(e){return!!(e&&e.__CANCEL__)}function Zi(e,t,o){pt.call(this,e??"canceled",pt.ERR_CANCELED,t,o),this.name="CanceledError"}$e.inherits(Zi,pt,{__CANCEL__:!0});function Sv(e,t,o){const a=o.config.validateStatus;!o.status||!a||a(o.status)?e(o):t(new pt("Request failed with status code "+o.status,[pt.ERR_BAD_REQUEST,pt.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}function h_(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function f_(e,t){e=e||10;const o=new Array(e),a=new Array(e);let s=0,i=0,l;return t=t!==void 0?t:1e3,function(d){const p=Date.now(),f=a[i];l||(l=p),o[s]=d,a[s]=p;let g=i,y=0;for(;g!==s;)y+=o[g++],g=g%e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),p-l<t)return;const _=f&&p-f;return _?Math.round(y*1e3/_):void 0}}function p_(e,t){let o=0,a=1e3/t,s,i;const l=(p,f=Date.now())=>{o=f,s=null,i&&(clearTimeout(i),i=null),e(...p)};return[(...p)=>{const f=Date.now(),g=f-o;g>=a?l(p,f):(s=p,i||(i=setTimeout(()=>{i=null,l(s)},a-g)))},()=>s&&l(s)]}const Nr=(e,t,o=3)=>{let a=0;const s=f_(50,250);return p_(i=>{const l=i.loaded,u=i.lengthComputable?i.total:void 0,d=l-a,p=s(d),f=l<=u;a=l;const g={loaded:l,total:u,progress:u?l/u:void 0,bytes:d,rate:p||void 0,estimated:p&&u&&f?(u-l)/p:void 0,event:i,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(g)},o)},Fh=(e,t)=>{const o=e!=null;return[a=>t[0]({lengthComputable:o,total:e,loaded:a}),t[1]]},Uh=e=>(...t)=>$e.asap(()=>e(...t)),v_=Nn.hasStandardBrowserEnv?((e,t)=>o=>(o=new URL(o,Nn.origin),e.protocol===o.protocol&&e.host===o.host&&(t||e.port===o.port)))(new URL(Nn.origin),Nn.navigator&&/(msie|trident)/i.test(Nn.navigator.userAgent)):()=>!0,m_=Nn.hasStandardBrowserEnv?{write(e,t,o,a,s,i,l){if(typeof document>"u")return;const u=[`${e}=${encodeURIComponent(t)}`];$e.isNumber(o)&&u.push(`expires=${new Date(o).toUTCString()}`),$e.isString(a)&&u.push(`path=${a}`),$e.isString(s)&&u.push(`domain=${s}`),i===!0&&u.push("secure"),$e.isString(l)&&u.push(`SameSite=${l}`),document.cookie=u.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function g_(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function y_(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function xv(e,t,o){let a=!g_(t);return e&&(a||o==!1)?y_(e,t):t}const zh=e=>e instanceof co?{...e}:e;function ai(e,t){t=t||{};const o={};function a(p,f,g,y){return $e.isPlainObject(p)&&$e.isPlainObject(f)?$e.merge.call({caseless:y},p,f):$e.isPlainObject(f)?$e.merge({},f):$e.isArray(f)?f.slice():f}function s(p,f,g,y){if($e.isUndefined(f)){if(!$e.isUndefined(p))return a(void 0,p,g,y)}else return a(p,f,g,y)}function i(p,f){if(!$e.isUndefined(f))return a(void 0,f)}function l(p,f){if($e.isUndefined(f)){if(!$e.isUndefined(p))return a(void 0,p)}else return a(void 0,f)}function u(p,f,g){if(g in t)return a(p,f);if(g in e)return a(void 0,p)}const d={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:u,headers:(p,f,g)=>s(zh(p),zh(f),g,!0)};return $e.forEach(Object.keys({...e,...t}),function(f){const g=d[f]||s,y=g(e[f],t[f],f);$e.isUndefined(y)&&g!==u||(o[f]=y)}),o}const Iv=e=>{const t=ai({},e);let{data:o,withXSRFToken:a,xsrfHeaderName:s,xsrfCookieName:i,headers:l,auth:u}=t;if(t.headers=l=co.from(l),t.url=bv(xv(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&l.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),$e.isFormData(o)){if(Nn.hasStandardBrowserEnv||Nn.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if($e.isFunction(o.getHeaders)){const d=o.getHeaders(),p=["content-type","content-length"];Object.entries(d).forEach(([f,g])=>{p.includes(f.toLowerCase())&&l.set(f,g)})}}if(Nn.hasStandardBrowserEnv&&(a&&$e.isFunction(a)&&(a=a(t)),a||a!==!1&&v_(t.url))){const d=s&&i&&m_.read(i);d&&l.set(s,d)}return t},k_=typeof XMLHttpRequest<"u",__=k_&&function(e){return new Promise(function(o,a){const s=Iv(e);let i=s.data;const l=co.from(s.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:p}=s,f,g,y,_,k;function w(){_&&_(),k&&k(),s.cancelToken&&s.cancelToken.unsubscribe(f),s.signal&&s.signal.removeEventListener("abort",f)}let S=new XMLHttpRequest;S.open(s.method.toUpperCase(),s.url,!0),S.timeout=s.timeout;function E(){if(!S)return;const x=co.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders()),R={data:!u||u==="text"||u==="json"?S.responseText:S.response,status:S.status,statusText:S.statusText,headers:x,config:e,request:S};Sv(function(T){o(T),w()},function(T){a(T),w()},R),S=null}"onloadend"in S?S.onloadend=E:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(E)},S.onabort=function(){S&&(a(new pt("Request aborted",pt.ECONNABORTED,e,S)),S=null)},S.onerror=function(D){const R=D&&D.message?D.message:"Network Error",F=new pt(R,pt.ERR_NETWORK,e,S);F.event=D||null,a(F),S=null},S.ontimeout=function(){let D=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const R=s.transitional||wv;s.timeoutErrorMessage&&(D=s.timeoutErrorMessage),a(new pt(D,R.clarifyTimeoutError?pt.ETIMEDOUT:pt.ECONNABORTED,e,S)),S=null},i===void 0&&l.setContentType(null),"setRequestHeader"in S&&$e.forEach(l.toJSON(),function(D,R){S.setRequestHeader(R,D)}),$e.isUndefined(s.withCredentials)||(S.withCredentials=!!s.withCredentials),u&&u!=="json"&&(S.responseType=s.responseType),p&&([y,k]=Nr(p,!0),S.addEventListener("progress",y)),d&&S.upload&&([g,_]=Nr(d),S.upload.addEventListener("progress",g),S.upload.addEventListener("loadend",_)),(s.cancelToken||s.signal)&&(f=x=>{S&&(a(!x||x.type?new Zi(null,e,S):x),S.abort(),S=null)},s.cancelToken&&s.cancelToken.subscribe(f),s.signal&&(s.signal.aborted?f():s.signal.addEventListener("abort",f)));const A=h_(s.url);if(A&&Nn.protocols.indexOf(A)===-1){a(new pt("Unsupported protocol "+A+":",pt.ERR_BAD_REQUEST,e));return}S.send(i||null)})},b_=(e,t)=>{const{length:o}=e=e?e.filter(Boolean):[];if(t||o){let a=new AbortController,s;const i=function(p){if(!s){s=!0,u();const f=p instanceof Error?p:this.reason;a.abort(f instanceof pt?f:new Zi(f instanceof Error?f.message:f))}};let l=t&&setTimeout(()=>{l=null,i(new pt(`timeout ${t} of ms exceeded`,pt.ETIMEDOUT))},t);const u=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(p=>{p.unsubscribe?p.unsubscribe(i):p.removeEventListener("abort",i)}),e=null)};e.forEach(p=>p.addEventListener("abort",i));const{signal:d}=a;return d.unsubscribe=()=>$e.asap(u),d}},w_=function*(e,t){let o=e.byteLength;if(o<t){yield e;return}let a=0,s;for(;a<o;)s=a+t,yield e.slice(a,s),a=s},C_=async function*(e,t){for await(const o of L_(e))yield*w_(o,t)},L_=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:o,value:a}=await t.read();if(o)break;yield a}}finally{await t.cancel()}},Hh=(e,t,o,a)=>{const s=C_(e,t);let i=0,l,u=d=>{l||(l=!0,a&&a(d))};return new ReadableStream({async pull(d){try{const{done:p,value:f}=await s.next();if(p){u(),d.close();return}let g=f.byteLength;if(o){let y=i+=g;o(y)}d.enqueue(new Uint8Array(f))}catch(p){throw u(p),p}},cancel(d){return u(d),s.return()}},{highWaterMark:2})},Vh=64*1024,{isFunction:dr}=$e,S_=(({Request:e,Response:t})=>({Request:e,Response:t}))($e.global),{ReadableStream:Gh,TextEncoder:jh}=$e.global,Zh=(e,...t)=>{try{return!!e(...t)}catch{return!1}},x_=e=>{e=$e.merge.call({skipUndefined:!0},S_,e);const{fetch:t,Request:o,Response:a}=e,s=t?dr(t):typeof fetch=="function",i=dr(o),l=dr(a);if(!s)return!1;const u=s&&dr(Gh),d=s&&(typeof jh=="function"?(k=>w=>k.encode(w))(new jh):async k=>new Uint8Array(await new o(k).arrayBuffer())),p=i&&u&&Zh(()=>{let k=!1;const w=new o(Nn.origin,{body:new Gh,method:"POST",get duplex(){return k=!0,"half"}}).headers.has("Content-Type");return k&&!w}),f=l&&u&&Zh(()=>$e.isReadableStream(new a("").body)),g={stream:f&&(k=>k.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(k=>{!g[k]&&(g[k]=(w,S)=>{let E=w&&w[k];if(E)return E.call(w);throw new pt(`Response type '${k}' is not supported`,pt.ERR_NOT_SUPPORT,S)})});const y=async k=>{if(k==null)return 0;if($e.isBlob(k))return k.size;if($e.isSpecCompliantForm(k))return(await new o(Nn.origin,{method:"POST",body:k}).arrayBuffer()).byteLength;if($e.isArrayBufferView(k)||$e.isArrayBuffer(k))return k.byteLength;if($e.isURLSearchParams(k)&&(k=k+""),$e.isString(k))return(await d(k)).byteLength},_=async(k,w)=>{const S=$e.toFiniteNumber(k.getContentLength());return S??y(w)};return async k=>{let{url:w,method:S,data:E,signal:A,cancelToken:x,timeout:D,onDownloadProgress:R,onUploadProgress:F,responseType:T,headers:N,withCredentials:B="same-origin",fetchOptions:q}=Iv(k),P=t||fetch;T=T?(T+"").toLowerCase():"text";let G=b_([A,x&&x.toAbortSignal()],D),X=null;const ne=G&&G.unsubscribe&&(()=>{G.unsubscribe()});let K;try{if(F&&p&&S!=="get"&&S!=="head"&&(K=await _(N,E))!==0){let ue=new o(w,{method:"POST",body:E,duplex:"half"}),De;if($e.isFormData(E)&&(De=ue.headers.get("content-type"))&&N.setContentType(De),ue.body){const[et,Je]=Fh(K,Nr(Uh(F)));E=Hh(ue.body,Vh,et,Je)}}$e.isString(B)||(B=B?"include":"omit");const Q=i&&"credentials"in o.prototype,he={...q,signal:G,method:S.toUpperCase(),headers:N.normalize().toJSON(),body:E,duplex:"half",credentials:Q?B:void 0};X=i&&new o(w,he);let U=await(i?P(X,q):P(w,he));const ee=f&&(T==="stream"||T==="response");if(f&&(R||ee&&ne)){const ue={};["status","statusText","headers"].forEach(Ze=>{ue[Ze]=U[Ze]});const De=$e.toFiniteNumber(U.headers.get("content-length")),[et,Je]=R&&Fh(De,Nr(Uh(R),!0))||[];U=new a(Hh(U.body,Vh,et,()=>{Je&&Je(),ne&&ne()}),ue)}T=T||"text";let fe=await g[$e.findKey(g,T)||"text"](U,k);return!ee&&ne&&ne(),await new Promise((ue,De)=>{Sv(ue,De,{data:fe,headers:co.from(U.headers),status:U.status,statusText:U.statusText,config:k,request:X})})}catch(Q){throw ne&&ne(),Q&&Q.name==="TypeError"&&/Load failed|fetch/i.test(Q.message)?Object.assign(new pt("Network Error",pt.ERR_NETWORK,k,X),{cause:Q.cause||Q}):pt.from(Q,Q&&Q.code,k,X)}}},I_=new Map,$v=e=>{let t=e&&e.env||{};const{fetch:o,Request:a,Response:s}=t,i=[a,s,o];let l=i.length,u=l,d,p,f=I_;for(;u--;)d=i[u],p=f.get(d),p===void 0&&f.set(d,p=u?new Map:x_(t)),f=p;return p};$v();const sd={http:Gk,xhr:__,fetch:{get:$v}};$e.forEach(sd,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const qh=e=>`- ${e}`,$_=e=>$e.isFunction(e)||e===null||e===!1;function T_(e,t){e=$e.isArray(e)?e:[e];const{length:o}=e;let a,s;const i={};for(let l=0;l<o;l++){a=e[l];let u;if(s=a,!$_(a)&&(s=sd[(u=String(a)).toLowerCase()],s===void 0))throw new pt(`Unknown adapter '${u}'`);if(s&&($e.isFunction(s)||(s=s.get(t))))break;i[u||"#"+l]=s}if(!s){const l=Object.entries(i).map(([d,p])=>`adapter ${d} `+(p===!1?"is not supported by the environment":"is not available in the build"));let u=o?l.length>1?`since :
`+l.map(qh).join(`
`):" "+qh(l[0]):"as no adapter specified";throw new pt("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return s}const Tv={getAdapter:T_,adapters:sd};function Wc(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Zi(null,e)}function Wh(e){return Wc(e),e.headers=co.from(e.headers),e.data=qc.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Tv.getAdapter(e.adapter||jl.adapter,e)(e).then(function(a){return Wc(e),a.data=qc.call(e,e.transformResponse,a),a.headers=co.from(a.headers),a},function(a){return Lv(a)||(Wc(e),a&&a.response&&(a.response.data=qc.call(e,e.transformResponse,a.response),a.response.headers=co.from(a.response.headers))),Promise.reject(a)})}const Mv="1.13.2",vc={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{vc[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const Kh={};vc.transitional=function(t,o,a){function s(i,l){return"[Axios v"+Mv+"] Transitional option '"+i+"'"+l+(a?". "+a:"")}return(i,l,u)=>{if(t===!1)throw new pt(s(l," has been removed"+(o?" in "+o:"")),pt.ERR_DEPRECATED);return o&&!Kh[l]&&(Kh[l]=!0,console.warn(s(l," has been deprecated since v"+o+" and will be removed in the near future"))),t?t(i,l,u):!0}};vc.spelling=function(t){return(o,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function M_(e,t,o){if(typeof e!="object")throw new pt("options must be an object",pt.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let s=a.length;for(;s-- >0;){const i=a[s],l=t[i];if(l){const u=e[i],d=u===void 0||l(u,i,e);if(d!==!0)throw new pt("option "+i+" must be "+d,pt.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new pt("Unknown option "+i,pt.ERR_BAD_OPTION)}}const br={assertOptions:M_,validators:vc},us=br.validators;let ni=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Bh,response:new Bh}}async request(t,o){try{return await this._request(t,o)}catch(a){if(a instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(t,o){typeof t=="string"?(o=o||{},o.url=t):o=t||{},o=ai(this.defaults,o);const{transitional:a,paramsSerializer:s,headers:i}=o;a!==void 0&&br.assertOptions(a,{silentJSONParsing:us.transitional(us.boolean),forcedJSONParsing:us.transitional(us.boolean),clarifyTimeoutError:us.transitional(us.boolean)},!1),s!=null&&($e.isFunction(s)?o.paramsSerializer={serialize:s}:br.assertOptions(s,{encode:us.function,serialize:us.function},!0)),o.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?o.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:o.allowAbsoluteUrls=!0),br.assertOptions(o,{baseUrl:us.spelling("baseURL"),withXsrfToken:us.spelling("withXSRFToken")},!0),o.method=(o.method||this.defaults.method||"get").toLowerCase();let l=i&&$e.merge(i.common,i[o.method]);i&&$e.forEach(["delete","get","head","post","put","patch","common"],k=>{delete i[k]}),o.headers=co.concat(l,i);const u=[];let d=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(o)===!1||(d=d&&w.synchronous,u.unshift(w.fulfilled,w.rejected))});const p=[];this.interceptors.response.forEach(function(w){p.push(w.fulfilled,w.rejected)});let f,g=0,y;if(!d){const k=[Wh.bind(this),void 0];for(k.unshift(...u),k.push(...p),y=k.length,f=Promise.resolve(o);g<y;)f=f.then(k[g++],k[g++]);return f}y=u.length;let _=o;for(;g<y;){const k=u[g++],w=u[g++];try{_=k(_)}catch(S){w.call(this,S);break}}try{f=Wh.call(this,_)}catch(k){return Promise.reject(k)}for(g=0,y=p.length;g<y;)f=f.then(p[g++],p[g++]);return f}getUri(t){t=ai(this.defaults,t);const o=xv(t.baseURL,t.url,t.allowAbsoluteUrls);return bv(o,t.params,t.paramsSerializer)}};$e.forEach(["delete","get","head","options"],function(t){ni.prototype[t]=function(o,a){return this.request(ai(a||{},{method:t,url:o,data:(a||{}).data}))}});$e.forEach(["post","put","patch"],function(t){function o(a){return function(i,l,u){return this.request(ai(u||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}ni.prototype[t]=o(),ni.prototype[t+"Form"]=o(!0)});let A_=class Av{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(i){o=i});const a=this;this.promise.then(s=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](s);a._listeners=null}),this.promise.then=s=>{let i;const l=new Promise(u=>{a.subscribe(u),i=u}).then(s);return l.cancel=function(){a.unsubscribe(i)},l},t(function(i,l,u){a.reason||(a.reason=new Zi(i,l,u),o(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const o=this._listeners.indexOf(t);o!==-1&&this._listeners.splice(o,1)}toAbortSignal(){const t=new AbortController,o=a=>{t.abort(a)};return this.subscribe(o),t.signal.unsubscribe=()=>this.unsubscribe(o),t.signal}static source(){let t;return{token:new Av(function(s){t=s}),cancel:t}}};function E_(e){return function(o){return e.apply(null,o)}}function P_(e){return $e.isObject(e)&&e.isAxiosError===!0}const wu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(wu).forEach(([e,t])=>{wu[t]=e});function Ev(e){const t=new ni(e),o=cv(ni.prototype.request,t);return $e.extend(o,ni.prototype,t,{allOwnKeys:!0}),$e.extend(o,t,null,{allOwnKeys:!0}),o.create=function(s){return Ev(ai(e,s))},o}const sn=Ev(jl);sn.Axios=ni;sn.CanceledError=Zi;sn.CancelToken=A_;sn.isCancel=Lv;sn.VERSION=Mv;sn.toFormData=pc;sn.AxiosError=pt;sn.Cancel=sn.CanceledError;sn.all=function(t){return Promise.all(t)};sn.spread=E_;sn.isAxiosError=P_;sn.mergeConfig=ai;sn.AxiosHeaders=co;sn.formToJSON=e=>Cv($e.isHTMLForm(e)?new FormData(e):e);sn.getAdapter=Tv.getAdapter;sn.HttpStatusCode=wu;sn.default=sn;const{Axios:sH,AxiosError:aH,CanceledError:iH,isCancel:lH,CancelToken:rH,VERSION:cH,all:uH,Cancel:dH,isAxiosError:hH,spread:fH,toFormData:pH,AxiosHeaders:vH,HttpStatusCode:mH,formToJSON:gH,getAdapter:yH,mergeConfig:kH}=sn,dl="https://sterobson-volunteercheckin-testing.azurewebsites.net/api",D_="VolunteerCheckinOffline",R_=1;let Xo=null;async function js(){return Xo||new Promise((e,t)=>{const o=indexedDB.open(D_,R_);o.onerror=()=>{console.error("Failed to open IndexedDB:",o.error),t(o.error)},o.onsuccess=()=>{Xo=o.result,e(Xo)},o.onupgradeneeded=a=>{const s=a.target.result;s.objectStoreNames.contains("eventData")||s.createObjectStore("eventData",{keyPath:"eventId"}),s.objectStoreNames.contains("pendingActions")||s.createObjectStore("pendingActions",{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),s.objectStoreNames.contains("syncMeta")||s.createObjectStore("syncMeta",{keyPath:"key"})}})}async function Ol(e,t){return await js(),new Promise((o,a)=>{const s=Xo.transaction(["eventData","syncMeta"],"readwrite"),i=s.objectStore("eventData"),l=s.objectStore("syncMeta"),u={eventId:e,...t,cachedAt:new Date().toISOString()};i.put(u),l.put({key:`lastSync_${e}`,value:new Date().toISOString()}),s.oncomplete=()=>o(),s.onerror=()=>a(s.error)})}async function wa(e){return await js(),new Promise((t,o)=>{const i=Xo.transaction(["eventData"],"readonly").objectStore("eventData").get(e);i.onsuccess=()=>t(i.result||null),i.onerror=()=>o(i.error)})}async function wr(e,t,o){const a=await wa(e);a&&(a[t]=o,a.cachedAt=new Date().toISOString(),await Ol(e,a))}async function O_(e){return await js(),new Promise((t,o)=>{const s=Xo.transaction(["pendingActions"],"readwrite").objectStore("pendingActions"),i={...e,createdAt:new Date().toISOString(),attempts:0,lastAttempt:null,status:"pending"},l=s.add(i);l.onsuccess=()=>t(l.result),l.onerror=()=>o(l.error)})}async function Pv(){return await js(),new Promise((e,t)=>{const i=Xo.transaction(["pendingActions"],"readonly").objectStore("pendingActions").index("createdAt").getAll();i.onsuccess=()=>{const l=i.result.filter(u=>u.status==="pending"||u.status==="retrying");e(l)},i.onerror=()=>t(i.error)})}async function Fr(){return(await Pv()).length}async function Jh(e,t){return await js(),new Promise((o,a)=>{const s=Xo.transaction(["pendingActions"],"readwrite"),i=s.objectStore("pendingActions"),l=i.get(e);l.onsuccess=()=>{const u=l.result;u&&(Object.assign(u,t),i.put(u))},s.oncomplete=()=>o(),s.onerror=()=>a(s.error)})}async function Yh(e){return await js(),new Promise((t,o)=>{const i=Xo.transaction(["pendingActions"],"readwrite").objectStore("pendingActions").delete(e);i.onsuccess=()=>t(),i.onerror=()=>o(i.error)})}async function B_(e){return await js(),new Promise((t,o)=>{const i=Xo.transaction(["syncMeta"],"readonly").objectStore("syncMeta").get(`lastSync_${e}`);i.onsuccess=()=>t(i.result?.value||null),i.onerror=()=>o(i.error)})}const Ke=sn.create({baseURL:dl,headers:{"Content-Type":"application/json"},timeout:15e3});let Cu=!1,Dv={type:null,eventId:null};function _o(e,t=null){Dv={type:e,eventId:t}}async function N_(){}function Xh(e){const t=[/\/events\/([^/]+)/,/\/assignments\/([^/]+)/,/\/locations\/([^/]+)/,/\/checklist-items\/([^/]+)/,/\/areas\/([^/]+)/,/\/marshals\/([^/]+)/];for(const o of t){const a=e.match(o);if(a)return a[1]}return null}function F_(e){return!!(!e.response&&e.request||e.response&&e.response.status>=500||e.code==="ECONNABORTED")}function Rv(){const e=window.location.hash||"";if(e.includes("/admin/"))return{type:"admin",eventId:null};const t=e.match(/#\/event\/([^/?]+)/);return t?{type:"marshal",eventId:t[1]}:e.includes("/marshal")?{type:null,eventId:null}:Dv}const U_=["/auth/marshal-login","/auth/request-login","/auth/verify-token","/auth/instant-login"];Ke.interceptors.request.use(e=>{if(U_.some(i=>e.url?.includes(i)))return e;const o=localStorage.getItem("adminEmail");o&&(e.headers["X-Admin-Email"]=o);const a=Rv();let s=null;if(a.type==="marshal"&&a.eventId){const i=Br(a.eventId);i?.token&&(s=i.token)}return s||(s=localStorage.getItem("sessionToken")),s&&(e.headers.Authorization=`Bearer ${s}`),e});let Ur=0;const z_=2;function H_(){if(Ur++,Ur>=z_&&Rv().type!=="marshal"){localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken");const t=window.location.hash||"";!t.includes("login")&&!t.includes("/verify")&&(window.location.href="/VolunteerCheckin/testing/#/?login=true")}}function V_(){Ur=0}function Kc(){Ur=0}function G_(e){if(!e?.url)return!1;const t=localStorage.getItem("sessionToken"),o=e.headers?.Authorization||e.headers?.authorization;if(o&&t&&o.replace("Bearer ","")!==t||(e.url||"").includes("/auth/marshal-login"))return!0;const s=window.location.hash||"";return!!(s.match(/#\/event\/[^/?]+/)||s==="#/marshal"||s.startsWith("#/marshal?"))}Ke.interceptors.response.use(e=>{Cu=!1,V_();const t=e.config.url,o=Xh(t);return e.config.method,e},async e=>{const t=e.config;if(e.response&&(e.response.status===401||e.response.status===403))return G_(t)||H_(),Promise.reject(e);if(F_(e)&&(Cu=!0,t.method==="get")){const o=Xh(t.url);if(o){const a=await wa(o);if(a)return console.log("Returning cached data for:",t.url),Promise.resolve({data:a,status:200,statusText:"OK (cached)",headers:{},config:t,cached:!0})}}return Promise.reject(e)});async function ko(e,t,o){return await O_({type:e,payload:t,eventId:t.eventId}),await N_(),{data:o,status:200,statusText:"OK (queued)",queued:!0}}function Pn(){return Cu||!navigator.onLine}const j_={check:()=>Ke.head("/health")},Lu=()=>"https://sterobson.github.io/VolunteerCheckin/testing".replace(/\/?#?\/?$/,""),vs={requestLogin:e=>Ke.post("/auth/request-login",{email:e,frontendUrl:Lu()}),verifyToken:e=>Ke.post("/auth/verify-token",{token:e}),instantLogin:e=>Ke.post("/auth/instant-login",{email:e}),createAdmin:e=>Ke.post("/auth/create-admin",{email:e}),marshalLogin:(e,t)=>Ke.post("/auth/marshal-login",{eventId:e,magicCode:t}),getMe:e=>Ke.get("/auth/me",{params:{eventId:e}}),logout:()=>Ke.post("/auth/logout")},hr={getProfile:()=>Ke.get("/auth/profile"),updateProfile:e=>Ke.put("/auth/profile",e),getPerson:(e,t)=>Ke.get(`/people/${e}`,{params:{eventId:t}}),updatePerson:(e,t,o)=>Ke.put(`/people/${e}`,o,{params:{eventId:t}})},ya={create:e=>Ke.post("/events",e),getAll:()=>Ke.get("/events"),getById:e=>Ke.get(`/events/${e}`),update:(e,t)=>Ke.put(`/events/${e}`,t),delete:e=>Ke.delete(`/events/${e}`),uploadGpx:(e,t)=>{const o=new FormData;return o.append("gpx",t),Ke.post(`/events/${e}/upload-gpx`,o,{headers:{"Content-Type":"multipart/form-data"}})}},Yn={create:e=>Ke.post("/locations",e),getById:(e,t)=>Ke.get(`/locations/${e}/${t}`),getByEvent:e=>Ke.get(`/events/${e}/locations`),update:(e,t,o)=>Ke.put(`/locations/${e}/${t}`,o),delete:(e,t)=>Ke.delete(`/locations/${e}/${t}`),importCsv:(e,t,o)=>{const a=new FormData;return a.append("csv",t),Ke.post(`/locations/import/${e}?deleteExisting=${o}`,a,{headers:{"Content-Type":"multipart/form-data"}})},bulkUpdateTimes:(e,t)=>Ke.post(`/locations/bulk-update-times/${e}`,{timeDelta:t}),updatePosition:(e,t,o)=>Ke.post(`/locations/${e}/${t}/update-position`,o),getDynamicCheckpoints:e=>Ke.get(`/events/${e}/dynamic-checkpoints`)},hl={create:e=>Ke.post("/assignments",e),getById:(e,t)=>Ke.get(`/assignments/${e}/${t}`),getByEvent:e=>Ke.get(`/assignments/event/${e}`),delete:(e,t)=>Ke.delete(`/assignments/${e}/${t}`),getEventStatus:e=>Ke.get(`/events/${e}/status`)},Ca={checkIn:e=>Ke.post("/checkin",e),toggleCheckIn:(e,t,{latitude:o,longitude:a,action:s}={})=>Ke.post(`/checkin/${e}/${t}/toggle`,{latitude:o??null,longitude:a??null,action:s??null}),adminCheckIn:(e,t)=>Ke.post(`/checkin/admin/${e}/${t}`)},Jc={getAdmins:e=>Ke.get(`/events/${e}/admins`),addAdmin:(e,t)=>Ke.post(`/events/${e}/admins`,{userEmail:t}),removeAdmin:(e,t)=>Ke.delete(`/events/${e}/admins/${t}`)},ms={create:e=>Ke.post("/marshals",e),getByEvent:e=>Ke.get(`/events/${e}/marshals`),getById:(e,t)=>Ke.get(`/marshals/${e}/${t}`),update:(e,t,o)=>Ke.put(`/marshals/${e}/${t}`,o),delete:(e,t)=>Ke.delete(`/marshals/${e}/${t}`),getMagicLink:(e,t)=>Ke.get(`/marshals/${e}/${t}/magic-link`,{params:{frontendUrl:Lu()}}),sendMagicLink:(e,t)=>Ke.post(`/marshals/${e}/${t}/send-magic-link`,{frontendUrl:Lu()}),importCsv:(e,t)=>{const o=new FormData;return o.append("csv",t),Ke.post(`/marshals/import/${e}`,o,{headers:{"Content-Type":"multipart/form-data"}})}},ka={create:e=>Ke.post("/areas",e),getByEvent:e=>Ke.get(`/events/${e}/areas`),getById:(e,t)=>Ke.get(`/areas/${e}/${t}`),update:(e,t,o)=>Ke.put(`/areas/${e}/${t}`,o),delete:(e,t)=>Ke.delete(`/areas/${e}/${t}`),recalculate:e=>Ke.post(`/areas/recalculate/${e}`),getCheckpoints:(e,t)=>Ke.get(`/areas/${e}/${t}/locations`),getAreaLeadDashboard:e=>Ke.get(`/events/${e}/area-lead-dashboard`)},Rt={create:(e,t)=>Ke.post(`/events/${e}/checklist-items`,t),getByEvent:e=>Ke.get(`/events/${e}/checklist-items`),getById:(e,t)=>Ke.get(`/checklist-items/${e}/${t}`),update:(e,t,o)=>Ke.put(`/checklist-items/${e}/${t}`,o),delete:(e,t)=>Ke.delete(`/checklist-items/${e}/${t}`),getReport:e=>Ke.get(`/events/${e}/checklist-report`),getMarshalChecklist:(e,t)=>Ke.get(`/events/${e}/marshals/${t}/checklist`),getCheckpointChecklist:(e,t)=>Ke.get(`/events/${e}/locations/${t}/checklist`),getAreaChecklist:(e,t)=>Ke.get(`/events/${e}/areas/${t}/checklist`),complete:(e,t,o)=>Ke.post(`/checklist-items/${e}/${t}/complete`,o),uncomplete:(e,t,o)=>Ke.post(`/checklist-items/${e}/${t}/uncomplete`,o)},Es={create:(e,t)=>Ke.post(`/events/${e}/notes`,t),getByEvent:e=>Ke.get(`/events/${e}/notes`),getById:(e,t)=>Ke.get(`/events/${e}/notes/${t}`),update:(e,t,o)=>Ke.put(`/events/${e}/notes/${t}`,o),delete:(e,t)=>Ke.delete(`/events/${e}/notes/${t}`),getMarshalNotes:(e,t)=>Ke.get(`/events/${e}/marshals/${t}/notes`),getMyNotes:e=>Ke.get(`/events/${e}/my-notes`)},fa={create:(e,t)=>Ke.post(`/events/${e}/contacts`,t),getByEvent:e=>Ke.get(`/events/${e}/contacts`),getById:(e,t)=>Ke.get(`/events/${e}/contacts/${t}`),update:(e,t,o)=>Ke.put(`/events/${e}/contacts/${t}`,o),delete:(e,t)=>Ke.delete(`/events/${e}/contacts/${t}`),getRoles:e=>Ke.get(`/events/${e}/contact-roles`),getMarshalContacts:(e,t)=>Ke.get(`/events/${e}/marshals/${t}/contacts`),getMyContacts:e=>Ke.get(`/events/${e}/my-contacts`)},fs={create:(e,t)=>Ke.post(`/events/${e}/incidents`,t),getAll:(e,t={})=>Ke.get(`/events/${e}/incidents`,{params:t}),getForArea:(e,t)=>Ke.get(`/events/${e}/areas/${t}/incidents`),get:(e,t)=>Ke.get(`/events/${e}/incidents/${t}`),updateStatus:(e,t,o)=>Ke.patch(`/events/${e}/incidents/${t}`,o),addNote:(e,t,o)=>Ke.post(`/events/${e}/incidents/${t}/notes`,{note:o})},je=(e,t)=>{const o=e.__vccOpts||e;for(const[a,s]of t)o[a]=s;return o},Z_={class:"hero-animation-container"},q_={__name:"HeroMapAnimation",props:{animate:{type:Boolean,default:!0}},setup(e){const t=e,o=$(!1);return nn(()=>{t.animate?requestAnimationFrame(()=>{o.value=!0}):o.value=!0}),(a,s)=>(v(),m("div",Z_,[(v(),m("svg",{viewBox:"0 0 400 350",class:de(["hero-map-svg",{animate:o.value&&e.animate,"no-animate":o.value&&!e.animate}])},[...s[0]||(s[0]=[Er(`<defs data-v-cec8ae43><clipPath id="mapClip" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" data-v-cec8ae43></polygon></clipPath></defs><g class="map-group" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" fill="#c8e6c0" stroke="#8fbc8f" stroke-width="3" data-v-cec8ae43></polygon><g clip-path="url(#mapClip)" class="contours" data-v-cec8ae43><ellipse cx="300" cy="60" rx="35" ry="12" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="25" ry="8" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="15" ry="5" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="80" ry="40" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="55" ry="28" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="50" ry="25" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse></g><g clip-path="url(#mapClip)" class="roads" data-v-cec8ae43><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#1a5276" stroke-width="18" stroke-linecap="round" data-v-cec8ae43></path><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#5dade2" stroke-width="12" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#cc8800" stroke-width="10" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#ffcc00" stroke-width="6" stroke-linecap="round" data-v-cec8ae43></path></g><path id="routePath" d="M 60,360
             L 200,250
             L 150,150
             L 280,100
             L 450,60" fill="none" stroke="none" data-v-cec8ae43></path><g class="trail-segments" data-v-cec8ae43><path class="trail-seg trail-seg-1" d="M 60,360 L 200,250" fill="none" stroke="#dc3545" stroke-width="12" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-2" d="M 200,250 L 150,150" fill="none" stroke="#dc3545" stroke-width="9" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-3" d="M 150,150 L 280,100" fill="none" stroke="#dc3545" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-4" d="M 280,100 L 450,60" fill="none" stroke="#dc3545" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path></g><g class="checkpoint checkpoint-1" transform="translate(200, 250)" data-v-cec8ae43><ellipse cx="0" cy="8" rx="40" ry="12" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="4" rx="30" ry="10" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="25" ry="8" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-2" transform="translate(150, 150)" data-v-cec8ae43><ellipse cx="0" cy="6" rx="18" ry="8" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="3" rx="15" ry="6" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="12" ry="5" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-3" transform="translate(280, 100)" data-v-cec8ae43><ellipse cx="0" cy="4" rx="12" ry="5" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="2" rx="10" ry="4" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="8" ry="3" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="marshal marshal-1" transform="translate(200, 250)" data-v-cec8ae43><circle cx="0" cy="-28" r="12" fill="#444" data-v-cec8ae43></circle><path d="M 20,0 v-8 a12 12 0 0 0-12-12 h-16 a12 12 0 0 0-12 12 v8" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-2" transform="translate(150, 150)" data-v-cec8ae43><circle cx="0" cy="-18" r="8" fill="#444" data-v-cec8ae43></circle><path d="M 12,0 v-5 a8 8 0 0 0-8-8 h-8 a8 8 0 0 0-8 8 v5" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-3" transform="translate(280, 100)" data-v-cec8ae43><circle cx="0" cy="-12" r="6" fill="#444" data-v-cec8ae43></circle><path d="M 9,0 v-4 a6 6 0 0 0-6-6 h-6 a6 6 0 0 0-6 6 v4" fill="#444" data-v-cec8ae43></path></g><g clip-path="url(#mapClip)" class="trees" data-v-cec8ae43><g transform="translate(45, 280)" data-v-cec8ae43><polygon points="0,-20 12,0 -12,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-34 10,-12 -10,-12" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-46 8,-26 -8,-26" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-3" y="0" width="6" height="8" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(75, 255)" data-v-cec8ae43><polygon points="0,-18 10,0 -10,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-30 8,-10 -8,-10" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-40 6,-22 -6,-22" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="6" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(350, 230)" data-v-cec8ae43><polygon points="0,-20 11,0 -11,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-33 9,-11 -9,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-44 7,-24 -7,-24" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="7" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(60, 140)" data-v-cec8ae43><polygon points="0,-12 7,0 -7,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-20 5.5,-8 -5.5,-8" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-27 4,-15 -4,-15" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="4" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 70)" data-v-cec8ae43><polygon points="0,-9 5,0 -5,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-15 4,-6 -4,-6" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-20 3,-11 -3,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-1" y="0" width="2" height="3" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 140)" data-v-cec8ae43><polygon points="0,-14 8,0 -8,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-24 6,-9 -6,-9" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-32 5,-18 -5,-18" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="5" fill="#5d4037" data-v-cec8ae43></rect></g></g></g>`,2)])],2))]))}},W_=je(q_,[["__scopeId","data-v-cec8ae43"]]),K_={class:"hero-header"},J_={__name:"HeroHeader",props:{title:{type:String,default:""}},setup(e){const t=$(!1);return nn(()=>{window.__heroAnimationPlayed?t.value=!1:(t.value=!0,window.__heroAnimationPlayed=!0)}),(o,a)=>(v(),m("div",K_,[Ae(W_,{animate:t.value},null,8,["animate"]),e.title?(v(),m("div",{key:0,class:de(["hero-overlay",{"no-animate":!t.value}])},[r("h1",null,C(e.title),1)],2)):M("",!0)]))}},Ov=je(J_,[["__scopeId","data-v-c824ab01"]]),Zl=Yu("auth",()=>{const e=$(localStorage.getItem("adminEmail")||null),t=$(!!e.value),o=$(!1);return{adminEmail:e,isAuthenticated:t,loginPending:o,requestLogin:async u=>{const d=await vs.requestLogin(u);return d.data.success&&(o.value=!0),d.data},verifyToken:async u=>{const d=await vs.verifyToken(u);return d.data.success&&(e.value=d.data.person?.email,t.value=!0,o.value=!1,localStorage.setItem("adminEmail",d.data.person?.email),localStorage.setItem("sessionToken",d.data.sessionToken),_o("admin")),d.data},instantLogin:async u=>{const d=await vs.instantLogin(u);return d.data.success&&(e.value=d.data.email,t.value=!0,localStorage.setItem("adminEmail",d.data.email),d.data.sessionToken&&localStorage.setItem("sessionToken",d.data.sessionToken),_o("admin")),d.data},logout:async()=>{try{await vs.logout()}catch{}e.value=null,t.value=!1,o.value=!1,localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken"),_o(null)}}}),Y_={class:"modal-card"},X_={key:0,class:"email-sent"},Q_={key:1},eb={class:"form-group"},tb=["disabled"],nb={key:0,class:"error"},ob={__name:"LoginModal",props:{show:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3}},emits:["close","success"],setup(e,{emit:t}){const o=e,a=t,s=Zl(),i=$(""),l=$(!1),u=$(null),d=$(!1);async function p(){l.value=!0,u.value=null;try{const y=await s.requestLogin(i.value);y.success?(d.value=!0,a("success",i.value)):u.value=y.message||"Failed to send login link. Please try again."}catch{u.value="Failed to send login link. Please try again."}finally{l.value=!1}}function f(){i.value="",d.value=!1,u.value=null}function g(){a("close")}return qe(()=>o.show,y=>{y||setTimeout(()=>{f()},200)}),(y,_)=>(v(),We(Tl,{to:"body"},[Ae(gs,{name:"modal"},{default:ze(()=>[e.show?(v(),m("div",{key:0,class:"modal-overlay",style:Qe({zIndex:e.zIndex}),onClick:rt(g,["self"])},[r("div",Y_,[r("button",{class:"modal-close",onClick:g},""),d.value?(v(),m("div",X_,[_[2]||(_[2]=r("div",{class:"check-icon"},"",-1)),_[3]||(_[3]=r("h3",null,"Check your email!",-1)),r("p",null,[_[1]||(_[1]=Ye("We've sent a login link to ",-1)),r("strong",null,C(i.value),1)]),_[4]||(_[4]=r("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),r("button",{onClick:f,class:"btn btn-secondary"}," Use a different email ")])):(v(),m("div",Q_,[_[5]||(_[5]=r("h2",null,"Join us or login",-1)),_[6]||(_[6]=r("p",{class:"instruction"},"Enter your email to receive a login link",-1)),r("form",{onSubmit:rt(p,["prevent"])},[r("div",eb,[Ue(r("input",{"onUpdate:modelValue":_[0]||(_[0]=k=>i.value=k),type:"email",placeholder:"you@example.com",required:"",class:"form-input"},null,512),[[st,i.value]])]),r("button",{type:"submit",class:"btn btn-primary btn-full",disabled:l.value},C(l.value?"Sending...":"Send login link"),9,tb)],32),u.value?(v(),m("div",nb,C(u.value),1)):M("",!0)]))])],4)):M("",!0)]),_:1})]))}},Bv=je(ob,[["__scopeId","data-v-7c646305"]]),sb={class:"home"},ab={class:"hero-section"},ib={class:"content-section"},lb={class:"container"},rb={class:"carousel"},cb={class:"carousel-indicators"},ub=["onClick"],db={__name:"Home",setup(e){const t=uc(),o=Vi();function a(){const y=!!localStorage.getItem("adminEmail"),_=lv();return y||_}function s(){a()?o.push("/sessions"):f.value=!0}const i=$(0);let l=null;function u(y){i.value=y,p()}function d(){i.value=(i.value+1)%2}function p(){l&&clearInterval(l),l=setInterval(d,1e4)}const f=$(!1);function g(){f.value=!1,t.query.login&&o.replace({query:{}})}return nn(()=>{p(),t.query.login&&(a()?o.replace("/sessions"):f.value=!0)}),xn(()=>{l&&clearInterval(l)}),(y,_)=>(v(),m("div",sb,[r("section",ab,[Ae(Ov,{title:"OnTheDay"}),_[0]||(_[0]=r("p",{class:"subtitle"},"Manage your event's marshals and volunteers with ease",-1)),r("button",{class:"btn btn-primary",onClick:s}," Join us or login ")]),r("section",ib,[r("div",lb,[_[2]||(_[2]=Er('<div class="features-grid" data-v-c615012d><div class="feature-card" data-v-c615012d><h3 data-v-c615012d>For admins</h3><ul data-v-c615012d><li data-v-c615012d>Create and manage events</li><li data-v-c615012d>Define marshal locations</li><li data-v-c615012d>Real-time check-in monitoring</li><li data-v-c615012d>Map view of everything in your event</li><li data-v-c615012d>Manage incidents</li></ul></div><div class="feature-card" data-v-c615012d><h3 data-v-c615012d>For marshals</h3><ul data-v-c615012d><li data-v-c615012d>View the entire route</li><li data-v-c615012d>View your assigned location</li><li data-v-c615012d>Check in with GPS verification</li><li data-v-c615012d>Access emergency contact info</li><li data-v-c615012d>Record incidents</li></ul></div></div>',1)),r("div",rb,[r("div",{class:"carousel-track",style:Qe({transform:`translateX(-${i.value*100}%)`})},[..._[1]||(_[1]=[Er('<div class="feature-card" data-v-c615012d><h3 data-v-c615012d>For admins</h3><ul data-v-c615012d><li data-v-c615012d>Create and manage events</li><li data-v-c615012d>Define marshal locations</li><li data-v-c615012d>Real-time check-in monitoring</li><li data-v-c615012d>Map view of everything in your event</li><li data-v-c615012d>Manage incidents</li></ul></div><div class="feature-card" data-v-c615012d><h3 data-v-c615012d>For marshals</h3><ul data-v-c615012d><li data-v-c615012d>View the entire route</li><li data-v-c615012d>View your assigned location</li><li data-v-c615012d>Check in with GPS verification</li><li data-v-c615012d>Access emergency contact info</li><li data-v-c615012d>Record incidents</li></ul></div>',2)])],4),r("div",cb,[(v(),m(xe,null,Ne(2,(k,w)=>r("button",{key:w,class:de(["indicator",{active:i.value===w}]),onClick:S=>u(w)},null,10,ub)),64))])])])]),Ae(Bv,{show:f.value,onClose:g},null,8,["show"])]))}},hb=je(db,[["__scopeId","data-v-c615012d"]]),fb={class:"admin-login"},pb={class:"login-card"},vb={key:0,class:"email-sent"},mb={class:"form-group"},gb=["disabled"],yb={key:0,class:"error"},kb={__name:"AdminLogin",setup(e){const t=Zl(),o=$(""),a=$(!1),s=$(null),i=$(!1),l=async()=>{a.value=!0,s.value=null;try{const d=await t.requestLogin(o.value);d.success?i.value=!0:s.value=d.message||"Failed to send login link. Please try again."}catch{s.value="Failed to send login link. Please try again."}finally{a.value=!1}},u=()=>{o.value="",i.value=!1,s.value=null};return(d,p)=>{const f=ju("router-link");return v(),m("div",fb,[r("div",pb,[p[7]||(p[7]=r("h2",null,"Admin login",-1)),i.value?(v(),m("div",vb,[p[2]||(p[2]=r("div",{class:"check-icon"},"",-1)),p[3]||(p[3]=r("h3",null,"Check your email!",-1)),r("p",null,[p[1]||(p[1]=Ye("We've sent a login link to ",-1)),r("strong",null,C(o.value),1)]),p[4]||(p[4]=r("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),r("button",{onClick:u,class:"btn btn-secondary"}," Use a different email ")])):(v(),m(xe,{key:1},[p[5]||(p[5]=r("p",{class:"instruction"},"Enter your email to receive a login link",-1)),r("form",{onSubmit:rt(l,["prevent"])},[r("div",mb,[Ue(r("input",{"onUpdate:modelValue":p[0]||(p[0]=g=>o.value=g),type:"email",placeholder:"admin@example.com",required:"",class:"form-input"},null,512),[[st,o.value]])]),r("button",{type:"submit",class:"btn btn-primary",disabled:a.value},C(a.value?"Sending...":"Send login link"),9,gb)],32),s.value?(v(),m("div",yb,C(s.value),1)):M("",!0)],64)),Ae(f,{to:"/",class:"back-link"},{default:ze(()=>[...p[6]||(p[6]=[Ye(" Back to Home",-1)])]),_:1})])])}}},_b=je(kb,[["__scopeId","data-v-5d0a88c2"]]),bb={class:"admin-verify"},wb={class:"verify-card"},Cb={key:0,class:"status"},Lb={key:1,class:"status error"},Sb={key:2,class:"status success"},xb={__name:"AdminVerify",setup(e){const t=Vi(),o=uc(),a=Zl(),s=$(!0),i=$(null);return nn(async()=>{const l=o.query.token;if(!l){i.value="No login token provided. Please request a new login link.",s.value=!1;return}try{const u=await a.verifyToken(l);u.success?setTimeout(()=>{t.push({name:"Sessions"})},1e3):i.value=u.message||"Invalid or expired login link. Please request a new one."}catch(u){console.error("Verification error:",u),i.value="Failed to verify login. Please try again."}finally{s.value=!1}}),(l,u)=>{const d=ju("router-link");return v(),m("div",bb,[r("div",wb,[s.value?(v(),m("div",Cb,[...u[0]||(u[0]=[r("div",{class:"spinner"},null,-1),r("h2",null,"Verifying your login...",-1),r("p",null,"Please wait while we confirm your identity.",-1)])])):i.value?(v(),m("div",Lb,[u[2]||(u[2]=r("h2",null,"Login failed",-1)),r("p",null,C(i.value),1),Ae(d,{to:{name:"Home",query:{login:"true"}},class:"btn btn-primary"},{default:ze(()=>[...u[1]||(u[1]=[Ye(" Try again ",-1)])]),_:1})])):(v(),m("div",Sb,[...u[3]||(u[3]=[r("h2",null,"Login successful!",-1),r("p",null,"Redirecting to your sessions...",-1)])]))])])}}},Ib=je(xb,[["__scopeId","data-v-b2435a84"]]),Nv=Yu("events",()=>{const e=$([]),t=$(null),o=$([]),a=$([]),s=$(null),i=$(!1),l=$(null),u=async()=>{i.value=!0,l.value=null;try{const F=await ya.getAll();e.value=F.data}catch(F){throw l.value=F.message,F}finally{i.value=!1}},d=async F=>{i.value=!0,l.value=null;try{const T=await ya.getById(F);t.value=T.data}catch(T){throw l.value=T.message,T}finally{i.value=!1}},p=async F=>{i.value=!0,l.value=null;try{const T=await ya.create(F);return e.value.push(T.data),T.data}catch(T){throw l.value=T.message,T}finally{i.value=!1}},f=async(F,T)=>{i.value=!0,l.value=null;try{const N=await ya.update(F,T),B=e.value.findIndex(q=>q.id===F);return B!==-1&&(e.value[B]=N.data),t.value?.id===F&&(t.value=N.data),N.data}catch(N){throw l.value=N.message,N}finally{i.value=!1}},g=async F=>{i.value=!0,l.value=null;try{await ya.delete(F),e.value=e.value.filter(T=>T.id!==F)}catch(T){throw l.value=T.message,T}finally{i.value=!1}},y=async F=>{i.value=!0,l.value=null;try{const T=await Yn.getByEvent(F);o.value=T.data}catch(T){throw l.value=T.message,T}finally{i.value=!1}};return{events:e,currentEvent:t,locations:o,assignments:a,eventStatus:s,loading:i,error:l,fetchEvents:u,fetchEvent:d,createEvent:p,updateEvent:f,deleteEvent:g,fetchLocations:y,createLocation:async F=>{i.value=!0,l.value=null;try{const T=await Yn.create(F);return o.value.push(T.data),T.data}catch(T){throw l.value=T.message,T}finally{i.value=!1}},updateLocation:async(F,T,N)=>{i.value=!0,l.value=null;try{const B=await Yn.update(F,T,N),q=o.value.findIndex(P=>P.id===T);return q!==-1&&(o.value[q]=B.data),B.data}catch(B){throw l.value=B.message,B}finally{i.value=!1}},deleteLocation:async(F,T)=>{i.value=!0,l.value=null;try{await Yn.delete(F,T),o.value=o.value.filter(N=>N.id!==T)}catch(N){throw l.value=N.message,N}finally{i.value=!1}},bulkUpdateLocationTimes:async(F,T)=>{i.value=!0,l.value=null;try{const N=await Yn.bulkUpdateTimes(F,T);return await y(F),N.data}catch(N){throw l.value=N.message,N}finally{i.value=!1}},fetchAssignments:async F=>{i.value=!0,l.value=null;try{const T=await hl.getByEvent(F);a.value=T.data}catch(T){throw l.value=T.message,T}finally{i.value=!1}},createAssignment:async F=>{i.value=!0,l.value=null;try{const T=await hl.create(F);return a.value.push(T.data),T.data}catch(T){throw l.value=T.message,T}finally{i.value=!1}},deleteAssignment:async(F,T)=>{i.value=!0,l.value=null;try{await hl.delete(F,T),a.value=a.value.filter(N=>N.id!==T)}catch(N){throw l.value=N.message,N}finally{i.value=!1}},fetchEventStatus:async F=>{i.value=!0,l.value=null;try{const T=await hl.getEventStatus(F);return s.value=T.data,T.data}catch(T){throw l.value=T.message,T}finally{i.value=!1}},updateAssignmentCheckIn:F=>{const T=a.value.findIndex(N=>N.id===F.id);T!==-1&&(a.value[T]=F),s.value&&s.value.locations.forEach(N=>{const B=N.assignments.findIndex(q=>q.id===F.id);B!==-1&&(N.assignments[B]=F,N.checkedInCount=N.assignments.filter(q=>q.isCheckedIn).length)})}}});function Fv(e="details",t=[]){const o=$(e),a=g=>{o.value=g},s=()=>{o.value=e},i=g=>o.value===g,l=V(()=>t.length===0?-1:t.indexOf(o.value)),u=(g=!1)=>{if(t.length===0)return;const y=l.value;if(y===-1)return;const _=y+1;_<t.length?o.value=t[_]:g&&(o.value=t[0])},d=(g=!1)=>{if(t.length===0)return;const y=l.value;if(y===-1)return;const _=y-1;_>=0?o.value=t[_]:g&&(o.value=t[t.length-1])},p=V(()=>{if(t.length===0)return!1;const g=l.value;return g!==-1&&g<t.length-1}),f=V(()=>t.length===0?!1:l.value>0);return{activeTab:o,activeTabIndex:l,hasNextTab:p,hasPreviousTab:f,switchTab:a,resetTab:s,isActiveTab:i,nextTab:u,previousTab:d}}function $b(){const e=$(!1),t=$(""),o=$(""),a=$(null),s=$(!1),i=$("OK");return{showConfirmModal:e,confirmModalTitle:t,confirmModalMessage:o,confirmModalIsDanger:s,confirmModalConfirmText:i,showConfirm:(f,g,y,_={})=>{t.value=f,o.value=g,a.value=y,s.value=_.isDanger||!1,i.value=_.confirmText||"OK",e.value=!0},handleConfirmModalConfirm:()=>{e.value=!1,a.value&&(a.value(),a.value=null)},handleConfirmModalCancel:()=>{e.value=!1,a.value=null},closeConfirmModal:()=>{e.value=!1,a.value=null}}}const Ti=$({people:"Marshals",checkpoint:"Checkpoints",area:"Areas",checklist:"Checklists",course:"Course"}),Bs={people:{People:{singular:"Person",plural:"People"},Marshals:{singular:"Marshal",plural:"Marshals"},Volunteers:{singular:"Volunteer",plural:"Volunteers"},Helpers:{singular:"Helper",plural:"Helpers"},Staff:{singular:"Staff member",plural:"Staff"},Stewards:{singular:"Steward",plural:"Stewards"},"Team members":{singular:"Team member",plural:"Team members"},Drivers:{singular:"Driver",plural:"Drivers"},Pilots:{singular:"Pilot",plural:"Pilots"}},checkpoint:{Checkpoints:{singular:"Checkpoint",plural:"Checkpoints"},Stations:{singular:"Station",plural:"Stations"},Locations:{singular:"Location",plural:"Locations"},"Feed stations":{singular:"Feed station",plural:"Feed stations"},"Aid stations":{singular:"Aid station",plural:"Aid stations"},"Water stations":{singular:"Water station",plural:"Water stations"},"Person points":{singular:null,plural:null,dynamic:!0}},area:{Areas:{singular:"Area",plural:"Areas"},Regions:{singular:"Region",plural:"Regions"},Zones:{singular:"Zone",plural:"Zones"}},checklist:{Checklists:{singular:"Checklist",plural:"Checklists"},Tasks:{singular:"Task",plural:"Tasks"},Jobs:{singular:"Job",plural:"Jobs"}},course:{Course:{singular:"Course",plural:"Courses"},Route:{singular:"Route",plural:"Routes"},Track:{singular:"Track",plural:"Tracks"},Trail:{singular:"Trail",plural:"Trails"},Path:{singular:"Path",plural:"Paths"}}},Os={people:["Drivers","Helpers","Marshals","People","Pilots","Staff","Stewards","Team members","Volunteers"],checkpoint:["Aid stations","Checkpoints","Feed stations","Locations","Person points","Stations","Water stations"],area:["Areas","Regions","Zones"],checklist:["Checklists","Jobs","Tasks"],course:["Course","Path","Route","Track","Trail"]};function Ja(e,t,o="Marshals"){if(!t)return"";const a=Bs[e]?.[t];return e==="checkpoint"&&t==="Person points"?`${Bs.people[o]?.singular||"Person"} point`:a?.singular?a.singular:t.endsWith("s")&&!t.endsWith("ss")?t.slice(0,-1):t}function Uv(e,t,o="Marshals"){if(!t)return"";const a=Bs[e]?.[t];return t==="Person points"?`${Bs.people[o]?.singular||"Person"} points`:a?.plural?a.plural:t}function Su(e,t){return e==="Person points"?`${Bs.people[t]?.singular||"Person"} points`:e}function xu(e){e&&(Ti.value={people:e.peopleTerm||"Marshals",checkpoint:e.checkpointTerm||"Checkpoints",area:e.areaTerm||"Areas",checklist:e.checklistTerm||"Checklists",course:e.courseTerm||"Course"})}const Ko=e=>e.toLowerCase(),Jo=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();function ut(){const e=f=>{const g=Ti.value[f],y=Bs[f]?.[g];if(f==="checkpoint"&&g==="Person points"){const _=Ti.value.people;return`${Bs.people[_]?.singular||"Person"} point`}return y?.singular||g},t=f=>{const g=Ti.value[f],y=Bs[f]?.[g];if(f==="checkpoint"&&g==="Person points"){const _=Ti.value.people;return`${Bs.people[_]?.singular||"Person"} points`}return y?.plural||g},o=V(()=>({person:e("people"),checkpoint:e("checkpoint"),area:e("area"),checklist:e("checklist"),course:e("course"),people:t("people"),checkpoints:t("checkpoint"),areas:t("area"),checklists:t("checklist"),courses:t("course")})),a=V(()=>({person:Ko(e("people")),checkpoint:Ko(e("checkpoint")),area:Ko(e("area")),checklist:Ko(e("checklist")),course:Ko(e("course")),people:Ko(t("people")),checkpoints:Ko(t("checkpoint")),areas:Ko(t("area")),checklists:Ko(t("checklist")),courses:Ko(t("course"))})),s=V(()=>({person:Jo(e("people")),checkpoint:Jo(e("checkpoint")),area:Jo(e("area")),checklist:Jo(e("checklist")),course:Jo(e("course")),people:Jo(t("people")),checkpoints:Jo(t("checkpoint")),areas:Jo(t("area")),checklists:Jo(t("checklist")),courses:Jo(t("course"))})),i=V(()=>({course:o.value.course,checkpoints:o.value.checkpoints,areas:o.value.areas,marshals:o.value.people,checklists:o.value.checklists,notes:"Notes",details:"Event details"}));return{terms:o,termsLower:a,termsSentence:s,tabLabels:i,singular:e,plural:t,formatCount:(f,g)=>g===1?`1 ${e(f)}`:`${g} ${t(f)}`,lower:(f,g=!0)=>Ko(g?t(f):e(f)),title:(f,g=!0)=>g?t(f):e(f),sentence:(f,g=!0)=>Jo(g?t(f):e(f)),terminology:Ti}}function Tb(){const e=$(!1),t=$(null),o=$({}),a=$(null),s=$(null),i=$([]),l=$(null),u=$(null),d=$(!1),p=$(!1),f=$(1),g=V(()=>t.value==="place-checkpoint"||t.value==="move-checkpoint"?a.value!==null:t.value==="draw-area"?s.value&&s.value.length>=3:t.value==="add-multiple"),y=X=>{if(X){const ne=X.getMapCenter?.(),K=X.getMapZoom?.();ne&&K!==null&&(l.value=ne,u.value=K)}},_=(X={})=>{a.value=null,e.value=!0,t.value="place-checkpoint",o.value={title:X.title||"Select checkpoint location",description:X.description||"Click on the map to set the location. Click again to reposition."}},k=(X,ne="checkpoint")=>{a.value=null,e.value=!0,t.value="move-checkpoint",o.value={title:`Move ${ne}: ${X}`,description:"Click on the map to set the new location"}},w=(X={})=>{e.value=!0,t.value="draw-area",d.value=!0,o.value={title:X.title||"Draw area boundary",description:X.description||"Click to add points. Click Done when finished to complete the area."}},S=(X=1)=>{f.value=X,i.value=[],e.value=!0,t.value="add-multiple",p.value=!0,o.value={title:"Add multiple checkpoints",description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},E=X=>{t.value==="place-checkpoint"||t.value==="move-checkpoint"?a.value=X:t.value==="add-multiple"&&A(X)},A=X=>{i.value.push({id:`temp-${f.value}`,name:`Checkpoint ${f.value}`,description:"",latitude:X.lat,longitude:X.lng,requiredMarshals:1,what3Words:"",assignments:[],isTemporary:!0}),f.value++,o.value={...o.value,description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},x=X=>{s.value=X},D=()=>s.value&&s.value.length>=3?s.value.map(X=>({lat:X.lat,lng:X.lng})):null,R=()=>{e.value=!1,t.value=null,o.value={},a.value=null,l.value=null,u.value=null,s.value=null,d.value&&(d.value=!1)};return{isFullscreenMapActive:e,fullscreenMode:t,fullscreenContext:o,tempLocationCoords:a,currentDrawingPolygon:s,tempCheckpoints:i,savedMapCenter:l,savedMapZoom:u,isDrawingAreaBoundary:d,isAddingMultipleCheckpoints:p,multiCheckpointCounter:f,canCompleteFullscreen:g,saveMapState:y,enterPlaceCheckpointMode:_,enterMoveCheckpointMode:k,enterDrawAreaMode:w,enterAddMultipleMode:S,handleFullscreenMapClick:E,handlePolygonDrawing:x,getCompletedPolygon:D,exitFullscreen:R,cancelFullscreen:()=>{t.value==="add-multiple"?(i.value=[],p.value=!1):t.value==="draw-area"&&(d.value=!1,s.value=null),R()},getTempCheckpoints:()=>[...i.value],clearTempCheckpoints:()=>{i.value=[],p.value=!1},getPlacedCoords:()=>a.value,createDisplayCheckpoints:(X,ne,K)=>V(()=>{const Q=[...X.value];return t.value==="place-checkpoint"&&a.value&&Q.push({id:"temp-single",name:ne.value?.name||"New Checkpoint",latitude:a.value.lat,longitude:a.value.lng,requiredMarshals:ne.value?.requiredMarshals||1,assignments:[],isTemporary:!0}),t.value==="move-checkpoint"&&a.value&&K.value&&Q.push({id:"temp-move",name:K.value.name+" (new position)",latitude:a.value.lat,longitude:a.value.lng,requiredMarshals:K.value.requiredMarshals,assignments:[],isTemporary:!0}),t.value==="add-multiple"&&Q.push(...i.value),Q}),createDisplayAreas:(X,ne)=>V(()=>{const K=[...X.value];if(t.value==="draw-area"&&ne.value?.polygon?.length>0){const Q=K.findIndex(he=>he.id===ne.value.id);Q>=0?K[Q]={...ne.value}:K.push({...ne.value,id:ne.value.id||"temp-area"})}return K}),calculateStartingNumber:X=>{const ne=X.value.map(K=>{const Q=K.name.match(/^Checkpoint (\d+)$/);return Q?parseInt(Q[1]):0}).filter(K=>K>0);return ne.length>0?Math.max(...ne)+1:1}}}function Mb(e){const t=$([]),o=$(!1);return{eventAdmins:t,showAddAdmin:o,loadEventAdmins:async()=>{try{const d=await Jc.getAdmins(e.value);return t.value=d.data,d.data}catch(d){throw console.error("Failed to load event admins:",d),d}},openAddAdminModal:()=>{o.value=!0},closeAddAdminModal:()=>{o.value=!1},addAdmin:async d=>{await Jc.addAdmin(e.value,d)},removeAdmin:async d=>{await Jc.removeAdmin(e.value,d)}}}function Ab(e){const t=$(!1),o=$(!1),a=$(!1),s=$(!1),i=$(!1),l=$(!1),u=$(null),d=$(null),p=$(null),f=$(null);return{showUploadRoute:t,showImportLocations:o,showImportMarshals:a,uploading:s,importing:i,importingMarshals:l,uploadError:u,importError:d,importResult:p,importMarshalsResult:f,openUploadRouteModal:()=>{u.value=null,t.value=!0},closeUploadRouteModal:()=>{t.value=!1,u.value=null},uploadRoute:async R=>{if(!R)return u.value="Please select a GPX file",null;s.value=!0,u.value=null;try{return await ya.uploadGpx(e.value,R),!0}catch(F){return console.error("Failed to upload route:",F),u.value=F.response?.data?.message||"Failed to upload route. Please try again.",null}finally{s.value=!1}},openImportLocationsModal:()=>{d.value=null,p.value=null,o.value=!0},closeImportLocationsModal:()=>{o.value=!1,d.value=null,p.value=null},importLocations:async(R,F)=>{if(!R)return d.value="Please select a CSV file",null;i.value=!0,d.value=null,p.value=null;try{const T=await Yn.importCsv(e.value,R,F);return p.value=T.data,T.data}catch(T){return console.error("Failed to import locations:",T),d.value=T.response?.data?.message||"Failed to import locations. Please try again.",null}finally{i.value=!1}},openImportMarshalsModal:()=>{d.value=null,f.value=null,a.value=!0},closeImportMarshalsModal:()=>{a.value=!1,d.value=null,f.value=null},importMarshals:async R=>{if(!R)return d.value="Please select a CSV file",null;l.value=!0,d.value=null,f.value=null;try{const F=await ms.importCsv(e.value,R);return f.value=F.data,F.data}catch(F){return console.error("Failed to import marshals:",F),d.value=F.response?.data?.message||"Failed to import marshals. Please try again.",null}finally{l.value=!1}},formatImportResultMessage:(R,F="location")=>{const T=F==="location"?"location(s)":"marshal(s)";let B=`<p>Created <strong>${R[F==="location"?"locationsCreated":"marshalsCreated"]}</strong> ${T} and <strong>${R.assignmentsCreated}</strong> assignment(s)</p>`;return R.errors&&R.errors.length>0&&(B+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',R.errors.forEach(q=>{B+=`<li>${q}</li>`}),B+="</ul>"),B}}}const zv="admin-theme-preference",qa=$(Eb());function Eb(){return typeof window>"u"?"system":localStorage.getItem(zv)||"system"}function Pb(e){localStorage.setItem(zv,e)}function Hv(){const e=V(()=>qa.value==="system"?"light dark":qa.value),t=(s,i=!0)=>{i&&typeof document<"u"&&(document.documentElement.classList.add("theme-transitioning"),setTimeout(()=>{document.documentElement.classList.remove("theme-transitioning")},1e3)),qa.value=s,Pb(s)},o=()=>{const s=["system","light","dark"],l=(s.indexOf(qa.value)+1)%s.length;t(s[l])},a=V(()=>qa.value==="dark"?!0:qa.value==="light"?!1:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1);return{theme:qa,colorScheme:e,isDark:a,setTheme:t,cycleTheme:o}}const Vv=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",Bl=e=>{if(!e)return"";const t=new Date(e),o=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0");return`${o}-${a}-${s}T${i}:${l}`},zr=e=>{if(!e||e.trim()==="")return!0;if(!/^[a-z]{1,20}[./][a-z]{1,20}[./][a-z]{1,20}$/.test(e))return!1;const o=e.includes("."),a=e.includes("/");return o!==a},Db=(e,t,o,a)=>{const i=e*Math.PI/180,l=o*Math.PI/180,u=(o-e)*Math.PI/180,d=(a-t)*Math.PI/180,p=Math.sin(u/2)*Math.sin(u/2)+Math.cos(i)*Math.cos(l)*Math.sin(d/2)*Math.sin(d/2);return 6371e3*(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)))},Rb=e=>!e&&e!==0?"":e<1e3?`${Math.round(e)} m`:`${(e/1e3).toFixed(2)} km`;function Ob(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var fl={exports:{}};var Bb=fl.exports,Qh;function Nb(){return Qh||(Qh=1,(function(e,t){(function(o,a){a(t)})(Bb,(function(o){var a="1.9.4";function s(n){var c,h,b,I;for(h=1,b=arguments.length;h<b;h++){I=arguments[h];for(c in I)n[c]=I[c]}return n}var i=Object.create||(function(){function n(){}return function(c){return n.prototype=c,new n}})();function l(n,c){var h=Array.prototype.slice;if(n.bind)return n.bind.apply(n,h.call(arguments,1));var b=h.call(arguments,2);return function(){return n.apply(c,b.length?b.concat(h.call(arguments)):arguments)}}var u=0;function d(n){return"_leaflet_id"in n||(n._leaflet_id=++u),n._leaflet_id}function p(n,c,h){var b,I,z,oe;return oe=function(){b=!1,I&&(z.apply(h,I),I=!1)},z=function(){b?I=arguments:(n.apply(h,arguments),setTimeout(oe,c),b=!0)},z}function f(n,c,h){var b=c[1],I=c[0],z=b-I;return n===b&&h?n:((n-I)%z+z)%z+I}function g(){return!1}function y(n,c){if(c===!1)return n;var h=Math.pow(10,c===void 0?6:c);return Math.round(n*h)/h}function _(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function k(n){return _(n).split(/\s+/)}function w(n,c){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?i(n.options):{});for(var h in c)n.options[h]=c[h];return n.options}function S(n,c,h){var b=[];for(var I in n)b.push(encodeURIComponent(h?I.toUpperCase():I)+"="+encodeURIComponent(n[I]));return(!c||c.indexOf("?")===-1?"?":"&")+b.join("&")}var E=/\{ *([\w_ -]+) *\}/g;function A(n,c){return n.replace(E,function(h,b){var I=c[b];if(I===void 0)throw new Error("No value provided for variable "+h);return typeof I=="function"&&(I=I(c)),I})}var x=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function D(n,c){for(var h=0;h<n.length;h++)if(n[h]===c)return h;return-1}var R="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function F(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var T=0;function N(n){var c=+new Date,h=Math.max(0,16-(c-T));return T=c+h,window.setTimeout(n,h)}var B=window.requestAnimationFrame||F("RequestAnimationFrame")||N,q=window.cancelAnimationFrame||F("CancelAnimationFrame")||F("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function P(n,c,h){if(h&&B===N)n.call(c);else return B.call(window,l(n,c))}function G(n){n&&q.call(window,n)}var X={__proto__:null,extend:s,create:i,bind:l,get lastId(){return u},stamp:d,throttle:p,wrapNum:f,falseFn:g,formatNum:y,trim:_,splitWords:k,setOptions:w,getParamString:S,template:A,isArray:x,indexOf:D,emptyImageUrl:R,requestFn:B,cancelFn:q,requestAnimFrame:P,cancelAnimFrame:G};function ne(){}ne.extend=function(n){var c=function(){w(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=c.__super__=this.prototype,b=i(h);b.constructor=c,c.prototype=b;for(var I in this)Object.prototype.hasOwnProperty.call(this,I)&&I!=="prototype"&&I!=="__super__"&&(c[I]=this[I]);return n.statics&&s(c,n.statics),n.includes&&(K(n.includes),s.apply(null,[b].concat(n.includes))),s(b,n),delete b.statics,delete b.includes,b.options&&(b.options=h.options?i(h.options):{},s(b.options,n.options)),b._initHooks=[],b.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var z=0,oe=b._initHooks.length;z<oe;z++)b._initHooks[z].call(this)}},c},ne.include=function(n){var c=this.prototype.options;return s(this.prototype,n),n.options&&(this.prototype.options=c,this.mergeOptions(n.options)),this},ne.mergeOptions=function(n){return s(this.prototype.options,n),this},ne.addInitHook=function(n){var c=Array.prototype.slice.call(arguments,1),h=typeof n=="function"?n:function(){this[n].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function K(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=x(n)?n:[n];for(var c=0;c<n.length;c++)n[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Q={on:function(n,c,h){if(typeof n=="object")for(var b in n)this._on(b,n[b],c);else{n=k(n);for(var I=0,z=n.length;I<z;I++)this._on(n[I],c,h)}return this},off:function(n,c,h){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var b in n)this._off(b,n[b],c);else{n=k(n);for(var I=arguments.length===1,z=0,oe=n.length;z<oe;z++)I?this._off(n[z]):this._off(n[z],c,h)}return this},_on:function(n,c,h,b){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(n,c,h)===!1){h===this&&(h=void 0);var I={fn:c,ctx:h};b&&(I.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(I)}},_off:function(n,c,h){var b,I,z;if(this._events&&(b=this._events[n],!!b)){if(arguments.length===1){if(this._firingCount)for(I=0,z=b.length;I<z;I++)b[I].fn=g;delete this._events[n];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var oe=this._listens(n,c,h);if(oe!==!1){var _e=b[oe];this._firingCount&&(_e.fn=g,this._events[n]=b=b.slice()),b.splice(oe,1)}}},fire:function(n,c,h){if(!this.listens(n,h))return this;var b=s({},c,{type:n,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var I=this._events[n];if(I){this._firingCount=this._firingCount+1||1;for(var z=0,oe=I.length;z<oe;z++){var _e=I[z],Ie=_e.fn;_e.once&&this.off(n,Ie,_e.ctx),Ie.call(_e.ctx||this,b)}this._firingCount--}}return h&&this._propagateEvent(b),this},listens:function(n,c,h,b){typeof n!="string"&&console.warn('"string" type argument expected');var I=c;typeof c!="function"&&(b=!!c,I=void 0,h=void 0);var z=this._events&&this._events[n];if(z&&z.length&&this._listens(n,I,h)!==!1)return!0;if(b){for(var oe in this._eventParents)if(this._eventParents[oe].listens(n,c,h,b))return!0}return!1},_listens:function(n,c,h){if(!this._events)return!1;var b=this._events[n]||[];if(!c)return!!b.length;h===this&&(h=void 0);for(var I=0,z=b.length;I<z;I++)if(b[I].fn===c&&b[I].ctx===h)return I;return!1},once:function(n,c,h){if(typeof n=="object")for(var b in n)this._on(b,n[b],c,!0);else{n=k(n);for(var I=0,z=n.length;I<z;I++)this._on(n[I],c,h,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[d(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[d(n)],this},_propagateEvent:function(n){for(var c in this._eventParents)this._eventParents[c].fire(n.type,s({layer:n.target,propagatedFrom:n.target},n),!0)}};Q.addEventListener=Q.on,Q.removeEventListener=Q.clearAllEventListeners=Q.off,Q.addOneTimeEventListener=Q.once,Q.fireEvent=Q.fire,Q.hasEventListeners=Q.listens;var he=ne.extend(Q);function U(n,c,h){this.x=h?Math.round(n):n,this.y=h?Math.round(c):c}var ee=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};U.prototype={clone:function(){return new U(this.x,this.y)},add:function(n){return this.clone()._add(fe(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(fe(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new U(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new U(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ee(this.x),this.y=ee(this.y),this},distanceTo:function(n){n=fe(n);var c=n.x-this.x,h=n.y-this.y;return Math.sqrt(c*c+h*h)},equals:function(n){return n=fe(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=fe(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+y(this.x)+", "+y(this.y)+")"}};function fe(n,c,h){return n instanceof U?n:x(n)?new U(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new U(n.x,n.y):new U(n,c,h)}function ue(n,c){if(n)for(var h=c?[n,c]:n,b=0,I=h.length;b<I;b++)this.extend(h[b])}ue.prototype={extend:function(n){var c,h;if(!n)return this;if(n instanceof U||typeof n[0]=="number"||"x"in n)c=h=fe(n);else if(n=De(n),c=n.min,h=n.max,!c||!h)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=h.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(n){return fe((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return fe(this.min.x,this.max.y)},getTopRight:function(){return fe(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var c,h;return typeof n[0]=="number"||n instanceof U?n=fe(n):n=De(n),n instanceof ue?(c=n.min,h=n.max):c=h=n,c.x>=this.min.x&&h.x<=this.max.x&&c.y>=this.min.y&&h.y<=this.max.y},intersects:function(n){n=De(n);var c=this.min,h=this.max,b=n.min,I=n.max,z=I.x>=c.x&&b.x<=h.x,oe=I.y>=c.y&&b.y<=h.y;return z&&oe},overlaps:function(n){n=De(n);var c=this.min,h=this.max,b=n.min,I=n.max,z=I.x>c.x&&b.x<h.x,oe=I.y>c.y&&b.y<h.y;return z&&oe},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var c=this.min,h=this.max,b=Math.abs(c.x-h.x)*n,I=Math.abs(c.y-h.y)*n;return De(fe(c.x-b,c.y-I),fe(h.x+b,h.y+I))},equals:function(n){return n?(n=De(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function De(n,c){return!n||n instanceof ue?n:new ue(n,c)}function et(n,c){if(n)for(var h=c?[n,c]:n,b=0,I=h.length;b<I;b++)this.extend(h[b])}et.prototype={extend:function(n){var c=this._southWest,h=this._northEast,b,I;if(n instanceof Ze)b=n,I=n;else if(n instanceof et){if(b=n._southWest,I=n._northEast,!b||!I)return this}else return n?this.extend(He(n)||Je(n)):this;return!c&&!h?(this._southWest=new Ze(b.lat,b.lng),this._northEast=new Ze(I.lat,I.lng)):(c.lat=Math.min(b.lat,c.lat),c.lng=Math.min(b.lng,c.lng),h.lat=Math.max(I.lat,h.lat),h.lng=Math.max(I.lng,h.lng)),this},pad:function(n){var c=this._southWest,h=this._northEast,b=Math.abs(c.lat-h.lat)*n,I=Math.abs(c.lng-h.lng)*n;return new et(new Ze(c.lat-b,c.lng-I),new Ze(h.lat+b,h.lng+I))},getCenter:function(){return new Ze((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Ze(this.getNorth(),this.getWest())},getSouthEast:function(){return new Ze(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof Ze||"lat"in n?n=He(n):n=Je(n);var c=this._southWest,h=this._northEast,b,I;return n instanceof et?(b=n.getSouthWest(),I=n.getNorthEast()):b=I=n,b.lat>=c.lat&&I.lat<=h.lat&&b.lng>=c.lng&&I.lng<=h.lng},intersects:function(n){n=Je(n);var c=this._southWest,h=this._northEast,b=n.getSouthWest(),I=n.getNorthEast(),z=I.lat>=c.lat&&b.lat<=h.lat,oe=I.lng>=c.lng&&b.lng<=h.lng;return z&&oe},overlaps:function(n){n=Je(n);var c=this._southWest,h=this._northEast,b=n.getSouthWest(),I=n.getNorthEast(),z=I.lat>c.lat&&b.lat<h.lat,oe=I.lng>c.lng&&b.lng<h.lng;return z&&oe},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,c){return n?(n=Je(n),this._southWest.equals(n.getSouthWest(),c)&&this._northEast.equals(n.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Je(n,c){return n instanceof et?n:new et(n,c)}function Ze(n,c,h){if(isNaN(n)||isNaN(c))throw new Error("Invalid LatLng object: ("+n+", "+c+")");this.lat=+n,this.lng=+c,h!==void 0&&(this.alt=+h)}Ze.prototype={equals:function(n,c){if(!n)return!1;n=He(n);var h=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return h<=(c===void 0?1e-9:c)},toString:function(n){return"LatLng("+y(this.lat,n)+", "+y(this.lng,n)+")"},distanceTo:function(n){return Ve.distance(this,He(n))},wrap:function(){return Ve.wrapLatLng(this)},toBounds:function(n){var c=180*n/40075017,h=c/Math.cos(Math.PI/180*this.lat);return Je([this.lat-c,this.lng-h],[this.lat+c,this.lng+h])},clone:function(){return new Ze(this.lat,this.lng,this.alt)}};function He(n,c,h){return n instanceof Ze?n:x(n)&&typeof n[0]!="object"?n.length===3?new Ze(n[0],n[1],n[2]):n.length===2?new Ze(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new Ze(n.lat,"lng"in n?n.lng:n.lon,n.alt):c===void 0?null:new Ze(n,c,h)}var be={latLngToPoint:function(n,c){var h=this.projection.project(n),b=this.scale(c);return this.transformation._transform(h,b)},pointToLatLng:function(n,c){var h=this.scale(c),b=this.transformation.untransform(n,h);return this.projection.unproject(b)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var c=this.projection.bounds,h=this.scale(n),b=this.transformation.transform(c.min,h),I=this.transformation.transform(c.max,h);return new ue(b,I)},infinite:!1,wrapLatLng:function(n){var c=this.wrapLng?f(n.lng,this.wrapLng,!0):n.lng,h=this.wrapLat?f(n.lat,this.wrapLat,!0):n.lat,b=n.alt;return new Ze(h,c,b)},wrapLatLngBounds:function(n){var c=n.getCenter(),h=this.wrapLatLng(c),b=c.lat-h.lat,I=c.lng-h.lng;if(b===0&&I===0)return n;var z=n.getSouthWest(),oe=n.getNorthEast(),_e=new Ze(z.lat-b,z.lng-I),Ie=new Ze(oe.lat-b,oe.lng-I);return new et(_e,Ie)}},Ve=s({},be,{wrapLng:[-180,180],R:6371e3,distance:function(n,c){var h=Math.PI/180,b=n.lat*h,I=c.lat*h,z=Math.sin((c.lat-n.lat)*h/2),oe=Math.sin((c.lng-n.lng)*h/2),_e=z*z+Math.cos(b)*Math.cos(I)*oe*oe,Ie=2*Math.atan2(Math.sqrt(_e),Math.sqrt(1-_e));return this.R*Ie}}),ve=6378137,Le={R:ve,MAX_LATITUDE:85.0511287798,project:function(n){var c=Math.PI/180,h=this.MAX_LATITUDE,b=Math.max(Math.min(h,n.lat),-h),I=Math.sin(b*c);return new U(this.R*n.lng*c,this.R*Math.log((1+I)/(1-I))/2)},unproject:function(n){var c=180/Math.PI;return new Ze((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*c,n.x*c/this.R)},bounds:(function(){var n=ve*Math.PI;return new ue([-n,-n],[n,n])})()};function Pe(n,c,h,b){if(x(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=c,this._c=h,this._d=b}Pe.prototype={transform:function(n,c){return this._transform(n.clone(),c)},_transform:function(n,c){return c=c||1,n.x=c*(this._a*n.x+this._b),n.y=c*(this._c*n.y+this._d),n},untransform:function(n,c){return c=c||1,new U((n.x/c-this._b)/this._a,(n.y/c-this._d)/this._c)}};function W(n,c,h,b){return new Pe(n,c,h,b)}var Y=s({},Ve,{code:"EPSG:3857",projection:Le,transformation:(function(){var n=.5/(Math.PI*Le.R);return W(n,.5,-n,.5)})()}),pe=s({},Y,{code:"EPSG:900913"});function Ce(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function le(n,c){var h="",b,I,z,oe,_e,Ie;for(b=0,z=n.length;b<z;b++){for(_e=n[b],I=0,oe=_e.length;I<oe;I++)Ie=_e[I],h+=(I?"L":"M")+Ie.x+" "+Ie.y;h+=c?Ge.svg?"z":"x":""}return h||"M0 0"}var J=document.documentElement.style,j="ActiveXObject"in window,te=j&&!document.addEventListener,Re="msLaunchUri"in navigator&&!("documentMode"in document),Se=ot("webkit"),we=ot("android"),ge=ot("android 2")||ot("android 3"),Z=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),se=we&&ot("Google")&&Z<537&&!("AudioNode"in window),ce=!!window.opera,Te=!Re&&ot("chrome"),Oe=ot("gecko")&&!Se&&!ce&&!j,Be=!Te&&ot("safari"),Xe=ot("phantom"),mt="OTransition"in J,_t=navigator.platform.indexOf("Win")===0,bt=j&&"transition"in J,Mt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ge,wt="MozPerspective"in J,Nt=!window.L_DISABLE_3D&&(bt||Mt||wt)&&!mt&&!Xe,Ft=typeof orientation<"u"||ot("mobile"),Fn=Ft&&Se,Qn=Ft&&Mt,fn=!window.PointerEvent&&window.MSPointerEvent,jt=!!(window.PointerEvent||fn),yt="ontouchstart"in window||!!window.TouchEvent,eo=!window.L_NO_TOUCH&&(yt||jt),Un=Ft&&ce,to=Ft&&Oe,pn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Zt=(function(){var n=!1;try{var c=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",g,c),window.removeEventListener("testPassiveEventSupport",g,c)}catch{}return n})(),ks=(function(){return!!document.createElement("canvas").getContext})(),no=!!(document.createElementNS&&Ce("svg").createSVGRect),Co=!!no&&(function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),ie=!no&&(function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var c=n.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}})(),re=navigator.platform.indexOf("Mac")===0,me=navigator.platform.indexOf("Linux")===0;function ot(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var Ge={ie:j,ielt9:te,edge:Re,webkit:Se,android:we,android23:ge,androidStock:se,opera:ce,chrome:Te,gecko:Oe,safari:Be,phantom:Xe,opera12:mt,win:_t,ie3d:bt,webkit3d:Mt,gecko3d:wt,any3d:Nt,mobile:Ft,mobileWebkit:Fn,mobileWebkit3d:Qn,msPointer:fn,pointer:jt,touch:eo,touchNative:yt,mobileOpera:Un,mobileGecko:to,retina:pn,passiveEvents:Zt,canvas:ks,svg:no,vml:ie,inlineSvg:Co,mac:re,linux:me},St=Ge.msPointer?"MSPointerDown":"pointerdown",Wt=Ge.msPointer?"MSPointerMove":"pointermove",Qt=Ge.msPointer?"MSPointerUp":"pointerup",Do=Ge.msPointer?"MSPointerCancel":"pointercancel",uo={touchstart:St,touchmove:Wt,touchend:Qt,touchcancel:Do},Ro={touchstart:So,touchmove:on,touchend:on,touchcancel:on},zn={},Ta=!1;function Oo(n,c,h){return c==="touchstart"&&Bo(),Ro[c]?(h=Ro[c].bind(this,h),n.addEventListener(uo[c],h,!1),h):(console.warn("wrong event specified:",c),g)}function Lo(n,c,h){if(!uo[c]){console.warn("wrong event specified:",c);return}n.removeEventListener(uo[c],h,!1)}function Zs(n){zn[n.pointerId]=n}function qs(n){zn[n.pointerId]&&(zn[n.pointerId]=n)}function vn(n){delete zn[n.pointerId]}function Bo(){Ta||(document.addEventListener(St,Zs,!0),document.addEventListener(Wt,qs,!0),document.addEventListener(Qt,vn,!0),document.addEventListener(Do,vn,!0),Ta=!0)}function on(n,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var h in zn)c.touches.push(zn[h]);c.changedTouches=[c],n(c)}}function So(n,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&Kt(c),on(n,c)}function ho(n){var c={},h,b;for(b in n)h=n[b],c[b]=h&&h.bind?h.bind(n):h;return n=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var _s=200;function xo(n,c){n.addEventListener("dblclick",c);var h=0,b;function I(z){if(z.detail!==1){b=z.detail;return}if(!(z.pointerType==="mouse"||z.sourceCapabilities&&!z.sourceCapabilities.firesTouchEvents)){var oe=Ra(z);if(!(oe.some(function(Ie){return Ie instanceof HTMLLabelElement&&Ie.attributes.for})&&!oe.some(function(Ie){return Ie instanceof HTMLInputElement||Ie instanceof HTMLSelectElement}))){var _e=Date.now();_e-h<=_s?(b++,b===2&&c(ho(z))):b=1,h=_e}}}return n.addEventListener("click",I),{dblclick:c,simDblclick:I}}function bs(n,c){n.removeEventListener("dblclick",c.dblclick),n.removeEventListener("click",c.simDblclick)}var Io=Ws(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),No=Ws(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),mn=No==="webkitTransition"||No==="OTransition"?No+"End":"transitionend";function $o(n){return typeof n=="string"?document.getElementById(n):n}function Hn(n,c){var h=n.style[c]||n.currentStyle&&n.currentStyle[c];if((!h||h==="auto")&&document.defaultView){var b=document.defaultView.getComputedStyle(n,null);h=b?b[c]:null}return h==="auto"?null:h}function vt(n,c,h){var b=document.createElement(n);return b.className=c||"",h&&h.appendChild(b),b}function xt(n){var c=n.parentNode;c&&c.removeChild(n)}function To(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function fo(n){var c=n.parentNode;c&&c.lastChild!==n&&c.appendChild(n)}function Fo(n){var c=n.parentNode;c&&c.firstChild!==n&&c.insertBefore(n,c.firstChild)}function Ma(n,c){if(n.classList!==void 0)return n.classList.contains(c);var h=Uo(n);return h.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(h)}function ht(n,c){if(n.classList!==void 0)for(var h=k(c),b=0,I=h.length;b<I;b++)n.classList.add(h[b]);else if(!Ma(n,c)){var z=Uo(n);Aa(n,(z?z+" ":"")+c)}}function Ut(n,c){n.classList!==void 0?n.classList.remove(c):Aa(n,_((" "+Uo(n)+" ").replace(" "+c+" "," ")))}function Aa(n,c){n.className.baseVal===void 0?n.className=c:n.className.baseVal=c}function Uo(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function gn(n,c){"opacity"in n.style?n.style.opacity=c:"filter"in n.style&&ri(n,c)}function ri(n,c){var h=!1,b="DXImageTransform.Microsoft.Alpha";try{h=n.filters.item(b)}catch{if(c===1)return}c=Math.round(c*100),h?(h.Enabled=c!==100,h.Opacity=c):n.style.filter+=" progid:"+b+"(opacity="+c+")"}function Ws(n){for(var c=document.documentElement.style,h=0;h<n.length;h++)if(n[h]in c)return n[h];return!1}function po(n,c,h){var b=c||new U(0,0);n.style[Io]=(Ge.ie3d?"translate("+b.x+"px,"+b.y+"px)":"translate3d("+b.x+"px,"+b.y+"px,0)")+(h?" scale("+h+")":"")}function qt(n,c){n._leaflet_pos=c,Ge.any3d?po(n,c):(n.style.left=c.x+"px",n.style.top=c.y+"px")}function zo(n){return n._leaflet_pos||new U(0,0)}var yn,In,Ea;if("onselectstart"in document)yn=function(){lt(window,"selectstart",Kt)},In=function(){It(window,"selectstart",Kt)};else{var kn=Ws(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);yn=function(){if(kn){var n=document.documentElement.style;Ea=n[kn],n[kn]="none"}},In=function(){kn&&(document.documentElement.style[kn]=Ea,Ea=void 0)}}function Pa(){lt(window,"dragstart",Kt)}function zt(){It(window,"dragstart",Kt)}var ws,Ks;function Js(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(Ys(),ws=n,Ks=n.style.outlineStyle,n.style.outlineStyle="none",lt(window,"keydown",Ys))}function Ys(){ws&&(ws.style.outlineStyle=Ks,ws=void 0,Ks=void 0,It(window,"keydown",Ys))}function Da(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function $n(n){var c=n.getBoundingClientRect();return{x:c.width/n.offsetWidth||1,y:c.height/n.offsetHeight||1,boundingClientRect:c}}var Ho={__proto__:null,TRANSFORM:Io,TRANSITION:No,TRANSITION_END:mn,get:$o,getStyle:Hn,create:vt,remove:xt,empty:To,toFront:fo,toBack:Fo,hasClass:Ma,addClass:ht,removeClass:Ut,setClass:Aa,getClass:Uo,setOpacity:gn,testProp:Ws,setTransform:po,setPosition:qt,getPosition:zo,get disableTextSelection(){return yn},get enableTextSelection(){return In},disableImageDrag:Pa,enableImageDrag:zt,preventOutline:Js,restoreOutline:Ys,getSizedParentNode:Da,getScale:$n};function lt(n,c,h,b){if(c&&typeof c=="object")for(var I in c)mo(n,I,c[I],h);else{c=k(c);for(var z=0,oe=c.length;z<oe;z++)mo(n,c[z],h,b)}return this}var _n="_leaflet_events";function It(n,c,h,b){if(arguments.length===1)oo(n),delete n[_n];else if(c&&typeof c=="object")for(var I in c)is(n,I,c[I],h);else if(c=k(c),arguments.length===2)oo(n,function(_e){return D(c,_e)!==-1});else for(var z=0,oe=c.length;z<oe;z++)is(n,c[z],h,b);return this}function oo(n,c){for(var h in n[_n]){var b=h.split(/\d/)[0];(!c||c(b))&&is(n,b,null,null,h)}}var vo={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function mo(n,c,h,b){var I=c+d(h)+(b?"_"+d(b):"");if(n[_n]&&n[_n][I])return this;var z=function(_e){return h.call(b||n,_e||window.event)},oe=z;!Ge.touchNative&&Ge.pointer&&c.indexOf("touch")===0?z=Oo(n,c,z):Ge.touch&&c==="dblclick"?z=xo(n,z):"addEventListener"in n?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?n.addEventListener(vo[c]||c,z,Ge.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(z=function(_e){_e=_e||window.event,ea(n,_e)&&oe(_e)},n.addEventListener(vo[c],z,!1)):n.addEventListener(c,oe,!1):n.attachEvent("on"+c,z),n[_n]=n[_n]||{},n[_n][I]=z}function is(n,c,h,b,I){I=I||c+d(h)+(b?"_"+d(b):"");var z=n[_n]&&n[_n][I];if(!z)return this;!Ge.touchNative&&Ge.pointer&&c.indexOf("touch")===0?Lo(n,c,z):Ge.touch&&c==="dblclick"?bs(n,z):"removeEventListener"in n?n.removeEventListener(vo[c]||c,z,!1):n.detachEvent("on"+c,z),n[_n][I]=null}function go(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function Xs(n){return mo(n,"wheel",go),this}function Vo(n){return lt(n,"mousedown touchstart dblclick contextmenu",go),n._leaflet_disable_click=!0,this}function Kt(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function Go(n){return Kt(n),go(n),this}function Ra(n){if(n.composedPath)return n.composedPath();for(var c=[],h=n.target;h;)c.push(h),h=h.parentNode;return c}function Qs(n,c){if(!c)return new U(n.clientX,n.clientY);var h=$n(c),b=h.boundingClientRect;return new U((n.clientX-b.left)/h.x-c.clientLeft,(n.clientY-b.top)/h.y-c.clientTop)}var Wi=Ge.linux&&Ge.chrome?window.devicePixelRatio:Ge.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function ci(n){return Ge.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/Wi:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function ea(n,c){var h=c.relatedTarget;if(!h)return!0;try{for(;h&&h!==n;)h=h.parentNode}catch{return!1}return h!==n}var ui={__proto__:null,on:lt,off:It,stopPropagation:go,disableScrollPropagation:Xs,disableClickPropagation:Vo,preventDefault:Kt,stop:Go,getPropagationPath:Ra,getMousePosition:Qs,getWheelDelta:ci,isExternalTarget:ea,addListener:lt,removeListener:It},ta=he.extend({run:function(n,c,h,b){this.stop(),this._el=n,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(b||.5,.2),this._startPos=zo(n),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=P(this._animate,this),this._step()},_step:function(n){var c=+new Date-this._startTime,h=this._duration*1e3;c<h?this._runFrame(this._easeOut(c/h),n):(this._runFrame(1),this._complete())},_runFrame:function(n,c){var h=this._startPos.add(this._offset.multiplyBy(n));c&&h._round(),qt(this._el,h),this.fire("step")},_complete:function(){G(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),gt=he.extend({options:{crs:Y,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,c){c=w(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(He(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=No&&Ge.any3d&&!Ge.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),lt(this._proxy,mn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,c,h){if(c=c===void 0?this._zoom:this._limitZoom(c),n=this._limitCenter(He(n),c,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=s({animate:h.animate},h.zoom),h.pan=s({animate:h.animate,duration:h.duration},h.pan));var b=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,c,h.zoom):this._tryAnimatedPan(n,h.pan);if(b)return clearTimeout(this._sizeTimer),this}return this._resetView(n,c,h.pan&&h.pan.noMoveStart),this},setZoom:function(n,c){return this._loaded?this.setView(this.getCenter(),n,{zoom:c}):(this._zoom=n,this)},zoomIn:function(n,c){return n=n||(Ge.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,c)},zoomOut:function(n,c){return n=n||(Ge.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,c)},setZoomAround:function(n,c,h){var b=this.getZoomScale(c),I=this.getSize().divideBy(2),z=n instanceof U?n:this.latLngToContainerPoint(n),oe=z.subtract(I).multiplyBy(1-1/b),_e=this.containerPointToLatLng(I.add(oe));return this.setView(_e,c,{zoom:h})},_getBoundsCenterZoom:function(n,c){c=c||{},n=n.getBounds?n.getBounds():Je(n);var h=fe(c.paddingTopLeft||c.padding||[0,0]),b=fe(c.paddingBottomRight||c.padding||[0,0]),I=this.getBoundsZoom(n,!1,h.add(b));if(I=typeof c.maxZoom=="number"?Math.min(c.maxZoom,I):I,I===1/0)return{center:n.getCenter(),zoom:I};var z=b.subtract(h).divideBy(2),oe=this.project(n.getSouthWest(),I),_e=this.project(n.getNorthEast(),I),Ie=this.unproject(oe.add(_e).divideBy(2).add(z),I);return{center:Ie,zoom:I}},fitBounds:function(n,c){if(n=Je(n),!n.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(n,c);return this.setView(h.center,h.zoom,c)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,c){return this.setView(n,this._zoom,{pan:c})},panBy:function(n,c){if(n=fe(n).round(),c=c||{},!n.x&&!n.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ta,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){ht(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,h,c.duration||.25,c.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,c,h){if(h=h||{},h.animate===!1||!Ge.any3d)return this.setView(n,c,h);this._stop();var b=this.project(this.getCenter()),I=this.project(n),z=this.getSize(),oe=this._zoom;n=He(n),c=c===void 0?oe:c;var _e=Math.max(z.x,z.y),Ie=_e*this.getZoomScale(oe,c),Fe=I.distanceTo(b)||1,nt=1.42,ct=nt*nt;function kt(an){var ar=an?-1:1,hm=an?Ie:_e,fm=Ie*Ie-_e*_e+ar*ct*ct*Fe*Fe,pm=2*hm*ct*Fe,Tc=fm/pm,Sd=Math.sqrt(Tc*Tc+1)-Tc,vm=Sd<1e-9?-18:Math.log(Sd);return vm}function Zn(an){return(Math.exp(an)-Math.exp(-an))/2}function dn(an){return(Math.exp(an)+Math.exp(-an))/2}function Mo(an){return Zn(an)/dn(an)}var ao=kt(0);function Li(an){return _e*(dn(ao)/dn(ao+nt*an))}function rm(an){return _e*(dn(ao)*Mo(ao+nt*an)-Zn(ao))/ct}function cm(an){return 1-Math.pow(1-an,1.5)}var um=Date.now(),Cd=(kt(1)-ao)/nt,dm=h.duration?1e3*h.duration:1e3*Cd*.8;function Ld(){var an=(Date.now()-um)/dm,ar=cm(an)*Cd;an<=1?(this._flyToFrame=P(Ld,this),this._move(this.unproject(b.add(I.subtract(b).multiplyBy(rm(ar)/Fe)),oe),this.getScaleZoom(_e/Li(ar),oe),{flyTo:!0})):this._move(n,c)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),Ld.call(this),this},flyToBounds:function(n,c){var h=this._getBoundsCenterZoom(n,c);return this.flyTo(h.center,h.zoom,c)},setMaxBounds:function(n){return n=Je(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var c=this.options.minZoom;return this.options.minZoom=n,this._loaded&&c!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var c=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&c!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,c){this._enforcingBounds=!0;var h=this.getCenter(),b=this._limitCenter(h,this._zoom,Je(n));return h.equals(b)||this.panTo(b,c),this._enforcingBounds=!1,this},panInside:function(n,c){c=c||{};var h=fe(c.paddingTopLeft||c.padding||[0,0]),b=fe(c.paddingBottomRight||c.padding||[0,0]),I=this.project(this.getCenter()),z=this.project(n),oe=this.getPixelBounds(),_e=De([oe.min.add(h),oe.max.subtract(b)]),Ie=_e.getSize();if(!_e.contains(z)){this._enforcingBounds=!0;var Fe=z.subtract(_e.getCenter()),nt=_e.extend(z).getSize().subtract(Ie);I.x+=Fe.x<0?-nt.x:nt.x,I.y+=Fe.y<0?-nt.y:nt.y,this.panTo(this.unproject(I),c),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=s({animate:!1,pan:!0},n===!0?{animate:!0}:n);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),b=c.divideBy(2).round(),I=h.divideBy(2).round(),z=b.subtract(I);return!z.x&&!z.y?this:(n.animate&&n.pan?this.panBy(z):(n.pan&&this._rawPanBy(z),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=s({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=l(this._handleGeolocationResponse,this),h=l(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,h,n):navigator.geolocation.getCurrentPosition(c,h,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var c=n.code,h=n.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var c=n.coords.latitude,h=n.coords.longitude,b=new Ze(c,h),I=b.toBounds(n.coords.accuracy*2),z=this._locateOptions;if(z.setView){var oe=this.getBoundsZoom(I);this.setView(b,z.maxZoom?Math.min(oe,z.maxZoom):oe)}var _e={latlng:b,bounds:I,timestamp:n.timestamp};for(var Ie in n.coords)typeof n.coords[Ie]=="number"&&(_e[Ie]=n.coords[Ie]);this.fire("locationfound",_e)}},addHandler:function(n,c){if(!c)return this;var h=this[n]=new c(this);return this._handlers.push(h),this.options[n]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),xt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(G(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)xt(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,c){var h="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),b=vt("div",h,c||this._mapPane);return n&&(this._panes[n]=b),b},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),c=this.unproject(n.getBottomLeft()),h=this.unproject(n.getTopRight());return new et(c,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,c,h){n=Je(n),h=fe(h||[0,0]);var b=this.getZoom()||0,I=this.getMinZoom(),z=this.getMaxZoom(),oe=n.getNorthWest(),_e=n.getSouthEast(),Ie=this.getSize().subtract(h),Fe=De(this.project(_e,b),this.project(oe,b)).getSize(),nt=Ge.any3d?this.options.zoomSnap:1,ct=Ie.x/Fe.x,kt=Ie.y/Fe.y,Zn=c?Math.max(ct,kt):Math.min(ct,kt);return b=this.getScaleZoom(Zn,b),nt&&(b=Math.round(b/(nt/100))*(nt/100),b=c?Math.ceil(b/nt)*nt:Math.floor(b/nt)*nt),Math.max(I,Math.min(z,b))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new U(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,c){var h=this._getTopLeftPoint(n,c);return new ue(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,c){var h=this.options.crs;return c=c===void 0?this._zoom:c,h.scale(n)/h.scale(c)},getScaleZoom:function(n,c){var h=this.options.crs;c=c===void 0?this._zoom:c;var b=h.zoom(n*h.scale(c));return isNaN(b)?1/0:b},project:function(n,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(He(n),c)},unproject:function(n,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(fe(n),c)},layerPointToLatLng:function(n){var c=fe(n).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(n){var c=this.project(He(n))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(He(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(Je(n))},distance:function(n,c){return this.options.crs.distance(He(n),He(c))},containerPointToLayerPoint:function(n){return fe(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return fe(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var c=this.containerPointToLayerPoint(fe(n));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(He(n)))},mouseEventToContainerPoint:function(n){return Qs(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var c=this._container=$o(n);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");lt(c,"scroll",this._onScroll,this),this._containerId=d(c)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ge.any3d,ht(n,"leaflet-container"+(Ge.touch?" leaflet-touch":"")+(Ge.retina?" leaflet-retina":"")+(Ge.ielt9?" leaflet-oldie":"")+(Ge.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=Hn(n,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),qt(this._mapPane,new U(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ht(n.markerPane,"leaflet-zoom-hide"),ht(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,c,h){qt(this._mapPane,new U(0,0));var b=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var I=this._zoom!==c;this._moveStart(I,h)._move(n,c)._moveEnd(I),this.fire("viewreset"),b&&this.fire("load")},_moveStart:function(n,c){return n&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(n,c,h,b){c===void 0&&(c=this._zoom);var I=this._zoom!==c;return this._zoom=c,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),b?h&&h.pinch&&this.fire("zoom",h):((I||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return G(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){qt(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[d(this._container)]=this;var c=n?It:lt;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),Ge.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){G(this._resizeRequest),this._resizeRequest=P(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,c){for(var h=[],b,I=c==="mouseout"||c==="mouseover",z=n.target||n.srcElement,oe=!1;z;){if(b=this._targets[d(z)],b&&(c==="click"||c==="preclick")&&this._draggableMoved(b)){oe=!0;break}if(b&&b.listens(c,!0)&&(I&&!ea(z,n)||(h.push(b),I))||z===this._container)break;z=z.parentNode}return!h.length&&!oe&&!I&&this.listens(c,!0)&&(h=[this]),h},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var c=n.target||n.srcElement;if(!(!this._loaded||c._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(c))){var h=n.type;h==="mousedown"&&Js(c),this._fireDOMEvent(n,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,c,h){if(n.type==="click"){var b=s({},n);b.type="preclick",this._fireDOMEvent(b,b.type,h)}var I=this._findEventTargets(n,c);if(h){for(var z=[],oe=0;oe<h.length;oe++)h[oe].listens(c,!0)&&z.push(h[oe]);I=z.concat(I)}if(I.length){c==="contextmenu"&&Kt(n);var _e=I[0],Ie={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var Fe=_e.getLatLng&&(!_e._radius||_e._radius<=10);Ie.containerPoint=Fe?this.latLngToContainerPoint(_e.getLatLng()):this.mouseEventToContainerPoint(n),Ie.layerPoint=this.containerPointToLayerPoint(Ie.containerPoint),Ie.latlng=Fe?_e.getLatLng():this.layerPointToLatLng(Ie.layerPoint)}for(oe=0;oe<I.length;oe++)if(I[oe].fire(c,Ie,!0),Ie.originalEvent._stopped||I[oe].options.bubblingMouseEvents===!1&&D(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,c=this._handlers.length;n<c;n++)this._handlers[n].disable()},whenReady:function(n,c){return this._loaded?n.call(c||this,{target:this}):this.on("load",n,c),this},_getMapPanePos:function(){return zo(this._mapPane)||new U(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,c){var h=n&&c!==void 0?this._getNewPixelOrigin(n,c):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,c){var h=this.getSize()._divideBy(2);return this.project(n,c)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,c,h){var b=this._getNewPixelOrigin(h,c);return this.project(n,c)._subtract(b)},_latLngBoundsToNewLayerBounds:function(n,c,h){var b=this._getNewPixelOrigin(h,c);return De([this.project(n.getSouthWest(),c)._subtract(b),this.project(n.getNorthWest(),c)._subtract(b),this.project(n.getSouthEast(),c)._subtract(b),this.project(n.getNorthEast(),c)._subtract(b)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,c,h){if(!h)return n;var b=this.project(n,c),I=this.getSize().divideBy(2),z=new ue(b.subtract(I),b.add(I)),oe=this._getBoundsOffset(z,h,c);return Math.abs(oe.x)<=1&&Math.abs(oe.y)<=1?n:this.unproject(b.add(oe),c)},_limitOffset:function(n,c){if(!c)return n;var h=this.getPixelBounds(),b=new ue(h.min.add(n),h.max.add(n));return n.add(this._getBoundsOffset(b,c))},_getBoundsOffset:function(n,c,h){var b=De(this.project(c.getNorthEast(),h),this.project(c.getSouthWest(),h)),I=b.min.subtract(n.min),z=b.max.subtract(n.max),oe=this._rebound(I.x,-z.x),_e=this._rebound(I.y,-z.y);return new U(oe,_e)},_rebound:function(n,c){return n+c>0?Math.round(n-c)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(c))},_limitZoom:function(n){var c=this.getMinZoom(),h=this.getMaxZoom(),b=Ge.any3d?this.options.zoomSnap:1;return b&&(n=Math.round(n/b)*b),Math.max(c,Math.min(h,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Ut(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,c){var h=this._getCenterOffset(n)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,c),!0)},_createAnimProxy:function(){var n=this._proxy=vt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(c){var h=Io,b=this._proxy.style[h];po(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),b===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){xt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),c=this.getZoom();po(this._proxy,this.project(n,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,c,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var b=this.getZoomScale(c),I=this._getCenterOffset(n)._divideBy(1-1/b);return h.animate!==!0&&!this.getSize().contains(I)?!1:(P(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(n,c,!0)},this),!0)},_animateZoom:function(n,c,h,b){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=c,ht(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:c,noUpdate:b}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Ut(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Ki(n,c){return new gt(n,c)}var bn=ne.extend({options:{position:"topright"},initialize:function(n){w(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var c=this._map;return c&&c.removeControl(this),this.options.position=n,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var c=this._container=this.onAdd(n),h=this.getPosition(),b=n._controlCorners[h];return ht(c,"leaflet-control"),h.indexOf("bottom")!==-1?b.insertBefore(c,b.firstChild):b.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(xt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),Cs=function(n){return new bn(n)};gt.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},c="leaflet-",h=this._controlContainer=vt("div",c+"control-container",this._container);function b(I,z){var oe=c+I+" "+c+z;n[I+z]=vt("div",oe,h)}b("top","left"),b("top","right"),b("bottom","left"),b("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)xt(this._controlCorners[n]);xt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Oa=bn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,c,h,b){return h<b?-1:b<h?1:0}},initialize:function(n,c,h){w(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var b in n)this._addLayer(n[b],b);for(b in c)this._addLayer(c[b],b,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return bn.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,c){return this._addLayer(n,c),this._map?this._update():this},addOverlay:function(n,c){return this._addLayer(n,c,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var c=this._getLayer(d(n));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){ht(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(ht(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):Ut(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Ut(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",c=this._container=vt("div",n),h=this.options.collapsed;c.setAttribute("aria-haspopup",!0),Vo(c),Xs(c);var b=this._section=vt("section",n+"-list");h&&(this._map.on("click",this.collapse,this),lt(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var I=this._layersLink=vt("a",n+"-toggle",c);I.href="#",I.title="Layers",I.setAttribute("role","button"),lt(I,{keydown:function(z){z.keyCode===13&&this._expandSafely()},click:function(z){Kt(z),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=vt("div",n+"-base",b),this._separator=vt("div",n+"-separator",b),this._overlaysList=vt("div",n+"-overlays",b),c.appendChild(b)},_getLayer:function(n){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&d(this._layers[c].layer)===n)return this._layers[c]},_addLayer:function(n,c,h){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:c,overlay:h}),this.options.sortLayers&&this._layers.sort(l(function(b,I){return this.options.sortFunction(b.layer,I.layer,b.name,I.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;To(this._baseLayersList),To(this._overlaysList),this._layerControlInputs=[];var n,c,h,b,I=0;for(h=0;h<this._layers.length;h++)b=this._layers[h],this._addItem(b),c=c||b.overlay,n=n||!b.overlay,I+=b.overlay?0:1;return this.options.hideSingleBase&&(n=n&&I>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=c&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var c=this._getLayer(d(n.target)),h=c.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;h&&this._map.fire(h,c)},_createRadioElement:function(n,c){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(c?' checked="checked"':"")+"/>",b=document.createElement("div");return b.innerHTML=h,b.firstChild},_addItem:function(n){var c=document.createElement("label"),h=this._map.hasLayer(n.layer),b;n.overlay?(b=document.createElement("input"),b.type="checkbox",b.className="leaflet-control-layers-selector",b.defaultChecked=h):b=this._createRadioElement("leaflet-base-layers_"+d(this),h),this._layerControlInputs.push(b),b.layerId=d(n.layer),lt(b,"click",this._onInputClick,this);var I=document.createElement("span");I.innerHTML=" "+n.name;var z=document.createElement("span");c.appendChild(z),z.appendChild(b),z.appendChild(I);var oe=n.overlay?this._overlaysList:this._baseLayersList;return oe.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,c,h,b=[],I=[];this._handlingClick=!0;for(var z=n.length-1;z>=0;z--)c=n[z],h=this._getLayer(c.layerId).layer,c.checked?b.push(h):c.checked||I.push(h);for(z=0;z<I.length;z++)this._map.hasLayer(I[z])&&this._map.removeLayer(I[z]);for(z=0;z<b.length;z++)this._map.hasLayer(b[z])||this._map.addLayer(b[z]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,c,h,b=this._map.getZoom(),I=n.length-1;I>=0;I--)c=n[I],h=this._getLayer(c.layerId).layer,c.disabled=h.options.minZoom!==void 0&&b<h.options.minZoom||h.options.maxZoom!==void 0&&b>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,lt(n,"click",Kt),this.expand();var c=this;setTimeout(function(){It(n,"click",Kt),c._preventClick=!1})}}),di=function(n,c,h){return new Oa(n,c,h)},na=bn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var c="leaflet-control-zoom",h=vt("div",c+" leaflet-bar"),b=this.options;return this._zoomInButton=this._createButton(b.zoomInText,b.zoomInTitle,c+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(b.zoomOutText,b.zoomOutTitle,c+"-out",h,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,c,h,b,I){var z=vt("a",h,b);return z.innerHTML=n,z.href="#",z.title=c,z.setAttribute("role","button"),z.setAttribute("aria-label",c),Vo(z),lt(z,"click",Go),lt(z,"click",I,this),lt(z,"click",this._refocusOnMap,this),z},_updateDisabled:function(){var n=this._map,c="leaflet-disabled";Ut(this._zoomInButton,c),Ut(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(ht(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(ht(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});gt.mergeOptions({zoomControl:!0}),gt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new na,this.addControl(this.zoomControl))});var Ba=function(n){return new na(n)},Ee=bn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var c="leaflet-control-scale",h=vt("div",c),b=this.options;return this._addScales(b,c+"-line",h),n.on(b.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),h},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,c,h){n.metric&&(this._mScale=vt("div",c,h)),n.imperial&&(this._iScale=vt("div",c,h))},_update:function(){var n=this._map,c=n.getSize().y/2,h=n.distance(n.containerPointToLatLng([0,c]),n.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(h)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var c=this._getRoundNum(n),h=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,h,c/n)},_updateImperial:function(n){var c=n*3.2808399,h,b,I;c>5280?(h=c/5280,b=this._getRoundNum(h),this._updateScale(this._iScale,b+" mi",b/h)):(I=this._getRoundNum(c),this._updateScale(this._iScale,I+" ft",I/c))},_updateScale:function(n,c,h){n.style.width=Math.round(this.options.maxWidth*h)+"px",n.innerHTML=c},_getRoundNum:function(n){var c=Math.pow(10,(Math.floor(n)+"").length-1),h=n/c;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,c*h}}),Me=function(n){return new Ee(n)},at='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',ft=bn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ge.inlineSvg?at+" ":"")+"Leaflet</a>"},initialize:function(n){w(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=vt("div","leaflet-control-attribution"),Vo(this._container);for(var c in n._layers)n._layers[c].getAttribution&&this.addAttribution(n._layers[c].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var c in this._attributions)this._attributions[c]&&n.push(c);var h=[];this.options.prefix&&h.push(this.options.prefix),n.length&&h.push(n.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});gt.mergeOptions({attributionControl:!0}),gt.addInitHook(function(){this.options.attributionControl&&new ft().addTo(this)});var Ct=function(n){return new ft(n)};bn.Layers=Oa,bn.Zoom=na,bn.Scale=Ee,bn.Attribution=ft,Cs.layers=di,Cs.zoom=Ba,Cs.scale=Me,Cs.attribution=Ct;var Ht=ne.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ht.addTo=function(n,c){return n.addHandler(c,this),this};var Vn={Events:Q},Gn=Ge.touch?"touchstart mousedown":"mousedown",At=he.extend({options:{clickTolerance:3},initialize:function(n,c,h,b){w(this,b),this._element=n,this._dragStartTarget=c||n,this._preventOutline=h},enable:function(){this._enabled||(lt(this._dragStartTarget,Gn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(At._dragging===this&&this.finishDrag(!0),It(this._dragStartTarget,Gn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!Ma(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){At._dragging===this&&this.finishDrag();return}if(!(At._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(At._dragging=this,this._preventOutline&&Js(this._element),Pa(),yn(),!this._moving)){this.fire("down");var c=n.touches?n.touches[0]:n,h=Da(this._element);this._startPoint=new U(c.clientX,c.clientY),this._startPos=zo(this._element),this._parentScale=$n(h);var b=n.type==="mousedown";lt(document,b?"mousemove":"touchmove",this._onMove,this),lt(document,b?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var c=n.touches&&n.touches.length===1?n.touches[0]:n,h=new U(c.clientX,c.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,Kt(n),this._moved||(this.fire("dragstart"),this._moved=!0,ht(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ht(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),qt(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){Ut(document.body,"leaflet-dragging"),this._lastTarget&&(Ut(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),It(document,"mousemove touchmove",this._onMove,this),It(document,"mouseup touchend touchcancel",this._onUp,this),zt(),In();var c=this._moved&&this._moving;this._moving=!1,At._dragging=!1,c&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function Tn(n,c,h){var b,I=[1,4,2,8],z,oe,_e,Ie,Fe,nt,ct,kt;for(z=0,nt=n.length;z<nt;z++)n[z]._code=ls(n[z],c);for(_e=0;_e<4;_e++){for(ct=I[_e],b=[],z=0,nt=n.length,oe=nt-1;z<nt;oe=z++)Ie=n[z],Fe=n[oe],Ie._code&ct?Fe._code&ct||(kt=fi(Fe,Ie,ct,c,h),kt._code=ls(kt,c),b.push(kt)):(Fe._code&ct&&(kt=fi(Fe,Ie,ct,c,h),kt._code=ls(kt,c),b.push(kt)),b.push(Ie));n=b}return n}function $t(n,c){var h,b,I,z,oe,_e,Ie,Fe,nt;if(!n||n.length===0)throw new Error("latlngs not passed");so(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var ct=He([0,0]),kt=Je(n),Zn=kt.getNorthWest().distanceTo(kt.getSouthWest())*kt.getNorthEast().distanceTo(kt.getNorthWest());Zn<1700&&(ct=Jt(n));var dn=n.length,Mo=[];for(h=0;h<dn;h++){var ao=He(n[h]);Mo.push(c.project(He([ao.lat-ct.lat,ao.lng-ct.lng])))}for(_e=Ie=Fe=0,h=0,b=dn-1;h<dn;b=h++)I=Mo[h],z=Mo[b],oe=I.y*z.x-z.y*I.x,Ie+=(I.x+z.x)*oe,Fe+=(I.y+z.y)*oe,_e+=oe*3;_e===0?nt=Mo[0]:nt=[Ie/_e,Fe/_e];var Li=c.unproject(fe(nt));return He([Li.lat+ct.lat,Li.lng+ct.lng])}function Jt(n){for(var c=0,h=0,b=0,I=0;I<n.length;I++){var z=He(n[I]);c+=z.lat,h+=z.lng,b++}return He([c/b,h/b])}var Mn={__proto__:null,clipPolygon:Tn,polygonCenter:$t,centroid:Jt};function jo(n,c){if(!c||!n.length)return n.slice();var h=c*c;return n=kc(n,h),n=Ji(n,h),n}function jn(n,c,h){return Math.sqrt(oa(n,c,h,!0))}function hi(n,c,h){return oa(n,c,h)}function Ji(n,c){var h=n.length,b=typeof Uint8Array<"u"?Uint8Array:Array,I=new b(h);I[0]=I[h-1]=1,Na(n,I,c,0,h-1);var z,oe=[];for(z=0;z<h;z++)I[z]&&oe.push(n[z]);return oe}function Na(n,c,h,b,I){var z=0,oe,_e,Ie;for(_e=b+1;_e<=I-1;_e++)Ie=oa(n[_e],n[b],n[I],!0),Ie>z&&(oe=_e,z=Ie);z>h&&(c[oe]=1,Na(n,c,h,b,oe),Na(n,c,h,oe,I))}function kc(n,c){for(var h=[n[0]],b=1,I=0,z=n.length;b<z;b++)_c(n[b],n[I])>c&&(h.push(n[b]),I=b);return I<z-1&&h.push(n[z-1]),h}var Kl;function Yi(n,c,h,b,I){var z=b?Kl:ls(n,h),oe=ls(c,h),_e,Ie,Fe;for(Kl=oe;;){if(!(z|oe))return[n,c];if(z&oe)return!1;_e=z||oe,Ie=fi(n,c,_e,h,I),Fe=ls(Ie,h),_e===z?(n=Ie,z=Fe):(c=Ie,oe=Fe)}}function fi(n,c,h,b,I){var z=c.x-n.x,oe=c.y-n.y,_e=b.min,Ie=b.max,Fe,nt;return h&8?(Fe=n.x+z*(Ie.y-n.y)/oe,nt=Ie.y):h&4?(Fe=n.x+z*(_e.y-n.y)/oe,nt=_e.y):h&2?(Fe=Ie.x,nt=n.y+oe*(Ie.x-n.x)/z):h&1&&(Fe=_e.x,nt=n.y+oe*(_e.x-n.x)/z),new U(Fe,nt,I)}function ls(n,c){var h=0;return n.x<c.min.x?h|=1:n.x>c.max.x&&(h|=2),n.y<c.min.y?h|=4:n.y>c.max.y&&(h|=8),h}function _c(n,c){var h=c.x-n.x,b=c.y-n.y;return h*h+b*b}function oa(n,c,h,b){var I=c.x,z=c.y,oe=h.x-I,_e=h.y-z,Ie=oe*oe+_e*_e,Fe;return Ie>0&&(Fe=((n.x-I)*oe+(n.y-z)*_e)/Ie,Fe>1?(I=h.x,z=h.y):Fe>0&&(I+=oe*Fe,z+=_e*Fe)),oe=n.x-I,_e=n.y-z,b?oe*oe+_e*_e:new U(I,z)}function so(n){return!x(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function Jl(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),so(n)}function Yl(n,c){var h,b,I,z,oe,_e,Ie,Fe;if(!n||n.length===0)throw new Error("latlngs not passed");so(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var nt=He([0,0]),ct=Je(n),kt=ct.getNorthWest().distanceTo(ct.getSouthWest())*ct.getNorthEast().distanceTo(ct.getNorthWest());kt<1700&&(nt=Jt(n));var Zn=n.length,dn=[];for(h=0;h<Zn;h++){var Mo=He(n[h]);dn.push(c.project(He([Mo.lat-nt.lat,Mo.lng-nt.lng])))}for(h=0,b=0;h<Zn-1;h++)b+=dn[h].distanceTo(dn[h+1])/2;if(b===0)Fe=dn[0];else for(h=0,z=0;h<Zn-1;h++)if(oe=dn[h],_e=dn[h+1],I=oe.distanceTo(_e),z+=I,z>b){Ie=(z-b)/I,Fe=[_e.x-Ie*(_e.x-oe.x),_e.y-Ie*(_e.y-oe.y)];break}var ao=c.unproject(fe(Fe));return He([ao.lat+nt.lat,ao.lng+nt.lng])}var bc={__proto__:null,simplify:jo,pointToSegmentDistance:jn,closestPointOnSegment:hi,clipSegment:Yi,_getEdgeIntersection:fi,_getBitCode:ls,_sqClosestPointOnSegment:oa,isFlat:so,_flat:Jl,polylineCenter:Yl},Xi={project:function(n){return new U(n.lng,n.lat)},unproject:function(n){return new Ze(n.y,n.x)},bounds:new ue([-180,-90],[180,90])},Qi={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ue([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var c=Math.PI/180,h=this.R,b=n.lat*c,I=this.R_MINOR/h,z=Math.sqrt(1-I*I),oe=z*Math.sin(b),_e=Math.tan(Math.PI/4-b/2)/Math.pow((1-oe)/(1+oe),z/2);return b=-h*Math.log(Math.max(_e,1e-10)),new U(n.lng*c*h,b)},unproject:function(n){for(var c=180/Math.PI,h=this.R,b=this.R_MINOR/h,I=Math.sqrt(1-b*b),z=Math.exp(-n.y/h),oe=Math.PI/2-2*Math.atan(z),_e=0,Ie=.1,Fe;_e<15&&Math.abs(Ie)>1e-7;_e++)Fe=I*Math.sin(oe),Fe=Math.pow((1-Fe)/(1+Fe),I/2),Ie=Math.PI/2-2*Math.atan(z*Fe)-oe,oe+=Ie;return new Ze(oe*c,n.x*c/h)}},wc={__proto__:null,LonLat:Xi,Mercator:Qi,SphericalMercator:Le},Cc=s({},Ve,{code:"EPSG:3395",projection:Qi,transformation:(function(){var n=.5/(Math.PI*Qi.R);return W(n,.5,-n,.5)})()}),Xl=s({},Ve,{code:"EPSG:4326",projection:Xi,transformation:W(1/180,1,-1/180,.5)}),Lc=s({},be,{projection:Xi,transformation:W(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,c){var h=c.lng-n.lng,b=c.lat-n.lat;return Math.sqrt(h*h+b*b)},infinite:!0});be.Earth=Ve,be.EPSG3395=Cc,be.EPSG3857=Y,be.EPSG900913=pe,be.EPSG4326=Xl,be.Simple=Lc;var yo=he.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[d(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[d(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var c=n.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var h=this.getEvents();c.on(h,this),this.once("remove",function(){c.off(h,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});gt.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var c=d(n);return this._layers[c]?this:(this._layers[c]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var c=d(n);return this._layers[c]?(this._loaded&&n.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return d(n)in this._layers},eachLayer:function(n,c){for(var h in this._layers)n.call(c,this._layers[h]);return this},_addLayers:function(n){n=n?x(n)?n:[n]:[];for(var c=0,h=n.length;c<h;c++)this.addLayer(n[c])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[d(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var c=d(n);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,c=-1/0,h=this._getZoomSpan();for(var b in this._zoomBoundLayers){var I=this._zoomBoundLayers[b].options;n=I.minZoom===void 0?n:Math.min(n,I.minZoom),c=I.maxZoom===void 0?c:Math.max(c,I.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=n===1/0?void 0:n,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var sa=yo.extend({initialize:function(n,c){w(this,c),this._layers={};var h,b;if(n)for(h=0,b=n.length;h<b;h++)this.addLayer(n[h])},addLayer:function(n){var c=this.getLayerId(n);return this._layers[c]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var c=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(n){var c=typeof n=="number"?n:this.getLayerId(n);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var c=Array.prototype.slice.call(arguments,1),h,b;for(h in this._layers)b=this._layers[h],b[n]&&b[n].apply(b,c);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,c){for(var h in this._layers)n.call(c,this._layers[h]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return d(n)}}),pi=function(n,c){return new sa(n,c)},Zo=sa.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),sa.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),sa.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new et;for(var c in this._layers){var h=this._layers[c];n.extend(h.getBounds?h.getBounds():h.getLatLng())}return n}}),vi=function(n,c){return new Zo(n,c)},aa=ne.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){w(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,c){var h=this._getIconUrl(n);if(!h){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var b=this._createImg(h,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(b,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(b.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),b},_setIconStyles:function(n,c){var h=this.options,b=h[c+"Size"];typeof b=="number"&&(b=[b,b]);var I=fe(b),z=fe(c==="shadow"&&h.shadowAnchor||h.iconAnchor||I&&I.divideBy(2,!0));n.className="leaflet-marker-"+c+" "+(h.className||""),z&&(n.style.marginLeft=-z.x+"px",n.style.marginTop=-z.y+"px"),I&&(n.style.width=I.x+"px",n.style.height=I.y+"px")},_createImg:function(n,c){return c=c||document.createElement("img"),c.src=n,c},_getIconUrl:function(n){return Ge.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function Ql(n){return new aa(n)}var Ls=aa.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof Ls.imagePath!="string"&&(Ls.imagePath=this._detectIconPath()),(this.options.imagePath||Ls.imagePath)+aa.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var c=function(h,b,I){var z=b.exec(h);return z&&z[I]};return n=c(n,/^url\((['"])?(.+)\1\)$/,2),n&&c(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=vt("div","leaflet-default-icon-path",document.body),c=Hn(n,"background-image")||Hn(n,"backgroundImage");if(document.body.removeChild(n),c=this._stripUrl(c),c)return c;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),mi=Ht.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new At(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ht(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Ut(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var c=this._marker,h=c._map,b=this._marker.options.autoPanSpeed,I=this._marker.options.autoPanPadding,z=zo(c._icon),oe=h.getPixelBounds(),_e=h.getPixelOrigin(),Ie=De(oe.min._subtract(_e).add(I),oe.max._subtract(_e).subtract(I));if(!Ie.contains(z)){var Fe=fe((Math.max(Ie.max.x,z.x)-Ie.max.x)/(oe.max.x-Ie.max.x)-(Math.min(Ie.min.x,z.x)-Ie.min.x)/(oe.min.x-Ie.min.x),(Math.max(Ie.max.y,z.y)-Ie.max.y)/(oe.max.y-Ie.max.y)-(Math.min(Ie.min.y,z.y)-Ie.min.y)/(oe.min.y-Ie.min.y)).multiplyBy(b);h.panBy(Fe,{animate:!1}),this._draggable._newPos._add(Fe),this._draggable._startPos._add(Fe),qt(c._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=P(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(G(this._panRequest),this._panRequest=P(this._adjustPan.bind(this,n)))},_onDrag:function(n){var c=this._marker,h=c._shadow,b=zo(c._icon),I=c._map.layerPointToLatLng(b);h&&qt(h,b),c._latlng=I,n.latlng=I,n.oldLatLng=this._oldLatLng,c.fire("move",n).fire("drag",n)},_onDragEnd:function(n){G(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),gi=yo.extend({options:{icon:new Ls,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,c){w(this,c),this._latlng=He(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var c=this._latlng;return this._latlng=He(n),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=n.icon.createIcon(this._icon),b=!1;h!==this._icon&&(this._icon&&this._removeIcon(),b=!0,n.title&&(h.title=n.title),h.tagName==="IMG"&&(h.alt=n.alt||"")),ht(h,c),n.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&lt(h,"focus",this._panOnFocus,this);var I=n.icon.createShadow(this._shadow),z=!1;I!==this._shadow&&(this._removeShadow(),z=!0),I&&(ht(I,c),I.alt=""),this._shadow=I,n.opacity<1&&this._updateOpacity(),b&&this.getPane().appendChild(this._icon),this._initInteraction(),I&&z&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&It(this._icon,"focus",this._panOnFocus,this),xt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&xt(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&qt(this._icon,n),this._shadow&&qt(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var c=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(ht(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),mi)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new mi(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&gn(this._icon,n),this._shadow&&gn(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var c=this.options.icon.options,h=c.iconSize?fe(c.iconSize):fe(0,0),b=c.iconAnchor?fe(c.iconAnchor):fe(0,0);n.panInside(this._latlng,{paddingTopLeft:b,paddingBottomRight:h.subtract(b)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Sc(n,c){return new gi(n,c)}var rs=yo.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return w(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),yi=rs.extend({options:{fill:!0,radius:10},initialize:function(n,c){w(this,c),this._latlng=He(n),this._radius=this.options.radius},setLatLng:function(n){var c=this._latlng;return this._latlng=He(n),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var c=n&&n.radius||this._radius;return rs.prototype.setStyle.call(this,n),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,c=this._radiusY||n,h=this._clickTolerance(),b=[n+h,c+h];this._pxBounds=new ue(this._point.subtract(b),this._point.add(b))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function xc(n,c){return new yi(n,c)}var el=yi.extend({initialize:function(n,c,h){if(typeof c=="number"&&(c=s({},h,{radius:c})),w(this,c),this._latlng=He(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new et(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:rs.prototype.setStyle,_project:function(){var n=this._latlng.lng,c=this._latlng.lat,h=this._map,b=h.options.crs;if(b.distance===Ve.distance){var I=Math.PI/180,z=this._mRadius/Ve.R/I,oe=h.project([c+z,n]),_e=h.project([c-z,n]),Ie=oe.add(_e).divideBy(2),Fe=h.unproject(Ie).lat,nt=Math.acos((Math.cos(z*I)-Math.sin(c*I)*Math.sin(Fe*I))/(Math.cos(c*I)*Math.cos(Fe*I)))/I;(isNaN(nt)||nt===0)&&(nt=z/Math.cos(Math.PI/180*c)),this._point=Ie.subtract(h.getPixelOrigin()),this._radius=isNaN(nt)?0:Ie.x-h.project([Fe,n-nt]).x,this._radiusY=Ie.y-oe.y}else{var ct=b.unproject(b.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(ct).x}this._updateBounds()}});function Ic(n,c,h){return new el(n,c,h)}var qo=rs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,c){w(this,c),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var c=1/0,h=null,b=oa,I,z,oe=0,_e=this._parts.length;oe<_e;oe++)for(var Ie=this._parts[oe],Fe=1,nt=Ie.length;Fe<nt;Fe++){I=Ie[Fe-1],z=Ie[Fe];var ct=b(n,I,z,!0);ct<c&&(c=ct,h=b(n,I,z))}return h&&(h.distance=Math.sqrt(c)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Yl(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,c){return c=c||this._defaultShape(),n=He(n),c.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new et,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return so(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var c=[],h=so(n),b=0,I=n.length;b<I;b++)h?(c[b]=He(n[b]),this._bounds.extend(c[b])):c[b]=this._convertLatLngs(n[b]);return c},_project:function(){var n=new ue;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),c=new U(n,n);this._rawPxBounds&&(this._pxBounds=new ue([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(n,c,h){var b=n[0]instanceof Ze,I=n.length,z,oe;if(b){for(oe=[],z=0;z<I;z++)oe[z]=this._map.latLngToLayerPoint(n[z]),h.extend(oe[z]);c.push(oe)}else for(z=0;z<I;z++)this._projectLatlngs(n[z],c,h)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,h,b,I,z,oe,_e,Ie;for(h=0,I=0,z=this._rings.length;h<z;h++)for(Ie=this._rings[h],b=0,oe=Ie.length;b<oe-1;b++)_e=Yi(Ie[b],Ie[b+1],n,b,!0),_e&&(c[I]=c[I]||[],c[I].push(_e[0]),(_e[1]!==Ie[b+1]||b===oe-2)&&(c[I].push(_e[1]),I++))}},_simplifyPoints:function(){for(var n=this._parts,c=this.options.smoothFactor,h=0,b=n.length;h<b;h++)n[h]=jo(n[h],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,c){var h,b,I,z,oe,_e,Ie=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(h=0,z=this._parts.length;h<z;h++)for(_e=this._parts[h],b=0,oe=_e.length,I=oe-1;b<oe;I=b++)if(!(!c&&b===0)&&jn(n,_e[I],_e[b])<=Ie)return!0;return!1}});function $c(n,c){return new qo(n,c)}qo._flat=Jl;var ia=qo.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return $t(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var c=qo.prototype._convertLatLngs.call(this,n),h=c.length;return h>=2&&c[0]instanceof Ze&&c[0].equals(c[h-1])&&c.pop(),c},_setLatLngs:function(n){qo.prototype._setLatLngs.call(this,n),so(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return so(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,c=this.options.weight,h=new U(c,c);if(n=new ue(n.min.subtract(h),n.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var b=0,I=this._rings.length,z;b<I;b++)z=Tn(this._rings[b],n,!0),z.length&&this._parts.push(z)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var c=!1,h,b,I,z,oe,_e,Ie,Fe;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(z=0,Ie=this._parts.length;z<Ie;z++)for(h=this._parts[z],oe=0,Fe=h.length,_e=Fe-1;oe<Fe;_e=oe++)b=h[oe],I=h[_e],b.y>n.y!=I.y>n.y&&n.x<(I.x-b.x)*(n.y-b.y)/(I.y-b.y)+b.x&&(c=!c);return c||qo.prototype._containsPoint.call(this,n,!0)}});function er(n,c){return new ia(n,c)}var Wo=Zo.extend({initialize:function(n,c){w(this,c),this._layers={},n&&this.addData(n)},addData:function(n){var c=x(n)?n:n.features,h,b,I;if(c){for(h=0,b=c.length;h<b;h++)I=c[h],(I.geometries||I.geometry||I.features||I.coordinates)&&this.addData(I);return this}var z=this.options;if(z.filter&&!z.filter(n))return this;var oe=Fa(n,z);return oe?(oe.feature=bi(n),oe.defaultOptions=oe.options,this.resetStyle(oe),z.onEachFeature&&z.onEachFeature(n,oe),this.addLayer(oe)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=s({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(c){this._setLayerStyle(c,n)},this)},_setLayerStyle:function(n,c){n.setStyle&&(typeof c=="function"&&(c=c(n.feature)),n.setStyle(c))}});function Fa(n,c){var h=n.type==="Feature"?n.geometry:n,b=h?h.coordinates:null,I=[],z=c&&c.pointToLayer,oe=c&&c.coordsToLatLng||tl,_e,Ie,Fe,nt;if(!b&&!h)return null;switch(h.type){case"Point":return _e=oe(b),tr(z,n,_e,c);case"MultiPoint":for(Fe=0,nt=b.length;Fe<nt;Fe++)_e=oe(b[Fe]),I.push(tr(z,n,_e,c));return new Zo(I);case"LineString":case"MultiLineString":return Ie=ki(b,h.type==="LineString"?0:1,oe),new qo(Ie,c);case"Polygon":case"MultiPolygon":return Ie=ki(b,h.type==="Polygon"?1:2,oe),new ia(Ie,c);case"GeometryCollection":for(Fe=0,nt=h.geometries.length;Fe<nt;Fe++){var ct=Fa({geometry:h.geometries[Fe],type:"Feature",properties:n.properties},c);ct&&I.push(ct)}return new Zo(I);case"FeatureCollection":for(Fe=0,nt=h.features.length;Fe<nt;Fe++){var kt=Fa(h.features[Fe],c);kt&&I.push(kt)}return new Zo(I);default:throw new Error("Invalid GeoJSON object.")}}function tr(n,c,h,b){return n?n(c,h):new gi(h,b&&b.markersInheritOptions&&b)}function tl(n){return new Ze(n[1],n[0],n[2])}function ki(n,c,h){for(var b=[],I=0,z=n.length,oe;I<z;I++)oe=c?ki(n[I],c-1,h):(h||tl)(n[I]),b.push(oe);return b}function Ua(n,c){return n=He(n),n.alt!==void 0?[y(n.lng,c),y(n.lat,c),y(n.alt,c)]:[y(n.lng,c),y(n.lat,c)]}function _i(n,c,h,b){for(var I=[],z=0,oe=n.length;z<oe;z++)I.push(c?_i(n[z],so(n[z])?0:c-1,h,b):Ua(n[z],b));return!c&&h&&I.length>0&&I.push(I[0].slice()),I}function la(n,c){return n.feature?s({},n.feature,{geometry:c}):bi(c)}function bi(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var wi={toGeoJSON:function(n){return la(this,{type:"Point",coordinates:Ua(this.getLatLng(),n)})}};gi.include(wi),el.include(wi),yi.include(wi),qo.include({toGeoJSON:function(n){var c=!so(this._latlngs),h=_i(this._latlngs,c?1:0,!1,n);return la(this,{type:(c?"Multi":"")+"LineString",coordinates:h})}}),ia.include({toGeoJSON:function(n){var c=!so(this._latlngs),h=c&&!so(this._latlngs[0]),b=_i(this._latlngs,h?2:c?1:0,!0,n);return c||(b=[b]),la(this,{type:(h?"Multi":"")+"Polygon",coordinates:b})}}),sa.include({toMultiPoint:function(n){var c=[];return this.eachLayer(function(h){c.push(h.toGeoJSON(n).geometry.coordinates)}),la(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(n){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(n);var h=c==="GeometryCollection",b=[];return this.eachLayer(function(I){if(I.toGeoJSON){var z=I.toGeoJSON(n);if(h)b.push(z.geometry);else{var oe=bi(z);oe.type==="FeatureCollection"?b.push.apply(b,oe.features):b.push(oe)}}}),h?la(this,{geometries:b,type:"GeometryCollection"}):{type:"FeatureCollection",features:b}}});function nr(n,c){return new Wo(n,c)}var za=nr,Ha=yo.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,c,h){this._url=n,this._bounds=Je(c),w(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ht(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){xt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&fo(this._image),this},bringToBack:function(){return this._map&&Fo(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=Je(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",c=this._image=n?this._url:vt("img");if(ht(c,"leaflet-image-layer"),this._zoomAnimated&&ht(c,"leaflet-zoom-animated"),this.options.className&&ht(c,this.options.className),c.onselectstart=g,c.onmousemove=g,c.onload=l(this.fire,this,"load"),c.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(n){var c=this._map.getZoomScale(n.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;po(this._image,h,c)},_reset:function(){var n=this._image,c=new ue(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=c.getSize();qt(n,c.min),n.style.width=h.x+"px",n.style.height=h.y+"px"},_updateOpacity:function(){gn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),or=function(n,c,h){return new Ha(n,c,h)},nl=Ha.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",c=this._image=n?this._url:vt("video");if(ht(c,"leaflet-image-layer"),this._zoomAnimated&&ht(c,"leaflet-zoom-animated"),this.options.className&&ht(c,this.options.className),c.onselectstart=g,c.onmousemove=g,c.onloadeddata=l(this.fire,this,"load"),n){for(var h=c.getElementsByTagName("source"),b=[],I=0;I<h.length;I++)b.push(h[I].src);this._url=h.length>0?b:[c.src];return}x(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var z=0;z<this._url.length;z++){var oe=vt("source");oe.src=this._url[z],c.appendChild(oe)}}});function H(n,c,h){return new nl(n,c,h)}var ae=Ha.extend({_initImage:function(){var n=this._image=this._url;ht(n,"leaflet-image-layer"),this._zoomAnimated&&ht(n,"leaflet-zoom-animated"),this.options.className&&ht(n,this.options.className),n.onselectstart=g,n.onmousemove=g}});function ye(n,c,h){return new ae(n,c,h)}var ke=yo.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,c){n&&(n instanceof Ze||x(n))?(this._latlng=He(n),w(this,c)):(w(this,n),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&gn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&gn(this._container,1),this.bringToFront(),this.options.interactive&&(ht(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(gn(this._container,0),this._removeTimeout=setTimeout(l(xt,void 0,this._container),200)):xt(this._container),this.options.interactive&&(Ut(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=He(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&fo(this._container),this},bringToBack:function(){return this._map&&Fo(this._container),this},_prepareOpen:function(n){var c=this._source;if(!c._map)return!1;if(c instanceof Zo){c=null;var h=this._source._layers;for(var b in h)if(h[b]._map){c=h[b];break}if(!c)return!1;this._source=c}if(!n)if(c.getCenter)n=c.getCenter();else if(c.getLatLng)n=c.getLatLng();else if(c.getBounds)n=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")n.innerHTML=c;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),c=fe(this.options.offset),h=this._getAnchor();this._zoomAnimated?qt(this._container,n.add(h)):c=c.add(n).add(h);var b=this._containerBottom=-c.y,I=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=b+"px",this._container.style.left=I+"px"}},_getAnchor:function(){return[0,0]}});gt.include({_initOverlay:function(n,c,h,b){var I=c;return I instanceof n||(I=new n(b).setContent(c)),h&&I.setLatLng(h),I}}),yo.include({_initOverlay:function(n,c,h,b){var I=h;return I instanceof n?(w(I,b),I._source=this):(I=c&&!b?c:new n(b,this),I.setContent(h)),I}});var tt=ke.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,ke.prototype.openOn.call(this,n)},onAdd:function(n){ke.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof rs||this._source.on("preclick",go))},onRemove:function(n){ke.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof rs||this._source.off("preclick",go))},getEvents:function(){var n=ke.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",c=this._container=vt("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=vt("div",n+"-content-wrapper",c);if(this._contentNode=vt("div",n+"-content",h),Vo(c),Xs(this._contentNode),lt(c,"contextmenu",go),this._tipContainer=vt("div",n+"-tip-container",c),this._tip=vt("div",n+"-tip",this._tipContainer),this.options.closeButton){var b=this._closeButton=vt("a",n+"-close-button",c);b.setAttribute("role","button"),b.setAttribute("aria-label","Close popup"),b.href="#close",b.innerHTML='<span aria-hidden="true">&#215;</span>',lt(b,"click",function(I){Kt(I),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,c=n.style;c.width="",c.whiteSpace="nowrap";var h=n.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),c.width=h+1+"px",c.whiteSpace="",c.height="";var b=n.offsetHeight,I=this.options.maxHeight,z="leaflet-popup-scrolled";I&&b>I?(c.height=I+"px",ht(n,z)):Ut(n,z),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var c=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),h=this._getAnchor();qt(this._container,c.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,c=parseInt(Hn(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+c,b=this._containerWidth,I=new U(this._containerLeft,-h-this._containerBottom);I._add(zo(this._container));var z=n.layerPointToContainerPoint(I),oe=fe(this.options.autoPanPadding),_e=fe(this.options.autoPanPaddingTopLeft||oe),Ie=fe(this.options.autoPanPaddingBottomRight||oe),Fe=n.getSize(),nt=0,ct=0;z.x+b+Ie.x>Fe.x&&(nt=z.x+b-Fe.x+Ie.x),z.x-nt-_e.x<0&&(nt=z.x-_e.x),z.y+h+Ie.y>Fe.y&&(ct=z.y+h-Fe.y+Ie.y),z.y-ct-_e.y<0&&(ct=z.y-_e.y),(nt||ct)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([nt,ct]))}},_getAnchor:function(){return fe(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Lt=function(n,c){return new tt(n,c)};gt.mergeOptions({closePopupOnClick:!0}),gt.include({openPopup:function(n,c,h){return this._initOverlay(tt,n,c,h).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),yo.include({bindPopup:function(n,c){return this._popup=this._initOverlay(tt,this._popup,n,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof Zo||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){Go(n);var c=n.layer||n.target;if(this._popup._source===c&&!(c instanceof rs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=c,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var Et=ke.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){ke.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){ke.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=ke.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",c=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=vt("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var c,h,b=this._map,I=this._container,z=b.latLngToContainerPoint(b.getCenter()),oe=b.layerPointToContainerPoint(n),_e=this.options.direction,Ie=I.offsetWidth,Fe=I.offsetHeight,nt=fe(this.options.offset),ct=this._getAnchor();_e==="top"?(c=Ie/2,h=Fe):_e==="bottom"?(c=Ie/2,h=0):_e==="center"?(c=Ie/2,h=Fe/2):_e==="right"?(c=0,h=Fe/2):_e==="left"?(c=Ie,h=Fe/2):oe.x<z.x?(_e="right",c=0,h=Fe/2):(_e="left",c=Ie+(nt.x+ct.x)*2,h=Fe/2),n=n.subtract(fe(c,h,!0)).add(nt).add(ct),Ut(I,"leaflet-tooltip-right"),Ut(I,"leaflet-tooltip-left"),Ut(I,"leaflet-tooltip-top"),Ut(I,"leaflet-tooltip-bottom"),ht(I,"leaflet-tooltip-"+_e),qt(I,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&gn(this._container,n)},_animateZoom:function(n){var c=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(c)},_getAnchor:function(){return fe(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),un=function(n,c){return new Et(n,c)};gt.include({openTooltip:function(n,c,h){return this._initOverlay(Et,n,c,h).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),yo.include({bindTooltip:function(n,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Et,this._tooltip,n,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var c=n?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[c](h),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof Zo||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var c=typeof n.getElement=="function"&&n.getElement();c&&(lt(c,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),lt(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var c=typeof n.getElement=="function"&&n.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var c=n.latlng,h,b;this._tooltip.options.sticky&&n.originalEvent&&(h=this._map.mouseEventToContainerPoint(n.originalEvent),b=this._map.containerPointToLayerPoint(h),c=this._map.layerPointToLatLng(b)),this._tooltip.setLatLng(c)}});var ra=aa.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var c=n&&n.tagName==="DIV"?n:document.createElement("div"),h=this.options;if(h.html instanceof Element?(To(c),c.appendChild(h.html)):c.innerHTML=h.html!==!1?h.html:"",h.bgPos){var b=fe(h.bgPos);c.style.backgroundPosition=-b.x+"px "+-b.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function Ci(n){return new ra(n)}aa.Default=Ls;var Ss=yo.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ge.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){w(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),xt(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(fo(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Fo(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof U?n:new U(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var c=this.getPane().children,h=-n(-1/0,1/0),b=0,I=c.length,z;b<I;b++)z=c[b].style.zIndex,c[b]!==this._container&&z&&(h=n(h,+z));isFinite(h)&&(this.options.zIndex=h+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ge.ielt9){gn(this._container,this.options.opacity);var n=+new Date,c=!1,h=!1;for(var b in this._tiles){var I=this._tiles[b];if(!(!I.current||!I.loaded)){var z=Math.min(1,(n-I.loaded)/200);gn(I.el,z),z<1?c=!0:(I.active?h=!0:this._onOpaqueTile(I),I.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),c&&(G(this._fadeFrame),this._fadeFrame=P(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=vt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,c=this.options.maxZoom;if(n!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===n?(this._levels[h].el.style.zIndex=c-Math.abs(n-h),this._onUpdateLevel(h)):(xt(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var b=this._levels[n],I=this._map;return b||(b=this._levels[n]={},b.el=vt("div","leaflet-tile-container leaflet-zoom-animated",this._container),b.el.style.zIndex=c,b.origin=I.project(I.unproject(I.getPixelOrigin()),n).round(),b.zoom=n,this._setZoomTransform(b,I.getCenter(),I.getZoom()),g(b.el.offsetWidth),this._onCreateLevel(b)),this._level=b,b}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var n,c,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)c=this._tiles[n],c.retain=c.current;for(n in this._tiles)if(c=this._tiles[n],c.current&&!c.active){var b=c.coords;this._retainParent(b.x,b.y,b.z,b.z-5)||this._retainChildren(b.x,b.y,b.z,b.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var c in this._tiles)this._tiles[c].coords.z===n&&this._removeTile(c)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)xt(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,c,h,b){var I=Math.floor(n/2),z=Math.floor(c/2),oe=h-1,_e=new U(+I,+z);_e.z=+oe;var Ie=this._tileCoordsToKey(_e),Fe=this._tiles[Ie];return Fe&&Fe.active?(Fe.retain=!0,!0):(Fe&&Fe.loaded&&(Fe.retain=!0),oe>b?this._retainParent(I,z,oe,b):!1)},_retainChildren:function(n,c,h,b){for(var I=2*n;I<2*n+2;I++)for(var z=2*c;z<2*c+2;z++){var oe=new U(I,z);oe.z=h+1;var _e=this._tileCoordsToKey(oe),Ie=this._tiles[_e];if(Ie&&Ie.active){Ie.retain=!0;continue}else Ie&&Ie.loaded&&(Ie.retain=!0);h+1<b&&this._retainChildren(I,z,h+1,b)}},_resetView:function(n){var c=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var c=this.options;return c.minNativeZoom!==void 0&&n<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<n?c.maxNativeZoom:n},_setView:function(n,c,h,b){var I=Math.round(c);this.options.maxZoom!==void 0&&I>this.options.maxZoom||this.options.minZoom!==void 0&&I<this.options.minZoom?I=void 0:I=this._clampZoom(I);var z=this.options.updateWhenZooming&&I!==this._tileZoom;(!b||z)&&(this._tileZoom=I,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),I!==void 0&&this._update(n),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(n,c)},_setZoomTransforms:function(n,c){for(var h in this._levels)this._setZoomTransform(this._levels[h],n,c)},_setZoomTransform:function(n,c,h){var b=this._map.getZoomScale(h,n.zoom),I=n.origin.multiplyBy(b).subtract(this._map._getNewPixelOrigin(c,h)).round();Ge.any3d?po(n.el,I,b):qt(n.el,I)},_resetGrid:function(){var n=this._map,c=n.options.crs,h=this._tileSize=this.getTileSize(),b=this._tileZoom,I=this._map.getPixelWorldBounds(this._tileZoom);I&&(this._globalTileRange=this._pxBoundsToTileRange(I)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,c.wrapLng[0]],b).x/h.x),Math.ceil(n.project([0,c.wrapLng[1]],b).x/h.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([c.wrapLat[0],0],b).y/h.x),Math.ceil(n.project([c.wrapLat[1],0],b).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var c=this._map,h=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),b=c.getZoomScale(h,this._tileZoom),I=c.project(n,this._tileZoom).floor(),z=c.getSize().divideBy(b*2);return new ue(I.subtract(z),I.add(z))},_update:function(n){var c=this._map;if(c){var h=this._clampZoom(c.getZoom());if(n===void 0&&(n=c.getCenter()),this._tileZoom!==void 0){var b=this._getTiledPixelBounds(n),I=this._pxBoundsToTileRange(b),z=I.getCenter(),oe=[],_e=this.options.keepBuffer,Ie=new ue(I.getBottomLeft().subtract([_e,-_e]),I.getTopRight().add([_e,-_e]));if(!(isFinite(I.min.x)&&isFinite(I.min.y)&&isFinite(I.max.x)&&isFinite(I.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Fe in this._tiles){var nt=this._tiles[Fe].coords;(nt.z!==this._tileZoom||!Ie.contains(new U(nt.x,nt.y)))&&(this._tiles[Fe].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(n,h);return}for(var ct=I.min.y;ct<=I.max.y;ct++)for(var kt=I.min.x;kt<=I.max.x;kt++){var Zn=new U(kt,ct);if(Zn.z=this._tileZoom,!!this._isValidTile(Zn)){var dn=this._tiles[this._tileCoordsToKey(Zn)];dn?dn.current=!0:oe.push(Zn)}}if(oe.sort(function(ao,Li){return ao.distanceTo(z)-Li.distanceTo(z)}),oe.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Mo=document.createDocumentFragment();for(kt=0;kt<oe.length;kt++)this._addTile(oe[kt],Mo);this._level.el.appendChild(Mo)}}}},_isValidTile:function(n){var c=this._map.options.crs;if(!c.infinite){var h=this._globalTileRange;if(!c.wrapLng&&(n.x<h.min.x||n.x>h.max.x)||!c.wrapLat&&(n.y<h.min.y||n.y>h.max.y))return!1}if(!this.options.bounds)return!0;var b=this._tileCoordsToBounds(n);return Je(this.options.bounds).overlaps(b)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var c=this._map,h=this.getTileSize(),b=n.scaleBy(h),I=b.add(h),z=c.unproject(b,n.z),oe=c.unproject(I,n.z);return[z,oe]},_tileCoordsToBounds:function(n){var c=this._tileCoordsToNwSe(n),h=new et(c[0],c[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var c=n.split(":"),h=new U(+c[0],+c[1]);return h.z=+c[2],h},_removeTile:function(n){var c=this._tiles[n];c&&(xt(c.el),delete this._tiles[n],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){ht(n,"leaflet-tile");var c=this.getTileSize();n.style.width=c.x+"px",n.style.height=c.y+"px",n.onselectstart=g,n.onmousemove=g,Ge.ielt9&&this.options.opacity<1&&gn(n,this.options.opacity)},_addTile:function(n,c){var h=this._getTilePos(n),b=this._tileCoordsToKey(n),I=this.createTile(this._wrapCoords(n),l(this._tileReady,this,n));this._initTile(I),this.createTile.length<2&&P(l(this._tileReady,this,n,null,I)),qt(I,h),this._tiles[b]={el:I,coords:n,current:!0},c.appendChild(I),this.fire("tileloadstart",{tile:I,coords:n})},_tileReady:function(n,c,h){c&&this.fire("tileerror",{error:c,tile:h,coords:n});var b=this._tileCoordsToKey(n);h=this._tiles[b],h&&(h.loaded=+new Date,this._map._fadeAnimated?(gn(h.el,0),G(this._fadeFrame),this._fadeFrame=P(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),c||(ht(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ge.ielt9||!this._map._fadeAnimated?P(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var c=new U(this._wrapX?f(n.x,this._wrapX):n.x,this._wrapY?f(n.y,this._wrapY):n.y);return c.z=n.z,c},_pxBoundsToTileRange:function(n){var c=this.getTileSize();return new ue(n.min.unscaleBy(c).floor(),n.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function ca(n){return new Ss(n)}var wn=Ss.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,c){this._url=n,c=w(this,c),c.detectRetina&&Ge.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,c){return this._url===n&&c===void 0&&(c=!0),this._url=n,c||this.redraw(),this},createTile:function(n,c){var h=document.createElement("img");return lt(h,"load",l(this._tileOnLoad,this,c,h)),lt(h,"error",l(this._tileOnError,this,c,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(n),h},getTileUrl:function(n){var c={r:Ge.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-n.y;this.options.tms&&(c.y=h),c["-y"]=h}return A(this._url,s(c,this.options))},_tileOnLoad:function(n,c){Ge.ielt9?setTimeout(l(n,this,null,c),0):n(null,c)},_tileOnError:function(n,c,h){var b=this.options.errorTileUrl;b&&c.getAttribute("src")!==b&&(c.src=b),n(h,c)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,c=this.options.maxZoom,h=this.options.zoomReverse,b=this.options.zoomOffset;return h&&(n=c-n),n+b},_getSubdomain:function(n){var c=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var n,c;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(c=this._tiles[n].el,c.onload=g,c.onerror=g,!c.complete)){c.src=R;var h=this._tiles[n].coords;xt(c),delete this._tiles[n],this.fire("tileabort",{tile:c,coords:h})}},_removeTile:function(n){var c=this._tiles[n];if(c)return c.el.setAttribute("src",R),Ss.prototype._removeTile.call(this,n)},_tileReady:function(n,c,h){if(!(!this._map||h&&h.getAttribute("src")===R))return Ss.prototype._tileReady.call(this,n,c,h)}});function ud(n,c){return new wn(n,c)}var dd=wn.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,c){this._url=n;var h=s({},this.defaultWmsParams);for(var b in c)b in this.options||(h[b]=c[b]);c=w(this,c);var I=c.detectRetina&&Ge.retina?2:1,z=this.getTileSize();h.width=z.x*I,h.height=z.y*I,this.wmsParams=h},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,wn.prototype.onAdd.call(this,n)},getTileUrl:function(n){var c=this._tileCoordsToNwSe(n),h=this._crs,b=De(h.project(c[0]),h.project(c[1])),I=b.min,z=b.max,oe=(this._wmsVersion>=1.3&&this._crs===Xl?[I.y,I.x,z.y,z.x]:[I.x,I.y,z.x,z.y]).join(","),_e=wn.prototype.getTileUrl.call(this,n);return _e+S(this.wmsParams,_e,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+oe},setParams:function(n,c){return s(this.wmsParams,n),c||this.redraw(),this}});function om(n,c){return new dd(n,c)}wn.WMS=dd,ud.wms=om;var xs=yo.extend({options:{padding:.1},initialize:function(n){w(this,n),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ht(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,c){var h=this._map.getZoomScale(c,this._zoom),b=this._map.getSize().multiplyBy(.5+this.options.padding),I=this._map.project(this._center,c),z=b.multiplyBy(-h).add(I).subtract(this._map._getNewPixelOrigin(n,c));Ge.any3d?po(this._container,z,h):qt(this._container,z)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,c=this._map.getSize(),h=this._map.containerPointToLayerPoint(c.multiplyBy(-n)).round();this._bounds=new ue(h,h.add(c.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),hd=xs.extend({options:{tolerance:0},getEvents:function(){var n=xs.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){xs.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");lt(n,"mousemove",this._onMouseMove,this),lt(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),lt(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){G(this._redrawRequest),delete this._ctx,xt(this._container),It(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var c in this._layers)n=this._layers[c],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){xs.prototype._update.call(this);var n=this._bounds,c=this._container,h=n.getSize(),b=Ge.retina?2:1;qt(c,n.min),c.width=b*h.x,c.height=b*h.y,c.style.width=h.x+"px",c.style.height=h.y+"px",Ge.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){xs.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[d(n)]=n;var c=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var c=n._order,h=c.next,b=c.prev;h?h.prev=b:this._drawLast=b,b?b.next=h:this._drawFirst=h,delete n._order,delete this._layers[d(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var c=n.options.dashArray.split(/[, ]+/),h=[],b,I;for(I=0;I<c.length;I++){if(b=Number(c[I]),isNaN(b))return;h.push(b)}n.options._dashArray=h}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||P(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var c=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ue,this._redrawBounds.extend(n._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(n._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var c=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,c=this._redrawBounds;if(this._ctx.save(),c){var h=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var b=this._drawFirst;b;b=b.next)n=b.layer,(!c||n._pxBounds&&n._pxBounds.intersects(c))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,c){if(this._drawing){var h,b,I,z,oe=n._parts,_e=oe.length,Ie=this._ctx;if(_e){for(Ie.beginPath(),h=0;h<_e;h++){for(b=0,I=oe[h].length;b<I;b++)z=oe[h][b],Ie[b?"lineTo":"moveTo"](z.x,z.y);c&&Ie.closePath()}this._fillStroke(Ie,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var c=n._point,h=this._ctx,b=Math.max(Math.round(n._radius),1),I=(Math.max(Math.round(n._radiusY),1)||b)/b;I!==1&&(h.save(),h.scale(1,I)),h.beginPath(),h.arc(c.x,c.y/I,b,0,Math.PI*2,!1),I!==1&&h.restore(),this._fillStroke(h,n)}},_fillStroke:function(n,c){var h=c.options;h.fill&&(n.globalAlpha=h.fillOpacity,n.fillStyle=h.fillColor||h.color,n.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(n.setLineDash&&n.setLineDash(c.options&&c.options._dashArray||[]),n.globalAlpha=h.opacity,n.lineWidth=h.weight,n.strokeStyle=h.color,n.lineCap=h.lineCap,n.lineJoin=h.lineJoin,n.stroke())},_onClick:function(n){for(var c=this._map.mouseEventToLayerPoint(n),h,b,I=this._drawFirst;I;I=I.next)h=I.layer,h.options.interactive&&h._containsPoint(c)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(h))&&(b=h);this._fireEvent(b?[b]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,c)}},_handleMouseOut:function(n){var c=this._hoveredLayer;c&&(Ut(this._container,"leaflet-interactive"),this._fireEvent([c],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,c){if(!this._mouseHoverThrottled){for(var h,b,I=this._drawFirst;I;I=I.next)h=I.layer,h.options.interactive&&h._containsPoint(c)&&(b=h);b!==this._hoveredLayer&&(this._handleMouseOut(n),b&&(ht(this._container,"leaflet-interactive"),this._fireEvent([b],n,"mouseover"),this._hoveredLayer=b)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,c,h){this._map._fireDOMEvent(c,h||c.type,n)},_bringToFront:function(n){var c=n._order;if(c){var h=c.next,b=c.prev;if(h)h.prev=b;else return;b?b.next=h:h&&(this._drawFirst=h),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(n)}},_bringToBack:function(n){var c=n._order;if(c){var h=c.next,b=c.prev;if(b)b.next=h;else return;h?h.prev=b:b&&(this._drawLast=b),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(n)}}});function fd(n){return Ge.canvas?new hd(n):null}var ol=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),sm={_initContainer:function(){this._container=vt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(xs.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var c=n._container=ol("shape");ht(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",n._path=ol("path"),c.appendChild(n._path),this._updateStyle(n),this._layers[d(n)]=n},_addPath:function(n){var c=n._container;this._container.appendChild(c),n.options.interactive&&n.addInteractiveTarget(c)},_removePath:function(n){var c=n._container;xt(c),n.removeInteractiveTarget(c),delete this._layers[d(n)]},_updateStyle:function(n){var c=n._stroke,h=n._fill,b=n.options,I=n._container;I.stroked=!!b.stroke,I.filled=!!b.fill,b.stroke?(c||(c=n._stroke=ol("stroke")),I.appendChild(c),c.weight=b.weight+"px",c.color=b.color,c.opacity=b.opacity,b.dashArray?c.dashStyle=x(b.dashArray)?b.dashArray.join(" "):b.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=b.lineCap.replace("butt","flat"),c.joinstyle=b.lineJoin):c&&(I.removeChild(c),n._stroke=null),b.fill?(h||(h=n._fill=ol("fill")),I.appendChild(h),h.color=b.fillColor||b.color,h.opacity=b.fillOpacity):h&&(I.removeChild(h),n._fill=null)},_updateCircle:function(n){var c=n._point.round(),h=Math.round(n._radius),b=Math.round(n._radiusY||h);this._setPath(n,n._empty()?"M0 0":"AL "+c.x+","+c.y+" "+h+","+b+" 0,"+65535*360)},_setPath:function(n,c){n._path.v=c},_bringToFront:function(n){fo(n._container)},_bringToBack:function(n){Fo(n._container)}},sr=Ge.vml?ol:Ce,sl=xs.extend({_initContainer:function(){this._container=sr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=sr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){xt(this._container),It(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){xs.prototype._update.call(this);var n=this._bounds,c=n.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,h.setAttribute("width",c.x),h.setAttribute("height",c.y)),qt(h,n.min),h.setAttribute("viewBox",[n.min.x,n.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(n){var c=n._path=sr("path");n.options.className&&ht(c,n.options.className),n.options.interactive&&ht(c,"leaflet-interactive"),this._updateStyle(n),this._layers[d(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){xt(n._path),n.removeInteractiveTarget(n._path),delete this._layers[d(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var c=n._path,h=n.options;c&&(h.stroke?(c.setAttribute("stroke",h.color),c.setAttribute("stroke-opacity",h.opacity),c.setAttribute("stroke-width",h.weight),c.setAttribute("stroke-linecap",h.lineCap),c.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?c.setAttribute("stroke-dasharray",h.dashArray):c.removeAttribute("stroke-dasharray"),h.dashOffset?c.setAttribute("stroke-dashoffset",h.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),h.fill?(c.setAttribute("fill",h.fillColor||h.color),c.setAttribute("fill-opacity",h.fillOpacity),c.setAttribute("fill-rule",h.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(n,c){this._setPath(n,le(n._parts,c))},_updateCircle:function(n){var c=n._point,h=Math.max(Math.round(n._radius),1),b=Math.max(Math.round(n._radiusY),1)||h,I="a"+h+","+b+" 0 1,0 ",z=n._empty()?"M0 0":"M"+(c.x-h)+","+c.y+I+h*2+",0 "+I+-h*2+",0 ";this._setPath(n,z)},_setPath:function(n,c){n._path.setAttribute("d",c)},_bringToFront:function(n){fo(n._path)},_bringToBack:function(n){Fo(n._path)}});Ge.vml&&sl.include(sm);function pd(n){return Ge.svg||Ge.vml?new sl(n):null}gt.include({getRenderer:function(n){var c=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var c=this._paneRenderers[n];return c===void 0&&(c=this._createRenderer({pane:n}),this._paneRenderers[n]=c),c},_createRenderer:function(n){return this.options.preferCanvas&&fd(n)||pd(n)}});var vd=ia.extend({initialize:function(n,c){ia.prototype.initialize.call(this,this._boundsToLatLngs(n),c)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=Je(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function am(n,c){return new vd(n,c)}sl.create=sr,sl.pointsToPath=le,Wo.geometryToLayer=Fa,Wo.coordsToLatLng=tl,Wo.coordsToLatLngs=ki,Wo.latLngToCoords=Ua,Wo.latLngsToCoords=_i,Wo.getFeature=la,Wo.asFeature=bi,gt.mergeOptions({boxZoom:!0});var md=Ht.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){lt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){It(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){xt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),yn(),Pa(),this._startPoint=this._map.mouseEventToContainerPoint(n),lt(document,{contextmenu:Go,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=vt("div","leaflet-zoom-box",this._container),ht(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var c=new ue(this._point,this._startPoint),h=c.getSize();qt(this._box,c.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(xt(this._box),Ut(this._container,"leaflet-crosshair")),In(),zt(),It(document,{contextmenu:Go,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var c=new et(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});gt.addInitHook("addHandler","boxZoom",md),gt.mergeOptions({doubleClickZoom:!0});var gd=Ht.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var c=this._map,h=c.getZoom(),b=c.options.zoomDelta,I=n.originalEvent.shiftKey?h-b:h+b;c.options.doubleClickZoom==="center"?c.setZoom(I):c.setZoomAround(n.containerPoint,I)}});gt.addInitHook("addHandler","doubleClickZoom",gd),gt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var yd=Ht.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new At(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}ht(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Ut(this._map._container,"leaflet-grab"),Ut(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=Je(this._map.options.maxBounds);this._offsetLimit=De(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var c=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(c),this._prunePositions(c)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,c){return n-(n-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;n.x<c.min.x&&(n.x=this._viscousLimit(n.x,c.min.x)),n.y<c.min.y&&(n.y=this._viscousLimit(n.y,c.min.y)),n.x>c.max.x&&(n.x=this._viscousLimit(n.x,c.max.x)),n.y>c.max.y&&(n.y=this._viscousLimit(n.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,c=Math.round(n/2),h=this._initialWorldOffset,b=this._draggable._newPos.x,I=(b-c+h)%n+c-h,z=(b+c+h)%n-c-h,oe=Math.abs(I+h)<Math.abs(z+h)?I:z;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=oe},_onDragEnd:function(n){var c=this._map,h=c.options,b=!h.inertia||n.noInertia||this._times.length<2;if(c.fire("dragend",n),b)c.fire("moveend");else{this._prunePositions(+new Date);var I=this._lastPos.subtract(this._positions[0]),z=(this._lastTime-this._times[0])/1e3,oe=h.easeLinearity,_e=I.multiplyBy(oe/z),Ie=_e.distanceTo([0,0]),Fe=Math.min(h.inertiaMaxSpeed,Ie),nt=_e.multiplyBy(Fe/Ie),ct=Fe/(h.inertiaDeceleration*oe),kt=nt.multiplyBy(-ct/2).round();!kt.x&&!kt.y?c.fire("moveend"):(kt=c._limitOffset(kt,c.options.maxBounds),P(function(){c.panBy(kt,{duration:ct,easeLinearity:oe,noMoveStart:!0,animate:!0})}))}}});gt.addInitHook("addHandler","dragging",yd),gt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var kd=Ht.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),lt(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),It(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,c=document.documentElement,h=n.scrollTop||c.scrollTop,b=n.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(b,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var c=this._panKeys={},h=this.keyCodes,b,I;for(b=0,I=h.left.length;b<I;b++)c[h.left[b]]=[-1*n,0];for(b=0,I=h.right.length;b<I;b++)c[h.right[b]]=[n,0];for(b=0,I=h.down.length;b<I;b++)c[h.down[b]]=[0,n];for(b=0,I=h.up.length;b<I;b++)c[h.up[b]]=[0,-1*n]},_setZoomDelta:function(n){var c=this._zoomKeys={},h=this.keyCodes,b,I;for(b=0,I=h.zoomIn.length;b<I;b++)c[h.zoomIn[b]]=n;for(b=0,I=h.zoomOut.length;b<I;b++)c[h.zoomOut[b]]=-n},_addHooks:function(){lt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){It(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var c=n.keyCode,h=this._map,b;if(c in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(b=this._panKeys[c],n.shiftKey&&(b=fe(b).multiplyBy(3)),h.options.maxBounds&&(b=h._limitOffset(fe(b),h.options.maxBounds)),h.options.worldCopyJump){var I=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(b)));h.panTo(I)}else h.panBy(b)}else if(c in this._zoomKeys)h.setZoom(h.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;Go(n)}}});gt.addInitHook("addHandler","keyboard",kd),gt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var _d=Ht.extend({addHooks:function(){lt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){It(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var c=ci(n),h=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var b=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),b),Go(n)},_performZoom:function(){var n=this._map,c=n.getZoom(),h=this._map.options.zoomSnap||0;n._stop();var b=this._delta/(this._map.options.wheelPxPerZoomLevel*4),I=4*Math.log(2/(1+Math.exp(-Math.abs(b))))/Math.LN2,z=h?Math.ceil(I/h)*h:I,oe=n._limitZoom(c+(this._delta>0?z:-z))-c;this._delta=0,this._startTime=null,oe&&(n.options.scrollWheelZoom==="center"?n.setZoom(c+oe):n.setZoomAround(this._lastMousePos,c+oe))}});gt.addInitHook("addHandler","scrollWheelZoom",_d);var im=600;gt.mergeOptions({tapHold:Ge.touchNative&&Ge.safari&&Ge.mobile,tapTolerance:15});var bd=Ht.extend({addHooks:function(){lt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){It(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var c=n.touches[0];this._startPos=this._newPos=new U(c.clientX,c.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(lt(document,"touchend",Kt),lt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),im),lt(document,"touchend touchcancel contextmenu",this._cancel,this),lt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){It(document,"touchend",Kt),It(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),It(document,"touchend touchcancel contextmenu",this._cancel,this),It(document,"touchmove",this._onMove,this)},_onMove:function(n){var c=n.touches[0];this._newPos=new U(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,c){var h=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});h._simulated=!0,c.target.dispatchEvent(h)}});gt.addInitHook("addHandler","tapHold",bd),gt.mergeOptions({touchZoom:Ge.touch,bounceAtZoomLimits:!0});var wd=Ht.extend({addHooks:function(){ht(this._map._container,"leaflet-touch-zoom"),lt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Ut(this._map._container,"leaflet-touch-zoom"),It(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var c=this._map;if(!(!n.touches||n.touches.length!==2||c._animatingZoom||this._zooming)){var h=c.mouseEventToContainerPoint(n.touches[0]),b=c.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(h.add(b)._divideBy(2))),this._startDist=h.distanceTo(b),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),lt(document,"touchmove",this._onTouchMove,this),lt(document,"touchend touchcancel",this._onTouchEnd,this),Kt(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var c=this._map,h=c.mouseEventToContainerPoint(n.touches[0]),b=c.mouseEventToContainerPoint(n.touches[1]),I=h.distanceTo(b)/this._startDist;if(this._zoom=c.getScaleZoom(I,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&I<1||this._zoom>c.getMaxZoom()&&I>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,I===1)return}else{var z=h._add(b)._divideBy(2)._subtract(this._centerPoint);if(I===1&&z.x===0&&z.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(z),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),G(this._animRequest);var oe=l(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=P(oe,this,!0),Kt(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,G(this._animRequest),It(document,"touchmove",this._onTouchMove,this),It(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});gt.addInitHook("addHandler","touchZoom",wd),gt.BoxZoom=md,gt.DoubleClickZoom=gd,gt.Drag=yd,gt.Keyboard=kd,gt.ScrollWheelZoom=_d,gt.TapHold=bd,gt.TouchZoom=wd,o.Bounds=ue,o.Browser=Ge,o.CRS=be,o.Canvas=hd,o.Circle=el,o.CircleMarker=yi,o.Class=ne,o.Control=bn,o.DivIcon=ra,o.DivOverlay=ke,o.DomEvent=ui,o.DomUtil=Ho,o.Draggable=At,o.Evented=he,o.FeatureGroup=Zo,o.GeoJSON=Wo,o.GridLayer=Ss,o.Handler=Ht,o.Icon=aa,o.ImageOverlay=Ha,o.LatLng=Ze,o.LatLngBounds=et,o.Layer=yo,o.LayerGroup=sa,o.LineUtil=bc,o.Map=gt,o.Marker=gi,o.Mixin=Vn,o.Path=rs,o.Point=U,o.PolyUtil=Mn,o.Polygon=ia,o.Polyline=qo,o.Popup=tt,o.PosAnimation=ta,o.Projection=wc,o.Rectangle=vd,o.Renderer=xs,o.SVG=sl,o.SVGOverlay=ae,o.TileLayer=wn,o.Tooltip=Et,o.Transformation=Pe,o.Util=X,o.VideoOverlay=nl,o.bind=l,o.bounds=De,o.canvas=fd,o.circle=Ic,o.circleMarker=xc,o.control=Cs,o.divIcon=Ci,o.extend=s,o.featureGroup=vi,o.geoJSON=nr,o.geoJson=za,o.gridLayer=ca,o.icon=Ql,o.imageOverlay=or,o.latLng=He,o.latLngBounds=Je,o.layerGroup=pi,o.map=Ki,o.marker=Sc,o.point=fe,o.polygon=er,o.polyline=$c,o.popup=Lt,o.rectangle=am,o.setOptions=w,o.stamp=d,o.svg=pd,o.svgOverlay=ye,o.tileLayer=ud,o.tooltip=un,o.transformation=W,o.version=a,o.videoOverlay=H;var lm=window.L;o.noConflict=function(){return window.L=lm,this},window.L=o}))})(fl,fl.exports)),fl.exports}var Fb=Nb();const en=Ob(Fb);(function(e,t,o){function a(s,i){for(;(s=s.parentElement)&&!s.classList.contains(i););return s}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(s,i){this._map=s,this._container=s._container,this._overlayPane=s._panes.overlayPane,this._popupPane=s._panes.popupPane,i&&i.shapeOptions&&(i.shapeOptions=L.Util.extend({},this.options.shapeOptions,i.shapeOptions)),L.setOptions(this,i);var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(L.DomUtil.disableTextSelection(),s.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(s){L.setOptions(this,s)},_fireCreatedEvent:function(s){this._map.fire(L.Draw.Event.CREATED,{layer:s,layerType:this.type})},_cancelDrawing:function(s){s.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(s,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,s,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var s=this._markers.pop(),i=this._poly,l=i.getLatLngs(),u=l.splice(-1,1)[0];this._poly.setLatLngs(l),this._markerGroup.removeLayer(s),i.getLatLngs().length<2&&this._map.removeLayer(i),this._vertexChanged(u,!1)}},addVertex:function(s){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(s))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(s)),this._poly.addLatLng(s),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(s,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var s=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),i=this._poly.newLatLngIntersects(s[s.length-1]);if(!this.options.allowIntersection&&i||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(s){var i=this._map.mouseEventToLayerPoint(s.originalEvent),l=this._map.layerPointToLatLng(i);this._currentLatLng=l,this._updateTooltip(l),this._updateGuide(i),this._mouseMarker.setLatLng(l),L.DomEvent.preventDefault(s.originalEvent)},_vertexChanged:function(s,i){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(s,i),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(s){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(s),this._clickHandled=!0,this._disableNewMarkers();var i=s.originalEvent,l=i.clientX,u=i.clientY;this._startPoint.call(this,l,u)}},_startPoint:function(s,i){this._mouseDownOrigin=L.point(s,i)},_onMouseUp:function(s){var i=s.originalEvent,l=i.clientX,u=i.clientY;this._endPoint.call(this,l,u,s),this._clickHandled=null},_endPoint:function(s,i,l){if(this._mouseDownOrigin){var u=L.point(s,i).distanceTo(this._mouseDownOrigin),d=this._calculateFinishDistance(l.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(l.latlng),this._finishShape()):d<10&&L.Browser.touch?this._finishShape():Math.abs(u)<9*(e.devicePixelRatio||1)&&this.addVertex(l.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(s){var i,l,u=s.originalEvent;!u.touches||!u.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(i=u.touches[0].clientX,l=u.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,i,l),this._endPoint.call(this,i,l,s),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(s){var i;if(this._markers.length>0){var l;if(this.type===L.Draw.Polyline.TYPE)l=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;l=this._markers[0]}var u=this._map.latLngToContainerPoint(l.getLatLng()),d=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),p=this._map.latLngToContainerPoint(d.getLatLng());i=u.distanceTo(p)}else i=1/0;return i},_updateFinishHandler:function(){var s=this._markers.length;s>1&&this._markers[s-1].on("click",this._finishShape,this),s>2&&this._markers[s-2].off("click",this._finishShape,this)},_createMarker:function(s){var i=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(i),i},_updateGuide:function(s){var i=this._markers?this._markers.length:0;i>0&&(s=s||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[i-1].getLatLng()),s))},_updateTooltip:function(s){var i=this._getTooltipText();s&&this._tooltip.updatePosition(s),this._errorShown||this._tooltip.updateContent(i)},_drawGuide:function(s,i){var l,u,d,p=Math.floor(Math.sqrt(Math.pow(i.x-s.x,2)+Math.pow(i.y-s.y,2))),f=this.options.guidelineDistance,g=this.options.maxGuideLineLength,y=p>g?p-g:f;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));y<p;y+=this.options.guidelineDistance)l=y/p,u={x:Math.floor(s.x*(1-l)+l*i.x),y:Math.floor(s.y*(1-l)+l*i.y)},d=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),d.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(d,u)},_updateGuideColor:function(s){if(this._guidesContainer)for(var i=0,l=this._guidesContainer.childNodes.length;i<l;i++)this._guidesContainer.childNodes[i].style.backgroundColor=s},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var s,i,l=this.options.showLength;return this._markers.length===0?s={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(i=l?this._getMeasurementString():"",s=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:i}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:i}),s},_updateRunningMeasure:function(s,i){var l,u,d=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(l=d-(i?2:1),u=L.GeometryUtil.isVersion07x()?s.distanceTo(this._markers[l].getLatLng())*(this.options.factor||1):this._map.distance(s,this._markers[l].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=u*(i?1:-1))},_getMeasurementString:function(){var s,i=this._currentLatLng,l=this._markers[this._markers.length-1].getLatLng();return s=L.GeometryUtil.isVersion07x()?l&&i&&i.distanceTo?this._measurementRunningTotal+i.distanceTo(l)*(this.options.factor||1):this._measurementRunningTotal||0:l&&i?this._measurementRunningTotal+this._map.distance(i,l)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(s,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var s=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(s,i){L.Draw.Polyline.prototype.initialize.call(this,s,i),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var s=this._markers.length;s===1&&this._markers[0].on("click",this._finishShape,this),s>2&&(this._markers[s-1].on("dblclick",this._finishShape,this),s>3&&this._markers[s-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var s,i;return this._markers.length===0?s=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(s=L.drawLocal.draw.handlers.polygon.tooltip.cont,i=this._getMeasurementString()):(s=L.drawLocal.draw.handlers.polygon.tooltip.end,i=this._getMeasurementString()),{text:s,subtext:i}},_getMeasurementString:function(){var s=this._area,i="";return s||this.options.showLength?(this.options.showLength&&(i=L.Draw.Polyline.prototype._getMeasurementString.call(this)),s&&(i+="<br>"+L.GeometryUtil.readableArea(s,this.options.metric,this.options.precision)),i):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(s,i){var l;!this.options.allowIntersection&&this.options.showArea&&(l=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(l)),L.Draw.Polyline.prototype._vertexChanged.call(this,s,i)},_cleanUpShape:function(){var s=this._markers.length;s>0&&(this._markers[0].off("click",this._finishShape,this),s>2&&this._markers[s-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(s,i){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,s,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(s){this._isDrawing=!0,this._startLatLng=s.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(s.originalEvent)},_onMouseMove:function(s){var i=s.latlng;this._tooltip.updatePosition(i),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(i))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(s,i){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,i)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(s){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!a(s.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(s){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,s)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,s),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_getTooltipText:function(){var s,i,l,u=L.Draw.SimpleShape.prototype._getTooltipText.call(this),d=this._shape,p=this.options.showArea;return d&&(s=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),i=L.GeometryUtil.geodesicArea(s),l=p?L.GeometryUtil.readableArea(i,this.options.metric):""),{text:u.text,subtext:l}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(s,i){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(s){var i=s.latlng;this._tooltip.updatePosition(i),this._mouseMarker.setLatLng(i),this._marker?(i=this._mouseMarker.getLatLng(),this._marker.setLatLng(i)):(this._marker=this._createMarker(i),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(s){return new L.Marker(s,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(s){this._onMouseMove(s),this._onClick()},_fireCreatedEvent:function(){var s=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(s,i){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,i)},_fireCreatedEvent:function(){var s=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)},_createMarker:function(s){return new L.CircleMarker(s,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(s,i){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,i)},_drawShape:function(s){if(L.GeometryUtil.isVersion07x())var i=this._startLatLng.distanceTo(s);else var i=this._map.distance(this._startLatLng,s);this._shape?this._shape.setRadius(i):(this._shape=new L.Circle(this._startLatLng,i,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_onMouseMove:function(s){var i,l=s.latlng,u=this.options.showRadius,d=this.options.metric;if(this._tooltip.updatePosition(l),this._isDrawing){this._drawShape(l),i=this._shape.getRadius().toFixed(1);var p="";u&&(p=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(i,d,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:p})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(s,i){this._marker=s,L.setOptions(this,i)},addHooks:function(){var s=this._marker;s.dragging.enable(),s.on("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},removeHooks:function(){var s=this._marker;s.dragging.disable(),s.off("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},_onDragEnd:function(s){var i=s.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_toggleMarkerHighlight:function(){var s=this._marker._icon;s&&(s.style.display="none",L.DomUtil.hasClass(s,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,-4)):(L.DomUtil.addClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,4)),s.style.display="")},_offsetMarker:function(s,i){var l=parseInt(s.style.marginTop,10)-i,u=parseInt(s.style.marginLeft,10)-i;s.style.marginTop=l+"px",s.style.marginLeft=u+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(s){this.latlngs=[s._latlngs],s._holes&&(this.latlngs=this.latlngs.concat(s._holes)),this._poly=s,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(s){for(var i=0;i<this._verticesHandlers.length;i++)s(this._verticesHandlers[i])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(s){s.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(s){s.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(s){s.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var s=0;s<this.latlngs.length;s++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[s],this._poly.options.poly))},_updateLatLngs:function(s){this.latlngs=[s.layer._latlngs],s.layer._holes&&(this.latlngs=this.latlngs.concat(s.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(s,i,l){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=s,l&&l.drawError&&(l.drawError=L.Util.extend({},this.options.drawError,l.drawError)),this._latlngs=i,L.setOptions(this,l)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var s=this._poly,i=s._path;s instanceof L.Polygon||(s.options.fill=!1,s.options.editing&&(s.options.editing.fill=!1)),i&&s.options.editing&&s.options.editing.className&&(s.options.original.className&&s.options.original.className.split(" ").forEach(function(l){L.DomUtil.removeClass(i,l)}),s.options.editing.className.split(" ").forEach(function(l){L.DomUtil.addClass(i,l)})),s.setStyle(s.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var s=this._poly,i=s._path;i&&s.options.editing&&s.options.editing.className&&(s.options.editing.className.split(" ").forEach(function(l){L.DomUtil.removeClass(i,l)}),s.options.original.className&&s.options.original.className.split(" ").forEach(function(l){L.DomUtil.addClass(i,l)})),s.setStyle(s.options.original),s._map&&(s._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var s,i,l,u,d=this._defaultShape();for(s=0,l=d.length;s<l;s++)u=this._createMarker(d[s],s),u.on("click",this._onMarkerClick,this),u.on("contextmenu",this._onContextMenu,this),this._markers.push(u);var p,f;for(s=0,i=l-1;s<l;i=s++)(s!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(p=this._markers[i],f=this._markers[s],this._createMiddleMarker(p,f),this._updatePrevNext(p,f))},_createMarker:function(s,i){var l=new L.Marker.Touch(s,{draggable:!0,icon:this.options.icon});return l._origLatLng=s,l._index=i,l.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(l),l},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var s=this._defaultShape(),i=[].splice.apply(s,arguments);return this._poly._convertLatLngs(s,!0),this._poly.redraw(),i},_removeMarker:function(s){var i=s._index;this._markerGroup.removeLayer(s),this._markers.splice(i,1),this._spliceLatLngs(i,1),this._updateIndexes(i,-1),s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(s){var i=s.target,l=this._poly,u=L.LatLngUtil.cloneLatLng(i._origLatLng);if(L.extend(i._origLatLng,i._latlng),l.options.poly){var d=l._map._editTooltip;if(!l.options.poly.allowIntersection&&l.intersects()){L.extend(i._origLatLng,u),i.setLatLng(u);var p=l.options.color;l.setStyle({color:this.options.drawError.color}),d&&d.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){l.setStyle({color:p}),d&&d.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}i._middleLeft&&i._middleLeft.setLatLng(this._getMiddleLatLng(i._prev,i)),i._middleRight&&i._middleRight.setLatLng(this._getMiddleLatLng(i,i._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var f=this._poly.getLatLngs();this._poly._convertLatLngs(f,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(s){var i=L.Polygon&&this._poly instanceof L.Polygon?4:3,l=s.target;this._defaultShape().length<i||(this._removeMarker(l),this._updatePrevNext(l._prev,l._next),l._middleLeft&&this._markerGroup.removeLayer(l._middleLeft),l._middleRight&&this._markerGroup.removeLayer(l._middleRight),l._prev&&l._next?this._createMiddleMarker(l._prev,l._next):l._prev?l._next||(l._prev._middleRight=null):l._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(s){var i=s.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:i,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(s){var i=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),l=this._map.layerPointToLatLng(i),u=s.target;L.extend(u._origLatLng,l),u._middleLeft&&u._middleLeft.setLatLng(this._getMiddleLatLng(u._prev,u)),u._middleRight&&u._middleRight.setLatLng(this._getMiddleLatLng(u,u._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(s,i){this._markerGroup.eachLayer(function(l){l._index>s&&(l._index+=i)})},_createMiddleMarker:function(s,i){var l,u,d,p=this._getMiddleLatLng(s,i),f=this._createMarker(p);f.setOpacity(.6),s._middleRight=i._middleLeft=f,u=function(){f.off("touchmove",u,this);var g=i._index;f._index=g,f.off("click",l,this).on("click",this._onMarkerClick,this),p.lat=f.getLatLng().lat,p.lng=f.getLatLng().lng,this._spliceLatLngs(g,0,p),this._markers.splice(g,0,f),f.setOpacity(1),this._updateIndexes(g,1),i._index++,this._updatePrevNext(s,f),this._updatePrevNext(f,i),this._poly.fire("editstart")},d=function(){f.off("dragstart",u,this),f.off("dragend",d,this),f.off("touchmove",u,this),this._createMiddleMarker(s,f),this._createMiddleMarker(f,i)},l=function(){u.call(this),d.call(this),this._fireEdit()},f.on("click",l,this).on("dragstart",u,this).on("dragend",d,this).on("touchmove",u,this),this._markerGroup.addLayer(f)},_updatePrevNext:function(s,i){s&&(s._next=i),i&&(i._prev=s)},_getMiddleLatLng:function(s,i){var l=this._poly._map,u=l.project(s.getLatLng()),d=l.project(i.getLatLng());return l.unproject(u._add(d)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(s,i){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=s,L.Util.setOptions(this,i)},addHooks:function(){var s=this._shape;this._shape._map&&(this._map=this._shape._map,s.setStyle(s.options.editing),s._map&&(this._map=s._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var s=this._shape;if(s.setStyle(s.options.original),s._map){this._unbindMarker(this._moveMarker);for(var i=0,l=this._resizeMarkers.length;i<l;i++)this._unbindMarker(this._resizeMarkers[i]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(s,i){var l=new L.Marker.Touch(s,{draggable:!0,icon:i,zIndexOffset:10});return this._bindMarker(l),this._markerGroup.addLayer(l),l},_bindMarker:function(s){s.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(s){s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(s){s.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(s){var i=s.target,l=i.getLatLng();i===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(s){s.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(s){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s),typeof this._getCorners=="function"){var i=this._getCorners(),l=s.target,u=l._cornerIndex;l.setOpacity(0),this._oppositeCorner=i[(u+2)%4],this._toggleCornerMarkers(0,u)}this._shape.fire("editstart")},_onTouchMove:function(s){var i=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),l=this._map.layerPointToLatLng(i);return s.target===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),!1},_onTouchEnd:function(s){s.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getBounds(),i=s.getCenter();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){var s=this._getCorners();this._resizeMarkers=[];for(var i=0,l=s.length;i<l;i++)this._resizeMarkers.push(this._createMarker(s[i],this.options.resizeIcon)),this._resizeMarkers[i]._cornerIndex=i},_onMarkerDragStart:function(s){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s);var i=this._getCorners(),l=s.target,u=l._cornerIndex;this._oppositeCorner=i[(u+2)%4],this._toggleCornerMarkers(0,u)},_onMarkerDragEnd:function(s){var i,l,u=s.target;u===this._moveMarker&&(i=this._shape.getBounds(),l=i.getCenter(),u.setLatLng(l)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,s)},_move:function(s){for(var i,l=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),u=this._shape.getBounds(),d=u.getCenter(),p=[],f=0,g=l.length;f<g;f++)i=[l[f].lat-d.lat,l[f].lng-d.lng],p.push([s.lat+i[0],s.lng+i[1]]);this._shape.setLatLngs(p),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(s){var i;this._shape.setBounds(L.latLngBounds(s,this._oppositeCorner)),i=this._shape.getBounds(),this._moveMarker.setLatLng(i.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var s=this._shape.getBounds();return[s.getNorthWest(),s.getNorthEast(),s.getSouthEast(),s.getSouthWest()]},_toggleCornerMarkers:function(s){for(var i=0,l=this._resizeMarkers.length;i<l;i++)this._resizeMarkers[i].setOpacity(s)},_repositionCornerMarkers:function(){for(var s=this._getCorners(),i=0,l=this._resizeMarkers.length;i<l;i++)this._resizeMarkers[i].setLatLng(s[i])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getLatLng();this._moveMarker=this._createMarker(s,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(s){if(this._resizeMarkers.length){var i=this._getResizeMarkerPoint(s);this._resizeMarkers[0].setLatLng(i)}this._shape.setLatLng(s),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var s=this._shape.getLatLng(),i=this._getResizeMarkerPoint(s);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(i,this.options.resizeIcon))},_getResizeMarkerPoint:function(s){var i=this._shape._radius*Math.cos(Math.PI/4),l=this._map.project(s);return this._map.unproject([l.x+i,l.y-i])},_resize:function(s){var i=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=i.distanceTo(s):radius=this._map.distance(i,s),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(s,i){var l={};if(s.touches!==void 0){if(!s.touches.length)return;l=s.touches[0]}else if(s.pointerType!=="touch"||(l=s,!this._filterClick(s)))return;var u=this._map.mouseEventToContainerPoint(l),d=this._map.mouseEventToLayerPoint(l),p=this._map.layerPointToLatLng(d);this._map.fire(i,{latlng:p,layerPoint:d,containerPoint:u,pageX:l.pageX,pageY:l.pageY,originalEvent:s})},_filterClick:function(s){var i=s.timeStamp||s.originalEvent.timeStamp,l=L.DomEvent._lastClick&&i-L.DomEvent._lastClick;return l&&l>100&&l<500||s.target._simulatedClick&&!s._simulated?(L.DomEvent.stop(s),!1):(L.DomEvent._lastClick=i,!0)},_onTouchStart:function(s){this._map._loaded&&this._touchEvent(s,"touchstart")},_onTouchEnd:function(s){this._map._loaded&&this._touchEvent(s,"touchend")},_onTouchCancel:function(s){if(this._map._loaded){var i="touchcancel";this._detectIE()&&(i="pointercancel"),this._touchEvent(s,i)}},_onTouchLeave:function(s){this._map._loaded&&this._touchEvent(s,"touchleave")},_onTouchMove:function(s){this._map._loaded&&this._touchEvent(s,"touchmove")},_detectIE:function(){var s=e.navigator.userAgent,i=s.indexOf("MSIE ");if(i>0)return parseInt(s.substring(i+5,s.indexOf(".",i)),10);if(s.indexOf("Trident/")>0){var l=s.indexOf("rv:");return parseInt(s.substring(l+3,s.indexOf(".",l)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var s=this._icon,i=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?i.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):i.concat(["touchcancel"]),L.DomUtil.addClass(s,"leaflet-clickable"),L.DomEvent.on(s,"click",this._onMouseClick,this),L.DomEvent.on(s,"keypress",this._onKeyPress,this);for(var l=0;l<i.length;l++)L.DomEvent.on(s,i[l],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var s=e.navigator.userAgent,i=s.indexOf("MSIE ");if(i>0)return parseInt(s.substring(i+5,s.indexOf(".",i)),10);if(s.indexOf("Trident/")>0){var l=s.indexOf("rv:");return parseInt(s.substring(l+3,s.indexOf(".",l)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.LatLngUtil={cloneLatLngs:function(s){for(var i=[],l=0,u=s.length;l<u;l++)Array.isArray(s[l])?i.push(L.LatLngUtil.cloneLatLngs(s[l])):i.push(this.cloneLatLng(s[l]));return i},cloneLatLng:function(s){return L.latLng(s.lat,s.lng)}},(function(){var s={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(i){var l,u,d=i.length,p=0,f=Math.PI/180;if(d>2){for(var g=0;g<d;g++)l=i[g],u=i[(g+1)%d],p+=(u.lng-l.lng)*f*(2+Math.sin(l.lat*f)+Math.sin(u.lat*f));p=6378137*p*6378137/2}return Math.abs(p)},formattedNumber:function(i,l){var u=parseFloat(i).toFixed(l),d=L.drawLocal.format&&L.drawLocal.format.numeric,p=d&&d.delimiters,f=p&&p.thousands,g=p&&p.decimal;if(f||g){var y=u.split(".");u=f?y[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+f):y[0],g=g||".",y.length>1&&(u=u+g+y[1])}return u},readableArea:function(i,l,f){var d,p,f=L.Util.extend({},s,f);return l?(p=["ha","m"],type=typeof l,type==="string"?p=[l]:type!=="boolean"&&(p=l),d=i>=1e6&&p.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*i,f.km)+" km":i>=1e4&&p.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*i,f.ha)+" ha":L.GeometryUtil.formattedNumber(i,f.m)+" m"):(i/=.836127,d=i>=3097600?L.GeometryUtil.formattedNumber(i/3097600,f.mi)+" mi":i>=4840?L.GeometryUtil.formattedNumber(i/4840,f.ac)+" acres":L.GeometryUtil.formattedNumber(i,f.yd)+" yd"),d},readableDistance:function(i,l,u,d,g){var f,g=L.Util.extend({},s,g);switch(l?typeof l=="string"?l:"metric":u?"feet":d?"nauticalMile":"yards"){case"metric":f=i>1e3?L.GeometryUtil.formattedNumber(i/1e3,g.km)+" km":L.GeometryUtil.formattedNumber(i,g.m)+" m";break;case"feet":i*=3.28083,f=L.GeometryUtil.formattedNumber(i,g.ft)+" ft";break;case"nauticalMile":i*=.53996,f=L.GeometryUtil.formattedNumber(i/1e3,g.nm)+" nm";break;default:i*=1.09361,f=i>1760?L.GeometryUtil.formattedNumber(i/1760,g.mi)+" miles":L.GeometryUtil.formattedNumber(i,g.yd)+" yd"}return f},isVersion07x:function(){var i=L.version.split(".");return parseInt(i[0],10)===0&&parseInt(i[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(s,i,l,u){return this._checkCounterclockwise(s,l,u)!==this._checkCounterclockwise(i,l,u)&&this._checkCounterclockwise(s,i,l)!==this._checkCounterclockwise(s,i,u)},_checkCounterclockwise:function(s,i,l){return(l.y-s.y)*(i.x-s.x)>(i.y-s.y)*(l.x-s.x)}}),L.Polyline.include({intersects:function(){var s,i,l,u=this._getProjectedPoints(),d=u?u.length:0;if(this._tooFewPointsForIntersection())return!1;for(s=d-1;s>=3;s--)if(i=u[s-1],l=u[s],this._lineSegmentsIntersectsRange(i,l,s-2))return!0;return!1},newLatLngIntersects:function(s,i){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(s),i)},newPointIntersects:function(s,i){var l=this._getProjectedPoints(),u=l?l.length:0,d=l?l[u-1]:null,p=u-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(d,s,p,i?1:0)},_tooFewPointsForIntersection:function(s){var i=this._getProjectedPoints(),l=i?i.length:0;return l+=s||0,!i||l<=3},_lineSegmentsIntersectsRange:function(s,i,l,u){var d,p,f=this._getProjectedPoints();u=u||0;for(var g=l;g>u;g--)if(d=f[g-1],p=f[g],L.LineUtil.segmentsIntersect(s,i,d,p))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var s=[],i=this._defaultShape(),l=0;l<i.length;l++)s.push(this._map.latLngToLayerPoint(i[l]));return s}}),L.Polygon.include({intersects:function(){var s,i,l,u,d=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(s=d.length,i=d[0],l=d[s-1],u=s-2,this._lineSegmentsIntersectsRange(l,i,u,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(s){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,s);var i;this._toolbars={},L.DrawToolbar&&this.options.draw&&(i=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=i,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(i=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=i,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(s){var i,l=L.DomUtil.create("div","leaflet-draw"),u=!1;for(var d in this._toolbars)this._toolbars.hasOwnProperty(d)&&(i=this._toolbars[d].addToolbar(s))&&(u||(L.DomUtil.hasClass(i,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(i.childNodes[0],"leaflet-draw-toolbar-top"),u=!0),l.appendChild(i));return l},onRemove:function(){for(var s in this._toolbars)this._toolbars.hasOwnProperty(s)&&this._toolbars[s].removeToolbar()},setDrawingOptions:function(s){for(var i in this._toolbars)this._toolbars[i]instanceof L.DrawToolbar&&this._toolbars[i].setOptions(s)},_toolbarEnabled:function(s){var i=s.target;for(var l in this._toolbars)this._toolbars[l]!==i&&this._toolbars[l].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(s){L.setOptions(this,s),this._modes={},this._actionButtons=[],this._activeMode=null;var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(s){var i,l=L.DomUtil.create("div","leaflet-draw-section"),u=0,d=this._toolbarClass||"",p=this.getModeHandlers(s);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=s,i=0;i<p.length;i++)p[i].enabled&&this._initModeHandler(p[i].handler,this._toolbarContainer,u++,d,p[i].title);if(u)return this._lastButtonIndex=--u,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),l.appendChild(this._toolbarContainer),l.appendChild(this._actionsContainer),l},removeToolbar:function(){for(var s in this._modes)this._modes.hasOwnProperty(s)&&(this._disposeButton(this._modes[s].button,this._modes[s].handler.enable,this._modes[s].handler),this._modes[s].handler.disable(),this._modes[s].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var i=0,l=this._actionButtons.length;i<l;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(s,i,l,u,d){var p=s.type;this._modes[p]={},this._modes[p].handler=s,this._modes[p].button=this._createButton({type:p,title:d,className:u+"-"+p,container:i,callback:this._modes[p].handler.enable,context:this._modes[p].handler}),this._modes[p].buttonIndex=l,this._modes[p].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(s){var i=L.DomUtil.create("a",s.className||"",s.container),l=L.DomUtil.create("span","sr-only",s.container);i.href="#",i.appendChild(l),s.title&&(i.title=s.title,l.innerHTML=s.title),s.text&&(i.innerHTML=s.text,l.innerHTML=s.text);var u=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(i,"click",L.DomEvent.stopPropagation).on(i,"mousedown",L.DomEvent.stopPropagation).on(i,"dblclick",L.DomEvent.stopPropagation).on(i,"touchstart",L.DomEvent.stopPropagation).on(i,"click",L.DomEvent.preventDefault).on(i,u,s.callback,s.context),i},_disposeButton:function(s,i){var l=this._detectIOS()?"touchstart":"click";L.DomEvent.off(s,"click",L.DomEvent.stopPropagation).off(s,"mousedown",L.DomEvent.stopPropagation).off(s,"dblclick",L.DomEvent.stopPropagation).off(s,"touchstart",L.DomEvent.stopPropagation).off(s,"click",L.DomEvent.preventDefault).off(s,l,i)},_handlerActivated:function(s){this.disable(),this._activeMode=this._modes[s.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(s){var i,l,u,d,p=this._actionsContainer,f=this.getActions(s),g=f.length;for(l=0,u=this._actionButtons.length;l<u;l++)this._disposeButton(this._actionButtons[l].button,this._actionButtons[l].callback);for(this._actionButtons=[];p.firstChild;)p.removeChild(p.firstChild);for(var y=0;y<g;y++)"enabled"in f[y]&&!f[y].enabled||(i=L.DomUtil.create("li","",p),d=this._createButton({title:f[y].title,text:f[y].text,container:i,callback:f[y].callback,context:f[y].context}),this._actionButtons.push({button:d,callback:f[y].callback}))},_showActionsToolbar:function(){var s=this._activeMode.buttonIndex,i=this._lastButtonIndex,l=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=l+"px",s===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),s===i&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(s){this._map=s,this._popupPane=s._panes.popupPane,this._visible=!1,this._container=s.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(s){return this._container?(s.subtext=s.subtext||"",s.subtext.length!==0||this._singleLineLabel?s.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(s.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+s.subtext+"</span><br />":"")+"<span>"+s.text+"</span>",s.text||s.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(s){var i=this._map.latLngToLayerPoint(s),l=this._container;return this._container&&(this._visible&&(l.style.visibility="inherit"),L.DomUtil.setPosition(l,i)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(s){for(var i in this.options)this.options.hasOwnProperty(i)&&s[i]&&(s[i]=L.extend({},this.options[i],s[i]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,s)},getModeHandlers:function(s){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(s,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(s,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(s,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(s,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(s,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(s,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(s){return[{enabled:s.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:s.completeShape,context:s},{enabled:s.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:s.deleteLastVertex,context:s},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(s){L.setOptions(this,s);for(var i in this._modes)this._modes.hasOwnProperty(i)&&s.hasOwnProperty(i)&&this._modes[i].handler.setOptions(s[i])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(s){s.edit&&(s.edit.selectedPathOptions===void 0&&(s.edit.selectedPathOptions=this.options.edit.selectedPathOptions),s.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,s.edit.selectedPathOptions)),s.remove&&(s.remove=L.extend({},this.options.remove,s.remove)),s.poly&&(s.poly=L.extend({},this.options.poly,s.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,s),this._selectedFeatureCount=0},getModeHandlers:function(s){var i=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(s,{featureGroup:i,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(s,{featureGroup:i}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(s){var i=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return s.removeAllLayers&&i.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),i},addToolbar:function(s){var i=L.Toolbar.prototype.addToolbar.call(this,s);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),i},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var s,i=this.options.featureGroup,l=i.getLayers().length!==0;this.options.edit&&(s=this._modes[L.EditToolbar.Edit.TYPE].button,l?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(s=this._modes[L.EditToolbar.Delete.TYPE].button,l?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(s,i){if(L.Handler.prototype.initialize.call(this,s),L.setOptions(this,i),this._featureGroup=i.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),s._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(s){this._revertLayer(s)},this)},save:function(){var s=new L.LayerGroup;this._featureGroup.eachLayer(function(i){i.edited&&(s.addLayer(i),i.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:s})},_backupLayer:function(s){var i=L.Util.stamp(s);this._uneditedLayerProps[i]||(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?this._uneditedLayerProps[i]={latlngs:L.LatLngUtil.cloneLatLngs(s.getLatLngs())}:s instanceof L.Circle?this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng()),radius:s.getRadius()}:(s instanceof L.Marker||s instanceof L.CircleMarker)&&(this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(s){var i=L.Util.stamp(s);s.edited=!1,this._uneditedLayerProps.hasOwnProperty(i)&&(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?s.setLatLngs(this._uneditedLayerProps[i].latlngs):s instanceof L.Circle?(s.setLatLng(this._uneditedLayerProps[i].latlng),s.setRadius(this._uneditedLayerProps[i].radius)):(s instanceof L.Marker||s instanceof L.CircleMarker)&&s.setLatLng(this._uneditedLayerProps[i].latlng),s.fire("revert-edited",{layer:s}))},_enableLayerEdit:function(s){var i,l,u=s.layer||s.target||s;this._backupLayer(u),this.options.poly&&(l=L.Util.extend({},this.options.poly),u.options.poly=l),this.options.selectedPathOptions&&(i=L.Util.extend({},this.options.selectedPathOptions),i.maintainColor&&(i.color=u.options.color,i.fillColor=u.options.fillColor),u.options.original=L.extend({},u.options),u.options.editing=i),u instanceof L.Marker?(u.editing&&u.editing.enable(),u.dragging.enable(),u.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):u.editing.enable()},_disableLayerEdit:function(s){var i=s.layer||s.target||s;i.edited=!1,i.editing&&i.editing.disable(),delete i.options.editing,delete i.options.original,this._selectedPathOptions&&(i instanceof L.Marker?this._toggleMarkerHighlight(i):(i.setStyle(i.options.previousOptions),delete i.options.previousOptions)),i instanceof L.Marker?(i.dragging.disable(),i.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):i.editing.disable()},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_onMarkerDragEnd:function(s){var i=s.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_onTouchMove:function(s){var i=s.originalEvent.changedTouches[0],l=this._map.mouseEventToLayerPoint(i),u=this._map.layerPointToLatLng(l);s.target.setLatLng(u)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(s,i){if(L.Handler.prototype.initialize.call(this,s),L.Util.setOptions(this,i),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(s){this._deletableLayers.addLayer(s),s.fire("revert-deleted",{layer:s})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(s){this._removeLayer({layer:s})},this),this.save()},_enableLayerDelete:function(s){(s.layer||s.target||s).on("click",this._removeLayer,this)},_disableLayerDelete:function(s){var i=s.layer||s.target||s;i.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(i)},_removeLayer:function(s){var i=s.layer||s.target||s;this._deletableLayers.removeLayer(i),this._deletedLayers.addLayer(i),i.fire("deleted")},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const Gv=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"",ef=e=>e.length*6+12,Yc=(e,t)=>!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom),Ub=(e,t)=>{if(!e||t.length===0)return new Set;const o=[],a=e.getBounds();t.forEach(l=>{if(a.contains(l.getLatLng())){const u=e.latLngToContainerPoint(l.getLatLng()),d=l.locationData;d&&o.push({marker:l,pixelPos:u,location:d})}});const s=o.map(({marker:l,pixelPos:u,location:d})=>{const g=ef(d.name),y=d.description?ef(`${d.name}: ${Gv(d.description,50)}`):g;return{marker:l,location:d,markerBox:{left:u.x-15,right:u.x+15,top:u.y-15,bottom:u.y+15},baseLabelBox:{left:u.x-g/2,right:u.x+g/2,top:u.y+15+2,bottom:u.y+15+2+20},descLabelBox:d.description?{left:u.x-y/2,right:u.x+y/2,top:u.y+15+2,bottom:u.y+15+2+20}:null}}),i=new Set;return s.forEach(({marker:l,location:u,markerBox:d,baseLabelBox:p,descLabelBox:f},g)=>{if(!u.description)return;let y=!1;for(let _=0;_<s.length;_++){if(g===_)continue;const k=s[_];if(Yc(f,k.markerBox)||Yc(f,k.baseLabelBox)){y=!0;break}if(k.descLabelBox&&i.has(k.location.id)&&Yc(f,k.descLabelBox)){y=!0;break}}y||i.add(u.id)}),i},fr=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"hexagon",label:"Hexagon"},{value:"pentagon",label:"Pentagon"},{value:"diamond",label:"Diamond"},{value:"star",label:"Star"},{value:"dot",label:"Dot"},{value:"none",label:"None"}],zb=[{value:"33",label:"Small (33%)"},{value:"66",label:"Medium (66%)"},{value:"100",label:"Normal (100%)"},{value:"150",label:"Large (150%)"}],Hr=[{value:"default",label:"Default",isShapeOnly:!1,category:"default"},{value:"dot",label:"Dot",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"circle",label:"Circle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"square",label:"Square",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"triangle",label:"Triangle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"diamond",label:"Diamond",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"star",label:"Star",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"hexagon",label:"Hexagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"pentagon",label:"Pentagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"car",label:"Car",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"bike",label:"Bike",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"water",label:"Water",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"food",label:"Food",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"medical",label:"Medical",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"photo",label:"Photo",isShapeOnly:!1,category:"content",defaultColor:"#8B5CF6"},{value:"music",label:"Music",isShapeOnly:!1,category:"content",defaultColor:"#EC4899"},{value:"start",label:"Start",isShapeOnly:!1,category:"content",defaultColor:"#10B981"},{value:"finish",label:"Finish",isShapeOnly:!1,category:"content",defaultColor:"#1F2937"},{value:"toilet",label:"Toilet",isShapeOnly:!1,category:"content",defaultColor:"#6366F1"},{value:"shower",label:"Shower",isShapeOnly:!1,category:"content",defaultColor:"#06B6D4"},{value:"bus",label:"Bus",isShapeOnly:!1,category:"content",defaultColor:"#F97316"},{value:"info",label:"Information",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"merch",label:"Merchandise",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"cone",label:"Road closure",isShapeOnly:!1,category:"content",defaultColor:"#FF6B00"},{value:"traffic",label:"Traffic management",isShapeOnly:!1,category:"content",defaultColor:"#374151"},{value:"track",label:"Track",isShapeOnly:!1,category:"content",defaultColor:"#78716C"},{value:"tunnel",label:"Tunnel",isShapeOnly:!1,category:"content",defaultColor:"#57534E"},{value:"bridge",label:"Bridge",isShapeOnly:!1,category:"content",defaultColor:"#0284C7"},{value:"plane",label:"Plane",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"hill",label:"Hill",isShapeOnly:!1,category:"content",defaultColor:"#65A30D"},{value:"baggage",label:"Baggage",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"crown",label:"Crown",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"crossing",label:"Crossing point",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"trees",label:"Trees",isShapeOnly:!1,category:"content",defaultColor:"#22C55E"},{value:"arrow-uturn-left",label:"Left u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-left",label:"Left turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-left",label:"Slight left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-straight",label:"Straight ahead",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-right",label:"Slight right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-right",label:"Right turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-uturn-right",label:"Right u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-left",label:"Left fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-right",label:"Right fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-left",label:"Keep left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-right",label:"Keep right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"}];function oi(e){return Hr.find(t=>t.value===e)||Hr[0]}function Hb(e){return oi(e).defaultColor||"#667eea"}function Vb(e,t){return t||Hb(e)}const Iu={dot:(e,t=32)=>{const o=(t/2-2)*.33;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="1.5"/>
    </svg>`},circle:(e,t=32)=>{const o=t/2-2;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`},square:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect x="4" y="4" width="${t-8}" height="${t-8}" rx="4" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`,triangle:(e,t=32)=>{const o=t/2,a=4,s=t-4,i=4,l=t-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${a} ${l},${s} ${i},${s}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},diamond:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${a-s} ${o+s},${a} ${o},${a+s} ${o-s},${a}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},star:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-3,i=s*.4,l=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;l.push(`${o+s*Math.cos(d)},${a+s*Math.sin(d)}`);const p=d+Math.PI/5;l.push(`${o+i*Math.cos(p)},${a+i*Math.sin(p)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${l.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},hexagon:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-4,i=[];for(let l=0;l<6;l++){const u=Math.PI/6+l*Math.PI/3;i.push(`${o+s*Math.cos(u)},${a+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},pentagon:(e,t=32)=>{const o=t/2,a=t/2,s=t/2-4,i=[];for(let l=0;l<5;l++){const u=Math.PI/2*-1+l*2*Math.PI/5;i.push(`${o+s*Math.cos(u)},${a+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},car:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Car body -->
      <rect x="6" y="13" width="20" height="8" rx="2" fill="#fff"/>
      <!-- Car roof/cabin -->
      <path d="M10 13 L12 9 L20 9 L22 13" fill="#fff" stroke="#fff" stroke-width="1"/>
      <!-- Windows -->
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${e}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${e}"/>
      <!-- Tires (always black) -->
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <!-- Wheel centers -->
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>
    </svg>`,bike:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Tires (same color as bike) -->
      <circle cx="9" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <!-- Wheel centers -->
      <circle cx="9" cy="20" r="1" fill="#fff"/>
      <circle cx="23" cy="20" r="1" fill="#fff"/>
      <!-- Frame -->
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
      <!-- Handlebars -->
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <!-- Seat -->
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="#fff"/>
    </svg>`},tf={water:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="#fff"/>
    </svg>`,food:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="#fff"/>
      <path d="M21 9v14h2V9h-2z" fill="#fff"/>
    </svg>`,medical:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#fff" stroke-width="2"/>
      <rect x="14" y="8" width="4" height="16" rx="1" fill="#fff"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="#fff"/>
    </svg>`,photo:(e=32)=>{const t="#8B5CF6";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="8" y="10" width="16" height="12" rx="2" fill="#fff"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" y="13" r="1" fill="${t}"/>
    </svg>`},music:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EC4899" stroke="#fff" stroke-width="2"/>
      <path d="M12 22c1.66 0 3-1.34 3-3v-9h5v4h-3v5c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.35 0 .69.07 1 .18V10c0-.55.45-1 1-1h5c.55 0 1 .45 1 1v6h-5v5c0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.7 0 1.37.15 2 .41" fill="#fff"/>
      <ellipse cx="12" cy="21" rx="2.5" ry="2" fill="#fff"/>
      <rect x="14" y="10" width="2" height="9" fill="#fff"/>
      <rect x="14" y="10" width="6" height="2" fill="#fff"/>
    </svg>`,start:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#10B981" stroke="#fff" stroke-width="2"/>
      <path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="#fff"/>
    </svg>`,finish:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#1F2937" stroke="#fff" stroke-width="2"/>
      <rect x="10" y="8" width="4" height="4" fill="#fff"/>
      <rect x="14" y="12" width="4" height="4" fill="#fff"/>
      <rect x="18" y="8" width="4" height="4" fill="#fff"/>
      <rect x="10" y="16" width="4" height="4" fill="#fff"/>
      <rect x="18" y="16" width="4" height="4" fill="#fff"/>
      <rect x="14" y="20" width="4" height="4" fill="#fff"/>
    </svg>`,toilet:(e=32)=>{const t="#6366F1";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="11" y="7" width="10" height="3" rx="1" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>
    </svg>`},shower:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#06B6D4" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="3" fill="#fff"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="#fff"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
    </svg>`,bus:(e=32)=>{const t="#F97316";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="9" y="9" width="14" height="12" rx="2" fill="#fff"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="#fff"/>
      <circle cx="12" cy="21" r="1.5" fill="#fff"/>
      <circle cx="20" cy="21" r="1.5" fill="#fff"/>
    </svg>`},info:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#0EA5E9" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="2" fill="#fff"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="#fff"/>
    </svg>`,merch:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#A855F7" stroke="#fff" stroke-width="2"/>
      <path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="#fff"/>
      <path d="M13 10 L16 7 L19 10" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>`,cone:(e=32)=>{const t="#FF6B00";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L21 22 H11 L16 6Z" fill="#fff"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="#fff"/>
    </svg>`},traffic:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#374151" stroke="#fff" stroke-width="2"/>
      <rect x="12" y="6" width="8" height="20" rx="2" fill="#fff"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>
    </svg>`,crown:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="#fff"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="#fff"/>
    </svg>`,crossing:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="#fff" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="#fff" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="#fff"/>
      <path d="M16 10 L16 16" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
    </svg>`,trees:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#22C55E" stroke="#fff" stroke-width="2"/>
      <!-- Left tree -->
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="#fff"/>
      <!-- Right tree -->
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="#fff"/>
    </svg>`,"arrow-uturn-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on right, curve left, down on left -->
      <path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on left side -->
      <path d="M7 15 L12 21 L17 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="#fff"/>
    </svg>`,"arrow-slight-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-straight":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
    </svg>`,"arrow-slight-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="#fff"/>
    </svg>`,"arrow-uturn-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on left, curve right, down on right -->
      <path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on right side -->
      <path d="M15 15 L20 21 L25 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-fork-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (correct way - with arrow) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M10 12 L6 10 L8 16 Z" fill="#fff"/>
      <!-- Right fork (wrong way - with X) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
    </svg>`,"arrow-fork-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (wrong way - with X) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <!-- Right fork (correct way - with arrow) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M22 12 L26 10 L24 16 Z" fill="#fff"/>
    </svg>`,"arrow-keep-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-keep-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`},Mi={circle:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="14" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,square:({backgroundColor:e,borderColor:t})=>`<rect x="4" y="4" width="24" height="24" rx="4" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,hexagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",a=t==="none"?0:2,s=[];for(let i=0;i<6;i++){const l=Math.PI/6+i*Math.PI/3;s.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${a}" stroke-linejoin="round"/>`},pentagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",a=t==="none"?0:2,s=[];for(let i=0;i<5;i++){const l=Math.PI/2*-1+i*2*Math.PI/5;s.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${a}" stroke-linejoin="round"/>`},diamond:({backgroundColor:e,borderColor:t})=>`<polygon points="16,4 28,16 16,28 4,16" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}" stroke-linejoin="round"/>`,star:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",a=t==="none"?0:2,s=13,i=s*.4,l=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;l.push(`${16+s*Math.cos(d)},${16+s*Math.sin(d)}`);const p=d+Math.PI/5;l.push(`${16+i*Math.cos(p)},${16+i*Math.sin(p)}`)}return`<polygon points="${l.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${a}" stroke-linejoin="round"/>`},dot:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="5" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:1.5}"/>`,none:()=>""},nf={water:(e="#fff")=>`<path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="${e}"/>`,food:(e="#fff")=>`<path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="${e}"/>
      <path d="M21 9v14h2V9h-2z" fill="${e}"/>`,medical:(e="#fff")=>`<rect x="14" y="8" width="4" height="16" rx="1" fill="${e}"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="${e}"/>`,photo:(e="#fff",t="#667eea")=>`<rect x="8" y="10" width="16" height="12" rx="2" fill="${e}"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" cy="13" r="1" fill="${t}"/>`,music:(e="#fff")=>`<ellipse cx="12" cy="21" rx="2.5" ry="2" fill="${e}"/>
      <rect x="14" y="10" width="2" height="9" fill="${e}"/>
      <rect x="14" y="10" width="6" height="2" fill="${e}"/>`,start:(e="#fff")=>`<path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="${e}"/>`,finish:(e="#fff")=>`<rect x="10" y="8" width="4" height="4" fill="${e}"/>
      <rect x="14" y="12" width="4" height="4" fill="${e}"/>
      <rect x="18" y="8" width="4" height="4" fill="${e}"/>
      <rect x="10" y="16" width="4" height="4" fill="${e}"/>
      <rect x="18" y="16" width="4" height="4" fill="${e}"/>
      <rect x="14" y="20" width="4" height="4" fill="${e}"/>`,toilet:(e="#fff",t="#667eea")=>`<rect x="11" y="7" width="10" height="3" rx="1" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="${e}" stroke-width="2" fill="none" stroke-linecap="round"/>`,shower:(e="#fff")=>`<circle cx="16" cy="10" r="3" fill="${e}"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="${e}"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>`,bus:(e="#fff",t="#667eea")=>`<rect x="9" y="9" width="14" height="12" rx="2" fill="${e}"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="${e}"/>
      <circle cx="12" cy="21" r="1.5" fill="${e}"/>
      <circle cx="20" cy="21" r="1.5" fill="${e}"/>`,info:(e="#fff")=>`<circle cx="16" cy="10" r="2" fill="${e}"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="${e}"/>`,merch:(e="#fff")=>`<path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="${e}"/>
      <path d="M13 10 L16 7 L19 10" stroke="${e}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`,cone:(e="#fff",t="#667eea")=>`<path d="M16 6 L21 22 H11 L16 6Z" fill="${e}"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="${e}"/>`,traffic:(e="#fff")=>`<rect x="12" y="6" width="8" height="20" rx="2" fill="${e}"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>`,car:(e="#fff",t="#667eea")=>`<rect x="6" y="13" width="20" height="8" rx="2" fill="${e}"/>
      <path d="M10 13 L12 9 L20 9 L22 13" fill="${e}" stroke="${e}" stroke-width="1"/>
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${t}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${t}"/>
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>`,bike:(e="#fff")=>`<circle cx="9" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="9" cy="20" r="1" fill="${e}"/>
      <circle cx="23" cy="20" r="1" fill="${e}"/>
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="${e}" stroke-width="2" stroke-linejoin="round"/>
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="${e}"/>`,"arrow-uturn-left":(e="#fff")=>`<path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7 15 L12 21 L17 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-left":(e="#fff")=>`<path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="${e}"/>`,"arrow-slight-left":(e="#fff")=>`<g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-straight":(e="#fff")=>`<path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>`,"arrow-slight-right":(e="#fff")=>`<g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-right":(e="#fff")=>`<path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="${e}"/>`,"arrow-uturn-right":(e="#fff")=>`<path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 15 L20 21 L25 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-fork-left":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Left arrowhead -->
      <path d="M10 12 L6 10 L8 16 Z" fill="${e}"/>
      <!-- Wrong way indicator on right -->
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>`,"arrow-fork-right":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <!-- Wrong way indicator on left -->
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Right arrowhead -->
      <path d="M22 12 L26 10 L24 16 Z" fill="${e}"/>`,"arrow-keep-left":(e="#fff")=>`<g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-keep-right":(e="#fff")=>`<g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,track:(e="#fff")=>`
      <rect x="10" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="19.5" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="8" y="9" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="14.5" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="20" width="16" height="2.5" rx="0.5" fill="${e}"/>`,tunnel:(e="#fff")=>`
      <path d="M7 25 L7 14 C7 8 11 5 16 5 C21 5 25 8 25 14 L25 25" fill="none" stroke="${e}" stroke-width="2.5"/>
      <path d="M11 25 L11 16 C11 12 13 10 16 10 C19 10 21 12 21 16 L21 25" fill="none" stroke="${e}" stroke-width="1.5" opacity="0.6"/>`,bridge:(e="#fff")=>`
      <rect x="5" y="18" width="22" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="7" y="10" width="2" height="8" fill="${e}"/>
      <rect x="23" y="10" width="2" height="8" fill="${e}"/>
      <path d="M8 10 Q16 6 24 10" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <line x1="12" y1="13" x2="12" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="16" y1="11.5" x2="16" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="20" y1="13" x2="20" y2="18" stroke="${e}" stroke-width="1.5"/>`,plane:(e="#fff")=>`
      <g fill="${e}">
        <!-- Fuselage body -->
        <path d="M27 16 L24 14 L8 14 Q4 16 8 18 L24 18 L27 16 Z"/>
        <!-- Nose cone -->
        <path d="M8 14 Q4 16 8 18 L8 14 Z"/>
        <!-- Tail fin -->
        <path d="M26 14 L26 9 L22 14 Z"/>
        <!-- Main wing -->
        <path d="M20 16 L16 10 L14 10 L16 16 L14 22 L16 22 L20 16 Z"/>
        <!-- Cockpit window -->
        <ellipse cx="10" cy="16" rx="1.5" ry="1" fill="none" stroke="${e}" stroke-width="0.5" opacity="0.6"/>
      </g>`,hill:(e="#fff")=>`
      <path d="M6 24 L13 12 L16 16 L20 10 L26 24 Z" fill="${e}"/>
      <path d="M20 10 L22 13 L18 13 Z" fill="${e}" opacity="0.6"/>`,baggage:(e="#fff")=>`
      <rect x="8" y="12" width="16" height="12" rx="2" fill="${e}"/>
      <rect x="12" y="8" width="8" height="4" rx="1" fill="none" stroke="${e}" stroke-width="2"/>
      <line x1="12" y1="16" x2="20" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
      <line x1="12" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>`,crown:(e="#fff")=>`
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="${e}"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="${e}"/>`,crossing:(e="#fff")=>`
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="${e}" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="${e}" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="${e}"/>
      <path d="M16 10 L16 16" stroke="${e}" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>`,trees:(e="#fff")=>`
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="${e}"/>
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="${e}"/>`};function Cn({type:e,backgroundShape:t="circle",backgroundColor:o,borderColor:a,iconColor:s,size:i="100",outputSize:l=null}){if(!e||e==="default"){if(!(o||a||s||t&&t!=="circle"&&t!=="default"))return null;e=t&&t!=="default"?t:"circle"}const u=oi(e),d=parseInt(i,10)/100,p=l||Math.round(32*d);let f="";if(u.isShapeOnly){const g=o||u.defaultColor||"#667eea",y=a||"#fff";if(Mi[e])f=Mi[e]({backgroundColor:g,borderColor:y});else return Iu[e]?.(g,p)||null}else{const g=o||"#667eea",y=a||"#fff",_=s||"#fff",k=t||"circle";k!=="none"&&Mi[k]&&(f+=Mi[k]({backgroundColor:g,borderColor:y})),nf[e]&&(f+=nf[e](_,g))}return`<svg width="${p}" height="${p}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
    ${f}
  </svg>`}const Gb={full:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#10B981" stroke="#fff" stroke-width="1.5"/>
    <path d="M4 7l2 2 4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </svg>`,partial:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#F59E0B" stroke="#fff" stroke-width="1.5"/>
    <rect x="6" y="3.5" width="2" height="4.5" rx="1" fill="#fff"/>
    <circle cx="7" cy="10" r="1" fill="#fff"/>
  </svg>`,missing:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#EF4444" stroke="#fff" stroke-width="1.5"/>
    <path d="M4.5 4.5l5 5M9.5 4.5l-5 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
  </svg>`};function jb(e,t){return e===0?"missing":e>=t?"full":"partial"}function $u(e,t){const o=jb(e,t);return Gb[o]}function Zb(e,t,o=32){if(e==="default")return null;if(tf[e])return tf[e](o);if(Iu[e]){const a=t||"#667eea";return Iu[e](a,o)}return null}const qb=["circle","square","hexagon","pentagon"];function Wb(e){return qb.includes(e)}function Kb(e,t,o,a,s=32,i=!0){const l=Zb(e,t,s),u=$u(o,a);if(!l)return null;const d=i&&Wb(e),p=Vb(e,t),f=Yb(p),g=jv(p)?"0 1px 2px rgba(255,255,255,0.5)":"0 1px 2px rgba(0,0,0,0.5)",y=s>=36?"12px":"10px",_=d?`
    <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: ${f};
      font-weight: bold;
      font-size: ${y};
      text-shadow: ${g};
      pointer-events: none;
    ">${o}/${a}</div>
  `:"";return`
    <div style="position: relative; width: ${s}px; height: ${s}px;">
      ${l}
      ${_}
      <div style="position: absolute; bottom: -4px; right: -4px;">
        ${u}
      </div>
    </div>
  `}function Jb(e){const t=e.replace("#",""),o=parseInt(t.substr(0,2),16)/255,a=parseInt(t.substr(2,2),16)/255,s=parseInt(t.substr(4,2),16)/255,i=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),l=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*i+.7152*l+.0722*u}function jv(e){return!e||e.length<6?!1:Jb(e)>.4}function Yb(e){return jv(e)?"#1F2937":"#FFFFFF"}const Xb={class:"map-container-wrapper"},Qb="#667eea",e0={__name:"MapView",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},clickable:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1},editingPolygon:{type:Array,default:null},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","polygon-complete","polygon-drawing","polygon-update","visibility-change"],setup(e,{expose:t,emit:o}){const a=e,s=o,i=$(null);let l=null;const u=$([]),d=$([]),p=$([]);let f=null,g=null;const y=$([]);let _=null,k=null,w=!1;const S=$(!1),E=()=>{if(l){const we=l.getCenter();return{lat:we.lat,lng:we.lng}}return null},A=()=>l?l.getZoom():null,x=()=>{if(u.value.length>0){p.value.push([...u.value]);const we=d.value.pop()||[];u.value=we,Ce(),s("polygon-drawing",u.value)}},D=()=>{if(p.value.length>0){d.value.push([...u.value]);const we=p.value.pop();u.value=we,Ce(),s("polygon-drawing",u.value)}},R=()=>u.value.length>0,F=()=>p.value.length>0,T=()=>u.value.length,N=()=>{u.value.length>=3&&(s("polygon-complete",[...u.value]),B())},B=()=>{u.value=[],d.value=[],p.value=[],Ce()},q=()=>{!l||!a.userLocation||(l.setView([a.userLocation.lat,a.userLocation.lng],l.getZoom(),{animate:!0,duration:.5}),S.value=!0)},P=(we,ge,Z=null)=>{if(!l||we==null||ge==null)return;l.setView([we,ge],Z??l.getZoom(),{animate:!0,duration:.5});const se=a.center&&Math.abs(a.center.lat-we)<1e-4&&Math.abs(a.center.lng-ge)<1e-4;S.value=!se},G=$(!0),X=$(!0),ne=(we,ge)=>{if(!l||we==null||ge==null)return!0;const Z=l.getBounds(),se=en.latLng(we,ge);return Z.contains(se)};t({getMapCenter:E,getMapZoom:A,undoPolygonPoint:x,redoPolygonPoint:D,canUndo:R,canRedo:F,getPolygonPointCount:T,completePolygon:N,clearPolygonDrawing:B,recenterOnUserLocation:q,recenterOnLocation:P,isLocationInView:ne,userLocationInView:X,highlightedLocationInView:G});const K=$([]);let Q=null;const he=$(!0),U=$(!1),ee=$(new Set),fe=$([]);let ue=null,De=null;const et=V(()=>a.hideRecenterButton||!a.highlightLocationId||!S.value?!1:!G.value),Je=$({}),Ze=()=>{const we={};if(a.highlightLocationId){const ge=a.locations.find(Z=>Z.id===a.highlightLocationId);if(ge?.latitude&&ge?.longitude){const Z=ne(ge.latitude,ge.longitude);G.value=Z,we[a.highlightLocationId]=Z,Je.value=we;return}}if(a.highlightLocationIds&&a.highlightLocationIds.length>0){let ge=!0;for(const Z of a.highlightLocationIds){const se=a.locations.find(ce=>ce.id===Z);if(se?.latitude&&se?.longitude){const ce=ne(se.latitude,se.longitude);we[Z]=ce,ce||(ge=!1)}else we[Z]=!0}G.value=ge,Je.value=we;return}if(!l){G.value=!0,Je.value={};return}G.value=!0,Je.value={}},He=()=>{if(!l||!a.userLocation){X.value=!0;return}X.value=ne(a.userLocation.lat,a.userLocation.lng)},be=()=>{Ze(),He(),s("visibility-change",{userLocationInView:X.value,highlightedLocationInView:G.value,highlightedLocationsVisibility:Je.value})},Ve=()=>{if(!l||!a.highlightLocationId)return;const we=a.locations.find(ge=>ge.id===a.highlightLocationId);!we||!we.latitude||!we.longitude||(l.setView([we.latitude,we.longitude],l.getZoom(),{animate:!0,duration:.5}),S.value=!1,G.value=!0)},ve=(we,ge,Z,se,ce=!1)=>{const Te=Z?"36px":se?"20px":"30px",Oe=Z?"#667eea":"white",Be=ce?"":$u(we,ge);return`
    <div style="position: relative; width: ${Te}; height: ${Te};">
      <div style="
        background-color: ${Qb};
        width: ${Te};
        height: ${Te};
        border-radius: 50%;
        border: 3px solid ${Oe};
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      "></div>
      ${ce?"":`<div style="position: absolute; bottom: -4px; right: -4px;">
        ${Be}
      </div>`}
    </div>
  `},Le=()=>{if(!l)return;const we=Ub(l,K.value),ge=Array.from(ee.value).sort().join(","),Z=Array.from(we).sort().join(",");ge!==Z&&(ee.value=we,Se())},Pe=()=>{if(De&&(De.remove(),De=null),!l||!a.userLocation)return;const we=en.divIcon({className:"user-location-marker",html:`
      <div style="
        position: relative;
        width: 20px;
        height: 20px;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #4285f4;
          border: 3px solid white;
          border-radius: 50%;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        "></div>
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 40px;
          height: 40px;
          background-color: rgba(66, 133, 244, 0.2);
          border-radius: 50%;
          animation: pulse 2s ease-out infinite;
        "></div>
      </div>
    `,iconSize:[40,40],iconAnchor:[20,20]});De=en.marker([a.userLocation.lat,a.userLocation.lng],{icon:we}).addTo(l).bindPopup("Your location")},W=()=>{if(!i.value)return;let we=51.505,ge=-.09,Z=13;const se=a.allLocationsForBounds.length>0?a.allLocationsForBounds:a.locations,ce=(Oe,Be)=>Oe!=null&&Be!=null&&!(Oe===0&&Be===0),Te=[];se.length>0&&Te.push(...se.filter(Oe=>ce(Oe.latitude,Oe.longitude)).map(Oe=>({lat:Oe.latitude,lng:Oe.longitude}))),a.route&&a.route.length>0&&Te.push(...a.route.filter(Oe=>ce(Oe.lat,Oe.lng)).map(Oe=>({lat:Oe.lat,lng:Oe.lng}))),a.center?(we=a.center.lat,ge=a.center.lng,Z=a.zoom??13):Te.length>0&&(we=Te.reduce((Oe,Be)=>Oe+Be.lat,0)/Te.length,ge=Te.reduce((Oe,Be)=>Oe+Be.lng,0)/Te.length,Z=10),l=en.map(i.value).setView([we,ge],Z),en.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(l),a.clickable&&l.on("click",Oe=>{a.drawingMode||s("map-click",{lat:Oe.latlng.lat,lng:Oe.latlng.lng})}),l.on("zoomstart",()=>{Re=!0}),l.on("zoomend moveend",()=>{Re=!1,te?Se():Le(),be()}),l.on("dragstart",()=>{S.value=!0}),Se(),Y(),pe(),Pe(),j(),J(),l.whenReady(()=>{be()})},Y=()=>{if(Q&&(Q.remove(),Q=null),!l||a.route.length===0)return;const we=a.route.map(ge=>[ge.lat,ge.lng]);Q=en.polyline(we,{color:"blue",weight:4,opacity:.7}).addTo(l)},pe=()=>{fe.value.forEach(we=>we.remove()),fe.value=[],!(!l||a.areas.length===0)&&a.areas.forEach(we=>{const ge=typeof we.polygon=="string"?JSON.parse(we.polygon):we.polygon;if(!ge||ge.length===0)return;const Z=ge.map(Oe=>[Oe.lat,Oe.lng]),se=we.id===a.selectedAreaId,ce=we.color||"#667eea",Te=en.polygon(Z,{color:ce,fillColor:ce,fillOpacity:se?.4:.2,weight:se?3:2,opacity:.8}).addTo(l);Te.setStyle({pane:"overlayPane"}),a.drawingMode||(Te.on("click",()=>s("area-click",we)),Te.on("mouseover",()=>{Te.setStyle({fillOpacity:.4})}),Te.on("mouseout",()=>{Te.setStyle({fillOpacity:se?.4:.2})})),fe.value.push(Te)})},Ce=()=>{if(l&&(f&&(f.remove(),f=null),g&&(g.remove(),g=null),u.value.length!==0&&(g=en.layerGroup().addTo(l),u.value.forEach((we,ge)=>{const Z=ge===0,se=ge===u.value.length-1,ce=en.divIcon({className:"polygon-point-marker",html:`<div style="
        width: ${Z?"16px":"12px"};
        height: ${Z?"16px":"12px"};
        background-color: ${Z?"#667eea":se?"#ff9800":"white"};
        border: 3px solid #667eea;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      "></div>`,iconSize:[Z?16:12,Z?16:12],iconAnchor:[Z?8:6,Z?8:6]});en.marker([we.lat,we.lng],{icon:ce,interactive:!1}).addTo(g)}),u.value.length>=2))){const we=u.value.map(ge=>[ge.lat,ge.lng]);u.value.length>=3&&we.push(we[0]),f=en.polyline(we,{color:"#667eea",weight:3,opacity:.8,dashArray:u.value.length<3?"10, 10":null}).addTo(l)}},le=()=>{if(!l||(_&&(_.remove(),_=null),k&&(k.remove(),k=null),y.value.length===0))return;const we=y.value.map(Z=>[Z.lat,Z.lng]);_=en.polygon(we,{color:"#667eea",fillColor:"#667eea",fillOpacity:.2,weight:3,opacity:.8,pane:"overlayPane"}).addTo(l),_.bringToFront(),k=en.layerGroup({pane:"markerPane"}).addTo(l);const ge=Z=>{y.value.length<=3||(y.value.splice(Z,1),w=!0,s("polygon-update",[...y.value]),le())};y.value.forEach((Z,se)=>{const ce=y.value.length>3,Te=en.divIcon({className:"polygon-edit-marker",html:`<div class="vertex-marker" style="
        position: relative;
        width: 16px;
        height: 16px;
        background-color: #667eea;
        border: 3px solid white;
        border-radius: 50%;
        box-shadow: 0 2px 6px rgba(0,0,0,0.4);
        cursor: move;
      "></div>`,iconSize:[16,16],iconAnchor:[8,8]}),Oe=en.marker([Z.lat,Z.lng],{icon:Te,draggable:!0}).addTo(k);if(Oe.on("drag",Be=>{const Xe=Be.target.getLatLng();y.value[se]={lat:Xe.lat,lng:Xe.lng};const mt=y.value.map(_t=>[_t.lat,_t.lng]);_.setLatLngs(mt)}),Oe.on("dragend",()=>{w=!0,s("polygon-update",[...y.value])}),Oe.on("contextmenu",Be=>{en.DomEvent.preventDefault(Be),ce&&ge(se)}),ce){const Be=document.createElement("div"),Xe=document.createElement("button");Xe.textContent="Delete point",Xe.style.cssText=`
        background: #dc3545;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9rem;
      `;const mt=_t=>{_t.preventDefault(),_t.stopPropagation(),Oe.closePopup(),ge(se)};Xe.addEventListener("click",mt),Xe.addEventListener("touchend",mt),Be.appendChild(Xe),Oe.bindPopup(Be,{closeButton:!1,className:"vertex-popup"})}})},J=(we=!0)=>{if(l){if(!a.editingPolygon||a.editingPolygon.length===0){_&&(_.remove(),_=null),k&&(k.remove(),k=null),y.value=[];return}if(y.value=a.editingPolygon.map(ge=>({lat:ge.lat,lng:ge.lng})),le(),we&&y.value.length>=3){const ge=en.latLngBounds(y.value.map(Z=>[Z.lat,Z.lng]));l.fitBounds(ge,{padding:[50,50]})}}},j=()=>{if(!l)return;if(ue||(ue=new en.FeatureGroup,l.addLayer(ue)),l._customDrawingHandlers&&(l.off("click",l._customDrawingHandlers.handleClick),l.getContainer().removeEventListener("touchstart",l._customDrawingHandlers.handleTouchStart),l.getContainer().removeEventListener("touchend",l._customDrawingHandlers.handleTouchEnd),l.getContainer().removeEventListener("touchmove",l._customDrawingHandlers.handleTouchMove),delete l._customDrawingHandlers),!a.drawingMode){B(),ue&&ue.clearLayers();return}let we=0,ge=null,Z=!1,se=!1;const ce=300,Te=15,Oe=bt=>{d.value.push([...u.value]),p.value=[],u.value.push({lat:bt.lat,lng:bt.lng}),Ce(),s("polygon-drawing",u.value)},Be=bt=>{bt.originalEvent&&bt.originalEvent.sourceCapabilities?.firesTouchEvents||Oe(bt.latlng)},Xe=bt=>{if(bt.touches.length>1){se=!0;return}se=!1,we=Date.now(),ge={x:bt.touches[0].clientX,y:bt.touches[0].clientY},Z=!1},mt=bt=>{if(!ge||se)return;const Mt=bt.touches[0].clientX-ge.x,wt=bt.touches[0].clientY-ge.y;Math.sqrt(Mt*Mt+wt*wt)>Te&&(Z=!0)},_t=bt=>{if(se){se=!1,ge=null;return}if(Date.now()-we<ce&&!Z&&ge){const wt=bt.changedTouches[0],Nt=en.point(wt.clientX-l.getContainer().getBoundingClientRect().left,wt.clientY-l.getContainer().getBoundingClientRect().top),Ft=l.containerPointToLatLng(Nt);bt.preventDefault(),bt.stopPropagation(),Oe(Ft)}ge=null,Z=!1};l.on("click",Be),l.getContainer().addEventListener("touchstart",Xe,{passive:!0}),l.getContainer().addEventListener("touchmove",mt,{passive:!0}),l.getContainer().addEventListener("touchend",_t,{passive:!1}),l._customDrawingHandlers={handleClick:Be,handleTouchStart:Xe,handleTouchMove:mt,handleTouchEnd:_t},Ce()};let te=!1,Re=!1;const Se=()=>{if(l&&(l._animatingZoom||Re)){te=!0;return}if(te=!1,K.value.forEach(Z=>{Z._map&&(Z.off(),Z.remove())}),K.value=[],!l)return;const we=i.value?.clientWidth||400,ge=Math.floor(we*.75);if(a.locations.forEach(Z=>{const se=Z.latitude??Z.Latitude,ce=Z.longitude??Z.Longitude;if(se==null||ce==null||se===0&&ce===0)return;const Te=Z.checkedInCount||0,Oe=Z.requiredMarshals||1,Be=a.highlightLocationId===Z.id||a.highlightLocationIds.includes(Z.id),Xe=a.simplifyNonHighlighted&&!Be,mt=Z.resolvedStyleType||Z.ResolvedStyleType,_t=Z.resolvedStyleBackgroundColor||Z.ResolvedStyleBackgroundColor||Z.resolvedStyleColor||Z.ResolvedStyleColor,bt=Z.resolvedStyleBorderColor||Z.ResolvedStyleBorderColor,Mt=Z.resolvedStyleIconColor||Z.ResolvedStyleIconColor,wt=Z.resolvedStyleBackgroundShape||Z.ResolvedStyleBackgroundShape,Nt=mt&&mt!=="default"||_t||bt||Mt||wt&&wt!=="circle"&&wt!=="default",Ft=Z.resolvedStyleMapRotation??Z.ResolvedStyleMapRotation??Z.styleMapRotation??Z.StyleMapRotation??0,Fn=parseInt(Ft,10)||0,Qn=Z.areaColor||"#999",fn=Z.areaId&&!a.marshalMode,yt=ee.value.has(Z.id)&&Z.description?`${Z.name}: ${Gv(Z.description,50)}`:Z.name,eo=Be?`
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid #667eea;
        border-radius: 50%;
        animation: highlight-pulse 1.5s ease-out infinite;
      "></div>
    `:"",Un=Be?"#667eea":Xe?"#e0e0e0":"white",to=Be?"white":Xe?"#888":"#333";let pn;if(Xe){const ot="20px";pn=`
        <div style="
          background-color: #999;
          width: ${ot};
          height: ${ot};
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        "></div>
      `}const Zt=!a.marshalMode,ks=$u(Te,Oe),no=Zt?`<div style="
      position: absolute;
      bottom: -2px;
      right: -6px;
      background-color: white;
      border-radius: 8px;
      padding: 1px 4px;
      font-size: 9px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    ">${Te}/${Oe}</div>`:"";if(!Xe&&Nt){const ot=Be?40:32,Ge=Z.resolvedStyleSize||Z.ResolvedStyleSize||"100",St=Cn({type:Z.resolvedStyleType||Z.ResolvedStyleType,backgroundShape:Z.resolvedStyleBackgroundShape||Z.ResolvedStyleBackgroundShape||"circle",backgroundColor:Z.resolvedStyleBackgroundColor||Z.ResolvedStyleBackgroundColor||Z.resolvedStyleColor||Z.ResolvedStyleColor||"",borderColor:Z.resolvedStyleBorderColor||Z.ResolvedStyleBorderColor||"",iconColor:Z.resolvedStyleIconColor||Z.ResolvedStyleIconColor||"",size:Ge});St?pn=St:pn=Kb(Z.resolvedStyleType,Z.resolvedStyleColor,Te,Oe,ot,Zt)||ve(Te,Oe,Be,a.marshalMode,!0)}else Xe||(pn=ve(Te,Oe,Be,a.marshalMode,!0));const Co=Fn!==0?`transform: rotate(${Fn}deg);`:"",ie=en.divIcon({className:"custom-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
          ${eo}
          <div style="position: relative; display: flex; align-items: center; gap: 4px;">
            ${fn?`<div style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background-color: ${Qn};
              border: 2px solid white;
              box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            "></div>`:""}
            <div style="position: relative; display: inline-block;">
              <div style="${Co}">
                ${pn}
              </div>
              ${Xe?"":`<div style="position: absolute; top: -4px; right: -4px;">
                ${ks}
              </div>`}
              ${Xe?"":no}
            </div>
          </div>
          <div style="
            background-color: ${Un};
            padding: 2px 6px;
            border-radius: 3px;
            font-size: ${Be?"12px":"11px"};
            font-weight: bold;
            color: ${to};
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: ${ge}px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${yt}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]}),re=a.marshalMode?`<b>${Z.name}</b>${Z.description?`<br>${Z.description}`:""}`:`<b>${Z.name}</b><br>${Z.description||""}<br>Checked in: ${Te}/${Oe}`,me=en.marker([Z.latitude,Z.longitude],{icon:ie}).addTo(l).bindPopup(re);me.on("click",()=>{s("location-click",Z)}),me.locationData=Z,K.value.push(me)}),l&&he.value&&!a.center&&!U.value){const Z=[],se=a.allLocationsForBounds.length>0?a.allLocationsForBounds:a.locations,ce=(Te,Oe)=>Te!=null&&Oe!=null&&!(Te===0&&Oe===0);if(se.length>0&&Z.push(...se.filter(Te=>ce(Te.latitude,Te.longitude)).map(Te=>[Te.latitude,Te.longitude])),a.route.length>0&&Z.push(...a.route.filter(Te=>ce(Te.lat,Te.lng)).map(Te=>[Te.lat,Te.lng])),Z.length>0){const Te=en.latLngBounds(Z);l.fitBounds(Te,{padding:[50,50]}),he.value=!1,U.value=!0}}else a.center&&(he.value=!1);setTimeout(()=>{l&&!l._animatingZoom&&Le()},100)};return nn(()=>{U.value=!1,he.value=!0,W();let we,ge=0,Z=0;const se=new ResizeObserver(ce=>{if(l&&ce.length>0){const{width:Te,height:Oe}=ce[0].contentRect;(Math.abs(Te-ge)>10||Math.abs(Oe-Z)>10)&&(ge=Te,Z=Oe,clearTimeout(we),we=setTimeout(()=>{l.invalidateSize()},150))}});i.value&&se.observe(i.value),xn(()=>{clearTimeout(we),se.disconnect()})}),qe(()=>a.locations,we=>{if(Se(),l&&!U.value&&we.length>0&&!a.center){const ge=we.map(Te=>Te.latitude),Z=we.map(Te=>Te.longitude),se=ge.reduce((Te,Oe)=>Te+Oe,0)/ge.length,ce=Z.reduce((Te,Oe)=>Te+Oe,0)/Z.length;l.setView([se,ce],10),U.value=!0,he.value=!1}l&&setTimeout(()=>be(),50)},{deep:!0}),qe(()=>a.route,we=>{if(Y(),Se(),l&&!U.value&&we&&we.length>0&&!a.center){const ge=we.map(Te=>Te.lat),Z=we.map(Te=>Te.lng),se=ge.reduce((Te,Oe)=>Te+Oe,0)/ge.length,ce=Z.reduce((Te,Oe)=>Te+Oe,0)/Z.length;l.setView([se,ce],10),U.value=!0,he.value=!1}},{deep:!0}),qe(()=>a.center,(we,ge)=>{l&&!S.value&&(!ge||Math.abs(we.lat-ge.lat)>1e-6||Math.abs(we.lng-ge.lng)>1e-6)&&l.setView([we.lat,we.lng],a.zoom)}),qe(()=>a.areas,()=>{pe()},{deep:!0}),qe(()=>a.selectedAreaId,()=>{pe()}),qe(()=>a.drawingMode,()=>{j()}),qe(()=>a.editingPolygon,()=>{if(w){w=!1;return}J()},{deep:!0}),qe(()=>a.userLocation,()=>{Pe()},{deep:!0}),qe(()=>a.highlightLocationId,()=>{Se()}),qe(()=>a.highlightLocationIds,()=>{Se(),l&&setTimeout(()=>be(),50)},{deep:!0}),qe(()=>a.marshalMode,()=>{Se()}),qe(()=>a.simplifyNonHighlighted,()=>{Se()}),qe(()=>a.clickable,we=>{l&&(l.off("click"),we&&l.on("click",ge=>{a.drawingMode||s("map-click",{lat:ge.latlng.lat,lng:ge.latlng.lng})}))}),(we,ge)=>(v(),m("div",Xb,[r("div",{ref_key:"mapContainer",ref:i,class:"map-container"},null,512),et.value?(v(),m("button",{key:0,class:"recenter-btn",onClick:Ve,title:"Recenter on checkpoint"},[...ge[0]||(ge[0]=[r("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),r("span",null,"Recenter",-1)])])):M("",!0)]))}},Tu=je(e0,[["__scopeId","data-v-91272c81"]]);function Vs(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}const t0={class:"areas-selection"},n0={key:0,class:"areas-selection-header"},o0={class:"areas-list"},s0=["checked","onChange"],a0={__name:"AreasSelection",props:{areas:{type:Array,default:()=>[]},selectedAreaIds:{type:Array,default:()=>[]}},emits:["update:selectedAreaIds"],setup(e,{emit:t}){const o=e,a=t,s=V(()=>[...o.areas].sort((d,p)=>d.displayOrder!==p.displayOrder?d.displayOrder-p.displayOrder:Vs(d.name,p.name))),i=V(()=>o.areas.length>0&&o.selectedAreaIds.length===o.areas.length),l=d=>{const p=[...o.selectedAreaIds],f=p.indexOf(d);f>=0?p.splice(f,1):p.push(d),a("update:selectedAreaIds",p)},u=()=>{i.value?a("update:selectedAreaIds",[]):a("update:selectedAreaIds",o.areas.map(d=>d.id))};return(d,p)=>(v(),m("div",t0,[e.areas.length>1?(v(),m("div",n0,[r("button",{onClick:u,class:"toggle-all-btn"},C(i.value?"Deselect all":"Select all"),1)])):M("",!0),r("div",o0,[(v(!0),m(xe,null,Ne(s.value,f=>(v(),m("label",{class:"area-checkbox",key:f.id},[r("input",{type:"checkbox",checked:e.selectedAreaIds.includes(f.id),onChange:g=>l(f.id)},null,40,s0),r("span",{class:"area-color-dot",style:Qe({backgroundColor:f.color||"#667eea"})},null,4),Ye(" "+C(f.name),1)]))),128))])]))}},i0=je(a0,[["__scopeId","data-v-ba19009b"]]),l0={key:1,class:"toolbar-btn-wrapper filters-wrapper"},r0={key:1,class:"dropdown-content filters-dropdown"},c0={class:"filters-header"},u0={class:"filter-section"},d0={class:"filter-checkbox"},h0=["checked"],f0={class:"filter-section"},p0={class:"filter-checkbox"},v0=["checked"],m0={class:"filter-checkbox"},g0=["checked"],y0={class:"filter-checkbox"},k0=["checked"],_0={key:0,class:"filter-section"},b0=["onClick","title"],w0={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},C0={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},L0=["innerHTML"],S0={key:0,class:"dropdown-content action-dropdown"},x0=["onClick"],I0={__name:"MapToolbar",props:{showFullscreen:{type:Boolean,default:!1},showFilters:{type:Boolean,default:!1},filters:{type:Object,default:()=>({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},areas:{type:Array,default:()=>[]},actions:{type:Array,default:()=>[]},position:{type:String,default:"top-right",validator:e=>["top-right","top-left"].includes(e)}},emits:["fullscreen-click","filter-change","action-click"],setup(e,{expose:t,emit:o}){const{terms:a}=ut(),s=e,i=o,l=$(!1),u=$(null),d=V(()=>u.value!==null),p=()=>{l.value=!l.value,l.value&&(u.value=null)},f=(k,w)=>{i("filter-change",{...s.filters,[k]:w})},g=k=>{k.items&&k.items.length>0?u.value===k.id?u.value=null:(u.value=k.id,l.value=!1):i("action-click",{actionId:k.id})},y=(k,w)=>{u.value=null,i("action-click",{actionId:k,itemId:w})};return t({closeDropdowns:()=>{l.value=!1,u.value=null}}),(k,w)=>(v(),m("div",{class:de(["map-toolbar",[`position-${e.position}`]])},[e.showFullscreen?(v(),m("button",{key:0,class:"toolbar-btn",onClick:w[0]||(w[0]=S=>k.$emit("fullscreen-click")),title:"Fullscreen"},[...w[8]||(w[8]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})],-1)])])):M("",!0),e.showFilters&&!d.value?(v(),m("div",l0,[l.value?(v(),m("div",{key:0,class:"mobile-backdrop",onClick:w[1]||(w[1]=S=>l.value=!1)})):M("",!0),r("button",{class:de(["toolbar-btn",{active:l.value}]),onClick:p,title:"Show/hide options"},[...w[9]||(w[9]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),r("circle",{cx:"12",cy:"12",r:"3"})],-1)])],2),l.value?(v(),m("div",r0,[r("div",c0,[w[11]||(w[11]=r("span",{class:"filters-title"},"Map filters",-1)),r("button",{class:"close-filters-btn",onClick:w[2]||(w[2]=S=>l.value=!1),title:"Close"},[...w[10]||(w[10]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])]),r("div",u0,[w[12]||(w[12]=r("h4",null,"Display",-1)),r("label",d0,[r("input",{type:"checkbox",checked:e.filters.showRoute,onChange:w[3]||(w[3]=S=>f("showRoute",S.target.checked))},null,40,h0),r("span",null,C(O(a).course)+" line",1)])]),r("div",f0,[r("h4",null,C(O(a).checkpoints),1),r("label",p0,[r("input",{type:"checkbox",checked:e.filters.showUncheckedIn,onChange:w[4]||(w[4]=S=>f("showUncheckedIn",S.target.checked))},null,40,v0),w[13]||(w[13]=r("span",{class:"status-indicator unchecked"},null,-1)),w[14]||(w[14]=r("span",null,"Unchecked-in",-1))]),r("label",m0,[r("input",{type:"checkbox",checked:e.filters.showPartiallyCheckedIn,onChange:w[5]||(w[5]=S=>f("showPartiallyCheckedIn",S.target.checked))},null,40,g0),w[15]||(w[15]=r("span",{class:"status-indicator partial"},null,-1)),w[16]||(w[16]=r("span",null,"Partially checked-in",-1))]),r("label",y0,[r("input",{type:"checkbox",checked:e.filters.showFullyCheckedIn,onChange:w[6]||(w[6]=S=>f("showFullyCheckedIn",S.target.checked))},null,40,k0),w[17]||(w[17]=r("span",{class:"status-indicator full"},null,-1)),w[18]||(w[18]=r("span",null,"Fully checked-in",-1))])]),e.areas.length>0?(v(),m("div",_0,[r("h4",null,C(O(a).areas),1),Ae(i0,{areas:e.areas,"selected-area-ids":e.filters.selectedAreaIds,"onUpdate:selectedAreaIds":w[7]||(w[7]=S=>f("selectedAreaIds",S))},null,8,["areas","selected-area-ids"])])):M("",!0)])):M("",!0)])):M("",!0),(v(!0),m(xe,null,Ne(e.actions,S=>(v(),m("div",{key:S.id,class:de(["toolbar-btn-wrapper",{hidden:l.value}])},[r("button",{class:de(["toolbar-btn",{active:u.value===S.id}]),onClick:E=>g(S),title:S.label||S.id},[S.icon==="plus"?(v(),m("svg",w0,[...w[19]||(w[19]=[r("line",{x1:"12",y1:"5",x2:"12",y2:"19"},null,-1),r("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1)])])):S.icon==="edit"?(v(),m("svg",C0,[...w[20]||(w[20]=[r("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},null,-1),r("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1)])])):S.icon==="custom"?(v(),m("span",{key:2,innerHTML:S.customIcon},null,8,L0)):M("",!0)],10,b0),S.items&&u.value===S.id?(v(),m("div",S0,[(v(!0),m(xe,null,Ne(S.items,E=>(v(),m("button",{key:E.id,onClick:A=>y(S.id,E.id),class:"dropdown-item"},C(E.label),9,x0))),128))])):M("",!0)],2))),128))],2))}},$0=je(I0,[["__scopeId","data-v-d04b549d"]]),T0={key:0,class:"drawing-controls"},M0={class:"point-count"},A0={class:"undo-redo-buttons"},E0=["disabled"],P0=["disabled"],D0={__name:"MapDrawingControls",props:{pointCount:{type:Number,default:0},canUndo:{type:Boolean,default:!1},canRedo:{type:Boolean,default:!1},show:{type:Boolean,default:!0}},emits:["undo","redo"],setup(e,{emit:t}){const o=e,a=t,s=V(()=>o.show&&o.pointCount>0),i=l=>{if(!s.value)return;const d=navigator.platform.toUpperCase().indexOf("MAC")>=0?l.metaKey:l.ctrlKey;d&&l.key==="z"&&!l.shiftKey?(l.preventDefault(),o.canUndo&&a("undo")):d&&(l.key==="y"||l.key==="z"&&l.shiftKey)&&(l.preventDefault(),o.canRedo&&a("redo"))};return nn(()=>{document.addEventListener("keydown",i)}),xn(()=>{document.removeEventListener("keydown",i)}),(l,u)=>s.value?(v(),m("div",T0,[r("div",M0,C(e.pointCount)+" point"+C(e.pointCount!==1?"s":""),1),r("div",A0,[r("button",{onClick:u[0]||(u[0]=d=>l.$emit("undo")),class:"btn-drawing undo-btn",disabled:!e.canUndo,title:"Undo last point (Ctrl+Z)"},"  Undo ",8,E0),r("button",{onClick:u[1]||(u[1]=d=>l.$emit("redo")),class:"btn-drawing redo-btn",disabled:!e.canRedo,title:"Redo point (Ctrl+Y)"}," Redo  ",8,P0)])])):M("",!0)}},of=je(D0,[["__scopeId","data-v-6cd009cb"]]),R0={class:"context-info"},O0={class:"action-buttons"},B0=["disabled"],N0={key:0,class:"fullscreen-map-banner"},F0={class:"fullscreen-map-container"},U0={key:1,class:"fullscreen-map-footer"},z0={__name:"MapFullscreenModal",props:{show:{type:Boolean,required:!0},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},title:{type:String,default:""},description:{type:String,default:""},canComplete:{type:Boolean,default:!1},headerStyle:{type:Object,default:()=>({})},headerTextColor:{type:String,default:""}},emits:["done","cancel","close"],setup(e,{emit:t}){const o=e,a=V(()=>o.headerTextColor?{color:o.headerTextColor}:{}),s=t,i=()=>{s("done")},l=()=>{s("cancel")},u=()=>{s("close")},d=p=>{p.key==="Escape"&&o.show&&(o.mode==="view"?u():l())};return qe(()=>o.show,p=>{p?(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"):(document.body.style.overflow="",document.documentElement.style.overflow="")},{immediate:!0}),nn(()=>{document.addEventListener("keydown",d)}),xn(()=>{document.removeEventListener("keydown",d),document.body.style.overflow="",document.documentElement.style.overflow=""}),(p,f)=>(v(),We(Tl,{to:"body"},[e.show?(v(),m("div",{key:0,class:"fullscreen-map-overlay",onTouchmove:f[0]||(f[0]=rt(()=>{},["prevent","self"]))},[r("div",{class:"fullscreen-map-header",style:Qe(e.headerStyle)},[r("div",R0,[r("h3",{style:Qe({color:e.headerTextColor})},C(e.title),5),e.description?(v(),m("p",{key:0,style:Qe({color:e.headerTextColor,opacity:.85})},C(e.description),5)):M("",!0)]),r("div",O0,[io(p.$slots,"actions",{},void 0),e.mode==="view"?(v(),m("button",{key:0,type:"button",onClick:rt(u,["stop"]),class:"btn btn-close-x",style:Qe(a.value),title:"Close"},[...f[1]||(f[1]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"24",height:"24"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])],4)):(v(),m(xe,{key:1},[r("button",{type:"button",onClick:l,class:"btn btn-cancel"}," Cancel "),r("button",{type:"button",onClick:i,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,B0)],64))])],4),p.$slots.banner?(v(),m("div",N0,[io(p.$slots,"banner",{},void 0)])):M("",!0),r("div",F0,[io(p.$slots,"default",{},void 0)]),p.$slots.footer?(v(),m("div",U0,[io(p.$slots,"footer",{},void 0)])):M("",!0)],32)):M("",!0)]))}},H0=je(z0,[["__scopeId","data-v-b5d05af4"]]),V0={class:"map-wrapper"},G0={class:"fullscreen-map-wrapper"},j0={__name:"CommonMap",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},editingPolygon:{type:Array,default:null},height:{type:String,default:"400px"},showFullscreen:{type:Boolean,default:!0},showFilters:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]},toolbarPosition:{type:String,default:"top-right"},filters:{type:Object,default:()=>({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},fullscreenTitle:{type:String,default:""},fullscreenDescription:{type:String,default:""},fullscreenHeaderStyle:{type:Object,default:()=>({})},fullscreenHeaderTextColor:{type:String,default:""},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","visibility-change","point-selected","polygon-complete","polygon-drawing","polygon-update","fullscreen-change","filter-change","action-click","fullscreen-done","fullscreen-cancel"],setup(e,{expose:t,emit:o}){const a=e,s=o,i=$(null),l=$(null),u=$(null),d=$(!1),p=$(0),f=$(!1),g=$(!1),y=$({...a.filters});qe(()=>a.filters,K=>{y.value={...K}},{deep:!0}),qe(()=>a.areas,K=>{a.showFilters&&K.length>0&&(!y.value.selectedAreaIds||y.value.selectedAreaIds.length===0)&&(y.value.selectedAreaIds=K.map(Q=>Q.id))},{immediate:!0});const _=V(()=>a.showFilters?a.locations.filter(K=>{const Q=K.checkedInCount||0,he=K.requiredMarshals||1,U=Q===0,ee=Q>0&&Q<he,fe=Q>=he;if(U&&!y.value.showUncheckedIn||ee&&!y.value.showPartiallyCheckedIn||fe&&!y.value.showFullyCheckedIn)return!1;const ue=K.areaIds||K.AreaIds||[];return!(a.areas.length>0&&ue.length>0&&(!y.value.selectedAreaIds||y.value.selectedAreaIds.length===0||!ue.some(et=>y.value.selectedAreaIds.includes(et))))}):a.locations),k=V(()=>a.showFilters?y.value.showRoute?a.route:[]:a.route),w=V(()=>a.showFilters?y.value.selectedAreaIds&&y.value.selectedAreaIds.length>0?a.areas.filter(K=>y.value.selectedAreaIds.includes(K.id)):a.areas.length>0?[]:a.areas:a.areas),S=V(()=>a.mode==="select-point"?!0:a.mode==="draw-polygon"?p.value>=3:!0),E=()=>d.value?l.value:i.value,A=()=>{d.value=!0,s("fullscreen-change",!0)},x=()=>{d.value=!1,s("fullscreen-change",!1)},D=()=>{if(a.mode==="draw-polygon"){const K=E();K&&K.clearPolygonDrawing(),p.value=0,f.value=!1,g.value=!1}d.value=!1,s("fullscreen-cancel"),s("fullscreen-change",!1)},R=()=>{if(a.mode==="draw-polygon"&&p.value>=3){const K=E();K&&K.completePolygon()}d.value=!1,s("fullscreen-done"),s("fullscreen-change",!1)},F=K=>{y.value=K,s("filter-change",K)},T=K=>{a.mode==="select-point"&&s("point-selected",K),s("map-click",K)},N=K=>{p.value=K?.length||0,P(),s("polygon-drawing",K)},B=K=>{s("polygon-complete",K),p.value=0,f.value=!1,g.value=!1},q=K=>{s("polygon-update",K)},P=()=>{const K=E();K&&(f.value=K.canUndo?K.canUndo():!1,g.value=K.canRedo?K.canRedo():!1)},G=()=>{const K=E();K&&K.undoPolygonPoint&&(K.undoPolygonPoint(),P())},X=()=>{const K=E();K&&K.redoPolygonPoint&&(K.redoPolygonPoint(),P())};return t({getMapCenter:()=>E()?.getMapCenter?.(),getMapZoom:()=>E()?.getMapZoom?.(),undoPolygonPoint:G,redoPolygonPoint:X,canUndo:()=>f.value,canRedo:()=>g.value,getPolygonPointCount:()=>p.value,completePolygon:()=>E()?.completePolygon?.(),clearPolygonDrawing:()=>{E()?.clearPolygonDrawing?.(),p.value=0,f.value=!1,g.value=!1},recenterOnUserLocation:()=>E()?.recenterOnUserLocation?.(),recenterOnLocation:(K,Q,he)=>E()?.recenterOnLocation?.(K,Q,he),isLocationInView:(K,Q)=>E()?.isLocationInView?.(K,Q)??!0,getUserLocationInView:()=>E()?.userLocationInView?.value??!0,getHighlightedLocationInView:()=>E()?.highlightedLocationInView?.value??!0,openFullscreen:()=>{d.value=!0,s("fullscreen-change",!0)},closeFullscreen:x,closeDropdowns:()=>{u.value&&u.value.closeDropdowns()}}),(K,Q)=>(v(),m("div",{class:"common-map",style:Qe({height:e.height})},[r("div",V0,[Ae(Tu,{ref_key:"mapViewRef",ref:i,locations:_.value,route:k.value,areas:w.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:Q[0]||(Q[0]=he=>K.$emit("location-click",he)),onMapClick:T,onAreaClick:Q[1]||(Q[1]=he=>K.$emit("area-click",he)),onPolygonComplete:B,onPolygonDrawing:N,onPolygonUpdate:q,onVisibilityChange:Q[2]||(Q[2]=he=>K.$emit("visibility-change",he))},null,8,["locations","route","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Ae($0,{ref_key:"toolbarRef",ref:u,"show-fullscreen":e.showFullscreen,"show-filters":e.showFilters,filters:y.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFullscreenClick:A,onFilterChange:F,onActionClick:Q[3]||(Q[3]=he=>K.$emit("action-click",he))},null,8,["show-fullscreen","show-filters","filters","areas","actions","position"]),Ae(of,{show:e.mode==="draw-polygon","point-count":p.value,"can-undo":f.value,"can-redo":g.value,onUndo:G,onRedo:X},null,8,["show","point-count","can-undo","can-redo"])]),Ae(H0,{show:d.value,mode:e.mode,title:e.fullscreenTitle,description:e.fullscreenDescription,"can-complete":S.value,"header-style":e.fullscreenHeaderStyle,"header-text-color":e.fullscreenHeaderTextColor,onDone:R,onCancel:D,onClose:x},{actions:ze(()=>[io(K.$slots,"fullscreen-actions",{},void 0,!0)]),banner:ze(()=>[io(K.$slots,"fullscreen-banner",{},void 0,!0)]),footer:ze(()=>[io(K.$slots,"fullscreen-footer",{},void 0,!0)]),default:ze(()=>[r("div",G0,[Ae(Tu,{ref_key:"fullscreenMapViewRef",ref:l,locations:_.value,route:k.value,areas:w.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:Q[4]||(Q[4]=he=>K.$emit("location-click",he)),onMapClick:T,onAreaClick:Q[5]||(Q[5]=he=>K.$emit("area-click",he)),onPolygonComplete:B,onPolygonDrawing:N,onPolygonUpdate:q,onVisibilityChange:Q[6]||(Q[6]=he=>K.$emit("visibility-change",he))},null,8,["locations","route","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Ae(of,{show:e.mode==="draw-polygon","point-count":p.value,"can-undo":f.value,"can-redo":g.value,onUndo:G,onRedo:X},null,8,["show","point-count","can-undo","can-redo"])])]),_:3},8,["show","mode","title","description","can-complete","header-style","header-text-color"])],4))}},li=je(j0,[["__scopeId","data-v-d6bcac0e"]]),Z0={class:"course-areas-tab"},q0={__name:"CourseAreasTab",props:{checkpoints:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1}},emits:["map-click","location-click","area-click","import-checkpoints","upload-route","select-location","add-area","select-area","polygon-complete","cancel-drawing","add-checkpoint-from-map","add-many-checkpoints-from-map","add-area-from-map"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=ut(),i=e,l=o,u=$(null),d=$(null),p=$(0),f=$({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]}),g=V(()=>[{id:"add",icon:"plus",label:"Add",items:[{id:"checkpoint",label:a.value.checkpoint},{id:"many-checkpoints",label:`Many ${s.value.checkpoints}`},{id:"area",label:a.value.area},{id:"import",label:`Import ${s.value.checkpoints}...`},{id:"upload",label:`Upload ${s.value.course}...`}]}]),y=({actionId:A,itemId:x})=>{A==="add"&&(x==="checkpoint"?(l("add-checkpoint-from-map"),w()):x==="many-checkpoints"?(l("add-many-checkpoints-from-map"),w()):x==="area"?(l("add-area-from-map"),w()):x==="import"?l("import-checkpoints"):x==="upload"&&l("upload-route"))},_=A=>{f.value=A},k=A=>{p.value=A?.length||0},w=()=>{u.value&&u.value.scrollIntoView({behavior:"smooth",block:"start"})};return t({scrollMapIntoView:w,getMapCenter:()=>d.value?.getMapCenter()||null,getMapZoom:()=>d.value?.getMapZoom()||null}),qe(()=>i.areas,A=>{if(A.length>0){const x=new Set(f.value.selectedAreaIds);A.forEach(D=>{x.has(D.id)||f.value.selectedAreaIds.push(D.id)}),f.value.selectedAreaIds=f.value.selectedAreaIds.filter(D=>A.some(R=>R.id===D))}},{immediate:!0}),qe(()=>i.drawingMode,A=>{A||(p.value=0)}),(A,x)=>(v(),m("div",Z0,[r("div",{class:"map-section",ref_key:"mapSection",ref:u},[Ae(li,{ref_key:"commonMapRef",ref:d,locations:e.checkpoints,route:e.route,areas:e.areas,"all-locations-for-bounds":e.checkpoints,"selected-area-id":e.selectedAreaId,clickable:!0,mode:e.drawingMode?"draw-polygon":"view",height:"100%","show-filters":"",filters:f.value,"toolbar-actions":g.value,"fullscreen-title":e.drawingMode?`Draw ${O(s).area} boundary`:O(a).course,"fullscreen-description":e.drawingMode?"Click on the map to draw the boundary":"",onMapClick:x[0]||(x[0]=D=>A.$emit("map-click",D)),onLocationClick:x[1]||(x[1]=D=>A.$emit("location-click",D)),onAreaClick:x[2]||(x[2]=D=>A.$emit("area-click",D)),onPolygonComplete:x[3]||(x[3]=D=>A.$emit("polygon-complete",D)),onPolygonDrawing:k,onFilterChange:_,onActionClick:y},null,8,["locations","route","areas","all-locations-for-bounds","selected-area-id","mode","filters","toolbar-actions","fullscreen-title","fullscreen-description"])],512)]))}},W0=je(q0,[["__scopeId","data-v-c0e54ae9"]]),K0=(e,t)=>{const o=String(e).trim(),a=String(t).trim(),s=parseFloat(o),i=parseFloat(a),l=!isNaN(s)&&String(s)===o,u=!isNaN(i)&&String(i)===a;return l&&u?s-i:o.localeCompare(a,void 0,{numeric:!0,sensitivity:"base"})},J0={__name:"StatusPill",props:{variant:{type:String,default:"neutral",validator:e=>["neutral","success","warning","danger","info","purple"].includes(e)},active:{type:Boolean,default:!1}},emits:["click"],setup(e){return(t,o)=>(v(),m("button",{class:de(["status-pill",[e.variant,{active:e.active}]]),onClick:o[0]||(o[0]=a=>t.$emit("click"))},[io(t.$slots,"default",{},void 0)],2))}},Ln=je(J0,[["__scopeId","data-v-a94deea5"]]),Y0={class:"check-in-toggle-container"},X0=["disabled"],Q0={key:0,class:"toggle-spinner"},ew={key:1,class:"toggle-icon"},tw={class:"toggle-label"},nw={key:0,class:"check-in-details"},ow={key:0,class:"check-in-method"},sw={__name:"CheckInToggleButton",props:{isCheckedIn:{type:Boolean,default:!1},checkInTime:{type:String,default:null},checkInMethod:{type:String,default:null},checkedInBy:{type:String,default:null},marshalName:{type:String,default:null},isLoading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["toggle"],setup(e){const t=e,o=V(()=>t.isLoading?t.isCheckedIn?"Checking out...":"Checking in...":t.isCheckedIn?"Checked in":"Check in"),a=V(()=>{const{checkedInBy:i,checkInMethod:l,marshalName:u}=t;return i&&i!==u?i:l||""}),s=i=>i?new Date(i).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"";return(i,l)=>(v(),m("div",Y0,[r("button",{class:de(["check-in-toggle",{"is-checked-in":e.isCheckedIn}]),disabled:e.disabled||e.isLoading,onClick:l[0]||(l[0]=u=>i.$emit("toggle"))},[e.isLoading?(v(),m("span",Q0)):e.isCheckedIn?(v(),m("span",ew,"")):M("",!0),r("span",tw,C(o.value),1)],10,X0),e.isCheckedIn&&e.checkInTime&&!e.isLoading?(v(),m("span",nw,[Ye(C(s(e.checkInTime))+" ",1),a.value?(v(),m("span",ow,"("+C(a.value)+")",1)):M("",!0)])):M("",!0)]))}},Vr=je(sw,[["__scopeId","data-v-95f8f1cc"]]),aw={class:"marshals-tab"},iw={class:"tab-header"},lw={class:"button-group"},rw={key:0,class:"status-pills"},cw={class:"filters-section"},uw={class:"search-group"},dw={class:"marshals-grid"},hw={class:"marshals-table"},fw={key:0,class:"sort-indicator"},pw={key:0,class:"sort-indicator"},vw={key:0,class:"sort-indicator"},mw={key:0,class:"sort-indicator"},gw=["onClick"],yw=["rowspan"],kw={class:"checkpoint-cell"},_w={class:"checkpoint-name"},bw={key:0,class:"checkpoint-description"},ww=["rowspan"],Cw={key:0,class:"last-active-text"},Lw={key:1,class:"last-active-never"},Sw=["onClick"],xw={class:"no-checkpoint-text"},Iw={class:"hide-on-mobile last-active-cell"},$w={key:0,class:"last-active-text"},Tw={key:1,class:"last-active-never"},Mw={__name:"MarshalsTab",props:{marshals:{type:Array,required:!0},assignments:{type:Array,required:!0},locations:{type:Array,required:!0}},emits:["add-marshal","import-marshals","select-marshal","delete-marshal","toggle-check-in"],setup(e,{expose:t,emit:o}){const{terms:a}=ut(),s=e,i=$(null);t({setCheckingIn:q=>{i.value=q}});const u=$("name"),d=$("asc"),p=$(""),f=$("all"),g=q=>{f.value=q},y=q=>{u.value===q?d.value=d.value==="asc"?"desc":"asc":(u.value=q,d.value="asc")},_=q=>s.assignments.filter(P=>P.marshalId===q),k=V(()=>new Set(s.assignments.filter(q=>q.isCheckedIn).map(q=>q.marshalId))),w=V(()=>new Set(s.assignments.map(q=>q.marshalId))),S=V(()=>k.value.size),E=V(()=>s.marshals.filter(q=>!w.value.has(q.id)).length),A=V(()=>s.marshals.filter(q=>w.value.has(q.id)&&!k.value.has(q.id)).length),x=q=>s.locations.find(P=>P.id===q),D=q=>{const P=x(q);return P?P.name:"Unknown"},R=q=>{const P=x(q);return P?P.description:""},F=q=>{const P=s.marshals.find(G=>G.id===q);return P?P.name:""},T=q=>{if(!q)return"";const P=new Date(q),X=new Date-P,ne=Math.floor(X/6e4),K=Math.floor(ne/60),Q=Math.floor(K/24);return ne<1?"just now":ne<60?`${ne}m ago`:K<24?`${K}h ago`:Q===1?"yesterday":Q<7?`${Q}d ago`:P.toLocaleDateString()},N=V(()=>{let q=s.marshals;if(f.value==="unassigned"?q=q.filter(P=>!w.value.has(P.id)):f.value==="checked-in"?q=q.filter(P=>k.value.has(P.id)):f.value==="not-checked-in"&&(q=q.filter(P=>w.value.has(P.id)&&!k.value.has(P.id))),p.value.trim()){const P=p.value.toLowerCase().trim().split(/\s+/);q=q.filter(G=>{const ne=_(G.id).map(Q=>{const he=x(Q.locationId);return he?`${he.name||""} ${he.description||""}`:""}).join(" "),K=`${G.name} ${ne}`.toLowerCase();return P.every(Q=>K.includes(Q))})}return q}),B=V(()=>{const q=[...N.value];return q.sort((P,G)=>{let X=0;if(u.value==="name")X=P.name.localeCompare(G.name);else if(u.value==="checkpoint"){const ne=_(P.id),K=_(G.id),Q=ne.length>0?D(ne[0].locationId):"",he=K.length>0?D(K[0].locationId):"";X=K0(Q,he)}else if(u.value==="status"){const ne=_(P.id),K=_(G.id),Q=ne.length>0&&ne[0].isCheckedIn?1:0;X=(K.length>0&&K[0].isCheckedIn?1:0)-Q}else if(u.value==="lastActive"){const ne=P.lastAccessedDate?new Date(P.lastAccessedDate).getTime():0;X=(G.lastAccessedDate?new Date(G.lastAccessedDate).getTime():0)-ne}return d.value==="asc"?X:-X}),q});return(q,P)=>(v(),m("div",aw,[r("div",iw,[r("div",lw,[r("button",{onClick:P[0]||(P[0]=G=>q.$emit("add-marshal")),class:"btn btn-primary"}," Add "+C(O(a).person.toLowerCase()),1),r("button",{onClick:P[1]||(P[1]=G=>q.$emit("import-marshals")),class:"btn btn-secondary"}," Import CSV ")]),e.marshals.length>0?(v(),m("div",rw,[Ae(Ln,{variant:"neutral",active:f.value==="all",onClick:P[2]||(P[2]=G=>g("all"))},{default:ze(()=>[Ye(C(e.marshals.length)+" total ",1)]),_:1},8,["active"]),E.value>0?(v(),We(Ln,{key:0,variant:"warning",active:f.value==="unassigned",onClick:P[3]||(P[3]=G=>g("unassigned"))},{default:ze(()=>[Ye(C(E.value)+" unassigned ",1)]),_:1},8,["active"])):M("",!0),S.value>0?(v(),We(Ln,{key:1,variant:"success",active:f.value==="checked-in",onClick:P[4]||(P[4]=G=>g("checked-in"))},{default:ze(()=>[Ye(C(S.value)+" checked in ",1)]),_:1},8,["active"])):M("",!0),A.value>0?(v(),We(Ln,{key:2,variant:"danger",active:f.value==="not-checked-in",onClick:P[5]||(P[5]=G=>g("not-checked-in"))},{default:ze(()=>[Ye(C(A.value)+" not checked in ",1)]),_:1},8,["active"])):M("",!0)])):M("",!0)]),r("div",cw,[r("div",uw,[Ue(r("input",{"onUpdate:modelValue":P[6]||(P[6]=G=>p.value=G),type:"text",class:"search-input",placeholder:"Search by name, checkpoint, or description..."},null,512),[[st,p.value]])])]),r("div",dw,[r("table",hw,[r("thead",null,[r("tr",null,[r("th",{onClick:P[7]||(P[7]=G=>y("name")),class:"sortable"},[P[12]||(P[12]=Ye(" Name ",-1)),u.value==="name"?(v(),m("span",fw,C(d.value==="asc"?"":""),1)):M("",!0)]),r("th",{onClick:P[8]||(P[8]=G=>y("checkpoint")),class:"sortable"},[Ye(C(O(a).checkpoint)+" ",1),u.value==="checkpoint"?(v(),m("span",pw,C(d.value==="asc"?"":""),1)):M("",!0)]),r("th",{onClick:P[9]||(P[9]=G=>y("status")),class:"sortable"},[P[13]||(P[13]=Ye(" Status ",-1)),u.value==="status"?(v(),m("span",vw,C(d.value==="asc"?"":""),1)):M("",!0)]),r("th",{onClick:P[10]||(P[10]=G=>y("lastActive")),class:"sortable hide-on-mobile"},[P[14]||(P[14]=Ye(" Last active ",-1)),u.value==="lastActive"?(v(),m("span",mw,C(d.value==="asc"?"":""),1)):M("",!0)])])]),r("tbody",null,[(v(!0),m(xe,null,Ne(B.value,G=>(v(),m(xe,{key:G.id},[_(G.id).length>0?(v(!0),m(xe,{key:0},Ne(_(G.id),(X,ne)=>(v(),m("tr",{key:`${G.id}-${X.id}`,class:"marshal-row",onClick:K=>q.$emit("select-marshal",G)},[ne===0?(v(),m("td",{key:0,rowspan:_(G.id).length},C(G.name),9,yw)):M("",!0),r("td",kw,[r("div",_w,C(D(X.locationId)),1),R(X.locationId)?(v(),m("div",bw,C(R(X.locationId)),1)):M("",!0)]),r("td",{onClick:P[11]||(P[11]=rt(()=>{},["stop"])),class:"check-in-cell"},[Ae(Vr,{"is-checked-in":X.isCheckedIn,"check-in-time":X.checkInTime,"check-in-method":X.checkInMethod,"checked-in-by":X.checkedInBy,"marshal-name":F(X.marshalId),"is-loading":i.value===X.id,onToggle:K=>q.$emit("toggle-check-in",X)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"])]),ne===0?(v(),m("td",{key:1,rowspan:_(G.id).length,class:"hide-on-mobile last-active-cell"},[G.lastAccessedDate?(v(),m("span",Cw,C(T(G.lastAccessedDate)),1)):(v(),m("span",Lw,"Never"))],8,ww)):M("",!0)],8,gw))),128)):(v(),m("tr",{key:1,class:"marshal-row",onClick:X=>q.$emit("select-marshal",G)},[r("td",null,C(G.name),1),r("td",xw,"No "+C(O(a).checkpoint.toLowerCase())+" assigned",1),P[15]||(P[15]=r("td",null,[r("span",{class:"hide-on-mobile"},"-"),r("span",{class:"status-icon show-on-mobile no-checkpoint-text"},"-")],-1)),r("td",Iw,[G.lastAccessedDate?(v(),m("span",$w,C(T(G.lastAccessedDate)),1)):(v(),m("span",Tw,"Never"))])],8,Sw))],64))),128))])])])]))}},Aw=je(Mw,[["__scopeId","data-v-c3a36b99"]]),Ew={class:"checklists-tab"},Pw={class:"checklists-tab-header"},Dw={class:"button-group"},Rw={class:"filters-section"},Ow={class:"search-group"},Bw=["placeholder"],Nw={class:"checklist-items-list"},Fw={key:0,class:"empty-state"},Uw={class:"checklist-item-content"},zw=["onClick"],Hw={class:"checklist-item-scopes"},Vw=["onClick"],Gw={__name:"ChecklistsTab",props:{checklistItems:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},completionReport:{type:Object,default:null}},emits:["add-checklist-item","select-checklist-item"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=e,i=$(""),l=V(()=>{if(!i.value.trim())return s.checklistItems;const f=i.value.toLowerCase().trim().split(/\s+/);return s.checklistItems.filter(g=>{const y=(g.text||"").toLowerCase();return f.every(_=>y.includes(_))})}),u=V(()=>[...l.value].sort((f,g)=>f.displayOrder!==g.displayOrder?f.displayOrder-g.displayOrder:Vs(f.text,g.text))),d=f=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${a.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${a.value.checkpoints}`,SpecificPeople:`Specific ${a.value.people}`,OnePerArea:`One per ${a.value.area}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,EveryAreaLead:`Every ${a.value.area} lead`,OneLeadPerArea:`One lead per ${a.value.area}`,AreaLead:`${o.value.area} lead`})[f]||f,p=f=>{if(!f)return"";const g=d(f.scope);if(f.itemType===null)return g;const y=f.ids||[];if(y.includes("ALL_MARSHALS"))return`${g} (Everyone)`;if(y.includes("ALL_AREAS"))return`${g} (All ${a.value.areas})`;if(y.includes("ALL_CHECKPOINTS"))return`${g} (All ${a.value.checkpoints})`;const _=y.length;return _===0?g:`${g} (${_})`};return(f,g)=>(v(),m("div",Ew,[r("div",Pw,[r("div",Dw,[r("button",{onClick:g[0]||(g[0]=y=>f.$emit("add-checklist-item")),class:"btn btn-primary"}," Add "+C(O(a).checklist),1)])]),r("div",Rw,[r("div",Ow,[Ue(r("input",{"onUpdate:modelValue":g[1]||(g[1]=y=>i.value=y),type:"text",class:"search-input",placeholder:`Search ${O(a).checklists}...`},null,8,Bw),[[st,i.value]])])]),r("div",Nw,[l.value.length===0?(v(),m("div",Fw,[r("p",null,C(i.value?`No ${O(a).checklists} match your search.`:`No ${O(a).checklists} yet. Create one to get started!`),1)])):M("",!0),(v(!0),m(xe,null,Ne(u.value,y=>(v(),m("div",{key:y.itemId,class:"checklist-item-card"},[r("div",Uw,[r("div",{class:"checklist-item-title",onClick:_=>f.$emit("select-checklist-item",y,"details")},[r("strong",null,C(y.text),1)],8,zw),r("div",Hw,[(v(!0),m(xe,null,Ne(y.scopeConfigurations,(_,k)=>(v(),m("span",{key:k,class:"scope-badge",onClick:w=>f.$emit("select-checklist-item",y,"visibility")},C(p(_)),9,Vw))),128))])])]))),128))])]))}},jw=je(Gw,[["__scopeId","data-v-123b7338"]]),Zw={class:"notes-tab"},qw={class:"tab-header"},Ww={class:"button-group"},Kw={class:"filters-section"},Jw={class:"search-group"},Yw={class:"notes-list"},Xw={key:0,class:"empty-state"},Qw=["onClick"],eC={class:"note-header"},tC={class:"note-title-row"},nC={key:0,class:"pin-icon",title:"Pinned"},oC={key:1,class:"emergency-indicator",title:"Shown in emergency info"},sC={class:"note-meta"},aC={key:0,class:"category-badge"},iC={class:"created-info"},lC={key:0,class:"note-preview"},rC={class:"note-scopes"},cC={__name:"NotesTab",props:{notes:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["add-note","select-note"],setup(e,{emit:t}){const{termsLower:o}=ut(),a=e,s=$(""),i=V(()=>{if(!s.value.trim())return a.notes;const g=s.value.toLowerCase().trim().split(/\s+/);return a.notes.filter(y=>{const _=`${y.title||""} ${y.content||""} ${y.priority||""}`.toLowerCase();return g.every(k=>_.includes(k))})}),l=V(()=>{const g={Urgent:0,High:1,Normal:2,Low:3};return[...i.value].sort((y,_)=>{if(y.isPinned!==_.isPinned)return y.isPinned?-1:1;const k=g[y.priority]??2,w=g[_.priority]??2;return k!==w?k-w:y.displayOrder!==_.displayOrder?y.displayOrder-_.displayOrder:Vs(y.title,_.title)})}),u=g=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${o.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${o.value.checkpoints}`,SpecificPeople:`Specific ${o.value.people}`,EveryAreaLead:`Every ${o.value.area} lead`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,OnePerArea:`One per ${o.value.area}`,OneLeadPerArea:`One lead per ${o.value.area}`})[g]||g,d=g=>{if(!g)return"";const y=u(g.scope);if(g.itemType===null)return y;const _=g.ids||[];if(_.includes("ALL_MARSHALS"))return`${y} (Everyone)`;if(_.includes("ALL_AREAS"))return`${y} (All ${o.value.areas})`;if(_.includes("ALL_CHECKPOINTS"))return`${y} (All ${o.value.checkpoints})`;const k=_.length;return k===0?y:`${y} (${k})`},p=g=>{if(!g)return"";const y=150;return g.length<=y?g:g.substring(0,y)+"..."},f=g=>{if(!g)return"";const y=new Date(g),k=new Date-y,w=Math.floor(k/6e4),S=Math.floor(k/36e5),E=Math.floor(k/864e5);return w<1?"Just now":w<60?`${w}m ago`:S<24?`${S}h ago`:E<7?`${E}d ago`:y.toLocaleDateString()};return(g,y)=>(v(),m("div",Zw,[r("div",qw,[r("div",Ww,[r("button",{onClick:y[0]||(y[0]=_=>g.$emit("add-note")),class:"btn btn-primary"}," Add note ")])]),r("div",Kw,[r("div",Jw,[Ue(r("input",{"onUpdate:modelValue":y[1]||(y[1]=_=>s.value=_),type:"text",class:"search-input",placeholder:"Search by title, content, or priority..."},null,512),[[st,s.value]])])]),r("div",Yw,[i.value.length===0?(v(),m("div",Xw,[r("p",null,C(s.value?"No notes match your search.":"No notes yet. Create one to get started!"),1)])):M("",!0),(v(!0),m(xe,null,Ne(l.value,_=>(v(),m("div",{key:_.noteId,class:de(["note-card",{pinned:_.isPinned}]),onClick:k=>g.$emit("select-note",_)},[r("div",eC,[r("div",tC,[_.isPinned?(v(),m("span",nC,"")):M("",!0),r("span",{class:de(["priority-indicator",_.priority?.toLowerCase()||"normal"])},null,2),r("strong",null,C(_.title),1),_.showInEmergencyInfo?(v(),m("span",oC,"")):M("",!0)]),r("div",sC,[_.category?(v(),m("span",aC,C(_.category),1)):M("",!0),r("span",iC,C(f(_.createdAt)),1)])]),_.content?(v(),m("div",lC,C(p(_.content)),1)):M("",!0),r("div",rC,[(v(!0),m(xe,null,Ne(_.scopeConfigurations,(k,w)=>(v(),m("span",{key:w,class:"scope-badge"},C(d(k)),1))),128))])],10,Qw))),128))])]))}},uC=je(cC,[["__scopeId","data-v-071c9763"]]),dC={key:0,class:"empty-state"},hC={key:0,class:"empty-hint"},fC={__name:"CardsGrid",props:{isEmpty:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No items."},emptyHint:{type:String,default:""},gridClass:{type:String,default:""}},setup(e){return(t,o)=>e.isEmpty?(v(),m("div",dC,[r("p",null,C(e.emptyMessage),1),e.emptyHint?(v(),m("p",hC,C(e.emptyHint),1)):M("",!0)])):(v(),m("div",{key:1,class:de(["cards-grid",e.gridClass])},[io(t.$slots,"default",{},void 0)],2))}},ql=je(fC,[["__scopeId","data-v-a842b7b1"]]),pC={class:"contact-card-header"},vC={class:"contact-name-row"},mC={key:0,class:"primary-badge",title:"Primary contact"},gC={class:"contact-name"},yC={key:0,class:"contact-role"},kC={key:0,class:"emergency-indicator",title:"Shown in emergency info"},_C={key:1,class:"no-scope-warning",title:"This contact has no visibility scope configured"},bC=["title"],wC={key:0,class:"contact-card-details"},CC={key:0,class:"contact-phone"},LC={key:1,class:"contact-email"},SC={key:1,class:"contact-card-notes"},xC={key:2,class:"contact-card-scopes"},IC={key:3,class:"contact-card-badge"},$C={key:4,class:"contact-card-badge"},TC={__name:"ContactCard",props:{contact:{type:Object,required:!0},isPending:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:String,default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},clickable:{type:Boolean,default:!0}},emits:["click","remove","undo-remove"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=e,i=t,l=V(()=>{const y=s.contact.scopeConfigurations;return!y||y.length===0}),u=()=>{s.clickable&&!s.isPending&&!s.isMarkedForRemoval&&i("click",s.contact)},d=y=>y?y==="AreaLead"?`${o.value.area} Lead`:y.replace(/([A-Z])/g," $1").replace(/^./,_=>_.toUpperCase()).trim():"",p=y=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${a.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${a.value.checkpoints}`,SpecificPeople:`Specific ${a.value.people}`,EveryAreaLead:`Every ${a.value.area} lead`})[y]||y,f=y=>{if(!y)return"";const _=p(y.scope);if(y.itemType===null)return _;const k=y.ids||[];if(k.includes("ALL_MARSHALS"))return`${_} (Everyone)`;if(k.includes("ALL_AREAS"))return`${_} (All ${a.value.areas})`;if(k.includes("ALL_CHECKPOINTS"))return`${_} (All ${a.value.checkpoints})`;const w=k.length;return w===0?_:`${_} (${w})`},g=y=>{if(!y)return"";const _=100;return y.length<=_?y:y.substring(0,_)+"..."};return(y,_)=>(v(),m("div",{class:de(["contact-card",{"is-pending":e.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-primary":e.contact.isPrimary&&!e.isMarkedForRemoval,"is-clickable":e.clickable&&!e.isMarkedForRemoval}]),onClick:u},[r("div",pC,[r("div",{class:de(["contact-card-title",{clickable:e.clickable&&!e.isMarkedForRemoval}])},[r("div",vC,[e.contact.isPrimary&&!e.isMarkedForRemoval?(v(),m("span",mC,"")):M("",!0),r("span",gC,C(e.contact.name),1)]),e.contact.role?(v(),m("span",yC,C(d(e.contact.role)),1)):M("",!0)],2),e.contact.showInEmergencyInfo&&!e.isMarkedForRemoval?(v(),m("span",kC,"")):M("",!0),l.value&&!e.isMarkedForRemoval&&!e.isPending?(v(),m("span",_C,"!")):M("",!0),e.showRemoveButton&&!e.isMarkedForRemoval?(v(),m("button",{key:2,type:"button",class:"contact-remove-btn",title:e.removeTitle,onClick:_[0]||(_[0]=rt(k=>y.$emit("remove",e.contact.contactId),["stop"]))},"  ",8,bC)):M("",!0),e.isMarkedForRemoval?(v(),m("button",{key:3,type:"button",class:"contact-undo-btn",title:"Cancel removal",onClick:_[1]||(_[1]=rt(k=>y.$emit("undo-remove",e.contact.contactId),["stop"]))}," Undo ")):M("",!0)]),e.contact.phone||e.contact.email?(v(),m("div",wC,[e.contact.phone?(v(),m("span",CC,C(e.contact.phone),1)):M("",!0),e.contact.email?(v(),m("span",LC,C(e.contact.email),1)):M("",!0)])):M("",!0),e.contact.notes&&e.showNotes?(v(),m("div",SC,C(g(e.contact.notes)),1)):M("",!0),e.showScopes&&e.contact.scopeConfigurations?.length>0&&!e.isMarkedForRemoval?(v(),m("div",xC,[(v(!0),m(xe,null,Ne(e.contact.scopeConfigurations,(k,w)=>(v(),m("span",{key:w,class:"scope-badge"},C(f(k)),1))),128))])):M("",!0),e.isPending?(v(),m("div",IC,[..._[2]||(_[2]=[r("span",{class:"pending-indicator"},"Will be added on save",-1)])])):M("",!0),e.isMarkedForRemoval?(v(),m("div",$C,[..._[3]||(_[3]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):M("",!0)],2))}},MC=je(TC,[["__scopeId","data-v-125408bd"]]),Zv={__name:"ContactsGrid",props:{contacts:{type:Array,required:!0},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:[String,Function],default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No contacts."},emptyHint:{type:String,default:""}},emits:["select","remove","undo-remove"],setup(e){const t=e,o=s=>typeof t.removeTitle=="function"?t.removeTitle(s):t.removeTitle,a=s=>!s.isPending;return(s,i)=>(v(),We(ql,{"is-empty":e.contacts.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:ze(()=>[(v(!0),m(xe,null,Ne(e.contacts,l=>(v(),We(MC,{key:l.contactId,contact:l,"is-pending":l.isPending,"is-marked-for-removal":l.isMarkedForRemoval,"show-remove-button":e.showRemoveButton,"remove-title":o(l),"show-notes":e.showNotes,"show-scopes":e.showScopes,clickable:a(l),onClick:u=>s.$emit("select",l),onRemove:i[0]||(i[0]=u=>s.$emit("remove",u)),onUndoRemove:i[1]||(i[1]=u=>s.$emit("undo-remove",u))},null,8,["contact","is-pending","is-marked-for-removal","show-remove-button","remove-title","show-notes","show-scopes","clickable","onClick"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},AC={class:"contacts-tab"},EC={class:"tab-header"},PC={class:"button-group"},DC={key:0,class:"status-pills"},RC={class:"filters-section"},OC={class:"search-group"},BC={__name:"ContactsTab",props:{contacts:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})}},emits:["add-contact","select-contact"],setup(e,{emit:t}){const o=e,a=$(""),s=$("all"),i=V(()=>o.contacts.filter(_=>!_.scopeConfigurations||_.scopeConfigurations.length===0).length),l=V(()=>o.contacts.filter(_=>_.scopeConfigurations&&_.scopeConfigurations.length>0).length),u=_=>{s.value=_},d=_=>_?_.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",p=_=>_?_.replace(/([A-Z])/g," $1").replace(/^./,k=>k.toUpperCase()).trim():"",f=V(()=>{let _=o.contacts;if(s.value==="no-scope"?_=_.filter(k=>!k.scopeConfigurations||k.scopeConfigurations.length===0):s.value==="with-scope"&&(_=_.filter(k=>k.scopeConfigurations&&k.scopeConfigurations.length>0)),a.value.trim()){const w=d(a.value).split(" ").filter(S=>S.length>0);_=_.filter(S=>{const E=p(S.role),A=d(`${S.name||""} ${E} ${S.email||""} ${S.phone||""}`);return w.every(x=>A.includes(x))})}return _}),g=V(()=>[...f.value].sort((_,k)=>(_.name||"").localeCompare(k.name||"",void 0,{sensitivity:"base"}))),y=V(()=>{const _=a.value.trim();return s.value==="no-scope"?_?"No unassigned contacts match your search.":"All contacts are assigned.":s.value==="with-scope"?_?"No assigned contacts match your search.":"No contacts are assigned yet.":_?"No contacts match your search.":"No contacts yet. Create one to get started!"});return(_,k)=>(v(),m("div",AC,[r("div",EC,[r("div",PC,[r("button",{onClick:k[0]||(k[0]=w=>_.$emit("add-contact")),class:"btn btn-primary"}," Add contact ")]),e.contacts.length>0?(v(),m("div",DC,[Ae(Ln,{variant:"neutral",active:s.value==="all",onClick:k[1]||(k[1]=w=>u("all"))},{default:ze(()=>[Ye(C(e.contacts.length)+" total ",1)]),_:1},8,["active"]),l.value>0?(v(),We(Ln,{key:0,variant:"success",active:s.value==="with-scope",onClick:k[2]||(k[2]=w=>u("with-scope"))},{default:ze(()=>[Ye(C(l.value)+" assigned ",1)]),_:1},8,["active"])):M("",!0),i.value>0?(v(),We(Ln,{key:1,variant:"danger",active:s.value==="no-scope",onClick:k[3]||(k[3]=w=>u("no-scope"))},{default:ze(()=>[Ye(C(i.value)+" unassigned ",1)]),_:1},8,["active"])):M("",!0)])):M("",!0)]),r("div",RC,[r("div",OC,[Ue(r("input",{"onUpdate:modelValue":k[4]||(k[4]=w=>a.value=w),type:"text",class:"search-input",placeholder:"Search by name, role, email, or phone..."},null,512),[[st,a.value]])])]),Ae(Zv,{contacts:g.value,"show-notes":!0,"show-scopes":!0,"empty-message":y.value,onSelect:k[5]||(k[5]=w=>_.$emit("select-contact",w))},null,8,["contacts","empty-message"])]))}},NC=je(BC,[["__scopeId","data-v-ca4b1b77"]]),qv=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET/CEST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Australia/Sydney",label:"Sydney (AEDT/AEST)"}],FC={class:"event-details-tab"},UC={class:"event-info-card"},zC={class:"form-group"},HC={class:"form-group"},VC={class:"form-row"},GC={class:"form-group"},jC={class:"form-group"},ZC=["value"],qC={class:"form-actions"},WC=["disabled"],KC={__name:"EventDetailsTab",props:{eventData:{type:Object,required:!0},formDirty:{type:Boolean,default:!1}},emits:["submit","update:formDirty"],setup(e,{emit:t}){const o=e,a=t,s=$({...o.eventData});qe(()=>o.eventData,u=>{s.value={...u}},{deep:!0});const i=()=>{a("update:formDirty",!0)},l=()=>{a("submit",{...s.value})};return(u,d)=>(v(),m("div",FC,[r("div",UC,[r("form",{onSubmit:rt(l,["prevent"]),class:"event-details-form"},[r("div",zC,[d[4]||(d[4]=r("label",null,"Event name",-1)),Ue(r("input",{"onUpdate:modelValue":d[0]||(d[0]=p=>s.value.name=p),type:"text",required:"",class:"form-input",onInput:i},null,544),[[st,s.value.name]])]),r("div",HC,[d[5]||(d[5]=r("label",null,"Description",-1)),Ue(r("textarea",{"onUpdate:modelValue":d[1]||(d[1]=p=>s.value.description=p),rows:"3",class:"form-input",onInput:i},null,544),[[st,s.value.description]])]),r("div",VC,[r("div",GC,[d[6]||(d[6]=r("label",null,"Event date & time",-1)),Ue(r("input",{"onUpdate:modelValue":d[2]||(d[2]=p=>s.value.eventDate=p),type:"datetime-local",required:"",class:"form-input",onInput:i},null,544),[[st,s.value.eventDate]])]),r("div",jC,[d[7]||(d[7]=r("label",null,"Time zone",-1)),Ue(r("select",{"onUpdate:modelValue":d[3]||(d[3]=p=>s.value.timeZoneId=p),required:"",class:"form-input",onChange:i},[(v(!0),m(xe,null,Ne(O(qv),p=>(v(),m("option",{key:p.value,value:p.value},C(p.label),9,ZC))),128))],544),[[Bn,s.value.timeZoneId]])])]),r("div",qC,[r("button",{type:"submit",class:"btn btn-save",disabled:!e.formDirty}," Save ",8,WC)])],32)])]))}},JC=je(KC,[["__scopeId","data-v-2754c3cc"]]),YC={class:"admins-list"},XC={class:"admin-info"},QC={class:"admin-role"},e2=["onClick"],t2={__name:"AdminsList",props:{admins:{type:Array,required:!0}},emits:["add-admin","remove-admin"],setup(e){return(t,o)=>(v(),m("div",null,[r("button",{onClick:o[0]||(o[0]=a=>t.$emit("add-admin")),class:"btn btn-small btn-primary"}," Add administrator "),r("div",YC,[(v(!0),m(xe,null,Ne(e.admins,a=>(v(),m("div",{key:a.userEmail,class:"admin-item"},[r("div",XC,[r("strong",null,C(a.userEmail),1),r("span",QC,C(a.role),1)]),e.admins.length>1?(v(),m("button",{key:0,onClick:s=>t.$emit("remove-admin",a.userEmail),class:"btn btn-small btn-danger"}," Remove ",8,e2)):M("",!0)]))),128))])]))}},n2=je(t2,[["__scopeId","data-v-e526860b"]]),An=[{name:"Charcoal",hex:"#2d3748"},{name:"Dark Gray",hex:"#4a5568"},{name:"Gray",hex:"#718096"},{name:"Red",hex:"#f56565"},{name:"Coral",hex:"#ff6b6b"},{name:"Rose",hex:"#fb7185"},{name:"Pink",hex:"#ed64a6"},{name:"Magenta",hex:"#d946ef"},{name:"Fuchsia",hex:"#e879f9"},{name:"Purple",hex:"#9f7aea"},{name:"Violet",hex:"#a78bfa"},{name:"Lavender",hex:"#b197fc"},{name:"Indigo",hex:"#5a67d8"},{name:"Navy",hex:"#4263eb"},{name:"Blue",hex:"#667eea"},{name:"Sky",hex:"#0ea5e9"},{name:"Cyan",hex:"#0bc5ea"},{name:"Aqua",hex:"#22d3ee"},{name:"Teal",hex:"#38b2ac"},{name:"Emerald",hex:"#10b981"},{name:"Green",hex:"#48bb78"},{name:"Mint",hex:"#51cf66"},{name:"Lime",hex:"#84cc16"},{name:"Olive",hex:"#a3b18a"},{name:"Yellow",hex:"#ecc94b"},{name:"Amber",hex:"#f59e0b"},{name:"Orange",hex:"#ed8936"},{name:"Peach",hex:"#ff922b"},{name:"Light Gray",hex:"#cbd5e0"},{name:"Silver",hex:"#e2e8f0"},{name:"Cream",hex:"#f7fafc"}],Cr="#667eea";function o2(e){const t=e.map(a=>a.color);return An.find(a=>!t.includes(a.hex))?.hex||Cr}const s2={class:"modal-content"},a2={class:"modal-body"},i2={class:"preview-section"},l2={class:"map-preview"},r2=["innerHTML"],c2={class:"options-grid"},u2={class:"option-button-content"},d2={class:"option-button-value icon-value"},h2=["innerHTML"],f2={class:"option-button-content"},p2={class:"option-button-value color-value"},v2=["disabled"],m2={class:"option-button-content"},g2={class:"option-button-value color-value"},y2={class:"option-button-content"},k2={class:"option-button-value icon-value"},_2=["innerHTML"],b2=["disabled"],w2={class:"option-button-content"},C2={class:"option-button-value color-value"},L2={class:"option-button-content"},S2={class:"option-button-value"},x2={class:"option-button-content"},I2={class:"option-button-value"},$2={key:0,class:"centered-popup"},T2={class:"popup-grid"},M2=["onClick"],A2=["innerHTML"],E2={key:0},P2={key:1,class:"centered-popup"},D2={class:"popup-grid"},R2=["title","onClick"],O2=["innerHTML"],B2={key:0},N2={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},F2={key:1,class:"custom-check-mark"},U2={key:0,class:"custom-hex-input"},z2={class:"hex-input-row"},H2=["disabled"],V2={key:0,class:"hex-error"},G2={key:2,class:"centered-popup"},j2={class:"popup-grid"},Z2=["title","onClick"],q2=["innerHTML"],W2={key:0},K2={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},J2={key:1,class:"custom-check-mark"},Y2={key:0,class:"custom-hex-input"},X2={class:"hex-input-row"},Q2=["disabled"],eL={key:0,class:"hex-error"},tL={key:3,class:"centered-popup icon-popup"},nL={class:"popup-grid"},oL=["onClick"],sL=["innerHTML"],aL={key:0},iL={key:4,class:"centered-popup"},lL={class:"popup-grid"},rL=["title","onClick"],cL=["innerHTML"],uL={key:0},dL={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},hL={key:1,class:"custom-check-mark"},fL={key:0,class:"custom-hex-input"},pL={class:"hex-input-row"},vL=["disabled"],mL={key:0,class:"hex-error"},gL={key:5,class:"centered-popup"},yL={class:"size-grid"},kL=["onClick"],_L=["innerHTML"],bL={key:6,class:"centered-popup"},wL={class:"rotation-content"},CL={class:"rotation-preview-container"},LL=["innerHTML"],SL={class:"rotation-control"},xL={class:"rotation-slider-container"},IL=["value"],$L={class:"rotation-value"},TL={class:"rotation-presets"},ML="#667eea",AL={__name:"IconCustomizationModal",props:{isOpen:{type:Boolean,default:!1},iconType:{type:String,default:"none"},backgroundShape:{type:String,default:"circle"},backgroundColor:{type:String,default:""},borderColor:{type:String,default:""},iconColor:{type:String,default:""},size:{type:String,default:"100"},mapRotation:{type:[String,Number],default:""},level:{type:String,default:"checkpoint"},inheritedType:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""}},emits:["update:isOpen","apply","cancel"],setup(e,{emit:t}){const o=e,a=t,s=$(o.backgroundShape||"circle"),i=$(o.iconType||"none"),l=$(o.backgroundColor||""),u=$(o.borderColor||""),d=$(o.iconColor||""),p=$(o.size||"100"),f=$(o.mapRotation??""),g=$(null),y=$(!1),_=$(!1),k=$(!1),w=$(""),S=$(""),E=$(""),A=$(null),x=$(null),D=$(null),R=ie=>ie==="default"?o.inheritedBackgroundShape||"circle":ie==="none"?"none":ie||"circle",F=ie=>ie==="default"||!ie?U():ie==="none"?"transparent":ie,T=ie=>ie==="default"?o.inheritedBorderColor||"#ffffff":ie==="none"||!ie?"transparent":ie,N=ie=>{if(ie==="default"){const re=o.inheritedType;return re&&re!=="default"&&oi(re).category==="content"?re:"none"}return ie==="none"||!ie?"none":ie},B=ie=>ie==="default"||!ie?o.inheritedIconColor||"#ffffff":ie==="none"?"transparent":ie,q=ie=>ie==="default"?o.inheritedSize||"100":ie||"100",P=ie=>{if(ie==="default"||ie===""){const re=o.inheritedMapRotation;return re!==""&&re!==void 0&&re!==null&&parseInt(re,10)||0}return parseInt(ie,10)||0},G=V(()=>{const ie=o.inheritedBackgroundShape||"circle",re=fr.find(me=>me.value===ie)?.label||"Circle";return[{value:"none",label:"None",showLabel:!0},{value:"default",label:`Default (${re})`,showLabel:!0},...fr.filter(me=>me.value!=="none").map(me=>({...me,showLabel:!1}))]}),X=V(()=>{const ie=Hr.filter(ot=>ot.category==="content"),re=[{value:"none",label:"None",category:"content",showLabel:!0}],me=o.inheritedType;if(me&&me!=="default"){const ot=oi(me);ot.category==="content"&&re.push({value:"default",label:`Default (${ot.label||me})`,category:"content",showLabel:!0})}return re.push(...ie.map(ot=>({...ot,showLabel:!1}))),re}),ne=V(()=>{const ie={33:"Small",66:"Medium",100:"Normal",150:"Large"};return[{value:"default",label:`Default (${ie[o.inheritedSize]||"Normal"})`},...zb.map(me=>({value:me.value,label:ie[me.value]||me.label}))]}),K=V(()=>R(s.value)!=="none"),Q=V(()=>N(i.value)!=="none"),he=V(()=>{const ie=o.inheritedBackgroundColor;return ie&&ie!=="default"&&ie.startsWith("#")?ie:ML}),U=()=>he.value,ee=V(()=>l.value&&l.value!=="default"?l.value:U()),fe=V(()=>u.value==="none"?"transparent":u.value?u.value:o.inheritedBorderColor&&o.inheritedBorderColor!=="none"?o.inheritedBorderColor:"#ffffff"),ue=V(()=>d.value?d.value:o.inheritedIconColor?o.inheritedIconColor:"#ffffff"),De=V(()=>{const ie=he.value,re=An.find(me=>me.hex.toLowerCase()===ie.toLowerCase())?.name||"Custom";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${re})`,showLabel:!0},...An.map(me=>({hex:me.hex,name:me.name,showLabel:!1}))]}),et=V(()=>{const ie=o.inheritedBorderColor||"#ffffff",re=ie==="#ffffff"?"White":An.find(me=>me.hex===ie)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${re})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...An.filter(me=>me.hex!=="#ffffff").map(me=>({hex:me.hex,name:me.name,showLabel:!1}))]}),Je=V(()=>{const ie=o.inheritedIconColor||"#ffffff",re=ie==="#ffffff"?"White":An.find(me=>me.hex===ie)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${re})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...An.filter(me=>me.hex!=="#ffffff").map(me=>({hex:me.hex,name:me.name,showLabel:!1}))]}),Ze=ie=>ie==="default"?!l.value||l.value==="default":l.value===ie,He=ie=>ie==="#ffffff"?!d.value||d.value==="#ffffff":d.value===ie,be=V(()=>{const ie=l.value;return!ie||ie==="default"||ie==="none"?!1:!An.some(re=>re.hex.toLowerCase()===ie.toLowerCase())}),Ve=V(()=>{const ie=u.value;return!ie||ie==="default"||ie==="none"||ie==="#ffffff"||ie==="#000000"?!1:!An.some(re=>re.hex.toLowerCase()===ie.toLowerCase())}),ve=V(()=>{const ie=d.value;return!ie||ie==="default"||ie==="none"||ie==="#ffffff"||ie==="#000000"?!1:!An.some(re=>re.hex.toLowerCase()===ie.toLowerCase())}),Le=V(()=>{if(!w.value)return!1;const ie=w.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(ie)||/^[0-9A-Fa-f]{3}$/.test(ie)}),Pe=V(()=>{if(!S.value)return!1;const ie=S.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(ie)||/^[0-9A-Fa-f]{3}$/.test(ie)}),W=V(()=>{if(!E.value)return!1;const ie=E.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(ie)||/^[0-9A-Fa-f]{3}$/.test(ie)}),Y=ie=>{if(ie==="none")return"None";if(ie==="default"){const me=o.inheritedBackgroundShape;return me?`Default (${fr.find(Ge=>Ge.value===me)?.label||"Circle"})`:"Default (Circle)"}const re=fr.find(me=>me.value===ie);return re?re.label:"Circle"},pe=ie=>{if(ie==="none")return"None";if(ie==="default"){const me=o.inheritedType;if(me&&me!=="default"){const ot=oi(me);if(ot.category==="content")return`Default (${ot.label||me})`}return"Default"}const re=Hr.find(me=>me.value===ie);return re?re.label:"None"},Ce=ie=>{if(ie==="none")return"None";if(!ie||ie==="default"){const me=he.value;return`Default (${An.find(Ge=>Ge.hex.toLowerCase()===me.toLowerCase())?.name||"Custom"})`}const re=[...An].find(me=>me.hex.toLowerCase()===ie.toLowerCase());return re?re.name:ie},le=ie=>{if(ie==="none")return"None";if(ie==="default"){const me=o.inheritedBorderColor;return me&&me!=="none"?`Default (${me==="#ffffff"?"White":An.find(Ge=>Ge.hex===me)?.name||"Custom"})`:"Default (White)"}if(!ie||ie==="#ffffff")return"White";const re=[...et.value].find(me=>me.hex===ie);return re?re.name:ie},J=ie=>{if(ie==="none")return"None";if(ie==="default"){const me=o.inheritedIconColor;return me?`Default (${me==="#ffffff"?"White":An.find(Ge=>Ge.hex===me)?.name||"Custom"})`:"Default (White)"}if(!ie||ie==="#ffffff")return"White";const re=[...Je.value].find(me=>me.hex===ie);return re?re.name:ie},j=ie=>{const re={33:"Small",66:"Medium",100:"Normal",150:"Large"};if(ie==="default"){const me=o.inheritedSize;return`Default (${re[me]||"Normal"})`}return re[ie]||"Normal"},te=ie=>{if(ie==="default"||ie===""||ie===void 0||ie===null){const re=o.inheritedMapRotation;return re!==""&&re!==void 0&&re!==null?`Default (${re})`:"Default (0)"}return`${ie}`},Re=ie=>{if(ie==="none")return`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`;const re=R(ie),me=F(l.value),ot=T(u.value);return Mi[re]?`<svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">${Mi[re]({backgroundColor:me,borderColor:ot==="transparent"?"none":ot})}</svg>`:""},Se=ie=>{const re=N(ie);return re==="none"?`<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
      <rect x="1" y="1" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`:Cn({type:re,backgroundShape:"circle",backgroundColor:"#94a3b8",borderColor:"none",iconColor:"#fff",size:"75"})},we=ie=>{const re=R(ie);if(re==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="none" stroke="#ccc" stroke-width="2" stroke-dasharray="4"/>
    </svg>`;const me=F(l.value),ot=T(u.value),Ge=N(i.value),St=B(d.value);return Cn({type:Ge!=="none"?Ge:re,backgroundShape:re,backgroundColor:me,borderColor:ot==="transparent"?"none":ot,iconColor:St,size:"100",outputSize:28})},ge=ie=>{const re=F(ie),me=R(s.value),ot=T(u.value),Ge=N(i.value),St=B(d.value);return me==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${re==="transparent"?"#e2e8f0":re}"/>
    </svg>`:Cn({type:Ge!=="none"?Ge:me,backgroundShape:me,backgroundColor:re==="transparent"?"#e2e8f0":re,borderColor:ot==="transparent"?"none":ot,iconColor:St,size:"100",outputSize:28})},Z=ie=>{const re=T(ie),me=R(s.value),ot=F(l.value),Ge=N(i.value),St=B(d.value);return me==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0" stroke="${re}" stroke-width="2"/>
    </svg>`:Cn({type:Ge!=="none"?Ge:me,backgroundShape:me,backgroundColor:ot,borderColor:re==="transparent"?"none":re,iconColor:St,size:"100",outputSize:28})},se=ie=>{const re=N(ie),me=R(s.value),ot=F(l.value),Ge=T(u.value),St=B(d.value);if(re==="none"&&me==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0"/>
      <line x1="8" y1="8" x2="20" y2="20" stroke="#a0aec0" stroke-width="2" stroke-linecap="round"/>
    </svg>`;const Wt=me!=="none"?me:"circle";return Cn({type:re!=="none"?re:Wt,backgroundShape:Wt,backgroundColor:ot,borderColor:Ge==="transparent"?"none":Ge,iconColor:St,size:"100",outputSize:42})},ce=ie=>{const re=B(ie),me=R(s.value),ot=F(l.value),Ge=T(u.value),St=N(i.value);return St==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${re==="transparent"?"#e2e8f0":re}"/>
    </svg>`:Cn({type:St,backgroundShape:me!=="none"?me:"circle",backgroundColor:ot,borderColor:Ge==="transparent"?"none":Ge,iconColor:re==="transparent"?"#e2e8f0":re,size:"100",outputSize:28})},Te=ie=>{const re=q(ie),me=R(s.value),ot=F(l.value),Ge=T(u.value),St=N(i.value),Wt=B(d.value);if(me==="none"&&St==="none")return"";const Qt=me!=="none"?me:"circle";return Cn({type:St!=="none"?St:Qt,backgroundShape:Qt,backgroundColor:ot,borderColor:Ge==="transparent"?"none":Ge,iconColor:Wt,size:re})},Oe=V(()=>{const ie=R(s.value),re=F(l.value),me=T(u.value),ot=N(i.value),Ge=B(d.value),St=q(p.value);return ie==="none"&&ot==="none"?"":Cn(ie==="none"&&ot!=="none"?{type:ot,backgroundShape:"none",backgroundColor:re,borderColor:"none",iconColor:Ge,size:St}:{type:ot!=="none"?ot:ie,backgroundShape:ie,backgroundColor:re,borderColor:me==="transparent"?"none":me,iconColor:Ge,size:St})}),Be=ie=>{g.value=g.value===ie?null:ie},Xe=()=>{g.value=null,y.value=!1,_.value=!1,k.value=!1},mt=ie=>{s.value=ie,Xe()},_t=ie=>{l.value=ie,Xe()},bt=ie=>{u.value=ie,Xe()},Mt=ie=>{i.value=ie,Xe()},wt=ie=>{d.value=ie,Xe()},Nt=ie=>{p.value=ie,Xe()},Ft=ie=>{f.value=ie,Xe()},Fn=()=>{y.value=!y.value,y.value&&(be.value?w.value=l.value.replace(/^#/,""):w.value="",cn(()=>A.value?.focus()))},Qn=()=>{_.value=!_.value,_.value&&(Ve.value?S.value=u.value.replace(/^#/,""):S.value="",cn(()=>x.value?.focus()))},fn=()=>{k.value=!k.value,k.value&&(ve.value?E.value=d.value.replace(/^#/,""):E.value="",cn(()=>D.value?.focus()))},jt=()=>{w.value=w.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},yt=()=>{S.value=S.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},eo=()=>{E.value=E.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},Un=ie=>ie.length===3?ie[0]+ie[0]+ie[1]+ie[1]+ie[2]+ie[2]:ie,to=()=>{if(!Le.value)return;const ie=Un(w.value);l.value="#"+ie,y.value=!1,Xe()},pn=()=>{if(!Pe.value)return;const ie=Un(S.value);u.value="#"+ie,_.value=!1,Xe()},Zt=()=>{if(!W.value)return;const ie=Un(E.value);d.value="#"+ie,k.value=!1,Xe()},ks=ie=>{f.value=ie};qe(()=>o.isOpen,ie=>{if(ie){const re=o.backgroundShape&&o.backgroundShape!=="default"&&o.backgroundShape!=="circle",me=o.iconType&&o.iconType!=="none"&&o.iconType!=="default",ot=o.backgroundColor&&o.backgroundColor!=="",Ge=o.borderColor&&o.borderColor!=="",St=o.iconColor&&o.iconColor!=="",Wt=o.size&&o.size!==""&&o.size!=="100",Qt=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null&&o.mapRotation!==0;re||me||ot||Ge||St||Wt||Qt?(s.value=o.backgroundShape||"default",i.value=o.iconType||"default",l.value=o.backgroundColor||"default",u.value=o.borderColor||"default",d.value=o.iconColor||"default",p.value=o.size||"default",f.value=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null?o.mapRotation:"default"):(s.value="default",i.value="default",l.value="default",u.value="default",d.value="default",p.value="default",f.value="default"),g.value=null}});const no=()=>{Xe(),a("update:isOpen",!1),a("cancel")},Co=()=>{Xe();const ie=ot=>ot==="default"?"":ot;let re="";i.value==="none"?re="none":i.value&&i.value!=="default"&&(re=i.value);let me="";f.value!=="default"&&f.value!==""&&f.value!==void 0&&(me=parseInt(f.value,10)||0),a("apply",{iconType:re,backgroundShape:ie(s.value),backgroundColor:ie(l.value),borderColor:ie(u.value),iconColor:ie(d.value),size:ie(p.value),mapRotation:me}),a("update:isOpen",!1)};return(ie,re)=>e.isOpen?(v(),m("div",{key:0,class:"modal-overlay",onClick:rt(no,["self"])},[r("div",s2,[r("div",{class:"modal-header"},[re[18]||(re[18]=r("h3",null,"Customise marker style",-1)),r("button",{class:"close-btn",onClick:no},"")]),r("div",a2,[r("div",i2,[r("div",l2,[re[19]||(re[19]=r("div",{class:"map-background"},null,-1)),r("div",{class:"preview-icon",style:Qe({transform:`rotate(${P(f.value)}deg)`}),innerHTML:Oe.value},null,12,r2)])]),r("div",c2,[r("button",{type:"button",class:de(["option-button",{active:g.value==="shape"}]),onClick:re[0]||(re[0]=me=>Be("shape"))},[r("div",u2,[re[20]||(re[20]=r("span",{class:"option-button-label"},"Shape",-1)),r("div",d2,[r("div",{class:"icon-preview-small",innerHTML:Re(s.value)},null,8,h2),r("span",null,C(Y(s.value)),1)])]),re[21]||(re[21]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:de(["option-button",{active:g.value==="bgColor"}]),onClick:re[1]||(re[1]=me=>Be("bgColor"))},[r("div",f2,[re[22]||(re[22]=r("span",{class:"option-button-label"},"Background",-1)),r("div",p2,[r("span",{class:"color-swatch",style:Qe({backgroundColor:ee.value})},null,4),r("span",null,C(Ce(l.value)),1)])]),re[23]||(re[23]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:de(["option-button",{active:g.value==="borderColor",disabled:!K.value}]),disabled:!K.value,onClick:re[2]||(re[2]=me=>Be("borderColor"))},[r("div",m2,[re[24]||(re[24]=r("span",{class:"option-button-label"},"Border",-1)),r("div",g2,[r("span",{class:de(["color-swatch",{"no-border":u.value==="none"}]),style:Qe(u.value!=="none"?{backgroundColor:fe.value}:{})},null,6),r("span",null,C(le(u.value)),1)])]),re[25]||(re[25]=r("span",{class:"option-button-arrow"},"",-1))],10,v2),r("button",{type:"button",class:de(["option-button",{active:g.value==="icon"}]),onClick:re[3]||(re[3]=me=>Be("icon"))},[r("div",y2,[re[26]||(re[26]=r("span",{class:"option-button-label"},"Icon",-1)),r("div",k2,[r("div",{class:"icon-preview-small",innerHTML:Se(i.value)},null,8,_2),r("span",null,C(pe(i.value)),1)])]),re[27]||(re[27]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:de(["option-button",{active:g.value==="iconColor",disabled:!Q.value}]),disabled:!Q.value,onClick:re[4]||(re[4]=me=>Be("iconColor"))},[r("div",w2,[re[28]||(re[28]=r("span",{class:"option-button-label"},"Colour",-1)),r("div",C2,[r("span",{class:"color-swatch",style:Qe({backgroundColor:ue.value})},null,4),r("span",null,C(J(d.value)),1)])]),re[29]||(re[29]=r("span",{class:"option-button-arrow"},"",-1))],10,b2),r("button",{type:"button",class:de(["option-button",{active:g.value==="size"}]),onClick:re[5]||(re[5]=me=>Be("size"))},[r("div",L2,[re[30]||(re[30]=r("span",{class:"option-button-label"},"Size",-1)),r("span",S2,C(j(p.value)),1)]),re[31]||(re[31]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:de(["option-button option-button-full",{active:g.value==="mapRotation"}]),onClick:re[6]||(re[6]=me=>Be("mapRotation"))},[r("div",x2,[re[32]||(re[32]=r("span",{class:"option-button-label"},"Map rotation",-1)),r("span",I2,C(te(f.value)),1)]),re[33]||(re[33]=r("span",{class:"option-button-arrow"},"",-1))],2)]),g.value==="shape"?(v(),m("div",$2,[r("div",{class:"popup-header"},[re[34]||(re[34]=r("span",null,"Select shape",-1)),r("button",{type:"button",class:"popup-close",onClick:Xe},"")]),r("div",T2,[(v(!0),m(xe,null,Ne(G.value,me=>(v(),m("button",{key:me.value,type:"button",class:de(["popup-grid-item",{selected:s.value===me.value}]),onClick:ot=>mt(me.value)},[r("div",{class:"popup-item-preview",innerHTML:we(me.value)},null,8,A2),me.showLabel?(v(),m("span",E2,C(me.label),1)):M("",!0)],10,M2))),128))])])):M("",!0),g.value==="bgColor"?(v(),m("div",P2,[r("div",{class:"popup-header"},[re[35]||(re[35]=r("span",null,"Select background",-1)),r("button",{type:"button",class:"popup-close",onClick:Xe},"")]),r("div",D2,[(v(!0),m(xe,null,Ne(De.value,me=>(v(),m("button",{key:me.hex,type:"button",class:de(["popup-grid-item",{selected:Ze(me.hex)}]),title:me.name,onClick:ot=>_t(me.hex)},[r("div",{class:"popup-item-preview",innerHTML:ge(me.hex)},null,8,O2),me.showLabel?(v(),m("span",B2,C(me.name),1)):M("",!0)],10,R2))),128)),r("button",{type:"button",class:de(["popup-grid-item custom-color-option",{selected:be.value}]),style:Qe(be.value?{"--custom-color":l.value}:{}),title:"Custom colour",onClick:Fn},[r("div",{class:"popup-item-preview custom-color-preview",style:Qe(be.value?{backgroundColor:l.value}:{})},[be.value?M("",!0):(v(),m("svg",N2,[...re[36]||(re[36]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),be.value?(v(),m("span",F2,"")):M("",!0)],4),re[37]||(re[37]=r("span",null,"Custom",-1))],6)]),y.value?(v(),m("div",U2,[re[39]||(re[39]=r("label",null,"Enter hex code",-1)),r("div",z2,[re[38]||(re[38]=r("span",{class:"hex-prefix"},"#",-1)),Ue(r("input",{ref_key:"bgHexInput",ref:A,"onUpdate:modelValue":re[7]||(re[7]=me=>w.value=me),type:"text",maxlength:"6",placeholder:"000000",class:de(["hex-input",{invalid:w.value&&!Le.value}]),onInput:jt,onKeydown:ps(to,["enter"])},null,34),[[st,w.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:Le.value?"#"+w.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!Le.value,onClick:to}," Apply ",8,H2)]),w.value&&!Le.value?(v(),m("span",V2," Invalid hex code ")):M("",!0)])):M("",!0)])):M("",!0),g.value==="borderColor"?(v(),m("div",G2,[r("div",{class:"popup-header"},[re[40]||(re[40]=r("span",null,"Select border",-1)),r("button",{type:"button",class:"popup-close",onClick:Xe},"")]),r("div",j2,[(v(!0),m(xe,null,Ne(et.value,me=>(v(),m("button",{key:me.hex,type:"button",class:de(["popup-grid-item",{selected:u.value===me.hex}]),title:me.name,onClick:ot=>bt(me.hex)},[r("div",{class:"popup-item-preview",innerHTML:Z(me.hex)},null,8,q2),me.showLabel?(v(),m("span",W2,C(me.name),1)):M("",!0)],10,Z2))),128)),r("button",{type:"button",class:de(["popup-grid-item custom-color-option",{selected:Ve.value}]),style:Qe(Ve.value?{"--custom-color":u.value}:{}),title:"Custom colour",onClick:Qn},[r("div",{class:"popup-item-preview custom-color-preview",style:Qe(Ve.value?{backgroundColor:u.value}:{})},[Ve.value?M("",!0):(v(),m("svg",K2,[...re[41]||(re[41]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),Ve.value?(v(),m("span",J2,"")):M("",!0)],4),re[42]||(re[42]=r("span",null,"Custom",-1))],6)]),_.value?(v(),m("div",Y2,[re[44]||(re[44]=r("label",null,"Enter hex code",-1)),r("div",X2,[re[43]||(re[43]=r("span",{class:"hex-prefix"},"#",-1)),Ue(r("input",{ref_key:"borderHexInput",ref:x,"onUpdate:modelValue":re[8]||(re[8]=me=>S.value=me),type:"text",maxlength:"6",placeholder:"000000",class:de(["hex-input",{invalid:S.value&&!Pe.value}]),onInput:yt,onKeydown:ps(pn,["enter"])},null,34),[[st,S.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:Pe.value?"#"+S.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!Pe.value,onClick:pn}," Apply ",8,Q2)]),S.value&&!Pe.value?(v(),m("span",eL," Invalid hex code ")):M("",!0)])):M("",!0)])):M("",!0),g.value==="icon"?(v(),m("div",tL,[r("div",{class:"popup-header"},[re[45]||(re[45]=r("span",null,"Select icon",-1)),r("button",{type:"button",class:"popup-close",onClick:Xe},"")]),r("div",nL,[(v(!0),m(xe,null,Ne(X.value,me=>(v(),m("button",{key:me.value,type:"button",class:de(["popup-grid-item",{selected:i.value===me.value}]),onClick:ot=>Mt(me.value)},[r("div",{class:"popup-item-preview",innerHTML:se(me.value)},null,8,sL),me.showLabel?(v(),m("span",aL,C(me.label),1)):M("",!0)],10,oL))),128))])])):M("",!0),g.value==="iconColor"?(v(),m("div",iL,[r("div",{class:"popup-header"},[re[46]||(re[46]=r("span",null,"Select colour",-1)),r("button",{type:"button",class:"popup-close",onClick:Xe},"")]),r("div",lL,[(v(!0),m(xe,null,Ne(Je.value,me=>(v(),m("button",{key:me.hex,type:"button",class:de(["popup-grid-item",{selected:He(me.hex)}]),title:me.name,onClick:ot=>wt(me.hex)},[r("div",{class:"popup-item-preview",innerHTML:ce(me.hex)},null,8,cL),me.showLabel?(v(),m("span",uL,C(me.name),1)):M("",!0)],10,rL))),128)),r("button",{type:"button",class:de(["popup-grid-item custom-color-option",{selected:ve.value}]),style:Qe(ve.value?{"--custom-color":d.value}:{}),title:"Custom colour",onClick:fn},[r("div",{class:"popup-item-preview custom-color-preview",style:Qe(ve.value?{backgroundColor:d.value}:{})},[ve.value?M("",!0):(v(),m("svg",dL,[...re[47]||(re[47]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),ve.value?(v(),m("span",hL,"")):M("",!0)],4),re[48]||(re[48]=r("span",null,"Custom",-1))],6)]),k.value?(v(),m("div",fL,[re[50]||(re[50]=r("label",null,"Enter hex code",-1)),r("div",pL,[re[49]||(re[49]=r("span",{class:"hex-prefix"},"#",-1)),Ue(r("input",{ref_key:"iconHexInput",ref:D,"onUpdate:modelValue":re[9]||(re[9]=me=>E.value=me),type:"text",maxlength:"6",placeholder:"000000",class:de(["hex-input",{invalid:E.value&&!W.value}]),onInput:eo,onKeydown:ps(Zt,["enter"])},null,34),[[st,E.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:W.value?"#"+E.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!W.value,onClick:Zt}," Apply ",8,vL)]),E.value&&!W.value?(v(),m("span",mL," Invalid hex code ")):M("",!0)])):M("",!0)])):M("",!0),g.value==="size"?(v(),m("div",gL,[r("div",{class:"popup-header"},[re[51]||(re[51]=r("span",null,"Select size",-1)),r("button",{type:"button",class:"popup-close",onClick:Xe},"")]),r("div",yL,[(v(!0),m(xe,null,Ne(ne.value,me=>(v(),m("button",{key:me.value,type:"button",class:de(["size-grid-item",{selected:p.value===me.value}]),onClick:ot=>Nt(me.value)},[r("div",{class:"size-preview",innerHTML:Te(me.value)},null,8,_L),r("span",null,C(me.label),1)],10,kL))),128))])])):M("",!0),g.value==="mapRotation"?(v(),m("div",bL,[r("div",{class:"popup-header"},[re[52]||(re[52]=r("span",null,"Set map rotation",-1)),r("button",{type:"button",class:"popup-close",onClick:Xe},"")]),r("div",wL,[r("div",CL,[r("div",{class:"rotation-preview-icon",style:Qe({transform:`rotate(${P(f.value)}deg)`}),innerHTML:Oe.value},null,12,LL)]),re[53]||(re[53]=r("p",{class:"rotation-description"}," Rotate the marker on the map. This rotation is added to any map rotation. ",-1)),r("div",SL,[r("button",{type:"button",class:de(["rotation-preset",{selected:f.value==="default"||f.value===""}]),onClick:re[10]||(re[10]=me=>Ft("default"))}," Default ",2),r("div",xL,[r("input",{type:"range",min:"-180",max:"180",step:"5",class:"rotation-slider",value:f.value==="default"||f.value===""?0:f.value,onInput:re[11]||(re[11]=me=>ks(parseInt(me.target.value,10)))},null,40,IL),r("div",$L,C(f.value==="default"||f.value===""?"0":f.value)+" ",1)])]),r("div",TL,[r("button",{type:"button",class:de(["rotation-preset-btn",{selected:f.value===-90}]),onClick:re[12]||(re[12]=me=>Ft(-90))},"-90",2),r("button",{type:"button",class:de(["rotation-preset-btn",{selected:f.value===-45}]),onClick:re[13]||(re[13]=me=>Ft(-45))},"-45",2),r("button",{type:"button",class:de(["rotation-preset-btn",{selected:f.value===0}]),onClick:re[14]||(re[14]=me=>Ft(0))},"0",2),r("button",{type:"button",class:de(["rotation-preset-btn",{selected:f.value===45}]),onClick:re[15]||(re[15]=me=>Ft(45))},"+45",2),r("button",{type:"button",class:de(["rotation-preset-btn",{selected:f.value===90}]),onClick:re[16]||(re[16]=me=>Ft(90))},"+90",2),r("button",{type:"button",class:de(["rotation-preset-btn",{selected:f.value===180}]),onClick:re[17]||(re[17]=me=>Ft(180))},"180",2)])])])):M("",!0)]),r("div",{class:"modal-footer"},[r("button",{type:"button",class:"btn-cancel",onClick:no},"Cancel"),r("button",{type:"button",class:"btn-apply",onClick:Co},"Apply")])])])):M("",!0)}},EL=je(AL,[["__scopeId","data-v-bbab1a46"]]),PL={class:"checkpoint-style-picker"},DL={class:"form-group"},RL={class:"style-options"},OL=["innerHTML"],BL={class:"option-label"},NL=["innerHTML"],FL="#667eea",UL={__name:"CheckpointStylePicker",props:{styleType:{type:String,default:"default"},styleColor:{type:String,default:""},styleBackgroundShape:{type:String,default:""},styleBackgroundColor:{type:String,default:""},styleBorderColor:{type:String,default:""},styleIconColor:{type:String,default:""},styleSize:{type:String,default:""},styleMapRotation:{type:[String,Number],default:""},iconLabel:{type:String,default:"Marker style"},showPreview:{type:Boolean,default:!0},inheritedStyleType:{type:String,default:"default"},inheritedStyleColor:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""},defaultLabel:{type:String,default:"Default"},level:{type:String,default:"checkpoint"}},emits:["update:styleType","update:styleColor","update:styleBackgroundShape","update:styleBackgroundColor","update:styleBorderColor","update:styleIconColor","update:styleSize","update:styleMapRotation","change"],setup(e,{emit:t}){const o=e,a=t,s=$(o.styleType),i=$(o.styleColor||""),l=$(o.styleBackgroundShape||"default"),u=$(o.styleBackgroundColor||""),d=$(o.styleBorderColor||""),p=$(o.styleIconColor||""),f=$(o.styleSize||"default"),g=$(o.styleMapRotation||""),y=P=>!P||P==="default"?!1:oi(P).category==="content",_=$(o.styleType&&o.styleType!=="default"&&o.styleType!=="custom"&&y(o.styleType)?o.styleType:"default"),k=$(!1),w=V(()=>!!(s.value&&s.value!=="default"||l.value&&l.value!=="default"&&l.value!=="circle"||u.value||d.value||p.value||f.value&&f.value!=="default"&&f.value!=="100")),S=P=>P&&P!==""&&P!=="default",E=P=>P&&P.startsWith("#"),A=V(()=>{const G=S(o.inheritedStyleType),X=S(o.inheritedBackgroundShape),ne=E(o.inheritedBackgroundColor)||E(o.inheritedStyleColor),K=E(o.inheritedBorderColor),Q=E(o.inheritedIconColor),he=S(o.inheritedSize);if(G||X||ne||K||Q||he){const ee=G?o.inheritedStyleType:X?o.inheritedBackgroundShape:"circle",fe=(E(o.inheritedBackgroundColor)?o.inheritedBackgroundColor:null)||(E(o.inheritedStyleColor)?o.inheritedStyleColor:null)||FL;return Cn({type:ee,backgroundShape:o.inheritedBackgroundShape||"circle",backgroundColor:fe,borderColor:o.inheritedBorderColor||"#ffffff",iconColor:o.inheritedIconColor||"#ffffff",size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#10B981"/>
        <stop offset="50%" style="stop-color:#F59E0B"/>
        <stop offset="100%" style="stop-color:#EF4444"/>
      </linearGradient>
    </defs>
    <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#defaultGradient)" stroke="#fff" stroke-width="1.5"/>
  </svg>`}),x=V(()=>{const P=o.inheritedMapRotation;return P!==""&&P!==void 0&&P!==null&&P!==0?{transform:`rotate(${P}deg)`}:{}}),D=V(()=>{if(g.value!==""&&g.value!==void 0&&g.value!==null){const G=parseInt(g.value,10)||0;if(G!==0)return{transform:`rotate(${G}deg)`}}const P=o.inheritedMapRotation;return P!==""&&P!==void 0&&P!==null&&P!==0?{transform:`rotate(${P}deg)`}:{}}),R=V(()=>{if(w.value){const P=_.value&&_.value!=="none"&&_.value!=="default";let G=null;o.inheritedStyleType&&o.inheritedStyleType!=="default"&&o.inheritedStyleType!=="custom"&&oi(o.inheritedStyleType).category==="content"&&(G=o.inheritedStyleType);const X=_.value==="default"&&G,ne=P||X,K=P?_.value:X?G:null,Q=l.value&&l.value!=="default"?l.value:o.inheritedBackgroundShape||"circle",he=ne?K:Q,U=u.value||o.inheritedBackgroundColor||o.inheritedStyleColor||"#667eea",ee=d.value||o.inheritedBorderColor||"#ffffff",fe=p.value||o.inheritedIconColor||"#ffffff";return Cn({type:he,backgroundShape:Q,backgroundColor:U,borderColor:ee,iconColor:fe,size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#e2e8f0" stroke="#cbd5e0" stroke-width="1.5"/>
    <path d="M12 8v8M8 12h8" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
  </svg>`}),F=()=>{s.value="default",_.value="default",a("update:styleType","default"),l.value="default",u.value="",i.value="",d.value="",p.value="",f.value="default",g.value="",a("update:styleBackgroundShape",""),a("update:styleBackgroundColor",""),a("update:styleColor",""),a("update:styleBorderColor",""),a("update:styleIconColor",""),a("update:styleSize",""),a("update:styleMapRotation",""),q()},T=()=>{k.value=!0},N=P=>{P.iconType==="none"?_.value="none":P.iconType?_.value=P.iconType:_.value="default",l.value=P.backgroundShape||"default",u.value=P.backgroundColor||"",d.value=P.borderColor||"",p.value=P.iconColor||"",f.value=P.size||"default",g.value=P.mapRotation??"";const G=P.iconType==="none"||P.iconType&&P.iconType!==""||P.backgroundShape||P.backgroundColor||P.borderColor||P.iconColor||P.size||P.mapRotation!==""&&P.mapRotation!==0;P.iconType&&P.iconType!=="none"?s.value=P.iconType:G?s.value="custom":s.value="default",a("update:styleType",s.value),a("update:styleBackgroundShape",P.backgroundShape),a("update:styleBackgroundColor",P.backgroundColor),a("update:styleBorderColor",P.borderColor),a("update:styleIconColor",P.iconColor),a("update:styleSize",P.size),a("update:styleMapRotation",P.mapRotation??""),q()},B=()=>{},q=()=>{a("change",{styleType:s.value,styleColor:u.value||i.value,styleBackgroundShape:l.value,styleBackgroundColor:u.value,styleBorderColor:d.value,styleIconColor:p.value,styleSize:f.value,styleMapRotation:g.value})};return qe(()=>o.styleType,P=>{s.value=P,P&&P!=="default"&&P!=="custom"&&y(P)?_.value=P:_.value="default"}),qe(()=>o.styleColor,P=>{i.value=P||""}),qe(()=>o.styleBackgroundShape,P=>{l.value=P||"default"}),qe(()=>o.styleBackgroundColor,P=>{u.value=P||""}),qe(()=>o.styleBorderColor,P=>{d.value=P||""}),qe(()=>o.styleIconColor,P=>{p.value=P||""}),qe(()=>o.styleSize,P=>{f.value=P||"default"}),qe(()=>o.styleMapRotation,P=>{g.value=P??""}),(P,G)=>(v(),m("div",PL,[r("div",DL,[r("label",null,C(e.iconLabel),1),r("div",RL,[r("button",{type:"button",class:de(["style-option-button",{selected:!w.value}]),onClick:F},[r("div",{class:"option-preview",style:Qe(x.value),innerHTML:A.value},null,12,OL),r("span",BL,C(e.defaultLabel),1)],2),r("button",{type:"button",class:de(["style-option-button",{selected:w.value}]),onClick:T},[r("div",{class:"option-preview",style:Qe(D.value),innerHTML:R.value},null,12,NL),G[1]||(G[1]=r("span",{class:"option-label"},"Custom",-1))],2)])]),Ae(EL,{isOpen:k.value,"onUpdate:isOpen":G[0]||(G[0]=X=>k.value=X),"icon-type":_.value,"background-shape":l.value,"background-color":u.value,"border-color":d.value,"icon-color":p.value,size:f.value,"map-rotation":g.value,level:e.level,"inherited-type":e.inheritedStyleType,"inherited-background-shape":e.inheritedBackgroundShape,"inherited-background-color":e.inheritedBackgroundColor||e.inheritedStyleColor,"inherited-border-color":e.inheritedBorderColor,"inherited-icon-color":e.inheritedIconColor,"inherited-size":e.inheritedSize,"inherited-map-rotation":e.inheritedMapRotation,onApply:N,onCancel:B},null,8,["isOpen","icon-type","background-shape","background-color","border-color","icon-color","size","map-rotation","level","inherited-type","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])]))}},ad=je(UL,[["__scopeId","data-v-c066da64"]]),zL={class:"logo-uploader"},HL={key:0,class:"logo-preview"},VL=["src"],GL=["disabled"],jL={key:0,class:"upload-progress"},ZL={key:1,class:"upload-prompt"},qL={key:2,class:"error-message"},sf=5*1024*1024,WL={__name:"LogoUploader",props:{modelValue:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0},staged:{type:Boolean,default:!1}},emits:["update:modelValue","staged-change"],setup(e,{expose:t,emit:o}){const a=e;function s(){const K={},Q=localStorage.getItem("adminEmail");Q&&(K["X-Admin-Email"]=Q);const he=localStorage.getItem("sessionToken");return he&&(K.Authorization=`Bearer ${he}`),K}const i=o;function l(){i("staged-change",{hasPendingChanges:y.value!==null||k.value,isPendingDelete:k.value,displayUrl:_.value||(k.value?"":a.modelValue)||""})}const u=$(null),d=$(!1),p=$(!1),f=$(""),g=$(Date.now()),y=$(null),_=$(""),k=$(!1),w=V(()=>{if(a.staged){if(_.value)return!0;if(k.value)return!1}return!!a.modelValue}),S=V(()=>{if(a.staged&&k.value)return"";if(a.staged&&_.value)return _.value;if(!a.modelValue)return"";const K=a.modelValue.includes("?")?"&":"?";return`${a.modelValue}${K}_t=${g.value}`});function E(){_.value&&(URL.revokeObjectURL(_.value),_.value="")}xn(()=>{E()});const A=["image/png","image/jpeg","image/svg+xml","image/gif","image/webp"];function x(){d.value||u.value?.click()}function D(K){const Q=K.target.files?.[0];Q&&F(Q),u.value&&(u.value.value="")}function R(K){p.value=!1;const Q=K.dataTransfer?.files?.[0];Q&&F(Q)}async function F(K){if(f.value="",!A.includes(K.type)){f.value="Invalid file type. Please use PNG, JPEG, SVG, GIF, or WebP.";return}if(K.size>sf){f.value=`File too large. Maximum size is ${sf/(1024*1024)}MB.`;return}if(a.staged){E(),y.value=K,_.value=URL.createObjectURL(K),k.value=!1,l();return}d.value=!0;try{const Q=await fetch(`${dl}/events/${a.eventId}/logo`,{method:"POST",headers:{"Content-Type":K.type,...s()},body:K});if(!Q.ok){const U=await Q.text().catch(()=>"");let ee=`Upload failed (${Q.status})`;try{ee=JSON.parse(U).message||ee}catch{U&&(ee=U)}throw new Error(ee)}const he=await Q.json();g.value=Date.now(),i("update:modelValue",he.logoUrl)}catch(Q){console.error("Logo upload error:",Q),Q.name==="TypeError"&&Q.message==="Failed to fetch"?f.value="Network error. Check your connection or try a smaller file.":Q.message?.includes("401")||Q.message?.includes("403")?f.value="Not authorized. Please refresh the page and try again.":f.value=Q.message||"Failed to upload logo. Please try again."}finally{d.value=!1}}async function T(){if(f.value="",a.staged){y.value?(E(),y.value=null):a.modelValue&&(k.value=!0),l();return}d.value=!0;try{const K=await fetch(`${dl}/events/${a.eventId}/logo`,{method:"DELETE",headers:s()});if(!K.ok){const Q=await K.json().catch(()=>({}));throw new Error(Q.message||"Delete failed")}i("update:modelValue","")}catch(K){console.error("Logo delete error:",K),f.value=K.message||"Failed to remove logo. Please try again."}finally{d.value=!1}}async function N(){if(!y.value)return{success:!0,logoUrl:k.value?"":a.modelValue};d.value=!0,f.value="";try{const K=await fetch(`${dl}/events/${a.eventId}/logo`,{method:"POST",headers:{"Content-Type":y.value.type,...s()},body:y.value});if(!K.ok){const he=await K.text().catch(()=>"");let U=`Upload failed (${K.status})`;try{U=JSON.parse(he).message||U}catch{he&&(U=he)}throw new Error(U)}const Q=await K.json();return g.value=Date.now(),E(),y.value=null,k.value=!1,{success:!0,logoUrl:Q.logoUrl}}catch(K){return console.error("Logo upload error:",K),f.value=K.message||"Failed to upload logo. Please try again.",{success:!1,error:K.message}}finally{d.value=!1}}async function B(){if(!k.value)return{success:!0};d.value=!0,f.value="";try{const K=await fetch(`${dl}/events/${a.eventId}/logo`,{method:"DELETE",headers:s()});if(!K.ok){const Q=await K.json().catch(()=>({}));throw new Error(Q.message||"Delete failed")}return k.value=!1,{success:!0}}catch(K){return console.error("Logo delete error:",K),f.value=K.message||"Failed to remove logo. Please try again.",{success:!1,error:K.message}}finally{d.value=!1}}function q(){return y.value!==null||k.value}function P(){return y.value}function G(){return k.value}function X(){return _.value?_.value:k.value?"":a.modelValue||""}function ne(){E(),y.value=null,k.value=!1}return t({uploadStagedFile:N,deleteStagedLogo:B,hasPendingChanges:q,getStagedFile:P,isPendingDelete:G,getDisplayUrl:X,resetStagedState:ne}),(K,Q)=>(v(),m("div",zL,[Q[4]||(Q[4]=r("label",{class:"uploader-label"},"Event Logo",-1)),w.value?(v(),m("div",HL,[r("img",{src:S.value,alt:"Event logo",class:"logo-image"},null,8,VL),r("button",{type:"button",class:"remove-btn",onClick:T,disabled:d.value}," Remove ",8,GL)])):(v(),m("div",{key:1,class:de(["upload-area",{"drag-over":p.value,uploading:d.value}]),onDragover:Q[0]||(Q[0]=rt(he=>p.value=!0,["prevent"])),onDragleave:Q[1]||(Q[1]=rt(he=>p.value=!1,["prevent"])),onDrop:rt(R,["prevent"]),onClick:x},[r("input",{ref_key:"fileInput",ref:u,type:"file",accept:"image/png,image/jpeg,image/svg+xml,image/gif,image/webp",class:"file-input",onChange:D},null,544),d.value?(v(),m("div",jL,[...Q[2]||(Q[2]=[r("div",{class:"spinner"},null,-1),r("span",null,"Uploading...",-1)])])):(v(),m("div",ZL,[...Q[3]||(Q[3]=[r("div",{class:"upload-icon"},"+",-1),r("span",{class:"upload-text"},"Click or drag to upload logo",-1),r("span",{class:"upload-hint"},"PNG, JPEG, SVG, GIF, WebP (max 5MB)",-1)])]))],34)),f.value?(v(),m("div",qL,C(f.value),1)):M("",!0)]))}},KL=je(WL,[["__scopeId","data-v-30206af7"]]),Wv=[{name:"Default",headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},{name:"Wasp",headerGradientStart:"#333333",headerGradientEnd:"#333333",accentColor:"#FFD700",pageGradientStart:"#FFD700",pageGradientEnd:"#333333"},{name:"Ocean",headerGradientStart:"#0077be",headerGradientEnd:"#00a8e8",accentColor:"#0077be",pageGradientStart:"#0077be",pageGradientEnd:"#00a8e8"},{name:"Forest",headerGradientStart:"#228b22",headerGradientEnd:"#32cd32",accentColor:"#228b22",pageGradientStart:"#228b22",pageGradientEnd:"#32cd32"},{name:"Sunset",headerGradientStart:"#ff6b35",headerGradientEnd:"#f7931e",accentColor:"#ff6b35",pageGradientStart:"#ff6b35",pageGradientEnd:"#f7931e"},{name:"Berry",headerGradientStart:"#8e2de2",headerGradientEnd:"#4a00e0",accentColor:"#8e2de2",pageGradientStart:"#8e2de2",pageGradientEnd:"#4a00e0"},{name:"Coral",headerGradientStart:"#ff758c",headerGradientEnd:"#ff7eb3",accentColor:"#ff758c",pageGradientStart:"#ff758c",pageGradientEnd:"#ff7eb3"},{name:"Steel",headerGradientStart:"#485563",headerGradientEnd:"#29323c",accentColor:"#485563",pageGradientStart:"#485563",pageGradientEnd:"#29323c"},{name:"Mint",headerGradientStart:"#11998e",headerGradientEnd:"#38ef7d",accentColor:"#11998e",pageGradientStart:"#11998e",pageGradientEnd:"#38ef7d"},{name:"Cherry",headerGradientStart:"#eb3349",headerGradientEnd:"#f45c43",accentColor:"#eb3349",pageGradientStart:"#eb3349",pageGradientEnd:"#f45c43"},{name:"Midnight",headerGradientStart:"#232526",headerGradientEnd:"#414345",accentColor:"#5c5c5c",pageGradientStart:"#232526",pageGradientEnd:"#414345"},{name:"Lavender",headerGradientStart:"#a18cd1",headerGradientEnd:"#fbc2eb",accentColor:"#a18cd1",pageGradientStart:"#a18cd1",pageGradientEnd:"#fbc2eb"},{name:"Gold",headerGradientStart:"#f7971e",headerGradientEnd:"#ffd200",accentColor:"#f7971e",pageGradientStart:"#f7971e",pageGradientEnd:"#ffd200"}];function JL(){return{...Wv[0]}}function YL(e,t){return{...e,headerGradientStart:t.headerGradientStart,headerGradientEnd:t.headerGradientEnd,accentColor:t.accentColor,pageGradientStart:t.pageGradientStart,pageGradientEnd:t.pageGradientEnd,logoUrl:e.logoUrl||"",logoPosition:e.logoPosition||""}}function Mu(e){const t=e.replace("#",""),o=parseInt(t.slice(0,2),16)/255,a=parseInt(t.slice(2,4),16)/255,s=parseInt(t.slice(4,6),16)/255,i=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),l=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*i+.7152*l+.0722*u}function Au(e){return!e||e===""?"#ffffff":Mu(e)>.179?"#333333":"#ffffff"}function Kv(e,t){const o=e||ln.headerGradientStart,a=t||ln.headerGradientEnd,s=Mu(o),i=Mu(a);return(s+i)/2>.35?"#333333":"#ffffff"}const ln={headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},XL={class:"marshal-mockup-container"},QL={class:"presets-section"},eS={class:"presets-row"},tS=["title","onClick"],nS={class:"preset-name"},oS={class:"mockup-frame"},sS={key:0,class:"logo-cover-bg"},aS=["src"],iS=["src"],lS={class:"header-center"},rS={class:"event-name"},cS={class:"mockup-buttons"},uS=["src"],dS={class:"mockup-body"},hS={class:"mockup-card"},fS={class:"card-content"},pS={class:"editor-header"},vS={class:"editor-content"},mS={class:"color-grid-inline"},gS={class:"color-field"},yS={class:"color-swatches"},kS=["title","onClick"],_S={key:0,class:"check"},bS={class:"custom-color-wrapper"},wS={class:"hex-popup-header"},CS={class:"hex-input-row"},LS=["disabled"],SS={key:0,class:"hex-error"},xS={class:"gradient-toggle"},IS={key:0,class:"color-field"},$S={class:"color-swatches"},TS=["title","onClick"],MS={key:0,class:"check"},AS={class:"custom-color-wrapper"},ES={class:"hex-popup-header"},PS={class:"hex-input-row"},DS=["disabled"],RS={key:0,class:"hex-error"},OS={key:1,class:"logo-position-section"},BS={class:"position-buttons"},NS={class:"color-swatches"},FS=["title","onClick"],US={key:0,class:"check"},zS={class:"custom-color-wrapper"},HS={class:"hex-popup-header"},VS={class:"hex-input-row"},GS=["disabled"],jS={key:0,class:"hex-error"},ZS={class:"color-grid-inline"},qS={class:"color-field"},WS={class:"color-swatches"},KS=["title","onClick"],JS={key:0,class:"check"},YS={class:"custom-color-wrapper"},XS={class:"hex-popup-header"},QS={class:"hex-input-row"},ex=["disabled"],tx={key:0,class:"hex-error"},nx={class:"gradient-toggle"},ox={key:0,class:"color-field"},sx={class:"color-swatches"},ax=["title","onClick"],ix={key:0,class:"check"},lx={class:"custom-color-wrapper"},rx={class:"hex-popup-header"},cx={class:"hex-input-row"},ux=["disabled"],dx={key:0,class:"hex-error"},hx={class:"editor-footer"},fx={__name:"MarshalModeMockup",props:{branding:{type:Object,required:!0},eventName:{type:String,default:""},eventDate:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:branding","logo-staged-change"],setup(e,{expose:t,emit:o}){const a=An,s=e,i=o,l=$(null),u=Wv,d=$(!1),p=$(!1),f=$(null),g=$(!1),y=$(""),_=J=>{typeof J=="object"&&J!==null?(g.value=J.isPendingDelete,y.value=J.displayUrl||"",i("logo-staged-change",J.hasPendingChanges)):(f.value&&(g.value=f.value.isPendingDelete(),y.value=f.value.getDisplayUrl()||""),i("logo-staged-change",!!J))},k=$(null),w=$(""),S=$(null),E=$(null),A=$({left:"50%",right:"auto",transform:"translateX(-50%)"}),x=J=>J?!a.some(j=>j.hex.toLowerCase()===J.toLowerCase()):!1,D=J=>!J||!x(J)?"#666666":Au(J),R=J=>!J||!x(J)?"#e0e0e0":J,F=V(()=>{if(!w.value)return!1;const J=w.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(J)||/^[0-9A-Fa-f]{3}$/.test(J)}),T=(J,j)=>{if(k.value===J)k.value=null;else{k.value=J;let te="";switch(J){case"headerStart":te=s.branding.headerGradientStart;break;case"headerEnd":te=s.branding.headerGradientEnd;break;case"pageStart":te=s.branding.pageGradientStart;break;case"pageEnd":te=s.branding.pageGradientEnd;break;case"accent":te=s.branding.accentColor;break}if(te&&x(te)?w.value=te.replace(/^#/,""):w.value="",j&&E.value){const Re=j.currentTarget,Se=E.value,we=Re.getBoundingClientRect(),ge=Se.getBoundingClientRect(),Z=220,se=12,ce=we.left+we.width/2-ge.left,Te=ge.width,Oe=ce-Z/2;ce+Z/2>Te-se?A.value={left:"auto",right:"0",transform:"none"}:Oe<se?A.value={left:"0",right:"auto",transform:"none"}:A.value={left:"50%",right:"auto",transform:"translateX(-50%)"}}cn(()=>S.value?.focus())}},N=()=>{w.value=w.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},B=()=>{if(!F.value||!k.value)return;let J=w.value;J.length===3&&(J=J[0]+J[0]+J[1]+J[1]+J[2]+J[2]);const j="#"+J;switch(k.value){case"headerStart":be("start",j);break;case"headerEnd":He("headerGradientEnd",j);break;case"pageStart":Ve("start",j);break;case"pageEnd":He("pageGradientEnd",j);break;case"accent":He("accentColor",j);break}k.value=null};qe(l,J=>{if(k.value=null,w.value="",J==="header"){const j=s.branding.headerGradientStart||ln.headerGradientStart,te=s.branding.headerGradientEnd||ln.headerGradientEnd;d.value=j!==te}else if(J==="page"){const j=s.branding.pageGradientStart||ln.pageGradientStart,te=s.branding.pageGradientEnd||ln.pageGradientEnd;p.value=j!==te}});const q={header:"Header colour",logo:"Event logo",accent:"Accent colour",page:"Page background"},P=V(()=>s.branding.headerGradientStart||ln.headerGradientStart),G=V(()=>s.branding.headerGradientEnd||ln.headerGradientEnd),X=V(()=>s.branding.accentColor||ln.accentColor),ne=V(()=>s.branding.pageGradientStart||ln.pageGradientStart),K=V(()=>s.branding.pageGradientEnd||ln.pageGradientEnd),Q=V(()=>s.branding.logoPosition||"left"),he=$(Date.now());qe(()=>s.branding.logoUrl,()=>{he.value=Date.now(),g.value=!1,y.value=""});const U=V(()=>g.value?!1:!!(y.value||s.branding.logoUrl)),ee=V(()=>{if(g.value)return"";if(y.value){if(y.value.startsWith("blob:"))return y.value;const j=y.value.includes("?")?"&":"?";return`${y.value}${j}_t=${he.value}`}if(!s.branding.logoUrl)return"";const J=s.branding.logoUrl.includes("?")?"&":"?";return`${s.branding.logoUrl}${J}_t=${he.value}`}),fe=V(()=>({background:`linear-gradient(135deg, ${P.value} 0%, ${G.value} 100%)`})),ue=V(()=>Kv(P.value,G.value)),De=V(()=>({background:X.value,color:Au(X.value)})),et=V(()=>({background:`linear-gradient(135deg, ${ne.value} 0%, ${K.value} 100%)`}));function Je(J){l.value=l.value===J?null:J}function Ze(J){!U.value&&J&&He("logoPosition",J),Je("logo")}function He(J,j){i("update:branding",{...s.branding,[J]:j})}function be(J,j){d.value?He("headerGradientStart",j):i("update:branding",{...s.branding,headerGradientStart:j,headerGradientEnd:j})}function Ve(J,j){p.value?He("pageGradientStart",j):i("update:branding",{...s.branding,pageGradientStart:j,pageGradientEnd:j})}function ve(){if(!d.value){const J=s.branding.headerGradientStart||ln.headerGradientStart;He("headerGradientEnd",J)}}function Le(){if(!p.value){const J=s.branding.pageGradientStart||ln.pageGradientStart;He("pageGradientEnd",J)}}function Pe(J){i("update:branding",YL(s.branding,J)),l.value=null}async function W(){return f.value?await f.value.uploadStagedFile():{success:!0,logoUrl:s.branding.logoUrl}}async function Y(){return f.value?await f.value.deleteStagedLogo():{success:!0}}function pe(){return f.value?.hasPendingChanges()||!1}function Ce(){return f.value?.isPendingDelete()||!1}function le(){f.value&&f.value.resetStagedState(),g.value=!1,y.value=""}return t({uploadStagedLogo:W,deleteStagedLogo:Y,hasLogoChanges:pe,isLogoPendingDelete:Ce,resetLogo:le}),(J,j)=>(v(),m("div",XL,[r("div",QL,[j[32]||(j[32]=r("span",{class:"presets-label"},"Quick themes:",-1)),r("div",eS,[(v(!0),m(xe,null,Ne(O(u),te=>(v(),m("button",{key:te.name,type:"button",class:"preset-btn",title:te.name,onClick:Re=>Pe(te)},[r("span",{class:"preset-preview",style:Qe({background:`linear-gradient(135deg, ${te.pageGradientStart} 0%, ${te.pageGradientEnd} 100%)`})},null,4),r("span",nS,C(te.name),1)],8,tS))),128))])]),r("div",oS,[r("div",{class:de(["mockup-page",{"region-active":l.value==="page"}]),style:Qe(et.value),onClick:j[7]||(j[7]=te=>Je("page"))},[r("div",{class:de(["mockup-header",[{"region-active":l.value==="header"},U.value?`logo-${Q.value}`:"logo-none"]]),style:Qe(fe.value),onClick:j[5]||(j[5]=rt(te=>Je("header"),["stop"]))},[U.value&&Q.value==="cover"?(v(),m("div",sS,[r("img",{src:ee.value,alt:"Logo",class:"logo-cover-img"},null,8,aS)])):M("",!0),U.value&&Q.value==="cover"?(v(),m("button",{key:1,type:"button",class:de(["logo-cover-edit-btn",{"region-active":l.value==="logo"}]),onClick:j[0]||(j[0]=rt(te=>Je("logo"),["stop"])),title:"Edit logo"},[...j[33]||(j[33]=[r("span",null,"",-1)])],2)):M("",!0),U.value&&Q.value==="left"?(v(),m("div",{key:2,class:de(["mockup-logo logo-left",{"region-active":l.value==="logo"}]),onClick:j[1]||(j[1]=rt(te=>Je("logo"),["stop"]))},[r("img",{src:ee.value,alt:"Logo",class:"logo-img"},null,8,iS)],2)):M("",!0),U.value?M("",!0):(v(),m("div",{key:3,class:de(["logo-add-area logo-add-left",{"region-active":l.value==="logo"}]),onClick:j[2]||(j[2]=rt(te=>Ze("left"),["stop"]))},[...j[34]||(j[34]=[r("span",{class:"logo-add-text"},"+ Logo",-1)])],2)),r("div",lS,[r("div",{class:"mockup-title",style:Qe({color:ue.value})},[r("span",rS,C(e.eventName||"Event Name"),1)],4),r("div",{class:"mockup-date",style:Qe({color:ue.value})},C(e.eventDate||"Event Date"),5),r("div",cS,[j[35]||(j[35]=r("span",{class:"btn-emergency"},"Emergency",-1)),r("span",{class:"btn-logout",style:Qe({color:ue.value})},"Logout",4)])]),U.value&&Q.value==="right"?(v(),m("div",{key:4,class:de(["mockup-logo logo-right",{"region-active":l.value==="logo"}]),onClick:j[3]||(j[3]=rt(te=>Je("logo"),["stop"]))},[r("img",{src:ee.value,alt:"Logo",class:"logo-img"},null,8,uS)],2)):M("",!0),U.value?M("",!0):(v(),m("div",{key:5,class:de(["logo-add-area logo-add-right",{"region-active":l.value==="logo"}]),onClick:j[4]||(j[4]=rt(te=>Ze("right"),["stop"]))},[...j[36]||(j[36]=[r("span",{class:"logo-add-text"},"+ Logo",-1)])],2))],6),r("div",dS,[r("div",hS,[j[37]||(j[37]=r("div",{class:"card-header"},"Your checkpoints (2)",-1)),r("div",fS,[r("div",{class:de(["mockup-checkin-btn",{"region-active":l.value==="accent"}]),style:Qe(De.value),onClick:j[6]||(j[6]=rt(te=>Je("accent"),["stop"]))}," GPS Check-In ",6)])])])],6)]),Ue(r("div",{class:"editor-overlay",onClick:j[31]||(j[31]=rt(te=>l.value=null,["self"]))},[r("div",{ref_key:"editorModalRef",ref:E,class:"editor-modal"},[r("div",pS,[r("span",null,C(q[l.value]),1),r("button",{type:"button",class:"editor-close",onClick:j[8]||(j[8]=te=>l.value=null)},"")]),r("div",vS,[l.value==="header"?(v(),m(xe,{key:0},[j[46]||(j[46]=r("p",{class:"editor-description"},"Choose the colour for the header.",-1)),r("div",mS,[r("div",gS,[r("label",null,C(d.value?"Start colour":"Colour"),1),r("div",yS,[(v(!0),m(xe,null,Ne(O(a),te=>(v(),m("button",{key:"hs-"+te.hex,type:"button",class:de(["color-swatch-btn",{selected:e.branding.headerGradientStart===te.hex}]),style:Qe({backgroundColor:te.hex}),title:te.name,onClick:Re=>be("start",te.hex)},[e.branding.headerGradientStart===te.hex?(v(),m("span",_S,"")):M("",!0)],14,kS))),128)),r("div",bS,[r("button",{type:"button",class:de(["color-swatch-btn custom-color-btn",{selected:x(e.branding.headerGradientStart)}]),style:Qe({backgroundColor:R(e.branding.headerGradientStart)}),title:"Custom colour",onClick:j[9]||(j[9]=te=>T("headerStart",te))},[(v(),m("svg",{class:"custom-icon",style:Qe({color:D(e.branding.headerGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...j[38]||(j[38]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),k.value==="headerStart"?(v(),m("div",{key:0,class:"custom-hex-popup",style:Qe(A.value)},[r("div",wS,[j[39]||(j[39]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:j[10]||(j[10]=te=>k.value=null)},"")]),r("div",CS,[j[40]||(j[40]=r("span",{class:"hex-prefix"},"#",-1)),Ue(r("input",{ref_key:"hexInputRef",ref:S,"onUpdate:modelValue":j[11]||(j[11]=te=>w.value=te),type:"text",maxlength:"6",placeholder:"000000",class:de(["hex-input",{invalid:w.value&&!F.value}]),onInput:N,onKeydown:ps(B,["enter"])},null,34),[[st,w.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:F.value?"#"+w.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!F.value,onClick:B}," Apply ",8,LS)]),w.value&&!F.value?(v(),m("span",SS,"Invalid hex code")):M("",!0)],4)):M("",!0)])]),r("label",xS,[Ue(r("input",{type:"checkbox","onUpdate:modelValue":j[12]||(j[12]=te=>d.value=te),onChange:ve},null,544),[[xa,d.value]]),j[41]||(j[41]=r("span",null,"Use gradient",-1))])]),d.value?(v(),m("div",IS,[j[45]||(j[45]=r("label",null,"End colour",-1)),r("div",$S,[(v(!0),m(xe,null,Ne(O(a),te=>(v(),m("button",{key:"he-"+te.hex,type:"button",class:de(["color-swatch-btn",{selected:e.branding.headerGradientEnd===te.hex}]),style:Qe({backgroundColor:te.hex}),title:te.name,onClick:Re=>He("headerGradientEnd",te.hex)},[e.branding.headerGradientEnd===te.hex?(v(),m("span",MS,"")):M("",!0)],14,TS))),128)),r("div",AS,[r("button",{type:"button",class:de(["color-swatch-btn custom-color-btn",{selected:x(e.branding.headerGradientEnd)}]),style:Qe({backgroundColor:R(e.branding.headerGradientEnd)}),title:"Custom colour",onClick:j[13]||(j[13]=te=>T("headerEnd",te))},[(v(),m("svg",{class:"custom-icon",style:Qe({color:D(e.branding.headerGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...j[42]||(j[42]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),k.value==="headerEnd"?(v(),m("div",{key:0,class:"custom-hex-popup",style:Qe(A.value)},[r("div",ES,[j[43]||(j[43]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:j[14]||(j[14]=te=>k.value=null)},"")]),r("div",PS,[j[44]||(j[44]=r("span",{class:"hex-prefix"},"#",-1)),Ue(r("input",{ref_key:"hexInputRef",ref:S,"onUpdate:modelValue":j[15]||(j[15]=te=>w.value=te),type:"text",maxlength:"6",placeholder:"000000",class:de(["hex-input",{invalid:w.value&&!F.value}]),onInput:N,onKeydown:ps(B,["enter"])},null,34),[[st,w.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:F.value?"#"+w.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!F.value,onClick:B}," Apply ",8,DS)]),w.value&&!F.value?(v(),m("span",RS,"Invalid hex code")):M("",!0)],4)):M("",!0)])])])):M("",!0)])],64)):M("",!0),l.value==="logo"?(v(),m("div",OS,[j[47]||(j[47]=r("label",{class:"editor-label"},"Position",-1)),r("div",BS,[r("button",{type:"button",class:de(["position-btn",{selected:Q.value==="left"}]),onClick:j[16]||(j[16]=te=>He("logoPosition","left"))}," Left ",2),r("button",{type:"button",class:de(["position-btn",{selected:Q.value==="cover"}]),onClick:j[17]||(j[17]=te=>He("logoPosition","cover"))}," Cover ",2),r("button",{type:"button",class:de(["position-btn",{selected:Q.value==="right"}]),onClick:j[18]||(j[18]=te=>He("logoPosition","right"))}," Right ",2)])])):M("",!0),Ue(Ae(KL,{ref_key:"logoUploaderRef",ref:f,"model-value":e.branding.logoUrl,"event-id":e.eventId,"admin-email":e.adminEmail,staged:"","onUpdate:modelValue":j[19]||(j[19]=te=>He("logoUrl",te)),onStagedChange:_},null,8,["model-value","event-id","admin-email"]),[[ys,l.value==="logo"]]),l.value==="accent"?(v(),m(xe,{key:2},[j[51]||(j[51]=r("p",{class:"editor-description"},"Choose the accent colour for buttons.",-1)),r("div",NS,[(v(!0),m(xe,null,Ne(O(a),te=>(v(),m("button",{key:"ac-"+te.hex,type:"button",class:de(["color-swatch-btn",{selected:e.branding.accentColor===te.hex}]),style:Qe({backgroundColor:te.hex}),title:te.name,onClick:Re=>He("accentColor",te.hex)},[e.branding.accentColor===te.hex?(v(),m("span",US,"")):M("",!0)],14,FS))),128)),r("div",zS,[r("button",{type:"button",class:de(["color-swatch-btn custom-color-btn",{selected:x(e.branding.accentColor)}]),style:Qe({backgroundColor:R(e.branding.accentColor)}),title:"Custom colour",onClick:j[20]||(j[20]=te=>T("accent",te))},[(v(),m("svg",{class:"custom-icon",style:Qe({color:D(e.branding.accentColor)}),viewBox:"0 0 24 24",fill:"currentColor"},[...j[48]||(j[48]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),k.value==="accent"?(v(),m("div",{key:0,class:"custom-hex-popup",style:Qe(A.value)},[r("div",HS,[j[49]||(j[49]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:j[21]||(j[21]=te=>k.value=null)},"")]),r("div",VS,[j[50]||(j[50]=r("span",{class:"hex-prefix"},"#",-1)),Ue(r("input",{ref_key:"hexInputRef",ref:S,"onUpdate:modelValue":j[22]||(j[22]=te=>w.value=te),type:"text",maxlength:"6",placeholder:"000000",class:de(["hex-input",{invalid:w.value&&!F.value}]),onInput:N,onKeydown:ps(B,["enter"])},null,34),[[st,w.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:F.value?"#"+w.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!F.value,onClick:B}," Apply ",8,GS)]),w.value&&!F.value?(v(),m("span",jS,"Invalid hex code")):M("",!0)],4)):M("",!0)])])],64)):M("",!0),l.value==="page"?(v(),m(xe,{key:3},[j[60]||(j[60]=r("p",{class:"editor-description"},"Choose the colour for the page background.",-1)),r("div",ZS,[r("div",qS,[r("label",null,C(p.value?"Start colour":"Colour"),1),r("div",WS,[(v(!0),m(xe,null,Ne(O(a),te=>(v(),m("button",{key:"ps-"+te.hex,type:"button",class:de(["color-swatch-btn",{selected:e.branding.pageGradientStart===te.hex}]),style:Qe({backgroundColor:te.hex}),title:te.name,onClick:Re=>Ve("start",te.hex)},[e.branding.pageGradientStart===te.hex?(v(),m("span",JS,"")):M("",!0)],14,KS))),128)),r("div",YS,[r("button",{type:"button",class:de(["color-swatch-btn custom-color-btn",{selected:x(e.branding.pageGradientStart)}]),style:Qe({backgroundColor:R(e.branding.pageGradientStart)}),title:"Custom colour",onClick:j[23]||(j[23]=te=>T("pageStart",te))},[(v(),m("svg",{class:"custom-icon",style:Qe({color:D(e.branding.pageGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...j[52]||(j[52]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),k.value==="pageStart"?(v(),m("div",{key:0,class:"custom-hex-popup",style:Qe(A.value)},[r("div",XS,[j[53]||(j[53]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:j[24]||(j[24]=te=>k.value=null)},"")]),r("div",QS,[j[54]||(j[54]=r("span",{class:"hex-prefix"},"#",-1)),Ue(r("input",{ref_key:"hexInputRef",ref:S,"onUpdate:modelValue":j[25]||(j[25]=te=>w.value=te),type:"text",maxlength:"6",placeholder:"000000",class:de(["hex-input",{invalid:w.value&&!F.value}]),onInput:N,onKeydown:ps(B,["enter"])},null,34),[[st,w.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:F.value?"#"+w.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!F.value,onClick:B}," Apply ",8,ex)]),w.value&&!F.value?(v(),m("span",tx,"Invalid hex code")):M("",!0)],4)):M("",!0)])]),r("label",nx,[Ue(r("input",{type:"checkbox","onUpdate:modelValue":j[26]||(j[26]=te=>p.value=te),onChange:Le},null,544),[[xa,p.value]]),j[55]||(j[55]=r("span",null,"Use gradient",-1))])]),p.value?(v(),m("div",ox,[j[59]||(j[59]=r("label",null,"End colour",-1)),r("div",sx,[(v(!0),m(xe,null,Ne(O(a),te=>(v(),m("button",{key:"pe-"+te.hex,type:"button",class:de(["color-swatch-btn",{selected:e.branding.pageGradientEnd===te.hex}]),style:Qe({backgroundColor:te.hex}),title:te.name,onClick:Re=>He("pageGradientEnd",te.hex)},[e.branding.pageGradientEnd===te.hex?(v(),m("span",ix,"")):M("",!0)],14,ax))),128)),r("div",lx,[r("button",{type:"button",class:de(["color-swatch-btn custom-color-btn",{selected:x(e.branding.pageGradientEnd)}]),style:Qe({backgroundColor:R(e.branding.pageGradientEnd)}),title:"Custom colour",onClick:j[27]||(j[27]=te=>T("pageEnd",te))},[(v(),m("svg",{class:"custom-icon",style:Qe({color:D(e.branding.pageGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...j[56]||(j[56]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),k.value==="pageEnd"?(v(),m("div",{key:0,class:"custom-hex-popup",style:Qe(A.value)},[r("div",rx,[j[57]||(j[57]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:j[28]||(j[28]=te=>k.value=null)},"")]),r("div",cx,[j[58]||(j[58]=r("span",{class:"hex-prefix"},"#",-1)),Ue(r("input",{ref_key:"hexInputRef",ref:S,"onUpdate:modelValue":j[29]||(j[29]=te=>w.value=te),type:"text",maxlength:"6",placeholder:"000000",class:de(["hex-input",{invalid:w.value&&!F.value}]),onInput:N,onKeydown:ps(B,["enter"])},null,34),[[st,w.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:F.value?"#"+w.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!F.value,onClick:B}," Apply ",8,ux)]),w.value&&!F.value?(v(),m("span",dx,"Invalid hex code")):M("",!0)],4)):M("",!0)])])])):M("",!0)])],64)):M("",!0)]),r("div",hx,[r("button",{type:"button",class:"btn-done",onClick:j[30]||(j[30]=te=>l.value=null)},"Done")])],512)],512),[[ys,l.value]]),j[61]||(j[61]=r("p",{class:"instructions"}," Click on different parts of the preview to customise them. The emergency button stays red for safety. ",-1))]))}},px=je(fx,[["__scopeId","data-v-6062cadb"]]),vx={class:"settings-tab"},mx={class:"accordion"},gx={class:"accordion-section"},yx={class:"accordion-title"},kx={class:"accordion-icon"},_x={key:0,class:"accordion-content"},bx={class:"accordion-section"},wx={class:"accordion-icon"},Cx={key:0,class:"accordion-content"},Lx={class:"terminology-grid"},Sx={class:"term-group"},xx=["value"],Ix={class:"term-group"},$x=["value"],Tx={class:"term-group"},Mx=["value"],Ax={class:"term-group"},Ex=["value"],Px={class:"term-group"},Dx=["value"],Rx={class:"form-actions"},Ox=["disabled"],Bx={class:"accordion-section"},Nx={class:"accordion-title"},Fx={class:"accordion-icon"},Ux={key:0,class:"accordion-content"},zx={class:"section-description"},Hx={class:"form-actions"},Vx=["disabled"],Gx={class:"accordion-section"},jx={class:"accordion-title"},Zx={class:"accordion-icon"},qx={key:0,class:"accordion-content"},Wx={class:"section-description"},Kx={class:"form-actions"},Jx=["disabled"],Yx=["disabled"],af="admin_settings_accordion",Xx={__name:"SettingsTab",props:{eventData:{type:Object,required:!0},admins:{type:Array,default:()=>[]},formDirty:{type:Boolean,default:!1},eventId:{type:String,default:""}},emits:["submit","add-admin","remove-admin","update:formDirty"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=Zl(),i=V(()=>s.adminEmail||""),l=e,u=t,d=$({...l.eventData}),p=$(null),f=$(!1),g=()=>l.eventId?`${af}_${l.eventId}`:af,y=$(null);nn(()=>{const T=localStorage.getItem(g());T&&(y.value=T)});const _=V(()=>{const T=d.value.peopleTerm||"Marshals";return Os.checkpoint.map(N=>({value:N,label:Su(N,T)}))}),k=T=>{const N=y.value===T?null:T;y.value=N,N?localStorage.setItem(g(),N):localStorage.removeItem(g())};qe(()=>l.eventData,T=>{d.value={...T},A.value=!1},{deep:!0});const w=()=>{u("update:formDirty",!0)},S=(T,N)=>{d.value[T]=N,w()},E=V(()=>({headerGradientStart:d.value.brandingHeaderGradientStart||"",headerGradientEnd:d.value.brandingHeaderGradientEnd||"",logoUrl:d.value.brandingLogoUrl||"",logoPosition:d.value.brandingLogoPosition||"",accentColor:d.value.brandingAccentColor||"",pageGradientStart:d.value.brandingPageGradientStart||"",pageGradientEnd:d.value.brandingPageGradientEnd||""})),A=$(!1),x=T=>{A.value=T},D=T=>{d.value.brandingHeaderGradientStart=T.headerGradientStart,d.value.brandingHeaderGradientEnd=T.headerGradientEnd,d.value.brandingLogoUrl=T.logoUrl,d.value.brandingLogoPosition=T.logoPosition,d.value.brandingAccentColor=T.accentColor,d.value.brandingPageGradientStart=T.pageGradientStart,d.value.brandingPageGradientEnd=T.pageGradientEnd,w()},R=()=>{JL(),d.value.brandingHeaderGradientStart="",d.value.brandingHeaderGradientEnd="",d.value.brandingLogoUrl="",d.value.brandingLogoPosition="",d.value.brandingAccentColor="",d.value.brandingPageGradientStart="",d.value.brandingPageGradientEnd="",A.value=!1,p.value?.resetLogo(),w()},F=async()=>{if(!f.value){f.value=!0;try{if(A.value&&p.value){if(p.value.isLogoPendingDelete()){const N=await p.value.deleteStagedLogo();if(!N.success){console.error("Failed to delete logo:",N.error);return}d.value.brandingLogoUrl=""}else{const N=await p.value.uploadStagedLogo();if(!N.success){console.error("Failed to upload logo:",N.error);return}N.logoUrl&&!N.logoUrl.startsWith("blob:")&&(d.value.brandingLogoUrl=N.logoUrl)}A.value=!1}u("submit",{...d.value})}finally{f.value=!1}}};return(T,N)=>(v(),m("div",vx,[r("div",mx,[r("div",gx,[r("button",{class:de(["accordion-header",{active:y.value==="admins"}]),onClick:N[0]||(N[0]=B=>k("admins"))},[r("span",yx,"Administrators ("+C(e.admins.length)+")",1),r("span",kx,C(y.value==="admins"?"-":"+"),1)],2),y.value==="admins"?(v(),m("div",_x,[Ae(n2,{admins:e.admins,onAddAdmin:N[1]||(N[1]=B=>T.$emit("add-admin")),onRemoveAdmin:N[2]||(N[2]=B=>T.$emit("remove-admin",B))},null,8,["admins"])])):M("",!0)]),r("div",bx,[r("button",{class:de(["accordion-header",{active:y.value==="terminology"}]),onClick:N[3]||(N[3]=B=>k("terminology"))},[N[19]||(N[19]=r("span",{class:"accordion-title"},"Terminology",-1)),r("span",wx,C(y.value==="terminology"?"-":"+"),1)],2),y.value==="terminology"?(v(),m("div",Cx,[N[20]||(N[20]=r("p",{class:"section-description"}," Customise how things are named throughout the application. ",-1)),r("div",Lx,[r("div",Sx,[r("label",null,C(O(o).people)+" are called",1),Ue(r("select",{"onUpdate:modelValue":N[4]||(N[4]=B=>d.value.peopleTerm=B),class:"form-input",onChange:w},[(v(!0),m(xe,null,Ne(O(Os).people,B=>(v(),m("option",{key:B,value:B},C(B),9,xx))),128))],544),[[Bn,d.value.peopleTerm]])]),r("div",Ix,[r("label",null,C(O(o).checkpoints)+" are called",1),Ue(r("select",{"onUpdate:modelValue":N[5]||(N[5]=B=>d.value.checkpointTerm=B),class:"form-input",onChange:w},[(v(!0),m(xe,null,Ne(_.value,B=>(v(),m("option",{key:B.value,value:B.value},C(B.label),9,$x))),128))],544),[[Bn,d.value.checkpointTerm]])]),r("div",Tx,[r("label",null,C(O(o).areas)+" are called",1),Ue(r("select",{"onUpdate:modelValue":N[6]||(N[6]=B=>d.value.areaTerm=B),class:"form-input",onChange:w},[(v(!0),m(xe,null,Ne(O(Os).area,B=>(v(),m("option",{key:B,value:B},C(B),9,Mx))),128))],544),[[Bn,d.value.areaTerm]])]),r("div",Ax,[r("label",null,C(O(o).checklists)+" are called",1),Ue(r("select",{"onUpdate:modelValue":N[7]||(N[7]=B=>d.value.checklistTerm=B),class:"form-input",onChange:w},[(v(!0),m(xe,null,Ne(O(Os).checklist,B=>(v(),m("option",{key:B,value:B},C(B),9,Ex))),128))],544),[[Bn,d.value.checklistTerm]])]),r("div",Px,[r("label",null,C(O(o).course)+" is called",1),Ue(r("select",{"onUpdate:modelValue":N[8]||(N[8]=B=>d.value.courseTerm=B),class:"form-input",onChange:w},[(v(!0),m(xe,null,Ne(O(Os).course,B=>(v(),m("option",{key:B,value:B},C(B),9,Dx))),128))],544),[[Bn,d.value.courseTerm]])])]),r("div",Rx,[r("button",{onClick:F,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,Ox)])])):M("",!0)]),r("div",Bx,[r("button",{class:de(["accordion-header",{active:y.value==="appearance"}]),onClick:N[9]||(N[9]=B=>k("appearance"))},[r("span",Nx,C(O(o).checkpoint)+" appearance",1),r("span",Fx,C(y.value==="appearance"?"-":"+"),1)],2),y.value==="appearance"?(v(),m("div",Ux,[r("p",zx," Set the default marker style for all "+C(O(a).checkpoints)+" in this event. Individual "+C(O(a).areas)+" and "+C(O(a).checkpoints)+" can override this setting. ",1),Ae(ad,{"style-type":d.value.defaultCheckpointStyleType||"default","style-color":d.value.defaultCheckpointStyleColor||"","style-background-shape":d.value.defaultCheckpointStyleBackgroundShape||"","style-background-color":d.value.defaultCheckpointStyleBackgroundColor||"","style-border-color":d.value.defaultCheckpointStyleBorderColor||"","style-icon-color":d.value.defaultCheckpointStyleIconColor||"","style-size":d.value.defaultCheckpointStyleSize||"","style-map-rotation":d.value.defaultCheckpointStyleMapRotation??"","icon-label":"Default marker style",level:"event","show-preview":!0,"onUpdate:styleType":N[10]||(N[10]=B=>S("defaultCheckpointStyleType",B)),"onUpdate:styleColor":N[11]||(N[11]=B=>S("defaultCheckpointStyleColor",B)),"onUpdate:styleBackgroundShape":N[12]||(N[12]=B=>S("defaultCheckpointStyleBackgroundShape",B)),"onUpdate:styleBackgroundColor":N[13]||(N[13]=B=>S("defaultCheckpointStyleBackgroundColor",B)),"onUpdate:styleBorderColor":N[14]||(N[14]=B=>S("defaultCheckpointStyleBorderColor",B)),"onUpdate:styleIconColor":N[15]||(N[15]=B=>S("defaultCheckpointStyleIconColor",B)),"onUpdate:styleSize":N[16]||(N[16]=B=>S("defaultCheckpointStyleSize",B)),"onUpdate:styleMapRotation":N[17]||(N[17]=B=>S("defaultCheckpointStyleMapRotation",B))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation"]),r("div",Hx,[r("button",{onClick:F,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,Vx)])])):M("",!0)]),r("div",Gx,[r("button",{class:de(["accordion-header",{active:y.value==="branding"}]),onClick:N[18]||(N[18]=B=>k("branding"))},[r("span",jx,C(O(o).person)+" branding",1),r("span",Zx,C(y.value==="branding"?"-":"+"),1)],2),y.value==="branding"?(v(),m("div",qx,[r("p",Wx," Customise the appearance of the "+C(O(a).person)+" view to match your organisation's branding. ",1),Ae(px,{ref_key:"brandingMockupRef",ref:p,branding:E.value,"event-name":d.value.name,"event-date":O(Vv)(d.value.eventDate),"event-id":e.eventId,"admin-email":i.value,"onUpdate:branding":D,onLogoStagedChange:x},null,8,["branding","event-name","event-date","event-id","admin-email"]),r("div",Kx,[r("button",{onClick:R,class:"btn btn-secondary",disabled:f.value}," Reset to default ",8,Jx),r("button",{onClick:F,class:"btn btn-primary",disabled:!e.formDirty&&!A.value||f.value},C(f.value?"Saving...":"Save"),9,Yx)])])):M("",!0)])])]))}},Qx=je(Xx,[["__scopeId","data-v-bb7e241a"]]),eI={class:"incident-header"},tI={class:"incident-title-row"},nI={class:"incident-title"},oI={class:"incident-badges"},sI={key:0,class:"incident-description"},aI={class:"incident-context"},iI={key:0,class:"context-item"},lI={key:1,class:"context-item"},rI={key:2,class:"context-item"},cI={class:"incident-footer"},uI={class:"reporter-info"},dI={class:"time-info"},hI={__name:"IncidentCard",props:{incident:{type:Object,required:!0}},emits:["select"],setup(e){const t=e,o=V(()=>{if(t.incident.title)return t.incident.title;const u=t.incident.description||"";return u.length<=60?u:u.substring(0,57).trim()+"..."}),a=u=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[u]||u,s=u=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[u]||u,i=(u,d=120)=>!u||u.length<=d?u:u.substring(0,d).trim()+"...",l=u=>{if(!u)return"";const d=new Date(u),f=new Date-d,g=Math.floor(f/6e4),y=Math.floor(f/36e5),_=Math.floor(f/864e5);return g<1?"just now":g<60?`${g}m ago`:y<24?`${y}h ago`:_<7?`${_}d ago`:d.toLocaleDateString()};return(u,d)=>(v(),m("div",{class:de(["incident-card",[`severity-${e.incident.severity}`,`status-${e.incident.status}`]]),onClick:d[0]||(d[0]=p=>u.$emit("select",e.incident))},[r("div",eI,[r("div",tI,[r("span",{class:de(["severity-indicator",e.incident.severity])},null,2),r("strong",nI,C(o.value),1)]),r("div",oI,[r("span",{class:de(["severity-badge",e.incident.severity])},C(a(e.incident.severity)),3),r("span",{class:de(["status-badge",e.incident.status])},C(s(e.incident.status)),3)])]),e.incident.title&&e.incident.description?(v(),m("div",sI,C(i(e.incident.description)),1)):M("",!0),r("div",aI,[e.incident.context?.checkpoint?(v(),m("div",iI,[d[1]||(d[1]=r("span",{class:"context-icon"},"",-1)),r("span",null,C(e.incident.context.checkpoint.name),1)])):e.incident.latitude&&e.incident.longitude?(v(),m("div",lI,[...d[2]||(d[2]=[r("span",{class:"context-icon"},"",-1),r("span",null,"GPS Location",-1)])])):M("",!0),e.incident.area?(v(),m("div",rI,[d[3]||(d[3]=r("span",{class:"context-icon"},"",-1)),r("span",null,C(e.incident.area.areaName),1)])):M("",!0)]),r("div",cI,[r("span",uI," Reported by "+C(e.incident.reportedBy?.name||"Unknown"),1),r("span",dI,C(l(e.incident.incidentTime||e.incident.createdAt)),1)])],2))}},Wl=je(hI,[["__scopeId","data-v-690fd385"]]),fI={class:"incidents-tab"},pI={class:"tab-header"},vI={class:"button-group"},mI={key:0,class:"status-pills"},gI={class:"filters-section"},yI={class:"search-group"},kI={class:"incidents-list"},_I={key:0,class:"loading-state"},bI={key:1,class:"empty-state"},wI={__name:"IncidentsTab",props:{incidents:{type:Array,required:!0},areas:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["select-incident","report-incident"],setup(e,{emit:t}){const o=e,a=$(""),s=$("all"),i=y=>{s.value=y},l=V(()=>o.incidents.filter(y=>y.status==="open").length),u=V(()=>o.incidents.filter(y=>y.status==="in_progress"||y.status==="acknowledged").length),d=V(()=>o.incidents.filter(y=>y.status==="resolved").length),p=V(()=>o.incidents.filter(y=>y.status==="closed").length),f=V(()=>{let y=o.incidents;if(s.value==="open"?y=y.filter(_=>_.status==="open"):s.value==="in-progress"?y=y.filter(_=>_.status==="in_progress"||_.status==="acknowledged"):s.value==="resolved"?y=y.filter(_=>_.status==="resolved"):s.value==="closed"&&(y=y.filter(_=>_.status==="closed")),a.value.trim()){const _=a.value.toLowerCase().trim().split(/\s+/);y=y.filter(k=>{const w=`${k.context?.checkpoint?.name||""} ${k.context?.checkpoint?.description||""}`,S=k.area?.areaName||"",E=[k.reportedBy?.name||"",...(k.context?.peopleAtCheckpoint||[]).map(D=>D.name||"")].join(" "),A=(k.updates||[]).map(D=>D.note||"").join(" "),x=`${k.title||""} ${k.description||""} ${w} ${S} ${E} ${A}`.toLowerCase();return _.every(D=>x.includes(D))})}return y}),g=V(()=>[...f.value].sort((y,_)=>new Date(_.incidentTime||_.createdAt)-new Date(y.incidentTime||y.createdAt)));return(y,_)=>(v(),m("div",fI,[r("div",pI,[r("div",vI,[r("button",{onClick:_[0]||(_[0]=k=>y.$emit("report-incident")),class:"btn btn-primary"}," Report incident ")]),e.incidents.length>0?(v(),m("div",mI,[Ae(Ln,{variant:"neutral",active:s.value==="all",onClick:_[1]||(_[1]=k=>i("all"))},{default:ze(()=>[Ye(C(e.incidents.length)+" total ",1)]),_:1},8,["active"]),l.value>0?(v(),We(Ln,{key:0,variant:"info",active:s.value==="open",onClick:_[2]||(_[2]=k=>i("open"))},{default:ze(()=>[Ye(C(l.value)+" open ",1)]),_:1},8,["active"])):M("",!0),u.value>0?(v(),We(Ln,{key:1,variant:"purple",active:s.value==="in-progress",onClick:_[3]||(_[3]=k=>i("in-progress"))},{default:ze(()=>[Ye(C(u.value)+" in progress ",1)]),_:1},8,["active"])):M("",!0),d.value>0?(v(),We(Ln,{key:2,variant:"success",active:s.value==="resolved",onClick:_[4]||(_[4]=k=>i("resolved"))},{default:ze(()=>[Ye(C(d.value)+" resolved ",1)]),_:1},8,["active"])):M("",!0),p.value>0?(v(),We(Ln,{key:3,variant:"neutral",active:s.value==="closed",onClick:_[5]||(_[5]=k=>i("closed"))},{default:ze(()=>[Ye(C(p.value)+" closed ",1)]),_:1},8,["active"])):M("",!0)])):M("",!0)]),r("div",gI,[r("div",yI,[Ue(r("input",{"onUpdate:modelValue":_[6]||(_[6]=k=>a.value=k),type:"text",class:"search-input",placeholder:"Search by title, description, location, area, or person..."},null,512),[[st,a.value]])])]),r("div",kI,[e.loading?(v(),m("div",_I," Loading incidents... ")):f.value.length===0?(v(),m("div",bI,[r("p",null,C(a.value||s.value!=="all"?"No incidents match your search or filter.":"No incidents reported yet."),1)])):M("",!0),(v(!0),m(xe,null,Ne(g.value,k=>(v(),We(Wl,{key:k.incidentId,incident:k,onSelect:w=>y.$emit("select-incident",k)},null,8,["incident","onSelect"]))),128))])]))}},CI=je(wI,[["__scopeId","data-v-56bde653"]]),LI={class:"checkpoint-card-header"},SI={class:"checkpoint-name-row"},xI=["innerHTML"],II={class:"checkpoint-name"},$I={key:0,class:"checkpoint-description"},TI={key:0,class:"checkpoint-card-areas"},MI={class:"checkpoint-card-stats"},AI={key:1,class:"checkpoint-card-marshals"},EI={__name:"CheckpointCard",props:{checkpoint:{type:Object,required:!0},areas:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const o=e,a=t,s=V(()=>o.checkpoint.areaIds||o.checkpoint.AreaIds||[]),i=S=>{const E=o.areas.find(A=>A.id===S);return E?E.name:null},l=S=>{const E=o.areas.find(A=>A.id===S);return E?E.color:"#999"},u=V(()=>{const S=o.checkpoint,E=S.resolvedStyleBackgroundColor||S.ResolvedStyleBackgroundColor||S.resolvedStyleColor||S.ResolvedStyleColor;return E||(s.value.length>0?l(s.value[0]):"#667eea")}),d=V(()=>{const S=o.checkpoint;return S.requiredMarshals===0?null:S.checkedInCount>=S.requiredMarshals?"full":S.checkedInCount>0?"partial":"none"}),p=V(()=>[...o.checkpoint.assignments||[]].sort((E,A)=>(E.marshalName||"").localeCompare(A.marshalName||"",void 0,{sensitivity:"base"}))),f=V(()=>(o.checkpoint.assignments||[]).length),g=V(()=>(o.checkpoint.assignments||[]).filter(S=>S.isCheckedIn).length),y=V(()=>d.value?`staffing-${d.value}`:""),_=V(()=>{const S=f.value,E=g.value;return S===0?"":E===0?"checkin-none":E>=S?"checkin-full":"checkin-partial"}),k=V(()=>{const S=o.checkpoint,E=S.resolvedStyleType||S.ResolvedStyleType,A=S.resolvedStyleBackgroundColor||S.ResolvedStyleBackgroundColor||S.resolvedStyleColor||S.ResolvedStyleColor,x=S.resolvedStyleBorderColor||S.ResolvedStyleBorderColor,D=S.resolvedStyleIconColor||S.ResolvedStyleIconColor,R=S.resolvedStyleBackgroundShape||S.ResolvedStyleBackgroundShape;return E&&E!=="default"||A||x||D||R&&R!=="circle"?Cn({type:E||"circle",backgroundShape:R||"circle",backgroundColor:A||"#667eea",borderColor:x||"#ffffff",iconColor:D||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),w=()=>{o.clickable&&a("click",o.checkpoint)};return(S,E)=>(v(),m("div",{class:de(["checkpoint-card",{"is-clickable":e.clickable,"staffed-full":d.value==="full","staffed-partial":d.value==="partial","staffed-none":d.value==="none"}]),style:Qe({borderLeftColor:u.value}),onClick:w},[r("div",LI,[r("div",{class:de(["checkpoint-card-title",{clickable:e.clickable}])},[r("span",SI,[r("span",{class:"checkpoint-icon",innerHTML:k.value},null,8,xI),r("span",II,C(e.checkpoint.name),1),e.checkpoint.description?(v(),m("span",$I,"  "+C(e.checkpoint.description),1)):M("",!0)])],2)]),s.value.length>0?(v(),m("div",TI,[(v(!0),m(xe,null,Ne(s.value,A=>(v(),m("span",{key:A,class:"area-badge",style:Qe({backgroundColor:l(A)})},C(i(A)),5))),128))])):M("",!0),r("div",MI,[r("span",{class:de(["stat-badge staffing-badge",y.value])},C(e.checkpoint.checkedInCount)+"/"+C(e.checkpoint.requiredMarshals)+" staffed ",3),f.value>0?(v(),m("span",{key:0,class:de(["stat-badge",_.value])},C(g.value)+"/"+C(f.value)+" checked in ",3)):M("",!0)]),p.value.length>0?(v(),m("div",AI,[(v(!0),m(xe,null,Ne(p.value,A=>(v(),m("span",{key:A.id,class:de(["marshal-badge",{"checked-in":A.isCheckedIn}])},C(A.marshalName),3))),128))])):M("",!0)],6))}},PI=je(EI,[["__scopeId","data-v-da001590"]]),Jv={__name:"CheckpointsGrid",props:{checkpoints:{type:Array,required:!0},areas:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No checkpoints."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,o)=>(v(),We(ql,{"is-empty":e.checkpoints.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:ze(()=>[(v(!0),m(xe,null,Ne(e.checkpoints,a=>(v(),We(PI,{key:a.id,checkpoint:a,areas:e.areas,clickable:!0,onClick:o[0]||(o[0]=s=>t.$emit("select",s))},null,8,["checkpoint","areas"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},DI={class:"checkpoints-tab"},RI={class:"tab-header"},OI={class:"button-group"},BI={key:0,class:"status-pills"},NI={class:"filters-section"},FI={class:"search-group"},UI=["placeholder"],zI={__name:"CheckpointsList",props:{locations:{type:Array,required:!0},areas:{type:Array,default:()=>[]}},emits:["add-checkpoint-manually","import-checkpoints","select-location"],setup(e){const{termsLower:t}=ut(),o=e,a=$(""),s=$("all"),i=_=>{s.value=_},l=V(()=>o.locations.filter(_=>_.checkedInCount>=_.requiredMarshals&&_.requiredMarshals>0).length),u=V(()=>o.locations.filter(_=>_.checkedInCount>0&&_.checkedInCount<_.requiredMarshals).length),d=V(()=>o.locations.filter(_=>_.checkedInCount===0&&_.requiredMarshals>0).length),p=_=>{const k=o.areas.find(w=>w.id===_);return k?k.name:null},f=V(()=>{let _=o.locations;if(s.value==="full"?_=_.filter(k=>k.checkedInCount>=k.requiredMarshals&&k.requiredMarshals>0):s.value==="partial"?_=_.filter(k=>k.checkedInCount>0&&k.checkedInCount<k.requiredMarshals):s.value==="missing"&&(_=_.filter(k=>k.checkedInCount===0&&k.requiredMarshals>0)),a.value.trim()){const k=a.value.toLowerCase().trim().split(/\s+/);_=_.filter(w=>{const E=(w.areaIds||w.AreaIds||[]).map(D=>p(D)||"").join(" "),A=(w.assignments||[]).map(D=>D.marshalName||"").join(" "),x=`${w.name||""} ${w.description||""} ${E} ${A}`.toLowerCase();return k.every(D=>x.includes(D))})}return _}),g=V(()=>[...f.value].sort((_,k)=>Vs(_.name,k.name))),y=V(()=>{const _=a.value.trim();return s.value==="full"?_?`No fully staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully staffed.`:s.value==="partial"?_?`No partially staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially staffed.`:s.value==="missing"?_?`No unstaffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are unstaffed.`:_?`No ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} yet. Add one to get started!`});return(_,k)=>(v(),m("div",DI,[r("div",RI,[r("div",OI,[r("button",{onClick:k[0]||(k[0]=w=>_.$emit("add-checkpoint-manually")),class:"btn btn-primary"}," Add "+C(O(t).checkpoint),1),r("button",{onClick:k[1]||(k[1]=w=>_.$emit("import-checkpoints")),class:"btn btn-secondary"}," Import CSV ")]),e.locations.length>0?(v(),m("div",BI,[Ae(Ln,{variant:"neutral",active:s.value==="all",onClick:k[2]||(k[2]=w=>i("all"))},{default:ze(()=>[Ye(C(e.locations.length)+" total ",1)]),_:1},8,["active"]),l.value>0?(v(),We(Ln,{key:0,variant:"success",active:s.value==="full",onClick:k[3]||(k[3]=w=>i("full"))},{default:ze(()=>[Ye(C(l.value)+" fully staffed ",1)]),_:1},8,["active"])):M("",!0),u.value>0?(v(),We(Ln,{key:1,variant:"warning",active:s.value==="partial",onClick:k[4]||(k[4]=w=>i("partial"))},{default:ze(()=>[Ye(C(u.value)+" partial ",1)]),_:1},8,["active"])):M("",!0),d.value>0?(v(),We(Ln,{key:2,variant:"danger",active:s.value==="missing",onClick:k[5]||(k[5]=w=>i("missing"))},{default:ze(()=>[Ye(C(d.value)+" unstaffed ",1)]),_:1},8,["active"])):M("",!0)])):M("",!0)]),r("div",NI,[r("div",FI,[Ue(r("input",{"onUpdate:modelValue":k[6]||(k[6]=w=>a.value=w),type:"text",class:"search-input",placeholder:`Search by name, description, ${O(t).area}, or ${O(t).person}...`},null,8,UI),[[st,a.value]])])]),Ae(Jv,{checkpoints:g.value,areas:e.areas,"empty-message":y.value,onSelect:k[7]||(k[7]=w=>_.$emit("select-location",w))},null,8,["checkpoints","areas","empty-message"])]))}},HI=je(zI,[["__scopeId","data-v-35be2364"]]),VI={class:"area-card-header"},GI={class:"area-name-row"},jI={class:"area-name"},ZI={key:0,class:"default-badge"},qI={key:0,class:"area-description"},WI={class:"area-card-stats"},KI={class:"stat-badge"},JI={class:"stat-badge"},YI={__name:"AreaCard",props:{area:{type:Object,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const o=e,a=t,s=V(()=>o.area.checkpointCount!==void 0?o.area.checkpointCount:o.checkpoints.filter(f=>(f.areaIds||f.AreaIds||[]).includes(o.area.id)||f.areaId===o.area.id).length),i=V(()=>o.contacts.filter(f=>f.scopeConfigurations?f.scopeConfigurations.some(g=>g.scope==="EveryoneInAreas"&&g.itemType==="Area"?g.ids?.includes("ALL_AREAS")?!0:g.ids?.includes(o.area.id):!1):!1).length),l=V(()=>o.area.peopleTerm||o.eventPeopleTerm||"Marshals"),u=V(()=>{const f=o.area.checkpointTerm||o.eventCheckpointTerm||"Checkpoints";return s.value===1?Ja("checkpoint",f,l.value):Uv("checkpoint",f,l.value)}),d=V(()=>`${s.value} ${u.value.toLowerCase()}`),p=()=>{o.clickable&&a("click",o.area)};return(f,g)=>(v(),m("div",{class:de(["area-card",{"is-clickable":e.clickable,"is-default":e.area.isDefault}]),style:Qe({borderLeftColor:e.area.color||"#667eea"}),onClick:p},[r("div",VI,[r("div",{class:de(["area-card-title",{clickable:e.clickable}])},[r("div",GI,[r("span",jI,C(e.area.name),1),e.area.isDefault?(v(),m("span",ZI,"Default")):M("",!0)]),e.area.description?(v(),m("span",qI,C(e.area.description),1)):M("",!0)],2)]),r("div",WI,[r("span",KI,C(d.value),1),r("span",JI,C(i.value)+" contact"+C(i.value===1?"":"s"),1)])],6))}},XI=je(YI,[["__scopeId","data-v-8ac20bf2"]]),QI={__name:"AreasGrid",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},emptyMessage:{type:String,default:"No areas."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,o)=>(v(),We(ql,{"is-empty":e.areas.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:ze(()=>[(v(!0),m(xe,null,Ne(e.areas,a=>(v(),We(XI,{key:a.id,area:a,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,clickable:!0,onClick:o[0]||(o[0]=s=>t.$emit("select",s))},null,8,["area","checkpoints","contacts","event-people-term","event-checkpoint-term"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},e$={class:"areas-tab"},t$={class:"tab-header"},n$={class:"button-group"},o$={key:0,class:"status-pills"},s$={class:"filters-section"},a$={class:"search-group"},i$=["placeholder"],l$={__name:"AreasList",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["add-area","select-area"],setup(e){const{termsLower:t}=ut(),o=e,a=$(""),s=d=>o.checkpoints.filter(p=>(p.areaIds||p.AreaIds||[]).includes(d)||p.areaId===d),i=V(()=>{if(!a.value.trim())return o.areas;const d=a.value.toLowerCase().trim().split(/\s+/);return o.areas.filter(p=>{const g=s(p.id).map(_=>`${_.name||""} ${_.description||""}`).join(" "),y=`${p.name||""} ${p.description||""} ${g}`.toLowerCase();return d.every(_=>y.includes(_))})}),l=V(()=>[...i.value].sort((d,p)=>d.displayOrder!==p.displayOrder?d.displayOrder-p.displayOrder:Vs(d.name,p.name))),u=V(()=>a.value.trim()?`No ${t.value.areas} match your search.`:`No ${t.value.areas} yet. Click "Add ${t.value.area}" to create one.`);return(d,p)=>(v(),m("div",e$,[r("div",t$,[r("div",n$,[r("button",{onClick:p[0]||(p[0]=f=>d.$emit("add-area")),class:"btn btn-primary"}," Add "+C(O(t).area),1)]),e.areas.length>0?(v(),m("div",o$,[Ae(Ln,{variant:"neutral",active:!1},{default:ze(()=>[Ye(C(e.areas.length)+" "+C(e.areas.length===1?O(t).area:O(t).areas),1)]),_:1})])):M("",!0)]),r("div",s$,[r("div",a$,[Ue(r("input",{"onUpdate:modelValue":p[1]||(p[1]=f=>a.value=f),type:"text",class:"search-input",placeholder:`Search by ${O(t).area} name or ${O(t).checkpoint} name...`},null,8,i$),[[st,a.value]])])]),Ae(QI,{areas:l.value,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,"empty-message":u.value,onSelect:p[2]||(p[2]=f=>d.$emit("select-area",f))},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term","empty-message"])]))}},r$=je(l$,[["__scopeId","data-v-203f9606"]]),c$={course:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>',checkpoint:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',area:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',marshal:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',checklist:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>',notes:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/></svg>',incidents:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>',details:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16h6"/></svg>',location:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',contacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>',people:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polygon points="22 8 19.5 10 20.5 13 18 11.5 15.5 13 16.5 10 14 8 17 8 18 5 19 8 22 8" fill="currentColor"/></svg>',eventContacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 8V6a2 2 0 0 0-2-2h-2"/><path d="M22 12v2a2 2 0 0 1-2 2h-2"/></svg>',event:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>',appearance:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12.5" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>',logout:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>'},Xn=e=>c$[e]||"",u$={class:"responsive-tabs"},d$=["onClick"],h$=["innerHTML"],f$=["innerHTML"],p$={class:"hamburger-label"},v$=["onClick"],m$=["innerHTML"],g$={__name:"ResponsiveTabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,a=t,s=$(null),i=$(null),l=$(null),u=$(!1),d=$({}),p=$(!1),f=V(()=>o.tabs.find(E=>E.value===o.modelValue)),g=V(()=>f.value?f.value.label:"Menu"),y=()=>{if(u.value=!u.value,u.value&&i.value){const E=i.value.getBoundingClientRect();d.value={top:`${E.bottom+4}px`}}},_=E=>{a("update:modelValue",E),u.value=!1},k=E=>{if(!s.value)return;const A=s.value.contains(E.target);u.value&&!A&&(u.value=!1)},w=()=>{if(!l.value)return;const E=l.value,A=p.value;A&&(E.style.visibility="visible",E.style.position="static");const x=E.scrollWidth>E.clientWidth;A&&(E.style.visibility="",E.style.position=""),p.value=x};let S=null;return nn(()=>{document.addEventListener("click",k),cn(()=>{w()}),cn(()=>{const E=l.value?.parentElement;E&&(S=new ResizeObserver(()=>{w()}),S.observe(E))})}),xn(()=>{document.removeEventListener("click",k),S&&S.disconnect()}),qe(()=>o.tabs,()=>{cn(()=>{w()})},{deep:!0}),(E,A)=>(v(),m("div",u$,[r("div",{ref_key:"visibleTabsRef",ref:l,class:de(["visible-tabs",{"is-hidden":p.value}])},[(v(!0),m(xe,null,Ne(e.tabs,x=>(v(),m("button",{key:x.value,class:de(["tab-button",{active:e.modelValue===x.value}]),onClick:D=>E.$emit("update:modelValue",x.value),type:"button"},[x.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:O(Xn)(x.icon)},null,8,h$)):M("",!0),Ye(" "+C(x.label),1)],10,d$))),128))],2),r("div",{class:de(["hamburger-only",{"is-visible":p.value}])},[r("div",{class:"hamburger-menu",ref_key:"hamburgerMenu",ref:s},[r("button",{ref_key:"hamburgerButton",ref:i,class:de(["hamburger-button",{active:u.value}]),onClick:rt(y,["stop"]),type:"button"},[A[1]||(A[1]=r("span",{class:"hamburger-icon"},"",-1)),f.value?.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:O(Xn)(f.value.icon)},null,8,f$)):M("",!0),r("span",p$,C(g.value),1)],2),u.value?(v(),m("div",{key:0,class:"hamburger-dropdown",style:Qe(d.value),onClick:A[0]||(A[0]=rt(()=>{},["stop"]))},[(v(!0),m(xe,null,Ne(e.tabs,x=>(v(),m("button",{key:x.value,class:de(["dropdown-item",{active:e.modelValue===x.value}]),onClick:rt(D=>_(x.value),["stop"]),type:"button"},[x.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:O(Xn)(x.icon)},null,8,m$)):M("",!0),Ye(" "+C(x.label),1)],10,v$))),128))],4)):M("",!0)],512)],2)]))}},y$=je(g$,[["__scopeId","data-v-2467c6fc"]]),k$={class:"confirm-modal"},_$={class:"confirm-actions"},b$={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},showCancel:{type:Boolean,default:!0},isDanger:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(e,{emit:t}){const o=t,a=()=>{o("confirm")},s=()=>{o("cancel")};return(i,l)=>e.show?(v(),m("div",{key:0,class:"modal-overlay",onClick:rt(s,["self"])},[r("div",k$,[r("h3",null,C(e.title),1),r("p",null,C(e.message),1),r("div",_$,[e.showCancel?(v(),m("button",{key:0,onClick:s,class:"btn btn-secondary"},C(e.cancelText),1)):M("",!0),r("button",{onClick:a,class:de(["btn",e.isDanger?"btn-danger":"btn-primary"])},C(e.confirmText),3)])])])):M("",!0)}},Nl=je(b$,[["__scopeId","data-v-bead7a29"]]),w$={class:"base-modal-header"},C$={class:"base-modal-header-content"},L$={key:0,class:"base-modal-title"},S$={key:0,class:"base-modal-tab-header"},x$={key:1,class:"base-modal-footer"},I$={key:0,class:"base-modal-actions"},$$={__name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},variant:{type:String,default:"center",validator:e=>["center","sidebar"].includes(e)},zIndex:{type:Number,default:1e3},closeOnOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},confirmOnClose:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=()=>{const x=document.documentElement,D=getComputedStyle(x).getPropertyValue("--modal-resize-duration").trim();return D.endsWith("s")?parseFloat(D)*1e3:300},a=e,s=t,i=$(!1),l=$(!1),u=$(null),d=$(null);let p=null,f=!1,g=0;const y=()=>{if(!d.value||!u.value||f)return;const x=d.value.scrollHeight,D=g;if(D===x||g===0){g=x;return}f=!0,d.value.style.height=`${D}px`,d.value.style.overflow="hidden",d.value.offsetHeight,d.value.style.transition="height var(--modal-resize-duration, 0.3s) ease",d.value.style.height=`${x}px`;const R=o();setTimeout(()=>{d.value&&(d.value.style.height="",d.value.style.overflow="",d.value.style.transition=""),f=!1,g=x},R)},_=()=>{!u.value||typeof MutationObserver>"u"||(d.value&&(g=d.value.scrollHeight),p=new MutationObserver(()=>{cn(()=>{y()})}),p.observe(u.value,{childList:!0,subtree:!0,attributes:!0,characterData:!0}))},k=()=>{p&&(p.disconnect(),p=null)};nn(()=>{cn(()=>{a.show&&_()})}),xn(()=>{k()}),qe(()=>a.show,x=>{x?cn(()=>{g=0,_()}):k()});const w=()=>{a.closeOnOverlay&&S()},S=()=>{a.confirmOnClose&&a.isDirty?i.value=!0:s("close")},E=()=>{i.value=!1,s("close")},A=()=>{i.value=!1};return(x,D)=>(v(),We(gs,{name:"modal",appear:""},{default:ze(()=>[e.show?(v(),m("div",{key:0,class:"base-modal-overlay",style:Qe({zIndex:e.zIndex}),onClick:rt(w,["self"])},[r("div",{class:de(["base-modal",[`base-modal--${e.size}`,`base-modal--${e.variant}`]])},[r("div",w$,[r("div",C$,[io(x.$slots,"header",{},()=>[e.title?(v(),m("h2",L$,C(e.title),1)):M("",!0)],!0)]),e.showCloseButton?(v(),m("button",{key:0,onClick:S,class:"base-modal-close",type:"button","aria-label":"Close"},"  ")):M("",!0)]),x.$slots["tab-header"]?(v(),m("div",S$,[io(x.$slots,"tab-header",{},void 0,!0)])):M("",!0),r("div",{class:"base-modal-body",ref_key:"bodyRef",ref:u},[r("div",{class:"base-modal-body-content",ref_key:"contentRef",ref:d},[io(x.$slots,"default",{},void 0,!0)],512)],512),x.$slots.footer||x.$slots.actions?(v(),m("div",x$,[io(x.$slots,"footer",{},()=>[x.$slots.actions?(v(),m("div",I$,[io(x.$slots,"actions",{},void 0,!0)])):M("",!0)],!0)])):M("",!0)],2),e.confirmOnClose&&!l.value?(v(),We(Nl,{key:0,show:i.value,title:"Unsaved changes",message:"You have unsaved changes. Are you sure you want to close?",onConfirm:E,onCancel:A},null,8,["show"])):M("",!0)],4)):M("",!0)]),_:3}))}},Gt=je($$,[["__scopeId","data-v-141bdab1"]]),T$={class:"instruction"},M$={class:"share-link-container"},A$=["value"],E$={__name:"ShareLinkModal",props:{show:{type:Boolean,default:!1},link:{type:String,required:!0},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=t,i=$(!1),l=$(null),u=()=>{l.value&&(l.value.select(),document.execCommand("copy"),i.value=!0,setTimeout(()=>{i.value=!1},2e3))},d=()=>{s("close")};return(p,f)=>(v(),We(Gt,{show:e.show,title:`${O(o).person} check-in link`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:ze(()=>[r("button",{onClick:d,class:"btn btn-secondary"},"Close")]),default:ze(()=>[r("p",T$,"Share this link with "+C(O(a).peoplePlural)+" so they can check in:",1),r("div",M$,[r("input",{value:e.link,readonly:"",class:"form-input",ref_key:"linkInput",ref:l},null,8,A$),r("button",{onClick:u,class:"btn btn-primary"},C(i.value?"Copied!":"Copy"),1)])]),_:1},8,["show","title","is-dirty"]))}},P$=je(E$,[["__scopeId","data-v-b037c39b"]]),D$={class:"success-content"},R$={class:"success-message"},O$={class:"link-section"},B$={class:"help-text"},N$={key:0,class:"loading-text"},F$={key:1,class:"magic-link-container"},U$=["value"],z$={class:"magic-link-actions"},H$=["disabled"],V$={key:0,class:"success-text"},G$={key:1,class:"error-text"},j$={key:2,class:"error-text"},Z$={__name:"MarshalCreatedModal",props:{show:{type:Boolean,default:!1},eventId:{type:String,required:!0},marshalId:{type:String,default:null},marshalName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const{terms:o}=ut(),a=e,s=t,i=$(""),l=$(!1),u=$(!1),d=$(""),p=$(!1),f=$(!1),g=$(!1),y=$(""),_=async()=>{if(!(!a.eventId||!a.marshalId)){u.value=!0,d.value="";try{const E=await ms.getMagicLink(a.eventId,a.marshalId);i.value=E.data.magicLink,l.value=E.data.hasEmail}catch(E){console.error("Failed to fetch magic link:",E),d.value="Failed to load login link"}finally{u.value=!1}}},k=async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(i.value);else{const E=document.createElement("textarea");E.value=i.value,E.style.position="fixed",E.style.left="-9999px",document.body.appendChild(E),E.select(),document.execCommand("copy"),document.body.removeChild(E)}p.value=!0,setTimeout(()=>{p.value=!1},2e3)}catch(E){console.error("Failed to copy:",E)}},w=async()=>{if(!(!a.eventId||!a.marshalId)){f.value=!0,g.value=!1,y.value="";try{await ms.sendMagicLink(a.eventId,a.marshalId),g.value=!0,setTimeout(()=>{g.value=!1},3e3)}catch(E){console.error("Failed to send email:",E),y.value=E.response?.data?.message||"Failed to send email"}finally{f.value=!1}}},S=()=>{s("close")};return qe(()=>a.show,E=>{E&&a.marshalId?_():(i.value="",l.value=!1,d.value="",p.value=!1,g.value=!1,y.value="")},{immediate:!0}),(E,A)=>(v(),We(Gt,{show:e.show,title:`${O(o).person} created`,size:"medium","confirm-on-close":!1,"is-dirty":!1,onClose:S},{actions:ze(()=>[r("button",{onClick:S,class:"btn btn-primary"},"Done")]),default:ze(()=>[r("div",D$,[A[2]||(A[2]=r("div",{class:"success-icon"},"",-1)),r("p",R$,[r("strong",null,C(e.marshalName),1),A[1]||(A[1]=Ye(" has been added successfully. ",-1))])]),r("div",O$,[A[3]||(A[3]=r("label",null,"Login link",-1)),r("p",B$," Share this unique link with "+C(e.marshalName)+" so they can access their dashboard and check in. ",1),u.value?(v(),m("div",N$,"Loading link...")):i.value?(v(),m("div",F$,[r("input",{type:"text",value:i.value,readonly:"",class:"form-input magic-link-input",onFocus:A[0]||(A[0]=x=>x.target.select())},null,40,U$),r("div",z$,[r("button",{type:"button",class:"btn btn-secondary",onClick:k},C(p.value?"Copied!":"Copy link"),1),l.value?(v(),m("button",{key:0,type:"button",class:"btn btn-primary",disabled:f.value,onClick:w},C(f.value?"Sending...":"Send via email"),9,H$)):M("",!0)]),g.value?(v(),m("p",V$,"Email sent successfully!")):M("",!0),y.value?(v(),m("p",G$,C(y.value),1)):M("",!0)])):d.value?(v(),m("div",j$,C(d.value),1)):M("",!0)])]),_:1},8,["show","title"]))}},q$=je(Z$,[["__scopeId","data-v-e99677e9"]]),W$={class:"form-group"},K$={__name:"AddAdminModal",props:{show:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,s=$("");qe(()=>o.show,d=>{d||(s.value="")});const i=()=>{a("update:isDirty",!0)},l=()=>{a("submit",s.value)},u=()=>{a("close")};return(d,p)=>(v(),We(Gt,{show:e.show,title:"Add event administrator",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:ze(()=>[r("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-primary"}," Add administrator ")]),default:ze(()=>[p[2]||(p[2]=r("p",{class:"instruction"},"Enter the email address of the administrator to add",-1)),r("form",{onSubmit:rt(l,["prevent"])},[r("div",W$,[p[1]||(p[1]=r("label",null,"Email address",-1)),Ue(r("input",{"onUpdate:modelValue":p[0]||(p[0]=f=>s.value=f),type:"email",required:"",class:"form-input",placeholder:"admin@example.com",onInput:i},null,544),[[st,s.value]])])],32)]),_:1},8,["show","is-dirty"]))}},J$=je(K$,[["__scopeId","data-v-a82da194"]]),Y$={class:"form-group"},X$={key:0,class:"error"},Q$=["disabled"],eT={__name:"UploadRouteModal",props:{show:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},error:{type:String,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,s=$(null);qe(()=>o.show,d=>{d||(s.value=null)});const i=d=>{s.value=d.target.files[0],a("update:isDirty",!0)},l=()=>{s.value&&a("submit",s.value)},u=()=>{a("close")};return(d,p)=>(v(),We(Gt,{show:e.show,title:"Upload GPX route",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:ze(()=>[r("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-primary",disabled:e.uploading},C(e.uploading?"Uploading...":"Upload route"),9,Q$)]),default:ze(()=>[p[1]||(p[1]=r("p",{class:"instruction"},"Upload a GPX file to display the event route on the map",-1)),r("form",{onSubmit:rt(l,["prevent"])},[r("div",Y$,[p[0]||(p[0]=r("label",null,"GPX file",-1)),r("input",{type:"file",accept:".gpx",onChange:i,required:"",class:"form-input"},null,32)]),e.error?(v(),m("div",X$,C(e.error),1)):M("",!0)],32)]),_:1},8,["show","is-dirty"]))}},tT=je(eT,[["__scopeId","data-v-317975db"]]),nT={class:"instruction"},oT={class:"form-group"},sT={class:"form-group"},aT={class:"checkbox-label"},iT={key:0,class:"error"},lT={key:1,class:"import-result"},rT={key:0,class:"import-errors"},cT=["disabled"],uT={__name:"ImportLocationsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=e,i=t,l=$(null),u=$(!1);qe(()=>s.show,y=>{y||(l.value=null,u.value=!1)});const d=y=>{l.value=y.target.files[0],i("update:isDirty",!0)},p=()=>{i("update:isDirty",!0)},f=()=>{l.value&&i("submit",{file:l.value,deleteExisting:u.value})},g=()=>{i("close")};return(y,_)=>(v(),We(Gt,{show:e.show,title:`Import ${O(a).checkpoints} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:g},{actions:ze(()=>[r("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-primary",disabled:e.importing},C(e.importing?"Importing...":`Import ${O(a).checkpoints}`),9,cT)]),default:ze(()=>[r("p",nT,"Upload a CSV file with columns: Label, Lat/Latitude, Long/Longitude, What3Words (optional), "+C(O(o).people)+" (optional)",1),_[3]||(_[3]=r("div",{class:"csv-example"},[r("strong",null,"Example CSV format:"),r("pre",null,`Label,Latitude,Longitude,What3Words,Marshals
Checkpoint 1,51.505,-0.09,filled.count.soap,"John Doe, Jane Smith"
Checkpoint 2,51.510,-0.10,index.home.raft,Bob Wilson`)],-1)),r("form",{onSubmit:rt(f,["prevent"])},[r("div",oT,[_[1]||(_[1]=r("label",null,"CSV file",-1)),r("input",{type:"file",accept:".csv",onChange:d,required:"",class:"form-input"},null,32)]),r("div",sT,[r("label",aT,[Ue(r("input",{type:"checkbox","onUpdate:modelValue":_[0]||(_[0]=k=>u.value=k),onChange:p},null,544),[[xa,u.value]]),Ye(" Delete existing "+C(O(a).checkpoints)+" before import ",1)])]),e.error?(v(),m("div",iT,C(e.error),1)):M("",!0),e.result?(v(),m("div",lT,[r("p",null,"Created "+C(e.result.locationsCreated)+" "+C(O(a).checkpoints)+" and "+C(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),m("div",rT,[_[2]||(_[2]=r("strong",null,"Errors:",-1)),r("ul",null,[(v(!0),m(xe,null,Ne(e.result.errors,(k,w)=>(v(),m("li",{key:w},C(k),1))),128))])])):M("",!0)])):M("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},dT=je(uT,[["__scopeId","data-v-75c79d31"]]),hT={class:"instruction"},fT={class:"form-group"},pT={key:0,class:"error"},vT={key:1,class:"import-result"},mT={key:0,class:"import-errors"},gT=["disabled"],yT={__name:"ImportMarshalsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=e,i=t,l=$(null);qe(()=>s.show,f=>{f||(l.value=null)});const u=f=>{l.value=f.target.files[0],i("update:isDirty",!0)},d=()=>{l.value&&i("submit",l.value)},p=()=>{i("close")};return(f,g)=>(v(),We(Gt,{show:e.show,title:`Import ${O(a).people} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:p},{actions:ze(()=>[r("button",{type:"button",onClick:p,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:d,class:"btn btn-primary",disabled:e.importing},C(e.importing?"Importing...":`Import ${O(a).people}`),9,gT)]),default:ze(()=>[r("p",hT,"Upload a CSV file with columns: Name, Email (optional), Phone (optional), "+C(O(o).checkpoint)+" (optional)",1),g[2]||(g[2]=r("div",{class:"csv-example"},[r("strong",null,"Example CSV format:"),r("pre",null,`Name,Email,Phone,Checkpoint
John Doe,john@example.com,555-1234,Checkpoint 1
Jane Smith,jane@example.com,555-5678,Checkpoint 2`)],-1)),r("form",{onSubmit:rt(d,["prevent"])},[r("div",fT,[g[0]||(g[0]=r("label",null,"CSV file",-1)),r("input",{type:"file",accept:".csv",onChange:u,required:"",class:"form-input"},null,32)]),e.error?(v(),m("div",pT,C(e.error),1)):M("",!0),e.result?(v(),m("div",vT,[r("p",null,"Imported "+C(e.result.marshalsCreated)+" "+C(O(a).people)+" and "+C(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),m("div",mT,[g[1]||(g[1]=r("strong",null,"Errors:",-1)),r("ul",null,[(v(!0),m(xe,null,Ne(e.result.errors,(y,_)=>(v(),m("li",{key:_},C(y),1))),128))])])):M("",!0)])):M("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},kT=je(yT,[["__scopeId","data-v-be89bf1f"]]),_T=["onClick"],bT=["innerHTML"],wT={class:"hamburger-nav"},CT=["disabled"],LT=["innerHTML"],ST={class:"current-tab-label"},xT=["disabled"],IT={key:0,class:"hamburger-menu"},$T=["onClick"],TT=["innerHTML"],MT=400,AT={__name:"TabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,a=t,s=$(null),i=$(null),l=$(null),u=$(!1),d=$(!1),p=V(()=>{const R=o.tabs.find(F=>F.value===o.modelValue);return R?R.label:""}),f=V(()=>o.tabs.find(F=>F.value===o.modelValue)?.icon||null),g=V(()=>o.tabs.findIndex(R=>R.value===o.modelValue)),y=V(()=>g.value>0),_=V(()=>g.value<o.tabs.length-1),k=()=>{y.value&&a("update:modelValue",o.tabs[g.value-1].value)},w=()=>{_.value&&a("update:modelValue",o.tabs[g.value+1].value)},S=()=>{if(!s.value)return;const R=s.value.clientWidth;if(R<MT){u.value=!0;return}if(i.value&&!u.value){i.value.scrollWidth>R&&(u.value=!0);return}const F=o.tabs.some(B=>B.icon)?110:90,T=o.tabs.length*F,N=(o.tabs.length-1)*8;T+N<=R&&(u.value=!1,cn(()=>{i.value&&i.value.scrollWidth>R&&(u.value=!0)}))},E=()=>{d.value=!d.value},A=R=>{a("update:modelValue",R),d.value=!1},x=R=>{l.value&&!l.value.contains(R.target)&&(d.value=!1)};let D=null;return nn(()=>{cn(()=>{S(),s.value&&typeof ResizeObserver<"u"&&(D=new ResizeObserver(()=>{S()}),D.observe(s.value)),document.addEventListener("click",x)})}),xn(()=>{D&&D.disconnect(),document.removeEventListener("click",x)}),qe(()=>o.tabs,()=>{cn(()=>{S()})},{deep:!0}),(R,F)=>(v(),m("div",{class:"tabs-container",ref_key:"containerRef",ref:s},[u.value?(v(),m("div",{key:1,class:"hamburger-container",ref_key:"hamburgerRef",ref:l},[r("div",wT,[r("button",{class:de(["nav-arrow",{invisible:!y.value}]),onClick:k,type:"button","aria-label":"Previous tab",disabled:!y.value},"  ",10,CT),r("button",{class:"hamburger-button",onClick:E,type:"button","aria-label":"Tab menu"},[f.value?(v(),m("span",{key:0,class:"current-tab-icon",innerHTML:O(Xn)(f.value)},null,8,LT)):M("",!0),r("span",ST,C(p.value),1),F[0]||(F[0]=r("span",{class:"hamburger-chevron"},"",-1))]),r("button",{class:de(["nav-arrow",{invisible:!_.value}]),onClick:w,type:"button","aria-label":"Next tab",disabled:!_.value},"  ",10,xT)]),d.value?(v(),m("div",IT,[(v(!0),m(xe,null,Ne(e.tabs,T=>(v(),m("button",{key:T.value,class:de(["menu-item",{active:e.modelValue===T.value}]),onClick:N=>A(T.value),type:"button"},[T.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:O(Xn)(T.icon)},null,8,TT)):M("",!0),Ye(" "+C(T.label),1)],10,$T))),128))])):M("",!0)],512)):(v(),m("div",{key:0,class:"tabs",ref_key:"tabsRef",ref:i},[(v(!0),m(xe,null,Ne(e.tabs,T=>(v(),m("button",{key:T.value,class:de(["tab-button",{active:e.modelValue===T.value}]),onClick:N=>R.$emit("update:modelValue",T.value),type:"button"},[T.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:O(Xn)(T.icon)},null,8,bT)):M("",!0),Ye(" "+C(T.label),1)],10,_T))),128))],512))],512))}},qi=je(AT,[["__scopeId","data-v-736c5d0a"]]),ET={class:"tab-content"},PT={class:"form-group"},DT=["value"],RT={class:"form-group"},OT=["value"],BT={class:"form-group"},NT={class:"area-display"},FT={key:0,class:"no-area"},UT={class:"form-help"},zT={class:"form-group checkbox-group"},HT={class:"checkbox-label"},VT=["checked"],GT={class:"form-help"},jT={key:0,class:"custom-times-section"},ZT={class:"form-group"},qT=["value"],WT={class:"form-help"},KT={class:"form-group"},JT=["value"],YT={class:"form-help"},XT={__name:"LocationDetailsTab",props:{form:{type:Object,required:!0},areas:{type:Array,default:()=>[]},eventDate:{type:String,default:""},areaTermSingular:{type:String,default:"Area"},areaTermPlural:{type:String,default:"Areas"},checkpointTermSingular:{type:String,default:"checkpoint"},peopleTermPlural:{type:String,default:"marshals"}},emits:["update:form","input","save"],setup(e,{emit:t}){const o=e,a=t,s=V(()=>(o.form.areaIds||o.form.AreaIds||[]).map(d=>o.areas.find(p=>p.id===d)).filter(d=>d!==void 0)),i=(u,d)=>{a("update:form",{...o.form,[u]:d}),a("input")},l=u=>{const d={...o.form,useCustomTimes:u};if(!u)d.startTime="",d.endTime="";else if(!d.startTime&&!d.endTime&&o.eventDate){const p=Bl(o.eventDate);d.startTime=p,d.endTime=p}a("update:form",d),a("input")};return(u,d)=>(v(),m("div",ET,[r("form",{onSubmit:d[5]||(d[5]=rt(p=>u.$emit("save"),["prevent"]))},[r("div",PT,[d[6]||(d[6]=r("label",null,"Name",-1)),r("input",{value:e.form.name,onInput:d[0]||(d[0]=p=>i("name",p.target.value)),type:"text",required:"",class:"form-input"},null,40,DT)]),r("div",RT,[d[7]||(d[7]=r("label",null,"Description (optional)",-1)),r("input",{value:e.form.description,onInput:d[1]||(d[1]=p=>i("description",p.target.value)),type:"text",class:"form-input"},null,40,OT)]),r("div",BT,[r("label",null,C(e.areaTermSingular)+" (auto-assigned by location)",1),r("div",NT,[s.value.length===0?(v(),m("span",FT," Not in any "+C(e.areaTermSingular.toLowerCase())+" polygon ",1)):M("",!0),(v(!0),m(xe,null,Ne(s.value,p=>(v(),m("span",{key:p.id,class:"area-badge",style:Qe({backgroundColor:p.color||"var(--brand-primary)"})},C(p.name),5))),128))]),r("small",UT,C(e.areaTermPlural)+" are automatically assigned based on "+C(e.checkpointTermSingular.toLowerCase())+" location within "+C(e.areaTermSingular.toLowerCase())+" boundaries ",1)]),r("div",zT,[r("label",HT,[r("input",{checked:e.form.useCustomTimes,onChange:d[2]||(d[2]=p=>l(p.target.checked)),type:"checkbox"},null,40,VT),r("span",null,"Use custom date/time for this "+C(e.checkpointTermSingular.toLowerCase()),1)]),r("small",GT," By default, "+C(e.peopleTermPlural.toLowerCase())+" are expected during the event date/time. Enable this to set a specific time range. ",1)]),e.form.useCustomTimes?(v(),m("div",jT,[r("div",ZT,[d[8]||(d[8]=r("label",null,"Start date & time (optional)",-1)),r("input",{value:e.form.startTime,onInput:d[3]||(d[3]=p=>i("startTime",p.target.value)),type:"datetime-local",class:"form-input"},null,40,qT),r("small",WT," When "+C(e.peopleTermPlural.toLowerCase())+" should arrive at this "+C(e.checkpointTermSingular.toLowerCase()),1)]),r("div",KT,[d[9]||(d[9]=r("label",null,"End date & time (optional)",-1)),r("input",{value:e.form.endTime,onInput:d[4]||(d[4]=p=>i("endTime",p.target.value)),type:"datetime-local",class:"form-input"},null,40,JT),r("small",YT," When "+C(e.peopleTermPlural.toLowerCase())+" can leave this "+C(e.checkpointTermSingular.toLowerCase()),1)])])):M("",!0)],32)]))}},QT=je(XT,[["__scopeId","data-v-aa628901"]]),eM={class:"scope-configuration-editor"},tM={class:"editor-header"},nM={class:"scope-types-list"},oM=["onClick"],sM={class:"scope-type-label"},aM={class:"scope-type-pill"},iM={class:"expand-label"},lM={class:"expand-icon"},rM={class:"modal-content"},cM={class:"modal-header"},uM={class:"modal-body"},dM={class:"scope-help"},hM={key:0,class:"form-group"},fM={class:"checkbox-label special-option"},pM=["checked"],vM={key:0,class:"specific-selection"},mM=["placeholder"],gM={class:"checkbox-group scrollable"},yM=["checked","onChange"],kM={key:1,class:"form-group"},_M={class:"checkbox-label special-option"},bM=["checked"],wM={key:0,class:"specific-selection"},CM={class:"checkbox-group scrollable"},LM=["checked","onChange"],SM={key:2,class:"form-group"},xM={class:"checkbox-label special-option"},IM=["checked"],$M={key:0,class:"specific-selection"},TM=["placeholder"],MM={class:"checkbox-group scrollable"},AM={key:0,class:"checkbox-label this-checkpoint-option"},EM=["checked"],PM={class:"checkpoint-info"},DM={class:"checkpoint-name"},RM=["checked","onChange"],OM={class:"checkpoint-info"},BM={class:"checkpoint-name"},NM={key:0,class:"checkpoint-description"},FM={__name:"ScopeConfigurationEditor",props:{modelValue:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},excludeScopes:{type:Array,default:()=>[]},headerText:{type:String,default:""},intent:{type:String,default:"completion",validator:e=>["completion","location-update"].includes(e)},currentCheckpointId:{type:String,default:null}},emits:["update:modelValue","user-changed"],setup(e,{emit:t}){const{termsLower:o}=ut(),a=e,s=t,i=V(()=>[{scope:"SpecificPeople",label:`Specific ${o.value.people}`},{scope:"EveryoneAtCheckpoints",label:`Every ${o.value.person} at specified ${o.value.checkpoints}`},{scope:"OnePerCheckpoint",label:`One ${o.value.person} at each specified ${o.value.checkpoint}`},{scope:"OnePerArea",label:`One ${o.value.person} in specified ${o.value.areas}`},{scope:"EveryoneInAreas",label:`Everyone in specified ${o.value.areas}`},{scope:"EveryAreaLead",label:`Every ${o.value.area} lead at specified ${o.value.areas}`},{scope:"OneLeadPerArea",label:`One lead per specified ${o.value.area}`}]),l=$({SpecificPeople:{enabled:!0,ids:["ALL_MARSHALS"]},EveryoneInAreas:{enabled:!1,ids:[]},EveryoneAtCheckpoints:{enabled:!1,ids:[]},OnePerCheckpoint:{enabled:!1,ids:[]},OnePerArea:{enabled:!1,ids:[]},EveryAreaLead:{enabled:!1,ids:[]},OneLeadPerArea:{enabled:!1,ids:[]}}),u=$(null),d=$(""),p=$(""),f=$(!a.isEditing);let g=!0,y=!1;const _=V(()=>i.value.filter(ve=>!a.excludeScopes.includes(ve.scope))),k=V(()=>f.value?_.value:_.value.filter(ve=>q(ve.scope))),w=V(()=>_.value.filter(Le=>q(Le.scope)).length<_.value.length),S=V(()=>{const ve=_.value.filter(Le=>q(Le.scope)).length;return _.value.length-ve}),E=V(()=>!a.currentCheckpointId&&a.intent==="location-update");qe(()=>a.modelValue,ve=>{if(ve){if(y){y=!1;return}g=!0,Object.keys(l.value).forEach(Le=>{l.value[Le]={enabled:!1,ids:[]}}),ve.forEach(Le=>{Le.scope==="Everyone"?l.value.SpecificPeople={enabled:!0,ids:["ALL_MARSHALS"]}:Le.scope==="AreaLead"?l.value.EveryAreaLead={enabled:!0,ids:[...Le.ids]}:l.value[Le.scope]&&(l.value[Le.scope]={enabled:!0,ids:[...Le.ids]})}),g=!1}},{immediate:!0});const A=()=>{const ve=[];return Object.keys(l.value).forEach(Le=>{const Pe=l.value[Le];if(Pe.enabled){const W={scope:Le,itemType:x(Le),ids:[...Pe.ids]};ve.push(W)}}),ve};qe(l,()=>{if(g)return;if(Object.keys(l.value).some(Pe=>Pe!=="SpecificPeople"&&l.value[Pe].enabled)&&l.value.SpecificPeople?.ids.includes("ALL_MARSHALS")){const Pe=l.value.SpecificPeople.ids.indexOf("ALL_MARSHALS");l.value.SpecificPeople.ids.splice(Pe,1),l.value.SpecificPeople.ids.length===0&&(l.value.SpecificPeople.enabled=!1)}y=!0;const Le=A();s("update:modelValue",Le),s("user-changed")},{deep:!0});const x=ve=>D(ve)?"Area":R(ve)?"Checkpoint":F(ve)?"Marshal":null,D=ve=>ve==="EveryoneInAreas"||ve==="OnePerArea"||ve==="EveryAreaLead"||ve==="OneLeadPerArea",R=ve=>ve==="EveryoneAtCheckpoints"||ve==="OnePerCheckpoint",F=ve=>ve==="SpecificPeople",T=ve=>{const Le=i.value.find(Pe=>Pe.scope===ve);return Le?Le.label:ve},N=V(()=>a.headerText?a.headerText:a.intent==="location-update"?"Who can update this location?":`Who can see and complete this ${o.value.checklist}?`),B=ve=>a.intent==="location-update"?{SpecificPeople:`Select "Everyone" or choose specific ${o.value.people} who can update the location`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} can update the location`,OnePerCheckpoint:`Any ${o.value.person} at each selected ${o.value.checkpoint} can update the location`,OnePerArea:`Any ${o.value.person} in each selected ${o.value.area} can update the location`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} can update the location`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} can update the location`,OneLeadPerArea:`Any ${o.value.area} lead at the selected ${o.value.areas} can update the location`}[ve]||"":{SpecificPeople:`Select "Everyone at the event" or choose specific ${o.value.people} who must complete this (personal completion)`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} must complete this (personal completion)`,OnePerCheckpoint:`One completion needed at each selected ${o.value.checkpoint} (shared completion)`,OnePerArea:`One completion needed in each selected ${o.value.area} (shared completion)`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} must complete this (personal completion)`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} must complete this individually (personal completion)`,OneLeadPerArea:`One completion per ${o.value.area}, only ${o.value.area} leads can complete (shared among leads)`}[ve]||"",q=ve=>l.value[ve]?.enabled||!1,P=ve=>{const Le=l.value[ve];if(!Le||!Le.enabled)return"No";const Pe=Le.ids||[];if(D(ve)){if(Pe.includes("ALL_AREAS"))return`All ${o.value.areas}`;const W=Pe.length;return W>0?`${W} ${W!==1?o.value.areas:o.value.area}`:`Select ${o.value.areas}...`}if(R(ve)){if(Pe.includes("ALL_CHECKPOINTS"))return`All ${o.value.checkpoints}`;if(Pe.length===1&&Pe[0]==="THIS_CHECKPOINT")return`This ${o.value.checkpoint}`;const W=Pe.length;return W>0?`${W} ${W!==1?o.value.checkpoints:o.value.checkpoint}`:`Select ${o.value.checkpoints}...`}if(F(ve)){if(Pe.includes("ALL_MARSHALS"))return"Everyone";const W=Pe.length;return W>0?`${W} ${W!==1?o.value.people:o.value.person}`:`Select ${o.value.people}...`}return"Configured"},G=ve=>{u.value=ve,d.value="",p.value=""},X=()=>{u.value=null},ne=()=>{u.value&&(l.value[u.value]={enabled:!1,ids:[]}),X()},K=()=>u.value&&l.value[u.value]?.ids.includes("ALL_MARSHALS"),Q=()=>{if(!u.value)return;const ve=l.value[u.value];K()?(ve.ids=[],ve.enabled=!1):(ve.ids=["ALL_MARSHALS"],ve.enabled=!0)},he=ve=>u.value&&l.value[u.value]?.ids.includes(ve),U=ve=>{if(!u.value)return;const Le=l.value[u.value],Pe=Le.ids.indexOf(ve);Pe>=0?(Le.ids.splice(Pe,1),Le.ids.length===0&&(Le.enabled=!1)):(Le.ids.push(ve),Le.enabled=!0)},ee=V(()=>{if(!p.value)return a.marshals;const ve=p.value.toLowerCase();return a.marshals.filter(Le=>Le.name.toLowerCase().includes(ve)||Le.email&&Le.email.toLowerCase().includes(ve))}),fe=()=>u.value&&l.value[u.value]?.ids.includes("ALL_AREAS"),ue=()=>{if(!u.value)return;const ve=l.value[u.value];fe()?(ve.ids=[],ve.enabled=!1):(ve.ids=["ALL_AREAS"],ve.enabled=!0)},De=ve=>u.value&&l.value[u.value]?.ids.includes(ve),et=ve=>{if(!u.value)return;const Le=l.value[u.value],Pe=Le.ids.indexOf(ve);Pe>=0?(Le.ids.splice(Pe,1),Le.ids.length===0&&(Le.enabled=!1)):(Le.ids.push(ve),Le.enabled=!0)},Je=()=>u.value&&l.value[u.value]?.ids.includes("ALL_CHECKPOINTS"),Ze=()=>{if(!u.value)return;const ve=l.value[u.value];Je()?(ve.ids=[],ve.enabled=!1):(ve.ids=["ALL_CHECKPOINTS"],ve.enabled=!0)},He=ve=>u.value&&l.value[u.value]?.ids.includes(ve),be=ve=>{if(!u.value)return;const Le=l.value[u.value],Pe=Le.ids.indexOf(ve);Pe>=0?(Le.ids.splice(Pe,1),Le.ids.length===0&&(Le.enabled=!1)):(Le.ids.push(ve),Le.enabled=!0)},Ve=V(()=>{let ve=a.locations;if(d.value){const Le=d.value.toLowerCase();ve=ve.filter(Pe=>Pe.name.toLowerCase().includes(Le)||Pe.description&&Pe.description.toLowerCase().includes(Le))}return[...ve].sort((Le,Pe)=>Vs(Le.name,Pe.name))});return(ve,Le)=>(v(),m("div",eM,[r("div",tM,[r("h4",null,C(N.value),1)]),r("div",nM,[(v(!0),m(xe,null,Ne(k.value,Pe=>(v(),m("div",{key:Pe.scope,class:de(["scope-type-row",{active:q(Pe.scope)}]),onClick:W=>G(Pe.scope)},[r("div",sM,C(Pe.label),1),r("div",aM,C(P(Pe.scope)),1)],10,oM))),128)),w.value?(v(),m("div",{key:0,class:"expand-row",onClick:Le[0]||(Le[0]=Pe=>f.value=!f.value)},[r("div",iM,C(f.value?"Show less":`Show ${S.value} more option${S.value!==1?"s":""}...`),1),r("div",lM,C(f.value?"":""),1)])):M("",!0)]),u.value?(v(),m("div",{key:0,class:"scope-config-modal",onClick:rt(X,["self"])},[r("div",rM,[r("div",cM,[r("h5",null,C(T(u.value)),1),r("button",{onClick:X,class:"btn-close",type:"button"},"")]),r("div",uM,[r("p",dM,C(B(u.value)),1),F(u.value)?(v(),m("div",hM,[r("label",fM,[r("input",{type:"checkbox",checked:K(),onChange:Q},null,40,pM),r("span",null,[Le[4]||(Le[4]=r("strong",null,"Everyone at the event",-1)),Ye(" (all current and future "+C(O(o).people)+")",1)])]),K()?M("",!0):(v(),m("div",vM,[Ue(r("input",{"onUpdate:modelValue":Le[1]||(Le[1]=Pe=>p.value=Pe),type:"text",placeholder:`Search ${O(o).people}...`,class:"search-input"},null,8,mM),[[st,p.value]]),r("div",gM,[(v(!0),m(xe,null,Ne(ee.value,Pe=>(v(),m("label",{key:Pe.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:he(Pe.id),onChange:W=>U(Pe.id)},null,40,yM),r("span",null,C(Pe.name),1)]))),128))])]))])):M("",!0),D(u.value)?(v(),m("div",kM,[r("label",_M,[r("input",{type:"checkbox",checked:fe(),onChange:ue},null,40,bM),r("span",null,[r("strong",null,"All "+C(O(o).areas),1),Ye(" (includes future "+C(O(o).areas)+")",1)])]),fe()?M("",!0):(v(),m("div",wM,[r("div",CM,[(v(!0),m(xe,null,Ne(e.areas,Pe=>(v(),m("label",{key:Pe.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:De(Pe.id),onChange:W=>et(Pe.id)},null,40,LM),r("span",{class:"area-color-dot",style:Qe({backgroundColor:Pe.color||"#667eea"})},null,4),r("span",null,C(Pe.name),1)]))),128))])]))])):M("",!0),R(u.value)?(v(),m("div",SM,[r("label",xM,[r("input",{type:"checkbox",checked:Je(),onChange:Ze},null,40,IM),r("span",null,[r("strong",null,"All "+C(O(o).checkpoints),1),Ye(" (includes future "+C(O(o).checkpoints)+")",1)])]),Je()?M("",!0):(v(),m("div",$M,[Ue(r("input",{"onUpdate:modelValue":Le[2]||(Le[2]=Pe=>d.value=Pe),type:"text",placeholder:`Search ${O(o).checkpoints}...`,class:"search-input"},null,8,TM),[[st,d.value]]),r("div",MM,[E.value?(v(),m("label",AM,[r("input",{type:"checkbox",checked:He("THIS_CHECKPOINT"),onChange:Le[3]||(Le[3]=Pe=>be("THIS_CHECKPOINT"))},null,40,EM),r("div",PM,[r("span",DM,[r("strong",null,"This "+C(O(o).checkpoint),1)])])])):M("",!0),(v(!0),m(xe,null,Ne(Ve.value,Pe=>(v(),m("label",{key:Pe.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:He(Pe.id),onChange:W=>be(Pe.id)},null,40,RM),r("div",OM,[r("span",BM,C(Pe.name),1),Pe.description?(v(),m("span",NM," - "+C(Pe.description),1)):M("",!0)])]))),128))])]))])):M("",!0)]),r("div",{class:"modal-footer"},[r("button",{onClick:ne,class:"btn btn-secondary",type:"button"},"Deselect all"),r("button",{onClick:X,class:"btn btn-primary",type:"button"},"Done")])])])):M("",!0)]))}},mc=je(FM,[["__scopeId","data-v-3107d36b"]]),UM={class:"tab-content"},zM={class:"form-group"},HM=["value"],VM={key:0,class:"form-error"},GM={class:"form-row"},jM={class:"form-group"},ZM=["disabled"],qM={class:"form-group"},WM=["disabled"],KM={class:"form-group"},JM={class:"accordion-item"},YM={class:"accordion-preview"},XM={class:"accordion-arrow"},QM={key:0,class:"accordion-content"},eA={class:"section-description"},tA={class:"dynamic-checkbox"},nA=["checked"],oA={key:0,class:"dynamic-settings"},sA={__name:"LocationCoordinatesTab",props:{form:{type:Object,required:!0},isMoving:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:"Checkpoint"},peopleTermPlural:{type:String,default:"Marshals"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:form","input","save","move-location"],setup(e,{emit:t}){const o=e,a=t,s=$(!1),i=$(""),l=$(""),u=_=>_==null||_===""||isNaN(_)?"":Number(_).toFixed(6);qe(()=>o.form.longitude,_=>{i.value=u(_)},{immediate:!0}),qe(()=>o.form.latitude,_=>{l.value=u(_)},{immediate:!0});const d=_=>{const k=_==="longitude"?i:l,w=parseFloat(k.value);isNaN(w)?k.value.trim()===""&&(a("update:form",{...o.form,[_]:0}),a("input"),k.value=u(0)):(a("update:form",{...o.form,[_]:w}),a("input"),k.value=u(w))},p=(_,k)=>{a("update:form",{...o.form,[_]:k}),a("input")},f=_=>{if(_){const k=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],w=o.form.locationUpdateScopeConfigurations||[],S=w.length>0?w:k;a("update:form",{...o.form,isDynamic:!0,latitude:0,longitude:0,locationUpdateScopeConfigurations:S})}else a("update:form",{...o.form,isDynamic:!1});a("input")},g=_=>{a("update:form",{...o.form,locationUpdateScopeConfigurations:_}),a("input")},y=_=>{if(!_)return!0;const k=_.includes(".")?_.split("."):_.split("/");if(k.length!==3)return!1;const w=/^[a-z]{1,20}$/;return k.every(S=>w.test(S))};return(_,k)=>(v(),m("div",UM,[r("form",{onSubmit:k[6]||(k[6]=rt(w=>_.$emit("save"),["prevent"]))},[r("div",zM,[k[10]||(k[10]=r("label",null,"What3Words (optional)",-1)),r("input",{value:e.form.what3Words,onInput:k[0]||(k[0]=w=>p("what3Words",w.target.value)),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap"},null,40,HM),e.form.what3Words&&!y(e.form.what3Words)?(v(),m("small",VM," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):M("",!0)]),e.form.isDynamic?M("",!0):(v(),m(xe,{key:0},[r("div",GM,[r("div",jM,[k[11]||(k[11]=r("label",null,"Longitude",-1)),Ue(r("input",{"onUpdate:modelValue":k[1]||(k[1]=w=>i.value=w),onBlur:k[2]||(k[2]=w=>d("longitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., -0.091234"},null,40,ZM),[[st,i.value]])]),r("div",qM,[k[12]||(k[12]=r("label",null,"Latitude",-1)),Ue(r("input",{"onUpdate:modelValue":k[3]||(k[3]=w=>l.value=w),onBlur:k[4]||(k[4]=w=>d("latitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., 51.505123"},null,40,WM),[[st,l.value]])])]),r("div",KM,[r("button",{type:"button",onClick:k[5]||(k[5]=w=>_.$emit("move-location")),class:de(["btn btn-secondary btn-with-icon",{"btn-primary":e.isMoving}])},[k[13]||(k[13]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),Ye(" "+C(e.isMoving?"Click on map to set new location...":`Move ${e.checkpointTermSingular.toLowerCase()}...`),1)],2)])],64))],32),r("div",JM,[r("button",{type:"button",class:de(["accordion-header",{expanded:s.value}]),onClick:k[7]||(k[7]=w=>s.value=!s.value)},[k[14]||(k[14]=Er('<div class="accordion-icon" data-v-c3ce308d><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-c3ce308d><path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="#F59E0B" opacity="0.3" data-v-c3ce308d></path><path d="M12 6L13.5 9L17 9.5L14.5 12L15 15.5L12 14L9 15.5L9.5 12L7 9.5L10.5 9L12 6Z" fill="#F59E0B" data-v-c3ce308d></path><circle cx="12" cy="11" r="2" fill="white" data-v-c3ce308d></circle></svg></div><span class="accordion-title" data-v-c3ce308d>Dynamic location</span>',2)),r("span",YM,C(e.form.isDynamic?"Enabled":"Disabled"),1),r("span",XM,C(s.value?"":""),1)],2),s.value?(v(),m("div",QM,[r("p",eA," Enable this for lead cars, sweep vehicles, or other moving "+C(e.checkpointTermSingular.toLowerCase())+"s whose location can be updated by designated "+C(e.peopleTermPlural.toLowerCase())+" during the event. ",1),r("label",tA,[r("input",{type:"checkbox",checked:e.form.isDynamic,onChange:k[8]||(k[8]=w=>f(w.target.checked))},null,40,nA),r("span",null,"This "+C(e.checkpointTermSingular.toLowerCase())+" can move",1)]),e.form.isDynamic?(v(),m("div",oA,[Ae(mc,{"model-value":e.form.locationUpdateScopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":e.isEditing,"header-text":`Who can update this ${e.checkpointTermSingular.toLowerCase()}'s location?`,"exclude-scopes":["OnePerCheckpoint","OneLeadPerArea","OnePerArea"],intent:"location-update","current-checkpoint-id":e.form.id,"onUpdate:modelValue":g,onUserChanged:k[9]||(k[9]=w=>_.$emit("input"))},null,8,["model-value","areas","locations","marshals","is-editing","header-text","current-checkpoint-id"])])):M("",!0)])):M("",!0)])]))}},aA=je(sA,[["__scopeId","data-v-c3ce308d"]]);function Yv(e){const t=$(new Map),o=f=>t.value.has(f.id)?t.value.get(f.id):f.isCheckedIn;return{pendingCheckInChanges:t,getEffectiveCheckInStatus:o,handleToggleCheckIn:f=>{const y=!o(f);y===f.isCheckedIn?t.value.delete(f.id):t.value.set(f.id,y),e&&e()},getStatusIcon:f=>o(f)?"":"",getStatusColor:f=>o(f)?"#28a745":"#dc3545",getStatusText:f=>o(f)?"Checked in":"Not checked in",formatTime:f=>f?new Date(f).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",clearPendingChanges:()=>{t.value.clear()},getPendingChanges:()=>Array.from(t.value.entries()).map(([f,g])=>({assignmentId:f,shouldBeCheckedIn:g}))}}const iA={class:"card-main"},lA={class:"card-title"},rA={class:"marshal-name"},cA={key:0,class:"card-check-in"},uA={class:"toggle-icon"},dA={class:"toggle-label"},hA={key:0,class:"check-in-time"},fA={key:0,class:"check-in-method"},pA={key:1,class:"unsaved-indicator"},vA={key:1,class:"card-status-readonly"},mA={class:"status-icon"},gA={key:0,class:"check-in-time"},yA={key:0,class:"check-in-method"},kA={key:2,class:"card-badge"},_A={key:3,class:"card-badge"},bA={__name:"MarshalAssignmentCard",props:{assignment:{type:Object,required:!0},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},location:{type:Object,default:null}},emits:["click","toggle-check-in","remove","undo-remove"],setup(e,{emit:t}){const o=e,a=t,s=g=>g?new Date(g).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",i=V(()=>{const{checkedInBy:g,checkInMethod:y,marshalName:_}=o.assignment;return g&&g!==_?g:y||""}),l=V(()=>!o.assignment.isPending&&!o.isMarkedForRemoval&&!o.readOnly),u=V(()=>{const{checkInLatitude:g,checkInLongitude:y}=o.assignment,_=o.location;return!g||!y||!_?.latitude||!_?.longitude?null:Db(g,y,_.latitude,_.longitude)}),d=V(()=>u.value===null?null:Rb(u.value)),p=V(()=>u.value===null?"":u.value<=50?"distance-close":u.value<=100?"distance-medium":"distance-far"),f=()=>{l.value&&a("click",o.assignment)};return(g,y)=>(v(),m("div",{class:de(["marshal-assignment-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-clickable":l.value}]),onClick:f},[r("div",iA,[r("div",lA,[r("span",rA,C(e.assignment.marshalName),1)]),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.readOnly?(v(),m("div",cA,[r("button",{class:de(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:y[0]||(y[0]=rt(_=>g.$emit("toggle-check-in",e.assignment),["stop"]))},[r("span",uA,C(e.effectiveCheckInStatus?"":""),1),r("span",dA,C(e.effectiveCheckInStatus?"Checked in":"Check in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(v(),m("span",hA,[Ye(C(s(e.assignment.checkInTime))+" ",1),i.value?(v(),m("span",fA,"("+C(i.value)+")",1)):M("",!0),d.value?(v(),m("span",{key:1,class:de(["check-in-distance",p.value])},C(d.value),3)):M("",!0)])):e.hasUnsavedChanges?(v(),m("span",pA," Unsaved ")):M("",!0)])):M("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&e.readOnly?(v(),m("div",vA,[r("span",{class:de(["status-badge",e.effectiveCheckInStatus?"status-checked-in":"status-not-checked-in"])},[r("span",mA,C(e.effectiveCheckInStatus?"":""),1),Ye(" "+C(e.effectiveCheckInStatus?"Checked in":"Not checked in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime?(v(),m("span",gA,[Ye(C(s(e.assignment.checkInTime))+" ",1),i.value?(v(),m("span",yA,"("+C(i.value)+")",1)):M("",!0),d.value?(v(),m("span",{key:1,class:de(["check-in-distance",p.value])},C(d.value),3)):M("",!0)])):M("",!0)])):M("",!0),e.assignment.isPending?(v(),m("div",kA,[...y[3]||(y[3]=[r("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):M("",!0),e.isMarkedForRemoval?(v(),m("div",_A,[...y[4]||(y[4]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):M("",!0)]),!e.readOnly&&!e.isMarkedForRemoval?(v(),m("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:y[1]||(y[1]=rt(_=>g.$emit("remove",e.assignment),["stop"]))},"  ")):M("",!0),e.isMarkedForRemoval?(v(),m("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:y[2]||(y[2]=rt(_=>g.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):M("",!0)],2))}},wA=je(bA,[["__scopeId","data-v-6e808532"]]),CA={class:"tab-content"},LA={key:0,class:"read-only-notice"},SA={key:1,class:"form-group"},xA=["value"],IA={class:"section-title"},$A={key:2,class:"assign-section"},TA={__name:"LocationAssignmentsTab",props:{form:{type:Object,required:!0},assignments:{type:Array,default:()=>[]},peopleTerm:{type:String,default:"Marshals"},personTerm:{type:String,default:"Marshal"},checkpointTerm:{type:String,default:"Checkpoint"},readOnly:{type:Boolean,default:!1}},emits:["update:form","input","remove-assignment","open-assign-modal","select-marshal"],setup(e,{expose:t,emit:o}){const a=e,s=V(()=>a.peopleTerm.toLowerCase()),i=V(()=>a.personTerm.toLowerCase()),l=V(()=>a.checkpointTerm.toLowerCase()),u=o,{pendingCheckInChanges:d,getEffectiveCheckInStatus:p,handleToggleCheckIn:f}=Yv(()=>u("input")),g=$(new Set),y=V(()=>a.assignments?.length||0),_=V(()=>a.assignments?[...a.assignments].sort((D,R)=>(D.marshalName||"").localeCompare(R.marshalName||"",void 0,{sensitivity:"base"})):[]),k=D=>g.value.has(D),w=D=>{D.isPending||u("select-marshal",D)},S=D=>{f(D)},E=D=>{D.isPending?u("remove-assignment",D):(g.value.add(D.id),u("input"))},A=D=>{g.value.delete(D.id),u("input")},x=(D,R)=>{u("update:form",{...a.form,[D]:Number(R)}),u("input")};return t({pendingCheckInChanges:d,clearPendingChanges:()=>{d.value.clear(),g.value.clear()},getPendingChanges:()=>Array.from(d.value.entries()).map(([D,R])=>({assignmentId:D,shouldBeCheckedIn:R})),getMarkedForRemoval:()=>Array.from(g.value)}),(D,R)=>(v(),m("div",CA,[e.readOnly?(v(),m("div",LA," Viewing from "+C(i.value)+" - "+C(s.value)+" cannot be modified here. ",1)):M("",!0),e.readOnly?M("",!0):(v(),m("div",SA,[r("label",null,"Required "+C(s.value),1),r("input",{value:e.form.requiredMarshals,onInput:R[0]||(R[0]=F=>x("requiredMarshals",F.target.value)),type:"number",min:"1",required:"",class:"form-input"},null,40,xA)])),r("h3",IA,"Assigned "+C(s.value)+" ("+C(y.value)+")",1),Ae(ql,{"is-empty":e.assignments.length===0,"empty-message":`No ${s.value} assigned yet.`,"empty-hint":`Use the button below to assign ${s.value} to this ${l.value}.`},{default:ze(()=>[(v(!0),m(xe,null,Ne(_.value,F=>(v(),We(wA,{key:F.id,assignment:F,"effective-check-in-status":O(p)(F),"has-unsaved-changes":O(d).has(F.id),"is-marked-for-removal":k(F.id),"read-only":e.readOnly,location:e.form,onClick:w,onToggleCheckIn:S,onRemove:E,onUndoRemove:A},null,8,["assignment","effective-check-in-status","has-unsaved-changes","is-marked-for-removal","read-only","location"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),e.readOnly?M("",!0):(v(),m("div",$A,[r("button",{type:"button",class:"btn btn-primary assign-btn",onClick:R[1]||(R[1]=F=>D.$emit("open-assign-modal"))}," + Assign "+C(i.value)+"... ",1)]))]))}},MA=je(TA,[["__scopeId","data-v-a4e77b95"]]),AA={class:"grouped-tasks-list"},EA={key:0,class:"empty-state"},PA={key:1,class:"task-groups"},DA=["onClick"],RA={class:"task-header-content"},OA={class:"task-checkbox-area"},BA={class:"task-info"},NA={class:"task-name"},FA={class:"task-summary"},UA={key:0,class:"modified-badge"},zA={class:"task-scope"},HA=["title"],VA={class:"expand-arrow"},GA={key:0,class:"task-group-details"},jA={class:"detail-checkbox"},ZA=["checked","disabled","onChange"],qA={class:"detail-content"},WA={class:"detail-context"},KA={key:0,class:"detail-completion"},JA={key:0,class:"pending-text"},YA={class:"completion-text"},XA={class:"completion-time"},QA={key:1,class:"detail-uncomplete"},eE={key:2,class:"detail-disabled"},tE={__name:"GroupedTasksList",props:{items:{type:Array,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["toggle-complete"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=e,i=$(new Set),l=V(()=>{const k=new Map;for(const w of s.items){k.has(w.itemId)||k.set(w.itemId,{itemId:w.itemId,text:w.text,items:[],totalCount:0,completedCount:0,allCompleted:!1,hasModified:!1});const S=k.get(w.itemId);S.items.push(w),S.totalCount++,w.localIsCompleted&&S.completedCount++,w.isModified&&(S.hasModified=!0)}for(const w of k.values())w.allCompleted=w.completedCount===w.totalCount,w.items.sort((S,E)=>{const A=y(S),x=y(E);return A.localeCompare(x,void 0,{numeric:!0,sensitivity:"base"})});return Array.from(k.values()).sort((w,S)=>w.text.localeCompare(S.text,void 0,{sensitivity:"base"}))}),u=k=>{i.value.has(k)?i.value.delete(k):i.value.add(k),i.value=new Set(i.value)},d=k=>k.hasModified?"status-modified":k.allCompleted?"status-completed":k.completedCount>0?"status-partial":"status-pending",p=k=>k.allCompleted?"":k.completedCount>0?"":"",f=k=>({Everyone:"Everyone",SpecificPeople:"Assigned individually",EveryoneInAreas:`Per ${a.value.area}`,EveryoneAtCheckpoints:`Per ${a.value.checkpoint}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,OnePerArea:`One per ${a.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${a.value.area}`})[k.matchedScope]||k.matchedScope,g=k=>({Everyone:"This task is for everyone at the event",SpecificPeople:"This task is specifically assigned to certain people",EveryoneInAreas:`This task is for everyone in certain ${a.value.areas}`,EveryoneAtCheckpoints:`This task is for everyone at certain ${a.value.checkpoints}`,OnePerCheckpoint:`One person at the ${a.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${a.value.area} needs to complete this`,EveryAreaLead:`This task is for ${a.value.area} leads only`,OneLeadPerArea:`One ${a.value.area} lead needs to complete this`})[k.matchedScope]||"",y=k=>{if(!k.completionContextType||!k.completionContextId)return"Everyone";if(k.completionContextType==="Checkpoint"){const w=s.locations.find(S=>S.id===k.completionContextId);return w?w.description?`${w.name} - ${w.description}`:w.name:`${o.value.checkpoint} (unknown)`}if(k.completionContextType==="Area"){const w=s.areas.find(S=>S.id===k.completionContextId);return w?w.name:`${o.value.area} (unknown)`}if(k.completionContextType==="Personal"){if(k.contextOwnerName)return k.contextOwnerName;if(k.completionContextId&&s.marshals.length>0){const w=s.marshals.find(S=>S.id===k.completionContextId||S.marshalId===k.completionContextId);if(w)return w.name||w.marshalName}return"Assigned individually"}return k.completionContextType},_=k=>k?new Date(k).toLocaleString():"";return(k,w)=>(v(),m("div",AA,[l.value.length===0?(v(),m("div",EA,[...w[0]||(w[0]=[r("p",null,"No tasks available.",-1)])])):(v(),m("div",PA,[(v(!0),m(xe,null,Ne(l.value,S=>(v(),m("div",{key:S.itemId,class:de(["task-group",{"all-completed":S.allCompleted,"has-modified":S.hasModified}])},[r("button",{type:"button",class:"task-group-header",onClick:E=>u(S.itemId)},[r("div",RA,[r("div",OA,[r("span",{class:de(["task-status-icon",d(S)])},C(p(S)),3)]),r("div",BA,[r("div",NA,C(S.text),1),r("div",FA,[r("span",{class:de(["completion-count",{"all-done":S.allCompleted}])},C(S.completedCount)+"/"+C(S.totalCount)+" completed ",3),S.hasModified?(v(),m("span",UA," Modified ")):M("",!0)])]),r("div",zA,[r("span",{class:"scope-pill",title:g(S.items[0])},C(f(S.items[0])),9,HA)])]),r("span",VA,C(i.value.has(S.itemId)?"":""),1)],8,DA),i.value.has(S.itemId)?(v(),m("div",GA,[(v(!0),m(xe,null,Ne(S.items,E=>(v(),m("div",{key:`${E.itemId}-${E.completionContextId}`,class:de(["task-detail-item",{"item-completed":E.localIsCompleted,"item-modified":E.isModified}])},[r("div",jA,[r("input",{type:"checkbox",checked:E.localIsCompleted,disabled:!E.canBeCompletedByMe&&!E.localIsCompleted,onChange:A=>k.$emit("toggle-complete",E)},null,40,ZA)]),r("div",qA,[r("div",WA,C(y(E)),1),E.localIsCompleted?(v(),m("div",KA,[E.isModified&&!E.isCompleted?(v(),m("span",JA," Will be marked as completed ")):(v(),m(xe,{key:1},[r("span",YA,C(E.completedByActorName||"Unknown"),1),r("span",XA,C(_(E.completedAt)),1)],64))])):E.isModified&&E.isCompleted?(v(),m("div",QA,[...w[1]||(w[1]=[r("span",{class:"pending-text"},"Will be marked as incomplete",-1)])])):E.canBeCompletedByMe?M("",!0):(v(),m("div",eE," Already completed by someone else "))])],2))),128))])):M("",!0)],2))),128))]))]))}},id=je(tE,[["__scopeId","data-v-409a65e7"]]),nE={class:"checkpoint-checklist-view"},oE={key:0,class:"loading-state"},sE={key:1,class:"error-state"},aE={key:2,class:"empty-state"},iE={class:"help-text"},lE={key:3,class:"empty-state"},rE={__name:"CheckpointChecklistView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{termsLower:a}=ut(),s=e,i=o,l=$([]),u=$(!1),d=$(null),p=$(new Map),f=V(()=>s.assignments.length===0),g=V(()=>l.value.map(S=>{const E=p.value.get(`${S.itemId}|||${S.completionContextId}`),A=E!==void 0?E.complete:S.isCompleted,x=E!==void 0&&E.complete!==S.isCompleted;return{...S,localIsCompleted:A,isModified:x}})),y=async()=>{if(!(!s.eventId||!s.locationId&&!s.areaId)){u.value=!0,d.value=null;try{const S=s.locationId?await Rt.getCheckpointChecklist(s.eventId,s.locationId):await Rt.getAreaChecklist(s.eventId,s.areaId);if(l.value=S.data||[],s.modelValue&&s.modelValue.length>0){const E=new Map;s.modelValue.forEach(A=>{E.set(`${A.itemId}|||${A.contextId}`,{complete:A.complete,contextType:A.contextType,contextId:A.contextId})}),p.value=E}}catch(S){console.error("Failed to load checklist:",S),d.value=S.response?.data?.message||"Failed to load checklist"}finally{u.value=!1}}},_=S=>{const E=S.contextOwnerMarshalId||(s.assignments.length>0?s.assignments[0].marshalId:null);if(!E)return;const A=`${S.itemId}|||${S.completionContextId}`,x=p.value.get(A),D=x!==void 0?x.complete:S.isCompleted;p.value.set(A,{complete:!D,contextType:S.completionContextType,contextId:S.completionContextId,marshalId:E}),k()},k=()=>{const S=[];for(const[E,A]of p.value.entries()){const[x,D]=E.split("|||"),R=l.value.find(F=>F.itemId===x&&F.completionContextId===D);R&&A.complete!==R.isCompleted&&S.push({itemId:x,complete:A.complete,contextType:A.contextType,contextId:A.contextId,marshalId:A.marshalId})}i("update:modelValue",S),i("change",S)};return t({resetLocalState:()=>{if(p.value=new Map,s.modelValue&&s.modelValue.length>0){const S=new Map;s.modelValue.forEach(E=>{S.set(`${E.itemId}|||${E.contextId}`,{complete:E.complete,contextType:E.contextType,contextId:E.contextId,marshalId:E.marshalId})}),p.value=S}},loadChecklist:y}),qe(()=>[s.eventId,s.locationId,s.areaId],()=>{y()},{immediate:!0}),(S,E)=>(v(),m("div",nE,[u.value?(v(),m("div",oE," Loading checklist... ")):d.value?(v(),m("div",sE,[r("p",null,C(d.value),1),r("button",{onClick:y,class:"btn btn-secondary btn-small"}," Retry ")])):f.value?(v(),m("div",aE,[r("p",null,"No "+C(O(a).peoplePlural)+" assigned to this "+C(O(a).checkpoint)+" yet.",1),r("p",iE,"Assign "+C(O(a).peoplePlural)+" to enable "+C(O(a).checklist)+" completion.",1)])):l.value.length===0?(v(),m("div",lE,[r("p",null,"No checklist items for this "+C(O(a).checkpoint)+".",1)])):(v(),We(id,{key:4,items:g.value,locations:e.locations,areas:e.areas,onToggleComplete:_},null,8,["items","locations","areas"]))]))}},Xv=je(rE,[["__scopeId","data-v-52b7a966"]]),cE={class:"notes-view"},uE={key:0,class:"loading-state"},dE={key:1,class:"error-state"},hE={key:2,class:"empty-state"},fE={key:3,class:"notes-list"},pE={class:"note-header"},vE={class:"note-title-row"},mE={key:0,class:"pin-icon",title:"Pinned"},gE={class:"note-title"},yE={class:"note-meta"},kE={key:0,class:"category-badge"},_E={key:0,class:"note-content"},bE={class:"note-footer"},wE={class:"created-info"},CE={key:0,class:"scope-info"},LE={__name:"NotesView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},marshalId:{type:String,default:null},allNotes:{type:Array,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},showScope:{type:Boolean,default:!0}},setup(e,{expose:t}){const o=e,a=$([]),s=$(!1),i=$(null),l=V(()=>o.marshalId?"No notes for this marshal.":o.areaId?"No notes for this area.":o.locationId?"No notes for this checkpoint.":"No notes available."),u=V(()=>o.areaId?o.locations.filter(E=>E.areaIds&&E.areaIds.includes(o.areaId)):[]),d=V(()=>u.value.map(E=>E.id)),p=V(()=>{if(!o.areaId)return[];const E=new Set;return o.assignments.filter(A=>d.value.includes(A.locationId)).forEach(A=>E.add(A.marshalId)),Array.from(E)}),f=E=>o.assignments.filter(A=>A.marshalId===E).map(A=>A.locationId),g=E=>{const A=f(E),x=new Set;for(const D of A){const R=o.locations.find(F=>F.id===D);R?.areaIds&&R.areaIds.forEach(F=>x.add(F))}return Array.from(x)},y=(E,A)=>{if(!E.scopeConfigurations)return null;for(const x of E.scopeConfigurations){if(x.itemType==="Area"){if(A.type==="area"&&(x.ids.includes(A.areaId)||x.ids.includes("ALL_AREAS")))return{matched:!0,scope:x.scope==="EveryAreaLead"?"Area leads":"Area"};if(A.type==="checkpoint"){const R=o.locations.find(F=>F.id===A.locationId)?.areaIds||[];if(x.ids.includes("ALL_AREAS")||R.some(F=>x.ids.includes(F)))return{matched:!0,scope:x.scope==="EveryAreaLead"?"Area leads":"Area"}}}if(x.itemType==="Checkpoint"){if(A.type==="checkpoint"&&(x.ids.includes(A.locationId)||x.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint"};if(A.type==="area"&&A.checkpointIds.some(R=>x.ids.includes(R)||x.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint in area"}}if(x.itemType==="Marshal"){if(A.type==="marshal"&&(x.ids.includes(A.marshalId)||x.ids.includes("ALL_MARSHALS")))return{matched:!0,scope:"Marshal"};if(A.type==="checkpoint"){const D=o.assignments.filter(F=>F.locationId===A.locationId).map(F=>F.marshalId);if(x.ids.includes("ALL_MARSHALS")||D.some(F=>x.ids.includes(F)))return{matched:!0,scope:"Marshal at checkpoint"}}if(A.type==="area"&&(x.ids.includes("ALL_MARSHALS")||A.marshalIds.some(R=>x.ids.includes(R))))return{matched:!0,scope:"Marshal in area"}}if(A.type==="marshal"&&A.checkpointIds&&A.areaIds){if(x.itemType==="Checkpoint"&&(x.ids.includes("ALL_CHECKPOINTS")||A.checkpointIds.some(R=>x.ids.includes(R))))return{matched:!0,scope:"Assigned checkpoint"};if(x.itemType==="Area"&&(x.ids.includes("ALL_AREAS")||A.areaIds.some(R=>x.ids.includes(R))))return{matched:!0,scope:x.scope==="EveryAreaLead"?"Area lead":"Area"}}}return null},_=V(()=>{const E=o.allNotes||a.value;if(!E||E.length===0)return[];if(o.areaId&&o.allNotes){const A={type:"area",areaId:o.areaId,checkpointIds:d.value,marshalIds:p.value},x=[],D=new Set;for(const R of E){if(D.has(R.noteId))continue;const F=y(R,A);F&&(D.add(R.noteId),x.push({...R,matchedScope:F.scope}))}return x}if(o.locationId&&o.allNotes){const A={type:"checkpoint",locationId:o.locationId},x=[],D=new Set;for(const R of E){if(D.has(R.noteId))continue;const F=y(R,A);F&&(D.add(R.noteId),x.push({...R,matchedScope:F.scope}))}return x}if(o.marshalId&&o.allNotes){const A=f(o.marshalId),x=g(o.marshalId),D={type:"marshal",marshalId:o.marshalId,checkpointIds:A,areaIds:x},R=[],F=new Set;for(const T of E){if(F.has(T.noteId))continue;const N=y(T,D);N&&(F.add(T.noteId),R.push({...T,matchedScope:N.scope}))}return R}return E}),k=V(()=>{const E={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return[..._.value].sort((A,x)=>{if(A.isPinned!==x.isPinned)return A.isPinned?-1:1;const D=E[A.priority]??2,R=E[x.priority]??2;return D!==R?D-R:A.displayOrder!==x.displayOrder?A.displayOrder-x.displayOrder:new Date(x.createdAt)-new Date(A.createdAt)})}),w=async()=>{if(o.allNotes===null&&o.eventId){s.value=!0,i.value=null;try{let E;o.marshalId?E=await Es.getMarshalNotes(o.eventId,o.marshalId):E=await Es.getByEvent(o.eventId),a.value=E.data||[]}catch(E){console.error("Failed to load notes:",E),i.value=E.response?.data?.message||"Failed to load notes"}finally{s.value=!1}}};qe(()=>[o.eventId,o.locationId,o.areaId,o.marshalId],()=>{o.allNotes===null&&w()},{immediate:!0});const S=E=>{if(!E)return"";const A=new Date(E),D=new Date-A,R=Math.floor(D/6e4),F=Math.floor(D/36e5),T=Math.floor(D/864e5);return R<1?"just now":R<60?`${R}m ago`:F<24?`${F}h ago`:T<7?`${T}d ago`:A.toLocaleDateString()};return t({loadNotes:w}),(E,A)=>(v(),m("div",cE,[s.value?(v(),m("div",uE," Loading notes... ")):i.value?(v(),m("div",dE,[r("p",null,C(i.value),1),r("button",{onClick:w,class:"btn btn-secondary btn-small"}," Retry ")])):_.value.length===0?(v(),m("div",hE,[r("p",null,C(l.value),1)])):(v(),m("div",fE,[(v(!0),m(xe,null,Ne(k.value,x=>(v(),m("div",{key:x.noteId,class:de(["note-item",{pinned:x.isPinned}])},[r("div",pE,[r("div",vE,[x.isPinned?(v(),m("span",mE,"")):M("",!0),r("span",{class:de(["priority-indicator",(x.priority||"Normal").toLowerCase()])},null,2),r("strong",gE,C(x.title),1)]),r("div",yE,[x.category?(v(),m("span",kE,C(x.category),1)):M("",!0),r("span",{class:de(["priority-badge",(x.priority||"Normal").toLowerCase()])},C(x.priority||"Normal"),3)])]),x.content?(v(),m("div",_E,C(x.content),1)):M("",!0),r("div",bE,[r("span",wE," Created by "+C(x.createdByName||"Unknown")+"  "+C(S(x.createdAt)),1),x.matchedScope&&e.showScope?(v(),m("span",CE,C(x.matchedScope),1)):M("",!0)])],2))),128))]))]))}},gc=je(LE,[["__scopeId","data-v-9fdf0b0b"]]),SE={class:"checklist-preview"},xE={class:"preview-actions"},IE={class:"preview-header"},$E={key:0,class:"add-item-form"},TE=["placeholder"],ME=["disabled"],AE={key:1,class:"pending-items"},EE={class:"item-content"},PE={class:"item-header"},DE={class:"item-text"},RE={class:"item-scope"},OE=["onClick"],BE={key:2,class:"empty-state"},NE={key:0,class:"help-text"},FE={key:3,class:"checklist-items"},UE={class:"item-content"},zE={class:"item-header"},HE={class:"item-text"},VE={class:"item-scope"},GE=["title"],jE={key:0,class:"item-context"},ZE={__name:"ChecklistPreviewForLocation",props:{allChecklistItems:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=e,i=V(()=>s.checkpointTermSingular?s.checkpointTermSingular.toLowerCase():a.value.checkpoint),l=t,u=$(!1),d=$(""),p=$([...s.modelValue]);qe(()=>s.modelValue,x=>{p.value=[...x]},{deep:!0});const f=()=>{d.value.trim()&&(p.value.push({text:d.value.trim(),isNew:!0}),d.value="",u.value=!1,y())},g=x=>{p.value.splice(x,1),y()},y=()=>{l("update:modelValue",[...p.value]),l("change")},_=x=>{const D=x.scope,R=x.itemType,F=x.ids||[];return(D==="EveryoneAtCheckpoints"||D==="OnePerCheckpoint")&&R==="Checkpoint"?F.includes("ALL_CHECKPOINTS"):D==="OnePerCheckpoint"&&R==="Area"?F.includes("ALL_AREAS")?!0:F.some(T=>s.pendingAreaIds.includes(T)):(D==="EveryoneInAreas"||D==="OnePerArea"||D==="EveryAreaLead"||D==="OneLeadPerArea")&&R==="Area"?F.includes("ALL_AREAS")?!0:F.some(T=>s.pendingAreaIds.includes(T)):!1},k=V(()=>s.allChecklistItems.filter(x=>x.scopeConfigurations&&x.scopeConfigurations.length>0?x.scopeConfigurations.some(D=>_(D)):!1)),w=x=>({EveryoneAtCheckpoints:`All at ${a.value.checkpoints}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,EveryoneInAreas:`All in ${a.value.areas}`,OnePerArea:`One per ${a.value.area}`,EveryAreaLead:`${a.value.area} leads`,OneLeadPerArea:`One lead per ${a.value.area}`})[x]||x,S=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"Unknown";const D=x.scopeConfigurations.find(F=>_(F));if(!D)return w(x.scopeConfigurations[0].scope);const R=D.ids||[];return R.includes("ALL_CHECKPOINTS")?`All ${a.value.checkpoints}`:R.includes("ALL_AREAS")?`All ${a.value.areas}`:w(D.scope)},E=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"";const D=x.scopeConfigurations.find(F=>_(F));return D&&{EveryoneAtCheckpoints:`This item is for everyone at specified ${a.value.checkpoints}`,OnePerCheckpoint:`One person at each ${a.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${a.value.areas}`,OnePerArea:`One person in each ${a.value.area} needs to complete this`,EveryAreaLead:`This item is for ${a.value.area} leads only`,OneLeadPerArea:`One ${a.value.area} lead needs to complete this`}[D.scope]||""},A=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return null;const D=x.scopeConfigurations.find(T=>_(T));if(!D)return null;const R=D.itemType,F=D.ids||[];if(F.includes("ALL_CHECKPOINTS")||F.includes("ALL_AREAS"))return null;if(R==="Area"){const T=s.areas.filter(N=>F.includes(N.id)&&s.pendingAreaIds.includes(N.id)).map(N=>N.name);if(T.length>0)return`In: ${T.join(", ")}`}return null};return(x,D)=>(v(),m("div",SE,[r("div",xE,[r("p",IE,C(e.isEditing?`Add new ${O(a).checklist} for this ${i.value}:`:`${O(o).checklists} that will apply at this ${i.value}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:D[0]||(D[0]=R=>u.value=!u.value)},C(u.value?"Cancel":`Add ${O(a).checklist}`),1)]),u.value?(v(),m("div",$E,[Ue(r("input",{"onUpdate:modelValue":D[1]||(D[1]=R=>d.value=R),type:"text",placeholder:`Enter ${O(a).checklist} text...`,class:"add-item-input",onKeyup:ps(f,["enter"])},null,40,TE),[[st,d.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!d.value.trim(),onClick:f}," Add ",8,ME)])):M("",!0),p.value.length>0?(v(),m("div",AE,[(v(!0),m(xe,null,Ne(p.value,(R,F)=>(v(),m("div",{key:`pending-${F}`,class:"checklist-item pending"},[D[3]||(D[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",EE,[r("div",PE,[r("div",DE,C(R.text),1),r("div",RE,[D[2]||(D[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:T=>g(F),title:"Remove"},"  ",8,OE)])])])]))),128))])):M("",!0),!e.isEditing&&k.value.length===0&&p.value.length===0?(v(),m("div",BE,[r("p",null,"No "+C(O(a).checklists)+" will apply based on the current "+C(O(a).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),m("p",NE," Assign "+C(O(a).areas)+" to see relevant "+C(O(a).checklists)+". ",1)):M("",!0)])):M("",!0),!e.isEditing&&k.value.length>0?(v(),m("div",FE,[(v(!0),m(xe,null,Ne(k.value,R=>(v(),m("div",{key:R.id,class:"checklist-item"},[D[4]||(D[4]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",UE,[r("div",zE,[r("div",HE,C(R.text),1),r("div",VE,[r("span",{class:"scope-pill",title:E(R)},C(S(R)),9,GE)])]),A(R)?(v(),m("div",jE,C(A(R)),1)):M("",!0)])]))),128))])):M("",!0)]))}},qE=je(ZE,[["__scopeId","data-v-7d943b21"]]),WE={class:"notes-preview"},KE={class:"preview-actions"},JE={class:"preview-header"},YE={key:0,class:"add-item-form"},XE={class:"add-form-fields"},QE=["disabled"],e4={key:1,class:"pending-items"},t4={class:"note-header"},n4={class:"note-title"},o4={class:"note-actions"},s4=["onClick"],a4={key:0,class:"note-content"},i4={key:2,class:"empty-state"},l4={key:0,class:"help-text"},r4={key:3,class:"notes-list"},c4={class:"note-header"},u4={class:"note-title"},d4=["title"],h4={key:0,class:"note-content"},f4={key:1,class:"note-context"},p4={__name:"NotesPreviewForLocation",props:{allNotes:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ut(),a=e,s=t,i=V(()=>a.checkpointTermSingular?a.checkpointTermSingular.toLowerCase():o.value.checkpoint),l=$(!1),u=$(""),d=$(""),p=$([...a.modelValue]);qe(()=>a.modelValue,x=>{p.value=[...x]},{deep:!0});const f=()=>{!u.value.trim()&&!d.value.trim()||(p.value.push({title:u.value.trim(),content:d.value.trim(),isNew:!0}),u.value="",d.value="",l.value=!1,y())},g=x=>{p.value.splice(x,1),y()},y=()=>{s("update:modelValue",[...p.value]),s("change")},_=x=>{const D=x.scope,R=x.itemType,F=x.ids||[];return D==="EveryoneAtCheckpoints"&&R==="Checkpoint"?F.includes("ALL_CHECKPOINTS"):D==="EveryoneInAreas"&&R==="Area"?F.includes("ALL_AREAS")?!0:F.some(T=>a.pendingAreaIds.includes(T)):!1},k=V(()=>a.allNotes.filter(x=>x.scopeConfigurations&&x.scopeConfigurations.length>0?x.scopeConfigurations.some(D=>_(D)):!1)),w=x=>({EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[x]||x,S=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"Unknown";const D=x.scopeConfigurations.find(F=>_(F));if(!D)return w(x.scopeConfigurations[0].scope);const R=D.ids||[];return R.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:R.includes("ALL_AREAS")?`All ${o.value.areas}`:w(D.scope)},E=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"";const D=x.scopeConfigurations.find(F=>_(F));return D&&{EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[D.scope]||""},A=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return null;const D=x.scopeConfigurations.find(T=>_(T));if(!D)return null;const R=D.itemType,F=D.ids||[];if(F.includes("ALL_CHECKPOINTS")||F.includes("ALL_AREAS"))return null;if(R==="Area"){const T=a.areas.filter(N=>F.includes(N.id)&&a.pendingAreaIds.includes(N.id)).map(N=>N.name);if(T.length>0)return`In: ${T.join(", ")}`}return null};return(x,D)=>(v(),m("div",WE,[r("div",KE,[r("p",JE,C(e.isEditing?`Add new note for this ${i.value}:`:`Notes that will be visible at this ${i.value}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:D[0]||(D[0]=R=>l.value=!l.value)},C(l.value?"Cancel":"Add note"),1)]),l.value?(v(),m("div",YE,[r("div",XE,[Ue(r("input",{"onUpdate:modelValue":D[1]||(D[1]=R=>u.value=R),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[st,u.value]]),Ue(r("textarea",{"onUpdate:modelValue":D[2]||(D[2]=R=>d.value=R),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[st,d.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!u.value.trim()&&!d.value.trim(),onClick:f}," Add ",8,QE)])):M("",!0),p.value.length>0?(v(),m("div",e4,[(v(!0),m(xe,null,Ne(p.value,(R,F)=>(v(),m("div",{key:`pending-${F}`,class:"note-item pending"},[r("div",t4,[r("span",n4,C(R.title||"Untitled"),1),r("div",o4,[D[3]||(D[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:T=>g(F),title:"Remove"},"  ",8,s4)])]),R.content?(v(),m("div",a4,C(R.content),1)):M("",!0)]))),128))])):M("",!0),!e.isEditing&&k.value.length===0&&p.value.length===0?(v(),m("div",i4,[r("p",null,"No notes will apply based on the current "+C(O(o).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),m("p",l4," Assign "+C(O(o).areas)+" to see relevant notes. ",1)):M("",!0)])):M("",!0),!e.isEditing&&k.value.length>0?(v(),m("div",r4,[(v(!0),m(xe,null,Ne(k.value,R=>(v(),m("div",{key:R.id,class:"note-item"},[r("div",c4,[r("span",u4,C(R.title||"Untitled"),1),r("span",{class:"scope-pill",title:E(R)},C(S(R)),9,d4)]),R.content?(v(),m("div",h4,C(R.content),1)):M("",!0),A(R)?(v(),m("div",f4,C(A(R)),1)):M("",!0)]))),128))])):M("",!0)]))}},v4=je(p4,[["__scopeId","data-v-71646c3f"]]),m4={class:"base-modal-title modal-title-with-icon"},g4=["innerHTML"],y4={key:7,class:"tab-content appearance-tab"},k4={class:"accordion-item"},_4=["innerHTML"],b4={class:"accordion-title"},w4={class:"accordion-arrow"},C4={key:0,class:"accordion-content"},L4={class:"section-description"},S4={class:"accordion-item"},x4={class:"accordion-preview"},I4={class:"accordion-arrow"},$4={key:0,class:"accordion-content"},T4={class:"section-description"},M4={class:"terminology-row"},A4={class:"terminology-field"},E4=["value"],P4={value:""},D4=["value"],R4={class:"terminology-field"},O4=["value"],B4={value:""},N4=["value"],F4={key:8,class:"tab-content incidents-tab"},U4={class:"incidents-list"},z4={class:"custom-footer"},H4={class:"footer-left"},lf="edit_location_accordion",V4={__name:"EditLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:null},assignments:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventDate:{type:String,default:""},areas:{type:Array,default:()=>[]},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},availableMarshals:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},zIndex:{type:Number,default:1e3},incidents:{type:Array,default:()=>[]},lockedFromMarshal:{type:Boolean,default:!1}},emits:["close","save","delete","move-location","toggle-check-in","remove-assignment","open-assign-modal","update:isDirty","select-incident","select-marshal"],setup(e,{emit:t}){const{terms:o}=ut(),a=e,s=t,i=$("details"),l=$(!1),u=$(null),d=$(null),p=$([]),f=$([]),g=$([]),y=$({id:null,name:"",description:"",what3Words:"",latitude:0,longitude:0,requiredMarshals:1,useCustomTimes:!1,startTime:"",endTime:"",areaIds:[],styleType:"default",styleColor:"",styleBackgroundShape:"",styleBackgroundColor:"",styleBorderColor:"",styleIconColor:"",styleSize:"",styleMapRotation:"",peopleTerm:"",checkpointTerm:"",isDynamic:!1,locationUpdateScopeConfigurations:[]}),_=()=>a.eventId?`${lf}_${a.eventId}`:lf,k=$({iconStyle:!1,terminology:!1});nn(()=>{const le=localStorage.getItem(_());if(le)try{const J=JSON.parse(le);k.value={...k.value,...J}}catch{}});const w=le=>{k.value[le]=!k.value[le],localStorage.setItem(_(),JSON.stringify(k.value))},S=V(()=>{const le=y.value.areaIds||[];if(le.length>0){const J=a.areas.filter(j=>le.includes(j.id)&&j.peopleTerm).sort((j,te)=>(j.checkpointCount||0)-(te.checkpointCount||0));if(J.length>0)return J[0].peopleTerm}return a.eventPeopleTerm||"Marshals"}),E=V(()=>y.value.peopleTerm?y.value.peopleTerm:S.value),A=V(()=>{const le=y.value.areaIds||[];if(le.length>0){const J=a.areas.filter(j=>le.includes(j.id)&&j.checkpointTerm).sort((j,te)=>(j.checkpointCount||0)-(te.checkpointCount||0));if(J.length>0)return J[0].checkpointTerm}return o.value.checkpoint});V(()=>A.value.toLowerCase());const x=V(()=>{const le=y.value.checkpointTerm||a.location?.checkpointTerm||a.location?.CheckpointTerm;if(le)return Ja("checkpoint",le,E.value);const J=y.value.areaIds||[];let j=null;if(J.length>0){const te=a.areas.filter(Re=>J.includes(Re.id)&&Re.checkpointTerm).sort((Re,Se)=>(Re.checkpointCount||0)-(Se.checkpointCount||0));te.length>0&&(j=te[0].checkpointTerm)}return j?Ja("checkpoint",j,E.value):o.value.checkpoint}),D=V(()=>x.value.toLowerCase()),R=V(()=>{const le=E.value;return Ja("people",le)});V(()=>R.value.toLowerCase());const F=V(()=>o.value.area);V(()=>F.value.toLowerCase());const T=V(()=>o.value.area),N=V(()=>T.value.toLowerCase()),B=V(()=>o.value.areas),q=V(()=>!!(a.location&&a.location.id)),P=V(()=>q.value?`Edit ${D.value}: ${a.location?.name||""}`:`Add ${D.value}`),G=V(()=>{const le=[{value:"details",label:"Details",icon:"details"},{value:"location",label:"Location",icon:"location"},{value:"marshals",label:E.value,icon:"marshal"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return a.incidents&&a.incidents.length>0&&le.push({value:"incidents",label:"Incidents",icon:"incidents"}),le}),X=V(()=>G.value.findIndex(le=>le.value===i.value)),ne=V(()=>X.value===G.value.length-1),K=V(()=>{const le=y.value.areaIds||[],J=a.areas.filter(Be=>le.includes(Be.id)).sort((Be,Xe)=>(Be.checkpointCount||0)-(Xe.checkpointCount||0)),j=(Be,Xe)=>{for(const mt of J){const _t=Be(mt);if(_t&&_t!=="default")return{value:_t,source:"area"}}return Xe&&Xe!=="default"?{value:Xe,source:"event"}:{value:"",source:"none"}},te=j(Be=>Be.checkpointStyleType||Be.CheckpointStyleType,a.eventDefaultStyleType),Re=j(Be=>Be.checkpointStyleColor||Be.CheckpointStyleColor,a.eventDefaultStyleColor),Se=j(Be=>Be.checkpointStyleBackgroundShape||Be.CheckpointStyleBackgroundShape,a.eventDefaultStyleBackgroundShape),we=j(Be=>Be.checkpointStyleBackgroundColor||Be.CheckpointStyleBackgroundColor||Be.checkpointStyleColor||Be.CheckpointStyleColor,a.eventDefaultStyleBackgroundColor||a.eventDefaultStyleColor),ge=j(Be=>Be.checkpointStyleBorderColor||Be.CheckpointStyleBorderColor,a.eventDefaultStyleBorderColor),Z=j(Be=>Be.checkpointStyleIconColor||Be.CheckpointStyleIconColor,a.eventDefaultStyleIconColor),se=j(Be=>Be.checkpointStyleSize||Be.CheckpointStyleSize,a.eventDefaultStyleSize),ce=j(Be=>Be.checkpointStyleMapRotation??Be.CheckpointStyleMapRotation,a.eventDefaultStyleMapRotation),Oe=[te,Se,we,ge,Z,se,ce].some(Be=>Be.source==="area");return{type:te.value||"default",color:Re.value,backgroundShape:Se.value,backgroundColor:we.value,borderColor:ge.value,iconColor:Z.value,size:se.value,mapRotation:ce.value,source:Oe?"area":te.value?"event":"none"}}),Q=V(()=>K.value.source==="area"?`${T.value} default`:"Event default"),he=V(()=>{const le=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:K.value.type,J=y.value.styleBackgroundShape||K.value.backgroundShape||"circle",j=y.value.styleBackgroundColor||K.value.backgroundColor||"#667eea",te=y.value.styleBorderColor||K.value.borderColor||"#ffffff",Re=y.value.styleIconColor||K.value.iconColor||"#ffffff";return Cn({type:le||"circle",backgroundShape:J,backgroundColor:j,borderColor:te,iconColor:Re,size:"100"})}),U=V(()=>{let le,J,j,te,Re;return q.value&&a.location?(le=a.location.resolvedStyleType||a.location.ResolvedStyleType,J=a.location.resolvedStyleBackgroundShape||a.location.ResolvedStyleBackgroundShape||"circle",j=a.location.resolvedStyleBackgroundColor||a.location.ResolvedStyleBackgroundColor||a.location.resolvedStyleColor||a.location.ResolvedStyleColor||"#667eea",te=a.location.resolvedStyleBorderColor||a.location.ResolvedStyleBorderColor||"#ffffff",Re=a.location.resolvedStyleIconColor||a.location.ResolvedStyleIconColor||"#ffffff"):(le=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:K.value.type,J=y.value.styleBackgroundShape||K.value.backgroundShape||"circle",j=y.value.styleBackgroundColor||K.value.backgroundColor||"#667eea",te=y.value.styleBorderColor||K.value.borderColor||"#ffffff",Re=y.value.styleIconColor||K.value.iconColor||"#ffffff"),Cn({type:le||"circle",backgroundShape:J,backgroundColor:j,borderColor:te,iconColor:Re,size:"100",outputSize:28})}),ee=V(()=>{const le=!!y.value.checkpointTerm,J=!!y.value.peopleTerm;return le&&J?`${Ja("checkpoint",y.value.checkpointTerm,y.value.peopleTerm)}, ${y.value.peopleTerm}`:le?Ja("checkpoint",y.value.checkpointTerm,E.value):J?y.value.peopleTerm:"Using defaults"}),fe=V(()=>ne.value?null:G.value[X.value+1]),ue=V(()=>fe.value?`${fe.value.label}...`:""),De=$(!1),et=$(null);qe(()=>a.location,le=>{if(le){const J=le.id||"new";if(et.value!==J){et.value=J,De.value=!0;let j="",te="";le.startTime&&(j=Bl(le.startTime)),le.endTime&&(te=Bl(le.endTime)),y.value={id:le.id||null,name:le.name||"",description:le.description||"",what3Words:le.what3Words||"",latitude:le.latitude||0,longitude:le.longitude||0,requiredMarshals:le.requiredMarshals||1,useCustomTimes:!!(le.startTime||le.endTime),startTime:j,endTime:te,areaIds:le.areaIds||le.AreaIds||[],styleType:le.styleType||le.StyleType||"default",styleColor:le.styleColor||le.StyleColor||"",styleBackgroundShape:le.styleBackgroundShape||le.StyleBackgroundShape||"",styleBackgroundColor:le.styleBackgroundColor||le.StyleBackgroundColor||"",styleBorderColor:le.styleBorderColor||le.StyleBorderColor||"",styleIconColor:le.styleIconColor||le.StyleIconColor||"",styleSize:le.styleSize||le.StyleSize||"",styleMapRotation:le.styleMapRotation??le.StyleMapRotation??"",peopleTerm:le.peopleTerm||"",checkpointTerm:le.checkpointTerm||"",isDynamic:le.isDynamic||!1,locationUpdateScopeConfigurations:le.locationUpdateScopeConfigurations||[]}}}},{immediate:!0,deep:!0}),qe(()=>a.show,le=>{le?(i.value="details",l.value=!1,p.value=[],f.value=[],g.value=[],u.value?.clearPendingChanges&&u.value.clearPendingChanges(),d.value?.resetLocalState&&d.value.resetLocalState()):(et.value=null,De.value=!1)});const Je=le=>{y.value=le},Ze=()=>{s("update:isDirty",!0)},He=()=>{l.value=!l.value,s("move-location",{isMoving:l.value,formData:{...y.value}})},be=le=>{p.value=le,Ze()},Ve=()=>{fe.value&&(i.value=fe.value.value)},ve=()=>{const le={...y.value,startTime:y.value.useCustomTimes&&y.value.startTime?new Date(y.value.startTime).toISOString():null,endTime:y.value.useCustomTimes&&y.value.endTime?new Date(y.value.endTime).toISOString():null,checkInChanges:u.value?.getPendingChanges?.()||[],assignmentsToRemove:u.value?.getMarkedForRemoval?.()||[],checklistChanges:p.value||[],pendingAssignments:a.assignments.filter(J=>J.isPending).map(J=>({marshalId:J.marshalId})),pendingNewChecklistItems:f.value,pendingNewNotes:g.value};s("save",le)},Le=()=>{a.location&&a.location.id&&s("delete",a.location.id)},Pe=le=>{s("remove-assignment",le)},W=()=>{s("open-assign-modal")},Y=le=>{s("select-marshal",le)},pe=()=>{s("close")},Ce=(le,J)=>{y.value[le]=J,Ze()};return(le,J)=>(v(),We(Gt,{show:e.show,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:pe},{header:ze(()=>[r("h2",m4,[U.value?(v(),m("span",{key:0,class:"modal-title-icon",innerHTML:U.value},null,8,g4)):M("",!0),Ye(" "+C(P.value),1)])]),"tab-header":ze(()=>[Ae(qi,{modelValue:i.value,"onUpdate:modelValue":J[0]||(J[0]=j=>i.value=j),tabs:G.value},null,8,["modelValue","tabs"])]),footer:ze(()=>[r("div",z4,[r("div",H4,[q.value&&!e.lockedFromMarshal?(v(),m("button",{key:0,type:"button",onClick:Le,class:"btn btn-danger"}," Delete ")):M("",!0),!q.value&&!ne.value?(v(),m("button",{key:1,type:"button",onClick:Ve,class:"btn btn-secondary mobile-only"},C(ue.value),1)):M("",!0)]),r("button",{type:"button",onClick:ve,class:"btn btn-success"}," Save ")])]),default:ze(()=>[i.value==="details"?(v(),We(QT,{key:0,form:y.value,areas:e.areas,"event-date":e.eventDate,"area-term-singular":T.value,"area-term-plural":B.value,"checkpoint-term-singular":x.value,"people-term-plural":E.value,"onUpdate:form":Je,onInput:Ze,onSave:ve},null,8,["form","areas","event-date","area-term-singular","area-term-plural","checkpoint-term-singular","people-term-plural"])):M("",!0),i.value==="location"?(v(),We(aA,{key:1,form:y.value,"is-moving":l.value,"checkpoint-term-singular":x.value,"people-term-plural":E.value,areas:e.areas,locations:e.allLocations,marshals:e.availableMarshals,"is-editing":q.value,"onUpdate:form":Je,onInput:Ze,onSave:ve,onMoveLocation:He},null,8,["form","is-moving","checkpoint-term-singular","people-term-plural","areas","locations","marshals","is-editing"])):M("",!0),i.value==="marshals"?(v(),We(MA,{key:2,ref_key:"assignmentsTabRef",ref:u,form:y.value,assignments:e.assignments,"people-term":E.value,"person-term":R.value,"checkpoint-term":x.value,"read-only":e.lockedFromMarshal,"onUpdate:form":Je,onInput:Ze,onRemoveAssignment:Pe,onOpenAssignModal:W,onSelectMarshal:Y},null,8,["form","assignments","people-term","person-term","checkpoint-term","read-only"])):M("",!0),i.value==="checklists"&&q.value?(v(),We(Xv,{key:3,ref_key:"checklistTabRef",ref:d,modelValue:p.value,"onUpdate:modelValue":J[1]||(J[1]=j=>p.value=j),"event-id":e.eventId,"location-id":e.location.id,locations:e.allLocations,areas:e.areas,assignments:e.assignments,onChange:be},null,8,["modelValue","event-id","location-id","locations","areas","assignments"])):M("",!0),i.value==="checklists"?(v(),We(qE,{key:4,modelValue:f.value,"onUpdate:modelValue":J[2]||(J[2]=j=>f.value=j),"all-checklist-items":e.allChecklistItems,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":q.value,"checkpoint-term-singular":x.value,onChange:Ze},null,8,["modelValue","all-checklist-items","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):M("",!0),i.value==="notes"&&q.value?(v(),We(gc,{key:5,"event-id":e.eventId,"location-id":e.location?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","location-id","all-notes","locations","areas","assignments"])):M("",!0),i.value==="notes"?(v(),We(v4,{key:6,modelValue:g.value,"onUpdate:modelValue":J[3]||(J[3]=j=>g.value=j),"all-notes":e.notes,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":q.value,"checkpoint-term-singular":x.value,onChange:Ze},null,8,["modelValue","all-notes","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):M("",!0),i.value==="appearance"?(v(),m("div",y4,[r("div",k4,[r("button",{type:"button",class:de(["accordion-header",{expanded:k.value.iconStyle}]),onClick:J[4]||(J[4]=j=>w("iconStyle"))},[r("div",{class:"accordion-icon",innerHTML:he.value},null,8,_4),r("span",b4,C(x.value)+" marker style",1),r("span",w4,C(k.value.iconStyle?"":""),1)],2),k.value.iconStyle?(v(),m("div",C4,[r("p",L4," Choose a custom icon for this "+C(D.value)+", or leave as Default to inherit from "+C(N.value)+" or event settings. ",1),Ae(ad,{"style-type":y.value.styleType||"default","style-color":y.value.styleColor||"","style-background-shape":y.value.styleBackgroundShape||"","style-background-color":y.value.styleBackgroundColor||"","style-border-color":y.value.styleBorderColor||"","style-icon-color":y.value.styleIconColor||"","style-size":y.value.styleSize||"","style-map-rotation":y.value.styleMapRotation??"","inherited-style-type":K.value.type,"inherited-style-color":K.value.color,"inherited-background-shape":K.value.backgroundShape||"","inherited-background-color":K.value.backgroundColor||K.value.color||"","inherited-border-color":K.value.borderColor||"","inherited-icon-color":K.value.iconColor||"","inherited-size":K.value.size||"","inherited-map-rotation":K.value.mapRotation??"","default-label":Q.value,"icon-label":"Marker style",level:"checkpoint","show-preview":!0,"onUpdate:styleType":J[5]||(J[5]=j=>Ce("styleType",j)),"onUpdate:styleColor":J[6]||(J[6]=j=>Ce("styleColor",j)),"onUpdate:styleBackgroundShape":J[7]||(J[7]=j=>Ce("styleBackgroundShape",j)),"onUpdate:styleBackgroundColor":J[8]||(J[8]=j=>Ce("styleBackgroundColor",j)),"onUpdate:styleBorderColor":J[9]||(J[9]=j=>Ce("styleBorderColor",j)),"onUpdate:styleIconColor":J[10]||(J[10]=j=>Ce("styleIconColor",j)),"onUpdate:styleSize":J[11]||(J[11]=j=>Ce("styleSize",j)),"onUpdate:styleMapRotation":J[12]||(J[12]=j=>Ce("styleMapRotation",j))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation","default-label"])])):M("",!0)]),r("div",S4,[r("button",{type:"button",class:de(["accordion-header",{expanded:k.value.terminology}]),onClick:J[13]||(J[13]=j=>w("terminology"))},[J[17]||(J[17]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("circle",{cx:"9",cy:"8",r:"3",fill:"#6366F1"}),r("path",{d:"M3 18c0-3.3 2.7-6 6-6s6 2.7 6 6",fill:"#6366F1",opacity:"0.5"}),r("circle",{cx:"17",cy:"14",r:"5",fill:"#10B981",opacity:"0.3"}),r("circle",{cx:"17",cy:"14",r:"3",fill:"#10B981"}),r("circle",{cx:"17",cy:"14",r:"1",fill:"white"})])],-1)),J[18]||(J[18]=r("span",{class:"accordion-title"},"Terminology",-1)),r("span",x4,C(ee.value),1),r("span",I4,C(k.value.terminology?"":""),1)],2),k.value.terminology?(v(),m("div",$4,[r("p",T4," Customise what this "+C(D.value)+" and its "+C(E.value.toLowerCase())+" are called. ",1),r("div",M4,[r("div",A4,[r("label",null,"What is this "+C(D.value)+" called?",1),r("select",{value:y.value.checkpointTerm,class:"form-input",onChange:J[14]||(J[14]=j=>{Je({...y.value,checkpointTerm:j.target.value}),Ze()})},[r("option",P4,"Use "+C(N.value)+" default ("+C(x.value)+")",1),J[19]||(J[19]=r("option",{value:"Vehicle"},"Vehicle",-1)),J[20]||(J[20]=r("option",{value:"Car"},"Car",-1)),J[21]||(J[21]=r("option",{value:"Bike"},"Bike",-1)),(v(!0),m(xe,null,Ne(O(Os).checkpoint,j=>(v(),m("option",{key:j,value:j},C(j),9,D4))),128))],40,E4)]),r("div",R4,[r("label",null,"What are "+C(E.value.toLowerCase())+" called here?",1),r("select",{value:y.value.peopleTerm,class:"form-input",onChange:J[15]||(J[15]=j=>{Je({...y.value,peopleTerm:j.target.value}),Ze()})},[r("option",B4,"Use "+C(N.value)+" default ("+C(S.value)+")",1),(v(!0),m(xe,null,Ne(O(Os).people,j=>(v(),m("option",{key:j,value:j},C(j),9,N4))),128))],40,O4)])])])):M("",!0)])])):M("",!0),i.value==="incidents"?(v(),m("div",F4,[r("div",U4,[(v(!0),m(xe,null,Ne(e.incidents,j=>(v(),We(Wl,{key:j.incidentId,incident:j,onSelect:J[16]||(J[16]=te=>le.$emit("select-incident",te))},null,8,["incident"]))),128))])])):M("",!0)]),_:1},8,["show","is-dirty","z-index"]))}},G4=je(V4,[["__scopeId","data-v-61f1a81f"]]),j4={class:"tab-content"},Z4={key:0,class:"error-banner"},q4=["value"],W4={key:0,class:"field-error"},K4={class:"contact-row"},J4=["value"],Y4={key:0,class:"field-error"},X4=["value"],Q4={key:0,class:"field-error"},e3=["value"],t3={key:0,class:"field-error"},n3={key:1,class:"magic-link-section"},o3={key:0,class:"loading-text"},s3={key:1,class:"magic-link-container"},a3={class:"magic-link-row"},i3=["value"],l3={key:0,class:"error-text"},r3={key:1,class:"magic-link-actions"},c3=["disabled"],u3={key:2,class:"success-text"},d3={key:3,class:"error-text"},h3={key:2,class:"error-text"},f3={__name:"MarshalDetailsTab",props:{form:{type:Object,required:!0},eventId:{type:String,default:null},marshalId:{type:String,default:null},validationErrors:{type:Object,default:()=>({})}},emits:["update:form","input"],setup(e,{expose:t,emit:o}){const a=e,s=o,i=$(null),l=$(null),u=$(null),d=$(null),p=$(""),f=$(!1),g=$(!1),y=$(""),_=$(!1),k=$(!1),w=$(!1),S=$(""),E=(T,N)=>{s("update:form",{...a.form,[T]:N}),s("input")},A=async()=>{if(!(!a.eventId||!a.marshalId)){g.value=!0,y.value="";try{const T=await ms.getMagicLink(a.eventId,a.marshalId);p.value=T.data.magicLink,f.value=T.data.hasEmail}catch(T){console.error("Failed to fetch magic link:",T),y.value="Failed to load login link"}finally{g.value=!1}}},x=$(""),D=async()=>{x.value="";try{if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(p.value),_.value=!0,setTimeout(()=>{_.value=!1},2e3);return}}catch(T){console.warn("Clipboard API failed, trying fallback:",T)}try{const T=document.createElement("textarea");T.value=p.value,T.style.position="fixed",T.style.left="-9999px",T.style.top="0",document.body.appendChild(T),T.focus(),T.select();const N=document.execCommand("copy");document.body.removeChild(T),N?(_.value=!0,setTimeout(()=>{_.value=!1},2e3)):(x.value="Copy failed. Please select and copy the link manually.",setTimeout(()=>{x.value=""},4e3))}catch(T){console.error("Fallback copy failed:",T),x.value="Copy not supported. Please select and copy the link manually.",setTimeout(()=>{x.value=""},4e3)}},R=async()=>{if(!(!a.eventId||!a.marshalId)){k.value=!0,w.value=!1,S.value="";try{await ms.sendMagicLink(a.eventId,a.marshalId),w.value=!0,setTimeout(()=>{w.value=!1},3e3)}catch(T){console.error("Failed to send email:",T),S.value=T.response?.data?.message||"Failed to send email"}finally{k.value=!1}}};return qe(()=>a.marshalId,T=>{T?A():(p.value="",f.value=!1)},{immediate:!0}),t({focusField:T=>{cn(()=>{const B={name:i,email:l,phoneNumber:u,notes:d}[T];B?.value&&(B.value.focus(),B.value.scrollIntoView({behavior:"smooth",block:"center"}))})}}),(T,N)=>(v(),m("div",j4,[e.validationErrors.general?(v(),m("div",Z4,C(e.validationErrors.general),1)):M("",!0),r("div",{class:de(["form-group",{"has-error":e.validationErrors.name}])},[N[5]||(N[5]=r("label",null,"Name *",-1)),r("input",{ref_key:"nameInputRef",ref:i,value:e.form.name,onInput:N[0]||(N[0]=B=>E("name",B.target.value)),type:"text",required:"",class:de(["form-input",{"input-error":e.validationErrors.name}])},null,42,q4),e.validationErrors.name?(v(),m("span",W4,C(e.validationErrors.name),1)):M("",!0)],2),r("div",K4,[r("div",{class:de(["form-group contact-email",{"has-error":e.validationErrors.email}])},[N[6]||(N[6]=r("label",null,"Email",-1)),r("input",{ref_key:"emailInputRef",ref:l,value:e.form.email,onInput:N[1]||(N[1]=B=>E("email",B.target.value)),type:"email",class:de(["form-input",{"input-error":e.validationErrors.email}])},null,42,J4),e.validationErrors.email?(v(),m("span",Y4,C(e.validationErrors.email),1)):M("",!0)],2),r("div",{class:de(["form-group contact-phone",{"has-error":e.validationErrors.phoneNumber}])},[N[7]||(N[7]=r("label",null,"Phone number",-1)),r("input",{ref_key:"phoneInputRef",ref:u,value:e.form.phoneNumber,onInput:N[2]||(N[2]=B=>E("phoneNumber",B.target.value)),type:"tel",class:de(["form-input",{"input-error":e.validationErrors.phoneNumber}])},null,42,X4),e.validationErrors.phoneNumber?(v(),m("span",Q4,C(e.validationErrors.phoneNumber),1)):M("",!0)],2)]),r("div",{class:de(["form-group",{"has-error":e.validationErrors.notes}])},[N[8]||(N[8]=r("label",null,"Notes",-1)),r("textarea",{ref_key:"notesInputRef",ref:d,value:e.form.notes,onInput:N[3]||(N[3]=B=>E("notes",B.target.value)),class:de(["form-input",{"input-error":e.validationErrors.notes}]),rows:"3",placeholder:"e.g., Needs to leave by 11am"},null,42,e3),e.validationErrors.notes?(v(),m("span",t3,C(e.validationErrors.notes),1)):M("",!0)],2),e.marshalId?(v(),m("div",n3,[N[9]||(N[9]=r("label",null,"Login link",-1)),N[10]||(N[10]=r("p",{class:"help-text"},"Share this unique link with the marshal so they can access their dashboard.",-1)),g.value?(v(),m("div",o3,"Loading link...")):p.value?(v(),m("div",s3,[r("div",a3,[r("input",{type:"text",value:p.value,readonly:"",class:"form-input magic-link-input",onFocus:N[4]||(N[4]=B=>B.target.select())},null,40,i3),r("button",{type:"button",class:"btn btn-secondary",onClick:D},C(_.value?"Copied!":"Copy link"),1)]),x.value?(v(),m("p",l3,C(x.value),1)):M("",!0),f.value?(v(),m("div",r3,[r("button",{type:"button",class:"btn btn-primary",disabled:k.value,onClick:R},C(k.value?"Sending...":"Send via email"),9,c3)])):M("",!0),w.value?(v(),m("p",u3,"Email sent successfully!")):M("",!0),S.value?(v(),m("p",d3,C(S.value),1)):M("",!0)])):y.value?(v(),m("div",h3,C(y.value),1)):M("",!0)])):M("",!0)]))}},p3=je(f3,[["__scopeId","data-v-16ffb81b"]]),v3={class:"card-header"},m3={class:"checkpoint-name-row"},g3=["innerHTML"],y3={class:"checkpoint-name"},k3={key:0,class:"checkpoint-description"},_3={key:0,class:"card-areas"},b3={key:1,class:"card-check-in"},w3={key:0,class:"check-in-time"},C3={key:0,class:"check-in-method"},L3={key:1,class:"unsaved-indicator"},S3={key:2,class:"card-locked"},x3={class:"locked-badge"},I3={key:3,class:"card-badge"},$3={key:4,class:"card-badge"},T3={__name:"MarshalCheckpointCard",props:{assignment:{type:Object,required:!0},location:{type:Object,default:null},areas:{type:Array,default:()=>[]},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isLocked:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1}},emits:["click","toggle-check-in","remove","undo-remove"],setup(e,{emit:t}){const{termsLower:o}=ut(),a=e,s=t,i=V(()=>a.location?a.location.areaIds||a.location.AreaIds||[]:[]),l=V(()=>i.value.map(_=>{const k=a.areas.find(w=>w.id===_);return k?k.name:null}).filter(Boolean)),u=V(()=>i.value.map(_=>{const k=a.areas.find(w=>w.id===_);return k?k.color:"#999"})),d=V(()=>{if(!a.location)return"#667eea";const _=a.location,k=_.resolvedStyleBackgroundColor||_.ResolvedStyleBackgroundColor||_.resolvedStyleColor||_.ResolvedStyleColor;if(k)return k;if(i.value.length>0){const w=a.areas.find(S=>S.id===i.value[0]);if(w)return w.color}return"#667eea"}),p=V(()=>{if(!a.location)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
    </svg>`;const _=a.location,k=_.resolvedStyleType||_.ResolvedStyleType,w=_.resolvedStyleBackgroundColor||_.ResolvedStyleBackgroundColor||_.resolvedStyleColor||_.ResolvedStyleColor,S=_.resolvedStyleBorderColor||_.ResolvedStyleBorderColor,E=_.resolvedStyleIconColor||_.ResolvedStyleIconColor,A=_.resolvedStyleBackgroundShape||_.ResolvedStyleBackgroundShape;return k&&k!=="default"||w||S||E||A&&A!=="circle"?Cn({type:k||"circle",backgroundShape:A||"circle",backgroundColor:w||"#667eea",borderColor:S||"#ffffff",iconColor:E||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),f=_=>_?new Date(_).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",g=V(()=>{const{checkedInBy:_,checkInMethod:k,marshalName:w}=a.assignment;return _&&_!==w?_:k||""}),y=()=>{!a.assignment.isPending&&!a.isMarkedForRemoval&&!a.isLocked&&s("click",a.assignment)};return(_,k)=>(v(),m("div",{class:de(["marshal-checkpoint-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-locked":e.isLocked}]),style:Qe({borderLeftColor:e.isMarkedForRemoval?void 0:d.value})},[r("div",v3,[r("div",{class:"card-title",onClick:y},[r("span",m3,[r("span",{class:"checkpoint-icon",innerHTML:p.value},null,8,g3),r("span",y3,C(e.assignment.locationName),1),e.assignment.locationDescription?(v(),m("span",k3,"  "+C(e.assignment.locationDescription),1)):M("",!0)])]),!e.isLocked&&!e.isMarkedForRemoval?(v(),m("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:k[0]||(k[0]=rt(w=>_.$emit("remove",e.assignment),["stop"]))},"  ")):M("",!0),e.isMarkedForRemoval?(v(),m("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:k[1]||(k[1]=rt(w=>_.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):M("",!0)]),l.value.length>0&&!e.isMarkedForRemoval?(v(),m("div",_3,[(v(!0),m(xe,null,Ne(l.value,(w,S)=>(v(),m("span",{key:S,class:"area-badge",style:Qe({backgroundColor:u.value[S]})},C(w),5))),128))])):M("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.isLocked?(v(),m("div",b3,[r("button",{class:de(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:k[2]||(k[2]=w=>_.$emit("toggle-check-in",e.assignment))},[...k[3]||(k[3]=[r("span",{class:"toggle-icon"},"",-1),r("span",{class:"toggle-label-wrapper"},[r("span",{class:"toggle-label toggle-label-check-in"},"Check in"),r("span",{class:"toggle-label toggle-label-checked-in"},"Checked in")],-1)])],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(v(),m("span",w3,[Ye(C(f(e.assignment.checkInTime))+" ",1),g.value?(v(),m("span",C3,"("+C(g.value)+")",1)):M("",!0)])):e.hasUnsavedChanges?(v(),m("span",L3," Unsaved ")):M("",!0)])):M("",!0),e.isLocked&&!e.isMarkedForRemoval?(v(),m("div",S3,[r("span",x3,"Viewing from this "+C(O(o).checkpoint),1)])):M("",!0),e.assignment.isPending?(v(),m("div",I3,[...k[4]||(k[4]=[r("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):M("",!0),e.isMarkedForRemoval?(v(),m("div",$3,[...k[5]||(k[5]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):M("",!0)],6))}},M3=je(T3,[["__scopeId","data-v-df38bf23"]]),A3={class:"tab-content"},E3={key:0,class:"read-only-notice"},P3={class:"section-title"},D3={key:1,class:"form-group",style:{"margin-top":"1.5rem"}},R3={value:""},O3=["value"],B3={__name:"MarshalCheckpointsTab",props:{assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isNewMarshal:{type:Boolean,default:!1},lockedCheckpointId:{type:String,default:null}},emits:["input","remove-assignment","assign-to-location","select-checkpoint"],setup(e,{expose:t,emit:o}){const{termsLower:a}=ut(),s=e,i=o,{pendingCheckInChanges:l,getEffectiveCheckInStatus:u,handleToggleCheckIn:d}=Yv(()=>i("input")),p=$(""),f=$(new Set),g=V(()=>s.assignments?.length||0),y=R=>s.allLocations&&s.allLocations.find(F=>F.id===R)||null,_=V(()=>[...s.assignments].sort((R,F)=>(R.locationName||"").localeCompare(F.locationName||"",void 0,{numeric:!0,sensitivity:"base"}))),k=R=>f.value.has(R),w=R=>{R.isPending||i("select-checkpoint",R)},S=R=>{d(R)},E=R=>{R.isPending?i("remove-assignment",R):(f.value.add(R.id),i("input"))},A=R=>{f.value.delete(R.id),i("input")},x=V(()=>{const R=[...s.availableLocations];return R.sort((F,T)=>F.name.localeCompare(T.name,void 0,{numeric:!0,sensitivity:"base"})),R}),D=()=>{p.value&&(i("assign-to-location",p.value),p.value="")};return t({pendingCheckInChanges:l,clearPendingChanges:()=>{l.value.clear(),f.value.clear(),p.value=""},getPendingChanges:()=>Array.from(l.value.entries()).map(([R,F])=>({assignmentId:R,shouldBeCheckedIn:F})),getMarkedForRemoval:()=>Array.from(f.value)}),(R,F)=>(v(),m("div",A3,[e.lockedCheckpointId?(v(),m("div",E3," Viewing from "+C(O(a).checkpoint)+" - "+C(O(a).checkpoints)+" cannot be modified here. ",1)):M("",!0),r("h3",P3,"Assigned "+C(O(a).checkpoints)+" ("+C(g.value)+")",1),Ae(ql,{"is-empty":e.assignments.length===0,"empty-message":`No ${O(a).checkpoints} assigned yet.`,"empty-hint":e.lockedCheckpointId?"":`Use the dropdown below to assign this ${O(a).person} to ${O(a).checkpoints}.`},{default:ze(()=>[(v(!0),m(xe,null,Ne(_.value,T=>(v(),We(M3,{key:T.id,assignment:T,location:y(T.locationId),areas:e.areas,"effective-check-in-status":O(u)(T),"has-unsaved-changes":O(l).has(T.id),"is-locked":!!e.lockedCheckpointId,"is-marked-for-removal":k(T.id),onClick:w,onToggleCheckIn:S,onRemove:E,onUndoRemove:A},null,8,["assignment","location","areas","effective-check-in-status","has-unsaved-changes","is-locked","is-marked-for-removal"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),!e.lockedCheckpointId&&x.value.length>0?(v(),m("div",D3,[r("label",null,"Assign to "+C(O(a).checkpoint),1),Ue(r("select",{"onUpdate:modelValue":F[0]||(F[0]=T=>p.value=T),class:"form-input",onChange:D},[r("option",R3,"Select a "+C(O(a).checkpoint)+"...",1),(v(!0),m(xe,null,Ne(x.value,T=>(v(),m("option",{key:T.id,value:T.id},[Ye(C(T.name),1),T.description?(v(),m(xe,{key:0},[Ye(" - "+C(T.description),1)],64)):M("",!0)],8,O3))),128))],544),[[Bn,p.value]])])):M("",!0)]))}},N3=je(B3,[["__scopeId","data-v-f60fc06e"]]),F3={class:"marshal-checklist-view"},U3={key:0,class:"loading-state"},z3={key:1,class:"error-state"},H3={key:2,class:"empty-state"},V3={__name:"MarshalChecklistView",props:{eventId:{type:String,required:!0},marshalId:{type:String,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{termsLower:a}=ut(),s=e,i=o,l=$([]),u=$(!1),d=$(null),p=$(new Map),f=V(()=>l.value.map(w=>{const S=p.value.get(w.itemId),E=S!==void 0?S.complete:w.isCompleted,A=S!==void 0&&S.complete!==w.isCompleted;return{...w,localIsCompleted:E,isModified:A}})),g=async()=>{if(!(!s.eventId||!s.marshalId)){u.value=!0,d.value=null;try{const w=await Rt.getMarshalChecklist(s.eventId,s.marshalId);if(l.value=w.data||[],s.modelValue&&s.modelValue.length>0){const S=new Map;s.modelValue.forEach(E=>{S.set(E.itemId,{complete:E.complete,contextType:E.contextType,contextId:E.contextId})}),p.value=S}}catch(w){console.error("Failed to load checklist:",w),d.value=w.response?.data?.message||"Failed to load checklist"}finally{u.value=!1}}},y=w=>{const S=p.value.get(w.itemId),E=S!==void 0?S.complete:w.isCompleted;p.value.set(w.itemId,{complete:!E,contextType:w.completionContextType,contextId:w.completionContextId}),_()},_=()=>{const w=[];for(const[S,E]of p.value.entries()){const A=l.value.find(x=>x.itemId===S);A&&E.complete!==A.isCompleted&&w.push({itemId:S,complete:E.complete,contextType:E.contextType,contextId:E.contextId})}i("update:modelValue",w),i("change",w)};return t({resetLocalState:()=>{if(p.value=new Map,s.modelValue&&s.modelValue.length>0){const w=new Map;s.modelValue.forEach(S=>{w.set(S.itemId,{complete:S.complete,contextType:S.contextType,contextId:S.contextId})}),p.value=w}},loadChecklist:g}),qe(()=>[s.eventId,s.marshalId],()=>{g()},{immediate:!0}),(w,S)=>(v(),m("div",F3,[u.value?(v(),m("div",U3," Loading checklist... ")):d.value?(v(),m("div",z3,[r("p",null,C(d.value),1),r("button",{onClick:g,class:"btn btn-secondary btn-small"}," Retry ")])):l.value.length===0?(v(),m("div",H3,[r("p",null,"No checklist items for this "+C(O(a).person)+".",1)])):(v(),We(id,{key:3,items:f.value,locations:e.locations,areas:e.areas,onToggleComplete:y},null,8,["items","locations","areas"]))]))}},G3=je(V3,[["__scopeId","data-v-7460304c"]]),j3={class:"checklist-preview"},Z3={class:"preview-actions"},q3={class:"preview-header"},W3={key:0,class:"add-item-form"},K3=["placeholder"],J3=["disabled"],Y3={key:1,class:"pending-items"},X3={class:"item-content"},Q3={class:"item-header"},eP={class:"item-text"},tP={class:"item-scope"},nP=["onClick"],oP={key:2,class:"empty-state"},sP={key:0,class:"help-text"},aP={key:3,class:"checklist-items"},iP={class:"item-content"},lP={class:"item-header"},rP={class:"item-text"},cP={class:"item-scope"},uP=["title"],dP={key:0,class:"item-context"},hP={__name:"ChecklistPreview",props:{allChecklistItems:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ut(),a=e,s=t,i=$(!1),l=$(""),u=$([...a.modelValue]);qe(()=>a.modelValue,A=>{u.value=[...A]},{deep:!0});const d=()=>{l.value.trim()&&(u.value.push({text:l.value.trim(),isNew:!0}),l.value="",i.value=!1,f())},p=A=>{u.value.splice(A,1),f()},f=()=>{s("update:modelValue",[...u.value]),s("change")},g=V(()=>{const A=new Set;for(const x of a.pendingLocationIds){const D=a.allLocations.find(R=>R.id===x);D&&(D.areaIds||D.AreaIds||[]).forEach(F=>A.add(F))}return[...A]}),y=A=>{const x=A.scope,D=A.itemType,R=A.ids||[];return x==="SpecificPeople"&&D==="Marshal"?R.includes("ALL_MARSHALS"):(x==="EveryoneAtCheckpoints"||x==="OnePerCheckpoint")&&D==="Checkpoint"?R.includes("ALL_CHECKPOINTS")?!0:R.some(F=>a.pendingLocationIds.includes(F)):x==="OnePerCheckpoint"&&D==="Area"?R.includes("ALL_AREAS")?!0:R.some(F=>g.value.includes(F)):(x==="EveryoneInAreas"||x==="OnePerArea"||x==="EveryAreaLead"||x==="OneLeadPerArea")&&D==="Area"?R.includes("ALL_AREAS")?!0:R.some(F=>g.value.includes(F)):!1},_=V(()=>a.allChecklistItems.filter(A=>A.scopeConfigurations&&A.scopeConfigurations.length>0?A.scopeConfigurations.some(x=>y(x)):!1)),k=A=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,EveryoneInAreas:`All in ${o.value.areas}`,OnePerArea:`One per ${o.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${o.value.area}`})[A]||A,w=A=>{if(!A.scopeConfigurations||A.scopeConfigurations.length===0)return"Unknown";const x=A.scopeConfigurations.find(R=>y(R));if(!x)return k(A.scopeConfigurations[0].scope);const D=x.ids||[];return D.includes("ALL_MARSHALS")?"Everyone":D.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:D.includes("ALL_AREAS")?`All ${o.value.areas}`:k(x.scope)},S=A=>{if(!A.scopeConfigurations||A.scopeConfigurations.length===0)return"";const x=A.scopeConfigurations.find(R=>y(R));return x&&{SpecificPeople:"This item is for everyone at the event",EveryoneAtCheckpoints:`This item is for everyone at specified ${o.value.checkpoints}`,OnePerCheckpoint:`One person at each ${o.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${o.value.areas}`,OnePerArea:`One person in each ${o.value.area} needs to complete this`,EveryAreaLead:`This item is for ${o.value.area} leads only`,OneLeadPerArea:`One ${o.value.area} lead needs to complete this`}[x.scope]||""},E=A=>{if(!A.scopeConfigurations||A.scopeConfigurations.length===0)return null;const x=A.scopeConfigurations.find(F=>y(F));if(!x)return null;const D=x.itemType,R=x.ids||[];if(R.includes("ALL_MARSHALS")||R.includes("ALL_CHECKPOINTS")||R.includes("ALL_AREAS"))return null;if(D==="Checkpoint"){const F=a.allLocations.filter(T=>R.includes(T.id)&&a.pendingLocationIds.includes(T.id)).map(T=>T.name);if(F.length>0)return`At: ${F.join(", ")}`}if(D==="Area"){const F=a.areas.filter(T=>R.includes(T.id)&&g.value.includes(T.id)).map(T=>T.name);if(F.length>0)return`In: ${F.join(", ")}`}return null};return(A,x)=>(v(),m("div",j3,[r("div",Z3,[r("p",q3,C(e.isEditing?`Add new ${O(o).checklist} for this ${O(o).person}:`:`${O(o).checklists} that will apply to this ${O(o).person}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:x[0]||(x[0]=D=>i.value=!i.value)},C(i.value?"Cancel":`Add ${O(o).checklist}`),1)]),i.value?(v(),m("div",W3,[Ue(r("input",{"onUpdate:modelValue":x[1]||(x[1]=D=>l.value=D),type:"text",placeholder:`Enter ${O(o).checklist} text...`,class:"add-item-input",onKeyup:ps(d,["enter"])},null,40,K3),[[st,l.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim(),onClick:d}," Add ",8,J3)])):M("",!0),u.value.length>0?(v(),m("div",Y3,[(v(!0),m(xe,null,Ne(u.value,(D,R)=>(v(),m("div",{key:`pending-${R}`,class:"checklist-item pending"},[x[3]||(x[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",X3,[r("div",Q3,[r("div",eP,C(D.text),1),r("div",tP,[x[2]||(x[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:F=>p(R),title:"Remove"},"  ",8,nP)])])])]))),128))])):M("",!0),!e.isEditing&&_.value.length===0&&u.value.length===0?(v(),m("div",oP,[r("p",null,"No "+C(O(o).checklists)+" will apply based on the current "+C(O(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),m("p",sP," Assign "+C(O(o).checkpoints)+" to see relevant "+C(O(o).checklists)+". ",1)):M("",!0)])):M("",!0),!e.isEditing&&_.value.length>0?(v(),m("div",aP,[(v(!0),m(xe,null,Ne(_.value,D=>(v(),m("div",{key:D.id,class:"checklist-item"},[x[4]||(x[4]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",iP,[r("div",lP,[r("div",rP,C(D.text),1),r("div",cP,[r("span",{class:"scope-pill",title:S(D)},C(w(D)),9,uP)])]),E(D)?(v(),m("div",dP,C(E(D)),1)):M("",!0)])]))),128))])):M("",!0)]))}},fP=je(hP,[["__scopeId","data-v-6deaacc2"]]),pP={class:"notes-preview"},vP={class:"preview-actions"},mP={class:"preview-header"},gP={key:0,class:"add-item-form"},yP={class:"add-form-fields"},kP=["disabled"],_P={key:1,class:"pending-items"},bP={class:"note-header"},wP={class:"note-title"},CP={class:"note-actions"},LP=["onClick"],SP={key:0,class:"note-content"},xP={key:2,class:"empty-state"},IP={key:0,class:"help-text"},$P={key:3,class:"notes-list"},TP={class:"note-header"},MP={class:"note-title"},AP=["title"],EP={key:0,class:"note-content"},PP={key:1,class:"note-context"},DP={__name:"NotesPreview",props:{allNotes:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ut(),a=e,s=t,i=$(!1),l=$(""),u=$(""),d=$([...a.modelValue]);qe(()=>a.modelValue,x=>{d.value=[...x]},{deep:!0});const p=()=>{!l.value.trim()&&!u.value.trim()||(d.value.push({title:l.value.trim(),content:u.value.trim(),isNew:!0}),l.value="",u.value="",i.value=!1,g())},f=x=>{d.value.splice(x,1),g()},g=()=>{s("update:modelValue",[...d.value]),s("change")},y=V(()=>{const x=new Set;for(const D of a.pendingLocationIds){const R=a.allLocations.find(F=>F.id===D);R&&(R.areaIds||R.AreaIds||[]).forEach(T=>x.add(T))}return[...x]}),_=x=>{const D=x.scope,R=x.itemType,F=x.ids||[];return D==="SpecificPeople"&&R==="Marshal"?F.includes("ALL_MARSHALS"):D==="EveryoneAtCheckpoints"&&R==="Checkpoint"?F.includes("ALL_CHECKPOINTS")?!0:F.some(T=>a.pendingLocationIds.includes(T)):D==="EveryoneInAreas"&&R==="Area"?F.includes("ALL_AREAS")?!0:F.some(T=>y.value.includes(T)):!1},k=V(()=>a.allNotes.filter(x=>x.scopeConfigurations&&x.scopeConfigurations.length>0?x.scopeConfigurations.some(D=>_(D)):!1)),w=x=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[x]||x,S=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"Unknown";const D=x.scopeConfigurations.find(F=>_(F));if(!D)return w(x.scopeConfigurations[0].scope);const R=D.ids||[];return R.includes("ALL_MARSHALS")?"Everyone":R.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:R.includes("ALL_AREAS")?`All ${o.value.areas}`:w(D.scope)},E=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"";const D=x.scopeConfigurations.find(F=>_(F));return D&&{SpecificPeople:"This note is for everyone at the event",EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[D.scope]||""},A=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return null;const D=x.scopeConfigurations.find(T=>_(T));if(!D)return null;const R=D.itemType,F=D.ids||[];if(F.includes("ALL_MARSHALS")||F.includes("ALL_CHECKPOINTS")||F.includes("ALL_AREAS"))return null;if(R==="Checkpoint"){const T=a.allLocations.filter(N=>F.includes(N.id)&&a.pendingLocationIds.includes(N.id)).map(N=>N.name);if(T.length>0)return`At: ${T.join(", ")}`}if(R==="Area"){const T=a.areas.filter(N=>F.includes(N.id)&&y.value.includes(N.id)).map(N=>N.name);if(T.length>0)return`In: ${T.join(", ")}`}return null};return(x,D)=>(v(),m("div",pP,[r("div",vP,[r("p",mP,C(e.isEditing?`Add new note for this ${O(o).person}:`:`Notes that will be visible to this ${O(o).person}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:D[0]||(D[0]=R=>i.value=!i.value)},C(i.value?"Cancel":"Add note"),1)]),i.value?(v(),m("div",gP,[r("div",yP,[Ue(r("input",{"onUpdate:modelValue":D[1]||(D[1]=R=>l.value=R),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[st,l.value]]),Ue(r("textarea",{"onUpdate:modelValue":D[2]||(D[2]=R=>u.value=R),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[st,u.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim()&&!u.value.trim(),onClick:p}," Add ",8,kP)])):M("",!0),d.value.length>0?(v(),m("div",_P,[(v(!0),m(xe,null,Ne(d.value,(R,F)=>(v(),m("div",{key:`pending-${F}`,class:"note-item pending"},[r("div",bP,[r("span",wP,C(R.title||"Untitled"),1),r("div",CP,[D[3]||(D[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:T=>f(F),title:"Remove"},"  ",8,LP)])]),R.content?(v(),m("div",SP,C(R.content),1)):M("",!0)]))),128))])):M("",!0),!e.isEditing&&k.value.length===0&&d.value.length===0?(v(),m("div",xP,[r("p",null,"No notes will be visible based on the current "+C(O(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),m("p",IP," Assign "+C(O(o).checkpoints)+" to see relevant notes. ",1)):M("",!0)])):M("",!0),!e.isEditing&&k.value.length>0?(v(),m("div",$P,[(v(!0),m(xe,null,Ne(k.value,R=>(v(),m("div",{key:R.id,class:"note-item"},[r("div",TP,[r("span",MP,C(R.title||"Untitled"),1),r("span",{class:"scope-pill",title:E(R)},C(S(R)),9,AP)]),R.content?(v(),m("div",EP,C(R.content),1)):M("",!0),A(R)?(v(),m("div",PP,C(A(R)),1)):M("",!0)]))),128))])):M("",!0)]))}},RP=je(DP,[["__scopeId","data-v-e8e0946a"]]),OP={key:6,class:"tab-content incidents-tab"},BP={class:"incidents-list"},NP={class:"custom-footer"},FP={class:"footer-left"},UP={__name:"EditMarshalModal",props:{show:{type:Boolean,default:!1},marshal:{type:Object,default:null},eventId:{type:String,required:!0},assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1},eventNotes:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},incidents:{type:Array,default:()=>[]},validationErrors:{type:Object,default:()=>({})},lockedCheckpointId:{type:String,default:null},zIndex:{type:Number,default:1e3}},emits:["close","save","delete","toggle-check-in","remove-assignment","assign-to-location","update:isDirty","select-incident","select-checkpoint"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=ut(),i=e,l=o,u=$("details"),d=$(null),p=$(null),f=$(null),g=$([]),y=$([]),_=$([]),k=$([]),w=$({name:"",email:"",phoneNumber:"",notes:""}),S=V(()=>{const ue=i.isEditing?`Edit ${s.value.person}`:`Create ${s.value.person}`,De=w.value.name?.trim();return De?`${ue} - ${De}`:ue}),E=V(()=>{const ue=[{value:"details",label:"Details",icon:"details"},{value:"checkpoints",label:a.value.checkpoints,icon:"checkpoint"},{value:"checklists",label:a.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}];return i.incidents&&i.incidents.length>0&&ue.push({value:"incidents",label:"Incidents",icon:"incidents"}),ue}),A=V(()=>E.value.findIndex(ue=>ue.value===u.value)),x=V(()=>A.value===E.value.length-1),D=V(()=>x.value?null:E.value[A.value+1]),R=V(()=>D.value?`${D.value.label}...`:""),F=V(()=>y.value.map(ue=>ue.locationId)),T=V(()=>i.isEditing?i.assignments:y.value.map(ue=>({id:`pending-${ue.locationId}`,locationId:ue.locationId,locationName:i.allLocations.find(De=>De.id===ue.locationId)?.name||"Unknown",isPending:!0}))),N=V(()=>{if(i.isEditing)return i.availableLocations;const ue=y.value.map(De=>De.locationId);return i.allLocations.filter(De=>!ue.includes(De.id))});qe(()=>i.marshal,ue=>{ue?w.value={name:ue.name||"",email:ue.email||"",phoneNumber:ue.phoneNumber||"",notes:ue.notes||""}:w.value={name:"",email:"",phoneNumber:"",notes:""}},{immediate:!0,deep:!0}),qe(()=>i.show,ue=>{ue&&(u.value="details",g.value=[],y.value=[],_.value=[],k.value=[],i.isEditing||(w.value={name:"",email:"",phoneNumber:"",notes:""}),p.value?.clearPendingChanges&&p.value.clearPendingChanges(),f.value?.resetLocalState&&f.value.resetLocalState())});const B=ue=>{w.value=ue},q=()=>{l("update:isDirty",!0)},P=()=>{l("update:isDirty",!0)},G=()=>{D.value&&(u.value=D.value.value)},X=()=>{const ue={...w.value,checkInChanges:p.value?.getPendingChanges?.()||[],assignmentsToRemove:p.value?.getMarkedForRemoval?.()||[],checklistChanges:g.value||[],pendingAssignments:i.isEditing?[]:y.value,pendingNewChecklistItems:_.value,pendingNewNotes:k.value};l("save",ue)},ne=()=>{l("delete")},K=ue=>{!i.isEditing&&ue.isPending?y.value=y.value.filter(De=>De.locationId!==ue.locationId):l("remove-assignment",ue)},Q=ue=>{i.isEditing?l("assign-to-location",ue):(y.value.push({locationId:ue}),l("update:isDirty",!0))},he=ue=>{l("select-checkpoint",ue)},U=()=>{l("close")};return t({switchToTab:ue=>{u.value=ue},focusField:ue=>{d.value?.focusField&&d.value.focusField(ue)}}),(ue,De)=>(v(),We(Gt,{show:e.show,title:S.value,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:U},{"tab-header":ze(()=>[Ae(qi,{modelValue:u.value,"onUpdate:modelValue":De[0]||(De[0]=et=>u.value=et),tabs:E.value},null,8,["modelValue","tabs"])]),footer:ze(()=>[r("div",NP,[r("div",FP,[e.isEditing&&!e.lockedCheckpointId?(v(),m("button",{key:0,type:"button",onClick:ne,class:"btn btn-danger"}," Delete ")):M("",!0),!e.isEditing&&!x.value?(v(),m("button",{key:1,type:"button",onClick:G,class:"btn btn-secondary mobile-only"},C(R.value),1)):M("",!0)]),r("button",{type:"button",onClick:X,class:"btn btn-success"}," Save ")])]),default:ze(()=>[u.value==="details"?(v(),We(p3,{key:0,ref_key:"detailsTabRef",ref:d,form:w.value,"event-id":e.eventId,"marshal-id":e.isEditing?e.marshal?.id:null,"validation-errors":e.validationErrors,"onUpdate:form":B,onInput:q},null,8,["form","event-id","marshal-id","validation-errors"])):M("",!0),u.value==="checkpoints"?(v(),We(N3,{key:1,ref_key:"checkpointsTabRef",ref:p,assignments:T.value,"available-locations":N.value,"all-locations":e.allLocations,areas:e.areas,"is-new-marshal":!e.isEditing,"locked-checkpoint-id":e.lockedCheckpointId,onInput:q,onRemoveAssignment:K,onAssignToLocation:Q,onSelectCheckpoint:he},null,8,["assignments","available-locations","all-locations","areas","is-new-marshal","locked-checkpoint-id"])):M("",!0),u.value==="checklists"&&e.isEditing?(v(),We(G3,{key:2,ref_key:"checklistTabRef",ref:f,modelValue:g.value,"onUpdate:modelValue":De[1]||(De[1]=et=>g.value=et),"event-id":e.eventId,"marshal-id":e.marshal.id,locations:e.allLocations,areas:e.areas,onChange:P},null,8,["modelValue","event-id","marshal-id","locations","areas"])):M("",!0),u.value==="checklists"?(v(),We(fP,{key:3,modelValue:_.value,"onUpdate:modelValue":De[2]||(De[2]=et=>_.value=et),"all-checklist-items":e.allChecklistItems,"pending-location-ids":F.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:q},null,8,["modelValue","all-checklist-items","pending-location-ids","all-locations","areas","is-editing"])):M("",!0),u.value==="notes"&&e.isEditing?(v(),We(gc,{key:4,"event-id":e.eventId,"marshal-id":e.marshal?.id,"all-notes":e.eventNotes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","marshal-id","all-notes","locations","areas","assignments"])):M("",!0),u.value==="notes"?(v(),We(RP,{key:5,modelValue:k.value,"onUpdate:modelValue":De[3]||(De[3]=et=>k.value=et),"all-notes":e.eventNotes,"pending-location-ids":F.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:q},null,8,["modelValue","all-notes","pending-location-ids","all-locations","areas","is-editing"])):M("",!0),u.value==="incidents"?(v(),m("div",OP,[r("div",BP,[(v(!0),m(xe,null,Ne(e.incidents,et=>(v(),We(Wl,{key:et.incidentId,incident:et,onSelect:De[4]||(De[4]=Je=>ue.$emit("select-incident",Je))},null,8,["incident"]))),128))])])):M("",!0)]),_:1},8,["show","title","is-dirty","z-index"]))}},zP=je(UP,[["__scopeId","data-v-dd9a44f3"]]),HP={class:"locations-list"},VP={class:"conflict-actions"},GP={__name:"AssignmentConflictModal",props:{show:{type:Boolean,default:!1},conflictData:{type:Object,default:()=>({marshalName:"",locations:[]})}},emits:["close","choice"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=t,i=u=>{s("choice",u)},l=()=>{s("close")};return(u,d)=>(v(),We(Gt,{show:e.show,title:`${O(o).person} already assigned`,size:"medium","z-index":1100,onClose:l},{actions:ze(()=>[r("div",VP,[r("button",{onClick:d[0]||(d[0]=p=>i("move")),class:"btn btn-primary btn-full"}," Move to this "+C(O(a).checkpoint)+" (remove from others) ",1),r("button",{onClick:d[1]||(d[1]=p=>i("both")),class:"btn btn-secondary btn-full"}," Assign to both (keep existing assignments) "),r("button",{onClick:d[2]||(d[2]=p=>i("choose-other")),class:"btn btn-secondary btn-full"}," Choose someone else "),r("button",{onClick:d[3]||(d[3]=p=>i("cancel")),class:"btn btn-secondary btn-full"}," Cancel ")])]),default:ze(()=>[r("p",null,[r("strong",null,C(e.conflictData.marshalName),1),d[4]||(d[4]=Ye(" is currently assigned to: ",-1))]),r("ul",HP,[(v(!0),m(xe,null,Ne(e.conflictData.locations,p=>(v(),m("li",{key:p},C(p),1))),128))]),d[5]||(d[5]=r("p",null,"What would you like to do?",-1))]),_:1},8,["show","title"]))}},jP=je(GP,[["__scopeId","data-v-997e8aaa"]]),ZP={key:0,class:"assign-marshal-section"},qP={value:""},WP=["value"],KP=["disabled"],JP={key:1,class:"assign-marshal-section create-mode"},YP={class:"form-group"},XP={class:"form-group"},QP={class:"form-group"},e6={__name:"AssignMarshalModal",props:{show:{type:Boolean,default:!1},locationName:{type:String,default:""},marshals:{type:Array,default:()=>[]}},emits:["close","assign-existing","create-and-assign"],setup(e,{emit:t}){const{termsLower:o}=ut(),a=e,s=t,i=$(!1),l=$(""),u=$({name:"",email:"",phoneNumber:""});qe(()=>a.show,_=>{_||(i.value=!1,l.value="",u.value={name:"",email:"",phoneNumber:""})});const d=()=>{i.value=!0},p=()=>{l.value&&s("assign-existing",l.value)},f=()=>{u.value.name&&s("create-and-assign",{...u.value})},g=()=>{i.value=!1,u.value={name:"",email:"",phoneNumber:""}},y=()=>{s("close")};return(_,k)=>(v(),We(Gt,{show:e.show,title:i.value?`Create new ${O(o).person}`:`Assign ${O(o).person} to ${e.locationName}`,size:"medium",onClose:y},{actions:ze(()=>[i.value?(v(),m(xe,{key:0},[r("button",{onClick:g,class:"btn btn-secondary"}," Cancel "),r("button",{onClick:f,class:"btn btn-primary"}," Create & assign ")],64)):M("",!0)]),default:ze(()=>[i.value?(v(),m("div",JP,[r("h3",null,"Create new "+C(O(o).person),1),r("div",YP,[k[5]||(k[5]=r("label",null,"Name *",-1)),Ue(r("input",{"onUpdate:modelValue":k[1]||(k[1]=w=>u.value.name=w),type:"text",required:"",class:"form-input"},null,512),[[st,u.value.name]])]),r("div",XP,[k[6]||(k[6]=r("label",null,"Email",-1)),Ue(r("input",{"onUpdate:modelValue":k[2]||(k[2]=w=>u.value.email=w),type:"email",class:"form-input"},null,512),[[st,u.value.email]])]),r("div",QP,[k[7]||(k[7]=r("label",null,"Phone",-1)),Ue(r("input",{"onUpdate:modelValue":k[3]||(k[3]=w=>u.value.phoneNumber=w),type:"tel",class:"form-input"},null,512),[[st,u.value.phoneNumber]])])])):(v(),m("div",ZP,[r("h3",null,"Select existing "+C(O(o).person),1),Ue(r("select",{"onUpdate:modelValue":k[0]||(k[0]=w=>l.value=w),class:"form-input"},[r("option",qP,"Choose a "+C(O(o).person)+"...",1),(v(!0),m(xe,null,Ne(e.marshals,w=>(v(),m("option",{key:w.id,value:w.id},[Ye(C(w.name)+" ",1),w.assignedLocationIds&&w.assignedLocationIds.length>0?(v(),m(xe,{key:0},[Ye(" (assigned to "+C(w.assignedLocationIds.length)+" "+C(w.assignedLocationIds.length>1?O(o).checkpoints:O(o).checkpoint)+") ",1)],64)):M("",!0)],8,WP))),128))],512),[[Bn,l.value]]),r("button",{onClick:p,class:"btn btn-primary btn-full",style:{"margin-top":"1rem"},disabled:!l.value}," Assign selected "+C(O(o).person),9,KP),k[4]||(k[4]=r("div",{class:"divider"},"OR",-1)),r("button",{onClick:d,class:"btn btn-secondary btn-full"}," Create new "+C(O(o).person),1)]))]),_:1},8,["show","title"]))}},t6=je(e6,[["__scopeId","data-v-fa70b913"]]),n6={class:"shift-times-content"},o6={class:"info-text"},s6={class:"time-delta-info"},a6={class:"delta-detail"},i6={class:"delta-detail"},l6={class:"delta-summary"},r6={class:"affected-checkpoints"},c6={class:"option-selection"},u6={class:"radio-option"},d6={class:"radio-option"},h6={__name:"ShiftCheckpointTimesModal",props:{show:{type:Boolean,default:!1},oldEventDate:{type:String,required:!0},newEventDate:{type:String,required:!0},affectedCheckpointsCount:{type:Number,default:0}},emits:["confirm","cancel"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ut(),s=e,i=t,l=$("shift"),u=V(()=>{const y=new Date(s.oldEventDate);return new Date(s.newEventDate)-y}),d=y=>new Date(y).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),p=y=>{const _=Math.abs(y),k=y>=0?"+":"-",w=Math.floor(_/(1e3*60*60*24)),S=Math.floor(_%(1e3*60*60*24)/(1e3*60*60)),E=Math.floor(_%(1e3*60*60)/(1e3*60)),A=[];return w>0&&A.push(`${w}d`),S>0&&A.push(`${S}h`),E>0&&A.push(`${E}m`),`${k}${A.join(" ")}`},f=()=>{i("confirm",{shouldShift:l.value==="shift",timeDelta:u.value})},g=()=>{i("cancel")};return(y,_)=>(v(),We(Gt,{show:e.show,title:`Shift ${O(o).checkpoint} Times?`,size:"medium",onClose:g},{actions:ze(()=>[r("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-primary"},C(l.value==="shift"?"Shift Times":"Keep Times"),1)]),default:ze(()=>[r("div",n6,[r("p",o6," You've changed the event date/time. Some "+C(O(a).checkpoints)+" have custom times set. ",1),r("div",s6,[_[2]||(_[2]=r("strong",null,"Event time change:",-1)),r("div",a6," Old: "+C(d(e.oldEventDate)),1),r("div",i6," New: "+C(d(e.newEventDate)),1),r("div",l6," Delta: "+C(p(u.value)),1)]),r("p",r6,[r("strong",null,C(e.affectedCheckpointsCount)+" "+C(e.affectedCheckpointsCount===1?O(a).checkpoint:O(a).checkpoints),1),_[3]||(_[3]=Ye(" with custom times will be shifted by the same amount. ",-1))]),r("div",c6,[r("label",u6,[Ue(r("input",{"onUpdate:modelValue":_[0]||(_[0]=k=>l.value=k),type:"radio",value:"shift",name:"shift-option"},null,512),[[hh,l.value]]),r("div",null,[r("strong",null,"Shift all "+C(O(a).checkpoint)+" times",1),_[4]||(_[4]=r("small",null,"Recommended: Maintains relative timing",-1))])]),r("label",d6,[Ue(r("input",{"onUpdate:modelValue":_[1]||(_[1]=k=>l.value=k),type:"radio",value:"keep",name:"shift-option"},null,512),[[hh,l.value]]),r("div",null,[r("strong",null,"Keep "+C(O(a).checkpoint)+" times unchanged",1),r("small",null,C(O(o).checkpoint)+" times will stay at their current values",1)])])])])]),_:1},8,["show","title"]))}},f6=je(h6,[["__scopeId","data-v-a6454aff"]]),p6={class:"search-section"},v6={class:"form-group"},m6={class:"suggestions-list"},g6={class:"suggestion-content"},y6={key:0,class:"suggestion-detail"},k6=["onClick"],_6={class:"suggestion-content"},b6={class:"suggestion-name"},w6={key:0,class:"suggestion-detail"},C6=["onClick"],L6={class:"suggestion-content"},S6={class:"suggestion-name"},x6={key:0,class:"suggestion-detail"},I6={key:1,class:"no-results"},$6={key:2,class:"no-results"},T6={__name:"AddAreaContactModal",props:{show:{type:Boolean,default:!1},areaName:{type:String,default:""},areaId:{type:String,default:""},contacts:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},excludeContactIds:{type:Array,default:()=>[]}},emits:["close","select-contact","create-from-marshal","create-new"],setup(e,{emit:t}){const{terms:o}=ut(),a=e,s=t,i=$(""),l=$(null),u=V(()=>a.contacts.filter(T=>a.excludeContactIds.includes(T.contactId)&&T.marshalId).map(T=>T.marshalId)),d=V(()=>a.contacts.filter(T=>T.marshalId).map(T=>T.marshalId)),p=V(()=>a.contacts.filter(T=>!a.excludeContactIds.includes(T.contactId))),f=V(()=>a.marshals.filter(T=>!u.value.includes(T.id)&&!d.value.includes(T.id))),g=T=>T?T.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",y=V(()=>{const T=g(i.value);return T?T.split(" ").filter(N=>N.length>0):[]}),_=(T,N)=>{if(N.length===0)return{score:1,isPartial:!1};const B=g(T);let q=0;for(const P of N)B.includes(P)&&q++;return{score:q,isPartial:q>0&&q<N.length,isFullMatch:q===N.length}},k=V(()=>{const T=y.value,N=[];return p.value.forEach(B=>{const q=`${B.name||""} ${B.role||""}`,P=_(q,T);(T.length===0||P.score>0)&&N.push({key:`contact-${B.contactId}`,type:"contact",name:B.name,detail:B.role?F(B.role):null,data:B,matchScore:P.score,isPartial:P.isPartial,isFullMatch:P.isFullMatch})}),f.value.forEach(B=>{const q=`${B.name||""} ${B.email||""}`,P=_(q,T);(T.length===0||P.score>0)&&N.push({key:`marshal-${B.id}`,type:"marshal",name:B.name,detail:B.email||B.phoneNumber||null,data:B,matchScore:P.score,isPartial:P.isPartial,isFullMatch:P.isFullMatch})}),N.sort((B,q)=>q.matchScore!==B.matchScore?q.matchScore-B.matchScore:B.name.localeCompare(q.name,void 0,{sensitivity:"base"})),N}),w=V(()=>y.value.length===0?k.value:k.value.filter(T=>T.isFullMatch)),S=V(()=>y.value.length===0?[]:k.value.filter(T=>T.isPartial)),E=V(()=>S.value.length>0);qe(()=>a.show,async T=>{T&&(i.value="",await cn(),l.value?.focus())});const A=T=>{const N=a.contacts.find(B=>B.marshalId===T.id);if(N){if(a.excludeContactIds.includes(N.contactId))return;s("select-contact",N)}else s("create-from-marshal",T)},x=T=>{s("select-contact",T)},D=()=>{s("create-new",i.value.trim())},R=()=>{s("close")},F=T=>T?T.replace(/([A-Z])/g," $1").replace(/^./,N=>N.toUpperCase()).trim():"";return(T,N)=>(v(),We(Gt,{show:e.show,title:`Add contact to ${e.areaName}`,size:"medium",onClose:R},{actions:ze(()=>[r("button",{onClick:R,class:"btn btn-secondary"}," Cancel ")]),default:ze(()=>[r("div",p6,[r("div",v6,[N[1]||(N[1]=r("label",null,"Search or create",-1)),Ue(r("input",{ref_key:"searchInputRef",ref:l,"onUpdate:modelValue":N[0]||(N[0]=B=>i.value=B),type:"text",class:"form-input",placeholder:"Filter by name..."},null,512),[[st,i.value]])]),r("div",m6,[r("div",{class:"suggestion-item create-new",onClick:D},[N[3]||(N[3]=r("span",{class:"suggestion-icon create-icon"},"+",-1)),r("div",g6,[N[2]||(N[2]=r("span",{class:"suggestion-name"},"Create new contact",-1)),i.value.trim()?(v(),m("span",y6,'"'+C(i.value.trim())+'"',1)):M("",!0)])]),(v(!0),m(xe,null,Ne(w.value,B=>(v(),m("div",{key:B.key,class:"suggestion-item",onClick:q=>B.type==="marshal"?A(B.data):x(B.data)},[r("span",{class:de(["suggestion-icon",B.type==="marshal"?"marshal-icon":"contact-icon"])},C(B.type==="marshal"?"M":"C"),3),r("div",_6,[r("span",b6,C(B.name),1),B.detail?(v(),m("span",w6,C(B.detail),1)):M("",!0)]),r("span",{class:de(["suggestion-badge",{"contact-badge":B.type==="contact"}])},C(B.type==="marshal"?O(o).person:"Contact"),3)],8,k6))),128)),E.value?(v(),m(xe,{key:0},[N[4]||(N[4]=r("div",{class:"suggestion-section-header"},"Partial matches",-1)),(v(!0),m(xe,null,Ne(S.value,B=>(v(),m("div",{key:B.key,class:"suggestion-item",onClick:q=>B.type==="marshal"?A(B.data):x(B.data)},[r("span",{class:de(["suggestion-icon",B.type==="marshal"?"marshal-icon":"contact-icon"])},C(B.type==="marshal"?"M":"C"),3),r("div",L6,[r("span",S6,C(B.name),1),B.detail?(v(),m("span",x6,C(B.detail),1)):M("",!0)]),r("span",{class:de(["suggestion-badge",{"contact-badge":B.type==="contact"}])},C(B.type==="marshal"?O(o).person:"Contact"),3)],8,C6))),128))],64)):M("",!0),i.value.trim()&&w.value.length===0&&S.value.length===0?(v(),m("div",I6," No matching "+C(O(o).people.toLowerCase())+" or contacts found. ",1)):M("",!0),!i.value.trim()&&w.value.length===0?(v(),m("div",$6," No "+C(O(o).people.toLowerCase())+" or contacts available to add. ",1)):M("",!0)])])]),_:1},8,["show","title"]))}},M6=je(T6,[["__scopeId","data-v-e25ca97b"]]),A6={key:0,class:"tab-content"},E6={class:"form-group"},P6=["disabled"],D6={class:"form-group"},R6={key:1,class:"tab-content"},O6={class:"boundary-section"},B6={key:0,class:"boundary-preview"},N6={class:"boundary-actions"},F6={key:2,class:"tab-content"},U6={class:"contacts-header"},z6={class:"section-title"},H6={key:3,class:"tab-content"},V6={class:"section-title"},G6={key:4,class:"placeholder-message"},j6={key:6,class:"placeholder-message"},Z6={key:8,class:"placeholder-message"},q6={key:9,class:"tab-content appearance-tab"},W6={class:"accordion-item"},K6=["innerHTML"],J6={class:"accordion-title"},Y6={class:"accordion-arrow"},X6={key:0,class:"accordion-content"},Q6={class:"section-description"},e5={class:"color-picker"},t5=["title","onClick"],n5={class:"accordion-item"},o5=["innerHTML"],s5={class:"accordion-title"},a5={class:"accordion-arrow"},i5={key:0,class:"accordion-content"},l5={class:"section-description"},r5={class:"accordion-item"},c5={class:"accordion-title"},u5={class:"accordion-preview"},d5={class:"accordion-arrow"},h5={key:0,class:"accordion-content"},f5={class:"section-description"},p5={class:"form-group"},v5={value:""},m5=["value"],g5={class:"accordion-item"},y5={class:"accordion-title"},k5={class:"accordion-preview"},_5={class:"accordion-arrow"},b5={key:0,class:"accordion-content"},w5={class:"section-description"},C5={class:"form-group"},L5={value:""},S5=["value"],x5={key:10,class:"tab-content incidents-tab"},I5={class:"incidents-list"},$5={class:"custom-footer"},T5={class:"footer-left"},rf="edit_area_accordion",M5={__name:"EditAreaModal",props:{show:{type:Boolean,default:!1},area:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},incidents:{type:Array,default:()=>[]},initialTab:{type:String,default:"details"},route:{type:Array,default:()=>[]}},emits:["close","save","delete","draw-boundary","update:isDirty","select-checkpoint","create-contact-from-marshal","create-new-contact","edit-contact","select-incident"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=ut(),i=()=>x.value.peopleTerm?x.value.peopleTerm:d.eventPeopleTerm||"Marshals",l=(Z=!0)=>{const se=x.value.checkpointTerm||d.eventCheckpointTerm||"Checkpoints",ce=i();return Z?Uv("checkpoint",se,ce):Ja("checkpoint",se,ce)},u=(Z=!0)=>l(Z).toLowerCase(),d=e,p=o,f=$("details"),g=$(null),y=$([]),_=$({}),k=$({}),w=$(!1),S=$(!1),E=$([]),A=$([]),x=$({name:"",description:"",color:Cr,displayOrder:0,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),D=()=>({name:"",description:"",color:o2(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),R=()=>d.eventId?`${rf}_${d.eventId}`:rf,F=$({polygonColor:!1,iconStyle:!1,peopleTerm:!1,checkpointTerm:!1});nn(()=>{const Z=localStorage.getItem(R());if(Z)try{const se=JSON.parse(Z);F.value={...F.value,...se}}catch{}});const T=Z=>{F.value[Z]=!F.value[Z],localStorage.setItem(R(),JSON.stringify(F.value))},N=V(()=>`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <polygon points="4,8 7,3 14,2 20,5 22,12 19,18 12,21 5,19 2,14" fill="${x.value.color||Cr}" stroke="#fff" stroke-width="1.5" opacity="0.8"/>
  </svg>`),B=V(()=>{const Z=x.value.checkpointStyleType!=="default"||x.value.checkpointStyleBackgroundShape||x.value.checkpointStyleBackgroundColor||x.value.checkpointStyleBorderColor||x.value.checkpointStyleIconColor||x.value.checkpointStyleSize,se=d.eventDefaultStyleType!=="default"||d.eventDefaultStyleBackgroundShape||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||d.eventDefaultStyleBorderColor||d.eventDefaultStyleIconColor||d.eventDefaultStyleSize;if(!Z&&!se)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="areaDefaultGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981"/>
          <stop offset="50%" style="stop-color:#F59E0B"/>
          <stop offset="100%" style="stop-color:#EF4444"/>
        </linearGradient>
      </defs>
      <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#areaDefaultGrad)" stroke="#fff" stroke-width="1.5"/>
    </svg>`;const ce=x.value.checkpointStyleType&&x.value.checkpointStyleType!=="default"?x.value.checkpointStyleType:d.eventDefaultStyleType&&d.eventDefaultStyleType!=="default"?d.eventDefaultStyleType:"default",Te=x.value.checkpointStyleBackgroundShape||d.eventDefaultStyleBackgroundShape||"circle",Oe=x.value.checkpointStyleBackgroundColor||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||"#667eea",Be=x.value.checkpointStyleBorderColor||d.eventDefaultStyleBorderColor||"#ffffff",Xe=x.value.checkpointStyleIconColor||d.eventDefaultStyleIconColor||"#ffffff",mt=x.value.checkpointStyleSize||d.eventDefaultStyleSize||"100";return Cn({type:ce!=="default"?ce:Te,backgroundShape:Te,backgroundColor:Oe,borderColor:Be,iconColor:Xe,size:mt,outputSize:24})}),q=V(()=>d.area&&d.area.id),P=V(()=>!x.value.polygon||x.value.polygon.length===0?[]:x.value.polygon.map((Z,se)=>({id:`polygon-point-${se}`,latitude:Z.lat,longitude:Z.lng}))),G=V(()=>d.area?.id?d.areas.filter(Z=>Z.id!==d.area.id).map(Z=>({...Z,color:"#999999"})):d.areas.map(Z=>({...Z,color:"#999999"})));V(()=>ee.value.map(Z=>Z.id));const X=V(()=>{const Z=[{value:"details",label:"Details",icon:"details"},{value:"boundary",label:"Boundary",icon:"area"},{value:"contacts",label:"Contacts",icon:"marshal"},{value:"checkpoints",label:l(),icon:"checkpoint"},{value:"checklists",label:a.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return d.incidents&&d.incidents.length>0&&Z.push({value:"incidents",label:"Incidents",icon:"incidents"}),Z}),ne=V(()=>X.value.findIndex(Z=>Z.value===f.value)),K=V(()=>ne.value===X.value.length-1),Q=V(()=>K.value?null:X.value[ne.value+1]),he=V(()=>Q.value?`${Q.value.label}...`:""),U=V(()=>{if(!d.area||!d.area.id)return[];const Z=d.checkpoints.filter(se=>se.areaIds&&se.areaIds.includes(d.area.id)).map(se=>se.id);return d.assignments.filter(se=>Z.includes(se.locationId))}),ee=V(()=>!d.area||!d.area.id?[]:d.checkpoints.filter(Z=>Z.areaIds&&Z.areaIds.includes(d.area.id))),fe=V(()=>{const Z=[...ee.value];return Z.sort((se,ce)=>{const Te=se.name.match(/^(\d+)/),Oe=ce.name.match(/^(\d+)/);if(Te&&Oe){const Be=parseInt(Te[1]),Xe=parseInt(Oe[1]);if(Be!==Xe)return Be-Xe}return se.name.localeCompare(ce.name,void 0,{numeric:!0,sensitivity:"base"})}),Z}),ue=V(()=>!d.area||!d.area.id?[]:d.contacts.filter(Z=>Z.scopeConfigurations?Z.scopeConfigurations.some(se=>se.scope==="EveryoneInAreas"&&se.itemType==="Area"?se.ids?.includes("ALL_AREAS")?!0:se.ids?.includes(d.area.id):!1):!1)),De=V(()=>{const Z=new Set(ue.value.map(Te=>Te.contactId)),se=ue.value.map(Te=>({...Te,isPending:!1,isExisting:!0,isMarkedForRemoval:A.value.includes(Te.contactId)})),ce=E.value.filter(Te=>!Z.has(Te.contactId)).map(Te=>({...Te,isPending:!0,isExisting:!1,isMarkedForRemoval:!1}));return[...se,...ce].sort((Te,Oe)=>Te.name.localeCompare(Oe.name,void 0,{sensitivity:"base"}))}),et=V(()=>{const Z=ue.value.map(ce=>ce.contactId),se=E.value.map(ce=>ce.contactId);return[...Z,...se]}),Je=async Z=>{if(!(_.value[Z]||k.value[Z])){k.value[Z]=!0;try{const ce=(await Rt.getCheckpointChecklist(d.eventId,Z)).data||[];_.value[Z]={total:ce.length,completed:ce.filter(Te=>Te.isCompleted).length}}catch(se){console.error("Failed to load checklist status for checkpoint:",Z,se),_.value[Z]={total:0,completed:0}}finally{k.value[Z]=!1}}};qe(()=>d.area,Z=>{if(Z){const se=Z.polygon?typeof Z.polygon=="string"?JSON.parse(Z.polygon):Z.polygon:[];x.value={name:Z.name||"",description:Z.description||"",color:Z.color||Cr,displayOrder:Z.displayOrder||0,isDefault:Z.isDefault||!1,polygon:se,checkpointStyleType:Z.checkpointStyleType||"default",checkpointStyleColor:Z.checkpointStyleColor||"",checkpointStyleBackgroundShape:Z.checkpointStyleBackgroundShape||"",checkpointStyleBackgroundColor:Z.checkpointStyleBackgroundColor||"",checkpointStyleBorderColor:Z.checkpointStyleBorderColor||"",checkpointStyleIconColor:Z.checkpointStyleIconColor||"",checkpointStyleSize:Z.checkpointStyleSize||"",checkpointStyleMapRotation:Z.checkpointStyleMapRotation??"",peopleTerm:Z.peopleTerm||"",checkpointTerm:Z.checkpointTerm||""}}else x.value=D()},{immediate:!0,deep:!0}),qe(()=>d.show,Z=>{Z&&(f.value=d.initialTab||"details",y.value=[],_.value={},k.value={},E.value=[],A.value=[],S.value=!1,q.value||(x.value=D()),g.value?.resetLocalState&&g.value.resetLocalState())}),qe(f,Z=>{Z==="checkpoints"&&d.area&&d.area.id&&ee.value.forEach(se=>{setTimeout(()=>Je(se.id),0)})});const Ze=()=>{p("update:isDirty",!0)},He=Z=>{x.value.color=Z,Ze()},be=(Z,se)=>{x.value[Z]=se,Ze()},Ve=()=>{p("draw-boundary",x.value)},ve=Z=>{x.value.polygon=Z,Ze()},Le=()=>{x.value.polygon=[],w.value=!1,Ze()},Pe=Z=>{S.value=!1,p("create-contact-from-marshal",{marshal:Z,area:d.area})},W=Z=>{S.value=!1,p("create-new-contact",{name:Z,area:d.area})},Y=Z=>{E.value.find(se=>se.contactId===Z.contactId)||(E.value.push(Z),Ze()),S.value=!1},pe=Z=>{E.value=E.value.filter(se=>se.contactId!==Z),Ze()},Ce=Z=>{A.value.includes(Z)||(A.value.push(Z),Ze())},le=Z=>Z.isPending?"Remove pending contact":`Remove from ${s.value.area}`,J=Z=>{De.value.find(ce=>ce.contactId===Z)?.isPending?pe(Z):Ce(Z)},j=Z=>{A.value=A.value.filter(se=>se!==Z),Ze()},te=Z=>{y.value=Z,Ze()},Re=()=>{Q.value&&(f.value=Q.value.value)},Se=()=>{const Z=d.area?{name:x.value.name,description:x.value.description,color:x.value.color,polygon:x.value.polygon.length>0?x.value.polygon:null,displayOrder:x.value.displayOrder,checkpointStyleType:x.value.checkpointStyleType,checkpointStyleColor:x.value.checkpointStyleColor,checkpointStyleBackgroundShape:x.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:x.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:x.value.checkpointStyleBorderColor,checkpointStyleIconColor:x.value.checkpointStyleIconColor,checkpointStyleSize:x.value.checkpointStyleSize,checkpointStyleMapRotation:x.value.checkpointStyleMapRotation!=null&&x.value.checkpointStyleMapRotation!==""?String(x.value.checkpointStyleMapRotation):null,peopleTerm:x.value.peopleTerm,checkpointTerm:x.value.checkpointTerm,checklistChanges:y.value||[],pendingContacts:E.value||[],contactsToRemove:A.value||[]}:{name:x.value.name,description:x.value.description,color:x.value.color,polygon:x.value.polygon.length>0?x.value.polygon:null,checkpointStyleType:x.value.checkpointStyleType,checkpointStyleColor:x.value.checkpointStyleColor,checkpointStyleBackgroundShape:x.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:x.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:x.value.checkpointStyleBorderColor,checkpointStyleIconColor:x.value.checkpointStyleIconColor,checkpointStyleSize:x.value.checkpointStyleSize,checkpointStyleMapRotation:x.value.checkpointStyleMapRotation!=null&&x.value.checkpointStyleMapRotation!==""?String(x.value.checkpointStyleMapRotation):null,peopleTerm:x.value.peopleTerm,checkpointTerm:x.value.checkpointTerm,pendingContacts:E.value||[]};p("save",Z)},we=()=>{p("delete",d.area.id)},ge=()=>{p("close")};return t({addPendingContact:Z=>{Z&&!E.value.find(se=>se.contactId===Z.contactId)&&(E.value.push(Z),Ze())},removeContactById:Z=>{const se=E.value.some(ce=>ce.contactId===Z);E.value=E.value.filter(ce=>ce.contactId!==Z),A.value=A.value.filter(ce=>ce!==Z),se&&Ze()}}),(Z,se)=>(v(),We(Gt,{show:e.show,title:e.area&&e.area.id?`Edit ${O(s).area}: ${e.area.name}`:`Create new ${O(s).area}`,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:ge},{"tab-header":ze(()=>[Ae(qi,{modelValue:f.value,"onUpdate:modelValue":se[0]||(se[0]=ce=>f.value=ce),tabs:X.value},null,8,["modelValue","tabs"])]),footer:ze(()=>[r("div",$5,[r("div",T5,[q.value&&!x.value.isDefault?(v(),m("button",{key:0,type:"button",onClick:we,class:"btn btn-danger"}," Delete ")):M("",!0),!q.value&&!K.value?(v(),m("button",{key:1,type:"button",onClick:Re,class:"btn btn-secondary mobile-only"},C(he.value),1)):M("",!0)]),r("button",{type:"button",onClick:Se,class:"btn btn-success"}," Save ")])]),default:ze(()=>[f.value==="details"?(v(),m("div",A6,[r("form",{onSubmit:rt(Se,["prevent"])},[r("div",E6,[se[25]||(se[25]=r("label",null,"Name *",-1)),Ue(r("input",{"onUpdate:modelValue":se[1]||(se[1]=ce=>x.value.name=ce),type:"text",required:"",class:"form-input",disabled:x.value.isDefault,onInput:Ze},null,40,P6),[[st,x.value.name]])]),r("div",D6,[se[26]||(se[26]=r("label",null,"Description",-1)),Ue(r("textarea",{"onUpdate:modelValue":se[2]||(se[2]=ce=>x.value.description=ce),class:"form-input",rows:"3",onInput:Ze},null,544),[[st,x.value.description]])])],32)])):M("",!0),f.value==="boundary"?(v(),m("div",R6,[r("div",O6,[x.value.polygon&&x.value.polygon.length>0?(v(),m("div",B6,[Ae(li,{mode:"edit-polygon","editing-polygon":x.value.polygon,route:e.route,locations:e.checkpoints,areas:G.value,"all-locations-for-bounds":P.value,height:"300px",onPolygonUpdate:ve},null,8,["editing-polygon","route","locations","areas","all-locations-for-bounds"]),se[27]||(se[27]=r("p",{class:"boundary-hint"},"Drag points to move them. Click a point to delete it (minimum 3 required).",-1))])):M("",!0),r("div",N6,[!x.value.polygon||x.value.polygon.length===0?(v(),m("button",{key:0,onClick:Ve,class:"btn btn-primary btn-full"}," Draw on map ")):(v(),m(xe,{key:1},[r("button",{onClick:Ve,class:"btn btn-secondary"}," Redraw "),r("button",{onClick:se[3]||(se[3]=ce=>w.value=!0),class:"btn btn-danger"}," Delete boundary ")],64))])])])):M("",!0),Ae(Nl,{show:w.value,title:"Delete boundary",message:"Are you sure you want to delete this boundary? This cannot be undone.","confirm-text":"Delete","is-danger":!0,onConfirm:Le,onCancel:se[4]||(se[4]=ce=>w.value=!1)},null,8,["show"]),f.value==="contacts"?(v(),m("div",F6,[r("div",U6,[r("h3",z6,C(O(a).area)+" contacts ("+C(De.value.length)+")",1),r("button",{onClick:se[5]||(se[5]=ce=>S.value=!0),class:"btn btn-primary btn-small"}," Add contact ")]),Ae(Zv,{contacts:De.value,"show-remove-button":!0,"remove-title":le,"empty-message":`No contacts assigned to this ${O(s).area}.`,"empty-hint":`Click 'Add contact' to assign contacts who will be visible to ${O(s).people} in this ${O(s).area}.`,onSelect:se[6]||(se[6]=ce=>Z.$emit("edit-contact",ce)),onRemove:J,onUndoRemove:j},null,8,["contacts","empty-message","empty-hint"])])):M("",!0),Ae(M6,{show:S.value,"area-name":x.value.name||"this "+O(s).area,"area-id":d.area?.id||"",contacts:d.contacts,marshals:d.marshals,"exclude-contact-ids":et.value,onClose:se[7]||(se[7]=ce=>S.value=!1),onSelectContact:Y,onCreateFromMarshal:Pe,onCreateNew:W},null,8,["show","area-name","area-id","contacts","marshals","exclude-contact-ids"]),f.value==="checkpoints"&&q.value?(v(),m("div",H6,[r("h3",V6,C(l())+" in "+C(e.area?.name)+" ("+C(ee.value.length)+")",1),Ae(Jv,{checkpoints:fe.value,areas:e.areas,"empty-message":`No ${u()} in this ${O(s).area} yet.`,onSelect:se[8]||(se[8]=ce=>Z.$emit("select-checkpoint",ce))},null,8,["checkpoints","areas","empty-message"])])):M("",!0),f.value==="checkpoints"&&!q.value?(v(),m("div",G6,[r("p",null,C(l())+" will be automatically assigned based on boundaries after the "+C(O(s).area)+" is created.",1)])):M("",!0),f.value==="checklists"&&q.value?(v(),We(Xv,{key:5,ref_key:"checklistTabRef",ref:g,modelValue:y.value,"onUpdate:modelValue":se[9]||(se[9]=ce=>y.value=ce),"event-id":e.eventId,"area-id":e.area.id,locations:e.allLocations,areas:e.areas,assignments:U.value,onChange:te},null,8,["modelValue","event-id","area-id","locations","areas","assignments"])):M("",!0),f.value==="checklists"&&!q.value?(v(),m("div",j6,[r("p",null,C(O(a).checklists)+" can be assigned after the "+C(O(s).area)+" is created.",1)])):M("",!0),f.value==="notes"&&q.value?(v(),We(gc,{key:7,"event-id":e.eventId,"area-id":e.area?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","area-id","all-notes","locations","areas","assignments"])):M("",!0),f.value==="notes"&&!q.value?(v(),m("div",Z6,[r("p",null,"Notes can be viewed after the "+C(O(s).area)+" is created.",1)])):M("",!0),f.value==="appearance"?(v(),m("div",q6,[r("div",W6,[r("button",{type:"button",class:de(["accordion-header",{expanded:F.value.polygonColor}]),onClick:se[10]||(se[10]=ce=>T("polygonColor"))},[r("div",{class:"accordion-icon",innerHTML:N.value},null,8,K6),r("span",J6,C(O(a).area)+" polygon colour",1),r("span",Y6,C(F.value.polygonColor?"":""),1)],2),F.value.polygonColor?(v(),m("div",X6,[r("p",Q6," Choose a colour for this "+C(O(s).area)+"'s boundary on the map. ",1),r("div",e5,[(v(!0),m(xe,null,Ne(O(An),ce=>(v(),m("div",{key:ce.hex,class:de(["color-swatch",{selected:x.value.color===ce.hex}]),style:Qe({backgroundColor:ce.hex}),title:ce.name,onClick:Te=>He(ce.hex)},null,14,t5))),128))])])):M("",!0)]),r("div",n5,[r("button",{type:"button",class:de(["accordion-header",{expanded:F.value.iconStyle}]),onClick:se[11]||(se[11]=ce=>T("iconStyle"))},[r("div",{class:"accordion-icon",innerHTML:B.value},null,8,o5),r("span",s5,C(l(!1))+" marker style",1),r("span",a5,C(F.value.iconStyle?"":""),1)],2),F.value.iconStyle?(v(),m("div",i5,[r("p",l5," Set a default marker style for all "+C(u())+" in this "+C(O(s).area)+". Individual "+C(u())+" can override this setting. ",1),Ae(ad,{"style-type":x.value.checkpointStyleType||"default","style-color":x.value.checkpointStyleColor||"","style-background-shape":x.value.checkpointStyleBackgroundShape||"","style-background-color":x.value.checkpointStyleBackgroundColor||"","style-border-color":x.value.checkpointStyleBorderColor||"","style-icon-color":x.value.checkpointStyleIconColor||"","style-size":x.value.checkpointStyleSize||"","style-map-rotation":x.value.checkpointStyleMapRotation??"","inherited-style-type":e.eventDefaultStyleType,"inherited-style-color":e.eventDefaultStyleColor,"inherited-background-shape":e.eventDefaultStyleBackgroundShape||"","inherited-background-color":e.eventDefaultStyleBackgroundColor||e.eventDefaultStyleColor||"","inherited-border-color":e.eventDefaultStyleBorderColor||"","inherited-icon-color":e.eventDefaultStyleIconColor||"","inherited-size":e.eventDefaultStyleSize||"","inherited-map-rotation":e.eventDefaultStyleMapRotation??"","default-label":"Event default","icon-label":"Marker style",level:"area","show-preview":!0,"onUpdate:styleType":se[12]||(se[12]=ce=>be("checkpointStyleType",ce)),"onUpdate:styleColor":se[13]||(se[13]=ce=>be("checkpointStyleColor",ce)),"onUpdate:styleBackgroundShape":se[14]||(se[14]=ce=>be("checkpointStyleBackgroundShape",ce)),"onUpdate:styleBackgroundColor":se[15]||(se[15]=ce=>be("checkpointStyleBackgroundColor",ce)),"onUpdate:styleBorderColor":se[16]||(se[16]=ce=>be("checkpointStyleBorderColor",ce)),"onUpdate:styleIconColor":se[17]||(se[17]=ce=>be("checkpointStyleIconColor",ce)),"onUpdate:styleSize":se[18]||(se[18]=ce=>be("checkpointStyleSize",ce)),"onUpdate:styleMapRotation":se[19]||(se[19]=ce=>be("checkpointStyleMapRotation",ce))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])])):M("",!0)]),r("div",r5,[r("button",{type:"button",class:de(["accordion-header",{expanded:F.value.peopleTerm}]),onClick:se[20]||(se[20]=ce=>T("peopleTerm"))},[se[28]||(se[28]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("circle",{cx:"12",cy:"8",r:"4",fill:"#6366F1"}),r("path",{d:"M4 20c0-4.4 3.6-8 8-8s8 3.6 8 8",fill:"#6366F1",opacity:"0.6"})])],-1)),r("span",c5,C(i())+" terminology",1),r("span",u5,C(x.value.peopleTerm||`${e.eventPeopleTerm} (event default)`),1),r("span",d5,C(F.value.peopleTerm?"":""),1)],2),F.value.peopleTerm?(v(),m("div",h5,[r("p",f5," Choose what "+C(i().toLowerCase())+" are called in this "+C(O(s).area)+". This will be inherited by "+C(u())+" unless they override it. ",1),r("div",p5,[se[29]||(se[29]=r("label",null,"What are people called?",-1)),Ue(r("select",{"onUpdate:modelValue":se[21]||(se[21]=ce=>x.value.peopleTerm=ce),class:"form-input",onChange:Ze},[r("option",v5,"Use event default ("+C(e.eventPeopleTerm)+")",1),(v(!0),m(xe,null,Ne(O(Os).people,ce=>(v(),m("option",{key:ce,value:ce},C(ce),9,m5))),128))],544),[[Bn,x.value.peopleTerm]])])])):M("",!0)]),r("div",g5,[r("button",{type:"button",class:de(["accordion-header",{expanded:F.value.checkpointTerm}]),onClick:se[22]||(se[22]=ce=>T("checkpointTerm"))},[se[30]||(se[30]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z",fill:"#10B981"}),r("circle",{cx:"12",cy:"9",r:"2.5",fill:"white"})])],-1)),r("span",y5,C(l(!1))+" terminology",1),r("span",k5,C(x.value.checkpointTerm?O(Su)(x.value.checkpointTerm,i()):`${e.eventCheckpointTerm} (event default)`),1),r("span",_5,C(F.value.checkpointTerm?"":""),1)],2),F.value.checkpointTerm?(v(),m("div",b5,[r("p",w5," Choose what "+C(u())+" are called in this "+C(O(s).area)+". ",1),r("div",C5,[r("label",null,"What are "+C(u())+" called?",1),Ue(r("select",{"onUpdate:modelValue":se[23]||(se[23]=ce=>x.value.checkpointTerm=ce),class:"form-input",onChange:Ze},[r("option",L5,"Use event default ("+C(e.eventCheckpointTerm)+")",1),(v(!0),m(xe,null,Ne(O(Os).checkpoint,ce=>(v(),m("option",{key:ce,value:ce},C(O(Su)(ce,i())),9,S5))),128))],544),[[Bn,x.value.checkpointTerm]])])])):M("",!0)])])):M("",!0),f.value==="incidents"?(v(),m("div",x5,[r("div",I5,[(v(!0),m(xe,null,Ne(e.incidents,ce=>(v(),We(Wl,{key:ce.incidentId,incident:ce,onSelect:se[24]||(se[24]=Te=>Z.$emit("select-incident",Te))},null,8,["incident"]))),128))])])):M("",!0)]),_:1},8,["show","title","is-dirty"]))}},A5=je(M5,[["__scopeId","data-v-94cf46bf"]]),E5=["innerHTML"],P5={__name:"InfoModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Information"},message:{type:String,required:!0},okText:{type:String,default:"OK"}},emits:["close"],setup(e,{emit:t}){const o=t,a=()=>{o("close")};return(s,i)=>(v(),We(Gt,{show:e.show,title:e.title,size:"small","z-index":2e3,onClose:a},{actions:ze(()=>[r("button",{onClick:a,class:"btn btn-primary"},C(e.okText),1)]),default:ze(()=>[r("div",{class:"info-content",innerHTML:e.message},null,8,E5)]),_:1},8,["show","title"]))}},yc=je(P5,[["__scopeId","data-v-a6e7148c"]]),D5={class:"tab-content"},R5={class:"form-group"},O5={for:"text"},B5=["placeholder"],N5={key:0,class:"checkbox-label-inline create-separate-items"},F5={class:"tab-content"},U5={class:"custom-footer"},z5={class:"footer-left"},H5={__name:"EditChecklistItemModal",props:{show:{type:Boolean,default:!1},checklistItem:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{termsLower:o,termsSentence:a}=ut(),s=e,i=t,l=$(!1),u=$(""),d=$("details"),p=$({text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0}),f=V(()=>!!s.checklistItem),g=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],y=V(()=>g.findIndex(T=>T.value===d.value)),_=V(()=>y.value===g.length-1),k=V(()=>_.value?"":g[y.value+1]?.label||"");qe(()=>s.show,T=>{T&&(d.value=s.initialTab,s.checklistItem?p.value={text:s.checklistItem.text||"",scopeConfigurations:s.checklistItem.scopeConfigurations?JSON.parse(JSON.stringify(s.checklistItem.scopeConfigurations)):[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:s.checklistItem.displayOrder||0,isRequired:s.checklistItem.isRequired!==!1,visibleFrom:s.checklistItem.visibleFrom?w(s.checklistItem.visibleFrom):null,visibleUntil:s.checklistItem.visibleUntil?w(s.checklistItem.visibleUntil):null,mustCompleteBy:s.checklistItem.mustCompleteBy?w(s.checklistItem.mustCompleteBy):null,createSeparateItems:!1}:p.value={text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0},i("update:isDirty",!1))});const w=T=>{if(!T)return null;const N=new Date(T),B=N.getTimezoneOffset();return new Date(N.getTime()-B*60*1e3).toISOString().slice(0,16)},S=T=>T?new Date(T).toISOString():null,E=()=>{i("update:isDirty",!0)},A=()=>{i("close")},x=()=>{_.value||(d.value=g[y.value+1].value)},D=T=>{u.value=T,l.value=!0},R=()=>{if(!p.value.text||!p.value.text.trim()){D(`Please enter ${o.value.checklist} text`);return}if(!p.value.scopeConfigurations||p.value.scopeConfigurations.length===0){D("Please select at least one scope");return}if(!p.value.scopeConfigurations.some(B=>!(B.itemType!==null&&(!B.ids||B.ids.length===0)))){D("Please configure at least one scope with valid selections");return}const N={text:p.value.text,scopeConfigurations:p.value.scopeConfigurations,displayOrder:p.value.displayOrder||0,isRequired:p.value.isRequired,visibleFrom:S(p.value.visibleFrom),visibleUntil:S(p.value.visibleUntil),mustCompleteBy:S(p.value.mustCompleteBy)};f.value||(N.createSeparateItems=p.value.createSeparateItems),i("save",N)},F=()=>{i("delete",s.checklistItem.itemId)};return(T,N)=>(v(),m(xe,null,[Ae(Gt,{show:e.show,title:f.value?`Edit ${O(o).checklist}`:`Create ${O(o).checklist}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:A},{"tab-header":ze(()=>[Ae(qi,{modelValue:d.value,"onUpdate:modelValue":N[0]||(N[0]=B=>d.value=B),tabs:g},null,8,["modelValue"])]),footer:ze(()=>[r("div",U5,[r("div",z5,[f.value?(v(),m("button",{key:0,type:"button",onClick:F,class:"btn btn-danger"}," Delete ")):M("",!0),!f.value&&!_.value?(v(),m("button",{key:1,type:"button",onClick:x,class:"btn btn-secondary mobile-only"},C(k.value)+"... ",1)):M("",!0)]),r("button",{type:"button",onClick:R,class:"btn btn-success"}," Save ")])]),default:ze(()=>[r("form",{onSubmit:rt(R,["prevent"]),class:"checklist-form"},[Ue(r("div",D5,[r("div",R5,[r("label",O5,C(O(a).checklist)+" text: *",1),Ue(r("textarea",{id:"text","onUpdate:modelValue":N[1]||(N[1]=B=>p.value.text=B),onInput:E,required:"",rows:"3",placeholder:p.value.createSeparateItems?`Enter ${O(o).checklists}, one per line...`:`Enter the ${O(o).checklist} text...`},null,40,B5),[[st,p.value.text]]),f.value?M("",!0):(v(),m("label",N5,[Ue(r("input",{type:"checkbox","onUpdate:modelValue":N[2]||(N[2]=B=>p.value.createSeparateItems=B),onChange:E},null,544),[[xa,p.value.createSeparateItems]]),N[5]||(N[5]=r("span",null,"Each line creates a new item",-1))]))])],512),[[ys,d.value==="details"]]),Ue(r("div",F5,[Ae(mc,{modelValue:p.value.scopeConfigurations,"onUpdate:modelValue":N[3]||(N[3]=B=>p.value.scopeConfigurations=B),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":f.value,onUserChanged:E},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ys,d.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ae(yc,{show:l.value,title:"Validation error",message:u.value,onClose:N[4]||(N[4]=B=>l.value=!1)},null,8,["show","message"])],64))}},V5=je(H5,[["__scopeId","data-v-eddaaf3c"]]),G5={class:"tab-content"},j5={class:"form-group"},Z5={class:"form-group"},q5={class:"form-row"},W5={class:"form-group"},K5={class:"checkbox-label-inline show-emergency-checkbox"},J5={class:"form-group"},Y5={class:"form-row"},X5={class:"form-group"},Q5={class:"form-group checkbox-group-inline"},e8={class:"checkbox-label-inline"},t8={class:"tab-content"},n8={class:"custom-footer"},o8={class:"footer-left"},s8={__name:"EditNoteModal",props:{show:{type:Boolean,default:!1},note:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,s=$(!1),i=$(""),l=$("details"),u=$({title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1}),d=D=>D==="Urgent"||D==="Emergency",p=V(()=>!!o.note),f=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],g=V(()=>f.findIndex(D=>D.value===l.value)),y=V(()=>g.value===f.length-1),_=V(()=>y.value?"":f[g.value+1]?.label||"");qe(()=>o.show,D=>{D&&(l.value=o.initialTab,o.note?u.value={title:o.note.title||"",content:o.note.content||"",scopeConfigurations:o.note.scopeConfigurations?JSON.parse(JSON.stringify(o.note.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:o.note.displayOrder||0,priority:o.note.priority||"Normal",category:o.note.category||"",isPinned:o.note.isPinned||!1,showInEmergencyInfo:o.note.showInEmergencyInfo??d(o.note.priority)}:u.value={title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1},a("update:isDirty",!1))}),qe(()=>u.value.priority,(D,R)=>{!p.value&&D!==R&&(d(D)?u.value.showInEmergencyInfo=!0:d(R)&&(u.value.showInEmergencyInfo=!1))});const k=()=>{a("update:isDirty",!0)},w=()=>{a("close")},S=()=>{y.value||(l.value=f[g.value+1].value)},E=D=>{i.value=D,s.value=!0},A=()=>{if(!u.value.title||!u.value.title.trim()){E("Please enter a note title");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){E("Please select at least one visibility scope");return}if(!u.value.scopeConfigurations.some(F=>!(F.itemType!==null&&(!F.ids||F.ids.length===0)))){E("Please configure at least one scope with valid selections");return}const R={title:u.value.title.trim(),content:u.value.content||"",scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,priority:u.value.priority||"Normal",category:u.value.category?.trim()||null,isPinned:u.value.isPinned||!1,showInEmergencyInfo:u.value.showInEmergencyInfo};a("save",R)},x=()=>{a("delete",o.note.noteId)};return(D,R)=>(v(),m(xe,null,[Ae(Gt,{show:e.show,title:p.value?"Edit note":"Create note",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:w},{"tab-header":ze(()=>[Ae(qi,{modelValue:l.value,"onUpdate:modelValue":R[0]||(R[0]=F=>l.value=F),tabs:f},null,8,["modelValue"])]),footer:ze(()=>[r("div",n8,[r("div",o8,[p.value?(v(),m("button",{key:0,type:"button",onClick:x,class:"btn btn-danger"}," Delete ")):M("",!0),!p.value&&!y.value?(v(),m("button",{key:1,type:"button",onClick:S,class:"btn btn-secondary mobile-only"},C(_.value)+"... ",1)):M("",!0)]),r("button",{type:"button",onClick:A,class:"btn btn-success"}," Save ")])]),default:ze(()=>[r("form",{onSubmit:rt(A,["prevent"]),class:"note-form"},[Ue(r("div",G5,[r("div",j5,[R[10]||(R[10]=r("label",{for:"title"},"Title: *",-1)),Ue(r("input",{id:"title","onUpdate:modelValue":R[1]||(R[1]=F=>u.value.title=F),type:"text",onInput:k,required:"",placeholder:"Enter note title..."},null,544),[[st,u.value.title]])]),r("div",Z5,[R[11]||(R[11]=r("label",{for:"content"},"Content:",-1)),Ue(r("textarea",{id:"content","onUpdate:modelValue":R[2]||(R[2]=F=>u.value.content=F),onInput:k,rows:"6",placeholder:"Enter note content (supports markdown)..."},null,544),[[st,u.value.content]])]),r("div",q5,[r("div",W5,[R[14]||(R[14]=r("label",{for:"priority"},"Priority:",-1)),Ue(r("select",{id:"priority","onUpdate:modelValue":R[3]||(R[3]=F=>u.value.priority=F),onChange:k},[...R[12]||(R[12]=[r("option",{value:"Emergency"},"Emergency",-1),r("option",{value:"Urgent"},"Urgent",-1),r("option",{value:"High"},"High",-1),r("option",{value:"Normal"},"Normal",-1),r("option",{value:"Low"},"Low",-1)])],544),[[Bn,u.value.priority]]),r("label",K5,[Ue(r("input",{type:"checkbox","onUpdate:modelValue":R[4]||(R[4]=F=>u.value.showInEmergencyInfo=F),onChange:k},null,544),[[xa,u.value.showInEmergencyInfo]]),R[13]||(R[13]=r("span",null,"Show in emergency info",-1))])]),r("div",J5,[R[15]||(R[15]=r("label",{for:"category"},"Category:",-1)),Ue(r("input",{id:"category","onUpdate:modelValue":R[5]||(R[5]=F=>u.value.category=F),type:"text",onInput:k,placeholder:"e.g., Safety, Logistics..."},null,544),[[st,u.value.category]])])]),r("div",Y5,[r("div",X5,[R[16]||(R[16]=r("label",{for:"displayOrder"},"Display order:",-1)),Ue(r("input",{id:"displayOrder","onUpdate:modelValue":R[6]||(R[6]=F=>u.value.displayOrder=F),type:"number",onInput:k,min:"0"},null,544),[[st,u.value.displayOrder,void 0,{number:!0}]]),R[17]||(R[17]=r("span",{class:"help-text"},"Lower numbers appear first",-1))]),r("div",Q5,[r("label",e8,[Ue(r("input",{type:"checkbox","onUpdate:modelValue":R[7]||(R[7]=F=>u.value.isPinned=F),onChange:k},null,544),[[xa,u.value.isPinned]]),R[18]||(R[18]=r("span",null,"Pin to top",-1))]),R[19]||(R[19]=r("span",{class:"help-text"},"Pinned notes always appear at the top",-1))])])],512),[[ys,l.value==="details"]]),Ue(r("div",t8,[Ae(mc,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":R[8]||(R[8]=F=>u.value.scopeConfigurations=F),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":p.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this note?",onUserChanged:k},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ys,l.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ae(yc,{show:s.value,title:"Validation error",message:i.value,onClose:R[9]||(R[9]=F=>s.value=!1)},null,8,["show","message"])],64))}},a8=je(s8,[["__scopeId","data-v-e8488047"]]),i8={class:"incident-detail-header"},l8={class:"header-title-row"},r8={class:"modal-title"},c8={class:"header-badges"},u8=["disabled"],d8={key:0,class:"status-dropdown-menu"},h8=["onClick","disabled"],f8={key:0,class:"incident-detail-content"},p8={class:"accordion-section"},v8={class:"accordion-arrow"},m8={key:0,class:"accordion-content"},g8={class:"description-text"},y8={class:"accordion-section"},k8={class:"accordion-arrow"},_8={key:0,class:"accordion-content"},b8={class:"info-grid"},w8={class:"info-item"},C8={class:"info-value"},L8={class:"info-item"},S8={class:"info-value"},x8={key:0,class:"info-item"},I8={class:"info-label"},$8={class:"info-value"},T8={key:1,class:"info-item"},M8={class:"info-label"},A8={class:"info-value"},E8={key:2,class:"info-item"},P8={class:"info-value"},D8={key:0,class:"incident-map-container"},R8={class:"accordion-section"},O8={class:"accordion-preview"},B8={class:"accordion-arrow"},N8={key:0,class:"accordion-content"},F8={class:"reporter-info"},U8={class:"reporter-name"},z8={key:0,class:"accordion-section"},H8={class:"accordion-title"},V8={class:"accordion-preview"},G8={class:"accordion-arrow"},j8={key:0,class:"accordion-content"},Z8={class:"marshals-list"},q8={class:"marshal-name"},W8={key:0,class:"checkin-badge success"},K8={key:1,class:"checkin-badge not-checked-in"},J8={class:"accordion-section"},Y8={key:0,class:"accordion-preview"},X8={class:"accordion-arrow"},Q8={key:0,class:"accordion-content"},eD={key:0,class:"notes-timeline"},tD={class:"note-header"},nD={class:"note-author"},oD={class:"note-time"},sD={key:0,class:"note-status-change"},aD={key:1,class:"note-text"},iD={key:1,class:"no-notes"},lD={__name:"IncidentDetailModal",props:{show:{type:Boolean,required:!0},incident:{type:Object,default:null},canManage:{type:Boolean,default:!1},route:{type:Array,default:()=>[]},checkpoints:{type:Array,default:()=>[]}},emits:["close","status-change","open-add-note"],setup(e,{emit:t}){const{terms:o,termsSentence:a}=ut(),s=e,i=t,l=$(!1),u=$(!1),d=$(null),p=$({description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1});qe(()=>s.show,q=>{q&&(p.value={description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1},u.value=!1)});const f=q=>{d.value&&!d.value.contains(q.target)&&(u.value=!1)};qe(u,q=>{q?document.addEventListener("click",f):document.removeEventListener("click",f)});const g=()=>{u.value=!u.value},y=q=>{s.incident?.status!==q&&(u.value=!1,B(q))},_=q=>{const P=p.value[q];Object.keys(p.value).forEach(G=>{p.value[G]=!1}),P||(p.value[q]=!0)},k=V(()=>s.incident?.latitude!=null&&s.incident?.longitude!=null),w=V(()=>k.value?{lat:s.incident.latitude,lng:s.incident.longitude}:null),S=V(()=>k.value?{lat:s.incident.latitude,lng:s.incident.longitude}:null),E=V(()=>{if(!s.incident)return"Incident Details";if(s.incident.title)return s.incident.title;const q=s.incident.description||"";return q.length<=50?q:q.substring(0,47)+"..."}),A=V(()=>[...s.incident?.context?.marshalsPresentAtCheckpoint||[]].sort((P,G)=>(P.name||"").localeCompare(G.name||"",void 0,{sensitivity:"base"}))),x=[{value:"open",label:"Open"},{value:"acknowledged",label:"Acknowledged"},{value:"in_progress",label:"In Progress"},{value:"resolved",label:"Resolved"},{value:"closed",label:"Closed"}],D=q=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[q]||q,R=q=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[q]||q,F=q=>{if(!q)return"";let P=q.name||"";if(q.description){const G=q.description,X=40,ne=G.length>X?G.substring(0,X-3)+"...":G;P+=` - ${ne}`}return P},T=q=>q?new Date(q).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",N=q=>{if(!q)return"";const P=new Date(q),X=new Date-P,ne=Math.floor(X/6e4),K=Math.floor(X/36e5),Q=Math.floor(X/864e5);return ne<1?"just now":ne<60?`${ne}m ago`:K<24?`${K}h ago`:Q<7?`${Q}d ago`:P.toLocaleDateString()},B=async q=>{if(s.incident?.status!==q){l.value=!0;try{i("status-change",{incidentId:s.incident.incidentId,status:q})}finally{l.value=!1}}};return(q,P)=>(v(),We(Gt,{show:e.show,title:E.value,size:"large",onClose:P[7]||(P[7]=G=>q.$emit("close"))},{header:ze(()=>[r("div",i8,[r("div",l8,[r("span",{class:de(["severity-indicator",e.incident?.severity])},null,2),r("h2",r8,C(E.value),1)]),r("div",c8,[r("span",{class:de(["severity-badge",e.incident?.severity])},C(D(e.incident?.severity)),3),e.canManage?(v(),m("div",{key:0,class:"status-dropdown-container",ref_key:"statusDropdownRef",ref:d},[r("button",{type:"button",class:de(["status-badge status-dropdown-trigger",e.incident?.status]),onClick:g,disabled:l.value},[Ye(C(R(e.incident?.status))+" ",1),P[8]||(P[8]=r("span",{class:"dropdown-arrow"},"",-1))],10,u8),u.value?(v(),m("div",d8,[(v(),m(xe,null,Ne(x,G=>r("button",{key:G.value,type:"button",class:de(["status-dropdown-item",{active:e.incident?.status===G.value}]),onClick:X=>y(G.value),disabled:e.incident?.status===G.value},[r("span",{class:de(["status-dot",G.value])},null,2),Ye(" "+C(G.label),1)],10,h8)),64))])):M("",!0)],512)):(v(),m("span",{key:1,class:de(["status-badge",e.incident?.status])},C(R(e.incident?.status)),3))])])]),footer:ze(()=>[r("button",{class:"btn btn-secondary",onClick:P[6]||(P[6]=G=>q.$emit("close"))},"Close")]),default:ze(()=>[e.incident?(v(),m("div",f8,[r("div",p8,[r("button",{type:"button",class:de(["accordion-header",{expanded:p.value.description}]),onClick:P[0]||(P[0]=G=>_("description"))},[P[9]||(P[9]=r("span",{class:"accordion-title"},"Description",-1)),r("span",v8,C(p.value.description?"":""),1)],2),p.value.description?(v(),m("div",m8,[r("p",g8,C(e.incident.description),1)])):M("",!0)]),r("div",y8,[r("button",{type:"button",class:de(["accordion-header",{expanded:p.value.timeLocation}]),onClick:P[1]||(P[1]=G=>_("timeLocation"))},[P[10]||(P[10]=r("span",{class:"accordion-title"},"Time & location",-1)),r("span",k8,C(p.value.timeLocation?"":""),1)],2),p.value.timeLocation?(v(),m("div",_8,[r("div",b8,[r("div",w8,[P[11]||(P[11]=r("span",{class:"info-label"},"Incident time",-1)),r("span",C8,C(T(e.incident.incidentTime)),1)]),r("div",L8,[P[12]||(P[12]=r("span",{class:"info-label"},"Reported at",-1)),r("span",S8,C(T(e.incident.createdAt)),1)]),e.incident.context?.checkpoint?(v(),m("div",x8,[r("span",I8,C(O(a).checkpoint),1),r("span",$8,C(F(e.incident.context.checkpoint)),1)])):M("",!0),e.incident.area?(v(),m("div",T8,[r("span",M8,C(O(a).area),1),r("span",A8,C(e.incident.area.areaName),1)])):M("",!0),k.value?(v(),m("div",E8,[P[13]||(P[13]=r("span",{class:"info-label"},"GPS location",-1)),r("span",P8,C(e.incident.latitude.toFixed(6))+", "+C(e.incident.longitude.toFixed(6)),1)])):M("",!0)]),k.value?(v(),m("div",D8,[Ae(li,{locations:e.checkpoints,route:e.route,center:w.value,zoom:15,"user-location":S.value,height:"200px"},null,8,["locations","route","center","user-location"])])):M("",!0)])):M("",!0)]),r("div",R8,[r("button",{type:"button",class:de(["accordion-header",{expanded:p.value.reporter}]),onClick:P[2]||(P[2]=G=>_("reporter"))},[P[14]||(P[14]=r("span",{class:"accordion-title"},"Reported by",-1)),r("span",O8,C(e.incident.reportedBy?.name||"Unknown"),1),r("span",B8,C(p.value.reporter?"":""),1)],2),p.value.reporter?(v(),m("div",N8,[r("div",F8,[r("span",U8,C(e.incident.reportedBy?.name||"Unknown"),1)])])):M("",!0)]),A.value.length?(v(),m("div",z8,[r("button",{type:"button",class:de(["accordion-header",{expanded:p.value.marshals}]),onClick:P[3]||(P[3]=G=>_("marshals"))},[r("span",H8,C(O(o).peoplePlural)+" at "+C(O(o).checkpoint.toLowerCase()),1),r("span",V8,C(A.value.length),1),r("span",G8,C(p.value.marshals?"":""),1)],2),p.value.marshals?(v(),m("div",j8,[r("div",Z8,[(v(!0),m(xe,null,Ne(A.value,G=>(v(),m("div",{key:G.marshalId,class:de(["marshal-item",{"checked-in":G.wasCheckedIn}])},[r("span",q8,C(G.name),1),G.wasCheckedIn?(v(),m("span",W8," Checked in "+C(N(G.checkInTime)),1)):(v(),m("span",K8," Not checked in "))],2))),128))])])):M("",!0)])):M("",!0),r("div",J8,[r("button",{type:"button",class:de(["accordion-header",{expanded:p.value.notes}]),onClick:P[4]||(P[4]=G=>_("notes"))},[P[15]||(P[15]=r("span",{class:"accordion-title"},"Updates",-1)),e.incident.updates?.length?(v(),m("span",Y8,C(e.incident.updates.length),1)):M("",!0),r("span",X8,C(p.value.notes?"":""),1)],2),p.value.notes?(v(),m("div",Q8,[e.incident.updates?.length?(v(),m("div",eD,[(v(!0),m(xe,null,Ne(e.incident.updates,(G,X)=>(v(),m("div",{key:X,class:"note-item"},[r("div",tD,[r("span",nD,C(G.authorName||"System"),1),r("span",oD,C(N(G.timestamp)),1)]),G.statusChange?(v(),m("div",sD,[P[16]||(P[16]=Ye(" Status changed to ",-1)),r("span",{class:de(["status-badge",G.statusChange])},C(R(G.statusChange)),3)])):G.note?(v(),m("p",aD,C(G.note),1)):M("",!0)]))),128))])):(v(),m("div",iD," No updates yet. ")),r("button",{type:"button",class:"btn btn-primary add-note-btn",onClick:P[5]||(P[5]=G=>q.$emit("open-add-note"))}," Add update ")])):M("",!0)])])):M("",!0)]),_:1},8,["show","title"]))}},Qv=je(lD,[["__scopeId","data-v-df0707d4"]]),rD={class:"form-group"},cD={class:"form-group"},uD={class:"form-row"},dD={class:"form-group form-group-half"},hD=["value"],fD={class:"form-group form-group-half"},pD={key:0,class:"form-group"},vD={for:"checkpoint",class:"form-label"},mD=["value"],gD={key:1,class:"form-group"},yD={class:"form-label"},kD={class:"checkpoint-toggle"},_D={class:"checkbox-label"},bD={class:"checkpoint-name"},wD={key:0,class:"checkpoint-description"},CD={class:"form-group"},LD={class:"location-options"},SD={class:"location-buttons"},xD={key:0,class:"location-status"},ID={key:0,class:"location-getting"},$D={key:1,class:"location-display"},TD={key:0,class:"location-accuracy"},MD={key:2,class:"location-error"},AD={key:1,class:"map-picker-container"},ED={key:0,class:"map-picker-hint"},PD={key:2,class:"location-display"},DD={key:2,class:"error-message"},RD={class:"modal-actions"},OD=["disabled"],BD={__name:"ReportIncidentModal",props:{show:{type:Boolean,required:!0},eventId:{type:String,required:!0},checkpoint:{type:Object,default:null},initialLocation:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]}},emits:["close","submit"],setup(e,{emit:t}){const{termsSentence:o}=ut(),a=e,s=t,i=$({title:"",description:"",severity:"medium",incidentTime:""}),l=$(""),u=$(!0),d=$("none"),p=$(!1),f=$(null),g=$(null),y=$(null),_=$(!1),k=$(!1),w=$(null),S=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],E=()=>{const G=new Date,X=G.getFullYear(),ne=String(G.getMonth()+1).padStart(2,"0"),K=String(G.getDate()).padStart(2,"0"),Q=String(G.getHours()).padStart(2,"0"),he=String(G.getMinutes()).padStart(2,"0");return`${X}-${ne}-${K}T${Q}:${he}`},A=G=>G?new Date(G).toISOString():null,x=V(()=>a.checkpoints||[]),D=V(()=>{if(f.value?.latitude!=null)return{lat:f.value.latitude,lng:f.value.longitude};if(l.value){const G=x.value.find(X=>X.id===l.value);if(G?.latitude!=null)return{lat:G.latitude,lng:G.longitude}}if(a.initialLocation?.latitude!=null)return{lat:a.initialLocation.latitude,lng:a.initialLocation.longitude};if(a.checkpoint?.latitude!=null)return{lat:a.checkpoint.latitude,lng:a.checkpoint.longitude};if(x.value.length>0){const G=x.value[0];if(G.latitude!=null)return{lat:G.latitude,lng:G.longitude}}if(a.route?.length>0){const G=a.route[0];if(G?.lat!=null)return{lat:G.lat,lng:G.lng}}return{lat:-33.9,lng:151.2}}),R=V(()=>i.value.description.trim()!==""),F=V(()=>i.value.description.trim()!=="");qe(()=>a.show,G=>{G&&(i.value={title:"",description:"",severity:"medium",incidentTime:E()},l.value="",u.value=!0,k.value=!1,w.value=null,y.value=null,f.value=null,g.value=null,a.initialLocation&&a.initialLocation.latitude!=null?(f.value={latitude:a.initialLocation.latitude,longitude:a.initialLocation.longitude},g.value=a.initialLocation.accuracy,d.value="gps",p.value=!1):(d.value="none",p.value=!1),a.checkpoint&&(l.value=a.checkpoint.locationId||a.checkpoint.id||""))});const T=G=>{y.value=null,G==="map"?d.value==="map"?p.value=!p.value:(d.value="map",p.value=!0,g.value=null):G==="gps"?(d.value="gps",p.value=!1,B()):(d.value="none",p.value=!1,f.value=null,g.value=null)},N=G=>{f.value={latitude:G.lat,longitude:G.lng},g.value=null,p.value=!1},B=()=>{if(a.initialLocation&&a.initialLocation.latitude!=null){f.value={latitude:a.initialLocation.latitude,longitude:a.initialLocation.longitude},g.value=a.initialLocation.accuracy;return}if(!navigator.geolocation){y.value="GPS is not available on this device.";return}_.value=!0,navigator.geolocation.getCurrentPosition(G=>{f.value={latitude:G.coords.latitude,longitude:G.coords.longitude},g.value=G.coords.accuracy,_.value=!1},G=>{y.value="Unable to get your location.",_.value=!1},{enableHighAccuracy:!0,timeout:1e4})},q=async()=>{if(!(!F.value||k.value)){k.value=!0,w.value=null;try{const G=(d.value==="gps"||d.value==="map")&&f.value;let X=null,ne=!1;x.value.length>0?l.value?X=l.value:ne=!0:a.checkpoint&&(u.value?X=a.checkpoint.locationId||a.checkpoint.id||null:ne=!0);const K={title:i.value.title.trim()||null,description:i.value.description.trim(),severity:i.value.severity,incidentTime:A(i.value.incidentTime),latitude:G?f.value.latitude:null,longitude:G?f.value.longitude:null,checkpointId:X,skipCheckpointAutoAssign:ne};s("submit",K)}catch(G){w.value=G.message||"Failed to report incident. Please try again.",k.value=!1}}},P=()=>{s("close")};return(G,X)=>(v(),We(Gt,{show:e.show,title:"Report Incident",size:"medium","confirm-on-close":!0,"is-dirty":R.value,onClose:P},{footer:ze(()=>[r("div",RD,[r("button",{type:"button",class:"btn btn-secondary",onClick:P}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:q,disabled:!F.value||k.value},C(k.value?"Reporting...":"Report Incident"),9,OD)])]),default:ze(()=>[r("form",{onSubmit:rt(q,["prevent"]),class:"incident-form"},[r("div",rD,[X[10]||(X[10]=r("label",{for:"title",class:"form-label"},"Title",-1)),Ue(r("input",{id:"title","onUpdate:modelValue":X[0]||(X[0]=ne=>i.value.title=ne),type:"text",class:"form-input",placeholder:"Brief summary (optional)"},null,512),[[st,i.value.title]])]),r("div",cD,[X[11]||(X[11]=r("label",{for:"description",class:"form-label"},[Ye("Description "),r("span",{class:"required"},"*")],-1)),Ue(r("textarea",{id:"description","onUpdate:modelValue":X[1]||(X[1]=ne=>i.value.description=ne),class:"form-input form-textarea",placeholder:"Describe what happened...",rows:"3",required:""},null,512),[[st,i.value.description]])]),r("div",uD,[r("div",dD,[X[12]||(X[12]=r("label",{for:"severity",class:"form-label"},"Severity",-1)),Ue(r("select",{id:"severity","onUpdate:modelValue":X[2]||(X[2]=ne=>i.value.severity=ne),class:"form-input form-select"},[(v(),m(xe,null,Ne(S,ne=>r("option",{key:ne.value,value:ne.value},C(ne.label),9,hD)),64))],512),[[Bn,i.value.severity]])]),r("div",fD,[X[13]||(X[13]=r("label",{for:"incidentTime",class:"form-label"},"When",-1)),Ue(r("input",{id:"incidentTime","onUpdate:modelValue":X[3]||(X[3]=ne=>i.value.incidentTime=ne),type:"datetime-local",class:"form-input"},null,512),[[st,i.value.incidentTime]])])]),x.value.length>0?(v(),m("div",pD,[r("label",vD,C(O(o).checkpoint),1),Ue(r("select",{id:"checkpoint","onUpdate:modelValue":X[4]||(X[4]=ne=>l.value=ne),class:"form-input form-select"},[X[14]||(X[14]=r("option",{value:""},"-- None / Unknown --",-1)),(v(!0),m(xe,null,Ne(x.value,ne=>(v(),m("option",{key:ne.id,value:ne.id},C(ne.name)+C(ne.description?` - ${ne.description}`:""),9,mD))),128))],512),[[Bn,l.value]])])):e.checkpoint?(v(),m("div",gD,[r("label",yD,C(O(o).checkpoint),1),r("div",kD,[r("label",_D,[Ue(r("input",{type:"checkbox","onUpdate:modelValue":X[5]||(X[5]=ne=>u.value=ne)},null,512),[[xa,u.value]]),r("span",bD,C(e.checkpoint.name),1),e.checkpoint.description?(v(),m("span",wD," - "+C(e.checkpoint.description),1)):M("",!0)])])])):M("",!0),r("div",CD,[X[15]||(X[15]=r("label",{class:"form-label"},"Location (optional)",-1)),r("div",LD,[r("div",SD,[r("button",{type:"button",class:de(["location-btn",{active:d.value==="gps"}]),onClick:X[6]||(X[6]=ne=>T("gps"))}," GPS ",2),r("button",{type:"button",class:de(["location-btn",{active:d.value==="map"}]),onClick:X[7]||(X[7]=ne=>T("map"))}," Pick on map ",2),r("button",{type:"button",class:de(["location-btn",{active:d.value==="none"}]),onClick:X[8]||(X[8]=ne=>T("none"))}," None ",2)]),d.value==="gps"?(v(),m("div",xD,[_.value?(v(),m("div",ID," Getting location... ")):f.value&&f.value.latitude!=null?(v(),m("div",$D,[r("span",null,C(f.value.latitude.toFixed(5))+", "+C(f.value.longitude.toFixed(5)),1),g.value?(v(),m("span",TD,"("+C(Math.round(g.value))+"m)",1)):M("",!0)])):y.value?(v(),m("div",MD,C(y.value),1)):M("",!0)])):M("",!0),d.value==="map"?(v(),m("div",AD,[p.value?(v(),m("div",ED,"Tap to select location")):M("",!0),p.value?(v(),We(li,{key:1,locations:x.value,route:e.route,center:D.value,zoom:14,mode:"select-point","user-location":e.initialLocation,"highlight-location-id":l.value,height:"150px",onPointSelected:N},null,8,["locations","route","center","user-location","highlight-location-id"])):M("",!0),f.value&&f.value.latitude!=null?(v(),m("div",PD,[r("span",null,C(f.value.latitude.toFixed(5))+", "+C(f.value.longitude.toFixed(5)),1),p.value?M("",!0):(v(),m("button",{key:0,type:"button",class:"location-edit-btn",onClick:X[9]||(X[9]=ne=>p.value=!0)},"Edit"))])):M("",!0)])):M("",!0)])]),w.value?(v(),m("div",DD,C(w.value),1)):M("",!0)],32)]),_:1},8,["show","is-dirty"]))}},em=je(BD,[["__scopeId","data-v-20b520b6"]]),ND={class:"tab-content"},FD={key:0,class:"form-group"},UD={for:"marshalId"},zD=["value"],HD={class:"help-text"},VD={key:1,class:"form-group"},GD={class:"linked-marshal-info"},jD={class:"linked-marshal-name"},ZD={class:"linked-marshal-hint"},qD={key:2,class:"form-group"},WD={class:"form-group"},KD={class:"role-input-group"},JD={key:0,label:"Built-in Roles"},YD=["value"],XD={key:1,label:"Custom Roles"},QD=["value"],eR={class:"checkbox-label-inline show-emergency-checkbox"},tR={class:"form-row"},nR={class:"form-group"},oR={class:"form-group"},sR={class:"form-group"},aR={class:"tab-content"},iR={class:"custom-footer"},lR={class:"footer-left"},rR=["disabled"],cR={__name:"EditContactModal",props:{show:{type:Boolean,default:!1},contact:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},isDirty:{type:Boolean,default:!1},preselectedArea:{type:Object,default:null},prefilledName:{type:String,default:""},prefilledMarshalId:{type:String,default:null},createFromAreaContext:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{terms:o}=ut(),a=e,s=t,i=$(!1),l=$(""),u=$("details"),d=$(!1),p=$({role:"",name:"",phone:"",email:"",notes:"",marshalId:null,showInEmergencyInfo:!1,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}),f=q=>q==="EmergencyContact",g=V(()=>!!a.contact),y=V(()=>a.createFromAreaContext?[{value:"details",label:"Details"}]:[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}]),_=V(()=>!!p.value.marshalId),k=V(()=>!g.value&&!!a.prefilledMarshalId),w=V(()=>g.value&&!!a.contact?.marshalId),S=V(()=>a.contact?.marshalId?a.marshals.find(P=>P.id===a.contact.marshalId)?.name||"Unknown":""),E=V(()=>[...a.marshals].sort((q,P)=>Vs(q.name,P.name)));qe(()=>a.show,q=>{if(q){if(u.value=a.initialTab,a.contact){const P=[...a.availableRoles.builtInRoles||[],...a.availableRoles.customRoles||[]];d.value=a.contact.role&&!P.includes(a.contact.role),p.value={role:a.contact.role||"",name:a.contact.name||"",phone:a.contact.phone||"",email:a.contact.email||"",notes:a.contact.notes||"",marshalId:a.contact.marshalId||null,showInEmergencyInfo:a.contact.showInEmergencyInfo??f(a.contact.role),scopeConfigurations:a.contact.scopeConfigurations?JSON.parse(JSON.stringify(a.contact.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}}else{d.value=!1;let P;a.createFromAreaContext?P=[]:a.preselectedArea?P=[{scope:"EveryoneInAreas",itemType:"Area",ids:[a.preselectedArea.id]}]:P=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}];let G={name:a.prefilledName||"",phone:"",email:""};if(a.prefilledMarshalId){const X=a.marshals.find(ne=>ne.id===a.prefilledMarshalId);X&&(G={name:X.name||"",phone:X.phoneNumber||"",email:X.email||""})}p.value={role:"",name:G.name,phone:G.phone,email:G.email,notes:"",marshalId:a.prefilledMarshalId||null,showInEmergencyInfo:!1,scopeConfigurations:P}}s("update:isDirty",!1)}}),qe(()=>p.value.role,(q,P)=>{!g.value&&q!==P&&(f(q)?p.value.showInEmergencyInfo=!0:f(P)&&(p.value.showInEmergencyInfo=!1))});const A=q=>q?q==="AreaLead"?`${o.value.area} Lead`:q.replace(/([A-Z])/g," $1").replace(/^./,P=>P.toUpperCase()).trim():"",x=()=>{s("update:isDirty",!0)},D=()=>{if(p.value.marshalId){const q=a.marshals.find(P=>P.id===p.value.marshalId);q&&(p.value.name=q.name,!p.value.phone&&q.phoneNumber&&(p.value.phone=q.phoneNumber),!p.value.email&&q.email&&(p.value.email=q.email))}x()},R=()=>{s("close")},F=()=>{if(!p.value.role||!p.value.role.trim()){T("Please select or enter a role");return}if(!p.value.name||!p.value.name.trim()){T("Please enter a contact name");return}u.value="visibility"},T=q=>{l.value=q,i.value=!0},N=()=>{if(!p.value.role||!p.value.role.trim()){T("Please select or enter a role");return}if(!p.value.name||!p.value.name.trim()){T("Please enter a contact name");return}if(!a.createFromAreaContext){if(!p.value.scopeConfigurations||p.value.scopeConfigurations.length===0){T("Please select at least one visibility scope");return}if(!p.value.scopeConfigurations.some(G=>!(G.itemType!==null&&(!G.ids||G.ids.length===0)))){T("Please configure at least one scope with valid selections");return}}const q={role:p.value.role.trim(),name:p.value.name.trim(),phone:p.value.phone?.trim()||null,email:p.value.email?.trim()||null,notes:p.value.notes?.trim()||null,marshalId:p.value.marshalId||null,showInEmergencyInfo:p.value.showInEmergencyInfo,scopeConfigurations:p.value.scopeConfigurations};s("save",q)},B=()=>{s("delete",a.contact.contactId)};return(q,P)=>(v(),m(xe,null,[Ae(Gt,{show:e.show,title:g.value?"Edit contact":"Create contact",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:R},{"tab-header":ze(()=>[Ae(qi,{modelValue:u.value,"onUpdate:modelValue":P[0]||(P[0]=G=>u.value=G),tabs:y.value},null,8,["modelValue","tabs"])]),footer:ze(()=>[r("div",iR,[r("div",lR,[g.value?(v(),m("button",{key:0,type:"button",onClick:B,class:"btn btn-danger"}," Delete ")):M("",!0),!g.value&&u.value==="details"?(v(),m("button",{key:1,type:"button",onClick:F,class:"btn btn-secondary mobile-only"}," Visibility... ")):M("",!0)]),r("button",{type:"button",onClick:N,class:"btn btn-success",disabled:g.value&&!e.isDirty}," Save ",8,rR)])]),default:ze(()=>[r("form",{onSubmit:rt(N,["prevent"]),class:"contact-form"},[Ue(r("div",ND,[!k.value&&!w.value?(v(),m("div",FD,[r("label",UD,"Link to "+C(O(o).person.toLowerCase())+":",1),Ue(r("select",{id:"marshalId","onUpdate:modelValue":P[1]||(P[1]=G=>p.value.marshalId=G),onChange:D},[P[12]||(P[12]=r("option",{value:null},"-- Not linked --",-1)),(v(!0),m(xe,null,Ne(E.value,G=>(v(),m("option",{key:G.id,value:G.id},C(G.name),9,zD))),128))],544),[[Bn,p.value.marshalId]]),r("span",HD,"Optionally link to an existing "+C(O(o).person.toLowerCase())+" in the system",1)])):M("",!0),w.value?(v(),m("div",VD,[r("label",null,"Linked "+C(O(o).person.toLowerCase())+":",1),r("div",GD,[r("span",jD,C(S.value),1),r("span",ZD,"Contact details are synced with this "+C(O(o).person.toLowerCase()),1)])])):M("",!0),_.value?M("",!0):(v(),m("div",qD,[P[13]||(P[13]=r("label",{for:"name"},"Name: *",-1)),Ue(r("input",{id:"name","onUpdate:modelValue":P[2]||(P[2]=G=>p.value.name=G),type:"text",onInput:x,placeholder:"Contact name..."},null,544),[[st,p.value.name]])])),r("div",WD,[P[16]||(P[16]=r("label",{for:"role"},"Role: *",-1)),r("div",KD,[d.value?Ue((v(),m("input",{key:1,id:"customRole","onUpdate:modelValue":P[4]||(P[4]=G=>p.value.role=G),type:"text",onInput:x,placeholder:"Enter custom role name..."},null,544)),[[st,p.value.role]]):Ue((v(),m("select",{key:0,id:"role","onUpdate:modelValue":P[3]||(P[3]=G=>p.value.role=G),onChange:x},[P[14]||(P[14]=r("option",{value:"",disabled:""},"Select a role...",-1)),e.availableRoles.builtInRoles?.length>0?(v(),m("optgroup",JD,[(v(!0),m(xe,null,Ne(e.availableRoles.builtInRoles,G=>(v(),m("option",{key:G,value:G},C(A(G)),9,YD))),128))])):M("",!0),e.availableRoles.customRoles?.length>0?(v(),m("optgroup",XD,[(v(!0),m(xe,null,Ne(e.availableRoles.customRoles,G=>(v(),m("option",{key:G,value:G},C(A(G)),9,QD))),128))])):M("",!0)],544)),[[Bn,p.value.role]]),r("button",{type:"button",class:"toggle-custom-btn",onClick:P[5]||(P[5]=G=>d.value=!d.value)},C(d.value?"Use existing":"Custom"),1)]),r("label",eR,[Ue(r("input",{type:"checkbox","onUpdate:modelValue":P[6]||(P[6]=G=>p.value.showInEmergencyInfo=G),onChange:x},null,544),[[xa,p.value.showInEmergencyInfo]]),P[15]||(P[15]=r("span",null,"Show in emergency info",-1))])]),r("div",tR,[r("div",nR,[P[17]||(P[17]=r("label",{for:"phone"},"Phone:",-1)),Ue(r("input",{id:"phone","onUpdate:modelValue":P[7]||(P[7]=G=>p.value.phone=G),type:"tel",onInput:x,placeholder:"Phone number..."},null,544),[[st,p.value.phone]])]),r("div",oR,[P[18]||(P[18]=r("label",{for:"email"},"Email:",-1)),Ue(r("input",{id:"email","onUpdate:modelValue":P[8]||(P[8]=G=>p.value.email=G),type:"email",onInput:x,placeholder:"Email address..."},null,544),[[st,p.value.email]])])]),r("div",sR,[P[19]||(P[19]=r("label",{for:"notes"},"Notes / Instructions:",-1)),Ue(r("textarea",{id:"notes","onUpdate:modelValue":P[9]||(P[9]=G=>p.value.notes=G),onInput:x,rows:"3",placeholder:"Additional notes or instructions for when to contact..."},null,544),[[st,p.value.notes]])])],512),[[ys,u.value==="details"]]),Ue(r("div",aR,[Ae(mc,{modelValue:p.value.scopeConfigurations,"onUpdate:modelValue":P[10]||(P[10]=G=>p.value.scopeConfigurations=G),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":g.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this contact?",onUserChanged:x},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ys,u.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ae(yc,{show:i.value,title:"Validation error",message:l.value,onClose:P[11]||(P[11]=G=>i.value=!1)},null,8,["show","message"])],64))}},uR=je(cR,[["__scopeId","data-v-1facd274"]]),dR={key:0,class:"fullscreen-map-overlay"},hR={class:"fullscreen-map-header"},fR={class:"context-info"},pR={key:0},vR={class:"action-buttons"},mR=["disabled"],gR={class:"fullscreen-map-container"},yR={key:0,class:"drawing-controls"},kR={class:"point-count"},_R={class:"undo-redo-buttons"},bR=["disabled"],wR=["disabled"],CR=Object.assign({inheritAttrs:!1},{__name:"FullscreenMapOverlay",props:{show:{type:Boolean,required:!0},mode:{type:String,validator:e=>["place-checkpoint","move-checkpoint","draw-area","add-multiple","view"].includes(e)},contextTitle:{type:String,default:""},contextDescription:{type:String,default:""},canComplete:{type:Boolean,default:!1},drawingMode:{type:Boolean,default:!1}},emits:["done","cancel","map-click","polygon-complete","polygon-drawing","location-click","area-click"],setup(e,{emit:t}){const o=e,a=t,s=$(null),i=$(0),l=$(!1),u=$(!1),d=()=>{a("done")},p=()=>{a("cancel")},f=w=>{i.value=w?.length||0,g(),a("polygon-drawing",w)},g=()=>{s.value&&(l.value=s.value.canUndo(),u.value=s.value.canRedo())},y=()=>{s.value&&(s.value.undoPolygonPoint(),g())},_=()=>{s.value&&(s.value.redoPolygonPoint(),g())};qe(()=>o.show,w=>{w||(i.value=0,l.value=!1,u.value=!1)});const k=w=>{w.key==="Escape"&&o.show&&p(),o.show&&o.drawingMode&&((w.ctrlKey||w.metaKey)&&w.key==="z"&&!w.shiftKey?(w.preventDefault(),y()):(w.ctrlKey||w.metaKey)&&(w.key==="y"||w.key==="z"&&w.shiftKey)&&(w.preventDefault(),_()))};return nn(()=>{document.addEventListener("keydown",k)}),xn(()=>{document.removeEventListener("keydown",k)}),(w,S)=>(v(),We(Tl,{to:"body"},[e.show?(v(),m("div",dR,[r("div",hR,[r("div",fR,[r("h3",null,C(e.contextTitle),1),e.contextDescription?(v(),m("p",pR,C(e.contextDescription),1)):M("",!0)]),r("div",vR,[e.mode==="view"?(v(),m("button",{key:0,onClick:p,class:"btn btn-done"}," Close ")):(v(),m(xe,{key:1},[r("button",{onClick:p,class:"btn btn-cancel"}," Cancel "),r("button",{onClick:d,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,mR)],64))])]),r("div",gR,[Ae(Tu,Dp({ref_key:"mapViewRef",ref:s,"drawing-mode":e.drawingMode},w.$attrs,{onMapClick:S[0]||(S[0]=E=>w.$emit("map-click",E)),onPolygonComplete:S[1]||(S[1]=E=>w.$emit("polygon-complete",E)),onPolygonDrawing:f,onLocationClick:S[2]||(S[2]=E=>w.$emit("location-click",E)),onAreaClick:S[3]||(S[3]=E=>w.$emit("area-click",E))}),null,16,["drawing-mode"]),e.drawingMode&&i.value>0?(v(),m("div",yR,[r("div",kR,C(i.value)+" point"+C(i.value!==1?"s":""),1),r("div",_R,[r("button",{onClick:y,class:"btn-drawing undo-btn",disabled:!l.value,title:"Undo last point"},"  Undo ",8,bR),r("button",{onClick:_,class:"btn-drawing redo-btn",disabled:!u.value,title:"Redo point"}," Redo  ",8,wR)])])):M("",!0)])])):M("",!0)]))}}),LR=je(CR,[["__scopeId","data-v-9ce62b55"]]),SR={class:"form-group"},xR={class:"form-group"},IR={class:"form-group"},$R={key:0,class:"form-error"},TR={class:"form-row"},MR={class:"form-group",style:{flex:"1"}},AR={class:"form-group",style:{flex:"1"}},ER={class:"form-group",style:{flex:"0 0 auto"}},PR={class:"form-group"},DR={__name:"AddLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:()=>({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""})},isDirty:{type:Boolean,default:!1}},emits:["close","save","set-on-map","update:isDirty","update:location"],setup(e,{emit:t}){const{termsLower:o}=ut(),a=e,s=t,i=$({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""});qe(()=>a.location,p=>{p&&(i.value={...p})},{immediate:!0,deep:!0});const l=()=>{s("update:isDirty",!0),s("update:location",{...i.value})},u=()=>{if(!zr(i.value.what3Words)&&i.value.what3Words){alert("Invalid What3Words format.");return}s("save",i.value)},d=()=>{s("close")};return(p,f)=>(v(),We(Gt,{show:e.show,title:`Add ${O(o).checkpoint}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:ze(()=>[r("button",{type:"button",onClick:d,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:u,class:"btn btn-primary"}," Add "+C(O(o).checkpoint),1)]),default:ze(()=>[r("form",{onSubmit:rt(u,["prevent"])},[r("div",SR,[f[7]||(f[7]=r("label",null,"Name",-1)),Ue(r("input",{"onUpdate:modelValue":f[0]||(f[0]=g=>i.value.name=g),type:"text",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.name]])]),r("div",xR,[f[8]||(f[8]=r("label",null,"Description",-1)),Ue(r("input",{"onUpdate:modelValue":f[1]||(f[1]=g=>i.value.description=g),type:"text",class:"form-input",onInput:l},null,544),[[st,i.value.description]])]),r("div",IR,[f[9]||(f[9]=r("label",null,"What3Words (optional)",-1)),Ue(r("input",{"onUpdate:modelValue":f[2]||(f[2]=g=>i.value.what3Words=g),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap",onInput:l},null,544),[[st,i.value.what3Words]]),i.value.what3Words&&!O(zr)(i.value.what3Words)?(v(),m("small",$R," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):M("",!0)]),r("div",TR,[r("div",MR,[f[10]||(f[10]=r("label",null,"Longitude",-1)),Ue(r("input",{"onUpdate:modelValue":f[3]||(f[3]=g=>i.value.longitude=g),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.longitude,void 0,{number:!0}]])]),r("div",AR,[f[11]||(f[11]=r("label",null,"Latitude",-1)),Ue(r("input",{"onUpdate:modelValue":f[4]||(f[4]=g=>i.value.latitude=g),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.latitude,void 0,{number:!0}]])]),r("div",ER,[f[12]||(f[12]=r("label",null,"",-1)),r("button",{type:"button",class:"icon-btn",title:"Set location on map",onClick:f[5]||(f[5]=g=>p.$emit("set-on-map"))},"  ")])]),r("div",PR,[r("label",null,"Required "+C(O(o).people),1),Ue(r("input",{"onUpdate:modelValue":f[6]||(f[6]=g=>i.value.requiredMarshals=g),type:"number",min:"1",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.requiredMarshals,void 0,{number:!0}]])])],32)]),_:1},8,["show","title","is-dirty"]))}},RR=je(DR,[["__scopeId","data-v-fb51fed0"]]),OR=["aria-expanded","title"],BR=["innerHTML"],NR={key:0,class:"dropdown-menu"},FR=["onClick"],UR=["innerHTML"],zR={__name:"ThemeToggle",setup(e){const{theme:t,isDark:o,setTheme:a}=Hv(),s=$(!1),i=$(null),l={light:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
  </svg>`,dark:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
  </svg>`,system:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
    <line x1="8" y1="21" x2="16" y2="21"></line>
    <line x1="12" y1="17" x2="12" y2="21"></line>
  </svg>`},u=[{value:"system",label:"System",icon:l.system},{value:"light",label:"Light",icon:l.light},{value:"dark",label:"Dark",icon:l.dark}],d=V(()=>o.value?l.dark:l.light),p=()=>{s.value=!s.value},f=y=>{a(y),s.value=!1},g=y=>{i.value&&!i.value.contains(y.target)&&(s.value=!1)};return nn(()=>{document.addEventListener("click",g)}),xn(()=>{document.removeEventListener("click",g)}),(y,_)=>(v(),m("div",{class:"theme-dropdown",ref_key:"dropdownRef",ref:i},[r("button",{class:"theme-toggle-btn",onClick:p,type:"button","aria-expanded":s.value,title:O(o)?"Dark mode":"Light mode"},[r("span",{class:"theme-icon",innerHTML:d.value},null,8,BR)],8,OR),s.value?(v(),m("div",NR,[(v(),m(xe,null,Ne(u,k=>r("button",{key:k.value,class:de(["dropdown-item",{active:O(t)===k.value}]),onClick:w=>f(k.value)},[r("span",{class:"option-icon",innerHTML:k.icon},null,8,UR),r("span",null,C(k.label),1)],10,FR)),64))])):M("",!0)],512))}},HR=je(zR,[["__scopeId","data-v-969124a4"]]),VR={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"app-logo"},GR=["id"],jR=["filter"],ZR={__name:"AppLogo",props:{size:{type:[Number,String],default:48},animate:{type:Boolean,default:!1}},setup(e){_y(o=>({v1c2199cd:typeof e.size=="number"?e.size+"px":e.size}));const t=V(()=>`discShadow-${Math.random().toString(36).substr(2,9)}`);return(o,a)=>(v(),m("svg",VR,[r("defs",null,[r("filter",{id:t.value,x:"-20%",y:"-20%",width:"140%",height:"140%"},[...a[0]||(a[0]=[r("feDropShadow",{dx:"0",dy:"6",stdDeviation:"8","flood-color":"#000","flood-opacity":"0.25"},null,-1)])],8,GR)]),r("ellipse",{cx:"256",cy:"400",rx:"220",ry:"70",fill:"#667eea",filter:`url(#${t.value})`},null,8,jR),a[2]||(a[2]=r("ellipse",{cx:"256",cy:"394",rx:"185",ry:"55",fill:"none",stroke:"rgba(255,255,255,0.3)","stroke-width":"4"},null,-1)),r("g",{class:de({"marshal-figure":e.animate})},[...a[1]||(a[1]=[r("circle",{cx:"256",cy:"160",r:"55",fill:"currentColor"},null,-1),r("path",{d:"M365 380 v-30 a55 55 0 0 0-55-55 H202 a55 55 0 0 0-55 55 v30",fill:"currentColor"},null,-1)])],2)]))}},qR=je(ZR,[["__scopeId","data-v-3e647831"]]),WR={class:"header"},KR={class:"header-left"},JR={key:0},YR={class:"event-date"},XR={class:"header-actions"},QR={class:"container"},eO={class:"tabs-nav"},tO={class:"tab-content-wrapper"},nO={class:"add-note-form"},oO={class:"modal-footer-actions"},sO=["disabled"],aO=6e4,iO={__name:"AdminEventManage",setup(e){const t=uc(),o=Vi(),a=Nv(),s=V(()=>t.params.eventId),{activeTab:i,switchTab:l}=Fv("details",["details","course","areas","checkpoints","marshals","notes","checklists","contacts","settings"]),{showConfirmModal:u,confirmModalTitle:d,confirmModalMessage:p,confirmModalIsDanger:f,confirmModalConfirmText:g,showConfirm:y,handleConfirmModalConfirm:_,handleConfirmModalCancel:k}=$b(),{tabLabels:w,terms:S,termsLower:E}=ut(),A=Tb(),x=Ab(s),D=Mb(s),{colorScheme:R}=Hv(),F=V(()=>[{value:"details",label:"Event details",icon:"details"},{value:"course",label:w.value.course,icon:"course"},{value:"areas",label:w.value.areas,icon:"area"},{value:"checkpoints",label:w.value.checkpoints,icon:"checkpoint"},{value:"marshals",label:w.value.marshals,icon:"marshal"},{value:"notes",label:"Notes",icon:"notes"},{value:"incidents",label:"Incidents",icon:"incidents"},{value:"checklists",label:w.value.checklists,icon:"checklist"},{value:"contacts",label:"Contacts",icon:"contacts"},{value:"settings",label:"Settings",icon:"settings"}]),T=$(null),N=$([]),B=$([]),q=$({marshals:0,areas:0,checkpoints:0,checklists:0,notes:0,incidents:0,contacts:0}),P=$(null),G=$(!1),X=$(!1),ne=$(null),K=$(null),Q=$(!1),he=$(!1),U=$(null),ee=$(""),fe=D.eventAdmins,ue=D.showAddAdmin,De=x.showUploadRoute,et=x.uploading,Je=x.uploadError,Ze=x.showImportLocations,He=x.showImportMarshals,be=x.importing,Ve=x.importingMarshals,ve=x.importError,Le=x.importResult,Pe=x.importMarshalsResult,W=$(!1),Y=$(!1),pe=$({id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Ce=$(!1),le=$(!1),J=$({marshalName:"",locations:[],marshal:null}),j=$(null),te=$([]),Re=$(!1),Se=$(null),we=$(null),ge=$(null),Z=$({}),se=$({id:"",name:"",email:"",phoneNumber:"",notes:""}),ce=$(!1),Te=$([]),Oe=$([]),Be=$([]),Xe=$([]),mt=$(!1),_t=$(""),bt=$(""),Mt=$({name:"",description:"",eventDate:"",timeZoneId:"UTC",peopleTerm:"Marshals",defaultCheckpointStyleBackgroundShape:"",defaultCheckpointStyleBackgroundColor:"",defaultCheckpointStyleBorderColor:"",defaultCheckpointStyleIconColor:"",defaultCheckpointStyleSize:"",defaultCheckpointStyleMapRotation:"",checkpointTerm:"Checkpoints",areaTerm:"Areas",checklistTerm:"Checklists",courseTerm:"Course",defaultCheckpointStyleType:"default",defaultCheckpointStyleColor:""}),wt=$(!1),Nt=$(!1),Ft=$(""),Fn=$(""),Qn=$(0),fn=$({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),jt=$([]),yt=$(null),eo=$(!1),Un=$("details"),to=$(null),pn=$(null),Zt=$(null),ks=A.isAddingMultipleCheckpoints,no=A.multiCheckpointCounter,Co=A.isFullscreenMapActive,ie=A.fullscreenMode,re=A.fullscreenContext,me=A.tempLocationCoords,ot=A.tempCheckpoints,Ge=A.savedMapCenter,St=A.savedMapZoom,Wt=A.isDrawingAreaBoundary,Qt=$(null),Do=$([]),uo=$(null),Ro=$(!1),zn=$("details"),Ta=$(null),Oo=$([]),Lo=$(null),Zs=$(!1),qs=$("details"),vn=$([]),Bo=$(!1),on=$(null),So=$(!1),ho=$(!1),_s=$(!1),xo=$(""),bs=$(!1),Io=$([]),No=$({builtInRoles:[],customRoles:[]}),mn=$(null),$o=$(!1),Hn=$("details"),vt=$(null),xt=$(""),To=$(null),fo=$(null),Fo=V(()=>fo.value?.marshalId!=null),Ma=()=>{o.push(`/event/${t.params.eventId}`)},ht=V(()=>`${window.location.origin}/#/event/${t.params.eventId}`),Ut=V(()=>{const H=[];return B.value.forEach(ae=>{ae.assignments&&H.push(...ae.assignments)}),H}),Aa=V(()=>{if(!Se.value)return B.value;const H=Se.value.assignedLocationIds||[],ae=Be.value.map(ke=>ke.locationId),ye=Xe.value;return B.value.filter(ke=>!H.includes(ke.id)&&!ae.includes(ke.id)||ye.includes(ke.id))}),Uo=V(()=>{let H=te.value;if(P.value){const ae=P.value.assignments.map(ke=>ke.marshalName),ye=Te.value.map(ke=>ke.marshalName);H=te.value.filter(ke=>!ae.includes(ke.name)&&!ye.includes(ke.name))}return H.slice().sort((ae,ye)=>ae.name.localeCompare(ye.name))}),gn=V(()=>ie.value==="draw-area"&&yt.value?.polygon?.length>0||A.canCompleteFullscreen.value),ri=V(()=>ie.value==="move-checkpoint"&&P.value?.id?P.value.id:null),Ws=V(()=>{const H=[...B.value];return ie.value==="place-checkpoint"&&me.value&&H.push({id:"temp-single",name:fn.value.name||"New Checkpoint",latitude:me.value.lat,longitude:me.value.lng,requiredMarshals:fn.value.requiredMarshals||1,assignments:[],isTemporary:!0}),ie.value==="move-checkpoint"&&me.value&&P.value&&H.push({id:"temp-move",name:P.value.name+" (new position)",latitude:me.value.lat,longitude:me.value.lng,requiredMarshals:P.value.requiredMarshals,assignments:[],isTemporary:!0}),ie.value==="add-multiple"&&H.push(...ot.value),H}),po=V(()=>{let H=[...jt.value];return ie.value==="draw-area"&&yt.value?.id&&(H=H.filter(ae=>ae.id!==yt.value.id)),ie.value==="draw-area"&&yt.value?.polygon?.length>0&&H.push({...yt.value,id:yt.value.id||"temp-area"}),H}),qt=V(()=>{if(!Se.value||!vn.value.length)return[];const H=Se.value.id,ae=Se.value.assignedLocationIds||[];return vn.value.filter(ye=>{if(ye.reportedBy?.marshalId===H)return!0;const ke=ye.context?.checkpoint?.checkpointId;return!!(ke&&ae.includes(ke))}).sort((ye,ke)=>new Date(ke.incidentTime||ke.createdAt)-new Date(ye.incidentTime||ye.createdAt))}),zo=V(()=>{if(!P.value||!vn.value.length)return[];const H=P.value.id;return vn.value.filter(ae=>ae.context?.checkpoint?.checkpointId===H).sort((ae,ye)=>new Date(ye.incidentTime||ye.createdAt)-new Date(ae.incidentTime||ae.createdAt))}),yn=V(()=>{if(!yt.value||!vn.value.length)return[];const H=yt.value.id,ae=B.value.filter(ye=>ye.areaIds&&ye.areaIds.includes(H)).map(ye=>ye.id);return vn.value.filter(ye=>{const ke=ye.context?.checkpoint?.checkpointId;return ke&&ae.includes(ke)}).sort((ye,ke)=>new Date(ke.incidentTime||ke.createdAt)-new Date(ye.incidentTime||ye.createdAt))}),In=H=>{on.value=H,So.value=!0},Ea=H=>{on.value=H,So.value=!0},kn=H=>{on.value=H,So.value=!0},Pa=()=>{o.push("/sessions")},zt=(H=!0)=>{ce.value=H},ws=()=>{wt.value=!0},Ks=async H=>{try{H&&(Mt.value={...H});const ae=Bl(T.value.eventDate),ye=Mt.value.eventDate;if(ae!==ye){const ke=N.value.filter(tt=>tt.startTime||tt.endTime);if(ke.length>0){Ft.value=ae,Fn.value=ye,Qn.value=ke.length,Nt.value=!0;return}}await Js(!1,null)}catch(ae){console.error("Failed to update event:",ae),alert("Failed to update event. Please try again.")}},Js=async(H,ae)=>{try{if(await a.updateEvent(t.params.eventId,{...Mt.value,defaultCheckpointStyleMapRotation:Mt.value.defaultCheckpointStyleMapRotation!=null?String(Mt.value.defaultCheckpointStyleMapRotation):null}),H&&ae!==null){const ye=Math.floor(Math.abs(ae)/1e3),ke=ae<0,tt=Math.floor(ye/3600),Lt=Math.floor(ye%3600/60),Et=ye%60,un=`${ke?"-":""}${tt.toString().padStart(2,"0")}:${Lt.toString().padStart(2,"0")}:${Et.toString().padStart(2,"0")}`;await a.bulkUpdateLocationTimes(t.params.eventId,un)}await $n(),wt.value=!1}catch(ye){console.error("Failed to update event:",ye),alert("Failed to update event. Please try again.")}},Ys=async({shouldShift:H,timeDelta:ae})=>{Nt.value=!1,await Js(H,ae)},Da=()=>{Nt.value=!1,$n()},$n=async()=>{try{await a.fetchEvent(t.params.eventId),T.value=a.currentEvent,T.value&&(Mt.value={name:T.value.name||"",description:T.value.description||"",eventDate:Bl(T.value.eventDate),timeZoneId:T.value.timeZoneId||"UTC",peopleTerm:T.value.peopleTerm||"Marshals",checkpointTerm:T.value.checkpointTerm||"Checkpoints",areaTerm:T.value.areaTerm||"Areas",checklistTerm:T.value.checklistTerm||"Checklists",courseTerm:T.value.courseTerm||"Course",defaultCheckpointStyleType:T.value.defaultCheckpointStyleType||"default",defaultCheckpointStyleColor:T.value.defaultCheckpointStyleColor||"",defaultCheckpointStyleBackgroundShape:T.value.defaultCheckpointStyleBackgroundShape||"",defaultCheckpointStyleBackgroundColor:T.value.defaultCheckpointStyleBackgroundColor||"",defaultCheckpointStyleBorderColor:T.value.defaultCheckpointStyleBorderColor||"",defaultCheckpointStyleIconColor:T.value.defaultCheckpointStyleIconColor||"",defaultCheckpointStyleSize:T.value.defaultCheckpointStyleSize||"",defaultCheckpointStyleMapRotation:T.value.defaultCheckpointStyleMapRotation??"",brandingHeaderGradientStart:T.value.brandingHeaderGradientStart||"",brandingHeaderGradientEnd:T.value.brandingHeaderGradientEnd||"",brandingLogoUrl:T.value.brandingLogoUrl||"",brandingLogoPosition:T.value.brandingLogoPosition||"",brandingAccentColor:T.value.brandingAccentColor||"",brandingPageGradientStart:T.value.brandingPageGradientStart||"",brandingPageGradientEnd:T.value.brandingPageGradientEnd||""},wt.value=!1,xu(T.value));const H=await Promise.allSettled([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId),Na(),Ho(),lt(),_n(),It(),oo(),vo()]);N.value=a.locations,B.value=a.eventStatus.locations,H.forEach((ae,ye)=>{ae.status==="rejected"&&console.error(`Failed to load ${["locations","eventStatus","admins","marshals","areas","checklists","notes","contacts"][ye]}:`,ae.reason)})}catch(H){console.error("Failed to load event data:",H)}},Ho=async()=>{try{const H=await ms.getByEvent(t.params.eventId);te.value=H.data,q.value.marshals=Date.now()}catch(H){console.error("Failed to load marshals:",H)}},lt=async()=>{try{const H=await ka.getByEvent(t.params.eventId);jt.value=H.data,q.value.areas=Date.now()}catch(H){console.error("Failed to load areas:",H)}},_n=async()=>{try{const[H,ae]=await Promise.all([Rt.getByEvent(t.params.eventId),Rt.getReport(t.params.eventId)]);Do.value=H.data,Ta.value=ae.data,q.value.checklists=Date.now()}catch(H){console.error("Failed to load checklists:",H)}},It=async()=>{try{const H=await Es.getByEvent(t.params.eventId);Oo.value=H.data,q.value.notes=Date.now()}catch(H){console.error("Failed to load notes:",H)}},oo=async()=>{Bo.value=!0;try{const H=await fs.getAll(t.params.eventId);vn.value=H.data.incidents||[],q.value.incidents=Date.now()}catch(H){console.error("Failed to load incidents:",H)}finally{Bo.value=!1}},vo=async()=>{try{const[H,ae]=await Promise.all([fa.getByEvent(t.params.eventId),fa.getRoles(t.params.eventId)]);Io.value=H.data,No.value=ae.data,q.value.contacts=Date.now()}catch(H){console.error("Failed to load contacts:",H)}},mo=async()=>{await Promise.all([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId)]),N.value=a.locations,q.value.checkpoints=Date.now(),B.value=a.eventStatus.locations},is=async()=>{await Promise.all([Ho(),a.fetchEventStatus(t.params.eventId)]),B.value=a.eventStatus.locations},go=async()=>{await Promise.all([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId),lt()]),N.value=a.locations,B.value=a.eventStatus.locations},Xs=async()=>{await a.fetchEventStatus(t.params.eventId),B.value=a.eventStatus.locations},Vo=()=>{yt.value=null,Un.value="details",ce.value=!1,eo.value=!0},Kt=H=>{yt.value=H,pn.value=H.id,Un.value="details",ce.value=!1,eo.value=!0},Go=async H=>{try{let ae;if(yt.value&&yt.value.id){if(ae=yt.value.id,await ka.update(t.params.eventId,ae,H),H.checklistChanges&&H.checklistChanges.length>0)for(const ye of H.checklistChanges)try{ye.complete?await Rt.complete(t.params.eventId,ye.itemId,{marshalId:ye.marshalId,contextType:ye.contextType,contextId:ye.contextId}):await Rt.uncomplete(t.params.eventId,ye.itemId,{marshalId:ye.marshalId,contextType:ye.contextType,contextId:ye.contextId})}catch(ke){console.error("Failed to update checklist item:",ye,ke)}}else ae=(await ka.create({eventId:t.params.eventId,...H})).data.id;if(H.pendingContacts&&H.pendingContacts.length>0&&ae)for(const ye of H.pendingContacts)try{const ke=ye.scopeConfigurations?JSON.parse(JSON.stringify(ye.scopeConfigurations)):[],tt=ke.find(Lt=>Lt.scope==="EveryoneInAreas"&&Lt.itemType==="Area");tt?(tt.ids||(tt.ids=[]),tt.ids.includes(ae)||tt.ids.push(ae)):ke.push({scope:"EveryoneInAreas",itemType:"Area",ids:[ae]}),await fa.update(t.params.eventId,ye.contactId,{...ye,scopeConfigurations:ke})}catch(ke){console.error("Failed to add area to contact:",ye,ke)}if(H.contactsToRemove&&H.contactsToRemove.length>0&&ae)for(const ye of H.contactsToRemove)try{const ke=Io.value.find(Et=>Et.contactId===ye);if(!ke)continue;const tt=ke.scopeConfigurations?JSON.parse(JSON.stringify(ke.scopeConfigurations)):[],Lt=tt.find(Et=>Et.scope==="EveryoneInAreas"&&Et.itemType==="Area");if(Lt&&Lt.ids){Lt.ids=Lt.ids.filter(un=>un!==ae);const Et=Lt.ids.length>0?tt:tt.filter(un=>!(un.scope==="EveryoneInAreas"&&un.itemType==="Area"));await fa.update(t.params.eventId,ye,{...ke,scopeConfigurations:Et})}}catch(ke){console.error("Failed to remove area from contact:",ye,ke)}(H.pendingContacts&&H.pendingContacts.length>0||H.contactsToRemove&&H.contactsToRemove.length>0)&&await vo(),await lt(),await $n(),Qs()}catch(ae){console.error("Failed to save area:",ae),alert(ae.response?.data?.message||"Failed to save area. Please try again.")}},Ra=async H=>{y(`Delete ${E.value.area}`,`Are you sure you want to delete this ${E.value.area}? ${S.value.checkpoints} will be automatically reassigned.`,async()=>{try{await ka.delete(t.params.eventId,H),await ka.recalculate(t.params.eventId),await lt(),await $n(),Qs()}catch(ae){console.error(`Failed to delete ${E.value.area}:`,ae),alert(ae.response?.data?.message||`Failed to delete ${E.value.area}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Qs=()=>{eo.value=!1,yt.value=null,pn.value=null,ce.value=!1,Wt.value=!1,Zt.value=null},Wi=({marshal:H,area:ae})=>{mn.value=null,Hn.value="details",ce.value=!1,vt.value=ae,xt.value="",To.value=H.id,$o.value=!0},ci=({name:H,area:ae})=>{mn.value=null,Hn.value="details",ce.value=!1,vt.value=ae,xt.value=H,To.value=null,$o.value=!0},ea=H=>{mn.value=H,Hn.value="details",ce.value=!1,$o.value=!0},ui=()=>{uo.value=null,zn.value="details",ce.value=!1,Ro.value=!0},ta=(H,ae="details")=>{uo.value=H,zn.value=ae,ce.value=!1,Ro.value=!0},gt=async H=>{try{if(uo.value&&uo.value.itemId)await Rt.update(t.params.eventId,uo.value.itemId,H);else{const ae=await Rt.create(t.params.eventId,H);ae.data.count&&ae.data.count>1&&(_t.value="Checklist Items Created",bt.value=`Successfully created ${ae.data.count} checklist items.`,mt.value=!0)}await _n(),bn()}catch(ae){console.error("Failed to save checklist item:",ae);const ye=ae.response?.data?.message||"Failed to save checklist item. Please try again.";alert(ye)}},Ki=async H=>{y(`Delete ${E.value.checklist}`,`Are you sure you want to delete this ${E.value.checklist}?`,async()=>{try{await Rt.delete(t.params.eventId,H),await _n(),bn()}catch(ae){console.error(`Failed to delete ${E.value.checklist}:`,ae),alert(ae.response?.data?.message||`Failed to delete ${E.value.checklist}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},bn=()=>{Ro.value=!1,uo.value=null,ce.value=!1},Cs=()=>{Lo.value=null,qs.value="details",ce.value=!1,Zs.value=!0},Oa=H=>{Lo.value=H,qs.value="details",ce.value=!1,Zs.value=!0},di=async H=>{try{Lo.value&&Lo.value.noteId?await Es.update(t.params.eventId,Lo.value.noteId,H):await Es.create(t.params.eventId,H),await It(),Ba()}catch(ae){console.error("Failed to save note:",ae);const ye=ae.response?.data?.message||"Failed to save note. Please try again.";alert(ye)}},na=async H=>{y("Delete note","Are you sure you want to delete this note?",async()=>{try{await Es.delete(t.params.eventId,H),await It(),Ba()}catch(ae){console.error("Failed to delete note:",ae),alert(ae.response?.data?.message||"Failed to delete note. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Ba=()=>{Zs.value=!1,Lo.value=null,ce.value=!1},Ee=()=>{ho.value=!0},Me=async H=>{try{await fs.create(t.params.eventId,H),ho.value=!1,await oo()}catch(ae){console.error("Failed to report incident:",ae),alert(ae.response?.data?.message||"Failed to report incident. Please try again.")}},at=H=>{on.value=H,So.value=!0},ft=()=>{So.value=!1,on.value=null},Ct=async({incidentId:H,status:ae})=>{try{if(await fs.updateStatus(t.params.eventId,H,{status:ae}),await oo(),on.value?.incidentId===H){const ye=vn.value.find(ke=>ke.incidentId===H);ye&&(on.value=ye)}}catch(ye){console.error("Failed to update incident status:",ye),alert(ye.response?.data?.message||"Failed to update status. Please try again.")}},Ht=()=>{xo.value="",_s.value=!0},Vn=()=>{_s.value=!1,xo.value=""},Gn=async()=>{if(!(!xo.value.trim()||!on.value)){bs.value=!0;try{await fs.addNote(t.params.eventId,on.value.incidentId,xo.value.trim()),Vn(),await oo();const H=vn.value.find(ae=>ae.incidentId===on.value.incidentId);H&&(on.value=H)}catch(H){console.error("Failed to add note to incident:",H),alert(H.response?.data?.message||"Failed to add note. Please try again.")}finally{bs.value=!1}}},At=()=>{mn.value=null,Hn.value="details",vt.value=null,ce.value=!1,$o.value=!0},Tn=H=>{mn.value=H,Hn.value="details",ce.value=!1,$o.value=!0},$t=async H=>{try{let ae=null;const ye=!mn.value||!mn.value.contactId,ke=!!vt.value;if(mn.value&&mn.value.contactId)await fa.update(t.params.eventId,mn.value.contactId,H);else{const tt=await fa.create(t.params.eventId,H);ae=tt.data?.contactId||tt.data?.id}if(await vo(),ye&&ke&&ae&&to.value){const tt=Io.value.find(Lt=>Lt.contactId===ae);tt&&to.value.addPendingContact(tt)}Mn()}catch(ae){console.error("Failed to save contact:",ae);const ye=ae.response?.data?.message||"Failed to save contact. Please try again.";alert(ye)}},Jt=async H=>{y("Delete contact","Are you sure you want to delete this contact?",async()=>{try{await fa.delete(t.params.eventId,H),await vo(),to.value&&to.value.removeContactById(H),Mn()}catch(ae){console.error("Failed to delete contact:",ae),alert(ae.response?.data?.message||"Failed to delete contact. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Mn=()=>{$o.value=!1,mn.value=null,vt.value=null,xt.value="",To.value=null,ce.value=!1},jo=H=>{Zt.value={...H,id:yt.value?.id};const ae={...H,id:yt.value?.id,polygon:[]};yt.value=ae;let ye=!1;if(H.polygon&&H.polygon.length>0){const ke=H.polygon.map(wn=>wn.lat||wn[0]),tt=H.polygon.map(wn=>wn.lng||wn[1]),Lt=Math.min(...ke),Et=Math.max(...ke),un=Math.min(...tt),ra=Math.max(...tt);Ge.value={lat:(Lt+Et)/2,lng:(un+ra)/2};const Ci=Et-Lt,Ss=ra-un,ca=Math.max(Ci,Ss);St.value=ca<.005?17:ca<.01?16:ca<.02?15:ca<.05?14:13,ye=!0}if(!ye&&H.checkpointIds&&H.checkpointIds.length>0){const ke=B.value.filter(tt=>H.checkpointIds.includes(tt.id));if(ke.length>0){const tt=ke.map(Et=>Et.latitude).filter(Boolean),Lt=ke.map(Et=>Et.longitude).filter(Boolean);if(tt.length>0&&Lt.length>0){const Et=Math.min(...tt),un=Math.max(...tt),ra=Math.min(...Lt),Ci=Math.max(...Lt);Ge.value={lat:(Et+un)/2,lng:(ra+Ci)/2};const Ss=un-Et,ca=Ci-ra,wn=Math.max(Ss,ca);St.value=wn<.005?16:wn<.01?15:wn<.02?14:wn<.05?13:12,ye=!0}}}if(!ye&&ne.value){const ke=ne.value.getMapCenter(),tt=ne.value.getMapZoom();ke&&tt!==null&&(Ge.value=ke,St.value=tt)}Co.value=!0,ie.value="draw-area",Wt.value=!0,re.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},jn=H=>{Zt.value?yt.value={...yt.value||{},...Zt.value,polygon:H}:yt.value={...yt.value,polygon:H}},hi=H=>{A.handlePolygonDrawing(H)},Ji=()=>{Wt.value=!1,Zt.value&&(yt.value=Zt.value,eo.value=!0,Zt.value=null)},Na=()=>D.loadEventAdmins(),kc=async H=>{try{await D.addAdmin(H),await Na(),Yi()}catch(ae){console.error("Failed to add admin:",ae),alert(ae.response?.data?.message||"Failed to add administrator. Please try again.")}},Kl=async H=>{y("Remove administrator",`Remove ${H} as an administrator?`,async()=>{try{await D.removeAdmin(H),await Na()}catch(ae){console.error("Failed to remove admin:",ae),alert(ae.response?.data?.message||"Failed to remove administrator. Please try again.")}},{isDanger:!0,confirmText:"Remove"})},Yi=()=>{D.closeAddAdminModal(),ce.value=!1},fi=async H=>{await x.uploadRoute(H)&&(await mo(),ls())},ls=()=>{x.closeUploadRouteModal()},_c=async({file:H,deleteExisting:ae})=>{const ye=await x.importLocations(H,ae);if(ye){await go(),oa();const ke=x.formatImportResultMessage(ye,"location");_t.value="Import Complete",bt.value=ke,mt.value=!0}},oa=()=>{x.closeImportLocationsModal()},so=async H=>{if(X.value)fn.value.latitude=H.lat,fn.value.longitude=H.lng;else if(Y.value)pe.value.latitude=H.lat,pe.value.longitude=H.lng,P.value&&(P.value={...P.value,latitude:H.lat,longitude:H.lng}),Y.value=!1,W.value=!0,zt();else if(ks.value)try{await a.createLocation({eventId:t.params.eventId,name:`Checkpoint ${no.value}`,description:"",latitude:H.lat,longitude:H.lng,requiredMarshals:1,what3Words:""}),no.value++,await $n()}catch(ae){console.error("Failed to create checkpoint:",ae),alert("Failed to create checkpoint. Please try again.")}},Jl=H=>{A.handleFullscreenMapClick(H)},Yl=H=>{fn.value={...H}},bc=()=>{X.value=!1,A.enterPlaceCheckpointMode()},Xi=()=>{A.saveMapState(ne.value),fn.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},A.enterPlaceCheckpointMode()},Qi=()=>{A.saveMapState(ne.value),Co.value=!0,ie.value="view",re.value={title:"Course map",description:""}},wc=()=>{A.saveMapState(ne.value),yt.value={id:null,name:"",description:"",color:"#667eea",polygon:[],checkpointIds:[],marshalIds:[],displayOrder:jt.value.length},A.enterDrawAreaMode()},Cc=()=>{P.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},pe.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},Te.value=[],Oe.value=[],ce.value=!1,W.value=!0},Xl=()=>{const H=A.calculateStartingNumber(B);A.saveMapState(ne.value),A.enterAddMultipleMode(H)},Lc=()=>{if(ie.value==="place-checkpoint"){const H=A.getPlacedCoords()||{lat:0,lng:0};P.value={id:null,name:"",description:"",latitude:H.lat,longitude:H.lng,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},pe.value={id:null,name:"",description:"",latitude:H.lat,longitude:H.lng,requiredMarshals:1,what3Words:""},Te.value=[],Oe.value=[],ce.value=!1,pi(),W.value=!0}else if(ie.value==="move-checkpoint"){const H=A.getPlacedCoords();H&&(pe.value.latitude=H.lat,pe.value.longitude=H.lng,P.value&&(P.value={...P.value,...Qt.value||{},latitude:H.lat,longitude:H.lng}),zt()),Qt.value=null,pi(),W.value=!0}else if(ie.value==="draw-area"){const H=A.getCompletedPolygon();H&&(Zt.value?yt.value={...yt.value||{},...Zt.value,polygon:H}:yt.value={...yt.value||{},polygon:H}),Zt.value=null,pi()}else ie.value==="add-multiple"&&yo()},yo=async()=>{const H=A.getTempCheckpoints();try{for(const ae of H)await a.createLocation({eventId:t.params.eventId,name:ae.name,description:ae.description,latitude:ae.latitude,longitude:ae.longitude,requiredMarshals:ae.requiredMarshals,what3Words:ae.what3Words});A.clearTempCheckpoints(),pi(),await $n()}catch(ae){console.error("Failed to create checkpoints:",ae),alert("Failed to create checkpoints. Please try again.")}},sa=()=>{ie.value==="draw-area"?Zt.value&&(yt.value=Zt.value,Zt.value=null):ie.value==="move-checkpoint"&&(Qt.value&&P.value&&Object.assign(P.value,Qt.value),W.value=!0,Y.value=!1),A.cancelFullscreen()},pi=()=>{A.exitFullscreen()},Zo=H=>{vi(H)},vi=H=>{P.value=H,pe.value={id:H.id,name:H.name,description:H.description||"",latitude:H.latitude,longitude:H.longitude,requiredMarshals:H.requiredMarshals,what3Words:H.what3Words||""},Te.value=[],Oe.value=[],ce.value=!1,W.value=!0,setTimeout(()=>{ne.value?.scrollMapIntoView()},100)},aa=async H=>{if(!zr(H.what3Words)){alert("Invalid What3Words format. Please use word.word.word or word/word/word (lowercase letters only, 1-20 characters each)");return}try{await a.createLocation({eventId:t.params.eventId,...H}),await $n(),Ql()}catch(ae){console.error("Failed to save location:",ae),alert("Failed to save location. Please try again.")}},Ql=()=>{X.value=!1,fn.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},ce.value=!1,ce.value=!1},Ls=()=>{W.value=!1,P.value=null,G.value=!1,Y.value=!1,Ce.value=!1,Qt.value=null,pe.value={id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},Te.value=[],Oe.value=[],ce.value=!1},mi=()=>{Ce.value=!1},gi=()=>{Ce.value=!0},Sc=H=>{H?.formData&&(Qt.value=H.formData),W.value=!1,me.value=null;const ae=Qt.value?.latitude??P.value?.latitude,ye=Qt.value?.longitude??P.value?.longitude;if(ae&&ye)Ge.value={lat:ae,lng:ye},St.value=16;else if(ne.value){const tt=ne.value.getMapCenter(),Lt=ne.value.getMapZoom();tt&&Lt!==null&&(Ge.value=tt,St.value=Lt)}const ke=Qt.value?.name||P.value?.name;Co.value=!0,ie.value="move-checkpoint",re.value={title:`Move ${E.value.checkpoint}: ${ke}`,description:"Click on the map to set the new location"}},rs=async H=>{if(!zr(H.what3Words)){alert("Invalid What3Words format.");return}try{const ae=!P.value.id;if(ae){const ye=await a.createLocation({eventId:t.params.eventId,name:H.name,description:H.description,latitude:H.latitude,longitude:H.longitude,requiredMarshals:H.requiredMarshals,what3Words:H.what3Words||null,startTime:H.startTime,endTime:H.endTime,styleType:H.styleType,styleColor:H.styleColor,styleBackgroundShape:H.styleBackgroundShape,styleBackgroundColor:H.styleBackgroundColor,styleBorderColor:H.styleBorderColor,styleIconColor:H.styleIconColor,styleSize:H.styleSize,styleMapRotation:H.styleMapRotation!=null?String(H.styleMapRotation):null,peopleTerm:H.peopleTerm,checkpointTerm:H.checkpointTerm,isDynamic:H.isDynamic||!1,locationUpdateScopeConfigurations:H.locationUpdateScopeConfigurations||[],pendingNewChecklistItems:H.pendingNewChecklistItems||[],pendingNewNotes:H.pendingNewNotes||[]});if(H.pendingAssignments&&H.pendingAssignments.length>0)for(const ke of H.pendingAssignments)await a.createAssignment({eventId:t.params.eventId,locationId:ye.id,marshalId:ke.marshalId})}else{const ye=P.value.id;if(await Yn.update(t.params.eventId,ye,{eventId:t.params.eventId,name:H.name,description:H.description,latitude:H.latitude,longitude:H.longitude,requiredMarshals:H.requiredMarshals,what3Words:H.what3Words||null,startTime:H.startTime,endTime:H.endTime,styleType:H.styleType,styleColor:H.styleColor,styleBackgroundShape:H.styleBackgroundShape,styleBackgroundColor:H.styleBackgroundColor,styleBorderColor:H.styleBorderColor,styleIconColor:H.styleIconColor,styleSize:H.styleSize,styleMapRotation:H.styleMapRotation!=null?String(H.styleMapRotation):null,peopleTerm:H.peopleTerm,checkpointTerm:H.checkpointTerm,isDynamic:H.isDynamic||!1,locationUpdateScopeConfigurations:H.locationUpdateScopeConfigurations||[]}),H.pendingNewChecklistItems&&H.pendingNewChecklistItems.length>0)for(const ke of H.pendingNewChecklistItems)ke.text?.trim()&&await Rt.create(t.params.eventId,{text:ke.text,scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[ye]}],displayOrder:0,isRequired:!1});if(H.pendingNewNotes&&H.pendingNewNotes.length>0)for(const ke of H.pendingNewNotes)!ke.title?.trim()&&!ke.content?.trim()||await Es.create(t.params.eventId,{title:ke.title||"Untitled",content:ke.content||"",scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[ye]}],displayOrder:0,priority:"Normal",isPinned:!1});for(const ke of Oe.value)await a.deleteAssignment(t.params.eventId,ke);if(H.assignmentsToRemove&&H.assignmentsToRemove.length>0)for(const ke of H.assignmentsToRemove)await a.deleteAssignment(t.params.eventId,ke);for(const ke of Te.value)await a.createAssignment({eventId:t.params.eventId,locationId:P.value.id,marshalId:ke.marshalId});if(H.checkInChanges&&H.checkInChanges.length>0)for(const ke of H.checkInChanges){const tt=P.value.assignments.find(Lt=>Lt.id===ke.assignmentId);tt&&tt.isCheckedIn!==ke.shouldBeCheckedIn&&await Ca.adminCheckIn(t.params.eventId,ke.assignmentId)}}if(!ae&&H.checklistChanges&&H.checklistChanges.length>0)for(const ye of H.checklistChanges)try{ye.complete?await Rt.complete(t.params.eventId,ye.itemId,{marshalId:ye.marshalId,contextType:ye.contextType,contextId:ye.contextId}):await Rt.uncomplete(t.params.eventId,ye.itemId,{marshalId:ye.marshalId,contextType:ye.contextType,contextId:ye.contextId})}catch(ke){console.error("Failed to update checklist item:",ye,ke)}await $n(),Ls()}catch(ae){console.error("Failed to update location:",ae),alert("Failed to update location. Please try again.")}},yi=async H=>{y(`Delete ${E.value.checkpoint}`,`Are you sure you want to delete this ${E.value.checkpoint}?`,async()=>{try{await Yn.delete(t.params.eventId,H),await go(),Ls()}catch(ae){console.error(`Failed to delete ${E.value.checkpoint}:`,ae),alert(`Failed to delete ${E.value.checkpoint}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},xc=async H=>{try{if(K.value&&K.value.setCheckingIn(H.id),await Ca.adminCheckIn(t.params.eventId,H.id),await Xs(),P.value){const ae=B.value.find(ye=>ye.id===P.value.id);ae&&(P.value=ae)}}catch(ae){console.error("Failed to toggle check-in:",ae),alert("Failed to toggle check-in. Please try again.")}finally{K.value&&K.value.setCheckingIn(null)}},el=H=>{const ae=H?.id??H;if(ae?.toString().startsWith("temp-")){const ye=P.value.assignments.find(ke=>ke.id===ae);ye&&(Te.value=Te.value.filter(ke=>ke.marshalId!==ye.marshalId)),P.value.assignments=P.value.assignments.filter(ke=>ke.id!==ae),zt()}else Oe.value.includes(ae)||(Oe.value.push(ae),P.value.assignments=P.value.assignments.filter(ye=>ye.id!==ae),zt())},Ic=async H=>{const ae=te.value.find(ke=>ke.id===H);if(!ae)return;const ye=B.value.filter(ke=>ke.assignments?.some(tt=>tt.marshalId===H&&ke.id!==P.value.id));if(ye.length>0){J.value={marshalName:ae.name,locations:ye.map(tt=>tt.name),marshal:ae};const ke=await new Promise(tt=>{j.value=tt,le.value=!0});if(ke==="cancel"||ke==="choose-other")return;if(ke==="move")for(const tt of ye){const Lt=tt.assignments.find(Et=>Et.marshalId===H);if(Lt){Oe.value.push(Lt.id);const Et=B.value.findIndex(un=>un.id===tt.id);Et!==-1&&(B.value[Et].assignments=B.value[Et].assignments.filter(un=>un.id!==Lt.id))}}}Te.value.push({marshalId:ae.id,marshalName:ae.name}),P.value.assignments||(P.value.assignments=[]),P.value.assignments.push({id:`temp-${Date.now()}`,marshalId:ae.id,marshalName:ae.name,locationId:P.value.id,isCheckedIn:!1,isPending:!0}),zt(),mi()},qo=async H=>{try{const ye=(await ms.create({eventId:t.params.eventId,name:H.name,email:H.email,phoneNumber:H.phoneNumber})).data;await Ho(),Te.value.push({marshalId:ye.id,marshalName:ye.name}),P.value&&(P.value.assignments||(P.value.assignments=[]),P.value.assignments.push({id:`temp-${Date.now()}`,marshalId:ye.id,marshalName:ye.name,locationId:P.value.id,isCheckedIn:!1,isPending:!0})),zt(),mi()}catch(ae){console.error("Failed to create marshal:",ae),alert("Failed to create marshal. Please try again.")}},$c=()=>{Se.value=null,Z.value={},se.value={id:"",name:"",email:"",phoneNumber:"",notes:""},Be.value=[],Xe.value=[],ce.value=!1,Re.value=!0},ia=H=>{Se.value=H,Z.value={},se.value={id:H.id,name:H.name,email:H.email||"",phoneNumber:H.phoneNumber||"",notes:H.notes||""},Be.value=[],Xe.value=[],ce.value=!1,Re.value=!0},er=V(()=>{if(!Se.value)return[];const H=[];return B.value.forEach(ae=>{ae.assignments.filter(ke=>ke.marshalName===Se.value.name&&!Xe.value.includes(ke.id)).forEach(ke=>{H.push({...ke,locationName:ae.name,locationDescription:ae.description||""})})}),Be.value.forEach((ae,ye)=>{const ke=B.value.find(tt=>tt.id===ae.locationId);ke&&H.push({id:`pending-${ye}`,locationId:ae.locationId,locationName:ke.name,locationDescription:ke.description||"",marshalId:Se.value.id,marshalName:Se.value.name,isCheckedIn:!1,isPending:!0})}),H}),Wo=async H=>{try{let ae=Se.value?.id,ye=!1;if(Se.value){if(await ms.update(t.params.eventId,Se.value.id,{name:H.name,email:H.email,phoneNumber:H.phoneNumber,notes:H.notes}),H.pendingNewChecklistItems&&H.pendingNewChecklistItems.length>0)for(const ke of H.pendingNewChecklistItems)ke.text?.trim()&&await Rt.create(t.params.eventId,{text:ke.text,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[ae]}],displayOrder:0,isRequired:!1});if(H.pendingNewNotes&&H.pendingNewNotes.length>0)for(const ke of H.pendingNewNotes)!ke.title?.trim()&&!ke.content?.trim()||await Es.create(t.params.eventId,{title:ke.title||"Untitled",content:ke.content||"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[ae]}],displayOrder:0,priority:"Normal",isPinned:!1})}else ae=(await ms.create({eventId:t.params.eventId,name:H.name,email:H.email,phoneNumber:H.phoneNumber,notes:H.notes,pendingNewChecklistItems:H.pendingNewChecklistItems||[],pendingNewNotes:H.pendingNewNotes||[]})).data.id,ye=!0;for(const ke of Xe.value)await a.deleteAssignment(t.params.eventId,ke);if(H.assignmentsToRemove&&H.assignmentsToRemove.length>0)for(const ke of H.assignmentsToRemove)await a.deleteAssignment(t.params.eventId,ke);for(const ke of Be.value)await a.createAssignment({eventId:t.params.eventId,locationId:ke.locationId,marshalId:ae});if(H.pendingAssignments&&H.pendingAssignments.length>0)for(const ke of H.pendingAssignments)await a.createAssignment({eventId:t.params.eventId,locationId:ke.locationId,marshalId:ae});if(H.checkInChanges&&H.checkInChanges.length>0){const ke=er.value;for(const tt of H.checkInChanges){const Lt=ke.find(Et=>Et.id===tt.assignmentId);Lt&&Lt.isCheckedIn!==tt.shouldBeCheckedIn&&await Ca.adminCheckIn(t.params.eventId,tt.assignmentId)}}if(H.checklistChanges&&H.checklistChanges.length>0)for(const ke of H.checklistChanges)try{const tt={marshalId:ae};ke.contextType&&ke.contextId&&(tt.contextType=ke.contextType,tt.contextId=ke.contextId),ke.complete?await Rt.complete(t.params.eventId,ke.itemId,tt):await Rt.uncomplete(t.params.eventId,ke.itemId,tt)}catch(tt){console.error("Failed to process checklist change:",tt);const Lt=tt.response?.data?.message||"Failed to update checklist item";alert(`Error: ${Lt}`)}if(await $n(),P.value){const ke=B.value.find(tt=>tt.id===P.value.id);ke&&(P.value=ke)}Ua(),ye&&(U.value=ae,ee.value=H.name,he.value=!0)}catch(ae){console.error("Failed to save marshal:",ae);const ye=ae.response?.data?.message||"Failed to save marshal. Please try again.";if(ae.response?.status===400){const ke=ye.toLowerCase();ke.includes("name")?(Z.value={name:ye},ge.value&&(ge.value.switchToTab("details"),ge.value.focusField("name"))):ke.includes("email")?(Z.value={email:ye},ge.value&&(ge.value.switchToTab("details"),ge.value.focusField("email"))):(Z.value={general:ye},ge.value&&ge.value.switchToTab("details"))}else Z.value={general:ye},ge.value&&ge.value.switchToTab("details")}},Fa=async H=>{const ae=H||Se.value?.id;if(!ae){console.error("No marshal ID to delete");return}const ye=E.value.person;y(`Delete ${ye}`,`Are you sure you want to delete this ${ye}?`,async()=>{try{await ms.delete(t.params.eventId,ae),await is(),Ua()}catch(ke){console.error(`Failed to delete ${ye}:`,ke),alert(`Failed to delete ${ye}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},tr=H=>{Fa(H.id)},tl=H=>{const ae=H?.id??H;if(ae?.toString().startsWith("pending-")){const ye=H?.locationId;ye&&(Be.value=Be.value.filter(ke=>ke.locationId!==ye)),zt()}else Xe.value.includes(ae)||(Xe.value.push(ae),zt())},ki=H=>{Be.value.push({locationId:H}),zt()},Ua=()=>{Re.value=!1,Se.value=null,we.value=null,Z.value={},se.value={id:"",name:"",email:"",phoneNumber:"",notes:""},Be.value=[],Xe.value=[],ce.value=!1},_i=async H=>{const ae=te.value.find(ye=>ye.id===H.marshalId);if(!ae){console.error("Marshal not found:",H.marshalId);return}we.value=P.value?.id||null,ce.value=!1,Se.value=ae,Re.value=!0},la=H=>{const ae=B.value.find(ye=>ye.id===H.locationId);if(!ae){console.error("Location not found:",H.locationId);return}G.value=!0,ce.value=!1,P.value=ae,W.value=!0},bi=async({file:H})=>{const ae=await x.importMarshals(H);if(ae){await is(),wi();const ye=x.formatImportResultMessage(ae,"marshal");_t.value="Import Complete",bt.value=ye,mt.value=!0}},wi=()=>{x.closeImportMarshalsModal()},nr=H=>{j.value&&(j.value(H),j.value=null),le.value=!1};let za=null;const Ha=async()=>{try{const H=t.params.eventId,ae=await Yn.getDynamicCheckpoints(H);if(ae.data&&Array.isArray(ae.data))for(const ye of ae.data){const ke=B.value.find(tt=>tt.id===ye.checkpointId);ke&&(ke.latitude=ye.latitude,ke.longitude=ye.longitude,ke.lastLocationUpdate=ye.lastLocationUpdate)}}catch(H){console.warn("Failed to poll dynamic checkpoints:",H)}},or=()=>{za||!B.value.some(ae=>ae.isDynamic||ae.IsDynamic)||(Ha(),za=setInterval(Ha,6e4))},nl=()=>{za&&(clearInterval(za),za=null)};return qe(i,H=>{H==="course"?or():nl();const ae=Date.now(),ye=ke=>ae-q.value[ke]>aO;switch(H){case"marshals":ye("marshals")&&Ho();break;case"areas":ye("areas")&&lt();break;case"checkpoints":ye("checkpoints")&&mo();break;case"checklists":ye("checklists")&&_n();break;case"notes":ye("notes")&&It();break;case"incidents":ye("incidents")&&oo();break;case"contacts":ye("contacts")&&vo();break}}),nn(async()=>{await $n();try{const H=await vs.getMe(t.params.eventId);fo.value=H.data}catch(H){console.warn("Failed to fetch user claims:",H)}i.value==="course"&&or()}),qe(T,H=>{H&&(document.title="OnTheDay App - Admin")},{immediate:!0}),xn(()=>{nl()}),(H,ae)=>(v(),m("div",{class:"admin-event-manage",style:Qe({colorScheme:O(R)})},[r("header",WR,[r("div",KR,[r("button",{onClick:Pa,class:"btn-back",title:"Back to sessions"},[Ae(qR,{size:48,animate:""})]),T.value?(v(),m("div",JR,[r("h1",null,C(T.value.name),1),r("p",YR,C(O(Vv)(T.value.eventDate)),1)])):M("",!0)]),r("div",XR,[Fo.value?(v(),m("button",{key:0,onClick:Ma,class:"btn btn-marshal-mode"}," Switch to Marshal ")):M("",!0)]),Ae(HR,{class:"theme-toggle-fixed"})]),r("div",QR,[r("div",eO,[Ae(y$,{tabs:F.value,"model-value":O(i),"onUpdate:modelValue":O(l)},null,8,["tabs","model-value","onUpdate:modelValue"])]),r("div",tO,[O(i)==="course"?(v(),We(W0,{key:0,ref_key:"courseAreasTab",ref:ne,checkpoints:B.value,areas:jt.value,route:T.value?.route||[],"selected-area-id":pn.value,"drawing-mode":O(Wt),onMapClick:so,onLocationClick:Zo,onAreaClick:Kt,onImportCheckpoints:ae[0]||(ae[0]=ye=>Ze.value=!0),onUploadRoute:ae[1]||(ae[1]=ye=>De.value=!0),onSelectLocation:vi,onAddArea:Vo,onSelectArea:Kt,onPolygonComplete:jn,onCancelDrawing:Ji,onAddCheckpointFromMap:Xi,onAddManyCheckpointsFromMap:Xl,onAddAreaFromMap:wc,onFullscreen:Qi},null,8,["checkpoints","areas","route","selected-area-id","drawing-mode"])):M("",!0),O(i)==="checkpoints"?(v(),We(HI,{key:1,locations:B.value,areas:jt.value,onAddCheckpointManually:Cc,onImportCheckpoints:ae[2]||(ae[2]=ye=>Ze.value=!0),onSelectLocation:vi},null,8,["locations","areas"])):M("",!0),O(i)==="areas"?(v(),We(r$,{key:2,areas:jt.value,checkpoints:B.value,contacts:Io.value,"event-people-term":T.value?.peopleTerm||"Marshals","event-checkpoint-term":T.value?.checkpointTerm||"Checkpoints",onAddArea:Vo,onSelectArea:Kt},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term"])):M("",!0),O(i)==="marshals"?(v(),We(Aw,{key:3,ref_key:"marshalsTabRef",ref:K,marshals:te.value,assignments:Ut.value,locations:B.value,onAddMarshal:$c,onImportMarshals:ae[3]||(ae[3]=ye=>He.value=!0),onSelectMarshal:ia,onDeleteMarshal:tr,onToggleCheckIn:xc},null,8,["marshals","assignments","locations"])):M("",!0),O(i)==="checklists"?(v(),We(jw,{key:4,"checklist-items":Do.value,areas:jt.value,locations:B.value,marshals:te.value,"completion-report":Ta.value,onAddChecklistItem:ui,onSelectChecklistItem:ta},null,8,["checklist-items","areas","locations","marshals","completion-report"])):M("",!0),O(i)==="notes"?(v(),We(uC,{key:5,notes:Oo.value,areas:jt.value,locations:B.value,marshals:te.value,onAddNote:Cs,onSelectNote:Oa},null,8,["notes","areas","locations","marshals"])):M("",!0),O(i)==="incidents"?(v(),We(CI,{key:6,incidents:vn.value,areas:jt.value,loading:Bo.value,onSelectIncident:at,onReportIncident:Ee},null,8,["incidents","areas","loading"])):M("",!0),O(i)==="contacts"?(v(),We(NC,{key:7,contacts:Io.value,areas:jt.value,locations:B.value,marshals:te.value,"available-roles":No.value,onAddContact:At,onSelectContact:Tn},null,8,["contacts","areas","locations","marshals","available-roles"])):M("",!0),O(i)==="details"?(v(),We(JC,{key:8,"event-data":Mt.value,"form-dirty":wt.value,onSubmit:Ks,"onUpdate:formDirty":ws},null,8,["event-data","form-dirty"])):M("",!0),O(i)==="settings"?(v(),We(Qx,{key:9,"event-data":Mt.value,"event-id":O(t).params.eventId,admins:O(fe),"form-dirty":wt.value,onSubmit:Ks,onAddAdmin:ae[4]||(ae[4]=ye=>ue.value=!0),onRemoveAdmin:Kl,"onUpdate:formDirty":ws},null,8,["event-data","event-id","admins","form-dirty"])):M("",!0)])]),Ae(RR,{show:X.value,location:fn.value,"is-dirty":ce.value,onClose:Ql,onSave:aa,onSetOnMap:bc,"onUpdate:isDirty":zt,"onUpdate:location":Yl},null,8,["show","location","is-dirty"]),Ae(G4,{show:W.value,location:P.value,assignments:P.value?.assignments||[],"event-date":T.value?.eventDate||"",areas:jt.value,"event-id":O(t).params.eventId,"all-locations":B.value,notes:Oo.value,"available-marshals":Uo.value,"all-checklist-items":Do.value,incidents:zo.value,"is-dirty":ce.value,"event-default-style-type":T.value?.defaultCheckpointStyleType||T.value?.DefaultCheckpointStyleType||"default","event-default-style-color":T.value?.defaultCheckpointStyleColor||T.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":T.value?.defaultCheckpointStyleBackgroundShape||T.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":T.value?.defaultCheckpointStyleBackgroundColor||T.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":T.value?.defaultCheckpointStyleBorderColor||T.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":T.value?.defaultCheckpointStyleIconColor||T.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":T.value?.defaultCheckpointStyleSize||T.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":T.value?.defaultCheckpointStyleMapRotation??T.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":T.value?.peopleTerm||"Marshals","z-index":eo.value?1200:G.value?1100:1e3,"locked-from-marshal":G.value,onClose:Ls,onSave:rs,onDelete:yi,onMoveLocation:Sc,onRemoveAssignment:el,onOpenAssignModal:gi,"onUpdate:isDirty":zt,onSelectIncident:Ea,onSelectMarshal:_i},null,8,["show","location","assignments","event-date","areas","event-id","all-locations","notes","available-marshals","all-checklist-items","incidents","is-dirty","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","z-index","locked-from-marshal"]),Ae(P$,{show:Q.value,link:ht.value,"is-dirty":!1,onClose:ae[5]||(ae[5]=ye=>Q.value=!1)},null,8,["show","link"]),Ae(q$,{show:he.value,"event-id":O(t).params.eventId,"marshal-id":U.value,"marshal-name":ee.value,onClose:ae[6]||(ae[6]=ye=>he.value=!1)},null,8,["show","event-id","marshal-id","marshal-name"]),Ae(J$,{show:O(ue),"is-dirty":ce.value,onClose:Yi,onSubmit:kc,"onUpdate:isDirty":zt},null,8,["show","is-dirty"]),Ae(tT,{show:O(De),uploading:O(et),error:O(Je),"is-dirty":ce.value,onClose:ls,onSubmit:fi,"onUpdate:isDirty":zt},null,8,["show","uploading","error","is-dirty"]),Ae(dT,{show:O(Ze),importing:O(be),error:O(ve),result:O(Le),"is-dirty":ce.value,onClose:oa,onSubmit:_c,"onUpdate:isDirty":zt},null,8,["show","importing","error","result","is-dirty"]),Ae(zP,{ref_key:"editMarshalModalRef",ref:ge,show:Re.value,marshal:Se.value,"event-id":O(t).params.eventId,assignments:er.value,"available-locations":Aa.value,"all-locations":B.value,areas:jt.value,"is-editing":!!Se.value,"event-notes":Oo.value,"all-checklist-items":Do.value,incidents:qt.value,"is-dirty":ce.value,"validation-errors":Z.value,"locked-checkpoint-id":we.value,"z-index":we.value?1100:1e3,onClose:Ua,onSave:Wo,onDelete:Fa,onRemoveAssignment:tl,onAssignToLocation:ki,"onUpdate:isDirty":zt,onSelectIncident:In,onSelectCheckpoint:la},null,8,["show","marshal","event-id","assignments","available-locations","all-locations","areas","is-editing","event-notes","all-checklist-items","incidents","is-dirty","validation-errors","locked-checkpoint-id","z-index"]),Ae(kT,{show:O(He),importing:O(Ve),error:O(ve),result:O(Pe),"is-dirty":ce.value,onClose:wi,onSubmit:bi,"onUpdate:isDirty":zt},null,8,["show","importing","error","result","is-dirty"]),Ae(jP,{show:le.value,"conflict-data":J.value,onClose:ae[7]||(ae[7]=ye=>le.value=!1),onChoice:nr},null,8,["show","conflict-data"]),Ae(t6,{show:Ce.value,"location-name":P.value?.name||"",marshals:Uo.value,onClose:mi,onAssignExisting:Ic,onCreateAndAssign:qo},null,8,["show","location-name","marshals"]),Ae(f6,{show:Nt.value,"old-event-date":Ft.value,"new-event-date":Fn.value,"affected-checkpoints-count":Qn.value,onConfirm:Ys,onCancel:Da},null,8,["show","old-event-date","new-event-date","affected-checkpoints-count"]),Ae(A5,{ref_key:"editAreaModalRef",ref:to,show:eo.value,area:yt.value,"initial-tab":Un.value,checkpoints:B.value,marshals:te.value,areas:jt.value,route:T.value?.route||[],"is-dirty":ce.value,"event-id":O(t).params.eventId,"all-locations":B.value,assignments:Ut.value,notes:Oo.value,contacts:Io.value,incidents:yn.value,"event-default-style-type":T.value?.defaultCheckpointStyleType||T.value?.DefaultCheckpointStyleType||"default","event-default-style-color":T.value?.defaultCheckpointStyleColor||T.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":T.value?.defaultCheckpointStyleBackgroundShape||T.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":T.value?.defaultCheckpointStyleBackgroundColor||T.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":T.value?.defaultCheckpointStyleBorderColor||T.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":T.value?.defaultCheckpointStyleIconColor||T.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":T.value?.defaultCheckpointStyleSize||T.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":T.value?.defaultCheckpointStyleMapRotation??T.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":T.value?.peopleTerm||"Marshals","event-checkpoint-term":T.value?.checkpointTerm||"Checkpoints",onClose:Qs,onSave:Go,onDelete:Ra,onDrawBoundary:jo,"onUpdate:isDirty":zt,onSelectCheckpoint:vi,onCreateContactFromMarshal:Wi,onCreateNewContact:ci,onEditContact:ea,onSelectIncident:kn},null,8,["show","area","initial-tab","checkpoints","marshals","areas","route","is-dirty","event-id","all-locations","assignments","notes","contacts","incidents","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","event-checkpoint-term"]),Ae(V5,{show:Ro.value,"checklist-item":uo.value,"initial-tab":zn.value,areas:jt.value,locations:B.value,marshals:te.value,"is-dirty":ce.value,onClose:bn,onSave:gt,onDelete:Ki,"onUpdate:isDirty":zt},null,8,["show","checklist-item","initial-tab","areas","locations","marshals","is-dirty"]),Ae(a8,{show:Zs.value,note:Lo.value,"initial-tab":qs.value,areas:jt.value,locations:B.value,marshals:te.value,"is-dirty":ce.value,onClose:Ba,onSave:di,onDelete:na,"onUpdate:isDirty":zt},null,8,["show","note","initial-tab","areas","locations","marshals","is-dirty"]),Ae(Qv,{show:So.value,incident:on.value,route:T.value?.route||[],checkpoints:B.value,"can-manage":!0,onClose:ft,onStatusChange:Ct,onOpenAddNote:Ht},null,8,["show","incident","route","checkpoints"]),Ae(Gt,{show:_s.value,title:"Add update",size:"small",onClose:Vn},{footer:ze(()=>[r("div",oO,[r("button",{type:"button",class:"btn btn-secondary",onClick:Vn}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:Gn,disabled:!xo.value.trim()||bs.value},C(bs.value?"Adding...":"Add update"),9,sO)])]),default:ze(()=>[r("div",nO,[Ue(r("textarea",{"onUpdate:modelValue":ae[8]||(ae[8]=ye=>xo.value=ye),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[st,xo.value]])])]),_:1},8,["show"]),Ae(em,{show:ho.value,"event-id":O(t).params.eventId,checkpoint:null,"initial-location":null,checkpoints:B.value,route:T.value?.route||[],onClose:ae[9]||(ae[9]=ye=>ho.value=!1),onSubmit:Me},null,8,["show","event-id","checkpoints","route"]),Ae(uR,{show:$o.value,contact:mn.value,"initial-tab":Hn.value,areas:jt.value,locations:B.value,marshals:te.value,"available-roles":No.value,"is-dirty":ce.value,"prefilled-name":xt.value,"prefilled-marshal-id":To.value,"create-from-area-context":!!vt.value,onClose:Mn,onSave:$t,onDelete:Jt,"onUpdate:isDirty":zt},null,8,["show","contact","initial-tab","areas","locations","marshals","available-roles","is-dirty","prefilled-name","prefilled-marshal-id","create-from-area-context"]),Ae(LR,{show:O(Co),mode:O(ie),"context-title":O(re).title,"context-description":O(re).description,"can-complete":gn.value,clickable:O(ie)!=="draw-area","drawing-mode":O(ie)==="draw-area"&&O(Wt),locations:Ws.value,areas:po.value,route:T.value?.route||[],"selected-area-id":pn.value,center:O(Ge),zoom:O(St),"highlight-location-id":ri.value,onMapClick:Jl,onPolygonComplete:jn,onPolygonDrawing:hi,onDone:Lc,onCancel:sa},null,8,["show","mode","context-title","context-description","can-complete","clickable","drawing-mode","locations","areas","route","selected-area-id","center","zoom","highlight-location-id"]),Ae(yc,{show:mt.value,title:_t.value,message:bt.value,onClose:ae[10]||(ae[10]=ye=>mt.value=!1)},null,8,["show","title","message"]),Ae(Nl,{show:O(u),title:O(d),message:O(p),"is-danger":O(f),"confirm-text":O(g),onConfirm:O(_),onCancel:O(k)},null,8,["show","title","message","is-danger","confirm-text","onConfirm","onCancel"])],4))}},lO=je(iO,[["__scopeId","data-v-d8917ba7"]]),rO={key:0,class:"emergency-notes-section"},cO={class:"emergency-notes-list"},uO={class:"note-header"},dO={key:0,class:"note-content"},hO={key:1,class:"emergency-contacts-section"},fO={class:"emergency-contacts-list"},pO={class:"contact-header"},vO={key:0,class:"role-badge"},mO={class:"contact-details"},gO={key:0,class:"info-section"},yO=["href"],kO={key:1,class:"info-section"},_O=["href"],bO={key:2,class:"info-section"},wO=["href"],CO={key:2,class:"no-contacts"},LO={__name:"EmergencyContactModal",props:{show:{type:Boolean,default:!1},contacts:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const o=e,a=t,s=V(()=>o.notes?[...o.notes].filter(d=>d.showInEmergencyInfo||d.ShowInEmergencyInfo).sort((d,p)=>{const f=d.priority||d.Priority,g=p.priority||p.Priority;return f==="Emergency"&&g!=="Emergency"?-1:g==="Emergency"&&f!=="Emergency"?1:0}):[]),i=V(()=>o.contacts?o.contacts.filter(d=>d.showInEmergencyInfo||d.ShowInEmergencyInfo):[]),l=()=>{a("close")},u=d=>d?{EmergencyContact:"Emergency Contact",EventDirector:"Event Director",MedicalLead:"Medical Lead",SafetyOfficer:"Safety Officer",Logistics:"Logistics"}[d]||d.replace(/([A-Z])/g," $1").trim():"";return(d,p)=>(v(),We(Gt,{show:e.show,title:"Emergency information",size:"medium",onClose:l},{actions:ze(()=>[r("button",{onClick:l,class:"btn btn-secondary"},"Close")]),default:ze(()=>[s.value.length>0?(v(),m("div",rO,[p[0]||(p[0]=r("h2",{class:"section-header"},"Emergency notes",-1)),r("div",cO,[(v(!0),m(xe,null,Ne(s.value,f=>(v(),m("div",{key:f.noteId||f.NoteId,class:de(["emergency-note-item",{"is-emergency":(f.priority||f.Priority)==="Emergency"}])},[r("div",uO,[r("h3",null,C(f.title||f.Title),1),r("span",{class:de(["priority-badge",(f.priority||f.Priority).toLowerCase()])},C(f.priority||f.Priority),3)]),f.content||f.Content?(v(),m("div",dO,C(f.content||f.Content),1)):M("",!0)],2))),128))])])):M("",!0),i.value&&i.value.length>0?(v(),m("div",hO,[p[4]||(p[4]=r("h2",{class:"section-header"},"Emergency contacts",-1)),r("div",fO,[(v(!0),m(xe,null,Ne(i.value,f=>(v(),m("div",{key:f.contactId||f.name,class:"emergency-contact-item"},[r("div",pO,[r("h3",null,C(f.name),1),f.role?(v(),m("span",vO,C(u(f.role)),1)):M("",!0)]),r("div",mO,[f.phone?(v(),m("div",gO,[p[1]||(p[1]=r("label",null,"Phone number",-1)),r("a",{href:`tel:${f.phone}`,class:"phone-link"},C(f.phone),9,yO)])):M("",!0),f.email?(v(),m("div",kO,[p[2]||(p[2]=r("label",null,"Email",-1)),r("a",{href:`mailto:${f.email}`,class:"email-link"},C(f.email),9,_O)])):M("",!0),f.notes||f.details?(v(),m("div",bO,[p[3]||(p[3]=r("label",null,"Details",-1)),r("p",null,C(f.notes||f.details),1)])):M("",!0)]),f.phone?(v(),m("a",{key:0,href:`tel:${f.phone}`,class:"btn btn-danger btn-full"}," Call "+C(f.name),9,wO)):M("",!0)]))),128))])])):M("",!0),i.value.length===0&&s.value.length===0?(v(),m("div",CO,[...p[5]||(p[5]=[r("p",null,"No emergency information has been set up for this event.",-1)])])):M("",!0)]),_:1},8,["show"]))}},SO=je(LO,[["__scopeId","data-v-6f08d5d1"]]),pl=$(navigator.onLine),Ns=$(!0),_a=$(0),pr=$(null),Ya=$("idle"),Oi=$(null),Eu=$(!1);let cf=null,Xc=!1,Yo=null,uf=0;function xO(e=1e3,t=1e4){return Math.floor(Math.random()*(t-e+1))+e}function Gr(){Yo&&(clearTimeout(Yo),Yo=null);const e=xO(1e3,1e4);console.log(`Scheduling auto-sync in ${e}ms`),Yo=setTimeout(async()=>{if(Yo=null,!navigator.onLine){console.log("Auto-sync cancelled: offline");return}if(await Fr()===0){console.log("Auto-sync cancelled: no pending actions");return}console.log("Starting auto-sync..."),await jr();const o=await Fr();o>0&&navigator.onLine&&(console.log(`${o} actions remaining, scheduling retry...`),Gr())},e)}async function Ai(){if(!navigator.onLine)return Ns.value=!1,!1;try{return await j_.check(),Ns.value=!0,!0}catch(e){return e.response?.status===404?(Ns.value=!0,!0):(e.code==="ECONNABORTED"&&console.warn("Server health check timed out"),Ns.value=!1,!1)}}async function ld(){const e=Date.now();if(e-uf<2e3)return;uf=e;const t=navigator.onLine;if(pl.value=t,!t){Ns.value=!1;return}Eu.value=!0;try{await Ai()&&_a.value>0&&Gr()}finally{Eu.value=!1}}function df(){document.visibilityState==="visible"&&(console.log("Page became visible, checking connectivity..."),ld())}function hf(){console.log("Window focused, checking connectivity..."),ld()}async function IO(e){try{switch(e.type){case"checkin":await Ca.checkIn(e.payload);break;case"checkin_toggle":await Ca.toggleCheckIn(e.payload.eventId,e.payload.assignmentId,e.payload.gpsData||{});break;case"checkin_admin":await Ca.adminCheckIn(e.payload.eventId,e.payload.assignmentId);break;case"checklist_complete":await Rt.complete(e.payload.eventId,e.payload.itemId,e.payload.data);break;case"checklist_uncomplete":await Rt.uncomplete(e.payload.eventId,e.payload.itemId,e.payload.data);break;default:return console.warn("Unknown action type:",e.type),!1}return!0}catch(t){if(console.error("Failed to sync action:",e,t),t.response&&t.response.status===400){const o=t.response.data?.message||t.response.data||"",a=typeof o=="string"?o.toLowerCase():"";if(a.includes("already checked in"))return console.log("Action already completed (already checked in), treating as success"),!0;if(a.includes("already completed")||a.includes("already uncompleted"))return console.log("Action already completed (checklist state), treating as success"),!0}return t.response&&t.response.status>=400&&t.response.status<500?"permanent_failure":!1}}async function jr(){if(!Xc&&navigator.onLine){Xc=!0,Ya.value="syncing",Oi.value=null;try{const e=await Pv();if(e.length===0){Ya.value="success",_a.value=0;return}let t=0,o=0;for(const a of e){const s=await IO(a);if(s===!0)await Yh(a.id),t++;else if(s==="permanent_failure")await Yh(a.id),o++;else{const i=(a.attempts||0)+1;i>=5?(await Jh(a.id,{status:"failed",attempts:i,lastAttempt:new Date().toISOString()}),o++):await Jh(a.id,{status:"retrying",attempts:i,lastAttempt:new Date().toISOString()})}}_a.value=await Fr(),o>0?(Ya.value="error",Oi.value=`${o} action(s) failed to sync`):Ya.value="success"}catch(e){console.error("Sync error:",e),Ya.value="error",Oi.value="Failed to sync pending actions"}finally{Xc=!1}}}function $O(){cf||(cf=setInterval(async()=>{navigator.onLine&&(await Ai(),Ns.value&&_a.value>0&&await jr())},3e4))}function rd(){const e=V(()=>pl.value&&Ns.value);async function t(){_a.value=await Fr()}async function o(){pl.value=!0,await Ai()&&_a.value>0&&Gr()}function a(){pl.value=!1,Ns.value=!1,Yo&&(clearTimeout(Yo),Yo=null)}nn(async()=>{await js(),await t(),window.addEventListener("online",o),window.addEventListener("offline",a),document.addEventListener("visibilitychange",df),window.addEventListener("focus",hf),navigator.onLine&&await Ai()&&_a.value>0&&Gr(),$O()}),xn(()=>{window.removeEventListener("online",o),window.removeEventListener("offline",a),document.removeEventListener("visibilitychange",df),window.removeEventListener("focus",hf),Yo&&(clearTimeout(Yo),Yo=null)});async function s(d,p){if(!e.value)return console.warn("Cannot refresh cache while offline"),!1;try{const f=await p();return await Ol(d,f),pr.value=new Date().toISOString(),!0}catch(f){return console.error("Failed to refresh cache:",f),!1}}async function i(d){const p=await wa(d);return p&&(pr.value=p.cachedAt),p}async function l(d){pr.value=await B_(d)}async function u(){return navigator.onLine?await Ai()?(await jr(),Ya.value==="success"):(Oi.value="Server is not responding",!1):(Oi.value="Cannot sync while offline",!1)}return{isOnline:pl,isServerHealthy:Ns,isFullyOnline:e,isCheckingStatus:Eu,pendingActionsCount:_a,lastSyncTime:pr,syncStatus:Ya,syncError:Oi,checkServerHealth:Ai,quickConnectivityCheck:ld,syncPendingActions:jr,updatePendingCount:t,refreshCache:s,getCachedData:i,loadLastSyncTime:l,forcSync:u}}const TO={class:"offline-indicator-container"},MO={class:"offline-icon"},AO={key:0,viewBox:"0 0 24 24",fill:"currentColor"},EO={key:1,class:"spinner",viewBox:"0 0 24 24",fill:"currentColor"},PO={class:"offline-text"},DO={key:0,class:"last-sync"},RO={class:"pending-text"},OO={key:0,class:"pending-subtext"},BO={key:1,class:"syncing-text"},NO={__name:"OfflineIndicator",setup(e){const{isOnline:t,isFullyOnline:o,isCheckingStatus:a,pendingActionsCount:s,lastSyncTime:i,syncStatus:l,syncError:u,forcSync:d}=rd(),p=$(!1),f=$(""),g=$(""),y=V(()=>{if(!i.value)return"";const k=new Date(i.value),S=new Date-k,E=Math.floor(S/6e4),A=Math.floor(E/60);return E<1?"just now":E<60?`${E}m ago`:A<24?`${A}h ago`:k.toLocaleDateString()}),_=async()=>{await d()};return qe(l,k=>{k==="success"&&s.value===0?(f.value="All actions synced successfully!",g.value="success",p.value=!0,setTimeout(()=>{p.value=!1},3e3)):k==="error"&&(f.value=u.value||"Sync failed",g.value="error",p.value=!0,setTimeout(()=>{p.value=!1},5e3))}),(k,w)=>(v(),m("div",TO,[Ae(gs,{name:"slide"},{default:ze(()=>[O(o)?M("",!0):(v(),m("div",{key:0,class:de(["offline-banner",{checking:O(a)}])},[r("span",MO,[O(a)?(v(),m("svg",EO,[...w[1]||(w[1]=[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8z"},null,-1)])])):(v(),m("svg",AO,[...w[0]||(w[0]=[r("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"},null,-1)])]))]),r("span",PO,C(O(a)?"Checking connection...":O(t)?"Server unavailable":"You're offline"),1),O(i)&&!O(a)?(v(),m("span",DO," Last synced: "+C(y.value),1)):M("",!0)],2))]),_:1}),Ae(gs,{name:"fade"},{default:ze(()=>[O(s)>0?(v(),m("div",{key:0,class:de(["pending-banner",{"offline-pending":!O(o)}])},[w[2]||(w[2]=r("span",{class:"pending-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})])],-1)),r("span",RO,[Ye(C(O(s))+" pending action"+C(O(s)!==1?"s":"")+" ",1),O(o)?M("",!0):(v(),m("span",OO,"(will sync when online)"))]),O(o)&&O(l)!=="syncing"?(v(),m("button",{key:0,onClick:_,class:"sync-button"}," Sync Now ")):O(l)==="syncing"?(v(),m("span",BO,"Syncing...")):M("",!0)],2)):M("",!0)]),_:1}),Ae(gs,{name:"fade"},{default:ze(()=>[p.value?(v(),m("div",{key:0,class:de(["sync-toast",g.value])},C(f.value),3)):M("",!0)]),_:1})]))}},FO=je(NO,[["__scopeId","data-v-9c1e58f4"]]),UO={class:"modal-content check-in-reminder-modal"},zO={class:"modal-header warning"},HO={class:"modal-body"},VO={class:"reminder-message"},GO={key:0},jO={class:"reminder-hint"},ZO={class:"modal-footer"},qO={__name:"CheckInReminderModal",props:{show:{type:Boolean,required:!0},checkpoint:{type:Object,default:null},accentButtonStyle:{type:Object,default:()=>({})}},emits:["dismiss","go-to-checkpoint"],setup(e){const{termsLower:t}=ut();return(o,a)=>(v(),We(gs,{name:"modal"},{default:ze(()=>[e.show&&e.checkpoint?(v(),m("div",{key:0,class:"modal-overlay",onClick:a[3]||(a[3]=rt(s=>o.$emit("dismiss"),["self"]))},[r("div",UO,[r("div",zO,[a[4]||(a[4]=r("h3",null,"Check-in reminder",-1)),r("button",{class:"modal-close",onClick:a[0]||(a[0]=s=>o.$emit("dismiss"))},"")]),r("div",HO,[a[6]||(a[6]=r("div",{class:"reminder-icon"},"",-1)),r("p",VO,[Ye(" You have not checked in yet to "+C(O(t).checkpoint)+" ",1),r("strong",null,C(e.checkpoint.location?.name),1),e.checkpoint.location?.description?(v(),m("span",GO," - "+C(e.checkpoint.location.description),1)):M("",!0),a[5]||(a[5]=Ye(". ",-1))]),r("p",jO," Please check in when you arrive at your "+C(O(t).checkpoint)+". ",1)]),r("div",ZO,[r("button",{onClick:a[1]||(a[1]=s=>o.$emit("dismiss")),class:"btn btn-secondary"}," Dismiss "),r("button",{onClick:a[2]||(a[2]=s=>o.$emit("go-to-checkpoint")),class:"btn btn-primary",style:Qe(e.accentButtonStyle)}," Go to "+C(O(t).checkpoint),5)])])])):M("",!0)]),_:1}))}},WO=je(qO,[["__scopeId","data-v-4761fdb9"]]),KO={class:"modal-content location-update-modal"},JO={class:"modal-header"},YO={class:"modal-body"},XO={key:0,class:"success-message"},QO={key:1},eB={class:"modal-description"},tB={key:0,class:"last-update-info"},nB={key:1,class:"gps-status active"},oB={class:"update-option"},sB=["disabled"],aB={class:"update-option auto-update-option"},iB={class:"checkbox-label"},lB=["checked"],rB={class:"option-hint"},cB={class:"update-option"},uB=["disabled"],dB={class:"update-option"},hB={class:"option-label"},fB={key:0,class:"checkpoint-list"},pB=["onClick","disabled"],vB={key:1,class:"no-checkpoints"},mB={key:2,class:"error"},gB={class:"modal-footer"},yB={__name:"LocationUpdateModal",props:{show:{type:Boolean,required:!0},assignment:{type:Object,default:null},userLocation:{type:Object,default:null},autoUpdateEnabled:{type:Boolean,default:!1},updating:{type:Boolean,default:!1},error:{type:String,default:""},success:{type:String,default:""},availableCheckpoints:{type:Array,default:()=>[]},accentButtonStyle:{type:Object,default:()=>({})}},emits:["close","update-gps","toggle-auto-update","select-on-map","copy-from-checkpoint"],setup(e){const{termsLower:t}=ut(),o=a=>a?new Date(a).toLocaleString():"";return(a,s)=>(v(),We(gs,{name:"modal"},{default:ze(()=>[e.show?(v(),m("div",{key:0,class:"modal-overlay",onClick:s[5]||(s[5]=rt(i=>a.$emit("close"),["self"]))},[r("div",KO,[r("div",JO,[r("h3",null,"Update "+C(O(t).checkpoint)+" location",1),r("button",{class:"modal-close",onClick:s[0]||(s[0]=i=>a.$emit("close"))},"")]),r("div",YO,[e.success?(v(),m("div",XO,C(e.success),1)):(v(),m("div",QO,[r("p",eB,[s[6]||(s[6]=Ye(" Update the position of ",-1)),r("strong",null,C(e.assignment?.location?.name),1)]),e.assignment?.location?.lastLocationUpdate?(v(),m("div",tB," Last updated: "+C(o(e.assignment.location.lastLocationUpdate)),1)):M("",!0),e.userLocation?(v(),m("div",nB,[...s[7]||(s[7]=[r("svg",{class:"status-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),Ye(" GPS active ",-1)])])):M("",!0),r("div",oB,[r("button",{onClick:s[1]||(s[1]=i=>a.$emit("update-gps")),class:"btn btn-primary btn-full",disabled:e.updating,style:Qe(e.accentButtonStyle)},[s[8]||(s[8]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),Ye(" "+C(e.updating?"Updating...":"Use current GPS location"),1)],12,sB)]),r("div",aB,[r("label",iB,[r("input",{type:"checkbox",checked:e.autoUpdateEnabled,onChange:s[2]||(s[2]=i=>a.$emit("toggle-auto-update"))},null,40,lB),s[9]||(s[9]=r("span",null,"Auto-update every 60 seconds",-1))]),r("p",rB,"Automatically updates the "+C(O(t).checkpoint)+" location using your GPS every minute.",1)]),r("div",cB,[r("button",{onClick:s[3]||(s[3]=i=>a.$emit("select-on-map")),class:"btn btn-secondary btn-full",disabled:e.updating},[...s[10]||(s[10]=[r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"})],-1),Ye(" Select location on map ",-1)])],8,uB)]),r("div",dB,[r("label",hB,"Or copy location from another "+C(O(t).checkpoint)+":",1),e.availableCheckpoints.length>0?(v(),m("div",fB,[(v(!0),m(xe,null,Ne(e.availableCheckpoints,i=>(v(),m("button",{key:i.id,onClick:l=>a.$emit("copy-from-checkpoint",i.id),class:"btn btn-secondary btn-checkpoint-source",disabled:e.updating},C(i.name),9,pB))),128))])):(v(),m("p",vB," No other "+C(O(t).checkpoints)+" available to copy from. ",1))]),e.error?(v(),m("div",mB,C(e.error),1)):M("",!0)]))]),r("div",gB,[r("button",{onClick:s[4]||(s[4]=i=>a.$emit("close")),class:"btn btn-secondary"}," Cancel ")])])])):M("",!0)]),_:1}))}},kB=je(yB,[["__scopeId","data-v-93b6a4a2"]]),_B={class:"contact-info"},bB={class:"contact-name-row"},wB={key:0,class:"primary-badge"},CB={class:"contact-name"},LB={key:0,class:"contact-notes-text"},SB={key:1,class:"contact-detail"},xB={key:2,class:"contact-detail"},IB={class:"contact-actions"},$B=["href"],TB=["href"],MB=["href"],AB={__name:"ContactCard",props:{name:{type:String,required:!0},role:{type:String,default:""},phone:{type:String,default:""},email:{type:String,default:""},notes:{type:String,default:""},isPrimary:{type:Boolean,default:!1}},setup(e){const t=e,o=["Emergency","Safety","Medical","First Aid"],a=V(()=>t.role?o.some(i=>t.role.toLowerCase().includes(i.toLowerCase())):!1),s=V(()=>t.role?t.role.replace(/([A-Z])/g," $1").replace(/^./,i=>i.toUpperCase()).trim():"");return(i,l)=>(v(),m("div",{class:de(["contact-item",{"primary-contact":e.isPrimary}])},[r("div",_B,[r("div",bB,[e.isPrimary?(v(),m("span",wB,"")):M("",!0),r("span",CB,C(e.name),1),e.role?(v(),m("span",{key:1,class:de(["contact-role-badge",{"emergency-role":a.value}])},C(s.value),3)):M("",!0)]),e.notes?(v(),m("div",LB,C(e.notes),1)):M("",!0),e.phone?(v(),m("div",SB,C(e.phone),1)):M("",!0),e.email?(v(),m("div",xB,C(e.email),1)):M("",!0)]),r("div",IB,[e.phone?(v(),m("a",{key:0,href:`tel:${e.phone}`,class:"contact-link"},[...l[0]||(l[0]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Ye(" Call ",-1)])],8,$B)):M("",!0),e.phone?(v(),m("a",{key:1,href:`sms:${e.phone}`,class:"contact-link"},[...l[1]||(l[1]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Ye(" Text ",-1)])],8,TB)):M("",!0),e.email?(v(),m("a",{key:2,href:`mailto:${e.email}`,class:"contact-link"},[...l[2]||(l[2]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Ye(" Email ",-1)])],8,MB)):M("",!0)])],2))}},tm=je(AB,[["__scopeId","data-v-6cf4fca2"]]),EB={key:0,class:"accordion-section"},PB={class:"accordion-title"},DB=["innerHTML"],RB={class:"accordion-icon"},OB={key:0,class:"accordion-content"},BB={key:0,class:"loading"},NB={key:1,class:"contact-list"},FB={__name:"MarshalContactsSection",props:{contacts:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){return(t,o)=>e.contacts.length>0||e.loading?(v(),m("div",EB,[r("button",{class:de(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=a=>t.$emit("toggle"))},[r("span",PB,[r("span",{class:"section-icon",innerHTML:O(Xn)("contacts")},null,8,DB),Ye(" Your "+C(e.contacts.length===1?"contact":"contacts")+C(e.contacts.length>1?` (${e.contacts.length})`:""),1)]),r("span",RB,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",OB,[e.loading?(v(),m("div",BB,"Loading contacts...")):(v(),m("div",NB,[(v(!0),m(xe,null,Ne(e.contacts,a=>(v(),We(tm,{key:a.contactId,name:a.name,role:a.role,phone:a.phone,email:a.email,notes:a.notes,"is-primary":a.isPrimary},null,8,["name","role","phone","email","notes","is-primary"]))),128))]))])):M("",!0)])):M("",!0)}},UB=je(FB,[["__scopeId","data-v-246302be"]]),zB={key:0,class:"accordion-section"},HB={class:"accordion-title"},VB=["innerHTML"],GB={class:"accordion-icon"},jB={key:0,class:"accordion-content"},ZB={key:0,class:"loading-state"},qB={key:1,class:"empty-state"},WB={key:2,class:"incidents-list"},KB={__name:"MarshalIncidentsSection",props:{incidents:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle","select-incident"],setup(e){return(t,o)=>e.incidents.length>0||e.loading?(v(),m("div",zB,[r("button",{class:de(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=a=>t.$emit("toggle"))},[r("span",HB,[r("span",{class:"section-icon",innerHTML:O(Xn)("incidents")},null,8,VB),Ye(" Your "+C(e.incidents.length===1?"incident":"incidents")+C(e.incidents.length>1?` (${e.incidents.length})`:""),1)]),r("span",GB,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",jB,[e.loading?(v(),m("div",ZB," Loading incidents... ")):e.incidents.length===0?(v(),m("div",qB,[...o[1]||(o[1]=[r("p",null,"No incidents to show.",-1)])])):(v(),m("div",WB,[(v(!0),m(xe,null,Ne(e.incidents,a=>(v(),We(Wl,{key:a.incidentId,incident:a,onSelect:s=>t.$emit("select-incident",a)},null,8,["incident","onSelect"]))),128))]))])):M("",!0)])):M("",!0)}},JB=je(KB,[["__scopeId","data-v-e84cbdf1"]]),YB={key:0,class:"accordion-section"},XB={class:"accordion-title"},QB=["innerHTML"],eN={class:"accordion-icon"},tN={key:0,class:"accordion-content"},nN={class:"event-details"},oN={key:0,class:"event-detail-row"},sN={class:"detail-value"},aN={key:1,class:"event-description"},iN={class:"detail-value"},lN={__name:"MarshalEventDetailsSection",props:{eventDate:{type:String,default:null},description:{type:String,default:""},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){const t=o=>o?new Date(o).toLocaleString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"}):"";return(o,a)=>e.eventDate||e.description?(v(),m("div",YB,[r("button",{class:de(["accordion-header",{active:e.isExpanded}]),onClick:a[0]||(a[0]=s=>o.$emit("toggle"))},[r("span",XB,[r("span",{class:"section-icon",innerHTML:O(Xn)("event")},null,8,QB),a[1]||(a[1]=Ye(" Event details ",-1))]),r("span",eN,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",tN,[r("div",nN,[e.eventDate?(v(),m("div",oN,[a[2]||(a[2]=r("span",{class:"detail-label"},"Date and time",-1)),r("span",sN,C(t(e.eventDate)),1)])):M("",!0),e.description?(v(),m("div",aN,[a[3]||(a[3]=r("span",{class:"detail-label"},"Description",-1)),r("p",iN,C(e.description),1)])):M("",!0)])])):M("",!0)])):M("",!0)}},rN=je(lN,[["__scopeId","data-v-7c880ad1"]]),cN={class:"accordion-section"},uN={class:"accordion-title"},dN=["innerHTML"],hN={class:"accordion-icon"},fN={key:0,class:"accordion-content"},pN={key:0,class:"loading"},vN={key:1,class:"error"},mN={key:2,class:"empty-state"},gN={class:"checklist-section"},yN={key:0,class:"empty-state small"},kN={key:1,class:"my-jobs-list"},_N=["checked","disabled","onChange"],bN={key:0,class:"checklist-section"},wN={class:"checklist-section-title"},CN={key:0,class:"checklist-items"},LN={class:"item-checkbox"},SN=["checked","disabled","onChange"],xN={class:"item-content"},IN={key:0,class:"item-context"},$N={key:1,class:"completion-info"},TN={class:"completion-text"},MN={class:"completion-time"},AN={key:1,class:"checklist-groups"},EN=["onClick"],PN={class:"group-title"},DN={class:"group-status"},RN={class:"group-count"},ON={class:"group-expand-icon"},BN={key:0,class:"checklist-group-items"},NN={class:"item-checkbox"},FN=["checked","disabled","onChange"],UN={class:"item-content"},zN={key:0,class:"completion-info"},HN={class:"completion-text"},VN={class:"completion-time"},GN={__name:"MarshalChecklistSection",props:{loading:{type:Boolean,default:!1},error:{type:String,default:""},isExpanded:{type:Boolean,default:!1},isAreaLead:{type:Boolean,default:!1},myItems:{type:Array,default:()=>[]},areaItems:{type:Array,default:()=>[]},areaItemsWithLocalState:{type:Array,default:()=>[]},visibleItems:{type:Array,default:()=>[]},groupedItems:{type:Array,default:()=>[]},completedCount:{type:Number,default:0},saving:{type:Boolean,default:!1},effectiveGroupBy:{type:String,default:"none"},expandedGroup:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},getContextName:{type:Function,default:()=>""}},emits:["toggle","toggle-item","toggle-group"],setup(e){const{termsLower:t}=ut(),o=e,a=V(()=>o.visibleItems.length),s=i=>i?new Date(i).toLocaleString():"";return(i,l)=>(v(),m("div",cN,[r("button",{class:de(["accordion-header",{active:e.isExpanded}]),onClick:l[0]||(l[0]=u=>i.$emit("toggle"))},[r("span",uN,[r("span",{class:"section-icon",innerHTML:O(Xn)("checklist")},null,8,dN),Ye(" Your "+C(O(t).checklists)+" ("+C(e.completedCount)+" of "+C(a.value)+" complete) ",1)]),r("span",hN,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",fN,[e.loading?(v(),m("div",pN,"Loading checklist...")):e.error?(v(),m("div",vN,C(e.error),1)):a.value===0?(v(),m("div",mN,[r("p",null,"No "+C(O(t).checklists)+" for you.",1)])):e.isAreaLead?(v(),m(xe,{key:3},[r("div",gN,[l[3]||(l[3]=r("h4",{class:"checklist-section-title"},"Your jobs",-1)),e.myItems.length===0?(v(),m("div",yN,[...l[2]||(l[2]=[r("p",null,"No jobs assigned to you.",-1)])])):(v(),m("div",kN,[(v(!0),m(xe,null,Ne(e.myItems,u=>(v(),m("div",{key:`${u.itemId}_${u.completionContextType}_${u.completionContextId}`,class:"my-job-item"},[r("input",{type:"checkbox",checked:u.isCompleted,disabled:e.saving,onChange:d=>i.$emit("toggle-item",u)},null,40,_N),r("span",{class:de(["my-job-text",{completed:u.isCompleted}])},C(u.text),3)]))),128))]))]),e.areaItems.length>0?(v(),m("div",bN,[r("h4",wN,"Your "+C(O(t).area)+"'s jobs",1),Ae(id,{items:e.areaItemsWithLocalState,locations:e.locations,areas:e.areas,marshals:e.marshals,onToggleComplete:l[1]||(l[1]=u=>i.$emit("toggle-item",u))},null,8,["items","locations","areas","marshals"])])):M("",!0)],64)):(v(),m(xe,{key:4},[e.effectiveGroupBy==="none"?(v(),m("div",CN,[(v(!0),m(xe,null,Ne(e.visibleItems,u=>(v(),m("div",{key:`${u.itemId}_${u.completionContextType}_${u.completionContextId}`,class:de(["checklist-item",{"item-completed":u.isCompleted}])},[r("div",LN,[r("input",{type:"checkbox",checked:u.isCompleted,disabled:!u.canBeCompletedByMe||e.saving,onChange:d=>i.$emit("toggle-item",u)},null,40,SN)]),r("div",xN,[r("div",{class:de(["item-text",{"text-completed":u.isCompleted}])},C(u.text),3),e.getContextName(u)?(v(),m("div",IN,C(e.getContextName(u)),1)):M("",!0),u.isCompleted?(v(),m("div",$N,[r("span",TN," Completed by "+C(u.completedByActorName||"Unknown"),1),r("span",MN,C(s(u.completedAt)),1)])):M("",!0)])],2))),128))])):(v(),m("div",AN,[(v(!0),m(xe,null,Ne(e.groupedItems,u=>(v(),m("div",{key:u.key,class:"checklist-group"},[r("button",{class:de(["checklist-group-header",{expanded:e.expandedGroup===u.key,"all-complete":u.completedCount===u.items.length}]),onClick:d=>i.$emit("toggle-group",u.key)},[r("span",PN,C(u.name),1),r("span",DN,[r("span",RN,C(u.completedCount)+"/"+C(u.items.length),1),r("span",ON,C(e.expandedGroup===u.key?"":"+"),1)])],10,EN),e.expandedGroup===u.key?(v(),m("div",BN,[(v(!0),m(xe,null,Ne(u.items,d=>(v(),m("div",{key:`${d.itemId}_${d.completionContextType}_${d.completionContextId}`,class:de(["checklist-item",{"item-completed":d.isCompleted}])},[r("div",NN,[r("input",{type:"checkbox",checked:d.isCompleted,disabled:!d.canBeCompletedByMe||e.saving,onChange:p=>i.$emit("toggle-item",d)},null,40,FN)]),r("div",UN,[r("div",{class:de(["item-text",{"text-completed":d.isCompleted}])},C(d.text),3),d.isCompleted?(v(),m("div",zN,[r("span",HN,C(d.completedByActorName||"Unknown"),1),r("span",VN,C(s(d.completedAt)),1)])):M("",!0)])],2))),128))])):M("",!0)]))),128))]))],64))])):M("",!0)]))}},jN=je(GN,[["__scopeId","data-v-b2878e4f"]]),ZN={class:"accordion-section"},qN={class:"accordion-title"},WN=["innerHTML"],KN={class:"accordion-icon"},JN={key:0,class:"accordion-content"},YN={__name:"MarshalNotesSection",props:{eventId:{type:String,required:!0},notes:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},isExpanded:{type:Boolean,default:!1}},emits:["toggle","notes-changed"],setup(e){return(t,o)=>(v(),m("div",ZN,[r("button",{class:de(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=a=>t.$emit("toggle"))},[r("span",qN,[r("span",{class:"section-icon",innerHTML:O(Xn)("notes")},null,8,WN),Ye(" Your "+C(e.notes.length===1?"note":"notes")+C(e.notes.length>1?` (${e.notes.length})`:""),1)]),r("span",KN,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",JN,[Ae(gc,{"event-id":e.eventId,"all-notes":e.notes,locations:e.locations,areas:e.areas,assignments:e.assignments,"show-scope":!1,onNotesChanged:o[1]||(o[1]=a=>t.$emit("notes-changed"))},null,8,["event-id","all-notes","locations","areas","assignments"])])):M("",!0)]))}},XN=je(YN,[["__scopeId","data-v-10b7523a"]]),QN={class:"accordion-section"},e9={class:"accordion-title"},t9=["innerHTML"],n9={key:0,class:"location-status active"},o9={key:1,class:"location-status"},s9={class:"accordion-icon"},a9={key:0,class:"accordion-content map-content"},i9={key:0,class:"map-selection-banner"},l9={class:"map-wrapper"},r9={__name:"MarshalRouteSection",props:{isExpanded:{type:Boolean,default:!1},userLocation:{type:Object,default:null},selectingLocation:{type:Boolean,default:!1},selectingLocationName:{type:String,default:""},locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},highlightLocationIds:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]}},emits:["toggle","cancel-select","map-click","location-click","action-click","visibility-change"],setup(e,{expose:t}){const{terms:o}=ut(),a=lo("marshalBranding",{headerStyle:{},headerTextColor:""}),s=ii({headerStyle:V(()=>Sr(a.headerStyle)),headerTextColor:V(()=>Sr(a.headerTextColor))}),i=$(null);return t({mapRef:i,recenterOnLocation:(l,u,d)=>i.value?.recenterOnLocation?.(l,u,d),recenterOnUserLocation:()=>i.value?.recenterOnUserLocation?.()}),(l,u)=>(v(),m("div",QN,[r("button",{class:de(["accordion-header",{active:e.isExpanded}]),onClick:u[0]||(u[0]=d=>l.$emit("toggle"))},[r("span",e9,[r("span",{class:"section-icon",innerHTML:O(Xn)("course")},null,8,t9),Ye(" "+C(O(o).course)+" ",1),e.userLocation?(v(),m("span",n9,"GPS Active")):(v(),m("span",o9,"GPS Inactive"))]),r("span",s9,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",a9,[e.selectingLocation?(v(),m("div",i9,[r("span",null,[u[7]||(u[7]=Ye("Click on the map to set the new location for ",-1)),r("strong",null,C(e.selectingLocationName),1)]),r("button",{onClick:u[1]||(u[1]=d=>l.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")])):M("",!0),r("div",l9,[Ae(li,{ref_key:"mapRef",ref:i,locations:e.locations,route:e.route,center:e.center,zoom:15,"user-location":e.userLocation,"highlight-location-ids":e.highlightLocationIds,"marshal-mode":!0,clickable:e.clickable,"show-fullscreen":!0,"fullscreen-title":O(o).course,"fullscreen-header-style":s.headerStyle,"fullscreen-header-text-color":s.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,class:de({"selecting-location":e.selectingLocation}),height:"100%",onMapClick:u[3]||(u[3]=d=>l.$emit("map-click",d)),onLocationClick:u[4]||(u[4]=d=>l.$emit("location-click",d)),onActionClick:u[5]||(u[5]=d=>l.$emit("action-click",d)),onVisibilityChange:u[6]||(u[6]=d=>l.$emit("visibility-change",d))},vp({_:2},[e.selectingLocation?{name:"fullscreen-banner",fn:ze(()=>[r("span",null,[u[8]||(u[8]=Ye("Click on the map to set the new location for ",-1)),r("strong",null,C(e.selectingLocationName),1)]),r("button",{onClick:u[2]||(u[2]=d=>l.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")]),key:"0"}:void 0]),1032,["locations","route","center","user-location","highlight-location-ids","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions","class"])])])):M("",!0)]))}},c9=je(r9,[["__scopeId","data-v-97a9b1f4"]]),u9={class:"area-lead-content"},d9={key:0,class:"loading-state"},h9={key:1,class:"error-state"},f9={key:2,class:"empty-state"},p9={key:3,class:"checkpoint-accordion"},v9=["onClick"],m9={class:"checkpoint-header-content"},g9={class:"checkpoint-title-row"},y9={class:"checkpoint-name"},k9={key:0,class:"area-badge"},_9={key:0,class:"checkpoint-description-preview"},b9={class:"checkpoint-status-row"},w9={class:"status-badge marshals-status"},C9={key:0,class:"status-badge tasks-status"},L9={class:"accordion-icon"},S9={key:0,class:"checkpoint-accordion-content"},x9={class:"checkpoint-mini-map"},I9={class:"checkpoint-marshals-section"},$9={class:"marshals-label"},T9={key:0,class:"empty-state"},M9={key:1,class:"marshals-list"},A9=["onClick"],E9={class:"marshal-header"},P9={class:"marshal-name-row"},D9={class:"marshal-name"},R9={key:0,class:"task-count"},O9={class:"check-status-row"},B9=["onClick","disabled"],N9={key:0,class:"check-in-time"},F9={key:0},U9={key:1,class:"last-access-time"},z9={key:0,class:"checkpoint-tasks-section"},H9={class:"marshals-label"},V9={class:"tasks-list"},G9=["disabled","onChange"],j9={class:"task-text"},Z9=["disabled","onChange"],q9={class:"task-text"},W9={key:0,class:"marshal-details-modal"},K9={class:"details-section"},J9={class:"contact-info"},Y9={key:0,class:"contact-row"},X9=["href"],Q9={key:1,class:"contact-row"},eF=["href"],tF={key:2,class:"no-contact"},nF={class:"details-section"},oF={key:0,class:"checked-in-section"},sF={class:"checked-in-details"},aF={class:"check-time-detail"},iF={key:0,class:"check-method"},lF=["disabled"],rF={key:1,class:"not-checked-in-section"},cF=["disabled"],uF={key:2,class:"last-access-detail"},dF={class:"details-section"},hF={key:0,class:"no-tasks"},fF={key:1,class:"tasks-list modal-tasks"},pF=["disabled","onChange"],vF={class:"task-text"},mF={class:"details-section contact-actions-section"},gF={class:"contact-buttons"},yF=["href"],kF=["href"],_F=["href"],bF={__name:"AreaLeadSection",props:{eventId:{type:String,required:!0},areaIds:{type:Array,default:()=>[]},marshalId:{type:String,required:!0},route:{type:Array,default:()=>[]}},emits:["checklist-updated","loaded","checkin-updated"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:s}=ut(),{updatePendingCount:i}=rd(),l=e,u=o,d=$(!1),p=$(null),f=$([]),g=$([]),y=$(null),_=$(!1),k=$(null),w=V(()=>{const U=new Set(l.areaIds);return U.size===0?[...g.value].sort((ee,fe)=>Vs(ee.name,fe.name)):g.value.filter(ee=>(ee.areaIds||[]).some(ue=>U.has(ue))).sort((ee,fe)=>Vs(ee.name,fe.name))}),S=(U,ee=60)=>U?U.length<=ee?U:U.substring(0,ee).trim()+"...":"",E=$(!1),A=$(null),x=$(null),D=async()=>{if(!(!l.eventId||l.areaIds.length===0)){if(d.value=!0,p.value=null,Pn()){try{const U=await wa(l.eventId);if(U?.areaLeadDashboard){f.value=U.areaLeadDashboard.areas||[],g.value=U.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(U){console.warn("Failed to load cached dashboard:",U)}p.value="Offline - no cached data available",d.value=!1;return}try{const U=await ka.getAreaLeadDashboard(l.eventId);f.value=U.data.areas||[],g.value=U.data.checkpoints||[];try{const ee=JSON.parse(JSON.stringify({areas:f.value,checkpoints:g.value}));await wa(l.eventId)?await wr(l.eventId,"areaLeadDashboard",ee):await Ol(l.eventId,{areaLeadDashboard:ee})}catch(ee){console.warn("Failed to cache dashboard:",ee)}}catch(U){console.error("Failed to load area lead dashboard:",U);try{const ee=await wa(l.eventId);if(ee?.areaLeadDashboard){console.log("Loading area lead dashboard from cache after error"),f.value=ee.areaLeadDashboard.areas||[],g.value=ee.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(ee){console.warn("Failed to load cached dashboard:",ee)}p.value=U.response?.data?.message||"Failed to load dashboard"}finally{d.value=!1}}},R=U=>{y.value=y.value===U?null:U},F=U=>U.marshals.filter(ee=>ee.isCheckedIn).length,T=U=>{const ee=U.marshals.reduce((fe,ue)=>fe+ue.outstandingTaskCount,0);return U.outstandingTaskCount+ee},N=(U,ee)=>{A.value=U,x.value=ee,E.value=!0},B=()=>{E.value=!1,A.value=null,x.value=null},q=async(U,ee)=>{if(k.value)return;const fe=U.assignmentId||U.id;if(!fe){console.error("No assignment ID found for marshal:",U);return}k.value=U.marshalId;try{if(Pn())await ko("checkin_toggle",{eventId:l.eventId,assignmentId:fe}),U.isCheckedIn=!0,U.checkInTime=new Date().toISOString(),U.checkInMethod="AreaLead (pending)",await i(),u("checkin-updated");else if(await Ca.toggleCheckIn(l.eventId,fe),await D(),u("checkin-updated"),A.value?.marshalId===U.marshalId&&x.value){const ue=g.value.find(De=>De.checkpointId===x.value.checkpointId);if(ue){const De=ue.marshals.find(et=>et.marshalId===U.marshalId);De&&(A.value=De)}}}catch(ue){console.error("Failed to check in marshal:",ue),(Pn()||!ue.response)&&(await ko("checkin_toggle",{eventId:l.eventId,assignmentId:fe}),U.isCheckedIn=!0,U.checkInTime=new Date().toISOString(),U.checkInMethod="AreaLead (pending)",await i(),u("checkin-updated"))}finally{k.value=null}},P=async(U,ee)=>{if(_.value)return;_.value=!0;const ue={marshalId:ee.marshals.length>0?ee.marshals[0].marshalId:l.marshalId,contextType:U.contextType,contextId:U.contextId};try{Pn()?(await ko("checklist_complete",{eventId:l.eventId,itemId:U.itemId,data:ue}),ee.outstandingTasks=ee.outstandingTasks.filter(De=>De.itemId!==U.itemId),ee.outstandingTaskCount=Math.max(0,ee.outstandingTaskCount-1),await i(),u("checklist-updated")):(await Rt.complete(l.eventId,U.itemId,ue),await D(),u("checklist-updated"))}catch(De){console.error("Failed to complete task:",De),(Pn()||!De.response)&&(await ko("checklist_complete",{eventId:l.eventId,itemId:U.itemId,data:ue}),ee.outstandingTasks=ee.outstandingTasks.filter(et=>et.itemId!==U.itemId),ee.outstandingTaskCount=Math.max(0,ee.outstandingTaskCount-1),await i(),u("checklist-updated"))}finally{_.value=!1}},G=async(U,ee)=>{if(_.value)return;_.value=!0;const ue={marshalId:ee.marshals.length>0?ee.marshals[0].marshalId:l.marshalId,contextType:U.contextType,contextId:U.contextId,actorMarshalId:l.marshalId};try{Pn()?(await ko("checklist_uncomplete",{eventId:l.eventId,itemId:U.itemId,data:ue}),ee.completedTasks&&(ee.completedTasks=ee.completedTasks.filter(De=>De.itemId!==U.itemId)),ee.outstandingTasks||(ee.outstandingTasks=[]),ee.outstandingTasks.push(U),ee.outstandingTaskCount=(ee.outstandingTaskCount||0)+1,await i(),u("checklist-updated")):(await Rt.uncomplete(l.eventId,U.itemId,ue),await D(),u("checklist-updated"))}catch(De){console.error("Failed to uncomplete task:",De),(Pn()||!De.response)&&(await ko("checklist_uncomplete",{eventId:l.eventId,itemId:U.itemId,data:ue}),ee.completedTasks&&(ee.completedTasks=ee.completedTasks.filter(et=>et.itemId!==U.itemId)),ee.outstandingTasks||(ee.outstandingTasks=[]),ee.outstandingTasks.push(U),ee.outstandingTaskCount=(ee.outstandingTaskCount||0)+1,await i(),u("checklist-updated"))}finally{_.value=!1}},X=async U=>{if(_.value||!A.value)return;_.value=!0;const ee={marshalId:A.value.marshalId,contextType:U.contextType,contextId:U.contextId};try{if(Pn())await ko("checklist_complete",{eventId:l.eventId,itemId:U.itemId,data:ee}),A.value.outstandingTasks=A.value.outstandingTasks.filter(fe=>fe.itemId!==U.itemId),A.value.outstandingTaskCount=Math.max(0,A.value.outstandingTaskCount-1),await i(),u("checklist-updated");else{if(await Rt.complete(l.eventId,U.itemId,ee),await D(),A.value&&x.value){const fe=g.value.find(ue=>ue.checkpointId===x.value.checkpointId);if(fe){const ue=fe.marshals.find(De=>De.marshalId===A.value.marshalId);ue&&(A.value=ue)}}u("checklist-updated")}}catch(fe){console.error("Failed to complete task:",fe),(Pn()||!fe.response)&&(await ko("checklist_complete",{eventId:l.eventId,itemId:U.itemId,data:ee}),A.value.outstandingTasks=A.value.outstandingTasks.filter(ue=>ue.itemId!==U.itemId),A.value.outstandingTaskCount=Math.max(0,A.value.outstandingTaskCount-1),await i(),u("checklist-updated"))}finally{_.value=!1}},ne=U=>U?new Date(U).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",K=U=>U?new Date(U).toLocaleString():"",Q=U=>{if(!U)return"";const ee=new Date(U),ue=new Date-ee,De=Math.floor(ue/6e4),et=Math.floor(De/60),Je=Math.floor(et/24);return De<1?"just now":De<60?`${De}m ago`:et<24?`${et}h ago`:Je===1?"yesterday":Je<7?`${Je}d ago`:ee.toLocaleDateString()},he=U=>({GPS:"GPS",Manual:"Manual",Admin:"Admin",AreaLead:`${a.value.area} Lead`})[U]||U;return t({areas:f,checkpoints:g,loading:d,loadDashboard:D}),qe(()=>l.eventId,()=>{D()},{immediate:!0}),(U,ee)=>(v(),m("div",u9,[d.value?(v(),m("div",d9," Loading dashboard... ")):p.value?(v(),m("div",h9,[r("p",null,C(p.value),1),r("button",{onClick:D,class:"btn btn-secondary"},"Retry")])):w.value.length===0?(v(),m("div",f9,[r("p",null,"No "+C(O(s).checkpoints)+" in your "+C(O(s).areas)+".",1)])):(v(),m("div",p9,[(v(!0),m(xe,null,Ne(w.value,fe=>(v(),m("div",{key:fe.checkpointId,class:"checkpoint-accordion-section"},[r("button",{class:de(["checkpoint-accordion-header",{active:y.value===fe.checkpointId}]),onClick:ue=>R(fe.checkpointId)},[r("div",m9,[r("div",g9,[r("span",y9,C(fe.name),1),fe.areaName?(v(),m("span",k9,C(fe.areaName),1)):M("",!0)]),fe.description?(v(),m("div",_9,C(S(fe.description)),1)):M("",!0),r("div",b9,[r("span",w9,C(F(fe))+" / "+C(fe.marshals.length)+" checked in ",1),T(fe)>0?(v(),m("span",C9,C(T(fe))+" tasks ",1)):M("",!0)])]),r("span",L9,C(y.value===fe.checkpointId?"":"+"),1)],10,v9),y.value===fe.checkpointId?(v(),m("div",S9,[r("div",x9,[Ae(li,{locations:[{id:fe.checkpointId,name:fe.name,description:fe.description,latitude:fe.latitude,longitude:fe.longitude}],route:e.route,center:{lat:fe.latitude,lng:fe.longitude},zoom:16,"highlight-location-id":fe.checkpointId,"marshal-mode":!0,height:"280px"},null,8,["locations","route","center","highlight-location-id"])]),r("div",I9,[r("div",$9,C(O(a).people)+" ("+C(fe.marshals.length)+")",1),fe.marshals.length===0?(v(),m("div",T9," No "+C(O(s).people)+" assigned to this "+C(O(s).checkpoint)+". ",1)):(v(),m("div",M9,[(v(!0),m(xe,null,Ne(fe.marshals,ue=>(v(),m("div",{key:ue.marshalId,class:de(["marshal-card",{"is-checked-in":ue.isCheckedIn}]),onClick:De=>N(ue,fe)},[r("div",E9,[r("div",P9,[r("span",D9,C(ue.name),1),ue.outstandingTaskCount>0?(v(),m("span",R9,C(ue.outstandingTaskCount)+" tasks ",1)):M("",!0)]),r("div",O9,[r("div",{class:de(["check-status",{"checked-in":ue.isCheckedIn}])},C(ue.isCheckedIn?" Checked In":"Not Checked In"),3),r("button",{onClick:rt(De=>q(ue),["stop"]),class:de(["quick-checkin-btn",{"undo-btn":ue.isCheckedIn}]),disabled:k.value===ue.marshalId},C(k.value===ue.marshalId?"...":ue.isCheckedIn?"Undo":"Check In"),11,B9)])]),ue.isCheckedIn&&ue.checkInTime?(v(),m("div",N9,[Ye(C(ne(ue.checkInTime))+" ",1),ue.checkInMethod?(v(),m("span",F9," ("+C(he(ue.checkInMethod))+")",1)):M("",!0)])):M("",!0),ue.lastAccessedAt?(v(),m("div",U9," Last active: "+C(Q(ue.lastAccessedAt)),1)):M("",!0)],10,A9))),128))]))]),fe.outstandingTaskCount>0||fe.completedTasks&&fe.completedTasks.length>0?(v(),m("div",z9,[r("div",H9,C(O(a).checkpoint)+" tasks",1),r("div",V9,[(v(!0),m(xe,null,Ne(fe.outstandingTasks,ue=>(v(),m("div",{key:ue.itemId,class:"task-item"},[r("input",{type:"checkbox",disabled:_.value,onChange:De=>P(ue,fe)},null,40,G9),r("span",j9,C(ue.text),1)]))),128)),(v(!0),m(xe,null,Ne(fe.completedTasks||[],ue=>(v(),m("div",{key:`completed-${ue.itemId}`,class:"task-item task-completed"},[r("input",{type:"checkbox",checked:"",disabled:_.value,onChange:De=>G(ue,fe)},null,40,Z9),r("span",q9,C(ue.text),1)]))),128))])])):M("",!0)])):M("",!0)]))),128))])),Ae(Gt,{show:E.value,title:A.value?.name||"Marshal Details",size:"large",onClose:B},{actions:ze(()=>[r("button",{onClick:B,class:"btn btn-secondary"},"Close")]),default:ze(()=>[A.value?(v(),m("div",W9,[r("div",K9,[ee[4]||(ee[4]=r("h4",null,"Contact Details",-1)),r("div",J9,[A.value.email?(v(),m("div",Y9,[ee[2]||(ee[2]=r("span",{class:"contact-label"},"Email:",-1)),r("a",{href:`mailto:${A.value.email}`},C(A.value.email),9,X9)])):M("",!0),A.value.phoneNumber?(v(),m("div",Q9,[ee[3]||(ee[3]=r("span",{class:"contact-label"},"Phone:",-1)),r("a",{href:`tel:${A.value.phoneNumber}`},C(A.value.phoneNumber),9,eF)])):M("",!0),!A.value.email&&!A.value.phoneNumber?(v(),m("div",tF," No contact details available. ")):M("",!0)])]),r("div",nF,[ee[8]||(ee[8]=r("h4",null,"Check-in Status",-1)),A.value.isCheckedIn?(v(),m("div",oF,[r("div",sF,[ee[6]||(ee[6]=r("span",{class:"check-icon"},"",-1)),r("div",null,[ee[5]||(ee[5]=r("strong",null,"Checked In",-1)),r("p",aF,C(K(A.value.checkInTime)),1),A.value.checkInMethod?(v(),m("p",iF," Method: "+C(he(A.value.checkInMethod)),1)):M("",!0)])]),r("button",{onClick:ee[0]||(ee[0]=fe=>q(A.value,x.value)),class:"btn btn-secondary undo-checkin-btn",disabled:k.value===A.value.marshalId},C(k.value===A.value.marshalId?"Undoing...":"Undo Check-in"),9,lF)])):(v(),m("div",rF,[ee[7]||(ee[7]=r("div",{class:"not-checked-in"},[r("span",{class:"not-checked-icon"},""),r("span",null,"Not checked in")],-1)),r("button",{onClick:ee[1]||(ee[1]=fe=>q(A.value,x.value)),class:"btn btn-primary check-in-btn",disabled:k.value===A.value.marshalId},C(k.value===A.value.marshalId?"Checking in...":"Check In"),9,cF)])),A.value.lastAccessedAt?(v(),m("div",uF," Last active: "+C(Q(A.value.lastAccessedAt)),1)):M("",!0)]),r("div",dF,[r("h4",null,C(O(a).checklists)+" ("+C(A.value.outstandingTasks?.length||0)+" outstanding)",1),!A.value.outstandingTasks||A.value.outstandingTasks.length===0?(v(),m("div",hF," No outstanding tasks. ")):(v(),m("div",fF,[(v(!0),m(xe,null,Ne(A.value.outstandingTasks,fe=>(v(),m("div",{key:fe.itemId,class:"task-item"},[r("input",{type:"checkbox",disabled:_.value,onChange:ue=>X(fe)},null,40,pF),r("span",vF,C(fe.text),1)]))),128))]))]),r("div",mF,[r("div",gF,[A.value.phoneNumber?(v(),m("a",{key:0,href:`tel:${A.value.phoneNumber}`,class:"btn btn-primary"}," Call ",8,yF)):M("",!0),A.value.phoneNumber?(v(),m("a",{key:1,href:`sms:${A.value.phoneNumber}`,class:"btn btn-secondary"}," Text ",8,kF)):M("",!0),A.value.email?(v(),m("a",{key:2,href:`mailto:${A.value.email}`,class:"btn btn-secondary"}," Email ",8,_F)):M("",!0)])])])):M("",!0)]),_:1},8,["show","title"])]))}},wF=je(bF,[["__scopeId","data-v-067e0528"]]),CF={key:0,class:"accordion-section"},LF={class:"accordion-title"},SF=["innerHTML"],xF={class:"accordion-icon"},IF={key:0,class:"accordion-content area-lead-accordion-content"},$F={key:0,class:"area-filter-pills"},TF=["onClick"],MF={__name:"MarshalAreaLeadSection",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedFilters:{type:Set,default:()=>new Set},filteredAreaIds:{type:Array,default:()=>[]},eventId:{type:String,required:!0},marshalId:{type:String,default:""},route:{type:Array,default:()=>[]}},emits:["toggle","toggle-filter","checklist-updated"],setup(e,{expose:t}){const{termsLower:o}=ut(),a=$(null);return t({areaLeadRef:a}),(s,i)=>e.isAreaLead?(v(),m("div",CF,[r("button",{class:de(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=l=>s.$emit("toggle"))},[r("span",LF,[r("span",{class:"section-icon",innerHTML:O(Xn)("area")},null,8,SF),Ye(" Your "+C(e.areas.length===1?O(o).area:O(o).areas)+C(e.areas.length>1?` (${e.areas.length})`:""),1)]),r("span",xF,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",IF,[e.areas.length>1?(v(),m("div",$F,[(v(!0),m(xe,null,Ne(e.areas,l=>(v(),m("button",{key:l.areaId,class:de(["area-filter-pill",{selected:e.selectedFilters.has(l.areaId)}]),style:Qe(e.selectedFilters.has(l.areaId)?{backgroundColor:l.color||"#667eea",borderColor:l.color||"#667eea"}:{}),onClick:u=>s.$emit("toggle-filter",l.areaId)},C(l.name),15,TF))),128))])):M("",!0),Ae(wF,{ref_key:"areaLeadRef",ref:a,"event-id":e.eventId,"area-ids":e.filteredAreaIds,"marshal-id":e.marshalId,route:e.route,onChecklistUpdated:i[1]||(i[1]=l=>s.$emit("checklist-updated"))},null,8,["event-id","area-ids","marshal-id","route"])])):M("",!0)])):M("",!0)}},AF=je(MF,[["__scopeId","data-v-9278e6a8"]]),EF={key:0,class:"accordion-section"},PF={class:"accordion-title"},DF=["innerHTML"],RF={class:"accordion-icon"},OF={key:0,class:"accordion-content area-lead-marshals-content"},BF={class:"area-lead-marshals-list"},NF=["onClick"],FF={class:"marshal-header-info"},UF={class:"marshal-name-row"},zF={class:"marshal-name"},HF={class:"marshal-meta"},VF={class:"marshal-checkpoint"},GF={key:0,class:"marshal-task-count"},jF={class:"accordion-icon"},ZF={key:0,class:"area-lead-marshal-content"},qF={class:"marshal-checkin-section"},WF={key:0,class:"marshal-contact-section"},KF=["href"],JF=["href"],YF={key:1,class:"marshal-tasks-section"},XF={class:"tasks-label"},QF={class:"tasks-list"},e7=["checked","disabled","onChange"],t7={class:"task-text"},n7={key:2,class:"no-tasks-message"},o7={__name:"MarshalMarshalsList",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},marshals:{type:Array,default:()=>[]},expandedMarshalId:{type:String,default:null},checkingInMarshalId:{type:String,default:null},savingTask:{type:Boolean,default:!1}},emits:["toggle","toggle-marshal","check-in","toggle-task"],setup(e){const{terms:t,termsLower:o}=ut(),a=s=>!s||s.length===0?"":s.length===1?s[0].name:s.map(i=>i.name).join(", ");return(s,i)=>e.isAreaLead&&e.marshals.length>0?(v(),m("div",EF,[r("button",{class:de(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=l=>s.$emit("toggle"))},[r("span",PF,[r("span",{class:"section-icon",innerHTML:O(Xn)("marshal")},null,8,DF),Ye(" Your "+C(e.marshals.length===1?O(o).person:O(o).people)+C(e.marshals.length>1?` (${e.marshals.length})`:""),1)]),r("span",RF,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",OF,[r("div",BF,[(v(!0),m(xe,null,Ne(e.marshals,l=>(v(),m("div",{key:l.marshalId,class:"area-lead-marshal-item"},[r("button",{class:de(["area-lead-marshal-header",{active:e.expandedMarshalId===l.marshalId,"is-checked-in":l.isCheckedIn}]),onClick:u=>s.$emit("toggle-marshal",l.marshalId)},[r("div",FF,[r("div",UF,[r("span",zF,C(l.name),1),r("span",{class:de(["check-status-badge",{"checked-in":l.isCheckedIn}])},C(l.isCheckedIn?"":""),3)]),r("div",HF,[r("span",VF,C(a(l.checkpoints)),1),l.totalTaskCount>0?(v(),m("span",GF,C(l.completedTaskCount)+" / "+C(l.totalTaskCount)+" "+C(O(o).checklists)+" complete ",1)):M("",!0)])]),r("span",jF,C(e.expandedMarshalId===l.marshalId?"":"+"),1)],10,NF),e.expandedMarshalId===l.marshalId?(v(),m("div",ZF,[r("div",qF,[Ae(Vr,{"is-checked-in":l.isCheckedIn,"check-in-time":l.checkInTime,"check-in-method":l.checkInMethod,"checked-in-by":l.checkedInBy,"marshal-name":l.marshalName,"is-loading":e.checkingInMarshalId===l.id,onToggle:u=>s.$emit("check-in",l)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"])]),l.email||l.phoneNumber?(v(),m("div",WF,[l.phoneNumber?(v(),m("a",{key:0,href:`tel:${l.phoneNumber}`,class:"contact-link"},C(l.phoneNumber),9,KF)):M("",!0),l.email?(v(),m("a",{key:1,href:`mailto:${l.email}`,class:"contact-link"},C(l.email),9,JF)):M("",!0)])):M("",!0),l.allTasks.length>0?(v(),m("div",YF,[r("div",XF,C(O(t).checklists),1),r("div",QF,[(v(!0),m(xe,null,Ne(l.allTasks,u=>(v(),m("div",{key:`${u.itemId}-${u.contextId}`,class:de(["task-item",{"task-completed":u.isCompleted}])},[r("input",{type:"checkbox",checked:u.isCompleted,disabled:e.savingTask,onChange:d=>s.$emit("toggle-task",u,l)},null,40,e7),r("span",t7,C(u.text),1)],2))),128))])])):(v(),m("div",n7," No "+C(O(o).checklists)+" assigned. ",1))])):M("",!0)]))),128))])])):M("",!0)])):M("",!0)}},s7=je(o7,[["__scopeId","data-v-49a1421b"]]),a7={class:"checkpoint-note-header"},i7={key:0,class:"pin-icon",title:"Pinned"},l7={class:"checkpoint-note-title"},r7={key:0,class:"checkpoint-note-content"},c7={__name:"NoteCard",props:{title:{type:String,required:!0},content:{type:String,default:""},priority:{type:String,default:"Normal"},isPinned:{type:Boolean,default:!1}},setup(e){const t=e,o=V(()=>(t.priority||"Normal").toLowerCase());return(a,s)=>(v(),m("div",{class:de(["checkpoint-note-item",o.value])},[r("div",a7,[e.isPinned?(v(),m("span",i7,"")):M("",!0),r("span",{class:de(["priority-indicator",o.value])},null,2),r("strong",l7,C(e.title),1),r("span",{class:de(["priority-badge",o.value])},C(e.priority),3)]),e.content?(v(),m("div",r7,C(e.content),1)):M("",!0)],2))}},u7=je(c7,[["__scopeId","data-v-5f2df920"]]),d7={class:"checkpoint-accordion-section"},h7={class:"checkpoint-header-content"},f7={class:"checkpoint-title-row"},p7=["innerHTML"],v7={key:0,class:"checkpoint-check-icon"},m7={class:"checkpoint-name"},g7={key:1,class:"area-badge"},y7={key:2,class:"checkpoint-time-badge"},k7={key:0,class:"checkpoint-description-preview"},_7={class:"accordion-icon"},b7={key:0,class:"checkpoint-accordion-content"},w7={key:0,class:"checkpoint-mini-map"},C7={viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",style:{"margin-right":"0.5rem"}},L7={class:"my-checkin-section"},S7={key:0,class:"check-in-error"},x7={class:"checkpoint-marshals"},I7={class:"marshals-label"},$7={key:0,class:"marshals-list"},T7={key:0,class:"check-badge"},M7={key:1,class:"marshals-list-expanded"},A7=["onClick"],E7={class:"marshal-name-text"},P7={class:"marshal-status-icons"},D7={key:0,class:"check-badge"},R7={class:"expand-icon"},O7={key:0,class:"marshal-details-panel"},B7={class:"detail-row"},N7={key:0,class:"detail-row"},F7={key:1,class:"detail-row"},U7={key:2,class:"detail-row"},z7=["href"],H7={key:3,class:"detail-row"},V7=["href"],G7={key:4,class:"contact-buttons-mini"},j7=["href"],Z7=["href"],q7=["href"],W7={key:5,class:"checkpoint-marshal-checkin"},K7={key:1,class:"checkpoint-area-contacts"},J7={class:"marshals-label"},Y7={class:"contact-list"},X7={key:2,class:"checkpoint-notes"},Q7={class:"checkpoint-notes-list"},eU={key:3,class:"dynamic-location-section"},tU={class:"dynamic-location-header"},nU={class:"dynamic-badge"},oU={key:0,class:"last-update"},sU={class:"dynamic-location-actions"},aU=["disabled"],iU=["title"],lU={__name:"CheckpointCard",props:{assignment:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},userLocation:{type:Object,default:null},toolbarActions:{type:Array,default:()=>[]},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},isCheckingIn:{type:Boolean,default:!1},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},isAreaLeadForCheckpoint:{type:Boolean,default:!1},expandedMarshalId:{type:String,default:null},notes:{type:Array,default:()=>[]},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1}},emits:["toggle","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update"],setup(e,{expose:t}){const{terms:o,termsLower:a}=ut(),s=lo("marshalBranding",{headerStyle:{},headerTextColor:""}),i=ii({headerStyle:V(()=>Sr(s.headerStyle)),headerTextColor:V(()=>Sr(s.headerTextColor))}),l=e,u=$(null),d=V(()=>l.assignment.location?.isDynamic);t({mapRef:u});const p=k=>{const w=k?.iconType||"checkpoint",S=k?.iconColor||"#667eea",E={checkpoint:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>`,flag:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"/></svg>`,star:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>`,water:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M12 2c-5.33 4.55-8 8.48-8 11.8 0 4.98 3.8 8.2 8 8.2s8-3.22 8-8.2c0-3.32-2.67-7.25-8-11.8z"/></svg>`,medical:`<svg viewBox="0 0 24 24" fill="${S}" width="20" height="20"><path d="M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4v4z"/></svg>`};return E[w]||E.checkpoint},f=(k,w)=>{const S=E=>E?new Date(E).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"";return k&&w?`${S(k)} - ${S(w)}`:k?`from ${S(k)}`:w?`until ${S(w)}`:""},g=k=>k?new Date(k).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"",y=k=>({manual:"Manual",qr:"QR Code",gps:"GPS",admin:"Admin"})[k]||k,_=k=>k?new Date(k).toLocaleString():"";return(k,w)=>(v(),m("div",d7,[r("button",{class:de(["checkpoint-accordion-header",{active:e.isExpanded,"checked-in":e.assignment.effectiveIsCheckedIn}]),onClick:w[0]||(w[0]=S=>k.$emit("toggle"))},[r("div",h7,[r("div",f7,[r("span",{class:"checkpoint-icon",innerHTML:p(e.assignment.location)},null,8,p7),e.assignment.effectiveIsCheckedIn?(v(),m("span",v7,"")):M("",!0),r("span",m7,C(e.assignment.location?.name||e.assignment.locationName),1),e.assignment.areaName?(v(),m("span",g7,C(e.assignment.areaName),1)):M("",!0),e.assignment.location?.startTime||e.assignment.location?.endTime?(v(),m("span",y7,C(f(e.assignment.location.startTime,e.assignment.location.endTime)),1)):M("",!0)]),e.assignment.location?.description?(v(),m("div",k7,C(e.assignment.location.description),1)):M("",!0)]),r("span",_7,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",b7,[e.assignment.location?(v(),m("div",w7,[Ae(li,{ref_key:"mapRef",ref:u,locations:e.allLocations,route:e.route,center:{lat:e.assignment.location.latitude,lng:e.assignment.location.longitude},zoom:16,"user-location":e.userLocation,"highlight-location-id":e.assignment.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:e.hasDynamicAssignment,"show-fullscreen":!0,"fullscreen-title":e.assignment.location?.name||e.assignment.locationName,"fullscreen-header-style":i.headerStyle,"fullscreen-header-text-color":i.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,height:"280px",onMapClick:w[2]||(w[2]=S=>k.$emit("map-click",S)),onLocationClick:w[3]||(w[3]=S=>k.$emit("location-click",S)),onActionClick:w[4]||(w[4]=S=>k.$emit("action-click",S)),onVisibilityChange:w[5]||(w[5]=S=>k.$emit("visibility-change",S))},vp({_:2},[e.assignment.location?.isDynamic?{name:"fullscreen-footer",fn:ze(()=>[r("button",{class:"btn btn-primary",onClick:w[1]||(w[1]=S=>k.$emit("update-location"))},[(v(),m("svg",C7,[...w[9]||(w[9]=[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"},null,-1)])])),w[10]||(w[10]=Ye(" Update location ",-1))])]),key:"0"}:void 0]),1032,["locations","route","center","user-location","highlight-location-id","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions"])])):M("",!0),r("div",L7,[Ae(Vr,{"is-checked-in":e.assignment.effectiveIsCheckedIn,"check-in-time":e.assignment.checkInTime,"check-in-method":e.assignment.checkInMethod,"checked-in-by":e.assignment.checkedInBy,"marshal-name":e.currentMarshalName,"is-loading":e.isCheckingIn,onToggle:w[6]||(w[6]=S=>k.$emit("check-in"))},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading"]),e.checkInError?(v(),m("div",S7,C(e.checkInError),1)):M("",!0)]),r("div",x7,[r("div",I7,C(O(o).people)+":",1),e.isAreaLeadForCheckpoint?(v(),m("div",M7,[(v(!0),m(xe,null,Ne(e.assignment.allMarshals,S=>(v(),m("div",{key:S.marshalId,class:de(["marshal-card-mini",{"is-you":S.marshalId===e.currentMarshalId,"checked-in":S.effectiveIsCheckedIn,expanded:e.expandedMarshalId===S.marshalId}])},[r("button",{class:"marshal-card-header",onClick:E=>k.$emit("toggle-marshal",S.marshalId)},[r("span",E7,C(S.marshalName)+C(S.marshalId===e.currentMarshalId?" (you)":""),1),r("span",P7,[S.effectiveIsCheckedIn?(v(),m("span",D7,"")):M("",!0),r("span",R7,C(e.expandedMarshalId===S.marshalId?"":"+"),1)])],8,A7),e.expandedMarshalId===S.marshalId?(v(),m("div",O7,[r("div",B7,[w[11]||(w[11]=r("span",{class:"detail-label"},"Status:",-1)),r("span",{class:de(S.effectiveIsCheckedIn?"status-checked-in":"status-not-checked-in")},C(S.effectiveIsCheckedIn?"Checked in":"Not checked in"),3)]),S.effectiveIsCheckedIn&&S.checkInTime?(v(),m("div",N7,[w[12]||(w[12]=r("span",{class:"detail-label"},"Check-in time:",-1)),r("span",null,C(g(S.checkInTime)),1)])):M("",!0),S.checkInMethod?(v(),m("div",F7,[w[13]||(w[13]=r("span",{class:"detail-label"},"Method:",-1)),r("span",null,C(y(S.checkInMethod)),1)])):M("",!0),S.email?(v(),m("div",U7,[w[14]||(w[14]=r("span",{class:"detail-label"},"Email:",-1)),r("a",{href:"mailto:"+S.email},C(S.email),9,z7)])):M("",!0),S.phoneNumber?(v(),m("div",H7,[w[15]||(w[15]=r("span",{class:"detail-label"},"Phone:",-1)),r("a",{href:"tel:"+S.phoneNumber},C(S.phoneNumber),9,V7)])):M("",!0),S.email||S.phoneNumber?(v(),m("div",G7,[S.phoneNumber?(v(),m("a",{key:0,href:"tel:"+S.phoneNumber,class:"btn btn-sm btn-primary"},"Call",8,j7)):M("",!0),S.phoneNumber?(v(),m("a",{key:1,href:"sms:"+S.phoneNumber,class:"btn btn-sm btn-secondary"},"Text",8,Z7)):M("",!0),S.email?(v(),m("a",{key:2,href:"mailto:"+S.email,class:"btn btn-sm btn-secondary"},"Email",8,q7)):M("",!0)])):M("",!0),S.marshalId!==e.currentMarshalId?(v(),m("div",W7,[Ae(Vr,{"is-checked-in":S.effectiveIsCheckedIn,"check-in-time":S.checkInTime,"check-in-method":S.checkInMethod,"checked-in-by":S.checkedInBy,"marshal-name":S.marshalName,"is-loading":e.checkingInMarshalId===S.id,onToggle:E=>k.$emit("marshal-check-in",S)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"])])):M("",!0)])):M("",!0)],2))),128))])):(v(),m("div",$7,[(v(!0),m(xe,null,Ne(e.assignment.allMarshals,S=>(v(),m("span",{key:S.marshalId,class:de(["marshal-tag",{"is-you":S.marshalId===e.currentMarshalId,"checked-in":S.effectiveIsCheckedIn}])},[Ye(C(S.marshalName)+C(S.marshalId===e.currentMarshalId?" (you)":"")+" ",1),S.effectiveIsCheckedIn?(v(),m("span",T7,"")):M("",!0)],2))),128))]))]),e.assignment.areaContacts.length>0?(v(),m("div",K7,[r("div",J7,C(O(o).area)+" contacts:",1),r("div",Y7,[(v(!0),m(xe,null,Ne(e.assignment.areaContacts,S=>(v(),We(tm,{key:S.marshalId,name:S.marshalName,role:S.role,phone:S.phone,email:S.email},null,8,["name","role","phone","email"]))),128))])])):M("",!0),e.notes.length>0?(v(),m("div",X7,[w[16]||(w[16]=r("div",{class:"marshals-label"},"Notes:",-1)),r("div",Q7,[(v(!0),m(xe,null,Ne(e.notes,S=>(v(),We(u7,{key:S.noteId,title:S.title,content:S.content,priority:S.priority,"is-pinned":S.isPinned},null,8,["title","content","priority","is-pinned"]))),128))])])):M("",!0),d.value?(v(),m("div",eU,[r("div",tU,[r("span",nU,"Dynamic "+C(e.assignment.location.resolvedCheckpointTerm||O(a).checkpoint),1),e.assignment.location.lastLocationUpdate?(v(),m("span",oU," Last updated: "+C(_(e.assignment.location.lastLocationUpdate)),1)):M("",!0)]),r("div",sU,[r("button",{onClick:w[7]||(w[7]=S=>k.$emit("update-location")),class:"btn btn-update-location",disabled:e.updatingLocation},[...w[17]||(w[17]=[r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1),Ye(" Update location ",-1)])],8,aU),r("button",{onClick:w[8]||(w[8]=S=>k.$emit("toggle-auto-update")),class:de(["btn btn-auto-update",{active:e.autoUpdateEnabled}]),title:e.autoUpdateEnabled?"Stop auto-updating":"Auto-update every 60 seconds"},[w[18]||(w[18]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})],-1)),Ye(" "+C(e.autoUpdateEnabled?"Stop":"Auto"),1)],10,iU)])])):M("",!0)])):M("",!0)]))}},rU=je(lU,[["__scopeId","data-v-01c1d6e0"]]),cU={class:"accordion-section"},uU={class:"accordion-title"},dU=["innerHTML"],hU={class:"accordion-icon"},fU={key:0,class:"accordion-content assignments-accordion-content"},pU={key:0,class:"empty-state"},vU={key:1,class:"checkpoint-accordion"},mU={__name:"MarshalAssignmentsSection",props:{isExpanded:{type:Boolean,default:!1},assignments:{type:Array,default:()=>[]},expandedCheckpointId:{type:String,default:null},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},userLocation:{type:Object,default:null},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},checkingInId:{type:String,default:null},checkingInAssignmentId:{type:String,default:null},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},expandedMarshalId:{type:String,default:null},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},getToolbarActions:{type:Function,default:()=>[]},isAreaLeadForAreas:{type:Function,default:()=>!1},getNotesForCheckpoint:{type:Function,default:()=>[]}},emits:["toggle","toggle-checkpoint","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update"],setup(e,{expose:t}){const{termsLower:o}=ut(),a={},s=(i,l)=>{l?a[i]=l:delete a[i]};return t({checkpointRefs:a}),(i,l)=>(v(),m("div",cU,[r("button",{class:de(["accordion-header",{active:e.isExpanded}]),onClick:l[0]||(l[0]=u=>i.$emit("toggle"))},[r("span",uU,[r("span",{class:"section-icon",innerHTML:O(Xn)("checkpoint")},null,8,dU),Ye(" Your "+C(e.assignments.length===1?O(o).checkpoint:O(o).checkpoints)+C(e.assignments.length>1?` (${e.assignments.length})`:""),1)]),r("span",hU,C(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),m("div",fU,[e.assignments.length===0?(v(),m("div",pU,[r("p",null,"You don't have any "+C(O(o).checkpoint)+" assignments yet.",1)])):(v(),m("div",vU,[(v(!0),m(xe,null,Ne(e.assignments,u=>(v(),We(rU,{key:u.id,ref_for:!0,ref:d=>s(u.id,d),assignment:u,"is-expanded":e.expandedCheckpointId===u.id,"all-locations":e.allLocations,route:e.route,"user-location":e.userLocation,"toolbar-actions":e.getToolbarActions(u.id),"has-dynamic-assignment":e.hasDynamicAssignment,"current-marshal-id":e.currentMarshalId,"current-marshal-name":e.currentMarshalName,"is-checking-in":e.checkingInId===u.id,"check-in-error":e.checkingInAssignmentId===u.id?e.checkInError:"","checking-in-marshal-id":e.checkingInMarshalId,"is-area-lead-for-checkpoint":e.isAreaLeadForAreas(u.areaIds),"expanded-marshal-id":e.expandedMarshalId,notes:e.getNotesForCheckpoint(u.locationId,u.areaIds),"updating-location":e.updatingLocation,"auto-update-enabled":e.autoUpdateEnabled,onToggle:d=>i.$emit("toggle-checkpoint",u.id),onMapClick:l[1]||(l[1]=d=>i.$emit("map-click",d)),onLocationClick:l[2]||(l[2]=d=>i.$emit("location-click",d)),onActionClick:d=>i.$emit("action-click",u,d),onVisibilityChange:d=>i.$emit("visibility-change",u.id,d),onUpdateLocation:d=>i.$emit("update-location",u),onCheckIn:d=>i.$emit("check-in",u),onToggleMarshal:l[3]||(l[3]=d=>i.$emit("toggle-marshal",d)),onMarshalCheckIn:d=>i.$emit("marshal-check-in",d,u.locationId),onToggleAutoUpdate:d=>i.$emit("toggle-auto-update",u)},null,8,["assignment","is-expanded","all-locations","route","user-location","toolbar-actions","has-dynamic-assignment","current-marshal-id","current-marshal-name","is-checking-in","check-in-error","checking-in-marshal-id","is-area-lead-for-checkpoint","expanded-marshal-id","notes","updating-location","auto-update-enabled","onToggle","onActionClick","onVisibilityChange","onUpdateLocation","onCheckIn","onMarshalCheckIn","onToggleAutoUpdate"]))),128))]))])):M("",!0)]))}},gU=je(mU,[["__scopeId","data-v-d18e3955"]]);function yU(e){const t=V(()=>{const p=e.value?.brandingPageGradientStart||ln.pageGradientStart,f=e.value?.brandingPageGradientEnd||ln.pageGradientEnd;return{background:`linear-gradient(135deg, ${p} 0%, ${f} 100%)`}}),o=V(()=>{const p=e.value?.brandingHeaderGradientStart||ln.headerGradientStart,f=e.value?.brandingHeaderGradientEnd||ln.headerGradientEnd;return{background:`linear-gradient(135deg, ${p} 0%, ${f} 100%)`}}),a=V(()=>{const p=e.value?.brandingHeaderGradientStart||ln.headerGradientStart,f=e.value?.brandingHeaderGradientEnd||ln.headerGradientEnd;return Kv(p,f)}),s=V(()=>e.value?.brandingAccentColor||ln.accentColor),i=V(()=>Au(s.value)),l=V(()=>({background:s.value,color:i.value})),u=V(()=>e.value?.brandingLogoUrl||""),d=V(()=>e.value?.brandingLogoPosition||"left");return{pageBackgroundStyle:t,headerStyle:o,headerTextColor:a,accentColor:s,accentTextColor:i,accentButtonStyle:l,brandingLogoUrl:u,brandingLogoPosition:d}}function kU(){const e=$(null),t=$(null);let o=null;const a=()=>{if(!("geolocation"in navigator)){console.warn("Geolocation not supported");return}console.log("Starting location tracking..."),o=navigator.geolocation.watchPosition(i=>{e.value={lat:i.coords.latitude,lng:i.coords.longitude},t.value=Date.now()},i=>{console.warn("Geolocation error:",{1:"Location permission denied. Please allow location access in your browser settings.",2:"Location unavailable. Make sure GPS is enabled on your device.",3:"Location request timed out. Please try again."}[i.code]||i.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},s=()=>{o!==null&&(navigator.geolocation.clearWatch(o),o=null)};return xn(()=>{s()}),{userLocation:e,locationLastUpdated:t,startLocationTracking:a,stopLocationTracking:s}}function _U({eventId:e,currentMarshalId:t,currentPerson:o,assignments:a,areaLeadAreaIds:s,isAreaLead:i,allLocations:l,areas:u,terms:d,termsLower:p,areaLeadRef:f,areaLeadCheckpoints:g,sectionLastLoadedAt:y,updateCachedField:_,updatePendingCount:k}){const w=$([]),S=$(!1),E=$(null),A=$(!1),x=$("person"),D=$(null),R=V(()=>w.value.filter(U=>U.isCompleted&&["OnePerCheckpoint","OnePerArea","OneLeadPerArea"].includes(U.matchedScope)?U.completedByActorId===t.value:!0)),F=V(()=>R.value.filter(U=>U.isCompleted).length),T=V(()=>{const U=a.value.map(ee=>ee.locationId);return R.value.filter(ee=>ee.completionContextType==="Personal"?ee.contextOwnerMarshalId===t.value:ee.completionContextType==="Checkpoint"?U.includes(ee.completionContextId):ee.completionContextType==="Area"?s.value.includes(ee.completionContextId):!0)}),N=V(()=>{if(!i.value)return[];const U=a.value.map(ee=>ee.locationId);return R.value.filter(ee=>ee.completionContextType==="Personal"?ee.contextOwnerMarshalId!==t.value:ee.completionContextType==="Checkpoint"?!U.includes(ee.completionContextId):ee.completionContextType==="Area"?!s.value.includes(ee.completionContextId):!1)}),B=V(()=>T.value.map(U=>({...U,localIsCompleted:U.isCompleted,isModified:!1}))),q=V(()=>N.value.map(U=>({...U,localIsCompleted:U.isCompleted,isModified:!1}))),P=V(()=>{const U=f.value?.checkpoints||g.value||[];if(U.length===0)return[];const ee=[],fe=new Set;for(const ue of U)for(const De of ue.marshals||[])fe.has(De.marshalId)||(fe.add(De.marshalId),ee.push(De));return ee}),G=V(()=>{if(i.value)return"none";const U=R.value,ee=new Set;for(const fe of U)fe.completionContextType==="Checkpoint"&&fe.completionContextId&&ee.add(fe.completionContextId);return ee.size>1?"checkpoint":"none"}),X=V(()=>{const U=R.value,ee={};for(const fe of U){let ue,De;fe.completionContextType==="Checkpoint"&&fe.completionContextId?(ue=`checkpoint_${fe.completionContextId}`,De=l.value.find(Je=>Je.id===fe.completionContextId)?.name||"Unknown "+d.value.checkpoint):fe.completionContextType==="Area"&&fe.completionContextId?(ue=`area_${fe.completionContextId}`,De=u.value.find(Je=>Je.id===fe.completionContextId)?.name||"Unknown "+d.value.area):(ue="personal",De="Personal"),ee[ue]||(ee[ue]={key:ue,name:De,items:[],completedCount:0}),ee[ue].items.push(fe),fe.isCompleted&&ee[ue].completedCount++}return Object.values(ee).sort((fe,ue)=>fe.name.localeCompare(ue.name,void 0,{numeric:!0,sensitivity:"base"}))}),ne=U=>{D.value=D.value===U?null:U},K=U=>{if(!U.completionContextType||!U.completionContextId)return null;if(U.completionContextType==="Checkpoint"){const ee=l.value.find(ue=>ue.id===U.completionContextId);if(!ee)return null;const fe=ee.description?` - ${ee.description}`:"";return`At ${p.value.checkpoint} ${ee.name}${fe}`}if(U.completionContextType==="Area"){const ee=u.value.find(fe=>fe.id===U.completionContextId);return ee?`At ${p.value.area} ${ee.name}`:null}return U.completionContextType==="Personal"?"Personal item":null},Q=async(U=!1)=>{if(!t.value){console.warn("No marshal ID, skipping checklist load");return}U||(S.value=!0),E.value=null;try{const ee=e.value;console.log("Fetching checklist for marshal:",t.value);let ue=(await Rt.getMarshalChecklist(ee,t.value)).data||[];if(i.value&&s.value.length>0){console.log("Fetching area checklists for areas:",s.value);const De=s.value.map(Ze=>Rt.getAreaChecklist(ee,Ze).catch(He=>(console.warn(`Failed to fetch checklist for area ${Ze}:`,He),{data:[]}))),et=await Promise.all(De),Je=new Map;for(const Ze of ue){const He=`${Ze.itemId}_${Ze.completionContextType}_${Ze.completionContextId}`;Je.set(He,Ze)}for(const Ze of et)for(const He of Ze.data||[]){const be=`${He.itemId}_${He.completionContextType}_${He.completionContextId}`;Je.has(be)||Je.set(be,He)}ue=Array.from(Je.values()),console.log("Merged checklist items:",ue.length)}w.value=ue,y?.value&&(y.value.checklist=Date.now()),console.log("Checklist loaded:",w.value.length,"items")}catch(ee){console.error("Failed to load checklist:",ee.response?.status,ee.response?.data),E.value=ee.response?.data?.message||"Failed to load checklist"}finally{U||(S.value=!1)}};return{checklistItems:w,checklistLoading:S,checklistError:E,savingChecklist:A,checklistGroupBy:x,expandedChecklistGroup:D,visibleChecklistItems:R,completedChecklistCount:F,myChecklistItems:T,areaChecklistItems:N,myChecklistItemsWithLocalState:B,areaChecklistItemsWithLocalState:q,areaMarshalsForChecklist:P,effectiveChecklistGroupBy:G,groupedChecklistItems:X,loadChecklist:Q,handleToggleChecklist:async U=>{if(A.value)return;A.value=!0;const ee=e.value,fe={marshalId:U.contextOwnerMarshalId||t.value,contextType:U.completionContextType,contextId:U.completionContextId,actorMarshalId:t.value};try{U.isCompleted?Pn()?(await ko("checklist_uncomplete",{eventId:ee,itemId:U.itemId,data:fe}),U.isCompleted=!1,U.completedAt=null,U.completedByActorName=null,k&&await k()):(await Rt.uncomplete(ee,U.itemId,fe),await Q(!0)):Pn()?(await ko("checklist_complete",{eventId:ee,itemId:U.itemId,data:fe}),U.isCompleted=!0,U.completedAt=new Date().toISOString(),U.completedByActorName=o.value?.name||"You",k&&await k()):(await Rt.complete(ee,U.itemId,fe),await Q(!0)),_&&await _(ee,"checklist",JSON.parse(JSON.stringify(w.value)))}catch(ue){if(console.error("Failed to toggle checklist item:",ue),Pn()||!ue.response){const De=U.isCompleted?"checklist_uncomplete":"checklist_complete";await ko(De,{eventId:ee,itemId:U.itemId,data:fe}),U.isCompleted?(U.isCompleted=!1,U.completedAt=null,U.completedByActorName=null):(U.isCompleted=!0,U.completedAt=new Date().toISOString(),U.completedByActorName=o.value?.name||"You"),k&&await k(),_&&await _(ee,"checklist",JSON.parse(JSON.stringify(w.value)))}}finally{A.value=!1}},toggleChecklistGroup:ne,getContextName:K}}function bU({eventId:e,allLocations:t,userLocation:o,locationLastUpdated:a}){const s=$(!1),i=$(null),l=$(null),u=$(null),d=$(!1),p=$(!1),f=$(!1);let g=null,y=null;const _=ne=>ne?.isDynamic===!0||ne?.IsDynamic===!0,k=(ne,K,Q,he)=>{const U=t.value.find(ee=>ee.id===ne);U&&(U.latitude=K,U.longitude=Q,U.lastLocationUpdate=he)},w=ne=>{i.value=ne,l.value=null,u.value=null,s.value=!0},S=()=>{s.value=!1,i.value=null,l.value=null,u.value=null,f.value=!1},E=()=>{s.value=!1,f.value=!0},A=()=>{f.value=!1,s.value=!0},x=async(ne,K,Q,he,U=null)=>{d.value=!0;try{const ee=e.value,fe={latitude:K,longitude:Q,sourceType:he};U&&(fe.sourceCheckpointId=U);const ue=await Yn.updatePosition(ee,ne,fe);ue.data.success&&(p.value&&B(),k(ne,ue.data.latitude,ue.data.longitude,ue.data.lastLocationUpdate))}catch(ee){console.error("Failed to update location:",ee),ee.response?.status===403?alert("You do not have permission to update this location."):alert("Failed to update location. Please try again.")}finally{d.value=!1}},D=async()=>{if(i.value){d.value=!0,l.value=null;try{let ne,K;if(o.value&&a?.value&&Date.now()-a.value<3e4&&(ne=o.value.lat,K=o.value.lng),!ne||!K){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const ee=await new Promise((fe,ue)=>{navigator.geolocation.getCurrentPosition(fe,ue,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4})});ne=ee.coords.latitude,K=ee.coords.longitude}const Q=e.value,he=i.value.locationId,U=await Yn.updatePosition(Q,he,{latitude:ne,longitude:K,sourceType:"gps"});U.data.success&&(u.value="Location updated successfully!",k(he,U.data.latitude,U.data.longitude,U.data.lastLocationUpdate),setTimeout(()=>S(),1500))}catch(ne){console.error("Failed to update location with GPS:",ne),ne.response?.status===403?l.value="You do not have permission to update this location.":ne.code===1?l.value="Location access denied. Please enable location permissions.":ne.code===2?l.value="Unable to determine your location. Please try again.":ne.code===3||ne.message?.includes("Timeout")?l.value="GPS timed out. Please ensure location services are enabled and try again.":l.value="Failed to update location. Please try again."}finally{d.value=!1}}},R=async ne=>{if(!i.value)return;const K=t.value.find(Q=>Q.id===ne);if(!K){l.value="Source checkpoint not found.";return}d.value=!0,l.value=null;try{const Q=e.value,he=i.value.locationId,U=await Yn.updatePosition(Q,he,{latitude:K.latitude,longitude:K.longitude,sourceType:"checkpoint",sourceCheckpointId:ne});U.data.success&&(p.value&&B(),u.value=`Location copied from ${K.name}!`,k(he,U.data.latitude,U.data.longitude,U.data.lastLocationUpdate),setTimeout(()=>S(),1500))}catch(Q){console.error("Failed to copy location from checkpoint:",Q),Q.response?.status===403?l.value="You do not have permission to update this location.":l.value="Failed to update location. Please try again."}finally{d.value=!1}},F=async(ne,K)=>{if(i.value){d.value=!0,l.value=null;try{const Q=e.value,he=i.value.locationId,U=await Yn.updatePosition(Q,he,{latitude:ne,longitude:K,sourceType:"manual"});U.data.success&&(u.value="Location updated successfully!",k(he,U.data.latitude,U.data.longitude,U.data.lastLocationUpdate),setTimeout(()=>S(),1500))}catch(Q){console.error("Failed to update location manually:",Q),Q.response?.status===403?l.value="You do not have permission to update this location.":l.value="Failed to update location. Please try again."}finally{d.value=!1}}},T=async ne=>{if(!(!ne||!("geolocation"in navigator)))try{const K=await new Promise((U,ee)=>{navigator.geolocation.getCurrentPosition(U,ee,{enableHighAccuracy:!0,timeout:15e3})}),Q=e.value,he=ne.locationId;await Yn.updatePosition(Q,he,{latitude:K.coords.latitude,longitude:K.coords.longitude,sourceType:"gps"}),k(he,K.coords.latitude,K.coords.longitude,new Date().toISOString())}catch(K){console.warn("Auto-update location failed:",K)}},N=ne=>{p.value=!0,T(ne),g=setInterval(()=>{T(ne)},6e4)},B=()=>{p.value=!1,g&&(clearInterval(g),g=null)};return{showLocationUpdateModal:s,updatingLocationFor:i,locationUpdateError:l,locationUpdateSuccess:u,updatingLocation:d,autoUpdateEnabled:p,selectingLocationOnMap:f,isDynamicCheckpoint:_,openLocationUpdateModal:w,closeLocationUpdateModal:S,startMapLocationSelect:E,cancelMapLocationSelect:A,updateDynamicCheckpointLocation:x,updateLocationWithGps:D,updateLocationFromCheckpoint:R,updateLocationManually:F,toggleAutoUpdate:ne=>{p.value?B():N(ne)},startAutoUpdate:N,stopAutoUpdate:B,startDynamicCheckpointPolling:()=>{y||!t.value.some(K=>K.isDynamic||K.IsDynamic)||(y=setInterval(async()=>{try{const K=e.value,Q=await Yn.getDynamicCheckpoints(K);if(Q.data&&Array.isArray(Q.data))for(const he of Q.data){const U=t.value.find(ee=>ee.id===he.checkpointId);U&&(U.latitude=he.latitude,U.longitude=he.longitude,U.lastLocationUpdate=he.lastLocationUpdate)}}catch(K){console.warn("Failed to poll dynamic checkpoints:",K)}},6e4))},stopDynamicCheckpointPolling:()=>{y&&(clearInterval(y),y=null)},handleMapClickForLocation:ne=>{f.value&&i.value&&(x(i.value.locationId,ne.lat,ne.lng,"manual"),f.value=!1)}}}function wU({eventId:e,assignments:t,allLocations:o,areaLeadRef:a,areaLeadCheckpoints:s,areaLeadMarshalDataVersion:i,updatePendingCount:l,updateCachedField:u}){const d=$(null),p=$(null),f=$(null),g=$(!1),y=$(null),_=$(new Set),k=D=>{if(!D)return!0;const R=new Date(D);return(new Date-R)/(1e3*60*60)>24},w=D=>D?new Date(D).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",S=D=>{if(!D)return"";switch(D){case"GPS":return"GPS";case"Manual":return"Manual";case"AreaLead":return"By area lead";default:return D}},E=D=>{_.value.add(D),g.value=!1,y.value=null},A=async(D,R=!0,F=null)=>{d.value=D.id,p.value=D.id,f.value=null;const T=e.value,N=D.effectiveIsCheckedIn!==void 0?D.effectiveIsCheckedIn:D.isCheckedIn&&!k(D.checkInTime),B=N?"check-out":"check-in",q=!N;let P=null,G=null,X="Manual";if(R&&!N&&"geolocation"in navigator)try{const K=await new Promise((Q,he)=>{navigator.geolocation.getCurrentPosition(Q,he,{enableHighAccuracy:!0,timeout:5e3})});P=K.coords.latitude,G=K.coords.longitude,X="GPS"}catch(K){console.log("GPS unavailable, using manual check-in:",K.message)}const ne={latitude:P,longitude:G,action:B};try{if(Pn()){await ko("checkin_toggle",{eventId:T,assignmentId:D.id,gpsData:ne});const K=t.value.findIndex(Q=>Q.id===D.id);if(K!==-1&&(t.value[K]={...t.value[K],isCheckedIn:q,checkInTime:q?new Date().toISOString():null,checkInMethod:q?`${X} (pending)`:null,checkInLatitude:P,checkInLongitude:G}),F){const Q=o.value.find(he=>he.id===F);if(Q?.assignments){const he=Q.assignments.find(U=>U.id===D.id||U.marshalId===D.marshalId);he&&(he.isCheckedIn=q,he.checkInTime=q?new Date().toISOString():null)}}l&&await l(),u&&await u(T,"locations",o.value)}else{const K=await Ca.toggleCheckIn(T,D.id,ne),Q=t.value.findIndex(he=>he.id===D.id);if(Q!==-1&&(t.value[Q]=K.data),F){const he=o.value.find(U=>U.id===F);if(he?.assignments){const U=he.assignments.find(ee=>ee.id===D.id||ee.marshalId===D.marshalId);U&&Object.assign(U,K.data)}}}F&&a?.value?.loadDashboard&&await a.value.loadDashboard(),i&&i.value++}catch(K){if(Pn()||!K.response){await ko("checkin_toggle",{eventId:T,assignmentId:D.id,gpsData:ne});const Q=t.value.findIndex(he=>he.id===D.id);Q!==-1&&(t.value[Q]={...t.value[Q],isCheckedIn:q,checkInTime:q?new Date().toISOString():null,checkInMethod:q?"Manual (pending)":null}),l&&await l()}else K.response?.data?.message?f.value=K.response.data.message:K.message?f.value=K.message:f.value=`Failed to ${B}. Please try again.`}finally{d.value=null,p.value=null}};return{checkingIn:d,checkingInAssignment:p,checkInError:f,showCheckInReminderModal:g,checkInReminderCheckpoint:y,dismissedCheckInReminders:_,isCheckInStale:k,formatCheckInTime:w,formatCheckInMethod:S,handleCheckInToggle:A,handleAreaLeadMarshalCheckIn:async D=>{const F=(a?.value?.checkpoints||s?.value||[]).find(q=>q.marshals?.some(P=>P.marshalId===D.marshalId));if(!F){console.error("Could not find checkpoint for marshal:",D);return}const T=F.marshals.find(q=>q.marshalId===D.marshalId);if(!T)return;const N=T.assignmentId||T.id;if(!N){console.error("No assignment ID found for marshal:",T);return}const B={id:N,marshalId:D.marshalId,isCheckedIn:D.isCheckedIn,effectiveIsCheckedIn:D.isCheckedIn};await A(B,!1,F.locationId)},dismissCheckInReminder:E}}function CU({eventId:e,currentMarshalId:t,isAreaLead:o,areaLeadAreaIds:a,sectionLastLoadedAt:s,showMessage:i}){const l=$([]),u=$(!1),d=$(null),p=$(!1),f=$(!1),g=$(""),y=$(!1),_=$(!1),k=$(!1),w=V(()=>l.value.filter(N=>N.status==="open"||N.status==="acknowledged"||N.status==="in_progress").length),S=async()=>{const N=e.value;u.value=!0;try{const B=new Map;if(o.value&&a.value.length>0)for(const q of a.value)try{const G=(await fs.getForArea(N,q)).data.incidents||[];for(const X of G)B.set(X.incidentId,X)}catch(P){console.warn(`Failed to load incidents for area ${q}:`,P)}try{const P=(await fs.getAll(N)).data.incidents||[];for(const G of P)G.reportedBy?.marshalId===t.value&&B.set(G.incidentId,G)}catch(q){console.debug("Could not load all incidents:",q)}l.value=Array.from(B.values()).sort((q,P)=>new Date(P.incidentTime||P.createdAt)-new Date(q.incidentTime||q.createdAt)),s?.value&&(s.value.incidents=Date.now()),console.log("My incidents loaded:",l.value.length)}catch(B){console.error("Failed to load incidents:",B)}finally{u.value=!1}},E=async N=>{k.value=!0;try{await fs.create(e.value,N),_.value=!1,S(),i&&i("Incident Reported","An administrator will review it shortly.")}catch(B){console.error("Failed to report incident:",B),i&&i("Error",B.response?.data?.message||"Failed to report incident. Please try again.")}finally{k.value=!1}},A=N=>{d.value=N,p.value=!0},x=()=>{p.value=!1,d.value=null},D=async({incidentId:N,status:B})=>{try{await fs.updateStatus(e.value,N,{status:B});const q=l.value.find(P=>P.incidentId===N);q&&(q.status=B),d.value?.incidentId===N&&(d.value.status=B)}catch(q){console.error("Failed to update incident status:",q),i&&i("Error","Failed to update status. Please try again.")}},R=()=>{g.value="",f.value=!0},F=()=>{f.value=!1,g.value=""};return{myIncidents:l,incidentsLoading:u,selectedIncident:d,showIncidentDetail:p,showAddIncidentNoteModal:f,incidentNoteText:g,submittingIncidentNote:y,showReportIncident:_,reportingIncident:k,openIncidentsCount:w,loadMyIncidents:S,handleReportIncident:E,openIncidentDetail:A,closeIncidentDetail:x,handleIncidentStatusChange:D,openAddIncidentNoteModal:R,closeAddIncidentNoteModal:F,submitIncidentNote:async()=>{if(!(!g.value.trim()||!d.value)){y.value=!0;try{await fs.addNote(e.value,d.value.incidentId,g.value.trim()),F(),S();const N=await fs.get(e.value,d.value.incidentId);d.value=N.data}catch(N){console.error("Failed to add note:",N),i&&i("Error","Failed to add note. Please try again.")}finally{y.value=!1}}}}}const ff='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><circle cx="12" cy="12" r="4"/><path d="M13 4.069V2h-2v2.069A8.01 8.01 0 0 0 4.069 11H2v2h2.069A8.008 8.008 0 0 0 11 19.931V22h2v-2.069A8.007 8.007 0 0 0 19.931 13H22v-2h-2.069A8.008 8.008 0 0 0 13 4.069zM12 18c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6z"/></svg>',pf='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>';function LU({userLocation:e,assignmentsWithDetails:t,courseMapRef:o}){const{termsLower:a}=ut(),s=$({userLocationInView:!1,highlightedLocationInView:!1,highlightedLocationsVisibility:{}}),i=$(-1),l=$({}),u={},d=V(()=>t.value.filter(S=>S.location?.latitude&&S.location?.longitude&&!(S.location.latitude===0&&S.location.longitude===0))),p=V(()=>{const S=[];return e.value&&!s.value.userLocationInView&&S.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:ff}),d.value.length>0&&!s.value.highlightedLocationInView&&S.push({id:"recenter-checkpoint",label:"My "+a.value.checkpoint,icon:"custom",customIcon:pf}),S}),f=S=>{const E=s.value,A=E.userLocationInView!==S.userLocationInView||E.highlightedLocationInView!==S.highlightedLocationInView,x=JSON.stringify(E.highlightedLocationsVisibility)!==JSON.stringify(S.highlightedLocationsVisibility||{});(A||x)&&(s.value={...S,highlightedLocationsVisibility:S.highlightedLocationsVisibility||{}})},g=()=>{const S=d.value;if(S.length===0)return null;if(S.length===1)return i.value=0,S[0];const E=s.value.highlightedLocationsVisibility||{},A=[];for(let R=0;R<S.length;R++){const F=S[R].locationId;E[F]===!1&&A.push(R)}if(A.length===0)return i.value=0,S[0];if(A.length===1)return i.value=A[0],S[A[0]];const x=i.value;let D=-1;for(const R of A)if(R>x){D=R;break}return D===-1&&(D=A[0]),i.value=D,S[D]};return{courseMapVisibility:s,courseMapActions:p,handleCourseMapVisibilityChange:f,handleCourseMapAction:({actionId:S})=>{if(S==="recenter-user"&&e.value)o.value?.recenterOnUserLocation();else if(S==="recenter-checkpoint"){const E=g();E?.location&&o.value?.recenterOnLocation(E.location.latitude,E.location.longitude)}},checkpointMapVisibility:l,checkpointMapRefs:u,getCheckpointMapActions:S=>{const E=[],A=l.value[S]||{userLocationInView:!1,highlightedLocationInView:!1};return e.value&&!A.userLocationInView&&E.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:ff}),A.highlightedLocationInView||E.push({id:"recenter-checkpoint",label:a.value.checkpoint.charAt(0).toUpperCase()+a.value.checkpoint.slice(1),icon:"custom",customIcon:pf}),E},handleCheckpointMapVisibilityChange:(S,E)=>{const A=l.value[S];(!A||A.userLocationInView!==E.userLocationInView||A.highlightedLocationInView!==E.highlightedLocationInView)&&(l.value={...l.value,[S]:E})},handleCheckpointMapAction:(S,{actionId:E})=>{const A=u[S.id];E==="recenter-user"&&e.value?A?.recenterOnUserLocation():E==="recenter-checkpoint"&&S.location&&A?.recenterOnLocation(S.location.latitude,S.location.longitude)}}}function SU({eventId:e,currentMarshalId:t,areaLeadRef:o,areaLeadCheckpoints:a,loadChecklist:s}){const i=$(null),l=$(!1),u=$(0),d=g=>{i.value=i.value===g?null:g},p=V(()=>{u.value;const g=o?.value?.checkpoints||a?.value||[],y=new Map;for(const _ of g)for(const k of _.marshals||[]){y.has(k.marshalId)||y.set(k.marshalId,{...k,checkpoints:[],allTasks:[],totalTaskCount:0,completedTaskCount:0});const w=y.get(k.marshalId);if(w.checkpoints.push({checkpointId:_.checkpointId,name:_.name,description:_.description}),k.outstandingTasks)for(const S of k.outstandingTasks)w.allTasks.push({...S,isCompleted:!1,checkpointName:_.name}),w.totalTaskCount++;if(k.completedTasks)for(const S of k.completedTasks)w.allTasks.push({...S,isCompleted:!0,checkpointName:_.name}),w.totalTaskCount++,w.completedTaskCount++}return Array.from(y.values()).sort((_,k)=>(_.name||"").localeCompare(k.name||"",void 0,{sensitivity:"base"}))});return{expandedAreaLeadMarshal:i,savingAreaLeadMarshalTask:l,areaLeadMarshalDataVersion:u,allAreaLeadMarshals:p,toggleAreaLeadMarshalExpansion:d,toggleAreaLeadMarshalTask:async(g,y)=>{if(l.value)return;l.value=!0;const _={marshalId:y.marshalId,contextType:g.contextType,contextId:g.contextId,actorMarshalId:t.value};try{g.isCompleted?await Rt.uncomplete(e.value,g.itemId,_):await Rt.complete(e.value,g.itemId,_),o?.value?.loadDashboard&&await o.value.loadDashboard(),u.value++,s&&await s(!0)}catch(k){console.error("Failed to toggle area lead marshal task:",k)}finally{l.value=!1}}}}function xU({router:e,route:t,onAuthSuccess:o}){const a=$(!1),s=$(!1),i=$(null),l=$(null),u=$(null),d=$(null),p=V(()=>l.value?.name||null),f=V(()=>d.value?.eventRoles?d.value.eventRoles.filter(B=>B.role==="EventAreaLead").flatMap(B=>B.areaIds||[]):[]),g=V(()=>f.value.length>0),y=V(()=>d.value?.eventRoles?d.value.eventRoles.some(N=>N.role==="EventAdmin"):!1),_=V(()=>d.value?.authMethod==="SecureEmailLink"&&y.value),k=V(()=>d.value?.authMethod==="MarshalMagicCode"&&y.value);let w=null;const S=()=>{w||(w=setInterval(async()=>{if(d.value?.marshalId)try{await vs.getMe(t.params.eventId)}catch(N){console.debug("Heartbeat failed:",N)}},300*1e3))},E=()=>{w&&(clearInterval(w),w=null)},A=async(N,B,q=!1)=>{s.value=!0,i.value=null,console.log("Authenticating with magic code:",{eventId:N,code:B,isReauth:q}),Kc();try{_o("marshal",N);const P=await vs.marshalLogin(N,B);if(console.log("Auth response:",P.data),P.data.success){Ph(N,{token:P.data.sessionToken,marshalId:P.data.marshalId,marshalName:P.data.person?.name||null}),sk(N,P.data.marshalId,B),l.value=P.data.person,u.value=P.data.marshalId,a.value=!0,console.log("Authenticated as marshal:",u.value,l.value?.name);try{const G=await vs.getMe(N);d.value=G.data,console.log("User claims:",d.value)}catch(G){console.warn("Failed to fetch claims:",G)}e.replace({path:t.path,query:{}}),S(),o&&await o()}else i.value=P.data.message||"Authentication failed"}catch(P){console.error("Authentication failed:",P),i.value=P.response?.data?.message||"Invalid or expired login link"}finally{s.value=!1}};return{isAuthenticated:a,authenticating:s,loginError:i,currentPerson:l,currentMarshalId:u,userClaims:d,currentMarshalName:p,areaLeadAreaIds:f,isAreaLead:g,isEventAdmin:y,canSwitchToAdmin:_,isAdminButNeedsReauth:k,authenticateWithMagicCode:A,checkExistingSession:async N=>{_o("marshal",N);const B=Br(N),q=B?.marshalId,P=q?rv(N,q):null;if(!B?.token)return P?(console.log("No session but have stored code, attempting re-authentication..."),Kc(),await A(N,P,!0),a.value):!1;try{const G=await vs.getMe(N);if(G.data&&G.data.marshalId)return d.value=G.data,l.value={personId:G.data.personId,name:G.data.personName,email:G.data.personEmail},u.value=G.data.marshalId,a.value=!0,sv(N,G.data.marshalId),S(),!0}catch(G){if(console.log("Session validation failed, attempting re-authentication...",G),P)try{if(Kc(),await A(N,P,!0),a.value)return console.log("Re-authentication successful"),!0}catch(X){console.error("Re-authentication failed:",X)}B?.sessionKey&&yu(B.sessionKey)}return!1},handleClose:N=>{E(),_o(null),a.value=!1,l.value=null,u.value=null,d.value=null,N&&N(),e.push("/marshal")},handleRemoveSession:async N=>{const[B]=N.split(":");_o("marshal",B);try{await vs.logout()}catch{}yu(N),_o(null)},updateSessionEventInfo:(N,B,q)=>{const P=Br(N);P&&P.marshalId&&Ph(N,{marshalId:P.marshalId,marshalName:P.marshalName,token:P.token,eventName:B,eventDate:q})},switchToAdminMode:()=>{e.push(`/admin/events/${t.params.eventId}`)},startHeartbeat:S,stopHeartbeat:E}}const IU={key:0,class:"header-logo-cover"},$U=["src"],TU={key:2,class:"header-logo header-logo-left"},MU=["src"],AU={class:"header-center"},EU={key:0},PU={key:1,class:"header-event-date"},DU={key:0,class:"header-actions"},RU={key:3,class:"header-logo header-logo-right"},OU=["src"],BU={class:"container"},NU={key:0,class:"selection-card"},FU={key:1,class:"selection-card"},UU={key:0,class:"loading"},zU={key:2,class:"selection-card error-card"},HU={class:"error"},VU={key:3,class:"dashboard"},GU={key:0,class:"welcome-bar"},jU={class:"welcome-info"},ZU={key:0,class:"welcome-email"},qU={key:0,class:"mode-switch"},WU={key:1,class:"mode-switch"},KU={class:"accordion"},JU={class:"add-note-form"},YU={class:"modal-actions"},XU=["disabled"],QU=6e4,ez={__name:"MarshalView",setup(e){const{terms:t,termsLower:o}=ut(),{updatePendingCount:a}=rd(),s=uc(),i=Vi(),l=V(()=>s.params.eventId),u={onAuthSuccess:null},{isAuthenticated:d,authenticating:p,loginError:f,currentPerson:g,currentMarshalId:y,currentMarshalName:_,areaLeadAreaIds:k,isAreaLead:w,canSwitchToAdmin:S,isAdminButNeedsReauth:E,authenticateWithMagicCode:A,checkExistingSession:x,handleClose:D,updateSessionEventInfo:R,switchToAdminMode:F,stopHeartbeat:T}=xU({router:i,route:s,onAuthSuccess:()=>u.onAuthSuccess?.()}),N=$(new Set),B=V(()=>k.value.length?Q.value.filter(Ee=>k.value.includes(Ee.id)).map(Ee=>({areaId:Ee.id,name:Ee.name,color:Ee.color})).sort((Ee,Me)=>(Ee.name||"").localeCompare(Me.name||"",void 0,{numeric:!0,sensitivity:"base"})):[]);qe(B,Ee=>{Ee.length>0&&N.value.size===0&&(N.value=new Set(Ee.map(Me=>Me.areaId)))},{immediate:!0});const q=V(()=>k.value.filter(Ee=>N.value.has(Ee))),P=Ee=>{const Me=new Set(N.value);Me.has(Ee)?Me.delete(Ee):Me.add(Ee),N.value=Me},G=V(()=>{const Ee=kn.value.find(at=>at.isCheckedIn&&!Oo(at.checkInTime)&&at.location);if(Ee?.location)return{id:Ee.location.id,locationId:Ee.location.id,name:Ee.location.name,description:Ee.location.description};if(In.value){const at=kn.value.find(ft=>ft.id===In.value);if(at?.location)return{id:at.location.id,locationId:at.location.id,name:at.location.name,description:at.location.description}}const Me=kn.value[0];return Me?.location?{id:Me.location.id,locationId:Me.location.id,name:Me.location.name,description:Me.location.description}:null}),X=$(null),ne=$([]),K=$([]),Q=$([]),he=$(!0),{pageBackgroundStyle:U,headerStyle:ee,headerTextColor:fe,accentColor:ue,accentTextColor:De,accentButtonStyle:et,brandingLogoUrl:Je,brandingLogoPosition:Ze}=yU(X);yl("marshalBranding",{headerStyle:ee,headerTextColor:fe,accentButtonStyle:et,accentColor:ue,accentTextColor:De});const He=$("assignments"),be=$({checklist:0,notes:0,incidents:0,eventContacts:0}),Ve=$([]),ve=$([]),Le=$(null),Pe=V(()=>Le.value?.areaLeadRef?.value),{checklistItems:W,checklistLoading:Y,checklistError:pe,savingChecklist:Ce,expandedChecklistGroup:le,visibleChecklistItems:J,completedChecklistCount:j,myChecklistItems:te,areaChecklistItems:Re,areaChecklistItemsWithLocalState:Se,areaMarshalsForChecklist:we,effectiveChecklistGroupBy:ge,groupedChecklistItems:Z,loadChecklist:se,handleToggleChecklist:ce,toggleChecklistGroup:Te,getContextName:Oe}=_U({eventId:l,currentMarshalId:y,currentPerson:g,assignments:K,areaLeadAreaIds:k,isAreaLead:w,allLocations:ne,areas:Q,terms:t,termsLower:o,areaLeadRef:Pe,areaLeadCheckpoints:Ve,sectionLastLoadedAt:be,updateCachedField:wr,updatePendingCount:a}),{userLocation:Be,locationLastUpdated:Xe,startLocationTracking:mt,stopLocationTracking:_t}=kU(),{showLocationUpdateModal:bt,updatingLocationFor:Mt,locationUpdateError:wt,locationUpdateSuccess:Nt,updatingLocation:Ft,autoUpdateEnabled:Fn,selectingLocationOnMap:Qn,openLocationUpdateModal:fn,closeLocationUpdateModal:jt,startMapLocationSelect:yt,cancelMapLocationSelect:eo,updateDynamicCheckpointLocation:Un,updateLocationWithGps:to,updateLocationFromCheckpoint:pn,toggleAutoUpdate:Zt,stopAutoUpdate:ks,startDynamicCheckpointPolling:no,stopDynamicCheckpointPolling:Co}=bU({eventId:l,allLocations:ne,userLocation:Be,locationLastUpdated:Xe}),ie=()=>{yt(),He.value="map"},{expandedAreaLeadMarshal:re,savingAreaLeadMarshalTask:me,areaLeadMarshalDataVersion:ot,allAreaLeadMarshals:Ge,toggleAreaLeadMarshalExpansion:St,toggleAreaLeadMarshalTask:Wt}=SU({eventId:l,currentMarshalId:y,areaLeadRef:Pe,areaLeadCheckpoints:Ve,loadChecklist:se}),{checkingIn:Qt,checkingInAssignment:Do,checkInError:uo,showCheckInReminderModal:Ro,checkInReminderCheckpoint:zn,dismissedCheckInReminders:Ta,isCheckInStale:Oo,handleCheckInToggle:Lo,handleAreaLeadMarshalCheckIn:Zs,dismissCheckInReminder:qs}=wU({eventId:l,assignments:K,allLocations:ne,areaLeadRef:Pe,areaLeadCheckpoints:Ve,areaLeadMarshalDataVersion:ot,updatePendingCount:a,updateCachedField:wr}),vn=$(!1),Bo=$(!1),on=$(""),So=$(""),ho=$(null),_s=$(!1),xo=$(""),bs=$(""),Io=(Ee,Me)=>{xo.value=Ee,bs.value=Me,_s.value=!0},{myIncidents:No,incidentsLoading:mn,selectedIncident:$o,showIncidentDetail:Hn,showAddIncidentNoteModal:vt,incidentNoteText:xt,submittingIncidentNote:To,showReportIncident:fo,loadMyIncidents:Fo,handleReportIncident:Ma,openIncidentDetail:ht,handleIncidentStatusChange:Ut,openAddIncidentNoteModal:Aa,closeAddIncidentNoteModal:Uo,submitIncidentNote:gn}=CU({eventId:l,currentMarshalId:y,isAreaLead:w,areaLeadAreaIds:k,sectionLastLoadedAt:be,showMessage:Io}),ri=$(null),Ws=V(()=>ri.value),po=$(null),qt=Ee=>!Ee||Ee.length===0?!1:Ee.some(Me=>k.value.includes(Me)),zo=Ee=>{po.value=po.value===Ee?null:Ee},yn=Ee=>{const Me=He.value===Ee;if(He.value=Me?null:Ee,!Me){const at=Date.now(),ft=Ct=>at-be.value[Ct]>QU;switch(Ee){case"checklist":ft("checklist")&&se();break;case"notes":ft("notes")&&ta();break;case"incidents":ft("incidents")&&Fo();break;case"eventContacts":ft("eventContacts")&&gt();break}}},In=$(null),Ea=Ee=>{In.value=In.value===Ee?null:Ee};qe(()=>K.value,Ee=>{Ee.length===1&&In.value===null&&(In.value=Ee[0].id)},{immediate:!0});const kn=V(()=>K.value.map(Ee=>{const Me=ne.value.find($t=>$t.id===Ee.locationId),at=Me?.areaIds||Me?.AreaIds||[];let ft=null;at.length>0&&Q.value.length>0&&(ft=Q.value.find(Jt=>at.includes(Jt.id))?.name);const Ht=(Me?.assignments||[]).map($t=>({...$t,effectiveIsCheckedIn:$t.isCheckedIn&&!Oo($t.checkInTime)})).sort(($t,Jt)=>($t.marshalName||"").localeCompare(Jt.marshalName||"",void 0,{sensitivity:"base"})),Vn=Ra.value.filter($t=>at.includes($t.areaId)&&(!$t.marshalId||$t.marshalId!==y.value)),Gn=new Set,At=Vn.filter($t=>{const Jt=JSON.stringify({name:$t.name||"",marshalId:$t.marshalId||"",role:$t.role||"",phone:$t.phone||"",email:$t.email||"",notes:$t.notes||""});return Gn.has(Jt)?!1:(Gn.add(Jt),!0)}).sort(($t,Jt)=>($t.marshalName||$t.name||"").localeCompare(Jt.marshalName||Jt.name||"",void 0,{sensitivity:"base"})),Tn=Ee.isCheckedIn&&!Oo(Ee.checkInTime);return{...Ee,location:Me,areaName:ft,areaIds:at,allMarshals:Ht,areaContacts:At,locationName:Me?.name||"Unknown Location",effectiveIsCheckedIn:Tn}})),{courseMapActions:Pa,handleCourseMapVisibilityChange:zt,handleCourseMapAction:ws,getCheckpointMapActions:Ks,handleCheckpointMapVisibilityChange:Js,handleCheckpointMapAction:Ys}=LU({userLocation:Be,assignmentsWithDetails:kn,courseMapRef:Ws}),Da=V(()=>K.value.length>0?K.value[0]:null),$n=V(()=>K.value.map(Ee=>Ee.locationId)),Ho=V(()=>kn.value.some(Ee=>Ee.location?.isDynamic||Ee.location?.IsDynamic)),lt=V(()=>kn.value.find(Ee=>Ee.location?.isDynamic||Ee.location?.IsDynamic)),_n=V(()=>{if(!X.value||!kn.value.length)return[];const Ee=new Date,Me=X.value.eventDate?new Date(X.value.eventDate):null;return kn.value.filter(at=>{if(at.effectiveIsCheckedIn||Ta.value.has(at.id))return!1;const ft=at.location;if(!ft)return!1;const Ct=ft.startTime?new Date(ft.startTime):Me;if(!Ct)return!1;let Ht;if(ft.endTime)Ht=new Date(ft.endTime);else if(Me)Ht=new Date(Me.getTime()+7200*1e3);else return!1;return Ee>=Ct&&Ee<Ht})});qe(_n,Ee=>{Ee.length>0&&!Ro.value&&(zn.value=Ee[0],Ro.value=!0)},{immediate:!0});const It=()=>{const Ee=zn.value;Ee&&(qs(Ee.id),He.value="assignments",In.value=Ee.id)},oo=V(()=>X.value?.route?(typeof X.value.route=="string"?JSON.parse(X.value.route):X.value.route)||[]:[]),vo=V(()=>!Da.value||!ne.value.length?null:ne.value.find(Ee=>Ee.id===Da.value.locationId)),mo=$([]),is=$(!1),go=V(()=>{const Ee=mo.value.filter(ft=>!ft.marshalId||ft.marshalId!==y.value),Me=new Set;return Ee.filter(ft=>{const Ct=JSON.stringify({name:ft.name||"",marshalId:ft.marshalId||"",role:ft.role||"",phone:ft.phone||"",email:ft.email||"",notes:ft.notes||""});return Me.has(Ct)?!1:(Me.add(Ct),!0)}).sort((ft,Ct)=>(ft.name||"").localeCompare(Ct.name||"",void 0,{sensitivity:"base"}))}),Xs=V(()=>go.value.filter(Ee=>Ee.showInEmergencyInfo)),Vo=V(()=>ve.value.filter(Ee=>Ee.showInEmergencyInfo)),Kt=V(()=>Xs.value.length>0||Vo.value.length>0),Go=(Ee,Me=[])=>{if(!ve.value||ve.value.length===0)return[];const at=ne.value.find(At=>At.id===Ee),ft=at?.areaIds||at?.AreaIds||[],Ct=Me.length>0?Me:ft,Ht=[],Vn=new Set;for(const At of ve.value){const Tn=At.noteId||At.NoteId||At.id;if(Vn.has(Tn))continue;const $t=At.scopeConfigurations||At.ScopeConfigurations||[];let Jt=!1;if($t.length>0)for(const Mn of $t){const jo=Mn.itemType||Mn.ItemType,jn=Mn.ids||Mn.Ids||[];if(jo==="Checkpoint"&&(jn.includes(Ee)||jn.includes("ALL_CHECKPOINTS"))){Jt=!0;break}if(jo==="Area"&&(jn.includes("ALL_AREAS")||Ct.length>0&&Ct.some(Ji=>jn.includes(Ji)))){Jt=!0;break}}else{const Mn=At.matchedScope||At.MatchedScope||"";["EveryoneInAreas","EveryAreaLead","EveryoneAtCheckpoints","Area","Checkpoint"].some(jn=>Mn.includes(jn)||Mn===jn)&&(Jt=!0)}Jt&&(Vn.add(Tn),Ht.push(At))}const Gn={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return Ht.sort((At,Tn)=>{const $t=At.isPinned||At.IsPinned,Jt=Tn.isPinned||Tn.IsPinned;if($t&&!Jt)return-1;if(!$t&&Jt)return 1;const Mn=Gn[At.priority||At.Priority||"Normal"]??3,jo=Gn[Tn.priority||Tn.Priority||"Normal"]??3;if(Mn!==jo)return Mn-jo;const jn=At.createdAt||At.CreatedAt,hi=Tn.createdAt||Tn.CreatedAt;return new Date(hi)-new Date(jn)})},Ra=$([]),Qs=(Ee,Me)=>Ee.localeCompare(Me,void 0,{numeric:!0,sensitivity:"base"}),Wi=V(()=>{if(!Mt.value)return[];const Ee=Mt.value.locationId;return ne.value.filter(Me=>Me.id!==Ee&&Me.latitude!==0&&Me.longitude!==0).sort((Me,at)=>Qs(Me.name,at.name))}),ci=V(()=>vo.value?{lat:vo.value.latitude,lng:vo.value.longitude}:Be.value?Be.value:ne.value.length>0?{lat:ne.value[0].latitude,lng:ne.value[0].longitude}:{lat:51.505,lng:-.09}),ea=async()=>{const Ee=s.params.eventId;if(console.log("Loading event data for:",{eventId:Ee,marshalId:y.value}),Pn()){console.log("Offline mode detected, attempting to load from cache...");const Ct=await wa(Ee);if(Ct){if(console.log("Loaded cached data from:",Ct.cachedAt),X.value=Ct.event,Q.value=Ct.areas||[],ne.value=Ct.locations||[],W.value=Ct.checklist||[],mo.value=Ct.contacts||[],ve.value=Ct.notes||[],Ct.areaLeadDashboard?.checkpoints&&(Ve.value=Ct.areaLeadDashboard.checkpoints),X.value&&xu(X.value),y.value){const Ht=[];for(const Vn of ne.value){const Gn=Vn.assignments?.find(At=>At.marshalId===y.value);Gn&&Ht.push(Gn)}K.value=Ht}return}else console.warn("No cached data available while offline")}console.log("Fetching event data in parallel...");const[Me,at,ft]=await Promise.allSettled([ya.getById(Ee),ka.getByEvent(Ee),hl.getEventStatus(Ee)]);if(Me.status==="fulfilled"?(X.value=Me.value.data,console.log("Event loaded:",X.value?.name),X.value&&(xu(X.value),R(Ee,X.value.name,X.value.eventDate))):console.error("Failed to load event:",Me.reason),at.status==="fulfilled"?(Q.value=at.value.data||[],console.log("Areas loaded:",Q.value.length)):console.error("Failed to load areas:",at.reason),ft.status==="fulfilled"){if(ne.value=ft.value.data?.locations||[],console.log("Locations loaded:",ne.value.length),y.value){const Ct=[];for(const Ht of ne.value){const Vn=Ht.assignments?.find(Gn=>Gn.marshalId===y.value);Vn&&Ct.push(Vn)}K.value=Ct,console.log("Total assignments found:",K.value.length)}}else console.error("Failed to load event status:",ft.reason);await Promise.allSettled([se(),gt(),ta(),Fo()]);try{const Ct=JSON.parse(JSON.stringify({event:X.value,areas:Q.value,locations:ne.value,checklist:W.value,contacts:mo.value,notes:ve.value,marshalId:y.value}));await Ol(Ee,Ct),console.log("Event data cached for offline access")}catch(Ct){console.warn("Failed to cache event data:",Ct)}no()};u.onAuthSuccess=ea;const ui=async()=>{const Ee=s.params.eventId;if(Pn()){console.log("Skipping background preload: offline");return}console.log("Starting background preload for offline data...");try{const Me=await ka.getAreaLeadDashboard(Ee);if(Me.data){Ve.value=Me.data.checkpoints||[];const at=JSON.parse(JSON.stringify({areas:Me.data.areas||[],checkpoints:Me.data.checkpoints||[]}));await wa(Ee)?await wr(Ee,"areaLeadDashboard",at):await Ol(Ee,{areaLeadDashboard:at}),console.log("Area lead dashboard cached for offline access")}}catch(Me){Me.response?.status!==403&&console.warn("Failed to preload area lead dashboard:",Me)}console.log("Background preload complete")},ta=async()=>{const Ee=s.params.eventId;try{const Me=await Es.getMyNotes(Ee);ve.value=Me.data||[],be.value.notes=Date.now(),console.log("Notes loaded:",ve.value.length)}catch(Me){console.error("Failed to load notes:",Me)}},gt=async()=>{const Ee=s.params.eventId;is.value=!0;try{const Me=await fa.getMyContacts(Ee);mo.value=Me.data||[],be.value.eventContacts=Date.now(),console.log("Contacts loaded:",mo.value.length)}catch(Me){console.warn("Failed to load contacts:",Me),mo.value=[]}finally{is.value=!1}},Ki=()=>{Bo.value=!1,ho.value&&(ho.value(),ho.value=null)},bn=()=>{Bo.value=!1,ho.value=null},Cs=()=>{_s.value=!1},Oa=Ee=>{if(Qn.value&&Mt.value){Un(Mt.value.locationId,Ee.lat,Ee.lng,"manual"),Qn.value=!1,Mt.value=null;return}if(Ho.value&&lt.value){const Me=lt.value;on.value="Update location",So.value=`Update ${Me.location?.name||"dynamic checkpoint"} to this location?`,ho.value=async()=>{await Un(Me.locationId,Ee.lat,Ee.lng,"manual")},Bo.value=!0}},di=Ee=>{if(!Qn.value&&Ho.value&&lt.value){const Me=lt.value;if(Ee.id===Me.locationId)return;on.value="Copy location",So.value=`Copy location from "${Ee.name}" to ${Me.location?.name||"your dynamic checkpoint"}?`,ho.value=async()=>{await Un(Me.locationId,Ee.latitude,Ee.longitude,"checkpoint",Ee.id)},Bo.value=!0}},na=()=>{D(()=>{K.value=[],W.value=[],Ra.value=[]})},Ba=Ee=>Ee?new Date(Ee).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return nn(async()=>{const Ee=s.params.eventId,Me=s.query.code;he.value=!0;try{Me?await A(Ee,Me):await x(Ee)&&await ea()}finally{he.value=!1}d.value&&(mt(),"requestIdleCallback"in window?requestIdleCallback(()=>{ui()},{timeout:5e3}):setTimeout(()=>{ui()},2e3))}),qe(d,Ee=>{Ee?mt():_t()}),qe(()=>s.query.code,async Ee=>{if(Ee&&d.value){he.value=!0;try{await A(s.params.eventId,Ee)}finally{he.value=!1}}}),qe(X,Ee=>{Ee&&(document.title=`OnTheDay App - ${t.value.person}`)},{immediate:!0}),xn(()=>{T(),ks(),Co()}),(Ee,Me)=>(v(),m("div",{class:"marshal-view",style:Qe(O(U))},[Ae(FO),r("header",{class:de(["header",`logo-${O(Ze)}`]),style:Qe(O(ee))},[O(Je)&&O(Ze)==="cover"?(v(),m("div",IU,[r("img",{src:O(Je),alt:"Event logo",class:"header-logo-cover-img"},null,8,$U)])):M("",!0),O(d)&&O(Ze)==="right"?(v(),m("button",{key:1,onClick:na,class:"btn-close-session btn-close-left",style:Qe({color:O(fe)}),title:"Close session"},"  ",4)):M("",!0),O(Je)&&O(Ze)==="left"?(v(),m("div",TU,[r("img",{src:O(Je),alt:"Event logo",class:"header-logo-img"},null,8,MU)])):M("",!0),r("div",AU,[r("div",{class:"header-title",style:Qe({color:O(fe)})},[X.value?(v(),m("h1",EU,C(X.value.name),1)):M("",!0),X.value?.eventDate?(v(),m("div",PU,C(Ba(X.value.eventDate)),1)):M("",!0)],4),O(d)?(v(),m("div",DU,[r("button",{onClick:Me[0]||(Me[0]=at=>fo.value=!0),class:"btn-header-action btn-report-incident"}," Report Incident "),Kt.value?(v(),m("button",{key:0,onClick:Me[1]||(Me[1]=at=>vn.value=!0),class:"btn-header-action btn-emergency"}," Emergency Info ")):M("",!0)])):M("",!0)]),O(Je)&&O(Ze)==="right"?(v(),m("div",RU,[r("img",{src:O(Je),alt:"Event logo",class:"header-logo-img"},null,8,OU)])):M("",!0),O(d)&&O(Ze)!=="right"?(v(),m("button",{key:4,onClick:na,class:"btn-close-session btn-close-right",style:Qe({color:O(fe)}),title:"Close session"},"  ",4)):M("",!0)],6),r("div",BU,[he.value?(v(),m("div",NU,[...Me[22]||(Me[22]=[r("div",{class:"loading"},"Loading...",-1)])])):!O(d)&&!O(f)?(v(),m("div",FU,[Me[23]||(Me[23]=r("h2",null,"Welcome",-1)),Me[24]||(Me[24]=r("p",{class:"instruction"},"Please use the login link sent to you to access your marshal dashboard.",-1)),O(p)?(v(),m("p",UU,"Authenticating...")):M("",!0)])):O(f)?(v(),m("div",zU,[Me[25]||(Me[25]=r("h2",null,"Login failed",-1)),r("p",HU,C(O(f)),1),Me[26]||(Me[26]=r("p",{class:"instruction"},"Please contact the event organiser for a new login link.",-1))])):(v(),m("div",VU,[O(S)||O(E)?(v(),m("div",GU,[r("div",jU,[O(g)?.email?(v(),m("span",ZU,C(O(g).email),1)):M("",!0)]),O(S)?(v(),m("div",qU,[r("button",{onClick:Me[2]||(Me[2]=(...at)=>O(F)&&O(F)(...at)),class:"btn-mode-switch"}," Switch to Admin ")])):O(E)?(v(),m("div",WU,[...Me[27]||(Me[27]=[r("span",{class:"reauth-hint",title:"Login via admin flow to access admin features"}," Admin access requires re-login ",-1)])])):M("",!0)])):M("",!0),r("div",KU,[Ae(gU,{ref:"assignmentsSectionRef","is-expanded":He.value==="assignments",assignments:kn.value,"expanded-checkpoint-id":In.value,"all-locations":ne.value,route:oo.value,"user-location":O(Be),"has-dynamic-assignment":Ho.value,"current-marshal-id":O(y),"current-marshal-name":O(_),"checking-in-id":O(Qt),"checking-in-assignment-id":O(Do),"check-in-error":O(uo),"checking-in-marshal-id":O(Qt),"expanded-marshal-id":po.value,"updating-location":O(Ft),"auto-update-enabled":O(Fn),"get-toolbar-actions":O(Ks),"is-area-lead-for-areas":qt,"get-notes-for-checkpoint":Go,onToggle:Me[3]||(Me[3]=at=>yn("assignments")),onToggleCheckpoint:Ea,onMapClick:Oa,onLocationClick:di,onActionClick:O(Ys),onVisibilityChange:O(Js),onUpdateLocation:O(fn),onCheckIn:Me[4]||(Me[4]=at=>O(Lo)(at,!0)),onToggleMarshal:zo,onMarshalCheckIn:Me[5]||(Me[5]=(at,ft)=>O(Lo)(at,!1,ft)),onToggleAutoUpdate:O(Zt)},null,8,["is-expanded","assignments","expanded-checkpoint-id","all-locations","route","user-location","has-dynamic-assignment","current-marshal-id","current-marshal-name","checking-in-id","checking-in-assignment-id","check-in-error","checking-in-marshal-id","expanded-marshal-id","updating-location","auto-update-enabled","get-toolbar-actions","onActionClick","onVisibilityChange","onUpdateLocation","onToggleAutoUpdate"]),Ae(jN,{loading:O(Y),error:O(pe),"is-expanded":He.value==="checklist","is-area-lead":O(w),"my-items":O(te),"area-items":O(Re),"area-items-with-local-state":O(Se),"visible-items":O(J),"grouped-items":O(Z),"completed-count":O(j),saving:O(Ce),"effective-group-by":O(ge),"expanded-group":O(le),locations:ne.value,areas:Q.value,marshals:O(we),"get-context-name":O(Oe),onToggle:Me[6]||(Me[6]=at=>yn("checklist")),onToggleItem:O(ce),onToggleGroup:O(Te)},null,8,["loading","error","is-expanded","is-area-lead","my-items","area-items","area-items-with-local-state","visible-items","grouped-items","completed-count","saving","effective-group-by","expanded-group","locations","areas","marshals","get-context-name","onToggleItem","onToggleGroup"]),Ae(XN,{"event-id":O(s).params.eventId,notes:ve.value,locations:ne.value,areas:Q.value,assignments:K.value,"is-expanded":He.value==="notes",onToggle:Me[7]||(Me[7]=at=>yn("notes")),onNotesChanged:ta},null,8,["event-id","notes","locations","areas","assignments","is-expanded"]),Ae(UB,{contacts:go.value,loading:is.value,"is-expanded":He.value==="eventContacts",onToggle:Me[8]||(Me[8]=at=>yn("eventContacts"))},null,8,["contacts","loading","is-expanded"]),Ae(JB,{incidents:O(No),loading:O(mn),"is-expanded":He.value==="incidents",onToggle:Me[9]||(Me[9]=at=>yn("incidents")),onSelectIncident:O(ht)},null,8,["incidents","loading","is-expanded","onSelectIncident"]),Ae(AF,{ref_key:"areaLeadSectionRef",ref:Le,"is-area-lead":O(w),"is-expanded":He.value==="areaLead",areas:B.value,"selected-filters":N.value,"filtered-area-ids":q.value,"event-id":O(s).params.eventId,"marshal-id":O(y),route:oo.value,onToggle:Me[10]||(Me[10]=at=>yn("areaLead")),onToggleFilter:P,onChecklistUpdated:O(se)},null,8,["is-area-lead","is-expanded","areas","selected-filters","filtered-area-ids","event-id","marshal-id","route","onChecklistUpdated"]),Ae(s7,{"is-area-lead":O(w),"is-expanded":He.value==="areaLeadMarshals",marshals:O(Ge),"expanded-marshal-id":O(re),"checking-in-marshal-id":O(Qt),"saving-task":O(me),onToggle:Me[11]||(Me[11]=at=>yn("areaLeadMarshals")),onToggleMarshal:O(St),onCheckIn:O(Zs),onToggleTask:O(Wt)},null,8,["is-area-lead","is-expanded","marshals","expanded-marshal-id","checking-in-marshal-id","saving-task","onToggleMarshal","onCheckIn","onToggleTask"]),Ae(c9,{ref_key:"routeSectionRef",ref:ri,"is-expanded":He.value==="map","user-location":O(Be),"selecting-location":O(Qn),"selecting-location-name":O(Mt)?.location?.name||"",locations:ne.value,route:oo.value,center:ci.value,"highlight-location-ids":$n.value,clickable:O(Qn)||Ho.value,"toolbar-actions":O(Pa),onToggle:Me[12]||(Me[12]=at=>yn("map")),onCancelSelect:O(eo),onMapClick:Oa,onLocationClick:di,onActionClick:O(ws),onVisibilityChange:O(zt)},null,8,["is-expanded","user-location","selecting-location","selecting-location-name","locations","route","center","highlight-location-ids","clickable","toolbar-actions","onCancelSelect","onActionClick","onVisibilityChange"]),Ae(rN,{"event-date":X.value?.eventDate,description:X.value?.description,"is-expanded":He.value==="eventDetails",onToggle:Me[13]||(Me[13]=at=>yn("eventDetails"))},null,8,["event-date","description","is-expanded"])])]))]),Ae(SO,{show:vn.value,contacts:Xs.value,notes:Vo.value,onClose:Me[14]||(Me[14]=at=>vn.value=!1)},null,8,["show","contacts","notes"]),Ae(em,{show:O(fo),"event-id":l.value||"",checkpoint:G.value,"initial-location":O(Be),checkpoints:ne.value,route:oo.value,onClose:Me[15]||(Me[15]=at=>fo.value=!1),onSubmit:O(Ma)},null,8,["show","event-id","checkpoint","initial-location","checkpoints","route","onSubmit"]),Ae(Qv,{show:O(Hn),incident:O($o),route:oo.value,checkpoints:ne.value,"can-manage":O(w),onClose:Me[16]||(Me[16]=at=>Hn.value=!1),onStatusChange:O(Ut),onOpenAddNote:O(Aa)},null,8,["show","incident","route","checkpoints","can-manage","onStatusChange","onOpenAddNote"]),Ae(Gt,{show:O(vt),title:"Add update",size:"small",onClose:O(Uo)},{footer:ze(()=>[r("div",YU,[r("button",{type:"button",class:"btn btn-secondary",onClick:Me[18]||(Me[18]=(...at)=>O(Uo)&&O(Uo)(...at))}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:Me[19]||(Me[19]=(...at)=>O(gn)&&O(gn)(...at)),disabled:!O(xt).trim()||O(To)},C(O(To)?"Adding...":"Add update"),9,XU)])]),default:ze(()=>[r("div",JU,[Ue(r("textarea",{"onUpdate:modelValue":Me[17]||(Me[17]=at=>Yt(xt)?xt.value=at:null),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[st,O(xt)]])])]),_:1},8,["show","onClose"]),Ae(Nl,{show:Bo.value,title:on.value,message:So.value,onConfirm:Ki,onCancel:bn},null,8,["show","title","message"]),Ae(Nl,{show:_s.value,title:xo.value,message:bs.value,"show-cancel":!1,onConfirm:Cs},null,8,["show","title","message"]),Ae(WO,{show:O(Ro),checkpoint:O(zn),"accent-button-style":O(et),onDismiss:Me[20]||(Me[20]=at=>O(qs)(O(zn)?.id)),onGoToCheckpoint:It},null,8,["show","checkpoint","accent-button-style"]),Ae(kB,{show:O(bt),assignment:O(Mt),"user-location":O(Be),"auto-update-enabled":O(Fn),updating:O(Ft),error:O(wt),success:O(Nt),"available-checkpoints":Wi.value,"accent-button-style":O(et),onClose:O(jt),onUpdateGps:O(to),onToggleAutoUpdate:Me[21]||(Me[21]=at=>O(Zt)(O(Mt))),onSelectOnMap:ie,onCopyFromCheckpoint:O(pn)},null,8,["show","assignment","user-location","auto-update-enabled","updating","error","success","available-checkpoints","accent-button-style","onClose","onUpdateGps","onCopyFromCheckpoint"])],4))}},tz=je(ez,[["__scopeId","data-v-b0daea3c"]]),nz={class:"form-group"},oz={class:"form-group"},sz={class:"form-group"},az={class:"actions-left"},iz={__name:"EditProfileModal",props:{show:{type:Boolean,default:!1},profile:{type:Object,default:null},isDirty:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3},showLogout:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty","logout"],setup(e,{emit:t}){const o=e,a=t,s=$({name:"",email:"",phone:""});qe(()=>o.profile,p=>{p&&(s.value={name:p.name||"",email:p.email||"",phone:p.phone||""})},{immediate:!0,deep:!0}),qe(()=>o.show,p=>{p&&o.profile&&(s.value={name:o.profile.name||"",email:o.profile.email||"",phone:o.profile.phone||""})});const i=()=>{a("update:isDirty",!0)},l=()=>{if(!s.value.name.trim()){alert("Name is required");return}if(!s.value.email.trim()){alert("Email is required");return}a("submit",{name:s.value.name.trim(),email:s.value.email.trim(),phone:s.value.phone?.trim()||""})},u=()=>{a("close")},d=()=>{a("logout")};return(p,f)=>(v(),We(Gt,{show:e.show,title:"Edit profile",size:"medium","z-index":e.zIndex,"confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:ze(()=>[r("div",az,[e.showLogout?(v(),m("button",{key:0,type:"button",onClick:d,class:"btn btn-danger"}," Log out ")):M("",!0)]),r("button",{type:"button",onClick:l,class:"btn btn-success"}," Save ")]),default:ze(()=>[r("form",{onSubmit:rt(l,["prevent"])},[r("div",nz,[f[3]||(f[3]=r("label",null,"Name *",-1)),Ue(r("input",{"onUpdate:modelValue":f[0]||(f[0]=g=>s.value.name=g),type:"text",required:"",class:"form-input",placeholder:"Your name",onInput:i},null,544),[[st,s.value.name]])]),r("div",oz,[f[4]||(f[4]=r("label",null,"Email *",-1)),Ue(r("input",{"onUpdate:modelValue":f[1]||(f[1]=g=>s.value.email=g),type:"email",required:"",class:"form-input",placeholder:"Your email address",onInput:i},null,544),[[st,s.value.email]])]),r("div",sz,[f[5]||(f[5]=r("label",null,"Phone",-1)),Ue(r("input",{"onUpdate:modelValue":f[2]||(f[2]=g=>s.value.phone=g),type:"tel",class:"form-input",placeholder:"Your phone number",onInput:i},null,544),[[st,s.value.phone]])])],32)]),_:1},8,["show","z-index","is-dirty"]))}},lz=je(iz,[["__scopeId","data-v-178e5f48"]]),rz={class:"tabs"},cz={class:"tab-content"},uz={class:"form-group"},dz={class:"form-group"},hz={class:"form-group"},fz={class:"form-group"},pz=["value"],vz={class:"tab-content"},mz={class:"emergency-contacts-section"},gz={key:0,class:"empty-state"},yz={class:"card-header"},kz=["onClick"],_z={class:"form-group"},bz=["onUpdate:modelValue"],wz={class:"form-group"},Cz=["onUpdate:modelValue"],Lz={class:"form-group"},Sz=["onUpdate:modelValue"],xz={__name:"EventFormModal",props:{show:{type:Boolean,default:!1},eventData:{type:Object,default:()=>({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]})},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const o=e,a=t,{activeTab:s,switchTab:i,resetTab:l}=Fv("basic",["basic","emergency"]),u=$({...o.eventData});qe(()=>o.eventData,y=>{u.value={...y},u.value.emergencyContacts||(u.value.emergencyContacts=[])},{deep:!0}),qe(()=>o.show,y=>{y&&l()});const d=()=>{u.value.emergencyContacts.push({name:"",phone:"",details:""})},p=y=>{u.value.emergencyContacts.splice(y,1)},f=()=>{a("submit",{...u.value})},g=()=>{a("close")};return(y,_)=>(v(),We(Gt,{show:e.show,title:e.isEditing?"Edit event":"Create new event",size:"large",onClose:g},{"tab-header":ze(()=>[r("div",rz,[r("button",{type:"button",onClick:_[0]||(_[0]=k=>O(i)("basic")),class:de(["tab-button",{active:O(s)==="basic"}])}," Basic details ",2),r("button",{type:"button",onClick:_[1]||(_[1]=k=>O(i)("emergency")),class:de(["tab-button",{active:O(s)==="emergency"}])}," Emergency contacts ",2)])]),actions:ze(()=>[r("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-success"}," Save ")]),default:ze(()=>[r("form",{onSubmit:rt(f,["prevent"])},[Ue(r("div",cz,[r("div",uz,[_[6]||(_[6]=r("label",null,"Event name *",-1)),Ue(r("input",{"onUpdate:modelValue":_[2]||(_[2]=k=>u.value.name=k),type:"text",required:"",class:"form-input"},null,512),[[st,u.value.name]])]),r("div",dz,[_[7]||(_[7]=r("label",null,"Description",-1)),Ue(r("textarea",{"onUpdate:modelValue":_[3]||(_[3]=k=>u.value.description=k),rows:"3",class:"form-input"},null,512),[[st,u.value.description]])]),r("div",hz,[_[8]||(_[8]=r("label",null,"Event date *",-1)),Ue(r("input",{"onUpdate:modelValue":_[4]||(_[4]=k=>u.value.eventDate=k),type:"datetime-local",required:"",class:"form-input"},null,512),[[st,u.value.eventDate]])]),r("div",fz,[_[9]||(_[9]=r("label",null,"Time zone *",-1)),Ue(r("select",{"onUpdate:modelValue":_[5]||(_[5]=k=>u.value.timeZoneId=k),required:"",class:"form-input"},[(v(!0),m(xe,null,Ne(O(qv),k=>(v(),m("option",{key:k.value,value:k.value},C(k.label),9,pz))),128))],512),[[Bn,u.value.timeZoneId]])])],512),[[ys,O(s)==="basic"]]),Ue(r("div",vz,[r("div",mz,[r("div",{class:"section-header-small"},[_[10]||(_[10]=r("h3",null,"Emergency contacts",-1)),r("button",{type:"button",onClick:d,class:"btn btn-small btn-primary"}," Add contact ")]),u.value.emergencyContacts.length===0?(v(),m("div",gz,[..._[11]||(_[11]=[r("p",null,'No emergency contacts added yet. Click "Add contact" to add one.',-1)])])):M("",!0),(v(!0),m(xe,null,Ne(u.value.emergencyContacts,(k,w)=>(v(),m("div",{key:w,class:"emergency-contact-card"},[r("div",yz,[r("h4",null,"Contact "+C(w+1),1),r("button",{type:"button",onClick:S=>p(w),class:"btn-remove"},"  ",8,kz)]),r("div",_z,[_[12]||(_[12]=r("label",null,"Name *",-1)),Ue(r("input",{"onUpdate:modelValue":S=>k.name=S,type:"text",required:"",class:"form-input",placeholder:"Contact person name"},null,8,bz),[[st,k.name]])]),r("div",wz,[_[13]||(_[13]=r("label",null,"Phone *",-1)),Ue(r("input",{"onUpdate:modelValue":S=>k.phone=S,type:"tel",required:"",class:"form-input",placeholder:"+1 (555) 123-4567"},null,8,Cz),[[st,k.phone]])]),r("div",Lz,[_[14]||(_[14]=r("label",null,"Additional details",-1)),Ue(r("textarea",{"onUpdate:modelValue":S=>k.details=S,rows:"2",class:"form-input",placeholder:"Role, availability, or other important information..."},null,8,Sz),[[st,k.details]])])]))),128))])],512),[[ys,O(s)==="emergency"]])],32)]),_:1},8,["show","title"]))}},Iz=je(xz,[["__scopeId","data-v-d820eb4f"]]),$z=Yu("profile",()=>{const e=$(null),t=$(!1),o=$(null);return{profile:e,loading:t,error:o,fetchProfile:async()=>{t.value=!0,o.value=null;try{const d=await hr.getProfile();return e.value=d.data,d.data}catch(d){throw o.value=d.response?.data?.message||"Failed to load profile",d}finally{t.value=!1}},updateProfile:async d=>{t.value=!0,o.value=null;try{const p=await hr.updateProfile(d);return e.value=p.data,p.data}catch(p){throw o.value=p.response?.data?.message||"Failed to update profile",p}finally{t.value=!1}},fetchPerson:async(d,p)=>{t.value=!0,o.value=null;try{return(await hr.getPerson(d,p)).data}catch(f){throw o.value=f.response?.data?.message||"Failed to load person",f}finally{t.value=!1}},updatePerson:async(d,p,f)=>{t.value=!0,o.value=null;try{return(await hr.updatePerson(d,p,f)).data}catch(g){throw o.value=g.response?.data?.message||"Failed to update person",g}finally{t.value=!1}},clearProfile:()=>{e.value=null,o.value=null}}}),Tz={class:"sessions-view"},Mz={class:"sessions-container"},Az={key:0,class:"loading-state"},Ez={key:1,class:"empty-state"},Pz={key:2,class:"sessions-list"},Dz={class:"section-header"},Rz={class:"section-actions"},Oz=["onClick"],Bz={class:"session-info"},Nz={class:"event-name"},Fz={key:0,class:"event-date"},Uz={key:1,class:"sign-in-section"},zz={key:2,class:"section-header"},Hz=["onClick"],Vz={class:"session-info"},Gz={class:"event-name"},jz={class:"role-name"},Zz={key:0,class:"event-date"},qz=["onClick"],Wz={class:"modal-card"},Kz={class:"modal-actions"},Jz={class:"modal-card"},Yz={class:"modal-actions"},Xz={__name:"SessionsView",setup(e){const t=Vi(),o=Zl(),a=Nv(),s=$z(),i=$([]),l=$([]),u=$(!0),d=$(!1),p=$(!1),f=$(!1),g=$(!1),y=$(null),_=$(!1),k=$({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}),w=V(()=>localStorage.getItem("adminEmail")),S=V(()=>!!w.value),E=()=>{i.value=ok()},A=he=>{sv(he.eventId,he.marshalId),t.push(`/event/${he.eventId}`)},x=he=>{y.value=he,f.value=!0},D=async()=>{if(!y.value)return;const{sessionKey:he,eventId:U}=y.value;try{_o("marshal",U),await authApi.logout()}catch{}yu(he),_o(null),E(),f.value=!1,y.value=null},R=()=>{g.value=!0},F=async()=>{await o.logout(),l.value=[],g.value=!1},T=async()=>{if(p.value=!0,!s.profile)try{await s.fetchProfile()}catch(he){console.error("Failed to load profile:",he)}},N=async he=>{try{await s.updateProfile(he),p.value=!1}catch(U){console.error("Failed to save profile:",U),alert("Failed to save profile. Please try again.")}},B=async()=>{await o.logout(),l.value=[],p.value=!1},q=he=>he?new Date(he).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric"}):"",P=async()=>{if(S.value)try{_o("admin");const he=await ya.getAll();l.value=he.data||[]}catch(he){console.error("Failed to load admin events:",he),l.value=[]}},G=he=>{t.push(`/admin/event/${he}`)},X=()=>{t.push("/")},ne=()=>{},K=()=>{_.value=!1,k.value={name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}},Q=async he=>{try{const U={...he,adminEmail:o.adminEmail};await a.createEvent(U),K(),await P()}catch(U){console.error("Failed to create event:",U),alert("Failed to create event. Please try again.")}};return nn(async()=>{document.title="OnTheDay App - Sessions",iv(),av(),E(),await P(),u.value=!1}),(he,U)=>(v(),m("div",Tz,[r("div",Mz,[Ae(Ov,{title:"Your sessions"}),u.value?(v(),m("div",Az,[...U[9]||(U[9]=[r("p",null,"Loading sessions...",-1)])])):i.value.length===0&&l.value.length===0?(v(),m("div",Ez,[U[10]||(U[10]=r("p",null,"No active sessions.",-1)),U[11]||(U[11]=r("p",{class:"hint"},"Sign in to access your events, or use a login link from your event organiser.",-1)),r("button",{class:"btn btn-primary",onClick:U[0]||(U[0]=ee=>d.value=!0)}," Sign in ")])):(v(),m("div",Pz,[S.value?(v(),m(xe,{key:0},[r("div",Dz,[U[12]||(U[12]=r("span",{class:"section-label"},"Admin events",-1)),r("div",Rz,[r("button",{class:"btn btn-small btn-primary",onClick:T}," Profile "),r("button",{class:"btn btn-small btn-primary",onClick:U[1]||(U[1]=ee=>_.value=!0)}," Create event ")])]),(v(!0),m(xe,null,Ne(l.value,ee=>(v(),m("div",{key:"admin-"+ee.id,class:"session-card admin-card",onClick:fe=>G(ee.id)},[U[14]||(U[14]=r("div",{class:"card-icon admin-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"})])],-1)),r("div",Bz,[r("div",Nz,C(ee.name),1),U[13]||(U[13]=r("div",{class:"role-name"},"Admin",-1)),ee.eventDate?(v(),m("div",Fz,C(q(ee.eventDate)),1)):M("",!0)]),r("button",{class:"btn-logout",onClick:rt(R,["stop"]),title:"Log out as admin"},"  ")],8,Oz))),128))],64)):(v(),m("div",Uz,[r("button",{class:"btn btn-primary",onClick:U[2]||(U[2]=ee=>d.value=!0)}," Sign in ")])),i.value.length>0?(v(),m("div",zz,[...U[15]||(U[15]=[r("span",{class:"section-label"},"Marshal sessions",-1)])])):M("",!0),(v(!0),m(xe,null,Ne(i.value,ee=>(v(),m("div",{key:ee.sessionKey,class:"session-card",onClick:fe=>A(ee)},[U[16]||(U[16]=r("div",{class:"card-icon marshal-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})])],-1)),r("div",Vz,[r("div",Gz,C(ee.eventName||"Event"),1),r("div",jz,C(ee.marshalName||"Marshal"),1),ee.eventDate?(v(),m("div",Zz,C(q(ee.eventDate)),1)):M("",!0)]),r("button",{class:"btn-logout",onClick:rt(fe=>x(ee),["stop"]),title:"Log out from this session"},"  ",8,qz)],8,Hz))),128))])),r("button",{class:"btn-back-home",onClick:X,title:"Back to home"},"  ")]),Ae(Bv,{show:d.value,onClose:U[3]||(U[3]=ee=>d.value=!1),onSuccess:ne},null,8,["show"]),Ae(lz,{show:p.value,profile:O(s).profile,"show-logout":!0,onClose:U[4]||(U[4]=ee=>p.value=!1),onSubmit:N,onLogout:B},null,8,["show","profile"]),Ae(Iz,{show:_.value,"event-data":k.value,"is-editing":!1,onClose:K,onSubmit:Q},null,8,["show","event-data"]),(v(),We(Tl,{to:"body"},[Ae(gs,{name:"modal"},{default:ze(()=>[g.value?(v(),m("div",{key:0,class:"modal-overlay",onClick:U[6]||(U[6]=rt(ee=>g.value=!1,["self"]))},[r("div",Wz,[U[17]||(U[17]=r("h3",null,"Log out as admin?",-1)),U[18]||(U[18]=r("p",null,"This will log you out from all admin events.",-1)),U[19]||(U[19]=r("p",{class:"hint"},"You can log back in using the sign-in button.",-1)),r("div",Kz,[r("button",{class:"btn btn-secondary",onClick:U[5]||(U[5]=ee=>g.value=!1)},"Cancel"),r("button",{class:"btn btn-danger",onClick:F},"Log out")])])])):M("",!0)]),_:1})])),(v(),We(Tl,{to:"body"},[Ae(gs,{name:"modal"},{default:ze(()=>[f.value?(v(),m("div",{key:0,class:"modal-overlay",onClick:U[8]||(U[8]=rt(ee=>f.value=!1,["self"]))},[r("div",Jz,[U[22]||(U[22]=r("h3",null,"Log out from session?",-1)),r("p",null,[U[20]||(U[20]=Ye("This will log you out from ",-1)),r("strong",null,C(y.value?.eventName||"this event"),1),U[21]||(U[21]=Ye(".",-1))]),U[23]||(U[23]=r("p",{class:"hint"},"You can log back in using the link from your event organiser.",-1)),r("div",Yz,[r("button",{class:"btn btn-secondary",onClick:U[7]||(U[7]=ee=>f.value=!1)},"Cancel"),r("button",{class:"btn btn-danger",onClick:D},"Log out")])])])):M("",!0)]),_:1})]))]))}},Qz=je(Xz,[["__scopeId","data-v-add55e1c"]]);let vf=!1;function eH(){vf||(vf=!0,iv(),av())}const tH=[{path:"/",name:"Home",component:hb},{path:"/admin/login",name:"AdminLogin",component:_b},{path:"/admin/verify",name:"AdminVerify",component:Ib},{path:"/sessions",name:"Sessions",component:Qz},{path:"/admin/dashboard",redirect:"/sessions"},{path:"/admin/profile",redirect:"/sessions"},{path:"/admin/event/:eventId",name:"AdminEventManage",component:lO,meta:{requiresAuth:!0}},{path:"/marshal",redirect:"/sessions"},{path:"/event/:eventId",name:"MarshalView",component:tz},{path:"/:pathMatch(.*)*",redirect:"/"}],nm=ek({history:E1("/VolunteerCheckin/testing/"),routes:tH});nm.beforeEach((e,t,o)=>{eH();const a=localStorage.getItem("adminEmail");if(e.meta.requiresAuth&&!a){o({name:"AdminLogin"});return}if(e.meta.requiresAuth?_o("admin"):e.name!=="MarshalView"&&e.name!=="Sessions"&&_o(null),e.name==="MarshalView"){const s=e.params.eventId,i=!!e.query.code,l=Br(s),u=l?.marshalId?rv(s,l.marshalId):null;if(i){o();return}if(l?.token){o();return}if(u){o();return}if(lv()){o({name:"Sessions"});return}}o()});js().then(()=>{console.log("Offline database initialized")}).catch(e=>{console.warn("Failed to initialize offline database:",e)});const cd=Fy(tk);cd.use(Hy());cd.use(nm);cd.mount("#app");
