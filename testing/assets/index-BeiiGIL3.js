(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function o(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=o(s);fetch(s.href,a)}})();function Bc(e){const t=Object.create(null);for(const o of e.split(","))t[o]=1;return o=>o in t}const Lt={},ki=[],ho=()=>{},mh=()=>!1,Kr=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Nc=e=>e.startsWith("onUpdate:"),Gt=Object.assign,Fc=(e,t)=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},uv=Object.prototype.hasOwnProperty,gt=(e,t)=>uv.call(e,t),et=Array.isArray,bi=e=>Na(e)==="[object Map]",Ai=e=>Na(e)==="[object Set]",Ou=e=>Na(e)==="[object Date]",lt=e=>typeof e=="function",Nt=e=>typeof e=="string",Kn=e=>typeof e=="symbol",wt=e=>e!==null&&typeof e=="object",gh=e=>(wt(e)||lt(e))&&lt(e.then)&&lt(e.catch),yh=Object.prototype.toString,Na=e=>yh.call(e),dv=e=>Na(e).slice(8,-1),_h=e=>Na(e)==="[object Object]",Yr=e=>Nt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,ga=Bc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Jr=e=>{const t=Object.create(null);return(o=>t[o]||(t[o]=e(o)))},hv=/-\w/g,Nn=Jr(e=>e.replace(hv,t=>t.slice(1).toUpperCase())),fv=/\B([A-Z])/g,ys=Jr(e=>e.replace(fv,"-$1").toLowerCase()),Xr=Jr(e=>e.charAt(0).toUpperCase()+e.slice(1)),Fl=Jr(e=>e?`on${Xr(e)}`:""),fs=(e,t)=>!Object.is(e,t),Sr=(e,...t)=>{for(let o=0;o<e.length;o++)e[o](...t)},kh=(e,t,o,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:o})},Qr=e=>{const t=parseFloat(e);return isNaN(t)?e:t},pv=e=>{const t=Nt(e)?Number(e):NaN;return isNaN(t)?e:t};let Ru;const el=()=>Ru||(Ru=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Dt(e){if(et(e)){const t={};for(let o=0;o<e.length;o++){const i=e[o],s=Nt(i)?yv(i):Dt(i);if(s)for(const a in s)t[a]=s[a]}return t}else if(Nt(e)||wt(e))return e}const vv=/;(?![^(]*\))/g,mv=/:([^]+)/,gv=/\/\*[^]*?\*\//g;function yv(e){const t={};return e.replace(gv,"").split(vv).forEach(o=>{if(o){const i=o.split(mv);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function Ae(e){let t="";if(Nt(e))t=e;else if(et(e))for(let o=0;o<e.length;o++){const i=Ae(e[o]);i&&(t+=i+" ")}else if(wt(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}const _v="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",kv=Bc(_v);function bh(e){return!!e||e===""}function bv(e,t){if(e.length!==t.length)return!1;let o=!0;for(let i=0;o&&i<e.length;i++)o=Ws(e[i],t[i]);return o}function Ws(e,t){if(e===t)return!0;let o=Ou(e),i=Ou(t);if(o||i)return o&&i?e.getTime()===t.getTime():!1;if(o=Kn(e),i=Kn(t),o||i)return e===t;if(o=et(e),i=et(t),o||i)return o&&i?bv(e,t):!1;if(o=wt(e),i=wt(t),o||i){if(!o||!i)return!1;const s=Object.keys(e).length,a=Object.keys(t).length;if(s!==a)return!1;for(const l in e){const u=e.hasOwnProperty(l),h=t.hasOwnProperty(l);if(u&&!h||!u&&h||!Ws(e[l],t[l]))return!1}}return String(e)===String(t)}function zc(e,t){return e.findIndex(o=>Ws(o,t))}const wh=e=>!!(e&&e.__v_isRef===!0),w=e=>Nt(e)?e:e==null?"":et(e)||wt(e)&&(e.toString===yh||!lt(e.toString))?wh(e)?w(e.value):JSON.stringify(e,Ch,2):String(e),Ch=(e,t)=>wh(t)?Ch(e,t.value):bi(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((o,[i,s],a)=>(o[zl(i,a)+" =>"]=s,o),{})}:Ai(t)?{[`Set(${t.size})`]:[...t.values()].map(o=>zl(o))}:Kn(t)?zl(t):wt(t)&&!et(t)&&!_h(t)?String(t):t,zl=(e,t="")=>{var o;return Kn(e)?`Symbol(${(o=e.description)!=null?o:t})`:e};let en;class Lh{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=en,!t&&en&&(this.index=(en.scopes||(en.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].pause();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].resume();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].resume()}}run(t){if(this._active){const o=en;try{return en=this,t()}finally{en=o}}}on(){++this._on===1&&(this.prevScope=en,en=this)}off(){this._on>0&&--this._on===0&&(en=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let o,i;for(o=0,i=this.effects.length;o<i;o++)this.effects[o].stop();for(this.effects.length=0,o=0,i=this.cleanups.length;o<i;o++)this.cleanups[o]();if(this.cleanups.length=0,this.scopes){for(o=0,i=this.scopes.length;o<i;o++)this.scopes[o].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function Sh(e){return new Lh(e)}function xh(){return en}function wv(e,t=!1){en&&en.cleanups.push(e)}let xt;const Ul=new WeakSet;class Th{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,en&&en.active&&en.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Ul.has(this)&&(Ul.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||$h(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Bu(this),Mh(this);const t=xt,o=Gn;xt=this,Gn=!0;try{return this.fn()}finally{Ah(this),xt=t,Gn=o,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Vc(t);this.deps=this.depsTail=void 0,Bu(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Ul.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){lc(this)&&this.run()}get dirty(){return lc(this)}}let Ih=0,ya,_a;function $h(e,t=!1){if(e.flags|=8,t){e.next=_a,_a=e;return}e.next=ya,ya=e}function Uc(){Ih++}function Hc(){if(--Ih>0)return;if(_a){let t=_a;for(_a=void 0;t;){const o=t.next;t.next=void 0,t.flags&=-9,t=o}}let e;for(;ya;){let t=ya;for(ya=void 0;t;){const o=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){e||(e=i)}t=o}}if(e)throw e}function Mh(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Ah(e){let t,o=e.depsTail,i=o;for(;i;){const s=i.prevDep;i.version===-1?(i===o&&(o=s),Vc(i),Cv(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=s}e.deps=t,e.depsTail=o}function lc(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Eh(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Eh(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===xa)||(e.globalVersion=xa,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!lc(e))))return;e.flags|=2;const t=e.dep,o=xt,i=Gn;xt=e,Gn=!0;try{Mh(e);const s=e.fn(e._value);(t.version===0||fs(s,e._value))&&(e.flags|=128,e._value=s,t.version++)}catch(s){throw t.version++,s}finally{xt=o,Gn=i,Ah(e),e.flags&=-3}}function Vc(e,t=!1){const{dep:o,prevSub:i,nextSub:s}=e;if(i&&(i.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=i,e.nextSub=void 0),o.subs===e&&(o.subs=i,!i&&o.computed)){o.computed.flags&=-5;for(let a=o.computed.deps;a;a=a.nextDep)Vc(a,!0)}!t&&!--o.sc&&o.map&&o.map.delete(o.key)}function Cv(e){const{prevDep:t,nextDep:o}=e;t&&(t.nextDep=o,e.prevDep=void 0),o&&(o.prevDep=t,e.nextDep=void 0)}let Gn=!0;const Ph=[];function zo(){Ph.push(Gn),Gn=!1}function Uo(){const e=Ph.pop();Gn=e===void 0?!0:e}function Bu(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const o=xt;xt=void 0;try{t()}finally{xt=o}}}let xa=0;class Lv{constructor(t,o){this.sub=t,this.dep=o,this.version=o.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Zc{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!xt||!Gn||xt===this.computed)return;let o=this.activeLink;if(o===void 0||o.sub!==xt)o=this.activeLink=new Lv(xt,this),xt.deps?(o.prevDep=xt.depsTail,xt.depsTail.nextDep=o,xt.depsTail=o):xt.deps=xt.depsTail=o,Dh(o);else if(o.version===-1&&(o.version=this.version,o.nextDep)){const i=o.nextDep;i.prevDep=o.prevDep,o.prevDep&&(o.prevDep.nextDep=i),o.prevDep=xt.depsTail,o.nextDep=void 0,xt.depsTail.nextDep=o,xt.depsTail=o,xt.deps===o&&(xt.deps=i)}return o}trigger(t){this.version++,xa++,this.notify(t)}notify(t){Uc();try{for(let o=this.subs;o;o=o.prevSub)o.sub.notify()&&o.sub.dep.notify()}finally{Hc()}}}function Dh(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)Dh(i)}const o=e.dep.subs;o!==e&&(e.prevSub=o,o&&(o.nextSub=e)),e.dep.subs=e}}const Or=new WeakMap,Hs=Symbol(""),cc=Symbol(""),Ta=Symbol("");function nn(e,t,o){if(Gn&&xt){let i=Or.get(e);i||Or.set(e,i=new Map);let s=i.get(o);s||(i.set(o,s=new Zc),s.map=i,s.key=o),s.track()}}function Po(e,t,o,i,s,a){const l=Or.get(e);if(!l){xa++;return}const u=h=>{h&&h.trigger()};if(Uc(),t==="clear")l.forEach(u);else{const h=et(e),f=h&&Yr(o);if(h&&o==="length"){const p=Number(i);l.forEach((g,b)=>{(b==="length"||b===Ta||!Kn(b)&&b>=p)&&u(g)})}else switch((o!==void 0||l.has(void 0))&&u(l.get(o)),f&&u(l.get(Ta)),t){case"add":h?f&&u(l.get("length")):(u(l.get(Hs)),bi(e)&&u(l.get(cc)));break;case"delete":h||(u(l.get(Hs)),bi(e)&&u(l.get(cc)));break;case"set":bi(e)&&u(l.get(Hs));break}}Hc()}function Sv(e,t){const o=Or.get(e);return o&&o.get(t)}function fi(e){const t=vt(e);return t===e?t:(nn(t,"iterate",Ta),In(e)?t:t.map(Yn))}function tl(e){return nn(e=vt(e),"iterate",Ta),e}function as(e,t){return Ho(e)?Fo(e)?Si(Yn(t)):Si(t):Yn(t)}const xv={__proto__:null,[Symbol.iterator](){return Hl(this,Symbol.iterator,e=>as(this,e))},concat(...e){return fi(this).concat(...e.map(t=>et(t)?fi(t):t))},entries(){return Hl(this,"entries",e=>(e[1]=as(this,e[1]),e))},every(e,t){return To(this,"every",e,t,void 0,arguments)},filter(e,t){return To(this,"filter",e,t,o=>o.map(i=>as(this,i)),arguments)},find(e,t){return To(this,"find",e,t,o=>as(this,o),arguments)},findIndex(e,t){return To(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return To(this,"findLast",e,t,o=>as(this,o),arguments)},findLastIndex(e,t){return To(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return To(this,"forEach",e,t,void 0,arguments)},includes(...e){return Vl(this,"includes",e)},indexOf(...e){return Vl(this,"indexOf",e)},join(e){return fi(this).join(e)},lastIndexOf(...e){return Vl(this,"lastIndexOf",e)},map(e,t){return To(this,"map",e,t,void 0,arguments)},pop(){return aa(this,"pop")},push(...e){return aa(this,"push",e)},reduce(e,...t){return Nu(this,"reduce",e,t)},reduceRight(e,...t){return Nu(this,"reduceRight",e,t)},shift(){return aa(this,"shift")},some(e,t){return To(this,"some",e,t,void 0,arguments)},splice(...e){return aa(this,"splice",e)},toReversed(){return fi(this).toReversed()},toSorted(e){return fi(this).toSorted(e)},toSpliced(...e){return fi(this).toSpliced(...e)},unshift(...e){return aa(this,"unshift",e)},values(){return Hl(this,"values",e=>as(this,e))}};function Hl(e,t,o){const i=tl(e),s=i[t]();return i!==e&&!In(e)&&(s._next=s.next,s.next=()=>{const a=s._next();return a.done||(a.value=o(a.value)),a}),s}const Tv=Array.prototype;function To(e,t,o,i,s,a){const l=tl(e),u=l!==e&&!In(e),h=l[t];if(h!==Tv[t]){const g=h.apply(e,a);return u?Yn(g):g}let f=o;l!==e&&(u?f=function(g,b){return o.call(this,as(e,g),b,e)}:o.length>2&&(f=function(g,b){return o.call(this,g,b,e)}));const p=h.call(l,f,i);return u&&s?s(p):p}function Nu(e,t,o,i){const s=tl(e);let a=o;return s!==e&&(In(e)?o.length>3&&(a=function(l,u,h){return o.call(this,l,u,h,e)}):a=function(l,u,h){return o.call(this,l,as(e,u),h,e)}),s[t](a,...i)}function Vl(e,t,o){const i=vt(e);nn(i,"iterate",Ta);const s=i[t](...o);return(s===-1||s===!1)&&nl(o[0])?(o[0]=vt(o[0]),i[t](...o)):s}function aa(e,t,o=[]){zo(),Uc();const i=vt(e)[t].apply(e,o);return Hc(),Uo(),i}const Iv=Bc("__proto__,__v_isRef,__isVue"),Oh=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Kn));function $v(e){Kn(e)||(e=String(e));const t=vt(this);return nn(t,"has",e),t.hasOwnProperty(e)}class Rh{constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,i){if(o==="__v_skip")return t.__v_skip;const s=this._isReadonly,a=this._isShallow;if(o==="__v_isReactive")return!s;if(o==="__v_isReadonly")return s;if(o==="__v_isShallow")return a;if(o==="__v_raw")return i===(s?a?Fv:zh:a?Fh:Nh).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const l=et(t);if(!s){let h;if(l&&(h=xv[o]))return h;if(o==="hasOwnProperty")return $v}const u=Reflect.get(t,o,Bt(t)?t:i);if((Kn(o)?Oh.has(o):Iv(o))||(s||nn(t,"get",o),a))return u;if(Bt(u)){const h=l&&Yr(o)?u:u.value;return s&&wt(h)?dc(h):h}return wt(u)?s?dc(u):Fa(u):u}}class Bh extends Rh{constructor(t=!1){super(!1,t)}set(t,o,i,s){let a=t[o];const l=et(t)&&Yr(o);if(!this._isShallow){const f=Ho(a);if(!In(i)&&!Ho(i)&&(a=vt(a),i=vt(i)),!l&&Bt(a)&&!Bt(i))return f||(a.value=i),!0}const u=l?Number(o)<t.length:gt(t,o),h=Reflect.set(t,o,i,Bt(t)?t:s);return t===vt(s)&&(u?fs(i,a)&&Po(t,"set",o,i):Po(t,"add",o,i)),h}deleteProperty(t,o){const i=gt(t,o);t[o];const s=Reflect.deleteProperty(t,o);return s&&i&&Po(t,"delete",o,void 0),s}has(t,o){const i=Reflect.has(t,o);return(!Kn(o)||!Oh.has(o))&&nn(t,"has",o),i}ownKeys(t){return nn(t,"iterate",et(t)?"length":Hs),Reflect.ownKeys(t)}}class Mv extends Rh{constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const Av=new Bh,Ev=new Mv,Pv=new Bh(!0);const uc=e=>e,vr=e=>Reflect.getPrototypeOf(e);function Dv(e,t,o){return function(...i){const s=this.__v_raw,a=vt(s),l=bi(a),u=e==="entries"||e===Symbol.iterator&&l,h=e==="keys"&&l,f=s[e](...i),p=o?uc:t?Si:Yn;return!t&&nn(a,"iterate",h?cc:Hs),{next(){const{value:g,done:b}=f.next();return b?{value:g,done:b}:{value:u?[p(g[0]),p(g[1])]:p(g),done:b}},[Symbol.iterator](){return this}}}}function mr(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Ov(e,t){const o={get(s){const a=this.__v_raw,l=vt(a),u=vt(s);e||(fs(s,u)&&nn(l,"get",s),nn(l,"get",u));const{has:h}=vr(l),f=t?uc:e?Si:Yn;if(h.call(l,s))return f(a.get(s));if(h.call(l,u))return f(a.get(u));a!==l&&a.get(s)},get size(){const s=this.__v_raw;return!e&&nn(vt(s),"iterate",Hs),s.size},has(s){const a=this.__v_raw,l=vt(a),u=vt(s);return e||(fs(s,u)&&nn(l,"has",s),nn(l,"has",u)),s===u?a.has(s):a.has(s)||a.has(u)},forEach(s,a){const l=this,u=l.__v_raw,h=vt(u),f=t?uc:e?Si:Yn;return!e&&nn(h,"iterate",Hs),u.forEach((p,g)=>s.call(a,f(p),f(g),l))}};return Gt(o,e?{add:mr("add"),set:mr("set"),delete:mr("delete"),clear:mr("clear")}:{add(s){!t&&!In(s)&&!Ho(s)&&(s=vt(s));const a=vt(this);return vr(a).has.call(a,s)||(a.add(s),Po(a,"add",s,s)),this},set(s,a){!t&&!In(a)&&!Ho(a)&&(a=vt(a));const l=vt(this),{has:u,get:h}=vr(l);let f=u.call(l,s);f||(s=vt(s),f=u.call(l,s));const p=h.call(l,s);return l.set(s,a),f?fs(a,p)&&Po(l,"set",s,a):Po(l,"add",s,a),this},delete(s){const a=vt(this),{has:l,get:u}=vr(a);let h=l.call(a,s);h||(s=vt(s),h=l.call(a,s)),u&&u.call(a,s);const f=a.delete(s);return h&&Po(a,"delete",s,void 0),f},clear(){const s=vt(this),a=s.size!==0,l=s.clear();return a&&Po(s,"clear",void 0,void 0),l}}),["keys","values","entries",Symbol.iterator].forEach(s=>{o[s]=Dv(s,e,t)}),o}function jc(e,t){const o=Ov(e,t);return(i,s,a)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?i:Reflect.get(gt(o,s)&&s in i?o:i,s,a)}const Rv={get:jc(!1,!1)},Bv={get:jc(!1,!0)},Nv={get:jc(!0,!1)};const Nh=new WeakMap,Fh=new WeakMap,zh=new WeakMap,Fv=new WeakMap;function zv(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Uv(e){return e.__v_skip||!Object.isExtensible(e)?0:zv(dv(e))}function Fa(e){return Ho(e)?e:Wc(e,!1,Av,Rv,Nh)}function Uh(e){return Wc(e,!1,Pv,Bv,Fh)}function dc(e){return Wc(e,!0,Ev,Nv,zh)}function Wc(e,t,o,i,s){if(!wt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=Uv(e);if(a===0)return e;const l=s.get(e);if(l)return l;const u=new Proxy(e,a===2?i:o);return s.set(e,u),u}function Fo(e){return Ho(e)?Fo(e.__v_raw):!!(e&&e.__v_isReactive)}function Ho(e){return!!(e&&e.__v_isReadonly)}function In(e){return!!(e&&e.__v_isShallow)}function nl(e){return e?!!e.__v_raw:!1}function vt(e){const t=e&&e.__v_raw;return t?vt(t):e}function qc(e){return!gt(e,"__v_skip")&&Object.isExtensible(e)&&kh(e,"__v_skip",!0),e}const Yn=e=>wt(e)?Fa(e):e,Si=e=>wt(e)?dc(e):e;function Bt(e){return e?e.__v_isRef===!0:!1}function O(e){return Hh(e,!1)}function Hv(e){return Hh(e,!0)}function Hh(e,t){return Bt(e)?e:new Vv(e,t)}class Vv{constructor(t,o){this.dep=new Zc,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=o?t:vt(t),this._value=o?t:Yn(t),this.__v_isShallow=o}get value(){return this.dep.track(),this._value}set value(t){const o=this._rawValue,i=this.__v_isShallow||In(t)||Ho(t);t=i?t:vt(t),fs(t,o)&&(this._rawValue=t,this._value=i?t:Yn(t),this.dep.trigger())}}function V(e){return Bt(e)?e.value:e}const Zv={get:(e,t,o)=>t==="__v_raw"?e:V(Reflect.get(e,t,o)),set:(e,t,o,i)=>{const s=e[t];return Bt(s)&&!Bt(o)?(s.value=o,!0):Reflect.set(e,t,o,i)}};function Vh(e){return Fo(e)?e:new Proxy(e,Zv)}function jv(e){const t=et(e)?new Array(e.length):{};for(const o in e)t[o]=qv(e,o);return t}class Wv{constructor(t,o,i){this._object=t,this._key=o,this._defaultValue=i,this.__v_isRef=!0,this._value=void 0,this._raw=vt(t);let s=!0,a=t;if(!et(t)||!Yr(String(o)))do s=!nl(a)||In(a);while(s&&(a=a.__v_raw));this._shallow=s}get value(){let t=this._object[this._key];return this._shallow&&(t=V(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&Bt(this._raw[this._key])){const o=this._object[this._key];if(Bt(o)){o.value=t;return}}this._object[this._key]=t}get dep(){return Sv(this._raw,this._key)}}function qv(e,t,o){return new Wv(e,t,o)}class Gv{constructor(t,o,i){this.fn=t,this.setter=o,this._value=void 0,this.dep=new Zc(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=xa-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!o,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&xt!==this)return $h(this,!0),!0}get value(){const t=this.dep.track();return Eh(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Kv(e,t,o=!1){let i,s;return lt(e)?i=e:(i=e.get,s=e.set),new Gv(i,s,o)}const gr={},Rr=new WeakMap;let Ds;function Yv(e,t=!1,o=Ds){if(o){let i=Rr.get(o);i||Rr.set(o,i=[]),i.push(e)}}function Jv(e,t,o=Lt){const{immediate:i,deep:s,once:a,scheduler:l,augmentJob:u,call:h}=o,f=A=>s?A:In(A)||s===!1||s===0?Do(A,1):Do(A);let p,g,b,S,T=!1,_=!1;if(Bt(e)?(g=()=>e.value,T=In(e)):Fo(e)?(g=()=>f(e),T=!0):et(e)?(_=!0,T=e.some(A=>Fo(A)||In(A)),g=()=>e.map(A=>{if(Bt(A))return A.value;if(Fo(A))return f(A);if(lt(A))return h?h(A,2):A()})):lt(e)?t?g=h?()=>h(e,2):e:g=()=>{if(b){zo();try{b()}finally{Uo()}}const A=Ds;Ds=p;try{return h?h(e,3,[S]):e(S)}finally{Ds=A}}:g=ho,t&&s){const A=g,I=s===!0?1/0:s;g=()=>Do(A(),I)}const D=xh(),M=()=>{p.stop(),D&&D.active&&Fc(D.effects,p)};if(a&&t){const A=t;t=(...I)=>{A(...I),M()}}let x=_?new Array(e.length).fill(gr):gr;const C=A=>{if(!(!(p.flags&1)||!p.dirty&&!A))if(t){const I=p.run();if(s||T||(_?I.some(($,E)=>fs($,x[E])):fs(I,x))){b&&b();const $=Ds;Ds=p;try{const E=[I,x===gr?void 0:_&&x[0]===gr?[]:x,S];x=I,h?h(t,3,E):t(...E)}finally{Ds=$}}}else p.run()};return u&&u(C),p=new Th(g),p.scheduler=l?()=>l(C,!1):C,S=A=>Yv(A,!1,p),b=p.onStop=()=>{const A=Rr.get(p);if(A){if(h)h(A,4);else for(const I of A)I();Rr.delete(p)}},t?i?C(!0):x=p.run():l?l(C.bind(null,!0),!0):p.run(),M.pause=p.pause.bind(p),M.resume=p.resume.bind(p),M.stop=M,M}function Do(e,t=1/0,o){if(t<=0||!wt(e)||e.__v_skip||(o=o||new Map,(o.get(e)||0)>=t))return e;if(o.set(e,t),t--,Bt(e))Do(e.value,t,o);else if(et(e))for(let i=0;i<e.length;i++)Do(e[i],t,o);else if(Ai(e)||bi(e))e.forEach(i=>{Do(i,t,o)});else if(_h(e)){for(const i in e)Do(e[i],t,o);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&Do(e[i],t,o)}return e}function za(e,t,o,i){try{return i?e(...i):e()}catch(s){ol(s,t,o)}}function Jn(e,t,o,i){if(lt(e)){const s=za(e,t,o,i);return s&&gh(s)&&s.catch(a=>{ol(a,t,o)}),s}if(et(e)){const s=[];for(let a=0;a<e.length;a++)s.push(Jn(e[a],t,o,i));return s}}function ol(e,t,o,i=!0){const s=t?t.vnode:null,{errorHandler:a,throwUnhandledErrorInProduction:l}=t&&t.appContext.config||Lt;if(t){let u=t.parent;const h=t.proxy,f=`https://vuejs.org/error-reference/#runtime-${o}`;for(;u;){const p=u.ec;if(p){for(let g=0;g<p.length;g++)if(p[g](e,h,f)===!1)return}u=u.parent}if(a){zo(),za(a,null,10,[e,h,f]),Uo();return}}Xv(e,o,s,i,l)}function Xv(e,t,o,i=!0,s=!1){if(s)throw e;console.error(e)}const vn=[];let ro=-1;const wi=[];let rs=null,vi=0;const Zh=Promise.resolve();let Br=null;function xi(e){const t=Br||Zh;return e?t.then(this?e.bind(this):e):t}function Qv(e){let t=ro+1,o=vn.length;for(;t<o;){const i=t+o>>>1,s=vn[i],a=Ia(s);a<e||a===e&&s.flags&2?t=i+1:o=i}return t}function Gc(e){if(!(e.flags&1)){const t=Ia(e),o=vn[vn.length-1];!o||!(e.flags&2)&&t>=Ia(o)?vn.push(e):vn.splice(Qv(t),0,e),e.flags|=1,jh()}}function jh(){Br||(Br=Zh.then(qh))}function em(e){et(e)?wi.push(...e):rs&&e.id===-1?rs.splice(vi+1,0,e):e.flags&1||(wi.push(e),e.flags|=1),jh()}function Fu(e,t,o=ro+1){for(;o<vn.length;o++){const i=vn[o];if(i&&i.flags&2){if(e&&i.id!==e.uid)continue;vn.splice(o,1),o--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function Wh(e){if(wi.length){const t=[...new Set(wi)].sort((o,i)=>Ia(o)-Ia(i));if(wi.length=0,rs){rs.push(...t);return}for(rs=t,vi=0;vi<rs.length;vi++){const o=rs[vi];o.flags&4&&(o.flags&=-2),o.flags&8||o(),o.flags&=-2}rs=null,vi=0}}const Ia=e=>e.id==null?e.flags&2?-1:1/0:e.id;function qh(e){try{for(ro=0;ro<vn.length;ro++){const t=vn[ro];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),za(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;ro<vn.length;ro++){const t=vn[ro];t&&(t.flags&=-2)}ro=-1,vn.length=0,Wh(),Br=null,(vn.length||wi.length)&&qh()}}let Yt=null,Gh=null;function Nr(e){const t=Yt;return Yt=e,Gh=e&&e.type.__scopeId||null,t}function tt(e,t=Yt,o){if(!t||e._n)return e;const i=(...s)=>{i._d&&Ur(-1);const a=Nr(t);let l;try{l=e(...s)}finally{Nr(a),i._d&&Ur(1)}return l};return i._n=!0,i._c=!0,i._d=!0,i}function Ze(e,t){if(Yt===null)return e;const o=cl(Yt),i=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[a,l,u,h=Lt]=t[s];a&&(lt(a)&&(a={mounted:a,updated:a}),a.deep&&Do(l),i.push({dir:a,instance:o,value:l,oldValue:void 0,arg:u,modifiers:h}))}return e}function Ms(e,t,o,i){const s=e.dirs,a=t&&t.dirs;for(let l=0;l<s.length;l++){const u=s[l];a&&(u.oldValue=a[l].value);let h=u.dir[i];h&&(zo(),Jn(h,o,8,[e.el,u,e,t]),Uo())}}function xr(e,t){if(sn){let o=sn.provides;const i=sn.parent&&sn.parent.provides;i===o&&(o=sn.provides=Object.create(i)),o[e]=t}}function Rn(e,t,o=!1){const i=Qc();if(i||Vs){let s=Vs?Vs._context.provides:i?i.parent==null||i.ce?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return o&&lt(t)?t.call(i&&i.proxy):t}}function tm(){return!!(Qc()||Vs)}const nm=Symbol.for("v-scx"),om=()=>Rn(nm);function Ke(e,t,o){return Kh(e,t,o)}function Kh(e,t,o=Lt){const{immediate:i,deep:s,flush:a,once:l}=o,u=Gt({},o),h=t&&i||!t&&a!=="post";let f;if(Ea){if(a==="sync"){const S=om();f=S.__watcherHandles||(S.__watcherHandles=[])}else if(!h){const S=()=>{};return S.stop=ho,S.resume=ho,S.pause=ho,S}}const p=sn;u.call=(S,T,_)=>Jn(S,p,T,_);let g=!1;a==="post"?u.scheduler=S=>{fn(S,p&&p.suspense)}:a!=="sync"&&(g=!0,u.scheduler=(S,T)=>{T?S():Gc(S)}),u.augmentJob=S=>{t&&(S.flags|=4),g&&(S.flags|=2,p&&(S.id=p.uid,S.i=p))};const b=Jv(e,t,u);return Ea&&(f?f.push(b):h&&b()),b}function sm(e,t,o){const i=this.proxy,s=Nt(e)?e.includes(".")?Yh(i,e):()=>i[e]:e.bind(i,i);let a;lt(t)?a=t:(a=t.handler,o=t);const l=Ua(this),u=Kh(s,a.bind(i),o);return l(),u}function Yh(e,t){const o=t.split(".");return()=>{let i=e;for(let s=0;s<o.length&&i;s++)i=i[o[s]];return i}}const Jh=Symbol("_vte"),Xh=e=>e.__isTeleport,ka=e=>e&&(e.disabled||e.disabled===""),zu=e=>e&&(e.defer||e.defer===""),Uu=e=>typeof SVGElement<"u"&&e instanceof SVGElement,Hu=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,hc=(e,t)=>{const o=e&&e.to;return Nt(o)?t?t(o):null:o},Qh={name:"Teleport",__isTeleport:!0,process(e,t,o,i,s,a,l,u,h,f){const{mc:p,pc:g,pbc:b,o:{insert:S,querySelector:T,createText:_,createComment:D}}=f,M=ka(t.props);let{shapeFlag:x,children:C,dynamicChildren:A}=t;if(e==null){const I=t.el=_(""),$=t.anchor=_("");S(I,o,i),S($,o,i);const E=(ce,ge)=>{x&16&&p(C,ce,ge,s,a,l,u,h)},ie=()=>{const ce=t.target=hc(t.props,T),ge=ef(ce,t,_,S);ce&&(l!=="svg"&&Uu(ce)?l="svg":l!=="mathml"&&Hu(ce)&&(l="mathml"),s&&s.isCE&&(s.ce._teleportTargets||(s.ce._teleportTargets=new Set)).add(ce),M||(E(ce,ge),Tr(t,!1)))};M&&(E(o,$),Tr(t,!0)),zu(t.props)?(t.el.__isMounted=!1,fn(()=>{ie(),delete t.el.__isMounted},a)):ie()}else{if(zu(t.props)&&e.el.__isMounted===!1){fn(()=>{Qh.process(e,t,o,i,s,a,l,u,h,f)},a);return}t.el=e.el,t.targetStart=e.targetStart;const I=t.anchor=e.anchor,$=t.target=e.target,E=t.targetAnchor=e.targetAnchor,ie=ka(e.props),ce=ie?o:$,ge=ie?I:E;if(l==="svg"||Uu($)?l="svg":(l==="mathml"||Hu($))&&(l="mathml"),A?(b(e.dynamicChildren,A,ce,s,a,l,u),Jc(e,t,!0)):h||g(e,t,ce,ge,s,a,l,u,!1),M)ie?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):yr(t,o,I,f,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const re=t.target=hc(t.props,T);re&&yr(t,re,null,f,0)}else ie&&yr(t,$,E,f,1);Tr(t,M)}},remove(e,t,o,{um:i,o:{remove:s}},a){const{shapeFlag:l,children:u,anchor:h,targetStart:f,targetAnchor:p,target:g,props:b}=e;if(g&&(s(f),s(p)),a&&s(h),l&16){const S=a||!ka(b);for(let T=0;T<u.length;T++){const _=u[T];i(_,t,o,S,!!_.dynamicChildren)}}},move:yr,hydrate:im};function yr(e,t,o,{o:{insert:i},m:s},a=2){a===0&&i(e.targetAnchor,t,o);const{el:l,anchor:u,shapeFlag:h,children:f,props:p}=e,g=a===2;if(g&&i(l,t,o),(!g||ka(p))&&h&16)for(let b=0;b<f.length;b++)s(f[b],t,o,2);g&&i(u,t,o)}function im(e,t,o,i,s,a,{o:{nextSibling:l,parentNode:u,querySelector:h,insert:f,createText:p}},g){function b(_,D,M,x){D.anchor=g(l(_),D,u(_),o,i,s,a),D.targetStart=M,D.targetAnchor=x}const S=t.target=hc(t.props,h),T=ka(t.props);if(S){const _=S._lpa||S.firstChild;if(t.shapeFlag&16)if(T)b(e,t,_,_&&l(_));else{t.anchor=l(e);let D=_;for(;D;){if(D&&D.nodeType===8){if(D.data==="teleport start anchor")t.targetStart=D;else if(D.data==="teleport anchor"){t.targetAnchor=D,S._lpa=t.targetAnchor&&l(t.targetAnchor);break}}D=l(D)}t.targetAnchor||ef(S,t,p,f),g(_&&l(_),t,S,o,i,s,a)}Tr(t,T)}else T&&t.shapeFlag&16&&b(e,t,e,l(e));return t.anchor&&l(t.anchor)}const am=Qh;function Tr(e,t){const o=e.ctx;if(o&&o.ut){let i,s;for(t?(i=e.el,s=e.anchor):(i=e.targetStart,s=e.targetAnchor);i&&i!==s;)i.nodeType===1&&i.setAttribute("data-v-owner",o.uid),i=i.nextSibling;o.ut()}}function ef(e,t,o,i){const s=t.targetStart=o(""),a=t.targetAnchor=o("");return s[Jh]=a,e&&(i(s,e),i(a,e)),a}const Ao=Symbol("_leaveCb"),_r=Symbol("_enterCb");function rm(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return rn(()=>{e.isMounted=!0}),uf(()=>{e.isUnmounting=!0}),e}const Dn=[Function,Array],tf={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Dn,onEnter:Dn,onAfterEnter:Dn,onEnterCancelled:Dn,onBeforeLeave:Dn,onLeave:Dn,onAfterLeave:Dn,onLeaveCancelled:Dn,onBeforeAppear:Dn,onAppear:Dn,onAfterAppear:Dn,onAppearCancelled:Dn},nf=e=>{const t=e.subTree;return t.component?nf(t.component):t},lm={name:"BaseTransition",props:tf,setup(e,{slots:t}){const o=Qc(),i=rm();return()=>{const s=t.default&&af(t.default(),!0);if(!s||!s.length)return;const a=of(s),l=vt(e),{mode:u}=l;if(i.isLeaving)return Zl(a);const h=Vu(a);if(!h)return Zl(a);let f=fc(h,l,i,o,g=>f=g);h.type!==on&&$a(h,f);let p=o.subTree&&Vu(o.subTree);if(p&&p.type!==on&&!Os(p,h)&&nf(o).type!==on){let g=fc(p,l,i,o);if($a(p,g),u==="out-in"&&h.type!==on)return i.isLeaving=!0,g.afterLeave=()=>{i.isLeaving=!1,o.job.flags&8||o.update(),delete g.afterLeave,p=void 0},Zl(a);u==="in-out"&&h.type!==on?g.delayLeave=(b,S,T)=>{const _=sf(i,p);_[String(p.key)]=p,b[Ao]=()=>{S(),b[Ao]=void 0,delete f.delayedLeave,p=void 0},f.delayedLeave=()=>{T(),delete f.delayedLeave,p=void 0}}:p=void 0}else p&&(p=void 0);return a}}};function of(e){let t=e[0];if(e.length>1){for(const o of e)if(o.type!==on){t=o;break}}return t}const cm=lm;function sf(e,t){const{leavingVNodes:o}=e;let i=o.get(t.type);return i||(i=Object.create(null),o.set(t.type,i)),i}function fc(e,t,o,i,s){const{appear:a,mode:l,persisted:u=!1,onBeforeEnter:h,onEnter:f,onAfterEnter:p,onEnterCancelled:g,onBeforeLeave:b,onLeave:S,onAfterLeave:T,onLeaveCancelled:_,onBeforeAppear:D,onAppear:M,onAfterAppear:x,onAppearCancelled:C}=t,A=String(e.key),I=sf(o,e),$=(ce,ge)=>{ce&&Jn(ce,i,9,ge)},E=(ce,ge)=>{const re=ge[1];$(ce,ge),et(ce)?ce.every(ve=>ve.length<=1)&&re():ce.length<=1&&re()},ie={mode:l,persisted:u,beforeEnter(ce){let ge=h;if(!o.isMounted)if(a)ge=D||h;else return;ce[Ao]&&ce[Ao](!0);const re=I[A];re&&Os(e,re)&&re.el[Ao]&&re.el[Ao](),$(ge,[ce])},enter(ce){let ge=f,re=p,ve=g;if(!o.isMounted)if(a)ge=M||f,re=x||p,ve=C||g;else return;let Be=!1;const He=ce[_r]=Oe=>{Be||(Be=!0,Oe?$(ve,[ce]):$(re,[ce]),ie.delayedLeave&&ie.delayedLeave(),ce[_r]=void 0)};ge?E(ge,[ce,He]):He()},leave(ce,ge){const re=String(e.key);if(ce[_r]&&ce[_r](!0),o.isUnmounting)return ge();$(b,[ce]);let ve=!1;const Be=ce[Ao]=He=>{ve||(ve=!0,ge(),He?$(_,[ce]):$(T,[ce]),ce[Ao]=void 0,I[re]===e&&delete I[re])};I[re]=e,S?E(S,[ce,Be]):Be()},clone(ce){const ge=fc(ce,t,o,i,s);return s&&s(ge),ge}};return ie}function Zl(e){if(sl(e))return e=vs(e),e.children=null,e}function Vu(e){if(!sl(e))return Xh(e.type)&&e.children?of(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:o}=e;if(o){if(t&16)return o[0];if(t&32&&lt(o.default))return o.default()}}function $a(e,t){e.shapeFlag&6&&e.component?(e.transition=t,$a(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function af(e,t=!1,o){let i=[],s=0;for(let a=0;a<e.length;a++){let l=e[a];const u=o==null?l.key:String(o)+String(l.key!=null?l.key:a);l.type===Te?(l.patchFlag&128&&s++,i=i.concat(af(l.children,t,u))):(t||l.type!==on)&&i.push(u!=null?vs(l,{key:u}):l)}if(s>1)for(let a=0;a<i.length;a++)i[a].patchFlag=-2;return i}function rf(e,t){return lt(e)?Gt({name:e.name},t,{setup:e}):e}function lf(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const Fr=new WeakMap;function ba(e,t,o,i,s=!1){if(et(e)){e.forEach((T,_)=>ba(T,t&&(et(t)?t[_]:t),o,i,s));return}if(Ci(i)&&!s){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&ba(e,t,o,i.component.subTree);return}const a=i.shapeFlag&4?cl(i.component):i.el,l=s?null:a,{i:u,r:h}=e,f=t&&t.r,p=u.refs===Lt?u.refs={}:u.refs,g=u.setupState,b=vt(g),S=g===Lt?mh:T=>gt(b,T);if(f!=null&&f!==h){if(Zu(t),Nt(f))p[f]=null,S(f)&&(g[f]=null);else if(Bt(f)){f.value=null;const T=t;T.k&&(p[T.k]=null)}}if(lt(h))za(h,u,12,[l,p]);else{const T=Nt(h),_=Bt(h);if(T||_){const D=()=>{if(e.f){const M=T?S(h)?g[h]:p[h]:h.value;if(s)et(M)&&Fc(M,a);else if(et(M))M.includes(a)||M.push(a);else if(T)p[h]=[a],S(h)&&(g[h]=p[h]);else{const x=[a];h.value=x,e.k&&(p[e.k]=x)}}else T?(p[h]=l,S(h)&&(g[h]=l)):_&&(h.value=l,e.k&&(p[e.k]=l))};if(l){const M=()=>{D(),Fr.delete(e)};M.id=-1,Fr.set(e,M),fn(M,o)}else Zu(e),D()}}}function Zu(e){const t=Fr.get(e);t&&(t.flags|=8,Fr.delete(e))}el().requestIdleCallback;el().cancelIdleCallback;const Ci=e=>!!e.type.__asyncLoader,sl=e=>e.type.__isKeepAlive;function um(e,t){cf(e,"a",t)}function dm(e,t){cf(e,"da",t)}function cf(e,t,o=sn){const i=e.__wdc||(e.__wdc=()=>{let s=o;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(il(t,i,o),o){let s=o.parent;for(;s&&s.parent;)sl(s.parent.vnode)&&hm(i,t,o,s),s=s.parent}}function hm(e,t,o,i){const s=il(t,e,i,!0);fo(()=>{Fc(i[t],s)},o)}function il(e,t,o=sn,i=!1){if(o){const s=o[e]||(o[e]=[]),a=t.__weh||(t.__weh=(...l)=>{zo();const u=Ua(o),h=Jn(t,o,e,l);return u(),Uo(),h});return i?s.unshift(a):s.push(a),a}}const Vo=e=>(t,o=sn)=>{(!Ea||e==="sp")&&il(e,(...i)=>t(...i),o)},fm=Vo("bm"),rn=Vo("m"),pm=Vo("bu"),vm=Vo("u"),uf=Vo("bum"),fo=Vo("um"),mm=Vo("sp"),gm=Vo("rtg"),ym=Vo("rtc");function _m(e,t=sn){il("ec",e,t)}const km="components";function al(e,t){return wm(km,e,!0,t)||e}const bm=Symbol.for("v-ndc");function wm(e,t,o=!0,i=!1){const s=Yt||sn;if(s){const a=s.type;{const u=ig(a,!1);if(u&&(u===t||u===Nn(t)||u===Xr(Nn(t))))return a}const l=ju(s[e]||a[e],t)||ju(s.appContext[e],t);return!l&&i?a:l}}function ju(e,t){return e&&(e[t]||e[Nn(t)]||e[Xr(Nn(t))])}function Ne(e,t,o,i){let s;const a=o,l=et(e);if(l||Nt(e)){const u=l&&Fo(e);let h=!1,f=!1;u&&(h=!In(e),f=Ho(e),e=tl(e)),s=new Array(e.length);for(let p=0,g=e.length;p<g;p++)s[p]=t(h?f?Si(Yn(e[p])):Yn(e[p]):e[p],p,void 0,a)}else if(typeof e=="number"){s=new Array(e);for(let u=0;u<e;u++)s[u]=t(u+1,u,void 0,a)}else if(wt(e))if(e[Symbol.iterator])s=Array.from(e,(u,h)=>t(u,h,void 0,a));else{const u=Object.keys(e);s=new Array(u.length);for(let h=0,f=u.length;h<f;h++){const p=u[h];s[h]=t(e[p],p,h,a)}}else s=[];return s}function ra(e,t,o={},i,s){if(Yt.ce||Yt.parent&&Ci(Yt.parent)&&Yt.parent.ce){const f=Object.keys(o).length>0;return t!=="default"&&(o.name=t),m(),at(Te,null,[Ve("slot",o,i&&i())],f?-2:64)}let a=e[t];a&&a._c&&(a._d=!1),m();const l=a&&df(a(o)),u=o.key||l&&l.key,h=at(Te,{key:(u&&!Kn(u)?u:`_${t}`)+(!l&&i?"_fb":"")},l||(i?i():[]),l&&e._===1?64:-2);return a&&a._c&&(a._d=!0),h}function df(e){return e.some(t=>Aa(t)?!(t.type===on||t.type===Te&&!df(t.children)):!0)?e:null}const pc=e=>e?Af(e)?cl(e):pc(e.parent):null,wa=Gt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>pc(e.parent),$root:e=>pc(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>ff(e),$forceUpdate:e=>e.f||(e.f=()=>{Gc(e.update)}),$nextTick:e=>e.n||(e.n=xi.bind(e.proxy)),$watch:e=>sm.bind(e)}),jl=(e,t)=>e!==Lt&&!e.__isScriptSetup&&gt(e,t),Cm={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:o,setupState:i,data:s,props:a,accessCache:l,type:u,appContext:h}=e;if(t[0]!=="$"){const b=l[t];if(b!==void 0)switch(b){case 1:return i[t];case 2:return s[t];case 4:return o[t];case 3:return a[t]}else{if(jl(i,t))return l[t]=1,i[t];if(s!==Lt&&gt(s,t))return l[t]=2,s[t];if(gt(a,t))return l[t]=3,a[t];if(o!==Lt&&gt(o,t))return l[t]=4,o[t];vc&&(l[t]=0)}}const f=wa[t];let p,g;if(f)return t==="$attrs"&&nn(e.attrs,"get",""),f(e);if((p=u.__cssModules)&&(p=p[t]))return p;if(o!==Lt&&gt(o,t))return l[t]=4,o[t];if(g=h.config.globalProperties,gt(g,t))return g[t]},set({_:e},t,o){const{data:i,setupState:s,ctx:a}=e;return jl(s,t)?(s[t]=o,!0):i!==Lt&&gt(i,t)?(i[t]=o,!0):gt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=o,!0)},has({_:{data:e,setupState:t,accessCache:o,ctx:i,appContext:s,props:a,type:l}},u){let h;return!!(o[u]||e!==Lt&&u[0]!=="$"&&gt(e,u)||jl(t,u)||gt(a,u)||gt(i,u)||gt(wa,u)||gt(s.config.globalProperties,u)||(h=l.__cssModules)&&h[u])},defineProperty(e,t,o){return o.get!=null?e._.accessCache[t]=0:gt(o,"value")&&this.set(e,t,o.value,null),Reflect.defineProperty(e,t,o)}};function Wu(e){return et(e)?e.reduce((t,o)=>(t[o]=null,t),{}):e}let vc=!0;function Lm(e){const t=ff(e),o=e.proxy,i=e.ctx;vc=!1,t.beforeCreate&&qu(t.beforeCreate,e,"bc");const{data:s,computed:a,methods:l,watch:u,provide:h,inject:f,created:p,beforeMount:g,mounted:b,beforeUpdate:S,updated:T,activated:_,deactivated:D,beforeDestroy:M,beforeUnmount:x,destroyed:C,unmounted:A,render:I,renderTracked:$,renderTriggered:E,errorCaptured:ie,serverPrefetch:ce,expose:ge,inheritAttrs:re,components:ve,directives:Be,filters:He}=t;if(f&&Sm(f,i,null),l)for(const q in l){const j=l[q];lt(j)&&(i[q]=j.bind(o))}if(s){const q=s.call(o,o);wt(q)&&(e.data=Fa(q))}if(vc=!0,a)for(const q in a){const j=a[q],ue=lt(j)?j.bind(o,o):lt(j.get)?j.get.bind(o,o):ho,K=!lt(j)&&lt(j.set)?j.set.bind(o):ho,pe=ae({get:ue,set:K});Object.defineProperty(i,q,{enumerable:!0,configurable:!0,get:()=>pe.value,set:X=>pe.value=X})}if(u)for(const q in u)hf(u[q],i,o,q);if(h){const q=lt(h)?h.call(o):h;Reflect.ownKeys(q).forEach(j=>{xr(j,q[j])})}p&&qu(p,e,"c");function fe(q,j){et(j)?j.forEach(ue=>q(ue.bind(o))):j&&q(j.bind(o))}if(fe(fm,g),fe(rn,b),fe(pm,S),fe(vm,T),fe(um,_),fe(dm,D),fe(_m,ie),fe(ym,$),fe(gm,E),fe(uf,x),fe(fo,A),fe(mm,ce),et(ge))if(ge.length){const q=e.exposed||(e.exposed={});ge.forEach(j=>{Object.defineProperty(q,j,{get:()=>o[j],set:ue=>o[j]=ue,enumerable:!0})})}else e.exposed||(e.exposed={});I&&e.render===ho&&(e.render=I),re!=null&&(e.inheritAttrs=re),ve&&(e.components=ve),Be&&(e.directives=Be),ce&&lf(e)}function Sm(e,t,o=ho){et(e)&&(e=mc(e));for(const i in e){const s=e[i];let a;wt(s)?"default"in s?a=Rn(s.from||i,s.default,!0):a=Rn(s.from||i):a=Rn(s),Bt(a)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>a.value,set:l=>a.value=l}):t[i]=a}}function qu(e,t,o){Jn(et(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,o)}function hf(e,t,o,i){let s=i.includes(".")?Yh(o,i):()=>o[i];if(Nt(e)){const a=t[e];lt(a)&&Ke(s,a)}else if(lt(e))Ke(s,e.bind(o));else if(wt(e))if(et(e))e.forEach(a=>hf(a,t,o,i));else{const a=lt(e.handler)?e.handler.bind(o):t[e.handler];lt(a)&&Ke(s,a,e)}}function ff(e){const t=e.type,{mixins:o,extends:i}=t,{mixins:s,optionsCache:a,config:{optionMergeStrategies:l}}=e.appContext,u=a.get(t);let h;return u?h=u:!s.length&&!o&&!i?h=t:(h={},s.length&&s.forEach(f=>zr(h,f,l,!0)),zr(h,t,l)),wt(t)&&a.set(t,h),h}function zr(e,t,o,i=!1){const{mixins:s,extends:a}=t;a&&zr(e,a,o,!0),s&&s.forEach(l=>zr(e,l,o,!0));for(const l in t)if(!(i&&l==="expose")){const u=xm[l]||o&&o[l];e[l]=u?u(e[l],t[l]):t[l]}return e}const xm={data:Gu,props:Ku,emits:Ku,methods:ha,computed:ha,beforeCreate:hn,created:hn,beforeMount:hn,mounted:hn,beforeUpdate:hn,updated:hn,beforeDestroy:hn,beforeUnmount:hn,destroyed:hn,unmounted:hn,activated:hn,deactivated:hn,errorCaptured:hn,serverPrefetch:hn,components:ha,directives:ha,watch:Im,provide:Gu,inject:Tm};function Gu(e,t){return t?e?function(){return Gt(lt(e)?e.call(this,this):e,lt(t)?t.call(this,this):t)}:t:e}function Tm(e,t){return ha(mc(e),mc(t))}function mc(e){if(et(e)){const t={};for(let o=0;o<e.length;o++)t[e[o]]=e[o];return t}return e}function hn(e,t){return e?[...new Set([].concat(e,t))]:t}function ha(e,t){return e?Gt(Object.create(null),e,t):t}function Ku(e,t){return e?et(e)&&et(t)?[...new Set([...e,...t])]:Gt(Object.create(null),Wu(e),Wu(t??{})):t}function Im(e,t){if(!e)return t;if(!t)return e;const o=Gt(Object.create(null),e);for(const i in t)o[i]=hn(e[i],t[i]);return o}function pf(){return{app:null,config:{isNativeTag:mh,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let $m=0;function Mm(e,t){return function(i,s=null){lt(i)||(i=Gt({},i)),s!=null&&!wt(s)&&(s=null);const a=pf(),l=new WeakSet,u=[];let h=!1;const f=a.app={_uid:$m++,_component:i,_props:s,_container:null,_context:a,_instance:null,version:rg,get config(){return a.config},set config(p){},use(p,...g){return l.has(p)||(p&&lt(p.install)?(l.add(p),p.install(f,...g)):lt(p)&&(l.add(p),p(f,...g))),f},mixin(p){return a.mixins.includes(p)||a.mixins.push(p),f},component(p,g){return g?(a.components[p]=g,f):a.components[p]},directive(p,g){return g?(a.directives[p]=g,f):a.directives[p]},mount(p,g,b){if(!h){const S=f._ceVNode||Ve(i,s);return S.appContext=a,b===!0?b="svg":b===!1&&(b=void 0),e(S,p,b),h=!0,f._container=p,p.__vue_app__=f,cl(S.component)}},onUnmount(p){u.push(p)},unmount(){h&&(Jn(u,f._instance,16),e(null,f._container),delete f._container.__vue_app__)},provide(p,g){return a.provides[p]=g,f},runWithContext(p){const g=Vs;Vs=f;try{return p()}finally{Vs=g}}};return f}}let Vs=null;const Am=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Nn(t)}Modifiers`]||e[`${ys(t)}Modifiers`];function Em(e,t,...o){if(e.isUnmounted)return;const i=e.vnode.props||Lt;let s=o;const a=t.startsWith("update:"),l=a&&Am(i,t.slice(7));l&&(l.trim&&(s=o.map(p=>Nt(p)?p.trim():p)),l.number&&(s=o.map(Qr)));let u,h=i[u=Fl(t)]||i[u=Fl(Nn(t))];!h&&a&&(h=i[u=Fl(ys(t))]),h&&Jn(h,e,6,s);const f=i[u+"Once"];if(f){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,Jn(f,e,6,s)}}const Pm=new WeakMap;function vf(e,t,o=!1){const i=o?Pm:t.emitsCache,s=i.get(e);if(s!==void 0)return s;const a=e.emits;let l={},u=!1;if(!lt(e)){const h=f=>{const p=vf(f,t,!0);p&&(u=!0,Gt(l,p))};!o&&t.mixins.length&&t.mixins.forEach(h),e.extends&&h(e.extends),e.mixins&&e.mixins.forEach(h)}return!a&&!u?(wt(e)&&i.set(e,null),null):(et(a)?a.forEach(h=>l[h]=null):Gt(l,a),wt(e)&&i.set(e,l),l)}function rl(e,t){return!e||!Kr(t)?!1:(t=t.slice(2).replace(/Once$/,""),gt(e,t[0].toLowerCase()+t.slice(1))||gt(e,ys(t))||gt(e,t))}function Yu(e){const{type:t,vnode:o,proxy:i,withProxy:s,propsOptions:[a],slots:l,attrs:u,emit:h,render:f,renderCache:p,props:g,data:b,setupState:S,ctx:T,inheritAttrs:_}=e,D=Nr(e);let M,x;try{if(o.shapeFlag&4){const A=s||i,I=A;M=lo(f.call(I,A,p,g,S,b,T)),x=u}else{const A=t;M=lo(A.length>1?A(g,{attrs:u,slots:l,emit:h}):A(g,null)),x=t.props?u:Dm(u)}}catch(A){Ca.length=0,ol(A,e,1),M=Ve(on)}let C=M;if(x&&_!==!1){const A=Object.keys(x),{shapeFlag:I}=C;A.length&&I&7&&(a&&A.some(Nc)&&(x=Om(x,a)),C=vs(C,x,!1,!0))}return o.dirs&&(C=vs(C,null,!1,!0),C.dirs=C.dirs?C.dirs.concat(o.dirs):o.dirs),o.transition&&$a(C,o.transition),M=C,Nr(D),M}const Dm=e=>{let t;for(const o in e)(o==="class"||o==="style"||Kr(o))&&((t||(t={}))[o]=e[o]);return t},Om=(e,t)=>{const o={};for(const i in e)(!Nc(i)||!(i.slice(9)in t))&&(o[i]=e[i]);return o};function Rm(e,t,o){const{props:i,children:s,component:a}=e,{props:l,children:u,patchFlag:h}=t,f=a.emitsOptions;if(t.dirs||t.transition)return!0;if(o&&h>=0){if(h&1024)return!0;if(h&16)return i?Ju(i,l,f):!!l;if(h&8){const p=t.dynamicProps;for(let g=0;g<p.length;g++){const b=p[g];if(l[b]!==i[b]&&!rl(f,b))return!0}}}else return(s||u)&&(!u||!u.$stable)?!0:i===l?!1:i?l?Ju(i,l,f):!0:!!l;return!1}function Ju(e,t,o){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let s=0;s<i.length;s++){const a=i[s];if(t[a]!==e[a]&&!rl(o,a))return!0}return!1}function Bm({vnode:e,parent:t},o){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=o,t=t.parent;else break}}const mf={},gf=()=>Object.create(mf),yf=e=>Object.getPrototypeOf(e)===mf;function Nm(e,t,o,i=!1){const s={},a=gf();e.propsDefaults=Object.create(null),_f(e,t,s,a);for(const l in e.propsOptions[0])l in s||(s[l]=void 0);o?e.props=i?s:Uh(s):e.type.props?e.props=s:e.props=a,e.attrs=a}function Fm(e,t,o,i){const{props:s,attrs:a,vnode:{patchFlag:l}}=e,u=vt(s),[h]=e.propsOptions;let f=!1;if((i||l>0)&&!(l&16)){if(l&8){const p=e.vnode.dynamicProps;for(let g=0;g<p.length;g++){let b=p[g];if(rl(e.emitsOptions,b))continue;const S=t[b];if(h)if(gt(a,b))S!==a[b]&&(a[b]=S,f=!0);else{const T=Nn(b);s[T]=gc(h,u,T,S,e,!1)}else S!==a[b]&&(a[b]=S,f=!0)}}}else{_f(e,t,s,a)&&(f=!0);let p;for(const g in u)(!t||!gt(t,g)&&((p=ys(g))===g||!gt(t,p)))&&(h?o&&(o[g]!==void 0||o[p]!==void 0)&&(s[g]=gc(h,u,g,void 0,e,!0)):delete s[g]);if(a!==u)for(const g in a)(!t||!gt(t,g))&&(delete a[g],f=!0)}f&&Po(e.attrs,"set","")}function _f(e,t,o,i){const[s,a]=e.propsOptions;let l=!1,u;if(t)for(let h in t){if(ga(h))continue;const f=t[h];let p;s&&gt(s,p=Nn(h))?!a||!a.includes(p)?o[p]=f:(u||(u={}))[p]=f:rl(e.emitsOptions,h)||(!(h in i)||f!==i[h])&&(i[h]=f,l=!0)}if(a){const h=vt(o),f=u||Lt;for(let p=0;p<a.length;p++){const g=a[p];o[g]=gc(s,h,g,f[g],e,!gt(f,g))}}return l}function gc(e,t,o,i,s,a){const l=e[o];if(l!=null){const u=gt(l,"default");if(u&&i===void 0){const h=l.default;if(l.type!==Function&&!l.skipFactory&&lt(h)){const{propsDefaults:f}=s;if(o in f)i=f[o];else{const p=Ua(s);i=f[o]=h.call(null,t),p()}}else i=h;s.ce&&s.ce._setProp(o,i)}l[0]&&(a&&!u?i=!1:l[1]&&(i===""||i===ys(o))&&(i=!0))}return i}const zm=new WeakMap;function kf(e,t,o=!1){const i=o?zm:t.propsCache,s=i.get(e);if(s)return s;const a=e.props,l={},u=[];let h=!1;if(!lt(e)){const p=g=>{h=!0;const[b,S]=kf(g,t,!0);Gt(l,b),S&&u.push(...S)};!o&&t.mixins.length&&t.mixins.forEach(p),e.extends&&p(e.extends),e.mixins&&e.mixins.forEach(p)}if(!a&&!h)return wt(e)&&i.set(e,ki),ki;if(et(a))for(let p=0;p<a.length;p++){const g=Nn(a[p]);Xu(g)&&(l[g]=Lt)}else if(a)for(const p in a){const g=Nn(p);if(Xu(g)){const b=a[p],S=l[g]=et(b)||lt(b)?{type:b}:Gt({},b),T=S.type;let _=!1,D=!0;if(et(T))for(let M=0;M<T.length;++M){const x=T[M],C=lt(x)&&x.name;if(C==="Boolean"){_=!0;break}else C==="String"&&(D=!1)}else _=lt(T)&&T.name==="Boolean";S[0]=_,S[1]=D,(_||gt(S,"default"))&&u.push(g)}}const f=[l,u];return wt(e)&&i.set(e,f),f}function Xu(e){return e[0]!=="$"&&!ga(e)}const Kc=e=>e==="_"||e==="_ctx"||e==="$stable",Yc=e=>et(e)?e.map(lo):[lo(e)],Um=(e,t,o)=>{if(t._n)return t;const i=tt((...s)=>Yc(t(...s)),o);return i._c=!1,i},bf=(e,t,o)=>{const i=e._ctx;for(const s in e){if(Kc(s))continue;const a=e[s];if(lt(a))t[s]=Um(s,a,i);else if(a!=null){const l=Yc(a);t[s]=()=>l}}},wf=(e,t)=>{const o=Yc(t);e.slots.default=()=>o},Cf=(e,t,o)=>{for(const i in t)(o||!Kc(i))&&(e[i]=t[i])},Hm=(e,t,o)=>{const i=e.slots=gf();if(e.vnode.shapeFlag&32){const s=t._;s?(Cf(i,t,o),o&&kh(i,"_",s,!0)):bf(t,i)}else t&&wf(e,t)},Vm=(e,t,o)=>{const{vnode:i,slots:s}=e;let a=!0,l=Lt;if(i.shapeFlag&32){const u=t._;u?o&&u===1?a=!1:Cf(s,t,o):(a=!t.$stable,bf(t,s)),l=t}else t&&(wf(e,t),l={default:1});if(a)for(const u in s)!Kc(u)&&l[u]==null&&delete s[u]},fn=Gm;function Zm(e){return jm(e)}function jm(e,t){const o=el();o.__VUE__=!0;const{insert:i,remove:s,patchProp:a,createElement:l,createText:u,createComment:h,setText:f,setElementText:p,parentNode:g,nextSibling:b,setScopeId:S=ho,insertStaticContent:T}=e,_=(B,U,Q,Z=null,N=null,R=null,J=void 0,ke=null,xe=!!U.dynamicChildren)=>{if(B===U)return;B&&!Os(B,U)&&(Z=se(B),X(B,N,R,!0),B=null),U.patchFlag===-2&&(xe=!1,U.dynamicChildren=null);const{type:Ce,ref:ze,shapeFlag:Re}=U;switch(Ce){case ll:D(B,U,Q,Z);break;case on:M(B,U,Q,Z);break;case Ir:B==null&&x(U,Q,Z,J);break;case Te:ve(B,U,Q,Z,N,R,J,ke,xe);break;default:Re&1?I(B,U,Q,Z,N,R,J,ke,xe):Re&6?Be(B,U,Q,Z,N,R,J,ke,xe):(Re&64||Re&128)&&Ce.process(B,U,Q,Z,N,R,J,ke,xe,de)}ze!=null&&N?ba(ze,B&&B.ref,R,U||B,!U):ze==null&&B&&B.ref!=null&&ba(B.ref,null,R,B,!0)},D=(B,U,Q,Z)=>{if(B==null)i(U.el=u(U.children),Q,Z);else{const N=U.el=B.el;U.children!==B.children&&f(N,U.children)}},M=(B,U,Q,Z)=>{B==null?i(U.el=h(U.children||""),Q,Z):U.el=B.el},x=(B,U,Q,Z)=>{[B.el,B.anchor]=T(B.children,U,Q,Z,B.el,B.anchor)},C=({el:B,anchor:U},Q,Z)=>{let N;for(;B&&B!==U;)N=b(B),i(B,Q,Z),B=N;i(U,Q,Z)},A=({el:B,anchor:U})=>{let Q;for(;B&&B!==U;)Q=b(B),s(B),B=Q;s(U)},I=(B,U,Q,Z,N,R,J,ke,xe)=>{if(U.type==="svg"?J="svg":U.type==="math"&&(J="mathml"),B==null)$(U,Q,Z,N,R,J,ke,xe);else{const Ce=B.el&&B.el._isVueCE?B.el:null;try{Ce&&Ce._beginPatch(),ce(B,U,N,R,J,ke,xe)}finally{Ce&&Ce._endPatch()}}},$=(B,U,Q,Z,N,R,J,ke)=>{let xe,Ce;const{props:ze,shapeFlag:Re,transition:je,dirs:Ye}=B;if(xe=B.el=l(B.type,R,ze&&ze.is,ze),Re&8?p(xe,B.children):Re&16&&ie(B.children,xe,null,Z,N,Wl(B,R),J,ke),Ye&&Ms(B,null,Z,"created"),E(xe,B,B.scopeId,J,Z),ze){for(const Y in ze)Y!=="value"&&!ga(Y)&&a(xe,Y,null,ze[Y],R,Z);"value"in ze&&a(xe,"value",null,ze.value,R),(Ce=ze.onVnodeBeforeMount)&&io(Ce,Z,B)}Ye&&Ms(B,null,Z,"beforeMount");const te=Wm(N,je);te&&je.beforeEnter(xe),i(xe,U,Q),((Ce=ze&&ze.onVnodeMounted)||te||Ye)&&fn(()=>{Ce&&io(Ce,Z,B),te&&je.enter(xe),Ye&&Ms(B,null,Z,"mounted")},N)},E=(B,U,Q,Z,N)=>{if(Q&&S(B,Q),Z)for(let R=0;R<Z.length;R++)S(B,Z[R]);if(N){let R=N.subTree;if(U===R||xf(R.type)&&(R.ssContent===U||R.ssFallback===U)){const J=N.vnode;E(B,J,J.scopeId,J.slotScopeIds,N.parent)}}},ie=(B,U,Q,Z,N,R,J,ke,xe=0)=>{for(let Ce=xe;Ce<B.length;Ce++){const ze=B[Ce]=ke?ls(B[Ce]):lo(B[Ce]);_(null,ze,U,Q,Z,N,R,J,ke)}},ce=(B,U,Q,Z,N,R,J)=>{const ke=U.el=B.el;let{patchFlag:xe,dynamicChildren:Ce,dirs:ze}=U;xe|=B.patchFlag&16;const Re=B.props||Lt,je=U.props||Lt;let Ye;if(Q&&As(Q,!1),(Ye=je.onVnodeBeforeUpdate)&&io(Ye,Q,U,B),ze&&Ms(U,B,Q,"beforeUpdate"),Q&&As(Q,!0),(Re.innerHTML&&je.innerHTML==null||Re.textContent&&je.textContent==null)&&p(ke,""),Ce?ge(B.dynamicChildren,Ce,ke,Q,Z,Wl(U,N),R):J||j(B,U,ke,null,Q,Z,Wl(U,N),R,!1),xe>0){if(xe&16)re(ke,Re,je,Q,N);else if(xe&2&&Re.class!==je.class&&a(ke,"class",null,je.class,N),xe&4&&a(ke,"style",Re.style,je.style,N),xe&8){const te=U.dynamicProps;for(let Y=0;Y<te.length;Y++){const H=te[Y],Fe=Re[H],Je=je[H];(Je!==Fe||H==="value")&&a(ke,H,Fe,Je,N,Q)}}xe&1&&B.children!==U.children&&p(ke,U.children)}else!J&&Ce==null&&re(ke,Re,je,Q,N);((Ye=je.onVnodeUpdated)||ze)&&fn(()=>{Ye&&io(Ye,Q,U,B),ze&&Ms(U,B,Q,"updated")},Z)},ge=(B,U,Q,Z,N,R,J)=>{for(let ke=0;ke<U.length;ke++){const xe=B[ke],Ce=U[ke],ze=xe.el&&(xe.type===Te||!Os(xe,Ce)||xe.shapeFlag&198)?g(xe.el):Q;_(xe,Ce,ze,null,Z,N,R,J,!0)}},re=(B,U,Q,Z,N)=>{if(U!==Q){if(U!==Lt)for(const R in U)!ga(R)&&!(R in Q)&&a(B,R,U[R],null,N,Z);for(const R in Q){if(ga(R))continue;const J=Q[R],ke=U[R];J!==ke&&R!=="value"&&a(B,R,ke,J,N,Z)}"value"in Q&&a(B,"value",U.value,Q.value,N)}},ve=(B,U,Q,Z,N,R,J,ke,xe)=>{const Ce=U.el=B?B.el:u(""),ze=U.anchor=B?B.anchor:u("");let{patchFlag:Re,dynamicChildren:je,slotScopeIds:Ye}=U;Ye&&(ke=ke?ke.concat(Ye):Ye),B==null?(i(Ce,Q,Z),i(ze,Q,Z),ie(U.children||[],Q,ze,N,R,J,ke,xe)):Re>0&&Re&64&&je&&B.dynamicChildren&&B.dynamicChildren.length===je.length?(ge(B.dynamicChildren,je,Q,N,R,J,ke),(U.key!=null||N&&U===N.subTree)&&Jc(B,U,!0)):j(B,U,Q,ze,N,R,J,ke,xe)},Be=(B,U,Q,Z,N,R,J,ke,xe)=>{U.slotScopeIds=ke,B==null?U.shapeFlag&512?N.ctx.activate(U,Q,Z,J,xe):He(U,Q,Z,N,R,J,xe):Oe(B,U,xe)},He=(B,U,Q,Z,N,R,J)=>{const ke=B.component=eg(B,Z,N);if(sl(B)&&(ke.ctx.renderer=de),tg(ke,!1,J),ke.asyncDep){if(N&&N.registerDep(ke,fe,J),!B.el){const xe=ke.subTree=Ve(on);M(null,xe,U,Q),B.placeholder=xe.el}}else fe(ke,B,U,Q,N,R,J)},Oe=(B,U,Q)=>{const Z=U.component=B.component;if(Rm(B,U,Q))if(Z.asyncDep&&!Z.asyncResolved){q(Z,U,Q);return}else Z.next=U,Z.update();else U.el=B.el,Z.vnode=U},fe=(B,U,Q,Z,N,R,J)=>{const ke=()=>{if(B.isMounted){let{next:Re,bu:je,u:Ye,parent:te,vnode:Y}=B;{const ot=Lf(B);if(ot){Re&&(Re.el=Y.el,q(B,Re,J)),ot.asyncDep.then(()=>{B.isUnmounted||ke()});return}}let H=Re,Fe;As(B,!1),Re?(Re.el=Y.el,q(B,Re,J)):Re=Y,je&&Sr(je),(Fe=Re.props&&Re.props.onVnodeBeforeUpdate)&&io(Fe,te,Re,Y),As(B,!0);const Je=Yu(B),Qe=B.subTree;B.subTree=Je,_(Qe,Je,g(Qe.el),se(Qe),B,N,R),Re.el=Je.el,H===null&&Bm(B,Je.el),Ye&&fn(Ye,N),(Fe=Re.props&&Re.props.onVnodeUpdated)&&fn(()=>io(Fe,te,Re,Y),N)}else{let Re;const{el:je,props:Ye}=U,{bm:te,m:Y,parent:H,root:Fe,type:Je}=B,Qe=Ci(U);As(B,!1),te&&Sr(te),!Qe&&(Re=Ye&&Ye.onVnodeBeforeMount)&&io(Re,H,U),As(B,!0);{Fe.ce&&Fe.ce._def.shadowRoot!==!1&&Fe.ce._injectChildStyle(Je);const ot=B.subTree=Yu(B);_(null,ot,Q,Z,B,N,R),U.el=ot.el}if(Y&&fn(Y,N),!Qe&&(Re=Ye&&Ye.onVnodeMounted)){const ot=U;fn(()=>io(Re,H,ot),N)}(U.shapeFlag&256||H&&Ci(H.vnode)&&H.vnode.shapeFlag&256)&&B.a&&fn(B.a,N),B.isMounted=!0,U=Q=Z=null}};B.scope.on();const xe=B.effect=new Th(ke);B.scope.off();const Ce=B.update=xe.run.bind(xe),ze=B.job=xe.runIfDirty.bind(xe);ze.i=B,ze.id=B.uid,xe.scheduler=()=>Gc(ze),As(B,!0),Ce()},q=(B,U,Q)=>{U.component=B;const Z=B.vnode.props;B.vnode=U,B.next=null,Fm(B,U.props,Z,Q),Vm(B,U.children,Q),zo(),Fu(B),Uo()},j=(B,U,Q,Z,N,R,J,ke,xe=!1)=>{const Ce=B&&B.children,ze=B?B.shapeFlag:0,Re=U.children,{patchFlag:je,shapeFlag:Ye}=U;if(je>0){if(je&128){K(Ce,Re,Q,Z,N,R,J,ke,xe);return}else if(je&256){ue(Ce,Re,Q,Z,N,R,J,ke,xe);return}}Ye&8?(ze&16&&Ee(Ce,N,R),Re!==Ce&&p(Q,Re)):ze&16?Ye&16?K(Ce,Re,Q,Z,N,R,J,ke,xe):Ee(Ce,N,R,!0):(ze&8&&p(Q,""),Ye&16&&ie(Re,Q,Z,N,R,J,ke,xe))},ue=(B,U,Q,Z,N,R,J,ke,xe)=>{B=B||ki,U=U||ki;const Ce=B.length,ze=U.length,Re=Math.min(Ce,ze);let je;for(je=0;je<Re;je++){const Ye=U[je]=xe?ls(U[je]):lo(U[je]);_(B[je],Ye,Q,null,N,R,J,ke,xe)}Ce>ze?Ee(B,N,R,!0,!1,Re):ie(U,Q,Z,N,R,J,ke,xe,Re)},K=(B,U,Q,Z,N,R,J,ke,xe)=>{let Ce=0;const ze=U.length;let Re=B.length-1,je=ze-1;for(;Ce<=Re&&Ce<=je;){const Ye=B[Ce],te=U[Ce]=xe?ls(U[Ce]):lo(U[Ce]);if(Os(Ye,te))_(Ye,te,Q,null,N,R,J,ke,xe);else break;Ce++}for(;Ce<=Re&&Ce<=je;){const Ye=B[Re],te=U[je]=xe?ls(U[je]):lo(U[je]);if(Os(Ye,te))_(Ye,te,Q,null,N,R,J,ke,xe);else break;Re--,je--}if(Ce>Re){if(Ce<=je){const Ye=je+1,te=Ye<ze?U[Ye].el:Z;for(;Ce<=je;)_(null,U[Ce]=xe?ls(U[Ce]):lo(U[Ce]),Q,te,N,R,J,ke,xe),Ce++}}else if(Ce>je)for(;Ce<=Re;)X(B[Ce],N,R,!0),Ce++;else{const Ye=Ce,te=Ce,Y=new Map;for(Ce=te;Ce<=je;Ce++){const _t=U[Ce]=xe?ls(U[Ce]):lo(U[Ce]);_t.key!=null&&Y.set(_t.key,Ce)}let H,Fe=0;const Je=je-te+1;let Qe=!1,ot=0;const $t=new Array(Je);for(Ce=0;Ce<Je;Ce++)$t[Ce]=0;for(Ce=Ye;Ce<=Re;Ce++){const _t=B[Ce];if(Fe>=Je){X(_t,N,R,!0);continue}let rt;if(_t.key!=null)rt=Y.get(_t.key);else for(H=te;H<=je;H++)if($t[H-te]===0&&Os(_t,U[H])){rt=H;break}rt===void 0?X(_t,N,R,!0):($t[rt-te]=Ce+1,rt>=ot?ot=rt:Qe=!0,_(_t,U[rt],Q,null,N,R,J,ke,xe),Fe++)}const Mt=Qe?qm($t):ki;for(H=Mt.length-1,Ce=Je-1;Ce>=0;Ce--){const _t=te+Ce,rt=U[_t],At=U[_t+1],kt=_t+1<ze?At.el||Sf(At):Z;$t[Ce]===0?_(null,rt,Q,kt,N,R,J,ke,xe):Qe&&(H<0||Ce!==Mt[H]?pe(rt,Q,kt,2):H--)}}},pe=(B,U,Q,Z,N=null)=>{const{el:R,type:J,transition:ke,children:xe,shapeFlag:Ce}=B;if(Ce&6){pe(B.component.subTree,U,Q,Z);return}if(Ce&128){B.suspense.move(U,Q,Z);return}if(Ce&64){J.move(B,U,Q,de);return}if(J===Te){i(R,U,Q);for(let Re=0;Re<xe.length;Re++)pe(xe[Re],U,Q,Z);i(B.anchor,U,Q);return}if(J===Ir){C(B,U,Q);return}if(Z!==2&&Ce&1&&ke)if(Z===0)ke.beforeEnter(R),i(R,U,Q),fn(()=>ke.enter(R),N);else{const{leave:Re,delayLeave:je,afterLeave:Ye}=ke,te=()=>{B.ctx.isUnmounted?s(R):i(R,U,Q)},Y=()=>{R._isLeaving&&R[Ao](!0),Re(R,()=>{te(),Ye&&Ye()})};je?je(R,te,Y):Y()}else i(R,U,Q)},X=(B,U,Q,Z=!1,N=!1)=>{const{type:R,props:J,ref:ke,children:xe,dynamicChildren:Ce,shapeFlag:ze,patchFlag:Re,dirs:je,cacheIndex:Ye}=B;if(Re===-2&&(N=!1),ke!=null&&(zo(),ba(ke,null,Q,B,!0),Uo()),Ye!=null&&(U.renderCache[Ye]=void 0),ze&256){U.ctx.deactivate(B);return}const te=ze&1&&je,Y=!Ci(B);let H;if(Y&&(H=J&&J.onVnodeBeforeUnmount)&&io(H,U,B),ze&6)Se(B.component,Q,Z);else{if(ze&128){B.suspense.unmount(Q,Z);return}te&&Ms(B,null,U,"beforeUnmount"),ze&64?B.type.remove(B,U,Q,de,Z):Ce&&!Ce.hasOnce&&(R!==Te||Re>0&&Re&64)?Ee(Ce,U,Q,!1,!0):(R===Te&&Re&384||!N&&ze&16)&&Ee(xe,U,Q),Z&&we(B)}(Y&&(H=J&&J.onVnodeUnmounted)||te)&&fn(()=>{H&&io(H,U,B),te&&Ms(B,null,U,"unmounted")},Q)},we=B=>{const{type:U,el:Q,anchor:Z,transition:N}=B;if(U===Te){De(Q,Z);return}if(U===Ir){A(B);return}const R=()=>{s(Q),N&&!N.persisted&&N.afterLeave&&N.afterLeave()};if(B.shapeFlag&1&&N&&!N.persisted){const{leave:J,delayLeave:ke}=N,xe=()=>J(Q,R);ke?ke(B.el,R,xe):xe()}else R()},De=(B,U)=>{let Q;for(;B!==U;)Q=b(B),s(B),B=Q;s(U)},Se=(B,U,Q)=>{const{bum:Z,scope:N,job:R,subTree:J,um:ke,m:xe,a:Ce}=B;Qu(xe),Qu(Ce),Z&&Sr(Z),N.stop(),R&&(R.flags|=8,X(J,B,U,Q)),ke&&fn(ke,U),fn(()=>{B.isUnmounted=!0},U)},Ee=(B,U,Q,Z=!1,N=!1,R=0)=>{for(let J=R;J<B.length;J++)X(B[J],U,Q,Z,N)},se=B=>{if(B.shapeFlag&6)return se(B.component.subTree);if(B.shapeFlag&128)return B.suspense.next();const U=b(B.anchor||B.el),Q=U&&U[Jh];return Q?b(Q):U};let me=!1;const ne=(B,U,Q)=>{let Z;B==null?U._vnode&&(X(U._vnode,null,null,!0),Z=U._vnode.component):_(U._vnode||null,B,U,null,null,null,Q),U._vnode=B,me||(me=!0,Fu(Z),Wh(),me=!1)},de={p:_,um:X,m:pe,r:we,mt:He,mc:ie,pc:j,pbc:ge,n:se,o:e};return{render:ne,hydrate:void 0,createApp:Mm(ne)}}function Wl({type:e,props:t},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:o}function As({effect:e,job:t},o){o?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Wm(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function Jc(e,t,o=!1){const i=e.children,s=t.children;if(et(i)&&et(s))for(let a=0;a<i.length;a++){const l=i[a];let u=s[a];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=s[a]=ls(s[a]),u.el=l.el),!o&&u.patchFlag!==-2&&Jc(l,u)),u.type===ll&&(u.patchFlag!==-1?u.el=l.el:u.__elIndex=a+(e.type===Te?1:0)),u.type===on&&!u.el&&(u.el=l.el)}}function qm(e){const t=e.slice(),o=[0];let i,s,a,l,u;const h=e.length;for(i=0;i<h;i++){const f=e[i];if(f!==0){if(s=o[o.length-1],e[s]<f){t[i]=s,o.push(i);continue}for(a=0,l=o.length-1;a<l;)u=a+l>>1,e[o[u]]<f?a=u+1:l=u;f<e[o[a]]&&(a>0&&(t[i]=o[a-1]),o[a]=i)}}for(a=o.length,l=o[a-1];a-- >0;)o[a]=l,l=t[l];return o}function Lf(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Lf(t)}function Qu(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function Sf(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?Sf(t.subTree):null}const xf=e=>e.__isSuspense;function Gm(e,t){t&&t.pendingBranch?et(e)?t.effects.push(...e):t.effects.push(e):em(e)}const Te=Symbol.for("v-fgt"),ll=Symbol.for("v-txt"),on=Symbol.for("v-cmt"),Ir=Symbol.for("v-stc"),Ca=[];let Tn=null;function m(e=!1){Ca.push(Tn=e?null:[])}function Km(){Ca.pop(),Tn=Ca[Ca.length-1]||null}let Ma=1;function Ur(e,t=!1){Ma+=e,e<0&&Tn&&t&&(Tn.hasOnce=!0)}function Tf(e){return e.dynamicChildren=Ma>0?Tn||ki:null,Km(),Ma>0&&Tn&&Tn.push(e),e}function y(e,t,o,i,s,a){return Tf(c(e,t,o,i,s,a,!0))}function at(e,t,o,i,s){return Tf(Ve(e,t,o,i,s,!0))}function Aa(e){return e?e.__v_isVNode===!0:!1}function Os(e,t){return e.type===t.type&&e.key===t.key}const If=({key:e})=>e??null,$r=({ref:e,ref_key:t,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?Nt(e)||Bt(e)||lt(e)?{i:Yt,r:e,k:t,f:!!o}:e:null);function c(e,t=null,o=null,i=0,s=null,a=e===Te?0:1,l=!1,u=!1){const h={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&If(t),ref:t&&$r(t),scopeId:Gh,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Yt};return u?(Xc(h,o),a&128&&e.normalize(h)):o&&(h.shapeFlag|=Nt(o)?8:16),Ma>0&&!l&&Tn&&(h.patchFlag>0||a&6)&&h.patchFlag!==32&&Tn.push(h),h}const Ve=Ym;function Ym(e,t=null,o=null,i=0,s=null,a=!1){if((!e||e===bm)&&(e=on),Aa(e)){const u=vs(e,t,!0);return o&&Xc(u,o),Ma>0&&!a&&Tn&&(u.shapeFlag&6?Tn[Tn.indexOf(e)]=u:Tn.push(u)),u.patchFlag=-2,u}if(ag(e)&&(e=e.__vccOpts),t){t=Jm(t);let{class:u,style:h}=t;u&&!Nt(u)&&(t.class=Ae(u)),wt(h)&&(nl(h)&&!et(h)&&(h=Gt({},h)),t.style=Dt(h))}const l=Nt(e)?1:xf(e)?128:Xh(e)?64:wt(e)?4:lt(e)?2:0;return c(e,t,o,i,s,l,a,!0)}function Jm(e){return e?nl(e)||yf(e)?Gt({},e):e:null}function vs(e,t,o=!1,i=!1){const{props:s,ref:a,patchFlag:l,children:u,transition:h}=e,f=t?Mf(s||{},t):s,p={__v_isVNode:!0,__v_skip:!0,type:e.type,props:f,key:f&&If(f),ref:t&&t.ref?o&&a?et(a)?a.concat($r(t)):[a,$r(t)]:$r(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Te?l===-1?16:l|16:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:h,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&vs(e.ssContent),ssFallback:e.ssFallback&&vs(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return h&&i&&$a(p,h.clone(p)),p}function We(e=" ",t=0){return Ve(ll,null,e,t)}function $f(e,t){const o=Ve(Ir,null,e);return o.staticCount=t,o}function F(e="",t=!1){return t?(m(),at(on,null,e)):Ve(on,null,e)}function lo(e){return e==null||typeof e=="boolean"?Ve(on):et(e)?Ve(Te,null,e.slice()):Aa(e)?ls(e):Ve(ll,null,String(e))}function ls(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:vs(e)}function Xc(e,t){let o=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(et(t))o=16;else if(typeof t=="object")if(i&65){const s=t.default;s&&(s._c&&(s._d=!1),Xc(e,s()),s._c&&(s._d=!0));return}else{o=32;const s=t._;!s&&!yf(t)?t._ctx=Yt:s===3&&Yt&&(Yt.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else lt(t)?(t={default:t,_ctx:Yt},o=32):(t=String(t),i&64?(o=16,t=[We(t)]):o=8);e.children=t,e.shapeFlag|=o}function Mf(...e){const t={};for(let o=0;o<e.length;o++){const i=e[o];for(const s in i)if(s==="class")t.class!==i.class&&(t.class=Ae([t.class,i.class]));else if(s==="style")t.style=Dt([t.style,i.style]);else if(Kr(s)){const a=t[s],l=i[s];l&&a!==l&&!(et(a)&&a.includes(l))&&(t[s]=a?[].concat(a,l):l)}else s!==""&&(t[s]=i[s])}return t}function io(e,t,o,i=null){Jn(e,t,7,[o,i])}const Xm=pf();let Qm=0;function eg(e,t,o){const i=e.type,s=(t?t.appContext:e.appContext)||Xm,a={uid:Qm++,vnode:e,type:i,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Lh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:kf(i,s),emitsOptions:vf(i,s),emit:null,emitted:null,propsDefaults:Lt,inheritAttrs:i.inheritAttrs,ctx:Lt,data:Lt,props:Lt,attrs:Lt,slots:Lt,refs:Lt,setupState:Lt,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=Em.bind(null,a),e.ce&&e.ce(a),a}let sn=null;const Qc=()=>sn||Yt;let Hr,yc;{const e=el(),t=(o,i)=>{let s;return(s=e[o])||(s=e[o]=[]),s.push(i),a=>{s.length>1?s.forEach(l=>l(a)):s[0](a)}};Hr=t("__VUE_INSTANCE_SETTERS__",o=>sn=o),yc=t("__VUE_SSR_SETTERS__",o=>Ea=o)}const Ua=e=>{const t=sn;return Hr(e),e.scope.on(),()=>{e.scope.off(),Hr(t)}},ed=()=>{sn&&sn.scope.off(),Hr(null)};function Af(e){return e.vnode.shapeFlag&4}let Ea=!1;function tg(e,t=!1,o=!1){t&&yc(t);const{props:i,children:s}=e.vnode,a=Af(e);Nm(e,i,a,t),Hm(e,s,o||t);const l=a?ng(e,t):void 0;return t&&yc(!1),l}function ng(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Cm);const{setup:i}=o;if(i){zo();const s=e.setupContext=i.length>1?sg(e):null,a=Ua(e),l=za(i,e,0,[e.props,s]),u=gh(l);if(Uo(),a(),(u||e.sp)&&!Ci(e)&&lf(e),u){if(l.then(ed,ed),t)return l.then(h=>{td(e,h)}).catch(h=>{ol(h,e,0)});e.asyncDep=l}else td(e,l)}else Ef(e)}function td(e,t,o){lt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:wt(t)&&(e.setupState=Vh(t)),Ef(e)}function Ef(e,t,o){const i=e.type;e.render||(e.render=i.render||ho);{const s=Ua(e);zo();try{Lm(e)}finally{Uo(),s()}}}const og={get(e,t){return nn(e,"get",""),e[t]}};function sg(e){const t=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,og),slots:e.slots,emit:e.emit,expose:t}}function cl(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Vh(qc(e.exposed)),{get(t,o){if(o in t)return t[o];if(o in wa)return wa[o](e)},has(t,o){return o in t||o in wa}})):e.proxy}function ig(e,t=!0){return lt(e)?e.displayName||e.name:e.name||t&&e.__name}function ag(e){return lt(e)&&"__vccOpts"in e}const ae=(e,t)=>Kv(e,t,Ea);function eu(e,t,o){try{Ur(-1);const i=arguments.length;return i===2?wt(t)&&!et(t)?Aa(t)?Ve(e,null,[t]):Ve(e,t):Ve(e,null,t):(i>3?o=Array.prototype.slice.call(arguments,2):i===3&&Aa(o)&&(o=[o]),Ve(e,t,o))}finally{Ur(1)}}const rg="3.5.26";let _c;const nd=typeof window<"u"&&window.trustedTypes;if(nd)try{_c=nd.createPolicy("vue",{createHTML:e=>e})}catch{}const Pf=_c?e=>_c.createHTML(e):e=>e,lg="http://www.w3.org/2000/svg",cg="http://www.w3.org/1998/Math/MathML",Mo=typeof document<"u"?document:null,od=Mo&&Mo.createElement("template"),ug={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,i)=>{const s=t==="svg"?Mo.createElementNS(lg,e):t==="mathml"?Mo.createElementNS(cg,e):o?Mo.createElement(e,{is:o}):Mo.createElement(e);return e==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:e=>Mo.createTextNode(e),createComment:e=>Mo.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Mo.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,o,i,s,a){const l=o?o.previousSibling:t.lastChild;if(s&&(s===a||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),o),!(s===a||!(s=s.nextSibling)););else{od.innerHTML=Pf(i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e);const u=od.content;if(i==="svg"||i==="mathml"){const h=u.firstChild;for(;h.firstChild;)u.appendChild(h.firstChild);u.removeChild(h)}t.insertBefore(u,o)}return[l?l.nextSibling:t.firstChild,o?o.previousSibling:t.lastChild]}},os="transition",la="animation",Pa=Symbol("_vtc"),Df={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},dg=Gt({},tf,Df),hg=e=>(e.displayName="Transition",e.props=dg,e),ql=hg((e,{slots:t})=>eu(cm,fg(e),t)),Es=(e,t=[])=>{et(e)?e.forEach(o=>o(...t)):e&&e(...t)},sd=e=>e?et(e)?e.some(t=>t.length>1):e.length>1:!1;function fg(e){const t={};for(const ve in e)ve in Df||(t[ve]=e[ve]);if(e.css===!1)return t;const{name:o="v",type:i,duration:s,enterFromClass:a=`${o}-enter-from`,enterActiveClass:l=`${o}-enter-active`,enterToClass:u=`${o}-enter-to`,appearFromClass:h=a,appearActiveClass:f=l,appearToClass:p=u,leaveFromClass:g=`${o}-leave-from`,leaveActiveClass:b=`${o}-leave-active`,leaveToClass:S=`${o}-leave-to`}=e,T=pg(s),_=T&&T[0],D=T&&T[1],{onBeforeEnter:M,onEnter:x,onEnterCancelled:C,onLeave:A,onLeaveCancelled:I,onBeforeAppear:$=M,onAppear:E=x,onAppearCancelled:ie=C}=t,ce=(ve,Be,He,Oe)=>{ve._enterCancelled=Oe,Ps(ve,Be?p:u),Ps(ve,Be?f:l),He&&He()},ge=(ve,Be)=>{ve._isLeaving=!1,Ps(ve,g),Ps(ve,S),Ps(ve,b),Be&&Be()},re=ve=>(Be,He)=>{const Oe=ve?E:x,fe=()=>ce(Be,ve,He);Es(Oe,[Be,fe]),id(()=>{Ps(Be,ve?h:a),Io(Be,ve?p:u),sd(Oe)||ad(Be,i,_,fe)})};return Gt(t,{onBeforeEnter(ve){Es(M,[ve]),Io(ve,a),Io(ve,l)},onBeforeAppear(ve){Es($,[ve]),Io(ve,h),Io(ve,f)},onEnter:re(!1),onAppear:re(!0),onLeave(ve,Be){ve._isLeaving=!0;const He=()=>ge(ve,Be);Io(ve,g),ve._enterCancelled?(Io(ve,b),cd(ve)):(cd(ve),Io(ve,b)),id(()=>{ve._isLeaving&&(Ps(ve,g),Io(ve,S),sd(A)||ad(ve,i,D,He))}),Es(A,[ve,He])},onEnterCancelled(ve){ce(ve,!1,void 0,!0),Es(C,[ve])},onAppearCancelled(ve){ce(ve,!0,void 0,!0),Es(ie,[ve])},onLeaveCancelled(ve){ge(ve),Es(I,[ve])}})}function pg(e){if(e==null)return null;if(wt(e))return[Gl(e.enter),Gl(e.leave)];{const t=Gl(e);return[t,t]}}function Gl(e){return pv(e)}function Io(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e[Pa]||(e[Pa]=new Set)).add(t)}function Ps(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const o=e[Pa];o&&(o.delete(t),o.size||(e[Pa]=void 0))}function id(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let vg=0;function ad(e,t,o,i){const s=e._endId=++vg,a=()=>{s===e._endId&&i()};if(o!=null)return setTimeout(a,o);const{type:l,timeout:u,propCount:h}=mg(e,t);if(!l)return i();const f=l+"end";let p=0;const g=()=>{e.removeEventListener(f,b),a()},b=S=>{S.target===e&&++p>=h&&g()};setTimeout(()=>{p<h&&g()},u+1),e.addEventListener(f,b)}function mg(e,t){const o=window.getComputedStyle(e),i=T=>(o[T]||"").split(", "),s=i(`${os}Delay`),a=i(`${os}Duration`),l=rd(s,a),u=i(`${la}Delay`),h=i(`${la}Duration`),f=rd(u,h);let p=null,g=0,b=0;t===os?l>0&&(p=os,g=l,b=a.length):t===la?f>0&&(p=la,g=f,b=h.length):(g=Math.max(l,f),p=g>0?l>f?os:la:null,b=p?p===os?a.length:h.length:0);const S=p===os&&/\b(?:transform|all)(?:,|$)/.test(i(`${os}Property`).toString());return{type:p,timeout:g,propCount:b,hasTransform:S}}function rd(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((o,i)=>ld(o)+ld(e[i])))}function ld(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function cd(e){return(e?e.ownerDocument:document).body.offsetHeight}function gg(e,t,o){const i=e[Pa];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}const Vr=Symbol("_vod"),Of=Symbol("_vsh"),ms={name:"show",beforeMount(e,{value:t},{transition:o}){e[Vr]=e.style.display==="none"?"":e.style.display,o&&t?o.beforeEnter(e):ca(e,t)},mounted(e,{value:t},{transition:o}){o&&t&&o.enter(e)},updated(e,{value:t,oldValue:o},{transition:i}){!t!=!o&&(i?t?(i.beforeEnter(e),ca(e,!0),i.enter(e)):i.leave(e,()=>{ca(e,!1)}):ca(e,t))},beforeUnmount(e,{value:t}){ca(e,t)}};function ca(e,t){e.style.display=t?e[Vr]:"none",e[Of]=!t}const yg=Symbol(""),_g=/(?:^|;)\s*display\s*:/;function kg(e,t,o){const i=e.style,s=Nt(o);let a=!1;if(o&&!s){if(t)if(Nt(t))for(const l of t.split(";")){const u=l.slice(0,l.indexOf(":")).trim();o[u]==null&&Mr(i,u,"")}else for(const l in t)o[l]==null&&Mr(i,l,"");for(const l in o)l==="display"&&(a=!0),Mr(i,l,o[l])}else if(s){if(t!==o){const l=i[yg];l&&(o+=";"+l),i.cssText=o,a=_g.test(o)}}else t&&e.removeAttribute("style");Vr in e&&(e[Vr]=a?i.display:"",e[Of]&&(i.display="none"))}const ud=/\s*!important$/;function Mr(e,t,o){if(et(o))o.forEach(i=>Mr(e,t,i));else if(o==null&&(o=""),t.startsWith("--"))e.setProperty(t,o);else{const i=bg(e,t);ud.test(o)?e.setProperty(ys(i),o.replace(ud,""),"important"):e[i]=o}}const dd=["Webkit","Moz","ms"],Kl={};function bg(e,t){const o=Kl[t];if(o)return o;let i=Nn(t);if(i!=="filter"&&i in e)return Kl[t]=i;i=Xr(i);for(let s=0;s<dd.length;s++){const a=dd[s]+i;if(a in e)return Kl[t]=a}return t}const hd="http://www.w3.org/1999/xlink";function fd(e,t,o,i,s,a=kv(t)){i&&t.startsWith("xlink:")?o==null?e.removeAttributeNS(hd,t.slice(6,t.length)):e.setAttributeNS(hd,t,o):o==null||a&&!bh(o)?e.removeAttribute(t):e.setAttribute(t,a?"":Kn(o)?String(o):o)}function pd(e,t,o,i,s){if(t==="innerHTML"||t==="textContent"){o!=null&&(e[t]=t==="innerHTML"?Pf(o):o);return}const a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){const u=a==="OPTION"?e.getAttribute("value")||"":e.value,h=o==null?e.type==="checkbox"?"on":"":String(o);(u!==h||!("_value"in e))&&(e.value=h),o==null&&e.removeAttribute(t),e._value=o;return}let l=!1;if(o===""||o==null){const u=typeof e[t];u==="boolean"?o=bh(o):o==null&&u==="string"?(o="",l=!0):u==="number"&&(o=0,l=!0)}try{e[t]=o}catch{}l&&e.removeAttribute(s||t)}function Oo(e,t,o,i){e.addEventListener(t,o,i)}function wg(e,t,o,i){e.removeEventListener(t,o,i)}const vd=Symbol("_vei");function Cg(e,t,o,i,s=null){const a=e[vd]||(e[vd]={}),l=a[t];if(i&&l)l.value=i;else{const[u,h]=Lg(t);if(i){const f=a[t]=Tg(i,s);Oo(e,u,f,h)}else l&&(wg(e,u,l,h),a[t]=void 0)}}const md=/(?:Once|Passive|Capture)$/;function Lg(e){let t;if(md.test(e)){t={};let i;for(;i=e.match(md);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):ys(e.slice(2)),t]}let Yl=0;const Sg=Promise.resolve(),xg=()=>Yl||(Sg.then(()=>Yl=0),Yl=Date.now());function Tg(e,t){const o=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=o.attached)return;Jn(Ig(i,o.value),t,5,[i])};return o.value=e,o.attached=xg(),o}function Ig(e,t){if(et(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map(i=>s=>!s._stopped&&i&&i(s))}else return t}const gd=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,$g=(e,t,o,i,s,a)=>{const l=s==="svg";t==="class"?gg(e,i,l):t==="style"?kg(e,o,i):Kr(t)?Nc(t)||Cg(e,t,o,i,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Mg(e,t,i,l))?(pd(e,t,i),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&fd(e,t,i,l,a,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Nt(i))?pd(e,Nn(t),i,a,t):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),fd(e,t,i,l))};function Mg(e,t,o,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&gd(t)&&lt(o));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return gd(t)&&Nt(o)?!1:t in e}const gs=e=>{const t=e.props["onUpdate:modelValue"]||!1;return et(t)?o=>Sr(t,o):t};function Ag(e){e.target.composing=!0}function yd(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Bn=Symbol("_assign");function _d(e,t,o){return t&&(e=e.trim()),o&&(e=Qr(e)),e}const ut={created(e,{modifiers:{lazy:t,trim:o,number:i}},s){e[Bn]=gs(s);const a=i||s.props&&s.props.type==="number";Oo(e,t?"change":"input",l=>{l.target.composing||e[Bn](_d(e.value,o,a))}),(o||a)&&Oo(e,"change",()=>{e.value=_d(e.value,o,a)}),t||(Oo(e,"compositionstart",Ag),Oo(e,"compositionend",yd),Oo(e,"change",yd))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:o,modifiers:{lazy:i,trim:s,number:a}},l){if(e[Bn]=gs(l),e.composing)return;const u=(a||e.type==="number")&&!/^0\d/.test(e.value)?Qr(e.value):e.value,h=t??"";u!==h&&(document.activeElement===e&&e.type!=="range"&&(i&&t===o||s&&e.value.trim()===h)||(e.value=h))}},us={deep:!0,created(e,t,o){e[Bn]=gs(o),Oo(e,"change",()=>{const i=e._modelValue,s=Ti(e),a=e.checked,l=e[Bn];if(et(i)){const u=zc(i,s),h=u!==-1;if(a&&!h)l(i.concat(s));else if(!a&&h){const f=[...i];f.splice(u,1),l(f)}}else if(Ai(i)){const u=new Set(i);a?u.add(s):u.delete(s),l(u)}else l(Rf(e,a))})},mounted:kd,beforeUpdate(e,t,o){e[Bn]=gs(o),kd(e,t,o)}};function kd(e,{value:t,oldValue:o},i){e._modelValue=t;let s;if(et(t))s=zc(t,i.props.value)>-1;else if(Ai(t))s=t.has(i.props.value);else{if(t===o)return;s=Ws(t,Rf(e,!0))}e.checked!==s&&(e.checked=s)}const bd={created(e,{value:t},o){e.checked=Ws(t,o.props.value),e[Bn]=gs(o),Oo(e,"change",()=>{e[Bn](Ti(e))})},beforeUpdate(e,{value:t,oldValue:o},i){e[Bn]=gs(i),t!==o&&(e.checked=Ws(t,i.props.value))}},gn={deep:!0,created(e,{value:t,modifiers:{number:o}},i){const s=Ai(t);Oo(e,"change",()=>{const a=Array.prototype.filter.call(e.options,l=>l.selected).map(l=>o?Qr(Ti(l)):Ti(l));e[Bn](e.multiple?s?new Set(a):a:a[0]),e._assigning=!0,xi(()=>{e._assigning=!1})}),e[Bn]=gs(i)},mounted(e,{value:t}){wd(e,t)},beforeUpdate(e,t,o){e[Bn]=gs(o)},updated(e,{value:t}){e._assigning||wd(e,t)}};function wd(e,t){const o=e.multiple,i=et(t);if(!(o&&!i&&!Ai(t))){for(let s=0,a=e.options.length;s<a;s++){const l=e.options[s],u=Ti(l);if(o)if(i){const h=typeof u;h==="string"||h==="number"?l.selected=t.some(f=>String(f)===String(u)):l.selected=zc(t,u)>-1}else l.selected=t.has(u);else if(Ws(Ti(l),t)){e.selectedIndex!==s&&(e.selectedIndex=s);return}}!o&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Ti(e){return"_value"in e?e._value:e.value}function Rf(e,t){const o=t?"_trueValue":"_falseValue";return o in e?e[o]:t}const Eg=["ctrl","shift","alt","meta"],Pg={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Eg.some(o=>e[`${o}Key`]&&!t.includes(o))},St=(e,t)=>{const o=e._withMods||(e._withMods={}),i=t.join(".");return o[i]||(o[i]=((s,...a)=>{for(let l=0;l<t.length;l++){const u=Pg[t[l]];if(u&&u(s,t))return}return e(s,...a)}))},Dg={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Bf=(e,t)=>{const o=e._withKeys||(e._withKeys={}),i=t.join(".");return o[i]||(o[i]=(s=>{if(!("key"in s))return;const a=ys(s.key);if(t.some(l=>l===a||Dg[l]===a))return e(s)}))},Og=Gt({patchProp:$g},ug);let Cd;function Rg(){return Cd||(Cd=Zm(Og))}const Bg=((...e)=>{const t=Rg().createApp(...e),{mount:o}=t;return t.mount=i=>{const s=Fg(i);if(!s)return;const a=t._component;!lt(a)&&!a.render&&!a.template&&(a.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const l=o(s,!1,Ng(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),l},t});function Ng(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Fg(e){return Nt(e)?document.querySelector(e):e}let Nf;const ul=e=>Nf=e,Ff=Symbol();function kc(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var La;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(La||(La={}));function zg(){const e=Sh(!0),t=e.run(()=>O({}));let o=[],i=[];const s=qc({install(a){ul(s),s._a=a,a.provide(Ff,s),a.config.globalProperties.$pinia=s,i.forEach(l=>o.push(l)),i=[]},use(a){return this._a?o.push(a):i.push(a),this},_p:o,_a:null,_e:e,_s:new Map,state:t});return s}const zf=()=>{};function Ld(e,t,o,i=zf){e.add(t);const s=()=>{e.delete(t)&&i()};return!o&&xh()&&wv(s),s}function pi(e,...t){e.forEach(o=>{o(...t)})}const Ug=e=>e(),Sd=Symbol(),Jl=Symbol();function bc(e,t){e instanceof Map&&t instanceof Map?t.forEach((o,i)=>e.set(i,o)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const o in t){if(!t.hasOwnProperty(o))continue;const i=t[o],s=e[o];kc(s)&&kc(i)&&e.hasOwnProperty(o)&&!Bt(i)&&!Fo(i)?e[o]=bc(s,i):e[o]=i}return e}const Hg=Symbol();function Vg(e){return!kc(e)||!Object.prototype.hasOwnProperty.call(e,Hg)}const{assign:is}=Object;function Zg(e){return!!(Bt(e)&&e.effect)}function jg(e,t,o,i){const{state:s,actions:a,getters:l}=t,u=o.state.value[e];let h;function f(){u||(o.state.value[e]=s?s():{});const p=jv(o.state.value[e]);return is(p,a,Object.keys(l||{}).reduce((g,b)=>(g[b]=qc(ae(()=>{ul(o);const S=o._s.get(e);return l[b].call(S,S)})),g),{}))}return h=Uf(e,f,t,o,i,!0),h}function Uf(e,t,o={},i,s,a){let l;const u=is({actions:{}},o),h={deep:!0};let f,p,g=new Set,b=new Set,S;const T=i.state.value[e];!a&&!T&&(i.state.value[e]={}),O({});let _;function D(ie){let ce;f=p=!1,typeof ie=="function"?(ie(i.state.value[e]),ce={type:La.patchFunction,storeId:e,events:S}):(bc(i.state.value[e],ie),ce={type:La.patchObject,payload:ie,storeId:e,events:S});const ge=_=Symbol();xi().then(()=>{_===ge&&(f=!0)}),p=!0,pi(g,ce,i.state.value[e])}const M=a?function(){const{state:ce}=o,ge=ce?ce():{};this.$patch(re=>{is(re,ge)})}:zf;function x(){l.stop(),g.clear(),b.clear(),i._s.delete(e)}const C=(ie,ce="")=>{if(Sd in ie)return ie[Jl]=ce,ie;const ge=function(){ul(i);const re=Array.from(arguments),ve=new Set,Be=new Set;function He(q){ve.add(q)}function Oe(q){Be.add(q)}pi(b,{args:re,name:ge[Jl],store:I,after:He,onError:Oe});let fe;try{fe=ie.apply(this&&this.$id===e?this:I,re)}catch(q){throw pi(Be,q),q}return fe instanceof Promise?fe.then(q=>(pi(ve,q),q)).catch(q=>(pi(Be,q),Promise.reject(q))):(pi(ve,fe),fe)};return ge[Sd]=!0,ge[Jl]=ce,ge},A={_p:i,$id:e,$onAction:Ld.bind(null,b),$patch:D,$reset:M,$subscribe(ie,ce={}){const ge=Ld(g,ie,ce.detached,()=>re()),re=l.run(()=>Ke(()=>i.state.value[e],ve=>{(ce.flush==="sync"?p:f)&&ie({storeId:e,type:La.direct,events:S},ve)},is({},h,ce)));return ge},$dispose:x},I=Fa(A);i._s.set(e,I);const E=(i._a&&i._a.runWithContext||Ug)(()=>i._e.run(()=>(l=Sh()).run(()=>t({action:C}))));for(const ie in E){const ce=E[ie];if(Bt(ce)&&!Zg(ce)||Fo(ce))a||(T&&Vg(ce)&&(Bt(ce)?ce.value=T[ie]:bc(ce,T[ie])),i.state.value[e][ie]=ce);else if(typeof ce=="function"){const ge=C(ce,ie);E[ie]=ge,u.actions[ie]=ce}}return is(I,E),is(vt(I),E),Object.defineProperty(I,"$state",{get:()=>i.state.value[e],set:ie=>{D(ce=>{is(ce,ie)})}}),i._p.forEach(ie=>{is(I,l.run(()=>ie({store:I,app:i._a,pinia:i,options:u})))}),T&&a&&o.hydrate&&o.hydrate(I.$state,T),f=!0,p=!0,I}function tu(e,t,o){let i;const s=typeof t=="function";i=s?o:t;function a(l,u){const h=tm();return l=l||(h?Rn(Ff,null):null),l&&ul(l),l=Nf,l._s.has(e)||(s?Uf(e,t,i,l):jg(e,i,l)),l._s.get(e)}return a.$id=e,a}const Xe=(e,t)=>{const o=e.__vccOpts||e;for(const[i,s]of t)o[i]=s;return o},Wg={},qg={id:"app"};function Gg(e,t){const o=al("router-view");return m(),y("div",qg,[Ve(o)])}const Kg=Xe(Wg,[["render",Gg]]);const mi=typeof document<"u";function Hf(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Yg(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&Hf(e.default)}const mt=Object.assign;function Xl(e,t){const o={};for(const i in t){const s=t[i];o[i]=Xn(s)?s.map(e):e(s)}return o}const Sa=()=>{},Xn=Array.isArray;function xd(e,t){const o={};for(const i in e)o[i]=i in t?t[i]:e[i];return o}const Vf=/#/g,Jg=/&/g,Xg=/\//g,Qg=/=/g,ey=/\?/g,Zf=/\+/g,ty=/%5B/g,ny=/%5D/g,jf=/%5E/g,oy=/%60/g,Wf=/%7B/g,sy=/%7C/g,qf=/%7D/g,iy=/%20/g;function nu(e){return e==null?"":encodeURI(""+e).replace(sy,"|").replace(ty,"[").replace(ny,"]")}function ay(e){return nu(e).replace(Wf,"{").replace(qf,"}").replace(jf,"^")}function wc(e){return nu(e).replace(Zf,"%2B").replace(iy,"+").replace(Vf,"%23").replace(Jg,"%26").replace(oy,"`").replace(Wf,"{").replace(qf,"}").replace(jf,"^")}function ry(e){return wc(e).replace(Qg,"%3D")}function ly(e){return nu(e).replace(Vf,"%23").replace(ey,"%3F")}function cy(e){return ly(e).replace(Xg,"%2F")}function Da(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const uy=/\/$/,dy=e=>e.replace(uy,"");function Ql(e,t,o="/"){let i,s={},a="",l="";const u=t.indexOf("#");let h=t.indexOf("?");return h=u>=0&&h>u?-1:h,h>=0&&(i=t.slice(0,h),a=t.slice(h,u>0?u:t.length),s=e(a.slice(1))),u>=0&&(i=i||t.slice(0,u),l=t.slice(u,t.length)),i=vy(i??t,o),{fullPath:i+a+l,path:i,query:s,hash:Da(l)}}function hy(e,t){const o=t.query?e(t.query):"";return t.path+(o&&"?")+o+(t.hash||"")}function Td(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function fy(e,t,o){const i=t.matched.length-1,s=o.matched.length-1;return i>-1&&i===s&&Ii(t.matched[i],o.matched[s])&&Gf(t.params,o.params)&&e(t.query)===e(o.query)&&t.hash===o.hash}function Ii(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Gf(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var o in e)if(!py(e[o],t[o]))return!1;return!0}function py(e,t){return Xn(e)?Id(e,t):Xn(t)?Id(t,e):e?.valueOf()===t?.valueOf()}function Id(e,t){return Xn(t)?e.length===t.length&&e.every((o,i)=>o===t[i]):e.length===1&&e[0]===t}function vy(e,t){if(e.startsWith("/"))return e;if(!e)return t;const o=t.split("/"),i=e.split("/"),s=i[i.length-1];(s===".."||s===".")&&i.push("");let a=o.length-1,l,u;for(l=0;l<i.length;l++)if(u=i[l],u!==".")if(u==="..")a>1&&a--;else break;return o.slice(0,a).join("/")+"/"+i.slice(l).join("/")}const ss={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let Cc=(function(e){return e.pop="pop",e.push="push",e})({}),ec=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function my(e){if(!e)if(mi){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),dy(e)}const gy=/^[^#]+#/;function yy(e,t){return e.replace(gy,"#")+t}function _y(e,t){const o=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-o.left-(t.left||0),top:i.top-o.top-(t.top||0)}}const dl=()=>({left:window.scrollX,top:window.scrollY});function ky(e){let t;if("el"in e){const o=e.el,i=typeof o=="string"&&o.startsWith("#"),s=typeof o=="string"?i?document.getElementById(o.slice(1)):document.querySelector(o):o;if(!s)return;t=_y(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function $d(e,t){return(history.state?history.state.position-t:-1)+e}const Lc=new Map;function by(e,t){Lc.set(e,t)}function wy(e){const t=Lc.get(e);return Lc.delete(e),t}function Cy(e){return typeof e=="string"||e&&typeof e=="object"}function Kf(e){return typeof e=="string"||typeof e=="symbol"}let Rt=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const Yf=Symbol("");Rt.MATCHER_NOT_FOUND+"",Rt.NAVIGATION_GUARD_REDIRECT+"",Rt.NAVIGATION_ABORTED+"",Rt.NAVIGATION_CANCELLED+"",Rt.NAVIGATION_DUPLICATED+"";function $i(e,t){return mt(new Error,{type:e,[Yf]:!0},t)}function $o(e,t){return e instanceof Error&&Yf in e&&(t==null||!!(e.type&t))}const Ly=["params","query","hash"];function Sy(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const o of Ly)o in e&&(t[o]=e[o]);return JSON.stringify(t,null,2)}function xy(e){const t={};if(e===""||e==="?")return t;const o=(e[0]==="?"?e.slice(1):e).split("&");for(let i=0;i<o.length;++i){const s=o[i].replace(Zf," "),a=s.indexOf("="),l=Da(a<0?s:s.slice(0,a)),u=a<0?null:Da(s.slice(a+1));if(l in t){let h=t[l];Xn(h)||(h=t[l]=[h]),h.push(u)}else t[l]=u}return t}function Md(e){let t="";for(let o in e){const i=e[o];if(o=ry(o),i==null){i!==void 0&&(t+=(t.length?"&":"")+o);continue}(Xn(i)?i.map(s=>s&&wc(s)):[i&&wc(i)]).forEach(s=>{s!==void 0&&(t+=(t.length?"&":"")+o,s!=null&&(t+="="+s))})}return t}function Ty(e){const t={};for(const o in e){const i=e[o];i!==void 0&&(t[o]=Xn(i)?i.map(s=>s==null?null:""+s):i==null?i:""+i)}return t}const Iy=Symbol(""),Ad=Symbol(""),hl=Symbol(""),ou=Symbol(""),Sc=Symbol("");function ua(){let e=[];function t(i){return e.push(i),()=>{const s=e.indexOf(i);s>-1&&e.splice(s,1)}}function o(){e=[]}return{add:t,list:()=>e.slice(),reset:o}}function cs(e,t,o,i,s,a=l=>l()){const l=i&&(i.enterCallbacks[s]=i.enterCallbacks[s]||[]);return()=>new Promise((u,h)=>{const f=b=>{b===!1?h($i(Rt.NAVIGATION_ABORTED,{from:o,to:t})):b instanceof Error?h(b):Cy(b)?h($i(Rt.NAVIGATION_GUARD_REDIRECT,{from:t,to:b})):(l&&i.enterCallbacks[s]===l&&typeof b=="function"&&l.push(b),u())},p=a(()=>e.call(i&&i.instances[s],t,o,f));let g=Promise.resolve(p);e.length<3&&(g=g.then(f)),g.catch(b=>h(b))})}function tc(e,t,o,i,s=a=>a()){const a=[];for(const l of e)for(const u in l.components){let h=l.components[u];if(!(t!=="beforeRouteEnter"&&!l.instances[u]))if(Hf(h)){const f=(h.__vccOpts||h)[t];f&&a.push(cs(f,o,i,l,u,s))}else{let f=h();a.push(()=>f.then(p=>{if(!p)throw new Error(`Couldn't resolve component "${u}" at "${l.path}"`);const g=Yg(p)?p.default:p;l.mods[u]=p,l.components[u]=g;const b=(g.__vccOpts||g)[t];return b&&cs(b,o,i,l,u,s)()}))}}return a}function $y(e,t){const o=[],i=[],s=[],a=Math.max(t.matched.length,e.matched.length);for(let l=0;l<a;l++){const u=t.matched[l];u&&(e.matched.find(f=>Ii(f,u))?i.push(u):o.push(u));const h=e.matched[l];h&&(t.matched.find(f=>Ii(f,h))||s.push(h))}return[o,i,s]}let My=()=>location.protocol+"//"+location.host;function Jf(e,t){const{pathname:o,search:i,hash:s}=t,a=e.indexOf("#");if(a>-1){let l=s.includes(e.slice(a))?e.slice(a).length:1,u=s.slice(l);return u[0]!=="/"&&(u="/"+u),Td(u,"")}return Td(o,e)+i+s}function Ay(e,t,o,i){let s=[],a=[],l=null;const u=({state:b})=>{const S=Jf(e,location),T=o.value,_=t.value;let D=0;if(b){if(o.value=S,t.value=b,l&&l===T){l=null;return}D=_?b.position-_.position:0}else i(S);s.forEach(M=>{M(o.value,T,{delta:D,type:Cc.pop,direction:D?D>0?ec.forward:ec.back:ec.unknown})})};function h(){l=o.value}function f(b){s.push(b);const S=()=>{const T=s.indexOf(b);T>-1&&s.splice(T,1)};return a.push(S),S}function p(){if(document.visibilityState==="hidden"){const{history:b}=window;if(!b.state)return;b.replaceState(mt({},b.state,{scroll:dl()}),"")}}function g(){for(const b of a)b();a=[],window.removeEventListener("popstate",u),window.removeEventListener("pagehide",p),document.removeEventListener("visibilitychange",p)}return window.addEventListener("popstate",u),window.addEventListener("pagehide",p),document.addEventListener("visibilitychange",p),{pauseListeners:h,listen:f,destroy:g}}function Ed(e,t,o,i=!1,s=!1){return{back:e,current:t,forward:o,replaced:i,position:window.history.length,scroll:s?dl():null}}function Ey(e){const{history:t,location:o}=window,i={value:Jf(e,o)},s={value:t.state};s.value||a(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function a(h,f,p){const g=e.indexOf("#"),b=g>-1?(o.host&&document.querySelector("base")?e:e.slice(g))+h:My()+e+h;try{t[p?"replaceState":"pushState"](f,"",b),s.value=f}catch(S){console.error(S),o[p?"replace":"assign"](b)}}function l(h,f){a(h,mt({},t.state,Ed(s.value.back,h,s.value.forward,!0),f,{position:s.value.position}),!0),i.value=h}function u(h,f){const p=mt({},s.value,t.state,{forward:h,scroll:dl()});a(p.current,p,!0),a(h,mt({},Ed(i.value,h,null),{position:p.position+1},f),!1),i.value=h}return{location:i,state:s,push:u,replace:l}}function Py(e){e=my(e);const t=Ey(e),o=Ay(e,t.state,t.location,t.replace);function i(a,l=!0){l||o.pauseListeners(),history.go(a)}const s=mt({location:"",base:e,go:i,createHref:yy.bind(null,e)},t,o);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function Dy(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),Py(e)}let Fs=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var Vt=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(Vt||{});const Oy={type:Fs.Static,value:""},Ry=/[a-zA-Z0-9_]/;function By(e){if(!e)return[[]];if(e==="/")return[[Oy]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(S){throw new Error(`ERR (${o})/"${f}": ${S}`)}let o=Vt.Static,i=o;const s=[];let a;function l(){a&&s.push(a),a=[]}let u=0,h,f="",p="";function g(){f&&(o===Vt.Static?a.push({type:Fs.Static,value:f}):o===Vt.Param||o===Vt.ParamRegExp||o===Vt.ParamRegExpEnd?(a.length>1&&(h==="*"||h==="+")&&t(`A repeatable param (${f}) must be alone in its segment. eg: '/:ids+.`),a.push({type:Fs.Param,value:f,regexp:p,repeatable:h==="*"||h==="+",optional:h==="*"||h==="?"})):t("Invalid state to consume buffer"),f="")}function b(){f+=h}for(;u<e.length;){if(h=e[u++],h==="\\"&&o!==Vt.ParamRegExp){i=o,o=Vt.EscapeNext;continue}switch(o){case Vt.Static:h==="/"?(f&&g(),l()):h===":"?(g(),o=Vt.Param):b();break;case Vt.EscapeNext:b(),o=i;break;case Vt.Param:h==="("?o=Vt.ParamRegExp:Ry.test(h)?b():(g(),o=Vt.Static,h!=="*"&&h!=="?"&&h!=="+"&&u--);break;case Vt.ParamRegExp:h===")"?p[p.length-1]=="\\"?p=p.slice(0,-1)+h:o=Vt.ParamRegExpEnd:p+=h;break;case Vt.ParamRegExpEnd:g(),o=Vt.Static,h!=="*"&&h!=="?"&&h!=="+"&&u--,p="";break;default:t("Unknown state");break}}return o===Vt.ParamRegExp&&t(`Unfinished custom RegExp for param "${f}"`),g(),l(),s}const Pd="[^/]+?",Ny={sensitive:!1,strict:!1,start:!0,end:!0};var pn=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(pn||{});const Fy=/[.+*?^${}()[\]/\\]/g;function zy(e,t){const o=mt({},Ny,t),i=[];let s=o.start?"^":"";const a=[];for(const f of e){const p=f.length?[]:[pn.Root];o.strict&&!f.length&&(s+="/");for(let g=0;g<f.length;g++){const b=f[g];let S=pn.Segment+(o.sensitive?pn.BonusCaseSensitive:0);if(b.type===Fs.Static)g||(s+="/"),s+=b.value.replace(Fy,"\\$&"),S+=pn.Static;else if(b.type===Fs.Param){const{value:T,repeatable:_,optional:D,regexp:M}=b;a.push({name:T,repeatable:_,optional:D});const x=M||Pd;if(x!==Pd){S+=pn.BonusCustomRegExp;try{`${x}`}catch(A){throw new Error(`Invalid custom RegExp for param "${T}" (${x}): `+A.message)}}let C=_?`((?:${x})(?:/(?:${x}))*)`:`(${x})`;g||(C=D&&f.length<2?`(?:/${C})`:"/"+C),D&&(C+="?"),s+=C,S+=pn.Dynamic,D&&(S+=pn.BonusOptional),_&&(S+=pn.BonusRepeatable),x===".*"&&(S+=pn.BonusWildcard)}p.push(S)}i.push(p)}if(o.strict&&o.end){const f=i.length-1;i[f][i[f].length-1]+=pn.BonusStrict}o.strict||(s+="/?"),o.end?s+="$":o.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const l=new RegExp(s,o.sensitive?"":"i");function u(f){const p=f.match(l),g={};if(!p)return null;for(let b=1;b<p.length;b++){const S=p[b]||"",T=a[b-1];g[T.name]=S&&T.repeatable?S.split("/"):S}return g}function h(f){let p="",g=!1;for(const b of e){(!g||!p.endsWith("/"))&&(p+="/"),g=!1;for(const S of b)if(S.type===Fs.Static)p+=S.value;else if(S.type===Fs.Param){const{value:T,repeatable:_,optional:D}=S,M=T in f?f[T]:"";if(Xn(M)&&!_)throw new Error(`Provided param "${T}" is an array but it is not repeatable (* or + modifiers)`);const x=Xn(M)?M.join("/"):M;if(!x)if(D)b.length<2&&(p.endsWith("/")?p=p.slice(0,-1):g=!0);else throw new Error(`Missing required param "${T}"`);p+=x}}return p||"/"}return{re:l,score:i,keys:a,parse:u,stringify:h}}function Uy(e,t){let o=0;for(;o<e.length&&o<t.length;){const i=t[o]-e[o];if(i)return i;o++}return e.length<t.length?e.length===1&&e[0]===pn.Static+pn.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===pn.Static+pn.Segment?1:-1:0}function Xf(e,t){let o=0;const i=e.score,s=t.score;for(;o<i.length&&o<s.length;){const a=Uy(i[o],s[o]);if(a)return a;o++}if(Math.abs(s.length-i.length)===1){if(Dd(i))return 1;if(Dd(s))return-1}return s.length-i.length}function Dd(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const Hy={strict:!1,end:!0,sensitive:!1};function Vy(e,t,o){const i=zy(By(e.path),o),s=mt(i,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function Zy(e,t){const o=[],i=new Map;t=xd(Hy,t);function s(g){return i.get(g)}function a(g,b,S){const T=!S,_=Rd(g);_.aliasOf=S&&S.record;const D=xd(t,g),M=[_];if("alias"in g){const A=typeof g.alias=="string"?[g.alias]:g.alias;for(const I of A)M.push(Rd(mt({},_,{components:S?S.record.components:_.components,path:I,aliasOf:S?S.record:_})))}let x,C;for(const A of M){const{path:I}=A;if(b&&I[0]!=="/"){const $=b.record.path,E=$[$.length-1]==="/"?"":"/";A.path=b.record.path+(I&&E+I)}if(x=Vy(A,b,D),S?S.alias.push(x):(C=C||x,C!==x&&C.alias.push(x),T&&g.name&&!Bd(x)&&l(g.name)),Qf(x)&&h(x),_.children){const $=_.children;for(let E=0;E<$.length;E++)a($[E],x,S&&S.children[E])}S=S||x}return C?()=>{l(C)}:Sa}function l(g){if(Kf(g)){const b=i.get(g);b&&(i.delete(g),o.splice(o.indexOf(b),1),b.children.forEach(l),b.alias.forEach(l))}else{const b=o.indexOf(g);b>-1&&(o.splice(b,1),g.record.name&&i.delete(g.record.name),g.children.forEach(l),g.alias.forEach(l))}}function u(){return o}function h(g){const b=qy(g,o);o.splice(b,0,g),g.record.name&&!Bd(g)&&i.set(g.record.name,g)}function f(g,b){let S,T={},_,D;if("name"in g&&g.name){if(S=i.get(g.name),!S)throw $i(Rt.MATCHER_NOT_FOUND,{location:g});D=S.record.name,T=mt(Od(b.params,S.keys.filter(C=>!C.optional).concat(S.parent?S.parent.keys.filter(C=>C.optional):[]).map(C=>C.name)),g.params&&Od(g.params,S.keys.map(C=>C.name))),_=S.stringify(T)}else if(g.path!=null)_=g.path,S=o.find(C=>C.re.test(_)),S&&(T=S.parse(_),D=S.record.name);else{if(S=b.name?i.get(b.name):o.find(C=>C.re.test(b.path)),!S)throw $i(Rt.MATCHER_NOT_FOUND,{location:g,currentLocation:b});D=S.record.name,T=mt({},b.params,g.params),_=S.stringify(T)}const M=[];let x=S;for(;x;)M.unshift(x.record),x=x.parent;return{name:D,path:_,params:T,matched:M,meta:Wy(M)}}e.forEach(g=>a(g));function p(){o.length=0,i.clear()}return{addRoute:a,resolve:f,removeRoute:l,clearRoutes:p,getRoutes:u,getRecordMatcher:s}}function Od(e,t){const o={};for(const i of t)i in e&&(o[i]=e[i]);return o}function Rd(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:jy(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function jy(e){const t={},o=e.props||!1;if("component"in e)t.default=o;else for(const i in e.components)t[i]=typeof o=="object"?o[i]:o;return t}function Bd(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Wy(e){return e.reduce((t,o)=>mt(t,o.meta),{})}function qy(e,t){let o=0,i=t.length;for(;o!==i;){const a=o+i>>1;Xf(e,t[a])<0?i=a:o=a+1}const s=Gy(e);return s&&(i=t.lastIndexOf(s,i-1)),i}function Gy(e){let t=e;for(;t=t.parent;)if(Qf(t)&&Xf(e,t)===0)return t}function Qf({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Nd(e){const t=Rn(hl),o=Rn(ou),i=ae(()=>{const h=V(e.to);return t.resolve(h)}),s=ae(()=>{const{matched:h}=i.value,{length:f}=h,p=h[f-1],g=o.matched;if(!p||!g.length)return-1;const b=g.findIndex(Ii.bind(null,p));if(b>-1)return b;const S=Fd(h[f-2]);return f>1&&Fd(p)===S&&g[g.length-1].path!==S?g.findIndex(Ii.bind(null,h[f-2])):b}),a=ae(()=>s.value>-1&&Qy(o.params,i.value.params)),l=ae(()=>s.value>-1&&s.value===o.matched.length-1&&Gf(o.params,i.value.params));function u(h={}){if(Xy(h)){const f=t[V(e.replace)?"replace":"push"](V(e.to)).catch(Sa);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>f),f}return Promise.resolve()}return{route:i,href:ae(()=>i.value.href),isActive:a,isExactActive:l,navigate:u}}function Ky(e){return e.length===1?e[0]:e}const Yy=rf({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Nd,setup(e,{slots:t}){const o=Fa(Nd(e)),{options:i}=Rn(hl),s=ae(()=>({[zd(e.activeClass,i.linkActiveClass,"router-link-active")]:o.isActive,[zd(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:o.isExactActive}));return()=>{const a=t.default&&Ky(t.default(o));return e.custom?a:eu("a",{"aria-current":o.isExactActive?e.ariaCurrentValue:null,href:o.href,onClick:o.navigate,class:s.value},a)}}}),Jy=Yy;function Xy(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function Qy(e,t){for(const o in t){const i=t[o],s=e[o];if(typeof i=="string"){if(i!==s)return!1}else if(!Xn(s)||s.length!==i.length||i.some((a,l)=>a.valueOf()!==s[l].valueOf()))return!1}return!0}function Fd(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const zd=(e,t,o)=>e??t??o,e_=rf({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:o}){const i=Rn(Sc),s=ae(()=>e.route||i.value),a=Rn(Ad,0),l=ae(()=>{let f=V(a);const{matched:p}=s.value;let g;for(;(g=p[f])&&!g.components;)f++;return f}),u=ae(()=>s.value.matched[l.value]);xr(Ad,ae(()=>l.value+1)),xr(Iy,u),xr(Sc,s);const h=O();return Ke(()=>[h.value,u.value,e.name],([f,p,g],[b,S,T])=>{p&&(p.instances[g]=f,S&&S!==p&&f&&f===b&&(p.leaveGuards.size||(p.leaveGuards=S.leaveGuards),p.updateGuards.size||(p.updateGuards=S.updateGuards))),f&&p&&(!S||!Ii(p,S)||!b)&&(p.enterCallbacks[g]||[]).forEach(_=>_(f))},{flush:"post"}),()=>{const f=s.value,p=e.name,g=u.value,b=g&&g.components[p];if(!b)return Ud(o.default,{Component:b,route:f});const S=g.props[p],T=S?S===!0?f.params:typeof S=="function"?S(f):S:null,D=eu(b,mt({},T,t,{onVnodeUnmounted:M=>{M.component.isUnmounted&&(g.instances[p]=null)},ref:h}));return Ud(o.default,{Component:D,route:f})||D}}});function Ud(e,t){if(!e)return null;const o=e(t);return o.length===1?o[0]:o}const t_=e_;function n_(e){const t=Zy(e.routes,e),o=e.parseQuery||xy,i=e.stringifyQuery||Md,s=e.history,a=ua(),l=ua(),u=ua(),h=Hv(ss);let f=ss;mi&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const p=Xl.bind(null,se=>""+se),g=Xl.bind(null,cy),b=Xl.bind(null,Da);function S(se,me){let ne,de;return Kf(se)?(ne=t.getRecordMatcher(se),de=me):de=se,t.addRoute(de,ne)}function T(se){const me=t.getRecordMatcher(se);me&&t.removeRoute(me)}function _(){return t.getRoutes().map(se=>se.record)}function D(se){return!!t.getRecordMatcher(se)}function M(se,me){if(me=mt({},me||h.value),typeof se=="string"){const Q=Ql(o,se,me.path),Z=t.resolve({path:Q.path},me),N=s.createHref(Q.fullPath);return mt(Q,Z,{params:b(Z.params),hash:Da(Q.hash),redirectedFrom:void 0,href:N})}let ne;if(se.path!=null)ne=mt({},se,{path:Ql(o,se.path,me.path).path});else{const Q=mt({},se.params);for(const Z in Q)Q[Z]==null&&delete Q[Z];ne=mt({},se,{params:g(Q)}),me.params=g(me.params)}const de=t.resolve(ne,me),Le=se.hash||"";de.params=p(b(de.params));const B=hy(i,mt({},se,{hash:ay(Le),path:de.path})),U=s.createHref(B);return mt({fullPath:B,hash:Le,query:i===Md?Ty(se.query):se.query||{}},de,{redirectedFrom:void 0,href:U})}function x(se){return typeof se=="string"?Ql(o,se,h.value.path):mt({},se)}function C(se,me){if(f!==se)return $i(Rt.NAVIGATION_CANCELLED,{from:me,to:se})}function A(se){return E(se)}function I(se){return A(mt(x(se),{replace:!0}))}function $(se,me){const ne=se.matched[se.matched.length-1];if(ne&&ne.redirect){const{redirect:de}=ne;let Le=typeof de=="function"?de(se,me):de;return typeof Le=="string"&&(Le=Le.includes("?")||Le.includes("#")?Le=x(Le):{path:Le},Le.params={}),mt({query:se.query,hash:se.hash,params:Le.path!=null?{}:se.params},Le)}}function E(se,me){const ne=f=M(se),de=h.value,Le=se.state,B=se.force,U=se.replace===!0,Q=$(ne,de);if(Q)return E(mt(x(Q),{state:typeof Q=="object"?mt({},Le,Q.state):Le,force:B,replace:U}),me||ne);const Z=ne;Z.redirectedFrom=me;let N;return!B&&fy(i,de,ne)&&(N=$i(Rt.NAVIGATION_DUPLICATED,{to:Z,from:de}),pe(de,de,!0,!1)),(N?Promise.resolve(N):ge(Z,de)).catch(R=>$o(R)?$o(R,Rt.NAVIGATION_GUARD_REDIRECT)?R:K(R):j(R,Z,de)).then(R=>{if(R){if($o(R,Rt.NAVIGATION_GUARD_REDIRECT))return E(mt({replace:U},x(R.to),{state:typeof R.to=="object"?mt({},Le,R.to.state):Le,force:B}),me||Z)}else R=ve(Z,de,!0,U,Le);return re(Z,de,R),R})}function ie(se,me){const ne=C(se,me);return ne?Promise.reject(ne):Promise.resolve()}function ce(se){const me=De.values().next().value;return me&&typeof me.runWithContext=="function"?me.runWithContext(se):se()}function ge(se,me){let ne;const[de,Le,B]=$y(se,me);ne=tc(de.reverse(),"beforeRouteLeave",se,me);for(const Q of de)Q.leaveGuards.forEach(Z=>{ne.push(cs(Z,se,me))});const U=ie.bind(null,se,me);return ne.push(U),Ee(ne).then(()=>{ne=[];for(const Q of a.list())ne.push(cs(Q,se,me));return ne.push(U),Ee(ne)}).then(()=>{ne=tc(Le,"beforeRouteUpdate",se,me);for(const Q of Le)Q.updateGuards.forEach(Z=>{ne.push(cs(Z,se,me))});return ne.push(U),Ee(ne)}).then(()=>{ne=[];for(const Q of B)if(Q.beforeEnter)if(Xn(Q.beforeEnter))for(const Z of Q.beforeEnter)ne.push(cs(Z,se,me));else ne.push(cs(Q.beforeEnter,se,me));return ne.push(U),Ee(ne)}).then(()=>(se.matched.forEach(Q=>Q.enterCallbacks={}),ne=tc(B,"beforeRouteEnter",se,me,ce),ne.push(U),Ee(ne))).then(()=>{ne=[];for(const Q of l.list())ne.push(cs(Q,se,me));return ne.push(U),Ee(ne)}).catch(Q=>$o(Q,Rt.NAVIGATION_CANCELLED)?Q:Promise.reject(Q))}function re(se,me,ne){u.list().forEach(de=>ce(()=>de(se,me,ne)))}function ve(se,me,ne,de,Le){const B=C(se,me);if(B)return B;const U=me===ss,Q=mi?history.state:{};ne&&(de||U?s.replace(se.fullPath,mt({scroll:U&&Q&&Q.scroll},Le)):s.push(se.fullPath,Le)),h.value=se,pe(se,me,ne,U),K()}let Be;function He(){Be||(Be=s.listen((se,me,ne)=>{if(!Se.listening)return;const de=M(se),Le=$(de,Se.currentRoute.value);if(Le){E(mt(Le,{replace:!0,force:!0}),de).catch(Sa);return}f=de;const B=h.value;mi&&by($d(B.fullPath,ne.delta),dl()),ge(de,B).catch(U=>$o(U,Rt.NAVIGATION_ABORTED|Rt.NAVIGATION_CANCELLED)?U:$o(U,Rt.NAVIGATION_GUARD_REDIRECT)?(E(mt(x(U.to),{force:!0}),de).then(Q=>{$o(Q,Rt.NAVIGATION_ABORTED|Rt.NAVIGATION_DUPLICATED)&&!ne.delta&&ne.type===Cc.pop&&s.go(-1,!1)}).catch(Sa),Promise.reject()):(ne.delta&&s.go(-ne.delta,!1),j(U,de,B))).then(U=>{U=U||ve(de,B,!1),U&&(ne.delta&&!$o(U,Rt.NAVIGATION_CANCELLED)?s.go(-ne.delta,!1):ne.type===Cc.pop&&$o(U,Rt.NAVIGATION_ABORTED|Rt.NAVIGATION_DUPLICATED)&&s.go(-1,!1)),re(de,B,U)}).catch(Sa)}))}let Oe=ua(),fe=ua(),q;function j(se,me,ne){K(se);const de=fe.list();return de.length?de.forEach(Le=>Le(se,me,ne)):console.error(se),Promise.reject(se)}function ue(){return q&&h.value!==ss?Promise.resolve():new Promise((se,me)=>{Oe.add([se,me])})}function K(se){return q||(q=!se,He(),Oe.list().forEach(([me,ne])=>se?ne(se):me()),Oe.reset()),se}function pe(se,me,ne,de){const{scrollBehavior:Le}=e;if(!mi||!Le)return Promise.resolve();const B=!ne&&wy($d(se.fullPath,0))||(de||!ne)&&history.state&&history.state.scroll||null;return xi().then(()=>Le(se,me,B)).then(U=>U&&ky(U)).catch(U=>j(U,se,me))}const X=se=>s.go(se);let we;const De=new Set,Se={currentRoute:h,listening:!0,addRoute:S,removeRoute:T,clearRoutes:t.clearRoutes,hasRoute:D,getRoutes:_,resolve:M,options:e,push:A,replace:I,go:X,back:()=>X(-1),forward:()=>X(1),beforeEach:a.add,beforeResolve:l.add,afterEach:u.add,onError:fe.add,isReady:ue,install(se){se.component("RouterLink",Jy),se.component("RouterView",t_),se.config.globalProperties.$router=Se,Object.defineProperty(se.config.globalProperties,"$route",{enumerable:!0,get:()=>V(h)}),mi&&!we&&h.value===ss&&(we=!0,A(s.location).catch(de=>{}));const me={};for(const de in ss)Object.defineProperty(me,de,{get:()=>h.value[de],enumerable:!0});se.provide(hl,Se),se.provide(ou,Uh(me)),se.provide(Sc,h);const ne=se.unmount;De.add(se),se.unmount=function(){De.delete(se),De.size<1&&(f=ss,Be&&Be(),Be=null,h.value=ss,we=!1,q=!1),ne()}}};function Ee(se){return se.reduce((me,ne)=>me.then(()=>ce(ne)),Promise.resolve())}return Se}function Ha(){return Rn(hl)}function su(e){return Rn(ou)}const o_={},s_={class:"home"},i_={class:"container"},a_={class:"actions"};function r_(e,t){const o=al("router-link");return m(),y("div",s_,[c("div",i_,[t[1]||(t[1]=c("h1",null,"Volunteer Check-in System ",-1)),t[2]||(t[2]=c("p",{class:"subtitle"},"Manage race marshals and volunteers with ease",-1)),c("div",a_,[Ve(o,{to:"/admin/login",class:"btn btn-primary"},{default:tt(()=>[...t[0]||(t[0]=[We(" Admin Portal ",-1)])]),_:1})]),t[3]||(t[3]=$f('<div class="features" data-v-536ab6a4><div class="feature-card" data-v-536ab6a4><h3 data-v-536ab6a4>For Admins</h3><ul data-v-536ab6a4><li data-v-536ab6a4>Create and manage events</li><li data-v-536ab6a4>Define marshal locations</li><li data-v-536ab6a4>Assign marshals to locations</li><li data-v-536ab6a4>Real-time check-in monitoring</li><li data-v-536ab6a4>Map view of all locations</li></ul></div><div class="feature-card" data-v-536ab6a4><h3 data-v-536ab6a4>For Marshals</h3><ul data-v-536ab6a4><li data-v-536ab6a4>View your assigned location</li><li data-v-536ab6a4>Check in with GPS verification</li><li data-v-536ab6a4>Access emergency contact info</li><li data-v-536ab6a4>View all marshal locations</li></ul></div></div>',1))])])}const l_=Xe(o_,[["render",r_],["__scopeId","data-v-536ab6a4"]]);function ep(e,t){return function(){return e.apply(t,arguments)}}const{toString:c_}=Object.prototype,{getPrototypeOf:iu}=Object,{iterator:fl,toStringTag:tp}=Symbol,pl=(e=>t=>{const o=c_.call(t);return e[o]||(e[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),Qn=e=>(e=e.toLowerCase(),t=>pl(t)===e),vl=e=>t=>typeof t===e,{isArray:Ei}=Array,Mi=vl("undefined");function Va(e){return e!==null&&!Mi(e)&&e.constructor!==null&&!Mi(e.constructor)&&kn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const np=Qn("ArrayBuffer");function u_(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&np(e.buffer),t}const d_=vl("string"),kn=vl("function"),op=vl("number"),Za=e=>e!==null&&typeof e=="object",h_=e=>e===!0||e===!1,Ar=e=>{if(pl(e)!=="object")return!1;const t=iu(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(tp in e)&&!(fl in e)},f_=e=>{if(!Za(e)||Va(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},p_=Qn("Date"),v_=Qn("File"),m_=Qn("Blob"),g_=Qn("FileList"),y_=e=>Za(e)&&kn(e.pipe),__=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||kn(e.append)&&((t=pl(e))==="formdata"||t==="object"&&kn(e.toString)&&e.toString()==="[object FormData]"))},k_=Qn("URLSearchParams"),[b_,w_,C_,L_]=["ReadableStream","Request","Response","Headers"].map(Qn),S_=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ja(e,t,{allOwnKeys:o=!1}={}){if(e===null||typeof e>"u")return;let i,s;if(typeof e!="object"&&(e=[e]),Ei(e))for(i=0,s=e.length;i<s;i++)t.call(null,e[i],i,e);else{if(Va(e))return;const a=o?Object.getOwnPropertyNames(e):Object.keys(e),l=a.length;let u;for(i=0;i<l;i++)u=a[i],t.call(null,e[u],u,e)}}function sp(e,t){if(Va(e))return null;t=t.toLowerCase();const o=Object.keys(e);let i=o.length,s;for(;i-- >0;)if(s=o[i],t===s.toLowerCase())return s;return null}const zs=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ip=e=>!Mi(e)&&e!==zs;function xc(){const{caseless:e,skipUndefined:t}=ip(this)&&this||{},o={},i=(s,a)=>{const l=e&&sp(o,a)||a;Ar(o[l])&&Ar(s)?o[l]=xc(o[l],s):Ar(s)?o[l]=xc({},s):Ei(s)?o[l]=s.slice():(!t||!Mi(s))&&(o[l]=s)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&ja(arguments[s],i);return o}const x_=(e,t,o,{allOwnKeys:i}={})=>(ja(t,(s,a)=>{o&&kn(s)?e[a]=ep(s,o):e[a]=s},{allOwnKeys:i}),e),T_=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),I_=(e,t,o,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),o&&Object.assign(e.prototype,o)},$_=(e,t,o,i)=>{let s,a,l;const u={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),a=s.length;a-- >0;)l=s[a],(!i||i(l,e,t))&&!u[l]&&(t[l]=e[l],u[l]=!0);e=o!==!1&&iu(e)}while(e&&(!o||o(e,t))&&e!==Object.prototype);return t},M_=(e,t,o)=>{e=String(e),(o===void 0||o>e.length)&&(o=e.length),o-=t.length;const i=e.indexOf(t,o);return i!==-1&&i===o},A_=e=>{if(!e)return null;if(Ei(e))return e;let t=e.length;if(!op(t))return null;const o=new Array(t);for(;t-- >0;)o[t]=e[t];return o},E_=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&iu(Uint8Array)),P_=(e,t)=>{const i=(e&&e[fl]).call(e);let s;for(;(s=i.next())&&!s.done;){const a=s.value;t.call(e,a[0],a[1])}},D_=(e,t)=>{let o;const i=[];for(;(o=e.exec(t))!==null;)i.push(o);return i},O_=Qn("HTMLFormElement"),R_=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,i,s){return i.toUpperCase()+s}),Hd=(({hasOwnProperty:e})=>(t,o)=>e.call(t,o))(Object.prototype),B_=Qn("RegExp"),ap=(e,t)=>{const o=Object.getOwnPropertyDescriptors(e),i={};ja(o,(s,a)=>{let l;(l=t(s,a,e))!==!1&&(i[a]=l||s)}),Object.defineProperties(e,i)},N_=e=>{ap(e,(t,o)=>{if(kn(e)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const i=e[o];if(kn(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},F_=(e,t)=>{const o={},i=s=>{s.forEach(a=>{o[a]=!0})};return Ei(e)?i(e):i(String(e).split(t)),o},z_=()=>{},U_=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function H_(e){return!!(e&&kn(e.append)&&e[tp]==="FormData"&&e[fl])}const V_=e=>{const t=new Array(10),o=(i,s)=>{if(Za(i)){if(t.indexOf(i)>=0)return;if(Va(i))return i;if(!("toJSON"in i)){t[s]=i;const a=Ei(i)?[]:{};return ja(i,(l,u)=>{const h=o(l,s+1);!Mi(h)&&(a[u]=h)}),t[s]=void 0,a}}return i};return o(e,0)},Z_=Qn("AsyncFunction"),j_=e=>e&&(Za(e)||kn(e))&&kn(e.then)&&kn(e.catch),rp=((e,t)=>e?setImmediate:t?((o,i)=>(zs.addEventListener("message",({source:s,data:a})=>{s===zs&&a===o&&i.length&&i.shift()()},!1),s=>{i.push(s),zs.postMessage(o,"*")}))(`axios@${Math.random()}`,[]):o=>setTimeout(o))(typeof setImmediate=="function",kn(zs.postMessage)),W_=typeof queueMicrotask<"u"?queueMicrotask.bind(zs):typeof process<"u"&&process.nextTick||rp,q_=e=>e!=null&&kn(e[fl]),_e={isArray:Ei,isArrayBuffer:np,isBuffer:Va,isFormData:__,isArrayBufferView:u_,isString:d_,isNumber:op,isBoolean:h_,isObject:Za,isPlainObject:Ar,isEmptyObject:f_,isReadableStream:b_,isRequest:w_,isResponse:C_,isHeaders:L_,isUndefined:Mi,isDate:p_,isFile:v_,isBlob:m_,isRegExp:B_,isFunction:kn,isStream:y_,isURLSearchParams:k_,isTypedArray:E_,isFileList:g_,forEach:ja,merge:xc,extend:x_,trim:S_,stripBOM:T_,inherits:I_,toFlatObject:$_,kindOf:pl,kindOfTest:Qn,endsWith:M_,toArray:A_,forEachEntry:P_,matchAll:D_,isHTMLForm:O_,hasOwnProperty:Hd,hasOwnProp:Hd,reduceDescriptors:ap,freezeMethods:N_,toObjectSet:F_,toCamelCase:R_,noop:z_,toFiniteNumber:U_,findKey:sp,global:zs,isContextDefined:ip,isSpecCompliantForm:H_,toJSONObject:V_,isAsyncFn:Z_,isThenable:j_,setImmediate:rp,asap:W_,isIterable:q_};function dt(e,t,o,i,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),o&&(this.config=o),i&&(this.request=i),s&&(this.response=s,this.status=s.status?s.status:null)}_e.inherits(dt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:_e.toJSONObject(this.config),code:this.code,status:this.status}}});const lp=dt.prototype,cp={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{cp[e]={value:e}});Object.defineProperties(dt,cp);Object.defineProperty(lp,"isAxiosError",{value:!0});dt.from=(e,t,o,i,s,a)=>{const l=Object.create(lp);_e.toFlatObject(e,l,function(p){return p!==Error.prototype},f=>f!=="isAxiosError");const u=e&&e.message?e.message:"Error",h=t==null&&e?e.code:t;return dt.call(l,u,h,o,i,s),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",a&&Object.assign(l,a),l};const G_=null;function Tc(e){return _e.isPlainObject(e)||_e.isArray(e)}function up(e){return _e.endsWith(e,"[]")?e.slice(0,-2):e}function Vd(e,t,o){return e?e.concat(t).map(function(s,a){return s=up(s),!o&&a?"["+s+"]":s}).join(o?".":""):t}function K_(e){return _e.isArray(e)&&!e.some(Tc)}const Y_=_e.toFlatObject(_e,{},null,function(t){return/^is[A-Z]/.test(t)});function ml(e,t,o){if(!_e.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,o=_e.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(_,D){return!_e.isUndefined(D[_])});const i=o.metaTokens,s=o.visitor||p,a=o.dots,l=o.indexes,h=(o.Blob||typeof Blob<"u"&&Blob)&&_e.isSpecCompliantForm(t);if(!_e.isFunction(s))throw new TypeError("visitor must be a function");function f(T){if(T===null)return"";if(_e.isDate(T))return T.toISOString();if(_e.isBoolean(T))return T.toString();if(!h&&_e.isBlob(T))throw new dt("Blob is not supported. Use a Buffer instead.");return _e.isArrayBuffer(T)||_e.isTypedArray(T)?h&&typeof Blob=="function"?new Blob([T]):Buffer.from(T):T}function p(T,_,D){let M=T;if(T&&!D&&typeof T=="object"){if(_e.endsWith(_,"{}"))_=i?_:_.slice(0,-2),T=JSON.stringify(T);else if(_e.isArray(T)&&K_(T)||(_e.isFileList(T)||_e.endsWith(_,"[]"))&&(M=_e.toArray(T)))return _=up(_),M.forEach(function(C,A){!(_e.isUndefined(C)||C===null)&&t.append(l===!0?Vd([_],A,a):l===null?_:_+"[]",f(C))}),!1}return Tc(T)?!0:(t.append(Vd(D,_,a),f(T)),!1)}const g=[],b=Object.assign(Y_,{defaultVisitor:p,convertValue:f,isVisitable:Tc});function S(T,_){if(!_e.isUndefined(T)){if(g.indexOf(T)!==-1)throw Error("Circular reference detected in "+_.join("."));g.push(T),_e.forEach(T,function(M,x){(!(_e.isUndefined(M)||M===null)&&s.call(t,M,_e.isString(x)?x.trim():x,_,b))===!0&&S(M,_?_.concat(x):[x])}),g.pop()}}if(!_e.isObject(e))throw new TypeError("data must be an object");return S(e),t}function Zd(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function au(e,t){this._pairs=[],e&&ml(e,this,t)}const dp=au.prototype;dp.append=function(t,o){this._pairs.push([t,o])};dp.toString=function(t){const o=t?function(i){return t.call(this,i,Zd)}:Zd;return this._pairs.map(function(s){return o(s[0])+"="+o(s[1])},"").join("&")};function J_(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function hp(e,t,o){if(!t)return e;const i=o&&o.encode||J_;_e.isFunction(o)&&(o={serialize:o});const s=o&&o.serialize;let a;if(s?a=s(t,o):a=_e.isURLSearchParams(t)?t.toString():new au(t,o).toString(i),a){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class jd{constructor(){this.handlers=[]}use(t,o,i){return this.handlers.push({fulfilled:t,rejected:o,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){_e.forEach(this.handlers,function(i){i!==null&&t(i)})}}const fp={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},X_=typeof URLSearchParams<"u"?URLSearchParams:au,Q_=typeof FormData<"u"?FormData:null,e1=typeof Blob<"u"?Blob:null,t1={isBrowser:!0,classes:{URLSearchParams:X_,FormData:Q_,Blob:e1},protocols:["http","https","file","blob","url","data"]},ru=typeof window<"u"&&typeof document<"u",Ic=typeof navigator=="object"&&navigator||void 0,n1=ru&&(!Ic||["ReactNative","NativeScript","NS"].indexOf(Ic.product)<0),o1=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",s1=ru&&window.location.href||"http://localhost",i1=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ru,hasStandardBrowserEnv:n1,hasStandardBrowserWebWorkerEnv:o1,navigator:Ic,origin:s1},Symbol.toStringTag,{value:"Module"})),an={...i1,...t1};function a1(e,t){return ml(e,new an.classes.URLSearchParams,{visitor:function(o,i,s,a){return an.isNode&&_e.isBuffer(o)?(this.append(i,o.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function r1(e){return _e.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function l1(e){const t={},o=Object.keys(e);let i;const s=o.length;let a;for(i=0;i<s;i++)a=o[i],t[a]=e[a];return t}function pp(e){function t(o,i,s,a){let l=o[a++];if(l==="__proto__")return!0;const u=Number.isFinite(+l),h=a>=o.length;return l=!l&&_e.isArray(s)?s.length:l,h?(_e.hasOwnProp(s,l)?s[l]=[s[l],i]:s[l]=i,!u):((!s[l]||!_e.isObject(s[l]))&&(s[l]=[]),t(o,i,s[l],a)&&_e.isArray(s[l])&&(s[l]=l1(s[l])),!u)}if(_e.isFormData(e)&&_e.isFunction(e.entries)){const o={};return _e.forEachEntry(e,(i,s)=>{t(r1(i),s,o,0)}),o}return null}function c1(e,t,o){if(_e.isString(e))try{return(t||JSON.parse)(e),_e.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(o||JSON.stringify)(e)}const Wa={transitional:fp,adapter:["xhr","http","fetch"],transformRequest:[function(t,o){const i=o.getContentType()||"",s=i.indexOf("application/json")>-1,a=_e.isObject(t);if(a&&_e.isHTMLForm(t)&&(t=new FormData(t)),_e.isFormData(t))return s?JSON.stringify(pp(t)):t;if(_e.isArrayBuffer(t)||_e.isBuffer(t)||_e.isStream(t)||_e.isFile(t)||_e.isBlob(t)||_e.isReadableStream(t))return t;if(_e.isArrayBufferView(t))return t.buffer;if(_e.isURLSearchParams(t))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(a){if(i.indexOf("application/x-www-form-urlencoded")>-1)return a1(t,this.formSerializer).toString();if((u=_e.isFileList(t))||i.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return ml(u?{"files[]":t}:t,h&&new h,this.formSerializer)}}return a||s?(o.setContentType("application/json",!1),c1(t)):t}],transformResponse:[function(t){const o=this.transitional||Wa.transitional,i=o&&o.forcedJSONParsing,s=this.responseType==="json";if(_e.isResponse(t)||_e.isReadableStream(t))return t;if(t&&_e.isString(t)&&(i&&!this.responseType||s)){const l=!(o&&o.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(u){if(l)throw u.name==="SyntaxError"?dt.from(u,dt.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:an.classes.FormData,Blob:an.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};_e.forEach(["delete","get","head","post","put","patch"],e=>{Wa.headers[e]={}});const u1=_e.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),d1=e=>{const t={};let o,i,s;return e&&e.split(`
`).forEach(function(l){s=l.indexOf(":"),o=l.substring(0,s).trim().toLowerCase(),i=l.substring(s+1).trim(),!(!o||t[o]&&u1[o])&&(o==="set-cookie"?t[o]?t[o].push(i):t[o]=[i]:t[o]=t[o]?t[o]+", "+i:i)}),t},Wd=Symbol("internals");function da(e){return e&&String(e).trim().toLowerCase()}function Er(e){return e===!1||e==null?e:_e.isArray(e)?e.map(Er):String(e)}function h1(e){const t=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=o.exec(e);)t[i[1]]=i[2];return t}const f1=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function nc(e,t,o,i,s){if(_e.isFunction(i))return i.call(this,t,o);if(s&&(t=o),!!_e.isString(t)){if(_e.isString(i))return t.indexOf(i)!==-1;if(_e.isRegExp(i))return i.test(t)}}function p1(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,o,i)=>o.toUpperCase()+i)}function v1(e,t){const o=_e.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+o,{value:function(s,a,l){return this[i].call(this,t,s,a,l)},configurable:!0})})}let bn=class{constructor(t){t&&this.set(t)}set(t,o,i){const s=this;function a(u,h,f){const p=da(h);if(!p)throw new Error("header name must be a non-empty string");const g=_e.findKey(s,p);(!g||s[g]===void 0||f===!0||f===void 0&&s[g]!==!1)&&(s[g||h]=Er(u))}const l=(u,h)=>_e.forEach(u,(f,p)=>a(f,p,h));if(_e.isPlainObject(t)||t instanceof this.constructor)l(t,o);else if(_e.isString(t)&&(t=t.trim())&&!f1(t))l(d1(t),o);else if(_e.isObject(t)&&_e.isIterable(t)){let u={},h,f;for(const p of t){if(!_e.isArray(p))throw TypeError("Object iterator must return a key-value pair");u[f=p[0]]=(h=u[f])?_e.isArray(h)?[...h,p[1]]:[h,p[1]]:p[1]}l(u,o)}else t!=null&&a(o,t,i);return this}get(t,o){if(t=da(t),t){const i=_e.findKey(this,t);if(i){const s=this[i];if(!o)return s;if(o===!0)return h1(s);if(_e.isFunction(o))return o.call(this,s,i);if(_e.isRegExp(o))return o.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,o){if(t=da(t),t){const i=_e.findKey(this,t);return!!(i&&this[i]!==void 0&&(!o||nc(this,this[i],i,o)))}return!1}delete(t,o){const i=this;let s=!1;function a(l){if(l=da(l),l){const u=_e.findKey(i,l);u&&(!o||nc(i,i[u],u,o))&&(delete i[u],s=!0)}}return _e.isArray(t)?t.forEach(a):a(t),s}clear(t){const o=Object.keys(this);let i=o.length,s=!1;for(;i--;){const a=o[i];(!t||nc(this,this[a],a,t,!0))&&(delete this[a],s=!0)}return s}normalize(t){const o=this,i={};return _e.forEach(this,(s,a)=>{const l=_e.findKey(i,a);if(l){o[l]=Er(s),delete o[a];return}const u=t?p1(a):String(a).trim();u!==a&&delete o[a],o[u]=Er(s),i[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const o=Object.create(null);return _e.forEach(this,(i,s)=>{i!=null&&i!==!1&&(o[s]=t&&_e.isArray(i)?i.join(", "):i)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,o])=>t+": "+o).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...o){const i=new this(t);return o.forEach(s=>i.set(s)),i}static accessor(t){const i=(this[Wd]=this[Wd]={accessors:{}}).accessors,s=this.prototype;function a(l){const u=da(l);i[u]||(v1(s,l),i[u]=!0)}return _e.isArray(t)?t.forEach(a):a(t),this}};bn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);_e.reduceDescriptors(bn.prototype,({value:e},t)=>{let o=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[o]=i}}});_e.freezeMethods(bn);function oc(e,t){const o=this||Wa,i=t||o,s=bn.from(i.headers);let a=i.data;return _e.forEach(e,function(u){a=u.call(o,a,s.normalize(),t?t.status:void 0)}),s.normalize(),a}function vp(e){return!!(e&&e.__CANCEL__)}function Pi(e,t,o){dt.call(this,e??"canceled",dt.ERR_CANCELED,t,o),this.name="CanceledError"}_e.inherits(Pi,dt,{__CANCEL__:!0});function mp(e,t,o){const i=o.config.validateStatus;!o.status||!i||i(o.status)?e(o):t(new dt("Request failed with status code "+o.status,[dt.ERR_BAD_REQUEST,dt.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}function m1(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function g1(e,t){e=e||10;const o=new Array(e),i=new Array(e);let s=0,a=0,l;return t=t!==void 0?t:1e3,function(h){const f=Date.now(),p=i[a];l||(l=f),o[s]=h,i[s]=f;let g=a,b=0;for(;g!==s;)b+=o[g++],g=g%e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),f-l<t)return;const S=p&&f-p;return S?Math.round(b*1e3/S):void 0}}function y1(e,t){let o=0,i=1e3/t,s,a;const l=(f,p=Date.now())=>{o=p,s=null,a&&(clearTimeout(a),a=null),e(...f)};return[(...f)=>{const p=Date.now(),g=p-o;g>=i?l(f,p):(s=f,a||(a=setTimeout(()=>{a=null,l(s)},i-g)))},()=>s&&l(s)]}const Zr=(e,t,o=3)=>{let i=0;const s=g1(50,250);return y1(a=>{const l=a.loaded,u=a.lengthComputable?a.total:void 0,h=l-i,f=s(h),p=l<=u;i=l;const g={loaded:l,total:u,progress:u?l/u:void 0,bytes:h,rate:f||void 0,estimated:f&&u&&p?(u-l)/f:void 0,event:a,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(g)},o)},qd=(e,t)=>{const o=e!=null;return[i=>t[0]({lengthComputable:o,total:e,loaded:i}),t[1]]},Gd=e=>(...t)=>_e.asap(()=>e(...t)),_1=an.hasStandardBrowserEnv?((e,t)=>o=>(o=new URL(o,an.origin),e.protocol===o.protocol&&e.host===o.host&&(t||e.port===o.port)))(new URL(an.origin),an.navigator&&/(msie|trident)/i.test(an.navigator.userAgent)):()=>!0,k1=an.hasStandardBrowserEnv?{write(e,t,o,i,s,a,l){if(typeof document>"u")return;const u=[`${e}=${encodeURIComponent(t)}`];_e.isNumber(o)&&u.push(`expires=${new Date(o).toUTCString()}`),_e.isString(i)&&u.push(`path=${i}`),_e.isString(s)&&u.push(`domain=${s}`),a===!0&&u.push("secure"),_e.isString(l)&&u.push(`SameSite=${l}`),document.cookie=u.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function b1(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function w1(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function gp(e,t,o){let i=!b1(t);return e&&(i||o==!1)?w1(e,t):t}const Kd=e=>e instanceof bn?{...e}:e;function qs(e,t){t=t||{};const o={};function i(f,p,g,b){return _e.isPlainObject(f)&&_e.isPlainObject(p)?_e.merge.call({caseless:b},f,p):_e.isPlainObject(p)?_e.merge({},p):_e.isArray(p)?p.slice():p}function s(f,p,g,b){if(_e.isUndefined(p)){if(!_e.isUndefined(f))return i(void 0,f,g,b)}else return i(f,p,g,b)}function a(f,p){if(!_e.isUndefined(p))return i(void 0,p)}function l(f,p){if(_e.isUndefined(p)){if(!_e.isUndefined(f))return i(void 0,f)}else return i(void 0,p)}function u(f,p,g){if(g in t)return i(f,p);if(g in e)return i(void 0,f)}const h={url:a,method:a,data:a,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:u,headers:(f,p,g)=>s(Kd(f),Kd(p),g,!0)};return _e.forEach(Object.keys({...e,...t}),function(p){const g=h[p]||s,b=g(e[p],t[p],p);_e.isUndefined(b)&&g!==u||(o[p]=b)}),o}const yp=e=>{const t=qs({},e);let{data:o,withXSRFToken:i,xsrfHeaderName:s,xsrfCookieName:a,headers:l,auth:u}=t;if(t.headers=l=bn.from(l),t.url=hp(gp(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&l.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),_e.isFormData(o)){if(an.hasStandardBrowserEnv||an.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(_e.isFunction(o.getHeaders)){const h=o.getHeaders(),f=["content-type","content-length"];Object.entries(h).forEach(([p,g])=>{f.includes(p.toLowerCase())&&l.set(p,g)})}}if(an.hasStandardBrowserEnv&&(i&&_e.isFunction(i)&&(i=i(t)),i||i!==!1&&_1(t.url))){const h=s&&a&&k1.read(a);h&&l.set(s,h)}return t},C1=typeof XMLHttpRequest<"u",L1=C1&&function(e){return new Promise(function(o,i){const s=yp(e);let a=s.data;const l=bn.from(s.headers).normalize();let{responseType:u,onUploadProgress:h,onDownloadProgress:f}=s,p,g,b,S,T;function _(){S&&S(),T&&T(),s.cancelToken&&s.cancelToken.unsubscribe(p),s.signal&&s.signal.removeEventListener("abort",p)}let D=new XMLHttpRequest;D.open(s.method.toUpperCase(),s.url,!0),D.timeout=s.timeout;function M(){if(!D)return;const C=bn.from("getAllResponseHeaders"in D&&D.getAllResponseHeaders()),I={data:!u||u==="text"||u==="json"?D.responseText:D.response,status:D.status,statusText:D.statusText,headers:C,config:e,request:D};mp(function(E){o(E),_()},function(E){i(E),_()},I),D=null}"onloadend"in D?D.onloadend=M:D.onreadystatechange=function(){!D||D.readyState!==4||D.status===0&&!(D.responseURL&&D.responseURL.indexOf("file:")===0)||setTimeout(M)},D.onabort=function(){D&&(i(new dt("Request aborted",dt.ECONNABORTED,e,D)),D=null)},D.onerror=function(A){const I=A&&A.message?A.message:"Network Error",$=new dt(I,dt.ERR_NETWORK,e,D);$.event=A||null,i($),D=null},D.ontimeout=function(){let A=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const I=s.transitional||fp;s.timeoutErrorMessage&&(A=s.timeoutErrorMessage),i(new dt(A,I.clarifyTimeoutError?dt.ETIMEDOUT:dt.ECONNABORTED,e,D)),D=null},a===void 0&&l.setContentType(null),"setRequestHeader"in D&&_e.forEach(l.toJSON(),function(A,I){D.setRequestHeader(I,A)}),_e.isUndefined(s.withCredentials)||(D.withCredentials=!!s.withCredentials),u&&u!=="json"&&(D.responseType=s.responseType),f&&([b,T]=Zr(f,!0),D.addEventListener("progress",b)),h&&D.upload&&([g,S]=Zr(h),D.upload.addEventListener("progress",g),D.upload.addEventListener("loadend",S)),(s.cancelToken||s.signal)&&(p=C=>{D&&(i(!C||C.type?new Pi(null,e,D):C),D.abort(),D=null)},s.cancelToken&&s.cancelToken.subscribe(p),s.signal&&(s.signal.aborted?p():s.signal.addEventListener("abort",p)));const x=m1(s.url);if(x&&an.protocols.indexOf(x)===-1){i(new dt("Unsupported protocol "+x+":",dt.ERR_BAD_REQUEST,e));return}D.send(a||null)})},S1=(e,t)=>{const{length:o}=e=e?e.filter(Boolean):[];if(t||o){let i=new AbortController,s;const a=function(f){if(!s){s=!0,u();const p=f instanceof Error?f:this.reason;i.abort(p instanceof dt?p:new Pi(p instanceof Error?p.message:p))}};let l=t&&setTimeout(()=>{l=null,a(new dt(`timeout ${t} of ms exceeded`,dt.ETIMEDOUT))},t);const u=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(a):f.removeEventListener("abort",a)}),e=null)};e.forEach(f=>f.addEventListener("abort",a));const{signal:h}=i;return h.unsubscribe=()=>_e.asap(u),h}},x1=function*(e,t){let o=e.byteLength;if(o<t){yield e;return}let i=0,s;for(;i<o;)s=i+t,yield e.slice(i,s),i=s},T1=async function*(e,t){for await(const o of I1(e))yield*x1(o,t)},I1=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:o,value:i}=await t.read();if(o)break;yield i}}finally{await t.cancel()}},Yd=(e,t,o,i)=>{const s=T1(e,t);let a=0,l,u=h=>{l||(l=!0,i&&i(h))};return new ReadableStream({async pull(h){try{const{done:f,value:p}=await s.next();if(f){u(),h.close();return}let g=p.byteLength;if(o){let b=a+=g;o(b)}h.enqueue(new Uint8Array(p))}catch(f){throw u(f),f}},cancel(h){return u(h),s.return()}},{highWaterMark:2})},Jd=64*1024,{isFunction:kr}=_e,$1=(({Request:e,Response:t})=>({Request:e,Response:t}))(_e.global),{ReadableStream:Xd,TextEncoder:Qd}=_e.global,eh=(e,...t)=>{try{return!!e(...t)}catch{return!1}},M1=e=>{e=_e.merge.call({skipUndefined:!0},$1,e);const{fetch:t,Request:o,Response:i}=e,s=t?kr(t):typeof fetch=="function",a=kr(o),l=kr(i);if(!s)return!1;const u=s&&kr(Xd),h=s&&(typeof Qd=="function"?(T=>_=>T.encode(_))(new Qd):async T=>new Uint8Array(await new o(T).arrayBuffer())),f=a&&u&&eh(()=>{let T=!1;const _=new o(an.origin,{body:new Xd,method:"POST",get duplex(){return T=!0,"half"}}).headers.has("Content-Type");return T&&!_}),p=l&&u&&eh(()=>_e.isReadableStream(new i("").body)),g={stream:p&&(T=>T.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(T=>{!g[T]&&(g[T]=(_,D)=>{let M=_&&_[T];if(M)return M.call(_);throw new dt(`Response type '${T}' is not supported`,dt.ERR_NOT_SUPPORT,D)})});const b=async T=>{if(T==null)return 0;if(_e.isBlob(T))return T.size;if(_e.isSpecCompliantForm(T))return(await new o(an.origin,{method:"POST",body:T}).arrayBuffer()).byteLength;if(_e.isArrayBufferView(T)||_e.isArrayBuffer(T))return T.byteLength;if(_e.isURLSearchParams(T)&&(T=T+""),_e.isString(T))return(await h(T)).byteLength},S=async(T,_)=>{const D=_e.toFiniteNumber(T.getContentLength());return D??b(_)};return async T=>{let{url:_,method:D,data:M,signal:x,cancelToken:C,timeout:A,onDownloadProgress:I,onUploadProgress:$,responseType:E,headers:ie,withCredentials:ce="same-origin",fetchOptions:ge}=yp(T),re=t||fetch;E=E?(E+"").toLowerCase():"text";let ve=S1([x,C&&C.toAbortSignal()],A),Be=null;const He=ve&&ve.unsubscribe&&(()=>{ve.unsubscribe()});let Oe;try{if($&&f&&D!=="get"&&D!=="head"&&(Oe=await S(ie,M))!==0){let pe=new o(_,{method:"POST",body:M,duplex:"half"}),X;if(_e.isFormData(M)&&(X=pe.headers.get("content-type"))&&ie.setContentType(X),pe.body){const[we,De]=qd(Oe,Zr(Gd($)));M=Yd(pe.body,Jd,we,De)}}_e.isString(ce)||(ce=ce?"include":"omit");const fe=a&&"credentials"in o.prototype,q={...ge,signal:ve,method:D.toUpperCase(),headers:ie.normalize().toJSON(),body:M,duplex:"half",credentials:fe?ce:void 0};Be=a&&new o(_,q);let j=await(a?re(Be,ge):re(_,q));const ue=p&&(E==="stream"||E==="response");if(p&&(I||ue&&He)){const pe={};["status","statusText","headers"].forEach(Se=>{pe[Se]=j[Se]});const X=_e.toFiniteNumber(j.headers.get("content-length")),[we,De]=I&&qd(X,Zr(Gd(I),!0))||[];j=new i(Yd(j.body,Jd,we,()=>{De&&De(),He&&He()}),pe)}E=E||"text";let K=await g[_e.findKey(g,E)||"text"](j,T);return!ue&&He&&He(),await new Promise((pe,X)=>{mp(pe,X,{data:K,headers:bn.from(j.headers),status:j.status,statusText:j.statusText,config:T,request:Be})})}catch(fe){throw He&&He(),fe&&fe.name==="TypeError"&&/Load failed|fetch/i.test(fe.message)?Object.assign(new dt("Network Error",dt.ERR_NETWORK,T,Be),{cause:fe.cause||fe}):dt.from(fe,fe&&fe.code,T,Be)}}},A1=new Map,_p=e=>{let t=e&&e.env||{};const{fetch:o,Request:i,Response:s}=t,a=[i,s,o];let l=a.length,u=l,h,f,p=A1;for(;u--;)h=a[u],f=p.get(h),f===void 0&&p.set(h,f=u?new Map:M1(t)),p=f;return f};_p();const lu={http:G_,xhr:L1,fetch:{get:_p}};_e.forEach(lu,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const th=e=>`- ${e}`,E1=e=>_e.isFunction(e)||e===null||e===!1;function P1(e,t){e=_e.isArray(e)?e:[e];const{length:o}=e;let i,s;const a={};for(let l=0;l<o;l++){i=e[l];let u;if(s=i,!E1(i)&&(s=lu[(u=String(i)).toLowerCase()],s===void 0))throw new dt(`Unknown adapter '${u}'`);if(s&&(_e.isFunction(s)||(s=s.get(t))))break;a[u||"#"+l]=s}if(!s){const l=Object.entries(a).map(([h,f])=>`adapter ${h} `+(f===!1?"is not supported by the environment":"is not available in the build"));let u=o?l.length>1?`since :
`+l.map(th).join(`
`):" "+th(l[0]):"as no adapter specified";throw new dt("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return s}const kp={getAdapter:P1,adapters:lu};function sc(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Pi(null,e)}function nh(e){return sc(e),e.headers=bn.from(e.headers),e.data=oc.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),kp.getAdapter(e.adapter||Wa.adapter,e)(e).then(function(i){return sc(e),i.data=oc.call(e,e.transformResponse,i),i.headers=bn.from(i.headers),i},function(i){return vp(i)||(sc(e),i&&i.response&&(i.response.data=oc.call(e,e.transformResponse,i.response),i.response.headers=bn.from(i.response.headers))),Promise.reject(i)})}const bp="1.13.2",gl={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{gl[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});const oh={};gl.transitional=function(t,o,i){function s(a,l){return"[Axios v"+bp+"] Transitional option '"+a+"'"+l+(i?". "+i:"")}return(a,l,u)=>{if(t===!1)throw new dt(s(l," has been removed"+(o?" in "+o:"")),dt.ERR_DEPRECATED);return o&&!oh[l]&&(oh[l]=!0,console.warn(s(l," has been deprecated since v"+o+" and will be removed in the near future"))),t?t(a,l,u):!0}};gl.spelling=function(t){return(o,i)=>(console.warn(`${i} is likely a misspelling of ${t}`),!0)};function D1(e,t,o){if(typeof e!="object")throw new dt("options must be an object",dt.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let s=i.length;for(;s-- >0;){const a=i[s],l=t[a];if(l){const u=e[a],h=u===void 0||l(u,a,e);if(h!==!0)throw new dt("option "+a+" must be "+h,dt.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new dt("Unknown option "+a,dt.ERR_BAD_OPTION)}}const Pr={assertOptions:D1,validators:gl},ao=Pr.validators;let Zs=class{constructor(t){this.defaults=t||{},this.interceptors={request:new jd,response:new jd}}async request(t,o){try{return await this._request(t,o)}catch(i){if(i instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{i.stack?a&&!String(i.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+a):i.stack=a}catch{}}throw i}}_request(t,o){typeof t=="string"?(o=o||{},o.url=t):o=t||{},o=qs(this.defaults,o);const{transitional:i,paramsSerializer:s,headers:a}=o;i!==void 0&&Pr.assertOptions(i,{silentJSONParsing:ao.transitional(ao.boolean),forcedJSONParsing:ao.transitional(ao.boolean),clarifyTimeoutError:ao.transitional(ao.boolean)},!1),s!=null&&(_e.isFunction(s)?o.paramsSerializer={serialize:s}:Pr.assertOptions(s,{encode:ao.function,serialize:ao.function},!0)),o.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?o.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:o.allowAbsoluteUrls=!0),Pr.assertOptions(o,{baseUrl:ao.spelling("baseURL"),withXsrfToken:ao.spelling("withXSRFToken")},!0),o.method=(o.method||this.defaults.method||"get").toLowerCase();let l=a&&_e.merge(a.common,a[o.method]);a&&_e.forEach(["delete","get","head","post","put","patch","common"],T=>{delete a[T]}),o.headers=bn.concat(l,a);const u=[];let h=!0;this.interceptors.request.forEach(function(_){typeof _.runWhen=="function"&&_.runWhen(o)===!1||(h=h&&_.synchronous,u.unshift(_.fulfilled,_.rejected))});const f=[];this.interceptors.response.forEach(function(_){f.push(_.fulfilled,_.rejected)});let p,g=0,b;if(!h){const T=[nh.bind(this),void 0];for(T.unshift(...u),T.push(...f),b=T.length,p=Promise.resolve(o);g<b;)p=p.then(T[g++],T[g++]);return p}b=u.length;let S=o;for(;g<b;){const T=u[g++],_=u[g++];try{S=T(S)}catch(D){_.call(this,D);break}}try{p=nh.call(this,S)}catch(T){return Promise.reject(T)}for(g=0,b=f.length;g<b;)p=p.then(f[g++],f[g++]);return p}getUri(t){t=qs(this.defaults,t);const o=gp(t.baseURL,t.url,t.allowAbsoluteUrls);return hp(o,t.params,t.paramsSerializer)}};_e.forEach(["delete","get","head","options"],function(t){Zs.prototype[t]=function(o,i){return this.request(qs(i||{},{method:t,url:o,data:(i||{}).data}))}});_e.forEach(["post","put","patch"],function(t){function o(i){return function(a,l,u){return this.request(qs(u||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}Zs.prototype[t]=o(),Zs.prototype[t+"Form"]=o(!0)});let O1=class wp{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(a){o=a});const i=this;this.promise.then(s=>{if(!i._listeners)return;let a=i._listeners.length;for(;a-- >0;)i._listeners[a](s);i._listeners=null}),this.promise.then=s=>{let a;const l=new Promise(u=>{i.subscribe(u),a=u}).then(s);return l.cancel=function(){i.unsubscribe(a)},l},t(function(a,l,u){i.reason||(i.reason=new Pi(a,l,u),o(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const o=this._listeners.indexOf(t);o!==-1&&this._listeners.splice(o,1)}toAbortSignal(){const t=new AbortController,o=i=>{t.abort(i)};return this.subscribe(o),t.signal.unsubscribe=()=>this.unsubscribe(o),t.signal}static source(){let t;return{token:new wp(function(s){t=s}),cancel:t}}};function R1(e){return function(o){return e.apply(null,o)}}function B1(e){return _e.isObject(e)&&e.isAxiosError===!0}const $c={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries($c).forEach(([e,t])=>{$c[t]=e});function Cp(e){const t=new Zs(e),o=ep(Zs.prototype.request,t);return _e.extend(o,Zs.prototype,t,{allOwnKeys:!0}),_e.extend(o,t,null,{allOwnKeys:!0}),o.create=function(s){return Cp(qs(e,s))},o}const Ft=Cp(Wa);Ft.Axios=Zs;Ft.CanceledError=Pi;Ft.CancelToken=O1;Ft.isCancel=vp;Ft.VERSION=bp;Ft.toFormData=ml;Ft.AxiosError=dt;Ft.Cancel=Ft.CanceledError;Ft.all=function(t){return Promise.all(t)};Ft.spread=R1;Ft.isAxiosError=B1;Ft.mergeConfig=qs;Ft.AxiosHeaders=bn;Ft.formToJSON=e=>pp(_e.isHTMLForm(e)?new FormData(e):e);Ft.getAdapter=kp.getAdapter;Ft.HttpStatusCode=$c;Ft.default=Ft;const{Axios:M5,AxiosError:A5,CanceledError:E5,isCancel:P5,CancelToken:D5,VERSION:O5,all:R5,Cancel:B5,isAxiosError:N5,spread:F5,toFormData:z5,AxiosHeaders:U5,HttpStatusCode:H5,formToJSON:V5,getAdapter:Z5,mergeConfig:j5}=Ft,N1="https://sterobson-volunteercheckin-testing.azurewebsites.net/api",F1="VolunteerCheckinOffline",z1=1;let qn=null;async function Zo(){return qn||new Promise((e,t)=>{const o=indexedDB.open(F1,z1);o.onerror=()=>{console.error("Failed to open IndexedDB:",o.error),t(o.error)},o.onsuccess=()=>{qn=o.result,e(qn)},o.onupgradeneeded=i=>{const s=i.target.result;s.objectStoreNames.contains("eventData")||s.createObjectStore("eventData",{keyPath:"eventId"}),s.objectStoreNames.contains("pendingActions")||s.createObjectStore("pendingActions",{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),s.objectStoreNames.contains("syncMeta")||s.createObjectStore("syncMeta",{keyPath:"key"})}})}async function Oa(e,t){return await Zo(),new Promise((o,i)=>{const s=qn.transaction(["eventData","syncMeta"],"readwrite"),a=s.objectStore("eventData"),l=s.objectStore("syncMeta"),u={eventId:e,...t,cachedAt:new Date().toISOString()};a.put(u),l.put({key:`lastSync_${e}`,value:new Date().toISOString()}),s.oncomplete=()=>o(),s.onerror=()=>i(s.error)})}async function ps(e){return await Zo(),new Promise((t,o)=>{const a=qn.transaction(["eventData"],"readonly").objectStore("eventData").get(e);a.onsuccess=()=>t(a.result||null),a.onerror=()=>o(a.error)})}async function fa(e,t,o){const i=await ps(e);i&&(i[t]=o,i.cachedAt=new Date().toISOString(),await Oa(e,i))}async function U1(e){return await Zo(),new Promise((t,o)=>{const s=qn.transaction(["pendingActions"],"readwrite").objectStore("pendingActions"),a={...e,createdAt:new Date().toISOString(),attempts:0,lastAttempt:null,status:"pending"},l=s.add(a);l.onsuccess=()=>t(l.result),l.onerror=()=>o(l.error)})}async function Lp(){return await Zo(),new Promise((e,t)=>{const a=qn.transaction(["pendingActions"],"readonly").objectStore("pendingActions").index("createdAt").getAll();a.onsuccess=()=>{const l=a.result.filter(u=>u.status==="pending"||u.status==="retrying");e(l)},a.onerror=()=>t(a.error)})}async function jr(){return(await Lp()).length}async function sh(e,t){return await Zo(),new Promise((o,i)=>{const s=qn.transaction(["pendingActions"],"readwrite"),a=s.objectStore("pendingActions"),l=a.get(e);l.onsuccess=()=>{const u=l.result;u&&(Object.assign(u,t),a.put(u))},s.oncomplete=()=>o(),s.onerror=()=>i(s.error)})}async function ih(e){return await Zo(),new Promise((t,o)=>{const a=qn.transaction(["pendingActions"],"readwrite").objectStore("pendingActions").delete(e);a.onsuccess=()=>t(),a.onerror=()=>o(a.error)})}async function H1(e){return await Zo(),new Promise((t,o)=>{const a=qn.transaction(["syncMeta"],"readonly").objectStore("syncMeta").get(`lastSync_${e}`);a.onsuccess=()=>t(a.result?.value||null),a.onerror=()=>o(a.error)})}const Ue=Ft.create({baseURL:N1,headers:{"Content-Type":"application/json"},timeout:15e3});let Mc=!1;async function V1(){}function ah(e){const t=[/\/events\/([^/]+)/,/\/assignments\/([^/]+)/,/\/locations\/([^/]+)/,/\/checklist-items\/([^/]+)/,/\/areas\/([^/]+)/,/\/marshals\/([^/]+)/];for(const o of t){const i=e.match(o);if(i)return i[1]}return null}function Z1(e){return!!(!e.response&&e.request||e.response&&e.response.status>=500||e.code==="ECONNABORTED")}Ue.interceptors.request.use(e=>{const t=localStorage.getItem("adminEmail");t&&(e.headers["X-Admin-Email"]=t);const o=localStorage.getItem("sessionToken");return o&&(e.headers.Authorization=`Bearer ${o}`),e});let Ac=0;const j1=2;function W1(){if(Ac++,Ac>=j1){localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken");const e=window.location.hash||"";!e.includes("/login")&&!e.includes("/verify")&&(window.location.href="/#/admin/login")}}function q1(){Ac=0}Ue.interceptors.response.use(e=>{Mc=!1,q1();const t=e.config.url,o=ah(t);return e.config.method,e},async e=>{const t=e.config;if(e.response&&(e.response.status===401||e.response.status===403))return W1(),Promise.reject(e);if(Z1(e)&&(Mc=!0,t.method==="get")){const o=ah(t.url);if(o){const i=await ps(o);if(i)return console.log("Returning cached data for:",t.url),Promise.resolve({data:i,status:200,statusText:"OK (cached)",headers:{},config:t,cached:!0})}}return Promise.reject(e)});async function Sn(e,t,o){return await U1({type:e,payload:t,eventId:t.eventId}),await V1(),{data:o,status:200,statusText:"OK (queued)",queued:!0}}function tn(){return Mc||!navigator.onLine}const uo={requestLogin:e=>Ue.post("/auth/request-login",{email:e}),verifyToken:e=>Ue.post("/auth/verify-token",{token:e}),instantLogin:e=>Ue.post("/auth/instant-login",{email:e}),createAdmin:e=>Ue.post("/auth/create-admin",{email:e}),marshalLogin:(e,t)=>Ue.post("/auth/marshal-login",{eventId:e,magicCode:t}),getMe:e=>Ue.get("/auth/me",{params:{eventId:e}}),logout:()=>Ue.post("/auth/logout")},br={getProfile:()=>Ue.get("/auth/profile"),updateProfile:e=>Ue.put("/auth/profile",e),getPerson:(e,t)=>Ue.get(`/people/${e}`,{params:{eventId:t}}),updatePerson:(e,t,o)=>Ue.put(`/people/${e}`,o,{params:{eventId:t}})},Rs={create:e=>Ue.post("/events",e),getAll:()=>Ue.get("/events"),getById:e=>Ue.get(`/events/${e}`),update:(e,t)=>Ue.put(`/events/${e}`,t),delete:e=>Ue.delete(`/events/${e}`),uploadGpx:(e,t)=>{const o=new FormData;return o.append("gpx",t),Ue.post(`/events/${e}/upload-gpx`,o,{headers:{"Content-Type":"multipart/form-data"}})}},yn={create:e=>Ue.post("/locations",e),getById:(e,t)=>Ue.get(`/locations/${e}/${t}`),getByEvent:e=>Ue.get(`/events/${e}/locations`),update:(e,t,o)=>Ue.put(`/locations/${e}/${t}`,o),delete:(e,t)=>Ue.delete(`/locations/${e}/${t}`),importCsv:(e,t,o)=>{const i=new FormData;return i.append("csv",t),Ue.post(`/locations/import/${e}?deleteExisting=${o}`,i,{headers:{"Content-Type":"multipart/form-data"}})},bulkUpdateTimes:(e,t)=>Ue.post(`/locations/bulk-update-times/${e}`,{timeDelta:t}),updatePosition:(e,t,o)=>Ue.post(`/locations/${e}/${t}/update-position`,o),getDynamicCheckpoints:e=>Ue.get(`/events/${e}/dynamic-checkpoints`)},pa={create:e=>Ue.post("/assignments",e),getById:(e,t)=>Ue.get(`/assignments/${e}/${t}`),getByEvent:e=>Ue.get(`/assignments/event/${e}`),delete:(e,t)=>Ue.delete(`/assignments/${e}/${t}`),getEventStatus:e=>Ue.get(`/events/${e}/status`)},Bo={checkIn:e=>Ue.post("/checkin",e),adminCheckIn:(e,t)=>Ue.post(`/checkin/admin/${e}/${t}`)},ic={getAdmins:e=>Ue.get(`/events/${e}/admins`),addAdmin:(e,t)=>Ue.post(`/events/${e}/admins`,{userEmail:t}),removeAdmin:(e,t)=>Ue.delete(`/events/${e}/admins/${t}`)},co={create:e=>Ue.post("/marshals",e),getByEvent:e=>Ue.get(`/events/${e}/marshals`),getById:(e,t)=>Ue.get(`/marshals/${e}/${t}`),update:(e,t,o)=>Ue.put(`/marshals/${e}/${t}`,o),delete:(e,t)=>Ue.delete(`/marshals/${e}/${t}`),getMagicLink:(e,t)=>Ue.get(`/marshals/${e}/${t}/magic-link`),sendMagicLink:(e,t)=>Ue.post(`/marshals/${e}/${t}/send-magic-link`),importCsv:(e,t)=>{const o=new FormData;return o.append("csv",t),Ue.post(`/marshals/import/${e}`,o,{headers:{"Content-Type":"multipart/form-data"}})}},ds={create:e=>Ue.post("/areas",e),getByEvent:e=>Ue.get(`/events/${e}/areas`),getById:(e,t)=>Ue.get(`/areas/${e}/${t}`),update:(e,t,o)=>Ue.put(`/areas/${e}/${t}`,o),delete:(e,t)=>Ue.delete(`/areas/${e}/${t}`),recalculate:e=>Ue.post(`/areas/recalculate/${e}`),getCheckpoints:(e,t)=>Ue.get(`/areas/${e}/${t}/locations`),getAreaLeads:(e,t)=>Ue.get(`/areas/${e}/${t}/leads`),getAreaLeadDashboard:e=>Ue.get(`/events/${e}/area-lead-dashboard`)},It={create:(e,t)=>Ue.post(`/events/${e}/checklist-items`,t),getByEvent:e=>Ue.get(`/events/${e}/checklist-items`),getById:(e,t)=>Ue.get(`/checklist-items/${e}/${t}`),update:(e,t,o)=>Ue.put(`/checklist-items/${e}/${t}`,o),delete:(e,t)=>Ue.delete(`/checklist-items/${e}/${t}`),getReport:e=>Ue.get(`/events/${e}/checklist-report`),getMarshalChecklist:(e,t)=>Ue.get(`/events/${e}/marshals/${t}/checklist`),getCheckpointChecklist:(e,t)=>Ue.get(`/events/${e}/locations/${t}/checklist`),getAreaChecklist:(e,t)=>Ue.get(`/events/${e}/areas/${t}/checklist`),complete:(e,t,o)=>Ue.post(`/checklist-items/${e}/${t}/complete`,o),uncomplete:(e,t,o)=>Ue.post(`/checklist-items/${e}/${t}/uncomplete`,o)},Eo={create:(e,t)=>Ue.post(`/events/${e}/notes`,t),getByEvent:e=>Ue.get(`/events/${e}/notes`),getById:(e,t)=>Ue.get(`/events/${e}/notes/${t}`),update:(e,t,o)=>Ue.put(`/events/${e}/notes/${t}`,o),delete:(e,t)=>Ue.delete(`/events/${e}/notes/${t}`),getMarshalNotes:(e,t)=>Ue.get(`/events/${e}/marshals/${t}/notes`),getMyNotes:e=>Ue.get(`/events/${e}/my-notes`)},gi={create:(e,t)=>Ue.post(`/events/${e}/contacts`,t),getByEvent:e=>Ue.get(`/events/${e}/contacts`),getById:(e,t)=>Ue.get(`/events/${e}/contacts/${t}`),update:(e,t,o)=>Ue.put(`/events/${e}/contacts/${t}`,o),delete:(e,t)=>Ue.delete(`/events/${e}/contacts/${t}`),getRoles:e=>Ue.get(`/events/${e}/contact-roles`),getMarshalContacts:(e,t)=>Ue.get(`/events/${e}/marshals/${t}/contacts`),getMyContacts:e=>Ue.get(`/events/${e}/my-contacts`)},yl=tu("auth",()=>{const e=O(localStorage.getItem("adminEmail")||null),t=O(!!e.value),o=O(!1);return{adminEmail:e,isAuthenticated:t,loginPending:o,requestLogin:async u=>{const h=await uo.requestLogin(u);return h.data.success&&(o.value=!0),h.data},verifyToken:async u=>{const h=await uo.verifyToken(u);return h.data.success&&(e.value=h.data.person?.email,t.value=!0,o.value=!1,localStorage.setItem("adminEmail",h.data.person?.email),localStorage.setItem("sessionToken",h.data.sessionToken)),h.data},instantLogin:async u=>{const h=await uo.instantLogin(u);return h.data.success&&(e.value=h.data.email,t.value=!0,localStorage.setItem("adminEmail",h.data.email),h.data.sessionToken&&localStorage.setItem("sessionToken",h.data.sessionToken)),h.data},logout:async()=>{try{await uo.logout()}catch{}e.value=null,t.value=!1,o.value=!1,localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken")}}}),G1={class:"admin-login"},K1={class:"login-card"},Y1={key:0,class:"email-sent"},J1={class:"form-group"},X1=["disabled"],Q1={key:0,class:"error"},ek={__name:"AdminLogin",setup(e){const t=yl(),o=O(""),i=O(!1),s=O(null),a=O(!1),l=async()=>{i.value=!0,s.value=null;try{const h=await t.requestLogin(o.value);h.success?a.value=!0:s.value=h.message||"Failed to send login link. Please try again."}catch{s.value="Failed to send login link. Please try again."}finally{i.value=!1}},u=()=>{o.value="",a.value=!1,s.value=null};return(h,f)=>{const p=al("router-link");return m(),y("div",G1,[c("div",K1,[f[7]||(f[7]=c("h2",null,"Admin login",-1)),a.value?(m(),y("div",Y1,[f[2]||(f[2]=c("div",{class:"check-icon"},"",-1)),f[3]||(f[3]=c("h3",null,"Check your email!",-1)),c("p",null,[f[1]||(f[1]=We("We've sent a login link to ",-1)),c("strong",null,w(o.value),1)]),f[4]||(f[4]=c("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),c("button",{onClick:u,class:"btn btn-secondary"}," Use a different email ")])):(m(),y(Te,{key:1},[f[5]||(f[5]=c("p",{class:"instruction"},"Enter your email to receive a login link",-1)),c("form",{onSubmit:St(l,["prevent"])},[c("div",J1,[Ze(c("input",{"onUpdate:modelValue":f[0]||(f[0]=g=>o.value=g),type:"email",placeholder:"admin@example.com",required:"",class:"form-input"},null,512),[[ut,o.value]])]),c("button",{type:"submit",class:"btn btn-primary",disabled:i.value},w(i.value?"Sending...":"Send login link"),9,X1)],32),s.value?(m(),y("div",Q1,w(s.value),1)):F("",!0)],64)),Ve(p,{to:"/",class:"back-link"},{default:tt(()=>[...f[6]||(f[6]=[We(" Back to Home",-1)])]),_:1})])])}}},tk=Xe(ek,[["__scopeId","data-v-1eafb4d9"]]),nk={class:"admin-verify"},ok={class:"verify-card"},sk={key:0,class:"status"},ik={key:1,class:"status error"},ak={key:2,class:"status success"},rk={__name:"AdminVerify",setup(e){const t=Ha(),o=su(),i=yl(),s=O(!0),a=O(null);return rn(async()=>{const l=o.query.token;if(!l){a.value="No login token provided. Please request a new login link.",s.value=!1;return}try{const u=await i.verifyToken(l);u.success?setTimeout(()=>{t.push({name:"AdminDashboard"})},1e3):a.value=u.message||"Invalid or expired login link. Please request a new one."}catch(u){console.error("Verification error:",u),a.value="Failed to verify login. Please try again."}finally{s.value=!1}}),(l,u)=>{const h=al("router-link");return m(),y("div",nk,[c("div",ok,[s.value?(m(),y("div",sk,[...u[0]||(u[0]=[c("div",{class:"spinner"},null,-1),c("h2",null,"Verifying your login...",-1),c("p",null,"Please wait while we confirm your identity.",-1)])])):a.value?(m(),y("div",ik,[u[2]||(u[2]=c("h2",null,"Login failed",-1)),c("p",null,w(a.value),1),Ve(h,{to:"/admin/login",class:"btn btn-primary"},{default:tt(()=>[...u[1]||(u[1]=[We(" Try again ",-1)])]),_:1})])):(m(),y("div",ak,[...u[3]||(u[3]=[c("h2",null,"Login successful!",-1),c("p",null,"Redirecting to dashboard...",-1)])]))])])}}},lk=Xe(rk,[["__scopeId","data-v-5012f94a"]]),Sp=tu("events",()=>{const e=O([]),t=O(null),o=O([]),i=O([]),s=O(null),a=O(!1),l=O(null),u=async()=>{a.value=!0,l.value=null;try{const $=await Rs.getAll();e.value=$.data}catch($){throw l.value=$.message,$}finally{a.value=!1}},h=async $=>{a.value=!0,l.value=null;try{const E=await Rs.getById($);t.value=E.data}catch(E){throw l.value=E.message,E}finally{a.value=!1}},f=async $=>{a.value=!0,l.value=null;try{const E=await Rs.create($);return e.value.push(E.data),E.data}catch(E){throw l.value=E.message,E}finally{a.value=!1}},p=async($,E)=>{a.value=!0,l.value=null;try{const ie=await Rs.update($,E),ce=e.value.findIndex(ge=>ge.id===$);return ce!==-1&&(e.value[ce]=ie.data),t.value?.id===$&&(t.value=ie.data),ie.data}catch(ie){throw l.value=ie.message,ie}finally{a.value=!1}},g=async $=>{a.value=!0,l.value=null;try{await Rs.delete($),e.value=e.value.filter(E=>E.id!==$)}catch(E){throw l.value=E.message,E}finally{a.value=!1}},b=async $=>{a.value=!0,l.value=null;try{const E=await yn.getByEvent($);o.value=E.data}catch(E){throw l.value=E.message,E}finally{a.value=!1}};return{events:e,currentEvent:t,locations:o,assignments:i,eventStatus:s,loading:a,error:l,fetchEvents:u,fetchEvent:h,createEvent:f,updateEvent:p,deleteEvent:g,fetchLocations:b,createLocation:async $=>{a.value=!0,l.value=null;try{const E=await yn.create($);return o.value.push(E.data),E.data}catch(E){throw l.value=E.message,E}finally{a.value=!1}},updateLocation:async($,E,ie)=>{a.value=!0,l.value=null;try{const ce=await yn.update($,E,ie),ge=o.value.findIndex(re=>re.id===E);return ge!==-1&&(o.value[ge]=ce.data),ce.data}catch(ce){throw l.value=ce.message,ce}finally{a.value=!1}},deleteLocation:async($,E)=>{a.value=!0,l.value=null;try{await yn.delete($,E),o.value=o.value.filter(ie=>ie.id!==E)}catch(ie){throw l.value=ie.message,ie}finally{a.value=!1}},bulkUpdateLocationTimes:async($,E)=>{a.value=!0,l.value=null;try{const ie=await yn.bulkUpdateTimes($,E);return await b($),ie.data}catch(ie){throw l.value=ie.message,ie}finally{a.value=!1}},fetchAssignments:async $=>{a.value=!0,l.value=null;try{const E=await pa.getByEvent($);i.value=E.data}catch(E){throw l.value=E.message,E}finally{a.value=!1}},createAssignment:async $=>{a.value=!0,l.value=null;try{const E=await pa.create($);return i.value.push(E.data),E.data}catch(E){throw l.value=E.message,E}finally{a.value=!1}},deleteAssignment:async($,E)=>{a.value=!0,l.value=null;try{await pa.delete($,E),i.value=i.value.filter(ie=>ie.id!==E)}catch(ie){throw l.value=ie.message,ie}finally{a.value=!1}},fetchEventStatus:async $=>{a.value=!0,l.value=null;try{const E=await pa.getEventStatus($);return s.value=E.data,E.data}catch(E){throw l.value=E.message,E}finally{a.value=!1}},updateAssignmentCheckIn:$=>{const E=i.value.findIndex(ie=>ie.id===$.id);E!==-1&&(i.value[E]=$),s.value&&s.value.locations.forEach(ie=>{const ce=ie.assignments.findIndex(ge=>ge.id===$.id);ce!==-1&&(ie.assignments[ce]=$,ie.checkedInCount=ie.assignments.filter(ge=>ge.isCheckedIn).length)})}}}),ck={class:"confirm-modal"},uk={class:"confirm-actions"},dk={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"}},emits:["confirm","cancel"],setup(e,{emit:t}){const o=t,i=()=>{o("confirm")},s=()=>{o("cancel")};return(a,l)=>e.show?(m(),y("div",{key:0,class:"modal-overlay",onClick:St(s,["self"])},[c("div",ck,[c("h3",null,w(e.title),1),c("p",null,w(e.message),1),c("div",uk,[c("button",{onClick:s,class:"btn btn-secondary"},w(e.cancelText),1),c("button",{onClick:i,class:"btn btn-primary"},w(e.confirmText),1)])])])):F("",!0)}},_l=Xe(dk,[["__scopeId","data-v-8fc7605e"]]),hk={class:"base-modal-header"},fk={key:0,class:"base-modal-title"},pk={key:0,class:"base-modal-tab-header"},vk={class:"base-modal-body"},mk={key:1,class:"base-modal-footer"},gk={key:0,class:"base-modal-actions"},yk={__name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},variant:{type:String,default:"center",validator:e=>["center","sidebar"].includes(e)},zIndex:{type:Number,default:1e3},closeOnOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},confirmOnClose:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=e,i=t,s=O(!1),a=O(!1),l=()=>{o.closeOnOverlay&&u()},u=()=>{o.confirmOnClose&&o.isDirty?s.value=!0:i("close")},h=()=>{s.value=!1,i("close")},f=()=>{s.value=!1};return(p,g)=>e.show?(m(),y("div",{key:0,class:"base-modal-overlay",style:Dt({zIndex:e.zIndex}),onClick:St(l,["self"])},[c("div",{class:Ae(["base-modal",[`base-modal--${e.size}`,`base-modal--${e.variant}`]])},[c("div",hk,[ra(p.$slots,"header",{},()=>[e.title?(m(),y("h2",fk,w(e.title),1)):F("",!0)]),e.showCloseButton?(m(),y("button",{key:0,onClick:u,class:"base-modal-close",type:"button","aria-label":"Close"},"  ")):F("",!0)]),p.$slots["tab-header"]?(m(),y("div",pk,[ra(p.$slots,"tab-header",{},void 0)])):F("",!0),c("div",vk,[ra(p.$slots,"default",{},void 0)]),p.$slots.footer||p.$slots.actions?(m(),y("div",mk,[ra(p.$slots,"footer",{},()=>[p.$slots.actions?(m(),y("div",gk,[ra(p.$slots,"actions",{},void 0,!0)])):F("",!0)])])):F("",!0)],2),e.confirmOnClose&&!a.value?(m(),at(_l,{key:0,show:s.value,title:"Unsaved changes",message:"You have unsaved changes. Are you sure you want to close?",onConfirm:h,onCancel:f},null,8,["show"])):F("",!0)],4)):F("",!0)}},zt=Xe(yk,[["__scopeId","data-v-3c947aaa"]]);function xp(e="details",t=[]){const o=O(e),i=g=>{o.value=g},s=()=>{o.value=e},a=g=>o.value===g,l=ae(()=>t.length===0?-1:t.indexOf(o.value)),u=(g=!1)=>{if(t.length===0)return;const b=l.value;if(b===-1)return;const S=b+1;S<t.length?o.value=t[S]:g&&(o.value=t[0])},h=(g=!1)=>{if(t.length===0)return;const b=l.value;if(b===-1)return;const S=b-1;S>=0?o.value=t[S]:g&&(o.value=t[t.length-1])},f=ae(()=>{if(t.length===0)return!1;const g=l.value;return g!==-1&&g<t.length-1}),p=ae(()=>t.length===0?!1:l.value>0);return{activeTab:o,activeTabIndex:l,hasNextTab:f,hasPreviousTab:p,switchTab:i,resetTab:s,isActiveTab:a,nextTab:u,previousTab:h}}const Tp=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET/CEST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Australia/Sydney",label:"Sydney (AEDT/AEST)"}],_k={class:"tabs"},kk={class:"tab-content"},bk={class:"form-group"},wk={class:"form-group"},Ck={class:"form-group"},Lk={class:"form-group"},Sk=["value"],xk={class:"tab-content"},Tk={class:"emergency-contacts-section"},Ik={key:0,class:"empty-state"},$k={class:"card-header"},Mk=["onClick"],Ak={class:"form-group"},Ek=["onUpdate:modelValue"],Pk={class:"form-group"},Dk=["onUpdate:modelValue"],Ok={class:"form-group"},Rk=["onUpdate:modelValue"],Bk={__name:"EventFormModal",props:{show:{type:Boolean,default:!1},eventData:{type:Object,default:()=>({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]})},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const o=e,i=t,{activeTab:s,switchTab:a,resetTab:l}=xp("basic",["basic","emergency"]),u=O({...o.eventData});Ke(()=>o.eventData,b=>{u.value={...b},u.value.emergencyContacts||(u.value.emergencyContacts=[])},{deep:!0}),Ke(()=>o.show,b=>{b&&l()});const h=()=>{u.value.emergencyContacts.push({name:"",phone:"",details:""})},f=b=>{u.value.emergencyContacts.splice(b,1)},p=()=>{i("submit",{...u.value})},g=()=>{i("close")};return(b,S)=>(m(),at(zt,{show:e.show,title:e.isEditing?"Edit event":"Create new event",size:"large",onClose:g},{"tab-header":tt(()=>[c("div",_k,[c("button",{type:"button",onClick:S[0]||(S[0]=T=>V(a)("basic")),class:Ae(["tab-button",{active:V(s)==="basic"}])}," Basic details ",2),c("button",{type:"button",onClick:S[1]||(S[1]=T=>V(a)("emergency")),class:Ae(["tab-button",{active:V(s)==="emergency"}])}," Emergency contacts ",2)])]),actions:tt(()=>[c("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:p,class:"btn btn-primary"},w(e.isEditing?"Update":"Create"),1)]),default:tt(()=>[c("form",{onSubmit:St(p,["prevent"])},[Ze(c("div",kk,[c("div",bk,[S[6]||(S[6]=c("label",null,"Event name *",-1)),Ze(c("input",{"onUpdate:modelValue":S[2]||(S[2]=T=>u.value.name=T),type:"text",required:"",class:"form-input"},null,512),[[ut,u.value.name]])]),c("div",wk,[S[7]||(S[7]=c("label",null,"Description",-1)),Ze(c("textarea",{"onUpdate:modelValue":S[3]||(S[3]=T=>u.value.description=T),rows:"3",class:"form-input"},null,512),[[ut,u.value.description]])]),c("div",Ck,[S[8]||(S[8]=c("label",null,"Event date *",-1)),Ze(c("input",{"onUpdate:modelValue":S[4]||(S[4]=T=>u.value.eventDate=T),type:"datetime-local",required:"",class:"form-input"},null,512),[[ut,u.value.eventDate]])]),c("div",Lk,[S[9]||(S[9]=c("label",null,"Time zone *",-1)),Ze(c("select",{"onUpdate:modelValue":S[5]||(S[5]=T=>u.value.timeZoneId=T),required:"",class:"form-input"},[(m(!0),y(Te,null,Ne(V(Tp),T=>(m(),y("option",{key:T.value,value:T.value},w(T.label),9,Sk))),128))],512),[[gn,u.value.timeZoneId]])])],512),[[ms,V(s)==="basic"]]),Ze(c("div",xk,[c("div",Tk,[c("div",{class:"section-header-small"},[S[10]||(S[10]=c("h3",null,"Emergency contacts",-1)),c("button",{type:"button",onClick:h,class:"btn btn-small btn-primary"}," + Add contact ")]),u.value.emergencyContacts.length===0?(m(),y("div",Ik,[...S[11]||(S[11]=[c("p",null,'No emergency contacts added yet. Click "Add contact" to add one.',-1)])])):F("",!0),(m(!0),y(Te,null,Ne(u.value.emergencyContacts,(T,_)=>(m(),y("div",{key:_,class:"emergency-contact-card"},[c("div",$k,[c("h4",null,"Contact "+w(_+1),1),c("button",{type:"button",onClick:D=>f(_),class:"btn-remove"},"  ",8,Mk)]),c("div",Ak,[S[12]||(S[12]=c("label",null,"Name *",-1)),Ze(c("input",{"onUpdate:modelValue":D=>T.name=D,type:"text",required:"",class:"form-input",placeholder:"Contact person name"},null,8,Ek),[[ut,T.name]])]),c("div",Pk,[S[13]||(S[13]=c("label",null,"Phone *",-1)),Ze(c("input",{"onUpdate:modelValue":D=>T.phone=D,type:"tel",required:"",class:"form-input",placeholder:"+1 (555) 123-4567"},null,8,Dk),[[ut,T.phone]])]),c("div",Ok,[S[14]||(S[14]=c("label",null,"Additional details",-1)),Ze(c("textarea",{"onUpdate:modelValue":D=>T.details=D,rows:"2",class:"form-input",placeholder:"Role, availability, or other important information..."},null,8,Rk),[[ut,T.details]])])]))),128))])],512),[[ms,V(s)==="emergency"]])],32)]),_:1},8,["show","title"]))}},Nk=Xe(Bk,[["__scopeId","data-v-9d79dd39"]]),Fk={class:"admin-dashboard"},zk={class:"header"},Uk={class:"header-actions"},Hk={class:"user-email"},Vk={class:"container"},Zk={class:"section"},jk={class:"section-header"},Wk={key:0,class:"loading"},qk={key:1,class:"empty"},Gk={key:2,class:"events-grid"},Kk=["onClick"],Yk={class:"event-date"},Jk={class:"event-desc"},Xk={class:"event-actions"},Qk=["onClick"],eb=["onClick"],tb={__name:"AdminDashboard",setup(e){const t=Ha(),o=yl(),i=Sp(),s=O(!0),a=O(!1),l=O(null),u=O({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}),h=O([]),f=O(!1),p=O(""),g=O(""),b=O(null),S=async()=>{s.value=!0;try{await i.fetchEvents(),h.value=i.events}catch(ce){console.error("Failed to load events:",ce)}finally{s.value=!1}},T=async ce=>{try{const ge={...ce,adminEmail:o.adminEmail};l.value?await i.updateEvent(l.value.id,ge):await i.createEvent(ge),h.value=i.events,C()}catch(ge){console.error("Failed to save event:",ge),alert("Failed to save event. Please try again.")}},_=ce=>{l.value=ce,u.value={name:ce.name,description:ce.description,eventDate:ie(ce.eventDate),timeZoneId:ce.timeZoneId||"UTC",emergencyContacts:ce.emergencyContacts?JSON.parse(JSON.stringify(ce.emergencyContacts)):[]}},D=async ce=>{p.value="Delete event",g.value=`Are you sure you want to delete "${ce.name}"?`,b.value=async()=>{try{await i.deleteEvent(ce.id),h.value=i.events}catch(ge){console.error("Failed to delete event:",ge),alert("Failed to delete event. Please try again.")}},f.value=!0},M=()=>{f.value=!1,b.value&&(b.value(),b.value=null)},x=()=>{f.value=!1,b.value=null},C=()=>{a.value=!1,l.value=null,u.value={name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}},A=ce=>{if(!ce){console.error("Cannot navigate to event: eventId is undefined");return}t.push({name:"AdminEventManage",params:{eventId:ce}})},I=()=>{t.push({name:"AdminProfile"})},$=()=>{o.logout(),t.push({name:"Home"})},E=ce=>new Date(ce).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),ie=ce=>{const ge=new Date(ce),re=ge.getFullYear(),ve=String(ge.getMonth()+1).padStart(2,"0"),Be=String(ge.getDate()).padStart(2,"0"),He=String(ge.getHours()).padStart(2,"0"),Oe=String(ge.getMinutes()).padStart(2,"0");return`${re}-${ve}-${Be}T${He}:${Oe}`};return rn(()=>{S()}),(ce,ge)=>(m(),y("div",Fk,[c("header",zk,[ge[1]||(ge[1]=c("h1",null,"Admin dashboard",-1)),c("div",Uk,[c("span",Hk,w(V(o).adminEmail),1),c("button",{onClick:I,class:"btn btn-secondary"},"Profile"),c("button",{onClick:$,class:"btn btn-secondary"},"Logout")])]),c("div",Vk,[c("div",Zk,[c("div",jk,[ge[2]||(ge[2]=c("h2",null,"Your events",-1)),c("button",{onClick:ge[0]||(ge[0]=re=>a.value=!0),class:"btn btn-primary"}," Create new event ")]),s.value?(m(),y("div",Wk,"Loading events...")):h.value.length===0?(m(),y("div",qk,[...ge[3]||(ge[3]=[c("p",null,"No events yet. Create your first event to get started!",-1)])])):(m(),y("div",Gk,[(m(!0),y(Te,null,Ne(h.value,re=>(m(),y("div",{key:re.id,class:"event-card",onClick:ve=>A(re.id)},[c("h3",null,w(re.name),1),c("p",Yk,w(E(re.eventDate)),1),c("p",Jk,w(re.description),1),c("div",Xk,[c("button",{onClick:St(ve=>_(re),["stop"]),class:"btn btn-small btn-secondary"}," Edit ",8,Qk),c("button",{onClick:St(ve=>D(re),["stop"]),class:"btn btn-small btn-danger"}," Delete ",8,eb)])],8,Kk))),128))]))])]),Ve(Nk,{show:a.value||!!l.value,"event-data":u.value,"is-editing":!!l.value,onClose:C,onSubmit:T},null,8,["show","event-data","is-editing"]),Ve(_l,{show:f.value,title:p.value,message:g.value,onConfirm:M,onCancel:x},null,8,["show","title","message"])]))}},nb=Xe(tb,[["__scopeId","data-v-ec6b84bf"]]),ob=tu("profile",()=>{const e=O(null),t=O(!1),o=O(null);return{profile:e,loading:t,error:o,fetchProfile:async()=>{t.value=!0,o.value=null;try{const h=await br.getProfile();return e.value=h.data,h.data}catch(h){throw o.value=h.response?.data?.message||"Failed to load profile",h}finally{t.value=!1}},updateProfile:async h=>{t.value=!0,o.value=null;try{const f=await br.updateProfile(h);return e.value=f.data,f.data}catch(f){throw o.value=f.response?.data?.message||"Failed to update profile",f}finally{t.value=!1}},fetchPerson:async(h,f)=>{t.value=!0,o.value=null;try{return(await br.getPerson(h,f)).data}catch(p){throw o.value=p.response?.data?.message||"Failed to load person",p}finally{t.value=!1}},updatePerson:async(h,f,p)=>{t.value=!0,o.value=null;try{return(await br.updatePerson(h,f,p)).data}catch(g){throw o.value=g.response?.data?.message||"Failed to update person",g}finally{t.value=!1}},clearProfile:()=>{e.value=null,o.value=null}}}),sb={class:"form-group"},ib={class:"form-group"},ab={class:"form-group"},rb={__name:"EditProfileModal",props:{show:{type:Boolean,default:!1},profile:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=O({name:"",email:"",phone:""});Ke(()=>o.profile,h=>{h&&(s.value={name:h.name||"",email:h.email||"",phone:h.phone||""})},{immediate:!0,deep:!0}),Ke(()=>o.show,h=>{h&&o.profile&&(s.value={name:o.profile.name||"",email:o.profile.email||"",phone:o.profile.phone||""})});const a=()=>{i("update:isDirty",!0)},l=()=>{if(!s.value.name.trim()){alert("Name is required");return}if(!s.value.email.trim()){alert("Email is required");return}i("submit",{name:s.value.name.trim(),email:s.value.email.trim(),phone:s.value.phone?.trim()||""})},u=()=>{i("close")};return(h,f)=>(m(),at(zt,{show:e.show,title:"Edit profile",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:tt(()=>[c("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:l,class:"btn btn-primary"}," Save changes ")]),default:tt(()=>[c("form",{onSubmit:St(l,["prevent"])},[c("div",sb,[f[3]||(f[3]=c("label",null,"Name *",-1)),Ze(c("input",{"onUpdate:modelValue":f[0]||(f[0]=p=>s.value.name=p),type:"text",required:"",class:"form-input",placeholder:"Your name",onInput:a},null,544),[[ut,s.value.name]])]),c("div",ib,[f[4]||(f[4]=c("label",null,"Email *",-1)),Ze(c("input",{"onUpdate:modelValue":f[1]||(f[1]=p=>s.value.email=p),type:"email",required:"",class:"form-input",placeholder:"Your email address",onInput:a},null,544),[[ut,s.value.email]])]),c("div",ab,[f[5]||(f[5]=c("label",null,"Phone",-1)),Ze(c("input",{"onUpdate:modelValue":f[2]||(f[2]=p=>s.value.phone=p),type:"tel",class:"form-input",placeholder:"Your phone number",onInput:a},null,544),[[ut,s.value.phone]])])],32)]),_:1},8,["show","is-dirty"]))}},lb=Xe(rb,[["__scopeId","data-v-9a8cb8be"]]),cb={class:"admin-profile"},ub={class:"header"},db={class:"header-actions"},hb={class:"user-email"},fb={class:"container"},pb={class:"section"},vb={class:"section-header"},mb={key:0,class:"loading"},gb={key:1,class:"error"},yb={key:2,class:"profile-details"},_b={class:"profile-field"},kb={class:"field-value"},bb={class:"profile-field"},wb={class:"field-value"},Cb={class:"profile-field"},Lb={class:"field-value"},Sb={class:"profile-field"},xb={class:"field-value"},Tb={__name:"AdminProfile",setup(e){const t=Ha(),o=yl(),i=ob(),s=O(!1),a=async()=>{try{await i.fetchProfile()}catch(f){console.error("Failed to load profile:",f)}},l=async f=>{try{await i.updateProfile(f),s.value=!1}catch(p){console.error("Failed to save profile:",p),alert("Failed to save profile. Please try again.")}},u=()=>{o.logout(),t.push({name:"Home"})},h=()=>{t.push({name:"AdminDashboard"})};return rn(()=>{a()}),(f,p)=>(m(),y("div",cb,[c("header",ub,[p[2]||(p[2]=c("h1",null,"My profile",-1)),c("div",db,[c("span",hb,w(V(o).adminEmail),1),c("button",{onClick:u,class:"btn btn-secondary"},"Logout")])]),c("div",fb,[c("div",pb,[c("div",vb,[p[3]||(p[3]=c("h2",null,"Profile information",-1)),c("button",{onClick:p[0]||(p[0]=g=>s.value=!0),class:"btn btn-primary"}," Edit profile ")]),V(i).loading?(m(),y("div",mb,"Loading profile...")):V(i).error?(m(),y("div",gb,[c("p",null,w(V(i).error),1),c("button",{onClick:a,class:"btn btn-secondary"},"Retry")])):V(i).profile?(m(),y("div",yb,[c("div",_b,[p[4]||(p[4]=c("label",null,"Name",-1)),c("div",kb,w(V(i).profile.name||""),1)]),c("div",bb,[p[5]||(p[5]=c("label",null,"Email",-1)),c("div",wb,w(V(i).profile.email||""),1)]),c("div",Cb,[p[6]||(p[6]=c("label",null,"Phone",-1)),c("div",Lb,w(V(i).profile.phone||""),1)]),c("div",Sb,[p[7]||(p[7]=c("label",null,"System admin",-1)),c("div",xb,[c("span",{class:Ae(["badge",V(i).profile.isSystemAdmin?"badge-success":"badge-secondary"])},w(V(i).profile.isSystemAdmin?"Yes":"No"),3)])])])):F("",!0)]),c("div",{class:"section"},[c("button",{onClick:h,class:"btn btn-secondary"}," Back to Dashboard ")])]),Ve(lb,{show:s.value,profile:V(i).profile,onClose:p[1]||(p[1]=g=>s.value=!1),onSubmit:l},null,8,["show","profile"])]))}},Ib=Xe(Tb,[["__scopeId","data-v-4d07684c"]]);function $b(){const e=O(!1),t=O(""),o=O(""),i=O(null);return{showConfirmModal:e,confirmModalTitle:t,confirmModalMessage:o,showConfirm:(h,f,p)=>{t.value=h,o.value=f,i.value=p,e.value=!0},handleConfirmModalConfirm:()=>{e.value=!1,i.value&&(i.value(),i.value=null)},handleConfirmModalCancel:()=>{e.value=!1,i.value=null},closeConfirmModal:()=>{e.value=!1,i.value=null}}}const yi=O({people:"Marshals",checkpoint:"Checkpoints",area:"Areas",checklist:"Checklists",course:"Course"}),No={people:{People:{singular:"Person",plural:"People"},Marshals:{singular:"Marshal",plural:"Marshals"},Volunteers:{singular:"Volunteer",plural:"Volunteers"},Helpers:{singular:"Helper",plural:"Helpers"},Staff:{singular:"Staff member",plural:"Staff"},Stewards:{singular:"Steward",plural:"Stewards"},"Team members":{singular:"Team member",plural:"Team members"},Drivers:{singular:"Driver",plural:"Drivers"},Pilots:{singular:"Pilot",plural:"Pilots"}},checkpoint:{Checkpoints:{singular:"Checkpoint",plural:"Checkpoints"},Stations:{singular:"Station",plural:"Stations"},Locations:{singular:"Location",plural:"Locations"},"Feed stations":{singular:"Feed station",plural:"Feed stations"},"Aid stations":{singular:"Aid station",plural:"Aid stations"},"Water stations":{singular:"Water station",plural:"Water stations"},"Person points":{singular:null,plural:null,dynamic:!0}},area:{Areas:{singular:"Area",plural:"Areas"},Regions:{singular:"Region",plural:"Regions"},Zones:{singular:"Zone",plural:"Zones"}},checklist:{Checklists:{singular:"Checklist",plural:"Checklists"},Tasks:{singular:"Task",plural:"Tasks"},Jobs:{singular:"Job",plural:"Jobs"}},course:{Course:{singular:"Course",plural:"Courses"},Route:{singular:"Route",plural:"Routes"},Track:{singular:"Track",plural:"Tracks"},Trail:{singular:"Trail",plural:"Trails"},Path:{singular:"Path",plural:"Paths"}}},Ro={people:["Drivers","Helpers","Marshals","People","Pilots","Staff","Stewards","Team members","Volunteers"],checkpoint:["Aid stations","Checkpoints","Feed stations","Locations","Person points","Stations","Water stations"],area:["Areas","Regions","Zones"],checklist:["Checklists","Jobs","Tasks"],course:["Course","Path","Route","Track","Trail"]};function Bs(e,t,o="Marshals"){if(!t)return"";const i=No[e]?.[t];return e==="checkpoint"&&t==="Person points"?`${No.people[o]?.singular||"Person"} point`:i?.singular?i.singular:t.endsWith("s")&&!t.endsWith("ss")?t.slice(0,-1):t}function Ip(e,t,o="Marshals"){if(!t)return"";const i=No[e]?.[t];return t==="Person points"?`${No.people[o]?.singular||"Person"} points`:i?.plural?i.plural:t}function Ec(e,t){return e==="Person points"?`${No.people[t]?.singular||"Person"} points`:e}function Pc(e){e&&(yi.value={people:e.peopleTerm||"Marshals",checkpoint:e.checkpointTerm||"Checkpoints",area:e.areaTerm||"Areas",checklist:e.checklistTerm||"Checklists",course:e.courseTerm||"Course"})}const Zn=e=>e.toLowerCase(),jn=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();function yt(){const e=p=>{const g=yi.value[p],b=No[p]?.[g];if(p==="checkpoint"&&g==="Person points"){const S=yi.value.people;return`${No.people[S]?.singular||"Person"} point`}return b?.singular||g},t=p=>{const g=yi.value[p],b=No[p]?.[g];if(p==="checkpoint"&&g==="Person points"){const S=yi.value.people;return`${No.people[S]?.singular||"Person"} points`}return b?.plural||g},o=ae(()=>({person:e("people"),checkpoint:e("checkpoint"),area:e("area"),checklist:e("checklist"),course:e("course"),people:t("people"),checkpoints:t("checkpoint"),areas:t("area"),checklists:t("checklist"),courses:t("course")})),i=ae(()=>({person:Zn(e("people")),checkpoint:Zn(e("checkpoint")),area:Zn(e("area")),checklist:Zn(e("checklist")),course:Zn(e("course")),people:Zn(t("people")),checkpoints:Zn(t("checkpoint")),areas:Zn(t("area")),checklists:Zn(t("checklist")),courses:Zn(t("course"))})),s=ae(()=>({person:jn(e("people")),checkpoint:jn(e("checkpoint")),area:jn(e("area")),checklist:jn(e("checklist")),course:jn(e("course")),people:jn(t("people")),checkpoints:jn(t("checkpoint")),areas:jn(t("area")),checklists:jn(t("checklist")),courses:jn(t("course"))})),a=ae(()=>({course:o.value.course,checkpoints:o.value.checkpoints,areas:o.value.areas,marshals:o.value.people,checklists:o.value.checklists,notes:"Notes",details:"Event details"}));return{terms:o,termsLower:i,termsSentence:s,tabLabels:a,singular:e,plural:t,formatCount:(p,g)=>g===1?`1 ${e(p)}`:`${g} ${t(p)}`,lower:(p,g=!0)=>Zn(g?t(p):e(p)),title:(p,g=!0)=>g?t(p):e(p),sentence:(p,g=!0)=>jn(g?t(p):e(p)),terminology:yi}}const Mb=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",Ra=e=>{if(!e)return"";const t=new Date(e),o=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0");return`${o}-${i}-${s}T${a}:${l}`},Wr=e=>{if(!e||e.trim()==="")return!0;if(!/^[a-z]{1,20}[./][a-z]{1,20}[./][a-z]{1,20}$/.test(e))return!1;const o=e.includes("."),i=e.includes("/");return o!==i};function Ab(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var va={exports:{}};var Eb=va.exports,rh;function Pb(){return rh||(rh=1,(function(e,t){(function(o,i){i(t)})(Eb,(function(o){var i="1.9.4";function s(n){var r,d,v,k;for(d=1,v=arguments.length;d<v;d++){k=arguments[d];for(r in k)n[r]=k[r]}return n}var a=Object.create||(function(){function n(){}return function(r){return n.prototype=r,new n}})();function l(n,r){var d=Array.prototype.slice;if(n.bind)return n.bind.apply(n,d.call(arguments,1));var v=d.call(arguments,2);return function(){return n.apply(r,v.length?v.concat(d.call(arguments)):arguments)}}var u=0;function h(n){return"_leaflet_id"in n||(n._leaflet_id=++u),n._leaflet_id}function f(n,r,d){var v,k,P,W;return W=function(){v=!1,k&&(P.apply(d,k),k=!1)},P=function(){v?k=arguments:(n.apply(d,arguments),setTimeout(W,r),v=!0)},P}function p(n,r,d){var v=r[1],k=r[0],P=v-k;return n===v&&d?n:((n-k)%P+P)%P+k}function g(){return!1}function b(n,r){if(r===!1)return n;var d=Math.pow(10,r===void 0?6:r);return Math.round(n*d)/d}function S(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function T(n){return S(n).split(/\s+/)}function _(n,r){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?a(n.options):{});for(var d in r)n.options[d]=r[d];return n.options}function D(n,r,d){var v=[];for(var k in n)v.push(encodeURIComponent(d?k.toUpperCase():k)+"="+encodeURIComponent(n[k]));return(!r||r.indexOf("?")===-1?"?":"&")+v.join("&")}var M=/\{ *([\w_ -]+) *\}/g;function x(n,r){return n.replace(M,function(d,v){var k=r[v];if(k===void 0)throw new Error("No value provided for variable "+d);return typeof k=="function"&&(k=k(r)),k})}var C=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function A(n,r){for(var d=0;d<n.length;d++)if(n[d]===r)return d;return-1}var I="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function $(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var E=0;function ie(n){var r=+new Date,d=Math.max(0,16-(r-E));return E=r+d,window.setTimeout(n,d)}var ce=window.requestAnimationFrame||$("RequestAnimationFrame")||ie,ge=window.cancelAnimationFrame||$("CancelAnimationFrame")||$("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function re(n,r,d){if(d&&ce===ie)n.call(r);else return ce.call(window,l(n,r))}function ve(n){n&&ge.call(window,n)}var Be={__proto__:null,extend:s,create:a,bind:l,get lastId(){return u},stamp:h,throttle:f,wrapNum:p,falseFn:g,formatNum:b,trim:S,splitWords:T,setOptions:_,getParamString:D,template:x,isArray:C,indexOf:A,emptyImageUrl:I,requestFn:ce,cancelFn:ge,requestAnimFrame:re,cancelAnimFrame:ve};function He(){}He.extend=function(n){var r=function(){_(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},d=r.__super__=this.prototype,v=a(d);v.constructor=r,r.prototype=v;for(var k in this)Object.prototype.hasOwnProperty.call(this,k)&&k!=="prototype"&&k!=="__super__"&&(r[k]=this[k]);return n.statics&&s(r,n.statics),n.includes&&(Oe(n.includes),s.apply(null,[v].concat(n.includes))),s(v,n),delete v.statics,delete v.includes,v.options&&(v.options=d.options?a(d.options):{},s(v.options,n.options)),v._initHooks=[],v.callInitHooks=function(){if(!this._initHooksCalled){d.callInitHooks&&d.callInitHooks.call(this),this._initHooksCalled=!0;for(var P=0,W=v._initHooks.length;P<W;P++)v._initHooks[P].call(this)}},r},He.include=function(n){var r=this.prototype.options;return s(this.prototype,n),n.options&&(this.prototype.options=r,this.mergeOptions(n.options)),this},He.mergeOptions=function(n){return s(this.prototype.options,n),this},He.addInitHook=function(n){var r=Array.prototype.slice.call(arguments,1),d=typeof n=="function"?n:function(){this[n].apply(this,r)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(d),this};function Oe(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=C(n)?n:[n];for(var r=0;r<n.length;r++)n[r]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var fe={on:function(n,r,d){if(typeof n=="object")for(var v in n)this._on(v,n[v],r);else{n=T(n);for(var k=0,P=n.length;k<P;k++)this._on(n[k],r,d)}return this},off:function(n,r,d){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var v in n)this._off(v,n[v],r);else{n=T(n);for(var k=arguments.length===1,P=0,W=n.length;P<W;P++)k?this._off(n[P]):this._off(n[P],r,d)}return this},_on:function(n,r,d,v){if(typeof r!="function"){console.warn("wrong listener type: "+typeof r);return}if(this._listens(n,r,d)===!1){d===this&&(d=void 0);var k={fn:r,ctx:d};v&&(k.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(k)}},_off:function(n,r,d){var v,k,P;if(this._events&&(v=this._events[n],!!v)){if(arguments.length===1){if(this._firingCount)for(k=0,P=v.length;k<P;k++)v[k].fn=g;delete this._events[n];return}if(typeof r!="function"){console.warn("wrong listener type: "+typeof r);return}var W=this._listens(n,r,d);if(W!==!1){var he=v[W];this._firingCount&&(he.fn=g,this._events[n]=v=v.slice()),v.splice(W,1)}}},fire:function(n,r,d){if(!this.listens(n,d))return this;var v=s({},r,{type:n,target:this,sourceTarget:r&&r.sourceTarget||this});if(this._events){var k=this._events[n];if(k){this._firingCount=this._firingCount+1||1;for(var P=0,W=k.length;P<W;P++){var he=k[P],ye=he.fn;he.once&&this.off(n,ye,he.ctx),ye.call(he.ctx||this,v)}this._firingCount--}}return d&&this._propagateEvent(v),this},listens:function(n,r,d,v){typeof n!="string"&&console.warn('"string" type argument expected');var k=r;typeof r!="function"&&(v=!!r,k=void 0,d=void 0);var P=this._events&&this._events[n];if(P&&P.length&&this._listens(n,k,d)!==!1)return!0;if(v){for(var W in this._eventParents)if(this._eventParents[W].listens(n,r,d,v))return!0}return!1},_listens:function(n,r,d){if(!this._events)return!1;var v=this._events[n]||[];if(!r)return!!v.length;d===this&&(d=void 0);for(var k=0,P=v.length;k<P;k++)if(v[k].fn===r&&v[k].ctx===d)return k;return!1},once:function(n,r,d){if(typeof n=="object")for(var v in n)this._on(v,n[v],r,!0);else{n=T(n);for(var k=0,P=n.length;k<P;k++)this._on(n[k],r,d,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[h(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[h(n)],this},_propagateEvent:function(n){for(var r in this._eventParents)this._eventParents[r].fire(n.type,s({layer:n.target,propagatedFrom:n.target},n),!0)}};fe.addEventListener=fe.on,fe.removeEventListener=fe.clearAllEventListeners=fe.off,fe.addOneTimeEventListener=fe.once,fe.fireEvent=fe.fire,fe.hasEventListeners=fe.listens;var q=He.extend(fe);function j(n,r,d){this.x=d?Math.round(n):n,this.y=d?Math.round(r):r}var ue=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};j.prototype={clone:function(){return new j(this.x,this.y)},add:function(n){return this.clone()._add(K(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(K(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new j(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new j(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ue(this.x),this.y=ue(this.y),this},distanceTo:function(n){n=K(n);var r=n.x-this.x,d=n.y-this.y;return Math.sqrt(r*r+d*d)},equals:function(n){return n=K(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=K(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+b(this.x)+", "+b(this.y)+")"}};function K(n,r,d){return n instanceof j?n:C(n)?new j(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new j(n.x,n.y):new j(n,r,d)}function pe(n,r){if(n)for(var d=r?[n,r]:n,v=0,k=d.length;v<k;v++)this.extend(d[v])}pe.prototype={extend:function(n){var r,d;if(!n)return this;if(n instanceof j||typeof n[0]=="number"||"x"in n)r=d=K(n);else if(n=X(n),r=n.min,d=n.max,!r||!d)return this;return!this.min&&!this.max?(this.min=r.clone(),this.max=d.clone()):(this.min.x=Math.min(r.x,this.min.x),this.max.x=Math.max(d.x,this.max.x),this.min.y=Math.min(r.y,this.min.y),this.max.y=Math.max(d.y,this.max.y)),this},getCenter:function(n){return K((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return K(this.min.x,this.max.y)},getTopRight:function(){return K(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var r,d;return typeof n[0]=="number"||n instanceof j?n=K(n):n=X(n),n instanceof pe?(r=n.min,d=n.max):r=d=n,r.x>=this.min.x&&d.x<=this.max.x&&r.y>=this.min.y&&d.y<=this.max.y},intersects:function(n){n=X(n);var r=this.min,d=this.max,v=n.min,k=n.max,P=k.x>=r.x&&v.x<=d.x,W=k.y>=r.y&&v.y<=d.y;return P&&W},overlaps:function(n){n=X(n);var r=this.min,d=this.max,v=n.min,k=n.max,P=k.x>r.x&&v.x<d.x,W=k.y>r.y&&v.y<d.y;return P&&W},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var r=this.min,d=this.max,v=Math.abs(r.x-d.x)*n,k=Math.abs(r.y-d.y)*n;return X(K(r.x-v,r.y-k),K(d.x+v,d.y+k))},equals:function(n){return n?(n=X(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function X(n,r){return!n||n instanceof pe?n:new pe(n,r)}function we(n,r){if(n)for(var d=r?[n,r]:n,v=0,k=d.length;v<k;v++)this.extend(d[v])}we.prototype={extend:function(n){var r=this._southWest,d=this._northEast,v,k;if(n instanceof Se)v=n,k=n;else if(n instanceof we){if(v=n._southWest,k=n._northEast,!v||!k)return this}else return n?this.extend(Ee(n)||De(n)):this;return!r&&!d?(this._southWest=new Se(v.lat,v.lng),this._northEast=new Se(k.lat,k.lng)):(r.lat=Math.min(v.lat,r.lat),r.lng=Math.min(v.lng,r.lng),d.lat=Math.max(k.lat,d.lat),d.lng=Math.max(k.lng,d.lng)),this},pad:function(n){var r=this._southWest,d=this._northEast,v=Math.abs(r.lat-d.lat)*n,k=Math.abs(r.lng-d.lng)*n;return new we(new Se(r.lat-v,r.lng-k),new Se(d.lat+v,d.lng+k))},getCenter:function(){return new Se((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Se(this.getNorth(),this.getWest())},getSouthEast:function(){return new Se(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof Se||"lat"in n?n=Ee(n):n=De(n);var r=this._southWest,d=this._northEast,v,k;return n instanceof we?(v=n.getSouthWest(),k=n.getNorthEast()):v=k=n,v.lat>=r.lat&&k.lat<=d.lat&&v.lng>=r.lng&&k.lng<=d.lng},intersects:function(n){n=De(n);var r=this._southWest,d=this._northEast,v=n.getSouthWest(),k=n.getNorthEast(),P=k.lat>=r.lat&&v.lat<=d.lat,W=k.lng>=r.lng&&v.lng<=d.lng;return P&&W},overlaps:function(n){n=De(n);var r=this._southWest,d=this._northEast,v=n.getSouthWest(),k=n.getNorthEast(),P=k.lat>r.lat&&v.lat<d.lat,W=k.lng>r.lng&&v.lng<d.lng;return P&&W},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,r){return n?(n=De(n),this._southWest.equals(n.getSouthWest(),r)&&this._northEast.equals(n.getNorthEast(),r)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function De(n,r){return n instanceof we?n:new we(n,r)}function Se(n,r,d){if(isNaN(n)||isNaN(r))throw new Error("Invalid LatLng object: ("+n+", "+r+")");this.lat=+n,this.lng=+r,d!==void 0&&(this.alt=+d)}Se.prototype={equals:function(n,r){if(!n)return!1;n=Ee(n);var d=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return d<=(r===void 0?1e-9:r)},toString:function(n){return"LatLng("+b(this.lat,n)+", "+b(this.lng,n)+")"},distanceTo:function(n){return me.distance(this,Ee(n))},wrap:function(){return me.wrapLatLng(this)},toBounds:function(n){var r=180*n/40075017,d=r/Math.cos(Math.PI/180*this.lat);return De([this.lat-r,this.lng-d],[this.lat+r,this.lng+d])},clone:function(){return new Se(this.lat,this.lng,this.alt)}};function Ee(n,r,d){return n instanceof Se?n:C(n)&&typeof n[0]!="object"?n.length===3?new Se(n[0],n[1],n[2]):n.length===2?new Se(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new Se(n.lat,"lng"in n?n.lng:n.lon,n.alt):r===void 0?null:new Se(n,r,d)}var se={latLngToPoint:function(n,r){var d=this.projection.project(n),v=this.scale(r);return this.transformation._transform(d,v)},pointToLatLng:function(n,r){var d=this.scale(r),v=this.transformation.untransform(n,d);return this.projection.unproject(v)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var r=this.projection.bounds,d=this.scale(n),v=this.transformation.transform(r.min,d),k=this.transformation.transform(r.max,d);return new pe(v,k)},infinite:!1,wrapLatLng:function(n){var r=this.wrapLng?p(n.lng,this.wrapLng,!0):n.lng,d=this.wrapLat?p(n.lat,this.wrapLat,!0):n.lat,v=n.alt;return new Se(d,r,v)},wrapLatLngBounds:function(n){var r=n.getCenter(),d=this.wrapLatLng(r),v=r.lat-d.lat,k=r.lng-d.lng;if(v===0&&k===0)return n;var P=n.getSouthWest(),W=n.getNorthEast(),he=new Se(P.lat-v,P.lng-k),ye=new Se(W.lat-v,W.lng-k);return new we(he,ye)}},me=s({},se,{wrapLng:[-180,180],R:6371e3,distance:function(n,r){var d=Math.PI/180,v=n.lat*d,k=r.lat*d,P=Math.sin((r.lat-n.lat)*d/2),W=Math.sin((r.lng-n.lng)*d/2),he=P*P+Math.cos(v)*Math.cos(k)*W*W,ye=2*Math.atan2(Math.sqrt(he),Math.sqrt(1-he));return this.R*ye}}),ne=6378137,de={R:ne,MAX_LATITUDE:85.0511287798,project:function(n){var r=Math.PI/180,d=this.MAX_LATITUDE,v=Math.max(Math.min(d,n.lat),-d),k=Math.sin(v*r);return new j(this.R*n.lng*r,this.R*Math.log((1+k)/(1-k))/2)},unproject:function(n){var r=180/Math.PI;return new Se((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*r,n.x*r/this.R)},bounds:(function(){var n=ne*Math.PI;return new pe([-n,-n],[n,n])})()};function Le(n,r,d,v){if(C(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=r,this._c=d,this._d=v}Le.prototype={transform:function(n,r){return this._transform(n.clone(),r)},_transform:function(n,r){return r=r||1,n.x=r*(this._a*n.x+this._b),n.y=r*(this._c*n.y+this._d),n},untransform:function(n,r){return r=r||1,new j((n.x/r-this._b)/this._a,(n.y/r-this._d)/this._c)}};function B(n,r,d,v){return new Le(n,r,d,v)}var U=s({},me,{code:"EPSG:3857",projection:de,transformation:(function(){var n=.5/(Math.PI*de.R);return B(n,.5,-n,.5)})()}),Q=s({},U,{code:"EPSG:900913"});function Z(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function N(n,r){var d="",v,k,P,W,he,ye;for(v=0,P=n.length;v<P;v++){for(he=n[v],k=0,W=he.length;k<W;k++)ye=he[k],d+=(k?"L":"M")+ye.x+" "+ye.y;d+=r?qe.svg?"z":"x":""}return d||"M0 0"}var R=document.documentElement.style,J="ActiveXObject"in window,ke=J&&!document.addEventListener,xe="msLaunchUri"in navigator&&!("documentMode"in document),Ce=Kt("webkit"),ze=Kt("android"),Re=Kt("android 2")||Kt("android 3"),je=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ye=ze&&Kt("Google")&&je<537&&!("AudioNode"in window),te=!!window.opera,Y=!xe&&Kt("chrome"),H=Kt("gecko")&&!Ce&&!te&&!J,Fe=!Y&&Kt("safari"),Je=Kt("phantom"),Qe="OTransition"in R,ot=navigator.platform.indexOf("Win")===0,$t=J&&"transition"in R,Mt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Re,_t="MozPerspective"in R,rt=!window.L_DISABLE_3D&&($t||Mt||_t)&&!Qe&&!Je,At=typeof orientation<"u"||Kt("mobile"),kt=At&&Ce,Fn=At&&Mt,Jt=!window.PointerEvent&&window.MSPointerEvent,eo=!!(window.PointerEvent||Jt),wn="ontouchstart"in window||!!window.TouchEvent,$n=!window.L_NO_TOUCH&&(wn||eo),po=At&&te,zn=At&&H,jo=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,_s=(function(){var n=!1;try{var r=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",g,r),window.removeEventListener("testPassiveEventSupport",g,r)}catch{}return n})(),Gs=(function(){return!!document.createElement("canvas").getContext})(),Un=!!(document.createElementNS&&Z("svg").createSVGRect),ln=!!Un&&(function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Xt=!Un&&(function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var r=n.firstChild;return r.style.behavior="url(#default#VML)",r&&typeof r.adj=="object"}catch{return!1}})(),ks=navigator.platform.indexOf("Mac")===0,Wo=navigator.platform.indexOf("Linux")===0;function Kt(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var qe={ie:J,ielt9:ke,edge:xe,webkit:Ce,android:ze,android23:Re,androidStock:Ye,opera:te,chrome:Y,gecko:H,safari:Fe,phantom:Je,opera12:Qe,win:ot,ie3d:$t,webkit3d:Mt,gecko3d:_t,any3d:rt,mobile:At,mobileWebkit:kt,mobileWebkit3d:Fn,msPointer:Jt,pointer:eo,touch:$n,touchNative:wn,mobileOpera:po,mobileGecko:zn,retina:jo,passiveEvents:_s,canvas:Gs,svg:Un,vml:Xt,inlineSvg:ln,mac:ks,linux:Wo},Hn=qe.msPointer?"MSPointerDown":"pointerdown",to=qe.msPointer?"MSPointerMove":"pointermove",vo=qe.msPointer?"MSPointerUp":"pointerup",no=qe.msPointer?"MSPointerCancel":"pointercancel",qo={touchstart:Hn,touchmove:to,touchend:vo,touchcancel:no},Ks={touchstart:Et,touchmove:Yo,touchend:Yo,touchcancel:Yo},Cn={},Go=!1;function Di(n,r,d){return r==="touchstart"&&bs(),Ks[r]?(d=Ks[r].bind(this,d),n.addEventListener(qo[r],d,!1),d):(console.warn("wrong event specified:",r),g)}function Ys(n,r,d){if(!qo[r]){console.warn("wrong event specified:",r);return}n.removeEventListener(qo[r],d,!1)}function Oi(n){Cn[n.pointerId]=n}function Ri(n){Cn[n.pointerId]&&(Cn[n.pointerId]=n)}function Ko(n){delete Cn[n.pointerId]}function bs(){Go||(document.addEventListener(Hn,Oi,!0),document.addEventListener(to,Ri,!0),document.addEventListener(vo,Ko,!0),document.addEventListener(no,Ko,!0),Go=!0)}function Yo(n,r){if(r.pointerType!==(r.MSPOINTER_TYPE_MOUSE||"mouse")){r.touches=[];for(var d in Cn)r.touches.push(Cn[d]);r.changedTouches=[r],n(r)}}function Et(n,r){r.MSPOINTER_TYPE_TOUCH&&r.pointerType===r.MSPOINTER_TYPE_TOUCH&&Ut(r),Yo(n,r)}function Js(n){var r={},d,v;for(v in n)d=n[v],r[v]=d&&d.bind?d.bind(n):d;return n=r,r.type="dblclick",r.detail=2,r.isTrusted=!1,r._simulated=!0,r}var Xs=200;function Qs(n,r){n.addEventListener("dblclick",r);var d=0,v;function k(P){if(P.detail!==1){v=P.detail;return}if(!(P.pointerType==="mouse"||P.sourceCapabilities&&!P.sourceCapabilities.firesTouchEvents)){var W=Ga(P);if(!(W.some(function(ye){return ye instanceof HTMLLabelElement&&ye.attributes.for})&&!W.some(function(ye){return ye instanceof HTMLInputElement||ye instanceof HTMLSelectElement}))){var he=Date.now();he-d<=Xs?(v++,v===2&&r(Js(P))):v=1,d=he}}}return n.addEventListener("click",k),{dblclick:r,simDblclick:k}}function mo(n,r){n.removeEventListener("dblclick",r.dblclick),n.removeEventListener("click",r.simDblclick)}var Jo=ti(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Zt=ti(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),G=Zt==="webkitTransition"||Zt==="OTransition"?Zt+"End":"transitionend";function ee(n){return typeof n=="string"?document.getElementById(n):n}function le(n,r){var d=n.style[r]||n.currentStyle&&n.currentStyle[r];if((!d||d==="auto")&&document.defaultView){var v=document.defaultView.getComputedStyle(n,null);d=v?v[r]:null}return d==="auto"?null:d}function be(n,r,d){var v=document.createElement(n);return v.className=r||"",d&&d.appendChild(v),v}function Pe(n){var r=n.parentNode;r&&r.removeChild(n)}function st(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function Ct(n){var r=n.parentNode;r&&r.lastChild!==n&&r.appendChild(n)}function Pt(n){var r=n.parentNode;r&&r.firstChild!==n&&r.insertBefore(n,r.firstChild)}function ws(n,r){if(n.classList!==void 0)return n.classList.contains(r);var d=ei(n);return d.length>0&&new RegExp("(^|\\s)"+r+"(\\s|$)").test(d)}function ct(n,r){if(n.classList!==void 0)for(var d=T(r),v=0,k=d.length;v<k;v++)n.classList.add(d[v]);else if(!ws(n,r)){var P=ei(n);Bi(n,(P?P+" ":"")+r)}}function Tt(n,r){n.classList!==void 0?n.classList.remove(r):Bi(n,S((" "+ei(n)+" ").replace(" "+r+" "," ")))}function Bi(n,r){n.className.baseVal===void 0?n.className=r:n.className.baseVal=r}function ei(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function jt(n,r){"opacity"in n.style?n.style.opacity=r:"filter"in n.style&&Cl(n,r)}function Cl(n,r){var d=!1,v="DXImageTransform.Microsoft.Alpha";try{d=n.filters.item(v)}catch{if(r===1)return}r=Math.round(r*100),d?(d.Enabled=r!==100,d.Opacity=r):n.style.filter+=" progid:"+v+"(opacity="+r+")"}function ti(n){for(var r=document.documentElement.style,d=0;d<n.length;d++)if(n[d]in r)return n[d];return!1}function go(n,r,d){var v=r||new j(0,0);n.style[Jo]=(qe.ie3d?"translate("+v.x+"px,"+v.y+"px)":"translate3d("+v.x+"px,"+v.y+"px,0)")+(d?" scale("+d+")":"")}function Ot(n,r){n._leaflet_pos=r,qe.any3d?go(n,r):(n.style.left=r.x+"px",n.style.top=r.y+"px")}function yo(n){return n._leaflet_pos||new j(0,0)}var Cs,_o,Ni;if("onselectstart"in document)Cs=function(){it(window,"selectstart",Ut)},_o=function(){bt(window,"selectstart",Ut)};else{var Ls=ti(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Cs=function(){if(Ls){var n=document.documentElement.style;Ni=n[Ls],n[Ls]="none"}},_o=function(){Ls&&(document.documentElement.style[Ls]=Ni,Ni=void 0)}}function Fi(){it(window,"dragstart",Ut)}function zi(){bt(window,"dragstart",Ut)}var Xo,Ui;function Hi(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(ni(),Xo=n,Ui=n.style.outlineStyle,n.style.outlineStyle="none",it(window,"keydown",ni))}function ni(){Xo&&(Xo.style.outlineStyle=Ui,Xo=void 0,Ui=void 0,bt(window,"keydown",ni))}function qa(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function Ss(n){var r=n.getBoundingClientRect();return{x:r.width/n.offsetWidth||1,y:r.height/n.offsetHeight||1,boundingClientRect:r}}var Ll={__proto__:null,TRANSFORM:Jo,TRANSITION:Zt,TRANSITION_END:G,get:ee,getStyle:le,create:be,remove:Pe,empty:st,toFront:Ct,toBack:Pt,hasClass:ws,addClass:ct,removeClass:Tt,setClass:Bi,getClass:ei,setOpacity:jt,testProp:ti,setTransform:go,setPosition:Ot,getPosition:yo,get disableTextSelection(){return Cs},get enableTextSelection(){return _o},disableImageDrag:Fi,enableImageDrag:zi,preventOutline:Hi,restoreOutline:ni,getSizedParentNode:qa,getScale:Ss};function it(n,r,d,v){if(r&&typeof r=="object")for(var k in r)Zi(n,k,r[k],d);else{r=T(r);for(var P=0,W=r.length;P<W;P++)Zi(n,r[P],d,v)}return this}var Mn="_leaflet_events";function bt(n,r,d,v){if(arguments.length===1)oi(n),delete n[Mn];else if(r&&typeof r=="object")for(var k in r)si(n,k,r[k],d);else if(r=T(r),arguments.length===2)oi(n,function(he){return A(r,he)!==-1});else for(var P=0,W=r.length;P<W;P++)si(n,r[P],d,v);return this}function oi(n,r){for(var d in n[Mn]){var v=d.split(/\d/)[0];(!r||r(v))&&si(n,v,null,null,d)}}var Vi={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Zi(n,r,d,v){var k=r+h(d)+(v?"_"+h(v):"");if(n[Mn]&&n[Mn][k])return this;var P=function(he){return d.call(v||n,he||window.event)},W=P;!qe.touchNative&&qe.pointer&&r.indexOf("touch")===0?P=Di(n,r,P):qe.touch&&r==="dblclick"?P=Qs(n,P):"addEventListener"in n?r==="touchstart"||r==="touchmove"||r==="wheel"||r==="mousewheel"?n.addEventListener(Vi[r]||r,P,qe.passiveEvents?{passive:!1}:!1):r==="mouseenter"||r==="mouseleave"?(P=function(he){he=he||window.event,ji(n,he)&&W(he)},n.addEventListener(Vi[r],P,!1)):n.addEventListener(r,W,!1):n.attachEvent("on"+r,P),n[Mn]=n[Mn]||{},n[Mn][k]=P}function si(n,r,d,v,k){k=k||r+h(d)+(v?"_"+h(v):"");var P=n[Mn]&&n[Mn][k];if(!P)return this;!qe.touchNative&&qe.pointer&&r.indexOf("touch")===0?Ys(n,r,P):qe.touch&&r==="dblclick"?mo(n,P):"removeEventListener"in n?n.removeEventListener(Vi[r]||r,P,!1):n.detachEvent("on"+r,P),n[Mn][k]=null}function ko(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function ii(n){return Zi(n,"wheel",ko),this}function xs(n){return it(n,"mousedown touchstart dblclick contextmenu",ko),n._leaflet_disable_click=!0,this}function Ut(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function bo(n){return Ut(n),ko(n),this}function Ga(n){if(n.composedPath)return n.composedPath();for(var r=[],d=n.target;d;)r.push(d),d=d.parentNode;return r}function Ka(n,r){if(!r)return new j(n.clientX,n.clientY);var d=Ss(r),v=d.boundingClientRect;return new j((n.clientX-v.left)/d.x-r.clientLeft,(n.clientY-v.top)/d.y-r.clientTop)}var Sl=qe.linux&&qe.chrome?window.devicePixelRatio:qe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ya(n){return qe.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/Sl:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function ji(n,r){var d=r.relatedTarget;if(!d)return!0;try{for(;d&&d!==n;)d=d.parentNode}catch{return!1}return d!==n}var xl={__proto__:null,on:it,off:bt,stopPropagation:ko,disableScrollPropagation:ii,disableClickPropagation:xs,preventDefault:Ut,stop:bo,getPropagationPath:Ga,getMousePosition:Ka,getWheelDelta:Ya,isExternalTarget:ji,addListener:it,removeListener:bt},Ja=q.extend({run:function(n,r,d,v){this.stop(),this._el=n,this._inProgress=!0,this._duration=d||.25,this._easeOutPower=1/Math.max(v||.5,.2),this._startPos=yo(n),this._offset=r.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=re(this._animate,this),this._step()},_step:function(n){var r=+new Date-this._startTime,d=this._duration*1e3;r<d?this._runFrame(this._easeOut(r/d),n):(this._runFrame(1),this._complete())},_runFrame:function(n,r){var d=this._startPos.add(this._offset.multiplyBy(n));r&&d._round(),Ot(this._el,d),this.fire("step")},_complete:function(){ve(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),pt=q.extend({options:{crs:U,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,r){r=_(this,r),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),r.maxBounds&&this.setMaxBounds(r.maxBounds),r.zoom!==void 0&&(this._zoom=this._limitZoom(r.zoom)),r.center&&r.zoom!==void 0&&this.setView(Ee(r.center),r.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Zt&&qe.any3d&&!qe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),it(this._proxy,G,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,r,d){if(r=r===void 0?this._zoom:this._limitZoom(r),n=this._limitCenter(Ee(n),r,this.options.maxBounds),d=d||{},this._stop(),this._loaded&&!d.reset&&d!==!0){d.animate!==void 0&&(d.zoom=s({animate:d.animate},d.zoom),d.pan=s({animate:d.animate,duration:d.duration},d.pan));var v=this._zoom!==r?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,r,d.zoom):this._tryAnimatedPan(n,d.pan);if(v)return clearTimeout(this._sizeTimer),this}return this._resetView(n,r,d.pan&&d.pan.noMoveStart),this},setZoom:function(n,r){return this._loaded?this.setView(this.getCenter(),n,{zoom:r}):(this._zoom=n,this)},zoomIn:function(n,r){return n=n||(qe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,r)},zoomOut:function(n,r){return n=n||(qe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,r)},setZoomAround:function(n,r,d){var v=this.getZoomScale(r),k=this.getSize().divideBy(2),P=n instanceof j?n:this.latLngToContainerPoint(n),W=P.subtract(k).multiplyBy(1-1/v),he=this.containerPointToLatLng(k.add(W));return this.setView(he,r,{zoom:d})},_getBoundsCenterZoom:function(n,r){r=r||{},n=n.getBounds?n.getBounds():De(n);var d=K(r.paddingTopLeft||r.padding||[0,0]),v=K(r.paddingBottomRight||r.padding||[0,0]),k=this.getBoundsZoom(n,!1,d.add(v));if(k=typeof r.maxZoom=="number"?Math.min(r.maxZoom,k):k,k===1/0)return{center:n.getCenter(),zoom:k};var P=v.subtract(d).divideBy(2),W=this.project(n.getSouthWest(),k),he=this.project(n.getNorthEast(),k),ye=this.unproject(W.add(he).divideBy(2).add(P),k);return{center:ye,zoom:k}},fitBounds:function(n,r){if(n=De(n),!n.isValid())throw new Error("Bounds are not valid.");var d=this._getBoundsCenterZoom(n,r);return this.setView(d.center,d.zoom,r)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,r){return this.setView(n,this._zoom,{pan:r})},panBy:function(n,r){if(n=K(n).round(),r=r||{},!n.x&&!n.y)return this.fire("moveend");if(r.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ja,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),r.noMoveStart||this.fire("movestart"),r.animate!==!1){ct(this._mapPane,"leaflet-pan-anim");var d=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,d,r.duration||.25,r.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,r,d){if(d=d||{},d.animate===!1||!qe.any3d)return this.setView(n,r,d);this._stop();var v=this.project(this.getCenter()),k=this.project(n),P=this.getSize(),W=this._zoom;n=Ee(n),r=r===void 0?W:r;var he=Math.max(P.x,P.y),ye=he*this.getZoomScale(W,r),Me=k.distanceTo(v)||1,Ge=1.42,nt=Ge*Ge;function ft(Ht){var pr=Ht?-1:1,av=Ht?ye:he,rv=ye*ye-he*he+pr*nt*nt*Me*Me,lv=2*av*nt*Me,Nl=rv/lv,Du=Math.sqrt(Nl*Nl+1)-Nl,cv=Du<1e-9?-18:Math.log(Du);return cv}function un(Ht){return(Math.exp(Ht)-Math.exp(-Ht))/2}function Wt(Ht){return(Math.exp(Ht)+Math.exp(-Ht))/2}function Pn(Ht){return un(Ht)/Wt(Ht)}var mn=ft(0);function hi(Ht){return he*(Wt(mn)/Wt(mn+Ge*Ht))}function nv(Ht){return he*(Wt(mn)*Pn(mn+Ge*Ht)-un(mn))/nt}function ov(Ht){return 1-Math.pow(1-Ht,1.5)}var sv=Date.now(),Eu=(ft(1)-mn)/Ge,iv=d.duration?1e3*d.duration:1e3*Eu*.8;function Pu(){var Ht=(Date.now()-sv)/iv,pr=ov(Ht)*Eu;Ht<=1?(this._flyToFrame=re(Pu,this),this._move(this.unproject(v.add(k.subtract(v).multiplyBy(nv(pr)/Me)),W),this.getScaleZoom(he/hi(pr),W),{flyTo:!0})):this._move(n,r)._moveEnd(!0)}return this._moveStart(!0,d.noMoveStart),Pu.call(this),this},flyToBounds:function(n,r){var d=this._getBoundsCenterZoom(n,r);return this.flyTo(d.center,d.zoom,r)},setMaxBounds:function(n){return n=De(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var r=this.options.minZoom;return this.options.minZoom=n,this._loaded&&r!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var r=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&r!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,r){this._enforcingBounds=!0;var d=this.getCenter(),v=this._limitCenter(d,this._zoom,De(n));return d.equals(v)||this.panTo(v,r),this._enforcingBounds=!1,this},panInside:function(n,r){r=r||{};var d=K(r.paddingTopLeft||r.padding||[0,0]),v=K(r.paddingBottomRight||r.padding||[0,0]),k=this.project(this.getCenter()),P=this.project(n),W=this.getPixelBounds(),he=X([W.min.add(d),W.max.subtract(v)]),ye=he.getSize();if(!he.contains(P)){this._enforcingBounds=!0;var Me=P.subtract(he.getCenter()),Ge=he.extend(P).getSize().subtract(ye);k.x+=Me.x<0?-Ge.x:Ge.x,k.y+=Me.y<0?-Ge.y:Ge.y,this.panTo(this.unproject(k),r),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=s({animate:!1,pan:!0},n===!0?{animate:!0}:n);var r=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var d=this.getSize(),v=r.divideBy(2).round(),k=d.divideBy(2).round(),P=v.subtract(k);return!P.x&&!P.y?this:(n.animate&&n.pan?this.panBy(P):(n.pan&&this._rawPanBy(P),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:r,newSize:d}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=s({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var r=l(this._handleGeolocationResponse,this),d=l(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(r,d,n):navigator.geolocation.getCurrentPosition(r,d,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var r=n.code,d=n.message||(r===1?"permission denied":r===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:r,message:"Geolocation error: "+d+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var r=n.coords.latitude,d=n.coords.longitude,v=new Se(r,d),k=v.toBounds(n.coords.accuracy*2),P=this._locateOptions;if(P.setView){var W=this.getBoundsZoom(k);this.setView(v,P.maxZoom?Math.min(W,P.maxZoom):W)}var he={latlng:v,bounds:k,timestamp:n.timestamp};for(var ye in n.coords)typeof n.coords[ye]=="number"&&(he[ye]=n.coords[ye]);this.fire("locationfound",he)}},addHandler:function(n,r){if(!r)return this;var d=this[n]=new r(this);return this._handlers.push(d),this.options[n]&&d.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Pe(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(ve(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)Pe(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,r){var d="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),v=be("div",d,r||this._mapPane);return n&&(this._panes[n]=v),v},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),r=this.unproject(n.getBottomLeft()),d=this.unproject(n.getTopRight());return new we(r,d)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,r,d){n=De(n),d=K(d||[0,0]);var v=this.getZoom()||0,k=this.getMinZoom(),P=this.getMaxZoom(),W=n.getNorthWest(),he=n.getSouthEast(),ye=this.getSize().subtract(d),Me=X(this.project(he,v),this.project(W,v)).getSize(),Ge=qe.any3d?this.options.zoomSnap:1,nt=ye.x/Me.x,ft=ye.y/Me.y,un=r?Math.max(nt,ft):Math.min(nt,ft);return v=this.getScaleZoom(un,v),Ge&&(v=Math.round(v/(Ge/100))*(Ge/100),v=r?Math.ceil(v/Ge)*Ge:Math.floor(v/Ge)*Ge),Math.max(k,Math.min(P,v))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new j(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,r){var d=this._getTopLeftPoint(n,r);return new pe(d,d.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,r){var d=this.options.crs;return r=r===void 0?this._zoom:r,d.scale(n)/d.scale(r)},getScaleZoom:function(n,r){var d=this.options.crs;r=r===void 0?this._zoom:r;var v=d.zoom(n*d.scale(r));return isNaN(v)?1/0:v},project:function(n,r){return r=r===void 0?this._zoom:r,this.options.crs.latLngToPoint(Ee(n),r)},unproject:function(n,r){return r=r===void 0?this._zoom:r,this.options.crs.pointToLatLng(K(n),r)},layerPointToLatLng:function(n){var r=K(n).add(this.getPixelOrigin());return this.unproject(r)},latLngToLayerPoint:function(n){var r=this.project(Ee(n))._round();return r._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(Ee(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(De(n))},distance:function(n,r){return this.options.crs.distance(Ee(n),Ee(r))},containerPointToLayerPoint:function(n){return K(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return K(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var r=this.containerPointToLayerPoint(K(n));return this.layerPointToLatLng(r)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Ee(n)))},mouseEventToContainerPoint:function(n){return Ka(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var r=this._container=ee(n);if(r){if(r._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");it(r,"scroll",this._onScroll,this),this._containerId=h(r)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&qe.any3d,ct(n,"leaflet-container"+(qe.touch?" leaflet-touch":"")+(qe.retina?" leaflet-retina":"")+(qe.ielt9?" leaflet-oldie":"")+(qe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var r=le(n,"position");r!=="absolute"&&r!=="relative"&&r!=="fixed"&&r!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ot(this._mapPane,new j(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ct(n.markerPane,"leaflet-zoom-hide"),ct(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,r,d){Ot(this._mapPane,new j(0,0));var v=!this._loaded;this._loaded=!0,r=this._limitZoom(r),this.fire("viewprereset");var k=this._zoom!==r;this._moveStart(k,d)._move(n,r)._moveEnd(k),this.fire("viewreset"),v&&this.fire("load")},_moveStart:function(n,r){return n&&this.fire("zoomstart"),r||this.fire("movestart"),this},_move:function(n,r,d,v){r===void 0&&(r=this._zoom);var k=this._zoom!==r;return this._zoom=r,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),v?d&&d.pinch&&this.fire("zoom",d):((k||d&&d.pinch)&&this.fire("zoom",d),this.fire("move",d)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return ve(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){Ot(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[h(this._container)]=this;var r=n?bt:it;r(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&r(window,"resize",this._onResize,this),qe.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){ve(this._resizeRequest),this._resizeRequest=re(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,r){for(var d=[],v,k=r==="mouseout"||r==="mouseover",P=n.target||n.srcElement,W=!1;P;){if(v=this._targets[h(P)],v&&(r==="click"||r==="preclick")&&this._draggableMoved(v)){W=!0;break}if(v&&v.listens(r,!0)&&(k&&!ji(P,n)||(d.push(v),k))||P===this._container)break;P=P.parentNode}return!d.length&&!W&&!k&&this.listens(r,!0)&&(d=[this]),d},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var r=n.target||n.srcElement;if(!(!this._loaded||r._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(r))){var d=n.type;d==="mousedown"&&Hi(r),this._fireDOMEvent(n,d)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,r,d){if(n.type==="click"){var v=s({},n);v.type="preclick",this._fireDOMEvent(v,v.type,d)}var k=this._findEventTargets(n,r);if(d){for(var P=[],W=0;W<d.length;W++)d[W].listens(r,!0)&&P.push(d[W]);k=P.concat(k)}if(k.length){r==="contextmenu"&&Ut(n);var he=k[0],ye={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var Me=he.getLatLng&&(!he._radius||he._radius<=10);ye.containerPoint=Me?this.latLngToContainerPoint(he.getLatLng()):this.mouseEventToContainerPoint(n),ye.layerPoint=this.containerPointToLayerPoint(ye.containerPoint),ye.latlng=Me?he.getLatLng():this.layerPointToLatLng(ye.layerPoint)}for(W=0;W<k.length;W++)if(k[W].fire(r,ye,!0),ye.originalEvent._stopped||k[W].options.bubblingMouseEvents===!1&&A(this._mouseEvents,r)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,r=this._handlers.length;n<r;n++)this._handlers[n].disable()},whenReady:function(n,r){return this._loaded?n.call(r||this,{target:this}):this.on("load",n,r),this},_getMapPanePos:function(){return yo(this._mapPane)||new j(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,r){var d=n&&r!==void 0?this._getNewPixelOrigin(n,r):this.getPixelOrigin();return d.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,r){var d=this.getSize()._divideBy(2);return this.project(n,r)._subtract(d)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,r,d){var v=this._getNewPixelOrigin(d,r);return this.project(n,r)._subtract(v)},_latLngBoundsToNewLayerBounds:function(n,r,d){var v=this._getNewPixelOrigin(d,r);return X([this.project(n.getSouthWest(),r)._subtract(v),this.project(n.getNorthWest(),r)._subtract(v),this.project(n.getSouthEast(),r)._subtract(v),this.project(n.getNorthEast(),r)._subtract(v)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,r,d){if(!d)return n;var v=this.project(n,r),k=this.getSize().divideBy(2),P=new pe(v.subtract(k),v.add(k)),W=this._getBoundsOffset(P,d,r);return Math.abs(W.x)<=1&&Math.abs(W.y)<=1?n:this.unproject(v.add(W),r)},_limitOffset:function(n,r){if(!r)return n;var d=this.getPixelBounds(),v=new pe(d.min.add(n),d.max.add(n));return n.add(this._getBoundsOffset(v,r))},_getBoundsOffset:function(n,r,d){var v=X(this.project(r.getNorthEast(),d),this.project(r.getSouthWest(),d)),k=v.min.subtract(n.min),P=v.max.subtract(n.max),W=this._rebound(k.x,-P.x),he=this._rebound(k.y,-P.y);return new j(W,he)},_rebound:function(n,r){return n+r>0?Math.round(n-r)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(r))},_limitZoom:function(n){var r=this.getMinZoom(),d=this.getMaxZoom(),v=qe.any3d?this.options.zoomSnap:1;return v&&(n=Math.round(n/v)*v),Math.max(r,Math.min(d,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Tt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,r){var d=this._getCenterOffset(n)._trunc();return(r&&r.animate)!==!0&&!this.getSize().contains(d)?!1:(this.panBy(d,r),!0)},_createAnimProxy:function(){var n=this._proxy=be("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(r){var d=Jo,v=this._proxy.style[d];go(this._proxy,this.project(r.center,r.zoom),this.getZoomScale(r.zoom,1)),v===this._proxy.style[d]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Pe(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),r=this.getZoom();go(this._proxy,this.project(n,r),this.getZoomScale(r,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,r,d){if(this._animatingZoom)return!0;if(d=d||{},!this._zoomAnimated||d.animate===!1||this._nothingToAnimate()||Math.abs(r-this._zoom)>this.options.zoomAnimationThreshold)return!1;var v=this.getZoomScale(r),k=this._getCenterOffset(n)._divideBy(1-1/v);return d.animate!==!0&&!this.getSize().contains(k)?!1:(re(function(){this._moveStart(!0,d.noMoveStart||!1)._animateZoom(n,r,!0)},this),!0)},_animateZoom:function(n,r,d,v){this._mapPane&&(d&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=r,ct(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:r,noUpdate:v}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Tt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Tl(n,r){return new pt(n,r)}var Ln=He.extend({options:{position:"topright"},initialize:function(n){_(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var r=this._map;return r&&r.removeControl(this),this.options.position=n,r&&r.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var r=this._container=this.onAdd(n),d=this.getPosition(),v=n._controlCorners[d];return ct(r,"leaflet-control"),d.indexOf("bottom")!==-1?v.insertBefore(r,v.firstChild):v.appendChild(r),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Pe(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),Ts=function(n){return new Ln(n)};pt.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},r="leaflet-",d=this._controlContainer=be("div",r+"control-container",this._container);function v(k,P){var W=r+k+" "+r+P;n[k+P]=be("div",W,d)}v("top","left"),v("top","right"),v("bottom","left"),v("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)Pe(this._controlCorners[n]);Pe(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Qo=Ln.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,r,d,v){return d<v?-1:v<d?1:0}},initialize:function(n,r,d){_(this,d),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var v in n)this._addLayer(n[v],v);for(v in r)this._addLayer(r[v],v,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return Ln.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,r){return this._addLayer(n,r),this._map?this._update():this},addOverlay:function(n,r){return this._addLayer(n,r,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var r=this._getLayer(h(n));return r&&this._layers.splice(this._layers.indexOf(r),1),this._map?this._update():this},expand:function(){ct(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(ct(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):Tt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Tt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",r=this._container=be("div",n),d=this.options.collapsed;r.setAttribute("aria-haspopup",!0),xs(r),ii(r);var v=this._section=be("section",n+"-list");d&&(this._map.on("click",this.collapse,this),it(r,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var k=this._layersLink=be("a",n+"-toggle",r);k.href="#",k.title="Layers",k.setAttribute("role","button"),it(k,{keydown:function(P){P.keyCode===13&&this._expandSafely()},click:function(P){Ut(P),this._expandSafely()}},this),d||this.expand(),this._baseLayersList=be("div",n+"-base",v),this._separator=be("div",n+"-separator",v),this._overlaysList=be("div",n+"-overlays",v),r.appendChild(v)},_getLayer:function(n){for(var r=0;r<this._layers.length;r++)if(this._layers[r]&&h(this._layers[r].layer)===n)return this._layers[r]},_addLayer:function(n,r,d){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:r,overlay:d}),this.options.sortLayers&&this._layers.sort(l(function(v,k){return this.options.sortFunction(v.layer,k.layer,v.name,k.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;st(this._baseLayersList),st(this._overlaysList),this._layerControlInputs=[];var n,r,d,v,k=0;for(d=0;d<this._layers.length;d++)v=this._layers[d],this._addItem(v),r=r||v.overlay,n=n||!v.overlay,k+=v.overlay?0:1;return this.options.hideSingleBase&&(n=n&&k>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=r&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var r=this._getLayer(h(n.target)),d=r.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;d&&this._map.fire(d,r)},_createRadioElement:function(n,r){var d='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(r?' checked="checked"':"")+"/>",v=document.createElement("div");return v.innerHTML=d,v.firstChild},_addItem:function(n){var r=document.createElement("label"),d=this._map.hasLayer(n.layer),v;n.overlay?(v=document.createElement("input"),v.type="checkbox",v.className="leaflet-control-layers-selector",v.defaultChecked=d):v=this._createRadioElement("leaflet-base-layers_"+h(this),d),this._layerControlInputs.push(v),v.layerId=h(n.layer),it(v,"click",this._onInputClick,this);var k=document.createElement("span");k.innerHTML=" "+n.name;var P=document.createElement("span");r.appendChild(P),P.appendChild(v),P.appendChild(k);var W=n.overlay?this._overlaysList:this._baseLayersList;return W.appendChild(r),this._checkDisabledLayers(),r},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,r,d,v=[],k=[];this._handlingClick=!0;for(var P=n.length-1;P>=0;P--)r=n[P],d=this._getLayer(r.layerId).layer,r.checked?v.push(d):r.checked||k.push(d);for(P=0;P<k.length;P++)this._map.hasLayer(k[P])&&this._map.removeLayer(k[P]);for(P=0;P<v.length;P++)this._map.hasLayer(v[P])||this._map.addLayer(v[P]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,r,d,v=this._map.getZoom(),k=n.length-1;k>=0;k--)r=n[k],d=this._getLayer(r.layerId).layer,r.disabled=d.options.minZoom!==void 0&&v<d.options.minZoom||d.options.maxZoom!==void 0&&v>d.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,it(n,"click",Ut),this.expand();var r=this;setTimeout(function(){bt(n,"click",Ut),r._preventClick=!1})}}),Il=function(n,r,d){return new Qo(n,r,d)},es=Ln.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var r="leaflet-control-zoom",d=be("div",r+" leaflet-bar"),v=this.options;return this._zoomInButton=this._createButton(v.zoomInText,v.zoomInTitle,r+"-in",d,this._zoomIn),this._zoomOutButton=this._createButton(v.zoomOutText,v.zoomOutTitle,r+"-out",d,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),d},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,r,d,v,k){var P=be("a",d,v);return P.innerHTML=n,P.href="#",P.title=r,P.setAttribute("role","button"),P.setAttribute("aria-label",r),xs(P),it(P,"click",bo),it(P,"click",k,this),it(P,"click",this._refocusOnMap,this),P},_updateDisabled:function(){var n=this._map,r="leaflet-disabled";Tt(this._zoomInButton,r),Tt(this._zoomOutButton,r),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(ct(this._zoomOutButton,r),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(ct(this._zoomInButton,r),this._zoomInButton.setAttribute("aria-disabled","true"))}});pt.mergeOptions({zoomControl:!0}),pt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new es,this.addControl(this.zoomControl))});var $l=function(n){return new es(n)},Wi=Ln.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var r="leaflet-control-scale",d=be("div",r),v=this.options;return this._addScales(v,r+"-line",d),n.on(v.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),d},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,r,d){n.metric&&(this._mScale=be("div",r,d)),n.imperial&&(this._iScale=be("div",r,d))},_update:function(){var n=this._map,r=n.getSize().y/2,d=n.distance(n.containerPointToLatLng([0,r]),n.containerPointToLatLng([this.options.maxWidth,r]));this._updateScales(d)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var r=this._getRoundNum(n),d=r<1e3?r+" m":r/1e3+" km";this._updateScale(this._mScale,d,r/n)},_updateImperial:function(n){var r=n*3.2808399,d,v,k;r>5280?(d=r/5280,v=this._getRoundNum(d),this._updateScale(this._iScale,v+" mi",v/d)):(k=this._getRoundNum(r),this._updateScale(this._iScale,k+" ft",k/r))},_updateScale:function(n,r,d){n.style.width=Math.round(this.options.maxWidth*d)+"px",n.innerHTML=r},_getRoundNum:function(n){var r=Math.pow(10,(Math.floor(n)+"").length-1),d=n/r;return d=d>=10?10:d>=5?5:d>=3?3:d>=2?2:1,r*d}}),qi=function(n){return new Wi(n)},Gi='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Ki=Ln.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(qe.inlineSvg?Gi+" ":"")+"Leaflet</a>"},initialize:function(n){_(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=be("div","leaflet-control-attribution"),xs(this._container);for(var r in n._layers)n._layers[r].getAttribution&&this.addAttribution(n._layers[r].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var r in this._attributions)this._attributions[r]&&n.push(r);var d=[];this.options.prefix&&d.push(this.options.prefix),n.length&&d.push(n.join(", ")),this._container.innerHTML=d.join(' <span aria-hidden="true">|</span> ')}}});pt.mergeOptions({attributionControl:!0}),pt.addInitHook(function(){this.options.attributionControl&&new Ki().addTo(this)});var Ml=function(n){return new Ki(n)};Ln.Layers=Qo,Ln.Zoom=es,Ln.Scale=Wi,Ln.Attribution=Ki,Ts.layers=Il,Ts.zoom=$l,Ts.scale=qi,Ts.attribution=Ml;var An=He.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});An.addTo=function(n,r){return n.addHandler(r,this),this};var Al={Events:fe},Xa=qe.touch?"touchstart mousedown":"mousedown",oo=q.extend({options:{clickTolerance:3},initialize:function(n,r,d,v){_(this,v),this._element=n,this._dragStartTarget=r||n,this._preventOutline=d},enable:function(){this._enabled||(it(this._dragStartTarget,Xa,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(oo._dragging===this&&this.finishDrag(!0),bt(this._dragStartTarget,Xa,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!ws(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){oo._dragging===this&&this.finishDrag();return}if(!(oo._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(oo._dragging=this,this._preventOutline&&Hi(this._element),Fi(),Cs(),!this._moving)){this.fire("down");var r=n.touches?n.touches[0]:n,d=qa(this._element);this._startPoint=new j(r.clientX,r.clientY),this._startPos=yo(this._element),this._parentScale=Ss(d);var v=n.type==="mousedown";it(document,v?"mousemove":"touchmove",this._onMove,this),it(document,v?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var r=n.touches&&n.touches.length===1?n.touches[0]:n,d=new j(r.clientX,r.clientY)._subtract(this._startPoint);!d.x&&!d.y||Math.abs(d.x)+Math.abs(d.y)<this.options.clickTolerance||(d.x/=this._parentScale.x,d.y/=this._parentScale.y,Ut(n),this._moved||(this.fire("dragstart"),this._moved=!0,ct(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ct(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(d),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),Ot(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){Tt(document.body,"leaflet-dragging"),this._lastTarget&&(Tt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),bt(document,"mousemove touchmove",this._onMove,this),bt(document,"mouseup touchend touchcancel",this._onUp,this),zi(),_o();var r=this._moved&&this._moving;this._moving=!1,oo._dragging=!1,r&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function Qa(n,r,d){var v,k=[1,4,2,8],P,W,he,ye,Me,Ge,nt,ft;for(P=0,Ge=n.length;P<Ge;P++)n[P]._code=wo(n[P],r);for(he=0;he<4;he++){for(nt=k[he],v=[],P=0,Ge=n.length,W=Ge-1;P<Ge;W=P++)ye=n[P],Me=n[W],ye._code&nt?Me._code&nt||(ft=ai(Me,ye,nt,r,d),ft._code=wo(ft,r),v.push(ft)):(Me._code&nt&&(ft=ai(Me,ye,nt,r,d),ft._code=wo(ft,r),v.push(ft)),v.push(ye));n=v}return n}function er(n,r){var d,v,k,P,W,he,ye,Me,Ge;if(!n||n.length===0)throw new Error("latlngs not passed");cn(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var nt=Ee([0,0]),ft=De(n),un=ft.getNorthWest().distanceTo(ft.getSouthWest())*ft.getNorthEast().distanceTo(ft.getNorthWest());un<1700&&(nt=Yi(n));var Wt=n.length,Pn=[];for(d=0;d<Wt;d++){var mn=Ee(n[d]);Pn.push(r.project(Ee([mn.lat-nt.lat,mn.lng-nt.lng])))}for(he=ye=Me=0,d=0,v=Wt-1;d<Wt;v=d++)k=Pn[d],P=Pn[v],W=k.y*P.x-P.y*k.x,ye+=(k.x+P.x)*W,Me+=(k.y+P.y)*W,he+=W*3;he===0?Ge=Pn[0]:Ge=[ye/he,Me/he];var hi=r.unproject(K(Ge));return Ee([hi.lat+nt.lat,hi.lng+nt.lng])}function Yi(n){for(var r=0,d=0,v=0,k=0;k<n.length;k++){var P=Ee(n[k]);r+=P.lat,d+=P.lng,v++}return Ee([r/v,d/v])}var tr={__proto__:null,clipPolygon:Qa,polygonCenter:er,centroid:Yi};function nr(n,r){if(!r||!n.length)return n.slice();var d=r*r;return n=Qi(n,d),n=Pl(n,d),n}function Ji(n,r,d){return Math.sqrt(ts(n,r,d,!0))}function El(n,r,d){return ts(n,r,d)}function Pl(n,r){var d=n.length,v=typeof Uint8Array<"u"?Uint8Array:Array,k=new v(d);k[0]=k[d-1]=1,Xi(n,k,r,0,d-1);var P,W=[];for(P=0;P<d;P++)k[P]&&W.push(n[P]);return W}function Xi(n,r,d,v,k){var P=0,W,he,ye;for(he=v+1;he<=k-1;he++)ye=ts(n[he],n[v],n[k],!0),ye>P&&(W=he,P=ye);P>d&&(r[W]=1,Xi(n,r,d,v,W),Xi(n,r,d,W,k))}function Qi(n,r){for(var d=[n[0]],v=1,k=0,P=n.length;v<P;v++)Is(n[v],n[k])>r&&(d.push(n[v]),k=v);return k<P-1&&d.push(n[P-1]),d}var or;function ea(n,r,d,v,k){var P=v?or:wo(n,d),W=wo(r,d),he,ye,Me;for(or=W;;){if(!(P|W))return[n,r];if(P&W)return!1;he=P||W,ye=ai(n,r,he,d,k),Me=wo(ye,d),he===P?(n=ye,P=Me):(r=ye,W=Me)}}function ai(n,r,d,v,k){var P=r.x-n.x,W=r.y-n.y,he=v.min,ye=v.max,Me,Ge;return d&8?(Me=n.x+P*(ye.y-n.y)/W,Ge=ye.y):d&4?(Me=n.x+P*(he.y-n.y)/W,Ge=he.y):d&2?(Me=ye.x,Ge=n.y+W*(ye.x-n.x)/P):d&1&&(Me=he.x,Ge=n.y+W*(he.x-n.x)/P),new j(Me,Ge,k)}function wo(n,r){var d=0;return n.x<r.min.x?d|=1:n.x>r.max.x&&(d|=2),n.y<r.min.y?d|=4:n.y>r.max.y&&(d|=8),d}function Is(n,r){var d=r.x-n.x,v=r.y-n.y;return d*d+v*v}function ts(n,r,d,v){var k=r.x,P=r.y,W=d.x-k,he=d.y-P,ye=W*W+he*he,Me;return ye>0&&(Me=((n.x-k)*W+(n.y-P)*he)/ye,Me>1?(k=d.x,P=d.y):Me>0&&(k+=W*Me,P+=he*Me)),W=n.x-k,he=n.y-P,v?W*W+he*he:new j(k,P)}function cn(n){return!C(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function ta(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),cn(n)}function z(n,r){var d,v,k,P,W,he,ye,Me;if(!n||n.length===0)throw new Error("latlngs not passed");cn(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var Ge=Ee([0,0]),nt=De(n),ft=nt.getNorthWest().distanceTo(nt.getSouthWest())*nt.getNorthEast().distanceTo(nt.getNorthWest());ft<1700&&(Ge=Yi(n));var un=n.length,Wt=[];for(d=0;d<un;d++){var Pn=Ee(n[d]);Wt.push(r.project(Ee([Pn.lat-Ge.lat,Pn.lng-Ge.lng])))}for(d=0,v=0;d<un-1;d++)v+=Wt[d].distanceTo(Wt[d+1])/2;if(v===0)Me=Wt[0];else for(d=0,P=0;d<un-1;d++)if(W=Wt[d],he=Wt[d+1],k=W.distanceTo(he),P+=k,P>v){ye=(P-v)/k,Me=[he.x-ye*(he.x-W.x),he.y-ye*(he.y-W.y)];break}var mn=r.unproject(K(Me));return Ee([mn.lat+Ge.lat,mn.lng+Ge.lng])}var oe={__proto__:null,simplify:nr,pointToSegmentDistance:Ji,closestPointOnSegment:El,clipSegment:ea,_getEdgeIntersection:ai,_getBitCode:wo,_sqClosestPointOnSegment:ts,isFlat:cn,_flat:ta,polylineCenter:z},Ie={project:function(n){return new j(n.lng,n.lat)},unproject:function(n){return new Se(n.y,n.x)},bounds:new pe([-180,-90],[180,90])},$e={R:6378137,R_MINOR:6356752314245179e-9,bounds:new pe([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var r=Math.PI/180,d=this.R,v=n.lat*r,k=this.R_MINOR/d,P=Math.sqrt(1-k*k),W=P*Math.sin(v),he=Math.tan(Math.PI/4-v/2)/Math.pow((1-W)/(1+W),P/2);return v=-d*Math.log(Math.max(he,1e-10)),new j(n.lng*r*d,v)},unproject:function(n){for(var r=180/Math.PI,d=this.R,v=this.R_MINOR/d,k=Math.sqrt(1-v*v),P=Math.exp(-n.y/d),W=Math.PI/2-2*Math.atan(P),he=0,ye=.1,Me;he<15&&Math.abs(ye)>1e-7;he++)Me=k*Math.sin(W),Me=Math.pow((1-Me)/(1+Me),k/2),ye=Math.PI/2-2*Math.atan(P*Me)-W,W+=ye;return new Se(W*r,n.x*r/d)}},ht={__proto__:null,LonLat:Ie,Mercator:$e,SphericalMercator:de},Qt=s({},me,{code:"EPSG:3395",projection:$e,transformation:(function(){var n=.5/(Math.PI*$e.R);return B(n,.5,-n,.5)})()}),En=s({},me,{code:"EPSG:4326",projection:Ie,transformation:B(1/180,1,-1/180,.5)}),$s=s({},se,{projection:Ie,transformation:B(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,r){var d=r.lng-n.lng,v=r.lat-n.lat;return Math.sqrt(d*d+v*v)},infinite:!0});se.Earth=me,se.EPSG3395=Qt,se.EPSG3857=U,se.EPSG900913=Q,se.EPSG4326=En,se.Simple=$s;var Vn=q.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[h(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[h(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var r=n.target;if(r.hasLayer(this)){if(this._map=r,this._zoomAnimated=r._zoomAnimated,this.getEvents){var d=this.getEvents();r.on(d,this),this.once("remove",function(){r.off(d,this)},this)}this.onAdd(r),this.fire("add"),r.fire("layeradd",{layer:this})}}});pt.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var r=h(n);return this._layers[r]?this:(this._layers[r]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var r=h(n);return this._layers[r]?(this._loaded&&n.onRemove(this),delete this._layers[r],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return h(n)in this._layers},eachLayer:function(n,r){for(var d in this._layers)n.call(r,this._layers[d]);return this},_addLayers:function(n){n=n?C(n)?n:[n]:[];for(var r=0,d=n.length;r<d;r++)this.addLayer(n[r])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[h(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var r=h(n);this._zoomBoundLayers[r]&&(delete this._zoomBoundLayers[r],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,r=-1/0,d=this._getZoomSpan();for(var v in this._zoomBoundLayers){var k=this._zoomBoundLayers[v].options;n=k.minZoom===void 0?n:Math.min(n,k.minZoom),r=k.maxZoom===void 0?r:Math.max(r,k.maxZoom)}this._layersMaxZoom=r===-1/0?void 0:r,this._layersMinZoom=n===1/0?void 0:n,d!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ri=Vn.extend({initialize:function(n,r){_(this,r),this._layers={};var d,v;if(n)for(d=0,v=n.length;d<v;d++)this.addLayer(n[d])},addLayer:function(n){var r=this.getLayerId(n);return this._layers[r]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var r=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[r]&&this._map.removeLayer(this._layers[r]),delete this._layers[r],this},hasLayer:function(n){var r=typeof n=="number"?n:this.getLayerId(n);return r in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var r=Array.prototype.slice.call(arguments,1),d,v;for(d in this._layers)v=this._layers[d],v[n]&&v[n].apply(v,r);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,r){for(var d in this._layers)n.call(r,this._layers[d]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return h(n)}}),Op=function(n,r){return new ri(n,r)},Co=ri.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),ri.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),ri.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new we;for(var r in this._layers){var d=this._layers[r];n.extend(d.getBounds?d.getBounds():d.getLatLng())}return n}}),Rp=function(n,r){return new Co(n,r)},li=He.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){_(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,r){var d=this._getIconUrl(n);if(!d){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var v=this._createImg(d,r&&r.tagName==="IMG"?r:null);return this._setIconStyles(v,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),v},_setIconStyles:function(n,r){var d=this.options,v=d[r+"Size"];typeof v=="number"&&(v=[v,v]);var k=K(v),P=K(r==="shadow"&&d.shadowAnchor||d.iconAnchor||k&&k.divideBy(2,!0));n.className="leaflet-marker-"+r+" "+(d.className||""),P&&(n.style.marginLeft=-P.x+"px",n.style.marginTop=-P.y+"px"),k&&(n.style.width=k.x+"px",n.style.height=k.y+"px")},_createImg:function(n,r){return r=r||document.createElement("img"),r.src=n,r},_getIconUrl:function(n){return qe.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function Bp(n){return new li(n)}var na=li.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof na.imagePath!="string"&&(na.imagePath=this._detectIconPath()),(this.options.imagePath||na.imagePath)+li.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var r=function(d,v,k){var P=v.exec(d);return P&&P[k]};return n=r(n,/^url\((['"])?(.+)\1\)$/,2),n&&r(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=be("div","leaflet-default-icon-path",document.body),r=le(n,"background-image")||le(n,"backgroundImage");if(document.body.removeChild(n),r=this._stripUrl(r),r)return r;var d=document.querySelector('link[href$="leaflet.css"]');return d?d.href.substring(0,d.href.length-11-1):""}}),fu=An.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new oo(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ct(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Tt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var r=this._marker,d=r._map,v=this._marker.options.autoPanSpeed,k=this._marker.options.autoPanPadding,P=yo(r._icon),W=d.getPixelBounds(),he=d.getPixelOrigin(),ye=X(W.min._subtract(he).add(k),W.max._subtract(he).subtract(k));if(!ye.contains(P)){var Me=K((Math.max(ye.max.x,P.x)-ye.max.x)/(W.max.x-ye.max.x)-(Math.min(ye.min.x,P.x)-ye.min.x)/(W.min.x-ye.min.x),(Math.max(ye.max.y,P.y)-ye.max.y)/(W.max.y-ye.max.y)-(Math.min(ye.min.y,P.y)-ye.min.y)/(W.min.y-ye.min.y)).multiplyBy(v);d.panBy(Me,{animate:!1}),this._draggable._newPos._add(Me),this._draggable._startPos._add(Me),Ot(r._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=re(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(ve(this._panRequest),this._panRequest=re(this._adjustPan.bind(this,n)))},_onDrag:function(n){var r=this._marker,d=r._shadow,v=yo(r._icon),k=r._map.layerPointToLatLng(v);d&&Ot(d,v),r._latlng=k,n.latlng=k,n.oldLatLng=this._oldLatLng,r.fire("move",n).fire("drag",n)},_onDragEnd:function(n){ve(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),sr=Vn.extend({options:{icon:new na,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,r){_(this,r),this._latlng=Ee(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var r=this._latlng;return this._latlng=Ee(n),this.update(),this.fire("move",{oldLatLng:r,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,r="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),d=n.icon.createIcon(this._icon),v=!1;d!==this._icon&&(this._icon&&this._removeIcon(),v=!0,n.title&&(d.title=n.title),d.tagName==="IMG"&&(d.alt=n.alt||"")),ct(d,r),n.keyboard&&(d.tabIndex="0",d.setAttribute("role","button")),this._icon=d,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&it(d,"focus",this._panOnFocus,this);var k=n.icon.createShadow(this._shadow),P=!1;k!==this._shadow&&(this._removeShadow(),P=!0),k&&(ct(k,r),k.alt=""),this._shadow=k,n.opacity<1&&this._updateOpacity(),v&&this.getPane().appendChild(this._icon),this._initInteraction(),k&&P&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&bt(this._icon,"focus",this._panOnFocus,this),Pe(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Pe(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&Ot(this._icon,n),this._shadow&&Ot(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var r=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(r)},_initInteraction:function(){if(this.options.interactive&&(ct(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),fu)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new fu(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&jt(this._icon,n),this._shadow&&jt(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var r=this.options.icon.options,d=r.iconSize?K(r.iconSize):K(0,0),v=r.iconAnchor?K(r.iconAnchor):K(0,0);n.panInside(this._latlng,{paddingTopLeft:v,paddingBottomRight:d.subtract(v)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Np(n,r){return new sr(n,r)}var ns=Vn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return _(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ir=ns.extend({options:{fill:!0,radius:10},initialize:function(n,r){_(this,r),this._latlng=Ee(n),this._radius=this.options.radius},setLatLng:function(n){var r=this._latlng;return this._latlng=Ee(n),this.redraw(),this.fire("move",{oldLatLng:r,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var r=n&&n.radius||this._radius;return ns.prototype.setStyle.call(this,n),this.setRadius(r),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,r=this._radiusY||n,d=this._clickTolerance(),v=[n+d,r+d];this._pxBounds=new pe(this._point.subtract(v),this._point.add(v))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Fp(n,r){return new ir(n,r)}var Dl=ir.extend({initialize:function(n,r,d){if(typeof r=="number"&&(r=s({},d,{radius:r})),_(this,r),this._latlng=Ee(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new we(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:ns.prototype.setStyle,_project:function(){var n=this._latlng.lng,r=this._latlng.lat,d=this._map,v=d.options.crs;if(v.distance===me.distance){var k=Math.PI/180,P=this._mRadius/me.R/k,W=d.project([r+P,n]),he=d.project([r-P,n]),ye=W.add(he).divideBy(2),Me=d.unproject(ye).lat,Ge=Math.acos((Math.cos(P*k)-Math.sin(r*k)*Math.sin(Me*k))/(Math.cos(r*k)*Math.cos(Me*k)))/k;(isNaN(Ge)||Ge===0)&&(Ge=P/Math.cos(Math.PI/180*r)),this._point=ye.subtract(d.getPixelOrigin()),this._radius=isNaN(Ge)?0:ye.x-d.project([Me,n-Ge]).x,this._radiusY=ye.y-W.y}else{var nt=v.unproject(v.project(this._latlng).subtract([this._mRadius,0]));this._point=d.latLngToLayerPoint(this._latlng),this._radius=this._point.x-d.latLngToLayerPoint(nt).x}this._updateBounds()}});function zp(n,r,d){return new Dl(n,r,d)}var Lo=ns.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,r){_(this,r),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var r=1/0,d=null,v=ts,k,P,W=0,he=this._parts.length;W<he;W++)for(var ye=this._parts[W],Me=1,Ge=ye.length;Me<Ge;Me++){k=ye[Me-1],P=ye[Me];var nt=v(n,k,P,!0);nt<r&&(r=nt,d=v(n,k,P))}return d&&(d.distance=Math.sqrt(r)),d},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return z(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,r){return r=r||this._defaultShape(),n=Ee(n),r.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new we,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return cn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var r=[],d=cn(n),v=0,k=n.length;v<k;v++)d?(r[v]=Ee(n[v]),this._bounds.extend(r[v])):r[v]=this._convertLatLngs(n[v]);return r},_project:function(){var n=new pe;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),r=new j(n,n);this._rawPxBounds&&(this._pxBounds=new pe([this._rawPxBounds.min.subtract(r),this._rawPxBounds.max.add(r)]))},_projectLatlngs:function(n,r,d){var v=n[0]instanceof Se,k=n.length,P,W;if(v){for(W=[],P=0;P<k;P++)W[P]=this._map.latLngToLayerPoint(n[P]),d.extend(W[P]);r.push(W)}else for(P=0;P<k;P++)this._projectLatlngs(n[P],r,d)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var r=this._parts,d,v,k,P,W,he,ye;for(d=0,k=0,P=this._rings.length;d<P;d++)for(ye=this._rings[d],v=0,W=ye.length;v<W-1;v++)he=ea(ye[v],ye[v+1],n,v,!0),he&&(r[k]=r[k]||[],r[k].push(he[0]),(he[1]!==ye[v+1]||v===W-2)&&(r[k].push(he[1]),k++))}},_simplifyPoints:function(){for(var n=this._parts,r=this.options.smoothFactor,d=0,v=n.length;d<v;d++)n[d]=nr(n[d],r)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,r){var d,v,k,P,W,he,ye=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(d=0,P=this._parts.length;d<P;d++)for(he=this._parts[d],v=0,W=he.length,k=W-1;v<W;k=v++)if(!(!r&&v===0)&&Ji(n,he[k],he[v])<=ye)return!0;return!1}});function Up(n,r){return new Lo(n,r)}Lo._flat=ta;var ci=Lo.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return er(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var r=Lo.prototype._convertLatLngs.call(this,n),d=r.length;return d>=2&&r[0]instanceof Se&&r[0].equals(r[d-1])&&r.pop(),r},_setLatLngs:function(n){Lo.prototype._setLatLngs.call(this,n),cn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return cn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,r=this.options.weight,d=new j(r,r);if(n=new pe(n.min.subtract(d),n.max.add(d)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var v=0,k=this._rings.length,P;v<k;v++)P=Qa(this._rings[v],n,!0),P.length&&this._parts.push(P)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var r=!1,d,v,k,P,W,he,ye,Me;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(P=0,ye=this._parts.length;P<ye;P++)for(d=this._parts[P],W=0,Me=d.length,he=Me-1;W<Me;he=W++)v=d[W],k=d[he],v.y>n.y!=k.y>n.y&&n.x<(k.x-v.x)*(n.y-v.y)/(k.y-v.y)+v.x&&(r=!r);return r||Lo.prototype._containsPoint.call(this,n,!0)}});function Hp(n,r){return new ci(n,r)}var So=Co.extend({initialize:function(n,r){_(this,r),this._layers={},n&&this.addData(n)},addData:function(n){var r=C(n)?n:n.features,d,v,k;if(r){for(d=0,v=r.length;d<v;d++)k=r[d],(k.geometries||k.geometry||k.features||k.coordinates)&&this.addData(k);return this}var P=this.options;if(P.filter&&!P.filter(n))return this;var W=ar(n,P);return W?(W.feature=cr(n),W.defaultOptions=W.options,this.resetStyle(W),P.onEachFeature&&P.onEachFeature(n,W),this.addLayer(W)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=s({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(r){this._setLayerStyle(r,n)},this)},_setLayerStyle:function(n,r){n.setStyle&&(typeof r=="function"&&(r=r(n.feature)),n.setStyle(r))}});function ar(n,r){var d=n.type==="Feature"?n.geometry:n,v=d?d.coordinates:null,k=[],P=r&&r.pointToLayer,W=r&&r.coordsToLatLng||Ol,he,ye,Me,Ge;if(!v&&!d)return null;switch(d.type){case"Point":return he=W(v),pu(P,n,he,r);case"MultiPoint":for(Me=0,Ge=v.length;Me<Ge;Me++)he=W(v[Me]),k.push(pu(P,n,he,r));return new Co(k);case"LineString":case"MultiLineString":return ye=rr(v,d.type==="LineString"?0:1,W),new Lo(ye,r);case"Polygon":case"MultiPolygon":return ye=rr(v,d.type==="Polygon"?1:2,W),new ci(ye,r);case"GeometryCollection":for(Me=0,Ge=d.geometries.length;Me<Ge;Me++){var nt=ar({geometry:d.geometries[Me],type:"Feature",properties:n.properties},r);nt&&k.push(nt)}return new Co(k);case"FeatureCollection":for(Me=0,Ge=d.features.length;Me<Ge;Me++){var ft=ar(d.features[Me],r);ft&&k.push(ft)}return new Co(k);default:throw new Error("Invalid GeoJSON object.")}}function pu(n,r,d,v){return n?n(r,d):new sr(d,v&&v.markersInheritOptions&&v)}function Ol(n){return new Se(n[1],n[0],n[2])}function rr(n,r,d){for(var v=[],k=0,P=n.length,W;k<P;k++)W=r?rr(n[k],r-1,d):(d||Ol)(n[k]),v.push(W);return v}function Rl(n,r){return n=Ee(n),n.alt!==void 0?[b(n.lng,r),b(n.lat,r),b(n.alt,r)]:[b(n.lng,r),b(n.lat,r)]}function lr(n,r,d,v){for(var k=[],P=0,W=n.length;P<W;P++)k.push(r?lr(n[P],cn(n[P])?0:r-1,d,v):Rl(n[P],v));return!r&&d&&k.length>0&&k.push(k[0].slice()),k}function ui(n,r){return n.feature?s({},n.feature,{geometry:r}):cr(r)}function cr(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var Bl={toGeoJSON:function(n){return ui(this,{type:"Point",coordinates:Rl(this.getLatLng(),n)})}};sr.include(Bl),Dl.include(Bl),ir.include(Bl),Lo.include({toGeoJSON:function(n){var r=!cn(this._latlngs),d=lr(this._latlngs,r?1:0,!1,n);return ui(this,{type:(r?"Multi":"")+"LineString",coordinates:d})}}),ci.include({toGeoJSON:function(n){var r=!cn(this._latlngs),d=r&&!cn(this._latlngs[0]),v=lr(this._latlngs,d?2:r?1:0,!0,n);return r||(v=[v]),ui(this,{type:(d?"Multi":"")+"Polygon",coordinates:v})}}),ri.include({toMultiPoint:function(n){var r=[];return this.eachLayer(function(d){r.push(d.toGeoJSON(n).geometry.coordinates)}),ui(this,{type:"MultiPoint",coordinates:r})},toGeoJSON:function(n){var r=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(r==="MultiPoint")return this.toMultiPoint(n);var d=r==="GeometryCollection",v=[];return this.eachLayer(function(k){if(k.toGeoJSON){var P=k.toGeoJSON(n);if(d)v.push(P.geometry);else{var W=cr(P);W.type==="FeatureCollection"?v.push.apply(v,W.features):v.push(W)}}}),d?ui(this,{geometries:v,type:"GeometryCollection"}):{type:"FeatureCollection",features:v}}});function vu(n,r){return new So(n,r)}var Vp=vu,ur=Vn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,r,d){this._url=n,this._bounds=De(r),_(this,d)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ct(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Pe(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&Ct(this._image),this},bringToBack:function(){return this._map&&Pt(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=De(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",r=this._image=n?this._url:be("img");if(ct(r,"leaflet-image-layer"),this._zoomAnimated&&ct(r,"leaflet-zoom-animated"),this.options.className&&ct(r,this.options.className),r.onselectstart=g,r.onmousemove=g,r.onload=l(this.fire,this,"load"),r.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(r.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=r.src;return}r.src=this._url,r.alt=this.options.alt},_animateZoom:function(n){var r=this._map.getZoomScale(n.zoom),d=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;go(this._image,d,r)},_reset:function(){var n=this._image,r=new pe(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),d=r.getSize();Ot(n,r.min),n.style.width=d.x+"px",n.style.height=d.y+"px"},_updateOpacity:function(){jt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),Zp=function(n,r,d){return new ur(n,r,d)},mu=ur.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",r=this._image=n?this._url:be("video");if(ct(r,"leaflet-image-layer"),this._zoomAnimated&&ct(r,"leaflet-zoom-animated"),this.options.className&&ct(r,this.options.className),r.onselectstart=g,r.onmousemove=g,r.onloadeddata=l(this.fire,this,"load"),n){for(var d=r.getElementsByTagName("source"),v=[],k=0;k<d.length;k++)v.push(d[k].src);this._url=d.length>0?v:[r.src];return}C(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(r.style,"objectFit")&&(r.style.objectFit="fill"),r.autoplay=!!this.options.autoplay,r.loop=!!this.options.loop,r.muted=!!this.options.muted,r.playsInline=!!this.options.playsInline;for(var P=0;P<this._url.length;P++){var W=be("source");W.src=this._url[P],r.appendChild(W)}}});function jp(n,r,d){return new mu(n,r,d)}var gu=ur.extend({_initImage:function(){var n=this._image=this._url;ct(n,"leaflet-image-layer"),this._zoomAnimated&&ct(n,"leaflet-zoom-animated"),this.options.className&&ct(n,this.options.className),n.onselectstart=g,n.onmousemove=g}});function Wp(n,r,d){return new gu(n,r,d)}var so=Vn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,r){n&&(n instanceof Se||C(n))?(this._latlng=Ee(n),_(this,r)):(_(this,n),this._source=r),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&jt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&jt(this._container,1),this.bringToFront(),this.options.interactive&&(ct(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(jt(this._container,0),this._removeTimeout=setTimeout(l(Pe,void 0,this._container),200)):Pe(this._container),this.options.interactive&&(Tt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=Ee(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ct(this._container),this},bringToBack:function(){return this._map&&Pt(this._container),this},_prepareOpen:function(n){var r=this._source;if(!r._map)return!1;if(r instanceof Co){r=null;var d=this._source._layers;for(var v in d)if(d[v]._map){r=d[v];break}if(!r)return!1;this._source=r}if(!n)if(r.getCenter)n=r.getCenter();else if(r.getLatLng)n=r.getLatLng();else if(r.getBounds)n=r.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,r=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof r=="string")n.innerHTML=r;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(r)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),r=K(this.options.offset),d=this._getAnchor();this._zoomAnimated?Ot(this._container,n.add(d)):r=r.add(n).add(d);var v=this._containerBottom=-r.y,k=this._containerLeft=-Math.round(this._containerWidth/2)+r.x;this._container.style.bottom=v+"px",this._container.style.left=k+"px"}},_getAnchor:function(){return[0,0]}});pt.include({_initOverlay:function(n,r,d,v){var k=r;return k instanceof n||(k=new n(v).setContent(r)),d&&k.setLatLng(d),k}}),Vn.include({_initOverlay:function(n,r,d,v){var k=d;return k instanceof n?(_(k,v),k._source=this):(k=r&&!v?r:new n(v,this),k.setContent(d)),k}});var dr=so.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,so.prototype.openOn.call(this,n)},onAdd:function(n){so.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ns||this._source.on("preclick",ko))},onRemove:function(n){so.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ns||this._source.off("preclick",ko))},getEvents:function(){var n=so.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",r=this._container=be("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),d=this._wrapper=be("div",n+"-content-wrapper",r);if(this._contentNode=be("div",n+"-content",d),xs(r),ii(this._contentNode),it(r,"contextmenu",ko),this._tipContainer=be("div",n+"-tip-container",r),this._tip=be("div",n+"-tip",this._tipContainer),this.options.closeButton){var v=this._closeButton=be("a",n+"-close-button",r);v.setAttribute("role","button"),v.setAttribute("aria-label","Close popup"),v.href="#close",v.innerHTML='<span aria-hidden="true">&#215;</span>',it(v,"click",function(k){Ut(k),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,r=n.style;r.width="",r.whiteSpace="nowrap";var d=n.offsetWidth;d=Math.min(d,this.options.maxWidth),d=Math.max(d,this.options.minWidth),r.width=d+1+"px",r.whiteSpace="",r.height="";var v=n.offsetHeight,k=this.options.maxHeight,P="leaflet-popup-scrolled";k&&v>k?(r.height=k+"px",ct(n,P)):Tt(n,P),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var r=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),d=this._getAnchor();Ot(this._container,r.add(d))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,r=parseInt(le(this._container,"marginBottom"),10)||0,d=this._container.offsetHeight+r,v=this._containerWidth,k=new j(this._containerLeft,-d-this._containerBottom);k._add(yo(this._container));var P=n.layerPointToContainerPoint(k),W=K(this.options.autoPanPadding),he=K(this.options.autoPanPaddingTopLeft||W),ye=K(this.options.autoPanPaddingBottomRight||W),Me=n.getSize(),Ge=0,nt=0;P.x+v+ye.x>Me.x&&(Ge=P.x+v-Me.x+ye.x),P.x-Ge-he.x<0&&(Ge=P.x-he.x),P.y+d+ye.y>Me.y&&(nt=P.y+d-Me.y+ye.y),P.y-nt-he.y<0&&(nt=P.y-he.y),(Ge||nt)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([Ge,nt]))}},_getAnchor:function(){return K(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),qp=function(n,r){return new dr(n,r)};pt.mergeOptions({closePopupOnClick:!0}),pt.include({openPopup:function(n,r,d){return this._initOverlay(dr,n,r,d).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),Vn.include({bindPopup:function(n,r){return this._popup=this._initOverlay(dr,this._popup,n,r),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof Co||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){bo(n);var r=n.layer||n.target;if(this._popup._source===r&&!(r instanceof ns)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=r,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var hr=so.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){so.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){so.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=so.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",r=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=be("div",r),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+h(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var r,d,v=this._map,k=this._container,P=v.latLngToContainerPoint(v.getCenter()),W=v.layerPointToContainerPoint(n),he=this.options.direction,ye=k.offsetWidth,Me=k.offsetHeight,Ge=K(this.options.offset),nt=this._getAnchor();he==="top"?(r=ye/2,d=Me):he==="bottom"?(r=ye/2,d=0):he==="center"?(r=ye/2,d=Me/2):he==="right"?(r=0,d=Me/2):he==="left"?(r=ye,d=Me/2):W.x<P.x?(he="right",r=0,d=Me/2):(he="left",r=ye+(Ge.x+nt.x)*2,d=Me/2),n=n.subtract(K(r,d,!0)).add(Ge).add(nt),Tt(k,"leaflet-tooltip-right"),Tt(k,"leaflet-tooltip-left"),Tt(k,"leaflet-tooltip-top"),Tt(k,"leaflet-tooltip-bottom"),ct(k,"leaflet-tooltip-"+he),Ot(k,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&jt(this._container,n)},_animateZoom:function(n){var r=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(r)},_getAnchor:function(){return K(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Gp=function(n,r){return new hr(n,r)};pt.include({openTooltip:function(n,r,d){return this._initOverlay(hr,n,r,d).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),Vn.include({bindTooltip:function(n,r){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(hr,this._tooltip,n,r),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var r=n?"off":"on",d={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?d.add=this._openTooltip:(d.mouseover=this._openTooltip,d.mouseout=this.closeTooltip,d.click=this._openTooltip,this._map?this._addFocusListeners():d.add=this._addFocusListeners),this._tooltip.options.sticky&&(d.mousemove=this._moveTooltip),this[r](d),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof Co||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var r=typeof n.getElement=="function"&&n.getElement();r&&(it(r,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),it(r,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var r=typeof n.getElement=="function"&&n.getElement();r&&r.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var r=this;this._map.once("moveend",function(){r._openOnceFlag=!1,r._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var r=n.latlng,d,v;this._tooltip.options.sticky&&n.originalEvent&&(d=this._map.mouseEventToContainerPoint(n.originalEvent),v=this._map.containerPointToLayerPoint(d),r=this._map.layerPointToLatLng(v)),this._tooltip.setLatLng(r)}});var yu=li.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var r=n&&n.tagName==="DIV"?n:document.createElement("div"),d=this.options;if(d.html instanceof Element?(st(r),r.appendChild(d.html)):r.innerHTML=d.html!==!1?d.html:"",d.bgPos){var v=K(d.bgPos);r.style.backgroundPosition=-v.x+"px "+-v.y+"px"}return this._setIconStyles(r,"icon"),r},createShadow:function(){return null}});function Kp(n){return new yu(n)}li.Default=na;var oa=Vn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:qe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){_(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),Pe(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ct(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Pt(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof j?n:new j(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var r=this.getPane().children,d=-n(-1/0,1/0),v=0,k=r.length,P;v<k;v++)P=r[v].style.zIndex,r[v]!==this._container&&P&&(d=n(d,+P));isFinite(d)&&(this.options.zIndex=d+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!qe.ielt9){jt(this._container,this.options.opacity);var n=+new Date,r=!1,d=!1;for(var v in this._tiles){var k=this._tiles[v];if(!(!k.current||!k.loaded)){var P=Math.min(1,(n-k.loaded)/200);jt(k.el,P),P<1?r=!0:(k.active?d=!0:this._onOpaqueTile(k),k.active=!0)}}d&&!this._noPrune&&this._pruneTiles(),r&&(ve(this._fadeFrame),this._fadeFrame=re(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=be("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,r=this.options.maxZoom;if(n!==void 0){for(var d in this._levels)d=Number(d),this._levels[d].el.children.length||d===n?(this._levels[d].el.style.zIndex=r-Math.abs(n-d),this._onUpdateLevel(d)):(Pe(this._levels[d].el),this._removeTilesAtZoom(d),this._onRemoveLevel(d),delete this._levels[d]);var v=this._levels[n],k=this._map;return v||(v=this._levels[n]={},v.el=be("div","leaflet-tile-container leaflet-zoom-animated",this._container),v.el.style.zIndex=r,v.origin=k.project(k.unproject(k.getPixelOrigin()),n).round(),v.zoom=n,this._setZoomTransform(v,k.getCenter(),k.getZoom()),g(v.el.offsetWidth),this._onCreateLevel(v)),this._level=v,v}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var n,r,d=this._map.getZoom();if(d>this.options.maxZoom||d<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)r=this._tiles[n],r.retain=r.current;for(n in this._tiles)if(r=this._tiles[n],r.current&&!r.active){var v=r.coords;this._retainParent(v.x,v.y,v.z,v.z-5)||this._retainChildren(v.x,v.y,v.z,v.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var r in this._tiles)this._tiles[r].coords.z===n&&this._removeTile(r)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)Pe(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,r,d,v){var k=Math.floor(n/2),P=Math.floor(r/2),W=d-1,he=new j(+k,+P);he.z=+W;var ye=this._tileCoordsToKey(he),Me=this._tiles[ye];return Me&&Me.active?(Me.retain=!0,!0):(Me&&Me.loaded&&(Me.retain=!0),W>v?this._retainParent(k,P,W,v):!1)},_retainChildren:function(n,r,d,v){for(var k=2*n;k<2*n+2;k++)for(var P=2*r;P<2*r+2;P++){var W=new j(k,P);W.z=d+1;var he=this._tileCoordsToKey(W),ye=this._tiles[he];if(ye&&ye.active){ye.retain=!0;continue}else ye&&ye.loaded&&(ye.retain=!0);d+1<v&&this._retainChildren(k,P,d+1,v)}},_resetView:function(n){var r=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),r,r)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var r=this.options;return r.minNativeZoom!==void 0&&n<r.minNativeZoom?r.minNativeZoom:r.maxNativeZoom!==void 0&&r.maxNativeZoom<n?r.maxNativeZoom:n},_setView:function(n,r,d,v){var k=Math.round(r);this.options.maxZoom!==void 0&&k>this.options.maxZoom||this.options.minZoom!==void 0&&k<this.options.minZoom?k=void 0:k=this._clampZoom(k);var P=this.options.updateWhenZooming&&k!==this._tileZoom;(!v||P)&&(this._tileZoom=k,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),k!==void 0&&this._update(n),d||this._pruneTiles(),this._noPrune=!!d),this._setZoomTransforms(n,r)},_setZoomTransforms:function(n,r){for(var d in this._levels)this._setZoomTransform(this._levels[d],n,r)},_setZoomTransform:function(n,r,d){var v=this._map.getZoomScale(d,n.zoom),k=n.origin.multiplyBy(v).subtract(this._map._getNewPixelOrigin(r,d)).round();qe.any3d?go(n.el,k,v):Ot(n.el,k)},_resetGrid:function(){var n=this._map,r=n.options.crs,d=this._tileSize=this.getTileSize(),v=this._tileZoom,k=this._map.getPixelWorldBounds(this._tileZoom);k&&(this._globalTileRange=this._pxBoundsToTileRange(k)),this._wrapX=r.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,r.wrapLng[0]],v).x/d.x),Math.ceil(n.project([0,r.wrapLng[1]],v).x/d.y)],this._wrapY=r.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([r.wrapLat[0],0],v).y/d.x),Math.ceil(n.project([r.wrapLat[1],0],v).y/d.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var r=this._map,d=r._animatingZoom?Math.max(r._animateToZoom,r.getZoom()):r.getZoom(),v=r.getZoomScale(d,this._tileZoom),k=r.project(n,this._tileZoom).floor(),P=r.getSize().divideBy(v*2);return new pe(k.subtract(P),k.add(P))},_update:function(n){var r=this._map;if(r){var d=this._clampZoom(r.getZoom());if(n===void 0&&(n=r.getCenter()),this._tileZoom!==void 0){var v=this._getTiledPixelBounds(n),k=this._pxBoundsToTileRange(v),P=k.getCenter(),W=[],he=this.options.keepBuffer,ye=new pe(k.getBottomLeft().subtract([he,-he]),k.getTopRight().add([he,-he]));if(!(isFinite(k.min.x)&&isFinite(k.min.y)&&isFinite(k.max.x)&&isFinite(k.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Me in this._tiles){var Ge=this._tiles[Me].coords;(Ge.z!==this._tileZoom||!ye.contains(new j(Ge.x,Ge.y)))&&(this._tiles[Me].current=!1)}if(Math.abs(d-this._tileZoom)>1){this._setView(n,d);return}for(var nt=k.min.y;nt<=k.max.y;nt++)for(var ft=k.min.x;ft<=k.max.x;ft++){var un=new j(ft,nt);if(un.z=this._tileZoom,!!this._isValidTile(un)){var Wt=this._tiles[this._tileCoordsToKey(un)];Wt?Wt.current=!0:W.push(un)}}if(W.sort(function(mn,hi){return mn.distanceTo(P)-hi.distanceTo(P)}),W.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Pn=document.createDocumentFragment();for(ft=0;ft<W.length;ft++)this._addTile(W[ft],Pn);this._level.el.appendChild(Pn)}}}},_isValidTile:function(n){var r=this._map.options.crs;if(!r.infinite){var d=this._globalTileRange;if(!r.wrapLng&&(n.x<d.min.x||n.x>d.max.x)||!r.wrapLat&&(n.y<d.min.y||n.y>d.max.y))return!1}if(!this.options.bounds)return!0;var v=this._tileCoordsToBounds(n);return De(this.options.bounds).overlaps(v)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var r=this._map,d=this.getTileSize(),v=n.scaleBy(d),k=v.add(d),P=r.unproject(v,n.z),W=r.unproject(k,n.z);return[P,W]},_tileCoordsToBounds:function(n){var r=this._tileCoordsToNwSe(n),d=new we(r[0],r[1]);return this.options.noWrap||(d=this._map.wrapLatLngBounds(d)),d},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var r=n.split(":"),d=new j(+r[0],+r[1]);return d.z=+r[2],d},_removeTile:function(n){var r=this._tiles[n];r&&(Pe(r.el),delete this._tiles[n],this.fire("tileunload",{tile:r.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){ct(n,"leaflet-tile");var r=this.getTileSize();n.style.width=r.x+"px",n.style.height=r.y+"px",n.onselectstart=g,n.onmousemove=g,qe.ielt9&&this.options.opacity<1&&jt(n,this.options.opacity)},_addTile:function(n,r){var d=this._getTilePos(n),v=this._tileCoordsToKey(n),k=this.createTile(this._wrapCoords(n),l(this._tileReady,this,n));this._initTile(k),this.createTile.length<2&&re(l(this._tileReady,this,n,null,k)),Ot(k,d),this._tiles[v]={el:k,coords:n,current:!0},r.appendChild(k),this.fire("tileloadstart",{tile:k,coords:n})},_tileReady:function(n,r,d){r&&this.fire("tileerror",{error:r,tile:d,coords:n});var v=this._tileCoordsToKey(n);d=this._tiles[v],d&&(d.loaded=+new Date,this._map._fadeAnimated?(jt(d.el,0),ve(this._fadeFrame),this._fadeFrame=re(this._updateOpacity,this)):(d.active=!0,this._pruneTiles()),r||(ct(d.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:d.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),qe.ielt9||!this._map._fadeAnimated?re(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var r=new j(this._wrapX?p(n.x,this._wrapX):n.x,this._wrapY?p(n.y,this._wrapY):n.y);return r.z=n.z,r},_pxBoundsToTileRange:function(n){var r=this.getTileSize();return new pe(n.min.unscaleBy(r).floor(),n.max.unscaleBy(r).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function Yp(n){return new oa(n)}var di=oa.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,r){this._url=n,r=_(this,r),r.detectRetina&&qe.retina&&r.maxZoom>0?(r.tileSize=Math.floor(r.tileSize/2),r.zoomReverse?(r.zoomOffset--,r.minZoom=Math.min(r.maxZoom,r.minZoom+1)):(r.zoomOffset++,r.maxZoom=Math.max(r.minZoom,r.maxZoom-1)),r.minZoom=Math.max(0,r.minZoom)):r.zoomReverse?r.minZoom=Math.min(r.maxZoom,r.minZoom):r.maxZoom=Math.max(r.minZoom,r.maxZoom),typeof r.subdomains=="string"&&(r.subdomains=r.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,r){return this._url===n&&r===void 0&&(r=!0),this._url=n,r||this.redraw(),this},createTile:function(n,r){var d=document.createElement("img");return it(d,"load",l(this._tileOnLoad,this,r,d)),it(d,"error",l(this._tileOnError,this,r,d)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(d.referrerPolicy=this.options.referrerPolicy),d.alt="",d.src=this.getTileUrl(n),d},getTileUrl:function(n){var r={r:qe.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var d=this._globalTileRange.max.y-n.y;this.options.tms&&(r.y=d),r["-y"]=d}return x(this._url,s(r,this.options))},_tileOnLoad:function(n,r){qe.ielt9?setTimeout(l(n,this,null,r),0):n(null,r)},_tileOnError:function(n,r,d){var v=this.options.errorTileUrl;v&&r.getAttribute("src")!==v&&(r.src=v),n(d,r)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,r=this.options.maxZoom,d=this.options.zoomReverse,v=this.options.zoomOffset;return d&&(n=r-n),n+v},_getSubdomain:function(n){var r=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[r]},_abortLoading:function(){var n,r;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(r=this._tiles[n].el,r.onload=g,r.onerror=g,!r.complete)){r.src=I;var d=this._tiles[n].coords;Pe(r),delete this._tiles[n],this.fire("tileabort",{tile:r,coords:d})}},_removeTile:function(n){var r=this._tiles[n];if(r)return r.el.setAttribute("src",I),oa.prototype._removeTile.call(this,n)},_tileReady:function(n,r,d){if(!(!this._map||d&&d.getAttribute("src")===I))return oa.prototype._tileReady.call(this,n,r,d)}});function _u(n,r){return new di(n,r)}var ku=di.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,r){this._url=n;var d=s({},this.defaultWmsParams);for(var v in r)v in this.options||(d[v]=r[v]);r=_(this,r);var k=r.detectRetina&&qe.retina?2:1,P=this.getTileSize();d.width=P.x*k,d.height=P.y*k,this.wmsParams=d},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var r=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[r]=this._crs.code,di.prototype.onAdd.call(this,n)},getTileUrl:function(n){var r=this._tileCoordsToNwSe(n),d=this._crs,v=X(d.project(r[0]),d.project(r[1])),k=v.min,P=v.max,W=(this._wmsVersion>=1.3&&this._crs===En?[k.y,k.x,P.y,P.x]:[k.x,k.y,P.x,P.y]).join(","),he=di.prototype.getTileUrl.call(this,n);return he+D(this.wmsParams,he,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+W},setParams:function(n,r){return s(this.wmsParams,n),r||this.redraw(),this}});function Jp(n,r){return new ku(n,r)}di.WMS=ku,_u.wms=Jp;var xo=Vn.extend({options:{padding:.1},initialize:function(n){_(this,n),h(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ct(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,r){var d=this._map.getZoomScale(r,this._zoom),v=this._map.getSize().multiplyBy(.5+this.options.padding),k=this._map.project(this._center,r),P=v.multiplyBy(-d).add(k).subtract(this._map._getNewPixelOrigin(n,r));qe.any3d?go(this._container,P,d):Ot(this._container,P)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,r=this._map.getSize(),d=this._map.containerPointToLayerPoint(r.multiplyBy(-n)).round();this._bounds=new pe(d,d.add(r.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),bu=xo.extend({options:{tolerance:0},getEvents:function(){var n=xo.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){xo.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");it(n,"mousemove",this._onMouseMove,this),it(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),it(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){ve(this._redrawRequest),delete this._ctx,Pe(this._container),bt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var r in this._layers)n=this._layers[r],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){xo.prototype._update.call(this);var n=this._bounds,r=this._container,d=n.getSize(),v=qe.retina?2:1;Ot(r,n.min),r.width=v*d.x,r.height=v*d.y,r.style.width=d.x+"px",r.style.height=d.y+"px",qe.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){xo.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[h(n)]=n;var r=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=r),this._drawLast=r,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var r=n._order,d=r.next,v=r.prev;d?d.prev=v:this._drawLast=v,v?v.next=d:this._drawFirst=d,delete n._order,delete this._layers[h(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var r=n.options.dashArray.split(/[, ]+/),d=[],v,k;for(k=0;k<r.length;k++){if(v=Number(r[k]),isNaN(v))return;d.push(v)}n.options._dashArray=d}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||re(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var r=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new pe,this._redrawBounds.extend(n._pxBounds.min.subtract([r,r])),this._redrawBounds.extend(n._pxBounds.max.add([r,r]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var r=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,r.x,r.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,r=this._redrawBounds;if(this._ctx.save(),r){var d=r.getSize();this._ctx.beginPath(),this._ctx.rect(r.min.x,r.min.y,d.x,d.y),this._ctx.clip()}this._drawing=!0;for(var v=this._drawFirst;v;v=v.next)n=v.layer,(!r||n._pxBounds&&n._pxBounds.intersects(r))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,r){if(this._drawing){var d,v,k,P,W=n._parts,he=W.length,ye=this._ctx;if(he){for(ye.beginPath(),d=0;d<he;d++){for(v=0,k=W[d].length;v<k;v++)P=W[d][v],ye[v?"lineTo":"moveTo"](P.x,P.y);r&&ye.closePath()}this._fillStroke(ye,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var r=n._point,d=this._ctx,v=Math.max(Math.round(n._radius),1),k=(Math.max(Math.round(n._radiusY),1)||v)/v;k!==1&&(d.save(),d.scale(1,k)),d.beginPath(),d.arc(r.x,r.y/k,v,0,Math.PI*2,!1),k!==1&&d.restore(),this._fillStroke(d,n)}},_fillStroke:function(n,r){var d=r.options;d.fill&&(n.globalAlpha=d.fillOpacity,n.fillStyle=d.fillColor||d.color,n.fill(d.fillRule||"evenodd")),d.stroke&&d.weight!==0&&(n.setLineDash&&n.setLineDash(r.options&&r.options._dashArray||[]),n.globalAlpha=d.opacity,n.lineWidth=d.weight,n.strokeStyle=d.color,n.lineCap=d.lineCap,n.lineJoin=d.lineJoin,n.stroke())},_onClick:function(n){for(var r=this._map.mouseEventToLayerPoint(n),d,v,k=this._drawFirst;k;k=k.next)d=k.layer,d.options.interactive&&d._containsPoint(r)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(d))&&(v=d);this._fireEvent(v?[v]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var r=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,r)}},_handleMouseOut:function(n){var r=this._hoveredLayer;r&&(Tt(this._container,"leaflet-interactive"),this._fireEvent([r],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,r){if(!this._mouseHoverThrottled){for(var d,v,k=this._drawFirst;k;k=k.next)d=k.layer,d.options.interactive&&d._containsPoint(r)&&(v=d);v!==this._hoveredLayer&&(this._handleMouseOut(n),v&&(ct(this._container,"leaflet-interactive"),this._fireEvent([v],n,"mouseover"),this._hoveredLayer=v)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,r,d){this._map._fireDOMEvent(r,d||r.type,n)},_bringToFront:function(n){var r=n._order;if(r){var d=r.next,v=r.prev;if(d)d.prev=v;else return;v?v.next=d:d&&(this._drawFirst=d),r.prev=this._drawLast,this._drawLast.next=r,r.next=null,this._drawLast=r,this._requestRedraw(n)}},_bringToBack:function(n){var r=n._order;if(r){var d=r.next,v=r.prev;if(v)v.next=d;else return;d?d.prev=v:v&&(this._drawLast=v),r.prev=null,r.next=this._drawFirst,this._drawFirst.prev=r,this._drawFirst=r,this._requestRedraw(n)}}});function wu(n){return qe.canvas?new bu(n):null}var sa=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Xp={_initContainer:function(){this._container=be("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(xo.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var r=n._container=sa("shape");ct(r,"leaflet-vml-shape "+(this.options.className||"")),r.coordsize="1 1",n._path=sa("path"),r.appendChild(n._path),this._updateStyle(n),this._layers[h(n)]=n},_addPath:function(n){var r=n._container;this._container.appendChild(r),n.options.interactive&&n.addInteractiveTarget(r)},_removePath:function(n){var r=n._container;Pe(r),n.removeInteractiveTarget(r),delete this._layers[h(n)]},_updateStyle:function(n){var r=n._stroke,d=n._fill,v=n.options,k=n._container;k.stroked=!!v.stroke,k.filled=!!v.fill,v.stroke?(r||(r=n._stroke=sa("stroke")),k.appendChild(r),r.weight=v.weight+"px",r.color=v.color,r.opacity=v.opacity,v.dashArray?r.dashStyle=C(v.dashArray)?v.dashArray.join(" "):v.dashArray.replace(/( *, *)/g," "):r.dashStyle="",r.endcap=v.lineCap.replace("butt","flat"),r.joinstyle=v.lineJoin):r&&(k.removeChild(r),n._stroke=null),v.fill?(d||(d=n._fill=sa("fill")),k.appendChild(d),d.color=v.fillColor||v.color,d.opacity=v.fillOpacity):d&&(k.removeChild(d),n._fill=null)},_updateCircle:function(n){var r=n._point.round(),d=Math.round(n._radius),v=Math.round(n._radiusY||d);this._setPath(n,n._empty()?"M0 0":"AL "+r.x+","+r.y+" "+d+","+v+" 0,"+65535*360)},_setPath:function(n,r){n._path.v=r},_bringToFront:function(n){Ct(n._container)},_bringToBack:function(n){Pt(n._container)}},fr=qe.vml?sa:Z,ia=xo.extend({_initContainer:function(){this._container=fr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=fr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Pe(this._container),bt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){xo.prototype._update.call(this);var n=this._bounds,r=n.getSize(),d=this._container;(!this._svgSize||!this._svgSize.equals(r))&&(this._svgSize=r,d.setAttribute("width",r.x),d.setAttribute("height",r.y)),Ot(d,n.min),d.setAttribute("viewBox",[n.min.x,n.min.y,r.x,r.y].join(" ")),this.fire("update")}},_initPath:function(n){var r=n._path=fr("path");n.options.className&&ct(r,n.options.className),n.options.interactive&&ct(r,"leaflet-interactive"),this._updateStyle(n),this._layers[h(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){Pe(n._path),n.removeInteractiveTarget(n._path),delete this._layers[h(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var r=n._path,d=n.options;r&&(d.stroke?(r.setAttribute("stroke",d.color),r.setAttribute("stroke-opacity",d.opacity),r.setAttribute("stroke-width",d.weight),r.setAttribute("stroke-linecap",d.lineCap),r.setAttribute("stroke-linejoin",d.lineJoin),d.dashArray?r.setAttribute("stroke-dasharray",d.dashArray):r.removeAttribute("stroke-dasharray"),d.dashOffset?r.setAttribute("stroke-dashoffset",d.dashOffset):r.removeAttribute("stroke-dashoffset")):r.setAttribute("stroke","none"),d.fill?(r.setAttribute("fill",d.fillColor||d.color),r.setAttribute("fill-opacity",d.fillOpacity),r.setAttribute("fill-rule",d.fillRule||"evenodd")):r.setAttribute("fill","none"))},_updatePoly:function(n,r){this._setPath(n,N(n._parts,r))},_updateCircle:function(n){var r=n._point,d=Math.max(Math.round(n._radius),1),v=Math.max(Math.round(n._radiusY),1)||d,k="a"+d+","+v+" 0 1,0 ",P=n._empty()?"M0 0":"M"+(r.x-d)+","+r.y+k+d*2+",0 "+k+-d*2+",0 ";this._setPath(n,P)},_setPath:function(n,r){n._path.setAttribute("d",r)},_bringToFront:function(n){Ct(n._path)},_bringToBack:function(n){Pt(n._path)}});qe.vml&&ia.include(Xp);function Cu(n){return qe.svg||qe.vml?new ia(n):null}pt.include({getRenderer:function(n){var r=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return r||(r=this._renderer=this._createRenderer()),this.hasLayer(r)||this.addLayer(r),r},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var r=this._paneRenderers[n];return r===void 0&&(r=this._createRenderer({pane:n}),this._paneRenderers[n]=r),r},_createRenderer:function(n){return this.options.preferCanvas&&wu(n)||Cu(n)}});var Lu=ci.extend({initialize:function(n,r){ci.prototype.initialize.call(this,this._boundsToLatLngs(n),r)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=De(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function Qp(n,r){return new Lu(n,r)}ia.create=fr,ia.pointsToPath=N,So.geometryToLayer=ar,So.coordsToLatLng=Ol,So.coordsToLatLngs=rr,So.latLngToCoords=Rl,So.latLngsToCoords=lr,So.getFeature=ui,So.asFeature=cr,pt.mergeOptions({boxZoom:!0});var Su=An.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){it(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){bt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Pe(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Cs(),Fi(),this._startPoint=this._map.mouseEventToContainerPoint(n),it(document,{contextmenu:bo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=be("div","leaflet-zoom-box",this._container),ct(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var r=new pe(this._point,this._startPoint),d=r.getSize();Ot(this._box,r.min),this._box.style.width=d.x+"px",this._box.style.height=d.y+"px"},_finish:function(){this._moved&&(Pe(this._box),Tt(this._container,"leaflet-crosshair")),_o(),zi(),bt(document,{contextmenu:bo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var r=new we(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(r).fire("boxzoomend",{boxZoomBounds:r})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});pt.addInitHook("addHandler","boxZoom",Su),pt.mergeOptions({doubleClickZoom:!0});var xu=An.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var r=this._map,d=r.getZoom(),v=r.options.zoomDelta,k=n.originalEvent.shiftKey?d-v:d+v;r.options.doubleClickZoom==="center"?r.setZoom(k):r.setZoomAround(n.containerPoint,k)}});pt.addInitHook("addHandler","doubleClickZoom",xu),pt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Tu=An.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new oo(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}ct(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Tt(this._map._container,"leaflet-grab"),Tt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var r=De(this._map.options.maxBounds);this._offsetLimit=X(this._map.latLngToContainerPoint(r.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(r.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var r=this._lastTime=+new Date,d=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(d),this._times.push(r),this._prunePositions(r)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),r=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=r.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,r){return n-(n-r)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),r=this._offsetLimit;n.x<r.min.x&&(n.x=this._viscousLimit(n.x,r.min.x)),n.y<r.min.y&&(n.y=this._viscousLimit(n.y,r.min.y)),n.x>r.max.x&&(n.x=this._viscousLimit(n.x,r.max.x)),n.y>r.max.y&&(n.y=this._viscousLimit(n.y,r.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,r=Math.round(n/2),d=this._initialWorldOffset,v=this._draggable._newPos.x,k=(v-r+d)%n+r-d,P=(v+r+d)%n-r-d,W=Math.abs(k+d)<Math.abs(P+d)?k:P;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=W},_onDragEnd:function(n){var r=this._map,d=r.options,v=!d.inertia||n.noInertia||this._times.length<2;if(r.fire("dragend",n),v)r.fire("moveend");else{this._prunePositions(+new Date);var k=this._lastPos.subtract(this._positions[0]),P=(this._lastTime-this._times[0])/1e3,W=d.easeLinearity,he=k.multiplyBy(W/P),ye=he.distanceTo([0,0]),Me=Math.min(d.inertiaMaxSpeed,ye),Ge=he.multiplyBy(Me/ye),nt=Me/(d.inertiaDeceleration*W),ft=Ge.multiplyBy(-nt/2).round();!ft.x&&!ft.y?r.fire("moveend"):(ft=r._limitOffset(ft,r.options.maxBounds),re(function(){r.panBy(ft,{duration:nt,easeLinearity:W,noMoveStart:!0,animate:!0})}))}}});pt.addInitHook("addHandler","dragging",Tu),pt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Iu=An.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),it(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),bt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,r=document.documentElement,d=n.scrollTop||r.scrollTop,v=n.scrollLeft||r.scrollLeft;this._map._container.focus(),window.scrollTo(v,d)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var r=this._panKeys={},d=this.keyCodes,v,k;for(v=0,k=d.left.length;v<k;v++)r[d.left[v]]=[-1*n,0];for(v=0,k=d.right.length;v<k;v++)r[d.right[v]]=[n,0];for(v=0,k=d.down.length;v<k;v++)r[d.down[v]]=[0,n];for(v=0,k=d.up.length;v<k;v++)r[d.up[v]]=[0,-1*n]},_setZoomDelta:function(n){var r=this._zoomKeys={},d=this.keyCodes,v,k;for(v=0,k=d.zoomIn.length;v<k;v++)r[d.zoomIn[v]]=n;for(v=0,k=d.zoomOut.length;v<k;v++)r[d.zoomOut[v]]=-n},_addHooks:function(){it(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){bt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var r=n.keyCode,d=this._map,v;if(r in this._panKeys){if(!d._panAnim||!d._panAnim._inProgress)if(v=this._panKeys[r],n.shiftKey&&(v=K(v).multiplyBy(3)),d.options.maxBounds&&(v=d._limitOffset(K(v),d.options.maxBounds)),d.options.worldCopyJump){var k=d.wrapLatLng(d.unproject(d.project(d.getCenter()).add(v)));d.panTo(k)}else d.panBy(v)}else if(r in this._zoomKeys)d.setZoom(d.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[r]);else if(r===27&&d._popup&&d._popup.options.closeOnEscapeKey)d.closePopup();else return;bo(n)}}});pt.addInitHook("addHandler","keyboard",Iu),pt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var $u=An.extend({addHooks:function(){it(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){bt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var r=Ya(n),d=this._map.options.wheelDebounceTime;this._delta+=r,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var v=Math.max(d-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),v),bo(n)},_performZoom:function(){var n=this._map,r=n.getZoom(),d=this._map.options.zoomSnap||0;n._stop();var v=this._delta/(this._map.options.wheelPxPerZoomLevel*4),k=4*Math.log(2/(1+Math.exp(-Math.abs(v))))/Math.LN2,P=d?Math.ceil(k/d)*d:k,W=n._limitZoom(r+(this._delta>0?P:-P))-r;this._delta=0,this._startTime=null,W&&(n.options.scrollWheelZoom==="center"?n.setZoom(r+W):n.setZoomAround(this._lastMousePos,r+W))}});pt.addInitHook("addHandler","scrollWheelZoom",$u);var ev=600;pt.mergeOptions({tapHold:qe.touchNative&&qe.safari&&qe.mobile,tapTolerance:15});var Mu=An.extend({addHooks:function(){it(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){bt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var r=n.touches[0];this._startPos=this._newPos=new j(r.clientX,r.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(it(document,"touchend",Ut),it(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",r))},this),ev),it(document,"touchend touchcancel contextmenu",this._cancel,this),it(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){bt(document,"touchend",Ut),bt(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),bt(document,"touchend touchcancel contextmenu",this._cancel,this),bt(document,"touchmove",this._onMove,this)},_onMove:function(n){var r=n.touches[0];this._newPos=new j(r.clientX,r.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,r){var d=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:r.screenX,screenY:r.screenY,clientX:r.clientX,clientY:r.clientY});d._simulated=!0,r.target.dispatchEvent(d)}});pt.addInitHook("addHandler","tapHold",Mu),pt.mergeOptions({touchZoom:qe.touch,bounceAtZoomLimits:!0});var Au=An.extend({addHooks:function(){ct(this._map._container,"leaflet-touch-zoom"),it(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Tt(this._map._container,"leaflet-touch-zoom"),bt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var r=this._map;if(!(!n.touches||n.touches.length!==2||r._animatingZoom||this._zooming)){var d=r.mouseEventToContainerPoint(n.touches[0]),v=r.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=r.getSize()._divideBy(2),this._startLatLng=r.containerPointToLatLng(this._centerPoint),r.options.touchZoom!=="center"&&(this._pinchStartLatLng=r.containerPointToLatLng(d.add(v)._divideBy(2))),this._startDist=d.distanceTo(v),this._startZoom=r.getZoom(),this._moved=!1,this._zooming=!0,r._stop(),it(document,"touchmove",this._onTouchMove,this),it(document,"touchend touchcancel",this._onTouchEnd,this),Ut(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var r=this._map,d=r.mouseEventToContainerPoint(n.touches[0]),v=r.mouseEventToContainerPoint(n.touches[1]),k=d.distanceTo(v)/this._startDist;if(this._zoom=r.getScaleZoom(k,this._startZoom),!r.options.bounceAtZoomLimits&&(this._zoom<r.getMinZoom()&&k<1||this._zoom>r.getMaxZoom()&&k>1)&&(this._zoom=r._limitZoom(this._zoom)),r.options.touchZoom==="center"){if(this._center=this._startLatLng,k===1)return}else{var P=d._add(v)._divideBy(2)._subtract(this._centerPoint);if(k===1&&P.x===0&&P.y===0)return;this._center=r.unproject(r.project(this._pinchStartLatLng,this._zoom).subtract(P),this._zoom)}this._moved||(r._moveStart(!0,!1),this._moved=!0),ve(this._animRequest);var W=l(r._move,r,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=re(W,this,!0),Ut(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,ve(this._animRequest),bt(document,"touchmove",this._onTouchMove,this),bt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});pt.addInitHook("addHandler","touchZoom",Au),pt.BoxZoom=Su,pt.DoubleClickZoom=xu,pt.Drag=Tu,pt.Keyboard=Iu,pt.ScrollWheelZoom=$u,pt.TapHold=Mu,pt.TouchZoom=Au,o.Bounds=pe,o.Browser=qe,o.CRS=se,o.Canvas=bu,o.Circle=Dl,o.CircleMarker=ir,o.Class=He,o.Control=Ln,o.DivIcon=yu,o.DivOverlay=so,o.DomEvent=xl,o.DomUtil=Ll,o.Draggable=oo,o.Evented=q,o.FeatureGroup=Co,o.GeoJSON=So,o.GridLayer=oa,o.Handler=An,o.Icon=li,o.ImageOverlay=ur,o.LatLng=Se,o.LatLngBounds=we,o.Layer=Vn,o.LayerGroup=ri,o.LineUtil=oe,o.Map=pt,o.Marker=sr,o.Mixin=Al,o.Path=ns,o.Point=j,o.PolyUtil=tr,o.Polygon=ci,o.Polyline=Lo,o.Popup=dr,o.PosAnimation=Ja,o.Projection=ht,o.Rectangle=Lu,o.Renderer=xo,o.SVG=ia,o.SVGOverlay=gu,o.TileLayer=di,o.Tooltip=hr,o.Transformation=Le,o.Util=Be,o.VideoOverlay=mu,o.bind=l,o.bounds=X,o.canvas=wu,o.circle=zp,o.circleMarker=Fp,o.control=Ts,o.divIcon=Kp,o.extend=s,o.featureGroup=Rp,o.geoJSON=vu,o.geoJson=Vp,o.gridLayer=Yp,o.icon=Bp,o.imageOverlay=Zp,o.latLng=Ee,o.latLngBounds=De,o.layerGroup=Op,o.map=Tl,o.marker=Np,o.point=K,o.polygon=Hp,o.polyline=Up,o.popup=qp,o.rectangle=Qp,o.setOptions=_,o.stamp=h,o.svg=Cu,o.svgOverlay=Wp,o.tileLayer=_u,o.tooltip=Gp,o.transformation=B,o.version=i,o.videoOverlay=jp;var tv=window.L;o.noConflict=function(){return window.L=tv,this},window.L=o}))})(va,va.exports)),va.exports}var Db=Pb();const dn=Ab(Db);(function(e,t,o){function i(s,a){for(;(s=s.parentElement)&&!s.classList.contains(a););return s}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(s,a){this._map=s,this._container=s._container,this._overlayPane=s._panes.overlayPane,this._popupPane=s._panes.popupPane,a&&a.shapeOptions&&(a.shapeOptions=L.Util.extend({},this.options.shapeOptions,a.shapeOptions)),L.setOptions(this,a);var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(L.DomUtil.disableTextSelection(),s.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(s){L.setOptions(this,s)},_fireCreatedEvent:function(s){this._map.fire(L.Draw.Event.CREATED,{layer:s,layerType:this.type})},_cancelDrawing:function(s){s.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(s,a){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,a&&a.drawError&&(a.drawError=L.Util.extend({},this.options.drawError,a.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var s=this._markers.pop(),a=this._poly,l=a.getLatLngs(),u=l.splice(-1,1)[0];this._poly.setLatLngs(l),this._markerGroup.removeLayer(s),a.getLatLngs().length<2&&this._map.removeLayer(a),this._vertexChanged(u,!1)}},addVertex:function(s){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(s))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(s)),this._poly.addLatLng(s),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(s,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var s=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),a=this._poly.newLatLngIntersects(s[s.length-1]);if(!this.options.allowIntersection&&a||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent),l=this._map.layerPointToLatLng(a);this._currentLatLng=l,this._updateTooltip(l),this._updateGuide(a),this._mouseMarker.setLatLng(l),L.DomEvent.preventDefault(s.originalEvent)},_vertexChanged:function(s,a){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(s,a),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(s){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(s),this._clickHandled=!0,this._disableNewMarkers();var a=s.originalEvent,l=a.clientX,u=a.clientY;this._startPoint.call(this,l,u)}},_startPoint:function(s,a){this._mouseDownOrigin=L.point(s,a)},_onMouseUp:function(s){var a=s.originalEvent,l=a.clientX,u=a.clientY;this._endPoint.call(this,l,u,s),this._clickHandled=null},_endPoint:function(s,a,l){if(this._mouseDownOrigin){var u=L.point(s,a).distanceTo(this._mouseDownOrigin),h=this._calculateFinishDistance(l.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(l.latlng),this._finishShape()):h<10&&L.Browser.touch?this._finishShape():Math.abs(u)<9*(e.devicePixelRatio||1)&&this.addVertex(l.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(s){var a,l,u=s.originalEvent;!u.touches||!u.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(a=u.touches[0].clientX,l=u.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,a,l),this._endPoint.call(this,a,l,s),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(s){var a;if(this._markers.length>0){var l;if(this.type===L.Draw.Polyline.TYPE)l=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;l=this._markers[0]}var u=this._map.latLngToContainerPoint(l.getLatLng()),h=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),f=this._map.latLngToContainerPoint(h.getLatLng());a=u.distanceTo(f)}else a=1/0;return a},_updateFinishHandler:function(){var s=this._markers.length;s>1&&this._markers[s-1].on("click",this._finishShape,this),s>2&&this._markers[s-2].off("click",this._finishShape,this)},_createMarker:function(s){var a=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(a),a},_updateGuide:function(s){var a=this._markers?this._markers.length:0;a>0&&(s=s||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[a-1].getLatLng()),s))},_updateTooltip:function(s){var a=this._getTooltipText();s&&this._tooltip.updatePosition(s),this._errorShown||this._tooltip.updateContent(a)},_drawGuide:function(s,a){var l,u,h,f=Math.floor(Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))),p=this.options.guidelineDistance,g=this.options.maxGuideLineLength,b=f>g?f-g:p;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));b<f;b+=this.options.guidelineDistance)l=b/f,u={x:Math.floor(s.x*(1-l)+l*a.x),y:Math.floor(s.y*(1-l)+l*a.y)},h=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),h.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(h,u)},_updateGuideColor:function(s){if(this._guidesContainer)for(var a=0,l=this._guidesContainer.childNodes.length;a<l;a++)this._guidesContainer.childNodes[a].style.backgroundColor=s},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var s,a,l=this.options.showLength;return this._markers.length===0?s={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(a=l?this._getMeasurementString():"",s=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:a}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:a}),s},_updateRunningMeasure:function(s,a){var l,u,h=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(l=h-(a?2:1),u=L.GeometryUtil.isVersion07x()?s.distanceTo(this._markers[l].getLatLng())*(this.options.factor||1):this._map.distance(s,this._markers[l].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=u*(a?1:-1))},_getMeasurementString:function(){var s,a=this._currentLatLng,l=this._markers[this._markers.length-1].getLatLng();return s=L.GeometryUtil.isVersion07x()?l&&a&&a.distanceTo?this._measurementRunningTotal+a.distanceTo(l)*(this.options.factor||1):this._measurementRunningTotal||0:l&&a?this._measurementRunningTotal+this._map.distance(a,l)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(s,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var s=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(s,a){L.Draw.Polyline.prototype.initialize.call(this,s,a),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var s=this._markers.length;s===1&&this._markers[0].on("click",this._finishShape,this),s>2&&(this._markers[s-1].on("dblclick",this._finishShape,this),s>3&&this._markers[s-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var s,a;return this._markers.length===0?s=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(s=L.drawLocal.draw.handlers.polygon.tooltip.cont,a=this._getMeasurementString()):(s=L.drawLocal.draw.handlers.polygon.tooltip.end,a=this._getMeasurementString()),{text:s,subtext:a}},_getMeasurementString:function(){var s=this._area,a="";return s||this.options.showLength?(this.options.showLength&&(a=L.Draw.Polyline.prototype._getMeasurementString.call(this)),s&&(a+="<br>"+L.GeometryUtil.readableArea(s,this.options.metric,this.options.precision)),a):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(s,a){var l;!this.options.allowIntersection&&this.options.showArea&&(l=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(l)),L.Draw.Polyline.prototype._vertexChanged.call(this,s,a)},_cleanUpShape:function(){var s=this._markers.length;s>0&&(this._markers[0].off("click",this._finishShape,this),s>2&&this._markers[s-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(s,a){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(s){this._isDrawing=!0,this._startLatLng=s.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(s.originalEvent)},_onMouseMove:function(s){var a=s.latlng;this._tooltip.updatePosition(a),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(a))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(s,a){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,a)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(s){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!i(s.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(s){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,s)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,s),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_getTooltipText:function(){var s,a,l,u=L.Draw.SimpleShape.prototype._getTooltipText.call(this),h=this._shape,f=this.options.showArea;return h&&(s=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),a=L.GeometryUtil.geodesicArea(s),l=f?L.GeometryUtil.readableArea(a,this.options.metric):""),{text:u.text,subtext:l}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(s,a){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(s){var a=s.latlng;this._tooltip.updatePosition(a),this._mouseMarker.setLatLng(a),this._marker?(a=this._mouseMarker.getLatLng(),this._marker.setLatLng(a)):(this._marker=this._createMarker(a),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(s){return new L.Marker(s,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(s){this._onMouseMove(s),this._onClick()},_fireCreatedEvent:function(){var s=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(s,a){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,a)},_fireCreatedEvent:function(){var s=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)},_createMarker:function(s){return new L.CircleMarker(s,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(s,a){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,a)},_drawShape:function(s){if(L.GeometryUtil.isVersion07x())var a=this._startLatLng.distanceTo(s);else var a=this._map.distance(this._startLatLng,s);this._shape?this._shape.setRadius(a):(this._shape=new L.Circle(this._startLatLng,a,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_onMouseMove:function(s){var a,l=s.latlng,u=this.options.showRadius,h=this.options.metric;if(this._tooltip.updatePosition(l),this._isDrawing){this._drawShape(l),a=this._shape.getRadius().toFixed(1);var f="";u&&(f=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(a,h,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:f})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(s,a){this._marker=s,L.setOptions(this,a)},addHooks:function(){var s=this._marker;s.dragging.enable(),s.on("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},removeHooks:function(){var s=this._marker;s.dragging.disable(),s.off("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},_onDragEnd:function(s){var a=s.target;a.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:a})},_toggleMarkerHighlight:function(){var s=this._marker._icon;s&&(s.style.display="none",L.DomUtil.hasClass(s,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,-4)):(L.DomUtil.addClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,4)),s.style.display="")},_offsetMarker:function(s,a){var l=parseInt(s.style.marginTop,10)-a,u=parseInt(s.style.marginLeft,10)-a;s.style.marginTop=l+"px",s.style.marginLeft=u+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(s){this.latlngs=[s._latlngs],s._holes&&(this.latlngs=this.latlngs.concat(s._holes)),this._poly=s,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(s){for(var a=0;a<this._verticesHandlers.length;a++)s(this._verticesHandlers[a])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(s){s.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(s){s.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(s){s.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var s=0;s<this.latlngs.length;s++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[s],this._poly.options.poly))},_updateLatLngs:function(s){this.latlngs=[s.layer._latlngs],s.layer._holes&&(this.latlngs=this.latlngs.concat(s.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(s,a,l){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=s,l&&l.drawError&&(l.drawError=L.Util.extend({},this.options.drawError,l.drawError)),this._latlngs=a,L.setOptions(this,l)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var s=this._poly,a=s._path;s instanceof L.Polygon||(s.options.fill=!1,s.options.editing&&(s.options.editing.fill=!1)),a&&s.options.editing&&s.options.editing.className&&(s.options.original.className&&s.options.original.className.split(" ").forEach(function(l){L.DomUtil.removeClass(a,l)}),s.options.editing.className.split(" ").forEach(function(l){L.DomUtil.addClass(a,l)})),s.setStyle(s.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var s=this._poly,a=s._path;a&&s.options.editing&&s.options.editing.className&&(s.options.editing.className.split(" ").forEach(function(l){L.DomUtil.removeClass(a,l)}),s.options.original.className&&s.options.original.className.split(" ").forEach(function(l){L.DomUtil.addClass(a,l)})),s.setStyle(s.options.original),s._map&&(s._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var s,a,l,u,h=this._defaultShape();for(s=0,l=h.length;s<l;s++)u=this._createMarker(h[s],s),u.on("click",this._onMarkerClick,this),u.on("contextmenu",this._onContextMenu,this),this._markers.push(u);var f,p;for(s=0,a=l-1;s<l;a=s++)(s!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(f=this._markers[a],p=this._markers[s],this._createMiddleMarker(f,p),this._updatePrevNext(f,p))},_createMarker:function(s,a){var l=new L.Marker.Touch(s,{draggable:!0,icon:this.options.icon});return l._origLatLng=s,l._index=a,l.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(l),l},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var s=this._defaultShape(),a=[].splice.apply(s,arguments);return this._poly._convertLatLngs(s,!0),this._poly.redraw(),a},_removeMarker:function(s){var a=s._index;this._markerGroup.removeLayer(s),this._markers.splice(a,1),this._spliceLatLngs(a,1),this._updateIndexes(a,-1),s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(s){var a=s.target,l=this._poly,u=L.LatLngUtil.cloneLatLng(a._origLatLng);if(L.extend(a._origLatLng,a._latlng),l.options.poly){var h=l._map._editTooltip;if(!l.options.poly.allowIntersection&&l.intersects()){L.extend(a._origLatLng,u),a.setLatLng(u);var f=l.options.color;l.setStyle({color:this.options.drawError.color}),h&&h.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){l.setStyle({color:f}),h&&h.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}a._middleLeft&&a._middleLeft.setLatLng(this._getMiddleLatLng(a._prev,a)),a._middleRight&&a._middleRight.setLatLng(this._getMiddleLatLng(a,a._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var p=this._poly.getLatLngs();this._poly._convertLatLngs(p,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(s){var a=L.Polygon&&this._poly instanceof L.Polygon?4:3,l=s.target;this._defaultShape().length<a||(this._removeMarker(l),this._updatePrevNext(l._prev,l._next),l._middleLeft&&this._markerGroup.removeLayer(l._middleLeft),l._middleRight&&this._markerGroup.removeLayer(l._middleRight),l._prev&&l._next?this._createMiddleMarker(l._prev,l._next):l._prev?l._next||(l._prev._middleRight=null):l._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(s){var a=s.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:a,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),l=this._map.layerPointToLatLng(a),u=s.target;L.extend(u._origLatLng,l),u._middleLeft&&u._middleLeft.setLatLng(this._getMiddleLatLng(u._prev,u)),u._middleRight&&u._middleRight.setLatLng(this._getMiddleLatLng(u,u._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(s,a){this._markerGroup.eachLayer(function(l){l._index>s&&(l._index+=a)})},_createMiddleMarker:function(s,a){var l,u,h,f=this._getMiddleLatLng(s,a),p=this._createMarker(f);p.setOpacity(.6),s._middleRight=a._middleLeft=p,u=function(){p.off("touchmove",u,this);var g=a._index;p._index=g,p.off("click",l,this).on("click",this._onMarkerClick,this),f.lat=p.getLatLng().lat,f.lng=p.getLatLng().lng,this._spliceLatLngs(g,0,f),this._markers.splice(g,0,p),p.setOpacity(1),this._updateIndexes(g,1),a._index++,this._updatePrevNext(s,p),this._updatePrevNext(p,a),this._poly.fire("editstart")},h=function(){p.off("dragstart",u,this),p.off("dragend",h,this),p.off("touchmove",u,this),this._createMiddleMarker(s,p),this._createMiddleMarker(p,a)},l=function(){u.call(this),h.call(this),this._fireEdit()},p.on("click",l,this).on("dragstart",u,this).on("dragend",h,this).on("touchmove",u,this),this._markerGroup.addLayer(p)},_updatePrevNext:function(s,a){s&&(s._next=a),a&&(a._prev=s)},_getMiddleLatLng:function(s,a){var l=this._poly._map,u=l.project(s.getLatLng()),h=l.project(a.getLatLng());return l.unproject(u._add(h)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(s,a){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=s,L.Util.setOptions(this,a)},addHooks:function(){var s=this._shape;this._shape._map&&(this._map=this._shape._map,s.setStyle(s.options.editing),s._map&&(this._map=s._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var s=this._shape;if(s.setStyle(s.options.original),s._map){this._unbindMarker(this._moveMarker);for(var a=0,l=this._resizeMarkers.length;a<l;a++)this._unbindMarker(this._resizeMarkers[a]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(s,a){var l=new L.Marker.Touch(s,{draggable:!0,icon:a,zIndexOffset:10});return this._bindMarker(l),this._markerGroup.addLayer(l),l},_bindMarker:function(s){s.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(s){s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(s){s.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(s){var a=s.target,l=a.getLatLng();a===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(s){s.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(s){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s),typeof this._getCorners=="function"){var a=this._getCorners(),l=s.target,u=l._cornerIndex;l.setOpacity(0),this._oppositeCorner=a[(u+2)%4],this._toggleCornerMarkers(0,u)}this._shape.fire("editstart")},_onTouchMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),l=this._map.layerPointToLatLng(a);return s.target===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),!1},_onTouchEnd:function(s){s.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getBounds(),a=s.getCenter();this._moveMarker=this._createMarker(a,this.options.moveIcon)},_createResizeMarker:function(){var s=this._getCorners();this._resizeMarkers=[];for(var a=0,l=s.length;a<l;a++)this._resizeMarkers.push(this._createMarker(s[a],this.options.resizeIcon)),this._resizeMarkers[a]._cornerIndex=a},_onMarkerDragStart:function(s){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s);var a=this._getCorners(),l=s.target,u=l._cornerIndex;this._oppositeCorner=a[(u+2)%4],this._toggleCornerMarkers(0,u)},_onMarkerDragEnd:function(s){var a,l,u=s.target;u===this._moveMarker&&(a=this._shape.getBounds(),l=a.getCenter(),u.setLatLng(l)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,s)},_move:function(s){for(var a,l=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),u=this._shape.getBounds(),h=u.getCenter(),f=[],p=0,g=l.length;p<g;p++)a=[l[p].lat-h.lat,l[p].lng-h.lng],f.push([s.lat+a[0],s.lng+a[1]]);this._shape.setLatLngs(f),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(s){var a;this._shape.setBounds(L.latLngBounds(s,this._oppositeCorner)),a=this._shape.getBounds(),this._moveMarker.setLatLng(a.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var s=this._shape.getBounds();return[s.getNorthWest(),s.getNorthEast(),s.getSouthEast(),s.getSouthWest()]},_toggleCornerMarkers:function(s){for(var a=0,l=this._resizeMarkers.length;a<l;a++)this._resizeMarkers[a].setOpacity(s)},_repositionCornerMarkers:function(){for(var s=this._getCorners(),a=0,l=this._resizeMarkers.length;a<l;a++)this._resizeMarkers[a].setLatLng(s[a])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getLatLng();this._moveMarker=this._createMarker(s,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(s){if(this._resizeMarkers.length){var a=this._getResizeMarkerPoint(s);this._resizeMarkers[0].setLatLng(a)}this._shape.setLatLng(s),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var s=this._shape.getLatLng(),a=this._getResizeMarkerPoint(s);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(a,this.options.resizeIcon))},_getResizeMarkerPoint:function(s){var a=this._shape._radius*Math.cos(Math.PI/4),l=this._map.project(s);return this._map.unproject([l.x+a,l.y-a])},_resize:function(s){var a=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=a.distanceTo(s):radius=this._map.distance(a,s),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(s,a){var l={};if(s.touches!==void 0){if(!s.touches.length)return;l=s.touches[0]}else if(s.pointerType!=="touch"||(l=s,!this._filterClick(s)))return;var u=this._map.mouseEventToContainerPoint(l),h=this._map.mouseEventToLayerPoint(l),f=this._map.layerPointToLatLng(h);this._map.fire(a,{latlng:f,layerPoint:h,containerPoint:u,pageX:l.pageX,pageY:l.pageY,originalEvent:s})},_filterClick:function(s){var a=s.timeStamp||s.originalEvent.timeStamp,l=L.DomEvent._lastClick&&a-L.DomEvent._lastClick;return l&&l>100&&l<500||s.target._simulatedClick&&!s._simulated?(L.DomEvent.stop(s),!1):(L.DomEvent._lastClick=a,!0)},_onTouchStart:function(s){this._map._loaded&&this._touchEvent(s,"touchstart")},_onTouchEnd:function(s){this._map._loaded&&this._touchEvent(s,"touchend")},_onTouchCancel:function(s){if(this._map._loaded){var a="touchcancel";this._detectIE()&&(a="pointercancel"),this._touchEvent(s,a)}},_onTouchLeave:function(s){this._map._loaded&&this._touchEvent(s,"touchleave")},_onTouchMove:function(s){this._map._loaded&&this._touchEvent(s,"touchmove")},_detectIE:function(){var s=e.navigator.userAgent,a=s.indexOf("MSIE ");if(a>0)return parseInt(s.substring(a+5,s.indexOf(".",a)),10);if(s.indexOf("Trident/")>0){var l=s.indexOf("rv:");return parseInt(s.substring(l+3,s.indexOf(".",l)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var s=this._icon,a=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?a.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):a.concat(["touchcancel"]),L.DomUtil.addClass(s,"leaflet-clickable"),L.DomEvent.on(s,"click",this._onMouseClick,this),L.DomEvent.on(s,"keypress",this._onKeyPress,this);for(var l=0;l<a.length;l++)L.DomEvent.on(s,a[l],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var s=e.navigator.userAgent,a=s.indexOf("MSIE ");if(a>0)return parseInt(s.substring(a+5,s.indexOf(".",a)),10);if(s.indexOf("Trident/")>0){var l=s.indexOf("rv:");return parseInt(s.substring(l+3,s.indexOf(".",l)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.LatLngUtil={cloneLatLngs:function(s){for(var a=[],l=0,u=s.length;l<u;l++)Array.isArray(s[l])?a.push(L.LatLngUtil.cloneLatLngs(s[l])):a.push(this.cloneLatLng(s[l]));return a},cloneLatLng:function(s){return L.latLng(s.lat,s.lng)}},(function(){var s={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(a){var l,u,h=a.length,f=0,p=Math.PI/180;if(h>2){for(var g=0;g<h;g++)l=a[g],u=a[(g+1)%h],f+=(u.lng-l.lng)*p*(2+Math.sin(l.lat*p)+Math.sin(u.lat*p));f=6378137*f*6378137/2}return Math.abs(f)},formattedNumber:function(a,l){var u=parseFloat(a).toFixed(l),h=L.drawLocal.format&&L.drawLocal.format.numeric,f=h&&h.delimiters,p=f&&f.thousands,g=f&&f.decimal;if(p||g){var b=u.split(".");u=p?b[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+p):b[0],g=g||".",b.length>1&&(u=u+g+b[1])}return u},readableArea:function(a,l,p){var h,f,p=L.Util.extend({},s,p);return l?(f=["ha","m"],type=typeof l,type==="string"?f=[l]:type!=="boolean"&&(f=l),h=a>=1e6&&f.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*a,p.km)+" km":a>=1e4&&f.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*a,p.ha)+" ha":L.GeometryUtil.formattedNumber(a,p.m)+" m"):(a/=.836127,h=a>=3097600?L.GeometryUtil.formattedNumber(a/3097600,p.mi)+" mi":a>=4840?L.GeometryUtil.formattedNumber(a/4840,p.ac)+" acres":L.GeometryUtil.formattedNumber(a,p.yd)+" yd"),h},readableDistance:function(a,l,u,h,g){var p,g=L.Util.extend({},s,g);switch(l?typeof l=="string"?l:"metric":u?"feet":h?"nauticalMile":"yards"){case"metric":p=a>1e3?L.GeometryUtil.formattedNumber(a/1e3,g.km)+" km":L.GeometryUtil.formattedNumber(a,g.m)+" m";break;case"feet":a*=3.28083,p=L.GeometryUtil.formattedNumber(a,g.ft)+" ft";break;case"nauticalMile":a*=.53996,p=L.GeometryUtil.formattedNumber(a/1e3,g.nm)+" nm";break;default:a*=1.09361,p=a>1760?L.GeometryUtil.formattedNumber(a/1760,g.mi)+" miles":L.GeometryUtil.formattedNumber(a,g.yd)+" yd"}return p},isVersion07x:function(){var a=L.version.split(".");return parseInt(a[0],10)===0&&parseInt(a[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(s,a,l,u){return this._checkCounterclockwise(s,l,u)!==this._checkCounterclockwise(a,l,u)&&this._checkCounterclockwise(s,a,l)!==this._checkCounterclockwise(s,a,u)},_checkCounterclockwise:function(s,a,l){return(l.y-s.y)*(a.x-s.x)>(a.y-s.y)*(l.x-s.x)}}),L.Polyline.include({intersects:function(){var s,a,l,u=this._getProjectedPoints(),h=u?u.length:0;if(this._tooFewPointsForIntersection())return!1;for(s=h-1;s>=3;s--)if(a=u[s-1],l=u[s],this._lineSegmentsIntersectsRange(a,l,s-2))return!0;return!1},newLatLngIntersects:function(s,a){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(s),a)},newPointIntersects:function(s,a){var l=this._getProjectedPoints(),u=l?l.length:0,h=l?l[u-1]:null,f=u-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(h,s,f,a?1:0)},_tooFewPointsForIntersection:function(s){var a=this._getProjectedPoints(),l=a?a.length:0;return l+=s||0,!a||l<=3},_lineSegmentsIntersectsRange:function(s,a,l,u){var h,f,p=this._getProjectedPoints();u=u||0;for(var g=l;g>u;g--)if(h=p[g-1],f=p[g],L.LineUtil.segmentsIntersect(s,a,h,f))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var s=[],a=this._defaultShape(),l=0;l<a.length;l++)s.push(this._map.latLngToLayerPoint(a[l]));return s}}),L.Polygon.include({intersects:function(){var s,a,l,u,h=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(s=h.length,a=h[0],l=h[s-1],u=s-2,this._lineSegmentsIntersectsRange(l,a,u,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(s){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,s);var a;this._toolbars={},L.DrawToolbar&&this.options.draw&&(a=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=a,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(a=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=a,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(s){var a,l=L.DomUtil.create("div","leaflet-draw"),u=!1;for(var h in this._toolbars)this._toolbars.hasOwnProperty(h)&&(a=this._toolbars[h].addToolbar(s))&&(u||(L.DomUtil.hasClass(a,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(a.childNodes[0],"leaflet-draw-toolbar-top"),u=!0),l.appendChild(a));return l},onRemove:function(){for(var s in this._toolbars)this._toolbars.hasOwnProperty(s)&&this._toolbars[s].removeToolbar()},setDrawingOptions:function(s){for(var a in this._toolbars)this._toolbars[a]instanceof L.DrawToolbar&&this._toolbars[a].setOptions(s)},_toolbarEnabled:function(s){var a=s.target;for(var l in this._toolbars)this._toolbars[l]!==a&&this._toolbars[l].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(s){L.setOptions(this,s),this._modes={},this._actionButtons=[],this._activeMode=null;var a=L.version.split(".");parseInt(a[0],10)===1&&parseInt(a[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(s){var a,l=L.DomUtil.create("div","leaflet-draw-section"),u=0,h=this._toolbarClass||"",f=this.getModeHandlers(s);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=s,a=0;a<f.length;a++)f[a].enabled&&this._initModeHandler(f[a].handler,this._toolbarContainer,u++,h,f[a].title);if(u)return this._lastButtonIndex=--u,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),l.appendChild(this._toolbarContainer),l.appendChild(this._actionsContainer),l},removeToolbar:function(){for(var s in this._modes)this._modes.hasOwnProperty(s)&&(this._disposeButton(this._modes[s].button,this._modes[s].handler.enable,this._modes[s].handler),this._modes[s].handler.disable(),this._modes[s].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var a=0,l=this._actionButtons.length;a<l;a++)this._disposeButton(this._actionButtons[a].button,this._actionButtons[a].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(s,a,l,u,h){var f=s.type;this._modes[f]={},this._modes[f].handler=s,this._modes[f].button=this._createButton({type:f,title:h,className:u+"-"+f,container:a,callback:this._modes[f].handler.enable,context:this._modes[f].handler}),this._modes[f].buttonIndex=l,this._modes[f].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(s){var a=L.DomUtil.create("a",s.className||"",s.container),l=L.DomUtil.create("span","sr-only",s.container);a.href="#",a.appendChild(l),s.title&&(a.title=s.title,l.innerHTML=s.title),s.text&&(a.innerHTML=s.text,l.innerHTML=s.text);var u=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(a,"click",L.DomEvent.stopPropagation).on(a,"mousedown",L.DomEvent.stopPropagation).on(a,"dblclick",L.DomEvent.stopPropagation).on(a,"touchstart",L.DomEvent.stopPropagation).on(a,"click",L.DomEvent.preventDefault).on(a,u,s.callback,s.context),a},_disposeButton:function(s,a){var l=this._detectIOS()?"touchstart":"click";L.DomEvent.off(s,"click",L.DomEvent.stopPropagation).off(s,"mousedown",L.DomEvent.stopPropagation).off(s,"dblclick",L.DomEvent.stopPropagation).off(s,"touchstart",L.DomEvent.stopPropagation).off(s,"click",L.DomEvent.preventDefault).off(s,l,a)},_handlerActivated:function(s){this.disable(),this._activeMode=this._modes[s.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(s){var a,l,u,h,f=this._actionsContainer,p=this.getActions(s),g=p.length;for(l=0,u=this._actionButtons.length;l<u;l++)this._disposeButton(this._actionButtons[l].button,this._actionButtons[l].callback);for(this._actionButtons=[];f.firstChild;)f.removeChild(f.firstChild);for(var b=0;b<g;b++)"enabled"in p[b]&&!p[b].enabled||(a=L.DomUtil.create("li","",f),h=this._createButton({title:p[b].title,text:p[b].text,container:a,callback:p[b].callback,context:p[b].context}),this._actionButtons.push({button:h,callback:p[b].callback}))},_showActionsToolbar:function(){var s=this._activeMode.buttonIndex,a=this._lastButtonIndex,l=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=l+"px",s===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),s===a&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(s){this._map=s,this._popupPane=s._panes.popupPane,this._visible=!1,this._container=s.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(s){return this._container?(s.subtext=s.subtext||"",s.subtext.length!==0||this._singleLineLabel?s.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(s.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+s.subtext+"</span><br />":"")+"<span>"+s.text+"</span>",s.text||s.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(s){var a=this._map.latLngToLayerPoint(s),l=this._container;return this._container&&(this._visible&&(l.style.visibility="inherit"),L.DomUtil.setPosition(l,a)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(s){for(var a in this.options)this.options.hasOwnProperty(a)&&s[a]&&(s[a]=L.extend({},this.options[a],s[a]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,s)},getModeHandlers:function(s){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(s,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(s,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(s,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(s,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(s,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(s,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(s){return[{enabled:s.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:s.completeShape,context:s},{enabled:s.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:s.deleteLastVertex,context:s},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(s){L.setOptions(this,s);for(var a in this._modes)this._modes.hasOwnProperty(a)&&s.hasOwnProperty(a)&&this._modes[a].handler.setOptions(s[a])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(s){s.edit&&(s.edit.selectedPathOptions===void 0&&(s.edit.selectedPathOptions=this.options.edit.selectedPathOptions),s.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,s.edit.selectedPathOptions)),s.remove&&(s.remove=L.extend({},this.options.remove,s.remove)),s.poly&&(s.poly=L.extend({},this.options.poly,s.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,s),this._selectedFeatureCount=0},getModeHandlers:function(s){var a=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(s,{featureGroup:a,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(s,{featureGroup:a}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(s){var a=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return s.removeAllLayers&&a.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),a},addToolbar:function(s){var a=L.Toolbar.prototype.addToolbar.call(this,s);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),a},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var s,a=this.options.featureGroup,l=a.getLayers().length!==0;this.options.edit&&(s=this._modes[L.EditToolbar.Edit.TYPE].button,l?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(s=this._modes[L.EditToolbar.Delete.TYPE].button,l?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(s,a){if(L.Handler.prototype.initialize.call(this,s),L.setOptions(this,a),this._featureGroup=a.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),s._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(s){this._revertLayer(s)},this)},save:function(){var s=new L.LayerGroup;this._featureGroup.eachLayer(function(a){a.edited&&(s.addLayer(a),a.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:s})},_backupLayer:function(s){var a=L.Util.stamp(s);this._uneditedLayerProps[a]||(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?this._uneditedLayerProps[a]={latlngs:L.LatLngUtil.cloneLatLngs(s.getLatLngs())}:s instanceof L.Circle?this._uneditedLayerProps[a]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng()),radius:s.getRadius()}:(s instanceof L.Marker||s instanceof L.CircleMarker)&&(this._uneditedLayerProps[a]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(s){var a=L.Util.stamp(s);s.edited=!1,this._uneditedLayerProps.hasOwnProperty(a)&&(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?s.setLatLngs(this._uneditedLayerProps[a].latlngs):s instanceof L.Circle?(s.setLatLng(this._uneditedLayerProps[a].latlng),s.setRadius(this._uneditedLayerProps[a].radius)):(s instanceof L.Marker||s instanceof L.CircleMarker)&&s.setLatLng(this._uneditedLayerProps[a].latlng),s.fire("revert-edited",{layer:s}))},_enableLayerEdit:function(s){var a,l,u=s.layer||s.target||s;this._backupLayer(u),this.options.poly&&(l=L.Util.extend({},this.options.poly),u.options.poly=l),this.options.selectedPathOptions&&(a=L.Util.extend({},this.options.selectedPathOptions),a.maintainColor&&(a.color=u.options.color,a.fillColor=u.options.fillColor),u.options.original=L.extend({},u.options),u.options.editing=a),u instanceof L.Marker?(u.editing&&u.editing.enable(),u.dragging.enable(),u.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):u.editing.enable()},_disableLayerEdit:function(s){var a=s.layer||s.target||s;a.edited=!1,a.editing&&a.editing.disable(),delete a.options.editing,delete a.options.original,this._selectedPathOptions&&(a instanceof L.Marker?this._toggleMarkerHighlight(a):(a.setStyle(a.options.previousOptions),delete a.options.previousOptions)),a instanceof L.Marker?(a.dragging.disable(),a.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):a.editing.disable()},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_onMarkerDragEnd:function(s){var a=s.target;a.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:a})},_onTouchMove:function(s){var a=s.originalEvent.changedTouches[0],l=this._map.mouseEventToLayerPoint(a),u=this._map.layerPointToLatLng(l);s.target.setLatLng(u)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(s,a){if(L.Handler.prototype.initialize.call(this,s),L.Util.setOptions(this,a),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(s){this._deletableLayers.addLayer(s),s.fire("revert-deleted",{layer:s})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(s){this._removeLayer({layer:s})},this),this.save()},_enableLayerDelete:function(s){(s.layer||s.target||s).on("click",this._removeLayer,this)},_disableLayerDelete:function(s){var a=s.layer||s.target||s;a.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(a)},_removeLayer:function(s){var a=s.layer||s.target||s;this._deletableLayers.removeLayer(a),this._deletedLayers.addLayer(a),a.fire("deleted")},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const $p=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"",lh=e=>e.length*6+12,ac=(e,t)=>!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom),Ob=(e,t)=>{if(!e||t.length===0)return new Set;const o=[],i=e.getBounds();t.forEach(l=>{if(i.contains(l.getLatLng())){const u=e.latLngToContainerPoint(l.getLatLng()),h=l.locationData;h&&o.push({marker:l,pixelPos:u,location:h})}});const s=o.map(({marker:l,pixelPos:u,location:h})=>{const g=lh(h.name),b=h.description?lh(`${h.name}: ${$p(h.description,50)}`):g;return{marker:l,location:h,markerBox:{left:u.x-15,right:u.x+15,top:u.y-15,bottom:u.y+15},baseLabelBox:{left:u.x-g/2,right:u.x+g/2,top:u.y+15+2,bottom:u.y+15+2+20},descLabelBox:h.description?{left:u.x-b/2,right:u.x+b/2,top:u.y+15+2,bottom:u.y+15+2+20}:null}}),a=new Set;return s.forEach(({marker:l,location:u,markerBox:h,baseLabelBox:f,descLabelBox:p},g)=>{if(!u.description)return;let b=!1;for(let S=0;S<s.length;S++){if(g===S)continue;const T=s[S];if(ac(p,T.markerBox)||ac(p,T.baseLabelBox)){b=!0;break}if(T.descLabelBox&&a.has(T.location.id)&&ac(p,T.descLabelBox)){b=!0;break}}b||a.add(u.id)}),a},wr=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"hexagon",label:"Hexagon"},{value:"pentagon",label:"Pentagon"},{value:"diamond",label:"Diamond"},{value:"star",label:"Star"},{value:"dot",label:"Dot"},{value:"none",label:"None"}],Rb=[{value:"33",label:"Small (33%)"},{value:"66",label:"Medium (66%)"},{value:"100",label:"Normal (100%)"},{value:"150",label:"Large (150%)"}],qr=[{value:"default",label:"Default",isShapeOnly:!1,category:"default"},{value:"dot",label:"Dot",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"circle",label:"Circle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"square",label:"Square",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"triangle",label:"Triangle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"diamond",label:"Diamond",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"star",label:"Star",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"hexagon",label:"Hexagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"pentagon",label:"Pentagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"car",label:"Car",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"bike",label:"Bike",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"water",label:"Water",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"food",label:"Food",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"medical",label:"Medical",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"photo",label:"Photo",isShapeOnly:!1,category:"content",defaultColor:"#8B5CF6"},{value:"music",label:"Music",isShapeOnly:!1,category:"content",defaultColor:"#EC4899"},{value:"start",label:"Start",isShapeOnly:!1,category:"content",defaultColor:"#10B981"},{value:"finish",label:"Finish",isShapeOnly:!1,category:"content",defaultColor:"#1F2937"},{value:"toilet",label:"Toilet",isShapeOnly:!1,category:"content",defaultColor:"#6366F1"},{value:"shower",label:"Shower",isShapeOnly:!1,category:"content",defaultColor:"#06B6D4"},{value:"bus",label:"Bus",isShapeOnly:!1,category:"content",defaultColor:"#F97316"},{value:"info",label:"Information",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"merch",label:"Merchandise",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"cone",label:"Road closure",isShapeOnly:!1,category:"content",defaultColor:"#FF6B00"},{value:"traffic",label:"Traffic management",isShapeOnly:!1,category:"content",defaultColor:"#374151"},{value:"track",label:"Track",isShapeOnly:!1,category:"content",defaultColor:"#78716C"},{value:"tunnel",label:"Tunnel",isShapeOnly:!1,category:"content",defaultColor:"#57534E"},{value:"bridge",label:"Bridge",isShapeOnly:!1,category:"content",defaultColor:"#0284C7"},{value:"plane",label:"Plane",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"hill",label:"Hill",isShapeOnly:!1,category:"content",defaultColor:"#65A30D"},{value:"baggage",label:"Baggage",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"crown",label:"Crown",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"crossing",label:"Crossing point",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"trees",label:"Trees",isShapeOnly:!1,category:"content",defaultColor:"#22C55E"},{value:"arrow-uturn-left",label:"Left u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-left",label:"Left turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-left",label:"Slight left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-straight",label:"Straight ahead",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-right",label:"Slight right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-right",label:"Right turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-uturn-right",label:"Right u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-left",label:"Left fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-right",label:"Right fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-left",label:"Keep left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-right",label:"Keep right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"}];function js(e){return qr.find(t=>t.value===e)||qr[0]}function Bb(e){return js(e).defaultColor||"#667eea"}function Nb(e,t){return t||Bb(e)}const Dc={dot:(e,t=32)=>{const o=(t/2-2)*.33;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="1.5"/>
    </svg>`},circle:(e,t=32)=>{const o=t/2-2;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`},square:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect x="4" y="4" width="${t-8}" height="${t-8}" rx="4" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`,triangle:(e,t=32)=>{const o=t/2,i=4,s=t-4,a=4,l=t-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${i} ${l},${s} ${a},${s}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},diamond:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${i-s} ${o+s},${i} ${o},${i+s} ${o-s},${i}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},star:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-3,a=s*.4,l=[];for(let u=0;u<5;u++){const h=Math.PI/2*-1+u*2*Math.PI/5;l.push(`${o+s*Math.cos(h)},${i+s*Math.sin(h)}`);const f=h+Math.PI/5;l.push(`${o+a*Math.cos(f)},${i+a*Math.sin(f)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${l.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},hexagon:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4,a=[];for(let l=0;l<6;l++){const u=Math.PI/6+l*Math.PI/3;a.push(`${o+s*Math.cos(u)},${i+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${a.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},pentagon:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4,a=[];for(let l=0;l<5;l++){const u=Math.PI/2*-1+l*2*Math.PI/5;a.push(`${o+s*Math.cos(u)},${i+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${a.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},car:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Car body -->
      <rect x="6" y="13" width="20" height="8" rx="2" fill="#fff"/>
      <!-- Car roof/cabin -->
      <path d="M10 13 L12 9 L20 9 L22 13" fill="#fff" stroke="#fff" stroke-width="1"/>
      <!-- Windows -->
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${e}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${e}"/>
      <!-- Tires (always black) -->
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <!-- Wheel centers -->
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>
    </svg>`,bike:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Tires (same color as bike) -->
      <circle cx="9" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <!-- Wheel centers -->
      <circle cx="9" cy="20" r="1" fill="#fff"/>
      <circle cx="23" cy="20" r="1" fill="#fff"/>
      <!-- Frame -->
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
      <!-- Handlebars -->
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <!-- Seat -->
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="#fff"/>
    </svg>`},ch={water:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="#fff"/>
    </svg>`,food:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="#fff"/>
      <path d="M21 9v14h2V9h-2z" fill="#fff"/>
    </svg>`,medical:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#fff" stroke-width="2"/>
      <rect x="14" y="8" width="4" height="16" rx="1" fill="#fff"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="#fff"/>
    </svg>`,photo:(e=32)=>{const t="#8B5CF6";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="8" y="10" width="16" height="12" rx="2" fill="#fff"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" y="13" r="1" fill="${t}"/>
    </svg>`},music:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EC4899" stroke="#fff" stroke-width="2"/>
      <path d="M12 22c1.66 0 3-1.34 3-3v-9h5v4h-3v5c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.35 0 .69.07 1 .18V10c0-.55.45-1 1-1h5c.55 0 1 .45 1 1v6h-5v5c0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.7 0 1.37.15 2 .41" fill="#fff"/>
      <ellipse cx="12" cy="21" rx="2.5" ry="2" fill="#fff"/>
      <rect x="14" y="10" width="2" height="9" fill="#fff"/>
      <rect x="14" y="10" width="6" height="2" fill="#fff"/>
    </svg>`,start:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#10B981" stroke="#fff" stroke-width="2"/>
      <path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="#fff"/>
    </svg>`,finish:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#1F2937" stroke="#fff" stroke-width="2"/>
      <rect x="10" y="8" width="4" height="4" fill="#fff"/>
      <rect x="14" y="12" width="4" height="4" fill="#fff"/>
      <rect x="18" y="8" width="4" height="4" fill="#fff"/>
      <rect x="10" y="16" width="4" height="4" fill="#fff"/>
      <rect x="18" y="16" width="4" height="4" fill="#fff"/>
      <rect x="14" y="20" width="4" height="4" fill="#fff"/>
    </svg>`,toilet:(e=32)=>{const t="#6366F1";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="11" y="7" width="10" height="3" rx="1" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>
    </svg>`},shower:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#06B6D4" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="3" fill="#fff"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="#fff"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
    </svg>`,bus:(e=32)=>{const t="#F97316";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="9" y="9" width="14" height="12" rx="2" fill="#fff"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="#fff"/>
      <circle cx="12" cy="21" r="1.5" fill="#fff"/>
      <circle cx="20" cy="21" r="1.5" fill="#fff"/>
    </svg>`},info:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#0EA5E9" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="2" fill="#fff"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="#fff"/>
    </svg>`,merch:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#A855F7" stroke="#fff" stroke-width="2"/>
      <path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="#fff"/>
      <path d="M13 10 L16 7 L19 10" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>`,cone:(e=32)=>{const t="#FF6B00";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L21 22 H11 L16 6Z" fill="#fff"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="#fff"/>
    </svg>`},traffic:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#374151" stroke="#fff" stroke-width="2"/>
      <rect x="12" y="6" width="8" height="20" rx="2" fill="#fff"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>
    </svg>`,crown:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="#fff"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="#fff"/>
    </svg>`,crossing:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="#fff" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="#fff" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="#fff"/>
      <path d="M16 10 L16 16" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
    </svg>`,trees:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#22C55E" stroke="#fff" stroke-width="2"/>
      <!-- Left tree -->
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="#fff"/>
      <!-- Right tree -->
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="#fff"/>
    </svg>`,"arrow-uturn-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on right, curve left, down on left -->
      <path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on left side -->
      <path d="M7 15 L12 21 L17 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="#fff"/>
    </svg>`,"arrow-slight-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-straight":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
    </svg>`,"arrow-slight-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="#fff"/>
    </svg>`,"arrow-uturn-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on left, curve right, down on right -->
      <path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on right side -->
      <path d="M15 15 L20 21 L25 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-fork-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (correct way - with arrow) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M10 12 L6 10 L8 16 Z" fill="#fff"/>
      <!-- Right fork (wrong way - with X) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
    </svg>`,"arrow-fork-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (wrong way - with X) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <!-- Right fork (correct way - with arrow) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M22 12 L26 10 L24 16 Z" fill="#fff"/>
    </svg>`,"arrow-keep-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-keep-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`},_i={circle:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="14" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,square:({backgroundColor:e,borderColor:t})=>`<rect x="4" y="4" width="24" height="24" rx="4" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,hexagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=[];for(let a=0;a<6;a++){const l=Math.PI/6+a*Math.PI/3;s.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},pentagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=[];for(let a=0;a<5;a++){const l=Math.PI/2*-1+a*2*Math.PI/5;s.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},diamond:({backgroundColor:e,borderColor:t})=>`<polygon points="16,4 28,16 16,28 4,16" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}" stroke-linejoin="round"/>`,star:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=13,a=s*.4,l=[];for(let u=0;u<5;u++){const h=Math.PI/2*-1+u*2*Math.PI/5;l.push(`${16+s*Math.cos(h)},${16+s*Math.sin(h)}`);const f=h+Math.PI/5;l.push(`${16+a*Math.cos(f)},${16+a*Math.sin(f)}`)}return`<polygon points="${l.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},dot:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="5" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:1.5}"/>`,none:()=>""},uh={water:(e="#fff")=>`<path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="${e}"/>`,food:(e="#fff")=>`<path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="${e}"/>
      <path d="M21 9v14h2V9h-2z" fill="${e}"/>`,medical:(e="#fff")=>`<rect x="14" y="8" width="4" height="16" rx="1" fill="${e}"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="${e}"/>`,photo:(e="#fff",t="#667eea")=>`<rect x="8" y="10" width="16" height="12" rx="2" fill="${e}"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" cy="13" r="1" fill="${t}"/>`,music:(e="#fff")=>`<ellipse cx="12" cy="21" rx="2.5" ry="2" fill="${e}"/>
      <rect x="14" y="10" width="2" height="9" fill="${e}"/>
      <rect x="14" y="10" width="6" height="2" fill="${e}"/>`,start:(e="#fff")=>`<path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="${e}"/>`,finish:(e="#fff")=>`<rect x="10" y="8" width="4" height="4" fill="${e}"/>
      <rect x="14" y="12" width="4" height="4" fill="${e}"/>
      <rect x="18" y="8" width="4" height="4" fill="${e}"/>
      <rect x="10" y="16" width="4" height="4" fill="${e}"/>
      <rect x="18" y="16" width="4" height="4" fill="${e}"/>
      <rect x="14" y="20" width="4" height="4" fill="${e}"/>`,toilet:(e="#fff",t="#667eea")=>`<rect x="11" y="7" width="10" height="3" rx="1" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="${e}" stroke-width="2" fill="none" stroke-linecap="round"/>`,shower:(e="#fff")=>`<circle cx="16" cy="10" r="3" fill="${e}"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="${e}"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>`,bus:(e="#fff",t="#667eea")=>`<rect x="9" y="9" width="14" height="12" rx="2" fill="${e}"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="${e}"/>
      <circle cx="12" cy="21" r="1.5" fill="${e}"/>
      <circle cx="20" cy="21" r="1.5" fill="${e}"/>`,info:(e="#fff")=>`<circle cx="16" cy="10" r="2" fill="${e}"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="${e}"/>`,merch:(e="#fff")=>`<path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="${e}"/>
      <path d="M13 10 L16 7 L19 10" stroke="${e}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`,cone:(e="#fff",t="#667eea")=>`<path d="M16 6 L21 22 H11 L16 6Z" fill="${e}"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="${e}"/>`,traffic:(e="#fff")=>`<rect x="12" y="6" width="8" height="20" rx="2" fill="${e}"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>`,car:(e="#fff",t="#667eea")=>`<rect x="6" y="13" width="20" height="8" rx="2" fill="${e}"/>
      <path d="M10 13 L12 9 L20 9 L22 13" fill="${e}" stroke="${e}" stroke-width="1"/>
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${t}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${t}"/>
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>`,bike:(e="#fff")=>`<circle cx="9" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="9" cy="20" r="1" fill="${e}"/>
      <circle cx="23" cy="20" r="1" fill="${e}"/>
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="${e}" stroke-width="2" stroke-linejoin="round"/>
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="${e}"/>`,"arrow-uturn-left":(e="#fff")=>`<path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7 15 L12 21 L17 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-left":(e="#fff")=>`<path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="${e}"/>`,"arrow-slight-left":(e="#fff")=>`<g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-straight":(e="#fff")=>`<path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>`,"arrow-slight-right":(e="#fff")=>`<g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-right":(e="#fff")=>`<path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="${e}"/>`,"arrow-uturn-right":(e="#fff")=>`<path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 15 L20 21 L25 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-fork-left":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Left arrowhead -->
      <path d="M10 12 L6 10 L8 16 Z" fill="${e}"/>
      <!-- Wrong way indicator on right -->
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>`,"arrow-fork-right":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <!-- Wrong way indicator on left -->
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Right arrowhead -->
      <path d="M22 12 L26 10 L24 16 Z" fill="${e}"/>`,"arrow-keep-left":(e="#fff")=>`<g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-keep-right":(e="#fff")=>`<g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,track:(e="#fff")=>`
      <rect x="10" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="19.5" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="8" y="9" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="14.5" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="20" width="16" height="2.5" rx="0.5" fill="${e}"/>`,tunnel:(e="#fff")=>`
      <path d="M7 25 L7 14 C7 8 11 5 16 5 C21 5 25 8 25 14 L25 25" fill="none" stroke="${e}" stroke-width="2.5"/>
      <path d="M11 25 L11 16 C11 12 13 10 16 10 C19 10 21 12 21 16 L21 25" fill="none" stroke="${e}" stroke-width="1.5" opacity="0.6"/>`,bridge:(e="#fff")=>`
      <rect x="5" y="18" width="22" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="7" y="10" width="2" height="8" fill="${e}"/>
      <rect x="23" y="10" width="2" height="8" fill="${e}"/>
      <path d="M8 10 Q16 6 24 10" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <line x1="12" y1="13" x2="12" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="16" y1="11.5" x2="16" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="20" y1="13" x2="20" y2="18" stroke="${e}" stroke-width="1.5"/>`,plane:(e="#fff")=>`
      <g fill="${e}">
        <!-- Fuselage body -->
        <path d="M27 16 L24 14 L8 14 Q4 16 8 18 L24 18 L27 16 Z"/>
        <!-- Nose cone -->
        <path d="M8 14 Q4 16 8 18 L8 14 Z"/>
        <!-- Tail fin -->
        <path d="M26 14 L26 9 L22 14 Z"/>
        <!-- Main wing -->
        <path d="M20 16 L16 10 L14 10 L16 16 L14 22 L16 22 L20 16 Z"/>
        <!-- Cockpit window -->
        <ellipse cx="10" cy="16" rx="1.5" ry="1" fill="none" stroke="${e}" stroke-width="0.5" opacity="0.6"/>
      </g>`,hill:(e="#fff")=>`
      <path d="M6 24 L13 12 L16 16 L20 10 L26 24 Z" fill="${e}"/>
      <path d="M20 10 L22 13 L18 13 Z" fill="${e}" opacity="0.6"/>`,baggage:(e="#fff")=>`
      <rect x="8" y="12" width="16" height="12" rx="2" fill="${e}"/>
      <rect x="12" y="8" width="8" height="4" rx="1" fill="none" stroke="${e}" stroke-width="2"/>
      <line x1="12" y1="16" x2="20" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
      <line x1="12" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>`,crown:(e="#fff")=>`
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="${e}"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="${e}"/>`,crossing:(e="#fff")=>`
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="${e}" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="${e}" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="${e}"/>
      <path d="M16 10 L16 16" stroke="${e}" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>`,trees:(e="#fff")=>`
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="${e}"/>
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="${e}"/>`};function qt({type:e,backgroundShape:t="circle",backgroundColor:o,borderColor:i,iconColor:s,size:a="100",outputSize:l=null}){if(!e||e==="default"){if(!(o||i||s||t&&t!=="circle"&&t!=="default"))return null;e=t&&t!=="default"?t:"circle"}const u=js(e),h=parseInt(a,10)/100,f=l||Math.round(32*h);let p="";if(u.isShapeOnly){const g=o||u.defaultColor||"#667eea",b=i||"#fff";if(_i[e])p=_i[e]({backgroundColor:g,borderColor:b});else return Dc[e]?.(g,f)||null}else{const g=o||"#667eea",b=i||"#fff",S=s||"#fff",T=t||"circle";T!=="none"&&_i[T]&&(p+=_i[T]({backgroundColor:g,borderColor:b})),uh[e]&&(p+=uh[e](S,g))}return`<svg width="${f}" height="${f}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
    ${p}
  </svg>`}const Fb={full:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#10B981" stroke="#fff" stroke-width="1.5"/>
    <path d="M4 7l2 2 4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </svg>`,partial:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#F59E0B" stroke="#fff" stroke-width="1.5"/>
    <rect x="6" y="3.5" width="2" height="4.5" rx="1" fill="#fff"/>
    <circle cx="7" cy="10" r="1" fill="#fff"/>
  </svg>`,missing:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#EF4444" stroke="#fff" stroke-width="1.5"/>
    <path d="M4.5 4.5l5 5M9.5 4.5l-5 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
  </svg>`};function zb(e,t){return e===0?"missing":e>=t?"full":"partial"}function Oc(e,t){const o=zb(e,t);return Fb[o]}function Ub(e,t,o=32){if(e==="default")return null;if(ch[e])return ch[e](o);if(Dc[e]){const i=t||"#667eea";return Dc[e](i,o)}return null}const Hb=["circle","square","hexagon","pentagon"];function Vb(e){return Hb.includes(e)}function Zb(e,t,o,i,s=32,a=!0){const l=Ub(e,t,s),u=Oc(o,i);if(!l)return null;const h=a&&Vb(e),f=Nb(e,t),p=Wb(f),g=Mp(f)?"0 1px 2px rgba(255,255,255,0.5)":"0 1px 2px rgba(0,0,0,0.5)",b=s>=36?"12px":"10px",S=h?`
    <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: ${p};
      font-weight: bold;
      font-size: ${b};
      text-shadow: ${g};
      pointer-events: none;
    ">${o}/${i}</div>
  `:"";return`
    <div style="position: relative; width: ${s}px; height: ${s}px;">
      ${l}
      ${S}
      <div style="position: absolute; bottom: -4px; right: -4px;">
        ${u}
      </div>
    </div>
  `}function jb(e){const t=e.replace("#",""),o=parseInt(t.substr(0,2),16)/255,i=parseInt(t.substr(2,2),16)/255,s=parseInt(t.substr(4,2),16)/255,a=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),l=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*a+.7152*l+.0722*u}function Mp(e){return!e||e.length<6?!1:jb(e)>.4}function Wb(e){return Mp(e)?"#1F2937":"#FFFFFF"}const qb="#667eea",Gb={__name:"MapView",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},clickable:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","polygon-complete","polygon-drawing"],setup(e,{expose:t,emit:o}){const i=e,s=o,a=O(null);let l=null;const u=O([]),h=O([]),f=O([]);let p=null,g=null;const b=()=>{if(l){const X=l.getCenter();return{lat:X.lat,lng:X.lng}}return null},S=()=>l?l.getZoom():null,T=()=>{if(u.value.length>0){f.value.push([...u.value]);const X=h.value.pop()||[];u.value=X,ue(),s("polygon-drawing",u.value)}},_=()=>{if(f.value.length>0){h.value.push([...u.value]);const X=f.value.pop();u.value=X,ue(),s("polygon-drawing",u.value)}},D=()=>u.value.length>0,M=()=>f.value.length>0,x=()=>u.value.length,C=()=>{u.value.length>=3&&(s("polygon-complete",[...u.value]),A())},A=()=>{u.value=[],h.value=[],f.value=[],ue()};t({getMapCenter:b,getMapZoom:S,undoPolygonPoint:T,redoPolygonPoint:_,canUndo:D,canRedo:M,getPolygonPointCount:x,completePolygon:C,clearPolygonDrawing:A});const I=O([]);let $=null;const E=O(!0),ie=O(!1),ce=O(new Set),ge=O([]);let re=null,ve=null;const Be=(X,we,De,Se,Ee=!1)=>{const se=De?"36px":Se?"20px":"30px",me=De?"#667eea":"white",ne=Ee?"":Oc(X,we);return`
    <div style="position: relative; width: ${se}; height: ${se};">
      <div style="
        background-color: ${qb};
        width: ${se};
        height: ${se};
        border-radius: 50%;
        border: 3px solid ${me};
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      "></div>
      ${Ee?"":`<div style="position: absolute; bottom: -4px; right: -4px;">
        ${ne}
      </div>`}
    </div>
  `},He=()=>{if(!l)return;const X=Ob(l,I.value),we=Array.from(ce.value).sort().join(","),De=Array.from(X).sort().join(",");we!==De&&(ce.value=X,pe())},Oe=()=>{if(ve&&(ve.remove(),ve=null),!l||!i.userLocation)return;const X=dn.divIcon({className:"user-location-marker",html:`
      <div style="
        position: relative;
        width: 20px;
        height: 20px;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #4285f4;
          border: 3px solid white;
          border-radius: 50%;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        "></div>
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 40px;
          height: 40px;
          background-color: rgba(66, 133, 244, 0.2);
          border-radius: 50%;
          animation: pulse 2s ease-out infinite;
        "></div>
      </div>
    `,iconSize:[40,40],iconAnchor:[20,20]});ve=dn.marker([i.userLocation.lat,i.userLocation.lng],{icon:X}).addTo(l).bindPopup("Your location")},fe=()=>{if(!a.value)return;let X=51.505,we=-.09,De=13;const Se=i.allLocationsForBounds.length>0?i.allLocationsForBounds:i.locations,Ee=(me,ne)=>me!=null&&ne!=null&&!(me===0&&ne===0),se=[];Se.length>0&&se.push(...Se.filter(me=>Ee(me.latitude,me.longitude)).map(me=>({lat:me.latitude,lng:me.longitude}))),i.route&&i.route.length>0&&se.push(...i.route.filter(me=>Ee(me.lat,me.lng)).map(me=>({lat:me.lat,lng:me.lng}))),i.center?(X=i.center.lat,we=i.center.lng,De=i.zoom??13):se.length>0&&(X=se.reduce((me,ne)=>me+ne.lat,0)/se.length,we=se.reduce((me,ne)=>me+ne.lng,0)/se.length,De=10),l=dn.map(a.value).setView([X,we],De),dn.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(l),i.clickable&&l.on("click",me=>{i.drawingMode||s("map-click",{lat:me.latlng.lat,lng:me.latlng.lng})}),l.on("zoomend moveend",()=>{He()}),pe(),q(),j(),Oe(),K()},q=()=>{if($&&($.remove(),$=null),!l||i.route.length===0)return;const X=i.route.map(we=>[we.lat,we.lng]);$=dn.polyline(X,{color:"blue",weight:4,opacity:.7}).addTo(l)},j=()=>{ge.value.forEach(X=>X.remove()),ge.value=[],!(!l||i.areas.length===0)&&i.areas.forEach(X=>{const we=typeof X.polygon=="string"?JSON.parse(X.polygon):X.polygon;if(!we||we.length===0)return;const De=we.map(me=>[me.lat,me.lng]),Se=X.id===i.selectedAreaId,Ee=X.color||"#667eea",se=dn.polygon(De,{color:Ee,fillColor:Ee,fillOpacity:Se?.4:.2,weight:Se?3:2,opacity:.8}).addTo(l);se.setStyle({pane:"overlayPane"}),i.drawingMode||(se.on("click",()=>s("area-click",X)),se.on("mouseover",()=>{se.setStyle({fillOpacity:.4})}),se.on("mouseout",()=>{se.setStyle({fillOpacity:Se?.4:.2})})),ge.value.push(se)})},ue=()=>{if(l&&(p&&(p.remove(),p=null),g&&(g.remove(),g=null),u.value.length!==0&&(g=dn.layerGroup().addTo(l),u.value.forEach((X,we)=>{const De=we===0,Se=we===u.value.length-1,Ee=dn.divIcon({className:"polygon-point-marker",html:`<div style="
        width: ${De?"16px":"12px"};
        height: ${De?"16px":"12px"};
        background-color: ${De?"#667eea":Se?"#ff9800":"white"};
        border: 3px solid #667eea;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      "></div>`,iconSize:[De?16:12,De?16:12],iconAnchor:[De?8:6,De?8:6]});dn.marker([X.lat,X.lng],{icon:Ee,interactive:!1}).addTo(g)}),u.value.length>=2))){const X=u.value.map(we=>[we.lat,we.lng]);u.value.length>=3&&X.push(X[0]),p=dn.polyline(X,{color:"#667eea",weight:3,opacity:.8,dashArray:u.value.length<3?"10, 10":null}).addTo(l)}},K=()=>{if(!l)return;if(re||(re=new dn.FeatureGroup,l.addLayer(re)),l._customDrawingHandlers&&(l.off("click",l._customDrawingHandlers.handleClick),l.getContainer().removeEventListener("touchstart",l._customDrawingHandlers.handleTouchStart),l.getContainer().removeEventListener("touchend",l._customDrawingHandlers.handleTouchEnd),l.getContainer().removeEventListener("touchmove",l._customDrawingHandlers.handleTouchMove),delete l._customDrawingHandlers),!i.drawingMode){A(),re&&re.clearLayers();return}let X=0,we=null,De=!1,Se=!1;const Ee=300,se=15,me=U=>{h.value.push([...u.value]),f.value=[],u.value.push({lat:U.lat,lng:U.lng}),ue(),s("polygon-drawing",u.value)},ne=U=>{U.originalEvent&&U.originalEvent.sourceCapabilities?.firesTouchEvents||me(U.latlng)},de=U=>{if(U.touches.length>1){Se=!0;return}Se=!1,X=Date.now(),we={x:U.touches[0].clientX,y:U.touches[0].clientY},De=!1},Le=U=>{if(!we||Se)return;const Q=U.touches[0].clientX-we.x,Z=U.touches[0].clientY-we.y;Math.sqrt(Q*Q+Z*Z)>se&&(De=!0)},B=U=>{if(Se){Se=!1,we=null;return}if(Date.now()-X<Ee&&!De&&we){const Z=U.changedTouches[0],N=dn.point(Z.clientX-l.getContainer().getBoundingClientRect().left,Z.clientY-l.getContainer().getBoundingClientRect().top),R=l.containerPointToLatLng(N);U.preventDefault(),U.stopPropagation(),me(R)}we=null,De=!1};l.on("click",ne),l.getContainer().addEventListener("touchstart",de,{passive:!0}),l.getContainer().addEventListener("touchmove",Le,{passive:!0}),l.getContainer().addEventListener("touchend",B,{passive:!1}),l._customDrawingHandlers={handleClick:ne,handleTouchStart:de,handleTouchMove:Le,handleTouchEnd:B},ue()},pe=()=>{if(!(l&&l._animatingZoom)&&(I.value.forEach(X=>X.remove()),I.value=[],!!l)){if(i.locations.forEach(X=>{const we=X.latitude??X.Latitude,De=X.longitude??X.Longitude;if(we==null||De==null||we===0&&De===0)return;const Se=X.checkedInCount||0,Ee=X.requiredMarshals||1,se=i.highlightLocationId===X.id||i.highlightLocationIds.includes(X.id),me=i.simplifyNonHighlighted&&!se,ne=X.resolvedStyleType||X.ResolvedStyleType,de=X.resolvedStyleBackgroundColor||X.ResolvedStyleBackgroundColor||X.resolvedStyleColor||X.ResolvedStyleColor,Le=X.resolvedStyleBorderColor||X.ResolvedStyleBorderColor,B=X.resolvedStyleIconColor||X.ResolvedStyleIconColor,U=X.resolvedStyleBackgroundShape||X.ResolvedStyleBackgroundShape,Q=ne&&ne!=="default"||de||Le||B||U&&U!=="circle"&&U!=="default",Z=X.resolvedStyleMapRotation??X.ResolvedStyleMapRotation??X.styleMapRotation??X.StyleMapRotation??0,N=parseInt(Z,10)||0,R=X.areaColor||"#999",J=X.areaId&&!i.marshalMode,xe=ce.value.has(X.id)&&X.description?`${X.name}: ${$p(X.description,50)}`:X.name,Ce=se?`
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid #667eea;
        border-radius: 50%;
        animation: highlight-pulse 1.5s ease-out infinite;
      "></div>
    `:"",ze=se?"#667eea":me?"#e0e0e0":"white",Re=se?"white":me?"#888":"#333";let je;if(me){const ot="20px";je=`
        <div style="
          background-color: #999;
          width: ${ot};
          height: ${ot};
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        "></div>
      `}const Ye=!i.marshalMode,te=Oc(Se,Ee),Y=Ye?`<div style="
      position: absolute;
      bottom: -2px;
      right: -6px;
      background-color: white;
      border-radius: 8px;
      padding: 1px 4px;
      font-size: 9px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    ">${Se}/${Ee}</div>`:"";if(Q){const ot=se?40:32,$t=X.resolvedStyleSize||X.ResolvedStyleSize||"100",Mt=qt({type:X.resolvedStyleType||X.ResolvedStyleType,backgroundShape:X.resolvedStyleBackgroundShape||X.ResolvedStyleBackgroundShape||"circle",backgroundColor:X.resolvedStyleBackgroundColor||X.ResolvedStyleBackgroundColor||X.resolvedStyleColor||X.ResolvedStyleColor||"",borderColor:X.resolvedStyleBorderColor||X.ResolvedStyleBorderColor||"",iconColor:X.resolvedStyleIconColor||X.ResolvedStyleIconColor||"",size:$t});Mt?je=Mt:je=Zb(X.resolvedStyleType,X.resolvedStyleColor,Se,Ee,ot,Ye)||Be(Se,Ee,se,i.marshalMode,!0)}else je=Be(Se,Ee,se,i.marshalMode,!0);const H=N!==0?`transform: rotate(${N}deg);`:"",Fe=dn.divIcon({className:"custom-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
          ${Ce}
          <div style="position: relative; display: flex; align-items: center; gap: 4px;">
            ${J?`<div style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background-color: ${R};
              border: 2px solid white;
              box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            "></div>`:""}
            <div style="position: relative; display: inline-block;">
              <div style="${H}">
                ${je}
              </div>
              ${me?"":`<div style="position: absolute; top: -4px; right: -4px;">
                ${te}
              </div>`}
              ${me?"":Y}
            </div>
          </div>
          <div style="
            background-color: ${ze};
            padding: 2px 6px;
            border-radius: 3px;
            font-size: ${se?"12px":"11px"};
            font-weight: bold;
            color: ${Re};
            white-space: nowrap;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${xe}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]}),Je=i.marshalMode?`<b>${X.name}</b>${X.description?`<br>${X.description}`:""}`:`<b>${X.name}</b><br>${X.description||""}<br>Checked in: ${Se}/${Ee}`,Qe=dn.marker([X.latitude,X.longitude],{icon:Fe}).addTo(l).bindPopup(Je);Qe.on("click",()=>{s("location-click",X)}),Qe.locationData=X,I.value.push(Qe)}),l&&E.value&&!i.center&&!ie.value){const X=[],we=i.allLocationsForBounds.length>0?i.allLocationsForBounds:i.locations,De=(Se,Ee)=>Se!=null&&Ee!=null&&!(Se===0&&Ee===0);if(we.length>0&&X.push(...we.filter(Se=>De(Se.latitude,Se.longitude)).map(Se=>[Se.latitude,Se.longitude])),i.route.length>0&&X.push(...i.route.filter(Se=>De(Se.lat,Se.lng)).map(Se=>[Se.lat,Se.lng])),X.length>0){const Se=dn.latLngBounds(X);l.fitBounds(Se,{padding:[50,50]}),E.value=!1,ie.value=!0}}else i.center&&(E.value=!1);setTimeout(()=>{l&&!l._animatingZoom&&He()},100)}};return rn(()=>{ie.value=!1,E.value=!0,fe();let X,we=0,De=0;const Se=new ResizeObserver(Ee=>{if(l&&Ee.length>0){const{width:se,height:me}=Ee[0].contentRect;(Math.abs(se-we)>10||Math.abs(me-De)>10)&&(we=se,De=me,clearTimeout(X),X=setTimeout(()=>{l.invalidateSize()},150))}});a.value&&Se.observe(a.value),fo(()=>{clearTimeout(X),Se.disconnect()})}),Ke(()=>i.locations,X=>{if(pe(),l&&!ie.value&&X.length>0&&!i.center){const we=X.map(se=>se.latitude),De=X.map(se=>se.longitude),Se=we.reduce((se,me)=>se+me,0)/we.length,Ee=De.reduce((se,me)=>se+me,0)/De.length;l.setView([Se,Ee],10),ie.value=!0,E.value=!1}},{deep:!0}),Ke(()=>i.route,X=>{if(q(),pe(),l&&!ie.value&&X&&X.length>0&&!i.center){const we=X.map(se=>se.lat),De=X.map(se=>se.lng),Se=we.reduce((se,me)=>se+me,0)/we.length,Ee=De.reduce((se,me)=>se+me,0)/De.length;l.setView([Se,Ee],10),ie.value=!0,E.value=!1}},{deep:!0}),Ke(()=>i.center,X=>{l&&l.setView([X.lat,X.lng],i.zoom)}),Ke(()=>i.areas,()=>{j()},{deep:!0}),Ke(()=>i.selectedAreaId,()=>{j()}),Ke(()=>i.drawingMode,()=>{K()}),Ke(()=>i.userLocation,()=>{Oe()},{deep:!0}),Ke(()=>i.highlightLocationId,()=>{pe()}),Ke(()=>i.highlightLocationIds,()=>{pe()},{deep:!0}),Ke(()=>i.marshalMode,()=>{pe()}),Ke(()=>i.simplifyNonHighlighted,()=>{pe()}),Ke(()=>i.clickable,X=>{l&&(l.off("click"),X&&l.on("click",we=>{i.drawingMode||s("map-click",{lat:we.latlng.lat,lng:we.latlng.lng})}))}),(X,we)=>(m(),y("div",{ref_key:"mapContainer",ref:a,class:"map-container"},null,512))}},Ba=Xe(Gb,[["__scopeId","data-v-3487ad9d"]]);function _n(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}const Kb={class:"areas-selection"},Yb={key:0,class:"areas-selection-header"},Jb={class:"areas-list"},Xb=["checked","onChange"],Qb={__name:"AreasSelection",props:{areas:{type:Array,default:()=>[]},selectedAreaIds:{type:Array,default:()=>[]}},emits:["update:selectedAreaIds"],setup(e,{emit:t}){const o=e,i=t,s=ae(()=>[...o.areas].sort((h,f)=>h.displayOrder!==f.displayOrder?h.displayOrder-f.displayOrder:_n(h.name,f.name))),a=ae(()=>o.areas.length>0&&o.selectedAreaIds.length===o.areas.length),l=h=>{const f=[...o.selectedAreaIds],p=f.indexOf(h);p>=0?f.splice(p,1):f.push(h),i("update:selectedAreaIds",f)},u=()=>{a.value?i("update:selectedAreaIds",[]):i("update:selectedAreaIds",o.areas.map(h=>h.id))};return(h,f)=>(m(),y("div",Kb,[e.areas.length>1?(m(),y("div",Yb,[c("button",{onClick:u,class:"toggle-all-btn"},w(a.value?"Deselect all":"Select all"),1)])):F("",!0),c("div",Jb,[(m(!0),y(Te,null,Ne(s.value,p=>(m(),y("label",{class:"area-checkbox",key:p.id},[c("input",{type:"checkbox",checked:e.selectedAreaIds.includes(p.id),onChange:g=>l(p.id)},null,40,Xb),c("span",{class:"area-color-dot",style:Dt({backgroundColor:p.color||"#667eea"})},null,4),We(" "+w(p.name),1)]))),128))])]))}},Ap=Xe(Qb,[["__scopeId","data-v-46364246"]]),ew={class:"course-areas-tab"},tw={class:"map-wrapper"},nw={key:0,class:"drawing-controls"},ow={class:"point-count"},sw={class:"undo-redo-buttons"},iw=["disabled"],aw=["disabled"],rw={key:0},lw={key:1},cw={key:0,class:"filters-content"},uw={class:"filter-section"},dw={class:"filter-checkbox"},hw={class:"filter-checkbox"},fw={class:"filter-checkbox"},pw={class:"filter-checkbox"},vw={class:"filter-checkbox"},mw={key:0,class:"filter-section"},gw={key:0},yw={key:1},_w={key:0,class:"add-menu-content"},kw={__name:"CourseAreasTab",props:{checkpoints:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1}},emits:["map-click","location-click","area-click","import-checkpoints","upload-route","select-location","add-area","select-area","polygon-complete","cancel-drawing","add-checkpoint-from-map","add-many-checkpoints-from-map","add-area-from-map"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=yt(),a=e,l=o,u=O(null),h=O(null),f=O(!0),p=O(!1),g=O(null),b=O(0),S=O(!1),T=O(!1),_=O({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreas:[]}),D=()=>{f.value=!f.value,f.value||(p.value=!1)},M=()=>{p.value=!p.value,p.value&&(f.value=!0)},x=fe=>{p.value=!1,fe==="checkpoint"?(l("add-checkpoint-from-map"),ce()):fe==="many-checkpoints"?(l("add-many-checkpoints-from-map"),ce()):fe==="area"&&(l("add-area-from-map"),ce())},C=()=>{p.value=!1,l("import-checkpoints")},A=()=>{p.value=!1,l("upload-route")},I=fe=>{b.value=fe?.length||0,$()},$=()=>{h.value&&(S.value=h.value.canUndo(),T.value=h.value.canRedo())},E=()=>{h.value&&(h.value.undoPolygonPoint(),$())},ie=()=>{h.value&&(h.value.redoPolygonPoint(),$())},ce=()=>{u.value&&u.value.scrollIntoView({behavior:"smooth",block:"start"})};t({scrollMapIntoView:ce,getMapCenter:()=>h.value?.getMapCenter()||null,getMapZoom:()=>h.value?.getMapZoom()||null}),Ke(()=>a.areas,fe=>{if(fe.length>0){const q=new Set(_.value.selectedAreas);fe.forEach(j=>{q.has(j.id)||_.value.selectedAreas.push(j.id)}),_.value.selectedAreas=_.value.selectedAreas.filter(j=>fe.some(ue=>ue.id===j))}},{immediate:!0}),Ke(()=>a.drawingMode,fe=>{fe||(b.value=0,S.value=!1,T.value=!1)}),ae(()=>[...a.areas].sort((fe,q)=>fe.displayOrder!==q.displayOrder?fe.displayOrder-q.displayOrder:_n(fe.name,q.name)));const ve=ae(()=>_.value.showRoute?a.route:[]),Be=fe=>{const q=fe.checkedInCount||0,j=fe.requiredMarshals||1;return q===0?"unchecked":q>=j?"full":"partial"},He=ae(()=>!_.value.showUncheckedIn&&!_.value.showPartiallyCheckedIn&&!_.value.showFullyCheckedIn?[]:a.checkpoints.filter(fe=>{const q=Be(fe);if(q==="unchecked"&&!_.value.showUncheckedIn||q==="partial"&&!_.value.showPartiallyCheckedIn||q==="full"&&!_.value.showFullyCheckedIn)return!1;const j=fe.areaIds||fe.AreaIds;return j&&Array.isArray(j)?j.some(ue=>_.value.selectedAreas.includes(ue)):fe.areaId?_.value.selectedAreas.includes(fe.areaId):!1})),Oe=ae(()=>_.value.showAreas?a.areas.filter(fe=>_.value.selectedAreas.includes(fe.id)):[]);return(fe,q)=>(m(),y("div",ew,[c("div",{class:"map-section",ref_key:"mapSection",ref:u},[c("div",tw,[Ve(Ba,{ref_key:"mapView",ref:h,locations:He.value,route:ve.value,areas:Oe.value,"all-locations-for-bounds":e.checkpoints,"selected-area-id":e.selectedAreaId,clickable:!0,"drawing-mode":e.drawingMode,onMapClick:q[0]||(q[0]=j=>fe.$emit("map-click",j)),onLocationClick:q[1]||(q[1]=j=>fe.$emit("location-click",j)),onAreaClick:q[2]||(q[2]=j=>fe.$emit("area-click",j)),onPolygonComplete:q[3]||(q[3]=j=>fe.$emit("polygon-complete",j)),onPolygonDrawing:I},null,8,["locations","route","areas","all-locations-for-bounds","selected-area-id","drawing-mode"]),e.drawingMode&&b.value>0?(m(),y("div",nw,[c("div",ow,w(b.value)+" point"+w(b.value!==1?"s":""),1),c("div",sw,[c("button",{onClick:E,class:"btn-drawing undo-btn",disabled:!S.value,title:"Undo last point"},"  Undo ",8,iw),c("button",{onClick:ie,class:"btn-drawing redo-btn",disabled:!T.value,title:"Redo point"}," Redo  ",8,aw)])])):F("",!0)]),p.value?F("",!0):(m(),y("div",{key:0,class:Ae(["visibility-filters",{collapsed:f.value}])},[c("button",{onClick:D,class:"filters-toggle"},[f.value?(m(),y("span",rw,"Show...")):(m(),y("span",lw,""))]),f.value?F("",!0):(m(),y("div",cw,[c("div",uw,[q[13]||(q[13]=c("h4",null,"Show on map:",-1)),c("label",dw,[Ze(c("input",{type:"checkbox","onUpdate:modelValue":q[4]||(q[4]=j=>_.value.showRoute=j)},null,512),[[us,_.value.showRoute]]),We(" "+w(V(i).course),1)]),c("label",hw,[Ze(c("input",{type:"checkbox","onUpdate:modelValue":q[5]||(q[5]=j=>_.value.showUncheckedIn=j)},null,512),[[us,_.value.showUncheckedIn]]),We(" Unchecked-in "+w(V(s).checkpoints),1)]),c("label",fw,[Ze(c("input",{type:"checkbox","onUpdate:modelValue":q[6]||(q[6]=j=>_.value.showPartiallyCheckedIn=j)},null,512),[[us,_.value.showPartiallyCheckedIn]]),We(" Partially checked-in "+w(V(s).checkpoints),1)]),c("label",pw,[Ze(c("input",{type:"checkbox","onUpdate:modelValue":q[7]||(q[7]=j=>_.value.showFullyCheckedIn=j)},null,512),[[us,_.value.showFullyCheckedIn]]),We(" Fully checked-in "+w(V(s).checkpoints),1)]),c("label",vw,[Ze(c("input",{type:"checkbox","onUpdate:modelValue":q[8]||(q[8]=j=>_.value.showAreas=j)},null,512),[[us,_.value.showAreas]]),We(" "+w(V(i).areas),1)])]),e.areas.length>0&&_.value.showAreas?(m(),y("div",mw,[c("h4",null,"Filter "+w(V(s).areas)+":",1),Ve(Ap,{areas:e.areas,"selected-area-ids":_.value.selectedAreas,"onUpdate:selectedAreaIds":q[9]||(q[9]=j=>_.value.selectedAreas=j)},null,8,["areas","selected-area-ids"])])):F("",!0)]))],2)),f.value?(m(),y("div",{key:1,class:Ae(["add-menu",{expanded:p.value}])},[c("button",{onClick:M,class:"add-toggle",ref_key:"addButtonRef",ref:g},[p.value?(m(),y("span",gw,"")):(m(),y("span",yw,"Add..."))],512),p.value?(m(),y("div",_w,[c("button",{onClick:q[10]||(q[10]=j=>x("checkpoint")),class:"add-menu-item"}," Checkpoint "),c("button",{onClick:q[11]||(q[11]=j=>x("many-checkpoints")),class:"add-menu-item"}," Many checkpoints "),c("button",{onClick:q[12]||(q[12]=j=>x("area")),class:"add-menu-item"}," Area "),c("button",{onClick:C,class:"add-menu-item"}," Import checkpoints... "),c("button",{onClick:A,class:"add-menu-item"}," Upload route... ")])):F("",!0)],2)):F("",!0)],512)]))}},bw=Xe(kw,[["__scopeId","data-v-08ee7bde"]]),ww=(e,t)=>{const o=String(e).trim(),i=String(t).trim(),s=parseFloat(o),a=parseFloat(i),l=!isNaN(s)&&String(s)===o,u=!isNaN(a)&&String(a)===i;return l&&u?s-a:o.localeCompare(i,void 0,{numeric:!0,sensitivity:"base"})},Cw=e=>e&&e.isCheckedIn?"":"",Lw={class:"marshals-tab"},Sw={class:"marshals-tab-header"},xw={class:"button-group"},Tw={class:"marshals-grid"},Iw={class:"marshals-table"},$w={key:0,class:"sort-indicator"},Mw={key:0,class:"sort-indicator"},Aw={key:0,class:"sort-indicator"},Ew={key:0,class:"sort-indicator"},Pw=["onClick"],Dw=["rowspan"],Ow=["value","onChange"],Rw=["rowspan"],Bw={key:0,class:"last-active-text"},Nw={key:1,class:"last-active-never"},Fw=["onClick"],zw={style:{color:"#999","font-style":"italic"}},Uw={class:"hide-on-mobile last-active-cell"},Hw={key:0,class:"last-active-text"},Vw={key:1,class:"last-active-never"},Zw={__name:"MarshalsTab",props:{marshals:{type:Array,required:!0},assignments:{type:Array,required:!0},locations:{type:Array,required:!0}},emits:["add-marshal","import-marshals","select-marshal","delete-marshal","change-assignment-status"],setup(e,{emit:t}){const{terms:o}=yt(),i=e,s=O("name"),a=O("asc"),l=S=>{s.value===S?a.value=a.value==="asc"?"desc":"asc":(s.value=S,a.value="asc")},u=S=>i.assignments.filter(T=>T.marshalId===S),h=S=>{const T=i.locations.find(_=>_.id===S);return T?T.name:"Unknown"},f=S=>{if(!S)return"";const T=new Date(S),D=new Date-T,M=Math.floor(D/6e4),x=Math.floor(M/60),C=Math.floor(x/24);return M<1?"just now":M<60?`${M}m ago`:x<24?`${x}h ago`:C===1?"yesterday":C<7?`${C}d ago`:T.toLocaleDateString()},p=ae(()=>{const S=[...i.marshals];return S.sort((T,_)=>{let D=0;if(s.value==="name")D=T.name.localeCompare(_.name);else if(s.value==="checkpoint"){const M=u(T.id),x=u(_.id),C=M.length>0?h(M[0].locationId):"",A=x.length>0?h(x[0].locationId):"";D=ww(C,A)}else if(s.value==="status"){const M=u(T.id),x=u(_.id),C=M.length>0&&M[0].isCheckedIn?1:0;D=(x.length>0&&x[0].isCheckedIn?1:0)-C}else if(s.value==="lastActive"){const M=T.lastAccessedDate?new Date(T.lastAccessedDate).getTime():0;D=(_.lastAccessedDate?new Date(_.lastAccessedDate).getTime():0)-M}return a.value==="asc"?D:-D}),S}),g=S=>S.isAdminCheckedIn?"admin-checked-in":S.isWrongLocation?"wrong-location":S.isCheckedIn?"checked-in":"not-checked-in",b=S=>S.isCheckedIn?"status-checked-in":"status-not-checked-in";return(S,T)=>(m(),y("div",Lw,[c("div",Sw,[c("h2",null,w(V(o).people)+" management",1),c("div",xw,[c("button",{onClick:T[0]||(T[0]=_=>S.$emit("add-marshal")),class:"btn btn-primary"}," Add "+w(V(o).person.toLowerCase()),1),c("button",{onClick:T[1]||(T[1]=_=>S.$emit("import-marshals")),class:"btn btn-secondary"}," Import CSV ")])]),c("div",Tw,[c("table",Iw,[c("thead",null,[c("tr",null,[c("th",{onClick:T[2]||(T[2]=_=>l("name")),class:"sortable"},[T[7]||(T[7]=We(" Name ",-1)),s.value==="name"?(m(),y("span",$w,w(a.value==="asc"?"":""),1)):F("",!0)]),c("th",{onClick:T[3]||(T[3]=_=>l("checkpoint")),class:"sortable"},[We(w(V(o).checkpoint)+" ",1),s.value==="checkpoint"?(m(),y("span",Mw,w(a.value==="asc"?"":""),1)):F("",!0)]),c("th",{onClick:T[4]||(T[4]=_=>l("status")),class:"sortable"},[T[8]||(T[8]=We(" Status ",-1)),s.value==="status"?(m(),y("span",Aw,w(a.value==="asc"?"":""),1)):F("",!0)]),c("th",{onClick:T[5]||(T[5]=_=>l("lastActive")),class:"sortable hide-on-mobile"},[T[9]||(T[9]=We(" Last active ",-1)),s.value==="lastActive"?(m(),y("span",Ew,w(a.value==="asc"?"":""),1)):F("",!0)])])]),c("tbody",null,[(m(!0),y(Te,null,Ne(p.value,_=>(m(),y(Te,{key:_.id},[u(_.id).length>0?(m(!0),y(Te,{key:0},Ne(u(_.id),(D,M)=>(m(),y("tr",{key:`${_.id}-${D.id}`,class:"marshal-row",onClick:x=>S.$emit("select-marshal",_)},[M===0?(m(),y("td",{key:0,rowspan:u(_.id).length},w(_.name),9,Dw)):F("",!0),c("td",null,w(h(D.locationId)),1),c("td",{onClick:T[6]||(T[6]=St(()=>{},["stop"]))},[c("select",{value:g(D),onChange:x=>S.$emit("change-assignment-status",{assignment:D,status:x.target.value}),class:Ae(["status-select hide-on-mobile",b(D)])},[...T[10]||(T[10]=[c("option",{value:"not-checked-in"},"Not checked-in",-1),c("option",{value:"checked-in"},"Checked-in",-1),c("option",{value:"admin-checked-in"},"Admin checked-in",-1),c("option",{value:"wrong-location"},"Checked-in but not at correct location",-1)])],42,Ow),c("span",{class:Ae(["status-icon show-on-mobile",b(D)])},w(V(Cw)(D)),3)]),M===0?(m(),y("td",{key:1,rowspan:u(_.id).length,class:"hide-on-mobile last-active-cell"},[_.lastAccessedDate?(m(),y("span",Bw,w(f(_.lastAccessedDate)),1)):(m(),y("span",Nw,"Never"))],8,Rw)):F("",!0)],8,Pw))),128)):(m(),y("tr",{key:1,class:"marshal-row",onClick:D=>S.$emit("select-marshal",_)},[c("td",null,w(_.name),1),c("td",zw,"No "+w(V(o).checkpoint.toLowerCase())+" assigned",1),T[11]||(T[11]=c("td",null,[c("span",{class:"hide-on-mobile"},"-"),c("span",{class:"status-icon show-on-mobile",style:{color:"#999"}},"-")],-1)),c("td",Uw,[_.lastAccessedDate?(m(),y("span",Hw,w(f(_.lastAccessedDate)),1)):(m(),y("span",Vw,"Never"))])],8,Fw))],64))),128))])])])]))}},jw=Xe(Zw,[["__scopeId","data-v-2155fb8d"]]),Ww={class:"checklists-tab"},qw={class:"checklists-tab-header"},Gw={class:"button-group"},Kw={class:"filters-section"},Yw={class:"filter-group"},Jw={class:"filter-checkbox"},Xw=["checked"],Qw={key:0,class:"checkbox-dropdown"},e0={class:"checkbox-dropdown-header"},t0={class:"checkbox-list"},n0=["checked","onChange"],o0={class:"filter-group"},s0={class:"filter-checkbox"},i0=["checked"],a0={key:0,class:"checkbox-dropdown"},r0={class:"checkbox-dropdown-header"},l0={class:"checkbox-list"},c0=["checked","onChange"],u0={class:"filter-group"},d0={class:"filter-checkbox"},h0=["checked"],f0={key:0,class:"checkbox-dropdown"},p0={class:"checkbox-dropdown-header"},v0={class:"checkbox-list"},m0=["checked","onChange"],g0={class:"checklist-items-list"},y0={key:0,class:"empty-state"},_0={class:"checklist-item-content"},k0=["onClick"],b0={class:"checklist-item-scopes"},w0=["onClick"],C0={__name:"ChecklistsTab",props:{checklistItems:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},completionReport:{type:Object,default:null}},emits:["add-checklist-item","select-checklist-item"],setup(e,{emit:t}){const{terms:o,termsLower:i}=yt(),s=e,a=O(!0),l=O(!0),u=O(!0),h=O([]),f=O([]),p=O([]),g=ae(()=>[...s.areas].sort((ue,K)=>ue.displayOrder!==K.displayOrder?ue.displayOrder-K.displayOrder:_n(ue.name,K.name))),b=ae(()=>[...s.locations].sort((ue,K)=>_n(ue.name,K.name))),S=ae(()=>[...s.marshals].sort((ue,K)=>_n(ue.name,K.name))),T=ae(()=>s.areas.length>0&&h.value.length===s.areas.length),_=ae(()=>s.locations.length>0&&f.value.length===s.locations.length),D=ae(()=>s.marshals.length>0&&p.value.length===s.marshals.length),M=ae(()=>!a.value||!l.value||!u.value),x=()=>{a.value=!a.value,!a.value&&h.value.length===0&&(h.value=s.areas.map(ue=>ue.id))},C=()=>{l.value=!l.value,!l.value&&f.value.length===0&&(f.value=s.locations.map(ue=>ue.id))},A=()=>{u.value=!u.value,!u.value&&p.value.length===0&&(p.value=s.marshals.map(ue=>ue.id))},I=ue=>{const K=h.value.indexOf(ue);K>=0?h.value.splice(K,1):h.value.push(ue)},$=ue=>{const K=f.value.indexOf(ue);K>=0?f.value.splice(K,1):f.value.push(ue)},E=ue=>{const K=p.value.indexOf(ue);K>=0?p.value.splice(K,1):p.value.push(ue)},ie=()=>{T.value?h.value=[]:h.value=s.areas.map(ue=>ue.id)},ce=()=>{_.value?f.value=[]:f.value=s.locations.map(ue=>ue.id)},ge=()=>{D.value?p.value=[]:p.value=s.marshals.map(ue=>ue.id)},re=()=>{a.value=!0,l.value=!0,u.value=!0,h.value=[],f.value=[],p.value=[]},ve=ue=>{const K=s.marshals.find(pe=>pe.id===ue);return!K||!K.assignments?[]:K.assignments.map(pe=>pe.locationId)},Be=ue=>{const K=new Set;return ue.forEach(pe=>{const X=s.locations.find(we=>we.id===pe);X&&X.areaIds&&X.areaIds.forEach(we=>K.add(we))}),Array.from(K)},He=(ue,K)=>{if(!K)return!1;const pe=ve(ue),X=Be(pe);return K.scope==="SpecificPeople"&&K.itemType==="Marshal"?K.ids.includes(ue)||K.ids.includes("ALL_MARSHALS"):K.scope==="EveryoneAtCheckpoints"&&K.itemType==="Checkpoint"?K.ids.includes("ALL_CHECKPOINTS")||pe.some(we=>K.ids.includes(we)):K.scope==="OnePerCheckpoint"&&K.itemType==="Checkpoint"?K.ids.includes("ALL_CHECKPOINTS")||pe.some(we=>K.ids.includes(we)):K.scope==="OnePerCheckpoint"&&K.itemType==="Area"?K.ids.includes("ALL_AREAS")||X.some(we=>K.ids.includes(we)):K.scope==="EveryoneInAreas"&&K.itemType==="Area"?K.ids.includes("ALL_AREAS")||X.some(we=>K.ids.includes(we)):K.scope==="OnePerArea"&&K.itemType==="Area"?K.ids.includes("ALL_AREAS")||X.some(we=>K.ids.includes(we)):(K.scope==="EveryAreaLead"||K.scope==="OneLeadPerArea")&&K.itemType==="Area"?K.ids.includes("ALL_AREAS")||X.some(we=>K.ids.includes(we)):!1},Oe=ae(()=>{let ue=s.checklistItems;return!a.value&&h.value.length>0&&(ue=ue.filter(K=>K.scopeConfigurations?K.scopeConfigurations.some(pe=>pe.itemType==="Area"&&h.value.some(X=>pe.ids.includes(X))):!1)),!l.value&&f.value.length>0&&(ue=ue.filter(K=>K.scopeConfigurations?K.scopeConfigurations.some(pe=>pe.itemType==="Checkpoint"&&f.value.some(X=>pe.ids.includes(X))):!1)),!u.value&&p.value.length>0&&(ue=ue.filter(K=>K.scopeConfigurations?p.value.some(pe=>K.scopeConfigurations.some(X=>He(pe,X))):!1)),ue}),fe=ae(()=>[...Oe.value].sort((ue,K)=>ue.displayOrder!==K.displayOrder?ue.displayOrder-K.displayOrder:_n(ue.text,K.text))),q=ue=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${i.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${i.value.checkpoints}`,SpecificPeople:`Specific ${i.value.people}`,OnePerArea:`One per ${i.value.area}`,OnePerCheckpoint:`One per ${i.value.checkpoint}`,EveryAreaLead:`Every ${i.value.area} lead`,OneLeadPerArea:`One lead per ${i.value.area}`,AreaLead:`${o.value.area} lead`})[ue]||ue,j=ue=>{if(!ue)return"";const K=q(ue.scope);if(ue.itemType===null)return K;const pe=ue.ids||[];if(pe.includes("ALL_MARSHALS"))return`${K} (Everyone)`;if(pe.includes("ALL_AREAS"))return`${K} (All ${i.value.areas})`;if(pe.includes("ALL_CHECKPOINTS"))return`${K} (All ${i.value.checkpoints})`;const X=pe.length;return X===0?K:`${K} (${X})`};return(ue,K)=>(m(),y("div",Ww,[c("div",qw,[c("h2",null,w(V(o).checklists),1),c("div",Gw,[c("button",{onClick:K[0]||(K[0]=pe=>ue.$emit("add-checklist-item")),class:"btn btn-primary"}," Add "+w(V(i).checklist),1)])]),c("div",Kw,[c("div",Yw,[c("h4",null,"Filter by "+w(V(i).area)+":",1),c("label",Jw,[c("input",{type:"checkbox",checked:a.value,onChange:x},null,40,Xw),We(" All "+w(V(i).areas),1)]),a.value?F("",!0):(m(),y("div",Qw,[c("div",e0,[c("button",{onClick:ie,class:"toggle-all-btn"},w(T.value?"Deselect all":"Select all"),1)]),c("div",t0,[(m(!0),y(Te,null,Ne(g.value,pe=>(m(),y("label",{key:pe.id,class:"checkbox-item"},[c("input",{type:"checkbox",checked:h.value.includes(pe.id),onChange:X=>I(pe.id)},null,40,n0),c("span",{class:"area-color-dot",style:Dt({backgroundColor:pe.color||"#667eea"})},null,4),We(" "+w(pe.name),1)]))),128))])]))]),c("div",o0,[c("h4",null,"Filter by "+w(V(i).checkpoint)+":",1),c("label",s0,[c("input",{type:"checkbox",checked:l.value,onChange:C},null,40,i0),We(" All "+w(V(i).checkpoints),1)]),l.value?F("",!0):(m(),y("div",a0,[c("div",r0,[c("button",{onClick:ce,class:"toggle-all-btn"},w(_.value?"Deselect all":"Select all"),1)]),c("div",l0,[(m(!0),y(Te,null,Ne(b.value,pe=>(m(),y("label",{key:pe.id,class:"checkbox-item"},[c("input",{type:"checkbox",checked:f.value.includes(pe.id),onChange:X=>$(pe.id)},null,40,c0),We(" "+w(pe.name),1)]))),128))])]))]),c("div",u0,[c("h4",null,"Filter by "+w(V(i).person)+":",1),c("label",d0,[c("input",{type:"checkbox",checked:u.value,onChange:A},null,40,h0),We(" All "+w(V(i).people),1)]),u.value?F("",!0):(m(),y("div",f0,[c("div",p0,[c("button",{onClick:ge,class:"toggle-all-btn"},w(D.value?"Deselect all":"Select all"),1)]),c("div",v0,[(m(!0),y(Te,null,Ne(S.value,pe=>(m(),y("label",{key:pe.id,class:"checkbox-item"},[c("input",{type:"checkbox",checked:p.value.includes(pe.id),onChange:X=>E(pe.id)},null,40,m0),We(" "+w(pe.name),1)]))),128))])]))]),M.value?(m(),y("button",{key:0,onClick:re,class:"btn btn-secondary btn-small"}," Clear filters ")):F("",!0)]),c("div",g0,[Oe.value.length===0?(m(),y("div",y0,[c("p",null,w(M.value?"No checklist items match the selected filters.":"No checklist items yet. Create one to get started!"),1)])):F("",!0),(m(!0),y(Te,null,Ne(fe.value,pe=>(m(),y("div",{key:pe.itemId,class:"checklist-item-card"},[c("div",_0,[c("div",{class:"checklist-item-title",onClick:X=>ue.$emit("select-checklist-item",pe,"details")},[c("strong",null,w(pe.text),1)],8,k0),c("div",b0,[(m(!0),y(Te,null,Ne(pe.scopeConfigurations,(X,we)=>(m(),y("span",{key:we,class:"scope-badge",onClick:De=>ue.$emit("select-checklist-item",pe,"visibility")},w(j(X)),9,w0))),128))])])]))),128))])]))}},L0=Xe(C0,[["__scopeId","data-v-5b51ce47"]]),S0={class:"notes-tab"},x0={class:"notes-tab-header"},T0={class:"button-group"},I0={class:"filters-section"},$0={class:"filter-group"},M0={class:"priority-filters"},A0=["checked","onChange"],E0={class:"filter-group"},P0={class:"filter-checkbox"},D0=["checked"],O0={key:0,class:"checkbox-dropdown"},R0={class:"checkbox-list"},B0=["checked","onChange"],N0={class:"notes-list"},F0={key:0,class:"empty-state"},z0=["onClick"],U0={class:"note-header"},H0={class:"note-title-row"},V0={key:0,class:"pin-icon",title:"Pinned"},Z0={class:"note-meta"},j0={key:0,class:"category-badge"},W0={class:"created-info"},q0={key:0,class:"note-preview"},G0={class:"note-scopes"},K0={__name:"NotesTab",props:{notes:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["add-note","select-note"],setup(e,{emit:t}){const{termsLower:o}=yt(),i=e,s=[{value:"Urgent",label:"Urgent"},{value:"High",label:"High"},{value:"Normal",label:"Normal"},{value:"Low",label:"Low"}],a=O(!0),l=O([]),u=O(["Urgent","High","Normal","Low"]),h=ae(()=>[...i.areas].sort((A,I)=>A.displayOrder!==I.displayOrder?A.displayOrder-I.displayOrder:_n(A.name,I.name))),f=ae(()=>!a.value||u.value.length<4),p=()=>{a.value=!a.value,!a.value&&l.value.length===0&&(l.value=i.areas.map(A=>A.id))},g=A=>{const I=l.value.indexOf(A);I>=0?l.value.splice(I,1):l.value.push(A)},b=A=>{const I=u.value.indexOf(A);I>=0?u.value.splice(I,1):u.value.push(A)},S=()=>{a.value=!0,l.value=[],u.value=["Urgent","High","Normal","Low"]},T=ae(()=>{let A=i.notes;return u.value.length<4&&(A=A.filter(I=>u.value.includes(I.priority||"Normal"))),!a.value&&l.value.length>0&&(A=A.filter(I=>I.scopeConfigurations?I.scopeConfigurations.some($=>$.itemType==="Area"&&l.value.some(E=>$.ids.includes(E))):!1)),A}),_=ae(()=>{const A={Urgent:0,High:1,Normal:2,Low:3};return[...T.value].sort((I,$)=>{if(I.isPinned!==$.isPinned)return I.isPinned?-1:1;const E=A[I.priority]??2,ie=A[$.priority]??2;return E!==ie?E-ie:I.displayOrder!==$.displayOrder?I.displayOrder-$.displayOrder:_n(I.title,$.title)})}),D=A=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${o.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${o.value.checkpoints}`,SpecificPeople:`Specific ${o.value.people}`,EveryAreaLead:`Every ${o.value.area} lead`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,OnePerArea:`One per ${o.value.area}`,OneLeadPerArea:`One lead per ${o.value.area}`})[A]||A,M=A=>{if(!A)return"";const I=D(A.scope);if(A.itemType===null)return I;const $=A.ids||[];if($.includes("ALL_MARSHALS"))return`${I} (Everyone)`;if($.includes("ALL_AREAS"))return`${I} (All ${o.value.areas})`;if($.includes("ALL_CHECKPOINTS"))return`${I} (All ${o.value.checkpoints})`;const E=$.length;return E===0?I:`${I} (${E})`},x=A=>{if(!A)return"";const I=150;return A.length<=I?A:A.substring(0,I)+"..."},C=A=>{if(!A)return"";const I=new Date(A),E=new Date-I,ie=Math.floor(E/6e4),ce=Math.floor(E/36e5),ge=Math.floor(E/864e5);return ie<1?"Just now":ie<60?`${ie}m ago`:ce<24?`${ce}h ago`:ge<7?`${ge}d ago`:I.toLocaleDateString()};return(A,I)=>(m(),y("div",S0,[c("div",x0,[I[1]||(I[1]=c("h2",null,"Notes",-1)),c("div",T0,[c("button",{onClick:I[0]||(I[0]=$=>A.$emit("add-note")),class:"btn btn-primary"}," Add note ")])]),c("div",I0,[c("div",$0,[I[2]||(I[2]=c("h4",null,"Filter by priority:",-1)),c("div",M0,[(m(),y(Te,null,Ne(s,$=>c("label",{key:$.value,class:"filter-checkbox"},[c("input",{type:"checkbox",checked:u.value.includes($.value),onChange:E=>b($.value)},null,40,A0),c("span",{class:Ae(["priority-dot",$.value.toLowerCase()])},null,2),We(" "+w($.label),1)])),64))])]),c("div",E0,[I[4]||(I[4]=c("h4",null,"Filter by area:",-1)),c("label",P0,[c("input",{type:"checkbox",checked:a.value,onChange:p},null,40,D0),I[3]||(I[3]=We(" All areas ",-1))]),a.value?F("",!0):(m(),y("div",O0,[c("div",R0,[(m(!0),y(Te,null,Ne(h.value,$=>(m(),y("label",{key:$.id,class:"checkbox-item"},[c("input",{type:"checkbox",checked:l.value.includes($.id),onChange:E=>g($.id)},null,40,B0),c("span",{class:"area-color-dot",style:Dt({backgroundColor:$.color||"#667eea"})},null,4),We(" "+w($.name),1)]))),128))])]))]),f.value?(m(),y("button",{key:0,onClick:S,class:"btn btn-secondary btn-small"}," Clear filters ")):F("",!0)]),c("div",N0,[T.value.length===0?(m(),y("div",F0,[c("p",null,w(f.value?"No notes match the selected filters.":"No notes yet. Create one to get started!"),1)])):F("",!0),(m(!0),y(Te,null,Ne(_.value,$=>(m(),y("div",{key:$.noteId,class:Ae(["note-card",{pinned:$.isPinned}]),onClick:E=>A.$emit("select-note",$)},[c("div",U0,[c("div",H0,[$.isPinned?(m(),y("span",V0,"")):F("",!0),c("span",{class:Ae(["priority-indicator",$.priority?.toLowerCase()||"normal"])},null,2),c("strong",null,w($.title),1)]),c("div",Z0,[$.category?(m(),y("span",j0,w($.category),1)):F("",!0),c("span",W0,w(C($.createdAt)),1)])]),$.content?(m(),y("div",q0,w(x($.content)),1)):F("",!0),c("div",G0,[(m(!0),y(Te,null,Ne($.scopeConfigurations,(E,ie)=>(m(),y("span",{key:ie,class:"scope-badge"},w(M(E)),1))),128))])],10,z0))),128))])]))}},Y0=Xe(K0,[["__scopeId","data-v-f0d2cbb3"]]),J0={class:"contacts-tab"},X0={class:"contacts-tab-header"},Q0={class:"button-group"},eC={class:"filters-section"},tC={class:"filter-group"},nC={class:"filter-checkbox"},oC=["checked"],sC={key:0,class:"checkbox-dropdown"},iC={class:"checkbox-list"},aC=["checked","onChange"],rC={class:"contacts-list"},lC={key:0,class:"empty-state"},cC=["onClick"],uC={class:"contact-header"},dC={class:"contact-title-row"},hC={key:0,class:"primary-badge",title:"Primary contact"},fC={class:"role-badge"},pC={class:"contact-details"},vC={key:0,class:"contact-phone"},mC={key:1,class:"contact-email"},gC={key:0,class:"contact-notes"},yC={class:"contact-scopes"},_C={__name:"ContactsTab",props:{contacts:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})}},emits:["add-contact","select-contact"],setup(e,{emit:t}){const{termsLower:o}=yt(),i=e,s=O(!0),a=O([]),l=ae(()=>{const M=new Set([...i.availableRoles.builtInRoles||[],...i.availableRoles.customRoles||[],...i.contacts.map(x=>x.role)]);return Array.from(M).sort()}),u=ae(()=>!s.value),h=()=>{s.value=!s.value,!s.value&&a.value.length===0&&(a.value=[...l.value])},f=M=>{const x=a.value.indexOf(M);x>=0?a.value.splice(x,1):a.value.push(M)},p=()=>{s.value=!0,a.value=[]},g=ae(()=>{let M=i.contacts;return!s.value&&a.value.length>0&&(M=M.filter(x=>a.value.includes(x.role))),M}),b=ae(()=>[...g.value].sort((M,x)=>{if(M.isPrimary!==x.isPrimary)return M.isPrimary?-1:1;const C=M.role.localeCompare(x.role);return C!==0?C:M.displayOrder!==x.displayOrder?M.displayOrder-x.displayOrder:_n(M.name,x.name)})),S=M=>M?M==="AreaLead"?`${o.value.area.charAt(0).toUpperCase()+o.value.area.slice(1)} Lead`:M.replace(/([A-Z])/g," $1").replace(/^./,x=>x.toUpperCase()).trim():"",T=M=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${o.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${o.value.checkpoints}`,SpecificPeople:`Specific ${o.value.people}`,EveryAreaLead:`Every ${o.value.area} lead`})[M]||M,_=M=>{if(!M)return"";const x=T(M.scope);if(M.itemType===null)return x;const C=M.ids||[];if(C.includes("ALL_MARSHALS"))return`${x} (Everyone)`;if(C.includes("ALL_AREAS"))return`${x} (All ${o.value.areas})`;if(C.includes("ALL_CHECKPOINTS"))return`${x} (All ${o.value.checkpoints})`;const A=C.length;return A===0?x:`${x} (${A})`},D=M=>{if(!M)return"";const x=100;return M.length<=x?M:M.substring(0,x)+"..."};return(M,x)=>(m(),y("div",J0,[c("div",X0,[x[1]||(x[1]=c("h2",null,"Contacts",-1)),c("div",Q0,[c("button",{onClick:x[0]||(x[0]=C=>M.$emit("add-contact")),class:"btn btn-primary"}," Add contact ")])]),c("div",eC,[c("div",tC,[x[3]||(x[3]=c("h4",null,"Filter by role:",-1)),c("label",nC,[c("input",{type:"checkbox",checked:s.value,onChange:h},null,40,oC),x[2]||(x[2]=We(" All roles ",-1))]),s.value?F("",!0):(m(),y("div",sC,[c("div",iC,[(m(!0),y(Te,null,Ne(l.value,C=>(m(),y("label",{key:C,class:"checkbox-item"},[c("input",{type:"checkbox",checked:a.value.includes(C),onChange:A=>f(C)},null,40,aC),We(" "+w(S(C)),1)]))),128))])]))]),u.value?(m(),y("button",{key:0,onClick:p,class:"btn btn-secondary btn-small"}," Clear filters ")):F("",!0)]),c("div",rC,[g.value.length===0?(m(),y("div",lC,[c("p",null,w(u.value?"No contacts match the selected filters.":"No contacts yet. Create one to get started!"),1)])):F("",!0),(m(!0),y(Te,null,Ne(b.value,C=>(m(),y("div",{key:C.contactId,class:Ae(["contact-card",{primary:C.isPrimary}]),onClick:A=>M.$emit("select-contact",C)},[c("div",uC,[c("div",dC,[C.isPrimary?(m(),y("span",hC,"")):F("",!0),c("strong",null,w(C.name),1),c("span",fC,w(S(C.role)),1)]),c("div",pC,[C.phone?(m(),y("span",vC,w(C.phone),1)):F("",!0),C.email?(m(),y("span",mC,w(C.email),1)):F("",!0)])]),C.notes?(m(),y("div",gC,w(D(C.notes)),1)):F("",!0),c("div",yC,[(m(!0),y(Te,null,Ne(C.scopeConfigurations,(A,I)=>(m(),y("span",{key:I,class:"scope-badge"},w(_(A)),1))),128))])],10,cC))),128))])]))}},kC=Xe(_C,[["__scopeId","data-v-62313ae0"]]),bC={class:"event-details-tab"},wC={class:"event-info-card"},CC={class:"form-group"},LC={class:"form-group"},SC={class:"form-row"},xC={class:"form-group"},TC={class:"form-group"},IC=["value"],$C={class:"form-actions"},MC=["disabled"],AC={__name:"EventDetailsTab",props:{eventData:{type:Object,required:!0},formDirty:{type:Boolean,default:!1}},emits:["submit","update:formDirty"],setup(e,{emit:t}){const o=e,i=t,s=O({...o.eventData});Ke(()=>o.eventData,u=>{s.value={...u}},{deep:!0});const a=()=>{i("update:formDirty",!0)},l=()=>{i("submit",{...s.value})};return(u,h)=>(m(),y("div",bC,[c("div",wC,[c("form",{onSubmit:St(l,["prevent"]),class:"event-details-form"},[c("div",CC,[h[4]||(h[4]=c("label",null,"Event name",-1)),Ze(c("input",{"onUpdate:modelValue":h[0]||(h[0]=f=>s.value.name=f),type:"text",required:"",class:"form-input",onInput:a},null,544),[[ut,s.value.name]])]),c("div",LC,[h[5]||(h[5]=c("label",null,"Description",-1)),Ze(c("textarea",{"onUpdate:modelValue":h[1]||(h[1]=f=>s.value.description=f),rows:"3",class:"form-input",onInput:a},null,544),[[ut,s.value.description]])]),c("div",SC,[c("div",xC,[h[6]||(h[6]=c("label",null,"Event date & time",-1)),Ze(c("input",{"onUpdate:modelValue":h[2]||(h[2]=f=>s.value.eventDate=f),type:"datetime-local",required:"",class:"form-input",onInput:a},null,544),[[ut,s.value.eventDate]])]),c("div",TC,[h[7]||(h[7]=c("label",null,"Time zone",-1)),Ze(c("select",{"onUpdate:modelValue":h[3]||(h[3]=f=>s.value.timeZoneId=f),required:"",class:"form-input",onChange:a},[(m(!0),y(Te,null,Ne(V(Tp),f=>(m(),y("option",{key:f.value,value:f.value},w(f.label),9,IC))),128))],544),[[gn,s.value.timeZoneId]])])]),c("div",$C,[c("button",{type:"submit",class:"btn btn-primary",disabled:!e.formDirty}," Save Changes ",8,MC)])],32)])]))}},EC=Xe(AC,[["__scopeId","data-v-ef3142df"]]),PC={class:"admins-list"},DC={class:"admin-info"},OC={class:"admin-role"},RC=["onClick"],BC={__name:"AdminsList",props:{admins:{type:Array,required:!0}},emits:["add-admin","remove-admin"],setup(e){return(t,o)=>(m(),y("div",null,[o[1]||(o[1]=c("h3",null,"Event administrators",-1)),c("button",{onClick:o[0]||(o[0]=i=>t.$emit("add-admin")),class:"btn btn-small btn-primary"}," Add administrator "),c("div",PC,[(m(!0),y(Te,null,Ne(e.admins,i=>(m(),y("div",{key:i.userEmail,class:"admin-item"},[c("div",DC,[c("strong",null,w(i.userEmail),1),c("span",OC,w(i.role),1)]),e.admins.length>1?(m(),y("button",{key:0,onClick:s=>t.$emit("remove-admin",i.userEmail),class:"btn btn-small btn-danger"}," Remove ",8,RC)):F("",!0)]))),128))])]))}},NC=Xe(BC,[["__scopeId","data-v-c76441fb"]]),On=[{name:"Charcoal",hex:"#2d3748"},{name:"Dark Gray",hex:"#4a5568"},{name:"Gray",hex:"#718096"},{name:"Red",hex:"#f56565"},{name:"Coral",hex:"#ff6b6b"},{name:"Rose",hex:"#fb7185"},{name:"Pink",hex:"#ed64a6"},{name:"Magenta",hex:"#d946ef"},{name:"Fuchsia",hex:"#e879f9"},{name:"Purple",hex:"#9f7aea"},{name:"Violet",hex:"#a78bfa"},{name:"Lavender",hex:"#b197fc"},{name:"Indigo",hex:"#5a67d8"},{name:"Navy",hex:"#4263eb"},{name:"Blue",hex:"#667eea"},{name:"Sky",hex:"#0ea5e9"},{name:"Cyan",hex:"#0bc5ea"},{name:"Aqua",hex:"#22d3ee"},{name:"Teal",hex:"#38b2ac"},{name:"Emerald",hex:"#10b981"},{name:"Green",hex:"#48bb78"},{name:"Mint",hex:"#51cf66"},{name:"Lime",hex:"#84cc16"},{name:"Olive",hex:"#a3b18a"},{name:"Yellow",hex:"#ecc94b"},{name:"Amber",hex:"#f59e0b"},{name:"Orange",hex:"#ed8936"},{name:"Peach",hex:"#ff922b"},{name:"Light Gray",hex:"#cbd5e0"},{name:"Silver",hex:"#e2e8f0"},{name:"Cream",hex:"#f7fafc"}],Dr="#667eea";function dh(e){const t=e.map(i=>i.color);return On.find(i=>!t.includes(i.hex))?.hex||Dr}const FC={class:"modal-content"},zC={class:"modal-body"},UC={class:"preview-section"},HC={class:"map-preview"},VC=["innerHTML"],ZC={class:"options-grid"},jC={class:"option-button-content"},WC={class:"option-button-value icon-value"},qC=["innerHTML"],GC={class:"option-button-content"},KC={class:"option-button-value color-value"},YC=["disabled"],JC={class:"option-button-content"},XC={class:"option-button-value color-value"},QC={class:"option-button-content"},eL={class:"option-button-value icon-value"},tL=["innerHTML"],nL=["disabled"],oL={class:"option-button-content"},sL={class:"option-button-value color-value"},iL={class:"option-button-content"},aL={class:"option-button-value"},rL={class:"option-button-content"},lL={class:"option-button-value"},cL={key:0,class:"centered-popup"},uL={class:"popup-grid"},dL=["onClick"],hL=["innerHTML"],fL={key:0},pL={key:1,class:"centered-popup"},vL={class:"popup-grid"},mL=["title","onClick"],gL=["innerHTML"],yL={key:0},_L={key:2,class:"centered-popup"},kL={class:"popup-grid"},bL=["title","onClick"],wL=["innerHTML"],CL={key:0},LL={key:3,class:"centered-popup icon-popup"},SL={class:"popup-grid"},xL=["onClick"],TL=["innerHTML"],IL={key:0},$L={key:4,class:"centered-popup"},ML={class:"popup-grid"},AL=["title","onClick"],EL=["innerHTML"],PL={key:0},DL={key:5,class:"centered-popup"},OL={class:"size-grid"},RL=["onClick"],BL=["innerHTML"],NL={key:6,class:"centered-popup"},FL={class:"rotation-content"},zL={class:"rotation-preview-container"},UL=["innerHTML"],HL={class:"rotation-control"},VL={class:"rotation-slider-container"},ZL=["value"],jL={class:"rotation-value"},WL={class:"rotation-presets"},qL="#667eea",GL={__name:"IconCustomizationModal",props:{isOpen:{type:Boolean,default:!1},iconType:{type:String,default:"none"},backgroundShape:{type:String,default:"circle"},backgroundColor:{type:String,default:""},borderColor:{type:String,default:""},iconColor:{type:String,default:""},size:{type:String,default:"100"},mapRotation:{type:[String,Number],default:""},level:{type:String,default:"checkpoint"},inheritedType:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""}},emits:["update:isOpen","apply","cancel"],setup(e,{emit:t}){const o=e,i=t,s=O(o.backgroundShape||"circle"),a=O(o.iconType||"none"),l=O(o.backgroundColor||""),u=O(o.borderColor||""),h=O(o.iconColor||""),f=O(o.size||"100"),p=O(o.mapRotation??""),g=O(null),b=te=>te==="default"?o.inheritedBackgroundShape||"circle":te==="none"?"none":te||"circle",S=te=>te==="default"||!te?ce():te==="none"?"transparent":te,T=te=>te==="default"?o.inheritedBorderColor||"#ffffff":te==="none"||!te?"transparent":te,_=te=>{if(te==="default"){const Y=o.inheritedType;return Y&&Y!=="default"&&js(Y).category==="content"?Y:"none"}return te==="none"||!te?"none":te},D=te=>te==="default"||!te?o.inheritedIconColor||"#ffffff":te==="none"?"transparent":te,M=te=>te==="default"?o.inheritedSize||"100":te||"100",x=te=>{if(te==="default"||te===""){const Y=o.inheritedMapRotation;return Y!==""&&Y!==void 0&&Y!==null&&parseInt(Y,10)||0}return parseInt(te,10)||0},C=ae(()=>{const te=o.inheritedBackgroundShape||"circle",Y=wr.find(H=>H.value===te)?.label||"Circle";return[{value:"none",label:"None",showLabel:!0},{value:"default",label:`Default (${Y})`,showLabel:!0},...wr.filter(H=>H.value!=="none").map(H=>({...H,showLabel:!1}))]}),A=ae(()=>{const te=qr.filter(Fe=>Fe.category==="content"),Y=[{value:"none",label:"None",category:"content",showLabel:!0}],H=o.inheritedType;if(H&&H!=="default"){const Fe=js(H);Fe.category==="content"&&Y.push({value:"default",label:`Default (${Fe.label||H})`,category:"content",showLabel:!0})}return Y.push(...te.map(Fe=>({...Fe,showLabel:!1}))),Y}),I=ae(()=>{const te={33:"Small",66:"Medium",100:"Normal",150:"Large"};return[{value:"default",label:`Default (${te[o.inheritedSize]||"Normal"})`},...Rb.map(H=>({value:H.value,label:te[H.value]||H.label}))]}),$=ae(()=>b(s.value)!=="none"),E=ae(()=>_(a.value)!=="none"),ie=ae(()=>{const te=o.inheritedBackgroundColor;return te&&te!=="default"&&te.startsWith("#")?te:qL}),ce=()=>ie.value,ge=ae(()=>l.value&&l.value!=="default"?l.value:ce()),re=ae(()=>u.value==="none"?"transparent":u.value?u.value:o.inheritedBorderColor&&o.inheritedBorderColor!=="none"?o.inheritedBorderColor:"#ffffff"),ve=ae(()=>h.value?h.value:o.inheritedIconColor?o.inheritedIconColor:"#ffffff"),Be=ae(()=>{const te=ie.value,Y=On.find(H=>H.hex.toLowerCase()===te.toLowerCase())?.name||"Custom";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${Y})`,showLabel:!0},...On.map(H=>({hex:H.hex,name:H.name,showLabel:!1}))]}),He=ae(()=>{const te=o.inheritedBorderColor||"#ffffff",Y=te==="#ffffff"?"White":On.find(H=>H.hex===te)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${Y})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...On.filter(H=>H.hex!=="#ffffff").map(H=>({hex:H.hex,name:H.name,showLabel:!1}))]}),Oe=ae(()=>{const te=o.inheritedIconColor||"#ffffff",Y=te==="#ffffff"?"White":On.find(H=>H.hex===te)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${Y})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...On.filter(H=>H.hex!=="#ffffff").map(H=>({hex:H.hex,name:H.name,showLabel:!1}))]}),fe=te=>te==="default"?!l.value||l.value==="default":l.value===te,q=te=>te==="#ffffff"?!h.value||h.value==="#ffffff":h.value===te,j=te=>{if(te==="none")return"None";if(te==="default"){const H=o.inheritedBackgroundShape;return H?`Default (${wr.find(Je=>Je.value===H)?.label||"Circle"})`:"Default (Circle)"}const Y=wr.find(H=>H.value===te);return Y?Y.label:"Circle"},ue=te=>{if(te==="none")return"None";if(te==="default"){const H=o.inheritedType;if(H&&H!=="default"){const Fe=js(H);if(Fe.category==="content")return`Default (${Fe.label||H})`}return"Default"}const Y=qr.find(H=>H.value===te);return Y?Y.label:"None"},K=te=>{if(te==="none")return"None";if(!te||te==="default"){const H=ie.value;return`Default (${On.find(Je=>Je.hex.toLowerCase()===H.toLowerCase())?.name||"Custom"})`}const Y=[...On].find(H=>H.hex.toLowerCase()===te.toLowerCase());return Y?Y.name:te},pe=te=>{if(te==="none")return"None";if(te==="default"){const H=o.inheritedBorderColor;return H&&H!=="none"?`Default (${H==="#ffffff"?"White":On.find(Je=>Je.hex===H)?.name||"Custom"})`:"Default (White)"}if(!te||te==="#ffffff")return"White";const Y=[...He.value].find(H=>H.hex===te);return Y?Y.name:te},X=te=>{if(te==="none")return"None";if(te==="default"){const H=o.inheritedIconColor;return H?`Default (${H==="#ffffff"?"White":On.find(Je=>Je.hex===H)?.name||"Custom"})`:"Default (White)"}if(!te||te==="#ffffff")return"White";const Y=[...Oe.value].find(H=>H.hex===te);return Y?Y.name:te},we=te=>{const Y={33:"Small",66:"Medium",100:"Normal",150:"Large"};if(te==="default"){const H=o.inheritedSize;return`Default (${Y[H]||"Normal"})`}return Y[te]||"Normal"},De=te=>{if(te==="default"||te===""||te===void 0||te===null){const Y=o.inheritedMapRotation;return Y!==""&&Y!==void 0&&Y!==null?`Default (${Y})`:"Default (0)"}return`${te}`},Se=te=>{if(te==="none")return`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`;const Y=b(te),H=S(l.value),Fe=T(u.value);return _i[Y]?`<svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">${_i[Y]({backgroundColor:H,borderColor:Fe==="transparent"?"none":Fe})}</svg>`:""},Ee=te=>{const Y=_(te);return Y==="none"?`<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
      <rect x="1" y="1" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`:qt({type:Y,backgroundShape:"circle",backgroundColor:"#94a3b8",borderColor:"none",iconColor:"#fff",size:"75"})},se=te=>{const Y=b(te);if(Y==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="none" stroke="#ccc" stroke-width="2" stroke-dasharray="4"/>
    </svg>`;const H=S(l.value),Fe=T(u.value),Je=_(a.value),Qe=D(h.value);return qt({type:Je!=="none"?Je:Y,backgroundShape:Y,backgroundColor:H,borderColor:Fe==="transparent"?"none":Fe,iconColor:Qe,size:"100",outputSize:28})},me=te=>{const Y=S(te),H=b(s.value),Fe=T(u.value),Je=_(a.value),Qe=D(h.value);return H==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${Y==="transparent"?"#e2e8f0":Y}"/>
    </svg>`:qt({type:Je!=="none"?Je:H,backgroundShape:H,backgroundColor:Y==="transparent"?"#e2e8f0":Y,borderColor:Fe==="transparent"?"none":Fe,iconColor:Qe,size:"100",outputSize:28})},ne=te=>{const Y=T(te),H=b(s.value),Fe=S(l.value),Je=_(a.value),Qe=D(h.value);return H==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0" stroke="${Y}" stroke-width="2"/>
    </svg>`:qt({type:Je!=="none"?Je:H,backgroundShape:H,backgroundColor:Fe,borderColor:Y==="transparent"?"none":Y,iconColor:Qe,size:"100",outputSize:28})},de=te=>{const Y=_(te),H=b(s.value),Fe=S(l.value),Je=T(u.value),Qe=D(h.value);if(Y==="none"&&H==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0"/>
      <line x1="8" y1="8" x2="20" y2="20" stroke="#a0aec0" stroke-width="2" stroke-linecap="round"/>
    </svg>`;const ot=H!=="none"?H:"circle";return qt({type:Y!=="none"?Y:ot,backgroundShape:ot,backgroundColor:Fe,borderColor:Je==="transparent"?"none":Je,iconColor:Qe,size:"100",outputSize:42})},Le=te=>{const Y=D(te),H=b(s.value),Fe=S(l.value),Je=T(u.value),Qe=_(a.value);return Qe==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${Y==="transparent"?"#e2e8f0":Y}"/>
    </svg>`:qt({type:Qe,backgroundShape:H!=="none"?H:"circle",backgroundColor:Fe,borderColor:Je==="transparent"?"none":Je,iconColor:Y==="transparent"?"#e2e8f0":Y,size:"100",outputSize:28})},B=te=>{const Y=M(te),H=b(s.value),Fe=S(l.value),Je=T(u.value),Qe=_(a.value),ot=D(h.value);if(H==="none"&&Qe==="none")return"";const $t=H!=="none"?H:"circle";return qt({type:Qe!=="none"?Qe:$t,backgroundShape:$t,backgroundColor:Fe,borderColor:Je==="transparent"?"none":Je,iconColor:ot,size:Y})},U=ae(()=>{const te=b(s.value),Y=S(l.value),H=T(u.value),Fe=_(a.value),Je=D(h.value),Qe=M(f.value);return te==="none"&&Fe==="none"?"":qt(te==="none"&&Fe!=="none"?{type:Fe,backgroundShape:"none",backgroundColor:Y,borderColor:"none",iconColor:Je,size:Qe}:{type:Fe!=="none"?Fe:te,backgroundShape:te,backgroundColor:Y,borderColor:H==="transparent"?"none":H,iconColor:Je,size:Qe})}),Q=te=>{g.value=g.value===te?null:te},Z=()=>{g.value=null},N=te=>{s.value=te,Z()},R=te=>{l.value=te,Z()},J=te=>{u.value=te,Z()},ke=te=>{a.value=te,Z()},xe=te=>{h.value=te,Z()},Ce=te=>{f.value=te,Z()},ze=te=>{p.value=te,Z()},Re=te=>{p.value=te};Ke(()=>o.isOpen,te=>{if(te){const Y=o.backgroundShape&&o.backgroundShape!=="default"&&o.backgroundShape!=="circle",H=o.iconType&&o.iconType!=="none"&&o.iconType!=="default",Fe=o.backgroundColor&&o.backgroundColor!=="",Je=o.borderColor&&o.borderColor!=="",Qe=o.iconColor&&o.iconColor!=="",ot=o.size&&o.size!==""&&o.size!=="100",$t=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null&&o.mapRotation!==0;Y||H||Fe||Je||Qe||ot||$t?(s.value=o.backgroundShape||"default",a.value=o.iconType||"default",l.value=o.backgroundColor||"default",u.value=o.borderColor||"default",h.value=o.iconColor||"default",f.value=o.size||"default",p.value=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null?o.mapRotation:"default"):(s.value="default",a.value="default",l.value="default",u.value="default",h.value="default",f.value="default",p.value="default"),g.value=null}});const je=()=>{Z(),i("update:isOpen",!1),i("cancel")},Ye=()=>{Z();const te=Fe=>Fe==="default"?"":Fe;let Y="";a.value==="none"?Y="none":a.value&&a.value!=="default"&&(Y=a.value);let H="";p.value!=="default"&&p.value!==""&&p.value!==void 0&&(H=parseInt(p.value,10)||0),i("apply",{iconType:Y,backgroundShape:te(s.value),backgroundColor:te(l.value),borderColor:te(u.value),iconColor:te(h.value),size:te(f.value),mapRotation:H}),i("update:isOpen",!1)};return(te,Y)=>e.isOpen?(m(),y("div",{key:0,class:"modal-overlay",onClick:St(je,["self"])},[c("div",FC,[c("div",{class:"modal-header"},[Y[15]||(Y[15]=c("h3",null,"Customise icon style",-1)),c("button",{class:"close-btn",onClick:je},"")]),c("div",zC,[c("div",UC,[c("div",HC,[Y[16]||(Y[16]=c("div",{class:"map-background"},null,-1)),c("div",{class:"preview-icon",style:Dt({transform:`rotate(${x(p.value)}deg)`}),innerHTML:U.value},null,12,VC)])]),c("div",ZC,[c("button",{type:"button",class:Ae(["option-button",{active:g.value==="shape"}]),onClick:Y[0]||(Y[0]=H=>Q("shape"))},[c("div",jC,[Y[17]||(Y[17]=c("span",{class:"option-button-label"},"Shape",-1)),c("div",WC,[c("div",{class:"icon-preview-small",innerHTML:Se(s.value)},null,8,qC),c("span",null,w(j(s.value)),1)])]),Y[18]||(Y[18]=c("span",{class:"option-button-arrow"},"",-1))],2),c("button",{type:"button",class:Ae(["option-button",{active:g.value==="bgColor"}]),onClick:Y[1]||(Y[1]=H=>Q("bgColor"))},[c("div",GC,[Y[19]||(Y[19]=c("span",{class:"option-button-label"},"Background",-1)),c("div",KC,[c("span",{class:"color-swatch",style:Dt({backgroundColor:ge.value})},null,4),c("span",null,w(K(l.value)),1)])]),Y[20]||(Y[20]=c("span",{class:"option-button-arrow"},"",-1))],2),c("button",{type:"button",class:Ae(["option-button",{active:g.value==="borderColor",disabled:!$.value}]),disabled:!$.value,onClick:Y[2]||(Y[2]=H=>Q("borderColor"))},[c("div",JC,[Y[21]||(Y[21]=c("span",{class:"option-button-label"},"Border",-1)),c("div",XC,[c("span",{class:Ae(["color-swatch",{"no-border":u.value==="none"}]),style:Dt(u.value!=="none"?{backgroundColor:re.value}:{})},null,6),c("span",null,w(pe(u.value)),1)])]),Y[22]||(Y[22]=c("span",{class:"option-button-arrow"},"",-1))],10,YC),c("button",{type:"button",class:Ae(["option-button",{active:g.value==="icon"}]),onClick:Y[3]||(Y[3]=H=>Q("icon"))},[c("div",QC,[Y[23]||(Y[23]=c("span",{class:"option-button-label"},"Icon",-1)),c("div",eL,[c("div",{class:"icon-preview-small",innerHTML:Ee(a.value)},null,8,tL),c("span",null,w(ue(a.value)),1)])]),Y[24]||(Y[24]=c("span",{class:"option-button-arrow"},"",-1))],2),c("button",{type:"button",class:Ae(["option-button",{active:g.value==="iconColor",disabled:!E.value}]),disabled:!E.value,onClick:Y[4]||(Y[4]=H=>Q("iconColor"))},[c("div",oL,[Y[25]||(Y[25]=c("span",{class:"option-button-label"},"Colour",-1)),c("div",sL,[c("span",{class:"color-swatch",style:Dt({backgroundColor:ve.value})},null,4),c("span",null,w(X(h.value)),1)])]),Y[26]||(Y[26]=c("span",{class:"option-button-arrow"},"",-1))],10,nL),c("button",{type:"button",class:Ae(["option-button",{active:g.value==="size"}]),onClick:Y[5]||(Y[5]=H=>Q("size"))},[c("div",iL,[Y[27]||(Y[27]=c("span",{class:"option-button-label"},"Size",-1)),c("span",aL,w(we(f.value)),1)]),Y[28]||(Y[28]=c("span",{class:"option-button-arrow"},"",-1))],2),c("button",{type:"button",class:Ae(["option-button option-button-full",{active:g.value==="mapRotation"}]),onClick:Y[6]||(Y[6]=H=>Q("mapRotation"))},[c("div",rL,[Y[29]||(Y[29]=c("span",{class:"option-button-label"},"Map rotation",-1)),c("span",lL,w(De(p.value)),1)]),Y[30]||(Y[30]=c("span",{class:"option-button-arrow"},"",-1))],2)]),g.value==="shape"?(m(),y("div",cL,[c("div",{class:"popup-header"},[Y[31]||(Y[31]=c("span",null,"Select shape",-1)),c("button",{type:"button",class:"popup-close",onClick:Z},"")]),c("div",uL,[(m(!0),y(Te,null,Ne(C.value,H=>(m(),y("button",{key:H.value,type:"button",class:Ae(["popup-grid-item",{selected:s.value===H.value}]),onClick:Fe=>N(H.value)},[c("div",{class:"popup-item-preview",innerHTML:se(H.value)},null,8,hL),H.showLabel?(m(),y("span",fL,w(H.label),1)):F("",!0)],10,dL))),128))])])):F("",!0),g.value==="bgColor"?(m(),y("div",pL,[c("div",{class:"popup-header"},[Y[32]||(Y[32]=c("span",null,"Select background",-1)),c("button",{type:"button",class:"popup-close",onClick:Z},"")]),c("div",vL,[(m(!0),y(Te,null,Ne(Be.value,H=>(m(),y("button",{key:H.hex,type:"button",class:Ae(["popup-grid-item",{selected:fe(H.hex)}]),title:H.name,onClick:Fe=>R(H.hex)},[c("div",{class:"popup-item-preview",innerHTML:me(H.hex)},null,8,gL),H.showLabel?(m(),y("span",yL,w(H.name),1)):F("",!0)],10,mL))),128))])])):F("",!0),g.value==="borderColor"?(m(),y("div",_L,[c("div",{class:"popup-header"},[Y[33]||(Y[33]=c("span",null,"Select border",-1)),c("button",{type:"button",class:"popup-close",onClick:Z},"")]),c("div",kL,[(m(!0),y(Te,null,Ne(He.value,H=>(m(),y("button",{key:H.hex,type:"button",class:Ae(["popup-grid-item",{selected:u.value===H.hex}]),title:H.name,onClick:Fe=>J(H.hex)},[c("div",{class:"popup-item-preview",innerHTML:ne(H.hex)},null,8,wL),H.showLabel?(m(),y("span",CL,w(H.name),1)):F("",!0)],10,bL))),128))])])):F("",!0),g.value==="icon"?(m(),y("div",LL,[c("div",{class:"popup-header"},[Y[34]||(Y[34]=c("span",null,"Select icon",-1)),c("button",{type:"button",class:"popup-close",onClick:Z},"")]),c("div",SL,[(m(!0),y(Te,null,Ne(A.value,H=>(m(),y("button",{key:H.value,type:"button",class:Ae(["popup-grid-item",{selected:a.value===H.value}]),onClick:Fe=>ke(H.value)},[c("div",{class:"popup-item-preview",innerHTML:de(H.value)},null,8,TL),H.showLabel?(m(),y("span",IL,w(H.label),1)):F("",!0)],10,xL))),128))])])):F("",!0),g.value==="iconColor"?(m(),y("div",$L,[c("div",{class:"popup-header"},[Y[35]||(Y[35]=c("span",null,"Select colour",-1)),c("button",{type:"button",class:"popup-close",onClick:Z},"")]),c("div",ML,[(m(!0),y(Te,null,Ne(Oe.value,H=>(m(),y("button",{key:H.hex,type:"button",class:Ae(["popup-grid-item",{selected:q(H.hex)}]),title:H.name,onClick:Fe=>xe(H.hex)},[c("div",{class:"popup-item-preview",innerHTML:Le(H.hex)},null,8,EL),H.showLabel?(m(),y("span",PL,w(H.name),1)):F("",!0)],10,AL))),128))])])):F("",!0),g.value==="size"?(m(),y("div",DL,[c("div",{class:"popup-header"},[Y[36]||(Y[36]=c("span",null,"Select size",-1)),c("button",{type:"button",class:"popup-close",onClick:Z},"")]),c("div",OL,[(m(!0),y(Te,null,Ne(I.value,H=>(m(),y("button",{key:H.value,type:"button",class:Ae(["size-grid-item",{selected:f.value===H.value}]),onClick:Fe=>Ce(H.value)},[c("div",{class:"size-preview",innerHTML:B(H.value)},null,8,BL),c("span",null,w(H.label),1)],10,RL))),128))])])):F("",!0),g.value==="mapRotation"?(m(),y("div",NL,[c("div",{class:"popup-header"},[Y[37]||(Y[37]=c("span",null,"Set map rotation",-1)),c("button",{type:"button",class:"popup-close",onClick:Z},"")]),c("div",FL,[c("div",zL,[c("div",{class:"rotation-preview-icon",style:Dt({transform:`rotate(${x(p.value)}deg)`}),innerHTML:U.value},null,12,UL)]),Y[38]||(Y[38]=c("p",{class:"rotation-description"}," Rotate the marker on the map. This rotation is added to any map rotation. ",-1)),c("div",HL,[c("button",{type:"button",class:Ae(["rotation-preset",{selected:p.value==="default"||p.value===""}]),onClick:Y[7]||(Y[7]=H=>ze("default"))}," Default ",2),c("div",VL,[c("input",{type:"range",min:"-180",max:"180",step:"5",class:"rotation-slider",value:p.value==="default"||p.value===""?0:p.value,onInput:Y[8]||(Y[8]=H=>Re(parseInt(H.target.value,10)))},null,40,ZL),c("div",jL,w(p.value==="default"||p.value===""?"0":p.value)+" ",1)])]),c("div",WL,[c("button",{type:"button",class:Ae(["rotation-preset-btn",{selected:p.value===-90}]),onClick:Y[9]||(Y[9]=H=>ze(-90))},"-90",2),c("button",{type:"button",class:Ae(["rotation-preset-btn",{selected:p.value===-45}]),onClick:Y[10]||(Y[10]=H=>ze(-45))},"-45",2),c("button",{type:"button",class:Ae(["rotation-preset-btn",{selected:p.value===0}]),onClick:Y[11]||(Y[11]=H=>ze(0))},"0",2),c("button",{type:"button",class:Ae(["rotation-preset-btn",{selected:p.value===45}]),onClick:Y[12]||(Y[12]=H=>ze(45))},"+45",2),c("button",{type:"button",class:Ae(["rotation-preset-btn",{selected:p.value===90}]),onClick:Y[13]||(Y[13]=H=>ze(90))},"+90",2),c("button",{type:"button",class:Ae(["rotation-preset-btn",{selected:p.value===180}]),onClick:Y[14]||(Y[14]=H=>ze(180))},"180",2)])])])):F("",!0)]),c("div",{class:"modal-footer"},[c("button",{type:"button",class:"btn-cancel",onClick:je},"Cancel"),c("button",{type:"button",class:"btn-apply",onClick:Ye},"Apply")])])])):F("",!0)}},KL=Xe(GL,[["__scopeId","data-v-fdb03b01"]]),YL={class:"checkpoint-style-picker"},JL={class:"form-group"},XL={class:"style-options"},QL=["innerHTML"],e2={class:"option-label"},t2=["innerHTML"],n2="#667eea",o2={__name:"CheckpointStylePicker",props:{styleType:{type:String,default:"default"},styleColor:{type:String,default:""},styleBackgroundShape:{type:String,default:""},styleBackgroundColor:{type:String,default:""},styleBorderColor:{type:String,default:""},styleIconColor:{type:String,default:""},styleSize:{type:String,default:""},styleMapRotation:{type:[String,Number],default:""},iconLabel:{type:String,default:"Icon style"},showPreview:{type:Boolean,default:!0},inheritedStyleType:{type:String,default:"default"},inheritedStyleColor:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""},defaultLabel:{type:String,default:"Default"},level:{type:String,default:"checkpoint"}},emits:["update:styleType","update:styleColor","update:styleBackgroundShape","update:styleBackgroundColor","update:styleBorderColor","update:styleIconColor","update:styleSize","update:styleMapRotation","change"],setup(e,{emit:t}){const o=e,i=t,s=O(o.styleType),a=O(o.styleColor||""),l=O(o.styleBackgroundShape||"default"),u=O(o.styleBackgroundColor||""),h=O(o.styleBorderColor||""),f=O(o.styleIconColor||""),p=O(o.styleSize||"default"),g=O(o.styleMapRotation||""),b=re=>!re||re==="default"?!1:js(re).category==="content",S=O(o.styleType&&o.styleType!=="default"&&o.styleType!=="custom"&&b(o.styleType)?o.styleType:"default"),T=O(!1),_=ae(()=>!!(s.value&&s.value!=="default"||l.value&&l.value!=="default"&&l.value!=="circle"||u.value||h.value||f.value||p.value&&p.value!=="default"&&p.value!=="100")),D=re=>re&&re!==""&&re!=="default",M=re=>re&&re.startsWith("#"),x=ae(()=>{const ve=D(o.inheritedStyleType),Be=D(o.inheritedBackgroundShape),He=M(o.inheritedBackgroundColor)||M(o.inheritedStyleColor),Oe=M(o.inheritedBorderColor),fe=M(o.inheritedIconColor),q=D(o.inheritedSize);if(ve||Be||He||Oe||fe||q){const ue=ve?o.inheritedStyleType:Be?o.inheritedBackgroundShape:"circle",K=(M(o.inheritedBackgroundColor)?o.inheritedBackgroundColor:null)||(M(o.inheritedStyleColor)?o.inheritedStyleColor:null)||n2;return qt({type:ue,backgroundShape:o.inheritedBackgroundShape||"circle",backgroundColor:K,borderColor:o.inheritedBorderColor||"#ffffff",iconColor:o.inheritedIconColor||"#ffffff",size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#10B981"/>
        <stop offset="50%" style="stop-color:#F59E0B"/>
        <stop offset="100%" style="stop-color:#EF4444"/>
      </linearGradient>
    </defs>
    <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#defaultGradient)" stroke="#fff" stroke-width="1.5"/>
  </svg>`}),C=ae(()=>{const re=o.inheritedMapRotation;return re!==""&&re!==void 0&&re!==null&&re!==0?{transform:`rotate(${re}deg)`}:{}}),A=ae(()=>{if(g.value!==""&&g.value!==void 0&&g.value!==null){const ve=parseInt(g.value,10)||0;if(ve!==0)return{transform:`rotate(${ve}deg)`}}const re=o.inheritedMapRotation;return re!==""&&re!==void 0&&re!==null&&re!==0?{transform:`rotate(${re}deg)`}:{}}),I=ae(()=>{if(_.value){const re=S.value&&S.value!=="none"&&S.value!=="default";let ve=null;o.inheritedStyleType&&o.inheritedStyleType!=="default"&&o.inheritedStyleType!=="custom"&&js(o.inheritedStyleType).category==="content"&&(ve=o.inheritedStyleType);const Be=S.value==="default"&&ve,He=re||Be,Oe=re?S.value:Be?ve:null,fe=l.value&&l.value!=="default"?l.value:o.inheritedBackgroundShape||"circle",q=He?Oe:fe,j=u.value||o.inheritedBackgroundColor||o.inheritedStyleColor||"#667eea",ue=h.value||o.inheritedBorderColor||"#ffffff",K=f.value||o.inheritedIconColor||"#ffffff";return qt({type:q,backgroundShape:fe,backgroundColor:j,borderColor:ue,iconColor:K,size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#e2e8f0" stroke="#cbd5e0" stroke-width="1.5"/>
    <path d="M12 8v8M8 12h8" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
  </svg>`}),$=()=>{s.value="default",S.value="default",i("update:styleType","default"),l.value="default",u.value="",a.value="",h.value="",f.value="",p.value="default",g.value="",i("update:styleBackgroundShape",""),i("update:styleBackgroundColor",""),i("update:styleColor",""),i("update:styleBorderColor",""),i("update:styleIconColor",""),i("update:styleSize",""),i("update:styleMapRotation",""),ge()},E=()=>{T.value=!0},ie=re=>{re.iconType==="none"?S.value="none":re.iconType?S.value=re.iconType:S.value="default",l.value=re.backgroundShape||"default",u.value=re.backgroundColor||"",h.value=re.borderColor||"",f.value=re.iconColor||"",p.value=re.size||"default",g.value=re.mapRotation??"";const ve=re.iconType==="none"||re.iconType&&re.iconType!==""||re.backgroundShape||re.backgroundColor||re.borderColor||re.iconColor||re.size||re.mapRotation!==""&&re.mapRotation!==0;re.iconType&&re.iconType!=="none"?s.value=re.iconType:ve?s.value="custom":s.value="default",i("update:styleType",s.value),i("update:styleBackgroundShape",re.backgroundShape),i("update:styleBackgroundColor",re.backgroundColor),i("update:styleBorderColor",re.borderColor),i("update:styleIconColor",re.iconColor),i("update:styleSize",re.size),i("update:styleMapRotation",re.mapRotation??""),ge()},ce=()=>{},ge=()=>{i("change",{styleType:s.value,styleColor:u.value||a.value,styleBackgroundShape:l.value,styleBackgroundColor:u.value,styleBorderColor:h.value,styleIconColor:f.value,styleSize:p.value,styleMapRotation:g.value})};return Ke(()=>o.styleType,re=>{s.value=re,re&&re!=="default"&&re!=="custom"&&b(re)?S.value=re:S.value="default"}),Ke(()=>o.styleColor,re=>{a.value=re||""}),Ke(()=>o.styleBackgroundShape,re=>{l.value=re||"default"}),Ke(()=>o.styleBackgroundColor,re=>{u.value=re||""}),Ke(()=>o.styleBorderColor,re=>{h.value=re||""}),Ke(()=>o.styleIconColor,re=>{f.value=re||""}),Ke(()=>o.styleSize,re=>{p.value=re||"default"}),Ke(()=>o.styleMapRotation,re=>{g.value=re??""}),(re,ve)=>(m(),y("div",YL,[c("div",JL,[c("label",null,w(e.iconLabel),1),c("div",XL,[c("button",{type:"button",class:Ae(["style-option-button",{selected:!_.value}]),onClick:$},[c("div",{class:"option-preview",style:Dt(C.value),innerHTML:x.value},null,12,QL),c("span",e2,w(e.defaultLabel),1)],2),c("button",{type:"button",class:Ae(["style-option-button",{selected:_.value}]),onClick:E},[c("div",{class:"option-preview",style:Dt(A.value),innerHTML:I.value},null,12,t2),ve[1]||(ve[1]=c("span",{class:"option-label"},"Custom",-1))],2)])]),Ve(KL,{isOpen:T.value,"onUpdate:isOpen":ve[0]||(ve[0]=Be=>T.value=Be),"icon-type":S.value,"background-shape":l.value,"background-color":u.value,"border-color":h.value,"icon-color":f.value,size:p.value,"map-rotation":g.value,level:e.level,"inherited-type":e.inheritedStyleType,"inherited-background-shape":e.inheritedBackgroundShape,"inherited-background-color":e.inheritedBackgroundColor||e.inheritedStyleColor,"inherited-border-color":e.inheritedBorderColor,"inherited-icon-color":e.inheritedIconColor,"inherited-size":e.inheritedSize,"inherited-map-rotation":e.inheritedMapRotation,onApply:ie,onCancel:ce},null,8,["isOpen","icon-type","background-shape","background-color","border-color","icon-color","size","map-rotation","level","inherited-type","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])]))}},cu=Xe(o2,[["__scopeId","data-v-e6c6a265"]]),s2={class:"settings-tab"},i2={class:"accordion"},a2={class:"accordion-section"},r2={class:"accordion-title"},l2={class:"accordion-icon"},c2={key:0,class:"accordion-content"},u2={class:"accordion-section"},d2={class:"accordion-icon"},h2={key:0,class:"accordion-content"},f2={class:"terminology-grid"},p2={class:"term-group"},v2=["value"],m2={class:"term-group"},g2=["value"],y2={class:"term-group"},_2=["value"],k2={class:"term-group"},b2=["value"],w2={class:"term-group"},C2=["value"],L2={class:"form-actions"},S2=["disabled"],x2={class:"accordion-section"},T2={class:"accordion-title"},I2={class:"accordion-icon"},$2={key:0,class:"accordion-content"},M2={class:"section-description"},A2={class:"form-actions"},E2=["disabled"],hh="admin_settings_accordion",P2={__name:"SettingsTab",props:{eventData:{type:Object,required:!0},admins:{type:Array,default:()=>[]},formDirty:{type:Boolean,default:!1},eventId:{type:String,default:""}},emits:["submit","add-admin","remove-admin","update:formDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=yt(),s=e,a=t,l=O({...s.eventData}),u=()=>s.eventId?`${hh}_${s.eventId}`:hh,h=O(null);rn(()=>{const T=localStorage.getItem(u());T&&(h.value=T)});const f=ae(()=>{const T=l.value.peopleTerm||"Marshals";return Ro.checkpoint.map(_=>({value:_,label:Ec(_,T)}))}),p=T=>{const _=h.value===T?null:T;h.value=_,_?localStorage.setItem(u(),_):localStorage.removeItem(u())};Ke(()=>s.eventData,T=>{l.value={...T}},{deep:!0});const g=()=>{a("update:formDirty",!0)},b=(T,_)=>{l.value[T]=_,g()},S=()=>{a("submit",{...l.value})};return(T,_)=>(m(),y("div",s2,[c("div",i2,[c("div",a2,[c("button",{class:Ae(["accordion-header",{active:h.value==="admins"}]),onClick:_[0]||(_[0]=D=>p("admins"))},[c("span",r2,"Administrators ("+w(e.admins.length)+")",1),c("span",l2,w(h.value==="admins"?"-":"+"),1)],2),h.value==="admins"?(m(),y("div",c2,[Ve(NC,{admins:e.admins,onAddAdmin:_[1]||(_[1]=D=>T.$emit("add-admin")),onRemoveAdmin:_[2]||(_[2]=D=>T.$emit("remove-admin",D))},null,8,["admins"])])):F("",!0)]),c("div",u2,[c("button",{class:Ae(["accordion-header",{active:h.value==="terminology"}]),onClick:_[3]||(_[3]=D=>p("terminology"))},[_[18]||(_[18]=c("span",{class:"accordion-title"},"Terminology",-1)),c("span",d2,w(h.value==="terminology"?"-":"+"),1)],2),h.value==="terminology"?(m(),y("div",h2,[_[19]||(_[19]=c("p",{class:"section-description"}," Customise how things are named throughout the application. ",-1)),c("div",f2,[c("div",p2,[c("label",null,w(V(o).people)+" are called",1),Ze(c("select",{"onUpdate:modelValue":_[4]||(_[4]=D=>l.value.peopleTerm=D),class:"form-input",onChange:g},[(m(!0),y(Te,null,Ne(V(Ro).people,D=>(m(),y("option",{key:D,value:D},w(D),9,v2))),128))],544),[[gn,l.value.peopleTerm]])]),c("div",m2,[c("label",null,w(V(o).checkpoints)+" are called",1),Ze(c("select",{"onUpdate:modelValue":_[5]||(_[5]=D=>l.value.checkpointTerm=D),class:"form-input",onChange:g},[(m(!0),y(Te,null,Ne(f.value,D=>(m(),y("option",{key:D.value,value:D.value},w(D.label),9,g2))),128))],544),[[gn,l.value.checkpointTerm]])]),c("div",y2,[c("label",null,w(V(o).areas)+" are called",1),Ze(c("select",{"onUpdate:modelValue":_[6]||(_[6]=D=>l.value.areaTerm=D),class:"form-input",onChange:g},[(m(!0),y(Te,null,Ne(V(Ro).area,D=>(m(),y("option",{key:D,value:D},w(D),9,_2))),128))],544),[[gn,l.value.areaTerm]])]),c("div",k2,[c("label",null,w(V(o).checklists)+" are called",1),Ze(c("select",{"onUpdate:modelValue":_[7]||(_[7]=D=>l.value.checklistTerm=D),class:"form-input",onChange:g},[(m(!0),y(Te,null,Ne(V(Ro).checklist,D=>(m(),y("option",{key:D,value:D},w(D),9,b2))),128))],544),[[gn,l.value.checklistTerm]])]),c("div",w2,[c("label",null,w(V(o).course)+" is called",1),Ze(c("select",{"onUpdate:modelValue":_[8]||(_[8]=D=>l.value.courseTerm=D),class:"form-input",onChange:g},[(m(!0),y(Te,null,Ne(V(Ro).course,D=>(m(),y("option",{key:D,value:D},w(D),9,C2))),128))],544),[[gn,l.value.courseTerm]])])]),c("div",L2,[c("button",{onClick:S,class:"btn btn-primary",disabled:!e.formDirty}," Save Changes ",8,S2)])])):F("",!0)]),c("div",x2,[c("button",{class:Ae(["accordion-header",{active:h.value==="appearance"}]),onClick:_[9]||(_[9]=D=>p("appearance"))},[c("span",T2,w(V(o).checkpoint)+" appearance",1),c("span",I2,w(h.value==="appearance"?"-":"+"),1)],2),h.value==="appearance"?(m(),y("div",$2,[c("p",M2," Set the default marker style for all "+w(V(i).checkpoints)+" in this event. Individual "+w(V(i).areas)+" and "+w(V(i).checkpoints)+" can override this setting. ",1),Ve(cu,{"style-type":l.value.defaultCheckpointStyleType||"default","style-color":l.value.defaultCheckpointStyleColor||"","style-background-shape":l.value.defaultCheckpointStyleBackgroundShape||"","style-background-color":l.value.defaultCheckpointStyleBackgroundColor||"","style-border-color":l.value.defaultCheckpointStyleBorderColor||"","style-icon-color":l.value.defaultCheckpointStyleIconColor||"","style-size":l.value.defaultCheckpointStyleSize||"","style-map-rotation":l.value.defaultCheckpointStyleMapRotation??"","icon-label":"Default marker style",level:"event","show-preview":!0,"onUpdate:styleType":_[10]||(_[10]=D=>b("defaultCheckpointStyleType",D)),"onUpdate:styleColor":_[11]||(_[11]=D=>b("defaultCheckpointStyleColor",D)),"onUpdate:styleBackgroundShape":_[12]||(_[12]=D=>b("defaultCheckpointStyleBackgroundShape",D)),"onUpdate:styleBackgroundColor":_[13]||(_[13]=D=>b("defaultCheckpointStyleBackgroundColor",D)),"onUpdate:styleBorderColor":_[14]||(_[14]=D=>b("defaultCheckpointStyleBorderColor",D)),"onUpdate:styleIconColor":_[15]||(_[15]=D=>b("defaultCheckpointStyleIconColor",D)),"onUpdate:styleSize":_[16]||(_[16]=D=>b("defaultCheckpointStyleSize",D)),"onUpdate:styleMapRotation":_[17]||(_[17]=D=>b("defaultCheckpointStyleMapRotation",D))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation"]),c("div",A2,[c("button",{onClick:S,class:"btn btn-primary",disabled:!e.formDirty}," Save Changes ",8,E2)])])):F("",!0)])])]))}},D2=Xe(P2,[["__scopeId","data-v-0537ba2b"]]),O2={class:"button-group"},R2={key:0,class:"add-dropdown"},B2={key:0,class:"filter-group"},N2={class:"filter-checkbox"},F2=["checked"],z2={class:"locations-list"},U2=["onClick"],H2={class:"location-info"},V2={class:"location-header"},Z2=["innerHTML"],j2={class:"location-name-desc"},W2={key:0,class:"location-description"},q2={class:"location-status"},G2={class:"location-assignments"},K2={__name:"CheckpointsList",props:{locations:{type:Array,required:!0},areas:{type:Array,default:()=>[]}},emits:["add-checkpoint-manually","import-checkpoints","select-location"],setup(e,{emit:t}){const{terms:o,termsLower:i}=yt(),s=e,a=t,l=O(!0),u=O([]),h=O(null),f=O(null),p=O(!1),g=()=>{p.value=!p.value},b=()=>{p.value=!1,a("add-checkpoint-manually")},S=()=>{p.value=!1,a("import-checkpoints")},T=A=>{f.value&&!f.value.contains(A.target)&&(p.value=!1)};rn(()=>{document.addEventListener("click",T)}),fo(()=>{document.removeEventListener("click",T)});const _=()=>{l.value=!l.value,!l.value&&u.value.length===0&&(u.value=s.areas.map(A=>A.id))},D=ae(()=>{let A=s.locations;return!l.value&&u.value.length>0&&(A=A.filter(I=>(I.areaIds||I.AreaIds||[]).some(E=>u.value.includes(E)))),[...A].sort((I,$)=>_n(I.name,$.name))}),M=A=>{const I=s.areas.find($=>$.id===A);return I?I.name:null},x=A=>{const I=s.areas.find($=>$.id===A);return I?I.color:"#999"},C=A=>{const I=A.resolvedStyleType||A.ResolvedStyleType,$=A.resolvedStyleBackgroundColor||A.ResolvedStyleBackgroundColor||A.resolvedStyleColor||A.ResolvedStyleColor,E=A.resolvedStyleBorderColor||A.ResolvedStyleBorderColor,ie=A.resolvedStyleIconColor||A.ResolvedStyleIconColor,ce=A.resolvedStyleBackgroundShape||A.ResolvedStyleBackgroundShape;return I&&I!=="default"||$||E||ie||ce&&ce!=="circle"?qt({type:I||"circle",backgroundShape:ce||"circle",backgroundColor:$||"#667eea",borderColor:E||"#ffffff",iconColor:ie||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`};return(A,I)=>(m(),y("div",null,[c("h3",null,w(V(o).checkpoints)+" ("+w(e.locations.length)+")",1),c("div",O2,[c("div",{class:"add-menu-wrapper",ref_key:"menuWrapperRef",ref:f},[c("button",{ref_key:"addButtonRef",ref:h,onClick:g,class:"btn btn-small btn-primary"}," Add... ",512),p.value?(m(),y("div",R2,[c("button",{onClick:b,class:"dropdown-item"}," Add "+w(V(i).checkpoint)+" manually ",1),c("button",{onClick:S,class:"dropdown-item"}," Import from CSV... ")])):F("",!0)],512)]),e.areas.length>0?(m(),y("div",B2,[c("h4",null,"Filter by "+w(V(o).area.toLowerCase())+":",1),c("label",N2,[c("input",{type:"checkbox",checked:l.value,onChange:_},null,40,F2),We(" All "+w(V(o).areas.toLowerCase())+" ("+w(e.locations.length)+") ",1)]),l.value?F("",!0):(m(),at(Ap,{key:0,areas:e.areas,"selected-area-ids":u.value,"onUpdate:selectedAreaIds":I[0]||(I[0]=$=>u.value=$)},null,8,["areas","selected-area-ids"]))])):F("",!0),c("div",z2,[(m(!0),y(Te,null,Ne(D.value,$=>(m(),y("div",{key:$.id,class:Ae(["location-item",{"location-full":$.checkedInCount>=$.requiredMarshals,"location-missing":$.checkedInCount===0}]),onClick:E=>A.$emit("select-location",$)},[c("div",H2,[c("div",V2,[c("span",{class:"checkpoint-icon",innerHTML:C($)},null,8,Z2),c("div",j2,[c("strong",null,w($.name),1),$.description?(m(),y("span",W2," - "+w($.description),1)):F("",!0)]),(m(!0),y(Te,null,Ne($.areaIds||$.AreaIds||[],E=>(m(),y("span",{key:E,class:"area-badge",style:Dt({backgroundColor:x(E)})},w(M(E)),5))),128)),c("span",q2,w($.checkedInCount)+"/"+w($.requiredMarshals),1)])]),c("div",G2,[(m(!0),y(Te,null,Ne($.assignments,E=>(m(),y("span",{key:E.id,class:Ae(["assignment-badge",{"checked-in":E.isCheckedIn}])},w(E.marshalName),3))),128))])],10,U2))),128))])]))}},Y2=Xe(K2,[["__scopeId","data-v-92e31410"]]),J2={class:"button-group"},X2={class:"areas-list"},Q2=["onClick"],eS={class:"area-info"},tS={class:"area-header"},nS={key:0,class:"default-badge"},oS={key:0,class:"area-description"},sS={class:"area-stats"},iS={class:"stat-badge"},aS={class:"stat-badge"},rS={key:0,class:"empty-state"},lS={__name:"AreasList",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["add-area","select-area"],setup(e){const{terms:t}=yt(),o=e,i=ae(()=>[...o.areas].sort((f,p)=>f.displayOrder!==p.displayOrder?f.displayOrder-p.displayOrder:_n(f.name,p.name))),s=f=>f.checkpointCount!==void 0?f.checkpointCount:o.checkpoints.filter(p=>p.areaId===f.id).length,a=f=>{if(!f.contacts)return 0;const p=typeof f.contacts=="string"?JSON.parse(f.contacts):f.contacts;return Array.isArray(p)?p.length:0},l=f=>f.peopleTerm||o.eventPeopleTerm||"Marshals",u=(f,p)=>{const g=f.checkpointTerm||o.eventCheckpointTerm||"Checkpoints",b=l(f);return p===1?Bs("checkpoint",g,b):Ip("checkpoint",g,b)},h=f=>{const p=s(f),g=u(f,p).toLowerCase();return`${p} ${g}`};return(f,p)=>(m(),y("div",null,[c("h3",null,w(V(t).areas)+" ("+w(e.areas.length)+")",1),c("div",J2,[c("button",{onClick:p[0]||(p[0]=g=>f.$emit("add-area")),class:"btn btn-small btn-primary"}," Add "+w(V(t).area.toLowerCase()),1)]),c("div",X2,[(m(!0),y(Te,null,Ne(i.value,g=>(m(),y("div",{key:g.id,class:"area-item",style:Dt({borderLeftColor:g.color||"#667eea"}),onClick:b=>f.$emit("select-area",g)},[c("div",eS,[c("div",tS,[c("strong",null,w(g.name),1),g.isDefault?(m(),y("span",nS,"Default")):F("",!0)]),g.description?(m(),y("p",oS,w(g.description),1)):F("",!0),c("div",sS,[c("span",iS,w(h(g)),1),c("span",aS,w(a(g))+" contact"+w(a(g)===1?"":"s"),1)])])],12,Q2))),128)),e.areas.length===0?(m(),y("div",rS,[c("p",null,"No "+w(V(t).areas.toLowerCase())+' yet. Click "Add '+w(V(t).area.toLowerCase())+'" to create one.',1)])):F("",!0)])]))}},cS=Xe(lS,[["__scopeId","data-v-88e8f341"]]),uS={course:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>',checkpoint:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',area:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',marshal:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',checklist:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>',notes:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/></svg>',details:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16h6"/></svg>',location:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',contacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>',eventContacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 8V6a2 2 0 0 0-2-2h-2"/><path d="M22 12v2a2 2 0 0 1-2 2h-2"/></svg>',event:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>',appearance:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12.5" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>'},xn=e=>uS[e]||"",dS={class:"responsive-tabs"},hS={class:"visible-tabs"},fS=["onClick"],pS=["innerHTML"],vS={class:"hamburger-only"},mS=["innerHTML"],gS={class:"hamburger-label"},yS=["onClick"],_S=["innerHTML"],kS={__name:"ResponsiveTabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,i=t,s=O(null),a=O(null),l=O(!1),u=O({}),h=ae(()=>o.tabs.find(S=>S.value===o.modelValue)),f=ae(()=>h.value?h.value.label:"Menu"),p=()=>{if(l.value=!l.value,l.value&&a.value){const S=a.value.getBoundingClientRect();u.value={top:`${S.bottom+4}px`}}},g=S=>{i("update:modelValue",S),l.value=!1},b=S=>{if(!s.value)return;const T=s.value.contains(S.target);l.value&&!T&&(l.value=!1)};return rn(()=>{document.addEventListener("click",b)}),fo(()=>{document.removeEventListener("click",b)}),(S,T)=>(m(),y("div",dS,[c("div",hS,[(m(!0),y(Te,null,Ne(e.tabs,_=>(m(),y("button",{key:_.value,class:Ae(["tab-button",{active:e.modelValue===_.value}]),onClick:D=>S.$emit("update:modelValue",_.value),type:"button"},[_.icon?(m(),y("span",{key:0,class:"tab-icon",innerHTML:V(xn)(_.icon)},null,8,pS)):F("",!0),We(" "+w(_.label),1)],10,fS))),128))]),c("div",vS,[c("div",{class:"hamburger-menu",ref_key:"hamburgerMenu",ref:s},[c("button",{ref_key:"hamburgerButton",ref:a,class:Ae(["hamburger-button",{active:l.value}]),onClick:St(p,["stop"]),type:"button"},[T[1]||(T[1]=c("span",{class:"hamburger-icon"},"",-1)),h.value?.icon?(m(),y("span",{key:0,class:"tab-icon",innerHTML:V(xn)(h.value.icon)},null,8,mS)):F("",!0),c("span",gS,w(f.value),1)],2),l.value?(m(),y("div",{key:0,class:"hamburger-dropdown",style:Dt(u.value),onClick:T[0]||(T[0]=St(()=>{},["stop"]))},[(m(!0),y(Te,null,Ne(e.tabs,_=>(m(),y("button",{key:_.value,class:Ae(["dropdown-item",{active:e.modelValue===_.value}]),onClick:St(D=>g(_.value),["stop"]),type:"button"},[_.icon?(m(),y("span",{key:0,class:"tab-icon",innerHTML:V(xn)(_.icon)},null,8,_S)):F("",!0),We(" "+w(_.label),1)],10,yS))),128))],4)):F("",!0)],512)])]))}},bS=Xe(kS,[["__scopeId","data-v-1710ea17"]]),wS={class:"share-link-container"},CS=["value"],LS={__name:"ShareLinkModal",props:{show:{type:Boolean,default:!1},link:{type:String,required:!0},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=t,i=O(!1),s=O(null),a=()=>{s.value&&(s.value.select(),document.execCommand("copy"),i.value=!0,setTimeout(()=>{i.value=!1},2e3))},l=()=>{o("close")};return(u,h)=>(m(),at(zt,{show:e.show,title:"Marshal check-in link",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:l},{actions:tt(()=>[c("button",{onClick:l,class:"btn btn-secondary"},"Close")]),default:tt(()=>[h[0]||(h[0]=c("p",{class:"instruction"},"Share this link with marshals so they can check in:",-1)),c("div",wS,[c("input",{value:e.link,readonly:"",class:"form-input",ref_key:"linkInput",ref:s},null,8,CS),c("button",{onClick:a,class:"btn btn-primary"},w(i.value?"Copied!":"Copy"),1)])]),_:1},8,["show","is-dirty"]))}},SS=Xe(LS,[["__scopeId","data-v-e3c38c66"]]),xS={class:"success-content"},TS={class:"success-message"},IS={class:"link-section"},$S={class:"help-text"},MS={key:0,class:"loading-text"},AS={key:1,class:"magic-link-container"},ES=["value"],PS={class:"magic-link-actions"},DS=["disabled"],OS={key:0,class:"success-text"},RS={key:1,class:"error-text"},BS={key:2,class:"error-text"},NS={__name:"MarshalCreatedModal",props:{show:{type:Boolean,default:!1},eventId:{type:String,required:!0},marshalId:{type:String,default:null},marshalName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const{terms:o}=yt(),i=e,s=t,a=O(""),l=O(!1),u=O(!1),h=O(""),f=O(!1),p=O(!1),g=O(!1),b=O(""),S=async()=>{if(!(!i.eventId||!i.marshalId)){u.value=!0,h.value="";try{const M=await co.getMagicLink(i.eventId,i.marshalId);a.value=M.data.magicLink,l.value=M.data.hasEmail}catch(M){console.error("Failed to fetch magic link:",M),h.value="Failed to load login link"}finally{u.value=!1}}},T=async()=>{try{await navigator.clipboard.writeText(a.value),f.value=!0,setTimeout(()=>{f.value=!1},2e3)}catch(M){console.error("Failed to copy:",M)}},_=async()=>{if(!(!i.eventId||!i.marshalId)){p.value=!0,g.value=!1,b.value="";try{await co.sendMagicLink(i.eventId,i.marshalId),g.value=!0,setTimeout(()=>{g.value=!1},3e3)}catch(M){console.error("Failed to send email:",M),b.value=M.response?.data?.message||"Failed to send email"}finally{p.value=!1}}},D=()=>{s("close")};return Ke(()=>i.show,M=>{M&&i.marshalId?S():(a.value="",l.value=!1,h.value="",f.value=!1,g.value=!1,b.value="")},{immediate:!0}),(M,x)=>(m(),at(zt,{show:e.show,title:`${V(o).person} created`,size:"medium","confirm-on-close":!1,"is-dirty":!1,onClose:D},{actions:tt(()=>[c("button",{onClick:D,class:"btn btn-primary"},"Done")]),default:tt(()=>[c("div",xS,[x[2]||(x[2]=c("div",{class:"success-icon"},"",-1)),c("p",TS,[c("strong",null,w(e.marshalName),1),x[1]||(x[1]=We(" has been added successfully. ",-1))])]),c("div",IS,[x[3]||(x[3]=c("label",null,"Login link",-1)),c("p",$S," Share this unique link with "+w(e.marshalName)+" so they can access their dashboard and check in. ",1),u.value?(m(),y("div",MS,"Loading link...")):a.value?(m(),y("div",AS,[c("input",{type:"text",value:a.value,readonly:"",class:"form-input magic-link-input",onFocus:x[0]||(x[0]=C=>C.target.select())},null,40,ES),c("div",PS,[c("button",{type:"button",class:"btn btn-secondary",onClick:T},w(f.value?"Copied!":"Copy link"),1),l.value?(m(),y("button",{key:0,type:"button",class:"btn btn-primary",disabled:p.value,onClick:_},w(p.value?"Sending...":"Send via email"),9,DS)):F("",!0)]),g.value?(m(),y("p",OS,"Email sent successfully!")):F("",!0),b.value?(m(),y("p",RS,w(b.value),1)):F("",!0)])):h.value?(m(),y("div",BS,w(h.value),1)):F("",!0)])]),_:1},8,["show","title"]))}},FS=Xe(NS,[["__scopeId","data-v-0de41f28"]]),zS={class:"form-group"},US={__name:"AddAdminModal",props:{show:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=O("");Ke(()=>o.show,h=>{h||(s.value="")});const a=()=>{i("update:isDirty",!0)},l=()=>{i("submit",s.value)},u=()=>{i("close")};return(h,f)=>(m(),at(zt,{show:e.show,title:"Add event administrator",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:tt(()=>[c("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:l,class:"btn btn-primary"}," Add administrator ")]),default:tt(()=>[f[2]||(f[2]=c("p",{class:"instruction"},"Enter the email address of the administrator to add",-1)),c("form",{onSubmit:St(l,["prevent"])},[c("div",zS,[f[1]||(f[1]=c("label",null,"Email address",-1)),Ze(c("input",{"onUpdate:modelValue":f[0]||(f[0]=p=>s.value=p),type:"email",required:"",class:"form-input",placeholder:"admin@example.com",onInput:a},null,544),[[ut,s.value]])])],32)]),_:1},8,["show","is-dirty"]))}},HS=Xe(US,[["__scopeId","data-v-43ad537f"]]),VS={class:"form-group"},ZS={key:0,class:"error"},jS=["disabled"],WS={__name:"UploadRouteModal",props:{show:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},error:{type:String,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=O(null);Ke(()=>o.show,h=>{h||(s.value=null)});const a=h=>{s.value=h.target.files[0],i("update:isDirty",!0)},l=()=>{s.value&&i("submit",s.value)},u=()=>{i("close")};return(h,f)=>(m(),at(zt,{show:e.show,title:"Upload GPX route",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:tt(()=>[c("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:l,class:"btn btn-primary",disabled:e.uploading},w(e.uploading?"Uploading...":"Upload route"),9,jS)]),default:tt(()=>[f[1]||(f[1]=c("p",{class:"instruction"},"Upload a GPX file to display the event route on the map",-1)),c("form",{onSubmit:St(l,["prevent"])},[c("div",VS,[f[0]||(f[0]=c("label",null,"GPX file",-1)),c("input",{type:"file",accept:".gpx",onChange:a,required:"",class:"form-input"},null,32)]),e.error?(m(),y("div",ZS,w(e.error),1)):F("",!0)],32)]),_:1},8,["show","is-dirty"]))}},qS=Xe(WS,[["__scopeId","data-v-1c1d3033"]]),GS={class:"instruction"},KS={class:"form-group"},YS={class:"form-group"},JS={class:"checkbox-label"},XS={key:0,class:"error"},QS={key:1,class:"import-result"},ex={key:0,class:"import-errors"},tx=["disabled"],nx={__name:"ImportLocationsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=yt(),s=e,a=t,l=O(null),u=O(!1);Ke(()=>s.show,b=>{b||(l.value=null,u.value=!1)});const h=b=>{l.value=b.target.files[0],a("update:isDirty",!0)},f=()=>{a("update:isDirty",!0)},p=()=>{l.value&&a("submit",{file:l.value,deleteExisting:u.value})},g=()=>{a("close")};return(b,S)=>(m(),at(zt,{show:e.show,title:`Import ${V(i).checkpoints} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:g},{actions:tt(()=>[c("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:p,class:"btn btn-primary",disabled:e.importing},w(e.importing?"Importing...":`Import ${V(i).checkpoints}`),9,tx)]),default:tt(()=>[c("p",GS,"Upload a CSV file with columns: Label, Lat/Latitude, Long/Longitude, What3Words (optional), "+w(V(o).people)+" (optional)",1),S[3]||(S[3]=c("div",{class:"csv-example"},[c("strong",null,"Example CSV format:"),c("pre",null,`Label,Latitude,Longitude,What3Words,Marshals
Checkpoint 1,51.505,-0.09,filled.count.soap,"John Doe, Jane Smith"
Checkpoint 2,51.510,-0.10,index.home.raft,Bob Wilson`)],-1)),c("form",{onSubmit:St(p,["prevent"])},[c("div",KS,[S[1]||(S[1]=c("label",null,"CSV file",-1)),c("input",{type:"file",accept:".csv",onChange:h,required:"",class:"form-input"},null,32)]),c("div",YS,[c("label",JS,[Ze(c("input",{type:"checkbox","onUpdate:modelValue":S[0]||(S[0]=T=>u.value=T),onChange:f},null,544),[[us,u.value]]),We(" Delete existing "+w(V(i).checkpoints)+" before import ",1)])]),e.error?(m(),y("div",XS,w(e.error),1)):F("",!0),e.result?(m(),y("div",QS,[c("p",null,"Created "+w(e.result.locationsCreated)+" "+w(V(i).checkpoints)+" and "+w(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(m(),y("div",ex,[S[2]||(S[2]=c("strong",null,"Errors:",-1)),c("ul",null,[(m(!0),y(Te,null,Ne(e.result.errors,(T,_)=>(m(),y("li",{key:_},w(T),1))),128))])])):F("",!0)])):F("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},ox=Xe(nx,[["__scopeId","data-v-e0a01848"]]),sx={class:"instruction"},ix={class:"form-group"},ax={key:0,class:"error"},rx={key:1,class:"import-result"},lx={key:0,class:"import-errors"},cx=["disabled"],ux={__name:"ImportMarshalsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=yt(),s=e,a=t,l=O(null);Ke(()=>s.show,p=>{p||(l.value=null)});const u=p=>{l.value=p.target.files[0],a("update:isDirty",!0)},h=()=>{l.value&&a("submit",l.value)},f=()=>{a("close")};return(p,g)=>(m(),at(zt,{show:e.show,title:`Import ${V(i).people} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:f},{actions:tt(()=>[c("button",{type:"button",onClick:f,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:h,class:"btn btn-primary",disabled:e.importing},w(e.importing?"Importing...":`Import ${V(i).people}`),9,cx)]),default:tt(()=>[c("p",sx,"Upload a CSV file with columns: Name, Email (optional), Phone (optional), "+w(V(o).checkpoint)+" (optional)",1),g[2]||(g[2]=c("div",{class:"csv-example"},[c("strong",null,"Example CSV format:"),c("pre",null,`Name,Email,Phone,Checkpoint
John Doe,john@example.com,555-1234,Checkpoint 1
Jane Smith,jane@example.com,555-5678,Checkpoint 2`)],-1)),c("form",{onSubmit:St(h,["prevent"])},[c("div",ix,[g[0]||(g[0]=c("label",null,"CSV file",-1)),c("input",{type:"file",accept:".csv",onChange:u,required:"",class:"form-input"},null,32)]),e.error?(m(),y("div",ax,w(e.error),1)):F("",!0),e.result?(m(),y("div",rx,[c("p",null,"Imported "+w(e.result.marshalsCreated)+" "+w(V(i).people)+" and "+w(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(m(),y("div",lx,[g[1]||(g[1]=c("strong",null,"Errors:",-1)),c("ul",null,[(m(!0),y(Te,null,Ne(e.result.errors,(b,S)=>(m(),y("li",{key:S},w(b),1))),128))])])):F("",!0)])):F("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},dx=Xe(ux,[["__scopeId","data-v-dcaed17c"]]),hx={key:0,class:"tabs"},fx=["onClick"],px=["innerHTML"],vx=["innerHTML"],mx={class:"current-tab-label"},gx={key:0,class:"hamburger-menu"},yx=["onClick"],_x=["innerHTML"],kx=400,bx={__name:"TabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,i=t,s=O(null),a=O(null),l=O(!1),u=O(!1),h=ae(()=>{const _=o.tabs.find(D=>D.value===o.modelValue);return _?_.label:""}),f=ae(()=>o.tabs.find(D=>D.value===o.modelValue)?.icon||null),p=()=>{if(!s.value)return;const _=s.value.clientWidth,D=o.tabs.length*100;l.value=D>_||_<kx},g=()=>{u.value=!u.value},b=_=>{i("update:modelValue",_),u.value=!1},S=_=>{a.value&&!a.value.contains(_.target)&&(u.value=!1)};let T=null;return rn(()=>{xi(()=>{p(),s.value&&typeof ResizeObserver<"u"&&(T=new ResizeObserver(()=>{p()}),T.observe(s.value)),document.addEventListener("click",S)})}),fo(()=>{T&&T.disconnect(),document.removeEventListener("click",S)}),Ke(()=>o.tabs,()=>{xi(()=>{p()})},{deep:!0}),(_,D)=>(m(),y("div",{class:"tabs-container",ref_key:"containerRef",ref:s},[l.value?(m(),y("div",{key:1,class:"hamburger-container",ref_key:"hamburgerRef",ref:a},[c("button",{class:"hamburger-button",onClick:g,type:"button","aria-label":"Tab menu"},[f.value?(m(),y("span",{key:0,class:"current-tab-icon",innerHTML:V(xn)(f.value)},null,8,vx)):F("",!0),c("span",mx,w(h.value),1),D[0]||(D[0]=c("span",{class:"hamburger-chevron"},"",-1))]),u.value?(m(),y("div",gx,[(m(!0),y(Te,null,Ne(e.tabs,M=>(m(),y("button",{key:M.value,class:Ae(["menu-item",{active:e.modelValue===M.value}]),onClick:x=>b(M.value),type:"button"},[M.icon?(m(),y("span",{key:0,class:"tab-icon",innerHTML:V(xn)(M.icon)},null,8,_x)):F("",!0),We(" "+w(M.label),1)],10,yx))),128))])):F("",!0)],512)):(m(),y("div",hx,[(m(!0),y(Te,null,Ne(e.tabs,M=>(m(),y("button",{key:M.value,class:Ae(["tab-button",{active:e.modelValue===M.value}]),onClick:x=>_.$emit("update:modelValue",M.value),type:"button"},[M.icon?(m(),y("span",{key:0,class:"tab-icon",innerHTML:V(xn)(M.icon)},null,8,px)):F("",!0),We(" "+w(M.label),1)],10,fx))),128))]))],512))}},uu=Xe(bx,[["__scopeId","data-v-5c12f1ab"]]),wx={class:"tab-content"},Cx={class:"form-group"},Lx=["value"],Sx={class:"form-group"},xx=["value"],Tx={class:"form-group"},Ix={class:"area-display"},$x={key:0,class:"no-area"},Mx={class:"form-help"},Ax={class:"form-group checkbox-group"},Ex={class:"checkbox-label"},Px=["checked"],Dx={class:"form-help"},Ox={key:0,class:"custom-times-section"},Rx={class:"form-group"},Bx=["value"],Nx={class:"form-help"},Fx={class:"form-group"},zx=["value"],Ux={class:"form-help"},Hx={__name:"LocationDetailsTab",props:{form:{type:Object,required:!0},areas:{type:Array,default:()=>[]},eventDate:{type:String,default:""},areaTermSingular:{type:String,default:"Area"},areaTermPlural:{type:String,default:"Areas"},checkpointTermSingular:{type:String,default:"checkpoint"},peopleTermPlural:{type:String,default:"marshals"}},emits:["update:form","input","save"],setup(e,{emit:t}){const o=e,i=t,s=ae(()=>(o.form.areaIds||o.form.AreaIds||[]).map(h=>o.areas.find(f=>f.id===h)).filter(h=>h!==void 0)),a=(u,h)=>{i("update:form",{...o.form,[u]:h}),i("input")},l=u=>{const h={...o.form,useCustomTimes:u};if(!u)h.startTime="",h.endTime="";else if(!h.startTime&&!h.endTime&&o.eventDate){const f=Ra(o.eventDate);h.startTime=f,h.endTime=f}i("update:form",h),i("input")};return(u,h)=>(m(),y("div",wx,[c("form",{onSubmit:h[5]||(h[5]=St(f=>u.$emit("save"),["prevent"]))},[c("div",Cx,[h[6]||(h[6]=c("label",null,"Name",-1)),c("input",{value:e.form.name,onInput:h[0]||(h[0]=f=>a("name",f.target.value)),type:"text",required:"",class:"form-input"},null,40,Lx)]),c("div",Sx,[h[7]||(h[7]=c("label",null,"Description (optional)",-1)),c("input",{value:e.form.description,onInput:h[1]||(h[1]=f=>a("description",f.target.value)),type:"text",class:"form-input"},null,40,xx)]),c("div",Tx,[c("label",null,w(e.areaTermSingular)+" (auto-assigned by location)",1),c("div",Ix,[s.value.length===0?(m(),y("span",$x," Not in any "+w(e.areaTermSingular.toLowerCase())+" polygon ",1)):F("",!0),(m(!0),y(Te,null,Ne(s.value,f=>(m(),y("span",{key:f.id,class:"area-badge",style:Dt({backgroundColor:f.color||"#667eea"})},w(f.name),5))),128))]),c("small",Mx,w(e.areaTermPlural)+" are automatically assigned based on "+w(e.checkpointTermSingular.toLowerCase())+" location within "+w(e.areaTermSingular.toLowerCase())+" boundaries ",1)]),c("div",Ax,[c("label",Ex,[c("input",{checked:e.form.useCustomTimes,onChange:h[2]||(h[2]=f=>l(f.target.checked)),type:"checkbox"},null,40,Px),c("span",null,"Use custom date/time for this "+w(e.checkpointTermSingular.toLowerCase()),1)]),c("small",Dx," By default, "+w(e.peopleTermPlural.toLowerCase())+" are expected during the event date/time. Enable this to set a specific time range. ",1)]),e.form.useCustomTimes?(m(),y("div",Ox,[c("div",Rx,[h[8]||(h[8]=c("label",null,"Start date & time (optional)",-1)),c("input",{value:e.form.startTime,onInput:h[3]||(h[3]=f=>a("startTime",f.target.value)),type:"datetime-local",class:"form-input"},null,40,Bx),c("small",Nx," When "+w(e.peopleTermPlural.toLowerCase())+" should arrive at this "+w(e.checkpointTermSingular.toLowerCase()),1)]),c("div",Fx,[h[9]||(h[9]=c("label",null,"End date & time (optional)",-1)),c("input",{value:e.form.endTime,onInput:h[4]||(h[4]=f=>a("endTime",f.target.value)),type:"datetime-local",class:"form-input"},null,40,zx),c("small",Ux," When "+w(e.peopleTermPlural.toLowerCase())+" can leave this "+w(e.checkpointTermSingular.toLowerCase()),1)])])):F("",!0)],32)]))}},Vx=Xe(Hx,[["__scopeId","data-v-628fdfe3"]]),Zx={class:"scope-configuration-editor"},jx={class:"editor-header"},Wx={class:"scope-types-list"},qx=["onClick"],Gx={class:"scope-type-label"},Kx={class:"scope-type-pill"},Yx={class:"expand-label"},Jx={class:"expand-icon"},Xx={class:"modal-content"},Qx={class:"modal-header"},eT={class:"modal-body"},tT={class:"scope-help"},nT={key:0,class:"form-group"},oT={class:"checkbox-label special-option"},sT=["checked"],iT={key:0,class:"specific-selection"},aT=["placeholder"],rT={class:"checkbox-group scrollable"},lT=["checked","onChange"],cT={key:1,class:"form-group"},uT={class:"checkbox-label special-option"},dT=["checked"],hT={key:0,class:"specific-selection"},fT={class:"checkbox-group scrollable"},pT=["checked","onChange"],vT={key:2,class:"form-group"},mT={class:"checkbox-label special-option"},gT=["checked"],yT={key:0,class:"specific-selection"},_T=["placeholder"],kT={class:"checkbox-group scrollable"},bT={key:0,class:"checkbox-label this-checkpoint-option"},wT=["checked"],CT={class:"checkpoint-info"},LT={class:"checkpoint-name"},ST=["checked","onChange"],xT={class:"checkpoint-info"},TT={class:"checkpoint-name"},IT={key:0,class:"checkpoint-description"},$T={__name:"ScopeConfigurationEditor",props:{modelValue:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},excludeScopes:{type:Array,default:()=>[]},headerText:{type:String,default:""},intent:{type:String,default:"completion",validator:e=>["completion","location-update"].includes(e)},currentCheckpointId:{type:String,default:null}},emits:["update:modelValue","user-changed"],setup(e,{emit:t}){const{termsLower:o}=yt(),i=e,s=t,a=ae(()=>[{scope:"SpecificPeople",label:`Specific ${o.value.people}`},{scope:"EveryoneAtCheckpoints",label:`Every ${o.value.person} at specified ${o.value.checkpoints}`},{scope:"OnePerCheckpoint",label:`One ${o.value.person} at each specified ${o.value.checkpoint}`},{scope:"OnePerArea",label:`One ${o.value.person} in specified ${o.value.areas}`},{scope:"EveryoneInAreas",label:`Everyone in specified ${o.value.areas}`},{scope:"EveryAreaLead",label:`Every ${o.value.area} lead at specified ${o.value.areas}`},{scope:"OneLeadPerArea",label:`One lead per specified ${o.value.area}`}]),l=O({SpecificPeople:{enabled:!0,ids:["ALL_MARSHALS"]},EveryoneInAreas:{enabled:!1,ids:[]},EveryoneAtCheckpoints:{enabled:!1,ids:[]},OnePerCheckpoint:{enabled:!1,ids:[]},OnePerArea:{enabled:!1,ids:[]},EveryAreaLead:{enabled:!1,ids:[]},OneLeadPerArea:{enabled:!1,ids:[]}}),u=O(null),h=O(""),f=O(""),p=O(!i.isEditing);let g=!0,b=!1;const S=ae(()=>a.value.filter(ne=>!i.excludeScopes.includes(ne.scope))),T=ae(()=>p.value?S.value:S.value.filter(ne=>ge(ne.scope))),_=ae(()=>S.value.filter(de=>ge(de.scope)).length<S.value.length),D=ae(()=>{const ne=S.value.filter(de=>ge(de.scope)).length;return S.value.length-ne}),M=ae(()=>!i.currentCheckpointId&&i.intent==="location-update");Ke(()=>i.modelValue,ne=>{if(ne){if(b){b=!1;return}g=!0,Object.keys(l.value).forEach(de=>{l.value[de]={enabled:!1,ids:[]}}),ne.forEach(de=>{de.scope==="Everyone"?l.value.SpecificPeople={enabled:!0,ids:["ALL_MARSHALS"]}:de.scope==="AreaLead"?l.value.EveryAreaLead={enabled:!0,ids:[...de.ids]}:l.value[de.scope]&&(l.value[de.scope]={enabled:!0,ids:[...de.ids]})}),g=!1}},{immediate:!0});const x=()=>{const ne=[];return Object.keys(l.value).forEach(de=>{const Le=l.value[de];if(Le.enabled){const B={scope:de,itemType:C(de),ids:[...Le.ids]};ne.push(B)}}),ne};Ke(l,()=>{if(g)return;if(Object.keys(l.value).some(Le=>Le!=="SpecificPeople"&&l.value[Le].enabled)&&l.value.SpecificPeople?.ids.includes("ALL_MARSHALS")){const Le=l.value.SpecificPeople.ids.indexOf("ALL_MARSHALS");l.value.SpecificPeople.ids.splice(Le,1),l.value.SpecificPeople.ids.length===0&&(l.value.SpecificPeople.enabled=!1)}b=!0;const de=x();s("update:modelValue",de),s("user-changed")},{deep:!0});const C=ne=>A(ne)?"Area":I(ne)?"Checkpoint":$(ne)?"Marshal":null,A=ne=>ne==="EveryoneInAreas"||ne==="OnePerArea"||ne==="EveryAreaLead"||ne==="OneLeadPerArea",I=ne=>ne==="EveryoneAtCheckpoints"||ne==="OnePerCheckpoint",$=ne=>ne==="SpecificPeople",E=ne=>{const de=a.value.find(Le=>Le.scope===ne);return de?de.label:ne},ie=ae(()=>i.headerText?i.headerText:i.intent==="location-update"?"Who can update this location?":"Who can see and complete this item?"),ce=ne=>i.intent==="location-update"?{SpecificPeople:`Select "Everyone" or choose specific ${o.value.people} who can update the location`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} can update the location`,OnePerCheckpoint:`Any ${o.value.person} at each selected ${o.value.checkpoint} can update the location`,OnePerArea:`Any ${o.value.person} in each selected ${o.value.area} can update the location`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} can update the location`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} can update the location`,OneLeadPerArea:`Any ${o.value.area} lead at the selected ${o.value.areas} can update the location`}[ne]||"":{SpecificPeople:`Select "Everyone at the event" or choose specific ${o.value.people} who must complete this (personal completion)`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} must complete this (personal completion)`,OnePerCheckpoint:`One completion needed at each selected ${o.value.checkpoint} (shared completion)`,OnePerArea:`One completion needed in each selected ${o.value.area} (shared completion)`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} must complete this (personal completion)`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} must complete this individually (personal completion)`,OneLeadPerArea:`One completion per ${o.value.area}, only ${o.value.area} leads can complete (shared among leads)`}[ne]||"",ge=ne=>l.value[ne]?.enabled||!1,re=ne=>{const de=l.value[ne];if(!de||!de.enabled)return"No";const Le=de.ids||[];if(A(ne)){if(Le.includes("ALL_AREAS"))return`All ${o.value.areas}`;const B=Le.length;return B>0?`${B} ${B!==1?o.value.areas:o.value.area}`:`Select ${o.value.areas}...`}if(I(ne)){if(Le.includes("ALL_CHECKPOINTS"))return`All ${o.value.checkpoints}`;if(Le.length===1&&Le[0]==="THIS_CHECKPOINT")return`This ${o.value.checkpoint}`;const B=Le.length;return B>0?`${B} ${B!==1?o.value.checkpoints:o.value.checkpoint}`:`Select ${o.value.checkpoints}...`}if($(ne)){if(Le.includes("ALL_MARSHALS"))return"Everyone";const B=Le.length;return B>0?`${B} ${B!==1?o.value.people:o.value.person}`:`Select ${o.value.people}...`}return"Configured"},ve=ne=>{u.value=ne,h.value="",f.value=""},Be=()=>{u.value=null},He=()=>{u.value&&(l.value[u.value]={enabled:!1,ids:[]}),Be()},Oe=()=>u.value&&l.value[u.value]?.ids.includes("ALL_MARSHALS"),fe=()=>{if(!u.value)return;const ne=l.value[u.value];Oe()?(ne.ids=[],ne.enabled=!1):(ne.ids=["ALL_MARSHALS"],ne.enabled=!0)},q=ne=>u.value&&l.value[u.value]?.ids.includes(ne),j=ne=>{if(!u.value)return;const de=l.value[u.value],Le=de.ids.indexOf(ne);Le>=0?(de.ids.splice(Le,1),de.ids.length===0&&(de.enabled=!1)):(de.ids.push(ne),de.enabled=!0)},ue=ae(()=>{if(!f.value)return i.marshals;const ne=f.value.toLowerCase();return i.marshals.filter(de=>de.name.toLowerCase().includes(ne)||de.email&&de.email.toLowerCase().includes(ne))}),K=()=>u.value&&l.value[u.value]?.ids.includes("ALL_AREAS"),pe=()=>{if(!u.value)return;const ne=l.value[u.value];K()?(ne.ids=[],ne.enabled=!1):(ne.ids=["ALL_AREAS"],ne.enabled=!0)},X=ne=>u.value&&l.value[u.value]?.ids.includes(ne),we=ne=>{if(!u.value)return;const de=l.value[u.value],Le=de.ids.indexOf(ne);Le>=0?(de.ids.splice(Le,1),de.ids.length===0&&(de.enabled=!1)):(de.ids.push(ne),de.enabled=!0)},De=()=>u.value&&l.value[u.value]?.ids.includes("ALL_CHECKPOINTS"),Se=()=>{if(!u.value)return;const ne=l.value[u.value];De()?(ne.ids=[],ne.enabled=!1):(ne.ids=["ALL_CHECKPOINTS"],ne.enabled=!0)},Ee=ne=>u.value&&l.value[u.value]?.ids.includes(ne),se=ne=>{if(!u.value)return;const de=l.value[u.value],Le=de.ids.indexOf(ne);Le>=0?(de.ids.splice(Le,1),de.ids.length===0&&(de.enabled=!1)):(de.ids.push(ne),de.enabled=!0)},me=ae(()=>{let ne=i.locations;if(h.value){const de=h.value.toLowerCase();ne=ne.filter(Le=>Le.name.toLowerCase().includes(de)||Le.description&&Le.description.toLowerCase().includes(de))}return[...ne].sort((de,Le)=>_n(de.name,Le.name))});return(ne,de)=>(m(),y("div",Zx,[c("div",jx,[c("h4",null,w(ie.value),1)]),c("div",Wx,[(m(!0),y(Te,null,Ne(T.value,Le=>(m(),y("div",{key:Le.scope,class:Ae(["scope-type-row",{active:ge(Le.scope)}]),onClick:B=>ve(Le.scope)},[c("div",Gx,w(Le.label),1),c("div",Kx,w(re(Le.scope)),1)],10,qx))),128)),_.value?(m(),y("div",{key:0,class:"expand-row",onClick:de[0]||(de[0]=Le=>p.value=!p.value)},[c("div",Yx,w(p.value?"Show less":`Show ${D.value} more option${D.value!==1?"s":""}...`),1),c("div",Jx,w(p.value?"":""),1)])):F("",!0)]),u.value?(m(),y("div",{key:0,class:"scope-config-modal",onClick:St(Be,["self"])},[c("div",Xx,[c("div",Qx,[c("h5",null,w(E(u.value)),1),c("button",{onClick:Be,class:"btn-close",type:"button"},"")]),c("div",eT,[c("p",tT,w(ce(u.value)),1),$(u.value)?(m(),y("div",nT,[c("label",oT,[c("input",{type:"checkbox",checked:Oe(),onChange:fe},null,40,sT),c("span",null,[de[4]||(de[4]=c("strong",null,"Everyone at the event",-1)),We(" (all current and future "+w(V(o).people)+")",1)])]),Oe()?F("",!0):(m(),y("div",iT,[Ze(c("input",{"onUpdate:modelValue":de[1]||(de[1]=Le=>f.value=Le),type:"text",placeholder:`Search ${V(o).people}...`,class:"search-input"},null,8,aT),[[ut,f.value]]),c("div",rT,[(m(!0),y(Te,null,Ne(ue.value,Le=>(m(),y("label",{key:Le.id,class:"checkbox-label"},[c("input",{type:"checkbox",checked:q(Le.id),onChange:B=>j(Le.id)},null,40,lT),c("span",null,w(Le.name),1)]))),128))])]))])):F("",!0),A(u.value)?(m(),y("div",cT,[c("label",uT,[c("input",{type:"checkbox",checked:K(),onChange:pe},null,40,dT),c("span",null,[c("strong",null,"All "+w(V(o).areas),1),We(" (includes future "+w(V(o).areas)+")",1)])]),K()?F("",!0):(m(),y("div",hT,[c("div",fT,[(m(!0),y(Te,null,Ne(e.areas,Le=>(m(),y("label",{key:Le.id,class:"checkbox-label"},[c("input",{type:"checkbox",checked:X(Le.id),onChange:B=>we(Le.id)},null,40,pT),c("span",{class:"area-color-dot",style:Dt({backgroundColor:Le.color||"#667eea"})},null,4),c("span",null,w(Le.name),1)]))),128))])]))])):F("",!0),I(u.value)?(m(),y("div",vT,[c("label",mT,[c("input",{type:"checkbox",checked:De(),onChange:Se},null,40,gT),c("span",null,[c("strong",null,"All "+w(V(o).checkpoints),1),We(" (includes future "+w(V(o).checkpoints)+")",1)])]),De()?F("",!0):(m(),y("div",yT,[Ze(c("input",{"onUpdate:modelValue":de[2]||(de[2]=Le=>h.value=Le),type:"text",placeholder:`Search ${V(o).checkpoints}...`,class:"search-input"},null,8,_T),[[ut,h.value]]),c("div",kT,[M.value?(m(),y("label",bT,[c("input",{type:"checkbox",checked:Ee("THIS_CHECKPOINT"),onChange:de[3]||(de[3]=Le=>se("THIS_CHECKPOINT"))},null,40,wT),c("div",CT,[c("span",LT,[c("strong",null,"This "+w(V(o).checkpoint),1)])])])):F("",!0),(m(!0),y(Te,null,Ne(me.value,Le=>(m(),y("label",{key:Le.id,class:"checkbox-label"},[c("input",{type:"checkbox",checked:Ee(Le.id),onChange:B=>se(Le.id)},null,40,ST),c("div",xT,[c("span",TT,w(Le.name),1),Le.description?(m(),y("span",IT," - "+w(Le.description),1)):F("",!0)])]))),128))])]))])):F("",!0)]),c("div",{class:"modal-footer"},[c("button",{onClick:He,class:"btn btn-secondary",type:"button"},"Deselect all"),c("button",{onClick:Be,class:"btn btn-primary",type:"button"},"Done")])])])):F("",!0)]))}},kl=Xe($T,[["__scopeId","data-v-97d31f0e"]]),MT={class:"tab-content"},AT={class:"form-group"},ET=["value"],PT={key:0,class:"form-error"},DT={class:"form-row"},OT={class:"form-group"},RT=["value","disabled"],BT={class:"form-group"},NT=["value","disabled"],FT={class:"form-group"},zT={class:"accordion-item"},UT={class:"accordion-preview"},HT={class:"accordion-arrow"},VT={key:0,class:"accordion-content"},ZT={class:"section-description"},jT={class:"dynamic-checkbox"},WT=["checked"],qT={key:0,class:"dynamic-settings"},GT={__name:"LocationCoordinatesTab",props:{form:{type:Object,required:!0},isMoving:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:"Checkpoint"},peopleTermPlural:{type:String,default:"Marshals"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:form","input","save","move-location"],setup(e,{emit:t}){const o=e,i=t,s=O(!1),a=g=>g==null||g===""?"":Number(g).toFixed(6),l=(g,b)=>{i("update:form",{...o.form,[g]:b}),i("input")},u=(g,b)=>{i("update:form",{...o.form,[g]:Number(b)}),i("input")},h=g=>{if(g){const b=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],S=o.form.locationUpdateScopeConfigurations||[],T=S.length>0?S:b;i("update:form",{...o.form,isDynamic:!0,latitude:0,longitude:0,locationUpdateScopeConfigurations:T})}else i("update:form",{...o.form,isDynamic:!1});i("input")},f=g=>{i("update:form",{...o.form,locationUpdateScopeConfigurations:g}),i("input")},p=g=>{if(!g)return!0;const b=g.includes(".")?g.split("."):g.split("/");if(b.length!==3)return!1;const S=/^[a-z]{1,20}$/;return b.every(T=>S.test(T))};return(g,b)=>(m(),y("div",MT,[c("form",{onSubmit:b[4]||(b[4]=St(S=>g.$emit("save"),["prevent"]))},[c("div",AT,[b[8]||(b[8]=c("label",null,"What3Words (optional)",-1)),c("input",{value:e.form.what3Words,onInput:b[0]||(b[0]=S=>l("what3Words",S.target.value)),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap"},null,40,ET),e.form.what3Words&&!p(e.form.what3Words)?(m(),y("small",PT," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):F("",!0)]),e.form.isDynamic?F("",!0):(m(),y(Te,{key:0},[c("div",DT,[c("div",OT,[b[9]||(b[9]=c("label",null,"Longitude",-1)),c("input",{value:a(e.form.longitude),onInput:b[1]||(b[1]=S=>u("longitude",S.target.value)),type:"number",step:"0.000001",required:"",class:"form-input",disabled:e.isMoving,placeholder:"e.g., -0.091234"},null,40,RT)]),c("div",BT,[b[10]||(b[10]=c("label",null,"Latitude",-1)),c("input",{value:a(e.form.latitude),onInput:b[2]||(b[2]=S=>u("latitude",S.target.value)),type:"number",step:"0.000001",required:"",class:"form-input",disabled:e.isMoving,placeholder:"e.g., 51.505123"},null,40,NT)])]),c("div",FT,[c("button",{type:"button",onClick:b[3]||(b[3]=S=>g.$emit("move-location")),class:Ae(["btn btn-secondary btn-with-icon",{"btn-primary":e.isMoving}])},[b[11]||(b[11]=c("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),We(" "+w(e.isMoving?"Click on map to set new location...":`Move ${e.checkpointTermSingular.toLowerCase()}...`),1)],2)])],64))],32),c("div",zT,[c("button",{type:"button",class:Ae(["accordion-header",{expanded:s.value}]),onClick:b[5]||(b[5]=S=>s.value=!s.value)},[b[12]||(b[12]=$f('<div class="accordion-icon" data-v-8b8b9436><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-8b8b9436><path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="#F59E0B" opacity="0.3" data-v-8b8b9436></path><path d="M12 6L13.5 9L17 9.5L14.5 12L15 15.5L12 14L9 15.5L9.5 12L7 9.5L10.5 9L12 6Z" fill="#F59E0B" data-v-8b8b9436></path><circle cx="12" cy="11" r="2" fill="white" data-v-8b8b9436></circle></svg></div><span class="accordion-title" data-v-8b8b9436>Dynamic location</span>',2)),c("span",UT,w(e.form.isDynamic?"Enabled":"Disabled"),1),c("span",HT,w(s.value?"":""),1)],2),s.value?(m(),y("div",VT,[c("p",ZT," Enable this for lead cars, sweep vehicles, or other moving "+w(e.checkpointTermSingular.toLowerCase())+"s whose location can be updated by designated "+w(e.peopleTermPlural.toLowerCase())+" during the event. ",1),c("label",jT,[c("input",{type:"checkbox",checked:e.form.isDynamic,onChange:b[6]||(b[6]=S=>h(S.target.checked))},null,40,WT),c("span",null,"This "+w(e.checkpointTermSingular.toLowerCase())+" can move",1)]),e.form.isDynamic?(m(),y("div",qT,[Ve(kl,{"model-value":e.form.locationUpdateScopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":e.isEditing,"header-text":`Who can update this ${e.checkpointTermSingular.toLowerCase()}'s location?`,"exclude-scopes":["OnePerCheckpoint","OneLeadPerArea","OnePerArea"],intent:"location-update","current-checkpoint-id":e.form.id,"onUpdate:modelValue":f,onUserChanged:b[7]||(b[7]=S=>g.$emit("input"))},null,8,["model-value","areas","locations","marshals","is-editing","header-text","current-checkpoint-id"])])):F("",!0)])):F("",!0)])]))}},KT=Xe(GT,[["__scopeId","data-v-8b8b9436"]]);function Ep(e){const t=O(new Map),o=p=>t.value.has(p.id)?t.value.get(p.id):p.isCheckedIn;return{pendingCheckInChanges:t,getEffectiveCheckInStatus:o,handleToggleCheckIn:p=>{const b=!o(p);b===p.isCheckedIn?t.value.delete(p.id):t.value.set(p.id,b),e&&e()},getStatusIcon:p=>o(p)?"":"",getStatusColor:p=>o(p)?"#28a745":"#dc3545",getStatusText:p=>o(p)?"Checked in":"Not checked in",formatTime:p=>p?new Date(p).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",clearPendingChanges:()=>{t.value.clear()},getPendingChanges:()=>Array.from(t.value.entries()).map(([p,g])=>({assignmentId:p,shouldBeCheckedIn:g}))}}const YT={class:"tab-content"},JT={class:"form-group"},XT=["value"],QT={class:"section-title"},eI={class:"assignments-list"},tI={class:"assignment-info"},nI={class:"assignment-header"},oI=["title"],sI={key:1,class:"status-indicator pending-indicator",title:"Will be assigned on save"},iI={key:2,class:"pending-badge"},aI={key:3,class:"pending-badge"},rI={key:0,class:"check-in-info"},lI={class:"check-in-method"},cI={class:"assignment-actions"},uI=["onClick"],dI=["onClick"],hI={class:"assign-section"},fI={__name:"LocationAssignmentsTab",props:{form:{type:Object,required:!0},assignments:{type:Array,default:()=>[]},peopleTerm:{type:String,default:"Marshals"},personTerm:{type:String,default:"Marshal"}},emits:["update:form","input","remove-assignment","open-assign-modal"],setup(e,{expose:t,emit:o}){const i=e,s=ae(()=>i.peopleTerm.toLowerCase()),a=ae(()=>i.personTerm.toLowerCase()),l=o,{pendingCheckInChanges:u,getEffectiveCheckInStatus:h,handleToggleCheckIn:f,getStatusIcon:p,getStatusColor:g,getStatusText:b,formatTime:S}=Ep(()=>l("input")),T=ae(()=>i.assignments?.length||0),_=ae(()=>i.assignments?[...i.assignments].sort((M,x)=>{const C=M.marshalName?.toLowerCase()||"",A=x.marshalName?.toLowerCase()||"";return C.localeCompare(A)}):[]),D=(M,x)=>{l("update:form",{...i.form,[M]:Number(x)}),l("input")};return t({pendingCheckInChanges:u,clearPendingChanges:()=>{u.value.clear()},getPendingChanges:()=>Array.from(u.value.entries()).map(([M,x])=>({assignmentId:M,shouldBeCheckedIn:x}))}),(M,x)=>(m(),y("div",YT,[c("div",JT,[c("label",null,"Required "+w(s.value),1),c("input",{value:e.form.requiredMarshals,onInput:x[0]||(x[0]=C=>D("requiredMarshals",C.target.value)),type:"number",min:"1",required:"",class:"form-input"},null,40,XT)]),c("h3",QT,"Assigned "+w(s.value)+" ("+w(T.value)+")",1),c("div",eI,[(m(!0),y(Te,null,Ne(_.value,C=>(m(),y("div",{key:C.id,class:Ae(["assignment-item",{"checked-in":!C.isPending&&V(h)(C),"is-pending":C.isPending}])},[c("div",tI,[c("div",nI,[C.isPending?(m(),y("span",sI,"  ")):(m(),y("span",{key:0,class:"status-indicator",style:Dt({color:V(g)(C)}),title:V(b)(C)},w(V(p)(C)),13,oI)),c("strong",null,w(C.marshalName),1),C.isPending?(m(),y("span",iI," (will be assigned on save) ")):V(u).has(C.id)?(m(),y("span",aI," (unsaved) ")):F("",!0)]),!C.isPending&&V(h)(C)?(m(),y("span",rI,[C.isCheckedIn&&!V(u).has(C.id)?(m(),y(Te,{key:0},[We(w(V(S)(C.checkInTime))+" ",1),c("span",lI,"("+w(C.checkInMethod)+")",1)],64)):(m(),y(Te,{key:1},[We(" Will be checked in on save ")],64))])):F("",!0)]),c("div",cI,[C.isPending?F("",!0):(m(),y("button",{key:0,onClick:A=>V(f)(C),class:Ae(["btn btn-small",V(h)(C)?"btn-danger":"btn-secondary"])},w(V(h)(C)?"Undo":"Check in"),11,uI)),c("button",{onClick:A=>M.$emit("remove-assignment",C),class:"btn btn-small btn-danger"}," Remove ",8,dI)])],2))),128)),c("div",hI,[c("button",{type:"button",class:"btn btn-primary assign-btn",onClick:x[1]||(x[1]=C=>M.$emit("open-assign-modal"))}," + Assign "+w(a.value)+"... ",1)])])]))}},pI=Xe(fI,[["__scopeId","data-v-233b845e"]]),vI={class:"checkpoint-checklist-view"},mI={key:0,class:"loading-state"},gI={key:1,class:"error-state"},yI={key:2,class:"empty-state"},_I={key:3,class:"empty-state"},kI={key:4,class:"checklist-items"},bI={class:"item-checkbox"},wI=["checked","disabled","onChange"],CI={class:"item-content"},LI={class:"item-header"},SI={class:"item-text-wrapper"},xI={class:"item-text"},TI={key:0,class:"item-context"},II={class:"item-scope"},$I=["title"],MI={key:0,class:"completion-info"},AI={key:0,class:"pending-text"},EI={class:"completion-text"},PI={class:"completion-time"},DI={key:1,class:"uncomplete-info"},OI={key:2,class:"disabled-reason"},RI={__name:"CheckpointChecklistView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=yt(),a=e,l=o,u=O([]),h=O(!1),f=O(null),p=O(new Map),g=ae(()=>a.assignments.length===0),b=ae(()=>u.value.map(I=>{const $=p.value.get(`${I.itemId}|||${I.completionContextId}`),E=$!==void 0?$.complete:I.isCompleted,ie=$!==void 0&&$.complete!==I.isCompleted;return{...I,localIsCompleted:E,isModified:ie}})),S=async()=>{if(!(!a.eventId||!a.locationId&&!a.areaId)){h.value=!0,f.value=null;try{const I=a.locationId?await It.getCheckpointChecklist(a.eventId,a.locationId):await It.getAreaChecklist(a.eventId,a.areaId);if(u.value=I.data||[],a.modelValue&&a.modelValue.length>0){const $=new Map;a.modelValue.forEach(E=>{$.set(`${E.itemId}|||${E.contextId}`,{complete:E.complete,contextType:E.contextType,contextId:E.contextId})}),p.value=$}}catch(I){console.error("Failed to load checklist:",I),f.value=I.response?.data?.message||"Failed to load checklist"}finally{h.value=!1}}},T=I=>{const $=I.contextOwnerMarshalId||(a.assignments.length>0?a.assignments[0].marshalId:null);if(!$)return;const E=`${I.itemId}|||${I.completionContextId}`,ie=p.value.get(E),ce=ie!==void 0?ie.complete:I.isCompleted;p.value.set(E,{complete:!ce,contextType:I.completionContextType,contextId:I.completionContextId,marshalId:$}),_()},_=()=>{const I=[];for(const[$,E]of p.value.entries()){const[ie,ce]=$.split("|||"),ge=u.value.find(re=>re.itemId===ie&&re.completionContextId===ce);ge&&E.complete!==ge.isCompleted&&I.push({itemId:ie,complete:E.complete,contextType:E.contextType,contextId:E.contextId,marshalId:E.marshalId})}l("update:modelValue",I),l("change",I)};t({resetLocalState:()=>{if(p.value=new Map,a.modelValue&&a.modelValue.length>0){const I=new Map;a.modelValue.forEach($=>{I.set(`${$.itemId}|||${$.contextId}`,{complete:$.complete,contextType:$.contextType,contextId:$.contextId,marshalId:$.marshalId})}),p.value=I}},loadChecklist:S});const M=I=>({Everyone:"Everyone",SpecificPeople:"Assigned to you",EveryoneInAreas:`Your ${s.value.areas}`,EveryoneAtCheckpoints:`Your ${s.value.checkpoints}`,OnePerCheckpoint:`One per ${s.value.checkpoint}`,OnePerArea:`One per ${s.value.area}`,EveryAreaLead:`${i.value.area} lead`,OneLeadPerArea:`One lead per ${s.value.area}`})[I.matchedScope]||I.matchedScope,x=I=>({Everyone:"This item is for everyone at the event",SpecificPeople:"This item is specifically assigned to certain people",EveryoneInAreas:`This item is for everyone in certain ${s.value.areas}`,EveryoneAtCheckpoints:`This item is for everyone at certain ${s.value.checkpoints}`,OnePerCheckpoint:`One person at the ${s.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${s.value.area} needs to complete this`,EveryAreaLead:`This item is for ${s.value.area} leads only`,OneLeadPerArea:`One ${s.value.area} lead needs to complete this`})[I.matchedScope]||"",C=I=>{if(!I.completionContextType||!I.completionContextId)return null;if(I.completionContextType==="Checkpoint"){const $=a.locations.find(ie=>ie.id===I.completionContextId);if(!$)return null;const E=$.description?`${$.name} - ${$.description}`:$.name;return`at ${s.value.checkpoint} ${E}`}if(I.completionContextType==="Area"){const $=a.areas.find(E=>E.id===I.completionContextId);return $?`in ${s.value.area} ${$.name}`:null}return I.completionContextType==="Personal"?I.contextOwnerName?`for ${I.contextOwnerName}`:"assigned individually":null},A=I=>I?new Date(I).toLocaleString():"";return Ke(()=>[a.eventId,a.locationId,a.areaId],()=>{S()},{immediate:!0}),(I,$)=>(m(),y("div",vI,[h.value?(m(),y("div",mI," Loading checklist... ")):f.value?(m(),y("div",gI,[c("p",null,w(f.value),1),c("button",{onClick:S,class:"btn btn-secondary btn-small"}," Retry ")])):g.value?(m(),y("div",yI,[...$[0]||($[0]=[c("p",null,"No marshals assigned to this checkpoint yet.",-1),c("p",{class:"help-text"},"Assign marshals to enable checklist completion.",-1)])])):u.value.length===0?(m(),y("div",_I,[...$[1]||($[1]=[c("p",null,"No checklist items for this checkpoint.",-1)])])):(m(),y("div",kI,[(m(!0),y(Te,null,Ne(b.value,E=>(m(),y("div",{key:`${E.itemId}-${E.completionContextId}`,class:Ae(["checklist-item",{"item-completed":E.localIsCompleted,"item-modified":E.isModified}])},[c("div",bI,[c("input",{type:"checkbox",checked:E.localIsCompleted,disabled:!E.canBeCompletedByMe&&!E.localIsCompleted,onChange:ie=>T(E)},null,40,wI)]),c("div",CI,[c("div",LI,[c("div",SI,[c("div",xI,w(E.text),1),C(E)?(m(),y("div",TI,w(C(E)),1)):F("",!0)]),c("div",II,[c("span",{class:"scope-pill",title:x(E)},w(M(E)),9,$I)])]),E.localIsCompleted?(m(),y("div",MI,[E.isModified&&!E.isCompleted?(m(),y("span",AI," Will be marked as completed (pending save) ")):(m(),y(Te,{key:1},[c("span",EI," Completed by "+w(E.completedByActorName||"Unknown"),1),c("span",PI,w(A(E.completedAt)),1)],64))])):F("",!0),E.isModified&&E.isCompleted&&!E.localIsCompleted?(m(),y("div",DI,[...$[2]||($[2]=[c("span",{class:"pending-text"},"Will be marked as incomplete (pending save)",-1)])])):F("",!0),!E.canBeCompletedByMe&&!E.localIsCompleted?(m(),y("div",OI," Already completed by someone else ")):F("",!0)])],2))),128))]))]))}},Pp=Xe(RI,[["__scopeId","data-v-9dc97489"]]),BI={class:"notes-view"},NI={key:0,class:"loading-state"},FI={key:1,class:"error-state"},zI={key:2,class:"empty-state"},UI={key:3,class:"notes-list"},HI={class:"note-header"},VI={class:"note-title-row"},ZI={key:0,class:"pin-icon",title:"Pinned"},jI={class:"note-title"},WI={class:"note-meta"},qI={key:0,class:"category-badge"},GI={key:0,class:"note-content"},KI={class:"note-footer"},YI={class:"created-info"},JI={key:0,class:"scope-info"},XI={__name:"NotesView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},marshalId:{type:String,default:null},allNotes:{type:Array,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},showScope:{type:Boolean,default:!0}},setup(e,{expose:t}){const o=e,i=O([]),s=O(!1),a=O(null),l=ae(()=>o.marshalId?"No notes for this marshal.":o.areaId?"No notes for this area.":o.locationId?"No notes for this checkpoint.":"No notes available."),u=ae(()=>o.areaId?o.locations.filter(M=>M.areaIds&&M.areaIds.includes(o.areaId)):[]),h=ae(()=>u.value.map(M=>M.id)),f=ae(()=>{if(!o.areaId)return[];const M=new Set;return o.assignments.filter(x=>h.value.includes(x.locationId)).forEach(x=>M.add(x.marshalId)),Array.from(M)}),p=M=>o.assignments.filter(x=>x.marshalId===M).map(x=>x.locationId),g=M=>{const x=p(M),C=new Set;for(const A of x){const I=o.locations.find($=>$.id===A);I?.areaIds&&I.areaIds.forEach($=>C.add($))}return Array.from(C)},b=(M,x)=>{if(!M.scopeConfigurations)return null;for(const C of M.scopeConfigurations){if(C.itemType==="Area"){if(x.type==="area"&&(C.ids.includes(x.areaId)||C.ids.includes("ALL_AREAS")))return{matched:!0,scope:C.scope==="EveryAreaLead"?"Area leads":"Area"};if(x.type==="checkpoint"){const I=o.locations.find($=>$.id===x.locationId)?.areaIds||[];if(C.ids.includes("ALL_AREAS")||I.some($=>C.ids.includes($)))return{matched:!0,scope:C.scope==="EveryAreaLead"?"Area leads":"Area"}}}if(C.itemType==="Checkpoint"){if(x.type==="checkpoint"&&(C.ids.includes(x.locationId)||C.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint"};if(x.type==="area"&&x.checkpointIds.some(I=>C.ids.includes(I)||C.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint in area"}}if(C.itemType==="Marshal"){if(x.type==="marshal"&&(C.ids.includes(x.marshalId)||C.ids.includes("ALL_MARSHALS")))return{matched:!0,scope:"Marshal"};if(x.type==="checkpoint"){const A=o.assignments.filter($=>$.locationId===x.locationId).map($=>$.marshalId);if(C.ids.includes("ALL_MARSHALS")||A.some($=>C.ids.includes($)))return{matched:!0,scope:"Marshal at checkpoint"}}if(x.type==="area"&&(C.ids.includes("ALL_MARSHALS")||x.marshalIds.some(I=>C.ids.includes(I))))return{matched:!0,scope:"Marshal in area"}}if(x.type==="marshal"&&x.checkpointIds&&x.areaIds){if(C.itemType==="Checkpoint"&&(C.ids.includes("ALL_CHECKPOINTS")||x.checkpointIds.some(I=>C.ids.includes(I))))return{matched:!0,scope:"Assigned checkpoint"};if(C.itemType==="Area"&&(C.ids.includes("ALL_AREAS")||x.areaIds.some(I=>C.ids.includes(I))))return{matched:!0,scope:C.scope==="EveryAreaLead"?"Area lead":"Area"}}}return null},S=ae(()=>{const M=o.allNotes||i.value;if(!M||M.length===0)return[];if(o.areaId&&o.allNotes){const x={type:"area",areaId:o.areaId,checkpointIds:h.value,marshalIds:f.value},C=[],A=new Set;for(const I of M){if(A.has(I.noteId))continue;const $=b(I,x);$&&(A.add(I.noteId),C.push({...I,matchedScope:$.scope}))}return C}if(o.locationId&&o.allNotes){const x={type:"checkpoint",locationId:o.locationId},C=[],A=new Set;for(const I of M){if(A.has(I.noteId))continue;const $=b(I,x);$&&(A.add(I.noteId),C.push({...I,matchedScope:$.scope}))}return C}if(o.marshalId&&o.allNotes){const x=p(o.marshalId),C=g(o.marshalId),A={type:"marshal",marshalId:o.marshalId,checkpointIds:x,areaIds:C},I=[],$=new Set;for(const E of M){if($.has(E.noteId))continue;const ie=b(E,A);ie&&($.add(E.noteId),I.push({...E,matchedScope:ie.scope}))}return I}return M}),T=ae(()=>{const M={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return[...S.value].sort((x,C)=>{if(x.isPinned!==C.isPinned)return x.isPinned?-1:1;const A=M[x.priority]??2,I=M[C.priority]??2;return A!==I?A-I:x.displayOrder!==C.displayOrder?x.displayOrder-C.displayOrder:new Date(C.createdAt)-new Date(x.createdAt)})}),_=async()=>{if(o.allNotes===null&&o.eventId){s.value=!0,a.value=null;try{let M;o.marshalId?M=await Eo.getMarshalNotes(o.eventId,o.marshalId):M=await Eo.getByEvent(o.eventId),i.value=M.data||[]}catch(M){console.error("Failed to load notes:",M),a.value=M.response?.data?.message||"Failed to load notes"}finally{s.value=!1}}};Ke(()=>[o.eventId,o.locationId,o.areaId,o.marshalId],()=>{o.allNotes===null&&_()},{immediate:!0});const D=M=>{if(!M)return"";const x=new Date(M),A=new Date-x,I=Math.floor(A/6e4),$=Math.floor(A/36e5),E=Math.floor(A/864e5);return I<1?"just now":I<60?`${I}m ago`:$<24?`${$}h ago`:E<7?`${E}d ago`:x.toLocaleDateString()};return t({loadNotes:_}),(M,x)=>(m(),y("div",BI,[s.value?(m(),y("div",NI," Loading notes... ")):a.value?(m(),y("div",FI,[c("p",null,w(a.value),1),c("button",{onClick:_,class:"btn btn-secondary btn-small"}," Retry ")])):S.value.length===0?(m(),y("div",zI,[c("p",null,w(l.value),1)])):(m(),y("div",UI,[(m(!0),y(Te,null,Ne(T.value,C=>(m(),y("div",{key:C.noteId,class:Ae(["note-item",{pinned:C.isPinned}])},[c("div",HI,[c("div",VI,[C.isPinned?(m(),y("span",ZI,"")):F("",!0),c("span",{class:Ae(["priority-indicator",(C.priority||"Normal").toLowerCase()])},null,2),c("strong",jI,w(C.title),1)]),c("div",WI,[C.category?(m(),y("span",qI,w(C.category),1)):F("",!0),c("span",{class:Ae(["priority-badge",(C.priority||"Normal").toLowerCase()])},w(C.priority||"Normal"),3)])]),C.content?(m(),y("div",GI,w(C.content),1)):F("",!0),c("div",KI,[c("span",YI," Created by "+w(C.createdByName||"Unknown")+"  "+w(D(C.createdAt)),1),C.matchedScope&&e.showScope?(m(),y("span",JI,w(C.matchedScope),1)):F("",!0)])],2))),128))]))]))}},bl=Xe(XI,[["__scopeId","data-v-6dd44fa8"]]),QI={class:"checklist-preview"},e$={class:"preview-actions"},t$={class:"preview-header"},n$={key:0,class:"add-item-form"},o$=["placeholder"],s$=["disabled"],i$={key:1,class:"pending-items"},a$={class:"item-content"},r$={class:"item-header"},l$={class:"item-text"},c$={class:"item-scope"},u$=["onClick"],d$={key:2,class:"empty-state"},h$={key:0,class:"help-text"},f$={key:3,class:"checklist-items"},p$={class:"item-content"},v$={class:"item-header"},m$={class:"item-text"},g$={class:"item-scope"},y$=["title"],_$={key:0,class:"item-context"},k$={__name:"ChecklistPreviewForLocation",props:{allChecklistItems:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{terms:o,termsLower:i}=yt(),s=e,a=ae(()=>s.checkpointTermSingular?s.checkpointTermSingular.toLowerCase():i.value.checkpoint),l=t,u=O(!1),h=O(""),f=O([...s.modelValue]);Ke(()=>s.modelValue,C=>{f.value=[...C]},{deep:!0});const p=()=>{h.value.trim()&&(f.value.push({text:h.value.trim(),isNew:!0}),h.value="",u.value=!1,b())},g=C=>{f.value.splice(C,1),b()},b=()=>{l("update:modelValue",[...f.value]),l("change")},S=C=>{const A=C.scope,I=C.itemType,$=C.ids||[];return(A==="EveryoneAtCheckpoints"||A==="OnePerCheckpoint")&&I==="Checkpoint"?$.includes("ALL_CHECKPOINTS"):A==="OnePerCheckpoint"&&I==="Area"?$.includes("ALL_AREAS")?!0:$.some(E=>s.pendingAreaIds.includes(E)):(A==="EveryoneInAreas"||A==="OnePerArea"||A==="EveryAreaLead"||A==="OneLeadPerArea")&&I==="Area"?$.includes("ALL_AREAS")?!0:$.some(E=>s.pendingAreaIds.includes(E)):!1},T=ae(()=>s.allChecklistItems.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(A=>S(A)):!1)),_=C=>({EveryoneAtCheckpoints:`All at ${i.value.checkpoints}`,OnePerCheckpoint:`One per ${i.value.checkpoint}`,EveryoneInAreas:`All in ${i.value.areas}`,OnePerArea:`One per ${i.value.area}`,EveryAreaLead:`${i.value.area} leads`,OneLeadPerArea:`One lead per ${i.value.area}`})[C]||C,D=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const A=C.scopeConfigurations.find($=>S($));if(!A)return _(C.scopeConfigurations[0].scope);const I=A.ids||[];return I.includes("ALL_CHECKPOINTS")?`All ${i.value.checkpoints}`:I.includes("ALL_AREAS")?`All ${i.value.areas}`:_(A.scope)},M=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const A=C.scopeConfigurations.find($=>S($));return A&&{EveryoneAtCheckpoints:`This item is for everyone at specified ${i.value.checkpoints}`,OnePerCheckpoint:`One person at each ${i.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${i.value.areas}`,OnePerArea:`One person in each ${i.value.area} needs to complete this`,EveryAreaLead:`This item is for ${i.value.area} leads only`,OneLeadPerArea:`One ${i.value.area} lead needs to complete this`}[A.scope]||""},x=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const A=C.scopeConfigurations.find(E=>S(E));if(!A)return null;const I=A.itemType,$=A.ids||[];if($.includes("ALL_CHECKPOINTS")||$.includes("ALL_AREAS"))return null;if(I==="Area"){const E=s.areas.filter(ie=>$.includes(ie.id)&&s.pendingAreaIds.includes(ie.id)).map(ie=>ie.name);if(E.length>0)return`In: ${E.join(", ")}`}return null};return(C,A)=>(m(),y("div",QI,[c("div",e$,[c("p",t$,w(e.isEditing?`Add new ${V(i).checklist} for this ${a.value}:`:`${V(o).checklists} that will apply at this ${a.value}:`),1),c("button",{type:"button",class:"add-item-btn",onClick:A[0]||(A[0]=I=>u.value=!u.value)},w(u.value?"Cancel":`+ Add ${V(i).checklist}`),1)]),u.value?(m(),y("div",n$,[Ze(c("input",{"onUpdate:modelValue":A[1]||(A[1]=I=>h.value=I),type:"text",placeholder:`Enter ${V(i).checklist} text...`,class:"add-item-input",onKeyup:Bf(p,["enter"])},null,40,o$),[[ut,h.value]]),c("button",{type:"button",class:"save-item-btn",disabled:!h.value.trim(),onClick:p}," Add ",8,s$)])):F("",!0),f.value.length>0?(m(),y("div",i$,[(m(!0),y(Te,null,Ne(f.value,(I,$)=>(m(),y("div",{key:`pending-${$}`,class:"checklist-item pending"},[A[3]||(A[3]=c("div",{class:"item-checkbox"},[c("input",{type:"checkbox",checked:!1,disabled:""})],-1)),c("div",a$,[c("div",r$,[c("div",l$,w(I.text),1),c("div",c$,[A[2]||(A[2]=c("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),c("button",{type:"button",class:"remove-item-btn",onClick:E=>g($),title:"Remove"},"  ",8,u$)])])])]))),128))])):F("",!0),!e.isEditing&&T.value.length===0&&f.value.length===0?(m(),y("div",d$,[c("p",null,"No "+w(V(i).checklists)+" will apply based on the current "+w(V(i).area)+" assignments.",1),e.pendingAreaIds.length===0?(m(),y("p",h$," Assign "+w(V(i).areas)+" to see relevant "+w(V(i).checklists)+". ",1)):F("",!0)])):F("",!0),!e.isEditing&&T.value.length>0?(m(),y("div",f$,[(m(!0),y(Te,null,Ne(T.value,I=>(m(),y("div",{key:I.id,class:"checklist-item"},[A[4]||(A[4]=c("div",{class:"item-checkbox"},[c("input",{type:"checkbox",checked:!1,disabled:""})],-1)),c("div",p$,[c("div",v$,[c("div",m$,w(I.text),1),c("div",g$,[c("span",{class:"scope-pill",title:M(I)},w(D(I)),9,y$)])]),x(I)?(m(),y("div",_$,w(x(I)),1)):F("",!0)])]))),128))])):F("",!0)]))}},b$=Xe(k$,[["__scopeId","data-v-c2119cba"]]),w$={class:"notes-preview"},C$={class:"preview-actions"},L$={class:"preview-header"},S$={key:0,class:"add-item-form"},x$={class:"add-form-fields"},T$=["disabled"],I$={key:1,class:"pending-items"},$$={class:"note-header"},M$={class:"note-title"},A$={class:"note-actions"},E$=["onClick"],P$={key:0,class:"note-content"},D$={key:2,class:"empty-state"},O$={key:0,class:"help-text"},R$={key:3,class:"notes-list"},B$={class:"note-header"},N$={class:"note-title"},F$=["title"],z$={key:0,class:"note-content"},U$={key:1,class:"note-context"},H$={__name:"NotesPreviewForLocation",props:{allNotes:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=yt(),i=e,s=t,a=ae(()=>i.checkpointTermSingular?i.checkpointTermSingular.toLowerCase():o.value.checkpoint),l=O(!1),u=O(""),h=O(""),f=O([...i.modelValue]);Ke(()=>i.modelValue,C=>{f.value=[...C]},{deep:!0});const p=()=>{!u.value.trim()&&!h.value.trim()||(f.value.push({title:u.value.trim(),content:h.value.trim(),isNew:!0}),u.value="",h.value="",l.value=!1,b())},g=C=>{f.value.splice(C,1),b()},b=()=>{s("update:modelValue",[...f.value]),s("change")},S=C=>{const A=C.scope,I=C.itemType,$=C.ids||[];return A==="EveryoneAtCheckpoints"&&I==="Checkpoint"?$.includes("ALL_CHECKPOINTS"):A==="EveryoneInAreas"&&I==="Area"?$.includes("ALL_AREAS")?!0:$.some(E=>i.pendingAreaIds.includes(E)):!1},T=ae(()=>i.allNotes.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(A=>S(A)):!1)),_=C=>({EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[C]||C,D=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const A=C.scopeConfigurations.find($=>S($));if(!A)return _(C.scopeConfigurations[0].scope);const I=A.ids||[];return I.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:I.includes("ALL_AREAS")?`All ${o.value.areas}`:_(A.scope)},M=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const A=C.scopeConfigurations.find($=>S($));return A&&{EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[A.scope]||""},x=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const A=C.scopeConfigurations.find(E=>S(E));if(!A)return null;const I=A.itemType,$=A.ids||[];if($.includes("ALL_CHECKPOINTS")||$.includes("ALL_AREAS"))return null;if(I==="Area"){const E=i.areas.filter(ie=>$.includes(ie.id)&&i.pendingAreaIds.includes(ie.id)).map(ie=>ie.name);if(E.length>0)return`In: ${E.join(", ")}`}return null};return(C,A)=>(m(),y("div",w$,[c("div",C$,[c("p",L$,w(e.isEditing?`Add new note for this ${a.value}:`:`Notes that will be visible at this ${a.value}:`),1),c("button",{type:"button",class:"add-item-btn",onClick:A[0]||(A[0]=I=>l.value=!l.value)},w(l.value?"Cancel":"+ Add note"),1)]),l.value?(m(),y("div",S$,[c("div",x$,[Ze(c("input",{"onUpdate:modelValue":A[1]||(A[1]=I=>u.value=I),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[ut,u.value]]),Ze(c("textarea",{"onUpdate:modelValue":A[2]||(A[2]=I=>h.value=I),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[ut,h.value]])]),c("button",{type:"button",class:"save-item-btn",disabled:!u.value.trim()&&!h.value.trim(),onClick:p}," Add ",8,T$)])):F("",!0),f.value.length>0?(m(),y("div",I$,[(m(!0),y(Te,null,Ne(f.value,(I,$)=>(m(),y("div",{key:`pending-${$}`,class:"note-item pending"},[c("div",$$,[c("span",M$,w(I.title||"Untitled"),1),c("div",A$,[A[3]||(A[3]=c("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),c("button",{type:"button",class:"remove-item-btn",onClick:E=>g($),title:"Remove"},"  ",8,E$)])]),I.content?(m(),y("div",P$,w(I.content),1)):F("",!0)]))),128))])):F("",!0),!e.isEditing&&T.value.length===0&&f.value.length===0?(m(),y("div",D$,[c("p",null,"No notes will apply based on the current "+w(V(o).area)+" assignments.",1),e.pendingAreaIds.length===0?(m(),y("p",O$," Assign "+w(V(o).areas)+" to see relevant notes. ",1)):F("",!0)])):F("",!0),!e.isEditing&&T.value.length>0?(m(),y("div",R$,[(m(!0),y(Te,null,Ne(T.value,I=>(m(),y("div",{key:I.id,class:"note-item"},[c("div",B$,[c("span",N$,w(I.title||"Untitled"),1),c("span",{class:"scope-pill",title:M(I)},w(D(I)),9,F$)]),I.content?(m(),y("div",z$,w(I.content),1)):F("",!0),x(I)?(m(),y("div",U$,w(x(I)),1)):F("",!0)]))),128))])):F("",!0)]))}},V$=Xe(H$,[["__scopeId","data-v-729a6eeb"]]),Z$={class:"base-modal-title modal-title-with-icon"},j$=["innerHTML"],W$={key:7,class:"tab-content appearance-tab"},q$={class:"accordion-item"},G$=["innerHTML"],K$={class:"accordion-title"},Y$={class:"accordion-arrow"},J$={key:0,class:"accordion-content"},X$={class:"section-description"},Q$={class:"accordion-item"},eM={class:"accordion-preview"},tM={class:"accordion-arrow"},nM={key:0,class:"accordion-content"},oM={class:"section-description"},sM={class:"terminology-row"},iM={class:"terminology-field"},aM=["value"],rM={value:""},lM=["value"],cM={class:"terminology-field"},uM=["value"],dM={value:""},hM=["value"],fM={class:"custom-footer"},pM={key:1},fh="edit_location_accordion",vM={__name:"EditLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:null},assignments:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventDate:{type:String,default:""},areas:{type:Array,default:()=>[]},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},availableMarshals:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},zIndex:{type:Number,default:1e3}},emits:["close","save","delete","move-location","toggle-check-in","remove-assignment","open-assign-modal","update:isDirty"],setup(e,{emit:t}){const{terms:o}=yt(),i=e,s=t,a=O("details"),l=O(!1),u=O(null),h=O(null),f=O([]),p=O([]),g=O([]),b=O({id:null,name:"",description:"",what3Words:"",latitude:0,longitude:0,requiredMarshals:1,useCustomTimes:!1,startTime:"",endTime:"",areaIds:[],styleType:"default",styleColor:"",styleBackgroundShape:"",styleBackgroundColor:"",styleBorderColor:"",styleIconColor:"",styleSize:"",styleMapRotation:"",peopleTerm:"",checkpointTerm:"",isDynamic:!1,locationUpdateScopeConfigurations:[]}),S=()=>i.eventId?`${fh}_${i.eventId}`:fh,T=O({iconStyle:!1,terminology:!1});rn(()=>{const Z=localStorage.getItem(S());if(Z)try{const N=JSON.parse(Z);T.value={...T.value,...N}}catch{}});const _=Z=>{T.value[Z]=!T.value[Z],localStorage.setItem(S(),JSON.stringify(T.value))},D=ae(()=>{const Z=b.value.areaIds||[];if(Z.length>0){const N=i.areas.filter(R=>Z.includes(R.id)&&R.peopleTerm).sort((R,J)=>(R.checkpointCount||0)-(J.checkpointCount||0));if(N.length>0)return N[0].peopleTerm}return i.eventPeopleTerm||"Marshals"}),M=ae(()=>b.value.peopleTerm?b.value.peopleTerm:D.value),x=ae(()=>{const Z=b.value.areaIds||[];if(Z.length>0){const N=i.areas.filter(R=>Z.includes(R.id)&&R.checkpointTerm).sort((R,J)=>(R.checkpointCount||0)-(J.checkpointCount||0));if(N.length>0)return N[0].checkpointTerm}return o.value.checkpoint});ae(()=>x.value.toLowerCase());const C=ae(()=>{const Z=b.value.checkpointTerm||i.location?.checkpointTerm||i.location?.CheckpointTerm;if(Z)return Bs("checkpoint",Z,M.value);const N=b.value.areaIds||[];let R=null;if(N.length>0){const J=i.areas.filter(ke=>N.includes(ke.id)&&ke.checkpointTerm).sort((ke,xe)=>(ke.checkpointCount||0)-(xe.checkpointCount||0));J.length>0&&(R=J[0].checkpointTerm)}return R?Bs("checkpoint",R,M.value):o.value.checkpoint}),A=ae(()=>C.value.toLowerCase()),I=ae(()=>{const Z=M.value;return Bs("people",Z)});ae(()=>I.value.toLowerCase());const $=ae(()=>o.value.area);ae(()=>$.value.toLowerCase());const E=ae(()=>o.value.area),ie=ae(()=>E.value.toLowerCase()),ce=ae(()=>o.value.areas),ge=ae(()=>!!(i.location&&i.location.id)),re=ae(()=>ge.value?`Edit ${A.value}: ${i.location?.name||""}`:`Add ${A.value}`),ve=ae(()=>[{value:"details",label:"Details",icon:"details"},{value:"location",label:"Location",icon:"location"},{value:"marshals",label:M.value,icon:"marshal"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}]),Be=ae(()=>ve.value.findIndex(Z=>Z.value===a.value)),He=ae(()=>Be.value===ve.value.length-1),Oe=ae(()=>{const Z=b.value.areaIds||[],N=i.areas.filter(H=>Z.includes(H.id)).sort((H,Fe)=>(H.checkpointCount||0)-(Fe.checkpointCount||0)),R=(H,Fe)=>{for(const Je of N){const Qe=H(Je);if(Qe&&Qe!=="default")return{value:Qe,source:"area"}}return Fe&&Fe!=="default"?{value:Fe,source:"event"}:{value:"",source:"none"}},J=R(H=>H.checkpointStyleType||H.CheckpointStyleType,i.eventDefaultStyleType),ke=R(H=>H.checkpointStyleColor||H.CheckpointStyleColor,i.eventDefaultStyleColor),xe=R(H=>H.checkpointStyleBackgroundShape||H.CheckpointStyleBackgroundShape,i.eventDefaultStyleBackgroundShape),Ce=R(H=>H.checkpointStyleBackgroundColor||H.CheckpointStyleBackgroundColor||H.checkpointStyleColor||H.CheckpointStyleColor,i.eventDefaultStyleBackgroundColor||i.eventDefaultStyleColor),ze=R(H=>H.checkpointStyleBorderColor||H.CheckpointStyleBorderColor,i.eventDefaultStyleBorderColor),Re=R(H=>H.checkpointStyleIconColor||H.CheckpointStyleIconColor,i.eventDefaultStyleIconColor),je=R(H=>H.checkpointStyleSize||H.CheckpointStyleSize,i.eventDefaultStyleSize),Ye=R(H=>H.checkpointStyleMapRotation??H.CheckpointStyleMapRotation,i.eventDefaultStyleMapRotation),Y=[J,xe,Ce,ze,Re,je,Ye].some(H=>H.source==="area");return{type:J.value||"default",color:ke.value,backgroundShape:xe.value,backgroundColor:Ce.value,borderColor:ze.value,iconColor:Re.value,size:je.value,mapRotation:Ye.value,source:Y?"area":J.value?"event":"none"}}),fe=ae(()=>Oe.value.source==="area"?`${E.value} default`:"Event default"),q=ae(()=>{const Z=b.value.styleType&&b.value.styleType!=="default"&&b.value.styleType!=="custom"?b.value.styleType:Oe.value.type,N=b.value.styleBackgroundShape||Oe.value.backgroundShape||"circle",R=b.value.styleBackgroundColor||Oe.value.backgroundColor||"#667eea",J=b.value.styleBorderColor||Oe.value.borderColor||"#ffffff",ke=b.value.styleIconColor||Oe.value.iconColor||"#ffffff";return qt({type:Z||"circle",backgroundShape:N,backgroundColor:R,borderColor:J,iconColor:ke,size:"100"})}),j=ae(()=>{let Z,N,R,J,ke;return ge.value&&i.location?(Z=i.location.resolvedStyleType||i.location.ResolvedStyleType,N=i.location.resolvedStyleBackgroundShape||i.location.ResolvedStyleBackgroundShape||"circle",R=i.location.resolvedStyleBackgroundColor||i.location.ResolvedStyleBackgroundColor||i.location.resolvedStyleColor||i.location.ResolvedStyleColor||"#667eea",J=i.location.resolvedStyleBorderColor||i.location.ResolvedStyleBorderColor||"#ffffff",ke=i.location.resolvedStyleIconColor||i.location.ResolvedStyleIconColor||"#ffffff"):(Z=b.value.styleType&&b.value.styleType!=="default"&&b.value.styleType!=="custom"?b.value.styleType:Oe.value.type,N=b.value.styleBackgroundShape||Oe.value.backgroundShape||"circle",R=b.value.styleBackgroundColor||Oe.value.backgroundColor||"#667eea",J=b.value.styleBorderColor||Oe.value.borderColor||"#ffffff",ke=b.value.styleIconColor||Oe.value.iconColor||"#ffffff"),qt({type:Z||"circle",backgroundShape:N,backgroundColor:R,borderColor:J,iconColor:ke,size:"100",outputSize:28})}),ue=ae(()=>{const Z=!!b.value.checkpointTerm,N=!!b.value.peopleTerm;return Z&&N?`${Bs("checkpoint",b.value.checkpointTerm,b.value.peopleTerm)}, ${b.value.peopleTerm}`:Z?Bs("checkpoint",b.value.checkpointTerm,M.value):N?b.value.peopleTerm:"Using defaults"}),K=ae(()=>He.value?null:ve.value[Be.value+1]),pe=ae(()=>He.value?`Create ${A.value}`:`Add ${K.value.label.toLowerCase()}...`),X=O(!1),we=O(null);Ke(()=>i.location,Z=>{if(Z){const N=Z.id||"new";if(we.value!==N){we.value=N,X.value=!0;let R="",J="";Z.startTime&&(R=Ra(Z.startTime)),Z.endTime&&(J=Ra(Z.endTime)),b.value={id:Z.id||null,name:Z.name||"",description:Z.description||"",what3Words:Z.what3Words||"",latitude:Z.latitude||0,longitude:Z.longitude||0,requiredMarshals:Z.requiredMarshals||1,useCustomTimes:!!(Z.startTime||Z.endTime),startTime:R,endTime:J,areaIds:Z.areaIds||Z.AreaIds||[],styleType:Z.styleType||Z.StyleType||"default",styleColor:Z.styleColor||Z.StyleColor||"",styleBackgroundShape:Z.styleBackgroundShape||Z.StyleBackgroundShape||"",styleBackgroundColor:Z.styleBackgroundColor||Z.StyleBackgroundColor||"",styleBorderColor:Z.styleBorderColor||Z.StyleBorderColor||"",styleIconColor:Z.styleIconColor||Z.StyleIconColor||"",styleSize:Z.styleSize||Z.StyleSize||"",styleMapRotation:Z.styleMapRotation??Z.StyleMapRotation??"",peopleTerm:Z.peopleTerm||"",checkpointTerm:Z.checkpointTerm||"",isDynamic:Z.isDynamic||!1,locationUpdateScopeConfigurations:Z.locationUpdateScopeConfigurations||[]}}}},{immediate:!0,deep:!0}),Ke(()=>i.show,Z=>{Z?(a.value="details",l.value=!1,f.value=[],p.value=[],g.value=[],u.value?.clearPendingChanges&&u.value.clearPendingChanges(),h.value?.resetLocalState&&h.value.resetLocalState()):(we.value=null,X.value=!1)});const De=Z=>{b.value=Z},Se=()=>{s("update:isDirty",!0)},Ee=()=>{l.value=!l.value,s("move-location",{isMoving:l.value,formData:{...b.value}})},se=Z=>{f.value=Z,Se()},me=()=>{ge.value||He.value?ne():a.value=K.value.value},ne=()=>{const Z={...b.value,startTime:b.value.useCustomTimes&&b.value.startTime?new Date(b.value.startTime).toISOString():null,endTime:b.value.useCustomTimes&&b.value.endTime?new Date(b.value.endTime).toISOString():null,checkInChanges:u.value?.getPendingChanges?.()||[],checklistChanges:f.value||[],pendingAssignments:i.assignments.filter(N=>N.isPending).map(N=>({marshalId:N.marshalId})),pendingNewChecklistItems:p.value,pendingNewNotes:g.value};s("save",Z)},de=()=>{i.location&&i.location.id&&s("delete",i.location.id)},Le=Z=>{s("remove-assignment",Z)},B=()=>{s("open-assign-modal")},U=()=>{s("close")},Q=(Z,N)=>{b.value[Z]=N,Se()};return(Z,N)=>(m(),at(zt,{show:e.show,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:U},{header:tt(()=>[c("h2",Z$,[j.value?(m(),y("span",{key:0,class:"modal-title-icon",innerHTML:j.value},null,8,j$)):F("",!0),We(" "+w(re.value),1)])]),"tab-header":tt(()=>[Ve(uu,{modelValue:a.value,"onUpdate:modelValue":N[0]||(N[0]=R=>a.value=R),tabs:ve.value},null,8,["modelValue","tabs"])]),footer:tt(()=>[c("div",fM,[ge.value?(m(),y("button",{key:0,type:"button",onClick:de,class:"btn btn-danger"}," Delete "+w(A.value),1)):(m(),y("div",pM)),c("button",{type:"button",onClick:me,class:"btn btn-primary"},w(ge.value?"Save changes":pe.value),1)])]),default:tt(()=>[a.value==="details"?(m(),at(Vx,{key:0,form:b.value,areas:e.areas,"event-date":e.eventDate,"area-term-singular":E.value,"area-term-plural":ce.value,"checkpoint-term-singular":C.value,"people-term-plural":M.value,"onUpdate:form":De,onInput:Se,onSave:ne},null,8,["form","areas","event-date","area-term-singular","area-term-plural","checkpoint-term-singular","people-term-plural"])):F("",!0),a.value==="location"?(m(),at(KT,{key:1,form:b.value,"is-moving":l.value,"checkpoint-term-singular":C.value,"people-term-plural":M.value,areas:e.areas,locations:e.allLocations,marshals:e.availableMarshals,"is-editing":ge.value,"onUpdate:form":De,onInput:Se,onSave:ne,onMoveLocation:Ee},null,8,["form","is-moving","checkpoint-term-singular","people-term-plural","areas","locations","marshals","is-editing"])):F("",!0),a.value==="marshals"?(m(),at(pI,{key:2,ref_key:"assignmentsTabRef",ref:u,form:b.value,assignments:e.assignments,"people-term":M.value,"person-term":I.value,"onUpdate:form":De,onInput:Se,onRemoveAssignment:Le,onOpenAssignModal:B},null,8,["form","assignments","people-term","person-term"])):F("",!0),a.value==="checklists"&&ge.value?(m(),at(Pp,{key:3,ref_key:"checklistTabRef",ref:h,modelValue:f.value,"onUpdate:modelValue":N[1]||(N[1]=R=>f.value=R),"event-id":e.eventId,"location-id":e.location.id,locations:e.allLocations,areas:e.areas,assignments:e.assignments,onChange:se},null,8,["modelValue","event-id","location-id","locations","areas","assignments"])):F("",!0),a.value==="checklists"?(m(),at(b$,{key:4,modelValue:p.value,"onUpdate:modelValue":N[2]||(N[2]=R=>p.value=R),"all-checklist-items":e.allChecklistItems,"pending-area-ids":b.value.areaIds,areas:e.areas,"is-editing":ge.value,"checkpoint-term-singular":C.value,onChange:Se},null,8,["modelValue","all-checklist-items","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):F("",!0),a.value==="notes"&&ge.value?(m(),at(bl,{key:5,"event-id":e.eventId,"location-id":e.location?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","location-id","all-notes","locations","areas","assignments"])):F("",!0),a.value==="notes"?(m(),at(V$,{key:6,modelValue:g.value,"onUpdate:modelValue":N[3]||(N[3]=R=>g.value=R),"all-notes":e.notes,"pending-area-ids":b.value.areaIds,areas:e.areas,"is-editing":ge.value,"checkpoint-term-singular":C.value,onChange:Se},null,8,["modelValue","all-notes","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):F("",!0),a.value==="appearance"?(m(),y("div",W$,[c("div",q$,[c("button",{type:"button",class:Ae(["accordion-header",{expanded:T.value.iconStyle}]),onClick:N[4]||(N[4]=R=>_("iconStyle"))},[c("div",{class:"accordion-icon",innerHTML:q.value},null,8,G$),c("span",K$,w(C.value)+" icon style",1),c("span",Y$,w(T.value.iconStyle?"":""),1)],2),T.value.iconStyle?(m(),y("div",J$,[c("p",X$," Choose a custom icon for this "+w(A.value)+", or leave as Default to inherit from "+w(ie.value)+" or event settings. ",1),Ve(cu,{"style-type":b.value.styleType||"default","style-color":b.value.styleColor||"","style-background-shape":b.value.styleBackgroundShape||"","style-background-color":b.value.styleBackgroundColor||"","style-border-color":b.value.styleBorderColor||"","style-icon-color":b.value.styleIconColor||"","style-size":b.value.styleSize||"","style-map-rotation":b.value.styleMapRotation??"","inherited-style-type":Oe.value.type,"inherited-style-color":Oe.value.color,"inherited-background-shape":Oe.value.backgroundShape||"","inherited-background-color":Oe.value.backgroundColor||Oe.value.color||"","inherited-border-color":Oe.value.borderColor||"","inherited-icon-color":Oe.value.iconColor||"","inherited-size":Oe.value.size||"","inherited-map-rotation":Oe.value.mapRotation??"","default-label":fe.value,"icon-label":"Icon style",level:"checkpoint","show-preview":!0,"onUpdate:styleType":N[5]||(N[5]=R=>Q("styleType",R)),"onUpdate:styleColor":N[6]||(N[6]=R=>Q("styleColor",R)),"onUpdate:styleBackgroundShape":N[7]||(N[7]=R=>Q("styleBackgroundShape",R)),"onUpdate:styleBackgroundColor":N[8]||(N[8]=R=>Q("styleBackgroundColor",R)),"onUpdate:styleBorderColor":N[9]||(N[9]=R=>Q("styleBorderColor",R)),"onUpdate:styleIconColor":N[10]||(N[10]=R=>Q("styleIconColor",R)),"onUpdate:styleSize":N[11]||(N[11]=R=>Q("styleSize",R)),"onUpdate:styleMapRotation":N[12]||(N[12]=R=>Q("styleMapRotation",R))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation","default-label"])])):F("",!0)]),c("div",Q$,[c("button",{type:"button",class:Ae(["accordion-header",{expanded:T.value.terminology}]),onClick:N[13]||(N[13]=R=>_("terminology"))},[N[16]||(N[16]=c("div",{class:"accordion-icon"},[c("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[c("circle",{cx:"9",cy:"8",r:"3",fill:"#6366F1"}),c("path",{d:"M3 18c0-3.3 2.7-6 6-6s6 2.7 6 6",fill:"#6366F1",opacity:"0.5"}),c("circle",{cx:"17",cy:"14",r:"5",fill:"#10B981",opacity:"0.3"}),c("circle",{cx:"17",cy:"14",r:"3",fill:"#10B981"}),c("circle",{cx:"17",cy:"14",r:"1",fill:"white"})])],-1)),N[17]||(N[17]=c("span",{class:"accordion-title"},"Terminology",-1)),c("span",eM,w(ue.value),1),c("span",tM,w(T.value.terminology?"":""),1)],2),T.value.terminology?(m(),y("div",nM,[c("p",oM," Customise what this "+w(A.value)+" and its "+w(M.value.toLowerCase())+" are called. ",1),c("div",sM,[c("div",iM,[c("label",null,"What is this "+w(A.value)+" called?",1),c("select",{value:b.value.checkpointTerm,class:"form-input",onChange:N[14]||(N[14]=R=>{De({...b.value,checkpointTerm:R.target.value}),Se()})},[c("option",rM,"Use "+w(ie.value)+" default ("+w(C.value)+")",1),N[18]||(N[18]=c("option",{value:"Vehicle"},"Vehicle",-1)),N[19]||(N[19]=c("option",{value:"Car"},"Car",-1)),N[20]||(N[20]=c("option",{value:"Bike"},"Bike",-1)),(m(!0),y(Te,null,Ne(V(Ro).checkpoint,R=>(m(),y("option",{key:R,value:R},w(R),9,lM))),128))],40,aM)]),c("div",cM,[c("label",null,"What are "+w(M.value.toLowerCase())+" called here?",1),c("select",{value:b.value.peopleTerm,class:"form-input",onChange:N[15]||(N[15]=R=>{De({...b.value,peopleTerm:R.target.value}),Se()})},[c("option",dM,"Use "+w(ie.value)+" default ("+w(D.value)+")",1),(m(!0),y(Te,null,Ne(V(Ro).people,R=>(m(),y("option",{key:R,value:R},w(R),9,hM))),128))],40,uM)])])])):F("",!0)])])):F("",!0)]),_:1},8,["show","is-dirty","z-index"]))}},mM=Xe(vM,[["__scopeId","data-v-2df4e7dd"]]),gM={class:"tab-content"},yM={class:"form-group"},_M=["value"],kM={class:"form-group"},bM=["value"],wM={class:"form-group"},CM=["value"],LM={class:"form-group"},SM=["value"],xM={key:0,class:"magic-link-section"},TM={key:0,class:"loading-text"},IM={key:1,class:"magic-link-container"},$M={class:"magic-link-row"},MM=["value"],AM={key:0,class:"magic-link-actions"},EM=["disabled"],PM={key:1,class:"success-text"},DM={key:2,class:"error-text"},OM={key:2,class:"error-text"},RM={__name:"MarshalDetailsTab",props:{form:{type:Object,required:!0},eventId:{type:String,default:null},marshalId:{type:String,default:null}},emits:["update:form","input"],setup(e,{emit:t}){const o=e,i=t,s=O(""),a=O(!1),l=O(!1),u=O(""),h=O(!1),f=O(!1),p=O(!1),g=O(""),b=(D,M)=>{i("update:form",{...o.form,[D]:M}),i("input")},S=async()=>{if(!(!o.eventId||!o.marshalId)){l.value=!0,u.value="";try{const D=await co.getMagicLink(o.eventId,o.marshalId);s.value=D.data.magicLink,a.value=D.data.hasEmail}catch(D){console.error("Failed to fetch magic link:",D),u.value="Failed to load login link"}finally{l.value=!1}}},T=async()=>{try{await navigator.clipboard.writeText(s.value),h.value=!0,setTimeout(()=>{h.value=!1},2e3)}catch(D){console.error("Failed to copy:",D)}},_=async()=>{if(!(!o.eventId||!o.marshalId)){f.value=!0,p.value=!1,g.value="";try{await co.sendMagicLink(o.eventId,o.marshalId),p.value=!0,setTimeout(()=>{p.value=!1},3e3)}catch(D){console.error("Failed to send email:",D),g.value=D.response?.data?.message||"Failed to send email"}finally{f.value=!1}}};return Ke(()=>o.marshalId,D=>{D?S():(s.value="",a.value=!1)},{immediate:!0}),(D,M)=>(m(),y("div",gM,[c("div",yM,[M[5]||(M[5]=c("label",null,"Name *",-1)),c("input",{value:e.form.name,onInput:M[0]||(M[0]=x=>b("name",x.target.value)),type:"text",required:"",class:"form-input"},null,40,_M)]),c("div",kM,[M[6]||(M[6]=c("label",null,"Email",-1)),c("input",{value:e.form.email,onInput:M[1]||(M[1]=x=>b("email",x.target.value)),type:"email",class:"form-input"},null,40,bM)]),c("div",wM,[M[7]||(M[7]=c("label",null,"Phone number",-1)),c("input",{value:e.form.phoneNumber,onInput:M[2]||(M[2]=x=>b("phoneNumber",x.target.value)),type:"tel",class:"form-input"},null,40,CM)]),c("div",LM,[M[8]||(M[8]=c("label",null,"Notes",-1)),c("textarea",{value:e.form.notes,onInput:M[3]||(M[3]=x=>b("notes",x.target.value)),class:"form-input",rows:"3",placeholder:"e.g., Needs to leave by 11am"},null,40,SM)]),e.marshalId?(m(),y("div",xM,[M[9]||(M[9]=c("label",null,"Login link",-1)),M[10]||(M[10]=c("p",{class:"help-text"},"Share this unique link with the marshal so they can access their dashboard.",-1)),l.value?(m(),y("div",TM,"Loading link...")):s.value?(m(),y("div",IM,[c("div",$M,[c("input",{type:"text",value:s.value,readonly:"",class:"form-input magic-link-input",onFocus:M[4]||(M[4]=x=>x.target.select())},null,40,MM),c("button",{type:"button",class:"btn btn-secondary",onClick:T},w(h.value?"Copied!":"Copy link"),1)]),a.value?(m(),y("div",AM,[c("button",{type:"button",class:"btn btn-primary",disabled:f.value,onClick:_},w(f.value?"Sending...":"Send via email"),9,EM)])):F("",!0),p.value?(m(),y("p",PM,"Email sent successfully!")):F("",!0),g.value?(m(),y("p",DM,w(g.value),1)):F("",!0)])):u.value?(m(),y("div",OM,w(u.value),1)):F("",!0)])):F("",!0)]))}},BM=Xe(RM,[["__scopeId","data-v-5fa4ceb3"]]),NM={class:"tab-content"},FM={class:"section-title"},zM={class:"assignments-list"},UM={class:"assignment-info"},HM={class:"assignment-header"},VM=["title"],ZM={key:1,class:"status-indicator pending-indicator",title:"Will be assigned on save"},jM={key:2,class:"pending-badge"},WM={key:3,class:"pending-badge"},qM={key:0,class:"check-in-info"},GM={class:"check-in-method"},KM={class:"assignment-actions"},YM=["onClick"],JM=["onClick"],XM={key:0,class:"form-group",style:{"margin-top":"1.5rem"}},QM={value:""},eA=["value"],tA={__name:"MarshalCheckpointsTab",props:{assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},isNewMarshal:{type:Boolean,default:!1}},emits:["input","remove-assignment","assign-to-location"],setup(e,{expose:t,emit:o}){const{termsLower:i}=yt(),s=e,a=o,{pendingCheckInChanges:l,getEffectiveCheckInStatus:u,handleToggleCheckIn:h,getStatusIcon:f,getStatusColor:p,getStatusText:g,formatTime:b}=Ep(()=>a("input")),S=O(""),T=ae(()=>s.assignments?.length||0),_=ae(()=>{const M=[...s.availableLocations];return M.sort((x,C)=>x.name.localeCompare(C.name,void 0,{numeric:!0,sensitivity:"base"})),M}),D=()=>{S.value&&(a("assign-to-location",S.value),S.value="")};return t({pendingCheckInChanges:l,clearPendingChanges:()=>{l.value.clear(),S.value=""},getPendingChanges:()=>Array.from(l.value.entries()).map(([M,x])=>({assignmentId:M,shouldBeCheckedIn:x}))}),(M,x)=>(m(),y("div",NM,[c("h3",FM,"Assigned "+w(V(i).checkpoints)+" ("+w(T.value)+")",1),c("div",zM,[(m(!0),y(Te,null,Ne(e.assignments,C=>(m(),y("div",{key:C.id,class:Ae(["assignment-item",{"checked-in":!C.isPending&&V(u)(C),"is-pending":C.isPending}])},[c("div",UM,[c("div",HM,[C.isPending?(m(),y("span",ZM,"  ")):(m(),y("span",{key:0,class:"status-indicator",style:Dt({color:V(p)(C)}),title:V(g)(C)},w(V(f)(C)),13,VM)),c("strong",null,w(C.locationName),1),C.isPending?(m(),y("span",jM," (will be assigned on save) ")):V(l).has(C.id)?(m(),y("span",WM," (unsaved) ")):F("",!0)]),!C.isPending&&V(u)(C)?(m(),y("span",qM,[C.isCheckedIn&&!V(l).has(C.id)?(m(),y(Te,{key:0},[We(w(V(b)(C.checkInTime))+" ",1),c("span",GM,"("+w(C.checkInMethod)+")",1)],64)):(m(),y(Te,{key:1},[We(" Will be checked in on save ")],64))])):F("",!0)]),c("div",KM,[C.isPending?F("",!0):(m(),y("button",{key:0,onClick:A=>V(h)(C),class:Ae(["btn btn-small",V(u)(C)?"btn-danger":"btn-secondary"])},w(V(u)(C)?"Undo":"Check in"),11,YM)),c("button",{onClick:A=>M.$emit("remove-assignment",C),class:"btn btn-small btn-danger"}," Remove ",8,JM)])],2))),128)),_.value.length>0?(m(),y("div",XM,[c("label",null,"Assign to "+w(V(i).checkpoint),1),Ze(c("select",{"onUpdate:modelValue":x[0]||(x[0]=C=>S.value=C),class:"form-input",onChange:D},[c("option",QM,"Select a "+w(V(i).checkpoint)+"...",1),(m(!0),y(Te,null,Ne(_.value,C=>(m(),y("option",{key:C.id,value:C.id},[We(w(C.name),1),C.description?(m(),y(Te,{key:0},[We(" - "+w(C.description),1)],64)):F("",!0)],8,eA))),128))],544),[[gn,S.value]])])):F("",!0)])]))}},nA=Xe(tA,[["__scopeId","data-v-cd855013"]]),oA={class:"marshal-checklist-view"},sA={key:0,class:"loading-state"},iA={key:1,class:"error-state"},aA={key:2,class:"empty-state"},rA={key:3,class:"checklist-items"},lA={class:"item-checkbox"},cA=["checked","disabled","onChange"],uA={class:"item-content"},dA={class:"item-header"},hA={class:"item-text-wrapper"},fA={class:"item-text"},pA={key:0,class:"item-context"},vA={class:"item-scope"},mA=["title"],gA={key:0,class:"completion-info"},yA={key:0,class:"pending-text"},_A={class:"completion-text"},kA={class:"completion-time"},bA={key:1,class:"uncomplete-info"},wA={key:2,class:"disabled-reason"},CA={__name:"MarshalChecklistView",props:{eventId:{type:String,required:!0},marshalId:{type:String,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=yt(),a=e,l=o,u=O([]),h=O(!1),f=O(null),p=O(new Map),g=ae(()=>u.value.map(I=>{const $=p.value.get(I.itemId),E=$!==void 0?$.complete:I.isCompleted,ie=$!==void 0&&$.complete!==I.isCompleted;return{...I,localIsCompleted:E,isModified:ie}})),b=async()=>{if(!(!a.eventId||!a.marshalId)){h.value=!0,f.value=null;try{const I=await It.getMarshalChecklist(a.eventId,a.marshalId);if(u.value=I.data||[],a.modelValue&&a.modelValue.length>0){const $=new Map;a.modelValue.forEach(E=>{$.set(E.itemId,{complete:E.complete,contextType:E.contextType,contextId:E.contextId})}),p.value=$}}catch(I){console.error("Failed to load checklist:",I),f.value=I.response?.data?.message||"Failed to load checklist"}finally{h.value=!1}}},S=I=>{const $=p.value.get(I.itemId),E=$!==void 0?$.complete:I.isCompleted;p.value.set(I.itemId,{complete:!E,contextType:I.completionContextType,contextId:I.completionContextId}),T()},T=()=>{const I=[];for(const[$,E]of p.value.entries()){const ie=u.value.find(ce=>ce.itemId===$);ie&&E.complete!==ie.isCompleted&&I.push({itemId:$,complete:E.complete,contextType:E.contextType,contextId:E.contextId})}l("update:modelValue",I),l("change",I)};t({resetLocalState:()=>{if(p.value=new Map,a.modelValue&&a.modelValue.length>0){const I=new Map;a.modelValue.forEach($=>{I.set($.itemId,{complete:$.complete,contextType:$.contextType,contextId:$.contextId})}),p.value=I}},loadChecklist:b});const D=I=>({Everyone:"Everyone",SpecificPeople:"Assigned to you",EveryoneInAreas:`Your ${s.value.areas}`,EveryoneAtCheckpoints:`Your ${s.value.checkpoints}`,OnePerCheckpoint:`One per ${s.value.checkpoint}`,OnePerArea:`One per ${s.value.area}`,EveryAreaLead:`${i.value.area} lead`,OneLeadPerArea:`One lead per ${s.value.area}`})[I.matchedScope]||I.matchedScope,M=I=>({Everyone:"This item is for everyone at the event",SpecificPeople:"This item is specifically assigned to this person",EveryoneInAreas:`This item is for everyone in certain ${s.value.areas}`,EveryoneAtCheckpoints:`This item is for everyone at certain ${s.value.checkpoints}`,OnePerCheckpoint:`One person at the ${s.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${s.value.area} needs to complete this`,EveryAreaLead:`This item is for ${s.value.area} leads only`,OneLeadPerArea:`One ${s.value.area} lead needs to complete this`})[I.matchedScope]||"",x=I=>I.completionContextType==="Checkpoint"||I.completionContextType==="Area"?"Already completed by someone else":"Cannot be completed",C=I=>{if(!I.completionContextType||!I.completionContextId)return null;if(I.completionContextType==="Checkpoint"){const $=a.locations.find(ie=>ie.id===I.completionContextId);if(!$)return null;const E=$.description?`${$.name} - ${$.description}`:$.name;return`at ${s.value.checkpoint} ${E}`}if(I.completionContextType==="Area"){const $=a.areas.find(E=>E.id===I.completionContextId);return $?`in ${s.value.area} ${$.name}`:null}return I.completionContextType==="Personal"?I.contextOwnerName?`for ${I.contextOwnerName}`:"assigned individually":null},A=I=>I?new Date(I).toLocaleString():"";return Ke(()=>[a.eventId,a.marshalId],()=>{b()},{immediate:!0}),(I,$)=>(m(),y("div",oA,[h.value?(m(),y("div",sA," Loading checklist... ")):f.value?(m(),y("div",iA,[c("p",null,w(f.value),1),c("button",{onClick:b,class:"btn btn-secondary btn-small"}," Retry ")])):u.value.length===0?(m(),y("div",aA,[...$[0]||($[0]=[c("p",null,"No checklist items for this person.",-1)])])):(m(),y("div",rA,[(m(!0),y(Te,null,Ne(g.value,E=>(m(),y("div",{key:E.itemId,class:Ae(["checklist-item",{"item-completed":E.localIsCompleted,"item-modified":E.isModified}])},[c("div",lA,[c("input",{type:"checkbox",checked:E.localIsCompleted,disabled:!E.canBeCompletedByMe,onChange:ie=>S(E)},null,40,cA)]),c("div",uA,[c("div",dA,[c("div",hA,[c("div",fA,w(E.text),1),C(E)?(m(),y("div",pA,w(C(E)),1)):F("",!0)]),c("div",vA,[c("span",{class:"scope-pill",title:M(E)},w(D(E)),9,mA)])]),E.localIsCompleted?(m(),y("div",gA,[E.isModified&&!E.isCompleted?(m(),y("span",yA," Will be marked as completed (pending save) ")):(m(),y(Te,{key:1},[c("span",_A," Completed by "+w(E.completedByActorName||"Unknown"),1),c("span",kA,w(A(E.completedAt)),1)],64))])):F("",!0),E.isModified&&E.isCompleted&&!E.localIsCompleted?(m(),y("div",bA,[...$[1]||($[1]=[c("span",{class:"pending-text"},"Will be marked as incomplete (pending save)",-1)])])):F("",!0),!E.canBeCompletedByMe&&!E.localIsCompleted?(m(),y("div",wA,w(x(E)),1)):F("",!0)])],2))),128))]))]))}},LA=Xe(CA,[["__scopeId","data-v-73be4aeb"]]),SA={class:"checklist-preview"},xA={class:"preview-actions"},TA={class:"preview-header"},IA={key:0,class:"add-item-form"},$A=["placeholder"],MA=["disabled"],AA={key:1,class:"pending-items"},EA={class:"item-content"},PA={class:"item-header"},DA={class:"item-text"},OA={class:"item-scope"},RA=["onClick"],BA={key:2,class:"empty-state"},NA={key:0,class:"help-text"},FA={key:3,class:"checklist-items"},zA={class:"item-content"},UA={class:"item-header"},HA={class:"item-text"},VA={class:"item-scope"},ZA=["title"],jA={key:0,class:"item-context"},WA={__name:"ChecklistPreview",props:{allChecklistItems:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=yt(),i=e,s=t,a=O(!1),l=O(""),u=O([...i.modelValue]);Ke(()=>i.modelValue,x=>{u.value=[...x]},{deep:!0});const h=()=>{l.value.trim()&&(u.value.push({text:l.value.trim(),isNew:!0}),l.value="",a.value=!1,p())},f=x=>{u.value.splice(x,1),p()},p=()=>{s("update:modelValue",[...u.value]),s("change")},g=ae(()=>{const x=new Set;for(const C of i.pendingLocationIds){const A=i.allLocations.find(I=>I.id===C);A&&(A.areaIds||A.AreaIds||[]).forEach($=>x.add($))}return[...x]}),b=x=>{const C=x.scope,A=x.itemType,I=x.ids||[];return C==="SpecificPeople"&&A==="Marshal"?I.includes("ALL_MARSHALS"):(C==="EveryoneAtCheckpoints"||C==="OnePerCheckpoint")&&A==="Checkpoint"?I.includes("ALL_CHECKPOINTS")?!0:I.some($=>i.pendingLocationIds.includes($)):C==="OnePerCheckpoint"&&A==="Area"?I.includes("ALL_AREAS")?!0:I.some($=>g.value.includes($)):(C==="EveryoneInAreas"||C==="OnePerArea"||C==="EveryAreaLead"||C==="OneLeadPerArea")&&A==="Area"?I.includes("ALL_AREAS")?!0:I.some($=>g.value.includes($)):!1},S=ae(()=>i.allChecklistItems.filter(x=>x.scopeConfigurations&&x.scopeConfigurations.length>0?x.scopeConfigurations.some(C=>b(C)):!1)),T=x=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,EveryoneInAreas:`All in ${o.value.areas}`,OnePerArea:`One per ${o.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${o.value.area}`})[x]||x,_=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"Unknown";const C=x.scopeConfigurations.find(I=>b(I));if(!C)return T(x.scopeConfigurations[0].scope);const A=C.ids||[];return A.includes("ALL_MARSHALS")?"Everyone":A.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:A.includes("ALL_AREAS")?`All ${o.value.areas}`:T(C.scope)},D=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return"";const C=x.scopeConfigurations.find(I=>b(I));return C&&{SpecificPeople:"This item is for everyone at the event",EveryoneAtCheckpoints:`This item is for everyone at specified ${o.value.checkpoints}`,OnePerCheckpoint:`One person at each ${o.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${o.value.areas}`,OnePerArea:`One person in each ${o.value.area} needs to complete this`,EveryAreaLead:`This item is for ${o.value.area} leads only`,OneLeadPerArea:`One ${o.value.area} lead needs to complete this`}[C.scope]||""},M=x=>{if(!x.scopeConfigurations||x.scopeConfigurations.length===0)return null;const C=x.scopeConfigurations.find($=>b($));if(!C)return null;const A=C.itemType,I=C.ids||[];if(I.includes("ALL_MARSHALS")||I.includes("ALL_CHECKPOINTS")||I.includes("ALL_AREAS"))return null;if(A==="Checkpoint"){const $=i.allLocations.filter(E=>I.includes(E.id)&&i.pendingLocationIds.includes(E.id)).map(E=>E.name);if($.length>0)return`At: ${$.join(", ")}`}if(A==="Area"){const $=i.areas.filter(E=>I.includes(E.id)&&g.value.includes(E.id)).map(E=>E.name);if($.length>0)return`In: ${$.join(", ")}`}return null};return(x,C)=>(m(),y("div",SA,[c("div",xA,[c("p",TA,w(e.isEditing?`Add new ${V(o).checklist} for this ${V(o).person}:`:`${V(o).checklists} that will apply to this ${V(o).person}:`),1),c("button",{type:"button",class:"add-item-btn",onClick:C[0]||(C[0]=A=>a.value=!a.value)},w(a.value?"Cancel":`+ Add ${V(o).checklist}`),1)]),a.value?(m(),y("div",IA,[Ze(c("input",{"onUpdate:modelValue":C[1]||(C[1]=A=>l.value=A),type:"text",placeholder:`Enter ${V(o).checklist} text...`,class:"add-item-input",onKeyup:Bf(h,["enter"])},null,40,$A),[[ut,l.value]]),c("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim(),onClick:h}," Add ",8,MA)])):F("",!0),u.value.length>0?(m(),y("div",AA,[(m(!0),y(Te,null,Ne(u.value,(A,I)=>(m(),y("div",{key:`pending-${I}`,class:"checklist-item pending"},[C[3]||(C[3]=c("div",{class:"item-checkbox"},[c("input",{type:"checkbox",checked:!1,disabled:""})],-1)),c("div",EA,[c("div",PA,[c("div",DA,w(A.text),1),c("div",OA,[C[2]||(C[2]=c("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),c("button",{type:"button",class:"remove-item-btn",onClick:$=>f(I),title:"Remove"},"  ",8,RA)])])])]))),128))])):F("",!0),!e.isEditing&&S.value.length===0&&u.value.length===0?(m(),y("div",BA,[c("p",null,"No "+w(V(o).checklists)+" will apply based on the current "+w(V(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(m(),y("p",NA," Assign "+w(V(o).checkpoints)+" to see relevant "+w(V(o).checklists)+". ",1)):F("",!0)])):F("",!0),!e.isEditing&&S.value.length>0?(m(),y("div",FA,[(m(!0),y(Te,null,Ne(S.value,A=>(m(),y("div",{key:A.id,class:"checklist-item"},[C[4]||(C[4]=c("div",{class:"item-checkbox"},[c("input",{type:"checkbox",checked:!1,disabled:""})],-1)),c("div",zA,[c("div",UA,[c("div",HA,w(A.text),1),c("div",VA,[c("span",{class:"scope-pill",title:D(A)},w(_(A)),9,ZA)])]),M(A)?(m(),y("div",jA,w(M(A)),1)):F("",!0)])]))),128))])):F("",!0)]))}},qA=Xe(WA,[["__scopeId","data-v-1c92d629"]]),GA={class:"notes-preview"},KA={class:"preview-actions"},YA={class:"preview-header"},JA={key:0,class:"add-item-form"},XA={class:"add-form-fields"},QA=["disabled"],eE={key:1,class:"pending-items"},tE={class:"note-header"},nE={class:"note-title"},oE={class:"note-actions"},sE=["onClick"],iE={key:0,class:"note-content"},aE={key:2,class:"empty-state"},rE={key:0,class:"help-text"},lE={key:3,class:"notes-list"},cE={class:"note-header"},uE={class:"note-title"},dE=["title"],hE={key:0,class:"note-content"},fE={key:1,class:"note-context"},pE={__name:"NotesPreview",props:{allNotes:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=yt(),i=e,s=t,a=O(!1),l=O(""),u=O(""),h=O([...i.modelValue]);Ke(()=>i.modelValue,C=>{h.value=[...C]},{deep:!0});const f=()=>{!l.value.trim()&&!u.value.trim()||(h.value.push({title:l.value.trim(),content:u.value.trim(),isNew:!0}),l.value="",u.value="",a.value=!1,g())},p=C=>{h.value.splice(C,1),g()},g=()=>{s("update:modelValue",[...h.value]),s("change")},b=ae(()=>{const C=new Set;for(const A of i.pendingLocationIds){const I=i.allLocations.find($=>$.id===A);I&&(I.areaIds||I.AreaIds||[]).forEach(E=>C.add(E))}return[...C]}),S=C=>{const A=C.scope,I=C.itemType,$=C.ids||[];return A==="SpecificPeople"&&I==="Marshal"?$.includes("ALL_MARSHALS"):A==="EveryoneAtCheckpoints"&&I==="Checkpoint"?$.includes("ALL_CHECKPOINTS")?!0:$.some(E=>i.pendingLocationIds.includes(E)):A==="EveryoneInAreas"&&I==="Area"?$.includes("ALL_AREAS")?!0:$.some(E=>b.value.includes(E)):!1},T=ae(()=>i.allNotes.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(A=>S(A)):!1)),_=C=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[C]||C,D=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const A=C.scopeConfigurations.find($=>S($));if(!A)return _(C.scopeConfigurations[0].scope);const I=A.ids||[];return I.includes("ALL_MARSHALS")?"Everyone":I.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:I.includes("ALL_AREAS")?`All ${o.value.areas}`:_(A.scope)},M=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const A=C.scopeConfigurations.find($=>S($));return A&&{SpecificPeople:"This note is for everyone at the event",EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[A.scope]||""},x=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const A=C.scopeConfigurations.find(E=>S(E));if(!A)return null;const I=A.itemType,$=A.ids||[];if($.includes("ALL_MARSHALS")||$.includes("ALL_CHECKPOINTS")||$.includes("ALL_AREAS"))return null;if(I==="Checkpoint"){const E=i.allLocations.filter(ie=>$.includes(ie.id)&&i.pendingLocationIds.includes(ie.id)).map(ie=>ie.name);if(E.length>0)return`At: ${E.join(", ")}`}if(I==="Area"){const E=i.areas.filter(ie=>$.includes(ie.id)&&b.value.includes(ie.id)).map(ie=>ie.name);if(E.length>0)return`In: ${E.join(", ")}`}return null};return(C,A)=>(m(),y("div",GA,[c("div",KA,[c("p",YA,w(e.isEditing?`Add new note for this ${V(o).person}:`:`Notes that will be visible to this ${V(o).person}:`),1),c("button",{type:"button",class:"add-item-btn",onClick:A[0]||(A[0]=I=>a.value=!a.value)},w(a.value?"Cancel":"+ Add note"),1)]),a.value?(m(),y("div",JA,[c("div",XA,[Ze(c("input",{"onUpdate:modelValue":A[1]||(A[1]=I=>l.value=I),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[ut,l.value]]),Ze(c("textarea",{"onUpdate:modelValue":A[2]||(A[2]=I=>u.value=I),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[ut,u.value]])]),c("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim()&&!u.value.trim(),onClick:f}," Add ",8,QA)])):F("",!0),h.value.length>0?(m(),y("div",eE,[(m(!0),y(Te,null,Ne(h.value,(I,$)=>(m(),y("div",{key:`pending-${$}`,class:"note-item pending"},[c("div",tE,[c("span",nE,w(I.title||"Untitled"),1),c("div",oE,[A[3]||(A[3]=c("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),c("button",{type:"button",class:"remove-item-btn",onClick:E=>p($),title:"Remove"},"  ",8,sE)])]),I.content?(m(),y("div",iE,w(I.content),1)):F("",!0)]))),128))])):F("",!0),!e.isEditing&&T.value.length===0&&h.value.length===0?(m(),y("div",aE,[c("p",null,"No notes will be visible based on the current "+w(V(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(m(),y("p",rE," Assign "+w(V(o).checkpoints)+" to see relevant notes. ",1)):F("",!0)])):F("",!0),!e.isEditing&&T.value.length>0?(m(),y("div",lE,[(m(!0),y(Te,null,Ne(T.value,I=>(m(),y("div",{key:I.id,class:"note-item"},[c("div",cE,[c("span",uE,w(I.title||"Untitled"),1),c("span",{class:"scope-pill",title:M(I)},w(D(I)),9,dE)]),I.content?(m(),y("div",hE,w(I.content),1)):F("",!0),x(I)?(m(),y("div",fE,w(x(I)),1)):F("",!0)]))),128))])):F("",!0)]))}},vE=Xe(pE,[["__scopeId","data-v-dc8ac5e7"]]),mE={class:"custom-footer"},gE={key:1},yE={__name:"EditMarshalModal",props:{show:{type:Boolean,default:!1},marshal:{type:Object,default:null},eventId:{type:String,required:!0},assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1},eventNotes:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]}},emits:["close","save","delete","toggle-check-in","remove-assignment","assign-to-location","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=yt(),s=e,a=t,l=O("details"),u=O(null),h=O(null),f=O([]),p=O([]),g=O([]),b=O([]),S=O({name:"",email:"",phoneNumber:"",notes:""}),T=ae(()=>{const fe=s.isEditing?`Edit ${i.value.person}`:`Create ${i.value.person}`,q=S.value.name?.trim();return q?`${fe} - ${q}`:fe}),_=ae(()=>[{value:"details",label:"Details",icon:"details"},{value:"checkpoints",label:o.value.checkpoints,icon:"checkpoint"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}]),D=ae(()=>_.value.findIndex(fe=>fe.value===l.value)),M=ae(()=>D.value===_.value.length-1),x=ae(()=>M.value?null:_.value[D.value+1]),C=ae(()=>M.value?`Create ${i.value.person}`:`Add ${x.value.label.toLowerCase()}...`),A=ae(()=>p.value.map(fe=>fe.locationId)),I=ae(()=>s.isEditing?s.assignments:p.value.map(fe=>({id:`pending-${fe.locationId}`,locationId:fe.locationId,locationName:s.allLocations.find(q=>q.id===fe.locationId)?.name||"Unknown",isPending:!0}))),$=ae(()=>{if(s.isEditing)return s.availableLocations;const fe=p.value.map(q=>q.locationId);return s.allLocations.filter(q=>!fe.includes(q.id))});Ke(()=>s.marshal,fe=>{fe?S.value={name:fe.name||"",email:fe.email||"",phoneNumber:fe.phoneNumber||"",notes:fe.notes||""}:S.value={name:"",email:"",phoneNumber:"",notes:""}},{immediate:!0,deep:!0}),Ke(()=>s.show,fe=>{fe&&(l.value="details",f.value=[],p.value=[],g.value=[],b.value=[],s.isEditing||(S.value={name:"",email:"",phoneNumber:"",notes:""}),u.value?.clearPendingChanges&&u.value.clearPendingChanges(),h.value?.resetLocalState&&h.value.resetLocalState())});const E=fe=>{S.value=fe},ie=()=>{a("update:isDirty",!0)},ce=()=>{a("update:isDirty",!0)},ge=()=>{s.isEditing||M.value?re():l.value=x.value.value},re=()=>{const fe={...S.value,checkInChanges:u.value?.getPendingChanges?.()||[],checklistChanges:f.value||[],pendingAssignments:s.isEditing?[]:p.value,pendingNewChecklistItems:g.value,pendingNewNotes:b.value};a("save",fe)},ve=()=>{a("delete")},Be=fe=>{!s.isEditing&&fe.isPending?p.value=p.value.filter(q=>q.locationId!==fe.locationId):a("remove-assignment",fe)},He=fe=>{s.isEditing?a("assign-to-location",fe):(p.value.push({locationId:fe}),a("update:isDirty",!0))},Oe=()=>{a("close")};return(fe,q)=>(m(),at(zt,{show:e.show,title:T.value,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:Oe},{"tab-header":tt(()=>[Ve(uu,{modelValue:l.value,"onUpdate:modelValue":q[0]||(q[0]=j=>l.value=j),tabs:_.value},null,8,["modelValue","tabs"])]),footer:tt(()=>[c("div",mE,[e.isEditing?(m(),y("button",{key:0,type:"button",onClick:ve,class:"btn btn-danger"}," Delete "+w(V(i).person),1)):(m(),y("div",gE)),c("button",{type:"button",onClick:ge,class:"btn btn-primary"},w(e.isEditing?"Save changes":C.value),1)])]),default:tt(()=>[l.value==="details"?(m(),at(BM,{key:0,form:S.value,"event-id":e.eventId,"marshal-id":e.isEditing?e.marshal?.id:null,"onUpdate:form":E,onInput:ie},null,8,["form","event-id","marshal-id"])):F("",!0),l.value==="checkpoints"?(m(),at(nA,{key:1,ref_key:"checkpointsTabRef",ref:u,assignments:I.value,"available-locations":$.value,"is-new-marshal":!e.isEditing,onInput:ie,onRemoveAssignment:Be,onAssignToLocation:He},null,8,["assignments","available-locations","is-new-marshal"])):F("",!0),l.value==="checklists"&&e.isEditing?(m(),at(LA,{key:2,ref_key:"checklistTabRef",ref:h,modelValue:f.value,"onUpdate:modelValue":q[1]||(q[1]=j=>f.value=j),"event-id":e.eventId,"marshal-id":e.marshal.id,locations:e.allLocations,areas:e.areas,onChange:ce},null,8,["modelValue","event-id","marshal-id","locations","areas"])):F("",!0),l.value==="checklists"?(m(),at(qA,{key:3,modelValue:g.value,"onUpdate:modelValue":q[2]||(q[2]=j=>g.value=j),"all-checklist-items":e.allChecklistItems,"pending-location-ids":A.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:ie},null,8,["modelValue","all-checklist-items","pending-location-ids","all-locations","areas","is-editing"])):F("",!0),l.value==="notes"&&e.isEditing?(m(),at(bl,{key:4,"event-id":e.eventId,"marshal-id":e.marshal?.id,"all-notes":e.eventNotes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","marshal-id","all-notes","locations","areas","assignments"])):F("",!0),l.value==="notes"?(m(),at(vE,{key:5,modelValue:b.value,"onUpdate:modelValue":q[3]||(q[3]=j=>b.value=j),"all-notes":e.eventNotes,"pending-location-ids":A.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:ie},null,8,["modelValue","all-notes","pending-location-ids","all-locations","areas","is-editing"])):F("",!0)]),_:1},8,["show","title","is-dirty"]))}},_E=Xe(yE,[["__scopeId","data-v-84f3c0d3"]]),kE={class:"locations-list"},bE={class:"conflict-actions"},wE={__name:"AssignmentConflictModal",props:{show:{type:Boolean,default:!1},conflictData:{type:Object,default:()=>({marshalName:"",locations:[]})}},emits:["close","choice"],setup(e,{emit:t}){const{terms:o,termsLower:i}=yt(),s=t,a=u=>{s("choice",u)},l=()=>{s("close")};return(u,h)=>(m(),at(zt,{show:e.show,title:`${V(o).person} already assigned`,size:"medium","z-index":1100,onClose:l},{actions:tt(()=>[c("div",bE,[c("button",{onClick:h[0]||(h[0]=f=>a("move")),class:"btn btn-primary btn-full"}," Move to this "+w(V(i).checkpoint)+" (remove from others) ",1),c("button",{onClick:h[1]||(h[1]=f=>a("both")),class:"btn btn-secondary btn-full"}," Assign to both (keep existing assignments) "),c("button",{onClick:h[2]||(h[2]=f=>a("choose-other")),class:"btn btn-secondary btn-full"}," Choose someone else "),c("button",{onClick:h[3]||(h[3]=f=>a("cancel")),class:"btn btn-secondary btn-full"}," Cancel ")])]),default:tt(()=>[c("p",null,[c("strong",null,w(e.conflictData.marshalName),1),h[4]||(h[4]=We(" is currently assigned to: ",-1))]),c("ul",kE,[(m(!0),y(Te,null,Ne(e.conflictData.locations,f=>(m(),y("li",{key:f},w(f),1))),128))]),h[5]||(h[5]=c("p",null,"What would you like to do?",-1))]),_:1},8,["show","title"]))}},CE=Xe(wE,[["__scopeId","data-v-b64e5b37"]]),LE={key:0,class:"assign-marshal-section"},SE={value:""},xE=["value"],TE=["disabled"],IE={key:1,class:"assign-marshal-section create-mode"},$E={class:"form-group"},ME={class:"form-group"},AE={class:"form-group"},EE={__name:"AssignMarshalModal",props:{show:{type:Boolean,default:!1},locationName:{type:String,default:""},marshals:{type:Array,default:()=>[]}},emits:["close","assign-existing","create-and-assign"],setup(e,{emit:t}){const{termsLower:o}=yt(),i=e,s=t,a=O(!1),l=O(""),u=O({name:"",email:"",phoneNumber:""});Ke(()=>i.show,S=>{S||(a.value=!1,l.value="",u.value={name:"",email:"",phoneNumber:""})});const h=()=>{a.value=!0},f=()=>{l.value&&s("assign-existing",l.value)},p=()=>{u.value.name&&s("create-and-assign",{...u.value})},g=()=>{a.value=!1,u.value={name:"",email:"",phoneNumber:""}},b=()=>{s("close")};return(S,T)=>(m(),at(zt,{show:e.show,title:a.value?`Create new ${V(o).person}`:`Assign ${V(o).person} to ${e.locationName}`,size:"medium",onClose:b},{actions:tt(()=>[a.value?(m(),y(Te,{key:0},[c("button",{onClick:g,class:"btn btn-secondary"}," Cancel "),c("button",{onClick:p,class:"btn btn-primary"}," Create & assign ")],64)):F("",!0)]),default:tt(()=>[a.value?(m(),y("div",IE,[c("h3",null,"Create new "+w(V(o).person),1),c("div",$E,[T[5]||(T[5]=c("label",null,"Name *",-1)),Ze(c("input",{"onUpdate:modelValue":T[1]||(T[1]=_=>u.value.name=_),type:"text",required:"",class:"form-input"},null,512),[[ut,u.value.name]])]),c("div",ME,[T[6]||(T[6]=c("label",null,"Email",-1)),Ze(c("input",{"onUpdate:modelValue":T[2]||(T[2]=_=>u.value.email=_),type:"email",class:"form-input"},null,512),[[ut,u.value.email]])]),c("div",AE,[T[7]||(T[7]=c("label",null,"Phone",-1)),Ze(c("input",{"onUpdate:modelValue":T[3]||(T[3]=_=>u.value.phoneNumber=_),type:"tel",class:"form-input"},null,512),[[ut,u.value.phoneNumber]])])])):(m(),y("div",LE,[c("h3",null,"Select existing "+w(V(o).person),1),Ze(c("select",{"onUpdate:modelValue":T[0]||(T[0]=_=>l.value=_),class:"form-input"},[c("option",SE,"Choose a "+w(V(o).person)+"...",1),(m(!0),y(Te,null,Ne(e.marshals,_=>(m(),y("option",{key:_.id,value:_.id},[We(w(_.name)+" ",1),_.assignedLocationIds&&_.assignedLocationIds.length>0?(m(),y(Te,{key:0},[We(" (assigned to "+w(_.assignedLocationIds.length)+" "+w(_.assignedLocationIds.length>1?V(o).checkpoints:V(o).checkpoint)+") ",1)],64)):F("",!0)],8,xE))),128))],512),[[gn,l.value]]),c("button",{onClick:f,class:"btn btn-primary btn-full",style:{"margin-top":"1rem"},disabled:!l.value}," Assign selected "+w(V(o).person),9,TE),T[4]||(T[4]=c("div",{class:"divider"},"OR",-1)),c("button",{onClick:h,class:"btn btn-secondary btn-full"}," Create new "+w(V(o).person),1)]))]),_:1},8,["show","title"]))}},PE=Xe(EE,[["__scopeId","data-v-f95e76a2"]]),DE={class:"shift-times-content"},OE={class:"info-text"},RE={class:"time-delta-info"},BE={class:"delta-detail"},NE={class:"delta-detail"},FE={class:"delta-summary"},zE={class:"affected-checkpoints"},UE={class:"option-selection"},HE={class:"radio-option"},VE={class:"radio-option"},ZE={__name:"ShiftCheckpointTimesModal",props:{show:{type:Boolean,default:!1},oldEventDate:{type:String,required:!0},newEventDate:{type:String,required:!0},affectedCheckpointsCount:{type:Number,default:0}},emits:["confirm","cancel"],setup(e,{emit:t}){const{terms:o,termsLower:i}=yt(),s=e,a=t,l=O("shift"),u=ae(()=>{const b=new Date(s.oldEventDate);return new Date(s.newEventDate)-b}),h=b=>new Date(b).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),f=b=>{const S=Math.abs(b),T=b>=0?"+":"-",_=Math.floor(S/(1e3*60*60*24)),D=Math.floor(S%(1e3*60*60*24)/(1e3*60*60)),M=Math.floor(S%(1e3*60*60)/(1e3*60)),x=[];return _>0&&x.push(`${_}d`),D>0&&x.push(`${D}h`),M>0&&x.push(`${M}m`),`${T}${x.join(" ")}`},p=()=>{a("confirm",{shouldShift:l.value==="shift",timeDelta:u.value})},g=()=>{a("cancel")};return(b,S)=>(m(),at(zt,{show:e.show,title:`Shift ${V(o).checkpoint} Times?`,size:"medium",onClose:g},{actions:tt(()=>[c("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:p,class:"btn btn-primary"},w(l.value==="shift"?"Shift Times":"Keep Times"),1)]),default:tt(()=>[c("div",DE,[c("p",OE," You've changed the event date/time. Some "+w(V(i).checkpoints)+" have custom times set. ",1),c("div",RE,[S[2]||(S[2]=c("strong",null,"Event time change:",-1)),c("div",BE," Old: "+w(h(e.oldEventDate)),1),c("div",NE," New: "+w(h(e.newEventDate)),1),c("div",FE," Delta: "+w(f(u.value)),1)]),c("p",zE,[c("strong",null,w(e.affectedCheckpointsCount)+" "+w(e.affectedCheckpointsCount===1?V(i).checkpoint:V(i).checkpoints),1),S[3]||(S[3]=We(" with custom times will be shifted by the same amount. ",-1))]),c("div",UE,[c("label",HE,[Ze(c("input",{"onUpdate:modelValue":S[0]||(S[0]=T=>l.value=T),type:"radio",value:"shift",name:"shift-option"},null,512),[[bd,l.value]]),c("div",null,[c("strong",null,"Shift all "+w(V(i).checkpoint)+" times",1),S[4]||(S[4]=c("small",null,"Recommended: Maintains relative timing",-1))])]),c("label",VE,[Ze(c("input",{"onUpdate:modelValue":S[1]||(S[1]=T=>l.value=T),type:"radio",value:"keep",name:"shift-option"},null,512),[[bd,l.value]]),c("div",null,[c("strong",null,"Keep "+w(V(i).checkpoint)+" times unchanged",1),c("small",null,w(V(o).checkpoint)+" times will stay at their current values",1)])])])])]),_:1},8,["show","title"]))}},jE=Xe(ZE,[["__scopeId","data-v-0e706cff"]]),WE={key:0,class:"tab-content"},qE={class:"form-group"},GE=["disabled"],KE={class:"form-group"},YE={key:1,class:"tab-content"},JE={class:"boundary-section"},XE={class:"boundary-actions"},QE={key:2,class:"tab-content"},eP={class:"section-title"},tP={class:"contacts-actions"},nP={key:0,class:"area-contacts-list"},oP=["onClick"],sP={class:"contact-info"},iP={key:0,class:"contact-role-badge"},aP={key:1,class:"contact-details"},rP={key:0},lP={key:1},cP={key:3,class:"tab-content"},uP={class:"section-title"},dP={key:0,class:"empty-state"},hP={key:1,class:"checkpoints-list"},fP=["onClick"],pP={class:"checkpoint-header"},vP=["innerHTML"],mP={class:"checkpoint-name-section"},gP={key:0,class:"checkpoint-description"},yP={class:"checkpoint-stats"},_P={class:"checkpoint-details"},kP={class:"detail-row with-pills"},bP={class:"detail-label"},wP={class:"detail-value"},CP={key:0,class:"warning-text"},LP={key:0,class:"marshal-pills"},SP={class:"detail-row"},xP={class:"detail-value"},TP={key:0,class:"detail-row"},IP={key:1,class:"detail-row"},$P={key:4,class:"placeholder-message"},MP={key:6,class:"placeholder-message"},AP={key:8,class:"placeholder-message"},EP={key:9,class:"tab-content appearance-tab"},PP={class:"accordion-item"},DP=["innerHTML"],OP={class:"accordion-title"},RP={class:"accordion-arrow"},BP={key:0,class:"accordion-content"},NP={class:"section-description"},FP={class:"color-picker"},zP=["title","onClick"],UP={class:"accordion-item"},HP=["innerHTML"],VP={class:"accordion-title"},ZP={class:"accordion-arrow"},jP={key:0,class:"accordion-content"},WP={class:"section-description"},qP={class:"accordion-item"},GP={class:"accordion-title"},KP={class:"accordion-preview"},YP={class:"accordion-arrow"},JP={key:0,class:"accordion-content"},XP={class:"section-description"},QP={class:"form-group"},e4={value:""},t4=["value"],n4={class:"accordion-item"},o4={class:"accordion-title"},s4={class:"accordion-preview"},i4={class:"accordion-arrow"},a4={key:0,class:"accordion-content"},r4={class:"section-description"},l4={class:"form-group"},c4={value:""},u4=["value"],d4={class:"custom-footer"},h4={key:1},ph="edit_area_accordion",f4={__name:"EditAreaModal",props:{show:{type:Boolean,default:!1},area:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["close","save","delete","draw-boundary","update:isDirty","select-checkpoint","add-area-contact","edit-contact"],setup(e,{emit:t}){const{terms:o,termsLower:i}=yt(),s=()=>_.value.peopleTerm?_.value.peopleTerm:h.eventPeopleTerm||"Marshals",a=(N=!0)=>{const R=_.value.checkpointTerm||h.eventCheckpointTerm||"Checkpoints",J=s();return N?Ip("checkpoint",R,J):Bs("checkpoint",R,J)},l=(N=!0)=>a(N).toLowerCase(),u=N=>N.resolvedPeopleTerm?N.resolvedPeopleTerm:N.peopleTerm?N.peopleTerm:_.value.peopleTerm?_.value.peopleTerm:h.eventPeopleTerm||"Marshals",h=e,f=t,p=O("details"),g=O(null),b=O([]),S=O({}),T=O({}),_=O({name:"",description:"",color:Dr,displayOrder:0,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),D=()=>h.eventId?`${ph}_${h.eventId}`:ph,M=O({polygonColor:!1,iconStyle:!1,peopleTerm:!1,checkpointTerm:!1});rn(()=>{const N=localStorage.getItem(D());if(N)try{const R=JSON.parse(N);M.value={...M.value,...R}}catch{}});const x=N=>{M.value[N]=!M.value[N],localStorage.setItem(D(),JSON.stringify(M.value))},C=ae(()=>`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <polygon points="4,8 7,3 14,2 20,5 22,12 19,18 12,21 5,19 2,14" fill="${_.value.color||Dr}" stroke="#fff" stroke-width="1.5" opacity="0.8"/>
  </svg>`),A=ae(()=>{const N=_.value.checkpointStyleType!=="default"||_.value.checkpointStyleBackgroundShape||_.value.checkpointStyleBackgroundColor||_.value.checkpointStyleBorderColor||_.value.checkpointStyleIconColor||_.value.checkpointStyleSize,R=h.eventDefaultStyleType!=="default"||h.eventDefaultStyleBackgroundShape||h.eventDefaultStyleBackgroundColor||h.eventDefaultStyleColor||h.eventDefaultStyleBorderColor||h.eventDefaultStyleIconColor||h.eventDefaultStyleSize;if(!N&&!R)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="areaDefaultGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981"/>
          <stop offset="50%" style="stop-color:#F59E0B"/>
          <stop offset="100%" style="stop-color:#EF4444"/>
        </linearGradient>
      </defs>
      <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#areaDefaultGrad)" stroke="#fff" stroke-width="1.5"/>
    </svg>`;const J=_.value.checkpointStyleType&&_.value.checkpointStyleType!=="default"?_.value.checkpointStyleType:h.eventDefaultStyleType&&h.eventDefaultStyleType!=="default"?h.eventDefaultStyleType:"default",ke=_.value.checkpointStyleBackgroundShape||h.eventDefaultStyleBackgroundShape||"circle",xe=_.value.checkpointStyleBackgroundColor||h.eventDefaultStyleBackgroundColor||h.eventDefaultStyleColor||"#667eea",Ce=_.value.checkpointStyleBorderColor||h.eventDefaultStyleBorderColor||"#ffffff",ze=_.value.checkpointStyleIconColor||h.eventDefaultStyleIconColor||"#ffffff",Re=_.value.checkpointStyleSize||h.eventDefaultStyleSize||"100";return qt({type:J!=="default"?J:ke,backgroundShape:ke,backgroundColor:xe,borderColor:Ce,iconColor:ze,size:Re,outputSize:24})}),I=ae(()=>h.area&&h.area.id),$=ae(()=>[{value:"details",label:"Details",icon:"details"},{value:"boundary",label:"Boundary",icon:"area"},{value:"contacts",label:"Contacts",icon:"marshal"},{value:"checkpoints",label:a(),icon:"checkpoint"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}]),E=ae(()=>$.value.findIndex(N=>N.value===p.value)),ie=ae(()=>E.value===$.value.length-1),ce=ae(()=>ie.value?null:$.value[E.value+1]),ge=ae(()=>ie.value?`Create ${i.value.area}`:`Add ${ce.value.label.toLowerCase()}...`),re=ae(()=>{if(!h.area||!h.area.id)return[];const N=h.checkpoints.filter(R=>R.areaIds&&R.areaIds.includes(h.area.id)).map(R=>R.id);return h.assignments.filter(R=>N.includes(R.locationId))}),ve=ae(()=>!h.area||!h.area.id?[]:h.checkpoints.filter(N=>N.areaIds&&N.areaIds.includes(h.area.id))),Be=ae(()=>{const N=[...ve.value];return N.sort((R,J)=>{const ke=R.name.match(/^(\d+)/),xe=J.name.match(/^(\d+)/);if(ke&&xe){const Ce=parseInt(ke[1]),ze=parseInt(xe[1]);if(Ce!==ze)return Ce-ze}return R.name.localeCompare(J.name,void 0,{numeric:!0,sensitivity:"base"})}),N}),He=ae(()=>!h.area||!h.area.id?[]:h.contacts.filter(N=>N.scopeConfigurations?N.scopeConfigurations.some(R=>R.scope==="EveryoneInAreas"&&R.itemType==="Area"?R.ids?.includes("ALL_AREAS")?!0:R.ids?.includes(h.area.id):!1):!1)),Oe=N=>h.assignments.filter(R=>R.locationId===N),fe=N=>[...Oe(N)].sort((J,ke)=>(J.marshalName||"").localeCompare(ke.marshalName||"",void 0,{sensitivity:"base"})),q=N=>Oe(N.id).filter(J=>J.isCheckedIn).length,j=N=>{const R=Oe(N.id);if(R.length===0)return"status-none";const J=R.filter(ke=>ke.isCheckedIn).length;return J===0?"status-none":J===R.length?"status-complete":"status-partial"},ue=N=>{const R=Oe(N.id),J=u(N).toLowerCase();if(R.length===0)return`No ${J}`;const ke=R.filter(xe=>xe.isCheckedIn).length;return ke===0?"Not checked in":ke===R.length?"Fully checked in":`Partially checked in (${ke}/${R.length})`},K=N=>{const R=S.value[N];return!R||R.total===0?"":R.completed===R.total?"status-complete":R.completed===0?"status-none":"status-partial"},pe=N=>{const R=S.value[N];return R?R.total===0?"No tasks":R.completed===R.total?"All tasks completed":`${R.completed}/${R.total} completed`:""},X=async N=>{if(!(S.value[N]||T.value[N])){T.value[N]=!0;try{const J=(await It.getCheckpointChecklist(h.eventId,N)).data||[];S.value[N]={total:J.length,completed:J.filter(ke=>ke.isCompleted).length}}catch(R){console.error("Failed to load checklist status for checkpoint:",N,R),S.value[N]={total:0,completed:0}}finally{T.value[N]=!1}}};Ke(()=>h.area,N=>{if(N){const R=N.polygon?typeof N.polygon=="string"?JSON.parse(N.polygon):N.polygon:[];_.value={name:N.name||"",description:N.description||"",color:N.color||Dr,displayOrder:N.displayOrder||0,isDefault:N.isDefault||!1,polygon:R,checkpointStyleType:N.checkpointStyleType||"default",checkpointStyleColor:N.checkpointStyleColor||"",checkpointStyleBackgroundShape:N.checkpointStyleBackgroundShape||"",checkpointStyleBackgroundColor:N.checkpointStyleBackgroundColor||"",checkpointStyleBorderColor:N.checkpointStyleBorderColor||"",checkpointStyleIconColor:N.checkpointStyleIconColor||"",checkpointStyleSize:N.checkpointStyleSize||"",checkpointStyleMapRotation:N.checkpointStyleMapRotation??"",peopleTerm:N.peopleTerm||"",checkpointTerm:N.checkpointTerm||""}}else _.value={name:"",description:"",color:dh(h.areas),displayOrder:h.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}},{immediate:!0,deep:!0}),Ke(()=>h.show,N=>{N&&(p.value="details",b.value=[],S.value={},T.value={},I.value||(_.value={name:"",description:"",color:dh(h.areas),displayOrder:h.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),g.value?.resetLocalState&&g.value.resetLocalState())}),Ke(p,N=>{N==="checkpoints"&&h.area&&h.area.id&&ve.value.forEach(R=>{setTimeout(()=>X(R.id),0)})});const we=()=>{f("update:isDirty",!0)},De=N=>{_.value.color=N,we()},Se=(N,R)=>{_.value[N]=R,we()},Ee=()=>{f("draw-boundary",_.value)},se=()=>{_.value.polygon=[],we()},me=()=>{f("add-area-contact",h.area)},ne=N=>N?N.replace(/([A-Z])/g," $1").replace(/^./,R=>R.toUpperCase()).trim():"",de=N=>{b.value=N,we()},Le=()=>{I.value||ie.value?B():p.value=ce.value.value},B=()=>{const N=h.area?{name:_.value.name,description:_.value.description,color:_.value.color,polygon:_.value.polygon.length>0?_.value.polygon:null,displayOrder:_.value.displayOrder,checkpointStyleType:_.value.checkpointStyleType,checkpointStyleColor:_.value.checkpointStyleColor,checkpointStyleBackgroundShape:_.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:_.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:_.value.checkpointStyleBorderColor,checkpointStyleIconColor:_.value.checkpointStyleIconColor,checkpointStyleSize:_.value.checkpointStyleSize,checkpointStyleMapRotation:_.value.checkpointStyleMapRotation!=null&&_.value.checkpointStyleMapRotation!==""?String(_.value.checkpointStyleMapRotation):null,peopleTerm:_.value.peopleTerm,checkpointTerm:_.value.checkpointTerm,checklistChanges:b.value||[]}:{name:_.value.name,description:_.value.description,color:_.value.color,polygon:_.value.polygon.length>0?_.value.polygon:null,checkpointStyleType:_.value.checkpointStyleType,checkpointStyleColor:_.value.checkpointStyleColor,checkpointStyleBackgroundShape:_.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:_.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:_.value.checkpointStyleBorderColor,checkpointStyleIconColor:_.value.checkpointStyleIconColor,checkpointStyleSize:_.value.checkpointStyleSize,checkpointStyleMapRotation:_.value.checkpointStyleMapRotation!=null&&_.value.checkpointStyleMapRotation!==""?String(_.value.checkpointStyleMapRotation):null,peopleTerm:_.value.peopleTerm,checkpointTerm:_.value.checkpointTerm};f("save",N)},U=()=>{f("delete",h.area.id)},Q=()=>{f("close")},Z=N=>{const R=N.resolvedStyleType||N.ResolvedStyleType,J=N.resolvedStyleBackgroundColor||N.ResolvedStyleBackgroundColor||N.resolvedStyleColor||N.ResolvedStyleColor,ke=N.resolvedStyleBorderColor||N.ResolvedStyleBorderColor,xe=N.resolvedStyleIconColor||N.ResolvedStyleIconColor,Ce=N.resolvedStyleBackgroundShape||N.ResolvedStyleBackgroundShape;return R&&R!=="default"||J||ke||xe||Ce&&Ce!=="circle"?qt({type:R||"circle",backgroundShape:Ce||"circle",backgroundColor:J||"#667eea",borderColor:ke||"#ffffff",iconColor:xe||"#ffffff",size:"75",outputSize:20}):`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
    <circle cx="10" cy="10" r="8" fill="#667eea" stroke="#fff" stroke-width="1.5"/>
  </svg>`};return(N,R)=>(m(),at(zt,{show:e.show,title:e.area&&e.area.id?`Edit ${V(i).area}: ${e.area.name}`:`Create new ${V(i).area}`,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:Q},{"tab-header":tt(()=>[Ve(uu,{modelValue:p.value,"onUpdate:modelValue":R[0]||(R[0]=J=>p.value=J),tabs:$.value},null,8,["modelValue","tabs"])]),footer:tt(()=>[c("div",d4,[I.value&&!_.value.isDefault?(m(),y("button",{key:0,type:"button",onClick:U,class:"btn btn-danger"}," Delete "+w(V(i).area),1)):(m(),y("div",h4)),c("button",{type:"button",onClick:Le,class:"btn btn-primary"},w(I.value?"Save changes":ge.value),1)])]),default:tt(()=>[p.value==="details"?(m(),y("div",WE,[c("form",{onSubmit:St(B,["prevent"])},[c("div",qE,[R[18]||(R[18]=c("label",null,"Name *",-1)),Ze(c("input",{"onUpdate:modelValue":R[1]||(R[1]=J=>_.value.name=J),type:"text",required:"",class:"form-input",disabled:_.value.isDefault,onInput:we},null,40,GE),[[ut,_.value.name]])]),c("div",KE,[R[19]||(R[19]=c("label",null,"Description",-1)),Ze(c("textarea",{"onUpdate:modelValue":R[2]||(R[2]=J=>_.value.description=J),class:"form-input",rows:"3",onInput:we},null,544),[[ut,_.value.description]])])],32)])):F("",!0),p.value==="boundary"?(m(),y("div",YE,[c("div",JE,[R[20]||(R[20]=c("div",{class:"instructions-card"},[c("p",null,[c("strong",null,"Draw a polygon on the map to define this area's boundary")]),c("p",null,' Click "Draw on Map" to activate drawing mode. Click on the map to add vertices, and double-click to complete the polygon. ')],-1)),c("div",XE,[c("button",{onClick:Ee,class:"btn btn-primary btn-full"}," Draw on Map "),_.value.polygon&&_.value.polygon.length>0?(m(),y("button",{key:0,onClick:se,class:"btn btn-danger btn-full"}," Clear Boundary ")):F("",!0)])])])):F("",!0),p.value==="contacts"?(m(),y("div",QE,[c("h3",eP,w(V(o).area)+" contacts",1),c("div",tP,[c("button",{onClick:me,class:"btn btn-primary btn-full"}," Add contact for this "+w(V(i).area),1)]),He.value.length>0?(m(),y("div",nP,[c("h4",null,"Contacts visible in this "+w(V(i).area)+" ("+w(He.value.length)+")",1),(m(!0),y(Te,null,Ne(He.value,J=>(m(),y("div",{key:J.contactId,class:"contact-item",onClick:ke=>N.$emit("edit-contact",J)},[c("div",sP,[c("strong",null,w(J.name),1),J.role?(m(),y("span",iP,w(ne(J.role)),1)):F("",!0),J.phone||J.email?(m(),y("div",aP,[J.phone?(m(),y("span",rP,w(J.phone),1)):F("",!0),J.email?(m(),y("span",lP,w(J.email),1)):F("",!0)])):F("",!0)])],8,oP))),128))])):F("",!0)])):F("",!0),p.value==="checkpoints"&&I.value?(m(),y("div",cP,[c("h3",uP,w(a())+" in "+w(e.area?.name)+" ("+w(ve.value.length)+")",1),ve.value.length===0?(m(),y("div",dP,[c("p",null,"No "+w(l())+" in this "+w(V(i).area)+" yet.",1)])):(m(),y("div",hP,[(m(!0),y(Te,null,Ne(Be.value,J=>(m(),y("div",{key:J.id,class:"checkpoint-card",onClick:ke=>N.$emit("select-checkpoint",J)},[c("div",pP,[c("span",{class:"checkpoint-icon",innerHTML:Z(J)},null,8,vP),c("div",mP,[c("h4",null,[We(w(J.name),1),J.description?(m(),y("span",gP," - "+w(J.description),1)):F("",!0)])]),c("div",yP,[c("div",{class:Ae(["stat-badge",j(J)])},w(ue(J)),3)])]),c("div",_P,[c("div",kP,[c("span",bP,w(u(J))+":",1),c("span",wP,[We(w(Oe(J.id).length)+" / "+w(J.requiredMarshals)+" ",1),Oe(J.id).length<J.requiredMarshals?(m(),y("span",CP," ("+w(J.requiredMarshals-Oe(J.id).length)+" needed) ",1)):F("",!0)]),Oe(J.id).length>0?(m(),y("div",LP,[(m(!0),y(Te,null,Ne(fe(J.id),ke=>(m(),y("span",{key:ke.id,class:Ae(["marshal-pill",{"checked-in":ke.isCheckedIn}])},w(ke.marshalName),3))),128))])):F("",!0)]),c("div",SP,[R[21]||(R[21]=c("span",{class:"detail-label"},"Checked in:",-1)),c("span",xP,w(q(J))+" / "+w(Oe(J.id).length),1)]),S.value[J.id]?(m(),y("div",TP,[R[22]||(R[22]=c("span",{class:"detail-label"},"Tasks:",-1)),c("span",{class:Ae(["detail-value",K(J.id)])},w(pe(J.id)),3)])):T.value[J.id]?(m(),y("div",IP,[...R[23]||(R[23]=[c("span",{class:"detail-label"},"Tasks:",-1),c("span",{class:"detail-value loading-text"},"Loading...",-1)])])):F("",!0)])],8,fP))),128))]))])):F("",!0),p.value==="checkpoints"&&!I.value?(m(),y("div",$P,[c("p",null,w(a())+" will be automatically assigned based on boundaries after the "+w(V(i).area)+" is created.",1)])):F("",!0),p.value==="checklists"&&I.value?(m(),at(Pp,{key:5,ref_key:"checklistTabRef",ref:g,modelValue:b.value,"onUpdate:modelValue":R[3]||(R[3]=J=>b.value=J),"event-id":e.eventId,"area-id":e.area.id,locations:e.allLocations,areas:e.areas,assignments:re.value,onChange:de},null,8,["modelValue","event-id","area-id","locations","areas","assignments"])):F("",!0),p.value==="checklists"&&!I.value?(m(),y("div",MP,[c("p",null,w(V(o).checklists)+" can be assigned after the "+w(V(i).area)+" is created.",1)])):F("",!0),p.value==="notes"&&I.value?(m(),at(bl,{key:7,"event-id":e.eventId,"area-id":e.area?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","area-id","all-notes","locations","areas","assignments"])):F("",!0),p.value==="notes"&&!I.value?(m(),y("div",AP,[c("p",null,"Notes can be viewed after the "+w(V(i).area)+" is created.",1)])):F("",!0),p.value==="appearance"?(m(),y("div",EP,[c("div",PP,[c("button",{type:"button",class:Ae(["accordion-header",{expanded:M.value.polygonColor}]),onClick:R[4]||(R[4]=J=>x("polygonColor"))},[c("div",{class:"accordion-icon",innerHTML:C.value},null,8,DP),c("span",OP,w(V(o).area)+" polygon colour",1),c("span",RP,w(M.value.polygonColor?"":""),1)],2),M.value.polygonColor?(m(),y("div",BP,[c("p",NP," Choose a colour for this "+w(V(i).area)+"'s boundary on the map. ",1),c("div",FP,[(m(!0),y(Te,null,Ne(V(On),J=>(m(),y("div",{key:J.hex,class:Ae(["color-swatch",{selected:_.value.color===J.hex}]),style:Dt({backgroundColor:J.hex}),title:J.name,onClick:ke=>De(J.hex)},null,14,zP))),128))])])):F("",!0)]),c("div",UP,[c("button",{type:"button",class:Ae(["accordion-header",{expanded:M.value.iconStyle}]),onClick:R[5]||(R[5]=J=>x("iconStyle"))},[c("div",{class:"accordion-icon",innerHTML:A.value},null,8,HP),c("span",VP,w(a(!1))+" icon style",1),c("span",ZP,w(M.value.iconStyle?"":""),1)],2),M.value.iconStyle?(m(),y("div",jP,[c("p",WP," Set a default marker style for all "+w(l())+" in this "+w(V(i).area)+". Individual "+w(l())+" can override this setting. ",1),Ve(cu,{"style-type":_.value.checkpointStyleType||"default","style-color":_.value.checkpointStyleColor||"","style-background-shape":_.value.checkpointStyleBackgroundShape||"","style-background-color":_.value.checkpointStyleBackgroundColor||"","style-border-color":_.value.checkpointStyleBorderColor||"","style-icon-color":_.value.checkpointStyleIconColor||"","style-size":_.value.checkpointStyleSize||"","style-map-rotation":_.value.checkpointStyleMapRotation??"","inherited-style-type":e.eventDefaultStyleType,"inherited-style-color":e.eventDefaultStyleColor,"inherited-background-shape":e.eventDefaultStyleBackgroundShape||"","inherited-background-color":e.eventDefaultStyleBackgroundColor||e.eventDefaultStyleColor||"","inherited-border-color":e.eventDefaultStyleBorderColor||"","inherited-icon-color":e.eventDefaultStyleIconColor||"","inherited-size":e.eventDefaultStyleSize||"","inherited-map-rotation":e.eventDefaultStyleMapRotation??"","default-label":"Event default","icon-label":"Icon style",level:"area","show-preview":!0,"onUpdate:styleType":R[6]||(R[6]=J=>Se("checkpointStyleType",J)),"onUpdate:styleColor":R[7]||(R[7]=J=>Se("checkpointStyleColor",J)),"onUpdate:styleBackgroundShape":R[8]||(R[8]=J=>Se("checkpointStyleBackgroundShape",J)),"onUpdate:styleBackgroundColor":R[9]||(R[9]=J=>Se("checkpointStyleBackgroundColor",J)),"onUpdate:styleBorderColor":R[10]||(R[10]=J=>Se("checkpointStyleBorderColor",J)),"onUpdate:styleIconColor":R[11]||(R[11]=J=>Se("checkpointStyleIconColor",J)),"onUpdate:styleSize":R[12]||(R[12]=J=>Se("checkpointStyleSize",J)),"onUpdate:styleMapRotation":R[13]||(R[13]=J=>Se("checkpointStyleMapRotation",J))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])])):F("",!0)]),c("div",qP,[c("button",{type:"button",class:Ae(["accordion-header",{expanded:M.value.peopleTerm}]),onClick:R[14]||(R[14]=J=>x("peopleTerm"))},[R[24]||(R[24]=c("div",{class:"accordion-icon"},[c("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[c("circle",{cx:"12",cy:"8",r:"4",fill:"#6366F1"}),c("path",{d:"M4 20c0-4.4 3.6-8 8-8s8 3.6 8 8",fill:"#6366F1",opacity:"0.6"})])],-1)),c("span",GP,w(s())+" terminology",1),c("span",KP,w(_.value.peopleTerm||`${e.eventPeopleTerm} (event default)`),1),c("span",YP,w(M.value.peopleTerm?"":""),1)],2),M.value.peopleTerm?(m(),y("div",JP,[c("p",XP," Choose what "+w(s().toLowerCase())+" are called in this "+w(V(i).area)+". This will be inherited by "+w(l())+" unless they override it. ",1),c("div",QP,[R[25]||(R[25]=c("label",null,"What are people called?",-1)),Ze(c("select",{"onUpdate:modelValue":R[15]||(R[15]=J=>_.value.peopleTerm=J),class:"form-input",onChange:we},[c("option",e4,"Use event default ("+w(e.eventPeopleTerm)+")",1),(m(!0),y(Te,null,Ne(V(Ro).people,J=>(m(),y("option",{key:J,value:J},w(J),9,t4))),128))],544),[[gn,_.value.peopleTerm]])])])):F("",!0)]),c("div",n4,[c("button",{type:"button",class:Ae(["accordion-header",{expanded:M.value.checkpointTerm}]),onClick:R[16]||(R[16]=J=>x("checkpointTerm"))},[R[26]||(R[26]=c("div",{class:"accordion-icon"},[c("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[c("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z",fill:"#10B981"}),c("circle",{cx:"12",cy:"9",r:"2.5",fill:"white"})])],-1)),c("span",o4,w(a(!1))+" terminology",1),c("span",s4,w(_.value.checkpointTerm?V(Ec)(_.value.checkpointTerm,s()):`${e.eventCheckpointTerm} (event default)`),1),c("span",i4,w(M.value.checkpointTerm?"":""),1)],2),M.value.checkpointTerm?(m(),y("div",a4,[c("p",r4," Choose what "+w(l())+" are called in this "+w(V(i).area)+". ",1),c("div",l4,[c("label",null,"What are "+w(l())+" called?",1),Ze(c("select",{"onUpdate:modelValue":R[17]||(R[17]=J=>_.value.checkpointTerm=J),class:"form-input",onChange:we},[c("option",c4,"Use event default ("+w(e.eventCheckpointTerm)+")",1),(m(!0),y(Te,null,Ne(V(Ro).checkpoint,J=>(m(),y("option",{key:J,value:J},w(V(Ec)(J,s())),9,u4))),128))],544),[[gn,_.value.checkpointTerm]])])])):F("",!0)])])):F("",!0)]),_:1},8,["show","title","is-dirty"]))}},p4=Xe(f4,[["__scopeId","data-v-78dac2c8"]]),v4=["innerHTML"],m4={__name:"InfoModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Information"},message:{type:String,required:!0},okText:{type:String,default:"OK"}},emits:["close"],setup(e,{emit:t}){const o=t,i=()=>{o("close")};return(s,a)=>(m(),at(zt,{show:e.show,title:e.title,size:"small","z-index":2e3,onClose:i},{actions:tt(()=>[c("button",{onClick:i,class:"btn btn-primary"},w(e.okText),1)]),default:tt(()=>[c("div",{class:"info-content",innerHTML:e.message},null,8,v4)]),_:1},8,["show","title"]))}},wl=Xe(m4,[["__scopeId","data-v-319bcdc8"]]),g4={class:"tab-headers"},y4={class:"tab-content"},_4={class:"form-group"},k4=["placeholder"],b4={key:0,class:"checkbox-label-inline create-separate-items"},w4={class:"tab-content"},C4={class:"custom-footer"},L4={__name:"EditChecklistItemModal",props:{show:{type:Boolean,default:!1},checklistItem:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=O(!1),a=O(""),l=O("details"),u=O({text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0}),h=ae(()=>!!o.checklistItem);Ke(()=>o.show,M=>{M&&(l.value=o.initialTab,o.checklistItem?u.value={text:o.checklistItem.text||"",scopeConfigurations:o.checklistItem.scopeConfigurations?JSON.parse(JSON.stringify(o.checklistItem.scopeConfigurations)):[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:o.checklistItem.displayOrder||0,isRequired:o.checklistItem.isRequired!==!1,visibleFrom:o.checklistItem.visibleFrom?f(o.checklistItem.visibleFrom):null,visibleUntil:o.checklistItem.visibleUntil?f(o.checklistItem.visibleUntil):null,mustCompleteBy:o.checklistItem.mustCompleteBy?f(o.checklistItem.mustCompleteBy):null,createSeparateItems:!1}:u.value={text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0},i("update:isDirty",!1))});const f=M=>{if(!M)return null;const x=new Date(M),C=x.getTimezoneOffset();return new Date(x.getTime()-C*60*1e3).toISOString().slice(0,16)},p=M=>M?new Date(M).toISOString():null,g=()=>{i("update:isDirty",!0)},b=()=>{i("close")},S=()=>{l.value="visibility"},T=M=>{a.value=M,s.value=!0},_=()=>{if(!u.value.text||!u.value.text.trim()){T("Please enter checklist item text");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){T("Please select at least one scope");return}if(!u.value.scopeConfigurations.some(C=>!(C.itemType!==null&&(!C.ids||C.ids.length===0)))){T("Please configure at least one scope with valid selections");return}const x={text:u.value.text,scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,isRequired:u.value.isRequired,visibleFrom:p(u.value.visibleFrom),visibleUntil:p(u.value.visibleUntil),mustCompleteBy:p(u.value.mustCompleteBy)};h.value||(x.createSeparateItems=u.value.createSeparateItems),i("save",x)},D=()=>{i("delete",o.checklistItem.itemId)};return(M,x)=>(m(),y(Te,null,[Ve(zt,{show:e.show,title:h.value?"Edit checklist item":"Create checklist item",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:b},{footer:tt(()=>[c("div",C4,[h.value?(m(),y("button",{key:0,type:"button",onClick:D,class:"btn btn-danger"}," Delete ")):F("",!0),!h.value&&l.value==="details"?(m(),y("button",{key:1,type:"button",onClick:S,class:"btn btn-primary"}," Next ")):F("",!0),h.value||l.value==="visibility"?(m(),y("button",{key:2,type:"button",onClick:_,class:"btn btn-primary"},w(h.value?"Save changes":"Create"),1)):F("",!0)])]),default:tt(()=>[c("div",g4,[c("button",{type:"button",class:Ae(["tab-header",{active:l.value==="details"}]),onClick:x[0]||(x[0]=C=>l.value="details")}," Details ",2),c("button",{type:"button",class:Ae(["tab-header",{active:l.value==="visibility"}]),onClick:x[1]||(x[1]=C=>l.value="visibility")}," Visibility ",2)]),c("form",{onSubmit:St(_,["prevent"]),class:"checklist-form"},[Ze(c("div",y4,[c("div",_4,[x[7]||(x[7]=c("label",{for:"text"},"Checklist text: *",-1)),Ze(c("textarea",{id:"text","onUpdate:modelValue":x[2]||(x[2]=C=>u.value.text=C),onInput:g,required:"",rows:"3",placeholder:u.value.createSeparateItems?"Enter checklist items, one per line...":"Enter the checklist item text..."},null,40,k4),[[ut,u.value.text]]),h.value?F("",!0):(m(),y("label",b4,[Ze(c("input",{type:"checkbox","onUpdate:modelValue":x[3]||(x[3]=C=>u.value.createSeparateItems=C),onChange:g},null,544),[[us,u.value.createSeparateItems]]),x[6]||(x[6]=c("span",null,"Each line creates a new item",-1))]))])],512),[[ms,l.value==="details"]]),Ze(c("div",w4,[Ve(kl,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":x[4]||(x[4]=C=>u.value.scopeConfigurations=C),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":h.value,onUserChanged:g},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ms,l.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ve(wl,{show:s.value,title:"Validation error",message:a.value,onClose:x[5]||(x[5]=C=>s.value=!1)},null,8,["show","message"])],64))}},S4=Xe(L4,[["__scopeId","data-v-bb89c7c7"]]),x4={class:"tab-headers"},T4={class:"tab-content"},I4={class:"form-group"},$4={class:"form-group"},M4={class:"form-row"},A4={class:"form-group"},E4={class:"form-group"},P4={class:"form-row"},D4={class:"form-group"},O4={class:"form-group checkbox-group-inline"},R4={class:"checkbox-label-inline"},B4={class:"tab-content"},N4={class:"custom-footer"},F4={__name:"EditNoteModal",props:{show:{type:Boolean,default:!1},note:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=O(!1),a=O(""),l=O("details"),u=O({title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1}),h=ae(()=>!!o.note);Ke(()=>o.show,_=>{_&&(l.value=o.initialTab,o.note?u.value={title:o.note.title||"",content:o.note.content||"",scopeConfigurations:o.note.scopeConfigurations?JSON.parse(JSON.stringify(o.note.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:o.note.displayOrder||0,priority:o.note.priority||"Normal",category:o.note.category||"",isPinned:o.note.isPinned||!1}:u.value={title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1},i("update:isDirty",!1))});const f=()=>{i("update:isDirty",!0)},p=()=>{i("close")},g=()=>{l.value="visibility"},b=_=>{a.value=_,s.value=!0},S=()=>{if(!u.value.title||!u.value.title.trim()){b("Please enter a note title");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){b("Please select at least one visibility scope");return}if(!u.value.scopeConfigurations.some(M=>!(M.itemType!==null&&(!M.ids||M.ids.length===0)))){b("Please configure at least one scope with valid selections");return}const D={title:u.value.title.trim(),content:u.value.content||"",scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,priority:u.value.priority||"Normal",category:u.value.category?.trim()||null,isPinned:u.value.isPinned||!1};i("save",D)},T=()=>{i("delete",o.note.noteId)};return(_,D)=>(m(),y(Te,null,[Ve(zt,{show:e.show,title:h.value?"Edit note":"Create note",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:p},{footer:tt(()=>[c("div",N4,[h.value?(m(),y("button",{key:0,type:"button",onClick:T,class:"btn btn-danger"}," Delete ")):F("",!0),!h.value&&l.value==="details"?(m(),y("button",{key:1,type:"button",onClick:g,class:"btn btn-primary"}," Next ")):F("",!0),h.value||l.value==="visibility"?(m(),y("button",{key:2,type:"button",onClick:S,class:"btn btn-primary"},w(h.value?"Save changes":"Create"),1)):F("",!0)])]),default:tt(()=>[c("div",x4,[c("button",{type:"button",class:Ae(["tab-header",{active:l.value==="details"}]),onClick:D[0]||(D[0]=M=>l.value="details")}," Details ",2),c("button",{type:"button",class:Ae(["tab-header",{active:l.value==="visibility"}]),onClick:D[1]||(D[1]=M=>l.value="visibility")}," Visibility ",2)]),c("form",{onSubmit:St(S,["prevent"]),class:"note-form"},[Ze(c("div",T4,[c("div",I4,[D[10]||(D[10]=c("label",{for:"title"},"Title: *",-1)),Ze(c("input",{id:"title","onUpdate:modelValue":D[2]||(D[2]=M=>u.value.title=M),type:"text",onInput:f,required:"",placeholder:"Enter note title..."},null,544),[[ut,u.value.title]])]),c("div",$4,[D[11]||(D[11]=c("label",{for:"content"},"Content:",-1)),Ze(c("textarea",{id:"content","onUpdate:modelValue":D[3]||(D[3]=M=>u.value.content=M),onInput:f,rows:"6",placeholder:"Enter note content (supports markdown)..."},null,544),[[ut,u.value.content]])]),c("div",M4,[c("div",A4,[D[13]||(D[13]=c("label",{for:"priority"},"Priority:",-1)),Ze(c("select",{id:"priority","onUpdate:modelValue":D[4]||(D[4]=M=>u.value.priority=M),onChange:f},[...D[12]||(D[12]=[c("option",{value:"Emergency"},"Emergency",-1),c("option",{value:"Urgent"},"Urgent",-1),c("option",{value:"High"},"High",-1),c("option",{value:"Normal"},"Normal",-1),c("option",{value:"Low"},"Low",-1)])],544),[[gn,u.value.priority]])]),c("div",E4,[D[14]||(D[14]=c("label",{for:"category"},"Category:",-1)),Ze(c("input",{id:"category","onUpdate:modelValue":D[5]||(D[5]=M=>u.value.category=M),type:"text",onInput:f,placeholder:"e.g., Safety, Logistics..."},null,544),[[ut,u.value.category]])])]),c("div",P4,[c("div",D4,[D[15]||(D[15]=c("label",{for:"displayOrder"},"Display order:",-1)),Ze(c("input",{id:"displayOrder","onUpdate:modelValue":D[6]||(D[6]=M=>u.value.displayOrder=M),type:"number",onInput:f,min:"0"},null,544),[[ut,u.value.displayOrder,void 0,{number:!0}]]),D[16]||(D[16]=c("span",{class:"help-text"},"Lower numbers appear first",-1))]),c("div",O4,[c("label",R4,[Ze(c("input",{type:"checkbox","onUpdate:modelValue":D[7]||(D[7]=M=>u.value.isPinned=M),onChange:f},null,544),[[us,u.value.isPinned]]),D[17]||(D[17]=c("span",null,"Pin to top",-1))]),D[18]||(D[18]=c("span",{class:"help-text"},"Pinned notes always appear at the top",-1))])])],512),[[ms,l.value==="details"]]),Ze(c("div",B4,[Ve(kl,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":D[8]||(D[8]=M=>u.value.scopeConfigurations=M),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":h.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this note?",onUserChanged:f},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ms,l.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ve(wl,{show:s.value,title:"Validation error",message:a.value,onClose:D[9]||(D[9]=M=>s.value=!1)},null,8,["show","message"])],64))}},z4=Xe(F4,[["__scopeId","data-v-1a34c03e"]]),U4={class:"tab-headers"},H4={class:"tab-content"},V4={class:"form-group"},Z4={for:"marshalId"},j4=["value"],W4={class:"help-text"},q4={class:"form-group"},G4=["disabled"],K4={class:"form-group"},Y4={class:"role-input-group"},J4={key:0,label:"Built-in Roles"},X4=["value"],Q4={key:1,label:"Custom Roles"},e3=["value"],t3={class:"form-row"},n3={class:"form-group"},o3={class:"form-group"},s3={class:"form-group"},i3={class:"tab-content"},a3={class:"custom-footer"},r3={__name:"EditContactModal",props:{show:{type:Boolean,default:!1},contact:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},isDirty:{type:Boolean,default:!1},preselectedArea:{type:Object,default:null}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{terms:o}=yt(),i=e,s=t,a=O(!1),l=O(""),u=O("details"),h=O(!1),f=O({role:"",name:"",phone:"",email:"",notes:"",marshalId:null,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}),p=ae(()=>!!i.contact),g=ae(()=>!!f.value.marshalId),b=ae(()=>[...i.marshals].sort((I,$)=>_n(I.name,$.name)));Ke(()=>i.show,I=>{if(I){if(u.value=i.initialTab,i.contact){const $=[...i.availableRoles.builtInRoles||[],...i.availableRoles.customRoles||[]];h.value=i.contact.role&&!$.includes(i.contact.role),f.value={role:i.contact.role||"",name:i.contact.name||"",phone:i.contact.phone||"",email:i.contact.email||"",notes:i.contact.notes||"",marshalId:i.contact.marshalId||null,scopeConfigurations:i.contact.scopeConfigurations?JSON.parse(JSON.stringify(i.contact.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}}else{h.value=!1;const $=i.preselectedArea?[{scope:"EveryoneInAreas",itemType:"Area",ids:[i.preselectedArea.id]}]:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}];f.value={role:"",name:"",phone:"",email:"",notes:"",marshalId:null,scopeConfigurations:$}}s("update:isDirty",!1)}});const S=I=>I?I==="AreaLead"?`${o.value.area} Lead`:I.replace(/([A-Z])/g," $1").replace(/^./,$=>$.toUpperCase()).trim():"",T=()=>{s("update:isDirty",!0)},_=()=>{if(f.value.marshalId){const I=i.marshals.find($=>$.id===f.value.marshalId);I&&(f.value.name=I.name,!f.value.phone&&I.phoneNumber&&(f.value.phone=I.phoneNumber),!f.value.email&&I.email&&(f.value.email=I.email))}T()},D=()=>{s("close")},M=()=>{if(!f.value.role||!f.value.role.trim()){x("Please select or enter a role");return}if(!f.value.name||!f.value.name.trim()){x("Please enter a contact name");return}u.value="visibility"},x=I=>{l.value=I,a.value=!0},C=()=>{if(!f.value.role||!f.value.role.trim()){x("Please select or enter a role");return}if(!f.value.name||!f.value.name.trim()){x("Please enter a contact name");return}if(!f.value.scopeConfigurations||f.value.scopeConfigurations.length===0){x("Please select at least one visibility scope");return}if(!f.value.scopeConfigurations.some(E=>!(E.itemType!==null&&(!E.ids||E.ids.length===0)))){x("Please configure at least one scope with valid selections");return}const $={role:f.value.role.trim(),name:f.value.name.trim(),phone:f.value.phone?.trim()||null,email:f.value.email?.trim()||null,notes:f.value.notes?.trim()||null,marshalId:f.value.marshalId||null,scopeConfigurations:f.value.scopeConfigurations};s("save",$)},A=()=>{s("delete",i.contact.contactId)};return(I,$)=>(m(),y(Te,null,[Ve(zt,{show:e.show,title:p.value?"Edit contact":"Create contact",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:D},{footer:tt(()=>[c("div",a3,[p.value?(m(),y("button",{key:0,type:"button",onClick:A,class:"btn btn-danger"}," Delete ")):F("",!0),!p.value&&u.value==="details"?(m(),y("button",{key:1,type:"button",onClick:M,class:"btn btn-primary"}," Next ")):F("",!0),p.value||u.value==="visibility"?(m(),y("button",{key:2,type:"button",onClick:C,class:"btn btn-primary"},w(p.value?"Save changes":"Create"),1)):F("",!0)])]),default:tt(()=>[c("div",U4,[c("button",{type:"button",class:Ae(["tab-header",{active:u.value==="details"}]),onClick:$[0]||($[0]=E=>u.value="details")}," Details ",2),c("button",{type:"button",class:Ae(["tab-header",{active:u.value==="visibility"}]),onClick:$[1]||($[1]=E=>u.value="visibility")}," Visibility ",2)]),c("form",{onSubmit:St(C,["prevent"]),class:"contact-form"},[Ze(c("div",H4,[c("div",V4,[c("label",Z4,"Link to "+w(V(o).person.toLowerCase())+":",1),Ze(c("select",{id:"marshalId","onUpdate:modelValue":$[2]||($[2]=E=>f.value.marshalId=E),onChange:_},[$[12]||($[12]=c("option",{value:null},"-- Not linked --",-1)),(m(!0),y(Te,null,Ne(b.value,E=>(m(),y("option",{key:E.id,value:E.id},w(E.name),9,j4))),128))],544),[[gn,f.value.marshalId]]),c("span",W4,"Optionally link to an existing "+w(V(o).person.toLowerCase())+" in the system",1)]),c("div",q4,[$[13]||($[13]=c("label",{for:"name"},"Name: *",-1)),Ze(c("input",{id:"name","onUpdate:modelValue":$[3]||($[3]=E=>f.value.name=E),type:"text",onInput:T,disabled:g.value,class:Ae({"input-disabled":g.value}),placeholder:"Contact name..."},null,42,G4),[[ut,f.value.name]])]),c("div",K4,[$[15]||($[15]=c("label",{for:"role"},"Role: *",-1)),c("div",Y4,[h.value?Ze((m(),y("input",{key:1,id:"customRole","onUpdate:modelValue":$[5]||($[5]=E=>f.value.role=E),type:"text",onInput:T,placeholder:"Enter custom role name..."},null,544)),[[ut,f.value.role]]):Ze((m(),y("select",{key:0,id:"role","onUpdate:modelValue":$[4]||($[4]=E=>f.value.role=E),onChange:T},[$[14]||($[14]=c("option",{value:"",disabled:""},"Select a role...",-1)),e.availableRoles.builtInRoles?.length>0?(m(),y("optgroup",J4,[(m(!0),y(Te,null,Ne(e.availableRoles.builtInRoles,E=>(m(),y("option",{key:E,value:E},w(S(E)),9,X4))),128))])):F("",!0),e.availableRoles.customRoles?.length>0?(m(),y("optgroup",Q4,[(m(!0),y(Te,null,Ne(e.availableRoles.customRoles,E=>(m(),y("option",{key:E,value:E},w(S(E)),9,e3))),128))])):F("",!0)],544)),[[gn,f.value.role]]),c("button",{type:"button",class:"toggle-custom-btn",onClick:$[6]||($[6]=E=>h.value=!h.value)},w(h.value?"Use existing":"Custom"),1)])]),c("div",t3,[c("div",n3,[$[16]||($[16]=c("label",{for:"phone"},"Phone:",-1)),Ze(c("input",{id:"phone","onUpdate:modelValue":$[7]||($[7]=E=>f.value.phone=E),type:"tel",onInput:T,placeholder:"Phone number..."},null,544),[[ut,f.value.phone]])]),c("div",o3,[$[17]||($[17]=c("label",{for:"email"},"Email:",-1)),Ze(c("input",{id:"email","onUpdate:modelValue":$[8]||($[8]=E=>f.value.email=E),type:"email",onInput:T,placeholder:"Email address..."},null,544),[[ut,f.value.email]])])]),c("div",s3,[$[18]||($[18]=c("label",{for:"notes"},"Notes / Instructions:",-1)),Ze(c("textarea",{id:"notes","onUpdate:modelValue":$[9]||($[9]=E=>f.value.notes=E),onInput:T,rows:"3",placeholder:"Additional notes or instructions for when to contact..."},null,544),[[ut,f.value.notes]])])],512),[[ms,u.value==="details"]]),Ze(c("div",i3,[Ve(kl,{modelValue:f.value.scopeConfigurations,"onUpdate:modelValue":$[10]||($[10]=E=>f.value.scopeConfigurations=E),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":p.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this contact?",onUserChanged:T},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ms,u.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ve(wl,{show:a.value,title:"Validation error",message:l.value,onClose:$[11]||($[11]=E=>a.value=!1)},null,8,["show","message"])],64))}},l3=Xe(r3,[["__scopeId","data-v-62986ae5"]]),c3={key:0,class:"fullscreen-map-overlay"},u3={class:"fullscreen-map-header"},d3={class:"context-info"},h3={key:0},f3={class:"action-buttons"},p3=["disabled"],v3={class:"fullscreen-map-container"},m3={key:0,class:"drawing-controls"},g3={class:"point-count"},y3={class:"undo-redo-buttons"},_3=["disabled"],k3=["disabled"],b3=Object.assign({inheritAttrs:!1},{__name:"FullscreenMapOverlay",props:{show:{type:Boolean,required:!0},mode:{type:String,validator:e=>["place-checkpoint","move-checkpoint","draw-area","add-multiple"].includes(e)},contextTitle:{type:String,default:""},contextDescription:{type:String,default:""},canComplete:{type:Boolean,default:!1},drawingMode:{type:Boolean,default:!1}},emits:["done","cancel","map-click","polygon-complete","polygon-drawing","location-click","area-click"],setup(e,{emit:t}){const o=e,i=t,s=O(null),a=O(0),l=O(!1),u=O(!1),h=()=>{i("done")},f=()=>{i("cancel")},p=_=>{a.value=_?.length||0,g(),i("polygon-drawing",_)},g=()=>{s.value&&(l.value=s.value.canUndo(),u.value=s.value.canRedo())},b=()=>{s.value&&(s.value.undoPolygonPoint(),g())},S=()=>{s.value&&(s.value.redoPolygonPoint(),g())};Ke(()=>o.show,_=>{_||(a.value=0,l.value=!1,u.value=!1)});const T=_=>{_.key==="Escape"&&o.show&&f(),o.show&&o.drawingMode&&((_.ctrlKey||_.metaKey)&&_.key==="z"&&!_.shiftKey?(_.preventDefault(),b()):(_.ctrlKey||_.metaKey)&&(_.key==="y"||_.key==="z"&&_.shiftKey)&&(_.preventDefault(),S()))};return rn(()=>{document.addEventListener("keydown",T)}),fo(()=>{document.removeEventListener("keydown",T)}),(_,D)=>(m(),at(am,{to:"body"},[e.show?(m(),y("div",c3,[c("div",u3,[c("div",d3,[c("h3",null,w(e.contextTitle),1),e.contextDescription?(m(),y("p",h3,w(e.contextDescription),1)):F("",!0)]),c("div",f3,[c("button",{onClick:f,class:"btn btn-cancel"}," Cancel "),c("button",{onClick:h,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,p3)])]),c("div",v3,[Ve(Ba,Mf({ref_key:"mapViewRef",ref:s,"drawing-mode":e.drawingMode},_.$attrs,{onMapClick:D[0]||(D[0]=M=>_.$emit("map-click",M)),onPolygonComplete:D[1]||(D[1]=M=>_.$emit("polygon-complete",M)),onPolygonDrawing:p,onLocationClick:D[2]||(D[2]=M=>_.$emit("location-click",M)),onAreaClick:D[3]||(D[3]=M=>_.$emit("area-click",M))}),null,16,["drawing-mode"]),e.drawingMode&&a.value>0?(m(),y("div",m3,[c("div",g3,w(a.value)+" point"+w(a.value!==1?"s":""),1),c("div",y3,[c("button",{onClick:b,class:"btn-drawing undo-btn",disabled:!l.value,title:"Undo last point"},"  Undo ",8,_3),c("button",{onClick:S,class:"btn-drawing redo-btn",disabled:!u.value,title:"Redo point"}," Redo  ",8,k3)])])):F("",!0)])])):F("",!0)]))}}),w3=Xe(b3,[["__scopeId","data-v-a7562744"]]),C3={class:"form-group"},L3={class:"form-group"},S3={class:"form-group"},x3={key:0,class:"form-error"},T3={class:"form-row"},I3={class:"form-group",style:{flex:"1"}},$3={class:"form-group",style:{flex:"1"}},M3={class:"form-group",style:{flex:"0 0 auto"}},A3={class:"form-group"},E3={__name:"AddLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:()=>({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""})},isDirty:{type:Boolean,default:!1}},emits:["close","save","set-on-map","update:isDirty","update:location"],setup(e,{emit:t}){const{termsLower:o}=yt(),i=e,s=t,a=O({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""});Ke(()=>i.location,f=>{f&&(a.value={...f})},{immediate:!0,deep:!0});const l=()=>{s("update:isDirty",!0),s("update:location",{...a.value})},u=()=>{if(!Wr(a.value.what3Words)&&a.value.what3Words){alert("Invalid What3Words format.");return}s("save",a.value)},h=()=>{s("close")};return(f,p)=>(m(),at(zt,{show:e.show,title:`Add ${V(o).checkpoint}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:h},{actions:tt(()=>[c("button",{type:"button",onClick:h,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:u,class:"btn btn-primary"}," Add "+w(V(o).checkpoint),1)]),default:tt(()=>[c("form",{onSubmit:St(u,["prevent"])},[c("div",C3,[p[7]||(p[7]=c("label",null,"Name",-1)),Ze(c("input",{"onUpdate:modelValue":p[0]||(p[0]=g=>a.value.name=g),type:"text",required:"",class:"form-input",onInput:l},null,544),[[ut,a.value.name]])]),c("div",L3,[p[8]||(p[8]=c("label",null,"Description",-1)),Ze(c("input",{"onUpdate:modelValue":p[1]||(p[1]=g=>a.value.description=g),type:"text",class:"form-input",onInput:l},null,544),[[ut,a.value.description]])]),c("div",S3,[p[9]||(p[9]=c("label",null,"What3Words (optional)",-1)),Ze(c("input",{"onUpdate:modelValue":p[2]||(p[2]=g=>a.value.what3Words=g),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap",onInput:l},null,544),[[ut,a.value.what3Words]]),a.value.what3Words&&!V(Wr)(a.value.what3Words)?(m(),y("small",x3," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):F("",!0)]),c("div",T3,[c("div",I3,[p[10]||(p[10]=c("label",null,"Longitude",-1)),Ze(c("input",{"onUpdate:modelValue":p[3]||(p[3]=g=>a.value.longitude=g),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[ut,a.value.longitude,void 0,{number:!0}]])]),c("div",$3,[p[11]||(p[11]=c("label",null,"Latitude",-1)),Ze(c("input",{"onUpdate:modelValue":p[4]||(p[4]=g=>a.value.latitude=g),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[ut,a.value.latitude,void 0,{number:!0}]])]),c("div",M3,[p[12]||(p[12]=c("label",null,"",-1)),c("button",{type:"button",class:"icon-btn",title:"Set location on map",onClick:p[5]||(p[5]=g=>f.$emit("set-on-map"))},"  ")])]),c("div",A3,[c("label",null,"Required "+w(V(o).people),1),Ze(c("input",{"onUpdate:modelValue":p[6]||(p[6]=g=>a.value.requiredMarshals=g),type:"number",min:"1",required:"",class:"form-input",onInput:l},null,544),[[ut,a.value.requiredMarshals,void 0,{number:!0}]])])],32)]),_:1},8,["show","title","is-dirty"]))}},P3=Xe(E3,[["__scopeId","data-v-dcbdc216"]]),D3={class:"admin-event-manage"},O3={class:"header"},R3={class:"header-left"},B3={key:0},N3={class:"event-date"},F3={class:"header-actions"},z3={class:"container"},U3={class:"tabs-nav"},H3={class:"tab-content-wrapper"},V3={key:1,class:"tab-panel"},Z3={key:2,class:"tab-panel"},j3={__name:"AdminEventManage",setup(e){const t=su(),o=Ha(),i=Sp(),{activeTab:s,switchTab:a}=xp("details",["details","course","areas","checkpoints","marshals","notes","checklists","contacts","settings"]),{showConfirmModal:l,confirmModalTitle:u,confirmModalMessage:h,showConfirm:f,handleConfirmModalConfirm:p,handleConfirmModalCancel:g}=$b(),{tabLabels:b,termsLower:S}=yt(),T=ae(()=>[{value:"details",label:"Event details",icon:"details"},{value:"course",label:b.value.course,icon:"course"},{value:"areas",label:b.value.areas,icon:"area"},{value:"checkpoints",label:b.value.checkpoints,icon:"checkpoint"},{value:"marshals",label:b.value.marshals,icon:"marshal"},{value:"notes",label:"Notes",icon:"notes"},{value:"checklists",label:b.value.checklists,icon:"checklist"},{value:"contacts",label:"Contacts",icon:"contacts"},{value:"settings",label:"Settings",icon:"settings"}]),_=O(null),D=O([]),M=O([]),x=O(null),C=O(!1),A=O(null),I=O(!1),$=O(!1),E=O(null),ie=O(""),ce=O([]),ge=O(!1),re=O(!1),ve=O(!1),Be=O(null),He=O(!1),Oe=O(!1),fe=O(!1),q=O(!1),j=O(null),ue=O(null),K=O(null),pe=O(!1),X=O(!1),we=O({id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),De=O(!1),Se=O(!1),Ee=O({marshalName:"",locations:[],marshal:null}),se=O(null),me=O([]),ne=O(!1),de=O(null),Le=O({id:"",name:"",email:"",phoneNumber:"",notes:""}),B=O(!1),U=O([]),Q=O([]),Z=O([]),N=O([]),R=O(!1),J=O(""),ke=O(""),xe=O({name:"",description:"",eventDate:"",timeZoneId:"UTC",peopleTerm:"Marshals",defaultCheckpointStyleBackgroundShape:"",defaultCheckpointStyleBackgroundColor:"",defaultCheckpointStyleBorderColor:"",defaultCheckpointStyleIconColor:"",defaultCheckpointStyleSize:"",defaultCheckpointStyleMapRotation:"",checkpointTerm:"Checkpoints",areaTerm:"Areas",checklistTerm:"Checklists",courseTerm:"Course",defaultCheckpointStyleType:"default",defaultCheckpointStyleColor:""}),Ce=O(!1),ze=O(!1),Re=O(""),je=O(""),Ye=O(0),te=O({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Y=O([]),H=O(null),Fe=O(!1),Je=O(null),Qe=O(!1),ot=O(null),$t=O(!1),Mt=O(1),_t=O(!1),rt=O(null),At=O({}),kt=O(null),Fn=O(null),Jt=O(null),eo=O([]),wn=O(null),$n=O(null),po=O([]),zn=O(null),jo=O(!1),_s=O("details"),Gs=O(null),Un=O([]),ln=O(null),Xt=O(!1),ks=O("details"),Wo=O([]),Kt=O({builtInRoles:[],customRoles:[]}),qe=O(null),Hn=O(!1),to=O("details"),vo=O(null),no=O(null),qo=ae(()=>no.value?.marshalId!=null),Ks=()=>{o.push(`/event/${t.params.eventId}`)},Cn=ae(()=>`${window.location.origin}/#/event/${t.params.eventId}`),Go=ae(()=>{const z=[];return M.value.forEach(oe=>{oe.assignments&&z.push(...oe.assignments)}),z}),Di=ae(()=>{if(!de.value)return M.value;const z=de.value.assignedLocationIds||[],oe=Z.value.map($e=>$e.locationId),Ie=N.value;return M.value.filter($e=>!z.includes($e.id)&&!oe.includes($e.id)||Ie.includes($e.id))}),Ys=ae(()=>{let z=me.value;if(x.value){const oe=x.value.assignments.map($e=>$e.marshalName),Ie=U.value.map($e=>$e.marshalName);z=me.value.filter($e=>!oe.includes($e.name)&&!Ie.includes($e.name))}return z.slice().sort((oe,Ie)=>oe.name.localeCompare(Ie.name))}),Oi=ae(()=>rt.value==="place-checkpoint"||rt.value==="move-checkpoint"?kt.value!==null:rt.value==="draw-area"?H.value?.polygon?.length>0||Jt.value&&Jt.value.length>=3:rt.value==="add-multiple"),Ri=ae(()=>{const z=[...M.value];return rt.value==="place-checkpoint"&&kt.value&&z.push({id:"temp-single",name:te.value.name||"New Checkpoint",latitude:kt.value.lat,longitude:kt.value.lng,requiredMarshals:te.value.requiredMarshals||1,assignments:[],isTemporary:!0}),rt.value==="move-checkpoint"&&kt.value&&x.value&&z.push({id:"temp-move",name:x.value.name+" (new position)",latitude:kt.value.lat,longitude:kt.value.lng,requiredMarshals:x.value.requiredMarshals,assignments:[],isTemporary:!0}),rt.value==="add-multiple"&&z.push(...eo.value),z}),Ko=ae(()=>{const z=[...Y.value];if(rt.value==="draw-area"&&H.value?.polygon?.length>0){const oe=z.findIndex(Ie=>Ie.id===H.value.id);oe>=0?z[oe]={...H.value}:z.push({...H.value,id:H.value.id||"temp-area"})}return z}),bs=()=>{o.push("/admin/dashboard")},Yo=()=>{o.push({name:"AdminProfile"})},Et=(z=!0)=>{B.value=z},Js=()=>{Ce.value=!0},Xs=async z=>{try{z&&(xe.value={...z});const oe=Ra(_.value.eventDate),Ie=xe.value.eventDate;if(oe!==Ie){const $e=D.value.filter(ht=>ht.startTime||ht.endTime);if($e.length>0){Re.value=oe,je.value=Ie,Ye.value=$e.length,ze.value=!0;return}}await Qs(!1,null)}catch(oe){console.error("Failed to update event:",oe),alert("Failed to update event. Please try again.")}},Qs=async(z,oe)=>{try{if(await i.updateEvent(t.params.eventId,{...xe.value,defaultCheckpointStyleMapRotation:xe.value.defaultCheckpointStyleMapRotation!=null?String(xe.value.defaultCheckpointStyleMapRotation):null}),z&&oe!==null){const Ie=Math.floor(Math.abs(oe)/1e3),$e=oe<0,ht=Math.floor(Ie/3600),Qt=Math.floor(Ie%3600/60),En=Ie%60,$s=`${$e?"-":""}${ht.toString().padStart(2,"0")}:${Qt.toString().padStart(2,"0")}:${En.toString().padStart(2,"0")}`;await i.bulkUpdateLocationTimes(t.params.eventId,$s)}await Zt(),Ce.value=!1}catch(Ie){console.error("Failed to update event:",Ie),alert("Failed to update event. Please try again.")}},mo=async({shouldShift:z,timeDelta:oe})=>{ze.value=!1,await Qs(z,oe)},Jo=()=>{ze.value=!1,Zt()},Zt=async()=>{try{await i.fetchEvent(t.params.eventId),_.value=i.currentEvent,_.value&&(xe.value={name:_.value.name||"",description:_.value.description||"",eventDate:Ra(_.value.eventDate),timeZoneId:_.value.timeZoneId||"UTC",peopleTerm:_.value.peopleTerm||"Marshals",checkpointTerm:_.value.checkpointTerm||"Checkpoints",areaTerm:_.value.areaTerm||"Areas",checklistTerm:_.value.checklistTerm||"Checklists",courseTerm:_.value.courseTerm||"Course",defaultCheckpointStyleType:_.value.defaultCheckpointStyleType||"default",defaultCheckpointStyleColor:_.value.defaultCheckpointStyleColor||"",defaultCheckpointStyleBackgroundShape:_.value.defaultCheckpointStyleBackgroundShape||"",defaultCheckpointStyleBackgroundColor:_.value.defaultCheckpointStyleBackgroundColor||"",defaultCheckpointStyleBorderColor:_.value.defaultCheckpointStyleBorderColor||"",defaultCheckpointStyleIconColor:_.value.defaultCheckpointStyleIconColor||"",defaultCheckpointStyleSize:_.value.defaultCheckpointStyleSize||"",defaultCheckpointStyleMapRotation:_.value.defaultCheckpointStyleMapRotation??""},Ce.value=!1,Pc(_.value));const z=await Promise.allSettled([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId),oi(),G(),ee(),le(),be(),Pe()]);D.value=i.locations,M.value=i.eventStatus.locations,z.forEach((oe,Ie)=>{oe.status==="rejected"&&console.error(`Failed to load ${["locations","eventStatus","admins","marshals","areas","checklists","notes","contacts"][Ie]}:`,oe.reason)})}catch(z){console.error("Failed to load event data:",z)}},G=async()=>{try{const z=await co.getByEvent(t.params.eventId);me.value=z.data}catch(z){console.error("Failed to load marshals:",z)}},ee=async()=>{try{const z=await ds.getByEvent(t.params.eventId);Y.value=z.data}catch(z){console.error("Failed to load areas:",z)}},le=async()=>{try{const[z,oe]=await Promise.all([It.getByEvent(t.params.eventId),It.getReport(t.params.eventId)]);po.value=z.data,Gs.value=oe.data}catch(z){console.error("Failed to load checklists:",z)}},be=async()=>{try{const z=await Eo.getByEvent(t.params.eventId);Un.value=z.data}catch(z){console.error("Failed to load notes:",z)}},Pe=async()=>{try{const[z,oe]=await Promise.all([gi.getByEvent(t.params.eventId),gi.getRoles(t.params.eventId)]);Wo.value=z.data,Kt.value=oe.data}catch(z){console.error("Failed to load contacts:",z)}},st=async()=>{await Promise.all([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId)]),D.value=i.locations,M.value=i.eventStatus.locations},Ct=async()=>{await Promise.all([G(),i.fetchEventStatus(t.params.eventId)]),M.value=i.eventStatus.locations},Pt=async()=>{await Promise.all([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId),ee()]),D.value=i.locations,M.value=i.eventStatus.locations},ws=async()=>{await i.fetchEventStatus(t.params.eventId),M.value=i.eventStatus.locations},ct=()=>{H.value=null,B.value=!1,Fe.value=!0},Tt=z=>{H.value=z,Je.value=z.id,B.value=!1,Fe.value=!0},Bi=async z=>{try{if(H.value&&H.value.id){if(await ds.update(t.params.eventId,H.value.id,z),z.checklistChanges&&z.checklistChanges.length>0)for(const oe of z.checklistChanges)try{oe.complete?await It.complete(t.params.eventId,oe.itemId,{marshalId:oe.marshalId,contextType:oe.contextType,contextId:oe.contextId}):await It.uncomplete(t.params.eventId,oe.itemId,{marshalId:oe.marshalId,contextType:oe.contextType,contextId:oe.contextId})}catch(Ie){console.error("Failed to update checklist item:",oe,Ie)}}else await ds.create({eventId:t.params.eventId,...z});await ee(),await Zt(),jt()}catch(oe){console.error("Failed to save area:",oe),alert(oe.response?.data?.message||"Failed to save area. Please try again.")}},ei=async z=>{f("Delete area","Are you sure you want to delete this area? Checkpoints will be automatically reassigned.",async()=>{try{await ds.delete(t.params.eventId,z),await ds.recalculate(t.params.eventId),await ee(),await Zt(),jt()}catch(oe){console.error("Failed to delete area:",oe),alert(oe.response?.data?.message||"Failed to delete area. Please try again.")}})},jt=()=>{Fe.value=!1,H.value=null,Je.value=null,B.value=!1,Qe.value=!1,ot.value=null},Cl=z=>{jt(),qe.value=null,to.value="details",B.value=!1,vo.value=z,Hn.value=!0},ti=z=>{jt(),qe.value=z,to.value="details",B.value=!1,Hn.value=!0},go=()=>{zn.value=null,_s.value="details",B.value=!1,jo.value=!0},Ot=(z,oe="details")=>{zn.value=z,_s.value=oe,B.value=!1,jo.value=!0},yo=async z=>{try{if(zn.value&&zn.value.itemId)await It.update(t.params.eventId,zn.value.itemId,z);else{const oe=await It.create(t.params.eventId,z);oe.data.count&&oe.data.count>1&&(J.value="Checklist Items Created",ke.value=`Successfully created ${oe.data.count} checklist items.`,R.value=!0)}await le(),_o()}catch(oe){console.error("Failed to save checklist item:",oe);const Ie=oe.response?.data?.message||"Failed to save checklist item. Please try again.";alert(Ie)}},Cs=async z=>{f("Delete checklist item","Are you sure you want to delete this checklist item?",async()=>{try{await It.delete(t.params.eventId,z),await le(),_o()}catch(oe){console.error("Failed to delete checklist item:",oe),alert(oe.response?.data?.message||"Failed to delete checklist item. Please try again.")}})},_o=()=>{jo.value=!1,zn.value=null,B.value=!1},Ni=()=>{ln.value=null,ks.value="details",B.value=!1,Xt.value=!0},Ls=z=>{ln.value=z,ks.value="details",B.value=!1,Xt.value=!0},Fi=async z=>{try{ln.value&&ln.value.noteId?await Eo.update(t.params.eventId,ln.value.noteId,z):await Eo.create(t.params.eventId,z),await be(),Xo()}catch(oe){console.error("Failed to save note:",oe);const Ie=oe.response?.data?.message||"Failed to save note. Please try again.";alert(Ie)}},zi=async z=>{f("Delete note","Are you sure you want to delete this note?",async()=>{try{await Eo.delete(t.params.eventId,z),await be(),Xo()}catch(oe){console.error("Failed to delete note:",oe),alert(oe.response?.data?.message||"Failed to delete note. Please try again.")}})},Xo=()=>{Xt.value=!1,ln.value=null,B.value=!1},Ui=()=>{qe.value=null,to.value="details",vo.value=null,B.value=!1,Hn.value=!0},Hi=z=>{qe.value=z,to.value="details",B.value=!1,Hn.value=!0},ni=async z=>{try{qe.value&&qe.value.contactId?await gi.update(t.params.eventId,qe.value.contactId,z):await gi.create(t.params.eventId,z),await Pe(),Ss()}catch(oe){console.error("Failed to save contact:",oe);const Ie=oe.response?.data?.message||"Failed to save contact. Please try again.";alert(Ie)}},qa=async z=>{f("Delete contact","Are you sure you want to delete this contact?",async()=>{try{await gi.delete(t.params.eventId,z),await Pe(),Ss()}catch(oe){console.error("Failed to delete contact:",oe),alert(oe.response?.data?.message||"Failed to delete contact. Please try again.")}})},Ss=()=>{Hn.value=!1,qe.value=null,vo.value=null,B.value=!1},Ll=z=>{if(ot.value=z,Fe.value=!1,A.value){const oe=A.value.getMapCenter(),Ie=A.value.getMapZoom();oe&&Ie!==null&&(wn.value=oe,$n.value=Ie)}_t.value=!0,rt.value="draw-area",Qe.value=!0,At.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},it=z=>{ot.value?H.value={...H.value||{},...ot.value,polygon:z}:H.value={...H.value,polygon:z}},Mn=z=>{Jt.value=z},bt=()=>{Qe.value=!1,ot.value&&(H.value=ot.value,Fe.value=!0,ot.value=null)},oi=async()=>{try{const z=await ic.getAdmins(t.params.eventId);ce.value=z.data}catch(z){console.error("Failed to load event admins:",z)}},Vi=async z=>{try{await ic.addAdmin(t.params.eventId,z),await oi(),si()}catch(oe){console.error("Failed to add admin:",oe),alert(oe.response?.data?.message||"Failed to add administrator. Please try again.")}},Zi=async z=>{f("Remove Administrator",`Remove ${z} as an administrator?`,async()=>{try{await ic.removeAdmin(t.params.eventId,z),await oi()}catch(oe){console.error("Failed to remove admin:",oe),alert(oe.response?.data?.message||"Failed to remove administrator. Please try again.")}})},si=()=>{ge.value=!1,B.value=!1},ko=async z=>{if(!z){Be.value="Please select a GPX file";return}ve.value=!0,Be.value=null;try{await Rs.uploadGpx(t.params.eventId,z),await st(),ii()}catch(oe){console.error("Failed to upload route:",oe),Be.value=oe.response?.data?.message||"Failed to upload route. Please try again."}finally{ve.value=!1}},ii=()=>{re.value=!1,Be.value=null},xs=async({file:z,deleteExisting:oe})=>{if(!z){j.value="Please select a CSV file";return}fe.value=!0,j.value=null,ue.value=null;try{const Ie=await yn.importCsv(t.params.eventId,z,oe);ue.value=Ie.data,await Pt(),Ut();const $e=Ie.data;let ht=`<p>Created <strong>${$e.locationsCreated}</strong> location(s) and <strong>${$e.assignmentsCreated}</strong> assignment(s)</p>`;$e.errors&&$e.errors.length>0&&(ht+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',$e.errors.forEach(Qt=>{ht+=`<li>${Qt}</li>`}),ht+="</ul>"),J.value="Import Complete",ke.value=ht,R.value=!0}catch(Ie){console.error("Failed to import locations:",Ie),j.value=Ie.response?.data?.message||"Failed to import locations. Please try again."}finally{fe.value=!1}},Ut=()=>{He.value=!1,j.value=null,ue.value=null},bo=async z=>{if(C.value)te.value.latitude=z.lat,te.value.longitude=z.lng;else if(X.value)we.value.latitude=z.lat,we.value.longitude=z.lng,x.value&&(x.value={...x.value,latitude:z.lat,longitude:z.lng}),X.value=!1,pe.value=!0,Et();else if($t.value)try{await i.createLocation({eventId:t.params.eventId,name:`Checkpoint ${Mt.value}`,description:"",latitude:z.lat,longitude:z.lng,requiredMarshals:1,what3Words:""}),Mt.value++,await Zt()}catch(oe){console.error("Failed to create checkpoint:",oe),alert("Failed to create checkpoint. Please try again.")}},Ga=z=>{rt.value==="place-checkpoint"||rt.value==="move-checkpoint"?kt.value=z:rt.value==="add-multiple"&&pt(z)},Ka=z=>{te.value={...z}},Sl=()=>{C.value=!1,kt.value=null,_t.value=!0,rt.value="place-checkpoint",At.value={title:"Select checkpoint location",description:"Click on the map to set the location. Click again to reposition."}},Ya=()=>{if(A.value){const z=A.value.getMapCenter(),oe=A.value.getMapZoom();z&&oe!==null&&(wn.value=z,$n.value=oe)}te.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},kt.value=null,_t.value=!0,rt.value="place-checkpoint",At.value={title:"Select checkpoint location",description:"Click on the map to set the location. Click again to reposition."}},ji=()=>{if(A.value){const z=A.value.getMapCenter(),oe=A.value.getMapZoom();z&&oe!==null&&(wn.value=z,$n.value=oe)}H.value={id:null,name:"",description:"",color:"#667eea",polygon:[],checkpointIds:[],marshalIds:[],displayOrder:Y.value.length},_t.value=!0,rt.value="draw-area",Qe.value=!0,At.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},xl=()=>{x.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},we.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},U.value=[],Q.value=[],B.value=!1,pe.value=!0},Ja=()=>{const z=M.value.map(oe=>{const Ie=oe.name.match(/^Checkpoint (\d+)$/);return Ie?parseInt(Ie[1]):0}).filter(oe=>oe>0);if(Mt.value=z.length>0?Math.max(...z)+1:1,A.value){const oe=A.value.getMapCenter(),Ie=A.value.getMapZoom();oe&&Ie!==null&&(wn.value=oe,$n.value=Ie)}_t.value=!0,rt.value="add-multiple",$t.value=!0,At.value={title:"Add multiple checkpoints",description:`Click on map to add checkpoints. Next: Checkpoint ${Mt.value}`}},pt=z=>{eo.value.push({id:`temp-${Mt.value}`,name:`Checkpoint ${Mt.value}`,description:"",latitude:z.lat,longitude:z.lng,requiredMarshals:1,what3Words:"",assignments:[],isTemporary:!0}),Mt.value++,At.value={...At.value,description:`Click on map to add checkpoints. Next: Checkpoint ${Mt.value}`}},Tl=()=>{if(rt.value==="place-checkpoint"){const z=kt.value||{lat:0,lng:0};x.value={id:null,name:"",description:"",latitude:z.lat,longitude:z.lng,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},we.value={id:null,name:"",description:"",latitude:z.lat,longitude:z.lng,requiredMarshals:1,what3Words:""},U.value=[],Q.value=[],B.value=!1,Qo(),pe.value=!0}else if(rt.value==="move-checkpoint")kt.value&&(we.value.latitude=kt.value.lat,we.value.longitude=kt.value.lng,x.value&&(x.value={...x.value,...Fn.value||{},latitude:kt.value.lat,longitude:kt.value.lng}),Et()),Fn.value=null,Qo(),pe.value=!0;else if(rt.value==="draw-area"){if(Jt.value&&Jt.value.length>=3){const z=Jt.value.map(oe=>({lat:oe.lat,lng:oe.lng}));ot.value?H.value={...H.value||{},...ot.value,polygon:z}:H.value={...H.value||{},polygon:z}}Qe.value=!1,Qo(),Fe.value=!0,ot.value=null,Jt.value=null}else rt.value==="add-multiple"&&Ln()},Ln=async()=>{const z=[...eo.value];try{for(const oe of z)await i.createLocation({eventId:t.params.eventId,name:oe.name,description:oe.description,latitude:oe.latitude,longitude:oe.longitude,requiredMarshals:oe.requiredMarshals,what3Words:oe.what3Words});eo.value=[],$t.value=!1,Qo(),await Zt()}catch(oe){console.error("Failed to create checkpoints:",oe),alert("Failed to create checkpoints. Please try again.")}},Ts=()=>{rt.value==="draw-area"?(ot.value&&(H.value=ot.value,Fe.value=!0,ot.value=null),Qe.value=!1,Jt.value=null):rt.value==="move-checkpoint"?(Fn.value&&x.value&&Object.assign(x.value,Fn.value),pe.value=!0,X.value=!1):rt.value==="add-multiple"&&(eo.value=[],$t.value=!1),Qo()},Qo=()=>{_t.value=!1,rt.value=null,At.value={},kt.value=null,wn.value=null,$n.value=null,Qe.value&&(Qe.value=!1)},Il=z=>{es(z)},es=z=>{x.value=z,we.value={id:z.id,name:z.name,description:z.description||"",latitude:z.latitude,longitude:z.longitude,requiredMarshals:z.requiredMarshals,what3Words:z.what3Words||""},U.value=[],Q.value=[],B.value=!1,pe.value=!0,setTimeout(()=>{A.value?.scrollMapIntoView()},100)},$l=async z=>{if(!Wr(z.what3Words)){alert("Invalid What3Words format. Please use word.word.word or word/word/word (lowercase letters only, 1-20 characters each)");return}try{await i.createLocation({eventId:t.params.eventId,...z}),await Zt(),Wi()}catch(oe){console.error("Failed to save location:",oe),alert("Failed to save location. Please try again.")}},Wi=()=>{C.value=!1,te.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},B.value=!1,B.value=!1},qi=()=>{pe.value=!1,x.value=null,X.value=!1,De.value=!1,Fn.value=null,we.value={id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},U.value=[],Q.value=[],B.value=!1},Gi=()=>{De.value=!1},Ki=()=>{De.value=!0},Ml=z=>{if(z?.formData&&(Fn.value=z.formData),pe.value=!1,kt.value=null,A.value){const Ie=A.value.getMapCenter(),$e=A.value.getMapZoom();Ie&&$e!==null&&(wn.value=Ie,$n.value=$e)}const oe=Fn.value?.name||x.value?.name;_t.value=!0,rt.value="move-checkpoint",At.value={title:`Move ${S.value.checkpoint}: ${oe}`,description:"Click on the map to set the new location"}},An=async z=>{if(!Wr(z.what3Words)){alert("Invalid What3Words format.");return}try{const oe=!x.value.id;if(oe){const Ie=await i.createLocation({eventId:t.params.eventId,name:z.name,description:z.description,latitude:z.latitude,longitude:z.longitude,requiredMarshals:z.requiredMarshals,what3Words:z.what3Words||null,startTime:z.startTime,endTime:z.endTime,styleType:z.styleType,styleColor:z.styleColor,styleBackgroundShape:z.styleBackgroundShape,styleBackgroundColor:z.styleBackgroundColor,styleBorderColor:z.styleBorderColor,styleIconColor:z.styleIconColor,styleSize:z.styleSize,styleMapRotation:z.styleMapRotation!=null?String(z.styleMapRotation):null,peopleTerm:z.peopleTerm,checkpointTerm:z.checkpointTerm,isDynamic:z.isDynamic||!1,locationUpdateScopeConfigurations:z.locationUpdateScopeConfigurations||[],pendingNewChecklistItems:z.pendingNewChecklistItems||[],pendingNewNotes:z.pendingNewNotes||[]});if(z.pendingAssignments&&z.pendingAssignments.length>0)for(const $e of z.pendingAssignments)await i.createAssignment({eventId:t.params.eventId,locationId:Ie.id,marshalId:$e.marshalId})}else{const Ie=x.value.id;if(await yn.update(t.params.eventId,Ie,{eventId:t.params.eventId,name:z.name,description:z.description,latitude:z.latitude,longitude:z.longitude,requiredMarshals:z.requiredMarshals,what3Words:z.what3Words||null,startTime:z.startTime,endTime:z.endTime,styleType:z.styleType,styleColor:z.styleColor,styleBackgroundShape:z.styleBackgroundShape,styleBackgroundColor:z.styleBackgroundColor,styleBorderColor:z.styleBorderColor,styleIconColor:z.styleIconColor,styleSize:z.styleSize,styleMapRotation:z.styleMapRotation!=null?String(z.styleMapRotation):null,peopleTerm:z.peopleTerm,checkpointTerm:z.checkpointTerm,isDynamic:z.isDynamic||!1,locationUpdateScopeConfigurations:z.locationUpdateScopeConfigurations||[]}),z.pendingNewChecklistItems&&z.pendingNewChecklistItems.length>0)for(const $e of z.pendingNewChecklistItems)$e.text?.trim()&&await It.create(t.params.eventId,{text:$e.text,scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[Ie]}],displayOrder:0,isRequired:!1});if(z.pendingNewNotes&&z.pendingNewNotes.length>0)for(const $e of z.pendingNewNotes)!$e.title?.trim()&&!$e.content?.trim()||await Eo.create(t.params.eventId,{title:$e.title||"Untitled",content:$e.content||"",scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[Ie]}],displayOrder:0,priority:"Normal",isPinned:!1});for(const $e of Q.value)await i.deleteAssignment(t.params.eventId,$e);for(const $e of U.value)await i.createAssignment({eventId:t.params.eventId,locationId:x.value.id,marshalId:$e.marshalId});if(z.checkInChanges&&z.checkInChanges.length>0)for(const $e of z.checkInChanges){const ht=x.value.assignments.find(Qt=>Qt.id===$e.assignmentId);ht&&ht.isCheckedIn!==$e.shouldBeCheckedIn&&await Bo.adminCheckIn(t.params.eventId,$e.assignmentId)}}if(!oe&&z.checklistChanges&&z.checklistChanges.length>0)for(const Ie of z.checklistChanges)try{Ie.complete?await It.complete(t.params.eventId,Ie.itemId,{marshalId:Ie.marshalId,contextType:Ie.contextType,contextId:Ie.contextId}):await It.uncomplete(t.params.eventId,Ie.itemId,{marshalId:Ie.marshalId,contextType:Ie.contextType,contextId:Ie.contextId})}catch($e){console.error("Failed to update checklist item:",Ie,$e)}await Zt(),qi()}catch(oe){console.error("Failed to update location:",oe),alert("Failed to update location. Please try again.")}},Al=async z=>{f("Delete location","Are you sure you want to delete this location?",async()=>{try{await yn.delete(t.params.eventId,z),await Pt(),qi()}catch(oe){console.error("Failed to delete location:",oe),alert("Failed to delete location. Please try again.")}})},Xa=z=>{const oe=z?.id??z;if(oe?.toString().startsWith("temp-")){const Ie=x.value.assignments.find($e=>$e.id===oe);Ie&&(U.value=U.value.filter($e=>$e.marshalId!==Ie.marshalId)),x.value.assignments=x.value.assignments.filter($e=>$e.id!==oe),Et()}else Q.value.includes(oe)||(Q.value.push(oe),x.value.assignments=x.value.assignments.filter(Ie=>Ie.id!==oe),Et())},oo=async z=>{const oe=me.value.find($e=>$e.id===z);if(!oe)return;const Ie=M.value.filter($e=>$e.assignments?.some(ht=>ht.marshalId===z&&$e.id!==x.value.id));if(Ie.length>0){Ee.value={marshalName:oe.name,locations:Ie.map(ht=>ht.name),marshal:oe};const $e=await new Promise(ht=>{se.value=ht,Se.value=!0});if($e==="cancel"||$e==="choose-other")return;if($e==="move")for(const ht of Ie){const Qt=ht.assignments.find(En=>En.marshalId===z);if(Qt){Q.value.push(Qt.id);const En=M.value.findIndex($s=>$s.id===ht.id);En!==-1&&(M.value[En].assignments=M.value[En].assignments.filter($s=>$s.id!==Qt.id))}}}U.value.push({marshalId:oe.id,marshalName:oe.name}),x.value.assignments||(x.value.assignments=[]),x.value.assignments.push({id:`temp-${Date.now()}`,marshalId:oe.id,marshalName:oe.name,locationId:x.value.id,isCheckedIn:!1,isPending:!0}),Et(),Gi()},Qa=async z=>{try{const Ie=(await co.create({eventId:t.params.eventId,name:z.name,email:z.email,phoneNumber:z.phoneNumber})).data;await G(),U.value.push({marshalId:Ie.id,marshalName:Ie.name}),x.value&&(x.value.assignments||(x.value.assignments=[]),x.value.assignments.push({id:`temp-${Date.now()}`,marshalId:Ie.id,marshalName:Ie.name,locationId:x.value.id,isCheckedIn:!1,isPending:!0})),Et(),Gi()}catch(oe){console.error("Failed to create marshal:",oe),alert("Failed to create marshal. Please try again.")}},er=()=>{de.value=null,Le.value={id:"",name:"",email:"",phoneNumber:"",notes:""},Z.value=[],N.value=[],B.value=!1,ne.value=!0},Yi=z=>{de.value=z,Le.value={id:z.id,name:z.name,email:z.email||"",phoneNumber:z.phoneNumber||"",notes:z.notes||""},Z.value=[],N.value=[],B.value=!1,ne.value=!0},tr=()=>{if(!de.value)return[];const z=[];return M.value.forEach(oe=>{oe.assignments.filter($e=>$e.marshalName===de.value.name).forEach($e=>{z.push({...$e,locationName:oe.name})})}),z},nr=async z=>{try{let oe=de.value?.id,Ie=!1;if(de.value){if(await co.update(t.params.eventId,de.value.id,{name:z.name,email:z.email,phoneNumber:z.phoneNumber,notes:z.notes}),z.pendingNewChecklistItems&&z.pendingNewChecklistItems.length>0)for(const $e of z.pendingNewChecklistItems)$e.text?.trim()&&await It.create(t.params.eventId,{text:$e.text,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[oe]}],displayOrder:0,isRequired:!1});if(z.pendingNewNotes&&z.pendingNewNotes.length>0)for(const $e of z.pendingNewNotes)!$e.title?.trim()&&!$e.content?.trim()||await Eo.create(t.params.eventId,{title:$e.title||"Untitled",content:$e.content||"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[oe]}],displayOrder:0,priority:"Normal",isPinned:!1})}else oe=(await co.create({eventId:t.params.eventId,name:z.name,email:z.email,phoneNumber:z.phoneNumber,notes:z.notes,pendingNewChecklistItems:z.pendingNewChecklistItems||[],pendingNewNotes:z.pendingNewNotes||[]})).data.id,Ie=!0;for(const $e of N.value)await i.deleteAssignment(t.params.eventId,$e);for(const $e of Z.value)await i.createAssignment({eventId:t.params.eventId,locationId:$e.locationId,marshalId:oe});if(z.pendingAssignments&&z.pendingAssignments.length>0)for(const $e of z.pendingAssignments)await i.createAssignment({eventId:t.params.eventId,locationId:$e.locationId,marshalId:oe});if(z.checkInChanges&&z.checkInChanges.length>0){const $e=tr();for(const ht of z.checkInChanges){const Qt=$e.find(En=>En.id===ht.assignmentId);Qt&&Qt.isCheckedIn!==ht.shouldBeCheckedIn&&await Bo.adminCheckIn(t.params.eventId,ht.assignmentId)}}if(z.checklistChanges&&z.checklistChanges.length>0)for(const $e of z.checklistChanges)try{const ht={marshalId:oe};$e.contextType&&$e.contextId&&(ht.contextType=$e.contextType,ht.contextId=$e.contextId),$e.complete?await It.complete(t.params.eventId,$e.itemId,ht):await It.uncomplete(t.params.eventId,$e.itemId,ht)}catch(ht){console.error("Failed to process checklist change:",ht);const Qt=ht.response?.data?.message||"Failed to update checklist item";alert(`Error: ${Qt}`)}await Zt(),Qi(),Ie&&(E.value=oe,ie.value=z.name,$.value=!0)}catch(oe){console.error("Failed to save marshal:",oe),alert("Failed to save marshal. Please try again.")}},Ji=async z=>{const oe=z||de.value?.id;if(!oe){console.error("No marshal ID to delete");return}const Ie=S.value.person;f(`Delete ${Ie}`,`Are you sure you want to delete this ${Ie}?`,async()=>{try{await co.delete(t.params.eventId,oe),await Ct(),Qi()}catch($e){console.error(`Failed to delete ${Ie}:`,$e),alert(`Failed to delete ${Ie}. Please try again.`)}})},El=z=>{Ji(z.id)},Pl=z=>{N.value.includes(z)||(N.value.push(z),Et())},Xi=z=>{Z.value.push({locationId:z}),Et()},Qi=()=>{ne.value=!1,de.value=null,Le.value={id:"",name:"",email:"",phoneNumber:"",notes:""},Z.value=[],N.value=[],B.value=!1},or=async({file:z})=>{if(!z){j.value="Please select a CSV file";return}q.value=!0,j.value=null,K.value=null;try{const oe=await co.importCsv(t.params.eventId,z);K.value=oe.data,await Ct(),ea();const Ie=oe.data;let $e=`<p>Created <strong>${Ie.marshalsCreated}</strong> marshal(s) and <strong>${Ie.assignmentsCreated}</strong> assignment(s)</p>`;Ie.errors&&Ie.errors.length>0&&($e+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',Ie.errors.forEach(ht=>{$e+=`<li>${ht}</li>`}),$e+="</ul>"),J.value="Import Complete",ke.value=$e,R.value=!0}catch(oe){console.error("Failed to import marshals:",oe),j.value=oe.response?.data?.message||"Failed to import marshals. Please try again."}finally{q.value=!1}},ea=()=>{Oe.value=!1,j.value=null,K.value=null},ai=z=>{se.value&&(se.value(z),se.value=null),Se.value=!1},wo=async({assignment:z,status:oe})=>{try{if(oe==="not-checked-in"?z.isCheckedIn&&await Bo.adminCheckIn(t.params.eventId,z.id):z.isCheckedIn||await Bo.adminCheckIn(t.params.eventId,z.id),await ws(),x.value){const Ie=M.value.find($e=>$e.id===x.value.id);Ie&&(x.value=Ie)}}catch(Ie){console.error("Failed to change assignment status:",Ie),alert("Failed to change status. Please try again.")}};let Is=null;const ts=async()=>{try{const z=t.params.eventId,oe=await yn.getDynamicCheckpoints(z);if(oe.data&&Array.isArray(oe.data))for(const Ie of oe.data){const $e=M.value.find(ht=>ht.id===Ie.checkpointId);$e&&($e.latitude=Ie.latitude,$e.longitude=Ie.longitude,$e.lastLocationUpdate=Ie.lastLocationUpdate)}}catch(z){console.warn("Failed to poll dynamic checkpoints:",z)}},cn=()=>{Is||!M.value.some(oe=>oe.isDynamic||oe.IsDynamic)||(ts(),Is=setInterval(ts,6e4))},ta=()=>{Is&&(clearInterval(Is),Is=null)};return Ke(s,z=>{z==="course"?cn():ta()}),rn(async()=>{await Zt();try{const z=await uo.getMe(t.params.eventId);no.value=z.data}catch(z){console.warn("Failed to fetch user claims:",z)}s.value==="course"&&cn()}),fo(()=>{ta()}),(z,oe)=>(m(),y("div",D3,[c("header",O3,[c("div",R3,[c("button",{onClick:bs,class:"btn-back",title:"Back to Dashboard"}," Dashboard"),_.value?(m(),y("div",B3,[c("h1",null,w(_.value.name),1),c("p",N3,w(V(Mb)(_.value.eventDate)),1)])):F("",!0)]),c("div",F3,[qo.value?(m(),y("button",{key:0,onClick:Ks,class:"btn btn-marshal-mode"}," Switch to Marshal ")):F("",!0),c("button",{onClick:Yo,class:"btn btn-secondary"},"Profile")])]),c("div",z3,[c("div",U3,[Ve(bS,{tabs:T.value,"model-value":V(s),"onUpdate:modelValue":V(a)},null,8,["tabs","model-value","onUpdate:modelValue"])]),c("div",H3,[V(s)==="course"?(m(),at(bw,{key:0,ref_key:"courseAreasTab",ref:A,checkpoints:M.value,areas:Y.value,route:_.value?.route||[],"selected-area-id":Je.value,"drawing-mode":Qe.value,onMapClick:bo,onLocationClick:Il,onAreaClick:Tt,onImportCheckpoints:oe[0]||(oe[0]=Ie=>He.value=!0),onUploadRoute:oe[1]||(oe[1]=Ie=>re.value=!0),onSelectLocation:es,onAddArea:ct,onSelectArea:Tt,onPolygonComplete:it,onCancelDrawing:bt,onAddCheckpointFromMap:Ya,onAddManyCheckpointsFromMap:Ja,onAddAreaFromMap:ji},null,8,["checkpoints","areas","route","selected-area-id","drawing-mode"])):F("",!0),V(s)==="checkpoints"?(m(),y("div",V3,[Ve(Y2,{locations:M.value,areas:Y.value,onAddCheckpointManually:xl,onImportCheckpoints:oe[2]||(oe[2]=Ie=>He.value=!0),onSelectLocation:es},null,8,["locations","areas"])])):F("",!0),V(s)==="areas"?(m(),y("div",Z3,[Ve(cS,{areas:Y.value,checkpoints:M.value,"event-people-term":_.value?.peopleTerm||"Marshals","event-checkpoint-term":_.value?.checkpointTerm||"Checkpoints",onAddArea:ct,onSelectArea:Tt},null,8,["areas","checkpoints","event-people-term","event-checkpoint-term"])])):F("",!0),V(s)==="marshals"?(m(),at(jw,{key:3,marshals:me.value,assignments:Go.value,locations:M.value,onAddMarshal:er,onImportMarshals:oe[3]||(oe[3]=Ie=>Oe.value=!0),onSelectMarshal:Yi,onDeleteMarshal:El,onChangeAssignmentStatus:wo},null,8,["marshals","assignments","locations"])):F("",!0),V(s)==="checklists"?(m(),at(L0,{key:4,"checklist-items":po.value,areas:Y.value,locations:M.value,marshals:me.value,"completion-report":Gs.value,onAddChecklistItem:go,onSelectChecklistItem:Ot},null,8,["checklist-items","areas","locations","marshals","completion-report"])):F("",!0),V(s)==="notes"?(m(),at(Y0,{key:5,notes:Un.value,areas:Y.value,locations:M.value,marshals:me.value,onAddNote:Ni,onSelectNote:Ls},null,8,["notes","areas","locations","marshals"])):F("",!0),V(s)==="contacts"?(m(),at(kC,{key:6,contacts:Wo.value,areas:Y.value,locations:M.value,marshals:me.value,"available-roles":Kt.value,onAddContact:Ui,onSelectContact:Hi},null,8,["contacts","areas","locations","marshals","available-roles"])):F("",!0),V(s)==="details"?(m(),at(EC,{key:7,"event-data":xe.value,"form-dirty":Ce.value,onSubmit:Xs,"onUpdate:formDirty":Js},null,8,["event-data","form-dirty"])):F("",!0),V(s)==="settings"?(m(),at(D2,{key:8,"event-data":xe.value,"event-id":V(t).params.eventId,admins:ce.value,"form-dirty":Ce.value,onSubmit:Xs,onAddAdmin:oe[4]||(oe[4]=Ie=>ge.value=!0),onRemoveAdmin:Zi,"onUpdate:formDirty":Js},null,8,["event-data","event-id","admins","form-dirty"])):F("",!0)])]),Ve(P3,{show:C.value,location:te.value,"is-dirty":B.value,onClose:Wi,onSave:$l,onSetOnMap:Sl,"onUpdate:isDirty":Et,"onUpdate:location":Ka},null,8,["show","location","is-dirty"]),Ve(mM,{show:pe.value,location:x.value,assignments:x.value?.assignments||[],"event-date":_.value?.eventDate||"",areas:Y.value,"event-id":V(t).params.eventId,"all-locations":M.value,notes:Un.value,"available-marshals":Ys.value,"all-checklist-items":po.value,"is-dirty":B.value,"event-default-style-type":_.value?.defaultCheckpointStyleType||_.value?.DefaultCheckpointStyleType||"default","event-default-style-color":_.value?.defaultCheckpointStyleColor||_.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":_.value?.defaultCheckpointStyleBackgroundShape||_.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":_.value?.defaultCheckpointStyleBackgroundColor||_.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":_.value?.defaultCheckpointStyleBorderColor||_.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":_.value?.defaultCheckpointStyleIconColor||_.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":_.value?.defaultCheckpointStyleSize||_.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":_.value?.defaultCheckpointStyleMapRotation??_.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":_.value?.peopleTerm||"Marshals","z-index":Fe.value?1100:1e3,onClose:qi,onSave:An,onDelete:Al,onMoveLocation:Ml,onRemoveAssignment:Xa,onOpenAssignModal:Ki,"onUpdate:isDirty":Et},null,8,["show","location","assignments","event-date","areas","event-id","all-locations","notes","available-marshals","all-checklist-items","is-dirty","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","z-index"]),Ve(SS,{show:I.value,link:Cn.value,"is-dirty":!1,onClose:oe[5]||(oe[5]=Ie=>I.value=!1)},null,8,["show","link"]),Ve(FS,{show:$.value,"event-id":V(t).params.eventId,"marshal-id":E.value,"marshal-name":ie.value,onClose:oe[6]||(oe[6]=Ie=>$.value=!1)},null,8,["show","event-id","marshal-id","marshal-name"]),Ve(HS,{show:ge.value,"is-dirty":B.value,onClose:si,onSubmit:Vi,"onUpdate:isDirty":Et},null,8,["show","is-dirty"]),Ve(qS,{show:re.value,uploading:ve.value,error:Be.value,"is-dirty":B.value,onClose:ii,onSubmit:ko,"onUpdate:isDirty":Et},null,8,["show","uploading","error","is-dirty"]),Ve(ox,{show:He.value,importing:fe.value,error:j.value,result:ue.value,"is-dirty":B.value,onClose:Ut,onSubmit:xs,"onUpdate:isDirty":Et},null,8,["show","importing","error","result","is-dirty"]),Ve(_E,{show:ne.value,marshal:de.value,"event-id":V(t).params.eventId,assignments:tr(),"available-locations":Di.value,"all-locations":M.value,areas:Y.value,"is-editing":!!de.value,"event-notes":Un.value,"all-checklist-items":po.value,"is-dirty":B.value,onClose:Qi,onSave:nr,onDelete:Ji,onRemoveAssignment:Pl,onAssignToLocation:Xi,"onUpdate:isDirty":Et},null,8,["show","marshal","event-id","assignments","available-locations","all-locations","areas","is-editing","event-notes","all-checklist-items","is-dirty"]),Ve(dx,{show:Oe.value,importing:q.value,error:j.value,result:K.value,"is-dirty":B.value,onClose:ea,onSubmit:or,"onUpdate:isDirty":Et},null,8,["show","importing","error","result","is-dirty"]),Ve(CE,{show:Se.value,"conflict-data":Ee.value,onClose:oe[7]||(oe[7]=Ie=>Se.value=!1),onChoice:ai},null,8,["show","conflict-data"]),Ve(PE,{show:De.value,"location-name":x.value?.name||"",marshals:Ys.value,onClose:Gi,onAssignExisting:oo,onCreateAndAssign:Qa},null,8,["show","location-name","marshals"]),Ve(jE,{show:ze.value,"old-event-date":Re.value,"new-event-date":je.value,"affected-checkpoints-count":Ye.value,onConfirm:mo,onCancel:Jo},null,8,["show","old-event-date","new-event-date","affected-checkpoints-count"]),Ve(p4,{show:Fe.value,area:H.value,checkpoints:M.value,marshals:me.value,areas:Y.value,"is-dirty":B.value,"event-id":V(t).params.eventId,"all-locations":M.value,assignments:Go.value,notes:Un.value,contacts:Wo.value,"event-default-style-type":_.value?.defaultCheckpointStyleType||_.value?.DefaultCheckpointStyleType||"default","event-default-style-color":_.value?.defaultCheckpointStyleColor||_.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":_.value?.defaultCheckpointStyleBackgroundShape||_.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":_.value?.defaultCheckpointStyleBackgroundColor||_.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":_.value?.defaultCheckpointStyleBorderColor||_.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":_.value?.defaultCheckpointStyleIconColor||_.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":_.value?.defaultCheckpointStyleSize||_.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":_.value?.defaultCheckpointStyleMapRotation??_.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":_.value?.peopleTerm||"Marshals","event-checkpoint-term":_.value?.checkpointTerm||"Checkpoints",onClose:jt,onSave:Bi,onDelete:ei,onDrawBoundary:Ll,"onUpdate:isDirty":Et,onSelectCheckpoint:es,onAddAreaContact:Cl,onEditContact:ti},null,8,["show","area","checkpoints","marshals","areas","is-dirty","event-id","all-locations","assignments","notes","contacts","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","event-checkpoint-term"]),Ve(S4,{show:jo.value,"checklist-item":zn.value,"initial-tab":_s.value,areas:Y.value,locations:M.value,marshals:me.value,"is-dirty":B.value,onClose:_o,onSave:yo,onDelete:Cs,"onUpdate:isDirty":Et},null,8,["show","checklist-item","initial-tab","areas","locations","marshals","is-dirty"]),Ve(z4,{show:Xt.value,note:ln.value,"initial-tab":ks.value,areas:Y.value,locations:M.value,marshals:me.value,"is-dirty":B.value,onClose:Xo,onSave:Fi,onDelete:zi,"onUpdate:isDirty":Et},null,8,["show","note","initial-tab","areas","locations","marshals","is-dirty"]),Ve(l3,{show:Hn.value,contact:qe.value,"initial-tab":to.value,areas:Y.value,locations:M.value,marshals:me.value,"available-roles":Kt.value,"is-dirty":B.value,"preselected-area":vo.value,onClose:Ss,onSave:ni,onDelete:qa,"onUpdate:isDirty":Et},null,8,["show","contact","initial-tab","areas","locations","marshals","available-roles","is-dirty","preselected-area"]),Ve(w3,{show:_t.value,mode:rt.value,"context-title":At.value.title,"context-description":At.value.description,"can-complete":Oi.value,clickable:rt.value!=="draw-area","drawing-mode":rt.value==="draw-area"&&Qe.value,locations:Ri.value,areas:Ko.value,route:_.value?.route||[],"selected-area-id":Je.value,center:wn.value,zoom:$n.value,onMapClick:Ga,onPolygonComplete:it,onPolygonDrawing:Mn,onDone:Tl,onCancel:Ts},null,8,["show","mode","context-title","context-description","can-complete","clickable","drawing-mode","locations","areas","route","selected-area-id","center","zoom"]),Ve(wl,{show:R.value,title:J.value,message:ke.value,onClose:oe[8]||(oe[8]=Ie=>R.value=!1)},null,8,["show","title","message"]),Ve(_l,{show:V(l),title:V(u),message:V(h),onConfirm:V(p),onCancel:V(g)},null,8,["show","title","message","onConfirm","onCancel"])]))}},W3=Xe(j3,[["__scopeId","data-v-ec3544c3"]]),q3={key:0,class:"emergency-notes-section"},G3={class:"emergency-notes-list"},K3={class:"note-header"},Y3={key:0,class:"note-content"},J3={key:1,class:"emergency-contacts-section"},X3={class:"emergency-contacts-list"},Q3={class:"contact-header"},eD={key:0,class:"role-badge"},tD={class:"contact-details"},nD={key:0,class:"info-section"},oD=["href"],sD={key:1,class:"info-section"},iD=["href"],aD={key:2,class:"info-section"},rD=["href"],lD={key:2,class:"no-contacts"},cD={__name:"EmergencyContactModal",props:{show:{type:Boolean,default:!1},contacts:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const o=e,i=t,s=ae(()=>o.notes?[...o.notes].sort((u,h)=>{const f=u.priority||u.Priority,p=h.priority||h.Priority;return f==="Emergency"&&p!=="Emergency"?-1:p==="Emergency"&&f!=="Emergency"?1:0}):[]),a=()=>{i("close")},l=u=>u?{EmergencyContact:"Emergency Contact",EventDirector:"Event Director",MedicalLead:"Medical Lead",SafetyOfficer:"Safety Officer",Logistics:"Logistics"}[u]||u.replace(/([A-Z])/g," $1").trim():"";return(u,h)=>(m(),at(zt,{show:e.show,title:"Emergency information",size:"medium",onClose:a},{actions:tt(()=>[c("button",{onClick:a,class:"btn btn-secondary"},"Close")]),default:tt(()=>[e.notes&&e.notes.length>0?(m(),y("div",q3,[h[0]||(h[0]=c("h2",{class:"section-header"},"Emergency notes",-1)),c("div",G3,[(m(!0),y(Te,null,Ne(s.value,f=>(m(),y("div",{key:f.noteId||f.NoteId,class:Ae(["emergency-note-item",{"is-emergency":(f.priority||f.Priority)==="Emergency"}])},[c("div",K3,[c("h3",null,w(f.title||f.Title),1),c("span",{class:Ae(["priority-badge",(f.priority||f.Priority).toLowerCase()])},w(f.priority||f.Priority),3)]),f.content||f.Content?(m(),y("div",Y3,w(f.content||f.Content),1)):F("",!0)],2))),128))])])):F("",!0),e.contacts&&e.contacts.length>0?(m(),y("div",J3,[h[4]||(h[4]=c("h2",{class:"section-header"},"Emergency contacts",-1)),c("div",X3,[(m(!0),y(Te,null,Ne(e.contacts,f=>(m(),y("div",{key:f.contactId||f.name,class:"emergency-contact-item"},[c("div",Q3,[c("h3",null,w(f.name),1),f.role?(m(),y("span",eD,w(l(f.role)),1)):F("",!0)]),c("div",tD,[f.phone?(m(),y("div",nD,[h[1]||(h[1]=c("label",null,"Phone number",-1)),c("a",{href:`tel:${f.phone}`,class:"phone-link"},w(f.phone),9,oD)])):F("",!0),f.email?(m(),y("div",sD,[h[2]||(h[2]=c("label",null,"Email",-1)),c("a",{href:`mailto:${f.email}`,class:"email-link"},w(f.email),9,iD)])):F("",!0),f.notes||f.details?(m(),y("div",aD,[h[3]||(h[3]=c("label",null,"Details",-1)),c("p",null,w(f.notes||f.details),1)])):F("",!0)]),f.phone?(m(),y("a",{key:0,href:`tel:${f.phone}`,class:"btn btn-danger btn-full"}," Call "+w(f.name),9,rD)):F("",!0)]))),128))])])):F("",!0),(!e.contacts||e.contacts.length===0)&&(!e.notes||e.notes.length===0)?(m(),y("div",lD,[...h[5]||(h[5]=[c("p",null,"No emergency information has been set up for this event.",-1)])])):F("",!0)]),_:1},8,["show"]))}},uD=Xe(cD,[["__scopeId","data-v-3f42c790"]]),Cr=O(navigator.onLine),hs=O(!0),Us=O(0),Lr=O(null),Ns=O("idle"),Li=O(null);let vh=null,rc=!1,Wn=null;function dD(e=1e3,t=1e4){return Math.floor(Math.random()*(t-e+1))+e}function Rc(){Wn&&(clearTimeout(Wn),Wn=null);const e=dD(1e3,1e4);console.log(`Scheduling auto-sync in ${e}ms`),Wn=setTimeout(async()=>{if(Wn=null,!navigator.onLine){console.log("Auto-sync cancelled: offline");return}if(await jr()===0){console.log("Auto-sync cancelled: no pending actions");return}console.log("Starting auto-sync..."),await Gr();const o=await jr();o>0&&navigator.onLine&&(console.log(`${o} actions remaining, scheduling retry...`),Rc())},e)}async function ma(){if(!navigator.onLine)return hs.value=!1,!1;try{const e=new AbortController,t=setTimeout(()=>e.abort(),5e3),o=await fetch("/api/health",{method:"HEAD",signal:e.signal}).catch(()=>null);if(clearTimeout(t),!o||o.status===404)return hs.value=!0,!0;const i=o.ok;return hs.value=i,i}catch(e){return e.name==="AbortError"&&console.warn("Server health check timed out"),hs.value=!1,!1}}async function hD(e){try{switch(e.type){case"checkin":await Bo.checkIn(e.payload);break;case"checkin_admin":await Bo.adminCheckIn(e.payload.eventId,e.payload.assignmentId);break;case"checklist_complete":await It.complete(e.payload.eventId,e.payload.itemId,e.payload.data);break;case"checklist_uncomplete":await It.uncomplete(e.payload.eventId,e.payload.itemId,e.payload.data);break;default:return console.warn("Unknown action type:",e.type),!1}return!0}catch(t){return console.error("Failed to sync action:",e,t),t.response&&t.response.status>=400&&t.response.status<500?"permanent_failure":!1}}async function Gr(){if(!rc&&navigator.onLine){rc=!0,Ns.value="syncing",Li.value=null;try{const e=await Lp();if(e.length===0){Ns.value="success",Us.value=0;return}let t=0,o=0;for(const i of e){const s=await hD(i);if(s===!0)await ih(i.id),t++;else if(s==="permanent_failure")await ih(i.id),o++;else{const a=(i.attempts||0)+1;a>=5?(await sh(i.id,{status:"failed",attempts:a,lastAttempt:new Date().toISOString()}),o++):await sh(i.id,{status:"retrying",attempts:a,lastAttempt:new Date().toISOString()})}}Us.value=await jr(),o>0?(Ns.value="error",Li.value=`${o} action(s) failed to sync`):Ns.value="success"}catch(e){console.error("Sync error:",e),Ns.value="error",Li.value="Failed to sync pending actions"}finally{rc=!1}}}function fD(){vh||(vh=setInterval(async()=>{navigator.onLine&&(await ma(),hs.value&&Us.value>0&&await Gr())},3e4))}function du(){const e=ae(()=>Cr.value&&hs.value);async function t(){Us.value=await jr()}async function o(){Cr.value=!0,await ma()&&Us.value>0&&Rc()}function i(){Cr.value=!1,hs.value=!1,Wn&&(clearTimeout(Wn),Wn=null)}rn(async()=>{await Zo(),await t(),window.addEventListener("online",o),window.addEventListener("offline",i),navigator.onLine&&await ma()&&Us.value>0&&Rc(),fD()}),fo(()=>{window.removeEventListener("online",o),window.removeEventListener("offline",i),Wn&&(clearTimeout(Wn),Wn=null)});async function s(h,f){if(!e.value)return console.warn("Cannot refresh cache while offline"),!1;try{const p=await f();return await Oa(h,p),Lr.value=new Date().toISOString(),!0}catch(p){return console.error("Failed to refresh cache:",p),!1}}async function a(h){const f=await ps(h);return f&&(Lr.value=f.cachedAt),f}async function l(h){Lr.value=await H1(h)}async function u(){return navigator.onLine?await ma()?(await Gr(),Ns.value==="success"):(Li.value="Server is not responding",!1):(Li.value="Cannot sync while offline",!1)}return{isOnline:Cr,isServerHealthy:hs,isFullyOnline:e,pendingActionsCount:Us,lastSyncTime:Lr,syncStatus:Ns,syncError:Li,checkServerHealth:ma,syncPendingActions:Gr,updatePendingCount:t,refreshCache:s,getCachedData:a,loadLastSyncTime:l,forcSync:u}}const pD={class:"area-lead-content"},vD={key:0,class:"loading-state"},mD={key:1,class:"error-state"},gD={key:2,class:"empty-state"},yD={key:3,class:"checkpoint-accordion"},_D=["onClick"],kD={class:"checkpoint-header-content"},bD={class:"checkpoint-title-row"},wD={class:"checkpoint-name"},CD={key:0,class:"area-badge"},LD={key:0,class:"checkpoint-description-preview"},SD={class:"checkpoint-status-row"},xD={class:"status-badge marshals-status"},TD={key:0,class:"status-badge tasks-status"},ID={class:"accordion-icon"},$D={key:0,class:"checkpoint-accordion-content"},MD={class:"checkpoint-mini-map"},AD={class:"checkpoint-marshals-section"},ED={class:"marshals-label"},PD={key:0,class:"empty-state"},DD={key:1,class:"marshals-list"},OD=["onClick"],RD={class:"marshal-header"},BD={class:"marshal-name-row"},ND={class:"marshal-name"},FD={key:0,class:"task-count"},zD={class:"check-status-row"},UD=["onClick","disabled"],HD={key:0,class:"check-in-time"},VD={key:0},ZD={key:1,class:"last-access-time"},jD={key:0,class:"checkpoint-tasks-section"},WD={class:"marshals-label"},qD={class:"tasks-list"},GD=["disabled","onChange"],KD={class:"task-text"},YD={key:0,class:"marshal-details-modal"},JD={class:"details-section"},XD={class:"contact-info"},QD={key:0,class:"contact-row"},eO=["href"],tO={key:1,class:"contact-row"},nO=["href"],oO={key:2,class:"no-contact"},sO={class:"details-section"},iO={key:0,class:"checked-in-section"},aO={class:"checked-in-details"},rO={class:"check-time-detail"},lO={key:0,class:"check-method"},cO=["disabled"],uO={key:1,class:"not-checked-in-section"},dO=["disabled"],hO={key:2,class:"last-access-detail"},fO={class:"details-section"},pO={key:0,class:"no-tasks"},vO={key:1,class:"tasks-list modal-tasks"},mO=["disabled","onChange"],gO={class:"task-text"},yO={class:"details-section contact-actions-section"},_O={class:"contact-buttons"},kO=["href"],bO=["href"],wO=["href"],CO={__name:"AreaLeadSection",props:{eventId:{type:String,required:!0},areaIds:{type:Array,default:()=>[]},marshalId:{type:String,required:!0},route:{type:Array,default:()=>[]}},emits:["checklist-updated","loaded","checkin-updated"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=yt(),{updatePendingCount:a}=du(),l=e,u=o,h=O(!1),f=O(null),p=O([]),g=O([]),b=O(null),S=O(!1),T=O(null),_=ae(()=>[...g.value].sort((q,j)=>_n(q.name,j.name))),D=(q,j=60)=>q?q.length<=j?q:q.substring(0,j).trim()+"...":"";t({areas:p,checkpoints:g,loading:h});const M=O(!1),x=O(null),C=O(null),A=async()=>{if(!(!l.eventId||l.areaIds.length===0)){if(h.value=!0,f.value=null,tn()){try{const q=await ps(l.eventId);if(q?.areaLeadDashboard){p.value=q.areaLeadDashboard.areas||[],g.value=q.areaLeadDashboard.checkpoints||[],h.value=!1;return}}catch(q){console.warn("Failed to load cached dashboard:",q)}f.value="Offline - no cached data available",h.value=!1;return}try{const q=await ds.getAreaLeadDashboard(l.eventId);p.value=q.data.areas||[],g.value=q.data.checkpoints||[];try{const j=JSON.parse(JSON.stringify({areas:p.value,checkpoints:g.value}));await ps(l.eventId)?await fa(l.eventId,"areaLeadDashboard",j):await Oa(l.eventId,{areaLeadDashboard:j})}catch(j){console.warn("Failed to cache dashboard:",j)}}catch(q){console.error("Failed to load area lead dashboard:",q);try{const j=await ps(l.eventId);if(j?.areaLeadDashboard){console.log("Loading area lead dashboard from cache after error"),p.value=j.areaLeadDashboard.areas||[],g.value=j.areaLeadDashboard.checkpoints||[],h.value=!1;return}}catch(j){console.warn("Failed to load cached dashboard:",j)}f.value=q.response?.data?.message||"Failed to load dashboard"}finally{h.value=!1}}},I=q=>{b.value=b.value===q?null:q},$=q=>q.marshals.filter(j=>j.isCheckedIn).length,E=q=>{const j=q.marshals.reduce((ue,K)=>ue+K.outstandingTaskCount,0);return q.outstandingTaskCount+j},ie=(q,j)=>{x.value=q,C.value=j,M.value=!0},ce=()=>{M.value=!1,x.value=null,C.value=null},ge=async(q,j)=>{if(T.value)return;const ue=q.assignmentId||q.id;if(!ue){console.error("No assignment ID found for marshal:",q);return}T.value=q.marshalId;try{if(tn())await Sn("checkin_admin",{eventId:l.eventId,assignmentId:ue}),q.isCheckedIn=!0,q.checkInTime=new Date().toISOString(),q.checkInMethod="AreaLead (pending)",await a(),u("checkin-updated");else if(await Bo.adminCheckIn(l.eventId,ue),await A(),u("checkin-updated"),x.value?.marshalId===q.marshalId&&C.value){const K=g.value.find(pe=>pe.checkpointId===C.value.checkpointId);if(K){const pe=K.marshals.find(X=>X.marshalId===q.marshalId);pe&&(x.value=pe)}}}catch(K){console.error("Failed to check in marshal:",K),(tn()||!K.response)&&(await Sn("checkin_admin",{eventId:l.eventId,assignmentId:ue}),q.isCheckedIn=!0,q.checkInTime=new Date().toISOString(),q.checkInMethod="AreaLead (pending)",await a(),u("checkin-updated"))}finally{T.value=null}},re=async(q,j)=>{if(S.value)return;S.value=!0;const K={marshalId:j.marshals.length>0?j.marshals[0].marshalId:l.marshalId,contextType:q.contextType,contextId:q.contextId};try{tn()?(await Sn("checklist_complete",{eventId:l.eventId,itemId:q.itemId,data:K}),j.outstandingTasks=j.outstandingTasks.filter(pe=>pe.itemId!==q.itemId),j.outstandingTaskCount=Math.max(0,j.outstandingTaskCount-1),await a(),u("checklist-updated")):(await It.complete(l.eventId,q.itemId,K),await A(),u("checklist-updated"))}catch(pe){console.error("Failed to complete task:",pe),(tn()||!pe.response)&&(await Sn("checklist_complete",{eventId:l.eventId,itemId:q.itemId,data:K}),j.outstandingTasks=j.outstandingTasks.filter(X=>X.itemId!==q.itemId),j.outstandingTaskCount=Math.max(0,j.outstandingTaskCount-1),await a(),u("checklist-updated"))}finally{S.value=!1}},ve=async q=>{if(S.value||!x.value)return;S.value=!0;const j={marshalId:x.value.marshalId,contextType:q.contextType,contextId:q.contextId};try{if(tn())await Sn("checklist_complete",{eventId:l.eventId,itemId:q.itemId,data:j}),x.value.outstandingTasks=x.value.outstandingTasks.filter(ue=>ue.itemId!==q.itemId),x.value.outstandingTaskCount=Math.max(0,x.value.outstandingTaskCount-1),await a(),u("checklist-updated");else{if(await It.complete(l.eventId,q.itemId,j),await A(),x.value&&C.value){const ue=g.value.find(K=>K.checkpointId===C.value.checkpointId);if(ue){const K=ue.marshals.find(pe=>pe.marshalId===x.value.marshalId);K&&(x.value=K)}}u("checklist-updated")}}catch(ue){console.error("Failed to complete task:",ue),(tn()||!ue.response)&&(await Sn("checklist_complete",{eventId:l.eventId,itemId:q.itemId,data:j}),x.value.outstandingTasks=x.value.outstandingTasks.filter(K=>K.itemId!==q.itemId),x.value.outstandingTaskCount=Math.max(0,x.value.outstandingTaskCount-1),await a(),u("checklist-updated"))}finally{S.value=!1}},Be=q=>q?new Date(q).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",He=q=>q?new Date(q).toLocaleString():"",Oe=q=>{if(!q)return"";const j=new Date(q),K=new Date-j,pe=Math.floor(K/6e4),X=Math.floor(pe/60),we=Math.floor(X/24);return pe<1?"just now":pe<60?`${pe}m ago`:X<24?`${X}h ago`:we===1?"yesterday":we<7?`${we}d ago`:j.toLocaleDateString()},fe=q=>({GPS:"GPS",Manual:"Manual",Admin:"Admin",AreaLead:`${i.value.area} Lead`})[q]||q;return Ke(()=>[l.eventId,l.areaIds],()=>{A()},{immediate:!0}),(q,j)=>(m(),y("div",pD,[h.value?(m(),y("div",vD," Loading dashboard... ")):f.value?(m(),y("div",mD,[c("p",null,w(f.value),1),c("button",{onClick:A,class:"btn btn-secondary"},"Retry")])):_.value.length===0?(m(),y("div",gD,[c("p",null,"No "+w(V(s).checkpoints)+" in your "+w(V(s).areas)+".",1)])):(m(),y("div",yD,[(m(!0),y(Te,null,Ne(_.value,ue=>(m(),y("div",{key:ue.checkpointId,class:"checkpoint-accordion-section"},[c("button",{class:Ae(["checkpoint-accordion-header",{active:b.value===ue.checkpointId}]),onClick:K=>I(ue.checkpointId)},[c("div",kD,[c("div",bD,[c("span",wD,w(ue.name),1),ue.areaName?(m(),y("span",CD,w(ue.areaName),1)):F("",!0)]),ue.description?(m(),y("div",LD,w(D(ue.description)),1)):F("",!0),c("div",SD,[c("span",xD,w($(ue))+" / "+w(ue.marshals.length)+" checked in ",1),E(ue)>0?(m(),y("span",TD,w(E(ue))+" tasks ",1)):F("",!0)])]),c("span",ID,w(b.value===ue.checkpointId?"":"+"),1)],10,_D),b.value===ue.checkpointId?(m(),y("div",$D,[c("div",MD,[Ve(Ba,{locations:[{id:ue.checkpointId,name:ue.name,description:ue.description,latitude:ue.latitude,longitude:ue.longitude}],route:e.route,center:{lat:ue.latitude,lng:ue.longitude},zoom:16,"highlight-location-id":ue.checkpointId,"marshal-mode":!0},null,8,["locations","route","center","highlight-location-id"])]),c("div",AD,[c("div",ED,w(V(i).people)+" ("+w(ue.marshals.length)+")",1),ue.marshals.length===0?(m(),y("div",PD," No "+w(V(s).people)+" assigned to this "+w(V(s).checkpoint)+". ",1)):(m(),y("div",DD,[(m(!0),y(Te,null,Ne(ue.marshals,K=>(m(),y("div",{key:K.marshalId,class:Ae(["marshal-card",{"is-checked-in":K.isCheckedIn}]),onClick:pe=>ie(K,ue)},[c("div",RD,[c("div",BD,[c("span",ND,w(K.name),1),K.outstandingTaskCount>0?(m(),y("span",FD,w(K.outstandingTaskCount)+" tasks ",1)):F("",!0)]),c("div",zD,[c("div",{class:Ae(["check-status",{"checked-in":K.isCheckedIn}])},w(K.isCheckedIn?" Checked In":"Not Checked In"),3),c("button",{onClick:St(pe=>ge(K),["stop"]),class:Ae(["quick-checkin-btn",{"undo-btn":K.isCheckedIn}]),disabled:T.value===K.marshalId},w(T.value===K.marshalId?"...":K.isCheckedIn?"Undo":"Check In"),11,UD)])]),K.isCheckedIn&&K.checkInTime?(m(),y("div",HD,[We(w(Be(K.checkInTime))+" ",1),K.checkInMethod?(m(),y("span",VD," ("+w(fe(K.checkInMethod))+")",1)):F("",!0)])):F("",!0),K.lastAccessedAt?(m(),y("div",ZD," Last active: "+w(Oe(K.lastAccessedAt)),1)):F("",!0)],10,OD))),128))]))]),ue.outstandingTaskCount>0?(m(),y("div",jD,[c("div",WD,"Outstanding "+w(V(s).checkpoint)+" tasks ("+w(ue.outstandingTaskCount)+")",1),c("div",qD,[(m(!0),y(Te,null,Ne(ue.outstandingTasks,K=>(m(),y("div",{key:K.itemId,class:"task-item"},[c("input",{type:"checkbox",disabled:S.value,onChange:pe=>re(K,ue)},null,40,GD),c("span",KD,w(K.text),1)]))),128))])])):F("",!0)])):F("",!0)]))),128))])),Ve(zt,{show:M.value,title:x.value?.name||"Marshal Details",size:"large",onClose:ce},{actions:tt(()=>[c("button",{onClick:ce,class:"btn btn-secondary"},"Close")]),default:tt(()=>[x.value?(m(),y("div",YD,[c("div",JD,[j[4]||(j[4]=c("h4",null,"Contact Details",-1)),c("div",XD,[x.value.email?(m(),y("div",QD,[j[2]||(j[2]=c("span",{class:"contact-label"},"Email:",-1)),c("a",{href:`mailto:${x.value.email}`},w(x.value.email),9,eO)])):F("",!0),x.value.phoneNumber?(m(),y("div",tO,[j[3]||(j[3]=c("span",{class:"contact-label"},"Phone:",-1)),c("a",{href:`tel:${x.value.phoneNumber}`},w(x.value.phoneNumber),9,nO)])):F("",!0),!x.value.email&&!x.value.phoneNumber?(m(),y("div",oO," No contact details available. ")):F("",!0)])]),c("div",sO,[j[8]||(j[8]=c("h4",null,"Check-in Status",-1)),x.value.isCheckedIn?(m(),y("div",iO,[c("div",aO,[j[6]||(j[6]=c("span",{class:"check-icon"},"",-1)),c("div",null,[j[5]||(j[5]=c("strong",null,"Checked In",-1)),c("p",rO,w(He(x.value.checkInTime)),1),x.value.checkInMethod?(m(),y("p",lO," Method: "+w(fe(x.value.checkInMethod)),1)):F("",!0)])]),c("button",{onClick:j[0]||(j[0]=ue=>ge(x.value,C.value)),class:"btn btn-secondary undo-checkin-btn",disabled:T.value===x.value.marshalId},w(T.value===x.value.marshalId?"Undoing...":"Undo Check-in"),9,cO)])):(m(),y("div",uO,[j[7]||(j[7]=c("div",{class:"not-checked-in"},[c("span",{class:"not-checked-icon"},""),c("span",null,"Not checked in")],-1)),c("button",{onClick:j[1]||(j[1]=ue=>ge(x.value,C.value)),class:"btn btn-primary check-in-btn",disabled:T.value===x.value.marshalId},w(T.value===x.value.marshalId?"Checking in...":"Check In"),9,dO)])),x.value.lastAccessedAt?(m(),y("div",hO," Last active: "+w(Oe(x.value.lastAccessedAt)),1)):F("",!0)]),c("div",fO,[c("h4",null,w(V(i).checklists)+" ("+w(x.value.outstandingTasks?.length||0)+" outstanding)",1),!x.value.outstandingTasks||x.value.outstandingTasks.length===0?(m(),y("div",pO," No outstanding tasks. ")):(m(),y("div",vO,[(m(!0),y(Te,null,Ne(x.value.outstandingTasks,ue=>(m(),y("div",{key:ue.itemId,class:"task-item"},[c("input",{type:"checkbox",disabled:S.value,onChange:K=>ve(ue)},null,40,mO),c("span",gO,w(ue.text),1)]))),128))]))]),c("div",yO,[c("div",_O,[x.value.phoneNumber?(m(),y("a",{key:0,href:`tel:${x.value.phoneNumber}`,class:"btn btn-primary"}," Call ",8,kO)):F("",!0),x.value.phoneNumber?(m(),y("a",{key:1,href:`sms:${x.value.phoneNumber}`,class:"btn btn-secondary"}," Text ",8,bO)):F("",!0),x.value.email?(m(),y("a",{key:2,href:`mailto:${x.value.email}`,class:"btn btn-secondary"}," Email ",8,wO)):F("",!0)])])])):F("",!0)]),_:1},8,["show","title"])]))}},LO=Xe(CO,[["__scopeId","data-v-7df6c747"]]),SO={class:"offline-indicator-container"},xO={key:0,class:"offline-banner"},TO={class:"offline-text"},IO={key:0,class:"last-sync"},$O={class:"pending-text"},MO={key:0,class:"pending-subtext"},AO={key:1,class:"syncing-text"},EO={__name:"OfflineIndicator",setup(e){const{isOnline:t,isFullyOnline:o,pendingActionsCount:i,lastSyncTime:s,syncStatus:a,syncError:l,forcSync:u}=du(),h=O(!1),f=O(""),p=O(""),g=ae(()=>{if(!s.value)return"";const S=new Date(s.value),_=new Date-S,D=Math.floor(_/6e4),M=Math.floor(D/60);return D<1?"just now":D<60?`${D}m ago`:M<24?`${M}h ago`:S.toLocaleDateString()}),b=async()=>{await u()};return Ke(a,S=>{S==="success"&&i.value===0?(f.value="All actions synced successfully!",p.value="success",h.value=!0,setTimeout(()=>{h.value=!1},3e3)):S==="error"&&(f.value=l.value||"Sync failed",p.value="error",h.value=!0,setTimeout(()=>{h.value=!1},5e3))}),(S,T)=>(m(),y("div",SO,[Ve(ql,{name:"slide"},{default:tt(()=>[V(o)?F("",!0):(m(),y("div",xO,[T[0]||(T[0]=c("span",{class:"offline-icon"},[c("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"})])],-1)),c("span",TO,w(V(t)?"Server unavailable":"You're offline"),1),V(s)?(m(),y("span",IO," Last synced: "+w(g.value),1)):F("",!0)]))]),_:1}),Ve(ql,{name:"fade"},{default:tt(()=>[V(i)>0?(m(),y("div",{key:0,class:Ae(["pending-banner",{"offline-pending":!V(o)}])},[T[1]||(T[1]=c("span",{class:"pending-icon"},[c("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})])],-1)),c("span",$O,[We(w(V(i))+" pending action"+w(V(i)!==1?"s":"")+" ",1),V(o)?F("",!0):(m(),y("span",MO,"(will sync when online)"))]),V(o)&&V(a)!=="syncing"?(m(),y("button",{key:0,onClick:b,class:"sync-button"}," Sync Now ")):V(a)==="syncing"?(m(),y("span",AO,"Syncing...")):F("",!0)],2)):F("",!0)]),_:1}),Ve(ql,{name:"fade"},{default:tt(()=>[h.value?(m(),y("div",{key:0,class:Ae(["sync-toast",p.value])},w(f.value),3)):F("",!0)]),_:1})]))}},PO=Xe(EO,[["__scopeId","data-v-61340ead"]]),DO={class:"marshal-view"},OO={class:"header"},RO={class:"header-title"},BO={key:0},NO={key:1,class:"header-event-date"},FO={class:"header-actions"},zO={class:"container"},UO={key:0,class:"selection-card"},HO={key:1,class:"selection-card"},VO={key:0,class:"loading"},ZO={key:2,class:"selection-card error-card"},jO={class:"error"},WO={key:3,class:"dashboard"},qO={key:0,class:"welcome-bar"},GO={class:"welcome-info"},KO={key:0,class:"welcome-email"},YO={key:0,class:"mode-switch"},JO={key:1,class:"mode-switch"},XO={class:"accordion"},QO={class:"accordion-section"},e6={class:"accordion-title"},t6=["innerHTML"],n6={key:0,class:"location-status active"},o6={key:1,class:"location-status"},s6={class:"accordion-icon"},i6={key:0,class:"accordion-content map-content"},a6={key:0,class:"map-selection-banner"},r6={class:"accordion-section"},l6={class:"accordion-title"},c6=["innerHTML"],u6={class:"accordion-icon"},d6={key:0,class:"accordion-content assignments-accordion-content"},h6={key:0,class:"empty-state"},f6={key:1,class:"checkpoint-accordion"},p6=["onClick"],v6={class:"checkpoint-header-content"},m6={class:"checkpoint-title-row"},g6=["innerHTML"],y6={key:0,class:"checkpoint-check-icon"},_6={class:"checkpoint-name"},k6={key:1,class:"area-badge"},b6={key:2,class:"checkpoint-time-badge"},w6={key:0,class:"checkpoint-description-preview"},C6={class:"accordion-icon"},L6={key:0,class:"checkpoint-accordion-content"},S6={key:0,class:"checkpoint-mini-map"},x6={class:"checkpoint-marshals"},T6={class:"marshals-label"},I6={class:"marshals-list"},$6={key:0,class:"check-badge"},M6={key:1,class:"checkpoint-area-contacts"},A6={class:"marshals-label"},E6={class:"contact-list"},P6={class:"contact-info"},D6={class:"contact-name"},O6={key:0,class:"contact-role"},R6={key:1,class:"contact-detail"},B6={key:2,class:"contact-detail"},N6={class:"contact-actions"},F6=["href"],z6=["href"],U6=["href"],H6={key:2,class:"checked-in-status"},V6={class:"check-time"},Z6={key:3,class:"check-in-actions"},j6=["onClick","disabled"],W6=["onClick","disabled"],q6={key:4,class:"error"},G6={key:5,class:"dynamic-location-section"},K6={class:"dynamic-location-header"},Y6={class:"dynamic-badge"},J6={key:0,class:"last-update"},X6={class:"dynamic-location-actions"},Q6=["onClick","disabled"],eR=["onClick","title"],tR={class:"accordion-section"},nR={class:"accordion-title"},oR=["innerHTML"],sR={class:"accordion-icon"},iR={key:0,class:"accordion-content"},aR={key:0,class:"loading"},rR={key:1,class:"error"},lR={key:2,class:"empty-state"},cR={key:3,class:"checklist-items"},uR={class:"item-checkbox"},dR=["checked","disabled","onChange"],hR={class:"item-content"},fR={key:0,class:"item-context"},pR={key:1,class:"completion-info"},vR={class:"completion-text"},mR={class:"completion-time"},gR={key:0,class:"accordion-section"},yR={class:"accordion-title"},_R=["innerHTML"],kR={class:"accordion-icon"},bR={key:0,class:"accordion-content"},wR={key:0,class:"loading"},CR={key:1,class:"contact-list"},LR={class:"contact-info"},SR={class:"contact-name-row"},xR={key:0,class:"primary-badge"},TR={class:"contact-name"},IR={key:1,class:"contact-role-badge"},$R={key:0,class:"contact-notes-text"},MR={key:1,class:"contact-detail"},AR={key:2,class:"contact-detail"},ER={class:"contact-actions"},PR=["href"],DR=["href"],OR=["href"],RR={class:"accordion-section"},BR={class:"accordion-title"},NR=["innerHTML"],FR={class:"accordion-icon"},zR={key:0,class:"accordion-content"},UR={key:1,class:"accordion-section"},HR={class:"accordion-title"},VR=["innerHTML"],ZR={key:0,class:"area-lead-badges"},jR={class:"accordion-icon"},WR={key:0,class:"accordion-content area-lead-accordion-content"},qR={key:2,class:"accordion-section"},GR={class:"accordion-title"},KR=["innerHTML"],YR={class:"accordion-icon"},JR={key:0,class:"accordion-content"},XR={class:"event-details"},QR={key:0,class:"event-detail-row"},e5={class:"detail-value"},t5={key:1,class:"event-description"},n5={class:"detail-value"},o5={class:"modal-content location-update-modal"},s5={class:"modal-header"},i5={class:"modal-body"},a5={key:0,class:"success-message"},r5={key:1},l5={class:"modal-description"},c5={key:0,class:"last-update-info"},u5={key:1,class:"gps-status active"},d5={class:"update-option"},h5=["disabled"],f5={class:"update-option auto-update-option"},p5={class:"checkbox-label"},v5=["checked"],m5={class:"option-hint"},g5={class:"update-option"},y5=["disabled"],_5={class:"update-option"},k5={class:"option-label"},b5={key:0,class:"checkpoint-list"},w5=["onClick","disabled"],C5={key:1,class:"no-checkpoints"},L5={key:2,class:"error"},S5={__name:"MarshalView",setup(e){const{terms:t,termsLower:o}=yt(),{updatePendingCount:i}=du(),s=su(),a=Ha(),l=O(!1),u=O(!1),h=O(null),f=O(null),p=O(null),g=O(null),b=ae(()=>g.value?.eventRoles?g.value.eventRoles.filter(ee=>ee.role==="EventAreaLead").flatMap(ee=>ee.areaIds||[]):[]),S=ae(()=>b.value.length>0),T=ae(()=>g.value?.eventRoles?g.value.eventRoles.some(G=>G.role==="EventAdmin"):!1),_=ae(()=>g.value?.authMethod==="SecureEmailLink"&&T.value),D=ae(()=>g.value?.authMethod==="MarshalMagicCode"&&T.value),M=()=>{a.push(`/admin/events/${s.params.eventId}`)},x=O(null),C=O([]),A=O([]),I=O([]),$=O(!0),E=O("assignments"),ie=O(null),ce=O(null),ge=O(null),re=O([]),ve=O(!1),Be=O(null),He=O(!1),Oe=O([]),fe=O(!1),q=O(null),j=O(null),ue=O(null),K=O(!1),pe=O(!1);let X=null,we=null;const De=O(null),Se=O(!1),Ee=O(!1),se=O(""),me=O(""),ne=O(null),de=O(null),Le=O(null);let B=null;const U=G=>{E.value=E.value===G?null:G},Q=O(null),Z=G=>{Q.value=Q.value===G?null:G};Ke(()=>A.value,G=>{G.length===1&&Q.value===null&&(Q.value=G[0].id)},{immediate:!0});const N=ae(()=>A.value.map(G=>{const ee=C.value.find(Ct=>Ct.id===G.locationId),le=ee?.areaIds||ee?.AreaIds||[];let be=null;le.length>0&&I.value.length>0&&(be=I.value.find(Pt=>le.includes(Pt.id))?.name);const Pe=ee?.assignments||[],st=Je.value.filter(Ct=>le.includes(Ct.areaId));return{...G,location:ee,areaName:be,areaIds:le,allMarshals:Pe,areaContacts:st,locationName:ee?.name||"Unknown Location"}})),R=ae(()=>A.value.length>0?A.value[0]:null),J=ae(()=>A.value.map(G=>G.locationId)),ke=ae(()=>N.value.some(G=>G.location?.isDynamic||G.location?.IsDynamic)),xe=ae(()=>N.value.find(G=>G.location?.isDynamic||G.location?.IsDynamic)),Ce=ae(()=>x.value?.route?(typeof x.value.route=="string"?JSON.parse(x.value.route):x.value.route)||[]:[]),ze=ae(()=>!R.value||!C.value.length?null:C.value.find(G=>G.id===R.value.locationId)),Re=ae(()=>re.value.filter(G=>G.isCompleted?!["OnePerCheckpoint","OnePerArea","OneLeadPerArea"].includes(G.matchedScope):!0)),je=ae(()=>Re.value.filter(G=>G.isCompleted).length),Ye=O([]),te=O(!1),Y=ae(()=>Ye.value),H=ae(()=>{const G=["EmergencyContact","EventDirector","MedicalLead","SafetyOfficer"];return Ye.value.filter(ee=>G.includes(ee.role))}),Fe=ae(()=>Oe.value.filter(G=>{const ee=G.priority||G.Priority;return ee==="Emergency"||ee==="Urgent"})),Je=O([]);ae(()=>{if(Je.value.length===0)return[];const G={};for(const ee of Je.value){const le=ee.areaId||"unknown";G[le]||(G[le]={areaId:ee.areaId,areaName:ee.areaName||"Unknown Area",contacts:[]}),G[le].contacts.push(ee)}return Object.values(G)}),ae(()=>Je.value.length);const Qe=(G,ee)=>G.localeCompare(ee,void 0,{numeric:!0,sensitivity:"base"}),ot=ae(()=>{if(!q.value)return[];const G=q.value.locationId;return C.value.filter(ee=>ee.id!==G&&ee.latitude!==0&&ee.longitude!==0).sort((ee,le)=>Qe(ee.name,le.name))}),$t=ae(()=>ze.value?{lat:ze.value.latitude,lng:ze.value.longitude}:de.value?de.value:C.value.length>0?{lat:C.value[0].latitude,lng:C.value[0].longitude}:{lat:51.505,lng:-.09}),Mt=async(G,ee)=>{u.value=!0,h.value=null,console.log("Authenticating with magic code:",{eventId:G,code:ee});try{const le=await uo.marshalLogin(G,ee);if(console.log("Auth response:",le.data),le.data.success){localStorage.setItem("sessionToken",le.data.sessionToken),localStorage.setItem(`marshal_${G}`,le.data.marshalId),f.value=le.data.person,p.value=le.data.marshalId,l.value=!0,console.log("Authenticated as marshal:",p.value,f.value?.name);try{const be=await uo.getMe(G);g.value=be.data,console.log("User claims:",g.value)}catch(be){console.warn("Failed to fetch claims:",be)}a.replace({path:s.path,query:{}}),Jo(),await rt()}else h.value=le.data.message||"Authentication failed"}catch(le){console.error("Authentication failed:",le),h.value=le.response?.data?.message||"Invalid or expired login link"}finally{u.value=!1}},_t=async G=>{const ee=localStorage.getItem("sessionToken"),le=localStorage.getItem(`marshal_${G}`);if(!ee||!le)return!1;try{const be=await uo.getMe(G);if(be.data&&be.data.marshalId)return g.value=be.data,f.value={personId:be.data.personId,name:be.data.personName,email:be.data.personEmail},p.value=be.data.marshalId,l.value=!0,Jo(),!0}catch{localStorage.removeItem("sessionToken"),localStorage.removeItem(`marshal_${G}`)}return!1},rt=async()=>{const G=s.params.eventId;if(console.log("Loading event data for:",{eventId:G,marshalId:p.value}),tn()){console.log("Offline mode detected, attempting to load from cache...");const Pe=await ps(G);if(Pe){if(console.log("Loaded cached data from:",Pe.cachedAt),x.value=Pe.event,I.value=Pe.areas||[],C.value=Pe.locations||[],re.value=Pe.checklist||[],Ye.value=Pe.contacts||[],Oe.value=Pe.notes||[],x.value&&Pc(x.value),p.value){const st=[];for(const Ct of C.value){const Pt=Ct.assignments?.find(ws=>ws.marshalId===p.value);Pt&&st.push(Pt)}A.value=st}return}else console.warn("No cached data available while offline")}console.log("Fetching event data in parallel...");const[ee,le,be]=await Promise.allSettled([Rs.getById(G),ds.getByEvent(G),pa.getEventStatus(G)]);if(ee.status==="fulfilled"?(x.value=ee.value.data,console.log("Event loaded:",x.value?.name),x.value&&Pc(x.value)):console.error("Failed to load event:",ee.reason),le.status==="fulfilled"?(I.value=le.value.data||[],console.log("Areas loaded:",I.value.length)):console.error("Failed to load areas:",le.reason),be.status==="fulfilled"){if(C.value=be.value.data?.locations||[],console.log("Locations loaded:",C.value.length),p.value){const Pe=[];for(const st of C.value){const Ct=st.assignments?.find(Pt=>Pt.marshalId===p.value);Ct&&Pe.push(Ct)}A.value=Pe,console.log("Total assignments found:",A.value.length)}}else console.error("Failed to load event status:",be.reason);await Promise.allSettled([Jt(),Fn(),kt()]);try{const Pe=JSON.parse(JSON.stringify({event:x.value,areas:I.value,locations:C.value,checklist:re.value,contacts:Ye.value,notes:Oe.value,marshalId:p.value}));await Oa(G,Pe),console.log("Event data cached for offline access")}catch(Pe){console.warn("Failed to cache event data:",Pe)}Di()},At=async()=>{const G=s.params.eventId;if(tn()){console.log("Skipping background preload: offline");return}console.log("Starting background preload for offline data...");try{const ee=await ds.getAreaLeadDashboard(G);if(ee.data){const le=JSON.parse(JSON.stringify({areas:ee.data.areas||[],checkpoints:ee.data.checkpoints||[]}));await ps(G)?await fa(G,"areaLeadDashboard",le):await Oa(G,{areaLeadDashboard:le}),console.log("Area lead dashboard cached for offline access")}}catch(ee){ee.response?.status!==403&&console.warn("Failed to preload area lead dashboard:",ee)}console.log("Background preload complete")},kt=async()=>{const G=s.params.eventId;try{const ee=await Eo.getMyNotes(G);Oe.value=ee.data||[],console.log("Notes loaded:",Oe.value.length)}catch(ee){console.error("Failed to load notes:",ee)}},Fn=async()=>{const G=s.params.eventId;te.value=!0;try{const ee=await gi.getMyContacts(G);Ye.value=ee.data||[],console.log("Contacts loaded:",Ye.value.length)}catch(ee){console.warn("Failed to load contacts:",ee),Ye.value=[]}finally{te.value=!1}},Jt=async()=>{if(!p.value){console.warn("No marshal ID, skipping checklist load");return}ve.value=!0,Be.value=null;try{console.log("Fetching checklist for marshal:",p.value);const G=await It.getMarshalChecklist(s.params.eventId,p.value);re.value=G.data||[],console.log("Checklist loaded:",re.value.length,"items")}catch(G){console.error("Failed to load checklist:",G.response?.status,G.response?.data),Be.value=G.response?.data?.message||"Failed to load checklist"}finally{ve.value=!1}},eo=async G=>{if(He.value)return;He.value=!0;const ee=s.params.eventId,le={marshalId:p.value,contextType:G.completionContextType,contextId:G.completionContextId};try{G.isCompleted?tn()?(await Sn("checklist_uncomplete",{eventId:ee,itemId:G.itemId,data:le}),G.isCompleted=!1,G.completedAt=null,G.completedByActorName=null,await i()):(await It.uncomplete(ee,G.itemId,le),await Jt()):tn()?(await Sn("checklist_complete",{eventId:ee,itemId:G.itemId,data:le}),G.isCompleted=!0,G.completedAt=new Date().toISOString(),G.completedByActorName=f.value?.name||"You",await i()):(await It.complete(ee,G.itemId,le),await Jt()),await fa(ee,"checklist",re.value)}catch(be){if(console.error("Failed to toggle checklist item:",be),tn()||!be.response){const Pe=G.isCompleted?"checklist_uncomplete":"checklist_complete";await Sn(Pe,{eventId:ee,itemId:G.itemId,data:le}),G.isCompleted=!G.isCompleted,await i()}else Be.value=be.response?.data?.message||"Failed to update checklist",setTimeout(()=>{Be.value=null},3e3)}finally{He.value=!1}},wn=G=>{if(!G.completionContextType||!G.completionContextId)return null;if(G.completionContextType==="Checkpoint"){const ee=C.value.find(be=>be.id===G.completionContextId);if(!ee)return null;const le=ee.description?` - ${ee.description}`:"";return`At ${o.value.checkpoint} ${ee.name}${le}`}if(G.completionContextType==="Area"){const ee=I.value.find(le=>le.id===G.completionContextId);return ee?`At ${o.value.area} ${ee.name}`:null}return G.completionContextType==="Personal"?"Personal item":null},$n=()=>{if(!("geolocation"in navigator)){console.warn("Geolocation not supported");return}console.log("Starting location tracking..."),B=navigator.geolocation.watchPosition(G=>{de.value={lat:G.coords.latitude,lng:G.coords.longitude},Le.value=Date.now()},G=>{console.warn("Geolocation error:",{1:"Location permission denied. Please allow location access in your browser settings.",2:"Location unavailable. Make sure GPS is enabled on your device.",3:"Location request timed out. Please try again."}[G.code]||G.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},po=()=>{B!==null&&(navigator.geolocation.clearWatch(B),B=null)},zn=async G=>{ie.value=G.id,ce.value=G.id,ge.value=null;const ee=s.params.eventId;try{if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const le=await new Promise((Pe,st)=>{navigator.geolocation.getCurrentPosition(Pe,st,{enableHighAccuracy:!0,timeout:1e4})}),be={eventId:ee,assignmentId:G.id,latitude:le.coords.latitude,longitude:le.coords.longitude,manualCheckIn:!1};if(tn()){await Sn("checkin",be);const Pe=A.value.findIndex(st=>st.id===G.id);Pe!==-1&&(A.value[Pe]={...A.value[Pe],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"GPS (pending)",checkInLatitude:le.coords.latitude,checkInLongitude:le.coords.longitude}),await i(),await fa(ee,"locations",C.value)}else{const Pe=await Bo.checkIn(be),st=A.value.findIndex(Ct=>Ct.id===G.id);st!==-1&&(A.value[st]=Pe.data)}}catch(le){if(tn()||!le.response){const be={eventId:ee,assignmentId:G.id,latitude:de.value?.lat||null,longitude:de.value?.lng||null,manualCheckIn:!0};await Sn("checkin",be);const Pe=A.value.findIndex(st=>st.id===G.id);Pe!==-1&&(A.value[Pe]={...A.value[Pe],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"Manual (pending)"}),await i()}else le.response?.data?.message?ge.value=le.response.data.message:le.message?ge.value=le.message:ge.value="Failed to check in. Please try manual check-in."}finally{ie.value=null,ce.value=null}},jo=G=>{se.value="Manual Check-In",me.value="Are you sure you want to check in manually? This should only be used if GPS is not available.",ne.value=async()=>{ie.value=G.id,ce.value=G.id,ge.value=null;const ee=s.params.eventId,le={eventId:ee,assignmentId:G.id,latitude:null,longitude:null,manualCheckIn:!0};try{if(tn()){await Sn("checkin",le);const be=A.value.findIndex(Pe=>Pe.id===G.id);be!==-1&&(A.value[be]={...A.value[be],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"Manual (pending)"}),await i(),await fa(ee,"locations",C.value)}else{const be=await Bo.checkIn(le),Pe=A.value.findIndex(st=>st.id===G.id);Pe!==-1&&(A.value[Pe]=be.data)}}catch(be){if(tn()||!be.response){await Sn("checkin",le);const Pe=A.value.findIndex(st=>st.id===G.id);Pe!==-1&&(A.value[Pe]={...A.value[Pe],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"Manual (pending)"}),await i()}else ge.value="Failed to check in manually. Please contact the admin."}finally{ie.value=null,ce.value=null}},Ee.value=!0},_s=()=>{Ee.value=!1,ne.value&&(ne.value(),ne.value=null)},Gs=()=>{Ee.value=!1,ne.value=null},Un=G=>{q.value=G,j.value=null,ue.value=null,fe.value=!0},ln=()=>{fe.value=!1,q.value=null,j.value=null,ue.value=null,Xt.value=!1},Xt=O(!1),ks=()=>{Xt.value=!0,fe.value=!1,E.value="map"},Wo=G=>{if(Xt.value&&q.value){qe(q.value.locationId,G.lat,G.lng,"manual"),Xt.value=!1,q.value=null;return}if(ke.value&&xe.value){const ee=xe.value;se.value="Update location",me.value=`Update ${ee.location?.name||"dynamic checkpoint"} to this location?`,ne.value=async()=>{await qe(ee.locationId,G.lat,G.lng,"manual")},Ee.value=!0}},Kt=G=>{if(!Xt.value&&ke.value&&xe.value){const ee=xe.value;if(G.id===ee.locationId)return;se.value="Copy location",me.value=`Copy location from "${G.name}" to ${ee.location?.name||"your dynamic checkpoint"}?`,ne.value=async()=>{await qe(ee.locationId,G.latitude,G.longitude,"checkpoint",G.id)},Ee.value=!0}},qe=async(G,ee,le,be,Pe=null)=>{K.value=!0;try{const st=s.params.eventId,Ct={latitude:ee,longitude:le,sourceType:be};Pe&&(Ct.sourceCheckpointId=Pe);const Pt=await yn.updatePosition(st,G,Ct);Pt.data.success&&(pe.value&&Cn(),no(G,Pt.data.latitude,Pt.data.longitude,Pt.data.lastLocationUpdate))}catch(st){console.error("Failed to update location:",st),st.response?.status===403?alert("You do not have permission to update this location."):alert("Failed to update location. Please try again.")}finally{K.value=!1}},Hn=()=>{Xt.value=!1,fe.value=!0},to=async()=>{if(q.value){K.value=!0,j.value=null;try{let G,ee;if(de.value&&Le.value&&Date.now()-Le.value<3e4&&(G=de.value.lat,ee=de.value.lng),!G||!ee){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const st=await new Promise((Ct,Pt)=>{navigator.geolocation.getCurrentPosition(Ct,Pt,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4})});G=st.coords.latitude,ee=st.coords.longitude}const le=s.params.eventId,be=q.value.locationId,Pe=await yn.updatePosition(le,be,{latitude:G,longitude:ee,sourceType:"gps"});Pe.data.success&&(ue.value="Location updated successfully!",no(be,Pe.data.latitude,Pe.data.longitude,Pe.data.lastLocationUpdate),setTimeout(()=>ln(),1500))}catch(G){console.error("Failed to update location with GPS:",G),G.response?.status===403?j.value="You do not have permission to update this location.":G.code===1?j.value="Location access denied. Please enable location permissions.":G.code===2?j.value="Unable to determine your location. Please try again.":G.code===3||G.message?.includes("Timeout")?j.value="GPS timed out. Please ensure location services are enabled and try again.":j.value="Failed to update location. Please try again."}finally{K.value=!1}}},vo=async G=>{if(!q.value)return;const ee=C.value.find(le=>le.id===G);if(!ee){j.value="Source checkpoint not found.";return}K.value=!0,j.value=null;try{const le=s.params.eventId,be=q.value.locationId,Pe=await yn.updatePosition(le,be,{latitude:ee.latitude,longitude:ee.longitude,sourceType:"checkpoint",sourceCheckpointId:G});Pe.data.success&&(pe.value&&Cn(),ue.value=`Location copied from ${ee.name}!`,no(be,Pe.data.latitude,Pe.data.longitude,Pe.data.lastLocationUpdate),setTimeout(()=>ln(),1500))}catch(le){console.error("Failed to copy location from checkpoint:",le),le.response?.status===403?j.value="You do not have permission to update this location.":j.value="Failed to update location. Please try again."}finally{K.value=!1}},no=(G,ee,le,be)=>{const Pe=C.value.find(st=>st.id===G);Pe&&(Pe.latitude=ee,Pe.longitude=le,Pe.lastLocationUpdate=be)},qo=G=>{pe.value?Cn():Ks(G)},Ks=G=>{pe.value=!0,Go(G),X=setInterval(()=>{Go(G)},6e4)},Cn=()=>{pe.value=!1,X&&(clearInterval(X),X=null)},Go=async G=>{if(!(!G||!("geolocation"in navigator)))try{const ee=await new Promise((Pe,st)=>{navigator.geolocation.getCurrentPosition(Pe,st,{enableHighAccuracy:!0,timeout:15e3})}),le=s.params.eventId,be=G.locationId;await yn.updatePosition(le,be,{latitude:ee.coords.latitude,longitude:ee.coords.longitude,sourceType:"gps"}),no(be,ee.coords.latitude,ee.coords.longitude,new Date().toISOString())}catch(ee){console.warn("Auto-update location failed:",ee)}},Di=()=>{we||!C.value.some(ee=>ee.isDynamic||ee.IsDynamic)||(we=setInterval(async()=>{try{const ee=s.params.eventId,le=await yn.getDynamicCheckpoints(ee);if(le.data&&Array.isArray(le.data))for(const be of le.data){const Pe=C.value.find(st=>st.id===be.checkpointId);Pe&&(Pe.latitude=be.latitude,Pe.longitude=be.longitude,Pe.lastLocationUpdate=be.lastLocationUpdate)}}catch(ee){console.warn("Failed to poll dynamic checkpoints:",ee)}},6e4))},Ys=()=>{we&&(clearInterval(we),we=null)},Oi=G=>G?.isDynamic===!0||G?.IsDynamic===!0,Ri=async()=>{try{await uo.logout()}catch{}localStorage.removeItem("sessionToken"),localStorage.removeItem(`marshal_${s.params.eventId}`),l.value=!1,f.value=null,p.value=null,A.value=[],re.value=[],Je.value=[],a.push("/")},Ko=G=>G?new Date(G).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",bs=G=>G?new Date(G).toLocaleString():"",Yo=(G,ee)=>{if(!G&&!ee)return"";const le=G?Ko(G):"?",be=ee?Ko(ee):"?";return`${le} - ${be}`},Et=G=>G?new Date(G).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",Js=G=>G?new Date(G).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",Xs=G=>G?G.replace(/([A-Z])/g," $1").replace(/^./,ee=>ee.toUpperCase()).trim():"",Qs=G=>{if(!G)return"";const ee=G.resolvedStyleType||G.ResolvedStyleType,le=G.resolvedStyleBackgroundColor||G.ResolvedStyleBackgroundColor||G.resolvedStyleColor||G.ResolvedStyleColor,be=G.resolvedStyleBorderColor||G.ResolvedStyleBorderColor,Pe=G.resolvedStyleIconColor||G.ResolvedStyleIconColor,st=G.resolvedStyleBackgroundShape||G.ResolvedStyleBackgroundShape;return ee&&ee!=="default"||le||be||Pe||st&&st!=="circle"?qt({type:ee||"circle",backgroundShape:st||"circle",backgroundColor:le||"#667eea",borderColor:be||"#ffffff",iconColor:Pe||"#ffffff",size:"75",outputSize:20}):`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
    <circle cx="10" cy="10" r="8" fill="#667eea" stroke="#fff" stroke-width="1.5"/>
  </svg>`};rn(async()=>{const G=s.params.eventId,ee=s.query.code;$.value=!0;try{ee?await Mt(G,ee):await _t(G)&&await rt()}finally{$.value=!1}l.value&&($n(),"requestIdleCallback"in window?requestIdleCallback(()=>{At()},{timeout:5e3}):setTimeout(()=>{At()},2e3))}),Ke(l,G=>{G?$n():po()}),Ke(()=>s.query.code,async G=>{if(G&&l.value){$.value=!0;try{await Mt(s.params.eventId,G)}finally{$.value=!1}}});let mo=null;const Jo=()=>{mo||(mo=setInterval(async()=>{if(g.value?.marshalId)try{await uo.getMe(s.params.eventId)}catch(G){console.debug("Heartbeat failed:",G)}},300*1e3))},Zt=()=>{mo&&(clearInterval(mo),mo=null)};return fo(()=>{po(),Zt(),Cn(),Ys()}),(G,ee)=>(m(),y("div",DO,[Ve(PO),c("header",OO,[c("div",RO,[x.value?(m(),y("h1",BO,w(x.value.name),1)):F("",!0),x.value?.eventDate?(m(),y("div",NO,w(Js(x.value.eventDate)),1)):F("",!0)]),c("div",FO,[l.value?(m(),y("button",{key:0,onClick:ee[0]||(ee[0]=le=>Se.value=!0),class:"btn-emergency"}," Emergency Info ")):F("",!0),l.value?(m(),y("button",{key:1,onClick:Ri,class:"btn-logout"}," Logout "+w(f.value?.name||""),1)):F("",!0)])]),c("div",zO,[$.value?(m(),y("div",UO,[...ee[10]||(ee[10]=[c("div",{class:"loading"},"Loading...",-1)])])):!l.value&&!h.value?(m(),y("div",HO,[ee[11]||(ee[11]=c("h2",null,"Welcome",-1)),ee[12]||(ee[12]=c("p",{class:"instruction"},"Please use the login link sent to you to access your marshal dashboard.",-1)),u.value?(m(),y("p",VO,"Authenticating...")):F("",!0)])):h.value?(m(),y("div",ZO,[ee[13]||(ee[13]=c("h2",null,"Login failed",-1)),c("p",jO,w(h.value),1),ee[14]||(ee[14]=c("p",{class:"instruction"},"Please contact the event organiser for a new login link.",-1))])):(m(),y("div",WO,[_.value||D.value?(m(),y("div",qO,[c("div",GO,[f.value?.email?(m(),y("span",KO,w(f.value.email),1)):F("",!0)]),_.value?(m(),y("div",YO,[c("button",{onClick:M,class:"btn-mode-switch"}," Switch to Admin ")])):D.value?(m(),y("div",JO,[...ee[15]||(ee[15]=[c("span",{class:"reauth-hint",title:"Login via admin flow to access admin features"}," Admin access requires re-login ",-1)])])):F("",!0)])):F("",!0),c("div",XO,[c("div",QO,[c("button",{class:Ae(["accordion-header",{active:E.value==="map"}]),onClick:ee[1]||(ee[1]=le=>U("map"))},[c("span",e6,[c("span",{class:"section-icon",innerHTML:V(xn)("course")},null,8,t6),We(" "+w(V(t).course)+" ",1),de.value?(m(),y("span",n6,"GPS Active")):(m(),y("span",o6,"GPS Inactive"))]),c("span",s6,w(E.value==="map"?"":"+"),1)],2),E.value==="map"?(m(),y("div",i6,[Xt.value?(m(),y("div",a6,[c("span",null,[ee[16]||(ee[16]=We("Click on the map to set the new location for ",-1)),c("strong",null,w(q.value?.location?.name),1)]),c("button",{onClick:Hn,class:"btn btn-secondary btn-sm"},"Cancel")])):F("",!0),Ve(Ba,{locations:C.value,route:Ce.value,center:$t.value,zoom:15,"user-location":de.value,"highlight-location-ids":J.value,"marshal-mode":!0,clickable:Xt.value||ke.value,class:Ae({"selecting-location":Xt.value}),onMapClick:Wo,onLocationClick:Kt},null,8,["locations","route","center","user-location","highlight-location-ids","clickable","class"])])):F("",!0)]),c("div",r6,[c("button",{class:Ae(["accordion-header",{active:E.value==="assignments"}]),onClick:ee[2]||(ee[2]=le=>U("assignments"))},[c("span",l6,[c("span",{class:"section-icon",innerHTML:V(xn)("checkpoint")},null,8,c6),We(" Your "+w(V(o).checkpoints)+" ("+w(A.value.length)+") ",1)]),c("span",u6,w(E.value==="assignments"?"":"+"),1)],2),E.value==="assignments"?(m(),y("div",d6,[A.value.length===0?(m(),y("div",h6,[c("p",null,"You don't have any "+w(V(o).checkpoint)+" assignments yet.",1)])):(m(),y("div",f6,[(m(!0),y(Te,null,Ne(N.value,le=>(m(),y("div",{key:le.id,class:"checkpoint-accordion-section"},[c("button",{class:Ae(["checkpoint-accordion-header",{active:Q.value===le.id,"checked-in":le.isCheckedIn}]),onClick:be=>Z(le.id)},[c("div",v6,[c("div",m6,[c("span",{class:"checkpoint-icon",innerHTML:Qs(le.location)},null,8,g6),le.isCheckedIn?(m(),y("span",y6,"")):F("",!0),c("span",_6,w(le.location?.name||le.locationName),1),le.areaName?(m(),y("span",k6,w(le.areaName),1)):F("",!0),le.location?.startTime||le.location?.endTime?(m(),y("span",b6,w(Yo(le.location.startTime,le.location.endTime)),1)):F("",!0)]),le.location?.description?(m(),y("div",w6,w(le.location.description),1)):F("",!0)]),c("span",C6,w(Q.value===le.id?"":"+"),1)],10,p6),Q.value===le.id?(m(),y("div",L6,[le.location?(m(),y("div",S6,[Ve(Ba,{locations:C.value,route:Ce.value,center:{lat:le.location.latitude,lng:le.location.longitude},zoom:16,"user-location":de.value,"highlight-location-id":le.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:ke.value,onMapClick:Wo,onLocationClick:Kt},null,8,["locations","route","center","user-location","highlight-location-id","clickable"])])):F("",!0),c("div",x6,[c("div",T6,w(V(t).people)+":",1),c("div",I6,[(m(!0),y(Te,null,Ne(le.allMarshals,be=>(m(),y("span",{key:be.marshalId,class:Ae(["marshal-tag",{"is-you":be.marshalId===p.value,"checked-in":be.isCheckedIn}])},[We(w(be.marshalName)+w(be.marshalId===p.value?" (you)":"")+" ",1),be.isCheckedIn?(m(),y("span",$6,"")):F("",!0)],2))),128))])]),le.areaContacts.length>0?(m(),y("div",M6,[c("div",A6,w(V(t).area)+" contacts:",1),c("div",E6,[(m(!0),y(Te,null,Ne(le.areaContacts,be=>(m(),y("div",{key:be.marshalId,class:"contact-item"},[c("div",P6,[c("div",D6,w(be.marshalName),1),be.role?(m(),y("div",O6,w(be.role),1)):F("",!0),be.phone?(m(),y("div",R6,w(be.phone),1)):F("",!0),be.email?(m(),y("div",B6,w(be.email),1)):F("",!0)]),c("div",N6,[be.phone?(m(),y("a",{key:0,href:`tel:${be.phone}`,class:"contact-link"},[...ee[17]||(ee[17]=[c("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),We(" Call ",-1)])],8,F6)):F("",!0),be.phone?(m(),y("a",{key:1,href:`sms:${be.phone}`,class:"contact-link"},[...ee[18]||(ee[18]=[c("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),We(" Text ",-1)])],8,z6)):F("",!0),be.email?(m(),y("a",{key:2,href:`mailto:${be.email}`,class:"contact-link"},[...ee[19]||(ee[19]=[c("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),We(" Email ",-1)])],8,U6)):F("",!0)])]))),128))])])):F("",!0),le.isCheckedIn?(m(),y("div",H6,[ee[21]||(ee[21]=c("span",{class:"check-icon"},"",-1)),c("div",null,[ee[20]||(ee[20]=c("strong",null,"Checked In",-1)),c("p",V6,w(Ko(le.checkInTime)),1)])])):(m(),y("div",Z6,[c("button",{onClick:be=>zn(le),class:"btn btn-primary",disabled:ie.value===le.id},w(ie.value===le.id?"Checking in...":"GPS Check-In"),9,j6),c("button",{onClick:be=>jo(le),class:"btn btn-secondary",disabled:ie.value===le.id}," Manual ",8,W6)])),ge.value&&ce.value===le.id?(m(),y("div",q6,w(ge.value),1)):F("",!0),Oi(le.location)?(m(),y("div",G6,[c("div",K6,[c("span",Y6,"Dynamic "+w(le.location.resolvedCheckpointTerm||V(t).checkpoint),1),le.location.lastLocationUpdate?(m(),y("span",J6," Last updated: "+w(bs(le.location.lastLocationUpdate)),1)):F("",!0)]),c("div",X6,[c("button",{onClick:be=>Un(le),class:"btn btn-update-location",disabled:K.value},[...ee[22]||(ee[22]=[c("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1),We(" Update location ",-1)])],8,Q6),c("button",{onClick:be=>qo(le),class:Ae(["btn btn-auto-update",{active:pe.value}]),title:pe.value?"Stop auto-updating":"Auto-update every 60 seconds"},[ee[23]||(ee[23]=c("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})],-1)),We(" "+w(pe.value?"Stop":"Auto"),1)],10,eR)])])):F("",!0)])):F("",!0)]))),128))]))])):F("",!0)]),c("div",tR,[c("button",{class:Ae(["accordion-header",{active:E.value==="checklist"}]),onClick:ee[3]||(ee[3]=le=>U("checklist"))},[c("span",nR,[c("span",{class:"section-icon",innerHTML:V(xn)("checklist")},null,8,oR),We(" Your "+w(V(o).checklists)+" ("+w(je.value)+" of "+w(Re.value.length)+" complete) ",1)]),c("span",sR,w(E.value==="checklist"?"":"+"),1)],2),E.value==="checklist"?(m(),y("div",iR,[ve.value?(m(),y("div",aR,"Loading checklist...")):Be.value?(m(),y("div",rR,w(Be.value),1)):Re.value.length===0?(m(),y("div",lR,[c("p",null,"No "+w(V(o).checklists)+" for you.",1)])):(m(),y("div",cR,[(m(!0),y(Te,null,Ne(Re.value,le=>(m(),y("div",{key:le.itemId,class:Ae(["checklist-item",{"item-completed":le.isCompleted}])},[c("div",uR,[c("input",{type:"checkbox",checked:le.isCompleted,disabled:!le.canBeCompletedByMe||He.value,onChange:be=>eo(le)},null,40,dR)]),c("div",hR,[c("div",{class:Ae(["item-text",{"text-completed":le.isCompleted}])},w(le.text),3),wn(le)?(m(),y("div",fR,w(wn(le)),1)):F("",!0),le.isCompleted?(m(),y("div",pR,[c("span",vR," Completed by "+w(le.completedByActorName||"Unknown"),1),c("span",mR,w(bs(le.completedAt)),1)])):F("",!0)])],2))),128))]))])):F("",!0)]),Y.value.length>0||te.value?(m(),y("div",gR,[c("button",{class:Ae(["accordion-header",{active:E.value==="eventContacts"}]),onClick:ee[4]||(ee[4]=le=>U("eventContacts"))},[c("span",yR,[c("span",{class:"section-icon",innerHTML:V(xn)("contacts")},null,8,_R),We(" Your contacts ("+w(Y.value.length)+") ",1)]),c("span",kR,w(E.value==="eventContacts"?"":"+"),1)],2),E.value==="eventContacts"?(m(),y("div",bR,[te.value?(m(),y("div",wR,"Loading contacts...")):(m(),y("div",CR,[(m(!0),y(Te,null,Ne(Y.value,le=>(m(),y("div",{key:le.contactId,class:Ae(["contact-item",{"primary-contact":le.isPrimary}])},[c("div",LR,[c("div",SR,[le.isPrimary?(m(),y("span",xR,"")):F("",!0),c("span",TR,w(le.name),1),le.role?(m(),y("span",IR,w(Xs(le.role)),1)):F("",!0)]),le.notes?(m(),y("div",$R,w(le.notes),1)):F("",!0),le.phone?(m(),y("div",MR,w(le.phone),1)):F("",!0),le.email?(m(),y("div",AR,w(le.email),1)):F("",!0)]),c("div",ER,[le.phone?(m(),y("a",{key:0,href:`tel:${le.phone}`,class:"contact-link"},[...ee[24]||(ee[24]=[c("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),We(" Call ",-1)])],8,PR)):F("",!0),le.phone?(m(),y("a",{key:1,href:`sms:${le.phone}`,class:"contact-link"},[...ee[25]||(ee[25]=[c("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),We(" Text ",-1)])],8,DR)):F("",!0),le.email?(m(),y("a",{key:2,href:`mailto:${le.email}`,class:"contact-link"},[...ee[26]||(ee[26]=[c("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),We(" Email ",-1)])],8,OR)):F("",!0)])],2))),128))]))])):F("",!0)])):F("",!0),c("div",RR,[c("button",{class:Ae(["accordion-header",{active:E.value==="notes"}]),onClick:ee[5]||(ee[5]=le=>U("notes"))},[c("span",BR,[c("span",{class:"section-icon",innerHTML:V(xn)("notes")},null,8,NR),We(" Your notes ("+w(Oe.value.length)+") ",1)]),c("span",FR,w(E.value==="notes"?"":"+"),1)],2),E.value==="notes"?(m(),y("div",zR,[Ve(bl,{"event-id":V(s).params.eventId,"all-notes":Oe.value,locations:C.value,areas:I.value,assignments:A.value,"show-scope":!1,onNotesChanged:kt},null,8,["event-id","all-notes","locations","areas","assignments"])])):F("",!0)]),S.value?(m(),y("div",UR,[c("button",{class:Ae(["accordion-header",{active:E.value==="areaLead"}]),onClick:ee[6]||(ee[6]=le=>U("areaLead"))},[c("span",HR,[c("span",{class:"section-icon",innerHTML:V(xn)("people")},null,8,VR),We(" Your "+w(V(o).people)+" ",1),De.value?.areas?.length>0?(m(),y("span",ZR,[(m(!0),y(Te,null,Ne(De.value.areas,le=>(m(),y("span",{key:le.areaId,class:"area-lead-badge",style:Dt({backgroundColor:le.color||"#667eea"})},w(le.name),5))),128))])):F("",!0)]),c("span",jR,w(E.value==="areaLead"?"":"+"),1)],2),E.value==="areaLead"?(m(),y("div",WR,[Ve(LO,{ref_key:"areaLeadRef",ref:De,"event-id":V(s).params.eventId,"area-ids":b.value,"marshal-id":p.value,route:Ce.value,onChecklistUpdated:Jt},null,8,["event-id","area-ids","marshal-id","route"])])):F("",!0)])):F("",!0),x.value?.eventDate||x.value?.description?(m(),y("div",qR,[c("button",{class:Ae(["accordion-header",{active:E.value==="eventDetails"}]),onClick:ee[7]||(ee[7]=le=>U("eventDetails"))},[c("span",GR,[c("span",{class:"section-icon",innerHTML:V(xn)("event")},null,8,KR),ee[27]||(ee[27]=We(" Event details ",-1))]),c("span",YR,w(E.value==="eventDetails"?"":"+"),1)],2),E.value==="eventDetails"?(m(),y("div",JR,[c("div",XR,[x.value.eventDate?(m(),y("div",QR,[ee[28]||(ee[28]=c("span",{class:"detail-label"},"Date and time",-1)),c("span",e5,w(Et(x.value.eventDate)),1)])):F("",!0),x.value.description?(m(),y("div",t5,[ee[29]||(ee[29]=c("span",{class:"detail-label"},"Description",-1)),c("p",n5,w(x.value.description),1)])):F("",!0)])])):F("",!0)])):F("",!0)])]))]),Ve(uD,{show:Se.value,contacts:H.value,notes:Fe.value,onClose:ee[8]||(ee[8]=le=>Se.value=!1)},null,8,["show","contacts","notes"]),Ve(_l,{show:Ee.value,title:se.value,message:me.value,onConfirm:_s,onCancel:Gs},null,8,["show","title","message"]),fe.value?(m(),y("div",{key:0,class:"modal-overlay",onClick:St(ln,["self"])},[c("div",o5,[c("div",s5,[c("h3",null,"Update "+w((q.value?.location?.resolvedCheckpointTerm||V(t).checkpoint).toLowerCase())+" location",1),c("button",{class:"modal-close",onClick:ln},"")]),c("div",i5,[ue.value?(m(),y("div",a5,w(ue.value),1)):(m(),y("div",r5,[c("p",l5,[ee[30]||(ee[30]=We(" Update the position of ",-1)),c("strong",null,w(q.value?.location?.name),1)]),q.value?.location?.lastLocationUpdate?(m(),y("div",c5," Last updated: "+w(bs(q.value.location.lastLocationUpdate)),1)):F("",!0),de.value?(m(),y("div",u5,[...ee[31]||(ee[31]=[c("svg",{class:"status-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),We(" GPS active ",-1)])])):F("",!0),c("div",d5,[c("button",{onClick:to,class:"btn btn-primary btn-full",disabled:K.value},[ee[32]||(ee[32]=c("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),We(" "+w(K.value?"Updating...":"Use current GPS location"),1)],8,h5)]),c("div",f5,[c("label",p5,[c("input",{type:"checkbox",checked:pe.value,onChange:ee[9]||(ee[9]=le=>qo(q.value))},null,40,v5),ee[33]||(ee[33]=c("span",null,"Auto-update every 60 seconds",-1))]),c("p",m5,"Automatically updates the "+w(V(o).checkpoint)+" location using your GPS every minute.",1)]),c("div",g5,[c("button",{onClick:ks,class:"btn btn-secondary btn-full",disabled:K.value},[...ee[34]||(ee[34]=[c("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"})],-1),We(" Select location on map ",-1)])],8,y5)]),c("div",_5,[c("label",k5,"Or copy location from another "+w(V(o).checkpoint)+":",1),ot.value.length>0?(m(),y("div",b5,[(m(!0),y(Te,null,Ne(ot.value,le=>(m(),y("button",{key:le.id,onClick:be=>vo(le.id),class:"btn btn-secondary btn-checkpoint-source",disabled:K.value},w(le.name),9,w5))),128))])):(m(),y("p",C5," No other "+w(V(o).checkpoints)+" available to copy from. ",1))]),j.value?(m(),y("div",L5,w(j.value),1)):F("",!0)]))]),c("div",{class:"modal-footer"},[c("button",{onClick:ln,class:"btn btn-secondary"}," Cancel ")])])])):F("",!0)]))}},x5=Xe(S5,[["__scopeId","data-v-6ea102a6"]]),T5=[{path:"/",name:"Home",component:l_},{path:"/admin/login",name:"AdminLogin",component:tk},{path:"/admin/verify",name:"AdminVerify",component:lk},{path:"/admin/dashboard",name:"AdminDashboard",component:nb,meta:{requiresAuth:!0}},{path:"/admin/profile",name:"AdminProfile",component:Ib,meta:{requiresAuth:!0}},{path:"/admin/event/:eventId",name:"AdminEventManage",component:W3,meta:{requiresAuth:!0}},{path:"/event/:eventId",name:"MarshalView",component:x5},{path:"/:pathMatch(.*)*",redirect:"/"}],Dp=n_({history:Dy("/VolunteerCheckin/testing/"),routes:T5});Dp.beforeEach((e,t,o)=>{const i=localStorage.getItem("adminEmail");e.meta.requiresAuth&&!i?o({name:"AdminLogin"}):o()});Zo().then(()=>{console.log("Offline database initialized")}).catch(e=>{console.warn("Failed to initialize offline database:",e)});const hu=Bg(Kg);hu.use(zg());hu.use(Dp);hu.mount("#app");
