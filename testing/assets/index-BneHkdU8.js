(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function o(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=o(n);fetch(n.href,i)}})();function vd(e){const t=Object.create(null);for(const o of e.split(","))t[o]=1;return o=>o in t}const Zt={},Xi=[],Wo=()=>{},Pp=()=>!1,uc=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),md=e=>e.startsWith("onUpdate:"),Cn=Object.assign,gd=(e,t)=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},Ug=Object.prototype.hasOwnProperty,Ot=(e,t)=>Ug.call(e,t),rt=Array.isArray,Qi=e=>ar(e)==="[object Map]",rl=e=>ar(e)==="[object Set]",hh=e=>ar(e)==="[object Date]",vt=e=>typeof e=="function",an=e=>typeof e=="string",Yo=e=>typeof e=="symbol",zt=e=>e!==null&&typeof e=="object",Dp=e=>(zt(e)||vt(e))&&vt(e.then)&&vt(e.catch),Rp=Object.prototype.toString,ar=e=>Rp.call(e),zg=e=>ar(e).slice(8,-1),Op=e=>ar(e)==="[object Object]",dc=e=>an(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Dl=vd(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),hc=e=>{const t=Object.create(null);return(o=>t[o]||(t[o]=e(o)))},Hg=/-\w/g,Ao=hc(e=>e.replace(Hg,t=>t.slice(1).toUpperCase())),Vg=/\B([A-Z])/g,Ra=hc(e=>e.replace(Vg,"-$1").toLowerCase()),fc=hc(e=>e.charAt(0).toUpperCase()+e.slice(1)),Hc=hc(e=>e?`on${fc(e)}`:""),Ta=(e,t)=>!Object.is(e,t),Pr=(e,...t)=>{for(let o=0;o<e.length;o++)e[o](...t)},Bp=(e,t,o,a=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:a,value:o})},pc=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Gg=e=>{const t=an(e)?Number(e):NaN;return isNaN(t)?e:t};let fh;const vc=()=>fh||(fh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Qe(e){if(rt(e)){const t={};for(let o=0;o<e.length;o++){const a=e[o],n=an(a)?Wg(a):Qe(a);if(n)for(const i in n)t[i]=n[i]}return t}else if(an(e)||zt(e))return e}const qg=/;(?![^(]*\))/g,jg=/:([^]+)/,Zg=/\/\*[^]*?\*\//g;function Wg(e){const t={};return e.replace(Zg,"").split(qg).forEach(o=>{if(o){const a=o.split(jg);a.length>1&&(t[a[0].trim()]=a[1].trim())}}),t}function ve(e){let t="";if(an(e))t=e;else if(rt(e))for(let o=0;o<e.length;o++){const a=ve(e[o]);a&&(t+=a+" ")}else if(zt(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}const Kg="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Jg=vd(Kg);function Np(e){return!!e||e===""}function Yg(e,t){if(e.length!==t.length)return!1;let o=!0;for(let a=0;o&&a<e.length;a++)o=yi(e[a],t[a]);return o}function yi(e,t){if(e===t)return!0;let o=hh(e),a=hh(t);if(o||a)return o&&a?e.getTime()===t.getTime():!1;if(o=Yo(e),a=Yo(t),o||a)return e===t;if(o=rt(e),a=rt(t),o||a)return o&&a?Yg(e,t):!1;if(o=zt(e),a=zt(t),o||a){if(!o||!a)return!1;const n=Object.keys(e).length,i=Object.keys(t).length;if(n!==i)return!1;for(const l in e){const u=e.hasOwnProperty(l),d=t.hasOwnProperty(l);if(u&&!d||!u&&d||!yi(e[l],t[l]))return!1}}return String(e)===String(t)}function yd(e,t){return e.findIndex(o=>yi(o,t))}const Fp=e=>!!(e&&e.__v_isRef===!0),I=e=>an(e)?e:e==null?"":rt(e)||zt(e)&&(e.toString===Rp||!vt(e.toString))?Fp(e)?I(e.value):JSON.stringify(e,Up,2):String(e),Up=(e,t)=>Fp(t)?Up(e,t.value):Qi(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((o,[a,n],i)=>(o[Vc(a,i)+" =>"]=n,o),{})}:rl(t)?{[`Set(${t.size})`]:[...t.values()].map(o=>Vc(o))}:Yo(t)?Vc(t):zt(t)&&!rt(t)&&!Op(t)?String(t):t,Vc=(e,t="")=>{var o;return Yo(e)?`Symbol(${(o=e.description)!=null?o:t})`:e};function Xg(e){return e==null?"initial":typeof e=="string"?e===""?" ":e:String(e)}let Rn;class zp{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Rn,!t&&Rn&&(this.index=(Rn.scopes||(Rn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].pause();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].resume();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].resume()}}run(t){if(this._active){const o=Rn;try{return Rn=this,t()}finally{Rn=o}}}on(){++this._on===1&&(this.prevScope=Rn,Rn=this)}off(){this._on>0&&--this._on===0&&(Rn=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let o,a;for(o=0,a=this.effects.length;o<a;o++)this.effects[o].stop();for(this.effects.length=0,o=0,a=this.cleanups.length;o<a;o++)this.cleanups[o]();if(this.cleanups.length=0,this.scopes){for(o=0,a=this.scopes.length;o<a;o++)this.scopes[o].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0}}}function Hp(e){return new zp(e)}function Vp(){return Rn}function Qg(e,t=!1){Rn&&Rn.cleanups.push(e)}let Xt;const Gc=new WeakSet;class Gp{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Rn&&Rn.active&&Rn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Gc.has(this)&&(Gc.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||jp(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,ph(this),Zp(this);const t=Xt,o=Ko;Xt=this,Ko=!0;try{return this.fn()}finally{Wp(this),Xt=t,Ko=o,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)_d(t);this.deps=this.depsTail=void 0,ph(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Gc.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Ru(this)&&this.run()}get dirty(){return Ru(this)}}let qp=0,Rl,Ol;function jp(e,t=!1){if(e.flags|=8,t){e.next=Ol,Ol=e;return}e.next=Rl,Rl=e}function kd(){qp++}function bd(){if(--qp>0)return;if(Ol){let t=Ol;for(Ol=void 0;t;){const o=t.next;t.next=void 0,t.flags&=-9,t=o}}let e;for(;Rl;){let t=Rl;for(Rl=void 0;t;){const o=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(a){e||(e=a)}t=o}}if(e)throw e}function Zp(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Wp(e){let t,o=e.depsTail,a=o;for(;a;){const n=a.prevDep;a.version===-1?(a===o&&(o=n),_d(a),ey(a)):t=a,a.dep.activeLink=a.prevActiveLink,a.prevActiveLink=void 0,a=n}e.deps=t,e.depsTail=o}function Ru(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Kp(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Kp(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===jl)||(e.globalVersion=jl,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!Ru(e))))return;e.flags|=2;const t=e.dep,o=Xt,a=Ko;Xt=e,Ko=!0;try{Zp(e);const n=e.fn(e._value);(t.version===0||Ta(n,e._value))&&(e.flags|=128,e._value=n,t.version++)}catch(n){throw t.version++,n}finally{Xt=o,Ko=a,Wp(e),e.flags&=-3}}function _d(e,t=!1){const{dep:o,prevSub:a,nextSub:n}=e;if(a&&(a.nextSub=n,e.prevSub=void 0),n&&(n.prevSub=a,e.nextSub=void 0),o.subs===e&&(o.subs=a,!a&&o.computed)){o.computed.flags&=-5;for(let i=o.computed.deps;i;i=i.nextDep)_d(i,!0)}!t&&!--o.sc&&o.map&&o.map.delete(o.key)}function ey(e){const{prevDep:t,nextDep:o}=e;t&&(t.nextDep=o,e.prevDep=void 0),o&&(o.prevDep=t,e.nextDep=void 0)}let Ko=!0;const Jp=[];function Gs(){Jp.push(Ko),Ko=!1}function qs(){const e=Jp.pop();Ko=e===void 0?!0:e}function ph(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const o=Xt;Xt=void 0;try{t()}finally{Xt=o}}}let jl=0;class ty{constructor(t,o){this.sub=t,this.dep=o,this.version=o.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class wd{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!Xt||!Ko||Xt===this.computed)return;let o=this.activeLink;if(o===void 0||o.sub!==Xt)o=this.activeLink=new ty(Xt,this),Xt.deps?(o.prevDep=Xt.depsTail,Xt.depsTail.nextDep=o,Xt.depsTail=o):Xt.deps=Xt.depsTail=o,Yp(o);else if(o.version===-1&&(o.version=this.version,o.nextDep)){const a=o.nextDep;a.prevDep=o.prevDep,o.prevDep&&(o.prevDep.nextDep=a),o.prevDep=Xt.depsTail,o.nextDep=void 0,Xt.depsTail.nextDep=o,Xt.depsTail=o,Xt.deps===o&&(Xt.deps=a)}return o}trigger(t){this.version++,jl++,this.notify(t)}notify(t){kd();try{for(let o=this.subs;o;o=o.prevSub)o.sub.notify()&&o.sub.dep.notify()}finally{bd()}}}function Yp(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let a=t.deps;a;a=a.nextDep)Yp(a)}const o=e.dep.subs;o!==e&&(e.prevSub=o,o&&(o.nextSub=e)),e.dep.subs=e}}const Hr=new WeakMap,pi=Symbol(""),Ou=Symbol(""),Zl=Symbol("");function Nn(e,t,o){if(Ko&&Xt){let a=Hr.get(e);a||Hr.set(e,a=new Map);let n=a.get(o);n||(a.set(o,n=new wd),n.map=a,n.key=o),n.track()}}function Os(e,t,o,a,n,i){const l=Hr.get(e);if(!l){jl++;return}const u=d=>{d&&d.trigger()};if(kd(),t==="clear")l.forEach(u);else{const d=rt(e),h=d&&dc(o);if(d&&o==="length"){const f=Number(a);l.forEach((m,y)=>{(y==="length"||y===Zl||!Yo(y)&&y>=f)&&u(m)})}else switch((o!==void 0||l.has(void 0))&&u(l.get(o)),h&&u(l.get(Zl)),t){case"add":d?h&&u(l.get("length")):(u(l.get(pi)),Qi(e)&&u(l.get(Ou)));break;case"delete":d||(u(l.get(pi)),Qi(e)&&u(l.get(Ou)));break;case"set":Qi(e)&&u(l.get(pi));break}}bd()}function ny(e,t){const o=Hr.get(e);return o&&o.get(t)}function Gi(e){const t=At(e);return t===e?t:(Nn(t,"iterate",Zl),ko(e)?t:t.map(Xo))}function mc(e){return Nn(e=At(e),"iterate",Zl),e}function wa(e,t){return js(e)?Vs(e)?ol(Xo(t)):ol(t):Xo(t)}const oy={__proto__:null,[Symbol.iterator](){return qc(this,Symbol.iterator,e=>wa(this,e))},concat(...e){return Gi(this).concat(...e.map(t=>rt(t)?Gi(t):t))},entries(){return qc(this,"entries",e=>(e[1]=wa(this,e[1]),e))},every(e,t){return As(this,"every",e,t,void 0,arguments)},filter(e,t){return As(this,"filter",e,t,o=>o.map(a=>wa(this,a)),arguments)},find(e,t){return As(this,"find",e,t,o=>wa(this,o),arguments)},findIndex(e,t){return As(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return As(this,"findLast",e,t,o=>wa(this,o),arguments)},findLastIndex(e,t){return As(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return As(this,"forEach",e,t,void 0,arguments)},includes(...e){return jc(this,"includes",e)},indexOf(...e){return jc(this,"indexOf",e)},join(e){return Gi(this).join(e)},lastIndexOf(...e){return jc(this,"lastIndexOf",e)},map(e,t){return As(this,"map",e,t,void 0,arguments)},pop(){return Ll(this,"pop")},push(...e){return Ll(this,"push",e)},reduce(e,...t){return vh(this,"reduce",e,t)},reduceRight(e,...t){return vh(this,"reduceRight",e,t)},shift(){return Ll(this,"shift")},some(e,t){return As(this,"some",e,t,void 0,arguments)},splice(...e){return Ll(this,"splice",e)},toReversed(){return Gi(this).toReversed()},toSorted(e){return Gi(this).toSorted(e)},toSpliced(...e){return Gi(this).toSpliced(...e)},unshift(...e){return Ll(this,"unshift",e)},values(){return qc(this,"values",e=>wa(this,e))}};function qc(e,t,o){const a=mc(e),n=a[t]();return a!==e&&!ko(e)&&(n._next=n.next,n.next=()=>{const i=n._next();return i.done||(i.value=o(i.value)),i}),n}const sy=Array.prototype;function As(e,t,o,a,n,i){const l=mc(e),u=l!==e&&!ko(e),d=l[t];if(d!==sy[t]){const m=d.apply(e,i);return u?Xo(m):m}let h=o;l!==e&&(u?h=function(m,y){return o.call(this,wa(e,m),y,e)}:o.length>2&&(h=function(m,y){return o.call(this,m,y,e)}));const f=d.call(l,h,a);return u&&n?n(f):f}function vh(e,t,o,a){const n=mc(e);let i=o;return n!==e&&(ko(e)?o.length>3&&(i=function(l,u,d){return o.call(this,l,u,d,e)}):i=function(l,u,d){return o.call(this,l,wa(e,u),d,e)}),n[t](i,...a)}function jc(e,t,o){const a=At(e);Nn(a,"iterate",Zl);const n=a[t](...o);return(n===-1||n===!1)&&gc(o[0])?(o[0]=At(o[0]),a[t](...o)):n}function Ll(e,t,o=[]){Gs(),kd();const a=At(e)[t].apply(e,o);return bd(),qs(),a}const ay=vd("__proto__,__v_isRef,__isVue"),Xp=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Yo));function iy(e){Yo(e)||(e=String(e));const t=At(this);return Nn(t,"has",e),t.hasOwnProperty(e)}class Qp{constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,a){if(o==="__v_skip")return t.__v_skip;const n=this._isReadonly,i=this._isShallow;if(o==="__v_isReactive")return!n;if(o==="__v_isReadonly")return n;if(o==="__v_isShallow")return i;if(o==="__v_raw")return a===(n?i?my:ov:i?nv:tv).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(a)?t:void 0;const l=rt(t);if(!n){let d;if(l&&(d=oy[o]))return d;if(o==="hasOwnProperty")return iy}const u=Reflect.get(t,o,sn(t)?t:a);if((Yo(o)?Xp.has(o):ay(o))||(n||Nn(t,"get",o),i))return u;if(sn(u)){const d=l&&dc(o)?u:u.value;return n&&zt(d)?Nu(d):d}return zt(u)?n?Nu(u):bi(u):u}}class ev extends Qp{constructor(t=!1){super(!1,t)}set(t,o,a,n){let i=t[o];const l=rt(t)&&dc(o);if(!this._isShallow){const h=js(i);if(!ko(a)&&!js(a)&&(i=At(i),a=At(a)),!l&&sn(i)&&!sn(a))return h||(i.value=a),!0}const u=l?Number(o)<t.length:Ot(t,o),d=Reflect.set(t,o,a,sn(t)?t:n);return t===At(n)&&(u?Ta(a,i)&&Os(t,"set",o,a):Os(t,"add",o,a)),d}deleteProperty(t,o){const a=Ot(t,o);t[o];const n=Reflect.deleteProperty(t,o);return n&&a&&Os(t,"delete",o,void 0),n}has(t,o){const a=Reflect.has(t,o);return(!Yo(o)||!Xp.has(o))&&Nn(t,"has",o),a}ownKeys(t){return Nn(t,"iterate",rt(t)?"length":pi),Reflect.ownKeys(t)}}class ly extends Qp{constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const ry=new ev,cy=new ly,uy=new ev(!0);const Bu=e=>e,Cr=e=>Reflect.getPrototypeOf(e);function dy(e,t,o){return function(...a){const n=this.__v_raw,i=At(n),l=Qi(i),u=e==="entries"||e===Symbol.iterator&&l,d=e==="keys"&&l,h=n[e](...a),f=o?Bu:t?ol:Xo;return!t&&Nn(i,"iterate",d?Ou:pi),{next(){const{value:m,done:y}=h.next();return y?{value:m,done:y}:{value:u?[f(m[0]),f(m[1])]:f(m),done:y}},[Symbol.iterator](){return this}}}}function Lr(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function hy(e,t){const o={get(n){const i=this.__v_raw,l=At(i),u=At(n);e||(Ta(n,u)&&Nn(l,"get",n),Nn(l,"get",u));const{has:d}=Cr(l),h=t?Bu:e?ol:Xo;if(d.call(l,n))return h(i.get(n));if(d.call(l,u))return h(i.get(u));i!==l&&i.get(n)},get size(){const n=this.__v_raw;return!e&&Nn(At(n),"iterate",pi),n.size},has(n){const i=this.__v_raw,l=At(i),u=At(n);return e||(Ta(n,u)&&Nn(l,"has",n),Nn(l,"has",u)),n===u?i.has(n):i.has(n)||i.has(u)},forEach(n,i){const l=this,u=l.__v_raw,d=At(u),h=t?Bu:e?ol:Xo;return!e&&Nn(d,"iterate",pi),u.forEach((f,m)=>n.call(i,h(f),h(m),l))}};return Cn(o,e?{add:Lr("add"),set:Lr("set"),delete:Lr("delete"),clear:Lr("clear")}:{add(n){!t&&!ko(n)&&!js(n)&&(n=At(n));const i=At(this);return Cr(i).has.call(i,n)||(i.add(n),Os(i,"add",n,n)),this},set(n,i){!t&&!ko(i)&&!js(i)&&(i=At(i));const l=At(this),{has:u,get:d}=Cr(l);let h=u.call(l,n);h||(n=At(n),h=u.call(l,n));const f=d.call(l,n);return l.set(n,i),h?Ta(i,f)&&Os(l,"set",n,i):Os(l,"add",n,i),this},delete(n){const i=At(this),{has:l,get:u}=Cr(i);let d=l.call(i,n);d||(n=At(n),d=l.call(i,n)),u&&u.call(i,n);const h=i.delete(n);return d&&Os(i,"delete",n,void 0),h},clear(){const n=At(this),i=n.size!==0,l=n.clear();return i&&Os(n,"clear",void 0,void 0),l}}),["keys","values","entries",Symbol.iterator].forEach(n=>{o[n]=dy(n,e,t)}),o}function Cd(e,t){const o=hy(e,t);return(a,n,i)=>n==="__v_isReactive"?!e:n==="__v_isReadonly"?e:n==="__v_raw"?a:Reflect.get(Ot(o,n)&&n in a?o:a,n,i)}const fy={get:Cd(!1,!1)},py={get:Cd(!1,!0)},vy={get:Cd(!0,!1)};const tv=new WeakMap,nv=new WeakMap,ov=new WeakMap,my=new WeakMap;function gy(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function yy(e){return e.__v_skip||!Object.isExtensible(e)?0:gy(zg(e))}function bi(e){return js(e)?e:Ld(e,!1,ry,fy,tv)}function sv(e){return Ld(e,!1,uy,py,nv)}function Nu(e){return Ld(e,!0,cy,vy,ov)}function Ld(e,t,o,a,n){if(!zt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=yy(e);if(i===0)return e;const l=n.get(e);if(l)return l;const u=new Proxy(e,i===2?a:o);return n.set(e,u),u}function Vs(e){return js(e)?Vs(e.__v_raw):!!(e&&e.__v_isReactive)}function js(e){return!!(e&&e.__v_isReadonly)}function ko(e){return!!(e&&e.__v_isShallow)}function gc(e){return e?!!e.__v_raw:!1}function At(e){const t=e&&e.__v_raw;return t?At(t):e}function Sd(e){return!Ot(e,"__v_skip")&&Object.isExtensible(e)&&Bp(e,"__v_skip",!0),e}const Xo=e=>zt(e)?bi(e):e,ol=e=>zt(e)?Nu(e):e;function sn(e){return e?e.__v_isRef===!0:!1}function A(e){return av(e,!1)}function ky(e){return av(e,!0)}function av(e,t){return sn(e)?e:new by(e,t)}class by{constructor(t,o){this.dep=new wd,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=o?t:At(t),this._value=o?t:Xo(t),this.__v_isShallow=o}get value(){return this.dep.track(),this._value}set value(t){const o=this._rawValue,a=this.__v_isShallow||ko(t)||js(t);t=a?t:At(t),Ta(t,o)&&(this._rawValue=t,this._value=a?t:Xo(t),this.dep.trigger())}}function N(e){return sn(e)?e.value:e}function Vr(e){return vt(e)?e():N(e)}const _y={get:(e,t,o)=>t==="__v_raw"?e:N(Reflect.get(e,t,o)),set:(e,t,o,a)=>{const n=e[t];return sn(n)&&!sn(o)?(n.value=o,!0):Reflect.set(e,t,o,a)}};function iv(e){return Vs(e)?e:new Proxy(e,_y)}function wy(e){const t=rt(e)?new Array(e.length):{};for(const o in e)t[o]=Ly(e,o);return t}class Cy{constructor(t,o,a){this._object=t,this._key=o,this._defaultValue=a,this.__v_isRef=!0,this._value=void 0,this._raw=At(t);let n=!0,i=t;if(!rt(t)||!dc(String(o)))do n=!gc(i)||ko(i);while(n&&(i=i.__v_raw));this._shallow=n}get value(){let t=this._object[this._key];return this._shallow&&(t=N(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&sn(this._raw[this._key])){const o=this._object[this._key];if(sn(o)){o.value=t;return}}this._object[this._key]=t}get dep(){return ny(this._raw,this._key)}}function Ly(e,t,o){return new Cy(e,t,o)}class Sy{constructor(t,o,a){this.fn=t,this.setter=o,this._value=void 0,this.dep=new wd(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=jl-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!o,this.isSSR=a}notify(){if(this.flags|=16,!(this.flags&8)&&Xt!==this)return jp(this,!0),!0}get value(){const t=this.dep.track();return Kp(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Iy(e,t,o=!1){let a,n;return vt(e)?a=e:(a=e.get,n=e.set),new Sy(a,n,o)}const Sr={},Gr=new WeakMap;let li;function xy(e,t=!1,o=li){if(o){let a=Gr.get(o);a||Gr.set(o,a=[]),a.push(e)}}function $y(e,t,o=Zt){const{immediate:a,deep:n,once:i,scheduler:l,augmentJob:u,call:d}=o,h=$=>n?$:ko($)||n===!1||n===0?Bs($,1):Bs($);let f,m,y,k,w=!1,S=!1;if(sn(e)?(m=()=>e.value,w=ko(e)):Vs(e)?(m=()=>h(e),w=!0):rt(e)?(S=!0,w=e.some($=>Vs($)||ko($)),m=()=>e.map($=>{if(sn($))return $.value;if(Vs($))return h($);if(vt($))return d?d($,2):$()})):vt(e)?t?m=d?()=>d(e,2):e:m=()=>{if(y){Gs();try{y()}finally{qs()}}const $=li;li=f;try{return d?d(e,3,[k]):e(k)}finally{li=$}}:m=Wo,t&&n){const $=m,M=n===!0?1/0:n;m=()=>Bs($(),M)}const T=Vp(),x=()=>{f.stop(),T&&T.active&&gd(T.effects,f)};if(i&&t){const $=t;t=(...M)=>{$(...M),x()}}let C=S?new Array(e.length).fill(Sr):Sr;const _=$=>{if(!(!(f.flags&1)||!f.dirty&&!$))if(t){const M=f.run();if(n||w||(S?M.some((H,E)=>Ta(H,C[E])):Ta(M,C))){y&&y();const H=li;li=f;try{const E=[M,C===Sr?void 0:S&&C[0]===Sr?[]:C,k];C=M,d?d(t,3,E):t(...E)}finally{li=H}}}else f.run()};return u&&u(_),f=new Gp(m),f.scheduler=l?()=>l(_,!1):_,k=$=>xy($,!1,f),y=f.onStop=()=>{const $=Gr.get(f);if($){if(d)d($,4);else for(const M of $)M();Gr.delete(f)}},t?a?_(!0):C=f.run():l?l(_.bind(null,!0),!0):f.run(),x.pause=f.pause.bind(f),x.resume=f.resume.bind(f),x.stop=x,x}function Bs(e,t=1/0,o){if(t<=0||!zt(e)||e.__v_skip||(o=o||new Map,(o.get(e)||0)>=t))return e;if(o.set(e,t),t--,sn(e))Bs(e.value,t,o);else if(rt(e))for(let a=0;a<e.length;a++)Bs(e[a],t,o);else if(rl(e)||Qi(e))e.forEach(a=>{Bs(a,t,o)});else if(Op(e)){for(const a in e)Bs(e[a],t,o);for(const a of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,a)&&Bs(e[a],t,o)}return e}function ir(e,t,o,a){try{return a?e(...a):e()}catch(n){yc(n,t,o)}}function Qo(e,t,o,a){if(vt(e)){const n=ir(e,t,o,a);return n&&Dp(n)&&n.catch(i=>{yc(i,t,o)}),n}if(rt(e)){const n=[];for(let i=0;i<e.length;i++)n.push(Qo(e[i],t,o,a));return n}}function yc(e,t,o,a=!0){const n=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:l}=t&&t.appContext.config||Zt;if(t){let u=t.parent;const d=t.proxy,h=`https://vuejs.org/error-reference/#runtime-${o}`;for(;u;){const f=u.ec;if(f){for(let m=0;m<f.length;m++)if(f[m](e,d,h)===!1)return}u=u.parent}if(i){Gs(),ir(i,null,10,[e,d,h]),qs();return}}Ty(e,o,n,a,l)}function Ty(e,t,o,a=!0,n=!1){if(n)throw e;console.error(e)}const Yn=[];let hs=-1;const el=[];let Ca=null,Zi=0;const lv=Promise.resolve();let qr=null;function cn(e){const t=qr||lv;return e?t.then(this?e.bind(this):e):t}function My(e){let t=hs+1,o=Yn.length;for(;t<o;){const a=t+o>>>1,n=Yn[a],i=Wl(n);i<e||i===e&&n.flags&2?t=a+1:o=a}return t}function Id(e){if(!(e.flags&1)){const t=Wl(e),o=Yn[Yn.length-1];!o||!(e.flags&2)&&t>=Wl(o)?Yn.push(e):Yn.splice(My(t),0,e),e.flags|=1,rv()}}function rv(){qr||(qr=lv.then(dv))}function cv(e){rt(e)?el.push(...e):Ca&&e.id===-1?Ca.splice(Zi+1,0,e):e.flags&1||(el.push(e),e.flags|=1),rv()}function mh(e,t,o=hs+1){for(;o<Yn.length;o++){const a=Yn[o];if(a&&a.flags&2){if(e&&a.id!==e.uid)continue;Yn.splice(o,1),o--,a.flags&4&&(a.flags&=-2),a(),a.flags&4||(a.flags&=-2)}}}function uv(e){if(el.length){const t=[...new Set(el)].sort((o,a)=>Wl(o)-Wl(a));if(el.length=0,Ca){Ca.push(...t);return}for(Ca=t,Zi=0;Zi<Ca.length;Zi++){const o=Ca[Zi];o.flags&4&&(o.flags&=-2),o.flags&8||o(),o.flags&=-2}Ca=null,Zi=0}}const Wl=e=>e.id==null?e.flags&2?-1:1/0:e.id;function dv(e){try{for(hs=0;hs<Yn.length;hs++){const t=Yn[hs];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),ir(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;hs<Yn.length;hs++){const t=Yn[hs];t&&(t.flags&=-2)}hs=-1,Yn.length=0,uv(),qr=null,(Yn.length||el.length)&&dv()}}let Mn=null,hv=null;function jr(e){const t=Mn;return Mn=e,hv=e&&e.type.__scopeId||null,t}function Fe(e,t=Mn,o){if(!t||e._n)return e;const a=(...n)=>{a._d&&Kr(-1);const i=jr(t);let l;try{l=e(...n)}finally{jr(i),a._d&&Kr(1)}return l};return a._n=!0,a._c=!0,a._d=!0,a}function ze(e,t){if(Mn===null)return e;const o=Lc(Mn),a=e.dirs||(e.dirs=[]);for(let n=0;n<t.length;n++){let[i,l,u,d=Zt]=t[n];i&&(vt(i)&&(i={mounted:i,updated:i}),i.deep&&Bs(l),a.push({dir:i,instance:o,value:l,oldValue:void 0,arg:u,modifiers:d}))}return e}function ni(e,t,o,a){const n=e.dirs,i=t&&t.dirs;for(let l=0;l<n.length;l++){const u=n[l];i&&(u.oldValue=i[l].value);let d=u.dir[a];d&&(Gs(),Qo(d,o,8,[e.el,u,e,t]),qs())}}function Bl(e,t){if(Un){let o=Un.provides;const a=Un.parent&&Un.parent.provides;a===o&&(o=Un.provides=Object.create(a)),o[e]=t}}function io(e,t,o=!1){const a=Cc();if(a||vi){let n=vi?vi._context.provides:a?a.parent==null||a.ce?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides:void 0;if(n&&e in n)return n[e];if(arguments.length>1)return o&&vt(t)?t.call(a&&a.proxy):t}}function Ay(){return!!(Cc()||vi)}const Ey=Symbol.for("v-scx"),Py=()=>io(Ey);function We(e,t,o){return fv(e,t,o)}function fv(e,t,o=Zt){const{immediate:a,deep:n,flush:i,once:l}=o,u=Cn({},o),d=t&&a||!t&&i!=="post";let h;if(er){if(i==="sync"){const k=Py();h=k.__watcherHandles||(k.__watcherHandles=[])}else if(!d){const k=()=>{};return k.stop=Wo,k.resume=Wo,k.pause=Wo,k}}const f=Un;u.call=(k,w,S)=>Qo(k,f,w,S);let m=!1;i==="post"?u.scheduler=k=>{Kn(k,f&&f.suspense)}:i!=="sync"&&(m=!0,u.scheduler=(k,w)=>{w?k():Id(k)}),u.augmentJob=k=>{t&&(k.flags|=4),m&&(k.flags|=2,f&&(k.id=f.uid,k.i=f))};const y=$y(e,t,u);return er&&(h?h.push(y):d&&y()),y}function Dy(e,t,o){const a=this.proxy,n=an(e)?e.includes(".")?pv(a,e):()=>a[e]:e.bind(a,a);let i;vt(t)?i=t:(i=t.handler,o=t);const l=lr(this),u=fv(n,i.bind(a),o);return l(),u}function pv(e,t){const o=t.split(".");return()=>{let a=e;for(let n=0;n<o.length&&a;n++)a=a[o[n]];return a}}const vv=Symbol("_vte"),mv=e=>e.__isTeleport,Nl=e=>e&&(e.disabled||e.disabled===""),gh=e=>e&&(e.defer||e.defer===""),yh=e=>typeof SVGElement<"u"&&e instanceof SVGElement,kh=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Fu=(e,t)=>{const o=e&&e.to;return an(o)?t?t(o):null:o},gv={name:"Teleport",__isTeleport:!0,process(e,t,o,a,n,i,l,u,d,h){const{mc:f,pc:m,pbc:y,o:{insert:k,querySelector:w,createText:S,createComment:T}}=h,x=Nl(t.props);let{shapeFlag:C,children:_,dynamicChildren:$}=t;if(e==null){const M=t.el=S(""),H=t.anchor=S("");k(M,o,a),k(H,o,a);const E=(R,U)=>{C&16&&f(_,R,U,n,i,l,u,d)},B=()=>{const R=t.target=Fu(t.props,w),U=yv(R,t,S,k);R&&(l!=="svg"&&yh(R)?l="svg":l!=="mathml"&&kh(R)&&(l="mathml"),n&&n.isCE&&(n.ce._teleportTargets||(n.ce._teleportTargets=new Set)).add(R),x||(E(R,U),Dr(t,!1)))};x&&(E(o,H),Dr(t,!0)),gh(t.props)?(t.el.__isMounted=!1,Kn(()=>{B(),delete t.el.__isMounted},i)):B()}else{if(gh(t.props)&&e.el.__isMounted===!1){Kn(()=>{gv.process(e,t,o,a,n,i,l,u,d,h)},i);return}t.el=e.el,t.targetStart=e.targetStart;const M=t.anchor=e.anchor,H=t.target=e.target,E=t.targetAnchor=e.targetAnchor,B=Nl(e.props),R=B?o:H,U=B?M:E;if(l==="svg"||yh(H)?l="svg":(l==="mathml"||kh(H))&&(l="mathml"),$?(y(e.dynamicChildren,$,R,n,i,l,u),Ad(e,t,!0)):d||m(e,t,R,U,n,i,l,u,!1),x)B?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):Ir(t,o,M,h,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const F=t.target=Fu(t.props,w);F&&Ir(t,F,null,h,0)}else B&&Ir(t,H,E,h,1);Dr(t,x)}},remove(e,t,o,{um:a,o:{remove:n}},i){const{shapeFlag:l,children:u,anchor:d,targetStart:h,targetAnchor:f,target:m,props:y}=e;if(m&&(n(h),n(f)),i&&n(d),l&16){const k=i||!Nl(y);for(let w=0;w<u.length;w++){const S=u[w];a(S,t,o,k,!!S.dynamicChildren)}}},move:Ir,hydrate:Ry};function Ir(e,t,o,{o:{insert:a},m:n},i=2){i===0&&a(e.targetAnchor,t,o);const{el:l,anchor:u,shapeFlag:d,children:h,props:f}=e,m=i===2;if(m&&a(l,t,o),(!m||Nl(f))&&d&16)for(let y=0;y<h.length;y++)n(h[y],t,o,2);m&&a(u,t,o)}function Ry(e,t,o,a,n,i,{o:{nextSibling:l,parentNode:u,querySelector:d,insert:h,createText:f}},m){function y(S,T,x,C){T.anchor=m(l(S),T,u(S),o,a,n,i),T.targetStart=x,T.targetAnchor=C}const k=t.target=Fu(t.props,d),w=Nl(t.props);if(k){const S=k._lpa||k.firstChild;if(t.shapeFlag&16)if(w)y(e,t,S,S&&l(S));else{t.anchor=l(e);let T=S;for(;T;){if(T&&T.nodeType===8){if(T.data==="teleport start anchor")t.targetStart=T;else if(T.data==="teleport anchor"){t.targetAnchor=T,k._lpa=t.targetAnchor&&l(t.targetAnchor);break}}T=l(T)}t.targetAnchor||yv(k,t,f,h),m(S&&l(S),t,k,o,a,n,i)}Dr(t,w)}else w&&t.shapeFlag&16&&y(e,t,e,l(e));return t.anchor&&l(t.anchor)}const Kl=gv;function Dr(e,t){const o=e.ctx;if(o&&o.ut){let a,n;for(t?(a=e.el,n=e.anchor):(a=e.targetStart,n=e.targetAnchor);a&&a!==n;)a.nodeType===1&&a.setAttribute("data-v-owner",o.uid),a=a.nextSibling;o.ut()}}function yv(e,t,o,a){const n=t.targetStart=o(""),i=t.targetAnchor=o("");return n[vv]=i,e&&(a(n,e),a(i,e)),i}const Rs=Symbol("_leaveCb"),xr=Symbol("_enterCb");function Oy(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return ln(()=>{e.isMounted=!0}),$v(()=>{e.isUnmounting=!0}),e}const $o=[Function,Array],kv={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:$o,onEnter:$o,onAfterEnter:$o,onEnterCancelled:$o,onBeforeLeave:$o,onLeave:$o,onAfterLeave:$o,onLeaveCancelled:$o,onBeforeAppear:$o,onAppear:$o,onAfterAppear:$o,onAppearCancelled:$o},bv=e=>{const t=e.subTree;return t.component?bv(t.component):t},By={name:"BaseTransition",props:kv,setup(e,{slots:t}){const o=Cc(),a=Oy();return()=>{const n=t.default&&Cv(t.default(),!0);if(!n||!n.length)return;const i=_v(n),l=At(e),{mode:u}=l;if(a.isLeaving)return Zc(i);const d=bh(i);if(!d)return Zc(i);let h=Uu(d,l,a,o,m=>h=m);d.type!==Fn&&Jl(d,h);let f=o.subTree&&bh(o.subTree);if(f&&f.type!==Fn&&!ri(f,d)&&bv(o).type!==Fn){let m=Uu(f,l,a,o);if(Jl(f,m),u==="out-in"&&d.type!==Fn)return a.isLeaving=!0,m.afterLeave=()=>{a.isLeaving=!1,o.job.flags&8||o.update(),delete m.afterLeave,f=void 0},Zc(i);u==="in-out"&&d.type!==Fn?m.delayLeave=(y,k,w)=>{const S=wv(a,f);S[String(f.key)]=f,y[Rs]=()=>{k(),y[Rs]=void 0,delete h.delayedLeave,f=void 0},h.delayedLeave=()=>{w(),delete h.delayedLeave,f=void 0}}:f=void 0}else f&&(f=void 0);return i}}};function _v(e){let t=e[0];if(e.length>1){for(const o of e)if(o.type!==Fn){t=o;break}}return t}const Ny=By;function wv(e,t){const{leavingVNodes:o}=e;let a=o.get(t.type);return a||(a=Object.create(null),o.set(t.type,a)),a}function Uu(e,t,o,a,n){const{appear:i,mode:l,persisted:u=!1,onBeforeEnter:d,onEnter:h,onAfterEnter:f,onEnterCancelled:m,onBeforeLeave:y,onLeave:k,onAfterLeave:w,onLeaveCancelled:S,onBeforeAppear:T,onAppear:x,onAfterAppear:C,onAppearCancelled:_}=t,$=String(e.key),M=wv(o,e),H=(R,U)=>{R&&Qo(R,a,9,U)},E=(R,U)=>{const F=U[1];H(R,U),rt(R)?R.every(j=>j.length<=1)&&F():R.length<=1&&F()},B={mode:l,persisted:u,beforeEnter(R){let U=d;if(!o.isMounted)if(i)U=T||d;else return;R[Rs]&&R[Rs](!0);const F=M[$];F&&ri(e,F)&&F.el[Rs]&&F.el[Rs](),H(U,[R])},enter(R){let U=h,F=f,j=m;if(!o.isMounted)if(i)U=x||h,F=C||f,j=_||m;else return;let Y=!1;const oe=R[xr]=Oe=>{Y||(Y=!0,Oe?H(j,[R]):H(F,[R]),B.delayedLeave&&B.delayedLeave(),R[xr]=void 0)};U?E(U,[R,oe]):oe()},leave(R,U){const F=String(e.key);if(R[xr]&&R[xr](!0),o.isUnmounting)return U();H(y,[R]);let j=!1;const Y=R[Rs]=oe=>{j||(j=!0,U(),oe?H(S,[R]):H(w,[R]),R[Rs]=void 0,M[F]===e&&delete M[F])};M[F]=e,k?E(k,[R,Y]):Y()},clone(R){const U=Uu(R,t,o,a,n);return n&&n(U),U}};return B}function Zc(e){if(kc(e))return e=Ea(e),e.children=null,e}function bh(e){if(!kc(e))return mv(e.type)&&e.children?_v(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:o}=e;if(o){if(t&16)return o[0];if(t&32&&vt(o.default))return o.default()}}function Jl(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Jl(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Cv(e,t=!1,o){let a=[],n=0;for(let i=0;i<e.length;i++){let l=e[i];const u=o==null?l.key:String(o)+String(l.key!=null?l.key:i);l.type===Ae?(l.patchFlag&128&&n++,a=a.concat(Cv(l.children,t,u))):(t||l.type!==Fn)&&a.push(u!=null?Ea(l,{key:u}):l)}if(n>1)for(let i=0;i<a.length;i++)a[i].patchFlag=-2;return a}function Lv(e,t){return vt(e)?Cn({name:e.name},t,{setup:e}):e}function Sv(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const Zr=new WeakMap;function Fl(e,t,o,a,n=!1){if(rt(e)){e.forEach((w,S)=>Fl(w,t&&(rt(t)?t[S]:t),o,a,n));return}if(tl(a)&&!n){a.shapeFlag&512&&a.type.__asyncResolved&&a.component.subTree.component&&Fl(e,t,o,a.component.subTree);return}const i=a.shapeFlag&4?Lc(a.component):a.el,l=n?null:i,{i:u,r:d}=e,h=t&&t.r,f=u.refs===Zt?u.refs={}:u.refs,m=u.setupState,y=At(m),k=m===Zt?Pp:w=>Ot(y,w);if(h!=null&&h!==d){if(_h(t),an(h))f[h]=null,k(h)&&(m[h]=null);else if(sn(h)){h.value=null;const w=t;w.k&&(f[w.k]=null)}}if(vt(d))ir(d,u,12,[l,f]);else{const w=an(d),S=sn(d);if(w||S){const T=()=>{if(e.f){const x=w?k(d)?m[d]:f[d]:d.value;if(n)rt(x)&&gd(x,i);else if(rt(x))x.includes(i)||x.push(i);else if(w)f[d]=[i],k(d)&&(m[d]=f[d]);else{const C=[i];d.value=C,e.k&&(f[e.k]=C)}}else w?(f[d]=l,k(d)&&(m[d]=l)):S&&(d.value=l,e.k&&(f[e.k]=l))};if(l){const x=()=>{T(),Zr.delete(e)};x.id=-1,Zr.set(e,x),Kn(x,o)}else _h(e),T()}}}function _h(e){const t=Zr.get(e);t&&(t.flags|=8,Zr.delete(e))}vc().requestIdleCallback;vc().cancelIdleCallback;const tl=e=>!!e.type.__asyncLoader,kc=e=>e.type.__isKeepAlive;function Fy(e,t){Iv(e,"a",t)}function Uy(e,t){Iv(e,"da",t)}function Iv(e,t,o=Un){const a=e.__wdc||(e.__wdc=()=>{let n=o;for(;n;){if(n.isDeactivated)return;n=n.parent}return e()});if(bc(t,a,o),o){let n=o.parent;for(;n&&n.parent;)kc(n.parent.vnode)&&zy(a,t,o,n),n=n.parent}}function zy(e,t,o,a){const n=bc(t,e,a,!0);Ln(()=>{gd(a[t],n)},o)}function bc(e,t,o=Un,a=!1){if(o){const n=o[e]||(o[e]=[]),i=t.__weh||(t.__weh=(...l)=>{Gs();const u=lr(o),d=Qo(t,o,e,l);return u(),qs(),d});return a?n.unshift(i):n.push(i),i}}const Ks=e=>(t,o=Un)=>{(!er||e==="sp")&&bc(e,(...a)=>t(...a),o)},Hy=Ks("bm"),ln=Ks("m"),xv=Ks("bu"),Vy=Ks("u"),$v=Ks("bum"),Ln=Ks("um"),Gy=Ks("sp"),qy=Ks("rtg"),jy=Ks("rtc");function Zy(e,t=Un){bc("ec",e,t)}const Tv="components";function xd(e,t){return Av(Tv,e,!0,t)||e}const Mv=Symbol.for("v-ndc");function Wy(e){return an(e)?Av(Tv,e,!1)||e:e||Mv}function Av(e,t,o=!0,a=!1){const n=Mn||Un;if(n){const i=n.type;{const u=A1(i,!1);if(u&&(u===t||u===Ao(t)||u===fc(Ao(t))))return i}const l=wh(n[e]||i[e],t)||wh(n.appContext[e],t);return!l&&a?i:l}}function wh(e,t){return e&&(e[t]||e[Ao(t)]||e[fc(Ao(t))])}function Ue(e,t,o,a){let n;const i=o,l=rt(e);if(l||an(e)){const u=l&&Vs(e);let d=!1,h=!1;u&&(d=!ko(e),h=js(e),e=mc(e)),n=new Array(e.length);for(let f=0,m=e.length;f<m;f++)n[f]=t(d?h?ol(Xo(e[f])):Xo(e[f]):e[f],f,void 0,i)}else if(typeof e=="number"){n=new Array(e);for(let u=0;u<e;u++)n[u]=t(u+1,u,void 0,i)}else if(zt(e))if(e[Symbol.iterator])n=Array.from(e,(u,d)=>t(u,d,void 0,i));else{const u=Object.keys(e);n=new Array(u.length);for(let d=0,h=u.length;d<h;d++){const f=u[d];n[d]=t(e[f],f,d,i)}}else n=[];return n}function $d(e,t){for(let o=0;o<t.length;o++){const a=t[o];if(rt(a))for(let n=0;n<a.length;n++)e[a[n].name]=a[n].fn;else a&&(e[a.name]=a.key?(...n)=>{const i=a.fn(...n);return i&&(i.key=a.key),i}:a.fn)}return e}function ao(e,t,o={},a,n){if(Mn.ce||Mn.parent&&tl(Mn.parent)&&Mn.parent.ce){const h=Object.keys(o).length>0;return t!=="default"&&(o.name=t),v(),Ke(Ae,null,[Me("slot",o,a&&a())],h?-2:64)}let i=e[t];i&&i._c&&(i._d=!1),v();const l=i&&Ev(i(o)),u=o.key||l&&l.key,d=Ke(Ae,{key:(u&&!Yo(u)?u:`_${t}`)+(!l&&a?"_fb":"")},l||(a?a():[]),l&&e._===1?64:-2);return i&&i._c&&(i._d=!0),d}function Ev(e){return e.some(t=>Xl(t)?!(t.type===Fn||t.type===Ae&&!Ev(t.children)):!0)?e:null}const zu=e=>e?Yv(e)?Lc(e):zu(e.parent):null,Ul=Cn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>zu(e.parent),$root:e=>zu(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Dv(e),$forceUpdate:e=>e.f||(e.f=()=>{Id(e.update)}),$nextTick:e=>e.n||(e.n=cn.bind(e.proxy)),$watch:e=>Dy.bind(e)}),Wc=(e,t)=>e!==Zt&&!e.__isScriptSetup&&Ot(e,t),Ky={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:o,setupState:a,data:n,props:i,accessCache:l,type:u,appContext:d}=e;if(t[0]!=="$"){const y=l[t];if(y!==void 0)switch(y){case 1:return a[t];case 2:return n[t];case 4:return o[t];case 3:return i[t]}else{if(Wc(a,t))return l[t]=1,a[t];if(n!==Zt&&Ot(n,t))return l[t]=2,n[t];if(Ot(i,t))return l[t]=3,i[t];if(o!==Zt&&Ot(o,t))return l[t]=4,o[t];Hu&&(l[t]=0)}}const h=Ul[t];let f,m;if(h)return t==="$attrs"&&Nn(e.attrs,"get",""),h(e);if((f=u.__cssModules)&&(f=f[t]))return f;if(o!==Zt&&Ot(o,t))return l[t]=4,o[t];if(m=d.config.globalProperties,Ot(m,t))return m[t]},set({_:e},t,o){const{data:a,setupState:n,ctx:i}=e;return Wc(n,t)?(n[t]=o,!0):a!==Zt&&Ot(a,t)?(a[t]=o,!0):Ot(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=o,!0)},has({_:{data:e,setupState:t,accessCache:o,ctx:a,appContext:n,props:i,type:l}},u){let d;return!!(o[u]||e!==Zt&&u[0]!=="$"&&Ot(e,u)||Wc(t,u)||Ot(i,u)||Ot(a,u)||Ot(Ul,u)||Ot(n.config.globalProperties,u)||(d=l.__cssModules)&&d[u])},defineProperty(e,t,o){return o.get!=null?e._.accessCache[t]=0:Ot(o,"value")&&this.set(e,t,o.value,null),Reflect.defineProperty(e,t,o)}};function Ch(e){return rt(e)?e.reduce((t,o)=>(t[o]=null,t),{}):e}let Hu=!0;function Jy(e){const t=Dv(e),o=e.proxy,a=e.ctx;Hu=!1,t.beforeCreate&&Lh(t.beforeCreate,e,"bc");const{data:n,computed:i,methods:l,watch:u,provide:d,inject:h,created:f,beforeMount:m,mounted:y,beforeUpdate:k,updated:w,activated:S,deactivated:T,beforeDestroy:x,beforeUnmount:C,destroyed:_,unmounted:$,render:M,renderTracked:H,renderTriggered:E,errorCaptured:B,serverPrefetch:R,expose:U,inheritAttrs:F,components:j,directives:Y,filters:oe}=t;if(h&&Yy(h,a,null),l)for(const te in l){const O=l[te];vt(O)&&(a[te]=O.bind(o))}if(n){const te=n.call(o,o);zt(te)&&(e.data=bi(te))}if(Hu=!0,i)for(const te in i){const O=i[te],Z=vt(O)?O.bind(o,o):vt(O.get)?O.get.bind(o,o):Wo,ne=!vt(O)&&vt(O.set)?O.set.bind(o):Wo,pe=V({get:Z,set:ne});Object.defineProperty(a,te,{enumerable:!0,configurable:!0,get:()=>pe.value,set:we=>pe.value=we})}if(u)for(const te in u)Pv(u[te],a,o,te);if(d){const te=vt(d)?d.call(o):d;Reflect.ownKeys(te).forEach(O=>{Bl(O,te[O])})}f&&Lh(f,e,"c");function ee(te,O){rt(O)?O.forEach(Z=>te(Z.bind(o))):O&&te(O.bind(o))}if(ee(Hy,m),ee(ln,y),ee(xv,k),ee(Vy,w),ee(Fy,S),ee(Uy,T),ee(Zy,B),ee(jy,H),ee(qy,E),ee($v,C),ee(Ln,$),ee(Gy,R),rt(U))if(U.length){const te=e.exposed||(e.exposed={});U.forEach(O=>{Object.defineProperty(te,O,{get:()=>o[O],set:Z=>o[O]=Z,enumerable:!0})})}else e.exposed||(e.exposed={});M&&e.render===Wo&&(e.render=M),F!=null&&(e.inheritAttrs=F),j&&(e.components=j),Y&&(e.directives=Y),R&&Sv(e)}function Yy(e,t,o=Wo){rt(e)&&(e=Vu(e));for(const a in e){const n=e[a];let i;zt(n)?"default"in n?i=io(n.from||a,n.default,!0):i=io(n.from||a):i=io(n),sn(i)?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>i.value,set:l=>i.value=l}):t[a]=i}}function Lh(e,t,o){Qo(rt(e)?e.map(a=>a.bind(t.proxy)):e.bind(t.proxy),t,o)}function Pv(e,t,o,a){let n=a.includes(".")?pv(o,a):()=>o[a];if(an(e)){const i=t[e];vt(i)&&We(n,i)}else if(vt(e))We(n,e.bind(o));else if(zt(e))if(rt(e))e.forEach(i=>Pv(i,t,o,a));else{const i=vt(e.handler)?e.handler.bind(o):t[e.handler];vt(i)&&We(n,i,e)}}function Dv(e){const t=e.type,{mixins:o,extends:a}=t,{mixins:n,optionsCache:i,config:{optionMergeStrategies:l}}=e.appContext,u=i.get(t);let d;return u?d=u:!n.length&&!o&&!a?d=t:(d={},n.length&&n.forEach(h=>Wr(d,h,l,!0)),Wr(d,t,l)),zt(t)&&i.set(t,d),d}function Wr(e,t,o,a=!1){const{mixins:n,extends:i}=t;i&&Wr(e,i,o,!0),n&&n.forEach(l=>Wr(e,l,o,!0));for(const l in t)if(!(a&&l==="expose")){const u=Xy[l]||o&&o[l];e[l]=u?u(e[l],t[l]):t[l]}return e}const Xy={data:Sh,props:Ih,emits:Ih,methods:Ml,computed:Ml,beforeCreate:Wn,created:Wn,beforeMount:Wn,mounted:Wn,beforeUpdate:Wn,updated:Wn,beforeDestroy:Wn,beforeUnmount:Wn,destroyed:Wn,unmounted:Wn,activated:Wn,deactivated:Wn,errorCaptured:Wn,serverPrefetch:Wn,components:Ml,directives:Ml,watch:e1,provide:Sh,inject:Qy};function Sh(e,t){return t?e?function(){return Cn(vt(e)?e.call(this,this):e,vt(t)?t.call(this,this):t)}:t:e}function Qy(e,t){return Ml(Vu(e),Vu(t))}function Vu(e){if(rt(e)){const t={};for(let o=0;o<e.length;o++)t[e[o]]=e[o];return t}return e}function Wn(e,t){return e?[...new Set([].concat(e,t))]:t}function Ml(e,t){return e?Cn(Object.create(null),e,t):t}function Ih(e,t){return e?rt(e)&&rt(t)?[...new Set([...e,...t])]:Cn(Object.create(null),Ch(e),Ch(t??{})):t}function e1(e,t){if(!e)return t;if(!t)return e;const o=Cn(Object.create(null),e);for(const a in t)o[a]=Wn(e[a],t[a]);return o}function Rv(){return{app:null,config:{isNativeTag:Pp,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let t1=0;function n1(e,t){return function(a,n=null){vt(a)||(a=Cn({},a)),n!=null&&!zt(n)&&(n=null);const i=Rv(),l=new WeakSet,u=[];let d=!1;const h=i.app={_uid:t1++,_component:a,_props:n,_container:null,_context:i,_instance:null,version:P1,get config(){return i.config},set config(f){},use(f,...m){return l.has(f)||(f&&vt(f.install)?(l.add(f),f.install(h,...m)):vt(f)&&(l.add(f),f(h,...m))),h},mixin(f){return i.mixins.includes(f)||i.mixins.push(f),h},component(f,m){return m?(i.components[f]=m,h):i.components[f]},directive(f,m){return m?(i.directives[f]=m,h):i.directives[f]},mount(f,m,y){if(!d){const k=h._ceVNode||Me(a,n);return k.appContext=i,y===!0?y="svg":y===!1&&(y=void 0),e(k,f,y),d=!0,h._container=f,f.__vue_app__=h,Lc(k.component)}},onUnmount(f){u.push(f)},unmount(){d&&(Qo(u,h._instance,16),e(null,h._container),delete h._container.__vue_app__)},provide(f,m){return i.provides[f]=m,h},runWithContext(f){const m=vi;vi=h;try{return f()}finally{vi=m}}};return h}}let vi=null;const o1=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Ao(t)}Modifiers`]||e[`${Ra(t)}Modifiers`];function s1(e,t,...o){if(e.isUnmounted)return;const a=e.vnode.props||Zt;let n=o;const i=t.startsWith("update:"),l=i&&o1(a,t.slice(7));l&&(l.trim&&(n=o.map(f=>an(f)?f.trim():f)),l.number&&(n=o.map(pc)));let u,d=a[u=Hc(t)]||a[u=Hc(Ao(t))];!d&&i&&(d=a[u=Hc(Ra(t))]),d&&Qo(d,e,6,n);const h=a[u+"Once"];if(h){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,Qo(h,e,6,n)}}const a1=new WeakMap;function Ov(e,t,o=!1){const a=o?a1:t.emitsCache,n=a.get(e);if(n!==void 0)return n;const i=e.emits;let l={},u=!1;if(!vt(e)){const d=h=>{const f=Ov(h,t,!0);f&&(u=!0,Cn(l,f))};!o&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}return!i&&!u?(zt(e)&&a.set(e,null),null):(rt(i)?i.forEach(d=>l[d]=null):Cn(l,i),zt(e)&&a.set(e,l),l)}function _c(e,t){return!e||!uc(t)?!1:(t=t.slice(2).replace(/Once$/,""),Ot(e,t[0].toLowerCase()+t.slice(1))||Ot(e,Ra(t))||Ot(e,t))}function xh(e){const{type:t,vnode:o,proxy:a,withProxy:n,propsOptions:[i],slots:l,attrs:u,emit:d,render:h,renderCache:f,props:m,data:y,setupState:k,ctx:w,inheritAttrs:S}=e,T=jr(e);let x,C;try{if(o.shapeFlag&4){const $=n||a,M=$;x=ps(h.call(M,$,f,m,k,y,w)),C=u}else{const $=t;x=ps($.length>1?$(m,{attrs:u,slots:l,emit:d}):$(m,null)),C=t.props?u:i1(u)}}catch($){Hl.length=0,yc($,e,1),x=Me(Fn)}let _=x;if(C&&S!==!1){const $=Object.keys(C),{shapeFlag:M}=_;$.length&&M&7&&(i&&$.some(md)&&(C=l1(C,i)),_=Ea(_,C,!1,!0))}return o.dirs&&(_=Ea(_,null,!1,!0),_.dirs=_.dirs?_.dirs.concat(o.dirs):o.dirs),o.transition&&Jl(_,o.transition),x=_,jr(T),x}const i1=e=>{let t;for(const o in e)(o==="class"||o==="style"||uc(o))&&((t||(t={}))[o]=e[o]);return t},l1=(e,t)=>{const o={};for(const a in e)(!md(a)||!(a.slice(9)in t))&&(o[a]=e[a]);return o};function r1(e,t,o){const{props:a,children:n,component:i}=e,{props:l,children:u,patchFlag:d}=t,h=i.emitsOptions;if(t.dirs||t.transition)return!0;if(o&&d>=0){if(d&1024)return!0;if(d&16)return a?$h(a,l,h):!!l;if(d&8){const f=t.dynamicProps;for(let m=0;m<f.length;m++){const y=f[m];if(l[y]!==a[y]&&!_c(h,y))return!0}}}else return(n||u)&&(!u||!u.$stable)?!0:a===l?!1:a?l?$h(a,l,h):!0:!!l;return!1}function $h(e,t,o){const a=Object.keys(t);if(a.length!==Object.keys(e).length)return!0;for(let n=0;n<a.length;n++){const i=a[n];if(t[i]!==e[i]&&!_c(o,i))return!0}return!1}function c1({vnode:e,parent:t},o){for(;t;){const a=t.subTree;if(a.suspense&&a.suspense.activeBranch===e&&(a.el=e.el),a===e)(e=t.vnode).el=o,t=t.parent;else break}}const Bv={},Nv=()=>Object.create(Bv),Fv=e=>Object.getPrototypeOf(e)===Bv;function u1(e,t,o,a=!1){const n={},i=Nv();e.propsDefaults=Object.create(null),Uv(e,t,n,i);for(const l in e.propsOptions[0])l in n||(n[l]=void 0);o?e.props=a?n:sv(n):e.type.props?e.props=n:e.props=i,e.attrs=i}function d1(e,t,o,a){const{props:n,attrs:i,vnode:{patchFlag:l}}=e,u=At(n),[d]=e.propsOptions;let h=!1;if((a||l>0)&&!(l&16)){if(l&8){const f=e.vnode.dynamicProps;for(let m=0;m<f.length;m++){let y=f[m];if(_c(e.emitsOptions,y))continue;const k=t[y];if(d)if(Ot(i,y))k!==i[y]&&(i[y]=k,h=!0);else{const w=Ao(y);n[w]=Gu(d,u,w,k,e,!1)}else k!==i[y]&&(i[y]=k,h=!0)}}}else{Uv(e,t,n,i)&&(h=!0);let f;for(const m in u)(!t||!Ot(t,m)&&((f=Ra(m))===m||!Ot(t,f)))&&(d?o&&(o[m]!==void 0||o[f]!==void 0)&&(n[m]=Gu(d,u,m,void 0,e,!0)):delete n[m]);if(i!==u)for(const m in i)(!t||!Ot(t,m))&&(delete i[m],h=!0)}h&&Os(e.attrs,"set","")}function Uv(e,t,o,a){const[n,i]=e.propsOptions;let l=!1,u;if(t)for(let d in t){if(Dl(d))continue;const h=t[d];let f;n&&Ot(n,f=Ao(d))?!i||!i.includes(f)?o[f]=h:(u||(u={}))[f]=h:_c(e.emitsOptions,d)||(!(d in a)||h!==a[d])&&(a[d]=h,l=!0)}if(i){const d=At(o),h=u||Zt;for(let f=0;f<i.length;f++){const m=i[f];o[m]=Gu(n,d,m,h[m],e,!Ot(h,m))}}return l}function Gu(e,t,o,a,n,i){const l=e[o];if(l!=null){const u=Ot(l,"default");if(u&&a===void 0){const d=l.default;if(l.type!==Function&&!l.skipFactory&&vt(d)){const{propsDefaults:h}=n;if(o in h)a=h[o];else{const f=lr(n);a=h[o]=d.call(null,t),f()}}else a=d;n.ce&&n.ce._setProp(o,a)}l[0]&&(i&&!u?a=!1:l[1]&&(a===""||a===Ra(o))&&(a=!0))}return a}const h1=new WeakMap;function zv(e,t,o=!1){const a=o?h1:t.propsCache,n=a.get(e);if(n)return n;const i=e.props,l={},u=[];let d=!1;if(!vt(e)){const f=m=>{d=!0;const[y,k]=zv(m,t,!0);Cn(l,y),k&&u.push(...k)};!o&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}if(!i&&!d)return zt(e)&&a.set(e,Xi),Xi;if(rt(i))for(let f=0;f<i.length;f++){const m=Ao(i[f]);Th(m)&&(l[m]=Zt)}else if(i)for(const f in i){const m=Ao(f);if(Th(m)){const y=i[f],k=l[m]=rt(y)||vt(y)?{type:y}:Cn({},y),w=k.type;let S=!1,T=!0;if(rt(w))for(let x=0;x<w.length;++x){const C=w[x],_=vt(C)&&C.name;if(_==="Boolean"){S=!0;break}else _==="String"&&(T=!1)}else S=vt(w)&&w.name==="Boolean";k[0]=S,k[1]=T,(S||Ot(k,"default"))&&u.push(m)}}const h=[l,u];return zt(e)&&a.set(e,h),h}function Th(e){return e[0]!=="$"&&!Dl(e)}const Td=e=>e==="_"||e==="_ctx"||e==="$stable",Md=e=>rt(e)?e.map(ps):[ps(e)],f1=(e,t,o)=>{if(t._n)return t;const a=Fe((...n)=>Md(t(...n)),o);return a._c=!1,a},Hv=(e,t,o)=>{const a=e._ctx;for(const n in e){if(Td(n))continue;const i=e[n];if(vt(i))t[n]=f1(n,i,a);else if(i!=null){const l=Md(i);t[n]=()=>l}}},Vv=(e,t)=>{const o=Md(t);e.slots.default=()=>o},Gv=(e,t,o)=>{for(const a in t)(o||!Td(a))&&(e[a]=t[a])},p1=(e,t,o)=>{const a=e.slots=Nv();if(e.vnode.shapeFlag&32){const n=t._;n?(Gv(a,t,o),o&&Bp(a,"_",n,!0)):Hv(t,a)}else t&&Vv(e,t)},v1=(e,t,o)=>{const{vnode:a,slots:n}=e;let i=!0,l=Zt;if(a.shapeFlag&32){const u=t._;u?o&&u===1?i=!1:Gv(n,t,o):(i=!t.$stable,Hv(t,n)),l=t}else t&&(Vv(e,t),l={default:1});if(i)for(const u in n)!Td(u)&&l[u]==null&&delete n[u]},Kn=b1;function m1(e){return g1(e)}function g1(e,t){const o=vc();o.__VUE__=!0;const{insert:a,remove:n,patchProp:i,createElement:l,createText:u,createComment:d,setText:h,setElementText:f,parentNode:m,nextSibling:y,setScopeId:k=Wo,insertStaticContent:w}=e,S=(z,K,se,Ee=null,Be=null,Re=null,Se=void 0,X=null,he=!!K.dynamicChildren)=>{if(z===K)return;z&&!ri(z,K)&&(Ee=Q(z),we(z,Be,Re,!0),z=null),K.patchFlag===-2&&(he=!1,K.dynamicChildren=null);const{type:Te,ref:xe,shapeFlag:be}=K;switch(Te){case wc:T(z,K,se,Ee);break;case Fn:x(z,K,se,Ee);break;case zl:z==null&&C(K,se,Ee,Se);break;case Ae:j(z,K,se,Ee,Be,Re,Se,X,he);break;default:be&1?M(z,K,se,Ee,Be,Re,Se,X,he):be&6?Y(z,K,se,Ee,Be,Re,Se,X,he):(be&64||be&128)&&Te.process(z,K,se,Ee,Be,Re,Se,X,he,me)}xe!=null&&Be?Fl(xe,z&&z.ref,Re,K||z,!K):xe==null&&z&&z.ref!=null&&Fl(z.ref,null,Re,z,!0)},T=(z,K,se,Ee)=>{if(z==null)a(K.el=u(K.children),se,Ee);else{const Be=K.el=z.el;K.children!==z.children&&h(Be,K.children)}},x=(z,K,se,Ee)=>{z==null?a(K.el=d(K.children||""),se,Ee):K.el=z.el},C=(z,K,se,Ee)=>{[z.el,z.anchor]=w(z.children,K,se,Ee,z.el,z.anchor)},_=({el:z,anchor:K},se,Ee)=>{let Be;for(;z&&z!==K;)Be=y(z),a(z,se,Ee),z=Be;a(K,se,Ee)},$=({el:z,anchor:K})=>{let se;for(;z&&z!==K;)se=y(z),n(z),z=se;n(K)},M=(z,K,se,Ee,Be,Re,Se,X,he)=>{if(K.type==="svg"?Se="svg":K.type==="math"&&(Se="mathml"),z==null)H(K,se,Ee,Be,Re,Se,X,he);else{const Te=z.el&&z.el._isVueCE?z.el:null;try{Te&&Te._beginPatch(),R(z,K,Be,Re,Se,X,he)}finally{Te&&Te._endPatch()}}},H=(z,K,se,Ee,Be,Re,Se,X)=>{let he,Te;const{props:xe,shapeFlag:be,transition:de,dirs:fe}=z;if(he=z.el=l(z.type,Re,xe&&xe.is,xe),be&8?f(he,z.children):be&16&&B(z.children,he,null,Ee,Be,Kc(z,Re),Se,X),fe&&ni(z,null,Ee,"created"),E(he,z,z.scopeId,Se,Ee),xe){for(const J in xe)J!=="value"&&!Dl(J)&&i(he,J,null,xe[J],Re,Ee);"value"in xe&&i(he,"value",null,xe.value,Re),(Te=xe.onVnodeBeforeMount)&&cs(Te,Ee,z)}fe&&ni(z,null,Ee,"beforeMount");const W=y1(Be,de);W&&de.beforeEnter(he),a(he,K,se),((Te=xe&&xe.onVnodeMounted)||W||fe)&&Kn(()=>{Te&&cs(Te,Ee,z),W&&de.enter(he),fe&&ni(z,null,Ee,"mounted")},Be)},E=(z,K,se,Ee,Be)=>{if(se&&k(z,se),Ee)for(let Re=0;Re<Ee.length;Re++)k(z,Ee[Re]);if(Be){let Re=Be.subTree;if(K===Re||Zv(Re.type)&&(Re.ssContent===K||Re.ssFallback===K)){const Se=Be.vnode;E(z,Se,Se.scopeId,Se.slotScopeIds,Be.parent)}}},B=(z,K,se,Ee,Be,Re,Se,X,he=0)=>{for(let Te=he;Te<z.length;Te++){const xe=z[Te]=X?La(z[Te]):ps(z[Te]);S(null,xe,K,se,Ee,Be,Re,Se,X)}},R=(z,K,se,Ee,Be,Re,Se)=>{const X=K.el=z.el;let{patchFlag:he,dynamicChildren:Te,dirs:xe}=K;he|=z.patchFlag&16;const be=z.props||Zt,de=K.props||Zt;let fe;if(se&&oi(se,!1),(fe=de.onVnodeBeforeUpdate)&&cs(fe,se,K,z),xe&&ni(K,z,se,"beforeUpdate"),se&&oi(se,!0),(be.innerHTML&&de.innerHTML==null||be.textContent&&de.textContent==null)&&f(X,""),Te?U(z.dynamicChildren,Te,X,se,Ee,Kc(K,Be),Re):Se||O(z,K,X,null,se,Ee,Kc(K,Be),Re,!1),he>0){if(he&16)F(X,be,de,se,Be);else if(he&2&&be.class!==de.class&&i(X,"class",null,de.class,Be),he&4&&i(X,"style",be.style,de.style,Be),he&8){const W=K.dynamicProps;for(let J=0;J<W.length;J++){const re=W[J],je=be[re],et=de[re];(et!==je||re==="value")&&i(X,re,je,et,Be,se)}}he&1&&z.children!==K.children&&f(X,K.children)}else!Se&&Te==null&&F(X,be,de,se,Be);((fe=de.onVnodeUpdated)||xe)&&Kn(()=>{fe&&cs(fe,se,K,z),xe&&ni(K,z,se,"updated")},Ee)},U=(z,K,se,Ee,Be,Re,Se)=>{for(let X=0;X<K.length;X++){const he=z[X],Te=K[X],xe=he.el&&(he.type===Ae||!ri(he,Te)||he.shapeFlag&198)?m(he.el):se;S(he,Te,xe,null,Ee,Be,Re,Se,!0)}},F=(z,K,se,Ee,Be)=>{if(K!==se){if(K!==Zt)for(const Re in K)!Dl(Re)&&!(Re in se)&&i(z,Re,K[Re],null,Be,Ee);for(const Re in se){if(Dl(Re))continue;const Se=se[Re],X=K[Re];Se!==X&&Re!=="value"&&i(z,Re,X,Se,Be,Ee)}"value"in se&&i(z,"value",K.value,se.value,Be)}},j=(z,K,se,Ee,Be,Re,Se,X,he)=>{const Te=K.el=z?z.el:u(""),xe=K.anchor=z?z.anchor:u("");let{patchFlag:be,dynamicChildren:de,slotScopeIds:fe}=K;fe&&(X=X?X.concat(fe):fe),z==null?(a(Te,se,Ee),a(xe,se,Ee),B(K.children||[],se,xe,Be,Re,Se,X,he)):be>0&&be&64&&de&&z.dynamicChildren&&z.dynamicChildren.length===de.length?(U(z.dynamicChildren,de,se,Be,Re,Se,X),(K.key!=null||Be&&K===Be.subTree)&&Ad(z,K,!0)):O(z,K,se,xe,Be,Re,Se,X,he)},Y=(z,K,se,Ee,Be,Re,Se,X,he)=>{K.slotScopeIds=X,z==null?K.shapeFlag&512?Be.ctx.activate(K,se,Ee,Se,he):oe(K,se,Ee,Be,Re,Se,he):Oe(z,K,he)},oe=(z,K,se,Ee,Be,Re,Se)=>{const X=z.component=I1(z,Ee,Be);if(kc(z)&&(X.ctx.renderer=me),x1(X,!1,Se),X.asyncDep){if(Be&&Be.registerDep(X,ee,Se),!z.el){const he=X.subTree=Me(Fn);x(null,he,K,se),z.placeholder=he.el}}else ee(X,z,K,se,Be,Re,Se)},Oe=(z,K,se)=>{const Ee=K.component=z.component;if(r1(z,K,se))if(Ee.asyncDep&&!Ee.asyncResolved){te(Ee,K,se);return}else Ee.next=K,Ee.update();else K.el=z.el,Ee.vnode=K},ee=(z,K,se,Ee,Be,Re,Se)=>{const X=()=>{if(z.isMounted){let{next:be,bu:de,u:fe,parent:W,vnode:J}=z;{const kt=qv(z);if(kt){be&&(be.el=J.el,te(z,be,Se)),kt.asyncDep.then(()=>{z.isUnmounted||X()});return}}let re=be,je;oi(z,!1),be?(be.el=J.el,te(z,be,Se)):be=J,de&&Pr(de),(je=be.props&&be.props.onVnodeBeforeUpdate)&&cs(je,W,be,J),oi(z,!0);const et=xh(z),dt=z.subTree;z.subTree=et,S(dt,et,m(dt.el),Q(dt),z,Be,Re),be.el=et.el,re===null&&c1(z,et.el),fe&&Kn(fe,Be),(je=be.props&&be.props.onVnodeUpdated)&&Kn(()=>cs(je,W,be,J),Be)}else{let be;const{el:de,props:fe}=K,{bm:W,m:J,parent:re,root:je,type:et}=z,dt=tl(K);oi(z,!1),W&&Pr(W),!dt&&(be=fe&&fe.onVnodeBeforeMount)&&cs(be,re,K),oi(z,!0);{je.ce&&je.ce._def.shadowRoot!==!1&&je.ce._injectChildStyle(et);const kt=z.subTree=xh(z);S(null,kt,se,Ee,z,Be,Re),K.el=kt.el}if(J&&Kn(J,Be),!dt&&(be=fe&&fe.onVnodeMounted)){const kt=K;Kn(()=>cs(be,re,kt),Be)}(K.shapeFlag&256||re&&tl(re.vnode)&&re.vnode.shapeFlag&256)&&z.a&&Kn(z.a,Be),z.isMounted=!0,K=se=Ee=null}};z.scope.on();const he=z.effect=new Gp(X);z.scope.off();const Te=z.update=he.run.bind(he),xe=z.job=he.runIfDirty.bind(he);xe.i=z,xe.id=z.uid,he.scheduler=()=>Id(xe),oi(z,!0),Te()},te=(z,K,se)=>{K.component=z;const Ee=z.vnode.props;z.vnode=K,z.next=null,d1(z,K.props,Ee,se),v1(z,K.children,se),Gs(),mh(z),qs()},O=(z,K,se,Ee,Be,Re,Se,X,he=!1)=>{const Te=z&&z.children,xe=z?z.shapeFlag:0,be=K.children,{patchFlag:de,shapeFlag:fe}=K;if(de>0){if(de&128){ne(Te,be,se,Ee,Be,Re,Se,X,he);return}else if(de&256){Z(Te,be,se,Ee,Be,Re,Se,X,he);return}}fe&8?(xe&16&&Xe(Te,Be,Re),be!==Te&&f(se,be)):xe&16?fe&16?ne(Te,be,se,Ee,Be,Re,Se,X,he):Xe(Te,Be,Re,!0):(xe&8&&f(se,""),fe&16&&B(be,se,Ee,Be,Re,Se,X,he))},Z=(z,K,se,Ee,Be,Re,Se,X,he)=>{z=z||Xi,K=K||Xi;const Te=z.length,xe=K.length,be=Math.min(Te,xe);let de;for(de=0;de<be;de++){const fe=K[de]=he?La(K[de]):ps(K[de]);S(z[de],fe,se,null,Be,Re,Se,X,he)}Te>xe?Xe(z,Be,Re,!0,!1,be):B(K,se,Ee,Be,Re,Se,X,he,be)},ne=(z,K,se,Ee,Be,Re,Se,X,he)=>{let Te=0;const xe=K.length;let be=z.length-1,de=xe-1;for(;Te<=be&&Te<=de;){const fe=z[Te],W=K[Te]=he?La(K[Te]):ps(K[Te]);if(ri(fe,W))S(fe,W,se,null,Be,Re,Se,X,he);else break;Te++}for(;Te<=be&&Te<=de;){const fe=z[be],W=K[de]=he?La(K[de]):ps(K[de]);if(ri(fe,W))S(fe,W,se,null,Be,Re,Se,X,he);else break;be--,de--}if(Te>be){if(Te<=de){const fe=de+1,W=fe<xe?K[fe].el:Ee;for(;Te<=de;)S(null,K[Te]=he?La(K[Te]):ps(K[Te]),se,W,Be,Re,Se,X,he),Te++}}else if(Te>de)for(;Te<=be;)we(z[Te],Be,Re,!0),Te++;else{const fe=Te,W=Te,J=new Map;for(Te=W;Te<=de;Te++){const Lt=K[Te]=he?La(K[Te]):ps(K[Te]);Lt.key!=null&&J.set(Lt.key,Te)}let re,je=0;const et=de-W+1;let dt=!1,kt=0;const gt=new Array(et);for(Te=0;Te<et;Te++)gt[Te]=0;for(Te=fe;Te<=be;Te++){const Lt=z[Te];if(je>=et){we(Lt,Be,Re,!0);continue}let Dt;if(Lt.key!=null)Dt=J.get(Lt.key);else for(re=W;re<=de;re++)if(gt[re-W]===0&&ri(Lt,K[re])){Dt=re;break}Dt===void 0?we(Lt,Be,Re,!0):(gt[Dt-W]=Te+1,Dt>=kt?kt=Dt:dt=!0,S(Lt,K[Dt],se,null,Be,Re,Se,X,he),je++)}const St=dt?k1(gt):Xi;for(re=St.length-1,Te=et-1;Te>=0;Te--){const Lt=W+Te,Dt=K[Lt],Vt=K[Lt+1],ht=Lt+1<xe?Vt.el||jv(Vt):Ee;gt[Te]===0?S(null,Dt,se,ht,Be,Re,Se,X,he):dt&&(re<0||Te!==St[re]?pe(Dt,se,ht,2):re--)}}},pe=(z,K,se,Ee,Be=null)=>{const{el:Re,type:Se,transition:X,children:he,shapeFlag:Te}=z;if(Te&6){pe(z.component.subTree,K,se,Ee);return}if(Te&128){z.suspense.move(K,se,Ee);return}if(Te&64){Se.move(z,K,se,me);return}if(Se===Ae){a(Re,K,se);for(let be=0;be<he.length;be++)pe(he[be],K,se,Ee);a(z.anchor,K,se);return}if(Se===zl){_(z,K,se);return}if(Ee!==2&&Te&1&&X)if(Ee===0)X.beforeEnter(Re),a(Re,K,se),Kn(()=>X.enter(Re),Be);else{const{leave:be,delayLeave:de,afterLeave:fe}=X,W=()=>{z.ctx.isUnmounted?n(Re):a(Re,K,se)},J=()=>{Re._isLeaving&&Re[Rs](!0),be(Re,()=>{W(),fe&&fe()})};de?de(Re,W,J):J()}else a(Re,K,se)},we=(z,K,se,Ee=!1,Be=!1)=>{const{type:Re,props:Se,ref:X,children:he,dynamicChildren:Te,shapeFlag:xe,patchFlag:be,dirs:de,cacheIndex:fe}=z;if(be===-2&&(Be=!1),X!=null&&(Gs(),Fl(X,null,se,z,!0),qs()),fe!=null&&(K.renderCache[fe]=void 0),xe&256){K.ctx.deactivate(z);return}const W=xe&1&&de,J=!tl(z);let re;if(J&&(re=Se&&Se.onVnodeBeforeUnmount)&&cs(re,K,z),xe&6)Ge(z.component,se,Ee);else{if(xe&128){z.suspense.unmount(se,Ee);return}W&&ni(z,null,K,"beforeUnmount"),xe&64?z.type.remove(z,K,se,me,Ee):Te&&!Te.hasOnce&&(Re!==Ae||be>0&&be&64)?Xe(Te,K,se,!1,!0):(Re===Ae&&be&384||!Be&&xe&16)&&Xe(he,K,se),Ee&&Ze(z)}(J&&(re=Se&&Se.onVnodeUnmounted)||W)&&Kn(()=>{re&&cs(re,K,z),W&&ni(z,null,K,"unmounted")},se)},Ze=z=>{const{type:K,el:se,anchor:Ee,transition:Be}=z;if(K===Ae){Ne(se,Ee);return}if(K===zl){$(z);return}const Re=()=>{n(se),Be&&!Be.persisted&&Be.afterLeave&&Be.afterLeave()};if(z.shapeFlag&1&&Be&&!Be.persisted){const{leave:Se,delayLeave:X}=Be,he=()=>Se(se,Re);X?X(z.el,Re,he):he()}else Re()},Ne=(z,K)=>{let se;for(;z!==K;)se=y(z),n(z),z=se;n(K)},Ge=(z,K,se)=>{const{bum:Ee,scope:Be,job:Re,subTree:Se,um:X,m:he,a:Te}=z;Mh(he),Mh(Te),Ee&&Pr(Ee),Be.stop(),Re&&(Re.flags|=8,we(Se,z,K,se)),X&&Kn(X,K),Kn(()=>{z.isUnmounted=!0},K)},Xe=(z,K,se,Ee=!1,Be=!1,Re=0)=>{for(let Se=Re;Se<z.length;Se++)we(z[Se],K,se,Ee,Be)},Q=z=>{if(z.shapeFlag&6)return Q(z.component.subTree);if(z.shapeFlag&128)return z.suspense.next();const K=y(z.anchor||z.el),se=K&&K[vv];return se?y(se):K};let ye=!1;const Ce=(z,K,se)=>{let Ee;z==null?K._vnode&&(we(K._vnode,null,null,!0),Ee=K._vnode.component):S(K._vnode||null,z,K,null,null,null,se),K._vnode=z,ye||(ye=!0,mh(Ee),uv(),ye=!1)},me={p:S,um:we,m:pe,r:Ze,mt:oe,mc:B,pc:O,pbc:U,n:Q,o:e};return{render:Ce,hydrate:void 0,createApp:n1(Ce)}}function Kc({type:e,props:t},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:o}function oi({effect:e,job:t},o){o?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function y1(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function Ad(e,t,o=!1){const a=e.children,n=t.children;if(rt(a)&&rt(n))for(let i=0;i<a.length;i++){const l=a[i];let u=n[i];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=n[i]=La(n[i]),u.el=l.el),!o&&u.patchFlag!==-2&&Ad(l,u)),u.type===wc&&(u.patchFlag!==-1?u.el=l.el:u.__elIndex=i+(e.type===Ae?1:0)),u.type===Fn&&!u.el&&(u.el=l.el)}}function k1(e){const t=e.slice(),o=[0];let a,n,i,l,u;const d=e.length;for(a=0;a<d;a++){const h=e[a];if(h!==0){if(n=o[o.length-1],e[n]<h){t[a]=n,o.push(a);continue}for(i=0,l=o.length-1;i<l;)u=i+l>>1,e[o[u]]<h?i=u+1:l=u;h<e[o[i]]&&(i>0&&(t[a]=o[i-1]),o[i]=a)}}for(i=o.length,l=o[i-1];i-- >0;)o[i]=l,l=t[l];return o}function qv(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:qv(t)}function Mh(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function jv(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?jv(t.subTree):null}const Zv=e=>e.__isSuspense;function b1(e,t){t&&t.pendingBranch?rt(e)?t.effects.push(...e):t.effects.push(e):cv(e)}const Ae=Symbol.for("v-fgt"),wc=Symbol.for("v-txt"),Fn=Symbol.for("v-cmt"),zl=Symbol.for("v-stc"),Hl=[];let yo=null;function v(e=!1){Hl.push(yo=e?null:[])}function _1(){Hl.pop(),yo=Hl[Hl.length-1]||null}let Yl=1;function Kr(e,t=!1){Yl+=e,e<0&&yo&&t&&(yo.hasOnce=!0)}function Wv(e){return e.dynamicChildren=Yl>0?yo||Xi:null,_1(),Yl>0&&yo&&yo.push(e),e}function g(e,t,o,a,n,i){return Wv(r(e,t,o,a,n,i,!0))}function Ke(e,t,o,a,n){return Wv(Me(e,t,o,a,n,!0))}function Xl(e){return e?e.__v_isVNode===!0:!1}function ri(e,t){return e.type===t.type&&e.key===t.key}const Kv=({key:e})=>e??null,Rr=({ref:e,ref_key:t,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?an(e)||sn(e)||vt(e)?{i:Mn,r:e,k:t,f:!!o}:e:null);function r(e,t=null,o=null,a=0,n=null,i=e===Ae?0:1,l=!1,u=!1){const d={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Kv(t),ref:t&&Rr(t),scopeId:hv,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:a,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:Mn};return u?(Ed(d,o),i&128&&e.normalize(d)):o&&(d.shapeFlag|=an(o)?8:16),Yl>0&&!l&&yo&&(d.patchFlag>0||i&6)&&d.patchFlag!==32&&yo.push(d),d}const Me=w1;function w1(e,t=null,o=null,a=0,n=null,i=!1){if((!e||e===Mv)&&(e=Fn),Xl(e)){const u=Ea(e,t,!0);return o&&Ed(u,o),Yl>0&&!i&&yo&&(u.shapeFlag&6?yo[yo.indexOf(e)]=u:yo.push(u)),u.patchFlag=-2,u}if(E1(e)&&(e=e.__vccOpts),t){t=C1(t);let{class:u,style:d}=t;u&&!an(u)&&(t.class=ve(u)),zt(d)&&(gc(d)&&!rt(d)&&(d=Cn({},d)),t.style=Qe(d))}const l=an(e)?1:Zv(e)?128:mv(e)?64:zt(e)?4:vt(e)?2:0;return r(e,t,o,a,n,l,i,!0)}function C1(e){return e?gc(e)||Fv(e)?Cn({},e):e:null}function Ea(e,t,o=!1,a=!1){const{props:n,ref:i,patchFlag:l,children:u,transition:d}=e,h=t?Jv(n||{},t):n,f={__v_isVNode:!0,__v_skip:!0,type:e.type,props:h,key:h&&Kv(h),ref:t&&t.ref?o&&i?rt(i)?i.concat(Rr(t)):[i,Rr(t)]:Rr(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Ae?l===-1?16:l|16:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:d,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ea(e.ssContent),ssFallback:e.ssFallback&&Ea(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return d&&a&&Jl(f,d.clone(f)),f}function Ye(e=" ",t=0){return Me(wc,null,e,t)}function Ql(e,t){const o=Me(zl,null,e);return o.staticCount=t,o}function D(e="",t=!1){return t?(v(),Ke(Fn,null,e)):Me(Fn,null,e)}function ps(e){return e==null||typeof e=="boolean"?Me(Fn):rt(e)?Me(Ae,null,e.slice()):Xl(e)?La(e):Me(wc,null,String(e))}function La(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Ea(e)}function Ed(e,t){let o=0;const{shapeFlag:a}=e;if(t==null)t=null;else if(rt(t))o=16;else if(typeof t=="object")if(a&65){const n=t.default;n&&(n._c&&(n._d=!1),Ed(e,n()),n._c&&(n._d=!0));return}else{o=32;const n=t._;!n&&!Fv(t)?t._ctx=Mn:n===3&&Mn&&(Mn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else vt(t)?(t={default:t,_ctx:Mn},o=32):(t=String(t),a&64?(o=16,t=[Ye(t)]):o=8);e.children=t,e.shapeFlag|=o}function Jv(...e){const t={};for(let o=0;o<e.length;o++){const a=e[o];for(const n in a)if(n==="class")t.class!==a.class&&(t.class=ve([t.class,a.class]));else if(n==="style")t.style=Qe([t.style,a.style]);else if(uc(n)){const i=t[n],l=a[n];l&&i!==l&&!(rt(i)&&i.includes(l))&&(t[n]=i?[].concat(i,l):l)}else n!==""&&(t[n]=a[n])}return t}function cs(e,t,o,a=null){Qo(e,t,7,[o,a])}const L1=Rv();let S1=0;function I1(e,t,o){const a=e.type,n=(t?t.appContext:e.appContext)||L1,i={uid:S1++,vnode:e,type:a,parent:t,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new zp(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(n.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:zv(a,n),emitsOptions:Ov(a,n),emit:null,emitted:null,propsDefaults:Zt,inheritAttrs:a.inheritAttrs,ctx:Zt,data:Zt,props:Zt,attrs:Zt,slots:Zt,refs:Zt,setupState:Zt,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=s1.bind(null,i),e.ce&&e.ce(i),i}let Un=null;const Cc=()=>Un||Mn;let Jr,qu;{const e=vc(),t=(o,a)=>{let n;return(n=e[o])||(n=e[o]=[]),n.push(a),i=>{n.length>1?n.forEach(l=>l(i)):n[0](i)}};Jr=t("__VUE_INSTANCE_SETTERS__",o=>Un=o),qu=t("__VUE_SSR_SETTERS__",o=>er=o)}const lr=e=>{const t=Un;return Jr(e),e.scope.on(),()=>{e.scope.off(),Jr(t)}},Ah=()=>{Un&&Un.scope.off(),Jr(null)};function Yv(e){return e.vnode.shapeFlag&4}let er=!1;function x1(e,t=!1,o=!1){t&&qu(t);const{props:a,children:n}=e.vnode,i=Yv(e);u1(e,a,i,t),p1(e,n,o||t);const l=i?$1(e,t):void 0;return t&&qu(!1),l}function $1(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Ky);const{setup:a}=o;if(a){Gs();const n=e.setupContext=a.length>1?M1(e):null,i=lr(e),l=ir(a,e,0,[e.props,n]),u=Dp(l);if(qs(),i(),(u||e.sp)&&!tl(e)&&Sv(e),u){if(l.then(Ah,Ah),t)return l.then(d=>{Eh(e,d)}).catch(d=>{yc(d,e,0)});e.asyncDep=l}else Eh(e,l)}else Xv(e)}function Eh(e,t,o){vt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:zt(t)&&(e.setupState=iv(t)),Xv(e)}function Xv(e,t,o){const a=e.type;e.render||(e.render=a.render||Wo);{const n=lr(e);Gs();try{Jy(e)}finally{qs(),n()}}}const T1={get(e,t){return Nn(e,"get",""),e[t]}};function M1(e){const t=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,T1),slots:e.slots,emit:e.emit,expose:t}}function Lc(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(iv(Sd(e.exposed)),{get(t,o){if(o in t)return t[o];if(o in Ul)return Ul[o](e)},has(t,o){return o in t||o in Ul}})):e.proxy}function A1(e,t=!0){return vt(e)?e.displayName||e.name:e.name||t&&e.__name}function E1(e){return vt(e)&&"__vccOpts"in e}const V=(e,t)=>Iy(e,t,er);function Pd(e,t,o){try{Kr(-1);const a=arguments.length;return a===2?zt(t)&&!rt(t)?Xl(t)?Me(e,null,[t]):Me(e,t):Me(e,null,t):(a>3?o=Array.prototype.slice.call(arguments,2):a===3&&Xl(o)&&(o=[o]),Me(e,t,o))}finally{Kr(1)}}const P1="3.5.26";let ju;const Ph=typeof window<"u"&&window.trustedTypes;if(Ph)try{ju=Ph.createPolicy("vue",{createHTML:e=>e})}catch{}const Qv=ju?e=>ju.createHTML(e):e=>e,D1="http://www.w3.org/2000/svg",R1="http://www.w3.org/1998/Math/MathML",Ds=typeof document<"u"?document:null,Dh=Ds&&Ds.createElement("template"),O1={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,a)=>{const n=t==="svg"?Ds.createElementNS(D1,e):t==="mathml"?Ds.createElementNS(R1,e):o?Ds.createElement(e,{is:o}):Ds.createElement(e);return e==="select"&&a&&a.multiple!=null&&n.setAttribute("multiple",a.multiple),n},createText:e=>Ds.createTextNode(e),createComment:e=>Ds.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Ds.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,o,a,n,i){const l=o?o.previousSibling:t.lastChild;if(n&&(n===i||n.nextSibling))for(;t.insertBefore(n.cloneNode(!0),o),!(n===i||!(n=n.nextSibling)););else{Dh.innerHTML=Qv(a==="svg"?`<svg>${e}</svg>`:a==="mathml"?`<math>${e}</math>`:e);const u=Dh.content;if(a==="svg"||a==="mathml"){const d=u.firstChild;for(;d.firstChild;)u.appendChild(d.firstChild);u.removeChild(d)}t.insertBefore(u,o)}return[l?l.nextSibling:t.firstChild,o?o.previousSibling:t.lastChild]}},ga="transition",Sl="animation",tr=Symbol("_vtc"),em={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},B1=Cn({},kv,em),N1=e=>(e.displayName="Transition",e.props=B1,e),Jo=N1((e,{slots:t})=>Pd(Ny,F1(e),t)),si=(e,t=[])=>{rt(e)?e.forEach(o=>o(...t)):e&&e(...t)},Rh=e=>e?rt(e)?e.some(t=>t.length>1):e.length>1:!1;function F1(e){const t={};for(const j in e)j in em||(t[j]=e[j]);if(e.css===!1)return t;const{name:o="v",type:a,duration:n,enterFromClass:i=`${o}-enter-from`,enterActiveClass:l=`${o}-enter-active`,enterToClass:u=`${o}-enter-to`,appearFromClass:d=i,appearActiveClass:h=l,appearToClass:f=u,leaveFromClass:m=`${o}-leave-from`,leaveActiveClass:y=`${o}-leave-active`,leaveToClass:k=`${o}-leave-to`}=e,w=U1(n),S=w&&w[0],T=w&&w[1],{onBeforeEnter:x,onEnter:C,onEnterCancelled:_,onLeave:$,onLeaveCancelled:M,onBeforeAppear:H=x,onAppear:E=C,onAppearCancelled:B=_}=t,R=(j,Y,oe,Oe)=>{j._enterCancelled=Oe,ai(j,Y?f:u),ai(j,Y?h:l),oe&&oe()},U=(j,Y)=>{j._isLeaving=!1,ai(j,m),ai(j,k),ai(j,y),Y&&Y()},F=j=>(Y,oe)=>{const Oe=j?E:C,ee=()=>R(Y,j,oe);si(Oe,[Y,ee]),Oh(()=>{ai(Y,j?d:i),Es(Y,j?f:u),Rh(Oe)||Bh(Y,a,S,ee)})};return Cn(t,{onBeforeEnter(j){si(x,[j]),Es(j,i),Es(j,l)},onBeforeAppear(j){si(H,[j]),Es(j,d),Es(j,h)},onEnter:F(!1),onAppear:F(!0),onLeave(j,Y){j._isLeaving=!0;const oe=()=>U(j,Y);Es(j,m),j._enterCancelled?(Es(j,y),Uh(j)):(Uh(j),Es(j,y)),Oh(()=>{j._isLeaving&&(ai(j,m),Es(j,k),Rh($)||Bh(j,a,T,oe))}),si($,[j,oe])},onEnterCancelled(j){R(j,!1,void 0,!0),si(_,[j])},onAppearCancelled(j){R(j,!0,void 0,!0),si(B,[j])},onLeaveCancelled(j){U(j),si(M,[j])}})}function U1(e){if(e==null)return null;if(zt(e))return[Jc(e.enter),Jc(e.leave)];{const t=Jc(e);return[t,t]}}function Jc(e){return Gg(e)}function Es(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e[tr]||(e[tr]=new Set)).add(t)}function ai(e,t){t.split(/\s+/).forEach(a=>a&&e.classList.remove(a));const o=e[tr];o&&(o.delete(t),o.size||(e[tr]=void 0))}function Oh(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let z1=0;function Bh(e,t,o,a){const n=e._endId=++z1,i=()=>{n===e._endId&&a()};if(o!=null)return setTimeout(i,o);const{type:l,timeout:u,propCount:d}=H1(e,t);if(!l)return a();const h=l+"end";let f=0;const m=()=>{e.removeEventListener(h,y),i()},y=k=>{k.target===e&&++f>=d&&m()};setTimeout(()=>{f<d&&m()},u+1),e.addEventListener(h,y)}function H1(e,t){const o=window.getComputedStyle(e),a=w=>(o[w]||"").split(", "),n=a(`${ga}Delay`),i=a(`${ga}Duration`),l=Nh(n,i),u=a(`${Sl}Delay`),d=a(`${Sl}Duration`),h=Nh(u,d);let f=null,m=0,y=0;t===ga?l>0&&(f=ga,m=l,y=i.length):t===Sl?h>0&&(f=Sl,m=h,y=d.length):(m=Math.max(l,h),f=m>0?l>h?ga:Sl:null,y=f?f===ga?i.length:d.length:0);const k=f===ga&&/\b(?:transform|all)(?:,|$)/.test(a(`${ga}Property`).toString());return{type:f,timeout:m,propCount:y,hasTransform:k}}function Nh(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((o,a)=>Fh(o)+Fh(e[a])))}function Fh(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function Uh(e){return(e?e.ownerDocument:document).body.offsetHeight}function V1(e,t,o){const a=e[tr];a&&(t=(t?[t,...a]:[...a]).join(" ")),t==null?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}const Yr=Symbol("_vod"),tm=Symbol("_vsh"),ys={name:"show",beforeMount(e,{value:t},{transition:o}){e[Yr]=e.style.display==="none"?"":e.style.display,o&&t?o.beforeEnter(e):Il(e,t)},mounted(e,{value:t},{transition:o}){o&&t&&o.enter(e)},updated(e,{value:t,oldValue:o},{transition:a}){!t!=!o&&(a?t?(a.beforeEnter(e),Il(e,!0),a.enter(e)):a.leave(e,()=>{Il(e,!1)}):Il(e,t))},beforeUnmount(e,{value:t}){Il(e,t)}};function Il(e,t){e.style.display=t?e[Yr]:"none",e[tm]=!t}const nm=Symbol("");function G1(e){const t=Cc();if(!t)return;const o=t.ut=(n=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(i=>Xr(i,n))},a=()=>{const n=e(t.proxy);t.ce?Xr(t.ce,n):Zu(t.subTree,n),o(n)};xv(()=>{cv(a)}),ln(()=>{We(a,Wo,{flush:"post"});const n=new MutationObserver(a);n.observe(t.subTree.el.parentNode,{childList:!0}),Ln(()=>n.disconnect())})}function Zu(e,t){if(e.shapeFlag&128){const o=e.suspense;e=o.activeBranch,o.pendingBranch&&!o.isHydrating&&o.effects.push(()=>{Zu(o.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)Xr(e.el,t);else if(e.type===Ae)e.children.forEach(o=>Zu(o,t));else if(e.type===zl){let{el:o,anchor:a}=e;for(;o&&(Xr(o,t),o!==a);)o=o.nextSibling}}function Xr(e,t){if(e.nodeType===1){const o=e.style;let a="";for(const n in t){const i=Xg(t[n]);o.setProperty(`--${n}`,i),a+=`--${n}: ${i};`}o[nm]=a}}const q1=/(?:^|;)\s*display\s*:/;function j1(e,t,o){const a=e.style,n=an(o);let i=!1;if(o&&!n){if(t)if(an(t))for(const l of t.split(";")){const u=l.slice(0,l.indexOf(":")).trim();o[u]==null&&Or(a,u,"")}else for(const l in t)o[l]==null&&Or(a,l,"");for(const l in o)l==="display"&&(i=!0),Or(a,l,o[l])}else if(n){if(t!==o){const l=a[nm];l&&(o+=";"+l),a.cssText=o,i=q1.test(o)}}else t&&e.removeAttribute("style");Yr in e&&(e[Yr]=i?a.display:"",e[tm]&&(a.display="none"))}const zh=/\s*!important$/;function Or(e,t,o){if(rt(o))o.forEach(a=>Or(e,t,a));else if(o==null&&(o=""),t.startsWith("--"))e.setProperty(t,o);else{const a=Z1(e,t);zh.test(o)?e.setProperty(Ra(a),o.replace(zh,""),"important"):e[a]=o}}const Hh=["Webkit","Moz","ms"],Yc={};function Z1(e,t){const o=Yc[t];if(o)return o;let a=Ao(t);if(a!=="filter"&&a in e)return Yc[t]=a;a=fc(a);for(let n=0;n<Hh.length;n++){const i=Hh[n]+a;if(i in e)return Yc[t]=i}return t}const Vh="http://www.w3.org/1999/xlink";function Gh(e,t,o,a,n,i=Jg(t)){a&&t.startsWith("xlink:")?o==null?e.removeAttributeNS(Vh,t.slice(6,t.length)):e.setAttributeNS(Vh,t,o):o==null||i&&!Np(o)?e.removeAttribute(t):e.setAttribute(t,i?"":Yo(o)?String(o):o)}function qh(e,t,o,a,n){if(t==="innerHTML"||t==="textContent"){o!=null&&(e[t]=t==="innerHTML"?Qv(o):o);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const u=i==="OPTION"?e.getAttribute("value")||"":e.value,d=o==null?e.type==="checkbox"?"on":"":String(o);(u!==d||!("_value"in e))&&(e.value=d),o==null&&e.removeAttribute(t),e._value=o;return}let l=!1;if(o===""||o==null){const u=typeof e[t];u==="boolean"?o=Np(o):o==null&&u==="string"?(o="",l=!0):u==="number"&&(o=0,l=!0)}try{e[t]=o}catch{}l&&e.removeAttribute(n||t)}function Ns(e,t,o,a){e.addEventListener(t,o,a)}function W1(e,t,o,a){e.removeEventListener(t,o,a)}const jh=Symbol("_vei");function K1(e,t,o,a,n=null){const i=e[jh]||(e[jh]={}),l=i[t];if(a&&l)l.value=a;else{const[u,d]=J1(t);if(a){const h=i[t]=Q1(a,n);Ns(e,u,h,d)}else l&&(W1(e,u,l,d),i[t]=void 0)}}const Zh=/(?:Once|Passive|Capture)$/;function J1(e){let t;if(Zh.test(e)){t={};let a;for(;a=e.match(Zh);)e=e.slice(0,e.length-a[0].length),t[a[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Ra(e.slice(2)),t]}let Xc=0;const Y1=Promise.resolve(),X1=()=>Xc||(Y1.then(()=>Xc=0),Xc=Date.now());function Q1(e,t){const o=a=>{if(!a._vts)a._vts=Date.now();else if(a._vts<=o.attached)return;Qo(ek(a,o.value),t,5,[a])};return o.value=e,o.attached=X1(),o}function ek(e,t){if(rt(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map(a=>n=>!n._stopped&&a&&a(n))}else return t}const Wh=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,tk=(e,t,o,a,n,i)=>{const l=n==="svg";t==="class"?V1(e,a,l):t==="style"?j1(e,o,a):uc(t)?md(t)||K1(e,t,o,a,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):nk(e,t,a,l))?(qh(e,t,a),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Gh(e,t,a,l,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!an(a))?qh(e,Ao(t),a,i,t):(t==="true-value"?e._trueValue=a:t==="false-value"&&(e._falseValue=a),Gh(e,t,a,l))};function nk(e,t,o,a){if(a)return!!(t==="innerHTML"||t==="textContent"||t in e&&Wh(t)&&vt(o));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const n=e.tagName;if(n==="IMG"||n==="VIDEO"||n==="CANVAS"||n==="SOURCE")return!1}return Wh(t)&&an(o)?!1:t in e}const Pa=e=>{const t=e.props["onUpdate:modelValue"]||!1;return rt(t)?o=>Pr(t,o):t};function ok(e){e.target.composing=!0}function Kh(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Mo=Symbol("_assign");function Jh(e,t,o){return t&&(e=e.trim()),o&&(e=pc(e)),e}const nt={created(e,{modifiers:{lazy:t,trim:o,number:a}},n){e[Mo]=Pa(n);const i=a||n.props&&n.props.type==="number";Ns(e,t?"change":"input",l=>{l.target.composing||e[Mo](Jh(e.value,o,i))}),(o||i)&&Ns(e,"change",()=>{e.value=Jh(e.value,o,i)}),t||(Ns(e,"compositionstart",ok),Ns(e,"compositionend",Kh),Ns(e,"change",Kh))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:o,modifiers:{lazy:a,trim:n,number:i}},l){if(e[Mo]=Pa(l),e.composing)return;const u=(i||e.type==="number")&&!/^0\d/.test(e.value)?pc(e.value):e.value,d=t??"";u!==d&&(document.activeElement===e&&e.type!=="range"&&(a&&t===o||n&&e.value.trim()===d)||(e.value=d))}},Zs={deep:!0,created(e,t,o){e[Mo]=Pa(o),Ns(e,"change",()=>{const a=e._modelValue,n=sl(e),i=e.checked,l=e[Mo];if(rt(a)){const u=yd(a,n),d=u!==-1;if(i&&!d)l(a.concat(n));else if(!i&&d){const h=[...a];h.splice(u,1),l(h)}}else if(rl(a)){const u=new Set(a);i?u.add(n):u.delete(n),l(u)}else l(om(e,i))})},mounted:Yh,beforeUpdate(e,t,o){e[Mo]=Pa(o),Yh(e,t,o)}};function Yh(e,{value:t,oldValue:o},a){e._modelValue=t;let n;if(rt(t))n=yd(t,a.props.value)>-1;else if(rl(t))n=t.has(a.props.value);else{if(t===o)return;n=yi(t,om(e,!0))}e.checked!==n&&(e.checked=n)}const Xh={created(e,{value:t},o){e.checked=yi(t,o.props.value),e[Mo]=Pa(o),Ns(e,"change",()=>{e[Mo](sl(e))})},beforeUpdate(e,{value:t,oldValue:o},a){e[Mo]=Pa(a),t!==o&&(e.checked=yi(t,a.props.value))}},zn={deep:!0,created(e,{value:t,modifiers:{number:o}},a){const n=rl(t);Ns(e,"change",()=>{const i=Array.prototype.filter.call(e.options,l=>l.selected).map(l=>o?pc(sl(l)):sl(l));e[Mo](e.multiple?n?new Set(i):i:i[0]),e._assigning=!0,cn(()=>{e._assigning=!1})}),e[Mo]=Pa(a)},mounted(e,{value:t}){Qh(e,t)},beforeUpdate(e,t,o){e[Mo]=Pa(o)},updated(e,{value:t}){e._assigning||Qh(e,t)}};function Qh(e,t){const o=e.multiple,a=rt(t);if(!(o&&!a&&!rl(t))){for(let n=0,i=e.options.length;n<i;n++){const l=e.options[n],u=sl(l);if(o)if(a){const d=typeof u;d==="string"||d==="number"?l.selected=t.some(h=>String(h)===String(u)):l.selected=yd(t,u)>-1}else l.selected=t.has(u);else if(yi(sl(l),t)){e.selectedIndex!==n&&(e.selectedIndex=n);return}}!o&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function sl(e){return"_value"in e?e._value:e.value}function om(e,t){const o=t?"_trueValue":"_falseValue";return o in e?e[o]:t}const sk=["ctrl","shift","alt","meta"],ak={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>sk.some(o=>e[`${o}Key`]&&!t.includes(o))},lt=(e,t)=>{const o=e._withMods||(e._withMods={}),a=t.join(".");return o[a]||(o[a]=((n,...i)=>{for(let l=0;l<t.length;l++){const u=ak[t[l]];if(u&&u(n,t))return}return e(n,...i)}))},ik={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},To=(e,t)=>{const o=e._withKeys||(e._withKeys={}),a=t.join(".");return o[a]||(o[a]=(n=>{if(!("key"in n))return;const i=Ra(n.key);if(t.some(l=>l===i||ik[l]===i))return e(n)}))},lk=Cn({patchProp:tk},O1);let ef;function rk(){return ef||(ef=m1(lk))}const ck=((...e)=>{const t=rk().createApp(...e),{mount:o}=t;return t.mount=a=>{const n=dk(a);if(!n)return;const i=t._component;!vt(i)&&!i.render&&!i.template&&(i.template=n.innerHTML),n.nodeType===1&&(n.textContent="");const l=o(n,!1,uk(n));return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),l},t});function uk(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function dk(e){return an(e)?document.querySelector(e):e}let sm;const Sc=e=>sm=e,am=Symbol();function Wu(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Vl;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Vl||(Vl={}));function hk(){const e=Hp(!0),t=e.run(()=>A({}));let o=[],a=[];const n=Sd({install(i){Sc(n),n._a=i,i.provide(am,n),i.config.globalProperties.$pinia=n,a.forEach(l=>o.push(l)),a=[]},use(i){return this._a?o.push(i):a.push(i),this},_p:o,_a:null,_e:e,_s:new Map,state:t});return n}const im=()=>{};function tf(e,t,o,a=im){e.add(t);const n=()=>{e.delete(t)&&a()};return!o&&Vp()&&Qg(n),n}function qi(e,...t){e.forEach(o=>{o(...t)})}const fk=e=>e(),nf=Symbol(),Qc=Symbol();function Ku(e,t){e instanceof Map&&t instanceof Map?t.forEach((o,a)=>e.set(a,o)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const o in t){if(!t.hasOwnProperty(o))continue;const a=t[o],n=e[o];Wu(n)&&Wu(a)&&e.hasOwnProperty(o)&&!sn(a)&&!Vs(a)?e[o]=Ku(n,a):e[o]=a}return e}const pk=Symbol();function vk(e){return!Wu(e)||!Object.prototype.hasOwnProperty.call(e,pk)}const{assign:ba}=Object;function mk(e){return!!(sn(e)&&e.effect)}function gk(e,t,o,a){const{state:n,actions:i,getters:l}=t,u=o.state.value[e];let d;function h(){u||(o.state.value[e]=n?n():{});const f=wy(o.state.value[e]);return ba(f,i,Object.keys(l||{}).reduce((m,y)=>(m[y]=Sd(V(()=>{Sc(o);const k=o._s.get(e);return l[y].call(k,k)})),m),{}))}return d=lm(e,h,t,o,a,!0),d}function lm(e,t,o={},a,n,i){let l;const u=ba({actions:{}},o),d={deep:!0};let h,f,m=new Set,y=new Set,k;const w=a.state.value[e];!i&&!w&&(a.state.value[e]={}),A({});let S;function T(B){let R;h=f=!1,typeof B=="function"?(B(a.state.value[e]),R={type:Vl.patchFunction,storeId:e,events:k}):(Ku(a.state.value[e],B),R={type:Vl.patchObject,payload:B,storeId:e,events:k});const U=S=Symbol();cn().then(()=>{S===U&&(h=!0)}),f=!0,qi(m,R,a.state.value[e])}const x=i?function(){const{state:R}=o,U=R?R():{};this.$patch(F=>{ba(F,U)})}:im;function C(){l.stop(),m.clear(),y.clear(),a._s.delete(e)}const _=(B,R="")=>{if(nf in B)return B[Qc]=R,B;const U=function(){Sc(a);const F=Array.from(arguments),j=new Set,Y=new Set;function oe(te){j.add(te)}function Oe(te){Y.add(te)}qi(y,{args:F,name:U[Qc],store:M,after:oe,onError:Oe});let ee;try{ee=B.apply(this&&this.$id===e?this:M,F)}catch(te){throw qi(Y,te),te}return ee instanceof Promise?ee.then(te=>(qi(j,te),te)).catch(te=>(qi(Y,te),Promise.reject(te))):(qi(j,ee),ee)};return U[nf]=!0,U[Qc]=R,U},$={_p:a,$id:e,$onAction:tf.bind(null,y),$patch:T,$reset:x,$subscribe(B,R={}){const U=tf(m,B,R.detached,()=>F()),F=l.run(()=>We(()=>a.state.value[e],j=>{(R.flush==="sync"?f:h)&&B({storeId:e,type:Vl.direct,events:k},j)},ba({},d,R)));return U},$dispose:C},M=bi($);a._s.set(e,M);const E=(a._a&&a._a.runWithContext||fk)(()=>a._e.run(()=>(l=Hp()).run(()=>t({action:_}))));for(const B in E){const R=E[B];if(sn(R)&&!mk(R)||Vs(R))i||(w&&vk(R)&&(sn(R)?R.value=w[B]:Ku(R,w[B])),a.state.value[e][B]=R);else if(typeof R=="function"){const U=_(R,B);E[B]=U,u.actions[B]=R}}return ba(M,E),ba(At(M),E),Object.defineProperty(M,"$state",{get:()=>a.state.value[e],set:B=>{T(R=>{ba(R,B)})}}),a._p.forEach(B=>{ba(M,l.run(()=>B({store:M,app:a._a,pinia:a,options:u})))}),w&&i&&o.hydrate&&o.hydrate(M.$state,w),h=!0,f=!0,M}function Dd(e,t,o){let a;const n=typeof t=="function";a=n?o:t;function i(l,u){const d=Ay();return l=l||(d?io(am,null):null),l&&Sc(l),l=sm,l._s.has(e)||(n?lm(e,t,a,l):gk(e,a,l)),l._s.get(e)}return i.$id=e,i}const Wi=typeof document<"u";function rm(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function yk(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&rm(e.default)}const Rt=Object.assign;function eu(e,t){const o={};for(const a in t){const n=t[a];o[a]=es(n)?n.map(e):e(n)}return o}const Gl=()=>{},es=Array.isArray;function of(e,t){const o={};for(const a in e)o[a]=a in t?t[a]:e[a];return o}const cm=/#/g,kk=/&/g,bk=/\//g,_k=/=/g,wk=/\?/g,um=/\+/g,Ck=/%5B/g,Lk=/%5D/g,dm=/%5E/g,Sk=/%60/g,hm=/%7B/g,Ik=/%7C/g,fm=/%7D/g,xk=/%20/g;function Rd(e){return e==null?"":encodeURI(""+e).replace(Ik,"|").replace(Ck,"[").replace(Lk,"]")}function $k(e){return Rd(e).replace(hm,"{").replace(fm,"}").replace(dm,"^")}function Ju(e){return Rd(e).replace(um,"%2B").replace(xk,"+").replace(cm,"%23").replace(kk,"%26").replace(Sk,"`").replace(hm,"{").replace(fm,"}").replace(dm,"^")}function Tk(e){return Ju(e).replace(_k,"%3D")}function Mk(e){return Rd(e).replace(cm,"%23").replace(wk,"%3F")}function Ak(e){return Mk(e).replace(bk,"%2F")}function nr(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const Ek=/\/$/,Pk=e=>e.replace(Ek,"");function tu(e,t,o="/"){let a,n={},i="",l="";const u=t.indexOf("#");let d=t.indexOf("?");return d=u>=0&&d>u?-1:d,d>=0&&(a=t.slice(0,d),i=t.slice(d,u>0?u:t.length),n=e(i.slice(1))),u>=0&&(a=a||t.slice(0,u),l=t.slice(u,t.length)),a=Bk(a??t,o),{fullPath:a+i+l,path:a,query:n,hash:nr(l)}}function Dk(e,t){const o=t.query?e(t.query):"";return t.path+(o&&"?")+o+(t.hash||"")}function sf(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Rk(e,t,o){const a=t.matched.length-1,n=o.matched.length-1;return a>-1&&a===n&&al(t.matched[a],o.matched[n])&&pm(t.params,o.params)&&e(t.query)===e(o.query)&&t.hash===o.hash}function al(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function pm(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var o in e)if(!Ok(e[o],t[o]))return!1;return!0}function Ok(e,t){return es(e)?af(e,t):es(t)?af(t,e):e?.valueOf()===t?.valueOf()}function af(e,t){return es(t)?e.length===t.length&&e.every((o,a)=>o===t[a]):e.length===1&&e[0]===t}function Bk(e,t){if(e.startsWith("/"))return e;if(!e)return t;const o=t.split("/"),a=e.split("/"),n=a[a.length-1];(n===".."||n===".")&&a.push("");let i=o.length-1,l,u;for(l=0;l<a.length;l++)if(u=a[l],u!==".")if(u==="..")i>1&&i--;else break;return o.slice(0,i).join("/")+"/"+a.slice(l).join("/")}const ya={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let Yu=(function(e){return e.pop="pop",e.push="push",e})({}),nu=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function Nk(e){if(!e)if(Wi){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Pk(e)}const Fk=/^[^#]+#/;function Uk(e,t){return e.replace(Fk,"#")+t}function zk(e,t){const o=document.documentElement.getBoundingClientRect(),a=e.getBoundingClientRect();return{behavior:t.behavior,left:a.left-o.left-(t.left||0),top:a.top-o.top-(t.top||0)}}const Ic=()=>({left:window.scrollX,top:window.scrollY});function Hk(e){let t;if("el"in e){const o=e.el,a=typeof o=="string"&&o.startsWith("#"),n=typeof o=="string"?a?document.getElementById(o.slice(1)):document.querySelector(o):o;if(!n)return;t=zk(n,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function lf(e,t){return(history.state?history.state.position-t:-1)+e}const Xu=new Map;function Vk(e,t){Xu.set(e,t)}function Gk(e){const t=Xu.get(e);return Xu.delete(e),t}function qk(e){return typeof e=="string"||e&&typeof e=="object"}function vm(e){return typeof e=="string"||typeof e=="symbol"}let rn=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const mm=Symbol("");rn.MATCHER_NOT_FOUND+"",rn.NAVIGATION_GUARD_REDIRECT+"",rn.NAVIGATION_ABORTED+"",rn.NAVIGATION_CANCELLED+"",rn.NAVIGATION_DUPLICATED+"";function il(e,t){return Rt(new Error,{type:e,[mm]:!0},t)}function Ps(e,t){return e instanceof Error&&mm in e&&(t==null||!!(e.type&t))}const jk=["params","query","hash"];function Zk(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const o of jk)o in e&&(t[o]=e[o]);return JSON.stringify(t,null,2)}function Wk(e){const t={};if(e===""||e==="?")return t;const o=(e[0]==="?"?e.slice(1):e).split("&");for(let a=0;a<o.length;++a){const n=o[a].replace(um," "),i=n.indexOf("="),l=nr(i<0?n:n.slice(0,i)),u=i<0?null:nr(n.slice(i+1));if(l in t){let d=t[l];es(d)||(d=t[l]=[d]),d.push(u)}else t[l]=u}return t}function rf(e){let t="";for(let o in e){const a=e[o];if(o=Tk(o),a==null){a!==void 0&&(t+=(t.length?"&":"")+o);continue}(es(a)?a.map(n=>n&&Ju(n)):[a&&Ju(a)]).forEach(n=>{n!==void 0&&(t+=(t.length?"&":"")+o,n!=null&&(t+="="+n))})}return t}function Kk(e){const t={};for(const o in e){const a=e[o];a!==void 0&&(t[o]=es(a)?a.map(n=>n==null?null:""+n):a==null?a:""+a)}return t}const Jk=Symbol(""),cf=Symbol(""),xc=Symbol(""),Od=Symbol(""),Qu=Symbol("");function xl(){let e=[];function t(a){return e.push(a),()=>{const n=e.indexOf(a);n>-1&&e.splice(n,1)}}function o(){e=[]}return{add:t,list:()=>e.slice(),reset:o}}function Sa(e,t,o,a,n,i=l=>l()){const l=a&&(a.enterCallbacks[n]=a.enterCallbacks[n]||[]);return()=>new Promise((u,d)=>{const h=y=>{y===!1?d(il(rn.NAVIGATION_ABORTED,{from:o,to:t})):y instanceof Error?d(y):qk(y)?d(il(rn.NAVIGATION_GUARD_REDIRECT,{from:t,to:y})):(l&&a.enterCallbacks[n]===l&&typeof y=="function"&&l.push(y),u())},f=i(()=>e.call(a&&a.instances[n],t,o,h));let m=Promise.resolve(f);e.length<3&&(m=m.then(h)),m.catch(y=>d(y))})}function ou(e,t,o,a,n=i=>i()){const i=[];for(const l of e)for(const u in l.components){let d=l.components[u];if(!(t!=="beforeRouteEnter"&&!l.instances[u]))if(rm(d)){const h=(d.__vccOpts||d)[t];h&&i.push(Sa(h,o,a,l,u,n))}else{let h=d();i.push(()=>h.then(f=>{if(!f)throw new Error(`Couldn't resolve component "${u}" at "${l.path}"`);const m=yk(f)?f.default:f;l.mods[u]=f,l.components[u]=m;const y=(m.__vccOpts||m)[t];return y&&Sa(y,o,a,l,u,n)()}))}}return i}function Yk(e,t){const o=[],a=[],n=[],i=Math.max(t.matched.length,e.matched.length);for(let l=0;l<i;l++){const u=t.matched[l];u&&(e.matched.find(h=>al(h,u))?a.push(u):o.push(u));const d=e.matched[l];d&&(t.matched.find(h=>al(h,d))||n.push(d))}return[o,a,n]}let Xk=()=>location.protocol+"//"+location.host;function gm(e,t){const{pathname:o,search:a,hash:n}=t,i=e.indexOf("#");if(i>-1){let l=n.includes(e.slice(i))?e.slice(i).length:1,u=n.slice(l);return u[0]!=="/"&&(u="/"+u),sf(u,"")}return sf(o,e)+a+n}function Qk(e,t,o,a){let n=[],i=[],l=null;const u=({state:y})=>{const k=gm(e,location),w=o.value,S=t.value;let T=0;if(y){if(o.value=k,t.value=y,l&&l===w){l=null;return}T=S?y.position-S.position:0}else a(k);n.forEach(x=>{x(o.value,w,{delta:T,type:Yu.pop,direction:T?T>0?nu.forward:nu.back:nu.unknown})})};function d(){l=o.value}function h(y){n.push(y);const k=()=>{const w=n.indexOf(y);w>-1&&n.splice(w,1)};return i.push(k),k}function f(){if(document.visibilityState==="hidden"){const{history:y}=window;if(!y.state)return;y.replaceState(Rt({},y.state,{scroll:Ic()}),"")}}function m(){for(const y of i)y();i=[],window.removeEventListener("popstate",u),window.removeEventListener("pagehide",f),document.removeEventListener("visibilitychange",f)}return window.addEventListener("popstate",u),window.addEventListener("pagehide",f),document.addEventListener("visibilitychange",f),{pauseListeners:d,listen:h,destroy:m}}function uf(e,t,o,a=!1,n=!1){return{back:e,current:t,forward:o,replaced:a,position:window.history.length,scroll:n?Ic():null}}function e0(e){const{history:t,location:o}=window,a={value:gm(e,o)},n={value:t.state};n.value||i(a.value,{back:null,current:a.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(d,h,f){const m=e.indexOf("#"),y=m>-1?(o.host&&document.querySelector("base")?e:e.slice(m))+d:Xk()+e+d;try{t[f?"replaceState":"pushState"](h,"",y),n.value=h}catch(k){console.error(k),o[f?"replace":"assign"](y)}}function l(d,h){i(d,Rt({},t.state,uf(n.value.back,d,n.value.forward,!0),h,{position:n.value.position}),!0),a.value=d}function u(d,h){const f=Rt({},n.value,t.state,{forward:d,scroll:Ic()});i(f.current,f,!0),i(d,Rt({},uf(a.value,d,null),{position:f.position+1},h),!1),a.value=d}return{location:a,state:n,push:u,replace:l}}function t0(e){e=Nk(e);const t=e0(e),o=Qk(e,t.state,t.location,t.replace);function a(i,l=!0){l||o.pauseListeners(),history.go(i)}const n=Rt({location:"",base:e,go:a,createHref:Uk.bind(null,e)},t,o);return Object.defineProperty(n,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(n,"state",{enumerable:!0,get:()=>t.state.value}),n}function n0(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),t0(e)}let hi=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var yn=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(yn||{});const o0={type:hi.Static,value:""},s0=/[a-zA-Z0-9_]/;function a0(e){if(!e)return[[]];if(e==="/")return[[o0]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(k){throw new Error(`ERR (${o})/"${h}": ${k}`)}let o=yn.Static,a=o;const n=[];let i;function l(){i&&n.push(i),i=[]}let u=0,d,h="",f="";function m(){h&&(o===yn.Static?i.push({type:hi.Static,value:h}):o===yn.Param||o===yn.ParamRegExp||o===yn.ParamRegExpEnd?(i.length>1&&(d==="*"||d==="+")&&t(`A repeatable param (${h}) must be alone in its segment. eg: '/:ids+.`),i.push({type:hi.Param,value:h,regexp:f,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):t("Invalid state to consume buffer"),h="")}function y(){h+=d}for(;u<e.length;){if(d=e[u++],d==="\\"&&o!==yn.ParamRegExp){a=o,o=yn.EscapeNext;continue}switch(o){case yn.Static:d==="/"?(h&&m(),l()):d===":"?(m(),o=yn.Param):y();break;case yn.EscapeNext:y(),o=a;break;case yn.Param:d==="("?o=yn.ParamRegExp:s0.test(d)?y():(m(),o=yn.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--);break;case yn.ParamRegExp:d===")"?f[f.length-1]=="\\"?f=f.slice(0,-1)+d:o=yn.ParamRegExpEnd:f+=d;break;case yn.ParamRegExpEnd:m(),o=yn.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--,f="";break;default:t("Unknown state");break}}return o===yn.ParamRegExp&&t(`Unfinished custom RegExp for param "${h}"`),m(),l(),n}const df="[^/]+?",i0={sensitive:!1,strict:!1,start:!0,end:!0};var Jn=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(Jn||{});const l0=/[.+*?^${}()[\]/\\]/g;function r0(e,t){const o=Rt({},i0,t),a=[];let n=o.start?"^":"";const i=[];for(const h of e){const f=h.length?[]:[Jn.Root];o.strict&&!h.length&&(n+="/");for(let m=0;m<h.length;m++){const y=h[m];let k=Jn.Segment+(o.sensitive?Jn.BonusCaseSensitive:0);if(y.type===hi.Static)m||(n+="/"),n+=y.value.replace(l0,"\\$&"),k+=Jn.Static;else if(y.type===hi.Param){const{value:w,repeatable:S,optional:T,regexp:x}=y;i.push({name:w,repeatable:S,optional:T});const C=x||df;if(C!==df){k+=Jn.BonusCustomRegExp;try{`${C}`}catch($){throw new Error(`Invalid custom RegExp for param "${w}" (${C}): `+$.message)}}let _=S?`((?:${C})(?:/(?:${C}))*)`:`(${C})`;m||(_=T&&h.length<2?`(?:/${_})`:"/"+_),T&&(_+="?"),n+=_,k+=Jn.Dynamic,T&&(k+=Jn.BonusOptional),S&&(k+=Jn.BonusRepeatable),C===".*"&&(k+=Jn.BonusWildcard)}f.push(k)}a.push(f)}if(o.strict&&o.end){const h=a.length-1;a[h][a[h].length-1]+=Jn.BonusStrict}o.strict||(n+="/?"),o.end?n+="$":o.strict&&!n.endsWith("/")&&(n+="(?:/|$)");const l=new RegExp(n,o.sensitive?"":"i");function u(h){const f=h.match(l),m={};if(!f)return null;for(let y=1;y<f.length;y++){const k=f[y]||"",w=i[y-1];m[w.name]=k&&w.repeatable?k.split("/"):k}return m}function d(h){let f="",m=!1;for(const y of e){(!m||!f.endsWith("/"))&&(f+="/"),m=!1;for(const k of y)if(k.type===hi.Static)f+=k.value;else if(k.type===hi.Param){const{value:w,repeatable:S,optional:T}=k,x=w in h?h[w]:"";if(es(x)&&!S)throw new Error(`Provided param "${w}" is an array but it is not repeatable (* or + modifiers)`);const C=es(x)?x.join("/"):x;if(!C)if(T)y.length<2&&(f.endsWith("/")?f=f.slice(0,-1):m=!0);else throw new Error(`Missing required param "${w}"`);f+=C}}return f||"/"}return{re:l,score:a,keys:i,parse:u,stringify:d}}function c0(e,t){let o=0;for(;o<e.length&&o<t.length;){const a=t[o]-e[o];if(a)return a;o++}return e.length<t.length?e.length===1&&e[0]===Jn.Static+Jn.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===Jn.Static+Jn.Segment?1:-1:0}function ym(e,t){let o=0;const a=e.score,n=t.score;for(;o<a.length&&o<n.length;){const i=c0(a[o],n[o]);if(i)return i;o++}if(Math.abs(n.length-a.length)===1){if(hf(a))return 1;if(hf(n))return-1}return n.length-a.length}function hf(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const u0={strict:!1,end:!0,sensitive:!1};function d0(e,t,o){const a=r0(a0(e.path),o),n=Rt(a,{record:e,parent:t,children:[],alias:[]});return t&&!n.record.aliasOf==!t.record.aliasOf&&t.children.push(n),n}function h0(e,t){const o=[],a=new Map;t=of(u0,t);function n(m){return a.get(m)}function i(m,y,k){const w=!k,S=pf(m);S.aliasOf=k&&k.record;const T=of(t,m),x=[S];if("alias"in m){const $=typeof m.alias=="string"?[m.alias]:m.alias;for(const M of $)x.push(pf(Rt({},S,{components:k?k.record.components:S.components,path:M,aliasOf:k?k.record:S})))}let C,_;for(const $ of x){const{path:M}=$;if(y&&M[0]!=="/"){const H=y.record.path,E=H[H.length-1]==="/"?"":"/";$.path=y.record.path+(M&&E+M)}if(C=d0($,y,T),k?k.alias.push(C):(_=_||C,_!==C&&_.alias.push(C),w&&m.name&&!vf(C)&&l(m.name)),km(C)&&d(C),S.children){const H=S.children;for(let E=0;E<H.length;E++)i(H[E],C,k&&k.children[E])}k=k||C}return _?()=>{l(_)}:Gl}function l(m){if(vm(m)){const y=a.get(m);y&&(a.delete(m),o.splice(o.indexOf(y),1),y.children.forEach(l),y.alias.forEach(l))}else{const y=o.indexOf(m);y>-1&&(o.splice(y,1),m.record.name&&a.delete(m.record.name),m.children.forEach(l),m.alias.forEach(l))}}function u(){return o}function d(m){const y=v0(m,o);o.splice(y,0,m),m.record.name&&!vf(m)&&a.set(m.record.name,m)}function h(m,y){let k,w={},S,T;if("name"in m&&m.name){if(k=a.get(m.name),!k)throw il(rn.MATCHER_NOT_FOUND,{location:m});T=k.record.name,w=Rt(ff(y.params,k.keys.filter(_=>!_.optional).concat(k.parent?k.parent.keys.filter(_=>_.optional):[]).map(_=>_.name)),m.params&&ff(m.params,k.keys.map(_=>_.name))),S=k.stringify(w)}else if(m.path!=null)S=m.path,k=o.find(_=>_.re.test(S)),k&&(w=k.parse(S),T=k.record.name);else{if(k=y.name?a.get(y.name):o.find(_=>_.re.test(y.path)),!k)throw il(rn.MATCHER_NOT_FOUND,{location:m,currentLocation:y});T=k.record.name,w=Rt({},y.params,m.params),S=k.stringify(w)}const x=[];let C=k;for(;C;)x.unshift(C.record),C=C.parent;return{name:T,path:S,params:w,matched:x,meta:p0(x)}}e.forEach(m=>i(m));function f(){o.length=0,a.clear()}return{addRoute:i,resolve:h,removeRoute:l,clearRoutes:f,getRoutes:u,getRecordMatcher:n}}function ff(e,t){const o={};for(const a of t)a in e&&(o[a]=e[a]);return o}function pf(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:f0(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function f0(e){const t={},o=e.props||!1;if("component"in e)t.default=o;else for(const a in e.components)t[a]=typeof o=="object"?o[a]:o;return t}function vf(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function p0(e){return e.reduce((t,o)=>Rt(t,o.meta),{})}function v0(e,t){let o=0,a=t.length;for(;o!==a;){const i=o+a>>1;ym(e,t[i])<0?a=i:o=i+1}const n=m0(e);return n&&(a=t.lastIndexOf(n,a-1)),a}function m0(e){let t=e;for(;t=t.parent;)if(km(t)&&ym(e,t)===0)return t}function km({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function mf(e){const t=io(xc),o=io(Od),a=V(()=>{const d=N(e.to);return t.resolve(d)}),n=V(()=>{const{matched:d}=a.value,{length:h}=d,f=d[h-1],m=o.matched;if(!f||!m.length)return-1;const y=m.findIndex(al.bind(null,f));if(y>-1)return y;const k=gf(d[h-2]);return h>1&&gf(f)===k&&m[m.length-1].path!==k?m.findIndex(al.bind(null,d[h-2])):y}),i=V(()=>n.value>-1&&_0(o.params,a.value.params)),l=V(()=>n.value>-1&&n.value===o.matched.length-1&&pm(o.params,a.value.params));function u(d={}){if(b0(d)){const h=t[N(e.replace)?"replace":"push"](N(e.to)).catch(Gl);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>h),h}return Promise.resolve()}return{route:a,href:V(()=>a.value.href),isActive:i,isExactActive:l,navigate:u}}function g0(e){return e.length===1?e[0]:e}const y0=Lv({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:mf,setup(e,{slots:t}){const o=bi(mf(e)),{options:a}=io(xc),n=V(()=>({[yf(e.activeClass,a.linkActiveClass,"router-link-active")]:o.isActive,[yf(e.exactActiveClass,a.linkExactActiveClass,"router-link-exact-active")]:o.isExactActive}));return()=>{const i=t.default&&g0(t.default(o));return e.custom?i:Pd("a",{"aria-current":o.isExactActive?e.ariaCurrentValue:null,href:o.href,onClick:o.navigate,class:n.value},i)}}}),k0=y0;function b0(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function _0(e,t){for(const o in t){const a=t[o],n=e[o];if(typeof a=="string"){if(a!==n)return!1}else if(!es(n)||n.length!==a.length||a.some((i,l)=>i.valueOf()!==n[l].valueOf()))return!1}return!0}function gf(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const yf=(e,t,o)=>e??t??o,w0=Lv({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:o}){const a=io(Qu),n=V(()=>e.route||a.value),i=io(cf,0),l=V(()=>{let h=N(i);const{matched:f}=n.value;let m;for(;(m=f[h])&&!m.components;)h++;return h}),u=V(()=>n.value.matched[l.value]);Bl(cf,V(()=>l.value+1)),Bl(Jk,u),Bl(Qu,n);const d=A();return We(()=>[d.value,u.value,e.name],([h,f,m],[y,k,w])=>{f&&(f.instances[m]=h,k&&k!==f&&h&&h===y&&(f.leaveGuards.size||(f.leaveGuards=k.leaveGuards),f.updateGuards.size||(f.updateGuards=k.updateGuards))),h&&f&&(!k||!al(f,k)||!y)&&(f.enterCallbacks[m]||[]).forEach(S=>S(h))},{flush:"post"}),()=>{const h=n.value,f=e.name,m=u.value,y=m&&m.components[f];if(!y)return kf(o.default,{Component:y,route:h});const k=m.props[f],w=k?k===!0?h.params:typeof k=="function"?k(h):k:null,T=Pd(y,Rt({},w,t,{onVnodeUnmounted:x=>{x.component.isUnmounted&&(m.instances[f]=null)},ref:d}));return kf(o.default,{Component:T,route:h})||T}}});function kf(e,t){if(!e)return null;const o=e(t);return o.length===1?o[0]:o}const C0=w0;function L0(e){const t=h0(e.routes,e),o=e.parseQuery||Wk,a=e.stringifyQuery||rf,n=e.history,i=xl(),l=xl(),u=xl(),d=ky(ya);let h=ya;Wi&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const f=eu.bind(null,Q=>""+Q),m=eu.bind(null,Ak),y=eu.bind(null,nr);function k(Q,ye){let Ce,me;return vm(Q)?(Ce=t.getRecordMatcher(Q),me=ye):me=Q,t.addRoute(me,Ce)}function w(Q){const ye=t.getRecordMatcher(Q);ye&&t.removeRoute(ye)}function S(){return t.getRoutes().map(Q=>Q.record)}function T(Q){return!!t.getRecordMatcher(Q)}function x(Q,ye){if(ye=Rt({},ye||d.value),typeof Q=="string"){const se=tu(o,Q,ye.path),Ee=t.resolve({path:se.path},ye),Be=n.createHref(se.fullPath);return Rt(se,Ee,{params:y(Ee.params),hash:nr(se.hash),redirectedFrom:void 0,href:Be})}let Ce;if(Q.path!=null)Ce=Rt({},Q,{path:tu(o,Q.path,ye.path).path});else{const se=Rt({},Q.params);for(const Ee in se)se[Ee]==null&&delete se[Ee];Ce=Rt({},Q,{params:m(se)}),ye.params=m(ye.params)}const me=t.resolve(Ce,ye),ie=Q.hash||"";me.params=f(y(me.params));const z=Dk(a,Rt({},Q,{hash:$k(ie),path:me.path})),K=n.createHref(z);return Rt({fullPath:z,hash:ie,query:a===rf?Kk(Q.query):Q.query||{}},me,{redirectedFrom:void 0,href:K})}function C(Q){return typeof Q=="string"?tu(o,Q,d.value.path):Rt({},Q)}function _(Q,ye){if(h!==Q)return il(rn.NAVIGATION_CANCELLED,{from:ye,to:Q})}function $(Q){return E(Q)}function M(Q){return $(Rt(C(Q),{replace:!0}))}function H(Q,ye){const Ce=Q.matched[Q.matched.length-1];if(Ce&&Ce.redirect){const{redirect:me}=Ce;let ie=typeof me=="function"?me(Q,ye):me;return typeof ie=="string"&&(ie=ie.includes("?")||ie.includes("#")?ie=C(ie):{path:ie},ie.params={}),Rt({query:Q.query,hash:Q.hash,params:ie.path!=null?{}:Q.params},ie)}}function E(Q,ye){const Ce=h=x(Q),me=d.value,ie=Q.state,z=Q.force,K=Q.replace===!0,se=H(Ce,me);if(se)return E(Rt(C(se),{state:typeof se=="object"?Rt({},ie,se.state):ie,force:z,replace:K}),ye||Ce);const Ee=Ce;Ee.redirectedFrom=ye;let Be;return!z&&Rk(a,me,Ce)&&(Be=il(rn.NAVIGATION_DUPLICATED,{to:Ee,from:me}),pe(me,me,!0,!1)),(Be?Promise.resolve(Be):U(Ee,me)).catch(Re=>Ps(Re)?Ps(Re,rn.NAVIGATION_GUARD_REDIRECT)?Re:ne(Re):O(Re,Ee,me)).then(Re=>{if(Re){if(Ps(Re,rn.NAVIGATION_GUARD_REDIRECT))return E(Rt({replace:K},C(Re.to),{state:typeof Re.to=="object"?Rt({},ie,Re.to.state):ie,force:z}),ye||Ee)}else Re=j(Ee,me,!0,K,ie);return F(Ee,me,Re),Re})}function B(Q,ye){const Ce=_(Q,ye);return Ce?Promise.reject(Ce):Promise.resolve()}function R(Q){const ye=Ne.values().next().value;return ye&&typeof ye.runWithContext=="function"?ye.runWithContext(Q):Q()}function U(Q,ye){let Ce;const[me,ie,z]=Yk(Q,ye);Ce=ou(me.reverse(),"beforeRouteLeave",Q,ye);for(const se of me)se.leaveGuards.forEach(Ee=>{Ce.push(Sa(Ee,Q,ye))});const K=B.bind(null,Q,ye);return Ce.push(K),Xe(Ce).then(()=>{Ce=[];for(const se of i.list())Ce.push(Sa(se,Q,ye));return Ce.push(K),Xe(Ce)}).then(()=>{Ce=ou(ie,"beforeRouteUpdate",Q,ye);for(const se of ie)se.updateGuards.forEach(Ee=>{Ce.push(Sa(Ee,Q,ye))});return Ce.push(K),Xe(Ce)}).then(()=>{Ce=[];for(const se of z)if(se.beforeEnter)if(es(se.beforeEnter))for(const Ee of se.beforeEnter)Ce.push(Sa(Ee,Q,ye));else Ce.push(Sa(se.beforeEnter,Q,ye));return Ce.push(K),Xe(Ce)}).then(()=>(Q.matched.forEach(se=>se.enterCallbacks={}),Ce=ou(z,"beforeRouteEnter",Q,ye,R),Ce.push(K),Xe(Ce))).then(()=>{Ce=[];for(const se of l.list())Ce.push(Sa(se,Q,ye));return Ce.push(K),Xe(Ce)}).catch(se=>Ps(se,rn.NAVIGATION_CANCELLED)?se:Promise.reject(se))}function F(Q,ye,Ce){u.list().forEach(me=>R(()=>me(Q,ye,Ce)))}function j(Q,ye,Ce,me,ie){const z=_(Q,ye);if(z)return z;const K=ye===ya,se=Wi?history.state:{};Ce&&(me||K?n.replace(Q.fullPath,Rt({scroll:K&&se&&se.scroll},ie)):n.push(Q.fullPath,ie)),d.value=Q,pe(Q,ye,Ce,K),ne()}let Y;function oe(){Y||(Y=n.listen((Q,ye,Ce)=>{if(!Ge.listening)return;const me=x(Q),ie=H(me,Ge.currentRoute.value);if(ie){E(Rt(ie,{replace:!0,force:!0}),me).catch(Gl);return}h=me;const z=d.value;Wi&&Vk(lf(z.fullPath,Ce.delta),Ic()),U(me,z).catch(K=>Ps(K,rn.NAVIGATION_ABORTED|rn.NAVIGATION_CANCELLED)?K:Ps(K,rn.NAVIGATION_GUARD_REDIRECT)?(E(Rt(C(K.to),{force:!0}),me).then(se=>{Ps(se,rn.NAVIGATION_ABORTED|rn.NAVIGATION_DUPLICATED)&&!Ce.delta&&Ce.type===Yu.pop&&n.go(-1,!1)}).catch(Gl),Promise.reject()):(Ce.delta&&n.go(-Ce.delta,!1),O(K,me,z))).then(K=>{K=K||j(me,z,!1),K&&(Ce.delta&&!Ps(K,rn.NAVIGATION_CANCELLED)?n.go(-Ce.delta,!1):Ce.type===Yu.pop&&Ps(K,rn.NAVIGATION_ABORTED|rn.NAVIGATION_DUPLICATED)&&n.go(-1,!1)),F(me,z,K)}).catch(Gl)}))}let Oe=xl(),ee=xl(),te;function O(Q,ye,Ce){ne(Q);const me=ee.list();return me.length?me.forEach(ie=>ie(Q,ye,Ce)):console.error(Q),Promise.reject(Q)}function Z(){return te&&d.value!==ya?Promise.resolve():new Promise((Q,ye)=>{Oe.add([Q,ye])})}function ne(Q){return te||(te=!Q,oe(),Oe.list().forEach(([ye,Ce])=>Q?Ce(Q):ye()),Oe.reset()),Q}function pe(Q,ye,Ce,me){const{scrollBehavior:ie}=e;if(!Wi||!ie)return Promise.resolve();const z=!Ce&&Gk(lf(Q.fullPath,0))||(me||!Ce)&&history.state&&history.state.scroll||null;return cn().then(()=>ie(Q,ye,z)).then(K=>K&&Hk(K)).catch(K=>O(K,Q,ye))}const we=Q=>n.go(Q);let Ze;const Ne=new Set,Ge={currentRoute:d,listening:!0,addRoute:k,removeRoute:w,clearRoutes:t.clearRoutes,hasRoute:T,getRoutes:S,resolve:x,options:e,push:$,replace:M,go:we,back:()=>we(-1),forward:()=>we(1),beforeEach:i.add,beforeResolve:l.add,afterEach:u.add,onError:ee.add,isReady:Z,install(Q){Q.component("RouterLink",k0),Q.component("RouterView",C0),Q.config.globalProperties.$router=Ge,Object.defineProperty(Q.config.globalProperties,"$route",{enumerable:!0,get:()=>N(d)}),Wi&&!Ze&&d.value===ya&&(Ze=!0,$(n.location).catch(me=>{}));const ye={};for(const me in ya)Object.defineProperty(ye,me,{get:()=>d.value[me],enumerable:!0});Q.provide(xc,Ge),Q.provide(Od,sv(ye)),Q.provide(Qu,d);const Ce=Q.unmount;Ne.add(Q),Q.unmount=function(){Ne.delete(Q),Ne.size<1&&(h=ya,Y&&Y(),Y=null,d.value=ya,Ze=!1,te=!1),Ce()}}};function Xe(Q){return Q.reduce((ye,Ce)=>ye.then(()=>R(Ce)),Promise.resolve())}return Ge}function cl(){return io(xc)}function $c(e){return io(Od)}const S0=500,I0=3e3,x0=500,ci=A(new Map),Bd=A(!1),Qr=A("");let $0=0,ql=null;function T0(e){const t=(e||"get").toUpperCase();return["POST","PUT","PATCH","DELETE"].includes(t)?{message:"Saving...",delay:S0}:{message:"Loading...",delay:I0}}function M0(){ql&&(clearTimeout(ql),ql=null)}function A0(e){if(e.skipLoadingOverlay)return null;M0();const t=++$0,{message:o,delay:a}=T0(e.method),n=setTimeout(()=>{ci.value.has(t)&&(Qr.value=o,Bd.value=!0)},a);return ci.value.set(t,{config:e,message:o,timeoutId:n}),e._loadingRequestId=t,t}function bf(e){if(e===null)return;const t=ci.value.get(e);if(t)if(clearTimeout(t.timeoutId),ci.value.delete(e),ci.value.size===0)ql=setTimeout(()=>{ci.value.size===0&&(Bd.value=!1,Qr.value=""),ql=null},x0);else{const o=ci.value.values().next().value;o&&(Qr.value=o.message)}}function _f(e){return e?._loadingRequestId}function E0(){return{showOverlay:Bd,overlayMessage:Qr}}const He=(e,t)=>{const o=e.__vccOpts||e;for(const[a,n]of t)o[a]=n;return o},P0={key:0,class:"loading-overlay"},D0={class:"loading-content"},R0={class:"loading-message"},O0={__name:"LoadingOverlay",setup(e){const{showOverlay:t,overlayMessage:o}=E0();return(a,n)=>(v(),Ke(Jo,{name:"fade"},{default:Fe(()=>[N(t)?(v(),g("div",P0,[r("div",D0,[n[0]||(n[0]=r("div",{class:"spinner"},null,-1)),r("p",R0,I(N(o)||"Loading..."),1)])])):D("",!0)]),_:1}))}},B0=He(O0,[["__scopeId","data-v-fdee3530"]]),N0={__name:"App",setup(e){const t=cl(),o=A(""),a=["/","/sessions"];return We(()=>t.currentRoute.value,(n,i)=>{if(!i?.path){o.value="";return}const l=a.indexOf(n.path),u=a.indexOf(i.path);l!==-1&&u!==-1?o.value=l>u?"slide-left":"slide-right":o.value=""},{immediate:!0}),(n,i)=>{const l=xd("router-view");return v(),g(Ae,null,[Me(l,null,{default:Fe(({Component:u,route:d})=>[Me(Jo,{name:o.value,mode:"out-in"},{default:Fe(()=>[(v(),Ke(Wy(u),{key:d.path}))]),_:2},1032,["name"])]),_:1}),Me(B0)],64)}}},ul="marshalSessions",F0=30;function ec(e,t){return`${e}:${t}`}function Nd(e){const[t,o]=e.split(":");return{eventId:t,marshalId:o}}function Oa(){try{return JSON.parse(localStorage.getItem(ul)||"{}")}catch{return{}}}function tc(e){const t=Oa(),o=Object.entries(t).filter(([a])=>a.startsWith(`${e}:`)).map(([a,n])=>({sessionKey:a,...n}));return o.length===0?null:(o.sort((a,n)=>new Date(n.lastAccessed)-new Date(a.lastAccessed)),o[0])}function wf(e,t){if(!t.marshalId){console.error("Cannot save session without marshalId");return}const o=Oa(),a=ec(e,t.marshalId);o[a]={...o[a],...t,eventId:e,lastAccessed:new Date().toISOString()},localStorage.setItem(ul,JSON.stringify(o))}function ed(e){const t=Oa(),{eventId:o,marshalId:a}=Nd(e);delete t[e],localStorage.setItem(ul,JSON.stringify(t)),localStorage.removeItem(`marshalCode_${o}_${a}`)}function bm(e,t){const o=Oa(),a=ec(e,t);o[a]&&(o[a].lastAccessed=new Date().toISOString(),localStorage.setItem(ul,JSON.stringify(o)))}function _m(){const e=Oa(),t=new Date;t.setDate(t.getDate()-F0);let o=!1;for(const a of Object.keys(e))if(new Date(e[a].lastAccessed)<t){const{eventId:i,marshalId:l}=Nd(a);delete e[a],localStorage.removeItem(`marshalCode_${i}_${l}`),o=!0}o&&localStorage.setItem(ul,JSON.stringify(e))}function wm(){const e=Oa(),t=[];for(let a=0;a<localStorage.length;a++){const n=localStorage.key(a);if(n&&n.startsWith("marshal_")&&!n.startsWith("marshalCode_")&&!n.startsWith("marshalSessions")){const i=n.replace("marshal_",""),l=localStorage.getItem(n);if(l){const u=ec(i,l);e[u]||(e[u]={marshalId:l,eventId:i,token:null,lastAccessed:new Date().toISOString()})}t.push(n)}}const o=Object.keys(e).filter(a=>!a.includes(":"));for(const a of o){const n=e[a];if(n&&n.marshalId){const i=ec(a,n.marshalId);e[i]||(e[i]={...n,eventId:a}),delete e[a]}}(t.length>0||o.length>0)&&(localStorage.setItem(ul,JSON.stringify(e)),t.forEach(a=>localStorage.removeItem(a)))}function U0(){const e=Oa();return Object.entries(e).map(([t,o])=>{const{eventId:a,marshalId:n}=Nd(t);return{sessionKey:t,eventId:a,marshalId:n,...o}}).filter(t=>t.token).sort((t,o)=>t.eventDate&&o.eventDate?new Date(t.eventDate)-new Date(o.eventDate):new Date(o.lastAccessed)-new Date(t.lastAccessed))}function Cm(){const e=Oa();return Object.values(e).some(t=>t.token)}function Lm(e,t){const o=`marshalCode_${e}_${t}`,a=localStorage.getItem(o);return a||localStorage.getItem(`marshalCode_${e}`)}function z0(e,t,o){localStorage.setItem(`marshalCode_${e}_${t}`,o)}function Sm(e,t){return function(){return e.apply(t,arguments)}}const{toString:H0}=Object.prototype,{getPrototypeOf:Fd}=Object,{iterator:Tc,toStringTag:Im}=Symbol,Mc=(e=>t=>{const o=H0.call(t);return e[o]||(e[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),ts=e=>(e=e.toLowerCase(),t=>Mc(t)===e),Ac=e=>t=>typeof t===e,{isArray:dl}=Array,ll=Ac("undefined");function rr(e){return e!==null&&!ll(e)&&e.constructor!==null&&!ll(e.constructor)&&lo(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const xm=ts("ArrayBuffer");function V0(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&xm(e.buffer),t}const G0=Ac("string"),lo=Ac("function"),$m=Ac("number"),cr=e=>e!==null&&typeof e=="object",q0=e=>e===!0||e===!1,Br=e=>{if(Mc(e)!=="object")return!1;const t=Fd(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Im in e)&&!(Tc in e)},j0=e=>{if(!cr(e)||rr(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Z0=ts("Date"),W0=ts("File"),K0=ts("Blob"),J0=ts("FileList"),Y0=e=>cr(e)&&lo(e.pipe),X0=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||lo(e.append)&&((t=Mc(e))==="formdata"||t==="object"&&lo(e.toString)&&e.toString()==="[object FormData]"))},Q0=ts("URLSearchParams"),[eb,tb,nb,ob]=["ReadableStream","Request","Response","Headers"].map(ts),sb=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ur(e,t,{allOwnKeys:o=!1}={}){if(e===null||typeof e>"u")return;let a,n;if(typeof e!="object"&&(e=[e]),dl(e))for(a=0,n=e.length;a<n;a++)t.call(null,e[a],a,e);else{if(rr(e))return;const i=o?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let u;for(a=0;a<l;a++)u=i[a],t.call(null,e[u],u,e)}}function Tm(e,t){if(rr(e))return null;t=t.toLowerCase();const o=Object.keys(e);let a=o.length,n;for(;a-- >0;)if(n=o[a],t===n.toLowerCase())return n;return null}const fi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Mm=e=>!ll(e)&&e!==fi;function td(){const{caseless:e,skipUndefined:t}=Mm(this)&&this||{},o={},a=(n,i)=>{const l=e&&Tm(o,i)||i;Br(o[l])&&Br(n)?o[l]=td(o[l],n):Br(n)?o[l]=td({},n):dl(n)?o[l]=n.slice():(!t||!ll(n))&&(o[l]=n)};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&ur(arguments[n],a);return o}const ab=(e,t,o,{allOwnKeys:a}={})=>(ur(t,(n,i)=>{o&&lo(n)?e[i]=Sm(n,o):e[i]=n},{allOwnKeys:a}),e),ib=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),lb=(e,t,o,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),o&&Object.assign(e.prototype,o)},rb=(e,t,o,a)=>{let n,i,l;const u={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),i=n.length;i-- >0;)l=n[i],(!a||a(l,e,t))&&!u[l]&&(t[l]=e[l],u[l]=!0);e=o!==!1&&Fd(e)}while(e&&(!o||o(e,t))&&e!==Object.prototype);return t},cb=(e,t,o)=>{e=String(e),(o===void 0||o>e.length)&&(o=e.length),o-=t.length;const a=e.indexOf(t,o);return a!==-1&&a===o},ub=e=>{if(!e)return null;if(dl(e))return e;let t=e.length;if(!$m(t))return null;const o=new Array(t);for(;t-- >0;)o[t]=e[t];return o},db=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Fd(Uint8Array)),hb=(e,t)=>{const a=(e&&e[Tc]).call(e);let n;for(;(n=a.next())&&!n.done;){const i=n.value;t.call(e,i[0],i[1])}},fb=(e,t)=>{let o;const a=[];for(;(o=e.exec(t))!==null;)a.push(o);return a},pb=ts("HTMLFormElement"),vb=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,a,n){return a.toUpperCase()+n}),Cf=(({hasOwnProperty:e})=>(t,o)=>e.call(t,o))(Object.prototype),mb=ts("RegExp"),Am=(e,t)=>{const o=Object.getOwnPropertyDescriptors(e),a={};ur(o,(n,i)=>{let l;(l=t(n,i,e))!==!1&&(a[i]=l||n)}),Object.defineProperties(e,a)},gb=e=>{Am(e,(t,o)=>{if(lo(e)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const a=e[o];if(lo(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},yb=(e,t)=>{const o={},a=n=>{n.forEach(i=>{o[i]=!0})};return dl(e)?a(e):a(String(e).split(t)),o},kb=()=>{},bb=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function _b(e){return!!(e&&lo(e.append)&&e[Im]==="FormData"&&e[Tc])}const wb=e=>{const t=new Array(10),o=(a,n)=>{if(cr(a)){if(t.indexOf(a)>=0)return;if(rr(a))return a;if(!("toJSON"in a)){t[n]=a;const i=dl(a)?[]:{};return ur(a,(l,u)=>{const d=o(l,n+1);!ll(d)&&(i[u]=d)}),t[n]=void 0,i}}return a};return o(e,0)},Cb=ts("AsyncFunction"),Lb=e=>e&&(cr(e)||lo(e))&&lo(e.then)&&lo(e.catch),Em=((e,t)=>e?setImmediate:t?((o,a)=>(fi.addEventListener("message",({source:n,data:i})=>{n===fi&&i===o&&a.length&&a.shift()()},!1),n=>{a.push(n),fi.postMessage(o,"*")}))(`axios@${Math.random()}`,[]):o=>setTimeout(o))(typeof setImmediate=="function",lo(fi.postMessage)),Sb=typeof queueMicrotask<"u"?queueMicrotask.bind(fi):typeof process<"u"&&process.nextTick||Em,Ib=e=>e!=null&&lo(e[Tc]),De={isArray:dl,isArrayBuffer:xm,isBuffer:rr,isFormData:X0,isArrayBufferView:V0,isString:G0,isNumber:$m,isBoolean:q0,isObject:cr,isPlainObject:Br,isEmptyObject:j0,isReadableStream:eb,isRequest:tb,isResponse:nb,isHeaders:ob,isUndefined:ll,isDate:Z0,isFile:W0,isBlob:K0,isRegExp:mb,isFunction:lo,isStream:Y0,isURLSearchParams:Q0,isTypedArray:db,isFileList:J0,forEach:ur,merge:td,extend:ab,trim:sb,stripBOM:ib,inherits:lb,toFlatObject:rb,kindOf:Mc,kindOfTest:ts,endsWith:cb,toArray:ub,forEachEntry:hb,matchAll:fb,isHTMLForm:pb,hasOwnProperty:Cf,hasOwnProp:Cf,reduceDescriptors:Am,freezeMethods:gb,toObjectSet:yb,toCamelCase:vb,noop:kb,toFiniteNumber:bb,findKey:Tm,global:fi,isContextDefined:Mm,isSpecCompliantForm:_b,toJSONObject:wb,isAsyncFn:Cb,isThenable:Lb,setImmediate:Em,asap:Sb,isIterable:Ib};function yt(e,t,o,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),o&&(this.config=o),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}De.inherits(yt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:De.toJSONObject(this.config),code:this.code,status:this.status}}});const Pm=yt.prototype,Dm={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Dm[e]={value:e}});Object.defineProperties(yt,Dm);Object.defineProperty(Pm,"isAxiosError",{value:!0});yt.from=(e,t,o,a,n,i)=>{const l=Object.create(Pm);De.toFlatObject(e,l,function(f){return f!==Error.prototype},h=>h!=="isAxiosError");const u=e&&e.message?e.message:"Error",d=t==null&&e?e.code:t;return yt.call(l,u,d,o,a,n),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",i&&Object.assign(l,i),l};const xb=null;function nd(e){return De.isPlainObject(e)||De.isArray(e)}function Rm(e){return De.endsWith(e,"[]")?e.slice(0,-2):e}function Lf(e,t,o){return e?e.concat(t).map(function(n,i){return n=Rm(n),!o&&i?"["+n+"]":n}).join(o?".":""):t}function $b(e){return De.isArray(e)&&!e.some(nd)}const Tb=De.toFlatObject(De,{},null,function(t){return/^is[A-Z]/.test(t)});function Ec(e,t,o){if(!De.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,o=De.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,T){return!De.isUndefined(T[S])});const a=o.metaTokens,n=o.visitor||f,i=o.dots,l=o.indexes,d=(o.Blob||typeof Blob<"u"&&Blob)&&De.isSpecCompliantForm(t);if(!De.isFunction(n))throw new TypeError("visitor must be a function");function h(w){if(w===null)return"";if(De.isDate(w))return w.toISOString();if(De.isBoolean(w))return w.toString();if(!d&&De.isBlob(w))throw new yt("Blob is not supported. Use a Buffer instead.");return De.isArrayBuffer(w)||De.isTypedArray(w)?d&&typeof Blob=="function"?new Blob([w]):Buffer.from(w):w}function f(w,S,T){let x=w;if(w&&!T&&typeof w=="object"){if(De.endsWith(S,"{}"))S=a?S:S.slice(0,-2),w=JSON.stringify(w);else if(De.isArray(w)&&$b(w)||(De.isFileList(w)||De.endsWith(S,"[]"))&&(x=De.toArray(w)))return S=Rm(S),x.forEach(function(_,$){!(De.isUndefined(_)||_===null)&&t.append(l===!0?Lf([S],$,i):l===null?S:S+"[]",h(_))}),!1}return nd(w)?!0:(t.append(Lf(T,S,i),h(w)),!1)}const m=[],y=Object.assign(Tb,{defaultVisitor:f,convertValue:h,isVisitable:nd});function k(w,S){if(!De.isUndefined(w)){if(m.indexOf(w)!==-1)throw Error("Circular reference detected in "+S.join("."));m.push(w),De.forEach(w,function(x,C){(!(De.isUndefined(x)||x===null)&&n.call(t,x,De.isString(C)?C.trim():C,S,y))===!0&&k(x,S?S.concat(C):[C])}),m.pop()}}if(!De.isObject(e))throw new TypeError("data must be an object");return k(e),t}function Sf(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function Ud(e,t){this._pairs=[],e&&Ec(e,this,t)}const Om=Ud.prototype;Om.append=function(t,o){this._pairs.push([t,o])};Om.toString=function(t){const o=t?function(a){return t.call(this,a,Sf)}:Sf;return this._pairs.map(function(n){return o(n[0])+"="+o(n[1])},"").join("&")};function Mb(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Bm(e,t,o){if(!t)return e;const a=o&&o.encode||Mb;De.isFunction(o)&&(o={serialize:o});const n=o&&o.serialize;let i;if(n?i=n(t,o):i=De.isURLSearchParams(t)?t.toString():new Ud(t,o).toString(a),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class If{constructor(){this.handlers=[]}use(t,o,a){return this.handlers.push({fulfilled:t,rejected:o,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){De.forEach(this.handlers,function(a){a!==null&&t(a)})}}const Nm={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ab=typeof URLSearchParams<"u"?URLSearchParams:Ud,Eb=typeof FormData<"u"?FormData:null,Pb=typeof Blob<"u"?Blob:null,Db={isBrowser:!0,classes:{URLSearchParams:Ab,FormData:Eb,Blob:Pb},protocols:["http","https","file","blob","url","data"]},zd=typeof window<"u"&&typeof document<"u",od=typeof navigator=="object"&&navigator||void 0,Rb=zd&&(!od||["ReactNative","NativeScript","NS"].indexOf(od.product)<0),Ob=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Bb=zd&&window.location.href||"http://localhost",Nb=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:zd,hasStandardBrowserEnv:Rb,hasStandardBrowserWebWorkerEnv:Ob,navigator:od,origin:Bb},Symbol.toStringTag,{value:"Module"})),Hn={...Nb,...Db};function Fb(e,t){return Ec(e,new Hn.classes.URLSearchParams,{visitor:function(o,a,n,i){return Hn.isNode&&De.isBuffer(o)?(this.append(a,o.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function Ub(e){return De.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function zb(e){const t={},o=Object.keys(e);let a;const n=o.length;let i;for(a=0;a<n;a++)i=o[a],t[i]=e[i];return t}function Fm(e){function t(o,a,n,i){let l=o[i++];if(l==="__proto__")return!0;const u=Number.isFinite(+l),d=i>=o.length;return l=!l&&De.isArray(n)?n.length:l,d?(De.hasOwnProp(n,l)?n[l]=[n[l],a]:n[l]=a,!u):((!n[l]||!De.isObject(n[l]))&&(n[l]=[]),t(o,a,n[l],i)&&De.isArray(n[l])&&(n[l]=zb(n[l])),!u)}if(De.isFormData(e)&&De.isFunction(e.entries)){const o={};return De.forEachEntry(e,(a,n)=>{t(Ub(a),n,o,0)}),o}return null}function Hb(e,t,o){if(De.isString(e))try{return(t||JSON.parse)(e),De.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(o||JSON.stringify)(e)}const dr={transitional:Nm,adapter:["xhr","http","fetch"],transformRequest:[function(t,o){const a=o.getContentType()||"",n=a.indexOf("application/json")>-1,i=De.isObject(t);if(i&&De.isHTMLForm(t)&&(t=new FormData(t)),De.isFormData(t))return n?JSON.stringify(Fm(t)):t;if(De.isArrayBuffer(t)||De.isBuffer(t)||De.isStream(t)||De.isFile(t)||De.isBlob(t)||De.isReadableStream(t))return t;if(De.isArrayBufferView(t))return t.buffer;if(De.isURLSearchParams(t))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return Fb(t,this.formSerializer).toString();if((u=De.isFileList(t))||a.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return Ec(u?{"files[]":t}:t,d&&new d,this.formSerializer)}}return i||n?(o.setContentType("application/json",!1),Hb(t)):t}],transformResponse:[function(t){const o=this.transitional||dr.transitional,a=o&&o.forcedJSONParsing,n=this.responseType==="json";if(De.isResponse(t)||De.isReadableStream(t))return t;if(t&&De.isString(t)&&(a&&!this.responseType||n)){const l=!(o&&o.silentJSONParsing)&&n;try{return JSON.parse(t,this.parseReviver)}catch(u){if(l)throw u.name==="SyntaxError"?yt.from(u,yt.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Hn.classes.FormData,Blob:Hn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};De.forEach(["delete","get","head","post","put","patch"],e=>{dr.headers[e]={}});const Vb=De.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Gb=e=>{const t={};let o,a,n;return e&&e.split(`
`).forEach(function(l){n=l.indexOf(":"),o=l.substring(0,n).trim().toLowerCase(),a=l.substring(n+1).trim(),!(!o||t[o]&&Vb[o])&&(o==="set-cookie"?t[o]?t[o].push(a):t[o]=[a]:t[o]=t[o]?t[o]+", "+a:a)}),t},xf=Symbol("internals");function $l(e){return e&&String(e).trim().toLowerCase()}function Nr(e){return e===!1||e==null?e:De.isArray(e)?e.map(Nr):String(e)}function qb(e){const t=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=o.exec(e);)t[a[1]]=a[2];return t}const jb=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function su(e,t,o,a,n){if(De.isFunction(a))return a.call(this,t,o);if(n&&(t=o),!!De.isString(t)){if(De.isString(a))return t.indexOf(a)!==-1;if(De.isRegExp(a))return a.test(t)}}function Zb(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,o,a)=>o.toUpperCase()+a)}function Wb(e,t){const o=De.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+o,{value:function(n,i,l){return this[a].call(this,t,n,i,l)},configurable:!0})})}let ro=class{constructor(t){t&&this.set(t)}set(t,o,a){const n=this;function i(u,d,h){const f=$l(d);if(!f)throw new Error("header name must be a non-empty string");const m=De.findKey(n,f);(!m||n[m]===void 0||h===!0||h===void 0&&n[m]!==!1)&&(n[m||d]=Nr(u))}const l=(u,d)=>De.forEach(u,(h,f)=>i(h,f,d));if(De.isPlainObject(t)||t instanceof this.constructor)l(t,o);else if(De.isString(t)&&(t=t.trim())&&!jb(t))l(Gb(t),o);else if(De.isObject(t)&&De.isIterable(t)){let u={},d,h;for(const f of t){if(!De.isArray(f))throw TypeError("Object iterator must return a key-value pair");u[h=f[0]]=(d=u[h])?De.isArray(d)?[...d,f[1]]:[d,f[1]]:f[1]}l(u,o)}else t!=null&&i(o,t,a);return this}get(t,o){if(t=$l(t),t){const a=De.findKey(this,t);if(a){const n=this[a];if(!o)return n;if(o===!0)return qb(n);if(De.isFunction(o))return o.call(this,n,a);if(De.isRegExp(o))return o.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,o){if(t=$l(t),t){const a=De.findKey(this,t);return!!(a&&this[a]!==void 0&&(!o||su(this,this[a],a,o)))}return!1}delete(t,o){const a=this;let n=!1;function i(l){if(l=$l(l),l){const u=De.findKey(a,l);u&&(!o||su(a,a[u],u,o))&&(delete a[u],n=!0)}}return De.isArray(t)?t.forEach(i):i(t),n}clear(t){const o=Object.keys(this);let a=o.length,n=!1;for(;a--;){const i=o[a];(!t||su(this,this[i],i,t,!0))&&(delete this[i],n=!0)}return n}normalize(t){const o=this,a={};return De.forEach(this,(n,i)=>{const l=De.findKey(a,i);if(l){o[l]=Nr(n),delete o[i];return}const u=t?Zb(i):String(i).trim();u!==i&&delete o[i],o[u]=Nr(n),a[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const o=Object.create(null);return De.forEach(this,(a,n)=>{a!=null&&a!==!1&&(o[n]=t&&De.isArray(a)?a.join(", "):a)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,o])=>t+": "+o).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...o){const a=new this(t);return o.forEach(n=>a.set(n)),a}static accessor(t){const a=(this[xf]=this[xf]={accessors:{}}).accessors,n=this.prototype;function i(l){const u=$l(l);a[u]||(Wb(n,l),a[u]=!0)}return De.isArray(t)?t.forEach(i):i(t),this}};ro.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);De.reduceDescriptors(ro.prototype,({value:e},t)=>{let o=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[o]=a}}});De.freezeMethods(ro);function au(e,t){const o=this||dr,a=t||o,n=ro.from(a.headers);let i=a.data;return De.forEach(e,function(u){i=u.call(o,i,n.normalize(),t?t.status:void 0)}),n.normalize(),i}function Um(e){return!!(e&&e.__CANCEL__)}function hl(e,t,o){yt.call(this,e??"canceled",yt.ERR_CANCELED,t,o),this.name="CanceledError"}De.inherits(hl,yt,{__CANCEL__:!0});function zm(e,t,o){const a=o.config.validateStatus;!o.status||!a||a(o.status)?e(o):t(new yt("Request failed with status code "+o.status,[yt.ERR_BAD_REQUEST,yt.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}function Kb(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Jb(e,t){e=e||10;const o=new Array(e),a=new Array(e);let n=0,i=0,l;return t=t!==void 0?t:1e3,function(d){const h=Date.now(),f=a[i];l||(l=h),o[n]=d,a[n]=h;let m=i,y=0;for(;m!==n;)y+=o[m++],m=m%e;if(n=(n+1)%e,n===i&&(i=(i+1)%e),h-l<t)return;const k=f&&h-f;return k?Math.round(y*1e3/k):void 0}}function Yb(e,t){let o=0,a=1e3/t,n,i;const l=(h,f=Date.now())=>{o=f,n=null,i&&(clearTimeout(i),i=null),e(...h)};return[(...h)=>{const f=Date.now(),m=f-o;m>=a?l(h,f):(n=h,i||(i=setTimeout(()=>{i=null,l(n)},a-m)))},()=>n&&l(n)]}const nc=(e,t,o=3)=>{let a=0;const n=Jb(50,250);return Yb(i=>{const l=i.loaded,u=i.lengthComputable?i.total:void 0,d=l-a,h=n(d),f=l<=u;a=l;const m={loaded:l,total:u,progress:u?l/u:void 0,bytes:d,rate:h||void 0,estimated:h&&u&&f?(u-l)/h:void 0,event:i,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(m)},o)},$f=(e,t)=>{const o=e!=null;return[a=>t[0]({lengthComputable:o,total:e,loaded:a}),t[1]]},Tf=e=>(...t)=>De.asap(()=>e(...t)),Xb=Hn.hasStandardBrowserEnv?((e,t)=>o=>(o=new URL(o,Hn.origin),e.protocol===o.protocol&&e.host===o.host&&(t||e.port===o.port)))(new URL(Hn.origin),Hn.navigator&&/(msie|trident)/i.test(Hn.navigator.userAgent)):()=>!0,Qb=Hn.hasStandardBrowserEnv?{write(e,t,o,a,n,i,l){if(typeof document>"u")return;const u=[`${e}=${encodeURIComponent(t)}`];De.isNumber(o)&&u.push(`expires=${new Date(o).toUTCString()}`),De.isString(a)&&u.push(`path=${a}`),De.isString(n)&&u.push(`domain=${n}`),i===!0&&u.push("secure"),De.isString(l)&&u.push(`SameSite=${l}`),document.cookie=u.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function e_(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function t_(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Hm(e,t,o){let a=!e_(t);return e&&(a||o==!1)?t_(e,t):t}const Mf=e=>e instanceof ro?{...e}:e;function ki(e,t){t=t||{};const o={};function a(h,f,m,y){return De.isPlainObject(h)&&De.isPlainObject(f)?De.merge.call({caseless:y},h,f):De.isPlainObject(f)?De.merge({},f):De.isArray(f)?f.slice():f}function n(h,f,m,y){if(De.isUndefined(f)){if(!De.isUndefined(h))return a(void 0,h,m,y)}else return a(h,f,m,y)}function i(h,f){if(!De.isUndefined(f))return a(void 0,f)}function l(h,f){if(De.isUndefined(f)){if(!De.isUndefined(h))return a(void 0,h)}else return a(void 0,f)}function u(h,f,m){if(m in t)return a(h,f);if(m in e)return a(void 0,h)}const d={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:u,headers:(h,f,m)=>n(Mf(h),Mf(f),m,!0)};return De.forEach(Object.keys({...e,...t}),function(f){const m=d[f]||n,y=m(e[f],t[f],f);De.isUndefined(y)&&m!==u||(o[f]=y)}),o}const Vm=e=>{const t=ki({},e);let{data:o,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:i,headers:l,auth:u}=t;if(t.headers=l=ro.from(l),t.url=Bm(Hm(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&l.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),De.isFormData(o)){if(Hn.hasStandardBrowserEnv||Hn.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(De.isFunction(o.getHeaders)){const d=o.getHeaders(),h=["content-type","content-length"];Object.entries(d).forEach(([f,m])=>{h.includes(f.toLowerCase())&&l.set(f,m)})}}if(Hn.hasStandardBrowserEnv&&(a&&De.isFunction(a)&&(a=a(t)),a||a!==!1&&Xb(t.url))){const d=n&&i&&Qb.read(i);d&&l.set(n,d)}return t},n_=typeof XMLHttpRequest<"u",o_=n_&&function(e){return new Promise(function(o,a){const n=Vm(e);let i=n.data;const l=ro.from(n.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:h}=n,f,m,y,k,w;function S(){k&&k(),w&&w(),n.cancelToken&&n.cancelToken.unsubscribe(f),n.signal&&n.signal.removeEventListener("abort",f)}let T=new XMLHttpRequest;T.open(n.method.toUpperCase(),n.url,!0),T.timeout=n.timeout;function x(){if(!T)return;const _=ro.from("getAllResponseHeaders"in T&&T.getAllResponseHeaders()),M={data:!u||u==="text"||u==="json"?T.responseText:T.response,status:T.status,statusText:T.statusText,headers:_,config:e,request:T};zm(function(E){o(E),S()},function(E){a(E),S()},M),T=null}"onloadend"in T?T.onloadend=x:T.onreadystatechange=function(){!T||T.readyState!==4||T.status===0&&!(T.responseURL&&T.responseURL.indexOf("file:")===0)||setTimeout(x)},T.onabort=function(){T&&(a(new yt("Request aborted",yt.ECONNABORTED,e,T)),T=null)},T.onerror=function($){const M=$&&$.message?$.message:"Network Error",H=new yt(M,yt.ERR_NETWORK,e,T);H.event=$||null,a(H),T=null},T.ontimeout=function(){let $=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const M=n.transitional||Nm;n.timeoutErrorMessage&&($=n.timeoutErrorMessage),a(new yt($,M.clarifyTimeoutError?yt.ETIMEDOUT:yt.ECONNABORTED,e,T)),T=null},i===void 0&&l.setContentType(null),"setRequestHeader"in T&&De.forEach(l.toJSON(),function($,M){T.setRequestHeader(M,$)}),De.isUndefined(n.withCredentials)||(T.withCredentials=!!n.withCredentials),u&&u!=="json"&&(T.responseType=n.responseType),h&&([y,w]=nc(h,!0),T.addEventListener("progress",y)),d&&T.upload&&([m,k]=nc(d),T.upload.addEventListener("progress",m),T.upload.addEventListener("loadend",k)),(n.cancelToken||n.signal)&&(f=_=>{T&&(a(!_||_.type?new hl(null,e,T):_),T.abort(),T=null)},n.cancelToken&&n.cancelToken.subscribe(f),n.signal&&(n.signal.aborted?f():n.signal.addEventListener("abort",f)));const C=Kb(n.url);if(C&&Hn.protocols.indexOf(C)===-1){a(new yt("Unsupported protocol "+C+":",yt.ERR_BAD_REQUEST,e));return}T.send(i||null)})},s_=(e,t)=>{const{length:o}=e=e?e.filter(Boolean):[];if(t||o){let a=new AbortController,n;const i=function(h){if(!n){n=!0,u();const f=h instanceof Error?h:this.reason;a.abort(f instanceof yt?f:new hl(f instanceof Error?f.message:f))}};let l=t&&setTimeout(()=>{l=null,i(new yt(`timeout ${t} of ms exceeded`,yt.ETIMEDOUT))},t);const u=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(h=>{h.unsubscribe?h.unsubscribe(i):h.removeEventListener("abort",i)}),e=null)};e.forEach(h=>h.addEventListener("abort",i));const{signal:d}=a;return d.unsubscribe=()=>De.asap(u),d}},a_=function*(e,t){let o=e.byteLength;if(o<t){yield e;return}let a=0,n;for(;a<o;)n=a+t,yield e.slice(a,n),a=n},i_=async function*(e,t){for await(const o of l_(e))yield*a_(o,t)},l_=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:o,value:a}=await t.read();if(o)break;yield a}}finally{await t.cancel()}},Af=(e,t,o,a)=>{const n=i_(e,t);let i=0,l,u=d=>{l||(l=!0,a&&a(d))};return new ReadableStream({async pull(d){try{const{done:h,value:f}=await n.next();if(h){u(),d.close();return}let m=f.byteLength;if(o){let y=i+=m;o(y)}d.enqueue(new Uint8Array(f))}catch(h){throw u(h),h}},cancel(d){return u(d),n.return()}},{highWaterMark:2})},Ef=64*1024,{isFunction:$r}=De,r_=(({Request:e,Response:t})=>({Request:e,Response:t}))(De.global),{ReadableStream:Pf,TextEncoder:Df}=De.global,Rf=(e,...t)=>{try{return!!e(...t)}catch{return!1}},c_=e=>{e=De.merge.call({skipUndefined:!0},r_,e);const{fetch:t,Request:o,Response:a}=e,n=t?$r(t):typeof fetch=="function",i=$r(o),l=$r(a);if(!n)return!1;const u=n&&$r(Pf),d=n&&(typeof Df=="function"?(w=>S=>w.encode(S))(new Df):async w=>new Uint8Array(await new o(w).arrayBuffer())),h=i&&u&&Rf(()=>{let w=!1;const S=new o(Hn.origin,{body:new Pf,method:"POST",get duplex(){return w=!0,"half"}}).headers.has("Content-Type");return w&&!S}),f=l&&u&&Rf(()=>De.isReadableStream(new a("").body)),m={stream:f&&(w=>w.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(w=>{!m[w]&&(m[w]=(S,T)=>{let x=S&&S[w];if(x)return x.call(S);throw new yt(`Response type '${w}' is not supported`,yt.ERR_NOT_SUPPORT,T)})});const y=async w=>{if(w==null)return 0;if(De.isBlob(w))return w.size;if(De.isSpecCompliantForm(w))return(await new o(Hn.origin,{method:"POST",body:w}).arrayBuffer()).byteLength;if(De.isArrayBufferView(w)||De.isArrayBuffer(w))return w.byteLength;if(De.isURLSearchParams(w)&&(w=w+""),De.isString(w))return(await d(w)).byteLength},k=async(w,S)=>{const T=De.toFiniteNumber(w.getContentLength());return T??y(S)};return async w=>{let{url:S,method:T,data:x,signal:C,cancelToken:_,timeout:$,onDownloadProgress:M,onUploadProgress:H,responseType:E,headers:B,withCredentials:R="same-origin",fetchOptions:U}=Vm(w),F=t||fetch;E=E?(E+"").toLowerCase():"text";let j=s_([C,_&&_.toAbortSignal()],$),Y=null;const oe=j&&j.unsubscribe&&(()=>{j.unsubscribe()});let Oe;try{if(H&&h&&T!=="get"&&T!=="head"&&(Oe=await k(B,x))!==0){let pe=new o(S,{method:"POST",body:x,duplex:"half"}),we;if(De.isFormData(x)&&(we=pe.headers.get("content-type"))&&B.setContentType(we),pe.body){const[Ze,Ne]=$f(Oe,nc(Tf(H)));x=Af(pe.body,Ef,Ze,Ne)}}De.isString(R)||(R=R?"include":"omit");const ee=i&&"credentials"in o.prototype,te={...U,signal:j,method:T.toUpperCase(),headers:B.normalize().toJSON(),body:x,duplex:"half",credentials:ee?R:void 0};Y=i&&new o(S,te);let O=await(i?F(Y,U):F(S,te));const Z=f&&(E==="stream"||E==="response");if(f&&(M||Z&&oe)){const pe={};["status","statusText","headers"].forEach(Ge=>{pe[Ge]=O[Ge]});const we=De.toFiniteNumber(O.headers.get("content-length")),[Ze,Ne]=M&&$f(we,nc(Tf(M),!0))||[];O=new a(Af(O.body,Ef,Ze,()=>{Ne&&Ne(),oe&&oe()}),pe)}E=E||"text";let ne=await m[De.findKey(m,E)||"text"](O,w);return!Z&&oe&&oe(),await new Promise((pe,we)=>{zm(pe,we,{data:ne,headers:ro.from(O.headers),status:O.status,statusText:O.statusText,config:w,request:Y})})}catch(ee){throw oe&&oe(),ee&&ee.name==="TypeError"&&/Load failed|fetch/i.test(ee.message)?Object.assign(new yt("Network Error",yt.ERR_NETWORK,w,Y),{cause:ee.cause||ee}):yt.from(ee,ee&&ee.code,w,Y)}}},u_=new Map,Gm=e=>{let t=e&&e.env||{};const{fetch:o,Request:a,Response:n}=t,i=[a,n,o];let l=i.length,u=l,d,h,f=u_;for(;u--;)d=i[u],h=f.get(d),h===void 0&&f.set(d,h=u?new Map:c_(t)),f=h;return h};Gm();const Hd={http:xb,xhr:o_,fetch:{get:Gm}};De.forEach(Hd,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Of=e=>`- ${e}`,d_=e=>De.isFunction(e)||e===null||e===!1;function h_(e,t){e=De.isArray(e)?e:[e];const{length:o}=e;let a,n;const i={};for(let l=0;l<o;l++){a=e[l];let u;if(n=a,!d_(a)&&(n=Hd[(u=String(a)).toLowerCase()],n===void 0))throw new yt(`Unknown adapter '${u}'`);if(n&&(De.isFunction(n)||(n=n.get(t))))break;i[u||"#"+l]=n}if(!n){const l=Object.entries(i).map(([d,h])=>`adapter ${d} `+(h===!1?"is not supported by the environment":"is not available in the build"));let u=o?l.length>1?`since :
`+l.map(Of).join(`
`):" "+Of(l[0]):"as no adapter specified";throw new yt("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return n}const qm={getAdapter:h_,adapters:Hd};function iu(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new hl(null,e)}function Bf(e){return iu(e),e.headers=ro.from(e.headers),e.data=au.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),qm.getAdapter(e.adapter||dr.adapter,e)(e).then(function(a){return iu(e),a.data=au.call(e,e.transformResponse,a),a.headers=ro.from(a.headers),a},function(a){return Um(a)||(iu(e),a&&a.response&&(a.response.data=au.call(e,e.transformResponse,a.response),a.response.headers=ro.from(a.response.headers))),Promise.reject(a)})}const jm="1.13.2",Pc={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Pc[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const Nf={};Pc.transitional=function(t,o,a){function n(i,l){return"[Axios v"+jm+"] Transitional option '"+i+"'"+l+(a?". "+a:"")}return(i,l,u)=>{if(t===!1)throw new yt(n(l," has been removed"+(o?" in "+o:"")),yt.ERR_DEPRECATED);return o&&!Nf[l]&&(Nf[l]=!0,console.warn(n(l," has been deprecated since v"+o+" and will be removed in the near future"))),t?t(i,l,u):!0}};Pc.spelling=function(t){return(o,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function f_(e,t,o){if(typeof e!="object")throw new yt("options must be an object",yt.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let n=a.length;for(;n-- >0;){const i=a[n],l=t[i];if(l){const u=e[i],d=u===void 0||l(u,i,e);if(d!==!0)throw new yt("option "+i+" must be "+d,yt.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new yt("Unknown option "+i,yt.ERR_BAD_OPTION)}}const Fr={assertOptions:f_,validators:Pc},us=Fr.validators;let mi=class{constructor(t){this.defaults=t||{},this.interceptors={request:new If,response:new If}}async request(t,o){try{return await this._request(t,o)}catch(a){if(a instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const i=n.stack?n.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(t,o){typeof t=="string"?(o=o||{},o.url=t):o=t||{},o=ki(this.defaults,o);const{transitional:a,paramsSerializer:n,headers:i}=o;a!==void 0&&Fr.assertOptions(a,{silentJSONParsing:us.transitional(us.boolean),forcedJSONParsing:us.transitional(us.boolean),clarifyTimeoutError:us.transitional(us.boolean)},!1),n!=null&&(De.isFunction(n)?o.paramsSerializer={serialize:n}:Fr.assertOptions(n,{encode:us.function,serialize:us.function},!0)),o.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?o.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:o.allowAbsoluteUrls=!0),Fr.assertOptions(o,{baseUrl:us.spelling("baseURL"),withXsrfToken:us.spelling("withXSRFToken")},!0),o.method=(o.method||this.defaults.method||"get").toLowerCase();let l=i&&De.merge(i.common,i[o.method]);i&&De.forEach(["delete","get","head","post","put","patch","common"],w=>{delete i[w]}),o.headers=ro.concat(l,i);const u=[];let d=!0;this.interceptors.request.forEach(function(S){typeof S.runWhen=="function"&&S.runWhen(o)===!1||(d=d&&S.synchronous,u.unshift(S.fulfilled,S.rejected))});const h=[];this.interceptors.response.forEach(function(S){h.push(S.fulfilled,S.rejected)});let f,m=0,y;if(!d){const w=[Bf.bind(this),void 0];for(w.unshift(...u),w.push(...h),y=w.length,f=Promise.resolve(o);m<y;)f=f.then(w[m++],w[m++]);return f}y=u.length;let k=o;for(;m<y;){const w=u[m++],S=u[m++];try{k=w(k)}catch(T){S.call(this,T);break}}try{f=Bf.call(this,k)}catch(w){return Promise.reject(w)}for(m=0,y=h.length;m<y;)f=f.then(h[m++],h[m++]);return f}getUri(t){t=ki(this.defaults,t);const o=Hm(t.baseURL,t.url,t.allowAbsoluteUrls);return Bm(o,t.params,t.paramsSerializer)}};De.forEach(["delete","get","head","options"],function(t){mi.prototype[t]=function(o,a){return this.request(ki(a||{},{method:t,url:o,data:(a||{}).data}))}});De.forEach(["post","put","patch"],function(t){function o(a){return function(i,l,u){return this.request(ki(u||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}mi.prototype[t]=o(),mi.prototype[t+"Form"]=o(!0)});let p_=class Zm{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(i){o=i});const a=this;this.promise.then(n=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](n);a._listeners=null}),this.promise.then=n=>{let i;const l=new Promise(u=>{a.subscribe(u),i=u}).then(n);return l.cancel=function(){a.unsubscribe(i)},l},t(function(i,l,u){a.reason||(a.reason=new hl(i,l,u),o(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const o=this._listeners.indexOf(t);o!==-1&&this._listeners.splice(o,1)}toAbortSignal(){const t=new AbortController,o=a=>{t.abort(a)};return this.subscribe(o),t.signal.unsubscribe=()=>this.unsubscribe(o),t.signal}static source(){let t;return{token:new Zm(function(n){t=n}),cancel:t}}};function v_(e){return function(o){return e.apply(null,o)}}function m_(e){return De.isObject(e)&&e.isAxiosError===!0}const sd={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(sd).forEach(([e,t])=>{sd[t]=e});function Wm(e){const t=new mi(e),o=Sm(mi.prototype.request,t);return De.extend(o,mi.prototype,t,{allOwnKeys:!0}),De.extend(o,t,null,{allOwnKeys:!0}),o.create=function(n){return Wm(ki(e,n))},o}const un=Wm(dr);un.Axios=mi;un.CanceledError=hl;un.CancelToken=p_;un.isCancel=Um;un.VERSION=jm;un.toFormData=Ec;un.AxiosError=yt;un.Cancel=un.CanceledError;un.all=function(t){return Promise.all(t)};un.spread=v_;un.isAxiosError=m_;un.mergeConfig=ki;un.AxiosHeaders=ro;un.formToJSON=e=>Fm(De.isHTMLForm(e)?new FormData(e):e);un.getAdapter=qm.getAdapter;un.HttpStatusCode=sd;un.default=un;const{Axios:gq,AxiosError:yq,CanceledError:kq,isCancel:bq,CancelToken:_q,VERSION:wq,all:Cq,Cancel:Lq,isAxiosError:Sq,spread:Iq,toFormData:xq,AxiosHeaders:$q,HttpStatusCode:Tq,formToJSON:Mq,getAdapter:Aq,mergeConfig:Eq}=un,Ia="https://sterobson-volunteercheckin-testing.azurewebsites.net/api",g_="VolunteerCheckinOffline",y_=1;let Zo=null;async function Js(){return Zo||new Promise((e,t)=>{const o=indexedDB.open(g_,y_);o.onerror=()=>{console.error("Failed to open IndexedDB:",o.error),t(o.error)},o.onsuccess=()=>{Zo=o.result,e(Zo)},o.onupgradeneeded=a=>{const n=a.target.result;n.objectStoreNames.contains("eventData")||n.createObjectStore("eventData",{keyPath:"eventId"}),n.objectStoreNames.contains("pendingActions")||n.createObjectStore("pendingActions",{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),n.objectStoreNames.contains("syncMeta")||n.createObjectStore("syncMeta",{keyPath:"key"})}})}async function or(e,t){return await Js(),new Promise((o,a)=>{const n=Zo.transaction(["eventData","syncMeta"],"readwrite"),i=n.objectStore("eventData"),l=n.objectStore("syncMeta"),u={eventId:e,...t,cachedAt:new Date().toISOString()};i.put(u),l.put({key:`lastSync_${e}`,value:new Date().toISOString()}),n.oncomplete=()=>o(),n.onerror=()=>a(n.error)})}async function Ma(e){return await Js(),new Promise((t,o)=>{const i=Zo.transaction(["eventData"],"readonly").objectStore("eventData").get(e);i.onsuccess=()=>t(i.result||null),i.onerror=()=>o(i.error)})}async function Ur(e,t,o){const a=await Ma(e);a&&(a[t]=o,a.cachedAt=new Date().toISOString(),await or(e,a))}async function k_(e){return await Js(),new Promise((t,o)=>{const n=Zo.transaction(["pendingActions"],"readwrite").objectStore("pendingActions"),i={...e,createdAt:new Date().toISOString(),attempts:0,lastAttempt:null,status:"pending"},l=n.add(i);l.onsuccess=()=>t(l.result),l.onerror=()=>o(l.error)})}async function Km(){return await Js(),new Promise((e,t)=>{const i=Zo.transaction(["pendingActions"],"readonly").objectStore("pendingActions").index("createdAt").getAll();i.onsuccess=()=>{const l=i.result.filter(u=>u.status==="pending"||u.status==="retrying");e(l)},i.onerror=()=>t(i.error)})}async function oc(){return(await Km()).length}async function Ff(e,t){return await Js(),new Promise((o,a)=>{const n=Zo.transaction(["pendingActions"],"readwrite"),i=n.objectStore("pendingActions"),l=i.get(e);l.onsuccess=()=>{const u=l.result;u&&(Object.assign(u,t),i.put(u))},n.oncomplete=()=>o(),n.onerror=()=>a(n.error)})}async function Uf(e){return await Js(),new Promise((t,o)=>{const i=Zo.transaction(["pendingActions"],"readwrite").objectStore("pendingActions").delete(e);i.onsuccess=()=>t(),i.onerror=()=>o(i.error)})}async function b_(e){return await Js(),new Promise((t,o)=>{const i=Zo.transaction(["syncMeta"],"readonly").objectStore("syncMeta").get(`lastSync_${e}`);i.onsuccess=()=>t(i.result?.value||null),i.onerror=()=>o(i.error)})}const Je=un.create({baseURL:Ia,headers:{"Content-Type":"application/json"},timeout:15e3});let ad=!1,Jm={type:null,eventId:null};function go(e,t=null){Jm={type:e,eventId:t}}async function __(){}function zf(e){const t=[/\/events\/([^/]+)/,/\/assignments\/([^/]+)/,/\/locations\/([^/]+)/,/\/checklist-items\/([^/]+)/,/\/areas\/([^/]+)/,/\/marshals\/([^/]+)/];for(const o of t){const a=e.match(o);if(a)return a[1]}return null}function w_(e){return!!(!e.response&&e.request||e.response&&e.response.status>=500||e.code==="ECONNABORTED")}function Ym(){const e=window.location.hash||"";if(e.includes("/admin/"))return{type:"admin",eventId:null};const t=e.match(/#\/event\/([^/?]+)/);return t?{type:"marshal",eventId:t[1]}:e.includes("/marshal")?{type:null,eventId:null}:Jm}const C_=["/auth/marshal-login","/auth/request-login","/auth/verify-token","/auth/instant-login"];Je.interceptors.request.use(e=>{if(C_.some(i=>e.url?.includes(i)))return e;const o=localStorage.getItem("adminEmail");o&&(e.headers["X-Admin-Email"]=o);const a=Ym();let n=null;if(a.type==="marshal"&&a.eventId){const i=tc(a.eventId);i?.token&&(n=i.token)}return n||(n=localStorage.getItem("sessionToken")),n&&(e.headers.Authorization=`Bearer ${n}`),A0(e),e});let sc=0;const L_=2;function S_(){if(sc++,sc>=L_&&Ym().type!=="marshal"){localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken");const t=window.location.hash||"";!t.includes("login")&&!t.includes("/verify")&&(window.location.href="/VolunteerCheckin/testing/#/?login=true")}}function I_(){sc=0}function lu(){sc=0}function x_(e){if(!e?.url)return!1;const t=localStorage.getItem("sessionToken"),o=e.headers?.Authorization||e.headers?.authorization;if(o&&t&&o.replace("Bearer ","")!==t||(e.url||"").includes("/auth/marshal-login"))return!0;const n=window.location.hash||"";return!!(n.match(/#\/event\/[^/?]+/)||n==="#/marshal"||n.startsWith("#/marshal?"))}Je.interceptors.response.use(e=>{const t=_f(e.config);t&&bf(t),ad=!1,I_();const o=e.config.url,a=zf(o);return e.config.method,e},async e=>{const t=e.config,o=_f(t);if(o&&bf(o),e.response&&(e.response.status===401||e.response.status===403))return x_(t)||S_(),Promise.reject(e);if(w_(e)&&(ad=!0,t.method==="get")){const a=zf(t.url);if(a){const n=await Ma(a);if(n)return console.log("Returning cached data for:",t.url),Promise.resolve({data:n,status:200,statusText:"OK (cached)",headers:{},config:t,cached:!0})}}return Promise.reject(e)});async function mo(e,t,o){return await k_({type:e,payload:t,eventId:t.eventId}),await __(),{data:o,status:200,statusText:"OK (queued)",queued:!0}}function On(){return ad||!navigator.onLine}const $_={check:()=>Je.head("/health")},id=()=>"https://sterobson.github.io/VolunteerCheckin/testing".replace(/\/?#?\/?$/,""),ms={requestLogin:e=>Je.post("/auth/request-login",{email:e,frontendUrl:id()}),verifyToken:e=>Je.post("/auth/verify-token",{token:e}),instantLogin:e=>Je.post("/auth/instant-login",{email:e}),createAdmin:e=>Je.post("/auth/create-admin",{email:e}),marshalLogin:(e,t)=>Je.post("/auth/marshal-login",{eventId:e,magicCode:t}),getMe:e=>Je.get("/auth/me",{params:{eventId:e}}),logout:()=>Je.post("/auth/logout")},Tr={getProfile:()=>Je.get("/auth/profile"),updateProfile:e=>Je.put("/auth/profile",e),getPerson:(e,t)=>Je.get(`/people/${e}`,{params:{eventId:t}}),updatePerson:(e,t,o)=>Je.put(`/people/${e}`,o,{params:{eventId:t}})},xa={create:e=>Je.post("/events",e),getAll:()=>Je.get("/events"),getById:e=>Je.get(`/events/${e}`),update:(e,t)=>Je.put(`/events/${e}`,t),delete:e=>Je.delete(`/events/${e}`),uploadGpx:(e,t)=>{const o=new FormData;return o.append("gpx",t),Je.post(`/events/${e}/upload-gpx`,o,{headers:{"Content-Type":"multipart/form-data"}})}},Bn={create:e=>Je.post("/locations",e),getById:(e,t)=>Je.get(`/locations/${e}/${t}`),getByEvent:(e,t={})=>Je.get(`/events/${e}/locations`,t),update:(e,t,o)=>Je.put(`/locations/${e}/${t}`,o),delete:(e,t)=>Je.delete(`/locations/${e}/${t}`),importCsv:(e,t,o)=>{const a=new FormData;return a.append("csv",t),Je.post(`/locations/import/${e}?deleteExisting=${o}`,a,{headers:{"Content-Type":"multipart/form-data"}})},bulkUpdateTimes:(e,t)=>Je.post(`/locations/bulk-update-times/${e}`,{timeDelta:t}),updatePosition:(e,t,o,a={})=>Je.post(`/locations/${e}/${t}/update-position`,o,a),getDynamicCheckpoints:(e,t={})=>Je.get(`/events/${e}/dynamic-checkpoints`,t)},Al={create:e=>Je.post("/assignments",e),getById:(e,t)=>Je.get(`/assignments/${e}/${t}`),getByEvent:e=>Je.get(`/assignments/event/${e}`),delete:(e,t)=>Je.delete(`/assignments/${e}/${t}`),getEventStatus:e=>Je.get(`/events/${e}/status`)},Aa={checkIn:e=>Je.post("/checkin",e),toggleCheckIn:(e,t,{latitude:o,longitude:a,action:n}={})=>Je.post(`/checkin/${e}/${t}/toggle`,{latitude:o??null,longitude:a??null,action:n??null}),adminCheckIn:(e,t)=>Je.post(`/checkin/admin/${e}/${t}`)},ru={getAdmins:e=>Je.get(`/events/${e}/admins`),addAdmin:(e,t)=>Je.post(`/events/${e}/admins`,{userEmail:t}),removeAdmin:(e,t)=>Je.delete(`/events/${e}/admins/${t}`)},gs={create:e=>Je.post("/marshals",e),getByEvent:e=>Je.get(`/events/${e}/marshals`),getById:(e,t)=>Je.get(`/marshals/${e}/${t}`),update:(e,t,o)=>Je.put(`/marshals/${e}/${t}`,o),delete:(e,t)=>Je.delete(`/marshals/${e}/${t}`),getMagicLink:(e,t)=>Je.get(`/marshals/${e}/${t}/magic-link`,{params:{frontendUrl:id()}}),sendMagicLink:(e,t)=>Je.post(`/marshals/${e}/${t}/send-magic-link`,{frontendUrl:id()}),importCsv:(e,t)=>{const o=new FormData;return o.append("csv",t),Je.post(`/marshals/import/${e}`,o,{headers:{"Content-Type":"multipart/form-data"}})}},Fs={create:e=>Je.post("/areas",e),getByEvent:e=>Je.get(`/events/${e}/areas`),getById:(e,t)=>Je.get(`/areas/${e}/${t}`),update:(e,t,o)=>Je.put(`/areas/${e}/${t}`,o),delete:(e,t)=>Je.delete(`/areas/${e}/${t}`),recalculate:e=>Je.post(`/areas/recalculate/${e}`),getCheckpoints:(e,t)=>Je.get(`/areas/${e}/${t}/locations`),getAreaLeadDashboard:e=>Je.get(`/events/${e}/area-lead-dashboard`)},Ut={create:(e,t)=>Je.post(`/events/${e}/checklist-items`,t),getByEvent:e=>Je.get(`/events/${e}/checklist-items`),getById:(e,t)=>Je.get(`/checklist-items/${e}/${t}`),update:(e,t,o)=>Je.put(`/checklist-items/${e}/${t}`,o),delete:(e,t)=>Je.delete(`/checklist-items/${e}/${t}`),getReport:e=>Je.get(`/events/${e}/checklist-report`),getMarshalChecklist:(e,t)=>Je.get(`/events/${e}/marshals/${t}/checklist`),getCheckpointChecklist:(e,t)=>Je.get(`/events/${e}/locations/${t}/checklist`),getAreaChecklist:(e,t)=>Je.get(`/events/${e}/areas/${t}/checklist`),complete:(e,t,o)=>Je.post(`/checklist-items/${e}/${t}/complete`,o),uncomplete:(e,t,o)=>Je.post(`/checklist-items/${e}/${t}/uncomplete`,o)},fs={create:(e,t)=>Je.post(`/events/${e}/notes`,t),getByEvent:e=>Je.get(`/events/${e}/notes`),getById:(e,t)=>Je.get(`/events/${e}/notes/${t}`),update:(e,t,o)=>Je.put(`/events/${e}/notes/${t}`,o),delete:(e,t)=>Je.delete(`/events/${e}/notes/${t}`),getMarshalNotes:(e,t)=>Je.get(`/events/${e}/marshals/${t}/notes`),getMyNotes:e=>Je.get(`/events/${e}/my-notes`)},_a={create:(e,t)=>Je.post(`/events/${e}/contacts`,t),getByEvent:e=>Je.get(`/events/${e}/contacts`),getById:(e,t)=>Je.get(`/events/${e}/contacts/${t}`),update:(e,t,o)=>Je.put(`/events/${e}/contacts/${t}`,o),delete:(e,t)=>Je.delete(`/events/${e}/contacts/${t}`),getRoles:e=>Je.get(`/events/${e}/contact-roles`),getMarshalContacts:(e,t)=>Je.get(`/events/${e}/marshals/${t}/contacts`),getMyContacts:e=>Je.get(`/events/${e}/my-contacts`)},vs={create:(e,t)=>Je.post(`/events/${e}/incidents`,t),getAll:(e,t={})=>Je.get(`/events/${e}/incidents`,{params:t}),getForArea:(e,t)=>Je.get(`/events/${e}/areas/${t}/incidents`),get:(e,t)=>Je.get(`/events/${e}/incidents/${t}`),updateStatus:(e,t,o)=>Je.patch(`/events/${e}/incidents/${t}`,o),addNote:(e,t,o)=>Je.post(`/events/${e}/incidents/${t}/notes`,{note:o})},T_={class:"hero-animation-container"},M_={__name:"HeroMapAnimation",props:{animate:{type:Boolean,default:!0}},setup(e){const t=e,o=A(!1);return ln(()=>{t.animate?requestAnimationFrame(()=>{o.value=!0}):o.value=!0}),(a,n)=>(v(),g("div",T_,[(v(),g("svg",{viewBox:"0 0 400 350",class:ve(["hero-map-svg",{animate:o.value&&e.animate,"no-animate":o.value&&!e.animate}])},[...n[0]||(n[0]=[Ql(`<defs data-v-cec8ae43><clipPath id="mapClip" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" data-v-cec8ae43></polygon></clipPath></defs><g class="map-group" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" fill="#c8e6c0" stroke="#8fbc8f" stroke-width="3" data-v-cec8ae43></polygon><g clip-path="url(#mapClip)" class="contours" data-v-cec8ae43><ellipse cx="300" cy="60" rx="35" ry="12" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="25" ry="8" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="15" ry="5" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="80" ry="40" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="55" ry="28" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="50" ry="25" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse></g><g clip-path="url(#mapClip)" class="roads" data-v-cec8ae43><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#1a5276" stroke-width="18" stroke-linecap="round" data-v-cec8ae43></path><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#5dade2" stroke-width="12" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#cc8800" stroke-width="10" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#ffcc00" stroke-width="6" stroke-linecap="round" data-v-cec8ae43></path></g><path id="routePath" d="M 60,360
             L 200,250
             L 150,150
             L 280,100
             L 450,60" fill="none" stroke="none" data-v-cec8ae43></path><g class="trail-segments" data-v-cec8ae43><path class="trail-seg trail-seg-1" d="M 60,360 L 200,250" fill="none" stroke="#dc3545" stroke-width="12" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-2" d="M 200,250 L 150,150" fill="none" stroke="#dc3545" stroke-width="9" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-3" d="M 150,150 L 280,100" fill="none" stroke="#dc3545" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-4" d="M 280,100 L 450,60" fill="none" stroke="#dc3545" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path></g><g class="checkpoint checkpoint-1" transform="translate(200, 250)" data-v-cec8ae43><ellipse cx="0" cy="8" rx="40" ry="12" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="4" rx="30" ry="10" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="25" ry="8" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-2" transform="translate(150, 150)" data-v-cec8ae43><ellipse cx="0" cy="6" rx="18" ry="8" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="3" rx="15" ry="6" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="12" ry="5" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-3" transform="translate(280, 100)" data-v-cec8ae43><ellipse cx="0" cy="4" rx="12" ry="5" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="2" rx="10" ry="4" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="8" ry="3" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="marshal marshal-1" transform="translate(200, 250)" data-v-cec8ae43><circle cx="0" cy="-28" r="12" fill="#444" data-v-cec8ae43></circle><path d="M 20,0 v-8 a12 12 0 0 0-12-12 h-16 a12 12 0 0 0-12 12 v8" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-2" transform="translate(150, 150)" data-v-cec8ae43><circle cx="0" cy="-18" r="8" fill="#444" data-v-cec8ae43></circle><path d="M 12,0 v-5 a8 8 0 0 0-8-8 h-8 a8 8 0 0 0-8 8 v5" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-3" transform="translate(280, 100)" data-v-cec8ae43><circle cx="0" cy="-12" r="6" fill="#444" data-v-cec8ae43></circle><path d="M 9,0 v-4 a6 6 0 0 0-6-6 h-6 a6 6 0 0 0-6 6 v4" fill="#444" data-v-cec8ae43></path></g><g clip-path="url(#mapClip)" class="trees" data-v-cec8ae43><g transform="translate(45, 280)" data-v-cec8ae43><polygon points="0,-20 12,0 -12,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-34 10,-12 -10,-12" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-46 8,-26 -8,-26" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-3" y="0" width="6" height="8" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(75, 255)" data-v-cec8ae43><polygon points="0,-18 10,0 -10,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-30 8,-10 -8,-10" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-40 6,-22 -6,-22" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="6" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(350, 230)" data-v-cec8ae43><polygon points="0,-20 11,0 -11,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-33 9,-11 -9,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-44 7,-24 -7,-24" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="7" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(60, 140)" data-v-cec8ae43><polygon points="0,-12 7,0 -7,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-20 5.5,-8 -5.5,-8" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-27 4,-15 -4,-15" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="4" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 70)" data-v-cec8ae43><polygon points="0,-9 5,0 -5,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-15 4,-6 -4,-6" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-20 3,-11 -3,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-1" y="0" width="2" height="3" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 140)" data-v-cec8ae43><polygon points="0,-14 8,0 -8,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-24 6,-9 -6,-9" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-32 5,-18 -5,-18" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="5" fill="#5d4037" data-v-cec8ae43></rect></g></g></g>`,2)])],2))]))}},A_=He(M_,[["__scopeId","data-v-cec8ae43"]]),E_={class:"hero-header"},P_={__name:"HeroHeader",props:{title:{type:String,default:""}},setup(e){const t=A(!1);return ln(()=>{window.__heroAnimationPlayed?t.value=!1:(t.value=!0,window.__heroAnimationPlayed=!0)}),(o,a)=>(v(),g("div",E_,[Me(A_,{animate:t.value},null,8,["animate"]),e.title?(v(),g("div",{key:0,class:ve(["hero-overlay",{"no-animate":!t.value}])},[r("h1",null,I(e.title),1)],2)):D("",!0)]))}},Xm=He(P_,[["__scopeId","data-v-c824ab01"]]),hr=Dd("auth",()=>{const e=A(localStorage.getItem("adminEmail")||null),t=A(!!e.value),o=A(!1);return{adminEmail:e,isAuthenticated:t,loginPending:o,requestLogin:async u=>{const d=await ms.requestLogin(u);return d.data.success&&(o.value=!0),d.data},verifyToken:async u=>{const d=await ms.verifyToken(u);return d.data.success&&(e.value=d.data.person?.email,t.value=!0,o.value=!1,localStorage.setItem("adminEmail",d.data.person?.email),localStorage.setItem("sessionToken",d.data.sessionToken),go("admin")),d.data},instantLogin:async u=>{const d=await ms.instantLogin(u);return d.data.success&&(e.value=d.data.email,t.value=!0,localStorage.setItem("adminEmail",d.data.email),d.data.sessionToken&&localStorage.setItem("sessionToken",d.data.sessionToken),go("admin")),d.data},logout:async()=>{try{await ms.logout()}catch{}e.value=null,t.value=!1,o.value=!1,localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken"),go(null)}}}),D_={class:"modal-card"},R_={key:0,class:"email-sent"},O_={key:1},B_={class:"form-group"},N_=["disabled"],F_={key:0,class:"error"},U_={__name:"LoginModal",props:{show:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3}},emits:["close","success"],setup(e,{emit:t}){const o=e,a=t,n=hr(),i=A(""),l=A(!1),u=A(null),d=A(!1);async function h(){l.value=!0,u.value=null;try{const y=await n.requestLogin(i.value);y.success?(d.value=!0,a("success",i.value)):u.value=y.message||"Failed to send login link. Please try again."}catch{u.value="Failed to send login link. Please try again."}finally{l.value=!1}}function f(){i.value="",d.value=!1,u.value=null}function m(){a("close")}return We(()=>o.show,y=>{y||setTimeout(()=>{f()},200)}),(y,k)=>(v(),Ke(Kl,{to:"body"},[Me(Jo,{name:"modal"},{default:Fe(()=>[e.show?(v(),g("div",{key:0,class:"modal-overlay",style:Qe({zIndex:e.zIndex}),onClick:lt(m,["self"])},[r("div",D_,[r("button",{class:"modal-close",onClick:m},""),d.value?(v(),g("div",R_,[k[2]||(k[2]=r("div",{class:"check-icon"},"",-1)),k[3]||(k[3]=r("h3",null,"Check your email!",-1)),r("p",null,[k[1]||(k[1]=Ye("We've sent a login link to ",-1)),r("strong",null,I(i.value),1)]),k[4]||(k[4]=r("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),r("button",{onClick:f,class:"btn btn-secondary"}," Use a different email ")])):(v(),g("div",O_,[k[5]||(k[5]=r("h2",null,"Join us or login",-1)),k[6]||(k[6]=r("p",{class:"instruction"},"Enter your email to receive a login link",-1)),r("form",{onSubmit:lt(h,["prevent"])},[r("div",B_,[ze(r("input",{"onUpdate:modelValue":k[0]||(k[0]=w=>i.value=w),type:"email",placeholder:"you@example.com",required:"",class:"form-input"},null,512),[[nt,i.value]])]),r("button",{type:"submit",class:"btn btn-primary btn-full",disabled:l.value},I(l.value?"Sending...":"Send login link"),9,N_)],32),u.value?(v(),g("div",F_,I(u.value),1)):D("",!0)]))])],4)):D("",!0)]),_:1})]))}},Qm=He(U_,[["__scopeId","data-v-7c646305"]]),z_={class:"home"},H_={class:"hero-section"},V_={class:"content-section"},G_={class:"container"},q_={class:"carousel"},j_={class:"carousel-indicators"},Z_=["onClick"],W_={__name:"Home",setup(e){const t=$c(),o=cl();function a(){const y=!!localStorage.getItem("adminEmail"),k=Cm();return y||k}function n(){a()?o.push("/sessions"):f.value=!0}const i=A(0);let l=null;function u(y){i.value=y,h()}function d(){i.value=(i.value+1)%2}function h(){l&&clearInterval(l),l=setInterval(d,1e4)}const f=A(!1);function m(){f.value=!1,t.query.login&&o.replace({query:{}})}return ln(()=>{h(),t.query.login&&(a()?o.replace("/sessions"):f.value=!0)}),Ln(()=>{l&&clearInterval(l)}),(y,k)=>(v(),g("div",z_,[r("section",H_,[Me(Xm,{title:"OnTheDay"}),k[0]||(k[0]=r("p",{class:"subtitle"},"Manage your event's marshals and volunteers with ease",-1)),r("button",{class:"btn btn-primary",onClick:n}," Join us or login ")]),r("section",V_,[r("div",G_,[k[2]||(k[2]=Ql('<div class="features-grid" data-v-aaecbd22><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For admins</h3><ul data-v-aaecbd22><li data-v-aaecbd22>Create and manage events</li><li data-v-aaecbd22>Define marshal locations</li><li data-v-aaecbd22>Real-time check-in monitoring</li><li data-v-aaecbd22>Map view of everything in your event</li><li data-v-aaecbd22>Manage incidents</li></ul></div><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For marshals</h3><ul data-v-aaecbd22><li data-v-aaecbd22>View the entire route</li><li data-v-aaecbd22>View your assigned location</li><li data-v-aaecbd22>Check in with GPS verification</li><li data-v-aaecbd22>Access emergency contact info</li><li data-v-aaecbd22>Record incidents</li></ul></div></div>',1)),r("div",q_,[r("div",{class:"carousel-track",style:Qe({transform:`translateX(-${i.value*100}%)`})},[...k[1]||(k[1]=[Ql('<div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For admins</h3><ul data-v-aaecbd22><li data-v-aaecbd22>Create and manage events</li><li data-v-aaecbd22>Define marshal locations</li><li data-v-aaecbd22>Real-time check-in monitoring</li><li data-v-aaecbd22>Map view of everything in your event</li><li data-v-aaecbd22>Manage incidents</li></ul></div><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For marshals</h3><ul data-v-aaecbd22><li data-v-aaecbd22>View the entire route</li><li data-v-aaecbd22>View your assigned location</li><li data-v-aaecbd22>Check in with GPS verification</li><li data-v-aaecbd22>Access emergency contact info</li><li data-v-aaecbd22>Record incidents</li></ul></div>',2)])],4),r("div",j_,[(v(),g(Ae,null,Ue(2,(w,S)=>r("button",{key:S,class:ve(["indicator",{active:i.value===S}]),onClick:T=>u(S)},null,10,Z_)),64))])])])]),Me(Qm,{show:f.value,onClose:m},null,8,["show"])]))}},K_=He(W_,[["__scopeId","data-v-aaecbd22"]]),J_={class:"admin-login"},Y_={class:"login-card"},X_={key:0,class:"email-sent"},Q_={class:"form-group"},ew=["disabled"],tw={key:0,class:"error"},nw={__name:"AdminLogin",setup(e){const t=hr(),o=A(""),a=A(!1),n=A(null),i=A(!1),l=async()=>{a.value=!0,n.value=null;try{const d=await t.requestLogin(o.value);d.success?i.value=!0:n.value=d.message||"Failed to send login link. Please try again."}catch{n.value="Failed to send login link. Please try again."}finally{a.value=!1}},u=()=>{o.value="",i.value=!1,n.value=null};return(d,h)=>{const f=xd("router-link");return v(),g("div",J_,[r("div",Y_,[h[7]||(h[7]=r("h2",null,"Admin login",-1)),i.value?(v(),g("div",X_,[h[2]||(h[2]=r("div",{class:"check-icon"},"",-1)),h[3]||(h[3]=r("h3",null,"Check your email!",-1)),r("p",null,[h[1]||(h[1]=Ye("We've sent a login link to ",-1)),r("strong",null,I(o.value),1)]),h[4]||(h[4]=r("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),r("button",{onClick:u,class:"btn btn-secondary"}," Use a different email ")])):(v(),g(Ae,{key:1},[h[5]||(h[5]=r("p",{class:"instruction"},"Enter your email to receive a login link",-1)),r("form",{onSubmit:lt(l,["prevent"])},[r("div",Q_,[ze(r("input",{"onUpdate:modelValue":h[0]||(h[0]=m=>o.value=m),type:"email",placeholder:"admin@example.com",required:"",class:"form-input"},null,512),[[nt,o.value]])]),r("button",{type:"submit",class:"btn btn-primary",disabled:a.value},I(a.value?"Sending...":"Send login link"),9,ew)],32),n.value?(v(),g("div",tw,I(n.value),1)):D("",!0)],64)),Me(f,{to:"/",class:"back-link"},{default:Fe(()=>[...h[6]||(h[6]=[Ye(" Back to Home",-1)])]),_:1})])])}}},ow=He(nw,[["__scopeId","data-v-5d0a88c2"]]),sw={class:"admin-verify"},aw={class:"verify-card"},iw={key:0,class:"status"},lw={key:1,class:"status error"},rw={key:2,class:"status success"},cw={__name:"AdminVerify",setup(e){const t=cl(),o=$c(),a=hr(),n=A(!0),i=A(null);return ln(async()=>{const l=o.query.token;if(!l){i.value="No login token provided. Please request a new login link.",n.value=!1;return}try{const u=await a.verifyToken(l);u.success?setTimeout(()=>{t.push({name:"Sessions"})},1e3):i.value=u.message||"Invalid or expired login link. Please request a new one."}catch(u){console.error("Verification error:",u),i.value="Failed to verify login. Please try again."}finally{n.value=!1}}),(l,u)=>{const d=xd("router-link");return v(),g("div",sw,[r("div",aw,[n.value?(v(),g("div",iw,[...u[0]||(u[0]=[r("div",{class:"spinner"},null,-1),r("h2",null,"Verifying your login...",-1),r("p",null,"Please wait while we confirm your identity.",-1)])])):i.value?(v(),g("div",lw,[u[2]||(u[2]=r("h2",null,"Login failed",-1)),r("p",null,I(i.value),1),Me(d,{to:{name:"Home",query:{login:"true"}},class:"btn btn-primary"},{default:Fe(()=>[...u[1]||(u[1]=[Ye(" Try again ",-1)])]),_:1})])):(v(),g("div",rw,[...u[3]||(u[3]=[r("h2",null,"Login successful!",-1),r("p",null,"Redirecting to your sessions...",-1)])]))])])}}},uw=He(cw,[["__scopeId","data-v-b2435a84"]]),eg=Dd("events",()=>{const e=A([]),t=A(null),o=A([]),a=A([]),n=A(null),i=A(!1),l=A(null),u=async()=>{i.value=!0,l.value=null;try{const H=await xa.getAll();e.value=H.data}catch(H){throw l.value=H.message,H}finally{i.value=!1}},d=async H=>{i.value=!0,l.value=null;try{const E=await xa.getById(H);t.value=E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},h=async H=>{i.value=!0,l.value=null;try{const E=await xa.create(H);return e.value.push(E.data),E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},f=async(H,E)=>{i.value=!0,l.value=null;try{const B=await xa.update(H,E),R=e.value.findIndex(U=>U.id===H);return R!==-1&&(e.value[R]=B.data),t.value?.id===H&&(t.value=B.data),B.data}catch(B){throw l.value=B.message,B}finally{i.value=!1}},m=async H=>{i.value=!0,l.value=null;try{await xa.delete(H),e.value=e.value.filter(E=>E.id!==H)}catch(E){throw l.value=E.message,E}finally{i.value=!1}},y=async H=>{i.value=!0,l.value=null;try{const E=await Bn.getByEvent(H);o.value=E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}};return{events:e,currentEvent:t,locations:o,assignments:a,eventStatus:n,loading:i,error:l,fetchEvents:u,fetchEvent:d,createEvent:h,updateEvent:f,deleteEvent:m,fetchLocations:y,createLocation:async H=>{i.value=!0,l.value=null;try{const E=await Bn.create(H);return o.value.push(E.data),E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},updateLocation:async(H,E,B)=>{i.value=!0,l.value=null;try{const R=await Bn.update(H,E,B),U=o.value.findIndex(F=>F.id===E);return U!==-1&&(o.value[U]=R.data),R.data}catch(R){throw l.value=R.message,R}finally{i.value=!1}},deleteLocation:async(H,E)=>{i.value=!0,l.value=null;try{await Bn.delete(H,E),o.value=o.value.filter(B=>B.id!==E)}catch(B){throw l.value=B.message,B}finally{i.value=!1}},bulkUpdateLocationTimes:async(H,E)=>{i.value=!0,l.value=null;try{const B=await Bn.bulkUpdateTimes(H,E);return await y(H),B.data}catch(B){throw l.value=B.message,B}finally{i.value=!1}},fetchAssignments:async H=>{i.value=!0,l.value=null;try{const E=await Al.getByEvent(H);a.value=E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},createAssignment:async H=>{i.value=!0,l.value=null;try{const E=await Al.create(H);return a.value.push(E.data),E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},deleteAssignment:async(H,E)=>{i.value=!0,l.value=null;try{await Al.delete(H,E),a.value=a.value.filter(B=>B.id!==E)}catch(B){throw l.value=B.message,B}finally{i.value=!1}},fetchEventStatus:async H=>{i.value=!0,l.value=null;try{const E=await Al.getEventStatus(H);return n.value=E.data,E.data}catch(E){throw l.value=E.message,E}finally{i.value=!1}},updateAssignmentCheckIn:H=>{const E=a.value.findIndex(B=>B.id===H.id);E!==-1&&(a.value[E]=H),n.value&&n.value.locations.forEach(B=>{const R=B.assignments.findIndex(U=>U.id===H.id);R!==-1&&(B.assignments[R]=H,B.checkedInCount=B.assignments.filter(U=>U.isCheckedIn).length)})}}});function tg(e="details",t=[]){const o=A(e),a=m=>{o.value=m},n=()=>{o.value=e},i=m=>o.value===m,l=V(()=>t.length===0?-1:t.indexOf(o.value)),u=(m=!1)=>{if(t.length===0)return;const y=l.value;if(y===-1)return;const k=y+1;k<t.length?o.value=t[k]:m&&(o.value=t[0])},d=(m=!1)=>{if(t.length===0)return;const y=l.value;if(y===-1)return;const k=y-1;k>=0?o.value=t[k]:m&&(o.value=t[t.length-1])},h=V(()=>{if(t.length===0)return!1;const m=l.value;return m!==-1&&m<t.length-1}),f=V(()=>t.length===0?!1:l.value>0);return{activeTab:o,activeTabIndex:l,hasNextTab:h,hasPreviousTab:f,switchTab:a,resetTab:n,isActiveTab:i,nextTab:u,previousTab:d}}function dw(){const e=A(!1),t=A(""),o=A(""),a=A(null),n=A(!1),i=A("OK");return{showConfirmModal:e,confirmModalTitle:t,confirmModalMessage:o,confirmModalIsDanger:n,confirmModalConfirmText:i,showConfirm:(f,m,y,k={})=>{t.value=f,o.value=m,a.value=y,n.value=k.isDanger||!1,i.value=k.confirmText||"OK",e.value=!0},handleConfirmModalConfirm:()=>{e.value=!1,a.value&&(a.value(),a.value=null)},handleConfirmModalCancel:()=>{e.value=!1,a.value=null},closeConfirmModal:()=>{e.value=!1,a.value=null}}}const Ki=A({people:"Marshals",checkpoint:"Checkpoints",area:"Areas",checklist:"Checklists",course:"Course"}),zs={people:{People:{singular:"Person",plural:"People"},Marshals:{singular:"Marshal",plural:"Marshals"},Volunteers:{singular:"Volunteer",plural:"Volunteers"},Helpers:{singular:"Helper",plural:"Helpers"},Staff:{singular:"Staff member",plural:"Staff"},Stewards:{singular:"Steward",plural:"Stewards"},"Team members":{singular:"Team member",plural:"Team members"},Drivers:{singular:"Driver",plural:"Drivers"},Pilots:{singular:"Pilot",plural:"Pilots"}},checkpoint:{Checkpoints:{singular:"Checkpoint",plural:"Checkpoints"},Stations:{singular:"Station",plural:"Stations"},Locations:{singular:"Location",plural:"Locations"},"Feed stations":{singular:"Feed station",plural:"Feed stations"},"Aid stations":{singular:"Aid station",plural:"Aid stations"},"Water stations":{singular:"Water station",plural:"Water stations"},"Person points":{singular:null,plural:null,dynamic:!0}},area:{Areas:{singular:"Area",plural:"Areas"},Regions:{singular:"Region",plural:"Regions"},Zones:{singular:"Zone",plural:"Zones"}},checklist:{Checklists:{singular:"Checklist",plural:"Checklists"},Tasks:{singular:"Task",plural:"Tasks"},Jobs:{singular:"Job",plural:"Jobs"}},course:{Course:{singular:"Course",plural:"Courses"},Route:{singular:"Route",plural:"Routes"},Track:{singular:"Track",plural:"Tracks"},Trail:{singular:"Trail",plural:"Trails"},Path:{singular:"Path",plural:"Paths"}}},Us={people:["Drivers","Helpers","Marshals","People","Pilots","Staff","Stewards","Team members","Volunteers"],checkpoint:["Aid stations","Checkpoints","Feed stations","Locations","Person points","Stations","Water stations"],area:["Areas","Regions","Zones"],checklist:["Checklists","Jobs","Tasks"],course:["Course","Path","Route","Track","Trail"]};function ui(e,t,o="Marshals"){if(!t)return"";const a=zs[e]?.[t];return e==="checkpoint"&&t==="Person points"?`${zs.people[o]?.singular||"Person"} point`:a?.singular?a.singular:t.endsWith("s")&&!t.endsWith("ss")?t.slice(0,-1):t}function ng(e,t,o="Marshals"){if(!t)return"";const a=zs[e]?.[t];return t==="Person points"?`${zs.people[o]?.singular||"Person"} points`:a?.plural?a.plural:t}function ld(e,t){return e==="Person points"?`${zs.people[t]?.singular||"Person"} points`:e}function rd(e){e&&(Ki.value={people:e.peopleTerm||"Marshals",checkpoint:e.checkpointTerm||"Checkpoints",area:e.areaTerm||"Areas",checklist:e.checklistTerm||"Checklists",course:e.courseTerm||"Course"})}const Go=e=>e.toLowerCase(),qo=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();function ct(){const e=f=>{const m=Ki.value[f],y=zs[f]?.[m];if(f==="checkpoint"&&m==="Person points"){const k=Ki.value.people;return`${zs.people[k]?.singular||"Person"} point`}return y?.singular||m},t=f=>{const m=Ki.value[f],y=zs[f]?.[m];if(f==="checkpoint"&&m==="Person points"){const k=Ki.value.people;return`${zs.people[k]?.singular||"Person"} points`}return y?.plural||m},o=V(()=>({person:e("people"),checkpoint:e("checkpoint"),area:e("area"),checklist:e("checklist"),course:e("course"),people:t("people"),checkpoints:t("checkpoint"),areas:t("area"),checklists:t("checklist"),courses:t("course")})),a=V(()=>({person:Go(e("people")),checkpoint:Go(e("checkpoint")),area:Go(e("area")),checklist:Go(e("checklist")),course:Go(e("course")),people:Go(t("people")),checkpoints:Go(t("checkpoint")),areas:Go(t("area")),checklists:Go(t("checklist")),courses:Go(t("course"))})),n=V(()=>({person:qo(e("people")),checkpoint:qo(e("checkpoint")),area:qo(e("area")),checklist:qo(e("checklist")),course:qo(e("course")),people:qo(t("people")),checkpoints:qo(t("checkpoint")),areas:qo(t("area")),checklists:qo(t("checklist")),courses:qo(t("course"))})),i=V(()=>({course:o.value.course,checkpoints:o.value.checkpoints,areas:o.value.areas,marshals:o.value.people,checklists:o.value.checklists,notes:"Notes",details:"Event details"}));return{terms:o,termsLower:a,termsSentence:n,tabLabels:i,singular:e,plural:t,formatCount:(f,m)=>m===1?`1 ${e(f)}`:`${m} ${t(f)}`,lower:(f,m=!0)=>Go(m?t(f):e(f)),title:(f,m=!0)=>m?t(f):e(f),sentence:(f,m=!0)=>qo(m?t(f):e(f)),terminology:Ki}}function hw(){const e=A(!1),t=A(null),o=A({}),a=A(null),n=A(null),i=A([]),l=A(null),u=A(null),d=A(!1),h=A(!1),f=A(1),m=V(()=>t.value==="place-checkpoint"||t.value==="move-checkpoint"?a.value!==null:t.value==="draw-area"?n.value&&n.value.length>=3:t.value==="add-multiple"),y=Y=>{if(Y){const oe=Y.getMapCenter?.(),Oe=Y.getMapZoom?.();oe&&Oe!==null&&(l.value=oe,u.value=Oe)}},k=(Y={})=>{a.value=null,e.value=!0,t.value="place-checkpoint",o.value={title:Y.title||"Select checkpoint location",description:Y.description||"Click on the map to set the location. Click again to reposition."}},w=(Y,oe="checkpoint")=>{a.value=null,e.value=!0,t.value="move-checkpoint",o.value={title:`Move ${oe}: ${Y}`,description:"Click on the map to set the new location"}},S=(Y={})=>{e.value=!0,t.value="draw-area",d.value=!0,o.value={title:Y.title||"Draw area boundary",description:Y.description||"Click to add points. Click Done when finished to complete the area."}},T=(Y=1)=>{f.value=Y,i.value=[],e.value=!0,t.value="add-multiple",h.value=!0,o.value={title:"Add multiple checkpoints",description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},x=Y=>{t.value==="place-checkpoint"||t.value==="move-checkpoint"?a.value=Y:t.value==="add-multiple"&&C(Y)},C=Y=>{i.value.push({id:`temp-${f.value}`,name:`Checkpoint ${f.value}`,description:"",latitude:Y.lat,longitude:Y.lng,requiredMarshals:1,what3Words:"",assignments:[],isTemporary:!0}),f.value++,o.value={...o.value,description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},_=Y=>{n.value=Y},$=()=>n.value&&n.value.length>=3?n.value.map(Y=>({lat:Y.lat,lng:Y.lng})):null,M=()=>{e.value=!1,t.value=null,o.value={},a.value=null,l.value=null,u.value=null,n.value=null,d.value&&(d.value=!1)};return{isFullscreenMapActive:e,fullscreenMode:t,fullscreenContext:o,tempLocationCoords:a,currentDrawingPolygon:n,tempCheckpoints:i,savedMapCenter:l,savedMapZoom:u,isDrawingAreaBoundary:d,isAddingMultipleCheckpoints:h,multiCheckpointCounter:f,canCompleteFullscreen:m,saveMapState:y,enterPlaceCheckpointMode:k,enterMoveCheckpointMode:w,enterDrawAreaMode:S,enterAddMultipleMode:T,handleFullscreenMapClick:x,handlePolygonDrawing:_,getCompletedPolygon:$,exitFullscreen:M,cancelFullscreen:()=>{t.value==="add-multiple"?(i.value=[],h.value=!1):t.value==="draw-area"&&(d.value=!1,n.value=null),M()},getTempCheckpoints:()=>[...i.value],clearTempCheckpoints:()=>{i.value=[],h.value=!1},getPlacedCoords:()=>a.value,createDisplayCheckpoints:(Y,oe,Oe)=>V(()=>{const ee=[...Y.value];return t.value==="place-checkpoint"&&a.value&&ee.push({id:"temp-single",name:oe.value?.name||"New Checkpoint",latitude:a.value.lat,longitude:a.value.lng,requiredMarshals:oe.value?.requiredMarshals||1,assignments:[],isTemporary:!0}),t.value==="move-checkpoint"&&a.value&&Oe.value&&ee.push({id:"temp-move",name:Oe.value.name+" (new position)",latitude:a.value.lat,longitude:a.value.lng,requiredMarshals:Oe.value.requiredMarshals,assignments:[],isTemporary:!0}),t.value==="add-multiple"&&ee.push(...i.value),ee}),createDisplayAreas:(Y,oe)=>V(()=>{const Oe=[...Y.value];if(t.value==="draw-area"&&oe.value?.polygon?.length>0){const ee=Oe.findIndex(te=>te.id===oe.value.id);ee>=0?Oe[ee]={...oe.value}:Oe.push({...oe.value,id:oe.value.id||"temp-area"})}return Oe}),calculateStartingNumber:Y=>{const oe=Y.value.map(Oe=>{const ee=Oe.name.match(/^Checkpoint (\d+)$/);return ee?parseInt(ee[1]):0}).filter(Oe=>Oe>0);return oe.length>0?Math.max(...oe)+1:1}}}function fw(e){const t=A([]),o=A(!1);return{eventAdmins:t,showAddAdmin:o,loadEventAdmins:async()=>{try{const d=await ru.getAdmins(e.value);return t.value=d.data,d.data}catch(d){throw console.error("Failed to load event admins:",d),d}},openAddAdminModal:()=>{o.value=!0},closeAddAdminModal:()=>{o.value=!1},addAdmin:async d=>{await ru.addAdmin(e.value,d)},removeAdmin:async d=>{await ru.removeAdmin(e.value,d)}}}function pw(e){const t=A(!1),o=A(!1),a=A(!1),n=A(!1),i=A(!1),l=A(!1),u=A(null),d=A(null),h=A(null),f=A(null);return{showUploadRoute:t,showImportLocations:o,showImportMarshals:a,uploading:n,importing:i,importingMarshals:l,uploadError:u,importError:d,importResult:h,importMarshalsResult:f,openUploadRouteModal:()=>{u.value=null,t.value=!0},closeUploadRouteModal:()=>{t.value=!1,u.value=null},uploadRoute:async M=>{if(!M)return u.value="Please select a GPX file",null;n.value=!0,u.value=null;try{return await xa.uploadGpx(e.value,M),!0}catch(H){return console.error("Failed to upload route:",H),u.value=H.response?.data?.message||"Failed to upload route. Please try again.",null}finally{n.value=!1}},openImportLocationsModal:()=>{d.value=null,h.value=null,o.value=!0},closeImportLocationsModal:()=>{o.value=!1,d.value=null,h.value=null},importLocations:async(M,H)=>{if(!M)return d.value="Please select a CSV file",null;i.value=!0,d.value=null,h.value=null;try{const E=await Bn.importCsv(e.value,M,H);return h.value=E.data,E.data}catch(E){return console.error("Failed to import locations:",E),d.value=E.response?.data?.message||"Failed to import locations. Please try again.",null}finally{i.value=!1}},openImportMarshalsModal:()=>{d.value=null,f.value=null,a.value=!0},closeImportMarshalsModal:()=>{a.value=!1,d.value=null,f.value=null},importMarshals:async M=>{if(!M)return d.value="Please select a CSV file",null;l.value=!0,d.value=null,f.value=null;try{const H=await gs.importCsv(e.value,M);return f.value=H.data,H.data}catch(H){return console.error("Failed to import marshals:",H),d.value=H.response?.data?.message||"Failed to import marshals. Please try again.",null}finally{l.value=!1}},formatImportResultMessage:(M,H="location")=>{const E=H==="location"?"location(s)":"marshal(s)";let R=`<p>Created <strong>${M[H==="location"?"locationsCreated":"marshalsCreated"]}</strong> ${E} and <strong>${M.assignmentsCreated}</strong> assignment(s)</p>`;return M.errors&&M.errors.length>0&&(R+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',M.errors.forEach(U=>{R+=`<li>${U}</li>`}),R+="</ul>"),R}}}const og="admin-theme-preference",ii=A(vw());function vw(){return typeof window>"u"?"system":localStorage.getItem(og)||"system"}function mw(e){localStorage.setItem(og,e)}function sg(){const e=V(()=>ii.value==="system"?"light dark":ii.value),t=(n,i=!0)=>{i&&typeof document<"u"&&(document.documentElement.classList.add("theme-transitioning"),setTimeout(()=>{document.documentElement.classList.remove("theme-transitioning")},1e3)),ii.value=n,mw(n)},o=()=>{const n=["system","light","dark"],l=(n.indexOf(ii.value)+1)%n.length;t(n[l])},a=V(()=>ii.value==="dark"?!0:ii.value==="light"?!1:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1);return{theme:ii,colorScheme:e,isDark:a,setTheme:t,cycleTheme:o}}const ag=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",sr=e=>{if(!e)return"";const t=new Date(e),o=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0");return`${o}-${a}-${n}T${i}:${l}`},ac=e=>{if(!e||e.trim()==="")return!0;if(!/^[a-z]{1,20}[./][a-z]{1,20}[./][a-z]{1,20}$/.test(e))return!1;const o=e.includes("."),a=e.includes("/");return o!==a},_i=(e,t,o,a)=>{const i=e*Math.PI/180,l=o*Math.PI/180,u=(o-e)*Math.PI/180,d=(a-t)*Math.PI/180,h=Math.sin(u/2)*Math.sin(u/2)+Math.cos(i)*Math.cos(l)*Math.sin(d/2)*Math.sin(d/2);return 6371e3*(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)))},gw=e=>!e&&e!==0?"":e<1e3?`${Math.round(e)} m`:`${(e/1e3).toFixed(2)} km`;function cu(e,{areas:t=[],locations:o=[],marshals:a=[]}){if(!e||e.length===0)return e;const n=new Set(t.map(h=>h.id)),i=new Set(o.map(h=>h.id)),l=new Set(a.map(h=>h.id)),u=new Set(["ALL_MARSHALS","ALL_AREAS","ALL_CHECKPOINTS","THIS_CHECKPOINT"]);return e.map(h=>{const f=h.itemType,m=h.ids||[];if(!f||m.length===0)return h;const y=m.filter(k=>u.has(k)?!0:f==="Area"?n.has(k):f==="Checkpoint"?i.has(k):f==="Marshal"?l.has(k):!0);return{...h,ids:y}}).filter(h=>h.itemType?h.ids&&h.ids.length>0:!0)}function ig({scopeConfigurations:e=[],marshalId:t,marshalAssignmentLocationIds:o=[],areaLeadAreaIds:a=[],locationId:n,locationAreaIds:i=[]}){if(!e||e.length===0)return!0;for(const l of e){const u=l.scope||l.Scope,d=l.ids||l.Ids||[];switch(u){case"SpecificPeople":if(d.includes("ALL_MARSHALS")||d.includes(t))return!0;break;case"EveryoneAtCheckpoints":if(d.includes("ALL_CHECKPOINTS")){if(o.length>0)return!0}else if((d.includes("THIS_CHECKPOINT")||d.includes(n))&&o.includes(n)||d.some(f=>o.includes(f)))return!0;break;case"EveryoneInAreas":if(d.includes("ALL_AREAS")){if(o.length>0)return!0}else if(d.some(f=>i.includes(f))&&o.includes(n))return!0;break;case"EveryAreaLead":if(d.includes("ALL_AREAS")){if(a.length>0)return!0}else if(d.some(f=>a.includes(f)))return!0;break}}return!1}function lg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var El={exports:{}};var yw=El.exports,Hf;function kw(){return Hf||(Hf=1,(function(e,t){(function(o,a){a(t)})(yw,(function(o){var a="1.9.4";function n(s){var c,p,b,P;for(p=1,b=arguments.length;p<b;p++){P=arguments[p];for(c in P)s[c]=P[c]}return s}var i=Object.create||(function(){function s(){}return function(c){return s.prototype=c,new s}})();function l(s,c){var p=Array.prototype.slice;if(s.bind)return s.bind.apply(s,p.call(arguments,1));var b=p.call(arguments,2);return function(){return s.apply(c,b.length?b.concat(p.call(arguments)):arguments)}}var u=0;function d(s){return"_leaflet_id"in s||(s._leaflet_id=++u),s._leaflet_id}function h(s,c,p){var b,P,q,ae;return ae=function(){b=!1,P&&(q.apply(p,P),P=!1)},q=function(){b?P=arguments:(s.apply(p,arguments),setTimeout(ae,c),b=!0)},q}function f(s,c,p){var b=c[1],P=c[0],q=b-P;return s===b&&p?s:((s-P)%q+q)%q+P}function m(){return!1}function y(s,c){if(c===!1)return s;var p=Math.pow(10,c===void 0?6:c);return Math.round(s*p)/p}function k(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function w(s){return k(s).split(/\s+/)}function S(s,c){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?i(s.options):{});for(var p in c)s.options[p]=c[p];return s.options}function T(s,c,p){var b=[];for(var P in s)b.push(encodeURIComponent(p?P.toUpperCase():P)+"="+encodeURIComponent(s[P]));return(!c||c.indexOf("?")===-1?"?":"&")+b.join("&")}var x=/\{ *([\w_ -]+) *\}/g;function C(s,c){return s.replace(x,function(p,b){var P=c[b];if(P===void 0)throw new Error("No value provided for variable "+p);return typeof P=="function"&&(P=P(c)),P})}var _=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function $(s,c){for(var p=0;p<s.length;p++)if(s[p]===c)return p;return-1}var M="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function H(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var E=0;function B(s){var c=+new Date,p=Math.max(0,16-(c-E));return E=c+p,window.setTimeout(s,p)}var R=window.requestAnimationFrame||H("RequestAnimationFrame")||B,U=window.cancelAnimationFrame||H("CancelAnimationFrame")||H("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function F(s,c,p){if(p&&R===B)s.call(c);else return R.call(window,l(s,c))}function j(s){s&&U.call(window,s)}var Y={__proto__:null,extend:n,create:i,bind:l,get lastId(){return u},stamp:d,throttle:h,wrapNum:f,falseFn:m,formatNum:y,trim:k,splitWords:w,setOptions:S,getParamString:T,template:C,isArray:_,indexOf:$,emptyImageUrl:M,requestFn:R,cancelFn:U,requestAnimFrame:F,cancelAnimFrame:j};function oe(){}oe.extend=function(s){var c=function(){S(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},p=c.__super__=this.prototype,b=i(p);b.constructor=c,c.prototype=b;for(var P in this)Object.prototype.hasOwnProperty.call(this,P)&&P!=="prototype"&&P!=="__super__"&&(c[P]=this[P]);return s.statics&&n(c,s.statics),s.includes&&(Oe(s.includes),n.apply(null,[b].concat(s.includes))),n(b,s),delete b.statics,delete b.includes,b.options&&(b.options=p.options?i(p.options):{},n(b.options,s.options)),b._initHooks=[],b.callInitHooks=function(){if(!this._initHooksCalled){p.callInitHooks&&p.callInitHooks.call(this),this._initHooksCalled=!0;for(var q=0,ae=b._initHooks.length;q<ae;q++)b._initHooks[q].call(this)}},c},oe.include=function(s){var c=this.prototype.options;return n(this.prototype,s),s.options&&(this.prototype.options=c,this.mergeOptions(s.options)),this},oe.mergeOptions=function(s){return n(this.prototype.options,s),this},oe.addInitHook=function(s){var c=Array.prototype.slice.call(arguments,1),p=typeof s=="function"?s:function(){this[s].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(p),this};function Oe(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=_(s)?s:[s];for(var c=0;c<s.length;c++)s[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ee={on:function(s,c,p){if(typeof s=="object")for(var b in s)this._on(b,s[b],c);else{s=w(s);for(var P=0,q=s.length;P<q;P++)this._on(s[P],c,p)}return this},off:function(s,c,p){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var b in s)this._off(b,s[b],c);else{s=w(s);for(var P=arguments.length===1,q=0,ae=s.length;q<ae;q++)P?this._off(s[q]):this._off(s[q],c,p)}return this},_on:function(s,c,p,b){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(s,c,p)===!1){p===this&&(p=void 0);var P={fn:c,ctx:p};b&&(P.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(P)}},_off:function(s,c,p){var b,P,q;if(this._events&&(b=this._events[s],!!b)){if(arguments.length===1){if(this._firingCount)for(P=0,q=b.length;P<q;P++)b[P].fn=m;delete this._events[s];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var ae=this._listens(s,c,p);if(ae!==!1){var Le=b[ae];this._firingCount&&(Le.fn=m,this._events[s]=b=b.slice()),b.splice(ae,1)}}},fire:function(s,c,p){if(!this.listens(s,p))return this;var b=n({},c,{type:s,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var P=this._events[s];if(P){this._firingCount=this._firingCount+1||1;for(var q=0,ae=P.length;q<ae;q++){var Le=P[q],Pe=Le.fn;Le.once&&this.off(s,Pe,Le.ctx),Pe.call(Le.ctx||this,b)}this._firingCount--}}return p&&this._propagateEvent(b),this},listens:function(s,c,p,b){typeof s!="string"&&console.warn('"string" type argument expected');var P=c;typeof c!="function"&&(b=!!c,P=void 0,p=void 0);var q=this._events&&this._events[s];if(q&&q.length&&this._listens(s,P,p)!==!1)return!0;if(b){for(var ae in this._eventParents)if(this._eventParents[ae].listens(s,c,p,b))return!0}return!1},_listens:function(s,c,p){if(!this._events)return!1;var b=this._events[s]||[];if(!c)return!!b.length;p===this&&(p=void 0);for(var P=0,q=b.length;P<q;P++)if(b[P].fn===c&&b[P].ctx===p)return P;return!1},once:function(s,c,p){if(typeof s=="object")for(var b in s)this._on(b,s[b],c,!0);else{s=w(s);for(var P=0,q=s.length;P<q;P++)this._on(s[P],c,p,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[d(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[d(s)],this},_propagateEvent:function(s){for(var c in this._eventParents)this._eventParents[c].fire(s.type,n({layer:s.target,propagatedFrom:s.target},s),!0)}};ee.addEventListener=ee.on,ee.removeEventListener=ee.clearAllEventListeners=ee.off,ee.addOneTimeEventListener=ee.once,ee.fireEvent=ee.fire,ee.hasEventListeners=ee.listens;var te=oe.extend(ee);function O(s,c,p){this.x=p?Math.round(s):s,this.y=p?Math.round(c):c}var Z=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};O.prototype={clone:function(){return new O(this.x,this.y)},add:function(s){return this.clone()._add(ne(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(ne(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new O(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new O(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Z(this.x),this.y=Z(this.y),this},distanceTo:function(s){s=ne(s);var c=s.x-this.x,p=s.y-this.y;return Math.sqrt(c*c+p*p)},equals:function(s){return s=ne(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=ne(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+y(this.x)+", "+y(this.y)+")"}};function ne(s,c,p){return s instanceof O?s:_(s)?new O(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new O(s.x,s.y):new O(s,c,p)}function pe(s,c){if(s)for(var p=c?[s,c]:s,b=0,P=p.length;b<P;b++)this.extend(p[b])}pe.prototype={extend:function(s){var c,p;if(!s)return this;if(s instanceof O||typeof s[0]=="number"||"x"in s)c=p=ne(s);else if(s=we(s),c=s.min,p=s.max,!c||!p)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=p.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(p.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(p.y,this.max.y)),this},getCenter:function(s){return ne((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return ne(this.min.x,this.max.y)},getTopRight:function(){return ne(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var c,p;return typeof s[0]=="number"||s instanceof O?s=ne(s):s=we(s),s instanceof pe?(c=s.min,p=s.max):c=p=s,c.x>=this.min.x&&p.x<=this.max.x&&c.y>=this.min.y&&p.y<=this.max.y},intersects:function(s){s=we(s);var c=this.min,p=this.max,b=s.min,P=s.max,q=P.x>=c.x&&b.x<=p.x,ae=P.y>=c.y&&b.y<=p.y;return q&&ae},overlaps:function(s){s=we(s);var c=this.min,p=this.max,b=s.min,P=s.max,q=P.x>c.x&&b.x<p.x,ae=P.y>c.y&&b.y<p.y;return q&&ae},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var c=this.min,p=this.max,b=Math.abs(c.x-p.x)*s,P=Math.abs(c.y-p.y)*s;return we(ne(c.x-b,c.y-P),ne(p.x+b,p.y+P))},equals:function(s){return s?(s=we(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function we(s,c){return!s||s instanceof pe?s:new pe(s,c)}function Ze(s,c){if(s)for(var p=c?[s,c]:s,b=0,P=p.length;b<P;b++)this.extend(p[b])}Ze.prototype={extend:function(s){var c=this._southWest,p=this._northEast,b,P;if(s instanceof Ge)b=s,P=s;else if(s instanceof Ze){if(b=s._southWest,P=s._northEast,!b||!P)return this}else return s?this.extend(Xe(s)||Ne(s)):this;return!c&&!p?(this._southWest=new Ge(b.lat,b.lng),this._northEast=new Ge(P.lat,P.lng)):(c.lat=Math.min(b.lat,c.lat),c.lng=Math.min(b.lng,c.lng),p.lat=Math.max(P.lat,p.lat),p.lng=Math.max(P.lng,p.lng)),this},pad:function(s){var c=this._southWest,p=this._northEast,b=Math.abs(c.lat-p.lat)*s,P=Math.abs(c.lng-p.lng)*s;return new Ze(new Ge(c.lat-b,c.lng-P),new Ge(p.lat+b,p.lng+P))},getCenter:function(){return new Ge((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Ge(this.getNorth(),this.getWest())},getSouthEast:function(){return new Ge(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof Ge||"lat"in s?s=Xe(s):s=Ne(s);var c=this._southWest,p=this._northEast,b,P;return s instanceof Ze?(b=s.getSouthWest(),P=s.getNorthEast()):b=P=s,b.lat>=c.lat&&P.lat<=p.lat&&b.lng>=c.lng&&P.lng<=p.lng},intersects:function(s){s=Ne(s);var c=this._southWest,p=this._northEast,b=s.getSouthWest(),P=s.getNorthEast(),q=P.lat>=c.lat&&b.lat<=p.lat,ae=P.lng>=c.lng&&b.lng<=p.lng;return q&&ae},overlaps:function(s){s=Ne(s);var c=this._southWest,p=this._northEast,b=s.getSouthWest(),P=s.getNorthEast(),q=P.lat>c.lat&&b.lat<p.lat,ae=P.lng>c.lng&&b.lng<p.lng;return q&&ae},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,c){return s?(s=Ne(s),this._southWest.equals(s.getSouthWest(),c)&&this._northEast.equals(s.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Ne(s,c){return s instanceof Ze?s:new Ze(s,c)}function Ge(s,c,p){if(isNaN(s)||isNaN(c))throw new Error("Invalid LatLng object: ("+s+", "+c+")");this.lat=+s,this.lng=+c,p!==void 0&&(this.alt=+p)}Ge.prototype={equals:function(s,c){if(!s)return!1;s=Xe(s);var p=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return p<=(c===void 0?1e-9:c)},toString:function(s){return"LatLng("+y(this.lat,s)+", "+y(this.lng,s)+")"},distanceTo:function(s){return ye.distance(this,Xe(s))},wrap:function(){return ye.wrapLatLng(this)},toBounds:function(s){var c=180*s/40075017,p=c/Math.cos(Math.PI/180*this.lat);return Ne([this.lat-c,this.lng-p],[this.lat+c,this.lng+p])},clone:function(){return new Ge(this.lat,this.lng,this.alt)}};function Xe(s,c,p){return s instanceof Ge?s:_(s)&&typeof s[0]!="object"?s.length===3?new Ge(s[0],s[1],s[2]):s.length===2?new Ge(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new Ge(s.lat,"lng"in s?s.lng:s.lon,s.alt):c===void 0?null:new Ge(s,c,p)}var Q={latLngToPoint:function(s,c){var p=this.projection.project(s),b=this.scale(c);return this.transformation._transform(p,b)},pointToLatLng:function(s,c){var p=this.scale(c),b=this.transformation.untransform(s,p);return this.projection.unproject(b)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var c=this.projection.bounds,p=this.scale(s),b=this.transformation.transform(c.min,p),P=this.transformation.transform(c.max,p);return new pe(b,P)},infinite:!1,wrapLatLng:function(s){var c=this.wrapLng?f(s.lng,this.wrapLng,!0):s.lng,p=this.wrapLat?f(s.lat,this.wrapLat,!0):s.lat,b=s.alt;return new Ge(p,c,b)},wrapLatLngBounds:function(s){var c=s.getCenter(),p=this.wrapLatLng(c),b=c.lat-p.lat,P=c.lng-p.lng;if(b===0&&P===0)return s;var q=s.getSouthWest(),ae=s.getNorthEast(),Le=new Ge(q.lat-b,q.lng-P),Pe=new Ge(ae.lat-b,ae.lng-P);return new Ze(Le,Pe)}},ye=n({},Q,{wrapLng:[-180,180],R:6371e3,distance:function(s,c){var p=Math.PI/180,b=s.lat*p,P=c.lat*p,q=Math.sin((c.lat-s.lat)*p/2),ae=Math.sin((c.lng-s.lng)*p/2),Le=q*q+Math.cos(b)*Math.cos(P)*ae*ae,Pe=2*Math.atan2(Math.sqrt(Le),Math.sqrt(1-Le));return this.R*Pe}}),Ce=6378137,me={R:Ce,MAX_LATITUDE:85.0511287798,project:function(s){var c=Math.PI/180,p=this.MAX_LATITUDE,b=Math.max(Math.min(p,s.lat),-p),P=Math.sin(b*c);return new O(this.R*s.lng*c,this.R*Math.log((1+P)/(1-P))/2)},unproject:function(s){var c=180/Math.PI;return new Ge((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*c,s.x*c/this.R)},bounds:(function(){var s=Ce*Math.PI;return new pe([-s,-s],[s,s])})()};function ie(s,c,p,b){if(_(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=c,this._c=p,this._d=b}ie.prototype={transform:function(s,c){return this._transform(s.clone(),c)},_transform:function(s,c){return c=c||1,s.x=c*(this._a*s.x+this._b),s.y=c*(this._c*s.y+this._d),s},untransform:function(s,c){return c=c||1,new O((s.x/c-this._b)/this._a,(s.y/c-this._d)/this._c)}};function z(s,c,p,b){return new ie(s,c,p,b)}var K=n({},ye,{code:"EPSG:3857",projection:me,transformation:(function(){var s=.5/(Math.PI*me.R);return z(s,.5,-s,.5)})()}),se=n({},K,{code:"EPSG:900913"});function Ee(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function Be(s,c){var p="",b,P,q,ae,Le,Pe;for(b=0,q=s.length;b<q;b++){for(Le=s[b],P=0,ae=Le.length;P<ae;P++)Pe=Le[P],p+=(P?"L":"M")+Pe.x+" "+Pe.y;p+=c?qe.svg?"z":"x":""}return p||"M0 0"}var Re=document.documentElement.style,Se="ActiveXObject"in window,X=Se&&!document.addEventListener,he="msLaunchUri"in navigator&&!("documentMode"in document),Te=st("webkit"),xe=st("android"),be=st("android 2")||st("android 3"),de=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),fe=xe&&st("Google")&&de<537&&!("AudioNode"in window),W=!!window.opera,J=!he&&st("chrome"),re=st("gecko")&&!Te&&!W&&!Se,je=!J&&st("safari"),et=st("phantom"),dt="OTransition"in Re,kt=navigator.platform.indexOf("Win")===0,gt=Se&&"transition"in Re,St="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!be,Lt="MozPerspective"in Re,Dt=!window.L_DISABLE_3D&&(gt||St||Lt)&&!dt&&!et,Vt=typeof orientation<"u"||st("mobile"),ht=Vt&&Te,Gt=Vt&&St,pn=!window.PointerEvent&&window.MSPointerEvent,Et=!!(window.PointerEvent||pn),_t="ontouchstart"in window||!!window.TouchEvent,Vn=!window.L_NO_TOUCH&&(_t||Et),kn=Vt&&W,Qn=Vt&&re,co=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Wt=(function(){var s=!1;try{var c=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",m,c),window.removeEventListener("testPassiveEventSupport",m,c)}catch{}return s})(),ns=(function(){return!!document.createElement("canvas").getContext})(),Sn=!!(document.createElementNS&&Ee("svg").createSVGRect),bo=!!Sn&&(function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),ce=!Sn&&(function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var c=s.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}})(),ue=navigator.platform.indexOf("Mac")===0,ke=navigator.platform.indexOf("Linux")===0;function st(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var qe={ie:Se,ielt9:X,edge:he,webkit:Te,android:xe,android23:be,androidStock:fe,opera:W,chrome:J,gecko:re,safari:je,phantom:et,opera12:dt,win:kt,ie3d:gt,webkit3d:St,gecko3d:Lt,any3d:Dt,mobile:Vt,mobileWebkit:ht,mobileWebkit3d:Gt,msPointer:pn,pointer:Et,touch:Vn,touchNative:_t,mobileOpera:kn,mobileGecko:Qn,retina:co,passiveEvents:Wt,canvas:ns,svg:Sn,vml:ce,inlineSvg:bo,mac:ue,linux:ke},Tt=qe.msPointer?"MSPointerDown":"pointerdown",Kt=qe.msPointer?"MSPointerMove":"pointermove",en=qe.msPointer?"MSPointerUp":"pointerup",Eo=qe.msPointer?"MSPointerCancel":"pointercancel",Gn={touchstart:Tt,touchmove:Kt,touchend:en,touchcancel:Eo},ks={touchstart:wo,touchmove:vn,touchend:vn,touchcancel:vn},_o={},Ba=!1;function bs(s,c,p){return c==="touchstart"&&Fa(),ks[c]?(p=ks[c].bind(this,p),s.addEventListener(Gn[c],p,!1),p):(console.warn("wrong event specified:",c),m)}function Po(s,c,p){if(!Gn[c]){console.warn("wrong event specified:",c);return}s.removeEventListener(Gn[c],p,!1)}function Ys(s){_o[s.pointerId]=s}function Na(s){_o[s.pointerId]&&(_o[s.pointerId]=s)}function In(s){delete _o[s.pointerId]}function Fa(){Ba||(document.addEventListener(Tt,Ys,!0),document.addEventListener(Kt,Na,!0),document.addEventListener(en,In,!0),document.addEventListener(Eo,In,!0),Ba=!0)}function vn(s,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var p in _o)c.touches.push(_o[p]);c.changedTouches=[c],s(c)}}function wo(s,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&tn(c),vn(s,c)}function Do(s){var c={},p,b;for(b in s)p=s[b],c[b]=p&&p.bind?p.bind(s):p;return s=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var Ua=200;function Ro(s,c){s.addEventListener("dblclick",c);var p=0,b;function P(q){if(q.detail!==1){b=q.detail;return}if(!(q.pointerType==="mouse"||q.sourceCapabilities&&!q.sourceCapabilities.firesTouchEvents)){var ae=Ga(q);if(!(ae.some(function(Pe){return Pe instanceof HTMLLabelElement&&Pe.attributes.for})&&!ae.some(function(Pe){return Pe instanceof HTMLInputElement||Pe instanceof HTMLSelectElement}))){var Le=Date.now();Le-p<=Ua?(b++,b===2&&c(Do(q))):b=1,p=Le}}}return s.addEventListener("click",P),{dblclick:c,simDblclick:P}}function Xs(s,c){s.removeEventListener("dblclick",c.dblclick),s.removeEventListener("click",c.simDblclick)}var eo=Cs(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Co=Cs(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),xn=Co==="webkitTransition"||Co==="OTransition"?Co+"End":"transitionend";function uo(s){return typeof s=="string"?document.getElementById(s):s}function to(s,c){var p=s.style[c]||s.currentStyle&&s.currentStyle[c];if((!p||p==="auto")&&document.defaultView){var b=document.defaultView.getComputedStyle(s,null);p=b?b[c]:null}return p==="auto"?null:p}function mt(s,c,p){var b=document.createElement(s);return b.className=c||"",p&&p.appendChild(b),b}function It(s){var c=s.parentNode;c&&c.removeChild(s)}function ho(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function fo(s){var c=s.parentNode;c&&c.lastChild!==s&&c.appendChild(s)}function qn(s){var c=s.parentNode;c&&c.firstChild!==s&&c.insertBefore(s,c.firstChild)}function _s(s,c){if(s.classList!==void 0)return s.classList.contains(c);var p=ws(s);return p.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(p)}function pt(s,c){if(s.classList!==void 0)for(var p=w(c),b=0,P=p.length;b<P;b++)s.classList.add(p[b]);else if(!_s(s,c)){var q=ws(s);Qs(s,(q?q+" ":"")+c)}}function qt(s,c){s.classList!==void 0?s.classList.remove(c):Qs(s,k((" "+ws(s)+" ").replace(" "+c+" "," ")))}function Qs(s,c){s.className.baseVal===void 0?s.className=c:s.className.baseVal=c}function ws(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function An(s,c){"opacity"in s.style?s.style.opacity=c:"filter"in s.style&&pl(s,c)}function pl(s,c){var p=!1,b="DXImageTransform.Microsoft.Alpha";try{p=s.filters.item(b)}catch{if(c===1)return}c=Math.round(c*100),p?(p.Enabled=c!==100,p.Opacity=c):s.style.filter+=" progid:"+b+"(opacity="+c+")"}function Cs(s){for(var c=document.documentElement.style,p=0;p<s.length;p++)if(s[p]in c)return s[p];return!1}function Oo(s,c,p){var b=c||new O(0,0);s.style[eo]=(qe.ie3d?"translate("+b.x+"px,"+b.y+"px)":"translate3d("+b.x+"px,"+b.y+"px,0)")+(p?" scale("+p+")":"")}function jt(s,c){s._leaflet_pos=c,qe.any3d?Oo(s,c):(s.style.left=c.x+"px",s.style.top=c.y+"px")}function Lo(s){return s._leaflet_pos||new O(0,0)}var Bo,os,za;if("onselectstart"in document)Bo=function(){it(window,"selectstart",tn)},os=function(){xt(window,"selectstart",tn)};else{var Ls=Cs(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Bo=function(){if(Ls){var s=document.documentElement.style;za=s[Ls],s[Ls]="none"}},os=function(){Ls&&(document.documentElement.style[Ls]=za,za=void 0)}}function Ha(){it(window,"dragstart",tn)}function Jt(){xt(window,"dragstart",tn)}var No,Ss;function jn(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(ea(),No=s,Ss=s.style.outlineStyle,s.style.outlineStyle="none",it(window,"keydown",ea))}function ea(){No&&(No.style.outlineStyle=Ss,No=void 0,Ss=void 0,xt(window,"keydown",ea))}function ta(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function En(s){var c=s.getBoundingClientRect();return{x:c.width/s.offsetWidth||1,y:c.height/s.offsetHeight||1,boundingClientRect:c}}var na={__proto__:null,TRANSFORM:eo,TRANSITION:Co,TRANSITION_END:xn,get:uo,getStyle:to,create:mt,remove:It,empty:ho,toFront:fo,toBack:qn,hasClass:_s,addClass:pt,removeClass:qt,setClass:Qs,getClass:ws,setOpacity:An,testProp:Cs,setTransform:Oo,setPosition:jt,getPosition:Lo,get disableTextSelection(){return Bo},get enableTextSelection(){return os},disableImageDrag:Ha,enableImageDrag:Jt,preventOutline:jn,restoreOutline:ea,getSizedParentNode:ta,getScale:En};function it(s,c,p,b){if(c&&typeof c=="object")for(var P in c)oa(s,P,c[P],p);else{c=w(c);for(var q=0,ae=c.length;q<ae;q++)oa(s,c[q],p,b)}return this}var Yt="_leaflet_events";function xt(s,c,p,b){if(arguments.length===1)ss(s),delete s[Yt];else if(c&&typeof c=="object")for(var P in c)sa(s,P,c[P],p);else if(c=w(c),arguments.length===2)ss(s,function(Le){return $(c,Le)!==-1});else for(var q=0,ae=c.length;q<ae;q++)sa(s,c[q],p,b);return this}function ss(s,c){for(var p in s[Yt]){var b=p.split(/\d/)[0];(!c||c(b))&&sa(s,b,null,null,p)}}var mn={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function oa(s,c,p,b){var P=c+d(p)+(b?"_"+d(b):"");if(s[Yt]&&s[Yt][P])return this;var q=function(Le){return p.call(b||s,Le||window.event)},ae=q;!qe.touchNative&&qe.pointer&&c.indexOf("touch")===0?q=bs(s,c,q):qe.touch&&c==="dblclick"?q=Ro(s,q):"addEventListener"in s?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?s.addEventListener(mn[c]||c,q,qe.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(q=function(Le){Le=Le||window.event,Uo(s,Le)&&ae(Le)},s.addEventListener(mn[c],q,!1)):s.addEventListener(c,ae,!1):s.attachEvent("on"+c,q),s[Yt]=s[Yt]||{},s[Yt][P]=q}function sa(s,c,p,b,P){P=P||c+d(p)+(b?"_"+d(b):"");var q=s[Yt]&&s[Yt][P];if(!q)return this;!qe.touchNative&&qe.pointer&&c.indexOf("touch")===0?Po(s,c,q):qe.touch&&c==="dblclick"?Xs(s,q):"removeEventListener"in s?s.removeEventListener(mn[c]||c,q,!1):s.detachEvent("on"+c,q),s[Yt][P]=null}function So(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function Va(s){return oa(s,"wheel",So),this}function as(s){return it(s,"mousedown touchstart dblclick contextmenu",So),s._leaflet_disable_click=!0,this}function tn(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function Fo(s){return tn(s),So(s),this}function Ga(s){if(s.composedPath)return s.composedPath();for(var c=[],p=s.target;p;)c.push(p),p=p.parentNode;return c}function is(s,c){if(!c)return new O(s.clientX,s.clientY);var p=En(c),b=p.boundingClientRect;return new O((s.clientX-b.left)/p.x-c.clientLeft,(s.clientY-b.top)/p.y-c.clientTop)}var vl=qe.linux&&qe.chrome?window.devicePixelRatio:qe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Si(s){return qe.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/vl:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function Uo(s,c){var p=c.relatedTarget;if(!p)return!0;try{for(;p&&p!==s;)p=p.parentNode}catch{return!1}return p!==s}var qa={__proto__:null,on:it,off:xt,stopPropagation:So,disableScrollPropagation:Va,disableClickPropagation:as,preventDefault:tn,stop:Fo,getPropagationPath:Ga,getMousePosition:is,getWheelDelta:Si,isExternalTarget:Uo,addListener:it,removeListener:xt},Ii=te.extend({run:function(s,c,p,b){this.stop(),this._el=s,this._inProgress=!0,this._duration=p||.25,this._easeOutPower=1/Math.max(b||.5,.2),this._startPos=Lo(s),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=F(this._animate,this),this._step()},_step:function(s){var c=+new Date-this._startTime,p=this._duration*1e3;c<p?this._runFrame(this._easeOut(c/p),s):(this._runFrame(1),this._complete())},_runFrame:function(s,c){var p=this._startPos.add(this._offset.multiplyBy(s));c&&p._round(),jt(this._el,p),this.fire("step")},_complete:function(){j(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),wt=te.extend({options:{crs:K,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,c){c=S(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(Xe(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Co&&qe.any3d&&!qe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),it(this._proxy,xn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,c,p){if(c=c===void 0?this._zoom:this._limitZoom(c),s=this._limitCenter(Xe(s),c,this.options.maxBounds),p=p||{},this._stop(),this._loaded&&!p.reset&&p!==!0){p.animate!==void 0&&(p.zoom=n({animate:p.animate},p.zoom),p.pan=n({animate:p.animate,duration:p.duration},p.pan));var b=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,c,p.zoom):this._tryAnimatedPan(s,p.pan);if(b)return clearTimeout(this._sizeTimer),this}return this._resetView(s,c,p.pan&&p.pan.noMoveStart),this},setZoom:function(s,c){return this._loaded?this.setView(this.getCenter(),s,{zoom:c}):(this._zoom=s,this)},zoomIn:function(s,c){return s=s||(qe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,c)},zoomOut:function(s,c){return s=s||(qe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,c)},setZoomAround:function(s,c,p){var b=this.getZoomScale(c),P=this.getSize().divideBy(2),q=s instanceof O?s:this.latLngToContainerPoint(s),ae=q.subtract(P).multiplyBy(1-1/b),Le=this.containerPointToLatLng(P.add(ae));return this.setView(Le,c,{zoom:p})},_getBoundsCenterZoom:function(s,c){c=c||{},s=s.getBounds?s.getBounds():Ne(s);var p=ne(c.paddingTopLeft||c.padding||[0,0]),b=ne(c.paddingBottomRight||c.padding||[0,0]),P=this.getBoundsZoom(s,!1,p.add(b));if(P=typeof c.maxZoom=="number"?Math.min(c.maxZoom,P):P,P===1/0)return{center:s.getCenter(),zoom:P};var q=b.subtract(p).divideBy(2),ae=this.project(s.getSouthWest(),P),Le=this.project(s.getNorthEast(),P),Pe=this.unproject(ae.add(Le).divideBy(2).add(q),P);return{center:Pe,zoom:P}},fitBounds:function(s,c){if(s=Ne(s),!s.isValid())throw new Error("Bounds are not valid.");var p=this._getBoundsCenterZoom(s,c);return this.setView(p.center,p.zoom,c)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,c){return this.setView(s,this._zoom,{pan:c})},panBy:function(s,c){if(s=ne(s).round(),c=c||{},!s.x&&!s.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ii,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){pt(this._mapPane,"leaflet-pan-anim");var p=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,p,c.duration||.25,c.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,c,p){if(p=p||{},p.animate===!1||!qe.any3d)return this.setView(s,c,p);this._stop();var b=this.project(this.getCenter()),P=this.project(s),q=this.getSize(),ae=this._zoom;s=Xe(s),c=c===void 0?ae:c;var Le=Math.max(q.x,q.y),Pe=Le*this.getZoomScale(ae,c),Ve=P.distanceTo(b)||1,ot=1.42,ut=ot*ot;function Ct(dn){var wr=dn?-1:1,Og=dn?Pe:Le,Bg=Pe*Pe-Le*Le+wr*ut*ut*Ve*Ve,Ng=2*Og*ut*Ve,zc=Bg/Ng,dh=Math.sqrt(zc*zc+1)-zc,Fg=dh<1e-9?-18:Math.log(dh);return Fg}function Zn(dn){return(Math.exp(dn)-Math.exp(-dn))/2}function wn(dn){return(Math.exp(dn)+Math.exp(-dn))/2}function xo(dn){return Zn(dn)/wn(dn)}var so=Ct(0);function Vi(dn){return Le*(wn(so)/wn(so+ot*dn))}function Eg(dn){return Le*(wn(so)*xo(so+ot*dn)-Zn(so))/ut}function Pg(dn){return 1-Math.pow(1-dn,1.5)}var Dg=Date.now(),ch=(Ct(1)-so)/ot,Rg=p.duration?1e3*p.duration:1e3*ch*.8;function uh(){var dn=(Date.now()-Dg)/Rg,wr=Pg(dn)*ch;dn<=1?(this._flyToFrame=F(uh,this),this._move(this.unproject(b.add(P.subtract(b).multiplyBy(Eg(wr)/Ve)),ae),this.getScaleZoom(Le/Vi(wr),ae),{flyTo:!0})):this._move(s,c)._moveEnd(!0)}return this._moveStart(!0,p.noMoveStart),uh.call(this),this},flyToBounds:function(s,c){var p=this._getBoundsCenterZoom(s,c);return this.flyTo(p.center,p.zoom,c)},setMaxBounds:function(s){return s=Ne(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var c=this.options.minZoom;return this.options.minZoom=s,this._loaded&&c!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var c=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&c!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,c){this._enforcingBounds=!0;var p=this.getCenter(),b=this._limitCenter(p,this._zoom,Ne(s));return p.equals(b)||this.panTo(b,c),this._enforcingBounds=!1,this},panInside:function(s,c){c=c||{};var p=ne(c.paddingTopLeft||c.padding||[0,0]),b=ne(c.paddingBottomRight||c.padding||[0,0]),P=this.project(this.getCenter()),q=this.project(s),ae=this.getPixelBounds(),Le=we([ae.min.add(p),ae.max.subtract(b)]),Pe=Le.getSize();if(!Le.contains(q)){this._enforcingBounds=!0;var Ve=q.subtract(Le.getCenter()),ot=Le.extend(q).getSize().subtract(Pe);P.x+=Ve.x<0?-ot.x:ot.x,P.y+=Ve.y<0?-ot.y:ot.y,this.panTo(this.unproject(P),c),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=n({animate:!1,pan:!0},s===!0?{animate:!0}:s);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var p=this.getSize(),b=c.divideBy(2).round(),P=p.divideBy(2).round(),q=b.subtract(P);return!q.x&&!q.y?this:(s.animate&&s.pan?this.panBy(q):(s.pan&&this._rawPanBy(q),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:p}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=n({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=l(this._handleGeolocationResponse,this),p=l(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,p,s):navigator.geolocation.getCurrentPosition(c,p,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var c=s.code,p=s.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+p+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var c=s.coords.latitude,p=s.coords.longitude,b=new Ge(c,p),P=b.toBounds(s.coords.accuracy*2),q=this._locateOptions;if(q.setView){var ae=this.getBoundsZoom(P);this.setView(b,q.maxZoom?Math.min(ae,q.maxZoom):ae)}var Le={latlng:b,bounds:P,timestamp:s.timestamp};for(var Pe in s.coords)typeof s.coords[Pe]=="number"&&(Le[Pe]=s.coords[Pe]);this.fire("locationfound",Le)}},addHandler:function(s,c){if(!c)return this;var p=this[s]=new c(this);return this._handlers.push(p),this.options[s]&&p.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),It(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(j(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)It(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,c){var p="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),b=mt("div",p,c||this._mapPane);return s&&(this._panes[s]=b),b},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),c=this.unproject(s.getBottomLeft()),p=this.unproject(s.getTopRight());return new Ze(c,p)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,c,p){s=Ne(s),p=ne(p||[0,0]);var b=this.getZoom()||0,P=this.getMinZoom(),q=this.getMaxZoom(),ae=s.getNorthWest(),Le=s.getSouthEast(),Pe=this.getSize().subtract(p),Ve=we(this.project(Le,b),this.project(ae,b)).getSize(),ot=qe.any3d?this.options.zoomSnap:1,ut=Pe.x/Ve.x,Ct=Pe.y/Ve.y,Zn=c?Math.max(ut,Ct):Math.min(ut,Ct);return b=this.getScaleZoom(Zn,b),ot&&(b=Math.round(b/(ot/100))*(ot/100),b=c?Math.ceil(b/ot)*ot:Math.floor(b/ot)*ot),Math.max(P,Math.min(q,b))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new O(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,c){var p=this._getTopLeftPoint(s,c);return new pe(p,p.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,c){var p=this.options.crs;return c=c===void 0?this._zoom:c,p.scale(s)/p.scale(c)},getScaleZoom:function(s,c){var p=this.options.crs;c=c===void 0?this._zoom:c;var b=p.zoom(s*p.scale(c));return isNaN(b)?1/0:b},project:function(s,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(Xe(s),c)},unproject:function(s,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(ne(s),c)},layerPointToLatLng:function(s){var c=ne(s).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(s){var c=this.project(Xe(s))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(Xe(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(Ne(s))},distance:function(s,c){return this.options.crs.distance(Xe(s),Xe(c))},containerPointToLayerPoint:function(s){return ne(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return ne(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var c=this.containerPointToLayerPoint(ne(s));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Xe(s)))},mouseEventToContainerPoint:function(s){return is(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var c=this._container=uo(s);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");it(c,"scroll",this._onScroll,this),this._containerId=d(c)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&qe.any3d,pt(s,"leaflet-container"+(qe.touch?" leaflet-touch":"")+(qe.retina?" leaflet-retina":"")+(qe.ielt9?" leaflet-oldie":"")+(qe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=to(s,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),jt(this._mapPane,new O(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(pt(s.markerPane,"leaflet-zoom-hide"),pt(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,c,p){jt(this._mapPane,new O(0,0));var b=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var P=this._zoom!==c;this._moveStart(P,p)._move(s,c)._moveEnd(P),this.fire("viewreset"),b&&this.fire("load")},_moveStart:function(s,c){return s&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(s,c,p,b){c===void 0&&(c=this._zoom);var P=this._zoom!==c;return this._zoom=c,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),b?p&&p.pinch&&this.fire("zoom",p):((P||p&&p.pinch)&&this.fire("zoom",p),this.fire("move",p)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return j(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){jt(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[d(this._container)]=this;var c=s?xt:it;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),qe.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){j(this._resizeRequest),this._resizeRequest=F(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,c){for(var p=[],b,P=c==="mouseout"||c==="mouseover",q=s.target||s.srcElement,ae=!1;q;){if(b=this._targets[d(q)],b&&(c==="click"||c==="preclick")&&this._draggableMoved(b)){ae=!0;break}if(b&&b.listens(c,!0)&&(P&&!Uo(q,s)||(p.push(b),P))||q===this._container)break;q=q.parentNode}return!p.length&&!ae&&!P&&this.listens(c,!0)&&(p=[this]),p},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var c=s.target||s.srcElement;if(!(!this._loaded||c._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(c))){var p=s.type;p==="mousedown"&&jn(c),this._fireDOMEvent(s,p)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,c,p){if(s.type==="click"){var b=n({},s);b.type="preclick",this._fireDOMEvent(b,b.type,p)}var P=this._findEventTargets(s,c);if(p){for(var q=[],ae=0;ae<p.length;ae++)p[ae].listens(c,!0)&&q.push(p[ae]);P=q.concat(P)}if(P.length){c==="contextmenu"&&tn(s);var Le=P[0],Pe={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var Ve=Le.getLatLng&&(!Le._radius||Le._radius<=10);Pe.containerPoint=Ve?this.latLngToContainerPoint(Le.getLatLng()):this.mouseEventToContainerPoint(s),Pe.layerPoint=this.containerPointToLayerPoint(Pe.containerPoint),Pe.latlng=Ve?Le.getLatLng():this.layerPointToLatLng(Pe.layerPoint)}for(ae=0;ae<P.length;ae++)if(P[ae].fire(c,Pe,!0),Pe.originalEvent._stopped||P[ae].options.bubblingMouseEvents===!1&&$(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,c=this._handlers.length;s<c;s++)this._handlers[s].disable()},whenReady:function(s,c){return this._loaded?s.call(c||this,{target:this}):this.on("load",s,c),this},_getMapPanePos:function(){return Lo(this._mapPane)||new O(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,c){var p=s&&c!==void 0?this._getNewPixelOrigin(s,c):this.getPixelOrigin();return p.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,c){var p=this.getSize()._divideBy(2);return this.project(s,c)._subtract(p)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,c,p){var b=this._getNewPixelOrigin(p,c);return this.project(s,c)._subtract(b)},_latLngBoundsToNewLayerBounds:function(s,c,p){var b=this._getNewPixelOrigin(p,c);return we([this.project(s.getSouthWest(),c)._subtract(b),this.project(s.getNorthWest(),c)._subtract(b),this.project(s.getSouthEast(),c)._subtract(b),this.project(s.getNorthEast(),c)._subtract(b)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,c,p){if(!p)return s;var b=this.project(s,c),P=this.getSize().divideBy(2),q=new pe(b.subtract(P),b.add(P)),ae=this._getBoundsOffset(q,p,c);return Math.abs(ae.x)<=1&&Math.abs(ae.y)<=1?s:this.unproject(b.add(ae),c)},_limitOffset:function(s,c){if(!c)return s;var p=this.getPixelBounds(),b=new pe(p.min.add(s),p.max.add(s));return s.add(this._getBoundsOffset(b,c))},_getBoundsOffset:function(s,c,p){var b=we(this.project(c.getNorthEast(),p),this.project(c.getSouthWest(),p)),P=b.min.subtract(s.min),q=b.max.subtract(s.max),ae=this._rebound(P.x,-q.x),Le=this._rebound(P.y,-q.y);return new O(ae,Le)},_rebound:function(s,c){return s+c>0?Math.round(s-c)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(c))},_limitZoom:function(s){var c=this.getMinZoom(),p=this.getMaxZoom(),b=qe.any3d?this.options.zoomSnap:1;return b&&(s=Math.round(s/b)*b),Math.max(c,Math.min(p,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){qt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,c){var p=this._getCenterOffset(s)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(p)?!1:(this.panBy(p,c),!0)},_createAnimProxy:function(){var s=this._proxy=mt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(c){var p=eo,b=this._proxy.style[p];Oo(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),b===this._proxy.style[p]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){It(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),c=this.getZoom();Oo(this._proxy,this.project(s,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,c,p){if(this._animatingZoom)return!0;if(p=p||{},!this._zoomAnimated||p.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var b=this.getZoomScale(c),P=this._getCenterOffset(s)._divideBy(1-1/b);return p.animate!==!0&&!this.getSize().contains(P)?!1:(F(function(){this._moveStart(!0,p.noMoveStart||!1)._animateZoom(s,c,!0)},this),!0)},_animateZoom:function(s,c,p,b){this._mapPane&&(p&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=c,pt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:c,noUpdate:b}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&qt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Is(s,c){return new wt(s,c)}var gn=oe.extend({options:{position:"topright"},initialize:function(s){S(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var c=this._map;return c&&c.removeControl(this),this.options.position=s,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var c=this._container=this.onAdd(s),p=this.getPosition(),b=s._controlCorners[p];return pt(c,"leaflet-control"),p.indexOf("bottom")!==-1?b.insertBefore(c,b.firstChild):b.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(It(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),no=function(s){return new gn(s)};wt.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},c="leaflet-",p=this._controlContainer=mt("div",c+"control-container",this._container);function b(P,q){var ae=c+P+" "+c+q;s[P+q]=mt("div",ae,p)}b("top","left"),b("top","right"),b("bottom","left"),b("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)It(this._controlCorners[s]);It(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var aa=gn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,c,p,b){return p<b?-1:b<p?1:0}},initialize:function(s,c,p){S(this,p),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var b in s)this._addLayer(s[b],b);for(b in c)this._addLayer(c[b],b,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return gn.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,c){return this._addLayer(s,c),this._map?this._update():this},addOverlay:function(s,c){return this._addLayer(s,c,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var c=this._getLayer(d(s));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){pt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(pt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):qt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return qt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",c=this._container=mt("div",s),p=this.options.collapsed;c.setAttribute("aria-haspopup",!0),as(c),Va(c);var b=this._section=mt("section",s+"-list");p&&(this._map.on("click",this.collapse,this),it(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var P=this._layersLink=mt("a",s+"-toggle",c);P.href="#",P.title="Layers",P.setAttribute("role","button"),it(P,{keydown:function(q){q.keyCode===13&&this._expandSafely()},click:function(q){tn(q),this._expandSafely()}},this),p||this.expand(),this._baseLayersList=mt("div",s+"-base",b),this._separator=mt("div",s+"-separator",b),this._overlaysList=mt("div",s+"-overlays",b),c.appendChild(b)},_getLayer:function(s){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&d(this._layers[c].layer)===s)return this._layers[c]},_addLayer:function(s,c,p){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:c,overlay:p}),this.options.sortLayers&&this._layers.sort(l(function(b,P){return this.options.sortFunction(b.layer,P.layer,b.name,P.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ho(this._baseLayersList),ho(this._overlaysList),this._layerControlInputs=[];var s,c,p,b,P=0;for(p=0;p<this._layers.length;p++)b=this._layers[p],this._addItem(b),c=c||b.overlay,s=s||!b.overlay,P+=b.overlay?0:1;return this.options.hideSingleBase&&(s=s&&P>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=c&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var c=this._getLayer(d(s.target)),p=c.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;p&&this._map.fire(p,c)},_createRadioElement:function(s,c){var p='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(c?' checked="checked"':"")+"/>",b=document.createElement("div");return b.innerHTML=p,b.firstChild},_addItem:function(s){var c=document.createElement("label"),p=this._map.hasLayer(s.layer),b;s.overlay?(b=document.createElement("input"),b.type="checkbox",b.className="leaflet-control-layers-selector",b.defaultChecked=p):b=this._createRadioElement("leaflet-base-layers_"+d(this),p),this._layerControlInputs.push(b),b.layerId=d(s.layer),it(b,"click",this._onInputClick,this);var P=document.createElement("span");P.innerHTML=" "+s.name;var q=document.createElement("span");c.appendChild(q),q.appendChild(b),q.appendChild(P);var ae=s.overlay?this._overlaysList:this._baseLayersList;return ae.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,c,p,b=[],P=[];this._handlingClick=!0;for(var q=s.length-1;q>=0;q--)c=s[q],p=this._getLayer(c.layerId).layer,c.checked?b.push(p):c.checked||P.push(p);for(q=0;q<P.length;q++)this._map.hasLayer(P[q])&&this._map.removeLayer(P[q]);for(q=0;q<b.length;q++)this._map.hasLayer(b[q])||this._map.addLayer(b[q]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,c,p,b=this._map.getZoom(),P=s.length-1;P>=0;P--)c=s[P],p=this._getLayer(c.layerId).layer,c.disabled=p.options.minZoom!==void 0&&b<p.options.minZoom||p.options.maxZoom!==void 0&&b>p.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,it(s,"click",tn),this.expand();var c=this;setTimeout(function(){xt(s,"click",tn),c._preventClick=!1})}}),xi=function(s,c,p){return new aa(s,c,p)},ia=gn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var c="leaflet-control-zoom",p=mt("div",c+" leaflet-bar"),b=this.options;return this._zoomInButton=this._createButton(b.zoomInText,b.zoomInTitle,c+"-in",p,this._zoomIn),this._zoomOutButton=this._createButton(b.zoomOutText,b.zoomOutTitle,c+"-out",p,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),p},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,c,p,b,P){var q=mt("a",p,b);return q.innerHTML=s,q.href="#",q.title=c,q.setAttribute("role","button"),q.setAttribute("aria-label",c),as(q),it(q,"click",Fo),it(q,"click",P,this),it(q,"click",this._refocusOnMap,this),q},_updateDisabled:function(){var s=this._map,c="leaflet-disabled";qt(this._zoomInButton,c),qt(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(pt(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(pt(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});wt.mergeOptions({zoomControl:!0}),wt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new ia,this.addControl(this.zoomControl))});var la=function(s){return new ia(s)},$i=gn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var c="leaflet-control-scale",p=mt("div",c),b=this.options;return this._addScales(b,c+"-line",p),s.on(b.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),p},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,c,p){s.metric&&(this._mScale=mt("div",c,p)),s.imperial&&(this._iScale=mt("div",c,p))},_update:function(){var s=this._map,c=s.getSize().y/2,p=s.distance(s.containerPointToLatLng([0,c]),s.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(p)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var c=this._getRoundNum(s),p=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,p,c/s)},_updateImperial:function(s){var c=s*3.2808399,p,b,P;c>5280?(p=c/5280,b=this._getRoundNum(p),this._updateScale(this._iScale,b+" mi",b/p)):(P=this._getRoundNum(c),this._updateScale(this._iScale,P+" ft",P/c))},_updateScale:function(s,c,p){s.style.width=Math.round(this.options.maxWidth*p)+"px",s.innerHTML=c},_getRoundNum:function(s){var c=Math.pow(10,(Math.floor(s)+"").length-1),p=s/c;return p=p>=10?10:p>=5?5:p>=3?3:p>=2?2:1,c*p}}),ml=function(s){return new $i(s)},Ti='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',ja=gn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(qe.inlineSvg?Ti+" ":"")+"Leaflet</a>"},initialize:function(s){S(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=mt("div","leaflet-control-attribution"),as(this._container);for(var c in s._layers)s._layers[c].getAttribution&&this.addAttribution(s._layers[c].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var c in this._attributions)this._attributions[c]&&s.push(c);var p=[];this.options.prefix&&p.push(this.options.prefix),s.length&&p.push(s.join(", ")),this._container.innerHTML=p.join(' <span aria-hidden="true">|</span> ')}}});wt.mergeOptions({attributionControl:!0}),wt.addInitHook(function(){this.options.attributionControl&&new ja().addTo(this)});var gl=function(s){return new ja(s)};gn.Layers=aa,gn.Zoom=ia,gn.Scale=$i,gn.Attribution=ja,no.layers=xi,no.zoom=la,no.scale=ml,no.attribution=gl;var oo=oe.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});oo.addTo=function(s,c){return s.addHandler(c,this),this};var ra={Events:ee},Za=qe.touch?"touchstart mousedown":"mousedown",Io=te.extend({options:{clickTolerance:3},initialize:function(s,c,p,b){S(this,b),this._element=s,this._dragStartTarget=c||s,this._preventOutline=p},enable:function(){this._enabled||(it(this._dragStartTarget,Za,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Io._dragging===this&&this.finishDrag(!0),xt(this._dragStartTarget,Za,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!_s(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){Io._dragging===this&&this.finishDrag();return}if(!(Io._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(Io._dragging=this,this._preventOutline&&jn(this._element),Ha(),Bo(),!this._moving)){this.fire("down");var c=s.touches?s.touches[0]:s,p=ta(this._element);this._startPoint=new O(c.clientX,c.clientY),this._startPos=Lo(this._element),this._parentScale=En(p);var b=s.type==="mousedown";it(document,b?"mousemove":"touchmove",this._onMove,this),it(document,b?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var c=s.touches&&s.touches.length===1?s.touches[0]:s,p=new O(c.clientX,c.clientY)._subtract(this._startPoint);!p.x&&!p.y||Math.abs(p.x)+Math.abs(p.y)<this.options.clickTolerance||(p.x/=this._parentScale.x,p.y/=this._parentScale.y,tn(s),this._moved||(this.fire("dragstart"),this._moved=!0,pt(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),pt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(p),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),jt(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){qt(document.body,"leaflet-dragging"),this._lastTarget&&(qt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),xt(document,"mousemove touchmove",this._onMove,this),xt(document,"mouseup touchend touchcancel",this._onUp,this),Jt(),os();var c=this._moved&&this._moving;this._moving=!1,Io._dragging=!1,c&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function ca(s,c,p){var b,P=[1,4,2,8],q,ae,Le,Pe,Ve,ot,ut,Ct;for(q=0,ot=s.length;q<ot;q++)s[q]._code=Bt(s[q],c);for(Le=0;Le<4;Le++){for(ut=P[Le],b=[],q=0,ot=s.length,ae=ot-1;q<ot;ae=q++)Pe=s[q],Ve=s[ae],Pe._code&ut?Ve._code&ut||(Ct=ft(Ve,Pe,ut,c,p),Ct._code=Bt(Ct,c),b.push(Ct)):(Ve._code&ut&&(Ct=ft(Ve,Pe,ut,c,p),Ct._code=Bt(Ct,c),b.push(Ct)),b.push(Pe));s=b}return s}function Wa(s,c){var p,b,P,q,ae,Le,Pe,Ve,ot;if(!s||s.length===0)throw new Error("latlngs not passed");Qt(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var ut=Xe([0,0]),Ct=Ne(s),Zn=Ct.getNorthWest().distanceTo(Ct.getSouthWest())*Ct.getNorthEast().distanceTo(Ct.getNorthWest());Zn<1700&&(ut=Ka(s));var wn=s.length,xo=[];for(p=0;p<wn;p++){var so=Xe(s[p]);xo.push(c.project(Xe([so.lat-ut.lat,so.lng-ut.lng])))}for(Le=Pe=Ve=0,p=0,b=wn-1;p<wn;b=p++)P=xo[p],q=xo[b],ae=P.y*q.x-q.y*P.x,Pe+=(P.x+q.x)*ae,Ve+=(P.y+q.y)*ae,Le+=ae*3;Le===0?ot=xo[0]:ot=[Pe/Le,Ve/Le];var Vi=c.unproject(ne(ot));return Xe([Vi.lat+ut.lat,Vi.lng+ut.lng])}function Ka(s){for(var c=0,p=0,b=0,P=0;P<s.length;P++){var q=Xe(s[P]);c+=q.lat,p+=q.lng,b++}return Xe([c/b,p/b])}var Ja={__proto__:null,clipPolygon:ca,polygonCenter:Wa,centroid:Ka};function Mi(s,c){if(!c||!s.length)return s.slice();var p=c*c;return s=$e(s,p),s=Ei(s,p),s}function ua(s,c,p){return Math.sqrt(nn(s,c,p,!0))}function Ai(s,c,p){return nn(s,c,p)}function Ei(s,c){var p=s.length,b=typeof Uint8Array<"u"?Uint8Array:Array,P=new b(p);P[0]=P[p-1]=1,xs(s,P,c,0,p-1);var q,ae=[];for(q=0;q<p;q++)P[q]&&ae.push(s[q]);return ae}function xs(s,c,p,b,P){var q=0,ae,Le,Pe;for(Le=b+1;Le<=P-1;Le++)Pe=nn(s[Le],s[b],s[P],!0),Pe>q&&(ae=Le,q=Pe);q>p&&(c[ae]=1,xs(s,c,p,b,ae),xs(s,c,p,ae,P))}function $e(s,c){for(var p=[s[0]],b=1,P=0,q=s.length;b<q;b++)$t(s[b],s[P])>c&&(p.push(s[b]),P=b);return P<q-1&&p.push(s[q-1]),p}var Ie;function tt(s,c,p,b,P){var q=b?Ie:Bt(s,p),ae=Bt(c,p),Le,Pe,Ve;for(Ie=ae;;){if(!(q|ae))return[s,c];if(q&ae)return!1;Le=q||ae,Pe=ft(s,c,Le,p,P),Ve=Bt(Pe,p),Le===q?(s=Pe,q=Ve):(c=Pe,ae=Ve)}}function ft(s,c,p,b,P){var q=c.x-s.x,ae=c.y-s.y,Le=b.min,Pe=b.max,Ve,ot;return p&8?(Ve=s.x+q*(Pe.y-s.y)/ae,ot=Pe.y):p&4?(Ve=s.x+q*(Le.y-s.y)/ae,ot=Le.y):p&2?(Ve=Pe.x,ot=s.y+ae*(Pe.x-s.x)/q):p&1&&(Ve=Le.x,ot=s.y+ae*(Le.x-s.x)/q),new O(Ve,ot,P)}function Bt(s,c){var p=0;return s.x<c.min.x?p|=1:s.x>c.max.x&&(p|=2),s.y<c.min.y?p|=4:s.y>c.max.y&&(p|=8),p}function $t(s,c){var p=c.x-s.x,b=c.y-s.y;return p*p+b*b}function nn(s,c,p,b){var P=c.x,q=c.y,ae=p.x-P,Le=p.y-q,Pe=ae*ae+Le*Le,Ve;return Pe>0&&(Ve=((s.x-P)*ae+(s.y-q)*Le)/Pe,Ve>1?(P=p.x,q=p.y):Ve>0&&(P+=ae*Ve,q+=Le*Ve)),ae=s.x-P,Le=s.y-q,b?ae*ae+Le*Le:new O(P,q)}function Qt(s){return!_(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function Nt(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Qt(s)}function bn(s,c){var p,b,P,q,ae,Le,Pe,Ve;if(!s||s.length===0)throw new Error("latlngs not passed");Qt(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var ot=Xe([0,0]),ut=Ne(s),Ct=ut.getNorthWest().distanceTo(ut.getSouthWest())*ut.getNorthEast().distanceTo(ut.getNorthWest());Ct<1700&&(ot=Ka(s));var Zn=s.length,wn=[];for(p=0;p<Zn;p++){var xo=Xe(s[p]);wn.push(c.project(Xe([xo.lat-ot.lat,xo.lng-ot.lng])))}for(p=0,b=0;p<Zn-1;p++)b+=wn[p].distanceTo(wn[p+1])/2;if(b===0)Ve=wn[0];else for(p=0,q=0;p<Zn-1;p++)if(ae=wn[p],Le=wn[p+1],P=ae.distanceTo(Le),q+=P,q>b){Pe=(q-b)/P,Ve=[Le.x-Pe*(Le.x-ae.x),Le.y-Pe*(Le.y-ae.y)];break}var so=c.unproject(ne(Ve));return Xe([so.lat+ot.lat,so.lng+ot.lng])}var Pt={__proto__:null,simplify:Mi,pointToSegmentDistance:ua,closestPointOnSegment:Ai,clipSegment:tt,_getEdgeIntersection:ft,_getBitCode:Bt,_sqClosestPointOnSegment:nn,isFlat:Qt,_flat:Nt,polylineCenter:bn},on={project:function(s){return new O(s.lng,s.lat)},unproject:function(s){return new Ge(s.y,s.x)},bounds:new pe([-180,-90],[180,90])},Pn={R:6378137,R_MINOR:6356752314245179e-9,bounds:new pe([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var c=Math.PI/180,p=this.R,b=s.lat*c,P=this.R_MINOR/p,q=Math.sqrt(1-P*P),ae=q*Math.sin(b),Le=Math.tan(Math.PI/4-b/2)/Math.pow((1-ae)/(1+ae),q/2);return b=-p*Math.log(Math.max(Le,1e-10)),new O(s.lng*c*p,b)},unproject:function(s){for(var c=180/Math.PI,p=this.R,b=this.R_MINOR/p,P=Math.sqrt(1-b*b),q=Math.exp(-s.y/p),ae=Math.PI/2-2*Math.atan(q),Le=0,Pe=.1,Ve;Le<15&&Math.abs(Pe)>1e-7;Le++)Ve=P*Math.sin(ae),Ve=Math.pow((1-Ve)/(1+Ve),P/2),Pe=Math.PI/2-2*Math.atan(q*Ve)-ae,ae+=Pe;return new Ge(ae*c,s.x*c/p)}},ls={__proto__:null,LonLat:on,Mercator:Pn,SphericalMercator:me},po=n({},ye,{code:"EPSG:3395",projection:Pn,transformation:(function(){var s=.5/(Math.PI*Pn.R);return z(s,.5,-s,.5)})()}),Ya=n({},ye,{code:"EPSG:4326",projection:on,transformation:z(1/180,1,-1/180,.5)}),yl=n({},Q,{projection:on,transformation:z(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,c){var p=c.lng-s.lng,b=c.lat-s.lat;return Math.sqrt(p*p+b*b)},infinite:!0});Q.Earth=ye,Q.EPSG3395=po,Q.EPSG3857=K,Q.EPSG900913=se,Q.EPSG4326=Ya,Q.Simple=yl;var vo=te.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[d(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[d(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var c=s.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var p=this.getEvents();c.on(p,this),this.once("remove",function(){c.off(p,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});wt.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var c=d(s);return this._layers[c]?this:(this._layers[c]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var c=d(s);return this._layers[c]?(this._loaded&&s.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return d(s)in this._layers},eachLayer:function(s,c){for(var p in this._layers)s.call(c,this._layers[p]);return this},_addLayers:function(s){s=s?_(s)?s:[s]:[];for(var c=0,p=s.length;c<p;c++)this.addLayer(s[c])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[d(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var c=d(s);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,c=-1/0,p=this._getZoomSpan();for(var b in this._zoomBoundLayers){var P=this._zoomBoundLayers[b].options;s=P.minZoom===void 0?s:Math.min(s,P.minZoom),c=P.maxZoom===void 0?c:Math.max(c,P.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=s===1/0?void 0:s,p!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var da=vo.extend({initialize:function(s,c){S(this,c),this._layers={};var p,b;if(s)for(p=0,b=s.length;p<b;p++)this.addLayer(s[p])},addLayer:function(s){var c=this.getLayerId(s);return this._layers[c]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var c=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(s){var c=typeof s=="number"?s:this.getLayerId(s);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var c=Array.prototype.slice.call(arguments,1),p,b;for(p in this._layers)b=this._layers[p],b[s]&&b[s].apply(b,c);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,c){for(var p in this._layers)s.call(c,this._layers[p]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return d(s)}}),Pi=function(s,c){return new da(s,c)},zo=da.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),da.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),da.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new Ze;for(var c in this._layers){var p=this._layers[c];s.extend(p.getBounds?p.getBounds():p.getLatLng())}return s}}),Di=function(s,c){return new zo(s,c)},ha=oe.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){S(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,c){var p=this._getIconUrl(s);if(!p){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var b=this._createImg(p,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(b,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(b.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),b},_setIconStyles:function(s,c){var p=this.options,b=p[c+"Size"];typeof b=="number"&&(b=[b,b]);var P=ne(b),q=ne(c==="shadow"&&p.shadowAnchor||p.iconAnchor||P&&P.divideBy(2,!0));s.className="leaflet-marker-"+c+" "+(p.className||""),q&&(s.style.marginLeft=-q.x+"px",s.style.marginTop=-q.y+"px"),P&&(s.style.width=P.x+"px",s.style.height=P.y+"px")},_createImg:function(s,c){return c=c||document.createElement("img"),c.src=s,c},_getIconUrl:function(s){return qe.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function mr(s){return new ha(s)}var $s=ha.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof $s.imagePath!="string"&&($s.imagePath=this._detectIconPath()),(this.options.imagePath||$s.imagePath)+ha.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var c=function(p,b,P){var q=b.exec(p);return q&&q[P]};return s=c(s,/^url\((['"])?(.+)\1\)$/,2),s&&c(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=mt("div","leaflet-default-icon-path",document.body),c=to(s,"background-image")||to(s,"backgroundImage");if(document.body.removeChild(s),c=this._stripUrl(c),c)return c;var p=document.querySelector('link[href$="leaflet.css"]');return p?p.href.substring(0,p.href.length-11-1):""}}),Ri=oo.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new Io(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),pt(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&qt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var c=this._marker,p=c._map,b=this._marker.options.autoPanSpeed,P=this._marker.options.autoPanPadding,q=Lo(c._icon),ae=p.getPixelBounds(),Le=p.getPixelOrigin(),Pe=we(ae.min._subtract(Le).add(P),ae.max._subtract(Le).subtract(P));if(!Pe.contains(q)){var Ve=ne((Math.max(Pe.max.x,q.x)-Pe.max.x)/(ae.max.x-Pe.max.x)-(Math.min(Pe.min.x,q.x)-Pe.min.x)/(ae.min.x-Pe.min.x),(Math.max(Pe.max.y,q.y)-Pe.max.y)/(ae.max.y-Pe.max.y)-(Math.min(Pe.min.y,q.y)-Pe.min.y)/(ae.min.y-Pe.min.y)).multiplyBy(b);p.panBy(Ve,{animate:!1}),this._draggable._newPos._add(Ve),this._draggable._startPos._add(Ve),jt(c._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=F(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(j(this._panRequest),this._panRequest=F(this._adjustPan.bind(this,s)))},_onDrag:function(s){var c=this._marker,p=c._shadow,b=Lo(c._icon),P=c._map.layerPointToLatLng(b);p&&jt(p,b),c._latlng=P,s.latlng=P,s.oldLatLng=this._oldLatLng,c.fire("move",s).fire("drag",s)},_onDragEnd:function(s){j(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),Oi=vo.extend({options:{icon:new $s,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,c){S(this,c),this._latlng=Xe(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var c=this._latlng;return this._latlng=Xe(s),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),p=s.icon.createIcon(this._icon),b=!1;p!==this._icon&&(this._icon&&this._removeIcon(),b=!0,s.title&&(p.title=s.title),p.tagName==="IMG"&&(p.alt=s.alt||"")),pt(p,c),s.keyboard&&(p.tabIndex="0",p.setAttribute("role","button")),this._icon=p,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&it(p,"focus",this._panOnFocus,this);var P=s.icon.createShadow(this._shadow),q=!1;P!==this._shadow&&(this._removeShadow(),q=!0),P&&(pt(P,c),P.alt=""),this._shadow=P,s.opacity<1&&this._updateOpacity(),b&&this.getPane().appendChild(this._icon),this._initInteraction(),P&&q&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&xt(this._icon,"focus",this._panOnFocus,this),It(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&It(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&jt(this._icon,s),this._shadow&&jt(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(pt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ri)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ri(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&An(this._icon,s),this._shadow&&An(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var c=this.options.icon.options,p=c.iconSize?ne(c.iconSize):ne(0,0),b=c.iconAnchor?ne(c.iconAnchor):ne(0,0);s.panInside(this._latlng,{paddingTopLeft:b,paddingBottomRight:p.subtract(b)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Bc(s,c){return new Oi(s,c)}var rs=vo.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return S(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Bi=rs.extend({options:{fill:!0,radius:10},initialize:function(s,c){S(this,c),this._latlng=Xe(s),this._radius=this.options.radius},setLatLng:function(s){var c=this._latlng;return this._latlng=Xe(s),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var c=s&&s.radius||this._radius;return rs.prototype.setStyle.call(this,s),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,c=this._radiusY||s,p=this._clickTolerance(),b=[s+p,c+p];this._pxBounds=new pe(this._point.subtract(b),this._point.add(b))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Nc(s,c){return new Bi(s,c)}var kl=Bi.extend({initialize:function(s,c,p){if(typeof c=="number"&&(c=n({},p,{radius:c})),S(this,c),this._latlng=Xe(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new Ze(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:rs.prototype.setStyle,_project:function(){var s=this._latlng.lng,c=this._latlng.lat,p=this._map,b=p.options.crs;if(b.distance===ye.distance){var P=Math.PI/180,q=this._mRadius/ye.R/P,ae=p.project([c+q,s]),Le=p.project([c-q,s]),Pe=ae.add(Le).divideBy(2),Ve=p.unproject(Pe).lat,ot=Math.acos((Math.cos(q*P)-Math.sin(c*P)*Math.sin(Ve*P))/(Math.cos(c*P)*Math.cos(Ve*P)))/P;(isNaN(ot)||ot===0)&&(ot=q/Math.cos(Math.PI/180*c)),this._point=Pe.subtract(p.getPixelOrigin()),this._radius=isNaN(ot)?0:Pe.x-p.project([Ve,s-ot]).x,this._radiusY=Pe.y-ae.y}else{var ut=b.unproject(b.project(this._latlng).subtract([this._mRadius,0]));this._point=p.latLngToLayerPoint(this._latlng),this._radius=this._point.x-p.latLngToLayerPoint(ut).x}this._updateBounds()}});function Fc(s,c,p){return new kl(s,c,p)}var Ho=rs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,c){S(this,c),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var c=1/0,p=null,b=nn,P,q,ae=0,Le=this._parts.length;ae<Le;ae++)for(var Pe=this._parts[ae],Ve=1,ot=Pe.length;Ve<ot;Ve++){P=Pe[Ve-1],q=Pe[Ve];var ut=b(s,P,q,!0);ut<c&&(c=ut,p=b(s,P,q))}return p&&(p.distance=Math.sqrt(c)),p},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return bn(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,c){return c=c||this._defaultShape(),s=Xe(s),c.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new Ze,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return Qt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var c=[],p=Qt(s),b=0,P=s.length;b<P;b++)p?(c[b]=Xe(s[b]),this._bounds.extend(c[b])):c[b]=this._convertLatLngs(s[b]);return c},_project:function(){var s=new pe;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),c=new O(s,s);this._rawPxBounds&&(this._pxBounds=new pe([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(s,c,p){var b=s[0]instanceof Ge,P=s.length,q,ae;if(b){for(ae=[],q=0;q<P;q++)ae[q]=this._map.latLngToLayerPoint(s[q]),p.extend(ae[q]);c.push(ae)}else for(q=0;q<P;q++)this._projectLatlngs(s[q],c,p)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,p,b,P,q,ae,Le,Pe;for(p=0,P=0,q=this._rings.length;p<q;p++)for(Pe=this._rings[p],b=0,ae=Pe.length;b<ae-1;b++)Le=tt(Pe[b],Pe[b+1],s,b,!0),Le&&(c[P]=c[P]||[],c[P].push(Le[0]),(Le[1]!==Pe[b+1]||b===ae-2)&&(c[P].push(Le[1]),P++))}},_simplifyPoints:function(){for(var s=this._parts,c=this.options.smoothFactor,p=0,b=s.length;p<b;p++)s[p]=Mi(s[p],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,c){var p,b,P,q,ae,Le,Pe=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(p=0,q=this._parts.length;p<q;p++)for(Le=this._parts[p],b=0,ae=Le.length,P=ae-1;b<ae;P=b++)if(!(!c&&b===0)&&ua(s,Le[P],Le[b])<=Pe)return!0;return!1}});function Uc(s,c){return new Ho(s,c)}Ho._flat=Nt;var fa=Ho.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Wa(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var c=Ho.prototype._convertLatLngs.call(this,s),p=c.length;return p>=2&&c[0]instanceof Ge&&c[0].equals(c[p-1])&&c.pop(),c},_setLatLngs:function(s){Ho.prototype._setLatLngs.call(this,s),Qt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Qt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,c=this.options.weight,p=new O(c,c);if(s=new pe(s.min.subtract(p),s.max.add(p)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var b=0,P=this._rings.length,q;b<P;b++)q=ca(this._rings[b],s,!0),q.length&&this._parts.push(q)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var c=!1,p,b,P,q,ae,Le,Pe,Ve;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(q=0,Pe=this._parts.length;q<Pe;q++)for(p=this._parts[q],ae=0,Ve=p.length,Le=Ve-1;ae<Ve;Le=ae++)b=p[ae],P=p[Le],b.y>s.y!=P.y>s.y&&s.x<(P.x-b.x)*(s.y-b.y)/(P.y-b.y)+b.x&&(c=!c);return c||Ho.prototype._containsPoint.call(this,s,!0)}});function gr(s,c){return new fa(s,c)}var Vo=zo.extend({initialize:function(s,c){S(this,c),this._layers={},s&&this.addData(s)},addData:function(s){var c=_(s)?s:s.features,p,b,P;if(c){for(p=0,b=c.length;p<b;p++)P=c[p],(P.geometries||P.geometry||P.features||P.coordinates)&&this.addData(P);return this}var q=this.options;if(q.filter&&!q.filter(s))return this;var ae=Xa(s,q);return ae?(ae.feature=Ui(s),ae.defaultOptions=ae.options,this.resetStyle(ae),q.onEachFeature&&q.onEachFeature(s,ae),this.addLayer(ae)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=n({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(c){this._setLayerStyle(c,s)},this)},_setLayerStyle:function(s,c){s.setStyle&&(typeof c=="function"&&(c=c(s.feature)),s.setStyle(c))}});function Xa(s,c){var p=s.type==="Feature"?s.geometry:s,b=p?p.coordinates:null,P=[],q=c&&c.pointToLayer,ae=c&&c.coordsToLatLng||bl,Le,Pe,Ve,ot;if(!b&&!p)return null;switch(p.type){case"Point":return Le=ae(b),yr(q,s,Le,c);case"MultiPoint":for(Ve=0,ot=b.length;Ve<ot;Ve++)Le=ae(b[Ve]),P.push(yr(q,s,Le,c));return new zo(P);case"LineString":case"MultiLineString":return Pe=Ni(b,p.type==="LineString"?0:1,ae),new Ho(Pe,c);case"Polygon":case"MultiPolygon":return Pe=Ni(b,p.type==="Polygon"?1:2,ae),new fa(Pe,c);case"GeometryCollection":for(Ve=0,ot=p.geometries.length;Ve<ot;Ve++){var ut=Xa({geometry:p.geometries[Ve],type:"Feature",properties:s.properties},c);ut&&P.push(ut)}return new zo(P);case"FeatureCollection":for(Ve=0,ot=p.features.length;Ve<ot;Ve++){var Ct=Xa(p.features[Ve],c);Ct&&P.push(Ct)}return new zo(P);default:throw new Error("Invalid GeoJSON object.")}}function yr(s,c,p,b){return s?s(c,p):new Oi(p,b&&b.markersInheritOptions&&b)}function bl(s){return new Ge(s[1],s[0],s[2])}function Ni(s,c,p){for(var b=[],P=0,q=s.length,ae;P<q;P++)ae=c?Ni(s[P],c-1,p):(p||bl)(s[P]),b.push(ae);return b}function Qa(s,c){return s=Xe(s),s.alt!==void 0?[y(s.lng,c),y(s.lat,c),y(s.alt,c)]:[y(s.lng,c),y(s.lat,c)]}function Fi(s,c,p,b){for(var P=[],q=0,ae=s.length;q<ae;q++)P.push(c?Fi(s[q],Qt(s[q])?0:c-1,p,b):Qa(s[q],b));return!c&&p&&P.length>0&&P.push(P[0].slice()),P}function pa(s,c){return s.feature?n({},s.feature,{geometry:c}):Ui(c)}function Ui(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var zi={toGeoJSON:function(s){return pa(this,{type:"Point",coordinates:Qa(this.getLatLng(),s)})}};Oi.include(zi),kl.include(zi),Bi.include(zi),Ho.include({toGeoJSON:function(s){var c=!Qt(this._latlngs),p=Fi(this._latlngs,c?1:0,!1,s);return pa(this,{type:(c?"Multi":"")+"LineString",coordinates:p})}}),fa.include({toGeoJSON:function(s){var c=!Qt(this._latlngs),p=c&&!Qt(this._latlngs[0]),b=Fi(this._latlngs,p?2:c?1:0,!0,s);return c||(b=[b]),pa(this,{type:(p?"Multi":"")+"Polygon",coordinates:b})}}),da.include({toMultiPoint:function(s){var c=[];return this.eachLayer(function(p){c.push(p.toGeoJSON(s).geometry.coordinates)}),pa(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(s){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(s);var p=c==="GeometryCollection",b=[];return this.eachLayer(function(P){if(P.toGeoJSON){var q=P.toGeoJSON(s);if(p)b.push(q.geometry);else{var ae=Ui(q);ae.type==="FeatureCollection"?b.push.apply(b,ae.features):b.push(ae)}}}),p?pa(this,{geometries:b,type:"GeometryCollection"}):{type:"FeatureCollection",features:b}}});function kr(s,c){return new Vo(s,c)}var ei=kr,ti=vo.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,c,p){this._url=s,this._bounds=Ne(c),S(this,p)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(pt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){It(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&fo(this._image),this},bringToBack:function(){return this._map&&qn(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=Ne(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",c=this._image=s?this._url:mt("img");if(pt(c,"leaflet-image-layer"),this._zoomAnimated&&pt(c,"leaflet-zoom-animated"),this.options.className&&pt(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onload=l(this.fire,this,"load"),c.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(s){var c=this._map.getZoomScale(s.zoom),p=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;Oo(this._image,p,c)},_reset:function(){var s=this._image,c=new pe(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),p=c.getSize();jt(s,c.min),s.style.width=p.x+"px",s.style.height=p.y+"px"},_updateOpacity:function(){An(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),br=function(s,c,p){return new ti(s,c,p)},_l=ti.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",c=this._image=s?this._url:mt("video");if(pt(c,"leaflet-image-layer"),this._zoomAnimated&&pt(c,"leaflet-zoom-animated"),this.options.className&&pt(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onloadeddata=l(this.fire,this,"load"),s){for(var p=c.getElementsByTagName("source"),b=[],P=0;P<p.length;P++)b.push(p[P].src);this._url=p.length>0?b:[c.src];return}_(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var q=0;q<this._url.length;q++){var ae=mt("source");ae.src=this._url[q],c.appendChild(ae)}}});function G(s,c,p){return new _l(s,c,p)}var le=ti.extend({_initImage:function(){var s=this._image=this._url;pt(s,"leaflet-image-layer"),this._zoomAnimated&&pt(s,"leaflet-zoom-animated"),this.options.className&&pt(s,this.options.className),s.onselectstart=m,s.onmousemove=m}});function ge(s,c,p){return new le(s,c,p)}var _e=vo.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,c){s&&(s instanceof Ge||_(s))?(this._latlng=Xe(s),S(this,c)):(S(this,s),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&An(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&An(this._container,1),this.bringToFront(),this.options.interactive&&(pt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(An(this._container,0),this._removeTimeout=setTimeout(l(It,void 0,this._container),200)):It(this._container),this.options.interactive&&(qt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=Xe(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&fo(this._container),this},bringToBack:function(){return this._map&&qn(this._container),this},_prepareOpen:function(s){var c=this._source;if(!c._map)return!1;if(c instanceof zo){c=null;var p=this._source._layers;for(var b in p)if(p[b]._map){c=p[b];break}if(!c)return!1;this._source=c}if(!s)if(c.getCenter)s=c.getCenter();else if(c.getLatLng)s=c.getLatLng();else if(c.getBounds)s=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")s.innerHTML=c;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),c=ne(this.options.offset),p=this._getAnchor();this._zoomAnimated?jt(this._container,s.add(p)):c=c.add(s).add(p);var b=this._containerBottom=-c.y,P=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=b+"px",this._container.style.left=P+"px"}},_getAnchor:function(){return[0,0]}});wt.include({_initOverlay:function(s,c,p,b){var P=c;return P instanceof s||(P=new s(b).setContent(c)),p&&P.setLatLng(p),P}}),vo.include({_initOverlay:function(s,c,p,b){var P=p;return P instanceof s?(S(P,b),P._source=this):(P=c&&!b?c:new s(b,this),P.setContent(p)),P}});var at=_e.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,_e.prototype.openOn.call(this,s)},onAdd:function(s){_e.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof rs||this._source.on("preclick",So))},onRemove:function(s){_e.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof rs||this._source.off("preclick",So))},getEvents:function(){var s=_e.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",c=this._container=mt("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),p=this._wrapper=mt("div",s+"-content-wrapper",c);if(this._contentNode=mt("div",s+"-content",p),as(c),Va(this._contentNode),it(c,"contextmenu",So),this._tipContainer=mt("div",s+"-tip-container",c),this._tip=mt("div",s+"-tip",this._tipContainer),this.options.closeButton){var b=this._closeButton=mt("a",s+"-close-button",c);b.setAttribute("role","button"),b.setAttribute("aria-label","Close popup"),b.href="#close",b.innerHTML='<span aria-hidden="true">&#215;</span>',it(b,"click",function(P){tn(P),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,c=s.style;c.width="",c.whiteSpace="nowrap";var p=s.offsetWidth;p=Math.min(p,this.options.maxWidth),p=Math.max(p,this.options.minWidth),c.width=p+1+"px",c.whiteSpace="",c.height="";var b=s.offsetHeight,P=this.options.maxHeight,q="leaflet-popup-scrolled";P&&b>P?(c.height=P+"px",pt(s,q)):qt(s,q),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),p=this._getAnchor();jt(this._container,c.add(p))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,c=parseInt(to(this._container,"marginBottom"),10)||0,p=this._container.offsetHeight+c,b=this._containerWidth,P=new O(this._containerLeft,-p-this._containerBottom);P._add(Lo(this._container));var q=s.layerPointToContainerPoint(P),ae=ne(this.options.autoPanPadding),Le=ne(this.options.autoPanPaddingTopLeft||ae),Pe=ne(this.options.autoPanPaddingBottomRight||ae),Ve=s.getSize(),ot=0,ut=0;q.x+b+Pe.x>Ve.x&&(ot=q.x+b-Ve.x+Pe.x),q.x-ot-Le.x<0&&(ot=q.x-Le.x),q.y+p+Pe.y>Ve.y&&(ut=q.y+p-Ve.y+Pe.y),q.y-ut-Le.y<0&&(ut=q.y-Le.y),(ot||ut)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([ot,ut]))}},_getAnchor:function(){return ne(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),bt=function(s,c){return new at(s,c)};wt.mergeOptions({closePopupOnClick:!0}),wt.include({openPopup:function(s,c,p){return this._initOverlay(at,s,c,p).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),vo.include({bindPopup:function(s,c){return this._popup=this._initOverlay(at,this._popup,s,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof zo||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){Fo(s);var c=s.layer||s.target;if(this._popup._source===c&&!(c instanceof rs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=c,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var Mt=_e.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){_e.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){_e.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=_e.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",c=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=mt("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var c,p,b=this._map,P=this._container,q=b.latLngToContainerPoint(b.getCenter()),ae=b.layerPointToContainerPoint(s),Le=this.options.direction,Pe=P.offsetWidth,Ve=P.offsetHeight,ot=ne(this.options.offset),ut=this._getAnchor();Le==="top"?(c=Pe/2,p=Ve):Le==="bottom"?(c=Pe/2,p=0):Le==="center"?(c=Pe/2,p=Ve/2):Le==="right"?(c=0,p=Ve/2):Le==="left"?(c=Pe,p=Ve/2):ae.x<q.x?(Le="right",c=0,p=Ve/2):(Le="left",c=Pe+(ot.x+ut.x)*2,p=Ve/2),s=s.subtract(ne(c,p,!0)).add(ot).add(ut),qt(P,"leaflet-tooltip-right"),qt(P,"leaflet-tooltip-left"),qt(P,"leaflet-tooltip-top"),qt(P,"leaflet-tooltip-bottom"),pt(P,"leaflet-tooltip-"+Le),jt(P,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&An(this._container,s)},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(c)},_getAnchor:function(){return ne(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),_n=function(s,c){return new Mt(s,c)};wt.include({openTooltip:function(s,c,p){return this._initOverlay(Mt,s,c,p).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),vo.include({bindTooltip:function(s,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Mt,this._tooltip,s,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var c=s?"off":"on",p={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?p.add=this._openTooltip:(p.mouseover=this._openTooltip,p.mouseout=this.closeTooltip,p.click=this._openTooltip,this._map?this._addFocusListeners():p.add=this._addFocusListeners),this._tooltip.options.sticky&&(p.mousemove=this._moveTooltip),this[c](p),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof zo||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var c=typeof s.getElement=="function"&&s.getElement();c&&(it(c,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),it(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var c=typeof s.getElement=="function"&&s.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var c=s.latlng,p,b;this._tooltip.options.sticky&&s.originalEvent&&(p=this._map.mouseEventToContainerPoint(s.originalEvent),b=this._map.containerPointToLayerPoint(p),c=this._map.layerPointToLatLng(b)),this._tooltip.setLatLng(c)}});var va=ha.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var c=s&&s.tagName==="DIV"?s:document.createElement("div"),p=this.options;if(p.html instanceof Element?(ho(c),c.appendChild(p.html)):c.innerHTML=p.html!==!1?p.html:"",p.bgPos){var b=ne(p.bgPos);c.style.backgroundPosition=-b.x+"px "+-b.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function Hi(s){return new va(s)}ha.Default=$s;var Ts=vo.extend({options:{tileSize:256,opacity:1,updateWhenIdle:qe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){S(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),It(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(fo(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(qn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=h(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof O?s:new O(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var c=this.getPane().children,p=-s(-1/0,1/0),b=0,P=c.length,q;b<P;b++)q=c[b].style.zIndex,c[b]!==this._container&&q&&(p=s(p,+q));isFinite(p)&&(this.options.zIndex=p+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!qe.ielt9){An(this._container,this.options.opacity);var s=+new Date,c=!1,p=!1;for(var b in this._tiles){var P=this._tiles[b];if(!(!P.current||!P.loaded)){var q=Math.min(1,(s-P.loaded)/200);An(P.el,q),q<1?c=!0:(P.active?p=!0:this._onOpaqueTile(P),P.active=!0)}}p&&!this._noPrune&&this._pruneTiles(),c&&(j(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=mt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,c=this.options.maxZoom;if(s!==void 0){for(var p in this._levels)p=Number(p),this._levels[p].el.children.length||p===s?(this._levels[p].el.style.zIndex=c-Math.abs(s-p),this._onUpdateLevel(p)):(It(this._levels[p].el),this._removeTilesAtZoom(p),this._onRemoveLevel(p),delete this._levels[p]);var b=this._levels[s],P=this._map;return b||(b=this._levels[s]={},b.el=mt("div","leaflet-tile-container leaflet-zoom-animated",this._container),b.el.style.zIndex=c,b.origin=P.project(P.unproject(P.getPixelOrigin()),s).round(),b.zoom=s,this._setZoomTransform(b,P.getCenter(),P.getZoom()),m(b.el.offsetWidth),this._onCreateLevel(b)),this._level=b,b}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var s,c,p=this._map.getZoom();if(p>this.options.maxZoom||p<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)c=this._tiles[s],c.retain=c.current;for(s in this._tiles)if(c=this._tiles[s],c.current&&!c.active){var b=c.coords;this._retainParent(b.x,b.y,b.z,b.z-5)||this._retainChildren(b.x,b.y,b.z,b.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var c in this._tiles)this._tiles[c].coords.z===s&&this._removeTile(c)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)It(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,c,p,b){var P=Math.floor(s/2),q=Math.floor(c/2),ae=p-1,Le=new O(+P,+q);Le.z=+ae;var Pe=this._tileCoordsToKey(Le),Ve=this._tiles[Pe];return Ve&&Ve.active?(Ve.retain=!0,!0):(Ve&&Ve.loaded&&(Ve.retain=!0),ae>b?this._retainParent(P,q,ae,b):!1)},_retainChildren:function(s,c,p,b){for(var P=2*s;P<2*s+2;P++)for(var q=2*c;q<2*c+2;q++){var ae=new O(P,q);ae.z=p+1;var Le=this._tileCoordsToKey(ae),Pe=this._tiles[Le];if(Pe&&Pe.active){Pe.retain=!0;continue}else Pe&&Pe.loaded&&(Pe.retain=!0);p+1<b&&this._retainChildren(P,q,p+1,b)}},_resetView:function(s){var c=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var c=this.options;return c.minNativeZoom!==void 0&&s<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<s?c.maxNativeZoom:s},_setView:function(s,c,p,b){var P=Math.round(c);this.options.maxZoom!==void 0&&P>this.options.maxZoom||this.options.minZoom!==void 0&&P<this.options.minZoom?P=void 0:P=this._clampZoom(P);var q=this.options.updateWhenZooming&&P!==this._tileZoom;(!b||q)&&(this._tileZoom=P,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),P!==void 0&&this._update(s),p||this._pruneTiles(),this._noPrune=!!p),this._setZoomTransforms(s,c)},_setZoomTransforms:function(s,c){for(var p in this._levels)this._setZoomTransform(this._levels[p],s,c)},_setZoomTransform:function(s,c,p){var b=this._map.getZoomScale(p,s.zoom),P=s.origin.multiplyBy(b).subtract(this._map._getNewPixelOrigin(c,p)).round();qe.any3d?Oo(s.el,P,b):jt(s.el,P)},_resetGrid:function(){var s=this._map,c=s.options.crs,p=this._tileSize=this.getTileSize(),b=this._tileZoom,P=this._map.getPixelWorldBounds(this._tileZoom);P&&(this._globalTileRange=this._pxBoundsToTileRange(P)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,c.wrapLng[0]],b).x/p.x),Math.ceil(s.project([0,c.wrapLng[1]],b).x/p.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([c.wrapLat[0],0],b).y/p.x),Math.ceil(s.project([c.wrapLat[1],0],b).y/p.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var c=this._map,p=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),b=c.getZoomScale(p,this._tileZoom),P=c.project(s,this._tileZoom).floor(),q=c.getSize().divideBy(b*2);return new pe(P.subtract(q),P.add(q))},_update:function(s){var c=this._map;if(c){var p=this._clampZoom(c.getZoom());if(s===void 0&&(s=c.getCenter()),this._tileZoom!==void 0){var b=this._getTiledPixelBounds(s),P=this._pxBoundsToTileRange(b),q=P.getCenter(),ae=[],Le=this.options.keepBuffer,Pe=new pe(P.getBottomLeft().subtract([Le,-Le]),P.getTopRight().add([Le,-Le]));if(!(isFinite(P.min.x)&&isFinite(P.min.y)&&isFinite(P.max.x)&&isFinite(P.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ve in this._tiles){var ot=this._tiles[Ve].coords;(ot.z!==this._tileZoom||!Pe.contains(new O(ot.x,ot.y)))&&(this._tiles[Ve].current=!1)}if(Math.abs(p-this._tileZoom)>1){this._setView(s,p);return}for(var ut=P.min.y;ut<=P.max.y;ut++)for(var Ct=P.min.x;Ct<=P.max.x;Ct++){var Zn=new O(Ct,ut);if(Zn.z=this._tileZoom,!!this._isValidTile(Zn)){var wn=this._tiles[this._tileCoordsToKey(Zn)];wn?wn.current=!0:ae.push(Zn)}}if(ae.sort(function(so,Vi){return so.distanceTo(q)-Vi.distanceTo(q)}),ae.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var xo=document.createDocumentFragment();for(Ct=0;Ct<ae.length;Ct++)this._addTile(ae[Ct],xo);this._level.el.appendChild(xo)}}}},_isValidTile:function(s){var c=this._map.options.crs;if(!c.infinite){var p=this._globalTileRange;if(!c.wrapLng&&(s.x<p.min.x||s.x>p.max.x)||!c.wrapLat&&(s.y<p.min.y||s.y>p.max.y))return!1}if(!this.options.bounds)return!0;var b=this._tileCoordsToBounds(s);return Ne(this.options.bounds).overlaps(b)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var c=this._map,p=this.getTileSize(),b=s.scaleBy(p),P=b.add(p),q=c.unproject(b,s.z),ae=c.unproject(P,s.z);return[q,ae]},_tileCoordsToBounds:function(s){var c=this._tileCoordsToNwSe(s),p=new Ze(c[0],c[1]);return this.options.noWrap||(p=this._map.wrapLatLngBounds(p)),p},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var c=s.split(":"),p=new O(+c[0],+c[1]);return p.z=+c[2],p},_removeTile:function(s){var c=this._tiles[s];c&&(It(c.el),delete this._tiles[s],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){pt(s,"leaflet-tile");var c=this.getTileSize();s.style.width=c.x+"px",s.style.height=c.y+"px",s.onselectstart=m,s.onmousemove=m,qe.ielt9&&this.options.opacity<1&&An(s,this.options.opacity)},_addTile:function(s,c){var p=this._getTilePos(s),b=this._tileCoordsToKey(s),P=this.createTile(this._wrapCoords(s),l(this._tileReady,this,s));this._initTile(P),this.createTile.length<2&&F(l(this._tileReady,this,s,null,P)),jt(P,p),this._tiles[b]={el:P,coords:s,current:!0},c.appendChild(P),this.fire("tileloadstart",{tile:P,coords:s})},_tileReady:function(s,c,p){c&&this.fire("tileerror",{error:c,tile:p,coords:s});var b=this._tileCoordsToKey(s);p=this._tiles[b],p&&(p.loaded=+new Date,this._map._fadeAnimated?(An(p.el,0),j(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this)):(p.active=!0,this._pruneTiles()),c||(pt(p.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:p.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),qe.ielt9||!this._map._fadeAnimated?F(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var c=new O(this._wrapX?f(s.x,this._wrapX):s.x,this._wrapY?f(s.y,this._wrapY):s.y);return c.z=s.z,c},_pxBoundsToTileRange:function(s){var c=this.getTileSize();return new pe(s.min.unscaleBy(c).floor(),s.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function ma(s){return new Ts(s)}var $n=Ts.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,c){this._url=s,c=S(this,c),c.detectRetina&&qe.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,c){return this._url===s&&c===void 0&&(c=!0),this._url=s,c||this.redraw(),this},createTile:function(s,c){var p=document.createElement("img");return it(p,"load",l(this._tileOnLoad,this,c,p)),it(p,"error",l(this._tileOnError,this,c,p)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(p.referrerPolicy=this.options.referrerPolicy),p.alt="",p.src=this.getTileUrl(s),p},getTileUrl:function(s){var c={r:qe.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var p=this._globalTileRange.max.y-s.y;this.options.tms&&(c.y=p),c["-y"]=p}return C(this._url,n(c,this.options))},_tileOnLoad:function(s,c){qe.ielt9?setTimeout(l(s,this,null,c),0):s(null,c)},_tileOnError:function(s,c,p){var b=this.options.errorTileUrl;b&&c.getAttribute("src")!==b&&(c.src=b),s(p,c)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,c=this.options.maxZoom,p=this.options.zoomReverse,b=this.options.zoomOffset;return p&&(s=c-s),s+b},_getSubdomain:function(s){var c=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var s,c;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(c=this._tiles[s].el,c.onload=m,c.onerror=m,!c.complete)){c.src=M;var p=this._tiles[s].coords;It(c),delete this._tiles[s],this.fire("tileabort",{tile:c,coords:p})}},_removeTile:function(s){var c=this._tiles[s];if(c)return c.el.setAttribute("src",M),Ts.prototype._removeTile.call(this,s)},_tileReady:function(s,c,p){if(!(!this._map||p&&p.getAttribute("src")===M))return Ts.prototype._tileReady.call(this,s,c,p)}});function Jd(s,c){return new $n(s,c)}var Yd=$n.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,c){this._url=s;var p=n({},this.defaultWmsParams);for(var b in c)b in this.options||(p[b]=c[b]);c=S(this,c);var P=c.detectRetina&&qe.retina?2:1,q=this.getTileSize();p.width=q.x*P,p.height=q.y*P,this.wmsParams=p},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,$n.prototype.onAdd.call(this,s)},getTileUrl:function(s){var c=this._tileCoordsToNwSe(s),p=this._crs,b=we(p.project(c[0]),p.project(c[1])),P=b.min,q=b.max,ae=(this._wmsVersion>=1.3&&this._crs===Ya?[P.y,P.x,q.y,q.x]:[P.x,P.y,q.x,q.y]).join(","),Le=$n.prototype.getTileUrl.call(this,s);return Le+T(this.wmsParams,Le,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ae},setParams:function(s,c){return n(this.wmsParams,s),c||this.redraw(),this}});function xg(s,c){return new Yd(s,c)}$n.WMS=Yd,Jd.wms=xg;var Ms=vo.extend({options:{padding:.1},initialize:function(s){S(this,s),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),pt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,c){var p=this._map.getZoomScale(c,this._zoom),b=this._map.getSize().multiplyBy(.5+this.options.padding),P=this._map.project(this._center,c),q=b.multiplyBy(-p).add(P).subtract(this._map._getNewPixelOrigin(s,c));qe.any3d?Oo(this._container,q,p):jt(this._container,q)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,c=this._map.getSize(),p=this._map.containerPointToLayerPoint(c.multiplyBy(-s)).round();this._bounds=new pe(p,p.add(c.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Xd=Ms.extend({options:{tolerance:0},getEvents:function(){var s=Ms.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Ms.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");it(s,"mousemove",this._onMouseMove,this),it(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),it(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){j(this._redrawRequest),delete this._ctx,It(this._container),xt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var c in this._layers)s=this._layers[c],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ms.prototype._update.call(this);var s=this._bounds,c=this._container,p=s.getSize(),b=qe.retina?2:1;jt(c,s.min),c.width=b*p.x,c.height=b*p.y,c.style.width=p.x+"px",c.style.height=p.y+"px",qe.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){Ms.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[d(s)]=s;var c=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var c=s._order,p=c.next,b=c.prev;p?p.prev=b:this._drawLast=b,b?b.next=p:this._drawFirst=p,delete s._order,delete this._layers[d(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var c=s.options.dashArray.split(/[, ]+/),p=[],b,P;for(P=0;P<c.length;P++){if(b=Number(c[P]),isNaN(b))return;p.push(b)}s.options._dashArray=p}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||F(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var c=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new pe,this._redrawBounds.extend(s._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(s._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var c=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,c=this._redrawBounds;if(this._ctx.save(),c){var p=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,p.x,p.y),this._ctx.clip()}this._drawing=!0;for(var b=this._drawFirst;b;b=b.next)s=b.layer,(!c||s._pxBounds&&s._pxBounds.intersects(c))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,c){if(this._drawing){var p,b,P,q,ae=s._parts,Le=ae.length,Pe=this._ctx;if(Le){for(Pe.beginPath(),p=0;p<Le;p++){for(b=0,P=ae[p].length;b<P;b++)q=ae[p][b],Pe[b?"lineTo":"moveTo"](q.x,q.y);c&&Pe.closePath()}this._fillStroke(Pe,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var c=s._point,p=this._ctx,b=Math.max(Math.round(s._radius),1),P=(Math.max(Math.round(s._radiusY),1)||b)/b;P!==1&&(p.save(),p.scale(1,P)),p.beginPath(),p.arc(c.x,c.y/P,b,0,Math.PI*2,!1),P!==1&&p.restore(),this._fillStroke(p,s)}},_fillStroke:function(s,c){var p=c.options;p.fill&&(s.globalAlpha=p.fillOpacity,s.fillStyle=p.fillColor||p.color,s.fill(p.fillRule||"evenodd")),p.stroke&&p.weight!==0&&(s.setLineDash&&s.setLineDash(c.options&&c.options._dashArray||[]),s.globalAlpha=p.opacity,s.lineWidth=p.weight,s.strokeStyle=p.color,s.lineCap=p.lineCap,s.lineJoin=p.lineJoin,s.stroke())},_onClick:function(s){for(var c=this._map.mouseEventToLayerPoint(s),p,b,P=this._drawFirst;P;P=P.next)p=P.layer,p.options.interactive&&p._containsPoint(c)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(p))&&(b=p);this._fireEvent(b?[b]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,c)}},_handleMouseOut:function(s){var c=this._hoveredLayer;c&&(qt(this._container,"leaflet-interactive"),this._fireEvent([c],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,c){if(!this._mouseHoverThrottled){for(var p,b,P=this._drawFirst;P;P=P.next)p=P.layer,p.options.interactive&&p._containsPoint(c)&&(b=p);b!==this._hoveredLayer&&(this._handleMouseOut(s),b&&(pt(this._container,"leaflet-interactive"),this._fireEvent([b],s,"mouseover"),this._hoveredLayer=b)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,c,p){this._map._fireDOMEvent(c,p||c.type,s)},_bringToFront:function(s){var c=s._order;if(c){var p=c.next,b=c.prev;if(p)p.prev=b;else return;b?b.next=p:p&&(this._drawFirst=p),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(s)}},_bringToBack:function(s){var c=s._order;if(c){var p=c.next,b=c.prev;if(b)b.next=p;else return;p?p.prev=b:b&&(this._drawLast=b),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(s)}}});function Qd(s){return qe.canvas?new Xd(s):null}var wl=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),$g={_initContainer:function(){this._container=mt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Ms.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var c=s._container=wl("shape");pt(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",s._path=wl("path"),c.appendChild(s._path),this._updateStyle(s),this._layers[d(s)]=s},_addPath:function(s){var c=s._container;this._container.appendChild(c),s.options.interactive&&s.addInteractiveTarget(c)},_removePath:function(s){var c=s._container;It(c),s.removeInteractiveTarget(c),delete this._layers[d(s)]},_updateStyle:function(s){var c=s._stroke,p=s._fill,b=s.options,P=s._container;P.stroked=!!b.stroke,P.filled=!!b.fill,b.stroke?(c||(c=s._stroke=wl("stroke")),P.appendChild(c),c.weight=b.weight+"px",c.color=b.color,c.opacity=b.opacity,b.dashArray?c.dashStyle=_(b.dashArray)?b.dashArray.join(" "):b.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=b.lineCap.replace("butt","flat"),c.joinstyle=b.lineJoin):c&&(P.removeChild(c),s._stroke=null),b.fill?(p||(p=s._fill=wl("fill")),P.appendChild(p),p.color=b.fillColor||b.color,p.opacity=b.fillOpacity):p&&(P.removeChild(p),s._fill=null)},_updateCircle:function(s){var c=s._point.round(),p=Math.round(s._radius),b=Math.round(s._radiusY||p);this._setPath(s,s._empty()?"M0 0":"AL "+c.x+","+c.y+" "+p+","+b+" 0,"+65535*360)},_setPath:function(s,c){s._path.v=c},_bringToFront:function(s){fo(s._container)},_bringToBack:function(s){qn(s._container)}},_r=qe.vml?wl:Ee,Cl=Ms.extend({_initContainer:function(){this._container=_r("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=_r("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){It(this._container),xt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ms.prototype._update.call(this);var s=this._bounds,c=s.getSize(),p=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,p.setAttribute("width",c.x),p.setAttribute("height",c.y)),jt(p,s.min),p.setAttribute("viewBox",[s.min.x,s.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(s){var c=s._path=_r("path");s.options.className&&pt(c,s.options.className),s.options.interactive&&pt(c,"leaflet-interactive"),this._updateStyle(s),this._layers[d(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){It(s._path),s.removeInteractiveTarget(s._path),delete this._layers[d(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var c=s._path,p=s.options;c&&(p.stroke?(c.setAttribute("stroke",p.color),c.setAttribute("stroke-opacity",p.opacity),c.setAttribute("stroke-width",p.weight),c.setAttribute("stroke-linecap",p.lineCap),c.setAttribute("stroke-linejoin",p.lineJoin),p.dashArray?c.setAttribute("stroke-dasharray",p.dashArray):c.removeAttribute("stroke-dasharray"),p.dashOffset?c.setAttribute("stroke-dashoffset",p.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),p.fill?(c.setAttribute("fill",p.fillColor||p.color),c.setAttribute("fill-opacity",p.fillOpacity),c.setAttribute("fill-rule",p.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(s,c){this._setPath(s,Be(s._parts,c))},_updateCircle:function(s){var c=s._point,p=Math.max(Math.round(s._radius),1),b=Math.max(Math.round(s._radiusY),1)||p,P="a"+p+","+b+" 0 1,0 ",q=s._empty()?"M0 0":"M"+(c.x-p)+","+c.y+P+p*2+",0 "+P+-p*2+",0 ";this._setPath(s,q)},_setPath:function(s,c){s._path.setAttribute("d",c)},_bringToFront:function(s){fo(s._path)},_bringToBack:function(s){qn(s._path)}});qe.vml&&Cl.include($g);function eh(s){return qe.svg||qe.vml?new Cl(s):null}wt.include({getRenderer:function(s){var c=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var c=this._paneRenderers[s];return c===void 0&&(c=this._createRenderer({pane:s}),this._paneRenderers[s]=c),c},_createRenderer:function(s){return this.options.preferCanvas&&Qd(s)||eh(s)}});var th=fa.extend({initialize:function(s,c){fa.prototype.initialize.call(this,this._boundsToLatLngs(s),c)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=Ne(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function Tg(s,c){return new th(s,c)}Cl.create=_r,Cl.pointsToPath=Be,Vo.geometryToLayer=Xa,Vo.coordsToLatLng=bl,Vo.coordsToLatLngs=Ni,Vo.latLngToCoords=Qa,Vo.latLngsToCoords=Fi,Vo.getFeature=pa,Vo.asFeature=Ui,wt.mergeOptions({boxZoom:!0});var nh=oo.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){it(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){xt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){It(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Bo(),Ha(),this._startPoint=this._map.mouseEventToContainerPoint(s),it(document,{contextmenu:Fo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=mt("div","leaflet-zoom-box",this._container),pt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var c=new pe(this._point,this._startPoint),p=c.getSize();jt(this._box,c.min),this._box.style.width=p.x+"px",this._box.style.height=p.y+"px"},_finish:function(){this._moved&&(It(this._box),qt(this._container,"leaflet-crosshair")),os(),Jt(),xt(document,{contextmenu:Fo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var c=new Ze(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});wt.addInitHook("addHandler","boxZoom",nh),wt.mergeOptions({doubleClickZoom:!0});var oh=oo.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var c=this._map,p=c.getZoom(),b=c.options.zoomDelta,P=s.originalEvent.shiftKey?p-b:p+b;c.options.doubleClickZoom==="center"?c.setZoom(P):c.setZoomAround(s.containerPoint,P)}});wt.addInitHook("addHandler","doubleClickZoom",oh),wt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var sh=oo.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new Io(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}pt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){qt(this._map._container,"leaflet-grab"),qt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=Ne(this._map.options.maxBounds);this._offsetLimit=we(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var c=this._lastTime=+new Date,p=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(p),this._times.push(c),this._prunePositions(c)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,c){return s-(s-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;s.x<c.min.x&&(s.x=this._viscousLimit(s.x,c.min.x)),s.y<c.min.y&&(s.y=this._viscousLimit(s.y,c.min.y)),s.x>c.max.x&&(s.x=this._viscousLimit(s.x,c.max.x)),s.y>c.max.y&&(s.y=this._viscousLimit(s.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,c=Math.round(s/2),p=this._initialWorldOffset,b=this._draggable._newPos.x,P=(b-c+p)%s+c-p,q=(b+c+p)%s-c-p,ae=Math.abs(P+p)<Math.abs(q+p)?P:q;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ae},_onDragEnd:function(s){var c=this._map,p=c.options,b=!p.inertia||s.noInertia||this._times.length<2;if(c.fire("dragend",s),b)c.fire("moveend");else{this._prunePositions(+new Date);var P=this._lastPos.subtract(this._positions[0]),q=(this._lastTime-this._times[0])/1e3,ae=p.easeLinearity,Le=P.multiplyBy(ae/q),Pe=Le.distanceTo([0,0]),Ve=Math.min(p.inertiaMaxSpeed,Pe),ot=Le.multiplyBy(Ve/Pe),ut=Ve/(p.inertiaDeceleration*ae),Ct=ot.multiplyBy(-ut/2).round();!Ct.x&&!Ct.y?c.fire("moveend"):(Ct=c._limitOffset(Ct,c.options.maxBounds),F(function(){c.panBy(Ct,{duration:ut,easeLinearity:ae,noMoveStart:!0,animate:!0})}))}}});wt.addInitHook("addHandler","dragging",sh),wt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ah=oo.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),it(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),xt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,c=document.documentElement,p=s.scrollTop||c.scrollTop,b=s.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(b,p)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var c=this._panKeys={},p=this.keyCodes,b,P;for(b=0,P=p.left.length;b<P;b++)c[p.left[b]]=[-1*s,0];for(b=0,P=p.right.length;b<P;b++)c[p.right[b]]=[s,0];for(b=0,P=p.down.length;b<P;b++)c[p.down[b]]=[0,s];for(b=0,P=p.up.length;b<P;b++)c[p.up[b]]=[0,-1*s]},_setZoomDelta:function(s){var c=this._zoomKeys={},p=this.keyCodes,b,P;for(b=0,P=p.zoomIn.length;b<P;b++)c[p.zoomIn[b]]=s;for(b=0,P=p.zoomOut.length;b<P;b++)c[p.zoomOut[b]]=-s},_addHooks:function(){it(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){xt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var c=s.keyCode,p=this._map,b;if(c in this._panKeys){if(!p._panAnim||!p._panAnim._inProgress)if(b=this._panKeys[c],s.shiftKey&&(b=ne(b).multiplyBy(3)),p.options.maxBounds&&(b=p._limitOffset(ne(b),p.options.maxBounds)),p.options.worldCopyJump){var P=p.wrapLatLng(p.unproject(p.project(p.getCenter()).add(b)));p.panTo(P)}else p.panBy(b)}else if(c in this._zoomKeys)p.setZoom(p.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&p._popup&&p._popup.options.closeOnEscapeKey)p.closePopup();else return;Fo(s)}}});wt.addInitHook("addHandler","keyboard",ah),wt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ih=oo.extend({addHooks:function(){it(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){xt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var c=Si(s),p=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var b=Math.max(p-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),b),Fo(s)},_performZoom:function(){var s=this._map,c=s.getZoom(),p=this._map.options.zoomSnap||0;s._stop();var b=this._delta/(this._map.options.wheelPxPerZoomLevel*4),P=4*Math.log(2/(1+Math.exp(-Math.abs(b))))/Math.LN2,q=p?Math.ceil(P/p)*p:P,ae=s._limitZoom(c+(this._delta>0?q:-q))-c;this._delta=0,this._startTime=null,ae&&(s.options.scrollWheelZoom==="center"?s.setZoom(c+ae):s.setZoomAround(this._lastMousePos,c+ae))}});wt.addInitHook("addHandler","scrollWheelZoom",ih);var Mg=600;wt.mergeOptions({tapHold:qe.touchNative&&qe.safari&&qe.mobile,tapTolerance:15});var lh=oo.extend({addHooks:function(){it(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){xt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var c=s.touches[0];this._startPos=this._newPos=new O(c.clientX,c.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(it(document,"touchend",tn),it(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),Mg),it(document,"touchend touchcancel contextmenu",this._cancel,this),it(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){xt(document,"touchend",tn),xt(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),xt(document,"touchend touchcancel contextmenu",this._cancel,this),xt(document,"touchmove",this._onMove,this)},_onMove:function(s){var c=s.touches[0];this._newPos=new O(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,c){var p=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});p._simulated=!0,c.target.dispatchEvent(p)}});wt.addInitHook("addHandler","tapHold",lh),wt.mergeOptions({touchZoom:qe.touch,bounceAtZoomLimits:!0});var rh=oo.extend({addHooks:function(){pt(this._map._container,"leaflet-touch-zoom"),it(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){qt(this._map._container,"leaflet-touch-zoom"),xt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var c=this._map;if(!(!s.touches||s.touches.length!==2||c._animatingZoom||this._zooming)){var p=c.mouseEventToContainerPoint(s.touches[0]),b=c.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(p.add(b)._divideBy(2))),this._startDist=p.distanceTo(b),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),it(document,"touchmove",this._onTouchMove,this),it(document,"touchend touchcancel",this._onTouchEnd,this),tn(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var c=this._map,p=c.mouseEventToContainerPoint(s.touches[0]),b=c.mouseEventToContainerPoint(s.touches[1]),P=p.distanceTo(b)/this._startDist;if(this._zoom=c.getScaleZoom(P,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&P<1||this._zoom>c.getMaxZoom()&&P>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,P===1)return}else{var q=p._add(b)._divideBy(2)._subtract(this._centerPoint);if(P===1&&q.x===0&&q.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(q),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),j(this._animRequest);var ae=l(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=F(ae,this,!0),tn(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,j(this._animRequest),xt(document,"touchmove",this._onTouchMove,this),xt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});wt.addInitHook("addHandler","touchZoom",rh),wt.BoxZoom=nh,wt.DoubleClickZoom=oh,wt.Drag=sh,wt.Keyboard=ah,wt.ScrollWheelZoom=ih,wt.TapHold=lh,wt.TouchZoom=rh,o.Bounds=pe,o.Browser=qe,o.CRS=Q,o.Canvas=Xd,o.Circle=kl,o.CircleMarker=Bi,o.Class=oe,o.Control=gn,o.DivIcon=va,o.DivOverlay=_e,o.DomEvent=qa,o.DomUtil=na,o.Draggable=Io,o.Evented=te,o.FeatureGroup=zo,o.GeoJSON=Vo,o.GridLayer=Ts,o.Handler=oo,o.Icon=ha,o.ImageOverlay=ti,o.LatLng=Ge,o.LatLngBounds=Ze,o.Layer=vo,o.LayerGroup=da,o.LineUtil=Pt,o.Map=wt,o.Marker=Oi,o.Mixin=ra,o.Path=rs,o.Point=O,o.PolyUtil=Ja,o.Polygon=fa,o.Polyline=Ho,o.Popup=at,o.PosAnimation=Ii,o.Projection=ls,o.Rectangle=th,o.Renderer=Ms,o.SVG=Cl,o.SVGOverlay=le,o.TileLayer=$n,o.Tooltip=Mt,o.Transformation=ie,o.Util=Y,o.VideoOverlay=_l,o.bind=l,o.bounds=we,o.canvas=Qd,o.circle=Fc,o.circleMarker=Nc,o.control=no,o.divIcon=Hi,o.extend=n,o.featureGroup=Di,o.geoJSON=kr,o.geoJson=ei,o.gridLayer=ma,o.icon=mr,o.imageOverlay=br,o.latLng=Xe,o.latLngBounds=Ne,o.layerGroup=Pi,o.map=Is,o.marker=Bc,o.point=ne,o.polygon=gr,o.polyline=Uc,o.popup=bt,o.rectangle=Tg,o.setOptions=S,o.stamp=d,o.svg=eh,o.svgOverlay=ge,o.tileLayer=Jd,o.tooltip=_n,o.transformation=z,o.version=a,o.videoOverlay=G;var Ag=window.L;o.noConflict=function(){return window.L=Ag,this},window.L=o}))})(El,El.exports)),El.exports}var bw=kw();const Ft=lg(bw);(function(e,t,o){function a(n,i){for(;(n=n.parentElement)&&!n.classList.contains(i););return n}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(n,i){this._map=n,this._container=n._container,this._overlayPane=n._panes.overlayPane,this._popupPane=n._panes.popupPane,i&&i.shapeOptions&&(i.shapeOptions=L.Util.extend({},this.options.shapeOptions,i.shapeOptions)),L.setOptions(this,i);var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var n=this._map;n&&(L.DomUtil.disableTextSelection(),n.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(n){L.setOptions(this,n)},_fireCreatedEvent:function(n){this._map.fire(L.Draw.Event.CREATED,{layer:n,layerType:this.type})},_cancelDrawing:function(n){n.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(n,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,n,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var n=this._markers.pop(),i=this._poly,l=i.getLatLngs(),u=l.splice(-1,1)[0];this._poly.setLatLngs(l),this._markerGroup.removeLayer(n),i.getLatLngs().length<2&&this._map.removeLayer(i),this._vertexChanged(u,!1)}},addVertex:function(n){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(n))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(n)),this._poly.addLatLng(n),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(n,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var n=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),i=this._poly.newLatLngIntersects(n[n.length-1]);if(!this.options.allowIntersection&&i||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(n){var i=this._map.mouseEventToLayerPoint(n.originalEvent),l=this._map.layerPointToLatLng(i);this._currentLatLng=l,this._updateTooltip(l),this._updateGuide(i),this._mouseMarker.setLatLng(l),L.DomEvent.preventDefault(n.originalEvent)},_vertexChanged:function(n,i){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(n,i),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(n){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(n),this._clickHandled=!0,this._disableNewMarkers();var i=n.originalEvent,l=i.clientX,u=i.clientY;this._startPoint.call(this,l,u)}},_startPoint:function(n,i){this._mouseDownOrigin=L.point(n,i)},_onMouseUp:function(n){var i=n.originalEvent,l=i.clientX,u=i.clientY;this._endPoint.call(this,l,u,n),this._clickHandled=null},_endPoint:function(n,i,l){if(this._mouseDownOrigin){var u=L.point(n,i).distanceTo(this._mouseDownOrigin),d=this._calculateFinishDistance(l.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(l.latlng),this._finishShape()):d<10&&L.Browser.touch?this._finishShape():Math.abs(u)<9*(e.devicePixelRatio||1)&&this.addVertex(l.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(n){var i,l,u=n.originalEvent;!u.touches||!u.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(i=u.touches[0].clientX,l=u.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,i,l),this._endPoint.call(this,i,l,n),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(n){var i;if(this._markers.length>0){var l;if(this.type===L.Draw.Polyline.TYPE)l=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;l=this._markers[0]}var u=this._map.latLngToContainerPoint(l.getLatLng()),d=new L.Marker(n,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),h=this._map.latLngToContainerPoint(d.getLatLng());i=u.distanceTo(h)}else i=1/0;return i},_updateFinishHandler:function(){var n=this._markers.length;n>1&&this._markers[n-1].on("click",this._finishShape,this),n>2&&this._markers[n-2].off("click",this._finishShape,this)},_createMarker:function(n){var i=new L.Marker(n,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(i),i},_updateGuide:function(n){var i=this._markers?this._markers.length:0;i>0&&(n=n||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[i-1].getLatLng()),n))},_updateTooltip:function(n){var i=this._getTooltipText();n&&this._tooltip.updatePosition(n),this._errorShown||this._tooltip.updateContent(i)},_drawGuide:function(n,i){var l,u,d,h=Math.floor(Math.sqrt(Math.pow(i.x-n.x,2)+Math.pow(i.y-n.y,2))),f=this.options.guidelineDistance,m=this.options.maxGuideLineLength,y=h>m?h-m:f;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));y<h;y+=this.options.guidelineDistance)l=y/h,u={x:Math.floor(n.x*(1-l)+l*i.x),y:Math.floor(n.y*(1-l)+l*i.y)},d=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),d.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(d,u)},_updateGuideColor:function(n){if(this._guidesContainer)for(var i=0,l=this._guidesContainer.childNodes.length;i<l;i++)this._guidesContainer.childNodes[i].style.backgroundColor=n},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var n,i,l=this.options.showLength;return this._markers.length===0?n={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(i=l?this._getMeasurementString():"",n=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:i}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:i}),n},_updateRunningMeasure:function(n,i){var l,u,d=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(l=d-(i?2:1),u=L.GeometryUtil.isVersion07x()?n.distanceTo(this._markers[l].getLatLng())*(this.options.factor||1):this._map.distance(n,this._markers[l].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=u*(i?1:-1))},_getMeasurementString:function(){var n,i=this._currentLatLng,l=this._markers[this._markers.length-1].getLatLng();return n=L.GeometryUtil.isVersion07x()?l&&i&&i.distanceTo?this._measurementRunningTotal+i.distanceTo(l)*(this.options.factor||1):this._measurementRunningTotal||0:l&&i?this._measurementRunningTotal+this._map.distance(i,l)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(n,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var n=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,n)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(n,i){L.Draw.Polyline.prototype.initialize.call(this,n,i),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var n=this._markers.length;n===1&&this._markers[0].on("click",this._finishShape,this),n>2&&(this._markers[n-1].on("dblclick",this._finishShape,this),n>3&&this._markers[n-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var n,i;return this._markers.length===0?n=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(n=L.drawLocal.draw.handlers.polygon.tooltip.cont,i=this._getMeasurementString()):(n=L.drawLocal.draw.handlers.polygon.tooltip.end,i=this._getMeasurementString()),{text:n,subtext:i}},_getMeasurementString:function(){var n=this._area,i="";return n||this.options.showLength?(this.options.showLength&&(i=L.Draw.Polyline.prototype._getMeasurementString.call(this)),n&&(i+="<br>"+L.GeometryUtil.readableArea(n,this.options.metric,this.options.precision)),i):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(n,i){var l;!this.options.allowIntersection&&this.options.showArea&&(l=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(l)),L.Draw.Polyline.prototype._vertexChanged.call(this,n,i)},_cleanUpShape:function(){var n=this._markers.length;n>0&&(this._markers[0].off("click",this._finishShape,this),n>2&&this._markers[n-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(n,i){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,n,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(n){this._isDrawing=!0,this._startLatLng=n.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(n.originalEvent)},_onMouseMove:function(n){var i=n.latlng;this._tooltip.updatePosition(i),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(i))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(n,i){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,n,i)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(n){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!a(n.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(n){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,n)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,n),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var n=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,n)},_getTooltipText:function(){var n,i,l,u=L.Draw.SimpleShape.prototype._getTooltipText.call(this),d=this._shape,h=this.options.showArea;return d&&(n=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),i=L.GeometryUtil.geodesicArea(n),l=h?L.GeometryUtil.readableArea(i,this.options.metric):""),{text:u.text,subtext:l}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(n,i){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,n,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(n){var i=n.latlng;this._tooltip.updatePosition(i),this._mouseMarker.setLatLng(i),this._marker?(i=this._mouseMarker.getLatLng(),this._marker.setLatLng(i)):(this._marker=this._createMarker(i),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(n){return new L.Marker(n,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(n){this._onMouseMove(n),this._onClick()},_fireCreatedEvent:function(){var n=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,n)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(n,i){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,n,i)},_fireCreatedEvent:function(){var n=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,n)},_createMarker:function(n){return new L.CircleMarker(n,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(n,i){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,n,i)},_drawShape:function(n){if(L.GeometryUtil.isVersion07x())var i=this._startLatLng.distanceTo(n);else var i=this._map.distance(this._startLatLng,n);this._shape?this._shape.setRadius(i):(this._shape=new L.Circle(this._startLatLng,i,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var n=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,n)},_onMouseMove:function(n){var i,l=n.latlng,u=this.options.showRadius,d=this.options.metric;if(this._tooltip.updatePosition(l),this._isDrawing){this._drawShape(l),i=this._shape.getRadius().toFixed(1);var h="";u&&(h=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(i,d,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:h})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(n,i){this._marker=n,L.setOptions(this,i)},addHooks:function(){var n=this._marker;n.dragging.enable(),n.on("dragend",this._onDragEnd,n),this._toggleMarkerHighlight()},removeHooks:function(){var n=this._marker;n.dragging.disable(),n.off("dragend",this._onDragEnd,n),this._toggleMarkerHighlight()},_onDragEnd:function(n){var i=n.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_toggleMarkerHighlight:function(){var n=this._marker._icon;n&&(n.style.display="none",L.DomUtil.hasClass(n,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(n,"leaflet-edit-marker-selected"),this._offsetMarker(n,-4)):(L.DomUtil.addClass(n,"leaflet-edit-marker-selected"),this._offsetMarker(n,4)),n.style.display="")},_offsetMarker:function(n,i){var l=parseInt(n.style.marginTop,10)-i,u=parseInt(n.style.marginLeft,10)-i;n.style.marginTop=l+"px",n.style.marginLeft=u+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(n){this.latlngs=[n._latlngs],n._holes&&(this.latlngs=this.latlngs.concat(n._holes)),this._poly=n,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(n){for(var i=0;i<this._verticesHandlers.length;i++)n(this._verticesHandlers[i])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(n){n.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(n){n.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(n){n.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var n=0;n<this.latlngs.length;n++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[n],this._poly.options.poly))},_updateLatLngs:function(n){this.latlngs=[n.layer._latlngs],n.layer._holes&&(this.latlngs=this.latlngs.concat(n.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(n,i,l){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=n,l&&l.drawError&&(l.drawError=L.Util.extend({},this.options.drawError,l.drawError)),this._latlngs=i,L.setOptions(this,l)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var n=this._poly,i=n._path;n instanceof L.Polygon||(n.options.fill=!1,n.options.editing&&(n.options.editing.fill=!1)),i&&n.options.editing&&n.options.editing.className&&(n.options.original.className&&n.options.original.className.split(" ").forEach(function(l){L.DomUtil.removeClass(i,l)}),n.options.editing.className.split(" ").forEach(function(l){L.DomUtil.addClass(i,l)})),n.setStyle(n.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var n=this._poly,i=n._path;i&&n.options.editing&&n.options.editing.className&&(n.options.editing.className.split(" ").forEach(function(l){L.DomUtil.removeClass(i,l)}),n.options.original.className&&n.options.original.className.split(" ").forEach(function(l){L.DomUtil.addClass(i,l)})),n.setStyle(n.options.original),n._map&&(n._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var n,i,l,u,d=this._defaultShape();for(n=0,l=d.length;n<l;n++)u=this._createMarker(d[n],n),u.on("click",this._onMarkerClick,this),u.on("contextmenu",this._onContextMenu,this),this._markers.push(u);var h,f;for(n=0,i=l-1;n<l;i=n++)(n!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(h=this._markers[i],f=this._markers[n],this._createMiddleMarker(h,f),this._updatePrevNext(h,f))},_createMarker:function(n,i){var l=new L.Marker.Touch(n,{draggable:!0,icon:this.options.icon});return l._origLatLng=n,l._index=i,l.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(l),l},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var n=this._defaultShape(),i=[].splice.apply(n,arguments);return this._poly._convertLatLngs(n,!0),this._poly.redraw(),i},_removeMarker:function(n){var i=n._index;this._markerGroup.removeLayer(n),this._markers.splice(i,1),this._spliceLatLngs(i,1),this._updateIndexes(i,-1),n.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(n){var i=n.target,l=this._poly,u=L.LatLngUtil.cloneLatLng(i._origLatLng);if(L.extend(i._origLatLng,i._latlng),l.options.poly){var d=l._map._editTooltip;if(!l.options.poly.allowIntersection&&l.intersects()){L.extend(i._origLatLng,u),i.setLatLng(u);var h=l.options.color;l.setStyle({color:this.options.drawError.color}),d&&d.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){l.setStyle({color:h}),d&&d.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}i._middleLeft&&i._middleLeft.setLatLng(this._getMiddleLatLng(i._prev,i)),i._middleRight&&i._middleRight.setLatLng(this._getMiddleLatLng(i,i._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var f=this._poly.getLatLngs();this._poly._convertLatLngs(f,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(n){var i=L.Polygon&&this._poly instanceof L.Polygon?4:3,l=n.target;this._defaultShape().length<i||(this._removeMarker(l),this._updatePrevNext(l._prev,l._next),l._middleLeft&&this._markerGroup.removeLayer(l._middleLeft),l._middleRight&&this._markerGroup.removeLayer(l._middleRight),l._prev&&l._next?this._createMiddleMarker(l._prev,l._next):l._prev?l._next||(l._prev._middleRight=null):l._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(n){var i=n.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:i,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(n){var i=this._map.mouseEventToLayerPoint(n.originalEvent.touches[0]),l=this._map.layerPointToLatLng(i),u=n.target;L.extend(u._origLatLng,l),u._middleLeft&&u._middleLeft.setLatLng(this._getMiddleLatLng(u._prev,u)),u._middleRight&&u._middleRight.setLatLng(this._getMiddleLatLng(u,u._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(n,i){this._markerGroup.eachLayer(function(l){l._index>n&&(l._index+=i)})},_createMiddleMarker:function(n,i){var l,u,d,h=this._getMiddleLatLng(n,i),f=this._createMarker(h);f.setOpacity(.6),n._middleRight=i._middleLeft=f,u=function(){f.off("touchmove",u,this);var m=i._index;f._index=m,f.off("click",l,this).on("click",this._onMarkerClick,this),h.lat=f.getLatLng().lat,h.lng=f.getLatLng().lng,this._spliceLatLngs(m,0,h),this._markers.splice(m,0,f),f.setOpacity(1),this._updateIndexes(m,1),i._index++,this._updatePrevNext(n,f),this._updatePrevNext(f,i),this._poly.fire("editstart")},d=function(){f.off("dragstart",u,this),f.off("dragend",d,this),f.off("touchmove",u,this),this._createMiddleMarker(n,f),this._createMiddleMarker(f,i)},l=function(){u.call(this),d.call(this),this._fireEdit()},f.on("click",l,this).on("dragstart",u,this).on("dragend",d,this).on("touchmove",u,this),this._markerGroup.addLayer(f)},_updatePrevNext:function(n,i){n&&(n._next=i),i&&(i._prev=n)},_getMiddleLatLng:function(n,i){var l=this._poly._map,u=l.project(n.getLatLng()),d=l.project(i.getLatLng());return l.unproject(u._add(d)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(n,i){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=n,L.Util.setOptions(this,i)},addHooks:function(){var n=this._shape;this._shape._map&&(this._map=this._shape._map,n.setStyle(n.options.editing),n._map&&(this._map=n._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var n=this._shape;if(n.setStyle(n.options.original),n._map){this._unbindMarker(this._moveMarker);for(var i=0,l=this._resizeMarkers.length;i<l;i++)this._unbindMarker(this._resizeMarkers[i]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(n,i){var l=new L.Marker.Touch(n,{draggable:!0,icon:i,zIndexOffset:10});return this._bindMarker(l),this._markerGroup.addLayer(l),l},_bindMarker:function(n){n.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(n){n.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(n){n.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(n){var i=n.target,l=i.getLatLng();i===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(n){n.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(n){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,n),typeof this._getCorners=="function"){var i=this._getCorners(),l=n.target,u=l._cornerIndex;l.setOpacity(0),this._oppositeCorner=i[(u+2)%4],this._toggleCornerMarkers(0,u)}this._shape.fire("editstart")},_onTouchMove:function(n){var i=this._map.mouseEventToLayerPoint(n.originalEvent.touches[0]),l=this._map.layerPointToLatLng(i);return n.target===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),!1},_onTouchEnd:function(n){n.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var n=this._shape.getBounds(),i=n.getCenter();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){var n=this._getCorners();this._resizeMarkers=[];for(var i=0,l=n.length;i<l;i++)this._resizeMarkers.push(this._createMarker(n[i],this.options.resizeIcon)),this._resizeMarkers[i]._cornerIndex=i},_onMarkerDragStart:function(n){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,n);var i=this._getCorners(),l=n.target,u=l._cornerIndex;this._oppositeCorner=i[(u+2)%4],this._toggleCornerMarkers(0,u)},_onMarkerDragEnd:function(n){var i,l,u=n.target;u===this._moveMarker&&(i=this._shape.getBounds(),l=i.getCenter(),u.setLatLng(l)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,n)},_move:function(n){for(var i,l=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),u=this._shape.getBounds(),d=u.getCenter(),h=[],f=0,m=l.length;f<m;f++)i=[l[f].lat-d.lat,l[f].lng-d.lng],h.push([n.lat+i[0],n.lng+i[1]]);this._shape.setLatLngs(h),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(n){var i;this._shape.setBounds(L.latLngBounds(n,this._oppositeCorner)),i=this._shape.getBounds(),this._moveMarker.setLatLng(i.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var n=this._shape.getBounds();return[n.getNorthWest(),n.getNorthEast(),n.getSouthEast(),n.getSouthWest()]},_toggleCornerMarkers:function(n){for(var i=0,l=this._resizeMarkers.length;i<l;i++)this._resizeMarkers[i].setOpacity(n)},_repositionCornerMarkers:function(){for(var n=this._getCorners(),i=0,l=this._resizeMarkers.length;i<l;i++)this._resizeMarkers[i].setLatLng(n[i])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var n=this._shape.getLatLng();this._moveMarker=this._createMarker(n,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(n){if(this._resizeMarkers.length){var i=this._getResizeMarkerPoint(n);this._resizeMarkers[0].setLatLng(i)}this._shape.setLatLng(n),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var n=this._shape.getLatLng(),i=this._getResizeMarkerPoint(n);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(i,this.options.resizeIcon))},_getResizeMarkerPoint:function(n){var i=this._shape._radius*Math.cos(Math.PI/4),l=this._map.project(n);return this._map.unproject([l.x+i,l.y-i])},_resize:function(n){var i=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=i.distanceTo(n):radius=this._map.distance(i,n),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(n,i){var l={};if(n.touches!==void 0){if(!n.touches.length)return;l=n.touches[0]}else if(n.pointerType!=="touch"||(l=n,!this._filterClick(n)))return;var u=this._map.mouseEventToContainerPoint(l),d=this._map.mouseEventToLayerPoint(l),h=this._map.layerPointToLatLng(d);this._map.fire(i,{latlng:h,layerPoint:d,containerPoint:u,pageX:l.pageX,pageY:l.pageY,originalEvent:n})},_filterClick:function(n){var i=n.timeStamp||n.originalEvent.timeStamp,l=L.DomEvent._lastClick&&i-L.DomEvent._lastClick;return l&&l>100&&l<500||n.target._simulatedClick&&!n._simulated?(L.DomEvent.stop(n),!1):(L.DomEvent._lastClick=i,!0)},_onTouchStart:function(n){this._map._loaded&&this._touchEvent(n,"touchstart")},_onTouchEnd:function(n){this._map._loaded&&this._touchEvent(n,"touchend")},_onTouchCancel:function(n){if(this._map._loaded){var i="touchcancel";this._detectIE()&&(i="pointercancel"),this._touchEvent(n,i)}},_onTouchLeave:function(n){this._map._loaded&&this._touchEvent(n,"touchleave")},_onTouchMove:function(n){this._map._loaded&&this._touchEvent(n,"touchmove")},_detectIE:function(){var n=e.navigator.userAgent,i=n.indexOf("MSIE ");if(i>0)return parseInt(n.substring(i+5,n.indexOf(".",i)),10);if(n.indexOf("Trident/")>0){var l=n.indexOf("rv:");return parseInt(n.substring(l+3,n.indexOf(".",l)),10)}var u=n.indexOf("Edge/");return u>0&&parseInt(n.substring(u+5,n.indexOf(".",u)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var n=this._icon,i=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?i.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):i.concat(["touchcancel"]),L.DomUtil.addClass(n,"leaflet-clickable"),L.DomEvent.on(n,"click",this._onMouseClick,this),L.DomEvent.on(n,"keypress",this._onKeyPress,this);for(var l=0;l<i.length;l++)L.DomEvent.on(n,i[l],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var n=e.navigator.userAgent,i=n.indexOf("MSIE ");if(i>0)return parseInt(n.substring(i+5,n.indexOf(".",i)),10);if(n.indexOf("Trident/")>0){var l=n.indexOf("rv:");return parseInt(n.substring(l+3,n.indexOf(".",l)),10)}var u=n.indexOf("Edge/");return u>0&&parseInt(n.substring(u+5,n.indexOf(".",u)),10)}}),L.LatLngUtil={cloneLatLngs:function(n){for(var i=[],l=0,u=n.length;l<u;l++)Array.isArray(n[l])?i.push(L.LatLngUtil.cloneLatLngs(n[l])):i.push(this.cloneLatLng(n[l]));return i},cloneLatLng:function(n){return L.latLng(n.lat,n.lng)}},(function(){var n={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(i){var l,u,d=i.length,h=0,f=Math.PI/180;if(d>2){for(var m=0;m<d;m++)l=i[m],u=i[(m+1)%d],h+=(u.lng-l.lng)*f*(2+Math.sin(l.lat*f)+Math.sin(u.lat*f));h=6378137*h*6378137/2}return Math.abs(h)},formattedNumber:function(i,l){var u=parseFloat(i).toFixed(l),d=L.drawLocal.format&&L.drawLocal.format.numeric,h=d&&d.delimiters,f=h&&h.thousands,m=h&&h.decimal;if(f||m){var y=u.split(".");u=f?y[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+f):y[0],m=m||".",y.length>1&&(u=u+m+y[1])}return u},readableArea:function(i,l,f){var d,h,f=L.Util.extend({},n,f);return l?(h=["ha","m"],type=typeof l,type==="string"?h=[l]:type!=="boolean"&&(h=l),d=i>=1e6&&h.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*i,f.km)+" km":i>=1e4&&h.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*i,f.ha)+" ha":L.GeometryUtil.formattedNumber(i,f.m)+" m"):(i/=.836127,d=i>=3097600?L.GeometryUtil.formattedNumber(i/3097600,f.mi)+" mi":i>=4840?L.GeometryUtil.formattedNumber(i/4840,f.ac)+" acres":L.GeometryUtil.formattedNumber(i,f.yd)+" yd"),d},readableDistance:function(i,l,u,d,m){var f,m=L.Util.extend({},n,m);switch(l?typeof l=="string"?l:"metric":u?"feet":d?"nauticalMile":"yards"){case"metric":f=i>1e3?L.GeometryUtil.formattedNumber(i/1e3,m.km)+" km":L.GeometryUtil.formattedNumber(i,m.m)+" m";break;case"feet":i*=3.28083,f=L.GeometryUtil.formattedNumber(i,m.ft)+" ft";break;case"nauticalMile":i*=.53996,f=L.GeometryUtil.formattedNumber(i/1e3,m.nm)+" nm";break;default:i*=1.09361,f=i>1760?L.GeometryUtil.formattedNumber(i/1760,m.mi)+" miles":L.GeometryUtil.formattedNumber(i,m.yd)+" yd"}return f},isVersion07x:function(){var i=L.version.split(".");return parseInt(i[0],10)===0&&parseInt(i[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(n,i,l,u){return this._checkCounterclockwise(n,l,u)!==this._checkCounterclockwise(i,l,u)&&this._checkCounterclockwise(n,i,l)!==this._checkCounterclockwise(n,i,u)},_checkCounterclockwise:function(n,i,l){return(l.y-n.y)*(i.x-n.x)>(i.y-n.y)*(l.x-n.x)}}),L.Polyline.include({intersects:function(){var n,i,l,u=this._getProjectedPoints(),d=u?u.length:0;if(this._tooFewPointsForIntersection())return!1;for(n=d-1;n>=3;n--)if(i=u[n-1],l=u[n],this._lineSegmentsIntersectsRange(i,l,n-2))return!0;return!1},newLatLngIntersects:function(n,i){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(n),i)},newPointIntersects:function(n,i){var l=this._getProjectedPoints(),u=l?l.length:0,d=l?l[u-1]:null,h=u-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(d,n,h,i?1:0)},_tooFewPointsForIntersection:function(n){var i=this._getProjectedPoints(),l=i?i.length:0;return l+=n||0,!i||l<=3},_lineSegmentsIntersectsRange:function(n,i,l,u){var d,h,f=this._getProjectedPoints();u=u||0;for(var m=l;m>u;m--)if(d=f[m-1],h=f[m],L.LineUtil.segmentsIntersect(n,i,d,h))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var n=[],i=this._defaultShape(),l=0;l<i.length;l++)n.push(this._map.latLngToLayerPoint(i[l]));return n}}),L.Polygon.include({intersects:function(){var n,i,l,u,d=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(n=d.length,i=d[0],l=d[n-1],u=n-2,this._lineSegmentsIntersectsRange(l,i,u,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(n){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,n);var i;this._toolbars={},L.DrawToolbar&&this.options.draw&&(i=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=i,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(i=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=i,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(n){var i,l=L.DomUtil.create("div","leaflet-draw"),u=!1;for(var d in this._toolbars)this._toolbars.hasOwnProperty(d)&&(i=this._toolbars[d].addToolbar(n))&&(u||(L.DomUtil.hasClass(i,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(i.childNodes[0],"leaflet-draw-toolbar-top"),u=!0),l.appendChild(i));return l},onRemove:function(){for(var n in this._toolbars)this._toolbars.hasOwnProperty(n)&&this._toolbars[n].removeToolbar()},setDrawingOptions:function(n){for(var i in this._toolbars)this._toolbars[i]instanceof L.DrawToolbar&&this._toolbars[i].setOptions(n)},_toolbarEnabled:function(n){var i=n.target;for(var l in this._toolbars)this._toolbars[l]!==i&&this._toolbars[l].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(n){L.setOptions(this,n),this._modes={},this._actionButtons=[],this._activeMode=null;var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(n){var i,l=L.DomUtil.create("div","leaflet-draw-section"),u=0,d=this._toolbarClass||"",h=this.getModeHandlers(n);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=n,i=0;i<h.length;i++)h[i].enabled&&this._initModeHandler(h[i].handler,this._toolbarContainer,u++,d,h[i].title);if(u)return this._lastButtonIndex=--u,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),l.appendChild(this._toolbarContainer),l.appendChild(this._actionsContainer),l},removeToolbar:function(){for(var n in this._modes)this._modes.hasOwnProperty(n)&&(this._disposeButton(this._modes[n].button,this._modes[n].handler.enable,this._modes[n].handler),this._modes[n].handler.disable(),this._modes[n].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var i=0,l=this._actionButtons.length;i<l;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(n,i,l,u,d){var h=n.type;this._modes[h]={},this._modes[h].handler=n,this._modes[h].button=this._createButton({type:h,title:d,className:u+"-"+h,container:i,callback:this._modes[h].handler.enable,context:this._modes[h].handler}),this._modes[h].buttonIndex=l,this._modes[h].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(n){var i=L.DomUtil.create("a",n.className||"",n.container),l=L.DomUtil.create("span","sr-only",n.container);i.href="#",i.appendChild(l),n.title&&(i.title=n.title,l.innerHTML=n.title),n.text&&(i.innerHTML=n.text,l.innerHTML=n.text);var u=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(i,"click",L.DomEvent.stopPropagation).on(i,"mousedown",L.DomEvent.stopPropagation).on(i,"dblclick",L.DomEvent.stopPropagation).on(i,"touchstart",L.DomEvent.stopPropagation).on(i,"click",L.DomEvent.preventDefault).on(i,u,n.callback,n.context),i},_disposeButton:function(n,i){var l=this._detectIOS()?"touchstart":"click";L.DomEvent.off(n,"click",L.DomEvent.stopPropagation).off(n,"mousedown",L.DomEvent.stopPropagation).off(n,"dblclick",L.DomEvent.stopPropagation).off(n,"touchstart",L.DomEvent.stopPropagation).off(n,"click",L.DomEvent.preventDefault).off(n,l,i)},_handlerActivated:function(n){this.disable(),this._activeMode=this._modes[n.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(n){var i,l,u,d,h=this._actionsContainer,f=this.getActions(n),m=f.length;for(l=0,u=this._actionButtons.length;l<u;l++)this._disposeButton(this._actionButtons[l].button,this._actionButtons[l].callback);for(this._actionButtons=[];h.firstChild;)h.removeChild(h.firstChild);for(var y=0;y<m;y++)"enabled"in f[y]&&!f[y].enabled||(i=L.DomUtil.create("li","",h),d=this._createButton({title:f[y].title,text:f[y].text,container:i,callback:f[y].callback,context:f[y].context}),this._actionButtons.push({button:d,callback:f[y].callback}))},_showActionsToolbar:function(){var n=this._activeMode.buttonIndex,i=this._lastButtonIndex,l=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=l+"px",n===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),n===i&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(n){this._map=n,this._popupPane=n._panes.popupPane,this._visible=!1,this._container=n.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(n){return this._container?(n.subtext=n.subtext||"",n.subtext.length!==0||this._singleLineLabel?n.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(n.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+n.subtext+"</span><br />":"")+"<span>"+n.text+"</span>",n.text||n.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(n){var i=this._map.latLngToLayerPoint(n),l=this._container;return this._container&&(this._visible&&(l.style.visibility="inherit"),L.DomUtil.setPosition(l,i)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(n){for(var i in this.options)this.options.hasOwnProperty(i)&&n[i]&&(n[i]=L.extend({},this.options[i],n[i]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,n)},getModeHandlers:function(n){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(n,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(n,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(n,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(n,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(n,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(n,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(n){return[{enabled:n.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:n.completeShape,context:n},{enabled:n.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:n.deleteLastVertex,context:n},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(n){L.setOptions(this,n);for(var i in this._modes)this._modes.hasOwnProperty(i)&&n.hasOwnProperty(i)&&this._modes[i].handler.setOptions(n[i])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(n){n.edit&&(n.edit.selectedPathOptions===void 0&&(n.edit.selectedPathOptions=this.options.edit.selectedPathOptions),n.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,n.edit.selectedPathOptions)),n.remove&&(n.remove=L.extend({},this.options.remove,n.remove)),n.poly&&(n.poly=L.extend({},this.options.poly,n.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,n),this._selectedFeatureCount=0},getModeHandlers:function(n){var i=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(n,{featureGroup:i,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(n,{featureGroup:i}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(n){var i=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return n.removeAllLayers&&i.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),i},addToolbar:function(n){var i=L.Toolbar.prototype.addToolbar.call(this,n);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),i},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var n,i=this.options.featureGroup,l=i.getLayers().length!==0;this.options.edit&&(n=this._modes[L.EditToolbar.Edit.TYPE].button,l?L.DomUtil.removeClass(n,"leaflet-disabled"):L.DomUtil.addClass(n,"leaflet-disabled"),n.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(n=this._modes[L.EditToolbar.Delete.TYPE].button,l?L.DomUtil.removeClass(n,"leaflet-disabled"):L.DomUtil.addClass(n,"leaflet-disabled"),n.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(n,i){if(L.Handler.prototype.initialize.call(this,n),L.setOptions(this,i),this._featureGroup=i.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var n=this._map;n&&(n.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),n._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(n){this._revertLayer(n)},this)},save:function(){var n=new L.LayerGroup;this._featureGroup.eachLayer(function(i){i.edited&&(n.addLayer(i),i.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:n})},_backupLayer:function(n){var i=L.Util.stamp(n);this._uneditedLayerProps[i]||(n instanceof L.Polyline||n instanceof L.Polygon||n instanceof L.Rectangle?this._uneditedLayerProps[i]={latlngs:L.LatLngUtil.cloneLatLngs(n.getLatLngs())}:n instanceof L.Circle?this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(n.getLatLng()),radius:n.getRadius()}:(n instanceof L.Marker||n instanceof L.CircleMarker)&&(this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(n.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(n){var i=L.Util.stamp(n);n.edited=!1,this._uneditedLayerProps.hasOwnProperty(i)&&(n instanceof L.Polyline||n instanceof L.Polygon||n instanceof L.Rectangle?n.setLatLngs(this._uneditedLayerProps[i].latlngs):n instanceof L.Circle?(n.setLatLng(this._uneditedLayerProps[i].latlng),n.setRadius(this._uneditedLayerProps[i].radius)):(n instanceof L.Marker||n instanceof L.CircleMarker)&&n.setLatLng(this._uneditedLayerProps[i].latlng),n.fire("revert-edited",{layer:n}))},_enableLayerEdit:function(n){var i,l,u=n.layer||n.target||n;this._backupLayer(u),this.options.poly&&(l=L.Util.extend({},this.options.poly),u.options.poly=l),this.options.selectedPathOptions&&(i=L.Util.extend({},this.options.selectedPathOptions),i.maintainColor&&(i.color=u.options.color,i.fillColor=u.options.fillColor),u.options.original=L.extend({},u.options),u.options.editing=i),u instanceof L.Marker?(u.editing&&u.editing.enable(),u.dragging.enable(),u.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):u.editing.enable()},_disableLayerEdit:function(n){var i=n.layer||n.target||n;i.edited=!1,i.editing&&i.editing.disable(),delete i.options.editing,delete i.options.original,this._selectedPathOptions&&(i instanceof L.Marker?this._toggleMarkerHighlight(i):(i.setStyle(i.options.previousOptions),delete i.options.previousOptions)),i instanceof L.Marker?(i.dragging.disable(),i.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):i.editing.disable()},_onMouseMove:function(n){this._tooltip.updatePosition(n.latlng)},_onMarkerDragEnd:function(n){var i=n.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_onTouchMove:function(n){var i=n.originalEvent.changedTouches[0],l=this._map.mouseEventToLayerPoint(i),u=this._map.layerPointToLatLng(l);n.target.setLatLng(u)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(n,i){if(L.Handler.prototype.initialize.call(this,n),L.Util.setOptions(this,i),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var n=this._map;n&&(n.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(n){this._deletableLayers.addLayer(n),n.fire("revert-deleted",{layer:n})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(n){this._removeLayer({layer:n})},this),this.save()},_enableLayerDelete:function(n){(n.layer||n.target||n).on("click",this._removeLayer,this)},_disableLayerDelete:function(n){var i=n.layer||n.target||n;i.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(i)},_removeLayer:function(n){var i=n.layer||n.target||n;this._deletableLayers.removeLayer(i),this._deletedLayers.addLayer(i),i.fire("deleted")},_onMouseMove:function(n){this._tooltip.updatePosition(n.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const rg=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"",Vf=e=>e.length*6+12,uu=(e,t)=>!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom),_w=(e,t)=>{if(!e||t.length===0)return new Set;const o=[],a=e.getBounds();t.forEach(l=>{if(a.contains(l.getLatLng())){const u=e.latLngToContainerPoint(l.getLatLng()),d=l.locationData;d&&o.push({marker:l,pixelPos:u,location:d})}});const n=o.map(({marker:l,pixelPos:u,location:d})=>{const m=Vf(d.name),y=d.description?Vf(`${d.name}: ${rg(d.description,50)}`):m;return{marker:l,location:d,markerBox:{left:u.x-15,right:u.x+15,top:u.y-15,bottom:u.y+15},baseLabelBox:{left:u.x-m/2,right:u.x+m/2,top:u.y+15+2,bottom:u.y+15+2+20},descLabelBox:d.description?{left:u.x-y/2,right:u.x+y/2,top:u.y+15+2,bottom:u.y+15+2+20}:null}}),i=new Set;return n.forEach(({marker:l,location:u,markerBox:d,baseLabelBox:h,descLabelBox:f},m)=>{if(!u.description)return;let y=!1;for(let k=0;k<n.length;k++){if(m===k)continue;const w=n[k];if(uu(f,w.markerBox)||uu(f,w.baseLabelBox)){y=!0;break}if(w.descLabelBox&&i.has(w.location.id)&&uu(f,w.descLabelBox)){y=!0;break}}y||i.add(u.id)}),i},Mr=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"hexagon",label:"Hexagon"},{value:"pentagon",label:"Pentagon"},{value:"diamond",label:"Diamond"},{value:"star",label:"Star"},{value:"dot",label:"Dot"},{value:"none",label:"None"}],ww=[{value:"33",label:"Small (33%)"},{value:"66",label:"Medium (66%)"},{value:"100",label:"Normal (100%)"},{value:"150",label:"Large (150%)"}],ic=[{value:"default",label:"Default",isShapeOnly:!1,category:"default"},{value:"dot",label:"Dot",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"circle",label:"Circle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"square",label:"Square",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"triangle",label:"Triangle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"diamond",label:"Diamond",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"star",label:"Star",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"hexagon",label:"Hexagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"pentagon",label:"Pentagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"car",label:"Car",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"bike",label:"Bike",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"water",label:"Water",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"food",label:"Food",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"medical",label:"Medical",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"photo",label:"Photo",isShapeOnly:!1,category:"content",defaultColor:"#8B5CF6"},{value:"music",label:"Music",isShapeOnly:!1,category:"content",defaultColor:"#EC4899"},{value:"start",label:"Start",isShapeOnly:!1,category:"content",defaultColor:"#10B981"},{value:"finish",label:"Finish",isShapeOnly:!1,category:"content",defaultColor:"#1F2937"},{value:"toilet",label:"Toilet",isShapeOnly:!1,category:"content",defaultColor:"#6366F1"},{value:"shower",label:"Shower",isShapeOnly:!1,category:"content",defaultColor:"#06B6D4"},{value:"bus",label:"Bus",isShapeOnly:!1,category:"content",defaultColor:"#F97316"},{value:"info",label:"Information",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"merch",label:"Merchandise",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"cone",label:"Road closure",isShapeOnly:!1,category:"content",defaultColor:"#FF6B00"},{value:"traffic",label:"Traffic management",isShapeOnly:!1,category:"content",defaultColor:"#374151"},{value:"track",label:"Track",isShapeOnly:!1,category:"content",defaultColor:"#78716C"},{value:"tunnel",label:"Tunnel",isShapeOnly:!1,category:"content",defaultColor:"#57534E"},{value:"bridge",label:"Bridge",isShapeOnly:!1,category:"content",defaultColor:"#0284C7"},{value:"plane",label:"Plane",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"hill",label:"Hill",isShapeOnly:!1,category:"content",defaultColor:"#65A30D"},{value:"baggage",label:"Baggage",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"crown",label:"Crown",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"crossing",label:"Crossing point",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"trees",label:"Trees",isShapeOnly:!1,category:"content",defaultColor:"#22C55E"},{value:"arrow-uturn-left",label:"Left u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-left",label:"Left turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-left",label:"Slight left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-straight",label:"Straight ahead",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-right",label:"Slight right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-right",label:"Right turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-uturn-right",label:"Right u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-left",label:"Left fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-right",label:"Right fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-left",label:"Keep left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-right",label:"Keep right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"}];function gi(e){return ic.find(t=>t.value===e)||ic[0]}function Cw(e){return gi(e).defaultColor||"#667eea"}function Lw(e,t){return t||Cw(e)}const cd={dot:(e,t=32)=>{const o=(t/2-2)*.33;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="1.5"/>
    </svg>`},circle:(e,t=32)=>{const o=t/2-2;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`},square:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect x="4" y="4" width="${t-8}" height="${t-8}" rx="4" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`,triangle:(e,t=32)=>{const o=t/2,a=4,n=t-4,i=4,l=t-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${a} ${l},${n} ${i},${n}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},diamond:(e,t=32)=>{const o=t/2,a=t/2,n=t/2-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${a-n} ${o+n},${a} ${o},${a+n} ${o-n},${a}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},star:(e,t=32)=>{const o=t/2,a=t/2,n=t/2-3,i=n*.4,l=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;l.push(`${o+n*Math.cos(d)},${a+n*Math.sin(d)}`);const h=d+Math.PI/5;l.push(`${o+i*Math.cos(h)},${a+i*Math.sin(h)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${l.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},hexagon:(e,t=32)=>{const o=t/2,a=t/2,n=t/2-4,i=[];for(let l=0;l<6;l++){const u=Math.PI/6+l*Math.PI/3;i.push(`${o+n*Math.cos(u)},${a+n*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},pentagon:(e,t=32)=>{const o=t/2,a=t/2,n=t/2-4,i=[];for(let l=0;l<5;l++){const u=Math.PI/2*-1+l*2*Math.PI/5;i.push(`${o+n*Math.cos(u)},${a+n*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},car:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Car body -->
      <rect x="6" y="13" width="20" height="8" rx="2" fill="#fff"/>
      <!-- Car roof/cabin -->
      <path d="M10 13 L12 9 L20 9 L22 13" fill="#fff" stroke="#fff" stroke-width="1"/>
      <!-- Windows -->
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${e}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${e}"/>
      <!-- Tires (always black) -->
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <!-- Wheel centers -->
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>
    </svg>`,bike:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Tires (same color as bike) -->
      <circle cx="9" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <!-- Wheel centers -->
      <circle cx="9" cy="20" r="1" fill="#fff"/>
      <circle cx="23" cy="20" r="1" fill="#fff"/>
      <!-- Frame -->
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
      <!-- Handlebars -->
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <!-- Seat -->
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="#fff"/>
    </svg>`},Gf={water:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="#fff"/>
    </svg>`,food:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="#fff"/>
      <path d="M21 9v14h2V9h-2z" fill="#fff"/>
    </svg>`,medical:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#fff" stroke-width="2"/>
      <rect x="14" y="8" width="4" height="16" rx="1" fill="#fff"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="#fff"/>
    </svg>`,photo:(e=32)=>{const t="#8B5CF6";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="8" y="10" width="16" height="12" rx="2" fill="#fff"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" y="13" r="1" fill="${t}"/>
    </svg>`},music:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EC4899" stroke="#fff" stroke-width="2"/>
      <path d="M12 22c1.66 0 3-1.34 3-3v-9h5v4h-3v5c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.35 0 .69.07 1 .18V10c0-.55.45-1 1-1h5c.55 0 1 .45 1 1v6h-5v5c0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.7 0 1.37.15 2 .41" fill="#fff"/>
      <ellipse cx="12" cy="21" rx="2.5" ry="2" fill="#fff"/>
      <rect x="14" y="10" width="2" height="9" fill="#fff"/>
      <rect x="14" y="10" width="6" height="2" fill="#fff"/>
    </svg>`,start:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#10B981" stroke="#fff" stroke-width="2"/>
      <path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="#fff"/>
    </svg>`,finish:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#1F2937" stroke="#fff" stroke-width="2"/>
      <rect x="10" y="8" width="4" height="4" fill="#fff"/>
      <rect x="14" y="12" width="4" height="4" fill="#fff"/>
      <rect x="18" y="8" width="4" height="4" fill="#fff"/>
      <rect x="10" y="16" width="4" height="4" fill="#fff"/>
      <rect x="18" y="16" width="4" height="4" fill="#fff"/>
      <rect x="14" y="20" width="4" height="4" fill="#fff"/>
    </svg>`,toilet:(e=32)=>{const t="#6366F1";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="11" y="7" width="10" height="3" rx="1" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>
    </svg>`},shower:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#06B6D4" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="3" fill="#fff"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="#fff"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
    </svg>`,bus:(e=32)=>{const t="#F97316";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="9" y="9" width="14" height="12" rx="2" fill="#fff"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="#fff"/>
      <circle cx="12" cy="21" r="1.5" fill="#fff"/>
      <circle cx="20" cy="21" r="1.5" fill="#fff"/>
    </svg>`},info:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#0EA5E9" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="2" fill="#fff"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="#fff"/>
    </svg>`,merch:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#A855F7" stroke="#fff" stroke-width="2"/>
      <path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="#fff"/>
      <path d="M13 10 L16 7 L19 10" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>`,cone:(e=32)=>{const t="#FF6B00";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L21 22 H11 L16 6Z" fill="#fff"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="#fff"/>
    </svg>`},traffic:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#374151" stroke="#fff" stroke-width="2"/>
      <rect x="12" y="6" width="8" height="20" rx="2" fill="#fff"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>
    </svg>`,crown:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="#fff"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="#fff"/>
    </svg>`,crossing:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="#fff" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="#fff" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="#fff"/>
      <path d="M16 10 L16 16" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
    </svg>`,trees:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#22C55E" stroke="#fff" stroke-width="2"/>
      <!-- Left tree -->
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="#fff"/>
      <!-- Right tree -->
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="#fff"/>
    </svg>`,"arrow-uturn-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on right, curve left, down on left -->
      <path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on left side -->
      <path d="M7 15 L12 21 L17 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="#fff"/>
    </svg>`,"arrow-slight-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-straight":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
    </svg>`,"arrow-slight-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="#fff"/>
    </svg>`,"arrow-uturn-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on left, curve right, down on right -->
      <path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on right side -->
      <path d="M15 15 L20 21 L25 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-fork-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (correct way - with arrow) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M10 12 L6 10 L8 16 Z" fill="#fff"/>
      <!-- Right fork (wrong way - with X) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
    </svg>`,"arrow-fork-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (wrong way - with X) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <!-- Right fork (correct way - with arrow) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M22 12 L26 10 L24 16 Z" fill="#fff"/>
    </svg>`,"arrow-keep-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-keep-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`},Ji={circle:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="14" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,square:({backgroundColor:e,borderColor:t})=>`<rect x="4" y="4" width="24" height="24" rx="4" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,hexagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",a=t==="none"?0:2,n=[];for(let i=0;i<6;i++){const l=Math.PI/6+i*Math.PI/3;n.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${n.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${a}" stroke-linejoin="round"/>`},pentagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",a=t==="none"?0:2,n=[];for(let i=0;i<5;i++){const l=Math.PI/2*-1+i*2*Math.PI/5;n.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${n.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${a}" stroke-linejoin="round"/>`},diamond:({backgroundColor:e,borderColor:t})=>`<polygon points="16,4 28,16 16,28 4,16" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}" stroke-linejoin="round"/>`,star:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",a=t==="none"?0:2,n=13,i=n*.4,l=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;l.push(`${16+n*Math.cos(d)},${16+n*Math.sin(d)}`);const h=d+Math.PI/5;l.push(`${16+i*Math.cos(h)},${16+i*Math.sin(h)}`)}return`<polygon points="${l.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${a}" stroke-linejoin="round"/>`},dot:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="5" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:1.5}"/>`,none:()=>""},qf={water:(e="#fff")=>`<path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="${e}"/>`,food:(e="#fff")=>`<path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="${e}"/>
      <path d="M21 9v14h2V9h-2z" fill="${e}"/>`,medical:(e="#fff")=>`<rect x="14" y="8" width="4" height="16" rx="1" fill="${e}"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="${e}"/>`,photo:(e="#fff",t="#667eea")=>`<rect x="8" y="10" width="16" height="12" rx="2" fill="${e}"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" cy="13" r="1" fill="${t}"/>`,music:(e="#fff")=>`<ellipse cx="12" cy="21" rx="2.5" ry="2" fill="${e}"/>
      <rect x="14" y="10" width="2" height="9" fill="${e}"/>
      <rect x="14" y="10" width="6" height="2" fill="${e}"/>`,start:(e="#fff")=>`<path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="${e}"/>`,finish:(e="#fff")=>`<rect x="10" y="8" width="4" height="4" fill="${e}"/>
      <rect x="14" y="12" width="4" height="4" fill="${e}"/>
      <rect x="18" y="8" width="4" height="4" fill="${e}"/>
      <rect x="10" y="16" width="4" height="4" fill="${e}"/>
      <rect x="18" y="16" width="4" height="4" fill="${e}"/>
      <rect x="14" y="20" width="4" height="4" fill="${e}"/>`,toilet:(e="#fff",t="#667eea")=>`<rect x="11" y="7" width="10" height="3" rx="1" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="${e}" stroke-width="2" fill="none" stroke-linecap="round"/>`,shower:(e="#fff")=>`<circle cx="16" cy="10" r="3" fill="${e}"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="${e}"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>`,bus:(e="#fff",t="#667eea")=>`<rect x="9" y="9" width="14" height="12" rx="2" fill="${e}"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="${e}"/>
      <circle cx="12" cy="21" r="1.5" fill="${e}"/>
      <circle cx="20" cy="21" r="1.5" fill="${e}"/>`,info:(e="#fff")=>`<circle cx="16" cy="10" r="2" fill="${e}"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="${e}"/>`,merch:(e="#fff")=>`<path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="${e}"/>
      <path d="M13 10 L16 7 L19 10" stroke="${e}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`,cone:(e="#fff",t="#667eea")=>`<path d="M16 6 L21 22 H11 L16 6Z" fill="${e}"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="${e}"/>`,traffic:(e="#fff")=>`<rect x="12" y="6" width="8" height="20" rx="2" fill="${e}"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>`,car:(e="#fff",t="#667eea")=>`<rect x="6" y="13" width="20" height="8" rx="2" fill="${e}"/>
      <path d="M10 13 L12 9 L20 9 L22 13" fill="${e}" stroke="${e}" stroke-width="1"/>
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${t}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${t}"/>
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>`,bike:(e="#fff")=>`<circle cx="9" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="9" cy="20" r="1" fill="${e}"/>
      <circle cx="23" cy="20" r="1" fill="${e}"/>
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="${e}" stroke-width="2" stroke-linejoin="round"/>
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="${e}"/>`,"arrow-uturn-left":(e="#fff")=>`<path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7 15 L12 21 L17 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-left":(e="#fff")=>`<path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="${e}"/>`,"arrow-slight-left":(e="#fff")=>`<g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-straight":(e="#fff")=>`<path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>`,"arrow-slight-right":(e="#fff")=>`<g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-right":(e="#fff")=>`<path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="${e}"/>`,"arrow-uturn-right":(e="#fff")=>`<path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 15 L20 21 L25 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-fork-left":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Left arrowhead -->
      <path d="M10 12 L6 10 L8 16 Z" fill="${e}"/>
      <!-- Wrong way indicator on right -->
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>`,"arrow-fork-right":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <!-- Wrong way indicator on left -->
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Right arrowhead -->
      <path d="M22 12 L26 10 L24 16 Z" fill="${e}"/>`,"arrow-keep-left":(e="#fff")=>`<g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-keep-right":(e="#fff")=>`<g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,track:(e="#fff")=>`
      <rect x="10" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="19.5" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="8" y="9" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="14.5" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="20" width="16" height="2.5" rx="0.5" fill="${e}"/>`,tunnel:(e="#fff")=>`
      <path d="M7 25 L7 14 C7 8 11 5 16 5 C21 5 25 8 25 14 L25 25" fill="none" stroke="${e}" stroke-width="2.5"/>
      <path d="M11 25 L11 16 C11 12 13 10 16 10 C19 10 21 12 21 16 L21 25" fill="none" stroke="${e}" stroke-width="1.5" opacity="0.6"/>`,bridge:(e="#fff")=>`
      <rect x="5" y="18" width="22" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="7" y="10" width="2" height="8" fill="${e}"/>
      <rect x="23" y="10" width="2" height="8" fill="${e}"/>
      <path d="M8 10 Q16 6 24 10" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <line x1="12" y1="13" x2="12" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="16" y1="11.5" x2="16" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="20" y1="13" x2="20" y2="18" stroke="${e}" stroke-width="1.5"/>`,plane:(e="#fff")=>`
      <g fill="${e}">
        <!-- Fuselage body -->
        <path d="M27 16 L24 14 L8 14 Q4 16 8 18 L24 18 L27 16 Z"/>
        <!-- Nose cone -->
        <path d="M8 14 Q4 16 8 18 L8 14 Z"/>
        <!-- Tail fin -->
        <path d="M26 14 L26 9 L22 14 Z"/>
        <!-- Main wing -->
        <path d="M20 16 L16 10 L14 10 L16 16 L14 22 L16 22 L20 16 Z"/>
        <!-- Cockpit window -->
        <ellipse cx="10" cy="16" rx="1.5" ry="1" fill="none" stroke="${e}" stroke-width="0.5" opacity="0.6"/>
      </g>`,hill:(e="#fff")=>`
      <path d="M6 24 L13 12 L16 16 L20 10 L26 24 Z" fill="${e}"/>
      <path d="M20 10 L22 13 L18 13 Z" fill="${e}" opacity="0.6"/>`,baggage:(e="#fff")=>`
      <rect x="8" y="12" width="16" height="12" rx="2" fill="${e}"/>
      <rect x="12" y="8" width="8" height="4" rx="1" fill="none" stroke="${e}" stroke-width="2"/>
      <line x1="12" y1="16" x2="20" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
      <line x1="12" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>`,crown:(e="#fff")=>`
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="${e}"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="${e}"/>`,crossing:(e="#fff")=>`
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="${e}" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="${e}" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="${e}"/>
      <path d="M16 10 L16 16" stroke="${e}" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>`,trees:(e="#fff")=>`
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="${e}"/>
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="${e}"/>`};function Tn({type:e,backgroundShape:t="circle",backgroundColor:o,borderColor:a,iconColor:n,size:i="100",outputSize:l=null}){if(!e||e==="default"){if(!(o||a||n||t&&t!=="circle"&&t!=="default"))return null;e=t&&t!=="default"?t:"circle"}const u=gi(e),d=parseInt(i,10)/100,h=l||Math.round(32*d);let f="";if(u.isShapeOnly){const m=o||u.defaultColor||"#667eea",y=a||"#fff";if(Ji[e])f=Ji[e]({backgroundColor:m,borderColor:y});else return cd[e]?.(m,h)||null}else{const m=o||"#667eea",y=a||"#fff",k=n||"#fff",w=t||"circle";w!=="none"&&Ji[w]&&(f+=Ji[w]({backgroundColor:m,borderColor:y})),qf[e]&&(f+=qf[e](k,m))}return`<svg width="${h}" height="${h}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
    ${f}
  </svg>`}const Sw={full:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#10B981" stroke="#fff" stroke-width="1.5"/>
    <path d="M4 7l2 2 4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </svg>`,partial:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#F59E0B" stroke="#fff" stroke-width="1.5"/>
    <rect x="6" y="3.5" width="2" height="4.5" rx="1" fill="#fff"/>
    <circle cx="7" cy="10" r="1" fill="#fff"/>
  </svg>`,missing:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#EF4444" stroke="#fff" stroke-width="1.5"/>
    <path d="M4.5 4.5l5 5M9.5 4.5l-5 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
  </svg>`};function Iw(e,t){return e===0?"missing":e>=t?"full":"partial"}function ud(e,t){const o=Iw(e,t);return Sw[o]}function xw(e,t,o=32){if(e==="default")return null;if(Gf[e])return Gf[e](o);if(cd[e]){const a=t||"#667eea";return cd[e](a,o)}return null}const $w=["circle","square","hexagon","pentagon"];function Tw(e){return $w.includes(e)}function Mw(e,t,o,a,n=32,i=!0){const l=xw(e,t,n),u=ud(o,a);if(!l)return null;const d=i&&Tw(e),h=Lw(e,t),f=Ew(h),m=cg(h)?"0 1px 2px rgba(255,255,255,0.5)":"0 1px 2px rgba(0,0,0,0.5)",y=n>=36?"12px":"10px",k=d?`
    <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: ${f};
      font-weight: bold;
      font-size: ${y};
      text-shadow: ${m};
      pointer-events: none;
    ">${o}/${a}</div>
  `:"";return`
    <div style="position: relative; width: ${n}px; height: ${n}px;">
      ${l}
      ${k}
      <div style="position: absolute; bottom: -4px; right: -4px;">
        ${u}
      </div>
    </div>
  `}function Aw(e){const t=e.replace("#",""),o=parseInt(t.substr(0,2),16)/255,a=parseInt(t.substr(2,2),16)/255,n=parseInt(t.substr(4,2),16)/255,i=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),l=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),u=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4);return .2126*i+.7152*l+.0722*u}function cg(e){return!e||e.length<6?!1:Aw(e)>.4}function Ew(e){return cg(e)?"#1F2937":"#FFFFFF"}const Pw={class:"map-container-wrapper"},Dw="#667eea",Rw={__name:"MapView",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},clickable:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1},editingPolygon:{type:Array,default:null},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","polygon-complete","polygon-drawing","polygon-update","visibility-change"],setup(e,{expose:t,emit:o}){const a=e,n=o,i=A(null);let l=null;const u=A([]),d=A([]),h=A([]);let f=null,m=null;const y=A([]);let k=null,w=null,S=!1;const T=A(!1),x=()=>{if(l){const xe=l.getCenter();return{lat:xe.lat,lng:xe.lng}}return null},C=()=>l?l.getZoom():null,_=()=>{if(u.value.length>0){h.value.push([...u.value]);const xe=d.value.pop()||[];u.value=xe,Ee(),n("polygon-drawing",u.value)}},$=()=>{if(h.value.length>0){d.value.push([...u.value]);const xe=h.value.pop();u.value=xe,Ee(),n("polygon-drawing",u.value)}},M=()=>u.value.length>0,H=()=>h.value.length>0,E=()=>u.value.length,B=()=>{u.value.length>=3&&(n("polygon-complete",[...u.value]),R())},R=()=>{u.value=[],d.value=[],h.value=[],Ee()},U=()=>{!l||!a.userLocation||(l.setView([a.userLocation.lat,a.userLocation.lng],l.getZoom(),{animate:!0,duration:.5}),T.value=!0)},F=(xe,be,de=null)=>{if(!l||xe==null||be==null)return;l.setView([xe,be],de??l.getZoom(),{animate:!0,duration:.5});const fe=a.center&&Math.abs(a.center.lat-xe)<1e-4&&Math.abs(a.center.lng-be)<1e-4;T.value=!fe},j=A(!0),Y=A(!0),oe=(xe,be)=>{if(!l||xe==null||be==null)return!0;const de=l.getBounds(),fe=Ft.latLng(xe,be);return de.contains(fe)};t({getMapCenter:x,getMapZoom:C,undoPolygonPoint:_,redoPolygonPoint:$,canUndo:M,canRedo:H,getPolygonPointCount:E,completePolygon:B,clearPolygonDrawing:R,recenterOnUserLocation:U,recenterOnLocation:F,isLocationInView:oe,userLocationInView:Y,highlightedLocationInView:j});const Oe=A([]);let ee=null;const te=A(!0),O=A(!1),Z=A(new Set),ne=A([]);let pe=null,we=null;const Ze=V(()=>a.hideRecenterButton||!a.highlightLocationId||!T.value?!1:!j.value),Ne=A({}),Ge=()=>{const xe={};if(a.highlightLocationId){const be=a.locations.find(de=>de.id===a.highlightLocationId);if(be?.latitude&&be?.longitude){const de=oe(be.latitude,be.longitude);j.value=de,xe[a.highlightLocationId]=de,Ne.value=xe;return}}if(a.highlightLocationIds&&a.highlightLocationIds.length>0){let be=!0;for(const de of a.highlightLocationIds){const fe=a.locations.find(W=>W.id===de);if(fe?.latitude&&fe?.longitude){const W=oe(fe.latitude,fe.longitude);xe[de]=W,W||(be=!1)}else xe[de]=!0}j.value=be,Ne.value=xe;return}if(!l){j.value=!0,Ne.value={};return}j.value=!0,Ne.value={}},Xe=()=>{if(!l||!a.userLocation){Y.value=!0;return}Y.value=oe(a.userLocation.lat,a.userLocation.lng)},Q=()=>{Ge(),Xe(),n("visibility-change",{userLocationInView:Y.value,highlightedLocationInView:j.value,highlightedLocationsVisibility:Ne.value})},ye=()=>{if(!l||!a.highlightLocationId)return;const xe=a.locations.find(be=>be.id===a.highlightLocationId);!xe||!xe.latitude||!xe.longitude||(l.setView([xe.latitude,xe.longitude],l.getZoom(),{animate:!0,duration:.5}),T.value=!1,j.value=!0)},Ce=(xe,be,de,fe,W=!1)=>{const J=de?"36px":fe?"20px":"30px",re=de?"#667eea":"white",je=W?"":ud(xe,be);return`
    <div style="position: relative; width: ${J}; height: ${J};">
      <div style="
        background-color: ${Dw};
        width: ${J};
        height: ${J};
        border-radius: 50%;
        border: 3px solid ${re};
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      "></div>
      ${W?"":`<div style="position: absolute; bottom: -4px; right: -4px;">
        ${je}
      </div>`}
    </div>
  `},me=()=>{if(!l)return;const xe=_w(l,Oe.value),be=Array.from(Z.value).sort().join(","),de=Array.from(xe).sort().join(",");be!==de&&(Z.value=xe,Te())},ie=()=>{if(we&&(we.remove(),we=null),!l||!a.userLocation)return;const xe=Ft.divIcon({className:"user-location-marker",html:`
      <div style="
        position: relative;
        width: 20px;
        height: 20px;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #4285f4;
          border: 3px solid white;
          border-radius: 50%;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        "></div>
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 40px;
          height: 40px;
          background-color: rgba(66, 133, 244, 0.2);
          border-radius: 50%;
          animation: pulse 2s ease-out infinite;
        "></div>
      </div>
    `,iconSize:[40,40],iconAnchor:[20,20]});we=Ft.marker([a.userLocation.lat,a.userLocation.lng],{icon:xe}).addTo(l).bindPopup("Your location")},z=()=>{if(!i.value)return;let xe=51.505,be=-.09,de=13;const fe=a.allLocationsForBounds.length>0?a.allLocationsForBounds:a.locations,W=(re,je)=>re!=null&&je!=null&&!(re===0&&je===0),J=[];fe.length>0&&J.push(...fe.filter(re=>W(re.latitude,re.longitude)).map(re=>({lat:re.latitude,lng:re.longitude}))),a.route&&a.route.length>0&&J.push(...a.route.filter(re=>W(re.lat,re.lng)).map(re=>({lat:re.lat,lng:re.lng}))),a.center?(xe=a.center.lat,be=a.center.lng,de=a.zoom??13):J.length>0&&(xe=J.reduce((re,je)=>re+je.lat,0)/J.length,be=J.reduce((re,je)=>re+je.lng,0)/J.length,de=10),l=Ft.map(i.value,{markerZoomAnimation:!1,fadeAnimation:!1}).setView([xe,be],de),Ft.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(l),a.clickable&&l.on("click",re=>{a.drawingMode||n("map-click",{lat:re.latlng.lat,lng:re.latlng.lng})}),l.on("zoomstart",()=>{he=!0}),l.on("zoomend moveend",()=>{he=!1,X?Te():me(),Q()}),l.on("dragstart",()=>{T.value=!0}),Te(),K(),se(),ie(),Se(),Re(),l.whenReady(()=>{Q()})},K=()=>{if(ee&&(ee.remove(),ee=null),!l||a.route.length===0)return;const xe=a.route.map(be=>[be.lat,be.lng]);ee=Ft.polyline(xe,{color:"blue",weight:4,opacity:.7}).addTo(l)},se=()=>{ne.value.forEach(xe=>xe.remove()),ne.value=[],!(!l||a.areas.length===0)&&a.areas.forEach(xe=>{const be=typeof xe.polygon=="string"?JSON.parse(xe.polygon):xe.polygon;if(!be||be.length===0)return;const de=be.map(re=>[re.lat,re.lng]),fe=xe.id===a.selectedAreaId,W=xe.color||"#667eea",J=Ft.polygon(de,{color:W,fillColor:W,fillOpacity:fe?.4:.2,weight:fe?3:2,opacity:.8}).addTo(l);J.setStyle({pane:"overlayPane"}),a.drawingMode||(J.on("click",()=>n("area-click",xe)),J.on("mouseover",()=>{J.setStyle({fillOpacity:.4})}),J.on("mouseout",()=>{J.setStyle({fillOpacity:fe?.4:.2})})),ne.value.push(J)})},Ee=()=>{if(l&&(f&&(f.remove(),f=null),m&&(m.remove(),m=null),u.value.length!==0&&(m=Ft.layerGroup().addTo(l),u.value.forEach((xe,be)=>{const de=be===0,fe=be===u.value.length-1,W=Ft.divIcon({className:"polygon-point-marker",html:`<div style="
        width: ${de?"16px":"12px"};
        height: ${de?"16px":"12px"};
        background-color: ${de?"#667eea":fe?"#ff9800":"white"};
        border: 3px solid #667eea;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      "></div>`,iconSize:[de?16:12,de?16:12],iconAnchor:[de?8:6,de?8:6]});Ft.marker([xe.lat,xe.lng],{icon:W,interactive:!1}).addTo(m)}),u.value.length>=2))){const xe=u.value.map(be=>[be.lat,be.lng]);u.value.length>=3&&xe.push(xe[0]),f=Ft.polyline(xe,{color:"#667eea",weight:3,opacity:.8,dashArray:u.value.length<3?"10, 10":null}).addTo(l)}},Be=()=>{if(!l||(k&&(k.remove(),k=null),w&&(w.remove(),w=null),y.value.length===0))return;const xe=y.value.map(de=>[de.lat,de.lng]);k=Ft.polygon(xe,{color:"#667eea",fillColor:"#667eea",fillOpacity:.2,weight:3,opacity:.8,pane:"overlayPane"}).addTo(l),k.bringToFront(),w=Ft.layerGroup({pane:"markerPane"}).addTo(l);const be=de=>{y.value.length<=3||(y.value.splice(de,1),S=!0,n("polygon-update",[...y.value]),Be())};y.value.forEach((de,fe)=>{const W=y.value.length>3,J=Ft.divIcon({className:"polygon-edit-marker",html:`<div class="vertex-marker" style="
        position: relative;
        width: 16px;
        height: 16px;
        background-color: #667eea;
        border: 3px solid white;
        border-radius: 50%;
        box-shadow: 0 2px 6px rgba(0,0,0,0.4);
        cursor: move;
      "></div>`,iconSize:[16,16],iconAnchor:[8,8]}),re=Ft.marker([de.lat,de.lng],{icon:J,draggable:!0}).addTo(w);if(re.on("drag",je=>{const et=je.target.getLatLng();y.value[fe]={lat:et.lat,lng:et.lng};const dt=y.value.map(kt=>[kt.lat,kt.lng]);k.setLatLngs(dt)}),re.on("dragend",()=>{S=!0,n("polygon-update",[...y.value])}),re.on("contextmenu",je=>{Ft.DomEvent.preventDefault(je),W&&be(fe)}),W){const je=document.createElement("div"),et=document.createElement("button");et.textContent="Delete point",et.style.cssText=`
        background: #dc3545;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9rem;
      `;const dt=kt=>{kt.preventDefault(),kt.stopPropagation(),re.closePopup(),be(fe)};et.addEventListener("click",dt),et.addEventListener("touchend",dt),je.appendChild(et),re.bindPopup(je,{closeButton:!1,className:"vertex-popup"})}})},Re=(xe=!0)=>{if(l){if(!a.editingPolygon||a.editingPolygon.length===0){k&&(k.remove(),k=null),w&&(w.remove(),w=null),y.value=[];return}if(y.value=a.editingPolygon.map(be=>({lat:be.lat,lng:be.lng})),Be(),xe&&y.value.length>=3){const be=Ft.latLngBounds(y.value.map(de=>[de.lat,de.lng]));l.fitBounds(be,{padding:[50,50]})}}},Se=()=>{if(!l)return;if(pe||(pe=new Ft.FeatureGroup,l.addLayer(pe)),l._customDrawingHandlers&&(l.off("click",l._customDrawingHandlers.handleClick),l.getContainer().removeEventListener("touchstart",l._customDrawingHandlers.handleTouchStart),l.getContainer().removeEventListener("touchend",l._customDrawingHandlers.handleTouchEnd),l.getContainer().removeEventListener("touchmove",l._customDrawingHandlers.handleTouchMove),delete l._customDrawingHandlers),!a.drawingMode){R(),pe&&pe.clearLayers();return}let xe=0,be=null,de=!1,fe=!1;const W=300,J=15,re=gt=>{d.value.push([...u.value]),h.value=[],u.value.push({lat:gt.lat,lng:gt.lng}),Ee(),n("polygon-drawing",u.value)},je=gt=>{gt.originalEvent&&gt.originalEvent.sourceCapabilities?.firesTouchEvents||re(gt.latlng)},et=gt=>{if(gt.touches.length>1){fe=!0;return}fe=!1,xe=Date.now(),be={x:gt.touches[0].clientX,y:gt.touches[0].clientY},de=!1},dt=gt=>{if(!be||fe)return;const St=gt.touches[0].clientX-be.x,Lt=gt.touches[0].clientY-be.y;Math.sqrt(St*St+Lt*Lt)>J&&(de=!0)},kt=gt=>{if(fe){fe=!1,be=null;return}if(Date.now()-xe<W&&!de&&be){const Lt=gt.changedTouches[0],Dt=Ft.point(Lt.clientX-l.getContainer().getBoundingClientRect().left,Lt.clientY-l.getContainer().getBoundingClientRect().top),Vt=l.containerPointToLatLng(Dt);gt.preventDefault(),gt.stopPropagation(),re(Vt)}be=null,de=!1};l.on("click",je),l.getContainer().addEventListener("touchstart",et,{passive:!0}),l.getContainer().addEventListener("touchmove",dt,{passive:!0}),l.getContainer().addEventListener("touchend",kt,{passive:!1}),l._customDrawingHandlers={handleClick:je,handleTouchStart:et,handleTouchMove:dt,handleTouchEnd:kt},Ee()};let X=!1,he=!1;const Te=()=>{if(l&&(l._animatingZoom||he)){X=!0;return}if(X=!1,Oe.value.forEach(de=>{de._map&&(de.off(),de.remove())}),Oe.value=[],!l)return;const xe=i.value?.clientWidth||400,be=Math.floor(xe*.75);if(a.locations.forEach(de=>{const fe=de.latitude??de.Latitude,W=de.longitude??de.Longitude;if(fe==null||W==null||fe===0&&W===0)return;const J=de.checkedInCount||0,re=de.requiredMarshals||1,je=a.highlightLocationId===de.id||a.highlightLocationIds.includes(de.id),et=de.isDynamic||de.IsDynamic,dt=a.simplifyNonHighlighted&&!je&&!et,kt=de.resolvedStyleType||de.ResolvedStyleType,gt=de.resolvedStyleBackgroundColor||de.ResolvedStyleBackgroundColor||de.resolvedStyleColor||de.ResolvedStyleColor,St=de.resolvedStyleBorderColor||de.ResolvedStyleBorderColor,Lt=de.resolvedStyleIconColor||de.ResolvedStyleIconColor,Dt=de.resolvedStyleBackgroundShape||de.ResolvedStyleBackgroundShape,Vt=kt&&kt!=="default"||gt||St||Lt||Dt&&Dt!=="circle"&&Dt!=="default",ht=de.resolvedStyleMapRotation??de.ResolvedStyleMapRotation??de.styleMapRotation??de.StyleMapRotation??0,Gt=parseInt(ht,10)||0,pn=de.areaColor||"#999",Et=de.areaId&&!a.marshalMode,Vn=Z.value.has(de.id)&&de.description?`${de.name}: ${rg(de.description,50)}`:de.name,kn=je?`
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid #667eea;
        border-radius: 50%;
        animation: highlight-pulse 1.5s ease-out infinite;
      "></div>
    `:"",Qn=je?"#667eea":dt?"#e0e0e0":"white",co=je?"white":dt?"#888":"#333";let Wt;if(dt){const qe="20px";Wt=`
        <div style="
          background-color: #999;
          width: ${qe};
          height: ${qe};
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        "></div>
      `}const ns=!a.marshalMode,Sn=ud(J,re),bo=ns?`<div style="
      position: absolute;
      bottom: -2px;
      right: -6px;
      background-color: white;
      border-radius: 8px;
      padding: 1px 4px;
      font-size: 9px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    ">${J}/${re}</div>`:"";if(!dt&&Vt){const qe=je?40:32,Tt=de.resolvedStyleSize||de.ResolvedStyleSize||"100",Kt=Tn({type:de.resolvedStyleType||de.ResolvedStyleType,backgroundShape:de.resolvedStyleBackgroundShape||de.ResolvedStyleBackgroundShape||"circle",backgroundColor:de.resolvedStyleBackgroundColor||de.ResolvedStyleBackgroundColor||de.resolvedStyleColor||de.ResolvedStyleColor||"",borderColor:de.resolvedStyleBorderColor||de.ResolvedStyleBorderColor||"",iconColor:de.resolvedStyleIconColor||de.ResolvedStyleIconColor||"",size:Tt});Kt?Wt=Kt:Wt=Mw(de.resolvedStyleType,de.resolvedStyleColor,J,re,qe,ns)||Ce(J,re,je,a.marshalMode,!0)}else dt||(Wt=Ce(J,re,je,a.marshalMode,!0));const ce=Gt!==0?`transform: rotate(${Gt}deg);`:"",ue=Ft.divIcon({className:"custom-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
          ${kn}
          <div style="position: relative; display: flex; align-items: center; gap: 4px;">
            ${Et?`<div style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background-color: ${pn};
              border: 2px solid white;
              box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            "></div>`:""}
            <div style="position: relative; display: inline-block;">
              <div style="${ce}">
                ${Wt}
              </div>
              ${dt||a.marshalMode?"":`<div style="position: absolute; top: -4px; right: -4px;">
                ${Sn}
              </div>`}
              ${dt?"":bo}
            </div>
          </div>
          <div style="
            background-color: ${Qn};
            padding: 2px 6px;
            border-radius: 3px;
            font-size: ${je?"12px":"11px"};
            font-weight: bold;
            color: ${co};
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: ${be}px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${Vn}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]}),ke=a.marshalMode?`<b>${de.name}</b>${de.description?`<br>${de.description}`:""}`:`<b>${de.name}</b><br>${de.description||""}<br>Checked in: ${J}/${re}`,st=Ft.marker([de.latitude,de.longitude],{icon:ue}).addTo(l).bindPopup(ke);st.on("click",()=>{n("location-click",de)}),st.locationData=de,Oe.value.push(st)}),l&&te.value&&!a.center&&!O.value){const de=[],fe=a.allLocationsForBounds.length>0?a.allLocationsForBounds:a.locations,W=(J,re)=>J!=null&&re!=null&&!(J===0&&re===0);if(fe.length>0&&de.push(...fe.filter(J=>W(J.latitude,J.longitude)).map(J=>[J.latitude,J.longitude])),a.route.length>0&&de.push(...a.route.filter(J=>W(J.lat,J.lng)).map(J=>[J.lat,J.lng])),de.length>0){const J=Ft.latLngBounds(de);l.fitBounds(J,{padding:[50,50]}),te.value=!1,O.value=!0}}else a.center&&(te.value=!1);setTimeout(()=>{l&&!l._animatingZoom&&me()},100)};return ln(()=>{O.value=!1,te.value=!0,z();let xe,be=0,de=0;const fe=new ResizeObserver(W=>{if(l&&W.length>0){const{width:J,height:re}=W[0].contentRect;(Math.abs(J-be)>10||Math.abs(re-de)>10)&&(be=J,de=re,clearTimeout(xe),xe=setTimeout(()=>{l.invalidateSize()},150))}});i.value&&fe.observe(i.value),Ln(()=>{clearTimeout(xe),fe.disconnect()})}),We(()=>a.locations,xe=>{if(Te(),l&&!O.value&&xe.length>0&&!a.center){const be=xe.map(J=>J.latitude),de=xe.map(J=>J.longitude),fe=be.reduce((J,re)=>J+re,0)/be.length,W=de.reduce((J,re)=>J+re,0)/de.length;l.setView([fe,W],10),O.value=!0,te.value=!1}l&&setTimeout(()=>Q(),50)},{deep:!0}),We(()=>a.route,xe=>{if(K(),Te(),l&&!O.value&&xe&&xe.length>0&&!a.center){const be=xe.map(J=>J.lat),de=xe.map(J=>J.lng),fe=be.reduce((J,re)=>J+re,0)/be.length,W=de.reduce((J,re)=>J+re,0)/de.length;l.setView([fe,W],10),O.value=!0,te.value=!1}},{deep:!0}),We(()=>a.center,(xe,be)=>{l&&!T.value&&(!be||Math.abs(xe.lat-be.lat)>1e-6||Math.abs(xe.lng-be.lng)>1e-6)&&l.setView([xe.lat,xe.lng],a.zoom)}),We(()=>a.areas,()=>{se()},{deep:!0}),We(()=>a.selectedAreaId,()=>{se()}),We(()=>a.drawingMode,()=>{Se()}),We(()=>a.editingPolygon,()=>{if(S){S=!1;return}Re()},{deep:!0}),We(()=>a.userLocation,()=>{ie()},{deep:!0}),We(()=>a.highlightLocationId,()=>{Te()}),We(()=>a.highlightLocationIds,()=>{Te(),l&&setTimeout(()=>Q(),50)},{deep:!0}),We(()=>a.marshalMode,()=>{Te()}),We(()=>a.simplifyNonHighlighted,()=>{Te()}),We(()=>a.clickable,xe=>{l&&(l.off("click"),xe&&l.on("click",be=>{a.drawingMode||n("map-click",{lat:be.latlng.lat,lng:be.latlng.lng})}))}),(xe,be)=>(v(),g("div",Pw,[r("div",{ref_key:"mapContainer",ref:i,class:"map-container"},null,512),Ze.value?(v(),g("button",{key:0,class:"recenter-btn",onClick:ye,title:"Recenter on checkpoint"},[...be[0]||(be[0]=[r("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),r("span",null,"Recenter",-1)])])):D("",!0)]))}},dd=He(Rw,[["__scopeId","data-v-ddef834a"]]);function Ws(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}const Ow={class:"areas-selection"},Bw={key:0,class:"areas-selection-header"},Nw={class:"areas-list"},Fw=["checked","onChange"],Uw={__name:"AreasSelection",props:{areas:{type:Array,default:()=>[]},selectedAreaIds:{type:Array,default:()=>[]}},emits:["update:selectedAreaIds"],setup(e,{emit:t}){const o=e,a=t,n=V(()=>[...o.areas].sort((d,h)=>d.displayOrder!==h.displayOrder?d.displayOrder-h.displayOrder:Ws(d.name,h.name))),i=V(()=>o.areas.length>0&&o.selectedAreaIds.length===o.areas.length),l=d=>{const h=[...o.selectedAreaIds],f=h.indexOf(d);f>=0?h.splice(f,1):h.push(d),a("update:selectedAreaIds",h)},u=()=>{i.value?a("update:selectedAreaIds",[]):a("update:selectedAreaIds",o.areas.map(d=>d.id))};return(d,h)=>(v(),g("div",Ow,[e.areas.length>1?(v(),g("div",Bw,[r("button",{onClick:u,class:"toggle-all-btn"},I(i.value?"Deselect all":"Select all"),1)])):D("",!0),r("div",Nw,[(v(!0),g(Ae,null,Ue(n.value,f=>(v(),g("label",{class:"area-checkbox",key:f.id},[r("input",{type:"checkbox",checked:e.selectedAreaIds.includes(f.id),onChange:m=>l(f.id)},null,40,Fw),r("span",{class:"area-color-dot",style:Qe({backgroundColor:f.color||"#667eea"})},null,4),Ye(" "+I(f.name),1)]))),128))])]))}},zw=He(Uw,[["__scopeId","data-v-ba19009b"]]),Hw={key:1,class:"toolbar-btn-wrapper filters-wrapper"},Vw={key:1,class:"dropdown-content filters-dropdown"},Gw={class:"filters-header"},qw={class:"filter-section"},jw={class:"filter-checkbox"},Zw=["checked"],Ww={key:0,class:"filter-checkbox"},Kw=["checked"],Jw={class:"filter-section"},Yw={class:"filter-checkbox"},Xw=["checked"],Qw={class:"filter-checkbox"},eC=["checked"],tC={class:"filter-checkbox"},nC=["checked"],oC={key:0,class:"filter-section"},sC=["onClick","title"],aC={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},iC={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},lC=["innerHTML"],rC={key:0,class:"dropdown-content action-dropdown"},cC=["onClick"],uC={__name:"MapToolbar",props:{showFullscreen:{type:Boolean,default:!1},showFilters:{type:Boolean,default:!1},filters:{type:Object,default:()=>({showRoute:!0,showAreaOverlays:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},areas:{type:Array,default:()=>[]},actions:{type:Array,default:()=>[]},position:{type:String,default:"top-right",validator:e=>["top-right","top-left"].includes(e)}},emits:["fullscreen-click","filter-change","action-click"],setup(e,{expose:t,emit:o}){const{terms:a}=ct(),n=e,i=o,l=A(!1),u=A(null),d=V(()=>u.value!==null),h=()=>{l.value=!l.value,l.value&&(u.value=null)},f=(w,S)=>{i("filter-change",{...n.filters,[w]:S})},m=w=>{w.items&&w.items.length>0?u.value===w.id?u.value=null:(u.value=w.id,l.value=!1):i("action-click",{actionId:w.id})},y=(w,S)=>{u.value=null,i("action-click",{actionId:w,itemId:S})};return t({closeDropdowns:()=>{l.value=!1,u.value=null}}),(w,S)=>(v(),g("div",{class:ve(["map-toolbar",[`position-${e.position}`]])},[e.showFullscreen?(v(),g("button",{key:0,class:"toolbar-btn",onClick:S[0]||(S[0]=T=>w.$emit("fullscreen-click")),title:"Fullscreen"},[...S[9]||(S[9]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})],-1)])])):D("",!0),e.showFilters&&!d.value?(v(),g("div",Hw,[l.value?(v(),g("div",{key:0,class:"mobile-backdrop",onClick:S[1]||(S[1]=T=>l.value=!1)})):D("",!0),r("button",{class:ve(["toolbar-btn",{active:l.value}]),onClick:h,title:"Show/hide options"},[...S[10]||(S[10]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),r("circle",{cx:"12",cy:"12",r:"3"})],-1)])],2),l.value?(v(),g("div",Vw,[r("div",Gw,[S[12]||(S[12]=r("span",{class:"filters-title"},"Map filters",-1)),r("button",{class:"close-filters-btn",onClick:S[2]||(S[2]=T=>l.value=!1),title:"Close"},[...S[11]||(S[11]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])]),r("div",qw,[S[13]||(S[13]=r("h4",null,"Display",-1)),r("label",jw,[r("input",{type:"checkbox",checked:e.filters.showRoute,onChange:S[3]||(S[3]=T=>f("showRoute",T.target.checked))},null,40,Zw),r("span",null,I(N(a).course)+" line",1)]),e.areas.length>0?(v(),g("label",Ww,[r("input",{type:"checkbox",checked:e.filters.showAreaOverlays!==!1,onChange:S[4]||(S[4]=T=>f("showAreaOverlays",T.target.checked))},null,40,Kw),r("span",null,I(N(a).area)+" overlays",1)])):D("",!0)]),r("div",Jw,[r("h4",null,I(N(a).checkpoints),1),r("label",Yw,[r("input",{type:"checkbox",checked:e.filters.showUncheckedIn,onChange:S[5]||(S[5]=T=>f("showUncheckedIn",T.target.checked))},null,40,Xw),S[14]||(S[14]=r("span",{class:"status-indicator unchecked"},null,-1)),S[15]||(S[15]=r("span",null,"Unchecked-in",-1))]),r("label",Qw,[r("input",{type:"checkbox",checked:e.filters.showPartiallyCheckedIn,onChange:S[6]||(S[6]=T=>f("showPartiallyCheckedIn",T.target.checked))},null,40,eC),S[16]||(S[16]=r("span",{class:"status-indicator partial"},null,-1)),S[17]||(S[17]=r("span",null,"Partially checked-in",-1))]),r("label",tC,[r("input",{type:"checkbox",checked:e.filters.showFullyCheckedIn,onChange:S[7]||(S[7]=T=>f("showFullyCheckedIn",T.target.checked))},null,40,nC),S[18]||(S[18]=r("span",{class:"status-indicator full"},null,-1)),S[19]||(S[19]=r("span",null,"Fully checked-in",-1))])]),e.areas.length>0?(v(),g("div",oC,[r("h4",null,I(N(a).areas),1),Me(zw,{areas:e.areas,"selected-area-ids":e.filters.selectedAreaIds,"onUpdate:selectedAreaIds":S[8]||(S[8]=T=>f("selectedAreaIds",T))},null,8,["areas","selected-area-ids"])])):D("",!0)])):D("",!0)])):D("",!0),(v(!0),g(Ae,null,Ue(e.actions,T=>(v(),g("div",{key:T.id,class:ve(["toolbar-btn-wrapper",{hidden:l.value}])},[r("button",{class:ve(["toolbar-btn",{active:u.value===T.id}]),onClick:x=>m(T),title:T.label||T.id},[T.icon==="plus"?(v(),g("svg",aC,[...S[20]||(S[20]=[r("line",{x1:"12",y1:"5",x2:"12",y2:"19"},null,-1),r("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1)])])):T.icon==="edit"?(v(),g("svg",iC,[...S[21]||(S[21]=[r("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},null,-1),r("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1)])])):T.icon==="custom"?(v(),g("span",{key:2,innerHTML:T.customIcon},null,8,lC)):D("",!0)],10,sC),T.items&&u.value===T.id?(v(),g("div",rC,[(v(!0),g(Ae,null,Ue(T.items,x=>(v(),g("button",{key:x.id,onClick:C=>y(T.id,x.id),class:"dropdown-item"},I(x.label),9,cC))),128))])):D("",!0)],2))),128))],2))}},jf=He(uC,[["__scopeId","data-v-adedd545"]]),dC={key:0,class:"drawing-controls"},hC={class:"point-count"},fC={class:"undo-redo-buttons"},pC=["disabled"],vC=["disabled"],mC={__name:"MapDrawingControls",props:{pointCount:{type:Number,default:0},canUndo:{type:Boolean,default:!1},canRedo:{type:Boolean,default:!1},show:{type:Boolean,default:!0}},emits:["undo","redo"],setup(e,{emit:t}){const o=e,a=t,n=V(()=>o.show&&o.pointCount>0),i=l=>{if(!n.value)return;const d=navigator.platform.toUpperCase().indexOf("MAC")>=0?l.metaKey:l.ctrlKey;d&&l.key==="z"&&!l.shiftKey?(l.preventDefault(),o.canUndo&&a("undo")):d&&(l.key==="y"||l.key==="z"&&l.shiftKey)&&(l.preventDefault(),o.canRedo&&a("redo"))};return ln(()=>{document.addEventListener("keydown",i)}),Ln(()=>{document.removeEventListener("keydown",i)}),(l,u)=>n.value?(v(),g("div",dC,[r("div",hC,I(e.pointCount)+" point"+I(e.pointCount!==1?"s":""),1),r("div",fC,[r("button",{onClick:u[0]||(u[0]=d=>l.$emit("undo")),class:"btn-drawing undo-btn",disabled:!e.canUndo,title:"Undo last point (Ctrl+Z)"},"  Undo ",8,pC),r("button",{onClick:u[1]||(u[1]=d=>l.$emit("redo")),class:"btn-drawing redo-btn",disabled:!e.canRedo,title:"Redo point (Ctrl+Y)"}," Redo  ",8,vC)])])):D("",!0)}},Zf=He(mC,[["__scopeId","data-v-6cd009cb"]]),gC={class:"context-info"},yC={class:"action-buttons"},kC=["disabled"],bC={key:0,class:"fullscreen-map-banner"},_C={class:"fullscreen-map-container"},wC={key:1,class:"fullscreen-map-footer"},CC={__name:"MapFullscreenModal",props:{show:{type:Boolean,required:!0},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},title:{type:String,default:""},description:{type:String,default:""},canComplete:{type:Boolean,default:!1},headerStyle:{type:Object,default:()=>({})},headerTextColor:{type:String,default:""}},emits:["done","cancel","close"],setup(e,{emit:t}){const o=e,a=V(()=>o.headerTextColor?{color:o.headerTextColor}:{}),n=t,i=()=>{n("done")},l=()=>{n("cancel")},u=()=>{n("close")},d=h=>{h.key==="Escape"&&o.show&&(o.mode==="view"?u():l())};return We(()=>o.show,h=>{h?(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"):(document.body.style.overflow="",document.documentElement.style.overflow="")},{immediate:!0}),ln(()=>{document.addEventListener("keydown",d)}),Ln(()=>{document.removeEventListener("keydown",d),document.body.style.overflow="",document.documentElement.style.overflow=""}),(h,f)=>(v(),Ke(Kl,{to:"body"},[e.show?(v(),g("div",{key:0,class:"fullscreen-map-overlay",onTouchmove:f[0]||(f[0]=lt(()=>{},["prevent","self"]))},[r("div",{class:ve(["fullscreen-map-header",{compact:e.mode==="view"}]),style:Qe(e.headerStyle)},[r("div",gC,[r("h3",{style:Qe({color:e.headerTextColor})},I(e.title),5),e.description?(v(),g("p",{key:0,style:Qe({color:e.headerTextColor,opacity:.85})},I(e.description),5)):D("",!0)]),r("div",yC,[ao(h.$slots,"actions",{},void 0),e.mode==="view"?(v(),g("button",{key:0,type:"button",onClick:lt(u,["stop"]),class:"btn btn-close-x",style:Qe(a.value),title:"Close"},[...f[1]||(f[1]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"20",height:"20"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])],4)):(v(),g(Ae,{key:1},[r("button",{type:"button",onClick:l,class:"btn btn-cancel"}," Cancel "),r("button",{type:"button",onClick:i,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,kC)],64))])],6),h.$slots.banner?(v(),g("div",bC,[ao(h.$slots,"banner",{},void 0)])):D("",!0),r("div",_C,[ao(h.$slots,"default",{},void 0)]),h.$slots.footer?(v(),g("div",wC,[ao(h.$slots,"footer",{},void 0)])):D("",!0)],32)):D("",!0)]))}},LC=He(CC,[["__scopeId","data-v-a1e3e36c"]]),SC={class:"map-wrapper"},IC={class:"fullscreen-map-wrapper"},xC={__name:"CommonMap",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},editingPolygon:{type:Array,default:null},height:{type:String,default:"400px"},showFullscreen:{type:Boolean,default:!0},showFilters:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]},toolbarPosition:{type:String,default:"top-right"},filters:{type:Object,default:()=>({showRoute:!0,showAreaOverlays:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},fullscreenTitle:{type:String,default:""},fullscreenDescription:{type:String,default:""},fullscreenHeaderStyle:{type:Object,default:()=>({})},fullscreenHeaderTextColor:{type:String,default:""},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","visibility-change","point-selected","polygon-complete","polygon-drawing","polygon-update","fullscreen-change","filter-change","action-click","fullscreen-done","fullscreen-cancel"],setup(e,{expose:t,emit:o}){const a=e,n=o,i=A(null),l=A(null),u=A(null),d=A(null),h=A(!1),f=A(0),m=A(!1),y=A(!1),k=A({...a.filters});We(()=>a.filters,ee=>{k.value={...ee}},{deep:!0}),We(()=>a.areas,ee=>{a.showFilters&&ee.length>0&&(!k.value.selectedAreaIds||k.value.selectedAreaIds.length===0)&&(k.value.selectedAreaIds=ee.map(te=>te.id))},{immediate:!0});const w=V(()=>a.showFilters?a.locations.filter(ee=>{const te=ee.checkedInCount||0,O=ee.requiredMarshals||1,Z=te===0,ne=te>0&&te<O,pe=te>=O;if(Z&&!k.value.showUncheckedIn||ne&&!k.value.showPartiallyCheckedIn||pe&&!k.value.showFullyCheckedIn)return!1;const we=ee.areaIds||ee.AreaIds||[];return!(a.areas.length>0&&we.length>0&&(!k.value.selectedAreaIds||k.value.selectedAreaIds.length===0||!we.some(Ne=>k.value.selectedAreaIds.includes(Ne))))}):a.locations),S=V(()=>a.showFilters?k.value.showRoute?a.route:[]:a.route),T=V(()=>a.showFilters?k.value.showAreaOverlays===!1?[]:k.value.selectedAreaIds&&k.value.selectedAreaIds.length>0?a.areas.filter(ee=>k.value.selectedAreaIds.includes(ee.id)):a.areas.length>0?[]:a.areas:a.areas),x=V(()=>a.mode==="select-point"?!0:a.mode==="draw-polygon"?f.value>=3:!0),C=()=>h.value?l.value:i.value,_=()=>{h.value=!0,n("fullscreen-change",!0)},$=()=>{h.value=!1,n("fullscreen-change",!1)},M=()=>{if(a.mode==="draw-polygon"){const ee=C();ee&&ee.clearPolygonDrawing(),f.value=0,m.value=!1,y.value=!1}h.value=!1,n("fullscreen-cancel"),n("fullscreen-change",!1)},H=()=>{if(a.mode==="draw-polygon"&&f.value>=3){const ee=C();ee&&ee.completePolygon()}h.value=!1,n("fullscreen-done"),n("fullscreen-change",!1)},E=ee=>{k.value=ee,n("filter-change",ee)},B=ee=>{a.mode==="select-point"&&n("point-selected",ee),n("map-click",ee)},R=ee=>{f.value=ee?.length||0,j(),n("polygon-drawing",ee)},U=ee=>{n("polygon-complete",ee),f.value=0,m.value=!1,y.value=!1},F=ee=>{n("polygon-update",ee)},j=()=>{const ee=C();ee&&(m.value=ee.canUndo?ee.canUndo():!1,y.value=ee.canRedo?ee.canRedo():!1)},Y=()=>{const ee=C();ee&&ee.undoPolygonPoint&&(ee.undoPolygonPoint(),j())},oe=()=>{const ee=C();ee&&ee.redoPolygonPoint&&(ee.redoPolygonPoint(),j())};return t({getMapCenter:()=>C()?.getMapCenter?.(),getMapZoom:()=>C()?.getMapZoom?.(),undoPolygonPoint:Y,redoPolygonPoint:oe,canUndo:()=>m.value,canRedo:()=>y.value,getPolygonPointCount:()=>f.value,completePolygon:()=>C()?.completePolygon?.(),clearPolygonDrawing:()=>{C()?.clearPolygonDrawing?.(),f.value=0,m.value=!1,y.value=!1},recenterOnUserLocation:()=>C()?.recenterOnUserLocation?.(),recenterOnLocation:(ee,te,O)=>C()?.recenterOnLocation?.(ee,te,O),isLocationInView:(ee,te)=>C()?.isLocationInView?.(ee,te)??!0,getUserLocationInView:()=>C()?.userLocationInView?.value??!0,getHighlightedLocationInView:()=>C()?.highlightedLocationInView?.value??!0,openFullscreen:()=>{h.value=!0,n("fullscreen-change",!0)},closeFullscreen:$,closeDropdowns:()=>{u.value&&u.value.closeDropdowns(),d.value&&d.value.closeDropdowns()}}),(ee,te)=>(v(),g("div",{class:"common-map",style:Qe({height:e.height})},[r("div",SC,[Me(dd,{ref_key:"mapViewRef",ref:i,locations:w.value,route:S.value,areas:T.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:te[0]||(te[0]=O=>ee.$emit("location-click",O)),onMapClick:B,onAreaClick:te[1]||(te[1]=O=>ee.$emit("area-click",O)),onPolygonComplete:U,onPolygonDrawing:R,onPolygonUpdate:F,onVisibilityChange:te[2]||(te[2]=O=>ee.$emit("visibility-change",O))},null,8,["locations","route","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Me(jf,{ref_key:"toolbarRef",ref:u,"show-fullscreen":e.showFullscreen,"show-filters":e.showFilters,filters:k.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFullscreenClick:_,onFilterChange:E,onActionClick:te[3]||(te[3]=O=>ee.$emit("action-click",O))},null,8,["show-fullscreen","show-filters","filters","areas","actions","position"]),Me(Zf,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":m.value,"can-redo":y.value,onUndo:Y,onRedo:oe},null,8,["show","point-count","can-undo","can-redo"])]),Me(LC,{show:h.value,mode:e.mode,title:e.fullscreenTitle,description:e.fullscreenDescription,"can-complete":x.value,"header-style":e.fullscreenHeaderStyle,"header-text-color":e.fullscreenHeaderTextColor,onDone:H,onCancel:M,onClose:$},$d({default:Fe(()=>[r("div",IC,[Me(dd,{ref_key:"fullscreenMapViewRef",ref:l,locations:w.value,route:S.value,areas:T.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:te[4]||(te[4]=O=>ee.$emit("location-click",O)),onMapClick:B,onAreaClick:te[5]||(te[5]=O=>ee.$emit("area-click",O)),onPolygonComplete:U,onPolygonDrawing:R,onPolygonUpdate:F,onVisibilityChange:te[6]||(te[6]=O=>ee.$emit("visibility-change",O))},null,8,["locations","route","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Me(jf,{ref_key:"fullscreenToolbarRef",ref:d,"show-fullscreen":!1,"show-filters":e.showFilters,filters:k.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFilterChange:E,onActionClick:te[7]||(te[7]=O=>ee.$emit("action-click",O))},null,8,["show-filters","filters","areas","actions","position"]),Me(Zf,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":m.value,"can-redo":y.value,onUndo:Y,onRedo:oe},null,8,["show","point-count","can-undo","can-redo"])])]),_:2},[ee.$slots["fullscreen-actions"]?{name:"actions",fn:Fe(()=>[ao(ee.$slots,"fullscreen-actions",{},void 0,!0)]),key:"0"}:void 0,ee.$slots["fullscreen-banner"]?{name:"banner",fn:Fe(()=>[ao(ee.$slots,"fullscreen-banner",{},void 0,!0)]),key:"1"}:void 0,ee.$slots["fullscreen-footer"]?{name:"footer",fn:Fe(()=>[ao(ee.$slots,"fullscreen-footer",{},void 0,!0)]),key:"2"}:void 0]),1032,["show","mode","title","description","can-complete","header-style","header-text-color"])],4))}},wi=He(xC,[["__scopeId","data-v-4ba30c05"]]),$C={class:"course-areas-tab"},TC={__name:"CourseAreasTab",props:{checkpoints:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1}},emits:["map-click","location-click","area-click","import-checkpoints","upload-route","select-location","add-area","select-area","polygon-complete","cancel-drawing","add-checkpoint-from-map","add-many-checkpoints-from-map","add-area-from-map"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:n}=ct(),i=e,l=o,u=A(null),d=A(null),h=A(0),f=A({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]}),m=V(()=>[{id:"add",icon:"plus",label:"Add",items:[{id:"checkpoint",label:a.value.checkpoint},{id:"many-checkpoints",label:`Many ${n.value.checkpoints}`},{id:"area",label:a.value.area},{id:"import",label:`Import ${n.value.checkpoints}...`},{id:"upload",label:`Upload ${n.value.course}...`}]}]),y=({actionId:C,itemId:_})=>{C==="add"&&(_==="checkpoint"?(l("add-checkpoint-from-map"),S()):_==="many-checkpoints"?(l("add-many-checkpoints-from-map"),S()):_==="area"?(l("add-area-from-map"),S()):_==="import"?l("import-checkpoints"):_==="upload"&&l("upload-route"))},k=C=>{f.value=C},w=C=>{h.value=C?.length||0},S=()=>{u.value&&u.value.scrollIntoView({behavior:"smooth",block:"start"})};return t({scrollMapIntoView:S,getMapCenter:()=>d.value?.getMapCenter()||null,getMapZoom:()=>d.value?.getMapZoom()||null}),We(()=>i.areas,C=>{if(C.length>0){const _=new Set(f.value.selectedAreaIds);C.forEach($=>{_.has($.id)||f.value.selectedAreaIds.push($.id)}),f.value.selectedAreaIds=f.value.selectedAreaIds.filter($=>C.some(M=>M.id===$))}},{immediate:!0}),We(()=>i.drawingMode,C=>{C||(h.value=0)}),(C,_)=>(v(),g("div",$C,[r("div",{class:"map-section",ref_key:"mapSection",ref:u},[Me(wi,{ref_key:"commonMapRef",ref:d,locations:e.checkpoints,route:e.route,areas:e.areas,"all-locations-for-bounds":e.checkpoints,"selected-area-id":e.selectedAreaId,clickable:!0,mode:e.drawingMode?"draw-polygon":"view",height:"100%","show-filters":"",filters:f.value,"toolbar-actions":m.value,"fullscreen-title":e.drawingMode?`Draw ${N(n).area} boundary`:N(a).course,"fullscreen-description":e.drawingMode?"Click on the map to draw the boundary":"",onMapClick:_[0]||(_[0]=$=>C.$emit("map-click",$)),onLocationClick:_[1]||(_[1]=$=>C.$emit("location-click",$)),onAreaClick:_[2]||(_[2]=$=>C.$emit("area-click",$)),onPolygonComplete:_[3]||(_[3]=$=>C.$emit("polygon-complete",$)),onPolygonDrawing:w,onFilterChange:k,onActionClick:y},null,8,["locations","route","areas","all-locations-for-bounds","selected-area-id","mode","filters","toolbar-actions","fullscreen-title","fullscreen-description"])],512)]))}},MC=He(TC,[["__scopeId","data-v-c0e54ae9"]]),AC=(e,t)=>{const o=String(e).trim(),a=String(t).trim(),n=parseFloat(o),i=parseFloat(a),l=!isNaN(n)&&String(n)===o,u=!isNaN(i)&&String(i)===a;return l&&u?n-i:o.localeCompare(a,void 0,{numeric:!0,sensitivity:"base"})},EC={__name:"StatusPill",props:{variant:{type:String,default:"neutral",validator:e=>["neutral","success","warning","danger","info","purple"].includes(e)},active:{type:Boolean,default:!1}},emits:["click"],setup(e){return(t,o)=>(v(),g("button",{class:ve(["status-pill",[e.variant,{active:e.active}]]),onClick:o[0]||(o[0]=a=>t.$emit("click"))},[ao(t.$slots,"default",{},void 0)],2))}},fn=He(EC,[["__scopeId","data-v-a94deea5"]]),PC={class:"check-in-toggle-container"},DC=["disabled"],RC={key:0,class:"toggle-spinner"},OC={key:1,class:"toggle-icon"},BC={class:"toggle-label"},NC={key:0,class:"check-in-details"},FC={key:0,class:"check-in-method"},UC={__name:"CheckInToggleButton",props:{isCheckedIn:{type:Boolean,default:!1},checkInTime:{type:String,default:null},checkInMethod:{type:String,default:null},checkedInBy:{type:String,default:null},marshalName:{type:String,default:null},isLoading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},distance:{type:Number,default:null}},emits:["toggle","distance-click"],setup(e){const t=e,o=V(()=>t.distance===null||t.distance===void 0?null:t.distance<1e3?`${Math.round(t.distance)} m`:`${(t.distance/1e3).toFixed(2)} km`),a=V(()=>t.distance===null||t.distance===void 0?"":t.distance<=50?"distance-close":t.distance<=100?"distance-medium":"distance-far"),n=V(()=>t.isLoading?t.isCheckedIn?"Checking out...":"Checking in...":t.isCheckedIn?"Checked in":"Check in"),i=V(()=>{const{checkedInBy:u,checkInMethod:d,marshalName:h}=t;return u&&u!==h?u:d||""}),l=u=>u?new Date(u).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"";return(u,d)=>(v(),g("div",PC,[r("button",{class:ve(["check-in-toggle",{"is-checked-in":e.isCheckedIn}]),disabled:e.disabled||e.isLoading,onClick:d[0]||(d[0]=h=>u.$emit("toggle"))},[e.isLoading?(v(),g("span",RC)):e.isCheckedIn?(v(),g("span",OC,"")):D("",!0),r("span",BC,I(n.value),1)],10,DC),e.isCheckedIn&&e.checkInTime&&!e.isLoading?(v(),g("span",NC,[Ye(I(l(e.checkInTime))+" ",1),i.value?(v(),g("span",FC,"("+I(i.value)+")",1)):D("",!0),o.value?(v(),g("span",{key:1,class:ve(["check-in-distance",a.value]),onClick:d[1]||(d[1]=lt(h=>u.$emit("distance-click"),["stop"]))},I(o.value),3)):D("",!0)])):D("",!0)]))}},lc=He(UC,[["__scopeId","data-v-f08ae7ff"]]),zC={class:"confirm-modal"},HC={class:"confirm-actions"},VC={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},showCancel:{type:Boolean,default:!0},isDanger:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(e,{emit:t}){const o=t,a=()=>{o("confirm")},n=()=>{o("cancel")};return(i,l)=>e.show?(v(),g("div",{key:0,class:"modal-overlay",onClick:lt(n,["self"])},[r("div",zC,[r("h3",null,I(e.title),1),r("p",null,I(e.message),1),r("div",HC,[e.showCancel?(v(),g("button",{key:0,onClick:n,class:"btn btn-secondary"},I(e.cancelText),1)):D("",!0),r("button",{onClick:a,class:ve(["btn",e.isDanger?"btn-danger":"btn-primary"])},I(e.confirmText),3)])])])):D("",!0)}},Da=He(VC,[["__scopeId","data-v-b3f01e55"]]),GC={class:"base-modal-header"},qC={class:"base-modal-header-content"},jC={key:0,class:"base-modal-title"},ZC={key:0,class:"base-modal-tab-header"},WC={key:1,class:"base-modal-footer"},KC={key:0,class:"base-modal-actions"},JC={__name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},variant:{type:String,default:"center",validator:e=>["center","sidebar"].includes(e)},zIndex:{type:Number,default:1e3},closeOnOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},confirmOnClose:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=()=>{const _=document.documentElement,$=getComputedStyle(_).getPropertyValue("--modal-resize-duration").trim();return $.endsWith("s")?parseFloat($)*1e3:300},a=e,n=t,i=A(!1),l=A(!1),u=A(null),d=A(null);let h=null,f=!1,m=0;const y=()=>{if(!d.value||!u.value||f)return;const _=d.value.scrollHeight,$=m;if($===_||m===0){m=_;return}f=!0,d.value.style.height=`${$}px`,d.value.style.overflow="hidden",d.value.offsetHeight,d.value.style.transition="height var(--modal-resize-duration, 0.3s) ease",d.value.style.height=`${_}px`;const M=o();setTimeout(()=>{d.value&&(d.value.style.height="",d.value.style.overflow="",d.value.style.transition=""),f=!1,m=_},M)},k=()=>{!u.value||typeof MutationObserver>"u"||(d.value&&(m=d.value.scrollHeight),h=new MutationObserver(()=>{cn(()=>{y()})}),h.observe(u.value,{childList:!0,subtree:!0,attributes:!0,characterData:!0}))},w=()=>{h&&(h.disconnect(),h=null)};ln(()=>{cn(()=>{a.show&&k()})}),Ln(()=>{w()}),We(()=>a.show,_=>{_?cn(()=>{m=0,k()}):w()});const S=()=>{a.closeOnOverlay&&T()},T=()=>{a.confirmOnClose&&a.isDirty?i.value=!0:n("close")},x=()=>{i.value=!1,n("close")},C=()=>{i.value=!1};return(_,$)=>(v(),Ke(Jo,{name:"modal",appear:""},{default:Fe(()=>[e.show?(v(),g("div",{key:0,class:"base-modal-overlay",style:Qe({zIndex:e.zIndex}),onClick:lt(S,["self"])},[r("div",{class:ve(["base-modal",[`base-modal--${e.size}`,`base-modal--${e.variant}`]])},[r("div",GC,[r("div",qC,[ao(_.$slots,"header",{},()=>[e.title?(v(),g("h2",jC,I(e.title),1)):D("",!0)],!0)]),e.showCloseButton?(v(),g("button",{key:0,onClick:T,class:"base-modal-close",type:"button","aria-label":"Close"},"  ")):D("",!0)]),_.$slots["tab-header"]?(v(),g("div",ZC,[ao(_.$slots,"tab-header",{},void 0,!0)])):D("",!0),r("div",{class:"base-modal-body",ref_key:"bodyRef",ref:u},[r("div",{class:"base-modal-body-content",ref_key:"contentRef",ref:d},[ao(_.$slots,"default",{},void 0,!0)],512)],512),_.$slots.footer||_.$slots.actions?(v(),g("div",WC,[ao(_.$slots,"footer",{},()=>[_.$slots.actions?(v(),g("div",KC,[ao(_.$slots,"actions",{},void 0,!0)])):D("",!0)],!0)])):D("",!0)],2),e.confirmOnClose&&!l.value?(v(),Ke(Da,{key:0,show:i.value,title:"Unsaved changes",message:"You have unsaved changes. Are you sure you want to close?",onConfirm:x,onCancel:C},null,8,["show"])):D("",!0)],4)):D("",!0)]),_:3}))}},Ht=He(JC,[["__scopeId","data-v-141bdab1"]]),YC={class:"map-modal-content"},XC={class:"location-info"},QC={key:0,class:"info-row"},e2={class:"info-value"},t2={key:1,class:"info-row"},n2={class:"info-label"},o2={class:"info-value"},s2={key:2,class:"info-row distance-row"},a2={__name:"CheckInLocationMapModal",props:{show:{type:Boolean,default:!1},marshalName:{type:String,default:""},checkpointName:{type:String,default:""},checkInLocation:{type:Object,default:null},checkpointLocation:{type:Object,default:null},distance:{type:Number,default:null},zIndex:{type:Number,default:1100}},emits:["close"],setup(e){const{terms:t}=ct(),o=e,a=A(null);let n=null,i=null,l=null;const u=V(()=>t.value.checkpoint),d=V(()=>o.marshalName&&o.checkpointName?`${o.marshalName} - ${o.checkpointName}`:o.marshalName?o.marshalName:"Check-in location"),h=V(()=>o.distance===null?"":o.distance<1e3?`${Math.round(o.distance)} m`:`${(o.distance/1e3).toFixed(2)} km`),f=V(()=>o.distance===null?"":o.distance<=50?"distance-close":o.distance<=100?"distance-medium":"distance-far"),m=(S,T)=>S==null||T==null?"Unknown":`${S.toFixed(6)}, ${T.toFixed(6)}`,y=()=>{if(!a.value||n)return;let S=[51.505,-.09],T=15;o.checkInLocation&&(S=[o.checkInLocation.lat,o.checkInLocation.lng]),n=Ft.map(a.value).setView(S,T),Ft.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors",maxZoom:19}).addTo(n),k()},k=()=>{if(!n)return;i&&(i.remove(),i=null),l&&(l.remove(),l=null);const S=[];if(o.checkInLocation){const T=Ft.divIcon({className:"check-in-location-marker",html:`
        <div style="position: relative; width: 24px; height: 24px;">
          <div style="
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background-color: #4285f4;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
          "></div>
          <div style="
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            background-color: rgba(66, 133, 244, 0.2);
            border-radius: 50%;
            animation: pulse 2s ease-out infinite;
          "></div>
        </div>
      `,iconSize:[40,40],iconAnchor:[20,20]});i=Ft.marker([o.checkInLocation.lat,o.checkInLocation.lng],{icon:T}).addTo(n).bindPopup(`<b>${o.marshalName||"Marshal"}</b><br>Check-in location`),S.push([o.checkInLocation.lat,o.checkInLocation.lng])}if(o.checkpointLocation&&o.checkpointLocation.lat&&o.checkpointLocation.lng){const T=Ft.divIcon({className:"checkpoint-location-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center;">
          <div style="
            width: 32px;
            height: 32px;
            background-color: #667eea;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
          ">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="white">
              <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
            </svg>
          </div>
          <div style="
            background-color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: bold;
            color: #333;
            white-space: nowrap;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${o.checkpointName||t.value.checkpoint}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]});l=Ft.marker([o.checkpointLocation.lat,o.checkpointLocation.lng],{icon:T}).addTo(n).bindPopup(`<b>${o.checkpointName||t.value.checkpoint}</b><br>${t.value.checkpoint} location`),S.push([o.checkpointLocation.lat,o.checkpointLocation.lng])}if(S.length===2){const T=Ft.latLngBounds(S);n.fitBounds(T,{padding:[50,50],maxZoom:17})}else S.length===1&&n.setView(S[0],16)},w=()=>{n&&(n.remove(),n=null,i=null,l=null)};return We(()=>o.show,async S=>{S?(await cn(),setTimeout(()=>{y()},100)):w()}),We([()=>o.checkInLocation,()=>o.checkpointLocation],()=>{n&&k()},{deep:!0}),ln(()=>{o.show&&cn(()=>{setTimeout(()=>{y()},100)})}),Ln(()=>{w()}),(S,T)=>(v(),Ke(Ht,{show:e.show,title:d.value,size:"medium","z-index":e.zIndex,onClose:T[0]||(T[0]=x=>S.$emit("close"))},{default:Fe(()=>[r("div",YC,[r("div",{class:"map-container",ref_key:"mapContainer",ref:a},null,512),r("div",XC,[e.checkInLocation?(v(),g("div",QC,[T[1]||(T[1]=r("span",{class:"info-label"},"Check-in location:",-1)),r("span",e2,I(m(e.checkInLocation.lat,e.checkInLocation.lng)),1)])):D("",!0),e.checkpointLocation?(v(),g("div",t2,[r("span",n2,I(u.value)+" location:",1),r("span",o2,I(m(e.checkpointLocation.lat,e.checkpointLocation.lng)),1)])):D("",!0),e.distance!==null?(v(),g("div",s2,[T[2]||(T[2]=r("span",{class:"info-label"},"Distance:",-1)),r("span",{class:ve(["info-value distance-value",f.value])},I(h.value),3)])):D("",!0)])])]),_:1},8,["show","title","z-index"]))}},Vd=He(a2,[["__scopeId","data-v-011fa479"]]),i2={class:"marshals-tab"},l2={class:"tab-header"},r2={class:"button-group"},c2={key:0,class:"status-pills"},u2={class:"filters-section"},d2={class:"search-group"},h2={class:"marshals-grid"},f2={class:"marshals-table"},p2={key:0,class:"sort-indicator"},v2={key:0,class:"sort-indicator"},m2={key:0,class:"sort-indicator"},g2={key:0,class:"sort-indicator"},y2=["onClick"],k2=["rowspan"],b2={class:"checkpoint-cell"},_2={class:"checkpoint-name"},w2={key:0,class:"checkpoint-description"},C2=["rowspan"],L2={key:0,class:"last-active-text"},S2={key:1,class:"last-active-never"},I2=["onClick"],x2={class:"no-checkpoint-text"},$2={class:"hide-on-mobile last-active-cell"},T2={key:0,class:"last-active-text"},M2={key:1,class:"last-active-never"},A2={__name:"MarshalsTab",props:{marshals:{type:Array,required:!0},assignments:{type:Array,required:!0},locations:{type:Array,required:!0}},emits:["add-marshal","import-marshals","select-marshal","delete-marshal","toggle-check-in"],setup(e,{expose:t,emit:o}){const{terms:a}=ct(),n=e,i=o,l=A(null),u=A(!1),d=A(null),h=Q=>{l.value=Q},f=Q=>{d.value=Q,u.value=!0},m=()=>{u.value=!1,d.value=null},y=V(()=>d.value?we(d.value.marshalId):""),k=V(()=>d.value?ne(d.value.locationId):""),w=V(()=>{if(!d.value)return null;const{checkInLatitude:Q,checkInLongitude:ye}=d.value;return!Q||!ye?null:{lat:Q,lng:ye}}),S=V(()=>{if(!d.value)return null;const Q=Z(d.value.locationId);return!Q?.latitude||!Q?.longitude?null:{lat:Q.latitude,lng:Q.longitude}}),T=V(()=>d.value?Ze(d.value):null),x=A(!1),C=A(null),_=Q=>{Q.isCheckedIn?(C.value=Q,x.value=!0):i("toggle-check-in",Q)},$=()=>{C.value&&i("toggle-check-in",C.value),x.value=!1,C.value=null},M=()=>{x.value=!1,C.value=null},H=V(()=>C.value?`Are you sure you want to undo ${we(C.value.marshalId)}'s check-in?`:"");t({setCheckingIn:h});const E=A("name"),B=A("asc"),R=A(""),U=A("all"),F=Q=>{U.value=Q},j=Q=>{E.value===Q?B.value=B.value==="asc"?"desc":"asc":(E.value=Q,B.value="asc")},Y=Q=>n.assignments.filter(ye=>ye.marshalId===Q),oe=V(()=>new Set(n.assignments.filter(Q=>Q.isCheckedIn).map(Q=>Q.marshalId))),Oe=V(()=>new Set(n.assignments.map(Q=>Q.marshalId))),ee=V(()=>oe.value.size),te=V(()=>n.marshals.filter(Q=>!Oe.value.has(Q.id)).length),O=V(()=>n.marshals.filter(Q=>Oe.value.has(Q.id)&&!oe.value.has(Q.id)).length),Z=Q=>n.locations.find(ye=>ye.id===Q),ne=Q=>{const ye=Z(Q);return ye?ye.name:"Unknown"},pe=Q=>{const ye=Z(Q);return ye?ye.description:""},we=Q=>{const ye=n.marshals.find(Ce=>Ce.id===Q);return ye?ye.name:""},Ze=Q=>{const{checkInLatitude:ye,checkInLongitude:Ce,locationId:me}=Q,ie=Z(me);return!ye||!Ce||!ie?.latitude||!ie?.longitude?null:_i(ye,Ce,ie.latitude,ie.longitude)},Ne=Q=>{if(!Q)return"";const ye=new Date(Q),me=new Date-ye,ie=Math.floor(me/6e4),z=Math.floor(ie/60),K=Math.floor(z/24);return ie<1?"just now":ie<60?`${ie}m ago`:z<24?`${z}h ago`:K===1?"yesterday":K<7?`${K}d ago`:ye.toLocaleDateString()},Ge=V(()=>{let Q=n.marshals;if(U.value==="unassigned"?Q=Q.filter(ye=>!Oe.value.has(ye.id)):U.value==="checked-in"?Q=Q.filter(ye=>oe.value.has(ye.id)):U.value==="not-checked-in"&&(Q=Q.filter(ye=>Oe.value.has(ye.id)&&!oe.value.has(ye.id))),R.value.trim()){const ye=R.value.toLowerCase().trim().split(/\s+/);Q=Q.filter(Ce=>{const ie=Y(Ce.id).map(K=>{const se=Z(K.locationId);return se?`${se.name||""} ${se.description||""}`:""}).join(" "),z=`${Ce.name} ${ie}`.toLowerCase();return ye.every(K=>z.includes(K))})}return Q}),Xe=V(()=>{const Q=[...Ge.value];return Q.sort((ye,Ce)=>{let me=0;if(E.value==="name")me=ye.name.localeCompare(Ce.name);else if(E.value==="checkpoint"){const ie=Y(ye.id),z=Y(Ce.id),K=ie.length>0?ne(ie[0].locationId):"",se=z.length>0?ne(z[0].locationId):"";me=AC(K,se)}else if(E.value==="status"){const ie=Y(ye.id),z=Y(Ce.id),K=ie.length>0&&ie[0].isCheckedIn?1:0;me=(z.length>0&&z[0].isCheckedIn?1:0)-K}else if(E.value==="lastActive"){const ie=ye.lastAccessedDate?new Date(ye.lastAccessedDate).getTime():0;me=(Ce.lastAccessedDate?new Date(Ce.lastAccessedDate).getTime():0)-ie}return B.value==="asc"?me:-me}),Q});return(Q,ye)=>(v(),g("div",i2,[r("div",l2,[r("div",r2,[r("button",{onClick:ye[0]||(ye[0]=Ce=>Q.$emit("add-marshal")),class:"btn btn-primary"}," Add "+I(N(a).person.toLowerCase()),1),r("button",{onClick:ye[1]||(ye[1]=Ce=>Q.$emit("import-marshals")),class:"btn btn-secondary"}," Import CSV ")]),e.marshals.length>0?(v(),g("div",c2,[Me(fn,{variant:"neutral",active:U.value==="all",onClick:ye[2]||(ye[2]=Ce=>F("all"))},{default:Fe(()=>[Ye(I(e.marshals.length)+" total ",1)]),_:1},8,["active"]),te.value>0&&te.value<e.marshals.length?(v(),Ke(fn,{key:0,variant:"warning",active:U.value==="unassigned",onClick:ye[3]||(ye[3]=Ce=>F("unassigned"))},{default:Fe(()=>[Ye(I(te.value)+" unassigned ",1)]),_:1},8,["active"])):D("",!0),ee.value>0&&ee.value<e.marshals.length?(v(),Ke(fn,{key:1,variant:"success",active:U.value==="checked-in",onClick:ye[4]||(ye[4]=Ce=>F("checked-in"))},{default:Fe(()=>[Ye(I(ee.value)+" checked in ",1)]),_:1},8,["active"])):D("",!0),O.value>0&&O.value<e.marshals.length?(v(),Ke(fn,{key:2,variant:"danger",active:U.value==="not-checked-in",onClick:ye[5]||(ye[5]=Ce=>F("not-checked-in"))},{default:Fe(()=>[Ye(I(O.value)+" not checked in ",1)]),_:1},8,["active"])):D("",!0)])):D("",!0)]),r("div",u2,[r("div",d2,[ze(r("input",{"onUpdate:modelValue":ye[6]||(ye[6]=Ce=>R.value=Ce),type:"text",class:"search-input",placeholder:"Search by name, checkpoint, or description..."},null,512),[[nt,R.value]])])]),r("div",h2,[r("table",f2,[r("thead",null,[r("tr",null,[r("th",{onClick:ye[7]||(ye[7]=Ce=>j("name")),class:"sortable"},[ye[12]||(ye[12]=Ye(" Name ",-1)),E.value==="name"?(v(),g("span",p2,I(B.value==="asc"?"":""),1)):D("",!0)]),r("th",{onClick:ye[8]||(ye[8]=Ce=>j("checkpoint")),class:"sortable"},[Ye(I(N(a).checkpoint)+" ",1),E.value==="checkpoint"?(v(),g("span",v2,I(B.value==="asc"?"":""),1)):D("",!0)]),r("th",{onClick:ye[9]||(ye[9]=Ce=>j("status")),class:"sortable"},[ye[13]||(ye[13]=Ye(" Status ",-1)),E.value==="status"?(v(),g("span",m2,I(B.value==="asc"?"":""),1)):D("",!0)]),r("th",{onClick:ye[10]||(ye[10]=Ce=>j("lastActive")),class:"sortable hide-on-mobile"},[ye[14]||(ye[14]=Ye(" Last active ",-1)),E.value==="lastActive"?(v(),g("span",g2,I(B.value==="asc"?"":""),1)):D("",!0)])])]),r("tbody",null,[(v(!0),g(Ae,null,Ue(Xe.value,Ce=>(v(),g(Ae,{key:Ce.id},[Y(Ce.id).length>0?(v(!0),g(Ae,{key:0},Ue(Y(Ce.id),(me,ie)=>(v(),g("tr",{key:`${Ce.id}-${me.id}`,class:"marshal-row",onClick:z=>Q.$emit("select-marshal",Ce)},[ie===0?(v(),g("td",{key:0,rowspan:Y(Ce.id).length},I(Ce.name),9,k2)):D("",!0),r("td",b2,[r("div",_2,I(ne(me.locationId)),1),pe(me.locationId)?(v(),g("div",w2,I(pe(me.locationId)),1)):D("",!0)]),r("td",{onClick:ye[11]||(ye[11]=lt(()=>{},["stop"])),class:"check-in-cell"},[Me(lc,{"is-checked-in":me.isCheckedIn,"check-in-time":me.checkInTime,"check-in-method":me.checkInMethod,"checked-in-by":me.checkedInBy,"marshal-name":we(me.marshalId),"is-loading":l.value===me.id,distance:Ze(me),onToggle:z=>_(me),onDistanceClick:z=>f(me)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","distance","onToggle","onDistanceClick"])]),ie===0?(v(),g("td",{key:1,rowspan:Y(Ce.id).length,class:"hide-on-mobile last-active-cell"},[Ce.lastAccessedDate?(v(),g("span",L2,I(Ne(Ce.lastAccessedDate)),1)):(v(),g("span",S2,"Never"))],8,C2)):D("",!0)],8,y2))),128)):(v(),g("tr",{key:1,class:"marshal-row",onClick:me=>Q.$emit("select-marshal",Ce)},[r("td",null,I(Ce.name),1),r("td",x2,"No "+I(N(a).checkpoint.toLowerCase())+" assigned",1),ye[15]||(ye[15]=r("td",null,[r("span",{class:"hide-on-mobile"},"-"),r("span",{class:"status-icon show-on-mobile no-checkpoint-text"},"-")],-1)),r("td",$2,[Ce.lastAccessedDate?(v(),g("span",T2,I(Ne(Ce.lastAccessedDate)),1)):(v(),g("span",M2,"Never"))])],8,I2))],64))),128))])])]),Me(Vd,{show:u.value,"marshal-name":y.value,"checkpoint-name":k.value,"check-in-location":w.value,"checkpoint-location":S.value,distance:T.value,onClose:m},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance"]),Me(Da,{show:x.value,title:"Confirm check-out",message:H.value,"confirm-text":"Check out","is-danger":!0,onConfirm:$,onCancel:M},null,8,["show","message"])]))}},E2=He(A2,[["__scopeId","data-v-bdb66e38"]]),P2={class:"assignment-pills"},D2={__name:"ScopedAssignmentPills",props:{scopeConfigurations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},maxExpandedItems:{type:Number,default:5}},emits:["click"],setup(e){const{terms:t,termsLower:o}=ct(),a=e,n=h=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${o.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${o.value.checkpoints}`,SpecificPeople:`Specific ${o.value.people}`,EveryAreaLead:`Every ${o.value.area} lead`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,OnePerArea:`One per ${o.value.area}`,OneLeadPerArea:`One lead per ${o.value.area}`,AreaLead:`${t.value.area} lead`})[h]||h,i=h=>({Everyone:"",EveryoneInAreas:"Everyone in",EveryoneAtCheckpoints:"Everyone at",SpecificPeople:"",EveryAreaLead:`${o.value.area} lead in`,OnePerCheckpoint:"One at",OnePerArea:"One in",OneLeadPerArea:"Lead in"})[h]||"",l=(h,f)=>f==="Area"?a.areas.find(y=>y.id===h)?.name||null:f==="Checkpoint"?a.locations.find(y=>y.id===h)?.name||null:f==="Marshal"&&a.marshals.find(y=>y.id===h)?.name||null,u=h=>{if(!h)return[];const f=n(h.scope),m=h.ids||[];if(h.itemType===null||m.length===0)return[f];if(m.includes("ALL_MARSHALS"))return["Everyone"];if(m.includes("ALL_AREAS"))return[`${f} (All ${o.value.areas})`];if(m.includes("ALL_CHECKPOINTS"))return[`${f} (All ${o.value.checkpoints})`];const y=m.filter(w=>l(w,h.itemType)!==null);if(y.length===0)return[];if(y.length>a.maxExpandedItems)return[`${f} (${y.length})`];const k=i(h.scope);return y.map(w=>{const S=l(w,h.itemType);return k?`${k} ${S}`:S})},d=V(()=>{if(!a.scopeConfigurations||a.scopeConfigurations.length===0)return[];const h=[];for(const f of a.scopeConfigurations)h.push(...u(f));return h});return(h,f)=>(v(),g("div",P2,[(v(!0),g(Ae,null,Ue(d.value,(m,y)=>(v(),g("span",{key:y,class:"scope-badge",onClick:f[0]||(f[0]=k=>h.$emit("click"))},I(m),1))),128))]))}},fr=He(D2,[["__scopeId","data-v-82c305e5"]]),R2={class:"checklists-tab"},O2={class:"checklists-tab-header"},B2={class:"button-group"},N2={class:"filters-section"},F2={class:"search-group"},U2=["placeholder"],z2={class:"checklist-items-list"},H2={key:0,class:"empty-state"},V2={class:"checklist-item-content"},G2=["onClick"],q2={__name:"ChecklistsTab",props:{checklistItems:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},completionReport:{type:Object,default:null}},emits:["add-checklist-item","select-checklist-item"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,n=A(""),i=V(()=>{if(!n.value.trim())return a.checklistItems;const u=n.value.toLowerCase().trim().split(/\s+/);return a.checklistItems.filter(d=>{const h=(d.text||"").toLowerCase();return u.every(f=>h.includes(f))})}),l=V(()=>[...i.value].sort((u,d)=>u.displayOrder!==d.displayOrder?u.displayOrder-d.displayOrder:Ws(u.text,d.text)));return(u,d)=>(v(),g("div",R2,[r("div",O2,[r("div",B2,[r("button",{onClick:d[0]||(d[0]=h=>u.$emit("add-checklist-item")),class:"btn btn-primary"}," Add "+I(N(o).checklist),1)])]),r("div",N2,[r("div",F2,[ze(r("input",{"onUpdate:modelValue":d[1]||(d[1]=h=>n.value=h),type:"text",class:"search-input",placeholder:`Search ${N(o).checklists}...`},null,8,U2),[[nt,n.value]])])]),r("div",z2,[i.value.length===0?(v(),g("div",H2,[r("p",null,I(n.value?`No ${N(o).checklists} match your search.`:`No ${N(o).checklists} yet. Create one to get started!`),1)])):D("",!0),(v(!0),g(Ae,null,Ue(l.value,h=>(v(),g("div",{key:h.itemId,class:"checklist-item-card"},[r("div",V2,[r("div",{class:"checklist-item-title",onClick:f=>u.$emit("select-checklist-item",h,"details")},[r("strong",null,I(h.text),1)],8,G2),Me(fr,{class:"checklist-item-scopes","scope-configurations":h.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,onClick:f=>u.$emit("select-checklist-item",h,"visibility")},null,8,["scope-configurations","areas","locations","marshals","onClick"])])]))),128))])]))}},j2=He(q2,[["__scopeId","data-v-4ea79496"]]),Z2={class:"notes-tab"},W2={class:"tab-header"},K2={class:"button-group"},J2={class:"filters-section"},Y2={class:"search-group"},X2={class:"notes-list"},Q2={key:0,class:"empty-state"},eL=["onClick"],tL={class:"note-header"},nL={class:"note-title-row"},oL={key:0,class:"pin-icon",title:"Pinned"},sL={key:1,class:"emergency-indicator",title:"Shown in emergency info"},aL={class:"note-meta"},iL={key:0,class:"category-badge"},lL={class:"created-info"},rL={key:0,class:"note-preview"},cL={__name:"NotesTab",props:{notes:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["add-note","select-note"],setup(e,{emit:t}){const o=e,a=A(""),n=V(()=>{if(!a.value.trim())return o.notes;const d=a.value.toLowerCase().trim().split(/\s+/);return o.notes.filter(h=>{const f=`${h.title||""} ${h.content||""} ${h.priority||""}`.toLowerCase();return d.every(m=>f.includes(m))})}),i=V(()=>{const d={Urgent:0,High:1,Normal:2,Low:3};return[...n.value].sort((h,f)=>{if(h.isPinned!==f.isPinned)return h.isPinned?-1:1;const m=d[h.priority]??2,y=d[f.priority]??2;return m!==y?m-y:h.displayOrder!==f.displayOrder?h.displayOrder-f.displayOrder:Ws(h.title,f.title)})}),l=d=>{if(!d)return"";const h=150;return d.length<=h?d:d.substring(0,h)+"..."},u=d=>{if(!d)return"";const h=new Date(d),m=new Date-h,y=Math.floor(m/6e4),k=Math.floor(m/36e5),w=Math.floor(m/864e5);return y<1?"Just now":y<60?`${y}m ago`:k<24?`${k}h ago`:w<7?`${w}d ago`:h.toLocaleDateString()};return(d,h)=>(v(),g("div",Z2,[r("div",W2,[r("div",K2,[r("button",{onClick:h[0]||(h[0]=f=>d.$emit("add-note")),class:"btn btn-primary"}," Add note ")])]),r("div",J2,[r("div",Y2,[ze(r("input",{"onUpdate:modelValue":h[1]||(h[1]=f=>a.value=f),type:"text",class:"search-input",placeholder:"Search by title, content, or priority..."},null,512),[[nt,a.value]])])]),r("div",X2,[n.value.length===0?(v(),g("div",Q2,[r("p",null,I(a.value?"No notes match your search.":"No notes yet. Create one to get started!"),1)])):D("",!0),(v(!0),g(Ae,null,Ue(i.value,f=>(v(),g("div",{key:f.noteId,class:ve(["note-card",{pinned:f.isPinned}]),onClick:m=>d.$emit("select-note",f)},[r("div",tL,[r("div",nL,[f.isPinned?(v(),g("span",oL,"")):D("",!0),r("span",{class:ve(["priority-indicator",f.priority?.toLowerCase()||"normal"])},null,2),r("strong",null,I(f.title),1),f.showInEmergencyInfo?(v(),g("span",sL,"")):D("",!0)]),r("div",aL,[f.category?(v(),g("span",iL,I(f.category),1)):D("",!0),r("span",lL,I(u(f.createdAt)),1)])]),f.content?(v(),g("div",rL,I(l(f.content)),1)):D("",!0),Me(fr,{"scope-configurations":f.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])],10,eL))),128))])]))}},uL=He(cL,[["__scopeId","data-v-93bd2dc4"]]),dL={key:0,class:"empty-state"},hL={key:0,class:"empty-hint"},fL={__name:"CardsGrid",props:{isEmpty:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No items."},emptyHint:{type:String,default:""},gridClass:{type:String,default:""}},setup(e){return(t,o)=>e.isEmpty?(v(),g("div",dL,[r("p",null,I(e.emptyMessage),1),e.emptyHint?(v(),g("p",hL,I(e.emptyHint),1)):D("",!0)])):(v(),g("div",{key:1,class:ve(["cards-grid",e.gridClass])},[ao(t.$slots,"default",{},void 0)],2))}},pr=He(fL,[["__scopeId","data-v-a842b7b1"]]),pL={class:"contact-card-header"},vL={class:"contact-name-row"},mL={key:0,class:"pin-icon",title:"Pinned"},gL={key:1,class:"primary-badge",title:"Primary contact"},yL={class:"contact-name"},kL={key:0,class:"contact-role"},bL={key:0,class:"emergency-indicator",title:"Shown in emergency info"},_L={key:1,class:"no-scope-warning",title:"This contact has no visibility scope configured"},wL=["title"],CL={key:0,class:"contact-card-details"},LL={key:0,class:"contact-phone"},SL={key:1,class:"contact-email"},IL={key:1,class:"contact-card-notes"},xL={key:3,class:"contact-card-badge"},$L={key:4,class:"contact-card-badge"},TL={__name:"ContactCard",props:{contact:{type:Object,required:!0},isPending:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:String,default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},clickable:{type:Boolean,default:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["click","remove","undo-remove"],setup(e,{emit:t}){const{terms:o}=ct(),a=e,n=t,i=V(()=>a.contact.roles&&Array.isArray(a.contact.roles)&&a.contact.roles.length>0?a.contact.roles:a.contact.role?[a.contact.role]:[]),l=V(()=>{const f=a.contact.scopeConfigurations;return!f||f.length===0}),u=()=>{a.clickable&&!a.isPending&&!a.isMarkedForRemoval&&n("click",a.contact)},d=f=>f?f==="AreaLead"?`${o.value.area} Lead`:f.replace(/([A-Z])/g," $1").replace(/^./,m=>m.toUpperCase()).trim():"",h=f=>{if(!f)return"";const m=100;return f.length<=m?f:f.substring(0,m)+"..."};return(f,m)=>(v(),g("div",{class:ve(["contact-card",{"is-pending":e.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-primary":e.contact.isPrimary&&!e.isMarkedForRemoval,"is-pinned":e.contact.isPinned&&!e.isMarkedForRemoval&&!e.contact.isPrimary,"is-clickable":e.clickable&&!e.isMarkedForRemoval}]),onClick:u},[r("div",pL,[r("div",{class:ve(["contact-card-title",{clickable:e.clickable&&!e.isMarkedForRemoval}])},[r("div",vL,[e.contact.isPinned&&!e.isMarkedForRemoval?(v(),g("span",mL,"")):D("",!0),e.contact.isPrimary&&!e.isMarkedForRemoval?(v(),g("span",gL,"")):D("",!0),r("span",yL,I(e.contact.name),1)]),i.value.length>0?(v(),g("span",kL,I(i.value.map(d).join(", ")),1)):D("",!0)],2),e.contact.showInEmergencyInfo&&!e.isMarkedForRemoval?(v(),g("span",bL,"")):D("",!0),l.value&&!e.isMarkedForRemoval&&!e.isPending?(v(),g("span",_L,"!")):D("",!0),e.showRemoveButton&&!e.isMarkedForRemoval?(v(),g("button",{key:2,type:"button",class:"contact-remove-btn",title:e.removeTitle,onClick:m[0]||(m[0]=lt(y=>f.$emit("remove",e.contact.contactId),["stop"]))},"  ",8,wL)):D("",!0),e.isMarkedForRemoval?(v(),g("button",{key:3,type:"button",class:"contact-undo-btn",title:"Cancel removal",onClick:m[1]||(m[1]=lt(y=>f.$emit("undo-remove",e.contact.contactId),["stop"]))}," Undo ")):D("",!0)]),e.contact.phone||e.contact.email?(v(),g("div",CL,[e.contact.phone?(v(),g("span",LL,I(e.contact.phone),1)):D("",!0),e.contact.email?(v(),g("span",SL,I(e.contact.email),1)):D("",!0)])):D("",!0),e.contact.notes&&e.showNotes?(v(),g("div",IL,I(h(e.contact.notes)),1)):D("",!0),e.showScopes&&e.contact.scopeConfigurations?.length>0&&!e.isMarkedForRemoval?(v(),Ke(fr,{key:2,class:"contact-card-scopes","scope-configurations":e.contact.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])):D("",!0),e.isPending?(v(),g("div",xL,[...m[2]||(m[2]=[r("span",{class:"pending-indicator"},"Will be added on save",-1)])])):D("",!0),e.isMarkedForRemoval?(v(),g("div",$L,[...m[3]||(m[3]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):D("",!0)],2))}},ML=He(TL,[["__scopeId","data-v-f7c93ff6"]]),ug={__name:"ContactsGrid",props:{contacts:{type:Array,required:!0},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:[String,Function],default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No contacts."},emptyHint:{type:String,default:""},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["select","remove","undo-remove"],setup(e){const t=e,o=n=>typeof t.removeTitle=="function"?t.removeTitle(n):t.removeTitle,a=n=>!n.isPending;return(n,i)=>(v(),Ke(pr,{"is-empty":e.contacts.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Fe(()=>[(v(!0),g(Ae,null,Ue(e.contacts,l=>(v(),Ke(ML,{key:l.contactId,contact:l,"is-pending":l.isPending,"is-marked-for-removal":l.isMarkedForRemoval,"show-remove-button":e.showRemoveButton,"remove-title":o(l),"show-notes":e.showNotes,"show-scopes":e.showScopes,clickable:a(l),areas:e.areas,locations:e.locations,marshals:e.marshals,onClick:u=>n.$emit("select",l),onRemove:i[0]||(i[0]=u=>n.$emit("remove",u)),onUndoRemove:i[1]||(i[1]=u=>n.$emit("undo-remove",u))},null,8,["contact","is-pending","is-marked-for-removal","show-remove-button","remove-title","show-notes","show-scopes","clickable","areas","locations","marshals","onClick"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},AL={class:"contacts-tab"},EL={class:"tab-header"},PL={class:"button-group"},DL={key:0,class:"status-pills"},RL={class:"filters-section"},OL={class:"search-group"},BL={__name:"ContactsTab",props:{contacts:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})}},emits:["add-contact","select-contact"],setup(e,{emit:t}){const o=e,a=A(""),n=A("all"),i=V(()=>o.contacts.filter(w=>!w.scopeConfigurations||w.scopeConfigurations.length===0).length),l=V(()=>o.contacts.filter(w=>w.scopeConfigurations&&w.scopeConfigurations.length>0).length),u=w=>{n.value=w},d=w=>w?w.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",h=w=>w?w.replace(/([A-Z])/g," $1").replace(/^./,S=>S.toUpperCase()).trim():"",f=w=>w.roles&&Array.isArray(w.roles)&&w.roles.length>0?w.roles.map(h).join(" "):h(w.role),m=V(()=>{let w=o.contacts;if(n.value==="no-scope"?w=w.filter(S=>!S.scopeConfigurations||S.scopeConfigurations.length===0):n.value==="with-scope"&&(w=w.filter(S=>S.scopeConfigurations&&S.scopeConfigurations.length>0)),a.value.trim()){const T=d(a.value).split(" ").filter(x=>x.length>0);w=w.filter(x=>{const C=f(x),_=d(`${x.name||""} ${C} ${x.email||""} ${x.phone||""}`);return T.every($=>_.includes($))})}return w}),y=V(()=>[...m.value].sort((w,S)=>{if(w.isPinned!==S.isPinned)return w.isPinned?-1:1;const T=w.displayOrder||0,x=S.displayOrder||0;return T!==x?T-x:(w.name||"").localeCompare(S.name||"",void 0,{sensitivity:"base"})})),k=V(()=>{const w=a.value.trim();return n.value==="no-scope"?w?"No unassigned contacts match your search.":"All contacts are assigned.":n.value==="with-scope"?w?"No assigned contacts match your search.":"No contacts are assigned yet.":w?"No contacts match your search.":"No contacts yet. Create one to get started!"});return(w,S)=>(v(),g("div",AL,[r("div",EL,[r("div",PL,[r("button",{onClick:S[0]||(S[0]=T=>w.$emit("add-contact")),class:"btn btn-primary"}," Add contact ")]),e.contacts.length>0?(v(),g("div",DL,[Me(fn,{variant:"neutral",active:n.value==="all",onClick:S[1]||(S[1]=T=>u("all"))},{default:Fe(()=>[Ye(I(e.contacts.length)+" total ",1)]),_:1},8,["active"]),l.value>0&&l.value<e.contacts.length?(v(),Ke(fn,{key:0,variant:"success",active:n.value==="with-scope",onClick:S[2]||(S[2]=T=>u("with-scope"))},{default:Fe(()=>[Ye(I(l.value)+" assigned ",1)]),_:1},8,["active"])):D("",!0),i.value>0&&i.value<e.contacts.length?(v(),Ke(fn,{key:1,variant:"danger",active:n.value==="no-scope",onClick:S[3]||(S[3]=T=>u("no-scope"))},{default:Fe(()=>[Ye(I(i.value)+" unassigned ",1)]),_:1},8,["active"])):D("",!0)])):D("",!0)]),r("div",RL,[r("div",OL,[ze(r("input",{"onUpdate:modelValue":S[4]||(S[4]=T=>a.value=T),type:"text",class:"search-input",placeholder:"Search by name, role, email, or phone..."},null,512),[[nt,a.value]])])]),Me(ug,{contacts:y.value,"show-notes":!0,"show-scopes":!0,"empty-message":k.value,areas:e.areas,locations:e.locations,marshals:e.marshals,onSelect:S[5]||(S[5]=T=>w.$emit("select-contact",T))},null,8,["contacts","empty-message","areas","locations","marshals"])]))}},NL=He(BL,[["__scopeId","data-v-55a2e118"]]),dg=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET/CEST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Australia/Sydney",label:"Sydney (AEDT/AEST)"}],FL={class:"event-details-tab"},UL={class:"event-info-card"},zL={class:"form-group"},HL={class:"form-group"},VL={class:"form-row"},GL={class:"form-group"},qL={class:"form-group"},jL=["value"],ZL={class:"form-actions"},WL=["disabled"],KL={__name:"EventDetailsTab",props:{eventData:{type:Object,required:!0},formDirty:{type:Boolean,default:!1}},emits:["submit","update:formDirty"],setup(e,{emit:t}){const o=e,a=t,n=A({...o.eventData});We(()=>o.eventData,u=>{n.value={...u}},{deep:!0});const i=()=>{a("update:formDirty",!0)},l=()=>{a("submit",{...n.value})};return(u,d)=>(v(),g("div",FL,[r("div",UL,[r("form",{onSubmit:lt(l,["prevent"]),class:"event-details-form"},[r("div",zL,[d[4]||(d[4]=r("label",null,"Event name",-1)),ze(r("input",{"onUpdate:modelValue":d[0]||(d[0]=h=>n.value.name=h),type:"text",required:"",class:"form-input",onInput:i},null,544),[[nt,n.value.name]])]),r("div",HL,[d[5]||(d[5]=r("label",null,"Description",-1)),ze(r("textarea",{"onUpdate:modelValue":d[1]||(d[1]=h=>n.value.description=h),rows:"3",class:"form-input",onInput:i},null,544),[[nt,n.value.description]])]),r("div",VL,[r("div",GL,[d[6]||(d[6]=r("label",null,"Event date & time",-1)),ze(r("input",{"onUpdate:modelValue":d[2]||(d[2]=h=>n.value.eventDate=h),type:"datetime-local",required:"",class:"form-input",onInput:i},null,544),[[nt,n.value.eventDate]])]),r("div",qL,[d[7]||(d[7]=r("label",null,"Time zone",-1)),ze(r("select",{"onUpdate:modelValue":d[3]||(d[3]=h=>n.value.timeZoneId=h),required:"",class:"form-input",onChange:i},[(v(!0),g(Ae,null,Ue(N(dg),h=>(v(),g("option",{key:h.value,value:h.value},I(h.label),9,jL))),128))],544),[[zn,n.value.timeZoneId]])])]),r("div",ZL,[r("button",{type:"submit",class:"btn btn-save",disabled:!e.formDirty}," Save ",8,WL)])],32)])]))}},JL=He(KL,[["__scopeId","data-v-2754c3cc"]]),YL={class:"admins-list"},XL={class:"admin-info"},QL={class:"admin-role"},eS=["onClick"],tS={__name:"AdminsList",props:{admins:{type:Array,required:!0}},emits:["add-admin","remove-admin"],setup(e){return(t,o)=>(v(),g("div",null,[r("button",{onClick:o[0]||(o[0]=a=>t.$emit("add-admin")),class:"btn btn-small btn-primary"}," Add administrator "),r("div",YL,[(v(!0),g(Ae,null,Ue(e.admins,a=>(v(),g("div",{key:a.userEmail,class:"admin-item"},[r("div",XL,[r("strong",null,I(a.userEmail),1),r("span",QL,I(a.role),1)]),e.admins.length>1?(v(),g("button",{key:0,onClick:n=>t.$emit("remove-admin",a.userEmail),class:"btn btn-small btn-danger"}," Remove ",8,eS)):D("",!0)]))),128))])]))}},nS=He(tS,[["__scopeId","data-v-e526860b"]]),Dn=[{name:"Charcoal",hex:"#2d3748"},{name:"Dark Gray",hex:"#4a5568"},{name:"Gray",hex:"#718096"},{name:"Red",hex:"#f56565"},{name:"Coral",hex:"#ff6b6b"},{name:"Rose",hex:"#fb7185"},{name:"Pink",hex:"#ed64a6"},{name:"Magenta",hex:"#d946ef"},{name:"Fuchsia",hex:"#e879f9"},{name:"Purple",hex:"#9f7aea"},{name:"Violet",hex:"#a78bfa"},{name:"Lavender",hex:"#b197fc"},{name:"Indigo",hex:"#5a67d8"},{name:"Navy",hex:"#4263eb"},{name:"Blue",hex:"#667eea"},{name:"Sky",hex:"#0ea5e9"},{name:"Cyan",hex:"#0bc5ea"},{name:"Aqua",hex:"#22d3ee"},{name:"Teal",hex:"#38b2ac"},{name:"Emerald",hex:"#10b981"},{name:"Green",hex:"#48bb78"},{name:"Mint",hex:"#51cf66"},{name:"Lime",hex:"#84cc16"},{name:"Olive",hex:"#a3b18a"},{name:"Yellow",hex:"#ecc94b"},{name:"Amber",hex:"#f59e0b"},{name:"Orange",hex:"#ed8936"},{name:"Peach",hex:"#ff922b"},{name:"Light Gray",hex:"#cbd5e0"},{name:"Silver",hex:"#e2e8f0"},{name:"Cream",hex:"#f7fafc"}],zr="#667eea";function oS(e){const t=e.map(a=>a.color);return Dn.find(a=>!t.includes(a.hex))?.hex||zr}const sS={class:"modal-content"},aS={class:"modal-body"},iS={class:"preview-section"},lS={class:"map-preview"},rS=["innerHTML"],cS={class:"options-grid"},uS={class:"option-button-content"},dS={class:"option-button-value icon-value"},hS=["innerHTML"],fS={class:"option-button-content"},pS={class:"option-button-value color-value"},vS=["disabled"],mS={class:"option-button-content"},gS={class:"option-button-value color-value"},yS={class:"option-button-content"},kS={class:"option-button-value icon-value"},bS=["innerHTML"],_S=["disabled"],wS={class:"option-button-content"},CS={class:"option-button-value color-value"},LS={class:"option-button-content"},SS={class:"option-button-value"},IS={class:"option-button-content"},xS={class:"option-button-value"},$S={key:0,class:"centered-popup"},TS={class:"popup-grid"},MS=["onClick"],AS=["innerHTML"],ES={key:0},PS={key:1,class:"centered-popup"},DS={class:"popup-grid"},RS=["title","onClick"],OS=["innerHTML"],BS={key:0},NS={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},FS={key:1,class:"custom-check-mark"},US={key:0,class:"custom-hex-input"},zS={class:"hex-input-row"},HS=["disabled"],VS={key:0,class:"hex-error"},GS={key:2,class:"centered-popup"},qS={class:"popup-grid"},jS=["title","onClick"],ZS=["innerHTML"],WS={key:0},KS={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},JS={key:1,class:"custom-check-mark"},YS={key:0,class:"custom-hex-input"},XS={class:"hex-input-row"},QS=["disabled"],eI={key:0,class:"hex-error"},tI={key:3,class:"centered-popup icon-popup"},nI={class:"popup-grid"},oI=["onClick"],sI=["innerHTML"],aI={key:0},iI={key:4,class:"centered-popup"},lI={class:"popup-grid"},rI=["title","onClick"],cI=["innerHTML"],uI={key:0},dI={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},hI={key:1,class:"custom-check-mark"},fI={key:0,class:"custom-hex-input"},pI={class:"hex-input-row"},vI=["disabled"],mI={key:0,class:"hex-error"},gI={key:5,class:"centered-popup"},yI={class:"size-grid"},kI=["onClick"],bI=["innerHTML"],_I={key:6,class:"centered-popup"},wI={class:"rotation-content"},CI={class:"rotation-preview-container"},LI=["innerHTML"],SI={class:"rotation-control"},II={class:"rotation-slider-container"},xI=["value"],$I={class:"rotation-value"},TI={class:"rotation-presets"},MI="#667eea",AI={__name:"IconCustomizationModal",props:{isOpen:{type:Boolean,default:!1},iconType:{type:String,default:"none"},backgroundShape:{type:String,default:"circle"},backgroundColor:{type:String,default:""},borderColor:{type:String,default:""},iconColor:{type:String,default:""},size:{type:String,default:"100"},mapRotation:{type:[String,Number],default:""},level:{type:String,default:"checkpoint"},inheritedType:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""}},emits:["update:isOpen","apply","cancel"],setup(e,{emit:t}){const o=e,a=t,n=A(o.backgroundShape||"circle"),i=A(o.iconType||"none"),l=A(o.backgroundColor||""),u=A(o.borderColor||""),d=A(o.iconColor||""),h=A(o.size||"100"),f=A(o.mapRotation??""),m=A(null),y=A(!1),k=A(!1),w=A(!1),S=A(""),T=A(""),x=A(""),C=A(null),_=A(null),$=A(null),M=ce=>ce==="default"?o.inheritedBackgroundShape||"circle":ce==="none"?"none":ce||"circle",H=ce=>ce==="default"||!ce?O():ce==="none"?"transparent":ce,E=ce=>ce==="default"?o.inheritedBorderColor||"#ffffff":ce==="none"||!ce?"transparent":ce,B=ce=>{if(ce==="default"){const ue=o.inheritedType;return ue&&ue!=="default"&&gi(ue).category==="content"?ue:"none"}return ce==="none"||!ce?"none":ce},R=ce=>ce==="default"||!ce?o.inheritedIconColor||"#ffffff":ce==="none"?"transparent":ce,U=ce=>ce==="default"?o.inheritedSize||"100":ce||"100",F=ce=>{if(ce==="default"||ce===""){const ue=o.inheritedMapRotation;return ue!==""&&ue!==void 0&&ue!==null&&parseInt(ue,10)||0}return parseInt(ce,10)||0},j=V(()=>{const ce=o.inheritedBackgroundShape||"circle",ue=Mr.find(ke=>ke.value===ce)?.label||"Circle";return[{value:"none",label:"None",showLabel:!0},{value:"default",label:`Default (${ue})`,showLabel:!0},...Mr.filter(ke=>ke.value!=="none").map(ke=>({...ke,showLabel:!1}))]}),Y=V(()=>{const ce=ic.filter(st=>st.category==="content"),ue=[{value:"none",label:"None",category:"content",showLabel:!0}],ke=o.inheritedType;if(ke&&ke!=="default"){const st=gi(ke);st.category==="content"&&ue.push({value:"default",label:`Default (${st.label||ke})`,category:"content",showLabel:!0})}return ue.push(...ce.map(st=>({...st,showLabel:!1}))),ue}),oe=V(()=>{const ce={33:"Small",66:"Medium",100:"Normal",150:"Large"};return[{value:"default",label:`Default (${ce[o.inheritedSize]||"Normal"})`},...ww.map(ke=>({value:ke.value,label:ce[ke.value]||ke.label}))]}),Oe=V(()=>M(n.value)!=="none"),ee=V(()=>B(i.value)!=="none"),te=V(()=>{const ce=o.inheritedBackgroundColor;return ce&&ce!=="default"&&ce.startsWith("#")?ce:MI}),O=()=>te.value,Z=V(()=>l.value&&l.value!=="default"?l.value:O()),ne=V(()=>u.value==="none"?"transparent":u.value?u.value:o.inheritedBorderColor&&o.inheritedBorderColor!=="none"?o.inheritedBorderColor:"#ffffff"),pe=V(()=>d.value?d.value:o.inheritedIconColor?o.inheritedIconColor:"#ffffff"),we=V(()=>{const ce=te.value,ue=Dn.find(ke=>ke.hex.toLowerCase()===ce.toLowerCase())?.name||"Custom";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ue})`,showLabel:!0},...Dn.map(ke=>({hex:ke.hex,name:ke.name,showLabel:!1}))]}),Ze=V(()=>{const ce=o.inheritedBorderColor||"#ffffff",ue=ce==="#ffffff"?"White":Dn.find(ke=>ke.hex===ce)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ue})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Dn.filter(ke=>ke.hex!=="#ffffff").map(ke=>({hex:ke.hex,name:ke.name,showLabel:!1}))]}),Ne=V(()=>{const ce=o.inheritedIconColor||"#ffffff",ue=ce==="#ffffff"?"White":Dn.find(ke=>ke.hex===ce)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ue})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Dn.filter(ke=>ke.hex!=="#ffffff").map(ke=>({hex:ke.hex,name:ke.name,showLabel:!1}))]}),Ge=ce=>ce==="default"?!l.value||l.value==="default":l.value===ce,Xe=ce=>ce==="#ffffff"?!d.value||d.value==="#ffffff":d.value===ce,Q=V(()=>{const ce=l.value;return!ce||ce==="default"||ce==="none"?!1:!Dn.some(ue=>ue.hex.toLowerCase()===ce.toLowerCase())}),ye=V(()=>{const ce=u.value;return!ce||ce==="default"||ce==="none"||ce==="#ffffff"||ce==="#000000"?!1:!Dn.some(ue=>ue.hex.toLowerCase()===ce.toLowerCase())}),Ce=V(()=>{const ce=d.value;return!ce||ce==="default"||ce==="none"||ce==="#ffffff"||ce==="#000000"?!1:!Dn.some(ue=>ue.hex.toLowerCase()===ce.toLowerCase())}),me=V(()=>{if(!S.value)return!1;const ce=S.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(ce)||/^[0-9A-Fa-f]{3}$/.test(ce)}),ie=V(()=>{if(!T.value)return!1;const ce=T.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(ce)||/^[0-9A-Fa-f]{3}$/.test(ce)}),z=V(()=>{if(!x.value)return!1;const ce=x.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(ce)||/^[0-9A-Fa-f]{3}$/.test(ce)}),K=ce=>{if(ce==="none")return"None";if(ce==="default"){const ke=o.inheritedBackgroundShape;return ke?`Default (${Mr.find(qe=>qe.value===ke)?.label||"Circle"})`:"Default (Circle)"}const ue=Mr.find(ke=>ke.value===ce);return ue?ue.label:"Circle"},se=ce=>{if(ce==="none")return"None";if(ce==="default"){const ke=o.inheritedType;if(ke&&ke!=="default"){const st=gi(ke);if(st.category==="content")return`Default (${st.label||ke})`}return"Default"}const ue=ic.find(ke=>ke.value===ce);return ue?ue.label:"None"},Ee=ce=>{if(ce==="none")return"None";if(!ce||ce==="default"){const ke=te.value;return`Default (${Dn.find(qe=>qe.hex.toLowerCase()===ke.toLowerCase())?.name||"Custom"})`}const ue=[...Dn].find(ke=>ke.hex.toLowerCase()===ce.toLowerCase());return ue?ue.name:ce},Be=ce=>{if(ce==="none")return"None";if(ce==="default"){const ke=o.inheritedBorderColor;return ke&&ke!=="none"?`Default (${ke==="#ffffff"?"White":Dn.find(qe=>qe.hex===ke)?.name||"Custom"})`:"Default (White)"}if(!ce||ce==="#ffffff")return"White";const ue=[...Ze.value].find(ke=>ke.hex===ce);return ue?ue.name:ce},Re=ce=>{if(ce==="none")return"None";if(ce==="default"){const ke=o.inheritedIconColor;return ke?`Default (${ke==="#ffffff"?"White":Dn.find(qe=>qe.hex===ke)?.name||"Custom"})`:"Default (White)"}if(!ce||ce==="#ffffff")return"White";const ue=[...Ne.value].find(ke=>ke.hex===ce);return ue?ue.name:ce},Se=ce=>{const ue={33:"Small",66:"Medium",100:"Normal",150:"Large"};if(ce==="default"){const ke=o.inheritedSize;return`Default (${ue[ke]||"Normal"})`}return ue[ce]||"Normal"},X=ce=>{if(ce==="default"||ce===""||ce===void 0||ce===null){const ue=o.inheritedMapRotation;return ue!==""&&ue!==void 0&&ue!==null?`Default (${ue})`:"Default (0)"}return`${ce}`},he=ce=>{if(ce==="none")return`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`;const ue=M(ce),ke=H(l.value),st=E(u.value);return Ji[ue]?`<svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">${Ji[ue]({backgroundColor:ke,borderColor:st==="transparent"?"none":st})}</svg>`:""},Te=ce=>{const ue=B(ce);return ue==="none"?`<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
      <rect x="1" y="1" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`:Tn({type:ue,backgroundShape:"circle",backgroundColor:"#94a3b8",borderColor:"none",iconColor:"#fff",size:"75"})},xe=ce=>{const ue=M(ce);if(ue==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="none" stroke="#ccc" stroke-width="2" stroke-dasharray="4"/>
    </svg>`;const ke=H(l.value),st=E(u.value),qe=B(i.value),Tt=R(d.value);return Tn({type:qe!=="none"?qe:ue,backgroundShape:ue,backgroundColor:ke,borderColor:st==="transparent"?"none":st,iconColor:Tt,size:"100",outputSize:28})},be=ce=>{const ue=H(ce),ke=M(n.value),st=E(u.value),qe=B(i.value),Tt=R(d.value);return ke==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ue==="transparent"?"#e2e8f0":ue}"/>
    </svg>`:Tn({type:qe!=="none"?qe:ke,backgroundShape:ke,backgroundColor:ue==="transparent"?"#e2e8f0":ue,borderColor:st==="transparent"?"none":st,iconColor:Tt,size:"100",outputSize:28})},de=ce=>{const ue=E(ce),ke=M(n.value),st=H(l.value),qe=B(i.value),Tt=R(d.value);return ke==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0" stroke="${ue}" stroke-width="2"/>
    </svg>`:Tn({type:qe!=="none"?qe:ke,backgroundShape:ke,backgroundColor:st,borderColor:ue==="transparent"?"none":ue,iconColor:Tt,size:"100",outputSize:28})},fe=ce=>{const ue=B(ce),ke=M(n.value),st=H(l.value),qe=E(u.value),Tt=R(d.value);if(ue==="none"&&ke==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0"/>
      <line x1="8" y1="8" x2="20" y2="20" stroke="#a0aec0" stroke-width="2" stroke-linecap="round"/>
    </svg>`;const Kt=ke!=="none"?ke:"circle";return Tn({type:ue!=="none"?ue:Kt,backgroundShape:Kt,backgroundColor:st,borderColor:qe==="transparent"?"none":qe,iconColor:Tt,size:"100",outputSize:42})},W=ce=>{const ue=R(ce),ke=M(n.value),st=H(l.value),qe=E(u.value),Tt=B(i.value);return Tt==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ue==="transparent"?"#e2e8f0":ue}"/>
    </svg>`:Tn({type:Tt,backgroundShape:ke!=="none"?ke:"circle",backgroundColor:st,borderColor:qe==="transparent"?"none":qe,iconColor:ue==="transparent"?"#e2e8f0":ue,size:"100",outputSize:28})},J=ce=>{const ue=U(ce),ke=M(n.value),st=H(l.value),qe=E(u.value),Tt=B(i.value),Kt=R(d.value);if(ke==="none"&&Tt==="none")return"";const en=ke!=="none"?ke:"circle";return Tn({type:Tt!=="none"?Tt:en,backgroundShape:en,backgroundColor:st,borderColor:qe==="transparent"?"none":qe,iconColor:Kt,size:ue})},re=V(()=>{const ce=M(n.value),ue=H(l.value),ke=E(u.value),st=B(i.value),qe=R(d.value),Tt=U(h.value);return ce==="none"&&st==="none"?"":Tn(ce==="none"&&st!=="none"?{type:st,backgroundShape:"none",backgroundColor:ue,borderColor:"none",iconColor:qe,size:Tt}:{type:st!=="none"?st:ce,backgroundShape:ce,backgroundColor:ue,borderColor:ke==="transparent"?"none":ke,iconColor:qe,size:Tt})}),je=ce=>{m.value=m.value===ce?null:ce},et=()=>{m.value=null,y.value=!1,k.value=!1,w.value=!1},dt=ce=>{n.value=ce,et()},kt=ce=>{l.value=ce,et()},gt=ce=>{u.value=ce,et()},St=ce=>{i.value=ce,et()},Lt=ce=>{d.value=ce,et()},Dt=ce=>{h.value=ce,et()},Vt=ce=>{f.value=ce,et()},ht=()=>{y.value=!y.value,y.value&&(Q.value?S.value=l.value.replace(/^#/,""):S.value="",cn(()=>C.value?.focus()))},Gt=()=>{k.value=!k.value,k.value&&(ye.value?T.value=u.value.replace(/^#/,""):T.value="",cn(()=>_.value?.focus()))},pn=()=>{w.value=!w.value,w.value&&(Ce.value?x.value=d.value.replace(/^#/,""):x.value="",cn(()=>$.value?.focus()))},Et=()=>{S.value=S.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},_t=()=>{T.value=T.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},Vn=()=>{x.value=x.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},kn=ce=>ce.length===3?ce[0]+ce[0]+ce[1]+ce[1]+ce[2]+ce[2]:ce,Qn=()=>{if(!me.value)return;const ce=kn(S.value);l.value="#"+ce,y.value=!1,et()},co=()=>{if(!ie.value)return;const ce=kn(T.value);u.value="#"+ce,k.value=!1,et()},Wt=()=>{if(!z.value)return;const ce=kn(x.value);d.value="#"+ce,w.value=!1,et()},ns=ce=>{f.value=ce};We(()=>o.isOpen,ce=>{if(ce){const ue=o.backgroundShape&&o.backgroundShape!=="default"&&o.backgroundShape!=="circle",ke=o.iconType&&o.iconType!=="none"&&o.iconType!=="default",st=o.backgroundColor&&o.backgroundColor!=="",qe=o.borderColor&&o.borderColor!=="",Tt=o.iconColor&&o.iconColor!=="",Kt=o.size&&o.size!==""&&o.size!=="100",en=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null&&o.mapRotation!==0;ue||ke||st||qe||Tt||Kt||en?(n.value=o.backgroundShape||"default",i.value=o.iconType||"default",l.value=o.backgroundColor||"default",u.value=o.borderColor||"default",d.value=o.iconColor||"default",h.value=o.size||"default",f.value=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null?o.mapRotation:"default"):(n.value="default",i.value="default",l.value="default",u.value="default",d.value="default",h.value="default",f.value="default"),m.value=null}});const Sn=()=>{et(),a("update:isOpen",!1),a("cancel")},bo=()=>{et();const ce=st=>st==="default"?"":st;let ue="";i.value==="none"?ue="none":i.value&&i.value!=="default"&&(ue=i.value);let ke="";f.value!=="default"&&f.value!==""&&f.value!==void 0&&(ke=parseInt(f.value,10)||0),a("apply",{iconType:ue,backgroundShape:ce(n.value),backgroundColor:ce(l.value),borderColor:ce(u.value),iconColor:ce(d.value),size:ce(h.value),mapRotation:ke}),a("update:isOpen",!1)};return(ce,ue)=>e.isOpen?(v(),g("div",{key:0,class:"modal-overlay",onClick:lt(Sn,["self"])},[r("div",sS,[r("div",{class:"modal-header"},[ue[18]||(ue[18]=r("h3",null,"Customise marker style",-1)),r("button",{class:"close-btn",onClick:Sn},"")]),r("div",aS,[r("div",iS,[r("div",lS,[ue[19]||(ue[19]=r("div",{class:"map-background"},null,-1)),r("div",{class:"preview-icon",style:Qe({transform:`rotate(${F(f.value)}deg)`}),innerHTML:re.value},null,12,rS)])]),r("div",cS,[r("button",{type:"button",class:ve(["option-button",{active:m.value==="shape"}]),onClick:ue[0]||(ue[0]=ke=>je("shape"))},[r("div",uS,[ue[20]||(ue[20]=r("span",{class:"option-button-label"},"Shape",-1)),r("div",dS,[r("div",{class:"icon-preview-small",innerHTML:he(n.value)},null,8,hS),r("span",null,I(K(n.value)),1)])]),ue[21]||(ue[21]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:ve(["option-button",{active:m.value==="bgColor"}]),onClick:ue[1]||(ue[1]=ke=>je("bgColor"))},[r("div",fS,[ue[22]||(ue[22]=r("span",{class:"option-button-label"},"Background",-1)),r("div",pS,[r("span",{class:"color-swatch",style:Qe({backgroundColor:Z.value})},null,4),r("span",null,I(Ee(l.value)),1)])]),ue[23]||(ue[23]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:ve(["option-button",{active:m.value==="borderColor",disabled:!Oe.value}]),disabled:!Oe.value,onClick:ue[2]||(ue[2]=ke=>je("borderColor"))},[r("div",mS,[ue[24]||(ue[24]=r("span",{class:"option-button-label"},"Border",-1)),r("div",gS,[r("span",{class:ve(["color-swatch",{"no-border":u.value==="none"}]),style:Qe(u.value!=="none"?{backgroundColor:ne.value}:{})},null,6),r("span",null,I(Be(u.value)),1)])]),ue[25]||(ue[25]=r("span",{class:"option-button-arrow"},"",-1))],10,vS),r("button",{type:"button",class:ve(["option-button",{active:m.value==="icon"}]),onClick:ue[3]||(ue[3]=ke=>je("icon"))},[r("div",yS,[ue[26]||(ue[26]=r("span",{class:"option-button-label"},"Icon",-1)),r("div",kS,[r("div",{class:"icon-preview-small",innerHTML:Te(i.value)},null,8,bS),r("span",null,I(se(i.value)),1)])]),ue[27]||(ue[27]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:ve(["option-button",{active:m.value==="iconColor",disabled:!ee.value}]),disabled:!ee.value,onClick:ue[4]||(ue[4]=ke=>je("iconColor"))},[r("div",wS,[ue[28]||(ue[28]=r("span",{class:"option-button-label"},"Colour",-1)),r("div",CS,[r("span",{class:"color-swatch",style:Qe({backgroundColor:pe.value})},null,4),r("span",null,I(Re(d.value)),1)])]),ue[29]||(ue[29]=r("span",{class:"option-button-arrow"},"",-1))],10,_S),r("button",{type:"button",class:ve(["option-button",{active:m.value==="size"}]),onClick:ue[5]||(ue[5]=ke=>je("size"))},[r("div",LS,[ue[30]||(ue[30]=r("span",{class:"option-button-label"},"Size",-1)),r("span",SS,I(Se(h.value)),1)]),ue[31]||(ue[31]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:ve(["option-button option-button-full",{active:m.value==="mapRotation"}]),onClick:ue[6]||(ue[6]=ke=>je("mapRotation"))},[r("div",IS,[ue[32]||(ue[32]=r("span",{class:"option-button-label"},"Map rotation",-1)),r("span",xS,I(X(f.value)),1)]),ue[33]||(ue[33]=r("span",{class:"option-button-arrow"},"",-1))],2)]),m.value==="shape"?(v(),g("div",$S,[r("div",{class:"popup-header"},[ue[34]||(ue[34]=r("span",null,"Select shape",-1)),r("button",{type:"button",class:"popup-close",onClick:et},"")]),r("div",TS,[(v(!0),g(Ae,null,Ue(j.value,ke=>(v(),g("button",{key:ke.value,type:"button",class:ve(["popup-grid-item",{selected:n.value===ke.value}]),onClick:st=>dt(ke.value)},[r("div",{class:"popup-item-preview",innerHTML:xe(ke.value)},null,8,AS),ke.showLabel?(v(),g("span",ES,I(ke.label),1)):D("",!0)],10,MS))),128))])])):D("",!0),m.value==="bgColor"?(v(),g("div",PS,[r("div",{class:"popup-header"},[ue[35]||(ue[35]=r("span",null,"Select background",-1)),r("button",{type:"button",class:"popup-close",onClick:et},"")]),r("div",DS,[(v(!0),g(Ae,null,Ue(we.value,ke=>(v(),g("button",{key:ke.hex,type:"button",class:ve(["popup-grid-item",{selected:Ge(ke.hex)}]),title:ke.name,onClick:st=>kt(ke.hex)},[r("div",{class:"popup-item-preview",innerHTML:be(ke.hex)},null,8,OS),ke.showLabel?(v(),g("span",BS,I(ke.name),1)):D("",!0)],10,RS))),128)),r("button",{type:"button",class:ve(["popup-grid-item custom-color-option",{selected:Q.value}]),style:Qe(Q.value?{"--custom-color":l.value}:{}),title:"Custom colour",onClick:ht},[r("div",{class:"popup-item-preview custom-color-preview",style:Qe(Q.value?{backgroundColor:l.value}:{})},[Q.value?D("",!0):(v(),g("svg",NS,[...ue[36]||(ue[36]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),Q.value?(v(),g("span",FS,"")):D("",!0)],4),ue[37]||(ue[37]=r("span",null,"Custom",-1))],6)]),y.value?(v(),g("div",US,[ue[39]||(ue[39]=r("label",null,"Enter hex code",-1)),r("div",zS,[ue[38]||(ue[38]=r("span",{class:"hex-prefix"},"#",-1)),ze(r("input",{ref_key:"bgHexInput",ref:C,"onUpdate:modelValue":ue[7]||(ue[7]=ke=>S.value=ke),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:S.value&&!me.value}]),onInput:Et,onKeydown:To(Qn,["enter"])},null,34),[[nt,S.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:me.value?"#"+S.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!me.value,onClick:Qn}," Apply ",8,HS)]),S.value&&!me.value?(v(),g("span",VS," Invalid hex code ")):D("",!0)])):D("",!0)])):D("",!0),m.value==="borderColor"?(v(),g("div",GS,[r("div",{class:"popup-header"},[ue[40]||(ue[40]=r("span",null,"Select border",-1)),r("button",{type:"button",class:"popup-close",onClick:et},"")]),r("div",qS,[(v(!0),g(Ae,null,Ue(Ze.value,ke=>(v(),g("button",{key:ke.hex,type:"button",class:ve(["popup-grid-item",{selected:u.value===ke.hex}]),title:ke.name,onClick:st=>gt(ke.hex)},[r("div",{class:"popup-item-preview",innerHTML:de(ke.hex)},null,8,ZS),ke.showLabel?(v(),g("span",WS,I(ke.name),1)):D("",!0)],10,jS))),128)),r("button",{type:"button",class:ve(["popup-grid-item custom-color-option",{selected:ye.value}]),style:Qe(ye.value?{"--custom-color":u.value}:{}),title:"Custom colour",onClick:Gt},[r("div",{class:"popup-item-preview custom-color-preview",style:Qe(ye.value?{backgroundColor:u.value}:{})},[ye.value?D("",!0):(v(),g("svg",KS,[...ue[41]||(ue[41]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),ye.value?(v(),g("span",JS,"")):D("",!0)],4),ue[42]||(ue[42]=r("span",null,"Custom",-1))],6)]),k.value?(v(),g("div",YS,[ue[44]||(ue[44]=r("label",null,"Enter hex code",-1)),r("div",XS,[ue[43]||(ue[43]=r("span",{class:"hex-prefix"},"#",-1)),ze(r("input",{ref_key:"borderHexInput",ref:_,"onUpdate:modelValue":ue[8]||(ue[8]=ke=>T.value=ke),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:T.value&&!ie.value}]),onInput:_t,onKeydown:To(co,["enter"])},null,34),[[nt,T.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:ie.value?"#"+T.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!ie.value,onClick:co}," Apply ",8,QS)]),T.value&&!ie.value?(v(),g("span",eI," Invalid hex code ")):D("",!0)])):D("",!0)])):D("",!0),m.value==="icon"?(v(),g("div",tI,[r("div",{class:"popup-header"},[ue[45]||(ue[45]=r("span",null,"Select icon",-1)),r("button",{type:"button",class:"popup-close",onClick:et},"")]),r("div",nI,[(v(!0),g(Ae,null,Ue(Y.value,ke=>(v(),g("button",{key:ke.value,type:"button",class:ve(["popup-grid-item",{selected:i.value===ke.value}]),onClick:st=>St(ke.value)},[r("div",{class:"popup-item-preview",innerHTML:fe(ke.value)},null,8,sI),ke.showLabel?(v(),g("span",aI,I(ke.label),1)):D("",!0)],10,oI))),128))])])):D("",!0),m.value==="iconColor"?(v(),g("div",iI,[r("div",{class:"popup-header"},[ue[46]||(ue[46]=r("span",null,"Select colour",-1)),r("button",{type:"button",class:"popup-close",onClick:et},"")]),r("div",lI,[(v(!0),g(Ae,null,Ue(Ne.value,ke=>(v(),g("button",{key:ke.hex,type:"button",class:ve(["popup-grid-item",{selected:Xe(ke.hex)}]),title:ke.name,onClick:st=>Lt(ke.hex)},[r("div",{class:"popup-item-preview",innerHTML:W(ke.hex)},null,8,cI),ke.showLabel?(v(),g("span",uI,I(ke.name),1)):D("",!0)],10,rI))),128)),r("button",{type:"button",class:ve(["popup-grid-item custom-color-option",{selected:Ce.value}]),style:Qe(Ce.value?{"--custom-color":d.value}:{}),title:"Custom colour",onClick:pn},[r("div",{class:"popup-item-preview custom-color-preview",style:Qe(Ce.value?{backgroundColor:d.value}:{})},[Ce.value?D("",!0):(v(),g("svg",dI,[...ue[47]||(ue[47]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),Ce.value?(v(),g("span",hI,"")):D("",!0)],4),ue[48]||(ue[48]=r("span",null,"Custom",-1))],6)]),w.value?(v(),g("div",fI,[ue[50]||(ue[50]=r("label",null,"Enter hex code",-1)),r("div",pI,[ue[49]||(ue[49]=r("span",{class:"hex-prefix"},"#",-1)),ze(r("input",{ref_key:"iconHexInput",ref:$,"onUpdate:modelValue":ue[9]||(ue[9]=ke=>x.value=ke),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:x.value&&!z.value}]),onInput:Vn,onKeydown:To(Wt,["enter"])},null,34),[[nt,x.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:z.value?"#"+x.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!z.value,onClick:Wt}," Apply ",8,vI)]),x.value&&!z.value?(v(),g("span",mI," Invalid hex code ")):D("",!0)])):D("",!0)])):D("",!0),m.value==="size"?(v(),g("div",gI,[r("div",{class:"popup-header"},[ue[51]||(ue[51]=r("span",null,"Select size",-1)),r("button",{type:"button",class:"popup-close",onClick:et},"")]),r("div",yI,[(v(!0),g(Ae,null,Ue(oe.value,ke=>(v(),g("button",{key:ke.value,type:"button",class:ve(["size-grid-item",{selected:h.value===ke.value}]),onClick:st=>Dt(ke.value)},[r("div",{class:"size-preview",innerHTML:J(ke.value)},null,8,bI),r("span",null,I(ke.label),1)],10,kI))),128))])])):D("",!0),m.value==="mapRotation"?(v(),g("div",_I,[r("div",{class:"popup-header"},[ue[52]||(ue[52]=r("span",null,"Set map rotation",-1)),r("button",{type:"button",class:"popup-close",onClick:et},"")]),r("div",wI,[r("div",CI,[r("div",{class:"rotation-preview-icon",style:Qe({transform:`rotate(${F(f.value)}deg)`}),innerHTML:re.value},null,12,LI)]),ue[53]||(ue[53]=r("p",{class:"rotation-description"}," Rotate the marker on the map. This rotation is added to any map rotation. ",-1)),r("div",SI,[r("button",{type:"button",class:ve(["rotation-preset",{selected:f.value==="default"||f.value===""}]),onClick:ue[10]||(ue[10]=ke=>Vt("default"))}," Default ",2),r("div",II,[r("input",{type:"range",min:"-180",max:"180",step:"5",class:"rotation-slider",value:f.value==="default"||f.value===""?0:f.value,onInput:ue[11]||(ue[11]=ke=>ns(parseInt(ke.target.value,10)))},null,40,xI),r("div",$I,I(f.value==="default"||f.value===""?"0":f.value)+" ",1)])]),r("div",TI,[r("button",{type:"button",class:ve(["rotation-preset-btn",{selected:f.value===-90}]),onClick:ue[12]||(ue[12]=ke=>Vt(-90))},"-90",2),r("button",{type:"button",class:ve(["rotation-preset-btn",{selected:f.value===-45}]),onClick:ue[13]||(ue[13]=ke=>Vt(-45))},"-45",2),r("button",{type:"button",class:ve(["rotation-preset-btn",{selected:f.value===0}]),onClick:ue[14]||(ue[14]=ke=>Vt(0))},"0",2),r("button",{type:"button",class:ve(["rotation-preset-btn",{selected:f.value===45}]),onClick:ue[15]||(ue[15]=ke=>Vt(45))},"+45",2),r("button",{type:"button",class:ve(["rotation-preset-btn",{selected:f.value===90}]),onClick:ue[16]||(ue[16]=ke=>Vt(90))},"+90",2),r("button",{type:"button",class:ve(["rotation-preset-btn",{selected:f.value===180}]),onClick:ue[17]||(ue[17]=ke=>Vt(180))},"180",2)])])])):D("",!0)]),r("div",{class:"modal-footer"},[r("button",{type:"button",class:"btn-cancel",onClick:Sn},"Cancel"),r("button",{type:"button",class:"btn-apply",onClick:bo},"Apply")])])])):D("",!0)}},EI=He(AI,[["__scopeId","data-v-bbab1a46"]]),PI={class:"checkpoint-style-picker"},DI={class:"form-group"},RI={class:"style-options"},OI=["innerHTML"],BI={class:"option-label"},NI=["innerHTML"],FI="#667eea",UI={__name:"CheckpointStylePicker",props:{styleType:{type:String,default:"default"},styleColor:{type:String,default:""},styleBackgroundShape:{type:String,default:""},styleBackgroundColor:{type:String,default:""},styleBorderColor:{type:String,default:""},styleIconColor:{type:String,default:""},styleSize:{type:String,default:""},styleMapRotation:{type:[String,Number],default:""},iconLabel:{type:String,default:"Marker style"},showPreview:{type:Boolean,default:!0},inheritedStyleType:{type:String,default:"default"},inheritedStyleColor:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""},defaultLabel:{type:String,default:"Default"},level:{type:String,default:"checkpoint"}},emits:["update:styleType","update:styleColor","update:styleBackgroundShape","update:styleBackgroundColor","update:styleBorderColor","update:styleIconColor","update:styleSize","update:styleMapRotation","change"],setup(e,{emit:t}){const o=e,a=t,n=A(o.styleType),i=A(o.styleColor||""),l=A(o.styleBackgroundShape||"default"),u=A(o.styleBackgroundColor||""),d=A(o.styleBorderColor||""),h=A(o.styleIconColor||""),f=A(o.styleSize||"default"),m=A(o.styleMapRotation||""),y=F=>!F||F==="default"?!1:gi(F).category==="content",k=A(o.styleType&&o.styleType!=="default"&&o.styleType!=="custom"&&y(o.styleType)?o.styleType:"default"),w=A(!1),S=V(()=>!!(n.value&&n.value!=="default"||l.value&&l.value!=="default"&&l.value!=="circle"||u.value||d.value||h.value||f.value&&f.value!=="default"&&f.value!=="100")),T=F=>F&&F!==""&&F!=="default",x=F=>F&&F.startsWith("#"),C=V(()=>{const j=T(o.inheritedStyleType),Y=T(o.inheritedBackgroundShape),oe=x(o.inheritedBackgroundColor)||x(o.inheritedStyleColor),Oe=x(o.inheritedBorderColor),ee=x(o.inheritedIconColor),te=T(o.inheritedSize);if(j||Y||oe||Oe||ee||te){const Z=j?o.inheritedStyleType:Y?o.inheritedBackgroundShape:"circle",ne=(x(o.inheritedBackgroundColor)?o.inheritedBackgroundColor:null)||(x(o.inheritedStyleColor)?o.inheritedStyleColor:null)||FI;return Tn({type:Z,backgroundShape:o.inheritedBackgroundShape||"circle",backgroundColor:ne,borderColor:o.inheritedBorderColor||"#ffffff",iconColor:o.inheritedIconColor||"#ffffff",size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#10B981"/>
        <stop offset="50%" style="stop-color:#F59E0B"/>
        <stop offset="100%" style="stop-color:#EF4444"/>
      </linearGradient>
    </defs>
    <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#defaultGradient)" stroke="#fff" stroke-width="1.5"/>
  </svg>`}),_=V(()=>{const F=o.inheritedMapRotation;return F!==""&&F!==void 0&&F!==null&&F!==0?{transform:`rotate(${F}deg)`}:{}}),$=V(()=>{if(m.value!==""&&m.value!==void 0&&m.value!==null){const j=parseInt(m.value,10)||0;if(j!==0)return{transform:`rotate(${j}deg)`}}const F=o.inheritedMapRotation;return F!==""&&F!==void 0&&F!==null&&F!==0?{transform:`rotate(${F}deg)`}:{}}),M=V(()=>{if(S.value){const F=k.value&&k.value!=="none"&&k.value!=="default";let j=null;o.inheritedStyleType&&o.inheritedStyleType!=="default"&&o.inheritedStyleType!=="custom"&&gi(o.inheritedStyleType).category==="content"&&(j=o.inheritedStyleType);const Y=k.value==="default"&&j,oe=F||Y,Oe=F?k.value:Y?j:null,ee=l.value&&l.value!=="default"?l.value:o.inheritedBackgroundShape||"circle",te=oe?Oe:ee,O=u.value||o.inheritedBackgroundColor||o.inheritedStyleColor||"#667eea",Z=d.value||o.inheritedBorderColor||"#ffffff",ne=h.value||o.inheritedIconColor||"#ffffff";return Tn({type:te,backgroundShape:ee,backgroundColor:O,borderColor:Z,iconColor:ne,size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#e2e8f0" stroke="#cbd5e0" stroke-width="1.5"/>
    <path d="M12 8v8M8 12h8" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
  </svg>`}),H=()=>{n.value="default",k.value="default",a("update:styleType","default"),l.value="default",u.value="",i.value="",d.value="",h.value="",f.value="default",m.value="",a("update:styleBackgroundShape",""),a("update:styleBackgroundColor",""),a("update:styleColor",""),a("update:styleBorderColor",""),a("update:styleIconColor",""),a("update:styleSize",""),a("update:styleMapRotation",""),U()},E=()=>{w.value=!0},B=F=>{F.iconType==="none"?k.value="none":F.iconType?k.value=F.iconType:k.value="default",l.value=F.backgroundShape||"default",u.value=F.backgroundColor||"",d.value=F.borderColor||"",h.value=F.iconColor||"",f.value=F.size||"default",m.value=F.mapRotation??"";const j=F.iconType==="none"||F.iconType&&F.iconType!==""||F.backgroundShape||F.backgroundColor||F.borderColor||F.iconColor||F.size||F.mapRotation!==""&&F.mapRotation!==0;F.iconType&&F.iconType!=="none"?n.value=F.iconType:j?n.value="custom":n.value="default",a("update:styleType",n.value),a("update:styleBackgroundShape",F.backgroundShape),a("update:styleBackgroundColor",F.backgroundColor),a("update:styleBorderColor",F.borderColor),a("update:styleIconColor",F.iconColor),a("update:styleSize",F.size),a("update:styleMapRotation",F.mapRotation??""),U()},R=()=>{},U=()=>{a("change",{styleType:n.value,styleColor:u.value||i.value,styleBackgroundShape:l.value,styleBackgroundColor:u.value,styleBorderColor:d.value,styleIconColor:h.value,styleSize:f.value,styleMapRotation:m.value})};return We(()=>o.styleType,F=>{n.value=F,F&&F!=="default"&&F!=="custom"&&y(F)?k.value=F:k.value="default"}),We(()=>o.styleColor,F=>{i.value=F||""}),We(()=>o.styleBackgroundShape,F=>{l.value=F||"default"}),We(()=>o.styleBackgroundColor,F=>{u.value=F||""}),We(()=>o.styleBorderColor,F=>{d.value=F||""}),We(()=>o.styleIconColor,F=>{h.value=F||""}),We(()=>o.styleSize,F=>{f.value=F||"default"}),We(()=>o.styleMapRotation,F=>{m.value=F??""}),(F,j)=>(v(),g("div",PI,[r("div",DI,[r("label",null,I(e.iconLabel),1),r("div",RI,[r("button",{type:"button",class:ve(["style-option-button",{selected:!S.value}]),onClick:H},[r("div",{class:"option-preview",style:Qe(_.value),innerHTML:C.value},null,12,OI),r("span",BI,I(e.defaultLabel),1)],2),r("button",{type:"button",class:ve(["style-option-button",{selected:S.value}]),onClick:E},[r("div",{class:"option-preview",style:Qe($.value),innerHTML:M.value},null,12,NI),j[1]||(j[1]=r("span",{class:"option-label"},"Custom",-1))],2)])]),Me(EI,{isOpen:w.value,"onUpdate:isOpen":j[0]||(j[0]=Y=>w.value=Y),"icon-type":k.value,"background-shape":l.value,"background-color":u.value,"border-color":d.value,"icon-color":h.value,size:f.value,"map-rotation":m.value,level:e.level,"inherited-type":e.inheritedStyleType,"inherited-background-shape":e.inheritedBackgroundShape,"inherited-background-color":e.inheritedBackgroundColor||e.inheritedStyleColor,"inherited-border-color":e.inheritedBorderColor,"inherited-icon-color":e.inheritedIconColor,"inherited-size":e.inheritedSize,"inherited-map-rotation":e.inheritedMapRotation,onApply:B,onCancel:R},null,8,["isOpen","icon-type","background-shape","background-color","border-color","icon-color","size","map-rotation","level","inherited-type","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])]))}},Gd=He(UI,[["__scopeId","data-v-c066da64"]]),zI={class:"logo-uploader"},HI={key:0,class:"logo-preview"},VI=["src"],GI=["disabled"],qI={key:0,class:"upload-progress"},jI={key:1,class:"upload-prompt"},ZI={key:2,class:"error-message"},Wf=5*1024*1024,WI={__name:"LogoUploader",props:{modelValue:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0},staged:{type:Boolean,default:!1}},emits:["update:modelValue","staged-change"],setup(e,{expose:t,emit:o}){const a=ee=>ee?ee.startsWith("/api")?Ia+ee.substring(4):ee:"",n=e;function i(){const ee={},te=localStorage.getItem("adminEmail");te&&(ee["X-Admin-Email"]=te);const O=localStorage.getItem("sessionToken");return O&&(ee.Authorization=`Bearer ${O}`),ee}const l=o;function u(){l("staged-change",{hasPendingChanges:k.value!==null||S.value,isPendingDelete:S.value,displayUrl:w.value||(S.value?"":n.modelValue)||""})}const d=A(null),h=A(!1),f=A(!1),m=A(""),y=A(Date.now()),k=A(null),w=A(""),S=A(!1),T=V(()=>{if(n.staged){if(w.value)return!0;if(S.value)return!1}return!!n.modelValue}),x=V(()=>{if(n.staged&&S.value)return"";if(n.staged&&w.value)return w.value;if(!n.modelValue)return"";const ee=a(n.modelValue),te=ee.includes("?")?"&":"?";return`${ee}${te}_t=${y.value}`});function C(){w.value&&(URL.revokeObjectURL(w.value),w.value="")}Ln(()=>{C()});const _=["image/png","image/jpeg","image/svg+xml","image/gif","image/webp"];function $(){h.value||d.value?.click()}function M(ee){const te=ee.target.files?.[0];te&&E(te),d.value&&(d.value.value="")}function H(ee){f.value=!1;const te=ee.dataTransfer?.files?.[0];te&&E(te)}async function E(ee){if(m.value="",!_.includes(ee.type)){m.value="Invalid file type. Please use PNG, JPEG, SVG, GIF, or WebP.";return}if(ee.size>Wf){m.value=`File too large. Maximum size is ${Wf/(1024*1024)}MB.`;return}if(n.staged){C(),k.value=ee,w.value=URL.createObjectURL(ee),S.value=!1,u();return}h.value=!0;try{const te=await fetch(`${Ia}/events/${n.eventId}/logo`,{method:"POST",headers:{"Content-Type":ee.type,...i()},body:ee});if(!te.ok){const Z=await te.text().catch(()=>"");let ne=`Upload failed (${te.status})`;try{ne=JSON.parse(Z).message||ne}catch{Z&&(ne=Z)}throw new Error(ne)}const O=await te.json();y.value=Date.now(),l("update:modelValue",O.logoUrl)}catch(te){console.error("Logo upload error:",te),te.name==="TypeError"&&te.message==="Failed to fetch"?m.value="Network error. Check your connection or try a smaller file.":te.message?.includes("401")||te.message?.includes("403")?m.value="Not authorized. Please refresh the page and try again.":m.value=te.message||"Failed to upload logo. Please try again."}finally{h.value=!1}}async function B(){if(m.value="",n.staged){k.value?(C(),k.value=null):n.modelValue&&(S.value=!0),u();return}h.value=!0;try{const ee=await fetch(`${Ia}/events/${n.eventId}/logo`,{method:"DELETE",headers:i()});if(!ee.ok){const te=await ee.json().catch(()=>({}));throw new Error(te.message||"Delete failed")}l("update:modelValue","")}catch(ee){console.error("Logo delete error:",ee),m.value=ee.message||"Failed to remove logo. Please try again."}finally{h.value=!1}}async function R(){if(!k.value)return{success:!0,logoUrl:S.value?"":n.modelValue};h.value=!0,m.value="";try{const ee=await fetch(`${Ia}/events/${n.eventId}/logo`,{method:"POST",headers:{"Content-Type":k.value.type,...i()},body:k.value});if(!ee.ok){const O=await ee.text().catch(()=>"");let Z=`Upload failed (${ee.status})`;try{Z=JSON.parse(O).message||Z}catch{O&&(Z=O)}throw new Error(Z)}const te=await ee.json();return y.value=Date.now(),C(),k.value=null,S.value=!1,{success:!0,logoUrl:te.logoUrl}}catch(ee){return console.error("Logo upload error:",ee),m.value=ee.message||"Failed to upload logo. Please try again.",{success:!1,error:ee.message}}finally{h.value=!1}}async function U(){if(!S.value)return{success:!0};h.value=!0,m.value="";try{const ee=await fetch(`${Ia}/events/${n.eventId}/logo`,{method:"DELETE",headers:i()});if(!ee.ok){const te=await ee.json().catch(()=>({}));throw new Error(te.message||"Delete failed")}return S.value=!1,{success:!0}}catch(ee){return console.error("Logo delete error:",ee),m.value=ee.message||"Failed to remove logo. Please try again.",{success:!1,error:ee.message}}finally{h.value=!1}}function F(){return k.value!==null||S.value}function j(){return k.value}function Y(){return S.value}function oe(){return w.value?w.value:S.value?"":a(n.modelValue)||""}function Oe(){C(),k.value=null,S.value=!1}return t({uploadStagedFile:R,deleteStagedLogo:U,hasPendingChanges:F,getStagedFile:j,isPendingDelete:Y,getDisplayUrl:oe,resetStagedState:Oe}),(ee,te)=>(v(),g("div",zI,[te[4]||(te[4]=r("label",{class:"uploader-label"},"Event Logo",-1)),T.value?(v(),g("div",HI,[r("img",{src:x.value,alt:"Event logo",class:"logo-image"},null,8,VI),r("button",{type:"button",class:"remove-btn",onClick:B,disabled:h.value}," Remove ",8,GI)])):(v(),g("div",{key:1,class:ve(["upload-area",{"drag-over":f.value,uploading:h.value}]),onDragover:te[0]||(te[0]=lt(O=>f.value=!0,["prevent"])),onDragleave:te[1]||(te[1]=lt(O=>f.value=!1,["prevent"])),onDrop:lt(H,["prevent"]),onClick:$},[r("input",{ref_key:"fileInput",ref:d,type:"file",accept:"image/png,image/jpeg,image/svg+xml,image/gif,image/webp",class:"file-input",onChange:M},null,544),h.value?(v(),g("div",qI,[...te[2]||(te[2]=[r("div",{class:"spinner"},null,-1),r("span",null,"Uploading...",-1)])])):(v(),g("div",jI,[...te[3]||(te[3]=[r("div",{class:"upload-icon"},"+",-1),r("span",{class:"upload-text"},"Click or drag to upload logo",-1),r("span",{class:"upload-hint"},"PNG, JPEG, SVG, GIF, WebP (max 5MB)",-1)])]))],34)),m.value?(v(),g("div",ZI,I(m.value),1)):D("",!0)]))}},KI=He(WI,[["__scopeId","data-v-bfb1b332"]]),hg=[{name:"Default",headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},{name:"Wasp",headerGradientStart:"#333333",headerGradientEnd:"#333333",accentColor:"#FFD700",pageGradientStart:"#FFD700",pageGradientEnd:"#333333"},{name:"Ocean",headerGradientStart:"#0077be",headerGradientEnd:"#00a8e8",accentColor:"#0077be",pageGradientStart:"#0077be",pageGradientEnd:"#00a8e8"},{name:"Forest",headerGradientStart:"#228b22",headerGradientEnd:"#32cd32",accentColor:"#228b22",pageGradientStart:"#228b22",pageGradientEnd:"#32cd32"},{name:"Sunset",headerGradientStart:"#ff6b35",headerGradientEnd:"#f7931e",accentColor:"#ff6b35",pageGradientStart:"#ff6b35",pageGradientEnd:"#f7931e"},{name:"Berry",headerGradientStart:"#8e2de2",headerGradientEnd:"#4a00e0",accentColor:"#8e2de2",pageGradientStart:"#8e2de2",pageGradientEnd:"#4a00e0"},{name:"Coral",headerGradientStart:"#ff758c",headerGradientEnd:"#ff7eb3",accentColor:"#ff758c",pageGradientStart:"#ff758c",pageGradientEnd:"#ff7eb3"},{name:"Steel",headerGradientStart:"#485563",headerGradientEnd:"#29323c",accentColor:"#485563",pageGradientStart:"#485563",pageGradientEnd:"#29323c"},{name:"Mint",headerGradientStart:"#11998e",headerGradientEnd:"#38ef7d",accentColor:"#11998e",pageGradientStart:"#11998e",pageGradientEnd:"#38ef7d"},{name:"Cherry",headerGradientStart:"#eb3349",headerGradientEnd:"#f45c43",accentColor:"#eb3349",pageGradientStart:"#eb3349",pageGradientEnd:"#f45c43"},{name:"Midnight",headerGradientStart:"#232526",headerGradientEnd:"#414345",accentColor:"#5c5c5c",pageGradientStart:"#232526",pageGradientEnd:"#414345"},{name:"Lavender",headerGradientStart:"#a18cd1",headerGradientEnd:"#fbc2eb",accentColor:"#a18cd1",pageGradientStart:"#a18cd1",pageGradientEnd:"#fbc2eb"},{name:"Gold",headerGradientStart:"#f7971e",headerGradientEnd:"#ffd200",accentColor:"#f7971e",pageGradientStart:"#f7971e",pageGradientEnd:"#ffd200"}];function JI(){return{...hg[0]}}function YI(e,t){return{...e,headerGradientStart:t.headerGradientStart,headerGradientEnd:t.headerGradientEnd,accentColor:t.accentColor,pageGradientStart:t.pageGradientStart,pageGradientEnd:t.pageGradientEnd,logoUrl:e.logoUrl||"",logoPosition:e.logoPosition||""}}function hd(e){const t=e.replace("#",""),o=parseInt(t.slice(0,2),16)/255,a=parseInt(t.slice(2,4),16)/255,n=parseInt(t.slice(4,6),16)/255,i=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),l=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),u=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4);return .2126*i+.7152*l+.0722*u}function fd(e){return!e||e===""?"#ffffff":hd(e)>.179?"#333333":"#ffffff"}function fg(e,t){const o=e||hn.headerGradientStart,a=t||hn.headerGradientEnd,n=hd(o),i=hd(a);return(n+i)/2>.35?"#333333":"#ffffff"}const hn={headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},XI={class:"marshal-mockup-container"},QI={class:"presets-section"},ex={class:"presets-row"},tx=["title","onClick"],nx={class:"preset-name"},ox={class:"mockup-frame"},sx={key:0,class:"logo-cover-bg"},ax=["src"],ix=["src"],lx={class:"header-center"},rx={class:"event-name"},cx={class:"mockup-buttons"},ux=["src"],dx={class:"mockup-body"},hx={class:"mockup-card"},fx={class:"card-content"},px={class:"editor-header"},vx={class:"editor-content"},mx={class:"color-grid-inline"},gx={class:"color-field"},yx={class:"color-swatches"},kx=["title","onClick"],bx={key:0,class:"check"},_x={class:"custom-color-wrapper"},wx={class:"hex-popup-header"},Cx={class:"hex-input-row"},Lx=["disabled"],Sx={key:0,class:"hex-error"},Ix={class:"gradient-toggle"},xx={key:0,class:"color-field"},$x={class:"color-swatches"},Tx=["title","onClick"],Mx={key:0,class:"check"},Ax={class:"custom-color-wrapper"},Ex={class:"hex-popup-header"},Px={class:"hex-input-row"},Dx=["disabled"],Rx={key:0,class:"hex-error"},Ox={key:1,class:"logo-position-section"},Bx={class:"position-buttons"},Nx={class:"color-swatches"},Fx=["title","onClick"],Ux={key:0,class:"check"},zx={class:"custom-color-wrapper"},Hx={class:"hex-popup-header"},Vx={class:"hex-input-row"},Gx=["disabled"],qx={key:0,class:"hex-error"},jx={class:"color-grid-inline"},Zx={class:"color-field"},Wx={class:"color-swatches"},Kx=["title","onClick"],Jx={key:0,class:"check"},Yx={class:"custom-color-wrapper"},Xx={class:"hex-popup-header"},Qx={class:"hex-input-row"},e$=["disabled"],t$={key:0,class:"hex-error"},n$={class:"gradient-toggle"},o$={key:0,class:"color-field"},s$={class:"color-swatches"},a$=["title","onClick"],i$={key:0,class:"check"},l$={class:"custom-color-wrapper"},r$={class:"hex-popup-header"},c$={class:"hex-input-row"},u$=["disabled"],d$={key:0,class:"hex-error"},h$={class:"editor-footer"},f$={__name:"MarshalModeMockup",props:{branding:{type:Object,required:!0},eventName:{type:String,default:""},eventDate:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:branding","logo-staged-change"],setup(e,{expose:t,emit:o}){const a=Se=>Se?Se.startsWith("/api")?Ia+Se.substring(4):Se:"",n=Dn,i=e,l=o,u=A(null),d=hg,h=A(!1),f=A(!1),m=A(null),y=A(!1),k=A(""),w=Se=>{typeof Se=="object"&&Se!==null?(y.value=Se.isPendingDelete,k.value=Se.displayUrl||"",l("logo-staged-change",Se.hasPendingChanges)):(m.value&&(y.value=m.value.isPendingDelete(),k.value=m.value.getDisplayUrl()||""),l("logo-staged-change",!!Se))},S=A(null),T=A(""),x=A(null),C=A(null),_=A({left:"50%",right:"auto",transform:"translateX(-50%)"}),$=Se=>Se?!n.some(X=>X.hex.toLowerCase()===Se.toLowerCase()):!1,M=Se=>!Se||!$(Se)?"#666666":fd(Se),H=Se=>!Se||!$(Se)?"#e0e0e0":Se,E=V(()=>{if(!T.value)return!1;const Se=T.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(Se)||/^[0-9A-Fa-f]{3}$/.test(Se)}),B=(Se,X)=>{if(S.value===Se)S.value=null;else{S.value=Se;let he="";switch(Se){case"headerStart":he=i.branding.headerGradientStart;break;case"headerEnd":he=i.branding.headerGradientEnd;break;case"pageStart":he=i.branding.pageGradientStart;break;case"pageEnd":he=i.branding.pageGradientEnd;break;case"accent":he=i.branding.accentColor;break}if(he&&$(he)?T.value=he.replace(/^#/,""):T.value="",X&&C.value){const Te=X.currentTarget,xe=C.value,be=Te.getBoundingClientRect(),de=xe.getBoundingClientRect(),fe=220,W=12,J=be.left+be.width/2-de.left,re=de.width,je=J-fe/2;J+fe/2>re-W?_.value={left:"auto",right:"0",transform:"none"}:je<W?_.value={left:"0",right:"auto",transform:"none"}:_.value={left:"50%",right:"auto",transform:"translateX(-50%)"}}cn(()=>x.value?.focus())}},R=()=>{T.value=T.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},U=()=>{if(!E.value||!S.value)return;let Se=T.value;Se.length===3&&(Se=Se[0]+Se[0]+Se[1]+Se[1]+Se[2]+Se[2]);const X="#"+Se;switch(S.value){case"headerStart":ye("start",X);break;case"headerEnd":Q("headerGradientEnd",X);break;case"pageStart":Ce("start",X);break;case"pageEnd":Q("pageGradientEnd",X);break;case"accent":Q("accentColor",X);break}S.value=null};We(u,Se=>{if(S.value=null,T.value="",Se==="header"){const X=i.branding.headerGradientStart||hn.headerGradientStart,he=i.branding.headerGradientEnd||hn.headerGradientEnd;h.value=X!==he}else if(Se==="page"){const X=i.branding.pageGradientStart||hn.pageGradientStart,he=i.branding.pageGradientEnd||hn.pageGradientEnd;f.value=X!==he}});const F={header:"Header colour",logo:"Event logo",accent:"Accent colour",page:"Page background"},j=V(()=>i.branding.headerGradientStart||hn.headerGradientStart),Y=V(()=>i.branding.headerGradientEnd||hn.headerGradientEnd),oe=V(()=>i.branding.accentColor||hn.accentColor),Oe=V(()=>i.branding.pageGradientStart||hn.pageGradientStart),ee=V(()=>i.branding.pageGradientEnd||hn.pageGradientEnd),te=V(()=>i.branding.logoPosition||"left"),O=A(Date.now());We(()=>i.branding.logoUrl,()=>{O.value=Date.now(),y.value=!1,k.value=""});const Z=V(()=>y.value?!1:!!(k.value||i.branding.logoUrl)),ne=V(()=>{if(y.value)return"";if(k.value){if(k.value.startsWith("blob:"))return k.value;const he=a(k.value),Te=he.includes("?")?"&":"?";return`${he}${Te}_t=${O.value}`}if(!i.branding.logoUrl)return"";const Se=a(i.branding.logoUrl),X=Se.includes("?")?"&":"?";return`${Se}${X}_t=${O.value}`}),pe=V(()=>({background:`linear-gradient(135deg, ${j.value} 0%, ${Y.value} 100%)`})),we=V(()=>fg(j.value,Y.value)),Ze=V(()=>({background:oe.value,color:fd(oe.value)})),Ne=V(()=>({background:`linear-gradient(135deg, ${Oe.value} 0%, ${ee.value} 100%)`}));function Ge(Se){u.value=u.value===Se?null:Se}function Xe(Se){!Z.value&&Se&&Q("logoPosition",Se),Ge("logo")}function Q(Se,X){l("update:branding",{...i.branding,[Se]:X})}function ye(Se,X){h.value?Q("headerGradientStart",X):l("update:branding",{...i.branding,headerGradientStart:X,headerGradientEnd:X})}function Ce(Se,X){f.value?Q("pageGradientStart",X):l("update:branding",{...i.branding,pageGradientStart:X,pageGradientEnd:X})}function me(){if(!h.value){const Se=i.branding.headerGradientStart||hn.headerGradientStart;Q("headerGradientEnd",Se)}}function ie(){if(!f.value){const Se=i.branding.pageGradientStart||hn.pageGradientStart;Q("pageGradientEnd",Se)}}function z(Se){l("update:branding",YI(i.branding,Se)),u.value=null}async function K(){return m.value?await m.value.uploadStagedFile():{success:!0,logoUrl:i.branding.logoUrl}}async function se(){return m.value?await m.value.deleteStagedLogo():{success:!0}}function Ee(){return m.value?.hasPendingChanges()||!1}function Be(){return m.value?.isPendingDelete()||!1}function Re(){m.value&&m.value.resetStagedState(),y.value=!1,k.value=""}return t({uploadStagedLogo:K,deleteStagedLogo:se,hasLogoChanges:Ee,isLogoPendingDelete:Be,resetLogo:Re}),(Se,X)=>(v(),g("div",XI,[r("div",QI,[X[32]||(X[32]=r("span",{class:"presets-label"},"Quick themes:",-1)),r("div",ex,[(v(!0),g(Ae,null,Ue(N(d),he=>(v(),g("button",{key:he.name,type:"button",class:"preset-btn",title:he.name,onClick:Te=>z(he)},[r("span",{class:"preset-preview",style:Qe({background:`linear-gradient(135deg, ${he.pageGradientStart} 0%, ${he.pageGradientEnd} 100%)`})},null,4),r("span",nx,I(he.name),1)],8,tx))),128))])]),r("div",ox,[r("div",{class:ve(["mockup-page",{"region-active":u.value==="page"}]),style:Qe(Ne.value),onClick:X[7]||(X[7]=he=>Ge("page"))},[r("div",{class:ve(["mockup-header",[{"region-active":u.value==="header"},Z.value?`logo-${te.value}`:"logo-none"]]),style:Qe(pe.value),onClick:X[5]||(X[5]=lt(he=>Ge("header"),["stop"]))},[Z.value&&te.value==="cover"?(v(),g("div",sx,[r("img",{src:ne.value,alt:"Logo",class:"logo-cover-img"},null,8,ax)])):D("",!0),Z.value&&te.value==="cover"?(v(),g("button",{key:1,type:"button",class:ve(["logo-cover-edit-btn",{"region-active":u.value==="logo"}]),onClick:X[0]||(X[0]=lt(he=>Ge("logo"),["stop"])),title:"Edit logo"},[...X[33]||(X[33]=[r("span",null,"",-1)])],2)):D("",!0),Z.value&&te.value==="left"?(v(),g("div",{key:2,class:ve(["mockup-logo logo-left",{"region-active":u.value==="logo"}]),onClick:X[1]||(X[1]=lt(he=>Ge("logo"),["stop"]))},[r("img",{src:ne.value,alt:"Logo",class:"logo-img"},null,8,ix)],2)):D("",!0),Z.value?D("",!0):(v(),g("div",{key:3,class:ve(["logo-add-area logo-add-left",{"region-active":u.value==="logo"}]),onClick:X[2]||(X[2]=lt(he=>Xe("left"),["stop"]))},[...X[34]||(X[34]=[r("span",{class:"logo-add-text"},"+ Logo",-1)])],2)),r("div",lx,[r("div",{class:"mockup-title",style:Qe({color:we.value})},[r("span",rx,I(e.eventName||"Event Name"),1)],4),r("div",{class:"mockup-date",style:Qe({color:we.value})},I(e.eventDate||"Event Date"),5),r("div",cx,[X[35]||(X[35]=r("span",{class:"btn-emergency"},"Emergency",-1)),r("span",{class:"btn-logout",style:Qe({color:we.value})},"Logout",4)])]),Z.value&&te.value==="right"?(v(),g("div",{key:4,class:ve(["mockup-logo logo-right",{"region-active":u.value==="logo"}]),onClick:X[3]||(X[3]=lt(he=>Ge("logo"),["stop"]))},[r("img",{src:ne.value,alt:"Logo",class:"logo-img"},null,8,ux)],2)):D("",!0),Z.value?D("",!0):(v(),g("div",{key:5,class:ve(["logo-add-area logo-add-right",{"region-active":u.value==="logo"}]),onClick:X[4]||(X[4]=lt(he=>Xe("right"),["stop"]))},[...X[36]||(X[36]=[r("span",{class:"logo-add-text"},"+ Logo",-1)])],2))],6),r("div",dx,[r("div",hx,[X[37]||(X[37]=r("div",{class:"card-header"},"Your checkpoints (2)",-1)),r("div",fx,[r("div",{class:ve(["mockup-checkin-btn",{"region-active":u.value==="accent"}]),style:Qe(Ze.value),onClick:X[6]||(X[6]=lt(he=>Ge("accent"),["stop"]))}," GPS Check-In ",6)])])])],6)]),ze(r("div",{class:"editor-overlay",onClick:X[31]||(X[31]=lt(he=>u.value=null,["self"]))},[r("div",{ref_key:"editorModalRef",ref:C,class:"editor-modal"},[r("div",px,[r("span",null,I(F[u.value]),1),r("button",{type:"button",class:"editor-close",onClick:X[8]||(X[8]=he=>u.value=null)},"")]),r("div",vx,[u.value==="header"?(v(),g(Ae,{key:0},[X[46]||(X[46]=r("p",{class:"editor-description"},"Choose the colour for the header.",-1)),r("div",mx,[r("div",gx,[r("label",null,I(h.value?"Start colour":"Colour"),1),r("div",yx,[(v(!0),g(Ae,null,Ue(N(n),he=>(v(),g("button",{key:"hs-"+he.hex,type:"button",class:ve(["color-swatch-btn",{selected:e.branding.headerGradientStart===he.hex}]),style:Qe({backgroundColor:he.hex}),title:he.name,onClick:Te=>ye("start",he.hex)},[e.branding.headerGradientStart===he.hex?(v(),g("span",bx,"")):D("",!0)],14,kx))),128)),r("div",_x,[r("button",{type:"button",class:ve(["color-swatch-btn custom-color-btn",{selected:$(e.branding.headerGradientStart)}]),style:Qe({backgroundColor:H(e.branding.headerGradientStart)}),title:"Custom colour",onClick:X[9]||(X[9]=he=>B("headerStart",he))},[(v(),g("svg",{class:"custom-icon",style:Qe({color:M(e.branding.headerGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...X[38]||(X[38]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),S.value==="headerStart"?(v(),g("div",{key:0,class:"custom-hex-popup",style:Qe(_.value)},[r("div",wx,[X[39]||(X[39]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:X[10]||(X[10]=he=>S.value=null)},"")]),r("div",Cx,[X[40]||(X[40]=r("span",{class:"hex-prefix"},"#",-1)),ze(r("input",{ref_key:"hexInputRef",ref:x,"onUpdate:modelValue":X[11]||(X[11]=he=>T.value=he),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:T.value&&!E.value}]),onInput:R,onKeydown:To(U,["enter"])},null,34),[[nt,T.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:E.value?"#"+T.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!E.value,onClick:U}," Apply ",8,Lx)]),T.value&&!E.value?(v(),g("span",Sx,"Invalid hex code")):D("",!0)],4)):D("",!0)])]),r("label",Ix,[ze(r("input",{type:"checkbox","onUpdate:modelValue":X[12]||(X[12]=he=>h.value=he),onChange:me},null,544),[[Zs,h.value]]),X[41]||(X[41]=r("span",null,"Use gradient",-1))])]),h.value?(v(),g("div",xx,[X[45]||(X[45]=r("label",null,"End colour",-1)),r("div",$x,[(v(!0),g(Ae,null,Ue(N(n),he=>(v(),g("button",{key:"he-"+he.hex,type:"button",class:ve(["color-swatch-btn",{selected:e.branding.headerGradientEnd===he.hex}]),style:Qe({backgroundColor:he.hex}),title:he.name,onClick:Te=>Q("headerGradientEnd",he.hex)},[e.branding.headerGradientEnd===he.hex?(v(),g("span",Mx,"")):D("",!0)],14,Tx))),128)),r("div",Ax,[r("button",{type:"button",class:ve(["color-swatch-btn custom-color-btn",{selected:$(e.branding.headerGradientEnd)}]),style:Qe({backgroundColor:H(e.branding.headerGradientEnd)}),title:"Custom colour",onClick:X[13]||(X[13]=he=>B("headerEnd",he))},[(v(),g("svg",{class:"custom-icon",style:Qe({color:M(e.branding.headerGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...X[42]||(X[42]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),S.value==="headerEnd"?(v(),g("div",{key:0,class:"custom-hex-popup",style:Qe(_.value)},[r("div",Ex,[X[43]||(X[43]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:X[14]||(X[14]=he=>S.value=null)},"")]),r("div",Px,[X[44]||(X[44]=r("span",{class:"hex-prefix"},"#",-1)),ze(r("input",{ref_key:"hexInputRef",ref:x,"onUpdate:modelValue":X[15]||(X[15]=he=>T.value=he),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:T.value&&!E.value}]),onInput:R,onKeydown:To(U,["enter"])},null,34),[[nt,T.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:E.value?"#"+T.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!E.value,onClick:U}," Apply ",8,Dx)]),T.value&&!E.value?(v(),g("span",Rx,"Invalid hex code")):D("",!0)],4)):D("",!0)])])])):D("",!0)])],64)):D("",!0),u.value==="logo"?(v(),g("div",Ox,[X[47]||(X[47]=r("label",{class:"editor-label"},"Position",-1)),r("div",Bx,[r("button",{type:"button",class:ve(["position-btn",{selected:te.value==="left"}]),onClick:X[16]||(X[16]=he=>Q("logoPosition","left"))}," Left ",2),r("button",{type:"button",class:ve(["position-btn",{selected:te.value==="cover"}]),onClick:X[17]||(X[17]=he=>Q("logoPosition","cover"))}," Cover ",2),r("button",{type:"button",class:ve(["position-btn",{selected:te.value==="right"}]),onClick:X[18]||(X[18]=he=>Q("logoPosition","right"))}," Right ",2)])])):D("",!0),ze(Me(KI,{ref_key:"logoUploaderRef",ref:m,"model-value":e.branding.logoUrl,"event-id":e.eventId,"admin-email":e.adminEmail,staged:"","onUpdate:modelValue":X[19]||(X[19]=he=>Q("logoUrl",he)),onStagedChange:w},null,8,["model-value","event-id","admin-email"]),[[ys,u.value==="logo"]]),u.value==="accent"?(v(),g(Ae,{key:2},[X[51]||(X[51]=r("p",{class:"editor-description"},"Choose the accent colour for buttons.",-1)),r("div",Nx,[(v(!0),g(Ae,null,Ue(N(n),he=>(v(),g("button",{key:"ac-"+he.hex,type:"button",class:ve(["color-swatch-btn",{selected:e.branding.accentColor===he.hex}]),style:Qe({backgroundColor:he.hex}),title:he.name,onClick:Te=>Q("accentColor",he.hex)},[e.branding.accentColor===he.hex?(v(),g("span",Ux,"")):D("",!0)],14,Fx))),128)),r("div",zx,[r("button",{type:"button",class:ve(["color-swatch-btn custom-color-btn",{selected:$(e.branding.accentColor)}]),style:Qe({backgroundColor:H(e.branding.accentColor)}),title:"Custom colour",onClick:X[20]||(X[20]=he=>B("accent",he))},[(v(),g("svg",{class:"custom-icon",style:Qe({color:M(e.branding.accentColor)}),viewBox:"0 0 24 24",fill:"currentColor"},[...X[48]||(X[48]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),S.value==="accent"?(v(),g("div",{key:0,class:"custom-hex-popup",style:Qe(_.value)},[r("div",Hx,[X[49]||(X[49]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:X[21]||(X[21]=he=>S.value=null)},"")]),r("div",Vx,[X[50]||(X[50]=r("span",{class:"hex-prefix"},"#",-1)),ze(r("input",{ref_key:"hexInputRef",ref:x,"onUpdate:modelValue":X[22]||(X[22]=he=>T.value=he),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:T.value&&!E.value}]),onInput:R,onKeydown:To(U,["enter"])},null,34),[[nt,T.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:E.value?"#"+T.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!E.value,onClick:U}," Apply ",8,Gx)]),T.value&&!E.value?(v(),g("span",qx,"Invalid hex code")):D("",!0)],4)):D("",!0)])])],64)):D("",!0),u.value==="page"?(v(),g(Ae,{key:3},[X[60]||(X[60]=r("p",{class:"editor-description"},"Choose the colour for the page background.",-1)),r("div",jx,[r("div",Zx,[r("label",null,I(f.value?"Start colour":"Colour"),1),r("div",Wx,[(v(!0),g(Ae,null,Ue(N(n),he=>(v(),g("button",{key:"ps-"+he.hex,type:"button",class:ve(["color-swatch-btn",{selected:e.branding.pageGradientStart===he.hex}]),style:Qe({backgroundColor:he.hex}),title:he.name,onClick:Te=>Ce("start",he.hex)},[e.branding.pageGradientStart===he.hex?(v(),g("span",Jx,"")):D("",!0)],14,Kx))),128)),r("div",Yx,[r("button",{type:"button",class:ve(["color-swatch-btn custom-color-btn",{selected:$(e.branding.pageGradientStart)}]),style:Qe({backgroundColor:H(e.branding.pageGradientStart)}),title:"Custom colour",onClick:X[23]||(X[23]=he=>B("pageStart",he))},[(v(),g("svg",{class:"custom-icon",style:Qe({color:M(e.branding.pageGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...X[52]||(X[52]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),S.value==="pageStart"?(v(),g("div",{key:0,class:"custom-hex-popup",style:Qe(_.value)},[r("div",Xx,[X[53]||(X[53]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:X[24]||(X[24]=he=>S.value=null)},"")]),r("div",Qx,[X[54]||(X[54]=r("span",{class:"hex-prefix"},"#",-1)),ze(r("input",{ref_key:"hexInputRef",ref:x,"onUpdate:modelValue":X[25]||(X[25]=he=>T.value=he),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:T.value&&!E.value}]),onInput:R,onKeydown:To(U,["enter"])},null,34),[[nt,T.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:E.value?"#"+T.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!E.value,onClick:U}," Apply ",8,e$)]),T.value&&!E.value?(v(),g("span",t$,"Invalid hex code")):D("",!0)],4)):D("",!0)])]),r("label",n$,[ze(r("input",{type:"checkbox","onUpdate:modelValue":X[26]||(X[26]=he=>f.value=he),onChange:ie},null,544),[[Zs,f.value]]),X[55]||(X[55]=r("span",null,"Use gradient",-1))])]),f.value?(v(),g("div",o$,[X[59]||(X[59]=r("label",null,"End colour",-1)),r("div",s$,[(v(!0),g(Ae,null,Ue(N(n),he=>(v(),g("button",{key:"pe-"+he.hex,type:"button",class:ve(["color-swatch-btn",{selected:e.branding.pageGradientEnd===he.hex}]),style:Qe({backgroundColor:he.hex}),title:he.name,onClick:Te=>Q("pageGradientEnd",he.hex)},[e.branding.pageGradientEnd===he.hex?(v(),g("span",i$,"")):D("",!0)],14,a$))),128)),r("div",l$,[r("button",{type:"button",class:ve(["color-swatch-btn custom-color-btn",{selected:$(e.branding.pageGradientEnd)}]),style:Qe({backgroundColor:H(e.branding.pageGradientEnd)}),title:"Custom colour",onClick:X[27]||(X[27]=he=>B("pageEnd",he))},[(v(),g("svg",{class:"custom-icon",style:Qe({color:M(e.branding.pageGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...X[56]||(X[56]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),S.value==="pageEnd"?(v(),g("div",{key:0,class:"custom-hex-popup",style:Qe(_.value)},[r("div",r$,[X[57]||(X[57]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:X[28]||(X[28]=he=>S.value=null)},"")]),r("div",c$,[X[58]||(X[58]=r("span",{class:"hex-prefix"},"#",-1)),ze(r("input",{ref_key:"hexInputRef",ref:x,"onUpdate:modelValue":X[29]||(X[29]=he=>T.value=he),type:"text",maxlength:"6",placeholder:"000000",class:ve(["hex-input",{invalid:T.value&&!E.value}]),onInput:R,onKeydown:To(U,["enter"])},null,34),[[nt,T.value]]),r("div",{class:"hex-preview",style:Qe({backgroundColor:E.value?"#"+T.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!E.value,onClick:U}," Apply ",8,u$)]),T.value&&!E.value?(v(),g("span",d$,"Invalid hex code")):D("",!0)],4)):D("",!0)])])])):D("",!0)])],64)):D("",!0)]),r("div",h$,[r("button",{type:"button",class:"btn-done",onClick:X[30]||(X[30]=he=>u.value=null)},"Done")])],512)],512),[[ys,u.value]]),X[61]||(X[61]=r("p",{class:"instructions"}," Click on different parts of the preview to customise them. The emergency button stays red for safety. ",-1))]))}},p$=He(f$,[["__scopeId","data-v-01af4f2d"]]),v$={class:"settings-tab"},m$={class:"accordion"},g$={class:"accordion-section"},y$={class:"accordion-title"},k$={class:"accordion-icon"},b$={key:0,class:"accordion-content"},_$={class:"accordion-section"},w$={class:"accordion-icon"},C$={key:0,class:"accordion-content"},L$={class:"terminology-grid"},S$={class:"term-group"},I$=["value"],x$={class:"term-group"},$$=["value"],T$={class:"term-group"},M$=["value"],A$={class:"term-group"},E$=["value"],P$={class:"term-group"},D$=["value"],R$={class:"form-actions"},O$=["disabled"],B$={class:"accordion-section"},N$={class:"accordion-title"},F$={class:"accordion-icon"},U$={key:0,class:"accordion-content"},z$={class:"section-description"},H$={class:"form-actions"},V$=["disabled"],G$={class:"accordion-section"},q$={class:"accordion-title"},j$={class:"accordion-icon"},Z$={key:0,class:"accordion-content"},W$={class:"section-description"},K$={class:"form-actions"},J$=["disabled"],Y$=["disabled"],Kf="admin_settings_accordion",X$={__name:"SettingsTab",props:{eventData:{type:Object,required:!0},admins:{type:Array,default:()=>[]},formDirty:{type:Boolean,default:!1},eventId:{type:String,default:""}},emits:["submit","add-admin","remove-admin","update:formDirty"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ct(),n=hr(),i=V(()=>n.adminEmail||""),l=e,u=t,d=A({...l.eventData}),h=A(null),f=A(!1),m=()=>l.eventId?`${Kf}_${l.eventId}`:Kf,y=A(null);ln(()=>{const E=localStorage.getItem(m());E&&(y.value=E)});const k=V(()=>{const E=d.value.peopleTerm||"Marshals";return Us.checkpoint.map(B=>({value:B,label:ld(B,E)}))}),w=E=>{const B=y.value===E?null:E;y.value=B,B?localStorage.setItem(m(),B):localStorage.removeItem(m())};We(()=>l.eventData,E=>{d.value={...E},C.value=!1},{deep:!0});const S=()=>{u("update:formDirty",!0)},T=(E,B)=>{d.value[E]=B,S()},x=V(()=>({headerGradientStart:d.value.brandingHeaderGradientStart||"",headerGradientEnd:d.value.brandingHeaderGradientEnd||"",logoUrl:d.value.brandingLogoUrl||"",logoPosition:d.value.brandingLogoPosition||"",accentColor:d.value.brandingAccentColor||"",pageGradientStart:d.value.brandingPageGradientStart||"",pageGradientEnd:d.value.brandingPageGradientEnd||""})),C=A(!1),_=E=>{C.value=E},$=E=>{d.value.brandingHeaderGradientStart=E.headerGradientStart,d.value.brandingHeaderGradientEnd=E.headerGradientEnd,d.value.brandingLogoUrl=E.logoUrl,d.value.brandingLogoPosition=E.logoPosition,d.value.brandingAccentColor=E.accentColor,d.value.brandingPageGradientStart=E.pageGradientStart,d.value.brandingPageGradientEnd=E.pageGradientEnd,S()},M=()=>{JI(),d.value.brandingHeaderGradientStart="",d.value.brandingHeaderGradientEnd="",d.value.brandingLogoUrl="",d.value.brandingLogoPosition="",d.value.brandingAccentColor="",d.value.brandingPageGradientStart="",d.value.brandingPageGradientEnd="",C.value=!1,h.value?.resetLogo(),S()},H=async()=>{if(!f.value){f.value=!0;try{if(C.value&&h.value){if(h.value.isLogoPendingDelete()){const B=await h.value.deleteStagedLogo();if(!B.success){console.error("Failed to delete logo:",B.error);return}d.value.brandingLogoUrl=""}else{const B=await h.value.uploadStagedLogo();if(!B.success){console.error("Failed to upload logo:",B.error);return}B.logoUrl&&!B.logoUrl.startsWith("blob:")&&(d.value.brandingLogoUrl=B.logoUrl)}C.value=!1}u("submit",{...d.value})}finally{f.value=!1}}};return(E,B)=>(v(),g("div",v$,[r("div",m$,[r("div",g$,[r("button",{class:ve(["accordion-header",{active:y.value==="admins"}]),onClick:B[0]||(B[0]=R=>w("admins"))},[r("span",y$,"Administrators ("+I(e.admins.length)+")",1),r("span",k$,I(y.value==="admins"?"-":"+"),1)],2),y.value==="admins"?(v(),g("div",b$,[Me(nS,{admins:e.admins,onAddAdmin:B[1]||(B[1]=R=>E.$emit("add-admin")),onRemoveAdmin:B[2]||(B[2]=R=>E.$emit("remove-admin",R))},null,8,["admins"])])):D("",!0)]),r("div",_$,[r("button",{class:ve(["accordion-header",{active:y.value==="terminology"}]),onClick:B[3]||(B[3]=R=>w("terminology"))},[B[19]||(B[19]=r("span",{class:"accordion-title"},"Terminology",-1)),r("span",w$,I(y.value==="terminology"?"-":"+"),1)],2),y.value==="terminology"?(v(),g("div",C$,[B[20]||(B[20]=r("p",{class:"section-description"}," Customise how things are named throughout the application. ",-1)),r("div",L$,[r("div",S$,[r("label",null,I(N(o).people)+" are called",1),ze(r("select",{"onUpdate:modelValue":B[4]||(B[4]=R=>d.value.peopleTerm=R),class:"form-input",onChange:S},[(v(!0),g(Ae,null,Ue(N(Us).people,R=>(v(),g("option",{key:R,value:R},I(R),9,I$))),128))],544),[[zn,d.value.peopleTerm]])]),r("div",x$,[r("label",null,I(N(o).checkpoints)+" are called",1),ze(r("select",{"onUpdate:modelValue":B[5]||(B[5]=R=>d.value.checkpointTerm=R),class:"form-input",onChange:S},[(v(!0),g(Ae,null,Ue(k.value,R=>(v(),g("option",{key:R.value,value:R.value},I(R.label),9,$$))),128))],544),[[zn,d.value.checkpointTerm]])]),r("div",T$,[r("label",null,I(N(o).areas)+" are called",1),ze(r("select",{"onUpdate:modelValue":B[6]||(B[6]=R=>d.value.areaTerm=R),class:"form-input",onChange:S},[(v(!0),g(Ae,null,Ue(N(Us).area,R=>(v(),g("option",{key:R,value:R},I(R),9,M$))),128))],544),[[zn,d.value.areaTerm]])]),r("div",A$,[r("label",null,I(N(o).checklists)+" are called",1),ze(r("select",{"onUpdate:modelValue":B[7]||(B[7]=R=>d.value.checklistTerm=R),class:"form-input",onChange:S},[(v(!0),g(Ae,null,Ue(N(Us).checklist,R=>(v(),g("option",{key:R,value:R},I(R),9,E$))),128))],544),[[zn,d.value.checklistTerm]])]),r("div",P$,[r("label",null,I(N(o).course)+" is called",1),ze(r("select",{"onUpdate:modelValue":B[8]||(B[8]=R=>d.value.courseTerm=R),class:"form-input",onChange:S},[(v(!0),g(Ae,null,Ue(N(Us).course,R=>(v(),g("option",{key:R,value:R},I(R),9,D$))),128))],544),[[zn,d.value.courseTerm]])])]),r("div",R$,[r("button",{onClick:H,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,O$)])])):D("",!0)]),r("div",B$,[r("button",{class:ve(["accordion-header",{active:y.value==="appearance"}]),onClick:B[9]||(B[9]=R=>w("appearance"))},[r("span",N$,I(N(o).checkpoint)+" appearance",1),r("span",F$,I(y.value==="appearance"?"-":"+"),1)],2),y.value==="appearance"?(v(),g("div",U$,[r("p",z$," Set the default marker style for all "+I(N(a).checkpoints)+" in this event. Individual "+I(N(a).areas)+" and "+I(N(a).checkpoints)+" can override this setting. ",1),Me(Gd,{"style-type":d.value.defaultCheckpointStyleType||"default","style-color":d.value.defaultCheckpointStyleColor||"","style-background-shape":d.value.defaultCheckpointStyleBackgroundShape||"","style-background-color":d.value.defaultCheckpointStyleBackgroundColor||"","style-border-color":d.value.defaultCheckpointStyleBorderColor||"","style-icon-color":d.value.defaultCheckpointStyleIconColor||"","style-size":d.value.defaultCheckpointStyleSize||"","style-map-rotation":d.value.defaultCheckpointStyleMapRotation??"","icon-label":"Default marker style",level:"event","show-preview":!0,"onUpdate:styleType":B[10]||(B[10]=R=>T("defaultCheckpointStyleType",R)),"onUpdate:styleColor":B[11]||(B[11]=R=>T("defaultCheckpointStyleColor",R)),"onUpdate:styleBackgroundShape":B[12]||(B[12]=R=>T("defaultCheckpointStyleBackgroundShape",R)),"onUpdate:styleBackgroundColor":B[13]||(B[13]=R=>T("defaultCheckpointStyleBackgroundColor",R)),"onUpdate:styleBorderColor":B[14]||(B[14]=R=>T("defaultCheckpointStyleBorderColor",R)),"onUpdate:styleIconColor":B[15]||(B[15]=R=>T("defaultCheckpointStyleIconColor",R)),"onUpdate:styleSize":B[16]||(B[16]=R=>T("defaultCheckpointStyleSize",R)),"onUpdate:styleMapRotation":B[17]||(B[17]=R=>T("defaultCheckpointStyleMapRotation",R))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation"]),r("div",H$,[r("button",{onClick:H,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,V$)])])):D("",!0)]),r("div",G$,[r("button",{class:ve(["accordion-header",{active:y.value==="branding"}]),onClick:B[18]||(B[18]=R=>w("branding"))},[r("span",q$,I(N(o).person)+" branding",1),r("span",j$,I(y.value==="branding"?"-":"+"),1)],2),y.value==="branding"?(v(),g("div",Z$,[r("p",W$," Customise the appearance of the "+I(N(a).person)+" view to match your organisation's branding. ",1),Me(p$,{ref_key:"brandingMockupRef",ref:h,branding:x.value,"event-name":d.value.name,"event-date":N(ag)(d.value.eventDate),"event-id":e.eventId,"admin-email":i.value,"onUpdate:branding":$,onLogoStagedChange:_},null,8,["branding","event-name","event-date","event-id","admin-email"]),r("div",K$,[r("button",{onClick:M,class:"btn btn-secondary",disabled:f.value}," Reset to default ",8,J$),r("button",{onClick:H,class:"btn btn-primary",disabled:!e.formDirty&&!C.value||f.value},I(f.value?"Saving...":"Save"),9,Y$)])])):D("",!0)])])]))}},Q$=He(X$,[["__scopeId","data-v-bb7e241a"]]),eT={class:"incident-header"},tT={class:"incident-title-row"},nT={class:"incident-title"},oT={class:"incident-badges"},sT={key:0,class:"incident-description"},aT={class:"incident-context"},iT={key:0,class:"context-item"},lT={key:1,class:"context-item"},rT={key:2,class:"context-item"},cT={class:"incident-footer"},uT={class:"reporter-info"},dT={class:"time-info"},hT={__name:"IncidentCard",props:{incident:{type:Object,required:!0}},emits:["select"],setup(e){const t=e,o=V(()=>{if(t.incident.title)return t.incident.title;const u=t.incident.description||"";return u.length<=60?u:u.substring(0,57).trim()+"..."}),a=u=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[u]||u,n=u=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[u]||u,i=(u,d=120)=>!u||u.length<=d?u:u.substring(0,d).trim()+"...",l=u=>{if(!u)return"";const d=new Date(u),f=new Date-d,m=Math.floor(f/6e4),y=Math.floor(f/36e5),k=Math.floor(f/864e5);return m<1?"just now":m<60?`${m}m ago`:y<24?`${y}h ago`:k<7?`${k}d ago`:d.toLocaleDateString()};return(u,d)=>(v(),g("div",{class:ve(["incident-card",[`severity-${e.incident.severity}`,`status-${e.incident.status}`]]),onClick:d[0]||(d[0]=h=>u.$emit("select",e.incident))},[r("div",eT,[r("div",tT,[r("span",{class:ve(["severity-indicator",e.incident.severity])},null,2),r("strong",nT,I(o.value),1)]),r("div",oT,[r("span",{class:ve(["severity-badge",e.incident.severity])},I(a(e.incident.severity)),3),r("span",{class:ve(["status-badge",e.incident.status])},I(n(e.incident.status)),3)])]),e.incident.title&&e.incident.description?(v(),g("div",sT,I(i(e.incident.description)),1)):D("",!0),r("div",aT,[e.incident.context?.checkpoint?(v(),g("div",iT,[d[1]||(d[1]=r("span",{class:"context-icon"},"",-1)),r("span",null,I(e.incident.context.checkpoint.name),1)])):e.incident.latitude&&e.incident.longitude?(v(),g("div",lT,[...d[2]||(d[2]=[r("span",{class:"context-icon"},"",-1),r("span",null,"GPS Location",-1)])])):D("",!0),e.incident.area?(v(),g("div",rT,[d[3]||(d[3]=r("span",{class:"context-icon"},"",-1)),r("span",null,I(e.incident.area.areaName),1)])):D("",!0)]),r("div",cT,[r("span",uT," Reported by "+I(e.incident.reportedBy?.name||"Unknown"),1),r("span",dT,I(l(e.incident.incidentTime||e.incident.createdAt)),1)])],2))}},vr=He(hT,[["__scopeId","data-v-690fd385"]]),fT={class:"incidents-tab"},pT={class:"tab-header"},vT={class:"button-group"},mT={key:0,class:"status-pills"},gT={class:"filters-section"},yT={class:"search-group"},kT={class:"incidents-list"},bT={key:0,class:"loading-state"},_T={key:1,class:"empty-state"},wT={__name:"IncidentsTab",props:{incidents:{type:Array,required:!0},areas:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["select-incident","report-incident"],setup(e,{emit:t}){const o=e,a=A(""),n=A("all"),i=y=>{n.value=y},l=V(()=>o.incidents.filter(y=>y.status==="open").length),u=V(()=>o.incidents.filter(y=>y.status==="in_progress"||y.status==="acknowledged").length),d=V(()=>o.incidents.filter(y=>y.status==="resolved").length),h=V(()=>o.incidents.filter(y=>y.status==="closed").length),f=V(()=>{let y=o.incidents;if(n.value==="open"?y=y.filter(k=>k.status==="open"):n.value==="in-progress"?y=y.filter(k=>k.status==="in_progress"||k.status==="acknowledged"):n.value==="resolved"?y=y.filter(k=>k.status==="resolved"):n.value==="closed"&&(y=y.filter(k=>k.status==="closed")),a.value.trim()){const k=a.value.toLowerCase().trim().split(/\s+/);y=y.filter(w=>{const S=`${w.context?.checkpoint?.name||""} ${w.context?.checkpoint?.description||""}`,T=w.area?.areaName||"",x=[w.reportedBy?.name||"",...(w.context?.peopleAtCheckpoint||[]).map($=>$.name||"")].join(" "),C=(w.updates||[]).map($=>$.note||"").join(" "),_=`${w.title||""} ${w.description||""} ${S} ${T} ${x} ${C}`.toLowerCase();return k.every($=>_.includes($))})}return y}),m=V(()=>[...f.value].sort((y,k)=>new Date(k.incidentTime||k.createdAt)-new Date(y.incidentTime||y.createdAt)));return(y,k)=>(v(),g("div",fT,[r("div",pT,[r("div",vT,[r("button",{onClick:k[0]||(k[0]=w=>y.$emit("report-incident")),class:"btn btn-primary"}," Report incident ")]),e.incidents.length>0?(v(),g("div",mT,[Me(fn,{variant:"neutral",active:n.value==="all",onClick:k[1]||(k[1]=w=>i("all"))},{default:Fe(()=>[Ye(I(e.incidents.length)+" total ",1)]),_:1},8,["active"]),l.value>0&&l.value<e.incidents.length?(v(),Ke(fn,{key:0,variant:"info",active:n.value==="open",onClick:k[2]||(k[2]=w=>i("open"))},{default:Fe(()=>[Ye(I(l.value)+" open ",1)]),_:1},8,["active"])):D("",!0),u.value>0&&u.value<e.incidents.length?(v(),Ke(fn,{key:1,variant:"purple",active:n.value==="in-progress",onClick:k[3]||(k[3]=w=>i("in-progress"))},{default:Fe(()=>[Ye(I(u.value)+" in progress ",1)]),_:1},8,["active"])):D("",!0),d.value>0&&d.value<e.incidents.length?(v(),Ke(fn,{key:2,variant:"success",active:n.value==="resolved",onClick:k[4]||(k[4]=w=>i("resolved"))},{default:Fe(()=>[Ye(I(d.value)+" resolved ",1)]),_:1},8,["active"])):D("",!0),h.value>0&&h.value<e.incidents.length?(v(),Ke(fn,{key:3,variant:"neutral",active:n.value==="closed",onClick:k[5]||(k[5]=w=>i("closed"))},{default:Fe(()=>[Ye(I(h.value)+" closed ",1)]),_:1},8,["active"])):D("",!0)])):D("",!0)]),r("div",gT,[r("div",yT,[ze(r("input",{"onUpdate:modelValue":k[6]||(k[6]=w=>a.value=w),type:"text",class:"search-input",placeholder:"Search by title, description, location, area, or person..."},null,512),[[nt,a.value]])])]),r("div",kT,[e.loading?(v(),g("div",bT," Loading incidents... ")):f.value.length===0?(v(),g("div",_T,[r("p",null,I(a.value||n.value!=="all"?"No incidents match your search or filter.":"No incidents reported yet."),1)])):D("",!0),(v(!0),g(Ae,null,Ue(m.value,w=>(v(),Ke(vr,{key:w.incidentId,incident:w,onSelect:S=>y.$emit("select-incident",w)},null,8,["incident","onSelect"]))),128))])]))}},CT=He(wT,[["__scopeId","data-v-f24c84f4"]]),LT={class:"checkpoint-card-header"},ST={class:"checkpoint-name-row"},IT=["innerHTML"],xT={class:"checkpoint-name"},$T={key:0,class:"checkpoint-description"},TT={key:0,class:"checkpoint-card-areas"},MT={class:"checkpoint-card-stats"},AT={key:1,class:"checkpoint-card-marshals"},ET={__name:"CheckpointCard",props:{checkpoint:{type:Object,required:!0},areas:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const o=e,a=t,n=V(()=>o.checkpoint.areaIds||o.checkpoint.AreaIds||[]),i=T=>{const x=o.areas.find(C=>C.id===T);return x?x.name:null},l=T=>{const x=o.areas.find(C=>C.id===T);return x?x.color:"#999"},u=V(()=>{const T=o.checkpoint,x=T.resolvedStyleBackgroundColor||T.ResolvedStyleBackgroundColor||T.resolvedStyleColor||T.ResolvedStyleColor;return x||(n.value.length>0?l(n.value[0]):"#667eea")}),d=V(()=>{const T=o.checkpoint,x=(T.assignments||[]).length;return T.requiredMarshals===0?null:x>=T.requiredMarshals?"full":x>0?"partial":"none"}),h=V(()=>[...o.checkpoint.assignments||[]].sort((x,C)=>(x.marshalName||"").localeCompare(C.marshalName||"",void 0,{sensitivity:"base"}))),f=V(()=>(o.checkpoint.assignments||[]).length),m=V(()=>(o.checkpoint.assignments||[]).filter(T=>T.isCheckedIn).length),y=V(()=>d.value?`staffing-${d.value}`:""),k=V(()=>{const T=f.value,x=m.value;return T===0?"":x===0?"checkin-none":x>=T?"checkin-full":"checkin-partial"}),w=V(()=>{const T=o.checkpoint,x=T.resolvedStyleType||T.ResolvedStyleType,C=T.resolvedStyleBackgroundColor||T.ResolvedStyleBackgroundColor||T.resolvedStyleColor||T.ResolvedStyleColor,_=T.resolvedStyleBorderColor||T.ResolvedStyleBorderColor,$=T.resolvedStyleIconColor||T.ResolvedStyleIconColor,M=T.resolvedStyleBackgroundShape||T.ResolvedStyleBackgroundShape;return x&&x!=="default"||C||_||$||M&&M!=="circle"?Tn({type:x||"circle",backgroundShape:M||"circle",backgroundColor:C||"#667eea",borderColor:_||"#ffffff",iconColor:$||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),S=()=>{o.clickable&&a("click",o.checkpoint)};return(T,x)=>(v(),g("div",{class:ve(["checkpoint-card",{"is-clickable":e.clickable,"staffed-full":d.value==="full","staffed-partial":d.value==="partial","staffed-none":d.value==="none"}]),style:Qe({borderLeftColor:u.value}),onClick:S},[r("div",LT,[r("div",{class:ve(["checkpoint-card-title",{clickable:e.clickable}])},[r("span",ST,[r("span",{class:"checkpoint-icon",innerHTML:w.value},null,8,IT),r("span",xT,I(e.checkpoint.name),1),e.checkpoint.description?(v(),g("span",$T,"  "+I(e.checkpoint.description),1)):D("",!0)])],2)]),n.value.length>0?(v(),g("div",TT,[(v(!0),g(Ae,null,Ue(n.value,C=>(v(),g("span",{key:C,class:"area-badge",style:Qe({backgroundColor:l(C)})},I(i(C)),5))),128))])):D("",!0),r("div",MT,[r("span",{class:ve(["stat-badge staffing-badge",y.value])},I(f.value)+"/"+I(e.checkpoint.requiredMarshals)+" staffed ",3),f.value>0?(v(),g("span",{key:0,class:ve(["stat-badge",k.value])},I(m.value)+"/"+I(f.value)+" checked in ",3)):D("",!0)]),h.value.length>0?(v(),g("div",AT,[(v(!0),g(Ae,null,Ue(h.value,C=>(v(),g("span",{key:C.id,class:ve(["marshal-badge",{"checked-in":C.isCheckedIn}])},I(C.marshalName),3))),128))])):D("",!0)],6))}},PT=He(ET,[["__scopeId","data-v-7ae260df"]]),pg={__name:"CheckpointsGrid",props:{checkpoints:{type:Array,required:!0},areas:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No checkpoints."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,o)=>(v(),Ke(pr,{"is-empty":e.checkpoints.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Fe(()=>[(v(!0),g(Ae,null,Ue(e.checkpoints,a=>(v(),Ke(PT,{key:a.id,checkpoint:a,areas:e.areas,clickable:!0,onClick:o[0]||(o[0]=n=>t.$emit("select",n))},null,8,["checkpoint","areas"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},DT={class:"checkpoints-tab"},RT={class:"tab-header"},OT={class:"button-group"},BT={key:0,class:"status-pills"},NT={class:"filters-section"},FT={class:"search-group"},UT=["placeholder"],zT={__name:"CheckpointsList",props:{locations:{type:Array,required:!0},areas:{type:Array,default:()=>[]}},emits:["add-checkpoint-manually","import-checkpoints","select-location"],setup(e){const{termsLower:t}=ct(),o=e,a=A(""),n=A("all"),i=C=>{n.value=C},l=C=>(C.assignments||[]).length,u=C=>(C.assignments||[]).filter(_=>_.isCheckedIn).length,d=V(()=>o.locations.filter(C=>l(C)>=C.requiredMarshals&&C.requiredMarshals>0).length),h=V(()=>o.locations.filter(C=>l(C)>0&&l(C)<C.requiredMarshals).length),f=V(()=>o.locations.filter(C=>l(C)===0&&C.requiredMarshals>0).length),m=V(()=>o.locations.filter(C=>{const _=l(C),$=u(C);return _>0&&$>=_}).length),y=V(()=>o.locations.filter(C=>{const _=l(C),$=u(C);return _>0&&$>0&&$<_}).length),k=V(()=>o.locations.filter(C=>{const _=l(C),$=u(C);return _>0&&$===0}).length),w=C=>{const _=o.areas.find($=>$.id===C);return _?_.name:null},S=V(()=>{let C=o.locations;if(n.value==="full"?C=C.filter(_=>l(_)>=_.requiredMarshals&&_.requiredMarshals>0):n.value==="partial"?C=C.filter(_=>l(_)>0&&l(_)<_.requiredMarshals):n.value==="missing"?C=C.filter(_=>l(_)===0&&_.requiredMarshals>0):n.value==="checkin-full"?C=C.filter(_=>{const $=l(_),M=u(_);return $>0&&M>=$}):n.value==="checkin-partial"?C=C.filter(_=>{const $=l(_),M=u(_);return $>0&&M>0&&M<$}):n.value==="checkin-none"&&(C=C.filter(_=>{const $=l(_),M=u(_);return $>0&&M===0})),a.value.trim()){const _=a.value.toLowerCase().trim().split(/\s+/);C=C.filter($=>{const H=($.areaIds||$.AreaIds||[]).map(R=>w(R)||"").join(" "),E=($.assignments||[]).map(R=>R.marshalName||"").join(" "),B=`${$.name||""} ${$.description||""} ${H} ${E}`.toLowerCase();return _.every(R=>B.includes(R))})}return C}),T=V(()=>[...S.value].sort((C,_)=>Ws(C.name,_.name))),x=V(()=>{const C=a.value.trim();return n.value==="full"?C?`No fully staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully staffed.`:n.value==="partial"?C?`No partially staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially staffed.`:n.value==="missing"?C?`No unstaffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are unstaffed.`:n.value==="checkin-full"?C?`No fully checked in ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully checked in.`:n.value==="checkin-partial"?C?`No partially checked in ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially checked in.`:n.value==="checkin-none"?C?`No ${t.value.checkpoints} without check-ins match your search.`:`No ${t.value.checkpoints} are without check-ins.`:C?`No ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} yet. Add one to get started!`});return(C,_)=>(v(),g("div",DT,[r("div",RT,[r("div",OT,[r("button",{onClick:_[0]||(_[0]=$=>C.$emit("add-checkpoint-manually")),class:"btn btn-primary"}," Add "+I(N(t).checkpoint),1),r("button",{onClick:_[1]||(_[1]=$=>C.$emit("import-checkpoints")),class:"btn btn-secondary"}," Import CSV ")]),e.locations.length>0?(v(),g("div",BT,[Me(fn,{variant:"neutral",active:n.value==="all",onClick:_[2]||(_[2]=$=>i("all"))},{default:Fe(()=>[Ye(I(e.locations.length)+" total ",1)]),_:1},8,["active"]),d.value>0&&d.value<e.locations.length?(v(),Ke(fn,{key:0,variant:"success",active:n.value==="full",onClick:_[3]||(_[3]=$=>i("full"))},{default:Fe(()=>[Ye(I(d.value)+" fully staffed ",1)]),_:1},8,["active"])):D("",!0),h.value>0&&h.value<e.locations.length?(v(),Ke(fn,{key:1,variant:"warning",active:n.value==="partial",onClick:_[4]||(_[4]=$=>i("partial"))},{default:Fe(()=>[Ye(I(h.value)+" partially staffed ",1)]),_:1},8,["active"])):D("",!0),f.value>0&&f.value<e.locations.length?(v(),Ke(fn,{key:2,variant:"danger",active:n.value==="missing",onClick:_[5]||(_[5]=$=>i("missing"))},{default:Fe(()=>[Ye(I(f.value)+" unstaffed ",1)]),_:1},8,["active"])):D("",!0),m.value>0&&m.value<e.locations.length?(v(),Ke(fn,{key:3,variant:"success",active:n.value==="checkin-full",onClick:_[6]||(_[6]=$=>i("checkin-full"))},{default:Fe(()=>[Ye(I(m.value)+" fully checked in ",1)]),_:1},8,["active"])):D("",!0),y.value>0&&y.value<e.locations.length?(v(),Ke(fn,{key:4,variant:"warning",active:n.value==="checkin-partial",onClick:_[7]||(_[7]=$=>i("checkin-partial"))},{default:Fe(()=>[Ye(I(y.value)+" partially checked in ",1)]),_:1},8,["active"])):D("",!0),k.value>0&&k.value<e.locations.length?(v(),Ke(fn,{key:5,variant:"danger",active:n.value==="checkin-none",onClick:_[8]||(_[8]=$=>i("checkin-none"))},{default:Fe(()=>[Ye(I(k.value)+" not checked in ",1)]),_:1},8,["active"])):D("",!0)])):D("",!0)]),r("div",NT,[r("div",FT,[ze(r("input",{"onUpdate:modelValue":_[9]||(_[9]=$=>a.value=$),type:"text",class:"search-input",placeholder:`Search by name, description, ${N(t).area}, or ${N(t).person}...`},null,8,UT),[[nt,a.value]])])]),Me(pg,{checkpoints:T.value,areas:e.areas,"empty-message":x.value,onSelect:_[10]||(_[10]=$=>C.$emit("select-location",$))},null,8,["checkpoints","areas","empty-message"])]))}},HT=He(zT,[["__scopeId","data-v-846aa906"]]),VT={class:"area-card-header"},GT={class:"area-name-row"},qT={class:"area-name"},jT={key:0,class:"default-badge"},ZT={key:0,class:"area-description"},WT={class:"area-card-stats"},KT={class:"stat-badge"},JT={class:"stat-badge"},YT={__name:"AreaCard",props:{area:{type:Object,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const o=e,a=t,n=V(()=>o.area.checkpointCount!==void 0?o.area.checkpointCount:o.checkpoints.filter(f=>(f.areaIds||f.AreaIds||[]).includes(o.area.id)||f.areaId===o.area.id).length),i=V(()=>o.contacts.filter(f=>f.scopeConfigurations?f.scopeConfigurations.some(m=>m.scope==="EveryoneInAreas"&&m.itemType==="Area"?m.ids?.includes("ALL_AREAS")?!0:m.ids?.includes(o.area.id):!1):!1).length),l=V(()=>o.area.peopleTerm||o.eventPeopleTerm||"Marshals"),u=V(()=>{const f=o.area.checkpointTerm||o.eventCheckpointTerm||"Checkpoints";return n.value===1?ui("checkpoint",f,l.value):ng("checkpoint",f,l.value)}),d=V(()=>`${n.value} ${u.value.toLowerCase()}`),h=()=>{o.clickable&&a("click",o.area)};return(f,m)=>(v(),g("div",{class:ve(["area-card",{"is-clickable":e.clickable,"is-default":e.area.isDefault}]),style:Qe({borderLeftColor:e.area.color||"#667eea"}),onClick:h},[r("div",VT,[r("div",{class:ve(["area-card-title",{clickable:e.clickable}])},[r("div",GT,[r("span",qT,I(e.area.name),1),e.area.isDefault?(v(),g("span",jT,"Default")):D("",!0)]),e.area.description?(v(),g("span",ZT,I(e.area.description),1)):D("",!0)],2)]),r("div",WT,[r("span",KT,I(d.value),1),r("span",JT,I(i.value)+" contact"+I(i.value===1?"":"s"),1)])],6))}},XT=He(YT,[["__scopeId","data-v-8ac20bf2"]]),QT={__name:"AreasGrid",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},emptyMessage:{type:String,default:"No areas."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,o)=>(v(),Ke(pr,{"is-empty":e.areas.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Fe(()=>[(v(!0),g(Ae,null,Ue(e.areas,a=>(v(),Ke(XT,{key:a.id,area:a,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,clickable:!0,onClick:o[0]||(o[0]=n=>t.$emit("select",n))},null,8,["area","checkpoints","contacts","event-people-term","event-checkpoint-term"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},eM={class:"areas-tab"},tM={class:"tab-header"},nM={class:"button-group"},oM={key:0,class:"status-pills"},sM={class:"filters-section"},aM={class:"search-group"},iM=["placeholder"],lM={__name:"AreasList",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["add-area","select-area"],setup(e){const{termsLower:t}=ct(),o=e,a=A(""),n=d=>o.checkpoints.filter(h=>(h.areaIds||h.AreaIds||[]).includes(d)||h.areaId===d),i=V(()=>{if(!a.value.trim())return o.areas;const d=a.value.toLowerCase().trim().split(/\s+/);return o.areas.filter(h=>{const m=n(h.id).map(k=>`${k.name||""} ${k.description||""}`).join(" "),y=`${h.name||""} ${h.description||""} ${m}`.toLowerCase();return d.every(k=>y.includes(k))})}),l=V(()=>[...i.value].sort((d,h)=>d.displayOrder!==h.displayOrder?d.displayOrder-h.displayOrder:Ws(d.name,h.name))),u=V(()=>a.value.trim()?`No ${t.value.areas} match your search.`:`No ${t.value.areas} yet. Click "Add ${t.value.area}" to create one.`);return(d,h)=>(v(),g("div",eM,[r("div",tM,[r("div",nM,[r("button",{onClick:h[0]||(h[0]=f=>d.$emit("add-area")),class:"btn btn-primary"}," Add "+I(N(t).area),1)]),e.areas.length>0?(v(),g("div",oM,[Me(fn,{variant:"neutral",active:!1},{default:Fe(()=>[Ye(I(e.areas.length)+" "+I(e.areas.length===1?N(t).area:N(t).areas),1)]),_:1})])):D("",!0)]),r("div",sM,[r("div",aM,[ze(r("input",{"onUpdate:modelValue":h[1]||(h[1]=f=>a.value=f),type:"text",class:"search-input",placeholder:`Search by ${N(t).area} name or ${N(t).checkpoint} name...`},null,8,iM),[[nt,a.value]])])]),Me(QT,{areas:l.value,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,"empty-message":u.value,onSelect:h[2]||(h[2]=f=>d.$emit("select-area",f))},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term","empty-message"])]))}},rM=He(lM,[["__scopeId","data-v-203f9606"]]),cM={course:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>',checkpoint:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',area:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',marshal:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',checklist:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>',notes:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/></svg>',incidents:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>',details:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16h6"/></svg>',location:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',contacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>',people:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polygon points="22 8 19.5 10 20.5 13 18 11.5 15.5 13 16.5 10 14 8 17 8 18 5 19 8 22 8" fill="currentColor"/></svg>',eventContacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 8V6a2 2 0 0 0-2-2h-2"/><path d="M22 12v2a2 2 0 0 1-2 2h-2"/></svg>',event:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>',appearance:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12.5" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>',logout:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>'},Xn=e=>cM[e]||"",uM={class:"responsive-tabs"},dM=["onClick"],hM=["innerHTML"],fM=["innerHTML"],pM={class:"hamburger-label"},vM=["onClick"],mM=["innerHTML"],gM={__name:"ResponsiveTabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,a=t,n=A(null),i=A(null),l=A(null),u=A(!1),d=A({}),h=A(!1),f=V(()=>o.tabs.find(x=>x.value===o.modelValue)),m=V(()=>f.value?f.value.label:"Menu"),y=()=>{if(u.value=!u.value,u.value&&i.value){const x=i.value.getBoundingClientRect();d.value={top:`${x.bottom+4}px`}}},k=x=>{a("update:modelValue",x),u.value=!1},w=x=>{if(!n.value)return;const C=n.value.contains(x.target);u.value&&!C&&(u.value=!1)},S=()=>{if(!l.value)return;const x=l.value,C=h.value;C&&(x.style.visibility="visible",x.style.position="static");const _=x.scrollWidth>x.clientWidth;C&&(x.style.visibility="",x.style.position=""),h.value=_};let T=null;return ln(()=>{document.addEventListener("click",w),cn(()=>{S()}),cn(()=>{const x=l.value?.parentElement;x&&(T=new ResizeObserver(()=>{S()}),T.observe(x))})}),Ln(()=>{document.removeEventListener("click",w),T&&T.disconnect()}),We(()=>o.tabs,()=>{cn(()=>{S()})},{deep:!0}),(x,C)=>(v(),g("div",uM,[r("div",{ref_key:"visibleTabsRef",ref:l,class:ve(["visible-tabs",{"is-hidden":h.value}])},[(v(!0),g(Ae,null,Ue(e.tabs,_=>(v(),g("button",{key:_.value,class:ve(["tab-button",{active:e.modelValue===_.value}]),onClick:$=>x.$emit("update:modelValue",_.value),type:"button"},[_.icon?(v(),g("span",{key:0,class:"tab-icon",innerHTML:N(Xn)(_.icon)},null,8,hM)):D("",!0),Ye(" "+I(_.label),1)],10,dM))),128))],2),r("div",{class:ve(["hamburger-only",{"is-visible":h.value}])},[r("div",{class:"hamburger-menu",ref_key:"hamburgerMenu",ref:n},[r("button",{ref_key:"hamburgerButton",ref:i,class:ve(["hamburger-button",{active:u.value}]),onClick:lt(y,["stop"]),type:"button"},[C[1]||(C[1]=r("span",{class:"hamburger-icon"},"",-1)),f.value?.icon?(v(),g("span",{key:0,class:"tab-icon",innerHTML:N(Xn)(f.value.icon)},null,8,fM)):D("",!0),r("span",pM,I(m.value),1)],2),u.value?(v(),g("div",{key:0,class:"hamburger-dropdown",style:Qe(d.value),onClick:C[0]||(C[0]=lt(()=>{},["stop"]))},[(v(!0),g(Ae,null,Ue(e.tabs,_=>(v(),g("button",{key:_.value,class:ve(["dropdown-item",{active:e.modelValue===_.value}]),onClick:lt($=>k(_.value),["stop"]),type:"button"},[_.icon?(v(),g("span",{key:0,class:"tab-icon",innerHTML:N(Xn)(_.icon)},null,8,mM)):D("",!0),Ye(" "+I(_.label),1)],10,vM))),128))],4)):D("",!0)],512)],2)]))}},yM=He(gM,[["__scopeId","data-v-2467c6fc"]]),kM={class:"instruction"},bM={class:"share-link-container"},_M=["value"],wM={__name:"ShareLinkModal",props:{show:{type:Boolean,default:!1},link:{type:String,required:!0},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ct(),n=t,i=A(!1),l=A(null),u=()=>{l.value&&(l.value.select(),document.execCommand("copy"),i.value=!0,setTimeout(()=>{i.value=!1},2e3))},d=()=>{n("close")};return(h,f)=>(v(),Ke(Ht,{show:e.show,title:`${N(o).person} check-in link`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:Fe(()=>[r("button",{onClick:d,class:"btn btn-secondary"},"Close")]),default:Fe(()=>[r("p",kM,"Share this link with "+I(N(a).peoplePlural)+" so they can check in:",1),r("div",bM,[r("input",{value:e.link,readonly:"",class:"form-input",ref_key:"linkInput",ref:l},null,8,_M),r("button",{onClick:u,class:"btn btn-primary"},I(i.value?"Copied!":"Copy"),1)])]),_:1},8,["show","title","is-dirty"]))}},CM=He(wM,[["__scopeId","data-v-b037c39b"]]);var ji={},du,Jf;function LM(){return Jf||(Jf=1,du=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),du}var hu={},ka={},Yf;function Ci(){if(Yf)return ka;Yf=1;let e;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return ka.getSymbolSize=function(a){if(!a)throw new Error('"version" cannot be null or undefined');if(a<1||a>40)throw new Error('"version" should be in range from 1 to 40');return a*4+17},ka.getSymbolTotalCodewords=function(a){return t[a]},ka.getBCHDigit=function(o){let a=0;for(;o!==0;)a++,o>>>=1;return a},ka.setToSJISFunction=function(a){if(typeof a!="function")throw new Error('"toSJISFunc" is not a valid function.');e=a},ka.isKanjiModeEnabled=function(){return typeof e<"u"},ka.toSJIS=function(a){return e(a)},ka}var fu={},Xf;function qd(){return Xf||(Xf=1,(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+o)}}e.isValid=function(a){return a&&typeof a.bit<"u"&&a.bit>=0&&a.bit<4},e.from=function(a,n){if(e.isValid(a))return a;try{return t(a)}catch{return n}}})(fu)),fu}var pu,Qf;function SM(){if(Qf)return pu;Qf=1;function e(){this.buffer=[],this.length=0}return e.prototype={get:function(t){const o=Math.floor(t/8);return(this.buffer[o]>>>7-t%8&1)===1},put:function(t,o){for(let a=0;a<o;a++)this.putBit((t>>>o-a-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const o=Math.floor(this.length/8);this.buffer.length<=o&&this.buffer.push(0),t&&(this.buffer[o]|=128>>>this.length%8),this.length++}},pu=e,pu}var vu,ep;function IM(){if(ep)return vu;ep=1;function e(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return e.prototype.set=function(t,o,a,n){const i=t*this.size+o;this.data[i]=a,n&&(this.reservedBit[i]=!0)},e.prototype.get=function(t,o){return this.data[t*this.size+o]},e.prototype.xor=function(t,o,a){this.data[t*this.size+o]^=a},e.prototype.isReserved=function(t,o){return this.reservedBit[t*this.size+o]},vu=e,vu}var mu={},tp;function xM(){return tp||(tp=1,(function(e){const t=Ci().getSymbolSize;e.getRowColCoords=function(a){if(a===1)return[];const n=Math.floor(a/7)+2,i=t(a),l=i===145?26:Math.ceil((i-13)/(2*n-2))*2,u=[i-7];for(let d=1;d<n-1;d++)u[d]=u[d-1]-l;return u.push(6),u.reverse()},e.getPositions=function(a){const n=[],i=e.getRowColCoords(a),l=i.length;for(let u=0;u<l;u++)for(let d=0;d<l;d++)u===0&&d===0||u===0&&d===l-1||u===l-1&&d===0||n.push([i[u],i[d]]);return n}})(mu)),mu}var gu={},np;function $M(){if(np)return gu;np=1;const e=Ci().getSymbolSize,t=7;return gu.getPositions=function(a){const n=e(a);return[[0,0],[n-t,0],[0,n-t]]},gu}var yu={},op;function TM(){return op||(op=1,(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(n){return n!=null&&n!==""&&!isNaN(n)&&n>=0&&n<=7},e.from=function(n){return e.isValid(n)?parseInt(n,10):void 0},e.getPenaltyN1=function(n){const i=n.size;let l=0,u=0,d=0,h=null,f=null;for(let m=0;m<i;m++){u=d=0,h=f=null;for(let y=0;y<i;y++){let k=n.get(m,y);k===h?u++:(u>=5&&(l+=t.N1+(u-5)),h=k,u=1),k=n.get(y,m),k===f?d++:(d>=5&&(l+=t.N1+(d-5)),f=k,d=1)}u>=5&&(l+=t.N1+(u-5)),d>=5&&(l+=t.N1+(d-5))}return l},e.getPenaltyN2=function(n){const i=n.size;let l=0;for(let u=0;u<i-1;u++)for(let d=0;d<i-1;d++){const h=n.get(u,d)+n.get(u,d+1)+n.get(u+1,d)+n.get(u+1,d+1);(h===4||h===0)&&l++}return l*t.N2},e.getPenaltyN3=function(n){const i=n.size;let l=0,u=0,d=0;for(let h=0;h<i;h++){u=d=0;for(let f=0;f<i;f++)u=u<<1&2047|n.get(h,f),f>=10&&(u===1488||u===93)&&l++,d=d<<1&2047|n.get(f,h),f>=10&&(d===1488||d===93)&&l++}return l*t.N3},e.getPenaltyN4=function(n){let i=0;const l=n.data.length;for(let d=0;d<l;d++)i+=n.data[d];return Math.abs(Math.ceil(i*100/l/5)-10)*t.N4};function o(a,n,i){switch(a){case e.Patterns.PATTERN000:return(n+i)%2===0;case e.Patterns.PATTERN001:return n%2===0;case e.Patterns.PATTERN010:return i%3===0;case e.Patterns.PATTERN011:return(n+i)%3===0;case e.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(i/3))%2===0;case e.Patterns.PATTERN101:return n*i%2+n*i%3===0;case e.Patterns.PATTERN110:return(n*i%2+n*i%3)%2===0;case e.Patterns.PATTERN111:return(n*i%3+(n+i)%2)%2===0;default:throw new Error("bad maskPattern:"+a)}}e.applyMask=function(n,i){const l=i.size;for(let u=0;u<l;u++)for(let d=0;d<l;d++)i.isReserved(d,u)||i.xor(d,u,o(n,d,u))},e.getBestMask=function(n,i){const l=Object.keys(e.Patterns).length;let u=0,d=1/0;for(let h=0;h<l;h++){i(h),e.applyMask(h,n);const f=e.getPenaltyN1(n)+e.getPenaltyN2(n)+e.getPenaltyN3(n)+e.getPenaltyN4(n);e.applyMask(h,n),f<d&&(d=f,u=h)}return u}})(yu)),yu}var Ar={},sp;function vg(){if(sp)return Ar;sp=1;const e=qd(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],o=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return Ar.getBlocksCount=function(n,i){switch(i){case e.L:return t[(n-1)*4+0];case e.M:return t[(n-1)*4+1];case e.Q:return t[(n-1)*4+2];case e.H:return t[(n-1)*4+3];default:return}},Ar.getTotalCodewordsCount=function(n,i){switch(i){case e.L:return o[(n-1)*4+0];case e.M:return o[(n-1)*4+1];case e.Q:return o[(n-1)*4+2];case e.H:return o[(n-1)*4+3];default:return}},Ar}var ku={},Tl={},ap;function MM(){if(ap)return Tl;ap=1;const e=new Uint8Array(512),t=new Uint8Array(256);return(function(){let a=1;for(let n=0;n<255;n++)e[n]=a,t[a]=n,a<<=1,a&256&&(a^=285);for(let n=255;n<512;n++)e[n]=e[n-255]})(),Tl.log=function(a){if(a<1)throw new Error("log("+a+")");return t[a]},Tl.exp=function(a){return e[a]},Tl.mul=function(a,n){return a===0||n===0?0:e[t[a]+t[n]]},Tl}var ip;function AM(){return ip||(ip=1,(function(e){const t=MM();e.mul=function(a,n){const i=new Uint8Array(a.length+n.length-1);for(let l=0;l<a.length;l++)for(let u=0;u<n.length;u++)i[l+u]^=t.mul(a[l],n[u]);return i},e.mod=function(a,n){let i=new Uint8Array(a);for(;i.length-n.length>=0;){const l=i[0];for(let d=0;d<n.length;d++)i[d]^=t.mul(n[d],l);let u=0;for(;u<i.length&&i[u]===0;)u++;i=i.slice(u)}return i},e.generateECPolynomial=function(a){let n=new Uint8Array([1]);for(let i=0;i<a;i++)n=e.mul(n,new Uint8Array([1,t.exp(i)]));return n}})(ku)),ku}var bu,lp;function EM(){if(lp)return bu;lp=1;const e=AM();function t(o){this.genPoly=void 0,this.degree=o,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(a){this.degree=a,this.genPoly=e.generateECPolynomial(this.degree)},t.prototype.encode=function(a){if(!this.genPoly)throw new Error("Encoder not initialized");const n=new Uint8Array(a.length+this.degree);n.set(a);const i=e.mod(n,this.genPoly),l=this.degree-i.length;if(l>0){const u=new Uint8Array(this.degree);return u.set(i,l),u}return i},bu=t,bu}var _u={},wu={},Cu={},rp;function mg(){return rp||(rp=1,Cu.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),Cu}var ds={},cp;function gg(){if(cp)return ds;cp=1;const e="[0-9]+",t="[A-Z $%*+\\-./:]+";let o="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";o=o.replace(/u/g,"\\u");const a="(?:(?![A-Z0-9 $%*+\\-./:]|"+o+`)(?:.|[\r
]))+`;ds.KANJI=new RegExp(o,"g"),ds.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),ds.BYTE=new RegExp(a,"g"),ds.NUMERIC=new RegExp(e,"g"),ds.ALPHANUMERIC=new RegExp(t,"g");const n=new RegExp("^"+o+"$"),i=new RegExp("^"+e+"$"),l=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return ds.testKanji=function(d){return n.test(d)},ds.testNumeric=function(d){return i.test(d)},ds.testAlphanumeric=function(d){return l.test(d)},ds}var up;function Li(){return up||(up=1,(function(e){const t=mg(),o=gg();e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(i,l){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!t.isValid(l))throw new Error("Invalid version: "+l);return l>=1&&l<10?i.ccBits[0]:l<27?i.ccBits[1]:i.ccBits[2]},e.getBestModeForData=function(i){return o.testNumeric(i)?e.NUMERIC:o.testAlphanumeric(i)?e.ALPHANUMERIC:o.testKanji(i)?e.KANJI:e.BYTE},e.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},e.isValid=function(i){return i&&i.bit&&i.ccBits};function a(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+n)}}e.from=function(i,l){if(e.isValid(i))return i;try{return a(i)}catch{return l}}})(wu)),wu}var dp;function PM(){return dp||(dp=1,(function(e){const t=Ci(),o=vg(),a=qd(),n=Li(),i=mg(),l=7973,u=t.getBCHDigit(l);function d(y,k,w){for(let S=1;S<=40;S++)if(k<=e.getCapacity(S,w,y))return S}function h(y,k){return n.getCharCountIndicator(y,k)+4}function f(y,k){let w=0;return y.forEach(function(S){const T=h(S.mode,k);w+=T+S.getBitsLength()}),w}function m(y,k){for(let w=1;w<=40;w++)if(f(y,w)<=e.getCapacity(w,k,n.MIXED))return w}e.from=function(k,w){return i.isValid(k)?parseInt(k,10):w},e.getCapacity=function(k,w,S){if(!i.isValid(k))throw new Error("Invalid QR Code version");typeof S>"u"&&(S=n.BYTE);const T=t.getSymbolTotalCodewords(k),x=o.getTotalCodewordsCount(k,w),C=(T-x)*8;if(S===n.MIXED)return C;const _=C-h(S,k);switch(S){case n.NUMERIC:return Math.floor(_/10*3);case n.ALPHANUMERIC:return Math.floor(_/11*2);case n.KANJI:return Math.floor(_/13);case n.BYTE:default:return Math.floor(_/8)}},e.getBestVersionForData=function(k,w){let S;const T=a.from(w,a.M);if(Array.isArray(k)){if(k.length>1)return m(k,T);if(k.length===0)return 1;S=k[0]}else S=k;return d(S.mode,S.getLength(),T)},e.getEncodedBits=function(k){if(!i.isValid(k)||k<7)throw new Error("Invalid QR Code version");let w=k<<12;for(;t.getBCHDigit(w)-u>=0;)w^=l<<t.getBCHDigit(w)-u;return k<<12|w}})(_u)),_u}var Lu={},hp;function DM(){if(hp)return Lu;hp=1;const e=Ci(),t=1335,o=21522,a=e.getBCHDigit(t);return Lu.getEncodedBits=function(i,l){const u=i.bit<<3|l;let d=u<<10;for(;e.getBCHDigit(d)-a>=0;)d^=t<<e.getBCHDigit(d)-a;return(u<<10|d)^o},Lu}var Su={},Iu,fp;function RM(){if(fp)return Iu;fp=1;const e=Li();function t(o){this.mode=e.NUMERIC,this.data=o.toString()}return t.getBitsLength=function(a){return 10*Math.floor(a/3)+(a%3?a%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(a){let n,i,l;for(n=0;n+3<=this.data.length;n+=3)i=this.data.substr(n,3),l=parseInt(i,10),a.put(l,10);const u=this.data.length-n;u>0&&(i=this.data.substr(n),l=parseInt(i,10),a.put(l,u*3+1))},Iu=t,Iu}var xu,pp;function OM(){if(pp)return xu;pp=1;const e=Li(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function o(a){this.mode=e.ALPHANUMERIC,this.data=a}return o.getBitsLength=function(n){return 11*Math.floor(n/2)+6*(n%2)},o.prototype.getLength=function(){return this.data.length},o.prototype.getBitsLength=function(){return o.getBitsLength(this.data.length)},o.prototype.write=function(n){let i;for(i=0;i+2<=this.data.length;i+=2){let l=t.indexOf(this.data[i])*45;l+=t.indexOf(this.data[i+1]),n.put(l,11)}this.data.length%2&&n.put(t.indexOf(this.data[i]),6)},xu=o,xu}var $u,vp;function BM(){if(vp)return $u;vp=1;const e=Li();function t(o){this.mode=e.BYTE,typeof o=="string"?this.data=new TextEncoder().encode(o):this.data=new Uint8Array(o)}return t.getBitsLength=function(a){return a*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(o){for(let a=0,n=this.data.length;a<n;a++)o.put(this.data[a],8)},$u=t,$u}var Tu,mp;function NM(){if(mp)return Tu;mp=1;const e=Li(),t=Ci();function o(a){this.mode=e.KANJI,this.data=a}return o.getBitsLength=function(n){return n*13},o.prototype.getLength=function(){return this.data.length},o.prototype.getBitsLength=function(){return o.getBitsLength(this.data.length)},o.prototype.write=function(a){let n;for(n=0;n<this.data.length;n++){let i=t.toSJIS(this.data[n]);if(i>=33088&&i<=40956)i-=33088;else if(i>=57408&&i<=60351)i-=49472;else throw new Error("Invalid SJIS character: "+this.data[n]+`
Make sure your charset is UTF-8`);i=(i>>>8&255)*192+(i&255),a.put(i,13)}},Tu=o,Tu}var Mu={exports:{}},gp;function FM(){return gp||(gp=1,(function(e){var t={single_source_shortest_paths:function(o,a,n){var i={},l={};l[a]=0;var u=t.PriorityQueue.make();u.push(a,0);for(var d,h,f,m,y,k,w,S,T;!u.empty();){d=u.pop(),h=d.value,m=d.cost,y=o[h]||{};for(f in y)y.hasOwnProperty(f)&&(k=y[f],w=m+k,S=l[f],T=typeof l[f]>"u",(T||S>w)&&(l[f]=w,u.push(f,w),i[f]=h))}if(typeof n<"u"&&typeof l[n]>"u"){var x=["Could not find a path from ",a," to ",n,"."].join("");throw new Error(x)}return i},extract_shortest_path_from_predecessor_list:function(o,a){for(var n=[],i=a;i;)n.push(i),o[i],i=o[i];return n.reverse(),n},find_path:function(o,a,n){var i=t.single_source_shortest_paths(o,a,n);return t.extract_shortest_path_from_predecessor_list(i,n)},PriorityQueue:{make:function(o){var a=t.PriorityQueue,n={},i;o=o||{};for(i in a)a.hasOwnProperty(i)&&(n[i]=a[i]);return n.queue=[],n.sorter=o.sorter||a.default_sorter,n},default_sorter:function(o,a){return o.cost-a.cost},push:function(o,a){var n={value:o,cost:a};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(Mu)),Mu.exports}var yp;function UM(){return yp||(yp=1,(function(e){const t=Li(),o=RM(),a=OM(),n=BM(),i=NM(),l=gg(),u=Ci(),d=FM();function h(x){return unescape(encodeURIComponent(x)).length}function f(x,C,_){const $=[];let M;for(;(M=x.exec(_))!==null;)$.push({data:M[0],index:M.index,mode:C,length:M[0].length});return $}function m(x){const C=f(l.NUMERIC,t.NUMERIC,x),_=f(l.ALPHANUMERIC,t.ALPHANUMERIC,x);let $,M;return u.isKanjiModeEnabled()?($=f(l.BYTE,t.BYTE,x),M=f(l.KANJI,t.KANJI,x)):($=f(l.BYTE_KANJI,t.BYTE,x),M=[]),C.concat(_,$,M).sort(function(E,B){return E.index-B.index}).map(function(E){return{data:E.data,mode:E.mode,length:E.length}})}function y(x,C){switch(C){case t.NUMERIC:return o.getBitsLength(x);case t.ALPHANUMERIC:return a.getBitsLength(x);case t.KANJI:return i.getBitsLength(x);case t.BYTE:return n.getBitsLength(x)}}function k(x){return x.reduce(function(C,_){const $=C.length-1>=0?C[C.length-1]:null;return $&&$.mode===_.mode?(C[C.length-1].data+=_.data,C):(C.push(_),C)},[])}function w(x){const C=[];for(let _=0;_<x.length;_++){const $=x[_];switch($.mode){case t.NUMERIC:C.push([$,{data:$.data,mode:t.ALPHANUMERIC,length:$.length},{data:$.data,mode:t.BYTE,length:$.length}]);break;case t.ALPHANUMERIC:C.push([$,{data:$.data,mode:t.BYTE,length:$.length}]);break;case t.KANJI:C.push([$,{data:$.data,mode:t.BYTE,length:h($.data)}]);break;case t.BYTE:C.push([{data:$.data,mode:t.BYTE,length:h($.data)}])}}return C}function S(x,C){const _={},$={start:{}};let M=["start"];for(let H=0;H<x.length;H++){const E=x[H],B=[];for(let R=0;R<E.length;R++){const U=E[R],F=""+H+R;B.push(F),_[F]={node:U,lastCount:0},$[F]={};for(let j=0;j<M.length;j++){const Y=M[j];_[Y]&&_[Y].node.mode===U.mode?($[Y][F]=y(_[Y].lastCount+U.length,U.mode)-y(_[Y].lastCount,U.mode),_[Y].lastCount+=U.length):(_[Y]&&(_[Y].lastCount=U.length),$[Y][F]=y(U.length,U.mode)+4+t.getCharCountIndicator(U.mode,C))}}M=B}for(let H=0;H<M.length;H++)$[M[H]].end=0;return{map:$,table:_}}function T(x,C){let _;const $=t.getBestModeForData(x);if(_=t.from(C,$),_!==t.BYTE&&_.bit<$.bit)throw new Error('"'+x+'" cannot be encoded with mode '+t.toString(_)+`.
 Suggested mode is: `+t.toString($));switch(_===t.KANJI&&!u.isKanjiModeEnabled()&&(_=t.BYTE),_){case t.NUMERIC:return new o(x);case t.ALPHANUMERIC:return new a(x);case t.KANJI:return new i(x);case t.BYTE:return new n(x)}}e.fromArray=function(C){return C.reduce(function(_,$){return typeof $=="string"?_.push(T($,null)):$.data&&_.push(T($.data,$.mode)),_},[])},e.fromString=function(C,_){const $=m(C,u.isKanjiModeEnabled()),M=w($),H=S(M,_),E=d.find_path(H.map,"start","end"),B=[];for(let R=1;R<E.length-1;R++)B.push(H.table[E[R]].node);return e.fromArray(k(B))},e.rawSplit=function(C){return e.fromArray(m(C,u.isKanjiModeEnabled()))}})(Su)),Su}var kp;function zM(){if(kp)return hu;kp=1;const e=Ci(),t=qd(),o=SM(),a=IM(),n=xM(),i=$M(),l=TM(),u=vg(),d=EM(),h=PM(),f=DM(),m=Li(),y=UM();function k(H,E){const B=H.size,R=i.getPositions(E);for(let U=0;U<R.length;U++){const F=R[U][0],j=R[U][1];for(let Y=-1;Y<=7;Y++)if(!(F+Y<=-1||B<=F+Y))for(let oe=-1;oe<=7;oe++)j+oe<=-1||B<=j+oe||(Y>=0&&Y<=6&&(oe===0||oe===6)||oe>=0&&oe<=6&&(Y===0||Y===6)||Y>=2&&Y<=4&&oe>=2&&oe<=4?H.set(F+Y,j+oe,!0,!0):H.set(F+Y,j+oe,!1,!0))}}function w(H){const E=H.size;for(let B=8;B<E-8;B++){const R=B%2===0;H.set(B,6,R,!0),H.set(6,B,R,!0)}}function S(H,E){const B=n.getPositions(E);for(let R=0;R<B.length;R++){const U=B[R][0],F=B[R][1];for(let j=-2;j<=2;j++)for(let Y=-2;Y<=2;Y++)j===-2||j===2||Y===-2||Y===2||j===0&&Y===0?H.set(U+j,F+Y,!0,!0):H.set(U+j,F+Y,!1,!0)}}function T(H,E){const B=H.size,R=h.getEncodedBits(E);let U,F,j;for(let Y=0;Y<18;Y++)U=Math.floor(Y/3),F=Y%3+B-8-3,j=(R>>Y&1)===1,H.set(U,F,j,!0),H.set(F,U,j,!0)}function x(H,E,B){const R=H.size,U=f.getEncodedBits(E,B);let F,j;for(F=0;F<15;F++)j=(U>>F&1)===1,F<6?H.set(F,8,j,!0):F<8?H.set(F+1,8,j,!0):H.set(R-15+F,8,j,!0),F<8?H.set(8,R-F-1,j,!0):F<9?H.set(8,15-F-1+1,j,!0):H.set(8,15-F-1,j,!0);H.set(R-8,8,1,!0)}function C(H,E){const B=H.size;let R=-1,U=B-1,F=7,j=0;for(let Y=B-1;Y>0;Y-=2)for(Y===6&&Y--;;){for(let oe=0;oe<2;oe++)if(!H.isReserved(U,Y-oe)){let Oe=!1;j<E.length&&(Oe=(E[j]>>>F&1)===1),H.set(U,Y-oe,Oe),F--,F===-1&&(j++,F=7)}if(U+=R,U<0||B<=U){U-=R,R=-R;break}}}function _(H,E,B){const R=new o;B.forEach(function(oe){R.put(oe.mode.bit,4),R.put(oe.getLength(),m.getCharCountIndicator(oe.mode,H)),oe.write(R)});const U=e.getSymbolTotalCodewords(H),F=u.getTotalCodewordsCount(H,E),j=(U-F)*8;for(R.getLengthInBits()+4<=j&&R.put(0,4);R.getLengthInBits()%8!==0;)R.putBit(0);const Y=(j-R.getLengthInBits())/8;for(let oe=0;oe<Y;oe++)R.put(oe%2?17:236,8);return $(R,H,E)}function $(H,E,B){const R=e.getSymbolTotalCodewords(E),U=u.getTotalCodewordsCount(E,B),F=R-U,j=u.getBlocksCount(E,B),Y=R%j,oe=j-Y,Oe=Math.floor(R/j),ee=Math.floor(F/j),te=ee+1,O=Oe-ee,Z=new d(O);let ne=0;const pe=new Array(j),we=new Array(j);let Ze=0;const Ne=new Uint8Array(H.buffer);for(let Ce=0;Ce<j;Ce++){const me=Ce<oe?ee:te;pe[Ce]=Ne.slice(ne,ne+me),we[Ce]=Z.encode(pe[Ce]),ne+=me,Ze=Math.max(Ze,me)}const Ge=new Uint8Array(R);let Xe=0,Q,ye;for(Q=0;Q<Ze;Q++)for(ye=0;ye<j;ye++)Q<pe[ye].length&&(Ge[Xe++]=pe[ye][Q]);for(Q=0;Q<O;Q++)for(ye=0;ye<j;ye++)Ge[Xe++]=we[ye][Q];return Ge}function M(H,E,B,R){let U;if(Array.isArray(H))U=y.fromArray(H);else if(typeof H=="string"){let Oe=E;if(!Oe){const ee=y.rawSplit(H);Oe=h.getBestVersionForData(ee,B)}U=y.fromString(H,Oe||40)}else throw new Error("Invalid data");const F=h.getBestVersionForData(U,B);if(!F)throw new Error("The amount of data is too big to be stored in a QR Code");if(!E)E=F;else if(E<F)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+F+`.
`);const j=_(E,B,U),Y=e.getSymbolSize(E),oe=new a(Y);return k(oe,E),w(oe),S(oe,E),x(oe,B,0),E>=7&&T(oe,E),C(oe,j),isNaN(R)&&(R=l.getBestMask(oe,x.bind(null,oe,B))),l.applyMask(R,oe),x(oe,B,R),{modules:oe,version:E,errorCorrectionLevel:B,maskPattern:R,segments:U}}return hu.create=function(E,B){if(typeof E>"u"||E==="")throw new Error("No input text");let R=t.M,U,F;return typeof B<"u"&&(R=t.from(B.errorCorrectionLevel,t.M),U=h.from(B.version),F=l.from(B.maskPattern),B.toSJISFunc&&e.setToSJISFunction(B.toSJISFunc)),M(E,U,R,F)},hu}var Au={},Eu={},bp;function yg(){return bp||(bp=1,(function(e){function t(o){if(typeof o=="number"&&(o=o.toString()),typeof o!="string")throw new Error("Color should be defined as hex string");let a=o.slice().replace("#","").split("");if(a.length<3||a.length===5||a.length>8)throw new Error("Invalid hex color: "+o);(a.length===3||a.length===4)&&(a=Array.prototype.concat.apply([],a.map(function(i){return[i,i]}))),a.length===6&&a.push("F","F");const n=parseInt(a.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:n&255,hex:"#"+a.slice(0,6).join("")}}e.getOptions=function(a){a||(a={}),a.color||(a.color={});const n=typeof a.margin>"u"||a.margin===null||a.margin<0?4:a.margin,i=a.width&&a.width>=21?a.width:void 0,l=a.scale||4;return{width:i,scale:i?4:l,margin:n,color:{dark:t(a.color.dark||"#000000ff"),light:t(a.color.light||"#ffffffff")},type:a.type,rendererOpts:a.rendererOpts||{}}},e.getScale=function(a,n){return n.width&&n.width>=a+n.margin*2?n.width/(a+n.margin*2):n.scale},e.getImageWidth=function(a,n){const i=e.getScale(a,n);return Math.floor((a+n.margin*2)*i)},e.qrToImageData=function(a,n,i){const l=n.modules.size,u=n.modules.data,d=e.getScale(l,i),h=Math.floor((l+i.margin*2)*d),f=i.margin*d,m=[i.color.light,i.color.dark];for(let y=0;y<h;y++)for(let k=0;k<h;k++){let w=(y*h+k)*4,S=i.color.light;if(y>=f&&k>=f&&y<h-f&&k<h-f){const T=Math.floor((y-f)/d),x=Math.floor((k-f)/d);S=m[u[T*l+x]?1:0]}a[w++]=S.r,a[w++]=S.g,a[w++]=S.b,a[w]=S.a}}})(Eu)),Eu}var _p;function HM(){return _p||(_p=1,(function(e){const t=yg();function o(n,i,l){n.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=l,i.width=l,i.style.height=l+"px",i.style.width=l+"px"}function a(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(i,l,u){let d=u,h=l;typeof d>"u"&&(!l||!l.getContext)&&(d=l,l=void 0),l||(h=a()),d=t.getOptions(d);const f=t.getImageWidth(i.modules.size,d),m=h.getContext("2d"),y=m.createImageData(f,f);return t.qrToImageData(y.data,i,d),o(m,h,f),m.putImageData(y,0,0),h},e.renderToDataURL=function(i,l,u){let d=u;typeof d>"u"&&(!l||!l.getContext)&&(d=l,l=void 0),d||(d={});const h=e.render(i,l,d),f=d.type||"image/png",m=d.rendererOpts||{};return h.toDataURL(f,m.quality)}})(Au)),Au}var Pu={},wp;function VM(){if(wp)return Pu;wp=1;const e=yg();function t(n,i){const l=n.a/255,u=i+'="'+n.hex+'"';return l<1?u+" "+i+'-opacity="'+l.toFixed(2).slice(1)+'"':u}function o(n,i,l){let u=n+i;return typeof l<"u"&&(u+=" "+l),u}function a(n,i,l){let u="",d=0,h=!1,f=0;for(let m=0;m<n.length;m++){const y=Math.floor(m%i),k=Math.floor(m/i);!y&&!h&&(h=!0),n[m]?(f++,m>0&&y>0&&n[m-1]||(u+=h?o("M",y+l,.5+k+l):o("m",d,0),d=0,h=!1),y+1<i&&n[m+1]||(u+=o("h",f),f=0)):d++}return u}return Pu.render=function(i,l,u){const d=e.getOptions(l),h=i.modules.size,f=i.modules.data,m=h+d.margin*2,y=d.color.light.a?"<path "+t(d.color.light,"fill")+' d="M0 0h'+m+"v"+m+'H0z"/>':"",k="<path "+t(d.color.dark,"stroke")+' d="'+a(f,h,d.margin)+'"/>',w='viewBox="0 0 '+m+" "+m+'"',T='<svg xmlns="http://www.w3.org/2000/svg" '+(d.width?'width="'+d.width+'" height="'+d.width+'" ':"")+w+' shape-rendering="crispEdges">'+y+k+`</svg>
`;return typeof u=="function"&&u(null,T),T},Pu}var Cp;function GM(){if(Cp)return ji;Cp=1;const e=LM(),t=zM(),o=HM(),a=VM();function n(i,l,u,d,h){const f=[].slice.call(arguments,1),m=f.length,y=typeof f[m-1]=="function";if(!y&&!e())throw new Error("Callback required as last argument");if(y){if(m<2)throw new Error("Too few arguments provided");m===2?(h=u,u=l,l=d=void 0):m===3&&(l.getContext&&typeof h>"u"?(h=d,d=void 0):(h=d,d=u,u=l,l=void 0))}else{if(m<1)throw new Error("Too few arguments provided");return m===1?(u=l,l=d=void 0):m===2&&!l.getContext&&(d=u,u=l,l=void 0),new Promise(function(k,w){try{const S=t.create(u,d);k(i(S,l,d))}catch(S){w(S)}})}try{const k=t.create(u,d);h(null,i(k,l,d))}catch(k){h(k)}}return ji.create=t.create,ji.toCanvas=n.bind(null,o.render),ji.toDataURL=n.bind(null,o.renderToDataURL),ji.toString=n.bind(null,function(i,l,u){return a.render(i,u)}),ji}var qM=GM();const jM=lg(qM),ZM={class:"qr-container"},WM={key:0,class:"error-text"},KM={__name:"QrCodeModal",props:{show:{type:Boolean,default:!1},url:{type:String,required:!0},title:{type:String,default:"Scan QR code"},zIndex:{type:Number,default:1e3}},emits:["close"],setup(e){const t=e,o=A(null),a=A(""),n=async()=>{if(!(!o.value||!t.url)){a.value="";try{await jM.toCanvas(o.value,t.url,{width:280,margin:2,color:{dark:"#000000",light:"#ffffff"}})}catch(i){console.error("Failed to generate QR code:",i),a.value="Failed to generate QR code"}}};return We(()=>[t.show,t.url],([i])=>{i&&t.url&&setTimeout(n,50)},{immediate:!0}),(i,l)=>(v(),Ke(Ht,{show:e.show,title:e.title,size:"small","z-index":e.zIndex,"confirm-on-close":!1,onClose:l[1]||(l[1]=u=>i.$emit("close"))},{actions:Fe(()=>[r("button",{onClick:l[0]||(l[0]=u=>i.$emit("close")),class:"btn btn-primary"},"Done")]),default:Fe(()=>[r("div",ZM,[r("canvas",{ref_key:"canvasRef",ref:o,class:"qr-canvas"},null,512),a.value?(v(),g("p",WM,I(a.value),1)):D("",!0)])]),_:1},8,["show","title","z-index"]))}},kg=He(KM,[["__scopeId","data-v-00d46fb8"]]),JM={class:"success-content"},YM={class:"success-message"},XM={class:"link-section"},QM={class:"help-text"},eA={key:0,class:"loading-text"},tA={key:1,class:"magic-link-container"},nA=["value"],oA={class:"magic-link-actions"},sA=["disabled"],aA={key:0,class:"success-text"},iA={key:1,class:"error-text"},lA={key:2,class:"error-text"},rA={__name:"MarshalCreatedModal",props:{show:{type:Boolean,default:!1},eventId:{type:String,required:!0},marshalId:{type:String,default:null},marshalName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const{terms:o}=ct(),a=e,n=t,i=A(""),l=A(!1),u=A(!1),d=A(""),h=A(!1),f=A(!1),m=A(!1),y=A(""),k=A(!1),w=async()=>{if(!(!a.eventId||!a.marshalId)){u.value=!0,d.value="";try{const C=await gs.getMagicLink(a.eventId,a.marshalId);i.value=C.data.magicLink,l.value=C.data.hasEmail}catch(C){console.error("Failed to fetch magic link:",C),d.value="Failed to load login link"}finally{u.value=!1}}},S=async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(i.value);else{const C=document.createElement("textarea");C.value=i.value,C.style.position="fixed",C.style.left="-9999px",document.body.appendChild(C),C.select(),document.execCommand("copy"),document.body.removeChild(C)}h.value=!0,setTimeout(()=>{h.value=!1},2e3)}catch(C){console.error("Failed to copy:",C)}},T=async()=>{if(!(!a.eventId||!a.marshalId)){f.value=!0,m.value=!1,y.value="";try{await gs.sendMagicLink(a.eventId,a.marshalId),m.value=!0,setTimeout(()=>{m.value=!1},3e3)}catch(C){console.error("Failed to send email:",C),y.value=C.response?.data?.message||"Failed to send email"}finally{f.value=!1}}},x=()=>{n("close")};return We(()=>a.show,C=>{C&&a.marshalId?w():(i.value="",l.value=!1,d.value="",h.value=!1,m.value=!1,y.value="",k.value=!1)},{immediate:!0}),(C,_)=>(v(),g(Ae,null,[Me(Ht,{show:e.show,title:`${N(o).person} created`,size:"medium","confirm-on-close":!1,"is-dirty":!1,onClose:x},{actions:Fe(()=>[r("button",{onClick:x,class:"btn btn-primary"},"Done")]),default:Fe(()=>[r("div",JM,[_[4]||(_[4]=r("div",{class:"success-icon"},"",-1)),r("p",YM,[r("strong",null,I(e.marshalName),1),_[3]||(_[3]=Ye(" has been added successfully. ",-1))])]),r("div",XM,[_[6]||(_[6]=r("label",null,"Login link",-1)),r("p",QM," Share this unique link with "+I(e.marshalName)+" so they can access their dashboard and check in. ",1),u.value?(v(),g("div",eA,"Loading link...")):i.value?(v(),g("div",tA,[r("input",{type:"text",value:i.value,readonly:"",class:"form-input magic-link-input",onFocus:_[0]||(_[0]=$=>$.target.select())},null,40,nA),r("div",oA,[r("button",{type:"button",class:"btn btn-secondary",onClick:S},I(h.value?"Copied!":"Copy link"),1),r("button",{type:"button",class:"btn btn-secondary",onClick:_[1]||(_[1]=$=>k.value=!0),title:"Show QR code"},[..._[5]||(_[5]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("rect",{x:"3",y:"3",width:"7",height:"7"}),r("rect",{x:"14",y:"3",width:"7",height:"7"}),r("rect",{x:"3",y:"14",width:"7",height:"7"}),r("rect",{x:"14",y:"14",width:"3",height:"3"}),r("rect",{x:"19",y:"14",width:"2",height:"2"}),r("rect",{x:"14",y:"19",width:"2",height:"2"}),r("rect",{x:"19",y:"19",width:"2",height:"2"})],-1)])]),l.value?(v(),g("button",{key:0,type:"button",class:"btn btn-primary",disabled:f.value,onClick:T},I(f.value?"Sending...":"Send via email"),9,sA)):D("",!0)]),m.value?(v(),g("p",aA,"Email sent successfully!")):D("",!0),y.value?(v(),g("p",iA,I(y.value),1)):D("",!0)])):d.value?(v(),g("div",lA,I(d.value),1)):D("",!0)])]),_:1},8,["show","title"]),Me(kg,{show:k.value,url:i.value,title:"Scan to log in","z-index":1100,onClose:_[2]||(_[2]=$=>k.value=!1)},null,8,["show","url"])],64))}},cA=He(rA,[["__scopeId","data-v-9aa97b04"]]),uA={class:"form-group"},dA={__name:"AddAdminModal",props:{show:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,n=A("");We(()=>o.show,d=>{d||(n.value="")});const i=()=>{a("update:isDirty",!0)},l=()=>{a("submit",n.value)},u=()=>{a("close")};return(d,h)=>(v(),Ke(Ht,{show:e.show,title:"Add event administrator",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:Fe(()=>[r("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-primary"}," Add administrator ")]),default:Fe(()=>[h[2]||(h[2]=r("p",{class:"instruction"},"Enter the email address of the administrator to add",-1)),r("form",{onSubmit:lt(l,["prevent"])},[r("div",uA,[h[1]||(h[1]=r("label",null,"Email address",-1)),ze(r("input",{"onUpdate:modelValue":h[0]||(h[0]=f=>n.value=f),type:"email",required:"",class:"form-input",placeholder:"admin@example.com",onInput:i},null,544),[[nt,n.value]])])],32)]),_:1},8,["show","is-dirty"]))}},hA=He(dA,[["__scopeId","data-v-a82da194"]]),fA={class:"form-group"},pA={key:0,class:"error"},vA=["disabled"],mA={__name:"UploadRouteModal",props:{show:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},error:{type:String,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,n=A(null);We(()=>o.show,d=>{d||(n.value=null)});const i=d=>{n.value=d.target.files[0],a("update:isDirty",!0)},l=()=>{n.value&&a("submit",n.value)},u=()=>{a("close")};return(d,h)=>(v(),Ke(Ht,{show:e.show,title:"Upload GPX route",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:Fe(()=>[r("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-primary",disabled:e.uploading},I(e.uploading?"Uploading...":"Upload route"),9,vA)]),default:Fe(()=>[h[1]||(h[1]=r("p",{class:"instruction"},"Upload a GPX file to display the event route on the map",-1)),r("form",{onSubmit:lt(l,["prevent"])},[r("div",fA,[h[0]||(h[0]=r("label",null,"GPX file",-1)),r("input",{type:"file",accept:".gpx",onChange:i,required:"",class:"form-input"},null,32)]),e.error?(v(),g("div",pA,I(e.error),1)):D("",!0)],32)]),_:1},8,["show","is-dirty"]))}},gA=He(mA,[["__scopeId","data-v-317975db"]]),yA={class:"instruction"},kA={class:"form-group"},bA={class:"form-group"},_A={class:"checkbox-label"},wA={key:0,class:"error"},CA={key:1,class:"import-result"},LA={key:0,class:"import-errors"},SA=["disabled"],IA={__name:"ImportLocationsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ct(),n=e,i=t,l=A(null),u=A(!1);We(()=>n.show,y=>{y||(l.value=null,u.value=!1)});const d=y=>{l.value=y.target.files[0],i("update:isDirty",!0)},h=()=>{i("update:isDirty",!0)},f=()=>{l.value&&i("submit",{file:l.value,deleteExisting:u.value})},m=()=>{i("close")};return(y,k)=>(v(),Ke(Ht,{show:e.show,title:`Import ${N(a).checkpoints} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:m},{actions:Fe(()=>[r("button",{type:"button",onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-primary",disabled:e.importing},I(e.importing?"Importing...":`Import ${N(a).checkpoints}`),9,SA)]),default:Fe(()=>[r("p",yA,"Upload a CSV file with columns: Label, Lat/Latitude, Long/Longitude, What3Words (optional), "+I(N(o).people)+" (optional)",1),k[3]||(k[3]=r("div",{class:"csv-example"},[r("strong",null,"Example CSV format:"),r("pre",null,`Label,Latitude,Longitude,What3Words,Marshals
Checkpoint 1,51.505,-0.09,filled.count.soap,"John Doe, Jane Smith"
Checkpoint 2,51.510,-0.10,index.home.raft,Bob Wilson`)],-1)),r("form",{onSubmit:lt(f,["prevent"])},[r("div",kA,[k[1]||(k[1]=r("label",null,"CSV file",-1)),r("input",{type:"file",accept:".csv",onChange:d,required:"",class:"form-input"},null,32)]),r("div",bA,[r("label",_A,[ze(r("input",{type:"checkbox","onUpdate:modelValue":k[0]||(k[0]=w=>u.value=w),onChange:h},null,544),[[Zs,u.value]]),Ye(" Delete existing "+I(N(a).checkpoints)+" before import ",1)])]),e.error?(v(),g("div",wA,I(e.error),1)):D("",!0),e.result?(v(),g("div",CA,[r("p",null,"Created "+I(e.result.locationsCreated)+" "+I(N(a).checkpoints)+" and "+I(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),g("div",LA,[k[2]||(k[2]=r("strong",null,"Errors:",-1)),r("ul",null,[(v(!0),g(Ae,null,Ue(e.result.errors,(w,S)=>(v(),g("li",{key:S},I(w),1))),128))])])):D("",!0)])):D("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},xA=He(IA,[["__scopeId","data-v-75c79d31"]]),$A={class:"instruction"},TA={class:"form-group"},MA={key:0,class:"error"},AA={key:1,class:"import-result"},EA={key:0,class:"import-errors"},PA=["disabled"],DA={__name:"ImportMarshalsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ct(),n=e,i=t,l=A(null);We(()=>n.show,f=>{f||(l.value=null)});const u=f=>{l.value=f.target.files[0],i("update:isDirty",!0)},d=()=>{l.value&&i("submit",l.value)},h=()=>{i("close")};return(f,m)=>(v(),Ke(Ht,{show:e.show,title:`Import ${N(a).people} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:h},{actions:Fe(()=>[r("button",{type:"button",onClick:h,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:d,class:"btn btn-primary",disabled:e.importing},I(e.importing?"Importing...":`Import ${N(a).people}`),9,PA)]),default:Fe(()=>[r("p",$A,"Upload a CSV file with columns: Name, Email (optional), Phone (optional), "+I(N(o).checkpoint)+" (optional)",1),m[2]||(m[2]=r("div",{class:"csv-example"},[r("strong",null,"Example CSV format:"),r("pre",null,`Name,Email,Phone,Checkpoint
John Doe,john@example.com,555-1234,Checkpoint 1
Jane Smith,jane@example.com,555-5678,Checkpoint 2`)],-1)),r("form",{onSubmit:lt(d,["prevent"])},[r("div",TA,[m[0]||(m[0]=r("label",null,"CSV file",-1)),r("input",{type:"file",accept:".csv",onChange:u,required:"",class:"form-input"},null,32)]),e.error?(v(),g("div",MA,I(e.error),1)):D("",!0),e.result?(v(),g("div",AA,[r("p",null,"Imported "+I(e.result.marshalsCreated)+" "+I(N(a).people)+" and "+I(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),g("div",EA,[m[1]||(m[1]=r("strong",null,"Errors:",-1)),r("ul",null,[(v(!0),g(Ae,null,Ue(e.result.errors,(y,k)=>(v(),g("li",{key:k},I(y),1))),128))])])):D("",!0)])):D("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},RA=He(DA,[["__scopeId","data-v-be89bf1f"]]),OA=["onClick"],BA=["innerHTML"],NA={class:"hamburger-nav"},FA=["disabled"],UA=["innerHTML"],zA={class:"current-tab-label"},HA=["disabled"],VA={key:0,class:"hamburger-menu"},GA=["onClick"],qA=["innerHTML"],jA=400,ZA={__name:"TabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,a=t,n=A(null),i=A(null),l=A(null),u=A(!1),d=A(!1),h=V(()=>{const M=o.tabs.find(H=>H.value===o.modelValue);return M?M.label:""}),f=V(()=>o.tabs.find(H=>H.value===o.modelValue)?.icon||null),m=V(()=>o.tabs.findIndex(M=>M.value===o.modelValue)),y=V(()=>m.value>0),k=V(()=>m.value<o.tabs.length-1),w=()=>{y.value&&a("update:modelValue",o.tabs[m.value-1].value)},S=()=>{k.value&&a("update:modelValue",o.tabs[m.value+1].value)},T=()=>{if(!n.value)return;const M=n.value.clientWidth;if(M<jA){u.value=!0;return}if(i.value&&!u.value){i.value.scrollWidth>M&&(u.value=!0);return}const H=o.tabs.some(R=>R.icon)?110:90,E=o.tabs.length*H,B=(o.tabs.length-1)*8;E+B<=M&&(u.value=!1,cn(()=>{i.value&&i.value.scrollWidth>M&&(u.value=!0)}))},x=()=>{d.value=!d.value},C=M=>{a("update:modelValue",M),d.value=!1},_=M=>{l.value&&!l.value.contains(M.target)&&(d.value=!1)};let $=null;return ln(()=>{cn(()=>{T(),n.value&&typeof ResizeObserver<"u"&&($=new ResizeObserver(()=>{T()}),$.observe(n.value)),document.addEventListener("click",_)})}),Ln(()=>{$&&$.disconnect(),document.removeEventListener("click",_)}),We(()=>o.tabs,()=>{cn(()=>{T()})},{deep:!0}),(M,H)=>(v(),g("div",{class:"tabs-container",ref_key:"containerRef",ref:n},[u.value?(v(),g("div",{key:1,class:"hamburger-container",ref_key:"hamburgerRef",ref:l},[r("div",NA,[r("button",{class:ve(["nav-arrow",{invisible:!y.value}]),onClick:w,type:"button","aria-label":"Previous tab",disabled:!y.value},"  ",10,FA),r("button",{class:"hamburger-button",onClick:x,type:"button","aria-label":"Tab menu"},[f.value?(v(),g("span",{key:0,class:"current-tab-icon",innerHTML:N(Xn)(f.value)},null,8,UA)):D("",!0),r("span",zA,I(h.value),1),H[0]||(H[0]=r("span",{class:"hamburger-chevron"},"",-1))]),r("button",{class:ve(["nav-arrow",{invisible:!k.value}]),onClick:S,type:"button","aria-label":"Next tab",disabled:!k.value},"  ",10,HA)]),d.value?(v(),g("div",VA,[(v(!0),g(Ae,null,Ue(e.tabs,E=>(v(),g("button",{key:E.value,class:ve(["menu-item",{active:e.modelValue===E.value}]),onClick:B=>C(E.value),type:"button"},[E.icon?(v(),g("span",{key:0,class:"tab-icon",innerHTML:N(Xn)(E.icon)},null,8,qA)):D("",!0),Ye(" "+I(E.label),1)],10,GA))),128))])):D("",!0)],512)):(v(),g("div",{key:0,class:"tabs",ref_key:"tabsRef",ref:i},[(v(!0),g(Ae,null,Ue(e.tabs,E=>(v(),g("button",{key:E.value,class:ve(["tab-button",{active:e.modelValue===E.value}]),onClick:B=>M.$emit("update:modelValue",E.value),type:"button"},[E.icon?(v(),g("span",{key:0,class:"tab-icon",innerHTML:N(Xn)(E.icon)},null,8,BA)):D("",!0),Ye(" "+I(E.label),1)],10,OA))),128))],512))],512))}},fl=He(ZA,[["__scopeId","data-v-736c5d0a"]]),WA={class:"tab-content"},KA={class:"form-group"},JA=["value"],YA={class:"form-group"},XA=["value"],QA={class:"form-group"},eE={class:"area-display"},tE={key:0,class:"no-area"},nE={class:"form-help"},oE={class:"form-group checkbox-group"},sE={class:"checkbox-label"},aE=["checked"],iE={class:"form-help"},lE={key:0,class:"custom-times-section"},rE={class:"form-group"},cE=["value"],uE={class:"form-help"},dE={class:"form-group"},hE=["value"],fE={class:"form-help"},pE={__name:"LocationDetailsTab",props:{form:{type:Object,required:!0},areas:{type:Array,default:()=>[]},eventDate:{type:String,default:""},areaTermSingular:{type:String,default:"Area"},areaTermPlural:{type:String,default:"Areas"},checkpointTermSingular:{type:String,default:"checkpoint"},peopleTermPlural:{type:String,default:"marshals"}},emits:["update:form","input","save"],setup(e,{emit:t}){const o=e,a=t,n=V(()=>(o.form.areaIds||o.form.AreaIds||[]).map(d=>o.areas.find(h=>h.id===d)).filter(d=>d!==void 0)),i=(u,d)=>{a("update:form",{...o.form,[u]:d}),a("input")},l=u=>{const d={...o.form,useCustomTimes:u};if(!u)d.startTime="",d.endTime="";else if(!d.startTime&&!d.endTime&&o.eventDate){const h=sr(o.eventDate);d.startTime=h,d.endTime=h}a("update:form",d),a("input")};return(u,d)=>(v(),g("div",WA,[r("form",{onSubmit:d[5]||(d[5]=lt(h=>u.$emit("save"),["prevent"]))},[r("div",KA,[d[6]||(d[6]=r("label",null,"Name",-1)),r("input",{value:e.form.name,onInput:d[0]||(d[0]=h=>i("name",h.target.value)),type:"text",required:"",class:"form-input"},null,40,JA)]),r("div",YA,[d[7]||(d[7]=r("label",null,"Description (optional)",-1)),r("input",{value:e.form.description,onInput:d[1]||(d[1]=h=>i("description",h.target.value)),type:"text",class:"form-input"},null,40,XA)]),r("div",QA,[r("label",null,I(e.areaTermSingular)+" (auto-assigned by location)",1),r("div",eE,[n.value.length===0?(v(),g("span",tE," Not in any "+I(e.areaTermSingular.toLowerCase())+" polygon ",1)):D("",!0),(v(!0),g(Ae,null,Ue(n.value,h=>(v(),g("span",{key:h.id,class:"area-badge",style:Qe({backgroundColor:h.color||"var(--brand-primary)"})},I(h.name),5))),128))]),r("small",nE,I(e.areaTermPlural)+" are automatically assigned based on "+I(e.checkpointTermSingular.toLowerCase())+" location within "+I(e.areaTermSingular.toLowerCase())+" boundaries ",1)]),r("div",oE,[r("label",sE,[r("input",{checked:e.form.useCustomTimes,onChange:d[2]||(d[2]=h=>l(h.target.checked)),type:"checkbox"},null,40,aE),r("span",null,"Use custom date/time for this "+I(e.checkpointTermSingular.toLowerCase()),1)]),r("small",iE," By default, "+I(e.peopleTermPlural.toLowerCase())+" are expected during the event date/time. Enable this to set a specific time range. ",1)]),e.form.useCustomTimes?(v(),g("div",lE,[r("div",rE,[d[8]||(d[8]=r("label",null,"Start date & time (optional)",-1)),r("input",{value:e.form.startTime,onInput:d[3]||(d[3]=h=>i("startTime",h.target.value)),type:"datetime-local",class:"form-input"},null,40,cE),r("small",uE," When "+I(e.peopleTermPlural.toLowerCase())+" should arrive at this "+I(e.checkpointTermSingular.toLowerCase()),1)]),r("div",dE,[d[9]||(d[9]=r("label",null,"End date & time (optional)",-1)),r("input",{value:e.form.endTime,onInput:d[4]||(d[4]=h=>i("endTime",h.target.value)),type:"datetime-local",class:"form-input"},null,40,hE),r("small",fE," When "+I(e.peopleTermPlural.toLowerCase())+" can leave this "+I(e.checkpointTermSingular.toLowerCase()),1)])])):D("",!0)],32)]))}},vE=He(pE,[["__scopeId","data-v-aa628901"]]),mE={class:"scope-configuration-editor"},gE={class:"editor-header"},yE={class:"scope-types-list"},kE=["onClick"],bE={class:"scope-type-label"},_E={class:"scope-type-pill"},wE={class:"expand-label"},CE={class:"expand-icon"},LE={class:"modal-content"},SE={class:"modal-header"},IE={class:"modal-body"},xE={class:"scope-help"},$E={key:0,class:"form-group"},TE={class:"checkbox-label special-option"},ME=["checked"],AE={key:0,class:"specific-selection"},EE=["placeholder"],PE={class:"checkbox-group scrollable"},DE=["checked","onChange"],RE={key:1,class:"form-group"},OE={class:"checkbox-label special-option"},BE=["checked"],NE={key:0,class:"specific-selection"},FE={class:"checkbox-group scrollable"},UE=["checked","onChange"],zE={key:2,class:"form-group"},HE={class:"checkbox-label special-option"},VE=["checked"],GE={key:0,class:"specific-selection"},qE=["placeholder"],jE={class:"checkbox-group scrollable"},ZE={key:0,class:"checkbox-label this-checkpoint-option"},WE=["checked"],KE={class:"checkpoint-info"},JE={class:"checkpoint-name"},YE=["checked","onChange"],XE={class:"checkpoint-info"},QE={class:"checkpoint-name"},e4={key:0,class:"checkpoint-description"},t4={__name:"ScopeConfigurationEditor",props:{modelValue:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},excludeScopes:{type:Array,default:()=>[]},headerText:{type:String,default:""},intent:{type:String,default:"completion",validator:e=>["completion","location-update"].includes(e)},currentCheckpointId:{type:String,default:null}},emits:["update:modelValue","user-changed"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,n=t,i=V(()=>[{scope:"SpecificPeople",label:`Specific ${o.value.people}`},{scope:"EveryoneAtCheckpoints",label:`Every ${o.value.person} at specified ${o.value.checkpoints}`},{scope:"OnePerCheckpoint",label:`One ${o.value.person} at each specified ${o.value.checkpoint}`},{scope:"OnePerArea",label:`One ${o.value.person} in specified ${o.value.areas}`},{scope:"EveryoneInAreas",label:`Everyone in specified ${o.value.areas}`},{scope:"EveryAreaLead",label:`Every ${o.value.area} lead at specified ${o.value.areas}`},{scope:"OneLeadPerArea",label:`One lead per specified ${o.value.area}`}]),l=A({SpecificPeople:{enabled:!0,ids:["ALL_MARSHALS"]},EveryoneInAreas:{enabled:!1,ids:[]},EveryoneAtCheckpoints:{enabled:!1,ids:[]},OnePerCheckpoint:{enabled:!1,ids:[]},OnePerArea:{enabled:!1,ids:[]},EveryAreaLead:{enabled:!1,ids:[]},OneLeadPerArea:{enabled:!1,ids:[]}}),u=A(null),d=A(""),h=A(""),f=A(!a.isEditing);let m=!0,y=!1;const k=V(()=>i.value.filter(me=>!a.excludeScopes.includes(me.scope))),w=V(()=>f.value?k.value:k.value.filter(me=>U(me.scope))),S=V(()=>k.value.filter(ie=>U(ie.scope)).length<k.value.length),T=V(()=>{const me=k.value.filter(ie=>U(ie.scope)).length;return k.value.length-me}),x=V(()=>!a.currentCheckpointId&&a.intent==="location-update");We(()=>a.modelValue,me=>{if(me){if(y){y=!1;return}m=!0,Object.keys(l.value).forEach(ie=>{l.value[ie]={enabled:!1,ids:[]}}),me.forEach(ie=>{ie.scope==="Everyone"?l.value.SpecificPeople={enabled:!0,ids:["ALL_MARSHALS"]}:ie.scope==="AreaLead"?l.value.EveryAreaLead={enabled:!0,ids:[...ie.ids]}:l.value[ie.scope]&&(l.value[ie.scope]={enabled:!0,ids:[...ie.ids]})}),m=!1}},{immediate:!0});const C=()=>{const me=[];return Object.keys(l.value).forEach(ie=>{const z=l.value[ie];if(z.enabled){const K={scope:ie,itemType:_(ie),ids:[...z.ids]};me.push(K)}}),me};We(l,()=>{if(m)return;if(Object.keys(l.value).some(z=>z!=="SpecificPeople"&&l.value[z].enabled)&&l.value.SpecificPeople?.ids.includes("ALL_MARSHALS")){const z=l.value.SpecificPeople.ids.indexOf("ALL_MARSHALS");l.value.SpecificPeople.ids.splice(z,1),l.value.SpecificPeople.ids.length===0&&(l.value.SpecificPeople.enabled=!1)}y=!0;const ie=C();n("update:modelValue",ie),n("user-changed")},{deep:!0});const _=me=>$(me)?"Area":M(me)?"Checkpoint":H(me)?"Marshal":null,$=me=>me==="EveryoneInAreas"||me==="OnePerArea"||me==="EveryAreaLead"||me==="OneLeadPerArea",M=me=>me==="EveryoneAtCheckpoints"||me==="OnePerCheckpoint",H=me=>me==="SpecificPeople",E=me=>{const ie=i.value.find(z=>z.scope===me);return ie?ie.label:me},B=V(()=>a.headerText?a.headerText:a.intent==="location-update"?"Who can update this location?":`Who can see and complete this ${o.value.checklist}?`),R=me=>a.intent==="location-update"?{SpecificPeople:`Select "Everyone" or choose specific ${o.value.people} who can update the location`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} can update the location`,OnePerCheckpoint:`Any ${o.value.person} at each selected ${o.value.checkpoint} can update the location`,OnePerArea:`Any ${o.value.person} in each selected ${o.value.area} can update the location`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} can update the location`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} can update the location`,OneLeadPerArea:`Any ${o.value.area} lead at the selected ${o.value.areas} can update the location`}[me]||"":{SpecificPeople:`Select "Everyone at the event" or choose specific ${o.value.people} who must complete this (personal completion)`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} must complete this (personal completion)`,OnePerCheckpoint:`One completion needed at each selected ${o.value.checkpoint} (shared completion)`,OnePerArea:`One completion needed in each selected ${o.value.area} (shared completion)`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} must complete this (personal completion)`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} must complete this individually (personal completion)`,OneLeadPerArea:`One completion per ${o.value.area}, only ${o.value.area} leads can complete (shared among leads)`}[me]||"",U=me=>l.value[me]?.enabled||!1,F=me=>{const ie=l.value[me];if(!ie||!ie.enabled)return"No";const z=ie.ids||[];if($(me)){if(z.includes("ALL_AREAS"))return`All ${o.value.areas}`;const K=z.length;return K>0?`${K} ${K!==1?o.value.areas:o.value.area}`:`Select ${o.value.areas}...`}if(M(me)){if(z.includes("ALL_CHECKPOINTS"))return`All ${o.value.checkpoints}`;if(z.length===1&&z[0]==="THIS_CHECKPOINT")return`This ${o.value.checkpoint}`;const K=z.length;return K>0?`${K} ${K!==1?o.value.checkpoints:o.value.checkpoint}`:`Select ${o.value.checkpoints}...`}if(H(me)){if(z.includes("ALL_MARSHALS"))return"Everyone";const K=z.length;return K>0?`${K} ${K!==1?o.value.people:o.value.person}`:`Select ${o.value.people}...`}return"Configured"},j=me=>{u.value=me,d.value="",h.value=""},Y=()=>{u.value=null},oe=()=>{u.value&&(l.value[u.value]={enabled:!1,ids:[]}),Y()},Oe=()=>u.value&&l.value[u.value]?.ids.includes("ALL_MARSHALS"),ee=()=>{if(!u.value)return;const me=l.value[u.value];Oe()?(me.ids=[],me.enabled=!1):(me.ids=["ALL_MARSHALS"],me.enabled=!0)},te=me=>u.value&&l.value[u.value]?.ids.includes(me),O=me=>{if(!u.value)return;const ie=l.value[u.value],z=ie.ids.indexOf(me);z>=0?(ie.ids.splice(z,1),ie.ids.length===0&&(ie.enabled=!1)):(ie.ids.push(me),ie.enabled=!0)},Z=()=>{let me=a.marshals;if(h.value){const z=h.value.toLowerCase();me=me.filter(K=>K.name.toLowerCase().includes(z)||K.email&&K.email.toLowerCase().includes(z))}const ie=u.value?l.value[u.value]?.ids||[]:[];return[...me].sort((z,K)=>{const se=ie.includes(z.id),Ee=ie.includes(K.id);return se&&!Ee?-1:!se&&Ee?1:z.name.localeCompare(K.name,void 0,{sensitivity:"base"})})},ne=()=>u.value&&l.value[u.value]?.ids.includes("ALL_AREAS"),pe=()=>{if(!u.value)return;const me=l.value[u.value];ne()?(me.ids=[],me.enabled=!1):(me.ids=["ALL_AREAS"],me.enabled=!0)},we=me=>u.value&&l.value[u.value]?.ids.includes(me),Ze=()=>{const me=u.value?l.value[u.value]?.ids||[]:[];return[...a.areas].sort((ie,z)=>{const K=me.includes(ie.id),se=me.includes(z.id);return K&&!se?-1:!K&&se?1:ie.name.localeCompare(z.name,void 0,{sensitivity:"base"})})},Ne=me=>{if(!u.value)return;const ie=l.value[u.value],z=ie.ids.indexOf(me);z>=0?(ie.ids.splice(z,1),ie.ids.length===0&&(ie.enabled=!1)):(ie.ids.push(me),ie.enabled=!0)},Ge=()=>u.value&&l.value[u.value]?.ids.includes("ALL_CHECKPOINTS"),Xe=()=>{if(!u.value)return;const me=l.value[u.value];Ge()?(me.ids=[],me.enabled=!1):(me.ids=["ALL_CHECKPOINTS"],me.enabled=!0)},Q=me=>u.value&&l.value[u.value]?.ids.includes(me),ye=me=>{if(!u.value)return;const ie=l.value[u.value],z=ie.ids.indexOf(me);z>=0?(ie.ids.splice(z,1),ie.ids.length===0&&(ie.enabled=!1)):(ie.ids.push(me),ie.enabled=!0)},Ce=()=>{let me=a.locations;if(d.value){const z=d.value.toLowerCase();me=me.filter(K=>K.name.toLowerCase().includes(z)||K.description&&K.description.toLowerCase().includes(z))}const ie=u.value?l.value[u.value]?.ids||[]:[];return[...me].sort((z,K)=>{const se=ie.includes(z.id),Ee=ie.includes(K.id);return se&&!Ee?-1:!se&&Ee?1:Ws(z.name,K.name)})};return(me,ie)=>(v(),g("div",mE,[r("div",gE,[r("h4",null,I(B.value),1)]),r("div",yE,[(v(!0),g(Ae,null,Ue(w.value,z=>(v(),g("div",{key:z.scope,class:ve(["scope-type-row",{active:U(z.scope)}]),onClick:K=>j(z.scope)},[r("div",bE,I(z.label),1),r("div",_E,I(F(z.scope)),1)],10,kE))),128)),S.value?(v(),g("div",{key:0,class:"expand-row",onClick:ie[0]||(ie[0]=z=>f.value=!f.value)},[r("div",wE,I(f.value?"Show less":`Show ${T.value} more option${T.value!==1?"s":""}...`),1),r("div",CE,I(f.value?"":""),1)])):D("",!0)]),u.value?(v(),g("div",{key:0,class:"scope-config-modal",onClick:lt(Y,["self"])},[r("div",LE,[r("div",SE,[r("h5",null,I(E(u.value)),1),r("button",{onClick:Y,class:"btn-close",type:"button"},"")]),r("div",IE,[r("p",xE,I(R(u.value)),1),H(u.value)?(v(),g("div",$E,[r("label",TE,[r("input",{type:"checkbox",checked:Oe(),onChange:ee},null,40,ME),r("span",null,[ie[4]||(ie[4]=r("strong",null,"Everyone at the event",-1)),Ye(" (all current and future "+I(N(o).people)+")",1)])]),Oe()?D("",!0):(v(),g("div",AE,[ze(r("input",{"onUpdate:modelValue":ie[1]||(ie[1]=z=>h.value=z),type:"text",placeholder:`Search ${N(o).people}...`,class:"search-input"},null,8,EE),[[nt,h.value]]),r("div",PE,[(v(!0),g(Ae,null,Ue(Z(),z=>(v(),g("label",{key:z.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:te(z.id),onChange:K=>O(z.id)},null,40,DE),r("span",null,I(z.name),1)]))),128))])]))])):D("",!0),$(u.value)?(v(),g("div",RE,[r("label",OE,[r("input",{type:"checkbox",checked:ne(),onChange:pe},null,40,BE),r("span",null,[r("strong",null,"All "+I(N(o).areas),1),Ye(" (includes future "+I(N(o).areas)+")",1)])]),ne()?D("",!0):(v(),g("div",NE,[r("div",FE,[(v(!0),g(Ae,null,Ue(Ze(),z=>(v(),g("label",{key:z.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:we(z.id),onChange:K=>Ne(z.id)},null,40,UE),r("span",{class:"area-color-dot",style:Qe({backgroundColor:z.color||"#667eea"})},null,4),r("span",null,I(z.name),1)]))),128))])]))])):D("",!0),M(u.value)?(v(),g("div",zE,[r("label",HE,[r("input",{type:"checkbox",checked:Ge(),onChange:Xe},null,40,VE),r("span",null,[r("strong",null,"All "+I(N(o).checkpoints),1),Ye(" (includes future "+I(N(o).checkpoints)+")",1)])]),Ge()?D("",!0):(v(),g("div",GE,[ze(r("input",{"onUpdate:modelValue":ie[2]||(ie[2]=z=>d.value=z),type:"text",placeholder:`Search ${N(o).checkpoints}...`,class:"search-input"},null,8,qE),[[nt,d.value]]),r("div",jE,[x.value?(v(),g("label",ZE,[r("input",{type:"checkbox",checked:Q("THIS_CHECKPOINT"),onChange:ie[3]||(ie[3]=z=>ye("THIS_CHECKPOINT"))},null,40,WE),r("div",KE,[r("span",JE,[r("strong",null,"This "+I(N(o).checkpoint),1)])])])):D("",!0),(v(!0),g(Ae,null,Ue(Ce(),z=>(v(),g("label",{key:z.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:Q(z.id),onChange:K=>ye(z.id)},null,40,YE),r("div",XE,[r("span",QE,I(z.name),1),z.description?(v(),g("span",e4," - "+I(z.description),1)):D("",!0)])]))),128))])]))])):D("",!0)]),r("div",{class:"modal-footer"},[r("button",{onClick:oe,class:"btn btn-secondary",type:"button"},"Deselect all"),r("button",{onClick:Y,class:"btn btn-primary",type:"button"},"Done")])])])):D("",!0)]))}},Dc=He(t4,[["__scopeId","data-v-d465703e"]]),n4={class:"tab-content"},o4={class:"form-group"},s4=["value"],a4={key:0,class:"form-error"},i4={class:"form-row"},l4={class:"form-group"},r4=["disabled"],c4={class:"form-group"},u4=["disabled"],d4={class:"form-group"},h4={class:"accordion-item"},f4={class:"accordion-preview"},p4={class:"accordion-arrow"},v4={key:0,class:"accordion-content"},m4={class:"section-description"},g4={class:"dynamic-checkbox"},y4=["checked"],k4={key:0,class:"dynamic-settings"},b4={__name:"LocationCoordinatesTab",props:{form:{type:Object,required:!0},isMoving:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:"Checkpoint"},peopleTermPlural:{type:String,default:"Marshals"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:form","input","save","move-location"],setup(e,{emit:t}){const o=e,a=t,n=A(!1),i=A(""),l=A(""),u=k=>k==null||k===""||isNaN(k)?"":Number(k).toFixed(6);We(()=>o.form.longitude,k=>{i.value=u(k)},{immediate:!0}),We(()=>o.form.latitude,k=>{l.value=u(k)},{immediate:!0});const d=k=>{const w=k==="longitude"?i:l,S=parseFloat(w.value);isNaN(S)?w.value.trim()===""&&(a("update:form",{...o.form,[k]:0}),a("input"),w.value=u(0)):(a("update:form",{...o.form,[k]:S}),a("input"),w.value=u(S))},h=(k,w)=>{a("update:form",{...o.form,[k]:w}),a("input")},f=k=>{if(k){const S=[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[o.form.id||"THIS_CHECKPOINT"]}];a("update:form",{...o.form,isDynamic:!0,latitude:0,longitude:0,locationUpdateScopeConfigurations:S})}else a("update:form",{...o.form,isDynamic:!1});a("input")},m=k=>{a("update:form",{...o.form,locationUpdateScopeConfigurations:k}),a("input")},y=k=>{if(!k)return!0;const w=k.includes(".")?k.split("."):k.split("/");if(w.length!==3)return!1;const S=/^[a-z]{1,20}$/;return w.every(T=>S.test(T))};return(k,w)=>(v(),g("div",n4,[r("form",{onSubmit:w[6]||(w[6]=lt(S=>k.$emit("save"),["prevent"]))},[r("div",o4,[w[10]||(w[10]=r("label",null,"What3Words (optional)",-1)),r("input",{value:e.form.what3Words,onInput:w[0]||(w[0]=S=>h("what3Words",S.target.value)),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap"},null,40,s4),e.form.what3Words&&!y(e.form.what3Words)?(v(),g("small",a4," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):D("",!0)]),e.form.isDynamic?D("",!0):(v(),g(Ae,{key:0},[r("div",i4,[r("div",l4,[w[11]||(w[11]=r("label",null,"Longitude",-1)),ze(r("input",{"onUpdate:modelValue":w[1]||(w[1]=S=>i.value=S),onBlur:w[2]||(w[2]=S=>d("longitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., -0.091234"},null,40,r4),[[nt,i.value]])]),r("div",c4,[w[12]||(w[12]=r("label",null,"Latitude",-1)),ze(r("input",{"onUpdate:modelValue":w[3]||(w[3]=S=>l.value=S),onBlur:w[4]||(w[4]=S=>d("latitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., 51.505123"},null,40,u4),[[nt,l.value]])])]),r("div",d4,[r("button",{type:"button",onClick:w[5]||(w[5]=S=>k.$emit("move-location")),class:ve(["btn btn-secondary btn-with-icon",{"btn-primary":e.isMoving}])},[w[13]||(w[13]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),Ye(" "+I(e.isMoving?"Click on map to set new location...":`Move ${e.checkpointTermSingular.toLowerCase()}...`),1)],2)])],64))],32),r("div",h4,[r("button",{type:"button",class:ve(["accordion-header",{expanded:n.value}]),onClick:w[7]||(w[7]=S=>n.value=!n.value)},[w[14]||(w[14]=Ql('<div class="accordion-icon" data-v-bd432637><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-bd432637><path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="#F59E0B" opacity="0.3" data-v-bd432637></path><path d="M12 6L13.5 9L17 9.5L14.5 12L15 15.5L12 14L9 15.5L9.5 12L7 9.5L10.5 9L12 6Z" fill="#F59E0B" data-v-bd432637></path><circle cx="12" cy="11" r="2" fill="white" data-v-bd432637></circle></svg></div><span class="accordion-title" data-v-bd432637>Dynamic location</span>',2)),r("span",f4,I(e.form.isDynamic?"Enabled":"Disabled"),1),r("span",p4,I(n.value?"":""),1)],2),n.value?(v(),g("div",v4,[r("p",m4," Enable this for lead cars, sweep vehicles, or other moving "+I(e.checkpointTermSingular.toLowerCase())+"s whose location can be updated by designated "+I(e.peopleTermPlural.toLowerCase())+" during the event. ",1),r("label",g4,[r("input",{type:"checkbox",checked:e.form.isDynamic,onChange:w[8]||(w[8]=S=>f(S.target.checked))},null,40,y4),r("span",null,"This "+I(e.checkpointTermSingular.toLowerCase())+" can move",1)]),e.form.isDynamic?(v(),g("div",k4,[Me(Dc,{"model-value":e.form.locationUpdateScopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":e.isEditing,"header-text":`Who can update this ${e.checkpointTermSingular.toLowerCase()}'s location?`,"exclude-scopes":["OnePerCheckpoint","OneLeadPerArea","OnePerArea"],intent:"location-update","current-checkpoint-id":e.form.id,"onUpdate:modelValue":m,onUserChanged:w[9]||(w[9]=S=>k.$emit("input"))},null,8,["model-value","areas","locations","marshals","is-editing","header-text","current-checkpoint-id"])])):D("",!0)])):D("",!0)])]))}},_4=He(b4,[["__scopeId","data-v-bd432637"]]);function bg(e){const t=A(new Map),o=f=>t.value.has(f.id)?t.value.get(f.id):f.isCheckedIn;return{pendingCheckInChanges:t,getEffectiveCheckInStatus:o,handleToggleCheckIn:f=>{const y=!o(f);y===f.isCheckedIn?t.value.delete(f.id):t.value.set(f.id,y),e&&e()},getStatusIcon:f=>o(f)?"":"",getStatusColor:f=>o(f)?"#28a745":"#dc3545",getStatusText:f=>o(f)?"Checked in":"Not checked in",formatTime:f=>f?new Date(f).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",clearPendingChanges:()=>{t.value.clear()},getPendingChanges:()=>Array.from(t.value.entries()).map(([f,m])=>({assignmentId:f,shouldBeCheckedIn:m}))}}const w4={class:"card-main"},C4={class:"card-title"},L4={class:"marshal-name"},S4={key:0,class:"card-check-in"},I4={class:"toggle-icon"},x4={class:"toggle-label"},$4={key:0,class:"check-in-time"},T4={key:0,class:"check-in-method"},M4={key:1,class:"unsaved-indicator"},A4={key:1,class:"card-status-readonly"},E4={class:"status-icon"},P4={key:0,class:"check-in-time"},D4={key:0,class:"check-in-method"},R4={key:2,class:"card-badge"},O4={key:3,class:"card-badge"},B4={__name:"MarshalAssignmentCard",props:{assignment:{type:Object,required:!0},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},location:{type:Object,default:null}},emits:["click","toggle-check-in","remove","undo-remove","distance-click"],setup(e,{emit:t}){const o=e,a=t,n=()=>{a("distance-click",o.assignment)},i=y=>y?new Date(y).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",l=V(()=>{const{checkedInBy:y,checkInMethod:k,marshalName:w}=o.assignment;return y&&y!==w?y:k||""}),u=V(()=>!o.assignment.isPending&&!o.isMarkedForRemoval&&!o.readOnly),d=V(()=>{const{checkInLatitude:y,checkInLongitude:k}=o.assignment,w=o.location;return!y||!k||!w?.latitude||!w?.longitude?null:_i(y,k,w.latitude,w.longitude)}),h=V(()=>d.value===null?null:gw(d.value)),f=V(()=>d.value===null?"":d.value<=50?"distance-close":d.value<=100?"distance-medium":"distance-far"),m=()=>{u.value&&a("click",o.assignment)};return(y,k)=>(v(),g("div",{class:ve(["marshal-assignment-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-clickable":u.value}]),onClick:m},[r("div",w4,[r("div",C4,[r("span",L4,I(e.assignment.marshalName),1)]),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.readOnly?(v(),g("div",S4,[r("button",{class:ve(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:k[0]||(k[0]=lt(w=>y.$emit("toggle-check-in",e.assignment),["stop"]))},[r("span",I4,I(e.effectiveCheckInStatus?"":""),1),r("span",x4,I(e.effectiveCheckInStatus?"Checked in":"Check in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(v(),g("span",$4,[Ye(I(i(e.assignment.checkInTime))+" ",1),l.value?(v(),g("span",T4,"("+I(l.value)+")",1)):D("",!0),h.value?(v(),g("span",{key:1,class:ve(["check-in-distance",f.value]),onClick:lt(n,["stop"])},I(h.value),3)):D("",!0)])):e.hasUnsavedChanges?(v(),g("span",M4," Unsaved ")):D("",!0)])):D("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&e.readOnly?(v(),g("div",A4,[r("span",{class:ve(["status-badge",e.effectiveCheckInStatus?"status-checked-in":"status-not-checked-in"])},[r("span",E4,I(e.effectiveCheckInStatus?"":""),1),Ye(" "+I(e.effectiveCheckInStatus?"Checked in":"Not checked in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime?(v(),g("span",P4,[Ye(I(i(e.assignment.checkInTime))+" ",1),l.value?(v(),g("span",D4,"("+I(l.value)+")",1)):D("",!0),h.value?(v(),g("span",{key:1,class:ve(["check-in-distance",f.value]),onClick:lt(n,["stop"])},I(h.value),3)):D("",!0)])):D("",!0)])):D("",!0),e.assignment.isPending?(v(),g("div",R4,[...k[3]||(k[3]=[r("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):D("",!0),e.isMarkedForRemoval?(v(),g("div",O4,[...k[4]||(k[4]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):D("",!0)]),!e.readOnly&&!e.isMarkedForRemoval?(v(),g("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:k[1]||(k[1]=lt(w=>y.$emit("remove",e.assignment),["stop"]))},"  ")):D("",!0),e.isMarkedForRemoval?(v(),g("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:k[2]||(k[2]=lt(w=>y.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):D("",!0)],2))}},N4=He(B4,[["__scopeId","data-v-85a18d73"]]),F4={class:"tab-content"},U4={key:0,class:"read-only-notice"},z4={key:1,class:"form-group"},H4=["value"],V4={class:"section-title"},G4={key:2,class:"assign-section"},q4={__name:"LocationAssignmentsTab",props:{form:{type:Object,required:!0},assignments:{type:Array,default:()=>[]},peopleTerm:{type:String,default:"Marshals"},personTerm:{type:String,default:"Marshal"},checkpointTerm:{type:String,default:"Checkpoint"},readOnly:{type:Boolean,default:!1}},emits:["update:form","input","remove-assignment","open-assign-modal","select-marshal","distance-click"],setup(e,{expose:t,emit:o}){const a=e,n=V(()=>a.peopleTerm.toLowerCase()),i=V(()=>a.personTerm.toLowerCase()),l=V(()=>a.checkpointTerm.toLowerCase()),u=o,{pendingCheckInChanges:d,getEffectiveCheckInStatus:h,handleToggleCheckIn:f}=bg(()=>u("input")),m=A(new Set),y=V(()=>a.assignments?.length||0),k=V(()=>a.assignments?[...a.assignments].sort((R,U)=>(R.marshalName||"").localeCompare(U.marshalName||"",void 0,{sensitivity:"base"})):[]),w=R=>m.value.has(R),S=R=>{R.isPending||u("select-marshal",R)},T=A(!1),x=A(null),C=R=>{h(R)?(x.value=R,T.value=!0):f(R)},_=()=>{x.value&&f(x.value),T.value=!1,x.value=null},$=()=>{T.value=!1,x.value=null},M=V(()=>x.value?`Are you sure you want to undo ${x.value.marshalName||"this marshal"}'s check-in?`:""),H=R=>{R.isPending?u("remove-assignment",R):(m.value.add(R.id),u("input"))},E=R=>{m.value.delete(R.id),u("input")},B=(R,U)=>{u("update:form",{...a.form,[R]:Number(U)}),u("input")};return t({pendingCheckInChanges:d,clearPendingChanges:()=>{d.value.clear(),m.value.clear()},getPendingChanges:()=>Array.from(d.value.entries()).map(([R,U])=>({assignmentId:R,shouldBeCheckedIn:U})),getMarkedForRemoval:()=>Array.from(m.value)}),(R,U)=>(v(),g("div",F4,[e.readOnly?(v(),g("div",U4," Viewing from "+I(i.value)+" - "+I(n.value)+" cannot be modified here. ",1)):D("",!0),e.readOnly?D("",!0):(v(),g("div",z4,[r("label",null,"Required "+I(n.value),1),r("input",{value:e.form.requiredMarshals,onInput:U[0]||(U[0]=F=>B("requiredMarshals",F.target.value)),type:"number",min:"1",required:"",class:"form-input"},null,40,H4)])),r("h3",V4,"Assigned "+I(n.value)+" ("+I(y.value)+")",1),Me(pr,{"is-empty":e.assignments.length===0,"empty-message":`No ${n.value} assigned yet.`,"empty-hint":`Use the button below to assign ${n.value} to this ${l.value}.`},{default:Fe(()=>[(v(!0),g(Ae,null,Ue(k.value,F=>(v(),Ke(N4,{key:F.id,assignment:F,"effective-check-in-status":N(h)(F),"has-unsaved-changes":N(d).has(F.id),"is-marked-for-removal":w(F.id),"read-only":e.readOnly,location:e.form,onClick:S,onToggleCheckIn:C,onRemove:H,onUndoRemove:E,onDistanceClick:U[1]||(U[1]=j=>R.$emit("distance-click",j))},null,8,["assignment","effective-check-in-status","has-unsaved-changes","is-marked-for-removal","read-only","location"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),e.readOnly?D("",!0):(v(),g("div",G4,[r("button",{type:"button",class:"btn btn-primary assign-btn",onClick:U[2]||(U[2]=F=>R.$emit("open-assign-modal"))}," + Assign "+I(i.value)+"... ",1)])),Me(Da,{show:T.value,title:"Confirm check-out",message:M.value,"confirm-text":"Check out","is-danger":!0,onConfirm:_,onCancel:$},null,8,["show","message"])]))}},j4=He(q4,[["__scopeId","data-v-7124720e"]]),Z4={class:"grouped-tasks-list"},W4={key:0,class:"empty-state"},K4={key:1,class:"task-groups"},J4=["onClick"],Y4={class:"task-header-content"},X4={class:"task-checkbox-area"},Q4={class:"task-info"},e3={class:"task-name"},t3={class:"task-summary"},n3={key:0,class:"modified-badge"},o3={class:"task-scope"},s3=["title"],a3={class:"expand-arrow"},i3={key:0,class:"task-group-details"},l3={class:"detail-checkbox"},r3=["checked","disabled","onChange"],c3={class:"detail-content"},u3={class:"detail-context"},d3={key:0,class:"detail-completion"},h3={key:0,class:"pending-text"},f3={class:"completion-text"},p3={class:"completion-time"},v3={key:1,class:"detail-uncomplete"},m3={key:2,class:"detail-disabled"},g3={__name:"GroupedTasksList",props:{items:{type:Array,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["toggle-complete"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ct(),n=e,i=A(new Set),l=V(()=>{const w=new Map;for(const S of n.items){w.has(S.itemId)||w.set(S.itemId,{itemId:S.itemId,text:S.text,items:[],totalCount:0,completedCount:0,allCompleted:!1,hasModified:!1});const T=w.get(S.itemId);T.items.push(S),T.totalCount++,S.localIsCompleted&&T.completedCount++,S.isModified&&(T.hasModified=!0)}for(const S of w.values())S.allCompleted=S.completedCount===S.totalCount,S.items.sort((T,x)=>{const C=y(T),_=y(x);return C.localeCompare(_,void 0,{numeric:!0,sensitivity:"base"})});return Array.from(w.values()).sort((S,T)=>S.text.localeCompare(T.text,void 0,{sensitivity:"base"}))}),u=w=>{i.value.has(w)?i.value.delete(w):i.value.add(w),i.value=new Set(i.value)},d=w=>w.hasModified?"status-modified":w.allCompleted?"status-completed":w.completedCount>0?"status-partial":"status-pending",h=w=>w.allCompleted?"":w.completedCount>0?"":"",f=w=>({Everyone:"Everyone",SpecificPeople:"Assigned individually",EveryoneInAreas:`Per ${a.value.area}`,EveryoneAtCheckpoints:`Per ${a.value.checkpoint}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,OnePerArea:`One per ${a.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${a.value.area}`})[w.matchedScope]||w.matchedScope,m=w=>({Everyone:"This task is for everyone at the event",SpecificPeople:"This task is specifically assigned to certain people",EveryoneInAreas:`This task is for everyone in certain ${a.value.areas}`,EveryoneAtCheckpoints:`This task is for everyone at certain ${a.value.checkpoints}`,OnePerCheckpoint:`One person at the ${a.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${a.value.area} needs to complete this`,EveryAreaLead:`This task is for ${a.value.area} leads only`,OneLeadPerArea:`One ${a.value.area} lead needs to complete this`})[w.matchedScope]||"",y=w=>{if(!w.completionContextType||!w.completionContextId)return"Everyone";if(w.completionContextType==="Checkpoint"){const S=n.locations.find(T=>T.id===w.completionContextId);return S?S.description?`${S.name} - ${S.description}`:S.name:`${o.value.checkpoint} (unknown)`}if(w.completionContextType==="Area"){const S=n.areas.find(T=>T.id===w.completionContextId);return S?S.name:`${o.value.area} (unknown)`}if(w.completionContextType==="Personal"){if(w.contextOwnerName)return w.contextOwnerName;if(w.completionContextId&&n.marshals.length>0){const S=n.marshals.find(T=>T.id===w.completionContextId||T.marshalId===w.completionContextId);if(S)return S.name||S.marshalName}return"Assigned individually"}return w.completionContextType},k=w=>w?new Date(w).toLocaleString():"";return(w,S)=>(v(),g("div",Z4,[l.value.length===0?(v(),g("div",W4,[...S[0]||(S[0]=[r("p",null,"No tasks available.",-1)])])):(v(),g("div",K4,[(v(!0),g(Ae,null,Ue(l.value,T=>(v(),g("div",{key:T.itemId,class:ve(["task-group",{"all-completed":T.allCompleted,"has-modified":T.hasModified}])},[r("button",{type:"button",class:"task-group-header",onClick:x=>u(T.itemId)},[r("div",Y4,[r("div",X4,[r("span",{class:ve(["task-status-icon",d(T)])},I(h(T)),3)]),r("div",Q4,[r("div",e3,I(T.text),1),r("div",t3,[r("span",{class:ve(["completion-count",{"all-done":T.allCompleted}])},I(T.completedCount)+"/"+I(T.totalCount)+" completed ",3),T.hasModified?(v(),g("span",n3," Modified ")):D("",!0)])]),r("div",o3,[T.items[0]?.scopeConfigurations?.length?(v(),Ke(fr,{key:0,"scope-configurations":T.items[0].scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):(v(),g("span",{key:1,class:"scope-pill",title:m(T.items[0])},I(f(T.items[0])),9,s3))])]),r("span",a3,I(i.value.has(T.itemId)?"":""),1)],8,J4),i.value.has(T.itemId)?(v(),g("div",i3,[(v(!0),g(Ae,null,Ue(T.items,x=>(v(),g("div",{key:`${x.itemId}-${x.completionContextId}`,class:ve(["task-detail-item",{"item-completed":x.localIsCompleted,"item-modified":x.isModified}])},[r("div",l3,[r("input",{type:"checkbox",checked:x.localIsCompleted,disabled:!x.canBeCompletedByMe&&!x.localIsCompleted,onChange:C=>w.$emit("toggle-complete",x)},null,40,r3)]),r("div",c3,[r("div",u3,I(y(x)),1),x.localIsCompleted?(v(),g("div",d3,[x.isModified&&!x.isCompleted?(v(),g("span",h3," Will be marked as completed ")):(v(),g(Ae,{key:1},[r("span",f3,I(x.completedByActorName||"Unknown"),1),r("span",p3,I(k(x.completedAt)),1)],64))])):x.isModified&&x.isCompleted?(v(),g("div",v3,[...S[1]||(S[1]=[r("span",{class:"pending-text"},"Will be marked as incomplete",-1)])])):x.canBeCompletedByMe?D("",!0):(v(),g("div",m3," Already completed by someone else "))])],2))),128))])):D("",!0)],2))),128))]))]))}},jd=He(g3,[["__scopeId","data-v-90fc486c"]]),y3={class:"checkpoint-checklist-view"},k3={key:0,class:"loading-state"},b3={key:1,class:"error-state"},_3={key:2,class:"empty-state"},w3={class:"help-text"},C3={key:3,class:"empty-state"},L3={__name:"CheckpointChecklistView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{termsLower:a}=ct(),n=e,i=o,l=A([]),u=A(!1),d=A(null),h=A(new Map),f=V(()=>n.assignments.length===0),m=V(()=>l.value.map(T=>{const x=h.value.get(`${T.itemId}|||${T.completionContextId}`),C=x!==void 0?x.complete:T.isCompleted,_=x!==void 0&&x.complete!==T.isCompleted;return{...T,localIsCompleted:C,isModified:_}})),y=async()=>{if(!(!n.eventId||!n.locationId&&!n.areaId)){u.value=!0,d.value=null;try{const T=n.locationId?await Ut.getCheckpointChecklist(n.eventId,n.locationId):await Ut.getAreaChecklist(n.eventId,n.areaId);if(l.value=T.data||[],n.modelValue&&n.modelValue.length>0){const x=new Map;n.modelValue.forEach(C=>{x.set(`${C.itemId}|||${C.contextId}`,{complete:C.complete,contextType:C.contextType,contextId:C.contextId})}),h.value=x}}catch(T){console.error("Failed to load checklist:",T),d.value=T.response?.data?.message||"Failed to load checklist"}finally{u.value=!1}}},k=T=>{const x=T.contextOwnerMarshalId||(n.assignments.length>0?n.assignments[0].marshalId:null);if(!x)return;const C=`${T.itemId}|||${T.completionContextId}`,_=h.value.get(C),$=_!==void 0?_.complete:T.isCompleted;h.value.set(C,{complete:!$,contextType:T.completionContextType,contextId:T.completionContextId,marshalId:x}),w()},w=()=>{const T=[];for(const[x,C]of h.value.entries()){const[_,$]=x.split("|||"),M=l.value.find(H=>H.itemId===_&&H.completionContextId===$);M&&C.complete!==M.isCompleted&&T.push({itemId:_,complete:C.complete,contextType:C.contextType,contextId:C.contextId,marshalId:C.marshalId})}i("update:modelValue",T),i("change",T)};return t({resetLocalState:()=>{if(h.value=new Map,n.modelValue&&n.modelValue.length>0){const T=new Map;n.modelValue.forEach(x=>{T.set(`${x.itemId}|||${x.contextId}`,{complete:x.complete,contextType:x.contextType,contextId:x.contextId,marshalId:x.marshalId})}),h.value=T}},loadChecklist:y}),We(()=>[n.eventId,n.locationId,n.areaId],()=>{y()},{immediate:!0}),(T,x)=>(v(),g("div",y3,[u.value?(v(),g("div",k3," Loading checklist... ")):d.value?(v(),g("div",b3,[r("p",null,I(d.value),1),r("button",{onClick:y,class:"btn btn-secondary btn-small"}," Retry ")])):f.value?(v(),g("div",_3,[r("p",null,"No "+I(N(a).peoplePlural)+" assigned to this "+I(N(a).checkpoint)+" yet.",1),r("p",w3,"Assign "+I(N(a).peoplePlural)+" to enable "+I(N(a).checklist)+" completion.",1)])):l.value.length===0?(v(),g("div",C3,[r("p",null,"No checklist items for this "+I(N(a).checkpoint)+".",1)])):(v(),Ke(jd,{key:4,items:m.value,locations:e.locations,areas:e.areas,marshals:e.marshals,onToggleComplete:k},null,8,["items","locations","areas","marshals"]))]))}},_g=He(L3,[["__scopeId","data-v-d5d67805"]]),S3={class:"notes-view"},I3={key:0,class:"loading-state"},x3={key:1,class:"error-state"},$3={key:2,class:"empty-state"},T3={key:3,class:"notes-list"},M3={class:"note-header"},A3={class:"note-title-row"},E3={key:0,class:"pin-icon",title:"Pinned"},P3={class:"note-title"},D3={class:"note-meta"},R3={key:0,class:"category-badge"},O3={key:0,class:"note-content"},B3={class:"note-footer"},N3={class:"created-info"},F3={key:1,class:"scope-info"},U3={__name:"NotesView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},marshalId:{type:String,default:null},allNotes:{type:Array,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},showScope:{type:Boolean,default:!0}},setup(e,{expose:t}){const o=e,a=A([]),n=A(!1),i=A(null),l=V(()=>o.marshalId?"No notes for this marshal.":o.areaId?"No notes for this area.":o.locationId?"No notes for this checkpoint.":"No notes available."),u=V(()=>o.areaId?o.locations.filter(x=>x.areaIds&&x.areaIds.includes(o.areaId)):[]),d=V(()=>u.value.map(x=>x.id)),h=V(()=>{if(!o.areaId)return[];const x=new Set;return o.assignments.filter(C=>d.value.includes(C.locationId)).forEach(C=>x.add(C.marshalId)),Array.from(x)}),f=x=>o.assignments.filter(C=>C.marshalId===x).map(C=>C.locationId),m=x=>{const C=f(x),_=new Set;for(const $ of C){const M=o.locations.find(H=>H.id===$);M?.areaIds&&M.areaIds.forEach(H=>_.add(H))}return Array.from(_)},y=(x,C)=>{if(!x.scopeConfigurations)return null;for(const _ of x.scopeConfigurations){if(_.itemType==="Area"){if(C.type==="area"&&(_.ids.includes(C.areaId)||_.ids.includes("ALL_AREAS")))return{matched:!0,scope:_.scope==="EveryAreaLead"?"Area leads":"Area"};if(C.type==="checkpoint"){const M=o.locations.find(H=>H.id===C.locationId)?.areaIds||[];if(_.ids.includes("ALL_AREAS")||M.some(H=>_.ids.includes(H)))return{matched:!0,scope:_.scope==="EveryAreaLead"?"Area leads":"Area"}}}if(_.itemType==="Checkpoint"){if(C.type==="checkpoint"&&(_.ids.includes(C.locationId)||_.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint"};if(C.type==="area"&&C.checkpointIds.some(M=>_.ids.includes(M)||_.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint in area"}}if(_.itemType==="Marshal"){if(C.type==="marshal"&&(_.ids.includes(C.marshalId)||_.ids.includes("ALL_MARSHALS")))return{matched:!0,scope:"Marshal"};if(C.type==="checkpoint"){const $=o.assignments.filter(H=>H.locationId===C.locationId).map(H=>H.marshalId);if(_.ids.includes("ALL_MARSHALS")||$.some(H=>_.ids.includes(H)))return{matched:!0,scope:"Marshal at checkpoint"}}if(C.type==="area"&&(_.ids.includes("ALL_MARSHALS")||C.marshalIds.some(M=>_.ids.includes(M))))return{matched:!0,scope:"Marshal in area"}}if(C.type==="marshal"&&C.checkpointIds&&C.areaIds){if(_.itemType==="Checkpoint"&&(_.ids.includes("ALL_CHECKPOINTS")||C.checkpointIds.some(M=>_.ids.includes(M))))return{matched:!0,scope:"Assigned checkpoint"};if(_.itemType==="Area"&&(_.ids.includes("ALL_AREAS")||C.areaIds.some(M=>_.ids.includes(M))))return{matched:!0,scope:_.scope==="EveryAreaLead"?"Area lead":"Area"}}}return null},k=V(()=>{const x=o.allNotes||a.value;if(!x||x.length===0)return[];if(o.areaId&&o.allNotes){const C={type:"area",areaId:o.areaId,checkpointIds:d.value,marshalIds:h.value},_=[],$=new Set;for(const M of x){if($.has(M.noteId))continue;const H=y(M,C);H&&($.add(M.noteId),_.push({...M,matchedScope:H.scope}))}return _}if(o.locationId&&o.allNotes){const C={type:"checkpoint",locationId:o.locationId},_=[],$=new Set;for(const M of x){if($.has(M.noteId))continue;const H=y(M,C);H&&($.add(M.noteId),_.push({...M,matchedScope:H.scope}))}return _}if(o.marshalId&&o.allNotes){const C=f(o.marshalId),_=m(o.marshalId),$={type:"marshal",marshalId:o.marshalId,checkpointIds:C,areaIds:_},M=[],H=new Set;for(const E of x){if(H.has(E.noteId))continue;const B=y(E,$);B&&(H.add(E.noteId),M.push({...E,matchedScope:B.scope}))}return M}return x}),w=V(()=>{const x={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return[...k.value].sort((C,_)=>{if(C.isPinned!==_.isPinned)return C.isPinned?-1:1;const $=x[C.priority]??2,M=x[_.priority]??2;return $!==M?$-M:C.displayOrder!==_.displayOrder?C.displayOrder-_.displayOrder:new Date(_.createdAt)-new Date(C.createdAt)})}),S=async()=>{if(o.allNotes===null&&o.eventId){n.value=!0,i.value=null;try{let x;o.marshalId?x=await fs.getMarshalNotes(o.eventId,o.marshalId):x=await fs.getByEvent(o.eventId),a.value=x.data||[]}catch(x){console.error("Failed to load notes:",x),i.value=x.response?.data?.message||"Failed to load notes"}finally{n.value=!1}}};We(()=>[o.eventId,o.locationId,o.areaId,o.marshalId],()=>{o.allNotes===null&&S()},{immediate:!0});const T=x=>{if(!x)return"";const C=new Date(x),$=new Date-C,M=Math.floor($/6e4),H=Math.floor($/36e5),E=Math.floor($/864e5);return M<1?"just now":M<60?`${M}m ago`:H<24?`${H}h ago`:E<7?`${E}d ago`:C.toLocaleDateString()};return t({loadNotes:S}),(x,C)=>(v(),g("div",S3,[n.value?(v(),g("div",I3," Loading notes... ")):i.value?(v(),g("div",x3,[r("p",null,I(i.value),1),r("button",{onClick:S,class:"btn btn-secondary btn-small"}," Retry ")])):k.value.length===0?(v(),g("div",$3,[r("p",null,I(l.value),1)])):(v(),g("div",T3,[(v(!0),g(Ae,null,Ue(w.value,_=>(v(),g("div",{key:_.noteId,class:ve(["note-item",{pinned:_.isPinned}])},[r("div",M3,[r("div",A3,[_.isPinned?(v(),g("span",E3,"")):D("",!0),r("span",{class:ve(["priority-indicator",(_.priority||"Normal").toLowerCase()])},null,2),r("strong",P3,I(_.title),1)]),r("div",D3,[_.category?(v(),g("span",R3,I(_.category),1)):D("",!0),r("span",{class:ve(["priority-badge",(_.priority||"Normal").toLowerCase()])},I(_.priority||"Normal"),3)])]),_.content?(v(),g("div",O3,I(_.content),1)):D("",!0),r("div",B3,[r("span",N3," Created by "+I(_.createdByName||"Unknown")+"  "+I(T(_.createdAt)),1),_.scopeConfigurations?.length&&e.showScope?(v(),Ke(fr,{key:0,class:"scope-pills","scope-configurations":_.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):_.matchedScope&&e.showScope?(v(),g("span",F3,I(_.matchedScope),1)):D("",!0)])],2))),128))]))]))}},Rc=He(U3,[["__scopeId","data-v-9887fcb2"]]),z3={class:"checklist-preview"},H3={class:"preview-actions"},V3={class:"preview-header"},G3={key:0,class:"add-item-form"},q3=["placeholder"],j3=["disabled"],Z3={key:1,class:"pending-items"},W3={class:"item-content"},K3={class:"item-header"},J3={class:"item-text"},Y3={class:"item-scope"},X3=["onClick"],Q3={key:2,class:"empty-state"},eP={key:0,class:"help-text"},tP={key:3,class:"checklist-items"},nP={class:"item-content"},oP={class:"item-header"},sP={class:"item-text"},aP={class:"item-scope"},iP=["title"],lP={key:0,class:"item-context"},rP={__name:"ChecklistPreviewForLocation",props:{allChecklistItems:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ct(),n=e,i=V(()=>n.checkpointTermSingular?n.checkpointTermSingular.toLowerCase():a.value.checkpoint),l=t,u=A(!1),d=A(""),h=A([...n.modelValue]);We(()=>n.modelValue,_=>{h.value=[..._]},{deep:!0});const f=()=>{d.value.trim()&&(h.value.push({text:d.value.trim(),isNew:!0}),d.value="",u.value=!1,y())},m=_=>{h.value.splice(_,1),y()},y=()=>{l("update:modelValue",[...h.value]),l("change")},k=_=>{const $=_.scope,M=_.itemType,H=_.ids||[];return($==="EveryoneAtCheckpoints"||$==="OnePerCheckpoint")&&M==="Checkpoint"?H.includes("ALL_CHECKPOINTS"):$==="OnePerCheckpoint"&&M==="Area"?H.includes("ALL_AREAS")?!0:H.some(E=>n.pendingAreaIds.includes(E)):($==="EveryoneInAreas"||$==="OnePerArea"||$==="EveryAreaLead"||$==="OneLeadPerArea")&&M==="Area"?H.includes("ALL_AREAS")?!0:H.some(E=>n.pendingAreaIds.includes(E)):!1},w=V(()=>n.allChecklistItems.filter(_=>_.scopeConfigurations&&_.scopeConfigurations.length>0?_.scopeConfigurations.some($=>k($)):!1)),S=_=>({EveryoneAtCheckpoints:`All at ${a.value.checkpoints}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,EveryoneInAreas:`All in ${a.value.areas}`,OnePerArea:`One per ${a.value.area}`,EveryAreaLead:`${a.value.area} leads`,OneLeadPerArea:`One lead per ${a.value.area}`})[_]||_,T=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"Unknown";const $=_.scopeConfigurations.find(H=>k(H));if(!$)return S(_.scopeConfigurations[0].scope);const M=$.ids||[];return M.includes("ALL_CHECKPOINTS")?`All ${a.value.checkpoints}`:M.includes("ALL_AREAS")?`All ${a.value.areas}`:S($.scope)},x=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"";const $=_.scopeConfigurations.find(H=>k(H));return $&&{EveryoneAtCheckpoints:`This item is for everyone at specified ${a.value.checkpoints}`,OnePerCheckpoint:`One person at each ${a.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${a.value.areas}`,OnePerArea:`One person in each ${a.value.area} needs to complete this`,EveryAreaLead:`This item is for ${a.value.area} leads only`,OneLeadPerArea:`One ${a.value.area} lead needs to complete this`}[$.scope]||""},C=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return null;const $=_.scopeConfigurations.find(E=>k(E));if(!$)return null;const M=$.itemType,H=$.ids||[];if(H.includes("ALL_CHECKPOINTS")||H.includes("ALL_AREAS"))return null;if(M==="Area"){const E=n.areas.filter(B=>H.includes(B.id)&&n.pendingAreaIds.includes(B.id)).map(B=>B.name);if(E.length>0)return`In: ${E.join(", ")}`}return null};return(_,$)=>(v(),g("div",z3,[r("div",H3,[r("p",V3,I(e.isEditing?`Add new ${N(a).checklist} for this ${i.value}:`:`${N(o).checklists} that will apply at this ${i.value}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:$[0]||($[0]=M=>u.value=!u.value)},I(u.value?"Cancel":`Add ${N(a).checklist}`),1)]),u.value?(v(),g("div",G3,[ze(r("input",{"onUpdate:modelValue":$[1]||($[1]=M=>d.value=M),type:"text",placeholder:`Enter ${N(a).checklist} text...`,class:"add-item-input",onKeyup:To(f,["enter"])},null,40,q3),[[nt,d.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!d.value.trim(),onClick:f}," Add ",8,j3)])):D("",!0),h.value.length>0?(v(),g("div",Z3,[(v(!0),g(Ae,null,Ue(h.value,(M,H)=>(v(),g("div",{key:`pending-${H}`,class:"checklist-item pending"},[$[3]||($[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",W3,[r("div",K3,[r("div",J3,I(M.text),1),r("div",Y3,[$[2]||($[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:E=>m(H),title:"Remove"},"  ",8,X3)])])])]))),128))])):D("",!0),!e.isEditing&&w.value.length===0&&h.value.length===0?(v(),g("div",Q3,[r("p",null,"No "+I(N(a).checklists)+" will apply based on the current "+I(N(a).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),g("p",eP," Assign "+I(N(a).areas)+" to see relevant "+I(N(a).checklists)+". ",1)):D("",!0)])):D("",!0),!e.isEditing&&w.value.length>0?(v(),g("div",tP,[(v(!0),g(Ae,null,Ue(w.value,M=>(v(),g("div",{key:M.id,class:"checklist-item"},[$[4]||($[4]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",nP,[r("div",oP,[r("div",sP,I(M.text),1),r("div",aP,[r("span",{class:"scope-pill",title:x(M)},I(T(M)),9,iP)])]),C(M)?(v(),g("div",lP,I(C(M)),1)):D("",!0)])]))),128))])):D("",!0)]))}},cP=He(rP,[["__scopeId","data-v-7d943b21"]]),uP={class:"notes-preview"},dP={class:"preview-actions"},hP={class:"preview-header"},fP={key:0,class:"add-item-form"},pP={class:"add-form-fields"},vP=["disabled"],mP={key:1,class:"pending-items"},gP={class:"note-header"},yP={class:"note-title"},kP={class:"note-actions"},bP=["onClick"],_P={key:0,class:"note-content"},wP={key:2,class:"empty-state"},CP={key:0,class:"help-text"},LP={key:3,class:"notes-list"},SP={class:"note-header"},IP={class:"note-title"},xP=["title"],$P={key:0,class:"note-content"},TP={key:1,class:"note-context"},MP={__name:"NotesPreviewForLocation",props:{allNotes:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,n=t,i=V(()=>a.checkpointTermSingular?a.checkpointTermSingular.toLowerCase():o.value.checkpoint),l=A(!1),u=A(""),d=A(""),h=A([...a.modelValue]);We(()=>a.modelValue,_=>{h.value=[..._]},{deep:!0});const f=()=>{!u.value.trim()&&!d.value.trim()||(h.value.push({title:u.value.trim(),content:d.value.trim(),isNew:!0}),u.value="",d.value="",l.value=!1,y())},m=_=>{h.value.splice(_,1),y()},y=()=>{n("update:modelValue",[...h.value]),n("change")},k=_=>{const $=_.scope,M=_.itemType,H=_.ids||[];return $==="EveryoneAtCheckpoints"&&M==="Checkpoint"?H.includes("ALL_CHECKPOINTS"):$==="EveryoneInAreas"&&M==="Area"?H.includes("ALL_AREAS")?!0:H.some(E=>a.pendingAreaIds.includes(E)):!1},w=V(()=>a.allNotes.filter(_=>_.scopeConfigurations&&_.scopeConfigurations.length>0?_.scopeConfigurations.some($=>k($)):!1)),S=_=>({EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[_]||_,T=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"Unknown";const $=_.scopeConfigurations.find(H=>k(H));if(!$)return S(_.scopeConfigurations[0].scope);const M=$.ids||[];return M.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:M.includes("ALL_AREAS")?`All ${o.value.areas}`:S($.scope)},x=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"";const $=_.scopeConfigurations.find(H=>k(H));return $&&{EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[$.scope]||""},C=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return null;const $=_.scopeConfigurations.find(E=>k(E));if(!$)return null;const M=$.itemType,H=$.ids||[];if(H.includes("ALL_CHECKPOINTS")||H.includes("ALL_AREAS"))return null;if(M==="Area"){const E=a.areas.filter(B=>H.includes(B.id)&&a.pendingAreaIds.includes(B.id)).map(B=>B.name);if(E.length>0)return`In: ${E.join(", ")}`}return null};return(_,$)=>(v(),g("div",uP,[r("div",dP,[r("p",hP,I(e.isEditing?`Add new note for this ${i.value}:`:`Notes that will be visible at this ${i.value}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:$[0]||($[0]=M=>l.value=!l.value)},I(l.value?"Cancel":"Add note"),1)]),l.value?(v(),g("div",fP,[r("div",pP,[ze(r("input",{"onUpdate:modelValue":$[1]||($[1]=M=>u.value=M),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[nt,u.value]]),ze(r("textarea",{"onUpdate:modelValue":$[2]||($[2]=M=>d.value=M),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[nt,d.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!u.value.trim()&&!d.value.trim(),onClick:f}," Add ",8,vP)])):D("",!0),h.value.length>0?(v(),g("div",mP,[(v(!0),g(Ae,null,Ue(h.value,(M,H)=>(v(),g("div",{key:`pending-${H}`,class:"note-item pending"},[r("div",gP,[r("span",yP,I(M.title||"Untitled"),1),r("div",kP,[$[3]||($[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:E=>m(H),title:"Remove"},"  ",8,bP)])]),M.content?(v(),g("div",_P,I(M.content),1)):D("",!0)]))),128))])):D("",!0),!e.isEditing&&w.value.length===0&&h.value.length===0?(v(),g("div",wP,[r("p",null,"No notes will apply based on the current "+I(N(o).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),g("p",CP," Assign "+I(N(o).areas)+" to see relevant notes. ",1)):D("",!0)])):D("",!0),!e.isEditing&&w.value.length>0?(v(),g("div",LP,[(v(!0),g(Ae,null,Ue(w.value,M=>(v(),g("div",{key:M.id,class:"note-item"},[r("div",SP,[r("span",IP,I(M.title||"Untitled"),1),r("span",{class:"scope-pill",title:x(M)},I(T(M)),9,xP)]),M.content?(v(),g("div",$P,I(M.content),1)):D("",!0),C(M)?(v(),g("div",TP,I(C(M)),1)):D("",!0)]))),128))])):D("",!0)]))}},AP=He(MP,[["__scopeId","data-v-71646c3f"]]),EP={class:"base-modal-title modal-title-with-icon"},PP=["innerHTML"],DP={key:7,class:"tab-content appearance-tab"},RP={class:"accordion-item"},OP=["innerHTML"],BP={class:"accordion-title"},NP={class:"accordion-arrow"},FP={key:0,class:"accordion-content"},UP={class:"section-description"},zP={class:"accordion-item"},HP={class:"accordion-preview"},VP={class:"accordion-arrow"},GP={key:0,class:"accordion-content"},qP={class:"section-description"},jP={class:"terminology-row"},ZP={class:"terminology-field"},WP=["value"],KP={value:""},JP=["value"],YP={class:"terminology-field"},XP=["value"],QP={value:""},e5=["value"],t5={key:8,class:"tab-content incidents-tab"},n5={class:"incidents-list"},o5={class:"custom-footer"},s5={class:"footer-left"},Lp="edit_location_accordion",a5={__name:"EditLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:null},assignments:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventDate:{type:String,default:""},areas:{type:Array,default:()=>[]},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},availableMarshals:{type:Array,default:()=>[]},allMarshals:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},zIndex:{type:Number,default:1e3},incidents:{type:Array,default:()=>[]},lockedFromMarshal:{type:Boolean,default:!1}},emits:["close","save","delete","move-location","toggle-check-in","remove-assignment","open-assign-modal","update:isDirty","select-incident","select-marshal"],setup(e,{emit:t}){const{terms:o}=ct(),a=e,n=t,i=A("details"),l=A(!1),u=A(null),d=A(null),h=A([]),f=A([]),m=A([]),y=A({id:null,name:"",description:"",what3Words:"",latitude:0,longitude:0,requiredMarshals:1,useCustomTimes:!1,startTime:"",endTime:"",areaIds:[],styleType:"default",styleColor:"",styleBackgroundShape:"",styleBackgroundColor:"",styleBorderColor:"",styleIconColor:"",styleSize:"",styleMapRotation:"",peopleTerm:"",checkpointTerm:"",isDynamic:!1,locationUpdateScopeConfigurations:[]}),k=A(!1),w=A(null),S=fe=>{w.value=fe,k.value=!0},T=()=>{k.value=!1,w.value=null},x=V(()=>w.value&&w.value.marshalName||""),C=V(()=>y.value.name||a.location?.name||""),_=V(()=>{if(!w.value)return null;const{checkInLatitude:fe,checkInLongitude:W}=w.value;return!fe||!W?null:{lat:fe,lng:W}}),$=V(()=>{const fe=y.value.latitude,W=y.value.longitude;return!fe||!W?null:{lat:fe,lng:W}}),M=V(()=>{if(!w.value)return null;const{checkInLatitude:fe,checkInLongitude:W}=w.value,J=y.value.latitude,re=y.value.longitude;return!fe||!W||!J||!re?null:_i(fe,W,J,re)}),H=()=>a.eventId?`${Lp}_${a.eventId}`:Lp,E=A({iconStyle:!1,terminology:!1});ln(()=>{const fe=localStorage.getItem(H());if(fe)try{const W=JSON.parse(fe);E.value={...E.value,...W}}catch{}});const B=fe=>{E.value[fe]=!E.value[fe],localStorage.setItem(H(),JSON.stringify(E.value))},R=V(()=>{const fe=y.value.areaIds||[];if(fe.length>0){const W=a.areas.filter(J=>fe.includes(J.id)&&J.peopleTerm).sort((J,re)=>(J.checkpointCount||0)-(re.checkpointCount||0));if(W.length>0)return W[0].peopleTerm}return a.eventPeopleTerm||"Marshals"}),U=V(()=>y.value.peopleTerm?y.value.peopleTerm:R.value),F=V(()=>{const fe=y.value.areaIds||[];if(fe.length>0){const W=a.areas.filter(J=>fe.includes(J.id)&&J.checkpointTerm).sort((J,re)=>(J.checkpointCount||0)-(re.checkpointCount||0));if(W.length>0)return W[0].checkpointTerm}return o.value.checkpoint});V(()=>F.value.toLowerCase());const j=V(()=>{const fe=y.value.checkpointTerm||a.location?.checkpointTerm||a.location?.CheckpointTerm;if(fe)return ui("checkpoint",fe,U.value);const W=y.value.areaIds||[];let J=null;if(W.length>0){const re=a.areas.filter(je=>W.includes(je.id)&&je.checkpointTerm).sort((je,et)=>(je.checkpointCount||0)-(et.checkpointCount||0));re.length>0&&(J=re[0].checkpointTerm)}return J?ui("checkpoint",J,U.value):o.value.checkpoint}),Y=V(()=>j.value.toLowerCase()),oe=V(()=>{const fe=U.value;return ui("people",fe)});V(()=>oe.value.toLowerCase());const Oe=V(()=>o.value.area);V(()=>Oe.value.toLowerCase());const ee=V(()=>o.value.area),te=V(()=>ee.value.toLowerCase()),O=V(()=>o.value.areas),Z=V(()=>!!(a.location&&a.location.id)),ne=V(()=>Z.value?`Edit ${Y.value}: ${a.location?.name||""}`:`Add ${Y.value}`),pe=V(()=>{const fe=[{value:"details",label:"Details",icon:"details"},{value:"location",label:"Location",icon:"location"},{value:"marshals",label:U.value,icon:"marshal"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return a.incidents&&a.incidents.length>0&&fe.push({value:"incidents",label:"Incidents",icon:"incidents"}),fe}),we=V(()=>pe.value.findIndex(fe=>fe.value===i.value)),Ze=V(()=>we.value===pe.value.length-1),Ne=V(()=>{const fe=y.value.areaIds||[],W=a.areas.filter(ht=>fe.includes(ht.id)).sort((ht,Gt)=>(ht.checkpointCount||0)-(Gt.checkpointCount||0)),J=(ht,Gt)=>{for(const pn of W){const Et=ht(pn);if(Et&&Et!=="default")return{value:Et,source:"area"}}return Gt&&Gt!=="default"?{value:Gt,source:"event"}:{value:"",source:"none"}},re=J(ht=>ht.checkpointStyleType||ht.CheckpointStyleType,a.eventDefaultStyleType),je=J(ht=>ht.checkpointStyleColor||ht.CheckpointStyleColor,a.eventDefaultStyleColor),et=J(ht=>ht.checkpointStyleBackgroundShape||ht.CheckpointStyleBackgroundShape,a.eventDefaultStyleBackgroundShape),dt=J(ht=>ht.checkpointStyleBackgroundColor||ht.CheckpointStyleBackgroundColor||ht.checkpointStyleColor||ht.CheckpointStyleColor,a.eventDefaultStyleBackgroundColor||a.eventDefaultStyleColor),kt=J(ht=>ht.checkpointStyleBorderColor||ht.CheckpointStyleBorderColor,a.eventDefaultStyleBorderColor),gt=J(ht=>ht.checkpointStyleIconColor||ht.CheckpointStyleIconColor,a.eventDefaultStyleIconColor),St=J(ht=>ht.checkpointStyleSize||ht.CheckpointStyleSize,a.eventDefaultStyleSize),Lt=J(ht=>ht.checkpointStyleMapRotation??ht.CheckpointStyleMapRotation,a.eventDefaultStyleMapRotation),Vt=[re,et,dt,kt,gt,St,Lt].some(ht=>ht.source==="area");return{type:re.value||"default",color:je.value,backgroundShape:et.value,backgroundColor:dt.value,borderColor:kt.value,iconColor:gt.value,size:St.value,mapRotation:Lt.value,source:Vt?"area":re.value?"event":"none"}}),Ge=V(()=>Ne.value.source==="area"?`${ee.value} default`:"Event default"),Xe=V(()=>{const fe=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:Ne.value.type,W=y.value.styleBackgroundShape||Ne.value.backgroundShape||"circle",J=y.value.styleBackgroundColor||Ne.value.backgroundColor||"#667eea",re=y.value.styleBorderColor||Ne.value.borderColor||"#ffffff",je=y.value.styleIconColor||Ne.value.iconColor||"#ffffff";return Tn({type:fe||"circle",backgroundShape:W,backgroundColor:J,borderColor:re,iconColor:je,size:"100"})}),Q=V(()=>{let fe,W,J,re,je;return Z.value&&a.location?(fe=a.location.resolvedStyleType||a.location.ResolvedStyleType,W=a.location.resolvedStyleBackgroundShape||a.location.ResolvedStyleBackgroundShape||"circle",J=a.location.resolvedStyleBackgroundColor||a.location.ResolvedStyleBackgroundColor||a.location.resolvedStyleColor||a.location.ResolvedStyleColor||"#667eea",re=a.location.resolvedStyleBorderColor||a.location.ResolvedStyleBorderColor||"#ffffff",je=a.location.resolvedStyleIconColor||a.location.ResolvedStyleIconColor||"#ffffff"):(fe=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:Ne.value.type,W=y.value.styleBackgroundShape||Ne.value.backgroundShape||"circle",J=y.value.styleBackgroundColor||Ne.value.backgroundColor||"#667eea",re=y.value.styleBorderColor||Ne.value.borderColor||"#ffffff",je=y.value.styleIconColor||Ne.value.iconColor||"#ffffff"),Tn({type:fe||"circle",backgroundShape:W,backgroundColor:J,borderColor:re,iconColor:je,size:"100",outputSize:28})}),ye=V(()=>{const fe=!!y.value.checkpointTerm,W=!!y.value.peopleTerm;return fe&&W?`${ui("checkpoint",y.value.checkpointTerm,y.value.peopleTerm)}, ${y.value.peopleTerm}`:fe?ui("checkpoint",y.value.checkpointTerm,U.value):W?y.value.peopleTerm:"Using defaults"}),Ce=V(()=>Ze.value?null:pe.value[we.value+1]),me=V(()=>Ce.value?`${Ce.value.label}...`:""),ie=A(!1),z=A(null);We(()=>a.location,fe=>{if(fe){const W=fe.id||"new";if(z.value!==W){z.value=W,ie.value=!0;let J="",re="";fe.startTime&&(J=sr(fe.startTime)),fe.endTime&&(re=sr(fe.endTime)),y.value={id:fe.id||null,name:fe.name||"",description:fe.description||"",what3Words:fe.what3Words||"",latitude:fe.latitude||0,longitude:fe.longitude||0,requiredMarshals:fe.requiredMarshals||1,useCustomTimes:!!(fe.startTime||fe.endTime),startTime:J,endTime:re,areaIds:fe.areaIds||fe.AreaIds||[],styleType:fe.styleType||fe.StyleType||"default",styleColor:fe.styleColor||fe.StyleColor||"",styleBackgroundShape:fe.styleBackgroundShape||fe.StyleBackgroundShape||"",styleBackgroundColor:fe.styleBackgroundColor||fe.StyleBackgroundColor||"",styleBorderColor:fe.styleBorderColor||fe.StyleBorderColor||"",styleIconColor:fe.styleIconColor||fe.StyleIconColor||"",styleSize:fe.styleSize||fe.StyleSize||"",styleMapRotation:fe.styleMapRotation??fe.StyleMapRotation??"",peopleTerm:fe.peopleTerm||"",checkpointTerm:fe.checkpointTerm||"",isDynamic:fe.isDynamic||!1,locationUpdateScopeConfigurations:fe.locationUpdateScopeConfigurations||[]}}}},{immediate:!0,deep:!0}),We(()=>a.show,fe=>{fe?(i.value="details",l.value=!1,h.value=[],f.value=[],m.value=[],u.value?.clearPendingChanges&&u.value.clearPendingChanges(),d.value?.resetLocalState&&d.value.resetLocalState()):(z.value=null,ie.value=!1)});const K=fe=>{y.value=fe},se=()=>{n("update:isDirty",!0)},Ee=()=>{l.value=!l.value,n("move-location",{isMoving:l.value,formData:{...y.value}})},Be=fe=>{h.value=fe,se()},Re=()=>{Ce.value&&(i.value=Ce.value.value)},Se=()=>{const fe={...y.value,startTime:y.value.useCustomTimes&&y.value.startTime?new Date(y.value.startTime).toISOString():null,endTime:y.value.useCustomTimes&&y.value.endTime?new Date(y.value.endTime).toISOString():null,checkInChanges:u.value?.getPendingChanges?.()||[],assignmentsToRemove:u.value?.getMarkedForRemoval?.()||[],checklistChanges:h.value||[],pendingAssignments:a.assignments.filter(W=>W.isPending).map(W=>({marshalId:W.marshalId})),pendingNewChecklistItems:f.value,pendingNewNotes:m.value};n("save",fe)},X=()=>{a.location&&a.location.id&&n("delete",a.location.id)},he=fe=>{n("remove-assignment",fe)},Te=()=>{n("open-assign-modal")},xe=fe=>{n("select-marshal",fe)},be=()=>{n("close")},de=(fe,W)=>{y.value[fe]=W,se()};return(fe,W)=>(v(),Ke(Ht,{show:e.show,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:be},{header:Fe(()=>[r("h2",EP,[Q.value?(v(),g("span",{key:0,class:"modal-title-icon",innerHTML:Q.value},null,8,PP)):D("",!0),Ye(" "+I(ne.value),1)])]),"tab-header":Fe(()=>[Me(fl,{modelValue:i.value,"onUpdate:modelValue":W[0]||(W[0]=J=>i.value=J),tabs:pe.value},null,8,["modelValue","tabs"])]),footer:Fe(()=>[r("div",o5,[r("div",s5,[Z.value&&!e.lockedFromMarshal?(v(),g("button",{key:0,type:"button",onClick:X,class:"btn btn-danger"}," Delete ")):D("",!0),!Z.value&&!Ze.value?(v(),g("button",{key:1,type:"button",onClick:Re,class:"btn btn-secondary mobile-only"},I(me.value),1)):D("",!0)]),r("button",{type:"button",onClick:Se,class:"btn btn-success"}," Save ")])]),default:Fe(()=>[i.value==="details"?(v(),Ke(vE,{key:0,form:y.value,areas:e.areas,"event-date":e.eventDate,"area-term-singular":ee.value,"area-term-plural":O.value,"checkpoint-term-singular":j.value,"people-term-plural":U.value,"onUpdate:form":K,onInput:se,onSave:Se},null,8,["form","areas","event-date","area-term-singular","area-term-plural","checkpoint-term-singular","people-term-plural"])):D("",!0),i.value==="location"?(v(),Ke(_4,{key:1,form:y.value,"is-moving":l.value,"checkpoint-term-singular":j.value,"people-term-plural":U.value,areas:e.areas,locations:e.allLocations,marshals:e.allMarshals,"is-editing":Z.value,"onUpdate:form":K,onInput:se,onSave:Se,onMoveLocation:Ee},null,8,["form","is-moving","checkpoint-term-singular","people-term-plural","areas","locations","marshals","is-editing"])):D("",!0),i.value==="marshals"?(v(),Ke(j4,{key:2,ref_key:"assignmentsTabRef",ref:u,form:y.value,assignments:e.assignments,"people-term":U.value,"person-term":oe.value,"checkpoint-term":j.value,"read-only":e.lockedFromMarshal,"onUpdate:form":K,onInput:se,onRemoveAssignment:he,onOpenAssignModal:Te,onSelectMarshal:xe,onDistanceClick:S},null,8,["form","assignments","people-term","person-term","checkpoint-term","read-only"])):D("",!0),i.value==="checklists"&&Z.value?(v(),Ke(_g,{key:3,ref_key:"checklistTabRef",ref:d,modelValue:h.value,"onUpdate:modelValue":W[1]||(W[1]=J=>h.value=J),"event-id":e.eventId,"location-id":e.location.id,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals,onChange:Be},null,8,["modelValue","event-id","location-id","locations","areas","assignments","marshals"])):D("",!0),i.value==="checklists"?(v(),Ke(cP,{key:4,modelValue:f.value,"onUpdate:modelValue":W[2]||(W[2]=J=>f.value=J),"all-checklist-items":e.allChecklistItems,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":Z.value,"checkpoint-term-singular":j.value,onChange:se},null,8,["modelValue","all-checklist-items","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):D("",!0),i.value==="notes"&&Z.value?(v(),Ke(Rc,{key:5,"event-id":e.eventId,"location-id":e.location?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals},null,8,["event-id","location-id","all-notes","locations","areas","assignments","marshals"])):D("",!0),i.value==="notes"?(v(),Ke(AP,{key:6,modelValue:m.value,"onUpdate:modelValue":W[3]||(W[3]=J=>m.value=J),"all-notes":e.notes,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":Z.value,"checkpoint-term-singular":j.value,onChange:se},null,8,["modelValue","all-notes","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):D("",!0),i.value==="appearance"?(v(),g("div",DP,[r("div",RP,[r("button",{type:"button",class:ve(["accordion-header",{expanded:E.value.iconStyle}]),onClick:W[4]||(W[4]=J=>B("iconStyle"))},[r("div",{class:"accordion-icon",innerHTML:Xe.value},null,8,OP),r("span",BP,I(j.value)+" marker style",1),r("span",NP,I(E.value.iconStyle?"":""),1)],2),E.value.iconStyle?(v(),g("div",FP,[r("p",UP," Choose a custom icon for this "+I(Y.value)+", or leave as Default to inherit from "+I(te.value)+" or event settings. ",1),Me(Gd,{"style-type":y.value.styleType||"default","style-color":y.value.styleColor||"","style-background-shape":y.value.styleBackgroundShape||"","style-background-color":y.value.styleBackgroundColor||"","style-border-color":y.value.styleBorderColor||"","style-icon-color":y.value.styleIconColor||"","style-size":y.value.styleSize||"","style-map-rotation":y.value.styleMapRotation??"","inherited-style-type":Ne.value.type,"inherited-style-color":Ne.value.color,"inherited-background-shape":Ne.value.backgroundShape||"","inherited-background-color":Ne.value.backgroundColor||Ne.value.color||"","inherited-border-color":Ne.value.borderColor||"","inherited-icon-color":Ne.value.iconColor||"","inherited-size":Ne.value.size||"","inherited-map-rotation":Ne.value.mapRotation??"","default-label":Ge.value,"icon-label":"Marker style",level:"checkpoint","show-preview":!0,"onUpdate:styleType":W[5]||(W[5]=J=>de("styleType",J)),"onUpdate:styleColor":W[6]||(W[6]=J=>de("styleColor",J)),"onUpdate:styleBackgroundShape":W[7]||(W[7]=J=>de("styleBackgroundShape",J)),"onUpdate:styleBackgroundColor":W[8]||(W[8]=J=>de("styleBackgroundColor",J)),"onUpdate:styleBorderColor":W[9]||(W[9]=J=>de("styleBorderColor",J)),"onUpdate:styleIconColor":W[10]||(W[10]=J=>de("styleIconColor",J)),"onUpdate:styleSize":W[11]||(W[11]=J=>de("styleSize",J)),"onUpdate:styleMapRotation":W[12]||(W[12]=J=>de("styleMapRotation",J))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation","default-label"])])):D("",!0)]),r("div",zP,[r("button",{type:"button",class:ve(["accordion-header",{expanded:E.value.terminology}]),onClick:W[13]||(W[13]=J=>B("terminology"))},[W[17]||(W[17]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("circle",{cx:"9",cy:"8",r:"3",fill:"#6366F1"}),r("path",{d:"M3 18c0-3.3 2.7-6 6-6s6 2.7 6 6",fill:"#6366F1",opacity:"0.5"}),r("circle",{cx:"17",cy:"14",r:"5",fill:"#10B981",opacity:"0.3"}),r("circle",{cx:"17",cy:"14",r:"3",fill:"#10B981"}),r("circle",{cx:"17",cy:"14",r:"1",fill:"white"})])],-1)),W[18]||(W[18]=r("span",{class:"accordion-title"},"Terminology",-1)),r("span",HP,I(ye.value),1),r("span",VP,I(E.value.terminology?"":""),1)],2),E.value.terminology?(v(),g("div",GP,[r("p",qP," Customise what this "+I(Y.value)+" and its "+I(U.value.toLowerCase())+" are called. ",1),r("div",jP,[r("div",ZP,[r("label",null,"What is this "+I(Y.value)+" called?",1),r("select",{value:y.value.checkpointTerm,class:"form-input",onChange:W[14]||(W[14]=J=>{K({...y.value,checkpointTerm:J.target.value}),se()})},[r("option",KP,"Use "+I(te.value)+" default ("+I(j.value)+")",1),W[19]||(W[19]=r("option",{value:"Vehicle"},"Vehicle",-1)),W[20]||(W[20]=r("option",{value:"Car"},"Car",-1)),W[21]||(W[21]=r("option",{value:"Bike"},"Bike",-1)),(v(!0),g(Ae,null,Ue(N(Us).checkpoint,J=>(v(),g("option",{key:J,value:J},I(J),9,JP))),128))],40,WP)]),r("div",YP,[r("label",null,"What are "+I(U.value.toLowerCase())+" called here?",1),r("select",{value:y.value.peopleTerm,class:"form-input",onChange:W[15]||(W[15]=J=>{K({...y.value,peopleTerm:J.target.value}),se()})},[r("option",QP,"Use "+I(te.value)+" default ("+I(R.value)+")",1),(v(!0),g(Ae,null,Ue(N(Us).people,J=>(v(),g("option",{key:J,value:J},I(J),9,e5))),128))],40,XP)])])])):D("",!0)])])):D("",!0),i.value==="incidents"?(v(),g("div",t5,[r("div",n5,[(v(!0),g(Ae,null,Ue(e.incidents,J=>(v(),Ke(vr,{key:J.incidentId,incident:J,onSelect:W[16]||(W[16]=re=>fe.$emit("select-incident",re))},null,8,["incident"]))),128))])])):D("",!0),Me(Vd,{show:k.value,"marshal-name":x.value,"checkpoint-name":C.value,"check-in-location":_.value,"checkpoint-location":$.value,distance:M.value,"z-index":e.zIndex+100,onClose:T},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance","z-index"])]),_:1},8,["show","is-dirty","z-index"]))}},i5=He(a5,[["__scopeId","data-v-4058e569"]]),l5={class:"tab-content"},r5={key:0,class:"error-banner"},c5=["value"],u5={key:0,class:"field-error"},d5={class:"contact-row"},h5=["value"],f5={key:0,class:"field-error"},p5=["value"],v5={key:0,class:"field-error"},m5=["value"],g5={key:0,class:"field-error"},y5={key:1,class:"magic-link-section"},k5={key:0,class:"loading-text"},b5={key:1,class:"magic-link-container"},_5={class:"magic-link-row"},w5=["value"],C5={key:0,class:"error-text"},L5={key:1,class:"magic-link-actions"},S5=["disabled"],I5={key:2,class:"success-text"},x5={key:3,class:"error-text"},$5={key:2,class:"error-text"},T5={__name:"MarshalDetailsTab",props:{form:{type:Object,required:!0},eventId:{type:String,default:null},marshalId:{type:String,default:null},validationErrors:{type:Object,default:()=>({})}},emits:["update:form","input"],setup(e,{expose:t,emit:o}){const a=e,n=o,i=A(null),l=A(null),u=A(null),d=A(null),h=A(""),f=A(!1),m=A(!1),y=A(""),k=A(!1),w=A(!1),S=A(!1),T=A(""),x=A(!1),C=(B,R)=>{n("update:form",{...a.form,[B]:R}),n("input")},_=async()=>{if(!(!a.eventId||!a.marshalId)){m.value=!0,y.value="";try{const B=await gs.getMagicLink(a.eventId,a.marshalId);h.value=B.data.magicLink,f.value=B.data.hasEmail}catch(B){console.error("Failed to fetch magic link:",B),y.value="Failed to load login link"}finally{m.value=!1}}},$=A(""),M=async()=>{$.value="";try{if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(h.value),k.value=!0,setTimeout(()=>{k.value=!1},2e3);return}}catch(B){console.warn("Clipboard API failed, trying fallback:",B)}try{const B=document.createElement("textarea");B.value=h.value,B.style.position="fixed",B.style.left="-9999px",B.style.top="0",document.body.appendChild(B),B.focus(),B.select();const R=document.execCommand("copy");document.body.removeChild(B),R?(k.value=!0,setTimeout(()=>{k.value=!1},2e3)):($.value="Copy failed. Please select and copy the link manually.",setTimeout(()=>{$.value=""},4e3))}catch(B){console.error("Fallback copy failed:",B),$.value="Copy not supported. Please select and copy the link manually.",setTimeout(()=>{$.value=""},4e3)}},H=async()=>{if(!(!a.eventId||!a.marshalId)){w.value=!0,S.value=!1,T.value="";try{await gs.sendMagicLink(a.eventId,a.marshalId),S.value=!0,setTimeout(()=>{S.value=!1},3e3)}catch(B){console.error("Failed to send email:",B),T.value=B.response?.data?.message||"Failed to send email"}finally{w.value=!1}}};return We(()=>a.marshalId,B=>{B?_():(h.value="",f.value=!1)},{immediate:!0}),t({focusField:B=>{cn(()=>{const U={name:i,email:l,phoneNumber:u,notes:d}[B];U?.value&&(U.value.focus(),U.value.scrollIntoView({behavior:"smooth",block:"center"}))})}}),(B,R)=>(v(),g("div",l5,[e.validationErrors.general?(v(),g("div",r5,I(e.validationErrors.general),1)):D("",!0),r("div",{class:ve(["form-group",{"has-error":e.validationErrors.name}])},[R[7]||(R[7]=r("label",null,"Name *",-1)),r("input",{ref_key:"nameInputRef",ref:i,value:e.form.name,onInput:R[0]||(R[0]=U=>C("name",U.target.value)),type:"text",required:"",class:ve(["form-input",{"input-error":e.validationErrors.name}])},null,42,c5),e.validationErrors.name?(v(),g("span",u5,I(e.validationErrors.name),1)):D("",!0)],2),r("div",d5,[r("div",{class:ve(["form-group contact-email",{"has-error":e.validationErrors.email}])},[R[8]||(R[8]=r("label",null,"Email",-1)),r("input",{ref_key:"emailInputRef",ref:l,value:e.form.email,onInput:R[1]||(R[1]=U=>C("email",U.target.value)),type:"email",class:ve(["form-input",{"input-error":e.validationErrors.email}])},null,42,h5),e.validationErrors.email?(v(),g("span",f5,I(e.validationErrors.email),1)):D("",!0)],2),r("div",{class:ve(["form-group contact-phone",{"has-error":e.validationErrors.phoneNumber}])},[R[9]||(R[9]=r("label",null,"Phone number",-1)),r("input",{ref_key:"phoneInputRef",ref:u,value:e.form.phoneNumber,onInput:R[2]||(R[2]=U=>C("phoneNumber",U.target.value)),type:"tel",class:ve(["form-input",{"input-error":e.validationErrors.phoneNumber}])},null,42,p5),e.validationErrors.phoneNumber?(v(),g("span",v5,I(e.validationErrors.phoneNumber),1)):D("",!0)],2)]),r("div",{class:ve(["form-group",{"has-error":e.validationErrors.notes}])},[R[10]||(R[10]=r("label",null,"Notes",-1)),r("textarea",{ref_key:"notesInputRef",ref:d,value:e.form.notes,onInput:R[3]||(R[3]=U=>C("notes",U.target.value)),class:ve(["form-input",{"input-error":e.validationErrors.notes}]),rows:"3",placeholder:"e.g., Needs to leave by 11am"},null,42,m5),e.validationErrors.notes?(v(),g("span",g5,I(e.validationErrors.notes),1)):D("",!0)],2),e.marshalId?(v(),g("div",y5,[R[12]||(R[12]=r("label",null,"Login link",-1)),R[13]||(R[13]=r("p",{class:"help-text"},"Share this unique link with the marshal so they can access their dashboard.",-1)),m.value?(v(),g("div",k5,"Loading link...")):h.value?(v(),g("div",b5,[r("div",_5,[r("input",{type:"text",value:h.value,readonly:"",class:"form-input magic-link-input",onFocus:R[4]||(R[4]=U=>U.target.select())},null,40,w5),r("button",{type:"button",class:"btn btn-secondary",onClick:M},I(k.value?"Copied!":"Copy link"),1),r("button",{type:"button",class:"btn btn-secondary",onClick:R[5]||(R[5]=U=>x.value=!0),title:"Show QR code"},[...R[11]||(R[11]=[Ql('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-0a65e333><rect x="3" y="3" width="7" height="7" data-v-0a65e333></rect><rect x="14" y="3" width="7" height="7" data-v-0a65e333></rect><rect x="3" y="14" width="7" height="7" data-v-0a65e333></rect><rect x="14" y="14" width="3" height="3" data-v-0a65e333></rect><rect x="19" y="14" width="2" height="2" data-v-0a65e333></rect><rect x="14" y="19" width="2" height="2" data-v-0a65e333></rect><rect x="19" y="19" width="2" height="2" data-v-0a65e333></rect></svg>',1)])])]),$.value?(v(),g("p",C5,I($.value),1)):D("",!0),f.value?(v(),g("div",L5,[r("button",{type:"button",class:"btn btn-primary",disabled:w.value,onClick:H},I(w.value?"Sending...":"Send via email"),9,S5)])):D("",!0),S.value?(v(),g("p",I5,"Email sent successfully!")):D("",!0),T.value?(v(),g("p",x5,I(T.value),1)):D("",!0)])):y.value?(v(),g("div",$5,I(y.value),1)):D("",!0)])):D("",!0),Me(kg,{show:x.value,url:h.value,title:"Scan to log in",onClose:R[6]||(R[6]=U=>x.value=!1)},null,8,["show","url"])]))}},M5=He(T5,[["__scopeId","data-v-0a65e333"]]),A5={class:"card-header"},E5={class:"checkpoint-name-row"},P5=["innerHTML"],D5={class:"checkpoint-name"},R5={key:0,class:"checkpoint-description"},O5={key:0,class:"card-areas"},B5={key:1,class:"card-check-in"},N5={key:0,class:"check-in-time"},F5={key:0,class:"check-in-method"},U5={key:1,class:"unsaved-indicator"},z5={key:2,class:"card-locked"},H5={class:"locked-badge"},V5={key:3,class:"card-badge"},G5={key:4,class:"card-badge"},q5={__name:"MarshalCheckpointCard",props:{assignment:{type:Object,required:!0},location:{type:Object,default:null},areas:{type:Array,default:()=>[]},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isLocked:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1}},emits:["click","toggle-check-in","remove","undo-remove","distance-click"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,n=t,i=V(()=>a.location?a.location.areaIds||a.location.AreaIds||[]:[]),l=V(()=>i.value.map(x=>{const C=a.areas.find(_=>_.id===x);return C?C.name:null}).filter(Boolean)),u=V(()=>i.value.map(x=>{const C=a.areas.find(_=>_.id===x);return C?C.color:"#999"})),d=V(()=>{if(!a.location)return"#667eea";const x=a.location,C=x.resolvedStyleBackgroundColor||x.ResolvedStyleBackgroundColor||x.resolvedStyleColor||x.ResolvedStyleColor;if(C)return C;if(i.value.length>0){const _=a.areas.find($=>$.id===i.value[0]);if(_)return _.color}return"#667eea"}),h=V(()=>{if(!a.location)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
    </svg>`;const x=a.location,C=x.resolvedStyleType||x.ResolvedStyleType,_=x.resolvedStyleBackgroundColor||x.ResolvedStyleBackgroundColor||x.resolvedStyleColor||x.ResolvedStyleColor,$=x.resolvedStyleBorderColor||x.ResolvedStyleBorderColor,M=x.resolvedStyleIconColor||x.ResolvedStyleIconColor,H=x.resolvedStyleBackgroundShape||x.ResolvedStyleBackgroundShape;return C&&C!=="default"||_||$||M||H&&H!=="circle"?Tn({type:C||"circle",backgroundShape:H||"circle",backgroundColor:_||"#667eea",borderColor:$||"#ffffff",iconColor:M||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),f=x=>x?new Date(x).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",m=V(()=>{const{checkedInBy:x,checkInMethod:C,marshalName:_}=a.assignment;return x&&x!==_?x:C||""}),y=V(()=>{const{checkInLatitude:x,checkInLongitude:C}=a.assignment,_=a.location;return!x||!C||!_?.latitude||!_?.longitude?null:_i(x,C,_.latitude,_.longitude)}),k=V(()=>y.value===null?null:y.value<1e3?`${Math.round(y.value)} m`:`${(y.value/1e3).toFixed(2)} km`),w=V(()=>y.value===null?"":y.value<=50?"distance-close":y.value<=100?"distance-medium":"distance-far"),S=()=>{!a.assignment.isPending&&!a.isMarkedForRemoval&&!a.isLocked&&n("click",a.assignment)},T=()=>{n("distance-click",a.assignment)};return(x,C)=>(v(),g("div",{class:ve(["marshal-checkpoint-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-locked":e.isLocked}]),style:Qe({borderLeftColor:e.isMarkedForRemoval?void 0:d.value})},[r("div",A5,[r("div",{class:"card-title",onClick:S},[r("span",E5,[r("span",{class:"checkpoint-icon",innerHTML:h.value},null,8,P5),r("span",D5,I(e.assignment.locationName),1),e.assignment.locationDescription?(v(),g("span",R5,"  "+I(e.assignment.locationDescription),1)):D("",!0)])]),!e.isLocked&&!e.isMarkedForRemoval?(v(),g("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:C[0]||(C[0]=lt(_=>x.$emit("remove",e.assignment),["stop"]))},"  ")):D("",!0),e.isMarkedForRemoval?(v(),g("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:C[1]||(C[1]=lt(_=>x.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):D("",!0)]),l.value.length>0&&!e.isMarkedForRemoval?(v(),g("div",O5,[(v(!0),g(Ae,null,Ue(l.value,(_,$)=>(v(),g("span",{key:$,class:"area-badge",style:Qe({backgroundColor:u.value[$]})},I(_),5))),128))])):D("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.isLocked?(v(),g("div",B5,[r("button",{class:ve(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:C[2]||(C[2]=_=>x.$emit("toggle-check-in",e.assignment))},[...C[3]||(C[3]=[r("span",{class:"toggle-icon"},"",-1),r("span",{class:"toggle-label-wrapper"},[r("span",{class:"toggle-label toggle-label-check-in"},"Check in"),r("span",{class:"toggle-label toggle-label-checked-in"},"Checked in")],-1)])],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(v(),g("span",N5,[Ye(I(f(e.assignment.checkInTime))+" ",1),m.value?(v(),g("span",F5,"("+I(m.value)+")",1)):D("",!0),k.value?(v(),g("span",{key:1,class:ve(["check-in-distance",w.value]),onClick:lt(T,["stop"])},I(k.value),3)):D("",!0)])):e.hasUnsavedChanges?(v(),g("span",U5," Unsaved ")):D("",!0)])):D("",!0),e.isLocked&&!e.isMarkedForRemoval?(v(),g("div",z5,[r("span",H5,"Viewing from this "+I(N(o).checkpoint),1)])):D("",!0),e.assignment.isPending?(v(),g("div",V5,[...C[4]||(C[4]=[r("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):D("",!0),e.isMarkedForRemoval?(v(),g("div",G5,[...C[5]||(C[5]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):D("",!0)],6))}},j5=He(q5,[["__scopeId","data-v-d3de6925"]]),Z5={class:"tab-content"},W5={key:0,class:"read-only-notice"},K5={class:"section-title"},J5={key:1,class:"form-group",style:{"margin-top":"1.5rem"}},Y5={value:""},X5=["value"],Q5={__name:"MarshalCheckpointsTab",props:{assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isNewMarshal:{type:Boolean,default:!1},lockedCheckpointId:{type:String,default:null}},emits:["input","remove-assignment","assign-to-location","select-checkpoint","distance-click"],setup(e,{expose:t,emit:o}){const{termsLower:a}=ct(),n=e,i=o,{pendingCheckInChanges:l,getEffectiveCheckInStatus:u,handleToggleCheckIn:d}=bg(()=>i("input")),h=A(""),f=A(new Set),m=V(()=>n.assignments?.length||0),y=U=>n.allLocations&&n.allLocations.find(F=>F.id===U)||null,k=V(()=>[...n.assignments].sort((U,F)=>(U.locationName||"").localeCompare(F.locationName||"",void 0,{numeric:!0,sensitivity:"base"}))),w=U=>f.value.has(U),S=U=>{U.isPending||i("select-checkpoint",U)},T=A(!1),x=A(null),C=U=>{u(U)?(x.value=U,T.value=!0):d(U)},_=()=>{x.value&&d(x.value),T.value=!1,x.value=null},$=()=>{T.value=!1,x.value=null},M=V(()=>x.value?`Are you sure you want to undo ${x.value.marshalName||"this marshal"}'s check-in?`:""),H=U=>{U.isPending?i("remove-assignment",U):(f.value.add(U.id),i("input"))},E=U=>{f.value.delete(U.id),i("input")},B=V(()=>{const U=[...n.availableLocations];return U.sort((F,j)=>F.name.localeCompare(j.name,void 0,{numeric:!0,sensitivity:"base"})),U}),R=()=>{h.value&&(i("assign-to-location",h.value),h.value="")};return t({pendingCheckInChanges:l,clearPendingChanges:()=>{l.value.clear(),f.value.clear(),h.value=""},getPendingChanges:()=>Array.from(l.value.entries()).map(([U,F])=>({assignmentId:U,shouldBeCheckedIn:F})),getMarkedForRemoval:()=>Array.from(f.value)}),(U,F)=>(v(),g("div",Z5,[e.lockedCheckpointId?(v(),g("div",W5," Viewing from "+I(N(a).checkpoint)+" - "+I(N(a).checkpoints)+" cannot be modified here. ",1)):D("",!0),r("h3",K5,"Assigned "+I(N(a).checkpoints)+" ("+I(m.value)+")",1),Me(pr,{"is-empty":e.assignments.length===0,"empty-message":`No ${N(a).checkpoints} assigned yet.`,"empty-hint":e.lockedCheckpointId?"":`Use the dropdown below to assign this ${N(a).person} to ${N(a).checkpoints}.`},{default:Fe(()=>[(v(!0),g(Ae,null,Ue(k.value,j=>(v(),Ke(j5,{key:j.id,assignment:j,location:y(j.locationId),areas:e.areas,"effective-check-in-status":N(u)(j),"has-unsaved-changes":N(l).has(j.id),"is-locked":!!e.lockedCheckpointId,"is-marked-for-removal":w(j.id),onClick:S,onToggleCheckIn:C,onRemove:H,onUndoRemove:E,onDistanceClick:F[0]||(F[0]=Y=>U.$emit("distance-click",Y))},null,8,["assignment","location","areas","effective-check-in-status","has-unsaved-changes","is-locked","is-marked-for-removal"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),!e.lockedCheckpointId&&B.value.length>0?(v(),g("div",J5,[r("label",null,"Assign to "+I(N(a).checkpoint),1),ze(r("select",{"onUpdate:modelValue":F[1]||(F[1]=j=>h.value=j),class:"form-input",onChange:R},[r("option",Y5,"Select a "+I(N(a).checkpoint)+"...",1),(v(!0),g(Ae,null,Ue(B.value,j=>(v(),g("option",{key:j.id,value:j.id},[Ye(I(j.name),1),j.description?(v(),g(Ae,{key:0},[Ye(" - "+I(j.description),1)],64)):D("",!0)],8,X5))),128))],544),[[zn,h.value]])])):D("",!0),Me(Da,{show:T.value,title:"Confirm check-out",message:M.value,"confirm-text":"Check out","is-danger":!0,onConfirm:_,onCancel:$},null,8,["show","message"])]))}},e6=He(Q5,[["__scopeId","data-v-07754949"]]),t6={class:"marshal-checklist-view"},n6={key:0,class:"loading-state"},o6={key:1,class:"error-state"},s6={key:2,class:"empty-state"},a6={__name:"MarshalChecklistView",props:{eventId:{type:String,required:!0},marshalId:{type:String,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{termsLower:a}=ct(),n=e,i=o,l=A([]),u=A(!1),d=A(null),h=A(new Map),f=V(()=>l.value.map(S=>{const T=h.value.get(S.itemId),x=T!==void 0?T.complete:S.isCompleted,C=T!==void 0&&T.complete!==S.isCompleted;return{...S,localIsCompleted:x,isModified:C}})),m=async()=>{if(!(!n.eventId||!n.marshalId)){u.value=!0,d.value=null;try{const S=await Ut.getMarshalChecklist(n.eventId,n.marshalId);if(l.value=S.data||[],n.modelValue&&n.modelValue.length>0){const T=new Map;n.modelValue.forEach(x=>{T.set(x.itemId,{complete:x.complete,contextType:x.contextType,contextId:x.contextId})}),h.value=T}}catch(S){console.error("Failed to load checklist:",S),d.value=S.response?.data?.message||"Failed to load checklist"}finally{u.value=!1}}},y=S=>{const T=h.value.get(S.itemId),x=T!==void 0?T.complete:S.isCompleted;h.value.set(S.itemId,{complete:!x,contextType:S.completionContextType,contextId:S.completionContextId}),k()},k=()=>{const S=[];for(const[T,x]of h.value.entries()){const C=l.value.find(_=>_.itemId===T);C&&x.complete!==C.isCompleted&&S.push({itemId:T,complete:x.complete,contextType:x.contextType,contextId:x.contextId})}i("update:modelValue",S),i("change",S)};return t({resetLocalState:()=>{if(h.value=new Map,n.modelValue&&n.modelValue.length>0){const S=new Map;n.modelValue.forEach(T=>{S.set(T.itemId,{complete:T.complete,contextType:T.contextType,contextId:T.contextId})}),h.value=S}},loadChecklist:m}),We(()=>[n.eventId,n.marshalId],()=>{m()},{immediate:!0}),(S,T)=>(v(),g("div",t6,[u.value?(v(),g("div",n6," Loading checklist... ")):d.value?(v(),g("div",o6,[r("p",null,I(d.value),1),r("button",{onClick:m,class:"btn btn-secondary btn-small"}," Retry ")])):l.value.length===0?(v(),g("div",s6,[r("p",null,"No checklist items for this "+I(N(a).person)+".",1)])):(v(),Ke(jd,{key:3,items:f.value,locations:e.locations,areas:e.areas,onToggleComplete:y},null,8,["items","locations","areas"]))]))}},i6=He(a6,[["__scopeId","data-v-7460304c"]]),l6={class:"checklist-preview"},r6={class:"preview-actions"},c6={class:"preview-header"},u6={key:0,class:"add-item-form"},d6=["placeholder"],h6=["disabled"],f6={key:1,class:"pending-items"},p6={class:"item-content"},v6={class:"item-header"},m6={class:"item-text"},g6={class:"item-scope"},y6=["onClick"],k6={key:2,class:"empty-state"},b6={key:0,class:"help-text"},_6={key:3,class:"checklist-items"},w6={class:"item-content"},C6={class:"item-header"},L6={class:"item-text"},S6={class:"item-scope"},I6=["title"],x6={key:0,class:"item-context"},$6={__name:"ChecklistPreview",props:{allChecklistItems:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,n=t,i=A(!1),l=A(""),u=A([...a.modelValue]);We(()=>a.modelValue,C=>{u.value=[...C]},{deep:!0});const d=()=>{l.value.trim()&&(u.value.push({text:l.value.trim(),isNew:!0}),l.value="",i.value=!1,f())},h=C=>{u.value.splice(C,1),f()},f=()=>{n("update:modelValue",[...u.value]),n("change")},m=V(()=>{const C=new Set;for(const _ of a.pendingLocationIds){const $=a.allLocations.find(M=>M.id===_);$&&($.areaIds||$.AreaIds||[]).forEach(H=>C.add(H))}return[...C]}),y=C=>{const _=C.scope,$=C.itemType,M=C.ids||[];return _==="SpecificPeople"&&$==="Marshal"?M.includes("ALL_MARSHALS"):(_==="EveryoneAtCheckpoints"||_==="OnePerCheckpoint")&&$==="Checkpoint"?M.includes("ALL_CHECKPOINTS")?!0:M.some(H=>a.pendingLocationIds.includes(H)):_==="OnePerCheckpoint"&&$==="Area"?M.includes("ALL_AREAS")?!0:M.some(H=>m.value.includes(H)):(_==="EveryoneInAreas"||_==="OnePerArea"||_==="EveryAreaLead"||_==="OneLeadPerArea")&&$==="Area"?M.includes("ALL_AREAS")?!0:M.some(H=>m.value.includes(H)):!1},k=V(()=>a.allChecklistItems.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(_=>y(_)):!1)),w=C=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,EveryoneInAreas:`All in ${o.value.areas}`,OnePerArea:`One per ${o.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${o.value.area}`})[C]||C,S=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const _=C.scopeConfigurations.find(M=>y(M));if(!_)return w(C.scopeConfigurations[0].scope);const $=_.ids||[];return $.includes("ALL_MARSHALS")?"Everyone":$.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:$.includes("ALL_AREAS")?`All ${o.value.areas}`:w(_.scope)},T=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const _=C.scopeConfigurations.find(M=>y(M));return _&&{SpecificPeople:"This item is for everyone at the event",EveryoneAtCheckpoints:`This item is for everyone at specified ${o.value.checkpoints}`,OnePerCheckpoint:`One person at each ${o.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${o.value.areas}`,OnePerArea:`One person in each ${o.value.area} needs to complete this`,EveryAreaLead:`This item is for ${o.value.area} leads only`,OneLeadPerArea:`One ${o.value.area} lead needs to complete this`}[_.scope]||""},x=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const _=C.scopeConfigurations.find(H=>y(H));if(!_)return null;const $=_.itemType,M=_.ids||[];if(M.includes("ALL_MARSHALS")||M.includes("ALL_CHECKPOINTS")||M.includes("ALL_AREAS"))return null;if($==="Checkpoint"){const H=a.allLocations.filter(E=>M.includes(E.id)&&a.pendingLocationIds.includes(E.id)).map(E=>E.name);if(H.length>0)return`At: ${H.join(", ")}`}if($==="Area"){const H=a.areas.filter(E=>M.includes(E.id)&&m.value.includes(E.id)).map(E=>E.name);if(H.length>0)return`In: ${H.join(", ")}`}return null};return(C,_)=>(v(),g("div",l6,[r("div",r6,[r("p",c6,I(e.isEditing?`Add new ${N(o).checklist} for this ${N(o).person}:`:`${N(o).checklists} that will apply to this ${N(o).person}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:_[0]||(_[0]=$=>i.value=!i.value)},I(i.value?"Cancel":`Add ${N(o).checklist}`),1)]),i.value?(v(),g("div",u6,[ze(r("input",{"onUpdate:modelValue":_[1]||(_[1]=$=>l.value=$),type:"text",placeholder:`Enter ${N(o).checklist} text...`,class:"add-item-input",onKeyup:To(d,["enter"])},null,40,d6),[[nt,l.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim(),onClick:d}," Add ",8,h6)])):D("",!0),u.value.length>0?(v(),g("div",f6,[(v(!0),g(Ae,null,Ue(u.value,($,M)=>(v(),g("div",{key:`pending-${M}`,class:"checklist-item pending"},[_[3]||(_[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",p6,[r("div",v6,[r("div",m6,I($.text),1),r("div",g6,[_[2]||(_[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:H=>h(M),title:"Remove"},"  ",8,y6)])])])]))),128))])):D("",!0),!e.isEditing&&k.value.length===0&&u.value.length===0?(v(),g("div",k6,[r("p",null,"No "+I(N(o).checklists)+" will apply based on the current "+I(N(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),g("p",b6," Assign "+I(N(o).checkpoints)+" to see relevant "+I(N(o).checklists)+". ",1)):D("",!0)])):D("",!0),!e.isEditing&&k.value.length>0?(v(),g("div",_6,[(v(!0),g(Ae,null,Ue(k.value,$=>(v(),g("div",{key:$.id,class:"checklist-item"},[_[4]||(_[4]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",w6,[r("div",C6,[r("div",L6,I($.text),1),r("div",S6,[r("span",{class:"scope-pill",title:T($)},I(S($)),9,I6)])]),x($)?(v(),g("div",x6,I(x($)),1)):D("",!0)])]))),128))])):D("",!0)]))}},T6=He($6,[["__scopeId","data-v-6deaacc2"]]),M6={class:"notes-preview"},A6={class:"preview-actions"},E6={class:"preview-header"},P6={key:0,class:"add-item-form"},D6={class:"add-form-fields"},R6=["disabled"],O6={key:1,class:"pending-items"},B6={class:"note-header"},N6={class:"note-title"},F6={class:"note-actions"},U6=["onClick"],z6={key:0,class:"note-content"},H6={key:2,class:"empty-state"},V6={key:0,class:"help-text"},G6={key:3,class:"notes-list"},q6={class:"note-header"},j6={class:"note-title"},Z6=["title"],W6={key:0,class:"note-content"},K6={key:1,class:"note-context"},J6={__name:"NotesPreview",props:{allNotes:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,n=t,i=A(!1),l=A(""),u=A(""),d=A([...a.modelValue]);We(()=>a.modelValue,_=>{d.value=[..._]},{deep:!0});const h=()=>{!l.value.trim()&&!u.value.trim()||(d.value.push({title:l.value.trim(),content:u.value.trim(),isNew:!0}),l.value="",u.value="",i.value=!1,m())},f=_=>{d.value.splice(_,1),m()},m=()=>{n("update:modelValue",[...d.value]),n("change")},y=V(()=>{const _=new Set;for(const $ of a.pendingLocationIds){const M=a.allLocations.find(H=>H.id===$);M&&(M.areaIds||M.AreaIds||[]).forEach(E=>_.add(E))}return[..._]}),k=_=>{const $=_.scope,M=_.itemType,H=_.ids||[];return $==="SpecificPeople"&&M==="Marshal"?H.includes("ALL_MARSHALS"):$==="EveryoneAtCheckpoints"&&M==="Checkpoint"?H.includes("ALL_CHECKPOINTS")?!0:H.some(E=>a.pendingLocationIds.includes(E)):$==="EveryoneInAreas"&&M==="Area"?H.includes("ALL_AREAS")?!0:H.some(E=>y.value.includes(E)):!1},w=V(()=>a.allNotes.filter(_=>_.scopeConfigurations&&_.scopeConfigurations.length>0?_.scopeConfigurations.some($=>k($)):!1)),S=_=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[_]||_,T=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"Unknown";const $=_.scopeConfigurations.find(H=>k(H));if(!$)return S(_.scopeConfigurations[0].scope);const M=$.ids||[];return M.includes("ALL_MARSHALS")?"Everyone":M.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:M.includes("ALL_AREAS")?`All ${o.value.areas}`:S($.scope)},x=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"";const $=_.scopeConfigurations.find(H=>k(H));return $&&{SpecificPeople:"This note is for everyone at the event",EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[$.scope]||""},C=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return null;const $=_.scopeConfigurations.find(E=>k(E));if(!$)return null;const M=$.itemType,H=$.ids||[];if(H.includes("ALL_MARSHALS")||H.includes("ALL_CHECKPOINTS")||H.includes("ALL_AREAS"))return null;if(M==="Checkpoint"){const E=a.allLocations.filter(B=>H.includes(B.id)&&a.pendingLocationIds.includes(B.id)).map(B=>B.name);if(E.length>0)return`At: ${E.join(", ")}`}if(M==="Area"){const E=a.areas.filter(B=>H.includes(B.id)&&y.value.includes(B.id)).map(B=>B.name);if(E.length>0)return`In: ${E.join(", ")}`}return null};return(_,$)=>(v(),g("div",M6,[r("div",A6,[r("p",E6,I(e.isEditing?`Add new note for this ${N(o).person}:`:`Notes that will be visible to this ${N(o).person}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:$[0]||($[0]=M=>i.value=!i.value)},I(i.value?"Cancel":"Add note"),1)]),i.value?(v(),g("div",P6,[r("div",D6,[ze(r("input",{"onUpdate:modelValue":$[1]||($[1]=M=>l.value=M),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[nt,l.value]]),ze(r("textarea",{"onUpdate:modelValue":$[2]||($[2]=M=>u.value=M),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[nt,u.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim()&&!u.value.trim(),onClick:h}," Add ",8,R6)])):D("",!0),d.value.length>0?(v(),g("div",O6,[(v(!0),g(Ae,null,Ue(d.value,(M,H)=>(v(),g("div",{key:`pending-${H}`,class:"note-item pending"},[r("div",B6,[r("span",N6,I(M.title||"Untitled"),1),r("div",F6,[$[3]||($[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:E=>f(H),title:"Remove"},"  ",8,U6)])]),M.content?(v(),g("div",z6,I(M.content),1)):D("",!0)]))),128))])):D("",!0),!e.isEditing&&w.value.length===0&&d.value.length===0?(v(),g("div",H6,[r("p",null,"No notes will be visible based on the current "+I(N(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),g("p",V6," Assign "+I(N(o).checkpoints)+" to see relevant notes. ",1)):D("",!0)])):D("",!0),!e.isEditing&&w.value.length>0?(v(),g("div",G6,[(v(!0),g(Ae,null,Ue(w.value,M=>(v(),g("div",{key:M.id,class:"note-item"},[r("div",q6,[r("span",j6,I(M.title||"Untitled"),1),r("span",{class:"scope-pill",title:x(M)},I(T(M)),9,Z6)]),M.content?(v(),g("div",W6,I(M.content),1)):D("",!0),C(M)?(v(),g("div",K6,I(C(M)),1)):D("",!0)]))),128))])):D("",!0)]))}},Y6=He(J6,[["__scopeId","data-v-e8e0946a"]]),X6={key:6,class:"tab-content incidents-tab"},Q6={class:"incidents-list"},e8={class:"custom-footer"},t8={class:"footer-left"},n8={__name:"EditMarshalModal",props:{show:{type:Boolean,default:!1},marshal:{type:Object,default:null},eventId:{type:String,required:!0},assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1},eventNotes:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},incidents:{type:Array,default:()=>[]},allMarshals:{type:Array,default:()=>[]},validationErrors:{type:Object,default:()=>({})},lockedCheckpointId:{type:String,default:null},zIndex:{type:Number,default:1e3}},emits:["close","save","delete","toggle-check-in","remove-assignment","assign-to-location","update:isDirty","select-incident","select-checkpoint"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:n}=ct(),i=e,l=o,u=A("details"),d=A(null),h=A(null),f=A(null),m=A([]),y=A([]),k=A([]),w=A([]),S=A({name:"",email:"",phoneNumber:"",notes:""}),T=A(!1),x=A(null),C=ie=>{x.value=ie,T.value=!0},_=()=>{T.value=!1,x.value=null},$=ie=>i.allLocations.find(z=>z.id===ie),M=V(()=>S.value.name||i.marshal?.name||""),H=V(()=>x.value&&$(x.value.locationId)?.name||""),E=V(()=>{if(!x.value)return null;const{checkInLatitude:ie,checkInLongitude:z}=x.value;return!ie||!z?null:{lat:ie,lng:z}}),B=V(()=>{if(!x.value)return null;const ie=$(x.value.locationId);return!ie?.latitude||!ie?.longitude?null:{lat:ie.latitude,lng:ie.longitude}}),R=V(()=>{if(!x.value)return null;const{checkInLatitude:ie,checkInLongitude:z,locationId:K}=x.value,se=$(K);return!ie||!z||!se?.latitude||!se?.longitude?null:_i(ie,z,se.latitude,se.longitude)}),U=V(()=>{const ie=i.isEditing?`Edit ${n.value.person}`:`Create ${n.value.person}`,z=S.value.name?.trim();return z?`${ie} - ${z}`:ie}),F=V(()=>{const ie=[{value:"details",label:"Details",icon:"details"},{value:"checkpoints",label:a.value.checkpoints,icon:"checkpoint"},{value:"checklists",label:a.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}];return i.incidents&&i.incidents.length>0&&ie.push({value:"incidents",label:"Incidents",icon:"incidents"}),ie}),j=V(()=>F.value.findIndex(ie=>ie.value===u.value)),Y=V(()=>j.value===F.value.length-1),oe=V(()=>Y.value?null:F.value[j.value+1]),Oe=V(()=>oe.value?`${oe.value.label}...`:""),ee=V(()=>y.value.map(ie=>ie.locationId)),te=V(()=>i.isEditing?i.assignments:y.value.map(ie=>({id:`pending-${ie.locationId}`,locationId:ie.locationId,locationName:i.allLocations.find(z=>z.id===ie.locationId)?.name||"Unknown",isPending:!0}))),O=V(()=>{if(i.isEditing)return i.availableLocations;const ie=y.value.map(z=>z.locationId);return i.allLocations.filter(z=>!ie.includes(z.id))});We(()=>i.marshal,ie=>{ie?S.value={name:ie.name||"",email:ie.email||"",phoneNumber:ie.phoneNumber||"",notes:ie.notes||""}:S.value={name:"",email:"",phoneNumber:"",notes:""}},{immediate:!0,deep:!0}),We(()=>i.show,ie=>{ie&&(u.value="details",m.value=[],y.value=[],k.value=[],w.value=[],i.isEditing||(S.value={name:"",email:"",phoneNumber:"",notes:""}),h.value?.clearPendingChanges&&h.value.clearPendingChanges(),f.value?.resetLocalState&&f.value.resetLocalState())});const Z=ie=>{S.value=ie},ne=()=>{l("update:isDirty",!0)},pe=()=>{l("update:isDirty",!0)},we=()=>{oe.value&&(u.value=oe.value.value)},Ze=()=>{const ie={...S.value,checkInChanges:h.value?.getPendingChanges?.()||[],assignmentsToRemove:h.value?.getMarkedForRemoval?.()||[],checklistChanges:m.value||[],pendingAssignments:i.isEditing?[]:y.value,pendingNewChecklistItems:k.value,pendingNewNotes:w.value};l("save",ie)},Ne=()=>{l("delete")},Ge=ie=>{!i.isEditing&&ie.isPending?y.value=y.value.filter(z=>z.locationId!==ie.locationId):l("remove-assignment",ie)},Xe=ie=>{i.isEditing?l("assign-to-location",ie):(y.value.push({locationId:ie}),l("update:isDirty",!0))},Q=ie=>{l("select-checkpoint",ie)},ye=()=>{l("close")};return t({switchToTab:ie=>{u.value=ie},focusField:ie=>{d.value?.focusField&&d.value.focusField(ie)}}),(ie,z)=>(v(),Ke(Ht,{show:e.show,title:U.value,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:ye},{"tab-header":Fe(()=>[Me(fl,{modelValue:u.value,"onUpdate:modelValue":z[0]||(z[0]=K=>u.value=K),tabs:F.value},null,8,["modelValue","tabs"])]),footer:Fe(()=>[r("div",e8,[r("div",t8,[e.isEditing&&!e.lockedCheckpointId?(v(),g("button",{key:0,type:"button",onClick:Ne,class:"btn btn-danger"}," Delete ")):D("",!0),!e.isEditing&&!Y.value?(v(),g("button",{key:1,type:"button",onClick:we,class:"btn btn-secondary mobile-only"},I(Oe.value),1)):D("",!0)]),r("button",{type:"button",onClick:Ze,class:"btn btn-success"}," Save ")])]),default:Fe(()=>[u.value==="details"?(v(),Ke(M5,{key:0,ref_key:"detailsTabRef",ref:d,form:S.value,"event-id":e.eventId,"marshal-id":e.isEditing?e.marshal?.id:null,"validation-errors":e.validationErrors,"onUpdate:form":Z,onInput:ne},null,8,["form","event-id","marshal-id","validation-errors"])):D("",!0),u.value==="checkpoints"?(v(),Ke(e6,{key:1,ref_key:"checkpointsTabRef",ref:h,assignments:te.value,"available-locations":O.value,"all-locations":e.allLocations,areas:e.areas,"is-new-marshal":!e.isEditing,"locked-checkpoint-id":e.lockedCheckpointId,onInput:ne,onRemoveAssignment:Ge,onAssignToLocation:Xe,onSelectCheckpoint:Q,onDistanceClick:C},null,8,["assignments","available-locations","all-locations","areas","is-new-marshal","locked-checkpoint-id"])):D("",!0),u.value==="checklists"&&e.isEditing?(v(),Ke(i6,{key:2,ref_key:"checklistTabRef",ref:f,modelValue:m.value,"onUpdate:modelValue":z[1]||(z[1]=K=>m.value=K),"event-id":e.eventId,"marshal-id":e.marshal.id,locations:e.allLocations,areas:e.areas,onChange:pe},null,8,["modelValue","event-id","marshal-id","locations","areas"])):D("",!0),u.value==="checklists"?(v(),Ke(T6,{key:3,modelValue:k.value,"onUpdate:modelValue":z[2]||(z[2]=K=>k.value=K),"all-checklist-items":e.allChecklistItems,"pending-location-ids":ee.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:ne},null,8,["modelValue","all-checklist-items","pending-location-ids","all-locations","areas","is-editing"])):D("",!0),u.value==="notes"&&e.isEditing?(v(),Ke(Rc,{key:4,"event-id":e.eventId,"marshal-id":e.marshal?.id,"all-notes":e.eventNotes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals},null,8,["event-id","marshal-id","all-notes","locations","areas","assignments","marshals"])):D("",!0),u.value==="notes"?(v(),Ke(Y6,{key:5,modelValue:w.value,"onUpdate:modelValue":z[3]||(z[3]=K=>w.value=K),"all-notes":e.eventNotes,"pending-location-ids":ee.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:ne},null,8,["modelValue","all-notes","pending-location-ids","all-locations","areas","is-editing"])):D("",!0),u.value==="incidents"?(v(),g("div",X6,[r("div",Q6,[(v(!0),g(Ae,null,Ue(e.incidents,K=>(v(),Ke(vr,{key:K.incidentId,incident:K,onSelect:z[4]||(z[4]=se=>ie.$emit("select-incident",se))},null,8,["incident"]))),128))])])):D("",!0),Me(Vd,{show:T.value,"marshal-name":M.value,"checkpoint-name":H.value,"check-in-location":E.value,"checkpoint-location":B.value,distance:R.value,"z-index":e.zIndex+100,onClose:_},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance","z-index"])]),_:1},8,["show","title","is-dirty","z-index"]))}},o8=He(n8,[["__scopeId","data-v-f4e8a66c"]]),s8={class:"locations-list"},a8={class:"conflict-actions"},i8={__name:"AssignmentConflictModal",props:{show:{type:Boolean,default:!1},conflictData:{type:Object,default:()=>({marshalName:"",locations:[]})}},emits:["close","choice"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ct(),n=t,i=u=>{n("choice",u)},l=()=>{n("close")};return(u,d)=>(v(),Ke(Ht,{show:e.show,title:`${N(o).person} already assigned`,size:"medium","z-index":1100,onClose:l},{actions:Fe(()=>[r("div",a8,[r("button",{onClick:d[0]||(d[0]=h=>i("move")),class:"btn btn-primary btn-full"}," Move to this "+I(N(a).checkpoint)+" (remove from others) ",1),r("button",{onClick:d[1]||(d[1]=h=>i("both")),class:"btn btn-secondary btn-full"}," Assign to both (keep existing assignments) "),r("button",{onClick:d[2]||(d[2]=h=>i("choose-other")),class:"btn btn-secondary btn-full"}," Choose someone else "),r("button",{onClick:d[3]||(d[3]=h=>i("cancel")),class:"btn btn-secondary btn-full"}," Cancel ")])]),default:Fe(()=>[r("p",null,[r("strong",null,I(e.conflictData.marshalName),1),d[4]||(d[4]=Ye(" is currently assigned to: ",-1))]),r("ul",s8,[(v(!0),g(Ae,null,Ue(e.conflictData.locations,h=>(v(),g("li",{key:h},I(h),1))),128))]),d[5]||(d[5]=r("p",null,"What would you like to do?",-1))]),_:1},8,["show","title"]))}},l8=He(i8,[["__scopeId","data-v-997e8aaa"]]),r8={key:0,class:"assign-marshal-section"},c8={value:""},u8=["value"],d8=["disabled"],h8={key:1,class:"assign-marshal-section create-mode"},f8={class:"form-group"},p8={class:"form-group"},v8={class:"form-group"},m8={__name:"AssignMarshalModal",props:{show:{type:Boolean,default:!1},locationName:{type:String,default:""},marshals:{type:Array,default:()=>[]}},emits:["close","assign-existing","create-and-assign"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,n=t,i=A(!1),l=A(""),u=A({name:"",email:"",phoneNumber:""});We(()=>a.show,k=>{k||(i.value=!1,l.value="",u.value={name:"",email:"",phoneNumber:""})});const d=()=>{i.value=!0},h=()=>{l.value&&n("assign-existing",l.value)},f=()=>{u.value.name&&n("create-and-assign",{...u.value})},m=()=>{i.value=!1,u.value={name:"",email:"",phoneNumber:""}},y=()=>{n("close")};return(k,w)=>(v(),Ke(Ht,{show:e.show,title:i.value?`Create new ${N(o).person}`:`Assign ${N(o).person} to ${e.locationName}`,size:"medium",onClose:y},{actions:Fe(()=>[i.value?(v(),g(Ae,{key:0},[r("button",{onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{onClick:f,class:"btn btn-primary"}," Create & assign ")],64)):D("",!0)]),default:Fe(()=>[i.value?(v(),g("div",h8,[r("h3",null,"Create new "+I(N(o).person),1),r("div",f8,[w[5]||(w[5]=r("label",null,"Name *",-1)),ze(r("input",{"onUpdate:modelValue":w[1]||(w[1]=S=>u.value.name=S),type:"text",required:"",class:"form-input"},null,512),[[nt,u.value.name]])]),r("div",p8,[w[6]||(w[6]=r("label",null,"Email",-1)),ze(r("input",{"onUpdate:modelValue":w[2]||(w[2]=S=>u.value.email=S),type:"email",class:"form-input"},null,512),[[nt,u.value.email]])]),r("div",v8,[w[7]||(w[7]=r("label",null,"Phone",-1)),ze(r("input",{"onUpdate:modelValue":w[3]||(w[3]=S=>u.value.phoneNumber=S),type:"tel",class:"form-input"},null,512),[[nt,u.value.phoneNumber]])])])):(v(),g("div",r8,[r("h3",null,"Select existing "+I(N(o).person),1),ze(r("select",{"onUpdate:modelValue":w[0]||(w[0]=S=>l.value=S),class:"form-input"},[r("option",c8,"Choose a "+I(N(o).person)+"...",1),(v(!0),g(Ae,null,Ue(e.marshals,S=>(v(),g("option",{key:S.id,value:S.id},[Ye(I(S.name)+" ",1),S.assignedLocationIds&&S.assignedLocationIds.length>0?(v(),g(Ae,{key:0},[Ye(" (assigned to "+I(S.assignedLocationIds.length)+" "+I(S.assignedLocationIds.length>1?N(o).checkpoints:N(o).checkpoint)+") ",1)],64)):D("",!0)],8,u8))),128))],512),[[zn,l.value]]),r("button",{onClick:h,class:"btn btn-primary btn-full",style:{"margin-top":"1rem"},disabled:!l.value}," Assign selected "+I(N(o).person),9,d8),w[4]||(w[4]=r("div",{class:"divider"},"OR",-1)),r("button",{onClick:d,class:"btn btn-secondary btn-full"}," Create new "+I(N(o).person),1)]))]),_:1},8,["show","title"]))}},g8=He(m8,[["__scopeId","data-v-fa70b913"]]),y8={class:"shift-times-content"},k8={class:"info-text"},b8={class:"time-delta-info"},_8={class:"delta-detail"},w8={class:"delta-detail"},C8={class:"delta-summary"},L8={class:"affected-checkpoints"},S8={class:"option-selection"},I8={class:"radio-option"},x8={class:"radio-option"},$8={__name:"ShiftCheckpointTimesModal",props:{show:{type:Boolean,default:!1},oldEventDate:{type:String,required:!0},newEventDate:{type:String,required:!0},affectedCheckpointsCount:{type:Number,default:0}},emits:["confirm","cancel"],setup(e,{emit:t}){const{terms:o,termsLower:a}=ct(),n=e,i=t,l=A("shift"),u=V(()=>{const y=new Date(n.oldEventDate);return new Date(n.newEventDate)-y}),d=y=>new Date(y).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),h=y=>{const k=Math.abs(y),w=y>=0?"+":"-",S=Math.floor(k/(1e3*60*60*24)),T=Math.floor(k%(1e3*60*60*24)/(1e3*60*60)),x=Math.floor(k%(1e3*60*60)/(1e3*60)),C=[];return S>0&&C.push(`${S}d`),T>0&&C.push(`${T}h`),x>0&&C.push(`${x}m`),`${w}${C.join(" ")}`},f=()=>{i("confirm",{shouldShift:l.value==="shift",timeDelta:u.value})},m=()=>{i("cancel")};return(y,k)=>(v(),Ke(Ht,{show:e.show,title:`Shift ${N(o).checkpoint} Times?`,size:"medium",onClose:m},{actions:Fe(()=>[r("button",{type:"button",onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-primary"},I(l.value==="shift"?"Shift Times":"Keep Times"),1)]),default:Fe(()=>[r("div",y8,[r("p",k8," You've changed the event date/time. Some "+I(N(a).checkpoints)+" have custom times set. ",1),r("div",b8,[k[2]||(k[2]=r("strong",null,"Event time change:",-1)),r("div",_8," Old: "+I(d(e.oldEventDate)),1),r("div",w8," New: "+I(d(e.newEventDate)),1),r("div",C8," Delta: "+I(h(u.value)),1)]),r("p",L8,[r("strong",null,I(e.affectedCheckpointsCount)+" "+I(e.affectedCheckpointsCount===1?N(a).checkpoint:N(a).checkpoints),1),k[3]||(k[3]=Ye(" with custom times will be shifted by the same amount. ",-1))]),r("div",S8,[r("label",I8,[ze(r("input",{"onUpdate:modelValue":k[0]||(k[0]=w=>l.value=w),type:"radio",value:"shift",name:"shift-option"},null,512),[[Xh,l.value]]),r("div",null,[r("strong",null,"Shift all "+I(N(a).checkpoint)+" times",1),k[4]||(k[4]=r("small",null,"Recommended: Maintains relative timing",-1))])]),r("label",x8,[ze(r("input",{"onUpdate:modelValue":k[1]||(k[1]=w=>l.value=w),type:"radio",value:"keep",name:"shift-option"},null,512),[[Xh,l.value]]),r("div",null,[r("strong",null,"Keep "+I(N(a).checkpoint)+" times unchanged",1),r("small",null,I(N(o).checkpoint)+" times will stay at their current values",1)])])])])]),_:1},8,["show","title"]))}},T8=He($8,[["__scopeId","data-v-a6454aff"]]),M8={class:"checklist-preview"},A8={class:"preview-actions"},E8={class:"preview-header"},P8={key:0,class:"add-item-form"},D8=["placeholder"],R8=["disabled"],O8={key:1,class:"pending-items"},B8={class:"item-content"},N8={class:"item-header"},F8={class:"item-text"},U8={class:"item-scope"},z8=["onClick"],H8={key:2,class:"empty-state"},V8={__name:"ChecklistPreviewForArea",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,n=t,i=A(!1),l=A(""),u=A([...a.modelValue]);We(()=>a.modelValue,m=>{u.value=[...m]},{deep:!0});const d=()=>{l.value.trim()&&(u.value.push({text:l.value.trim(),isNew:!0}),l.value="",i.value=!1,f())},h=m=>{u.value.splice(m,1),f()},f=()=>{n("update:modelValue",[...u.value]),n("change")};return(m,y)=>(v(),g("div",M8,[r("div",A8,[r("p",E8," Add new "+I(N(o).checklist)+" for this "+I(N(o).area)+": ",1),r("button",{type:"button",class:"add-item-btn",onClick:y[0]||(y[0]=k=>i.value=!i.value)},I(i.value?"Cancel":`Add ${N(o).checklist}`),1)]),i.value?(v(),g("div",P8,[ze(r("input",{"onUpdate:modelValue":y[1]||(y[1]=k=>l.value=k),type:"text",placeholder:`Enter ${N(o).checklist} text...`,class:"add-item-input",onKeyup:To(d,["enter"])},null,40,D8),[[nt,l.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim(),onClick:d}," Add ",8,R8)])):D("",!0),u.value.length>0?(v(),g("div",O8,[(v(!0),g(Ae,null,Ue(u.value,(k,w)=>(v(),g("div",{key:`pending-${w}`,class:"checklist-item pending"},[y[3]||(y[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",B8,[r("div",N8,[r("div",F8,I(k.text),1),r("div",U8,[y[2]||(y[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:S=>h(w),title:"Remove"},"  ",8,z8)])])])]))),128))])):D("",!0),u.value.length===0&&!i.value?(v(),g("div",H8,[r("p",null,"No new "+I(N(o).checklists)+" to add. Click the button above to create one.",1)])):D("",!0)]))}},G8=He(V8,[["__scopeId","data-v-a394c400"]]),q8={class:"notes-preview"},j8={class:"preview-actions"},Z8={class:"preview-header"},W8={key:0,class:"add-item-form"},K8={class:"add-form-fields"},J8=["disabled"],Y8={key:1,class:"pending-items"},X8={class:"note-header"},Q8={class:"note-title"},eD={class:"note-actions"},tD=["onClick"],nD={key:0,class:"note-content"},oD={key:2,class:"empty-state"},sD={__name:"NotesPreviewForArea",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,n=t,i=A(!1),l=A(""),u=A(""),d=A([...a.modelValue]);We(()=>a.modelValue,y=>{d.value=[...y]},{deep:!0});const h=()=>{!l.value.trim()&&!u.value.trim()||(d.value.push({title:l.value.trim(),content:u.value.trim(),isNew:!0}),l.value="",u.value="",i.value=!1,m())},f=y=>{d.value.splice(y,1),m()},m=()=>{n("update:modelValue",[...d.value]),n("change")};return(y,k)=>(v(),g("div",q8,[r("div",j8,[r("p",Z8," Add new note for this "+I(N(o).area)+": ",1),r("button",{type:"button",class:"add-item-btn",onClick:k[0]||(k[0]=w=>i.value=!i.value)},I(i.value?"Cancel":"Add note"),1)]),i.value?(v(),g("div",W8,[r("div",K8,[ze(r("input",{"onUpdate:modelValue":k[1]||(k[1]=w=>l.value=w),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[nt,l.value]]),ze(r("textarea",{"onUpdate:modelValue":k[2]||(k[2]=w=>u.value=w),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[nt,u.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim()&&!u.value.trim(),onClick:h}," Add ",8,J8)])):D("",!0),d.value.length>0?(v(),g("div",Y8,[(v(!0),g(Ae,null,Ue(d.value,(w,S)=>(v(),g("div",{key:`pending-${S}`,class:"note-item pending"},[r("div",X8,[r("span",Q8,I(w.title||"Untitled"),1),r("div",eD,[k[3]||(k[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:T=>f(S),title:"Remove"},"  ",8,tD)])]),w.content?(v(),g("div",nD,I(w.content),1)):D("",!0)]))),128))])):D("",!0),d.value.length===0&&!i.value?(v(),g("div",oD,[...k[4]||(k[4]=[r("p",null,"No new notes to add. Click the button above to create one.",-1)])])):D("",!0)]))}},aD=He(sD,[["__scopeId","data-v-5e6bdcab"]]),iD={class:"search-section"},lD={class:"form-group"},rD={class:"suggestions-list"},cD={class:"suggestion-content"},uD={key:0,class:"suggestion-detail"},dD=["onClick"],hD={class:"suggestion-content"},fD={class:"suggestion-name"},pD={key:0,class:"suggestion-detail"},vD=["onClick"],mD={class:"suggestion-content"},gD={class:"suggestion-name"},yD={key:0,class:"suggestion-detail"},kD={key:1,class:"no-results"},bD={key:2,class:"no-results"},_D={__name:"AddAreaContactModal",props:{show:{type:Boolean,default:!1},areaName:{type:String,default:""},areaId:{type:String,default:""},contacts:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},excludeContactIds:{type:Array,default:()=>[]}},emits:["close","select-contact","create-from-marshal","create-new"],setup(e,{emit:t}){const{terms:o}=ct(),a=e,n=t,i=A(""),l=A(null),u=V(()=>a.contacts.filter(E=>a.excludeContactIds.includes(E.contactId)&&E.marshalId).map(E=>E.marshalId)),d=V(()=>a.contacts.filter(E=>E.marshalId).map(E=>E.marshalId)),h=V(()=>a.contacts.filter(E=>!a.excludeContactIds.includes(E.contactId))),f=V(()=>a.marshals.filter(E=>!u.value.includes(E.id)&&!d.value.includes(E.id))),m=E=>E?E.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",y=V(()=>{const E=m(i.value);return E?E.split(" ").filter(B=>B.length>0):[]}),k=(E,B)=>{if(B.length===0)return{score:1,isPartial:!1};const R=m(E);let U=0;for(const F of B)R.includes(F)&&U++;return{score:U,isPartial:U>0&&U<B.length,isFullMatch:U===B.length}},w=V(()=>{const E=y.value,B=[];return h.value.forEach(R=>{const U=`${R.name||""} ${R.role||""}`,F=k(U,E);(E.length===0||F.score>0)&&B.push({key:`contact-${R.contactId}`,type:"contact",name:R.name,detail:R.role?H(R.role):null,data:R,matchScore:F.score,isPartial:F.isPartial,isFullMatch:F.isFullMatch})}),f.value.forEach(R=>{const U=`${R.name||""} ${R.email||""}`,F=k(U,E);(E.length===0||F.score>0)&&B.push({key:`marshal-${R.id}`,type:"marshal",name:R.name,detail:R.email||R.phoneNumber||null,data:R,matchScore:F.score,isPartial:F.isPartial,isFullMatch:F.isFullMatch})}),B.sort((R,U)=>U.matchScore!==R.matchScore?U.matchScore-R.matchScore:R.name.localeCompare(U.name,void 0,{sensitivity:"base"})),B}),S=V(()=>y.value.length===0?w.value:w.value.filter(E=>E.isFullMatch)),T=V(()=>y.value.length===0?[]:w.value.filter(E=>E.isPartial)),x=V(()=>T.value.length>0);We(()=>a.show,async E=>{E&&(i.value="",await cn(),l.value?.focus())});const C=E=>{const B=a.contacts.find(R=>R.marshalId===E.id);if(B){if(a.excludeContactIds.includes(B.contactId))return;n("select-contact",B)}else n("create-from-marshal",E)},_=E=>{n("select-contact",E)},$=()=>{n("create-new",i.value.trim())},M=()=>{n("close")},H=E=>E?E.replace(/([A-Z])/g," $1").replace(/^./,B=>B.toUpperCase()).trim():"";return(E,B)=>(v(),Ke(Ht,{show:e.show,title:`Add contact to ${e.areaName}`,size:"medium",onClose:M},{actions:Fe(()=>[r("button",{onClick:M,class:"btn btn-secondary"}," Cancel ")]),default:Fe(()=>[r("div",iD,[r("div",lD,[B[1]||(B[1]=r("label",null,"Search or create",-1)),ze(r("input",{ref_key:"searchInputRef",ref:l,"onUpdate:modelValue":B[0]||(B[0]=R=>i.value=R),type:"text",class:"form-input",placeholder:"Filter by name..."},null,512),[[nt,i.value]])]),r("div",rD,[r("div",{class:"suggestion-item create-new",onClick:$},[B[3]||(B[3]=r("span",{class:"suggestion-icon create-icon"},"+",-1)),r("div",cD,[B[2]||(B[2]=r("span",{class:"suggestion-name"},"Create new contact",-1)),i.value.trim()?(v(),g("span",uD,'"'+I(i.value.trim())+'"',1)):D("",!0)])]),(v(!0),g(Ae,null,Ue(S.value,R=>(v(),g("div",{key:R.key,class:"suggestion-item",onClick:U=>R.type==="marshal"?C(R.data):_(R.data)},[r("span",{class:ve(["suggestion-icon",R.type==="marshal"?"marshal-icon":"contact-icon"])},I(R.type==="marshal"?"M":"C"),3),r("div",hD,[r("span",fD,I(R.name),1),R.detail?(v(),g("span",pD,I(R.detail),1)):D("",!0)]),r("span",{class:ve(["suggestion-badge",{"contact-badge":R.type==="contact"}])},I(R.type==="marshal"?N(o).person:"Contact"),3)],8,dD))),128)),x.value?(v(),g(Ae,{key:0},[B[4]||(B[4]=r("div",{class:"suggestion-section-header"},"Partial matches",-1)),(v(!0),g(Ae,null,Ue(T.value,R=>(v(),g("div",{key:R.key,class:"suggestion-item",onClick:U=>R.type==="marshal"?C(R.data):_(R.data)},[r("span",{class:ve(["suggestion-icon",R.type==="marshal"?"marshal-icon":"contact-icon"])},I(R.type==="marshal"?"M":"C"),3),r("div",mD,[r("span",gD,I(R.name),1),R.detail?(v(),g("span",yD,I(R.detail),1)):D("",!0)]),r("span",{class:ve(["suggestion-badge",{"contact-badge":R.type==="contact"}])},I(R.type==="marshal"?N(o).person:"Contact"),3)],8,vD))),128))],64)):D("",!0),i.value.trim()&&S.value.length===0&&T.value.length===0?(v(),g("div",kD," No matching "+I(N(o).people.toLowerCase())+" or contacts found. ",1)):D("",!0),!i.value.trim()&&S.value.length===0?(v(),g("div",bD," No "+I(N(o).people.toLowerCase())+" or contacts available to add. ",1)):D("",!0)])])]),_:1},8,["show","title"]))}},wD=He(_D,[["__scopeId","data-v-e25ca97b"]]),CD={key:0,class:"tab-content"},LD={class:"form-group"},SD=["disabled"],ID={class:"form-group"},xD={key:1,class:"tab-content"},$D={class:"boundary-section"},TD={key:0,class:"boundary-preview"},MD={class:"boundary-actions"},AD={key:2,class:"tab-content"},ED={class:"contacts-header"},PD={class:"section-title"},DD={key:3,class:"tab-content"},RD={class:"section-title"},OD={key:4,class:"placeholder-message"},BD={key:7,class:"placeholder-message"},ND={key:10,class:"placeholder-message"},FD={key:11,class:"tab-content appearance-tab"},UD={class:"accordion-item"},zD=["innerHTML"],HD={class:"accordion-title"},VD={class:"accordion-arrow"},GD={key:0,class:"accordion-content"},qD={class:"section-description"},jD={class:"color-picker"},ZD=["title","onClick"],WD={class:"accordion-item"},KD=["innerHTML"],JD={class:"accordion-title"},YD={class:"accordion-arrow"},XD={key:0,class:"accordion-content"},QD={class:"section-description"},eR={class:"accordion-item"},tR={class:"accordion-title"},nR={class:"accordion-preview"},oR={class:"accordion-arrow"},sR={key:0,class:"accordion-content"},aR={class:"section-description"},iR={class:"form-group"},lR={value:""},rR=["value"],cR={class:"accordion-item"},uR={class:"accordion-title"},dR={class:"accordion-preview"},hR={class:"accordion-arrow"},fR={key:0,class:"accordion-content"},pR={class:"section-description"},vR={class:"form-group"},mR={value:""},gR=["value"],yR={key:12,class:"tab-content incidents-tab"},kR={class:"incidents-list"},bR={class:"custom-footer"},_R={class:"footer-left"},Sp="edit_area_accordion",wR={__name:"EditAreaModal",props:{show:{type:Boolean,default:!1},area:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},incidents:{type:Array,default:()=>[]},initialTab:{type:String,default:"details"},route:{type:Array,default:()=>[]}},emits:["close","save","delete","draw-boundary","update:isDirty","select-checkpoint","create-contact-from-marshal","create-new-contact","edit-contact","select-incident"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:n}=ct(),i=()=>M.value.peopleTerm?M.value.peopleTerm:d.eventPeopleTerm||"Marshals",l=(W=!0)=>{const J=M.value.checkpointTerm||d.eventCheckpointTerm||"Checkpoints",re=i();return W?ng("checkpoint",J,re):ui("checkpoint",J,re)},u=(W=!0)=>l(W).toLowerCase(),d=e,h=o,f=A("details"),m=A(null),y=A([]),k=A({}),w=A({}),S=A(!1),T=A(!1),x=A([]),C=A([]),_=A([]),$=A([]),M=A({name:"",description:"",color:zr,displayOrder:0,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),H=()=>({name:"",description:"",color:oS(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),E=()=>d.eventId?`${Sp}_${d.eventId}`:Sp,B=A({polygonColor:!1,iconStyle:!1,peopleTerm:!1,checkpointTerm:!1});ln(()=>{const W=localStorage.getItem(E());if(W)try{const J=JSON.parse(W);B.value={...B.value,...J}}catch{}});const R=W=>{B.value[W]=!B.value[W],localStorage.setItem(E(),JSON.stringify(B.value))},U=V(()=>`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <polygon points="4,8 7,3 14,2 20,5 22,12 19,18 12,21 5,19 2,14" fill="${M.value.color||zr}" stroke="#fff" stroke-width="1.5" opacity="0.8"/>
  </svg>`),F=V(()=>{const W=M.value.checkpointStyleType!=="default"||M.value.checkpointStyleBackgroundShape||M.value.checkpointStyleBackgroundColor||M.value.checkpointStyleBorderColor||M.value.checkpointStyleIconColor||M.value.checkpointStyleSize,J=d.eventDefaultStyleType!=="default"||d.eventDefaultStyleBackgroundShape||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||d.eventDefaultStyleBorderColor||d.eventDefaultStyleIconColor||d.eventDefaultStyleSize;if(!W&&!J)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="areaDefaultGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981"/>
          <stop offset="50%" style="stop-color:#F59E0B"/>
          <stop offset="100%" style="stop-color:#EF4444"/>
        </linearGradient>
      </defs>
      <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#areaDefaultGrad)" stroke="#fff" stroke-width="1.5"/>
    </svg>`;const re=M.value.checkpointStyleType&&M.value.checkpointStyleType!=="default"?M.value.checkpointStyleType:d.eventDefaultStyleType&&d.eventDefaultStyleType!=="default"?d.eventDefaultStyleType:"default",je=M.value.checkpointStyleBackgroundShape||d.eventDefaultStyleBackgroundShape||"circle",et=M.value.checkpointStyleBackgroundColor||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||"#667eea",dt=M.value.checkpointStyleBorderColor||d.eventDefaultStyleBorderColor||"#ffffff",kt=M.value.checkpointStyleIconColor||d.eventDefaultStyleIconColor||"#ffffff",gt=M.value.checkpointStyleSize||d.eventDefaultStyleSize||"100";return Tn({type:re!=="default"?re:je,backgroundShape:je,backgroundColor:et,borderColor:dt,iconColor:kt,size:gt,outputSize:24})}),j=V(()=>d.area&&d.area.id),Y=V(()=>!M.value.polygon||M.value.polygon.length===0?[]:M.value.polygon.map((W,J)=>({id:`polygon-point-${J}`,latitude:W.lat,longitude:W.lng}))),oe=V(()=>d.area?.id?d.areas.filter(W=>W.id!==d.area.id).map(W=>({...W,color:"#999999"})):d.areas.map(W=>({...W,color:"#999999"})));V(()=>pe.value.map(W=>W.id));const Oe=V(()=>{const W=[{value:"details",label:"Details",icon:"details"},{value:"boundary",label:"Boundary",icon:"area"},{value:"contacts",label:"Contacts",icon:"marshal"},{value:"checkpoints",label:l(),icon:"checkpoint"},{value:"checklists",label:a.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return d.incidents&&d.incidents.length>0&&W.push({value:"incidents",label:"Incidents",icon:"incidents"}),W}),ee=V(()=>Oe.value.findIndex(W=>W.value===f.value)),te=V(()=>ee.value===Oe.value.length-1),O=V(()=>te.value?null:Oe.value[ee.value+1]),Z=V(()=>O.value?`${O.value.label}...`:""),ne=V(()=>{if(!d.area||!d.area.id)return[];const W=d.checkpoints.filter(J=>J.areaIds&&J.areaIds.includes(d.area.id)).map(J=>J.id);return d.assignments.filter(J=>W.includes(J.locationId))}),pe=V(()=>!d.area||!d.area.id?[]:d.checkpoints.filter(W=>W.areaIds&&W.areaIds.includes(d.area.id))),we=V(()=>{const W=[...pe.value];return W.sort((J,re)=>{const je=J.name.match(/^(\d+)/),et=re.name.match(/^(\d+)/);if(je&&et){const dt=parseInt(je[1]),kt=parseInt(et[1]);if(dt!==kt)return dt-kt}return J.name.localeCompare(re.name,void 0,{numeric:!0,sensitivity:"base"})}),W}),Ze=V(()=>!d.area||!d.area.id?[]:d.contacts.filter(W=>W.scopeConfigurations?W.scopeConfigurations.some(J=>J.scope==="EveryoneInAreas"&&J.itemType==="Area"?J.ids?.includes("ALL_AREAS")?!0:J.ids?.includes(d.area.id):!1):!1)),Ne=V(()=>{const W=new Set(Ze.value.map(je=>je.contactId)),J=Ze.value.map(je=>({...je,isPending:!1,isExisting:!0,isMarkedForRemoval:C.value.includes(je.contactId)})),re=x.value.filter(je=>!W.has(je.contactId)).map(je=>({...je,isPending:!0,isExisting:!1,isMarkedForRemoval:!1}));return[...J,...re].sort((je,et)=>je.name.localeCompare(et.name,void 0,{sensitivity:"base"}))}),Ge=V(()=>{const W=Ze.value.map(re=>re.contactId),J=x.value.map(re=>re.contactId);return[...W,...J]}),Xe=async W=>{if(!(k.value[W]||w.value[W])){w.value[W]=!0;try{const re=(await Ut.getCheckpointChecklist(d.eventId,W)).data||[];k.value[W]={total:re.length,completed:re.filter(je=>je.isCompleted).length}}catch(J){console.error("Failed to load checklist status for checkpoint:",W,J),k.value[W]={total:0,completed:0}}finally{w.value[W]=!1}}};We(()=>d.area,W=>{if(W){const J=W.polygon?typeof W.polygon=="string"?JSON.parse(W.polygon):W.polygon:[];M.value={name:W.name||"",description:W.description||"",color:W.color||zr,displayOrder:W.displayOrder||0,isDefault:W.isDefault||!1,polygon:J,checkpointStyleType:W.checkpointStyleType||"default",checkpointStyleColor:W.checkpointStyleColor||"",checkpointStyleBackgroundShape:W.checkpointStyleBackgroundShape||"",checkpointStyleBackgroundColor:W.checkpointStyleBackgroundColor||"",checkpointStyleBorderColor:W.checkpointStyleBorderColor||"",checkpointStyleIconColor:W.checkpointStyleIconColor||"",checkpointStyleSize:W.checkpointStyleSize||"",checkpointStyleMapRotation:W.checkpointStyleMapRotation??"",peopleTerm:W.peopleTerm||"",checkpointTerm:W.checkpointTerm||""}}else M.value=H()},{immediate:!0,deep:!0}),We(()=>d.show,W=>{W&&(f.value=d.initialTab||"details",y.value=[],k.value={},w.value={},x.value=[],C.value=[],_.value=[],$.value=[],T.value=!1,j.value||(M.value=H()),m.value?.resetLocalState&&m.value.resetLocalState())}),We(f,W=>{W==="checkpoints"&&d.area&&d.area.id&&pe.value.forEach(J=>{setTimeout(()=>Xe(J.id),0)})});const Q=()=>{h("update:isDirty",!0)},ye=W=>{M.value.color=W,Q()},Ce=(W,J)=>{M.value[W]=J,Q()},me=()=>{h("draw-boundary",M.value)},ie=W=>{M.value.polygon=W,Q()},z=()=>{M.value.polygon=[],S.value=!1,Q()},K=W=>{T.value=!1,h("create-contact-from-marshal",{marshal:W,area:d.area})},se=W=>{T.value=!1,h("create-new-contact",{name:W,area:d.area})},Ee=W=>{x.value.find(J=>J.contactId===W.contactId)||(x.value.push(W),Q()),T.value=!1},Be=W=>{x.value=x.value.filter(J=>J.contactId!==W),Q()},Re=W=>{C.value.includes(W)||(C.value.push(W),Q())},Se=W=>W.isPending?"Remove pending contact":`Remove from ${n.value.area}`,X=W=>{Ne.value.find(re=>re.contactId===W)?.isPending?Be(W):Re(W)},he=W=>{C.value=C.value.filter(J=>J!==W),Q()},Te=W=>{y.value=W,Q()},xe=()=>{O.value&&(f.value=O.value.value)},be=()=>{const W=d.area?{name:M.value.name,description:M.value.description,color:M.value.color,polygon:M.value.polygon.length>0?M.value.polygon:null,displayOrder:M.value.displayOrder,checkpointStyleType:M.value.checkpointStyleType,checkpointStyleColor:M.value.checkpointStyleColor,checkpointStyleBackgroundShape:M.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:M.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:M.value.checkpointStyleBorderColor,checkpointStyleIconColor:M.value.checkpointStyleIconColor,checkpointStyleSize:M.value.checkpointStyleSize,checkpointStyleMapRotation:M.value.checkpointStyleMapRotation!=null&&M.value.checkpointStyleMapRotation!==""?String(M.value.checkpointStyleMapRotation):null,peopleTerm:M.value.peopleTerm,checkpointTerm:M.value.checkpointTerm,checklistChanges:y.value||[],pendingContacts:x.value||[],contactsToRemove:C.value||[],pendingNewChecklistItems:_.value||[],pendingNewNotes:$.value||[]}:{name:M.value.name,description:M.value.description,color:M.value.color,polygon:M.value.polygon.length>0?M.value.polygon:null,checkpointStyleType:M.value.checkpointStyleType,checkpointStyleColor:M.value.checkpointStyleColor,checkpointStyleBackgroundShape:M.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:M.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:M.value.checkpointStyleBorderColor,checkpointStyleIconColor:M.value.checkpointStyleIconColor,checkpointStyleSize:M.value.checkpointStyleSize,checkpointStyleMapRotation:M.value.checkpointStyleMapRotation!=null&&M.value.checkpointStyleMapRotation!==""?String(M.value.checkpointStyleMapRotation):null,peopleTerm:M.value.peopleTerm,checkpointTerm:M.value.checkpointTerm,pendingContacts:x.value||[]};h("save",W)},de=()=>{h("delete",d.area.id)},fe=()=>{h("close")};return t({addPendingContact:W=>{W&&!x.value.find(J=>J.contactId===W.contactId)&&(x.value.push(W),Q())},removeContactById:W=>{const J=x.value.some(re=>re.contactId===W);x.value=x.value.filter(re=>re.contactId!==W),C.value=C.value.filter(re=>re!==W),J&&Q()}}),(W,J)=>(v(),Ke(Ht,{show:e.show,title:e.area&&e.area.id?`Edit ${N(n).area}: ${e.area.name}`:`Create new ${N(n).area}`,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:fe},{"tab-header":Fe(()=>[Me(fl,{modelValue:f.value,"onUpdate:modelValue":J[0]||(J[0]=re=>f.value=re),tabs:Oe.value},null,8,["modelValue","tabs"])]),footer:Fe(()=>[r("div",bR,[r("div",_R,[j.value&&!M.value.isDefault?(v(),g("button",{key:0,type:"button",onClick:de,class:"btn btn-danger"}," Delete ")):D("",!0),!j.value&&!te.value?(v(),g("button",{key:1,type:"button",onClick:xe,class:"btn btn-secondary mobile-only"},I(Z.value),1)):D("",!0)]),r("button",{type:"button",onClick:be,class:"btn btn-success"}," Save ")])]),default:Fe(()=>[f.value==="details"?(v(),g("div",CD,[r("form",{onSubmit:lt(be,["prevent"])},[r("div",LD,[J[27]||(J[27]=r("label",null,"Name *",-1)),ze(r("input",{"onUpdate:modelValue":J[1]||(J[1]=re=>M.value.name=re),type:"text",required:"",class:"form-input",disabled:M.value.isDefault,onInput:Q},null,40,SD),[[nt,M.value.name]])]),r("div",ID,[J[28]||(J[28]=r("label",null,"Description",-1)),ze(r("textarea",{"onUpdate:modelValue":J[2]||(J[2]=re=>M.value.description=re),class:"form-input",rows:"3",onInput:Q},null,544),[[nt,M.value.description]])])],32)])):D("",!0),f.value==="boundary"?(v(),g("div",xD,[r("div",$D,[M.value.polygon&&M.value.polygon.length>0?(v(),g("div",TD,[Me(wi,{mode:"edit-polygon","editing-polygon":M.value.polygon,route:e.route,locations:e.checkpoints,areas:oe.value,"all-locations-for-bounds":Y.value,height:"300px",onPolygonUpdate:ie},null,8,["editing-polygon","route","locations","areas","all-locations-for-bounds"]),J[29]||(J[29]=r("p",{class:"boundary-hint"},"Drag points to move them. Click a point to delete it (minimum 3 required).",-1))])):D("",!0),r("div",MD,[!M.value.polygon||M.value.polygon.length===0?(v(),g("button",{key:0,onClick:me,class:"btn btn-primary btn-full"}," Draw on map ")):(v(),g(Ae,{key:1},[r("button",{onClick:me,class:"btn btn-secondary"}," Redraw "),r("button",{onClick:J[3]||(J[3]=re=>S.value=!0),class:"btn btn-danger"}," Delete boundary ")],64))])])])):D("",!0),Me(Da,{show:S.value,title:"Delete boundary",message:"Are you sure you want to delete this boundary? This cannot be undone.","confirm-text":"Delete","is-danger":!0,onConfirm:z,onCancel:J[4]||(J[4]=re=>S.value=!1)},null,8,["show"]),f.value==="contacts"?(v(),g("div",AD,[r("div",ED,[r("h3",PD,I(N(a).area)+" contacts ("+I(Ne.value.length)+")",1),r("button",{onClick:J[5]||(J[5]=re=>T.value=!0),class:"btn btn-primary btn-small"}," Add contact ")]),Me(ug,{contacts:Ne.value,"show-remove-button":!0,"remove-title":Se,"empty-message":`No contacts assigned to this ${N(n).area}.`,"empty-hint":`Click 'Add contact' to assign contacts who will be visible to ${N(n).people} in this ${N(n).area}.`,onSelect:J[6]||(J[6]=re=>W.$emit("edit-contact",re)),onRemove:X,onUndoRemove:he},null,8,["contacts","empty-message","empty-hint"])])):D("",!0),Me(wD,{show:T.value,"area-name":M.value.name||"this "+N(n).area,"area-id":d.area?.id||"",contacts:d.contacts,marshals:d.marshals,"exclude-contact-ids":Ge.value,onClose:J[7]||(J[7]=re=>T.value=!1),onSelectContact:Ee,onCreateFromMarshal:K,onCreateNew:se},null,8,["show","area-name","area-id","contacts","marshals","exclude-contact-ids"]),f.value==="checkpoints"&&j.value?(v(),g("div",DD,[r("h3",RD,I(l())+" in "+I(e.area?.name)+" ("+I(pe.value.length)+")",1),Me(pg,{checkpoints:we.value,areas:e.areas,"empty-message":`No ${u()} in this ${N(n).area} yet.`,onSelect:J[8]||(J[8]=re=>W.$emit("select-checkpoint",re))},null,8,["checkpoints","areas","empty-message"])])):D("",!0),f.value==="checkpoints"&&!j.value?(v(),g("div",OD,[r("p",null,I(l())+" will be automatically assigned based on boundaries after the "+I(N(n).area)+" is created.",1)])):D("",!0),f.value==="checklists"&&j.value?(v(),Ke(_g,{key:5,ref_key:"checklistTabRef",ref:m,modelValue:y.value,"onUpdate:modelValue":J[9]||(J[9]=re=>y.value=re),"event-id":e.eventId,"area-id":e.area.id,locations:e.allLocations,areas:e.areas,assignments:ne.value,marshals:e.marshals,onChange:Te},null,8,["modelValue","event-id","area-id","locations","areas","assignments","marshals"])):D("",!0),f.value==="checklists"&&j.value?(v(),Ke(G8,{key:6,modelValue:_.value,"onUpdate:modelValue":J[10]||(J[10]=re=>_.value=re),onChange:Q},null,8,["modelValue"])):D("",!0),f.value==="checklists"&&!j.value?(v(),g("div",BD,[r("p",null,I(N(a).checklists)+" can be assigned after the "+I(N(n).area)+" is created.",1)])):D("",!0),f.value==="notes"&&j.value?(v(),Ke(Rc,{key:8,"event-id":e.eventId,"area-id":e.area?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.marshals},null,8,["event-id","area-id","all-notes","locations","areas","assignments","marshals"])):D("",!0),f.value==="notes"&&j.value?(v(),Ke(aD,{key:9,modelValue:$.value,"onUpdate:modelValue":J[11]||(J[11]=re=>$.value=re),onChange:Q},null,8,["modelValue"])):D("",!0),f.value==="notes"&&!j.value?(v(),g("div",ND,[r("p",null,"Notes can be viewed after the "+I(N(n).area)+" is created.",1)])):D("",!0),f.value==="appearance"?(v(),g("div",FD,[r("div",UD,[r("button",{type:"button",class:ve(["accordion-header",{expanded:B.value.polygonColor}]),onClick:J[12]||(J[12]=re=>R("polygonColor"))},[r("div",{class:"accordion-icon",innerHTML:U.value},null,8,zD),r("span",HD,I(N(a).area)+" polygon colour",1),r("span",VD,I(B.value.polygonColor?"":""),1)],2),B.value.polygonColor?(v(),g("div",GD,[r("p",qD," Choose a colour for this "+I(N(n).area)+"'s boundary on the map. ",1),r("div",jD,[(v(!0),g(Ae,null,Ue(N(Dn),re=>(v(),g("div",{key:re.hex,class:ve(["color-swatch",{selected:M.value.color===re.hex}]),style:Qe({backgroundColor:re.hex}),title:re.name,onClick:je=>ye(re.hex)},null,14,ZD))),128))])])):D("",!0)]),r("div",WD,[r("button",{type:"button",class:ve(["accordion-header",{expanded:B.value.iconStyle}]),onClick:J[13]||(J[13]=re=>R("iconStyle"))},[r("div",{class:"accordion-icon",innerHTML:F.value},null,8,KD),r("span",JD,I(l(!1))+" marker style",1),r("span",YD,I(B.value.iconStyle?"":""),1)],2),B.value.iconStyle?(v(),g("div",XD,[r("p",QD," Set a default marker style for all "+I(u())+" in this "+I(N(n).area)+". Individual "+I(u())+" can override this setting. ",1),Me(Gd,{"style-type":M.value.checkpointStyleType||"default","style-color":M.value.checkpointStyleColor||"","style-background-shape":M.value.checkpointStyleBackgroundShape||"","style-background-color":M.value.checkpointStyleBackgroundColor||"","style-border-color":M.value.checkpointStyleBorderColor||"","style-icon-color":M.value.checkpointStyleIconColor||"","style-size":M.value.checkpointStyleSize||"","style-map-rotation":M.value.checkpointStyleMapRotation??"","inherited-style-type":e.eventDefaultStyleType,"inherited-style-color":e.eventDefaultStyleColor,"inherited-background-shape":e.eventDefaultStyleBackgroundShape||"","inherited-background-color":e.eventDefaultStyleBackgroundColor||e.eventDefaultStyleColor||"","inherited-border-color":e.eventDefaultStyleBorderColor||"","inherited-icon-color":e.eventDefaultStyleIconColor||"","inherited-size":e.eventDefaultStyleSize||"","inherited-map-rotation":e.eventDefaultStyleMapRotation??"","default-label":"Event default","icon-label":"Marker style",level:"area","show-preview":!0,"onUpdate:styleType":J[14]||(J[14]=re=>Ce("checkpointStyleType",re)),"onUpdate:styleColor":J[15]||(J[15]=re=>Ce("checkpointStyleColor",re)),"onUpdate:styleBackgroundShape":J[16]||(J[16]=re=>Ce("checkpointStyleBackgroundShape",re)),"onUpdate:styleBackgroundColor":J[17]||(J[17]=re=>Ce("checkpointStyleBackgroundColor",re)),"onUpdate:styleBorderColor":J[18]||(J[18]=re=>Ce("checkpointStyleBorderColor",re)),"onUpdate:styleIconColor":J[19]||(J[19]=re=>Ce("checkpointStyleIconColor",re)),"onUpdate:styleSize":J[20]||(J[20]=re=>Ce("checkpointStyleSize",re)),"onUpdate:styleMapRotation":J[21]||(J[21]=re=>Ce("checkpointStyleMapRotation",re))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])])):D("",!0)]),r("div",eR,[r("button",{type:"button",class:ve(["accordion-header",{expanded:B.value.peopleTerm}]),onClick:J[22]||(J[22]=re=>R("peopleTerm"))},[J[30]||(J[30]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("circle",{cx:"12",cy:"8",r:"4",fill:"#6366F1"}),r("path",{d:"M4 20c0-4.4 3.6-8 8-8s8 3.6 8 8",fill:"#6366F1",opacity:"0.6"})])],-1)),r("span",tR,I(i())+" terminology",1),r("span",nR,I(M.value.peopleTerm||`${e.eventPeopleTerm} (event default)`),1),r("span",oR,I(B.value.peopleTerm?"":""),1)],2),B.value.peopleTerm?(v(),g("div",sR,[r("p",aR," Choose what "+I(i().toLowerCase())+" are called in this "+I(N(n).area)+". This will be inherited by "+I(u())+" unless they override it. ",1),r("div",iR,[J[31]||(J[31]=r("label",null,"What are people called?",-1)),ze(r("select",{"onUpdate:modelValue":J[23]||(J[23]=re=>M.value.peopleTerm=re),class:"form-input",onChange:Q},[r("option",lR,"Use event default ("+I(e.eventPeopleTerm)+")",1),(v(!0),g(Ae,null,Ue(N(Us).people,re=>(v(),g("option",{key:re,value:re},I(re),9,rR))),128))],544),[[zn,M.value.peopleTerm]])])])):D("",!0)]),r("div",cR,[r("button",{type:"button",class:ve(["accordion-header",{expanded:B.value.checkpointTerm}]),onClick:J[24]||(J[24]=re=>R("checkpointTerm"))},[J[32]||(J[32]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z",fill:"#10B981"}),r("circle",{cx:"12",cy:"9",r:"2.5",fill:"white"})])],-1)),r("span",uR,I(l(!1))+" terminology",1),r("span",dR,I(M.value.checkpointTerm?N(ld)(M.value.checkpointTerm,i()):`${e.eventCheckpointTerm} (event default)`),1),r("span",hR,I(B.value.checkpointTerm?"":""),1)],2),B.value.checkpointTerm?(v(),g("div",fR,[r("p",pR," Choose what "+I(u())+" are called in this "+I(N(n).area)+". ",1),r("div",vR,[r("label",null,"What are "+I(u())+" called?",1),ze(r("select",{"onUpdate:modelValue":J[25]||(J[25]=re=>M.value.checkpointTerm=re),class:"form-input",onChange:Q},[r("option",mR,"Use event default ("+I(e.eventCheckpointTerm)+")",1),(v(!0),g(Ae,null,Ue(N(Us).checkpoint,re=>(v(),g("option",{key:re,value:re},I(N(ld)(re,i())),9,gR))),128))],544),[[zn,M.value.checkpointTerm]])])])):D("",!0)])])):D("",!0),f.value==="incidents"?(v(),g("div",yR,[r("div",kR,[(v(!0),g(Ae,null,Ue(e.incidents,re=>(v(),Ke(vr,{key:re.incidentId,incident:re,onSelect:J[26]||(J[26]=je=>W.$emit("select-incident",je))},null,8,["incident"]))),128))])])):D("",!0)]),_:1},8,["show","title","is-dirty"]))}},CR=He(wR,[["__scopeId","data-v-1f35a436"]]),LR=["innerHTML"],SR={__name:"InfoModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Information"},message:{type:String,required:!0},okText:{type:String,default:"OK"}},emits:["close"],setup(e,{emit:t}){const o=t,a=()=>{o("close")};return(n,i)=>(v(),Ke(Ht,{show:e.show,title:e.title,size:"small","z-index":2e3,onClose:a},{actions:Fe(()=>[r("button",{onClick:a,class:"btn btn-primary"},I(e.okText),1)]),default:Fe(()=>[r("div",{class:"info-content",innerHTML:e.message},null,8,LR)]),_:1},8,["show","title"]))}},Oc=He(SR,[["__scopeId","data-v-a6e7148c"]]),IR={class:"tab-content"},xR={class:"form-group"},$R={for:"text"},TR=["placeholder"],MR={key:0,class:"checkbox-label-inline create-separate-items"},AR={class:"tab-content"},ER={class:"custom-footer"},PR={class:"footer-left"},DR={__name:"EditChecklistItemModal",props:{show:{type:Boolean,default:!1},checklistItem:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{termsLower:o,termsSentence:a}=ct(),n=e,i=t,l=A(!1),u=A(""),d=A("details"),h=A({text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0}),f=V(()=>!!n.checklistItem),m=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],y=V(()=>m.findIndex(E=>E.value===d.value)),k=V(()=>y.value===m.length-1),w=V(()=>k.value?"":m[y.value+1]?.label||"");We(()=>n.show,E=>{E&&(d.value=n.initialTab,n.checklistItem?h.value={text:n.checklistItem.text||"",scopeConfigurations:n.checklistItem.scopeConfigurations?JSON.parse(JSON.stringify(n.checklistItem.scopeConfigurations)):[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:n.checklistItem.displayOrder||0,isRequired:n.checklistItem.isRequired!==!1,visibleFrom:n.checklistItem.visibleFrom?S(n.checklistItem.visibleFrom):null,visibleUntil:n.checklistItem.visibleUntil?S(n.checklistItem.visibleUntil):null,mustCompleteBy:n.checklistItem.mustCompleteBy?S(n.checklistItem.mustCompleteBy):null,createSeparateItems:!1}:h.value={text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0},i("update:isDirty",!1))});const S=E=>{if(!E)return null;const B=new Date(E),R=B.getTimezoneOffset();return new Date(B.getTime()-R*60*1e3).toISOString().slice(0,16)},T=E=>E?new Date(E).toISOString():null,x=()=>{i("update:isDirty",!0)},C=()=>{i("close")},_=()=>{k.value||(d.value=m[y.value+1].value)},$=E=>{u.value=E,l.value=!0},M=()=>{if(!h.value.text||!h.value.text.trim()){$(`Please enter ${o.value.checklist} text`);return}if(!h.value.scopeConfigurations||h.value.scopeConfigurations.length===0){$("Please select at least one scope");return}if(!h.value.scopeConfigurations.some(R=>!(R.itemType!==null&&(!R.ids||R.ids.length===0)))){$("Please configure at least one scope with valid selections");return}const B={text:h.value.text,scopeConfigurations:h.value.scopeConfigurations,displayOrder:h.value.displayOrder||0,isRequired:h.value.isRequired,visibleFrom:T(h.value.visibleFrom),visibleUntil:T(h.value.visibleUntil),mustCompleteBy:T(h.value.mustCompleteBy)};f.value||(B.createSeparateItems=h.value.createSeparateItems),i("save",B)},H=()=>{i("delete",n.checklistItem.itemId)};return(E,B)=>(v(),g(Ae,null,[Me(Ht,{show:e.show,title:f.value?`Edit ${N(o).checklist}`:`Create ${N(o).checklist}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:C},{"tab-header":Fe(()=>[Me(fl,{modelValue:d.value,"onUpdate:modelValue":B[0]||(B[0]=R=>d.value=R),tabs:m},null,8,["modelValue"])]),footer:Fe(()=>[r("div",ER,[r("div",PR,[f.value?(v(),g("button",{key:0,type:"button",onClick:H,class:"btn btn-danger"}," Delete ")):D("",!0),!f.value&&!k.value?(v(),g("button",{key:1,type:"button",onClick:_,class:"btn btn-secondary mobile-only"},I(w.value)+"... ",1)):D("",!0)]),r("button",{type:"button",onClick:M,class:"btn btn-success"}," Save ")])]),default:Fe(()=>[r("form",{onSubmit:lt(M,["prevent"]),class:"checklist-form"},[ze(r("div",IR,[r("div",xR,[r("label",$R,I(N(a).checklist)+" text: *",1),ze(r("textarea",{id:"text","onUpdate:modelValue":B[1]||(B[1]=R=>h.value.text=R),onInput:x,required:"",rows:"3",placeholder:h.value.createSeparateItems?`Enter ${N(o).checklists}, one per line...`:`Enter the ${N(o).checklist} text...`},null,40,TR),[[nt,h.value.text]]),f.value?D("",!0):(v(),g("label",MR,[ze(r("input",{type:"checkbox","onUpdate:modelValue":B[2]||(B[2]=R=>h.value.createSeparateItems=R),onChange:x},null,544),[[Zs,h.value.createSeparateItems]]),B[5]||(B[5]=r("span",null,"Each line creates a new item",-1))]))])],512),[[ys,d.value==="details"]]),ze(r("div",AR,[Me(Dc,{modelValue:h.value.scopeConfigurations,"onUpdate:modelValue":B[3]||(B[3]=R=>h.value.scopeConfigurations=R),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":f.value,onUserChanged:x},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ys,d.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Me(Oc,{show:l.value,title:"Validation error",message:u.value,onClose:B[4]||(B[4]=R=>l.value=!1)},null,8,["show","message"])],64))}},RR=He(DR,[["__scopeId","data-v-eddaaf3c"]]),OR={class:"tab-content"},BR={class:"form-group"},NR={class:"form-group"},FR={class:"form-row"},UR={class:"form-group"},zR={class:"checkbox-label-inline show-emergency-checkbox"},HR={class:"form-group"},VR={class:"form-row"},GR={class:"form-group"},qR={class:"form-group checkbox-group-inline"},jR={class:"checkbox-label-inline"},ZR={class:"tab-content"},WR={class:"custom-footer"},KR={class:"footer-left"},JR={__name:"EditNoteModal",props:{show:{type:Boolean,default:!1},note:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,a=t,n=A(!1),i=A(""),l=A("details"),u=A({title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1}),d=$=>$==="Urgent"||$==="Emergency",h=V(()=>!!o.note),f=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],m=V(()=>f.findIndex($=>$.value===l.value)),y=V(()=>m.value===f.length-1),k=V(()=>y.value?"":f[m.value+1]?.label||"");We(()=>o.show,$=>{$&&(l.value=o.initialTab,o.note?u.value={title:o.note.title||"",content:o.note.content||"",scopeConfigurations:o.note.scopeConfigurations?JSON.parse(JSON.stringify(o.note.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:o.note.displayOrder||0,priority:o.note.priority||"Normal",category:o.note.category||"",isPinned:o.note.isPinned||!1,showInEmergencyInfo:o.note.showInEmergencyInfo??d(o.note.priority)}:u.value={title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1},a("update:isDirty",!1))}),We(()=>u.value.priority,($,M)=>{!h.value&&$!==M&&(d($)?u.value.showInEmergencyInfo=!0:d(M)&&(u.value.showInEmergencyInfo=!1))});const w=()=>{a("update:isDirty",!0)},S=()=>{a("close")},T=()=>{y.value||(l.value=f[m.value+1].value)},x=$=>{i.value=$,n.value=!0},C=()=>{if(!u.value.title||!u.value.title.trim()){x("Please enter a note title");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){x("Please select at least one visibility scope");return}if(!u.value.scopeConfigurations.some(H=>!(H.itemType!==null&&(!H.ids||H.ids.length===0)))){x("Please configure at least one scope with valid selections");return}const M={title:u.value.title.trim(),content:u.value.content||"",scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,priority:u.value.priority||"Normal",category:u.value.category?.trim()||null,isPinned:u.value.isPinned||!1,showInEmergencyInfo:u.value.showInEmergencyInfo};a("save",M)},_=()=>{a("delete",o.note.noteId)};return($,M)=>(v(),g(Ae,null,[Me(Ht,{show:e.show,title:h.value?"Edit note":"Create note",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:S},{"tab-header":Fe(()=>[Me(fl,{modelValue:l.value,"onUpdate:modelValue":M[0]||(M[0]=H=>l.value=H),tabs:f},null,8,["modelValue"])]),footer:Fe(()=>[r("div",WR,[r("div",KR,[h.value?(v(),g("button",{key:0,type:"button",onClick:_,class:"btn btn-danger"}," Delete ")):D("",!0),!h.value&&!y.value?(v(),g("button",{key:1,type:"button",onClick:T,class:"btn btn-secondary mobile-only"},I(k.value)+"... ",1)):D("",!0)]),r("button",{type:"button",onClick:C,class:"btn btn-success"}," Save ")])]),default:Fe(()=>[r("form",{onSubmit:lt(C,["prevent"]),class:"note-form"},[ze(r("div",OR,[r("div",BR,[M[10]||(M[10]=r("label",{for:"title"},"Title: *",-1)),ze(r("input",{id:"title","onUpdate:modelValue":M[1]||(M[1]=H=>u.value.title=H),type:"text",onInput:w,required:"",placeholder:"Enter note title..."},null,544),[[nt,u.value.title]])]),r("div",NR,[M[11]||(M[11]=r("label",{for:"content"},"Content:",-1)),ze(r("textarea",{id:"content","onUpdate:modelValue":M[2]||(M[2]=H=>u.value.content=H),onInput:w,rows:"6",placeholder:"Enter note content (supports markdown)..."},null,544),[[nt,u.value.content]])]),r("div",FR,[r("div",UR,[M[14]||(M[14]=r("label",{for:"priority"},"Priority:",-1)),ze(r("select",{id:"priority","onUpdate:modelValue":M[3]||(M[3]=H=>u.value.priority=H),onChange:w},[...M[12]||(M[12]=[r("option",{value:"Emergency"},"Emergency",-1),r("option",{value:"Urgent"},"Urgent",-1),r("option",{value:"High"},"High",-1),r("option",{value:"Normal"},"Normal",-1),r("option",{value:"Low"},"Low",-1)])],544),[[zn,u.value.priority]]),r("label",zR,[ze(r("input",{type:"checkbox","onUpdate:modelValue":M[4]||(M[4]=H=>u.value.showInEmergencyInfo=H),onChange:w},null,544),[[Zs,u.value.showInEmergencyInfo]]),M[13]||(M[13]=r("span",null,"Show in emergency info",-1))])]),r("div",HR,[M[15]||(M[15]=r("label",{for:"category"},"Category:",-1)),ze(r("input",{id:"category","onUpdate:modelValue":M[5]||(M[5]=H=>u.value.category=H),type:"text",onInput:w,placeholder:"e.g., Safety, Logistics..."},null,544),[[nt,u.value.category]])])]),r("div",VR,[r("div",GR,[M[16]||(M[16]=r("label",{for:"displayOrder"},"Display order:",-1)),ze(r("input",{id:"displayOrder","onUpdate:modelValue":M[6]||(M[6]=H=>u.value.displayOrder=H),type:"number",onInput:w,min:"0"},null,544),[[nt,u.value.displayOrder,void 0,{number:!0}]]),M[17]||(M[17]=r("span",{class:"help-text"},"Lower numbers appear first",-1))]),r("div",qR,[r("label",jR,[ze(r("input",{type:"checkbox","onUpdate:modelValue":M[7]||(M[7]=H=>u.value.isPinned=H),onChange:w},null,544),[[Zs,u.value.isPinned]]),M[18]||(M[18]=r("span",null,"Pin to top",-1))]),M[19]||(M[19]=r("span",{class:"help-text"},"Pinned notes always appear at the top",-1))])])],512),[[ys,l.value==="details"]]),ze(r("div",ZR,[Me(Dc,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":M[8]||(M[8]=H=>u.value.scopeConfigurations=H),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":h.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this note?",onUserChanged:w},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ys,l.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Me(Oc,{show:n.value,title:"Validation error",message:i.value,onClose:M[9]||(M[9]=H=>n.value=!1)},null,8,["show","message"])],64))}},YR=He(JR,[["__scopeId","data-v-e8488047"]]),XR={class:"incident-detail-header"},QR={class:"header-title-row"},eO={class:"modal-title"},tO={class:"header-badges"},nO=["disabled"],oO={key:0,class:"status-dropdown-menu"},sO=["onClick","disabled"],aO={key:0,class:"incident-detail-content"},iO={class:"accordion-section"},lO={class:"accordion-arrow"},rO={key:0,class:"accordion-content"},cO={class:"description-text"},uO={class:"accordion-section"},dO={class:"accordion-arrow"},hO={key:0,class:"accordion-content"},fO={class:"info-grid"},pO={class:"info-item"},vO={class:"info-value"},mO={class:"info-item"},gO={class:"info-value"},yO={key:0,class:"info-item"},kO={class:"info-label"},bO={class:"info-value"},_O={key:1,class:"info-item"},wO={class:"info-label"},CO={class:"info-value"},LO={key:2,class:"info-item"},SO={class:"info-value"},IO={key:0,class:"incident-map-container"},xO={class:"accordion-section"},$O={class:"accordion-preview"},TO={class:"accordion-arrow"},MO={key:0,class:"accordion-content"},AO={class:"reporter-info"},EO={class:"reporter-name"},PO={key:0,class:"accordion-section"},DO={class:"accordion-title"},RO={class:"accordion-preview"},OO={class:"accordion-arrow"},BO={key:0,class:"accordion-content"},NO={class:"marshals-list"},FO={class:"marshal-name"},UO={key:0,class:"checkin-badge success"},zO={key:1,class:"checkin-badge not-checked-in"},HO={class:"accordion-section"},VO={key:0,class:"accordion-preview"},GO={class:"accordion-arrow"},qO={key:0,class:"accordion-content"},jO={key:0,class:"notes-timeline"},ZO={class:"note-header"},WO={class:"note-author"},KO={class:"note-time"},JO={key:0,class:"note-status-change"},YO={key:1,class:"note-text"},XO={key:1,class:"no-notes"},QO={__name:"IncidentDetailModal",props:{show:{type:Boolean,required:!0},incident:{type:Object,default:null},canManage:{type:Boolean,default:!1},route:{type:Array,default:()=>[]},checkpoints:{type:Array,default:()=>[]}},emits:["close","status-change","open-add-note"],setup(e,{emit:t}){const{terms:o,termsSentence:a}=ct(),n=e,i=t,l=A(!1),u=A(!1),d=A(null),h=A({description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1});We(()=>n.show,U=>{U&&(h.value={description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1},u.value=!1)});const f=U=>{d.value&&!d.value.contains(U.target)&&(u.value=!1)};We(u,U=>{U?document.addEventListener("click",f):document.removeEventListener("click",f)});const m=()=>{u.value=!u.value},y=U=>{n.incident?.status!==U&&(u.value=!1,R(U))},k=U=>{const F=h.value[U];Object.keys(h.value).forEach(j=>{h.value[j]=!1}),F||(h.value[U]=!0)},w=V(()=>n.incident?.latitude!=null&&n.incident?.longitude!=null),S=V(()=>w.value?{lat:n.incident.latitude,lng:n.incident.longitude}:null),T=V(()=>w.value?{lat:n.incident.latitude,lng:n.incident.longitude}:null),x=V(()=>{if(!n.incident)return"Incident Details";if(n.incident.title)return n.incident.title;const U=n.incident.description||"";return U.length<=50?U:U.substring(0,47)+"..."}),C=V(()=>[...n.incident?.context?.marshalsPresentAtCheckpoint||[]].sort((F,j)=>(F.name||"").localeCompare(j.name||"",void 0,{sensitivity:"base"}))),_=[{value:"open",label:"Open"},{value:"acknowledged",label:"Acknowledged"},{value:"in_progress",label:"In Progress"},{value:"resolved",label:"Resolved"},{value:"closed",label:"Closed"}],$=U=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[U]||U,M=U=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[U]||U,H=U=>{if(!U)return"";let F=U.name||"";if(U.description){const j=U.description,Y=40,oe=j.length>Y?j.substring(0,Y-3)+"...":j;F+=` - ${oe}`}return F},E=U=>U?new Date(U).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",B=U=>{if(!U)return"";const F=new Date(U),Y=new Date-F,oe=Math.floor(Y/6e4),Oe=Math.floor(Y/36e5),ee=Math.floor(Y/864e5);return oe<1?"just now":oe<60?`${oe}m ago`:Oe<24?`${Oe}h ago`:ee<7?`${ee}d ago`:F.toLocaleDateString()},R=async U=>{if(n.incident?.status!==U){l.value=!0;try{i("status-change",{incidentId:n.incident.incidentId,status:U})}finally{l.value=!1}}};return(U,F)=>(v(),Ke(Ht,{show:e.show,title:x.value,size:"large",onClose:F[7]||(F[7]=j=>U.$emit("close"))},{header:Fe(()=>[r("div",XR,[r("div",QR,[r("span",{class:ve(["severity-indicator",e.incident?.severity])},null,2),r("h2",eO,I(x.value),1)]),r("div",tO,[r("span",{class:ve(["severity-badge",e.incident?.severity])},I($(e.incident?.severity)),3),e.canManage?(v(),g("div",{key:0,class:"status-dropdown-container",ref_key:"statusDropdownRef",ref:d},[r("button",{type:"button",class:ve(["status-badge status-dropdown-trigger",e.incident?.status]),onClick:m,disabled:l.value},[Ye(I(M(e.incident?.status))+" ",1),F[8]||(F[8]=r("span",{class:"dropdown-arrow"},"",-1))],10,nO),u.value?(v(),g("div",oO,[(v(),g(Ae,null,Ue(_,j=>r("button",{key:j.value,type:"button",class:ve(["status-dropdown-item",{active:e.incident?.status===j.value}]),onClick:Y=>y(j.value),disabled:e.incident?.status===j.value},[r("span",{class:ve(["status-dot",j.value])},null,2),Ye(" "+I(j.label),1)],10,sO)),64))])):D("",!0)],512)):(v(),g("span",{key:1,class:ve(["status-badge",e.incident?.status])},I(M(e.incident?.status)),3))])])]),footer:Fe(()=>[r("button",{class:"btn btn-secondary",onClick:F[6]||(F[6]=j=>U.$emit("close"))},"Close")]),default:Fe(()=>[e.incident?(v(),g("div",aO,[r("div",iO,[r("button",{type:"button",class:ve(["accordion-header",{expanded:h.value.description}]),onClick:F[0]||(F[0]=j=>k("description"))},[F[9]||(F[9]=r("span",{class:"accordion-title"},"Description",-1)),r("span",lO,I(h.value.description?"":""),1)],2),h.value.description?(v(),g("div",rO,[r("p",cO,I(e.incident.description),1)])):D("",!0)]),r("div",uO,[r("button",{type:"button",class:ve(["accordion-header",{expanded:h.value.timeLocation}]),onClick:F[1]||(F[1]=j=>k("timeLocation"))},[F[10]||(F[10]=r("span",{class:"accordion-title"},"Time & location",-1)),r("span",dO,I(h.value.timeLocation?"":""),1)],2),h.value.timeLocation?(v(),g("div",hO,[r("div",fO,[r("div",pO,[F[11]||(F[11]=r("span",{class:"info-label"},"Incident time",-1)),r("span",vO,I(E(e.incident.incidentTime)),1)]),r("div",mO,[F[12]||(F[12]=r("span",{class:"info-label"},"Reported at",-1)),r("span",gO,I(E(e.incident.createdAt)),1)]),e.incident.context?.checkpoint?(v(),g("div",yO,[r("span",kO,I(N(a).checkpoint),1),r("span",bO,I(H(e.incident.context.checkpoint)),1)])):D("",!0),e.incident.area?(v(),g("div",_O,[r("span",wO,I(N(a).area),1),r("span",CO,I(e.incident.area.areaName),1)])):D("",!0),w.value?(v(),g("div",LO,[F[13]||(F[13]=r("span",{class:"info-label"},"GPS location",-1)),r("span",SO,I(e.incident.latitude.toFixed(6))+", "+I(e.incident.longitude.toFixed(6)),1)])):D("",!0)]),w.value?(v(),g("div",IO,[Me(wi,{locations:e.checkpoints,route:e.route,center:S.value,zoom:15,"user-location":T.value,height:"200px"},null,8,["locations","route","center","user-location"])])):D("",!0)])):D("",!0)]),r("div",xO,[r("button",{type:"button",class:ve(["accordion-header",{expanded:h.value.reporter}]),onClick:F[2]||(F[2]=j=>k("reporter"))},[F[14]||(F[14]=r("span",{class:"accordion-title"},"Reported by",-1)),r("span",$O,I(e.incident.reportedBy?.name||"Unknown"),1),r("span",TO,I(h.value.reporter?"":""),1)],2),h.value.reporter?(v(),g("div",MO,[r("div",AO,[r("span",EO,I(e.incident.reportedBy?.name||"Unknown"),1)])])):D("",!0)]),C.value.length?(v(),g("div",PO,[r("button",{type:"button",class:ve(["accordion-header",{expanded:h.value.marshals}]),onClick:F[3]||(F[3]=j=>k("marshals"))},[r("span",DO,I(N(o).peoplePlural)+" at "+I(N(o).checkpoint.toLowerCase()),1),r("span",RO,I(C.value.length),1),r("span",OO,I(h.value.marshals?"":""),1)],2),h.value.marshals?(v(),g("div",BO,[r("div",NO,[(v(!0),g(Ae,null,Ue(C.value,j=>(v(),g("div",{key:j.marshalId,class:ve(["marshal-item",{"checked-in":j.wasCheckedIn}])},[r("span",FO,I(j.name),1),j.wasCheckedIn?(v(),g("span",UO," Checked in "+I(B(j.checkInTime)),1)):(v(),g("span",zO," Not checked in "))],2))),128))])])):D("",!0)])):D("",!0),r("div",HO,[r("button",{type:"button",class:ve(["accordion-header",{expanded:h.value.notes}]),onClick:F[4]||(F[4]=j=>k("notes"))},[F[15]||(F[15]=r("span",{class:"accordion-title"},"Updates",-1)),e.incident.updates?.length?(v(),g("span",VO,I(e.incident.updates.length),1)):D("",!0),r("span",GO,I(h.value.notes?"":""),1)],2),h.value.notes?(v(),g("div",qO,[e.incident.updates?.length?(v(),g("div",jO,[(v(!0),g(Ae,null,Ue(e.incident.updates,(j,Y)=>(v(),g("div",{key:Y,class:"note-item"},[r("div",ZO,[r("span",WO,I(j.authorName||"System"),1),r("span",KO,I(B(j.timestamp)),1)]),j.statusChange?(v(),g("div",JO,[F[16]||(F[16]=Ye(" Status changed to ",-1)),r("span",{class:ve(["status-badge",j.statusChange])},I(M(j.statusChange)),3)])):j.note?(v(),g("p",YO,I(j.note),1)):D("",!0)]))),128))])):(v(),g("div",XO," No updates yet. ")),r("button",{type:"button",class:"btn btn-primary add-note-btn",onClick:F[5]||(F[5]=j=>U.$emit("open-add-note"))}," Add update ")])):D("",!0)])])):D("",!0)]),_:1},8,["show","title"]))}},wg=He(QO,[["__scopeId","data-v-df0707d4"]]),eB={class:"form-group"},tB={class:"form-group"},nB={class:"form-row"},oB={class:"form-group form-group-half"},sB=["value"],aB={class:"form-group form-group-half"},iB={key:0,class:"form-group"},lB={for:"checkpoint",class:"form-label"},rB=["value"],cB={key:1,class:"form-group"},uB={class:"form-label"},dB={class:"checkpoint-toggle"},hB={class:"checkbox-label"},fB={class:"checkpoint-name"},pB={key:0,class:"checkpoint-description"},vB={class:"form-group"},mB={class:"location-options"},gB={class:"location-buttons"},yB={key:0,class:"location-status"},kB={key:0,class:"location-getting"},bB={key:1,class:"location-display"},_B={key:0,class:"location-accuracy"},wB={key:2,class:"location-error"},CB={key:1,class:"map-picker-container"},LB={key:0,class:"map-picker-hint"},SB={key:2,class:"location-display"},IB={key:2,class:"error-message"},xB={class:"modal-actions"},$B=["disabled"],TB={__name:"ReportIncidentModal",props:{show:{type:Boolean,required:!0},eventId:{type:String,required:!0},checkpoint:{type:Object,default:null},initialLocation:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]}},emits:["close","submit"],setup(e,{emit:t}){const{termsSentence:o}=ct(),a=e,n=t,i=A({title:"",description:"",severity:"medium",incidentTime:""}),l=A(""),u=A(!0),d=A("none"),h=A(!1),f=A(null),m=A(null),y=A(null),k=A(!1),w=A(!1),S=A(null),T=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],x=()=>{const j=new Date,Y=j.getFullYear(),oe=String(j.getMonth()+1).padStart(2,"0"),Oe=String(j.getDate()).padStart(2,"0"),ee=String(j.getHours()).padStart(2,"0"),te=String(j.getMinutes()).padStart(2,"0");return`${Y}-${oe}-${Oe}T${ee}:${te}`},C=j=>j?new Date(j).toISOString():null,_=V(()=>a.checkpoints||[]),$=V(()=>{if(f.value?.latitude!=null)return{lat:f.value.latitude,lng:f.value.longitude};if(l.value){const j=_.value.find(Y=>Y.id===l.value);if(j?.latitude!=null)return{lat:j.latitude,lng:j.longitude}}if(a.initialLocation?.latitude!=null)return{lat:a.initialLocation.latitude,lng:a.initialLocation.longitude};if(a.checkpoint?.latitude!=null)return{lat:a.checkpoint.latitude,lng:a.checkpoint.longitude};if(_.value.length>0){const j=_.value[0];if(j.latitude!=null)return{lat:j.latitude,lng:j.longitude}}if(a.route?.length>0){const j=a.route[0];if(j?.lat!=null)return{lat:j.lat,lng:j.lng}}return{lat:-33.9,lng:151.2}}),M=V(()=>i.value.description.trim()!==""),H=V(()=>i.value.description.trim()!=="");We(()=>a.show,j=>{j&&(i.value={title:"",description:"",severity:"medium",incidentTime:x()},l.value="",u.value=!0,w.value=!1,S.value=null,y.value=null,f.value=null,m.value=null,a.initialLocation&&a.initialLocation.latitude!=null?(f.value={latitude:a.initialLocation.latitude,longitude:a.initialLocation.longitude},m.value=a.initialLocation.accuracy,d.value="gps",h.value=!1):(d.value="none",h.value=!1),a.checkpoint&&(l.value=a.checkpoint.locationId||a.checkpoint.id||""))});const E=j=>{y.value=null,j==="map"?d.value==="map"?h.value=!h.value:(d.value="map",h.value=!0,m.value=null):j==="gps"?(d.value="gps",h.value=!1,R()):(d.value="none",h.value=!1,f.value=null,m.value=null)},B=j=>{f.value={latitude:j.lat,longitude:j.lng},m.value=null,h.value=!1},R=()=>{if(a.initialLocation&&a.initialLocation.latitude!=null){f.value={latitude:a.initialLocation.latitude,longitude:a.initialLocation.longitude},m.value=a.initialLocation.accuracy;return}if(!navigator.geolocation){y.value="GPS is not available on this device.";return}k.value=!0,navigator.geolocation.getCurrentPosition(j=>{f.value={latitude:j.coords.latitude,longitude:j.coords.longitude},m.value=j.coords.accuracy,k.value=!1},j=>{y.value="Unable to get your location.",k.value=!1},{enableHighAccuracy:!0,timeout:1e4})},U=async()=>{if(!(!H.value||w.value)){w.value=!0,S.value=null;try{const j=(d.value==="gps"||d.value==="map")&&f.value;let Y=null,oe=!1;_.value.length>0?l.value?Y=l.value:oe=!0:a.checkpoint&&(u.value?Y=a.checkpoint.locationId||a.checkpoint.id||null:oe=!0);const Oe={title:i.value.title.trim()||null,description:i.value.description.trim(),severity:i.value.severity,incidentTime:C(i.value.incidentTime),latitude:j?f.value.latitude:null,longitude:j?f.value.longitude:null,checkpointId:Y,skipCheckpointAutoAssign:oe};n("submit",Oe)}catch(j){S.value=j.message||"Failed to report incident. Please try again.",w.value=!1}}},F=()=>{n("close")};return(j,Y)=>(v(),Ke(Ht,{show:e.show,title:"Report Incident",size:"medium","confirm-on-close":!0,"is-dirty":M.value,onClose:F},{footer:Fe(()=>[r("div",xB,[r("button",{type:"button",class:"btn btn-secondary",onClick:F}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:U,disabled:!H.value||w.value},I(w.value?"Reporting...":"Report Incident"),9,$B)])]),default:Fe(()=>[r("form",{onSubmit:lt(U,["prevent"]),class:"incident-form"},[r("div",eB,[Y[10]||(Y[10]=r("label",{for:"title",class:"form-label"},"Title",-1)),ze(r("input",{id:"title","onUpdate:modelValue":Y[0]||(Y[0]=oe=>i.value.title=oe),type:"text",class:"form-input",placeholder:"Brief summary (optional)"},null,512),[[nt,i.value.title]])]),r("div",tB,[Y[11]||(Y[11]=r("label",{for:"description",class:"form-label"},[Ye("Description "),r("span",{class:"required"},"*")],-1)),ze(r("textarea",{id:"description","onUpdate:modelValue":Y[1]||(Y[1]=oe=>i.value.description=oe),class:"form-input form-textarea",placeholder:"Describe what happened...",rows:"3",required:""},null,512),[[nt,i.value.description]])]),r("div",nB,[r("div",oB,[Y[12]||(Y[12]=r("label",{for:"severity",class:"form-label"},"Severity",-1)),ze(r("select",{id:"severity","onUpdate:modelValue":Y[2]||(Y[2]=oe=>i.value.severity=oe),class:"form-input form-select"},[(v(),g(Ae,null,Ue(T,oe=>r("option",{key:oe.value,value:oe.value},I(oe.label),9,sB)),64))],512),[[zn,i.value.severity]])]),r("div",aB,[Y[13]||(Y[13]=r("label",{for:"incidentTime",class:"form-label"},"When",-1)),ze(r("input",{id:"incidentTime","onUpdate:modelValue":Y[3]||(Y[3]=oe=>i.value.incidentTime=oe),type:"datetime-local",class:"form-input"},null,512),[[nt,i.value.incidentTime]])])]),_.value.length>0?(v(),g("div",iB,[r("label",lB,I(N(o).checkpoint),1),ze(r("select",{id:"checkpoint","onUpdate:modelValue":Y[4]||(Y[4]=oe=>l.value=oe),class:"form-input form-select"},[Y[14]||(Y[14]=r("option",{value:""},"-- None / Unknown --",-1)),(v(!0),g(Ae,null,Ue(_.value,oe=>(v(),g("option",{key:oe.id,value:oe.id},I(oe.name)+I(oe.description?` - ${oe.description}`:""),9,rB))),128))],512),[[zn,l.value]])])):e.checkpoint?(v(),g("div",cB,[r("label",uB,I(N(o).checkpoint),1),r("div",dB,[r("label",hB,[ze(r("input",{type:"checkbox","onUpdate:modelValue":Y[5]||(Y[5]=oe=>u.value=oe)},null,512),[[Zs,u.value]]),r("span",fB,I(e.checkpoint.name),1),e.checkpoint.description?(v(),g("span",pB," - "+I(e.checkpoint.description),1)):D("",!0)])])])):D("",!0),r("div",vB,[Y[15]||(Y[15]=r("label",{class:"form-label"},"Location (optional)",-1)),r("div",mB,[r("div",gB,[r("button",{type:"button",class:ve(["location-btn",{active:d.value==="gps"}]),onClick:Y[6]||(Y[6]=oe=>E("gps"))}," GPS ",2),r("button",{type:"button",class:ve(["location-btn",{active:d.value==="map"}]),onClick:Y[7]||(Y[7]=oe=>E("map"))}," Pick on map ",2),r("button",{type:"button",class:ve(["location-btn",{active:d.value==="none"}]),onClick:Y[8]||(Y[8]=oe=>E("none"))}," None ",2)]),d.value==="gps"?(v(),g("div",yB,[k.value?(v(),g("div",kB," Getting location... ")):f.value&&f.value.latitude!=null?(v(),g("div",bB,[r("span",null,I(f.value.latitude.toFixed(5))+", "+I(f.value.longitude.toFixed(5)),1),m.value?(v(),g("span",_B,"("+I(Math.round(m.value))+"m)",1)):D("",!0)])):y.value?(v(),g("div",wB,I(y.value),1)):D("",!0)])):D("",!0),d.value==="map"?(v(),g("div",CB,[h.value?(v(),g("div",LB,"Tap to select location")):D("",!0),h.value?(v(),Ke(wi,{key:1,locations:_.value,route:e.route,center:$.value,zoom:14,mode:"select-point","user-location":e.initialLocation,"highlight-location-id":l.value,height:"150px",onPointSelected:B},null,8,["locations","route","center","user-location","highlight-location-id"])):D("",!0),f.value&&f.value.latitude!=null?(v(),g("div",SB,[r("span",null,I(f.value.latitude.toFixed(5))+", "+I(f.value.longitude.toFixed(5)),1),h.value?D("",!0):(v(),g("button",{key:0,type:"button",class:"location-edit-btn",onClick:Y[9]||(Y[9]=oe=>h.value=!0)},"Edit"))])):D("",!0)])):D("",!0)])]),S.value?(v(),g("div",IB,I(S.value),1)):D("",!0)],32)]),_:1},8,["show","is-dirty"]))}},Cg=He(TB,[["__scopeId","data-v-20b520b6"]]),MB={class:"tab-content"},AB={key:0,class:"form-group"},EB={for:"marshalId"},PB=["value"],DB={class:"help-text"},RB={key:1,class:"form-group"},OB={class:"linked-marshal-info"},BB={class:"linked-marshal-name"},NB={class:"linked-marshal-hint"},FB={key:2,class:"form-group"},UB={class:"form-group"},zB={key:0,class:"selected-roles"},HB=["onClick"],VB={class:"role-input-group"},GB={key:0,label:"Built-in Roles"},qB=["value"],jB={key:1,label:"Custom Roles"},ZB=["value"],WB=["onKeydown"],KB=["disabled"],JB={class:"checkbox-label-inline show-emergency-checkbox"},YB={class:"form-row"},XB={class:"form-group"},QB={class:"form-group"},eN={class:"form-group"},tN={class:"form-row"},nN={class:"form-group"},oN={class:"form-group checkbox-group-inline"},sN={class:"checkbox-label-inline"},aN={class:"tab-content"},iN={class:"custom-footer"},lN={class:"footer-left"},rN=["disabled"],cN={__name:"EditContactModal",props:{show:{type:Boolean,default:!1},contact:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},isDirty:{type:Boolean,default:!1},preselectedArea:{type:Object,default:null},prefilledName:{type:String,default:""},prefilledMarshalId:{type:String,default:null},createFromAreaContext:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{terms:o}=ct(),a=e,n=t,i=A(!1),l=A(""),u=A("details"),d=A(!1),h=A(""),f=A(""),m=A({roles:[],name:"",phone:"",email:"",notes:"",marshalId:null,showInEmergencyInfo:!1,displayOrder:0,isPinned:!1,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}),y=te=>te==="EmergencyContact",k=V(()=>(a.availableRoles.builtInRoles||[]).filter(te=>!m.value.roles.includes(te))),w=V(()=>(a.availableRoles.customRoles||[]).filter(te=>!m.value.roles.includes(te))),S=()=>{h.value&&!m.value.roles.includes(h.value)&&(m.value.roles.push(h.value),y(h.value)&&(m.value.showInEmergencyInfo=!0),U()),h.value=""},T=()=>{const te=f.value.trim();te&&!m.value.roles.includes(te)&&(m.value.roles.push(te),U()),f.value=""},x=te=>{const O=m.value.roles.indexOf(te);O>-1&&(m.value.roles.splice(O,1),y(te)&&!m.value.roles.some(Z=>y(Z))&&(m.value.showInEmergencyInfo=!1),U())},C=V(()=>!!a.contact),_=V(()=>a.createFromAreaContext?[{value:"details",label:"Details"}]:[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}]),$=V(()=>!!m.value.marshalId),M=V(()=>!C.value&&!!a.prefilledMarshalId),H=V(()=>C.value&&!!a.contact?.marshalId),E=V(()=>a.contact?.marshalId?a.marshals.find(O=>O.id===a.contact.marshalId)?.name||"Unknown":""),B=V(()=>[...a.marshals].sort((te,O)=>Ws(te.name,O.name)));We(()=>a.show,te=>{if(te){if(u.value=a.initialTab,h.value="",f.value="",a.contact){let O=[];a.contact.roles&&Array.isArray(a.contact.roles)?O=[...a.contact.roles]:a.contact.role&&(O=[a.contact.role]),d.value=!1,m.value={roles:O,name:a.contact.name||"",phone:a.contact.phone||"",email:a.contact.email||"",notes:a.contact.notes||"",marshalId:a.contact.marshalId||null,showInEmergencyInfo:a.contact.showInEmergencyInfo??O.some(Z=>y(Z)),displayOrder:a.contact.displayOrder||0,isPinned:a.contact.isPinned||!1,scopeConfigurations:a.contact.scopeConfigurations?JSON.parse(JSON.stringify(a.contact.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}}else{d.value=!1;let O;a.createFromAreaContext?O=[]:a.preselectedArea?O=[{scope:"EveryoneInAreas",itemType:"Area",ids:[a.preselectedArea.id]}]:O=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}];let Z={name:a.prefilledName||"",phone:"",email:""};if(a.prefilledMarshalId){const ne=a.marshals.find(pe=>pe.id===a.prefilledMarshalId);ne&&(Z={name:ne.name||"",phone:ne.phoneNumber||"",email:ne.email||""})}m.value={roles:[],name:Z.name,phone:Z.phone,email:Z.email,notes:"",marshalId:a.prefilledMarshalId||null,showInEmergencyInfo:!1,displayOrder:0,isPinned:!1,scopeConfigurations:O}}n("update:isDirty",!1)}});const R=te=>te?te==="AreaLead"?`${o.value.area} Lead`:te.replace(/([A-Z])/g," $1").replace(/^./,O=>O.toUpperCase()).trim():"",U=()=>{n("update:isDirty",!0)},F=()=>{if(m.value.marshalId){const te=a.marshals.find(O=>O.id===m.value.marshalId);te&&(m.value.name=te.name,!m.value.phone&&te.phoneNumber&&(m.value.phone=te.phoneNumber),!m.value.email&&te.email&&(m.value.email=te.email))}U()},j=()=>{n("close")},Y=()=>{if(!m.value.roles||m.value.roles.length===0){oe("Please select or enter at least one role");return}if(!m.value.name||!m.value.name.trim()){oe("Please enter a contact name");return}u.value="visibility"},oe=te=>{l.value=te,i.value=!0},Oe=()=>{if(!m.value.roles||m.value.roles.length===0){oe("Please select or enter at least one role");return}if(!m.value.name||!m.value.name.trim()){oe("Please enter a contact name");return}if(!a.createFromAreaContext){if(!m.value.scopeConfigurations||m.value.scopeConfigurations.length===0){oe("Please select at least one visibility scope");return}if(!m.value.scopeConfigurations.some(Z=>!(Z.itemType!==null&&(!Z.ids||Z.ids.length===0)))){oe("Please configure at least one scope with valid selections");return}}const te={roles:m.value.roles,name:m.value.name.trim(),phone:m.value.phone?.trim()||null,email:m.value.email?.trim()||null,notes:m.value.notes?.trim()||null,marshalId:m.value.marshalId||null,showInEmergencyInfo:m.value.showInEmergencyInfo,displayOrder:m.value.displayOrder||0,isPinned:m.value.isPinned||!1,scopeConfigurations:m.value.scopeConfigurations};n("save",te)},ee=()=>{n("delete",a.contact.contactId)};return(te,O)=>(v(),g(Ae,null,[Me(Ht,{show:e.show,title:C.value?"Edit contact":"Create contact",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:j},{"tab-header":Fe(()=>[Me(fl,{modelValue:u.value,"onUpdate:modelValue":O[0]||(O[0]=Z=>u.value=Z),tabs:_.value},null,8,["modelValue","tabs"])]),footer:Fe(()=>[r("div",iN,[r("div",lN,[C.value?(v(),g("button",{key:0,type:"button",onClick:ee,class:"btn btn-danger"}," Delete ")):D("",!0),!C.value&&u.value==="details"?(v(),g("button",{key:1,type:"button",onClick:Y,class:"btn btn-secondary mobile-only"}," Visibility... ")):D("",!0)]),r("button",{type:"button",onClick:Oe,class:"btn btn-success",disabled:C.value&&!e.isDirty}," Save ",8,rN)])]),default:Fe(()=>[r("form",{onSubmit:lt(Oe,["prevent"]),class:"contact-form"},[ze(r("div",MB,[!M.value&&!H.value?(v(),g("div",AB,[r("label",EB,"Link to "+I(N(o).person.toLowerCase())+":",1),ze(r("select",{id:"marshalId","onUpdate:modelValue":O[1]||(O[1]=Z=>m.value.marshalId=Z),onChange:F},[O[14]||(O[14]=r("option",{value:null},"-- Not linked --",-1)),(v(!0),g(Ae,null,Ue(B.value,Z=>(v(),g("option",{key:Z.id,value:Z.id},I(Z.name),9,PB))),128))],544),[[zn,m.value.marshalId]]),r("span",DB,"Optionally link to an existing "+I(N(o).person.toLowerCase())+" in the system",1)])):D("",!0),H.value?(v(),g("div",RB,[r("label",null,"Linked "+I(N(o).person.toLowerCase())+":",1),r("div",OB,[r("span",BB,I(E.value),1),r("span",NB,"Contact details are synced with this "+I(N(o).person.toLowerCase()),1)])])):D("",!0),$.value?D("",!0):(v(),g("div",FB,[O[15]||(O[15]=r("label",{for:"name"},"Name: *",-1)),ze(r("input",{id:"name","onUpdate:modelValue":O[2]||(O[2]=Z=>m.value.name=Z),type:"text",onInput:U,placeholder:"Contact name..."},null,544),[[nt,m.value.name]])])),r("div",UB,[O[18]||(O[18]=r("label",null,"Roles: *",-1)),m.value.roles.length>0?(v(),g("div",zB,[(v(!0),g(Ae,null,Ue(m.value.roles,Z=>(v(),g("span",{key:Z,class:"role-pill"},[Ye(I(R(Z))+" ",1),r("button",{type:"button",class:"remove-role-btn",onClick:ne=>x(Z),title:"Remove role"},"",8,HB)]))),128))])):D("",!0),r("div",VB,[d.value?ze((v(),g("input",{key:1,id:"customRole","onUpdate:modelValue":O[4]||(O[4]=Z=>f.value=Z),type:"text",placeholder:"Enter custom role name...",onKeydown:To(lt(T,["prevent"]),["enter"])},null,40,WB)),[[nt,f.value]]):ze((v(),g("select",{key:0,id:"role","onUpdate:modelValue":O[3]||(O[3]=Z=>h.value=Z),onChange:S},[O[16]||(O[16]=r("option",{value:"",disabled:""},"Add a role...",-1)),k.value.length>0?(v(),g("optgroup",GB,[(v(!0),g(Ae,null,Ue(k.value,Z=>(v(),g("option",{key:Z,value:Z},I(R(Z)),9,qB))),128))])):D("",!0),w.value.length>0?(v(),g("optgroup",jB,[(v(!0),g(Ae,null,Ue(w.value,Z=>(v(),g("option",{key:Z,value:Z},I(R(Z)),9,ZB))),128))])):D("",!0)],544)),[[zn,h.value]]),d.value?(v(),g("button",{key:2,type:"button",class:"add-role-btn",onClick:T,disabled:!f.value.trim()}," Add ",8,KB)):D("",!0),r("button",{type:"button",class:"toggle-custom-btn",onClick:O[5]||(O[5]=Z=>d.value=!d.value)},I(d.value?"Use existing":"Custom"),1)]),r("label",JB,[ze(r("input",{type:"checkbox","onUpdate:modelValue":O[6]||(O[6]=Z=>m.value.showInEmergencyInfo=Z),onChange:U},null,544),[[Zs,m.value.showInEmergencyInfo]]),O[17]||(O[17]=r("span",null,"Show in emergency info",-1))])]),r("div",YB,[r("div",XB,[O[19]||(O[19]=r("label",{for:"phone"},"Phone:",-1)),ze(r("input",{id:"phone","onUpdate:modelValue":O[7]||(O[7]=Z=>m.value.phone=Z),type:"tel",onInput:U,placeholder:"Phone number..."},null,544),[[nt,m.value.phone]])]),r("div",QB,[O[20]||(O[20]=r("label",{for:"email"},"Email:",-1)),ze(r("input",{id:"email","onUpdate:modelValue":O[8]||(O[8]=Z=>m.value.email=Z),type:"email",onInput:U,placeholder:"Email address..."},null,544),[[nt,m.value.email]])])]),r("div",eN,[O[21]||(O[21]=r("label",{for:"notes"},"Notes / Instructions:",-1)),ze(r("textarea",{id:"notes","onUpdate:modelValue":O[9]||(O[9]=Z=>m.value.notes=Z),onInput:U,rows:"3",placeholder:"Additional notes or instructions for when to contact..."},null,544),[[nt,m.value.notes]])]),r("div",tN,[r("div",nN,[O[22]||(O[22]=r("label",{for:"displayOrder"},"Display order:",-1)),ze(r("input",{id:"displayOrder","onUpdate:modelValue":O[10]||(O[10]=Z=>m.value.displayOrder=Z),type:"number",onInput:U,min:"0"},null,544),[[nt,m.value.displayOrder,void 0,{number:!0}]]),O[23]||(O[23]=r("span",{class:"help-text"},"Lower numbers appear first",-1))]),r("div",oN,[r("label",sN,[ze(r("input",{type:"checkbox","onUpdate:modelValue":O[11]||(O[11]=Z=>m.value.isPinned=Z),onChange:U},null,544),[[Zs,m.value.isPinned]]),O[24]||(O[24]=r("span",null,"Pin to top",-1))]),O[25]||(O[25]=r("span",{class:"help-text"},"Pinned contacts always appear at the top",-1))])])],512),[[ys,u.value==="details"]]),ze(r("div",aN,[Me(Dc,{modelValue:m.value.scopeConfigurations,"onUpdate:modelValue":O[12]||(O[12]=Z=>m.value.scopeConfigurations=Z),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":C.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this contact?",onUserChanged:U},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ys,u.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Me(Oc,{show:i.value,title:"Validation error",message:l.value,onClose:O[13]||(O[13]=Z=>i.value=!1)},null,8,["show","message"])],64))}},uN=He(cN,[["__scopeId","data-v-ee15647d"]]),dN={key:0,class:"fullscreen-map-overlay"},hN={class:"fullscreen-map-header"},fN={class:"context-info"},pN={key:0},vN={class:"action-buttons"},mN=["disabled"],gN={class:"fullscreen-map-container"},yN={key:0,class:"drawing-controls"},kN={class:"point-count"},bN={class:"undo-redo-buttons"},_N=["disabled"],wN=["disabled"],CN=Object.assign({inheritAttrs:!1},{__name:"FullscreenMapOverlay",props:{show:{type:Boolean,required:!0},mode:{type:String,validator:e=>["place-checkpoint","move-checkpoint","draw-area","add-multiple","view"].includes(e)},contextTitle:{type:String,default:""},contextDescription:{type:String,default:""},canComplete:{type:Boolean,default:!1},drawingMode:{type:Boolean,default:!1}},emits:["done","cancel","map-click","polygon-complete","polygon-drawing","location-click","area-click"],setup(e,{emit:t}){const o=e,a=t,n=A(null),i=A(0),l=A(!1),u=A(!1),d=()=>{a("done")},h=()=>{a("cancel")},f=S=>{i.value=S?.length||0,m(),a("polygon-drawing",S)},m=()=>{n.value&&(l.value=n.value.canUndo(),u.value=n.value.canRedo())},y=()=>{n.value&&(n.value.undoPolygonPoint(),m())},k=()=>{n.value&&(n.value.redoPolygonPoint(),m())};We(()=>o.show,S=>{S||(i.value=0,l.value=!1,u.value=!1)});const w=S=>{S.key==="Escape"&&o.show&&h(),o.show&&o.drawingMode&&((S.ctrlKey||S.metaKey)&&S.key==="z"&&!S.shiftKey?(S.preventDefault(),y()):(S.ctrlKey||S.metaKey)&&(S.key==="y"||S.key==="z"&&S.shiftKey)&&(S.preventDefault(),k()))};return ln(()=>{document.addEventListener("keydown",w)}),Ln(()=>{document.removeEventListener("keydown",w)}),(S,T)=>(v(),Ke(Kl,{to:"body"},[e.show?(v(),g("div",dN,[r("div",hN,[r("div",fN,[r("h3",null,I(e.contextTitle),1),e.contextDescription?(v(),g("p",pN,I(e.contextDescription),1)):D("",!0)]),r("div",vN,[e.mode==="view"?(v(),g("button",{key:0,onClick:h,class:"btn btn-done"}," Close ")):(v(),g(Ae,{key:1},[r("button",{onClick:h,class:"btn btn-cancel"}," Cancel "),r("button",{onClick:d,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,mN)],64))])]),r("div",gN,[Me(dd,Jv({ref_key:"mapViewRef",ref:n,"drawing-mode":e.drawingMode},S.$attrs,{onMapClick:T[0]||(T[0]=x=>S.$emit("map-click",x)),onPolygonComplete:T[1]||(T[1]=x=>S.$emit("polygon-complete",x)),onPolygonDrawing:f,onLocationClick:T[2]||(T[2]=x=>S.$emit("location-click",x)),onAreaClick:T[3]||(T[3]=x=>S.$emit("area-click",x))}),null,16,["drawing-mode"]),e.drawingMode&&i.value>0?(v(),g("div",yN,[r("div",kN,I(i.value)+" point"+I(i.value!==1?"s":""),1),r("div",bN,[r("button",{onClick:y,class:"btn-drawing undo-btn",disabled:!l.value,title:"Undo last point"},"  Undo ",8,_N),r("button",{onClick:k,class:"btn-drawing redo-btn",disabled:!u.value,title:"Redo point"}," Redo  ",8,wN)])])):D("",!0)])])):D("",!0)]))}}),LN=He(CN,[["__scopeId","data-v-9ce62b55"]]),SN={class:"form-group"},IN={class:"form-group"},xN={class:"form-group"},$N={key:0,class:"form-error"},TN={class:"form-row"},MN={class:"form-group",style:{flex:"1"}},AN={class:"form-group",style:{flex:"1"}},EN={class:"form-group",style:{flex:"0 0 auto"}},PN={class:"form-group"},DN={__name:"AddLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:()=>({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""})},isDirty:{type:Boolean,default:!1}},emits:["close","save","set-on-map","update:isDirty","update:location"],setup(e,{emit:t}){const{termsLower:o}=ct(),a=e,n=t,i=A({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""});We(()=>a.location,h=>{h&&(i.value={...h})},{immediate:!0,deep:!0});const l=()=>{n("update:isDirty",!0),n("update:location",{...i.value})},u=()=>{if(!ac(i.value.what3Words)&&i.value.what3Words){alert("Invalid What3Words format.");return}n("save",i.value)},d=()=>{n("close")};return(h,f)=>(v(),Ke(Ht,{show:e.show,title:`Add ${N(o).checkpoint}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:Fe(()=>[r("button",{type:"button",onClick:d,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:u,class:"btn btn-primary"}," Add "+I(N(o).checkpoint),1)]),default:Fe(()=>[r("form",{onSubmit:lt(u,["prevent"])},[r("div",SN,[f[7]||(f[7]=r("label",null,"Name",-1)),ze(r("input",{"onUpdate:modelValue":f[0]||(f[0]=m=>i.value.name=m),type:"text",required:"",class:"form-input",onInput:l},null,544),[[nt,i.value.name]])]),r("div",IN,[f[8]||(f[8]=r("label",null,"Description",-1)),ze(r("input",{"onUpdate:modelValue":f[1]||(f[1]=m=>i.value.description=m),type:"text",class:"form-input",onInput:l},null,544),[[nt,i.value.description]])]),r("div",xN,[f[9]||(f[9]=r("label",null,"What3Words (optional)",-1)),ze(r("input",{"onUpdate:modelValue":f[2]||(f[2]=m=>i.value.what3Words=m),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap",onInput:l},null,544),[[nt,i.value.what3Words]]),i.value.what3Words&&!N(ac)(i.value.what3Words)?(v(),g("small",$N," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):D("",!0)]),r("div",TN,[r("div",MN,[f[10]||(f[10]=r("label",null,"Longitude",-1)),ze(r("input",{"onUpdate:modelValue":f[3]||(f[3]=m=>i.value.longitude=m),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[nt,i.value.longitude,void 0,{number:!0}]])]),r("div",AN,[f[11]||(f[11]=r("label",null,"Latitude",-1)),ze(r("input",{"onUpdate:modelValue":f[4]||(f[4]=m=>i.value.latitude=m),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[nt,i.value.latitude,void 0,{number:!0}]])]),r("div",EN,[f[12]||(f[12]=r("label",null,"",-1)),r("button",{type:"button",class:"icon-btn",title:"Set location on map",onClick:f[5]||(f[5]=m=>h.$emit("set-on-map"))},"  ")])]),r("div",PN,[r("label",null,"Required "+I(N(o).people),1),ze(r("input",{"onUpdate:modelValue":f[6]||(f[6]=m=>i.value.requiredMarshals=m),type:"number",min:"1",required:"",class:"form-input",onInput:l},null,544),[[nt,i.value.requiredMarshals,void 0,{number:!0}]])])],32)]),_:1},8,["show","title","is-dirty"]))}},RN=He(DN,[["__scopeId","data-v-fb51fed0"]]),ON=["aria-expanded","title"],BN=["innerHTML"],NN={key:0,class:"dropdown-menu"},FN=["onClick"],UN=["innerHTML"],zN={__name:"ThemeToggle",setup(e){const{theme:t,isDark:o,setTheme:a}=sg(),n=A(!1),i=A(null),l={light:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
  </svg>`,dark:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
  </svg>`,system:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
    <line x1="8" y1="21" x2="16" y2="21"></line>
    <line x1="12" y1="17" x2="12" y2="21"></line>
  </svg>`},u=[{value:"system",label:"System",icon:l.system},{value:"light",label:"Light",icon:l.light},{value:"dark",label:"Dark",icon:l.dark}],d=V(()=>o.value?l.dark:l.light),h=()=>{n.value=!n.value},f=y=>{a(y),n.value=!1},m=y=>{i.value&&!i.value.contains(y.target)&&(n.value=!1)};return ln(()=>{document.addEventListener("click",m)}),Ln(()=>{document.removeEventListener("click",m)}),(y,k)=>(v(),g("div",{class:"theme-dropdown",ref_key:"dropdownRef",ref:i},[r("button",{class:"theme-toggle-btn",onClick:h,type:"button","aria-expanded":n.value,title:N(o)?"Dark mode":"Light mode"},[r("span",{class:"theme-icon",innerHTML:d.value},null,8,BN)],8,ON),n.value?(v(),g("div",NN,[(v(),g(Ae,null,Ue(u,w=>r("button",{key:w.value,class:ve(["dropdown-item",{active:N(t)===w.value}]),onClick:S=>f(w.value)},[r("span",{class:"option-icon",innerHTML:w.icon},null,8,UN),r("span",null,I(w.label),1)],10,FN)),64))])):D("",!0)],512))}},HN=He(zN,[["__scopeId","data-v-969124a4"]]),VN={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"app-logo"},GN=["id"],qN=["filter"],jN={__name:"AppLogo",props:{size:{type:[Number,String],default:48},animate:{type:Boolean,default:!1}},setup(e){G1(o=>({v1c2199cd:typeof e.size=="number"?e.size+"px":e.size}));const t=V(()=>`discShadow-${Math.random().toString(36).substr(2,9)}`);return(o,a)=>(v(),g("svg",VN,[r("defs",null,[r("filter",{id:t.value,x:"-20%",y:"-20%",width:"140%",height:"140%"},[...a[0]||(a[0]=[r("feDropShadow",{dx:"0",dy:"6",stdDeviation:"8","flood-color":"#000","flood-opacity":"0.25"},null,-1)])],8,GN)]),r("ellipse",{cx:"256",cy:"400",rx:"220",ry:"70",fill:"#667eea",filter:`url(#${t.value})`},null,8,qN),a[2]||(a[2]=r("ellipse",{cx:"256",cy:"394",rx:"185",ry:"55",fill:"none",stroke:"rgba(255,255,255,0.3)","stroke-width":"4"},null,-1)),r("g",{class:ve({"marshal-figure":e.animate})},[...a[1]||(a[1]=[r("circle",{cx:"256",cy:"160",r:"55",fill:"currentColor"},null,-1),r("path",{d:"M365 380 v-30 a55 55 0 0 0-55-55 H202 a55 55 0 0 0-55 55 v30",fill:"currentColor"},null,-1)])],2)]))}},ZN=He(jN,[["__scopeId","data-v-3e647831"]]),WN={class:"header"},KN={class:"header-left"},JN={key:0},YN={class:"event-date"},XN={class:"header-actions"},QN={class:"container"},e9={class:"tabs-nav"},t9={class:"tab-content-wrapper"},n9={class:"add-note-form"},o9={class:"modal-footer-actions"},s9=["disabled"],a9=6e4,i9={__name:"AdminEventManage",setup(e){const t=$c(),o=cl(),a=eg(),n=V(()=>t.params.eventId),{activeTab:i,switchTab:l}=tg("details",["details","course","areas","checkpoints","marshals","notes","checklists","contacts","settings"]),{showConfirmModal:u,confirmModalTitle:d,confirmModalMessage:h,confirmModalIsDanger:f,confirmModalConfirmText:m,showConfirm:y,handleConfirmModalConfirm:k,handleConfirmModalCancel:w}=dw(),{tabLabels:S,terms:T,termsLower:x}=ct(),C=hw(),_=pw(n),$=fw(n),{colorScheme:M}=sg(),H=V(()=>[{value:"details",label:"Event details",icon:"details"},{value:"course",label:S.value.course,icon:"course"},{value:"areas",label:S.value.areas,icon:"area"},{value:"checkpoints",label:S.value.checkpoints,icon:"checkpoint"},{value:"marshals",label:S.value.marshals,icon:"marshal"},{value:"notes",label:"Notes",icon:"notes"},{value:"incidents",label:"Incidents",icon:"incidents"},{value:"checklists",label:S.value.checklists,icon:"checklist"},{value:"contacts",label:"Contacts",icon:"contacts"},{value:"settings",label:"Settings",icon:"settings"}]),E=A(null),B=A([]),R=A([]),U=A({marshals:0,areas:0,checkpoints:0,checklists:0,notes:0,incidents:0,contacts:0}),F=A(null),j=A(!1),Y=A(!1),oe=A(null),Oe=A(null),ee=A(!1),te=A(!1),O=A(null),Z=A(""),ne=$.eventAdmins,pe=$.showAddAdmin,we=_.showUploadRoute,Ze=_.uploading,Ne=_.uploadError,Ge=_.showImportLocations,Xe=_.showImportMarshals,Q=_.importing,ye=_.importingMarshals,Ce=_.importError,me=_.importResult,ie=_.importMarshalsResult,z=A(!1),K=A(!1),se=A({id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Ee=A(!1),Be=A(!1),Re=A({marshalName:"",locations:[],marshal:null}),Se=A(null),X=A([]),he=A(!1),Te=A(null),xe=A(null),be=A(null),de=A({}),fe=A({id:"",name:"",email:"",phoneNumber:"",notes:""}),W=A(!1),J=A([]),re=A([]),je=A([]),et=A([]),dt=A(!1),kt=A(""),gt=A(""),St=A({name:"",description:"",eventDate:"",timeZoneId:"UTC",peopleTerm:"Marshals",defaultCheckpointStyleBackgroundShape:"",defaultCheckpointStyleBackgroundColor:"",defaultCheckpointStyleBorderColor:"",defaultCheckpointStyleIconColor:"",defaultCheckpointStyleSize:"",defaultCheckpointStyleMapRotation:"",checkpointTerm:"Checkpoints",areaTerm:"Areas",checklistTerm:"Checklists",courseTerm:"Course",defaultCheckpointStyleType:"default",defaultCheckpointStyleColor:""}),Lt=A(!1),Dt=A(!1),Vt=A(""),ht=A(""),Gt=A(0),pn=A({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Et=A([]),_t=A(null),Vn=A(!1),kn=A("details"),Qn=A(null),co=A(null),Wt=A(null),ns=C.isAddingMultipleCheckpoints,Sn=C.multiCheckpointCounter,bo=C.isFullscreenMapActive,ce=C.fullscreenMode,ue=C.fullscreenContext,ke=C.tempLocationCoords,st=C.tempCheckpoints,qe=C.savedMapCenter,Tt=C.savedMapZoom,Kt=C.isDrawingAreaBoundary,en=A(null),Eo=A([]),Gn=A(null),ks=A(!1),_o=A("details"),Ba=A(null),bs=A([]),Po=A(null),Ys=A(!1),Na=A("details"),In=A([]),Fa=A(!1),vn=A(null),wo=A(!1),Do=A(!1),Ua=A(!1),Ro=A(""),Xs=A(!1),eo=A([]),Co=A({builtInRoles:[],customRoles:[]}),xn=A(null),uo=A(!1),to=A("details"),mt=A(null),It=A(""),ho=A(null),fo=A(null),qn=V(()=>fo.value?.marshalId!=null),_s=()=>{o.push(`/event/${t.params.eventId}`)},pt=V(()=>`${window.location.origin}/#/event/${t.params.eventId}`),qt=V(()=>{const G=[];return R.value.forEach(le=>{le.assignments&&G.push(...le.assignments)}),G}),Qs=V(()=>{if(!Te.value)return R.value;const G=Te.value.assignedLocationIds||[],le=je.value.map(_e=>_e.locationId),ge=et.value;return R.value.filter(_e=>!G.includes(_e.id)&&!le.includes(_e.id)||ge.includes(_e.id))}),ws=V(()=>{let G=X.value;if(F.value){const le=F.value.assignments.map(_e=>_e.marshalName),ge=J.value.map(_e=>_e.marshalName);G=X.value.filter(_e=>!le.includes(_e.name)&&!ge.includes(_e.name))}return G.slice().sort((le,ge)=>le.name.localeCompare(ge.name))}),An=V(()=>ce.value==="draw-area"&&_t.value?.polygon?.length>0||C.canCompleteFullscreen.value),pl=V(()=>ce.value==="move-checkpoint"&&F.value?.id?F.value.id:null),Cs=V(()=>{const G=[...R.value];return ce.value==="place-checkpoint"&&ke.value&&G.push({id:"temp-single",name:pn.value.name||"New Checkpoint",latitude:ke.value.lat,longitude:ke.value.lng,requiredMarshals:pn.value.requiredMarshals||1,assignments:[],isTemporary:!0}),ce.value==="move-checkpoint"&&ke.value&&F.value&&G.push({id:"temp-move",name:F.value.name+" (new position)",latitude:ke.value.lat,longitude:ke.value.lng,requiredMarshals:F.value.requiredMarshals,assignments:[],isTemporary:!0}),ce.value==="add-multiple"&&G.push(...st.value),G}),Oo=V(()=>{let G=[...Et.value];return ce.value==="draw-area"&&_t.value?.id&&(G=G.filter(le=>le.id!==_t.value.id)),ce.value==="draw-area"&&_t.value?.polygon?.length>0&&G.push({..._t.value,id:_t.value.id||"temp-area"}),G}),jt=V(()=>{if(!Te.value||!In.value.length)return[];const G=Te.value.id,le=Te.value.assignedLocationIds||[];return In.value.filter(ge=>{if(ge.reportedBy?.marshalId===G)return!0;const _e=ge.context?.checkpoint?.checkpointId;return!!(_e&&le.includes(_e))}).sort((ge,_e)=>new Date(_e.incidentTime||_e.createdAt)-new Date(ge.incidentTime||ge.createdAt))}),Lo=V(()=>{if(!F.value||!In.value.length)return[];const G=F.value.id;return In.value.filter(le=>le.context?.checkpoint?.checkpointId===G).sort((le,ge)=>new Date(ge.incidentTime||ge.createdAt)-new Date(le.incidentTime||le.createdAt))}),Bo=V(()=>{if(!_t.value||!In.value.length)return[];const G=_t.value.id,le=R.value.filter(ge=>ge.areaIds&&ge.areaIds.includes(G)).map(ge=>ge.id);return In.value.filter(ge=>{const _e=ge.context?.checkpoint?.checkpointId;return _e&&le.includes(_e)}).sort((ge,_e)=>new Date(_e.incidentTime||_e.createdAt)-new Date(ge.incidentTime||ge.createdAt))}),os=G=>{vn.value=G,wo.value=!0},za=G=>{vn.value=G,wo.value=!0},Ls=G=>{vn.value=G,wo.value=!0},Ha=()=>{o.push("/sessions")},Jt=(G=!0)=>{W.value=G},No=()=>{Lt.value=!0},Ss=async G=>{try{G&&(St.value={...G});const le=sr(E.value.eventDate),ge=St.value.eventDate;if(le!==ge){const _e=B.value.filter(at=>at.startTime||at.endTime);if(_e.length>0){Vt.value=le,ht.value=ge,Gt.value=_e.length,Dt.value=!0;return}}await jn(!1,null)}catch(le){console.error("Failed to update event:",le),alert("Failed to update event. Please try again.")}},jn=async(G,le)=>{try{if(await a.updateEvent(t.params.eventId,{...St.value,defaultCheckpointStyleMapRotation:St.value.defaultCheckpointStyleMapRotation!=null?String(St.value.defaultCheckpointStyleMapRotation):null}),G&&le!==null){const ge=Math.floor(Math.abs(le)/1e3),_e=le<0,at=Math.floor(ge/3600),bt=Math.floor(ge%3600/60),Mt=ge%60,_n=`${_e?"-":""}${at.toString().padStart(2,"0")}:${bt.toString().padStart(2,"0")}:${Mt.toString().padStart(2,"0")}`;await a.bulkUpdateLocationTimes(t.params.eventId,_n)}await En(),Lt.value=!1}catch(ge){console.error("Failed to update event:",ge),alert("Failed to update event. Please try again.")}},ea=async({shouldShift:G,timeDelta:le})=>{Dt.value=!1,await jn(G,le)},ta=()=>{Dt.value=!1,En()},En=async()=>{try{await a.fetchEvent(t.params.eventId),E.value=a.currentEvent,E.value&&(St.value={name:E.value.name||"",description:E.value.description||"",eventDate:sr(E.value.eventDate),timeZoneId:E.value.timeZoneId||"UTC",peopleTerm:E.value.peopleTerm||"Marshals",checkpointTerm:E.value.checkpointTerm||"Checkpoints",areaTerm:E.value.areaTerm||"Areas",checklistTerm:E.value.checklistTerm||"Checklists",courseTerm:E.value.courseTerm||"Course",defaultCheckpointStyleType:E.value.defaultCheckpointStyleType||"default",defaultCheckpointStyleColor:E.value.defaultCheckpointStyleColor||"",defaultCheckpointStyleBackgroundShape:E.value.defaultCheckpointStyleBackgroundShape||"",defaultCheckpointStyleBackgroundColor:E.value.defaultCheckpointStyleBackgroundColor||"",defaultCheckpointStyleBorderColor:E.value.defaultCheckpointStyleBorderColor||"",defaultCheckpointStyleIconColor:E.value.defaultCheckpointStyleIconColor||"",defaultCheckpointStyleSize:E.value.defaultCheckpointStyleSize||"",defaultCheckpointStyleMapRotation:E.value.defaultCheckpointStyleMapRotation??"",brandingHeaderGradientStart:E.value.brandingHeaderGradientStart||"",brandingHeaderGradientEnd:E.value.brandingHeaderGradientEnd||"",brandingLogoUrl:E.value.brandingLogoUrl||"",brandingLogoPosition:E.value.brandingLogoPosition||"",brandingAccentColor:E.value.brandingAccentColor||"",brandingPageGradientStart:E.value.brandingPageGradientStart||"",brandingPageGradientEnd:E.value.brandingPageGradientEnd||""},Lt.value=!1,rd(E.value));const G=await Promise.allSettled([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId),xs(),na(),it(),Yt(),xt(),ss(),mn()]);B.value=a.locations,R.value=a.eventStatus.locations,G.forEach((le,ge)=>{le.status==="rejected"&&console.error(`Failed to load ${["locations","eventStatus","admins","marshals","areas","checklists","notes","contacts"][ge]}:`,le.reason)})}catch(G){console.error("Failed to load event data:",G)}},na=async()=>{try{const G=await gs.getByEvent(t.params.eventId);X.value=G.data,U.value.marshals=Date.now()}catch(G){console.error("Failed to load marshals:",G)}},it=async()=>{try{const G=await Fs.getByEvent(t.params.eventId);Et.value=G.data,U.value.areas=Date.now()}catch(G){console.error("Failed to load areas:",G)}},Yt=async()=>{try{const[G,le]=await Promise.all([Ut.getByEvent(t.params.eventId),Ut.getReport(t.params.eventId)]);Eo.value=G.data,Ba.value=le.data,U.value.checklists=Date.now()}catch(G){console.error("Failed to load checklists:",G)}},xt=async()=>{try{const G=await fs.getByEvent(t.params.eventId);bs.value=G.data,U.value.notes=Date.now()}catch(G){console.error("Failed to load notes:",G)}},ss=async()=>{Fa.value=!0;try{const G=await vs.getAll(t.params.eventId);In.value=G.data.incidents||[],U.value.incidents=Date.now()}catch(G){console.error("Failed to load incidents:",G)}finally{Fa.value=!1}},mn=async()=>{try{const[G,le]=await Promise.all([_a.getByEvent(t.params.eventId),_a.getRoles(t.params.eventId)]);eo.value=G.data,Co.value=le.data,U.value.contacts=Date.now()}catch(G){console.error("Failed to load contacts:",G)}},oa=async()=>{await Promise.all([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId)]),B.value=a.locations,U.value.checkpoints=Date.now(),R.value=a.eventStatus.locations},sa=async()=>{await Promise.all([na(),a.fetchEventStatus(t.params.eventId)]),R.value=a.eventStatus.locations},So=async()=>{await Promise.all([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId),it()]),B.value=a.locations,R.value=a.eventStatus.locations},Va=async()=>{await a.fetchEventStatus(t.params.eventId),R.value=a.eventStatus.locations},as=()=>{_t.value=null,kn.value="details",W.value=!1,Vn.value=!0},tn=G=>{_t.value=G,co.value=G.id,kn.value="details",W.value=!1,Vn.value=!0},Fo=async G=>{try{let le;if(_t.value&&_t.value.id){if(le=_t.value.id,await Fs.update(t.params.eventId,le,G),G.checklistChanges&&G.checklistChanges.length>0)for(const ge of G.checklistChanges)try{ge.complete?await Ut.complete(t.params.eventId,ge.itemId,{marshalId:ge.marshalId,contextType:ge.contextType,contextId:ge.contextId}):await Ut.uncomplete(t.params.eventId,ge.itemId,{marshalId:ge.marshalId,contextType:ge.contextType,contextId:ge.contextId})}catch(_e){console.error("Failed to update checklist item:",ge,_e)}}else le=(await Fs.create({eventId:t.params.eventId,...G})).data.id;if(G.pendingContacts&&G.pendingContacts.length>0&&le)for(const ge of G.pendingContacts)try{const _e=ge.scopeConfigurations?JSON.parse(JSON.stringify(ge.scopeConfigurations)):[],at=_e.find(bt=>bt.scope==="EveryoneInAreas"&&bt.itemType==="Area");at?(at.ids||(at.ids=[]),at.ids.includes(le)||at.ids.push(le)):_e.push({scope:"EveryoneInAreas",itemType:"Area",ids:[le]}),await _a.update(t.params.eventId,ge.contactId,{...ge,scopeConfigurations:_e})}catch(_e){console.error("Failed to add area to contact:",ge,_e)}if(G.contactsToRemove&&G.contactsToRemove.length>0&&le)for(const ge of G.contactsToRemove)try{const _e=eo.value.find(Mt=>Mt.contactId===ge);if(!_e)continue;const at=_e.scopeConfigurations?JSON.parse(JSON.stringify(_e.scopeConfigurations)):[],bt=at.find(Mt=>Mt.scope==="EveryoneInAreas"&&Mt.itemType==="Area");if(bt&&bt.ids){bt.ids=bt.ids.filter(_n=>_n!==le);const Mt=bt.ids.length>0?at:at.filter(_n=>!(_n.scope==="EveryoneInAreas"&&_n.itemType==="Area"));await _a.update(t.params.eventId,ge,{..._e,scopeConfigurations:Mt})}}catch(_e){console.error("Failed to remove area from contact:",ge,_e)}if((G.pendingContacts&&G.pendingContacts.length>0||G.contactsToRemove&&G.contactsToRemove.length>0)&&await mn(),G.pendingNewChecklistItems&&G.pendingNewChecklistItems.length>0&&le){for(const ge of G.pendingNewChecklistItems)if(ge.text?.trim())try{await Ut.create(t.params.eventId,{text:ge.text,scopeConfigurations:[{scope:"EveryoneInAreas",itemType:"Area",ids:[le]}],displayOrder:0,isRequired:!1})}catch(_e){console.error("Failed to create checklist item:",ge,_e)}await Yt()}if(G.pendingNewNotes&&G.pendingNewNotes.length>0&&le){for(const ge of G.pendingNewNotes)if(!(!ge.title?.trim()&&!ge.content?.trim()))try{await fs.create(t.params.eventId,{title:ge.title||"Untitled",content:ge.content||"",scopeConfigurations:[{scope:"EveryoneInAreas",itemType:"Area",ids:[le]}],displayOrder:0,priority:"Normal",isPinned:!1})}catch(_e){console.error("Failed to create note:",ge,_e)}await xt()}await it(),await En(),is()}catch(le){console.error("Failed to save area:",le),alert(le.response?.data?.message||"Failed to save area. Please try again.")}},Ga=async G=>{y(`Delete ${x.value.area}`,`Are you sure you want to delete this ${x.value.area}? ${T.value.checkpoints} will be automatically reassigned.`,async()=>{try{await Fs.delete(t.params.eventId,G),await Fs.recalculate(t.params.eventId),await it(),await En(),is()}catch(le){console.error(`Failed to delete ${x.value.area}:`,le),alert(le.response?.data?.message||`Failed to delete ${x.value.area}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},is=()=>{Vn.value=!1,_t.value=null,co.value=null,W.value=!1,Kt.value=!1,Wt.value=null},vl=({marshal:G,area:le})=>{xn.value=null,to.value="details",W.value=!1,mt.value=le,It.value="",ho.value=G.id,uo.value=!0},Si=({name:G,area:le})=>{xn.value=null,to.value="details",W.value=!1,mt.value=le,It.value=G,ho.value=null,uo.value=!0},Uo=G=>{xn.value=G,to.value="details",W.value=!1,uo.value=!0},qa=()=>{Gn.value=null,_o.value="details",W.value=!1,ks.value=!0},Ii=(G,le="details")=>{Gn.value=G,_o.value=le,W.value=!1,ks.value=!0},wt=async G=>{try{const le={...G,scopeConfigurations:cu(G.scopeConfigurations,{areas:Et.value,locations:R.value,marshals:X.value})};if(Gn.value&&Gn.value.itemId)await Ut.update(t.params.eventId,Gn.value.itemId,le);else{const ge=await Ut.create(t.params.eventId,le);ge.data.count&&ge.data.count>1&&(kt.value="Checklist Items Created",gt.value=`Successfully created ${ge.data.count} checklist items.`,dt.value=!0)}await Yt(),gn()}catch(le){console.error("Failed to save checklist item:",le);const ge=le.response?.data?.message||"Failed to save checklist item. Please try again.";alert(ge)}},Is=async G=>{y(`Delete ${x.value.checklist}`,`Are you sure you want to delete this ${x.value.checklist}?`,async()=>{try{await Ut.delete(t.params.eventId,G),await Yt(),gn()}catch(le){console.error(`Failed to delete ${x.value.checklist}:`,le),alert(le.response?.data?.message||`Failed to delete ${x.value.checklist}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},gn=()=>{ks.value=!1,Gn.value=null,W.value=!1},no=()=>{Po.value=null,Na.value="details",W.value=!1,Ys.value=!0},aa=G=>{Po.value=G,Na.value="details",W.value=!1,Ys.value=!0},xi=async G=>{try{const le={...G,scopeConfigurations:cu(G.scopeConfigurations,{areas:Et.value,locations:R.value,marshals:X.value})};Po.value&&Po.value.noteId?await fs.update(t.params.eventId,Po.value.noteId,le):await fs.create(t.params.eventId,le),await xt(),la()}catch(le){console.error("Failed to save note:",le);const ge=le.response?.data?.message||"Failed to save note. Please try again.";alert(ge)}},ia=async G=>{y("Delete note","Are you sure you want to delete this note?",async()=>{try{await fs.delete(t.params.eventId,G),await xt(),la()}catch(le){console.error("Failed to delete note:",le),alert(le.response?.data?.message||"Failed to delete note. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},la=()=>{Ys.value=!1,Po.value=null,W.value=!1},$i=()=>{Do.value=!0},ml=async G=>{try{await vs.create(t.params.eventId,G),Do.value=!1,await ss()}catch(le){console.error("Failed to report incident:",le),alert(le.response?.data?.message||"Failed to report incident. Please try again.")}},Ti=G=>{vn.value=G,wo.value=!0},ja=()=>{wo.value=!1,vn.value=null},gl=async({incidentId:G,status:le})=>{try{if(await vs.updateStatus(t.params.eventId,G,{status:le}),await ss(),vn.value?.incidentId===G){const ge=In.value.find(_e=>_e.incidentId===G);ge&&(vn.value=ge)}}catch(ge){console.error("Failed to update incident status:",ge),alert(ge.response?.data?.message||"Failed to update status. Please try again.")}},oo=()=>{Ro.value="",Ua.value=!0},ra=()=>{Ua.value=!1,Ro.value=""},Za=async()=>{if(!(!Ro.value.trim()||!vn.value)){Xs.value=!0;try{await vs.addNote(t.params.eventId,vn.value.incidentId,Ro.value.trim()),ra(),await ss();const G=In.value.find(le=>le.incidentId===vn.value.incidentId);G&&(vn.value=G)}catch(G){console.error("Failed to add note to incident:",G),alert(G.response?.data?.message||"Failed to add note. Please try again.")}finally{Xs.value=!1}}},Io=()=>{xn.value=null,to.value="details",mt.value=null,W.value=!1,uo.value=!0},ca=G=>{xn.value=G,to.value="details",W.value=!1,uo.value=!0},Wa=async G=>{try{const le={...G,scopeConfigurations:cu(G.scopeConfigurations,{areas:Et.value,locations:R.value,marshals:X.value})};let ge=null;const _e=!xn.value||!xn.value.contactId,at=!!mt.value;if(xn.value&&xn.value.contactId)await _a.update(t.params.eventId,xn.value.contactId,le);else{const bt=await _a.create(t.params.eventId,le);ge=bt.data?.contactId||bt.data?.id}if(await mn(),_e&&at&&ge&&Qn.value){const bt=eo.value.find(Mt=>Mt.contactId===ge);bt&&Qn.value.addPendingContact(bt)}Ja()}catch(le){console.error("Failed to save contact:",le);const ge=le.response?.data?.message||"Failed to save contact. Please try again.";alert(ge)}},Ka=async G=>{y("Delete contact","Are you sure you want to delete this contact?",async()=>{try{await _a.delete(t.params.eventId,G),await mn(),Qn.value&&Qn.value.removeContactById(G),Ja()}catch(le){console.error("Failed to delete contact:",le),alert(le.response?.data?.message||"Failed to delete contact. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Ja=()=>{uo.value=!1,xn.value=null,mt.value=null,It.value="",ho.value=null,W.value=!1},Mi=G=>{Wt.value={...G,id:_t.value?.id};const le={...G,id:_t.value?.id,polygon:[]};_t.value=le;let ge=!1;if(G.polygon&&G.polygon.length>0){const _e=G.polygon.map($n=>$n.lat||$n[0]),at=G.polygon.map($n=>$n.lng||$n[1]),bt=Math.min(..._e),Mt=Math.max(..._e),_n=Math.min(...at),va=Math.max(...at);qe.value={lat:(bt+Mt)/2,lng:(_n+va)/2};const Hi=Mt-bt,Ts=va-_n,ma=Math.max(Hi,Ts);Tt.value=ma<.005?17:ma<.01?16:ma<.02?15:ma<.05?14:13,ge=!0}if(!ge&&G.checkpointIds&&G.checkpointIds.length>0){const _e=R.value.filter(at=>G.checkpointIds.includes(at.id));if(_e.length>0){const at=_e.map(Mt=>Mt.latitude).filter(Boolean),bt=_e.map(Mt=>Mt.longitude).filter(Boolean);if(at.length>0&&bt.length>0){const Mt=Math.min(...at),_n=Math.max(...at),va=Math.min(...bt),Hi=Math.max(...bt);qe.value={lat:(Mt+_n)/2,lng:(va+Hi)/2};const Ts=_n-Mt,ma=Hi-va,$n=Math.max(Ts,ma);Tt.value=$n<.005?16:$n<.01?15:$n<.02?14:$n<.05?13:12,ge=!0}}}if(!ge&&oe.value){const _e=oe.value.getMapCenter(),at=oe.value.getMapZoom();_e&&at!==null&&(qe.value=_e,Tt.value=at)}bo.value=!0,ce.value="draw-area",Kt.value=!0,ue.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},ua=G=>{Wt.value?_t.value={..._t.value||{},...Wt.value,polygon:G}:_t.value={..._t.value,polygon:G}},Ai=G=>{C.handlePolygonDrawing(G)},Ei=()=>{Kt.value=!1,Wt.value&&(_t.value=Wt.value,Vn.value=!0,Wt.value=null)},xs=()=>$.loadEventAdmins(),$e=async G=>{try{await $.addAdmin(G),await xs(),tt()}catch(le){console.error("Failed to add admin:",le),alert(le.response?.data?.message||"Failed to add administrator. Please try again.")}},Ie=async G=>{y("Remove administrator",`Remove ${G} as an administrator?`,async()=>{try{await $.removeAdmin(G),await xs()}catch(le){console.error("Failed to remove admin:",le),alert(le.response?.data?.message||"Failed to remove administrator. Please try again.")}},{isDanger:!0,confirmText:"Remove"})},tt=()=>{$.closeAddAdminModal(),W.value=!1},ft=async G=>{await _.uploadRoute(G)&&(await oa(),Bt())},Bt=()=>{_.closeUploadRouteModal()},$t=async({file:G,deleteExisting:le})=>{const ge=await _.importLocations(G,le);if(ge){await So(),nn();const _e=_.formatImportResultMessage(ge,"location");kt.value="Import Complete",gt.value=_e,dt.value=!0}},nn=()=>{_.closeImportLocationsModal()},Qt=async G=>{if(Y.value)pn.value.latitude=G.lat,pn.value.longitude=G.lng;else if(K.value)se.value.latitude=G.lat,se.value.longitude=G.lng,F.value&&(F.value={...F.value,latitude:G.lat,longitude:G.lng}),K.value=!1,z.value=!0,Jt();else if(ns.value)try{await a.createLocation({eventId:t.params.eventId,name:`Checkpoint ${Sn.value}`,description:"",latitude:G.lat,longitude:G.lng,requiredMarshals:1,what3Words:""}),Sn.value++,await En()}catch(le){console.error("Failed to create checkpoint:",le),alert("Failed to create checkpoint. Please try again.")}},Nt=G=>{C.handleFullscreenMapClick(G)},bn=G=>{pn.value={...G}},Pt=()=>{Y.value=!1,C.enterPlaceCheckpointMode()},on=()=>{C.saveMapState(oe.value),pn.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},C.enterPlaceCheckpointMode()},Pn=()=>{C.saveMapState(oe.value),bo.value=!0,ce.value="view",ue.value={title:"Course map",description:""}},ls=()=>{C.saveMapState(oe.value),_t.value={id:null,name:"",description:"",color:"#667eea",polygon:[],checkpointIds:[],marshalIds:[],displayOrder:Et.value.length},C.enterDrawAreaMode()},po=()=>{F.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},se.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},J.value=[],re.value=[],W.value=!1,z.value=!0},Ya=()=>{const G=C.calculateStartingNumber(R);C.saveMapState(oe.value),C.enterAddMultipleMode(G)},yl=()=>{if(ce.value==="place-checkpoint"){const G=C.getPlacedCoords()||{lat:0,lng:0};F.value={id:null,name:"",description:"",latitude:G.lat,longitude:G.lng,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},se.value={id:null,name:"",description:"",latitude:G.lat,longitude:G.lng,requiredMarshals:1,what3Words:""},J.value=[],re.value=[],W.value=!1,Pi(),z.value=!0}else if(ce.value==="move-checkpoint"){const G=C.getPlacedCoords();G&&(se.value.latitude=G.lat,se.value.longitude=G.lng,F.value&&(F.value={...F.value,...en.value||{},latitude:G.lat,longitude:G.lng}),Jt()),en.value=null,Pi(),z.value=!0}else if(ce.value==="draw-area"){const G=C.getCompletedPolygon();G&&(Wt.value?_t.value={..._t.value||{},...Wt.value,polygon:G}:_t.value={..._t.value||{},polygon:G}),Wt.value=null,Pi()}else ce.value==="add-multiple"&&vo()},vo=async()=>{const G=C.getTempCheckpoints();try{for(const le of G)await a.createLocation({eventId:t.params.eventId,name:le.name,description:le.description,latitude:le.latitude,longitude:le.longitude,requiredMarshals:le.requiredMarshals,what3Words:le.what3Words});C.clearTempCheckpoints(),Pi(),await En()}catch(le){console.error("Failed to create checkpoints:",le),alert("Failed to create checkpoints. Please try again.")}},da=()=>{ce.value==="draw-area"?Wt.value&&(_t.value=Wt.value,Wt.value=null):ce.value==="move-checkpoint"&&(en.value&&F.value&&Object.assign(F.value,en.value),z.value=!0,K.value=!1),C.cancelFullscreen()},Pi=()=>{C.exitFullscreen()},zo=G=>{Di(G)},Di=G=>{F.value=G,se.value={id:G.id,name:G.name,description:G.description||"",latitude:G.latitude,longitude:G.longitude,requiredMarshals:G.requiredMarshals,what3Words:G.what3Words||""},J.value=[],re.value=[],W.value=!1,z.value=!0,setTimeout(()=>{oe.value?.scrollMapIntoView()},100)},ha=async G=>{if(!ac(G.what3Words)){alert("Invalid What3Words format. Please use word.word.word or word/word/word (lowercase letters only, 1-20 characters each)");return}try{await a.createLocation({eventId:t.params.eventId,...G}),await En(),mr()}catch(le){console.error("Failed to save location:",le),alert("Failed to save location. Please try again.")}},mr=()=>{Y.value=!1,pn.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},W.value=!1,W.value=!1},$s=()=>{z.value=!1,F.value=null,j.value=!1,K.value=!1,Ee.value=!1,en.value=null,se.value={id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},J.value=[],re.value=[],W.value=!1},Ri=()=>{Ee.value=!1},Oi=()=>{Ee.value=!0},Bc=G=>{G?.formData&&(en.value=G.formData),z.value=!1,ke.value=null;const le=en.value?.latitude??F.value?.latitude,ge=en.value?.longitude??F.value?.longitude;if(le&&ge)qe.value={lat:le,lng:ge},Tt.value=16;else if(oe.value){const at=oe.value.getMapCenter(),bt=oe.value.getMapZoom();at&&bt!==null&&(qe.value=at,Tt.value=bt)}const _e=en.value?.name||F.value?.name;bo.value=!0,ce.value="move-checkpoint",ue.value={title:`Move ${x.value.checkpoint}: ${_e}`,description:"Click on the map to set the new location"}},rs=async G=>{if(!ac(G.what3Words)){alert("Invalid What3Words format.");return}try{const le=!F.value.id;if(le){const ge=await a.createLocation({eventId:t.params.eventId,name:G.name,description:G.description,latitude:G.latitude,longitude:G.longitude,requiredMarshals:G.requiredMarshals,what3Words:G.what3Words||null,startTime:G.startTime,endTime:G.endTime,styleType:G.styleType,styleColor:G.styleColor,styleBackgroundShape:G.styleBackgroundShape,styleBackgroundColor:G.styleBackgroundColor,styleBorderColor:G.styleBorderColor,styleIconColor:G.styleIconColor,styleSize:G.styleSize,styleMapRotation:G.styleMapRotation!=null?String(G.styleMapRotation):null,peopleTerm:G.peopleTerm,checkpointTerm:G.checkpointTerm,isDynamic:G.isDynamic||!1,locationUpdateScopeConfigurations:G.locationUpdateScopeConfigurations||[],pendingNewChecklistItems:G.pendingNewChecklistItems||[],pendingNewNotes:G.pendingNewNotes||[]});if(G.pendingAssignments&&G.pendingAssignments.length>0)for(const _e of G.pendingAssignments)await a.createAssignment({eventId:t.params.eventId,locationId:ge.id,marshalId:_e.marshalId})}else{const ge=F.value.id;if(await Bn.update(t.params.eventId,ge,{eventId:t.params.eventId,name:G.name,description:G.description,latitude:G.latitude,longitude:G.longitude,requiredMarshals:G.requiredMarshals,what3Words:G.what3Words||null,startTime:G.startTime,endTime:G.endTime,styleType:G.styleType,styleColor:G.styleColor,styleBackgroundShape:G.styleBackgroundShape,styleBackgroundColor:G.styleBackgroundColor,styleBorderColor:G.styleBorderColor,styleIconColor:G.styleIconColor,styleSize:G.styleSize,styleMapRotation:G.styleMapRotation!=null?String(G.styleMapRotation):null,peopleTerm:G.peopleTerm,checkpointTerm:G.checkpointTerm,isDynamic:G.isDynamic||!1,locationUpdateScopeConfigurations:G.locationUpdateScopeConfigurations||[]}),G.pendingNewChecklistItems&&G.pendingNewChecklistItems.length>0)for(const _e of G.pendingNewChecklistItems)_e.text?.trim()&&await Ut.create(t.params.eventId,{text:_e.text,scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[ge]}],displayOrder:0,isRequired:!1});if(G.pendingNewNotes&&G.pendingNewNotes.length>0)for(const _e of G.pendingNewNotes)!_e.title?.trim()&&!_e.content?.trim()||await fs.create(t.params.eventId,{title:_e.title||"Untitled",content:_e.content||"",scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[ge]}],displayOrder:0,priority:"Normal",isPinned:!1});for(const _e of re.value)await a.deleteAssignment(t.params.eventId,_e);if(G.assignmentsToRemove&&G.assignmentsToRemove.length>0)for(const _e of G.assignmentsToRemove)await a.deleteAssignment(t.params.eventId,_e);for(const _e of J.value)await a.createAssignment({eventId:t.params.eventId,locationId:F.value.id,marshalId:_e.marshalId});if(G.checkInChanges&&G.checkInChanges.length>0)for(const _e of G.checkInChanges){const at=F.value.assignments.find(bt=>bt.id===_e.assignmentId);at&&at.isCheckedIn!==_e.shouldBeCheckedIn&&await Aa.adminCheckIn(t.params.eventId,_e.assignmentId)}}if(!le&&G.checklistChanges&&G.checklistChanges.length>0)for(const ge of G.checklistChanges)try{ge.complete?await Ut.complete(t.params.eventId,ge.itemId,{marshalId:ge.marshalId,contextType:ge.contextType,contextId:ge.contextId}):await Ut.uncomplete(t.params.eventId,ge.itemId,{marshalId:ge.marshalId,contextType:ge.contextType,contextId:ge.contextId})}catch(_e){console.error("Failed to update checklist item:",ge,_e)}await En(),$s()}catch(le){console.error("Failed to update location:",le),alert("Failed to update location. Please try again.")}},Bi=async G=>{y(`Delete ${x.value.checkpoint}`,`Are you sure you want to delete this ${x.value.checkpoint}?`,async()=>{try{await Bn.delete(t.params.eventId,G),await So(),$s()}catch(le){console.error(`Failed to delete ${x.value.checkpoint}:`,le),alert(`Failed to delete ${x.value.checkpoint}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Nc=async G=>{try{if(Oe.value&&Oe.value.setCheckingIn(G.id),await Aa.adminCheckIn(t.params.eventId,G.id),await Va(),F.value){const le=R.value.find(ge=>ge.id===F.value.id);le&&(F.value=le)}}catch(le){console.error("Failed to toggle check-in:",le),alert("Failed to toggle check-in. Please try again.")}finally{Oe.value&&Oe.value.setCheckingIn(null)}},kl=G=>{const le=G?.id??G;if(le?.toString().startsWith("temp-")){const ge=F.value.assignments.find(_e=>_e.id===le);ge&&(J.value=J.value.filter(_e=>_e.marshalId!==ge.marshalId)),F.value.assignments=F.value.assignments.filter(_e=>_e.id!==le),Jt()}else re.value.includes(le)||(re.value.push(le),F.value.assignments=F.value.assignments.filter(ge=>ge.id!==le),Jt())},Fc=async G=>{const le=X.value.find(_e=>_e.id===G);if(!le)return;const ge=R.value.filter(_e=>_e.assignments?.some(at=>at.marshalId===G&&_e.id!==F.value.id));if(ge.length>0){Re.value={marshalName:le.name,locations:ge.map(at=>at.name),marshal:le};const _e=await new Promise(at=>{Se.value=at,Be.value=!0});if(_e==="cancel"||_e==="choose-other")return;if(_e==="move")for(const at of ge){const bt=at.assignments.find(Mt=>Mt.marshalId===G);if(bt){re.value.push(bt.id);const Mt=R.value.findIndex(_n=>_n.id===at.id);Mt!==-1&&(R.value[Mt].assignments=R.value[Mt].assignments.filter(_n=>_n.id!==bt.id))}}}J.value.push({marshalId:le.id,marshalName:le.name}),F.value.assignments||(F.value.assignments=[]),F.value.assignments.push({id:`temp-${Date.now()}`,marshalId:le.id,marshalName:le.name,locationId:F.value.id,isCheckedIn:!1,isPending:!0}),Jt(),Ri()},Ho=async G=>{try{const ge=(await gs.create({eventId:t.params.eventId,name:G.name,email:G.email,phoneNumber:G.phoneNumber})).data;await na(),J.value.push({marshalId:ge.id,marshalName:ge.name}),F.value&&(F.value.assignments||(F.value.assignments=[]),F.value.assignments.push({id:`temp-${Date.now()}`,marshalId:ge.id,marshalName:ge.name,locationId:F.value.id,isCheckedIn:!1,isPending:!0})),Jt(),Ri()}catch(le){console.error("Failed to create marshal:",le),alert("Failed to create marshal. Please try again.")}},Uc=()=>{Te.value=null,de.value={},fe.value={id:"",name:"",email:"",phoneNumber:"",notes:""},je.value=[],et.value=[],W.value=!1,he.value=!0},fa=G=>{Te.value=G,de.value={},fe.value={id:G.id,name:G.name,email:G.email||"",phoneNumber:G.phoneNumber||"",notes:G.notes||""},je.value=[],et.value=[],W.value=!1,he.value=!0},gr=V(()=>{if(!Te.value)return[];const G=[];return R.value.forEach(le=>{le.assignments.filter(_e=>_e.marshalName===Te.value.name&&!et.value.includes(_e.id)).forEach(_e=>{G.push({..._e,locationName:le.name,locationDescription:le.description||""})})}),je.value.forEach((le,ge)=>{const _e=R.value.find(at=>at.id===le.locationId);_e&&G.push({id:`pending-${ge}`,locationId:le.locationId,locationName:_e.name,locationDescription:_e.description||"",marshalId:Te.value.id,marshalName:Te.value.name,isCheckedIn:!1,isPending:!0})}),G}),Vo=async G=>{try{let le=Te.value?.id,ge=!1;if(Te.value){if(await gs.update(t.params.eventId,Te.value.id,{name:G.name,email:G.email,phoneNumber:G.phoneNumber,notes:G.notes}),G.pendingNewChecklistItems&&G.pendingNewChecklistItems.length>0)for(const _e of G.pendingNewChecklistItems)_e.text?.trim()&&await Ut.create(t.params.eventId,{text:_e.text,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[le]}],displayOrder:0,isRequired:!1});if(G.pendingNewNotes&&G.pendingNewNotes.length>0)for(const _e of G.pendingNewNotes)!_e.title?.trim()&&!_e.content?.trim()||await fs.create(t.params.eventId,{title:_e.title||"Untitled",content:_e.content||"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[le]}],displayOrder:0,priority:"Normal",isPinned:!1})}else le=(await gs.create({eventId:t.params.eventId,name:G.name,email:G.email,phoneNumber:G.phoneNumber,notes:G.notes,pendingNewChecklistItems:G.pendingNewChecklistItems||[],pendingNewNotes:G.pendingNewNotes||[]})).data.id,ge=!0;for(const _e of et.value)await a.deleteAssignment(t.params.eventId,_e);if(G.assignmentsToRemove&&G.assignmentsToRemove.length>0)for(const _e of G.assignmentsToRemove)await a.deleteAssignment(t.params.eventId,_e);for(const _e of je.value)await a.createAssignment({eventId:t.params.eventId,locationId:_e.locationId,marshalId:le});if(G.pendingAssignments&&G.pendingAssignments.length>0)for(const _e of G.pendingAssignments)await a.createAssignment({eventId:t.params.eventId,locationId:_e.locationId,marshalId:le});if(G.checkInChanges&&G.checkInChanges.length>0){const _e=gr.value;for(const at of G.checkInChanges){const bt=_e.find(Mt=>Mt.id===at.assignmentId);bt&&bt.isCheckedIn!==at.shouldBeCheckedIn&&await Aa.adminCheckIn(t.params.eventId,at.assignmentId)}}if(G.checklistChanges&&G.checklistChanges.length>0)for(const _e of G.checklistChanges)try{const at={marshalId:le};_e.contextType&&_e.contextId&&(at.contextType=_e.contextType,at.contextId=_e.contextId),_e.complete?await Ut.complete(t.params.eventId,_e.itemId,at):await Ut.uncomplete(t.params.eventId,_e.itemId,at)}catch(at){console.error("Failed to process checklist change:",at);const bt=at.response?.data?.message||"Failed to update checklist item";alert(`Error: ${bt}`)}if(await En(),F.value){const _e=R.value.find(at=>at.id===F.value.id);_e&&(F.value=_e)}Qa(),ge&&(O.value=le,Z.value=G.name,te.value=!0)}catch(le){console.error("Failed to save marshal:",le);const ge=le.response?.data?.message||"Failed to save marshal. Please try again.";if(le.response?.status===400){const _e=ge.toLowerCase();_e.includes("name")?(de.value={name:ge},be.value&&(be.value.switchToTab("details"),be.value.focusField("name"))):_e.includes("email")?(de.value={email:ge},be.value&&(be.value.switchToTab("details"),be.value.focusField("email"))):(de.value={general:ge},be.value&&be.value.switchToTab("details"))}else de.value={general:ge},be.value&&be.value.switchToTab("details")}},Xa=async G=>{const le=G||Te.value?.id;if(!le){console.error("No marshal ID to delete");return}const ge=x.value.person;y(`Delete ${ge}`,`Are you sure you want to delete this ${ge}?`,async()=>{try{await gs.delete(t.params.eventId,le),await sa(),Qa()}catch(_e){console.error(`Failed to delete ${ge}:`,_e),alert(`Failed to delete ${ge}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},yr=G=>{Xa(G.id)},bl=G=>{const le=G?.id??G;if(le?.toString().startsWith("pending-")){const ge=G?.locationId;ge&&(je.value=je.value.filter(_e=>_e.locationId!==ge)),Jt()}else et.value.includes(le)||(et.value.push(le),Jt())},Ni=G=>{je.value.push({locationId:G}),Jt()},Qa=()=>{he.value=!1,Te.value=null,xe.value=null,de.value={},fe.value={id:"",name:"",email:"",phoneNumber:"",notes:""},je.value=[],et.value=[],W.value=!1},Fi=async G=>{const le=X.value.find(ge=>ge.id===G.marshalId);if(!le){console.error("Marshal not found:",G.marshalId);return}xe.value=F.value?.id||null,W.value=!1,Te.value=le,he.value=!0},pa=G=>{const le=R.value.find(ge=>ge.id===G.locationId);if(!le){console.error("Location not found:",G.locationId);return}j.value=!0,W.value=!1,F.value=le,z.value=!0},Ui=async({file:G})=>{const le=await _.importMarshals(G);if(le){await sa(),zi();const ge=_.formatImportResultMessage(le,"marshal");kt.value="Import Complete",gt.value=ge,dt.value=!0}},zi=()=>{_.closeImportMarshalsModal()},kr=G=>{Se.value&&(Se.value(G),Se.value=null),Be.value=!1};let ei=null;const ti=async()=>{try{const G=t.params.eventId,le=await Bn.getDynamicCheckpoints(G);if(le.data&&Array.isArray(le.data))for(const ge of le.data){const _e=R.value.find(at=>at.id===ge.checkpointId);_e&&(_e.latitude=ge.latitude,_e.longitude=ge.longitude,_e.lastLocationUpdate=ge.lastLocationUpdate)}}catch(G){console.warn("Failed to poll dynamic checkpoints:",G)}},br=()=>{ei||!R.value.some(le=>le.isDynamic||le.IsDynamic)||(ti(),ei=setInterval(ti,6e4))},_l=()=>{ei&&(clearInterval(ei),ei=null)};return We(i,G=>{G==="course"?br():_l();const le=Date.now(),ge=_e=>le-U.value[_e]>a9;switch(G){case"marshals":ge("marshals")&&na();break;case"areas":ge("areas")&&it();break;case"checkpoints":ge("checkpoints")&&oa();break;case"checklists":ge("checklists")&&Yt();break;case"notes":ge("notes")&&xt();break;case"incidents":ge("incidents")&&ss();break;case"contacts":ge("contacts")&&mn();break}}),ln(async()=>{await En();try{const G=await ms.getMe(t.params.eventId);fo.value=G.data}catch(G){console.warn("Failed to fetch user claims:",G)}i.value==="course"&&br()}),We(E,G=>{G&&(document.title="OnTheDay App - Admin")},{immediate:!0}),Ln(()=>{_l()}),(G,le)=>(v(),g("div",{class:"admin-event-manage",style:Qe({colorScheme:N(M)})},[r("header",WN,[r("div",KN,[r("button",{onClick:Ha,class:"btn-back",title:"Back to sessions"},[Me(ZN,{size:48,animate:""})]),E.value?(v(),g("div",JN,[r("h1",null,I(E.value.name),1),r("p",YN,I(N(ag)(E.value.eventDate)),1)])):D("",!0)]),r("div",XN,[qn.value?(v(),g("button",{key:0,onClick:_s,class:"btn btn-marshal-mode"}," Switch to Marshal ")):D("",!0)]),Me(HN,{class:"theme-toggle-fixed"})]),r("div",QN,[r("div",e9,[Me(yM,{tabs:H.value,"model-value":N(i),"onUpdate:modelValue":N(l)},null,8,["tabs","model-value","onUpdate:modelValue"])]),r("div",t9,[N(i)==="course"?(v(),Ke(MC,{key:0,ref_key:"courseAreasTab",ref:oe,checkpoints:R.value,areas:Et.value,route:E.value?.route||[],"selected-area-id":co.value,"drawing-mode":N(Kt),onMapClick:Qt,onLocationClick:zo,onAreaClick:tn,onImportCheckpoints:le[0]||(le[0]=ge=>Ge.value=!0),onUploadRoute:le[1]||(le[1]=ge=>we.value=!0),onSelectLocation:Di,onAddArea:as,onSelectArea:tn,onPolygonComplete:ua,onCancelDrawing:Ei,onAddCheckpointFromMap:on,onAddManyCheckpointsFromMap:Ya,onAddAreaFromMap:ls,onFullscreen:Pn},null,8,["checkpoints","areas","route","selected-area-id","drawing-mode"])):D("",!0),N(i)==="checkpoints"?(v(),Ke(HT,{key:1,locations:R.value,areas:Et.value,onAddCheckpointManually:po,onImportCheckpoints:le[2]||(le[2]=ge=>Ge.value=!0),onSelectLocation:Di},null,8,["locations","areas"])):D("",!0),N(i)==="areas"?(v(),Ke(rM,{key:2,areas:Et.value,checkpoints:R.value,contacts:eo.value,"event-people-term":E.value?.peopleTerm||"Marshals","event-checkpoint-term":E.value?.checkpointTerm||"Checkpoints",onAddArea:as,onSelectArea:tn},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term"])):D("",!0),N(i)==="marshals"?(v(),Ke(E2,{key:3,ref_key:"marshalsTabRef",ref:Oe,marshals:X.value,assignments:qt.value,locations:R.value,onAddMarshal:Uc,onImportMarshals:le[3]||(le[3]=ge=>Xe.value=!0),onSelectMarshal:fa,onDeleteMarshal:yr,onToggleCheckIn:Nc},null,8,["marshals","assignments","locations"])):D("",!0),N(i)==="checklists"?(v(),Ke(j2,{key:4,"checklist-items":Eo.value,areas:Et.value,locations:R.value,marshals:X.value,"completion-report":Ba.value,onAddChecklistItem:qa,onSelectChecklistItem:Ii},null,8,["checklist-items","areas","locations","marshals","completion-report"])):D("",!0),N(i)==="notes"?(v(),Ke(uL,{key:5,notes:bs.value,areas:Et.value,locations:R.value,marshals:X.value,onAddNote:no,onSelectNote:aa},null,8,["notes","areas","locations","marshals"])):D("",!0),N(i)==="incidents"?(v(),Ke(CT,{key:6,incidents:In.value,areas:Et.value,loading:Fa.value,onSelectIncident:Ti,onReportIncident:$i},null,8,["incidents","areas","loading"])):D("",!0),N(i)==="contacts"?(v(),Ke(NL,{key:7,contacts:eo.value,areas:Et.value,locations:R.value,marshals:X.value,"available-roles":Co.value,onAddContact:Io,onSelectContact:ca},null,8,["contacts","areas","locations","marshals","available-roles"])):D("",!0),N(i)==="details"?(v(),Ke(JL,{key:8,"event-data":St.value,"form-dirty":Lt.value,onSubmit:Ss,"onUpdate:formDirty":No},null,8,["event-data","form-dirty"])):D("",!0),N(i)==="settings"?(v(),Ke(Q$,{key:9,"event-data":St.value,"event-id":N(t).params.eventId,admins:N(ne),"form-dirty":Lt.value,onSubmit:Ss,onAddAdmin:le[4]||(le[4]=ge=>pe.value=!0),onRemoveAdmin:Ie,"onUpdate:formDirty":No},null,8,["event-data","event-id","admins","form-dirty"])):D("",!0)])]),Me(RN,{show:Y.value,location:pn.value,"is-dirty":W.value,onClose:mr,onSave:ha,onSetOnMap:Pt,"onUpdate:isDirty":Jt,"onUpdate:location":bn},null,8,["show","location","is-dirty"]),Me(i5,{show:z.value,location:F.value,assignments:F.value?.assignments||[],"event-date":E.value?.eventDate||"",areas:Et.value,"event-id":N(t).params.eventId,"all-locations":R.value,notes:bs.value,"available-marshals":ws.value,"all-marshals":X.value,"all-checklist-items":Eo.value,incidents:Lo.value,"is-dirty":W.value,"event-default-style-type":E.value?.defaultCheckpointStyleType||E.value?.DefaultCheckpointStyleType||"default","event-default-style-color":E.value?.defaultCheckpointStyleColor||E.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":E.value?.defaultCheckpointStyleBackgroundShape||E.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":E.value?.defaultCheckpointStyleBackgroundColor||E.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":E.value?.defaultCheckpointStyleBorderColor||E.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":E.value?.defaultCheckpointStyleIconColor||E.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":E.value?.defaultCheckpointStyleSize||E.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":E.value?.defaultCheckpointStyleMapRotation??E.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":E.value?.peopleTerm||"Marshals","z-index":Vn.value?1200:j.value?1100:1e3,"locked-from-marshal":j.value,onClose:$s,onSave:rs,onDelete:Bi,onMoveLocation:Bc,onRemoveAssignment:kl,onOpenAssignModal:Oi,"onUpdate:isDirty":Jt,onSelectIncident:za,onSelectMarshal:Fi},null,8,["show","location","assignments","event-date","areas","event-id","all-locations","notes","available-marshals","all-marshals","all-checklist-items","incidents","is-dirty","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","z-index","locked-from-marshal"]),Me(CM,{show:ee.value,link:pt.value,"is-dirty":!1,onClose:le[5]||(le[5]=ge=>ee.value=!1)},null,8,["show","link"]),Me(cA,{show:te.value,"event-id":N(t).params.eventId,"marshal-id":O.value,"marshal-name":Z.value,onClose:le[6]||(le[6]=ge=>te.value=!1)},null,8,["show","event-id","marshal-id","marshal-name"]),Me(hA,{show:N(pe),"is-dirty":W.value,onClose:tt,onSubmit:$e,"onUpdate:isDirty":Jt},null,8,["show","is-dirty"]),Me(gA,{show:N(we),uploading:N(Ze),error:N(Ne),"is-dirty":W.value,onClose:Bt,onSubmit:ft,"onUpdate:isDirty":Jt},null,8,["show","uploading","error","is-dirty"]),Me(xA,{show:N(Ge),importing:N(Q),error:N(Ce),result:N(me),"is-dirty":W.value,onClose:nn,onSubmit:$t,"onUpdate:isDirty":Jt},null,8,["show","importing","error","result","is-dirty"]),Me(o8,{ref_key:"editMarshalModalRef",ref:be,show:he.value,marshal:Te.value,"event-id":N(t).params.eventId,assignments:gr.value,"available-locations":Qs.value,"all-locations":R.value,areas:Et.value,"is-editing":!!Te.value,"event-notes":bs.value,"all-checklist-items":Eo.value,incidents:jt.value,"all-marshals":X.value,"is-dirty":W.value,"validation-errors":de.value,"locked-checkpoint-id":xe.value,"z-index":xe.value?1100:1e3,onClose:Qa,onSave:Vo,onDelete:Xa,onRemoveAssignment:bl,onAssignToLocation:Ni,"onUpdate:isDirty":Jt,onSelectIncident:os,onSelectCheckpoint:pa},null,8,["show","marshal","event-id","assignments","available-locations","all-locations","areas","is-editing","event-notes","all-checklist-items","incidents","all-marshals","is-dirty","validation-errors","locked-checkpoint-id","z-index"]),Me(RA,{show:N(Xe),importing:N(ye),error:N(Ce),result:N(ie),"is-dirty":W.value,onClose:zi,onSubmit:Ui,"onUpdate:isDirty":Jt},null,8,["show","importing","error","result","is-dirty"]),Me(l8,{show:Be.value,"conflict-data":Re.value,onClose:le[7]||(le[7]=ge=>Be.value=!1),onChoice:kr},null,8,["show","conflict-data"]),Me(g8,{show:Ee.value,"location-name":F.value?.name||"",marshals:ws.value,onClose:Ri,onAssignExisting:Fc,onCreateAndAssign:Ho},null,8,["show","location-name","marshals"]),Me(T8,{show:Dt.value,"old-event-date":Vt.value,"new-event-date":ht.value,"affected-checkpoints-count":Gt.value,onConfirm:ea,onCancel:ta},null,8,["show","old-event-date","new-event-date","affected-checkpoints-count"]),Me(CR,{ref_key:"editAreaModalRef",ref:Qn,show:Vn.value,area:_t.value,"initial-tab":kn.value,checkpoints:R.value,marshals:X.value,areas:Et.value,route:E.value?.route||[],"is-dirty":W.value,"event-id":N(t).params.eventId,"all-locations":R.value,assignments:qt.value,notes:bs.value,contacts:eo.value,incidents:Bo.value,"event-default-style-type":E.value?.defaultCheckpointStyleType||E.value?.DefaultCheckpointStyleType||"default","event-default-style-color":E.value?.defaultCheckpointStyleColor||E.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":E.value?.defaultCheckpointStyleBackgroundShape||E.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":E.value?.defaultCheckpointStyleBackgroundColor||E.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":E.value?.defaultCheckpointStyleBorderColor||E.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":E.value?.defaultCheckpointStyleIconColor||E.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":E.value?.defaultCheckpointStyleSize||E.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":E.value?.defaultCheckpointStyleMapRotation??E.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":E.value?.peopleTerm||"Marshals","event-checkpoint-term":E.value?.checkpointTerm||"Checkpoints",onClose:is,onSave:Fo,onDelete:Ga,onDrawBoundary:Mi,"onUpdate:isDirty":Jt,onSelectCheckpoint:Di,onCreateContactFromMarshal:vl,onCreateNewContact:Si,onEditContact:Uo,onSelectIncident:Ls},null,8,["show","area","initial-tab","checkpoints","marshals","areas","route","is-dirty","event-id","all-locations","assignments","notes","contacts","incidents","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","event-checkpoint-term"]),Me(RR,{show:ks.value,"checklist-item":Gn.value,"initial-tab":_o.value,areas:Et.value,locations:R.value,marshals:X.value,"is-dirty":W.value,onClose:gn,onSave:wt,onDelete:Is,"onUpdate:isDirty":Jt},null,8,["show","checklist-item","initial-tab","areas","locations","marshals","is-dirty"]),Me(YR,{show:Ys.value,note:Po.value,"initial-tab":Na.value,areas:Et.value,locations:R.value,marshals:X.value,"is-dirty":W.value,onClose:la,onSave:xi,onDelete:ia,"onUpdate:isDirty":Jt},null,8,["show","note","initial-tab","areas","locations","marshals","is-dirty"]),Me(wg,{show:wo.value,incident:vn.value,route:E.value?.route||[],checkpoints:R.value,"can-manage":!0,onClose:ja,onStatusChange:gl,onOpenAddNote:oo},null,8,["show","incident","route","checkpoints"]),Me(Ht,{show:Ua.value,title:"Add update",size:"small",onClose:ra},{footer:Fe(()=>[r("div",o9,[r("button",{type:"button",class:"btn btn-secondary",onClick:ra}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:Za,disabled:!Ro.value.trim()||Xs.value},I(Xs.value?"Adding...":"Add update"),9,s9)])]),default:Fe(()=>[r("div",n9,[ze(r("textarea",{"onUpdate:modelValue":le[8]||(le[8]=ge=>Ro.value=ge),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[nt,Ro.value]])])]),_:1},8,["show"]),Me(Cg,{show:Do.value,"event-id":N(t).params.eventId,checkpoint:null,"initial-location":null,checkpoints:R.value,route:E.value?.route||[],onClose:le[9]||(le[9]=ge=>Do.value=!1),onSubmit:ml},null,8,["show","event-id","checkpoints","route"]),Me(uN,{show:uo.value,contact:xn.value,"initial-tab":to.value,areas:Et.value,locations:R.value,marshals:X.value,"available-roles":Co.value,"is-dirty":W.value,"prefilled-name":It.value,"prefilled-marshal-id":ho.value,"create-from-area-context":!!mt.value,onClose:Ja,onSave:Wa,onDelete:Ka,"onUpdate:isDirty":Jt},null,8,["show","contact","initial-tab","areas","locations","marshals","available-roles","is-dirty","prefilled-name","prefilled-marshal-id","create-from-area-context"]),Me(LN,{show:N(bo),mode:N(ce),"context-title":N(ue).title,"context-description":N(ue).description,"can-complete":An.value,clickable:N(ce)!=="draw-area","drawing-mode":N(ce)==="draw-area"&&N(Kt),locations:Cs.value,areas:Oo.value,route:E.value?.route||[],"selected-area-id":co.value,center:N(qe),zoom:N(Tt),"highlight-location-id":pl.value,onMapClick:Nt,onPolygonComplete:ua,onPolygonDrawing:Ai,onDone:yl,onCancel:da},null,8,["show","mode","context-title","context-description","can-complete","clickable","drawing-mode","locations","areas","route","selected-area-id","center","zoom","highlight-location-id"]),Me(Oc,{show:dt.value,title:kt.value,message:gt.value,onClose:le[10]||(le[10]=ge=>dt.value=!1)},null,8,["show","title","message"]),Me(Da,{show:N(u),title:N(d),message:N(h),"is-danger":N(f),"confirm-text":N(m),onConfirm:N(k),onCancel:N(w)},null,8,["show","title","message","is-danger","confirm-text","onConfirm","onCancel"])],4))}},l9=He(i9,[["__scopeId","data-v-c98a4d14"]]),r9={key:0,class:"emergency-notes-section"},c9={class:"emergency-notes-list"},u9={class:"note-header"},d9={key:0,class:"note-content"},h9={key:1,class:"emergency-contacts-section"},f9={class:"emergency-contacts-list"},p9={class:"contact-header"},v9={key:0,class:"role-badge"},m9={class:"contact-details"},g9={key:0,class:"info-section"},y9=["href"],k9={key:1,class:"info-section"},b9=["href"],_9={key:2,class:"info-section"},w9=["href"],C9={key:2,class:"no-contacts"},L9={__name:"EmergencyContactModal",props:{show:{type:Boolean,default:!1},contacts:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const o=e,a=t,n=V(()=>o.notes?[...o.notes].filter(h=>h.showInEmergencyInfo||h.ShowInEmergencyInfo).sort((h,f)=>{const m=h.isPinned||h.IsPinned,y=f.isPinned||f.IsPinned;if(m!==y)return m?-1:1;const k=h.displayOrder||h.DisplayOrder||0,w=f.displayOrder||f.DisplayOrder||0;if(k!==w)return k-w;const S=h.priority||h.Priority,T=f.priority||f.Priority;return S==="Emergency"&&T!=="Emergency"?-1:T==="Emergency"&&S!=="Emergency"?1:0}):[]),i=V(()=>o.contacts?o.contacts.filter(h=>h.showInEmergencyInfo||h.ShowInEmergencyInfo).sort((h,f)=>{const m=h.isPinned||h.IsPinned,y=f.isPinned||f.IsPinned;if(m!==y)return m?-1:1;const k=h.displayOrder||h.DisplayOrder||0,w=f.displayOrder||f.DisplayOrder||0;if(k!==w)return k-w;const S=h.name||h.Name||"",T=f.name||f.Name||"";return S.localeCompare(T,void 0,{sensitivity:"base"})}):[]),l=()=>{a("close")},u=h=>h?{EmergencyContact:"Emergency Contact",EventDirector:"Event Director",MedicalLead:"Medical Lead",SafetyOfficer:"Safety Officer",Logistics:"Logistics"}[h]||h.replace(/([A-Z])/g," $1").trim():"",d=h=>h.roles&&Array.isArray(h.roles)&&h.roles.length>0?h.roles:h.role?[h.role]:[];return(h,f)=>(v(),Ke(Ht,{show:e.show,title:"Emergency information",size:"medium",onClose:l},{actions:Fe(()=>[r("button",{onClick:l,class:"btn btn-secondary"},"Close")]),default:Fe(()=>[n.value.length>0?(v(),g("div",r9,[f[0]||(f[0]=r("h2",{class:"section-header"},"Emergency notes",-1)),r("div",c9,[(v(!0),g(Ae,null,Ue(n.value,m=>(v(),g("div",{key:m.noteId||m.NoteId,class:ve(["emergency-note-item",{"is-emergency":(m.priority||m.Priority)==="Emergency"}])},[r("div",u9,[r("h3",null,I(m.title||m.Title),1),r("span",{class:ve(["priority-badge",(m.priority||m.Priority).toLowerCase()])},I(m.priority||m.Priority),3)]),m.content||m.Content?(v(),g("div",d9,I(m.content||m.Content),1)):D("",!0)],2))),128))])])):D("",!0),i.value&&i.value.length>0?(v(),g("div",h9,[f[4]||(f[4]=r("h2",{class:"section-header"},"Emergency contacts",-1)),r("div",f9,[(v(!0),g(Ae,null,Ue(i.value,m=>(v(),g("div",{key:m.contactId||m.name,class:"emergency-contact-item"},[r("div",p9,[r("h3",null,I(m.name),1),d(m).length>0?(v(),g("span",v9,I(d(m).map(u).join(", ")),1)):D("",!0)]),r("div",m9,[m.phone?(v(),g("div",g9,[f[1]||(f[1]=r("label",null,"Phone number",-1)),r("a",{href:`tel:${m.phone}`,class:"phone-link"},I(m.phone),9,y9)])):D("",!0),m.email?(v(),g("div",k9,[f[2]||(f[2]=r("label",null,"Email",-1)),r("a",{href:`mailto:${m.email}`,class:"email-link"},I(m.email),9,b9)])):D("",!0),m.notes||m.details?(v(),g("div",_9,[f[3]||(f[3]=r("label",null,"Details",-1)),r("p",null,I(m.notes||m.details),1)])):D("",!0)]),m.phone?(v(),g("a",{key:0,href:`tel:${m.phone}`,class:"btn btn-danger btn-full"}," Call "+I(m.name),9,w9)):D("",!0)]))),128))])])):D("",!0),i.value.length===0&&n.value.length===0?(v(),g("div",C9,[...f[5]||(f[5]=[r("p",null,"No emergency information has been set up for this event.",-1)])])):D("",!0)]),_:1},8,["show"]))}},S9=He(L9,[["__scopeId","data-v-6ae197f1"]]),Pl=A(navigator.onLine),Hs=A(!0),$a=A(0),Er=A(null),di=A("idle"),nl=A(null),pd=A(!1);let Ip=null,Du=!1,jo=null,xp=0;function I9(e=1e3,t=1e4){return Math.floor(Math.random()*(t-e+1))+e}function rc(){jo&&(clearTimeout(jo),jo=null);const e=I9(1e3,1e4);console.log(`Scheduling auto-sync in ${e}ms`),jo=setTimeout(async()=>{if(jo=null,!navigator.onLine){console.log("Auto-sync cancelled: offline");return}if(await oc()===0){console.log("Auto-sync cancelled: no pending actions");return}console.log("Starting auto-sync..."),await cc();const o=await oc();o>0&&navigator.onLine&&(console.log(`${o} actions remaining, scheduling retry...`),rc())},e)}async function Yi(){if(!navigator.onLine)return Hs.value=!1,!1;try{return await $_.check(),Hs.value=!0,!0}catch(e){return e.response?.status===404?(Hs.value=!0,!0):(e.code==="ECONNABORTED"&&console.warn("Server health check timed out"),Hs.value=!1,!1)}}async function Zd(){const e=Date.now();if(e-xp<2e3)return;xp=e;const t=navigator.onLine;if(Pl.value=t,!t){Hs.value=!1;return}pd.value=!0;try{await Yi()&&$a.value>0&&rc()}finally{pd.value=!1}}function $p(){document.visibilityState==="visible"&&(console.log("Page became visible, checking connectivity..."),Zd())}function Tp(){console.log("Window focused, checking connectivity..."),Zd()}async function x9(e){try{switch(e.type){case"checkin":await Aa.checkIn(e.payload);break;case"checkin_toggle":await Aa.toggleCheckIn(e.payload.eventId,e.payload.assignmentId,e.payload.gpsData||{});break;case"checkin_admin":await Aa.adminCheckIn(e.payload.eventId,e.payload.assignmentId);break;case"checklist_complete":await Ut.complete(e.payload.eventId,e.payload.itemId,e.payload.data);break;case"checklist_uncomplete":await Ut.uncomplete(e.payload.eventId,e.payload.itemId,e.payload.data);break;default:return console.warn("Unknown action type:",e.type),!1}return!0}catch(t){if(console.error("Failed to sync action:",e,t),t.response&&t.response.status===400){const o=t.response.data?.message||t.response.data||"",a=typeof o=="string"?o.toLowerCase():"";if(a.includes("already checked in"))return console.log("Action already completed (already checked in), treating as success"),!0;if(a.includes("already completed")||a.includes("already uncompleted"))return console.log("Action already completed (checklist state), treating as success"),!0}return t.response&&t.response.status>=400&&t.response.status<500?"permanent_failure":!1}}async function cc(){if(!Du&&navigator.onLine){Du=!0,di.value="syncing",nl.value=null;try{const e=await Km();if(e.length===0){di.value="success",$a.value=0;return}let t=0,o=0;for(const a of e){const n=await x9(a);if(n===!0)await Uf(a.id),t++;else if(n==="permanent_failure")await Uf(a.id),o++;else{const i=(a.attempts||0)+1;i>=5?(await Ff(a.id,{status:"failed",attempts:i,lastAttempt:new Date().toISOString()}),o++):await Ff(a.id,{status:"retrying",attempts:i,lastAttempt:new Date().toISOString()})}}$a.value=await oc(),o>0?(di.value="error",nl.value=`${o} action(s) failed to sync`):di.value="success"}catch(e){console.error("Sync error:",e),di.value="error",nl.value="Failed to sync pending actions"}finally{Du=!1}}}function $9(){Ip||(Ip=setInterval(async()=>{navigator.onLine&&(await Yi(),Hs.value&&$a.value>0&&await cc())},3e4))}function Wd(){const e=V(()=>Pl.value&&Hs.value);async function t(){$a.value=await oc()}async function o(){Pl.value=!0,await Yi()&&$a.value>0&&rc()}function a(){Pl.value=!1,Hs.value=!1,jo&&(clearTimeout(jo),jo=null)}ln(async()=>{await Js(),await t(),window.addEventListener("online",o),window.addEventListener("offline",a),document.addEventListener("visibilitychange",$p),window.addEventListener("focus",Tp),navigator.onLine&&await Yi()&&$a.value>0&&rc(),$9()}),Ln(()=>{window.removeEventListener("online",o),window.removeEventListener("offline",a),document.removeEventListener("visibilitychange",$p),window.removeEventListener("focus",Tp),jo&&(clearTimeout(jo),jo=null)});async function n(d,h){if(!e.value)return console.warn("Cannot refresh cache while offline"),!1;try{const f=await h();return await or(d,f),Er.value=new Date().toISOString(),!0}catch(f){return console.error("Failed to refresh cache:",f),!1}}async function i(d){const h=await Ma(d);return h&&(Er.value=h.cachedAt),h}async function l(d){Er.value=await b_(d)}async function u(){return navigator.onLine?await Yi()?(await cc(),di.value==="success"):(nl.value="Server is not responding",!1):(nl.value="Cannot sync while offline",!1)}return{isOnline:Pl,isServerHealthy:Hs,isFullyOnline:e,isCheckingStatus:pd,pendingActionsCount:$a,lastSyncTime:Er,syncStatus:di,syncError:nl,checkServerHealth:Yi,quickConnectivityCheck:Zd,syncPendingActions:cc,updatePendingCount:t,refreshCache:n,getCachedData:i,loadLastSyncTime:l,forcSync:u}}const T9={class:"offline-indicator-container"},M9={class:"offline-icon"},A9={key:0,viewBox:"0 0 24 24",fill:"currentColor"},E9={key:1,class:"spinner",viewBox:"0 0 24 24",fill:"currentColor"},P9={class:"offline-text"},D9={key:0,class:"last-sync"},R9={class:"pending-text"},O9={key:0,class:"pending-subtext"},B9={key:1,class:"syncing-text"},N9={__name:"OfflineIndicator",setup(e){const{isOnline:t,isFullyOnline:o,isCheckingStatus:a,pendingActionsCount:n,lastSyncTime:i,syncStatus:l,syncError:u,forcSync:d}=Wd(),h=A(!1),f=A(""),m=A(""),y=V(()=>{if(!i.value)return"";const w=new Date(i.value),T=new Date-w,x=Math.floor(T/6e4),C=Math.floor(x/60);return x<1?"just now":x<60?`${x}m ago`:C<24?`${C}h ago`:w.toLocaleDateString()}),k=async()=>{await d()};return We(l,w=>{w==="success"&&n.value===0?(f.value="All actions synced successfully!",m.value="success",h.value=!0,setTimeout(()=>{h.value=!1},3e3)):w==="error"&&(f.value=u.value||"Sync failed",m.value="error",h.value=!0,setTimeout(()=>{h.value=!1},5e3))}),(w,S)=>(v(),g("div",T9,[Me(Jo,{name:"slide"},{default:Fe(()=>[N(o)?D("",!0):(v(),g("div",{key:0,class:ve(["offline-banner",{checking:N(a)}])},[r("span",M9,[N(a)?(v(),g("svg",E9,[...S[1]||(S[1]=[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8z"},null,-1)])])):(v(),g("svg",A9,[...S[0]||(S[0]=[r("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"},null,-1)])]))]),r("span",P9,I(N(a)?"Checking connection...":N(t)?"Server unavailable":"You're offline"),1),N(i)&&!N(a)?(v(),g("span",D9," Last synced: "+I(y.value),1)):D("",!0)],2))]),_:1}),Me(Jo,{name:"fade"},{default:Fe(()=>[N(n)>0?(v(),g("div",{key:0,class:ve(["pending-banner",{"offline-pending":!N(o)}])},[S[2]||(S[2]=r("span",{class:"pending-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})])],-1)),r("span",R9,[Ye(I(N(n))+" pending action"+I(N(n)!==1?"s":"")+" ",1),N(o)?D("",!0):(v(),g("span",O9,"(will sync when online)"))]),N(o)&&N(l)!=="syncing"?(v(),g("button",{key:0,onClick:k,class:"sync-button"}," Sync Now ")):N(l)==="syncing"?(v(),g("span",B9,"Syncing...")):D("",!0)],2)):D("",!0)]),_:1}),Me(Jo,{name:"fade"},{default:Fe(()=>[h.value?(v(),g("div",{key:0,class:ve(["sync-toast",m.value])},I(f.value),3)):D("",!0)]),_:1})]))}},F9=He(N9,[["__scopeId","data-v-9c1e58f4"]]),U9={class:"modal-content check-in-reminder-modal"},z9={class:"modal-header warning"},H9={class:"modal-body"},V9={class:"reminder-message"},G9={key:0},q9={class:"reminder-hint"},j9={class:"modal-footer"},Z9={__name:"CheckInReminderModal",props:{show:{type:Boolean,required:!0},checkpoint:{type:Object,default:null},accentButtonStyle:{type:Object,default:()=>({})}},emits:["dismiss","go-to-checkpoint"],setup(e){const{termsLower:t}=ct();return(o,a)=>(v(),Ke(Jo,{name:"modal"},{default:Fe(()=>[e.show&&e.checkpoint?(v(),g("div",{key:0,class:"modal-overlay",onClick:a[3]||(a[3]=lt(n=>o.$emit("dismiss"),["self"]))},[r("div",U9,[r("div",z9,[a[4]||(a[4]=r("h3",null,"Check-in reminder",-1)),r("button",{class:"modal-close",onClick:a[0]||(a[0]=n=>o.$emit("dismiss"))},"")]),r("div",H9,[a[6]||(a[6]=r("div",{class:"reminder-icon"},"",-1)),r("p",V9,[Ye(" You have not checked in yet to "+I(N(t).checkpoint)+" ",1),r("strong",null,I(e.checkpoint.location?.name),1),e.checkpoint.location?.description?(v(),g("span",G9," - "+I(e.checkpoint.location.description),1)):D("",!0),a[5]||(a[5]=Ye(". ",-1))]),r("p",q9," Please check in when you arrive at your "+I(N(t).checkpoint)+". ",1)]),r("div",j9,[r("button",{onClick:a[1]||(a[1]=n=>o.$emit("dismiss")),class:"btn btn-secondary"}," Dismiss "),r("button",{onClick:a[2]||(a[2]=n=>o.$emit("go-to-checkpoint")),class:"btn btn-primary",style:Qe(e.accentButtonStyle)}," Go to "+I(N(t).checkpoint),5)])])])):D("",!0)]),_:1}))}},W9=He(Z9,[["__scopeId","data-v-4761fdb9"]]),K9={class:"modal-content location-update-modal"},J9={class:"modal-header"},Y9={class:"modal-body"},X9={key:0,class:"success-message"},Q9={key:1},eF={class:"modal-description"},tF={key:0,class:"last-update-info"},nF={key:1,class:"gps-status active"},oF={class:"update-option"},sF=["disabled"],aF={class:"update-option auto-update-option"},iF={class:"checkbox-label"},lF=["checked"],rF={class:"option-hint"},cF={class:"update-option"},uF=["disabled"],dF={class:"update-option"},hF={class:"option-label"},fF={key:0,class:"checkpoint-list"},pF=["onClick","disabled"],vF={class:"checkpoint-name"},mF={key:0,class:"checkpoint-description"},gF={key:1,class:"no-checkpoints"},yF={key:2,class:"error"},kF={class:"modal-footer"},bF={__name:"LocationUpdateModal",props:{show:{type:Boolean,required:!0},assignment:{type:Object,default:null},userLocation:{type:Object,default:null},autoUpdateEnabled:{type:Boolean,default:!1},updating:{type:Boolean,default:!1},error:{type:String,default:""},success:{type:String,default:""},availableCheckpoints:{type:Array,default:()=>[]},accentButtonStyle:{type:Object,default:()=>({})}},emits:["close","update-gps","toggle-auto-update","select-on-map","copy-from-checkpoint"],setup(e){const{termsLower:t}=ct(),o=n=>n?new Date(n).toLocaleString():"",a=(n,i=50)=>n?n.length<=i?n:n.substring(0,i).trim()+"...":"";return(n,i)=>(v(),Ke(Jo,{name:"modal"},{default:Fe(()=>[e.show?(v(),g("div",{key:0,class:"modal-overlay",onClick:i[5]||(i[5]=lt(l=>n.$emit("close"),["self"]))},[r("div",K9,[r("div",J9,[r("h3",null,"Update "+I(N(t).checkpoint)+" location",1),r("button",{class:"modal-close",onClick:i[0]||(i[0]=l=>n.$emit("close"))},"")]),r("div",Y9,[e.success?(v(),g("div",X9,I(e.success),1)):(v(),g("div",Q9,[r("p",eF,[i[6]||(i[6]=Ye(" Update the position of ",-1)),r("strong",null,I(e.assignment?.location?.name),1)]),e.assignment?.location?.lastLocationUpdate?(v(),g("div",tF," Last updated: "+I(o(e.assignment.location.lastLocationUpdate)),1)):D("",!0),e.userLocation?(v(),g("div",nF,[...i[7]||(i[7]=[r("svg",{class:"status-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),Ye(" GPS active ",-1)])])):D("",!0),r("div",oF,[r("button",{onClick:i[1]||(i[1]=l=>n.$emit("update-gps")),class:"btn btn-primary btn-full",disabled:e.updating,style:Qe(e.accentButtonStyle)},[i[8]||(i[8]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),Ye(" "+I(e.updating?"Updating...":"Use current GPS location"),1)],12,sF)]),r("div",aF,[r("label",iF,[r("input",{type:"checkbox",checked:e.autoUpdateEnabled,onChange:i[2]||(i[2]=l=>n.$emit("toggle-auto-update"))},null,40,lF),i[9]||(i[9]=r("span",null,"Auto-update every 60 seconds",-1))]),r("p",rF,"Automatically updates the "+I(N(t).checkpoint)+" location using your GPS every minute.",1)]),r("div",cF,[r("button",{onClick:i[3]||(i[3]=l=>n.$emit("select-on-map")),class:"btn btn-secondary btn-full",disabled:e.updating},[...i[10]||(i[10]=[r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"})],-1),Ye(" Select location on map ",-1)])],8,uF)]),r("div",dF,[r("label",hF,"Or copy location from another "+I(N(t).checkpoint)+":",1),e.availableCheckpoints.length>0?(v(),g("div",fF,[(v(!0),g(Ae,null,Ue(e.availableCheckpoints,l=>(v(),g("button",{key:l.id,onClick:u=>n.$emit("copy-from-checkpoint",l.id),class:"btn btn-secondary btn-checkpoint-source",disabled:e.updating},[r("span",vF,I(l.name),1),l.description?(v(),g("span",mF,I(a(l.description)),1)):D("",!0)],8,pF))),128))])):(v(),g("p",gF," No other "+I(N(t).checkpoints)+" available to copy from. ",1))]),e.error?(v(),g("div",yF,I(e.error),1)):D("",!0)]))]),r("div",kF,[r("button",{onClick:i[4]||(i[4]=l=>n.$emit("close")),class:"btn btn-secondary"},I(e.success?"Ok":"Cancel"),1)])])])):D("",!0)]),_:1}))}},_F=He(bF,[["__scopeId","data-v-b3924a32"]]),wF={class:"contact-info"},CF={class:"contact-name-row"},LF={key:0,class:"primary-badge"},SF={class:"contact-name"},IF={key:0,class:"contact-notes-text"},xF={key:1,class:"contact-detail"},$F={key:2,class:"contact-detail"},TF={class:"contact-actions"},MF=["href"],AF=["href"],EF=["href"],PF={__name:"ContactCard",props:{name:{type:String,required:!0},role:{type:String,default:""},roles:{type:Array,default:()=>[]},phone:{type:String,default:""},email:{type:String,default:""},notes:{type:String,default:""},isPrimary:{type:Boolean,default:!1}},setup(e){const t=e,o=V(()=>t.roles&&t.roles.length>0?t.roles:t.role?[t.role]:[]),a=["Emergency","Safety","Medical","First Aid"],n=V(()=>o.value.length===0?!1:o.value.some(u=>a.some(d=>u.toLowerCase().includes(d.toLowerCase())))),i=u=>u?u.replace(/([A-Z])/g," $1").replace(/^./,d=>d.toUpperCase()).trim():"",l=V(()=>o.value.length===0?"":o.value.map(i).join(", "));return(u,d)=>(v(),g("div",{class:ve(["contact-item",{"primary-contact":e.isPrimary}])},[r("div",wF,[r("div",CF,[e.isPrimary?(v(),g("span",LF,"")):D("",!0),r("span",SF,I(e.name),1),o.value.length>0?(v(),g("span",{key:1,class:ve(["contact-role-badge",{"emergency-role":n.value}])},I(l.value),3)):D("",!0)]),e.notes?(v(),g("div",IF,I(e.notes),1)):D("",!0),e.phone?(v(),g("div",xF,I(e.phone),1)):D("",!0),e.email?(v(),g("div",$F,I(e.email),1)):D("",!0)]),r("div",TF,[e.phone?(v(),g("a",{key:0,href:`tel:${e.phone}`,class:"contact-link"},[...d[0]||(d[0]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Ye(" Call ",-1)])],8,MF)):D("",!0),e.phone?(v(),g("a",{key:1,href:`sms:${e.phone}`,class:"contact-link"},[...d[1]||(d[1]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Ye(" Text ",-1)])],8,AF)):D("",!0),e.email?(v(),g("a",{key:2,href:`mailto:${e.email}`,class:"contact-link"},[...d[2]||(d[2]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Ye(" Email ",-1)])],8,EF)):D("",!0)])],2))}},Lg=He(PF,[["__scopeId","data-v-2fdc8dea"]]),DF={key:0,class:"accordion-section"},RF={class:"accordion-title"},OF=["innerHTML"],BF={class:"accordion-icon"},NF={key:0,class:"accordion-content"},FF={key:0,class:"loading"},UF={key:1,class:"contact-list"},zF={__name:"MarshalContactsSection",props:{contacts:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){return(t,o)=>e.contacts.length>0||e.loading?(v(),g("div",DF,[r("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=a=>t.$emit("toggle"))},[r("span",RF,[r("span",{class:"section-icon",innerHTML:N(Xn)("contacts")},null,8,OF),Ye(" Your "+I(e.contacts.length===1?"contact":"contacts")+I(e.contacts.length>1?` (${e.contacts.length})`:""),1)]),r("span",BF,I(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",NF,[e.loading?(v(),g("div",FF,"Loading contacts...")):(v(),g("div",UF,[(v(!0),g(Ae,null,Ue(e.contacts,a=>(v(),Ke(Lg,{key:a.contactId,name:a.name,roles:a.roles,role:a.role,phone:a.phone,email:a.email,notes:a.notes,"is-primary":a.isPrimary},null,8,["name","roles","role","phone","email","notes","is-primary"]))),128))]))])):D("",!0)])):D("",!0)}},HF=He(zF,[["__scopeId","data-v-c3b5d73d"]]),VF={key:0,class:"accordion-section"},GF={class:"accordion-title"},qF=["innerHTML"],jF={class:"accordion-icon"},ZF={key:0,class:"accordion-content"},WF={key:0,class:"loading-state"},KF={key:1,class:"empty-state"},JF={key:2,class:"incidents-list"},YF={__name:"MarshalIncidentsSection",props:{incidents:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle","select-incident"],setup(e){return(t,o)=>e.incidents.length>0||e.loading?(v(),g("div",VF,[r("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=a=>t.$emit("toggle"))},[r("span",GF,[r("span",{class:"section-icon",innerHTML:N(Xn)("incidents")},null,8,qF),Ye(" Your "+I(e.incidents.length===1?"incident":"incidents")+I(e.incidents.length>1?` (${e.incidents.length})`:""),1)]),r("span",jF,I(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",ZF,[e.loading?(v(),g("div",WF," Loading incidents... ")):e.incidents.length===0?(v(),g("div",KF,[...o[1]||(o[1]=[r("p",null,"No incidents to show.",-1)])])):(v(),g("div",JF,[(v(!0),g(Ae,null,Ue(e.incidents,a=>(v(),Ke(vr,{key:a.incidentId,incident:a,onSelect:n=>t.$emit("select-incident",a)},null,8,["incident","onSelect"]))),128))]))])):D("",!0)])):D("",!0)}},XF=He(YF,[["__scopeId","data-v-e84cbdf1"]]),QF={key:0,class:"accordion-section"},e7={class:"accordion-title"},t7=["innerHTML"],n7={class:"accordion-icon"},o7={key:0,class:"accordion-content"},s7={class:"event-details"},a7={key:0,class:"event-detail-row"},i7={class:"detail-value"},l7={key:1,class:"event-description"},r7={class:"detail-value"},c7={__name:"MarshalEventDetailsSection",props:{eventDate:{type:String,default:null},description:{type:String,default:""},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){const t=o=>o?new Date(o).toLocaleString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"}):"";return(o,a)=>e.eventDate||e.description?(v(),g("div",QF,[r("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:a[0]||(a[0]=n=>o.$emit("toggle"))},[r("span",e7,[r("span",{class:"section-icon",innerHTML:N(Xn)("event")},null,8,t7),a[1]||(a[1]=Ye(" Event details ",-1))]),r("span",n7,I(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",o7,[r("div",s7,[e.eventDate?(v(),g("div",a7,[a[2]||(a[2]=r("span",{class:"detail-label"},"Date and time",-1)),r("span",i7,I(t(e.eventDate)),1)])):D("",!0),e.description?(v(),g("div",l7,[a[3]||(a[3]=r("span",{class:"detail-label"},"Description",-1)),r("p",r7,I(e.description),1)])):D("",!0)])])):D("",!0)])):D("",!0)}},u7=He(c7,[["__scopeId","data-v-7c880ad1"]]),d7={class:"accordion-section"},h7={class:"accordion-title"},f7=["innerHTML"],p7={class:"accordion-icon"},v7={key:0,class:"accordion-content"},m7={key:0,class:"loading"},g7={key:1,class:"error"},y7={key:2,class:"empty-state"},k7={class:"checklist-section"},b7={key:0,class:"empty-state small"},_7={key:1,class:"my-jobs-list"},w7=["checked","disabled","onChange"],C7={key:0,class:"checklist-section"},L7={class:"checklist-section-title"},S7={key:0,class:"checklist-items"},I7={class:"item-checkbox"},x7=["checked","disabled","onChange"],$7={class:"item-content"},T7={key:0,class:"item-context"},M7={key:1,class:"completion-info"},A7={class:"completion-text"},E7={class:"completion-time"},P7={key:1,class:"checklist-groups"},D7=["onClick"],R7={class:"group-title"},O7={class:"group-status"},B7={class:"group-count"},N7={class:"group-expand-icon"},F7={key:0,class:"checklist-group-items"},U7={class:"item-checkbox"},z7=["checked","disabled","onChange"],H7={class:"item-content"},V7={key:0,class:"completion-info"},G7={class:"completion-text"},q7={class:"completion-time"},j7={__name:"MarshalChecklistSection",props:{loading:{type:Boolean,default:!1},error:{type:String,default:""},isExpanded:{type:Boolean,default:!1},isAreaLead:{type:Boolean,default:!1},myItems:{type:Array,default:()=>[]},areaItems:{type:Array,default:()=>[]},areaItemsWithLocalState:{type:Array,default:()=>[]},visibleItems:{type:Array,default:()=>[]},groupedItems:{type:Array,default:()=>[]},completedCount:{type:Number,default:0},saving:{type:Boolean,default:!1},effectiveGroupBy:{type:String,default:"none"},expandedGroup:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},getContextName:{type:Function,default:()=>""}},emits:["toggle","toggle-item","toggle-group"],setup(e){const{termsLower:t}=ct(),o=e,a=V(()=>o.visibleItems.length),n=i=>i?new Date(i).toLocaleString():"";return(i,l)=>(v(),g("div",d7,[r("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:l[0]||(l[0]=u=>i.$emit("toggle"))},[r("span",h7,[r("span",{class:"section-icon",innerHTML:N(Xn)("checklist")},null,8,f7),Ye(" Your "+I(N(t).checklists)+" ("+I(e.completedCount)+" of "+I(a.value)+" complete) ",1)]),r("span",p7,I(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",v7,[e.loading?(v(),g("div",m7,"Loading checklist...")):e.error?(v(),g("div",g7,I(e.error),1)):a.value===0?(v(),g("div",y7,[r("p",null,"No "+I(N(t).checklists)+" for you.",1)])):e.isAreaLead?(v(),g(Ae,{key:3},[r("div",k7,[l[3]||(l[3]=r("h4",{class:"checklist-section-title"},"Your jobs",-1)),e.myItems.length===0?(v(),g("div",b7,[...l[2]||(l[2]=[r("p",null,"No jobs assigned to you.",-1)])])):(v(),g("div",_7,[(v(!0),g(Ae,null,Ue(e.myItems,u=>(v(),g("div",{key:`${u.itemId}_${u.completionContextType}_${u.completionContextId}`,class:"my-job-item"},[r("input",{type:"checkbox",checked:u.isCompleted,disabled:e.saving,onChange:d=>i.$emit("toggle-item",u)},null,40,w7),r("span",{class:ve(["my-job-text",{completed:u.isCompleted}])},I(u.text),3)]))),128))]))]),e.areaItems.length>0?(v(),g("div",C7,[r("h4",L7,"Your "+I(N(t).area)+"'s jobs",1),Me(jd,{items:e.areaItemsWithLocalState,locations:e.locations,areas:e.areas,marshals:e.marshals,onToggleComplete:l[1]||(l[1]=u=>i.$emit("toggle-item",u))},null,8,["items","locations","areas","marshals"])])):D("",!0)],64)):(v(),g(Ae,{key:4},[e.effectiveGroupBy==="none"?(v(),g("div",S7,[(v(!0),g(Ae,null,Ue(e.visibleItems,u=>(v(),g("div",{key:`${u.itemId}_${u.completionContextType}_${u.completionContextId}`,class:ve(["checklist-item",{"item-completed":u.isCompleted}])},[r("div",I7,[r("input",{type:"checkbox",checked:u.isCompleted,disabled:!u.canBeCompletedByMe||e.saving,onChange:d=>i.$emit("toggle-item",u)},null,40,x7)]),r("div",$7,[r("div",{class:ve(["item-text",{"text-completed":u.isCompleted}])},I(u.text),3),e.getContextName(u)?(v(),g("div",T7,I(e.getContextName(u)),1)):D("",!0),u.isCompleted?(v(),g("div",M7,[r("span",A7," Completed by "+I(u.completedByActorName||"Unknown"),1),r("span",E7,I(n(u.completedAt)),1)])):D("",!0)])],2))),128))])):(v(),g("div",P7,[(v(!0),g(Ae,null,Ue(e.groupedItems,u=>(v(),g("div",{key:u.key,class:"checklist-group"},[r("button",{class:ve(["checklist-group-header",{expanded:e.expandedGroup===u.key,"all-complete":u.completedCount===u.items.length}]),onClick:d=>i.$emit("toggle-group",u.key)},[r("span",R7,I(u.name),1),r("span",O7,[r("span",B7,I(u.completedCount)+"/"+I(u.items.length),1),r("span",N7,I(e.expandedGroup===u.key?"":"+"),1)])],10,D7),e.expandedGroup===u.key?(v(),g("div",F7,[(v(!0),g(Ae,null,Ue(u.items,d=>(v(),g("div",{key:`${d.itemId}_${d.completionContextType}_${d.completionContextId}`,class:ve(["checklist-item",{"item-completed":d.isCompleted}])},[r("div",U7,[r("input",{type:"checkbox",checked:d.isCompleted,disabled:!d.canBeCompletedByMe||e.saving,onChange:h=>i.$emit("toggle-item",d)},null,40,z7)]),r("div",H7,[r("div",{class:ve(["item-text",{"text-completed":d.isCompleted}])},I(d.text),3),d.isCompleted?(v(),g("div",V7,[r("span",G7,I(d.completedByActorName||"Unknown"),1),r("span",q7,I(n(d.completedAt)),1)])):D("",!0)])],2))),128))])):D("",!0)]))),128))]))],64))])):D("",!0)]))}},Z7=He(j7,[["__scopeId","data-v-b2878e4f"]]),W7={class:"accordion-section"},K7={class:"accordion-title"},J7=["innerHTML"],Y7={class:"accordion-icon"},X7={key:0,class:"accordion-content"},Q7={__name:"MarshalNotesSection",props:{eventId:{type:String,required:!0},notes:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},isExpanded:{type:Boolean,default:!1}},emits:["toggle","notes-changed"],setup(e){return(t,o)=>(v(),g("div",W7,[r("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:o[0]||(o[0]=a=>t.$emit("toggle"))},[r("span",K7,[r("span",{class:"section-icon",innerHTML:N(Xn)("notes")},null,8,J7),Ye(" Your "+I(e.notes.length===1?"note":"notes")+I(e.notes.length>1?` (${e.notes.length})`:""),1)]),r("span",Y7,I(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",X7,[Me(Rc,{"event-id":e.eventId,"all-notes":e.notes,locations:e.locations,areas:e.areas,assignments:e.assignments,"show-scope":!1,onNotesChanged:o[1]||(o[1]=a=>t.$emit("notes-changed"))},null,8,["event-id","all-notes","locations","areas","assignments"])])):D("",!0)]))}},eU=He(Q7,[["__scopeId","data-v-10b7523a"]]),tU={class:"accordion-section"},nU={class:"accordion-title"},oU=["innerHTML"],sU={key:0,class:"location-status active"},aU={key:1,class:"location-status"},iU={class:"accordion-icon"},lU={key:0,class:"accordion-content map-content"},rU={key:0,class:"map-selection-banner"},cU={class:"map-wrapper"},uU={__name:"MarshalRouteSection",props:{isExpanded:{type:Boolean,default:!1},userLocation:{type:Object,default:null},selectingLocation:{type:Boolean,default:!1},selectingLocationName:{type:String,default:""},locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},highlightLocationIds:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]}},emits:["toggle","cancel-select","map-click","location-click","action-click","visibility-change"],setup(e,{expose:t}){const{terms:o}=ct(),a=io("marshalBranding",{headerStyle:{},headerTextColor:""}),n=bi({headerStyle:V(()=>Vr(a.headerStyle)),headerTextColor:V(()=>Vr(a.headerTextColor))}),i=A(null);return t({mapRef:i,recenterOnLocation:(l,u,d)=>i.value?.recenterOnLocation?.(l,u,d),recenterOnUserLocation:()=>i.value?.recenterOnUserLocation?.(),openFullscreen:()=>i.value?.openFullscreen?.()}),(l,u)=>(v(),g("div",tU,[r("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:u[0]||(u[0]=d=>l.$emit("toggle"))},[r("span",nU,[r("span",{class:"section-icon",innerHTML:N(Xn)("course")},null,8,oU),Ye(" "+I(N(o).course)+" ",1),e.userLocation?(v(),g("span",sU,"GPS Active")):(v(),g("span",aU,"GPS Inactive"))]),r("span",iU,I(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",lU,[e.selectingLocation?(v(),g("div",rU,[r("span",null,[u[7]||(u[7]=Ye("Click on the map to set the new location for ",-1)),r("strong",null,I(e.selectingLocationName),1)]),r("button",{onClick:u[1]||(u[1]=d=>l.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")])):D("",!0),r("div",cU,[Me(wi,{ref_key:"mapRef",ref:i,locations:e.locations,route:e.route,center:e.center,zoom:15,"user-location":e.userLocation,"highlight-location-ids":e.highlightLocationIds,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:e.clickable,"show-fullscreen":!0,"fullscreen-title":N(o).course,"fullscreen-header-style":n.headerStyle,"fullscreen-header-text-color":n.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,class:ve({"selecting-location":e.selectingLocation}),height:"100%",onMapClick:u[3]||(u[3]=d=>l.$emit("map-click",d)),onLocationClick:u[4]||(u[4]=d=>l.$emit("location-click",d)),onActionClick:u[5]||(u[5]=d=>l.$emit("action-click",d)),onVisibilityChange:u[6]||(u[6]=d=>l.$emit("visibility-change",d))},$d({_:2},[e.selectingLocation?{name:"fullscreen-banner",fn:Fe(()=>[r("span",null,[u[8]||(u[8]=Ye("Click on the map to set the new location for ",-1)),r("strong",null,I(e.selectingLocationName),1)]),r("button",{onClick:u[2]||(u[2]=d=>l.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")]),key:"0"}:void 0]),1032,["locations","route","center","user-location","highlight-location-ids","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions","class"])])])):D("",!0)]))}},dU=He(uU,[["__scopeId","data-v-bbbe1950"]]),hU={class:"area-lead-content"},fU={key:0,class:"loading-state"},pU={key:1,class:"error-state"},vU={key:2,class:"empty-state"},mU={key:3,class:"checkpoint-accordion"},gU=["onClick"],yU={class:"checkpoint-header-content"},kU={class:"checkpoint-title-row"},bU={class:"checkpoint-name"},_U={key:0,class:"area-badge"},wU={key:0,class:"checkpoint-description-preview"},CU={class:"checkpoint-status-row"},LU={class:"status-badge marshals-status"},SU={key:0,class:"status-badge tasks-status"},IU={class:"accordion-icon"},xU={key:0,class:"checkpoint-accordion-content"},$U={class:"checkpoint-mini-map"},TU={class:"checkpoint-marshals-section"},MU={class:"marshals-label"},AU={key:0,class:"empty-state"},EU={key:1,class:"marshals-list"},PU=["onClick"],DU={class:"marshal-header"},RU={class:"marshal-name-row"},OU={class:"marshal-name"},BU={key:0,class:"task-count"},NU={class:"check-status-row"},FU=["onClick","disabled"],UU={key:0,class:"check-in-time"},zU={key:0},HU={key:1,class:"last-access-time"},VU={key:0,class:"checkpoint-tasks-section"},GU={class:"marshals-label"},qU={class:"tasks-list"},jU=["disabled","onChange"],ZU={class:"task-text"},WU=["disabled","onChange"],KU={class:"task-text"},JU={key:0,class:"marshal-details-modal"},YU={class:"details-section"},XU={class:"contact-info"},QU={key:0,class:"contact-row"},ez=["href"],tz={key:1,class:"contact-row"},nz=["href"],oz={key:2,class:"no-contact"},sz={class:"details-section"},az={key:0,class:"checked-in-section"},iz={class:"checked-in-details"},lz={class:"check-time-detail"},rz={key:0,class:"check-method"},cz=["disabled"],uz={key:1,class:"not-checked-in-section"},dz=["disabled"],hz={key:2,class:"last-access-detail"},fz={class:"details-section"},pz={key:0,class:"no-tasks"},vz={key:1,class:"tasks-list modal-tasks"},mz=["disabled","onChange"],gz={class:"task-text"},yz={class:"details-section contact-actions-section"},kz={class:"contact-buttons"},bz=["href"],_z=["href"],wz=["href"],Cz={__name:"AreaLeadSection",props:{eventId:{type:String,required:!0},areaIds:{type:Array,default:()=>[]},marshalId:{type:String,required:!0},route:{type:Array,default:()=>[]}},emits:["checklist-updated","loaded","checkin-updated"],setup(e,{expose:t,emit:o}){const{terms:a,termsLower:n}=ct(),{updatePendingCount:i}=Wd(),l=e,u=o,d=A(!1),h=A(null),f=A([]),m=A([]),y=A(null),k=A(!1),w=A(null),S=V(()=>{const O=new Set(l.areaIds);return O.size===0?[...m.value].sort((Z,ne)=>Ws(Z.name,ne.name)):m.value.filter(Z=>(Z.areaIds||[]).some(pe=>O.has(pe))).sort((Z,ne)=>Ws(Z.name,ne.name))}),T=(O,Z=60)=>O?O.length<=Z?O:O.substring(0,Z).trim()+"...":"",x=A(!1),C=A(null),_=A(null),$=async()=>{if(!(!l.eventId||l.areaIds.length===0)){if(d.value=!0,h.value=null,On()){try{const O=await Ma(l.eventId);if(O?.areaLeadDashboard){f.value=O.areaLeadDashboard.areas||[],m.value=O.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(O){console.warn("Failed to load cached dashboard:",O)}h.value="Offline - no cached data available",d.value=!1;return}try{const O=await Fs.getAreaLeadDashboard(l.eventId);f.value=O.data.areas||[],m.value=O.data.checkpoints||[];try{const Z=JSON.parse(JSON.stringify({areas:f.value,checkpoints:m.value}));await Ma(l.eventId)?await Ur(l.eventId,"areaLeadDashboard",Z):await or(l.eventId,{areaLeadDashboard:Z})}catch(Z){console.warn("Failed to cache dashboard:",Z)}}catch(O){console.error("Failed to load area lead dashboard:",O);try{const Z=await Ma(l.eventId);if(Z?.areaLeadDashboard){console.log("Loading area lead dashboard from cache after error"),f.value=Z.areaLeadDashboard.areas||[],m.value=Z.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(Z){console.warn("Failed to load cached dashboard:",Z)}h.value=O.response?.data?.message||"Failed to load dashboard"}finally{d.value=!1}}},M=O=>{y.value=y.value===O?null:O},H=O=>O.marshals.filter(Z=>Z.isCheckedIn).length,E=O=>{const Z=O.marshals.reduce((ne,pe)=>ne+pe.outstandingTaskCount,0);return O.outstandingTaskCount+Z},B=(O,Z)=>{C.value=O,_.value=Z,x.value=!0},R=()=>{x.value=!1,C.value=null,_.value=null},U=async(O,Z)=>{if(w.value)return;const ne=O.assignmentId||O.id;if(!ne){console.error("No assignment ID found for marshal:",O);return}w.value=O.marshalId;try{if(On())await mo("checkin_toggle",{eventId:l.eventId,assignmentId:ne}),O.isCheckedIn=!0,O.checkInTime=new Date().toISOString(),O.checkInMethod="AreaLead (pending)",await i(),u("checkin-updated");else if(await Aa.toggleCheckIn(l.eventId,ne),await $(),u("checkin-updated"),C.value?.marshalId===O.marshalId&&_.value){const pe=m.value.find(we=>we.checkpointId===_.value.checkpointId);if(pe){const we=pe.marshals.find(Ze=>Ze.marshalId===O.marshalId);we&&(C.value=we)}}}catch(pe){console.error("Failed to check in marshal:",pe),(On()||!pe.response)&&(await mo("checkin_toggle",{eventId:l.eventId,assignmentId:ne}),O.isCheckedIn=!0,O.checkInTime=new Date().toISOString(),O.checkInMethod="AreaLead (pending)",await i(),u("checkin-updated"))}finally{w.value=null}},F=async(O,Z)=>{if(k.value)return;k.value=!0;const pe={marshalId:Z.marshals.length>0?Z.marshals[0].marshalId:l.marshalId,contextType:O.contextType,contextId:O.contextId};try{On()?(await mo("checklist_complete",{eventId:l.eventId,itemId:O.itemId,data:pe}),Z.outstandingTasks=Z.outstandingTasks.filter(we=>we.itemId!==O.itemId),Z.outstandingTaskCount=Math.max(0,Z.outstandingTaskCount-1),await i(),u("checklist-updated")):(await Ut.complete(l.eventId,O.itemId,pe),await $(),u("checklist-updated"))}catch(we){console.error("Failed to complete task:",we),(On()||!we.response)&&(await mo("checklist_complete",{eventId:l.eventId,itemId:O.itemId,data:pe}),Z.outstandingTasks=Z.outstandingTasks.filter(Ze=>Ze.itemId!==O.itemId),Z.outstandingTaskCount=Math.max(0,Z.outstandingTaskCount-1),await i(),u("checklist-updated"))}finally{k.value=!1}},j=async(O,Z)=>{if(k.value)return;k.value=!0;const pe={marshalId:Z.marshals.length>0?Z.marshals[0].marshalId:l.marshalId,contextType:O.contextType,contextId:O.contextId,actorMarshalId:l.marshalId};try{On()?(await mo("checklist_uncomplete",{eventId:l.eventId,itemId:O.itemId,data:pe}),Z.completedTasks&&(Z.completedTasks=Z.completedTasks.filter(we=>we.itemId!==O.itemId)),Z.outstandingTasks||(Z.outstandingTasks=[]),Z.outstandingTasks.push(O),Z.outstandingTaskCount=(Z.outstandingTaskCount||0)+1,await i(),u("checklist-updated")):(await Ut.uncomplete(l.eventId,O.itemId,pe),await $(),u("checklist-updated"))}catch(we){console.error("Failed to uncomplete task:",we),(On()||!we.response)&&(await mo("checklist_uncomplete",{eventId:l.eventId,itemId:O.itemId,data:pe}),Z.completedTasks&&(Z.completedTasks=Z.completedTasks.filter(Ze=>Ze.itemId!==O.itemId)),Z.outstandingTasks||(Z.outstandingTasks=[]),Z.outstandingTasks.push(O),Z.outstandingTaskCount=(Z.outstandingTaskCount||0)+1,await i(),u("checklist-updated"))}finally{k.value=!1}},Y=async O=>{if(k.value||!C.value)return;k.value=!0;const Z={marshalId:C.value.marshalId,contextType:O.contextType,contextId:O.contextId};try{if(On())await mo("checklist_complete",{eventId:l.eventId,itemId:O.itemId,data:Z}),C.value.outstandingTasks=C.value.outstandingTasks.filter(ne=>ne.itemId!==O.itemId),C.value.outstandingTaskCount=Math.max(0,C.value.outstandingTaskCount-1),await i(),u("checklist-updated");else{if(await Ut.complete(l.eventId,O.itemId,Z),await $(),C.value&&_.value){const ne=m.value.find(pe=>pe.checkpointId===_.value.checkpointId);if(ne){const pe=ne.marshals.find(we=>we.marshalId===C.value.marshalId);pe&&(C.value=pe)}}u("checklist-updated")}}catch(ne){console.error("Failed to complete task:",ne),(On()||!ne.response)&&(await mo("checklist_complete",{eventId:l.eventId,itemId:O.itemId,data:Z}),C.value.outstandingTasks=C.value.outstandingTasks.filter(pe=>pe.itemId!==O.itemId),C.value.outstandingTaskCount=Math.max(0,C.value.outstandingTaskCount-1),await i(),u("checklist-updated"))}finally{k.value=!1}},oe=O=>O?new Date(O).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",Oe=O=>O?new Date(O).toLocaleString():"",ee=O=>{if(!O)return"";const Z=new Date(O),pe=new Date-Z,we=Math.floor(pe/6e4),Ze=Math.floor(we/60),Ne=Math.floor(Ze/24);return we<1?"just now":we<60?`${we}m ago`:Ze<24?`${Ze}h ago`:Ne===1?"yesterday":Ne<7?`${Ne}d ago`:Z.toLocaleDateString()},te=O=>({GPS:"GPS",Manual:"Manual",Admin:"Admin",AreaLead:`${a.value.area} Lead`})[O]||O;return t({areas:f,checkpoints:m,loading:d,loadDashboard:$}),We(()=>l.eventId,()=>{$()},{immediate:!0}),(O,Z)=>(v(),g("div",hU,[d.value?(v(),g("div",fU," Loading dashboard... ")):h.value?(v(),g("div",pU,[r("p",null,I(h.value),1),r("button",{onClick:$,class:"btn btn-secondary"},"Retry")])):S.value.length===0?(v(),g("div",vU,[r("p",null,"No "+I(N(n).checkpoints)+" in your "+I(N(n).areas)+".",1)])):(v(),g("div",mU,[(v(!0),g(Ae,null,Ue(S.value,ne=>(v(),g("div",{key:ne.checkpointId,class:"checkpoint-accordion-section"},[r("button",{class:ve(["checkpoint-accordion-header",{active:y.value===ne.checkpointId}]),onClick:pe=>M(ne.checkpointId)},[r("div",yU,[r("div",kU,[r("span",bU,I(ne.name),1),ne.areaName?(v(),g("span",_U,I(ne.areaName),1)):D("",!0)]),ne.description?(v(),g("div",wU,I(T(ne.description)),1)):D("",!0),r("div",CU,[r("span",LU,I(H(ne))+" / "+I(ne.marshals.length)+" checked in ",1),E(ne)>0?(v(),g("span",SU,I(E(ne))+" tasks ",1)):D("",!0)])]),r("span",IU,I(y.value===ne.checkpointId?"":"+"),1)],10,gU),y.value===ne.checkpointId?(v(),g("div",xU,[r("div",$U,[Me(wi,{locations:[{id:ne.checkpointId,name:ne.name,description:ne.description,latitude:ne.latitude,longitude:ne.longitude}],route:e.route,center:{lat:ne.latitude,lng:ne.longitude},zoom:16,"highlight-location-id":ne.checkpointId,"marshal-mode":!0,height:"280px"},null,8,["locations","route","center","highlight-location-id"])]),r("div",TU,[r("div",MU,I(N(a).people)+" ("+I(ne.marshals.length)+")",1),ne.marshals.length===0?(v(),g("div",AU," No "+I(N(n).people)+" assigned to this "+I(N(n).checkpoint)+". ",1)):(v(),g("div",EU,[(v(!0),g(Ae,null,Ue(ne.marshals,pe=>(v(),g("div",{key:pe.marshalId,class:ve(["marshal-card",{"is-checked-in":pe.isCheckedIn}]),onClick:we=>B(pe,ne)},[r("div",DU,[r("div",RU,[r("span",OU,I(pe.name),1),pe.outstandingTaskCount>0?(v(),g("span",BU,I(pe.outstandingTaskCount)+" tasks ",1)):D("",!0)]),r("div",NU,[r("div",{class:ve(["check-status",{"checked-in":pe.isCheckedIn}])},I(pe.isCheckedIn?" Checked In":"Not Checked In"),3),r("button",{onClick:lt(we=>U(pe),["stop"]),class:ve(["quick-checkin-btn",{"undo-btn":pe.isCheckedIn}]),disabled:w.value===pe.marshalId},I(w.value===pe.marshalId?"...":pe.isCheckedIn?"Undo":"Check In"),11,FU)])]),pe.isCheckedIn&&pe.checkInTime?(v(),g("div",UU,[Ye(I(oe(pe.checkInTime))+" ",1),pe.checkInMethod?(v(),g("span",zU," ("+I(te(pe.checkInMethod))+")",1)):D("",!0)])):D("",!0),pe.lastAccessedAt?(v(),g("div",HU," Last active: "+I(ee(pe.lastAccessedAt)),1)):D("",!0)],10,PU))),128))]))]),ne.outstandingTaskCount>0||ne.completedTasks&&ne.completedTasks.length>0?(v(),g("div",VU,[r("div",GU,I(N(a).checkpoint)+" tasks",1),r("div",qU,[(v(!0),g(Ae,null,Ue(ne.outstandingTasks,pe=>(v(),g("div",{key:pe.itemId,class:"task-item"},[r("input",{type:"checkbox",disabled:k.value,onChange:we=>F(pe,ne)},null,40,jU),r("span",ZU,I(pe.text),1)]))),128)),(v(!0),g(Ae,null,Ue(ne.completedTasks||[],pe=>(v(),g("div",{key:`completed-${pe.itemId}`,class:"task-item task-completed"},[r("input",{type:"checkbox",checked:"",disabled:k.value,onChange:we=>j(pe,ne)},null,40,WU),r("span",KU,I(pe.text),1)]))),128))])])):D("",!0)])):D("",!0)]))),128))])),Me(Ht,{show:x.value,title:C.value?.name||"Marshal Details",size:"large",onClose:R},{actions:Fe(()=>[r("button",{onClick:R,class:"btn btn-secondary"},"Close")]),default:Fe(()=>[C.value?(v(),g("div",JU,[r("div",YU,[Z[4]||(Z[4]=r("h4",null,"Contact Details",-1)),r("div",XU,[C.value.email?(v(),g("div",QU,[Z[2]||(Z[2]=r("span",{class:"contact-label"},"Email:",-1)),r("a",{href:`mailto:${C.value.email}`},I(C.value.email),9,ez)])):D("",!0),C.value.phoneNumber?(v(),g("div",tz,[Z[3]||(Z[3]=r("span",{class:"contact-label"},"Phone:",-1)),r("a",{href:`tel:${C.value.phoneNumber}`},I(C.value.phoneNumber),9,nz)])):D("",!0),!C.value.email&&!C.value.phoneNumber?(v(),g("div",oz," No contact details available. ")):D("",!0)])]),r("div",sz,[Z[8]||(Z[8]=r("h4",null,"Check-in Status",-1)),C.value.isCheckedIn?(v(),g("div",az,[r("div",iz,[Z[6]||(Z[6]=r("span",{class:"check-icon"},"",-1)),r("div",null,[Z[5]||(Z[5]=r("strong",null,"Checked In",-1)),r("p",lz,I(Oe(C.value.checkInTime)),1),C.value.checkInMethod?(v(),g("p",rz," Method: "+I(te(C.value.checkInMethod)),1)):D("",!0)])]),r("button",{onClick:Z[0]||(Z[0]=ne=>U(C.value,_.value)),class:"btn btn-secondary undo-checkin-btn",disabled:w.value===C.value.marshalId},I(w.value===C.value.marshalId?"Undoing...":"Undo Check-in"),9,cz)])):(v(),g("div",uz,[Z[7]||(Z[7]=r("div",{class:"not-checked-in"},[r("span",{class:"not-checked-icon"},""),r("span",null,"Not checked in")],-1)),r("button",{onClick:Z[1]||(Z[1]=ne=>U(C.value,_.value)),class:"btn btn-primary check-in-btn",disabled:w.value===C.value.marshalId},I(w.value===C.value.marshalId?"Checking in...":"Check In"),9,dz)])),C.value.lastAccessedAt?(v(),g("div",hz," Last active: "+I(ee(C.value.lastAccessedAt)),1)):D("",!0)]),r("div",fz,[r("h4",null,I(N(a).checklists)+" ("+I(C.value.outstandingTasks?.length||0)+" outstanding)",1),!C.value.outstandingTasks||C.value.outstandingTasks.length===0?(v(),g("div",pz," No outstanding tasks. ")):(v(),g("div",vz,[(v(!0),g(Ae,null,Ue(C.value.outstandingTasks,ne=>(v(),g("div",{key:ne.itemId,class:"task-item"},[r("input",{type:"checkbox",disabled:k.value,onChange:pe=>Y(ne)},null,40,mz),r("span",gz,I(ne.text),1)]))),128))]))]),r("div",yz,[r("div",kz,[C.value.phoneNumber?(v(),g("a",{key:0,href:`tel:${C.value.phoneNumber}`,class:"btn btn-primary"}," Call ",8,bz)):D("",!0),C.value.phoneNumber?(v(),g("a",{key:1,href:`sms:${C.value.phoneNumber}`,class:"btn btn-secondary"}," Text ",8,_z)):D("",!0),C.value.email?(v(),g("a",{key:2,href:`mailto:${C.value.email}`,class:"btn btn-secondary"}," Email ",8,wz)):D("",!0)])])])):D("",!0)]),_:1},8,["show","title"])]))}},Lz=He(Cz,[["__scopeId","data-v-067e0528"]]),Sz={key:0,class:"accordion-section"},Iz={class:"accordion-title"},xz=["innerHTML"],$z={class:"accordion-icon"},Tz={key:0,class:"accordion-content area-lead-accordion-content"},Mz={key:0,class:"area-filter-pills"},Az=["onClick"],Ez={__name:"MarshalAreaLeadSection",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedFilters:{type:Set,default:()=>new Set},filteredAreaIds:{type:Array,default:()=>[]},eventId:{type:String,required:!0},marshalId:{type:String,default:""},route:{type:Array,default:()=>[]}},emits:["toggle","toggle-filter","checklist-updated"],setup(e,{expose:t}){const{termsLower:o}=ct(),a=A(null);return t({areaLeadRef:a}),(n,i)=>e.isAreaLead?(v(),g("div",Sz,[r("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=l=>n.$emit("toggle"))},[r("span",Iz,[r("span",{class:"section-icon",innerHTML:N(Xn)("area")},null,8,xz),Ye(" Your "+I(e.areas.length===1?N(o).area:N(o).areas)+I(e.areas.length>1?` (${e.areas.length})`:""),1)]),r("span",$z,I(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",Tz,[e.areas.length>1?(v(),g("div",Mz,[(v(!0),g(Ae,null,Ue(e.areas,l=>(v(),g("button",{key:l.areaId,class:ve(["area-filter-pill",{selected:e.selectedFilters.has(l.areaId)}]),style:Qe(e.selectedFilters.has(l.areaId)?{backgroundColor:l.color||"#667eea",borderColor:l.color||"#667eea"}:{}),onClick:u=>n.$emit("toggle-filter",l.areaId)},I(l.name),15,Az))),128))])):D("",!0),Me(Lz,{ref_key:"areaLeadRef",ref:a,"event-id":e.eventId,"area-ids":e.filteredAreaIds,"marshal-id":e.marshalId,route:e.route,onChecklistUpdated:i[1]||(i[1]=l=>n.$emit("checklist-updated"))},null,8,["event-id","area-ids","marshal-id","route"])])):D("",!0)])):D("",!0)}},Pz=He(Ez,[["__scopeId","data-v-9278e6a8"]]),Dz={key:0,class:"accordion-section"},Rz={class:"accordion-title"},Oz=["innerHTML"],Bz={class:"accordion-icon"},Nz={key:0,class:"accordion-content area-lead-marshals-content"},Fz={class:"area-lead-marshals-list"},Uz=["onClick"],zz={class:"marshal-header-info"},Hz={class:"marshal-name-row"},Vz={class:"marshal-name"},Gz={class:"marshal-meta"},qz={class:"marshal-checkpoint"},jz={key:0,class:"marshal-task-count"},Zz={class:"accordion-icon"},Wz={key:0,class:"area-lead-marshal-content"},Kz={class:"marshal-checkin-section"},Jz={key:0,class:"marshal-contact-section"},Yz=["href"],Xz=["href"],Qz={key:1,class:"marshal-tasks-section"},eH={class:"tasks-label"},tH={class:"tasks-list"},nH=["checked","disabled","onChange"],oH={class:"task-text"},sH={key:2,class:"no-tasks-message"},aH={__name:"MarshalMarshalsList",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},marshals:{type:Array,default:()=>[]},expandedMarshalId:{type:String,default:null},checkingInMarshalId:{type:String,default:null},savingTask:{type:Boolean,default:!1}},emits:["toggle","toggle-marshal","check-in","toggle-task"],setup(e){const{terms:t,termsLower:o}=ct(),a=n=>{if(!n||n.length===0)return"";const i=l=>l.description?`${l.name} - ${l.description}`:l.name;return n.length===1?i(n[0]):n.map(i).join(", ")};return(n,i)=>e.isAreaLead&&e.marshals.length>0?(v(),g("div",Dz,[r("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=l=>n.$emit("toggle"))},[r("span",Rz,[r("span",{class:"section-icon",innerHTML:N(Xn)("marshal")},null,8,Oz),Ye(" Your "+I(e.marshals.length===1?N(o).person:N(o).people)+I(e.marshals.length>1?` (${e.marshals.length})`:""),1)]),r("span",Bz,I(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",Nz,[r("div",Fz,[(v(!0),g(Ae,null,Ue(e.marshals,l=>(v(),g("div",{key:l.marshalId,class:"area-lead-marshal-item"},[r("button",{class:ve(["area-lead-marshal-header",{active:e.expandedMarshalId===l.marshalId,"is-checked-in":l.isCheckedIn}]),onClick:u=>n.$emit("toggle-marshal",l.marshalId)},[r("div",zz,[r("div",Hz,[r("span",Vz,I(l.name),1),r("span",{class:ve(["check-status-badge",{"checked-in":l.isCheckedIn}])},I(l.isCheckedIn?"":""),3)]),r("div",Gz,[r("span",qz,I(a(l.checkpoints)),1),l.totalTaskCount>0?(v(),g("span",jz,I(l.completedTaskCount)+" / "+I(l.totalTaskCount)+" "+I(N(o).checklists)+" complete ",1)):D("",!0)])]),r("span",Zz,I(e.expandedMarshalId===l.marshalId?"":"+"),1)],10,Uz),e.expandedMarshalId===l.marshalId?(v(),g("div",Wz,[r("div",Kz,[Me(lc,{"is-checked-in":l.isCheckedIn,"check-in-time":l.checkInTime,"check-in-method":l.checkInMethod,"checked-in-by":l.checkedInBy,"marshal-name":l.marshalName,"is-loading":e.checkingInMarshalId===l.id,onToggle:u=>n.$emit("check-in",l)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"])]),l.email||l.phoneNumber?(v(),g("div",Jz,[l.phoneNumber?(v(),g("a",{key:0,href:`tel:${l.phoneNumber}`,class:"contact-link"},I(l.phoneNumber),9,Yz)):D("",!0),l.email?(v(),g("a",{key:1,href:`mailto:${l.email}`,class:"contact-link"},I(l.email),9,Xz)):D("",!0)])):D("",!0),l.allTasks.length>0?(v(),g("div",Qz,[r("div",eH,I(N(t).checklists),1),r("div",tH,[(v(!0),g(Ae,null,Ue(l.allTasks,u=>(v(),g("div",{key:`${u.itemId}-${u.contextId}`,class:ve(["task-item",{"task-completed":u.isCompleted}])},[r("input",{type:"checkbox",checked:u.isCompleted,disabled:e.savingTask,onChange:d=>n.$emit("toggle-task",u,l)},null,40,nH),r("span",oH,I(u.text),1)],2))),128))])])):(v(),g("div",sH," No "+I(N(o).checklists)+" assigned. ",1))])):D("",!0)]))),128))])])):D("",!0)])):D("",!0)}},iH=He(aH,[["__scopeId","data-v-163cea4d"]]),lH={class:"checkpoint-note-header"},rH={key:0,class:"pin-icon",title:"Pinned"},cH={class:"checkpoint-note-title"},uH={key:0,class:"checkpoint-note-content"},dH={__name:"NoteCard",props:{title:{type:String,required:!0},content:{type:String,default:""},priority:{type:String,default:"Normal"},isPinned:{type:Boolean,default:!1}},setup(e){const t=e,o=V(()=>(t.priority||"Normal").toLowerCase());return(a,n)=>(v(),g("div",{class:ve(["checkpoint-note-item",o.value])},[r("div",lH,[e.isPinned?(v(),g("span",rH,"")):D("",!0),r("span",{class:ve(["priority-indicator",o.value])},null,2),r("strong",cH,I(e.title),1),r("span",{class:ve(["priority-badge",o.value])},I(e.priority),3)]),e.content?(v(),g("div",uH,I(e.content),1)):D("",!0)],2))}},hH=He(dH,[["__scopeId","data-v-5f2df920"]]),fH={class:"checkpoint-accordion-section"},pH={class:"checkpoint-header-content"},vH={class:"checkpoint-title-row"},mH=["innerHTML"],gH={key:0,class:"checkpoint-check-icon"},yH={class:"checkpoint-name"},kH={key:1,class:"area-badge"},bH={key:2,class:"checkpoint-time-badge"},_H={key:3,class:"checkpoint-distance-badge"},wH={key:0,class:"checkpoint-description-preview"},CH={class:"accordion-icon"},LH={key:0,class:"checkpoint-accordion-content"},SH={key:0,class:"checkpoint-mini-map"},IH={viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",style:{"margin-right":"0.5rem"}},xH={class:"my-checkin-section"},$H={key:0,class:"check-in-error"},TH={key:1,class:"dynamic-location-section"},MH={class:"dynamic-location-header"},AH={class:"dynamic-badge"},EH={key:0,class:"last-update"},PH={key:0,class:"dynamic-location-actions"},DH=["disabled"],RH=["title"],OH={class:"checkpoint-marshals"},BH={class:"marshals-label"},NH={key:0,class:"marshals-list"},FH={key:0,class:"check-badge"},UH={key:1,class:"marshals-list-expanded"},zH=["onClick"],HH={class:"marshal-name-text"},VH={class:"marshal-status-icons"},GH={key:0,class:"check-badge"},qH={class:"expand-icon"},jH={key:0,class:"marshal-details-panel"},ZH={class:"detail-row"},WH={key:0,class:"detail-row"},KH={key:1,class:"detail-row"},JH={key:2,class:"detail-row"},YH=["href"],XH={key:3,class:"detail-row"},QH=["href"],eV={key:4,class:"contact-buttons-mini"},tV=["href"],nV=["href"],oV=["href"],sV={key:5,class:"checkpoint-marshal-checkin"},aV={key:2,class:"checkpoint-area-contacts"},iV={class:"marshals-label"},lV={class:"contact-list"},rV={key:3,class:"checkpoint-notes"},cV={class:"checkpoint-notes-list"},uV={__name:"CheckpointCard",props:{assignment:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},userLocation:{type:Object,default:null},toolbarActions:{type:Array,default:()=>[]},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},isCheckingIn:{type:Boolean,default:!1},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},isAreaLeadForCheckpoint:{type:Boolean,default:!1},expandedMarshalId:{type:String,default:null},notes:{type:Array,default:()=>[]},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},areaLeadAreaIds:{type:Array,default:()=>[]},allAssignmentLocationIds:{type:Array,default:()=>[]}},emits:["toggle","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update"],setup(e,{expose:t}){const{terms:o,termsLower:a}=ct(),n=io("marshalBranding",{headerStyle:{},headerTextColor:""}),i=bi({headerStyle:V(()=>Vr(n.headerStyle)),headerTextColor:V(()=>Vr(n.headerTextColor))}),l=e,u=A(null),d=V(()=>l.assignment.location?.isDynamic),h=V(()=>{const C=l.assignment.location?.name||l.assignment.locationName,_=l.assignment.location?.description;return _?`${C}  ${_}`:C}),f=V(()=>{if(!d.value)return!1;const C=l.assignment.location,_=C?.locationUpdateScopeConfigurations||C?.LocationUpdateScopeConfigurations||[];return ig({scopeConfigurations:_,marshalId:l.currentMarshalId,marshalAssignmentLocationIds:l.allAssignmentLocationIds,areaLeadAreaIds:l.areaLeadAreaIds,locationId:l.assignment.locationId,locationAreaIds:l.assignment.areaIds||[]})}),m=V(()=>{if(!l.userLocation?.lat||!l.userLocation?.lng)return null;const C=l.assignment.location;return!C?.latitude||!C?.longitude?null:_i(l.userLocation.lat,l.userLocation.lng,C.latitude,C.longitude)}),y=V(()=>{const C=m.value;return C==null?null:C<1e3?`${Math.round(C/10)*10} m`:`${(Math.round(C/100)/10).toFixed(1)} km`});t({mapRef:u});const k=C=>{const _=C?.iconType||"checkpoint",$=C?.iconColor||"#667eea",M={checkpoint:`<svg viewBox="0 0 24 24" fill="${$}" width="20" height="20"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>`,flag:`<svg viewBox="0 0 24 24" fill="${$}" width="20" height="20"><path d="M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"/></svg>`,star:`<svg viewBox="0 0 24 24" fill="${$}" width="20" height="20"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>`,water:`<svg viewBox="0 0 24 24" fill="${$}" width="20" height="20"><path d="M12 2c-5.33 4.55-8 8.48-8 11.8 0 4.98 3.8 8.2 8 8.2s8-3.22 8-8.2c0-3.32-2.67-7.25-8-11.8z"/></svg>`,medical:`<svg viewBox="0 0 24 24" fill="${$}" width="20" height="20"><path d="M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4v4z"/></svg>`};return M[_]||M.checkpoint},w=(C,_)=>{const $=M=>M?new Date(M).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"";return C&&_?`${$(C)} - ${$(_)}`:C?`from ${$(C)}`:_?`until ${$(_)}`:""},S=C=>C?new Date(C).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"",T=C=>({manual:"Manual",qr:"QR Code",gps:"GPS",admin:"Admin"})[C]||C,x=C=>C?new Date(C).toLocaleString():"";return(C,_)=>(v(),g("div",fH,[r("button",{class:ve(["checkpoint-accordion-header",{active:e.isExpanded,"checked-in":e.assignment.effectiveIsCheckedIn}]),onClick:_[0]||(_[0]=$=>C.$emit("toggle"))},[r("div",pH,[r("div",vH,[r("span",{class:"checkpoint-icon",innerHTML:k(e.assignment.location)},null,8,mH),e.assignment.effectiveIsCheckedIn?(v(),g("span",gH,"")):D("",!0),r("span",yH,I(e.assignment.location?.name||e.assignment.locationName),1),e.assignment.areaName?(v(),g("span",kH,I(e.assignment.areaName),1)):D("",!0),e.assignment.location?.startTime||e.assignment.location?.endTime?(v(),g("span",bH,I(w(e.assignment.location.startTime,e.assignment.location.endTime)),1)):D("",!0),y.value?(v(),g("span",_H,I(y.value),1)):D("",!0)]),e.assignment.location?.description?(v(),g("div",wH,I(e.assignment.location.description),1)):D("",!0)]),r("span",CH,I(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",LH,[e.assignment.location?(v(),g("div",SH,[Me(wi,{ref_key:"mapRef",ref:u,locations:e.allLocations,route:e.route,center:{lat:e.assignment.location.latitude,lng:e.assignment.location.longitude},zoom:16,"user-location":e.userLocation,"highlight-location-id":e.assignment.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:e.hasDynamicAssignment,"show-fullscreen":!0,"fullscreen-title":h.value,"fullscreen-header-style":i.headerStyle,"fullscreen-header-text-color":i.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,height:"280px",onMapClick:_[2]||(_[2]=$=>C.$emit("map-click",$)),onLocationClick:_[3]||(_[3]=$=>C.$emit("location-click",$)),onActionClick:_[4]||(_[4]=$=>C.$emit("action-click",$)),onVisibilityChange:_[5]||(_[5]=$=>C.$emit("visibility-change",$))},$d({_:2},[f.value?{name:"fullscreen-footer",fn:Fe(()=>[r("button",{class:"btn btn-primary",onClick:_[1]||(_[1]=$=>C.$emit("update-location"))},[(v(),g("svg",IH,[..._[9]||(_[9]=[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"},null,-1)])])),_[10]||(_[10]=Ye(" Update location ",-1))])]),key:"0"}:void 0]),1032,["locations","route","center","user-location","highlight-location-id","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions"])])):D("",!0),r("div",xH,[Me(lc,{"is-checked-in":e.assignment.effectiveIsCheckedIn,"check-in-time":e.assignment.checkInTime,"check-in-method":e.assignment.checkInMethod,"checked-in-by":e.assignment.checkedInBy,"marshal-name":e.currentMarshalName,"is-loading":e.isCheckingIn,onToggle:_[6]||(_[6]=$=>C.$emit("check-in"))},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading"]),e.checkInError?(v(),g("div",$H,I(e.checkInError),1)):D("",!0)]),d.value?(v(),g("div",TH,[r("div",MH,[r("span",AH,"Dynamic "+I(e.assignment.location.resolvedCheckpointTerm||N(a).checkpoint),1),e.assignment.location.lastLocationUpdate?(v(),g("span",EH," Last updated: "+I(x(e.assignment.location.lastLocationUpdate)),1)):D("",!0)]),f.value?(v(),g("div",PH,[r("button",{onClick:_[7]||(_[7]=$=>C.$emit("update-location")),class:"btn btn-update-location",disabled:e.updatingLocation},[..._[11]||(_[11]=[r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1),Ye(" Update location ",-1)])],8,DH),r("button",{onClick:_[8]||(_[8]=$=>C.$emit("toggle-auto-update")),class:ve(["btn btn-auto-update",{active:e.autoUpdateEnabled}]),title:e.autoUpdateEnabled?"Stop auto-updating":"Auto-update every 60 seconds"},[_[12]||(_[12]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})],-1)),Ye(" "+I(e.autoUpdateEnabled?"Stop":"Auto"),1)],10,RH)])):D("",!0)])):D("",!0),r("div",OH,[r("div",BH,I(N(o).people)+":",1),e.isAreaLeadForCheckpoint?(v(),g("div",UH,[(v(!0),g(Ae,null,Ue(e.assignment.allMarshals,$=>(v(),g("div",{key:$.marshalId,class:ve(["marshal-card-mini",{"is-you":$.marshalId===e.currentMarshalId,"checked-in":$.effectiveIsCheckedIn,expanded:e.expandedMarshalId===$.marshalId}])},[r("button",{class:"marshal-card-header",onClick:M=>C.$emit("toggle-marshal",$.marshalId)},[r("span",HH,I($.marshalName)+I($.marshalId===e.currentMarshalId?" (you)":""),1),r("span",VH,[$.effectiveIsCheckedIn?(v(),g("span",GH,"")):D("",!0),r("span",qH,I(e.expandedMarshalId===$.marshalId?"":"+"),1)])],8,zH),e.expandedMarshalId===$.marshalId?(v(),g("div",jH,[r("div",ZH,[_[13]||(_[13]=r("span",{class:"detail-label"},"Status:",-1)),r("span",{class:ve($.effectiveIsCheckedIn?"status-checked-in":"status-not-checked-in")},I($.effectiveIsCheckedIn?"Checked in":"Not checked in"),3)]),$.effectiveIsCheckedIn&&$.checkInTime?(v(),g("div",WH,[_[14]||(_[14]=r("span",{class:"detail-label"},"Check-in time:",-1)),r("span",null,I(S($.checkInTime)),1)])):D("",!0),$.checkInMethod?(v(),g("div",KH,[_[15]||(_[15]=r("span",{class:"detail-label"},"Method:",-1)),r("span",null,I(T($.checkInMethod)),1)])):D("",!0),$.email?(v(),g("div",JH,[_[16]||(_[16]=r("span",{class:"detail-label"},"Email:",-1)),r("a",{href:"mailto:"+$.email},I($.email),9,YH)])):D("",!0),$.phoneNumber?(v(),g("div",XH,[_[17]||(_[17]=r("span",{class:"detail-label"},"Phone:",-1)),r("a",{href:"tel:"+$.phoneNumber},I($.phoneNumber),9,QH)])):D("",!0),$.email||$.phoneNumber?(v(),g("div",eV,[$.phoneNumber?(v(),g("a",{key:0,href:"tel:"+$.phoneNumber,class:"btn btn-sm btn-primary"},"Call",8,tV)):D("",!0),$.phoneNumber?(v(),g("a",{key:1,href:"sms:"+$.phoneNumber,class:"btn btn-sm btn-secondary"},"Text",8,nV)):D("",!0),$.email?(v(),g("a",{key:2,href:"mailto:"+$.email,class:"btn btn-sm btn-secondary"},"Email",8,oV)):D("",!0)])):D("",!0),$.marshalId!==e.currentMarshalId?(v(),g("div",sV,[Me(lc,{"is-checked-in":$.effectiveIsCheckedIn,"check-in-time":$.checkInTime,"check-in-method":$.checkInMethod,"checked-in-by":$.checkedInBy,"marshal-name":$.marshalName,"is-loading":e.checkingInMarshalId===$.id,onToggle:M=>C.$emit("marshal-check-in",$)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"])])):D("",!0)])):D("",!0)],2))),128))])):(v(),g("div",NH,[(v(!0),g(Ae,null,Ue(e.assignment.allMarshals,$=>(v(),g("span",{key:$.marshalId,class:ve(["marshal-tag",{"is-you":$.marshalId===e.currentMarshalId,"checked-in":$.effectiveIsCheckedIn}])},[Ye(I($.marshalName)+I($.marshalId===e.currentMarshalId?" (you)":"")+" ",1),$.effectiveIsCheckedIn?(v(),g("span",FH,"")):D("",!0)],2))),128))]))]),e.assignment.areaContacts.length>0?(v(),g("div",aV,[r("div",iV,I(N(o).area)+" contacts:",1),r("div",lV,[(v(!0),g(Ae,null,Ue(e.assignment.areaContacts,$=>(v(),Ke(Lg,{key:$.marshalId,name:$.marshalName,role:$.role,phone:$.phone,email:$.email},null,8,["name","role","phone","email"]))),128))])])):D("",!0),e.notes.length>0?(v(),g("div",rV,[_[18]||(_[18]=r("div",{class:"marshals-label"},"Notes:",-1)),r("div",cV,[(v(!0),g(Ae,null,Ue(e.notes,$=>(v(),Ke(hH,{key:$.noteId,title:$.title,content:$.content,priority:$.priority,"is-pinned":$.isPinned},null,8,["title","content","priority","is-pinned"]))),128))])])):D("",!0)])):D("",!0)]))}},dV=He(uV,[["__scopeId","data-v-15401b08"]]),hV={class:"accordion-section"},fV={class:"accordion-title"},pV=["innerHTML"],vV={class:"accordion-icon"},mV={key:0,class:"accordion-content assignments-accordion-content"},gV={key:0,class:"empty-state"},yV={key:1,class:"checkpoint-accordion"},kV={__name:"MarshalAssignmentsSection",props:{isExpanded:{type:Boolean,default:!1},assignments:{type:Array,default:()=>[]},expandedCheckpointId:{type:String,default:null},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},userLocation:{type:Object,default:null},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},checkingInId:{type:String,default:null},checkingInAssignmentId:{type:String,default:null},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},expandedMarshalId:{type:String,default:null},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},areaLeadAreaIds:{type:Array,default:()=>[]},getToolbarActions:{type:Function,default:()=>[]},isAreaLeadForAreas:{type:Function,default:()=>!1},getNotesForCheckpoint:{type:Function,default:()=>[]}},emits:["toggle","toggle-checkpoint","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update"],setup(e,{expose:t}){const{termsLower:o}=ct(),a=e,n=V(()=>a.assignments.map(u=>u.locationId)),i={},l=(u,d)=>{d?i[u]=d:delete i[u]};return t({checkpointRefs:i}),(u,d)=>(v(),g("div",hV,[r("button",{class:ve(["accordion-header",{active:e.isExpanded}]),onClick:d[0]||(d[0]=h=>u.$emit("toggle"))},[r("span",fV,[r("span",{class:"section-icon",innerHTML:N(Xn)("checkpoint")},null,8,pV),Ye(" Your "+I(e.assignments.length===1?N(o).checkpoint:N(o).checkpoints)+I(e.assignments.length>1?` (${e.assignments.length})`:""),1)]),r("span",vV,I(e.isExpanded?"":"+"),1)],2),e.isExpanded?(v(),g("div",mV,[e.assignments.length===0?(v(),g("div",gV,[r("p",null,"You don't have any "+I(N(o).checkpoint)+" assignments yet.",1)])):(v(),g("div",yV,[(v(!0),g(Ae,null,Ue(e.assignments,h=>(v(),Ke(dV,{key:h.id,ref_for:!0,ref:f=>l(h.id,f),assignment:h,"is-expanded":e.expandedCheckpointId===h.id,"all-locations":e.allLocations,route:e.route,"user-location":e.userLocation,"toolbar-actions":e.getToolbarActions(h.id),"has-dynamic-assignment":e.hasDynamicAssignment,"current-marshal-id":e.currentMarshalId,"current-marshal-name":e.currentMarshalName,"is-checking-in":e.checkingInId===h.id,"check-in-error":e.checkingInAssignmentId===h.id?e.checkInError:"","checking-in-marshal-id":e.checkingInMarshalId,"is-area-lead-for-checkpoint":e.isAreaLeadForAreas(h.areaIds),"expanded-marshal-id":e.expandedMarshalId,notes:e.getNotesForCheckpoint(h.locationId,h.areaIds),"updating-location":e.updatingLocation,"auto-update-enabled":e.autoUpdateEnabled,"area-lead-area-ids":e.areaLeadAreaIds,"all-assignment-location-ids":n.value,onToggle:f=>u.$emit("toggle-checkpoint",h.id),onMapClick:d[1]||(d[1]=f=>u.$emit("map-click",f)),onLocationClick:d[2]||(d[2]=f=>u.$emit("location-click",f)),onActionClick:f=>u.$emit("action-click",h,f),onVisibilityChange:f=>u.$emit("visibility-change",h.id,f),onUpdateLocation:f=>u.$emit("update-location",h),onCheckIn:f=>u.$emit("check-in",h),onToggleMarshal:d[3]||(d[3]=f=>u.$emit("toggle-marshal",f)),onMarshalCheckIn:f=>u.$emit("marshal-check-in",f,h.locationId),onToggleAutoUpdate:f=>u.$emit("toggle-auto-update",h)},null,8,["assignment","is-expanded","all-locations","route","user-location","toolbar-actions","has-dynamic-assignment","current-marshal-id","current-marshal-name","is-checking-in","check-in-error","checking-in-marshal-id","is-area-lead-for-checkpoint","expanded-marshal-id","notes","updating-location","auto-update-enabled","area-lead-area-ids","all-assignment-location-ids","onToggle","onActionClick","onVisibilityChange","onUpdateLocation","onCheckIn","onMarshalCheckIn","onToggleAutoUpdate"]))),128))]))])):D("",!0)]))}},bV=He(kV,[["__scopeId","data-v-24c613ab"]]),Sg="marshal-branding-cache";function _V(e){if(!e||typeof window>"u")return null;try{const t=localStorage.getItem(`${Sg}-${e}`);return t?JSON.parse(t):null}catch{return null}}function wV(e,t){if(!(!e||typeof window>"u"))try{localStorage.setItem(`${Sg}-${e}`,JSON.stringify(t))}catch{}}function CV(e,t=null){const o=A(t?_V(t):null);We(()=>e.value,y=>{if(y&&t){const k={brandingPageGradientStart:y.brandingPageGradientStart,brandingPageGradientEnd:y.brandingPageGradientEnd,brandingHeaderGradientStart:y.brandingHeaderGradientStart,brandingHeaderGradientEnd:y.brandingHeaderGradientEnd,brandingAccentColor:y.brandingAccentColor,brandingLogoUrl:y.brandingLogoUrl,brandingLogoPosition:y.brandingLogoPosition};wV(t,k),o.value=k}},{immediate:!0});const a=(y,k)=>e.value?.[y]||o.value?.[y]||k,n=V(()=>{const y=a("brandingPageGradientStart",hn.pageGradientStart),k=a("brandingPageGradientEnd",hn.pageGradientEnd);return{background:`linear-gradient(135deg, ${y} 0%, ${k} 100%)`}}),i=V(()=>{const y=a("brandingHeaderGradientStart",hn.headerGradientStart),k=a("brandingHeaderGradientEnd",hn.headerGradientEnd);return{background:`linear-gradient(135deg, ${y} 0%, ${k} 100%)`}}),l=V(()=>{const y=a("brandingHeaderGradientStart",hn.headerGradientStart),k=a("brandingHeaderGradientEnd",hn.headerGradientEnd);return fg(y,k)}),u=V(()=>a("brandingAccentColor",hn.accentColor)),d=V(()=>fd(u.value)),h=V(()=>({background:u.value,color:d.value})),f=V(()=>{const y=a("brandingLogoUrl","");return y?y.startsWith("/api")?Ia+y.substring(4):y:""}),m=V(()=>a("brandingLogoPosition","left"));return{pageBackgroundStyle:n,headerStyle:i,headerTextColor:l,accentColor:u,accentTextColor:d,accentButtonStyle:h,brandingLogoUrl:f,brandingLogoPosition:m}}function LV(){const e=A(null),t=A(null);let o=null;const a=()=>{if(!("geolocation"in navigator)){console.warn("Geolocation not supported");return}console.log("Starting location tracking..."),o=navigator.geolocation.watchPosition(i=>{e.value={lat:i.coords.latitude,lng:i.coords.longitude},t.value=Date.now()},i=>{console.warn("Geolocation error:",{1:"Location permission denied. Please allow location access in your browser settings.",2:"Location unavailable. Make sure GPS is enabled on your device.",3:"Location request timed out. Please try again."}[i.code]||i.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},n=()=>{o!==null&&(navigator.geolocation.clearWatch(o),o=null)};return Ln(()=>{n()}),{userLocation:e,locationLastUpdated:t,startLocationTracking:a,stopLocationTracking:n}}function SV({eventId:e,currentMarshalId:t,currentPerson:o,assignments:a,areaLeadAreaIds:n,isAreaLead:i,allLocations:l,areas:u,terms:d,termsLower:h,areaLeadRef:f,areaLeadCheckpoints:m,sectionLastLoadedAt:y,updateCachedField:k,updatePendingCount:w}){const S=A([]),T=A(!1),x=A(null),C=A(!1),_=A("person"),$=A(null),M=V(()=>S.value.filter(O=>O.isCompleted&&["OnePerCheckpoint","OnePerArea","OneLeadPerArea"].includes(O.matchedScope)?O.completedByActorId===t.value:!0)),H=V(()=>M.value.filter(O=>O.isCompleted).length),E=V(()=>{const O=a.value.map(Z=>Z.locationId);return M.value.filter(Z=>Z.completionContextType==="Personal"?Z.contextOwnerMarshalId===t.value:Z.completionContextType==="Checkpoint"?O.includes(Z.completionContextId):Z.completionContextType==="Area"?n.value.includes(Z.completionContextId):!0)}),B=V(()=>{if(!i.value)return[];const O=a.value.map(Z=>Z.locationId);return M.value.filter(Z=>Z.completionContextType==="Personal"?Z.contextOwnerMarshalId!==t.value:Z.completionContextType==="Checkpoint"?!O.includes(Z.completionContextId):Z.completionContextType==="Area"?!n.value.includes(Z.completionContextId):!1)}),R=V(()=>E.value.map(O=>({...O,localIsCompleted:O.isCompleted,isModified:!1}))),U=V(()=>B.value.map(O=>({...O,localIsCompleted:O.isCompleted,isModified:!1}))),F=V(()=>{const O=f.value?.checkpoints||m.value||[];if(O.length===0)return[];const Z=[],ne=new Set;for(const pe of O)for(const we of pe.marshals||[])ne.has(we.marshalId)||(ne.add(we.marshalId),Z.push(we));return Z}),j=V(()=>{if(i.value)return"none";const O=M.value,Z=new Set;for(const ne of O)ne.completionContextType==="Checkpoint"&&ne.completionContextId&&Z.add(ne.completionContextId);return Z.size>1?"checkpoint":"none"}),Y=V(()=>{const O=M.value,Z={};for(const ne of O){let pe,we;ne.completionContextType==="Checkpoint"&&ne.completionContextId?(pe=`checkpoint_${ne.completionContextId}`,we=l.value.find(Ne=>Ne.id===ne.completionContextId)?.name||"Unknown "+d.value.checkpoint):ne.completionContextType==="Area"&&ne.completionContextId?(pe=`area_${ne.completionContextId}`,we=u.value.find(Ne=>Ne.id===ne.completionContextId)?.name||"Unknown "+d.value.area):(pe="personal",we="Personal"),Z[pe]||(Z[pe]={key:pe,name:we,items:[],completedCount:0}),Z[pe].items.push(ne),ne.isCompleted&&Z[pe].completedCount++}return Object.values(Z).sort((ne,pe)=>ne.name.localeCompare(pe.name,void 0,{numeric:!0,sensitivity:"base"}))}),oe=O=>{$.value=$.value===O?null:O},Oe=O=>{if(!O.completionContextType||!O.completionContextId)return null;if(O.completionContextType==="Checkpoint"){const Z=l.value.find(pe=>pe.id===O.completionContextId);if(!Z)return null;const ne=Z.description?` - ${Z.description}`:"";return`At ${h.value.checkpoint} ${Z.name}${ne}`}if(O.completionContextType==="Area"){const Z=u.value.find(ne=>ne.id===O.completionContextId);return Z?`At ${h.value.area} ${Z.name}`:null}return O.completionContextType==="Personal"?"Personal item":null},ee=async(O=!1)=>{if(!t.value){console.warn("No marshal ID, skipping checklist load");return}O||(T.value=!0),x.value=null;try{const Z=e.value;console.log("Fetching checklist for marshal:",t.value);let pe=(await Ut.getMarshalChecklist(Z,t.value)).data||[];if(i.value&&n.value.length>0){console.log("Fetching area checklists for areas:",n.value);const we=n.value.map(Ge=>Ut.getAreaChecklist(Z,Ge).catch(Xe=>(console.warn(`Failed to fetch checklist for area ${Ge}:`,Xe),{data:[]}))),Ze=await Promise.all(we),Ne=new Map;for(const Ge of pe){const Xe=`${Ge.itemId}_${Ge.completionContextType}_${Ge.completionContextId}`;Ne.set(Xe,Ge)}for(const Ge of Ze)for(const Xe of Ge.data||[]){const Q=`${Xe.itemId}_${Xe.completionContextType}_${Xe.completionContextId}`;Ne.has(Q)||Ne.set(Q,Xe)}pe=Array.from(Ne.values()),console.log("Merged checklist items:",pe.length)}S.value=pe,y?.value&&(y.value.checklist=Date.now()),console.log("Checklist loaded:",S.value.length,"items")}catch(Z){console.error("Failed to load checklist:",Z.response?.status,Z.response?.data),x.value=Z.response?.data?.message||"Failed to load checklist"}finally{O||(T.value=!1)}};return{checklistItems:S,checklistLoading:T,checklistError:x,savingChecklist:C,checklistGroupBy:_,expandedChecklistGroup:$,visibleChecklistItems:M,completedChecklistCount:H,myChecklistItems:E,areaChecklistItems:B,myChecklistItemsWithLocalState:R,areaChecklistItemsWithLocalState:U,areaMarshalsForChecklist:F,effectiveChecklistGroupBy:j,groupedChecklistItems:Y,loadChecklist:ee,handleToggleChecklist:async O=>{if(C.value)return;C.value=!0;const Z=e.value,ne={marshalId:O.contextOwnerMarshalId||t.value,contextType:O.completionContextType,contextId:O.completionContextId,actorMarshalId:t.value};try{O.isCompleted?On()?(await mo("checklist_uncomplete",{eventId:Z,itemId:O.itemId,data:ne}),O.isCompleted=!1,O.completedAt=null,O.completedByActorName=null,w&&await w()):(await Ut.uncomplete(Z,O.itemId,ne),await ee(!0)):On()?(await mo("checklist_complete",{eventId:Z,itemId:O.itemId,data:ne}),O.isCompleted=!0,O.completedAt=new Date().toISOString(),O.completedByActorName=o.value?.name||"You",w&&await w()):(await Ut.complete(Z,O.itemId,ne),await ee(!0)),k&&await k(Z,"checklist",JSON.parse(JSON.stringify(S.value)))}catch(pe){if(console.error("Failed to toggle checklist item:",pe),On()||!pe.response){const we=O.isCompleted?"checklist_uncomplete":"checklist_complete";await mo(we,{eventId:Z,itemId:O.itemId,data:ne}),O.isCompleted?(O.isCompleted=!1,O.completedAt=null,O.completedByActorName=null):(O.isCompleted=!0,O.completedAt=new Date().toISOString(),O.completedByActorName=o.value?.name||"You"),w&&await w(),k&&await k(Z,"checklist",JSON.parse(JSON.stringify(S.value)))}}finally{C.value=!1}},toggleChecklistGroup:oe,getContextName:Oe}}function IV({eventId:e,allLocations:t,userLocation:o,locationLastUpdated:a}){const n=A(!1),i=A(null),l=A(null),u=A(null),d=A(!1),h=A(!1),f=A(!1);let m=null,y=null,k=null;const w=O=>O?.isDynamic===!0||O?.IsDynamic===!0,S=(O,Z,ne,pe)=>{const we=t.value.find(Ze=>Ze.id===O);we&&(we.latitude=Z,we.longitude=ne,we.lastLocationUpdate=pe)},T=O=>{i.value=O,l.value=null,u.value=null,n.value=!0},x=()=>{n.value=!1,i.value=null,l.value=null,u.value=null,f.value=!1},C=()=>{n.value=!1,f.value=!0},_=()=>{f.value=!1,n.value=!0},$=async(O,Z,ne,pe,we=null)=>{d.value=!0;try{const Ze=e.value,Ne={latitude:Z,longitude:ne,sourceType:pe};we&&(Ne.sourceCheckpointId=we);const Ge=await Bn.updatePosition(Ze,O,Ne);Ge.data.success&&(h.value&&U(),S(O,Ge.data.latitude,Ge.data.longitude,Ge.data.lastLocationUpdate))}catch(Ze){console.error("Failed to update location:",Ze),Ze.response?.status===403?alert("You do not have permission to update this location."):alert("Failed to update location. Please try again.")}finally{d.value=!1}},M=async()=>{if(i.value){d.value=!0,l.value=null;try{let O,Z;if(o.value&&a?.value&&Date.now()-a.value<3e4&&(O=o.value.lat,Z=o.value.lng),!O||!Z){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const Ze=await new Promise((Ne,Ge)=>{navigator.geolocation.getCurrentPosition(Ne,Ge,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4})});O=Ze.coords.latitude,Z=Ze.coords.longitude}const ne=e.value,pe=i.value.locationId,we=await Bn.updatePosition(ne,pe,{latitude:O,longitude:Z,sourceType:"gps"});we.data.success&&(u.value="Location updated successfully!",S(pe,we.data.latitude,we.data.longitude,we.data.lastLocationUpdate),setTimeout(()=>x(),1500))}catch(O){console.error("Failed to update location with GPS:",O),O.response?.status===403?l.value="You do not have permission to update this location.":O.code===1?l.value="Location access denied. Please enable location permissions.":O.code===2?l.value="Unable to determine your location. Please try again.":O.code===3||O.message?.includes("Timeout")?l.value="GPS timed out. Please ensure location services are enabled and try again.":l.value="Failed to update location. Please try again."}finally{d.value=!1}}},H=async O=>{if(!i.value)return;const Z=t.value.find(ne=>ne.id===O);if(!Z){l.value="Source checkpoint not found.";return}d.value=!0,l.value=null;try{const ne=e.value,pe=i.value.locationId,we=await Bn.updatePosition(ne,pe,{latitude:Z.latitude,longitude:Z.longitude,sourceType:"checkpoint",sourceCheckpointId:O});we.data.success&&(h.value&&U(),u.value=`Location copied from ${Z.name}!`,S(pe,we.data.latitude,we.data.longitude,we.data.lastLocationUpdate),setTimeout(()=>x(),1500))}catch(ne){console.error("Failed to copy location from checkpoint:",ne),ne.response?.status===403?l.value="You do not have permission to update this location.":l.value="Failed to update location. Please try again."}finally{d.value=!1}},E=async(O,Z)=>{if(i.value){d.value=!0,l.value=null;try{const ne=e.value,pe=i.value.locationId,we=await Bn.updatePosition(ne,pe,{latitude:O,longitude:Z,sourceType:"manual"});we.data.success&&(u.value="Location updated successfully!",S(pe,we.data.latitude,we.data.longitude,we.data.lastLocationUpdate),setTimeout(()=>x(),1500))}catch(ne){console.error("Failed to update location manually:",ne),ne.response?.status===403?l.value="You do not have permission to update this location.":l.value="Failed to update location. Please try again."}finally{d.value=!1}}},B=async O=>{if(!(!O||!("geolocation"in navigator)))try{const Z=await new Promise((we,Ze)=>{navigator.geolocation.getCurrentPosition(we,Ze,{enableHighAccuracy:!0,timeout:15e3})}),ne=e.value,pe=O.locationId;await Bn.updatePosition(ne,pe,{latitude:Z.coords.latitude,longitude:Z.coords.longitude,sourceType:"gps"},{skipLoadingOverlay:!0}),S(pe,Z.coords.latitude,Z.coords.longitude,new Date().toISOString())}catch(Z){console.warn("Auto-update location failed:",Z)}},R=O=>{h.value=!0,B(O),m=setInterval(()=>{B(O)},6e4)},U=()=>{h.value=!1,m&&(clearInterval(m),m=null)},F=O=>{h.value?U():R(O)},j=()=>{y||!t.value.some(Z=>Z.isDynamic||Z.IsDynamic)||(y=setInterval(async()=>{try{const Z=e.value,ne=await Bn.getDynamicCheckpoints(Z,{skipLoadingOverlay:!0});if(ne.data&&Array.isArray(ne.data))for(const pe of ne.data){const we=t.value.find(Ze=>Ze.id===pe.checkpointId);we&&(we.latitude=pe.latitude,we.longitude=pe.longitude,we.lastLocationUpdate=pe.lastLocationUpdate)}}catch(Z){console.warn("Failed to poll dynamic checkpoints:",Z)}},6e4))},Y=()=>{y&&(clearInterval(y),y=null)},oe=async()=>{try{const O=e.value,Z=await Bn.getByEvent(O,{skipLoadingOverlay:!0});if(Z.data&&Array.isArray(Z.data))for(const ne of Z.data){const pe=t.value.find(we=>we.id===ne.id);pe&&(pe.latitude=ne.latitude,pe.longitude=ne.longitude,ne.lastLocationUpdate&&(pe.lastLocationUpdate=ne.lastLocationUpdate))}}catch(O){console.warn("Failed to poll all checkpoint locations:",O)}};return{showLocationUpdateModal:n,updatingLocationFor:i,locationUpdateError:l,locationUpdateSuccess:u,updatingLocation:d,autoUpdateEnabled:h,selectingLocationOnMap:f,isDynamicCheckpoint:w,openLocationUpdateModal:T,closeLocationUpdateModal:x,startMapLocationSelect:C,cancelMapLocationSelect:_,updateDynamicCheckpointLocation:$,updateLocationWithGps:M,updateLocationFromCheckpoint:H,updateLocationManually:E,toggleAutoUpdate:F,startAutoUpdate:R,stopAutoUpdate:U,startDynamicCheckpointPolling:j,stopDynamicCheckpointPolling:Y,startAllCheckpointsPolling:()=>{k||(oe(),k=setInterval(oe,6e4))},stopAllCheckpointsPolling:()=>{k&&(clearInterval(k),k=null)},handleMapClickForLocation:O=>{f.value&&i.value&&($(i.value.locationId,O.lat,O.lng,"manual"),f.value=!1)}}}function xV({eventId:e,assignments:t,allLocations:o,areaLeadRef:a,areaLeadCheckpoints:n,areaLeadMarshalDataVersion:i,updatePendingCount:l,updateCachedField:u}){const{termsLower:d}=ct(),h=A(null),f=A(null),m=A(null),y=A(!1),k=A(null),w=A(new Set),S=A(!1),T=A(""),x=U=>{if(!U)return!0;const F=new Date(U);return(new Date-F)/(1e3*60*60)>24},C=U=>U?new Date(U).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",_=U=>{if(!U)return"";switch(U){case"GPS":return"GPS";case"Manual":return"Manual";case"AreaLead":return"By area lead";default:return U}},$=U=>{w.value.add(U),y.value=!1,k.value=null},M=()=>{S.value=!1,T.value=""},H=U=>U<1e3?`${Math.round(U/10)*10} m`:`${(Math.round(U/100)/10).toFixed(1)} km`,E=(U,F,j)=>{if(U==null||F==null)return;const Y=o.value?.find(te=>te.id===j);if(!Y)return;const oe=Y.latitude,Oe=Y.longitude;if(oe==null||Oe==null)return;const ee=_i(U,F,oe,Oe);if(ee>50){const te=H(ee);T.value=`Thanks for checking in. Just so you know, it's possible you are more than ${te} from your ${d.value.checkpoint} area.`,S.value=!0}},B=async(U,F=!0,j=null)=>{if(!U?.id){m.value="Cannot check in: Assignment ID is missing";return}h.value=U.id,f.value=U.id,m.value=null;const Y=e.value;if(!Y){m.value="Cannot check in: Event ID is missing",h.value=null,f.value=null;return}const oe=U.effectiveIsCheckedIn!==void 0?U.effectiveIsCheckedIn:U.isCheckedIn&&!x(U.checkInTime),Oe=U.isCheckedIn&&!oe,ee=oe?"check-out":Oe?"refresh":"check-in",te=!oe;let O=null,Z=null,ne="Manual";if(F&&!oe&&"geolocation"in navigator)try{const we=await new Promise((Ze,Ne)=>{navigator.geolocation.getCurrentPosition(Ze,Ne,{enableHighAccuracy:!0,timeout:5e3})});O=we.coords.latitude,Z=we.coords.longitude,ne="GPS"}catch(we){console.log("GPS unavailable, using manual check-in:",we.message)}const pe={latitude:O,longitude:Z,action:ee};try{if(On()){await mo("checkin_toggle",{eventId:Y,assignmentId:U.id,gpsData:pe});const we=t.value.findIndex(Ze=>Ze.id===U.id);if(we!==-1&&(t.value[we]={...t.value[we],isCheckedIn:te,checkInTime:te?new Date().toISOString():null,checkInMethod:te?`${ne} (pending)`:null,checkInLatitude:O,checkInLongitude:Z}),j){const Ze=o.value.find(Ne=>Ne.id===j);if(Ze?.assignments){const Ne=Ze.assignments.find(Ge=>Ge.id===U.id||Ge.marshalId===U.marshalId);Ne&&(Ne.isCheckedIn=te,Ne.checkInTime=te?new Date().toISOString():null)}}l&&await l(),u&&await u(Y,"locations",o.value)}else{const we=await Aa.toggleCheckIn(Y,U.id,pe),Ze=t.value.findIndex(Ne=>Ne.id===U.id);if(Ze!==-1&&(t.value[Ze]=we.data),j){const Ne=o.value.find(Ge=>Ge.id===j);if(Ne?.assignments){const Ge=Ne.assignments.find(Xe=>Xe.id===U.id||Xe.marshalId===U.marshalId);Ge&&Object.assign(Ge,we.data)}}}if(j&&a?.value?.loadDashboard&&await a.value.loadDashboard(),i&&i.value++,te&&O!=null&&Z!=null){const we=j||U.locationId;we&&E(O,Z,we)}}catch(we){if(On()||!we.response){await mo("checkin_toggle",{eventId:Y,assignmentId:U.id,gpsData:pe});const Ze=t.value.findIndex(Ne=>Ne.id===U.id);Ze!==-1&&(t.value[Ze]={...t.value[Ze],isCheckedIn:te,checkInTime:te?new Date().toISOString():null,checkInMethod:te?"Manual (pending)":null}),l&&await l()}else we.response?.data?.message?m.value=we.response.data.message:we.message?m.value=we.message:m.value=`Failed to ${ee}. Please try again.`}finally{h.value=null,f.value=null}};return{checkingIn:h,checkingInAssignment:f,checkInError:m,showCheckInReminderModal:y,checkInReminderCheckpoint:k,dismissedCheckInReminders:w,showDistanceWarning:S,distanceWarningMessage:T,isCheckInStale:x,formatCheckInTime:C,formatCheckInMethod:_,handleCheckInToggle:B,handleAreaLeadMarshalCheckIn:async U=>{const j=(a?.value?.checkpoints||n?.value||[]).find(O=>O.marshals?.some(Z=>Z.marshalId===U.marshalId));if(!j){console.error("Could not find checkpoint for marshal:",U);return}const Y=j.marshals.find(O=>O.marshalId===U.marshalId);if(!Y)return;const oe=Y.assignmentId||Y.id;if(!oe){console.error("No assignment ID found for marshal:",Y);return}const Oe=!U.isCheckedIn,ee={id:oe,marshalId:U.marshalId,isCheckedIn:U.isCheckedIn,effectiveIsCheckedIn:U.isCheckedIn};await B(ee,!1,j.checkpointId||j.locationId);const te=[a?.value?.checkpoints,n?.value].filter(Boolean);for(const O of te)for(const Z of O){const ne=Z.marshals?.find(pe=>pe.marshalId===U.marshalId);ne&&(ne.isCheckedIn=Oe,ne.checkInTime=Oe?new Date().toISOString():null,ne.checkInMethod=Oe?"AreaLead":null)}i&&i.value++},dismissCheckInReminder:$,dismissDistanceWarning:M}}function $V({eventId:e,currentMarshalId:t,isAreaLead:o,areaLeadAreaIds:a,sectionLastLoadedAt:n,showMessage:i}){const l=A([]),u=A(!1),d=A(null),h=A(!1),f=A(!1),m=A(""),y=A(!1),k=A(!1),w=A(!1),S=V(()=>l.value.filter(B=>B.status==="open"||B.status==="acknowledged"||B.status==="in_progress").length),T=async()=>{const B=e.value;u.value=!0;try{const R=new Map;if(o.value&&a.value.length>0)for(const U of a.value)try{const j=(await vs.getForArea(B,U)).data.incidents||[];for(const Y of j)R.set(Y.incidentId,Y)}catch(F){console.warn(`Failed to load incidents for area ${U}:`,F)}try{const F=(await vs.getAll(B)).data.incidents||[];for(const j of F)j.reportedBy?.marshalId===t.value&&R.set(j.incidentId,j)}catch(U){console.debug("Could not load all incidents:",U)}l.value=Array.from(R.values()).sort((U,F)=>new Date(F.incidentTime||F.createdAt)-new Date(U.incidentTime||U.createdAt)),n?.value&&(n.value.incidents=Date.now()),console.log("My incidents loaded:",l.value.length)}catch(R){console.error("Failed to load incidents:",R)}finally{u.value=!1}},x=async B=>{w.value=!0;try{await vs.create(e.value,B),k.value=!1,T(),i&&i("Incident Reported","An administrator will review it shortly.")}catch(R){console.error("Failed to report incident:",R),i&&i("Error",R.response?.data?.message||"Failed to report incident. Please try again.")}finally{w.value=!1}},C=B=>{d.value=B,h.value=!0},_=()=>{h.value=!1,d.value=null},$=async({incidentId:B,status:R})=>{try{await vs.updateStatus(e.value,B,{status:R});const U=l.value.find(F=>F.incidentId===B);U&&(U.status=R),d.value?.incidentId===B&&(d.value.status=R)}catch(U){console.error("Failed to update incident status:",U),i&&i("Error","Failed to update status. Please try again.")}},M=()=>{m.value="",f.value=!0},H=()=>{f.value=!1,m.value=""};return{myIncidents:l,incidentsLoading:u,selectedIncident:d,showIncidentDetail:h,showAddIncidentNoteModal:f,incidentNoteText:m,submittingIncidentNote:y,showReportIncident:k,reportingIncident:w,openIncidentsCount:S,loadMyIncidents:T,handleReportIncident:x,openIncidentDetail:C,closeIncidentDetail:_,handleIncidentStatusChange:$,openAddIncidentNoteModal:M,closeAddIncidentNoteModal:H,submitIncidentNote:async()=>{if(!(!m.value.trim()||!d.value)){y.value=!0;try{await vs.addNote(e.value,d.value.incidentId,m.value.trim()),H(),T();const B=await vs.get(e.value,d.value.incidentId);d.value=B.data}catch(B){console.error("Failed to add note:",B),i&&i("Error","Failed to add note. Please try again.")}finally{y.value=!1}}}}}const Mp='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><circle cx="12" cy="12" r="4"/><path d="M13 4.069V2h-2v2.069A8.01 8.01 0 0 0 4.069 11H2v2h2.069A8.008 8.008 0 0 0 11 19.931V22h2v-2.069A8.007 8.007 0 0 0 19.931 13H22v-2h-2.069A8.008 8.008 0 0 0 13 4.069zM12 18c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6z"/></svg>',Ap='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>',TV='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="18" height="18"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>',MV='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="18" height="18"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>';function AV({userLocation:e,assignmentsWithDetails:t,courseMapRef:o}){const{termsLower:a}=ct(),n=A({userLocationInView:!1,highlightedLocationInView:!1,highlightedLocationsVisibility:{}}),i=A(!1),l=A(-1),u=A({}),d={},h=V(()=>t.value.filter(x=>x.location?.latitude&&x.location?.longitude&&!(x.location.latitude===0&&x.location.longitude===0))),f=V(()=>{const x=[];return x.push({id:"toggle-other-checkpoints",label:i.value?"Show all "+a.value.checkpoints:"Show only mine",icon:"custom",customIcon:i.value?TV:MV}),e.value&&!n.value.userLocationInView&&x.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:Mp}),h.value.length>0&&!n.value.highlightedLocationInView&&x.push({id:"recenter-checkpoint",label:"My "+a.value.checkpoint,icon:"custom",customIcon:Ap}),x}),m=x=>{const C=n.value,_=C.userLocationInView!==x.userLocationInView||C.highlightedLocationInView!==x.highlightedLocationInView,$=JSON.stringify(C.highlightedLocationsVisibility)!==JSON.stringify(x.highlightedLocationsVisibility||{});(_||$)&&(n.value={...x,highlightedLocationsVisibility:x.highlightedLocationsVisibility||{}})},y=()=>{const x=h.value;if(x.length===0)return null;if(x.length===1)return l.value=0,x[0];const C=n.value.highlightedLocationsVisibility||{},_=[];for(let H=0;H<x.length;H++){const E=x[H].locationId;C[E]===!1&&_.push(H)}if(_.length===0)return l.value=0,x[0];if(_.length===1)return l.value=_[0],x[_[0]];const $=l.value;let M=-1;for(const H of _)if(H>$){M=H;break}return M===-1&&(M=_[0]),l.value=M,x[M]};return{courseMapVisibility:n,courseMapActions:f,hideOtherCheckpoints:i,handleCourseMapVisibilityChange:m,handleCourseMapAction:({actionId:x})=>{if(x==="toggle-other-checkpoints")i.value=!i.value;else if(x==="recenter-user"&&e.value)o.value?.recenterOnUserLocation();else if(x==="recenter-checkpoint"){const C=y();C?.location&&o.value?.recenterOnLocation(C.location.latitude,C.location.longitude)}},checkpointMapVisibility:u,checkpointMapRefs:d,getCheckpointMapActions:x=>{const C=[],_=u.value[x]||{userLocationInView:!1,highlightedLocationInView:!1};return e.value&&!_.userLocationInView&&C.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:Mp}),_.highlightedLocationInView||C.push({id:"recenter-checkpoint",label:a.value.checkpoint.charAt(0).toUpperCase()+a.value.checkpoint.slice(1),icon:"custom",customIcon:Ap}),C},handleCheckpointMapVisibilityChange:(x,C)=>{const _=u.value[x];(!_||_.userLocationInView!==C.userLocationInView||_.highlightedLocationInView!==C.highlightedLocationInView)&&(u.value={...u.value,[x]:C})},handleCheckpointMapAction:(x,{actionId:C})=>{const _=d[x.id];C==="recenter-user"&&e.value?_?.recenterOnUserLocation():C==="recenter-checkpoint"&&x.location&&_?.recenterOnLocation(x.location.latitude,x.location.longitude)}}}function EV({eventId:e,currentMarshalId:t,areaLeadRef:o,areaLeadCheckpoints:a,areaChecklistItems:n,areaLeadAreaIds:i,loadChecklist:l}){const u=A(null),d=A(!1),h=A(0),f=k=>{u.value=u.value===k?null:k},m=V(()=>{h.value;const k=o?.value?.checkpoints,w=a?.value,S=k?.length>0?k:w||[],T=n?.value||[],x=new Map;for(const _ of S){const $=_.marshals||_.Marshals||[],M=_.checkpointId||_.CheckpointId,H=_.name||_.Name,E=_.description||_.Description,B=_.areaIds||_.AreaIds||[];for(const R of $){const U=R.marshalId||R.MarshalId;if(!U)continue;x.has(U)||x.set(U,{...R,marshalId:U,checkpoints:[],checkpointIds:new Set,areaIds:new Set,allTasks:[],totalTaskCount:0,completedTaskCount:0});const F=x.get(U);F.checkpoints.push({checkpointId:M,name:H,description:E}),F.checkpointIds.add(M);for(const j of B)F.areaIds.add(j)}}for(const _ of T){const $=_.completionContextType,M=_.completionContextId;let H=[];if($==="Personal"){const E=_.contextOwnerMarshalId;E&&x.has(E)&&(H=[x.get(E)])}else if($==="Checkpoint")for(const E of x.values())E.checkpointIds.has(M)&&H.push(E);else if($==="Area")for(const E of x.values())E.areaIds.has(M)&&H.push(E);else H=Array.from(x.values());for(const E of H)E.allTasks.push({..._,isCompleted:_.isCompleted||_.localIsCompleted}),E.totalTaskCount++,(_.isCompleted||_.localIsCompleted)&&E.completedTaskCount++}return Array.from(x.values()).map(_=>({..._,checkpointIds:Array.from(_.checkpointIds),areaIds:Array.from(_.areaIds)})).sort((_,$)=>(_.name||"").localeCompare($.name||"",void 0,{sensitivity:"base"}))});return{expandedAreaLeadMarshal:u,savingAreaLeadMarshalTask:d,areaLeadMarshalDataVersion:h,allAreaLeadMarshals:m,toggleAreaLeadMarshalExpansion:f,toggleAreaLeadMarshalTask:async(k,w)=>{if(d.value)return;d.value=!0;const S={marshalId:w.marshalId,contextType:k.contextType,contextId:k.contextId,actorMarshalId:t.value};try{k.isCompleted?await Ut.uncomplete(e.value,k.itemId,S):await Ut.complete(e.value,k.itemId,S),o?.value?.loadDashboard&&await o.value.loadDashboard(),h.value++,l&&await l(!0)}catch(T){console.error("Failed to toggle area lead marshal task:",T)}finally{d.value=!1}}}}function PV({router:e,route:t,onAuthSuccess:o}){const a=A(!1),n=A(!1),i=A(null),l=A(null),u=A(null),d=A(null),h=V(()=>l.value?.name||null),f=V(()=>d.value?.eventRoles?d.value.eventRoles.filter(R=>R.role==="EventAreaLead").flatMap(R=>R.areaIds||[]):[]),m=V(()=>f.value.length>0),y=V(()=>d.value?.eventRoles?d.value.eventRoles.some(B=>B.role==="EventAdmin"):!1),k=V(()=>d.value?.authMethod==="SecureEmailLink"&&y.value),w=V(()=>d.value?.authMethod==="MarshalMagicCode"&&y.value);let S=null;const T=()=>{S||(S=setInterval(async()=>{if(d.value?.marshalId)try{await ms.getMe(t.params.eventId)}catch(B){console.debug("Heartbeat failed:",B)}},300*1e3))},x=()=>{S&&(clearInterval(S),S=null)},C=async(B,R,U=!1)=>{n.value=!0,i.value=null,console.log("Authenticating with magic code:",{eventId:B,code:R,isReauth:U}),lu();try{go("marshal",B);const F=await ms.marshalLogin(B,R);if(console.log("Auth response:",F.data),F.data.success){wf(B,{token:F.data.sessionToken,marshalId:F.data.marshalId,marshalName:F.data.person?.name||null}),z0(B,F.data.marshalId,R),l.value=F.data.person,u.value=F.data.marshalId,a.value=!0,console.log("Authenticated as marshal:",u.value,l.value?.name);try{const j=await ms.getMe(B);d.value=j.data,console.log("User claims:",d.value)}catch(j){console.warn("Failed to fetch claims:",j)}e.replace({path:t.path,query:{}}),T(),o&&await o()}else i.value=F.data.message||"Authentication failed"}catch(F){console.error("Authentication failed:",F),i.value=F.response?.data?.message||"Invalid or expired login link"}finally{n.value=!1}};return{isAuthenticated:a,authenticating:n,loginError:i,currentPerson:l,currentMarshalId:u,userClaims:d,currentMarshalName:h,areaLeadAreaIds:f,isAreaLead:m,isEventAdmin:y,canSwitchToAdmin:k,isAdminButNeedsReauth:w,authenticateWithMagicCode:C,checkExistingSession:async B=>{go("marshal",B);const R=tc(B),U=R?.marshalId,F=U?Lm(B,U):null;if(!R?.token)return F?(console.log("No session but have stored code, attempting re-authentication..."),lu(),await C(B,F,!0),a.value):!1;try{const j=await ms.getMe(B);if(j.data&&j.data.marshalId)return d.value=j.data,l.value={personId:j.data.personId,name:j.data.personName,email:j.data.personEmail},u.value=j.data.marshalId,a.value=!0,bm(B,j.data.marshalId),T(),!0}catch(j){if(console.log("Session validation failed, attempting re-authentication...",j),F)try{if(lu(),await C(B,F,!0),a.value)return console.log("Re-authentication successful"),!0}catch(Y){console.error("Re-authentication failed:",Y)}R?.sessionKey&&ed(R.sessionKey)}return!1},handleClose:B=>{x(),go(null),a.value=!1,l.value=null,u.value=null,d.value=null,B&&B(),e.push("/marshal")},handleRemoveSession:async B=>{const[R]=B.split(":");go("marshal",R);try{await ms.logout()}catch{}ed(B),go(null)},updateSessionEventInfo:(B,R,U)=>{const F=tc(B);F&&F.marshalId&&wf(B,{marshalId:F.marshalId,marshalName:F.marshalName,token:F.token,eventName:R,eventDate:U})},switchToAdminMode:()=>{e.push(`/admin/events/${t.params.eventId}`)},startHeartbeat:T,stopHeartbeat:x}}function DV({eventDate:e,latitude:t,longitude:o}){const a=A(null),n=A(!1),i=A(null),l=["US","LR","MM"],u=V(()=>{try{const C=(navigator.language||"en-GB").split("-")[1]?.toUpperCase();return l.includes(C)}catch{return!1}}),d=V(()=>u.value?"fahrenheit":"celsius"),h=V(()=>{if(!e.value)return null;const x=new Date,C=new Date(e.value);return x.setHours(0,0,0,0),C.setHours(0,0,0,0),Math.floor((C-x)/(1e3*60*60*24))}),f=V(()=>{const x=h.value;return x===null?!1:x>=-1&&x<=7}),m=x=>x>3?720*60*1e3:x>1?10800*1e3:3600*1e3,y=(x,C,_)=>`weather_${x.toFixed(2)}_${C.toFixed(2)}_${_}`,k=(x,C,_,$)=>{try{const M=y(x,C,_),H=localStorage.getItem(M);if(!H)return null;const{data:E,timestamp:B}=JSON.parse(H),R=m($);return Date.now()-B<R?E:(localStorage.removeItem(M),null)}catch{return null}},w=(x,C,_,$)=>{try{const M=y(x,C,_);localStorage.setItem(M,JSON.stringify({data:$,timestamp:Date.now()}))}catch{}},S={0:{icon:"sun",description:"Clear"},1:{icon:"sun",description:"Mainly clear"},2:{icon:"cloud-sun",description:"Partly cloudy"},3:{icon:"cloud",description:"Overcast"},45:{icon:"fog",description:"Fog"},48:{icon:"fog",description:"Icy fog"},51:{icon:"drizzle",description:"Light drizzle"},53:{icon:"drizzle",description:"Drizzle"},55:{icon:"drizzle",description:"Heavy drizzle"},56:{icon:"drizzle",description:"Freezing drizzle"},57:{icon:"drizzle",description:"Heavy freezing drizzle"},61:{icon:"rain",description:"Light rain"},63:{icon:"rain",description:"Rain"},65:{icon:"rain",description:"Heavy rain"},66:{icon:"rain",description:"Freezing rain"},67:{icon:"rain",description:"Heavy freezing rain"},71:{icon:"snow",description:"Light snow"},73:{icon:"snow",description:"Snow"},75:{icon:"snow",description:"Heavy snow"},77:{icon:"snow",description:"Snow grains"},80:{icon:"showers",description:"Light showers"},81:{icon:"showers",description:"Showers"},82:{icon:"showers",description:"Heavy showers"},85:{icon:"snow",description:"Light snow showers"},86:{icon:"snow",description:"Heavy snow showers"},95:{icon:"thunderstorm",description:"Thunderstorm"},96:{icon:"thunderstorm",description:"Thunderstorm with hail"},99:{icon:"thunderstorm",description:"Severe thunderstorm"}},T=async()=>{const x=t.value,C=o.value,_=e.value,$=h.value;if(!x||!C||!_||!f.value){a.value=null;return}const M=new Date(_).toISOString().split("T")[0],H=k(x,C,M,$);if(H){a.value=H;return}n.value=!0,i.value=null;try{const E=u.value?"fahrenheit":"celsius",B=`https://api.open-meteo.com/v1/forecast?latitude=${x}&longitude=${C}&daily=temperature_2m_max,temperature_2m_min,weathercode&temperature_unit=${E}&timezone=auto`,R=await fetch(B);if(!R.ok)throw new Error("Weather API request failed");const U=await R.json(),F=U.daily.time.indexOf(M);if(F===-1){a.value=null;return}const j=U.daily.weathercode[F],Y=Math.round(U.daily.temperature_2m_max[F]),oe=Math.round(U.daily.temperature_2m_min[F]),Oe=S[j]||{icon:"cloud",description:"Unknown"},ee={tempMax:Y,tempMin:oe,unit:u.value?"F":"C",icon:Oe.icon,description:Oe.description,weatherCode:j};w(x,C,M,ee),a.value=ee}catch(E){console.warn("Failed to fetch weather:",E),i.value=E.message,a.value=null}finally{n.value=!1}};return We([e,t,o,f],()=>{f.value&&t.value&&o.value?T():a.value=null},{immediate:!0}),{weather:a,loading:n,error:i,shouldShowWeather:f,daysUntilEvent:h,temperatureUnit:d,fetchWeather:T}}const RV=["aria-label"],OV={__name:"WeatherIcon",props:{icon:{type:String,required:!0},size:{type:[Number,String],default:20},alt:{type:String,default:"Weather"},color:{type:String,default:"currentColor"}},setup(e){const t=e,o={sun:"clear-day","cloud-sun":"partly-cloudy-day",cloud:"cloudy",fog:"fog",drizzle:"drizzle",rain:"rain",showers:"overcast-rain",snow:"snow",sleet:"sleet",thunderstorm:"thunderstorms-rain"},a=V(()=>`https://bmcdn.nl/assets/weather-icons/v3.0/fill/svg/${o[t.icon]||"cloudy"}.svg`),n=V(()=>{const l=t.size;return typeof l=="number"?`${l}px`:l}),i=V(()=>({width:n.value,height:n.value,backgroundColor:t.color,maskImage:`url(${a.value})`,WebkitMaskImage:`url(${a.value})`,maskSize:"contain",WebkitMaskSize:"contain",maskRepeat:"no-repeat",WebkitMaskRepeat:"no-repeat",maskPosition:"center",WebkitMaskPosition:"center"}));return(l,u)=>(v(),g("span",{class:"weather-icon",style:Qe(i.value),role:"img","aria-label":e.alt},null,12,RV))}},BV=He(OV,[["__scopeId","data-v-9861a237"]]),NV={key:0,class:"header-logo-cover"},FV=["src"],UV={key:2,class:"header-logo header-logo-left"},zV=["src"],HV={class:"header-center"},VV={key:0},GV={key:1,class:"header-event-date"},qV=["title"],jV={class:"weather-temp"},ZV={key:0,class:"header-actions"},WV={key:3,class:"header-logo header-logo-right"},KV=["src"],JV={class:"container"},YV={key:0,class:"selection-card"},XV={key:1,class:"selection-card"},QV={key:0,class:"loading"},eG={key:2,class:"selection-card error-card"},tG={class:"error"},nG={key:3,class:"dashboard"},oG={key:0,class:"welcome-bar"},sG={class:"welcome-info"},aG={key:0,class:"welcome-email"},iG={key:0,class:"mode-switch"},lG={key:1,class:"mode-switch"},rG={class:"accordion"},cG={class:"add-note-form"},uG={class:"modal-actions"},dG=["disabled"],hG=6e4,fG={__name:"MarshalView",setup(e){const{terms:t,termsLower:o}=ct(),{updatePendingCount:a}=Wd(),n=$c(),i=cl(),l=V(()=>n.params.eventId),u={onAuthSuccess:null},{isAuthenticated:d,authenticating:h,loginError:f,currentPerson:m,currentMarshalId:y,currentMarshalName:k,areaLeadAreaIds:w,isAreaLead:S,canSwitchToAdmin:T,isAdminButNeedsReauth:x,authenticateWithMagicCode:C,checkExistingSession:_,handleClose:$,updateSessionEventInfo:M,switchToAdminMode:H,stopHeartbeat:E}=PV({router:i,route:n,onAuthSuccess:()=>u.onAuthSuccess?.()}),B=A(new Set),R=V(()=>w.value.length?ee.value.filter($e=>w.value.includes($e.id)).map($e=>({areaId:$e.id,name:$e.name,color:$e.color})).sort(($e,Ie)=>($e.name||"").localeCompare(Ie.name||"",void 0,{numeric:!0,sensitivity:"base"})):[]);We(R,$e=>{$e.length>0&&B.value.size===0&&(B.value=new Set($e.map(Ie=>Ie.areaId)))},{immediate:!0});const U=V(()=>w.value.filter($e=>B.value.has($e))),F=$e=>{const Ie=new Set(B.value);Ie.has($e)?Ie.delete($e):Ie.add($e),B.value=Ie},j=V(()=>{const $e=mn.value.find(tt=>tt.isCheckedIn&&!eo(tt.checkInTime)&&tt.location);if($e?.location)return{id:$e.location.id,locationId:$e.location.id,name:$e.location.name,description:$e.location.description};if(Yt.value){const tt=mn.value.find(ft=>ft.id===Yt.value);if(tt?.location)return{id:tt.location.id,locationId:tt.location.id,name:tt.location.name,description:tt.location.description}}const Ie=mn.value[0];return Ie?.location?{id:Ie.location.id,locationId:Ie.location.id,name:Ie.location.name,description:Ie.location.description}:null}),Y=A(null),oe=A([]),Oe=A([]),ee=A([]),te=A(!0),{pageBackgroundStyle:O,headerStyle:Z,headerTextColor:ne,accentColor:pe,accentTextColor:we,accentButtonStyle:Ze,brandingLogoUrl:Ne,brandingLogoPosition:Ge}=CV(Y,n.params.eventId);Bl("marshalBranding",{headerStyle:Z,headerTextColor:ne,accentButtonStyle:Ze,accentColor:pe,accentTextColor:we});const Xe=V(()=>{if(!oe.value.length)return null;const $e=oe.value.filter(Ie=>Ie.latitude&&Ie.longitude);return $e.length?$e.reduce((Ie,tt)=>Ie+tt.latitude,0)/$e.length:null}),Q=V(()=>{if(!oe.value.length)return null;const $e=oe.value.filter(Ie=>Ie.latitude&&Ie.longitude);return $e.length?$e.reduce((Ie,tt)=>Ie+tt.longitude,0)/$e.length:null}),ye=V(()=>Y.value?.eventDate||null),{weather:Ce,shouldShowWeather:me}=DV({eventDate:ye,latitude:Xe,longitude:Q}),ie=A("assignments"),z=A({checklist:0,notes:0,incidents:0,eventContacts:0}),K=A([]),se=A([]),Ee=A(null),Be=V(()=>Ee.value?.areaLeadRef?.value),{checklistItems:Re,checklistLoading:Se,checklistError:X,savingChecklist:he,expandedChecklistGroup:Te,visibleChecklistItems:xe,completedChecklistCount:be,myChecklistItems:de,areaChecklistItems:fe,areaChecklistItemsWithLocalState:W,areaMarshalsForChecklist:J,effectiveChecklistGroupBy:re,groupedChecklistItems:je,loadChecklist:et,handleToggleChecklist:dt,toggleChecklistGroup:kt,getContextName:gt}=SV({eventId:l,currentMarshalId:y,currentPerson:m,assignments:Oe,areaLeadAreaIds:w,isAreaLead:S,allLocations:oe,areas:ee,terms:t,termsLower:o,areaLeadRef:Be,areaLeadCheckpoints:K,sectionLastLoadedAt:z,updateCachedField:Ur,updatePendingCount:a}),{userLocation:St,locationLastUpdated:Lt,startLocationTracking:Dt,stopLocationTracking:Vt}=LV(),{showLocationUpdateModal:ht,updatingLocationFor:Gt,locationUpdateError:pn,locationUpdateSuccess:Et,updatingLocation:_t,autoUpdateEnabled:Vn,selectingLocationOnMap:kn,openLocationUpdateModal:Qn,closeLocationUpdateModal:co,startMapLocationSelect:Wt,cancelMapLocationSelect:ns,updateDynamicCheckpointLocation:Sn,updateLocationWithGps:bo,updateLocationFromCheckpoint:ce,toggleAutoUpdate:ue,stopAutoUpdate:ke,startDynamicCheckpointPolling:st,stopDynamicCheckpointPolling:qe,startAllCheckpointsPolling:Tt,stopAllCheckpointsPolling:Kt}=IV({eventId:l,allLocations:oe,userLocation:St,locationLastUpdated:Lt});let en=null;const Eo=async()=>{Wt(),en=ie.value,ie.value="map",await cn(),jn.value?.openFullscreen?.()},Gn=()=>{en&&(ie.value=en,en=null)},ks=()=>{ns(),jn.value?.mapRef?.closeFullscreen?.(),Gn()},{expandedAreaLeadMarshal:_o,savingAreaLeadMarshalTask:Ba,areaLeadMarshalDataVersion:bs,allAreaLeadMarshals:Po,toggleAreaLeadMarshalExpansion:Ys,toggleAreaLeadMarshalTask:Na}=EV({eventId:l,currentMarshalId:y,areaLeadRef:Be,areaLeadCheckpoints:K,areaChecklistItems:fe,areaLeadAreaIds:w,loadChecklist:et}),{checkingIn:In,checkingInAssignment:Fa,checkInError:vn,showCheckInReminderModal:wo,checkInReminderCheckpoint:Do,dismissedCheckInReminders:Ua,showDistanceWarning:Ro,distanceWarningMessage:Xs,isCheckInStale:eo,handleCheckInToggle:Co,handleAreaLeadMarshalCheckIn:xn,dismissCheckInReminder:uo,dismissDistanceWarning:to}=xV({eventId:l,assignments:Oe,allLocations:oe,areaLeadRef:Be,areaLeadCheckpoints:K,areaLeadMarshalDataVersion:bs,updatePendingCount:a,updateCachedField:Ur}),mt=A(!1),It=A(!1),ho=A(""),fo=A(""),qn=A(null),_s=A(!1),pt=A(""),qt=A(""),Qs=($e,Ie)=>{pt.value=$e,qt.value=Ie,_s.value=!0},{myIncidents:ws,incidentsLoading:An,selectedIncident:pl,showIncidentDetail:Cs,showAddIncidentNoteModal:Oo,incidentNoteText:jt,submittingIncidentNote:Lo,showReportIncident:Bo,loadMyIncidents:os,handleReportIncident:za,openIncidentDetail:Ls,handleIncidentStatusChange:Ha,openAddIncidentNoteModal:Jt,closeAddIncidentNoteModal:No,submitIncidentNote:Ss}=$V({eventId:l,currentMarshalId:y,isAreaLead:S,areaLeadAreaIds:w,sectionLastLoadedAt:z,showMessage:Qs}),jn=A(null),ea=V(()=>jn.value),ta=A(null),En=$e=>!$e||$e.length===0?!1:$e.some(Ie=>w.value.includes(Ie)),na=$e=>{ta.value=ta.value===$e?null:$e},it=$e=>{const Ie=ie.value===$e;if(ie.value=Ie?null:$e,!Ie){const tt=Date.now(),ft=Bt=>tt-z.value[Bt]>hG;switch($e){case"checklist":ft("checklist")&&et();break;case"notes":ft("notes")&&ca();break;case"incidents":ft("incidents")&&os();break;case"eventContacts":ft("eventContacts")&&Wa();break}}},Yt=A(null),xt=$e=>{Yt.value=Yt.value===$e?null:$e};We(()=>Oe.value,$e=>{$e.length===1&&Yt.value===null&&(Yt.value=$e[0].id)},{immediate:!0});const ss=V(()=>ie.value==="map"||ie.value==="assignments"&&Yt.value!==null);We(ss,$e=>{$e?Tt():Kt()});const mn=V(()=>Oe.value.map($e=>{const Ie=oe.value.find(Pt=>Pt.id===$e.locationId),tt=Ie?.areaIds||Ie?.AreaIds||[];let ft=null;tt.length>0&&ee.value.length>0&&(ft=ee.value.find(on=>tt.includes(on.id))?.name);const $t=(Ie?.assignments||[]).map(Pt=>({...Pt,effectiveIsCheckedIn:Pt.isCheckedIn&&!eo(Pt.checkInTime)})).sort((Pt,on)=>(Pt.marshalName||"").localeCompare(on.marshalName||"",void 0,{sensitivity:"base"})),nn=Ti.value.filter(Pt=>tt.includes(Pt.areaId)&&(!Pt.marshalId||Pt.marshalId!==y.value)),Qt=new Set,Nt=nn.filter(Pt=>{const on=JSON.stringify({name:Pt.name||"",marshalId:Pt.marshalId||"",role:Pt.role||"",phone:Pt.phone||"",email:Pt.email||"",notes:Pt.notes||""});return Qt.has(on)?!1:(Qt.add(on),!0)}).sort((Pt,on)=>(Pt.marshalName||Pt.name||"").localeCompare(on.marshalName||on.name||"",void 0,{sensitivity:"base"})),bn=$e.isCheckedIn&&!eo($e.checkInTime);return{...$e,location:Ie,areaName:ft,areaIds:tt,allMarshals:$t,areaContacts:Nt,locationName:Ie?.name||"Unknown Location",effectiveIsCheckedIn:bn}})),{courseMapActions:oa,hideOtherCheckpoints:sa,handleCourseMapVisibilityChange:So,handleCourseMapAction:Va,getCheckpointMapActions:as,handleCheckpointMapVisibilityChange:tn,handleCheckpointMapAction:Fo}=AV({userLocation:St,assignmentsWithDetails:mn,courseMapRef:ea}),Ga=V(()=>Oe.value.length>0?Oe.value[0]:null),is=V(()=>Oe.value.map($e=>$e.locationId)),vl=V(()=>sa.value?oe.value.filter($e=>{const Ie=is.value.includes($e.id),tt=$e.isDynamic||$e.IsDynamic;return Ie||tt}):oe.value),Si=V(()=>mn.value.some($e=>$e.location?.isDynamic||$e.location?.IsDynamic)),Uo=V(()=>mn.value.find($e=>$e.location?.isDynamic||$e.location?.IsDynamic)),qa=V(()=>{const $e=Uo.value;if(!$e)return!1;const Ie=$e.location,tt=Ie?.locationUpdateScopeConfigurations||Ie?.LocationUpdateScopeConfigurations||[];return ig({scopeConfigurations:tt,marshalId:y.value,marshalAssignmentLocationIds:is.value,areaLeadAreaIds:w.value,locationId:$e.locationId,locationAreaIds:$e.areaIds||[]})}),Ii=V(()=>{if(!Y.value||!mn.value.length)return[];const $e=new Date,Ie=Y.value.eventDate?new Date(Y.value.eventDate):null;return mn.value.filter(tt=>{if(tt.effectiveIsCheckedIn||Ua.value.has(tt.id))return!1;const ft=tt.location;if(!ft)return!1;const Bt=ft.startTime?new Date(ft.startTime):Ie;if(!Bt)return!1;let $t;if(ft.endTime)$t=new Date(ft.endTime);else if(Ie)$t=new Date(Ie.getTime()+7200*1e3);else return!1;return $e>=Bt&&$e<$t})});We(Ii,$e=>{$e.length>0&&!wo.value&&(Do.value=$e[0],wo.value=!0)},{immediate:!0}),We(Ro,$e=>{$e&&(Qs("Distance notice",Xs.value),to())});const wt=()=>{const $e=Do.value;$e&&(uo($e.id),ie.value="assignments",Yt.value=$e.id)},Is=V(()=>Y.value?.route?(typeof Y.value.route=="string"?JSON.parse(Y.value.route):Y.value.route)||[]:[]),gn=V(()=>!Ga.value||!oe.value.length?null:oe.value.find($e=>$e.id===Ga.value.locationId)),no=A([]),aa=A(!1),xi=V(()=>{const $e=no.value.filter(ft=>!ft.marshalId||ft.marshalId!==y.value),Ie=new Set;return $e.filter(ft=>{const Bt=JSON.stringify({name:ft.name||"",marshalId:ft.marshalId||"",role:ft.role||"",phone:ft.phone||"",email:ft.email||"",notes:ft.notes||""});return Ie.has(Bt)?!1:(Ie.add(Bt),!0)}).sort((ft,Bt)=>{if(ft.isPinned!==Bt.isPinned)return ft.isPinned?-1:1;const $t=ft.displayOrder||0,nn=Bt.displayOrder||0;return $t!==nn?$t-nn:(ft.name||"").localeCompare(Bt.name||"",void 0,{sensitivity:"base"})})}),ia=V(()=>xi.value.filter($e=>$e.showInEmergencyInfo)),la=V(()=>se.value.filter($e=>$e.showInEmergencyInfo)),$i=V(()=>ia.value.length>0||la.value.length>0),ml=($e,Ie=[])=>{if(!se.value||se.value.length===0)return[];const tt=oe.value.find(Nt=>Nt.id===$e),ft=tt?.areaIds||tt?.AreaIds||[],Bt=Ie.length>0?Ie:ft,$t=[],nn=new Set;for(const Nt of se.value){const bn=Nt.noteId||Nt.NoteId||Nt.id;if(nn.has(bn))continue;const Pt=Nt.scopeConfigurations||Nt.ScopeConfigurations||[];let on=!1;if(Pt.length>0)for(const Pn of Pt){const ls=Pn.itemType||Pn.ItemType,po=Pn.ids||Pn.Ids||[];if(ls==="Checkpoint"&&(po.includes($e)||po.includes("ALL_CHECKPOINTS"))){on=!0;break}if(ls==="Area"&&(po.includes("ALL_AREAS")||Bt.length>0&&Bt.some(yl=>po.includes(yl)))){on=!0;break}}else{const Pn=Nt.matchedScope||Nt.MatchedScope||"";["EveryoneInAreas","EveryAreaLead","EveryoneAtCheckpoints","Area","Checkpoint"].some(po=>Pn.includes(po)||Pn===po)&&(on=!0)}on&&(nn.add(bn),$t.push(Nt))}const Qt={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return $t.sort((Nt,bn)=>{const Pt=Nt.isPinned||Nt.IsPinned,on=bn.isPinned||bn.IsPinned;if(Pt&&!on)return-1;if(!Pt&&on)return 1;const Pn=Qt[Nt.priority||Nt.Priority||"Normal"]??3,ls=Qt[bn.priority||bn.Priority||"Normal"]??3;if(Pn!==ls)return Pn-ls;const po=Nt.createdAt||Nt.CreatedAt,Ya=bn.createdAt||bn.CreatedAt;return new Date(Ya)-new Date(po)})},Ti=A([]),ja=($e,Ie)=>$e.localeCompare(Ie,void 0,{numeric:!0,sensitivity:"base"}),gl=V(()=>{if(!Gt.value)return[];const $e=Gt.value.locationId;return oe.value.filter(Ie=>Ie.id!==$e&&Ie.latitude!==0&&Ie.longitude!==0).sort((Ie,tt)=>ja(Ie.name,tt.name))}),oo=V(()=>gn.value?{lat:gn.value.latitude,lng:gn.value.longitude}:St.value?St.value:oe.value.length>0?{lat:oe.value[0].latitude,lng:oe.value[0].longitude}:{lat:51.505,lng:-.09}),ra=async()=>{const $e=n.params.eventId;if(console.log("Loading event data for:",{eventId:$e,marshalId:y.value}),On()){console.log("Offline mode detected, attempting to load from cache...");const $t=await Ma($e);if($t){if(console.log("Loaded cached data from:",$t.cachedAt),Y.value=$t.event,ee.value=$t.areas||[],oe.value=$t.locations||[],Re.value=$t.checklist||[],no.value=$t.contacts||[],se.value=$t.notes||[],$t.areaLeadDashboard?.checkpoints&&(K.value=$t.areaLeadDashboard.checkpoints),Y.value&&rd(Y.value),y.value){const nn=[];for(const Qt of oe.value){const Nt=Qt.assignments?.find(bn=>bn.marshalId===y.value);Nt&&nn.push(Nt)}Oe.value=nn}return}else console.warn("No cached data available while offline")}console.log("Fetching event data in parallel...");const[Ie,tt,ft]=await Promise.allSettled([xa.getById($e),Fs.getByEvent($e),Al.getEventStatus($e)]);if(Ie.status==="fulfilled"?(Y.value=Ie.value.data,console.log("Event loaded:",Y.value?.name),Y.value&&(rd(Y.value),M($e,Y.value.name,Y.value.eventDate))):console.error("Failed to load event:",Ie.reason),tt.status==="fulfilled"?(ee.value=tt.value.data||[],console.log("Areas loaded:",ee.value.length)):console.error("Failed to load areas:",tt.reason),ft.status==="fulfilled"){if(oe.value=ft.value.data?.locations||[],console.log("Locations loaded:",oe.value.length),y.value){const $t=[];for(const nn of oe.value){const Qt=nn.assignments?.find(Nt=>Nt.marshalId===y.value);Qt&&$t.push(Qt)}Oe.value=$t,console.log("Total assignments found:",Oe.value.length)}}else console.error("Failed to load event status:",ft.reason);const Bt=[et(),Wa(),ca(),os()];S.value&&Bt.push(Io()),await Promise.allSettled(Bt);try{const $t={event:Y.value,areas:ee.value,locations:oe.value,checklist:Re.value,contacts:no.value,notes:se.value,marshalId:y.value};K.value.length>0&&($t.areaLeadDashboard={checkpoints:K.value});const nn=JSON.parse(JSON.stringify($t));await or($e,nn),console.log("Event data cached for offline access")}catch($t){console.warn("Failed to cache event data:",$t)}st()};u.onAuthSuccess=ra;const Za=async()=>{const $e=n.params.eventId;if(On()){console.log("Skipping background preload: offline");return}console.log("Starting background preload for offline data...");try{const Ie=await Fs.getAreaLeadDashboard($e);if(Ie.data){K.value=Ie.data.checkpoints||[];const tt=JSON.parse(JSON.stringify({areas:Ie.data.areas||[],checkpoints:Ie.data.checkpoints||[]}));await Ma($e)?await Ur($e,"areaLeadDashboard",tt):await or($e,{areaLeadDashboard:tt}),console.log("Area lead dashboard cached for offline access")}}catch(Ie){Ie.response?.status!==403&&console.warn("Failed to preload area lead dashboard:",Ie)}console.log("Background preload complete")},Io=async()=>{const $e=n.params.eventId;try{const Ie=await Fs.getAreaLeadDashboard($e);Ie.data?.checkpoints&&(K.value=Ie.data.checkpoints,console.log("Area lead dashboard loaded:",K.value.length,"checkpoints"))}catch(Ie){Ie.response?.status!==403&&console.warn("Failed to load area lead dashboard:",Ie)}},ca=async()=>{const $e=n.params.eventId;try{const Ie=await fs.getMyNotes($e);se.value=Ie.data||[],z.value.notes=Date.now(),console.log("Notes loaded:",se.value.length)}catch(Ie){console.error("Failed to load notes:",Ie)}},Wa=async()=>{const $e=n.params.eventId;aa.value=!0;try{const Ie=await _a.getMyContacts($e);no.value=Ie.data||[],z.value.eventContacts=Date.now(),console.log("Contacts loaded:",no.value.length)}catch(Ie){console.warn("Failed to load contacts:",Ie),no.value=[]}finally{aa.value=!1}},Ka=()=>{It.value=!1,qn.value&&(qn.value(),qn.value=null)},Ja=()=>{It.value=!1,qn.value=null},Mi=()=>{_s.value=!1},ua=async $e=>{if(kn.value&&Gt.value){await Sn(Gt.value.locationId,$e.lat,$e.lng,"manual"),kn.value=!1,Gt.value=null,jn.value?.mapRef?.closeFullscreen?.(),Gn();return}if(qa.value&&Uo.value){const Ie=Uo.value;ho.value="Update location",fo.value=`Update ${Ie.location?.name||"dynamic checkpoint"} to this location?`,qn.value=async()=>{await Sn(Ie.locationId,$e.lat,$e.lng,"manual"),jn.value?.mapRef?.closeFullscreen?.()},It.value=!0}},Ai=async $e=>{if(kn.value&&Gt.value){if($e.id===Gt.value.locationId)return;await Sn(Gt.value.locationId,$e.latitude,$e.longitude,"checkpoint",$e.id),kn.value=!1,jn.value?.mapRef?.closeFullscreen?.(),Gn();return}if(qa.value&&Uo.value){const Ie=Uo.value;if($e.id===Ie.locationId)return;ho.value="Copy location",fo.value=`Copy location from "${$e.name}" to ${Ie.location?.name||"your dynamic checkpoint"}?`,qn.value=async()=>{await Sn(Ie.locationId,$e.latitude,$e.longitude,"checkpoint",$e.id),jn.value?.mapRef?.closeFullscreen?.()},It.value=!0}},Ei=()=>{$(()=>{Oe.value=[],Re.value=[],Ti.value=[]})},xs=$e=>$e?new Date($e).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return ln(async()=>{const $e=n.params.eventId,Ie=n.query.code;te.value=!0;try{Ie?await C($e,Ie):await _($e)&&await ra()}finally{te.value=!1}d.value&&(Dt(),"requestIdleCallback"in window?requestIdleCallback(()=>{Za()},{timeout:5e3}):setTimeout(()=>{Za()},2e3))}),We(d,$e=>{$e?Dt():Vt()}),We(()=>n.query.code,async $e=>{if($e&&d.value){te.value=!0;try{await C(n.params.eventId,$e)}finally{te.value=!1}}}),We(Y,$e=>{$e&&(document.title=`OnTheDay App - ${t.value.person}`)},{immediate:!0}),Ln(()=>{E(),ke(),qe(),Kt()}),($e,Ie)=>(v(),g("div",{class:"marshal-view",style:Qe(N(O))},[Me(F9),r("header",{class:ve(["header",`logo-${N(Ge)}`]),style:Qe(N(Z))},[N(Ne)&&N(Ge)==="cover"?(v(),g("div",NV,[r("img",{src:N(Ne),alt:"Event logo",class:"header-logo-cover-img"},null,8,FV)])):D("",!0),N(d)&&N(Ge)==="right"?(v(),g("button",{key:1,onClick:Ei,class:"btn-close-session btn-close-left",style:Qe({color:N(ne)}),title:"Close session"},"  ",4)):D("",!0),N(Ne)&&N(Ge)==="left"?(v(),g("div",UV,[r("img",{src:N(Ne),alt:"Event logo",class:"header-logo-img"},null,8,zV)])):D("",!0),r("div",HV,[r("div",{class:"header-title",style:Qe({color:N(ne)})},[Y.value?(v(),g("h1",VV,I(Y.value.name),1)):D("",!0),Y.value?.eventDate?(v(),g("div",GV,[Ye(I(xs(Y.value.eventDate))+" ",1),N(me)&&N(Ce)?(v(),g("span",{key:0,class:"header-weather",title:N(Ce).description},[Me(BV,{icon:N(Ce).icon,size:18,alt:N(Ce).description,color:N(ne)},null,8,["icon","alt","color"]),r("span",jV,I(N(Ce).tempMax)+""+I(N(Ce).unit),1)],8,qV)):D("",!0)])):D("",!0)],4),N(d)?(v(),g("div",ZV,[r("button",{onClick:Ie[0]||(Ie[0]=tt=>Bo.value=!0),class:"btn-header-action btn-report-incident"}," Report Incident "),$i.value?(v(),g("button",{key:0,onClick:Ie[1]||(Ie[1]=tt=>mt.value=!0),class:"btn-header-action btn-emergency"}," Emergency Info ")):D("",!0)])):D("",!0)]),N(Ne)&&N(Ge)==="right"?(v(),g("div",WV,[r("img",{src:N(Ne),alt:"Event logo",class:"header-logo-img"},null,8,KV)])):D("",!0),N(d)&&N(Ge)!=="right"?(v(),g("button",{key:4,onClick:Ei,class:"btn-close-session btn-close-right",style:Qe({color:N(ne)}),title:"Close session"},"  ",4)):D("",!0)],6),r("div",JV,[te.value?(v(),g("div",YV,[...Ie[22]||(Ie[22]=[r("div",{class:"loading"},"Loading...",-1)])])):!N(d)&&!N(f)?(v(),g("div",XV,[Ie[23]||(Ie[23]=r("h2",null,"Welcome",-1)),Ie[24]||(Ie[24]=r("p",{class:"instruction"},"Please use the login link sent to you to access your marshal dashboard.",-1)),N(h)?(v(),g("p",QV,"Authenticating...")):D("",!0)])):N(f)?(v(),g("div",eG,[Ie[25]||(Ie[25]=r("h2",null,"Login failed",-1)),r("p",tG,I(N(f)),1),Ie[26]||(Ie[26]=r("p",{class:"instruction"},"Please contact the event organiser for a new login link.",-1))])):(v(),g("div",nG,[N(T)||N(x)?(v(),g("div",oG,[r("div",sG,[N(m)?.email?(v(),g("span",aG,I(N(m).email),1)):D("",!0)]),N(T)?(v(),g("div",iG,[r("button",{onClick:Ie[2]||(Ie[2]=(...tt)=>N(H)&&N(H)(...tt)),class:"btn-mode-switch"}," Switch to Admin ")])):N(x)?(v(),g("div",lG,[...Ie[27]||(Ie[27]=[r("span",{class:"reauth-hint",title:"Login via admin flow to access admin features"}," Admin access requires re-login ",-1)])])):D("",!0)])):D("",!0),r("div",rG,[Me(bV,{ref:"assignmentsSectionRef","is-expanded":ie.value==="assignments",assignments:mn.value,"expanded-checkpoint-id":Yt.value,"all-locations":oe.value,route:Is.value,"user-location":N(St),"has-dynamic-assignment":Si.value,"current-marshal-id":N(y),"current-marshal-name":N(k),"checking-in-id":N(In),"checking-in-assignment-id":N(Fa),"check-in-error":N(vn),"checking-in-marshal-id":N(In),"expanded-marshal-id":ta.value,"updating-location":N(_t),"auto-update-enabled":N(Vn),"get-toolbar-actions":N(as),"is-area-lead-for-areas":En,"get-notes-for-checkpoint":ml,"area-lead-area-ids":N(w),onToggle:Ie[3]||(Ie[3]=tt=>it("assignments")),onToggleCheckpoint:xt,onMapClick:ua,onLocationClick:Ai,onActionClick:N(Fo),onVisibilityChange:N(tn),onUpdateLocation:N(Qn),onCheckIn:Ie[4]||(Ie[4]=tt=>N(Co)(tt,!0)),onToggleMarshal:na,onMarshalCheckIn:Ie[5]||(Ie[5]=(tt,ft)=>N(Co)(tt,!1,ft)),onToggleAutoUpdate:N(ue)},null,8,["is-expanded","assignments","expanded-checkpoint-id","all-locations","route","user-location","has-dynamic-assignment","current-marshal-id","current-marshal-name","checking-in-id","checking-in-assignment-id","check-in-error","checking-in-marshal-id","expanded-marshal-id","updating-location","auto-update-enabled","get-toolbar-actions","area-lead-area-ids","onActionClick","onVisibilityChange","onUpdateLocation","onToggleAutoUpdate"]),Me(Z7,{loading:N(Se),error:N(X),"is-expanded":ie.value==="checklist","is-area-lead":N(S),"my-items":N(de),"area-items":N(fe),"area-items-with-local-state":N(W),"visible-items":N(xe),"grouped-items":N(je),"completed-count":N(be),saving:N(he),"effective-group-by":N(re),"expanded-group":N(Te),locations:oe.value,areas:ee.value,marshals:N(J),"get-context-name":N(gt),onToggle:Ie[6]||(Ie[6]=tt=>it("checklist")),onToggleItem:N(dt),onToggleGroup:N(kt)},null,8,["loading","error","is-expanded","is-area-lead","my-items","area-items","area-items-with-local-state","visible-items","grouped-items","completed-count","saving","effective-group-by","expanded-group","locations","areas","marshals","get-context-name","onToggleItem","onToggleGroup"]),Me(eU,{"event-id":N(n).params.eventId,notes:se.value,locations:oe.value,areas:ee.value,assignments:Oe.value,"is-expanded":ie.value==="notes",onToggle:Ie[7]||(Ie[7]=tt=>it("notes")),onNotesChanged:ca},null,8,["event-id","notes","locations","areas","assignments","is-expanded"]),Me(HF,{contacts:xi.value,loading:aa.value,"is-expanded":ie.value==="eventContacts",onToggle:Ie[8]||(Ie[8]=tt=>it("eventContacts"))},null,8,["contacts","loading","is-expanded"]),Me(XF,{incidents:N(ws),loading:N(An),"is-expanded":ie.value==="incidents",onToggle:Ie[9]||(Ie[9]=tt=>it("incidents")),onSelectIncident:N(Ls)},null,8,["incidents","loading","is-expanded","onSelectIncident"]),Me(Pz,{ref_key:"areaLeadSectionRef",ref:Ee,"is-area-lead":N(S),"is-expanded":ie.value==="areaLead",areas:R.value,"selected-filters":B.value,"filtered-area-ids":U.value,"event-id":N(n).params.eventId,"marshal-id":N(y),route:Is.value,onToggle:Ie[10]||(Ie[10]=tt=>it("areaLead")),onToggleFilter:F,onChecklistUpdated:N(et)},null,8,["is-area-lead","is-expanded","areas","selected-filters","filtered-area-ids","event-id","marshal-id","route","onChecklistUpdated"]),Me(iH,{"is-area-lead":N(S),"is-expanded":ie.value==="areaLeadMarshals",marshals:N(Po),"expanded-marshal-id":N(_o),"checking-in-marshal-id":N(In),"saving-task":N(Ba),onToggle:Ie[11]||(Ie[11]=tt=>it("areaLeadMarshals")),onToggleMarshal:N(Ys),onCheckIn:N(xn),onToggleTask:N(Na)},null,8,["is-area-lead","is-expanded","marshals","expanded-marshal-id","checking-in-marshal-id","saving-task","onToggleMarshal","onCheckIn","onToggleTask"]),Me(dU,{ref_key:"routeSectionRef",ref:jn,"is-expanded":ie.value==="map","user-location":N(St),"selecting-location":N(kn),"selecting-location-name":N(Gt)?.location?.name||"",locations:vl.value,route:Is.value,center:oo.value,"highlight-location-ids":is.value,clickable:N(kn)||qa.value,"toolbar-actions":N(oa),onToggle:Ie[12]||(Ie[12]=tt=>it("map")),onCancelSelect:ks,onMapClick:ua,onLocationClick:Ai,onActionClick:N(Va),onVisibilityChange:N(So)},null,8,["is-expanded","user-location","selecting-location","selecting-location-name","locations","route","center","highlight-location-ids","clickable","toolbar-actions","onActionClick","onVisibilityChange"]),Me(u7,{"event-date":Y.value?.eventDate,description:Y.value?.description,"is-expanded":ie.value==="eventDetails",onToggle:Ie[13]||(Ie[13]=tt=>it("eventDetails"))},null,8,["event-date","description","is-expanded"])])]))]),Me(S9,{show:mt.value,contacts:ia.value,notes:la.value,onClose:Ie[14]||(Ie[14]=tt=>mt.value=!1)},null,8,["show","contacts","notes"]),Me(Cg,{show:N(Bo),"event-id":l.value||"",checkpoint:j.value,"initial-location":N(St),checkpoints:oe.value,route:Is.value,onClose:Ie[15]||(Ie[15]=tt=>Bo.value=!1),onSubmit:N(za)},null,8,["show","event-id","checkpoint","initial-location","checkpoints","route","onSubmit"]),Me(wg,{show:N(Cs),incident:N(pl),route:Is.value,checkpoints:oe.value,"can-manage":N(S),onClose:Ie[16]||(Ie[16]=tt=>Cs.value=!1),onStatusChange:N(Ha),onOpenAddNote:N(Jt)},null,8,["show","incident","route","checkpoints","can-manage","onStatusChange","onOpenAddNote"]),Me(Ht,{show:N(Oo),title:"Add update",size:"small",onClose:N(No)},{footer:Fe(()=>[r("div",uG,[r("button",{type:"button",class:"btn btn-secondary",onClick:Ie[18]||(Ie[18]=(...tt)=>N(No)&&N(No)(...tt))}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:Ie[19]||(Ie[19]=(...tt)=>N(Ss)&&N(Ss)(...tt)),disabled:!N(jt).trim()||N(Lo)},I(N(Lo)?"Adding...":"Add update"),9,dG)])]),default:Fe(()=>[r("div",cG,[ze(r("textarea",{"onUpdate:modelValue":Ie[17]||(Ie[17]=tt=>sn(jt)?jt.value=tt:null),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[nt,N(jt)]])])]),_:1},8,["show","onClose"]),Me(Da,{show:It.value,title:ho.value,message:fo.value,onConfirm:Ka,onCancel:Ja},null,8,["show","title","message"]),Me(Da,{show:_s.value,title:pt.value,message:qt.value,"show-cancel":!1,onConfirm:Mi},null,8,["show","title","message"]),Me(W9,{show:N(wo),checkpoint:N(Do),"accent-button-style":N(Ze),onDismiss:Ie[20]||(Ie[20]=tt=>N(uo)(N(Do)?.id)),onGoToCheckpoint:wt},null,8,["show","checkpoint","accent-button-style"]),Me(_F,{show:N(ht),assignment:N(Gt),"user-location":N(St),"auto-update-enabled":N(Vn),updating:N(_t),error:N(pn),success:N(Et),"available-checkpoints":gl.value,"accent-button-style":N(Ze),onClose:N(co),onUpdateGps:N(bo),onToggleAutoUpdate:Ie[21]||(Ie[21]=tt=>N(ue)(N(Gt))),onSelectOnMap:Eo,onCopyFromCheckpoint:N(ce)},null,8,["show","assignment","user-location","auto-update-enabled","updating","error","success","available-checkpoints","accent-button-style","onClose","onUpdateGps","onCopyFromCheckpoint"])],4))}},pG=He(fG,[["__scopeId","data-v-efffcb88"]]),vG={class:"form-group"},mG={class:"form-group"},gG={class:"form-group"},yG={class:"actions-left"},kG={__name:"EditProfileModal",props:{show:{type:Boolean,default:!1},profile:{type:Object,default:null},isDirty:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3},showLogout:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty","logout"],setup(e,{emit:t}){const o=e,a=t,n=A({name:"",email:"",phone:""});We(()=>o.profile,h=>{h&&(n.value={name:h.name||"",email:h.email||"",phone:h.phone||""})},{immediate:!0,deep:!0}),We(()=>o.show,h=>{h&&o.profile&&(n.value={name:o.profile.name||"",email:o.profile.email||"",phone:o.profile.phone||""})});const i=()=>{a("update:isDirty",!0)},l=()=>{if(!n.value.name.trim()){alert("Name is required");return}if(!n.value.email.trim()){alert("Email is required");return}a("submit",{name:n.value.name.trim(),email:n.value.email.trim(),phone:n.value.phone?.trim()||""})},u=()=>{a("close")},d=()=>{a("logout")};return(h,f)=>(v(),Ke(Ht,{show:e.show,title:"Edit profile",size:"medium","z-index":e.zIndex,"confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:Fe(()=>[r("div",yG,[e.showLogout?(v(),g("button",{key:0,type:"button",onClick:d,class:"btn btn-danger"}," Log out ")):D("",!0)]),r("button",{type:"button",onClick:l,class:"btn btn-success"}," Save ")]),default:Fe(()=>[r("form",{onSubmit:lt(l,["prevent"])},[r("div",vG,[f[3]||(f[3]=r("label",null,"Name *",-1)),ze(r("input",{"onUpdate:modelValue":f[0]||(f[0]=m=>n.value.name=m),type:"text",required:"",class:"form-input",placeholder:"Your name",onInput:i},null,544),[[nt,n.value.name]])]),r("div",mG,[f[4]||(f[4]=r("label",null,"Email *",-1)),ze(r("input",{"onUpdate:modelValue":f[1]||(f[1]=m=>n.value.email=m),type:"email",required:"",class:"form-input",placeholder:"Your email address",onInput:i},null,544),[[nt,n.value.email]])]),r("div",gG,[f[5]||(f[5]=r("label",null,"Phone",-1)),ze(r("input",{"onUpdate:modelValue":f[2]||(f[2]=m=>n.value.phone=m),type:"tel",class:"form-input",placeholder:"Your phone number",onInput:i},null,544),[[nt,n.value.phone]])])],32)]),_:1},8,["show","z-index","is-dirty"]))}},bG=He(kG,[["__scopeId","data-v-178e5f48"]]),_G={class:"tabs"},wG={class:"tab-content"},CG={class:"form-group"},LG={class:"form-group"},SG={class:"form-group"},IG={class:"form-group"},xG=["value"],$G={class:"tab-content"},TG={class:"emergency-contacts-section"},MG={key:0,class:"empty-state"},AG={class:"card-header"},EG=["onClick"],PG={class:"form-group"},DG=["onUpdate:modelValue"],RG={class:"form-group"},OG=["onUpdate:modelValue"],BG={class:"form-group"},NG=["onUpdate:modelValue"],FG={__name:"EventFormModal",props:{show:{type:Boolean,default:!1},eventData:{type:Object,default:()=>({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]})},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const o=e,a=t,{activeTab:n,switchTab:i,resetTab:l}=tg("basic",["basic","emergency"]),u=A({...o.eventData});We(()=>o.eventData,y=>{u.value={...y},u.value.emergencyContacts||(u.value.emergencyContacts=[])},{deep:!0}),We(()=>o.show,y=>{y&&l()});const d=()=>{u.value.emergencyContacts.push({name:"",phone:"",details:""})},h=y=>{u.value.emergencyContacts.splice(y,1)},f=()=>{a("submit",{...u.value})},m=()=>{a("close")};return(y,k)=>(v(),Ke(Ht,{show:e.show,title:e.isEditing?"Edit event":"Create new event",size:"large",onClose:m},{"tab-header":Fe(()=>[r("div",_G,[r("button",{type:"button",onClick:k[0]||(k[0]=w=>N(i)("basic")),class:ve(["tab-button",{active:N(n)==="basic"}])}," Basic details ",2),r("button",{type:"button",onClick:k[1]||(k[1]=w=>N(i)("emergency")),class:ve(["tab-button",{active:N(n)==="emergency"}])}," Emergency contacts ",2)])]),actions:Fe(()=>[r("button",{type:"button",onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-success"}," Save ")]),default:Fe(()=>[r("form",{onSubmit:lt(f,["prevent"])},[ze(r("div",wG,[r("div",CG,[k[6]||(k[6]=r("label",null,"Event name *",-1)),ze(r("input",{"onUpdate:modelValue":k[2]||(k[2]=w=>u.value.name=w),type:"text",required:"",class:"form-input"},null,512),[[nt,u.value.name]])]),r("div",LG,[k[7]||(k[7]=r("label",null,"Description",-1)),ze(r("textarea",{"onUpdate:modelValue":k[3]||(k[3]=w=>u.value.description=w),rows:"3",class:"form-input"},null,512),[[nt,u.value.description]])]),r("div",SG,[k[8]||(k[8]=r("label",null,"Event date *",-1)),ze(r("input",{"onUpdate:modelValue":k[4]||(k[4]=w=>u.value.eventDate=w),type:"datetime-local",required:"",class:"form-input"},null,512),[[nt,u.value.eventDate]])]),r("div",IG,[k[9]||(k[9]=r("label",null,"Time zone *",-1)),ze(r("select",{"onUpdate:modelValue":k[5]||(k[5]=w=>u.value.timeZoneId=w),required:"",class:"form-input"},[(v(!0),g(Ae,null,Ue(N(dg),w=>(v(),g("option",{key:w.value,value:w.value},I(w.label),9,xG))),128))],512),[[zn,u.value.timeZoneId]])])],512),[[ys,N(n)==="basic"]]),ze(r("div",$G,[r("div",TG,[r("div",{class:"section-header-small"},[k[10]||(k[10]=r("h3",null,"Emergency contacts",-1)),r("button",{type:"button",onClick:d,class:"btn btn-small btn-primary"}," Add contact ")]),u.value.emergencyContacts.length===0?(v(),g("div",MG,[...k[11]||(k[11]=[r("p",null,'No emergency contacts added yet. Click "Add contact" to add one.',-1)])])):D("",!0),(v(!0),g(Ae,null,Ue(u.value.emergencyContacts,(w,S)=>(v(),g("div",{key:S,class:"emergency-contact-card"},[r("div",AG,[r("h4",null,"Contact "+I(S+1),1),r("button",{type:"button",onClick:T=>h(S),class:"btn-remove"},"  ",8,EG)]),r("div",PG,[k[12]||(k[12]=r("label",null,"Name *",-1)),ze(r("input",{"onUpdate:modelValue":T=>w.name=T,type:"text",required:"",class:"form-input",placeholder:"Contact person name"},null,8,DG),[[nt,w.name]])]),r("div",RG,[k[13]||(k[13]=r("label",null,"Phone *",-1)),ze(r("input",{"onUpdate:modelValue":T=>w.phone=T,type:"tel",required:"",class:"form-input",placeholder:"+1 (555) 123-4567"},null,8,OG),[[nt,w.phone]])]),r("div",BG,[k[14]||(k[14]=r("label",null,"Additional details",-1)),ze(r("textarea",{"onUpdate:modelValue":T=>w.details=T,rows:"2",class:"form-input",placeholder:"Role, availability, or other important information..."},null,8,NG),[[nt,w.details]])])]))),128))])],512),[[ys,N(n)==="emergency"]])],32)]),_:1},8,["show","title"]))}},UG=He(FG,[["__scopeId","data-v-d820eb4f"]]),zG=Dd("profile",()=>{const e=A(null),t=A(!1),o=A(null);return{profile:e,loading:t,error:o,fetchProfile:async()=>{t.value=!0,o.value=null;try{const d=await Tr.getProfile();return e.value=d.data,d.data}catch(d){throw o.value=d.response?.data?.message||"Failed to load profile",d}finally{t.value=!1}},updateProfile:async d=>{t.value=!0,o.value=null;try{const h=await Tr.updateProfile(d);return e.value=h.data,h.data}catch(h){throw o.value=h.response?.data?.message||"Failed to update profile",h}finally{t.value=!1}},fetchPerson:async(d,h)=>{t.value=!0,o.value=null;try{return(await Tr.getPerson(d,h)).data}catch(f){throw o.value=f.response?.data?.message||"Failed to load person",f}finally{t.value=!1}},updatePerson:async(d,h,f)=>{t.value=!0,o.value=null;try{return(await Tr.updatePerson(d,h,f)).data}catch(m){throw o.value=m.response?.data?.message||"Failed to update person",m}finally{t.value=!1}},clearProfile:()=>{e.value=null,o.value=null}}}),HG={class:"sessions-view"},VG={class:"sessions-container"},GG={key:0,class:"loading-state"},qG={key:1,class:"empty-state"},jG={key:2,class:"sessions-list"},ZG={class:"section-header"},WG={class:"section-actions"},KG=["onClick"],JG={class:"session-info"},YG={class:"event-name"},XG={key:0,class:"event-date"},QG={key:1,class:"sign-in-section"},eq={key:2,class:"section-header"},tq=["onClick"],nq={class:"session-info"},oq={class:"event-name"},sq={class:"role-name"},aq={key:0,class:"event-date"},iq=["onClick"],lq={class:"modal-card"},rq={class:"modal-actions"},cq={class:"modal-card"},uq={class:"modal-actions"},dq={__name:"SessionsView",setup(e){const t=cl(),o=hr(),a=eg(),n=zG(),i=A([]),l=A([]),u=A(!0),d=A(!1),h=A(!1),f=A(!1),m=A(!1),y=A(null),k=A(!1),w=A({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}),S=V(()=>localStorage.getItem("adminEmail")),T=V(()=>!!S.value),x=()=>{i.value=U0()},C=te=>{bm(te.eventId,te.marshalId),t.push(`/event/${te.eventId}`)},_=te=>{y.value=te,f.value=!0},$=async()=>{if(!y.value)return;const{sessionKey:te,eventId:O}=y.value;try{go("marshal",O),await authApi.logout()}catch{}ed(te),go(null),x(),f.value=!1,y.value=null},M=()=>{m.value=!0},H=async()=>{await o.logout(),l.value=[],m.value=!1},E=async()=>{if(h.value=!0,!n.profile)try{await n.fetchProfile()}catch(te){console.error("Failed to load profile:",te)}},B=async te=>{try{await n.updateProfile(te),h.value=!1}catch(O){console.error("Failed to save profile:",O),alert("Failed to save profile. Please try again.")}},R=async()=>{await o.logout(),l.value=[],h.value=!1},U=te=>te?new Date(te).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric"}):"",F=async()=>{if(T.value)try{go("admin");const te=await xa.getAll();l.value=te.data||[]}catch(te){console.error("Failed to load admin events:",te),l.value=[]}},j=te=>{t.push(`/admin/event/${te}`)},Y=()=>{t.push("/")},oe=()=>{},Oe=()=>{k.value=!1,w.value={name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}},ee=async te=>{try{const O={...te,adminEmail:o.adminEmail};await a.createEvent(O),Oe(),await F()}catch(O){console.error("Failed to create event:",O),alert("Failed to create event. Please try again.")}};return ln(async()=>{document.title="OnTheDay App - Sessions",wm(),_m(),x(),await F(),u.value=!1}),(te,O)=>(v(),g("div",HG,[r("div",VG,[Me(Xm,{title:"Your sessions"}),u.value?(v(),g("div",GG,[...O[9]||(O[9]=[r("p",null,"Loading sessions...",-1)])])):i.value.length===0&&l.value.length===0?(v(),g("div",qG,[O[10]||(O[10]=r("p",null,"No active sessions.",-1)),O[11]||(O[11]=r("p",{class:"hint"},"Sign in to access your events, or use a login link from your event organiser.",-1)),r("button",{class:"btn btn-primary",onClick:O[0]||(O[0]=Z=>d.value=!0)}," Sign in ")])):(v(),g("div",jG,[T.value?(v(),g(Ae,{key:0},[r("div",ZG,[O[12]||(O[12]=r("span",{class:"section-label"},"Admin events",-1)),r("div",WG,[r("button",{class:"btn btn-small btn-primary",onClick:E}," Profile "),r("button",{class:"btn btn-small btn-primary",onClick:O[1]||(O[1]=Z=>k.value=!0)}," Create event ")])]),(v(!0),g(Ae,null,Ue(l.value,Z=>(v(),g("div",{key:"admin-"+Z.id,class:"session-card admin-card",onClick:ne=>j(Z.id)},[O[14]||(O[14]=r("div",{class:"card-icon admin-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"})])],-1)),r("div",JG,[r("div",YG,I(Z.name),1),O[13]||(O[13]=r("div",{class:"role-name"},"Admin",-1)),Z.eventDate?(v(),g("div",XG,I(U(Z.eventDate)),1)):D("",!0)]),r("button",{class:"btn-logout",onClick:lt(M,["stop"]),title:"Log out as admin"},"  ")],8,KG))),128))],64)):(v(),g("div",QG,[r("button",{class:"btn btn-primary",onClick:O[2]||(O[2]=Z=>d.value=!0)}," Sign in ")])),i.value.length>0?(v(),g("div",eq,[...O[15]||(O[15]=[r("span",{class:"section-label"},"Marshal sessions",-1)])])):D("",!0),(v(!0),g(Ae,null,Ue(i.value,Z=>(v(),g("div",{key:Z.sessionKey,class:"session-card",onClick:ne=>C(Z)},[O[16]||(O[16]=r("div",{class:"card-icon marshal-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})])],-1)),r("div",nq,[r("div",oq,I(Z.eventName||"Event"),1),r("div",sq,I(Z.marshalName||"Marshal"),1),Z.eventDate?(v(),g("div",aq,I(U(Z.eventDate)),1)):D("",!0)]),r("button",{class:"btn-logout",onClick:lt(ne=>_(Z),["stop"]),title:"Log out from this session"},"  ",8,iq)],8,tq))),128))])),r("button",{class:"btn-back-home",onClick:Y,title:"Back to home"},"  ")]),Me(Qm,{show:d.value,onClose:O[3]||(O[3]=Z=>d.value=!1),onSuccess:oe},null,8,["show"]),Me(bG,{show:h.value,profile:N(n).profile,"show-logout":!0,onClose:O[4]||(O[4]=Z=>h.value=!1),onSubmit:B,onLogout:R},null,8,["show","profile"]),Me(UG,{show:k.value,"event-data":w.value,"is-editing":!1,onClose:Oe,onSubmit:ee},null,8,["show","event-data"]),(v(),Ke(Kl,{to:"body"},[Me(Jo,{name:"modal"},{default:Fe(()=>[m.value?(v(),g("div",{key:0,class:"modal-overlay",onClick:O[6]||(O[6]=lt(Z=>m.value=!1,["self"]))},[r("div",lq,[O[17]||(O[17]=r("h3",null,"Log out as admin?",-1)),O[18]||(O[18]=r("p",null,"This will log you out from all admin events.",-1)),O[19]||(O[19]=r("p",{class:"hint"},"You can log back in using the sign-in button.",-1)),r("div",rq,[r("button",{class:"btn btn-secondary",onClick:O[5]||(O[5]=Z=>m.value=!1)},"Cancel"),r("button",{class:"btn btn-danger",onClick:H},"Log out")])])])):D("",!0)]),_:1})])),(v(),Ke(Kl,{to:"body"},[Me(Jo,{name:"modal"},{default:Fe(()=>[f.value?(v(),g("div",{key:0,class:"modal-overlay",onClick:O[8]||(O[8]=lt(Z=>f.value=!1,["self"]))},[r("div",cq,[O[22]||(O[22]=r("h3",null,"Log out from session?",-1)),r("p",null,[O[20]||(O[20]=Ye("This will log you out from ",-1)),r("strong",null,I(y.value?.eventName||"this event"),1),O[21]||(O[21]=Ye(".",-1))]),O[23]||(O[23]=r("p",{class:"hint"},"You can log back in using the link from your event organiser.",-1)),r("div",uq,[r("button",{class:"btn btn-secondary",onClick:O[7]||(O[7]=Z=>f.value=!1)},"Cancel"),r("button",{class:"btn btn-danger",onClick:$},"Log out")])])])):D("",!0)]),_:1})]))]))}},hq=He(dq,[["__scopeId","data-v-add55e1c"]]);let Ep=!1;function fq(){Ep||(Ep=!0,wm(),_m())}const pq=[{path:"/",name:"Home",component:K_},{path:"/admin/login",name:"AdminLogin",component:ow},{path:"/admin/verify",name:"AdminVerify",component:uw},{path:"/sessions",name:"Sessions",component:hq},{path:"/admin/dashboard",redirect:"/sessions"},{path:"/admin/profile",redirect:"/sessions"},{path:"/admin/event/:eventId",name:"AdminEventManage",component:l9,meta:{requiresAuth:!0}},{path:"/marshal",redirect:"/sessions"},{path:"/event/:eventId",name:"MarshalView",component:pG},{path:"/:pathMatch(.*)*",redirect:"/"}],Ig=L0({history:n0("/VolunteerCheckin/testing/"),routes:pq});Ig.beforeEach((e,t,o)=>{fq();const a=localStorage.getItem("adminEmail");if(e.meta.requiresAuth&&!a){o({name:"AdminLogin"});return}if(e.meta.requiresAuth?go("admin"):e.name!=="MarshalView"&&e.name!=="Sessions"&&go(null),e.name==="MarshalView"){const n=e.params.eventId,i=!!e.query.code,l=tc(n),u=l?.marshalId?Lm(n,l.marshalId):null;if(i){o();return}if(l?.token){o();return}if(u){o();return}if(Cm()){o({name:"Sessions"});return}}o()});Js().then(()=>{console.log("Offline database initialized")}).catch(e=>{console.warn("Failed to initialize offline database:",e)});const Kd=ck(N0);Kd.use(hk());Kd.use(Ig);Kd.mount("#app");
