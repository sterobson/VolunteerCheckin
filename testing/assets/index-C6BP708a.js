(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function o(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=o(s);fetch(s.href,a)}})();function Fc(e){const t=Object.create(null);for(const o of e.split(","))t[o]=1;return o=>o in t}const xt={},xi=[],Mo=()=>{},_h=()=>!1,Yr=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Uc=e=>e.startsWith("onUpdate:"),Xt=Object.assign,zc=(e,t)=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},gv=Object.prototype.hasOwnProperty,wt=(e,t)=>gv.call(e,t),tt=Array.isArray,Ti=e=>Ra(e)==="[object Map]",Ri=e=>Ra(e)==="[object Set]",Bu=e=>Ra(e)==="[object Date]",ct=e=>typeof e=="function",Rt=e=>typeof e=="string",ro=e=>typeof e=="symbol",St=e=>e!==null&&typeof e=="object",kh=e=>(St(e)||ct(e))&&ct(e.then)&&ct(e.catch),bh=Object.prototype.toString,Ra=e=>bh.call(e),yv=e=>Ra(e).slice(8,-1),wh=e=>Ra(e)==="[object Object]",Jr=e=>Rt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,ma=Fc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Xr=e=>{const t=Object.create(null);return(o=>t[o]||(t[o]=e(o)))},_v=/-\w/g,Kn=Xr(e=>e.replace(_v,t=>t.slice(1).toUpperCase())),kv=/\B([A-Z])/g,Ms=Xr(e=>e.replace(kv,"-$1").toLowerCase()),Qr=Xr(e=>e.charAt(0).toUpperCase()+e.slice(1)),Ul=Xr(e=>e?`on${Qr(e)}`:""),Ss=(e,t)=>!Object.is(e,t),xr=(e,...t)=>{for(let o=0;o<e.length;o++)e[o](...t)},Ch=(e,t,o,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:o})},el=e=>{const t=parseFloat(e);return isNaN(t)?e:t},bv=e=>{const t=Rt(e)?Number(e):NaN;return isNaN(t)?e:t};let Nu;const tl=()=>Nu||(Nu=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function at(e){if(tt(e)){const t={};for(let o=0;o<e.length;o++){const i=e[o],s=Rt(i)?Sv(i):at(i);if(s)for(const a in s)t[a]=s[a]}return t}else if(Rt(e)||St(e))return e}const wv=/;(?![^(]*\))/g,Cv=/:([^]+)/,Lv=/\/\*[^]*?\*\//g;function Sv(e){const t={};return e.replace(Lv,"").split(wv).forEach(o=>{if(o){const i=o.split(Cv);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function Te(e){let t="";if(Rt(e))t=e;else if(tt(e))for(let o=0;o<e.length;o++){const i=Te(e[o]);i&&(t+=i+" ")}else if(St(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}const xv="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Tv=Fc(xv);function Lh(e){return!!e||e===""}function Iv(e,t){if(e.length!==t.length)return!1;let o=!0;for(let i=0;o&&i<e.length;i++)o=ii(e[i],t[i]);return o}function ii(e,t){if(e===t)return!0;let o=Bu(e),i=Bu(t);if(o||i)return o&&i?e.getTime()===t.getTime():!1;if(o=ro(e),i=ro(t),o||i)return e===t;if(o=tt(e),i=tt(t),o||i)return o&&i?Iv(e,t):!1;if(o=St(e),i=St(t),o||i){if(!o||!i)return!1;const s=Object.keys(e).length,a=Object.keys(t).length;if(s!==a)return!1;for(const l in e){const u=e.hasOwnProperty(l),h=t.hasOwnProperty(l);if(u&&!h||!u&&h||!ii(e[l],t[l]))return!1}}return String(e)===String(t)}function Hc(e,t){return e.findIndex(o=>ii(o,t))}const Sh=e=>!!(e&&e.__v_isRef===!0),b=e=>Rt(e)?e:e==null?"":tt(e)||St(e)&&(e.toString===bh||!ct(e.toString))?Sh(e)?b(e.value):JSON.stringify(e,xh,2):String(e),xh=(e,t)=>Sh(t)?xh(e,t.value):Ti(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((o,[i,s],a)=>(o[zl(i,a)+" =>"]=s,o),{})}:Ri(t)?{[`Set(${t.size})`]:[...t.values()].map(o=>zl(o))}:ro(t)?zl(t):St(t)&&!tt(t)&&!wh(t)?String(t):t,zl=(e,t="")=>{var o;return ro(e)?`Symbol(${(o=e.description)!=null?o:t})`:e};let on;class Th{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=on,!t&&on&&(this.index=(on.scopes||(on.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].pause();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].resume();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].resume()}}run(t){if(this._active){const o=on;try{return on=this,t()}finally{on=o}}}on(){++this._on===1&&(this.prevScope=on,on=this)}off(){this._on>0&&--this._on===0&&(on=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let o,i;for(o=0,i=this.effects.length;o<i;o++)this.effects[o].stop();for(this.effects.length=0,o=0,i=this.cleanups.length;o<i;o++)this.cleanups[o]();if(this.cleanups.length=0,this.scopes){for(o=0,i=this.scopes.length;o<i;o++)this.scopes[o].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function Ih(e){return new Th(e)}function $h(){return on}function $v(e,t=!1){on&&on.cleanups.push(e)}let It;const Hl=new WeakSet;class Mh{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,on&&on.active&&on.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Hl.has(this)&&(Hl.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Eh(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Fu(this),Ph(this);const t=It,o=ao;It=this,ao=!0;try{return this.fn()}finally{Dh(this),It=t,ao=o,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Zc(t);this.deps=this.depsTail=void 0,Fu(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Hl.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){cc(this)&&this.run()}get dirty(){return cc(this)}}let Ah=0,ga,ya;function Eh(e,t=!1){if(e.flags|=8,t){e.next=ya,ya=e;return}e.next=ga,ga=e}function Vc(){Ah++}function Gc(){if(--Ah>0)return;if(ya){let t=ya;for(ya=void 0;t;){const o=t.next;t.next=void 0,t.flags&=-9,t=o}}let e;for(;ga;){let t=ga;for(ga=void 0;t;){const o=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){e||(e=i)}t=o}}if(e)throw e}function Ph(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Dh(e){let t,o=e.depsTail,i=o;for(;i;){const s=i.prevDep;i.version===-1?(i===o&&(o=s),Zc(i),Mv(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=s}e.deps=t,e.depsTail=o}function cc(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Oh(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Oh(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Sa)||(e.globalVersion=Sa,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!cc(e))))return;e.flags|=2;const t=e.dep,o=It,i=ao;It=e,ao=!0;try{Ph(e);const s=e.fn(e._value);(t.version===0||Ss(s,e._value))&&(e.flags|=128,e._value=s,t.version++)}catch(s){throw t.version++,s}finally{It=o,ao=i,Dh(e),e.flags&=-3}}function Zc(e,t=!1){const{dep:o,prevSub:i,nextSub:s}=e;if(i&&(i.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=i,e.nextSub=void 0),o.subs===e&&(o.subs=i,!i&&o.computed)){o.computed.flags&=-5;for(let a=o.computed.deps;a;a=a.nextDep)Zc(a,!0)}!t&&!--o.sc&&o.map&&o.map.delete(o.key)}function Mv(e){const{prevDep:t,nextDep:o}=e;t&&(t.nextDep=o,e.prevDep=void 0),o&&(o.prevDep=t,e.nextDep=void 0)}let ao=!0;const Rh=[];function Qo(){Rh.push(ao),ao=!1}function es(){const e=Rh.pop();ao=e===void 0?!0:e}function Fu(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const o=It;It=void 0;try{t()}finally{It=o}}}let Sa=0;class Av{constructor(t,o){this.sub=t,this.dep=o,this.version=o.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class jc{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!It||!ao||It===this.computed)return;let o=this.activeLink;if(o===void 0||o.sub!==It)o=this.activeLink=new Av(It,this),It.deps?(o.prevDep=It.depsTail,It.depsTail.nextDep=o,It.depsTail=o):It.deps=It.depsTail=o,Bh(o);else if(o.version===-1&&(o.version=this.version,o.nextDep)){const i=o.nextDep;i.prevDep=o.prevDep,o.prevDep&&(o.prevDep.nextDep=i),o.prevDep=It.depsTail,o.nextDep=void 0,It.depsTail.nextDep=o,It.depsTail=o,It.deps===o&&(It.deps=i)}return o}trigger(t){this.version++,Sa++,this.notify(t)}notify(t){Vc();try{for(let o=this.subs;o;o=o.prevSub)o.sub.notify()&&o.sub.dep.notify()}finally{Gc()}}}function Bh(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)Bh(i)}const o=e.dep.subs;o!==e&&(e.prevSub=o,o&&(o.nextSub=e)),e.dep.subs=e}}const Rr=new WeakMap,ti=Symbol(""),uc=Symbol(""),xa=Symbol("");function an(e,t,o){if(ao&&It){let i=Rr.get(e);i||Rr.set(e,i=new Map);let s=i.get(o);s||(i.set(o,s=new jc),s.map=i,s.key=o),s.track()}}function Zo(e,t,o,i,s,a){const l=Rr.get(e);if(!l){Sa++;return}const u=h=>{h&&h.trigger()};if(Vc(),t==="clear")l.forEach(u);else{const h=tt(e),p=h&&Jr(o);if(h&&o==="length"){const f=Number(i);l.forEach((y,x)=>{(x==="length"||x===xa||!ro(x)&&x>=f)&&u(y)})}else switch((o!==void 0||l.has(void 0))&&u(l.get(o)),p&&u(l.get(xa)),t){case"add":h?p&&u(l.get("length")):(u(l.get(ti)),Ti(e)&&u(l.get(uc)));break;case"delete":h||(u(l.get(ti)),Ti(e)&&u(l.get(uc)));break;case"set":Ti(e)&&u(l.get(ti));break}}Gc()}function Ev(e,t){const o=Rr.get(e);return o&&o.get(t)}function _i(e){const t=_t(e);return t===e?t:(an(t,"iterate",xa),Bn(e)?t:t.map(lo))}function nl(e){return an(e=_t(e),"iterate",xa),e}function ys(e,t){return ts(e)?Jo(e)?Ai(lo(t)):Ai(t):lo(t)}const Pv={__proto__:null,[Symbol.iterator](){return Vl(this,Symbol.iterator,e=>ys(this,e))},concat(...e){return _i(this).concat(...e.map(t=>tt(t)?_i(t):t))},entries(){return Vl(this,"entries",e=>(e[1]=ys(this,e[1]),e))},every(e,t){return Fo(this,"every",e,t,void 0,arguments)},filter(e,t){return Fo(this,"filter",e,t,o=>o.map(i=>ys(this,i)),arguments)},find(e,t){return Fo(this,"find",e,t,o=>ys(this,o),arguments)},findIndex(e,t){return Fo(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Fo(this,"findLast",e,t,o=>ys(this,o),arguments)},findLastIndex(e,t){return Fo(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Fo(this,"forEach",e,t,void 0,arguments)},includes(...e){return Gl(this,"includes",e)},indexOf(...e){return Gl(this,"indexOf",e)},join(e){return _i(this).join(e)},lastIndexOf(...e){return Gl(this,"lastIndexOf",e)},map(e,t){return Fo(this,"map",e,t,void 0,arguments)},pop(){return ia(this,"pop")},push(...e){return ia(this,"push",e)},reduce(e,...t){return Uu(this,"reduce",e,t)},reduceRight(e,...t){return Uu(this,"reduceRight",e,t)},shift(){return ia(this,"shift")},some(e,t){return Fo(this,"some",e,t,void 0,arguments)},splice(...e){return ia(this,"splice",e)},toReversed(){return _i(this).toReversed()},toSorted(e){return _i(this).toSorted(e)},toSpliced(...e){return _i(this).toSpliced(...e)},unshift(...e){return ia(this,"unshift",e)},values(){return Vl(this,"values",e=>ys(this,e))}};function Vl(e,t,o){const i=nl(e),s=i[t]();return i!==e&&!Bn(e)&&(s._next=s.next,s.next=()=>{const a=s._next();return a.done||(a.value=o(a.value)),a}),s}const Dv=Array.prototype;function Fo(e,t,o,i,s,a){const l=nl(e),u=l!==e&&!Bn(e),h=l[t];if(h!==Dv[t]){const y=h.apply(e,a);return u?lo(y):y}let p=o;l!==e&&(u?p=function(y,x){return o.call(this,ys(e,y),x,e)}:o.length>2&&(p=function(y,x){return o.call(this,y,x,e)}));const f=h.call(l,p,i);return u&&s?s(f):f}function Uu(e,t,o,i){const s=nl(e);let a=o;return s!==e&&(Bn(e)?o.length>3&&(a=function(l,u,h){return o.call(this,l,u,h,e)}):a=function(l,u,h){return o.call(this,l,ys(e,u),h,e)}),s[t](a,...i)}function Gl(e,t,o){const i=_t(e);an(i,"iterate",xa);const s=i[t](...o);return(s===-1||s===!1)&&ol(o[0])?(o[0]=_t(o[0]),i[t](...o)):s}function ia(e,t,o=[]){Qo(),Vc();const i=_t(e)[t].apply(e,o);return Gc(),es(),i}const Ov=Fc("__proto__,__v_isRef,__isVue"),Nh=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(ro));function Rv(e){ro(e)||(e=String(e));const t=_t(this);return an(t,"has",e),t.hasOwnProperty(e)}class Fh{constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,i){if(o==="__v_skip")return t.__v_skip;const s=this._isReadonly,a=this._isShallow;if(o==="__v_isReactive")return!s;if(o==="__v_isReadonly")return s;if(o==="__v_isShallow")return a;if(o==="__v_raw")return i===(s?a?jv:Vh:a?Hh:zh).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const l=tt(t);if(!s){let h;if(l&&(h=Pv[o]))return h;if(o==="hasOwnProperty")return Rv}const u=Reflect.get(t,o,Ot(t)?t:i);if((ro(o)?Nh.has(o):Ov(o))||(s||an(t,"get",o),a))return u;if(Ot(u)){const h=l&&Jr(o)?u:u.value;return s&&St(h)?hc(h):h}return St(u)?s?hc(u):Ba(u):u}}class Uh extends Fh{constructor(t=!1){super(!1,t)}set(t,o,i,s){let a=t[o];const l=tt(t)&&Jr(o);if(!this._isShallow){const p=ts(a);if(!Bn(i)&&!ts(i)&&(a=_t(a),i=_t(i)),!l&&Ot(a)&&!Ot(i))return p||(a.value=i),!0}const u=l?Number(o)<t.length:wt(t,o),h=Reflect.set(t,o,i,Ot(t)?t:s);return t===_t(s)&&(u?Ss(i,a)&&Zo(t,"set",o,i):Zo(t,"add",o,i)),h}deleteProperty(t,o){const i=wt(t,o);t[o];const s=Reflect.deleteProperty(t,o);return s&&i&&Zo(t,"delete",o,void 0),s}has(t,o){const i=Reflect.has(t,o);return(!ro(o)||!Nh.has(o))&&an(t,"has",o),i}ownKeys(t){return an(t,"iterate",tt(t)?"length":ti),Reflect.ownKeys(t)}}class Bv extends Fh{constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const Nv=new Uh,Fv=new Bv,Uv=new Uh(!0);const dc=e=>e,mr=e=>Reflect.getPrototypeOf(e);function zv(e,t,o){return function(...i){const s=this.__v_raw,a=_t(s),l=Ti(a),u=e==="entries"||e===Symbol.iterator&&l,h=e==="keys"&&l,p=s[e](...i),f=o?dc:t?Ai:lo;return!t&&an(a,"iterate",h?uc:ti),{next(){const{value:y,done:x}=p.next();return x?{value:y,done:x}:{value:u?[f(y[0]),f(y[1])]:f(y),done:x}},[Symbol.iterator](){return this}}}}function gr(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Hv(e,t){const o={get(s){const a=this.__v_raw,l=_t(a),u=_t(s);e||(Ss(s,u)&&an(l,"get",s),an(l,"get",u));const{has:h}=mr(l),p=t?dc:e?Ai:lo;if(h.call(l,s))return p(a.get(s));if(h.call(l,u))return p(a.get(u));a!==l&&a.get(s)},get size(){const s=this.__v_raw;return!e&&an(_t(s),"iterate",ti),s.size},has(s){const a=this.__v_raw,l=_t(a),u=_t(s);return e||(Ss(s,u)&&an(l,"has",s),an(l,"has",u)),s===u?a.has(s):a.has(s)||a.has(u)},forEach(s,a){const l=this,u=l.__v_raw,h=_t(u),p=t?dc:e?Ai:lo;return!e&&an(h,"iterate",ti),u.forEach((f,y)=>s.call(a,p(f),p(y),l))}};return Xt(o,e?{add:gr("add"),set:gr("set"),delete:gr("delete"),clear:gr("clear")}:{add(s){!t&&!Bn(s)&&!ts(s)&&(s=_t(s));const a=_t(this);return mr(a).has.call(a,s)||(a.add(s),Zo(a,"add",s,s)),this},set(s,a){!t&&!Bn(a)&&!ts(a)&&(a=_t(a));const l=_t(this),{has:u,get:h}=mr(l);let p=u.call(l,s);p||(s=_t(s),p=u.call(l,s));const f=h.call(l,s);return l.set(s,a),p?Ss(a,f)&&Zo(l,"set",s,a):Zo(l,"add",s,a),this},delete(s){const a=_t(this),{has:l,get:u}=mr(a);let h=l.call(a,s);h||(s=_t(s),h=l.call(a,s)),u&&u.call(a,s);const p=a.delete(s);return h&&Zo(a,"delete",s,void 0),p},clear(){const s=_t(this),a=s.size!==0,l=s.clear();return a&&Zo(s,"clear",void 0,void 0),l}}),["keys","values","entries",Symbol.iterator].forEach(s=>{o[s]=zv(s,e,t)}),o}function Wc(e,t){const o=Hv(e,t);return(i,s,a)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?i:Reflect.get(wt(o,s)&&s in i?o:i,s,a)}const Vv={get:Wc(!1,!1)},Gv={get:Wc(!1,!0)},Zv={get:Wc(!0,!1)};const zh=new WeakMap,Hh=new WeakMap,Vh=new WeakMap,jv=new WeakMap;function Wv(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function qv(e){return e.__v_skip||!Object.isExtensible(e)?0:Wv(yv(e))}function Ba(e){return ts(e)?e:qc(e,!1,Nv,Vv,zh)}function Gh(e){return qc(e,!1,Uv,Gv,Hh)}function hc(e){return qc(e,!0,Fv,Zv,Vh)}function qc(e,t,o,i,s){if(!St(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=qv(e);if(a===0)return e;const l=s.get(e);if(l)return l;const u=new Proxy(e,a===2?i:o);return s.set(e,u),u}function Jo(e){return ts(e)?Jo(e.__v_raw):!!(e&&e.__v_isReactive)}function ts(e){return!!(e&&e.__v_isReadonly)}function Bn(e){return!!(e&&e.__v_isShallow)}function ol(e){return e?!!e.__v_raw:!1}function _t(e){const t=e&&e.__v_raw;return t?_t(t):e}function Kc(e){return!wt(e,"__v_skip")&&Object.isExtensible(e)&&Ch(e,"__v_skip",!0),e}const lo=e=>St(e)?Ba(e):e,Ai=e=>St(e)?hc(e):e;function Ot(e){return e?e.__v_isRef===!0:!1}function D(e){return Zh(e,!1)}function Kv(e){return Zh(e,!0)}function Zh(e,t){return Ot(e)?e:new Yv(e,t)}class Yv{constructor(t,o){this.dep=new jc,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=o?t:_t(t),this._value=o?t:lo(t),this.__v_isShallow=o}get value(){return this.dep.track(),this._value}set value(t){const o=this._rawValue,i=this.__v_isShallow||Bn(t)||ts(t);t=i?t:_t(t),Ss(t,o)&&(this._rawValue=t,this._value=i?t:lo(t),this.dep.trigger())}}function z(e){return Ot(e)?e.value:e}const Jv={get:(e,t,o)=>t==="__v_raw"?e:z(Reflect.get(e,t,o)),set:(e,t,o,i)=>{const s=e[t];return Ot(s)&&!Ot(o)?(s.value=o,!0):Reflect.set(e,t,o,i)}};function jh(e){return Jo(e)?e:new Proxy(e,Jv)}function Xv(e){const t=tt(e)?new Array(e.length):{};for(const o in e)t[o]=em(e,o);return t}class Qv{constructor(t,o,i){this._object=t,this._key=o,this._defaultValue=i,this.__v_isRef=!0,this._value=void 0,this._raw=_t(t);let s=!0,a=t;if(!tt(t)||!Jr(String(o)))do s=!ol(a)||Bn(a);while(s&&(a=a.__v_raw));this._shallow=s}get value(){let t=this._object[this._key];return this._shallow&&(t=z(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&Ot(this._raw[this._key])){const o=this._object[this._key];if(Ot(o)){o.value=t;return}}this._object[this._key]=t}get dep(){return Ev(this._raw,this._key)}}function em(e,t,o){return new Qv(e,t,o)}class tm{constructor(t,o,i){this.fn=t,this.setter=o,this._value=void 0,this.dep=new jc(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Sa-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!o,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&It!==this)return Eh(this,!0),!0}get value(){const t=this.dep.track();return Oh(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function nm(e,t,o=!1){let i,s;return ct(e)?i=e:(i=e.get,s=e.set),new tm(i,s,o)}const yr={},Br=new WeakMap;let js;function om(e,t=!1,o=js){if(o){let i=Br.get(o);i||Br.set(o,i=[]),i.push(e)}}function sm(e,t,o=xt){const{immediate:i,deep:s,once:a,scheduler:l,augmentJob:u,call:h}=o,p=$=>s?$:Bn($)||s===!1||s===0?jo($,1):jo($);let f,y,x,T,I=!1,S=!1;if(Ot(e)?(y=()=>e.value,I=Bn(e)):Jo(e)?(y=()=>p(e),I=!0):tt(e)?(S=!0,I=e.some($=>Jo($)||Bn($)),y=()=>e.map($=>{if(Ot($))return $.value;if(Jo($))return p($);if(ct($))return h?h($,2):$()})):ct(e)?t?y=h?()=>h(e,2):e:y=()=>{if(x){Qo();try{x()}finally{es()}}const $=js;js=f;try{return h?h(e,3,[T]):e(T)}finally{js=$}}:y=Mo,t&&s){const $=y,k=s===!0?1/0:s;y=()=>jo($(),k)}const R=$h(),E=()=>{f.stop(),R&&R.active&&zc(R.effects,f)};if(a&&t){const $=t;t=(...k)=>{$(...k),E()}}let M=S?new Array(e.length).fill(yr):yr;const _=$=>{if(!(!(f.flags&1)||!f.dirty&&!$))if(t){const k=f.run();if(s||I||(S?k.some((w,A)=>Ss(w,M[A])):Ss(k,M))){x&&x();const w=js;js=f;try{const A=[k,M===yr?void 0:S&&M[0]===yr?[]:M,T];M=k,h?h(t,3,A):t(...A)}finally{js=w}}}else f.run()};return u&&u(_),f=new Mh(y),f.scheduler=l?()=>l(_,!1):_,T=$=>om($,!1,f),x=f.onStop=()=>{const $=Br.get(f);if($){if(h)h($,4);else for(const k of $)k();Br.delete(f)}},t?i?_(!0):M=f.run():l?l(_.bind(null,!0),!0):f.run(),E.pause=f.pause.bind(f),E.resume=f.resume.bind(f),E.stop=E,E}function jo(e,t=1/0,o){if(t<=0||!St(e)||e.__v_skip||(o=o||new Map,(o.get(e)||0)>=t))return e;if(o.set(e,t),t--,Ot(e))jo(e.value,t,o);else if(tt(e))for(let i=0;i<e.length;i++)jo(e[i],t,o);else if(Ri(e)||Ti(e))e.forEach(i=>{jo(i,t,o)});else if(wh(e)){for(const i in e)jo(e[i],t,o);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&jo(e[i],t,o)}return e}function Na(e,t,o,i){try{return i?e(...i):e()}catch(s){sl(s,t,o)}}function co(e,t,o,i){if(ct(e)){const s=Na(e,t,o,i);return s&&kh(s)&&s.catch(a=>{sl(a,t,o)}),s}if(tt(e)){const s=[];for(let a=0;a<e.length;a++)s.push(co(e[a],t,o,i));return s}}function sl(e,t,o,i=!0){const s=t?t.vnode:null,{errorHandler:a,throwUnhandledErrorInProduction:l}=t&&t.appContext.config||xt;if(t){let u=t.parent;const h=t.proxy,p=`https://vuejs.org/error-reference/#runtime-${o}`;for(;u;){const f=u.ec;if(f){for(let y=0;y<f.length;y++)if(f[y](e,h,p)===!1)return}u=u.parent}if(a){Qo(),Na(a,null,10,[e,h,p]),es();return}}im(e,o,s,i,l)}function im(e,t,o,i=!0,s=!1){if(s)throw e;console.error(e)}const _n=[];let xo=-1;const Ii=[];let _s=null,bi=0;const Wh=Promise.resolve();let Nr=null;function Xo(e){const t=Nr||Wh;return e?t.then(this?e.bind(this):e):t}function am(e){let t=xo+1,o=_n.length;for(;t<o;){const i=t+o>>>1,s=_n[i],a=Ta(s);a<e||a===e&&s.flags&2?t=i+1:o=i}return t}function Yc(e){if(!(e.flags&1)){const t=Ta(e),o=_n[_n.length-1];!o||!(e.flags&2)&&t>=Ta(o)?_n.push(e):_n.splice(am(t),0,e),e.flags|=1,qh()}}function qh(){Nr||(Nr=Wh.then(Yh))}function rm(e){tt(e)?Ii.push(...e):_s&&e.id===-1?_s.splice(bi+1,0,e):e.flags&1||(Ii.push(e),e.flags|=1),qh()}function zu(e,t,o=xo+1){for(;o<_n.length;o++){const i=_n[o];if(i&&i.flags&2){if(e&&i.id!==e.uid)continue;_n.splice(o,1),o--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function Kh(e){if(Ii.length){const t=[...new Set(Ii)].sort((o,i)=>Ta(o)-Ta(i));if(Ii.length=0,_s){_s.push(...t);return}for(_s=t,bi=0;bi<_s.length;bi++){const o=_s[bi];o.flags&4&&(o.flags&=-2),o.flags&8||o(),o.flags&=-2}_s=null,bi=0}}const Ta=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Yh(e){try{for(xo=0;xo<_n.length;xo++){const t=_n[xo];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Na(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;xo<_n.length;xo++){const t=_n[xo];t&&(t.flags&=-2)}xo=-1,_n.length=0,Kh(),Nr=null,(_n.length||Ii.length)&&Yh()}}let en=null,Jh=null;function Fr(e){const t=en;return en=e,Jh=e&&e.type.__scopeId||null,t}function nt(e,t=en,o){if(!t||e._n)return e;const i=(...s)=>{i._d&&Hr(-1);const a=Fr(t);let l;try{l=e(...s)}finally{Fr(a),i._d&&Hr(1)}return l};return i._n=!0,i._c=!0,i._d=!0,i}function je(e,t){if(en===null)return e;const o=ul(en),i=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[a,l,u,h=xt]=t[s];a&&(ct(a)&&(a={mounted:a,updated:a}),a.deep&&jo(l),i.push({dir:a,instance:o,value:l,oldValue:void 0,arg:u,modifiers:h}))}return e}function Hs(e,t,o,i){const s=e.dirs,a=t&&t.dirs;for(let l=0;l<s.length;l++){const u=s[l];a&&(u.oldValue=a[l].value);let h=u.dir[i];h&&(Qo(),co(h,o,8,[e.el,u,e,t]),es())}}function Tr(e,t){if(ln){let o=ln.provides;const i=ln.parent&&ln.parent.provides;i===o&&(o=ln.provides=Object.create(i)),o[e]=t}}function Wn(e,t,o=!1){const i=tu();if(i||ni){let s=ni?ni._context.provides:i?i.parent==null||i.ce?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return o&&ct(t)?t.call(i&&i.proxy):t}}function lm(){return!!(tu()||ni)}const cm=Symbol.for("v-scx"),um=()=>Wn(cm);function We(e,t,o){return Xh(e,t,o)}function Xh(e,t,o=xt){const{immediate:i,deep:s,flush:a,once:l}=o,u=Xt({},o),h=t&&i||!t&&a!=="post";let p;if(Aa){if(a==="sync"){const T=um();p=T.__watcherHandles||(T.__watcherHandles=[])}else if(!h){const T=()=>{};return T.stop=Mo,T.resume=Mo,T.pause=Mo,T}}const f=ln;u.call=(T,I,S)=>co(T,f,I,S);let y=!1;a==="post"?u.scheduler=T=>{gn(T,f&&f.suspense)}:a!=="sync"&&(y=!0,u.scheduler=(T,I)=>{I?T():Yc(T)}),u.augmentJob=T=>{t&&(T.flags|=4),y&&(T.flags|=2,f&&(T.id=f.uid,T.i=f))};const x=sm(e,t,u);return Aa&&(p?p.push(x):h&&x()),x}function dm(e,t,o){const i=this.proxy,s=Rt(e)?e.includes(".")?Qh(i,e):()=>i[e]:e.bind(i,i);let a;ct(t)?a=t:(a=t.handler,o=t);const l=Fa(this),u=Xh(s,a.bind(i),o);return l(),u}function Qh(e,t){const o=t.split(".");return()=>{let i=e;for(let s=0;s<o.length&&i;s++)i=i[o[s]];return i}}const ef=Symbol("_vte"),tf=e=>e.__isTeleport,_a=e=>e&&(e.disabled||e.disabled===""),Hu=e=>e&&(e.defer||e.defer===""),Vu=e=>typeof SVGElement<"u"&&e instanceof SVGElement,Gu=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,fc=(e,t)=>{const o=e&&e.to;return Rt(o)?t?t(o):null:o},nf={name:"Teleport",__isTeleport:!0,process(e,t,o,i,s,a,l,u,h,p){const{mc:f,pc:y,pbc:x,o:{insert:T,querySelector:I,createText:S,createComment:R}}=p,E=_a(t.props);let{shapeFlag:M,children:_,dynamicChildren:$}=t;if(e==null){const k=t.el=S(""),w=t.anchor=S("");T(k,o,i),T(w,o,i);const A=(ae,_e)=>{M&16&&f(_,ae,_e,s,a,l,u,h)},ne=()=>{const ae=t.target=fc(t.props,I),_e=of(ae,t,S,T);ae&&(l!=="svg"&&Vu(ae)?l="svg":l!=="mathml"&&Gu(ae)&&(l="mathml"),s&&s.isCE&&(s.ce._teleportTargets||(s.ce._teleportTargets=new Set)).add(ae),E||(A(ae,_e),Ir(t,!1)))};E&&(A(o,w),Ir(t,!0)),Hu(t.props)?(t.el.__isMounted=!1,gn(()=>{ne(),delete t.el.__isMounted},a)):ne()}else{if(Hu(t.props)&&e.el.__isMounted===!1){gn(()=>{nf.process(e,t,o,i,s,a,l,u,h,p)},a);return}t.el=e.el,t.targetStart=e.targetStart;const k=t.anchor=e.anchor,w=t.target=e.target,A=t.targetAnchor=e.targetAnchor,ne=_a(e.props),ae=ne?o:w,_e=ne?k:A;if(l==="svg"||Vu(w)?l="svg":(l==="mathml"||Gu(w))&&(l="mathml"),$?(x(e.dynamicChildren,$,ae,s,a,l,u),Qc(e,t,!0)):h||y(e,t,ae,_e,s,a,l,u,!1),E)ne?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):_r(t,o,k,p,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const re=t.target=fc(t.props,I);re&&_r(t,re,null,p,0)}else ne&&_r(t,w,A,p,1);Ir(t,E)}},remove(e,t,o,{um:i,o:{remove:s}},a){const{shapeFlag:l,children:u,anchor:h,targetStart:p,targetAnchor:f,target:y,props:x}=e;if(y&&(s(p),s(f)),a&&s(h),l&16){const T=a||!_a(x);for(let I=0;I<u.length;I++){const S=u[I];i(S,t,o,T,!!S.dynamicChildren)}}},move:_r,hydrate:hm};function _r(e,t,o,{o:{insert:i},m:s},a=2){a===0&&i(e.targetAnchor,t,o);const{el:l,anchor:u,shapeFlag:h,children:p,props:f}=e,y=a===2;if(y&&i(l,t,o),(!y||_a(f))&&h&16)for(let x=0;x<p.length;x++)s(p[x],t,o,2);y&&i(u,t,o)}function hm(e,t,o,i,s,a,{o:{nextSibling:l,parentNode:u,querySelector:h,insert:p,createText:f}},y){function x(S,R,E,M){R.anchor=y(l(S),R,u(S),o,i,s,a),R.targetStart=E,R.targetAnchor=M}const T=t.target=fc(t.props,h),I=_a(t.props);if(T){const S=T._lpa||T.firstChild;if(t.shapeFlag&16)if(I)x(e,t,S,S&&l(S));else{t.anchor=l(e);let R=S;for(;R;){if(R&&R.nodeType===8){if(R.data==="teleport start anchor")t.targetStart=R;else if(R.data==="teleport anchor"){t.targetAnchor=R,T._lpa=t.targetAnchor&&l(t.targetAnchor);break}}R=l(R)}t.targetAnchor||of(T,t,f,p),y(S&&l(S),t,T,o,i,s,a)}Ir(t,I)}else I&&t.shapeFlag&16&&x(e,t,e,l(e));return t.anchor&&l(t.anchor)}const fm=nf;function Ir(e,t){const o=e.ctx;if(o&&o.ut){let i,s;for(t?(i=e.el,s=e.anchor):(i=e.targetStart,s=e.targetAnchor);i&&i!==s;)i.nodeType===1&&i.setAttribute("data-v-owner",o.uid),i=i.nextSibling;o.ut()}}function of(e,t,o,i){const s=t.targetStart=o(""),a=t.targetAnchor=o("");return s[ef]=a,e&&(i(s,e),i(a,e)),a}const Vo=Symbol("_leaveCb"),kr=Symbol("_enterCb");function pm(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return un(()=>{e.isMounted=!0}),ff(()=>{e.isUnmounting=!0}),e}const jn=[Function,Array],sf={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:jn,onEnter:jn,onAfterEnter:jn,onEnterCancelled:jn,onBeforeLeave:jn,onLeave:jn,onAfterLeave:jn,onLeaveCancelled:jn,onBeforeAppear:jn,onAppear:jn,onAfterAppear:jn,onAppearCancelled:jn},af=e=>{const t=e.subTree;return t.component?af(t.component):t},vm={name:"BaseTransition",props:sf,setup(e,{slots:t}){const o=tu(),i=pm();return()=>{const s=t.default&&cf(t.default(),!0);if(!s||!s.length)return;const a=rf(s),l=_t(e),{mode:u}=l;if(i.isLeaving)return Zl(a);const h=Zu(a);if(!h)return Zl(a);let p=pc(h,l,i,o,y=>p=y);h.type!==rn&&Ia(h,p);let f=o.subTree&&Zu(o.subTree);if(f&&f.type!==rn&&!Ws(f,h)&&af(o).type!==rn){let y=pc(f,l,i,o);if(Ia(f,y),u==="out-in"&&h.type!==rn)return i.isLeaving=!0,y.afterLeave=()=>{i.isLeaving=!1,o.job.flags&8||o.update(),delete y.afterLeave,f=void 0},Zl(a);u==="in-out"&&h.type!==rn?y.delayLeave=(x,T,I)=>{const S=lf(i,f);S[String(f.key)]=f,x[Vo]=()=>{T(),x[Vo]=void 0,delete p.delayedLeave,f=void 0},p.delayedLeave=()=>{I(),delete p.delayedLeave,f=void 0}}:f=void 0}else f&&(f=void 0);return a}}};function rf(e){let t=e[0];if(e.length>1){for(const o of e)if(o.type!==rn){t=o;break}}return t}const mm=vm;function lf(e,t){const{leavingVNodes:o}=e;let i=o.get(t.type);return i||(i=Object.create(null),o.set(t.type,i)),i}function pc(e,t,o,i,s){const{appear:a,mode:l,persisted:u=!1,onBeforeEnter:h,onEnter:p,onAfterEnter:f,onEnterCancelled:y,onBeforeLeave:x,onLeave:T,onAfterLeave:I,onLeaveCancelled:S,onBeforeAppear:R,onAppear:E,onAfterAppear:M,onAppearCancelled:_}=t,$=String(e.key),k=lf(o,e),w=(ae,_e)=>{ae&&co(ae,i,9,_e)},A=(ae,_e)=>{const re=_e[1];w(ae,_e),tt(ae)?ae.every(ve=>ve.length<=1)&&re():ae.length<=1&&re()},ne={mode:l,persisted:u,beforeEnter(ae){let _e=h;if(!o.isMounted)if(a)_e=R||h;else return;ae[Vo]&&ae[Vo](!0);const re=k[$];re&&Ws(e,re)&&re.el[Vo]&&re.el[Vo](),w(_e,[ae])},enter(ae){let _e=p,re=f,ve=y;if(!o.isMounted)if(a)_e=E||p,re=M||f,ve=_||y;else return;let Ie=!1;const Re=ae[kr]=xe=>{Ie||(Ie=!0,xe?w(ve,[ae]):w(re,[ae]),ne.delayedLeave&&ne.delayedLeave(),ae[kr]=void 0)};_e?A(_e,[ae,Re]):Re()},leave(ae,_e){const re=String(e.key);if(ae[kr]&&ae[kr](!0),o.isUnmounting)return _e();w(x,[ae]);let ve=!1;const Ie=ae[Vo]=Re=>{ve||(ve=!0,_e(),Re?w(S,[ae]):w(I,[ae]),ae[Vo]=void 0,k[re]===e&&delete k[re])};k[re]=e,T?A(T,[ae,Ie]):Ie()},clone(ae){const _e=pc(ae,t,o,i,s);return s&&s(_e),_e}};return ne}function Zl(e){if(il(e))return e=Ts(e),e.children=null,e}function Zu(e){if(!il(e))return tf(e.type)&&e.children?rf(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:o}=e;if(o){if(t&16)return o[0];if(t&32&&ct(o.default))return o.default()}}function Ia(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Ia(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function cf(e,t=!1,o){let i=[],s=0;for(let a=0;a<e.length;a++){let l=e[a];const u=o==null?l.key:String(o)+String(l.key!=null?l.key:a);l.type===Ce?(l.patchFlag&128&&s++,i=i.concat(cf(l.children,t,u))):(t||l.type!==rn)&&i.push(u!=null?Ts(l,{key:u}):l)}if(s>1)for(let a=0;a<i.length;a++)i[a].patchFlag=-2;return i}function uf(e,t){return ct(e)?Xt({name:e.name},t,{setup:e}):e}function df(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const Ur=new WeakMap;function ka(e,t,o,i,s=!1){if(tt(e)){e.forEach((I,S)=>ka(I,t&&(tt(t)?t[S]:t),o,i,s));return}if($i(i)&&!s){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&ka(e,t,o,i.component.subTree);return}const a=i.shapeFlag&4?ul(i.component):i.el,l=s?null:a,{i:u,r:h}=e,p=t&&t.r,f=u.refs===xt?u.refs={}:u.refs,y=u.setupState,x=_t(y),T=y===xt?_h:I=>wt(x,I);if(p!=null&&p!==h){if(ju(t),Rt(p))f[p]=null,T(p)&&(y[p]=null);else if(Ot(p)){p.value=null;const I=t;I.k&&(f[I.k]=null)}}if(ct(h))Na(h,u,12,[l,f]);else{const I=Rt(h),S=Ot(h);if(I||S){const R=()=>{if(e.f){const E=I?T(h)?y[h]:f[h]:h.value;if(s)tt(E)&&zc(E,a);else if(tt(E))E.includes(a)||E.push(a);else if(I)f[h]=[a],T(h)&&(y[h]=f[h]);else{const M=[a];h.value=M,e.k&&(f[e.k]=M)}}else I?(f[h]=l,T(h)&&(y[h]=l)):S&&(h.value=l,e.k&&(f[e.k]=l))};if(l){const E=()=>{R(),Ur.delete(e)};E.id=-1,Ur.set(e,E),gn(E,o)}else ju(e),R()}}}function ju(e){const t=Ur.get(e);t&&(t.flags|=8,Ur.delete(e))}tl().requestIdleCallback;tl().cancelIdleCallback;const $i=e=>!!e.type.__asyncLoader,il=e=>e.type.__isKeepAlive;function gm(e,t){hf(e,"a",t)}function ym(e,t){hf(e,"da",t)}function hf(e,t,o=ln){const i=e.__wdc||(e.__wdc=()=>{let s=o;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(al(t,i,o),o){let s=o.parent;for(;s&&s.parent;)il(s.parent.vnode)&&_m(i,t,o,s),s=s.parent}}function _m(e,t,o,i){const s=al(t,e,i,!0);Ao(()=>{zc(i[t],s)},o)}function al(e,t,o=ln,i=!1){if(o){const s=o[e]||(o[e]=[]),a=t.__weh||(t.__weh=(...l)=>{Qo();const u=Fa(o),h=co(t,o,e,l);return u(),es(),h});return i?s.unshift(a):s.push(a),a}}const ns=e=>(t,o=ln)=>{(!Aa||e==="sp")&&al(e,(...i)=>t(...i),o)},km=ns("bm"),un=ns("m"),bm=ns("bu"),wm=ns("u"),ff=ns("bum"),Ao=ns("um"),Cm=ns("sp"),Lm=ns("rtg"),Sm=ns("rtc");function xm(e,t=ln){al("ec",e,t)}const Tm="components";function rl(e,t){return $m(Tm,e,!0,t)||e}const Im=Symbol.for("v-ndc");function $m(e,t,o=!0,i=!1){const s=en||ln;if(s){const a=s.type;{const u=hg(a,!1);if(u&&(u===t||u===Kn(t)||u===Qr(Kn(t))))return a}const l=Wu(s[e]||a[e],t)||Wu(s.appContext[e],t);return!l&&i?a:l}}function Wu(e,t){return e&&(e[t]||e[Kn(t)]||e[Qr(Kn(t))])}function Be(e,t,o,i){let s;const a=o,l=tt(e);if(l||Rt(e)){const u=l&&Jo(e);let h=!1,p=!1;u&&(h=!Bn(e),p=ts(e),e=nl(e)),s=new Array(e.length);for(let f=0,y=e.length;f<y;f++)s[f]=t(h?p?Ai(lo(e[f])):lo(e[f]):e[f],f,void 0,a)}else if(typeof e=="number"){s=new Array(e);for(let u=0;u<e;u++)s[u]=t(u+1,u,void 0,a)}else if(St(e))if(e[Symbol.iterator])s=Array.from(e,(u,h)=>t(u,h,void 0,a));else{const u=Object.keys(e);s=new Array(u.length);for(let h=0,p=u.length;h<p;h++){const f=u[h];s[h]=t(e[f],f,h,a)}}else s=[];return s}function aa(e,t,o={},i,s){if(en.ce||en.parent&&$i(en.parent)&&en.parent.ce){const p=Object.keys(o).length>0;return t!=="default"&&(o.name=t),m(),rt(Ce,null,[ze("slot",o,i&&i())],p?-2:64)}let a=e[t];a&&a._c&&(a._d=!1),m();const l=a&&pf(a(o)),u=o.key||l&&l.key,h=rt(Ce,{key:(u&&!ro(u)?u:`_${t}`)+(!l&&i?"_fb":"")},l||(i?i():[]),l&&e._===1?64:-2);return a&&a._c&&(a._d=!0),h}function pf(e){return e.some(t=>Ma(t)?!(t.type===rn||t.type===Ce&&!pf(t.children)):!0)?e:null}const vc=e=>e?Df(e)?ul(e):vc(e.parent):null,ba=Xt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>vc(e.parent),$root:e=>vc(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>mf(e),$forceUpdate:e=>e.f||(e.f=()=>{Yc(e.update)}),$nextTick:e=>e.n||(e.n=Xo.bind(e.proxy)),$watch:e=>dm.bind(e)}),jl=(e,t)=>e!==xt&&!e.__isScriptSetup&&wt(e,t),Mm={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:o,setupState:i,data:s,props:a,accessCache:l,type:u,appContext:h}=e;if(t[0]!=="$"){const x=l[t];if(x!==void 0)switch(x){case 1:return i[t];case 2:return s[t];case 4:return o[t];case 3:return a[t]}else{if(jl(i,t))return l[t]=1,i[t];if(s!==xt&&wt(s,t))return l[t]=2,s[t];if(wt(a,t))return l[t]=3,a[t];if(o!==xt&&wt(o,t))return l[t]=4,o[t];mc&&(l[t]=0)}}const p=ba[t];let f,y;if(p)return t==="$attrs"&&an(e.attrs,"get",""),p(e);if((f=u.__cssModules)&&(f=f[t]))return f;if(o!==xt&&wt(o,t))return l[t]=4,o[t];if(y=h.config.globalProperties,wt(y,t))return y[t]},set({_:e},t,o){const{data:i,setupState:s,ctx:a}=e;return jl(s,t)?(s[t]=o,!0):i!==xt&&wt(i,t)?(i[t]=o,!0):wt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=o,!0)},has({_:{data:e,setupState:t,accessCache:o,ctx:i,appContext:s,props:a,type:l}},u){let h;return!!(o[u]||e!==xt&&u[0]!=="$"&&wt(e,u)||jl(t,u)||wt(a,u)||wt(i,u)||wt(ba,u)||wt(s.config.globalProperties,u)||(h=l.__cssModules)&&h[u])},defineProperty(e,t,o){return o.get!=null?e._.accessCache[t]=0:wt(o,"value")&&this.set(e,t,o.value,null),Reflect.defineProperty(e,t,o)}};function qu(e){return tt(e)?e.reduce((t,o)=>(t[o]=null,t),{}):e}let mc=!0;function Am(e){const t=mf(e),o=e.proxy,i=e.ctx;mc=!1,t.beforeCreate&&Ku(t.beforeCreate,e,"bc");const{data:s,computed:a,methods:l,watch:u,provide:h,inject:p,created:f,beforeMount:y,mounted:x,beforeUpdate:T,updated:I,activated:S,deactivated:R,beforeDestroy:E,beforeUnmount:M,destroyed:_,unmounted:$,render:k,renderTracked:w,renderTriggered:A,errorCaptured:ne,serverPrefetch:ae,expose:_e,inheritAttrs:re,components:ve,directives:Ie,filters:Re}=t;if(p&&Em(p,i,null),l)for(const Q in l){const J=l[Q];ct(J)&&(i[Q]=J.bind(o))}if(s){const Q=s.call(o,o);St(Q)&&(e.data=Ba(Q))}if(mc=!0,a)for(const Q in a){const J=a[Q],ue=ct(J)?J.bind(o,o):ct(J.get)?J.get.bind(o,o):Mo,te=!ct(J)&&ct(J.set)?J.set.bind(o):Mo,ke=X({get:ue,set:te});Object.defineProperty(i,Q,{enumerable:!0,configurable:!0,get:()=>ke.value,set:Oe=>ke.value=Oe})}if(u)for(const Q in u)vf(u[Q],i,o,Q);if(h){const Q=ct(h)?h.call(o):h;Reflect.ownKeys(Q).forEach(J=>{Tr(J,Q[J])})}f&&Ku(f,e,"c");function he(Q,J){tt(J)?J.forEach(ue=>Q(ue.bind(o))):J&&Q(J.bind(o))}if(he(km,y),he(un,x),he(bm,T),he(wm,I),he(gm,S),he(ym,R),he(xm,ne),he(Sm,w),he(Lm,A),he(ff,M),he(Ao,$),he(Cm,ae),tt(_e))if(_e.length){const Q=e.exposed||(e.exposed={});_e.forEach(J=>{Object.defineProperty(Q,J,{get:()=>o[J],set:ue=>o[J]=ue,enumerable:!0})})}else e.exposed||(e.exposed={});k&&e.render===Mo&&(e.render=k),re!=null&&(e.inheritAttrs=re),ve&&(e.components=ve),Ie&&(e.directives=Ie),ae&&df(e)}function Em(e,t,o=Mo){tt(e)&&(e=gc(e));for(const i in e){const s=e[i];let a;St(s)?"default"in s?a=Wn(s.from||i,s.default,!0):a=Wn(s.from||i):a=Wn(s),Ot(a)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>a.value,set:l=>a.value=l}):t[i]=a}}function Ku(e,t,o){co(tt(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,o)}function vf(e,t,o,i){let s=i.includes(".")?Qh(o,i):()=>o[i];if(Rt(e)){const a=t[e];ct(a)&&We(s,a)}else if(ct(e))We(s,e.bind(o));else if(St(e))if(tt(e))e.forEach(a=>vf(a,t,o,i));else{const a=ct(e.handler)?e.handler.bind(o):t[e.handler];ct(a)&&We(s,a,e)}}function mf(e){const t=e.type,{mixins:o,extends:i}=t,{mixins:s,optionsCache:a,config:{optionMergeStrategies:l}}=e.appContext,u=a.get(t);let h;return u?h=u:!s.length&&!o&&!i?h=t:(h={},s.length&&s.forEach(p=>zr(h,p,l,!0)),zr(h,t,l)),St(t)&&a.set(t,h),h}function zr(e,t,o,i=!1){const{mixins:s,extends:a}=t;a&&zr(e,a,o,!0),s&&s.forEach(l=>zr(e,l,o,!0));for(const l in t)if(!(i&&l==="expose")){const u=Pm[l]||o&&o[l];e[l]=u?u(e[l],t[l]):t[l]}return e}const Pm={data:Yu,props:Ju,emits:Ju,methods:da,computed:da,beforeCreate:mn,created:mn,beforeMount:mn,mounted:mn,beforeUpdate:mn,updated:mn,beforeDestroy:mn,beforeUnmount:mn,destroyed:mn,unmounted:mn,activated:mn,deactivated:mn,errorCaptured:mn,serverPrefetch:mn,components:da,directives:da,watch:Om,provide:Yu,inject:Dm};function Yu(e,t){return t?e?function(){return Xt(ct(e)?e.call(this,this):e,ct(t)?t.call(this,this):t)}:t:e}function Dm(e,t){return da(gc(e),gc(t))}function gc(e){if(tt(e)){const t={};for(let o=0;o<e.length;o++)t[e[o]]=e[o];return t}return e}function mn(e,t){return e?[...new Set([].concat(e,t))]:t}function da(e,t){return e?Xt(Object.create(null),e,t):t}function Ju(e,t){return e?tt(e)&&tt(t)?[...new Set([...e,...t])]:Xt(Object.create(null),qu(e),qu(t??{})):t}function Om(e,t){if(!e)return t;if(!t)return e;const o=Xt(Object.create(null),e);for(const i in t)o[i]=mn(e[i],t[i]);return o}function gf(){return{app:null,config:{isNativeTag:_h,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Rm=0;function Bm(e,t){return function(i,s=null){ct(i)||(i=Xt({},i)),s!=null&&!St(s)&&(s=null);const a=gf(),l=new WeakSet,u=[];let h=!1;const p=a.app={_uid:Rm++,_component:i,_props:s,_container:null,_context:a,_instance:null,version:pg,get config(){return a.config},set config(f){},use(f,...y){return l.has(f)||(f&&ct(f.install)?(l.add(f),f.install(p,...y)):ct(f)&&(l.add(f),f(p,...y))),p},mixin(f){return a.mixins.includes(f)||a.mixins.push(f),p},component(f,y){return y?(a.components[f]=y,p):a.components[f]},directive(f,y){return y?(a.directives[f]=y,p):a.directives[f]},mount(f,y,x){if(!h){const T=p._ceVNode||ze(i,s);return T.appContext=a,x===!0?x="svg":x===!1&&(x=void 0),e(T,f,x),h=!0,p._container=f,f.__vue_app__=p,ul(T.component)}},onUnmount(f){u.push(f)},unmount(){h&&(co(u,p._instance,16),e(null,p._container),delete p._container.__vue_app__)},provide(f,y){return a.provides[f]=y,p},runWithContext(f){const y=ni;ni=p;try{return f()}finally{ni=y}}};return p}}let ni=null;const Nm=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Kn(t)}Modifiers`]||e[`${Ms(t)}Modifiers`];function Fm(e,t,...o){if(e.isUnmounted)return;const i=e.vnode.props||xt;let s=o;const a=t.startsWith("update:"),l=a&&Nm(i,t.slice(7));l&&(l.trim&&(s=o.map(f=>Rt(f)?f.trim():f)),l.number&&(s=o.map(el)));let u,h=i[u=Ul(t)]||i[u=Ul(Kn(t))];!h&&a&&(h=i[u=Ul(Ms(t))]),h&&co(h,e,6,s);const p=i[u+"Once"];if(p){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,co(p,e,6,s)}}const Um=new WeakMap;function yf(e,t,o=!1){const i=o?Um:t.emitsCache,s=i.get(e);if(s!==void 0)return s;const a=e.emits;let l={},u=!1;if(!ct(e)){const h=p=>{const f=yf(p,t,!0);f&&(u=!0,Xt(l,f))};!o&&t.mixins.length&&t.mixins.forEach(h),e.extends&&h(e.extends),e.mixins&&e.mixins.forEach(h)}return!a&&!u?(St(e)&&i.set(e,null),null):(tt(a)?a.forEach(h=>l[h]=null):Xt(l,a),St(e)&&i.set(e,l),l)}function ll(e,t){return!e||!Yr(t)?!1:(t=t.slice(2).replace(/Once$/,""),wt(e,t[0].toLowerCase()+t.slice(1))||wt(e,Ms(t))||wt(e,t))}function Xu(e){const{type:t,vnode:o,proxy:i,withProxy:s,propsOptions:[a],slots:l,attrs:u,emit:h,render:p,renderCache:f,props:y,data:x,setupState:T,ctx:I,inheritAttrs:S}=e,R=Fr(e);let E,M;try{if(o.shapeFlag&4){const $=s||i,k=$;E=To(p.call(k,$,f,y,T,x,I)),M=u}else{const $=t;E=To($.length>1?$(y,{attrs:u,slots:l,emit:h}):$(y,null)),M=t.props?u:zm(u)}}catch($){wa.length=0,sl($,e,1),E=ze(rn)}let _=E;if(M&&S!==!1){const $=Object.keys(M),{shapeFlag:k}=_;$.length&&k&7&&(a&&$.some(Uc)&&(M=Hm(M,a)),_=Ts(_,M,!1,!0))}return o.dirs&&(_=Ts(_,null,!1,!0),_.dirs=_.dirs?_.dirs.concat(o.dirs):o.dirs),o.transition&&Ia(_,o.transition),E=_,Fr(R),E}const zm=e=>{let t;for(const o in e)(o==="class"||o==="style"||Yr(o))&&((t||(t={}))[o]=e[o]);return t},Hm=(e,t)=>{const o={};for(const i in e)(!Uc(i)||!(i.slice(9)in t))&&(o[i]=e[i]);return o};function Vm(e,t,o){const{props:i,children:s,component:a}=e,{props:l,children:u,patchFlag:h}=t,p=a.emitsOptions;if(t.dirs||t.transition)return!0;if(o&&h>=0){if(h&1024)return!0;if(h&16)return i?Qu(i,l,p):!!l;if(h&8){const f=t.dynamicProps;for(let y=0;y<f.length;y++){const x=f[y];if(l[x]!==i[x]&&!ll(p,x))return!0}}}else return(s||u)&&(!u||!u.$stable)?!0:i===l?!1:i?l?Qu(i,l,p):!0:!!l;return!1}function Qu(e,t,o){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let s=0;s<i.length;s++){const a=i[s];if(t[a]!==e[a]&&!ll(o,a))return!0}return!1}function Gm({vnode:e,parent:t},o){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=o,t=t.parent;else break}}const _f={},kf=()=>Object.create(_f),bf=e=>Object.getPrototypeOf(e)===_f;function Zm(e,t,o,i=!1){const s={},a=kf();e.propsDefaults=Object.create(null),wf(e,t,s,a);for(const l in e.propsOptions[0])l in s||(s[l]=void 0);o?e.props=i?s:Gh(s):e.type.props?e.props=s:e.props=a,e.attrs=a}function jm(e,t,o,i){const{props:s,attrs:a,vnode:{patchFlag:l}}=e,u=_t(s),[h]=e.propsOptions;let p=!1;if((i||l>0)&&!(l&16)){if(l&8){const f=e.vnode.dynamicProps;for(let y=0;y<f.length;y++){let x=f[y];if(ll(e.emitsOptions,x))continue;const T=t[x];if(h)if(wt(a,x))T!==a[x]&&(a[x]=T,p=!0);else{const I=Kn(x);s[I]=yc(h,u,I,T,e,!1)}else T!==a[x]&&(a[x]=T,p=!0)}}}else{wf(e,t,s,a)&&(p=!0);let f;for(const y in u)(!t||!wt(t,y)&&((f=Ms(y))===y||!wt(t,f)))&&(h?o&&(o[y]!==void 0||o[f]!==void 0)&&(s[y]=yc(h,u,y,void 0,e,!0)):delete s[y]);if(a!==u)for(const y in a)(!t||!wt(t,y))&&(delete a[y],p=!0)}p&&Zo(e.attrs,"set","")}function wf(e,t,o,i){const[s,a]=e.propsOptions;let l=!1,u;if(t)for(let h in t){if(ma(h))continue;const p=t[h];let f;s&&wt(s,f=Kn(h))?!a||!a.includes(f)?o[f]=p:(u||(u={}))[f]=p:ll(e.emitsOptions,h)||(!(h in i)||p!==i[h])&&(i[h]=p,l=!0)}if(a){const h=_t(o),p=u||xt;for(let f=0;f<a.length;f++){const y=a[f];o[y]=yc(s,h,y,p[y],e,!wt(p,y))}}return l}function yc(e,t,o,i,s,a){const l=e[o];if(l!=null){const u=wt(l,"default");if(u&&i===void 0){const h=l.default;if(l.type!==Function&&!l.skipFactory&&ct(h)){const{propsDefaults:p}=s;if(o in p)i=p[o];else{const f=Fa(s);i=p[o]=h.call(null,t),f()}}else i=h;s.ce&&s.ce._setProp(o,i)}l[0]&&(a&&!u?i=!1:l[1]&&(i===""||i===Ms(o))&&(i=!0))}return i}const Wm=new WeakMap;function Cf(e,t,o=!1){const i=o?Wm:t.propsCache,s=i.get(e);if(s)return s;const a=e.props,l={},u=[];let h=!1;if(!ct(e)){const f=y=>{h=!0;const[x,T]=Cf(y,t,!0);Xt(l,x),T&&u.push(...T)};!o&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}if(!a&&!h)return St(e)&&i.set(e,xi),xi;if(tt(a))for(let f=0;f<a.length;f++){const y=Kn(a[f]);ed(y)&&(l[y]=xt)}else if(a)for(const f in a){const y=Kn(f);if(ed(y)){const x=a[f],T=l[y]=tt(x)||ct(x)?{type:x}:Xt({},x),I=T.type;let S=!1,R=!0;if(tt(I))for(let E=0;E<I.length;++E){const M=I[E],_=ct(M)&&M.name;if(_==="Boolean"){S=!0;break}else _==="String"&&(R=!1)}else S=ct(I)&&I.name==="Boolean";T[0]=S,T[1]=R,(S||wt(T,"default"))&&u.push(y)}}const p=[l,u];return St(e)&&i.set(e,p),p}function ed(e){return e[0]!=="$"&&!ma(e)}const Jc=e=>e==="_"||e==="_ctx"||e==="$stable",Xc=e=>tt(e)?e.map(To):[To(e)],qm=(e,t,o)=>{if(t._n)return t;const i=nt((...s)=>Xc(t(...s)),o);return i._c=!1,i},Lf=(e,t,o)=>{const i=e._ctx;for(const s in e){if(Jc(s))continue;const a=e[s];if(ct(a))t[s]=qm(s,a,i);else if(a!=null){const l=Xc(a);t[s]=()=>l}}},Sf=(e,t)=>{const o=Xc(t);e.slots.default=()=>o},xf=(e,t,o)=>{for(const i in t)(o||!Jc(i))&&(e[i]=t[i])},Km=(e,t,o)=>{const i=e.slots=kf();if(e.vnode.shapeFlag&32){const s=t._;s?(xf(i,t,o),o&&Ch(i,"_",s,!0)):Lf(t,i)}else t&&Sf(e,t)},Ym=(e,t,o)=>{const{vnode:i,slots:s}=e;let a=!0,l=xt;if(i.shapeFlag&32){const u=t._;u?o&&u===1?a=!1:xf(s,t,o):(a=!t.$stable,Lf(t,s)),l=t}else t&&(Sf(e,t),l={default:1});if(a)for(const u in s)!Jc(u)&&l[u]==null&&delete s[u]},gn=tg;function Jm(e){return Xm(e)}function Xm(e,t){const o=tl();o.__VUE__=!0;const{insert:i,remove:s,patchProp:a,createElement:l,createText:u,createComment:h,setText:p,setElementText:f,parentNode:y,nextSibling:x,setScopeId:T=Mo,insertStaticContent:I}=e,S=(F,G,W,j=null,O=null,B=null,K=void 0,ye=null,$e=!!G.dynamicChildren)=>{if(F===G)return;F&&!Ws(F,G)&&(j=le(F),Oe(F,O,B,!0),F=null),G.patchFlag===-2&&($e=!1,G.dynamicChildren=null);const{type:we,ref:Ne,shapeFlag:Fe}=G;switch(we){case cl:R(F,G,W,j);break;case rn:E(F,G,W,j);break;case $r:F==null&&M(G,W,j,K);break;case Ce:ve(F,G,W,j,O,B,K,ye,$e);break;default:Fe&1?k(F,G,W,j,O,B,K,ye,$e):Fe&6?Ie(F,G,W,j,O,B,K,ye,$e):(Fe&64||Fe&128)&&we.process(F,G,W,j,O,B,K,ye,$e,fe)}Ne!=null&&O?ka(Ne,F&&F.ref,B,G||F,!G):Ne==null&&F&&F.ref!=null&&ka(F.ref,null,B,F,!0)},R=(F,G,W,j)=>{if(F==null)i(G.el=u(G.children),W,j);else{const O=G.el=F.el;G.children!==F.children&&p(O,G.children)}},E=(F,G,W,j)=>{F==null?i(G.el=h(G.children||""),W,j):G.el=F.el},M=(F,G,W,j)=>{[F.el,F.anchor]=I(F.children,G,W,j,F.el,F.anchor)},_=({el:F,anchor:G},W,j)=>{let O;for(;F&&F!==G;)O=x(F),i(F,W,j),F=O;i(G,W,j)},$=({el:F,anchor:G})=>{let W;for(;F&&F!==G;)W=x(F),s(F),F=W;s(G)},k=(F,G,W,j,O,B,K,ye,$e)=>{if(G.type==="svg"?K="svg":G.type==="math"&&(K="mathml"),F==null)w(G,W,j,O,B,K,ye,$e);else{const we=F.el&&F.el._isVueCE?F.el:null;try{we&&we._beginPatch(),ae(F,G,O,B,K,ye,$e)}finally{we&&we._endPatch()}}},w=(F,G,W,j,O,B,K,ye)=>{let $e,we;const{props:Ne,shapeFlag:Fe,transition:Ue,dirs:Ke}=F;if($e=F.el=l(F.type,B,Ne&&Ne.is,Ne),Fe&8?f($e,F.children):Fe&16&&ne(F.children,$e,null,j,O,Wl(F,B),K,ye),Ke&&Hs(F,null,j,"created"),A($e,F,F.scopeId,K,j),Ne){for(const ee in Ne)ee!=="value"&&!ma(ee)&&a($e,ee,null,Ne[ee],B,j);"value"in Ne&&a($e,"value",null,Ne.value,B),(we=Ne.onVnodeBeforeMount)&&Lo(we,j,F)}Ke&&Hs(F,null,j,"beforeMount");const se=Qm(O,Ue);se&&Ue.beforeEnter($e),i($e,G,W),((we=Ne&&Ne.onVnodeMounted)||se||Ke)&&gn(()=>{we&&Lo(we,j,F),se&&Ue.enter($e),Ke&&Hs(F,null,j,"mounted")},O)},A=(F,G,W,j,O)=>{if(W&&T(F,W),j)for(let B=0;B<j.length;B++)T(F,j[B]);if(O){let B=O.subTree;if(G===B||$f(B.type)&&(B.ssContent===G||B.ssFallback===G)){const K=O.vnode;A(F,K,K.scopeId,K.slotScopeIds,O.parent)}}},ne=(F,G,W,j,O,B,K,ye,$e=0)=>{for(let we=$e;we<F.length;we++){const Ne=F[we]=ye?ks(F[we]):To(F[we]);S(null,Ne,G,W,j,O,B,K,ye)}},ae=(F,G,W,j,O,B,K)=>{const ye=G.el=F.el;let{patchFlag:$e,dynamicChildren:we,dirs:Ne}=G;$e|=F.patchFlag&16;const Fe=F.props||xt,Ue=G.props||xt;let Ke;if(W&&Vs(W,!1),(Ke=Ue.onVnodeBeforeUpdate)&&Lo(Ke,W,G,F),Ne&&Hs(G,F,W,"beforeUpdate"),W&&Vs(W,!0),(Fe.innerHTML&&Ue.innerHTML==null||Fe.textContent&&Ue.textContent==null)&&f(ye,""),we?_e(F.dynamicChildren,we,ye,W,j,Wl(G,O),B):K||J(F,G,ye,null,W,j,Wl(G,O),B,!1),$e>0){if($e&16)re(ye,Fe,Ue,W,O);else if($e&2&&Fe.class!==Ue.class&&a(ye,"class",null,Ue.class,O),$e&4&&a(ye,"style",Fe.style,Ue.style,O),$e&8){const se=G.dynamicProps;for(let ee=0;ee<se.length;ee++){const Z=se[ee],Ve=Fe[Z],Ye=Ue[Z];(Ye!==Ve||Z==="value")&&a(ye,Z,Ve,Ye,O,W)}}$e&1&&F.children!==G.children&&f(ye,G.children)}else!K&&we==null&&re(ye,Fe,Ue,W,O);((Ke=Ue.onVnodeUpdated)||Ne)&&gn(()=>{Ke&&Lo(Ke,W,G,F),Ne&&Hs(G,F,W,"updated")},j)},_e=(F,G,W,j,O,B,K)=>{for(let ye=0;ye<G.length;ye++){const $e=F[ye],we=G[ye],Ne=$e.el&&($e.type===Ce||!Ws($e,we)||$e.shapeFlag&198)?y($e.el):W;S($e,we,Ne,null,j,O,B,K,!0)}},re=(F,G,W,j,O)=>{if(G!==W){if(G!==xt)for(const B in G)!ma(B)&&!(B in W)&&a(F,B,G[B],null,O,j);for(const B in W){if(ma(B))continue;const K=W[B],ye=G[B];K!==ye&&B!=="value"&&a(F,B,ye,K,O,j)}"value"in W&&a(F,"value",G.value,W.value,O)}},ve=(F,G,W,j,O,B,K,ye,$e)=>{const we=G.el=F?F.el:u(""),Ne=G.anchor=F?F.anchor:u("");let{patchFlag:Fe,dynamicChildren:Ue,slotScopeIds:Ke}=G;Ke&&(ye=ye?ye.concat(Ke):Ke),F==null?(i(we,W,j),i(Ne,W,j),ne(G.children||[],W,Ne,O,B,K,ye,$e)):Fe>0&&Fe&64&&Ue&&F.dynamicChildren&&F.dynamicChildren.length===Ue.length?(_e(F.dynamicChildren,Ue,W,O,B,K,ye),(G.key!=null||O&&G===O.subTree)&&Qc(F,G,!0)):J(F,G,W,Ne,O,B,K,ye,$e)},Ie=(F,G,W,j,O,B,K,ye,$e)=>{G.slotScopeIds=ye,F==null?G.shapeFlag&512?O.ctx.activate(G,W,j,K,$e):Re(G,W,j,O,B,K,$e):xe(F,G,$e)},Re=(F,G,W,j,O,B,K)=>{const ye=F.component=rg(F,j,O);if(il(F)&&(ye.ctx.renderer=fe),lg(ye,!1,K),ye.asyncDep){if(O&&O.registerDep(ye,he,K),!F.el){const $e=ye.subTree=ze(rn);E(null,$e,G,W),F.placeholder=$e.el}}else he(ye,F,G,W,O,B,K)},xe=(F,G,W)=>{const j=G.component=F.component;if(Vm(F,G,W))if(j.asyncDep&&!j.asyncResolved){Q(j,G,W);return}else j.next=G,j.update();else G.el=F.el,j.vnode=G},he=(F,G,W,j,O,B,K)=>{const ye=()=>{if(F.isMounted){let{next:Fe,bu:Ue,u:Ke,parent:se,vnode:ee}=F;{const et=Tf(F);if(et){Fe&&(Fe.el=ee.el,Q(F,Fe,K)),et.asyncDep.then(()=>{F.isUnmounted||ye()});return}}let Z=Fe,Ve;Vs(F,!1),Fe?(Fe.el=ee.el,Q(F,Fe,K)):Fe=ee,Ue&&xr(Ue),(Ve=Fe.props&&Fe.props.onVnodeBeforeUpdate)&&Lo(Ve,se,Fe,ee),Vs(F,!0);const Ye=Xu(F),Qe=F.subTree;F.subTree=Ye,S(Qe,Ye,y(Qe.el),le(Qe),F,O,B),Fe.el=Ye.el,Z===null&&Gm(F,Ye.el),Ke&&gn(Ke,O),(Ve=Fe.props&&Fe.props.onVnodeUpdated)&&gn(()=>Lo(Ve,se,Fe,ee),O)}else{let Fe;const{el:Ue,props:Ke}=G,{bm:se,m:ee,parent:Z,root:Ve,type:Ye}=F,Qe=$i(G);Vs(F,!1),se&&xr(se),!Qe&&(Fe=Ke&&Ke.onVnodeBeforeMount)&&Lo(Fe,Z,G),Vs(F,!0);{Ve.ce&&Ve.ce._def.shadowRoot!==!1&&Ve.ce._injectChildStyle(Ye);const et=F.subTree=Xu(F);S(null,et,W,j,F,O,B),G.el=et.el}if(ee&&gn(ee,O),!Qe&&(Fe=Ke&&Ke.onVnodeMounted)){const et=G;gn(()=>Lo(Fe,Z,et),O)}(G.shapeFlag&256||Z&&$i(Z.vnode)&&Z.vnode.shapeFlag&256)&&F.a&&gn(F.a,O),F.isMounted=!0,G=W=j=null}};F.scope.on();const $e=F.effect=new Mh(ye);F.scope.off();const we=F.update=$e.run.bind($e),Ne=F.job=$e.runIfDirty.bind($e);Ne.i=F,Ne.id=F.uid,$e.scheduler=()=>Yc(Ne),Vs(F,!0),we()},Q=(F,G,W)=>{G.component=F;const j=F.vnode.props;F.vnode=G,F.next=null,jm(F,G.props,j,W),Ym(F,G.children,W),Qo(),zu(F),es()},J=(F,G,W,j,O,B,K,ye,$e=!1)=>{const we=F&&F.children,Ne=F?F.shapeFlag:0,Fe=G.children,{patchFlag:Ue,shapeFlag:Ke}=G;if(Ue>0){if(Ue&128){te(we,Fe,W,j,O,B,K,ye,$e);return}else if(Ue&256){ue(we,Fe,W,j,O,B,K,ye,$e);return}}Ke&8?(Ne&16&&Se(we,O,B),Fe!==we&&f(W,Fe)):Ne&16?Ke&16?te(we,Fe,W,j,O,B,K,ye,$e):Se(we,O,B,!0):(Ne&8&&f(W,""),Ke&16&&ne(Fe,W,j,O,B,K,ye,$e))},ue=(F,G,W,j,O,B,K,ye,$e)=>{F=F||xi,G=G||xi;const we=F.length,Ne=G.length,Fe=Math.min(we,Ne);let Ue;for(Ue=0;Ue<Fe;Ue++){const Ke=G[Ue]=$e?ks(G[Ue]):To(G[Ue]);S(F[Ue],Ke,W,null,O,B,K,ye,$e)}we>Ne?Se(F,O,B,!0,!1,Fe):ne(G,W,j,O,B,K,ye,$e,Fe)},te=(F,G,W,j,O,B,K,ye,$e)=>{let we=0;const Ne=G.length;let Fe=F.length-1,Ue=Ne-1;for(;we<=Fe&&we<=Ue;){const Ke=F[we],se=G[we]=$e?ks(G[we]):To(G[we]);if(Ws(Ke,se))S(Ke,se,W,null,O,B,K,ye,$e);else break;we++}for(;we<=Fe&&we<=Ue;){const Ke=F[Fe],se=G[Ue]=$e?ks(G[Ue]):To(G[Ue]);if(Ws(Ke,se))S(Ke,se,W,null,O,B,K,ye,$e);else break;Fe--,Ue--}if(we>Fe){if(we<=Ue){const Ke=Ue+1,se=Ke<Ne?G[Ke].el:j;for(;we<=Ue;)S(null,G[we]=$e?ks(G[we]):To(G[we]),W,se,O,B,K,ye,$e),we++}}else if(we>Ue)for(;we<=Fe;)Oe(F[we],O,B,!0),we++;else{const Ke=we,se=we,ee=new Map;for(we=se;we<=Ue;we++){const gt=G[we]=$e?ks(G[we]):To(G[we]);gt.key!=null&&ee.set(gt.key,we)}let Z,Ve=0;const Ye=Ue-se+1;let Qe=!1,et=0;const pt=new Array(Ye);for(we=0;we<Ye;we++)pt[we]=0;for(we=Ke;we<=Fe;we++){const gt=F[we];if(Ve>=Ye){Oe(gt,O,B,!0);continue}let zt;if(gt.key!=null)zt=ee.get(gt.key);else for(Z=se;Z<=Ue;Z++)if(pt[Z-se]===0&&Ws(gt,G[Z])){zt=Z;break}zt===void 0?Oe(gt,O,B,!0):(pt[zt-se]=we+1,zt>=et?et=zt:Qe=!0,S(gt,G[zt],W,null,O,B,K,ye,$e),Ve++)}const Pt=Qe?eg(pt):xi;for(Z=Pt.length-1,we=Ye-1;we>=0;we--){const gt=se+we,zt=G[gt],kn=G[gt+1],fo=gt+1<Ne?kn.el||If(kn):j;pt[we]===0?S(null,zt,W,fo,O,B,K,ye,$e):Qe&&(Z<0||we!==Pt[Z]?ke(zt,W,fo,2):Z--)}}},ke=(F,G,W,j,O=null)=>{const{el:B,type:K,transition:ye,children:$e,shapeFlag:we}=F;if(we&6){ke(F.component.subTree,G,W,j);return}if(we&128){F.suspense.move(G,W,j);return}if(we&64){K.move(F,G,W,fe);return}if(K===Ce){i(B,G,W);for(let Fe=0;Fe<$e.length;Fe++)ke($e[Fe],G,W,j);i(F.anchor,G,W);return}if(K===$r){_(F,G,W);return}if(j!==2&&we&1&&ye)if(j===0)ye.beforeEnter(B),i(B,G,W),gn(()=>ye.enter(B),O);else{const{leave:Fe,delayLeave:Ue,afterLeave:Ke}=ye,se=()=>{F.ctx.isUnmounted?s(B):i(B,G,W)},ee=()=>{B._isLeaving&&B[Vo](!0),Fe(B,()=>{se(),Ke&&Ke()})};Ue?Ue(B,se,ee):ee()}else i(B,G,W)},Oe=(F,G,W,j=!1,O=!1)=>{const{type:B,props:K,ref:ye,children:$e,dynamicChildren:we,shapeFlag:Ne,patchFlag:Fe,dirs:Ue,cacheIndex:Ke}=F;if(Fe===-2&&(O=!1),ye!=null&&(Qo(),ka(ye,null,W,F,!0),es()),Ke!=null&&(G.renderCache[Ke]=void 0),Ne&256){G.ctx.deactivate(F);return}const se=Ne&1&&Ue,ee=!$i(F);let Z;if(ee&&(Z=K&&K.onVnodeBeforeUnmount)&&Lo(Z,G,F),Ne&6)be(F.component,W,j);else{if(Ne&128){F.suspense.unmount(W,j);return}se&&Hs(F,null,G,"beforeUnmount"),Ne&64?F.type.remove(F,G,W,fe,j):we&&!we.hasOnce&&(B!==Ce||Fe>0&&Fe&64)?Se(we,G,W,!1,!0):(B===Ce&&Fe&384||!O&&Ne&16)&&Se($e,G,W),j&&oe(F)}(ee&&(Z=K&&K.onVnodeUnmounted)||se)&&gn(()=>{Z&&Lo(Z,G,F),se&&Hs(F,null,G,"unmounted")},W)},oe=F=>{const{type:G,el:W,anchor:j,transition:O}=F;if(G===Ce){Ee(W,j);return}if(G===$r){$(F);return}const B=()=>{s(W),O&&!O.persisted&&O.afterLeave&&O.afterLeave()};if(F.shapeFlag&1&&O&&!O.persisted){const{leave:K,delayLeave:ye}=O,$e=()=>K(W,B);ye?ye(F.el,B,$e):$e()}else B()},Ee=(F,G)=>{let W;for(;F!==G;)W=x(F),s(F),F=W;s(G)},be=(F,G,W)=>{const{bum:j,scope:O,job:B,subTree:K,um:ye,m:$e,a:we}=F;td($e),td(we),j&&xr(j),O.stop(),B&&(B.flags|=8,Oe(K,F,G,W)),ye&&gn(ye,G),gn(()=>{F.isUnmounted=!0},G)},Se=(F,G,W,j=!1,O=!1,B=0)=>{for(let K=B;K<F.length;K++)Oe(F[K],G,W,j,O)},le=F=>{if(F.shapeFlag&6)return le(F.component.subTree);if(F.shapeFlag&128)return F.suspense.next();const G=x(F.anchor||F.el),W=G&&G[ef];return W?x(W):G};let pe=!1;const q=(F,G,W)=>{let j;F==null?G._vnode&&(Oe(G._vnode,null,null,!0),j=G._vnode.component):S(G._vnode||null,F,G,null,null,null,W),G._vnode=F,pe||(pe=!0,zu(j),Kh(),pe=!1)},fe={p:S,um:Oe,m:ke,r:oe,mt:Re,mc:ne,pc:J,pbc:_e,n:le,o:e};return{render:q,hydrate:void 0,createApp:Bm(q)}}function Wl({type:e,props:t},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:o}function Vs({effect:e,job:t},o){o?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Qm(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function Qc(e,t,o=!1){const i=e.children,s=t.children;if(tt(i)&&tt(s))for(let a=0;a<i.length;a++){const l=i[a];let u=s[a];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=s[a]=ks(s[a]),u.el=l.el),!o&&u.patchFlag!==-2&&Qc(l,u)),u.type===cl&&(u.patchFlag!==-1?u.el=l.el:u.__elIndex=a+(e.type===Ce?1:0)),u.type===rn&&!u.el&&(u.el=l.el)}}function eg(e){const t=e.slice(),o=[0];let i,s,a,l,u;const h=e.length;for(i=0;i<h;i++){const p=e[i];if(p!==0){if(s=o[o.length-1],e[s]<p){t[i]=s,o.push(i);continue}for(a=0,l=o.length-1;a<l;)u=a+l>>1,e[o[u]]<p?a=u+1:l=u;p<e[o[a]]&&(a>0&&(t[i]=o[a-1]),o[a]=i)}}for(a=o.length,l=o[a-1];a-- >0;)o[a]=l,l=t[l];return o}function Tf(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Tf(t)}function td(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function If(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?If(t.subTree):null}const $f=e=>e.__isSuspense;function tg(e,t){t&&t.pendingBranch?tt(e)?t.effects.push(...e):t.effects.push(e):rm(e)}const Ce=Symbol.for("v-fgt"),cl=Symbol.for("v-txt"),rn=Symbol.for("v-cmt"),$r=Symbol.for("v-stc"),wa=[];let Rn=null;function m(e=!1){wa.push(Rn=e?null:[])}function ng(){wa.pop(),Rn=wa[wa.length-1]||null}let $a=1;function Hr(e,t=!1){$a+=e,e<0&&Rn&&t&&(Rn.hasOnce=!0)}function Mf(e){return e.dynamicChildren=$a>0?Rn||xi:null,ng(),$a>0&&Rn&&Rn.push(e),e}function g(e,t,o,i,s,a){return Mf(c(e,t,o,i,s,a,!0))}function rt(e,t,o,i,s){return Mf(ze(e,t,o,i,s,!0))}function Ma(e){return e?e.__v_isVNode===!0:!1}function Ws(e,t){return e.type===t.type&&e.key===t.key}const Af=({key:e})=>e??null,Mr=({ref:e,ref_key:t,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?Rt(e)||Ot(e)||ct(e)?{i:en,r:e,k:t,f:!!o}:e:null);function c(e,t=null,o=null,i=0,s=null,a=e===Ce?0:1,l=!1,u=!1){const h={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Af(t),ref:t&&Mr(t),scopeId:Jh,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:en};return u?(eu(h,o),a&128&&e.normalize(h)):o&&(h.shapeFlag|=Rt(o)?8:16),$a>0&&!l&&Rn&&(h.patchFlag>0||a&6)&&h.patchFlag!==32&&Rn.push(h),h}const ze=og;function og(e,t=null,o=null,i=0,s=null,a=!1){if((!e||e===Im)&&(e=rn),Ma(e)){const u=Ts(e,t,!0);return o&&eu(u,o),$a>0&&!a&&Rn&&(u.shapeFlag&6?Rn[Rn.indexOf(e)]=u:Rn.push(u)),u.patchFlag=-2,u}if(fg(e)&&(e=e.__vccOpts),t){t=sg(t);let{class:u,style:h}=t;u&&!Rt(u)&&(t.class=Te(u)),St(h)&&(ol(h)&&!tt(h)&&(h=Xt({},h)),t.style=at(h))}const l=Rt(e)?1:$f(e)?128:tf(e)?64:St(e)?4:ct(e)?2:0;return c(e,t,o,i,s,l,a,!0)}function sg(e){return e?ol(e)||bf(e)?Xt({},e):e:null}function Ts(e,t,o=!1,i=!1){const{props:s,ref:a,patchFlag:l,children:u,transition:h}=e,p=t?Pf(s||{},t):s,f={__v_isVNode:!0,__v_skip:!0,type:e.type,props:p,key:p&&Af(p),ref:t&&t.ref?o&&a?tt(a)?a.concat(Mr(t)):[a,Mr(t)]:Mr(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Ce?l===-1?16:l|16:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:h,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ts(e.ssContent),ssFallback:e.ssFallback&&Ts(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return h&&i&&Ia(f,h.clone(f)),f}function Ze(e=" ",t=0){return ze(cl,null,e,t)}function Ef(e,t){const o=ze($r,null,e);return o.staticCount=t,o}function N(e="",t=!1){return t?(m(),rt(rn,null,e)):ze(rn,null,e)}function To(e){return e==null||typeof e=="boolean"?ze(rn):tt(e)?ze(Ce,null,e.slice()):Ma(e)?ks(e):ze(cl,null,String(e))}function ks(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Ts(e)}function eu(e,t){let o=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(tt(t))o=16;else if(typeof t=="object")if(i&65){const s=t.default;s&&(s._c&&(s._d=!1),eu(e,s()),s._c&&(s._d=!0));return}else{o=32;const s=t._;!s&&!bf(t)?t._ctx=en:s===3&&en&&(en.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else ct(t)?(t={default:t,_ctx:en},o=32):(t=String(t),i&64?(o=16,t=[Ze(t)]):o=8);e.children=t,e.shapeFlag|=o}function Pf(...e){const t={};for(let o=0;o<e.length;o++){const i=e[o];for(const s in i)if(s==="class")t.class!==i.class&&(t.class=Te([t.class,i.class]));else if(s==="style")t.style=at([t.style,i.style]);else if(Yr(s)){const a=t[s],l=i[s];l&&a!==l&&!(tt(a)&&a.includes(l))&&(t[s]=a?[].concat(a,l):l)}else s!==""&&(t[s]=i[s])}return t}function Lo(e,t,o,i=null){co(e,t,7,[o,i])}const ig=gf();let ag=0;function rg(e,t,o){const i=e.type,s=(t?t.appContext:e.appContext)||ig,a={uid:ag++,vnode:e,type:i,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Th(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Cf(i,s),emitsOptions:yf(i,s),emit:null,emitted:null,propsDefaults:xt,inheritAttrs:i.inheritAttrs,ctx:xt,data:xt,props:xt,attrs:xt,slots:xt,refs:xt,setupState:xt,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=Fm.bind(null,a),e.ce&&e.ce(a),a}let ln=null;const tu=()=>ln||en;let Vr,_c;{const e=tl(),t=(o,i)=>{let s;return(s=e[o])||(s=e[o]=[]),s.push(i),a=>{s.length>1?s.forEach(l=>l(a)):s[0](a)}};Vr=t("__VUE_INSTANCE_SETTERS__",o=>ln=o),_c=t("__VUE_SSR_SETTERS__",o=>Aa=o)}const Fa=e=>{const t=ln;return Vr(e),e.scope.on(),()=>{e.scope.off(),Vr(t)}},nd=()=>{ln&&ln.scope.off(),Vr(null)};function Df(e){return e.vnode.shapeFlag&4}let Aa=!1;function lg(e,t=!1,o=!1){t&&_c(t);const{props:i,children:s}=e.vnode,a=Df(e);Zm(e,i,a,t),Km(e,s,o||t);const l=a?cg(e,t):void 0;return t&&_c(!1),l}function cg(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Mm);const{setup:i}=o;if(i){Qo();const s=e.setupContext=i.length>1?dg(e):null,a=Fa(e),l=Na(i,e,0,[e.props,s]),u=kh(l);if(es(),a(),(u||e.sp)&&!$i(e)&&df(e),u){if(l.then(nd,nd),t)return l.then(h=>{od(e,h)}).catch(h=>{sl(h,e,0)});e.asyncDep=l}else od(e,l)}else Of(e)}function od(e,t,o){ct(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:St(t)&&(e.setupState=jh(t)),Of(e)}function Of(e,t,o){const i=e.type;e.render||(e.render=i.render||Mo);{const s=Fa(e);Qo();try{Am(e)}finally{es(),s()}}}const ug={get(e,t){return an(e,"get",""),e[t]}};function dg(e){const t=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,ug),slots:e.slots,emit:e.emit,expose:t}}function ul(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(jh(Kc(e.exposed)),{get(t,o){if(o in t)return t[o];if(o in ba)return ba[o](e)},has(t,o){return o in t||o in ba}})):e.proxy}function hg(e,t=!0){return ct(e)?e.displayName||e.name:e.name||t&&e.__name}function fg(e){return ct(e)&&"__vccOpts"in e}const X=(e,t)=>nm(e,t,Aa);function nu(e,t,o){try{Hr(-1);const i=arguments.length;return i===2?St(t)&&!tt(t)?Ma(t)?ze(e,null,[t]):ze(e,t):ze(e,null,t):(i>3?o=Array.prototype.slice.call(arguments,2):i===3&&Ma(o)&&(o=[o]),ze(e,t,o))}finally{Hr(1)}}const pg="3.5.26";let kc;const sd=typeof window<"u"&&window.trustedTypes;if(sd)try{kc=sd.createPolicy("vue",{createHTML:e=>e})}catch{}const Rf=kc?e=>kc.createHTML(e):e=>e,vg="http://www.w3.org/2000/svg",mg="http://www.w3.org/1998/Math/MathML",Ho=typeof document<"u"?document:null,id=Ho&&Ho.createElement("template"),gg={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,i)=>{const s=t==="svg"?Ho.createElementNS(vg,e):t==="mathml"?Ho.createElementNS(mg,e):o?Ho.createElement(e,{is:o}):Ho.createElement(e);return e==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:e=>Ho.createTextNode(e),createComment:e=>Ho.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Ho.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,o,i,s,a){const l=o?o.previousSibling:t.lastChild;if(s&&(s===a||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),o),!(s===a||!(s=s.nextSibling)););else{id.innerHTML=Rf(i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e);const u=id.content;if(i==="svg"||i==="mathml"){const h=u.firstChild;for(;h.firstChild;)u.appendChild(h.firstChild);u.removeChild(h)}t.insertBefore(u,o)}return[l?l.nextSibling:t.firstChild,o?o.previousSibling:t.lastChild]}},vs="transition",ra="animation",Ea=Symbol("_vtc"),Bf={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},yg=Xt({},sf,Bf),_g=e=>(e.displayName="Transition",e.props=yg,e),ql=_g((e,{slots:t})=>nu(mm,kg(e),t)),Gs=(e,t=[])=>{tt(e)?e.forEach(o=>o(...t)):e&&e(...t)},ad=e=>e?tt(e)?e.some(t=>t.length>1):e.length>1:!1;function kg(e){const t={};for(const ve in e)ve in Bf||(t[ve]=e[ve]);if(e.css===!1)return t;const{name:o="v",type:i,duration:s,enterFromClass:a=`${o}-enter-from`,enterActiveClass:l=`${o}-enter-active`,enterToClass:u=`${o}-enter-to`,appearFromClass:h=a,appearActiveClass:p=l,appearToClass:f=u,leaveFromClass:y=`${o}-leave-from`,leaveActiveClass:x=`${o}-leave-active`,leaveToClass:T=`${o}-leave-to`}=e,I=bg(s),S=I&&I[0],R=I&&I[1],{onBeforeEnter:E,onEnter:M,onEnterCancelled:_,onLeave:$,onLeaveCancelled:k,onBeforeAppear:w=E,onAppear:A=M,onAppearCancelled:ne=_}=t,ae=(ve,Ie,Re,xe)=>{ve._enterCancelled=xe,Zs(ve,Ie?f:u),Zs(ve,Ie?p:l),Re&&Re()},_e=(ve,Ie)=>{ve._isLeaving=!1,Zs(ve,y),Zs(ve,T),Zs(ve,x),Ie&&Ie()},re=ve=>(Ie,Re)=>{const xe=ve?A:M,he=()=>ae(Ie,ve,Re);Gs(xe,[Ie,he]),rd(()=>{Zs(Ie,ve?h:a),Uo(Ie,ve?f:u),ad(xe)||ld(Ie,i,S,he)})};return Xt(t,{onBeforeEnter(ve){Gs(E,[ve]),Uo(ve,a),Uo(ve,l)},onBeforeAppear(ve){Gs(w,[ve]),Uo(ve,h),Uo(ve,p)},onEnter:re(!1),onAppear:re(!0),onLeave(ve,Ie){ve._isLeaving=!0;const Re=()=>_e(ve,Ie);Uo(ve,y),ve._enterCancelled?(Uo(ve,x),dd(ve)):(dd(ve),Uo(ve,x)),rd(()=>{ve._isLeaving&&(Zs(ve,y),Uo(ve,T),ad($)||ld(ve,i,R,Re))}),Gs($,[ve,Re])},onEnterCancelled(ve){ae(ve,!1,void 0,!0),Gs(_,[ve])},onAppearCancelled(ve){ae(ve,!0,void 0,!0),Gs(ne,[ve])},onLeaveCancelled(ve){_e(ve),Gs(k,[ve])}})}function bg(e){if(e==null)return null;if(St(e))return[Kl(e.enter),Kl(e.leave)];{const t=Kl(e);return[t,t]}}function Kl(e){return bv(e)}function Uo(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e[Ea]||(e[Ea]=new Set)).add(t)}function Zs(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const o=e[Ea];o&&(o.delete(t),o.size||(e[Ea]=void 0))}function rd(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let wg=0;function ld(e,t,o,i){const s=e._endId=++wg,a=()=>{s===e._endId&&i()};if(o!=null)return setTimeout(a,o);const{type:l,timeout:u,propCount:h}=Cg(e,t);if(!l)return i();const p=l+"end";let f=0;const y=()=>{e.removeEventListener(p,x),a()},x=T=>{T.target===e&&++f>=h&&y()};setTimeout(()=>{f<h&&y()},u+1),e.addEventListener(p,x)}function Cg(e,t){const o=window.getComputedStyle(e),i=I=>(o[I]||"").split(", "),s=i(`${vs}Delay`),a=i(`${vs}Duration`),l=cd(s,a),u=i(`${ra}Delay`),h=i(`${ra}Duration`),p=cd(u,h);let f=null,y=0,x=0;t===vs?l>0&&(f=vs,y=l,x=a.length):t===ra?p>0&&(f=ra,y=p,x=h.length):(y=Math.max(l,p),f=y>0?l>p?vs:ra:null,x=f?f===vs?a.length:h.length:0);const T=f===vs&&/\b(?:transform|all)(?:,|$)/.test(i(`${vs}Property`).toString());return{type:f,timeout:y,propCount:x,hasTransform:T}}function cd(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((o,i)=>ud(o)+ud(e[i])))}function ud(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function dd(e){return(e?e.ownerDocument:document).body.offsetHeight}function Lg(e,t,o){const i=e[Ea];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}const Gr=Symbol("_vod"),Nf=Symbol("_vsh"),Is={name:"show",beforeMount(e,{value:t},{transition:o}){e[Gr]=e.style.display==="none"?"":e.style.display,o&&t?o.beforeEnter(e):la(e,t)},mounted(e,{value:t},{transition:o}){o&&t&&o.enter(e)},updated(e,{value:t,oldValue:o},{transition:i}){!t!=!o&&(i?t?(i.beforeEnter(e),la(e,!0),i.enter(e)):i.leave(e,()=>{la(e,!1)}):la(e,t))},beforeUnmount(e,{value:t}){la(e,t)}};function la(e,t){e.style.display=t?e[Gr]:"none",e[Nf]=!t}const Sg=Symbol(""),xg=/(?:^|;)\s*display\s*:/;function Tg(e,t,o){const i=e.style,s=Rt(o);let a=!1;if(o&&!s){if(t)if(Rt(t))for(const l of t.split(";")){const u=l.slice(0,l.indexOf(":")).trim();o[u]==null&&Ar(i,u,"")}else for(const l in t)o[l]==null&&Ar(i,l,"");for(const l in o)l==="display"&&(a=!0),Ar(i,l,o[l])}else if(s){if(t!==o){const l=i[Sg];l&&(o+=";"+l),i.cssText=o,a=xg.test(o)}}else t&&e.removeAttribute("style");Gr in e&&(e[Gr]=a?i.display:"",e[Nf]&&(i.display="none"))}const hd=/\s*!important$/;function Ar(e,t,o){if(tt(o))o.forEach(i=>Ar(e,t,i));else if(o==null&&(o=""),t.startsWith("--"))e.setProperty(t,o);else{const i=Ig(e,t);hd.test(o)?e.setProperty(Ms(i),o.replace(hd,""),"important"):e[i]=o}}const fd=["Webkit","Moz","ms"],Yl={};function Ig(e,t){const o=Yl[t];if(o)return o;let i=Kn(t);if(i!=="filter"&&i in e)return Yl[t]=i;i=Qr(i);for(let s=0;s<fd.length;s++){const a=fd[s]+i;if(a in e)return Yl[t]=a}return t}const pd="http://www.w3.org/1999/xlink";function vd(e,t,o,i,s,a=Tv(t)){i&&t.startsWith("xlink:")?o==null?e.removeAttributeNS(pd,t.slice(6,t.length)):e.setAttributeNS(pd,t,o):o==null||a&&!Lh(o)?e.removeAttribute(t):e.setAttribute(t,a?"":ro(o)?String(o):o)}function md(e,t,o,i,s){if(t==="innerHTML"||t==="textContent"){o!=null&&(e[t]=t==="innerHTML"?Rf(o):o);return}const a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){const u=a==="OPTION"?e.getAttribute("value")||"":e.value,h=o==null?e.type==="checkbox"?"on":"":String(o);(u!==h||!("_value"in e))&&(e.value=h),o==null&&e.removeAttribute(t),e._value=o;return}let l=!1;if(o===""||o==null){const u=typeof e[t];u==="boolean"?o=Lh(o):o==null&&u==="string"?(o="",l=!0):u==="number"&&(o=0,l=!0)}try{e[t]=o}catch{}l&&e.removeAttribute(s||t)}function Wo(e,t,o,i){e.addEventListener(t,o,i)}function $g(e,t,o,i){e.removeEventListener(t,o,i)}const gd=Symbol("_vei");function Mg(e,t,o,i,s=null){const a=e[gd]||(e[gd]={}),l=a[t];if(i&&l)l.value=i;else{const[u,h]=Ag(t);if(i){const p=a[t]=Dg(i,s);Wo(e,u,p,h)}else l&&($g(e,u,l,h),a[t]=void 0)}}const yd=/(?:Once|Passive|Capture)$/;function Ag(e){let t;if(yd.test(e)){t={};let i;for(;i=e.match(yd);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Ms(e.slice(2)),t]}let Jl=0;const Eg=Promise.resolve(),Pg=()=>Jl||(Eg.then(()=>Jl=0),Jl=Date.now());function Dg(e,t){const o=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=o.attached)return;co(Og(i,o.value),t,5,[i])};return o.value=e,o.attached=Pg(),o}function Og(e,t){if(tt(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map(i=>s=>!s._stopped&&i&&i(s))}else return t}const _d=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Rg=(e,t,o,i,s,a)=>{const l=s==="svg";t==="class"?Lg(e,i,l):t==="style"?Tg(e,o,i):Yr(t)?Uc(t)||Mg(e,t,o,i,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Bg(e,t,i,l))?(md(e,t,i),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&vd(e,t,i,l,a,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Rt(i))?md(e,Kn(t),i,a,t):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),vd(e,t,i,l))};function Bg(e,t,o,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&_d(t)&&ct(o));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return _d(t)&&Rt(o)?!1:t in e}const $s=e=>{const t=e.props["onUpdate:modelValue"]||!1;return tt(t)?o=>xr(t,o):t};function Ng(e){e.target.composing=!0}function kd(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const qn=Symbol("_assign");function bd(e,t,o){return t&&(e=e.trim()),o&&(e=el(e)),e}const ut={created(e,{modifiers:{lazy:t,trim:o,number:i}},s){e[qn]=$s(s);const a=i||s.props&&s.props.type==="number";Wo(e,t?"change":"input",l=>{l.target.composing||e[qn](bd(e.value,o,a))}),(o||a)&&Wo(e,"change",()=>{e.value=bd(e.value,o,a)}),t||(Wo(e,"compositionstart",Ng),Wo(e,"compositionend",kd),Wo(e,"change",kd))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:o,modifiers:{lazy:i,trim:s,number:a}},l){if(e[qn]=$s(l),e.composing)return;const u=(a||e.type==="number")&&!/^0\d/.test(e.value)?el(e.value):e.value,h=t??"";u!==h&&(document.activeElement===e&&e.type!=="range"&&(i&&t===o||s&&e.value.trim()===h)||(e.value=h))}},ws={deep:!0,created(e,t,o){e[qn]=$s(o),Wo(e,"change",()=>{const i=e._modelValue,s=Ei(e),a=e.checked,l=e[qn];if(tt(i)){const u=Hc(i,s),h=u!==-1;if(a&&!h)l(i.concat(s));else if(!a&&h){const p=[...i];p.splice(u,1),l(p)}}else if(Ri(i)){const u=new Set(i);a?u.add(s):u.delete(s),l(u)}else l(Ff(e,a))})},mounted:wd,beforeUpdate(e,t,o){e[qn]=$s(o),wd(e,t,o)}};function wd(e,{value:t,oldValue:o},i){e._modelValue=t;let s;if(tt(t))s=Hc(t,i.props.value)>-1;else if(Ri(t))s=t.has(i.props.value);else{if(t===o)return;s=ii(t,Ff(e,!0))}e.checked!==s&&(e.checked=s)}const Cd={created(e,{value:t},o){e.checked=ii(t,o.props.value),e[qn]=$s(o),Wo(e,"change",()=>{e[qn](Ei(e))})},beforeUpdate(e,{value:t,oldValue:o},i){e[qn]=$s(i),t!==o&&(e.checked=ii(t,i.props.value))}},Sn={deep:!0,created(e,{value:t,modifiers:{number:o}},i){const s=Ri(t);Wo(e,"change",()=>{const a=Array.prototype.filter.call(e.options,l=>l.selected).map(l=>o?el(Ei(l)):Ei(l));e[qn](e.multiple?s?new Set(a):a:a[0]),e._assigning=!0,Xo(()=>{e._assigning=!1})}),e[qn]=$s(i)},mounted(e,{value:t}){Ld(e,t)},beforeUpdate(e,t,o){e[qn]=$s(o)},updated(e,{value:t}){e._assigning||Ld(e,t)}};function Ld(e,t){const o=e.multiple,i=tt(t);if(!(o&&!i&&!Ri(t))){for(let s=0,a=e.options.length;s<a;s++){const l=e.options[s],u=Ei(l);if(o)if(i){const h=typeof u;h==="string"||h==="number"?l.selected=t.some(p=>String(p)===String(u)):l.selected=Hc(t,u)>-1}else l.selected=t.has(u);else if(ii(Ei(l),t)){e.selectedIndex!==s&&(e.selectedIndex=s);return}}!o&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Ei(e){return"_value"in e?e._value:e.value}function Ff(e,t){const o=t?"_trueValue":"_falseValue";return o in e?e[o]:t}const Fg=["ctrl","shift","alt","meta"],Ug={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Fg.some(o=>e[`${o}Key`]&&!t.includes(o))},vt=(e,t)=>{const o=e._withMods||(e._withMods={}),i=t.join(".");return o[i]||(o[i]=((s,...a)=>{for(let l=0;l<t.length;l++){const u=Ug[t[l]];if(u&&u(s,t))return}return e(s,...a)}))},zg={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Uf=(e,t)=>{const o=e._withKeys||(e._withKeys={}),i=t.join(".");return o[i]||(o[i]=(s=>{if(!("key"in s))return;const a=Ms(s.key);if(t.some(l=>l===a||zg[l]===a))return e(s)}))},Hg=Xt({patchProp:Rg},gg);let Sd;function Vg(){return Sd||(Sd=Jm(Hg))}const Gg=((...e)=>{const t=Vg().createApp(...e),{mount:o}=t;return t.mount=i=>{const s=jg(i);if(!s)return;const a=t._component;!ct(a)&&!a.render&&!a.template&&(a.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const l=o(s,!1,Zg(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),l},t});function Zg(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function jg(e){return Rt(e)?document.querySelector(e):e}let zf;const dl=e=>zf=e,Hf=Symbol();function bc(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Ca;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Ca||(Ca={}));function Wg(){const e=Ih(!0),t=e.run(()=>D({}));let o=[],i=[];const s=Kc({install(a){dl(s),s._a=a,a.provide(Hf,s),a.config.globalProperties.$pinia=s,i.forEach(l=>o.push(l)),i=[]},use(a){return this._a?o.push(a):i.push(a),this},_p:o,_a:null,_e:e,_s:new Map,state:t});return s}const Vf=()=>{};function xd(e,t,o,i=Vf){e.add(t);const s=()=>{e.delete(t)&&i()};return!o&&$h()&&$v(s),s}function ki(e,...t){e.forEach(o=>{o(...t)})}const qg=e=>e(),Td=Symbol(),Xl=Symbol();function wc(e,t){e instanceof Map&&t instanceof Map?t.forEach((o,i)=>e.set(i,o)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const o in t){if(!t.hasOwnProperty(o))continue;const i=t[o],s=e[o];bc(s)&&bc(i)&&e.hasOwnProperty(o)&&!Ot(i)&&!Jo(i)?e[o]=wc(s,i):e[o]=i}return e}const Kg=Symbol();function Yg(e){return!bc(e)||!Object.prototype.hasOwnProperty.call(e,Kg)}const{assign:gs}=Object;function Jg(e){return!!(Ot(e)&&e.effect)}function Xg(e,t,o,i){const{state:s,actions:a,getters:l}=t,u=o.state.value[e];let h;function p(){u||(o.state.value[e]=s?s():{});const f=Xv(o.state.value[e]);return gs(f,a,Object.keys(l||{}).reduce((y,x)=>(y[x]=Kc(X(()=>{dl(o);const T=o._s.get(e);return l[x].call(T,T)})),y),{}))}return h=Gf(e,p,t,o,i,!0),h}function Gf(e,t,o={},i,s,a){let l;const u=gs({actions:{}},o),h={deep:!0};let p,f,y=new Set,x=new Set,T;const I=i.state.value[e];!a&&!I&&(i.state.value[e]={}),D({});let S;function R(ne){let ae;p=f=!1,typeof ne=="function"?(ne(i.state.value[e]),ae={type:Ca.patchFunction,storeId:e,events:T}):(wc(i.state.value[e],ne),ae={type:Ca.patchObject,payload:ne,storeId:e,events:T});const _e=S=Symbol();Xo().then(()=>{S===_e&&(p=!0)}),f=!0,ki(y,ae,i.state.value[e])}const E=a?function(){const{state:ae}=o,_e=ae?ae():{};this.$patch(re=>{gs(re,_e)})}:Vf;function M(){l.stop(),y.clear(),x.clear(),i._s.delete(e)}const _=(ne,ae="")=>{if(Td in ne)return ne[Xl]=ae,ne;const _e=function(){dl(i);const re=Array.from(arguments),ve=new Set,Ie=new Set;function Re(Q){ve.add(Q)}function xe(Q){Ie.add(Q)}ki(x,{args:re,name:_e[Xl],store:k,after:Re,onError:xe});let he;try{he=ne.apply(this&&this.$id===e?this:k,re)}catch(Q){throw ki(Ie,Q),Q}return he instanceof Promise?he.then(Q=>(ki(ve,Q),Q)).catch(Q=>(ki(Ie,Q),Promise.reject(Q))):(ki(ve,he),he)};return _e[Td]=!0,_e[Xl]=ae,_e},$={_p:i,$id:e,$onAction:xd.bind(null,x),$patch:R,$reset:E,$subscribe(ne,ae={}){const _e=xd(y,ne,ae.detached,()=>re()),re=l.run(()=>We(()=>i.state.value[e],ve=>{(ae.flush==="sync"?f:p)&&ne({storeId:e,type:Ca.direct,events:T},ve)},gs({},h,ae)));return _e},$dispose:M},k=Ba($);i._s.set(e,k);const A=(i._a&&i._a.runWithContext||qg)(()=>i._e.run(()=>(l=Ih()).run(()=>t({action:_}))));for(const ne in A){const ae=A[ne];if(Ot(ae)&&!Jg(ae)||Jo(ae))a||(I&&Yg(ae)&&(Ot(ae)?ae.value=I[ne]:wc(ae,I[ne])),i.state.value[e][ne]=ae);else if(typeof ae=="function"){const _e=_(ae,ne);A[ne]=_e,u.actions[ne]=ae}}return gs(k,A),gs(_t(k),A),Object.defineProperty(k,"$state",{get:()=>i.state.value[e],set:ne=>{R(ae=>{gs(ae,ne)})}}),i._p.forEach(ne=>{gs(k,l.run(()=>ne({store:k,app:i._a,pinia:i,options:u})))}),I&&a&&o.hydrate&&o.hydrate(k.$state,I),p=!0,f=!0,k}function ou(e,t,o){let i;const s=typeof t=="function";i=s?o:t;function a(l,u){const h=lm();return l=l||(h?Wn(Hf,null):null),l&&dl(l),l=zf,l._s.has(e)||(s?Gf(e,t,i,l):Xg(e,i,l)),l._s.get(e)}return a.$id=e,a}const Je=(e,t)=>{const o=e.__vccOpts||e;for(const[i,s]of t)o[i]=s;return o},Qg={},ey={id:"app"};function ty(e,t){const o=rl("router-view");return m(),g("div",ey,[ze(o)])}const ny=Je(Qg,[["render",ty]]);const wi=typeof document<"u";function Zf(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function oy(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&Zf(e.default)}const bt=Object.assign;function Ql(e,t){const o={};for(const i in t){const s=t[i];o[i]=uo(s)?s.map(e):e(s)}return o}const La=()=>{},uo=Array.isArray;function Id(e,t){const o={};for(const i in e)o[i]=i in t?t[i]:e[i];return o}const jf=/#/g,sy=/&/g,iy=/\//g,ay=/=/g,ry=/\?/g,Wf=/\+/g,ly=/%5B/g,cy=/%5D/g,qf=/%5E/g,uy=/%60/g,Kf=/%7B/g,dy=/%7C/g,Yf=/%7D/g,hy=/%20/g;function su(e){return e==null?"":encodeURI(""+e).replace(dy,"|").replace(ly,"[").replace(cy,"]")}function fy(e){return su(e).replace(Kf,"{").replace(Yf,"}").replace(qf,"^")}function Cc(e){return su(e).replace(Wf,"%2B").replace(hy,"+").replace(jf,"%23").replace(sy,"%26").replace(uy,"`").replace(Kf,"{").replace(Yf,"}").replace(qf,"^")}function py(e){return Cc(e).replace(ay,"%3D")}function vy(e){return su(e).replace(jf,"%23").replace(ry,"%3F")}function my(e){return vy(e).replace(iy,"%2F")}function Pa(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const gy=/\/$/,yy=e=>e.replace(gy,"");function ec(e,t,o="/"){let i,s={},a="",l="";const u=t.indexOf("#");let h=t.indexOf("?");return h=u>=0&&h>u?-1:h,h>=0&&(i=t.slice(0,h),a=t.slice(h,u>0?u:t.length),s=e(a.slice(1))),u>=0&&(i=i||t.slice(0,u),l=t.slice(u,t.length)),i=wy(i??t,o),{fullPath:i+a+l,path:i,query:s,hash:Pa(l)}}function _y(e,t){const o=t.query?e(t.query):"";return t.path+(o&&"?")+o+(t.hash||"")}function $d(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function ky(e,t,o){const i=t.matched.length-1,s=o.matched.length-1;return i>-1&&i===s&&Pi(t.matched[i],o.matched[s])&&Jf(t.params,o.params)&&e(t.query)===e(o.query)&&t.hash===o.hash}function Pi(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Jf(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var o in e)if(!by(e[o],t[o]))return!1;return!0}function by(e,t){return uo(e)?Md(e,t):uo(t)?Md(t,e):e?.valueOf()===t?.valueOf()}function Md(e,t){return uo(t)?e.length===t.length&&e.every((o,i)=>o===t[i]):e.length===1&&e[0]===t}function wy(e,t){if(e.startsWith("/"))return e;if(!e)return t;const o=t.split("/"),i=e.split("/"),s=i[i.length-1];(s===".."||s===".")&&i.push("");let a=o.length-1,l,u;for(l=0;l<i.length;l++)if(u=i[l],u!==".")if(u==="..")a>1&&a--;else break;return o.slice(0,a).join("/")+"/"+i.slice(l).join("/")}const ms={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let Lc=(function(e){return e.pop="pop",e.push="push",e})({}),tc=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function Cy(e){if(!e)if(wi){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),yy(e)}const Ly=/^[^#]+#/;function Sy(e,t){return e.replace(Ly,"#")+t}function xy(e,t){const o=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-o.left-(t.left||0),top:i.top-o.top-(t.top||0)}}const hl=()=>({left:window.scrollX,top:window.scrollY});function Ty(e){let t;if("el"in e){const o=e.el,i=typeof o=="string"&&o.startsWith("#"),s=typeof o=="string"?i?document.getElementById(o.slice(1)):document.querySelector(o):o;if(!s)return;t=xy(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function Ad(e,t){return(history.state?history.state.position-t:-1)+e}const Sc=new Map;function Iy(e,t){Sc.set(e,t)}function $y(e){const t=Sc.get(e);return Sc.delete(e),t}function My(e){return typeof e=="string"||e&&typeof e=="object"}function Xf(e){return typeof e=="string"||typeof e=="symbol"}let Dt=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const Qf=Symbol("");Dt.MATCHER_NOT_FOUND+"",Dt.NAVIGATION_GUARD_REDIRECT+"",Dt.NAVIGATION_ABORTED+"",Dt.NAVIGATION_CANCELLED+"",Dt.NAVIGATION_DUPLICATED+"";function Di(e,t){return bt(new Error,{type:e,[Qf]:!0},t)}function zo(e,t){return e instanceof Error&&Qf in e&&(t==null||!!(e.type&t))}const Ay=["params","query","hash"];function Ey(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const o of Ay)o in e&&(t[o]=e[o]);return JSON.stringify(t,null,2)}function Py(e){const t={};if(e===""||e==="?")return t;const o=(e[0]==="?"?e.slice(1):e).split("&");for(let i=0;i<o.length;++i){const s=o[i].replace(Wf," "),a=s.indexOf("="),l=Pa(a<0?s:s.slice(0,a)),u=a<0?null:Pa(s.slice(a+1));if(l in t){let h=t[l];uo(h)||(h=t[l]=[h]),h.push(u)}else t[l]=u}return t}function Ed(e){let t="";for(let o in e){const i=e[o];if(o=py(o),i==null){i!==void 0&&(t+=(t.length?"&":"")+o);continue}(uo(i)?i.map(s=>s&&Cc(s)):[i&&Cc(i)]).forEach(s=>{s!==void 0&&(t+=(t.length?"&":"")+o,s!=null&&(t+="="+s))})}return t}function Dy(e){const t={};for(const o in e){const i=e[o];i!==void 0&&(t[o]=uo(i)?i.map(s=>s==null?null:""+s):i==null?i:""+i)}return t}const Oy=Symbol(""),Pd=Symbol(""),fl=Symbol(""),iu=Symbol(""),xc=Symbol("");function ca(){let e=[];function t(i){return e.push(i),()=>{const s=e.indexOf(i);s>-1&&e.splice(s,1)}}function o(){e=[]}return{add:t,list:()=>e.slice(),reset:o}}function bs(e,t,o,i,s,a=l=>l()){const l=i&&(i.enterCallbacks[s]=i.enterCallbacks[s]||[]);return()=>new Promise((u,h)=>{const p=x=>{x===!1?h(Di(Dt.NAVIGATION_ABORTED,{from:o,to:t})):x instanceof Error?h(x):My(x)?h(Di(Dt.NAVIGATION_GUARD_REDIRECT,{from:t,to:x})):(l&&i.enterCallbacks[s]===l&&typeof x=="function"&&l.push(x),u())},f=a(()=>e.call(i&&i.instances[s],t,o,p));let y=Promise.resolve(f);e.length<3&&(y=y.then(p)),y.catch(x=>h(x))})}function nc(e,t,o,i,s=a=>a()){const a=[];for(const l of e)for(const u in l.components){let h=l.components[u];if(!(t!=="beforeRouteEnter"&&!l.instances[u]))if(Zf(h)){const p=(h.__vccOpts||h)[t];p&&a.push(bs(p,o,i,l,u,s))}else{let p=h();a.push(()=>p.then(f=>{if(!f)throw new Error(`Couldn't resolve component "${u}" at "${l.path}"`);const y=oy(f)?f.default:f;l.mods[u]=f,l.components[u]=y;const x=(y.__vccOpts||y)[t];return x&&bs(x,o,i,l,u,s)()}))}}return a}function Ry(e,t){const o=[],i=[],s=[],a=Math.max(t.matched.length,e.matched.length);for(let l=0;l<a;l++){const u=t.matched[l];u&&(e.matched.find(p=>Pi(p,u))?i.push(u):o.push(u));const h=e.matched[l];h&&(t.matched.find(p=>Pi(p,h))||s.push(h))}return[o,i,s]}let By=()=>location.protocol+"//"+location.host;function ep(e,t){const{pathname:o,search:i,hash:s}=t,a=e.indexOf("#");if(a>-1){let l=s.includes(e.slice(a))?e.slice(a).length:1,u=s.slice(l);return u[0]!=="/"&&(u="/"+u),$d(u,"")}return $d(o,e)+i+s}function Ny(e,t,o,i){let s=[],a=[],l=null;const u=({state:x})=>{const T=ep(e,location),I=o.value,S=t.value;let R=0;if(x){if(o.value=T,t.value=x,l&&l===I){l=null;return}R=S?x.position-S.position:0}else i(T);s.forEach(E=>{E(o.value,I,{delta:R,type:Lc.pop,direction:R?R>0?tc.forward:tc.back:tc.unknown})})};function h(){l=o.value}function p(x){s.push(x);const T=()=>{const I=s.indexOf(x);I>-1&&s.splice(I,1)};return a.push(T),T}function f(){if(document.visibilityState==="hidden"){const{history:x}=window;if(!x.state)return;x.replaceState(bt({},x.state,{scroll:hl()}),"")}}function y(){for(const x of a)x();a=[],window.removeEventListener("popstate",u),window.removeEventListener("pagehide",f),document.removeEventListener("visibilitychange",f)}return window.addEventListener("popstate",u),window.addEventListener("pagehide",f),document.addEventListener("visibilitychange",f),{pauseListeners:h,listen:p,destroy:y}}function Dd(e,t,o,i=!1,s=!1){return{back:e,current:t,forward:o,replaced:i,position:window.history.length,scroll:s?hl():null}}function Fy(e){const{history:t,location:o}=window,i={value:ep(e,o)},s={value:t.state};s.value||a(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function a(h,p,f){const y=e.indexOf("#"),x=y>-1?(o.host&&document.querySelector("base")?e:e.slice(y))+h:By()+e+h;try{t[f?"replaceState":"pushState"](p,"",x),s.value=p}catch(T){console.error(T),o[f?"replace":"assign"](x)}}function l(h,p){a(h,bt({},t.state,Dd(s.value.back,h,s.value.forward,!0),p,{position:s.value.position}),!0),i.value=h}function u(h,p){const f=bt({},s.value,t.state,{forward:h,scroll:hl()});a(f.current,f,!0),a(h,bt({},Dd(i.value,h,null),{position:f.position+1},p),!1),i.value=h}return{location:i,state:s,push:u,replace:l}}function Uy(e){e=Cy(e);const t=Fy(e),o=Ny(e,t.state,t.location,t.replace);function i(a,l=!0){l||o.pauseListeners(),history.go(a)}const s=bt({location:"",base:e,go:i,createHref:Sy.bind(null,e)},t,o);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function zy(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),Uy(e)}let Js=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var jt=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(jt||{});const Hy={type:Js.Static,value:""},Vy=/[a-zA-Z0-9_]/;function Gy(e){if(!e)return[[]];if(e==="/")return[[Hy]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(T){throw new Error(`ERR (${o})/"${p}": ${T}`)}let o=jt.Static,i=o;const s=[];let a;function l(){a&&s.push(a),a=[]}let u=0,h,p="",f="";function y(){p&&(o===jt.Static?a.push({type:Js.Static,value:p}):o===jt.Param||o===jt.ParamRegExp||o===jt.ParamRegExpEnd?(a.length>1&&(h==="*"||h==="+")&&t(`A repeatable param (${p}) must be alone in its segment. eg: '/:ids+.`),a.push({type:Js.Param,value:p,regexp:f,repeatable:h==="*"||h==="+",optional:h==="*"||h==="?"})):t("Invalid state to consume buffer"),p="")}function x(){p+=h}for(;u<e.length;){if(h=e[u++],h==="\\"&&o!==jt.ParamRegExp){i=o,o=jt.EscapeNext;continue}switch(o){case jt.Static:h==="/"?(p&&y(),l()):h===":"?(y(),o=jt.Param):x();break;case jt.EscapeNext:x(),o=i;break;case jt.Param:h==="("?o=jt.ParamRegExp:Vy.test(h)?x():(y(),o=jt.Static,h!=="*"&&h!=="?"&&h!=="+"&&u--);break;case jt.ParamRegExp:h===")"?f[f.length-1]=="\\"?f=f.slice(0,-1)+h:o=jt.ParamRegExpEnd:f+=h;break;case jt.ParamRegExpEnd:y(),o=jt.Static,h!=="*"&&h!=="?"&&h!=="+"&&u--,f="";break;default:t("Unknown state");break}}return o===jt.ParamRegExp&&t(`Unfinished custom RegExp for param "${p}"`),y(),l(),s}const Od="[^/]+?",Zy={sensitive:!1,strict:!1,start:!0,end:!0};var yn=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(yn||{});const jy=/[.+*?^${}()[\]/\\]/g;function Wy(e,t){const o=bt({},Zy,t),i=[];let s=o.start?"^":"";const a=[];for(const p of e){const f=p.length?[]:[yn.Root];o.strict&&!p.length&&(s+="/");for(let y=0;y<p.length;y++){const x=p[y];let T=yn.Segment+(o.sensitive?yn.BonusCaseSensitive:0);if(x.type===Js.Static)y||(s+="/"),s+=x.value.replace(jy,"\\$&"),T+=yn.Static;else if(x.type===Js.Param){const{value:I,repeatable:S,optional:R,regexp:E}=x;a.push({name:I,repeatable:S,optional:R});const M=E||Od;if(M!==Od){T+=yn.BonusCustomRegExp;try{`${M}`}catch($){throw new Error(`Invalid custom RegExp for param "${I}" (${M}): `+$.message)}}let _=S?`((?:${M})(?:/(?:${M}))*)`:`(${M})`;y||(_=R&&p.length<2?`(?:/${_})`:"/"+_),R&&(_+="?"),s+=_,T+=yn.Dynamic,R&&(T+=yn.BonusOptional),S&&(T+=yn.BonusRepeatable),M===".*"&&(T+=yn.BonusWildcard)}f.push(T)}i.push(f)}if(o.strict&&o.end){const p=i.length-1;i[p][i[p].length-1]+=yn.BonusStrict}o.strict||(s+="/?"),o.end?s+="$":o.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const l=new RegExp(s,o.sensitive?"":"i");function u(p){const f=p.match(l),y={};if(!f)return null;for(let x=1;x<f.length;x++){const T=f[x]||"",I=a[x-1];y[I.name]=T&&I.repeatable?T.split("/"):T}return y}function h(p){let f="",y=!1;for(const x of e){(!y||!f.endsWith("/"))&&(f+="/"),y=!1;for(const T of x)if(T.type===Js.Static)f+=T.value;else if(T.type===Js.Param){const{value:I,repeatable:S,optional:R}=T,E=I in p?p[I]:"";if(uo(E)&&!S)throw new Error(`Provided param "${I}" is an array but it is not repeatable (* or + modifiers)`);const M=uo(E)?E.join("/"):E;if(!M)if(R)x.length<2&&(f.endsWith("/")?f=f.slice(0,-1):y=!0);else throw new Error(`Missing required param "${I}"`);f+=M}}return f||"/"}return{re:l,score:i,keys:a,parse:u,stringify:h}}function qy(e,t){let o=0;for(;o<e.length&&o<t.length;){const i=t[o]-e[o];if(i)return i;o++}return e.length<t.length?e.length===1&&e[0]===yn.Static+yn.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===yn.Static+yn.Segment?1:-1:0}function tp(e,t){let o=0;const i=e.score,s=t.score;for(;o<i.length&&o<s.length;){const a=qy(i[o],s[o]);if(a)return a;o++}if(Math.abs(s.length-i.length)===1){if(Rd(i))return 1;if(Rd(s))return-1}return s.length-i.length}function Rd(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const Ky={strict:!1,end:!0,sensitive:!1};function Yy(e,t,o){const i=Wy(Gy(e.path),o),s=bt(i,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function Jy(e,t){const o=[],i=new Map;t=Id(Ky,t);function s(y){return i.get(y)}function a(y,x,T){const I=!T,S=Nd(y);S.aliasOf=T&&T.record;const R=Id(t,y),E=[S];if("alias"in y){const $=typeof y.alias=="string"?[y.alias]:y.alias;for(const k of $)E.push(Nd(bt({},S,{components:T?T.record.components:S.components,path:k,aliasOf:T?T.record:S})))}let M,_;for(const $ of E){const{path:k}=$;if(x&&k[0]!=="/"){const w=x.record.path,A=w[w.length-1]==="/"?"":"/";$.path=x.record.path+(k&&A+k)}if(M=Yy($,x,R),T?T.alias.push(M):(_=_||M,_!==M&&_.alias.push(M),I&&y.name&&!Fd(M)&&l(y.name)),np(M)&&h(M),S.children){const w=S.children;for(let A=0;A<w.length;A++)a(w[A],M,T&&T.children[A])}T=T||M}return _?()=>{l(_)}:La}function l(y){if(Xf(y)){const x=i.get(y);x&&(i.delete(y),o.splice(o.indexOf(x),1),x.children.forEach(l),x.alias.forEach(l))}else{const x=o.indexOf(y);x>-1&&(o.splice(x,1),y.record.name&&i.delete(y.record.name),y.children.forEach(l),y.alias.forEach(l))}}function u(){return o}function h(y){const x=e_(y,o);o.splice(x,0,y),y.record.name&&!Fd(y)&&i.set(y.record.name,y)}function p(y,x){let T,I={},S,R;if("name"in y&&y.name){if(T=i.get(y.name),!T)throw Di(Dt.MATCHER_NOT_FOUND,{location:y});R=T.record.name,I=bt(Bd(x.params,T.keys.filter(_=>!_.optional).concat(T.parent?T.parent.keys.filter(_=>_.optional):[]).map(_=>_.name)),y.params&&Bd(y.params,T.keys.map(_=>_.name))),S=T.stringify(I)}else if(y.path!=null)S=y.path,T=o.find(_=>_.re.test(S)),T&&(I=T.parse(S),R=T.record.name);else{if(T=x.name?i.get(x.name):o.find(_=>_.re.test(x.path)),!T)throw Di(Dt.MATCHER_NOT_FOUND,{location:y,currentLocation:x});R=T.record.name,I=bt({},x.params,y.params),S=T.stringify(I)}const E=[];let M=T;for(;M;)E.unshift(M.record),M=M.parent;return{name:R,path:S,params:I,matched:E,meta:Qy(E)}}e.forEach(y=>a(y));function f(){o.length=0,i.clear()}return{addRoute:a,resolve:p,removeRoute:l,clearRoutes:f,getRoutes:u,getRecordMatcher:s}}function Bd(e,t){const o={};for(const i of t)i in e&&(o[i]=e[i]);return o}function Nd(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:Xy(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function Xy(e){const t={},o=e.props||!1;if("component"in e)t.default=o;else for(const i in e.components)t[i]=typeof o=="object"?o[i]:o;return t}function Fd(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Qy(e){return e.reduce((t,o)=>bt(t,o.meta),{})}function e_(e,t){let o=0,i=t.length;for(;o!==i;){const a=o+i>>1;tp(e,t[a])<0?i=a:o=a+1}const s=t_(e);return s&&(i=t.lastIndexOf(s,i-1)),i}function t_(e){let t=e;for(;t=t.parent;)if(np(t)&&tp(e,t)===0)return t}function np({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Ud(e){const t=Wn(fl),o=Wn(iu),i=X(()=>{const h=z(e.to);return t.resolve(h)}),s=X(()=>{const{matched:h}=i.value,{length:p}=h,f=h[p-1],y=o.matched;if(!f||!y.length)return-1;const x=y.findIndex(Pi.bind(null,f));if(x>-1)return x;const T=zd(h[p-2]);return p>1&&zd(f)===T&&y[y.length-1].path!==T?y.findIndex(Pi.bind(null,h[p-2])):x}),a=X(()=>s.value>-1&&a_(o.params,i.value.params)),l=X(()=>s.value>-1&&s.value===o.matched.length-1&&Jf(o.params,i.value.params));function u(h={}){if(i_(h)){const p=t[z(e.replace)?"replace":"push"](z(e.to)).catch(La);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>p),p}return Promise.resolve()}return{route:i,href:X(()=>i.value.href),isActive:a,isExactActive:l,navigate:u}}function n_(e){return e.length===1?e[0]:e}const o_=uf({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Ud,setup(e,{slots:t}){const o=Ba(Ud(e)),{options:i}=Wn(fl),s=X(()=>({[Hd(e.activeClass,i.linkActiveClass,"router-link-active")]:o.isActive,[Hd(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:o.isExactActive}));return()=>{const a=t.default&&n_(t.default(o));return e.custom?a:nu("a",{"aria-current":o.isExactActive?e.ariaCurrentValue:null,href:o.href,onClick:o.navigate,class:s.value},a)}}}),s_=o_;function i_(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function a_(e,t){for(const o in t){const i=t[o],s=e[o];if(typeof i=="string"){if(i!==s)return!1}else if(!uo(s)||s.length!==i.length||i.some((a,l)=>a.valueOf()!==s[l].valueOf()))return!1}return!0}function zd(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Hd=(e,t,o)=>e??t??o,r_=uf({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:o}){const i=Wn(xc),s=X(()=>e.route||i.value),a=Wn(Pd,0),l=X(()=>{let p=z(a);const{matched:f}=s.value;let y;for(;(y=f[p])&&!y.components;)p++;return p}),u=X(()=>s.value.matched[l.value]);Tr(Pd,X(()=>l.value+1)),Tr(Oy,u),Tr(xc,s);const h=D();return We(()=>[h.value,u.value,e.name],([p,f,y],[x,T,I])=>{f&&(f.instances[y]=p,T&&T!==f&&p&&p===x&&(f.leaveGuards.size||(f.leaveGuards=T.leaveGuards),f.updateGuards.size||(f.updateGuards=T.updateGuards))),p&&f&&(!T||!Pi(f,T)||!x)&&(f.enterCallbacks[y]||[]).forEach(S=>S(p))},{flush:"post"}),()=>{const p=s.value,f=e.name,y=u.value,x=y&&y.components[f];if(!x)return Vd(o.default,{Component:x,route:p});const T=y.props[f],I=T?T===!0?p.params:typeof T=="function"?T(p):T:null,R=nu(x,bt({},I,t,{onVnodeUnmounted:E=>{E.component.isUnmounted&&(y.instances[f]=null)},ref:h}));return Vd(o.default,{Component:R,route:p})||R}}});function Vd(e,t){if(!e)return null;const o=e(t);return o.length===1?o[0]:o}const l_=r_;function c_(e){const t=Jy(e.routes,e),o=e.parseQuery||Py,i=e.stringifyQuery||Ed,s=e.history,a=ca(),l=ca(),u=ca(),h=Kv(ms);let p=ms;wi&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const f=Ql.bind(null,le=>""+le),y=Ql.bind(null,my),x=Ql.bind(null,Pa);function T(le,pe){let q,fe;return Xf(le)?(q=t.getRecordMatcher(le),fe=pe):fe=le,t.addRoute(fe,q)}function I(le){const pe=t.getRecordMatcher(le);pe&&t.removeRoute(pe)}function S(){return t.getRoutes().map(le=>le.record)}function R(le){return!!t.getRecordMatcher(le)}function E(le,pe){if(pe=bt({},pe||h.value),typeof le=="string"){const W=ec(o,le,pe.path),j=t.resolve({path:W.path},pe),O=s.createHref(W.fullPath);return bt(W,j,{params:x(j.params),hash:Pa(W.hash),redirectedFrom:void 0,href:O})}let q;if(le.path!=null)q=bt({},le,{path:ec(o,le.path,pe.path).path});else{const W=bt({},le.params);for(const j in W)W[j]==null&&delete W[j];q=bt({},le,{params:y(W)}),pe.params=y(pe.params)}const fe=t.resolve(q,pe),Le=le.hash||"";fe.params=f(x(fe.params));const F=_y(i,bt({},le,{hash:fy(Le),path:fe.path})),G=s.createHref(F);return bt({fullPath:F,hash:Le,query:i===Ed?Dy(le.query):le.query||{}},fe,{redirectedFrom:void 0,href:G})}function M(le){return typeof le=="string"?ec(o,le,h.value.path):bt({},le)}function _(le,pe){if(p!==le)return Di(Dt.NAVIGATION_CANCELLED,{from:pe,to:le})}function $(le){return A(le)}function k(le){return $(bt(M(le),{replace:!0}))}function w(le,pe){const q=le.matched[le.matched.length-1];if(q&&q.redirect){const{redirect:fe}=q;let Le=typeof fe=="function"?fe(le,pe):fe;return typeof Le=="string"&&(Le=Le.includes("?")||Le.includes("#")?Le=M(Le):{path:Le},Le.params={}),bt({query:le.query,hash:le.hash,params:Le.path!=null?{}:le.params},Le)}}function A(le,pe){const q=p=E(le),fe=h.value,Le=le.state,F=le.force,G=le.replace===!0,W=w(q,fe);if(W)return A(bt(M(W),{state:typeof W=="object"?bt({},Le,W.state):Le,force:F,replace:G}),pe||q);const j=q;j.redirectedFrom=pe;let O;return!F&&ky(i,fe,q)&&(O=Di(Dt.NAVIGATION_DUPLICATED,{to:j,from:fe}),ke(fe,fe,!0,!1)),(O?Promise.resolve(O):_e(j,fe)).catch(B=>zo(B)?zo(B,Dt.NAVIGATION_GUARD_REDIRECT)?B:te(B):J(B,j,fe)).then(B=>{if(B){if(zo(B,Dt.NAVIGATION_GUARD_REDIRECT))return A(bt({replace:G},M(B.to),{state:typeof B.to=="object"?bt({},Le,B.to.state):Le,force:F}),pe||j)}else B=ve(j,fe,!0,G,Le);return re(j,fe,B),B})}function ne(le,pe){const q=_(le,pe);return q?Promise.reject(q):Promise.resolve()}function ae(le){const pe=Ee.values().next().value;return pe&&typeof pe.runWithContext=="function"?pe.runWithContext(le):le()}function _e(le,pe){let q;const[fe,Le,F]=Ry(le,pe);q=nc(fe.reverse(),"beforeRouteLeave",le,pe);for(const W of fe)W.leaveGuards.forEach(j=>{q.push(bs(j,le,pe))});const G=ne.bind(null,le,pe);return q.push(G),Se(q).then(()=>{q=[];for(const W of a.list())q.push(bs(W,le,pe));return q.push(G),Se(q)}).then(()=>{q=nc(Le,"beforeRouteUpdate",le,pe);for(const W of Le)W.updateGuards.forEach(j=>{q.push(bs(j,le,pe))});return q.push(G),Se(q)}).then(()=>{q=[];for(const W of F)if(W.beforeEnter)if(uo(W.beforeEnter))for(const j of W.beforeEnter)q.push(bs(j,le,pe));else q.push(bs(W.beforeEnter,le,pe));return q.push(G),Se(q)}).then(()=>(le.matched.forEach(W=>W.enterCallbacks={}),q=nc(F,"beforeRouteEnter",le,pe,ae),q.push(G),Se(q))).then(()=>{q=[];for(const W of l.list())q.push(bs(W,le,pe));return q.push(G),Se(q)}).catch(W=>zo(W,Dt.NAVIGATION_CANCELLED)?W:Promise.reject(W))}function re(le,pe,q){u.list().forEach(fe=>ae(()=>fe(le,pe,q)))}function ve(le,pe,q,fe,Le){const F=_(le,pe);if(F)return F;const G=pe===ms,W=wi?history.state:{};q&&(fe||G?s.replace(le.fullPath,bt({scroll:G&&W&&W.scroll},Le)):s.push(le.fullPath,Le)),h.value=le,ke(le,pe,q,G),te()}let Ie;function Re(){Ie||(Ie=s.listen((le,pe,q)=>{if(!be.listening)return;const fe=E(le),Le=w(fe,be.currentRoute.value);if(Le){A(bt(Le,{replace:!0,force:!0}),fe).catch(La);return}p=fe;const F=h.value;wi&&Iy(Ad(F.fullPath,q.delta),hl()),_e(fe,F).catch(G=>zo(G,Dt.NAVIGATION_ABORTED|Dt.NAVIGATION_CANCELLED)?G:zo(G,Dt.NAVIGATION_GUARD_REDIRECT)?(A(bt(M(G.to),{force:!0}),fe).then(W=>{zo(W,Dt.NAVIGATION_ABORTED|Dt.NAVIGATION_DUPLICATED)&&!q.delta&&q.type===Lc.pop&&s.go(-1,!1)}).catch(La),Promise.reject()):(q.delta&&s.go(-q.delta,!1),J(G,fe,F))).then(G=>{G=G||ve(fe,F,!1),G&&(q.delta&&!zo(G,Dt.NAVIGATION_CANCELLED)?s.go(-q.delta,!1):q.type===Lc.pop&&zo(G,Dt.NAVIGATION_ABORTED|Dt.NAVIGATION_DUPLICATED)&&s.go(-1,!1)),re(fe,F,G)}).catch(La)}))}let xe=ca(),he=ca(),Q;function J(le,pe,q){te(le);const fe=he.list();return fe.length?fe.forEach(Le=>Le(le,pe,q)):console.error(le),Promise.reject(le)}function ue(){return Q&&h.value!==ms?Promise.resolve():new Promise((le,pe)=>{xe.add([le,pe])})}function te(le){return Q||(Q=!le,Re(),xe.list().forEach(([pe,q])=>le?q(le):pe()),xe.reset()),le}function ke(le,pe,q,fe){const{scrollBehavior:Le}=e;if(!wi||!Le)return Promise.resolve();const F=!q&&$y(Ad(le.fullPath,0))||(fe||!q)&&history.state&&history.state.scroll||null;return Xo().then(()=>Le(le,pe,F)).then(G=>G&&Ty(G)).catch(G=>J(G,le,pe))}const Oe=le=>s.go(le);let oe;const Ee=new Set,be={currentRoute:h,listening:!0,addRoute:T,removeRoute:I,clearRoutes:t.clearRoutes,hasRoute:R,getRoutes:S,resolve:E,options:e,push:$,replace:k,go:Oe,back:()=>Oe(-1),forward:()=>Oe(1),beforeEach:a.add,beforeResolve:l.add,afterEach:u.add,onError:he.add,isReady:ue,install(le){le.component("RouterLink",s_),le.component("RouterView",l_),le.config.globalProperties.$router=be,Object.defineProperty(le.config.globalProperties,"$route",{enumerable:!0,get:()=>z(h)}),wi&&!oe&&h.value===ms&&(oe=!0,$(s.location).catch(fe=>{}));const pe={};for(const fe in ms)Object.defineProperty(pe,fe,{get:()=>h.value[fe],enumerable:!0});le.provide(fl,be),le.provide(iu,Gh(pe)),le.provide(xc,h);const q=le.unmount;Ee.add(le),le.unmount=function(){Ee.delete(le),Ee.size<1&&(p=ms,Ie&&Ie(),Ie=null,h.value=ms,oe=!1,Q=!1),q()}}};function Se(le){return le.reduce((pe,q)=>pe.then(()=>ae(q)),Promise.resolve())}return be}function Ua(){return Wn(fl)}function au(e){return Wn(iu)}const u_={},d_={class:"home"},h_={class:"container"},f_={class:"actions"};function p_(e,t){const o=rl("router-link");return m(),g("div",d_,[c("div",h_,[t[1]||(t[1]=c("h1",null,"Volunteer Check-in System ",-1)),t[2]||(t[2]=c("p",{class:"subtitle"},"Manage race marshals and volunteers with ease",-1)),c("div",f_,[ze(o,{to:"/admin/login",class:"btn btn-primary"},{default:nt(()=>[...t[0]||(t[0]=[Ze(" Admin Portal ",-1)])]),_:1})]),t[3]||(t[3]=Ef('<div class="features" data-v-536ab6a4><div class="feature-card" data-v-536ab6a4><h3 data-v-536ab6a4>For Admins</h3><ul data-v-536ab6a4><li data-v-536ab6a4>Create and manage events</li><li data-v-536ab6a4>Define marshal locations</li><li data-v-536ab6a4>Assign marshals to locations</li><li data-v-536ab6a4>Real-time check-in monitoring</li><li data-v-536ab6a4>Map view of all locations</li></ul></div><div class="feature-card" data-v-536ab6a4><h3 data-v-536ab6a4>For Marshals</h3><ul data-v-536ab6a4><li data-v-536ab6a4>View your assigned location</li><li data-v-536ab6a4>Check in with GPS verification</li><li data-v-536ab6a4>Access emergency contact info</li><li data-v-536ab6a4>View all marshal locations</li></ul></div></div>',1))])])}const v_=Je(u_,[["render",p_],["__scopeId","data-v-536ab6a4"]]);function op(e,t){return function(){return e.apply(t,arguments)}}const{toString:m_}=Object.prototype,{getPrototypeOf:ru}=Object,{iterator:pl,toStringTag:sp}=Symbol,vl=(e=>t=>{const o=m_.call(t);return e[o]||(e[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),ho=e=>(e=e.toLowerCase(),t=>vl(t)===e),ml=e=>t=>typeof t===e,{isArray:Bi}=Array,Oi=ml("undefined");function za(e){return e!==null&&!Oi(e)&&e.constructor!==null&&!Oi(e.constructor)&&In(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const ip=ho("ArrayBuffer");function g_(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&ip(e.buffer),t}const y_=ml("string"),In=ml("function"),ap=ml("number"),Ha=e=>e!==null&&typeof e=="object",__=e=>e===!0||e===!1,Er=e=>{if(vl(e)!=="object")return!1;const t=ru(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(sp in e)&&!(pl in e)},k_=e=>{if(!Ha(e)||za(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},b_=ho("Date"),w_=ho("File"),C_=ho("Blob"),L_=ho("FileList"),S_=e=>Ha(e)&&In(e.pipe),x_=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||In(e.append)&&((t=vl(e))==="formdata"||t==="object"&&In(e.toString)&&e.toString()==="[object FormData]"))},T_=ho("URLSearchParams"),[I_,$_,M_,A_]=["ReadableStream","Request","Response","Headers"].map(ho),E_=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Va(e,t,{allOwnKeys:o=!1}={}){if(e===null||typeof e>"u")return;let i,s;if(typeof e!="object"&&(e=[e]),Bi(e))for(i=0,s=e.length;i<s;i++)t.call(null,e[i],i,e);else{if(za(e))return;const a=o?Object.getOwnPropertyNames(e):Object.keys(e),l=a.length;let u;for(i=0;i<l;i++)u=a[i],t.call(null,e[u],u,e)}}function rp(e,t){if(za(e))return null;t=t.toLowerCase();const o=Object.keys(e);let i=o.length,s;for(;i-- >0;)if(s=o[i],t===s.toLowerCase())return s;return null}const Xs=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,lp=e=>!Oi(e)&&e!==Xs;function Tc(){const{caseless:e,skipUndefined:t}=lp(this)&&this||{},o={},i=(s,a)=>{const l=e&&rp(o,a)||a;Er(o[l])&&Er(s)?o[l]=Tc(o[l],s):Er(s)?o[l]=Tc({},s):Bi(s)?o[l]=s.slice():(!t||!Oi(s))&&(o[l]=s)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&Va(arguments[s],i);return o}const P_=(e,t,o,{allOwnKeys:i}={})=>(Va(t,(s,a)=>{o&&In(s)?e[a]=op(s,o):e[a]=s},{allOwnKeys:i}),e),D_=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),O_=(e,t,o,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),o&&Object.assign(e.prototype,o)},R_=(e,t,o,i)=>{let s,a,l;const u={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),a=s.length;a-- >0;)l=s[a],(!i||i(l,e,t))&&!u[l]&&(t[l]=e[l],u[l]=!0);e=o!==!1&&ru(e)}while(e&&(!o||o(e,t))&&e!==Object.prototype);return t},B_=(e,t,o)=>{e=String(e),(o===void 0||o>e.length)&&(o=e.length),o-=t.length;const i=e.indexOf(t,o);return i!==-1&&i===o},N_=e=>{if(!e)return null;if(Bi(e))return e;let t=e.length;if(!ap(t))return null;const o=new Array(t);for(;t-- >0;)o[t]=e[t];return o},F_=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&ru(Uint8Array)),U_=(e,t)=>{const i=(e&&e[pl]).call(e);let s;for(;(s=i.next())&&!s.done;){const a=s.value;t.call(e,a[0],a[1])}},z_=(e,t)=>{let o;const i=[];for(;(o=e.exec(t))!==null;)i.push(o);return i},H_=ho("HTMLFormElement"),V_=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,i,s){return i.toUpperCase()+s}),Gd=(({hasOwnProperty:e})=>(t,o)=>e.call(t,o))(Object.prototype),G_=ho("RegExp"),cp=(e,t)=>{const o=Object.getOwnPropertyDescriptors(e),i={};Va(o,(s,a)=>{let l;(l=t(s,a,e))!==!1&&(i[a]=l||s)}),Object.defineProperties(e,i)},Z_=e=>{cp(e,(t,o)=>{if(In(e)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const i=e[o];if(In(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},j_=(e,t)=>{const o={},i=s=>{s.forEach(a=>{o[a]=!0})};return Bi(e)?i(e):i(String(e).split(t)),o},W_=()=>{},q_=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function K_(e){return!!(e&&In(e.append)&&e[sp]==="FormData"&&e[pl])}const Y_=e=>{const t=new Array(10),o=(i,s)=>{if(Ha(i)){if(t.indexOf(i)>=0)return;if(za(i))return i;if(!("toJSON"in i)){t[s]=i;const a=Bi(i)?[]:{};return Va(i,(l,u)=>{const h=o(l,s+1);!Oi(h)&&(a[u]=h)}),t[s]=void 0,a}}return i};return o(e,0)},J_=ho("AsyncFunction"),X_=e=>e&&(Ha(e)||In(e))&&In(e.then)&&In(e.catch),up=((e,t)=>e?setImmediate:t?((o,i)=>(Xs.addEventListener("message",({source:s,data:a})=>{s===Xs&&a===o&&i.length&&i.shift()()},!1),s=>{i.push(s),Xs.postMessage(o,"*")}))(`axios@${Math.random()}`,[]):o=>setTimeout(o))(typeof setImmediate=="function",In(Xs.postMessage)),Q_=typeof queueMicrotask<"u"?queueMicrotask.bind(Xs):typeof process<"u"&&process.nextTick||up,e1=e=>e!=null&&In(e[pl]),ge={isArray:Bi,isArrayBuffer:ip,isBuffer:za,isFormData:x_,isArrayBufferView:g_,isString:y_,isNumber:ap,isBoolean:__,isObject:Ha,isPlainObject:Er,isEmptyObject:k_,isReadableStream:I_,isRequest:$_,isResponse:M_,isHeaders:A_,isUndefined:Oi,isDate:b_,isFile:w_,isBlob:C_,isRegExp:G_,isFunction:In,isStream:S_,isURLSearchParams:T_,isTypedArray:F_,isFileList:L_,forEach:Va,merge:Tc,extend:P_,trim:E_,stripBOM:D_,inherits:O_,toFlatObject:R_,kindOf:vl,kindOfTest:ho,endsWith:B_,toArray:N_,forEachEntry:U_,matchAll:z_,isHTMLForm:H_,hasOwnProperty:Gd,hasOwnProp:Gd,reduceDescriptors:cp,freezeMethods:Z_,toObjectSet:j_,toCamelCase:V_,noop:W_,toFiniteNumber:q_,findKey:rp,global:Xs,isContextDefined:lp,isSpecCompliantForm:K_,toJSONObject:Y_,isAsyncFn:J_,isThenable:X_,setImmediate:up,asap:Q_,isIterable:e1};function dt(e,t,o,i,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),o&&(this.config=o),i&&(this.request=i),s&&(this.response=s,this.status=s.status?s.status:null)}ge.inherits(dt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ge.toJSONObject(this.config),code:this.code,status:this.status}}});const dp=dt.prototype,hp={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{hp[e]={value:e}});Object.defineProperties(dt,hp);Object.defineProperty(dp,"isAxiosError",{value:!0});dt.from=(e,t,o,i,s,a)=>{const l=Object.create(dp);ge.toFlatObject(e,l,function(f){return f!==Error.prototype},p=>p!=="isAxiosError");const u=e&&e.message?e.message:"Error",h=t==null&&e?e.code:t;return dt.call(l,u,h,o,i,s),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",a&&Object.assign(l,a),l};const t1=null;function Ic(e){return ge.isPlainObject(e)||ge.isArray(e)}function fp(e){return ge.endsWith(e,"[]")?e.slice(0,-2):e}function Zd(e,t,o){return e?e.concat(t).map(function(s,a){return s=fp(s),!o&&a?"["+s+"]":s}).join(o?".":""):t}function n1(e){return ge.isArray(e)&&!e.some(Ic)}const o1=ge.toFlatObject(ge,{},null,function(t){return/^is[A-Z]/.test(t)});function gl(e,t,o){if(!ge.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,o=ge.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,R){return!ge.isUndefined(R[S])});const i=o.metaTokens,s=o.visitor||f,a=o.dots,l=o.indexes,h=(o.Blob||typeof Blob<"u"&&Blob)&&ge.isSpecCompliantForm(t);if(!ge.isFunction(s))throw new TypeError("visitor must be a function");function p(I){if(I===null)return"";if(ge.isDate(I))return I.toISOString();if(ge.isBoolean(I))return I.toString();if(!h&&ge.isBlob(I))throw new dt("Blob is not supported. Use a Buffer instead.");return ge.isArrayBuffer(I)||ge.isTypedArray(I)?h&&typeof Blob=="function"?new Blob([I]):Buffer.from(I):I}function f(I,S,R){let E=I;if(I&&!R&&typeof I=="object"){if(ge.endsWith(S,"{}"))S=i?S:S.slice(0,-2),I=JSON.stringify(I);else if(ge.isArray(I)&&n1(I)||(ge.isFileList(I)||ge.endsWith(S,"[]"))&&(E=ge.toArray(I)))return S=fp(S),E.forEach(function(_,$){!(ge.isUndefined(_)||_===null)&&t.append(l===!0?Zd([S],$,a):l===null?S:S+"[]",p(_))}),!1}return Ic(I)?!0:(t.append(Zd(R,S,a),p(I)),!1)}const y=[],x=Object.assign(o1,{defaultVisitor:f,convertValue:p,isVisitable:Ic});function T(I,S){if(!ge.isUndefined(I)){if(y.indexOf(I)!==-1)throw Error("Circular reference detected in "+S.join("."));y.push(I),ge.forEach(I,function(E,M){(!(ge.isUndefined(E)||E===null)&&s.call(t,E,ge.isString(M)?M.trim():M,S,x))===!0&&T(E,S?S.concat(M):[M])}),y.pop()}}if(!ge.isObject(e))throw new TypeError("data must be an object");return T(e),t}function jd(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function lu(e,t){this._pairs=[],e&&gl(e,this,t)}const pp=lu.prototype;pp.append=function(t,o){this._pairs.push([t,o])};pp.toString=function(t){const o=t?function(i){return t.call(this,i,jd)}:jd;return this._pairs.map(function(s){return o(s[0])+"="+o(s[1])},"").join("&")};function s1(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function vp(e,t,o){if(!t)return e;const i=o&&o.encode||s1;ge.isFunction(o)&&(o={serialize:o});const s=o&&o.serialize;let a;if(s?a=s(t,o):a=ge.isURLSearchParams(t)?t.toString():new lu(t,o).toString(i),a){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class Wd{constructor(){this.handlers=[]}use(t,o,i){return this.handlers.push({fulfilled:t,rejected:o,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ge.forEach(this.handlers,function(i){i!==null&&t(i)})}}const mp={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},i1=typeof URLSearchParams<"u"?URLSearchParams:lu,a1=typeof FormData<"u"?FormData:null,r1=typeof Blob<"u"?Blob:null,l1={isBrowser:!0,classes:{URLSearchParams:i1,FormData:a1,Blob:r1},protocols:["http","https","file","blob","url","data"]},cu=typeof window<"u"&&typeof document<"u",$c=typeof navigator=="object"&&navigator||void 0,c1=cu&&(!$c||["ReactNative","NativeScript","NS"].indexOf($c.product)<0),u1=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",d1=cu&&window.location.href||"http://localhost",h1=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:cu,hasStandardBrowserEnv:c1,hasStandardBrowserWebWorkerEnv:u1,navigator:$c,origin:d1},Symbol.toStringTag,{value:"Module"})),cn={...h1,...l1};function f1(e,t){return gl(e,new cn.classes.URLSearchParams,{visitor:function(o,i,s,a){return cn.isNode&&ge.isBuffer(o)?(this.append(i,o.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function p1(e){return ge.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function v1(e){const t={},o=Object.keys(e);let i;const s=o.length;let a;for(i=0;i<s;i++)a=o[i],t[a]=e[a];return t}function gp(e){function t(o,i,s,a){let l=o[a++];if(l==="__proto__")return!0;const u=Number.isFinite(+l),h=a>=o.length;return l=!l&&ge.isArray(s)?s.length:l,h?(ge.hasOwnProp(s,l)?s[l]=[s[l],i]:s[l]=i,!u):((!s[l]||!ge.isObject(s[l]))&&(s[l]=[]),t(o,i,s[l],a)&&ge.isArray(s[l])&&(s[l]=v1(s[l])),!u)}if(ge.isFormData(e)&&ge.isFunction(e.entries)){const o={};return ge.forEachEntry(e,(i,s)=>{t(p1(i),s,o,0)}),o}return null}function m1(e,t,o){if(ge.isString(e))try{return(t||JSON.parse)(e),ge.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(o||JSON.stringify)(e)}const Ga={transitional:mp,adapter:["xhr","http","fetch"],transformRequest:[function(t,o){const i=o.getContentType()||"",s=i.indexOf("application/json")>-1,a=ge.isObject(t);if(a&&ge.isHTMLForm(t)&&(t=new FormData(t)),ge.isFormData(t))return s?JSON.stringify(gp(t)):t;if(ge.isArrayBuffer(t)||ge.isBuffer(t)||ge.isStream(t)||ge.isFile(t)||ge.isBlob(t)||ge.isReadableStream(t))return t;if(ge.isArrayBufferView(t))return t.buffer;if(ge.isURLSearchParams(t))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(a){if(i.indexOf("application/x-www-form-urlencoded")>-1)return f1(t,this.formSerializer).toString();if((u=ge.isFileList(t))||i.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return gl(u?{"files[]":t}:t,h&&new h,this.formSerializer)}}return a||s?(o.setContentType("application/json",!1),m1(t)):t}],transformResponse:[function(t){const o=this.transitional||Ga.transitional,i=o&&o.forcedJSONParsing,s=this.responseType==="json";if(ge.isResponse(t)||ge.isReadableStream(t))return t;if(t&&ge.isString(t)&&(i&&!this.responseType||s)){const l=!(o&&o.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(u){if(l)throw u.name==="SyntaxError"?dt.from(u,dt.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:cn.classes.FormData,Blob:cn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ge.forEach(["delete","get","head","post","put","patch"],e=>{Ga.headers[e]={}});const g1=ge.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),y1=e=>{const t={};let o,i,s;return e&&e.split(`
`).forEach(function(l){s=l.indexOf(":"),o=l.substring(0,s).trim().toLowerCase(),i=l.substring(s+1).trim(),!(!o||t[o]&&g1[o])&&(o==="set-cookie"?t[o]?t[o].push(i):t[o]=[i]:t[o]=t[o]?t[o]+", "+i:i)}),t},qd=Symbol("internals");function ua(e){return e&&String(e).trim().toLowerCase()}function Pr(e){return e===!1||e==null?e:ge.isArray(e)?e.map(Pr):String(e)}function _1(e){const t=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=o.exec(e);)t[i[1]]=i[2];return t}const k1=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function oc(e,t,o,i,s){if(ge.isFunction(i))return i.call(this,t,o);if(s&&(t=o),!!ge.isString(t)){if(ge.isString(i))return t.indexOf(i)!==-1;if(ge.isRegExp(i))return i.test(t)}}function b1(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,o,i)=>o.toUpperCase()+i)}function w1(e,t){const o=ge.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+o,{value:function(s,a,l){return this[i].call(this,t,s,a,l)},configurable:!0})})}let $n=class{constructor(t){t&&this.set(t)}set(t,o,i){const s=this;function a(u,h,p){const f=ua(h);if(!f)throw new Error("header name must be a non-empty string");const y=ge.findKey(s,f);(!y||s[y]===void 0||p===!0||p===void 0&&s[y]!==!1)&&(s[y||h]=Pr(u))}const l=(u,h)=>ge.forEach(u,(p,f)=>a(p,f,h));if(ge.isPlainObject(t)||t instanceof this.constructor)l(t,o);else if(ge.isString(t)&&(t=t.trim())&&!k1(t))l(y1(t),o);else if(ge.isObject(t)&&ge.isIterable(t)){let u={},h,p;for(const f of t){if(!ge.isArray(f))throw TypeError("Object iterator must return a key-value pair");u[p=f[0]]=(h=u[p])?ge.isArray(h)?[...h,f[1]]:[h,f[1]]:f[1]}l(u,o)}else t!=null&&a(o,t,i);return this}get(t,o){if(t=ua(t),t){const i=ge.findKey(this,t);if(i){const s=this[i];if(!o)return s;if(o===!0)return _1(s);if(ge.isFunction(o))return o.call(this,s,i);if(ge.isRegExp(o))return o.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,o){if(t=ua(t),t){const i=ge.findKey(this,t);return!!(i&&this[i]!==void 0&&(!o||oc(this,this[i],i,o)))}return!1}delete(t,o){const i=this;let s=!1;function a(l){if(l=ua(l),l){const u=ge.findKey(i,l);u&&(!o||oc(i,i[u],u,o))&&(delete i[u],s=!0)}}return ge.isArray(t)?t.forEach(a):a(t),s}clear(t){const o=Object.keys(this);let i=o.length,s=!1;for(;i--;){const a=o[i];(!t||oc(this,this[a],a,t,!0))&&(delete this[a],s=!0)}return s}normalize(t){const o=this,i={};return ge.forEach(this,(s,a)=>{const l=ge.findKey(i,a);if(l){o[l]=Pr(s),delete o[a];return}const u=t?b1(a):String(a).trim();u!==a&&delete o[a],o[u]=Pr(s),i[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const o=Object.create(null);return ge.forEach(this,(i,s)=>{i!=null&&i!==!1&&(o[s]=t&&ge.isArray(i)?i.join(", "):i)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,o])=>t+": "+o).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...o){const i=new this(t);return o.forEach(s=>i.set(s)),i}static accessor(t){const i=(this[qd]=this[qd]={accessors:{}}).accessors,s=this.prototype;function a(l){const u=ua(l);i[u]||(w1(s,l),i[u]=!0)}return ge.isArray(t)?t.forEach(a):a(t),this}};$n.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ge.reduceDescriptors($n.prototype,({value:e},t)=>{let o=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[o]=i}}});ge.freezeMethods($n);function sc(e,t){const o=this||Ga,i=t||o,s=$n.from(i.headers);let a=i.data;return ge.forEach(e,function(u){a=u.call(o,a,s.normalize(),t?t.status:void 0)}),s.normalize(),a}function yp(e){return!!(e&&e.__CANCEL__)}function Ni(e,t,o){dt.call(this,e??"canceled",dt.ERR_CANCELED,t,o),this.name="CanceledError"}ge.inherits(Ni,dt,{__CANCEL__:!0});function _p(e,t,o){const i=o.config.validateStatus;!o.status||!i||i(o.status)?e(o):t(new dt("Request failed with status code "+o.status,[dt.ERR_BAD_REQUEST,dt.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}function C1(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function L1(e,t){e=e||10;const o=new Array(e),i=new Array(e);let s=0,a=0,l;return t=t!==void 0?t:1e3,function(h){const p=Date.now(),f=i[a];l||(l=p),o[s]=h,i[s]=p;let y=a,x=0;for(;y!==s;)x+=o[y++],y=y%e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),p-l<t)return;const T=f&&p-f;return T?Math.round(x*1e3/T):void 0}}function S1(e,t){let o=0,i=1e3/t,s,a;const l=(p,f=Date.now())=>{o=f,s=null,a&&(clearTimeout(a),a=null),e(...p)};return[(...p)=>{const f=Date.now(),y=f-o;y>=i?l(p,f):(s=p,a||(a=setTimeout(()=>{a=null,l(s)},i-y)))},()=>s&&l(s)]}const Zr=(e,t,o=3)=>{let i=0;const s=L1(50,250);return S1(a=>{const l=a.loaded,u=a.lengthComputable?a.total:void 0,h=l-i,p=s(h),f=l<=u;i=l;const y={loaded:l,total:u,progress:u?l/u:void 0,bytes:h,rate:p||void 0,estimated:p&&u&&f?(u-l)/p:void 0,event:a,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(y)},o)},Kd=(e,t)=>{const o=e!=null;return[i=>t[0]({lengthComputable:o,total:e,loaded:i}),t[1]]},Yd=e=>(...t)=>ge.asap(()=>e(...t)),x1=cn.hasStandardBrowserEnv?((e,t)=>o=>(o=new URL(o,cn.origin),e.protocol===o.protocol&&e.host===o.host&&(t||e.port===o.port)))(new URL(cn.origin),cn.navigator&&/(msie|trident)/i.test(cn.navigator.userAgent)):()=>!0,T1=cn.hasStandardBrowserEnv?{write(e,t,o,i,s,a,l){if(typeof document>"u")return;const u=[`${e}=${encodeURIComponent(t)}`];ge.isNumber(o)&&u.push(`expires=${new Date(o).toUTCString()}`),ge.isString(i)&&u.push(`path=${i}`),ge.isString(s)&&u.push(`domain=${s}`),a===!0&&u.push("secure"),ge.isString(l)&&u.push(`SameSite=${l}`),document.cookie=u.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function I1(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function $1(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function kp(e,t,o){let i=!I1(t);return e&&(i||o==!1)?$1(e,t):t}const Jd=e=>e instanceof $n?{...e}:e;function ai(e,t){t=t||{};const o={};function i(p,f,y,x){return ge.isPlainObject(p)&&ge.isPlainObject(f)?ge.merge.call({caseless:x},p,f):ge.isPlainObject(f)?ge.merge({},f):ge.isArray(f)?f.slice():f}function s(p,f,y,x){if(ge.isUndefined(f)){if(!ge.isUndefined(p))return i(void 0,p,y,x)}else return i(p,f,y,x)}function a(p,f){if(!ge.isUndefined(f))return i(void 0,f)}function l(p,f){if(ge.isUndefined(f)){if(!ge.isUndefined(p))return i(void 0,p)}else return i(void 0,f)}function u(p,f,y){if(y in t)return i(p,f);if(y in e)return i(void 0,p)}const h={url:a,method:a,data:a,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:u,headers:(p,f,y)=>s(Jd(p),Jd(f),y,!0)};return ge.forEach(Object.keys({...e,...t}),function(f){const y=h[f]||s,x=y(e[f],t[f],f);ge.isUndefined(x)&&y!==u||(o[f]=x)}),o}const bp=e=>{const t=ai({},e);let{data:o,withXSRFToken:i,xsrfHeaderName:s,xsrfCookieName:a,headers:l,auth:u}=t;if(t.headers=l=$n.from(l),t.url=vp(kp(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&l.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),ge.isFormData(o)){if(cn.hasStandardBrowserEnv||cn.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(ge.isFunction(o.getHeaders)){const h=o.getHeaders(),p=["content-type","content-length"];Object.entries(h).forEach(([f,y])=>{p.includes(f.toLowerCase())&&l.set(f,y)})}}if(cn.hasStandardBrowserEnv&&(i&&ge.isFunction(i)&&(i=i(t)),i||i!==!1&&x1(t.url))){const h=s&&a&&T1.read(a);h&&l.set(s,h)}return t},M1=typeof XMLHttpRequest<"u",A1=M1&&function(e){return new Promise(function(o,i){const s=bp(e);let a=s.data;const l=$n.from(s.headers).normalize();let{responseType:u,onUploadProgress:h,onDownloadProgress:p}=s,f,y,x,T,I;function S(){T&&T(),I&&I(),s.cancelToken&&s.cancelToken.unsubscribe(f),s.signal&&s.signal.removeEventListener("abort",f)}let R=new XMLHttpRequest;R.open(s.method.toUpperCase(),s.url,!0),R.timeout=s.timeout;function E(){if(!R)return;const _=$n.from("getAllResponseHeaders"in R&&R.getAllResponseHeaders()),k={data:!u||u==="text"||u==="json"?R.responseText:R.response,status:R.status,statusText:R.statusText,headers:_,config:e,request:R};_p(function(A){o(A),S()},function(A){i(A),S()},k),R=null}"onloadend"in R?R.onloadend=E:R.onreadystatechange=function(){!R||R.readyState!==4||R.status===0&&!(R.responseURL&&R.responseURL.indexOf("file:")===0)||setTimeout(E)},R.onabort=function(){R&&(i(new dt("Request aborted",dt.ECONNABORTED,e,R)),R=null)},R.onerror=function($){const k=$&&$.message?$.message:"Network Error",w=new dt(k,dt.ERR_NETWORK,e,R);w.event=$||null,i(w),R=null},R.ontimeout=function(){let $=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const k=s.transitional||mp;s.timeoutErrorMessage&&($=s.timeoutErrorMessage),i(new dt($,k.clarifyTimeoutError?dt.ETIMEDOUT:dt.ECONNABORTED,e,R)),R=null},a===void 0&&l.setContentType(null),"setRequestHeader"in R&&ge.forEach(l.toJSON(),function($,k){R.setRequestHeader(k,$)}),ge.isUndefined(s.withCredentials)||(R.withCredentials=!!s.withCredentials),u&&u!=="json"&&(R.responseType=s.responseType),p&&([x,I]=Zr(p,!0),R.addEventListener("progress",x)),h&&R.upload&&([y,T]=Zr(h),R.upload.addEventListener("progress",y),R.upload.addEventListener("loadend",T)),(s.cancelToken||s.signal)&&(f=_=>{R&&(i(!_||_.type?new Ni(null,e,R):_),R.abort(),R=null)},s.cancelToken&&s.cancelToken.subscribe(f),s.signal&&(s.signal.aborted?f():s.signal.addEventListener("abort",f)));const M=C1(s.url);if(M&&cn.protocols.indexOf(M)===-1){i(new dt("Unsupported protocol "+M+":",dt.ERR_BAD_REQUEST,e));return}R.send(a||null)})},E1=(e,t)=>{const{length:o}=e=e?e.filter(Boolean):[];if(t||o){let i=new AbortController,s;const a=function(p){if(!s){s=!0,u();const f=p instanceof Error?p:this.reason;i.abort(f instanceof dt?f:new Ni(f instanceof Error?f.message:f))}};let l=t&&setTimeout(()=>{l=null,a(new dt(`timeout ${t} of ms exceeded`,dt.ETIMEDOUT))},t);const u=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(p=>{p.unsubscribe?p.unsubscribe(a):p.removeEventListener("abort",a)}),e=null)};e.forEach(p=>p.addEventListener("abort",a));const{signal:h}=i;return h.unsubscribe=()=>ge.asap(u),h}},P1=function*(e,t){let o=e.byteLength;if(o<t){yield e;return}let i=0,s;for(;i<o;)s=i+t,yield e.slice(i,s),i=s},D1=async function*(e,t){for await(const o of O1(e))yield*P1(o,t)},O1=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:o,value:i}=await t.read();if(o)break;yield i}}finally{await t.cancel()}},Xd=(e,t,o,i)=>{const s=D1(e,t);let a=0,l,u=h=>{l||(l=!0,i&&i(h))};return new ReadableStream({async pull(h){try{const{done:p,value:f}=await s.next();if(p){u(),h.close();return}let y=f.byteLength;if(o){let x=a+=y;o(x)}h.enqueue(new Uint8Array(f))}catch(p){throw u(p),p}},cancel(h){return u(h),s.return()}},{highWaterMark:2})},Qd=64*1024,{isFunction:br}=ge,R1=(({Request:e,Response:t})=>({Request:e,Response:t}))(ge.global),{ReadableStream:eh,TextEncoder:th}=ge.global,nh=(e,...t)=>{try{return!!e(...t)}catch{return!1}},B1=e=>{e=ge.merge.call({skipUndefined:!0},R1,e);const{fetch:t,Request:o,Response:i}=e,s=t?br(t):typeof fetch=="function",a=br(o),l=br(i);if(!s)return!1;const u=s&&br(eh),h=s&&(typeof th=="function"?(I=>S=>I.encode(S))(new th):async I=>new Uint8Array(await new o(I).arrayBuffer())),p=a&&u&&nh(()=>{let I=!1;const S=new o(cn.origin,{body:new eh,method:"POST",get duplex(){return I=!0,"half"}}).headers.has("Content-Type");return I&&!S}),f=l&&u&&nh(()=>ge.isReadableStream(new i("").body)),y={stream:f&&(I=>I.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(I=>{!y[I]&&(y[I]=(S,R)=>{let E=S&&S[I];if(E)return E.call(S);throw new dt(`Response type '${I}' is not supported`,dt.ERR_NOT_SUPPORT,R)})});const x=async I=>{if(I==null)return 0;if(ge.isBlob(I))return I.size;if(ge.isSpecCompliantForm(I))return(await new o(cn.origin,{method:"POST",body:I}).arrayBuffer()).byteLength;if(ge.isArrayBufferView(I)||ge.isArrayBuffer(I))return I.byteLength;if(ge.isURLSearchParams(I)&&(I=I+""),ge.isString(I))return(await h(I)).byteLength},T=async(I,S)=>{const R=ge.toFiniteNumber(I.getContentLength());return R??x(S)};return async I=>{let{url:S,method:R,data:E,signal:M,cancelToken:_,timeout:$,onDownloadProgress:k,onUploadProgress:w,responseType:A,headers:ne,withCredentials:ae="same-origin",fetchOptions:_e}=bp(I),re=t||fetch;A=A?(A+"").toLowerCase():"text";let ve=E1([M,_&&_.toAbortSignal()],$),Ie=null;const Re=ve&&ve.unsubscribe&&(()=>{ve.unsubscribe()});let xe;try{if(w&&p&&R!=="get"&&R!=="head"&&(xe=await T(ne,E))!==0){let ke=new o(S,{method:"POST",body:E,duplex:"half"}),Oe;if(ge.isFormData(E)&&(Oe=ke.headers.get("content-type"))&&ne.setContentType(Oe),ke.body){const[oe,Ee]=Kd(xe,Zr(Yd(w)));E=Xd(ke.body,Qd,oe,Ee)}}ge.isString(ae)||(ae=ae?"include":"omit");const he=a&&"credentials"in o.prototype,Q={..._e,signal:ve,method:R.toUpperCase(),headers:ne.normalize().toJSON(),body:E,duplex:"half",credentials:he?ae:void 0};Ie=a&&new o(S,Q);let J=await(a?re(Ie,_e):re(S,Q));const ue=f&&(A==="stream"||A==="response");if(f&&(k||ue&&Re)){const ke={};["status","statusText","headers"].forEach(be=>{ke[be]=J[be]});const Oe=ge.toFiniteNumber(J.headers.get("content-length")),[oe,Ee]=k&&Kd(Oe,Zr(Yd(k),!0))||[];J=new i(Xd(J.body,Qd,oe,()=>{Ee&&Ee(),Re&&Re()}),ke)}A=A||"text";let te=await y[ge.findKey(y,A)||"text"](J,I);return!ue&&Re&&Re(),await new Promise((ke,Oe)=>{_p(ke,Oe,{data:te,headers:$n.from(J.headers),status:J.status,statusText:J.statusText,config:I,request:Ie})})}catch(he){throw Re&&Re(),he&&he.name==="TypeError"&&/Load failed|fetch/i.test(he.message)?Object.assign(new dt("Network Error",dt.ERR_NETWORK,I,Ie),{cause:he.cause||he}):dt.from(he,he&&he.code,I,Ie)}}},N1=new Map,wp=e=>{let t=e&&e.env||{};const{fetch:o,Request:i,Response:s}=t,a=[i,s,o];let l=a.length,u=l,h,p,f=N1;for(;u--;)h=a[u],p=f.get(h),p===void 0&&f.set(h,p=u?new Map:B1(t)),f=p;return p};wp();const uu={http:t1,xhr:A1,fetch:{get:wp}};ge.forEach(uu,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const oh=e=>`- ${e}`,F1=e=>ge.isFunction(e)||e===null||e===!1;function U1(e,t){e=ge.isArray(e)?e:[e];const{length:o}=e;let i,s;const a={};for(let l=0;l<o;l++){i=e[l];let u;if(s=i,!F1(i)&&(s=uu[(u=String(i)).toLowerCase()],s===void 0))throw new dt(`Unknown adapter '${u}'`);if(s&&(ge.isFunction(s)||(s=s.get(t))))break;a[u||"#"+l]=s}if(!s){const l=Object.entries(a).map(([h,p])=>`adapter ${h} `+(p===!1?"is not supported by the environment":"is not available in the build"));let u=o?l.length>1?`since :
`+l.map(oh).join(`
`):" "+oh(l[0]):"as no adapter specified";throw new dt("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return s}const Cp={getAdapter:U1,adapters:uu};function ic(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ni(null,e)}function sh(e){return ic(e),e.headers=$n.from(e.headers),e.data=sc.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Cp.getAdapter(e.adapter||Ga.adapter,e)(e).then(function(i){return ic(e),i.data=sc.call(e,e.transformResponse,i),i.headers=$n.from(i.headers),i},function(i){return yp(i)||(ic(e),i&&i.response&&(i.response.data=sc.call(e,e.transformResponse,i.response),i.response.headers=$n.from(i.response.headers))),Promise.reject(i)})}const Lp="1.13.2",yl={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{yl[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});const ih={};yl.transitional=function(t,o,i){function s(a,l){return"[Axios v"+Lp+"] Transitional option '"+a+"'"+l+(i?". "+i:"")}return(a,l,u)=>{if(t===!1)throw new dt(s(l," has been removed"+(o?" in "+o:"")),dt.ERR_DEPRECATED);return o&&!ih[l]&&(ih[l]=!0,console.warn(s(l," has been deprecated since v"+o+" and will be removed in the near future"))),t?t(a,l,u):!0}};yl.spelling=function(t){return(o,i)=>(console.warn(`${i} is likely a misspelling of ${t}`),!0)};function z1(e,t,o){if(typeof e!="object")throw new dt("options must be an object",dt.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let s=i.length;for(;s-- >0;){const a=i[s],l=t[a];if(l){const u=e[a],h=u===void 0||l(u,a,e);if(h!==!0)throw new dt("option "+a+" must be "+h,dt.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new dt("Unknown option "+a,dt.ERR_BAD_OPTION)}}const Dr={assertOptions:z1,validators:yl},So=Dr.validators;let oi=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Wd,response:new Wd}}async request(t,o){try{return await this._request(t,o)}catch(i){if(i instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{i.stack?a&&!String(i.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+a):i.stack=a}catch{}}throw i}}_request(t,o){typeof t=="string"?(o=o||{},o.url=t):o=t||{},o=ai(this.defaults,o);const{transitional:i,paramsSerializer:s,headers:a}=o;i!==void 0&&Dr.assertOptions(i,{silentJSONParsing:So.transitional(So.boolean),forcedJSONParsing:So.transitional(So.boolean),clarifyTimeoutError:So.transitional(So.boolean)},!1),s!=null&&(ge.isFunction(s)?o.paramsSerializer={serialize:s}:Dr.assertOptions(s,{encode:So.function,serialize:So.function},!0)),o.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?o.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:o.allowAbsoluteUrls=!0),Dr.assertOptions(o,{baseUrl:So.spelling("baseURL"),withXsrfToken:So.spelling("withXSRFToken")},!0),o.method=(o.method||this.defaults.method||"get").toLowerCase();let l=a&&ge.merge(a.common,a[o.method]);a&&ge.forEach(["delete","get","head","post","put","patch","common"],I=>{delete a[I]}),o.headers=$n.concat(l,a);const u=[];let h=!0;this.interceptors.request.forEach(function(S){typeof S.runWhen=="function"&&S.runWhen(o)===!1||(h=h&&S.synchronous,u.unshift(S.fulfilled,S.rejected))});const p=[];this.interceptors.response.forEach(function(S){p.push(S.fulfilled,S.rejected)});let f,y=0,x;if(!h){const I=[sh.bind(this),void 0];for(I.unshift(...u),I.push(...p),x=I.length,f=Promise.resolve(o);y<x;)f=f.then(I[y++],I[y++]);return f}x=u.length;let T=o;for(;y<x;){const I=u[y++],S=u[y++];try{T=I(T)}catch(R){S.call(this,R);break}}try{f=sh.call(this,T)}catch(I){return Promise.reject(I)}for(y=0,x=p.length;y<x;)f=f.then(p[y++],p[y++]);return f}getUri(t){t=ai(this.defaults,t);const o=kp(t.baseURL,t.url,t.allowAbsoluteUrls);return vp(o,t.params,t.paramsSerializer)}};ge.forEach(["delete","get","head","options"],function(t){oi.prototype[t]=function(o,i){return this.request(ai(i||{},{method:t,url:o,data:(i||{}).data}))}});ge.forEach(["post","put","patch"],function(t){function o(i){return function(a,l,u){return this.request(ai(u||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}oi.prototype[t]=o(),oi.prototype[t+"Form"]=o(!0)});let H1=class Sp{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(a){o=a});const i=this;this.promise.then(s=>{if(!i._listeners)return;let a=i._listeners.length;for(;a-- >0;)i._listeners[a](s);i._listeners=null}),this.promise.then=s=>{let a;const l=new Promise(u=>{i.subscribe(u),a=u}).then(s);return l.cancel=function(){i.unsubscribe(a)},l},t(function(a,l,u){i.reason||(i.reason=new Ni(a,l,u),o(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const o=this._listeners.indexOf(t);o!==-1&&this._listeners.splice(o,1)}toAbortSignal(){const t=new AbortController,o=i=>{t.abort(i)};return this.subscribe(o),t.signal.unsubscribe=()=>this.unsubscribe(o),t.signal}static source(){let t;return{token:new Sp(function(s){t=s}),cancel:t}}};function V1(e){return function(o){return e.apply(null,o)}}function G1(e){return ge.isObject(e)&&e.isAxiosError===!0}const Mc={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Mc).forEach(([e,t])=>{Mc[t]=e});function xp(e){const t=new oi(e),o=op(oi.prototype.request,t);return ge.extend(o,oi.prototype,t,{allOwnKeys:!0}),ge.extend(o,t,null,{allOwnKeys:!0}),o.create=function(s){return xp(ai(e,s))},o}const Ft=xp(Ga);Ft.Axios=oi;Ft.CanceledError=Ni;Ft.CancelToken=H1;Ft.isCancel=yp;Ft.VERSION=Lp;Ft.toFormData=gl;Ft.AxiosError=dt;Ft.Cancel=Ft.CanceledError;Ft.all=function(t){return Promise.all(t)};Ft.spread=V1;Ft.isAxiosError=G1;Ft.mergeConfig=ai;Ft.AxiosHeaders=$n;Ft.formToJSON=e=>gp(ge.isHTMLForm(e)?new FormData(e):e);Ft.getAdapter=Cp.getAdapter;Ft.HttpStatusCode=Mc;Ft.default=Ft;const{Axios:d8,AxiosError:h8,CanceledError:f8,isCancel:p8,CancelToken:v8,VERSION:m8,all:g8,Cancel:y8,isAxiosError:_8,spread:k8,toFormData:b8,AxiosHeaders:w8,HttpStatusCode:C8,formToJSON:L8,getAdapter:S8,mergeConfig:x8}=Ft,Z1="https://sterobson-volunteercheckin-testing.azurewebsites.net/api",j1="VolunteerCheckinOffline",W1=1;let io=null;async function os(){return io||new Promise((e,t)=>{const o=indexedDB.open(j1,W1);o.onerror=()=>{console.error("Failed to open IndexedDB:",o.error),t(o.error)},o.onsuccess=()=>{io=o.result,e(io)},o.onupgradeneeded=i=>{const s=i.target.result;s.objectStoreNames.contains("eventData")||s.createObjectStore("eventData",{keyPath:"eventId"}),s.objectStoreNames.contains("pendingActions")||s.createObjectStore("pendingActions",{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),s.objectStoreNames.contains("syncMeta")||s.createObjectStore("syncMeta",{keyPath:"key"})}})}async function Da(e,t){return await os(),new Promise((o,i)=>{const s=io.transaction(["eventData","syncMeta"],"readwrite"),a=s.objectStore("eventData"),l=s.objectStore("syncMeta"),u={eventId:e,...t,cachedAt:new Date().toISOString()};a.put(u),l.put({key:`lastSync_${e}`,value:new Date().toISOString()}),s.oncomplete=()=>o(),s.onerror=()=>i(s.error)})}async function xs(e){return await os(),new Promise((t,o)=>{const a=io.transaction(["eventData"],"readonly").objectStore("eventData").get(e);a.onsuccess=()=>t(a.result||null),a.onerror=()=>o(a.error)})}async function ha(e,t,o){const i=await xs(e);i&&(i[t]=o,i.cachedAt=new Date().toISOString(),await Da(e,i))}async function q1(e){return await os(),new Promise((t,o)=>{const s=io.transaction(["pendingActions"],"readwrite").objectStore("pendingActions"),a={...e,createdAt:new Date().toISOString(),attempts:0,lastAttempt:null,status:"pending"},l=s.add(a);l.onsuccess=()=>t(l.result),l.onerror=()=>o(l.error)})}async function Tp(){return await os(),new Promise((e,t)=>{const a=io.transaction(["pendingActions"],"readonly").objectStore("pendingActions").index("createdAt").getAll();a.onsuccess=()=>{const l=a.result.filter(u=>u.status==="pending"||u.status==="retrying");e(l)},a.onerror=()=>t(a.error)})}async function jr(){return(await Tp()).length}async function ah(e,t){return await os(),new Promise((o,i)=>{const s=io.transaction(["pendingActions"],"readwrite"),a=s.objectStore("pendingActions"),l=a.get(e);l.onsuccess=()=>{const u=l.result;u&&(Object.assign(u,t),a.put(u))},s.oncomplete=()=>o(),s.onerror=()=>i(s.error)})}async function rh(e){return await os(),new Promise((t,o)=>{const a=io.transaction(["pendingActions"],"readwrite").objectStore("pendingActions").delete(e);a.onsuccess=()=>t(),a.onerror=()=>o(a.error)})}async function K1(e){return await os(),new Promise((t,o)=>{const a=io.transaction(["syncMeta"],"readonly").objectStore("syncMeta").get(`lastSync_${e}`);a.onsuccess=()=>t(a.result?.value||null),a.onerror=()=>o(a.error)})}const He=Ft.create({baseURL:Z1,headers:{"Content-Type":"application/json"},timeout:15e3});let Ac=!1;async function Y1(){}function lh(e){const t=[/\/events\/([^/]+)/,/\/assignments\/([^/]+)/,/\/locations\/([^/]+)/,/\/checklist-items\/([^/]+)/,/\/areas\/([^/]+)/,/\/marshals\/([^/]+)/];for(const o of t){const i=e.match(o);if(i)return i[1]}return null}function J1(e){return!!(!e.response&&e.request||e.response&&e.response.status>=500||e.code==="ECONNABORTED")}He.interceptors.request.use(e=>{const t=localStorage.getItem("adminEmail");t&&(e.headers["X-Admin-Email"]=t);const o=localStorage.getItem("sessionToken");return o&&(e.headers.Authorization=`Bearer ${o}`),e});let Ec=0;const X1=2;function Q1(){if(Ec++,Ec>=X1){localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken");const e=window.location.hash||"";!e.includes("/login")&&!e.includes("/verify")&&(window.location.href="/VolunteerCheckin/testing/#/admin/login")}}function ek(){Ec=0}He.interceptors.response.use(e=>{Ac=!1,ek();const t=e.config.url,o=lh(t);return e.config.method,e},async e=>{const t=e.config;if(e.response&&(e.response.status===401||e.response.status===403))return Q1(),Promise.reject(e);if(J1(e)&&(Ac=!0,t.method==="get")){const o=lh(t.url);if(o){const i=await xs(o);if(i)return console.log("Returning cached data for:",t.url),Promise.resolve({data:i,status:200,statusText:"OK (cached)",headers:{},config:t,cached:!0})}}return Promise.reject(e)});async function Dn(e,t,o){return await q1({type:e,payload:t,eventId:t.eventId}),await Y1(),{data:o,status:200,statusText:"OK (queued)",queued:!0}}function sn(){return Ac||!navigator.onLine}const Io={requestLogin:e=>He.post("/auth/request-login",{email:e}),verifyToken:e=>He.post("/auth/verify-token",{token:e}),instantLogin:e=>He.post("/auth/instant-login",{email:e}),createAdmin:e=>He.post("/auth/create-admin",{email:e}),marshalLogin:(e,t)=>He.post("/auth/marshal-login",{eventId:e,magicCode:t}),getMe:e=>He.get("/auth/me",{params:{eventId:e}}),logout:()=>He.post("/auth/logout")},wr={getProfile:()=>He.get("/auth/profile"),updateProfile:e=>He.put("/auth/profile",e),getPerson:(e,t)=>He.get(`/people/${e}`,{params:{eventId:t}}),updatePerson:(e,t,o)=>He.put(`/people/${e}`,o,{params:{eventId:t}})},qs={create:e=>He.post("/events",e),getAll:()=>He.get("/events"),getById:e=>He.get(`/events/${e}`),update:(e,t)=>He.put(`/events/${e}`,t),delete:e=>He.delete(`/events/${e}`),uploadGpx:(e,t)=>{const o=new FormData;return o.append("gpx",t),He.post(`/events/${e}/upload-gpx`,o,{headers:{"Content-Type":"multipart/form-data"}})}},xn={create:e=>He.post("/locations",e),getById:(e,t)=>He.get(`/locations/${e}/${t}`),getByEvent:e=>He.get(`/events/${e}/locations`),update:(e,t,o)=>He.put(`/locations/${e}/${t}`,o),delete:(e,t)=>He.delete(`/locations/${e}/${t}`),importCsv:(e,t,o)=>{const i=new FormData;return i.append("csv",t),He.post(`/locations/import/${e}?deleteExisting=${o}`,i,{headers:{"Content-Type":"multipart/form-data"}})},bulkUpdateTimes:(e,t)=>He.post(`/locations/bulk-update-times/${e}`,{timeDelta:t}),updatePosition:(e,t,o)=>He.post(`/locations/${e}/${t}/update-position`,o),getDynamicCheckpoints:e=>He.get(`/events/${e}/dynamic-checkpoints`)},fa={create:e=>He.post("/assignments",e),getById:(e,t)=>He.get(`/assignments/${e}/${t}`),getByEvent:e=>He.get(`/assignments/event/${e}`),delete:(e,t)=>He.delete(`/assignments/${e}/${t}`),getEventStatus:e=>He.get(`/events/${e}/status`)},Ko={checkIn:e=>He.post("/checkin",e),adminCheckIn:(e,t)=>He.post(`/checkin/admin/${e}/${t}`)},ac={getAdmins:e=>He.get(`/events/${e}/admins`),addAdmin:(e,t)=>He.post(`/events/${e}/admins`,{userEmail:t}),removeAdmin:(e,t)=>He.delete(`/events/${e}/admins/${t}`)},$o={create:e=>He.post("/marshals",e),getByEvent:e=>He.get(`/events/${e}/marshals`),getById:(e,t)=>He.get(`/marshals/${e}/${t}`),update:(e,t,o)=>He.put(`/marshals/${e}/${t}`,o),delete:(e,t)=>He.delete(`/marshals/${e}/${t}`),getMagicLink:(e,t)=>He.get(`/marshals/${e}/${t}/magic-link`),sendMagicLink:(e,t)=>He.post(`/marshals/${e}/${t}/send-magic-link`),importCsv:(e,t)=>{const o=new FormData;return o.append("csv",t),He.post(`/marshals/import/${e}`,o,{headers:{"Content-Type":"multipart/form-data"}})}},Cs={create:e=>He.post("/areas",e),getByEvent:e=>He.get(`/events/${e}/areas`),getById:(e,t)=>He.get(`/areas/${e}/${t}`),update:(e,t,o)=>He.put(`/areas/${e}/${t}`,o),delete:(e,t)=>He.delete(`/areas/${e}/${t}`),recalculate:e=>He.post(`/areas/recalculate/${e}`),getCheckpoints:(e,t)=>He.get(`/areas/${e}/${t}/locations`),getAreaLeadDashboard:e=>He.get(`/events/${e}/area-lead-dashboard`)},Et={create:(e,t)=>He.post(`/events/${e}/checklist-items`,t),getByEvent:e=>He.get(`/events/${e}/checklist-items`),getById:(e,t)=>He.get(`/checklist-items/${e}/${t}`),update:(e,t,o)=>He.put(`/checklist-items/${e}/${t}`,o),delete:(e,t)=>He.delete(`/checklist-items/${e}/${t}`),getReport:e=>He.get(`/events/${e}/checklist-report`),getMarshalChecklist:(e,t)=>He.get(`/events/${e}/marshals/${t}/checklist`),getCheckpointChecklist:(e,t)=>He.get(`/events/${e}/locations/${t}/checklist`),getAreaChecklist:(e,t)=>He.get(`/events/${e}/areas/${t}/checklist`),complete:(e,t,o)=>He.post(`/checklist-items/${e}/${t}/complete`,o),uncomplete:(e,t,o)=>He.post(`/checklist-items/${e}/${t}/uncomplete`,o)},Go={create:(e,t)=>He.post(`/events/${e}/notes`,t),getByEvent:e=>He.get(`/events/${e}/notes`),getById:(e,t)=>He.get(`/events/${e}/notes/${t}`),update:(e,t,o)=>He.put(`/events/${e}/notes/${t}`,o),delete:(e,t)=>He.delete(`/events/${e}/notes/${t}`),getMarshalNotes:(e,t)=>He.get(`/events/${e}/marshals/${t}/notes`),getMyNotes:e=>He.get(`/events/${e}/my-notes`)},Ci={create:(e,t)=>He.post(`/events/${e}/contacts`,t),getByEvent:e=>He.get(`/events/${e}/contacts`),getById:(e,t)=>He.get(`/events/${e}/contacts/${t}`),update:(e,t,o)=>He.put(`/events/${e}/contacts/${t}`,o),delete:(e,t)=>He.delete(`/events/${e}/contacts/${t}`),getRoles:e=>He.get(`/events/${e}/contact-roles`),getMarshalContacts:(e,t)=>He.get(`/events/${e}/marshals/${t}/contacts`),getMyContacts:e=>He.get(`/events/${e}/my-contacts`)},Za=ou("auth",()=>{const e=D(localStorage.getItem("adminEmail")||null),t=D(!!e.value),o=D(!1);return{adminEmail:e,isAuthenticated:t,loginPending:o,requestLogin:async u=>{const h=await Io.requestLogin(u);return h.data.success&&(o.value=!0),h.data},verifyToken:async u=>{const h=await Io.verifyToken(u);return h.data.success&&(e.value=h.data.person?.email,t.value=!0,o.value=!1,localStorage.setItem("adminEmail",h.data.person?.email),localStorage.setItem("sessionToken",h.data.sessionToken)),h.data},instantLogin:async u=>{const h=await Io.instantLogin(u);return h.data.success&&(e.value=h.data.email,t.value=!0,localStorage.setItem("adminEmail",h.data.email),h.data.sessionToken&&localStorage.setItem("sessionToken",h.data.sessionToken)),h.data},logout:async()=>{try{await Io.logout()}catch{}e.value=null,t.value=!1,o.value=!1,localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken")}}}),tk={class:"admin-login"},nk={class:"login-card"},ok={key:0,class:"email-sent"},sk={class:"form-group"},ik=["disabled"],ak={key:0,class:"error"},rk={__name:"AdminLogin",setup(e){const t=Za(),o=D(""),i=D(!1),s=D(null),a=D(!1),l=async()=>{i.value=!0,s.value=null;try{const h=await t.requestLogin(o.value);h.success?a.value=!0:s.value=h.message||"Failed to send login link. Please try again."}catch{s.value="Failed to send login link. Please try again."}finally{i.value=!1}},u=()=>{o.value="",a.value=!1,s.value=null};return(h,p)=>{const f=rl("router-link");return m(),g("div",tk,[c("div",nk,[p[7]||(p[7]=c("h2",null,"Admin login",-1)),a.value?(m(),g("div",ok,[p[2]||(p[2]=c("div",{class:"check-icon"},"",-1)),p[3]||(p[3]=c("h3",null,"Check your email!",-1)),c("p",null,[p[1]||(p[1]=Ze("We've sent a login link to ",-1)),c("strong",null,b(o.value),1)]),p[4]||(p[4]=c("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),c("button",{onClick:u,class:"btn btn-secondary"}," Use a different email ")])):(m(),g(Ce,{key:1},[p[5]||(p[5]=c("p",{class:"instruction"},"Enter your email to receive a login link",-1)),c("form",{onSubmit:vt(l,["prevent"])},[c("div",sk,[je(c("input",{"onUpdate:modelValue":p[0]||(p[0]=y=>o.value=y),type:"email",placeholder:"admin@example.com",required:"",class:"form-input"},null,512),[[ut,o.value]])]),c("button",{type:"submit",class:"btn btn-primary",disabled:i.value},b(i.value?"Sending...":"Send login link"),9,ik)],32),s.value?(m(),g("div",ak,b(s.value),1)):N("",!0)],64)),ze(f,{to:"/",class:"back-link"},{default:nt(()=>[...p[6]||(p[6]=[Ze(" Back to Home",-1)])]),_:1})])])}}},lk=Je(rk,[["__scopeId","data-v-1eafb4d9"]]),ck={class:"admin-verify"},uk={class:"verify-card"},dk={key:0,class:"status"},hk={key:1,class:"status error"},fk={key:2,class:"status success"},pk={__name:"AdminVerify",setup(e){const t=Ua(),o=au(),i=Za(),s=D(!0),a=D(null);return un(async()=>{const l=o.query.token;if(!l){a.value="No login token provided. Please request a new login link.",s.value=!1;return}try{const u=await i.verifyToken(l);u.success?setTimeout(()=>{t.push({name:"AdminDashboard"})},1e3):a.value=u.message||"Invalid or expired login link. Please request a new one."}catch(u){console.error("Verification error:",u),a.value="Failed to verify login. Please try again."}finally{s.value=!1}}),(l,u)=>{const h=rl("router-link");return m(),g("div",ck,[c("div",uk,[s.value?(m(),g("div",dk,[...u[0]||(u[0]=[c("div",{class:"spinner"},null,-1),c("h2",null,"Verifying your login...",-1),c("p",null,"Please wait while we confirm your identity.",-1)])])):a.value?(m(),g("div",hk,[u[2]||(u[2]=c("h2",null,"Login failed",-1)),c("p",null,b(a.value),1),ze(h,{to:"/admin/login",class:"btn btn-primary"},{default:nt(()=>[...u[1]||(u[1]=[Ze(" Try again ",-1)])]),_:1})])):(m(),g("div",fk,[...u[3]||(u[3]=[c("h2",null,"Login successful!",-1),c("p",null,"Redirecting to dashboard...",-1)])]))])])}}},vk=Je(pk,[["__scopeId","data-v-5012f94a"]]),Ip=ou("events",()=>{const e=D([]),t=D(null),o=D([]),i=D([]),s=D(null),a=D(!1),l=D(null),u=async()=>{a.value=!0,l.value=null;try{const w=await qs.getAll();e.value=w.data}catch(w){throw l.value=w.message,w}finally{a.value=!1}},h=async w=>{a.value=!0,l.value=null;try{const A=await qs.getById(w);t.value=A.data}catch(A){throw l.value=A.message,A}finally{a.value=!1}},p=async w=>{a.value=!0,l.value=null;try{const A=await qs.create(w);return e.value.push(A.data),A.data}catch(A){throw l.value=A.message,A}finally{a.value=!1}},f=async(w,A)=>{a.value=!0,l.value=null;try{const ne=await qs.update(w,A),ae=e.value.findIndex(_e=>_e.id===w);return ae!==-1&&(e.value[ae]=ne.data),t.value?.id===w&&(t.value=ne.data),ne.data}catch(ne){throw l.value=ne.message,ne}finally{a.value=!1}},y=async w=>{a.value=!0,l.value=null;try{await qs.delete(w),e.value=e.value.filter(A=>A.id!==w)}catch(A){throw l.value=A.message,A}finally{a.value=!1}},x=async w=>{a.value=!0,l.value=null;try{const A=await xn.getByEvent(w);o.value=A.data}catch(A){throw l.value=A.message,A}finally{a.value=!1}};return{events:e,currentEvent:t,locations:o,assignments:i,eventStatus:s,loading:a,error:l,fetchEvents:u,fetchEvent:h,createEvent:p,updateEvent:f,deleteEvent:y,fetchLocations:x,createLocation:async w=>{a.value=!0,l.value=null;try{const A=await xn.create(w);return o.value.push(A.data),A.data}catch(A){throw l.value=A.message,A}finally{a.value=!1}},updateLocation:async(w,A,ne)=>{a.value=!0,l.value=null;try{const ae=await xn.update(w,A,ne),_e=o.value.findIndex(re=>re.id===A);return _e!==-1&&(o.value[_e]=ae.data),ae.data}catch(ae){throw l.value=ae.message,ae}finally{a.value=!1}},deleteLocation:async(w,A)=>{a.value=!0,l.value=null;try{await xn.delete(w,A),o.value=o.value.filter(ne=>ne.id!==A)}catch(ne){throw l.value=ne.message,ne}finally{a.value=!1}},bulkUpdateLocationTimes:async(w,A)=>{a.value=!0,l.value=null;try{const ne=await xn.bulkUpdateTimes(w,A);return await x(w),ne.data}catch(ne){throw l.value=ne.message,ne}finally{a.value=!1}},fetchAssignments:async w=>{a.value=!0,l.value=null;try{const A=await fa.getByEvent(w);i.value=A.data}catch(A){throw l.value=A.message,A}finally{a.value=!1}},createAssignment:async w=>{a.value=!0,l.value=null;try{const A=await fa.create(w);return i.value.push(A.data),A.data}catch(A){throw l.value=A.message,A}finally{a.value=!1}},deleteAssignment:async(w,A)=>{a.value=!0,l.value=null;try{await fa.delete(w,A),i.value=i.value.filter(ne=>ne.id!==A)}catch(ne){throw l.value=ne.message,ne}finally{a.value=!1}},fetchEventStatus:async w=>{a.value=!0,l.value=null;try{const A=await fa.getEventStatus(w);return s.value=A.data,A.data}catch(A){throw l.value=A.message,A}finally{a.value=!1}},updateAssignmentCheckIn:w=>{const A=i.value.findIndex(ne=>ne.id===w.id);A!==-1&&(i.value[A]=w),s.value&&s.value.locations.forEach(ne=>{const ae=ne.assignments.findIndex(_e=>_e.id===w.id);ae!==-1&&(ne.assignments[ae]=w,ne.checkedInCount=ne.assignments.filter(_e=>_e.isCheckedIn).length)})}}}),mk={class:"confirm-modal"},gk={class:"confirm-actions"},yk={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"}},emits:["confirm","cancel"],setup(e,{emit:t}){const o=t,i=()=>{o("confirm")},s=()=>{o("cancel")};return(a,l)=>e.show?(m(),g("div",{key:0,class:"modal-overlay",onClick:vt(s,["self"])},[c("div",mk,[c("h3",null,b(e.title),1),c("p",null,b(e.message),1),c("div",gk,[c("button",{onClick:s,class:"btn btn-secondary"},b(e.cancelText),1),c("button",{onClick:i,class:"btn btn-primary"},b(e.confirmText),1)])])])):N("",!0)}},_l=Je(yk,[["__scopeId","data-v-8fc7605e"]]),_k={class:"base-modal-header"},kk={key:0,class:"base-modal-title"},bk={key:0,class:"base-modal-tab-header"},wk={class:"base-modal-body"},Ck={key:1,class:"base-modal-footer"},Lk={key:0,class:"base-modal-actions"},Sk={__name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},variant:{type:String,default:"center",validator:e=>["center","sidebar"].includes(e)},zIndex:{type:Number,default:1e3},closeOnOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},confirmOnClose:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=e,i=t,s=D(!1),a=D(!1),l=()=>{o.closeOnOverlay&&u()},u=()=>{o.confirmOnClose&&o.isDirty?s.value=!0:i("close")},h=()=>{s.value=!1,i("close")},p=()=>{s.value=!1};return(f,y)=>e.show?(m(),g("div",{key:0,class:"base-modal-overlay",style:at({zIndex:e.zIndex}),onClick:vt(l,["self"])},[c("div",{class:Te(["base-modal",[`base-modal--${e.size}`,`base-modal--${e.variant}`]])},[c("div",_k,[aa(f.$slots,"header",{},()=>[e.title?(m(),g("h2",kk,b(e.title),1)):N("",!0)]),e.showCloseButton?(m(),g("button",{key:0,onClick:u,class:"base-modal-close",type:"button","aria-label":"Close"},"  ")):N("",!0)]),f.$slots["tab-header"]?(m(),g("div",bk,[aa(f.$slots,"tab-header",{},void 0)])):N("",!0),c("div",wk,[aa(f.$slots,"default",{},void 0)]),f.$slots.footer||f.$slots.actions?(m(),g("div",Ck,[aa(f.$slots,"footer",{},()=>[f.$slots.actions?(m(),g("div",Lk,[aa(f.$slots,"actions",{},void 0,!0)])):N("",!0)])])):N("",!0)],2),e.confirmOnClose&&!a.value?(m(),rt(_l,{key:0,show:s.value,title:"Unsaved changes",message:"You have unsaved changes. Are you sure you want to close?",onConfirm:h,onCancel:p},null,8,["show"])):N("",!0)],4)):N("",!0)}},Ut=Je(Sk,[["__scopeId","data-v-3c947aaa"]]);function $p(e="details",t=[]){const o=D(e),i=y=>{o.value=y},s=()=>{o.value=e},a=y=>o.value===y,l=X(()=>t.length===0?-1:t.indexOf(o.value)),u=(y=!1)=>{if(t.length===0)return;const x=l.value;if(x===-1)return;const T=x+1;T<t.length?o.value=t[T]:y&&(o.value=t[0])},h=(y=!1)=>{if(t.length===0)return;const x=l.value;if(x===-1)return;const T=x-1;T>=0?o.value=t[T]:y&&(o.value=t[t.length-1])},p=X(()=>{if(t.length===0)return!1;const y=l.value;return y!==-1&&y<t.length-1}),f=X(()=>t.length===0?!1:l.value>0);return{activeTab:o,activeTabIndex:l,hasNextTab:p,hasPreviousTab:f,switchTab:i,resetTab:s,isActiveTab:a,nextTab:u,previousTab:h}}const Mp=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET/CEST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Australia/Sydney",label:"Sydney (AEDT/AEST)"}],xk={class:"tabs"},Tk={class:"tab-content"},Ik={class:"form-group"},$k={class:"form-group"},Mk={class:"form-group"},Ak={class:"form-group"},Ek=["value"],Pk={class:"tab-content"},Dk={class:"emergency-contacts-section"},Ok={key:0,class:"empty-state"},Rk={class:"card-header"},Bk=["onClick"],Nk={class:"form-group"},Fk=["onUpdate:modelValue"],Uk={class:"form-group"},zk=["onUpdate:modelValue"],Hk={class:"form-group"},Vk=["onUpdate:modelValue"],Gk={__name:"EventFormModal",props:{show:{type:Boolean,default:!1},eventData:{type:Object,default:()=>({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]})},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const o=e,i=t,{activeTab:s,switchTab:a,resetTab:l}=$p("basic",["basic","emergency"]),u=D({...o.eventData});We(()=>o.eventData,x=>{u.value={...x},u.value.emergencyContacts||(u.value.emergencyContacts=[])},{deep:!0}),We(()=>o.show,x=>{x&&l()});const h=()=>{u.value.emergencyContacts.push({name:"",phone:"",details:""})},p=x=>{u.value.emergencyContacts.splice(x,1)},f=()=>{i("submit",{...u.value})},y=()=>{i("close")};return(x,T)=>(m(),rt(Ut,{show:e.show,title:e.isEditing?"Edit event":"Create new event",size:"large",onClose:y},{"tab-header":nt(()=>[c("div",xk,[c("button",{type:"button",onClick:T[0]||(T[0]=I=>z(a)("basic")),class:Te(["tab-button",{active:z(s)==="basic"}])}," Basic details ",2),c("button",{type:"button",onClick:T[1]||(T[1]=I=>z(a)("emergency")),class:Te(["tab-button",{active:z(s)==="emergency"}])}," Emergency contacts ",2)])]),actions:nt(()=>[c("button",{type:"button",onClick:y,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:f,class:"btn btn-primary"},b(e.isEditing?"Update":"Create"),1)]),default:nt(()=>[c("form",{onSubmit:vt(f,["prevent"])},[je(c("div",Tk,[c("div",Ik,[T[6]||(T[6]=c("label",null,"Event name *",-1)),je(c("input",{"onUpdate:modelValue":T[2]||(T[2]=I=>u.value.name=I),type:"text",required:"",class:"form-input"},null,512),[[ut,u.value.name]])]),c("div",$k,[T[7]||(T[7]=c("label",null,"Description",-1)),je(c("textarea",{"onUpdate:modelValue":T[3]||(T[3]=I=>u.value.description=I),rows:"3",class:"form-input"},null,512),[[ut,u.value.description]])]),c("div",Mk,[T[8]||(T[8]=c("label",null,"Event date *",-1)),je(c("input",{"onUpdate:modelValue":T[4]||(T[4]=I=>u.value.eventDate=I),type:"datetime-local",required:"",class:"form-input"},null,512),[[ut,u.value.eventDate]])]),c("div",Ak,[T[9]||(T[9]=c("label",null,"Time zone *",-1)),je(c("select",{"onUpdate:modelValue":T[5]||(T[5]=I=>u.value.timeZoneId=I),required:"",class:"form-input"},[(m(!0),g(Ce,null,Be(z(Mp),I=>(m(),g("option",{key:I.value,value:I.value},b(I.label),9,Ek))),128))],512),[[Sn,u.value.timeZoneId]])])],512),[[Is,z(s)==="basic"]]),je(c("div",Pk,[c("div",Dk,[c("div",{class:"section-header-small"},[T[10]||(T[10]=c("h3",null,"Emergency contacts",-1)),c("button",{type:"button",onClick:h,class:"btn btn-small btn-primary"}," + Add contact ")]),u.value.emergencyContacts.length===0?(m(),g("div",Ok,[...T[11]||(T[11]=[c("p",null,'No emergency contacts added yet. Click "Add contact" to add one.',-1)])])):N("",!0),(m(!0),g(Ce,null,Be(u.value.emergencyContacts,(I,S)=>(m(),g("div",{key:S,class:"emergency-contact-card"},[c("div",Rk,[c("h4",null,"Contact "+b(S+1),1),c("button",{type:"button",onClick:R=>p(S),class:"btn-remove"},"  ",8,Bk)]),c("div",Nk,[T[12]||(T[12]=c("label",null,"Name *",-1)),je(c("input",{"onUpdate:modelValue":R=>I.name=R,type:"text",required:"",class:"form-input",placeholder:"Contact person name"},null,8,Fk),[[ut,I.name]])]),c("div",Uk,[T[13]||(T[13]=c("label",null,"Phone *",-1)),je(c("input",{"onUpdate:modelValue":R=>I.phone=R,type:"tel",required:"",class:"form-input",placeholder:"+1 (555) 123-4567"},null,8,zk),[[ut,I.phone]])]),c("div",Hk,[T[14]||(T[14]=c("label",null,"Additional details",-1)),je(c("textarea",{"onUpdate:modelValue":R=>I.details=R,rows:"2",class:"form-input",placeholder:"Role, availability, or other important information..."},null,8,Vk),[[ut,I.details]])])]))),128))])],512),[[Is,z(s)==="emergency"]])],32)]),_:1},8,["show","title"]))}},Zk=Je(Gk,[["__scopeId","data-v-9d79dd39"]]),jk={class:"admin-dashboard"},Wk={class:"header"},qk={class:"header-actions"},Kk={class:"user-email"},Yk={class:"container"},Jk={class:"section"},Xk={class:"section-header"},Qk={key:0,class:"loading"},eb={key:1,class:"empty"},tb={key:2,class:"events-grid"},nb=["onClick"],ob={class:"event-date"},sb={class:"event-desc"},ib={class:"event-actions"},ab=["onClick"],rb=["onClick"],lb={__name:"AdminDashboard",setup(e){const t=Ua(),o=Za(),i=Ip(),s=D(!0),a=D(!1),l=D(null),u=D({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}),h=D([]),p=D(!1),f=D(""),y=D(""),x=D(null),T=async()=>{s.value=!0;try{await i.fetchEvents(),h.value=i.events}catch(ae){console.error("Failed to load events:",ae)}finally{s.value=!1}},I=async ae=>{try{const _e={...ae,adminEmail:o.adminEmail};l.value?await i.updateEvent(l.value.id,_e):await i.createEvent(_e),h.value=i.events,_()}catch(_e){console.error("Failed to save event:",_e),alert("Failed to save event. Please try again.")}},S=ae=>{l.value=ae,u.value={name:ae.name,description:ae.description,eventDate:ne(ae.eventDate),timeZoneId:ae.timeZoneId||"UTC",emergencyContacts:ae.emergencyContacts?JSON.parse(JSON.stringify(ae.emergencyContacts)):[]}},R=async ae=>{f.value="Delete event",y.value=`Are you sure you want to delete "${ae.name}"?`,x.value=async()=>{try{await i.deleteEvent(ae.id),h.value=i.events}catch(_e){console.error("Failed to delete event:",_e),alert("Failed to delete event. Please try again.")}},p.value=!0},E=()=>{p.value=!1,x.value&&(x.value(),x.value=null)},M=()=>{p.value=!1,x.value=null},_=()=>{a.value=!1,l.value=null,u.value={name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}},$=ae=>{if(!ae){console.error("Cannot navigate to event: eventId is undefined");return}t.push({name:"AdminEventManage",params:{eventId:ae}})},k=()=>{t.push({name:"AdminProfile"})},w=()=>{o.logout(),t.push({name:"Home"})},A=ae=>new Date(ae).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),ne=ae=>{const _e=new Date(ae),re=_e.getFullYear(),ve=String(_e.getMonth()+1).padStart(2,"0"),Ie=String(_e.getDate()).padStart(2,"0"),Re=String(_e.getHours()).padStart(2,"0"),xe=String(_e.getMinutes()).padStart(2,"0");return`${re}-${ve}-${Ie}T${Re}:${xe}`};return un(()=>{T()}),(ae,_e)=>(m(),g("div",jk,[c("header",Wk,[_e[1]||(_e[1]=c("h1",null,"Admin dashboard",-1)),c("div",qk,[c("span",Kk,b(z(o).adminEmail),1),c("button",{onClick:k,class:"btn btn-secondary"},"Profile"),c("button",{onClick:w,class:"btn btn-secondary"},"Logout")])]),c("div",Yk,[c("div",Jk,[c("div",Xk,[_e[2]||(_e[2]=c("h2",null,"Your events",-1)),c("button",{onClick:_e[0]||(_e[0]=re=>a.value=!0),class:"btn btn-primary"}," Create new event ")]),s.value?(m(),g("div",Qk,"Loading events...")):h.value.length===0?(m(),g("div",eb,[..._e[3]||(_e[3]=[c("p",null,"No events yet. Create your first event to get started!",-1)])])):(m(),g("div",tb,[(m(!0),g(Ce,null,Be(h.value,re=>(m(),g("div",{key:re.id,class:"event-card",onClick:ve=>$(re.id)},[c("h3",null,b(re.name),1),c("p",ob,b(A(re.eventDate)),1),c("p",sb,b(re.description),1),c("div",ib,[c("button",{onClick:vt(ve=>S(re),["stop"]),class:"btn btn-small btn-secondary"}," Edit ",8,ab),c("button",{onClick:vt(ve=>R(re),["stop"]),class:"btn btn-small btn-danger"}," Delete ",8,rb)])],8,nb))),128))]))])]),ze(Zk,{show:a.value||!!l.value,"event-data":u.value,"is-editing":!!l.value,onClose:_,onSubmit:I},null,8,["show","event-data","is-editing"]),ze(_l,{show:p.value,title:f.value,message:y.value,onConfirm:E,onCancel:M},null,8,["show","title","message"])]))}},cb=Je(lb,[["__scopeId","data-v-ec6b84bf"]]),ub=ou("profile",()=>{const e=D(null),t=D(!1),o=D(null);return{profile:e,loading:t,error:o,fetchProfile:async()=>{t.value=!0,o.value=null;try{const h=await wr.getProfile();return e.value=h.data,h.data}catch(h){throw o.value=h.response?.data?.message||"Failed to load profile",h}finally{t.value=!1}},updateProfile:async h=>{t.value=!0,o.value=null;try{const p=await wr.updateProfile(h);return e.value=p.data,p.data}catch(p){throw o.value=p.response?.data?.message||"Failed to update profile",p}finally{t.value=!1}},fetchPerson:async(h,p)=>{t.value=!0,o.value=null;try{return(await wr.getPerson(h,p)).data}catch(f){throw o.value=f.response?.data?.message||"Failed to load person",f}finally{t.value=!1}},updatePerson:async(h,p,f)=>{t.value=!0,o.value=null;try{return(await wr.updatePerson(h,p,f)).data}catch(y){throw o.value=y.response?.data?.message||"Failed to update person",y}finally{t.value=!1}},clearProfile:()=>{e.value=null,o.value=null}}}),db={class:"form-group"},hb={class:"form-group"},fb={class:"form-group"},pb={__name:"EditProfileModal",props:{show:{type:Boolean,default:!1},profile:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=D({name:"",email:"",phone:""});We(()=>o.profile,h=>{h&&(s.value={name:h.name||"",email:h.email||"",phone:h.phone||""})},{immediate:!0,deep:!0}),We(()=>o.show,h=>{h&&o.profile&&(s.value={name:o.profile.name||"",email:o.profile.email||"",phone:o.profile.phone||""})});const a=()=>{i("update:isDirty",!0)},l=()=>{if(!s.value.name.trim()){alert("Name is required");return}if(!s.value.email.trim()){alert("Email is required");return}i("submit",{name:s.value.name.trim(),email:s.value.email.trim(),phone:s.value.phone?.trim()||""})},u=()=>{i("close")};return(h,p)=>(m(),rt(Ut,{show:e.show,title:"Edit profile",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:nt(()=>[c("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:l,class:"btn btn-primary"}," Save changes ")]),default:nt(()=>[c("form",{onSubmit:vt(l,["prevent"])},[c("div",db,[p[3]||(p[3]=c("label",null,"Name *",-1)),je(c("input",{"onUpdate:modelValue":p[0]||(p[0]=f=>s.value.name=f),type:"text",required:"",class:"form-input",placeholder:"Your name",onInput:a},null,544),[[ut,s.value.name]])]),c("div",hb,[p[4]||(p[4]=c("label",null,"Email *",-1)),je(c("input",{"onUpdate:modelValue":p[1]||(p[1]=f=>s.value.email=f),type:"email",required:"",class:"form-input",placeholder:"Your email address",onInput:a},null,544),[[ut,s.value.email]])]),c("div",fb,[p[5]||(p[5]=c("label",null,"Phone",-1)),je(c("input",{"onUpdate:modelValue":p[2]||(p[2]=f=>s.value.phone=f),type:"tel",class:"form-input",placeholder:"Your phone number",onInput:a},null,544),[[ut,s.value.phone]])])],32)]),_:1},8,["show","is-dirty"]))}},vb=Je(pb,[["__scopeId","data-v-9a8cb8be"]]),mb={class:"admin-profile"},gb={class:"header"},yb={class:"header-actions"},_b={class:"user-email"},kb={class:"container"},bb={class:"section"},wb={class:"section-header"},Cb={key:0,class:"loading"},Lb={key:1,class:"error"},Sb={key:2,class:"profile-details"},xb={class:"profile-field"},Tb={class:"field-value"},Ib={class:"profile-field"},$b={class:"field-value"},Mb={class:"profile-field"},Ab={class:"field-value"},Eb={class:"profile-field"},Pb={class:"field-value"},Db={__name:"AdminProfile",setup(e){const t=Ua(),o=Za(),i=ub(),s=D(!1),a=async()=>{try{await i.fetchProfile()}catch(p){console.error("Failed to load profile:",p)}},l=async p=>{try{await i.updateProfile(p),s.value=!1}catch(f){console.error("Failed to save profile:",f),alert("Failed to save profile. Please try again.")}},u=()=>{o.logout(),t.push({name:"Home"})},h=()=>{t.push({name:"AdminDashboard"})};return un(()=>{a()}),(p,f)=>(m(),g("div",mb,[c("header",gb,[f[2]||(f[2]=c("h1",null,"My profile",-1)),c("div",yb,[c("span",_b,b(z(o).adminEmail),1),c("button",{onClick:u,class:"btn btn-secondary"},"Logout")])]),c("div",kb,[c("div",bb,[c("div",wb,[f[3]||(f[3]=c("h2",null,"Profile information",-1)),c("button",{onClick:f[0]||(f[0]=y=>s.value=!0),class:"btn btn-primary"}," Edit profile ")]),z(i).loading?(m(),g("div",Cb,"Loading profile...")):z(i).error?(m(),g("div",Lb,[c("p",null,b(z(i).error),1),c("button",{onClick:a,class:"btn btn-secondary"},"Retry")])):z(i).profile?(m(),g("div",Sb,[c("div",xb,[f[4]||(f[4]=c("label",null,"Name",-1)),c("div",Tb,b(z(i).profile.name||""),1)]),c("div",Ib,[f[5]||(f[5]=c("label",null,"Email",-1)),c("div",$b,b(z(i).profile.email||""),1)]),c("div",Mb,[f[6]||(f[6]=c("label",null,"Phone",-1)),c("div",Ab,b(z(i).profile.phone||""),1)]),c("div",Eb,[f[7]||(f[7]=c("label",null,"System admin",-1)),c("div",Pb,[c("span",{class:Te(["badge",z(i).profile.isSystemAdmin?"badge-success":"badge-secondary"])},b(z(i).profile.isSystemAdmin?"Yes":"No"),3)])])])):N("",!0)]),c("div",{class:"section"},[c("button",{onClick:h,class:"btn btn-secondary"}," Back to Dashboard ")])]),ze(vb,{show:s.value,profile:z(i).profile,onClose:f[1]||(f[1]=y=>s.value=!1),onSubmit:l},null,8,["show","profile"])]))}},Ob=Je(Db,[["__scopeId","data-v-4d07684c"]]);function Rb(){const e=D(!1),t=D(""),o=D(""),i=D(null);return{showConfirmModal:e,confirmModalTitle:t,confirmModalMessage:o,showConfirm:(h,p,f)=>{t.value=h,o.value=p,i.value=f,e.value=!0},handleConfirmModalConfirm:()=>{e.value=!1,i.value&&(i.value(),i.value=null)},handleConfirmModalCancel:()=>{e.value=!1,i.value=null},closeConfirmModal:()=>{e.value=!1,i.value=null}}}const Li=D({people:"Marshals",checkpoint:"Checkpoints",area:"Areas",checklist:"Checklists",course:"Course"}),Yo={people:{People:{singular:"Person",plural:"People"},Marshals:{singular:"Marshal",plural:"Marshals"},Volunteers:{singular:"Volunteer",plural:"Volunteers"},Helpers:{singular:"Helper",plural:"Helpers"},Staff:{singular:"Staff member",plural:"Staff"},Stewards:{singular:"Steward",plural:"Stewards"},"Team members":{singular:"Team member",plural:"Team members"},Drivers:{singular:"Driver",plural:"Drivers"},Pilots:{singular:"Pilot",plural:"Pilots"}},checkpoint:{Checkpoints:{singular:"Checkpoint",plural:"Checkpoints"},Stations:{singular:"Station",plural:"Stations"},Locations:{singular:"Location",plural:"Locations"},"Feed stations":{singular:"Feed station",plural:"Feed stations"},"Aid stations":{singular:"Aid station",plural:"Aid stations"},"Water stations":{singular:"Water station",plural:"Water stations"},"Person points":{singular:null,plural:null,dynamic:!0}},area:{Areas:{singular:"Area",plural:"Areas"},Regions:{singular:"Region",plural:"Regions"},Zones:{singular:"Zone",plural:"Zones"}},checklist:{Checklists:{singular:"Checklist",plural:"Checklists"},Tasks:{singular:"Task",plural:"Tasks"},Jobs:{singular:"Job",plural:"Jobs"}},course:{Course:{singular:"Course",plural:"Courses"},Route:{singular:"Route",plural:"Routes"},Track:{singular:"Track",plural:"Tracks"},Trail:{singular:"Trail",plural:"Trails"},Path:{singular:"Path",plural:"Paths"}}},qo={people:["Drivers","Helpers","Marshals","People","Pilots","Staff","Stewards","Team members","Volunteers"],checkpoint:["Aid stations","Checkpoints","Feed stations","Locations","Person points","Stations","Water stations"],area:["Areas","Regions","Zones"],checklist:["Checklists","Jobs","Tasks"],course:["Course","Path","Route","Track","Trail"]};function Ks(e,t,o="Marshals"){if(!t)return"";const i=Yo[e]?.[t];return e==="checkpoint"&&t==="Person points"?`${Yo.people[o]?.singular||"Person"} point`:i?.singular?i.singular:t.endsWith("s")&&!t.endsWith("ss")?t.slice(0,-1):t}function Ap(e,t,o="Marshals"){if(!t)return"";const i=Yo[e]?.[t];return t==="Person points"?`${Yo.people[o]?.singular||"Person"} points`:i?.plural?i.plural:t}function Pc(e,t){return e==="Person points"?`${Yo.people[t]?.singular||"Person"} points`:e}function Dc(e){e&&(Li.value={people:e.peopleTerm||"Marshals",checkpoint:e.checkpointTerm||"Checkpoints",area:e.areaTerm||"Areas",checklist:e.checklistTerm||"Checklists",course:e.courseTerm||"Course"})}const no=e=>e.toLowerCase(),oo=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();function Ct(){const e=f=>{const y=Li.value[f],x=Yo[f]?.[y];if(f==="checkpoint"&&y==="Person points"){const T=Li.value.people;return`${Yo.people[T]?.singular||"Person"} point`}return x?.singular||y},t=f=>{const y=Li.value[f],x=Yo[f]?.[y];if(f==="checkpoint"&&y==="Person points"){const T=Li.value.people;return`${Yo.people[T]?.singular||"Person"} points`}return x?.plural||y},o=X(()=>({person:e("people"),checkpoint:e("checkpoint"),area:e("area"),checklist:e("checklist"),course:e("course"),people:t("people"),checkpoints:t("checkpoint"),areas:t("area"),checklists:t("checklist"),courses:t("course")})),i=X(()=>({person:no(e("people")),checkpoint:no(e("checkpoint")),area:no(e("area")),checklist:no(e("checklist")),course:no(e("course")),people:no(t("people")),checkpoints:no(t("checkpoint")),areas:no(t("area")),checklists:no(t("checklist")),courses:no(t("course"))})),s=X(()=>({person:oo(e("people")),checkpoint:oo(e("checkpoint")),area:oo(e("area")),checklist:oo(e("checklist")),course:oo(e("course")),people:oo(t("people")),checkpoints:oo(t("checkpoint")),areas:oo(t("area")),checklists:oo(t("checklist")),courses:oo(t("course"))})),a=X(()=>({course:o.value.course,checkpoints:o.value.checkpoints,areas:o.value.areas,marshals:o.value.people,checklists:o.value.checklists,notes:"Notes",details:"Event details"}));return{terms:o,termsLower:i,termsSentence:s,tabLabels:a,singular:e,plural:t,formatCount:(f,y)=>y===1?`1 ${e(f)}`:`${y} ${t(f)}`,lower:(f,y=!0)=>no(y?t(f):e(f)),title:(f,y=!0)=>y?t(f):e(f),sentence:(f,y=!0)=>oo(y?t(f):e(f)),terminology:Li}}function Bb(){const e=D(!1),t=D(null),o=D({}),i=D(null),s=D(null),a=D([]),l=D(null),u=D(null),h=D(!1),p=D(!1),f=D(1),y=X(()=>t.value==="place-checkpoint"||t.value==="move-checkpoint"?i.value!==null:t.value==="draw-area"?s.value&&s.value.length>=3:t.value==="add-multiple"),x=Ie=>{if(Ie){const Re=Ie.getMapCenter?.(),xe=Ie.getMapZoom?.();Re&&xe!==null&&(l.value=Re,u.value=xe)}},T=(Ie={})=>{i.value=null,e.value=!0,t.value="place-checkpoint",o.value={title:Ie.title||"Select checkpoint location",description:Ie.description||"Click on the map to set the location. Click again to reposition."}},I=(Ie,Re="checkpoint")=>{i.value=null,e.value=!0,t.value="move-checkpoint",o.value={title:`Move ${Re}: ${Ie}`,description:"Click on the map to set the new location"}},S=(Ie={})=>{e.value=!0,t.value="draw-area",h.value=!0,o.value={title:Ie.title||"Draw area boundary",description:Ie.description||"Click to add points. Click Done when finished to complete the area."}},R=(Ie=1)=>{f.value=Ie,a.value=[],e.value=!0,t.value="add-multiple",p.value=!0,o.value={title:"Add multiple checkpoints",description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},E=Ie=>{t.value==="place-checkpoint"||t.value==="move-checkpoint"?i.value=Ie:t.value==="add-multiple"&&M(Ie)},M=Ie=>{a.value.push({id:`temp-${f.value}`,name:`Checkpoint ${f.value}`,description:"",latitude:Ie.lat,longitude:Ie.lng,requiredMarshals:1,what3Words:"",assignments:[],isTemporary:!0}),f.value++,o.value={...o.value,description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},_=Ie=>{s.value=Ie},$=()=>s.value&&s.value.length>=3?s.value.map(Ie=>({lat:Ie.lat,lng:Ie.lng})):null,k=()=>{e.value=!1,t.value=null,o.value={},i.value=null,l.value=null,u.value=null,s.value=null,h.value&&(h.value=!1)};return{isFullscreenMapActive:e,fullscreenMode:t,fullscreenContext:o,tempLocationCoords:i,currentDrawingPolygon:s,tempCheckpoints:a,savedMapCenter:l,savedMapZoom:u,isDrawingAreaBoundary:h,isAddingMultipleCheckpoints:p,multiCheckpointCounter:f,canCompleteFullscreen:y,saveMapState:x,enterPlaceCheckpointMode:T,enterMoveCheckpointMode:I,enterDrawAreaMode:S,enterAddMultipleMode:R,handleFullscreenMapClick:E,handlePolygonDrawing:_,getCompletedPolygon:$,exitFullscreen:k,cancelFullscreen:()=>{t.value==="add-multiple"?(a.value=[],p.value=!1):t.value==="draw-area"&&(h.value=!1,s.value=null),k()},getTempCheckpoints:()=>[...a.value],clearTempCheckpoints:()=>{a.value=[],p.value=!1},getPlacedCoords:()=>i.value,createDisplayCheckpoints:(Ie,Re,xe)=>X(()=>{const he=[...Ie.value];return t.value==="place-checkpoint"&&i.value&&he.push({id:"temp-single",name:Re.value?.name||"New Checkpoint",latitude:i.value.lat,longitude:i.value.lng,requiredMarshals:Re.value?.requiredMarshals||1,assignments:[],isTemporary:!0}),t.value==="move-checkpoint"&&i.value&&xe.value&&he.push({id:"temp-move",name:xe.value.name+" (new position)",latitude:i.value.lat,longitude:i.value.lng,requiredMarshals:xe.value.requiredMarshals,assignments:[],isTemporary:!0}),t.value==="add-multiple"&&he.push(...a.value),he}),createDisplayAreas:(Ie,Re)=>X(()=>{const xe=[...Ie.value];if(t.value==="draw-area"&&Re.value?.polygon?.length>0){const he=xe.findIndex(Q=>Q.id===Re.value.id);he>=0?xe[he]={...Re.value}:xe.push({...Re.value,id:Re.value.id||"temp-area"})}return xe}),calculateStartingNumber:Ie=>{const Re=Ie.value.map(xe=>{const he=xe.name.match(/^Checkpoint (\d+)$/);return he?parseInt(he[1]):0}).filter(xe=>xe>0);return Re.length>0?Math.max(...Re)+1:1}}}function Nb(e){const t=D([]),o=D(!1);return{eventAdmins:t,showAddAdmin:o,loadEventAdmins:async()=>{try{const h=await ac.getAdmins(e.value);return t.value=h.data,h.data}catch(h){throw console.error("Failed to load event admins:",h),h}},openAddAdminModal:()=>{o.value=!0},closeAddAdminModal:()=>{o.value=!1},addAdmin:async h=>{await ac.addAdmin(e.value,h)},removeAdmin:async h=>{await ac.removeAdmin(e.value,h)}}}function Fb(e){const t=D(!1),o=D(!1),i=D(!1),s=D(!1),a=D(!1),l=D(!1),u=D(null),h=D(null),p=D(null),f=D(null);return{showUploadRoute:t,showImportLocations:o,showImportMarshals:i,uploading:s,importing:a,importingMarshals:l,uploadError:u,importError:h,importResult:p,importMarshalsResult:f,openUploadRouteModal:()=>{u.value=null,t.value=!0},closeUploadRouteModal:()=>{t.value=!1,u.value=null},uploadRoute:async k=>{if(!k)return u.value="Please select a GPX file",null;s.value=!0,u.value=null;try{return await qs.uploadGpx(e.value,k),!0}catch(w){return console.error("Failed to upload route:",w),u.value=w.response?.data?.message||"Failed to upload route. Please try again.",null}finally{s.value=!1}},openImportLocationsModal:()=>{h.value=null,p.value=null,o.value=!0},closeImportLocationsModal:()=>{o.value=!1,h.value=null,p.value=null},importLocations:async(k,w)=>{if(!k)return h.value="Please select a CSV file",null;a.value=!0,h.value=null,p.value=null;try{const A=await xn.importCsv(e.value,k,w);return p.value=A.data,A.data}catch(A){return console.error("Failed to import locations:",A),h.value=A.response?.data?.message||"Failed to import locations. Please try again.",null}finally{a.value=!1}},openImportMarshalsModal:()=>{h.value=null,f.value=null,i.value=!0},closeImportMarshalsModal:()=>{i.value=!1,h.value=null,f.value=null},importMarshals:async k=>{if(!k)return h.value="Please select a CSV file",null;l.value=!0,h.value=null,f.value=null;try{const w=await $o.importCsv(e.value,k);return f.value=w.data,w.data}catch(w){return console.error("Failed to import marshals:",w),h.value=w.response?.data?.message||"Failed to import marshals. Please try again.",null}finally{l.value=!1}},formatImportResultMessage:(k,w="location")=>{const A=w==="location"?"location(s)":"marshal(s)";let ae=`<p>Created <strong>${k[w==="location"?"locationsCreated":"marshalsCreated"]}</strong> ${A} and <strong>${k.assignmentsCreated}</strong> assignment(s)</p>`;return k.errors&&k.errors.length>0&&(ae+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',k.errors.forEach(_e=>{ae+=`<li>${_e}</li>`}),ae+="</ul>"),ae}}}const Ep=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",Oa=e=>{if(!e)return"";const t=new Date(e),o=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0");return`${o}-${i}-${s}T${a}:${l}`},Wr=e=>{if(!e||e.trim()==="")return!0;if(!/^[a-z]{1,20}[./][a-z]{1,20}[./][a-z]{1,20}$/.test(e))return!1;const o=e.includes("."),i=e.includes("/");return o!==i};function Ub(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var pa={exports:{}};var zb=pa.exports,ch;function Hb(){return ch||(ch=1,(function(e,t){(function(o,i){i(t)})(zb,(function(o){var i="1.9.4";function s(n){var r,d,v,C;for(d=1,v=arguments.length;d<v;d++){C=arguments[d];for(r in C)n[r]=C[r]}return n}var a=Object.create||(function(){function n(){}return function(r){return n.prototype=r,new n}})();function l(n,r){var d=Array.prototype.slice;if(n.bind)return n.bind.apply(n,d.call(arguments,1));var v=d.call(arguments,2);return function(){return n.apply(r,v.length?v.concat(d.call(arguments)):arguments)}}var u=0;function h(n){return"_leaflet_id"in n||(n._leaflet_id=++u),n._leaflet_id}function p(n,r,d){var v,C,P,Y;return Y=function(){v=!1,C&&(P.apply(d,C),C=!1)},P=function(){v?C=arguments:(n.apply(d,arguments),setTimeout(Y,r),v=!0)},P}function f(n,r,d){var v=r[1],C=r[0],P=v-C;return n===v&&d?n:((n-C)%P+P)%P+C}function y(){return!1}function x(n,r){if(r===!1)return n;var d=Math.pow(10,r===void 0?6:r);return Math.round(n*d)/d}function T(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function I(n){return T(n).split(/\s+/)}function S(n,r){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?a(n.options):{});for(var d in r)n.options[d]=r[d];return n.options}function R(n,r,d){var v=[];for(var C in n)v.push(encodeURIComponent(d?C.toUpperCase():C)+"="+encodeURIComponent(n[C]));return(!r||r.indexOf("?")===-1?"?":"&")+v.join("&")}var E=/\{ *([\w_ -]+) *\}/g;function M(n,r){return n.replace(E,function(d,v){var C=r[v];if(C===void 0)throw new Error("No value provided for variable "+d);return typeof C=="function"&&(C=C(r)),C})}var _=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function $(n,r){for(var d=0;d<n.length;d++)if(n[d]===r)return d;return-1}var k="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function w(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var A=0;function ne(n){var r=+new Date,d=Math.max(0,16-(r-A));return A=r+d,window.setTimeout(n,d)}var ae=window.requestAnimationFrame||w("RequestAnimationFrame")||ne,_e=window.cancelAnimationFrame||w("CancelAnimationFrame")||w("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function re(n,r,d){if(d&&ae===ne)n.call(r);else return ae.call(window,l(n,r))}function ve(n){n&&_e.call(window,n)}var Ie={__proto__:null,extend:s,create:a,bind:l,get lastId(){return u},stamp:h,throttle:p,wrapNum:f,falseFn:y,formatNum:x,trim:T,splitWords:I,setOptions:S,getParamString:R,template:M,isArray:_,indexOf:$,emptyImageUrl:k,requestFn:ae,cancelFn:_e,requestAnimFrame:re,cancelAnimFrame:ve};function Re(){}Re.extend=function(n){var r=function(){S(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},d=r.__super__=this.prototype,v=a(d);v.constructor=r,r.prototype=v;for(var C in this)Object.prototype.hasOwnProperty.call(this,C)&&C!=="prototype"&&C!=="__super__"&&(r[C]=this[C]);return n.statics&&s(r,n.statics),n.includes&&(xe(n.includes),s.apply(null,[v].concat(n.includes))),s(v,n),delete v.statics,delete v.includes,v.options&&(v.options=d.options?a(d.options):{},s(v.options,n.options)),v._initHooks=[],v.callInitHooks=function(){if(!this._initHooksCalled){d.callInitHooks&&d.callInitHooks.call(this),this._initHooksCalled=!0;for(var P=0,Y=v._initHooks.length;P<Y;P++)v._initHooks[P].call(this)}},r},Re.include=function(n){var r=this.prototype.options;return s(this.prototype,n),n.options&&(this.prototype.options=r,this.mergeOptions(n.options)),this},Re.mergeOptions=function(n){return s(this.prototype.options,n),this},Re.addInitHook=function(n){var r=Array.prototype.slice.call(arguments,1),d=typeof n=="function"?n:function(){this[n].apply(this,r)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(d),this};function xe(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=_(n)?n:[n];for(var r=0;r<n.length;r++)n[r]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var he={on:function(n,r,d){if(typeof n=="object")for(var v in n)this._on(v,n[v],r);else{n=I(n);for(var C=0,P=n.length;C<P;C++)this._on(n[C],r,d)}return this},off:function(n,r,d){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var v in n)this._off(v,n[v],r);else{n=I(n);for(var C=arguments.length===1,P=0,Y=n.length;P<Y;P++)C?this._off(n[P]):this._off(n[P],r,d)}return this},_on:function(n,r,d,v){if(typeof r!="function"){console.warn("wrong listener type: "+typeof r);return}if(this._listens(n,r,d)===!1){d===this&&(d=void 0);var C={fn:r,ctx:d};v&&(C.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(C)}},_off:function(n,r,d){var v,C,P;if(this._events&&(v=this._events[n],!!v)){if(arguments.length===1){if(this._firingCount)for(C=0,P=v.length;C<P;C++)v[C].fn=y;delete this._events[n];return}if(typeof r!="function"){console.warn("wrong listener type: "+typeof r);return}var Y=this._listens(n,r,d);if(Y!==!1){var de=v[Y];this._firingCount&&(de.fn=y,this._events[n]=v=v.slice()),v.splice(Y,1)}}},fire:function(n,r,d){if(!this.listens(n,d))return this;var v=s({},r,{type:n,target:this,sourceTarget:r&&r.sourceTarget||this});if(this._events){var C=this._events[n];if(C){this._firingCount=this._firingCount+1||1;for(var P=0,Y=C.length;P<Y;P++){var de=C[P],me=de.fn;de.once&&this.off(n,me,de.ctx),me.call(de.ctx||this,v)}this._firingCount--}}return d&&this._propagateEvent(v),this},listens:function(n,r,d,v){typeof n!="string"&&console.warn('"string" type argument expected');var C=r;typeof r!="function"&&(v=!!r,C=void 0,d=void 0);var P=this._events&&this._events[n];if(P&&P.length&&this._listens(n,C,d)!==!1)return!0;if(v){for(var Y in this._eventParents)if(this._eventParents[Y].listens(n,r,d,v))return!0}return!1},_listens:function(n,r,d){if(!this._events)return!1;var v=this._events[n]||[];if(!r)return!!v.length;d===this&&(d=void 0);for(var C=0,P=v.length;C<P;C++)if(v[C].fn===r&&v[C].ctx===d)return C;return!1},once:function(n,r,d){if(typeof n=="object")for(var v in n)this._on(v,n[v],r,!0);else{n=I(n);for(var C=0,P=n.length;C<P;C++)this._on(n[C],r,d,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[h(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[h(n)],this},_propagateEvent:function(n){for(var r in this._eventParents)this._eventParents[r].fire(n.type,s({layer:n.target,propagatedFrom:n.target},n),!0)}};he.addEventListener=he.on,he.removeEventListener=he.clearAllEventListeners=he.off,he.addOneTimeEventListener=he.once,he.fireEvent=he.fire,he.hasEventListeners=he.listens;var Q=Re.extend(he);function J(n,r,d){this.x=d?Math.round(n):n,this.y=d?Math.round(r):r}var ue=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};J.prototype={clone:function(){return new J(this.x,this.y)},add:function(n){return this.clone()._add(te(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(te(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new J(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new J(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ue(this.x),this.y=ue(this.y),this},distanceTo:function(n){n=te(n);var r=n.x-this.x,d=n.y-this.y;return Math.sqrt(r*r+d*d)},equals:function(n){return n=te(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=te(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+x(this.x)+", "+x(this.y)+")"}};function te(n,r,d){return n instanceof J?n:_(n)?new J(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new J(n.x,n.y):new J(n,r,d)}function ke(n,r){if(n)for(var d=r?[n,r]:n,v=0,C=d.length;v<C;v++)this.extend(d[v])}ke.prototype={extend:function(n){var r,d;if(!n)return this;if(n instanceof J||typeof n[0]=="number"||"x"in n)r=d=te(n);else if(n=Oe(n),r=n.min,d=n.max,!r||!d)return this;return!this.min&&!this.max?(this.min=r.clone(),this.max=d.clone()):(this.min.x=Math.min(r.x,this.min.x),this.max.x=Math.max(d.x,this.max.x),this.min.y=Math.min(r.y,this.min.y),this.max.y=Math.max(d.y,this.max.y)),this},getCenter:function(n){return te((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return te(this.min.x,this.max.y)},getTopRight:function(){return te(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var r,d;return typeof n[0]=="number"||n instanceof J?n=te(n):n=Oe(n),n instanceof ke?(r=n.min,d=n.max):r=d=n,r.x>=this.min.x&&d.x<=this.max.x&&r.y>=this.min.y&&d.y<=this.max.y},intersects:function(n){n=Oe(n);var r=this.min,d=this.max,v=n.min,C=n.max,P=C.x>=r.x&&v.x<=d.x,Y=C.y>=r.y&&v.y<=d.y;return P&&Y},overlaps:function(n){n=Oe(n);var r=this.min,d=this.max,v=n.min,C=n.max,P=C.x>r.x&&v.x<d.x,Y=C.y>r.y&&v.y<d.y;return P&&Y},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var r=this.min,d=this.max,v=Math.abs(r.x-d.x)*n,C=Math.abs(r.y-d.y)*n;return Oe(te(r.x-v,r.y-C),te(d.x+v,d.y+C))},equals:function(n){return n?(n=Oe(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function Oe(n,r){return!n||n instanceof ke?n:new ke(n,r)}function oe(n,r){if(n)for(var d=r?[n,r]:n,v=0,C=d.length;v<C;v++)this.extend(d[v])}oe.prototype={extend:function(n){var r=this._southWest,d=this._northEast,v,C;if(n instanceof be)v=n,C=n;else if(n instanceof oe){if(v=n._southWest,C=n._northEast,!v||!C)return this}else return n?this.extend(Se(n)||Ee(n)):this;return!r&&!d?(this._southWest=new be(v.lat,v.lng),this._northEast=new be(C.lat,C.lng)):(r.lat=Math.min(v.lat,r.lat),r.lng=Math.min(v.lng,r.lng),d.lat=Math.max(C.lat,d.lat),d.lng=Math.max(C.lng,d.lng)),this},pad:function(n){var r=this._southWest,d=this._northEast,v=Math.abs(r.lat-d.lat)*n,C=Math.abs(r.lng-d.lng)*n;return new oe(new be(r.lat-v,r.lng-C),new be(d.lat+v,d.lng+C))},getCenter:function(){return new be((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new be(this.getNorth(),this.getWest())},getSouthEast:function(){return new be(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof be||"lat"in n?n=Se(n):n=Ee(n);var r=this._southWest,d=this._northEast,v,C;return n instanceof oe?(v=n.getSouthWest(),C=n.getNorthEast()):v=C=n,v.lat>=r.lat&&C.lat<=d.lat&&v.lng>=r.lng&&C.lng<=d.lng},intersects:function(n){n=Ee(n);var r=this._southWest,d=this._northEast,v=n.getSouthWest(),C=n.getNorthEast(),P=C.lat>=r.lat&&v.lat<=d.lat,Y=C.lng>=r.lng&&v.lng<=d.lng;return P&&Y},overlaps:function(n){n=Ee(n);var r=this._southWest,d=this._northEast,v=n.getSouthWest(),C=n.getNorthEast(),P=C.lat>r.lat&&v.lat<d.lat,Y=C.lng>r.lng&&v.lng<d.lng;return P&&Y},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,r){return n?(n=Ee(n),this._southWest.equals(n.getSouthWest(),r)&&this._northEast.equals(n.getNorthEast(),r)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Ee(n,r){return n instanceof oe?n:new oe(n,r)}function be(n,r,d){if(isNaN(n)||isNaN(r))throw new Error("Invalid LatLng object: ("+n+", "+r+")");this.lat=+n,this.lng=+r,d!==void 0&&(this.alt=+d)}be.prototype={equals:function(n,r){if(!n)return!1;n=Se(n);var d=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return d<=(r===void 0?1e-9:r)},toString:function(n){return"LatLng("+x(this.lat,n)+", "+x(this.lng,n)+")"},distanceTo:function(n){return pe.distance(this,Se(n))},wrap:function(){return pe.wrapLatLng(this)},toBounds:function(n){var r=180*n/40075017,d=r/Math.cos(Math.PI/180*this.lat);return Ee([this.lat-r,this.lng-d],[this.lat+r,this.lng+d])},clone:function(){return new be(this.lat,this.lng,this.alt)}};function Se(n,r,d){return n instanceof be?n:_(n)&&typeof n[0]!="object"?n.length===3?new be(n[0],n[1],n[2]):n.length===2?new be(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new be(n.lat,"lng"in n?n.lng:n.lon,n.alt):r===void 0?null:new be(n,r,d)}var le={latLngToPoint:function(n,r){var d=this.projection.project(n),v=this.scale(r);return this.transformation._transform(d,v)},pointToLatLng:function(n,r){var d=this.scale(r),v=this.transformation.untransform(n,d);return this.projection.unproject(v)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var r=this.projection.bounds,d=this.scale(n),v=this.transformation.transform(r.min,d),C=this.transformation.transform(r.max,d);return new ke(v,C)},infinite:!1,wrapLatLng:function(n){var r=this.wrapLng?f(n.lng,this.wrapLng,!0):n.lng,d=this.wrapLat?f(n.lat,this.wrapLat,!0):n.lat,v=n.alt;return new be(d,r,v)},wrapLatLngBounds:function(n){var r=n.getCenter(),d=this.wrapLatLng(r),v=r.lat-d.lat,C=r.lng-d.lng;if(v===0&&C===0)return n;var P=n.getSouthWest(),Y=n.getNorthEast(),de=new be(P.lat-v,P.lng-C),me=new be(Y.lat-v,Y.lng-C);return new oe(de,me)}},pe=s({},le,{wrapLng:[-180,180],R:6371e3,distance:function(n,r){var d=Math.PI/180,v=n.lat*d,C=r.lat*d,P=Math.sin((r.lat-n.lat)*d/2),Y=Math.sin((r.lng-n.lng)*d/2),de=P*P+Math.cos(v)*Math.cos(C)*Y*Y,me=2*Math.atan2(Math.sqrt(de),Math.sqrt(1-de));return this.R*me}}),q=6378137,fe={R:q,MAX_LATITUDE:85.0511287798,project:function(n){var r=Math.PI/180,d=this.MAX_LATITUDE,v=Math.max(Math.min(d,n.lat),-d),C=Math.sin(v*r);return new J(this.R*n.lng*r,this.R*Math.log((1+C)/(1-C))/2)},unproject:function(n){var r=180/Math.PI;return new be((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*r,n.x*r/this.R)},bounds:(function(){var n=q*Math.PI;return new ke([-n,-n],[n,n])})()};function Le(n,r,d,v){if(_(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=r,this._c=d,this._d=v}Le.prototype={transform:function(n,r){return this._transform(n.clone(),r)},_transform:function(n,r){return r=r||1,n.x=r*(this._a*n.x+this._b),n.y=r*(this._c*n.y+this._d),n},untransform:function(n,r){return r=r||1,new J((n.x/r-this._b)/this._a,(n.y/r-this._d)/this._c)}};function F(n,r,d,v){return new Le(n,r,d,v)}var G=s({},pe,{code:"EPSG:3857",projection:fe,transformation:(function(){var n=.5/(Math.PI*fe.R);return F(n,.5,-n,.5)})()}),W=s({},G,{code:"EPSG:900913"});function j(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function O(n,r){var d="",v,C,P,Y,de,me;for(v=0,P=n.length;v<P;v++){for(de=n[v],C=0,Y=de.length;C<Y;C++)me=de[C],d+=(C?"L":"M")+me.x+" "+me.y;d+=r?Xe.svg?"z":"x":""}return d||"M0 0"}var B=document.documentElement.style,K="ActiveXObject"in window,ye=K&&!document.addEventListener,$e="msLaunchUri"in navigator&&!("documentMode"in document),we=Wt("webkit"),Ne=Wt("android"),Fe=Wt("android 2")||Wt("android 3"),Ue=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ke=Ne&&Wt("Google")&&Ue<537&&!("AudioNode"in window),se=!!window.opera,ee=!$e&&Wt("chrome"),Z=Wt("gecko")&&!we&&!se&&!K,Ve=!ee&&Wt("safari"),Ye=Wt("phantom"),Qe="OTransition"in B,et=navigator.platform.indexOf("Win")===0,pt=K&&"transition"in B,Pt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Fe,gt="MozPerspective"in B,zt=!window.L_DISABLE_3D&&(pt||Pt||gt)&&!Qe&&!Ye,kn=typeof orientation<"u"||Wt("mobile"),fo=kn&&we,$t=kn&&Pt,Yn=!window.PointerEvent&&window.MSPointerEvent,dn=!!(window.PointerEvent||Yn),ri="ontouchstart"in window||!!window.TouchEvent,Mn=!window.L_NO_TOUCH&&(ri||dn),po=kn&&se,Jn=kn&&Z,Xn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ss=(function(){var n=!1;try{var r=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",y,r),window.removeEventListener("testPassiveEventSupport",y,r)}catch{}return n})(),hn=(function(){return!!document.createElement("canvas").getContext})(),vo=!!(document.createElementNS&&j("svg").createSVGRect),is=!!vo&&(function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),As=!vo&&(function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var r=n.firstChild;return r.style.behavior="url(#default#VML)",r&&typeof r.adj=="object"}catch{return!1}})(),mo=navigator.platform.indexOf("Mac")===0,Qn=navigator.platform.indexOf("Linux")===0;function Wt(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var Xe={ie:K,ielt9:ye,edge:$e,webkit:we,android:Ne,android23:Fe,androidStock:Ke,opera:se,chrome:ee,gecko:Z,safari:Ve,phantom:Ye,opera12:Qe,win:et,ie3d:pt,webkit3d:Pt,gecko3d:gt,any3d:zt,mobile:kn,mobileWebkit:fo,mobileWebkit3d:$t,msPointer:Yn,pointer:dn,touch:Mn,touchNative:ri,mobileOpera:po,mobileGecko:Jn,retina:Xn,passiveEvents:ss,canvas:hn,svg:vo,vml:As,inlineSvg:is,mac:mo,linux:Qn},go=Xe.msPointer?"MSPointerDown":"pointerdown",as=Xe.msPointer?"MSPointerMove":"pointermove",Qt=Xe.msPointer?"MSPointerUp":"pointerup",eo=Xe.msPointer?"MSPointerCancel":"pointercancel",Nn={touchstart:go,touchmove:as,touchend:Qt,touchcancel:eo},yo={touchstart:ls,touchmove:rs,touchend:rs,touchcancel:rs},Fn={},li=!1;function Fi(n,r,d){return r==="touchstart"&&tn(),yo[r]?(d=yo[r].bind(this,d),n.addEventListener(Nn[r],d,!1),d):(console.warn("wrong event specified:",r),y)}function Ui(n,r,d){if(!Nn[r]){console.warn("wrong event specified:",r);return}n.removeEventListener(Nn[r],d,!1)}function ci(n){Fn[n.pointerId]=n}function Es(n){Fn[n.pointerId]&&(Fn[n.pointerId]=n)}function to(n){delete Fn[n.pointerId]}function tn(){li||(document.addEventListener(go,ci,!0),document.addEventListener(as,Es,!0),document.addEventListener(Qt,to,!0),document.addEventListener(eo,to,!0),li=!0)}function rs(n,r){if(r.pointerType!==(r.MSPOINTER_TYPE_MOUSE||"mouse")){r.touches=[];for(var d in Fn)r.touches.push(Fn[d]);r.changedTouches=[r],n(r)}}function ls(n,r){r.MSPOINTER_TYPE_TOUCH&&r.pointerType===r.MSPOINTER_TYPE_TOUCH&&Zt(r),rs(n,r)}function cs(n){var r={},d,v;for(v in n)d=n[v],r[v]=d&&d.bind?d.bind(n):d;return n=r,r.type="dblclick",r.detail=2,r.isTrusted=!1,r._simulated=!0,r}var Ps=200;function Mt(n,r){n.addEventListener("dblclick",r);var d=0,v;function C(P){if(P.detail!==1){v=P.detail;return}if(!(P.pointerType==="mouse"||P.sourceCapabilities&&!P.sourceCapabilities.firesTouchEvents)){var Y=Wa(P);if(!(Y.some(function(me){return me instanceof HTMLLabelElement&&me.attributes.for})&&!Y.some(function(me){return me instanceof HTMLInputElement||me instanceof HTMLSelectElement}))){var de=Date.now();de-d<=Ps?(v++,v===2&&r(cs(P))):v=1,d=de}}}return n.addEventListener("click",C),{dblclick:r,simDblclick:C}}function ui(n,r){n.removeEventListener("dblclick",r.dblclick),n.removeEventListener("click",r.simDblclick)}var us=Hn(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),An=Hn(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Ds=An==="webkitTransition"||An==="OTransition"?An+"End":"transitionend";function di(n){return typeof n=="string"?document.getElementById(n):n}function Bt(n,r){var d=n.style[r]||n.currentStyle&&n.currentStyle[r];if((!d||d==="auto")&&document.defaultView){var v=document.defaultView.getComputedStyle(n,null);d=v?v[r]:null}return d==="auto"?null:d}function ht(n,r,d){var v=document.createElement(n);return v.className=r||"",d&&d.appendChild(v),v}function kt(n){var r=n.parentNode;r&&r.removeChild(n)}function _o(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function Un(n){var r=n.parentNode;r&&r.lastChild!==n&&r.appendChild(n)}function zn(n){var r=n.parentNode;r&&r.firstChild!==n&&r.insertBefore(n,r.firstChild)}function Eo(n,r){if(n.classList!==void 0)return n.classList.contains(r);var d=Po(n);return d.length>0&&new RegExp("(^|\\s)"+r+"(\\s|$)").test(d)}function it(n,r){if(n.classList!==void 0)for(var d=I(r),v=0,C=d.length;v<C;v++)n.classList.add(d[v]);else if(!Eo(n,r)){var P=Po(n);Os(n,(P?P+" ":"")+r)}}function Tt(n,r){n.classList!==void 0?n.classList.remove(r):Os(n,T((" "+Po(n)+" ").replace(" "+r+" "," ")))}function Os(n,r){n.className.baseVal===void 0?n.className=r:n.className.baseVal=r}function Po(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function qt(n,r){"opacity"in n.style?n.style.opacity=r:"filter"in n.style&&zi(n,r)}function zi(n,r){var d=!1,v="DXImageTransform.Microsoft.Alpha";try{d=n.filters.item(v)}catch{if(r===1)return}r=Math.round(r*100),d?(d.Enabled=r!==100,d.Opacity=r):n.style.filter+=" progid:"+v+"(opacity="+r+")"}function Hn(n){for(var r=document.documentElement.style,d=0;d<n.length;d++)if(n[d]in r)return n[d];return!1}function fn(n,r,d){var v=r||new J(0,0);n.style[us]=(Xe.ie3d?"translate("+v.x+"px,"+v.y+"px)":"translate3d("+v.x+"px,"+v.y+"px,0)")+(d?" scale("+d+")":"")}function At(n,r){n._leaflet_pos=r,Xe.any3d?fn(n,r):(n.style.left=r.x+"px",n.style.top=r.y+"px")}function H(n){return n._leaflet_pos||new J(0,0)}var V,ie,Me;if("onselectstart"in document)V=function(){lt(window,"selectstart",Zt)},ie=function(){Lt(window,"selectstart",Zt)};else{var Ge=Hn(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);V=function(){if(Ge){var n=document.documentElement.style;Me=n[Ge],n[Ge]="none"}},ie=function(){Ge&&(document.documentElement.style[Ge]=Me,Me=void 0)}}function ot(){lt(window,"dragstart",Zt)}function Ht(){Lt(window,"dragstart",Zt)}var Vt,nn;function Rs(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(ds(),Vt=n,nn=n.style.outlineStyle,n.style.outlineStyle="none",lt(window,"keydown",ds))}function ds(){Vt&&(Vt.style.outlineStyle=nn,Vt=void 0,nn=void 0,Lt(window,"keydown",ds))}function ja(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function Hi(n){var r=n.getBoundingClientRect();return{x:r.width/n.offsetWidth||1,y:r.height/n.offsetHeight||1,boundingClientRect:r}}var Cl={__proto__:null,TRANSFORM:us,TRANSITION:An,TRANSITION_END:Ds,get:di,getStyle:Bt,create:ht,remove:kt,empty:_o,toFront:Un,toBack:zn,hasClass:Eo,addClass:it,removeClass:Tt,setClass:Os,getClass:Po,setOpacity:qt,testProp:Hn,setTransform:fn,setPosition:At,getPosition:H,get disableTextSelection(){return V},get enableTextSelection(){return ie},disableImageDrag:ot,enableImageDrag:Ht,preventOutline:Rs,restoreOutline:ds,getSizedParentNode:ja,getScale:Hi};function lt(n,r,d,v){if(r&&typeof r=="object")for(var C in r)Zi(n,C,r[C],d);else{r=I(r);for(var P=0,Y=r.length;P<Y;P++)Zi(n,r[P],d,v)}return this}var bn="_leaflet_events";function Lt(n,r,d,v){if(arguments.length===1)Vi(n),delete n[bn];else if(r&&typeof r=="object")for(var C in r)Bs(n,C,r[C],d);else if(r=I(r),arguments.length===2)Vi(n,function(de){return $(r,de)!==-1});else for(var P=0,Y=r.length;P<Y;P++)Bs(n,r[P],d,v);return this}function Vi(n,r){for(var d in n[bn]){var v=d.split(/\d/)[0];(!r||r(v))&&Bs(n,v,null,null,d)}}var Gi={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Zi(n,r,d,v){var C=r+h(d)+(v?"_"+h(v):"");if(n[bn]&&n[bn][C])return this;var P=function(de){return d.call(v||n,de||window.event)},Y=P;!Xe.touchNative&&Xe.pointer&&r.indexOf("touch")===0?P=Fi(n,r,P):Xe.touch&&r==="dblclick"?P=Mt(n,P):"addEventListener"in n?r==="touchstart"||r==="touchmove"||r==="wheel"||r==="mousewheel"?n.addEventListener(Gi[r]||r,P,Xe.passiveEvents?{passive:!1}:!1):r==="mouseenter"||r==="mouseleave"?(P=function(de){de=de||window.event,qi(n,de)&&Y(de)},n.addEventListener(Gi[r],P,!1)):n.addEventListener(r,Y,!1):n.attachEvent("on"+r,P),n[bn]=n[bn]||{},n[bn][C]=P}function Bs(n,r,d,v,C){C=C||r+h(d)+(v?"_"+h(v):"");var P=n[bn]&&n[bn][C];if(!P)return this;!Xe.touchNative&&Xe.pointer&&r.indexOf("touch")===0?Ui(n,r,P):Xe.touch&&r==="dblclick"?ui(n,P):"removeEventListener"in n?n.removeEventListener(Gi[r]||r,P,!1):n.detachEvent("on"+r,P),n[bn][C]=null}function Do(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function ji(n){return Zi(n,"wheel",Do),this}function hs(n){return lt(n,"mousedown touchstart dblclick contextmenu",Do),n._leaflet_disable_click=!0,this}function Zt(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function ko(n){return Zt(n),Do(n),this}function Wa(n){if(n.composedPath)return n.composedPath();for(var r=[],d=n.target;d;)r.push(d),d=d.parentNode;return r}function Wi(n,r){if(!r)return new J(n.clientX,n.clientY);var d=Hi(r),v=d.boundingClientRect;return new J((n.clientX-v.left)/d.x-r.clientLeft,(n.clientY-v.top)/d.y-r.clientTop)}var Ll=Xe.linux&&Xe.chrome?window.devicePixelRatio:Xe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function qa(n){return Xe.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/Ll:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function qi(n,r){var d=r.relatedTarget;if(!d)return!0;try{for(;d&&d!==n;)d=d.parentNode}catch{return!1}return d!==n}var Sl={__proto__:null,on:lt,off:Lt,stopPropagation:Do,disableScrollPropagation:ji,disableClickPropagation:hs,preventDefault:Zt,stop:ko,getPropagationPath:Wa,getMousePosition:Wi,getWheelDelta:qa,isExternalTarget:qi,addListener:lt,removeListener:Lt},Ka=Q.extend({run:function(n,r,d,v){this.stop(),this._el=n,this._inProgress=!0,this._duration=d||.25,this._easeOutPower=1/Math.max(v||.5,.2),this._startPos=H(n),this._offset=r.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=re(this._animate,this),this._step()},_step:function(n){var r=+new Date-this._startTime,d=this._duration*1e3;r<d?this._runFrame(this._easeOut(r/d),n):(this._runFrame(1),this._complete())},_runFrame:function(n,r){var d=this._startPos.add(this._offset.multiplyBy(n));r&&d._round(),At(this._el,d),this.fire("step")},_complete:function(){ve(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),mt=Q.extend({options:{crs:G,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,r){r=S(this,r),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),r.maxBounds&&this.setMaxBounds(r.maxBounds),r.zoom!==void 0&&(this._zoom=this._limitZoom(r.zoom)),r.center&&r.zoom!==void 0&&this.setView(Se(r.center),r.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=An&&Xe.any3d&&!Xe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),lt(this._proxy,Ds,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,r,d){if(r=r===void 0?this._zoom:this._limitZoom(r),n=this._limitCenter(Se(n),r,this.options.maxBounds),d=d||{},this._stop(),this._loaded&&!d.reset&&d!==!0){d.animate!==void 0&&(d.zoom=s({animate:d.animate},d.zoom),d.pan=s({animate:d.animate,duration:d.duration},d.pan));var v=this._zoom!==r?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,r,d.zoom):this._tryAnimatedPan(n,d.pan);if(v)return clearTimeout(this._sizeTimer),this}return this._resetView(n,r,d.pan&&d.pan.noMoveStart),this},setZoom:function(n,r){return this._loaded?this.setView(this.getCenter(),n,{zoom:r}):(this._zoom=n,this)},zoomIn:function(n,r){return n=n||(Xe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,r)},zoomOut:function(n,r){return n=n||(Xe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,r)},setZoomAround:function(n,r,d){var v=this.getZoomScale(r),C=this.getSize().divideBy(2),P=n instanceof J?n:this.latLngToContainerPoint(n),Y=P.subtract(C).multiplyBy(1-1/v),de=this.containerPointToLatLng(C.add(Y));return this.setView(de,r,{zoom:d})},_getBoundsCenterZoom:function(n,r){r=r||{},n=n.getBounds?n.getBounds():Ee(n);var d=te(r.paddingTopLeft||r.padding||[0,0]),v=te(r.paddingBottomRight||r.padding||[0,0]),C=this.getBoundsZoom(n,!1,d.add(v));if(C=typeof r.maxZoom=="number"?Math.min(r.maxZoom,C):C,C===1/0)return{center:n.getCenter(),zoom:C};var P=v.subtract(d).divideBy(2),Y=this.project(n.getSouthWest(),C),de=this.project(n.getNorthEast(),C),me=this.unproject(Y.add(de).divideBy(2).add(P),C);return{center:me,zoom:C}},fitBounds:function(n,r){if(n=Ee(n),!n.isValid())throw new Error("Bounds are not valid.");var d=this._getBoundsCenterZoom(n,r);return this.setView(d.center,d.zoom,r)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,r){return this.setView(n,this._zoom,{pan:r})},panBy:function(n,r){if(n=te(n).round(),r=r||{},!n.x&&!n.y)return this.fire("moveend");if(r.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ka,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),r.noMoveStart||this.fire("movestart"),r.animate!==!1){it(this._mapPane,"leaflet-pan-anim");var d=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,d,r.duration||.25,r.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,r,d){if(d=d||{},d.animate===!1||!Xe.any3d)return this.setView(n,r,d);this._stop();var v=this.project(this.getCenter()),C=this.project(n),P=this.getSize(),Y=this._zoom;n=Se(n),r=r===void 0?Y:r;var de=Math.max(P.x,P.y),me=de*this.getZoomScale(Y,r),Ae=C.distanceTo(v)||1,qe=1.42,st=qe*qe;function ft(Gt){var vr=Gt?-1:1,fv=Gt?me:de,pv=me*me-de*de+vr*st*st*Ae*Ae,vv=2*fv*st*Ae,Fl=pv/vv,Ru=Math.sqrt(Fl*Fl+1)-Fl,mv=Ru<1e-9?-18:Math.log(Ru);return mv}function pn(Gt){return(Math.exp(Gt)-Math.exp(-Gt))/2}function Yt(Gt){return(Math.exp(Gt)+Math.exp(-Gt))/2}function Zn(Gt){return pn(Gt)/Yt(Gt)}var Cn=ft(0);function yi(Gt){return de*(Yt(Cn)/Yt(Cn+qe*Gt))}function cv(Gt){return de*(Yt(Cn)*Zn(Cn+qe*Gt)-pn(Cn))/st}function uv(Gt){return 1-Math.pow(1-Gt,1.5)}var dv=Date.now(),Du=(ft(1)-Cn)/qe,hv=d.duration?1e3*d.duration:1e3*Du*.8;function Ou(){var Gt=(Date.now()-dv)/hv,vr=uv(Gt)*Du;Gt<=1?(this._flyToFrame=re(Ou,this),this._move(this.unproject(v.add(C.subtract(v).multiplyBy(cv(vr)/Ae)),Y),this.getScaleZoom(de/yi(vr),Y),{flyTo:!0})):this._move(n,r)._moveEnd(!0)}return this._moveStart(!0,d.noMoveStart),Ou.call(this),this},flyToBounds:function(n,r){var d=this._getBoundsCenterZoom(n,r);return this.flyTo(d.center,d.zoom,r)},setMaxBounds:function(n){return n=Ee(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var r=this.options.minZoom;return this.options.minZoom=n,this._loaded&&r!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var r=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&r!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,r){this._enforcingBounds=!0;var d=this.getCenter(),v=this._limitCenter(d,this._zoom,Ee(n));return d.equals(v)||this.panTo(v,r),this._enforcingBounds=!1,this},panInside:function(n,r){r=r||{};var d=te(r.paddingTopLeft||r.padding||[0,0]),v=te(r.paddingBottomRight||r.padding||[0,0]),C=this.project(this.getCenter()),P=this.project(n),Y=this.getPixelBounds(),de=Oe([Y.min.add(d),Y.max.subtract(v)]),me=de.getSize();if(!de.contains(P)){this._enforcingBounds=!0;var Ae=P.subtract(de.getCenter()),qe=de.extend(P).getSize().subtract(me);C.x+=Ae.x<0?-qe.x:qe.x,C.y+=Ae.y<0?-qe.y:qe.y,this.panTo(this.unproject(C),r),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=s({animate:!1,pan:!0},n===!0?{animate:!0}:n);var r=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var d=this.getSize(),v=r.divideBy(2).round(),C=d.divideBy(2).round(),P=v.subtract(C);return!P.x&&!P.y?this:(n.animate&&n.pan?this.panBy(P):(n.pan&&this._rawPanBy(P),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:r,newSize:d}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=s({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var r=l(this._handleGeolocationResponse,this),d=l(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(r,d,n):navigator.geolocation.getCurrentPosition(r,d,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var r=n.code,d=n.message||(r===1?"permission denied":r===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:r,message:"Geolocation error: "+d+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var r=n.coords.latitude,d=n.coords.longitude,v=new be(r,d),C=v.toBounds(n.coords.accuracy*2),P=this._locateOptions;if(P.setView){var Y=this.getBoundsZoom(C);this.setView(v,P.maxZoom?Math.min(Y,P.maxZoom):Y)}var de={latlng:v,bounds:C,timestamp:n.timestamp};for(var me in n.coords)typeof n.coords[me]=="number"&&(de[me]=n.coords[me]);this.fire("locationfound",de)}},addHandler:function(n,r){if(!r)return this;var d=this[n]=new r(this);return this._handlers.push(d),this.options[n]&&d.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),kt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(ve(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)kt(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,r){var d="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),v=ht("div",d,r||this._mapPane);return n&&(this._panes[n]=v),v},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),r=this.unproject(n.getBottomLeft()),d=this.unproject(n.getTopRight());return new oe(r,d)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,r,d){n=Ee(n),d=te(d||[0,0]);var v=this.getZoom()||0,C=this.getMinZoom(),P=this.getMaxZoom(),Y=n.getNorthWest(),de=n.getSouthEast(),me=this.getSize().subtract(d),Ae=Oe(this.project(de,v),this.project(Y,v)).getSize(),qe=Xe.any3d?this.options.zoomSnap:1,st=me.x/Ae.x,ft=me.y/Ae.y,pn=r?Math.max(st,ft):Math.min(st,ft);return v=this.getScaleZoom(pn,v),qe&&(v=Math.round(v/(qe/100))*(qe/100),v=r?Math.ceil(v/qe)*qe:Math.floor(v/qe)*qe),Math.max(C,Math.min(P,v))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new J(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,r){var d=this._getTopLeftPoint(n,r);return new ke(d,d.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,r){var d=this.options.crs;return r=r===void 0?this._zoom:r,d.scale(n)/d.scale(r)},getScaleZoom:function(n,r){var d=this.options.crs;r=r===void 0?this._zoom:r;var v=d.zoom(n*d.scale(r));return isNaN(v)?1/0:v},project:function(n,r){return r=r===void 0?this._zoom:r,this.options.crs.latLngToPoint(Se(n),r)},unproject:function(n,r){return r=r===void 0?this._zoom:r,this.options.crs.pointToLatLng(te(n),r)},layerPointToLatLng:function(n){var r=te(n).add(this.getPixelOrigin());return this.unproject(r)},latLngToLayerPoint:function(n){var r=this.project(Se(n))._round();return r._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(Se(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(Ee(n))},distance:function(n,r){return this.options.crs.distance(Se(n),Se(r))},containerPointToLayerPoint:function(n){return te(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return te(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var r=this.containerPointToLayerPoint(te(n));return this.layerPointToLatLng(r)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Se(n)))},mouseEventToContainerPoint:function(n){return Wi(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var r=this._container=di(n);if(r){if(r._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");lt(r,"scroll",this._onScroll,this),this._containerId=h(r)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&Xe.any3d,it(n,"leaflet-container"+(Xe.touch?" leaflet-touch":"")+(Xe.retina?" leaflet-retina":"")+(Xe.ielt9?" leaflet-oldie":"")+(Xe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var r=Bt(n,"position");r!=="absolute"&&r!=="relative"&&r!=="fixed"&&r!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),At(this._mapPane,new J(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(it(n.markerPane,"leaflet-zoom-hide"),it(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,r,d){At(this._mapPane,new J(0,0));var v=!this._loaded;this._loaded=!0,r=this._limitZoom(r),this.fire("viewprereset");var C=this._zoom!==r;this._moveStart(C,d)._move(n,r)._moveEnd(C),this.fire("viewreset"),v&&this.fire("load")},_moveStart:function(n,r){return n&&this.fire("zoomstart"),r||this.fire("movestart"),this},_move:function(n,r,d,v){r===void 0&&(r=this._zoom);var C=this._zoom!==r;return this._zoom=r,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),v?d&&d.pinch&&this.fire("zoom",d):((C||d&&d.pinch)&&this.fire("zoom",d),this.fire("move",d)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return ve(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){At(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[h(this._container)]=this;var r=n?Lt:lt;r(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&r(window,"resize",this._onResize,this),Xe.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){ve(this._resizeRequest),this._resizeRequest=re(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,r){for(var d=[],v,C=r==="mouseout"||r==="mouseover",P=n.target||n.srcElement,Y=!1;P;){if(v=this._targets[h(P)],v&&(r==="click"||r==="preclick")&&this._draggableMoved(v)){Y=!0;break}if(v&&v.listens(r,!0)&&(C&&!qi(P,n)||(d.push(v),C))||P===this._container)break;P=P.parentNode}return!d.length&&!Y&&!C&&this.listens(r,!0)&&(d=[this]),d},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var r=n.target||n.srcElement;if(!(!this._loaded||r._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(r))){var d=n.type;d==="mousedown"&&Rs(r),this._fireDOMEvent(n,d)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,r,d){if(n.type==="click"){var v=s({},n);v.type="preclick",this._fireDOMEvent(v,v.type,d)}var C=this._findEventTargets(n,r);if(d){for(var P=[],Y=0;Y<d.length;Y++)d[Y].listens(r,!0)&&P.push(d[Y]);C=P.concat(C)}if(C.length){r==="contextmenu"&&Zt(n);var de=C[0],me={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var Ae=de.getLatLng&&(!de._radius||de._radius<=10);me.containerPoint=Ae?this.latLngToContainerPoint(de.getLatLng()):this.mouseEventToContainerPoint(n),me.layerPoint=this.containerPointToLayerPoint(me.containerPoint),me.latlng=Ae?de.getLatLng():this.layerPointToLatLng(me.layerPoint)}for(Y=0;Y<C.length;Y++)if(C[Y].fire(r,me,!0),me.originalEvent._stopped||C[Y].options.bubblingMouseEvents===!1&&$(this._mouseEvents,r)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,r=this._handlers.length;n<r;n++)this._handlers[n].disable()},whenReady:function(n,r){return this._loaded?n.call(r||this,{target:this}):this.on("load",n,r),this},_getMapPanePos:function(){return H(this._mapPane)||new J(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,r){var d=n&&r!==void 0?this._getNewPixelOrigin(n,r):this.getPixelOrigin();return d.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,r){var d=this.getSize()._divideBy(2);return this.project(n,r)._subtract(d)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,r,d){var v=this._getNewPixelOrigin(d,r);return this.project(n,r)._subtract(v)},_latLngBoundsToNewLayerBounds:function(n,r,d){var v=this._getNewPixelOrigin(d,r);return Oe([this.project(n.getSouthWest(),r)._subtract(v),this.project(n.getNorthWest(),r)._subtract(v),this.project(n.getSouthEast(),r)._subtract(v),this.project(n.getNorthEast(),r)._subtract(v)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,r,d){if(!d)return n;var v=this.project(n,r),C=this.getSize().divideBy(2),P=new ke(v.subtract(C),v.add(C)),Y=this._getBoundsOffset(P,d,r);return Math.abs(Y.x)<=1&&Math.abs(Y.y)<=1?n:this.unproject(v.add(Y),r)},_limitOffset:function(n,r){if(!r)return n;var d=this.getPixelBounds(),v=new ke(d.min.add(n),d.max.add(n));return n.add(this._getBoundsOffset(v,r))},_getBoundsOffset:function(n,r,d){var v=Oe(this.project(r.getNorthEast(),d),this.project(r.getSouthWest(),d)),C=v.min.subtract(n.min),P=v.max.subtract(n.max),Y=this._rebound(C.x,-P.x),de=this._rebound(C.y,-P.y);return new J(Y,de)},_rebound:function(n,r){return n+r>0?Math.round(n-r)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(r))},_limitZoom:function(n){var r=this.getMinZoom(),d=this.getMaxZoom(),v=Xe.any3d?this.options.zoomSnap:1;return v&&(n=Math.round(n/v)*v),Math.max(r,Math.min(d,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Tt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,r){var d=this._getCenterOffset(n)._trunc();return(r&&r.animate)!==!0&&!this.getSize().contains(d)?!1:(this.panBy(d,r),!0)},_createAnimProxy:function(){var n=this._proxy=ht("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(r){var d=us,v=this._proxy.style[d];fn(this._proxy,this.project(r.center,r.zoom),this.getZoomScale(r.zoom,1)),v===this._proxy.style[d]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){kt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),r=this.getZoom();fn(this._proxy,this.project(n,r),this.getZoomScale(r,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,r,d){if(this._animatingZoom)return!0;if(d=d||{},!this._zoomAnimated||d.animate===!1||this._nothingToAnimate()||Math.abs(r-this._zoom)>this.options.zoomAnimationThreshold)return!1;var v=this.getZoomScale(r),C=this._getCenterOffset(n)._divideBy(1-1/v);return d.animate!==!0&&!this.getSize().contains(C)?!1:(re(function(){this._moveStart(!0,d.noMoveStart||!1)._animateZoom(n,r,!0)},this),!0)},_animateZoom:function(n,r,d,v){this._mapPane&&(d&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=r,it(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:r,noUpdate:v}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Tt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function xl(n,r){return new mt(n,r)}var En=Re.extend({options:{position:"topright"},initialize:function(n){S(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var r=this._map;return r&&r.removeControl(this),this.options.position=n,r&&r.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var r=this._container=this.onAdd(n),d=this.getPosition(),v=n._controlCorners[d];return it(r,"leaflet-control"),d.indexOf("bottom")!==-1?v.insertBefore(r,v.firstChild):v.appendChild(r),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(kt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),Ns=function(n){return new En(n)};mt.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},r="leaflet-",d=this._controlContainer=ht("div",r+"control-container",this._container);function v(C,P){var Y=r+C+" "+r+P;n[C+P]=ht("div",Y,d)}v("top","left"),v("top","right"),v("bottom","left"),v("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)kt(this._controlCorners[n]);kt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ya=En.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,r,d,v){return d<v?-1:v<d?1:0}},initialize:function(n,r,d){S(this,d),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var v in n)this._addLayer(n[v],v);for(v in r)this._addLayer(r[v],v,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return En.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,r){return this._addLayer(n,r),this._map?this._update():this},addOverlay:function(n,r){return this._addLayer(n,r,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var r=this._getLayer(h(n));return r&&this._layers.splice(this._layers.indexOf(r),1),this._map?this._update():this},expand:function(){it(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(it(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):Tt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Tt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",r=this._container=ht("div",n),d=this.options.collapsed;r.setAttribute("aria-haspopup",!0),hs(r),ji(r);var v=this._section=ht("section",n+"-list");d&&(this._map.on("click",this.collapse,this),lt(r,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var C=this._layersLink=ht("a",n+"-toggle",r);C.href="#",C.title="Layers",C.setAttribute("role","button"),lt(C,{keydown:function(P){P.keyCode===13&&this._expandSafely()},click:function(P){Zt(P),this._expandSafely()}},this),d||this.expand(),this._baseLayersList=ht("div",n+"-base",v),this._separator=ht("div",n+"-separator",v),this._overlaysList=ht("div",n+"-overlays",v),r.appendChild(v)},_getLayer:function(n){for(var r=0;r<this._layers.length;r++)if(this._layers[r]&&h(this._layers[r].layer)===n)return this._layers[r]},_addLayer:function(n,r,d){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:r,overlay:d}),this.options.sortLayers&&this._layers.sort(l(function(v,C){return this.options.sortFunction(v.layer,C.layer,v.name,C.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;_o(this._baseLayersList),_o(this._overlaysList),this._layerControlInputs=[];var n,r,d,v,C=0;for(d=0;d<this._layers.length;d++)v=this._layers[d],this._addItem(v),r=r||v.overlay,n=n||!v.overlay,C+=v.overlay?0:1;return this.options.hideSingleBase&&(n=n&&C>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=r&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var r=this._getLayer(h(n.target)),d=r.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;d&&this._map.fire(d,r)},_createRadioElement:function(n,r){var d='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(r?' checked="checked"':"")+"/>",v=document.createElement("div");return v.innerHTML=d,v.firstChild},_addItem:function(n){var r=document.createElement("label"),d=this._map.hasLayer(n.layer),v;n.overlay?(v=document.createElement("input"),v.type="checkbox",v.className="leaflet-control-layers-selector",v.defaultChecked=d):v=this._createRadioElement("leaflet-base-layers_"+h(this),d),this._layerControlInputs.push(v),v.layerId=h(n.layer),lt(v,"click",this._onInputClick,this);var C=document.createElement("span");C.innerHTML=" "+n.name;var P=document.createElement("span");r.appendChild(P),P.appendChild(v),P.appendChild(C);var Y=n.overlay?this._overlaysList:this._baseLayersList;return Y.appendChild(r),this._checkDisabledLayers(),r},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,r,d,v=[],C=[];this._handlingClick=!0;for(var P=n.length-1;P>=0;P--)r=n[P],d=this._getLayer(r.layerId).layer,r.checked?v.push(d):r.checked||C.push(d);for(P=0;P<C.length;P++)this._map.hasLayer(C[P])&&this._map.removeLayer(C[P]);for(P=0;P<v.length;P++)this._map.hasLayer(v[P])||this._map.addLayer(v[P]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,r,d,v=this._map.getZoom(),C=n.length-1;C>=0;C--)r=n[C],d=this._getLayer(r.layerId).layer,r.disabled=d.options.minZoom!==void 0&&v<d.options.minZoom||d.options.maxZoom!==void 0&&v>d.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,lt(n,"click",Zt),this.expand();var r=this;setTimeout(function(){Lt(n,"click",Zt),r._preventClick=!1})}}),Tl=function(n,r,d){return new Ya(n,r,d)},fs=En.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var r="leaflet-control-zoom",d=ht("div",r+" leaflet-bar"),v=this.options;return this._zoomInButton=this._createButton(v.zoomInText,v.zoomInTitle,r+"-in",d,this._zoomIn),this._zoomOutButton=this._createButton(v.zoomOutText,v.zoomOutTitle,r+"-out",d,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),d},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,r,d,v,C){var P=ht("a",d,v);return P.innerHTML=n,P.href="#",P.title=r,P.setAttribute("role","button"),P.setAttribute("aria-label",r),hs(P),lt(P,"click",ko),lt(P,"click",C,this),lt(P,"click",this._refocusOnMap,this),P},_updateDisabled:function(){var n=this._map,r="leaflet-disabled";Tt(this._zoomInButton,r),Tt(this._zoomOutButton,r),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(it(this._zoomOutButton,r),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(it(this._zoomInButton,r),this._zoomInButton.setAttribute("aria-disabled","true"))}});mt.mergeOptions({zoomControl:!0}),mt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new fs,this.addControl(this.zoomControl))});var Il=function(n){return new fs(n)},Fs=En.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var r="leaflet-control-scale",d=ht("div",r),v=this.options;return this._addScales(v,r+"-line",d),n.on(v.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),d},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,r,d){n.metric&&(this._mScale=ht("div",r,d)),n.imperial&&(this._iScale=ht("div",r,d))},_update:function(){var n=this._map,r=n.getSize().y/2,d=n.distance(n.containerPointToLatLng([0,r]),n.containerPointToLatLng([this.options.maxWidth,r]));this._updateScales(d)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var r=this._getRoundNum(n),d=r<1e3?r+" m":r/1e3+" km";this._updateScale(this._mScale,d,r/n)},_updateImperial:function(n){var r=n*3.2808399,d,v,C;r>5280?(d=r/5280,v=this._getRoundNum(d),this._updateScale(this._iScale,v+" mi",v/d)):(C=this._getRoundNum(r),this._updateScale(this._iScale,C+" ft",C/r))},_updateScale:function(n,r,d){n.style.width=Math.round(this.options.maxWidth*d)+"px",n.innerHTML=r},_getRoundNum:function(n){var r=Math.pow(10,(Math.floor(n)+"").length-1),d=n/r;return d=d>=10?10:d>=5?5:d>=3?3:d>=2?2:1,r*d}}),$l=function(n){return new Fs(n)},Ja='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Us=En.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Xe.inlineSvg?Ja+" ":"")+"Leaflet</a>"},initialize:function(n){S(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=ht("div","leaflet-control-attribution"),hs(this._container);for(var r in n._layers)n._layers[r].getAttribution&&this.addAttribution(n._layers[r].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var r in this._attributions)this._attributions[r]&&n.push(r);var d=[];this.options.prefix&&d.push(this.options.prefix),n.length&&d.push(n.join(", ")),this._container.innerHTML=d.join(' <span aria-hidden="true">|</span> ')}}});mt.mergeOptions({attributionControl:!0}),mt.addInitHook(function(){this.options.attributionControl&&new Us().addTo(this)});var Ki=function(n){return new Us(n)};En.Layers=Ya,En.Zoom=fs,En.Scale=Fs,En.Attribution=Us,Ns.layers=Tl,Ns.zoom=Il,Ns.scale=$l,Ns.attribution=Ki;var Vn=Re.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Vn.addTo=function(n,r){return n.addHandler(r,this),this};var Ml={Events:he},Xa=Xe.touch?"touchstart mousedown":"mousedown",bo=Q.extend({options:{clickTolerance:3},initialize:function(n,r,d,v){S(this,v),this._element=n,this._dragStartTarget=r||n,this._preventOutline=d},enable:function(){this._enabled||(lt(this._dragStartTarget,Xa,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(bo._dragging===this&&this.finishDrag(!0),Lt(this._dragStartTarget,Xa,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!Eo(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){bo._dragging===this&&this.finishDrag();return}if(!(bo._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(bo._dragging=this,this._preventOutline&&Rs(this._element),ot(),V(),!this._moving)){this.fire("down");var r=n.touches?n.touches[0]:n,d=ja(this._element);this._startPoint=new J(r.clientX,r.clientY),this._startPos=H(this._element),this._parentScale=Hi(d);var v=n.type==="mousedown";lt(document,v?"mousemove":"touchmove",this._onMove,this),lt(document,v?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var r=n.touches&&n.touches.length===1?n.touches[0]:n,d=new J(r.clientX,r.clientY)._subtract(this._startPoint);!d.x&&!d.y||Math.abs(d.x)+Math.abs(d.y)<this.options.clickTolerance||(d.x/=this._parentScale.x,d.y/=this._parentScale.y,Zt(n),this._moved||(this.fire("dragstart"),this._moved=!0,it(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),it(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(d),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),At(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){Tt(document.body,"leaflet-dragging"),this._lastTarget&&(Tt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Lt(document,"mousemove touchmove",this._onMove,this),Lt(document,"mouseup touchend touchcancel",this._onUp,this),Ht(),ie();var r=this._moved&&this._moving;this._moving=!1,bo._dragging=!1,r&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function Qa(n,r,d){var v,C=[1,4,2,8],P,Y,de,me,Ae,qe,st,ft;for(P=0,qe=n.length;P<qe;P++)n[P]._code=wo(n[P],r);for(de=0;de<4;de++){for(st=C[de],v=[],P=0,qe=n.length,Y=qe-1;P<qe;Y=P++)me=n[P],Ae=n[Y],me._code&st?Ae._code&st||(ft=fi(Ae,me,st,r,d),ft._code=wo(ft,r),v.push(ft)):(Ae._code&st&&(ft=fi(Ae,me,st,r,d),ft._code=wo(ft,r),v.push(ft)),v.push(me));n=v}return n}function er(n,r){var d,v,C,P,Y,de,me,Ae,qe;if(!n||n.length===0)throw new Error("latlngs not passed");Kt(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var st=Se([0,0]),ft=Ee(n),pn=ft.getNorthWest().distanceTo(ft.getSouthWest())*ft.getNorthEast().distanceTo(ft.getNorthWest());pn<1700&&(st=Yi(n));var Yt=n.length,Zn=[];for(d=0;d<Yt;d++){var Cn=Se(n[d]);Zn.push(r.project(Se([Cn.lat-st.lat,Cn.lng-st.lng])))}for(de=me=Ae=0,d=0,v=Yt-1;d<Yt;v=d++)C=Zn[d],P=Zn[v],Y=C.y*P.x-P.y*C.x,me+=(C.x+P.x)*Y,Ae+=(C.y+P.y)*Y,de+=Y*3;de===0?qe=Zn[0]:qe=[me/de,Ae/de];var yi=r.unproject(te(qe));return Se([yi.lat+st.lat,yi.lng+st.lng])}function Yi(n){for(var r=0,d=0,v=0,C=0;C<n.length;C++){var P=Se(n[C]);r+=P.lat,d+=P.lng,v++}return Se([r/v,d/v])}var Al={__proto__:null,clipPolygon:Qa,polygonCenter:er,centroid:Yi};function tr(n,r){if(!r||!n.length)return n.slice();var d=r*r;return n=Pl(n,d),n=nr(n,d),n}function Ji(n,r,d){return Math.sqrt(zs(n,r,d,!0))}function El(n,r,d){return zs(n,r,d)}function nr(n,r){var d=n.length,v=typeof Uint8Array<"u"?Uint8Array:Array,C=new v(d);C[0]=C[d-1]=1,Xi(n,C,r,0,d-1);var P,Y=[];for(P=0;P<d;P++)C[P]&&Y.push(n[P]);return Y}function Xi(n,r,d,v,C){var P=0,Y,de,me;for(de=v+1;de<=C-1;de++)me=zs(n[de],n[v],n[C],!0),me>P&&(Y=de,P=me);P>d&&(r[Y]=1,Xi(n,r,d,v,Y),Xi(n,r,d,Y,C))}function Pl(n,r){for(var d=[n[0]],v=1,C=0,P=n.length;v<P;v++)Dl(n[v],n[C])>r&&(d.push(n[v]),C=v);return C<P-1&&d.push(n[P-1]),d}var or;function hi(n,r,d,v,C){var P=v?or:wo(n,d),Y=wo(r,d),de,me,Ae;for(or=Y;;){if(!(P|Y))return[n,r];if(P&Y)return!1;de=P||Y,me=fi(n,r,de,d,C),Ae=wo(me,d),de===P?(n=me,P=Ae):(r=me,Y=Ae)}}function fi(n,r,d,v,C){var P=r.x-n.x,Y=r.y-n.y,de=v.min,me=v.max,Ae,qe;return d&8?(Ae=n.x+P*(me.y-n.y)/Y,qe=me.y):d&4?(Ae=n.x+P*(de.y-n.y)/Y,qe=de.y):d&2?(Ae=me.x,qe=n.y+Y*(me.x-n.x)/P):d&1&&(Ae=de.x,qe=n.y+Y*(de.x-n.x)/P),new J(Ae,qe,C)}function wo(n,r){var d=0;return n.x<r.min.x?d|=1:n.x>r.max.x&&(d|=2),n.y<r.min.y?d|=4:n.y>r.max.y&&(d|=8),d}function Dl(n,r){var d=r.x-n.x,v=r.y-n.y;return d*d+v*v}function zs(n,r,d,v){var C=r.x,P=r.y,Y=d.x-C,de=d.y-P,me=Y*Y+de*de,Ae;return me>0&&(Ae=((n.x-C)*Y+(n.y-P)*de)/me,Ae>1?(C=d.x,P=d.y):Ae>0&&(C+=Y*Ae,P+=de*Ae)),Y=n.x-C,de=n.y-P,v?Y*Y+de*de:new J(C,P)}function Kt(n){return!_(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function Qi(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Kt(n)}function ea(n,r){var d,v,C,P,Y,de,me,Ae;if(!n||n.length===0)throw new Error("latlngs not passed");Kt(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var qe=Se([0,0]),st=Ee(n),ft=st.getNorthWest().distanceTo(st.getSouthWest())*st.getNorthEast().distanceTo(st.getNorthWest());ft<1700&&(qe=Yi(n));var pn=n.length,Yt=[];for(d=0;d<pn;d++){var Zn=Se(n[d]);Yt.push(r.project(Se([Zn.lat-qe.lat,Zn.lng-qe.lng])))}for(d=0,v=0;d<pn-1;d++)v+=Yt[d].distanceTo(Yt[d+1])/2;if(v===0)Ae=Yt[0];else for(d=0,P=0;d<pn-1;d++)if(Y=Yt[d],de=Yt[d+1],C=Y.distanceTo(de),P+=C,P>v){me=(P-v)/C,Ae=[de.x-me*(de.x-Y.x),de.y-me*(de.y-Y.y)];break}var Cn=r.unproject(te(Ae));return Se([Cn.lat+qe.lat,Cn.lng+qe.lng])}var sr={__proto__:null,simplify:tr,pointToSegmentDistance:Ji,closestPointOnSegment:El,clipSegment:hi,_getEdgeIntersection:fi,_getBitCode:wo,_sqClosestPointOnSegment:zs,isFlat:Kt,_flat:Qi,polylineCenter:ea},U={project:function(n){return new J(n.lng,n.lat)},unproject:function(n){return new be(n.y,n.x)},bounds:new ke([-180,-90],[180,90])},ce={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ke([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var r=Math.PI/180,d=this.R,v=n.lat*r,C=this.R_MINOR/d,P=Math.sqrt(1-C*C),Y=P*Math.sin(v),de=Math.tan(Math.PI/4-v/2)/Math.pow((1-Y)/(1+Y),P/2);return v=-d*Math.log(Math.max(de,1e-10)),new J(n.lng*r*d,v)},unproject:function(n){for(var r=180/Math.PI,d=this.R,v=this.R_MINOR/d,C=Math.sqrt(1-v*v),P=Math.exp(-n.y/d),Y=Math.PI/2-2*Math.atan(P),de=0,me=.1,Ae;de<15&&Math.abs(me)>1e-7;de++)Ae=C*Math.sin(Y),Ae=Math.pow((1-Ae)/(1+Ae),C/2),me=Math.PI/2-2*Math.atan(P*Ae)-Y,Y+=me;return new be(Y*r,n.x*r/d)}},Pe={__proto__:null,LonLat:U,Mercator:ce,SphericalMercator:fe},De=s({},pe,{code:"EPSG:3395",projection:ce,transformation:(function(){var n=.5/(Math.PI*ce.R);return F(n,.5,-n,.5)})()}),yt=s({},pe,{code:"EPSG:4326",projection:U,transformation:F(1/180,1,-1/180,.5)}),wn=s({},le,{projection:U,transformation:F(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,r){var d=r.lng-n.lng,v=r.lat-n.lat;return Math.sqrt(d*d+v*v)},infinite:!0});le.Earth=pe,le.EPSG3395=De,le.EPSG3857=G,le.EPSG900913=W,le.EPSG4326=yt,le.Simple=wn;var Nt=Q.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[h(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[h(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var r=n.target;if(r.hasLayer(this)){if(this._map=r,this._zoomAnimated=r._zoomAnimated,this.getEvents){var d=this.getEvents();r.on(d,this),this.once("remove",function(){r.off(d,this)},this)}this.onAdd(r),this.fire("add"),r.fire("layeradd",{layer:this})}}});mt.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var r=h(n);return this._layers[r]?this:(this._layers[r]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var r=h(n);return this._layers[r]?(this._loaded&&n.onRemove(this),delete this._layers[r],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return h(n)in this._layers},eachLayer:function(n,r){for(var d in this._layers)n.call(r,this._layers[d]);return this},_addLayers:function(n){n=n?_(n)?n:[n]:[];for(var r=0,d=n.length;r<d;r++)this.addLayer(n[r])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[h(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var r=h(n);this._zoomBoundLayers[r]&&(delete this._zoomBoundLayers[r],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,r=-1/0,d=this._getZoomSpan();for(var v in this._zoomBoundLayers){var C=this._zoomBoundLayers[v].options;n=C.minZoom===void 0?n:Math.min(n,C.minZoom),r=C.maxZoom===void 0?r:Math.max(r,C.maxZoom)}this._layersMaxZoom=r===-1/0?void 0:r,this._layersMinZoom=n===1/0?void 0:n,d!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Gn=Nt.extend({initialize:function(n,r){S(this,r),this._layers={};var d,v;if(n)for(d=0,v=n.length;d<v;d++)this.addLayer(n[d])},addLayer:function(n){var r=this.getLayerId(n);return this._layers[r]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var r=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[r]&&this._map.removeLayer(this._layers[r]),delete this._layers[r],this},hasLayer:function(n){var r=typeof n=="number"?n:this.getLayerId(n);return r in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var r=Array.prototype.slice.call(arguments,1),d,v;for(d in this._layers)v=this._layers[d],v[n]&&v[n].apply(v,r);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,r){for(var d in this._layers)n.call(r,this._layers[d]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return h(n)}}),Hp=function(n,r){return new Gn(n,r)},Oo=Gn.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),Gn.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),Gn.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new oe;for(var r in this._layers){var d=this._layers[r];n.extend(d.getBounds?d.getBounds():d.getLatLng())}return n}}),Vp=function(n,r){return new Oo(n,r)},pi=Re.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){S(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,r){var d=this._getIconUrl(n);if(!d){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var v=this._createImg(d,r&&r.tagName==="IMG"?r:null);return this._setIconStyles(v,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),v},_setIconStyles:function(n,r){var d=this.options,v=d[r+"Size"];typeof v=="number"&&(v=[v,v]);var C=te(v),P=te(r==="shadow"&&d.shadowAnchor||d.iconAnchor||C&&C.divideBy(2,!0));n.className="leaflet-marker-"+r+" "+(d.className||""),P&&(n.style.marginLeft=-P.x+"px",n.style.marginTop=-P.y+"px"),C&&(n.style.width=C.x+"px",n.style.height=C.y+"px")},_createImg:function(n,r){return r=r||document.createElement("img"),r.src=n,r},_getIconUrl:function(n){return Xe.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function Gp(n){return new pi(n)}var ta=pi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof ta.imagePath!="string"&&(ta.imagePath=this._detectIconPath()),(this.options.imagePath||ta.imagePath)+pi.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var r=function(d,v,C){var P=v.exec(d);return P&&P[C]};return n=r(n,/^url\((['"])?(.+)\1\)$/,2),n&&r(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=ht("div","leaflet-default-icon-path",document.body),r=Bt(n,"background-image")||Bt(n,"backgroundImage");if(document.body.removeChild(n),r=this._stripUrl(r),r)return r;var d=document.querySelector('link[href$="leaflet.css"]');return d?d.href.substring(0,d.href.length-11-1):""}}),vu=Vn.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new bo(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),it(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Tt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var r=this._marker,d=r._map,v=this._marker.options.autoPanSpeed,C=this._marker.options.autoPanPadding,P=H(r._icon),Y=d.getPixelBounds(),de=d.getPixelOrigin(),me=Oe(Y.min._subtract(de).add(C),Y.max._subtract(de).subtract(C));if(!me.contains(P)){var Ae=te((Math.max(me.max.x,P.x)-me.max.x)/(Y.max.x-me.max.x)-(Math.min(me.min.x,P.x)-me.min.x)/(Y.min.x-me.min.x),(Math.max(me.max.y,P.y)-me.max.y)/(Y.max.y-me.max.y)-(Math.min(me.min.y,P.y)-me.min.y)/(Y.min.y-me.min.y)).multiplyBy(v);d.panBy(Ae,{animate:!1}),this._draggable._newPos._add(Ae),this._draggable._startPos._add(Ae),At(r._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=re(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(ve(this._panRequest),this._panRequest=re(this._adjustPan.bind(this,n)))},_onDrag:function(n){var r=this._marker,d=r._shadow,v=H(r._icon),C=r._map.layerPointToLatLng(v);d&&At(d,v),r._latlng=C,n.latlng=C,n.oldLatLng=this._oldLatLng,r.fire("move",n).fire("drag",n)},_onDragEnd:function(n){ve(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),ir=Nt.extend({options:{icon:new ta,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,r){S(this,r),this._latlng=Se(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var r=this._latlng;return this._latlng=Se(n),this.update(),this.fire("move",{oldLatLng:r,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,r="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),d=n.icon.createIcon(this._icon),v=!1;d!==this._icon&&(this._icon&&this._removeIcon(),v=!0,n.title&&(d.title=n.title),d.tagName==="IMG"&&(d.alt=n.alt||"")),it(d,r),n.keyboard&&(d.tabIndex="0",d.setAttribute("role","button")),this._icon=d,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&lt(d,"focus",this._panOnFocus,this);var C=n.icon.createShadow(this._shadow),P=!1;C!==this._shadow&&(this._removeShadow(),P=!0),C&&(it(C,r),C.alt=""),this._shadow=C,n.opacity<1&&this._updateOpacity(),v&&this.getPane().appendChild(this._icon),this._initInteraction(),C&&P&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Lt(this._icon,"focus",this._panOnFocus,this),kt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&kt(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&At(this._icon,n),this._shadow&&At(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var r=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(r)},_initInteraction:function(){if(this.options.interactive&&(it(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),vu)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new vu(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&qt(this._icon,n),this._shadow&&qt(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var r=this.options.icon.options,d=r.iconSize?te(r.iconSize):te(0,0),v=r.iconAnchor?te(r.iconAnchor):te(0,0);n.panInside(this._latlng,{paddingTopLeft:v,paddingBottomRight:d.subtract(v)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Zp(n,r){return new ir(n,r)}var ps=Nt.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return S(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ar=ps.extend({options:{fill:!0,radius:10},initialize:function(n,r){S(this,r),this._latlng=Se(n),this._radius=this.options.radius},setLatLng:function(n){var r=this._latlng;return this._latlng=Se(n),this.redraw(),this.fire("move",{oldLatLng:r,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var r=n&&n.radius||this._radius;return ps.prototype.setStyle.call(this,n),this.setRadius(r),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,r=this._radiusY||n,d=this._clickTolerance(),v=[n+d,r+d];this._pxBounds=new ke(this._point.subtract(v),this._point.add(v))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function jp(n,r){return new ar(n,r)}var Ol=ar.extend({initialize:function(n,r,d){if(typeof r=="number"&&(r=s({},d,{radius:r})),S(this,r),this._latlng=Se(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new oe(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:ps.prototype.setStyle,_project:function(){var n=this._latlng.lng,r=this._latlng.lat,d=this._map,v=d.options.crs;if(v.distance===pe.distance){var C=Math.PI/180,P=this._mRadius/pe.R/C,Y=d.project([r+P,n]),de=d.project([r-P,n]),me=Y.add(de).divideBy(2),Ae=d.unproject(me).lat,qe=Math.acos((Math.cos(P*C)-Math.sin(r*C)*Math.sin(Ae*C))/(Math.cos(r*C)*Math.cos(Ae*C)))/C;(isNaN(qe)||qe===0)&&(qe=P/Math.cos(Math.PI/180*r)),this._point=me.subtract(d.getPixelOrigin()),this._radius=isNaN(qe)?0:me.x-d.project([Ae,n-qe]).x,this._radiusY=me.y-Y.y}else{var st=v.unproject(v.project(this._latlng).subtract([this._mRadius,0]));this._point=d.latLngToLayerPoint(this._latlng),this._radius=this._point.x-d.latLngToLayerPoint(st).x}this._updateBounds()}});function Wp(n,r,d){return new Ol(n,r,d)}var Ro=ps.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,r){S(this,r),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var r=1/0,d=null,v=zs,C,P,Y=0,de=this._parts.length;Y<de;Y++)for(var me=this._parts[Y],Ae=1,qe=me.length;Ae<qe;Ae++){C=me[Ae-1],P=me[Ae];var st=v(n,C,P,!0);st<r&&(r=st,d=v(n,C,P))}return d&&(d.distance=Math.sqrt(r)),d},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ea(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,r){return r=r||this._defaultShape(),n=Se(n),r.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new oe,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return Kt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var r=[],d=Kt(n),v=0,C=n.length;v<C;v++)d?(r[v]=Se(n[v]),this._bounds.extend(r[v])):r[v]=this._convertLatLngs(n[v]);return r},_project:function(){var n=new ke;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),r=new J(n,n);this._rawPxBounds&&(this._pxBounds=new ke([this._rawPxBounds.min.subtract(r),this._rawPxBounds.max.add(r)]))},_projectLatlngs:function(n,r,d){var v=n[0]instanceof be,C=n.length,P,Y;if(v){for(Y=[],P=0;P<C;P++)Y[P]=this._map.latLngToLayerPoint(n[P]),d.extend(Y[P]);r.push(Y)}else for(P=0;P<C;P++)this._projectLatlngs(n[P],r,d)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var r=this._parts,d,v,C,P,Y,de,me;for(d=0,C=0,P=this._rings.length;d<P;d++)for(me=this._rings[d],v=0,Y=me.length;v<Y-1;v++)de=hi(me[v],me[v+1],n,v,!0),de&&(r[C]=r[C]||[],r[C].push(de[0]),(de[1]!==me[v+1]||v===Y-2)&&(r[C].push(de[1]),C++))}},_simplifyPoints:function(){for(var n=this._parts,r=this.options.smoothFactor,d=0,v=n.length;d<v;d++)n[d]=tr(n[d],r)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,r){var d,v,C,P,Y,de,me=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(d=0,P=this._parts.length;d<P;d++)for(de=this._parts[d],v=0,Y=de.length,C=Y-1;v<Y;C=v++)if(!(!r&&v===0)&&Ji(n,de[C],de[v])<=me)return!0;return!1}});function qp(n,r){return new Ro(n,r)}Ro._flat=Qi;var vi=Ro.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return er(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var r=Ro.prototype._convertLatLngs.call(this,n),d=r.length;return d>=2&&r[0]instanceof be&&r[0].equals(r[d-1])&&r.pop(),r},_setLatLngs:function(n){Ro.prototype._setLatLngs.call(this,n),Kt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Kt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,r=this.options.weight,d=new J(r,r);if(n=new ke(n.min.subtract(d),n.max.add(d)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var v=0,C=this._rings.length,P;v<C;v++)P=Qa(this._rings[v],n,!0),P.length&&this._parts.push(P)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var r=!1,d,v,C,P,Y,de,me,Ae;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(P=0,me=this._parts.length;P<me;P++)for(d=this._parts[P],Y=0,Ae=d.length,de=Ae-1;Y<Ae;de=Y++)v=d[Y],C=d[de],v.y>n.y!=C.y>n.y&&n.x<(C.x-v.x)*(n.y-v.y)/(C.y-v.y)+v.x&&(r=!r);return r||Ro.prototype._containsPoint.call(this,n,!0)}});function Kp(n,r){return new vi(n,r)}var Bo=Oo.extend({initialize:function(n,r){S(this,r),this._layers={},n&&this.addData(n)},addData:function(n){var r=_(n)?n:n.features,d,v,C;if(r){for(d=0,v=r.length;d<v;d++)C=r[d],(C.geometries||C.geometry||C.features||C.coordinates)&&this.addData(C);return this}var P=this.options;if(P.filter&&!P.filter(n))return this;var Y=rr(n,P);return Y?(Y.feature=ur(n),Y.defaultOptions=Y.options,this.resetStyle(Y),P.onEachFeature&&P.onEachFeature(n,Y),this.addLayer(Y)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=s({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(r){this._setLayerStyle(r,n)},this)},_setLayerStyle:function(n,r){n.setStyle&&(typeof r=="function"&&(r=r(n.feature)),n.setStyle(r))}});function rr(n,r){var d=n.type==="Feature"?n.geometry:n,v=d?d.coordinates:null,C=[],P=r&&r.pointToLayer,Y=r&&r.coordsToLatLng||Rl,de,me,Ae,qe;if(!v&&!d)return null;switch(d.type){case"Point":return de=Y(v),mu(P,n,de,r);case"MultiPoint":for(Ae=0,qe=v.length;Ae<qe;Ae++)de=Y(v[Ae]),C.push(mu(P,n,de,r));return new Oo(C);case"LineString":case"MultiLineString":return me=lr(v,d.type==="LineString"?0:1,Y),new Ro(me,r);case"Polygon":case"MultiPolygon":return me=lr(v,d.type==="Polygon"?1:2,Y),new vi(me,r);case"GeometryCollection":for(Ae=0,qe=d.geometries.length;Ae<qe;Ae++){var st=rr({geometry:d.geometries[Ae],type:"Feature",properties:n.properties},r);st&&C.push(st)}return new Oo(C);case"FeatureCollection":for(Ae=0,qe=d.features.length;Ae<qe;Ae++){var ft=rr(d.features[Ae],r);ft&&C.push(ft)}return new Oo(C);default:throw new Error("Invalid GeoJSON object.")}}function mu(n,r,d,v){return n?n(r,d):new ir(d,v&&v.markersInheritOptions&&v)}function Rl(n){return new be(n[1],n[0],n[2])}function lr(n,r,d){for(var v=[],C=0,P=n.length,Y;C<P;C++)Y=r?lr(n[C],r-1,d):(d||Rl)(n[C]),v.push(Y);return v}function Bl(n,r){return n=Se(n),n.alt!==void 0?[x(n.lng,r),x(n.lat,r),x(n.alt,r)]:[x(n.lng,r),x(n.lat,r)]}function cr(n,r,d,v){for(var C=[],P=0,Y=n.length;P<Y;P++)C.push(r?cr(n[P],Kt(n[P])?0:r-1,d,v):Bl(n[P],v));return!r&&d&&C.length>0&&C.push(C[0].slice()),C}function mi(n,r){return n.feature?s({},n.feature,{geometry:r}):ur(r)}function ur(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var Nl={toGeoJSON:function(n){return mi(this,{type:"Point",coordinates:Bl(this.getLatLng(),n)})}};ir.include(Nl),Ol.include(Nl),ar.include(Nl),Ro.include({toGeoJSON:function(n){var r=!Kt(this._latlngs),d=cr(this._latlngs,r?1:0,!1,n);return mi(this,{type:(r?"Multi":"")+"LineString",coordinates:d})}}),vi.include({toGeoJSON:function(n){var r=!Kt(this._latlngs),d=r&&!Kt(this._latlngs[0]),v=cr(this._latlngs,d?2:r?1:0,!0,n);return r||(v=[v]),mi(this,{type:(d?"Multi":"")+"Polygon",coordinates:v})}}),Gn.include({toMultiPoint:function(n){var r=[];return this.eachLayer(function(d){r.push(d.toGeoJSON(n).geometry.coordinates)}),mi(this,{type:"MultiPoint",coordinates:r})},toGeoJSON:function(n){var r=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(r==="MultiPoint")return this.toMultiPoint(n);var d=r==="GeometryCollection",v=[];return this.eachLayer(function(C){if(C.toGeoJSON){var P=C.toGeoJSON(n);if(d)v.push(P.geometry);else{var Y=ur(P);Y.type==="FeatureCollection"?v.push.apply(v,Y.features):v.push(Y)}}}),d?mi(this,{geometries:v,type:"GeometryCollection"}):{type:"FeatureCollection",features:v}}});function gu(n,r){return new Bo(n,r)}var Yp=gu,dr=Nt.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,r,d){this._url=n,this._bounds=Ee(r),S(this,d)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(it(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){kt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&Un(this._image),this},bringToBack:function(){return this._map&&zn(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=Ee(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",r=this._image=n?this._url:ht("img");if(it(r,"leaflet-image-layer"),this._zoomAnimated&&it(r,"leaflet-zoom-animated"),this.options.className&&it(r,this.options.className),r.onselectstart=y,r.onmousemove=y,r.onload=l(this.fire,this,"load"),r.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(r.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=r.src;return}r.src=this._url,r.alt=this.options.alt},_animateZoom:function(n){var r=this._map.getZoomScale(n.zoom),d=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;fn(this._image,d,r)},_reset:function(){var n=this._image,r=new ke(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),d=r.getSize();At(n,r.min),n.style.width=d.x+"px",n.style.height=d.y+"px"},_updateOpacity:function(){qt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),Jp=function(n,r,d){return new dr(n,r,d)},yu=dr.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",r=this._image=n?this._url:ht("video");if(it(r,"leaflet-image-layer"),this._zoomAnimated&&it(r,"leaflet-zoom-animated"),this.options.className&&it(r,this.options.className),r.onselectstart=y,r.onmousemove=y,r.onloadeddata=l(this.fire,this,"load"),n){for(var d=r.getElementsByTagName("source"),v=[],C=0;C<d.length;C++)v.push(d[C].src);this._url=d.length>0?v:[r.src];return}_(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(r.style,"objectFit")&&(r.style.objectFit="fill"),r.autoplay=!!this.options.autoplay,r.loop=!!this.options.loop,r.muted=!!this.options.muted,r.playsInline=!!this.options.playsInline;for(var P=0;P<this._url.length;P++){var Y=ht("source");Y.src=this._url[P],r.appendChild(Y)}}});function Xp(n,r,d){return new yu(n,r,d)}var _u=dr.extend({_initImage:function(){var n=this._image=this._url;it(n,"leaflet-image-layer"),this._zoomAnimated&&it(n,"leaflet-zoom-animated"),this.options.className&&it(n,this.options.className),n.onselectstart=y,n.onmousemove=y}});function Qp(n,r,d){return new _u(n,r,d)}var Co=Nt.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,r){n&&(n instanceof be||_(n))?(this._latlng=Se(n),S(this,r)):(S(this,n),this._source=r),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&qt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&qt(this._container,1),this.bringToFront(),this.options.interactive&&(it(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(qt(this._container,0),this._removeTimeout=setTimeout(l(kt,void 0,this._container),200)):kt(this._container),this.options.interactive&&(Tt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=Se(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Un(this._container),this},bringToBack:function(){return this._map&&zn(this._container),this},_prepareOpen:function(n){var r=this._source;if(!r._map)return!1;if(r instanceof Oo){r=null;var d=this._source._layers;for(var v in d)if(d[v]._map){r=d[v];break}if(!r)return!1;this._source=r}if(!n)if(r.getCenter)n=r.getCenter();else if(r.getLatLng)n=r.getLatLng();else if(r.getBounds)n=r.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,r=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof r=="string")n.innerHTML=r;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(r)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),r=te(this.options.offset),d=this._getAnchor();this._zoomAnimated?At(this._container,n.add(d)):r=r.add(n).add(d);var v=this._containerBottom=-r.y,C=this._containerLeft=-Math.round(this._containerWidth/2)+r.x;this._container.style.bottom=v+"px",this._container.style.left=C+"px"}},_getAnchor:function(){return[0,0]}});mt.include({_initOverlay:function(n,r,d,v){var C=r;return C instanceof n||(C=new n(v).setContent(r)),d&&C.setLatLng(d),C}}),Nt.include({_initOverlay:function(n,r,d,v){var C=d;return C instanceof n?(S(C,v),C._source=this):(C=r&&!v?r:new n(v,this),C.setContent(d)),C}});var hr=Co.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,Co.prototype.openOn.call(this,n)},onAdd:function(n){Co.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ps||this._source.on("preclick",Do))},onRemove:function(n){Co.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ps||this._source.off("preclick",Do))},getEvents:function(){var n=Co.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",r=this._container=ht("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),d=this._wrapper=ht("div",n+"-content-wrapper",r);if(this._contentNode=ht("div",n+"-content",d),hs(r),ji(this._contentNode),lt(r,"contextmenu",Do),this._tipContainer=ht("div",n+"-tip-container",r),this._tip=ht("div",n+"-tip",this._tipContainer),this.options.closeButton){var v=this._closeButton=ht("a",n+"-close-button",r);v.setAttribute("role","button"),v.setAttribute("aria-label","Close popup"),v.href="#close",v.innerHTML='<span aria-hidden="true">&#215;</span>',lt(v,"click",function(C){Zt(C),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,r=n.style;r.width="",r.whiteSpace="nowrap";var d=n.offsetWidth;d=Math.min(d,this.options.maxWidth),d=Math.max(d,this.options.minWidth),r.width=d+1+"px",r.whiteSpace="",r.height="";var v=n.offsetHeight,C=this.options.maxHeight,P="leaflet-popup-scrolled";C&&v>C?(r.height=C+"px",it(n,P)):Tt(n,P),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var r=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),d=this._getAnchor();At(this._container,r.add(d))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,r=parseInt(Bt(this._container,"marginBottom"),10)||0,d=this._container.offsetHeight+r,v=this._containerWidth,C=new J(this._containerLeft,-d-this._containerBottom);C._add(H(this._container));var P=n.layerPointToContainerPoint(C),Y=te(this.options.autoPanPadding),de=te(this.options.autoPanPaddingTopLeft||Y),me=te(this.options.autoPanPaddingBottomRight||Y),Ae=n.getSize(),qe=0,st=0;P.x+v+me.x>Ae.x&&(qe=P.x+v-Ae.x+me.x),P.x-qe-de.x<0&&(qe=P.x-de.x),P.y+d+me.y>Ae.y&&(st=P.y+d-Ae.y+me.y),P.y-st-de.y<0&&(st=P.y-de.y),(qe||st)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([qe,st]))}},_getAnchor:function(){return te(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),ev=function(n,r){return new hr(n,r)};mt.mergeOptions({closePopupOnClick:!0}),mt.include({openPopup:function(n,r,d){return this._initOverlay(hr,n,r,d).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),Nt.include({bindPopup:function(n,r){return this._popup=this._initOverlay(hr,this._popup,n,r),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof Oo||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){ko(n);var r=n.layer||n.target;if(this._popup._source===r&&!(r instanceof ps)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=r,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var fr=Co.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){Co.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){Co.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=Co.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",r=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ht("div",r),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+h(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var r,d,v=this._map,C=this._container,P=v.latLngToContainerPoint(v.getCenter()),Y=v.layerPointToContainerPoint(n),de=this.options.direction,me=C.offsetWidth,Ae=C.offsetHeight,qe=te(this.options.offset),st=this._getAnchor();de==="top"?(r=me/2,d=Ae):de==="bottom"?(r=me/2,d=0):de==="center"?(r=me/2,d=Ae/2):de==="right"?(r=0,d=Ae/2):de==="left"?(r=me,d=Ae/2):Y.x<P.x?(de="right",r=0,d=Ae/2):(de="left",r=me+(qe.x+st.x)*2,d=Ae/2),n=n.subtract(te(r,d,!0)).add(qe).add(st),Tt(C,"leaflet-tooltip-right"),Tt(C,"leaflet-tooltip-left"),Tt(C,"leaflet-tooltip-top"),Tt(C,"leaflet-tooltip-bottom"),it(C,"leaflet-tooltip-"+de),At(C,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&qt(this._container,n)},_animateZoom:function(n){var r=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(r)},_getAnchor:function(){return te(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),tv=function(n,r){return new fr(n,r)};mt.include({openTooltip:function(n,r,d){return this._initOverlay(fr,n,r,d).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),Nt.include({bindTooltip:function(n,r){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(fr,this._tooltip,n,r),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var r=n?"off":"on",d={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?d.add=this._openTooltip:(d.mouseover=this._openTooltip,d.mouseout=this.closeTooltip,d.click=this._openTooltip,this._map?this._addFocusListeners():d.add=this._addFocusListeners),this._tooltip.options.sticky&&(d.mousemove=this._moveTooltip),this[r](d),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof Oo||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var r=typeof n.getElement=="function"&&n.getElement();r&&(lt(r,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),lt(r,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var r=typeof n.getElement=="function"&&n.getElement();r&&r.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var r=this;this._map.once("moveend",function(){r._openOnceFlag=!1,r._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var r=n.latlng,d,v;this._tooltip.options.sticky&&n.originalEvent&&(d=this._map.mouseEventToContainerPoint(n.originalEvent),v=this._map.containerPointToLayerPoint(d),r=this._map.layerPointToLatLng(v)),this._tooltip.setLatLng(r)}});var ku=pi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var r=n&&n.tagName==="DIV"?n:document.createElement("div"),d=this.options;if(d.html instanceof Element?(_o(r),r.appendChild(d.html)):r.innerHTML=d.html!==!1?d.html:"",d.bgPos){var v=te(d.bgPos);r.style.backgroundPosition=-v.x+"px "+-v.y+"px"}return this._setIconStyles(r,"icon"),r},createShadow:function(){return null}});function nv(n){return new ku(n)}pi.Default=ta;var na=Nt.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Xe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){S(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),kt(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Un(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(zn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof J?n:new J(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var r=this.getPane().children,d=-n(-1/0,1/0),v=0,C=r.length,P;v<C;v++)P=r[v].style.zIndex,r[v]!==this._container&&P&&(d=n(d,+P));isFinite(d)&&(this.options.zIndex=d+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Xe.ielt9){qt(this._container,this.options.opacity);var n=+new Date,r=!1,d=!1;for(var v in this._tiles){var C=this._tiles[v];if(!(!C.current||!C.loaded)){var P=Math.min(1,(n-C.loaded)/200);qt(C.el,P),P<1?r=!0:(C.active?d=!0:this._onOpaqueTile(C),C.active=!0)}}d&&!this._noPrune&&this._pruneTiles(),r&&(ve(this._fadeFrame),this._fadeFrame=re(this._updateOpacity,this))}},_onOpaqueTile:y,_initContainer:function(){this._container||(this._container=ht("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,r=this.options.maxZoom;if(n!==void 0){for(var d in this._levels)d=Number(d),this._levels[d].el.children.length||d===n?(this._levels[d].el.style.zIndex=r-Math.abs(n-d),this._onUpdateLevel(d)):(kt(this._levels[d].el),this._removeTilesAtZoom(d),this._onRemoveLevel(d),delete this._levels[d]);var v=this._levels[n],C=this._map;return v||(v=this._levels[n]={},v.el=ht("div","leaflet-tile-container leaflet-zoom-animated",this._container),v.el.style.zIndex=r,v.origin=C.project(C.unproject(C.getPixelOrigin()),n).round(),v.zoom=n,this._setZoomTransform(v,C.getCenter(),C.getZoom()),y(v.el.offsetWidth),this._onCreateLevel(v)),this._level=v,v}},_onUpdateLevel:y,_onRemoveLevel:y,_onCreateLevel:y,_pruneTiles:function(){if(this._map){var n,r,d=this._map.getZoom();if(d>this.options.maxZoom||d<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)r=this._tiles[n],r.retain=r.current;for(n in this._tiles)if(r=this._tiles[n],r.current&&!r.active){var v=r.coords;this._retainParent(v.x,v.y,v.z,v.z-5)||this._retainChildren(v.x,v.y,v.z,v.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var r in this._tiles)this._tiles[r].coords.z===n&&this._removeTile(r)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)kt(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,r,d,v){var C=Math.floor(n/2),P=Math.floor(r/2),Y=d-1,de=new J(+C,+P);de.z=+Y;var me=this._tileCoordsToKey(de),Ae=this._tiles[me];return Ae&&Ae.active?(Ae.retain=!0,!0):(Ae&&Ae.loaded&&(Ae.retain=!0),Y>v?this._retainParent(C,P,Y,v):!1)},_retainChildren:function(n,r,d,v){for(var C=2*n;C<2*n+2;C++)for(var P=2*r;P<2*r+2;P++){var Y=new J(C,P);Y.z=d+1;var de=this._tileCoordsToKey(Y),me=this._tiles[de];if(me&&me.active){me.retain=!0;continue}else me&&me.loaded&&(me.retain=!0);d+1<v&&this._retainChildren(C,P,d+1,v)}},_resetView:function(n){var r=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),r,r)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var r=this.options;return r.minNativeZoom!==void 0&&n<r.minNativeZoom?r.minNativeZoom:r.maxNativeZoom!==void 0&&r.maxNativeZoom<n?r.maxNativeZoom:n},_setView:function(n,r,d,v){var C=Math.round(r);this.options.maxZoom!==void 0&&C>this.options.maxZoom||this.options.minZoom!==void 0&&C<this.options.minZoom?C=void 0:C=this._clampZoom(C);var P=this.options.updateWhenZooming&&C!==this._tileZoom;(!v||P)&&(this._tileZoom=C,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),C!==void 0&&this._update(n),d||this._pruneTiles(),this._noPrune=!!d),this._setZoomTransforms(n,r)},_setZoomTransforms:function(n,r){for(var d in this._levels)this._setZoomTransform(this._levels[d],n,r)},_setZoomTransform:function(n,r,d){var v=this._map.getZoomScale(d,n.zoom),C=n.origin.multiplyBy(v).subtract(this._map._getNewPixelOrigin(r,d)).round();Xe.any3d?fn(n.el,C,v):At(n.el,C)},_resetGrid:function(){var n=this._map,r=n.options.crs,d=this._tileSize=this.getTileSize(),v=this._tileZoom,C=this._map.getPixelWorldBounds(this._tileZoom);C&&(this._globalTileRange=this._pxBoundsToTileRange(C)),this._wrapX=r.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,r.wrapLng[0]],v).x/d.x),Math.ceil(n.project([0,r.wrapLng[1]],v).x/d.y)],this._wrapY=r.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([r.wrapLat[0],0],v).y/d.x),Math.ceil(n.project([r.wrapLat[1],0],v).y/d.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var r=this._map,d=r._animatingZoom?Math.max(r._animateToZoom,r.getZoom()):r.getZoom(),v=r.getZoomScale(d,this._tileZoom),C=r.project(n,this._tileZoom).floor(),P=r.getSize().divideBy(v*2);return new ke(C.subtract(P),C.add(P))},_update:function(n){var r=this._map;if(r){var d=this._clampZoom(r.getZoom());if(n===void 0&&(n=r.getCenter()),this._tileZoom!==void 0){var v=this._getTiledPixelBounds(n),C=this._pxBoundsToTileRange(v),P=C.getCenter(),Y=[],de=this.options.keepBuffer,me=new ke(C.getBottomLeft().subtract([de,-de]),C.getTopRight().add([de,-de]));if(!(isFinite(C.min.x)&&isFinite(C.min.y)&&isFinite(C.max.x)&&isFinite(C.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ae in this._tiles){var qe=this._tiles[Ae].coords;(qe.z!==this._tileZoom||!me.contains(new J(qe.x,qe.y)))&&(this._tiles[Ae].current=!1)}if(Math.abs(d-this._tileZoom)>1){this._setView(n,d);return}for(var st=C.min.y;st<=C.max.y;st++)for(var ft=C.min.x;ft<=C.max.x;ft++){var pn=new J(ft,st);if(pn.z=this._tileZoom,!!this._isValidTile(pn)){var Yt=this._tiles[this._tileCoordsToKey(pn)];Yt?Yt.current=!0:Y.push(pn)}}if(Y.sort(function(Cn,yi){return Cn.distanceTo(P)-yi.distanceTo(P)}),Y.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Zn=document.createDocumentFragment();for(ft=0;ft<Y.length;ft++)this._addTile(Y[ft],Zn);this._level.el.appendChild(Zn)}}}},_isValidTile:function(n){var r=this._map.options.crs;if(!r.infinite){var d=this._globalTileRange;if(!r.wrapLng&&(n.x<d.min.x||n.x>d.max.x)||!r.wrapLat&&(n.y<d.min.y||n.y>d.max.y))return!1}if(!this.options.bounds)return!0;var v=this._tileCoordsToBounds(n);return Ee(this.options.bounds).overlaps(v)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var r=this._map,d=this.getTileSize(),v=n.scaleBy(d),C=v.add(d),P=r.unproject(v,n.z),Y=r.unproject(C,n.z);return[P,Y]},_tileCoordsToBounds:function(n){var r=this._tileCoordsToNwSe(n),d=new oe(r[0],r[1]);return this.options.noWrap||(d=this._map.wrapLatLngBounds(d)),d},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var r=n.split(":"),d=new J(+r[0],+r[1]);return d.z=+r[2],d},_removeTile:function(n){var r=this._tiles[n];r&&(kt(r.el),delete this._tiles[n],this.fire("tileunload",{tile:r.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){it(n,"leaflet-tile");var r=this.getTileSize();n.style.width=r.x+"px",n.style.height=r.y+"px",n.onselectstart=y,n.onmousemove=y,Xe.ielt9&&this.options.opacity<1&&qt(n,this.options.opacity)},_addTile:function(n,r){var d=this._getTilePos(n),v=this._tileCoordsToKey(n),C=this.createTile(this._wrapCoords(n),l(this._tileReady,this,n));this._initTile(C),this.createTile.length<2&&re(l(this._tileReady,this,n,null,C)),At(C,d),this._tiles[v]={el:C,coords:n,current:!0},r.appendChild(C),this.fire("tileloadstart",{tile:C,coords:n})},_tileReady:function(n,r,d){r&&this.fire("tileerror",{error:r,tile:d,coords:n});var v=this._tileCoordsToKey(n);d=this._tiles[v],d&&(d.loaded=+new Date,this._map._fadeAnimated?(qt(d.el,0),ve(this._fadeFrame),this._fadeFrame=re(this._updateOpacity,this)):(d.active=!0,this._pruneTiles()),r||(it(d.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:d.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Xe.ielt9||!this._map._fadeAnimated?re(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var r=new J(this._wrapX?f(n.x,this._wrapX):n.x,this._wrapY?f(n.y,this._wrapY):n.y);return r.z=n.z,r},_pxBoundsToTileRange:function(n){var r=this.getTileSize();return new ke(n.min.unscaleBy(r).floor(),n.max.unscaleBy(r).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function ov(n){return new na(n)}var gi=na.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,r){this._url=n,r=S(this,r),r.detectRetina&&Xe.retina&&r.maxZoom>0?(r.tileSize=Math.floor(r.tileSize/2),r.zoomReverse?(r.zoomOffset--,r.minZoom=Math.min(r.maxZoom,r.minZoom+1)):(r.zoomOffset++,r.maxZoom=Math.max(r.minZoom,r.maxZoom-1)),r.minZoom=Math.max(0,r.minZoom)):r.zoomReverse?r.minZoom=Math.min(r.maxZoom,r.minZoom):r.maxZoom=Math.max(r.minZoom,r.maxZoom),typeof r.subdomains=="string"&&(r.subdomains=r.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,r){return this._url===n&&r===void 0&&(r=!0),this._url=n,r||this.redraw(),this},createTile:function(n,r){var d=document.createElement("img");return lt(d,"load",l(this._tileOnLoad,this,r,d)),lt(d,"error",l(this._tileOnError,this,r,d)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(d.referrerPolicy=this.options.referrerPolicy),d.alt="",d.src=this.getTileUrl(n),d},getTileUrl:function(n){var r={r:Xe.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var d=this._globalTileRange.max.y-n.y;this.options.tms&&(r.y=d),r["-y"]=d}return M(this._url,s(r,this.options))},_tileOnLoad:function(n,r){Xe.ielt9?setTimeout(l(n,this,null,r),0):n(null,r)},_tileOnError:function(n,r,d){var v=this.options.errorTileUrl;v&&r.getAttribute("src")!==v&&(r.src=v),n(d,r)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,r=this.options.maxZoom,d=this.options.zoomReverse,v=this.options.zoomOffset;return d&&(n=r-n),n+v},_getSubdomain:function(n){var r=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[r]},_abortLoading:function(){var n,r;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(r=this._tiles[n].el,r.onload=y,r.onerror=y,!r.complete)){r.src=k;var d=this._tiles[n].coords;kt(r),delete this._tiles[n],this.fire("tileabort",{tile:r,coords:d})}},_removeTile:function(n){var r=this._tiles[n];if(r)return r.el.setAttribute("src",k),na.prototype._removeTile.call(this,n)},_tileReady:function(n,r,d){if(!(!this._map||d&&d.getAttribute("src")===k))return na.prototype._tileReady.call(this,n,r,d)}});function bu(n,r){return new gi(n,r)}var wu=gi.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,r){this._url=n;var d=s({},this.defaultWmsParams);for(var v in r)v in this.options||(d[v]=r[v]);r=S(this,r);var C=r.detectRetina&&Xe.retina?2:1,P=this.getTileSize();d.width=P.x*C,d.height=P.y*C,this.wmsParams=d},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var r=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[r]=this._crs.code,gi.prototype.onAdd.call(this,n)},getTileUrl:function(n){var r=this._tileCoordsToNwSe(n),d=this._crs,v=Oe(d.project(r[0]),d.project(r[1])),C=v.min,P=v.max,Y=(this._wmsVersion>=1.3&&this._crs===yt?[C.y,C.x,P.y,P.x]:[C.x,C.y,P.x,P.y]).join(","),de=gi.prototype.getTileUrl.call(this,n);return de+R(this.wmsParams,de,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Y},setParams:function(n,r){return s(this.wmsParams,n),r||this.redraw(),this}});function sv(n,r){return new wu(n,r)}gi.WMS=wu,bu.wms=sv;var No=Nt.extend({options:{padding:.1},initialize:function(n){S(this,n),h(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),it(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,r){var d=this._map.getZoomScale(r,this._zoom),v=this._map.getSize().multiplyBy(.5+this.options.padding),C=this._map.project(this._center,r),P=v.multiplyBy(-d).add(C).subtract(this._map._getNewPixelOrigin(n,r));Xe.any3d?fn(this._container,P,d):At(this._container,P)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,r=this._map.getSize(),d=this._map.containerPointToLayerPoint(r.multiplyBy(-n)).round();this._bounds=new ke(d,d.add(r.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Cu=No.extend({options:{tolerance:0},getEvents:function(){var n=No.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){No.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");lt(n,"mousemove",this._onMouseMove,this),lt(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),lt(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){ve(this._redrawRequest),delete this._ctx,kt(this._container),Lt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var r in this._layers)n=this._layers[r],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){No.prototype._update.call(this);var n=this._bounds,r=this._container,d=n.getSize(),v=Xe.retina?2:1;At(r,n.min),r.width=v*d.x,r.height=v*d.y,r.style.width=d.x+"px",r.style.height=d.y+"px",Xe.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){No.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[h(n)]=n;var r=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=r),this._drawLast=r,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var r=n._order,d=r.next,v=r.prev;d?d.prev=v:this._drawLast=v,v?v.next=d:this._drawFirst=d,delete n._order,delete this._layers[h(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var r=n.options.dashArray.split(/[, ]+/),d=[],v,C;for(C=0;C<r.length;C++){if(v=Number(r[C]),isNaN(v))return;d.push(v)}n.options._dashArray=d}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||re(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var r=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ke,this._redrawBounds.extend(n._pxBounds.min.subtract([r,r])),this._redrawBounds.extend(n._pxBounds.max.add([r,r]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var r=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,r.x,r.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,r=this._redrawBounds;if(this._ctx.save(),r){var d=r.getSize();this._ctx.beginPath(),this._ctx.rect(r.min.x,r.min.y,d.x,d.y),this._ctx.clip()}this._drawing=!0;for(var v=this._drawFirst;v;v=v.next)n=v.layer,(!r||n._pxBounds&&n._pxBounds.intersects(r))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,r){if(this._drawing){var d,v,C,P,Y=n._parts,de=Y.length,me=this._ctx;if(de){for(me.beginPath(),d=0;d<de;d++){for(v=0,C=Y[d].length;v<C;v++)P=Y[d][v],me[v?"lineTo":"moveTo"](P.x,P.y);r&&me.closePath()}this._fillStroke(me,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var r=n._point,d=this._ctx,v=Math.max(Math.round(n._radius),1),C=(Math.max(Math.round(n._radiusY),1)||v)/v;C!==1&&(d.save(),d.scale(1,C)),d.beginPath(),d.arc(r.x,r.y/C,v,0,Math.PI*2,!1),C!==1&&d.restore(),this._fillStroke(d,n)}},_fillStroke:function(n,r){var d=r.options;d.fill&&(n.globalAlpha=d.fillOpacity,n.fillStyle=d.fillColor||d.color,n.fill(d.fillRule||"evenodd")),d.stroke&&d.weight!==0&&(n.setLineDash&&n.setLineDash(r.options&&r.options._dashArray||[]),n.globalAlpha=d.opacity,n.lineWidth=d.weight,n.strokeStyle=d.color,n.lineCap=d.lineCap,n.lineJoin=d.lineJoin,n.stroke())},_onClick:function(n){for(var r=this._map.mouseEventToLayerPoint(n),d,v,C=this._drawFirst;C;C=C.next)d=C.layer,d.options.interactive&&d._containsPoint(r)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(d))&&(v=d);this._fireEvent(v?[v]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var r=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,r)}},_handleMouseOut:function(n){var r=this._hoveredLayer;r&&(Tt(this._container,"leaflet-interactive"),this._fireEvent([r],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,r){if(!this._mouseHoverThrottled){for(var d,v,C=this._drawFirst;C;C=C.next)d=C.layer,d.options.interactive&&d._containsPoint(r)&&(v=d);v!==this._hoveredLayer&&(this._handleMouseOut(n),v&&(it(this._container,"leaflet-interactive"),this._fireEvent([v],n,"mouseover"),this._hoveredLayer=v)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,r,d){this._map._fireDOMEvent(r,d||r.type,n)},_bringToFront:function(n){var r=n._order;if(r){var d=r.next,v=r.prev;if(d)d.prev=v;else return;v?v.next=d:d&&(this._drawFirst=d),r.prev=this._drawLast,this._drawLast.next=r,r.next=null,this._drawLast=r,this._requestRedraw(n)}},_bringToBack:function(n){var r=n._order;if(r){var d=r.next,v=r.prev;if(v)v.next=d;else return;d?d.prev=v:v&&(this._drawLast=v),r.prev=null,r.next=this._drawFirst,this._drawFirst.prev=r,this._drawFirst=r,this._requestRedraw(n)}}});function Lu(n){return Xe.canvas?new Cu(n):null}var oa=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),iv={_initContainer:function(){this._container=ht("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(No.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var r=n._container=oa("shape");it(r,"leaflet-vml-shape "+(this.options.className||"")),r.coordsize="1 1",n._path=oa("path"),r.appendChild(n._path),this._updateStyle(n),this._layers[h(n)]=n},_addPath:function(n){var r=n._container;this._container.appendChild(r),n.options.interactive&&n.addInteractiveTarget(r)},_removePath:function(n){var r=n._container;kt(r),n.removeInteractiveTarget(r),delete this._layers[h(n)]},_updateStyle:function(n){var r=n._stroke,d=n._fill,v=n.options,C=n._container;C.stroked=!!v.stroke,C.filled=!!v.fill,v.stroke?(r||(r=n._stroke=oa("stroke")),C.appendChild(r),r.weight=v.weight+"px",r.color=v.color,r.opacity=v.opacity,v.dashArray?r.dashStyle=_(v.dashArray)?v.dashArray.join(" "):v.dashArray.replace(/( *, *)/g," "):r.dashStyle="",r.endcap=v.lineCap.replace("butt","flat"),r.joinstyle=v.lineJoin):r&&(C.removeChild(r),n._stroke=null),v.fill?(d||(d=n._fill=oa("fill")),C.appendChild(d),d.color=v.fillColor||v.color,d.opacity=v.fillOpacity):d&&(C.removeChild(d),n._fill=null)},_updateCircle:function(n){var r=n._point.round(),d=Math.round(n._radius),v=Math.round(n._radiusY||d);this._setPath(n,n._empty()?"M0 0":"AL "+r.x+","+r.y+" "+d+","+v+" 0,"+65535*360)},_setPath:function(n,r){n._path.v=r},_bringToFront:function(n){Un(n._container)},_bringToBack:function(n){zn(n._container)}},pr=Xe.vml?oa:j,sa=No.extend({_initContainer:function(){this._container=pr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=pr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){kt(this._container),Lt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){No.prototype._update.call(this);var n=this._bounds,r=n.getSize(),d=this._container;(!this._svgSize||!this._svgSize.equals(r))&&(this._svgSize=r,d.setAttribute("width",r.x),d.setAttribute("height",r.y)),At(d,n.min),d.setAttribute("viewBox",[n.min.x,n.min.y,r.x,r.y].join(" ")),this.fire("update")}},_initPath:function(n){var r=n._path=pr("path");n.options.className&&it(r,n.options.className),n.options.interactive&&it(r,"leaflet-interactive"),this._updateStyle(n),this._layers[h(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){kt(n._path),n.removeInteractiveTarget(n._path),delete this._layers[h(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var r=n._path,d=n.options;r&&(d.stroke?(r.setAttribute("stroke",d.color),r.setAttribute("stroke-opacity",d.opacity),r.setAttribute("stroke-width",d.weight),r.setAttribute("stroke-linecap",d.lineCap),r.setAttribute("stroke-linejoin",d.lineJoin),d.dashArray?r.setAttribute("stroke-dasharray",d.dashArray):r.removeAttribute("stroke-dasharray"),d.dashOffset?r.setAttribute("stroke-dashoffset",d.dashOffset):r.removeAttribute("stroke-dashoffset")):r.setAttribute("stroke","none"),d.fill?(r.setAttribute("fill",d.fillColor||d.color),r.setAttribute("fill-opacity",d.fillOpacity),r.setAttribute("fill-rule",d.fillRule||"evenodd")):r.setAttribute("fill","none"))},_updatePoly:function(n,r){this._setPath(n,O(n._parts,r))},_updateCircle:function(n){var r=n._point,d=Math.max(Math.round(n._radius),1),v=Math.max(Math.round(n._radiusY),1)||d,C="a"+d+","+v+" 0 1,0 ",P=n._empty()?"M0 0":"M"+(r.x-d)+","+r.y+C+d*2+",0 "+C+-d*2+",0 ";this._setPath(n,P)},_setPath:function(n,r){n._path.setAttribute("d",r)},_bringToFront:function(n){Un(n._path)},_bringToBack:function(n){zn(n._path)}});Xe.vml&&sa.include(iv);function Su(n){return Xe.svg||Xe.vml?new sa(n):null}mt.include({getRenderer:function(n){var r=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return r||(r=this._renderer=this._createRenderer()),this.hasLayer(r)||this.addLayer(r),r},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var r=this._paneRenderers[n];return r===void 0&&(r=this._createRenderer({pane:n}),this._paneRenderers[n]=r),r},_createRenderer:function(n){return this.options.preferCanvas&&Lu(n)||Su(n)}});var xu=vi.extend({initialize:function(n,r){vi.prototype.initialize.call(this,this._boundsToLatLngs(n),r)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=Ee(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function av(n,r){return new xu(n,r)}sa.create=pr,sa.pointsToPath=O,Bo.geometryToLayer=rr,Bo.coordsToLatLng=Rl,Bo.coordsToLatLngs=lr,Bo.latLngToCoords=Bl,Bo.latLngsToCoords=cr,Bo.getFeature=mi,Bo.asFeature=ur,mt.mergeOptions({boxZoom:!0});var Tu=Vn.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){lt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Lt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){kt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),V(),ot(),this._startPoint=this._map.mouseEventToContainerPoint(n),lt(document,{contextmenu:ko,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=ht("div","leaflet-zoom-box",this._container),it(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var r=new ke(this._point,this._startPoint),d=r.getSize();At(this._box,r.min),this._box.style.width=d.x+"px",this._box.style.height=d.y+"px"},_finish:function(){this._moved&&(kt(this._box),Tt(this._container,"leaflet-crosshair")),ie(),Ht(),Lt(document,{contextmenu:ko,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var r=new oe(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(r).fire("boxzoomend",{boxZoomBounds:r})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});mt.addInitHook("addHandler","boxZoom",Tu),mt.mergeOptions({doubleClickZoom:!0});var Iu=Vn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var r=this._map,d=r.getZoom(),v=r.options.zoomDelta,C=n.originalEvent.shiftKey?d-v:d+v;r.options.doubleClickZoom==="center"?r.setZoom(C):r.setZoomAround(n.containerPoint,C)}});mt.addInitHook("addHandler","doubleClickZoom",Iu),mt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var $u=Vn.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new bo(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}it(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Tt(this._map._container,"leaflet-grab"),Tt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var r=Ee(this._map.options.maxBounds);this._offsetLimit=Oe(this._map.latLngToContainerPoint(r.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(r.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var r=this._lastTime=+new Date,d=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(d),this._times.push(r),this._prunePositions(r)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),r=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=r.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,r){return n-(n-r)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),r=this._offsetLimit;n.x<r.min.x&&(n.x=this._viscousLimit(n.x,r.min.x)),n.y<r.min.y&&(n.y=this._viscousLimit(n.y,r.min.y)),n.x>r.max.x&&(n.x=this._viscousLimit(n.x,r.max.x)),n.y>r.max.y&&(n.y=this._viscousLimit(n.y,r.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,r=Math.round(n/2),d=this._initialWorldOffset,v=this._draggable._newPos.x,C=(v-r+d)%n+r-d,P=(v+r+d)%n-r-d,Y=Math.abs(C+d)<Math.abs(P+d)?C:P;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Y},_onDragEnd:function(n){var r=this._map,d=r.options,v=!d.inertia||n.noInertia||this._times.length<2;if(r.fire("dragend",n),v)r.fire("moveend");else{this._prunePositions(+new Date);var C=this._lastPos.subtract(this._positions[0]),P=(this._lastTime-this._times[0])/1e3,Y=d.easeLinearity,de=C.multiplyBy(Y/P),me=de.distanceTo([0,0]),Ae=Math.min(d.inertiaMaxSpeed,me),qe=de.multiplyBy(Ae/me),st=Ae/(d.inertiaDeceleration*Y),ft=qe.multiplyBy(-st/2).round();!ft.x&&!ft.y?r.fire("moveend"):(ft=r._limitOffset(ft,r.options.maxBounds),re(function(){r.panBy(ft,{duration:st,easeLinearity:Y,noMoveStart:!0,animate:!0})}))}}});mt.addInitHook("addHandler","dragging",$u),mt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Mu=Vn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),lt(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Lt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,r=document.documentElement,d=n.scrollTop||r.scrollTop,v=n.scrollLeft||r.scrollLeft;this._map._container.focus(),window.scrollTo(v,d)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var r=this._panKeys={},d=this.keyCodes,v,C;for(v=0,C=d.left.length;v<C;v++)r[d.left[v]]=[-1*n,0];for(v=0,C=d.right.length;v<C;v++)r[d.right[v]]=[n,0];for(v=0,C=d.down.length;v<C;v++)r[d.down[v]]=[0,n];for(v=0,C=d.up.length;v<C;v++)r[d.up[v]]=[0,-1*n]},_setZoomDelta:function(n){var r=this._zoomKeys={},d=this.keyCodes,v,C;for(v=0,C=d.zoomIn.length;v<C;v++)r[d.zoomIn[v]]=n;for(v=0,C=d.zoomOut.length;v<C;v++)r[d.zoomOut[v]]=-n},_addHooks:function(){lt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Lt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var r=n.keyCode,d=this._map,v;if(r in this._panKeys){if(!d._panAnim||!d._panAnim._inProgress)if(v=this._panKeys[r],n.shiftKey&&(v=te(v).multiplyBy(3)),d.options.maxBounds&&(v=d._limitOffset(te(v),d.options.maxBounds)),d.options.worldCopyJump){var C=d.wrapLatLng(d.unproject(d.project(d.getCenter()).add(v)));d.panTo(C)}else d.panBy(v)}else if(r in this._zoomKeys)d.setZoom(d.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[r]);else if(r===27&&d._popup&&d._popup.options.closeOnEscapeKey)d.closePopup();else return;ko(n)}}});mt.addInitHook("addHandler","keyboard",Mu),mt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Au=Vn.extend({addHooks:function(){lt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Lt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var r=qa(n),d=this._map.options.wheelDebounceTime;this._delta+=r,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var v=Math.max(d-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),v),ko(n)},_performZoom:function(){var n=this._map,r=n.getZoom(),d=this._map.options.zoomSnap||0;n._stop();var v=this._delta/(this._map.options.wheelPxPerZoomLevel*4),C=4*Math.log(2/(1+Math.exp(-Math.abs(v))))/Math.LN2,P=d?Math.ceil(C/d)*d:C,Y=n._limitZoom(r+(this._delta>0?P:-P))-r;this._delta=0,this._startTime=null,Y&&(n.options.scrollWheelZoom==="center"?n.setZoom(r+Y):n.setZoomAround(this._lastMousePos,r+Y))}});mt.addInitHook("addHandler","scrollWheelZoom",Au);var rv=600;mt.mergeOptions({tapHold:Xe.touchNative&&Xe.safari&&Xe.mobile,tapTolerance:15});var Eu=Vn.extend({addHooks:function(){lt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Lt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var r=n.touches[0];this._startPos=this._newPos=new J(r.clientX,r.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(lt(document,"touchend",Zt),lt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",r))},this),rv),lt(document,"touchend touchcancel contextmenu",this._cancel,this),lt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){Lt(document,"touchend",Zt),Lt(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),Lt(document,"touchend touchcancel contextmenu",this._cancel,this),Lt(document,"touchmove",this._onMove,this)},_onMove:function(n){var r=n.touches[0];this._newPos=new J(r.clientX,r.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,r){var d=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:r.screenX,screenY:r.screenY,clientX:r.clientX,clientY:r.clientY});d._simulated=!0,r.target.dispatchEvent(d)}});mt.addInitHook("addHandler","tapHold",Eu),mt.mergeOptions({touchZoom:Xe.touch,bounceAtZoomLimits:!0});var Pu=Vn.extend({addHooks:function(){it(this._map._container,"leaflet-touch-zoom"),lt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Tt(this._map._container,"leaflet-touch-zoom"),Lt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var r=this._map;if(!(!n.touches||n.touches.length!==2||r._animatingZoom||this._zooming)){var d=r.mouseEventToContainerPoint(n.touches[0]),v=r.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=r.getSize()._divideBy(2),this._startLatLng=r.containerPointToLatLng(this._centerPoint),r.options.touchZoom!=="center"&&(this._pinchStartLatLng=r.containerPointToLatLng(d.add(v)._divideBy(2))),this._startDist=d.distanceTo(v),this._startZoom=r.getZoom(),this._moved=!1,this._zooming=!0,r._stop(),lt(document,"touchmove",this._onTouchMove,this),lt(document,"touchend touchcancel",this._onTouchEnd,this),Zt(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var r=this._map,d=r.mouseEventToContainerPoint(n.touches[0]),v=r.mouseEventToContainerPoint(n.touches[1]),C=d.distanceTo(v)/this._startDist;if(this._zoom=r.getScaleZoom(C,this._startZoom),!r.options.bounceAtZoomLimits&&(this._zoom<r.getMinZoom()&&C<1||this._zoom>r.getMaxZoom()&&C>1)&&(this._zoom=r._limitZoom(this._zoom)),r.options.touchZoom==="center"){if(this._center=this._startLatLng,C===1)return}else{var P=d._add(v)._divideBy(2)._subtract(this._centerPoint);if(C===1&&P.x===0&&P.y===0)return;this._center=r.unproject(r.project(this._pinchStartLatLng,this._zoom).subtract(P),this._zoom)}this._moved||(r._moveStart(!0,!1),this._moved=!0),ve(this._animRequest);var Y=l(r._move,r,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=re(Y,this,!0),Zt(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,ve(this._animRequest),Lt(document,"touchmove",this._onTouchMove,this),Lt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});mt.addInitHook("addHandler","touchZoom",Pu),mt.BoxZoom=Tu,mt.DoubleClickZoom=Iu,mt.Drag=$u,mt.Keyboard=Mu,mt.ScrollWheelZoom=Au,mt.TapHold=Eu,mt.TouchZoom=Pu,o.Bounds=ke,o.Browser=Xe,o.CRS=le,o.Canvas=Cu,o.Circle=Ol,o.CircleMarker=ar,o.Class=Re,o.Control=En,o.DivIcon=ku,o.DivOverlay=Co,o.DomEvent=Sl,o.DomUtil=Cl,o.Draggable=bo,o.Evented=Q,o.FeatureGroup=Oo,o.GeoJSON=Bo,o.GridLayer=na,o.Handler=Vn,o.Icon=pi,o.ImageOverlay=dr,o.LatLng=be,o.LatLngBounds=oe,o.Layer=Nt,o.LayerGroup=Gn,o.LineUtil=sr,o.Map=mt,o.Marker=ir,o.Mixin=Ml,o.Path=ps,o.Point=J,o.PolyUtil=Al,o.Polygon=vi,o.Polyline=Ro,o.Popup=hr,o.PosAnimation=Ka,o.Projection=Pe,o.Rectangle=xu,o.Renderer=No,o.SVG=sa,o.SVGOverlay=_u,o.TileLayer=gi,o.Tooltip=fr,o.Transformation=Le,o.Util=Ie,o.VideoOverlay=yu,o.bind=l,o.bounds=Oe,o.canvas=Lu,o.circle=Wp,o.circleMarker=jp,o.control=Ns,o.divIcon=nv,o.extend=s,o.featureGroup=Vp,o.geoJSON=gu,o.geoJson=Yp,o.gridLayer=ov,o.icon=Gp,o.imageOverlay=Jp,o.latLng=Se,o.latLngBounds=Ee,o.layerGroup=Hp,o.map=xl,o.marker=Zp,o.point=te,o.polygon=Kp,o.polyline=qp,o.popup=ev,o.rectangle=av,o.setOptions=S,o.stamp=h,o.svg=Su,o.svgOverlay=Qp,o.tileLayer=bu,o.tooltip=tv,o.transformation=F,o.version=i,o.videoOverlay=Xp;var lv=window.L;o.noConflict=function(){return window.L=lv,this},window.L=o}))})(pa,pa.exports)),pa.exports}var Vb=Hb();const vn=Ub(Vb);(function(e,t,o){function i(s,a){for(;(s=s.parentElement)&&!s.classList.contains(a););return s}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(s,a){this._map=s,this._container=s._container,this._overlayPane=s._panes.overlayPane,this._popupPane=s._panes.popupPane,a&&a.shapeOptions&&(a.shapeOptions=L.Util.extend({},this.options.shapeOptions,a.shapeOptions)),L.setOptions(this,a);var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(L.DomUtil.disableTextSelection(),s.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(s){L.setOptions(this,s)},_fireCreatedEvent:function(s){this._map.fire(L.Draw.Event.CREATED,{layer:s,layerType:this.type})},_cancelDrawing:function(s){s.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(s,a){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,a&&a.drawError&&(a.drawError=L.Util.extend({},this.options.drawError,a.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var s=this._markers.pop(),a=this._poly,l=a.getLatLngs(),u=l.splice(-1,1)[0];this._poly.setLatLngs(l),this._markerGroup.removeLayer(s),a.getLatLngs().length<2&&this._map.removeLayer(a),this._vertexChanged(u,!1)}},addVertex:function(s){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(s))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(s)),this._poly.addLatLng(s),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(s,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var s=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),a=this._poly.newLatLngIntersects(s[s.length-1]);if(!this.options.allowIntersection&&a||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent),l=this._map.layerPointToLatLng(a);this._currentLatLng=l,this._updateTooltip(l),this._updateGuide(a),this._mouseMarker.setLatLng(l),L.DomEvent.preventDefault(s.originalEvent)},_vertexChanged:function(s,a){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(s,a),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(s){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(s),this._clickHandled=!0,this._disableNewMarkers();var a=s.originalEvent,l=a.clientX,u=a.clientY;this._startPoint.call(this,l,u)}},_startPoint:function(s,a){this._mouseDownOrigin=L.point(s,a)},_onMouseUp:function(s){var a=s.originalEvent,l=a.clientX,u=a.clientY;this._endPoint.call(this,l,u,s),this._clickHandled=null},_endPoint:function(s,a,l){if(this._mouseDownOrigin){var u=L.point(s,a).distanceTo(this._mouseDownOrigin),h=this._calculateFinishDistance(l.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(l.latlng),this._finishShape()):h<10&&L.Browser.touch?this._finishShape():Math.abs(u)<9*(e.devicePixelRatio||1)&&this.addVertex(l.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(s){var a,l,u=s.originalEvent;!u.touches||!u.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(a=u.touches[0].clientX,l=u.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,a,l),this._endPoint.call(this,a,l,s),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(s){var a;if(this._markers.length>0){var l;if(this.type===L.Draw.Polyline.TYPE)l=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;l=this._markers[0]}var u=this._map.latLngToContainerPoint(l.getLatLng()),h=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),p=this._map.latLngToContainerPoint(h.getLatLng());a=u.distanceTo(p)}else a=1/0;return a},_updateFinishHandler:function(){var s=this._markers.length;s>1&&this._markers[s-1].on("click",this._finishShape,this),s>2&&this._markers[s-2].off("click",this._finishShape,this)},_createMarker:function(s){var a=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(a),a},_updateGuide:function(s){var a=this._markers?this._markers.length:0;a>0&&(s=s||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[a-1].getLatLng()),s))},_updateTooltip:function(s){var a=this._getTooltipText();s&&this._tooltip.updatePosition(s),this._errorShown||this._tooltip.updateContent(a)},_drawGuide:function(s,a){var l,u,h,p=Math.floor(Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))),f=this.options.guidelineDistance,y=this.options.maxGuideLineLength,x=p>y?p-y:f;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));x<p;x+=this.options.guidelineDistance)l=x/p,u={x:Math.floor(s.x*(1-l)+l*a.x),y:Math.floor(s.y*(1-l)+l*a.y)},h=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),h.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(h,u)},_updateGuideColor:function(s){if(this._guidesContainer)for(var a=0,l=this._guidesContainer.childNodes.length;a<l;a++)this._guidesContainer.childNodes[a].style.backgroundColor=s},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var s,a,l=this.options.showLength;return this._markers.length===0?s={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(a=l?this._getMeasurementString():"",s=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:a}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:a}),s},_updateRunningMeasure:function(s,a){var l,u,h=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(l=h-(a?2:1),u=L.GeometryUtil.isVersion07x()?s.distanceTo(this._markers[l].getLatLng())*(this.options.factor||1):this._map.distance(s,this._markers[l].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=u*(a?1:-1))},_getMeasurementString:function(){var s,a=this._currentLatLng,l=this._markers[this._markers.length-1].getLatLng();return s=L.GeometryUtil.isVersion07x()?l&&a&&a.distanceTo?this._measurementRunningTotal+a.distanceTo(l)*(this.options.factor||1):this._measurementRunningTotal||0:l&&a?this._measurementRunningTotal+this._map.distance(a,l)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(s,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var s=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(s,a){L.Draw.Polyline.prototype.initialize.call(this,s,a),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var s=this._markers.length;s===1&&this._markers[0].on("click",this._finishShape,this),s>2&&(this._markers[s-1].on("dblclick",this._finishShape,this),s>3&&this._markers[s-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var s,a;return this._markers.length===0?s=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(s=L.drawLocal.draw.handlers.polygon.tooltip.cont,a=this._getMeasurementString()):(s=L.drawLocal.draw.handlers.polygon.tooltip.end,a=this._getMeasurementString()),{text:s,subtext:a}},_getMeasurementString:function(){var s=this._area,a="";return s||this.options.showLength?(this.options.showLength&&(a=L.Draw.Polyline.prototype._getMeasurementString.call(this)),s&&(a+="<br>"+L.GeometryUtil.readableArea(s,this.options.metric,this.options.precision)),a):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(s,a){var l;!this.options.allowIntersection&&this.options.showArea&&(l=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(l)),L.Draw.Polyline.prototype._vertexChanged.call(this,s,a)},_cleanUpShape:function(){var s=this._markers.length;s>0&&(this._markers[0].off("click",this._finishShape,this),s>2&&this._markers[s-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(s,a){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(s){this._isDrawing=!0,this._startLatLng=s.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(s.originalEvent)},_onMouseMove:function(s){var a=s.latlng;this._tooltip.updatePosition(a),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(a))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(s,a){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,a)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(s){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!i(s.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(s){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,s)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,s),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_getTooltipText:function(){var s,a,l,u=L.Draw.SimpleShape.prototype._getTooltipText.call(this),h=this._shape,p=this.options.showArea;return h&&(s=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),a=L.GeometryUtil.geodesicArea(s),l=p?L.GeometryUtil.readableArea(a,this.options.metric):""),{text:u.text,subtext:l}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(s,a){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(s){var a=s.latlng;this._tooltip.updatePosition(a),this._mouseMarker.setLatLng(a),this._marker?(a=this._mouseMarker.getLatLng(),this._marker.setLatLng(a)):(this._marker=this._createMarker(a),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(s){return new L.Marker(s,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(s){this._onMouseMove(s),this._onClick()},_fireCreatedEvent:function(){var s=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(s,a){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,a)},_fireCreatedEvent:function(){var s=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)},_createMarker:function(s){return new L.CircleMarker(s,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(s,a){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,a)},_drawShape:function(s){if(L.GeometryUtil.isVersion07x())var a=this._startLatLng.distanceTo(s);else var a=this._map.distance(this._startLatLng,s);this._shape?this._shape.setRadius(a):(this._shape=new L.Circle(this._startLatLng,a,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_onMouseMove:function(s){var a,l=s.latlng,u=this.options.showRadius,h=this.options.metric;if(this._tooltip.updatePosition(l),this._isDrawing){this._drawShape(l),a=this._shape.getRadius().toFixed(1);var p="";u&&(p=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(a,h,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:p})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(s,a){this._marker=s,L.setOptions(this,a)},addHooks:function(){var s=this._marker;s.dragging.enable(),s.on("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},removeHooks:function(){var s=this._marker;s.dragging.disable(),s.off("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},_onDragEnd:function(s){var a=s.target;a.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:a})},_toggleMarkerHighlight:function(){var s=this._marker._icon;s&&(s.style.display="none",L.DomUtil.hasClass(s,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,-4)):(L.DomUtil.addClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,4)),s.style.display="")},_offsetMarker:function(s,a){var l=parseInt(s.style.marginTop,10)-a,u=parseInt(s.style.marginLeft,10)-a;s.style.marginTop=l+"px",s.style.marginLeft=u+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(s){this.latlngs=[s._latlngs],s._holes&&(this.latlngs=this.latlngs.concat(s._holes)),this._poly=s,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(s){for(var a=0;a<this._verticesHandlers.length;a++)s(this._verticesHandlers[a])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(s){s.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(s){s.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(s){s.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var s=0;s<this.latlngs.length;s++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[s],this._poly.options.poly))},_updateLatLngs:function(s){this.latlngs=[s.layer._latlngs],s.layer._holes&&(this.latlngs=this.latlngs.concat(s.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(s,a,l){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=s,l&&l.drawError&&(l.drawError=L.Util.extend({},this.options.drawError,l.drawError)),this._latlngs=a,L.setOptions(this,l)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var s=this._poly,a=s._path;s instanceof L.Polygon||(s.options.fill=!1,s.options.editing&&(s.options.editing.fill=!1)),a&&s.options.editing&&s.options.editing.className&&(s.options.original.className&&s.options.original.className.split(" ").forEach(function(l){L.DomUtil.removeClass(a,l)}),s.options.editing.className.split(" ").forEach(function(l){L.DomUtil.addClass(a,l)})),s.setStyle(s.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var s=this._poly,a=s._path;a&&s.options.editing&&s.options.editing.className&&(s.options.editing.className.split(" ").forEach(function(l){L.DomUtil.removeClass(a,l)}),s.options.original.className&&s.options.original.className.split(" ").forEach(function(l){L.DomUtil.addClass(a,l)})),s.setStyle(s.options.original),s._map&&(s._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var s,a,l,u,h=this._defaultShape();for(s=0,l=h.length;s<l;s++)u=this._createMarker(h[s],s),u.on("click",this._onMarkerClick,this),u.on("contextmenu",this._onContextMenu,this),this._markers.push(u);var p,f;for(s=0,a=l-1;s<l;a=s++)(s!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(p=this._markers[a],f=this._markers[s],this._createMiddleMarker(p,f),this._updatePrevNext(p,f))},_createMarker:function(s,a){var l=new L.Marker.Touch(s,{draggable:!0,icon:this.options.icon});return l._origLatLng=s,l._index=a,l.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(l),l},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var s=this._defaultShape(),a=[].splice.apply(s,arguments);return this._poly._convertLatLngs(s,!0),this._poly.redraw(),a},_removeMarker:function(s){var a=s._index;this._markerGroup.removeLayer(s),this._markers.splice(a,1),this._spliceLatLngs(a,1),this._updateIndexes(a,-1),s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(s){var a=s.target,l=this._poly,u=L.LatLngUtil.cloneLatLng(a._origLatLng);if(L.extend(a._origLatLng,a._latlng),l.options.poly){var h=l._map._editTooltip;if(!l.options.poly.allowIntersection&&l.intersects()){L.extend(a._origLatLng,u),a.setLatLng(u);var p=l.options.color;l.setStyle({color:this.options.drawError.color}),h&&h.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){l.setStyle({color:p}),h&&h.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}a._middleLeft&&a._middleLeft.setLatLng(this._getMiddleLatLng(a._prev,a)),a._middleRight&&a._middleRight.setLatLng(this._getMiddleLatLng(a,a._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var f=this._poly.getLatLngs();this._poly._convertLatLngs(f,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(s){var a=L.Polygon&&this._poly instanceof L.Polygon?4:3,l=s.target;this._defaultShape().length<a||(this._removeMarker(l),this._updatePrevNext(l._prev,l._next),l._middleLeft&&this._markerGroup.removeLayer(l._middleLeft),l._middleRight&&this._markerGroup.removeLayer(l._middleRight),l._prev&&l._next?this._createMiddleMarker(l._prev,l._next):l._prev?l._next||(l._prev._middleRight=null):l._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(s){var a=s.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:a,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),l=this._map.layerPointToLatLng(a),u=s.target;L.extend(u._origLatLng,l),u._middleLeft&&u._middleLeft.setLatLng(this._getMiddleLatLng(u._prev,u)),u._middleRight&&u._middleRight.setLatLng(this._getMiddleLatLng(u,u._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(s,a){this._markerGroup.eachLayer(function(l){l._index>s&&(l._index+=a)})},_createMiddleMarker:function(s,a){var l,u,h,p=this._getMiddleLatLng(s,a),f=this._createMarker(p);f.setOpacity(.6),s._middleRight=a._middleLeft=f,u=function(){f.off("touchmove",u,this);var y=a._index;f._index=y,f.off("click",l,this).on("click",this._onMarkerClick,this),p.lat=f.getLatLng().lat,p.lng=f.getLatLng().lng,this._spliceLatLngs(y,0,p),this._markers.splice(y,0,f),f.setOpacity(1),this._updateIndexes(y,1),a._index++,this._updatePrevNext(s,f),this._updatePrevNext(f,a),this._poly.fire("editstart")},h=function(){f.off("dragstart",u,this),f.off("dragend",h,this),f.off("touchmove",u,this),this._createMiddleMarker(s,f),this._createMiddleMarker(f,a)},l=function(){u.call(this),h.call(this),this._fireEdit()},f.on("click",l,this).on("dragstart",u,this).on("dragend",h,this).on("touchmove",u,this),this._markerGroup.addLayer(f)},_updatePrevNext:function(s,a){s&&(s._next=a),a&&(a._prev=s)},_getMiddleLatLng:function(s,a){var l=this._poly._map,u=l.project(s.getLatLng()),h=l.project(a.getLatLng());return l.unproject(u._add(h)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(s,a){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=s,L.Util.setOptions(this,a)},addHooks:function(){var s=this._shape;this._shape._map&&(this._map=this._shape._map,s.setStyle(s.options.editing),s._map&&(this._map=s._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var s=this._shape;if(s.setStyle(s.options.original),s._map){this._unbindMarker(this._moveMarker);for(var a=0,l=this._resizeMarkers.length;a<l;a++)this._unbindMarker(this._resizeMarkers[a]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(s,a){var l=new L.Marker.Touch(s,{draggable:!0,icon:a,zIndexOffset:10});return this._bindMarker(l),this._markerGroup.addLayer(l),l},_bindMarker:function(s){s.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(s){s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(s){s.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(s){var a=s.target,l=a.getLatLng();a===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(s){s.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(s){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s),typeof this._getCorners=="function"){var a=this._getCorners(),l=s.target,u=l._cornerIndex;l.setOpacity(0),this._oppositeCorner=a[(u+2)%4],this._toggleCornerMarkers(0,u)}this._shape.fire("editstart")},_onTouchMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),l=this._map.layerPointToLatLng(a);return s.target===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),!1},_onTouchEnd:function(s){s.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getBounds(),a=s.getCenter();this._moveMarker=this._createMarker(a,this.options.moveIcon)},_createResizeMarker:function(){var s=this._getCorners();this._resizeMarkers=[];for(var a=0,l=s.length;a<l;a++)this._resizeMarkers.push(this._createMarker(s[a],this.options.resizeIcon)),this._resizeMarkers[a]._cornerIndex=a},_onMarkerDragStart:function(s){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s);var a=this._getCorners(),l=s.target,u=l._cornerIndex;this._oppositeCorner=a[(u+2)%4],this._toggleCornerMarkers(0,u)},_onMarkerDragEnd:function(s){var a,l,u=s.target;u===this._moveMarker&&(a=this._shape.getBounds(),l=a.getCenter(),u.setLatLng(l)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,s)},_move:function(s){for(var a,l=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),u=this._shape.getBounds(),h=u.getCenter(),p=[],f=0,y=l.length;f<y;f++)a=[l[f].lat-h.lat,l[f].lng-h.lng],p.push([s.lat+a[0],s.lng+a[1]]);this._shape.setLatLngs(p),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(s){var a;this._shape.setBounds(L.latLngBounds(s,this._oppositeCorner)),a=this._shape.getBounds(),this._moveMarker.setLatLng(a.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var s=this._shape.getBounds();return[s.getNorthWest(),s.getNorthEast(),s.getSouthEast(),s.getSouthWest()]},_toggleCornerMarkers:function(s){for(var a=0,l=this._resizeMarkers.length;a<l;a++)this._resizeMarkers[a].setOpacity(s)},_repositionCornerMarkers:function(){for(var s=this._getCorners(),a=0,l=this._resizeMarkers.length;a<l;a++)this._resizeMarkers[a].setLatLng(s[a])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getLatLng();this._moveMarker=this._createMarker(s,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(s){if(this._resizeMarkers.length){var a=this._getResizeMarkerPoint(s);this._resizeMarkers[0].setLatLng(a)}this._shape.setLatLng(s),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var s=this._shape.getLatLng(),a=this._getResizeMarkerPoint(s);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(a,this.options.resizeIcon))},_getResizeMarkerPoint:function(s){var a=this._shape._radius*Math.cos(Math.PI/4),l=this._map.project(s);return this._map.unproject([l.x+a,l.y-a])},_resize:function(s){var a=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=a.distanceTo(s):radius=this._map.distance(a,s),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(s,a){var l={};if(s.touches!==void 0){if(!s.touches.length)return;l=s.touches[0]}else if(s.pointerType!=="touch"||(l=s,!this._filterClick(s)))return;var u=this._map.mouseEventToContainerPoint(l),h=this._map.mouseEventToLayerPoint(l),p=this._map.layerPointToLatLng(h);this._map.fire(a,{latlng:p,layerPoint:h,containerPoint:u,pageX:l.pageX,pageY:l.pageY,originalEvent:s})},_filterClick:function(s){var a=s.timeStamp||s.originalEvent.timeStamp,l=L.DomEvent._lastClick&&a-L.DomEvent._lastClick;return l&&l>100&&l<500||s.target._simulatedClick&&!s._simulated?(L.DomEvent.stop(s),!1):(L.DomEvent._lastClick=a,!0)},_onTouchStart:function(s){this._map._loaded&&this._touchEvent(s,"touchstart")},_onTouchEnd:function(s){this._map._loaded&&this._touchEvent(s,"touchend")},_onTouchCancel:function(s){if(this._map._loaded){var a="touchcancel";this._detectIE()&&(a="pointercancel"),this._touchEvent(s,a)}},_onTouchLeave:function(s){this._map._loaded&&this._touchEvent(s,"touchleave")},_onTouchMove:function(s){this._map._loaded&&this._touchEvent(s,"touchmove")},_detectIE:function(){var s=e.navigator.userAgent,a=s.indexOf("MSIE ");if(a>0)return parseInt(s.substring(a+5,s.indexOf(".",a)),10);if(s.indexOf("Trident/")>0){var l=s.indexOf("rv:");return parseInt(s.substring(l+3,s.indexOf(".",l)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var s=this._icon,a=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?a.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):a.concat(["touchcancel"]),L.DomUtil.addClass(s,"leaflet-clickable"),L.DomEvent.on(s,"click",this._onMouseClick,this),L.DomEvent.on(s,"keypress",this._onKeyPress,this);for(var l=0;l<a.length;l++)L.DomEvent.on(s,a[l],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var s=e.navigator.userAgent,a=s.indexOf("MSIE ");if(a>0)return parseInt(s.substring(a+5,s.indexOf(".",a)),10);if(s.indexOf("Trident/")>0){var l=s.indexOf("rv:");return parseInt(s.substring(l+3,s.indexOf(".",l)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.LatLngUtil={cloneLatLngs:function(s){for(var a=[],l=0,u=s.length;l<u;l++)Array.isArray(s[l])?a.push(L.LatLngUtil.cloneLatLngs(s[l])):a.push(this.cloneLatLng(s[l]));return a},cloneLatLng:function(s){return L.latLng(s.lat,s.lng)}},(function(){var s={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(a){var l,u,h=a.length,p=0,f=Math.PI/180;if(h>2){for(var y=0;y<h;y++)l=a[y],u=a[(y+1)%h],p+=(u.lng-l.lng)*f*(2+Math.sin(l.lat*f)+Math.sin(u.lat*f));p=6378137*p*6378137/2}return Math.abs(p)},formattedNumber:function(a,l){var u=parseFloat(a).toFixed(l),h=L.drawLocal.format&&L.drawLocal.format.numeric,p=h&&h.delimiters,f=p&&p.thousands,y=p&&p.decimal;if(f||y){var x=u.split(".");u=f?x[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+f):x[0],y=y||".",x.length>1&&(u=u+y+x[1])}return u},readableArea:function(a,l,f){var h,p,f=L.Util.extend({},s,f);return l?(p=["ha","m"],type=typeof l,type==="string"?p=[l]:type!=="boolean"&&(p=l),h=a>=1e6&&p.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*a,f.km)+" km":a>=1e4&&p.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*a,f.ha)+" ha":L.GeometryUtil.formattedNumber(a,f.m)+" m"):(a/=.836127,h=a>=3097600?L.GeometryUtil.formattedNumber(a/3097600,f.mi)+" mi":a>=4840?L.GeometryUtil.formattedNumber(a/4840,f.ac)+" acres":L.GeometryUtil.formattedNumber(a,f.yd)+" yd"),h},readableDistance:function(a,l,u,h,y){var f,y=L.Util.extend({},s,y);switch(l?typeof l=="string"?l:"metric":u?"feet":h?"nauticalMile":"yards"){case"metric":f=a>1e3?L.GeometryUtil.formattedNumber(a/1e3,y.km)+" km":L.GeometryUtil.formattedNumber(a,y.m)+" m";break;case"feet":a*=3.28083,f=L.GeometryUtil.formattedNumber(a,y.ft)+" ft";break;case"nauticalMile":a*=.53996,f=L.GeometryUtil.formattedNumber(a/1e3,y.nm)+" nm";break;default:a*=1.09361,f=a>1760?L.GeometryUtil.formattedNumber(a/1760,y.mi)+" miles":L.GeometryUtil.formattedNumber(a,y.yd)+" yd"}return f},isVersion07x:function(){var a=L.version.split(".");return parseInt(a[0],10)===0&&parseInt(a[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(s,a,l,u){return this._checkCounterclockwise(s,l,u)!==this._checkCounterclockwise(a,l,u)&&this._checkCounterclockwise(s,a,l)!==this._checkCounterclockwise(s,a,u)},_checkCounterclockwise:function(s,a,l){return(l.y-s.y)*(a.x-s.x)>(a.y-s.y)*(l.x-s.x)}}),L.Polyline.include({intersects:function(){var s,a,l,u=this._getProjectedPoints(),h=u?u.length:0;if(this._tooFewPointsForIntersection())return!1;for(s=h-1;s>=3;s--)if(a=u[s-1],l=u[s],this._lineSegmentsIntersectsRange(a,l,s-2))return!0;return!1},newLatLngIntersects:function(s,a){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(s),a)},newPointIntersects:function(s,a){var l=this._getProjectedPoints(),u=l?l.length:0,h=l?l[u-1]:null,p=u-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(h,s,p,a?1:0)},_tooFewPointsForIntersection:function(s){var a=this._getProjectedPoints(),l=a?a.length:0;return l+=s||0,!a||l<=3},_lineSegmentsIntersectsRange:function(s,a,l,u){var h,p,f=this._getProjectedPoints();u=u||0;for(var y=l;y>u;y--)if(h=f[y-1],p=f[y],L.LineUtil.segmentsIntersect(s,a,h,p))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var s=[],a=this._defaultShape(),l=0;l<a.length;l++)s.push(this._map.latLngToLayerPoint(a[l]));return s}}),L.Polygon.include({intersects:function(){var s,a,l,u,h=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(s=h.length,a=h[0],l=h[s-1],u=s-2,this._lineSegmentsIntersectsRange(l,a,u,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(s){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,s);var a;this._toolbars={},L.DrawToolbar&&this.options.draw&&(a=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=a,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(a=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=a,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(s){var a,l=L.DomUtil.create("div","leaflet-draw"),u=!1;for(var h in this._toolbars)this._toolbars.hasOwnProperty(h)&&(a=this._toolbars[h].addToolbar(s))&&(u||(L.DomUtil.hasClass(a,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(a.childNodes[0],"leaflet-draw-toolbar-top"),u=!0),l.appendChild(a));return l},onRemove:function(){for(var s in this._toolbars)this._toolbars.hasOwnProperty(s)&&this._toolbars[s].removeToolbar()},setDrawingOptions:function(s){for(var a in this._toolbars)this._toolbars[a]instanceof L.DrawToolbar&&this._toolbars[a].setOptions(s)},_toolbarEnabled:function(s){var a=s.target;for(var l in this._toolbars)this._toolbars[l]!==a&&this._toolbars[l].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(s){L.setOptions(this,s),this._modes={},this._actionButtons=[],this._activeMode=null;var a=L.version.split(".");parseInt(a[0],10)===1&&parseInt(a[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(s){var a,l=L.DomUtil.create("div","leaflet-draw-section"),u=0,h=this._toolbarClass||"",p=this.getModeHandlers(s);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=s,a=0;a<p.length;a++)p[a].enabled&&this._initModeHandler(p[a].handler,this._toolbarContainer,u++,h,p[a].title);if(u)return this._lastButtonIndex=--u,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),l.appendChild(this._toolbarContainer),l.appendChild(this._actionsContainer),l},removeToolbar:function(){for(var s in this._modes)this._modes.hasOwnProperty(s)&&(this._disposeButton(this._modes[s].button,this._modes[s].handler.enable,this._modes[s].handler),this._modes[s].handler.disable(),this._modes[s].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var a=0,l=this._actionButtons.length;a<l;a++)this._disposeButton(this._actionButtons[a].button,this._actionButtons[a].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(s,a,l,u,h){var p=s.type;this._modes[p]={},this._modes[p].handler=s,this._modes[p].button=this._createButton({type:p,title:h,className:u+"-"+p,container:a,callback:this._modes[p].handler.enable,context:this._modes[p].handler}),this._modes[p].buttonIndex=l,this._modes[p].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(s){var a=L.DomUtil.create("a",s.className||"",s.container),l=L.DomUtil.create("span","sr-only",s.container);a.href="#",a.appendChild(l),s.title&&(a.title=s.title,l.innerHTML=s.title),s.text&&(a.innerHTML=s.text,l.innerHTML=s.text);var u=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(a,"click",L.DomEvent.stopPropagation).on(a,"mousedown",L.DomEvent.stopPropagation).on(a,"dblclick",L.DomEvent.stopPropagation).on(a,"touchstart",L.DomEvent.stopPropagation).on(a,"click",L.DomEvent.preventDefault).on(a,u,s.callback,s.context),a},_disposeButton:function(s,a){var l=this._detectIOS()?"touchstart":"click";L.DomEvent.off(s,"click",L.DomEvent.stopPropagation).off(s,"mousedown",L.DomEvent.stopPropagation).off(s,"dblclick",L.DomEvent.stopPropagation).off(s,"touchstart",L.DomEvent.stopPropagation).off(s,"click",L.DomEvent.preventDefault).off(s,l,a)},_handlerActivated:function(s){this.disable(),this._activeMode=this._modes[s.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(s){var a,l,u,h,p=this._actionsContainer,f=this.getActions(s),y=f.length;for(l=0,u=this._actionButtons.length;l<u;l++)this._disposeButton(this._actionButtons[l].button,this._actionButtons[l].callback);for(this._actionButtons=[];p.firstChild;)p.removeChild(p.firstChild);for(var x=0;x<y;x++)"enabled"in f[x]&&!f[x].enabled||(a=L.DomUtil.create("li","",p),h=this._createButton({title:f[x].title,text:f[x].text,container:a,callback:f[x].callback,context:f[x].context}),this._actionButtons.push({button:h,callback:f[x].callback}))},_showActionsToolbar:function(){var s=this._activeMode.buttonIndex,a=this._lastButtonIndex,l=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=l+"px",s===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),s===a&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(s){this._map=s,this._popupPane=s._panes.popupPane,this._visible=!1,this._container=s.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(s){return this._container?(s.subtext=s.subtext||"",s.subtext.length!==0||this._singleLineLabel?s.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(s.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+s.subtext+"</span><br />":"")+"<span>"+s.text+"</span>",s.text||s.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(s){var a=this._map.latLngToLayerPoint(s),l=this._container;return this._container&&(this._visible&&(l.style.visibility="inherit"),L.DomUtil.setPosition(l,a)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(s){for(var a in this.options)this.options.hasOwnProperty(a)&&s[a]&&(s[a]=L.extend({},this.options[a],s[a]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,s)},getModeHandlers:function(s){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(s,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(s,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(s,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(s,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(s,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(s,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(s){return[{enabled:s.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:s.completeShape,context:s},{enabled:s.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:s.deleteLastVertex,context:s},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(s){L.setOptions(this,s);for(var a in this._modes)this._modes.hasOwnProperty(a)&&s.hasOwnProperty(a)&&this._modes[a].handler.setOptions(s[a])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(s){s.edit&&(s.edit.selectedPathOptions===void 0&&(s.edit.selectedPathOptions=this.options.edit.selectedPathOptions),s.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,s.edit.selectedPathOptions)),s.remove&&(s.remove=L.extend({},this.options.remove,s.remove)),s.poly&&(s.poly=L.extend({},this.options.poly,s.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,s),this._selectedFeatureCount=0},getModeHandlers:function(s){var a=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(s,{featureGroup:a,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(s,{featureGroup:a}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(s){var a=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return s.removeAllLayers&&a.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),a},addToolbar:function(s){var a=L.Toolbar.prototype.addToolbar.call(this,s);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),a},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var s,a=this.options.featureGroup,l=a.getLayers().length!==0;this.options.edit&&(s=this._modes[L.EditToolbar.Edit.TYPE].button,l?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(s=this._modes[L.EditToolbar.Delete.TYPE].button,l?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(s,a){if(L.Handler.prototype.initialize.call(this,s),L.setOptions(this,a),this._featureGroup=a.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),s._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(s){this._revertLayer(s)},this)},save:function(){var s=new L.LayerGroup;this._featureGroup.eachLayer(function(a){a.edited&&(s.addLayer(a),a.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:s})},_backupLayer:function(s){var a=L.Util.stamp(s);this._uneditedLayerProps[a]||(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?this._uneditedLayerProps[a]={latlngs:L.LatLngUtil.cloneLatLngs(s.getLatLngs())}:s instanceof L.Circle?this._uneditedLayerProps[a]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng()),radius:s.getRadius()}:(s instanceof L.Marker||s instanceof L.CircleMarker)&&(this._uneditedLayerProps[a]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(s){var a=L.Util.stamp(s);s.edited=!1,this._uneditedLayerProps.hasOwnProperty(a)&&(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?s.setLatLngs(this._uneditedLayerProps[a].latlngs):s instanceof L.Circle?(s.setLatLng(this._uneditedLayerProps[a].latlng),s.setRadius(this._uneditedLayerProps[a].radius)):(s instanceof L.Marker||s instanceof L.CircleMarker)&&s.setLatLng(this._uneditedLayerProps[a].latlng),s.fire("revert-edited",{layer:s}))},_enableLayerEdit:function(s){var a,l,u=s.layer||s.target||s;this._backupLayer(u),this.options.poly&&(l=L.Util.extend({},this.options.poly),u.options.poly=l),this.options.selectedPathOptions&&(a=L.Util.extend({},this.options.selectedPathOptions),a.maintainColor&&(a.color=u.options.color,a.fillColor=u.options.fillColor),u.options.original=L.extend({},u.options),u.options.editing=a),u instanceof L.Marker?(u.editing&&u.editing.enable(),u.dragging.enable(),u.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):u.editing.enable()},_disableLayerEdit:function(s){var a=s.layer||s.target||s;a.edited=!1,a.editing&&a.editing.disable(),delete a.options.editing,delete a.options.original,this._selectedPathOptions&&(a instanceof L.Marker?this._toggleMarkerHighlight(a):(a.setStyle(a.options.previousOptions),delete a.options.previousOptions)),a instanceof L.Marker?(a.dragging.disable(),a.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):a.editing.disable()},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_onMarkerDragEnd:function(s){var a=s.target;a.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:a})},_onTouchMove:function(s){var a=s.originalEvent.changedTouches[0],l=this._map.mouseEventToLayerPoint(a),u=this._map.layerPointToLatLng(l);s.target.setLatLng(u)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(s,a){if(L.Handler.prototype.initialize.call(this,s),L.Util.setOptions(this,a),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(s){this._deletableLayers.addLayer(s),s.fire("revert-deleted",{layer:s})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(s){this._removeLayer({layer:s})},this),this.save()},_enableLayerDelete:function(s){(s.layer||s.target||s).on("click",this._removeLayer,this)},_disableLayerDelete:function(s){var a=s.layer||s.target||s;a.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(a)},_removeLayer:function(s){var a=s.layer||s.target||s;this._deletableLayers.removeLayer(a),this._deletedLayers.addLayer(a),a.fire("deleted")},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const Pp=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"",uh=e=>e.length*6+12,rc=(e,t)=>!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom),Gb=(e,t)=>{if(!e||t.length===0)return new Set;const o=[],i=e.getBounds();t.forEach(l=>{if(i.contains(l.getLatLng())){const u=e.latLngToContainerPoint(l.getLatLng()),h=l.locationData;h&&o.push({marker:l,pixelPos:u,location:h})}});const s=o.map(({marker:l,pixelPos:u,location:h})=>{const y=uh(h.name),x=h.description?uh(`${h.name}: ${Pp(h.description,50)}`):y;return{marker:l,location:h,markerBox:{left:u.x-15,right:u.x+15,top:u.y-15,bottom:u.y+15},baseLabelBox:{left:u.x-y/2,right:u.x+y/2,top:u.y+15+2,bottom:u.y+15+2+20},descLabelBox:h.description?{left:u.x-x/2,right:u.x+x/2,top:u.y+15+2,bottom:u.y+15+2+20}:null}}),a=new Set;return s.forEach(({marker:l,location:u,markerBox:h,baseLabelBox:p,descLabelBox:f},y)=>{if(!u.description)return;let x=!1;for(let T=0;T<s.length;T++){if(y===T)continue;const I=s[T];if(rc(f,I.markerBox)||rc(f,I.baseLabelBox)){x=!0;break}if(I.descLabelBox&&a.has(I.location.id)&&rc(f,I.descLabelBox)){x=!0;break}}x||a.add(u.id)}),a},Cr=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"hexagon",label:"Hexagon"},{value:"pentagon",label:"Pentagon"},{value:"diamond",label:"Diamond"},{value:"star",label:"Star"},{value:"dot",label:"Dot"},{value:"none",label:"None"}],Zb=[{value:"33",label:"Small (33%)"},{value:"66",label:"Medium (66%)"},{value:"100",label:"Normal (100%)"},{value:"150",label:"Large (150%)"}],qr=[{value:"default",label:"Default",isShapeOnly:!1,category:"default"},{value:"dot",label:"Dot",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"circle",label:"Circle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"square",label:"Square",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"triangle",label:"Triangle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"diamond",label:"Diamond",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"star",label:"Star",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"hexagon",label:"Hexagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"pentagon",label:"Pentagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"car",label:"Car",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"bike",label:"Bike",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"water",label:"Water",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"food",label:"Food",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"medical",label:"Medical",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"photo",label:"Photo",isShapeOnly:!1,category:"content",defaultColor:"#8B5CF6"},{value:"music",label:"Music",isShapeOnly:!1,category:"content",defaultColor:"#EC4899"},{value:"start",label:"Start",isShapeOnly:!1,category:"content",defaultColor:"#10B981"},{value:"finish",label:"Finish",isShapeOnly:!1,category:"content",defaultColor:"#1F2937"},{value:"toilet",label:"Toilet",isShapeOnly:!1,category:"content",defaultColor:"#6366F1"},{value:"shower",label:"Shower",isShapeOnly:!1,category:"content",defaultColor:"#06B6D4"},{value:"bus",label:"Bus",isShapeOnly:!1,category:"content",defaultColor:"#F97316"},{value:"info",label:"Information",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"merch",label:"Merchandise",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"cone",label:"Road closure",isShapeOnly:!1,category:"content",defaultColor:"#FF6B00"},{value:"traffic",label:"Traffic management",isShapeOnly:!1,category:"content",defaultColor:"#374151"},{value:"track",label:"Track",isShapeOnly:!1,category:"content",defaultColor:"#78716C"},{value:"tunnel",label:"Tunnel",isShapeOnly:!1,category:"content",defaultColor:"#57534E"},{value:"bridge",label:"Bridge",isShapeOnly:!1,category:"content",defaultColor:"#0284C7"},{value:"plane",label:"Plane",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"hill",label:"Hill",isShapeOnly:!1,category:"content",defaultColor:"#65A30D"},{value:"baggage",label:"Baggage",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"crown",label:"Crown",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"crossing",label:"Crossing point",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"trees",label:"Trees",isShapeOnly:!1,category:"content",defaultColor:"#22C55E"},{value:"arrow-uturn-left",label:"Left u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-left",label:"Left turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-left",label:"Slight left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-straight",label:"Straight ahead",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-right",label:"Slight right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-right",label:"Right turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-uturn-right",label:"Right u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-left",label:"Left fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-right",label:"Right fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-left",label:"Keep left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-right",label:"Keep right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"}];function si(e){return qr.find(t=>t.value===e)||qr[0]}function jb(e){return si(e).defaultColor||"#667eea"}function Wb(e,t){return t||jb(e)}const Oc={dot:(e,t=32)=>{const o=(t/2-2)*.33;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="1.5"/>
    </svg>`},circle:(e,t=32)=>{const o=t/2-2;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`},square:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect x="4" y="4" width="${t-8}" height="${t-8}" rx="4" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`,triangle:(e,t=32)=>{const o=t/2,i=4,s=t-4,a=4,l=t-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${i} ${l},${s} ${a},${s}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},diamond:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${i-s} ${o+s},${i} ${o},${i+s} ${o-s},${i}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},star:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-3,a=s*.4,l=[];for(let u=0;u<5;u++){const h=Math.PI/2*-1+u*2*Math.PI/5;l.push(`${o+s*Math.cos(h)},${i+s*Math.sin(h)}`);const p=h+Math.PI/5;l.push(`${o+a*Math.cos(p)},${i+a*Math.sin(p)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${l.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},hexagon:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4,a=[];for(let l=0;l<6;l++){const u=Math.PI/6+l*Math.PI/3;a.push(`${o+s*Math.cos(u)},${i+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${a.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},pentagon:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4,a=[];for(let l=0;l<5;l++){const u=Math.PI/2*-1+l*2*Math.PI/5;a.push(`${o+s*Math.cos(u)},${i+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${a.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},car:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Car body -->
      <rect x="6" y="13" width="20" height="8" rx="2" fill="#fff"/>
      <!-- Car roof/cabin -->
      <path d="M10 13 L12 9 L20 9 L22 13" fill="#fff" stroke="#fff" stroke-width="1"/>
      <!-- Windows -->
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${e}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${e}"/>
      <!-- Tires (always black) -->
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <!-- Wheel centers -->
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>
    </svg>`,bike:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Tires (same color as bike) -->
      <circle cx="9" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <!-- Wheel centers -->
      <circle cx="9" cy="20" r="1" fill="#fff"/>
      <circle cx="23" cy="20" r="1" fill="#fff"/>
      <!-- Frame -->
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
      <!-- Handlebars -->
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <!-- Seat -->
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="#fff"/>
    </svg>`},dh={water:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="#fff"/>
    </svg>`,food:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="#fff"/>
      <path d="M21 9v14h2V9h-2z" fill="#fff"/>
    </svg>`,medical:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#fff" stroke-width="2"/>
      <rect x="14" y="8" width="4" height="16" rx="1" fill="#fff"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="#fff"/>
    </svg>`,photo:(e=32)=>{const t="#8B5CF6";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="8" y="10" width="16" height="12" rx="2" fill="#fff"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" y="13" r="1" fill="${t}"/>
    </svg>`},music:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EC4899" stroke="#fff" stroke-width="2"/>
      <path d="M12 22c1.66 0 3-1.34 3-3v-9h5v4h-3v5c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.35 0 .69.07 1 .18V10c0-.55.45-1 1-1h5c.55 0 1 .45 1 1v6h-5v5c0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.7 0 1.37.15 2 .41" fill="#fff"/>
      <ellipse cx="12" cy="21" rx="2.5" ry="2" fill="#fff"/>
      <rect x="14" y="10" width="2" height="9" fill="#fff"/>
      <rect x="14" y="10" width="6" height="2" fill="#fff"/>
    </svg>`,start:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#10B981" stroke="#fff" stroke-width="2"/>
      <path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="#fff"/>
    </svg>`,finish:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#1F2937" stroke="#fff" stroke-width="2"/>
      <rect x="10" y="8" width="4" height="4" fill="#fff"/>
      <rect x="14" y="12" width="4" height="4" fill="#fff"/>
      <rect x="18" y="8" width="4" height="4" fill="#fff"/>
      <rect x="10" y="16" width="4" height="4" fill="#fff"/>
      <rect x="18" y="16" width="4" height="4" fill="#fff"/>
      <rect x="14" y="20" width="4" height="4" fill="#fff"/>
    </svg>`,toilet:(e=32)=>{const t="#6366F1";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="11" y="7" width="10" height="3" rx="1" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>
    </svg>`},shower:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#06B6D4" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="3" fill="#fff"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="#fff"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
    </svg>`,bus:(e=32)=>{const t="#F97316";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="9" y="9" width="14" height="12" rx="2" fill="#fff"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="#fff"/>
      <circle cx="12" cy="21" r="1.5" fill="#fff"/>
      <circle cx="20" cy="21" r="1.5" fill="#fff"/>
    </svg>`},info:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#0EA5E9" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="2" fill="#fff"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="#fff"/>
    </svg>`,merch:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#A855F7" stroke="#fff" stroke-width="2"/>
      <path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="#fff"/>
      <path d="M13 10 L16 7 L19 10" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>`,cone:(e=32)=>{const t="#FF6B00";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L21 22 H11 L16 6Z" fill="#fff"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="#fff"/>
    </svg>`},traffic:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#374151" stroke="#fff" stroke-width="2"/>
      <rect x="12" y="6" width="8" height="20" rx="2" fill="#fff"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>
    </svg>`,crown:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="#fff"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="#fff"/>
    </svg>`,crossing:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="#fff" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="#fff" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="#fff"/>
      <path d="M16 10 L16 16" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
    </svg>`,trees:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#22C55E" stroke="#fff" stroke-width="2"/>
      <!-- Left tree -->
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="#fff"/>
      <!-- Right tree -->
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="#fff"/>
    </svg>`,"arrow-uturn-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on right, curve left, down on left -->
      <path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on left side -->
      <path d="M7 15 L12 21 L17 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="#fff"/>
    </svg>`,"arrow-slight-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-straight":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
    </svg>`,"arrow-slight-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="#fff"/>
    </svg>`,"arrow-uturn-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on left, curve right, down on right -->
      <path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on right side -->
      <path d="M15 15 L20 21 L25 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-fork-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (correct way - with arrow) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M10 12 L6 10 L8 16 Z" fill="#fff"/>
      <!-- Right fork (wrong way - with X) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
    </svg>`,"arrow-fork-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (wrong way - with X) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <!-- Right fork (correct way - with arrow) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M22 12 L26 10 L24 16 Z" fill="#fff"/>
    </svg>`,"arrow-keep-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-keep-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`},Si={circle:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="14" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,square:({backgroundColor:e,borderColor:t})=>`<rect x="4" y="4" width="24" height="24" rx="4" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,hexagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=[];for(let a=0;a<6;a++){const l=Math.PI/6+a*Math.PI/3;s.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},pentagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=[];for(let a=0;a<5;a++){const l=Math.PI/2*-1+a*2*Math.PI/5;s.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},diamond:({backgroundColor:e,borderColor:t})=>`<polygon points="16,4 28,16 16,28 4,16" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}" stroke-linejoin="round"/>`,star:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=13,a=s*.4,l=[];for(let u=0;u<5;u++){const h=Math.PI/2*-1+u*2*Math.PI/5;l.push(`${16+s*Math.cos(h)},${16+s*Math.sin(h)}`);const p=h+Math.PI/5;l.push(`${16+a*Math.cos(p)},${16+a*Math.sin(p)}`)}return`<polygon points="${l.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},dot:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="5" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:1.5}"/>`,none:()=>""},hh={water:(e="#fff")=>`<path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="${e}"/>`,food:(e="#fff")=>`<path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="${e}"/>
      <path d="M21 9v14h2V9h-2z" fill="${e}"/>`,medical:(e="#fff")=>`<rect x="14" y="8" width="4" height="16" rx="1" fill="${e}"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="${e}"/>`,photo:(e="#fff",t="#667eea")=>`<rect x="8" y="10" width="16" height="12" rx="2" fill="${e}"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" cy="13" r="1" fill="${t}"/>`,music:(e="#fff")=>`<ellipse cx="12" cy="21" rx="2.5" ry="2" fill="${e}"/>
      <rect x="14" y="10" width="2" height="9" fill="${e}"/>
      <rect x="14" y="10" width="6" height="2" fill="${e}"/>`,start:(e="#fff")=>`<path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="${e}"/>`,finish:(e="#fff")=>`<rect x="10" y="8" width="4" height="4" fill="${e}"/>
      <rect x="14" y="12" width="4" height="4" fill="${e}"/>
      <rect x="18" y="8" width="4" height="4" fill="${e}"/>
      <rect x="10" y="16" width="4" height="4" fill="${e}"/>
      <rect x="18" y="16" width="4" height="4" fill="${e}"/>
      <rect x="14" y="20" width="4" height="4" fill="${e}"/>`,toilet:(e="#fff",t="#667eea")=>`<rect x="11" y="7" width="10" height="3" rx="1" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="${e}" stroke-width="2" fill="none" stroke-linecap="round"/>`,shower:(e="#fff")=>`<circle cx="16" cy="10" r="3" fill="${e}"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="${e}"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>`,bus:(e="#fff",t="#667eea")=>`<rect x="9" y="9" width="14" height="12" rx="2" fill="${e}"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="${e}"/>
      <circle cx="12" cy="21" r="1.5" fill="${e}"/>
      <circle cx="20" cy="21" r="1.5" fill="${e}"/>`,info:(e="#fff")=>`<circle cx="16" cy="10" r="2" fill="${e}"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="${e}"/>`,merch:(e="#fff")=>`<path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="${e}"/>
      <path d="M13 10 L16 7 L19 10" stroke="${e}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`,cone:(e="#fff",t="#667eea")=>`<path d="M16 6 L21 22 H11 L16 6Z" fill="${e}"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="${e}"/>`,traffic:(e="#fff")=>`<rect x="12" y="6" width="8" height="20" rx="2" fill="${e}"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>`,car:(e="#fff",t="#667eea")=>`<rect x="6" y="13" width="20" height="8" rx="2" fill="${e}"/>
      <path d="M10 13 L12 9 L20 9 L22 13" fill="${e}" stroke="${e}" stroke-width="1"/>
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${t}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${t}"/>
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>`,bike:(e="#fff")=>`<circle cx="9" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="9" cy="20" r="1" fill="${e}"/>
      <circle cx="23" cy="20" r="1" fill="${e}"/>
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="${e}" stroke-width="2" stroke-linejoin="round"/>
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="${e}"/>`,"arrow-uturn-left":(e="#fff")=>`<path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7 15 L12 21 L17 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-left":(e="#fff")=>`<path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="${e}"/>`,"arrow-slight-left":(e="#fff")=>`<g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-straight":(e="#fff")=>`<path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>`,"arrow-slight-right":(e="#fff")=>`<g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-right":(e="#fff")=>`<path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="${e}"/>`,"arrow-uturn-right":(e="#fff")=>`<path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 15 L20 21 L25 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-fork-left":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Left arrowhead -->
      <path d="M10 12 L6 10 L8 16 Z" fill="${e}"/>
      <!-- Wrong way indicator on right -->
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>`,"arrow-fork-right":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <!-- Wrong way indicator on left -->
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Right arrowhead -->
      <path d="M22 12 L26 10 L24 16 Z" fill="${e}"/>`,"arrow-keep-left":(e="#fff")=>`<g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-keep-right":(e="#fff")=>`<g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,track:(e="#fff")=>`
      <rect x="10" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="19.5" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="8" y="9" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="14.5" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="20" width="16" height="2.5" rx="0.5" fill="${e}"/>`,tunnel:(e="#fff")=>`
      <path d="M7 25 L7 14 C7 8 11 5 16 5 C21 5 25 8 25 14 L25 25" fill="none" stroke="${e}" stroke-width="2.5"/>
      <path d="M11 25 L11 16 C11 12 13 10 16 10 C19 10 21 12 21 16 L21 25" fill="none" stroke="${e}" stroke-width="1.5" opacity="0.6"/>`,bridge:(e="#fff")=>`
      <rect x="5" y="18" width="22" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="7" y="10" width="2" height="8" fill="${e}"/>
      <rect x="23" y="10" width="2" height="8" fill="${e}"/>
      <path d="M8 10 Q16 6 24 10" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <line x1="12" y1="13" x2="12" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="16" y1="11.5" x2="16" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="20" y1="13" x2="20" y2="18" stroke="${e}" stroke-width="1.5"/>`,plane:(e="#fff")=>`
      <g fill="${e}">
        <!-- Fuselage body -->
        <path d="M27 16 L24 14 L8 14 Q4 16 8 18 L24 18 L27 16 Z"/>
        <!-- Nose cone -->
        <path d="M8 14 Q4 16 8 18 L8 14 Z"/>
        <!-- Tail fin -->
        <path d="M26 14 L26 9 L22 14 Z"/>
        <!-- Main wing -->
        <path d="M20 16 L16 10 L14 10 L16 16 L14 22 L16 22 L20 16 Z"/>
        <!-- Cockpit window -->
        <ellipse cx="10" cy="16" rx="1.5" ry="1" fill="none" stroke="${e}" stroke-width="0.5" opacity="0.6"/>
      </g>`,hill:(e="#fff")=>`
      <path d="M6 24 L13 12 L16 16 L20 10 L26 24 Z" fill="${e}"/>
      <path d="M20 10 L22 13 L18 13 Z" fill="${e}" opacity="0.6"/>`,baggage:(e="#fff")=>`
      <rect x="8" y="12" width="16" height="12" rx="2" fill="${e}"/>
      <rect x="12" y="8" width="8" height="4" rx="1" fill="none" stroke="${e}" stroke-width="2"/>
      <line x1="12" y1="16" x2="20" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
      <line x1="12" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>`,crown:(e="#fff")=>`
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="${e}"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="${e}"/>`,crossing:(e="#fff")=>`
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="${e}" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="${e}" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="${e}"/>
      <path d="M16 10 L16 16" stroke="${e}" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>`,trees:(e="#fff")=>`
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="${e}"/>
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="${e}"/>`};function Jt({type:e,backgroundShape:t="circle",backgroundColor:o,borderColor:i,iconColor:s,size:a="100",outputSize:l=null}){if(!e||e==="default"){if(!(o||i||s||t&&t!=="circle"&&t!=="default"))return null;e=t&&t!=="default"?t:"circle"}const u=si(e),h=parseInt(a,10)/100,p=l||Math.round(32*h);let f="";if(u.isShapeOnly){const y=o||u.defaultColor||"#667eea",x=i||"#fff";if(Si[e])f=Si[e]({backgroundColor:y,borderColor:x});else return Oc[e]?.(y,p)||null}else{const y=o||"#667eea",x=i||"#fff",T=s||"#fff",I=t||"circle";I!=="none"&&Si[I]&&(f+=Si[I]({backgroundColor:y,borderColor:x})),hh[e]&&(f+=hh[e](T,y))}return`<svg width="${p}" height="${p}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
    ${f}
  </svg>`}const qb={full:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#10B981" stroke="#fff" stroke-width="1.5"/>
    <path d="M4 7l2 2 4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </svg>`,partial:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#F59E0B" stroke="#fff" stroke-width="1.5"/>
    <rect x="6" y="3.5" width="2" height="4.5" rx="1" fill="#fff"/>
    <circle cx="7" cy="10" r="1" fill="#fff"/>
  </svg>`,missing:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#EF4444" stroke="#fff" stroke-width="1.5"/>
    <path d="M4.5 4.5l5 5M9.5 4.5l-5 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
  </svg>`};function Kb(e,t){return e===0?"missing":e>=t?"full":"partial"}function Rc(e,t){const o=Kb(e,t);return qb[o]}function Yb(e,t,o=32){if(e==="default")return null;if(dh[e])return dh[e](o);if(Oc[e]){const i=t||"#667eea";return Oc[e](i,o)}return null}const Jb=["circle","square","hexagon","pentagon"];function Xb(e){return Jb.includes(e)}function Qb(e,t,o,i,s=32,a=!0){const l=Yb(e,t,s),u=Rc(o,i);if(!l)return null;const h=a&&Xb(e),p=Wb(e,t),f=tw(p),y=Dp(p)?"0 1px 2px rgba(255,255,255,0.5)":"0 1px 2px rgba(0,0,0,0.5)",x=s>=36?"12px":"10px",T=h?`
    <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: ${f};
      font-weight: bold;
      font-size: ${x};
      text-shadow: ${y};
      pointer-events: none;
    ">${o}/${i}</div>
  `:"";return`
    <div style="position: relative; width: ${s}px; height: ${s}px;">
      ${l}
      ${T}
      <div style="position: absolute; bottom: -4px; right: -4px;">
        ${u}
      </div>
    </div>
  `}function ew(e){const t=e.replace("#",""),o=parseInt(t.substr(0,2),16)/255,i=parseInt(t.substr(2,2),16)/255,s=parseInt(t.substr(4,2),16)/255,a=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),l=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*a+.7152*l+.0722*u}function Dp(e){return!e||e.length<6?!1:ew(e)>.4}function tw(e){return Dp(e)?"#1F2937":"#FFFFFF"}const nw="#667eea",ow={__name:"MapView",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},clickable:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","polygon-complete","polygon-drawing"],setup(e,{expose:t,emit:o}){const i=e,s=o,a=D(null);let l=null;const u=D([]),h=D([]),p=D([]);let f=null,y=null;const x=()=>{if(l){const oe=l.getCenter();return{lat:oe.lat,lng:oe.lng}}return null},T=()=>l?l.getZoom():null,I=()=>{if(u.value.length>0){p.value.push([...u.value]);const oe=h.value.pop()||[];u.value=oe,ue(),s("polygon-drawing",u.value)}},S=()=>{if(p.value.length>0){h.value.push([...u.value]);const oe=p.value.pop();u.value=oe,ue(),s("polygon-drawing",u.value)}},R=()=>u.value.length>0,E=()=>p.value.length>0,M=()=>u.value.length,_=()=>{u.value.length>=3&&(s("polygon-complete",[...u.value]),$())},$=()=>{u.value=[],h.value=[],p.value=[],ue()};t({getMapCenter:x,getMapZoom:T,undoPolygonPoint:I,redoPolygonPoint:S,canUndo:R,canRedo:E,getPolygonPointCount:M,completePolygon:_,clearPolygonDrawing:$});const k=D([]);let w=null;const A=D(!0),ne=D(!1),ae=D(new Set),_e=D([]);let re=null,ve=null;const Ie=(oe,Ee,be,Se,le=!1)=>{const pe=be?"36px":Se?"20px":"30px",q=be?"#667eea":"white",fe=le?"":Rc(oe,Ee);return`
    <div style="position: relative; width: ${pe}; height: ${pe};">
      <div style="
        background-color: ${nw};
        width: ${pe};
        height: ${pe};
        border-radius: 50%;
        border: 3px solid ${q};
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      "></div>
      ${le?"":`<div style="position: absolute; bottom: -4px; right: -4px;">
        ${fe}
      </div>`}
    </div>
  `},Re=()=>{if(!l)return;const oe=Gb(l,k.value),Ee=Array.from(ae.value).sort().join(","),be=Array.from(oe).sort().join(",");Ee!==be&&(ae.value=oe,Oe())},xe=()=>{if(ve&&(ve.remove(),ve=null),!l||!i.userLocation)return;const oe=vn.divIcon({className:"user-location-marker",html:`
      <div style="
        position: relative;
        width: 20px;
        height: 20px;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #4285f4;
          border: 3px solid white;
          border-radius: 50%;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        "></div>
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 40px;
          height: 40px;
          background-color: rgba(66, 133, 244, 0.2);
          border-radius: 50%;
          animation: pulse 2s ease-out infinite;
        "></div>
      </div>
    `,iconSize:[40,40],iconAnchor:[20,20]});ve=vn.marker([i.userLocation.lat,i.userLocation.lng],{icon:oe}).addTo(l).bindPopup("Your location")},he=()=>{if(!a.value)return;let oe=51.505,Ee=-.09,be=13;const Se=i.allLocationsForBounds.length>0?i.allLocationsForBounds:i.locations,le=(q,fe)=>q!=null&&fe!=null&&!(q===0&&fe===0),pe=[];Se.length>0&&pe.push(...Se.filter(q=>le(q.latitude,q.longitude)).map(q=>({lat:q.latitude,lng:q.longitude}))),i.route&&i.route.length>0&&pe.push(...i.route.filter(q=>le(q.lat,q.lng)).map(q=>({lat:q.lat,lng:q.lng}))),i.center?(oe=i.center.lat,Ee=i.center.lng,be=i.zoom??13):pe.length>0&&(oe=pe.reduce((q,fe)=>q+fe.lat,0)/pe.length,Ee=pe.reduce((q,fe)=>q+fe.lng,0)/pe.length,be=10),l=vn.map(a.value).setView([oe,Ee],be),vn.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(l),i.clickable&&l.on("click",q=>{i.drawingMode||s("map-click",{lat:q.latlng.lat,lng:q.latlng.lng})}),l.on("zoomend moveend",()=>{ke?Oe():Re()}),Oe(),Q(),J(),xe(),te()},Q=()=>{if(w&&(w.remove(),w=null),!l||i.route.length===0)return;const oe=i.route.map(Ee=>[Ee.lat,Ee.lng]);w=vn.polyline(oe,{color:"blue",weight:4,opacity:.7}).addTo(l)},J=()=>{_e.value.forEach(oe=>oe.remove()),_e.value=[],!(!l||i.areas.length===0)&&i.areas.forEach(oe=>{const Ee=typeof oe.polygon=="string"?JSON.parse(oe.polygon):oe.polygon;if(!Ee||Ee.length===0)return;const be=Ee.map(q=>[q.lat,q.lng]),Se=oe.id===i.selectedAreaId,le=oe.color||"#667eea",pe=vn.polygon(be,{color:le,fillColor:le,fillOpacity:Se?.4:.2,weight:Se?3:2,opacity:.8}).addTo(l);pe.setStyle({pane:"overlayPane"}),i.drawingMode||(pe.on("click",()=>s("area-click",oe)),pe.on("mouseover",()=>{pe.setStyle({fillOpacity:.4})}),pe.on("mouseout",()=>{pe.setStyle({fillOpacity:Se?.4:.2})})),_e.value.push(pe)})},ue=()=>{if(l&&(f&&(f.remove(),f=null),y&&(y.remove(),y=null),u.value.length!==0&&(y=vn.layerGroup().addTo(l),u.value.forEach((oe,Ee)=>{const be=Ee===0,Se=Ee===u.value.length-1,le=vn.divIcon({className:"polygon-point-marker",html:`<div style="
        width: ${be?"16px":"12px"};
        height: ${be?"16px":"12px"};
        background-color: ${be?"#667eea":Se?"#ff9800":"white"};
        border: 3px solid #667eea;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      "></div>`,iconSize:[be?16:12,be?16:12],iconAnchor:[be?8:6,be?8:6]});vn.marker([oe.lat,oe.lng],{icon:le,interactive:!1}).addTo(y)}),u.value.length>=2))){const oe=u.value.map(Ee=>[Ee.lat,Ee.lng]);u.value.length>=3&&oe.push(oe[0]),f=vn.polyline(oe,{color:"#667eea",weight:3,opacity:.8,dashArray:u.value.length<3?"10, 10":null}).addTo(l)}},te=()=>{if(!l)return;if(re||(re=new vn.FeatureGroup,l.addLayer(re)),l._customDrawingHandlers&&(l.off("click",l._customDrawingHandlers.handleClick),l.getContainer().removeEventListener("touchstart",l._customDrawingHandlers.handleTouchStart),l.getContainer().removeEventListener("touchend",l._customDrawingHandlers.handleTouchEnd),l.getContainer().removeEventListener("touchmove",l._customDrawingHandlers.handleTouchMove),delete l._customDrawingHandlers),!i.drawingMode){$(),re&&re.clearLayers();return}let oe=0,Ee=null,be=!1,Se=!1;const le=300,pe=15,q=W=>{h.value.push([...u.value]),p.value=[],u.value.push({lat:W.lat,lng:W.lng}),ue(),s("polygon-drawing",u.value)},fe=W=>{W.originalEvent&&W.originalEvent.sourceCapabilities?.firesTouchEvents||q(W.latlng)},Le=W=>{if(W.touches.length>1){Se=!0;return}Se=!1,oe=Date.now(),Ee={x:W.touches[0].clientX,y:W.touches[0].clientY},be=!1},F=W=>{if(!Ee||Se)return;const j=W.touches[0].clientX-Ee.x,O=W.touches[0].clientY-Ee.y;Math.sqrt(j*j+O*O)>pe&&(be=!0)},G=W=>{if(Se){Se=!1,Ee=null;return}if(Date.now()-oe<le&&!be&&Ee){const O=W.changedTouches[0],B=vn.point(O.clientX-l.getContainer().getBoundingClientRect().left,O.clientY-l.getContainer().getBoundingClientRect().top),K=l.containerPointToLatLng(B);W.preventDefault(),W.stopPropagation(),q(K)}Ee=null,be=!1};l.on("click",fe),l.getContainer().addEventListener("touchstart",Le,{passive:!0}),l.getContainer().addEventListener("touchmove",F,{passive:!0}),l.getContainer().addEventListener("touchend",G,{passive:!1}),l._customDrawingHandlers={handleClick:fe,handleTouchStart:Le,handleTouchMove:F,handleTouchEnd:G},ue()};let ke=!1;const Oe=()=>{if(l&&l._animatingZoom){ke=!0;return}if(ke=!1,k.value.forEach(oe=>{oe._map&&(oe.off(),oe.remove())}),k.value=[],!!l){if(i.locations.forEach(oe=>{const Ee=oe.latitude??oe.Latitude,be=oe.longitude??oe.Longitude;if(Ee==null||be==null||Ee===0&&be===0)return;const Se=oe.checkedInCount||0,le=oe.requiredMarshals||1,pe=i.highlightLocationId===oe.id||i.highlightLocationIds.includes(oe.id),q=i.simplifyNonHighlighted&&!pe,fe=oe.resolvedStyleType||oe.ResolvedStyleType,Le=oe.resolvedStyleBackgroundColor||oe.ResolvedStyleBackgroundColor||oe.resolvedStyleColor||oe.ResolvedStyleColor,F=oe.resolvedStyleBorderColor||oe.ResolvedStyleBorderColor,G=oe.resolvedStyleIconColor||oe.ResolvedStyleIconColor,W=oe.resolvedStyleBackgroundShape||oe.ResolvedStyleBackgroundShape,j=fe&&fe!=="default"||Le||F||G||W&&W!=="circle"&&W!=="default",O=oe.resolvedStyleMapRotation??oe.ResolvedStyleMapRotation??oe.styleMapRotation??oe.StyleMapRotation??0,B=parseInt(O,10)||0,K=oe.areaColor||"#999",ye=oe.areaId&&!i.marshalMode,we=ae.value.has(oe.id)&&oe.description?`${oe.name}: ${Pp(oe.description,50)}`:oe.name,Ne=pe?`
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid #667eea;
        border-radius: 50%;
        animation: highlight-pulse 1.5s ease-out infinite;
      "></div>
    `:"",Fe=pe?"#667eea":q?"#e0e0e0":"white",Ue=pe?"white":q?"#888":"#333";let Ke;if(q){const pt="20px";Ke=`
        <div style="
          background-color: #999;
          width: ${pt};
          height: ${pt};
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        "></div>
      `}const se=!i.marshalMode,ee=Rc(Se,le),Z=se?`<div style="
      position: absolute;
      bottom: -2px;
      right: -6px;
      background-color: white;
      border-radius: 8px;
      padding: 1px 4px;
      font-size: 9px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    ">${Se}/${le}</div>`:"";if(j){const pt=pe?40:32,Pt=oe.resolvedStyleSize||oe.ResolvedStyleSize||"100",gt=Jt({type:oe.resolvedStyleType||oe.ResolvedStyleType,backgroundShape:oe.resolvedStyleBackgroundShape||oe.ResolvedStyleBackgroundShape||"circle",backgroundColor:oe.resolvedStyleBackgroundColor||oe.ResolvedStyleBackgroundColor||oe.resolvedStyleColor||oe.ResolvedStyleColor||"",borderColor:oe.resolvedStyleBorderColor||oe.ResolvedStyleBorderColor||"",iconColor:oe.resolvedStyleIconColor||oe.ResolvedStyleIconColor||"",size:Pt});gt?Ke=gt:Ke=Qb(oe.resolvedStyleType,oe.resolvedStyleColor,Se,le,pt,se)||Ie(Se,le,pe,i.marshalMode,!0)}else Ke=Ie(Se,le,pe,i.marshalMode,!0);const Ve=B!==0?`transform: rotate(${B}deg);`:"",Ye=vn.divIcon({className:"custom-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
          ${Ne}
          <div style="position: relative; display: flex; align-items: center; gap: 4px;">
            ${ye?`<div style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background-color: ${K};
              border: 2px solid white;
              box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            "></div>`:""}
            <div style="position: relative; display: inline-block;">
              <div style="${Ve}">
                ${Ke}
              </div>
              ${q?"":`<div style="position: absolute; top: -4px; right: -4px;">
                ${ee}
              </div>`}
              ${q?"":Z}
            </div>
          </div>
          <div style="
            background-color: ${Fe};
            padding: 2px 6px;
            border-radius: 3px;
            font-size: ${pe?"12px":"11px"};
            font-weight: bold;
            color: ${Ue};
            white-space: nowrap;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${we}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]}),Qe=i.marshalMode?`<b>${oe.name}</b>${oe.description?`<br>${oe.description}`:""}`:`<b>${oe.name}</b><br>${oe.description||""}<br>Checked in: ${Se}/${le}`,et=vn.marker([oe.latitude,oe.longitude],{icon:Ye}).addTo(l).bindPopup(Qe);et.on("click",()=>{s("location-click",oe)}),et.locationData=oe,k.value.push(et)}),l&&A.value&&!i.center&&!ne.value){const oe=[],Ee=i.allLocationsForBounds.length>0?i.allLocationsForBounds:i.locations,be=(Se,le)=>Se!=null&&le!=null&&!(Se===0&&le===0);if(Ee.length>0&&oe.push(...Ee.filter(Se=>be(Se.latitude,Se.longitude)).map(Se=>[Se.latitude,Se.longitude])),i.route.length>0&&oe.push(...i.route.filter(Se=>be(Se.lat,Se.lng)).map(Se=>[Se.lat,Se.lng])),oe.length>0){const Se=vn.latLngBounds(oe);l.fitBounds(Se,{padding:[50,50]}),A.value=!1,ne.value=!0}}else i.center&&(A.value=!1);setTimeout(()=>{l&&!l._animatingZoom&&Re()},100)}};return un(()=>{ne.value=!1,A.value=!0,he();let oe,Ee=0,be=0;const Se=new ResizeObserver(le=>{if(l&&le.length>0){const{width:pe,height:q}=le[0].contentRect;(Math.abs(pe-Ee)>10||Math.abs(q-be)>10)&&(Ee=pe,be=q,clearTimeout(oe),oe=setTimeout(()=>{l.invalidateSize()},150))}});a.value&&Se.observe(a.value),Ao(()=>{clearTimeout(oe),Se.disconnect()})}),We(()=>i.locations,oe=>{if(Oe(),l&&!ne.value&&oe.length>0&&!i.center){const Ee=oe.map(pe=>pe.latitude),be=oe.map(pe=>pe.longitude),Se=Ee.reduce((pe,q)=>pe+q,0)/Ee.length,le=be.reduce((pe,q)=>pe+q,0)/be.length;l.setView([Se,le],10),ne.value=!0,A.value=!1}},{deep:!0}),We(()=>i.route,oe=>{if(Q(),Oe(),l&&!ne.value&&oe&&oe.length>0&&!i.center){const Ee=oe.map(pe=>pe.lat),be=oe.map(pe=>pe.lng),Se=Ee.reduce((pe,q)=>pe+q,0)/Ee.length,le=be.reduce((pe,q)=>pe+q,0)/be.length;l.setView([Se,le],10),ne.value=!0,A.value=!1}},{deep:!0}),We(()=>i.center,oe=>{l&&l.setView([oe.lat,oe.lng],i.zoom)}),We(()=>i.areas,()=>{J()},{deep:!0}),We(()=>i.selectedAreaId,()=>{J()}),We(()=>i.drawingMode,()=>{te()}),We(()=>i.userLocation,()=>{xe()},{deep:!0}),We(()=>i.highlightLocationId,()=>{Oe()}),We(()=>i.highlightLocationIds,()=>{Oe()},{deep:!0}),We(()=>i.marshalMode,()=>{Oe()}),We(()=>i.simplifyNonHighlighted,()=>{Oe()}),We(()=>i.clickable,oe=>{l&&(l.off("click"),oe&&l.on("click",Ee=>{i.drawingMode||s("map-click",{lat:Ee.latlng.lat,lng:Ee.latlng.lng})}))}),(oe,Ee)=>(m(),g("div",{ref_key:"mapContainer",ref:a,class:"map-container"},null,512))}},Qs=Je(ow,[["__scopeId","data-v-295c929a"]]);function Tn(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}const sw={class:"areas-selection"},iw={key:0,class:"areas-selection-header"},aw={class:"areas-list"},rw=["checked","onChange"],lw={__name:"AreasSelection",props:{areas:{type:Array,default:()=>[]},selectedAreaIds:{type:Array,default:()=>[]}},emits:["update:selectedAreaIds"],setup(e,{emit:t}){const o=e,i=t,s=X(()=>[...o.areas].sort((h,p)=>h.displayOrder!==p.displayOrder?h.displayOrder-p.displayOrder:Tn(h.name,p.name))),a=X(()=>o.areas.length>0&&o.selectedAreaIds.length===o.areas.length),l=h=>{const p=[...o.selectedAreaIds],f=p.indexOf(h);f>=0?p.splice(f,1):p.push(h),i("update:selectedAreaIds",p)},u=()=>{a.value?i("update:selectedAreaIds",[]):i("update:selectedAreaIds",o.areas.map(h=>h.id))};return(h,p)=>(m(),g("div",sw,[e.areas.length>1?(m(),g("div",iw,[c("button",{onClick:u,class:"toggle-all-btn"},b(a.value?"Deselect all":"Select all"),1)])):N("",!0),c("div",aw,[(m(!0),g(Ce,null,Be(s.value,f=>(m(),g("label",{class:"area-checkbox",key:f.id},[c("input",{type:"checkbox",checked:e.selectedAreaIds.includes(f.id),onChange:y=>l(f.id)},null,40,rw),c("span",{class:"area-color-dot",style:at({backgroundColor:f.color||"#667eea"})},null,4),Ze(" "+b(f.name),1)]))),128))])]))}},Op=Je(lw,[["__scopeId","data-v-46364246"]]),cw={class:"course-areas-tab"},uw={class:"map-wrapper"},dw={key:0,class:"drawing-controls"},hw={class:"point-count"},fw={class:"undo-redo-buttons"},pw=["disabled"],vw=["disabled"],mw={key:0},gw={key:1},yw={key:0,class:"filters-content"},_w={class:"filter-section"},kw={class:"filter-checkbox"},bw={class:"filter-checkbox"},ww={class:"filter-checkbox"},Cw={class:"filter-checkbox"},Lw={class:"filter-checkbox"},Sw={key:0,class:"filter-section"},xw={key:0},Tw={key:1},Iw={key:0,class:"add-menu-content"},$w={__name:"CourseAreasTab",props:{checkpoints:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1}},emits:["map-click","location-click","area-click","import-checkpoints","upload-route","select-location","add-area","select-area","polygon-complete","cancel-drawing","add-checkpoint-from-map","add-many-checkpoints-from-map","add-area-from-map"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=Ct(),a=e,l=o,u=D(null),h=D(null),p=D(!0),f=D(!1),y=D(null),x=D(0),T=D(!1),I=D(!1),S=D({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreas:[]}),R=()=>{p.value=!p.value,p.value||(f.value=!1)},E=()=>{f.value=!f.value,f.value&&(p.value=!0)},M=he=>{f.value=!1,he==="checkpoint"?(l("add-checkpoint-from-map"),ae()):he==="many-checkpoints"?(l("add-many-checkpoints-from-map"),ae()):he==="area"&&(l("add-area-from-map"),ae())},_=()=>{f.value=!1,l("import-checkpoints")},$=()=>{f.value=!1,l("upload-route")},k=he=>{x.value=he?.length||0,w()},w=()=>{h.value&&(T.value=h.value.canUndo(),I.value=h.value.canRedo())},A=()=>{h.value&&(h.value.undoPolygonPoint(),w())},ne=()=>{h.value&&(h.value.redoPolygonPoint(),w())},ae=()=>{u.value&&u.value.scrollIntoView({behavior:"smooth",block:"start"})};t({scrollMapIntoView:ae,getMapCenter:()=>h.value?.getMapCenter()||null,getMapZoom:()=>h.value?.getMapZoom()||null}),We(()=>a.areas,he=>{if(he.length>0){const Q=new Set(S.value.selectedAreas);he.forEach(J=>{Q.has(J.id)||S.value.selectedAreas.push(J.id)}),S.value.selectedAreas=S.value.selectedAreas.filter(J=>he.some(ue=>ue.id===J))}},{immediate:!0}),We(()=>a.drawingMode,he=>{he||(x.value=0,T.value=!1,I.value=!1)}),X(()=>[...a.areas].sort((he,Q)=>he.displayOrder!==Q.displayOrder?he.displayOrder-Q.displayOrder:Tn(he.name,Q.name)));const ve=X(()=>S.value.showRoute?a.route:[]),Ie=he=>{const Q=he.checkedInCount||0,J=he.requiredMarshals||1;return Q===0?"unchecked":Q>=J?"full":"partial"},Re=X(()=>!S.value.showUncheckedIn&&!S.value.showPartiallyCheckedIn&&!S.value.showFullyCheckedIn?[]:a.checkpoints.filter(he=>{const Q=Ie(he);if(Q==="unchecked"&&!S.value.showUncheckedIn||Q==="partial"&&!S.value.showPartiallyCheckedIn||Q==="full"&&!S.value.showFullyCheckedIn)return!1;const J=he.areaIds||he.AreaIds;return J&&Array.isArray(J)?J.some(ue=>S.value.selectedAreas.includes(ue)):he.areaId?S.value.selectedAreas.includes(he.areaId):!1})),xe=X(()=>S.value.showAreas?a.areas.filter(he=>S.value.selectedAreas.includes(he.id)):[]);return(he,Q)=>(m(),g("div",cw,[c("div",{class:"map-section",ref_key:"mapSection",ref:u},[c("div",uw,[ze(Qs,{ref_key:"mapView",ref:h,locations:Re.value,route:ve.value,areas:xe.value,"all-locations-for-bounds":e.checkpoints,"selected-area-id":e.selectedAreaId,clickable:!0,"drawing-mode":e.drawingMode,onMapClick:Q[0]||(Q[0]=J=>he.$emit("map-click",J)),onLocationClick:Q[1]||(Q[1]=J=>he.$emit("location-click",J)),onAreaClick:Q[2]||(Q[2]=J=>he.$emit("area-click",J)),onPolygonComplete:Q[3]||(Q[3]=J=>he.$emit("polygon-complete",J)),onPolygonDrawing:k},null,8,["locations","route","areas","all-locations-for-bounds","selected-area-id","drawing-mode"]),e.drawingMode&&x.value>0?(m(),g("div",dw,[c("div",hw,b(x.value)+" point"+b(x.value!==1?"s":""),1),c("div",fw,[c("button",{onClick:A,class:"btn-drawing undo-btn",disabled:!T.value,title:"Undo last point"},"  Undo ",8,pw),c("button",{onClick:ne,class:"btn-drawing redo-btn",disabled:!I.value,title:"Redo point"}," Redo  ",8,vw)])])):N("",!0)]),f.value?N("",!0):(m(),g("div",{key:0,class:Te(["visibility-filters",{collapsed:p.value}])},[c("button",{onClick:R,class:"filters-toggle"},[p.value?(m(),g("span",mw,"Show...")):(m(),g("span",gw,""))]),p.value?N("",!0):(m(),g("div",yw,[c("div",_w,[Q[13]||(Q[13]=c("h4",null,"Show on map:",-1)),c("label",kw,[je(c("input",{type:"checkbox","onUpdate:modelValue":Q[4]||(Q[4]=J=>S.value.showRoute=J)},null,512),[[ws,S.value.showRoute]]),Ze(" "+b(z(i).course),1)]),c("label",bw,[je(c("input",{type:"checkbox","onUpdate:modelValue":Q[5]||(Q[5]=J=>S.value.showUncheckedIn=J)},null,512),[[ws,S.value.showUncheckedIn]]),Ze(" Unchecked-in "+b(z(s).checkpoints),1)]),c("label",ww,[je(c("input",{type:"checkbox","onUpdate:modelValue":Q[6]||(Q[6]=J=>S.value.showPartiallyCheckedIn=J)},null,512),[[ws,S.value.showPartiallyCheckedIn]]),Ze(" Partially checked-in "+b(z(s).checkpoints),1)]),c("label",Cw,[je(c("input",{type:"checkbox","onUpdate:modelValue":Q[7]||(Q[7]=J=>S.value.showFullyCheckedIn=J)},null,512),[[ws,S.value.showFullyCheckedIn]]),Ze(" Fully checked-in "+b(z(s).checkpoints),1)]),c("label",Lw,[je(c("input",{type:"checkbox","onUpdate:modelValue":Q[8]||(Q[8]=J=>S.value.showAreas=J)},null,512),[[ws,S.value.showAreas]]),Ze(" "+b(z(i).areas),1)])]),e.areas.length>0&&S.value.showAreas?(m(),g("div",Sw,[c("h4",null,"Filter "+b(z(s).areas)+":",1),ze(Op,{areas:e.areas,"selected-area-ids":S.value.selectedAreas,"onUpdate:selectedAreaIds":Q[9]||(Q[9]=J=>S.value.selectedAreas=J)},null,8,["areas","selected-area-ids"])])):N("",!0)]))],2)),p.value?(m(),g("div",{key:1,class:Te(["add-menu",{expanded:f.value}])},[c("button",{onClick:E,class:"add-toggle",ref_key:"addButtonRef",ref:y},[f.value?(m(),g("span",xw,"")):(m(),g("span",Tw,"Add..."))],512),f.value?(m(),g("div",Iw,[c("button",{onClick:Q[10]||(Q[10]=J=>M("checkpoint")),class:"add-menu-item"}," Checkpoint "),c("button",{onClick:Q[11]||(Q[11]=J=>M("many-checkpoints")),class:"add-menu-item"}," Many checkpoints "),c("button",{onClick:Q[12]||(Q[12]=J=>M("area")),class:"add-menu-item"}," Area "),c("button",{onClick:_,class:"add-menu-item"}," Import checkpoints... "),c("button",{onClick:$,class:"add-menu-item"}," Upload route... ")])):N("",!0)],2)):N("",!0)],512)]))}},Mw=Je($w,[["__scopeId","data-v-08ee7bde"]]),Aw=(e,t)=>{const o=String(e).trim(),i=String(t).trim(),s=parseFloat(o),a=parseFloat(i),l=!isNaN(s)&&String(s)===o,u=!isNaN(a)&&String(a)===i;return l&&u?s-a:o.localeCompare(i,void 0,{numeric:!0,sensitivity:"base"})},Ew=e=>e&&e.isCheckedIn?"":"",Pw={class:"marshals-tab"},Dw={class:"marshals-tab-header"},Ow={class:"button-group"},Rw={class:"marshals-grid"},Bw={class:"marshals-table"},Nw={key:0,class:"sort-indicator"},Fw={key:0,class:"sort-indicator"},Uw={key:0,class:"sort-indicator"},zw={key:0,class:"sort-indicator"},Hw=["onClick"],Vw=["rowspan"],Gw=["value","onChange"],Zw=["rowspan"],jw={key:0,class:"last-active-text"},Ww={key:1,class:"last-active-never"},qw=["onClick"],Kw={style:{color:"#999","font-style":"italic"}},Yw={class:"hide-on-mobile last-active-cell"},Jw={key:0,class:"last-active-text"},Xw={key:1,class:"last-active-never"},Qw={__name:"MarshalsTab",props:{marshals:{type:Array,required:!0},assignments:{type:Array,required:!0},locations:{type:Array,required:!0}},emits:["add-marshal","import-marshals","select-marshal","delete-marshal","change-assignment-status"],setup(e,{emit:t}){const{terms:o}=Ct(),i=e,s=D("name"),a=D("asc"),l=T=>{s.value===T?a.value=a.value==="asc"?"desc":"asc":(s.value=T,a.value="asc")},u=T=>i.assignments.filter(I=>I.marshalId===T),h=T=>{const I=i.locations.find(S=>S.id===T);return I?I.name:"Unknown"},p=T=>{if(!T)return"";const I=new Date(T),R=new Date-I,E=Math.floor(R/6e4),M=Math.floor(E/60),_=Math.floor(M/24);return E<1?"just now":E<60?`${E}m ago`:M<24?`${M}h ago`:_===1?"yesterday":_<7?`${_}d ago`:I.toLocaleDateString()},f=X(()=>{const T=[...i.marshals];return T.sort((I,S)=>{let R=0;if(s.value==="name")R=I.name.localeCompare(S.name);else if(s.value==="checkpoint"){const E=u(I.id),M=u(S.id),_=E.length>0?h(E[0].locationId):"",$=M.length>0?h(M[0].locationId):"";R=Aw(_,$)}else if(s.value==="status"){const E=u(I.id),M=u(S.id),_=E.length>0&&E[0].isCheckedIn?1:0;R=(M.length>0&&M[0].isCheckedIn?1:0)-_}else if(s.value==="lastActive"){const E=I.lastAccessedDate?new Date(I.lastAccessedDate).getTime():0;R=(S.lastAccessedDate?new Date(S.lastAccessedDate).getTime():0)-E}return a.value==="asc"?R:-R}),T}),y=T=>T.isAdminCheckedIn?"admin-checked-in":T.isWrongLocation?"wrong-location":T.isCheckedIn?"checked-in":"not-checked-in",x=T=>T.isCheckedIn?"status-checked-in":"status-not-checked-in";return(T,I)=>(m(),g("div",Pw,[c("div",Dw,[c("h2",null,b(z(o).people)+" management",1),c("div",Ow,[c("button",{onClick:I[0]||(I[0]=S=>T.$emit("add-marshal")),class:"btn btn-primary"}," Add "+b(z(o).person.toLowerCase()),1),c("button",{onClick:I[1]||(I[1]=S=>T.$emit("import-marshals")),class:"btn btn-secondary"}," Import CSV ")])]),c("div",Rw,[c("table",Bw,[c("thead",null,[c("tr",null,[c("th",{onClick:I[2]||(I[2]=S=>l("name")),class:"sortable"},[I[7]||(I[7]=Ze(" Name ",-1)),s.value==="name"?(m(),g("span",Nw,b(a.value==="asc"?"":""),1)):N("",!0)]),c("th",{onClick:I[3]||(I[3]=S=>l("checkpoint")),class:"sortable"},[Ze(b(z(o).checkpoint)+" ",1),s.value==="checkpoint"?(m(),g("span",Fw,b(a.value==="asc"?"":""),1)):N("",!0)]),c("th",{onClick:I[4]||(I[4]=S=>l("status")),class:"sortable"},[I[8]||(I[8]=Ze(" Status ",-1)),s.value==="status"?(m(),g("span",Uw,b(a.value==="asc"?"":""),1)):N("",!0)]),c("th",{onClick:I[5]||(I[5]=S=>l("lastActive")),class:"sortable hide-on-mobile"},[I[9]||(I[9]=Ze(" Last active ",-1)),s.value==="lastActive"?(m(),g("span",zw,b(a.value==="asc"?"":""),1)):N("",!0)])])]),c("tbody",null,[(m(!0),g(Ce,null,Be(f.value,S=>(m(),g(Ce,{key:S.id},[u(S.id).length>0?(m(!0),g(Ce,{key:0},Be(u(S.id),(R,E)=>(m(),g("tr",{key:`${S.id}-${R.id}`,class:"marshal-row",onClick:M=>T.$emit("select-marshal",S)},[E===0?(m(),g("td",{key:0,rowspan:u(S.id).length},b(S.name),9,Vw)):N("",!0),c("td",null,b(h(R.locationId)),1),c("td",{onClick:I[6]||(I[6]=vt(()=>{},["stop"]))},[c("select",{value:y(R),onChange:M=>T.$emit("change-assignment-status",{assignment:R,status:M.target.value}),class:Te(["status-select hide-on-mobile",x(R)])},[...I[10]||(I[10]=[c("option",{value:"not-checked-in"},"Not checked-in",-1),c("option",{value:"checked-in"},"Checked-in",-1),c("option",{value:"admin-checked-in"},"Admin checked-in",-1),c("option",{value:"wrong-location"},"Checked-in but not at correct location",-1)])],42,Gw),c("span",{class:Te(["status-icon show-on-mobile",x(R)])},b(z(Ew)(R)),3)]),E===0?(m(),g("td",{key:1,rowspan:u(S.id).length,class:"hide-on-mobile last-active-cell"},[S.lastAccessedDate?(m(),g("span",jw,b(p(S.lastAccessedDate)),1)):(m(),g("span",Ww,"Never"))],8,Zw)):N("",!0)],8,Hw))),128)):(m(),g("tr",{key:1,class:"marshal-row",onClick:R=>T.$emit("select-marshal",S)},[c("td",null,b(S.name),1),c("td",Kw,"No "+b(z(o).checkpoint.toLowerCase())+" assigned",1),I[11]||(I[11]=c("td",null,[c("span",{class:"hide-on-mobile"},"-"),c("span",{class:"status-icon show-on-mobile",style:{color:"#999"}},"-")],-1)),c("td",Yw,[S.lastAccessedDate?(m(),g("span",Jw,b(p(S.lastAccessedDate)),1)):(m(),g("span",Xw,"Never"))])],8,qw))],64))),128))])])])]))}},e0=Je(Qw,[["__scopeId","data-v-2155fb8d"]]),t0={class:"checklists-tab"},n0={class:"checklists-tab-header"},o0={class:"button-group"},s0={class:"filters-section"},i0={class:"filter-group"},a0={class:"filter-checkbox"},r0=["checked"],l0={key:0,class:"checkbox-dropdown"},c0={class:"checkbox-dropdown-header"},u0={class:"checkbox-list"},d0=["checked","onChange"],h0={class:"filter-group"},f0={class:"filter-checkbox"},p0=["checked"],v0={key:0,class:"checkbox-dropdown"},m0={class:"checkbox-dropdown-header"},g0={class:"checkbox-list"},y0=["checked","onChange"],_0={class:"filter-group"},k0={class:"filter-checkbox"},b0=["checked"],w0={key:0,class:"checkbox-dropdown"},C0={class:"checkbox-dropdown-header"},L0={class:"checkbox-list"},S0=["checked","onChange"],x0={class:"checklist-items-list"},T0={key:0,class:"empty-state"},I0={class:"checklist-item-content"},$0=["onClick"],M0={class:"checklist-item-scopes"},A0=["onClick"],E0={__name:"ChecklistsTab",props:{checklistItems:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},completionReport:{type:Object,default:null}},emits:["add-checklist-item","select-checklist-item"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=e,a=D(!0),l=D(!0),u=D(!0),h=D([]),p=D([]),f=D([]),y=X(()=>[...s.areas].sort((ue,te)=>ue.displayOrder!==te.displayOrder?ue.displayOrder-te.displayOrder:Tn(ue.name,te.name))),x=X(()=>[...s.locations].sort((ue,te)=>Tn(ue.name,te.name))),T=X(()=>[...s.marshals].sort((ue,te)=>Tn(ue.name,te.name))),I=X(()=>s.areas.length>0&&h.value.length===s.areas.length),S=X(()=>s.locations.length>0&&p.value.length===s.locations.length),R=X(()=>s.marshals.length>0&&f.value.length===s.marshals.length),E=X(()=>!a.value||!l.value||!u.value),M=()=>{a.value=!a.value,!a.value&&h.value.length===0&&(h.value=s.areas.map(ue=>ue.id))},_=()=>{l.value=!l.value,!l.value&&p.value.length===0&&(p.value=s.locations.map(ue=>ue.id))},$=()=>{u.value=!u.value,!u.value&&f.value.length===0&&(f.value=s.marshals.map(ue=>ue.id))},k=ue=>{const te=h.value.indexOf(ue);te>=0?h.value.splice(te,1):h.value.push(ue)},w=ue=>{const te=p.value.indexOf(ue);te>=0?p.value.splice(te,1):p.value.push(ue)},A=ue=>{const te=f.value.indexOf(ue);te>=0?f.value.splice(te,1):f.value.push(ue)},ne=()=>{I.value?h.value=[]:h.value=s.areas.map(ue=>ue.id)},ae=()=>{S.value?p.value=[]:p.value=s.locations.map(ue=>ue.id)},_e=()=>{R.value?f.value=[]:f.value=s.marshals.map(ue=>ue.id)},re=()=>{a.value=!0,l.value=!0,u.value=!0,h.value=[],p.value=[],f.value=[]},ve=ue=>{const te=s.marshals.find(ke=>ke.id===ue);return!te||!te.assignments?[]:te.assignments.map(ke=>ke.locationId)},Ie=ue=>{const te=new Set;return ue.forEach(ke=>{const Oe=s.locations.find(oe=>oe.id===ke);Oe&&Oe.areaIds&&Oe.areaIds.forEach(oe=>te.add(oe))}),Array.from(te)},Re=(ue,te)=>{if(!te)return!1;const ke=ve(ue),Oe=Ie(ke);return te.scope==="SpecificPeople"&&te.itemType==="Marshal"?te.ids.includes(ue)||te.ids.includes("ALL_MARSHALS"):te.scope==="EveryoneAtCheckpoints"&&te.itemType==="Checkpoint"?te.ids.includes("ALL_CHECKPOINTS")||ke.some(oe=>te.ids.includes(oe)):te.scope==="OnePerCheckpoint"&&te.itemType==="Checkpoint"?te.ids.includes("ALL_CHECKPOINTS")||ke.some(oe=>te.ids.includes(oe)):te.scope==="OnePerCheckpoint"&&te.itemType==="Area"?te.ids.includes("ALL_AREAS")||Oe.some(oe=>te.ids.includes(oe)):te.scope==="EveryoneInAreas"&&te.itemType==="Area"?te.ids.includes("ALL_AREAS")||Oe.some(oe=>te.ids.includes(oe)):te.scope==="OnePerArea"&&te.itemType==="Area"?te.ids.includes("ALL_AREAS")||Oe.some(oe=>te.ids.includes(oe)):(te.scope==="EveryAreaLead"||te.scope==="OneLeadPerArea")&&te.itemType==="Area"?te.ids.includes("ALL_AREAS")||Oe.some(oe=>te.ids.includes(oe)):!1},xe=X(()=>{let ue=s.checklistItems;return!a.value&&h.value.length>0&&(ue=ue.filter(te=>te.scopeConfigurations?te.scopeConfigurations.some(ke=>ke.itemType==="Area"&&h.value.some(Oe=>ke.ids.includes(Oe))):!1)),!l.value&&p.value.length>0&&(ue=ue.filter(te=>te.scopeConfigurations?te.scopeConfigurations.some(ke=>ke.itemType==="Checkpoint"&&p.value.some(Oe=>ke.ids.includes(Oe))):!1)),!u.value&&f.value.length>0&&(ue=ue.filter(te=>te.scopeConfigurations?f.value.some(ke=>te.scopeConfigurations.some(Oe=>Re(ke,Oe))):!1)),ue}),he=X(()=>[...xe.value].sort((ue,te)=>ue.displayOrder!==te.displayOrder?ue.displayOrder-te.displayOrder:Tn(ue.text,te.text))),Q=ue=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${i.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${i.value.checkpoints}`,SpecificPeople:`Specific ${i.value.people}`,OnePerArea:`One per ${i.value.area}`,OnePerCheckpoint:`One per ${i.value.checkpoint}`,EveryAreaLead:`Every ${i.value.area} lead`,OneLeadPerArea:`One lead per ${i.value.area}`,AreaLead:`${o.value.area} lead`})[ue]||ue,J=ue=>{if(!ue)return"";const te=Q(ue.scope);if(ue.itemType===null)return te;const ke=ue.ids||[];if(ke.includes("ALL_MARSHALS"))return`${te} (Everyone)`;if(ke.includes("ALL_AREAS"))return`${te} (All ${i.value.areas})`;if(ke.includes("ALL_CHECKPOINTS"))return`${te} (All ${i.value.checkpoints})`;const Oe=ke.length;return Oe===0?te:`${te} (${Oe})`};return(ue,te)=>(m(),g("div",t0,[c("div",n0,[c("h2",null,b(z(o).checklists),1),c("div",o0,[c("button",{onClick:te[0]||(te[0]=ke=>ue.$emit("add-checklist-item")),class:"btn btn-primary"}," Add "+b(z(i).checklist),1)])]),c("div",s0,[c("div",i0,[c("h4",null,"Filter by "+b(z(i).area)+":",1),c("label",a0,[c("input",{type:"checkbox",checked:a.value,onChange:M},null,40,r0),Ze(" All "+b(z(i).areas),1)]),a.value?N("",!0):(m(),g("div",l0,[c("div",c0,[c("button",{onClick:ne,class:"toggle-all-btn"},b(I.value?"Deselect all":"Select all"),1)]),c("div",u0,[(m(!0),g(Ce,null,Be(y.value,ke=>(m(),g("label",{key:ke.id,class:"checkbox-item"},[c("input",{type:"checkbox",checked:h.value.includes(ke.id),onChange:Oe=>k(ke.id)},null,40,d0),c("span",{class:"area-color-dot",style:at({backgroundColor:ke.color||"#667eea"})},null,4),Ze(" "+b(ke.name),1)]))),128))])]))]),c("div",h0,[c("h4",null,"Filter by "+b(z(i).checkpoint)+":",1),c("label",f0,[c("input",{type:"checkbox",checked:l.value,onChange:_},null,40,p0),Ze(" All "+b(z(i).checkpoints),1)]),l.value?N("",!0):(m(),g("div",v0,[c("div",m0,[c("button",{onClick:ae,class:"toggle-all-btn"},b(S.value?"Deselect all":"Select all"),1)]),c("div",g0,[(m(!0),g(Ce,null,Be(x.value,ke=>(m(),g("label",{key:ke.id,class:"checkbox-item"},[c("input",{type:"checkbox",checked:p.value.includes(ke.id),onChange:Oe=>w(ke.id)},null,40,y0),Ze(" "+b(ke.name),1)]))),128))])]))]),c("div",_0,[c("h4",null,"Filter by "+b(z(i).person)+":",1),c("label",k0,[c("input",{type:"checkbox",checked:u.value,onChange:$},null,40,b0),Ze(" All "+b(z(i).people),1)]),u.value?N("",!0):(m(),g("div",w0,[c("div",C0,[c("button",{onClick:_e,class:"toggle-all-btn"},b(R.value?"Deselect all":"Select all"),1)]),c("div",L0,[(m(!0),g(Ce,null,Be(T.value,ke=>(m(),g("label",{key:ke.id,class:"checkbox-item"},[c("input",{type:"checkbox",checked:f.value.includes(ke.id),onChange:Oe=>A(ke.id)},null,40,S0),Ze(" "+b(ke.name),1)]))),128))])]))]),E.value?(m(),g("button",{key:0,onClick:re,class:"btn btn-secondary btn-small"}," Clear filters ")):N("",!0)]),c("div",x0,[xe.value.length===0?(m(),g("div",T0,[c("p",null,b(E.value?"No checklist items match the selected filters.":"No checklist items yet. Create one to get started!"),1)])):N("",!0),(m(!0),g(Ce,null,Be(he.value,ke=>(m(),g("div",{key:ke.itemId,class:"checklist-item-card"},[c("div",I0,[c("div",{class:"checklist-item-title",onClick:Oe=>ue.$emit("select-checklist-item",ke,"details")},[c("strong",null,b(ke.text),1)],8,$0),c("div",M0,[(m(!0),g(Ce,null,Be(ke.scopeConfigurations,(Oe,oe)=>(m(),g("span",{key:oe,class:"scope-badge",onClick:Ee=>ue.$emit("select-checklist-item",ke,"visibility")},b(J(Oe)),9,A0))),128))])])]))),128))])]))}},P0=Je(E0,[["__scopeId","data-v-5b51ce47"]]),D0={class:"notes-tab"},O0={class:"notes-tab-header"},R0={class:"button-group"},B0={class:"filters-section"},N0={class:"filter-group"},F0={class:"priority-filters"},U0=["checked","onChange"],z0={class:"filter-group"},H0={class:"filter-checkbox"},V0=["checked"],G0={key:0,class:"checkbox-dropdown"},Z0={class:"checkbox-list"},j0=["checked","onChange"],W0={class:"notes-list"},q0={key:0,class:"empty-state"},K0=["onClick"],Y0={class:"note-header"},J0={class:"note-title-row"},X0={key:0,class:"pin-icon",title:"Pinned"},Q0={class:"note-meta"},eC={key:0,class:"category-badge"},tC={class:"created-info"},nC={key:0,class:"note-preview"},oC={class:"note-scopes"},sC={__name:"NotesTab",props:{notes:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["add-note","select-note"],setup(e,{emit:t}){const{termsLower:o}=Ct(),i=e,s=[{value:"Urgent",label:"Urgent"},{value:"High",label:"High"},{value:"Normal",label:"Normal"},{value:"Low",label:"Low"}],a=D(!0),l=D([]),u=D(["Urgent","High","Normal","Low"]),h=X(()=>[...i.areas].sort(($,k)=>$.displayOrder!==k.displayOrder?$.displayOrder-k.displayOrder:Tn($.name,k.name))),p=X(()=>!a.value||u.value.length<4),f=()=>{a.value=!a.value,!a.value&&l.value.length===0&&(l.value=i.areas.map($=>$.id))},y=$=>{const k=l.value.indexOf($);k>=0?l.value.splice(k,1):l.value.push($)},x=$=>{const k=u.value.indexOf($);k>=0?u.value.splice(k,1):u.value.push($)},T=()=>{a.value=!0,l.value=[],u.value=["Urgent","High","Normal","Low"]},I=X(()=>{let $=i.notes;return u.value.length<4&&($=$.filter(k=>u.value.includes(k.priority||"Normal"))),!a.value&&l.value.length>0&&($=$.filter(k=>k.scopeConfigurations?k.scopeConfigurations.some(w=>w.itemType==="Area"&&l.value.some(A=>w.ids.includes(A))):!1)),$}),S=X(()=>{const $={Urgent:0,High:1,Normal:2,Low:3};return[...I.value].sort((k,w)=>{if(k.isPinned!==w.isPinned)return k.isPinned?-1:1;const A=$[k.priority]??2,ne=$[w.priority]??2;return A!==ne?A-ne:k.displayOrder!==w.displayOrder?k.displayOrder-w.displayOrder:Tn(k.title,w.title)})}),R=$=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${o.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${o.value.checkpoints}`,SpecificPeople:`Specific ${o.value.people}`,EveryAreaLead:`Every ${o.value.area} lead`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,OnePerArea:`One per ${o.value.area}`,OneLeadPerArea:`One lead per ${o.value.area}`})[$]||$,E=$=>{if(!$)return"";const k=R($.scope);if($.itemType===null)return k;const w=$.ids||[];if(w.includes("ALL_MARSHALS"))return`${k} (Everyone)`;if(w.includes("ALL_AREAS"))return`${k} (All ${o.value.areas})`;if(w.includes("ALL_CHECKPOINTS"))return`${k} (All ${o.value.checkpoints})`;const A=w.length;return A===0?k:`${k} (${A})`},M=$=>{if(!$)return"";const k=150;return $.length<=k?$:$.substring(0,k)+"..."},_=$=>{if(!$)return"";const k=new Date($),A=new Date-k,ne=Math.floor(A/6e4),ae=Math.floor(A/36e5),_e=Math.floor(A/864e5);return ne<1?"Just now":ne<60?`${ne}m ago`:ae<24?`${ae}h ago`:_e<7?`${_e}d ago`:k.toLocaleDateString()};return($,k)=>(m(),g("div",D0,[c("div",O0,[k[1]||(k[1]=c("h2",null,"Notes",-1)),c("div",R0,[c("button",{onClick:k[0]||(k[0]=w=>$.$emit("add-note")),class:"btn btn-primary"}," Add note ")])]),c("div",B0,[c("div",N0,[k[2]||(k[2]=c("h4",null,"Filter by priority:",-1)),c("div",F0,[(m(),g(Ce,null,Be(s,w=>c("label",{key:w.value,class:"filter-checkbox"},[c("input",{type:"checkbox",checked:u.value.includes(w.value),onChange:A=>x(w.value)},null,40,U0),c("span",{class:Te(["priority-dot",w.value.toLowerCase()])},null,2),Ze(" "+b(w.label),1)])),64))])]),c("div",z0,[k[4]||(k[4]=c("h4",null,"Filter by area:",-1)),c("label",H0,[c("input",{type:"checkbox",checked:a.value,onChange:f},null,40,V0),k[3]||(k[3]=Ze(" All areas ",-1))]),a.value?N("",!0):(m(),g("div",G0,[c("div",Z0,[(m(!0),g(Ce,null,Be(h.value,w=>(m(),g("label",{key:w.id,class:"checkbox-item"},[c("input",{type:"checkbox",checked:l.value.includes(w.id),onChange:A=>y(w.id)},null,40,j0),c("span",{class:"area-color-dot",style:at({backgroundColor:w.color||"#667eea"})},null,4),Ze(" "+b(w.name),1)]))),128))])]))]),p.value?(m(),g("button",{key:0,onClick:T,class:"btn btn-secondary btn-small"}," Clear filters ")):N("",!0)]),c("div",W0,[I.value.length===0?(m(),g("div",q0,[c("p",null,b(p.value?"No notes match the selected filters.":"No notes yet. Create one to get started!"),1)])):N("",!0),(m(!0),g(Ce,null,Be(S.value,w=>(m(),g("div",{key:w.noteId,class:Te(["note-card",{pinned:w.isPinned}]),onClick:A=>$.$emit("select-note",w)},[c("div",Y0,[c("div",J0,[w.isPinned?(m(),g("span",X0,"")):N("",!0),c("span",{class:Te(["priority-indicator",w.priority?.toLowerCase()||"normal"])},null,2),c("strong",null,b(w.title),1)]),c("div",Q0,[w.category?(m(),g("span",eC,b(w.category),1)):N("",!0),c("span",tC,b(_(w.createdAt)),1)])]),w.content?(m(),g("div",nC,b(M(w.content)),1)):N("",!0),c("div",oC,[(m(!0),g(Ce,null,Be(w.scopeConfigurations,(A,ne)=>(m(),g("span",{key:ne,class:"scope-badge"},b(E(A)),1))),128))])],10,K0))),128))])]))}},iC=Je(sC,[["__scopeId","data-v-f0d2cbb3"]]),aC={class:"contacts-tab"},rC={class:"contacts-tab-header"},lC={class:"button-group"},cC={class:"filters-section"},uC={class:"filter-group"},dC={class:"filter-checkbox"},hC=["checked"],fC={key:0,class:"checkbox-dropdown"},pC={class:"checkbox-list"},vC=["checked","onChange"],mC={class:"contacts-list"},gC={key:0,class:"empty-state"},yC=["onClick"],_C={class:"contact-header"},kC={class:"contact-title-row"},bC={key:0,class:"primary-badge",title:"Primary contact"},wC={class:"role-badge"},CC={class:"contact-details"},LC={key:0,class:"contact-phone"},SC={key:1,class:"contact-email"},xC={key:0,class:"contact-notes"},TC={class:"contact-scopes"},IC={__name:"ContactsTab",props:{contacts:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})}},emits:["add-contact","select-contact"],setup(e,{emit:t}){const{termsLower:o}=Ct(),i=e,s=D(!0),a=D([]),l=X(()=>{const E=new Set([...i.availableRoles.builtInRoles||[],...i.availableRoles.customRoles||[],...i.contacts.map(M=>M.role)]);return Array.from(E).sort()}),u=X(()=>!s.value),h=()=>{s.value=!s.value,!s.value&&a.value.length===0&&(a.value=[...l.value])},p=E=>{const M=a.value.indexOf(E);M>=0?a.value.splice(M,1):a.value.push(E)},f=()=>{s.value=!0,a.value=[]},y=X(()=>{let E=i.contacts;return!s.value&&a.value.length>0&&(E=E.filter(M=>a.value.includes(M.role))),E}),x=X(()=>[...y.value].sort((E,M)=>{if(E.isPrimary!==M.isPrimary)return E.isPrimary?-1:1;const _=E.role.localeCompare(M.role);return _!==0?_:E.displayOrder!==M.displayOrder?E.displayOrder-M.displayOrder:Tn(E.name,M.name)})),T=E=>E?E==="AreaLead"?`${o.value.area.charAt(0).toUpperCase()+o.value.area.slice(1)} Lead`:E.replace(/([A-Z])/g," $1").replace(/^./,M=>M.toUpperCase()).trim():"",I=E=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${o.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${o.value.checkpoints}`,SpecificPeople:`Specific ${o.value.people}`,EveryAreaLead:`Every ${o.value.area} lead`})[E]||E,S=E=>{if(!E)return"";const M=I(E.scope);if(E.itemType===null)return M;const _=E.ids||[];if(_.includes("ALL_MARSHALS"))return`${M} (Everyone)`;if(_.includes("ALL_AREAS"))return`${M} (All ${o.value.areas})`;if(_.includes("ALL_CHECKPOINTS"))return`${M} (All ${o.value.checkpoints})`;const $=_.length;return $===0?M:`${M} (${$})`},R=E=>{if(!E)return"";const M=100;return E.length<=M?E:E.substring(0,M)+"..."};return(E,M)=>(m(),g("div",aC,[c("div",rC,[M[1]||(M[1]=c("h2",null,"Contacts",-1)),c("div",lC,[c("button",{onClick:M[0]||(M[0]=_=>E.$emit("add-contact")),class:"btn btn-primary"}," Add contact ")])]),c("div",cC,[c("div",uC,[M[3]||(M[3]=c("h4",null,"Filter by role:",-1)),c("label",dC,[c("input",{type:"checkbox",checked:s.value,onChange:h},null,40,hC),M[2]||(M[2]=Ze(" All roles ",-1))]),s.value?N("",!0):(m(),g("div",fC,[c("div",pC,[(m(!0),g(Ce,null,Be(l.value,_=>(m(),g("label",{key:_,class:"checkbox-item"},[c("input",{type:"checkbox",checked:a.value.includes(_),onChange:$=>p(_)},null,40,vC),Ze(" "+b(T(_)),1)]))),128))])]))]),u.value?(m(),g("button",{key:0,onClick:f,class:"btn btn-secondary btn-small"}," Clear filters ")):N("",!0)]),c("div",mC,[y.value.length===0?(m(),g("div",gC,[c("p",null,b(u.value?"No contacts match the selected filters.":"No contacts yet. Create one to get started!"),1)])):N("",!0),(m(!0),g(Ce,null,Be(x.value,_=>(m(),g("div",{key:_.contactId,class:Te(["contact-card",{primary:_.isPrimary}]),onClick:$=>E.$emit("select-contact",_)},[c("div",_C,[c("div",kC,[_.isPrimary?(m(),g("span",bC,"")):N("",!0),c("strong",null,b(_.name),1),c("span",wC,b(T(_.role)),1)]),c("div",CC,[_.phone?(m(),g("span",LC,b(_.phone),1)):N("",!0),_.email?(m(),g("span",SC,b(_.email),1)):N("",!0)])]),_.notes?(m(),g("div",xC,b(R(_.notes)),1)):N("",!0),c("div",TC,[(m(!0),g(Ce,null,Be(_.scopeConfigurations,($,k)=>(m(),g("span",{key:k,class:"scope-badge"},b(S($)),1))),128))])],10,yC))),128))])]))}},$C=Je(IC,[["__scopeId","data-v-62313ae0"]]),MC={class:"event-details-tab"},AC={class:"event-info-card"},EC={class:"form-group"},PC={class:"form-group"},DC={class:"form-row"},OC={class:"form-group"},RC={class:"form-group"},BC=["value"],NC={class:"form-actions"},FC=["disabled"],UC={__name:"EventDetailsTab",props:{eventData:{type:Object,required:!0},formDirty:{type:Boolean,default:!1}},emits:["submit","update:formDirty"],setup(e,{emit:t}){const o=e,i=t,s=D({...o.eventData});We(()=>o.eventData,u=>{s.value={...u}},{deep:!0});const a=()=>{i("update:formDirty",!0)},l=()=>{i("submit",{...s.value})};return(u,h)=>(m(),g("div",MC,[c("div",AC,[c("form",{onSubmit:vt(l,["prevent"]),class:"event-details-form"},[c("div",EC,[h[4]||(h[4]=c("label",null,"Event name",-1)),je(c("input",{"onUpdate:modelValue":h[0]||(h[0]=p=>s.value.name=p),type:"text",required:"",class:"form-input",onInput:a},null,544),[[ut,s.value.name]])]),c("div",PC,[h[5]||(h[5]=c("label",null,"Description",-1)),je(c("textarea",{"onUpdate:modelValue":h[1]||(h[1]=p=>s.value.description=p),rows:"3",class:"form-input",onInput:a},null,544),[[ut,s.value.description]])]),c("div",DC,[c("div",OC,[h[6]||(h[6]=c("label",null,"Event date & time",-1)),je(c("input",{"onUpdate:modelValue":h[2]||(h[2]=p=>s.value.eventDate=p),type:"datetime-local",required:"",class:"form-input",onInput:a},null,544),[[ut,s.value.eventDate]])]),c("div",RC,[h[7]||(h[7]=c("label",null,"Time zone",-1)),je(c("select",{"onUpdate:modelValue":h[3]||(h[3]=p=>s.value.timeZoneId=p),required:"",class:"form-input",onChange:a},[(m(!0),g(Ce,null,Be(z(Mp),p=>(m(),g("option",{key:p.value,value:p.value},b(p.label),9,BC))),128))],544),[[Sn,s.value.timeZoneId]])])]),c("div",NC,[c("button",{type:"submit",class:"btn btn-primary",disabled:!e.formDirty}," Save Changes ",8,FC)])],32)])]))}},zC=Je(UC,[["__scopeId","data-v-ef3142df"]]),HC={class:"admins-list"},VC={class:"admin-info"},GC={class:"admin-role"},ZC=["onClick"],jC={__name:"AdminsList",props:{admins:{type:Array,required:!0}},emits:["add-admin","remove-admin"],setup(e){return(t,o)=>(m(),g("div",null,[o[1]||(o[1]=c("h3",null,"Event administrators",-1)),c("button",{onClick:o[0]||(o[0]=i=>t.$emit("add-admin")),class:"btn btn-small btn-primary"}," Add administrator "),c("div",HC,[(m(!0),g(Ce,null,Be(e.admins,i=>(m(),g("div",{key:i.userEmail,class:"admin-item"},[c("div",VC,[c("strong",null,b(i.userEmail),1),c("span",GC,b(i.role),1)]),e.admins.length>1?(m(),g("button",{key:0,onClick:s=>t.$emit("remove-admin",i.userEmail),class:"btn btn-small btn-danger"}," Remove ",8,ZC)):N("",!0)]))),128))])]))}},WC=Je(jC,[["__scopeId","data-v-c76441fb"]]),Pn=[{name:"Charcoal",hex:"#2d3748"},{name:"Dark Gray",hex:"#4a5568"},{name:"Gray",hex:"#718096"},{name:"Red",hex:"#f56565"},{name:"Coral",hex:"#ff6b6b"},{name:"Rose",hex:"#fb7185"},{name:"Pink",hex:"#ed64a6"},{name:"Magenta",hex:"#d946ef"},{name:"Fuchsia",hex:"#e879f9"},{name:"Purple",hex:"#9f7aea"},{name:"Violet",hex:"#a78bfa"},{name:"Lavender",hex:"#b197fc"},{name:"Indigo",hex:"#5a67d8"},{name:"Navy",hex:"#4263eb"},{name:"Blue",hex:"#667eea"},{name:"Sky",hex:"#0ea5e9"},{name:"Cyan",hex:"#0bc5ea"},{name:"Aqua",hex:"#22d3ee"},{name:"Teal",hex:"#38b2ac"},{name:"Emerald",hex:"#10b981"},{name:"Green",hex:"#48bb78"},{name:"Mint",hex:"#51cf66"},{name:"Lime",hex:"#84cc16"},{name:"Olive",hex:"#a3b18a"},{name:"Yellow",hex:"#ecc94b"},{name:"Amber",hex:"#f59e0b"},{name:"Orange",hex:"#ed8936"},{name:"Peach",hex:"#ff922b"},{name:"Light Gray",hex:"#cbd5e0"},{name:"Silver",hex:"#e2e8f0"},{name:"Cream",hex:"#f7fafc"}],Or="#667eea";function fh(e){const t=e.map(i=>i.color);return Pn.find(i=>!t.includes(i.hex))?.hex||Or}const qC={class:"modal-content"},KC={class:"modal-body"},YC={class:"preview-section"},JC={class:"map-preview"},XC=["innerHTML"],QC={class:"options-grid"},eL={class:"option-button-content"},tL={class:"option-button-value icon-value"},nL=["innerHTML"],oL={class:"option-button-content"},sL={class:"option-button-value color-value"},iL=["disabled"],aL={class:"option-button-content"},rL={class:"option-button-value color-value"},lL={class:"option-button-content"},cL={class:"option-button-value icon-value"},uL=["innerHTML"],dL=["disabled"],hL={class:"option-button-content"},fL={class:"option-button-value color-value"},pL={class:"option-button-content"},vL={class:"option-button-value"},mL={class:"option-button-content"},gL={class:"option-button-value"},yL={key:0,class:"centered-popup"},_L={class:"popup-grid"},kL=["onClick"],bL=["innerHTML"],wL={key:0},CL={key:1,class:"centered-popup"},LL={class:"popup-grid"},SL=["title","onClick"],xL=["innerHTML"],TL={key:0},IL={key:2,class:"centered-popup"},$L={class:"popup-grid"},ML=["title","onClick"],AL=["innerHTML"],EL={key:0},PL={key:3,class:"centered-popup icon-popup"},DL={class:"popup-grid"},OL=["onClick"],RL=["innerHTML"],BL={key:0},NL={key:4,class:"centered-popup"},FL={class:"popup-grid"},UL=["title","onClick"],zL=["innerHTML"],HL={key:0},VL={key:5,class:"centered-popup"},GL={class:"size-grid"},ZL=["onClick"],jL=["innerHTML"],WL={key:6,class:"centered-popup"},qL={class:"rotation-content"},KL={class:"rotation-preview-container"},YL=["innerHTML"],JL={class:"rotation-control"},XL={class:"rotation-slider-container"},QL=["value"],e2={class:"rotation-value"},t2={class:"rotation-presets"},n2="#667eea",o2={__name:"IconCustomizationModal",props:{isOpen:{type:Boolean,default:!1},iconType:{type:String,default:"none"},backgroundShape:{type:String,default:"circle"},backgroundColor:{type:String,default:""},borderColor:{type:String,default:""},iconColor:{type:String,default:""},size:{type:String,default:"100"},mapRotation:{type:[String,Number],default:""},level:{type:String,default:"checkpoint"},inheritedType:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""}},emits:["update:isOpen","apply","cancel"],setup(e,{emit:t}){const o=e,i=t,s=D(o.backgroundShape||"circle"),a=D(o.iconType||"none"),l=D(o.backgroundColor||""),u=D(o.borderColor||""),h=D(o.iconColor||""),p=D(o.size||"100"),f=D(o.mapRotation??""),y=D(null),x=se=>se==="default"?o.inheritedBackgroundShape||"circle":se==="none"?"none":se||"circle",T=se=>se==="default"||!se?ae():se==="none"?"transparent":se,I=se=>se==="default"?o.inheritedBorderColor||"#ffffff":se==="none"||!se?"transparent":se,S=se=>{if(se==="default"){const ee=o.inheritedType;return ee&&ee!=="default"&&si(ee).category==="content"?ee:"none"}return se==="none"||!se?"none":se},R=se=>se==="default"||!se?o.inheritedIconColor||"#ffffff":se==="none"?"transparent":se,E=se=>se==="default"?o.inheritedSize||"100":se||"100",M=se=>{if(se==="default"||se===""){const ee=o.inheritedMapRotation;return ee!==""&&ee!==void 0&&ee!==null&&parseInt(ee,10)||0}return parseInt(se,10)||0},_=X(()=>{const se=o.inheritedBackgroundShape||"circle",ee=Cr.find(Z=>Z.value===se)?.label||"Circle";return[{value:"none",label:"None",showLabel:!0},{value:"default",label:`Default (${ee})`,showLabel:!0},...Cr.filter(Z=>Z.value!=="none").map(Z=>({...Z,showLabel:!1}))]}),$=X(()=>{const se=qr.filter(Ve=>Ve.category==="content"),ee=[{value:"none",label:"None",category:"content",showLabel:!0}],Z=o.inheritedType;if(Z&&Z!=="default"){const Ve=si(Z);Ve.category==="content"&&ee.push({value:"default",label:`Default (${Ve.label||Z})`,category:"content",showLabel:!0})}return ee.push(...se.map(Ve=>({...Ve,showLabel:!1}))),ee}),k=X(()=>{const se={33:"Small",66:"Medium",100:"Normal",150:"Large"};return[{value:"default",label:`Default (${se[o.inheritedSize]||"Normal"})`},...Zb.map(Z=>({value:Z.value,label:se[Z.value]||Z.label}))]}),w=X(()=>x(s.value)!=="none"),A=X(()=>S(a.value)!=="none"),ne=X(()=>{const se=o.inheritedBackgroundColor;return se&&se!=="default"&&se.startsWith("#")?se:n2}),ae=()=>ne.value,_e=X(()=>l.value&&l.value!=="default"?l.value:ae()),re=X(()=>u.value==="none"?"transparent":u.value?u.value:o.inheritedBorderColor&&o.inheritedBorderColor!=="none"?o.inheritedBorderColor:"#ffffff"),ve=X(()=>h.value?h.value:o.inheritedIconColor?o.inheritedIconColor:"#ffffff"),Ie=X(()=>{const se=ne.value,ee=Pn.find(Z=>Z.hex.toLowerCase()===se.toLowerCase())?.name||"Custom";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ee})`,showLabel:!0},...Pn.map(Z=>({hex:Z.hex,name:Z.name,showLabel:!1}))]}),Re=X(()=>{const se=o.inheritedBorderColor||"#ffffff",ee=se==="#ffffff"?"White":Pn.find(Z=>Z.hex===se)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ee})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Pn.filter(Z=>Z.hex!=="#ffffff").map(Z=>({hex:Z.hex,name:Z.name,showLabel:!1}))]}),xe=X(()=>{const se=o.inheritedIconColor||"#ffffff",ee=se==="#ffffff"?"White":Pn.find(Z=>Z.hex===se)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ee})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Pn.filter(Z=>Z.hex!=="#ffffff").map(Z=>({hex:Z.hex,name:Z.name,showLabel:!1}))]}),he=se=>se==="default"?!l.value||l.value==="default":l.value===se,Q=se=>se==="#ffffff"?!h.value||h.value==="#ffffff":h.value===se,J=se=>{if(se==="none")return"None";if(se==="default"){const Z=o.inheritedBackgroundShape;return Z?`Default (${Cr.find(Ye=>Ye.value===Z)?.label||"Circle"})`:"Default (Circle)"}const ee=Cr.find(Z=>Z.value===se);return ee?ee.label:"Circle"},ue=se=>{if(se==="none")return"None";if(se==="default"){const Z=o.inheritedType;if(Z&&Z!=="default"){const Ve=si(Z);if(Ve.category==="content")return`Default (${Ve.label||Z})`}return"Default"}const ee=qr.find(Z=>Z.value===se);return ee?ee.label:"None"},te=se=>{if(se==="none")return"None";if(!se||se==="default"){const Z=ne.value;return`Default (${Pn.find(Ye=>Ye.hex.toLowerCase()===Z.toLowerCase())?.name||"Custom"})`}const ee=[...Pn].find(Z=>Z.hex.toLowerCase()===se.toLowerCase());return ee?ee.name:se},ke=se=>{if(se==="none")return"None";if(se==="default"){const Z=o.inheritedBorderColor;return Z&&Z!=="none"?`Default (${Z==="#ffffff"?"White":Pn.find(Ye=>Ye.hex===Z)?.name||"Custom"})`:"Default (White)"}if(!se||se==="#ffffff")return"White";const ee=[...Re.value].find(Z=>Z.hex===se);return ee?ee.name:se},Oe=se=>{if(se==="none")return"None";if(se==="default"){const Z=o.inheritedIconColor;return Z?`Default (${Z==="#ffffff"?"White":Pn.find(Ye=>Ye.hex===Z)?.name||"Custom"})`:"Default (White)"}if(!se||se==="#ffffff")return"White";const ee=[...xe.value].find(Z=>Z.hex===se);return ee?ee.name:se},oe=se=>{const ee={33:"Small",66:"Medium",100:"Normal",150:"Large"};if(se==="default"){const Z=o.inheritedSize;return`Default (${ee[Z]||"Normal"})`}return ee[se]||"Normal"},Ee=se=>{if(se==="default"||se===""||se===void 0||se===null){const ee=o.inheritedMapRotation;return ee!==""&&ee!==void 0&&ee!==null?`Default (${ee})`:"Default (0)"}return`${se}`},be=se=>{if(se==="none")return`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`;const ee=x(se),Z=T(l.value),Ve=I(u.value);return Si[ee]?`<svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">${Si[ee]({backgroundColor:Z,borderColor:Ve==="transparent"?"none":Ve})}</svg>`:""},Se=se=>{const ee=S(se);return ee==="none"?`<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
      <rect x="1" y="1" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`:Jt({type:ee,backgroundShape:"circle",backgroundColor:"#94a3b8",borderColor:"none",iconColor:"#fff",size:"75"})},le=se=>{const ee=x(se);if(ee==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="none" stroke="#ccc" stroke-width="2" stroke-dasharray="4"/>
    </svg>`;const Z=T(l.value),Ve=I(u.value),Ye=S(a.value),Qe=R(h.value);return Jt({type:Ye!=="none"?Ye:ee,backgroundShape:ee,backgroundColor:Z,borderColor:Ve==="transparent"?"none":Ve,iconColor:Qe,size:"100",outputSize:28})},pe=se=>{const ee=T(se),Z=x(s.value),Ve=I(u.value),Ye=S(a.value),Qe=R(h.value);return Z==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ee==="transparent"?"#e2e8f0":ee}"/>
    </svg>`:Jt({type:Ye!=="none"?Ye:Z,backgroundShape:Z,backgroundColor:ee==="transparent"?"#e2e8f0":ee,borderColor:Ve==="transparent"?"none":Ve,iconColor:Qe,size:"100",outputSize:28})},q=se=>{const ee=I(se),Z=x(s.value),Ve=T(l.value),Ye=S(a.value),Qe=R(h.value);return Z==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0" stroke="${ee}" stroke-width="2"/>
    </svg>`:Jt({type:Ye!=="none"?Ye:Z,backgroundShape:Z,backgroundColor:Ve,borderColor:ee==="transparent"?"none":ee,iconColor:Qe,size:"100",outputSize:28})},fe=se=>{const ee=S(se),Z=x(s.value),Ve=T(l.value),Ye=I(u.value),Qe=R(h.value);if(ee==="none"&&Z==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0"/>
      <line x1="8" y1="8" x2="20" y2="20" stroke="#a0aec0" stroke-width="2" stroke-linecap="round"/>
    </svg>`;const et=Z!=="none"?Z:"circle";return Jt({type:ee!=="none"?ee:et,backgroundShape:et,backgroundColor:Ve,borderColor:Ye==="transparent"?"none":Ye,iconColor:Qe,size:"100",outputSize:42})},Le=se=>{const ee=R(se),Z=x(s.value),Ve=T(l.value),Ye=I(u.value),Qe=S(a.value);return Qe==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ee==="transparent"?"#e2e8f0":ee}"/>
    </svg>`:Jt({type:Qe,backgroundShape:Z!=="none"?Z:"circle",backgroundColor:Ve,borderColor:Ye==="transparent"?"none":Ye,iconColor:ee==="transparent"?"#e2e8f0":ee,size:"100",outputSize:28})},F=se=>{const ee=E(se),Z=x(s.value),Ve=T(l.value),Ye=I(u.value),Qe=S(a.value),et=R(h.value);if(Z==="none"&&Qe==="none")return"";const pt=Z!=="none"?Z:"circle";return Jt({type:Qe!=="none"?Qe:pt,backgroundShape:pt,backgroundColor:Ve,borderColor:Ye==="transparent"?"none":Ye,iconColor:et,size:ee})},G=X(()=>{const se=x(s.value),ee=T(l.value),Z=I(u.value),Ve=S(a.value),Ye=R(h.value),Qe=E(p.value);return se==="none"&&Ve==="none"?"":Jt(se==="none"&&Ve!=="none"?{type:Ve,backgroundShape:"none",backgroundColor:ee,borderColor:"none",iconColor:Ye,size:Qe}:{type:Ve!=="none"?Ve:se,backgroundShape:se,backgroundColor:ee,borderColor:Z==="transparent"?"none":Z,iconColor:Ye,size:Qe})}),W=se=>{y.value=y.value===se?null:se},j=()=>{y.value=null},O=se=>{s.value=se,j()},B=se=>{l.value=se,j()},K=se=>{u.value=se,j()},ye=se=>{a.value=se,j()},$e=se=>{h.value=se,j()},we=se=>{p.value=se,j()},Ne=se=>{f.value=se,j()},Fe=se=>{f.value=se};We(()=>o.isOpen,se=>{if(se){const ee=o.backgroundShape&&o.backgroundShape!=="default"&&o.backgroundShape!=="circle",Z=o.iconType&&o.iconType!=="none"&&o.iconType!=="default",Ve=o.backgroundColor&&o.backgroundColor!=="",Ye=o.borderColor&&o.borderColor!=="",Qe=o.iconColor&&o.iconColor!=="",et=o.size&&o.size!==""&&o.size!=="100",pt=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null&&o.mapRotation!==0;ee||Z||Ve||Ye||Qe||et||pt?(s.value=o.backgroundShape||"default",a.value=o.iconType||"default",l.value=o.backgroundColor||"default",u.value=o.borderColor||"default",h.value=o.iconColor||"default",p.value=o.size||"default",f.value=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null?o.mapRotation:"default"):(s.value="default",a.value="default",l.value="default",u.value="default",h.value="default",p.value="default",f.value="default"),y.value=null}});const Ue=()=>{j(),i("update:isOpen",!1),i("cancel")},Ke=()=>{j();const se=Ve=>Ve==="default"?"":Ve;let ee="";a.value==="none"?ee="none":a.value&&a.value!=="default"&&(ee=a.value);let Z="";f.value!=="default"&&f.value!==""&&f.value!==void 0&&(Z=parseInt(f.value,10)||0),i("apply",{iconType:ee,backgroundShape:se(s.value),backgroundColor:se(l.value),borderColor:se(u.value),iconColor:se(h.value),size:se(p.value),mapRotation:Z}),i("update:isOpen",!1)};return(se,ee)=>e.isOpen?(m(),g("div",{key:0,class:"modal-overlay",onClick:vt(Ue,["self"])},[c("div",qC,[c("div",{class:"modal-header"},[ee[15]||(ee[15]=c("h3",null,"Customise marker style",-1)),c("button",{class:"close-btn",onClick:Ue},"")]),c("div",KC,[c("div",YC,[c("div",JC,[ee[16]||(ee[16]=c("div",{class:"map-background"},null,-1)),c("div",{class:"preview-icon",style:at({transform:`rotate(${M(f.value)}deg)`}),innerHTML:G.value},null,12,XC)])]),c("div",QC,[c("button",{type:"button",class:Te(["option-button",{active:y.value==="shape"}]),onClick:ee[0]||(ee[0]=Z=>W("shape"))},[c("div",eL,[ee[17]||(ee[17]=c("span",{class:"option-button-label"},"Shape",-1)),c("div",tL,[c("div",{class:"icon-preview-small",innerHTML:be(s.value)},null,8,nL),c("span",null,b(J(s.value)),1)])]),ee[18]||(ee[18]=c("span",{class:"option-button-arrow"},"",-1))],2),c("button",{type:"button",class:Te(["option-button",{active:y.value==="bgColor"}]),onClick:ee[1]||(ee[1]=Z=>W("bgColor"))},[c("div",oL,[ee[19]||(ee[19]=c("span",{class:"option-button-label"},"Background",-1)),c("div",sL,[c("span",{class:"color-swatch",style:at({backgroundColor:_e.value})},null,4),c("span",null,b(te(l.value)),1)])]),ee[20]||(ee[20]=c("span",{class:"option-button-arrow"},"",-1))],2),c("button",{type:"button",class:Te(["option-button",{active:y.value==="borderColor",disabled:!w.value}]),disabled:!w.value,onClick:ee[2]||(ee[2]=Z=>W("borderColor"))},[c("div",aL,[ee[21]||(ee[21]=c("span",{class:"option-button-label"},"Border",-1)),c("div",rL,[c("span",{class:Te(["color-swatch",{"no-border":u.value==="none"}]),style:at(u.value!=="none"?{backgroundColor:re.value}:{})},null,6),c("span",null,b(ke(u.value)),1)])]),ee[22]||(ee[22]=c("span",{class:"option-button-arrow"},"",-1))],10,iL),c("button",{type:"button",class:Te(["option-button",{active:y.value==="icon"}]),onClick:ee[3]||(ee[3]=Z=>W("icon"))},[c("div",lL,[ee[23]||(ee[23]=c("span",{class:"option-button-label"},"Icon",-1)),c("div",cL,[c("div",{class:"icon-preview-small",innerHTML:Se(a.value)},null,8,uL),c("span",null,b(ue(a.value)),1)])]),ee[24]||(ee[24]=c("span",{class:"option-button-arrow"},"",-1))],2),c("button",{type:"button",class:Te(["option-button",{active:y.value==="iconColor",disabled:!A.value}]),disabled:!A.value,onClick:ee[4]||(ee[4]=Z=>W("iconColor"))},[c("div",hL,[ee[25]||(ee[25]=c("span",{class:"option-button-label"},"Colour",-1)),c("div",fL,[c("span",{class:"color-swatch",style:at({backgroundColor:ve.value})},null,4),c("span",null,b(Oe(h.value)),1)])]),ee[26]||(ee[26]=c("span",{class:"option-button-arrow"},"",-1))],10,dL),c("button",{type:"button",class:Te(["option-button",{active:y.value==="size"}]),onClick:ee[5]||(ee[5]=Z=>W("size"))},[c("div",pL,[ee[27]||(ee[27]=c("span",{class:"option-button-label"},"Size",-1)),c("span",vL,b(oe(p.value)),1)]),ee[28]||(ee[28]=c("span",{class:"option-button-arrow"},"",-1))],2),c("button",{type:"button",class:Te(["option-button option-button-full",{active:y.value==="mapRotation"}]),onClick:ee[6]||(ee[6]=Z=>W("mapRotation"))},[c("div",mL,[ee[29]||(ee[29]=c("span",{class:"option-button-label"},"Map rotation",-1)),c("span",gL,b(Ee(f.value)),1)]),ee[30]||(ee[30]=c("span",{class:"option-button-arrow"},"",-1))],2)]),y.value==="shape"?(m(),g("div",yL,[c("div",{class:"popup-header"},[ee[31]||(ee[31]=c("span",null,"Select shape",-1)),c("button",{type:"button",class:"popup-close",onClick:j},"")]),c("div",_L,[(m(!0),g(Ce,null,Be(_.value,Z=>(m(),g("button",{key:Z.value,type:"button",class:Te(["popup-grid-item",{selected:s.value===Z.value}]),onClick:Ve=>O(Z.value)},[c("div",{class:"popup-item-preview",innerHTML:le(Z.value)},null,8,bL),Z.showLabel?(m(),g("span",wL,b(Z.label),1)):N("",!0)],10,kL))),128))])])):N("",!0),y.value==="bgColor"?(m(),g("div",CL,[c("div",{class:"popup-header"},[ee[32]||(ee[32]=c("span",null,"Select background",-1)),c("button",{type:"button",class:"popup-close",onClick:j},"")]),c("div",LL,[(m(!0),g(Ce,null,Be(Ie.value,Z=>(m(),g("button",{key:Z.hex,type:"button",class:Te(["popup-grid-item",{selected:he(Z.hex)}]),title:Z.name,onClick:Ve=>B(Z.hex)},[c("div",{class:"popup-item-preview",innerHTML:pe(Z.hex)},null,8,xL),Z.showLabel?(m(),g("span",TL,b(Z.name),1)):N("",!0)],10,SL))),128))])])):N("",!0),y.value==="borderColor"?(m(),g("div",IL,[c("div",{class:"popup-header"},[ee[33]||(ee[33]=c("span",null,"Select border",-1)),c("button",{type:"button",class:"popup-close",onClick:j},"")]),c("div",$L,[(m(!0),g(Ce,null,Be(Re.value,Z=>(m(),g("button",{key:Z.hex,type:"button",class:Te(["popup-grid-item",{selected:u.value===Z.hex}]),title:Z.name,onClick:Ve=>K(Z.hex)},[c("div",{class:"popup-item-preview",innerHTML:q(Z.hex)},null,8,AL),Z.showLabel?(m(),g("span",EL,b(Z.name),1)):N("",!0)],10,ML))),128))])])):N("",!0),y.value==="icon"?(m(),g("div",PL,[c("div",{class:"popup-header"},[ee[34]||(ee[34]=c("span",null,"Select icon",-1)),c("button",{type:"button",class:"popup-close",onClick:j},"")]),c("div",DL,[(m(!0),g(Ce,null,Be($.value,Z=>(m(),g("button",{key:Z.value,type:"button",class:Te(["popup-grid-item",{selected:a.value===Z.value}]),onClick:Ve=>ye(Z.value)},[c("div",{class:"popup-item-preview",innerHTML:fe(Z.value)},null,8,RL),Z.showLabel?(m(),g("span",BL,b(Z.label),1)):N("",!0)],10,OL))),128))])])):N("",!0),y.value==="iconColor"?(m(),g("div",NL,[c("div",{class:"popup-header"},[ee[35]||(ee[35]=c("span",null,"Select colour",-1)),c("button",{type:"button",class:"popup-close",onClick:j},"")]),c("div",FL,[(m(!0),g(Ce,null,Be(xe.value,Z=>(m(),g("button",{key:Z.hex,type:"button",class:Te(["popup-grid-item",{selected:Q(Z.hex)}]),title:Z.name,onClick:Ve=>$e(Z.hex)},[c("div",{class:"popup-item-preview",innerHTML:Le(Z.hex)},null,8,zL),Z.showLabel?(m(),g("span",HL,b(Z.name),1)):N("",!0)],10,UL))),128))])])):N("",!0),y.value==="size"?(m(),g("div",VL,[c("div",{class:"popup-header"},[ee[36]||(ee[36]=c("span",null,"Select size",-1)),c("button",{type:"button",class:"popup-close",onClick:j},"")]),c("div",GL,[(m(!0),g(Ce,null,Be(k.value,Z=>(m(),g("button",{key:Z.value,type:"button",class:Te(["size-grid-item",{selected:p.value===Z.value}]),onClick:Ve=>we(Z.value)},[c("div",{class:"size-preview",innerHTML:F(Z.value)},null,8,jL),c("span",null,b(Z.label),1)],10,ZL))),128))])])):N("",!0),y.value==="mapRotation"?(m(),g("div",WL,[c("div",{class:"popup-header"},[ee[37]||(ee[37]=c("span",null,"Set map rotation",-1)),c("button",{type:"button",class:"popup-close",onClick:j},"")]),c("div",qL,[c("div",KL,[c("div",{class:"rotation-preview-icon",style:at({transform:`rotate(${M(f.value)}deg)`}),innerHTML:G.value},null,12,YL)]),ee[38]||(ee[38]=c("p",{class:"rotation-description"}," Rotate the marker on the map. This rotation is added to any map rotation. ",-1)),c("div",JL,[c("button",{type:"button",class:Te(["rotation-preset",{selected:f.value==="default"||f.value===""}]),onClick:ee[7]||(ee[7]=Z=>Ne("default"))}," Default ",2),c("div",XL,[c("input",{type:"range",min:"-180",max:"180",step:"5",class:"rotation-slider",value:f.value==="default"||f.value===""?0:f.value,onInput:ee[8]||(ee[8]=Z=>Fe(parseInt(Z.target.value,10)))},null,40,QL),c("div",e2,b(f.value==="default"||f.value===""?"0":f.value)+" ",1)])]),c("div",t2,[c("button",{type:"button",class:Te(["rotation-preset-btn",{selected:f.value===-90}]),onClick:ee[9]||(ee[9]=Z=>Ne(-90))},"-90",2),c("button",{type:"button",class:Te(["rotation-preset-btn",{selected:f.value===-45}]),onClick:ee[10]||(ee[10]=Z=>Ne(-45))},"-45",2),c("button",{type:"button",class:Te(["rotation-preset-btn",{selected:f.value===0}]),onClick:ee[11]||(ee[11]=Z=>Ne(0))},"0",2),c("button",{type:"button",class:Te(["rotation-preset-btn",{selected:f.value===45}]),onClick:ee[12]||(ee[12]=Z=>Ne(45))},"+45",2),c("button",{type:"button",class:Te(["rotation-preset-btn",{selected:f.value===90}]),onClick:ee[13]||(ee[13]=Z=>Ne(90))},"+90",2),c("button",{type:"button",class:Te(["rotation-preset-btn",{selected:f.value===180}]),onClick:ee[14]||(ee[14]=Z=>Ne(180))},"180",2)])])])):N("",!0)]),c("div",{class:"modal-footer"},[c("button",{type:"button",class:"btn-cancel",onClick:Ue},"Cancel"),c("button",{type:"button",class:"btn-apply",onClick:Ke},"Apply")])])])):N("",!0)}},s2=Je(o2,[["__scopeId","data-v-85cf9c89"]]),i2={class:"checkpoint-style-picker"},a2={class:"form-group"},r2={class:"style-options"},l2=["innerHTML"],c2={class:"option-label"},u2=["innerHTML"],d2="#667eea",h2={__name:"CheckpointStylePicker",props:{styleType:{type:String,default:"default"},styleColor:{type:String,default:""},styleBackgroundShape:{type:String,default:""},styleBackgroundColor:{type:String,default:""},styleBorderColor:{type:String,default:""},styleIconColor:{type:String,default:""},styleSize:{type:String,default:""},styleMapRotation:{type:[String,Number],default:""},iconLabel:{type:String,default:"Marker style"},showPreview:{type:Boolean,default:!0},inheritedStyleType:{type:String,default:"default"},inheritedStyleColor:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""},defaultLabel:{type:String,default:"Default"},level:{type:String,default:"checkpoint"}},emits:["update:styleType","update:styleColor","update:styleBackgroundShape","update:styleBackgroundColor","update:styleBorderColor","update:styleIconColor","update:styleSize","update:styleMapRotation","change"],setup(e,{emit:t}){const o=e,i=t,s=D(o.styleType),a=D(o.styleColor||""),l=D(o.styleBackgroundShape||"default"),u=D(o.styleBackgroundColor||""),h=D(o.styleBorderColor||""),p=D(o.styleIconColor||""),f=D(o.styleSize||"default"),y=D(o.styleMapRotation||""),x=re=>!re||re==="default"?!1:si(re).category==="content",T=D(o.styleType&&o.styleType!=="default"&&o.styleType!=="custom"&&x(o.styleType)?o.styleType:"default"),I=D(!1),S=X(()=>!!(s.value&&s.value!=="default"||l.value&&l.value!=="default"&&l.value!=="circle"||u.value||h.value||p.value||f.value&&f.value!=="default"&&f.value!=="100")),R=re=>re&&re!==""&&re!=="default",E=re=>re&&re.startsWith("#"),M=X(()=>{const ve=R(o.inheritedStyleType),Ie=R(o.inheritedBackgroundShape),Re=E(o.inheritedBackgroundColor)||E(o.inheritedStyleColor),xe=E(o.inheritedBorderColor),he=E(o.inheritedIconColor),Q=R(o.inheritedSize);if(ve||Ie||Re||xe||he||Q){const ue=ve?o.inheritedStyleType:Ie?o.inheritedBackgroundShape:"circle",te=(E(o.inheritedBackgroundColor)?o.inheritedBackgroundColor:null)||(E(o.inheritedStyleColor)?o.inheritedStyleColor:null)||d2;return Jt({type:ue,backgroundShape:o.inheritedBackgroundShape||"circle",backgroundColor:te,borderColor:o.inheritedBorderColor||"#ffffff",iconColor:o.inheritedIconColor||"#ffffff",size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#10B981"/>
        <stop offset="50%" style="stop-color:#F59E0B"/>
        <stop offset="100%" style="stop-color:#EF4444"/>
      </linearGradient>
    </defs>
    <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#defaultGradient)" stroke="#fff" stroke-width="1.5"/>
  </svg>`}),_=X(()=>{const re=o.inheritedMapRotation;return re!==""&&re!==void 0&&re!==null&&re!==0?{transform:`rotate(${re}deg)`}:{}}),$=X(()=>{if(y.value!==""&&y.value!==void 0&&y.value!==null){const ve=parseInt(y.value,10)||0;if(ve!==0)return{transform:`rotate(${ve}deg)`}}const re=o.inheritedMapRotation;return re!==""&&re!==void 0&&re!==null&&re!==0?{transform:`rotate(${re}deg)`}:{}}),k=X(()=>{if(S.value){const re=T.value&&T.value!=="none"&&T.value!=="default";let ve=null;o.inheritedStyleType&&o.inheritedStyleType!=="default"&&o.inheritedStyleType!=="custom"&&si(o.inheritedStyleType).category==="content"&&(ve=o.inheritedStyleType);const Ie=T.value==="default"&&ve,Re=re||Ie,xe=re?T.value:Ie?ve:null,he=l.value&&l.value!=="default"?l.value:o.inheritedBackgroundShape||"circle",Q=Re?xe:he,J=u.value||o.inheritedBackgroundColor||o.inheritedStyleColor||"#667eea",ue=h.value||o.inheritedBorderColor||"#ffffff",te=p.value||o.inheritedIconColor||"#ffffff";return Jt({type:Q,backgroundShape:he,backgroundColor:J,borderColor:ue,iconColor:te,size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#e2e8f0" stroke="#cbd5e0" stroke-width="1.5"/>
    <path d="M12 8v8M8 12h8" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
  </svg>`}),w=()=>{s.value="default",T.value="default",i("update:styleType","default"),l.value="default",u.value="",a.value="",h.value="",p.value="",f.value="default",y.value="",i("update:styleBackgroundShape",""),i("update:styleBackgroundColor",""),i("update:styleColor",""),i("update:styleBorderColor",""),i("update:styleIconColor",""),i("update:styleSize",""),i("update:styleMapRotation",""),_e()},A=()=>{I.value=!0},ne=re=>{re.iconType==="none"?T.value="none":re.iconType?T.value=re.iconType:T.value="default",l.value=re.backgroundShape||"default",u.value=re.backgroundColor||"",h.value=re.borderColor||"",p.value=re.iconColor||"",f.value=re.size||"default",y.value=re.mapRotation??"";const ve=re.iconType==="none"||re.iconType&&re.iconType!==""||re.backgroundShape||re.backgroundColor||re.borderColor||re.iconColor||re.size||re.mapRotation!==""&&re.mapRotation!==0;re.iconType&&re.iconType!=="none"?s.value=re.iconType:ve?s.value="custom":s.value="default",i("update:styleType",s.value),i("update:styleBackgroundShape",re.backgroundShape),i("update:styleBackgroundColor",re.backgroundColor),i("update:styleBorderColor",re.borderColor),i("update:styleIconColor",re.iconColor),i("update:styleSize",re.size),i("update:styleMapRotation",re.mapRotation??""),_e()},ae=()=>{},_e=()=>{i("change",{styleType:s.value,styleColor:u.value||a.value,styleBackgroundShape:l.value,styleBackgroundColor:u.value,styleBorderColor:h.value,styleIconColor:p.value,styleSize:f.value,styleMapRotation:y.value})};return We(()=>o.styleType,re=>{s.value=re,re&&re!=="default"&&re!=="custom"&&x(re)?T.value=re:T.value="default"}),We(()=>o.styleColor,re=>{a.value=re||""}),We(()=>o.styleBackgroundShape,re=>{l.value=re||"default"}),We(()=>o.styleBackgroundColor,re=>{u.value=re||""}),We(()=>o.styleBorderColor,re=>{h.value=re||""}),We(()=>o.styleIconColor,re=>{p.value=re||""}),We(()=>o.styleSize,re=>{f.value=re||"default"}),We(()=>o.styleMapRotation,re=>{y.value=re??""}),(re,ve)=>(m(),g("div",i2,[c("div",a2,[c("label",null,b(e.iconLabel),1),c("div",r2,[c("button",{type:"button",class:Te(["style-option-button",{selected:!S.value}]),onClick:w},[c("div",{class:"option-preview",style:at(_.value),innerHTML:M.value},null,12,l2),c("span",c2,b(e.defaultLabel),1)],2),c("button",{type:"button",class:Te(["style-option-button",{selected:S.value}]),onClick:A},[c("div",{class:"option-preview",style:at($.value),innerHTML:k.value},null,12,u2),ve[1]||(ve[1]=c("span",{class:"option-label"},"Custom",-1))],2)])]),ze(s2,{isOpen:I.value,"onUpdate:isOpen":ve[0]||(ve[0]=Ie=>I.value=Ie),"icon-type":T.value,"background-shape":l.value,"background-color":u.value,"border-color":h.value,"icon-color":p.value,size:f.value,"map-rotation":y.value,level:e.level,"inherited-type":e.inheritedStyleType,"inherited-background-shape":e.inheritedBackgroundShape,"inherited-background-color":e.inheritedBackgroundColor||e.inheritedStyleColor,"inherited-border-color":e.inheritedBorderColor,"inherited-icon-color":e.inheritedIconColor,"inherited-size":e.inheritedSize,"inherited-map-rotation":e.inheritedMapRotation,onApply:ne,onCancel:ae},null,8,["isOpen","icon-type","background-shape","background-color","border-color","icon-color","size","map-rotation","level","inherited-type","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])]))}},du=Je(h2,[["__scopeId","data-v-be328832"]]),f2={class:"logo-uploader"},p2={key:0,class:"logo-preview"},v2=["src"],m2=["disabled"],g2={key:0,class:"upload-progress"},y2={key:1,class:"upload-prompt"},_2={key:2,class:"error-message"},ph=500*1024,k2={__name:"LogoUploader",props:{modelValue:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,i=t,s=D(null),a=D(!1),l=D(!1),u=D(""),h=["image/png","image/jpeg","image/svg+xml","image/gif","image/webp"];function p(){a.value||s.value?.click()}function f(I){const S=I.target.files?.[0];S&&x(S),s.value&&(s.value.value="")}function y(I){l.value=!1;const S=I.dataTransfer?.files?.[0];S&&x(S)}async function x(I){if(u.value="",!h.includes(I.type)){u.value="Invalid file type. Please use PNG, JPEG, SVG, GIF, or WebP.";return}if(I.size>ph){u.value=`File too large. Maximum size is ${ph/1024}KB.`;return}a.value=!0;try{const S=await fetch(`/api/events/${o.eventId}/logo`,{method:"POST",headers:{"Content-Type":I.type,"X-Admin-Email":o.adminEmail},body:I});if(!S.ok){const E=await S.json().catch(()=>({}));throw new Error(E.message||"Upload failed")}const R=await S.json();i("update:modelValue",R.logoUrl)}catch(S){console.error("Logo upload error:",S),u.value=S.message||"Failed to upload logo. Please try again."}finally{a.value=!1}}async function T(){u.value="",a.value=!0;try{const I=await fetch(`/api/events/${o.eventId}/logo`,{method:"DELETE",headers:{"X-Admin-Email":o.adminEmail}});if(!I.ok){const S=await I.json().catch(()=>({}));throw new Error(S.message||"Delete failed")}i("update:modelValue","")}catch(I){console.error("Logo delete error:",I),u.value=I.message||"Failed to remove logo. Please try again."}finally{a.value=!1}}return(I,S)=>(m(),g("div",f2,[S[4]||(S[4]=c("label",{class:"uploader-label"},"Event Logo",-1)),e.modelValue?(m(),g("div",p2,[c("img",{src:e.modelValue,alt:"Event logo",class:"logo-image"},null,8,v2),c("button",{type:"button",class:"remove-btn",onClick:T,disabled:a.value}," Remove ",8,m2)])):(m(),g("div",{key:1,class:Te(["upload-area",{"drag-over":l.value,uploading:a.value}]),onDragover:S[0]||(S[0]=vt(R=>l.value=!0,["prevent"])),onDragleave:S[1]||(S[1]=vt(R=>l.value=!1,["prevent"])),onDrop:vt(y,["prevent"]),onClick:p},[c("input",{ref_key:"fileInput",ref:s,type:"file",accept:"image/png,image/jpeg,image/svg+xml,image/gif,image/webp",class:"file-input",onChange:f},null,544),a.value?(m(),g("div",g2,[...S[2]||(S[2]=[c("div",{class:"spinner"},null,-1),c("span",null,"Uploading...",-1)])])):(m(),g("div",y2,[...S[3]||(S[3]=[c("div",{class:"upload-icon"},"+",-1),c("span",{class:"upload-text"},"Click or drag to upload logo",-1),c("span",{class:"upload-hint"},"PNG, JPEG, SVG, GIF, WebP (max 500KB)",-1)])]))],34)),u.value?(m(),g("div",_2,b(u.value),1)):N("",!0)]))}},b2=Je(k2,[["__scopeId","data-v-9c7104d5"]]),Rp=[{name:"Default",headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},{name:"Wasp",headerGradientStart:"#333333",headerGradientEnd:"#333333",accentColor:"#FFD700",pageGradientStart:"#FFD700",pageGradientEnd:"#333333"},{name:"Ocean",headerGradientStart:"#0077be",headerGradientEnd:"#00a8e8",accentColor:"#0077be",pageGradientStart:"#0077be",pageGradientEnd:"#00a8e8"},{name:"Forest",headerGradientStart:"#228b22",headerGradientEnd:"#32cd32",accentColor:"#228b22",pageGradientStart:"#228b22",pageGradientEnd:"#32cd32"},{name:"Sunset",headerGradientStart:"#ff6b35",headerGradientEnd:"#f7931e",accentColor:"#ff6b35",pageGradientStart:"#ff6b35",pageGradientEnd:"#f7931e"},{name:"Berry",headerGradientStart:"#8e2de2",headerGradientEnd:"#4a00e0",accentColor:"#8e2de2",pageGradientStart:"#8e2de2",pageGradientEnd:"#4a00e0"},{name:"Coral",headerGradientStart:"#ff758c",headerGradientEnd:"#ff7eb3",accentColor:"#ff758c",pageGradientStart:"#ff758c",pageGradientEnd:"#ff7eb3"},{name:"Steel",headerGradientStart:"#485563",headerGradientEnd:"#29323c",accentColor:"#485563",pageGradientStart:"#485563",pageGradientEnd:"#29323c"},{name:"Mint",headerGradientStart:"#11998e",headerGradientEnd:"#38ef7d",accentColor:"#11998e",pageGradientStart:"#11998e",pageGradientEnd:"#38ef7d"},{name:"Cherry",headerGradientStart:"#eb3349",headerGradientEnd:"#f45c43",accentColor:"#eb3349",pageGradientStart:"#eb3349",pageGradientEnd:"#f45c43"},{name:"Midnight",headerGradientStart:"#232526",headerGradientEnd:"#414345",accentColor:"#5c5c5c",pageGradientStart:"#232526",pageGradientEnd:"#414345"},{name:"Lavender",headerGradientStart:"#a18cd1",headerGradientEnd:"#fbc2eb",accentColor:"#a18cd1",pageGradientStart:"#a18cd1",pageGradientEnd:"#fbc2eb"},{name:"Gold",headerGradientStart:"#f7971e",headerGradientEnd:"#ffd200",accentColor:"#f7971e",pageGradientStart:"#f7971e",pageGradientEnd:"#ffd200"}];function w2(){return{...Rp[0]}}function C2(e,t){return{...e,headerGradientStart:t.headerGradientStart,headerGradientEnd:t.headerGradientEnd,accentColor:t.accentColor,pageGradientStart:t.pageGradientStart,pageGradientEnd:t.pageGradientEnd,logoUrl:"",logoPosition:""}}function Bc(e){const t=e.replace("#",""),o=parseInt(t.slice(0,2),16)/255,i=parseInt(t.slice(2,4),16)/255,s=parseInt(t.slice(4,6),16)/255,a=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),l=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*a+.7152*l+.0722*u}function Bp(e){return!e||e===""?"#ffffff":Bc(e)>.179?"#333333":"#ffffff"}function Np(e,t){const o=e||Ln.headerGradientStart,i=t||Ln.headerGradientEnd,s=Bc(o),a=Bc(i);return(s+a)/2>.35?"#333333":"#ffffff"}const Ln={headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},L2={class:"marshal-mockup-container"},S2={class:"presets-section"},x2={class:"presets-row"},T2=["title","onClick"],I2={class:"preset-name"},$2={class:"mockup-frame"},M2={key:0,class:"logo-cover-bg"},A2=["src"],E2=["src"],P2={key:1,class:"logo-placeholder"},D2={class:"event-name"},O2={class:"mockup-buttons"},R2=["src"],B2={key:1,class:"logo-placeholder"},N2={class:"mockup-body"},F2={class:"mockup-card"},U2={class:"card-content"},z2={class:"editor-modal"},H2={class:"editor-header"},V2={class:"editor-content"},G2={class:"color-grid-inline"},Z2={class:"color-field"},j2={class:"color-swatches"},W2=["title","onClick"],q2={key:0,class:"check"},K2={class:"color-field"},Y2={class:"color-swatches"},J2=["title","onClick"],X2={key:0,class:"check"},Q2={class:"logo-position-section"},eS={class:"position-buttons"},tS={class:"color-swatches"},nS=["title","onClick"],oS={key:0,class:"check"},sS={class:"color-grid-inline"},iS={class:"color-field"},aS={class:"color-swatches"},rS=["title","onClick"],lS={key:0,class:"check"},cS={class:"color-field"},uS={class:"color-swatches"},dS=["title","onClick"],hS={key:0,class:"check"},fS={class:"editor-footer"},pS={__name:"MarshalModeMockup",props:{branding:{type:Object,required:!0},eventName:{type:String,default:""},eventDate:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:branding"],setup(e,{emit:t}){const o=Pn,i=e,s=t,a=D(null),l=Rp,u={header:"Header gradient",logo:"Event logo",accent:"Accent colour",page:"Page background"},h=X(()=>i.branding.headerGradientStart||Ln.headerGradientStart),p=X(()=>i.branding.headerGradientEnd||Ln.headerGradientEnd),f=X(()=>i.branding.accentColor||Ln.accentColor),y=X(()=>i.branding.pageGradientStart||Ln.pageGradientStart),x=X(()=>i.branding.pageGradientEnd||Ln.pageGradientEnd),T=X(()=>i.branding.logoPosition||"left"),I=X(()=>({background:`linear-gradient(135deg, ${h.value} 0%, ${p.value} 100%)`})),S=X(()=>Np(h.value,p.value)),R=X(()=>({background:f.value,color:Bp(f.value)})),E=X(()=>({background:`linear-gradient(135deg, ${y.value} 0%, ${x.value} 100%)`}));function M(k){a.value=a.value===k?null:k}function _(k,w){s("update:branding",{...i.branding,[k]:w})}function $(k){s("update:branding",C2(i.branding,k)),a.value=null}return(k,w)=>(m(),g("div",L2,[c("div",S2,[w[13]||(w[13]=c("span",{class:"presets-label"},"Quick themes:",-1)),c("div",x2,[(m(!0),g(Ce,null,Be(z(l),A=>(m(),g("button",{key:A.name,type:"button",class:"preset-btn",title:A.name,onClick:ne=>$(A)},[c("span",{class:"preset-preview",style:at({background:`linear-gradient(135deg, ${A.pageGradientStart} 0%, ${A.pageGradientEnd} 100%)`})},null,4),c("span",I2,b(A.name),1)],8,T2))),128))])]),c("div",$2,[c("div",{class:Te(["mockup-page",{"region-active":a.value==="page"}]),style:at(E.value),onClick:w[5]||(w[5]=A=>M("page"))},[c("div",{class:Te(["mockup-header",[{"region-active":a.value==="header"},`logo-${T.value}`]]),style:at(I.value),onClick:w[3]||(w[3]=vt(A=>M("header"),["stop"]))},[e.branding.logoUrl&&T.value==="cover"?(m(),g("div",M2,[c("img",{src:e.branding.logoUrl,alt:"Logo",class:"logo-cover-img"},null,8,A2)])):N("",!0),T.value==="left"?(m(),g("div",{key:1,class:Te(["mockup-logo logo-left",{"region-active":a.value==="logo"}]),onClick:w[0]||(w[0]=vt(A=>M("logo"),["stop"]))},[e.branding.logoUrl?(m(),g("img",{key:0,src:e.branding.logoUrl,alt:"Logo",class:"logo-img"},null,8,E2)):(m(),g("span",P2,"+ Logo"))],2)):N("",!0),c("div",{class:Te(["header-center",{"region-active":a.value==="logo"&&!e.branding.logoUrl&&T.value!=="left"&&T.value!=="right"}]),onClick:w[1]||(w[1]=vt(A=>M("logo"),["stop"]))},[c("div",{class:"mockup-title",style:at({color:S.value})},[c("span",D2,b(e.eventName||"Event Name"),1)],4),c("div",{class:"mockup-date",style:at({color:S.value})},b(e.eventDate||"Event Date"),5),c("div",O2,[w[14]||(w[14]=c("span",{class:"btn-emergency"},"Emergency",-1)),c("span",{class:"btn-logout",style:at({color:S.value})},"Logout",4)])],2),T.value==="right"?(m(),g("div",{key:2,class:Te(["mockup-logo logo-right",{"region-active":a.value==="logo"}]),onClick:w[2]||(w[2]=vt(A=>M("logo"),["stop"]))},[e.branding.logoUrl?(m(),g("img",{key:0,src:e.branding.logoUrl,alt:"Logo",class:"logo-img"},null,8,R2)):(m(),g("span",B2,"+ Logo"))],2)):N("",!0)],6),c("div",N2,[c("div",F2,[w[15]||(w[15]=c("div",{class:"card-header"},"Your checkpoints (2)",-1)),c("div",U2,[c("div",{class:Te(["mockup-checkin-btn",{"region-active":a.value==="accent"}]),style:at(R.value),onClick:w[4]||(w[4]=vt(A=>M("accent"),["stop"]))}," GPS Check-In ",6)])])])],6)]),a.value?(m(),g("div",{key:0,class:"editor-overlay",onClick:w[12]||(w[12]=vt(A=>a.value=null,["self"]))},[c("div",z2,[c("div",H2,[c("span",null,b(u[a.value]),1),c("button",{type:"button",class:"editor-close",onClick:w[6]||(w[6]=A=>a.value=null)},"")]),c("div",V2,[a.value==="header"?(m(),g(Ce,{key:0},[w[18]||(w[18]=c("p",{class:"editor-description"},"Choose the colours for the header gradient.",-1)),c("div",G2,[c("div",Z2,[w[16]||(w[16]=c("label",null,"Start colour",-1)),c("div",j2,[(m(!0),g(Ce,null,Be(z(o),A=>(m(),g("button",{key:"hs-"+A.hex,type:"button",class:Te(["color-swatch-btn",{selected:e.branding.headerGradientStart===A.hex}]),style:at({backgroundColor:A.hex}),title:A.name,onClick:ne=>_("headerGradientStart",A.hex)},[e.branding.headerGradientStart===A.hex?(m(),g("span",q2,"")):N("",!0)],14,W2))),128))])]),c("div",K2,[w[17]||(w[17]=c("label",null,"End colour",-1)),c("div",Y2,[(m(!0),g(Ce,null,Be(z(o),A=>(m(),g("button",{key:"he-"+A.hex,type:"button",class:Te(["color-swatch-btn",{selected:e.branding.headerGradientEnd===A.hex}]),style:at({backgroundColor:A.hex}),title:A.name,onClick:ne=>_("headerGradientEnd",A.hex)},[e.branding.headerGradientEnd===A.hex?(m(),g("span",X2,"")):N("",!0)],14,J2))),128))])])])],64)):N("",!0),a.value==="logo"?(m(),g(Ce,{key:1},[c("div",Q2,[w[19]||(w[19]=c("label",{class:"editor-label"},"Position",-1)),c("div",eS,[c("button",{type:"button",class:Te(["position-btn",{selected:T.value==="left"}]),onClick:w[7]||(w[7]=A=>_("logoPosition","left"))}," Left ",2),c("button",{type:"button",class:Te(["position-btn",{selected:T.value==="right"}]),onClick:w[8]||(w[8]=A=>_("logoPosition","right"))}," Right ",2),c("button",{type:"button",class:Te(["position-btn",{selected:T.value==="cover"}]),onClick:w[9]||(w[9]=A=>_("logoPosition","cover"))}," Cover ",2)])]),ze(b2,{"model-value":e.branding.logoUrl,"event-id":e.eventId,"admin-email":e.adminEmail,"onUpdate:modelValue":w[10]||(w[10]=A=>_("logoUrl",A))},null,8,["model-value","event-id","admin-email"])],64)):N("",!0),a.value==="accent"?(m(),g(Ce,{key:2},[w[20]||(w[20]=c("p",{class:"editor-description"},"Choose the accent colour for buttons.",-1)),c("div",tS,[(m(!0),g(Ce,null,Be(z(o),A=>(m(),g("button",{key:"ac-"+A.hex,type:"button",class:Te(["color-swatch-btn",{selected:e.branding.accentColor===A.hex}]),style:at({backgroundColor:A.hex}),title:A.name,onClick:ne=>_("accentColor",A.hex)},[e.branding.accentColor===A.hex?(m(),g("span",oS,"")):N("",!0)],14,nS))),128))])],64)):N("",!0),a.value==="page"?(m(),g(Ce,{key:3},[w[23]||(w[23]=c("p",{class:"editor-description"},"Choose the colours for the page background gradient.",-1)),c("div",sS,[c("div",iS,[w[21]||(w[21]=c("label",null,"Start colour",-1)),c("div",aS,[(m(!0),g(Ce,null,Be(z(o),A=>(m(),g("button",{key:"ps-"+A.hex,type:"button",class:Te(["color-swatch-btn",{selected:e.branding.pageGradientStart===A.hex}]),style:at({backgroundColor:A.hex}),title:A.name,onClick:ne=>_("pageGradientStart",A.hex)},[e.branding.pageGradientStart===A.hex?(m(),g("span",lS,"")):N("",!0)],14,rS))),128))])]),c("div",cS,[w[22]||(w[22]=c("label",null,"End colour",-1)),c("div",uS,[(m(!0),g(Ce,null,Be(z(o),A=>(m(),g("button",{key:"pe-"+A.hex,type:"button",class:Te(["color-swatch-btn",{selected:e.branding.pageGradientEnd===A.hex}]),style:at({backgroundColor:A.hex}),title:A.name,onClick:ne=>_("pageGradientEnd",A.hex)},[e.branding.pageGradientEnd===A.hex?(m(),g("span",hS,"")):N("",!0)],14,dS))),128))])])])],64)):N("",!0)]),c("div",fS,[c("button",{type:"button",class:"btn-done",onClick:w[11]||(w[11]=A=>a.value=null)},"Done")])])])):N("",!0),w[24]||(w[24]=c("p",{class:"instructions"}," Click on different parts of the preview to customise them. The emergency button stays red for safety. ",-1))]))}},vS=Je(pS,[["__scopeId","data-v-0a85c419"]]),mS={class:"settings-tab"},gS={class:"accordion"},yS={class:"accordion-section"},_S={class:"accordion-title"},kS={class:"accordion-icon"},bS={key:0,class:"accordion-content"},wS={class:"accordion-section"},CS={class:"accordion-icon"},LS={key:0,class:"accordion-content"},SS={class:"terminology-grid"},xS={class:"term-group"},TS=["value"],IS={class:"term-group"},$S=["value"],MS={class:"term-group"},AS=["value"],ES={class:"term-group"},PS=["value"],DS={class:"term-group"},OS=["value"],RS={class:"form-actions"},BS=["disabled"],NS={class:"accordion-section"},FS={class:"accordion-title"},US={class:"accordion-icon"},zS={key:0,class:"accordion-content"},HS={class:"section-description"},VS={class:"form-actions"},GS=["disabled"],ZS={class:"accordion-section"},jS={class:"accordion-title"},WS={class:"accordion-icon"},qS={key:0,class:"accordion-content"},KS={class:"section-description"},YS={class:"form-actions"},JS=["disabled"],vh="admin_settings_accordion",XS={__name:"SettingsTab",props:{eventData:{type:Object,required:!0},admins:{type:Array,default:()=>[]},formDirty:{type:Boolean,default:!1},eventId:{type:String,default:""}},emits:["submit","add-admin","remove-admin","update:formDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=Za(),a=X(()=>s.adminEmail||""),l=e,u=t,h=D({...l.eventData}),p=()=>l.eventId?`${vh}_${l.eventId}`:vh,f=D(null);un(()=>{const _=localStorage.getItem(p());_&&(f.value=_)});const y=X(()=>{const _=h.value.peopleTerm||"Marshals";return qo.checkpoint.map($=>({value:$,label:Pc($,_)}))}),x=_=>{const $=f.value===_?null:_;f.value=$,$?localStorage.setItem(p(),$):localStorage.removeItem(p())};We(()=>l.eventData,_=>{h.value={..._}},{deep:!0});const T=()=>{u("update:formDirty",!0)},I=(_,$)=>{h.value[_]=$,T()},S=X(()=>({headerGradientStart:h.value.brandingHeaderGradientStart||"",headerGradientEnd:h.value.brandingHeaderGradientEnd||"",logoUrl:h.value.brandingLogoUrl||"",logoPosition:h.value.brandingLogoPosition||"",accentColor:h.value.brandingAccentColor||"",pageGradientStart:h.value.brandingPageGradientStart||"",pageGradientEnd:h.value.brandingPageGradientEnd||""})),R=_=>{h.value.brandingHeaderGradientStart=_.headerGradientStart,h.value.brandingHeaderGradientEnd=_.headerGradientEnd,h.value.brandingLogoUrl=_.logoUrl,h.value.brandingLogoPosition=_.logoPosition,h.value.brandingAccentColor=_.accentColor,h.value.brandingPageGradientStart=_.pageGradientStart,h.value.brandingPageGradientEnd=_.pageGradientEnd,T()},E=()=>{w2(),h.value.brandingHeaderGradientStart="",h.value.brandingHeaderGradientEnd="",h.value.brandingLogoUrl="",h.value.brandingLogoPosition="",h.value.brandingAccentColor="",h.value.brandingPageGradientStart="",h.value.brandingPageGradientEnd="",T()},M=()=>{u("submit",{...h.value})};return(_,$)=>(m(),g("div",mS,[c("div",gS,[c("div",yS,[c("button",{class:Te(["accordion-header",{active:f.value==="admins"}]),onClick:$[0]||($[0]=k=>x("admins"))},[c("span",_S,"Administrators ("+b(e.admins.length)+")",1),c("span",kS,b(f.value==="admins"?"-":"+"),1)],2),f.value==="admins"?(m(),g("div",bS,[ze(WC,{admins:e.admins,onAddAdmin:$[1]||($[1]=k=>_.$emit("add-admin")),onRemoveAdmin:$[2]||($[2]=k=>_.$emit("remove-admin",k))},null,8,["admins"])])):N("",!0)]),c("div",wS,[c("button",{class:Te(["accordion-header",{active:f.value==="terminology"}]),onClick:$[3]||($[3]=k=>x("terminology"))},[$[19]||($[19]=c("span",{class:"accordion-title"},"Terminology",-1)),c("span",CS,b(f.value==="terminology"?"-":"+"),1)],2),f.value==="terminology"?(m(),g("div",LS,[$[20]||($[20]=c("p",{class:"section-description"}," Customise how things are named throughout the application. ",-1)),c("div",SS,[c("div",xS,[c("label",null,b(z(o).people)+" are called",1),je(c("select",{"onUpdate:modelValue":$[4]||($[4]=k=>h.value.peopleTerm=k),class:"form-input",onChange:T},[(m(!0),g(Ce,null,Be(z(qo).people,k=>(m(),g("option",{key:k,value:k},b(k),9,TS))),128))],544),[[Sn,h.value.peopleTerm]])]),c("div",IS,[c("label",null,b(z(o).checkpoints)+" are called",1),je(c("select",{"onUpdate:modelValue":$[5]||($[5]=k=>h.value.checkpointTerm=k),class:"form-input",onChange:T},[(m(!0),g(Ce,null,Be(y.value,k=>(m(),g("option",{key:k.value,value:k.value},b(k.label),9,$S))),128))],544),[[Sn,h.value.checkpointTerm]])]),c("div",MS,[c("label",null,b(z(o).areas)+" are called",1),je(c("select",{"onUpdate:modelValue":$[6]||($[6]=k=>h.value.areaTerm=k),class:"form-input",onChange:T},[(m(!0),g(Ce,null,Be(z(qo).area,k=>(m(),g("option",{key:k,value:k},b(k),9,AS))),128))],544),[[Sn,h.value.areaTerm]])]),c("div",ES,[c("label",null,b(z(o).checklists)+" are called",1),je(c("select",{"onUpdate:modelValue":$[7]||($[7]=k=>h.value.checklistTerm=k),class:"form-input",onChange:T},[(m(!0),g(Ce,null,Be(z(qo).checklist,k=>(m(),g("option",{key:k,value:k},b(k),9,PS))),128))],544),[[Sn,h.value.checklistTerm]])]),c("div",DS,[c("label",null,b(z(o).course)+" is called",1),je(c("select",{"onUpdate:modelValue":$[8]||($[8]=k=>h.value.courseTerm=k),class:"form-input",onChange:T},[(m(!0),g(Ce,null,Be(z(qo).course,k=>(m(),g("option",{key:k,value:k},b(k),9,OS))),128))],544),[[Sn,h.value.courseTerm]])])]),c("div",RS,[c("button",{onClick:M,class:"btn btn-primary",disabled:!e.formDirty}," Save Changes ",8,BS)])])):N("",!0)]),c("div",NS,[c("button",{class:Te(["accordion-header",{active:f.value==="appearance"}]),onClick:$[9]||($[9]=k=>x("appearance"))},[c("span",FS,b(z(o).checkpoint)+" appearance",1),c("span",US,b(f.value==="appearance"?"-":"+"),1)],2),f.value==="appearance"?(m(),g("div",zS,[c("p",HS," Set the default marker style for all "+b(z(i).checkpoints)+" in this event. Individual "+b(z(i).areas)+" and "+b(z(i).checkpoints)+" can override this setting. ",1),ze(du,{"style-type":h.value.defaultCheckpointStyleType||"default","style-color":h.value.defaultCheckpointStyleColor||"","style-background-shape":h.value.defaultCheckpointStyleBackgroundShape||"","style-background-color":h.value.defaultCheckpointStyleBackgroundColor||"","style-border-color":h.value.defaultCheckpointStyleBorderColor||"","style-icon-color":h.value.defaultCheckpointStyleIconColor||"","style-size":h.value.defaultCheckpointStyleSize||"","style-map-rotation":h.value.defaultCheckpointStyleMapRotation??"","icon-label":"Default marker style",level:"event","show-preview":!0,"onUpdate:styleType":$[10]||($[10]=k=>I("defaultCheckpointStyleType",k)),"onUpdate:styleColor":$[11]||($[11]=k=>I("defaultCheckpointStyleColor",k)),"onUpdate:styleBackgroundShape":$[12]||($[12]=k=>I("defaultCheckpointStyleBackgroundShape",k)),"onUpdate:styleBackgroundColor":$[13]||($[13]=k=>I("defaultCheckpointStyleBackgroundColor",k)),"onUpdate:styleBorderColor":$[14]||($[14]=k=>I("defaultCheckpointStyleBorderColor",k)),"onUpdate:styleIconColor":$[15]||($[15]=k=>I("defaultCheckpointStyleIconColor",k)),"onUpdate:styleSize":$[16]||($[16]=k=>I("defaultCheckpointStyleSize",k)),"onUpdate:styleMapRotation":$[17]||($[17]=k=>I("defaultCheckpointStyleMapRotation",k))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation"]),c("div",VS,[c("button",{onClick:M,class:"btn btn-primary",disabled:!e.formDirty}," Save Changes ",8,GS)])])):N("",!0)]),c("div",ZS,[c("button",{class:Te(["accordion-header",{active:f.value==="branding"}]),onClick:$[18]||($[18]=k=>x("branding"))},[c("span",jS,b(z(o).person)+" branding",1),c("span",WS,b(f.value==="branding"?"-":"+"),1)],2),f.value==="branding"?(m(),g("div",qS,[c("p",KS," Customise the appearance of the "+b(z(i).person)+" view to match your organisation's branding. ",1),ze(vS,{branding:S.value,"event-name":h.value.name,"event-date":z(Ep)(h.value.eventDate),"event-id":e.eventId,"admin-email":a.value,"onUpdate:branding":R},null,8,["branding","event-name","event-date","event-id","admin-email"]),c("div",YS,[c("button",{onClick:M,class:"btn btn-primary",disabled:!e.formDirty}," Save Changes ",8,JS),c("button",{onClick:E,class:"btn btn-secondary"}," Reset to Default ")])])):N("",!0)])])]))}},QS=Je(XS,[["__scopeId","data-v-9b83126c"]]),ex={class:"button-group"},tx={key:0,class:"add-dropdown"},nx={key:0,class:"filter-group"},ox={class:"filter-checkbox"},sx=["checked"],ix={class:"locations-list"},ax=["onClick"],rx={class:"location-info"},lx={class:"location-header"},cx=["innerHTML"],ux={class:"location-name-desc"},dx={key:0,class:"location-description"},hx={class:"location-status"},fx={class:"location-assignments"},px={__name:"CheckpointsList",props:{locations:{type:Array,required:!0},areas:{type:Array,default:()=>[]}},emits:["add-checkpoint-manually","import-checkpoints","select-location"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=e,a=t,l=D(!0),u=D([]),h=D(null),p=D(null),f=D(!1),y=()=>{f.value=!f.value},x=()=>{f.value=!1,a("add-checkpoint-manually")},T=()=>{f.value=!1,a("import-checkpoints")},I=$=>{p.value&&!p.value.contains($.target)&&(f.value=!1)};un(()=>{document.addEventListener("click",I)}),Ao(()=>{document.removeEventListener("click",I)});const S=()=>{l.value=!l.value,!l.value&&u.value.length===0&&(u.value=s.areas.map($=>$.id))},R=X(()=>{let $=s.locations;return!l.value&&u.value.length>0&&($=$.filter(k=>(k.areaIds||k.AreaIds||[]).some(A=>u.value.includes(A)))),[...$].sort((k,w)=>Tn(k.name,w.name))}),E=$=>{const k=s.areas.find(w=>w.id===$);return k?k.name:null},M=$=>{const k=s.areas.find(w=>w.id===$);return k?k.color:"#999"},_=$=>{const k=$.resolvedStyleType||$.ResolvedStyleType,w=$.resolvedStyleBackgroundColor||$.ResolvedStyleBackgroundColor||$.resolvedStyleColor||$.ResolvedStyleColor,A=$.resolvedStyleBorderColor||$.ResolvedStyleBorderColor,ne=$.resolvedStyleIconColor||$.ResolvedStyleIconColor,ae=$.resolvedStyleBackgroundShape||$.ResolvedStyleBackgroundShape;return k&&k!=="default"||w||A||ne||ae&&ae!=="circle"?Jt({type:k||"circle",backgroundShape:ae||"circle",backgroundColor:w||"#667eea",borderColor:A||"#ffffff",iconColor:ne||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`};return($,k)=>(m(),g("div",null,[c("h3",null,b(z(o).checkpoints)+" ("+b(e.locations.length)+")",1),c("div",ex,[c("div",{class:"add-menu-wrapper",ref_key:"menuWrapperRef",ref:p},[c("button",{ref_key:"addButtonRef",ref:h,onClick:y,class:"btn btn-small btn-primary"}," Add... ",512),f.value?(m(),g("div",tx,[c("button",{onClick:x,class:"dropdown-item"}," Add "+b(z(i).checkpoint)+" manually ",1),c("button",{onClick:T,class:"dropdown-item"}," Import from CSV... ")])):N("",!0)],512)]),e.areas.length>0?(m(),g("div",nx,[c("h4",null,"Filter by "+b(z(o).area.toLowerCase())+":",1),c("label",ox,[c("input",{type:"checkbox",checked:l.value,onChange:S},null,40,sx),Ze(" All "+b(z(o).areas.toLowerCase())+" ("+b(e.locations.length)+") ",1)]),l.value?N("",!0):(m(),rt(Op,{key:0,areas:e.areas,"selected-area-ids":u.value,"onUpdate:selectedAreaIds":k[0]||(k[0]=w=>u.value=w)},null,8,["areas","selected-area-ids"]))])):N("",!0),c("div",ix,[(m(!0),g(Ce,null,Be(R.value,w=>(m(),g("div",{key:w.id,class:Te(["location-item",{"location-full":w.checkedInCount>=w.requiredMarshals,"location-missing":w.checkedInCount===0}]),onClick:A=>$.$emit("select-location",w)},[c("div",rx,[c("div",lx,[c("span",{class:"checkpoint-icon",innerHTML:_(w)},null,8,cx),c("div",ux,[c("strong",null,b(w.name),1),w.description?(m(),g("span",dx," - "+b(w.description),1)):N("",!0)]),(m(!0),g(Ce,null,Be(w.areaIds||w.AreaIds||[],A=>(m(),g("span",{key:A,class:"area-badge",style:at({backgroundColor:M(A)})},b(E(A)),5))),128)),c("span",hx,b(w.checkedInCount)+"/"+b(w.requiredMarshals),1)])]),c("div",fx,[(m(!0),g(Ce,null,Be(w.assignments,A=>(m(),g("span",{key:A.id,class:Te(["assignment-badge",{"checked-in":A.isCheckedIn}])},b(A.marshalName),3))),128))])],10,ax))),128))])]))}},vx=Je(px,[["__scopeId","data-v-92e31410"]]),mx={class:"button-group"},gx={class:"areas-list"},yx=["onClick"],_x={class:"area-info"},kx={class:"area-header"},bx={key:0,class:"default-badge"},wx={key:0,class:"area-description"},Cx={class:"area-stats"},Lx={class:"stat-badge"},Sx={class:"stat-badge"},xx={key:0,class:"empty-state"},Tx={__name:"AreasList",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["add-area","select-area"],setup(e){const{terms:t}=Ct(),o=e,i=X(()=>[...o.areas].sort((p,f)=>p.displayOrder!==f.displayOrder?p.displayOrder-f.displayOrder:Tn(p.name,f.name))),s=p=>p.checkpointCount!==void 0?p.checkpointCount:o.checkpoints.filter(f=>f.areaId===p.id).length,a=p=>o.contacts.filter(f=>f.scopeConfigurations?f.scopeConfigurations.some(y=>y.scope==="EveryoneInAreas"&&y.itemType==="Area"?y.ids?.includes("ALL_AREAS")?!0:y.ids?.includes(p.id):!1):!1).length,l=p=>p.peopleTerm||o.eventPeopleTerm||"Marshals",u=(p,f)=>{const y=p.checkpointTerm||o.eventCheckpointTerm||"Checkpoints",x=l(p);return f===1?Ks("checkpoint",y,x):Ap("checkpoint",y,x)},h=p=>{const f=s(p),y=u(p,f).toLowerCase();return`${f} ${y}`};return(p,f)=>(m(),g("div",null,[c("h3",null,b(z(t).areas)+" ("+b(e.areas.length)+")",1),c("div",mx,[c("button",{onClick:f[0]||(f[0]=y=>p.$emit("add-area")),class:"btn btn-small btn-primary"}," Add "+b(z(t).area.toLowerCase()),1)]),c("div",gx,[(m(!0),g(Ce,null,Be(i.value,y=>(m(),g("div",{key:y.id,class:"area-item",style:at({borderLeftColor:y.color||"#667eea"}),onClick:x=>p.$emit("select-area",y)},[c("div",_x,[c("div",kx,[c("strong",null,b(y.name),1),y.isDefault?(m(),g("span",bx,"Default")):N("",!0)]),y.description?(m(),g("p",wx,b(y.description),1)):N("",!0),c("div",Cx,[c("span",Lx,b(h(y)),1),c("span",Sx,b(a(y))+" contact"+b(a(y)===1?"":"s"),1)])])],12,yx))),128)),e.areas.length===0?(m(),g("div",xx,[c("p",null,"No "+b(z(t).areas.toLowerCase())+' yet. Click "Add '+b(z(t).area.toLowerCase())+'" to create one.',1)])):N("",!0)])]))}},Ix=Je(Tx,[["__scopeId","data-v-7d1bf9df"]]),$x={course:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>',checkpoint:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',area:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',marshal:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',checklist:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>',notes:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/></svg>',details:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16h6"/></svg>',location:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',contacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>',people:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polygon points="22 8 19.5 10 20.5 13 18 11.5 15.5 13 16.5 10 14 8 17 8 18 5 19 8 22 8" fill="currentColor"/></svg>',eventContacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 8V6a2 2 0 0 0-2-2h-2"/><path d="M22 12v2a2 2 0 0 1-2 2h-2"/></svg>',event:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>',appearance:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12.5" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>'},On=e=>$x[e]||"",Mx={class:"responsive-tabs"},Ax=["onClick"],Ex=["innerHTML"],Px=["innerHTML"],Dx={class:"hamburger-label"},Ox=["onClick"],Rx=["innerHTML"],Bx={__name:"ResponsiveTabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,i=t,s=D(null),a=D(null),l=D(null),u=D(!1),h=D({}),p=D(!1),f=X(()=>o.tabs.find(E=>E.value===o.modelValue)),y=X(()=>f.value?f.value.label:"Menu"),x=()=>{if(u.value=!u.value,u.value&&a.value){const E=a.value.getBoundingClientRect();h.value={top:`${E.bottom+4}px`}}},T=E=>{i("update:modelValue",E),u.value=!1},I=E=>{if(!s.value)return;const M=s.value.contains(E.target);u.value&&!M&&(u.value=!1)},S=()=>{if(!l.value)return;const E=l.value,M=p.value;M&&(E.style.visibility="visible",E.style.position="static");const _=E.scrollWidth>E.clientWidth;M&&(E.style.visibility="",E.style.position=""),p.value=_};let R=null;return un(()=>{document.addEventListener("click",I),Xo(()=>{S()}),Xo(()=>{const E=l.value?.parentElement;E&&(R=new ResizeObserver(()=>{S()}),R.observe(E))})}),Ao(()=>{document.removeEventListener("click",I),R&&R.disconnect()}),We(()=>o.tabs,()=>{Xo(()=>{S()})},{deep:!0}),(E,M)=>(m(),g("div",Mx,[c("div",{ref_key:"visibleTabsRef",ref:l,class:Te(["visible-tabs",{"is-hidden":p.value}])},[(m(!0),g(Ce,null,Be(e.tabs,_=>(m(),g("button",{key:_.value,class:Te(["tab-button",{active:e.modelValue===_.value}]),onClick:$=>E.$emit("update:modelValue",_.value),type:"button"},[_.icon?(m(),g("span",{key:0,class:"tab-icon",innerHTML:z(On)(_.icon)},null,8,Ex)):N("",!0),Ze(" "+b(_.label),1)],10,Ax))),128))],2),c("div",{class:Te(["hamburger-only",{"is-visible":p.value}])},[c("div",{class:"hamburger-menu",ref_key:"hamburgerMenu",ref:s},[c("button",{ref_key:"hamburgerButton",ref:a,class:Te(["hamburger-button",{active:u.value}]),onClick:vt(x,["stop"]),type:"button"},[M[1]||(M[1]=c("span",{class:"hamburger-icon"},"",-1)),f.value?.icon?(m(),g("span",{key:0,class:"tab-icon",innerHTML:z(On)(f.value.icon)},null,8,Px)):N("",!0),c("span",Dx,b(y.value),1)],2),u.value?(m(),g("div",{key:0,class:"hamburger-dropdown",style:at(h.value),onClick:M[0]||(M[0]=vt(()=>{},["stop"]))},[(m(!0),g(Ce,null,Be(e.tabs,_=>(m(),g("button",{key:_.value,class:Te(["dropdown-item",{active:e.modelValue===_.value}]),onClick:vt($=>T(_.value),["stop"]),type:"button"},[_.icon?(m(),g("span",{key:0,class:"tab-icon",innerHTML:z(On)(_.icon)},null,8,Rx)):N("",!0),Ze(" "+b(_.label),1)],10,Ox))),128))],4)):N("",!0)],512)],2)]))}},Nx=Je(Bx,[["__scopeId","data-v-3d577110"]]),Fx={class:"share-link-container"},Ux=["value"],zx={__name:"ShareLinkModal",props:{show:{type:Boolean,default:!1},link:{type:String,required:!0},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=t,i=D(!1),s=D(null),a=()=>{s.value&&(s.value.select(),document.execCommand("copy"),i.value=!0,setTimeout(()=>{i.value=!1},2e3))},l=()=>{o("close")};return(u,h)=>(m(),rt(Ut,{show:e.show,title:"Marshal check-in link",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:l},{actions:nt(()=>[c("button",{onClick:l,class:"btn btn-secondary"},"Close")]),default:nt(()=>[h[0]||(h[0]=c("p",{class:"instruction"},"Share this link with marshals so they can check in:",-1)),c("div",Fx,[c("input",{value:e.link,readonly:"",class:"form-input",ref_key:"linkInput",ref:s},null,8,Ux),c("button",{onClick:a,class:"btn btn-primary"},b(i.value?"Copied!":"Copy"),1)])]),_:1},8,["show","is-dirty"]))}},Hx=Je(zx,[["__scopeId","data-v-e3c38c66"]]),Vx={class:"success-content"},Gx={class:"success-message"},Zx={class:"link-section"},jx={class:"help-text"},Wx={key:0,class:"loading-text"},qx={key:1,class:"magic-link-container"},Kx=["value"],Yx={class:"magic-link-actions"},Jx=["disabled"],Xx={key:0,class:"success-text"},Qx={key:1,class:"error-text"},eT={key:2,class:"error-text"},tT={__name:"MarshalCreatedModal",props:{show:{type:Boolean,default:!1},eventId:{type:String,required:!0},marshalId:{type:String,default:null},marshalName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const{terms:o}=Ct(),i=e,s=t,a=D(""),l=D(!1),u=D(!1),h=D(""),p=D(!1),f=D(!1),y=D(!1),x=D(""),T=async()=>{if(!(!i.eventId||!i.marshalId)){u.value=!0,h.value="";try{const E=await $o.getMagicLink(i.eventId,i.marshalId);a.value=E.data.magicLink,l.value=E.data.hasEmail}catch(E){console.error("Failed to fetch magic link:",E),h.value="Failed to load login link"}finally{u.value=!1}}},I=async()=>{try{await navigator.clipboard.writeText(a.value),p.value=!0,setTimeout(()=>{p.value=!1},2e3)}catch(E){console.error("Failed to copy:",E)}},S=async()=>{if(!(!i.eventId||!i.marshalId)){f.value=!0,y.value=!1,x.value="";try{await $o.sendMagicLink(i.eventId,i.marshalId),y.value=!0,setTimeout(()=>{y.value=!1},3e3)}catch(E){console.error("Failed to send email:",E),x.value=E.response?.data?.message||"Failed to send email"}finally{f.value=!1}}},R=()=>{s("close")};return We(()=>i.show,E=>{E&&i.marshalId?T():(a.value="",l.value=!1,h.value="",p.value=!1,y.value=!1,x.value="")},{immediate:!0}),(E,M)=>(m(),rt(Ut,{show:e.show,title:`${z(o).person} created`,size:"medium","confirm-on-close":!1,"is-dirty":!1,onClose:R},{actions:nt(()=>[c("button",{onClick:R,class:"btn btn-primary"},"Done")]),default:nt(()=>[c("div",Vx,[M[2]||(M[2]=c("div",{class:"success-icon"},"",-1)),c("p",Gx,[c("strong",null,b(e.marshalName),1),M[1]||(M[1]=Ze(" has been added successfully. ",-1))])]),c("div",Zx,[M[3]||(M[3]=c("label",null,"Login link",-1)),c("p",jx," Share this unique link with "+b(e.marshalName)+" so they can access their dashboard and check in. ",1),u.value?(m(),g("div",Wx,"Loading link...")):a.value?(m(),g("div",qx,[c("input",{type:"text",value:a.value,readonly:"",class:"form-input magic-link-input",onFocus:M[0]||(M[0]=_=>_.target.select())},null,40,Kx),c("div",Yx,[c("button",{type:"button",class:"btn btn-secondary",onClick:I},b(p.value?"Copied!":"Copy link"),1),l.value?(m(),g("button",{key:0,type:"button",class:"btn btn-primary",disabled:f.value,onClick:S},b(f.value?"Sending...":"Send via email"),9,Jx)):N("",!0)]),y.value?(m(),g("p",Xx,"Email sent successfully!")):N("",!0),x.value?(m(),g("p",Qx,b(x.value),1)):N("",!0)])):h.value?(m(),g("div",eT,b(h.value),1)):N("",!0)])]),_:1},8,["show","title"]))}},nT=Je(tT,[["__scopeId","data-v-0de41f28"]]),oT={class:"form-group"},sT={__name:"AddAdminModal",props:{show:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=D("");We(()=>o.show,h=>{h||(s.value="")});const a=()=>{i("update:isDirty",!0)},l=()=>{i("submit",s.value)},u=()=>{i("close")};return(h,p)=>(m(),rt(Ut,{show:e.show,title:"Add event administrator",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:nt(()=>[c("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:l,class:"btn btn-primary"}," Add administrator ")]),default:nt(()=>[p[2]||(p[2]=c("p",{class:"instruction"},"Enter the email address of the administrator to add",-1)),c("form",{onSubmit:vt(l,["prevent"])},[c("div",oT,[p[1]||(p[1]=c("label",null,"Email address",-1)),je(c("input",{"onUpdate:modelValue":p[0]||(p[0]=f=>s.value=f),type:"email",required:"",class:"form-input",placeholder:"admin@example.com",onInput:a},null,544),[[ut,s.value]])])],32)]),_:1},8,["show","is-dirty"]))}},iT=Je(sT,[["__scopeId","data-v-43ad537f"]]),aT={class:"form-group"},rT={key:0,class:"error"},lT=["disabled"],cT={__name:"UploadRouteModal",props:{show:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},error:{type:String,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=D(null);We(()=>o.show,h=>{h||(s.value=null)});const a=h=>{s.value=h.target.files[0],i("update:isDirty",!0)},l=()=>{s.value&&i("submit",s.value)},u=()=>{i("close")};return(h,p)=>(m(),rt(Ut,{show:e.show,title:"Upload GPX route",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:nt(()=>[c("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:l,class:"btn btn-primary",disabled:e.uploading},b(e.uploading?"Uploading...":"Upload route"),9,lT)]),default:nt(()=>[p[1]||(p[1]=c("p",{class:"instruction"},"Upload a GPX file to display the event route on the map",-1)),c("form",{onSubmit:vt(l,["prevent"])},[c("div",aT,[p[0]||(p[0]=c("label",null,"GPX file",-1)),c("input",{type:"file",accept:".gpx",onChange:a,required:"",class:"form-input"},null,32)]),e.error?(m(),g("div",rT,b(e.error),1)):N("",!0)],32)]),_:1},8,["show","is-dirty"]))}},uT=Je(cT,[["__scopeId","data-v-1c1d3033"]]),dT={class:"instruction"},hT={class:"form-group"},fT={class:"form-group"},pT={class:"checkbox-label"},vT={key:0,class:"error"},mT={key:1,class:"import-result"},gT={key:0,class:"import-errors"},yT=["disabled"],_T={__name:"ImportLocationsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=e,a=t,l=D(null),u=D(!1);We(()=>s.show,x=>{x||(l.value=null,u.value=!1)});const h=x=>{l.value=x.target.files[0],a("update:isDirty",!0)},p=()=>{a("update:isDirty",!0)},f=()=>{l.value&&a("submit",{file:l.value,deleteExisting:u.value})},y=()=>{a("close")};return(x,T)=>(m(),rt(Ut,{show:e.show,title:`Import ${z(i).checkpoints} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:y},{actions:nt(()=>[c("button",{type:"button",onClick:y,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:f,class:"btn btn-primary",disabled:e.importing},b(e.importing?"Importing...":`Import ${z(i).checkpoints}`),9,yT)]),default:nt(()=>[c("p",dT,"Upload a CSV file with columns: Label, Lat/Latitude, Long/Longitude, What3Words (optional), "+b(z(o).people)+" (optional)",1),T[3]||(T[3]=c("div",{class:"csv-example"},[c("strong",null,"Example CSV format:"),c("pre",null,`Label,Latitude,Longitude,What3Words,Marshals
Checkpoint 1,51.505,-0.09,filled.count.soap,"John Doe, Jane Smith"
Checkpoint 2,51.510,-0.10,index.home.raft,Bob Wilson`)],-1)),c("form",{onSubmit:vt(f,["prevent"])},[c("div",hT,[T[1]||(T[1]=c("label",null,"CSV file",-1)),c("input",{type:"file",accept:".csv",onChange:h,required:"",class:"form-input"},null,32)]),c("div",fT,[c("label",pT,[je(c("input",{type:"checkbox","onUpdate:modelValue":T[0]||(T[0]=I=>u.value=I),onChange:p},null,544),[[ws,u.value]]),Ze(" Delete existing "+b(z(i).checkpoints)+" before import ",1)])]),e.error?(m(),g("div",vT,b(e.error),1)):N("",!0),e.result?(m(),g("div",mT,[c("p",null,"Created "+b(e.result.locationsCreated)+" "+b(z(i).checkpoints)+" and "+b(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(m(),g("div",gT,[T[2]||(T[2]=c("strong",null,"Errors:",-1)),c("ul",null,[(m(!0),g(Ce,null,Be(e.result.errors,(I,S)=>(m(),g("li",{key:S},b(I),1))),128))])])):N("",!0)])):N("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},kT=Je(_T,[["__scopeId","data-v-e0a01848"]]),bT={class:"instruction"},wT={class:"form-group"},CT={key:0,class:"error"},LT={key:1,class:"import-result"},ST={key:0,class:"import-errors"},xT=["disabled"],TT={__name:"ImportMarshalsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=e,a=t,l=D(null);We(()=>s.show,f=>{f||(l.value=null)});const u=f=>{l.value=f.target.files[0],a("update:isDirty",!0)},h=()=>{l.value&&a("submit",l.value)},p=()=>{a("close")};return(f,y)=>(m(),rt(Ut,{show:e.show,title:`Import ${z(i).people} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:p},{actions:nt(()=>[c("button",{type:"button",onClick:p,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:h,class:"btn btn-primary",disabled:e.importing},b(e.importing?"Importing...":`Import ${z(i).people}`),9,xT)]),default:nt(()=>[c("p",bT,"Upload a CSV file with columns: Name, Email (optional), Phone (optional), "+b(z(o).checkpoint)+" (optional)",1),y[2]||(y[2]=c("div",{class:"csv-example"},[c("strong",null,"Example CSV format:"),c("pre",null,`Name,Email,Phone,Checkpoint
John Doe,john@example.com,555-1234,Checkpoint 1
Jane Smith,jane@example.com,555-5678,Checkpoint 2`)],-1)),c("form",{onSubmit:vt(h,["prevent"])},[c("div",wT,[y[0]||(y[0]=c("label",null,"CSV file",-1)),c("input",{type:"file",accept:".csv",onChange:u,required:"",class:"form-input"},null,32)]),e.error?(m(),g("div",CT,b(e.error),1)):N("",!0),e.result?(m(),g("div",LT,[c("p",null,"Imported "+b(e.result.marshalsCreated)+" "+b(z(i).people)+" and "+b(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(m(),g("div",ST,[y[1]||(y[1]=c("strong",null,"Errors:",-1)),c("ul",null,[(m(!0),g(Ce,null,Be(e.result.errors,(x,T)=>(m(),g("li",{key:T},b(x),1))),128))])])):N("",!0)])):N("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},IT=Je(TT,[["__scopeId","data-v-dcaed17c"]]),$T={key:0,class:"tabs"},MT=["onClick"],AT=["innerHTML"],ET=["innerHTML"],PT={class:"current-tab-label"},DT={key:0,class:"hamburger-menu"},OT=["onClick"],RT=["innerHTML"],BT=400,NT={__name:"TabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,i=t,s=D(null),a=D(null),l=D(!1),u=D(!1),h=X(()=>{const S=o.tabs.find(R=>R.value===o.modelValue);return S?S.label:""}),p=X(()=>o.tabs.find(R=>R.value===o.modelValue)?.icon||null),f=()=>{if(!s.value)return;const S=s.value.clientWidth,R=o.tabs.length*100;l.value=R>S||S<BT},y=()=>{u.value=!u.value},x=S=>{i("update:modelValue",S),u.value=!1},T=S=>{a.value&&!a.value.contains(S.target)&&(u.value=!1)};let I=null;return un(()=>{Xo(()=>{f(),s.value&&typeof ResizeObserver<"u"&&(I=new ResizeObserver(()=>{f()}),I.observe(s.value)),document.addEventListener("click",T)})}),Ao(()=>{I&&I.disconnect(),document.removeEventListener("click",T)}),We(()=>o.tabs,()=>{Xo(()=>{f()})},{deep:!0}),(S,R)=>(m(),g("div",{class:"tabs-container",ref_key:"containerRef",ref:s},[l.value?(m(),g("div",{key:1,class:"hamburger-container",ref_key:"hamburgerRef",ref:a},[c("button",{class:"hamburger-button",onClick:y,type:"button","aria-label":"Tab menu"},[p.value?(m(),g("span",{key:0,class:"current-tab-icon",innerHTML:z(On)(p.value)},null,8,ET)):N("",!0),c("span",PT,b(h.value),1),R[0]||(R[0]=c("span",{class:"hamburger-chevron"},"",-1))]),u.value?(m(),g("div",DT,[(m(!0),g(Ce,null,Be(e.tabs,E=>(m(),g("button",{key:E.value,class:Te(["menu-item",{active:e.modelValue===E.value}]),onClick:M=>x(E.value),type:"button"},[E.icon?(m(),g("span",{key:0,class:"tab-icon",innerHTML:z(On)(E.icon)},null,8,RT)):N("",!0),Ze(" "+b(E.label),1)],10,OT))),128))])):N("",!0)],512)):(m(),g("div",$T,[(m(!0),g(Ce,null,Be(e.tabs,E=>(m(),g("button",{key:E.value,class:Te(["tab-button",{active:e.modelValue===E.value}]),onClick:M=>S.$emit("update:modelValue",E.value),type:"button"},[E.icon?(m(),g("span",{key:0,class:"tab-icon",innerHTML:z(On)(E.icon)},null,8,AT)):N("",!0),Ze(" "+b(E.label),1)],10,MT))),128))]))],512))}},hu=Je(NT,[["__scopeId","data-v-5c12f1ab"]]),FT={class:"tab-content"},UT={class:"form-group"},zT=["value"],HT={class:"form-group"},VT=["value"],GT={class:"form-group"},ZT={class:"area-display"},jT={key:0,class:"no-area"},WT={class:"form-help"},qT={class:"form-group checkbox-group"},KT={class:"checkbox-label"},YT=["checked"],JT={class:"form-help"},XT={key:0,class:"custom-times-section"},QT={class:"form-group"},eI=["value"],tI={class:"form-help"},nI={class:"form-group"},oI=["value"],sI={class:"form-help"},iI={__name:"LocationDetailsTab",props:{form:{type:Object,required:!0},areas:{type:Array,default:()=>[]},eventDate:{type:String,default:""},areaTermSingular:{type:String,default:"Area"},areaTermPlural:{type:String,default:"Areas"},checkpointTermSingular:{type:String,default:"checkpoint"},peopleTermPlural:{type:String,default:"marshals"}},emits:["update:form","input","save"],setup(e,{emit:t}){const o=e,i=t,s=X(()=>(o.form.areaIds||o.form.AreaIds||[]).map(h=>o.areas.find(p=>p.id===h)).filter(h=>h!==void 0)),a=(u,h)=>{i("update:form",{...o.form,[u]:h}),i("input")},l=u=>{const h={...o.form,useCustomTimes:u};if(!u)h.startTime="",h.endTime="";else if(!h.startTime&&!h.endTime&&o.eventDate){const p=Oa(o.eventDate);h.startTime=p,h.endTime=p}i("update:form",h),i("input")};return(u,h)=>(m(),g("div",FT,[c("form",{onSubmit:h[5]||(h[5]=vt(p=>u.$emit("save"),["prevent"]))},[c("div",UT,[h[6]||(h[6]=c("label",null,"Name",-1)),c("input",{value:e.form.name,onInput:h[0]||(h[0]=p=>a("name",p.target.value)),type:"text",required:"",class:"form-input"},null,40,zT)]),c("div",HT,[h[7]||(h[7]=c("label",null,"Description (optional)",-1)),c("input",{value:e.form.description,onInput:h[1]||(h[1]=p=>a("description",p.target.value)),type:"text",class:"form-input"},null,40,VT)]),c("div",GT,[c("label",null,b(e.areaTermSingular)+" (auto-assigned by location)",1),c("div",ZT,[s.value.length===0?(m(),g("span",jT," Not in any "+b(e.areaTermSingular.toLowerCase())+" polygon ",1)):N("",!0),(m(!0),g(Ce,null,Be(s.value,p=>(m(),g("span",{key:p.id,class:"area-badge",style:at({backgroundColor:p.color||"#667eea"})},b(p.name),5))),128))]),c("small",WT,b(e.areaTermPlural)+" are automatically assigned based on "+b(e.checkpointTermSingular.toLowerCase())+" location within "+b(e.areaTermSingular.toLowerCase())+" boundaries ",1)]),c("div",qT,[c("label",KT,[c("input",{checked:e.form.useCustomTimes,onChange:h[2]||(h[2]=p=>l(p.target.checked)),type:"checkbox"},null,40,YT),c("span",null,"Use custom date/time for this "+b(e.checkpointTermSingular.toLowerCase()),1)]),c("small",JT," By default, "+b(e.peopleTermPlural.toLowerCase())+" are expected during the event date/time. Enable this to set a specific time range. ",1)]),e.form.useCustomTimes?(m(),g("div",XT,[c("div",QT,[h[8]||(h[8]=c("label",null,"Start date & time (optional)",-1)),c("input",{value:e.form.startTime,onInput:h[3]||(h[3]=p=>a("startTime",p.target.value)),type:"datetime-local",class:"form-input"},null,40,eI),c("small",tI," When "+b(e.peopleTermPlural.toLowerCase())+" should arrive at this "+b(e.checkpointTermSingular.toLowerCase()),1)]),c("div",nI,[h[9]||(h[9]=c("label",null,"End date & time (optional)",-1)),c("input",{value:e.form.endTime,onInput:h[4]||(h[4]=p=>a("endTime",p.target.value)),type:"datetime-local",class:"form-input"},null,40,oI),c("small",sI," When "+b(e.peopleTermPlural.toLowerCase())+" can leave this "+b(e.checkpointTermSingular.toLowerCase()),1)])])):N("",!0)],32)]))}},aI=Je(iI,[["__scopeId","data-v-628fdfe3"]]),rI={class:"scope-configuration-editor"},lI={class:"editor-header"},cI={class:"scope-types-list"},uI=["onClick"],dI={class:"scope-type-label"},hI={class:"scope-type-pill"},fI={class:"expand-label"},pI={class:"expand-icon"},vI={class:"modal-content"},mI={class:"modal-header"},gI={class:"modal-body"},yI={class:"scope-help"},_I={key:0,class:"form-group"},kI={class:"checkbox-label special-option"},bI=["checked"],wI={key:0,class:"specific-selection"},CI=["placeholder"],LI={class:"checkbox-group scrollable"},SI=["checked","onChange"],xI={key:1,class:"form-group"},TI={class:"checkbox-label special-option"},II=["checked"],$I={key:0,class:"specific-selection"},MI={class:"checkbox-group scrollable"},AI=["checked","onChange"],EI={key:2,class:"form-group"},PI={class:"checkbox-label special-option"},DI=["checked"],OI={key:0,class:"specific-selection"},RI=["placeholder"],BI={class:"checkbox-group scrollable"},NI={key:0,class:"checkbox-label this-checkpoint-option"},FI=["checked"],UI={class:"checkpoint-info"},zI={class:"checkpoint-name"},HI=["checked","onChange"],VI={class:"checkpoint-info"},GI={class:"checkpoint-name"},ZI={key:0,class:"checkpoint-description"},jI={__name:"ScopeConfigurationEditor",props:{modelValue:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},excludeScopes:{type:Array,default:()=>[]},headerText:{type:String,default:""},intent:{type:String,default:"completion",validator:e=>["completion","location-update"].includes(e)},currentCheckpointId:{type:String,default:null}},emits:["update:modelValue","user-changed"],setup(e,{emit:t}){const{termsLower:o}=Ct(),i=e,s=t,a=X(()=>[{scope:"SpecificPeople",label:`Specific ${o.value.people}`},{scope:"EveryoneAtCheckpoints",label:`Every ${o.value.person} at specified ${o.value.checkpoints}`},{scope:"OnePerCheckpoint",label:`One ${o.value.person} at each specified ${o.value.checkpoint}`},{scope:"OnePerArea",label:`One ${o.value.person} in specified ${o.value.areas}`},{scope:"EveryoneInAreas",label:`Everyone in specified ${o.value.areas}`},{scope:"EveryAreaLead",label:`Every ${o.value.area} lead at specified ${o.value.areas}`},{scope:"OneLeadPerArea",label:`One lead per specified ${o.value.area}`}]),l=D({SpecificPeople:{enabled:!0,ids:["ALL_MARSHALS"]},EveryoneInAreas:{enabled:!1,ids:[]},EveryoneAtCheckpoints:{enabled:!1,ids:[]},OnePerCheckpoint:{enabled:!1,ids:[]},OnePerArea:{enabled:!1,ids:[]},EveryAreaLead:{enabled:!1,ids:[]},OneLeadPerArea:{enabled:!1,ids:[]}}),u=D(null),h=D(""),p=D(""),f=D(!i.isEditing);let y=!0,x=!1;const T=X(()=>a.value.filter(q=>!i.excludeScopes.includes(q.scope))),I=X(()=>f.value?T.value:T.value.filter(q=>_e(q.scope))),S=X(()=>T.value.filter(fe=>_e(fe.scope)).length<T.value.length),R=X(()=>{const q=T.value.filter(fe=>_e(fe.scope)).length;return T.value.length-q}),E=X(()=>!i.currentCheckpointId&&i.intent==="location-update");We(()=>i.modelValue,q=>{if(q){if(x){x=!1;return}y=!0,Object.keys(l.value).forEach(fe=>{l.value[fe]={enabled:!1,ids:[]}}),q.forEach(fe=>{fe.scope==="Everyone"?l.value.SpecificPeople={enabled:!0,ids:["ALL_MARSHALS"]}:fe.scope==="AreaLead"?l.value.EveryAreaLead={enabled:!0,ids:[...fe.ids]}:l.value[fe.scope]&&(l.value[fe.scope]={enabled:!0,ids:[...fe.ids]})}),y=!1}},{immediate:!0});const M=()=>{const q=[];return Object.keys(l.value).forEach(fe=>{const Le=l.value[fe];if(Le.enabled){const F={scope:fe,itemType:_(fe),ids:[...Le.ids]};q.push(F)}}),q};We(l,()=>{if(y)return;if(Object.keys(l.value).some(Le=>Le!=="SpecificPeople"&&l.value[Le].enabled)&&l.value.SpecificPeople?.ids.includes("ALL_MARSHALS")){const Le=l.value.SpecificPeople.ids.indexOf("ALL_MARSHALS");l.value.SpecificPeople.ids.splice(Le,1),l.value.SpecificPeople.ids.length===0&&(l.value.SpecificPeople.enabled=!1)}x=!0;const fe=M();s("update:modelValue",fe),s("user-changed")},{deep:!0});const _=q=>$(q)?"Area":k(q)?"Checkpoint":w(q)?"Marshal":null,$=q=>q==="EveryoneInAreas"||q==="OnePerArea"||q==="EveryAreaLead"||q==="OneLeadPerArea",k=q=>q==="EveryoneAtCheckpoints"||q==="OnePerCheckpoint",w=q=>q==="SpecificPeople",A=q=>{const fe=a.value.find(Le=>Le.scope===q);return fe?fe.label:q},ne=X(()=>i.headerText?i.headerText:i.intent==="location-update"?"Who can update this location?":"Who can see and complete this item?"),ae=q=>i.intent==="location-update"?{SpecificPeople:`Select "Everyone" or choose specific ${o.value.people} who can update the location`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} can update the location`,OnePerCheckpoint:`Any ${o.value.person} at each selected ${o.value.checkpoint} can update the location`,OnePerArea:`Any ${o.value.person} in each selected ${o.value.area} can update the location`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} can update the location`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} can update the location`,OneLeadPerArea:`Any ${o.value.area} lead at the selected ${o.value.areas} can update the location`}[q]||"":{SpecificPeople:`Select "Everyone at the event" or choose specific ${o.value.people} who must complete this (personal completion)`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} must complete this (personal completion)`,OnePerCheckpoint:`One completion needed at each selected ${o.value.checkpoint} (shared completion)`,OnePerArea:`One completion needed in each selected ${o.value.area} (shared completion)`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} must complete this (personal completion)`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} must complete this individually (personal completion)`,OneLeadPerArea:`One completion per ${o.value.area}, only ${o.value.area} leads can complete (shared among leads)`}[q]||"",_e=q=>l.value[q]?.enabled||!1,re=q=>{const fe=l.value[q];if(!fe||!fe.enabled)return"No";const Le=fe.ids||[];if($(q)){if(Le.includes("ALL_AREAS"))return`All ${o.value.areas}`;const F=Le.length;return F>0?`${F} ${F!==1?o.value.areas:o.value.area}`:`Select ${o.value.areas}...`}if(k(q)){if(Le.includes("ALL_CHECKPOINTS"))return`All ${o.value.checkpoints}`;if(Le.length===1&&Le[0]==="THIS_CHECKPOINT")return`This ${o.value.checkpoint}`;const F=Le.length;return F>0?`${F} ${F!==1?o.value.checkpoints:o.value.checkpoint}`:`Select ${o.value.checkpoints}...`}if(w(q)){if(Le.includes("ALL_MARSHALS"))return"Everyone";const F=Le.length;return F>0?`${F} ${F!==1?o.value.people:o.value.person}`:`Select ${o.value.people}...`}return"Configured"},ve=q=>{u.value=q,h.value="",p.value=""},Ie=()=>{u.value=null},Re=()=>{u.value&&(l.value[u.value]={enabled:!1,ids:[]}),Ie()},xe=()=>u.value&&l.value[u.value]?.ids.includes("ALL_MARSHALS"),he=()=>{if(!u.value)return;const q=l.value[u.value];xe()?(q.ids=[],q.enabled=!1):(q.ids=["ALL_MARSHALS"],q.enabled=!0)},Q=q=>u.value&&l.value[u.value]?.ids.includes(q),J=q=>{if(!u.value)return;const fe=l.value[u.value],Le=fe.ids.indexOf(q);Le>=0?(fe.ids.splice(Le,1),fe.ids.length===0&&(fe.enabled=!1)):(fe.ids.push(q),fe.enabled=!0)},ue=X(()=>{if(!p.value)return i.marshals;const q=p.value.toLowerCase();return i.marshals.filter(fe=>fe.name.toLowerCase().includes(q)||fe.email&&fe.email.toLowerCase().includes(q))}),te=()=>u.value&&l.value[u.value]?.ids.includes("ALL_AREAS"),ke=()=>{if(!u.value)return;const q=l.value[u.value];te()?(q.ids=[],q.enabled=!1):(q.ids=["ALL_AREAS"],q.enabled=!0)},Oe=q=>u.value&&l.value[u.value]?.ids.includes(q),oe=q=>{if(!u.value)return;const fe=l.value[u.value],Le=fe.ids.indexOf(q);Le>=0?(fe.ids.splice(Le,1),fe.ids.length===0&&(fe.enabled=!1)):(fe.ids.push(q),fe.enabled=!0)},Ee=()=>u.value&&l.value[u.value]?.ids.includes("ALL_CHECKPOINTS"),be=()=>{if(!u.value)return;const q=l.value[u.value];Ee()?(q.ids=[],q.enabled=!1):(q.ids=["ALL_CHECKPOINTS"],q.enabled=!0)},Se=q=>u.value&&l.value[u.value]?.ids.includes(q),le=q=>{if(!u.value)return;const fe=l.value[u.value],Le=fe.ids.indexOf(q);Le>=0?(fe.ids.splice(Le,1),fe.ids.length===0&&(fe.enabled=!1)):(fe.ids.push(q),fe.enabled=!0)},pe=X(()=>{let q=i.locations;if(h.value){const fe=h.value.toLowerCase();q=q.filter(Le=>Le.name.toLowerCase().includes(fe)||Le.description&&Le.description.toLowerCase().includes(fe))}return[...q].sort((fe,Le)=>Tn(fe.name,Le.name))});return(q,fe)=>(m(),g("div",rI,[c("div",lI,[c("h4",null,b(ne.value),1)]),c("div",cI,[(m(!0),g(Ce,null,Be(I.value,Le=>(m(),g("div",{key:Le.scope,class:Te(["scope-type-row",{active:_e(Le.scope)}]),onClick:F=>ve(Le.scope)},[c("div",dI,b(Le.label),1),c("div",hI,b(re(Le.scope)),1)],10,uI))),128)),S.value?(m(),g("div",{key:0,class:"expand-row",onClick:fe[0]||(fe[0]=Le=>f.value=!f.value)},[c("div",fI,b(f.value?"Show less":`Show ${R.value} more option${R.value!==1?"s":""}...`),1),c("div",pI,b(f.value?"":""),1)])):N("",!0)]),u.value?(m(),g("div",{key:0,class:"scope-config-modal",onClick:vt(Ie,["self"])},[c("div",vI,[c("div",mI,[c("h5",null,b(A(u.value)),1),c("button",{onClick:Ie,class:"btn-close",type:"button"},"")]),c("div",gI,[c("p",yI,b(ae(u.value)),1),w(u.value)?(m(),g("div",_I,[c("label",kI,[c("input",{type:"checkbox",checked:xe(),onChange:he},null,40,bI),c("span",null,[fe[4]||(fe[4]=c("strong",null,"Everyone at the event",-1)),Ze(" (all current and future "+b(z(o).people)+")",1)])]),xe()?N("",!0):(m(),g("div",wI,[je(c("input",{"onUpdate:modelValue":fe[1]||(fe[1]=Le=>p.value=Le),type:"text",placeholder:`Search ${z(o).people}...`,class:"search-input"},null,8,CI),[[ut,p.value]]),c("div",LI,[(m(!0),g(Ce,null,Be(ue.value,Le=>(m(),g("label",{key:Le.id,class:"checkbox-label"},[c("input",{type:"checkbox",checked:Q(Le.id),onChange:F=>J(Le.id)},null,40,SI),c("span",null,b(Le.name),1)]))),128))])]))])):N("",!0),$(u.value)?(m(),g("div",xI,[c("label",TI,[c("input",{type:"checkbox",checked:te(),onChange:ke},null,40,II),c("span",null,[c("strong",null,"All "+b(z(o).areas),1),Ze(" (includes future "+b(z(o).areas)+")",1)])]),te()?N("",!0):(m(),g("div",$I,[c("div",MI,[(m(!0),g(Ce,null,Be(e.areas,Le=>(m(),g("label",{key:Le.id,class:"checkbox-label"},[c("input",{type:"checkbox",checked:Oe(Le.id),onChange:F=>oe(Le.id)},null,40,AI),c("span",{class:"area-color-dot",style:at({backgroundColor:Le.color||"#667eea"})},null,4),c("span",null,b(Le.name),1)]))),128))])]))])):N("",!0),k(u.value)?(m(),g("div",EI,[c("label",PI,[c("input",{type:"checkbox",checked:Ee(),onChange:be},null,40,DI),c("span",null,[c("strong",null,"All "+b(z(o).checkpoints),1),Ze(" (includes future "+b(z(o).checkpoints)+")",1)])]),Ee()?N("",!0):(m(),g("div",OI,[je(c("input",{"onUpdate:modelValue":fe[2]||(fe[2]=Le=>h.value=Le),type:"text",placeholder:`Search ${z(o).checkpoints}...`,class:"search-input"},null,8,RI),[[ut,h.value]]),c("div",BI,[E.value?(m(),g("label",NI,[c("input",{type:"checkbox",checked:Se("THIS_CHECKPOINT"),onChange:fe[3]||(fe[3]=Le=>le("THIS_CHECKPOINT"))},null,40,FI),c("div",UI,[c("span",zI,[c("strong",null,"This "+b(z(o).checkpoint),1)])])])):N("",!0),(m(!0),g(Ce,null,Be(pe.value,Le=>(m(),g("label",{key:Le.id,class:"checkbox-label"},[c("input",{type:"checkbox",checked:Se(Le.id),onChange:F=>le(Le.id)},null,40,HI),c("div",VI,[c("span",GI,b(Le.name),1),Le.description?(m(),g("span",ZI," - "+b(Le.description),1)):N("",!0)])]))),128))])]))])):N("",!0)]),c("div",{class:"modal-footer"},[c("button",{onClick:Re,class:"btn btn-secondary",type:"button"},"Deselect all"),c("button",{onClick:Ie,class:"btn btn-primary",type:"button"},"Done")])])])):N("",!0)]))}},kl=Je(jI,[["__scopeId","data-v-97d31f0e"]]),WI={class:"tab-content"},qI={class:"form-group"},KI=["value"],YI={key:0,class:"form-error"},JI={class:"form-row"},XI={class:"form-group"},QI=["value","disabled"],e$={class:"form-group"},t$=["value","disabled"],n$={class:"form-group"},o$={class:"accordion-item"},s$={class:"accordion-preview"},i$={class:"accordion-arrow"},a$={key:0,class:"accordion-content"},r$={class:"section-description"},l$={class:"dynamic-checkbox"},c$=["checked"],u$={key:0,class:"dynamic-settings"},d$={__name:"LocationCoordinatesTab",props:{form:{type:Object,required:!0},isMoving:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:"Checkpoint"},peopleTermPlural:{type:String,default:"Marshals"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:form","input","save","move-location"],setup(e,{emit:t}){const o=e,i=t,s=D(!1),a=y=>y==null||y===""?"":Number(y).toFixed(6),l=(y,x)=>{i("update:form",{...o.form,[y]:x}),i("input")},u=(y,x)=>{i("update:form",{...o.form,[y]:Number(x)}),i("input")},h=y=>{if(y){const x=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],T=o.form.locationUpdateScopeConfigurations||[],I=T.length>0?T:x;i("update:form",{...o.form,isDynamic:!0,latitude:0,longitude:0,locationUpdateScopeConfigurations:I})}else i("update:form",{...o.form,isDynamic:!1});i("input")},p=y=>{i("update:form",{...o.form,locationUpdateScopeConfigurations:y}),i("input")},f=y=>{if(!y)return!0;const x=y.includes(".")?y.split("."):y.split("/");if(x.length!==3)return!1;const T=/^[a-z]{1,20}$/;return x.every(I=>T.test(I))};return(y,x)=>(m(),g("div",WI,[c("form",{onSubmit:x[4]||(x[4]=vt(T=>y.$emit("save"),["prevent"]))},[c("div",qI,[x[8]||(x[8]=c("label",null,"What3Words (optional)",-1)),c("input",{value:e.form.what3Words,onInput:x[0]||(x[0]=T=>l("what3Words",T.target.value)),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap"},null,40,KI),e.form.what3Words&&!f(e.form.what3Words)?(m(),g("small",YI," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):N("",!0)]),e.form.isDynamic?N("",!0):(m(),g(Ce,{key:0},[c("div",JI,[c("div",XI,[x[9]||(x[9]=c("label",null,"Longitude",-1)),c("input",{value:a(e.form.longitude),onInput:x[1]||(x[1]=T=>u("longitude",T.target.value)),type:"number",step:"0.000001",required:"",class:"form-input",disabled:e.isMoving,placeholder:"e.g., -0.091234"},null,40,QI)]),c("div",e$,[x[10]||(x[10]=c("label",null,"Latitude",-1)),c("input",{value:a(e.form.latitude),onInput:x[2]||(x[2]=T=>u("latitude",T.target.value)),type:"number",step:"0.000001",required:"",class:"form-input",disabled:e.isMoving,placeholder:"e.g., 51.505123"},null,40,t$)])]),c("div",n$,[c("button",{type:"button",onClick:x[3]||(x[3]=T=>y.$emit("move-location")),class:Te(["btn btn-secondary btn-with-icon",{"btn-primary":e.isMoving}])},[x[11]||(x[11]=c("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),Ze(" "+b(e.isMoving?"Click on map to set new location...":`Move ${e.checkpointTermSingular.toLowerCase()}...`),1)],2)])],64))],32),c("div",o$,[c("button",{type:"button",class:Te(["accordion-header",{expanded:s.value}]),onClick:x[5]||(x[5]=T=>s.value=!s.value)},[x[12]||(x[12]=Ef('<div class="accordion-icon" data-v-8b8b9436><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-8b8b9436><path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="#F59E0B" opacity="0.3" data-v-8b8b9436></path><path d="M12 6L13.5 9L17 9.5L14.5 12L15 15.5L12 14L9 15.5L9.5 12L7 9.5L10.5 9L12 6Z" fill="#F59E0B" data-v-8b8b9436></path><circle cx="12" cy="11" r="2" fill="white" data-v-8b8b9436></circle></svg></div><span class="accordion-title" data-v-8b8b9436>Dynamic location</span>',2)),c("span",s$,b(e.form.isDynamic?"Enabled":"Disabled"),1),c("span",i$,b(s.value?"":""),1)],2),s.value?(m(),g("div",a$,[c("p",r$," Enable this for lead cars, sweep vehicles, or other moving "+b(e.checkpointTermSingular.toLowerCase())+"s whose location can be updated by designated "+b(e.peopleTermPlural.toLowerCase())+" during the event. ",1),c("label",l$,[c("input",{type:"checkbox",checked:e.form.isDynamic,onChange:x[6]||(x[6]=T=>h(T.target.checked))},null,40,c$),c("span",null,"This "+b(e.checkpointTermSingular.toLowerCase())+" can move",1)]),e.form.isDynamic?(m(),g("div",u$,[ze(kl,{"model-value":e.form.locationUpdateScopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":e.isEditing,"header-text":`Who can update this ${e.checkpointTermSingular.toLowerCase()}'s location?`,"exclude-scopes":["OnePerCheckpoint","OneLeadPerArea","OnePerArea"],intent:"location-update","current-checkpoint-id":e.form.id,"onUpdate:modelValue":p,onUserChanged:x[7]||(x[7]=T=>y.$emit("input"))},null,8,["model-value","areas","locations","marshals","is-editing","header-text","current-checkpoint-id"])])):N("",!0)])):N("",!0)])]))}},h$=Je(d$,[["__scopeId","data-v-8b8b9436"]]);function Fp(e){const t=D(new Map),o=f=>t.value.has(f.id)?t.value.get(f.id):f.isCheckedIn;return{pendingCheckInChanges:t,getEffectiveCheckInStatus:o,handleToggleCheckIn:f=>{const x=!o(f);x===f.isCheckedIn?t.value.delete(f.id):t.value.set(f.id,x),e&&e()},getStatusIcon:f=>o(f)?"":"",getStatusColor:f=>o(f)?"#28a745":"#dc3545",getStatusText:f=>o(f)?"Checked in":"Not checked in",formatTime:f=>f?new Date(f).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",clearPendingChanges:()=>{t.value.clear()},getPendingChanges:()=>Array.from(t.value.entries()).map(([f,y])=>({assignmentId:f,shouldBeCheckedIn:y}))}}const f$={class:"tab-content"},p$={class:"form-group"},v$=["value"],m$={class:"section-title"},g$={class:"assignments-list"},y$={class:"assignment-info"},_$={class:"assignment-header"},k$=["title"],b$={key:1,class:"status-indicator pending-indicator",title:"Will be assigned on save"},w$={key:2,class:"pending-badge"},C$={key:3,class:"pending-badge"},L$={key:0,class:"check-in-info"},S$={class:"check-in-method"},x$={class:"assignment-actions"},T$=["onClick"],I$=["onClick"],$$={class:"assign-section"},M$={__name:"LocationAssignmentsTab",props:{form:{type:Object,required:!0},assignments:{type:Array,default:()=>[]},peopleTerm:{type:String,default:"Marshals"},personTerm:{type:String,default:"Marshal"}},emits:["update:form","input","remove-assignment","open-assign-modal"],setup(e,{expose:t,emit:o}){const i=e,s=X(()=>i.peopleTerm.toLowerCase()),a=X(()=>i.personTerm.toLowerCase()),l=o,{pendingCheckInChanges:u,getEffectiveCheckInStatus:h,handleToggleCheckIn:p,getStatusIcon:f,getStatusColor:y,getStatusText:x,formatTime:T}=Fp(()=>l("input")),I=X(()=>i.assignments?.length||0),S=X(()=>i.assignments?[...i.assignments].sort((E,M)=>{const _=E.marshalName?.toLowerCase()||"",$=M.marshalName?.toLowerCase()||"";return _.localeCompare($)}):[]),R=(E,M)=>{l("update:form",{...i.form,[E]:Number(M)}),l("input")};return t({pendingCheckInChanges:u,clearPendingChanges:()=>{u.value.clear()},getPendingChanges:()=>Array.from(u.value.entries()).map(([E,M])=>({assignmentId:E,shouldBeCheckedIn:M}))}),(E,M)=>(m(),g("div",f$,[c("div",p$,[c("label",null,"Required "+b(s.value),1),c("input",{value:e.form.requiredMarshals,onInput:M[0]||(M[0]=_=>R("requiredMarshals",_.target.value)),type:"number",min:"1",required:"",class:"form-input"},null,40,v$)]),c("h3",m$,"Assigned "+b(s.value)+" ("+b(I.value)+")",1),c("div",g$,[(m(!0),g(Ce,null,Be(S.value,_=>(m(),g("div",{key:_.id,class:Te(["assignment-item",{"checked-in":!_.isPending&&z(h)(_),"is-pending":_.isPending}])},[c("div",y$,[c("div",_$,[_.isPending?(m(),g("span",b$,"  ")):(m(),g("span",{key:0,class:"status-indicator",style:at({color:z(y)(_)}),title:z(x)(_)},b(z(f)(_)),13,k$)),c("strong",null,b(_.marshalName),1),_.isPending?(m(),g("span",w$," (will be assigned on save) ")):z(u).has(_.id)?(m(),g("span",C$," (unsaved) ")):N("",!0)]),!_.isPending&&z(h)(_)?(m(),g("span",L$,[_.isCheckedIn&&!z(u).has(_.id)?(m(),g(Ce,{key:0},[Ze(b(z(T)(_.checkInTime))+" ",1),c("span",S$,"("+b(_.checkInMethod)+")",1)],64)):(m(),g(Ce,{key:1},[Ze(" Will be checked in on save ")],64))])):N("",!0)]),c("div",x$,[_.isPending?N("",!0):(m(),g("button",{key:0,onClick:$=>z(p)(_),class:Te(["btn btn-small",z(h)(_)?"btn-danger":"btn-secondary"])},b(z(h)(_)?"Undo":"Check in"),11,T$)),c("button",{onClick:$=>E.$emit("remove-assignment",_),class:"btn btn-small btn-danger"}," Remove ",8,I$)])],2))),128)),c("div",$$,[c("button",{type:"button",class:"btn btn-primary assign-btn",onClick:M[1]||(M[1]=_=>E.$emit("open-assign-modal"))}," + Assign "+b(a.value)+"... ",1)])])]))}},A$=Je(M$,[["__scopeId","data-v-233b845e"]]),E$={class:"checkpoint-checklist-view"},P$={key:0,class:"loading-state"},D$={key:1,class:"error-state"},O$={key:2,class:"empty-state"},R$={key:3,class:"empty-state"},B$={key:4,class:"checklist-items"},N$={class:"item-checkbox"},F$=["checked","disabled","onChange"],U$={class:"item-content"},z$={class:"item-header"},H$={class:"item-text-wrapper"},V$={class:"item-text"},G$={key:0,class:"item-context"},Z$={class:"item-scope"},j$=["title"],W$={key:0,class:"completion-info"},q$={key:0,class:"pending-text"},K$={class:"completion-text"},Y$={class:"completion-time"},J$={key:1,class:"uncomplete-info"},X$={key:2,class:"disabled-reason"},Q$={__name:"CheckpointChecklistView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=Ct(),a=e,l=o,u=D([]),h=D(!1),p=D(null),f=D(new Map),y=X(()=>a.assignments.length===0),x=X(()=>u.value.map(k=>{const w=f.value.get(`${k.itemId}|||${k.completionContextId}`),A=w!==void 0?w.complete:k.isCompleted,ne=w!==void 0&&w.complete!==k.isCompleted;return{...k,localIsCompleted:A,isModified:ne}})),T=async()=>{if(!(!a.eventId||!a.locationId&&!a.areaId)){h.value=!0,p.value=null;try{const k=a.locationId?await Et.getCheckpointChecklist(a.eventId,a.locationId):await Et.getAreaChecklist(a.eventId,a.areaId);if(u.value=k.data||[],a.modelValue&&a.modelValue.length>0){const w=new Map;a.modelValue.forEach(A=>{w.set(`${A.itemId}|||${A.contextId}`,{complete:A.complete,contextType:A.contextType,contextId:A.contextId})}),f.value=w}}catch(k){console.error("Failed to load checklist:",k),p.value=k.response?.data?.message||"Failed to load checklist"}finally{h.value=!1}}},I=k=>{const w=k.contextOwnerMarshalId||(a.assignments.length>0?a.assignments[0].marshalId:null);if(!w)return;const A=`${k.itemId}|||${k.completionContextId}`,ne=f.value.get(A),ae=ne!==void 0?ne.complete:k.isCompleted;f.value.set(A,{complete:!ae,contextType:k.completionContextType,contextId:k.completionContextId,marshalId:w}),S()},S=()=>{const k=[];for(const[w,A]of f.value.entries()){const[ne,ae]=w.split("|||"),_e=u.value.find(re=>re.itemId===ne&&re.completionContextId===ae);_e&&A.complete!==_e.isCompleted&&k.push({itemId:ne,complete:A.complete,contextType:A.contextType,contextId:A.contextId,marshalId:A.marshalId})}l("update:modelValue",k),l("change",k)};t({resetLocalState:()=>{if(f.value=new Map,a.modelValue&&a.modelValue.length>0){const k=new Map;a.modelValue.forEach(w=>{k.set(`${w.itemId}|||${w.contextId}`,{complete:w.complete,contextType:w.contextType,contextId:w.contextId,marshalId:w.marshalId})}),f.value=k}},loadChecklist:T});const E=k=>({Everyone:"Everyone",SpecificPeople:"Assigned to you",EveryoneInAreas:`Your ${s.value.areas}`,EveryoneAtCheckpoints:`Your ${s.value.checkpoints}`,OnePerCheckpoint:`One per ${s.value.checkpoint}`,OnePerArea:`One per ${s.value.area}`,EveryAreaLead:`${i.value.area} lead`,OneLeadPerArea:`One lead per ${s.value.area}`})[k.matchedScope]||k.matchedScope,M=k=>({Everyone:"This item is for everyone at the event",SpecificPeople:"This item is specifically assigned to certain people",EveryoneInAreas:`This item is for everyone in certain ${s.value.areas}`,EveryoneAtCheckpoints:`This item is for everyone at certain ${s.value.checkpoints}`,OnePerCheckpoint:`One person at the ${s.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${s.value.area} needs to complete this`,EveryAreaLead:`This item is for ${s.value.area} leads only`,OneLeadPerArea:`One ${s.value.area} lead needs to complete this`})[k.matchedScope]||"",_=k=>{if(!k.completionContextType||!k.completionContextId)return null;if(k.completionContextType==="Checkpoint"){const w=a.locations.find(ne=>ne.id===k.completionContextId);if(!w)return null;const A=w.description?`${w.name} - ${w.description}`:w.name;return`at ${s.value.checkpoint} ${A}`}if(k.completionContextType==="Area"){const w=a.areas.find(A=>A.id===k.completionContextId);return w?`in ${s.value.area} ${w.name}`:null}return k.completionContextType==="Personal"?k.contextOwnerName?`for ${k.contextOwnerName}`:"assigned individually":null},$=k=>k?new Date(k).toLocaleString():"";return We(()=>[a.eventId,a.locationId,a.areaId],()=>{T()},{immediate:!0}),(k,w)=>(m(),g("div",E$,[h.value?(m(),g("div",P$," Loading checklist... ")):p.value?(m(),g("div",D$,[c("p",null,b(p.value),1),c("button",{onClick:T,class:"btn btn-secondary btn-small"}," Retry ")])):y.value?(m(),g("div",O$,[...w[0]||(w[0]=[c("p",null,"No marshals assigned to this checkpoint yet.",-1),c("p",{class:"help-text"},"Assign marshals to enable checklist completion.",-1)])])):u.value.length===0?(m(),g("div",R$,[...w[1]||(w[1]=[c("p",null,"No checklist items for this checkpoint.",-1)])])):(m(),g("div",B$,[(m(!0),g(Ce,null,Be(x.value,A=>(m(),g("div",{key:`${A.itemId}-${A.completionContextId}`,class:Te(["checklist-item",{"item-completed":A.localIsCompleted,"item-modified":A.isModified}])},[c("div",N$,[c("input",{type:"checkbox",checked:A.localIsCompleted,disabled:!A.canBeCompletedByMe&&!A.localIsCompleted,onChange:ne=>I(A)},null,40,F$)]),c("div",U$,[c("div",z$,[c("div",H$,[c("div",V$,b(A.text),1),_(A)?(m(),g("div",G$,b(_(A)),1)):N("",!0)]),c("div",Z$,[c("span",{class:"scope-pill",title:M(A)},b(E(A)),9,j$)])]),A.localIsCompleted?(m(),g("div",W$,[A.isModified&&!A.isCompleted?(m(),g("span",q$," Will be marked as completed (pending save) ")):(m(),g(Ce,{key:1},[c("span",K$," Completed by "+b(A.completedByActorName||"Unknown"),1),c("span",Y$,b($(A.completedAt)),1)],64))])):N("",!0),A.isModified&&A.isCompleted&&!A.localIsCompleted?(m(),g("div",J$,[...w[2]||(w[2]=[c("span",{class:"pending-text"},"Will be marked as incomplete (pending save)",-1)])])):N("",!0),!A.canBeCompletedByMe&&!A.localIsCompleted?(m(),g("div",X$," Already completed by someone else ")):N("",!0)])],2))),128))]))]))}},Up=Je(Q$,[["__scopeId","data-v-9dc97489"]]),eM={class:"notes-view"},tM={key:0,class:"loading-state"},nM={key:1,class:"error-state"},oM={key:2,class:"empty-state"},sM={key:3,class:"notes-list"},iM={class:"note-header"},aM={class:"note-title-row"},rM={key:0,class:"pin-icon",title:"Pinned"},lM={class:"note-title"},cM={class:"note-meta"},uM={key:0,class:"category-badge"},dM={key:0,class:"note-content"},hM={class:"note-footer"},fM={class:"created-info"},pM={key:0,class:"scope-info"},vM={__name:"NotesView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},marshalId:{type:String,default:null},allNotes:{type:Array,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},showScope:{type:Boolean,default:!0}},setup(e,{expose:t}){const o=e,i=D([]),s=D(!1),a=D(null),l=X(()=>o.marshalId?"No notes for this marshal.":o.areaId?"No notes for this area.":o.locationId?"No notes for this checkpoint.":"No notes available."),u=X(()=>o.areaId?o.locations.filter(E=>E.areaIds&&E.areaIds.includes(o.areaId)):[]),h=X(()=>u.value.map(E=>E.id)),p=X(()=>{if(!o.areaId)return[];const E=new Set;return o.assignments.filter(M=>h.value.includes(M.locationId)).forEach(M=>E.add(M.marshalId)),Array.from(E)}),f=E=>o.assignments.filter(M=>M.marshalId===E).map(M=>M.locationId),y=E=>{const M=f(E),_=new Set;for(const $ of M){const k=o.locations.find(w=>w.id===$);k?.areaIds&&k.areaIds.forEach(w=>_.add(w))}return Array.from(_)},x=(E,M)=>{if(!E.scopeConfigurations)return null;for(const _ of E.scopeConfigurations){if(_.itemType==="Area"){if(M.type==="area"&&(_.ids.includes(M.areaId)||_.ids.includes("ALL_AREAS")))return{matched:!0,scope:_.scope==="EveryAreaLead"?"Area leads":"Area"};if(M.type==="checkpoint"){const k=o.locations.find(w=>w.id===M.locationId)?.areaIds||[];if(_.ids.includes("ALL_AREAS")||k.some(w=>_.ids.includes(w)))return{matched:!0,scope:_.scope==="EveryAreaLead"?"Area leads":"Area"}}}if(_.itemType==="Checkpoint"){if(M.type==="checkpoint"&&(_.ids.includes(M.locationId)||_.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint"};if(M.type==="area"&&M.checkpointIds.some(k=>_.ids.includes(k)||_.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint in area"}}if(_.itemType==="Marshal"){if(M.type==="marshal"&&(_.ids.includes(M.marshalId)||_.ids.includes("ALL_MARSHALS")))return{matched:!0,scope:"Marshal"};if(M.type==="checkpoint"){const $=o.assignments.filter(w=>w.locationId===M.locationId).map(w=>w.marshalId);if(_.ids.includes("ALL_MARSHALS")||$.some(w=>_.ids.includes(w)))return{matched:!0,scope:"Marshal at checkpoint"}}if(M.type==="area"&&(_.ids.includes("ALL_MARSHALS")||M.marshalIds.some(k=>_.ids.includes(k))))return{matched:!0,scope:"Marshal in area"}}if(M.type==="marshal"&&M.checkpointIds&&M.areaIds){if(_.itemType==="Checkpoint"&&(_.ids.includes("ALL_CHECKPOINTS")||M.checkpointIds.some(k=>_.ids.includes(k))))return{matched:!0,scope:"Assigned checkpoint"};if(_.itemType==="Area"&&(_.ids.includes("ALL_AREAS")||M.areaIds.some(k=>_.ids.includes(k))))return{matched:!0,scope:_.scope==="EveryAreaLead"?"Area lead":"Area"}}}return null},T=X(()=>{const E=o.allNotes||i.value;if(!E||E.length===0)return[];if(o.areaId&&o.allNotes){const M={type:"area",areaId:o.areaId,checkpointIds:h.value,marshalIds:p.value},_=[],$=new Set;for(const k of E){if($.has(k.noteId))continue;const w=x(k,M);w&&($.add(k.noteId),_.push({...k,matchedScope:w.scope}))}return _}if(o.locationId&&o.allNotes){const M={type:"checkpoint",locationId:o.locationId},_=[],$=new Set;for(const k of E){if($.has(k.noteId))continue;const w=x(k,M);w&&($.add(k.noteId),_.push({...k,matchedScope:w.scope}))}return _}if(o.marshalId&&o.allNotes){const M=f(o.marshalId),_=y(o.marshalId),$={type:"marshal",marshalId:o.marshalId,checkpointIds:M,areaIds:_},k=[],w=new Set;for(const A of E){if(w.has(A.noteId))continue;const ne=x(A,$);ne&&(w.add(A.noteId),k.push({...A,matchedScope:ne.scope}))}return k}return E}),I=X(()=>{const E={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return[...T.value].sort((M,_)=>{if(M.isPinned!==_.isPinned)return M.isPinned?-1:1;const $=E[M.priority]??2,k=E[_.priority]??2;return $!==k?$-k:M.displayOrder!==_.displayOrder?M.displayOrder-_.displayOrder:new Date(_.createdAt)-new Date(M.createdAt)})}),S=async()=>{if(o.allNotes===null&&o.eventId){s.value=!0,a.value=null;try{let E;o.marshalId?E=await Go.getMarshalNotes(o.eventId,o.marshalId):E=await Go.getByEvent(o.eventId),i.value=E.data||[]}catch(E){console.error("Failed to load notes:",E),a.value=E.response?.data?.message||"Failed to load notes"}finally{s.value=!1}}};We(()=>[o.eventId,o.locationId,o.areaId,o.marshalId],()=>{o.allNotes===null&&S()},{immediate:!0});const R=E=>{if(!E)return"";const M=new Date(E),$=new Date-M,k=Math.floor($/6e4),w=Math.floor($/36e5),A=Math.floor($/864e5);return k<1?"just now":k<60?`${k}m ago`:w<24?`${w}h ago`:A<7?`${A}d ago`:M.toLocaleDateString()};return t({loadNotes:S}),(E,M)=>(m(),g("div",eM,[s.value?(m(),g("div",tM," Loading notes... ")):a.value?(m(),g("div",nM,[c("p",null,b(a.value),1),c("button",{onClick:S,class:"btn btn-secondary btn-small"}," Retry ")])):T.value.length===0?(m(),g("div",oM,[c("p",null,b(l.value),1)])):(m(),g("div",sM,[(m(!0),g(Ce,null,Be(I.value,_=>(m(),g("div",{key:_.noteId,class:Te(["note-item",{pinned:_.isPinned}])},[c("div",iM,[c("div",aM,[_.isPinned?(m(),g("span",rM,"")):N("",!0),c("span",{class:Te(["priority-indicator",(_.priority||"Normal").toLowerCase()])},null,2),c("strong",lM,b(_.title),1)]),c("div",cM,[_.category?(m(),g("span",uM,b(_.category),1)):N("",!0),c("span",{class:Te(["priority-badge",(_.priority||"Normal").toLowerCase()])},b(_.priority||"Normal"),3)])]),_.content?(m(),g("div",dM,b(_.content),1)):N("",!0),c("div",hM,[c("span",fM," Created by "+b(_.createdByName||"Unknown")+"  "+b(R(_.createdAt)),1),_.matchedScope&&e.showScope?(m(),g("span",pM,b(_.matchedScope),1)):N("",!0)])],2))),128))]))]))}},bl=Je(vM,[["__scopeId","data-v-6dd44fa8"]]),mM={class:"checklist-preview"},gM={class:"preview-actions"},yM={class:"preview-header"},_M={key:0,class:"add-item-form"},kM=["placeholder"],bM=["disabled"],wM={key:1,class:"pending-items"},CM={class:"item-content"},LM={class:"item-header"},SM={class:"item-text"},xM={class:"item-scope"},TM=["onClick"],IM={key:2,class:"empty-state"},$M={key:0,class:"help-text"},MM={key:3,class:"checklist-items"},AM={class:"item-content"},EM={class:"item-header"},PM={class:"item-text"},DM={class:"item-scope"},OM=["title"],RM={key:0,class:"item-context"},BM={__name:"ChecklistPreviewForLocation",props:{allChecklistItems:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=e,a=X(()=>s.checkpointTermSingular?s.checkpointTermSingular.toLowerCase():i.value.checkpoint),l=t,u=D(!1),h=D(""),p=D([...s.modelValue]);We(()=>s.modelValue,_=>{p.value=[..._]},{deep:!0});const f=()=>{h.value.trim()&&(p.value.push({text:h.value.trim(),isNew:!0}),h.value="",u.value=!1,x())},y=_=>{p.value.splice(_,1),x()},x=()=>{l("update:modelValue",[...p.value]),l("change")},T=_=>{const $=_.scope,k=_.itemType,w=_.ids||[];return($==="EveryoneAtCheckpoints"||$==="OnePerCheckpoint")&&k==="Checkpoint"?w.includes("ALL_CHECKPOINTS"):$==="OnePerCheckpoint"&&k==="Area"?w.includes("ALL_AREAS")?!0:w.some(A=>s.pendingAreaIds.includes(A)):($==="EveryoneInAreas"||$==="OnePerArea"||$==="EveryAreaLead"||$==="OneLeadPerArea")&&k==="Area"?w.includes("ALL_AREAS")?!0:w.some(A=>s.pendingAreaIds.includes(A)):!1},I=X(()=>s.allChecklistItems.filter(_=>_.scopeConfigurations&&_.scopeConfigurations.length>0?_.scopeConfigurations.some($=>T($)):!1)),S=_=>({EveryoneAtCheckpoints:`All at ${i.value.checkpoints}`,OnePerCheckpoint:`One per ${i.value.checkpoint}`,EveryoneInAreas:`All in ${i.value.areas}`,OnePerArea:`One per ${i.value.area}`,EveryAreaLead:`${i.value.area} leads`,OneLeadPerArea:`One lead per ${i.value.area}`})[_]||_,R=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"Unknown";const $=_.scopeConfigurations.find(w=>T(w));if(!$)return S(_.scopeConfigurations[0].scope);const k=$.ids||[];return k.includes("ALL_CHECKPOINTS")?`All ${i.value.checkpoints}`:k.includes("ALL_AREAS")?`All ${i.value.areas}`:S($.scope)},E=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"";const $=_.scopeConfigurations.find(w=>T(w));return $&&{EveryoneAtCheckpoints:`This item is for everyone at specified ${i.value.checkpoints}`,OnePerCheckpoint:`One person at each ${i.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${i.value.areas}`,OnePerArea:`One person in each ${i.value.area} needs to complete this`,EveryAreaLead:`This item is for ${i.value.area} leads only`,OneLeadPerArea:`One ${i.value.area} lead needs to complete this`}[$.scope]||""},M=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return null;const $=_.scopeConfigurations.find(A=>T(A));if(!$)return null;const k=$.itemType,w=$.ids||[];if(w.includes("ALL_CHECKPOINTS")||w.includes("ALL_AREAS"))return null;if(k==="Area"){const A=s.areas.filter(ne=>w.includes(ne.id)&&s.pendingAreaIds.includes(ne.id)).map(ne=>ne.name);if(A.length>0)return`In: ${A.join(", ")}`}return null};return(_,$)=>(m(),g("div",mM,[c("div",gM,[c("p",yM,b(e.isEditing?`Add new ${z(i).checklist} for this ${a.value}:`:`${z(o).checklists} that will apply at this ${a.value}:`),1),c("button",{type:"button",class:"add-item-btn",onClick:$[0]||($[0]=k=>u.value=!u.value)},b(u.value?"Cancel":`+ Add ${z(i).checklist}`),1)]),u.value?(m(),g("div",_M,[je(c("input",{"onUpdate:modelValue":$[1]||($[1]=k=>h.value=k),type:"text",placeholder:`Enter ${z(i).checklist} text...`,class:"add-item-input",onKeyup:Uf(f,["enter"])},null,40,kM),[[ut,h.value]]),c("button",{type:"button",class:"save-item-btn",disabled:!h.value.trim(),onClick:f}," Add ",8,bM)])):N("",!0),p.value.length>0?(m(),g("div",wM,[(m(!0),g(Ce,null,Be(p.value,(k,w)=>(m(),g("div",{key:`pending-${w}`,class:"checklist-item pending"},[$[3]||($[3]=c("div",{class:"item-checkbox"},[c("input",{type:"checkbox",checked:!1,disabled:""})],-1)),c("div",CM,[c("div",LM,[c("div",SM,b(k.text),1),c("div",xM,[$[2]||($[2]=c("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),c("button",{type:"button",class:"remove-item-btn",onClick:A=>y(w),title:"Remove"},"  ",8,TM)])])])]))),128))])):N("",!0),!e.isEditing&&I.value.length===0&&p.value.length===0?(m(),g("div",IM,[c("p",null,"No "+b(z(i).checklists)+" will apply based on the current "+b(z(i).area)+" assignments.",1),e.pendingAreaIds.length===0?(m(),g("p",$M," Assign "+b(z(i).areas)+" to see relevant "+b(z(i).checklists)+". ",1)):N("",!0)])):N("",!0),!e.isEditing&&I.value.length>0?(m(),g("div",MM,[(m(!0),g(Ce,null,Be(I.value,k=>(m(),g("div",{key:k.id,class:"checklist-item"},[$[4]||($[4]=c("div",{class:"item-checkbox"},[c("input",{type:"checkbox",checked:!1,disabled:""})],-1)),c("div",AM,[c("div",EM,[c("div",PM,b(k.text),1),c("div",DM,[c("span",{class:"scope-pill",title:E(k)},b(R(k)),9,OM)])]),M(k)?(m(),g("div",RM,b(M(k)),1)):N("",!0)])]))),128))])):N("",!0)]))}},NM=Je(BM,[["__scopeId","data-v-c2119cba"]]),FM={class:"notes-preview"},UM={class:"preview-actions"},zM={class:"preview-header"},HM={key:0,class:"add-item-form"},VM={class:"add-form-fields"},GM=["disabled"],ZM={key:1,class:"pending-items"},jM={class:"note-header"},WM={class:"note-title"},qM={class:"note-actions"},KM=["onClick"],YM={key:0,class:"note-content"},JM={key:2,class:"empty-state"},XM={key:0,class:"help-text"},QM={key:3,class:"notes-list"},eA={class:"note-header"},tA={class:"note-title"},nA=["title"],oA={key:0,class:"note-content"},sA={key:1,class:"note-context"},iA={__name:"NotesPreviewForLocation",props:{allNotes:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=Ct(),i=e,s=t,a=X(()=>i.checkpointTermSingular?i.checkpointTermSingular.toLowerCase():o.value.checkpoint),l=D(!1),u=D(""),h=D(""),p=D([...i.modelValue]);We(()=>i.modelValue,_=>{p.value=[..._]},{deep:!0});const f=()=>{!u.value.trim()&&!h.value.trim()||(p.value.push({title:u.value.trim(),content:h.value.trim(),isNew:!0}),u.value="",h.value="",l.value=!1,x())},y=_=>{p.value.splice(_,1),x()},x=()=>{s("update:modelValue",[...p.value]),s("change")},T=_=>{const $=_.scope,k=_.itemType,w=_.ids||[];return $==="EveryoneAtCheckpoints"&&k==="Checkpoint"?w.includes("ALL_CHECKPOINTS"):$==="EveryoneInAreas"&&k==="Area"?w.includes("ALL_AREAS")?!0:w.some(A=>i.pendingAreaIds.includes(A)):!1},I=X(()=>i.allNotes.filter(_=>_.scopeConfigurations&&_.scopeConfigurations.length>0?_.scopeConfigurations.some($=>T($)):!1)),S=_=>({EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[_]||_,R=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"Unknown";const $=_.scopeConfigurations.find(w=>T(w));if(!$)return S(_.scopeConfigurations[0].scope);const k=$.ids||[];return k.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:k.includes("ALL_AREAS")?`All ${o.value.areas}`:S($.scope)},E=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"";const $=_.scopeConfigurations.find(w=>T(w));return $&&{EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[$.scope]||""},M=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return null;const $=_.scopeConfigurations.find(A=>T(A));if(!$)return null;const k=$.itemType,w=$.ids||[];if(w.includes("ALL_CHECKPOINTS")||w.includes("ALL_AREAS"))return null;if(k==="Area"){const A=i.areas.filter(ne=>w.includes(ne.id)&&i.pendingAreaIds.includes(ne.id)).map(ne=>ne.name);if(A.length>0)return`In: ${A.join(", ")}`}return null};return(_,$)=>(m(),g("div",FM,[c("div",UM,[c("p",zM,b(e.isEditing?`Add new note for this ${a.value}:`:`Notes that will be visible at this ${a.value}:`),1),c("button",{type:"button",class:"add-item-btn",onClick:$[0]||($[0]=k=>l.value=!l.value)},b(l.value?"Cancel":"+ Add note"),1)]),l.value?(m(),g("div",HM,[c("div",VM,[je(c("input",{"onUpdate:modelValue":$[1]||($[1]=k=>u.value=k),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[ut,u.value]]),je(c("textarea",{"onUpdate:modelValue":$[2]||($[2]=k=>h.value=k),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[ut,h.value]])]),c("button",{type:"button",class:"save-item-btn",disabled:!u.value.trim()&&!h.value.trim(),onClick:f}," Add ",8,GM)])):N("",!0),p.value.length>0?(m(),g("div",ZM,[(m(!0),g(Ce,null,Be(p.value,(k,w)=>(m(),g("div",{key:`pending-${w}`,class:"note-item pending"},[c("div",jM,[c("span",WM,b(k.title||"Untitled"),1),c("div",qM,[$[3]||($[3]=c("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),c("button",{type:"button",class:"remove-item-btn",onClick:A=>y(w),title:"Remove"},"  ",8,KM)])]),k.content?(m(),g("div",YM,b(k.content),1)):N("",!0)]))),128))])):N("",!0),!e.isEditing&&I.value.length===0&&p.value.length===0?(m(),g("div",JM,[c("p",null,"No notes will apply based on the current "+b(z(o).area)+" assignments.",1),e.pendingAreaIds.length===0?(m(),g("p",XM," Assign "+b(z(o).areas)+" to see relevant notes. ",1)):N("",!0)])):N("",!0),!e.isEditing&&I.value.length>0?(m(),g("div",QM,[(m(!0),g(Ce,null,Be(I.value,k=>(m(),g("div",{key:k.id,class:"note-item"},[c("div",eA,[c("span",tA,b(k.title||"Untitled"),1),c("span",{class:"scope-pill",title:E(k)},b(R(k)),9,nA)]),k.content?(m(),g("div",oA,b(k.content),1)):N("",!0),M(k)?(m(),g("div",sA,b(M(k)),1)):N("",!0)]))),128))])):N("",!0)]))}},aA=Je(iA,[["__scopeId","data-v-729a6eeb"]]),rA={class:"base-modal-title modal-title-with-icon"},lA=["innerHTML"],cA={key:7,class:"tab-content appearance-tab"},uA={class:"accordion-item"},dA=["innerHTML"],hA={class:"accordion-title"},fA={class:"accordion-arrow"},pA={key:0,class:"accordion-content"},vA={class:"section-description"},mA={class:"accordion-item"},gA={class:"accordion-preview"},yA={class:"accordion-arrow"},_A={key:0,class:"accordion-content"},kA={class:"section-description"},bA={class:"terminology-row"},wA={class:"terminology-field"},CA=["value"],LA={value:""},SA=["value"],xA={class:"terminology-field"},TA=["value"],IA={value:""},$A=["value"],MA={class:"custom-footer"},AA={key:1},mh="edit_location_accordion",EA={__name:"EditLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:null},assignments:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventDate:{type:String,default:""},areas:{type:Array,default:()=>[]},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},availableMarshals:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},zIndex:{type:Number,default:1e3}},emits:["close","save","delete","move-location","toggle-check-in","remove-assignment","open-assign-modal","update:isDirty"],setup(e,{emit:t}){const{terms:o}=Ct(),i=e,s=t,a=D("details"),l=D(!1),u=D(null),h=D(null),p=D([]),f=D([]),y=D([]),x=D({id:null,name:"",description:"",what3Words:"",latitude:0,longitude:0,requiredMarshals:1,useCustomTimes:!1,startTime:"",endTime:"",areaIds:[],styleType:"default",styleColor:"",styleBackgroundShape:"",styleBackgroundColor:"",styleBorderColor:"",styleIconColor:"",styleSize:"",styleMapRotation:"",peopleTerm:"",checkpointTerm:"",isDynamic:!1,locationUpdateScopeConfigurations:[]}),T=()=>i.eventId?`${mh}_${i.eventId}`:mh,I=D({iconStyle:!1,terminology:!1});un(()=>{const j=localStorage.getItem(T());if(j)try{const O=JSON.parse(j);I.value={...I.value,...O}}catch{}});const S=j=>{I.value[j]=!I.value[j],localStorage.setItem(T(),JSON.stringify(I.value))},R=X(()=>{const j=x.value.areaIds||[];if(j.length>0){const O=i.areas.filter(B=>j.includes(B.id)&&B.peopleTerm).sort((B,K)=>(B.checkpointCount||0)-(K.checkpointCount||0));if(O.length>0)return O[0].peopleTerm}return i.eventPeopleTerm||"Marshals"}),E=X(()=>x.value.peopleTerm?x.value.peopleTerm:R.value),M=X(()=>{const j=x.value.areaIds||[];if(j.length>0){const O=i.areas.filter(B=>j.includes(B.id)&&B.checkpointTerm).sort((B,K)=>(B.checkpointCount||0)-(K.checkpointCount||0));if(O.length>0)return O[0].checkpointTerm}return o.value.checkpoint});X(()=>M.value.toLowerCase());const _=X(()=>{const j=x.value.checkpointTerm||i.location?.checkpointTerm||i.location?.CheckpointTerm;if(j)return Ks("checkpoint",j,E.value);const O=x.value.areaIds||[];let B=null;if(O.length>0){const K=i.areas.filter(ye=>O.includes(ye.id)&&ye.checkpointTerm).sort((ye,$e)=>(ye.checkpointCount||0)-($e.checkpointCount||0));K.length>0&&(B=K[0].checkpointTerm)}return B?Ks("checkpoint",B,E.value):o.value.checkpoint}),$=X(()=>_.value.toLowerCase()),k=X(()=>{const j=E.value;return Ks("people",j)});X(()=>k.value.toLowerCase());const w=X(()=>o.value.area);X(()=>w.value.toLowerCase());const A=X(()=>o.value.area),ne=X(()=>A.value.toLowerCase()),ae=X(()=>o.value.areas),_e=X(()=>!!(i.location&&i.location.id)),re=X(()=>_e.value?`Edit ${$.value}: ${i.location?.name||""}`:`Add ${$.value}`),ve=X(()=>[{value:"details",label:"Details",icon:"details"},{value:"location",label:"Location",icon:"location"},{value:"marshals",label:E.value,icon:"marshal"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}]),Ie=X(()=>ve.value.findIndex(j=>j.value===a.value)),Re=X(()=>Ie.value===ve.value.length-1),xe=X(()=>{const j=x.value.areaIds||[],O=i.areas.filter(Z=>j.includes(Z.id)).sort((Z,Ve)=>(Z.checkpointCount||0)-(Ve.checkpointCount||0)),B=(Z,Ve)=>{for(const Ye of O){const Qe=Z(Ye);if(Qe&&Qe!=="default")return{value:Qe,source:"area"}}return Ve&&Ve!=="default"?{value:Ve,source:"event"}:{value:"",source:"none"}},K=B(Z=>Z.checkpointStyleType||Z.CheckpointStyleType,i.eventDefaultStyleType),ye=B(Z=>Z.checkpointStyleColor||Z.CheckpointStyleColor,i.eventDefaultStyleColor),$e=B(Z=>Z.checkpointStyleBackgroundShape||Z.CheckpointStyleBackgroundShape,i.eventDefaultStyleBackgroundShape),we=B(Z=>Z.checkpointStyleBackgroundColor||Z.CheckpointStyleBackgroundColor||Z.checkpointStyleColor||Z.CheckpointStyleColor,i.eventDefaultStyleBackgroundColor||i.eventDefaultStyleColor),Ne=B(Z=>Z.checkpointStyleBorderColor||Z.CheckpointStyleBorderColor,i.eventDefaultStyleBorderColor),Fe=B(Z=>Z.checkpointStyleIconColor||Z.CheckpointStyleIconColor,i.eventDefaultStyleIconColor),Ue=B(Z=>Z.checkpointStyleSize||Z.CheckpointStyleSize,i.eventDefaultStyleSize),Ke=B(Z=>Z.checkpointStyleMapRotation??Z.CheckpointStyleMapRotation,i.eventDefaultStyleMapRotation),ee=[K,$e,we,Ne,Fe,Ue,Ke].some(Z=>Z.source==="area");return{type:K.value||"default",color:ye.value,backgroundShape:$e.value,backgroundColor:we.value,borderColor:Ne.value,iconColor:Fe.value,size:Ue.value,mapRotation:Ke.value,source:ee?"area":K.value?"event":"none"}}),he=X(()=>xe.value.source==="area"?`${A.value} default`:"Event default"),Q=X(()=>{const j=x.value.styleType&&x.value.styleType!=="default"&&x.value.styleType!=="custom"?x.value.styleType:xe.value.type,O=x.value.styleBackgroundShape||xe.value.backgroundShape||"circle",B=x.value.styleBackgroundColor||xe.value.backgroundColor||"#667eea",K=x.value.styleBorderColor||xe.value.borderColor||"#ffffff",ye=x.value.styleIconColor||xe.value.iconColor||"#ffffff";return Jt({type:j||"circle",backgroundShape:O,backgroundColor:B,borderColor:K,iconColor:ye,size:"100"})}),J=X(()=>{let j,O,B,K,ye;return _e.value&&i.location?(j=i.location.resolvedStyleType||i.location.ResolvedStyleType,O=i.location.resolvedStyleBackgroundShape||i.location.ResolvedStyleBackgroundShape||"circle",B=i.location.resolvedStyleBackgroundColor||i.location.ResolvedStyleBackgroundColor||i.location.resolvedStyleColor||i.location.ResolvedStyleColor||"#667eea",K=i.location.resolvedStyleBorderColor||i.location.ResolvedStyleBorderColor||"#ffffff",ye=i.location.resolvedStyleIconColor||i.location.ResolvedStyleIconColor||"#ffffff"):(j=x.value.styleType&&x.value.styleType!=="default"&&x.value.styleType!=="custom"?x.value.styleType:xe.value.type,O=x.value.styleBackgroundShape||xe.value.backgroundShape||"circle",B=x.value.styleBackgroundColor||xe.value.backgroundColor||"#667eea",K=x.value.styleBorderColor||xe.value.borderColor||"#ffffff",ye=x.value.styleIconColor||xe.value.iconColor||"#ffffff"),Jt({type:j||"circle",backgroundShape:O,backgroundColor:B,borderColor:K,iconColor:ye,size:"100",outputSize:28})}),ue=X(()=>{const j=!!x.value.checkpointTerm,O=!!x.value.peopleTerm;return j&&O?`${Ks("checkpoint",x.value.checkpointTerm,x.value.peopleTerm)}, ${x.value.peopleTerm}`:j?Ks("checkpoint",x.value.checkpointTerm,E.value):O?x.value.peopleTerm:"Using defaults"}),te=X(()=>Re.value?null:ve.value[Ie.value+1]),ke=X(()=>Re.value?`Create ${$.value}`:`Add ${te.value.label.toLowerCase()}...`),Oe=D(!1),oe=D(null);We(()=>i.location,j=>{if(j){const O=j.id||"new";if(oe.value!==O){oe.value=O,Oe.value=!0;let B="",K="";j.startTime&&(B=Oa(j.startTime)),j.endTime&&(K=Oa(j.endTime)),x.value={id:j.id||null,name:j.name||"",description:j.description||"",what3Words:j.what3Words||"",latitude:j.latitude||0,longitude:j.longitude||0,requiredMarshals:j.requiredMarshals||1,useCustomTimes:!!(j.startTime||j.endTime),startTime:B,endTime:K,areaIds:j.areaIds||j.AreaIds||[],styleType:j.styleType||j.StyleType||"default",styleColor:j.styleColor||j.StyleColor||"",styleBackgroundShape:j.styleBackgroundShape||j.StyleBackgroundShape||"",styleBackgroundColor:j.styleBackgroundColor||j.StyleBackgroundColor||"",styleBorderColor:j.styleBorderColor||j.StyleBorderColor||"",styleIconColor:j.styleIconColor||j.StyleIconColor||"",styleSize:j.styleSize||j.StyleSize||"",styleMapRotation:j.styleMapRotation??j.StyleMapRotation??"",peopleTerm:j.peopleTerm||"",checkpointTerm:j.checkpointTerm||"",isDynamic:j.isDynamic||!1,locationUpdateScopeConfigurations:j.locationUpdateScopeConfigurations||[]}}}},{immediate:!0,deep:!0}),We(()=>i.show,j=>{j?(a.value="details",l.value=!1,p.value=[],f.value=[],y.value=[],u.value?.clearPendingChanges&&u.value.clearPendingChanges(),h.value?.resetLocalState&&h.value.resetLocalState()):(oe.value=null,Oe.value=!1)});const Ee=j=>{x.value=j},be=()=>{s("update:isDirty",!0)},Se=()=>{l.value=!l.value,s("move-location",{isMoving:l.value,formData:{...x.value}})},le=j=>{p.value=j,be()},pe=()=>{_e.value||Re.value?q():a.value=te.value.value},q=()=>{const j={...x.value,startTime:x.value.useCustomTimes&&x.value.startTime?new Date(x.value.startTime).toISOString():null,endTime:x.value.useCustomTimes&&x.value.endTime?new Date(x.value.endTime).toISOString():null,checkInChanges:u.value?.getPendingChanges?.()||[],checklistChanges:p.value||[],pendingAssignments:i.assignments.filter(O=>O.isPending).map(O=>({marshalId:O.marshalId})),pendingNewChecklistItems:f.value,pendingNewNotes:y.value};s("save",j)},fe=()=>{i.location&&i.location.id&&s("delete",i.location.id)},Le=j=>{s("remove-assignment",j)},F=()=>{s("open-assign-modal")},G=()=>{s("close")},W=(j,O)=>{x.value[j]=O,be()};return(j,O)=>(m(),rt(Ut,{show:e.show,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:G},{header:nt(()=>[c("h2",rA,[J.value?(m(),g("span",{key:0,class:"modal-title-icon",innerHTML:J.value},null,8,lA)):N("",!0),Ze(" "+b(re.value),1)])]),"tab-header":nt(()=>[ze(hu,{modelValue:a.value,"onUpdate:modelValue":O[0]||(O[0]=B=>a.value=B),tabs:ve.value},null,8,["modelValue","tabs"])]),footer:nt(()=>[c("div",MA,[_e.value?(m(),g("button",{key:0,type:"button",onClick:fe,class:"btn btn-danger"}," Delete "+b($.value),1)):(m(),g("div",AA)),c("button",{type:"button",onClick:pe,class:"btn btn-primary"},b(_e.value?"Save changes":ke.value),1)])]),default:nt(()=>[a.value==="details"?(m(),rt(aI,{key:0,form:x.value,areas:e.areas,"event-date":e.eventDate,"area-term-singular":A.value,"area-term-plural":ae.value,"checkpoint-term-singular":_.value,"people-term-plural":E.value,"onUpdate:form":Ee,onInput:be,onSave:q},null,8,["form","areas","event-date","area-term-singular","area-term-plural","checkpoint-term-singular","people-term-plural"])):N("",!0),a.value==="location"?(m(),rt(h$,{key:1,form:x.value,"is-moving":l.value,"checkpoint-term-singular":_.value,"people-term-plural":E.value,areas:e.areas,locations:e.allLocations,marshals:e.availableMarshals,"is-editing":_e.value,"onUpdate:form":Ee,onInput:be,onSave:q,onMoveLocation:Se},null,8,["form","is-moving","checkpoint-term-singular","people-term-plural","areas","locations","marshals","is-editing"])):N("",!0),a.value==="marshals"?(m(),rt(A$,{key:2,ref_key:"assignmentsTabRef",ref:u,form:x.value,assignments:e.assignments,"people-term":E.value,"person-term":k.value,"onUpdate:form":Ee,onInput:be,onRemoveAssignment:Le,onOpenAssignModal:F},null,8,["form","assignments","people-term","person-term"])):N("",!0),a.value==="checklists"&&_e.value?(m(),rt(Up,{key:3,ref_key:"checklistTabRef",ref:h,modelValue:p.value,"onUpdate:modelValue":O[1]||(O[1]=B=>p.value=B),"event-id":e.eventId,"location-id":e.location.id,locations:e.allLocations,areas:e.areas,assignments:e.assignments,onChange:le},null,8,["modelValue","event-id","location-id","locations","areas","assignments"])):N("",!0),a.value==="checklists"?(m(),rt(NM,{key:4,modelValue:f.value,"onUpdate:modelValue":O[2]||(O[2]=B=>f.value=B),"all-checklist-items":e.allChecklistItems,"pending-area-ids":x.value.areaIds,areas:e.areas,"is-editing":_e.value,"checkpoint-term-singular":_.value,onChange:be},null,8,["modelValue","all-checklist-items","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):N("",!0),a.value==="notes"&&_e.value?(m(),rt(bl,{key:5,"event-id":e.eventId,"location-id":e.location?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","location-id","all-notes","locations","areas","assignments"])):N("",!0),a.value==="notes"?(m(),rt(aA,{key:6,modelValue:y.value,"onUpdate:modelValue":O[3]||(O[3]=B=>y.value=B),"all-notes":e.notes,"pending-area-ids":x.value.areaIds,areas:e.areas,"is-editing":_e.value,"checkpoint-term-singular":_.value,onChange:be},null,8,["modelValue","all-notes","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):N("",!0),a.value==="appearance"?(m(),g("div",cA,[c("div",uA,[c("button",{type:"button",class:Te(["accordion-header",{expanded:I.value.iconStyle}]),onClick:O[4]||(O[4]=B=>S("iconStyle"))},[c("div",{class:"accordion-icon",innerHTML:Q.value},null,8,dA),c("span",hA,b(_.value)+" marker style",1),c("span",fA,b(I.value.iconStyle?"":""),1)],2),I.value.iconStyle?(m(),g("div",pA,[c("p",vA," Choose a custom icon for this "+b($.value)+", or leave as Default to inherit from "+b(ne.value)+" or event settings. ",1),ze(du,{"style-type":x.value.styleType||"default","style-color":x.value.styleColor||"","style-background-shape":x.value.styleBackgroundShape||"","style-background-color":x.value.styleBackgroundColor||"","style-border-color":x.value.styleBorderColor||"","style-icon-color":x.value.styleIconColor||"","style-size":x.value.styleSize||"","style-map-rotation":x.value.styleMapRotation??"","inherited-style-type":xe.value.type,"inherited-style-color":xe.value.color,"inherited-background-shape":xe.value.backgroundShape||"","inherited-background-color":xe.value.backgroundColor||xe.value.color||"","inherited-border-color":xe.value.borderColor||"","inherited-icon-color":xe.value.iconColor||"","inherited-size":xe.value.size||"","inherited-map-rotation":xe.value.mapRotation??"","default-label":he.value,"icon-label":"Marker style",level:"checkpoint","show-preview":!0,"onUpdate:styleType":O[5]||(O[5]=B=>W("styleType",B)),"onUpdate:styleColor":O[6]||(O[6]=B=>W("styleColor",B)),"onUpdate:styleBackgroundShape":O[7]||(O[7]=B=>W("styleBackgroundShape",B)),"onUpdate:styleBackgroundColor":O[8]||(O[8]=B=>W("styleBackgroundColor",B)),"onUpdate:styleBorderColor":O[9]||(O[9]=B=>W("styleBorderColor",B)),"onUpdate:styleIconColor":O[10]||(O[10]=B=>W("styleIconColor",B)),"onUpdate:styleSize":O[11]||(O[11]=B=>W("styleSize",B)),"onUpdate:styleMapRotation":O[12]||(O[12]=B=>W("styleMapRotation",B))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation","default-label"])])):N("",!0)]),c("div",mA,[c("button",{type:"button",class:Te(["accordion-header",{expanded:I.value.terminology}]),onClick:O[13]||(O[13]=B=>S("terminology"))},[O[16]||(O[16]=c("div",{class:"accordion-icon"},[c("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[c("circle",{cx:"9",cy:"8",r:"3",fill:"#6366F1"}),c("path",{d:"M3 18c0-3.3 2.7-6 6-6s6 2.7 6 6",fill:"#6366F1",opacity:"0.5"}),c("circle",{cx:"17",cy:"14",r:"5",fill:"#10B981",opacity:"0.3"}),c("circle",{cx:"17",cy:"14",r:"3",fill:"#10B981"}),c("circle",{cx:"17",cy:"14",r:"1",fill:"white"})])],-1)),O[17]||(O[17]=c("span",{class:"accordion-title"},"Terminology",-1)),c("span",gA,b(ue.value),1),c("span",yA,b(I.value.terminology?"":""),1)],2),I.value.terminology?(m(),g("div",_A,[c("p",kA," Customise what this "+b($.value)+" and its "+b(E.value.toLowerCase())+" are called. ",1),c("div",bA,[c("div",wA,[c("label",null,"What is this "+b($.value)+" called?",1),c("select",{value:x.value.checkpointTerm,class:"form-input",onChange:O[14]||(O[14]=B=>{Ee({...x.value,checkpointTerm:B.target.value}),be()})},[c("option",LA,"Use "+b(ne.value)+" default ("+b(_.value)+")",1),O[18]||(O[18]=c("option",{value:"Vehicle"},"Vehicle",-1)),O[19]||(O[19]=c("option",{value:"Car"},"Car",-1)),O[20]||(O[20]=c("option",{value:"Bike"},"Bike",-1)),(m(!0),g(Ce,null,Be(z(qo).checkpoint,B=>(m(),g("option",{key:B,value:B},b(B),9,SA))),128))],40,CA)]),c("div",xA,[c("label",null,"What are "+b(E.value.toLowerCase())+" called here?",1),c("select",{value:x.value.peopleTerm,class:"form-input",onChange:O[15]||(O[15]=B=>{Ee({...x.value,peopleTerm:B.target.value}),be()})},[c("option",IA,"Use "+b(ne.value)+" default ("+b(R.value)+")",1),(m(!0),g(Ce,null,Be(z(qo).people,B=>(m(),g("option",{key:B,value:B},b(B),9,$A))),128))],40,TA)])])])):N("",!0)])])):N("",!0)]),_:1},8,["show","is-dirty","z-index"]))}},PA=Je(EA,[["__scopeId","data-v-90735dd4"]]),DA={class:"tab-content"},OA={class:"form-group"},RA=["value"],BA={class:"form-group"},NA=["value"],FA={class:"form-group"},UA=["value"],zA={class:"form-group"},HA=["value"],VA={key:0,class:"magic-link-section"},GA={key:0,class:"loading-text"},ZA={key:1,class:"magic-link-container"},jA={class:"magic-link-row"},WA=["value"],qA={key:0,class:"magic-link-actions"},KA=["disabled"],YA={key:1,class:"success-text"},JA={key:2,class:"error-text"},XA={key:2,class:"error-text"},QA={__name:"MarshalDetailsTab",props:{form:{type:Object,required:!0},eventId:{type:String,default:null},marshalId:{type:String,default:null}},emits:["update:form","input"],setup(e,{emit:t}){const o=e,i=t,s=D(""),a=D(!1),l=D(!1),u=D(""),h=D(!1),p=D(!1),f=D(!1),y=D(""),x=(R,E)=>{i("update:form",{...o.form,[R]:E}),i("input")},T=async()=>{if(!(!o.eventId||!o.marshalId)){l.value=!0,u.value="";try{const R=await $o.getMagicLink(o.eventId,o.marshalId);s.value=R.data.magicLink,a.value=R.data.hasEmail}catch(R){console.error("Failed to fetch magic link:",R),u.value="Failed to load login link"}finally{l.value=!1}}},I=async()=>{try{await navigator.clipboard.writeText(s.value),h.value=!0,setTimeout(()=>{h.value=!1},2e3)}catch(R){console.error("Failed to copy:",R)}},S=async()=>{if(!(!o.eventId||!o.marshalId)){p.value=!0,f.value=!1,y.value="";try{await $o.sendMagicLink(o.eventId,o.marshalId),f.value=!0,setTimeout(()=>{f.value=!1},3e3)}catch(R){console.error("Failed to send email:",R),y.value=R.response?.data?.message||"Failed to send email"}finally{p.value=!1}}};return We(()=>o.marshalId,R=>{R?T():(s.value="",a.value=!1)},{immediate:!0}),(R,E)=>(m(),g("div",DA,[c("div",OA,[E[5]||(E[5]=c("label",null,"Name *",-1)),c("input",{value:e.form.name,onInput:E[0]||(E[0]=M=>x("name",M.target.value)),type:"text",required:"",class:"form-input"},null,40,RA)]),c("div",BA,[E[6]||(E[6]=c("label",null,"Email",-1)),c("input",{value:e.form.email,onInput:E[1]||(E[1]=M=>x("email",M.target.value)),type:"email",class:"form-input"},null,40,NA)]),c("div",FA,[E[7]||(E[7]=c("label",null,"Phone number",-1)),c("input",{value:e.form.phoneNumber,onInput:E[2]||(E[2]=M=>x("phoneNumber",M.target.value)),type:"tel",class:"form-input"},null,40,UA)]),c("div",zA,[E[8]||(E[8]=c("label",null,"Notes",-1)),c("textarea",{value:e.form.notes,onInput:E[3]||(E[3]=M=>x("notes",M.target.value)),class:"form-input",rows:"3",placeholder:"e.g., Needs to leave by 11am"},null,40,HA)]),e.marshalId?(m(),g("div",VA,[E[9]||(E[9]=c("label",null,"Login link",-1)),E[10]||(E[10]=c("p",{class:"help-text"},"Share this unique link with the marshal so they can access their dashboard.",-1)),l.value?(m(),g("div",GA,"Loading link...")):s.value?(m(),g("div",ZA,[c("div",jA,[c("input",{type:"text",value:s.value,readonly:"",class:"form-input magic-link-input",onFocus:E[4]||(E[4]=M=>M.target.select())},null,40,WA),c("button",{type:"button",class:"btn btn-secondary",onClick:I},b(h.value?"Copied!":"Copy link"),1)]),a.value?(m(),g("div",qA,[c("button",{type:"button",class:"btn btn-primary",disabled:p.value,onClick:S},b(p.value?"Sending...":"Send via email"),9,KA)])):N("",!0),f.value?(m(),g("p",YA,"Email sent successfully!")):N("",!0),y.value?(m(),g("p",JA,b(y.value),1)):N("",!0)])):u.value?(m(),g("div",XA,b(u.value),1)):N("",!0)])):N("",!0)]))}},eE=Je(QA,[["__scopeId","data-v-5fa4ceb3"]]),tE={class:"tab-content"},nE={class:"section-title"},oE={class:"assignments-list"},sE={class:"assignment-info"},iE={class:"assignment-header"},aE=["title"],rE={key:1,class:"status-indicator pending-indicator",title:"Will be assigned on save"},lE={key:2,class:"pending-badge"},cE={key:3,class:"pending-badge"},uE={key:0,class:"check-in-info"},dE={class:"check-in-method"},hE={class:"assignment-actions"},fE=["onClick"],pE=["onClick"],vE={key:0,class:"form-group",style:{"margin-top":"1.5rem"}},mE={value:""},gE=["value"],yE={__name:"MarshalCheckpointsTab",props:{assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},isNewMarshal:{type:Boolean,default:!1}},emits:["input","remove-assignment","assign-to-location"],setup(e,{expose:t,emit:o}){const{termsLower:i}=Ct(),s=e,a=o,{pendingCheckInChanges:l,getEffectiveCheckInStatus:u,handleToggleCheckIn:h,getStatusIcon:p,getStatusColor:f,getStatusText:y,formatTime:x}=Fp(()=>a("input")),T=D(""),I=X(()=>s.assignments?.length||0),S=X(()=>{const E=[...s.availableLocations];return E.sort((M,_)=>M.name.localeCompare(_.name,void 0,{numeric:!0,sensitivity:"base"})),E}),R=()=>{T.value&&(a("assign-to-location",T.value),T.value="")};return t({pendingCheckInChanges:l,clearPendingChanges:()=>{l.value.clear(),T.value=""},getPendingChanges:()=>Array.from(l.value.entries()).map(([E,M])=>({assignmentId:E,shouldBeCheckedIn:M}))}),(E,M)=>(m(),g("div",tE,[c("h3",nE,"Assigned "+b(z(i).checkpoints)+" ("+b(I.value)+")",1),c("div",oE,[(m(!0),g(Ce,null,Be(e.assignments,_=>(m(),g("div",{key:_.id,class:Te(["assignment-item",{"checked-in":!_.isPending&&z(u)(_),"is-pending":_.isPending}])},[c("div",sE,[c("div",iE,[_.isPending?(m(),g("span",rE,"  ")):(m(),g("span",{key:0,class:"status-indicator",style:at({color:z(f)(_)}),title:z(y)(_)},b(z(p)(_)),13,aE)),c("strong",null,b(_.locationName),1),_.isPending?(m(),g("span",lE," (will be assigned on save) ")):z(l).has(_.id)?(m(),g("span",cE," (unsaved) ")):N("",!0)]),!_.isPending&&z(u)(_)?(m(),g("span",uE,[_.isCheckedIn&&!z(l).has(_.id)?(m(),g(Ce,{key:0},[Ze(b(z(x)(_.checkInTime))+" ",1),c("span",dE,"("+b(_.checkInMethod)+")",1)],64)):(m(),g(Ce,{key:1},[Ze(" Will be checked in on save ")],64))])):N("",!0)]),c("div",hE,[_.isPending?N("",!0):(m(),g("button",{key:0,onClick:$=>z(h)(_),class:Te(["btn btn-small",z(u)(_)?"btn-danger":"btn-secondary"])},b(z(u)(_)?"Undo":"Check in"),11,fE)),c("button",{onClick:$=>E.$emit("remove-assignment",_),class:"btn btn-small btn-danger"}," Remove ",8,pE)])],2))),128)),S.value.length>0?(m(),g("div",vE,[c("label",null,"Assign to "+b(z(i).checkpoint),1),je(c("select",{"onUpdate:modelValue":M[0]||(M[0]=_=>T.value=_),class:"form-input",onChange:R},[c("option",mE,"Select a "+b(z(i).checkpoint)+"...",1),(m(!0),g(Ce,null,Be(S.value,_=>(m(),g("option",{key:_.id,value:_.id},[Ze(b(_.name),1),_.description?(m(),g(Ce,{key:0},[Ze(" - "+b(_.description),1)],64)):N("",!0)],8,gE))),128))],544),[[Sn,T.value]])])):N("",!0)])]))}},_E=Je(yE,[["__scopeId","data-v-cd855013"]]),kE={class:"marshal-checklist-view"},bE={key:0,class:"loading-state"},wE={key:1,class:"error-state"},CE={key:2,class:"empty-state"},LE={key:3,class:"checklist-items"},SE={class:"item-checkbox"},xE=["checked","disabled","onChange"],TE={class:"item-content"},IE={class:"item-header"},$E={class:"item-text-wrapper"},ME={class:"item-text"},AE={key:0,class:"item-context"},EE={class:"item-scope"},PE=["title"],DE={key:0,class:"completion-info"},OE={key:0,class:"pending-text"},RE={class:"completion-text"},BE={class:"completion-time"},NE={key:1,class:"uncomplete-info"},FE={key:2,class:"disabled-reason"},UE={__name:"MarshalChecklistView",props:{eventId:{type:String,required:!0},marshalId:{type:String,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=Ct(),a=e,l=o,u=D([]),h=D(!1),p=D(null),f=D(new Map),y=X(()=>u.value.map(k=>{const w=f.value.get(k.itemId),A=w!==void 0?w.complete:k.isCompleted,ne=w!==void 0&&w.complete!==k.isCompleted;return{...k,localIsCompleted:A,isModified:ne}})),x=async()=>{if(!(!a.eventId||!a.marshalId)){h.value=!0,p.value=null;try{const k=await Et.getMarshalChecklist(a.eventId,a.marshalId);if(u.value=k.data||[],a.modelValue&&a.modelValue.length>0){const w=new Map;a.modelValue.forEach(A=>{w.set(A.itemId,{complete:A.complete,contextType:A.contextType,contextId:A.contextId})}),f.value=w}}catch(k){console.error("Failed to load checklist:",k),p.value=k.response?.data?.message||"Failed to load checklist"}finally{h.value=!1}}},T=k=>{const w=f.value.get(k.itemId),A=w!==void 0?w.complete:k.isCompleted;f.value.set(k.itemId,{complete:!A,contextType:k.completionContextType,contextId:k.completionContextId}),I()},I=()=>{const k=[];for(const[w,A]of f.value.entries()){const ne=u.value.find(ae=>ae.itemId===w);ne&&A.complete!==ne.isCompleted&&k.push({itemId:w,complete:A.complete,contextType:A.contextType,contextId:A.contextId})}l("update:modelValue",k),l("change",k)};t({resetLocalState:()=>{if(f.value=new Map,a.modelValue&&a.modelValue.length>0){const k=new Map;a.modelValue.forEach(w=>{k.set(w.itemId,{complete:w.complete,contextType:w.contextType,contextId:w.contextId})}),f.value=k}},loadChecklist:x});const R=k=>({Everyone:"Everyone",SpecificPeople:"Assigned to you",EveryoneInAreas:`Your ${s.value.areas}`,EveryoneAtCheckpoints:`Your ${s.value.checkpoints}`,OnePerCheckpoint:`One per ${s.value.checkpoint}`,OnePerArea:`One per ${s.value.area}`,EveryAreaLead:`${i.value.area} lead`,OneLeadPerArea:`One lead per ${s.value.area}`})[k.matchedScope]||k.matchedScope,E=k=>({Everyone:"This item is for everyone at the event",SpecificPeople:"This item is specifically assigned to this person",EveryoneInAreas:`This item is for everyone in certain ${s.value.areas}`,EveryoneAtCheckpoints:`This item is for everyone at certain ${s.value.checkpoints}`,OnePerCheckpoint:`One person at the ${s.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${s.value.area} needs to complete this`,EveryAreaLead:`This item is for ${s.value.area} leads only`,OneLeadPerArea:`One ${s.value.area} lead needs to complete this`})[k.matchedScope]||"",M=k=>k.completionContextType==="Checkpoint"||k.completionContextType==="Area"?"Already completed by someone else":"Cannot be completed",_=k=>{if(!k.completionContextType||!k.completionContextId)return null;if(k.completionContextType==="Checkpoint"){const w=a.locations.find(ne=>ne.id===k.completionContextId);if(!w)return null;const A=w.description?`${w.name} - ${w.description}`:w.name;return`at ${s.value.checkpoint} ${A}`}if(k.completionContextType==="Area"){const w=a.areas.find(A=>A.id===k.completionContextId);return w?`in ${s.value.area} ${w.name}`:null}return k.completionContextType==="Personal"?k.contextOwnerName?`for ${k.contextOwnerName}`:"assigned individually":null},$=k=>k?new Date(k).toLocaleString():"";return We(()=>[a.eventId,a.marshalId],()=>{x()},{immediate:!0}),(k,w)=>(m(),g("div",kE,[h.value?(m(),g("div",bE," Loading checklist... ")):p.value?(m(),g("div",wE,[c("p",null,b(p.value),1),c("button",{onClick:x,class:"btn btn-secondary btn-small"}," Retry ")])):u.value.length===0?(m(),g("div",CE,[...w[0]||(w[0]=[c("p",null,"No checklist items for this person.",-1)])])):(m(),g("div",LE,[(m(!0),g(Ce,null,Be(y.value,A=>(m(),g("div",{key:`${A.itemId}_${A.completionContextType}_${A.completionContextId}`,class:Te(["checklist-item",{"item-completed":A.localIsCompleted,"item-modified":A.isModified}])},[c("div",SE,[c("input",{type:"checkbox",checked:A.localIsCompleted,disabled:!A.canBeCompletedByMe,onChange:ne=>T(A)},null,40,xE)]),c("div",TE,[c("div",IE,[c("div",$E,[c("div",ME,b(A.text),1),_(A)?(m(),g("div",AE,b(_(A)),1)):N("",!0)]),c("div",EE,[c("span",{class:"scope-pill",title:E(A)},b(R(A)),9,PE)])]),A.localIsCompleted?(m(),g("div",DE,[A.isModified&&!A.isCompleted?(m(),g("span",OE," Will be marked as completed (pending save) ")):(m(),g(Ce,{key:1},[c("span",RE," Completed by "+b(A.completedByActorName||"Unknown"),1),c("span",BE,b($(A.completedAt)),1)],64))])):N("",!0),A.isModified&&A.isCompleted&&!A.localIsCompleted?(m(),g("div",NE,[...w[1]||(w[1]=[c("span",{class:"pending-text"},"Will be marked as incomplete (pending save)",-1)])])):N("",!0),!A.canBeCompletedByMe&&!A.localIsCompleted?(m(),g("div",FE,b(M(A)),1)):N("",!0)])],2))),128))]))]))}},zE=Je(UE,[["__scopeId","data-v-f04de3b8"]]),HE={class:"checklist-preview"},VE={class:"preview-actions"},GE={class:"preview-header"},ZE={key:0,class:"add-item-form"},jE=["placeholder"],WE=["disabled"],qE={key:1,class:"pending-items"},KE={class:"item-content"},YE={class:"item-header"},JE={class:"item-text"},XE={class:"item-scope"},QE=["onClick"],eP={key:2,class:"empty-state"},tP={key:0,class:"help-text"},nP={key:3,class:"checklist-items"},oP={class:"item-content"},sP={class:"item-header"},iP={class:"item-text"},aP={class:"item-scope"},rP=["title"],lP={key:0,class:"item-context"},cP={__name:"ChecklistPreview",props:{allChecklistItems:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=Ct(),i=e,s=t,a=D(!1),l=D(""),u=D([...i.modelValue]);We(()=>i.modelValue,M=>{u.value=[...M]},{deep:!0});const h=()=>{l.value.trim()&&(u.value.push({text:l.value.trim(),isNew:!0}),l.value="",a.value=!1,f())},p=M=>{u.value.splice(M,1),f()},f=()=>{s("update:modelValue",[...u.value]),s("change")},y=X(()=>{const M=new Set;for(const _ of i.pendingLocationIds){const $=i.allLocations.find(k=>k.id===_);$&&($.areaIds||$.AreaIds||[]).forEach(w=>M.add(w))}return[...M]}),x=M=>{const _=M.scope,$=M.itemType,k=M.ids||[];return _==="SpecificPeople"&&$==="Marshal"?k.includes("ALL_MARSHALS"):(_==="EveryoneAtCheckpoints"||_==="OnePerCheckpoint")&&$==="Checkpoint"?k.includes("ALL_CHECKPOINTS")?!0:k.some(w=>i.pendingLocationIds.includes(w)):_==="OnePerCheckpoint"&&$==="Area"?k.includes("ALL_AREAS")?!0:k.some(w=>y.value.includes(w)):(_==="EveryoneInAreas"||_==="OnePerArea"||_==="EveryAreaLead"||_==="OneLeadPerArea")&&$==="Area"?k.includes("ALL_AREAS")?!0:k.some(w=>y.value.includes(w)):!1},T=X(()=>i.allChecklistItems.filter(M=>M.scopeConfigurations&&M.scopeConfigurations.length>0?M.scopeConfigurations.some(_=>x(_)):!1)),I=M=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,EveryoneInAreas:`All in ${o.value.areas}`,OnePerArea:`One per ${o.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${o.value.area}`})[M]||M,S=M=>{if(!M.scopeConfigurations||M.scopeConfigurations.length===0)return"Unknown";const _=M.scopeConfigurations.find(k=>x(k));if(!_)return I(M.scopeConfigurations[0].scope);const $=_.ids||[];return $.includes("ALL_MARSHALS")?"Everyone":$.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:$.includes("ALL_AREAS")?`All ${o.value.areas}`:I(_.scope)},R=M=>{if(!M.scopeConfigurations||M.scopeConfigurations.length===0)return"";const _=M.scopeConfigurations.find(k=>x(k));return _&&{SpecificPeople:"This item is for everyone at the event",EveryoneAtCheckpoints:`This item is for everyone at specified ${o.value.checkpoints}`,OnePerCheckpoint:`One person at each ${o.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${o.value.areas}`,OnePerArea:`One person in each ${o.value.area} needs to complete this`,EveryAreaLead:`This item is for ${o.value.area} leads only`,OneLeadPerArea:`One ${o.value.area} lead needs to complete this`}[_.scope]||""},E=M=>{if(!M.scopeConfigurations||M.scopeConfigurations.length===0)return null;const _=M.scopeConfigurations.find(w=>x(w));if(!_)return null;const $=_.itemType,k=_.ids||[];if(k.includes("ALL_MARSHALS")||k.includes("ALL_CHECKPOINTS")||k.includes("ALL_AREAS"))return null;if($==="Checkpoint"){const w=i.allLocations.filter(A=>k.includes(A.id)&&i.pendingLocationIds.includes(A.id)).map(A=>A.name);if(w.length>0)return`At: ${w.join(", ")}`}if($==="Area"){const w=i.areas.filter(A=>k.includes(A.id)&&y.value.includes(A.id)).map(A=>A.name);if(w.length>0)return`In: ${w.join(", ")}`}return null};return(M,_)=>(m(),g("div",HE,[c("div",VE,[c("p",GE,b(e.isEditing?`Add new ${z(o).checklist} for this ${z(o).person}:`:`${z(o).checklists} that will apply to this ${z(o).person}:`),1),c("button",{type:"button",class:"add-item-btn",onClick:_[0]||(_[0]=$=>a.value=!a.value)},b(a.value?"Cancel":`+ Add ${z(o).checklist}`),1)]),a.value?(m(),g("div",ZE,[je(c("input",{"onUpdate:modelValue":_[1]||(_[1]=$=>l.value=$),type:"text",placeholder:`Enter ${z(o).checklist} text...`,class:"add-item-input",onKeyup:Uf(h,["enter"])},null,40,jE),[[ut,l.value]]),c("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim(),onClick:h}," Add ",8,WE)])):N("",!0),u.value.length>0?(m(),g("div",qE,[(m(!0),g(Ce,null,Be(u.value,($,k)=>(m(),g("div",{key:`pending-${k}`,class:"checklist-item pending"},[_[3]||(_[3]=c("div",{class:"item-checkbox"},[c("input",{type:"checkbox",checked:!1,disabled:""})],-1)),c("div",KE,[c("div",YE,[c("div",JE,b($.text),1),c("div",XE,[_[2]||(_[2]=c("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),c("button",{type:"button",class:"remove-item-btn",onClick:w=>p(k),title:"Remove"},"  ",8,QE)])])])]))),128))])):N("",!0),!e.isEditing&&T.value.length===0&&u.value.length===0?(m(),g("div",eP,[c("p",null,"No "+b(z(o).checklists)+" will apply based on the current "+b(z(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(m(),g("p",tP," Assign "+b(z(o).checkpoints)+" to see relevant "+b(z(o).checklists)+". ",1)):N("",!0)])):N("",!0),!e.isEditing&&T.value.length>0?(m(),g("div",nP,[(m(!0),g(Ce,null,Be(T.value,$=>(m(),g("div",{key:$.id,class:"checklist-item"},[_[4]||(_[4]=c("div",{class:"item-checkbox"},[c("input",{type:"checkbox",checked:!1,disabled:""})],-1)),c("div",oP,[c("div",sP,[c("div",iP,b($.text),1),c("div",aP,[c("span",{class:"scope-pill",title:R($)},b(S($)),9,rP)])]),E($)?(m(),g("div",lP,b(E($)),1)):N("",!0)])]))),128))])):N("",!0)]))}},uP=Je(cP,[["__scopeId","data-v-1c92d629"]]),dP={class:"notes-preview"},hP={class:"preview-actions"},fP={class:"preview-header"},pP={key:0,class:"add-item-form"},vP={class:"add-form-fields"},mP=["disabled"],gP={key:1,class:"pending-items"},yP={class:"note-header"},_P={class:"note-title"},kP={class:"note-actions"},bP=["onClick"],wP={key:0,class:"note-content"},CP={key:2,class:"empty-state"},LP={key:0,class:"help-text"},SP={key:3,class:"notes-list"},xP={class:"note-header"},TP={class:"note-title"},IP=["title"],$P={key:0,class:"note-content"},MP={key:1,class:"note-context"},AP={__name:"NotesPreview",props:{allNotes:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=Ct(),i=e,s=t,a=D(!1),l=D(""),u=D(""),h=D([...i.modelValue]);We(()=>i.modelValue,_=>{h.value=[..._]},{deep:!0});const p=()=>{!l.value.trim()&&!u.value.trim()||(h.value.push({title:l.value.trim(),content:u.value.trim(),isNew:!0}),l.value="",u.value="",a.value=!1,y())},f=_=>{h.value.splice(_,1),y()},y=()=>{s("update:modelValue",[...h.value]),s("change")},x=X(()=>{const _=new Set;for(const $ of i.pendingLocationIds){const k=i.allLocations.find(w=>w.id===$);k&&(k.areaIds||k.AreaIds||[]).forEach(A=>_.add(A))}return[..._]}),T=_=>{const $=_.scope,k=_.itemType,w=_.ids||[];return $==="SpecificPeople"&&k==="Marshal"?w.includes("ALL_MARSHALS"):$==="EveryoneAtCheckpoints"&&k==="Checkpoint"?w.includes("ALL_CHECKPOINTS")?!0:w.some(A=>i.pendingLocationIds.includes(A)):$==="EveryoneInAreas"&&k==="Area"?w.includes("ALL_AREAS")?!0:w.some(A=>x.value.includes(A)):!1},I=X(()=>i.allNotes.filter(_=>_.scopeConfigurations&&_.scopeConfigurations.length>0?_.scopeConfigurations.some($=>T($)):!1)),S=_=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[_]||_,R=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"Unknown";const $=_.scopeConfigurations.find(w=>T(w));if(!$)return S(_.scopeConfigurations[0].scope);const k=$.ids||[];return k.includes("ALL_MARSHALS")?"Everyone":k.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:k.includes("ALL_AREAS")?`All ${o.value.areas}`:S($.scope)},E=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"";const $=_.scopeConfigurations.find(w=>T(w));return $&&{SpecificPeople:"This note is for everyone at the event",EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[$.scope]||""},M=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return null;const $=_.scopeConfigurations.find(A=>T(A));if(!$)return null;const k=$.itemType,w=$.ids||[];if(w.includes("ALL_MARSHALS")||w.includes("ALL_CHECKPOINTS")||w.includes("ALL_AREAS"))return null;if(k==="Checkpoint"){const A=i.allLocations.filter(ne=>w.includes(ne.id)&&i.pendingLocationIds.includes(ne.id)).map(ne=>ne.name);if(A.length>0)return`At: ${A.join(", ")}`}if(k==="Area"){const A=i.areas.filter(ne=>w.includes(ne.id)&&x.value.includes(ne.id)).map(ne=>ne.name);if(A.length>0)return`In: ${A.join(", ")}`}return null};return(_,$)=>(m(),g("div",dP,[c("div",hP,[c("p",fP,b(e.isEditing?`Add new note for this ${z(o).person}:`:`Notes that will be visible to this ${z(o).person}:`),1),c("button",{type:"button",class:"add-item-btn",onClick:$[0]||($[0]=k=>a.value=!a.value)},b(a.value?"Cancel":"+ Add note"),1)]),a.value?(m(),g("div",pP,[c("div",vP,[je(c("input",{"onUpdate:modelValue":$[1]||($[1]=k=>l.value=k),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[ut,l.value]]),je(c("textarea",{"onUpdate:modelValue":$[2]||($[2]=k=>u.value=k),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[ut,u.value]])]),c("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim()&&!u.value.trim(),onClick:p}," Add ",8,mP)])):N("",!0),h.value.length>0?(m(),g("div",gP,[(m(!0),g(Ce,null,Be(h.value,(k,w)=>(m(),g("div",{key:`pending-${w}`,class:"note-item pending"},[c("div",yP,[c("span",_P,b(k.title||"Untitled"),1),c("div",kP,[$[3]||($[3]=c("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),c("button",{type:"button",class:"remove-item-btn",onClick:A=>f(w),title:"Remove"},"  ",8,bP)])]),k.content?(m(),g("div",wP,b(k.content),1)):N("",!0)]))),128))])):N("",!0),!e.isEditing&&I.value.length===0&&h.value.length===0?(m(),g("div",CP,[c("p",null,"No notes will be visible based on the current "+b(z(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(m(),g("p",LP," Assign "+b(z(o).checkpoints)+" to see relevant notes. ",1)):N("",!0)])):N("",!0),!e.isEditing&&I.value.length>0?(m(),g("div",SP,[(m(!0),g(Ce,null,Be(I.value,k=>(m(),g("div",{key:k.id,class:"note-item"},[c("div",xP,[c("span",TP,b(k.title||"Untitled"),1),c("span",{class:"scope-pill",title:E(k)},b(R(k)),9,IP)]),k.content?(m(),g("div",$P,b(k.content),1)):N("",!0),M(k)?(m(),g("div",MP,b(M(k)),1)):N("",!0)]))),128))])):N("",!0)]))}},EP=Je(AP,[["__scopeId","data-v-dc8ac5e7"]]),PP={class:"custom-footer"},DP={key:1},OP={__name:"EditMarshalModal",props:{show:{type:Boolean,default:!1},marshal:{type:Object,default:null},eventId:{type:String,required:!0},assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1},eventNotes:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]}},emits:["close","save","delete","toggle-check-in","remove-assignment","assign-to-location","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=e,a=t,l=D("details"),u=D(null),h=D(null),p=D([]),f=D([]),y=D([]),x=D([]),T=D({name:"",email:"",phoneNumber:"",notes:""}),I=X(()=>{const he=s.isEditing?`Edit ${i.value.person}`:`Create ${i.value.person}`,Q=T.value.name?.trim();return Q?`${he} - ${Q}`:he}),S=X(()=>[{value:"details",label:"Details",icon:"details"},{value:"checkpoints",label:o.value.checkpoints,icon:"checkpoint"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}]),R=X(()=>S.value.findIndex(he=>he.value===l.value)),E=X(()=>R.value===S.value.length-1),M=X(()=>E.value?null:S.value[R.value+1]),_=X(()=>E.value?`Create ${i.value.person}`:`Add ${M.value.label.toLowerCase()}...`),$=X(()=>f.value.map(he=>he.locationId)),k=X(()=>s.isEditing?s.assignments:f.value.map(he=>({id:`pending-${he.locationId}`,locationId:he.locationId,locationName:s.allLocations.find(Q=>Q.id===he.locationId)?.name||"Unknown",isPending:!0}))),w=X(()=>{if(s.isEditing)return s.availableLocations;const he=f.value.map(Q=>Q.locationId);return s.allLocations.filter(Q=>!he.includes(Q.id))});We(()=>s.marshal,he=>{he?T.value={name:he.name||"",email:he.email||"",phoneNumber:he.phoneNumber||"",notes:he.notes||""}:T.value={name:"",email:"",phoneNumber:"",notes:""}},{immediate:!0,deep:!0}),We(()=>s.show,he=>{he&&(l.value="details",p.value=[],f.value=[],y.value=[],x.value=[],s.isEditing||(T.value={name:"",email:"",phoneNumber:"",notes:""}),u.value?.clearPendingChanges&&u.value.clearPendingChanges(),h.value?.resetLocalState&&h.value.resetLocalState())});const A=he=>{T.value=he},ne=()=>{a("update:isDirty",!0)},ae=()=>{a("update:isDirty",!0)},_e=()=>{s.isEditing||E.value?re():l.value=M.value.value},re=()=>{const he={...T.value,checkInChanges:u.value?.getPendingChanges?.()||[],checklistChanges:p.value||[],pendingAssignments:s.isEditing?[]:f.value,pendingNewChecklistItems:y.value,pendingNewNotes:x.value};a("save",he)},ve=()=>{a("delete")},Ie=he=>{!s.isEditing&&he.isPending?f.value=f.value.filter(Q=>Q.locationId!==he.locationId):a("remove-assignment",he)},Re=he=>{s.isEditing?a("assign-to-location",he):(f.value.push({locationId:he}),a("update:isDirty",!0))},xe=()=>{a("close")};return(he,Q)=>(m(),rt(Ut,{show:e.show,title:I.value,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:xe},{"tab-header":nt(()=>[ze(hu,{modelValue:l.value,"onUpdate:modelValue":Q[0]||(Q[0]=J=>l.value=J),tabs:S.value},null,8,["modelValue","tabs"])]),footer:nt(()=>[c("div",PP,[e.isEditing?(m(),g("button",{key:0,type:"button",onClick:ve,class:"btn btn-danger"}," Delete "+b(z(i).person),1)):(m(),g("div",DP)),c("button",{type:"button",onClick:_e,class:"btn btn-primary"},b(e.isEditing?"Save changes":_.value),1)])]),default:nt(()=>[l.value==="details"?(m(),rt(eE,{key:0,form:T.value,"event-id":e.eventId,"marshal-id":e.isEditing?e.marshal?.id:null,"onUpdate:form":A,onInput:ne},null,8,["form","event-id","marshal-id"])):N("",!0),l.value==="checkpoints"?(m(),rt(_E,{key:1,ref_key:"checkpointsTabRef",ref:u,assignments:k.value,"available-locations":w.value,"is-new-marshal":!e.isEditing,onInput:ne,onRemoveAssignment:Ie,onAssignToLocation:Re},null,8,["assignments","available-locations","is-new-marshal"])):N("",!0),l.value==="checklists"&&e.isEditing?(m(),rt(zE,{key:2,ref_key:"checklistTabRef",ref:h,modelValue:p.value,"onUpdate:modelValue":Q[1]||(Q[1]=J=>p.value=J),"event-id":e.eventId,"marshal-id":e.marshal.id,locations:e.allLocations,areas:e.areas,onChange:ae},null,8,["modelValue","event-id","marshal-id","locations","areas"])):N("",!0),l.value==="checklists"?(m(),rt(uP,{key:3,modelValue:y.value,"onUpdate:modelValue":Q[2]||(Q[2]=J=>y.value=J),"all-checklist-items":e.allChecklistItems,"pending-location-ids":$.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:ne},null,8,["modelValue","all-checklist-items","pending-location-ids","all-locations","areas","is-editing"])):N("",!0),l.value==="notes"&&e.isEditing?(m(),rt(bl,{key:4,"event-id":e.eventId,"marshal-id":e.marshal?.id,"all-notes":e.eventNotes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","marshal-id","all-notes","locations","areas","assignments"])):N("",!0),l.value==="notes"?(m(),rt(EP,{key:5,modelValue:x.value,"onUpdate:modelValue":Q[3]||(Q[3]=J=>x.value=J),"all-notes":e.eventNotes,"pending-location-ids":$.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:ne},null,8,["modelValue","all-notes","pending-location-ids","all-locations","areas","is-editing"])):N("",!0)]),_:1},8,["show","title","is-dirty"]))}},RP=Je(OP,[["__scopeId","data-v-84f3c0d3"]]),BP={class:"locations-list"},NP={class:"conflict-actions"},FP={__name:"AssignmentConflictModal",props:{show:{type:Boolean,default:!1},conflictData:{type:Object,default:()=>({marshalName:"",locations:[]})}},emits:["close","choice"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=t,a=u=>{s("choice",u)},l=()=>{s("close")};return(u,h)=>(m(),rt(Ut,{show:e.show,title:`${z(o).person} already assigned`,size:"medium","z-index":1100,onClose:l},{actions:nt(()=>[c("div",NP,[c("button",{onClick:h[0]||(h[0]=p=>a("move")),class:"btn btn-primary btn-full"}," Move to this "+b(z(i).checkpoint)+" (remove from others) ",1),c("button",{onClick:h[1]||(h[1]=p=>a("both")),class:"btn btn-secondary btn-full"}," Assign to both (keep existing assignments) "),c("button",{onClick:h[2]||(h[2]=p=>a("choose-other")),class:"btn btn-secondary btn-full"}," Choose someone else "),c("button",{onClick:h[3]||(h[3]=p=>a("cancel")),class:"btn btn-secondary btn-full"}," Cancel ")])]),default:nt(()=>[c("p",null,[c("strong",null,b(e.conflictData.marshalName),1),h[4]||(h[4]=Ze(" is currently assigned to: ",-1))]),c("ul",BP,[(m(!0),g(Ce,null,Be(e.conflictData.locations,p=>(m(),g("li",{key:p},b(p),1))),128))]),h[5]||(h[5]=c("p",null,"What would you like to do?",-1))]),_:1},8,["show","title"]))}},UP=Je(FP,[["__scopeId","data-v-b64e5b37"]]),zP={key:0,class:"assign-marshal-section"},HP={value:""},VP=["value"],GP=["disabled"],ZP={key:1,class:"assign-marshal-section create-mode"},jP={class:"form-group"},WP={class:"form-group"},qP={class:"form-group"},KP={__name:"AssignMarshalModal",props:{show:{type:Boolean,default:!1},locationName:{type:String,default:""},marshals:{type:Array,default:()=>[]}},emits:["close","assign-existing","create-and-assign"],setup(e,{emit:t}){const{termsLower:o}=Ct(),i=e,s=t,a=D(!1),l=D(""),u=D({name:"",email:"",phoneNumber:""});We(()=>i.show,T=>{T||(a.value=!1,l.value="",u.value={name:"",email:"",phoneNumber:""})});const h=()=>{a.value=!0},p=()=>{l.value&&s("assign-existing",l.value)},f=()=>{u.value.name&&s("create-and-assign",{...u.value})},y=()=>{a.value=!1,u.value={name:"",email:"",phoneNumber:""}},x=()=>{s("close")};return(T,I)=>(m(),rt(Ut,{show:e.show,title:a.value?`Create new ${z(o).person}`:`Assign ${z(o).person} to ${e.locationName}`,size:"medium",onClose:x},{actions:nt(()=>[a.value?(m(),g(Ce,{key:0},[c("button",{onClick:y,class:"btn btn-secondary"}," Cancel "),c("button",{onClick:f,class:"btn btn-primary"}," Create & assign ")],64)):N("",!0)]),default:nt(()=>[a.value?(m(),g("div",ZP,[c("h3",null,"Create new "+b(z(o).person),1),c("div",jP,[I[5]||(I[5]=c("label",null,"Name *",-1)),je(c("input",{"onUpdate:modelValue":I[1]||(I[1]=S=>u.value.name=S),type:"text",required:"",class:"form-input"},null,512),[[ut,u.value.name]])]),c("div",WP,[I[6]||(I[6]=c("label",null,"Email",-1)),je(c("input",{"onUpdate:modelValue":I[2]||(I[2]=S=>u.value.email=S),type:"email",class:"form-input"},null,512),[[ut,u.value.email]])]),c("div",qP,[I[7]||(I[7]=c("label",null,"Phone",-1)),je(c("input",{"onUpdate:modelValue":I[3]||(I[3]=S=>u.value.phoneNumber=S),type:"tel",class:"form-input"},null,512),[[ut,u.value.phoneNumber]])])])):(m(),g("div",zP,[c("h3",null,"Select existing "+b(z(o).person),1),je(c("select",{"onUpdate:modelValue":I[0]||(I[0]=S=>l.value=S),class:"form-input"},[c("option",HP,"Choose a "+b(z(o).person)+"...",1),(m(!0),g(Ce,null,Be(e.marshals,S=>(m(),g("option",{key:S.id,value:S.id},[Ze(b(S.name)+" ",1),S.assignedLocationIds&&S.assignedLocationIds.length>0?(m(),g(Ce,{key:0},[Ze(" (assigned to "+b(S.assignedLocationIds.length)+" "+b(S.assignedLocationIds.length>1?z(o).checkpoints:z(o).checkpoint)+") ",1)],64)):N("",!0)],8,VP))),128))],512),[[Sn,l.value]]),c("button",{onClick:p,class:"btn btn-primary btn-full",style:{"margin-top":"1rem"},disabled:!l.value}," Assign selected "+b(z(o).person),9,GP),I[4]||(I[4]=c("div",{class:"divider"},"OR",-1)),c("button",{onClick:h,class:"btn btn-secondary btn-full"}," Create new "+b(z(o).person),1)]))]),_:1},8,["show","title"]))}},YP=Je(KP,[["__scopeId","data-v-f95e76a2"]]),JP={class:"shift-times-content"},XP={class:"info-text"},QP={class:"time-delta-info"},e4={class:"delta-detail"},t4={class:"delta-detail"},n4={class:"delta-summary"},o4={class:"affected-checkpoints"},s4={class:"option-selection"},i4={class:"radio-option"},a4={class:"radio-option"},r4={__name:"ShiftCheckpointTimesModal",props:{show:{type:Boolean,default:!1},oldEventDate:{type:String,required:!0},newEventDate:{type:String,required:!0},affectedCheckpointsCount:{type:Number,default:0}},emits:["confirm","cancel"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=e,a=t,l=D("shift"),u=X(()=>{const x=new Date(s.oldEventDate);return new Date(s.newEventDate)-x}),h=x=>new Date(x).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),p=x=>{const T=Math.abs(x),I=x>=0?"+":"-",S=Math.floor(T/(1e3*60*60*24)),R=Math.floor(T%(1e3*60*60*24)/(1e3*60*60)),E=Math.floor(T%(1e3*60*60)/(1e3*60)),M=[];return S>0&&M.push(`${S}d`),R>0&&M.push(`${R}h`),E>0&&M.push(`${E}m`),`${I}${M.join(" ")}`},f=()=>{a("confirm",{shouldShift:l.value==="shift",timeDelta:u.value})},y=()=>{a("cancel")};return(x,T)=>(m(),rt(Ut,{show:e.show,title:`Shift ${z(o).checkpoint} Times?`,size:"medium",onClose:y},{actions:nt(()=>[c("button",{type:"button",onClick:y,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:f,class:"btn btn-primary"},b(l.value==="shift"?"Shift Times":"Keep Times"),1)]),default:nt(()=>[c("div",JP,[c("p",XP," You've changed the event date/time. Some "+b(z(i).checkpoints)+" have custom times set. ",1),c("div",QP,[T[2]||(T[2]=c("strong",null,"Event time change:",-1)),c("div",e4," Old: "+b(h(e.oldEventDate)),1),c("div",t4," New: "+b(h(e.newEventDate)),1),c("div",n4," Delta: "+b(p(u.value)),1)]),c("p",o4,[c("strong",null,b(e.affectedCheckpointsCount)+" "+b(e.affectedCheckpointsCount===1?z(i).checkpoint:z(i).checkpoints),1),T[3]||(T[3]=Ze(" with custom times will be shifted by the same amount. ",-1))]),c("div",s4,[c("label",i4,[je(c("input",{"onUpdate:modelValue":T[0]||(T[0]=I=>l.value=I),type:"radio",value:"shift",name:"shift-option"},null,512),[[Cd,l.value]]),c("div",null,[c("strong",null,"Shift all "+b(z(i).checkpoint)+" times",1),T[4]||(T[4]=c("small",null,"Recommended: Maintains relative timing",-1))])]),c("label",a4,[je(c("input",{"onUpdate:modelValue":T[1]||(T[1]=I=>l.value=I),type:"radio",value:"keep",name:"shift-option"},null,512),[[Cd,l.value]]),c("div",null,[c("strong",null,"Keep "+b(z(i).checkpoint)+" times unchanged",1),c("small",null,b(z(o).checkpoint)+" times will stay at their current values",1)])])])])]),_:1},8,["show","title"]))}},l4=Je(r4,[["__scopeId","data-v-0e706cff"]]),c4={key:0,class:"tab-content"},u4={class:"form-group"},d4=["disabled"],h4={class:"form-group"},f4={key:1,class:"tab-content"},p4={class:"boundary-section"},v4={class:"boundary-actions"},m4={key:2,class:"tab-content"},g4={class:"section-title"},y4={class:"contacts-actions"},_4={key:0,class:"area-contacts-list"},k4=["onClick"],b4={class:"contact-info"},w4={key:0,class:"contact-role-badge"},C4={key:1,class:"contact-details"},L4={key:0},S4={key:1},x4={key:3,class:"tab-content"},T4={class:"section-title"},I4={key:0,class:"empty-state"},$4={key:1,class:"checkpoints-list"},M4=["onClick"],A4={class:"checkpoint-header"},E4=["innerHTML"],P4={class:"checkpoint-name-section"},D4={key:0,class:"checkpoint-description"},O4={class:"checkpoint-stats"},R4={class:"checkpoint-details"},B4={class:"detail-row with-pills"},N4={class:"detail-label"},F4={class:"detail-value"},U4={key:0,class:"warning-text"},z4={key:0,class:"marshal-pills"},H4={class:"detail-row"},V4={class:"detail-value"},G4={key:0,class:"detail-row"},Z4={key:1,class:"detail-row"},j4={key:4,class:"placeholder-message"},W4={key:6,class:"placeholder-message"},q4={key:8,class:"placeholder-message"},K4={key:9,class:"tab-content appearance-tab"},Y4={class:"accordion-item"},J4=["innerHTML"],X4={class:"accordion-title"},Q4={class:"accordion-arrow"},e3={key:0,class:"accordion-content"},t3={class:"section-description"},n3={class:"color-picker"},o3=["title","onClick"],s3={class:"accordion-item"},i3=["innerHTML"],a3={class:"accordion-title"},r3={class:"accordion-arrow"},l3={key:0,class:"accordion-content"},c3={class:"section-description"},u3={class:"accordion-item"},d3={class:"accordion-title"},h3={class:"accordion-preview"},f3={class:"accordion-arrow"},p3={key:0,class:"accordion-content"},v3={class:"section-description"},m3={class:"form-group"},g3={value:""},y3=["value"],_3={class:"accordion-item"},k3={class:"accordion-title"},b3={class:"accordion-preview"},w3={class:"accordion-arrow"},C3={key:0,class:"accordion-content"},L3={class:"section-description"},S3={class:"form-group"},x3={value:""},T3=["value"],I3={class:"custom-footer"},$3={key:1},gh="edit_area_accordion",M3={__name:"EditAreaModal",props:{show:{type:Boolean,default:!1},area:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["close","save","delete","draw-boundary","update:isDirty","select-checkpoint","add-area-contact","edit-contact"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=()=>S.value.peopleTerm?S.value.peopleTerm:h.eventPeopleTerm||"Marshals",a=(O=!0)=>{const B=S.value.checkpointTerm||h.eventCheckpointTerm||"Checkpoints",K=s();return O?Ap("checkpoint",B,K):Ks("checkpoint",B,K)},l=(O=!0)=>a(O).toLowerCase(),u=O=>O.resolvedPeopleTerm?O.resolvedPeopleTerm:O.peopleTerm?O.peopleTerm:S.value.peopleTerm?S.value.peopleTerm:h.eventPeopleTerm||"Marshals",h=e,p=t,f=D("details"),y=D(null),x=D([]),T=D({}),I=D({}),S=D({name:"",description:"",color:Or,displayOrder:0,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),R=()=>h.eventId?`${gh}_${h.eventId}`:gh,E=D({polygonColor:!1,iconStyle:!1,peopleTerm:!1,checkpointTerm:!1});un(()=>{const O=localStorage.getItem(R());if(O)try{const B=JSON.parse(O);E.value={...E.value,...B}}catch{}});const M=O=>{E.value[O]=!E.value[O],localStorage.setItem(R(),JSON.stringify(E.value))},_=X(()=>`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <polygon points="4,8 7,3 14,2 20,5 22,12 19,18 12,21 5,19 2,14" fill="${S.value.color||Or}" stroke="#fff" stroke-width="1.5" opacity="0.8"/>
  </svg>`),$=X(()=>{const O=S.value.checkpointStyleType!=="default"||S.value.checkpointStyleBackgroundShape||S.value.checkpointStyleBackgroundColor||S.value.checkpointStyleBorderColor||S.value.checkpointStyleIconColor||S.value.checkpointStyleSize,B=h.eventDefaultStyleType!=="default"||h.eventDefaultStyleBackgroundShape||h.eventDefaultStyleBackgroundColor||h.eventDefaultStyleColor||h.eventDefaultStyleBorderColor||h.eventDefaultStyleIconColor||h.eventDefaultStyleSize;if(!O&&!B)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="areaDefaultGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981"/>
          <stop offset="50%" style="stop-color:#F59E0B"/>
          <stop offset="100%" style="stop-color:#EF4444"/>
        </linearGradient>
      </defs>
      <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#areaDefaultGrad)" stroke="#fff" stroke-width="1.5"/>
    </svg>`;const K=S.value.checkpointStyleType&&S.value.checkpointStyleType!=="default"?S.value.checkpointStyleType:h.eventDefaultStyleType&&h.eventDefaultStyleType!=="default"?h.eventDefaultStyleType:"default",ye=S.value.checkpointStyleBackgroundShape||h.eventDefaultStyleBackgroundShape||"circle",$e=S.value.checkpointStyleBackgroundColor||h.eventDefaultStyleBackgroundColor||h.eventDefaultStyleColor||"#667eea",we=S.value.checkpointStyleBorderColor||h.eventDefaultStyleBorderColor||"#ffffff",Ne=S.value.checkpointStyleIconColor||h.eventDefaultStyleIconColor||"#ffffff",Fe=S.value.checkpointStyleSize||h.eventDefaultStyleSize||"100";return Jt({type:K!=="default"?K:ye,backgroundShape:ye,backgroundColor:$e,borderColor:we,iconColor:Ne,size:Fe,outputSize:24})}),k=X(()=>h.area&&h.area.id),w=X(()=>[{value:"details",label:"Details",icon:"details"},{value:"boundary",label:"Boundary",icon:"area"},{value:"contacts",label:"Contacts",icon:"marshal"},{value:"checkpoints",label:a(),icon:"checkpoint"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}]),A=X(()=>w.value.findIndex(O=>O.value===f.value)),ne=X(()=>A.value===w.value.length-1),ae=X(()=>ne.value?null:w.value[A.value+1]),_e=X(()=>ne.value?`Create ${i.value.area}`:`Add ${ae.value.label.toLowerCase()}...`),re=X(()=>{if(!h.area||!h.area.id)return[];const O=h.checkpoints.filter(B=>B.areaIds&&B.areaIds.includes(h.area.id)).map(B=>B.id);return h.assignments.filter(B=>O.includes(B.locationId))}),ve=X(()=>!h.area||!h.area.id?[]:h.checkpoints.filter(O=>O.areaIds&&O.areaIds.includes(h.area.id))),Ie=X(()=>{const O=[...ve.value];return O.sort((B,K)=>{const ye=B.name.match(/^(\d+)/),$e=K.name.match(/^(\d+)/);if(ye&&$e){const we=parseInt(ye[1]),Ne=parseInt($e[1]);if(we!==Ne)return we-Ne}return B.name.localeCompare(K.name,void 0,{numeric:!0,sensitivity:"base"})}),O}),Re=X(()=>!h.area||!h.area.id?[]:h.contacts.filter(O=>O.scopeConfigurations?O.scopeConfigurations.some(B=>B.scope==="EveryoneInAreas"&&B.itemType==="Area"?B.ids?.includes("ALL_AREAS")?!0:B.ids?.includes(h.area.id):!1):!1)),xe=O=>h.assignments.filter(B=>B.locationId===O),he=O=>[...xe(O)].sort((K,ye)=>(K.marshalName||"").localeCompare(ye.marshalName||"",void 0,{sensitivity:"base"})),Q=O=>xe(O.id).filter(K=>K.isCheckedIn).length,J=O=>{const B=xe(O.id);if(B.length===0)return"status-none";const K=B.filter(ye=>ye.isCheckedIn).length;return K===0?"status-none":K===B.length?"status-complete":"status-partial"},ue=O=>{const B=xe(O.id),K=u(O).toLowerCase();if(B.length===0)return`No ${K}`;const ye=B.filter($e=>$e.isCheckedIn).length;return ye===0?"Not checked in":ye===B.length?"Fully checked in":`Partially checked in (${ye}/${B.length})`},te=O=>{const B=T.value[O];return!B||B.total===0?"":B.completed===B.total?"status-complete":B.completed===0?"status-none":"status-partial"},ke=O=>{const B=T.value[O];return B?B.total===0?"No tasks":B.completed===B.total?"All tasks completed":`${B.completed}/${B.total} completed`:""},Oe=async O=>{if(!(T.value[O]||I.value[O])){I.value[O]=!0;try{const K=(await Et.getCheckpointChecklist(h.eventId,O)).data||[];T.value[O]={total:K.length,completed:K.filter(ye=>ye.isCompleted).length}}catch(B){console.error("Failed to load checklist status for checkpoint:",O,B),T.value[O]={total:0,completed:0}}finally{I.value[O]=!1}}};We(()=>h.area,O=>{if(O){const B=O.polygon?typeof O.polygon=="string"?JSON.parse(O.polygon):O.polygon:[];S.value={name:O.name||"",description:O.description||"",color:O.color||Or,displayOrder:O.displayOrder||0,isDefault:O.isDefault||!1,polygon:B,checkpointStyleType:O.checkpointStyleType||"default",checkpointStyleColor:O.checkpointStyleColor||"",checkpointStyleBackgroundShape:O.checkpointStyleBackgroundShape||"",checkpointStyleBackgroundColor:O.checkpointStyleBackgroundColor||"",checkpointStyleBorderColor:O.checkpointStyleBorderColor||"",checkpointStyleIconColor:O.checkpointStyleIconColor||"",checkpointStyleSize:O.checkpointStyleSize||"",checkpointStyleMapRotation:O.checkpointStyleMapRotation??"",peopleTerm:O.peopleTerm||"",checkpointTerm:O.checkpointTerm||""}}else S.value={name:"",description:"",color:fh(h.areas),displayOrder:h.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}},{immediate:!0,deep:!0}),We(()=>h.show,O=>{O&&(f.value="details",x.value=[],T.value={},I.value={},k.value||(S.value={name:"",description:"",color:fh(h.areas),displayOrder:h.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),y.value?.resetLocalState&&y.value.resetLocalState())}),We(f,O=>{O==="checkpoints"&&h.area&&h.area.id&&ve.value.forEach(B=>{setTimeout(()=>Oe(B.id),0)})});const oe=()=>{p("update:isDirty",!0)},Ee=O=>{S.value.color=O,oe()},be=(O,B)=>{S.value[O]=B,oe()},Se=()=>{p("draw-boundary",S.value)},le=()=>{S.value.polygon=[],oe()},pe=()=>{p("add-area-contact",h.area)},q=O=>O?O.replace(/([A-Z])/g," $1").replace(/^./,B=>B.toUpperCase()).trim():"",fe=O=>{x.value=O,oe()},Le=()=>{k.value||ne.value?F():f.value=ae.value.value},F=()=>{const O=h.area?{name:S.value.name,description:S.value.description,color:S.value.color,polygon:S.value.polygon.length>0?S.value.polygon:null,displayOrder:S.value.displayOrder,checkpointStyleType:S.value.checkpointStyleType,checkpointStyleColor:S.value.checkpointStyleColor,checkpointStyleBackgroundShape:S.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:S.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:S.value.checkpointStyleBorderColor,checkpointStyleIconColor:S.value.checkpointStyleIconColor,checkpointStyleSize:S.value.checkpointStyleSize,checkpointStyleMapRotation:S.value.checkpointStyleMapRotation!=null&&S.value.checkpointStyleMapRotation!==""?String(S.value.checkpointStyleMapRotation):null,peopleTerm:S.value.peopleTerm,checkpointTerm:S.value.checkpointTerm,checklistChanges:x.value||[]}:{name:S.value.name,description:S.value.description,color:S.value.color,polygon:S.value.polygon.length>0?S.value.polygon:null,checkpointStyleType:S.value.checkpointStyleType,checkpointStyleColor:S.value.checkpointStyleColor,checkpointStyleBackgroundShape:S.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:S.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:S.value.checkpointStyleBorderColor,checkpointStyleIconColor:S.value.checkpointStyleIconColor,checkpointStyleSize:S.value.checkpointStyleSize,checkpointStyleMapRotation:S.value.checkpointStyleMapRotation!=null&&S.value.checkpointStyleMapRotation!==""?String(S.value.checkpointStyleMapRotation):null,peopleTerm:S.value.peopleTerm,checkpointTerm:S.value.checkpointTerm};p("save",O)},G=()=>{p("delete",h.area.id)},W=()=>{p("close")},j=O=>{const B=O.resolvedStyleType||O.ResolvedStyleType,K=O.resolvedStyleBackgroundColor||O.ResolvedStyleBackgroundColor||O.resolvedStyleColor||O.ResolvedStyleColor,ye=O.resolvedStyleBorderColor||O.ResolvedStyleBorderColor,$e=O.resolvedStyleIconColor||O.ResolvedStyleIconColor,we=O.resolvedStyleBackgroundShape||O.ResolvedStyleBackgroundShape;return B&&B!=="default"||K||ye||$e||we&&we!=="circle"?Jt({type:B||"circle",backgroundShape:we||"circle",backgroundColor:K||"#667eea",borderColor:ye||"#ffffff",iconColor:$e||"#ffffff",size:"75",outputSize:20}):`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
    <circle cx="10" cy="10" r="8" fill="#667eea" stroke="#fff" stroke-width="1.5"/>
  </svg>`};return(O,B)=>(m(),rt(Ut,{show:e.show,title:e.area&&e.area.id?`Edit ${z(i).area}: ${e.area.name}`:`Create new ${z(i).area}`,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:W},{"tab-header":nt(()=>[ze(hu,{modelValue:f.value,"onUpdate:modelValue":B[0]||(B[0]=K=>f.value=K),tabs:w.value},null,8,["modelValue","tabs"])]),footer:nt(()=>[c("div",I3,[k.value&&!S.value.isDefault?(m(),g("button",{key:0,type:"button",onClick:G,class:"btn btn-danger"}," Delete "+b(z(i).area),1)):(m(),g("div",$3)),c("button",{type:"button",onClick:Le,class:"btn btn-primary"},b(k.value?"Save changes":_e.value),1)])]),default:nt(()=>[f.value==="details"?(m(),g("div",c4,[c("form",{onSubmit:vt(F,["prevent"])},[c("div",u4,[B[18]||(B[18]=c("label",null,"Name *",-1)),je(c("input",{"onUpdate:modelValue":B[1]||(B[1]=K=>S.value.name=K),type:"text",required:"",class:"form-input",disabled:S.value.isDefault,onInput:oe},null,40,d4),[[ut,S.value.name]])]),c("div",h4,[B[19]||(B[19]=c("label",null,"Description",-1)),je(c("textarea",{"onUpdate:modelValue":B[2]||(B[2]=K=>S.value.description=K),class:"form-input",rows:"3",onInput:oe},null,544),[[ut,S.value.description]])])],32)])):N("",!0),f.value==="boundary"?(m(),g("div",f4,[c("div",p4,[B[20]||(B[20]=c("div",{class:"instructions-card"},[c("p",null,[c("strong",null,"Draw a polygon on the map to define this area's boundary")]),c("p",null,' Click "Draw on Map" to activate drawing mode. Click on the map to add vertices, and double-click to complete the polygon. ')],-1)),c("div",v4,[c("button",{onClick:Se,class:"btn btn-primary btn-full"}," Draw on Map "),S.value.polygon&&S.value.polygon.length>0?(m(),g("button",{key:0,onClick:le,class:"btn btn-danger btn-full"}," Clear Boundary ")):N("",!0)])])])):N("",!0),f.value==="contacts"?(m(),g("div",m4,[c("h3",g4,b(z(o).area)+" contacts",1),c("div",y4,[c("button",{onClick:pe,class:"btn btn-primary btn-full"}," Add contact for this "+b(z(i).area),1)]),Re.value.length>0?(m(),g("div",_4,[c("h4",null,"Contacts visible in this "+b(z(i).area)+" ("+b(Re.value.length)+")",1),(m(!0),g(Ce,null,Be(Re.value,K=>(m(),g("div",{key:K.contactId,class:"contact-item",onClick:ye=>O.$emit("edit-contact",K)},[c("div",b4,[c("strong",null,b(K.name),1),K.role?(m(),g("span",w4,b(q(K.role)),1)):N("",!0),K.phone||K.email?(m(),g("div",C4,[K.phone?(m(),g("span",L4,b(K.phone),1)):N("",!0),K.email?(m(),g("span",S4,b(K.email),1)):N("",!0)])):N("",!0)])],8,k4))),128))])):N("",!0)])):N("",!0),f.value==="checkpoints"&&k.value?(m(),g("div",x4,[c("h3",T4,b(a())+" in "+b(e.area?.name)+" ("+b(ve.value.length)+")",1),ve.value.length===0?(m(),g("div",I4,[c("p",null,"No "+b(l())+" in this "+b(z(i).area)+" yet.",1)])):(m(),g("div",$4,[(m(!0),g(Ce,null,Be(Ie.value,K=>(m(),g("div",{key:K.id,class:"checkpoint-card",onClick:ye=>O.$emit("select-checkpoint",K)},[c("div",A4,[c("span",{class:"checkpoint-icon",innerHTML:j(K)},null,8,E4),c("div",P4,[c("h4",null,[Ze(b(K.name),1),K.description?(m(),g("span",D4," - "+b(K.description),1)):N("",!0)])]),c("div",O4,[c("div",{class:Te(["stat-badge",J(K)])},b(ue(K)),3)])]),c("div",R4,[c("div",B4,[c("span",N4,b(u(K))+":",1),c("span",F4,[Ze(b(xe(K.id).length)+" / "+b(K.requiredMarshals)+" ",1),xe(K.id).length<K.requiredMarshals?(m(),g("span",U4," ("+b(K.requiredMarshals-xe(K.id).length)+" needed) ",1)):N("",!0)]),xe(K.id).length>0?(m(),g("div",z4,[(m(!0),g(Ce,null,Be(he(K.id),ye=>(m(),g("span",{key:ye.id,class:Te(["marshal-pill",{"checked-in":ye.isCheckedIn}])},b(ye.marshalName),3))),128))])):N("",!0)]),c("div",H4,[B[21]||(B[21]=c("span",{class:"detail-label"},"Checked in:",-1)),c("span",V4,b(Q(K))+" / "+b(xe(K.id).length),1)]),T.value[K.id]?(m(),g("div",G4,[B[22]||(B[22]=c("span",{class:"detail-label"},"Tasks:",-1)),c("span",{class:Te(["detail-value",te(K.id)])},b(ke(K.id)),3)])):I.value[K.id]?(m(),g("div",Z4,[...B[23]||(B[23]=[c("span",{class:"detail-label"},"Tasks:",-1),c("span",{class:"detail-value loading-text"},"Loading...",-1)])])):N("",!0)])],8,M4))),128))]))])):N("",!0),f.value==="checkpoints"&&!k.value?(m(),g("div",j4,[c("p",null,b(a())+" will be automatically assigned based on boundaries after the "+b(z(i).area)+" is created.",1)])):N("",!0),f.value==="checklists"&&k.value?(m(),rt(Up,{key:5,ref_key:"checklistTabRef",ref:y,modelValue:x.value,"onUpdate:modelValue":B[3]||(B[3]=K=>x.value=K),"event-id":e.eventId,"area-id":e.area.id,locations:e.allLocations,areas:e.areas,assignments:re.value,onChange:fe},null,8,["modelValue","event-id","area-id","locations","areas","assignments"])):N("",!0),f.value==="checklists"&&!k.value?(m(),g("div",W4,[c("p",null,b(z(o).checklists)+" can be assigned after the "+b(z(i).area)+" is created.",1)])):N("",!0),f.value==="notes"&&k.value?(m(),rt(bl,{key:7,"event-id":e.eventId,"area-id":e.area?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","area-id","all-notes","locations","areas","assignments"])):N("",!0),f.value==="notes"&&!k.value?(m(),g("div",q4,[c("p",null,"Notes can be viewed after the "+b(z(i).area)+" is created.",1)])):N("",!0),f.value==="appearance"?(m(),g("div",K4,[c("div",Y4,[c("button",{type:"button",class:Te(["accordion-header",{expanded:E.value.polygonColor}]),onClick:B[4]||(B[4]=K=>M("polygonColor"))},[c("div",{class:"accordion-icon",innerHTML:_.value},null,8,J4),c("span",X4,b(z(o).area)+" polygon colour",1),c("span",Q4,b(E.value.polygonColor?"":""),1)],2),E.value.polygonColor?(m(),g("div",e3,[c("p",t3," Choose a colour for this "+b(z(i).area)+"'s boundary on the map. ",1),c("div",n3,[(m(!0),g(Ce,null,Be(z(Pn),K=>(m(),g("div",{key:K.hex,class:Te(["color-swatch",{selected:S.value.color===K.hex}]),style:at({backgroundColor:K.hex}),title:K.name,onClick:ye=>Ee(K.hex)},null,14,o3))),128))])])):N("",!0)]),c("div",s3,[c("button",{type:"button",class:Te(["accordion-header",{expanded:E.value.iconStyle}]),onClick:B[5]||(B[5]=K=>M("iconStyle"))},[c("div",{class:"accordion-icon",innerHTML:$.value},null,8,i3),c("span",a3,b(a(!1))+" marker style",1),c("span",r3,b(E.value.iconStyle?"":""),1)],2),E.value.iconStyle?(m(),g("div",l3,[c("p",c3," Set a default marker style for all "+b(l())+" in this "+b(z(i).area)+". Individual "+b(l())+" can override this setting. ",1),ze(du,{"style-type":S.value.checkpointStyleType||"default","style-color":S.value.checkpointStyleColor||"","style-background-shape":S.value.checkpointStyleBackgroundShape||"","style-background-color":S.value.checkpointStyleBackgroundColor||"","style-border-color":S.value.checkpointStyleBorderColor||"","style-icon-color":S.value.checkpointStyleIconColor||"","style-size":S.value.checkpointStyleSize||"","style-map-rotation":S.value.checkpointStyleMapRotation??"","inherited-style-type":e.eventDefaultStyleType,"inherited-style-color":e.eventDefaultStyleColor,"inherited-background-shape":e.eventDefaultStyleBackgroundShape||"","inherited-background-color":e.eventDefaultStyleBackgroundColor||e.eventDefaultStyleColor||"","inherited-border-color":e.eventDefaultStyleBorderColor||"","inherited-icon-color":e.eventDefaultStyleIconColor||"","inherited-size":e.eventDefaultStyleSize||"","inherited-map-rotation":e.eventDefaultStyleMapRotation??"","default-label":"Event default","icon-label":"Marker style",level:"area","show-preview":!0,"onUpdate:styleType":B[6]||(B[6]=K=>be("checkpointStyleType",K)),"onUpdate:styleColor":B[7]||(B[7]=K=>be("checkpointStyleColor",K)),"onUpdate:styleBackgroundShape":B[8]||(B[8]=K=>be("checkpointStyleBackgroundShape",K)),"onUpdate:styleBackgroundColor":B[9]||(B[9]=K=>be("checkpointStyleBackgroundColor",K)),"onUpdate:styleBorderColor":B[10]||(B[10]=K=>be("checkpointStyleBorderColor",K)),"onUpdate:styleIconColor":B[11]||(B[11]=K=>be("checkpointStyleIconColor",K)),"onUpdate:styleSize":B[12]||(B[12]=K=>be("checkpointStyleSize",K)),"onUpdate:styleMapRotation":B[13]||(B[13]=K=>be("checkpointStyleMapRotation",K))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])])):N("",!0)]),c("div",u3,[c("button",{type:"button",class:Te(["accordion-header",{expanded:E.value.peopleTerm}]),onClick:B[14]||(B[14]=K=>M("peopleTerm"))},[B[24]||(B[24]=c("div",{class:"accordion-icon"},[c("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[c("circle",{cx:"12",cy:"8",r:"4",fill:"#6366F1"}),c("path",{d:"M4 20c0-4.4 3.6-8 8-8s8 3.6 8 8",fill:"#6366F1",opacity:"0.6"})])],-1)),c("span",d3,b(s())+" terminology",1),c("span",h3,b(S.value.peopleTerm||`${e.eventPeopleTerm} (event default)`),1),c("span",f3,b(E.value.peopleTerm?"":""),1)],2),E.value.peopleTerm?(m(),g("div",p3,[c("p",v3," Choose what "+b(s().toLowerCase())+" are called in this "+b(z(i).area)+". This will be inherited by "+b(l())+" unless they override it. ",1),c("div",m3,[B[25]||(B[25]=c("label",null,"What are people called?",-1)),je(c("select",{"onUpdate:modelValue":B[15]||(B[15]=K=>S.value.peopleTerm=K),class:"form-input",onChange:oe},[c("option",g3,"Use event default ("+b(e.eventPeopleTerm)+")",1),(m(!0),g(Ce,null,Be(z(qo).people,K=>(m(),g("option",{key:K,value:K},b(K),9,y3))),128))],544),[[Sn,S.value.peopleTerm]])])])):N("",!0)]),c("div",_3,[c("button",{type:"button",class:Te(["accordion-header",{expanded:E.value.checkpointTerm}]),onClick:B[16]||(B[16]=K=>M("checkpointTerm"))},[B[26]||(B[26]=c("div",{class:"accordion-icon"},[c("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[c("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z",fill:"#10B981"}),c("circle",{cx:"12",cy:"9",r:"2.5",fill:"white"})])],-1)),c("span",k3,b(a(!1))+" terminology",1),c("span",b3,b(S.value.checkpointTerm?z(Pc)(S.value.checkpointTerm,s()):`${e.eventCheckpointTerm} (event default)`),1),c("span",w3,b(E.value.checkpointTerm?"":""),1)],2),E.value.checkpointTerm?(m(),g("div",C3,[c("p",L3," Choose what "+b(l())+" are called in this "+b(z(i).area)+". ",1),c("div",S3,[c("label",null,"What are "+b(l())+" called?",1),je(c("select",{"onUpdate:modelValue":B[17]||(B[17]=K=>S.value.checkpointTerm=K),class:"form-input",onChange:oe},[c("option",x3,"Use event default ("+b(e.eventCheckpointTerm)+")",1),(m(!0),g(Ce,null,Be(z(qo).checkpoint,K=>(m(),g("option",{key:K,value:K},b(z(Pc)(K,s())),9,T3))),128))],544),[[Sn,S.value.checkpointTerm]])])])):N("",!0)])])):N("",!0)]),_:1},8,["show","title","is-dirty"]))}},A3=Je(M3,[["__scopeId","data-v-e290afaa"]]),E3=["innerHTML"],P3={__name:"InfoModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Information"},message:{type:String,required:!0},okText:{type:String,default:"OK"}},emits:["close"],setup(e,{emit:t}){const o=t,i=()=>{o("close")};return(s,a)=>(m(),rt(Ut,{show:e.show,title:e.title,size:"small","z-index":2e3,onClose:i},{actions:nt(()=>[c("button",{onClick:i,class:"btn btn-primary"},b(e.okText),1)]),default:nt(()=>[c("div",{class:"info-content",innerHTML:e.message},null,8,E3)]),_:1},8,["show","title"]))}},wl=Je(P3,[["__scopeId","data-v-319bcdc8"]]),D3={class:"tab-headers"},O3={class:"tab-content"},R3={class:"form-group"},B3=["placeholder"],N3={key:0,class:"checkbox-label-inline create-separate-items"},F3={class:"tab-content"},U3={class:"custom-footer"},z3={__name:"EditChecklistItemModal",props:{show:{type:Boolean,default:!1},checklistItem:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=D(!1),a=D(""),l=D("details"),u=D({text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0}),h=X(()=>!!o.checklistItem);We(()=>o.show,E=>{E&&(l.value=o.initialTab,o.checklistItem?u.value={text:o.checklistItem.text||"",scopeConfigurations:o.checklistItem.scopeConfigurations?JSON.parse(JSON.stringify(o.checklistItem.scopeConfigurations)):[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:o.checklistItem.displayOrder||0,isRequired:o.checklistItem.isRequired!==!1,visibleFrom:o.checklistItem.visibleFrom?p(o.checklistItem.visibleFrom):null,visibleUntil:o.checklistItem.visibleUntil?p(o.checklistItem.visibleUntil):null,mustCompleteBy:o.checklistItem.mustCompleteBy?p(o.checklistItem.mustCompleteBy):null,createSeparateItems:!1}:u.value={text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0},i("update:isDirty",!1))});const p=E=>{if(!E)return null;const M=new Date(E),_=M.getTimezoneOffset();return new Date(M.getTime()-_*60*1e3).toISOString().slice(0,16)},f=E=>E?new Date(E).toISOString():null,y=()=>{i("update:isDirty",!0)},x=()=>{i("close")},T=()=>{l.value="visibility"},I=E=>{a.value=E,s.value=!0},S=()=>{if(!u.value.text||!u.value.text.trim()){I("Please enter checklist item text");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){I("Please select at least one scope");return}if(!u.value.scopeConfigurations.some(_=>!(_.itemType!==null&&(!_.ids||_.ids.length===0)))){I("Please configure at least one scope with valid selections");return}const M={text:u.value.text,scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,isRequired:u.value.isRequired,visibleFrom:f(u.value.visibleFrom),visibleUntil:f(u.value.visibleUntil),mustCompleteBy:f(u.value.mustCompleteBy)};h.value||(M.createSeparateItems=u.value.createSeparateItems),i("save",M)},R=()=>{i("delete",o.checklistItem.itemId)};return(E,M)=>(m(),g(Ce,null,[ze(Ut,{show:e.show,title:h.value?"Edit checklist item":"Create checklist item",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:x},{footer:nt(()=>[c("div",U3,[h.value?(m(),g("button",{key:0,type:"button",onClick:R,class:"btn btn-danger"}," Delete ")):N("",!0),!h.value&&l.value==="details"?(m(),g("button",{key:1,type:"button",onClick:T,class:"btn btn-primary"}," Next ")):N("",!0),h.value||l.value==="visibility"?(m(),g("button",{key:2,type:"button",onClick:S,class:"btn btn-primary"},b(h.value?"Save changes":"Create"),1)):N("",!0)])]),default:nt(()=>[c("div",D3,[c("button",{type:"button",class:Te(["tab-header",{active:l.value==="details"}]),onClick:M[0]||(M[0]=_=>l.value="details")}," Details ",2),c("button",{type:"button",class:Te(["tab-header",{active:l.value==="visibility"}]),onClick:M[1]||(M[1]=_=>l.value="visibility")}," Visibility ",2)]),c("form",{onSubmit:vt(S,["prevent"]),class:"checklist-form"},[je(c("div",O3,[c("div",R3,[M[7]||(M[7]=c("label",{for:"text"},"Checklist text: *",-1)),je(c("textarea",{id:"text","onUpdate:modelValue":M[2]||(M[2]=_=>u.value.text=_),onInput:y,required:"",rows:"3",placeholder:u.value.createSeparateItems?"Enter checklist items, one per line...":"Enter the checklist item text..."},null,40,B3),[[ut,u.value.text]]),h.value?N("",!0):(m(),g("label",N3,[je(c("input",{type:"checkbox","onUpdate:modelValue":M[3]||(M[3]=_=>u.value.createSeparateItems=_),onChange:y},null,544),[[ws,u.value.createSeparateItems]]),M[6]||(M[6]=c("span",null,"Each line creates a new item",-1))]))])],512),[[Is,l.value==="details"]]),je(c("div",F3,[ze(kl,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":M[4]||(M[4]=_=>u.value.scopeConfigurations=_),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":h.value,onUserChanged:y},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[Is,l.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),ze(wl,{show:s.value,title:"Validation error",message:a.value,onClose:M[5]||(M[5]=_=>s.value=!1)},null,8,["show","message"])],64))}},H3=Je(z3,[["__scopeId","data-v-bb89c7c7"]]),V3={class:"tab-headers"},G3={class:"tab-content"},Z3={class:"form-group"},j3={class:"form-group"},W3={class:"form-row"},q3={class:"form-group"},K3={class:"form-group"},Y3={class:"form-row"},J3={class:"form-group"},X3={class:"form-group checkbox-group-inline"},Q3={class:"checkbox-label-inline"},eD={class:"tab-content"},tD={class:"custom-footer"},nD={__name:"EditNoteModal",props:{show:{type:Boolean,default:!1},note:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=D(!1),a=D(""),l=D("details"),u=D({title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1}),h=X(()=>!!o.note);We(()=>o.show,S=>{S&&(l.value=o.initialTab,o.note?u.value={title:o.note.title||"",content:o.note.content||"",scopeConfigurations:o.note.scopeConfigurations?JSON.parse(JSON.stringify(o.note.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:o.note.displayOrder||0,priority:o.note.priority||"Normal",category:o.note.category||"",isPinned:o.note.isPinned||!1}:u.value={title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1},i("update:isDirty",!1))});const p=()=>{i("update:isDirty",!0)},f=()=>{i("close")},y=()=>{l.value="visibility"},x=S=>{a.value=S,s.value=!0},T=()=>{if(!u.value.title||!u.value.title.trim()){x("Please enter a note title");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){x("Please select at least one visibility scope");return}if(!u.value.scopeConfigurations.some(E=>!(E.itemType!==null&&(!E.ids||E.ids.length===0)))){x("Please configure at least one scope with valid selections");return}const R={title:u.value.title.trim(),content:u.value.content||"",scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,priority:u.value.priority||"Normal",category:u.value.category?.trim()||null,isPinned:u.value.isPinned||!1};i("save",R)},I=()=>{i("delete",o.note.noteId)};return(S,R)=>(m(),g(Ce,null,[ze(Ut,{show:e.show,title:h.value?"Edit note":"Create note",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:f},{footer:nt(()=>[c("div",tD,[h.value?(m(),g("button",{key:0,type:"button",onClick:I,class:"btn btn-danger"}," Delete ")):N("",!0),!h.value&&l.value==="details"?(m(),g("button",{key:1,type:"button",onClick:y,class:"btn btn-primary"}," Next ")):N("",!0),h.value||l.value==="visibility"?(m(),g("button",{key:2,type:"button",onClick:T,class:"btn btn-primary"},b(h.value?"Save changes":"Create"),1)):N("",!0)])]),default:nt(()=>[c("div",V3,[c("button",{type:"button",class:Te(["tab-header",{active:l.value==="details"}]),onClick:R[0]||(R[0]=E=>l.value="details")}," Details ",2),c("button",{type:"button",class:Te(["tab-header",{active:l.value==="visibility"}]),onClick:R[1]||(R[1]=E=>l.value="visibility")}," Visibility ",2)]),c("form",{onSubmit:vt(T,["prevent"]),class:"note-form"},[je(c("div",G3,[c("div",Z3,[R[10]||(R[10]=c("label",{for:"title"},"Title: *",-1)),je(c("input",{id:"title","onUpdate:modelValue":R[2]||(R[2]=E=>u.value.title=E),type:"text",onInput:p,required:"",placeholder:"Enter note title..."},null,544),[[ut,u.value.title]])]),c("div",j3,[R[11]||(R[11]=c("label",{for:"content"},"Content:",-1)),je(c("textarea",{id:"content","onUpdate:modelValue":R[3]||(R[3]=E=>u.value.content=E),onInput:p,rows:"6",placeholder:"Enter note content (supports markdown)..."},null,544),[[ut,u.value.content]])]),c("div",W3,[c("div",q3,[R[13]||(R[13]=c("label",{for:"priority"},"Priority:",-1)),je(c("select",{id:"priority","onUpdate:modelValue":R[4]||(R[4]=E=>u.value.priority=E),onChange:p},[...R[12]||(R[12]=[c("option",{value:"Emergency"},"Emergency",-1),c("option",{value:"Urgent"},"Urgent",-1),c("option",{value:"High"},"High",-1),c("option",{value:"Normal"},"Normal",-1),c("option",{value:"Low"},"Low",-1)])],544),[[Sn,u.value.priority]])]),c("div",K3,[R[14]||(R[14]=c("label",{for:"category"},"Category:",-1)),je(c("input",{id:"category","onUpdate:modelValue":R[5]||(R[5]=E=>u.value.category=E),type:"text",onInput:p,placeholder:"e.g., Safety, Logistics..."},null,544),[[ut,u.value.category]])])]),c("div",Y3,[c("div",J3,[R[15]||(R[15]=c("label",{for:"displayOrder"},"Display order:",-1)),je(c("input",{id:"displayOrder","onUpdate:modelValue":R[6]||(R[6]=E=>u.value.displayOrder=E),type:"number",onInput:p,min:"0"},null,544),[[ut,u.value.displayOrder,void 0,{number:!0}]]),R[16]||(R[16]=c("span",{class:"help-text"},"Lower numbers appear first",-1))]),c("div",X3,[c("label",Q3,[je(c("input",{type:"checkbox","onUpdate:modelValue":R[7]||(R[7]=E=>u.value.isPinned=E),onChange:p},null,544),[[ws,u.value.isPinned]]),R[17]||(R[17]=c("span",null,"Pin to top",-1))]),R[18]||(R[18]=c("span",{class:"help-text"},"Pinned notes always appear at the top",-1))])])],512),[[Is,l.value==="details"]]),je(c("div",eD,[ze(kl,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":R[8]||(R[8]=E=>u.value.scopeConfigurations=E),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":h.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this note?",onUserChanged:p},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[Is,l.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),ze(wl,{show:s.value,title:"Validation error",message:a.value,onClose:R[9]||(R[9]=E=>s.value=!1)},null,8,["show","message"])],64))}},oD=Je(nD,[["__scopeId","data-v-1a34c03e"]]),sD={class:"tab-headers"},iD={class:"tab-content"},aD={class:"form-group"},rD={for:"marshalId"},lD=["value"],cD={class:"help-text"},uD={class:"form-group"},dD=["disabled"],hD={class:"form-group"},fD={class:"role-input-group"},pD={key:0,label:"Built-in Roles"},vD=["value"],mD={key:1,label:"Custom Roles"},gD=["value"],yD={class:"form-row"},_D={class:"form-group"},kD={class:"form-group"},bD={class:"form-group"},wD={class:"tab-content"},CD={class:"custom-footer"},LD={__name:"EditContactModal",props:{show:{type:Boolean,default:!1},contact:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},isDirty:{type:Boolean,default:!1},preselectedArea:{type:Object,default:null}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{terms:o}=Ct(),i=e,s=t,a=D(!1),l=D(""),u=D("details"),h=D(!1),p=D({role:"",name:"",phone:"",email:"",notes:"",marshalId:null,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}),f=X(()=>!!i.contact),y=X(()=>!!p.value.marshalId),x=X(()=>[...i.marshals].sort((k,w)=>Tn(k.name,w.name)));We(()=>i.show,k=>{if(k){if(u.value=i.initialTab,i.contact){const w=[...i.availableRoles.builtInRoles||[],...i.availableRoles.customRoles||[]];h.value=i.contact.role&&!w.includes(i.contact.role),p.value={role:i.contact.role||"",name:i.contact.name||"",phone:i.contact.phone||"",email:i.contact.email||"",notes:i.contact.notes||"",marshalId:i.contact.marshalId||null,scopeConfigurations:i.contact.scopeConfigurations?JSON.parse(JSON.stringify(i.contact.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}}else{h.value=!1;const w=i.preselectedArea?[{scope:"EveryoneInAreas",itemType:"Area",ids:[i.preselectedArea.id]}]:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}];p.value={role:"",name:"",phone:"",email:"",notes:"",marshalId:null,scopeConfigurations:w}}s("update:isDirty",!1)}});const T=k=>k?k==="AreaLead"?`${o.value.area} Lead`:k.replace(/([A-Z])/g," $1").replace(/^./,w=>w.toUpperCase()).trim():"",I=()=>{s("update:isDirty",!0)},S=()=>{if(p.value.marshalId){const k=i.marshals.find(w=>w.id===p.value.marshalId);k&&(p.value.name=k.name,!p.value.phone&&k.phoneNumber&&(p.value.phone=k.phoneNumber),!p.value.email&&k.email&&(p.value.email=k.email))}I()},R=()=>{s("close")},E=()=>{if(!p.value.role||!p.value.role.trim()){M("Please select or enter a role");return}if(!p.value.name||!p.value.name.trim()){M("Please enter a contact name");return}u.value="visibility"},M=k=>{l.value=k,a.value=!0},_=()=>{if(!p.value.role||!p.value.role.trim()){M("Please select or enter a role");return}if(!p.value.name||!p.value.name.trim()){M("Please enter a contact name");return}if(!p.value.scopeConfigurations||p.value.scopeConfigurations.length===0){M("Please select at least one visibility scope");return}if(!p.value.scopeConfigurations.some(A=>!(A.itemType!==null&&(!A.ids||A.ids.length===0)))){M("Please configure at least one scope with valid selections");return}const w={role:p.value.role.trim(),name:p.value.name.trim(),phone:p.value.phone?.trim()||null,email:p.value.email?.trim()||null,notes:p.value.notes?.trim()||null,marshalId:p.value.marshalId||null,scopeConfigurations:p.value.scopeConfigurations};s("save",w)},$=()=>{s("delete",i.contact.contactId)};return(k,w)=>(m(),g(Ce,null,[ze(Ut,{show:e.show,title:f.value?"Edit contact":"Create contact",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:R},{footer:nt(()=>[c("div",CD,[f.value?(m(),g("button",{key:0,type:"button",onClick:$,class:"btn btn-danger"}," Delete ")):N("",!0),!f.value&&u.value==="details"?(m(),g("button",{key:1,type:"button",onClick:E,class:"btn btn-primary"}," Next ")):N("",!0),f.value||u.value==="visibility"?(m(),g("button",{key:2,type:"button",onClick:_,class:"btn btn-primary"},b(f.value?"Save changes":"Create"),1)):N("",!0)])]),default:nt(()=>[c("div",sD,[c("button",{type:"button",class:Te(["tab-header",{active:u.value==="details"}]),onClick:w[0]||(w[0]=A=>u.value="details")}," Details ",2),c("button",{type:"button",class:Te(["tab-header",{active:u.value==="visibility"}]),onClick:w[1]||(w[1]=A=>u.value="visibility")}," Visibility ",2)]),c("form",{onSubmit:vt(_,["prevent"]),class:"contact-form"},[je(c("div",iD,[c("div",aD,[c("label",rD,"Link to "+b(z(o).person.toLowerCase())+":",1),je(c("select",{id:"marshalId","onUpdate:modelValue":w[2]||(w[2]=A=>p.value.marshalId=A),onChange:S},[w[12]||(w[12]=c("option",{value:null},"-- Not linked --",-1)),(m(!0),g(Ce,null,Be(x.value,A=>(m(),g("option",{key:A.id,value:A.id},b(A.name),9,lD))),128))],544),[[Sn,p.value.marshalId]]),c("span",cD,"Optionally link to an existing "+b(z(o).person.toLowerCase())+" in the system",1)]),c("div",uD,[w[13]||(w[13]=c("label",{for:"name"},"Name: *",-1)),je(c("input",{id:"name","onUpdate:modelValue":w[3]||(w[3]=A=>p.value.name=A),type:"text",onInput:I,disabled:y.value,class:Te({"input-disabled":y.value}),placeholder:"Contact name..."},null,42,dD),[[ut,p.value.name]])]),c("div",hD,[w[15]||(w[15]=c("label",{for:"role"},"Role: *",-1)),c("div",fD,[h.value?je((m(),g("input",{key:1,id:"customRole","onUpdate:modelValue":w[5]||(w[5]=A=>p.value.role=A),type:"text",onInput:I,placeholder:"Enter custom role name..."},null,544)),[[ut,p.value.role]]):je((m(),g("select",{key:0,id:"role","onUpdate:modelValue":w[4]||(w[4]=A=>p.value.role=A),onChange:I},[w[14]||(w[14]=c("option",{value:"",disabled:""},"Select a role...",-1)),e.availableRoles.builtInRoles?.length>0?(m(),g("optgroup",pD,[(m(!0),g(Ce,null,Be(e.availableRoles.builtInRoles,A=>(m(),g("option",{key:A,value:A},b(T(A)),9,vD))),128))])):N("",!0),e.availableRoles.customRoles?.length>0?(m(),g("optgroup",mD,[(m(!0),g(Ce,null,Be(e.availableRoles.customRoles,A=>(m(),g("option",{key:A,value:A},b(T(A)),9,gD))),128))])):N("",!0)],544)),[[Sn,p.value.role]]),c("button",{type:"button",class:"toggle-custom-btn",onClick:w[6]||(w[6]=A=>h.value=!h.value)},b(h.value?"Use existing":"Custom"),1)])]),c("div",yD,[c("div",_D,[w[16]||(w[16]=c("label",{for:"phone"},"Phone:",-1)),je(c("input",{id:"phone","onUpdate:modelValue":w[7]||(w[7]=A=>p.value.phone=A),type:"tel",onInput:I,placeholder:"Phone number..."},null,544),[[ut,p.value.phone]])]),c("div",kD,[w[17]||(w[17]=c("label",{for:"email"},"Email:",-1)),je(c("input",{id:"email","onUpdate:modelValue":w[8]||(w[8]=A=>p.value.email=A),type:"email",onInput:I,placeholder:"Email address..."},null,544),[[ut,p.value.email]])])]),c("div",bD,[w[18]||(w[18]=c("label",{for:"notes"},"Notes / Instructions:",-1)),je(c("textarea",{id:"notes","onUpdate:modelValue":w[9]||(w[9]=A=>p.value.notes=A),onInput:I,rows:"3",placeholder:"Additional notes or instructions for when to contact..."},null,544),[[ut,p.value.notes]])])],512),[[Is,u.value==="details"]]),je(c("div",wD,[ze(kl,{modelValue:p.value.scopeConfigurations,"onUpdate:modelValue":w[10]||(w[10]=A=>p.value.scopeConfigurations=A),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":f.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this contact?",onUserChanged:I},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[Is,u.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),ze(wl,{show:a.value,title:"Validation error",message:l.value,onClose:w[11]||(w[11]=A=>a.value=!1)},null,8,["show","message"])],64))}},SD=Je(LD,[["__scopeId","data-v-62986ae5"]]),xD={key:0,class:"fullscreen-map-overlay"},TD={class:"fullscreen-map-header"},ID={class:"context-info"},$D={key:0},MD={class:"action-buttons"},AD=["disabled"],ED={class:"fullscreen-map-container"},PD={key:0,class:"drawing-controls"},DD={class:"point-count"},OD={class:"undo-redo-buttons"},RD=["disabled"],BD=["disabled"],ND=Object.assign({inheritAttrs:!1},{__name:"FullscreenMapOverlay",props:{show:{type:Boolean,required:!0},mode:{type:String,validator:e=>["place-checkpoint","move-checkpoint","draw-area","add-multiple"].includes(e)},contextTitle:{type:String,default:""},contextDescription:{type:String,default:""},canComplete:{type:Boolean,default:!1},drawingMode:{type:Boolean,default:!1}},emits:["done","cancel","map-click","polygon-complete","polygon-drawing","location-click","area-click"],setup(e,{emit:t}){const o=e,i=t,s=D(null),a=D(0),l=D(!1),u=D(!1),h=()=>{i("done")},p=()=>{i("cancel")},f=S=>{a.value=S?.length||0,y(),i("polygon-drawing",S)},y=()=>{s.value&&(l.value=s.value.canUndo(),u.value=s.value.canRedo())},x=()=>{s.value&&(s.value.undoPolygonPoint(),y())},T=()=>{s.value&&(s.value.redoPolygonPoint(),y())};We(()=>o.show,S=>{S||(a.value=0,l.value=!1,u.value=!1)});const I=S=>{S.key==="Escape"&&o.show&&p(),o.show&&o.drawingMode&&((S.ctrlKey||S.metaKey)&&S.key==="z"&&!S.shiftKey?(S.preventDefault(),x()):(S.ctrlKey||S.metaKey)&&(S.key==="y"||S.key==="z"&&S.shiftKey)&&(S.preventDefault(),T()))};return un(()=>{document.addEventListener("keydown",I)}),Ao(()=>{document.removeEventListener("keydown",I)}),(S,R)=>(m(),rt(fm,{to:"body"},[e.show?(m(),g("div",xD,[c("div",TD,[c("div",ID,[c("h3",null,b(e.contextTitle),1),e.contextDescription?(m(),g("p",$D,b(e.contextDescription),1)):N("",!0)]),c("div",MD,[c("button",{onClick:p,class:"btn btn-cancel"}," Cancel "),c("button",{onClick:h,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,AD)])]),c("div",ED,[ze(Qs,Pf({ref_key:"mapViewRef",ref:s,"drawing-mode":e.drawingMode},S.$attrs,{onMapClick:R[0]||(R[0]=E=>S.$emit("map-click",E)),onPolygonComplete:R[1]||(R[1]=E=>S.$emit("polygon-complete",E)),onPolygonDrawing:f,onLocationClick:R[2]||(R[2]=E=>S.$emit("location-click",E)),onAreaClick:R[3]||(R[3]=E=>S.$emit("area-click",E))}),null,16,["drawing-mode"]),e.drawingMode&&a.value>0?(m(),g("div",PD,[c("div",DD,b(a.value)+" point"+b(a.value!==1?"s":""),1),c("div",OD,[c("button",{onClick:x,class:"btn-drawing undo-btn",disabled:!l.value,title:"Undo last point"},"  Undo ",8,RD),c("button",{onClick:T,class:"btn-drawing redo-btn",disabled:!u.value,title:"Redo point"}," Redo  ",8,BD)])])):N("",!0)])])):N("",!0)]))}}),FD=Je(ND,[["__scopeId","data-v-a7562744"]]),UD={class:"form-group"},zD={class:"form-group"},HD={class:"form-group"},VD={key:0,class:"form-error"},GD={class:"form-row"},ZD={class:"form-group",style:{flex:"1"}},jD={class:"form-group",style:{flex:"1"}},WD={class:"form-group",style:{flex:"0 0 auto"}},qD={class:"form-group"},KD={__name:"AddLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:()=>({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""})},isDirty:{type:Boolean,default:!1}},emits:["close","save","set-on-map","update:isDirty","update:location"],setup(e,{emit:t}){const{termsLower:o}=Ct(),i=e,s=t,a=D({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""});We(()=>i.location,p=>{p&&(a.value={...p})},{immediate:!0,deep:!0});const l=()=>{s("update:isDirty",!0),s("update:location",{...a.value})},u=()=>{if(!Wr(a.value.what3Words)&&a.value.what3Words){alert("Invalid What3Words format.");return}s("save",a.value)},h=()=>{s("close")};return(p,f)=>(m(),rt(Ut,{show:e.show,title:`Add ${z(o).checkpoint}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:h},{actions:nt(()=>[c("button",{type:"button",onClick:h,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:u,class:"btn btn-primary"}," Add "+b(z(o).checkpoint),1)]),default:nt(()=>[c("form",{onSubmit:vt(u,["prevent"])},[c("div",UD,[f[7]||(f[7]=c("label",null,"Name",-1)),je(c("input",{"onUpdate:modelValue":f[0]||(f[0]=y=>a.value.name=y),type:"text",required:"",class:"form-input",onInput:l},null,544),[[ut,a.value.name]])]),c("div",zD,[f[8]||(f[8]=c("label",null,"Description",-1)),je(c("input",{"onUpdate:modelValue":f[1]||(f[1]=y=>a.value.description=y),type:"text",class:"form-input",onInput:l},null,544),[[ut,a.value.description]])]),c("div",HD,[f[9]||(f[9]=c("label",null,"What3Words (optional)",-1)),je(c("input",{"onUpdate:modelValue":f[2]||(f[2]=y=>a.value.what3Words=y),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap",onInput:l},null,544),[[ut,a.value.what3Words]]),a.value.what3Words&&!z(Wr)(a.value.what3Words)?(m(),g("small",VD," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):N("",!0)]),c("div",GD,[c("div",ZD,[f[10]||(f[10]=c("label",null,"Longitude",-1)),je(c("input",{"onUpdate:modelValue":f[3]||(f[3]=y=>a.value.longitude=y),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[ut,a.value.longitude,void 0,{number:!0}]])]),c("div",jD,[f[11]||(f[11]=c("label",null,"Latitude",-1)),je(c("input",{"onUpdate:modelValue":f[4]||(f[4]=y=>a.value.latitude=y),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[ut,a.value.latitude,void 0,{number:!0}]])]),c("div",WD,[f[12]||(f[12]=c("label",null,"",-1)),c("button",{type:"button",class:"icon-btn",title:"Set location on map",onClick:f[5]||(f[5]=y=>p.$emit("set-on-map"))},"  ")])]),c("div",qD,[c("label",null,"Required "+b(z(o).people),1),je(c("input",{"onUpdate:modelValue":f[6]||(f[6]=y=>a.value.requiredMarshals=y),type:"number",min:"1",required:"",class:"form-input",onInput:l},null,544),[[ut,a.value.requiredMarshals,void 0,{number:!0}]])])],32)]),_:1},8,["show","title","is-dirty"]))}},YD=Je(KD,[["__scopeId","data-v-dcbdc216"]]),JD={class:"admin-event-manage"},XD={class:"header"},QD={class:"header-left"},e6={key:0},t6={class:"event-date"},n6={class:"header-actions"},o6={class:"container"},s6={class:"tabs-nav"},i6={class:"tab-content-wrapper"},a6={key:1,class:"tab-panel"},r6={key:2,class:"tab-panel"},l6={__name:"AdminEventManage",setup(e){const t=au(),o=Ua(),i=Ip(),s=X(()=>t.params.eventId),{activeTab:a,switchTab:l}=$p("details",["details","course","areas","checkpoints","marshals","notes","checklists","contacts","settings"]),{showConfirmModal:u,confirmModalTitle:h,confirmModalMessage:p,showConfirm:f,handleConfirmModalConfirm:y,handleConfirmModalCancel:x}=Rb(),{tabLabels:T,termsLower:I}=Ct(),S=Bb(),R=Fb(s),E=Nb(s),M=X(()=>[{value:"details",label:"Event details",icon:"details"},{value:"course",label:T.value.course,icon:"course"},{value:"areas",label:T.value.areas,icon:"area"},{value:"checkpoints",label:T.value.checkpoints,icon:"checkpoint"},{value:"marshals",label:T.value.marshals,icon:"marshal"},{value:"notes",label:"Notes",icon:"notes"},{value:"checklists",label:T.value.checklists,icon:"checklist"},{value:"contacts",label:"Contacts",icon:"contacts"},{value:"settings",label:"Settings",icon:"settings"}]),_=D(null),$=D([]),k=D([]),w=D(null),A=D(!1),ne=D(null),ae=D(!1),_e=D(!1),re=D(null),ve=D(""),Ie=E.eventAdmins,Re=E.showAddAdmin,xe=R.showUploadRoute,he=R.uploading,Q=R.uploadError,J=R.showImportLocations,ue=R.showImportMarshals,te=R.importing,ke=R.importingMarshals,Oe=R.importError,oe=R.importResult,Ee=R.importMarshalsResult,be=D(!1),Se=D(!1),le=D({id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),pe=D(!1),q=D(!1),fe=D({marshalName:"",locations:[],marshal:null}),Le=D(null),F=D([]),G=D(!1),W=D(null),j=D({id:"",name:"",email:"",phoneNumber:"",notes:""}),O=D(!1),B=D([]),K=D([]),ye=D([]),$e=D([]),we=D(!1),Ne=D(""),Fe=D(""),Ue=D({name:"",description:"",eventDate:"",timeZoneId:"UTC",peopleTerm:"Marshals",defaultCheckpointStyleBackgroundShape:"",defaultCheckpointStyleBackgroundColor:"",defaultCheckpointStyleBorderColor:"",defaultCheckpointStyleIconColor:"",defaultCheckpointStyleSize:"",defaultCheckpointStyleMapRotation:"",checkpointTerm:"Checkpoints",areaTerm:"Areas",checklistTerm:"Checklists",courseTerm:"Course",defaultCheckpointStyleType:"default",defaultCheckpointStyleColor:""}),Ke=D(!1),se=D(!1),ee=D(""),Z=D(""),Ve=D(0),Ye=D({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Qe=D([]),et=D(null),pt=D(!1),Pt=D(null),gt=D(null),zt=S.isAddingMultipleCheckpoints,kn=S.multiCheckpointCounter,fo=S.isFullscreenMapActive,$t=S.fullscreenMode,Yn=S.fullscreenContext,dn=S.tempLocationCoords,ri=S.tempCheckpoints,Mn=S.savedMapCenter,po=S.savedMapZoom,Jn=S.isDrawingAreaBoundary,Xn=D(null),ss=D([]),hn=D(null),vo=D(!1),is=D("details"),As=D(null),mo=D([]),Qn=D(null),Wt=D(!1),Xe=D("details"),go=D([]),as=D({builtInRoles:[],customRoles:[]}),Qt=D(null),eo=D(!1),Nn=D("details"),yo=D(null),Fn=D(null),li=X(()=>Fn.value?.marshalId!=null),Fi=()=>{o.push(`/event/${t.params.eventId}`)},Ui=X(()=>`${window.location.origin}/#/event/${t.params.eventId}`),ci=X(()=>{const U=[];return k.value.forEach(ce=>{ce.assignments&&U.push(...ce.assignments)}),U}),Es=X(()=>{if(!W.value)return k.value;const U=W.value.assignedLocationIds||[],ce=ye.value.map(De=>De.locationId),Pe=$e.value;return k.value.filter(De=>!U.includes(De.id)&&!ce.includes(De.id)||Pe.includes(De.id))}),to=X(()=>{let U=F.value;if(w.value){const ce=w.value.assignments.map(De=>De.marshalName),Pe=B.value.map(De=>De.marshalName);U=F.value.filter(De=>!ce.includes(De.name)&&!Pe.includes(De.name))}return U.slice().sort((ce,Pe)=>ce.name.localeCompare(Pe.name))}),tn=X(()=>$t.value==="draw-area"&&et.value?.polygon?.length>0||S.canCompleteFullscreen.value),rs=X(()=>{const U=[...k.value];return $t.value==="place-checkpoint"&&dn.value&&U.push({id:"temp-single",name:Ye.value.name||"New Checkpoint",latitude:dn.value.lat,longitude:dn.value.lng,requiredMarshals:Ye.value.requiredMarshals||1,assignments:[],isTemporary:!0}),$t.value==="move-checkpoint"&&dn.value&&w.value&&U.push({id:"temp-move",name:w.value.name+" (new position)",latitude:dn.value.lat,longitude:dn.value.lng,requiredMarshals:w.value.requiredMarshals,assignments:[],isTemporary:!0}),$t.value==="add-multiple"&&U.push(...ri.value),U}),ls=X(()=>{const U=[...Qe.value];if($t.value==="draw-area"&&et.value?.polygon?.length>0){const ce=U.findIndex(Pe=>Pe.id===et.value.id);ce>=0?U[ce]={...et.value}:U.push({...et.value,id:et.value.id||"temp-area"})}return U}),cs=()=>{o.push("/admin/dashboard")},Ps=()=>{o.push({name:"AdminProfile"})},Mt=(U=!0)=>{O.value=U},ui=()=>{Ke.value=!0},us=async U=>{try{U&&(Ue.value={...U});const ce=Oa(_.value.eventDate),Pe=Ue.value.eventDate;if(ce!==Pe){const De=$.value.filter(yt=>yt.startTime||yt.endTime);if(De.length>0){ee.value=ce,Z.value=Pe,Ve.value=De.length,se.value=!0;return}}await An(!1,null)}catch(ce){console.error("Failed to update event:",ce),alert("Failed to update event. Please try again.")}},An=async(U,ce)=>{try{if(await i.updateEvent(t.params.eventId,{...Ue.value,defaultCheckpointStyleMapRotation:Ue.value.defaultCheckpointStyleMapRotation!=null?String(Ue.value.defaultCheckpointStyleMapRotation):null}),U&&ce!==null){const Pe=Math.floor(Math.abs(ce)/1e3),De=ce<0,yt=Math.floor(Pe/3600),wn=Math.floor(Pe%3600/60),Nt=Pe%60,Gn=`${De?"-":""}${yt.toString().padStart(2,"0")}:${wn.toString().padStart(2,"0")}:${Nt.toString().padStart(2,"0")}`;await i.bulkUpdateLocationTimes(t.params.eventId,Gn)}await Bt(),Ke.value=!1}catch(Pe){console.error("Failed to update event:",Pe),alert("Failed to update event. Please try again.")}},Ds=async({shouldShift:U,timeDelta:ce})=>{se.value=!1,await An(U,ce)},di=()=>{se.value=!1,Bt()},Bt=async()=>{try{await i.fetchEvent(t.params.eventId),_.value=i.currentEvent,_.value&&(Ue.value={name:_.value.name||"",description:_.value.description||"",eventDate:Oa(_.value.eventDate),timeZoneId:_.value.timeZoneId||"UTC",peopleTerm:_.value.peopleTerm||"Marshals",checkpointTerm:_.value.checkpointTerm||"Checkpoints",areaTerm:_.value.areaTerm||"Areas",checklistTerm:_.value.checklistTerm||"Checklists",courseTerm:_.value.courseTerm||"Course",defaultCheckpointStyleType:_.value.defaultCheckpointStyleType||"default",defaultCheckpointStyleColor:_.value.defaultCheckpointStyleColor||"",defaultCheckpointStyleBackgroundShape:_.value.defaultCheckpointStyleBackgroundShape||"",defaultCheckpointStyleBackgroundColor:_.value.defaultCheckpointStyleBackgroundColor||"",defaultCheckpointStyleBorderColor:_.value.defaultCheckpointStyleBorderColor||"",defaultCheckpointStyleIconColor:_.value.defaultCheckpointStyleIconColor||"",defaultCheckpointStyleSize:_.value.defaultCheckpointStyleSize||"",defaultCheckpointStyleMapRotation:_.value.defaultCheckpointStyleMapRotation??"",brandingHeaderGradientStart:_.value.brandingHeaderGradientStart||"",brandingHeaderGradientEnd:_.value.brandingHeaderGradientEnd||"",brandingLogoUrl:_.value.brandingLogoUrl||"",brandingLogoPosition:_.value.brandingLogoPosition||"",brandingAccentColor:_.value.brandingAccentColor||"",brandingPageGradientStart:_.value.brandingPageGradientStart||"",brandingPageGradientEnd:_.value.brandingPageGradientEnd||""},Ke.value=!1,Dc(_.value));const U=await Promise.allSettled([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId),Bs(),ht(),kt(),_o(),Un(),zn()]);$.value=i.locations,k.value=i.eventStatus.locations,U.forEach((ce,Pe)=>{ce.status==="rejected"&&console.error(`Failed to load ${["locations","eventStatus","admins","marshals","areas","checklists","notes","contacts"][Pe]}:`,ce.reason)})}catch(U){console.error("Failed to load event data:",U)}},ht=async()=>{try{const U=await $o.getByEvent(t.params.eventId);F.value=U.data}catch(U){console.error("Failed to load marshals:",U)}},kt=async()=>{try{const U=await Cs.getByEvent(t.params.eventId);Qe.value=U.data}catch(U){console.error("Failed to load areas:",U)}},_o=async()=>{try{const[U,ce]=await Promise.all([Et.getByEvent(t.params.eventId),Et.getReport(t.params.eventId)]);ss.value=U.data,As.value=ce.data}catch(U){console.error("Failed to load checklists:",U)}},Un=async()=>{try{const U=await Go.getByEvent(t.params.eventId);mo.value=U.data}catch(U){console.error("Failed to load notes:",U)}},zn=async()=>{try{const[U,ce]=await Promise.all([Ci.getByEvent(t.params.eventId),Ci.getRoles(t.params.eventId)]);go.value=U.data,as.value=ce.data}catch(U){console.error("Failed to load contacts:",U)}},Eo=async()=>{await Promise.all([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId)]),$.value=i.locations,k.value=i.eventStatus.locations},it=async()=>{await Promise.all([ht(),i.fetchEventStatus(t.params.eventId)]),k.value=i.eventStatus.locations},Tt=async()=>{await Promise.all([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId),kt()]),$.value=i.locations,k.value=i.eventStatus.locations},Os=async()=>{await i.fetchEventStatus(t.params.eventId),k.value=i.eventStatus.locations},Po=()=>{et.value=null,O.value=!1,pt.value=!0},qt=U=>{et.value=U,Pt.value=U.id,O.value=!1,pt.value=!0},zi=async U=>{try{if(et.value&&et.value.id){if(await Cs.update(t.params.eventId,et.value.id,U),U.checklistChanges&&U.checklistChanges.length>0)for(const ce of U.checklistChanges)try{ce.complete?await Et.complete(t.params.eventId,ce.itemId,{marshalId:ce.marshalId,contextType:ce.contextType,contextId:ce.contextId}):await Et.uncomplete(t.params.eventId,ce.itemId,{marshalId:ce.marshalId,contextType:ce.contextType,contextId:ce.contextId})}catch(Pe){console.error("Failed to update checklist item:",ce,Pe)}}else await Cs.create({eventId:t.params.eventId,...U});await kt(),await Bt(),fn()}catch(ce){console.error("Failed to save area:",ce),alert(ce.response?.data?.message||"Failed to save area. Please try again.")}},Hn=async U=>{f("Delete area","Are you sure you want to delete this area? Checkpoints will be automatically reassigned.",async()=>{try{await Cs.delete(t.params.eventId,U),await Cs.recalculate(t.params.eventId),await kt(),await Bt(),fn()}catch(ce){console.error("Failed to delete area:",ce),alert(ce.response?.data?.message||"Failed to delete area. Please try again.")}})},fn=()=>{pt.value=!1,et.value=null,Pt.value=null,O.value=!1,Jn.value=!1,gt.value=null},At=U=>{fn(),Qt.value=null,Nn.value="details",O.value=!1,yo.value=U,eo.value=!0},H=U=>{Qt.value=U,Nn.value="details",O.value=!1,eo.value=!0},V=()=>{hn.value=null,is.value="details",O.value=!1,vo.value=!0},ie=(U,ce="details")=>{hn.value=U,is.value=ce,O.value=!1,vo.value=!0},Me=async U=>{try{if(hn.value&&hn.value.itemId)await Et.update(t.params.eventId,hn.value.itemId,U);else{const ce=await Et.create(t.params.eventId,U);ce.data.count&&ce.data.count>1&&(Ne.value="Checklist Items Created",Fe.value=`Successfully created ${ce.data.count} checklist items.`,we.value=!0)}await _o(),ot()}catch(ce){console.error("Failed to save checklist item:",ce);const Pe=ce.response?.data?.message||"Failed to save checklist item. Please try again.";alert(Pe)}},Ge=async U=>{f("Delete checklist item","Are you sure you want to delete this checklist item?",async()=>{try{await Et.delete(t.params.eventId,U),await _o(),ot()}catch(ce){console.error("Failed to delete checklist item:",ce),alert(ce.response?.data?.message||"Failed to delete checklist item. Please try again.")}})},ot=()=>{vo.value=!1,hn.value=null,O.value=!1},Ht=()=>{Qn.value=null,Xe.value="details",O.value=!1,Wt.value=!0},Vt=U=>{Qn.value=U,Xe.value="details",O.value=!1,Wt.value=!0},nn=async U=>{try{Qn.value&&Qn.value.noteId?await Go.update(t.params.eventId,Qn.value.noteId,U):await Go.create(t.params.eventId,U),await Un(),ds()}catch(ce){console.error("Failed to save note:",ce);const Pe=ce.response?.data?.message||"Failed to save note. Please try again.";alert(Pe)}},Rs=async U=>{f("Delete note","Are you sure you want to delete this note?",async()=>{try{await Go.delete(t.params.eventId,U),await Un(),ds()}catch(ce){console.error("Failed to delete note:",ce),alert(ce.response?.data?.message||"Failed to delete note. Please try again.")}})},ds=()=>{Wt.value=!1,Qn.value=null,O.value=!1},ja=()=>{Qt.value=null,Nn.value="details",yo.value=null,O.value=!1,eo.value=!0},Hi=U=>{Qt.value=U,Nn.value="details",O.value=!1,eo.value=!0},Cl=async U=>{try{Qt.value&&Qt.value.contactId?await Ci.update(t.params.eventId,Qt.value.contactId,U):await Ci.create(t.params.eventId,U),await zn(),bn()}catch(ce){console.error("Failed to save contact:",ce);const Pe=ce.response?.data?.message||"Failed to save contact. Please try again.";alert(Pe)}},lt=async U=>{f("Delete contact","Are you sure you want to delete this contact?",async()=>{try{await Ci.delete(t.params.eventId,U),await zn(),bn()}catch(ce){console.error("Failed to delete contact:",ce),alert(ce.response?.data?.message||"Failed to delete contact. Please try again.")}})},bn=()=>{eo.value=!1,Qt.value=null,yo.value=null,O.value=!1},Lt=U=>{if(gt.value=U,pt.value=!1,ne.value){const ce=ne.value.getMapCenter(),Pe=ne.value.getMapZoom();ce&&Pe!==null&&(Mn.value=ce,po.value=Pe)}fo.value=!0,$t.value="draw-area",Jn.value=!0,Yn.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},Vi=U=>{gt.value?et.value={...et.value||{},...gt.value,polygon:U}:et.value={...et.value,polygon:U}},Gi=U=>{S.handlePolygonDrawing(U)},Zi=()=>{Jn.value=!1,gt.value&&(et.value=gt.value,pt.value=!0,gt.value=null)},Bs=()=>E.loadEventAdmins(),Do=async U=>{try{await E.addAdmin(U),await Bs(),hs()}catch(ce){console.error("Failed to add admin:",ce),alert(ce.response?.data?.message||"Failed to add administrator. Please try again.")}},ji=async U=>{f("Remove Administrator",`Remove ${U} as an administrator?`,async()=>{try{await E.removeAdmin(U),await Bs()}catch(ce){console.error("Failed to remove admin:",ce),alert(ce.response?.data?.message||"Failed to remove administrator. Please try again.")}})},hs=()=>{E.closeAddAdminModal(),O.value=!1},Zt=async U=>{await R.uploadRoute(U)&&(await Eo(),ko())},ko=()=>{R.closeUploadRouteModal()},Wa=async({file:U,deleteExisting:ce})=>{const Pe=await R.importLocations(U,ce);if(Pe){await Tt(),Wi();const De=R.formatImportResultMessage(Pe,"location");Ne.value="Import Complete",Fe.value=De,we.value=!0}},Wi=()=>{R.closeImportLocationsModal()},Ll=async U=>{if(A.value)Ye.value.latitude=U.lat,Ye.value.longitude=U.lng;else if(Se.value)le.value.latitude=U.lat,le.value.longitude=U.lng,w.value&&(w.value={...w.value,latitude:U.lat,longitude:U.lng}),Se.value=!1,be.value=!0,Mt();else if(zt.value)try{await i.createLocation({eventId:t.params.eventId,name:`Checkpoint ${kn.value}`,description:"",latitude:U.lat,longitude:U.lng,requiredMarshals:1,what3Words:""}),kn.value++,await Bt()}catch(ce){console.error("Failed to create checkpoint:",ce),alert("Failed to create checkpoint. Please try again.")}},qa=U=>{S.handleFullscreenMapClick(U)},qi=U=>{Ye.value={...U}},Sl=()=>{A.value=!1,S.enterPlaceCheckpointMode()},Ka=()=>{S.saveMapState(ne.value),Ye.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},S.enterPlaceCheckpointMode()},mt=()=>{S.saveMapState(ne.value),et.value={id:null,name:"",description:"",color:"#667eea",polygon:[],checkpointIds:[],marshalIds:[],displayOrder:Qe.value.length},S.enterDrawAreaMode()},xl=()=>{w.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},le.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},B.value=[],K.value=[],O.value=!1,be.value=!0},En=()=>{const U=S.calculateStartingNumber(k);S.saveMapState(ne.value),S.enterAddMultipleMode(U)},Ns=()=>{if($t.value==="place-checkpoint"){const U=S.getPlacedCoords()||{lat:0,lng:0};w.value={id:null,name:"",description:"",latitude:U.lat,longitude:U.lng,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},le.value={id:null,name:"",description:"",latitude:U.lat,longitude:U.lng,requiredMarshals:1,what3Words:""},B.value=[],K.value=[],O.value=!1,fs(),be.value=!0}else if($t.value==="move-checkpoint"){const U=S.getPlacedCoords();U&&(le.value.latitude=U.lat,le.value.longitude=U.lng,w.value&&(w.value={...w.value,...Xn.value||{},latitude:U.lat,longitude:U.lng}),Mt()),Xn.value=null,fs(),be.value=!0}else if($t.value==="draw-area"){const U=S.getCompletedPolygon();U&&(gt.value?et.value={...et.value||{},...gt.value,polygon:U}:et.value={...et.value||{},polygon:U}),fs(),pt.value=!0,gt.value=null}else $t.value==="add-multiple"&&Ya()},Ya=async()=>{const U=S.getTempCheckpoints();try{for(const ce of U)await i.createLocation({eventId:t.params.eventId,name:ce.name,description:ce.description,latitude:ce.latitude,longitude:ce.longitude,requiredMarshals:ce.requiredMarshals,what3Words:ce.what3Words});S.clearTempCheckpoints(),fs(),await Bt()}catch(ce){console.error("Failed to create checkpoints:",ce),alert("Failed to create checkpoints. Please try again.")}},Tl=()=>{$t.value==="draw-area"?gt.value&&(et.value=gt.value,pt.value=!0,gt.value=null):$t.value==="move-checkpoint"&&(Xn.value&&w.value&&Object.assign(w.value,Xn.value),be.value=!0,Se.value=!1),S.cancelFullscreen()},fs=()=>{S.exitFullscreen()},Il=U=>{Fs(U)},Fs=U=>{w.value=U,le.value={id:U.id,name:U.name,description:U.description||"",latitude:U.latitude,longitude:U.longitude,requiredMarshals:U.requiredMarshals,what3Words:U.what3Words||""},B.value=[],K.value=[],O.value=!1,be.value=!0,setTimeout(()=>{ne.value?.scrollMapIntoView()},100)},$l=async U=>{if(!Wr(U.what3Words)){alert("Invalid What3Words format. Please use word.word.word or word/word/word (lowercase letters only, 1-20 characters each)");return}try{await i.createLocation({eventId:t.params.eventId,...U}),await Bt(),Ja()}catch(ce){console.error("Failed to save location:",ce),alert("Failed to save location. Please try again.")}},Ja=()=>{A.value=!1,Ye.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},O.value=!1,O.value=!1},Us=()=>{be.value=!1,w.value=null,Se.value=!1,pe.value=!1,Xn.value=null,le.value={id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},B.value=[],K.value=[],O.value=!1},Ki=()=>{pe.value=!1},Vn=()=>{pe.value=!0},Ml=U=>{if(U?.formData&&(Xn.value=U.formData),be.value=!1,dn.value=null,ne.value){const Pe=ne.value.getMapCenter(),De=ne.value.getMapZoom();Pe&&De!==null&&(Mn.value=Pe,po.value=De)}const ce=Xn.value?.name||w.value?.name;fo.value=!0,$t.value="move-checkpoint",Yn.value={title:`Move ${I.value.checkpoint}: ${ce}`,description:"Click on the map to set the new location"}},Xa=async U=>{if(!Wr(U.what3Words)){alert("Invalid What3Words format.");return}try{const ce=!w.value.id;if(ce){const Pe=await i.createLocation({eventId:t.params.eventId,name:U.name,description:U.description,latitude:U.latitude,longitude:U.longitude,requiredMarshals:U.requiredMarshals,what3Words:U.what3Words||null,startTime:U.startTime,endTime:U.endTime,styleType:U.styleType,styleColor:U.styleColor,styleBackgroundShape:U.styleBackgroundShape,styleBackgroundColor:U.styleBackgroundColor,styleBorderColor:U.styleBorderColor,styleIconColor:U.styleIconColor,styleSize:U.styleSize,styleMapRotation:U.styleMapRotation!=null?String(U.styleMapRotation):null,peopleTerm:U.peopleTerm,checkpointTerm:U.checkpointTerm,isDynamic:U.isDynamic||!1,locationUpdateScopeConfigurations:U.locationUpdateScopeConfigurations||[],pendingNewChecklistItems:U.pendingNewChecklistItems||[],pendingNewNotes:U.pendingNewNotes||[]});if(U.pendingAssignments&&U.pendingAssignments.length>0)for(const De of U.pendingAssignments)await i.createAssignment({eventId:t.params.eventId,locationId:Pe.id,marshalId:De.marshalId})}else{const Pe=w.value.id;if(await xn.update(t.params.eventId,Pe,{eventId:t.params.eventId,name:U.name,description:U.description,latitude:U.latitude,longitude:U.longitude,requiredMarshals:U.requiredMarshals,what3Words:U.what3Words||null,startTime:U.startTime,endTime:U.endTime,styleType:U.styleType,styleColor:U.styleColor,styleBackgroundShape:U.styleBackgroundShape,styleBackgroundColor:U.styleBackgroundColor,styleBorderColor:U.styleBorderColor,styleIconColor:U.styleIconColor,styleSize:U.styleSize,styleMapRotation:U.styleMapRotation!=null?String(U.styleMapRotation):null,peopleTerm:U.peopleTerm,checkpointTerm:U.checkpointTerm,isDynamic:U.isDynamic||!1,locationUpdateScopeConfigurations:U.locationUpdateScopeConfigurations||[]}),U.pendingNewChecklistItems&&U.pendingNewChecklistItems.length>0)for(const De of U.pendingNewChecklistItems)De.text?.trim()&&await Et.create(t.params.eventId,{text:De.text,scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[Pe]}],displayOrder:0,isRequired:!1});if(U.pendingNewNotes&&U.pendingNewNotes.length>0)for(const De of U.pendingNewNotes)!De.title?.trim()&&!De.content?.trim()||await Go.create(t.params.eventId,{title:De.title||"Untitled",content:De.content||"",scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[Pe]}],displayOrder:0,priority:"Normal",isPinned:!1});for(const De of K.value)await i.deleteAssignment(t.params.eventId,De);for(const De of B.value)await i.createAssignment({eventId:t.params.eventId,locationId:w.value.id,marshalId:De.marshalId});if(U.checkInChanges&&U.checkInChanges.length>0)for(const De of U.checkInChanges){const yt=w.value.assignments.find(wn=>wn.id===De.assignmentId);yt&&yt.isCheckedIn!==De.shouldBeCheckedIn&&await Ko.adminCheckIn(t.params.eventId,De.assignmentId)}}if(!ce&&U.checklistChanges&&U.checklistChanges.length>0)for(const Pe of U.checklistChanges)try{Pe.complete?await Et.complete(t.params.eventId,Pe.itemId,{marshalId:Pe.marshalId,contextType:Pe.contextType,contextId:Pe.contextId}):await Et.uncomplete(t.params.eventId,Pe.itemId,{marshalId:Pe.marshalId,contextType:Pe.contextType,contextId:Pe.contextId})}catch(De){console.error("Failed to update checklist item:",Pe,De)}await Bt(),Us()}catch(ce){console.error("Failed to update location:",ce),alert("Failed to update location. Please try again.")}},bo=async U=>{f("Delete location","Are you sure you want to delete this location?",async()=>{try{await xn.delete(t.params.eventId,U),await Tt(),Us()}catch(ce){console.error("Failed to delete location:",ce),alert("Failed to delete location. Please try again.")}})},Qa=U=>{const ce=U?.id??U;if(ce?.toString().startsWith("temp-")){const Pe=w.value.assignments.find(De=>De.id===ce);Pe&&(B.value=B.value.filter(De=>De.marshalId!==Pe.marshalId)),w.value.assignments=w.value.assignments.filter(De=>De.id!==ce),Mt()}else K.value.includes(ce)||(K.value.push(ce),w.value.assignments=w.value.assignments.filter(Pe=>Pe.id!==ce),Mt())},er=async U=>{const ce=F.value.find(De=>De.id===U);if(!ce)return;const Pe=k.value.filter(De=>De.assignments?.some(yt=>yt.marshalId===U&&De.id!==w.value.id));if(Pe.length>0){fe.value={marshalName:ce.name,locations:Pe.map(yt=>yt.name),marshal:ce};const De=await new Promise(yt=>{Le.value=yt,q.value=!0});if(De==="cancel"||De==="choose-other")return;if(De==="move")for(const yt of Pe){const wn=yt.assignments.find(Nt=>Nt.marshalId===U);if(wn){K.value.push(wn.id);const Nt=k.value.findIndex(Gn=>Gn.id===yt.id);Nt!==-1&&(k.value[Nt].assignments=k.value[Nt].assignments.filter(Gn=>Gn.id!==wn.id))}}}B.value.push({marshalId:ce.id,marshalName:ce.name}),w.value.assignments||(w.value.assignments=[]),w.value.assignments.push({id:`temp-${Date.now()}`,marshalId:ce.id,marshalName:ce.name,locationId:w.value.id,isCheckedIn:!1,isPending:!0}),Mt(),Ki()},Yi=async U=>{try{const Pe=(await $o.create({eventId:t.params.eventId,name:U.name,email:U.email,phoneNumber:U.phoneNumber})).data;await ht(),B.value.push({marshalId:Pe.id,marshalName:Pe.name}),w.value&&(w.value.assignments||(w.value.assignments=[]),w.value.assignments.push({id:`temp-${Date.now()}`,marshalId:Pe.id,marshalName:Pe.name,locationId:w.value.id,isCheckedIn:!1,isPending:!0})),Mt(),Ki()}catch(ce){console.error("Failed to create marshal:",ce),alert("Failed to create marshal. Please try again.")}},Al=()=>{W.value=null,j.value={id:"",name:"",email:"",phoneNumber:"",notes:""},ye.value=[],$e.value=[],O.value=!1,G.value=!0},tr=U=>{W.value=U,j.value={id:U.id,name:U.name,email:U.email||"",phoneNumber:U.phoneNumber||"",notes:U.notes||""},ye.value=[],$e.value=[],O.value=!1,G.value=!0},Ji=()=>{if(!W.value)return[];const U=[];return k.value.forEach(ce=>{ce.assignments.filter(De=>De.marshalName===W.value.name).forEach(De=>{U.push({...De,locationName:ce.name})})}),U},El=async U=>{try{let ce=W.value?.id,Pe=!1;if(W.value){if(await $o.update(t.params.eventId,W.value.id,{name:U.name,email:U.email,phoneNumber:U.phoneNumber,notes:U.notes}),U.pendingNewChecklistItems&&U.pendingNewChecklistItems.length>0)for(const De of U.pendingNewChecklistItems)De.text?.trim()&&await Et.create(t.params.eventId,{text:De.text,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[ce]}],displayOrder:0,isRequired:!1});if(U.pendingNewNotes&&U.pendingNewNotes.length>0)for(const De of U.pendingNewNotes)!De.title?.trim()&&!De.content?.trim()||await Go.create(t.params.eventId,{title:De.title||"Untitled",content:De.content||"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[ce]}],displayOrder:0,priority:"Normal",isPinned:!1})}else ce=(await $o.create({eventId:t.params.eventId,name:U.name,email:U.email,phoneNumber:U.phoneNumber,notes:U.notes,pendingNewChecklistItems:U.pendingNewChecklistItems||[],pendingNewNotes:U.pendingNewNotes||[]})).data.id,Pe=!0;for(const De of $e.value)await i.deleteAssignment(t.params.eventId,De);for(const De of ye.value)await i.createAssignment({eventId:t.params.eventId,locationId:De.locationId,marshalId:ce});if(U.pendingAssignments&&U.pendingAssignments.length>0)for(const De of U.pendingAssignments)await i.createAssignment({eventId:t.params.eventId,locationId:De.locationId,marshalId:ce});if(U.checkInChanges&&U.checkInChanges.length>0){const De=Ji();for(const yt of U.checkInChanges){const wn=De.find(Nt=>Nt.id===yt.assignmentId);wn&&wn.isCheckedIn!==yt.shouldBeCheckedIn&&await Ko.adminCheckIn(t.params.eventId,yt.assignmentId)}}if(U.checklistChanges&&U.checklistChanges.length>0)for(const De of U.checklistChanges)try{const yt={marshalId:ce};De.contextType&&De.contextId&&(yt.contextType=De.contextType,yt.contextId=De.contextId),De.complete?await Et.complete(t.params.eventId,De.itemId,yt):await Et.uncomplete(t.params.eventId,De.itemId,yt)}catch(yt){console.error("Failed to process checklist change:",yt);const wn=yt.response?.data?.message||"Failed to update checklist item";alert(`Error: ${wn}`)}await Bt(),hi(),Pe&&(re.value=ce,ve.value=U.name,_e.value=!0)}catch(ce){console.error("Failed to save marshal:",ce),alert("Failed to save marshal. Please try again.")}},nr=async U=>{const ce=U||W.value?.id;if(!ce){console.error("No marshal ID to delete");return}const Pe=I.value.person;f(`Delete ${Pe}`,`Are you sure you want to delete this ${Pe}?`,async()=>{try{await $o.delete(t.params.eventId,ce),await it(),hi()}catch(De){console.error(`Failed to delete ${Pe}:`,De),alert(`Failed to delete ${Pe}. Please try again.`)}})},Xi=U=>{nr(U.id)},Pl=U=>{$e.value.includes(U)||($e.value.push(U),Mt())},or=U=>{ye.value.push({locationId:U}),Mt()},hi=()=>{G.value=!1,W.value=null,j.value={id:"",name:"",email:"",phoneNumber:"",notes:""},ye.value=[],$e.value=[],O.value=!1},fi=async({file:U})=>{const ce=await R.importMarshals(U);if(ce){await it(),wo();const Pe=R.formatImportResultMessage(ce,"marshal");Ne.value="Import Complete",Fe.value=Pe,we.value=!0}},wo=()=>{R.closeImportMarshalsModal()},Dl=U=>{Le.value&&(Le.value(U),Le.value=null),q.value=!1},zs=async({assignment:U,status:ce})=>{try{if(ce==="not-checked-in"?U.isCheckedIn&&await Ko.adminCheckIn(t.params.eventId,U.id):U.isCheckedIn||await Ko.adminCheckIn(t.params.eventId,U.id),await Os(),w.value){const Pe=k.value.find(De=>De.id===w.value.id);Pe&&(w.value=Pe)}}catch(Pe){console.error("Failed to change assignment status:",Pe),alert("Failed to change status. Please try again.")}};let Kt=null;const Qi=async()=>{try{const U=t.params.eventId,ce=await xn.getDynamicCheckpoints(U);if(ce.data&&Array.isArray(ce.data))for(const Pe of ce.data){const De=k.value.find(yt=>yt.id===Pe.checkpointId);De&&(De.latitude=Pe.latitude,De.longitude=Pe.longitude,De.lastLocationUpdate=Pe.lastLocationUpdate)}}catch(U){console.warn("Failed to poll dynamic checkpoints:",U)}},ea=()=>{Kt||!k.value.some(ce=>ce.isDynamic||ce.IsDynamic)||(Qi(),Kt=setInterval(Qi,6e4))},sr=()=>{Kt&&(clearInterval(Kt),Kt=null)};return We(a,U=>{U==="course"?ea():sr()}),un(async()=>{await Bt();try{const U=await Io.getMe(t.params.eventId);Fn.value=U.data}catch(U){console.warn("Failed to fetch user claims:",U)}a.value==="course"&&ea()}),Ao(()=>{sr()}),(U,ce)=>(m(),g("div",JD,[c("header",XD,[c("div",QD,[c("button",{onClick:cs,class:"btn-back",title:"Back to Dashboard"}," Dashboard"),_.value?(m(),g("div",e6,[c("h1",null,b(_.value.name),1),c("p",t6,b(z(Ep)(_.value.eventDate)),1)])):N("",!0)]),c("div",n6,[li.value?(m(),g("button",{key:0,onClick:Fi,class:"btn btn-marshal-mode"}," Switch to Marshal ")):N("",!0),c("button",{onClick:Ps,class:"btn btn-secondary"},"Profile")])]),c("div",o6,[c("div",s6,[ze(Nx,{tabs:M.value,"model-value":z(a),"onUpdate:modelValue":z(l)},null,8,["tabs","model-value","onUpdate:modelValue"])]),c("div",i6,[z(a)==="course"?(m(),rt(Mw,{key:0,ref_key:"courseAreasTab",ref:ne,checkpoints:k.value,areas:Qe.value,route:_.value?.route||[],"selected-area-id":Pt.value,"drawing-mode":z(Jn),onMapClick:Ll,onLocationClick:Il,onAreaClick:qt,onImportCheckpoints:ce[0]||(ce[0]=Pe=>J.value=!0),onUploadRoute:ce[1]||(ce[1]=Pe=>xe.value=!0),onSelectLocation:Fs,onAddArea:Po,onSelectArea:qt,onPolygonComplete:Vi,onCancelDrawing:Zi,onAddCheckpointFromMap:Ka,onAddManyCheckpointsFromMap:En,onAddAreaFromMap:mt},null,8,["checkpoints","areas","route","selected-area-id","drawing-mode"])):N("",!0),z(a)==="checkpoints"?(m(),g("div",a6,[ze(vx,{locations:k.value,areas:Qe.value,onAddCheckpointManually:xl,onImportCheckpoints:ce[2]||(ce[2]=Pe=>J.value=!0),onSelectLocation:Fs},null,8,["locations","areas"])])):N("",!0),z(a)==="areas"?(m(),g("div",r6,[ze(Ix,{areas:Qe.value,checkpoints:k.value,contacts:go.value,"event-people-term":_.value?.peopleTerm||"Marshals","event-checkpoint-term":_.value?.checkpointTerm||"Checkpoints",onAddArea:Po,onSelectArea:qt},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term"])])):N("",!0),z(a)==="marshals"?(m(),rt(e0,{key:3,marshals:F.value,assignments:ci.value,locations:k.value,onAddMarshal:Al,onImportMarshals:ce[3]||(ce[3]=Pe=>ue.value=!0),onSelectMarshal:tr,onDeleteMarshal:Xi,onChangeAssignmentStatus:zs},null,8,["marshals","assignments","locations"])):N("",!0),z(a)==="checklists"?(m(),rt(P0,{key:4,"checklist-items":ss.value,areas:Qe.value,locations:k.value,marshals:F.value,"completion-report":As.value,onAddChecklistItem:V,onSelectChecklistItem:ie},null,8,["checklist-items","areas","locations","marshals","completion-report"])):N("",!0),z(a)==="notes"?(m(),rt(iC,{key:5,notes:mo.value,areas:Qe.value,locations:k.value,marshals:F.value,onAddNote:Ht,onSelectNote:Vt},null,8,["notes","areas","locations","marshals"])):N("",!0),z(a)==="contacts"?(m(),rt($C,{key:6,contacts:go.value,areas:Qe.value,locations:k.value,marshals:F.value,"available-roles":as.value,onAddContact:ja,onSelectContact:Hi},null,8,["contacts","areas","locations","marshals","available-roles"])):N("",!0),z(a)==="details"?(m(),rt(zC,{key:7,"event-data":Ue.value,"form-dirty":Ke.value,onSubmit:us,"onUpdate:formDirty":ui},null,8,["event-data","form-dirty"])):N("",!0),z(a)==="settings"?(m(),rt(QS,{key:8,"event-data":Ue.value,"event-id":z(t).params.eventId,admins:z(Ie),"form-dirty":Ke.value,onSubmit:us,onAddAdmin:ce[4]||(ce[4]=Pe=>Re.value=!0),onRemoveAdmin:ji,"onUpdate:formDirty":ui},null,8,["event-data","event-id","admins","form-dirty"])):N("",!0)])]),ze(YD,{show:A.value,location:Ye.value,"is-dirty":O.value,onClose:Ja,onSave:$l,onSetOnMap:Sl,"onUpdate:isDirty":Mt,"onUpdate:location":qi},null,8,["show","location","is-dirty"]),ze(PA,{show:be.value,location:w.value,assignments:w.value?.assignments||[],"event-date":_.value?.eventDate||"",areas:Qe.value,"event-id":z(t).params.eventId,"all-locations":k.value,notes:mo.value,"available-marshals":to.value,"all-checklist-items":ss.value,"is-dirty":O.value,"event-default-style-type":_.value?.defaultCheckpointStyleType||_.value?.DefaultCheckpointStyleType||"default","event-default-style-color":_.value?.defaultCheckpointStyleColor||_.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":_.value?.defaultCheckpointStyleBackgroundShape||_.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":_.value?.defaultCheckpointStyleBackgroundColor||_.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":_.value?.defaultCheckpointStyleBorderColor||_.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":_.value?.defaultCheckpointStyleIconColor||_.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":_.value?.defaultCheckpointStyleSize||_.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":_.value?.defaultCheckpointStyleMapRotation??_.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":_.value?.peopleTerm||"Marshals","z-index":pt.value?1100:1e3,onClose:Us,onSave:Xa,onDelete:bo,onMoveLocation:Ml,onRemoveAssignment:Qa,onOpenAssignModal:Vn,"onUpdate:isDirty":Mt},null,8,["show","location","assignments","event-date","areas","event-id","all-locations","notes","available-marshals","all-checklist-items","is-dirty","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","z-index"]),ze(Hx,{show:ae.value,link:Ui.value,"is-dirty":!1,onClose:ce[5]||(ce[5]=Pe=>ae.value=!1)},null,8,["show","link"]),ze(nT,{show:_e.value,"event-id":z(t).params.eventId,"marshal-id":re.value,"marshal-name":ve.value,onClose:ce[6]||(ce[6]=Pe=>_e.value=!1)},null,8,["show","event-id","marshal-id","marshal-name"]),ze(iT,{show:z(Re),"is-dirty":O.value,onClose:hs,onSubmit:Do,"onUpdate:isDirty":Mt},null,8,["show","is-dirty"]),ze(uT,{show:z(xe),uploading:z(he),error:z(Q),"is-dirty":O.value,onClose:ko,onSubmit:Zt,"onUpdate:isDirty":Mt},null,8,["show","uploading","error","is-dirty"]),ze(kT,{show:z(J),importing:z(te),error:z(Oe),result:z(oe),"is-dirty":O.value,onClose:Wi,onSubmit:Wa,"onUpdate:isDirty":Mt},null,8,["show","importing","error","result","is-dirty"]),ze(RP,{show:G.value,marshal:W.value,"event-id":z(t).params.eventId,assignments:Ji(),"available-locations":Es.value,"all-locations":k.value,areas:Qe.value,"is-editing":!!W.value,"event-notes":mo.value,"all-checklist-items":ss.value,"is-dirty":O.value,onClose:hi,onSave:El,onDelete:nr,onRemoveAssignment:Pl,onAssignToLocation:or,"onUpdate:isDirty":Mt},null,8,["show","marshal","event-id","assignments","available-locations","all-locations","areas","is-editing","event-notes","all-checklist-items","is-dirty"]),ze(IT,{show:z(ue),importing:z(ke),error:z(Oe),result:z(Ee),"is-dirty":O.value,onClose:wo,onSubmit:fi,"onUpdate:isDirty":Mt},null,8,["show","importing","error","result","is-dirty"]),ze(UP,{show:q.value,"conflict-data":fe.value,onClose:ce[7]||(ce[7]=Pe=>q.value=!1),onChoice:Dl},null,8,["show","conflict-data"]),ze(YP,{show:pe.value,"location-name":w.value?.name||"",marshals:to.value,onClose:Ki,onAssignExisting:er,onCreateAndAssign:Yi},null,8,["show","location-name","marshals"]),ze(l4,{show:se.value,"old-event-date":ee.value,"new-event-date":Z.value,"affected-checkpoints-count":Ve.value,onConfirm:Ds,onCancel:di},null,8,["show","old-event-date","new-event-date","affected-checkpoints-count"]),ze(A3,{show:pt.value,area:et.value,checkpoints:k.value,marshals:F.value,areas:Qe.value,"is-dirty":O.value,"event-id":z(t).params.eventId,"all-locations":k.value,assignments:ci.value,notes:mo.value,contacts:go.value,"event-default-style-type":_.value?.defaultCheckpointStyleType||_.value?.DefaultCheckpointStyleType||"default","event-default-style-color":_.value?.defaultCheckpointStyleColor||_.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":_.value?.defaultCheckpointStyleBackgroundShape||_.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":_.value?.defaultCheckpointStyleBackgroundColor||_.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":_.value?.defaultCheckpointStyleBorderColor||_.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":_.value?.defaultCheckpointStyleIconColor||_.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":_.value?.defaultCheckpointStyleSize||_.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":_.value?.defaultCheckpointStyleMapRotation??_.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":_.value?.peopleTerm||"Marshals","event-checkpoint-term":_.value?.checkpointTerm||"Checkpoints",onClose:fn,onSave:zi,onDelete:Hn,onDrawBoundary:Lt,"onUpdate:isDirty":Mt,onSelectCheckpoint:Fs,onAddAreaContact:At,onEditContact:H},null,8,["show","area","checkpoints","marshals","areas","is-dirty","event-id","all-locations","assignments","notes","contacts","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","event-checkpoint-term"]),ze(H3,{show:vo.value,"checklist-item":hn.value,"initial-tab":is.value,areas:Qe.value,locations:k.value,marshals:F.value,"is-dirty":O.value,onClose:ot,onSave:Me,onDelete:Ge,"onUpdate:isDirty":Mt},null,8,["show","checklist-item","initial-tab","areas","locations","marshals","is-dirty"]),ze(oD,{show:Wt.value,note:Qn.value,"initial-tab":Xe.value,areas:Qe.value,locations:k.value,marshals:F.value,"is-dirty":O.value,onClose:ds,onSave:nn,onDelete:Rs,"onUpdate:isDirty":Mt},null,8,["show","note","initial-tab","areas","locations","marshals","is-dirty"]),ze(SD,{show:eo.value,contact:Qt.value,"initial-tab":Nn.value,areas:Qe.value,locations:k.value,marshals:F.value,"available-roles":as.value,"is-dirty":O.value,"preselected-area":yo.value,onClose:bn,onSave:Cl,onDelete:lt,"onUpdate:isDirty":Mt},null,8,["show","contact","initial-tab","areas","locations","marshals","available-roles","is-dirty","preselected-area"]),ze(FD,{show:z(fo),mode:z($t),"context-title":z(Yn).title,"context-description":z(Yn).description,"can-complete":tn.value,clickable:z($t)!=="draw-area","drawing-mode":z($t)==="draw-area"&&z(Jn),locations:rs.value,areas:ls.value,route:_.value?.route||[],"selected-area-id":Pt.value,center:z(Mn),zoom:z(po),onMapClick:qa,onPolygonComplete:Vi,onPolygonDrawing:Gi,onDone:Ns,onCancel:Tl},null,8,["show","mode","context-title","context-description","can-complete","clickable","drawing-mode","locations","areas","route","selected-area-id","center","zoom"]),ze(wl,{show:we.value,title:Ne.value,message:Fe.value,onClose:ce[8]||(ce[8]=Pe=>we.value=!1)},null,8,["show","title","message"]),ze(_l,{show:z(u),title:z(h),message:z(p),onConfirm:z(y),onCancel:z(x)},null,8,["show","title","message","onConfirm","onCancel"])]))}},c6=Je(l6,[["__scopeId","data-v-434e3eb4"]]),u6={key:0,class:"emergency-notes-section"},d6={class:"emergency-notes-list"},h6={class:"note-header"},f6={key:0,class:"note-content"},p6={key:1,class:"emergency-contacts-section"},v6={class:"emergency-contacts-list"},m6={class:"contact-header"},g6={key:0,class:"role-badge"},y6={class:"contact-details"},_6={key:0,class:"info-section"},k6=["href"],b6={key:1,class:"info-section"},w6=["href"],C6={key:2,class:"info-section"},L6=["href"],S6={key:2,class:"no-contacts"},x6={__name:"EmergencyContactModal",props:{show:{type:Boolean,default:!1},contacts:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const o=e,i=t,s=X(()=>o.notes?[...o.notes].sort((u,h)=>{const p=u.priority||u.Priority,f=h.priority||h.Priority;return p==="Emergency"&&f!=="Emergency"?-1:f==="Emergency"&&p!=="Emergency"?1:0}):[]),a=()=>{i("close")},l=u=>u?{EmergencyContact:"Emergency Contact",EventDirector:"Event Director",MedicalLead:"Medical Lead",SafetyOfficer:"Safety Officer",Logistics:"Logistics"}[u]||u.replace(/([A-Z])/g," $1").trim():"";return(u,h)=>(m(),rt(Ut,{show:e.show,title:"Emergency information",size:"medium",onClose:a},{actions:nt(()=>[c("button",{onClick:a,class:"btn btn-secondary"},"Close")]),default:nt(()=>[e.notes&&e.notes.length>0?(m(),g("div",u6,[h[0]||(h[0]=c("h2",{class:"section-header"},"Emergency notes",-1)),c("div",d6,[(m(!0),g(Ce,null,Be(s.value,p=>(m(),g("div",{key:p.noteId||p.NoteId,class:Te(["emergency-note-item",{"is-emergency":(p.priority||p.Priority)==="Emergency"}])},[c("div",h6,[c("h3",null,b(p.title||p.Title),1),c("span",{class:Te(["priority-badge",(p.priority||p.Priority).toLowerCase()])},b(p.priority||p.Priority),3)]),p.content||p.Content?(m(),g("div",f6,b(p.content||p.Content),1)):N("",!0)],2))),128))])])):N("",!0),e.contacts&&e.contacts.length>0?(m(),g("div",p6,[h[4]||(h[4]=c("h2",{class:"section-header"},"Emergency contacts",-1)),c("div",v6,[(m(!0),g(Ce,null,Be(e.contacts,p=>(m(),g("div",{key:p.contactId||p.name,class:"emergency-contact-item"},[c("div",m6,[c("h3",null,b(p.name),1),p.role?(m(),g("span",g6,b(l(p.role)),1)):N("",!0)]),c("div",y6,[p.phone?(m(),g("div",_6,[h[1]||(h[1]=c("label",null,"Phone number",-1)),c("a",{href:`tel:${p.phone}`,class:"phone-link"},b(p.phone),9,k6)])):N("",!0),p.email?(m(),g("div",b6,[h[2]||(h[2]=c("label",null,"Email",-1)),c("a",{href:`mailto:${p.email}`,class:"email-link"},b(p.email),9,w6)])):N("",!0),p.notes||p.details?(m(),g("div",C6,[h[3]||(h[3]=c("label",null,"Details",-1)),c("p",null,b(p.notes||p.details),1)])):N("",!0)]),p.phone?(m(),g("a",{key:0,href:`tel:${p.phone}`,class:"btn btn-danger btn-full"}," Call "+b(p.name),9,L6)):N("",!0)]))),128))])])):N("",!0),(!e.contacts||e.contacts.length===0)&&(!e.notes||e.notes.length===0)?(m(),g("div",S6,[...h[5]||(h[5]=[c("p",null,"No emergency information has been set up for this event.",-1)])])):N("",!0)]),_:1},8,["show"]))}},T6=Je(x6,[["__scopeId","data-v-3f42c790"]]),Lr=D(navigator.onLine),Ls=D(!0),ei=D(0),Sr=D(null),Ys=D("idle"),Mi=D(null);let yh=null,lc=!1,so=null;function I6(e=1e3,t=1e4){return Math.floor(Math.random()*(t-e+1))+e}function Nc(){so&&(clearTimeout(so),so=null);const e=I6(1e3,1e4);console.log(`Scheduling auto-sync in ${e}ms`),so=setTimeout(async()=>{if(so=null,!navigator.onLine){console.log("Auto-sync cancelled: offline");return}if(await jr()===0){console.log("Auto-sync cancelled: no pending actions");return}console.log("Starting auto-sync..."),await Kr();const o=await jr();o>0&&navigator.onLine&&(console.log(`${o} actions remaining, scheduling retry...`),Nc())},e)}async function va(){if(!navigator.onLine)return Ls.value=!1,!1;try{const e=new AbortController,t=setTimeout(()=>e.abort(),5e3),o=await fetch("/api/health",{method:"HEAD",signal:e.signal}).catch(()=>null);if(clearTimeout(t),!o||o.status===404)return Ls.value=!0,!0;const i=o.ok;return Ls.value=i,i}catch(e){return e.name==="AbortError"&&console.warn("Server health check timed out"),Ls.value=!1,!1}}async function $6(e){try{switch(e.type){case"checkin":await Ko.checkIn(e.payload);break;case"checkin_admin":await Ko.adminCheckIn(e.payload.eventId,e.payload.assignmentId);break;case"checklist_complete":await Et.complete(e.payload.eventId,e.payload.itemId,e.payload.data);break;case"checklist_uncomplete":await Et.uncomplete(e.payload.eventId,e.payload.itemId,e.payload.data);break;default:return console.warn("Unknown action type:",e.type),!1}return!0}catch(t){return console.error("Failed to sync action:",e,t),t.response&&t.response.status>=400&&t.response.status<500?"permanent_failure":!1}}async function Kr(){if(!lc&&navigator.onLine){lc=!0,Ys.value="syncing",Mi.value=null;try{const e=await Tp();if(e.length===0){Ys.value="success",ei.value=0;return}let t=0,o=0;for(const i of e){const s=await $6(i);if(s===!0)await rh(i.id),t++;else if(s==="permanent_failure")await rh(i.id),o++;else{const a=(i.attempts||0)+1;a>=5?(await ah(i.id,{status:"failed",attempts:a,lastAttempt:new Date().toISOString()}),o++):await ah(i.id,{status:"retrying",attempts:a,lastAttempt:new Date().toISOString()})}}ei.value=await jr(),o>0?(Ys.value="error",Mi.value=`${o} action(s) failed to sync`):Ys.value="success"}catch(e){console.error("Sync error:",e),Ys.value="error",Mi.value="Failed to sync pending actions"}finally{lc=!1}}}function M6(){yh||(yh=setInterval(async()=>{navigator.onLine&&(await va(),Ls.value&&ei.value>0&&await Kr())},3e4))}function fu(){const e=X(()=>Lr.value&&Ls.value);async function t(){ei.value=await jr()}async function o(){Lr.value=!0,await va()&&ei.value>0&&Nc()}function i(){Lr.value=!1,Ls.value=!1,so&&(clearTimeout(so),so=null)}un(async()=>{await os(),await t(),window.addEventListener("online",o),window.addEventListener("offline",i),navigator.onLine&&await va()&&ei.value>0&&Nc(),M6()}),Ao(()=>{window.removeEventListener("online",o),window.removeEventListener("offline",i),so&&(clearTimeout(so),so=null)});async function s(h,p){if(!e.value)return console.warn("Cannot refresh cache while offline"),!1;try{const f=await p();return await Da(h,f),Sr.value=new Date().toISOString(),!0}catch(f){return console.error("Failed to refresh cache:",f),!1}}async function a(h){const p=await xs(h);return p&&(Sr.value=p.cachedAt),p}async function l(h){Sr.value=await K1(h)}async function u(){return navigator.onLine?await va()?(await Kr(),Ys.value==="success"):(Mi.value="Server is not responding",!1):(Mi.value="Cannot sync while offline",!1)}return{isOnline:Lr,isServerHealthy:Ls,isFullyOnline:e,pendingActionsCount:ei,lastSyncTime:Sr,syncStatus:Ys,syncError:Mi,checkServerHealth:va,syncPendingActions:Kr,updatePendingCount:t,refreshCache:s,getCachedData:a,loadLastSyncTime:l,forcSync:u}}const A6={class:"area-lead-content"},E6={key:0,class:"loading-state"},P6={key:1,class:"error-state"},D6={key:2,class:"empty-state"},O6={key:3,class:"checkpoint-accordion"},R6=["onClick"],B6={class:"checkpoint-header-content"},N6={class:"checkpoint-title-row"},F6={class:"checkpoint-name"},U6={key:0,class:"area-badge"},z6={key:0,class:"checkpoint-description-preview"},H6={class:"checkpoint-status-row"},V6={class:"status-badge marshals-status"},G6={key:0,class:"status-badge tasks-status"},Z6={class:"accordion-icon"},j6={key:0,class:"checkpoint-accordion-content"},W6={class:"checkpoint-mini-map"},q6={class:"checkpoint-marshals-section"},K6={class:"marshals-label"},Y6={key:0,class:"empty-state"},J6={key:1,class:"marshals-list"},X6=["onClick"],Q6={class:"marshal-header"},eO={class:"marshal-name-row"},tO={class:"marshal-name"},nO={key:0,class:"task-count"},oO={class:"check-status-row"},sO=["onClick","disabled"],iO={key:0,class:"check-in-time"},aO={key:0},rO={key:1,class:"last-access-time"},lO={key:0,class:"checkpoint-tasks-section"},cO={class:"marshals-label"},uO={class:"tasks-list"},dO=["disabled","onChange"],hO={class:"task-text"},fO={key:0,class:"marshal-details-modal"},pO={class:"details-section"},vO={class:"contact-info"},mO={key:0,class:"contact-row"},gO=["href"],yO={key:1,class:"contact-row"},_O=["href"],kO={key:2,class:"no-contact"},bO={class:"details-section"},wO={key:0,class:"checked-in-section"},CO={class:"checked-in-details"},LO={class:"check-time-detail"},SO={key:0,class:"check-method"},xO=["disabled"],TO={key:1,class:"not-checked-in-section"},IO=["disabled"],$O={key:2,class:"last-access-detail"},MO={class:"details-section"},AO={key:0,class:"no-tasks"},EO={key:1,class:"tasks-list modal-tasks"},PO=["disabled","onChange"],DO={class:"task-text"},OO={class:"details-section contact-actions-section"},RO={class:"contact-buttons"},BO=["href"],NO=["href"],FO=["href"],UO={__name:"AreaLeadSection",props:{eventId:{type:String,required:!0},areaIds:{type:Array,default:()=>[]},marshalId:{type:String,required:!0},route:{type:Array,default:()=>[]}},emits:["checklist-updated","loaded","checkin-updated"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=Ct(),{updatePendingCount:a}=fu(),l=e,u=o,h=D(!1),p=D(null),f=D([]),y=D([]),x=D(null),T=D(!1),I=D(null),S=X(()=>[...y.value].sort((Q,J)=>Tn(Q.name,J.name))),R=(Q,J=60)=>Q?Q.length<=J?Q:Q.substring(0,J).trim()+"...":"";t({areas:f,checkpoints:y,loading:h});const E=D(!1),M=D(null),_=D(null),$=async()=>{if(!(!l.eventId||l.areaIds.length===0)){if(h.value=!0,p.value=null,sn()){try{const Q=await xs(l.eventId);if(Q?.areaLeadDashboard){f.value=Q.areaLeadDashboard.areas||[],y.value=Q.areaLeadDashboard.checkpoints||[],h.value=!1;return}}catch(Q){console.warn("Failed to load cached dashboard:",Q)}p.value="Offline - no cached data available",h.value=!1;return}try{const Q=await Cs.getAreaLeadDashboard(l.eventId);f.value=Q.data.areas||[],y.value=Q.data.checkpoints||[];try{const J=JSON.parse(JSON.stringify({areas:f.value,checkpoints:y.value}));await xs(l.eventId)?await ha(l.eventId,"areaLeadDashboard",J):await Da(l.eventId,{areaLeadDashboard:J})}catch(J){console.warn("Failed to cache dashboard:",J)}}catch(Q){console.error("Failed to load area lead dashboard:",Q);try{const J=await xs(l.eventId);if(J?.areaLeadDashboard){console.log("Loading area lead dashboard from cache after error"),f.value=J.areaLeadDashboard.areas||[],y.value=J.areaLeadDashboard.checkpoints||[],h.value=!1;return}}catch(J){console.warn("Failed to load cached dashboard:",J)}p.value=Q.response?.data?.message||"Failed to load dashboard"}finally{h.value=!1}}},k=Q=>{x.value=x.value===Q?null:Q},w=Q=>Q.marshals.filter(J=>J.isCheckedIn).length,A=Q=>{const J=Q.marshals.reduce((ue,te)=>ue+te.outstandingTaskCount,0);return Q.outstandingTaskCount+J},ne=(Q,J)=>{M.value=Q,_.value=J,E.value=!0},ae=()=>{E.value=!1,M.value=null,_.value=null},_e=async(Q,J)=>{if(I.value)return;const ue=Q.assignmentId||Q.id;if(!ue){console.error("No assignment ID found for marshal:",Q);return}I.value=Q.marshalId;try{if(sn())await Dn("checkin_admin",{eventId:l.eventId,assignmentId:ue}),Q.isCheckedIn=!0,Q.checkInTime=new Date().toISOString(),Q.checkInMethod="AreaLead (pending)",await a(),u("checkin-updated");else if(await Ko.adminCheckIn(l.eventId,ue),await $(),u("checkin-updated"),M.value?.marshalId===Q.marshalId&&_.value){const te=y.value.find(ke=>ke.checkpointId===_.value.checkpointId);if(te){const ke=te.marshals.find(Oe=>Oe.marshalId===Q.marshalId);ke&&(M.value=ke)}}}catch(te){console.error("Failed to check in marshal:",te),(sn()||!te.response)&&(await Dn("checkin_admin",{eventId:l.eventId,assignmentId:ue}),Q.isCheckedIn=!0,Q.checkInTime=new Date().toISOString(),Q.checkInMethod="AreaLead (pending)",await a(),u("checkin-updated"))}finally{I.value=null}},re=async(Q,J)=>{if(T.value)return;T.value=!0;const te={marshalId:J.marshals.length>0?J.marshals[0].marshalId:l.marshalId,contextType:Q.contextType,contextId:Q.contextId};try{sn()?(await Dn("checklist_complete",{eventId:l.eventId,itemId:Q.itemId,data:te}),J.outstandingTasks=J.outstandingTasks.filter(ke=>ke.itemId!==Q.itemId),J.outstandingTaskCount=Math.max(0,J.outstandingTaskCount-1),await a(),u("checklist-updated")):(await Et.complete(l.eventId,Q.itemId,te),await $(),u("checklist-updated"))}catch(ke){console.error("Failed to complete task:",ke),(sn()||!ke.response)&&(await Dn("checklist_complete",{eventId:l.eventId,itemId:Q.itemId,data:te}),J.outstandingTasks=J.outstandingTasks.filter(Oe=>Oe.itemId!==Q.itemId),J.outstandingTaskCount=Math.max(0,J.outstandingTaskCount-1),await a(),u("checklist-updated"))}finally{T.value=!1}},ve=async Q=>{if(T.value||!M.value)return;T.value=!0;const J={marshalId:M.value.marshalId,contextType:Q.contextType,contextId:Q.contextId};try{if(sn())await Dn("checklist_complete",{eventId:l.eventId,itemId:Q.itemId,data:J}),M.value.outstandingTasks=M.value.outstandingTasks.filter(ue=>ue.itemId!==Q.itemId),M.value.outstandingTaskCount=Math.max(0,M.value.outstandingTaskCount-1),await a(),u("checklist-updated");else{if(await Et.complete(l.eventId,Q.itemId,J),await $(),M.value&&_.value){const ue=y.value.find(te=>te.checkpointId===_.value.checkpointId);if(ue){const te=ue.marshals.find(ke=>ke.marshalId===M.value.marshalId);te&&(M.value=te)}}u("checklist-updated")}}catch(ue){console.error("Failed to complete task:",ue),(sn()||!ue.response)&&(await Dn("checklist_complete",{eventId:l.eventId,itemId:Q.itemId,data:J}),M.value.outstandingTasks=M.value.outstandingTasks.filter(te=>te.itemId!==Q.itemId),M.value.outstandingTaskCount=Math.max(0,M.value.outstandingTaskCount-1),await a(),u("checklist-updated"))}finally{T.value=!1}},Ie=Q=>Q?new Date(Q).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",Re=Q=>Q?new Date(Q).toLocaleString():"",xe=Q=>{if(!Q)return"";const J=new Date(Q),te=new Date-J,ke=Math.floor(te/6e4),Oe=Math.floor(ke/60),oe=Math.floor(Oe/24);return ke<1?"just now":ke<60?`${ke}m ago`:Oe<24?`${Oe}h ago`:oe===1?"yesterday":oe<7?`${oe}d ago`:J.toLocaleDateString()},he=Q=>({GPS:"GPS",Manual:"Manual",Admin:"Admin",AreaLead:`${i.value.area} Lead`})[Q]||Q;return We(()=>[l.eventId,l.areaIds],()=>{$()},{immediate:!0}),(Q,J)=>(m(),g("div",A6,[h.value?(m(),g("div",E6," Loading dashboard... ")):p.value?(m(),g("div",P6,[c("p",null,b(p.value),1),c("button",{onClick:$,class:"btn btn-secondary"},"Retry")])):S.value.length===0?(m(),g("div",D6,[c("p",null,"No "+b(z(s).checkpoints)+" in your "+b(z(s).areas)+".",1)])):(m(),g("div",O6,[(m(!0),g(Ce,null,Be(S.value,ue=>(m(),g("div",{key:ue.checkpointId,class:"checkpoint-accordion-section"},[c("button",{class:Te(["checkpoint-accordion-header",{active:x.value===ue.checkpointId}]),onClick:te=>k(ue.checkpointId)},[c("div",B6,[c("div",N6,[c("span",F6,b(ue.name),1),ue.areaName?(m(),g("span",U6,b(ue.areaName),1)):N("",!0)]),ue.description?(m(),g("div",z6,b(R(ue.description)),1)):N("",!0),c("div",H6,[c("span",V6,b(w(ue))+" / "+b(ue.marshals.length)+" checked in ",1),A(ue)>0?(m(),g("span",G6,b(A(ue))+" tasks ",1)):N("",!0)])]),c("span",Z6,b(x.value===ue.checkpointId?"":"+"),1)],10,R6),x.value===ue.checkpointId?(m(),g("div",j6,[c("div",W6,[ze(Qs,{locations:[{id:ue.checkpointId,name:ue.name,description:ue.description,latitude:ue.latitude,longitude:ue.longitude}],route:e.route,center:{lat:ue.latitude,lng:ue.longitude},zoom:16,"highlight-location-id":ue.checkpointId,"marshal-mode":!0},null,8,["locations","route","center","highlight-location-id"])]),c("div",q6,[c("div",K6,b(z(i).people)+" ("+b(ue.marshals.length)+")",1),ue.marshals.length===0?(m(),g("div",Y6," No "+b(z(s).people)+" assigned to this "+b(z(s).checkpoint)+". ",1)):(m(),g("div",J6,[(m(!0),g(Ce,null,Be(ue.marshals,te=>(m(),g("div",{key:te.marshalId,class:Te(["marshal-card",{"is-checked-in":te.isCheckedIn}]),onClick:ke=>ne(te,ue)},[c("div",Q6,[c("div",eO,[c("span",tO,b(te.name),1),te.outstandingTaskCount>0?(m(),g("span",nO,b(te.outstandingTaskCount)+" tasks ",1)):N("",!0)]),c("div",oO,[c("div",{class:Te(["check-status",{"checked-in":te.isCheckedIn}])},b(te.isCheckedIn?" Checked In":"Not Checked In"),3),c("button",{onClick:vt(ke=>_e(te),["stop"]),class:Te(["quick-checkin-btn",{"undo-btn":te.isCheckedIn}]),disabled:I.value===te.marshalId},b(I.value===te.marshalId?"...":te.isCheckedIn?"Undo":"Check In"),11,sO)])]),te.isCheckedIn&&te.checkInTime?(m(),g("div",iO,[Ze(b(Ie(te.checkInTime))+" ",1),te.checkInMethod?(m(),g("span",aO," ("+b(he(te.checkInMethod))+")",1)):N("",!0)])):N("",!0),te.lastAccessedAt?(m(),g("div",rO," Last active: "+b(xe(te.lastAccessedAt)),1)):N("",!0)],10,X6))),128))]))]),ue.outstandingTaskCount>0?(m(),g("div",lO,[c("div",cO,"Outstanding "+b(z(s).checkpoint)+" tasks ("+b(ue.outstandingTaskCount)+")",1),c("div",uO,[(m(!0),g(Ce,null,Be(ue.outstandingTasks,te=>(m(),g("div",{key:te.itemId,class:"task-item"},[c("input",{type:"checkbox",disabled:T.value,onChange:ke=>re(te,ue)},null,40,dO),c("span",hO,b(te.text),1)]))),128))])])):N("",!0)])):N("",!0)]))),128))])),ze(Ut,{show:E.value,title:M.value?.name||"Marshal Details",size:"large",onClose:ae},{actions:nt(()=>[c("button",{onClick:ae,class:"btn btn-secondary"},"Close")]),default:nt(()=>[M.value?(m(),g("div",fO,[c("div",pO,[J[4]||(J[4]=c("h4",null,"Contact Details",-1)),c("div",vO,[M.value.email?(m(),g("div",mO,[J[2]||(J[2]=c("span",{class:"contact-label"},"Email:",-1)),c("a",{href:`mailto:${M.value.email}`},b(M.value.email),9,gO)])):N("",!0),M.value.phoneNumber?(m(),g("div",yO,[J[3]||(J[3]=c("span",{class:"contact-label"},"Phone:",-1)),c("a",{href:`tel:${M.value.phoneNumber}`},b(M.value.phoneNumber),9,_O)])):N("",!0),!M.value.email&&!M.value.phoneNumber?(m(),g("div",kO," No contact details available. ")):N("",!0)])]),c("div",bO,[J[8]||(J[8]=c("h4",null,"Check-in Status",-1)),M.value.isCheckedIn?(m(),g("div",wO,[c("div",CO,[J[6]||(J[6]=c("span",{class:"check-icon"},"",-1)),c("div",null,[J[5]||(J[5]=c("strong",null,"Checked In",-1)),c("p",LO,b(Re(M.value.checkInTime)),1),M.value.checkInMethod?(m(),g("p",SO," Method: "+b(he(M.value.checkInMethod)),1)):N("",!0)])]),c("button",{onClick:J[0]||(J[0]=ue=>_e(M.value,_.value)),class:"btn btn-secondary undo-checkin-btn",disabled:I.value===M.value.marshalId},b(I.value===M.value.marshalId?"Undoing...":"Undo Check-in"),9,xO)])):(m(),g("div",TO,[J[7]||(J[7]=c("div",{class:"not-checked-in"},[c("span",{class:"not-checked-icon"},""),c("span",null,"Not checked in")],-1)),c("button",{onClick:J[1]||(J[1]=ue=>_e(M.value,_.value)),class:"btn btn-primary check-in-btn",disabled:I.value===M.value.marshalId},b(I.value===M.value.marshalId?"Checking in...":"Check In"),9,IO)])),M.value.lastAccessedAt?(m(),g("div",$O," Last active: "+b(xe(M.value.lastAccessedAt)),1)):N("",!0)]),c("div",MO,[c("h4",null,b(z(i).checklists)+" ("+b(M.value.outstandingTasks?.length||0)+" outstanding)",1),!M.value.outstandingTasks||M.value.outstandingTasks.length===0?(m(),g("div",AO," No outstanding tasks. ")):(m(),g("div",EO,[(m(!0),g(Ce,null,Be(M.value.outstandingTasks,ue=>(m(),g("div",{key:ue.itemId,class:"task-item"},[c("input",{type:"checkbox",disabled:T.value,onChange:te=>ve(ue)},null,40,PO),c("span",DO,b(ue.text),1)]))),128))]))]),c("div",OO,[c("div",RO,[M.value.phoneNumber?(m(),g("a",{key:0,href:`tel:${M.value.phoneNumber}`,class:"btn btn-primary"}," Call ",8,BO)):N("",!0),M.value.phoneNumber?(m(),g("a",{key:1,href:`sms:${M.value.phoneNumber}`,class:"btn btn-secondary"}," Text ",8,NO)):N("",!0),M.value.email?(m(),g("a",{key:2,href:`mailto:${M.value.email}`,class:"btn btn-secondary"}," Email ",8,FO)):N("",!0)])])])):N("",!0)]),_:1},8,["show","title"])]))}},zO=Je(UO,[["__scopeId","data-v-7df6c747"]]),HO={class:"offline-indicator-container"},VO={key:0,class:"offline-banner"},GO={class:"offline-text"},ZO={key:0,class:"last-sync"},jO={class:"pending-text"},WO={key:0,class:"pending-subtext"},qO={key:1,class:"syncing-text"},KO={__name:"OfflineIndicator",setup(e){const{isOnline:t,isFullyOnline:o,pendingActionsCount:i,lastSyncTime:s,syncStatus:a,syncError:l,forcSync:u}=fu(),h=D(!1),p=D(""),f=D(""),y=X(()=>{if(!s.value)return"";const T=new Date(s.value),S=new Date-T,R=Math.floor(S/6e4),E=Math.floor(R/60);return R<1?"just now":R<60?`${R}m ago`:E<24?`${E}h ago`:T.toLocaleDateString()}),x=async()=>{await u()};return We(a,T=>{T==="success"&&i.value===0?(p.value="All actions synced successfully!",f.value="success",h.value=!0,setTimeout(()=>{h.value=!1},3e3)):T==="error"&&(p.value=l.value||"Sync failed",f.value="error",h.value=!0,setTimeout(()=>{h.value=!1},5e3))}),(T,I)=>(m(),g("div",HO,[ze(ql,{name:"slide"},{default:nt(()=>[z(o)?N("",!0):(m(),g("div",VO,[I[0]||(I[0]=c("span",{class:"offline-icon"},[c("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"})])],-1)),c("span",GO,b(z(t)?"Server unavailable":"You're offline"),1),z(s)?(m(),g("span",ZO," Last synced: "+b(y.value),1)):N("",!0)]))]),_:1}),ze(ql,{name:"fade"},{default:nt(()=>[z(i)>0?(m(),g("div",{key:0,class:Te(["pending-banner",{"offline-pending":!z(o)}])},[I[1]||(I[1]=c("span",{class:"pending-icon"},[c("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})])],-1)),c("span",jO,[Ze(b(z(i))+" pending action"+b(z(i)!==1?"s":"")+" ",1),z(o)?N("",!0):(m(),g("span",WO,"(will sync when online)"))]),z(o)&&z(a)!=="syncing"?(m(),g("button",{key:0,onClick:x,class:"sync-button"}," Sync Now ")):z(a)==="syncing"?(m(),g("span",qO,"Syncing...")):N("",!0)],2)):N("",!0)]),_:1}),ze(ql,{name:"fade"},{default:nt(()=>[h.value?(m(),g("div",{key:0,class:Te(["sync-toast",f.value])},b(p.value),3)):N("",!0)]),_:1})]))}},YO=Je(KO,[["__scopeId","data-v-61340ead"]]),JO={key:0,class:"header-logo-cover"},XO=["src"],QO={key:1,class:"header-logo header-logo-left"},e5=["src"],t5={class:"header-center"},n5={key:0},o5={key:1,class:"header-event-date"},s5={class:"header-actions"},i5={key:2,class:"header-logo header-logo-right"},a5=["src"],r5={class:"container"},l5={key:0,class:"selection-card"},c5={key:1,class:"selection-card"},u5={key:0,class:"loading"},d5={key:2,class:"selection-card error-card"},h5={class:"error"},f5={key:3,class:"dashboard"},p5={key:0,class:"welcome-bar"},v5={class:"welcome-info"},m5={key:0,class:"welcome-email"},g5={key:0,class:"mode-switch"},y5={key:1,class:"mode-switch"},_5={class:"accordion"},k5={class:"accordion-section"},b5={class:"accordion-title"},w5=["innerHTML"],C5={key:0,class:"location-status active"},L5={key:1,class:"location-status"},S5={class:"accordion-icon"},x5={key:0,class:"accordion-content map-content"},T5={key:0,class:"map-selection-banner"},I5={class:"map-wrapper"},$5={class:"accordion-section"},M5={class:"accordion-title"},A5=["innerHTML"],E5={class:"accordion-icon"},P5={key:0,class:"accordion-content assignments-accordion-content"},D5={key:0,class:"empty-state"},O5={key:1,class:"checkpoint-accordion"},R5=["onClick"],B5={class:"checkpoint-header-content"},N5={class:"checkpoint-title-row"},F5=["innerHTML"],U5={key:0,class:"checkpoint-check-icon"},z5={class:"checkpoint-name"},H5={key:1,class:"area-badge"},V5={key:2,class:"checkpoint-time-badge"},G5={key:0,class:"checkpoint-description-preview"},Z5={class:"accordion-icon"},j5={key:0,class:"checkpoint-accordion-content"},W5={key:0,class:"checkpoint-mini-map"},q5=["onClick"],K5={class:"checkpoint-marshals"},Y5={class:"marshals-label"},J5={class:"marshals-list"},X5={key:0,class:"check-badge"},Q5={key:1,class:"checkpoint-area-contacts"},eR={class:"marshals-label"},tR={class:"contact-list"},nR={class:"contact-info"},oR={class:"contact-name"},sR={key:0,class:"contact-role"},iR={key:1,class:"contact-detail"},aR={key:2,class:"contact-detail"},rR={class:"contact-actions"},lR=["href"],cR=["href"],uR=["href"],dR={key:2,class:"checked-in-status"},hR={class:"check-time"},fR={key:3,class:"check-in-actions"},pR=["onClick","disabled"],vR=["onClick","disabled"],mR={key:4,class:"error"},gR={key:5,class:"dynamic-location-section"},yR={class:"dynamic-location-header"},_R={class:"dynamic-badge"},kR={key:0,class:"last-update"},bR={class:"dynamic-location-actions"},wR=["onClick","disabled"],CR=["onClick","title"],LR={class:"accordion-section"},SR={class:"accordion-title"},xR=["innerHTML"],TR={class:"accordion-icon"},IR={key:0,class:"accordion-content"},$R={key:0,class:"loading"},MR={key:1,class:"error"},AR={key:2,class:"empty-state"},ER={key:3,class:"checklist-items"},PR={class:"item-checkbox"},DR=["checked","disabled","onChange"],OR={class:"item-content"},RR={key:0,class:"item-context"},BR={key:1,class:"completion-info"},NR={class:"completion-text"},FR={class:"completion-time"},UR={key:0,class:"accordion-section"},zR={class:"accordion-title"},HR=["innerHTML"],VR={class:"accordion-icon"},GR={key:0,class:"accordion-content"},ZR={key:0,class:"loading"},jR={key:1,class:"contact-list"},WR={class:"contact-info"},qR={class:"contact-name-row"},KR={key:0,class:"primary-badge"},YR={class:"contact-name"},JR={key:1,class:"contact-role-badge"},XR={key:0,class:"contact-notes-text"},QR={key:1,class:"contact-detail"},eB={key:2,class:"contact-detail"},tB={class:"contact-actions"},nB=["href"],oB=["href"],sB=["href"],iB={class:"accordion-section"},aB={class:"accordion-title"},rB=["innerHTML"],lB={class:"accordion-icon"},cB={key:0,class:"accordion-content"},uB={key:1,class:"accordion-section"},dB={class:"accordion-title"},hB=["innerHTML"],fB={key:0,class:"area-lead-badges"},pB={class:"accordion-icon"},vB={key:0,class:"accordion-content area-lead-accordion-content"},mB={key:2,class:"accordion-section"},gB={class:"accordion-title"},yB=["innerHTML"],_B={class:"accordion-icon"},kB={key:0,class:"accordion-content"},bB={class:"event-details"},wB={key:0,class:"event-detail-row"},CB={class:"detail-value"},LB={key:1,class:"event-description"},SB={class:"detail-value"},xB={class:"modal-content check-in-reminder-modal"},TB={class:"modal-header warning"},IB={class:"modal-body"},$B={class:"reminder-message"},MB={key:0},AB={class:"reminder-hint"},EB={class:"modal-footer"},PB={class:"modal-content location-update-modal"},DB={class:"modal-header"},OB={class:"modal-body"},RB={key:0,class:"success-message"},BB={key:1},NB={class:"modal-description"},FB={key:0,class:"last-update-info"},UB={key:1,class:"gps-status active"},zB={class:"update-option"},HB=["disabled"],VB={class:"update-option auto-update-option"},GB={class:"checkbox-label"},ZB=["checked"],jB={class:"option-hint"},WB={class:"update-option"},qB=["disabled"],KB={class:"update-option"},YB={class:"option-label"},JB={key:0,class:"checkpoint-list"},XB=["onClick","disabled"],QB={key:1,class:"no-checkpoints"},e8={key:2,class:"error"},t8={key:2,class:"fullscreen-map-overlay"},n8={key:0,class:"fullscreen-map-banner"},o8={key:1,class:"fullscreen-map-container"},s8={key:2,class:"fullscreen-map-container"},i8={key:3,class:"fullscreen-map-actions"},a8={__name:"MarshalView",setup(e){const{terms:t,termsLower:o}=Ct(),{updatePendingCount:i}=fu(),s=au(),a=Ua(),l=D(!1),u=D(!1),h=D(null),p=D(null),f=D(null),y=D(null),x=X(()=>y.value?.eventRoles?y.value.eventRoles.filter(V=>V.role==="EventAreaLead").flatMap(V=>V.areaIds||[]):[]),T=X(()=>x.value.length>0),I=X(()=>y.value?.eventRoles?y.value.eventRoles.some(H=>H.role==="EventAdmin"):!1),S=X(()=>y.value?.authMethod==="SecureEmailLink"&&I.value),R=X(()=>y.value?.authMethod==="MarshalMagicCode"&&I.value),E=()=>{a.push(`/admin/events/${s.params.eventId}`)},M=D(null),_=D([]),$=D([]),k=D([]),w=D(!0),A=X(()=>{const H=M.value?.brandingPageGradientStart||Ln.pageGradientStart,V=M.value?.brandingPageGradientEnd||Ln.pageGradientEnd;return{background:`linear-gradient(135deg, ${H} 0%, ${V} 100%)`}}),ne=X(()=>{const H=M.value?.brandingHeaderGradientStart||Ln.headerGradientStart,V=M.value?.brandingHeaderGradientEnd||Ln.headerGradientEnd;return{background:`linear-gradient(135deg, ${H} 0%, ${V} 100%)`}}),ae=X(()=>{const H=M.value?.brandingHeaderGradientStart||Ln.headerGradientStart,V=M.value?.brandingHeaderGradientEnd||Ln.headerGradientEnd;return Np(H,V)}),_e=X(()=>M.value?.brandingAccentColor||Ln.accentColor),re=X(()=>Bp(_e.value)),ve=X(()=>({background:_e.value,color:re.value})),Ie=X(()=>M.value?.brandingLogoUrl||""),Re=X(()=>M.value?.brandingLogoPosition||"left"),xe=D("assignments"),he=D(null),Q=D(null),J=D(null),ue=D([]),te=D(!1),ke=D(null),Oe=D(!1),oe=D([]),Ee=D(!1),be=D(null),Se=D(null),le=D(null),pe=D(!1),q=D(!1);let fe=null,Le=null;const F=D(null),G=D(!1),W=D(!1),j=D(""),O=D(""),B=D(null),K=D(!1),ye=D(null),$e=D(new Set),we=D(null),Ne=D(null),Fe=H=>{if(!H)return!0;const V=new Date(H);return(new Date-V)/(1e3*60*60)>24},Ue=D(null),Ke=D(null);let se=null;const ee=H=>{xe.value=xe.value===H?null:H},Z=D(null),Ve=H=>{Z.value=Z.value===H?null:H};We(()=>$.value,H=>{H.length===1&&Z.value===null&&(Z.value=H[0].id)},{immediate:!0});const Ye=X(()=>$.value.map(H=>{const V=_.value.find(nn=>nn.id===H.locationId),ie=V?.areaIds||V?.AreaIds||[];let Me=null;ie.length>0&&k.value.length>0&&(Me=k.value.find(Rs=>ie.includes(Rs.id))?.name);const ot=(V?.assignments||[]).map(nn=>({...nn,effectiveIsCheckedIn:nn.isCheckedIn&&!Fe(nn.checkInTime)})),Ht=hn.value.filter(nn=>ie.includes(nn.areaId)),Vt=H.isCheckedIn&&!Fe(H.checkInTime);return{...H,location:V,areaName:Me,areaIds:ie,allMarshals:ot,areaContacts:Ht,locationName:V?.name||"Unknown Location",effectiveIsCheckedIn:Vt}})),Qe=X(()=>$.value.length>0?$.value[0]:null),et=X(()=>$.value.map(H=>H.locationId)),pt=X(()=>Ye.value.some(H=>H.location?.isDynamic||H.location?.IsDynamic)),Pt=X(()=>Ye.value.find(H=>H.location?.isDynamic||H.location?.IsDynamic)),gt=X(()=>{if(!M.value||!Ye.value.length)return[];const H=new Date,V=M.value.eventDate?new Date(M.value.eventDate):null;return Ye.value.filter(ie=>{if(ie.effectiveIsCheckedIn||$e.value.has(ie.id))return!1;const Me=ie.location;if(!Me)return!1;const Ge=Me.startTime?new Date(Me.startTime):V;if(!Ge)return!1;let ot;if(Me.endTime)ot=new Date(Me.endTime);else if(V)ot=new Date(V.getTime()+7200*1e3);else return!1;return H>=Ge&&H<ot})});We(gt,H=>{H.length>0&&!K.value&&(ye.value=H[0],K.value=!0)},{immediate:!0});const zt=H=>{$e.value.add(H),K.value=!1,ye.value=null},kn=(H,V=null)=>{we.value=H,Ne.value=V,document.body.style.overflow="hidden"},fo=()=>{we.value=null,Ne.value=null,document.body.style.overflow=""},$t=X(()=>M.value?.route?(typeof M.value.route=="string"?JSON.parse(M.value.route):M.value.route)||[]:[]),Yn=X(()=>!Qe.value||!_.value.length?null:_.value.find(H=>H.id===Qe.value.locationId)),dn=X(()=>ue.value.filter(H=>H.isCompleted&&["OnePerCheckpoint","OnePerArea","OneLeadPerArea"].includes(H.matchedScope)?H.completedByActorId===f.value:!0)),ri=X(()=>dn.value.filter(H=>H.isCompleted).length),Mn=D([]),po=D(!1),Jn=X(()=>Mn.value),Xn=X(()=>{const H=["EmergencyContact","EventDirector","MedicalLead","SafetyOfficer"];return Mn.value.filter(V=>H.includes(V.role))}),ss=X(()=>oe.value.filter(H=>{const V=H.priority||H.Priority;return V==="Emergency"||V==="Urgent"})),hn=D([]);X(()=>{if(hn.value.length===0)return[];const H={};for(const V of hn.value){const ie=V.areaId||"unknown";H[ie]||(H[ie]={areaId:V.areaId,areaName:V.areaName||"Unknown Area",contacts:[]}),H[ie].contacts.push(V)}return Object.values(H)}),X(()=>hn.value.length);const vo=(H,V)=>H.localeCompare(V,void 0,{numeric:!0,sensitivity:"base"}),is=X(()=>{if(!be.value)return[];const H=be.value.locationId;return _.value.filter(V=>V.id!==H&&V.latitude!==0&&V.longitude!==0).sort((V,ie)=>vo(V.name,ie.name))}),As=X(()=>Yn.value?{lat:Yn.value.latitude,lng:Yn.value.longitude}:Ue.value?Ue.value:_.value.length>0?{lat:_.value[0].latitude,lng:_.value[0].longitude}:{lat:51.505,lng:-.09}),mo=async(H,V)=>{u.value=!0,h.value=null,console.log("Authenticating with magic code:",{eventId:H,code:V});try{const ie=await Io.marshalLogin(H,V);if(console.log("Auth response:",ie.data),ie.data.success){localStorage.setItem("sessionToken",ie.data.sessionToken),localStorage.setItem(`marshal_${H}`,ie.data.marshalId),p.value=ie.data.person,f.value=ie.data.marshalId,l.value=!0,console.log("Authenticated as marshal:",f.value,p.value?.name);try{const Me=await Io.getMe(H);y.value=Me.data,console.log("User claims:",y.value)}catch(Me){console.warn("Failed to fetch claims:",Me)}a.replace({path:s.path,query:{}}),fn(),await Wt()}else h.value=ie.data.message||"Authentication failed"}catch(ie){console.error("Authentication failed:",ie),h.value=ie.response?.data?.message||"Invalid or expired login link"}finally{u.value=!1}},Qn=async H=>{const V=localStorage.getItem("sessionToken"),ie=localStorage.getItem(`marshal_${H}`);if(!V||!ie)return!1;try{const Me=await Io.getMe(H);if(Me.data&&Me.data.marshalId)return y.value=Me.data,p.value={personId:Me.data.personId,name:Me.data.personName,email:Me.data.personEmail},f.value=Me.data.marshalId,l.value=!0,fn(),!0}catch{localStorage.removeItem("sessionToken"),localStorage.removeItem(`marshal_${H}`)}return!1},Wt=async()=>{const H=s.params.eventId;if(console.log("Loading event data for:",{eventId:H,marshalId:f.value}),sn()){console.log("Offline mode detected, attempting to load from cache...");const Ge=await xs(H);if(Ge){if(console.log("Loaded cached data from:",Ge.cachedAt),M.value=Ge.event,k.value=Ge.areas||[],_.value=Ge.locations||[],ue.value=Ge.checklist||[],Mn.value=Ge.contacts||[],oe.value=Ge.notes||[],M.value&&Dc(M.value),f.value){const ot=[];for(const Ht of _.value){const Vt=Ht.assignments?.find(nn=>nn.marshalId===f.value);Vt&&ot.push(Vt)}$.value=ot}return}else console.warn("No cached data available while offline")}console.log("Fetching event data in parallel...");const[V,ie,Me]=await Promise.allSettled([qs.getById(H),Cs.getByEvent(H),fa.getEventStatus(H)]);if(V.status==="fulfilled"?(M.value=V.value.data,console.log("Event loaded:",M.value?.name),M.value&&Dc(M.value)):console.error("Failed to load event:",V.reason),ie.status==="fulfilled"?(k.value=ie.value.data||[],console.log("Areas loaded:",k.value.length)):console.error("Failed to load areas:",ie.reason),Me.status==="fulfilled"){if(_.value=Me.value.data?.locations||[],console.log("Locations loaded:",_.value.length),f.value){const Ge=[];for(const ot of _.value){const Ht=ot.assignments?.find(Vt=>Vt.marshalId===f.value);Ht&&Ge.push(Ht)}$.value=Ge,console.log("Total assignments found:",$.value.length)}}else console.error("Failed to load event status:",Me.reason);await Promise.allSettled([Qt(),as(),go()]);try{const Ge=JSON.parse(JSON.stringify({event:M.value,areas:k.value,locations:_.value,checklist:ue.value,contacts:Mn.value,notes:oe.value,marshalId:f.value}));await Da(H,Ge),console.log("Event data cached for offline access")}catch(Ge){console.warn("Failed to cache event data:",Ge)}kt()},Xe=async()=>{const H=s.params.eventId;if(sn()){console.log("Skipping background preload: offline");return}console.log("Starting background preload for offline data...");try{const V=await Cs.getAreaLeadDashboard(H);if(V.data){const ie=JSON.parse(JSON.stringify({areas:V.data.areas||[],checkpoints:V.data.checkpoints||[]}));await xs(H)?await ha(H,"areaLeadDashboard",ie):await Da(H,{areaLeadDashboard:ie}),console.log("Area lead dashboard cached for offline access")}}catch(V){V.response?.status!==403&&console.warn("Failed to preload area lead dashboard:",V)}console.log("Background preload complete")},go=async()=>{const H=s.params.eventId;try{const V=await Go.getMyNotes(H);oe.value=V.data||[],console.log("Notes loaded:",oe.value.length)}catch(V){console.error("Failed to load notes:",V)}},as=async()=>{const H=s.params.eventId;po.value=!0;try{const V=await Ci.getMyContacts(H);Mn.value=V.data||[],console.log("Contacts loaded:",Mn.value.length)}catch(V){console.warn("Failed to load contacts:",V),Mn.value=[]}finally{po.value=!1}},Qt=async()=>{if(!f.value){console.warn("No marshal ID, skipping checklist load");return}te.value=!0,ke.value=null;try{console.log("Fetching checklist for marshal:",f.value);const H=await Et.getMarshalChecklist(s.params.eventId,f.value);ue.value=H.data||[],console.log("Checklist loaded:",ue.value.length,"items")}catch(H){console.error("Failed to load checklist:",H.response?.status,H.response?.data),ke.value=H.response?.data?.message||"Failed to load checklist"}finally{te.value=!1}},eo=async H=>{if(Oe.value)return;Oe.value=!0;const V=s.params.eventId,ie={marshalId:f.value,contextType:H.completionContextType,contextId:H.completionContextId};try{H.isCompleted?sn()?(await Dn("checklist_uncomplete",{eventId:V,itemId:H.itemId,data:ie}),H.isCompleted=!1,H.completedAt=null,H.completedByActorName=null,await i()):(await Et.uncomplete(V,H.itemId,ie),await Qt()):sn()?(await Dn("checklist_complete",{eventId:V,itemId:H.itemId,data:ie}),H.isCompleted=!0,H.completedAt=new Date().toISOString(),H.completedByActorName=p.value?.name||"You",await i()):(await Et.complete(V,H.itemId,ie),await Qt()),await ha(V,"checklist",ue.value)}catch(Me){if(console.error("Failed to toggle checklist item:",Me),sn()||!Me.response){const Ge=H.isCompleted?"checklist_uncomplete":"checklist_complete";await Dn(Ge,{eventId:V,itemId:H.itemId,data:ie}),H.isCompleted=!H.isCompleted,await i()}else ke.value=Me.response?.data?.message||"Failed to update checklist",setTimeout(()=>{ke.value=null},3e3)}finally{Oe.value=!1}},Nn=H=>{if(!H.completionContextType||!H.completionContextId)return null;if(H.completionContextType==="Checkpoint"){const V=_.value.find(Me=>Me.id===H.completionContextId);if(!V)return null;const ie=V.description?` - ${V.description}`:"";return`At ${o.value.checkpoint} ${V.name}${ie}`}if(H.completionContextType==="Area"){const V=k.value.find(ie=>ie.id===H.completionContextId);return V?`At ${o.value.area} ${V.name}`:null}return H.completionContextType==="Personal"?"Personal item":null},yo=()=>{if(!("geolocation"in navigator)){console.warn("Geolocation not supported");return}console.log("Starting location tracking..."),se=navigator.geolocation.watchPosition(H=>{Ue.value={lat:H.coords.latitude,lng:H.coords.longitude},Ke.value=Date.now()},H=>{console.warn("Geolocation error:",{1:"Location permission denied. Please allow location access in your browser settings.",2:"Location unavailable. Make sure GPS is enabled on your device.",3:"Location request timed out. Please try again."}[H.code]||H.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},Fn=()=>{se!==null&&(navigator.geolocation.clearWatch(se),se=null)},li=async H=>{he.value=H.id,Q.value=H.id,J.value=null;const V=s.params.eventId;try{if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const ie=await new Promise((Ge,ot)=>{navigator.geolocation.getCurrentPosition(Ge,ot,{enableHighAccuracy:!0,timeout:1e4})}),Me={eventId:V,assignmentId:H.id,latitude:ie.coords.latitude,longitude:ie.coords.longitude,manualCheckIn:!1};if(sn()){await Dn("checkin",Me);const Ge=$.value.findIndex(ot=>ot.id===H.id);Ge!==-1&&($.value[Ge]={...$.value[Ge],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"GPS (pending)",checkInLatitude:ie.coords.latitude,checkInLongitude:ie.coords.longitude}),await i(),await ha(V,"locations",_.value)}else{const Ge=await Ko.checkIn(Me),ot=$.value.findIndex(Ht=>Ht.id===H.id);ot!==-1&&($.value[ot]=Ge.data)}}catch(ie){if(sn()||!ie.response){const Me={eventId:V,assignmentId:H.id,latitude:Ue.value?.lat||null,longitude:Ue.value?.lng||null,manualCheckIn:!0};await Dn("checkin",Me);const Ge=$.value.findIndex(ot=>ot.id===H.id);Ge!==-1&&($.value[Ge]={...$.value[Ge],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"Manual (pending)"}),await i()}else ie.response?.data?.message?J.value=ie.response.data.message:ie.message?J.value=ie.message:J.value="Failed to check in. Please try manual check-in."}finally{he.value=null,Q.value=null}},Fi=H=>{j.value="Manual Check-In",O.value="Are you sure you want to check in manually? This should only be used if GPS is not available.",B.value=async()=>{he.value=H.id,Q.value=H.id,J.value=null;const V=s.params.eventId,ie={eventId:V,assignmentId:H.id,latitude:null,longitude:null,manualCheckIn:!0};try{if(sn()){await Dn("checkin",ie);const Me=$.value.findIndex(Ge=>Ge.id===H.id);Me!==-1&&($.value[Me]={...$.value[Me],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"Manual (pending)"}),await i(),await ha(V,"locations",_.value)}else{const Me=await Ko.checkIn(ie),Ge=$.value.findIndex(ot=>ot.id===H.id);Ge!==-1&&($.value[Ge]=Me.data)}}catch(Me){if(sn()||!Me.response){await Dn("checkin",ie);const Ge=$.value.findIndex(ot=>ot.id===H.id);Ge!==-1&&($.value[Ge]={...$.value[Ge],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"Manual (pending)"}),await i()}else J.value="Failed to check in manually. Please contact the admin."}finally{he.value=null,Q.value=null}},W.value=!0},Ui=()=>{W.value=!1,B.value&&(B.value(),B.value=null)},ci=()=>{W.value=!1,B.value=null},Es=H=>{be.value=H,Se.value=null,le.value=null,Ee.value=!0},to=()=>{Ee.value=!1,be.value=null,Se.value=null,le.value=null,tn.value=!1},tn=D(!1),rs=()=>{tn.value=!0,Ee.value=!1,xe.value="map"},ls=H=>{if(tn.value&&be.value){Ps(be.value.locationId,H.lat,H.lng,"manual"),tn.value=!1,be.value=null;return}if(pt.value&&Pt.value){const V=Pt.value;j.value="Update location",O.value=`Update ${V.location?.name||"dynamic checkpoint"} to this location?`,B.value=async()=>{await Ps(V.locationId,H.lat,H.lng,"manual")},W.value=!0}},cs=H=>{if(!tn.value&&pt.value&&Pt.value){const V=Pt.value;if(H.id===V.locationId)return;j.value="Copy location",O.value=`Copy location from "${H.name}" to ${V.location?.name||"your dynamic checkpoint"}?`,B.value=async()=>{await Ps(V.locationId,H.latitude,H.longitude,"checkpoint",H.id)},W.value=!0}},Ps=async(H,V,ie,Me,Ge=null)=>{pe.value=!0;try{const ot=s.params.eventId,Ht={latitude:V,longitude:ie,sourceType:Me};Ge&&(Ht.sourceCheckpointId=Ge);const Vt=await xn.updatePosition(ot,H,Ht);Vt.data.success&&(q.value&&Bt(),An(H,Vt.data.latitude,Vt.data.longitude,Vt.data.lastLocationUpdate))}catch(ot){console.error("Failed to update location:",ot),ot.response?.status===403?alert("You do not have permission to update this location."):alert("Failed to update location. Please try again.")}finally{pe.value=!1}},Mt=()=>{tn.value=!1,Ee.value=!0},ui=async()=>{if(be.value){pe.value=!0,Se.value=null;try{let H,V;if(Ue.value&&Ke.value&&Date.now()-Ke.value<3e4&&(H=Ue.value.lat,V=Ue.value.lng),!H||!V){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const ot=await new Promise((Ht,Vt)=>{navigator.geolocation.getCurrentPosition(Ht,Vt,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4})});H=ot.coords.latitude,V=ot.coords.longitude}const ie=s.params.eventId,Me=be.value.locationId,Ge=await xn.updatePosition(ie,Me,{latitude:H,longitude:V,sourceType:"gps"});Ge.data.success&&(le.value="Location updated successfully!",An(Me,Ge.data.latitude,Ge.data.longitude,Ge.data.lastLocationUpdate),setTimeout(()=>to(),1500))}catch(H){console.error("Failed to update location with GPS:",H),H.response?.status===403?Se.value="You do not have permission to update this location.":H.code===1?Se.value="Location access denied. Please enable location permissions.":H.code===2?Se.value="Unable to determine your location. Please try again.":H.code===3||H.message?.includes("Timeout")?Se.value="GPS timed out. Please ensure location services are enabled and try again.":Se.value="Failed to update location. Please try again."}finally{pe.value=!1}}},us=async H=>{if(!be.value)return;const V=_.value.find(ie=>ie.id===H);if(!V){Se.value="Source checkpoint not found.";return}pe.value=!0,Se.value=null;try{const ie=s.params.eventId,Me=be.value.locationId,Ge=await xn.updatePosition(ie,Me,{latitude:V.latitude,longitude:V.longitude,sourceType:"checkpoint",sourceCheckpointId:H});Ge.data.success&&(q.value&&Bt(),le.value=`Location copied from ${V.name}!`,An(Me,Ge.data.latitude,Ge.data.longitude,Ge.data.lastLocationUpdate),setTimeout(()=>to(),1500))}catch(ie){console.error("Failed to copy location from checkpoint:",ie),ie.response?.status===403?Se.value="You do not have permission to update this location.":Se.value="Failed to update location. Please try again."}finally{pe.value=!1}},An=(H,V,ie,Me)=>{const Ge=_.value.find(ot=>ot.id===H);Ge&&(Ge.latitude=V,Ge.longitude=ie,Ge.lastLocationUpdate=Me)},Ds=H=>{q.value?Bt():di(H)},di=H=>{q.value=!0,ht(H),fe=setInterval(()=>{ht(H)},6e4)},Bt=()=>{q.value=!1,fe&&(clearInterval(fe),fe=null)},ht=async H=>{if(!(!H||!("geolocation"in navigator)))try{const V=await new Promise((Ge,ot)=>{navigator.geolocation.getCurrentPosition(Ge,ot,{enableHighAccuracy:!0,timeout:15e3})}),ie=s.params.eventId,Me=H.locationId;await xn.updatePosition(ie,Me,{latitude:V.coords.latitude,longitude:V.coords.longitude,sourceType:"gps"}),An(Me,V.coords.latitude,V.coords.longitude,new Date().toISOString())}catch(V){console.warn("Auto-update location failed:",V)}},kt=()=>{Le||!_.value.some(V=>V.isDynamic||V.IsDynamic)||(Le=setInterval(async()=>{try{const V=s.params.eventId,ie=await xn.getDynamicCheckpoints(V);if(ie.data&&Array.isArray(ie.data))for(const Me of ie.data){const Ge=_.value.find(ot=>ot.id===Me.checkpointId);Ge&&(Ge.latitude=Me.latitude,Ge.longitude=Me.longitude,Ge.lastLocationUpdate=Me.lastLocationUpdate)}}catch(V){console.warn("Failed to poll dynamic checkpoints:",V)}},6e4))},_o=()=>{Le&&(clearInterval(Le),Le=null)},Un=H=>H?.isDynamic===!0||H?.IsDynamic===!0,zn=async()=>{try{await Io.logout()}catch{}localStorage.removeItem("sessionToken"),localStorage.removeItem(`marshal_${s.params.eventId}`),l.value=!1,p.value=null,f.value=null,$.value=[],ue.value=[],hn.value=[],a.push("/")},Eo=H=>H?new Date(H).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",it=H=>H?new Date(H).toLocaleString():"",Tt=(H,V)=>{if(!H&&!V)return"";const ie=H?Eo(H):"?",Me=V?Eo(V):"?";return`${ie} - ${Me}`},Os=H=>H?new Date(H).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",Po=H=>H?new Date(H).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",qt=H=>H?H.replace(/([A-Z])/g," $1").replace(/^./,V=>V.toUpperCase()).trim():"",zi=H=>{if(!H)return"";const V=H.resolvedStyleType||H.ResolvedStyleType,ie=H.resolvedStyleBackgroundColor||H.ResolvedStyleBackgroundColor||H.resolvedStyleColor||H.ResolvedStyleColor,Me=H.resolvedStyleBorderColor||H.ResolvedStyleBorderColor,Ge=H.resolvedStyleIconColor||H.ResolvedStyleIconColor,ot=H.resolvedStyleBackgroundShape||H.ResolvedStyleBackgroundShape;return V&&V!=="default"||ie||Me||Ge||ot&&ot!=="circle"?Jt({type:V||"circle",backgroundShape:ot||"circle",backgroundColor:ie||"#667eea",borderColor:Me||"#ffffff",iconColor:Ge||"#ffffff",size:"75",outputSize:20}):`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
    <circle cx="10" cy="10" r="8" fill="#667eea" stroke="#fff" stroke-width="1.5"/>
  </svg>`};un(async()=>{const H=s.params.eventId,V=s.query.code;w.value=!0;try{V?await mo(H,V):await Qn(H)&&await Wt()}finally{w.value=!1}l.value&&(yo(),"requestIdleCallback"in window?requestIdleCallback(()=>{Xe()},{timeout:5e3}):setTimeout(()=>{Xe()},2e3))}),We(l,H=>{H?yo():Fn()}),We(()=>s.query.code,async H=>{if(H&&l.value){w.value=!0;try{await mo(s.params.eventId,H)}finally{w.value=!1}}});let Hn=null;const fn=()=>{Hn||(Hn=setInterval(async()=>{if(y.value?.marshalId)try{await Io.getMe(s.params.eventId)}catch(H){console.debug("Heartbeat failed:",H)}},300*1e3))},At=()=>{Hn&&(clearInterval(Hn),Hn=null)};return Ao(()=>{Fn(),At(),Bt(),_o()}),(H,V)=>(m(),g("div",{class:"marshal-view",style:at(A.value)},[ze(YO),c("header",{class:Te(["header",`logo-${Re.value}`]),style:at(ne.value)},[Ie.value&&Re.value==="cover"?(m(),g("div",JO,[c("img",{src:Ie.value,alt:"Event logo",class:"header-logo-cover-img"},null,8,XO)])):N("",!0),Ie.value&&Re.value==="left"?(m(),g("div",QO,[c("img",{src:Ie.value,alt:"Event logo",class:"header-logo-img"},null,8,e5)])):N("",!0),c("div",t5,[c("div",{class:"header-title",style:at({color:ae.value})},[M.value?(m(),g("h1",n5,b(M.value.name),1)):N("",!0),M.value?.eventDate?(m(),g("div",o5,b(Po(M.value.eventDate)),1)):N("",!0)],4),c("div",s5,[l.value?(m(),g("button",{key:0,onClick:V[0]||(V[0]=ie=>G.value=!0),class:"btn-emergency"}," Emergency Info ")):N("",!0),l.value?(m(),g("button",{key:1,onClick:zn,class:"btn-logout",style:at({color:ae.value})}," Logout "+b(p.value?.name||""),5)):N("",!0)])]),Ie.value&&Re.value==="right"?(m(),g("div",i5,[c("img",{src:Ie.value,alt:"Event logo",class:"header-logo-img"},null,8,a5)])):N("",!0)],6),c("div",r5,[w.value?(m(),g("div",l5,[...V[17]||(V[17]=[c("div",{class:"loading"},"Loading...",-1)])])):!l.value&&!h.value?(m(),g("div",c5,[V[18]||(V[18]=c("h2",null,"Welcome",-1)),V[19]||(V[19]=c("p",{class:"instruction"},"Please use the login link sent to you to access your marshal dashboard.",-1)),u.value?(m(),g("p",u5,"Authenticating...")):N("",!0)])):h.value?(m(),g("div",d5,[V[20]||(V[20]=c("h2",null,"Login failed",-1)),c("p",h5,b(h.value),1),V[21]||(V[21]=c("p",{class:"instruction"},"Please contact the event organiser for a new login link.",-1))])):(m(),g("div",f5,[S.value||R.value?(m(),g("div",p5,[c("div",v5,[p.value?.email?(m(),g("span",m5,b(p.value.email),1)):N("",!0)]),S.value?(m(),g("div",g5,[c("button",{onClick:E,class:"btn-mode-switch"}," Switch to Admin ")])):R.value?(m(),g("div",y5,[...V[22]||(V[22]=[c("span",{class:"reauth-hint",title:"Login via admin flow to access admin features"}," Admin access requires re-login ",-1)])])):N("",!0)])):N("",!0),c("div",_5,[c("div",k5,[c("button",{class:Te(["accordion-header",{active:xe.value==="map"}]),onClick:V[1]||(V[1]=ie=>ee("map"))},[c("span",b5,[c("span",{class:"section-icon",innerHTML:z(On)("course")},null,8,w5),Ze(" "+b(z(t).course)+" ",1),Ue.value?(m(),g("span",C5,"GPS Active")):(m(),g("span",L5,"GPS Inactive"))]),c("span",S5,b(xe.value==="map"?"":"+"),1)],2),xe.value==="map"?(m(),g("div",x5,[tn.value?(m(),g("div",T5,[c("span",null,[V[23]||(V[23]=Ze("Click on the map to set the new location for ",-1)),c("strong",null,b(be.value?.location?.name),1)]),c("button",{onClick:Mt,class:"btn btn-secondary btn-sm"},"Cancel")])):N("",!0),c("div",I5,[ze(Qs,{locations:_.value,route:$t.value,center:As.value,zoom:15,"user-location":Ue.value,"highlight-location-ids":et.value,"marshal-mode":!0,clickable:tn.value||pt.value,class:Te({"selecting-location":tn.value}),onMapClick:ls,onLocationClick:cs},null,8,["locations","route","center","user-location","highlight-location-ids","clickable","class"]),c("button",{class:"fullscreen-btn",onClick:V[2]||(V[2]=ie=>kn("course")),title:"Full screen"},[...V[24]||(V[24]=[c("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20"},[c("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"})],-1)])])])])):N("",!0)]),c("div",$5,[c("button",{class:Te(["accordion-header",{active:xe.value==="assignments"}]),onClick:V[3]||(V[3]=ie=>ee("assignments"))},[c("span",M5,[c("span",{class:"section-icon",innerHTML:z(On)("checkpoint")},null,8,A5),Ze(" Your "+b(z(o).checkpoints)+" ("+b($.value.length)+") ",1)]),c("span",E5,b(xe.value==="assignments"?"":"+"),1)],2),xe.value==="assignments"?(m(),g("div",P5,[$.value.length===0?(m(),g("div",D5,[c("p",null,"You don't have any "+b(z(o).checkpoint)+" assignments yet.",1)])):(m(),g("div",O5,[(m(!0),g(Ce,null,Be(Ye.value,ie=>(m(),g("div",{key:ie.id,class:"checkpoint-accordion-section"},[c("button",{class:Te(["checkpoint-accordion-header",{active:Z.value===ie.id,"checked-in":ie.effectiveIsCheckedIn}]),onClick:Me=>Ve(ie.id)},[c("div",B5,[c("div",N5,[c("span",{class:"checkpoint-icon",innerHTML:zi(ie.location)},null,8,F5),ie.effectiveIsCheckedIn?(m(),g("span",U5,"")):N("",!0),c("span",z5,b(ie.location?.name||ie.locationName),1),ie.areaName?(m(),g("span",H5,b(ie.areaName),1)):N("",!0),ie.location?.startTime||ie.location?.endTime?(m(),g("span",V5,b(Tt(ie.location.startTime,ie.location.endTime)),1)):N("",!0)]),ie.location?.description?(m(),g("div",G5,b(ie.location.description),1)):N("",!0)]),c("span",Z5,b(Z.value===ie.id?"":"+"),1)],10,R5),Z.value===ie.id?(m(),g("div",j5,[ie.location?(m(),g("div",W5,[ze(Qs,{locations:_.value,route:$t.value,center:{lat:ie.location.latitude,lng:ie.location.longitude},zoom:16,"user-location":Ue.value,"highlight-location-id":ie.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:pt.value,onMapClick:ls,onLocationClick:cs},null,8,["locations","route","center","user-location","highlight-location-id","clickable"]),c("button",{class:"fullscreen-btn",onClick:Me=>kn(ie.id,ie),title:"Full screen"},[...V[25]||(V[25]=[c("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18"},[c("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"})],-1)])],8,q5)])):N("",!0),c("div",K5,[c("div",Y5,b(z(t).people)+":",1),c("div",J5,[(m(!0),g(Ce,null,Be(ie.allMarshals,Me=>(m(),g("span",{key:Me.marshalId,class:Te(["marshal-tag",{"is-you":Me.marshalId===f.value,"checked-in":Me.effectiveIsCheckedIn}])},[Ze(b(Me.marshalName)+b(Me.marshalId===f.value?" (you)":"")+" ",1),Me.effectiveIsCheckedIn?(m(),g("span",X5,"")):N("",!0)],2))),128))])]),ie.areaContacts.length>0?(m(),g("div",Q5,[c("div",eR,b(z(t).area)+" contacts:",1),c("div",tR,[(m(!0),g(Ce,null,Be(ie.areaContacts,Me=>(m(),g("div",{key:Me.marshalId,class:"contact-item"},[c("div",nR,[c("div",oR,b(Me.marshalName),1),Me.role?(m(),g("div",sR,b(Me.role),1)):N("",!0),Me.phone?(m(),g("div",iR,b(Me.phone),1)):N("",!0),Me.email?(m(),g("div",aR,b(Me.email),1)):N("",!0)]),c("div",rR,[Me.phone?(m(),g("a",{key:0,href:`tel:${Me.phone}`,class:"contact-link"},[...V[26]||(V[26]=[c("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Ze(" Call ",-1)])],8,lR)):N("",!0),Me.phone?(m(),g("a",{key:1,href:`sms:${Me.phone}`,class:"contact-link"},[...V[27]||(V[27]=[c("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Ze(" Text ",-1)])],8,cR)):N("",!0),Me.email?(m(),g("a",{key:2,href:`mailto:${Me.email}`,class:"contact-link"},[...V[28]||(V[28]=[c("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Ze(" Email ",-1)])],8,uR)):N("",!0)])]))),128))])])):N("",!0),ie.effectiveIsCheckedIn?(m(),g("div",dR,[V[30]||(V[30]=c("span",{class:"check-icon"},"",-1)),c("div",null,[V[29]||(V[29]=c("strong",null,"Checked In",-1)),c("p",hR,b(Eo(ie.checkInTime)),1)])])):(m(),g("div",fR,[c("button",{onClick:Me=>li(ie),class:"btn btn-primary",disabled:he.value===ie.id,style:at(ve.value)},b(he.value===ie.id?"Checking in...":"GPS Check-In"),13,pR),c("button",{onClick:Me=>Fi(ie),class:"btn btn-secondary",disabled:he.value===ie.id}," Manual ",8,vR)])),J.value&&Q.value===ie.id?(m(),g("div",mR,b(J.value),1)):N("",!0),Un(ie.location)?(m(),g("div",gR,[c("div",yR,[c("span",_R,"Dynamic "+b(ie.location.resolvedCheckpointTerm||z(t).checkpoint),1),ie.location.lastLocationUpdate?(m(),g("span",kR," Last updated: "+b(it(ie.location.lastLocationUpdate)),1)):N("",!0)]),c("div",bR,[c("button",{onClick:Me=>Es(ie),class:"btn btn-update-location",disabled:pe.value},[...V[31]||(V[31]=[c("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1),Ze(" Update location ",-1)])],8,wR),c("button",{onClick:Me=>Ds(ie),class:Te(["btn btn-auto-update",{active:q.value}]),title:q.value?"Stop auto-updating":"Auto-update every 60 seconds"},[V[32]||(V[32]=c("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})],-1)),Ze(" "+b(q.value?"Stop":"Auto"),1)],10,CR)])])):N("",!0)])):N("",!0)]))),128))]))])):N("",!0)]),c("div",LR,[c("button",{class:Te(["accordion-header",{active:xe.value==="checklist"}]),onClick:V[4]||(V[4]=ie=>ee("checklist"))},[c("span",SR,[c("span",{class:"section-icon",innerHTML:z(On)("checklist")},null,8,xR),Ze(" Your "+b(z(o).checklists)+" ("+b(ri.value)+" of "+b(dn.value.length)+" complete) ",1)]),c("span",TR,b(xe.value==="checklist"?"":"+"),1)],2),xe.value==="checklist"?(m(),g("div",IR,[te.value?(m(),g("div",$R,"Loading checklist...")):ke.value?(m(),g("div",MR,b(ke.value),1)):dn.value.length===0?(m(),g("div",AR,[c("p",null,"No "+b(z(o).checklists)+" for you.",1)])):(m(),g("div",ER,[(m(!0),g(Ce,null,Be(dn.value,ie=>(m(),g("div",{key:`${ie.itemId}_${ie.completionContextType}_${ie.completionContextId}`,class:Te(["checklist-item",{"item-completed":ie.isCompleted}])},[c("div",PR,[c("input",{type:"checkbox",checked:ie.isCompleted,disabled:!ie.canBeCompletedByMe||Oe.value,onChange:Me=>eo(ie)},null,40,DR)]),c("div",OR,[c("div",{class:Te(["item-text",{"text-completed":ie.isCompleted}])},b(ie.text),3),Nn(ie)?(m(),g("div",RR,b(Nn(ie)),1)):N("",!0),ie.isCompleted?(m(),g("div",BR,[c("span",NR," Completed by "+b(ie.completedByActorName||"Unknown"),1),c("span",FR,b(it(ie.completedAt)),1)])):N("",!0)])],2))),128))]))])):N("",!0)]),Jn.value.length>0||po.value?(m(),g("div",UR,[c("button",{class:Te(["accordion-header",{active:xe.value==="eventContacts"}]),onClick:V[5]||(V[5]=ie=>ee("eventContacts"))},[c("span",zR,[c("span",{class:"section-icon",innerHTML:z(On)("contacts")},null,8,HR),Ze(" Your contacts ("+b(Jn.value.length)+") ",1)]),c("span",VR,b(xe.value==="eventContacts"?"":"+"),1)],2),xe.value==="eventContacts"?(m(),g("div",GR,[po.value?(m(),g("div",ZR,"Loading contacts...")):(m(),g("div",jR,[(m(!0),g(Ce,null,Be(Jn.value,ie=>(m(),g("div",{key:ie.contactId,class:Te(["contact-item",{"primary-contact":ie.isPrimary}])},[c("div",WR,[c("div",qR,[ie.isPrimary?(m(),g("span",KR,"")):N("",!0),c("span",YR,b(ie.name),1),ie.role?(m(),g("span",JR,b(qt(ie.role)),1)):N("",!0)]),ie.notes?(m(),g("div",XR,b(ie.notes),1)):N("",!0),ie.phone?(m(),g("div",QR,b(ie.phone),1)):N("",!0),ie.email?(m(),g("div",eB,b(ie.email),1)):N("",!0)]),c("div",tB,[ie.phone?(m(),g("a",{key:0,href:`tel:${ie.phone}`,class:"contact-link"},[...V[33]||(V[33]=[c("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Ze(" Call ",-1)])],8,nB)):N("",!0),ie.phone?(m(),g("a",{key:1,href:`sms:${ie.phone}`,class:"contact-link"},[...V[34]||(V[34]=[c("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Ze(" Text ",-1)])],8,oB)):N("",!0),ie.email?(m(),g("a",{key:2,href:`mailto:${ie.email}`,class:"contact-link"},[...V[35]||(V[35]=[c("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Ze(" Email ",-1)])],8,sB)):N("",!0)])],2))),128))]))])):N("",!0)])):N("",!0),c("div",iB,[c("button",{class:Te(["accordion-header",{active:xe.value==="notes"}]),onClick:V[6]||(V[6]=ie=>ee("notes"))},[c("span",aB,[c("span",{class:"section-icon",innerHTML:z(On)("notes")},null,8,rB),Ze(" Your notes ("+b(oe.value.length)+") ",1)]),c("span",lB,b(xe.value==="notes"?"":"+"),1)],2),xe.value==="notes"?(m(),g("div",cB,[ze(bl,{"event-id":z(s).params.eventId,"all-notes":oe.value,locations:_.value,areas:k.value,assignments:$.value,"show-scope":!1,onNotesChanged:go},null,8,["event-id","all-notes","locations","areas","assignments"])])):N("",!0)]),T.value?(m(),g("div",uB,[c("button",{class:Te(["accordion-header",{active:xe.value==="areaLead"}]),onClick:V[7]||(V[7]=ie=>ee("areaLead"))},[c("span",dB,[c("span",{class:"section-icon",innerHTML:z(On)("people")},null,8,hB),Ze(" Your "+b(z(o).people)+" ",1),F.value?.areas?.length>0?(m(),g("span",fB,[(m(!0),g(Ce,null,Be(F.value.areas,ie=>(m(),g("span",{key:ie.areaId,class:"area-lead-badge",style:at({backgroundColor:ie.color||"#667eea"})},b(ie.name),5))),128))])):N("",!0)]),c("span",pB,b(xe.value==="areaLead"?"":"+"),1)],2),xe.value==="areaLead"?(m(),g("div",vB,[ze(zO,{ref_key:"areaLeadRef",ref:F,"event-id":z(s).params.eventId,"area-ids":x.value,"marshal-id":f.value,route:$t.value,onChecklistUpdated:Qt},null,8,["event-id","area-ids","marshal-id","route"])])):N("",!0)])):N("",!0),M.value?.eventDate||M.value?.description?(m(),g("div",mB,[c("button",{class:Te(["accordion-header",{active:xe.value==="eventDetails"}]),onClick:V[8]||(V[8]=ie=>ee("eventDetails"))},[c("span",gB,[c("span",{class:"section-icon",innerHTML:z(On)("event")},null,8,yB),V[36]||(V[36]=Ze(" Event details ",-1))]),c("span",_B,b(xe.value==="eventDetails"?"":"+"),1)],2),xe.value==="eventDetails"?(m(),g("div",kB,[c("div",bB,[M.value.eventDate?(m(),g("div",wB,[V[37]||(V[37]=c("span",{class:"detail-label"},"Date and time",-1)),c("span",CB,b(Os(M.value.eventDate)),1)])):N("",!0),M.value.description?(m(),g("div",LB,[V[38]||(V[38]=c("span",{class:"detail-label"},"Description",-1)),c("p",SB,b(M.value.description),1)])):N("",!0)])])):N("",!0)])):N("",!0)])]))]),ze(T6,{show:G.value,contacts:Xn.value,notes:ss.value,onClose:V[9]||(V[9]=ie=>G.value=!1)},null,8,["show","contacts","notes"]),ze(_l,{show:W.value,title:j.value,message:O.value,onConfirm:Ui,onCancel:ci},null,8,["show","title","message"]),K.value&&ye.value?(m(),g("div",{key:0,class:"modal-overlay",onClick:V[13]||(V[13]=vt(ie=>zt(ye.value.id),["self"]))},[c("div",xB,[c("div",TB,[V[39]||(V[39]=c("h3",null,"Check-in reminder",-1)),c("button",{class:"modal-close",onClick:V[10]||(V[10]=ie=>zt(ye.value.id))},"")]),c("div",IB,[V[41]||(V[41]=c("div",{class:"reminder-icon"},"",-1)),c("p",$B,[Ze(" You have not checked in yet to "+b(z(t).checkpoint.toLowerCase())+" ",1),c("strong",null,b(ye.value.location?.name),1),ye.value.location?.description?(m(),g("span",MB," - "+b(ye.value.location.description),1)):N("",!0),V[40]||(V[40]=Ze(". ",-1))]),c("p",AB," Please check in when you arrive at your "+b(z(t).checkpoint.toLowerCase())+". ",1)]),c("div",EB,[c("button",{onClick:V[11]||(V[11]=ie=>zt(ye.value.id)),class:"btn btn-secondary"}," Dismiss "),c("button",{onClick:V[12]||(V[12]=ie=>{zt(ye.value.id),xe.value="assignments",Z.value=ye.value.id}),class:"btn btn-primary",style:at(ve.value)}," Go to "+b(z(t).checkpoint),5)])])])):N("",!0),Ee.value?(m(),g("div",{key:1,class:"modal-overlay",onClick:vt(to,["self"])},[c("div",PB,[c("div",DB,[c("h3",null,"Update "+b((be.value?.location?.resolvedCheckpointTerm||z(t).checkpoint).toLowerCase())+" location",1),c("button",{class:"modal-close",onClick:to},"")]),c("div",OB,[le.value?(m(),g("div",RB,b(le.value),1)):(m(),g("div",BB,[c("p",NB,[V[42]||(V[42]=Ze(" Update the position of ",-1)),c("strong",null,b(be.value?.location?.name),1)]),be.value?.location?.lastLocationUpdate?(m(),g("div",FB," Last updated: "+b(it(be.value.location.lastLocationUpdate)),1)):N("",!0),Ue.value?(m(),g("div",UB,[...V[43]||(V[43]=[c("svg",{class:"status-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),Ze(" GPS active ",-1)])])):N("",!0),c("div",zB,[c("button",{onClick:ui,class:"btn btn-primary btn-full",disabled:pe.value,style:at(ve.value)},[V[44]||(V[44]=c("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),Ze(" "+b(pe.value?"Updating...":"Use current GPS location"),1)],12,HB)]),c("div",VB,[c("label",GB,[c("input",{type:"checkbox",checked:q.value,onChange:V[14]||(V[14]=ie=>Ds(be.value))},null,40,ZB),V[45]||(V[45]=c("span",null,"Auto-update every 60 seconds",-1))]),c("p",jB,"Automatically updates the "+b(z(o).checkpoint)+" location using your GPS every minute.",1)]),c("div",WB,[c("button",{onClick:rs,class:"btn btn-secondary btn-full",disabled:pe.value},[...V[46]||(V[46]=[c("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"})],-1),Ze(" Select location on map ",-1)])],8,qB)]),c("div",KB,[c("label",YB,"Or copy location from another "+b(z(o).checkpoint)+":",1),is.value.length>0?(m(),g("div",JB,[(m(!0),g(Ce,null,Be(is.value,ie=>(m(),g("button",{key:ie.id,onClick:Me=>us(ie.id),class:"btn btn-secondary btn-checkpoint-source",disabled:pe.value},b(ie.name),9,XB))),128))])):(m(),g("p",QB," No other "+b(z(o).checkpoints)+" available to copy from. ",1))]),Se.value?(m(),g("div",e8,b(Se.value),1)):N("",!0)]))]),c("div",{class:"modal-footer"},[c("button",{onClick:to,class:"btn btn-secondary"}," Cancel ")])])])):N("",!0),we.value?(m(),g("div",t8,[c("div",{class:"fullscreen-map-header",style:at(ne.value)},[c("div",{class:"fullscreen-map-title",style:at({color:ae.value})},[we.value==="course"?(m(),g(Ce,{key:0},[Ze(b(z(t).course),1)],64)):Ne.value?(m(),g(Ce,{key:1},[Ze(b(Ne.value.location?.name),1)],64)):N("",!0)],4),c("button",{class:"fullscreen-close-btn",style:at({color:ae.value}),onClick:fo},[...V[47]||(V[47]=[c("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24"},[c("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)])],4)],4),tn.value?(m(),g("div",n8,[c("span",null,[V[48]||(V[48]=Ze("Click on the map to set the new location for ",-1)),c("strong",null,b(be.value?.location?.name),1)]),c("button",{onClick:Mt,class:"btn btn-secondary btn-sm"},"Cancel")])):N("",!0),we.value==="course"?(m(),g("div",o8,[ze(Qs,{locations:_.value,route:$t.value,center:As.value,zoom:15,"user-location":Ue.value,"highlight-location-ids":et.value,"marshal-mode":!0,clickable:tn.value||pt.value,class:Te({"selecting-location":tn.value}),onMapClick:ls,onLocationClick:cs},null,8,["locations","route","center","user-location","highlight-location-ids","clickable","class"])])):Ne.value?.location?(m(),g("div",s8,[ze(Qs,{locations:_.value,route:$t.value,center:{lat:Ne.value.location.latitude,lng:Ne.value.location.longitude},zoom:16,"user-location":Ue.value,"highlight-location-id":Ne.value.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:pt.value,onMapClick:ls,onLocationClick:cs},null,8,["locations","route","center","user-location","highlight-location-id","clickable"])])):N("",!0),Ne.value?.location?.isDynamic||we.value==="course"&&pt.value?(m(),g("div",i8,[Ne.value?(m(),g("button",{key:0,class:"btn btn-primary",style:at(ve.value),onClick:V[15]||(V[15]=ie=>Es(Ne.value))}," Update Location ",4)):Pt.value?(m(),g("button",{key:1,class:"btn btn-primary",style:at(ve.value),onClick:V[16]||(V[16]=ie=>Es(Pt.value))}," Update "+b(Pt.value.location?.name)+" Location ",5)):N("",!0)])):N("",!0)])):N("",!0)],4))}},r8=Je(a8,[["__scopeId","data-v-f7cabb29"]]),l8=[{path:"/",name:"Home",component:v_},{path:"/admin/login",name:"AdminLogin",component:lk},{path:"/admin/verify",name:"AdminVerify",component:vk},{path:"/admin/dashboard",name:"AdminDashboard",component:cb,meta:{requiresAuth:!0}},{path:"/admin/profile",name:"AdminProfile",component:Ob,meta:{requiresAuth:!0}},{path:"/admin/event/:eventId",name:"AdminEventManage",component:c6,meta:{requiresAuth:!0}},{path:"/event/:eventId",name:"MarshalView",component:r8},{path:"/:pathMatch(.*)*",redirect:"/"}],zp=c_({history:zy("/VolunteerCheckin/testing/"),routes:l8});zp.beforeEach((e,t,o)=>{const i=localStorage.getItem("adminEmail");e.meta.requiresAuth&&!i?o({name:"AdminLogin"}):o()});os().then(()=>{console.log("Offline database initialized")}).catch(e=>{console.warn("Failed to initialize offline database:",e)});const pu=Gg(ny);pu.use(Wg());pu.use(zp);pu.mount("#app");
