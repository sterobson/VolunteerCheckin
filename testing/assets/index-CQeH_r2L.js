(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function o(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=o(s);fetch(s.href,a)}})();function zc(e){const t=Object.create(null);for(const o of e.split(","))t[o]=1;return o=>o in t}const It={},Mi=[],xo=()=>{},wh=()=>!1,tl=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Hc=e=>e.startsWith("onUpdate:"),Kt=Object.assign,Vc=(e,t)=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},bv=Object.prototype.hasOwnProperty,wt=(e,t)=>bv.call(e,t),Qe=Array.isArray,Ai=e=>Ba(e)==="[object Map]",Ui=e=>Ba(e)==="[object Set]",Uu=e=>Ba(e)==="[object Date]",dt=e=>typeof e=="function",Ft=e=>typeof e=="string",co=e=>typeof e=="symbol",xt=e=>e!==null&&typeof e=="object",Ch=e=>(xt(e)||dt(e))&&dt(e.then)&&dt(e.catch),Lh=Object.prototype.toString,Ba=e=>Lh.call(e),wv=e=>Ba(e).slice(8,-1),Sh=e=>Ba(e)==="[object Object]",nl=e=>Ft(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,ga=zc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ol=e=>{const t=Object.create(null);return(o=>t[o]||(t[o]=e(o)))},Cv=/-\w/g,Kn=ol(e=>e.replace(Cv,t=>t.slice(1).toUpperCase())),Lv=/\B([A-Z])/g,Es=ol(e=>e.replace(Lv,"-$1").toLowerCase()),sl=ol(e=>e.charAt(0).toUpperCase()+e.slice(1)),Hl=ol(e=>e?`on${sl(e)}`:""),Ts=(e,t)=>!Object.is(e,t),Ar=(e,...t)=>{for(let o=0;o<e.length;o++)e[o](...t)},xh=(e,t,o,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:o})},il=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Sv=e=>{const t=Ft(e)?Number(e):NaN;return isNaN(t)?e:t};let zu;const al=()=>zu||(zu=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function st(e){if(Qe(e)){const t={};for(let o=0;o<e.length;o++){const i=e[o],s=Ft(i)?$v(i):st(i);if(s)for(const a in s)t[a]=s[a]}return t}else if(Ft(e)||xt(e))return e}const xv=/;(?![^(]*\))/g,Tv=/:([^]+)/,Iv=/\/\*[^]*?\*\//g;function $v(e){const t={};return e.replace(Iv,"").split(xv).forEach(o=>{if(o){const i=o.split(Tv);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function Te(e){let t="";if(Ft(e))t=e;else if(Qe(e))for(let o=0;o<e.length;o++){const i=Te(e[o]);i&&(t+=i+" ")}else if(xt(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}const Mv="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Av=zc(Mv);function Th(e){return!!e||e===""}function Ev(e,t){if(e.length!==t.length)return!1;let o=!0;for(let i=0;o&&i<e.length;i++)o=ai(e[i],t[i]);return o}function ai(e,t){if(e===t)return!0;let o=Uu(e),i=Uu(t);if(o||i)return o&&i?e.getTime()===t.getTime():!1;if(o=co(e),i=co(t),o||i)return e===t;if(o=Qe(e),i=Qe(t),o||i)return o&&i?Ev(e,t):!1;if(o=xt(e),i=xt(t),o||i){if(!o||!i)return!1;const s=Object.keys(e).length,a=Object.keys(t).length;if(s!==a)return!1;for(const l in e){const u=e.hasOwnProperty(l),h=t.hasOwnProperty(l);if(u&&!h||!u&&h||!ai(e[l],t[l]))return!1}}return String(e)===String(t)}function Gc(e,t){return e.findIndex(o=>ai(o,t))}const Ih=e=>!!(e&&e.__v_isRef===!0),_=e=>Ft(e)?e:e==null?"":Qe(e)||xt(e)&&(e.toString===Lh||!dt(e.toString))?Ih(e)?_(e.value):JSON.stringify(e,$h,2):String(e),$h=(e,t)=>Ih(t)?$h(e,t.value):Ai(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((o,[i,s],a)=>(o[Vl(i,a)+" =>"]=s,o),{})}:Ui(t)?{[`Set(${t.size})`]:[...t.values()].map(o=>Vl(o))}:co(t)?Vl(t):xt(t)&&!Qe(t)&&!Sh(t)?String(t):t,Vl=(e,t="")=>{var o;return co(e)?`Symbol(${(o=e.description)!=null?o:t})`:e};let nn;class Mh{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=nn,!t&&nn&&(this.index=(nn.scopes||(nn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].pause();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].resume();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].resume()}}run(t){if(this._active){const o=nn;try{return nn=this,t()}finally{nn=o}}}on(){++this._on===1&&(this.prevScope=nn,nn=this)}off(){this._on>0&&--this._on===0&&(nn=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let o,i;for(o=0,i=this.effects.length;o<i;o++)this.effects[o].stop();for(this.effects.length=0,o=0,i=this.cleanups.length;o<i;o++)this.cleanups[o]();if(this.cleanups.length=0,this.scopes){for(o=0,i=this.scopes.length;o<i;o++)this.scopes[o].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function Ah(e){return new Mh(e)}function Eh(){return nn}function Pv(e,t=!1){nn&&nn.cleanups.push(e)}let At;const Gl=new WeakSet;class Ph{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,nn&&nn.active&&nn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Gl.has(this)&&(Gl.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Oh(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Hu(this),Rh(this);const t=At,o=lo;At=this,lo=!0;try{return this.fn()}finally{Bh(this),At=t,lo=o,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Wc(t);this.deps=this.depsTail=void 0,Hu(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Gl.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){dc(this)&&this.run()}get dirty(){return dc(this)}}let Dh=0,ya,_a;function Oh(e,t=!1){if(e.flags|=8,t){e.next=_a,_a=e;return}e.next=ya,ya=e}function Zc(){Dh++}function jc(){if(--Dh>0)return;if(_a){let t=_a;for(_a=void 0;t;){const o=t.next;t.next=void 0,t.flags&=-9,t=o}}let e;for(;ya;){let t=ya;for(ya=void 0;t;){const o=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){e||(e=i)}t=o}}if(e)throw e}function Rh(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Bh(e){let t,o=e.depsTail,i=o;for(;i;){const s=i.prevDep;i.version===-1?(i===o&&(o=s),Wc(i),Dv(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=s}e.deps=t,e.depsTail=o}function dc(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Nh(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Nh(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===xa)||(e.globalVersion=xa,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!dc(e))))return;e.flags|=2;const t=e.dep,o=At,i=lo;At=e,lo=!0;try{Rh(e);const s=e.fn(e._value);(t.version===0||Ts(s,e._value))&&(e.flags|=128,e._value=s,t.version++)}catch(s){throw t.version++,s}finally{At=o,lo=i,Bh(e),e.flags&=-3}}function Wc(e,t=!1){const{dep:o,prevSub:i,nextSub:s}=e;if(i&&(i.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=i,e.nextSub=void 0),o.subs===e&&(o.subs=i,!i&&o.computed)){o.computed.flags&=-5;for(let a=o.computed.deps;a;a=a.nextDep)Wc(a,!0)}!t&&!--o.sc&&o.map&&o.map.delete(o.key)}function Dv(e){const{prevDep:t,nextDep:o}=e;t&&(t.nextDep=o,e.prevDep=void 0),o&&(o.prevDep=t,e.nextDep=void 0)}let lo=!0;const Fh=[];function es(){Fh.push(lo),lo=!1}function ts(){const e=Fh.pop();lo=e===void 0?!0:e}function Hu(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const o=At;At=void 0;try{t()}finally{At=o}}}let xa=0;class Ov{constructor(t,o){this.sub=t,this.dep=o,this.version=o.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class qc{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!At||!lo||At===this.computed)return;let o=this.activeLink;if(o===void 0||o.sub!==At)o=this.activeLink=new Ov(At,this),At.deps?(o.prevDep=At.depsTail,At.depsTail.nextDep=o,At.depsTail=o):At.deps=At.depsTail=o,Uh(o);else if(o.version===-1&&(o.version=this.version,o.nextDep)){const i=o.nextDep;i.prevDep=o.prevDep,o.prevDep&&(o.prevDep.nextDep=i),o.prevDep=At.depsTail,o.nextDep=void 0,At.depsTail.nextDep=o,At.depsTail=o,At.deps===o&&(At.deps=i)}return o}trigger(t){this.version++,xa++,this.notify(t)}notify(t){Zc();try{for(let o=this.subs;o;o=o.prevSub)o.sub.notify()&&o.sub.dep.notify()}finally{jc()}}}function Uh(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)Uh(i)}const o=e.dep.subs;o!==e&&(e.prevSub=o,o&&(o.nextSub=e)),e.dep.subs=e}}const zr=new WeakMap,ni=Symbol(""),hc=Symbol(""),Ta=Symbol("");function sn(e,t,o){if(lo&&At){let i=zr.get(e);i||zr.set(e,i=new Map);let s=i.get(o);s||(i.set(o,s=new qc),s.map=i,s.key=o),s.track()}}function jo(e,t,o,i,s,a){const l=zr.get(e);if(!l){xa++;return}const u=h=>{h&&h.trigger()};if(Zc(),t==="clear")l.forEach(u);else{const h=Qe(e),p=h&&nl(o);if(h&&o==="length"){const f=Number(i);l.forEach((y,k)=>{(k==="length"||k===Ta||!co(k)&&k>=f)&&u(y)})}else switch((o!==void 0||l.has(void 0))&&u(l.get(o)),p&&u(l.get(Ta)),t){case"add":h?p&&u(l.get("length")):(u(l.get(ni)),Ai(e)&&u(l.get(hc)));break;case"delete":h||(u(l.get(ni)),Ai(e)&&u(l.get(hc)));break;case"set":Ai(e)&&u(l.get(ni));break}}jc()}function Rv(e,t){const o=zr.get(e);return o&&o.get(t)}function Ci(e){const t=gt(e);return t===e?t:(sn(t,"iterate",Ta),On(e)?t:t.map(uo))}function rl(e){return sn(e=gt(e),"iterate",Ta),e}function ks(e,t){return ns(e)?Xo(e)?Oi(uo(t)):Oi(t):uo(t)}const Bv={__proto__:null,[Symbol.iterator](){return Zl(this,Symbol.iterator,e=>ks(this,e))},concat(...e){return Ci(this).concat(...e.map(t=>Qe(t)?Ci(t):t))},entries(){return Zl(this,"entries",e=>(e[1]=ks(this,e[1]),e))},every(e,t){return Uo(this,"every",e,t,void 0,arguments)},filter(e,t){return Uo(this,"filter",e,t,o=>o.map(i=>ks(this,i)),arguments)},find(e,t){return Uo(this,"find",e,t,o=>ks(this,o),arguments)},findIndex(e,t){return Uo(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Uo(this,"findLast",e,t,o=>ks(this,o),arguments)},findLastIndex(e,t){return Uo(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Uo(this,"forEach",e,t,void 0,arguments)},includes(...e){return jl(this,"includes",e)},indexOf(...e){return jl(this,"indexOf",e)},join(e){return Ci(this).join(e)},lastIndexOf(...e){return jl(this,"lastIndexOf",e)},map(e,t){return Uo(this,"map",e,t,void 0,arguments)},pop(){return aa(this,"pop")},push(...e){return aa(this,"push",e)},reduce(e,...t){return Vu(this,"reduce",e,t)},reduceRight(e,...t){return Vu(this,"reduceRight",e,t)},shift(){return aa(this,"shift")},some(e,t){return Uo(this,"some",e,t,void 0,arguments)},splice(...e){return aa(this,"splice",e)},toReversed(){return Ci(this).toReversed()},toSorted(e){return Ci(this).toSorted(e)},toSpliced(...e){return Ci(this).toSpliced(...e)},unshift(...e){return aa(this,"unshift",e)},values(){return Zl(this,"values",e=>ks(this,e))}};function Zl(e,t,o){const i=rl(e),s=i[t]();return i!==e&&!On(e)&&(s._next=s.next,s.next=()=>{const a=s._next();return a.done||(a.value=o(a.value)),a}),s}const Nv=Array.prototype;function Uo(e,t,o,i,s,a){const l=rl(e),u=l!==e&&!On(e),h=l[t];if(h!==Nv[t]){const y=h.apply(e,a);return u?uo(y):y}let p=o;l!==e&&(u?p=function(y,k){return o.call(this,ks(e,y),k,e)}:o.length>2&&(p=function(y,k){return o.call(this,y,k,e)}));const f=h.call(l,p,i);return u&&s?s(f):f}function Vu(e,t,o,i){const s=rl(e);let a=o;return s!==e&&(On(e)?o.length>3&&(a=function(l,u,h){return o.call(this,l,u,h,e)}):a=function(l,u,h){return o.call(this,l,ks(e,u),h,e)}),s[t](a,...i)}function jl(e,t,o){const i=gt(e);sn(i,"iterate",Ta);const s=i[t](...o);return(s===-1||s===!1)&&ll(o[0])?(o[0]=gt(o[0]),i[t](...o)):s}function aa(e,t,o=[]){es(),Zc();const i=gt(e)[t].apply(e,o);return jc(),ts(),i}const Fv=zc("__proto__,__v_isRef,__isVue"),zh=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(co));function Uv(e){co(e)||(e=String(e));const t=gt(this);return sn(t,"has",e),t.hasOwnProperty(e)}class Hh{constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,i){if(o==="__v_skip")return t.__v_skip;const s=this._isReadonly,a=this._isShallow;if(o==="__v_isReactive")return!s;if(o==="__v_isReadonly")return s;if(o==="__v_isShallow")return a;if(o==="__v_raw")return i===(s?a?Yv:jh:a?Zh:Gh).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const l=Qe(t);if(!s){let h;if(l&&(h=Bv[o]))return h;if(o==="hasOwnProperty")return Uv}const u=Reflect.get(t,o,Nt(t)?t:i);if((co(o)?zh.has(o):Fv(o))||(s||sn(t,"get",o),a))return u;if(Nt(u)){const h=l&&nl(o)?u:u.value;return s&&xt(h)?pc(h):h}return xt(u)?s?pc(u):Na(u):u}}class Vh extends Hh{constructor(t=!1){super(!1,t)}set(t,o,i,s){let a=t[o];const l=Qe(t)&&nl(o);if(!this._isShallow){const p=ns(a);if(!On(i)&&!ns(i)&&(a=gt(a),i=gt(i)),!l&&Nt(a)&&!Nt(i))return p||(a.value=i),!0}const u=l?Number(o)<t.length:wt(t,o),h=Reflect.set(t,o,i,Nt(t)?t:s);return t===gt(s)&&(u?Ts(i,a)&&jo(t,"set",o,i):jo(t,"add",o,i)),h}deleteProperty(t,o){const i=wt(t,o);t[o];const s=Reflect.deleteProperty(t,o);return s&&i&&jo(t,"delete",o,void 0),s}has(t,o){const i=Reflect.has(t,o);return(!co(o)||!zh.has(o))&&sn(t,"has",o),i}ownKeys(t){return sn(t,"iterate",Qe(t)?"length":ni),Reflect.ownKeys(t)}}class zv extends Hh{constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const Hv=new Vh,Vv=new zv,Gv=new Vh(!0);const fc=e=>e,br=e=>Reflect.getPrototypeOf(e);function Zv(e,t,o){return function(...i){const s=this.__v_raw,a=gt(s),l=Ai(a),u=e==="entries"||e===Symbol.iterator&&l,h=e==="keys"&&l,p=s[e](...i),f=o?fc:t?Oi:uo;return!t&&sn(a,"iterate",h?hc:ni),{next(){const{value:y,done:k}=p.next();return k?{value:y,done:k}:{value:u?[f(y[0]),f(y[1])]:f(y),done:k}},[Symbol.iterator](){return this}}}}function wr(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function jv(e,t){const o={get(s){const a=this.__v_raw,l=gt(a),u=gt(s);e||(Ts(s,u)&&sn(l,"get",s),sn(l,"get",u));const{has:h}=br(l),p=t?fc:e?Oi:uo;if(h.call(l,s))return p(a.get(s));if(h.call(l,u))return p(a.get(u));a!==l&&a.get(s)},get size(){const s=this.__v_raw;return!e&&sn(gt(s),"iterate",ni),s.size},has(s){const a=this.__v_raw,l=gt(a),u=gt(s);return e||(Ts(s,u)&&sn(l,"has",s),sn(l,"has",u)),s===u?a.has(s):a.has(s)||a.has(u)},forEach(s,a){const l=this,u=l.__v_raw,h=gt(u),p=t?fc:e?Oi:uo;return!e&&sn(h,"iterate",ni),u.forEach((f,y)=>s.call(a,p(f),p(y),l))}};return Kt(o,e?{add:wr("add"),set:wr("set"),delete:wr("delete"),clear:wr("clear")}:{add(s){!t&&!On(s)&&!ns(s)&&(s=gt(s));const a=gt(this);return br(a).has.call(a,s)||(a.add(s),jo(a,"add",s,s)),this},set(s,a){!t&&!On(a)&&!ns(a)&&(a=gt(a));const l=gt(this),{has:u,get:h}=br(l);let p=u.call(l,s);p||(s=gt(s),p=u.call(l,s));const f=h.call(l,s);return l.set(s,a),p?Ts(a,f)&&jo(l,"set",s,a):jo(l,"add",s,a),this},delete(s){const a=gt(this),{has:l,get:u}=br(a);let h=l.call(a,s);h||(s=gt(s),h=l.call(a,s)),u&&u.call(a,s);const p=a.delete(s);return h&&jo(a,"delete",s,void 0),p},clear(){const s=gt(this),a=s.size!==0,l=s.clear();return a&&jo(s,"clear",void 0,void 0),l}}),["keys","values","entries",Symbol.iterator].forEach(s=>{o[s]=Zv(s,e,t)}),o}function Kc(e,t){const o=jv(e,t);return(i,s,a)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?i:Reflect.get(wt(o,s)&&s in i?o:i,s,a)}const Wv={get:Kc(!1,!1)},qv={get:Kc(!1,!0)},Kv={get:Kc(!0,!1)};const Gh=new WeakMap,Zh=new WeakMap,jh=new WeakMap,Yv=new WeakMap;function Jv(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Xv(e){return e.__v_skip||!Object.isExtensible(e)?0:Jv(wv(e))}function Na(e){return ns(e)?e:Yc(e,!1,Hv,Wv,Gh)}function Wh(e){return Yc(e,!1,Gv,qv,Zh)}function pc(e){return Yc(e,!0,Vv,Kv,jh)}function Yc(e,t,o,i,s){if(!xt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=Xv(e);if(a===0)return e;const l=s.get(e);if(l)return l;const u=new Proxy(e,a===2?i:o);return s.set(e,u),u}function Xo(e){return ns(e)?Xo(e.__v_raw):!!(e&&e.__v_isReactive)}function ns(e){return!!(e&&e.__v_isReadonly)}function On(e){return!!(e&&e.__v_isShallow)}function ll(e){return e?!!e.__v_raw:!1}function gt(e){const t=e&&e.__v_raw;return t?gt(t):e}function Jc(e){return!wt(e,"__v_skip")&&Object.isExtensible(e)&&xh(e,"__v_skip",!0),e}const uo=e=>xt(e)?Na(e):e,Oi=e=>xt(e)?pc(e):e;function Nt(e){return e?e.__v_isRef===!0:!1}function P(e){return qh(e,!1)}function Qv(e){return qh(e,!0)}function qh(e,t){return Nt(e)?e:new em(e,t)}class em{constructor(t,o){this.dep=new qc,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=o?t:gt(t),this._value=o?t:uo(t),this.__v_isShallow=o}get value(){return this.dep.track(),this._value}set value(t){const o=this._rawValue,i=this.__v_isShallow||On(t)||ns(t);t=i?t:gt(t),Ts(t,o)&&(this._rawValue=t,this._value=i?t:uo(t),this.dep.trigger())}}function z(e){return Nt(e)?e.value:e}const tm={get:(e,t,o)=>t==="__v_raw"?e:z(Reflect.get(e,t,o)),set:(e,t,o,i)=>{const s=e[t];return Nt(s)&&!Nt(o)?(s.value=o,!0):Reflect.set(e,t,o,i)}};function Kh(e){return Xo(e)?e:new Proxy(e,tm)}function nm(e){const t=Qe(e)?new Array(e.length):{};for(const o in e)t[o]=sm(e,o);return t}class om{constructor(t,o,i){this._object=t,this._key=o,this._defaultValue=i,this.__v_isRef=!0,this._value=void 0,this._raw=gt(t);let s=!0,a=t;if(!Qe(t)||!nl(String(o)))do s=!ll(a)||On(a);while(s&&(a=a.__v_raw));this._shallow=s}get value(){let t=this._object[this._key];return this._shallow&&(t=z(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&Nt(this._raw[this._key])){const o=this._object[this._key];if(Nt(o)){o.value=t;return}}this._object[this._key]=t}get dep(){return Rv(this._raw,this._key)}}function sm(e,t,o){return new om(e,t,o)}class im{constructor(t,o,i){this.fn=t,this.setter=o,this._value=void 0,this.dep=new qc(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=xa-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!o,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&At!==this)return Oh(this,!0),!0}get value(){const t=this.dep.track();return Nh(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function am(e,t,o=!1){let i,s;return dt(e)?i=e:(i=e.get,s=e.set),new im(i,s,o)}const Cr={},Hr=new WeakMap;let Ws;function rm(e,t=!1,o=Ws){if(o){let i=Hr.get(o);i||Hr.set(o,i=[]),i.push(e)}}function lm(e,t,o=It){const{immediate:i,deep:s,once:a,scheduler:l,augmentJob:u,call:h}=o,p=x=>s?x:On(x)||s===!1||s===0?Wo(x,1):Wo(x);let f,y,k,I,M=!1,b=!1;if(Nt(e)?(y=()=>e.value,M=On(e)):Xo(e)?(y=()=>p(e),M=!0):Qe(e)?(b=!0,M=e.some(x=>Xo(x)||On(x)),y=()=>e.map(x=>{if(Nt(x))return x.value;if(Xo(x))return p(x);if(dt(x))return h?h(x,2):x()})):dt(e)?t?y=h?()=>h(e,2):e:y=()=>{if(k){es();try{k()}finally{ts()}}const x=Ws;Ws=f;try{return h?h(e,3,[I]):e(I)}finally{Ws=x}}:y=xo,t&&s){const x=y,T=s===!0?1/0:s;y=()=>Wo(x(),T)}const B=Eh(),E=()=>{f.stop(),B&&B.active&&Vc(B.effects,f)};if(a&&t){const x=t;t=(...T)=>{x(...T),E()}}let A=b?new Array(e.length).fill(Cr):Cr;const C=x=>{if(!(!(f.flags&1)||!f.dirty&&!x))if(t){const T=f.run();if(s||M||(b?T.some((S,$)=>Ts(S,A[$])):Ts(T,A))){k&&k();const S=Ws;Ws=f;try{const $=[T,A===Cr?void 0:b&&A[0]===Cr?[]:A,I];A=T,h?h(t,3,$):t(...$)}finally{Ws=S}}}else f.run()};return u&&u(C),f=new Ph(y),f.scheduler=l?()=>l(C,!1):C,I=x=>rm(x,!1,f),k=f.onStop=()=>{const x=Hr.get(f);if(x){if(h)h(x,4);else for(const T of x)T();Hr.delete(f)}},t?i?C(!0):A=f.run():l?l(C.bind(null,!0),!0):f.run(),E.pause=f.pause.bind(f),E.resume=f.resume.bind(f),E.stop=E,E}function Wo(e,t=1/0,o){if(t<=0||!xt(e)||e.__v_skip||(o=o||new Map,(o.get(e)||0)>=t))return e;if(o.set(e,t),t--,Nt(e))Wo(e.value,t,o);else if(Qe(e))for(let i=0;i<e.length;i++)Wo(e[i],t,o);else if(Ui(e)||Ai(e))e.forEach(i=>{Wo(i,t,o)});else if(Sh(e)){for(const i in e)Wo(e[i],t,o);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&Wo(e[i],t,o)}return e}function Fa(e,t,o,i){try{return i?e(...i):e()}catch(s){cl(s,t,o)}}function ho(e,t,o,i){if(dt(e)){const s=Fa(e,t,o,i);return s&&Ch(s)&&s.catch(a=>{cl(a,t,o)}),s}if(Qe(e)){const s=[];for(let a=0;a<e.length;a++)s.push(ho(e[a],t,o,i));return s}}function cl(e,t,o,i=!0){const s=t?t.vnode:null,{errorHandler:a,throwUnhandledErrorInProduction:l}=t&&t.appContext.config||It;if(t){let u=t.parent;const h=t.proxy,p=`https://vuejs.org/error-reference/#runtime-${o}`;for(;u;){const f=u.ec;if(f){for(let y=0;y<f.length;y++)if(f[y](e,h,p)===!1)return}u=u.parent}if(a){es(),Fa(a,null,10,[e,h,p]),ts();return}}cm(e,o,s,i,l)}function cm(e,t,o,i=!0,s=!1){if(s)throw e;console.error(e)}const pn=[];let wo=-1;const Ei=[];let bs=null,Si=0;const Yh=Promise.resolve();let Vr=null;function Qo(e){const t=Vr||Yh;return e?t.then(this?e.bind(this):e):t}function um(e){let t=wo+1,o=pn.length;for(;t<o;){const i=t+o>>>1,s=pn[i],a=Ia(s);a<e||a===e&&s.flags&2?t=i+1:o=i}return t}function Xc(e){if(!(e.flags&1)){const t=Ia(e),o=pn[pn.length-1];!o||!(e.flags&2)&&t>=Ia(o)?pn.push(e):pn.splice(um(t),0,e),e.flags|=1,Jh()}}function Jh(){Vr||(Vr=Yh.then(Qh))}function dm(e){Qe(e)?Ei.push(...e):bs&&e.id===-1?bs.splice(Si+1,0,e):e.flags&1||(Ei.push(e),e.flags|=1),Jh()}function Gu(e,t,o=wo+1){for(;o<pn.length;o++){const i=pn[o];if(i&&i.flags&2){if(e&&i.id!==e.uid)continue;pn.splice(o,1),o--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function Xh(e){if(Ei.length){const t=[...new Set(Ei)].sort((o,i)=>Ia(o)-Ia(i));if(Ei.length=0,bs){bs.push(...t);return}for(bs=t,Si=0;Si<bs.length;Si++){const o=bs[Si];o.flags&4&&(o.flags&=-2),o.flags&8||o(),o.flags&=-2}bs=null,Si=0}}const Ia=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Qh(e){try{for(wo=0;wo<pn.length;wo++){const t=pn[wo];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Fa(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;wo<pn.length;wo++){const t=pn[wo];t&&(t.flags&=-2)}wo=-1,pn.length=0,Xh(),Vr=null,(pn.length||Ei.length)&&Qh()}}let Xt=null,ef=null;function Gr(e){const t=Xt;return Xt=e,ef=e&&e.type.__scopeId||null,t}function et(e,t=Xt,o){if(!t||e._n)return e;const i=(...s)=>{i._d&&Wr(-1);const a=Gr(t);let l;try{l=e(...s)}finally{Gr(a),i._d&&Wr(1)}return l};return i._n=!0,i._c=!0,i._d=!0,i}function je(e,t){if(Xt===null)return e;const o=vl(Xt),i=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[a,l,u,h=It]=t[s];a&&(dt(a)&&(a={mounted:a,updated:a}),a.deep&&Wo(l),i.push({dir:a,instance:o,value:l,oldValue:void 0,arg:u,modifiers:h}))}return e}function Hs(e,t,o,i){const s=e.dirs,a=t&&t.dirs;for(let l=0;l<s.length;l++){const u=s[l];a&&(u.oldValue=a[l].value);let h=u.dir[i];h&&(es(),ho(h,o,8,[e.el,u,e,t]),ts())}}function Er(e,t){if(rn){let o=rn.provides;const i=rn.parent&&rn.parent.provides;i===o&&(o=rn.provides=Object.create(i)),o[e]=t}}function Wn(e,t,o=!1){const i=ou();if(i||oi){let s=oi?oi._context.provides:i?i.parent==null||i.ce?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return o&&dt(t)?t.call(i&&i.proxy):t}}function hm(){return!!(ou()||oi)}const fm=Symbol.for("v-scx"),pm=()=>Wn(fm);function qe(e,t,o){return tf(e,t,o)}function tf(e,t,o=It){const{immediate:i,deep:s,flush:a,once:l}=o,u=Kt({},o),h=t&&i||!t&&a!=="post";let p;if(Ea){if(a==="sync"){const I=pm();p=I.__watcherHandles||(I.__watcherHandles=[])}else if(!h){const I=()=>{};return I.stop=xo,I.resume=xo,I.pause=xo,I}}const f=rn;u.call=(I,M,b)=>ho(I,f,M,b);let y=!1;a==="post"?u.scheduler=I=>{hn(I,f&&f.suspense)}:a!=="sync"&&(y=!0,u.scheduler=(I,M)=>{M?I():Xc(I)}),u.augmentJob=I=>{t&&(I.flags|=4),y&&(I.flags|=2,f&&(I.id=f.uid,I.i=f))};const k=lm(e,t,u);return Ea&&(p?p.push(k):h&&k()),k}function vm(e,t,o){const i=this.proxy,s=Ft(e)?e.includes(".")?nf(i,e):()=>i[e]:e.bind(i,i);let a;dt(t)?a=t:(a=t.handler,o=t);const l=Ua(this),u=tf(s,a.bind(i),o);return l(),u}function nf(e,t){const o=t.split(".");return()=>{let i=e;for(let s=0;s<o.length&&i;s++)i=i[o[s]];return i}}const of=Symbol("_vte"),sf=e=>e.__isTeleport,ka=e=>e&&(e.disabled||e.disabled===""),Zu=e=>e&&(e.defer||e.defer===""),ju=e=>typeof SVGElement<"u"&&e instanceof SVGElement,Wu=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,vc=(e,t)=>{const o=e&&e.to;return Ft(o)?t?t(o):null:o},af={name:"Teleport",__isTeleport:!0,process(e,t,o,i,s,a,l,u,h,p){const{mc:f,pc:y,pbc:k,o:{insert:I,querySelector:M,createText:b,createComment:B}}=p,E=ka(t.props);let{shapeFlag:A,children:C,dynamicChildren:x}=t;if(e==null){const T=t.el=b(""),S=t.anchor=b("");I(T,o,i),I(S,o,i);const $=(ce,_e)=>{A&16&&f(C,ce,_e,s,a,l,u,h)},se=()=>{const ce=t.target=vc(t.props,M),_e=rf(ce,t,b,I);ce&&(l!=="svg"&&ju(ce)?l="svg":l!=="mathml"&&Wu(ce)&&(l="mathml"),s&&s.isCE&&(s.ce._teleportTargets||(s.ce._teleportTargets=new Set)).add(ce),E||($(ce,_e),Pr(t,!1)))};E&&($(o,S),Pr(t,!0)),Zu(t.props)?(t.el.__isMounted=!1,hn(()=>{se(),delete t.el.__isMounted},a)):se()}else{if(Zu(t.props)&&e.el.__isMounted===!1){hn(()=>{af.process(e,t,o,i,s,a,l,u,h,p)},a);return}t.el=e.el,t.targetStart=e.targetStart;const T=t.anchor=e.anchor,S=t.target=e.target,$=t.targetAnchor=e.targetAnchor,se=ka(e.props),ce=se?o:S,_e=se?T:$;if(l==="svg"||ju(S)?l="svg":(l==="mathml"||Wu(S))&&(l="mathml"),x?(k(e.dynamicChildren,x,ce,s,a,l,u),tu(e,t,!0)):h||y(e,t,ce,_e,s,a,l,u,!1),E)se?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):Lr(t,o,T,p,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const ae=t.target=vc(t.props,M);ae&&Lr(t,ae,null,p,0)}else se&&Lr(t,S,$,p,1);Pr(t,E)}},remove(e,t,o,{um:i,o:{remove:s}},a){const{shapeFlag:l,children:u,anchor:h,targetStart:p,targetAnchor:f,target:y,props:k}=e;if(y&&(s(p),s(f)),a&&s(h),l&16){const I=a||!ka(k);for(let M=0;M<u.length;M++){const b=u[M];i(b,t,o,I,!!b.dynamicChildren)}}},move:Lr,hydrate:mm};function Lr(e,t,o,{o:{insert:i},m:s},a=2){a===0&&i(e.targetAnchor,t,o);const{el:l,anchor:u,shapeFlag:h,children:p,props:f}=e,y=a===2;if(y&&i(l,t,o),(!y||ka(f))&&h&16)for(let k=0;k<p.length;k++)s(p[k],t,o,2);y&&i(u,t,o)}function mm(e,t,o,i,s,a,{o:{nextSibling:l,parentNode:u,querySelector:h,insert:p,createText:f}},y){function k(b,B,E,A){B.anchor=y(l(b),B,u(b),o,i,s,a),B.targetStart=E,B.targetAnchor=A}const I=t.target=vc(t.props,h),M=ka(t.props);if(I){const b=I._lpa||I.firstChild;if(t.shapeFlag&16)if(M)k(e,t,b,b&&l(b));else{t.anchor=l(e);let B=b;for(;B;){if(B&&B.nodeType===8){if(B.data==="teleport start anchor")t.targetStart=B;else if(B.data==="teleport anchor"){t.targetAnchor=B,I._lpa=t.targetAnchor&&l(t.targetAnchor);break}}B=l(B)}t.targetAnchor||rf(I,t,f,p),y(b&&l(b),t,I,o,i,s,a)}Pr(t,M)}else M&&t.shapeFlag&16&&k(e,t,e,l(e));return t.anchor&&l(t.anchor)}const gm=af;function Pr(e,t){const o=e.ctx;if(o&&o.ut){let i,s;for(t?(i=e.el,s=e.anchor):(i=e.targetStart,s=e.targetAnchor);i&&i!==s;)i.nodeType===1&&i.setAttribute("data-v-owner",o.uid),i=i.nextSibling;o.ut()}}function rf(e,t,o,i){const s=t.targetStart=o(""),a=t.targetAnchor=o("");return s[of]=a,e&&(i(s,e),i(a,e)),a}const Go=Symbol("_leaveCb"),Sr=Symbol("_enterCb");function ym(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Qt(()=>{e.isMounted=!0}),mf(()=>{e.isUnmounting=!0}),e}const jn=[Function,Array],lf={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:jn,onEnter:jn,onAfterEnter:jn,onEnterCancelled:jn,onBeforeLeave:jn,onLeave:jn,onAfterLeave:jn,onLeaveCancelled:jn,onBeforeAppear:jn,onAppear:jn,onAfterAppear:jn,onAppearCancelled:jn},cf=e=>{const t=e.subTree;return t.component?cf(t.component):t},_m={name:"BaseTransition",props:lf,setup(e,{slots:t}){const o=ou(),i=ym();return()=>{const s=t.default&&hf(t.default(),!0);if(!s||!s.length)return;const a=uf(s),l=gt(e),{mode:u}=l;if(i.isLeaving)return Wl(a);const h=qu(a);if(!h)return Wl(a);let p=mc(h,l,i,o,y=>p=y);h.type!==an&&$a(h,p);let f=o.subTree&&qu(o.subTree);if(f&&f.type!==an&&!qs(f,h)&&cf(o).type!==an){let y=mc(f,l,i,o);if($a(f,y),u==="out-in"&&h.type!==an)return i.isLeaving=!0,y.afterLeave=()=>{i.isLeaving=!1,o.job.flags&8||o.update(),delete y.afterLeave,f=void 0},Wl(a);u==="in-out"&&h.type!==an?y.delayLeave=(k,I,M)=>{const b=df(i,f);b[String(f.key)]=f,k[Go]=()=>{I(),k[Go]=void 0,delete p.delayedLeave,f=void 0},p.delayedLeave=()=>{M(),delete p.delayedLeave,f=void 0}}:f=void 0}else f&&(f=void 0);return a}}};function uf(e){let t=e[0];if(e.length>1){for(const o of e)if(o.type!==an){t=o;break}}return t}const km=_m;function df(e,t){const{leavingVNodes:o}=e;let i=o.get(t.type);return i||(i=Object.create(null),o.set(t.type,i)),i}function mc(e,t,o,i,s){const{appear:a,mode:l,persisted:u=!1,onBeforeEnter:h,onEnter:p,onAfterEnter:f,onEnterCancelled:y,onBeforeLeave:k,onLeave:I,onAfterLeave:M,onLeaveCancelled:b,onBeforeAppear:B,onAppear:E,onAfterAppear:A,onAppearCancelled:C}=t,x=String(e.key),T=df(o,e),S=(ce,_e)=>{ce&&ho(ce,i,9,_e)},$=(ce,_e)=>{const ae=_e[1];S(ce,_e),Qe(ce)?ce.every(pe=>pe.length<=1)&&ae():ce.length<=1&&ae()},se={mode:l,persisted:u,beforeEnter(ce){let _e=h;if(!o.isMounted)if(a)_e=B||h;else return;ce[Go]&&ce[Go](!0);const ae=T[x];ae&&qs(e,ae)&&ae.el[Go]&&ae.el[Go](),S(_e,[ce])},enter(ce){let _e=p,ae=f,pe=y;if(!o.isMounted)if(a)_e=E||p,ae=A||f,pe=C||y;else return;let Ie=!1;const Be=ce[Sr]=Se=>{Ie||(Ie=!0,Se?S(pe,[ce]):S(ae,[ce]),se.delayedLeave&&se.delayedLeave(),ce[Sr]=void 0)};_e?$(_e,[ce,Be]):Be()},leave(ce,_e){const ae=String(e.key);if(ce[Sr]&&ce[Sr](!0),o.isUnmounting)return _e();S(k,[ce]);let pe=!1;const Ie=ce[Go]=Be=>{pe||(pe=!0,_e(),Be?S(b,[ce]):S(M,[ce]),ce[Go]=void 0,T[ae]===e&&delete T[ae])};T[ae]=e,I?$(I,[ce,Ie]):Ie()},clone(ce){const _e=mc(ce,t,o,i,s);return s&&s(_e),_e}};return se}function Wl(e){if(ul(e))return e=$s(e),e.children=null,e}function qu(e){if(!ul(e))return sf(e.type)&&e.children?uf(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:o}=e;if(o){if(t&16)return o[0];if(t&32&&dt(o.default))return o.default()}}function $a(e,t){e.shapeFlag&6&&e.component?(e.transition=t,$a(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function hf(e,t=!1,o){let i=[],s=0;for(let a=0;a<e.length;a++){let l=e[a];const u=o==null?l.key:String(o)+String(l.key!=null?l.key:a);l.type===Ce?(l.patchFlag&128&&s++,i=i.concat(hf(l.children,t,u))):(t||l.type!==an)&&i.push(u!=null?$s(l,{key:u}):l)}if(s>1)for(let a=0;a<i.length;a++)i[a].patchFlag=-2;return i}function ff(e,t){return dt(e)?Kt({name:e.name},t,{setup:e}):e}function pf(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const Zr=new WeakMap;function ba(e,t,o,i,s=!1){if(Qe(e)){e.forEach((M,b)=>ba(M,t&&(Qe(t)?t[b]:t),o,i,s));return}if(Pi(i)&&!s){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&ba(e,t,o,i.component.subTree);return}const a=i.shapeFlag&4?vl(i.component):i.el,l=s?null:a,{i:u,r:h}=e,p=t&&t.r,f=u.refs===It?u.refs={}:u.refs,y=u.setupState,k=gt(y),I=y===It?wh:M=>wt(k,M);if(p!=null&&p!==h){if(Ku(t),Ft(p))f[p]=null,I(p)&&(y[p]=null);else if(Nt(p)){p.value=null;const M=t;M.k&&(f[M.k]=null)}}if(dt(h))Fa(h,u,12,[l,f]);else{const M=Ft(h),b=Nt(h);if(M||b){const B=()=>{if(e.f){const E=M?I(h)?y[h]:f[h]:h.value;if(s)Qe(E)&&Vc(E,a);else if(Qe(E))E.includes(a)||E.push(a);else if(M)f[h]=[a],I(h)&&(y[h]=f[h]);else{const A=[a];h.value=A,e.k&&(f[e.k]=A)}}else M?(f[h]=l,I(h)&&(y[h]=l)):b&&(h.value=l,e.k&&(f[e.k]=l))};if(l){const E=()=>{B(),Zr.delete(e)};E.id=-1,Zr.set(e,E),hn(E,o)}else Ku(e),B()}}}function Ku(e){const t=Zr.get(e);t&&(t.flags|=8,Zr.delete(e))}al().requestIdleCallback;al().cancelIdleCallback;const Pi=e=>!!e.type.__asyncLoader,ul=e=>e.type.__isKeepAlive;function bm(e,t){vf(e,"a",t)}function wm(e,t){vf(e,"da",t)}function vf(e,t,o=rn){const i=e.__wdc||(e.__wdc=()=>{let s=o;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(dl(t,i,o),o){let s=o.parent;for(;s&&s.parent;)ul(s.parent.vnode)&&Cm(i,t,o,s),s=s.parent}}function Cm(e,t,o,i){const s=dl(t,e,i,!0);po(()=>{Vc(i[t],s)},o)}function dl(e,t,o=rn,i=!1){if(o){const s=o[e]||(o[e]=[]),a=t.__weh||(t.__weh=(...l)=>{es();const u=Ua(o),h=ho(t,o,e,l);return u(),ts(),h});return i?s.unshift(a):s.push(a),a}}const os=e=>(t,o=rn)=>{(!Ea||e==="sp")&&dl(e,(...i)=>t(...i),o)},Lm=os("bm"),Qt=os("m"),Sm=os("bu"),xm=os("u"),mf=os("bum"),po=os("um"),Tm=os("sp"),Im=os("rtg"),$m=os("rtc");function Mm(e,t=rn){dl("ec",e,t)}const Am="components";function hl(e,t){return Pm(Am,e,!0,t)||e}const Em=Symbol.for("v-ndc");function Pm(e,t,o=!0,i=!1){const s=Xt||rn;if(s){const a=s.type;{const u=mg(a,!1);if(u&&(u===t||u===Kn(t)||u===sl(Kn(t))))return a}const l=Yu(s[e]||a[e],t)||Yu(s.appContext[e],t);return!l&&i?a:l}}function Yu(e,t){return e&&(e[t]||e[Kn(t)]||e[sl(Kn(t))])}function Re(e,t,o,i){let s;const a=o,l=Qe(e);if(l||Ft(e)){const u=l&&Xo(e);let h=!1,p=!1;u&&(h=!On(e),p=ns(e),e=rl(e)),s=new Array(e.length);for(let f=0,y=e.length;f<y;f++)s[f]=t(h?p?Oi(uo(e[f])):uo(e[f]):e[f],f,void 0,a)}else if(typeof e=="number"){s=new Array(e);for(let u=0;u<e;u++)s[u]=t(u+1,u,void 0,a)}else if(xt(e))if(e[Symbol.iterator])s=Array.from(e,(u,h)=>t(u,h,void 0,a));else{const u=Object.keys(e);s=new Array(u.length);for(let h=0,p=u.length;h<p;h++){const f=u[h];s[h]=t(e[f],f,h,a)}}else s=[];return s}function ra(e,t,o={},i,s){if(Xt.ce||Xt.parent&&Pi(Xt.parent)&&Xt.parent.ce){const p=Object.keys(o).length>0;return t!=="default"&&(o.name=t),m(),ct(Ce,null,[ze("slot",o,i&&i())],p?-2:64)}let a=e[t];a&&a._c&&(a._d=!1),m();const l=a&&gf(a(o)),u=o.key||l&&l.key,h=ct(Ce,{key:(u&&!co(u)?u:`_${t}`)+(!l&&i?"_fb":"")},l||(i?i():[]),l&&e._===1?64:-2);return a&&a._c&&(a._d=!0),h}function gf(e){return e.some(t=>Aa(t)?!(t.type===an||t.type===Ce&&!gf(t.children)):!0)?e:null}const gc=e=>e?Bf(e)?vl(e):gc(e.parent):null,wa=Kt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>gc(e.parent),$root:e=>gc(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>_f(e),$forceUpdate:e=>e.f||(e.f=()=>{Xc(e.update)}),$nextTick:e=>e.n||(e.n=Qo.bind(e.proxy)),$watch:e=>vm.bind(e)}),ql=(e,t)=>e!==It&&!e.__isScriptSetup&&wt(e,t),Dm={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:o,setupState:i,data:s,props:a,accessCache:l,type:u,appContext:h}=e;if(t[0]!=="$"){const k=l[t];if(k!==void 0)switch(k){case 1:return i[t];case 2:return s[t];case 4:return o[t];case 3:return a[t]}else{if(ql(i,t))return l[t]=1,i[t];if(s!==It&&wt(s,t))return l[t]=2,s[t];if(wt(a,t))return l[t]=3,a[t];if(o!==It&&wt(o,t))return l[t]=4,o[t];yc&&(l[t]=0)}}const p=wa[t];let f,y;if(p)return t==="$attrs"&&sn(e.attrs,"get",""),p(e);if((f=u.__cssModules)&&(f=f[t]))return f;if(o!==It&&wt(o,t))return l[t]=4,o[t];if(y=h.config.globalProperties,wt(y,t))return y[t]},set({_:e},t,o){const{data:i,setupState:s,ctx:a}=e;return ql(s,t)?(s[t]=o,!0):i!==It&&wt(i,t)?(i[t]=o,!0):wt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=o,!0)},has({_:{data:e,setupState:t,accessCache:o,ctx:i,appContext:s,props:a,type:l}},u){let h;return!!(o[u]||e!==It&&u[0]!=="$"&&wt(e,u)||ql(t,u)||wt(a,u)||wt(i,u)||wt(wa,u)||wt(s.config.globalProperties,u)||(h=l.__cssModules)&&h[u])},defineProperty(e,t,o){return o.get!=null?e._.accessCache[t]=0:wt(o,"value")&&this.set(e,t,o.value,null),Reflect.defineProperty(e,t,o)}};function Ju(e){return Qe(e)?e.reduce((t,o)=>(t[o]=null,t),{}):e}let yc=!0;function Om(e){const t=_f(e),o=e.proxy,i=e.ctx;yc=!1,t.beforeCreate&&Xu(t.beforeCreate,e,"bc");const{data:s,computed:a,methods:l,watch:u,provide:h,inject:p,created:f,beforeMount:y,mounted:k,beforeUpdate:I,updated:M,activated:b,deactivated:B,beforeDestroy:E,beforeUnmount:A,destroyed:C,unmounted:x,render:T,renderTracked:S,renderTriggered:$,errorCaptured:se,serverPrefetch:ce,expose:_e,inheritAttrs:ae,components:pe,directives:Ie,filters:Be}=t;if(p&&Rm(p,i,null),l)for(const Q in l){const X=l[Q];dt(X)&&(i[Q]=X.bind(o))}if(s){const Q=s.call(o,o);xt(Q)&&(e.data=Na(Q))}if(yc=!0,a)for(const Q in a){const X=a[Q],ue=dt(X)?X.bind(o,o):dt(X.get)?X.get.bind(o,o):xo,te=!dt(X)&&dt(X.set)?X.set.bind(o):xo,be=J({get:ue,set:te});Object.defineProperty(i,Q,{enumerable:!0,configurable:!0,get:()=>be.value,set:Oe=>be.value=Oe})}if(u)for(const Q in u)yf(u[Q],i,o,Q);if(h){const Q=dt(h)?h.call(o):h;Reflect.ownKeys(Q).forEach(X=>{Er(X,Q[X])})}f&&Xu(f,e,"c");function he(Q,X){Qe(X)?X.forEach(ue=>Q(ue.bind(o))):X&&Q(X.bind(o))}if(he(Lm,y),he(Qt,k),he(Sm,I),he(xm,M),he(bm,b),he(wm,B),he(Mm,se),he($m,S),he(Im,$),he(mf,A),he(po,x),he(Tm,ce),Qe(_e))if(_e.length){const Q=e.exposed||(e.exposed={});_e.forEach(X=>{Object.defineProperty(Q,X,{get:()=>o[X],set:ue=>o[X]=ue,enumerable:!0})})}else e.exposed||(e.exposed={});T&&e.render===xo&&(e.render=T),ae!=null&&(e.inheritAttrs=ae),pe&&(e.components=pe),Ie&&(e.directives=Ie),ce&&pf(e)}function Rm(e,t,o=xo){Qe(e)&&(e=_c(e));for(const i in e){const s=e[i];let a;xt(s)?"default"in s?a=Wn(s.from||i,s.default,!0):a=Wn(s.from||i):a=Wn(s),Nt(a)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>a.value,set:l=>a.value=l}):t[i]=a}}function Xu(e,t,o){ho(Qe(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,o)}function yf(e,t,o,i){let s=i.includes(".")?nf(o,i):()=>o[i];if(Ft(e)){const a=t[e];dt(a)&&qe(s,a)}else if(dt(e))qe(s,e.bind(o));else if(xt(e))if(Qe(e))e.forEach(a=>yf(a,t,o,i));else{const a=dt(e.handler)?e.handler.bind(o):t[e.handler];dt(a)&&qe(s,a,e)}}function _f(e){const t=e.type,{mixins:o,extends:i}=t,{mixins:s,optionsCache:a,config:{optionMergeStrategies:l}}=e.appContext,u=a.get(t);let h;return u?h=u:!s.length&&!o&&!i?h=t:(h={},s.length&&s.forEach(p=>jr(h,p,l,!0)),jr(h,t,l)),xt(t)&&a.set(t,h),h}function jr(e,t,o,i=!1){const{mixins:s,extends:a}=t;a&&jr(e,a,o,!0),s&&s.forEach(l=>jr(e,l,o,!0));for(const l in t)if(!(i&&l==="expose")){const u=Bm[l]||o&&o[l];e[l]=u?u(e[l],t[l]):t[l]}return e}const Bm={data:Qu,props:ed,emits:ed,methods:ha,computed:ha,beforeCreate:dn,created:dn,beforeMount:dn,mounted:dn,beforeUpdate:dn,updated:dn,beforeDestroy:dn,beforeUnmount:dn,destroyed:dn,unmounted:dn,activated:dn,deactivated:dn,errorCaptured:dn,serverPrefetch:dn,components:ha,directives:ha,watch:Fm,provide:Qu,inject:Nm};function Qu(e,t){return t?e?function(){return Kt(dt(e)?e.call(this,this):e,dt(t)?t.call(this,this):t)}:t:e}function Nm(e,t){return ha(_c(e),_c(t))}function _c(e){if(Qe(e)){const t={};for(let o=0;o<e.length;o++)t[e[o]]=e[o];return t}return e}function dn(e,t){return e?[...new Set([].concat(e,t))]:t}function ha(e,t){return e?Kt(Object.create(null),e,t):t}function ed(e,t){return e?Qe(e)&&Qe(t)?[...new Set([...e,...t])]:Kt(Object.create(null),Ju(e),Ju(t??{})):t}function Fm(e,t){if(!e)return t;if(!t)return e;const o=Kt(Object.create(null),e);for(const i in t)o[i]=dn(e[i],t[i]);return o}function kf(){return{app:null,config:{isNativeTag:wh,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Um=0;function zm(e,t){return function(i,s=null){dt(i)||(i=Kt({},i)),s!=null&&!xt(s)&&(s=null);const a=kf(),l=new WeakSet,u=[];let h=!1;const p=a.app={_uid:Um++,_component:i,_props:s,_container:null,_context:a,_instance:null,version:yg,get config(){return a.config},set config(f){},use(f,...y){return l.has(f)||(f&&dt(f.install)?(l.add(f),f.install(p,...y)):dt(f)&&(l.add(f),f(p,...y))),p},mixin(f){return a.mixins.includes(f)||a.mixins.push(f),p},component(f,y){return y?(a.components[f]=y,p):a.components[f]},directive(f,y){return y?(a.directives[f]=y,p):a.directives[f]},mount(f,y,k){if(!h){const I=p._ceVNode||ze(i,s);return I.appContext=a,k===!0?k="svg":k===!1&&(k=void 0),e(I,f,k),h=!0,p._container=f,f.__vue_app__=p,vl(I.component)}},onUnmount(f){u.push(f)},unmount(){h&&(ho(u,p._instance,16),e(null,p._container),delete p._container.__vue_app__)},provide(f,y){return a.provides[f]=y,p},runWithContext(f){const y=oi;oi=p;try{return f()}finally{oi=y}}};return p}}let oi=null;const Hm=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Kn(t)}Modifiers`]||e[`${Es(t)}Modifiers`];function Vm(e,t,...o){if(e.isUnmounted)return;const i=e.vnode.props||It;let s=o;const a=t.startsWith("update:"),l=a&&Hm(i,t.slice(7));l&&(l.trim&&(s=o.map(f=>Ft(f)?f.trim():f)),l.number&&(s=o.map(il)));let u,h=i[u=Hl(t)]||i[u=Hl(Kn(t))];!h&&a&&(h=i[u=Hl(Es(t))]),h&&ho(h,e,6,s);const p=i[u+"Once"];if(p){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,ho(p,e,6,s)}}const Gm=new WeakMap;function bf(e,t,o=!1){const i=o?Gm:t.emitsCache,s=i.get(e);if(s!==void 0)return s;const a=e.emits;let l={},u=!1;if(!dt(e)){const h=p=>{const f=bf(p,t,!0);f&&(u=!0,Kt(l,f))};!o&&t.mixins.length&&t.mixins.forEach(h),e.extends&&h(e.extends),e.mixins&&e.mixins.forEach(h)}return!a&&!u?(xt(e)&&i.set(e,null),null):(Qe(a)?a.forEach(h=>l[h]=null):Kt(l,a),xt(e)&&i.set(e,l),l)}function fl(e,t){return!e||!tl(t)?!1:(t=t.slice(2).replace(/Once$/,""),wt(e,t[0].toLowerCase()+t.slice(1))||wt(e,Es(t))||wt(e,t))}function td(e){const{type:t,vnode:o,proxy:i,withProxy:s,propsOptions:[a],slots:l,attrs:u,emit:h,render:p,renderCache:f,props:y,data:k,setupState:I,ctx:M,inheritAttrs:b}=e,B=Gr(e);let E,A;try{if(o.shapeFlag&4){const x=s||i,T=x;E=Co(p.call(T,x,f,y,I,k,M)),A=u}else{const x=t;E=Co(x.length>1?x(y,{attrs:u,slots:l,emit:h}):x(y,null)),A=t.props?u:Zm(u)}}catch(x){Ca.length=0,cl(x,e,1),E=ze(an)}let C=E;if(A&&b!==!1){const x=Object.keys(A),{shapeFlag:T}=C;x.length&&T&7&&(a&&x.some(Hc)&&(A=jm(A,a)),C=$s(C,A,!1,!0))}return o.dirs&&(C=$s(C,null,!1,!0),C.dirs=C.dirs?C.dirs.concat(o.dirs):o.dirs),o.transition&&$a(C,o.transition),E=C,Gr(B),E}const Zm=e=>{let t;for(const o in e)(o==="class"||o==="style"||tl(o))&&((t||(t={}))[o]=e[o]);return t},jm=(e,t)=>{const o={};for(const i in e)(!Hc(i)||!(i.slice(9)in t))&&(o[i]=e[i]);return o};function Wm(e,t,o){const{props:i,children:s,component:a}=e,{props:l,children:u,patchFlag:h}=t,p=a.emitsOptions;if(t.dirs||t.transition)return!0;if(o&&h>=0){if(h&1024)return!0;if(h&16)return i?nd(i,l,p):!!l;if(h&8){const f=t.dynamicProps;for(let y=0;y<f.length;y++){const k=f[y];if(l[k]!==i[k]&&!fl(p,k))return!0}}}else return(s||u)&&(!u||!u.$stable)?!0:i===l?!1:i?l?nd(i,l,p):!0:!!l;return!1}function nd(e,t,o){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let s=0;s<i.length;s++){const a=i[s];if(t[a]!==e[a]&&!fl(o,a))return!0}return!1}function qm({vnode:e,parent:t},o){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=o,t=t.parent;else break}}const wf={},Cf=()=>Object.create(wf),Lf=e=>Object.getPrototypeOf(e)===wf;function Km(e,t,o,i=!1){const s={},a=Cf();e.propsDefaults=Object.create(null),Sf(e,t,s,a);for(const l in e.propsOptions[0])l in s||(s[l]=void 0);o?e.props=i?s:Wh(s):e.type.props?e.props=s:e.props=a,e.attrs=a}function Ym(e,t,o,i){const{props:s,attrs:a,vnode:{patchFlag:l}}=e,u=gt(s),[h]=e.propsOptions;let p=!1;if((i||l>0)&&!(l&16)){if(l&8){const f=e.vnode.dynamicProps;for(let y=0;y<f.length;y++){let k=f[y];if(fl(e.emitsOptions,k))continue;const I=t[k];if(h)if(wt(a,k))I!==a[k]&&(a[k]=I,p=!0);else{const M=Kn(k);s[M]=kc(h,u,M,I,e,!1)}else I!==a[k]&&(a[k]=I,p=!0)}}}else{Sf(e,t,s,a)&&(p=!0);let f;for(const y in u)(!t||!wt(t,y)&&((f=Es(y))===y||!wt(t,f)))&&(h?o&&(o[y]!==void 0||o[f]!==void 0)&&(s[y]=kc(h,u,y,void 0,e,!0)):delete s[y]);if(a!==u)for(const y in a)(!t||!wt(t,y))&&(delete a[y],p=!0)}p&&jo(e.attrs,"set","")}function Sf(e,t,o,i){const[s,a]=e.propsOptions;let l=!1,u;if(t)for(let h in t){if(ga(h))continue;const p=t[h];let f;s&&wt(s,f=Kn(h))?!a||!a.includes(f)?o[f]=p:(u||(u={}))[f]=p:fl(e.emitsOptions,h)||(!(h in i)||p!==i[h])&&(i[h]=p,l=!0)}if(a){const h=gt(o),p=u||It;for(let f=0;f<a.length;f++){const y=a[f];o[y]=kc(s,h,y,p[y],e,!wt(p,y))}}return l}function kc(e,t,o,i,s,a){const l=e[o];if(l!=null){const u=wt(l,"default");if(u&&i===void 0){const h=l.default;if(l.type!==Function&&!l.skipFactory&&dt(h)){const{propsDefaults:p}=s;if(o in p)i=p[o];else{const f=Ua(s);i=p[o]=h.call(null,t),f()}}else i=h;s.ce&&s.ce._setProp(o,i)}l[0]&&(a&&!u?i=!1:l[1]&&(i===""||i===Es(o))&&(i=!0))}return i}const Jm=new WeakMap;function xf(e,t,o=!1){const i=o?Jm:t.propsCache,s=i.get(e);if(s)return s;const a=e.props,l={},u=[];let h=!1;if(!dt(e)){const f=y=>{h=!0;const[k,I]=xf(y,t,!0);Kt(l,k),I&&u.push(...I)};!o&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}if(!a&&!h)return xt(e)&&i.set(e,Mi),Mi;if(Qe(a))for(let f=0;f<a.length;f++){const y=Kn(a[f]);od(y)&&(l[y]=It)}else if(a)for(const f in a){const y=Kn(f);if(od(y)){const k=a[f],I=l[y]=Qe(k)||dt(k)?{type:k}:Kt({},k),M=I.type;let b=!1,B=!0;if(Qe(M))for(let E=0;E<M.length;++E){const A=M[E],C=dt(A)&&A.name;if(C==="Boolean"){b=!0;break}else C==="String"&&(B=!1)}else b=dt(M)&&M.name==="Boolean";I[0]=b,I[1]=B,(b||wt(I,"default"))&&u.push(y)}}const p=[l,u];return xt(e)&&i.set(e,p),p}function od(e){return e[0]!=="$"&&!ga(e)}const Qc=e=>e==="_"||e==="_ctx"||e==="$stable",eu=e=>Qe(e)?e.map(Co):[Co(e)],Xm=(e,t,o)=>{if(t._n)return t;const i=et((...s)=>eu(t(...s)),o);return i._c=!1,i},Tf=(e,t,o)=>{const i=e._ctx;for(const s in e){if(Qc(s))continue;const a=e[s];if(dt(a))t[s]=Xm(s,a,i);else if(a!=null){const l=eu(a);t[s]=()=>l}}},If=(e,t)=>{const o=eu(t);e.slots.default=()=>o},$f=(e,t,o)=>{for(const i in t)(o||!Qc(i))&&(e[i]=t[i])},Qm=(e,t,o)=>{const i=e.slots=Cf();if(e.vnode.shapeFlag&32){const s=t._;s?($f(i,t,o),o&&xh(i,"_",s,!0)):Tf(t,i)}else t&&If(e,t)},eg=(e,t,o)=>{const{vnode:i,slots:s}=e;let a=!0,l=It;if(i.shapeFlag&32){const u=t._;u?o&&u===1?a=!1:$f(s,t,o):(a=!t.$stable,Tf(t,s)),l=t}else t&&(If(e,t),l={default:1});if(a)for(const u in s)!Qc(u)&&l[u]==null&&delete s[u]},hn=ig;function tg(e){return ng(e)}function ng(e,t){const o=al();o.__VUE__=!0;const{insert:i,remove:s,patchProp:a,createElement:l,createText:u,createComment:h,setText:p,setElementText:f,parentNode:y,nextSibling:k,setScopeId:I=xo,insertStaticContent:M}=e,b=(U,H,Y,Z=null,N=null,O=null,W=void 0,me=null,$e=!!H.dynamicChildren)=>{if(U===H)return;U&&!qs(U,H)&&(Z=re(U),Oe(U,N,O,!0),U=null),H.patchFlag===-2&&($e=!1,H.dynamicChildren=null);const{type:ke,ref:Ne,shapeFlag:Fe}=H;switch(ke){case pl:B(U,H,Y,Z);break;case an:E(U,H,Y,Z);break;case Dr:U==null&&A(H,Y,Z,W);break;case Ce:pe(U,H,Y,Z,N,O,W,me,$e);break;default:Fe&1?T(U,H,Y,Z,N,O,W,me,$e):Fe&6?Ie(U,H,Y,Z,N,O,W,me,$e):(Fe&64||Fe&128)&&ke.process(U,H,Y,Z,N,O,W,me,$e,fe)}Ne!=null&&N?ba(Ne,U&&U.ref,O,H||U,!H):Ne==null&&U&&U.ref!=null&&ba(U.ref,null,O,U,!0)},B=(U,H,Y,Z)=>{if(U==null)i(H.el=u(H.children),Y,Z);else{const N=H.el=U.el;H.children!==U.children&&p(N,H.children)}},E=(U,H,Y,Z)=>{U==null?i(H.el=h(H.children||""),Y,Z):H.el=U.el},A=(U,H,Y,Z)=>{[U.el,U.anchor]=M(U.children,H,Y,Z,U.el,U.anchor)},C=({el:U,anchor:H},Y,Z)=>{let N;for(;U&&U!==H;)N=k(U),i(U,Y,Z),U=N;i(H,Y,Z)},x=({el:U,anchor:H})=>{let Y;for(;U&&U!==H;)Y=k(U),s(U),U=Y;s(H)},T=(U,H,Y,Z,N,O,W,me,$e)=>{if(H.type==="svg"?W="svg":H.type==="math"&&(W="mathml"),U==null)S(H,Y,Z,N,O,W,me,$e);else{const ke=U.el&&U.el._isVueCE?U.el:null;try{ke&&ke._beginPatch(),ce(U,H,N,O,W,me,$e)}finally{ke&&ke._endPatch()}}},S=(U,H,Y,Z,N,O,W,me)=>{let $e,ke;const{props:Ne,shapeFlag:Fe,transition:Ue,dirs:We}=U;if($e=U.el=l(U.type,O,Ne&&Ne.is,Ne),Fe&8?f($e,U.children):Fe&16&&se(U.children,$e,null,Z,N,Kl(U,O),W,me),We&&Hs(U,null,Z,"created"),$($e,U,U.scopeId,W,Z),Ne){for(const ee in Ne)ee!=="value"&&!ga(ee)&&a($e,ee,null,Ne[ee],O,Z);"value"in Ne&&a($e,"value",null,Ne.value,O),(ke=Ne.onVnodeBeforeMount)&&ko(ke,Z,U)}We&&Hs(U,null,Z,"beforeMount");const oe=og(N,Ue);oe&&Ue.beforeEnter($e),i($e,H,Y),((ke=Ne&&Ne.onVnodeMounted)||oe||We)&&hn(()=>{ke&&ko(ke,Z,U),oe&&Ue.enter($e),We&&Hs(U,null,Z,"mounted")},N)},$=(U,H,Y,Z,N)=>{if(Y&&I(U,Y),Z)for(let O=0;O<Z.length;O++)I(U,Z[O]);if(N){let O=N.subTree;if(H===O||Ef(O.type)&&(O.ssContent===H||O.ssFallback===H)){const W=N.vnode;$(U,W,W.scopeId,W.slotScopeIds,N.parent)}}},se=(U,H,Y,Z,N,O,W,me,$e=0)=>{for(let ke=$e;ke<U.length;ke++){const Ne=U[ke]=me?ws(U[ke]):Co(U[ke]);b(null,Ne,H,Y,Z,N,O,W,me)}},ce=(U,H,Y,Z,N,O,W)=>{const me=H.el=U.el;let{patchFlag:$e,dynamicChildren:ke,dirs:Ne}=H;$e|=U.patchFlag&16;const Fe=U.props||It,Ue=H.props||It;let We;if(Y&&Vs(Y,!1),(We=Ue.onVnodeBeforeUpdate)&&ko(We,Y,H,U),Ne&&Hs(H,U,Y,"beforeUpdate"),Y&&Vs(Y,!0),(Fe.innerHTML&&Ue.innerHTML==null||Fe.textContent&&Ue.textContent==null)&&f(me,""),ke?_e(U.dynamicChildren,ke,me,Y,Z,Kl(H,N),O):W||X(U,H,me,null,Y,Z,Kl(H,N),O,!1),$e>0){if($e&16)ae(me,Fe,Ue,Y,N);else if($e&2&&Fe.class!==Ue.class&&a(me,"class",null,Ue.class,N),$e&4&&a(me,"style",Fe.style,Ue.style,N),$e&8){const oe=H.dynamicProps;for(let ee=0;ee<oe.length;ee++){const j=oe[ee],Ve=Fe[j],Xe=Ue[j];(Xe!==Ve||j==="value")&&a(me,j,Ve,Xe,N,Y)}}$e&1&&U.children!==H.children&&f(me,H.children)}else!W&&ke==null&&ae(me,Fe,Ue,Y,N);((We=Ue.onVnodeUpdated)||Ne)&&hn(()=>{We&&ko(We,Y,H,U),Ne&&Hs(H,U,Y,"updated")},Z)},_e=(U,H,Y,Z,N,O,W)=>{for(let me=0;me<H.length;me++){const $e=U[me],ke=H[me],Ne=$e.el&&($e.type===Ce||!qs($e,ke)||$e.shapeFlag&198)?y($e.el):Y;b($e,ke,Ne,null,Z,N,O,W,!0)}},ae=(U,H,Y,Z,N)=>{if(H!==Y){if(H!==It)for(const O in H)!ga(O)&&!(O in Y)&&a(U,O,H[O],null,N,Z);for(const O in Y){if(ga(O))continue;const W=Y[O],me=H[O];W!==me&&O!=="value"&&a(U,O,me,W,N,Z)}"value"in Y&&a(U,"value",H.value,Y.value,N)}},pe=(U,H,Y,Z,N,O,W,me,$e)=>{const ke=H.el=U?U.el:u(""),Ne=H.anchor=U?U.anchor:u("");let{patchFlag:Fe,dynamicChildren:Ue,slotScopeIds:We}=H;We&&(me=me?me.concat(We):We),U==null?(i(ke,Y,Z),i(Ne,Y,Z),se(H.children||[],Y,Ne,N,O,W,me,$e)):Fe>0&&Fe&64&&Ue&&U.dynamicChildren&&U.dynamicChildren.length===Ue.length?(_e(U.dynamicChildren,Ue,Y,N,O,W,me),(H.key!=null||N&&H===N.subTree)&&tu(U,H,!0)):X(U,H,Y,Ne,N,O,W,me,$e)},Ie=(U,H,Y,Z,N,O,W,me,$e)=>{H.slotScopeIds=me,U==null?H.shapeFlag&512?N.ctx.activate(H,Y,Z,W,$e):Be(H,Y,Z,N,O,W,$e):Se(U,H,$e)},Be=(U,H,Y,Z,N,O,W)=>{const me=U.component=dg(U,Z,N);if(ul(U)&&(me.ctx.renderer=fe),hg(me,!1,W),me.asyncDep){if(N&&N.registerDep(me,he,W),!U.el){const $e=me.subTree=ze(an);E(null,$e,H,Y),U.placeholder=$e.el}}else he(me,U,H,Y,N,O,W)},Se=(U,H,Y)=>{const Z=H.component=U.component;if(Wm(U,H,Y))if(Z.asyncDep&&!Z.asyncResolved){Q(Z,H,Y);return}else Z.next=H,Z.update();else H.el=U.el,Z.vnode=H},he=(U,H,Y,Z,N,O,W)=>{const me=()=>{if(U.isMounted){let{next:Fe,bu:Ue,u:We,parent:oe,vnode:ee}=U;{const at=Mf(U);if(at){Fe&&(Fe.el=ee.el,Q(U,Fe,W)),at.asyncDep.then(()=>{U.isUnmounted||me()});return}}let j=Fe,Ve;Vs(U,!1),Fe?(Fe.el=ee.el,Q(U,Fe,W)):Fe=ee,Ue&&Ar(Ue),(Ve=Fe.props&&Fe.props.onVnodeBeforeUpdate)&&ko(Ve,oe,Fe,ee),Vs(U,!0);const Xe=td(U),nt=U.subTree;U.subTree=Xe,b(nt,Xe,y(nt.el),re(nt),U,N,O),Fe.el=Xe.el,j===null&&qm(U,Xe.el),We&&hn(We,N),(Ve=Fe.props&&Fe.props.onVnodeUpdated)&&hn(()=>ko(Ve,oe,Fe,ee),N)}else{let Fe;const{el:Ue,props:We}=H,{bm:oe,m:ee,parent:j,root:Ve,type:Xe}=U,nt=Pi(H);Vs(U,!1),oe&&Ar(oe),!nt&&(Fe=We&&We.onVnodeBeforeMount)&&ko(Fe,j,H),Vs(U,!0);{Ve.ce&&Ve.ce._def.shadowRoot!==!1&&Ve.ce._injectChildStyle(Xe);const at=U.subTree=td(U);b(null,at,Y,Z,U,N,O),H.el=at.el}if(ee&&hn(ee,N),!nt&&(Fe=We&&We.onVnodeMounted)){const at=H;hn(()=>ko(Fe,j,at),N)}(H.shapeFlag&256||j&&Pi(j.vnode)&&j.vnode.shapeFlag&256)&&U.a&&hn(U.a,N),U.isMounted=!0,H=Y=Z=null}};U.scope.on();const $e=U.effect=new Ph(me);U.scope.off();const ke=U.update=$e.run.bind($e),Ne=U.job=$e.runIfDirty.bind($e);Ne.i=U,Ne.id=U.uid,$e.scheduler=()=>Xc(Ne),Vs(U,!0),ke()},Q=(U,H,Y)=>{H.component=U;const Z=U.vnode.props;U.vnode=H,U.next=null,Ym(U,H.props,Z,Y),eg(U,H.children,Y),es(),Gu(U),ts()},X=(U,H,Y,Z,N,O,W,me,$e=!1)=>{const ke=U&&U.children,Ne=U?U.shapeFlag:0,Fe=H.children,{patchFlag:Ue,shapeFlag:We}=H;if(Ue>0){if(Ue&128){te(ke,Fe,Y,Z,N,O,W,me,$e);return}else if(Ue&256){ue(ke,Fe,Y,Z,N,O,W,me,$e);return}}We&8?(Ne&16&&we(ke,N,O),Fe!==ke&&f(Y,Fe)):Ne&16?We&16?te(ke,Fe,Y,Z,N,O,W,me,$e):we(ke,N,O,!0):(Ne&8&&f(Y,""),We&16&&se(Fe,Y,Z,N,O,W,me,$e))},ue=(U,H,Y,Z,N,O,W,me,$e)=>{U=U||Mi,H=H||Mi;const ke=U.length,Ne=H.length,Fe=Math.min(ke,Ne);let Ue;for(Ue=0;Ue<Fe;Ue++){const We=H[Ue]=$e?ws(H[Ue]):Co(H[Ue]);b(U[Ue],We,Y,null,N,O,W,me,$e)}ke>Ne?we(U,N,O,!0,!1,Fe):se(H,Y,Z,N,O,W,me,$e,Fe)},te=(U,H,Y,Z,N,O,W,me,$e)=>{let ke=0;const Ne=H.length;let Fe=U.length-1,Ue=Ne-1;for(;ke<=Fe&&ke<=Ue;){const We=U[ke],oe=H[ke]=$e?ws(H[ke]):Co(H[ke]);if(qs(We,oe))b(We,oe,Y,null,N,O,W,me,$e);else break;ke++}for(;ke<=Fe&&ke<=Ue;){const We=U[Fe],oe=H[Ue]=$e?ws(H[Ue]):Co(H[Ue]);if(qs(We,oe))b(We,oe,Y,null,N,O,W,me,$e);else break;Fe--,Ue--}if(ke>Fe){if(ke<=Ue){const We=Ue+1,oe=We<Ne?H[We].el:Z;for(;ke<=Ue;)b(null,H[ke]=$e?ws(H[ke]):Co(H[ke]),Y,oe,N,O,W,me,$e),ke++}}else if(ke>Ue)for(;ke<=Fe;)Oe(U[ke],N,O,!0),ke++;else{const We=ke,oe=ke,ee=new Map;for(ke=oe;ke<=Ue;ke++){const $t=H[ke]=$e?ws(H[ke]):Co(H[ke]);$t.key!=null&&ee.set($t.key,ke)}let j,Ve=0;const Xe=Ue-oe+1;let nt=!1,at=0;const tt=new Array(Xe);for(ke=0;ke<Xe;ke++)tt[ke]=0;for(ke=We;ke<=Fe;ke++){const $t=U[ke];if(Ve>=Xe){Oe($t,N,O,!0);continue}let yt;if($t.key!=null)yt=ee.get($t.key);else for(j=oe;j<=Ue;j++)if(tt[j-oe]===0&&qs($t,H[j])){yt=j;break}yt===void 0?Oe($t,N,O,!0):(tt[yt-oe]=ke+1,yt>=at?at=yt:nt=!0,b($t,H[yt],Y,null,N,O,W,me,$e),Ve++)}const St=nt?sg(tt):Mi;for(j=St.length-1,ke=Xe-1;ke>=0;ke--){const $t=oe+ke,yt=H[$t],xn=H[$t+1],To=$t+1<Ne?xn.el||Af(xn):Z;tt[ke]===0?b(null,yt,Y,To,N,O,W,me,$e):nt&&(j<0||ke!==St[j]?be(yt,Y,To,2):j--)}}},be=(U,H,Y,Z,N=null)=>{const{el:O,type:W,transition:me,children:$e,shapeFlag:ke}=U;if(ke&6){be(U.component.subTree,H,Y,Z);return}if(ke&128){U.suspense.move(H,Y,Z);return}if(ke&64){W.move(U,H,Y,fe);return}if(W===Ce){i(O,H,Y);for(let Fe=0;Fe<$e.length;Fe++)be($e[Fe],H,Y,Z);i(U.anchor,H,Y);return}if(W===Dr){C(U,H,Y);return}if(Z!==2&&ke&1&&me)if(Z===0)me.beforeEnter(O),i(O,H,Y),hn(()=>me.enter(O),N);else{const{leave:Fe,delayLeave:Ue,afterLeave:We}=me,oe=()=>{U.ctx.isUnmounted?s(O):i(O,H,Y)},ee=()=>{O._isLeaving&&O[Go](!0),Fe(O,()=>{oe(),We&&We()})};Ue?Ue(O,oe,ee):ee()}else i(O,H,Y)},Oe=(U,H,Y,Z=!1,N=!1)=>{const{type:O,props:W,ref:me,children:$e,dynamicChildren:ke,shapeFlag:Ne,patchFlag:Fe,dirs:Ue,cacheIndex:We}=U;if(Fe===-2&&(N=!1),me!=null&&(es(),ba(me,null,Y,U,!0),ts()),We!=null&&(H.renderCache[We]=void 0),Ne&256){H.ctx.deactivate(U);return}const oe=Ne&1&&Ue,ee=!Pi(U);let j;if(ee&&(j=W&&W.onVnodeBeforeUnmount)&&ko(j,H,U),Ne&6)xe(U.component,Y,Z);else{if(Ne&128){U.suspense.unmount(Y,Z);return}oe&&Hs(U,null,H,"beforeUnmount"),Ne&64?U.type.remove(U,H,Y,fe,Z):ke&&!ke.hasOnce&&(O!==Ce||Fe>0&&Fe&64)?we(ke,H,Y,!1,!0):(O===Ce&&Fe&384||!N&&Ne&16)&&we($e,H,Y),Z&&ne(U)}(ee&&(j=W&&W.onVnodeUnmounted)||oe)&&hn(()=>{j&&ko(j,H,U),oe&&Hs(U,null,H,"unmounted")},Y)},ne=U=>{const{type:H,el:Y,anchor:Z,transition:N}=U;if(H===Ce){Ee(Y,Z);return}if(H===Dr){x(U);return}const O=()=>{s(Y),N&&!N.persisted&&N.afterLeave&&N.afterLeave()};if(U.shapeFlag&1&&N&&!N.persisted){const{leave:W,delayLeave:me}=N,$e=()=>W(Y,O);me?me(U.el,O,$e):$e()}else O()},Ee=(U,H)=>{let Y;for(;U!==H;)Y=k(U),s(U),U=Y;s(H)},xe=(U,H,Y)=>{const{bum:Z,scope:N,job:O,subTree:W,um:me,m:$e,a:ke}=U;sd($e),sd(ke),Z&&Ar(Z),N.stop(),O&&(O.flags|=8,Oe(W,U,H,Y)),me&&hn(me,H),hn(()=>{U.isUnmounted=!0},H)},we=(U,H,Y,Z=!1,N=!1,O=0)=>{for(let W=O;W<U.length;W++)Oe(U[W],H,Y,Z,N)},re=U=>{if(U.shapeFlag&6)return re(U.component.subTree);if(U.shapeFlag&128)return U.suspense.next();const H=k(U.anchor||U.el),Y=H&&H[of];return Y?k(Y):H};let ve=!1;const q=(U,H,Y)=>{let Z;U==null?H._vnode&&(Oe(H._vnode,null,null,!0),Z=H._vnode.component):b(H._vnode||null,U,H,null,null,null,Y),H._vnode=U,ve||(ve=!0,Gu(Z),Xh(),ve=!1)},fe={p:b,um:Oe,m:be,r:ne,mt:Be,mc:se,pc:X,pbc:_e,n:re,o:e};return{render:q,hydrate:void 0,createApp:zm(q)}}function Kl({type:e,props:t},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:o}function Vs({effect:e,job:t},o){o?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function og(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function tu(e,t,o=!1){const i=e.children,s=t.children;if(Qe(i)&&Qe(s))for(let a=0;a<i.length;a++){const l=i[a];let u=s[a];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=s[a]=ws(s[a]),u.el=l.el),!o&&u.patchFlag!==-2&&tu(l,u)),u.type===pl&&(u.patchFlag!==-1?u.el=l.el:u.__elIndex=a+(e.type===Ce?1:0)),u.type===an&&!u.el&&(u.el=l.el)}}function sg(e){const t=e.slice(),o=[0];let i,s,a,l,u;const h=e.length;for(i=0;i<h;i++){const p=e[i];if(p!==0){if(s=o[o.length-1],e[s]<p){t[i]=s,o.push(i);continue}for(a=0,l=o.length-1;a<l;)u=a+l>>1,e[o[u]]<p?a=u+1:l=u;p<e[o[a]]&&(a>0&&(t[i]=o[a-1]),o[a]=i)}}for(a=o.length,l=o[a-1];a-- >0;)o[a]=l,l=t[l];return o}function Mf(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Mf(t)}function sd(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function Af(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?Af(t.subTree):null}const Ef=e=>e.__isSuspense;function ig(e,t){t&&t.pendingBranch?Qe(e)?t.effects.push(...e):t.effects.push(e):dm(e)}const Ce=Symbol.for("v-fgt"),pl=Symbol.for("v-txt"),an=Symbol.for("v-cmt"),Dr=Symbol.for("v-stc"),Ca=[];let Dn=null;function m(e=!1){Ca.push(Dn=e?null:[])}function ag(){Ca.pop(),Dn=Ca[Ca.length-1]||null}let Ma=1;function Wr(e,t=!1){Ma+=e,e<0&&Dn&&t&&(Dn.hasOnce=!0)}function Pf(e){return e.dynamicChildren=Ma>0?Dn||Mi:null,ag(),Ma>0&&Dn&&Dn.push(e),e}function g(e,t,o,i,s,a){return Pf(c(e,t,o,i,s,a,!0))}function ct(e,t,o,i,s){return Pf(ze(e,t,o,i,s,!0))}function Aa(e){return e?e.__v_isVNode===!0:!1}function qs(e,t){return e.type===t.type&&e.key===t.key}const Df=({key:e})=>e??null,Or=({ref:e,ref_key:t,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?Ft(e)||Nt(e)||dt(e)?{i:Xt,r:e,k:t,f:!!o}:e:null);function c(e,t=null,o=null,i=0,s=null,a=e===Ce?0:1,l=!1,u=!1){const h={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Df(t),ref:t&&Or(t),scopeId:ef,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Xt};return u?(nu(h,o),a&128&&e.normalize(h)):o&&(h.shapeFlag|=Ft(o)?8:16),Ma>0&&!l&&Dn&&(h.patchFlag>0||a&6)&&h.patchFlag!==32&&Dn.push(h),h}const ze=rg;function rg(e,t=null,o=null,i=0,s=null,a=!1){if((!e||e===Em)&&(e=an),Aa(e)){const u=$s(e,t,!0);return o&&nu(u,o),Ma>0&&!a&&Dn&&(u.shapeFlag&6?Dn[Dn.indexOf(e)]=u:Dn.push(u)),u.patchFlag=-2,u}if(gg(e)&&(e=e.__vccOpts),t){t=lg(t);let{class:u,style:h}=t;u&&!Ft(u)&&(t.class=Te(u)),xt(h)&&(ll(h)&&!Qe(h)&&(h=Kt({},h)),t.style=st(h))}const l=Ft(e)?1:Ef(e)?128:sf(e)?64:xt(e)?4:dt(e)?2:0;return c(e,t,o,i,s,l,a,!0)}function lg(e){return e?ll(e)||Lf(e)?Kt({},e):e:null}function $s(e,t,o=!1,i=!1){const{props:s,ref:a,patchFlag:l,children:u,transition:h}=e,p=t?Rf(s||{},t):s,f={__v_isVNode:!0,__v_skip:!0,type:e.type,props:p,key:p&&Df(p),ref:t&&t.ref?o&&a?Qe(a)?a.concat(Or(t)):[a,Or(t)]:Or(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Ce?l===-1?16:l|16:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:h,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&$s(e.ssContent),ssFallback:e.ssFallback&&$s(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return h&&i&&$a(f,h.clone(f)),f}function Ze(e=" ",t=0){return ze(pl,null,e,t)}function Of(e,t){const o=ze(Dr,null,e);return o.staticCount=t,o}function R(e="",t=!1){return t?(m(),ct(an,null,e)):ze(an,null,e)}function Co(e){return e==null||typeof e=="boolean"?ze(an):Qe(e)?ze(Ce,null,e.slice()):Aa(e)?ws(e):ze(pl,null,String(e))}function ws(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:$s(e)}function nu(e,t){let o=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(Qe(t))o=16;else if(typeof t=="object")if(i&65){const s=t.default;s&&(s._c&&(s._d=!1),nu(e,s()),s._c&&(s._d=!0));return}else{o=32;const s=t._;!s&&!Lf(t)?t._ctx=Xt:s===3&&Xt&&(Xt.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else dt(t)?(t={default:t,_ctx:Xt},o=32):(t=String(t),i&64?(o=16,t=[Ze(t)]):o=8);e.children=t,e.shapeFlag|=o}function Rf(...e){const t={};for(let o=0;o<e.length;o++){const i=e[o];for(const s in i)if(s==="class")t.class!==i.class&&(t.class=Te([t.class,i.class]));else if(s==="style")t.style=st([t.style,i.style]);else if(tl(s)){const a=t[s],l=i[s];l&&a!==l&&!(Qe(a)&&a.includes(l))&&(t[s]=a?[].concat(a,l):l)}else s!==""&&(t[s]=i[s])}return t}function ko(e,t,o,i=null){ho(e,t,7,[o,i])}const cg=kf();let ug=0;function dg(e,t,o){const i=e.type,s=(t?t.appContext:e.appContext)||cg,a={uid:ug++,vnode:e,type:i,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Mh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:xf(i,s),emitsOptions:bf(i,s),emit:null,emitted:null,propsDefaults:It,inheritAttrs:i.inheritAttrs,ctx:It,data:It,props:It,attrs:It,slots:It,refs:It,setupState:It,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=Vm.bind(null,a),e.ce&&e.ce(a),a}let rn=null;const ou=()=>rn||Xt;let qr,bc;{const e=al(),t=(o,i)=>{let s;return(s=e[o])||(s=e[o]=[]),s.push(i),a=>{s.length>1?s.forEach(l=>l(a)):s[0](a)}};qr=t("__VUE_INSTANCE_SETTERS__",o=>rn=o),bc=t("__VUE_SSR_SETTERS__",o=>Ea=o)}const Ua=e=>{const t=rn;return qr(e),e.scope.on(),()=>{e.scope.off(),qr(t)}},id=()=>{rn&&rn.scope.off(),qr(null)};function Bf(e){return e.vnode.shapeFlag&4}let Ea=!1;function hg(e,t=!1,o=!1){t&&bc(t);const{props:i,children:s}=e.vnode,a=Bf(e);Km(e,i,a,t),Qm(e,s,o||t);const l=a?fg(e,t):void 0;return t&&bc(!1),l}function fg(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Dm);const{setup:i}=o;if(i){es();const s=e.setupContext=i.length>1?vg(e):null,a=Ua(e),l=Fa(i,e,0,[e.props,s]),u=Ch(l);if(ts(),a(),(u||e.sp)&&!Pi(e)&&pf(e),u){if(l.then(id,id),t)return l.then(h=>{ad(e,h)}).catch(h=>{cl(h,e,0)});e.asyncDep=l}else ad(e,l)}else Nf(e)}function ad(e,t,o){dt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:xt(t)&&(e.setupState=Kh(t)),Nf(e)}function Nf(e,t,o){const i=e.type;e.render||(e.render=i.render||xo);{const s=Ua(e);es();try{Om(e)}finally{ts(),s()}}}const pg={get(e,t){return sn(e,"get",""),e[t]}};function vg(e){const t=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,pg),slots:e.slots,emit:e.emit,expose:t}}function vl(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Kh(Jc(e.exposed)),{get(t,o){if(o in t)return t[o];if(o in wa)return wa[o](e)},has(t,o){return o in t||o in wa}})):e.proxy}function mg(e,t=!0){return dt(e)?e.displayName||e.name:e.name||t&&e.__name}function gg(e){return dt(e)&&"__vccOpts"in e}const J=(e,t)=>am(e,t,Ea);function su(e,t,o){try{Wr(-1);const i=arguments.length;return i===2?xt(t)&&!Qe(t)?Aa(t)?ze(e,null,[t]):ze(e,t):ze(e,null,t):(i>3?o=Array.prototype.slice.call(arguments,2):i===3&&Aa(o)&&(o=[o]),ze(e,t,o))}finally{Wr(1)}}const yg="3.5.26";let wc;const rd=typeof window<"u"&&window.trustedTypes;if(rd)try{wc=rd.createPolicy("vue",{createHTML:e=>e})}catch{}const Ff=wc?e=>wc.createHTML(e):e=>e,_g="http://www.w3.org/2000/svg",kg="http://www.w3.org/1998/Math/MathML",Vo=typeof document<"u"?document:null,ld=Vo&&Vo.createElement("template"),bg={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,i)=>{const s=t==="svg"?Vo.createElementNS(_g,e):t==="mathml"?Vo.createElementNS(kg,e):o?Vo.createElement(e,{is:o}):Vo.createElement(e);return e==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:e=>Vo.createTextNode(e),createComment:e=>Vo.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Vo.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,o,i,s,a){const l=o?o.previousSibling:t.lastChild;if(s&&(s===a||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),o),!(s===a||!(s=s.nextSibling)););else{ld.innerHTML=Ff(i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e);const u=ld.content;if(i==="svg"||i==="mathml"){const h=u.firstChild;for(;h.firstChild;)u.appendChild(h.firstChild);u.removeChild(h)}t.insertBefore(u,o)}return[l?l.nextSibling:t.firstChild,o?o.previousSibling:t.lastChild]}},gs="transition",la="animation",Pa=Symbol("_vtc"),Uf={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},wg=Kt({},lf,Uf),Cg=e=>(e.displayName="Transition",e.props=wg,e),Yl=Cg((e,{slots:t})=>su(km,Lg(e),t)),Gs=(e,t=[])=>{Qe(e)?e.forEach(o=>o(...t)):e&&e(...t)},cd=e=>e?Qe(e)?e.some(t=>t.length>1):e.length>1:!1;function Lg(e){const t={};for(const pe in e)pe in Uf||(t[pe]=e[pe]);if(e.css===!1)return t;const{name:o="v",type:i,duration:s,enterFromClass:a=`${o}-enter-from`,enterActiveClass:l=`${o}-enter-active`,enterToClass:u=`${o}-enter-to`,appearFromClass:h=a,appearActiveClass:p=l,appearToClass:f=u,leaveFromClass:y=`${o}-leave-from`,leaveActiveClass:k=`${o}-leave-active`,leaveToClass:I=`${o}-leave-to`}=e,M=Sg(s),b=M&&M[0],B=M&&M[1],{onBeforeEnter:E,onEnter:A,onEnterCancelled:C,onLeave:x,onLeaveCancelled:T,onBeforeAppear:S=E,onAppear:$=A,onAppearCancelled:se=C}=t,ce=(pe,Ie,Be,Se)=>{pe._enterCancelled=Se,Zs(pe,Ie?f:u),Zs(pe,Ie?p:l),Be&&Be()},_e=(pe,Ie)=>{pe._isLeaving=!1,Zs(pe,y),Zs(pe,I),Zs(pe,k),Ie&&Ie()},ae=pe=>(Ie,Be)=>{const Se=pe?$:A,he=()=>ce(Ie,pe,Be);Gs(Se,[Ie,he]),ud(()=>{Zs(Ie,pe?h:a),zo(Ie,pe?f:u),cd(Se)||dd(Ie,i,b,he)})};return Kt(t,{onBeforeEnter(pe){Gs(E,[pe]),zo(pe,a),zo(pe,l)},onBeforeAppear(pe){Gs(S,[pe]),zo(pe,h),zo(pe,p)},onEnter:ae(!1),onAppear:ae(!0),onLeave(pe,Ie){pe._isLeaving=!0;const Be=()=>_e(pe,Ie);zo(pe,y),pe._enterCancelled?(zo(pe,k),pd(pe)):(pd(pe),zo(pe,k)),ud(()=>{pe._isLeaving&&(Zs(pe,y),zo(pe,I),cd(x)||dd(pe,i,B,Be))}),Gs(x,[pe,Be])},onEnterCancelled(pe){ce(pe,!1,void 0,!0),Gs(C,[pe])},onAppearCancelled(pe){ce(pe,!0,void 0,!0),Gs(se,[pe])},onLeaveCancelled(pe){_e(pe),Gs(T,[pe])}})}function Sg(e){if(e==null)return null;if(xt(e))return[Jl(e.enter),Jl(e.leave)];{const t=Jl(e);return[t,t]}}function Jl(e){return Sv(e)}function zo(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e[Pa]||(e[Pa]=new Set)).add(t)}function Zs(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const o=e[Pa];o&&(o.delete(t),o.size||(e[Pa]=void 0))}function ud(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let xg=0;function dd(e,t,o,i){const s=e._endId=++xg,a=()=>{s===e._endId&&i()};if(o!=null)return setTimeout(a,o);const{type:l,timeout:u,propCount:h}=Tg(e,t);if(!l)return i();const p=l+"end";let f=0;const y=()=>{e.removeEventListener(p,k),a()},k=I=>{I.target===e&&++f>=h&&y()};setTimeout(()=>{f<h&&y()},u+1),e.addEventListener(p,k)}function Tg(e,t){const o=window.getComputedStyle(e),i=M=>(o[M]||"").split(", "),s=i(`${gs}Delay`),a=i(`${gs}Duration`),l=hd(s,a),u=i(`${la}Delay`),h=i(`${la}Duration`),p=hd(u,h);let f=null,y=0,k=0;t===gs?l>0&&(f=gs,y=l,k=a.length):t===la?p>0&&(f=la,y=p,k=h.length):(y=Math.max(l,p),f=y>0?l>p?gs:la:null,k=f?f===gs?a.length:h.length:0);const I=f===gs&&/\b(?:transform|all)(?:,|$)/.test(i(`${gs}Property`).toString());return{type:f,timeout:y,propCount:k,hasTransform:I}}function hd(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((o,i)=>fd(o)+fd(e[i])))}function fd(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function pd(e){return(e?e.ownerDocument:document).body.offsetHeight}function Ig(e,t,o){const i=e[Pa];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}const Kr=Symbol("_vod"),zf=Symbol("_vsh"),Ms={name:"show",beforeMount(e,{value:t},{transition:o}){e[Kr]=e.style.display==="none"?"":e.style.display,o&&t?o.beforeEnter(e):ca(e,t)},mounted(e,{value:t},{transition:o}){o&&t&&o.enter(e)},updated(e,{value:t,oldValue:o},{transition:i}){!t!=!o&&(i?t?(i.beforeEnter(e),ca(e,!0),i.enter(e)):i.leave(e,()=>{ca(e,!1)}):ca(e,t))},beforeUnmount(e,{value:t}){ca(e,t)}};function ca(e,t){e.style.display=t?e[Kr]:"none",e[zf]=!t}const $g=Symbol(""),Mg=/(?:^|;)\s*display\s*:/;function Ag(e,t,o){const i=e.style,s=Ft(o);let a=!1;if(o&&!s){if(t)if(Ft(t))for(const l of t.split(";")){const u=l.slice(0,l.indexOf(":")).trim();o[u]==null&&Rr(i,u,"")}else for(const l in t)o[l]==null&&Rr(i,l,"");for(const l in o)l==="display"&&(a=!0),Rr(i,l,o[l])}else if(s){if(t!==o){const l=i[$g];l&&(o+=";"+l),i.cssText=o,a=Mg.test(o)}}else t&&e.removeAttribute("style");Kr in e&&(e[Kr]=a?i.display:"",e[zf]&&(i.display="none"))}const vd=/\s*!important$/;function Rr(e,t,o){if(Qe(o))o.forEach(i=>Rr(e,t,i));else if(o==null&&(o=""),t.startsWith("--"))e.setProperty(t,o);else{const i=Eg(e,t);vd.test(o)?e.setProperty(Es(i),o.replace(vd,""),"important"):e[i]=o}}const md=["Webkit","Moz","ms"],Xl={};function Eg(e,t){const o=Xl[t];if(o)return o;let i=Kn(t);if(i!=="filter"&&i in e)return Xl[t]=i;i=sl(i);for(let s=0;s<md.length;s++){const a=md[s]+i;if(a in e)return Xl[t]=a}return t}const gd="http://www.w3.org/1999/xlink";function yd(e,t,o,i,s,a=Av(t)){i&&t.startsWith("xlink:")?o==null?e.removeAttributeNS(gd,t.slice(6,t.length)):e.setAttributeNS(gd,t,o):o==null||a&&!Th(o)?e.removeAttribute(t):e.setAttribute(t,a?"":co(o)?String(o):o)}function _d(e,t,o,i,s){if(t==="innerHTML"||t==="textContent"){o!=null&&(e[t]=t==="innerHTML"?Ff(o):o);return}const a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){const u=a==="OPTION"?e.getAttribute("value")||"":e.value,h=o==null?e.type==="checkbox"?"on":"":String(o);(u!==h||!("_value"in e))&&(e.value=h),o==null&&e.removeAttribute(t),e._value=o;return}let l=!1;if(o===""||o==null){const u=typeof e[t];u==="boolean"?o=Th(o):o==null&&u==="string"?(o="",l=!0):u==="number"&&(o=0,l=!0)}try{e[t]=o}catch{}l&&e.removeAttribute(s||t)}function qo(e,t,o,i){e.addEventListener(t,o,i)}function Pg(e,t,o,i){e.removeEventListener(t,o,i)}const kd=Symbol("_vei");function Dg(e,t,o,i,s=null){const a=e[kd]||(e[kd]={}),l=a[t];if(i&&l)l.value=i;else{const[u,h]=Og(t);if(i){const p=a[t]=Ng(i,s);qo(e,u,p,h)}else l&&(Pg(e,u,l,h),a[t]=void 0)}}const bd=/(?:Once|Passive|Capture)$/;function Og(e){let t;if(bd.test(e)){t={};let i;for(;i=e.match(bd);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Es(e.slice(2)),t]}let Ql=0;const Rg=Promise.resolve(),Bg=()=>Ql||(Rg.then(()=>Ql=0),Ql=Date.now());function Ng(e,t){const o=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=o.attached)return;ho(Fg(i,o.value),t,5,[i])};return o.value=e,o.attached=Bg(),o}function Fg(e,t){if(Qe(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map(i=>s=>!s._stopped&&i&&i(s))}else return t}const wd=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Ug=(e,t,o,i,s,a)=>{const l=s==="svg";t==="class"?Ig(e,i,l):t==="style"?Ag(e,o,i):tl(t)?Hc(t)||Dg(e,t,o,i,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):zg(e,t,i,l))?(_d(e,t,i),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&yd(e,t,i,l,a,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Ft(i))?_d(e,Kn(t),i,a,t):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),yd(e,t,i,l))};function zg(e,t,o,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&wd(t)&&dt(o));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return wd(t)&&Ft(o)?!1:t in e}const As=e=>{const t=e.props["onUpdate:modelValue"]||!1;return Qe(t)?o=>Ar(t,o):t};function Hg(e){e.target.composing=!0}function Cd(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const qn=Symbol("_assign");function Ld(e,t,o){return t&&(e=e.trim()),o&&(e=il(e)),e}const ht={created(e,{modifiers:{lazy:t,trim:o,number:i}},s){e[qn]=As(s);const a=i||s.props&&s.props.type==="number";qo(e,t?"change":"input",l=>{l.target.composing||e[qn](Ld(e.value,o,a))}),(o||a)&&qo(e,"change",()=>{e.value=Ld(e.value,o,a)}),t||(qo(e,"compositionstart",Hg),qo(e,"compositionend",Cd),qo(e,"change",Cd))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:o,modifiers:{lazy:i,trim:s,number:a}},l){if(e[qn]=As(l),e.composing)return;const u=(a||e.type==="number")&&!/^0\d/.test(e.value)?il(e.value):e.value,h=t??"";u!==h&&(document.activeElement===e&&e.type!=="range"&&(i&&t===o||s&&e.value.trim()===h)||(e.value=h))}},Ls={deep:!0,created(e,t,o){e[qn]=As(o),qo(e,"change",()=>{const i=e._modelValue,s=Ri(e),a=e.checked,l=e[qn];if(Qe(i)){const u=Gc(i,s),h=u!==-1;if(a&&!h)l(i.concat(s));else if(!a&&h){const p=[...i];p.splice(u,1),l(p)}}else if(Ui(i)){const u=new Set(i);a?u.add(s):u.delete(s),l(u)}else l(Hf(e,a))})},mounted:Sd,beforeUpdate(e,t,o){e[qn]=As(o),Sd(e,t,o)}};function Sd(e,{value:t,oldValue:o},i){e._modelValue=t;let s;if(Qe(t))s=Gc(t,i.props.value)>-1;else if(Ui(t))s=t.has(i.props.value);else{if(t===o)return;s=ai(t,Hf(e,!0))}e.checked!==s&&(e.checked=s)}const xd={created(e,{value:t},o){e.checked=ai(t,o.props.value),e[qn]=As(o),qo(e,"change",()=>{e[qn](Ri(e))})},beforeUpdate(e,{value:t,oldValue:o},i){e[qn]=As(i),t!==o&&(e.checked=ai(t,i.props.value))}},bn={deep:!0,created(e,{value:t,modifiers:{number:o}},i){const s=Ui(t);qo(e,"change",()=>{const a=Array.prototype.filter.call(e.options,l=>l.selected).map(l=>o?il(Ri(l)):Ri(l));e[qn](e.multiple?s?new Set(a):a:a[0]),e._assigning=!0,Qo(()=>{e._assigning=!1})}),e[qn]=As(i)},mounted(e,{value:t}){Td(e,t)},beforeUpdate(e,t,o){e[qn]=As(o)},updated(e,{value:t}){e._assigning||Td(e,t)}};function Td(e,t){const o=e.multiple,i=Qe(t);if(!(o&&!i&&!Ui(t))){for(let s=0,a=e.options.length;s<a;s++){const l=e.options[s],u=Ri(l);if(o)if(i){const h=typeof u;h==="string"||h==="number"?l.selected=t.some(p=>String(p)===String(u)):l.selected=Gc(t,u)>-1}else l.selected=t.has(u);else if(ai(Ri(l),t)){e.selectedIndex!==s&&(e.selectedIndex=s);return}}!o&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Ri(e){return"_value"in e?e._value:e.value}function Hf(e,t){const o=t?"_trueValue":"_falseValue";return o in e?e[o]:t}const Vg=["ctrl","shift","alt","meta"],Gg={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Vg.some(o=>e[`${o}Key`]&&!t.includes(o))},vt=(e,t)=>{const o=e._withMods||(e._withMods={}),i=t.join(".");return o[i]||(o[i]=((s,...a)=>{for(let l=0;l<t.length;l++){const u=Gg[t[l]];if(u&&u(s,t))return}return e(s,...a)}))},Zg={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Vf=(e,t)=>{const o=e._withKeys||(e._withKeys={}),i=t.join(".");return o[i]||(o[i]=(s=>{if(!("key"in s))return;const a=Es(s.key);if(t.some(l=>l===a||Zg[l]===a))return e(s)}))},jg=Kt({patchProp:Ug},bg);let Id;function Wg(){return Id||(Id=tg(jg))}const qg=((...e)=>{const t=Wg().createApp(...e),{mount:o}=t;return t.mount=i=>{const s=Yg(i);if(!s)return;const a=t._component;!dt(a)&&!a.render&&!a.template&&(a.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const l=o(s,!1,Kg(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),l},t});function Kg(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Yg(e){return Ft(e)?document.querySelector(e):e}let Gf;const ml=e=>Gf=e,Zf=Symbol();function Cc(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var La;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(La||(La={}));function Jg(){const e=Ah(!0),t=e.run(()=>P({}));let o=[],i=[];const s=Jc({install(a){ml(s),s._a=a,a.provide(Zf,s),a.config.globalProperties.$pinia=s,i.forEach(l=>o.push(l)),i=[]},use(a){return this._a?o.push(a):i.push(a),this},_p:o,_a:null,_e:e,_s:new Map,state:t});return s}const jf=()=>{};function $d(e,t,o,i=jf){e.add(t);const s=()=>{e.delete(t)&&i()};return!o&&Eh()&&Pv(s),s}function Li(e,...t){e.forEach(o=>{o(...t)})}const Xg=e=>e(),Md=Symbol(),ec=Symbol();function Lc(e,t){e instanceof Map&&t instanceof Map?t.forEach((o,i)=>e.set(i,o)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const o in t){if(!t.hasOwnProperty(o))continue;const i=t[o],s=e[o];Cc(s)&&Cc(i)&&e.hasOwnProperty(o)&&!Nt(i)&&!Xo(i)?e[o]=Lc(s,i):e[o]=i}return e}const Qg=Symbol();function ey(e){return!Cc(e)||!Object.prototype.hasOwnProperty.call(e,Qg)}const{assign:_s}=Object;function ty(e){return!!(Nt(e)&&e.effect)}function ny(e,t,o,i){const{state:s,actions:a,getters:l}=t,u=o.state.value[e];let h;function p(){u||(o.state.value[e]=s?s():{});const f=nm(o.state.value[e]);return _s(f,a,Object.keys(l||{}).reduce((y,k)=>(y[k]=Jc(J(()=>{ml(o);const I=o._s.get(e);return l[k].call(I,I)})),y),{}))}return h=Wf(e,p,t,o,i,!0),h}function Wf(e,t,o={},i,s,a){let l;const u=_s({actions:{}},o),h={deep:!0};let p,f,y=new Set,k=new Set,I;const M=i.state.value[e];!a&&!M&&(i.state.value[e]={}),P({});let b;function B(se){let ce;p=f=!1,typeof se=="function"?(se(i.state.value[e]),ce={type:La.patchFunction,storeId:e,events:I}):(Lc(i.state.value[e],se),ce={type:La.patchObject,payload:se,storeId:e,events:I});const _e=b=Symbol();Qo().then(()=>{b===_e&&(p=!0)}),f=!0,Li(y,ce,i.state.value[e])}const E=a?function(){const{state:ce}=o,_e=ce?ce():{};this.$patch(ae=>{_s(ae,_e)})}:jf;function A(){l.stop(),y.clear(),k.clear(),i._s.delete(e)}const C=(se,ce="")=>{if(Md in se)return se[ec]=ce,se;const _e=function(){ml(i);const ae=Array.from(arguments),pe=new Set,Ie=new Set;function Be(Q){pe.add(Q)}function Se(Q){Ie.add(Q)}Li(k,{args:ae,name:_e[ec],store:T,after:Be,onError:Se});let he;try{he=se.apply(this&&this.$id===e?this:T,ae)}catch(Q){throw Li(Ie,Q),Q}return he instanceof Promise?he.then(Q=>(Li(pe,Q),Q)).catch(Q=>(Li(Ie,Q),Promise.reject(Q))):(Li(pe,he),he)};return _e[Md]=!0,_e[ec]=ce,_e},x={_p:i,$id:e,$onAction:$d.bind(null,k),$patch:B,$reset:E,$subscribe(se,ce={}){const _e=$d(y,se,ce.detached,()=>ae()),ae=l.run(()=>qe(()=>i.state.value[e],pe=>{(ce.flush==="sync"?f:p)&&se({storeId:e,type:La.direct,events:I},pe)},_s({},h,ce)));return _e},$dispose:A},T=Na(x);i._s.set(e,T);const $=(i._a&&i._a.runWithContext||Xg)(()=>i._e.run(()=>(l=Ah()).run(()=>t({action:C}))));for(const se in $){const ce=$[se];if(Nt(ce)&&!ty(ce)||Xo(ce))a||(M&&ey(ce)&&(Nt(ce)?ce.value=M[se]:Lc(ce,M[se])),i.state.value[e][se]=ce);else if(typeof ce=="function"){const _e=C(ce,se);$[se]=_e,u.actions[se]=ce}}return _s(T,$),_s(gt(T),$),Object.defineProperty(T,"$state",{get:()=>i.state.value[e],set:se=>{B(ce=>{_s(ce,se)})}}),i._p.forEach(se=>{_s(T,l.run(()=>se({store:T,app:i._a,pinia:i,options:u})))}),M&&a&&o.hydrate&&o.hydrate(T.$state,M),p=!0,f=!0,T}function iu(e,t,o){let i;const s=typeof t=="function";i=s?o:t;function a(l,u){const h=hm();return l=l||(h?Wn(Zf,null):null),l&&ml(l),l=Gf,l._s.has(e)||(s?Wf(e,t,i,l):ny(e,i,l)),l._s.get(e)}return a.$id=e,a}const Ye=(e,t)=>{const o=e.__vccOpts||e;for(const[i,s]of t)o[i]=s;return o},oy={},sy={id:"app"};function iy(e,t){const o=hl("router-view");return m(),g("div",sy,[ze(o)])}const ay=Ye(oy,[["render",iy]]);const xi=typeof document<"u";function qf(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function ry(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&qf(e.default)}const bt=Object.assign;function tc(e,t){const o={};for(const i in t){const s=t[i];o[i]=fo(s)?s.map(e):e(s)}return o}const Sa=()=>{},fo=Array.isArray;function Ad(e,t){const o={};for(const i in e)o[i]=i in t?t[i]:e[i];return o}const Kf=/#/g,ly=/&/g,cy=/\//g,uy=/=/g,dy=/\?/g,Yf=/\+/g,hy=/%5B/g,fy=/%5D/g,Jf=/%5E/g,py=/%60/g,Xf=/%7B/g,vy=/%7C/g,Qf=/%7D/g,my=/%20/g;function au(e){return e==null?"":encodeURI(""+e).replace(vy,"|").replace(hy,"[").replace(fy,"]")}function gy(e){return au(e).replace(Xf,"{").replace(Qf,"}").replace(Jf,"^")}function Sc(e){return au(e).replace(Yf,"%2B").replace(my,"+").replace(Kf,"%23").replace(ly,"%26").replace(py,"`").replace(Xf,"{").replace(Qf,"}").replace(Jf,"^")}function yy(e){return Sc(e).replace(uy,"%3D")}function _y(e){return au(e).replace(Kf,"%23").replace(dy,"%3F")}function ky(e){return _y(e).replace(cy,"%2F")}function Da(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const by=/\/$/,wy=e=>e.replace(by,"");function nc(e,t,o="/"){let i,s={},a="",l="";const u=t.indexOf("#");let h=t.indexOf("?");return h=u>=0&&h>u?-1:h,h>=0&&(i=t.slice(0,h),a=t.slice(h,u>0?u:t.length),s=e(a.slice(1))),u>=0&&(i=i||t.slice(0,u),l=t.slice(u,t.length)),i=xy(i??t,o),{fullPath:i+a+l,path:i,query:s,hash:Da(l)}}function Cy(e,t){const o=t.query?e(t.query):"";return t.path+(o&&"?")+o+(t.hash||"")}function Ed(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Ly(e,t,o){const i=t.matched.length-1,s=o.matched.length-1;return i>-1&&i===s&&Bi(t.matched[i],o.matched[s])&&ep(t.params,o.params)&&e(t.query)===e(o.query)&&t.hash===o.hash}function Bi(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function ep(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var o in e)if(!Sy(e[o],t[o]))return!1;return!0}function Sy(e,t){return fo(e)?Pd(e,t):fo(t)?Pd(t,e):e?.valueOf()===t?.valueOf()}function Pd(e,t){return fo(t)?e.length===t.length&&e.every((o,i)=>o===t[i]):e.length===1&&e[0]===t}function xy(e,t){if(e.startsWith("/"))return e;if(!e)return t;const o=t.split("/"),i=e.split("/"),s=i[i.length-1];(s===".."||s===".")&&i.push("");let a=o.length-1,l,u;for(l=0;l<i.length;l++)if(u=i[l],u!==".")if(u==="..")a>1&&a--;else break;return o.slice(0,a).join("/")+"/"+i.slice(l).join("/")}const ys={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let xc=(function(e){return e.pop="pop",e.push="push",e})({}),oc=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function Ty(e){if(!e)if(xi){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),wy(e)}const Iy=/^[^#]+#/;function $y(e,t){return e.replace(Iy,"#")+t}function My(e,t){const o=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-o.left-(t.left||0),top:i.top-o.top-(t.top||0)}}const gl=()=>({left:window.scrollX,top:window.scrollY});function Ay(e){let t;if("el"in e){const o=e.el,i=typeof o=="string"&&o.startsWith("#"),s=typeof o=="string"?i?document.getElementById(o.slice(1)):document.querySelector(o):o;if(!s)return;t=My(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function Dd(e,t){return(history.state?history.state.position-t:-1)+e}const Tc=new Map;function Ey(e,t){Tc.set(e,t)}function Py(e){const t=Tc.get(e);return Tc.delete(e),t}function Dy(e){return typeof e=="string"||e&&typeof e=="object"}function tp(e){return typeof e=="string"||typeof e=="symbol"}let Bt=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const np=Symbol("");Bt.MATCHER_NOT_FOUND+"",Bt.NAVIGATION_GUARD_REDIRECT+"",Bt.NAVIGATION_ABORTED+"",Bt.NAVIGATION_CANCELLED+"",Bt.NAVIGATION_DUPLICATED+"";function Ni(e,t){return bt(new Error,{type:e,[np]:!0},t)}function Ho(e,t){return e instanceof Error&&np in e&&(t==null||!!(e.type&t))}const Oy=["params","query","hash"];function Ry(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const o of Oy)o in e&&(t[o]=e[o]);return JSON.stringify(t,null,2)}function By(e){const t={};if(e===""||e==="?")return t;const o=(e[0]==="?"?e.slice(1):e).split("&");for(let i=0;i<o.length;++i){const s=o[i].replace(Yf," "),a=s.indexOf("="),l=Da(a<0?s:s.slice(0,a)),u=a<0?null:Da(s.slice(a+1));if(l in t){let h=t[l];fo(h)||(h=t[l]=[h]),h.push(u)}else t[l]=u}return t}function Od(e){let t="";for(let o in e){const i=e[o];if(o=yy(o),i==null){i!==void 0&&(t+=(t.length?"&":"")+o);continue}(fo(i)?i.map(s=>s&&Sc(s)):[i&&Sc(i)]).forEach(s=>{s!==void 0&&(t+=(t.length?"&":"")+o,s!=null&&(t+="="+s))})}return t}function Ny(e){const t={};for(const o in e){const i=e[o];i!==void 0&&(t[o]=fo(i)?i.map(s=>s==null?null:""+s):i==null?i:""+i)}return t}const Fy=Symbol(""),Rd=Symbol(""),yl=Symbol(""),ru=Symbol(""),Ic=Symbol("");function ua(){let e=[];function t(i){return e.push(i),()=>{const s=e.indexOf(i);s>-1&&e.splice(s,1)}}function o(){e=[]}return{add:t,list:()=>e.slice(),reset:o}}function Cs(e,t,o,i,s,a=l=>l()){const l=i&&(i.enterCallbacks[s]=i.enterCallbacks[s]||[]);return()=>new Promise((u,h)=>{const p=k=>{k===!1?h(Ni(Bt.NAVIGATION_ABORTED,{from:o,to:t})):k instanceof Error?h(k):Dy(k)?h(Ni(Bt.NAVIGATION_GUARD_REDIRECT,{from:t,to:k})):(l&&i.enterCallbacks[s]===l&&typeof k=="function"&&l.push(k),u())},f=a(()=>e.call(i&&i.instances[s],t,o,p));let y=Promise.resolve(f);e.length<3&&(y=y.then(p)),y.catch(k=>h(k))})}function sc(e,t,o,i,s=a=>a()){const a=[];for(const l of e)for(const u in l.components){let h=l.components[u];if(!(t!=="beforeRouteEnter"&&!l.instances[u]))if(qf(h)){const p=(h.__vccOpts||h)[t];p&&a.push(Cs(p,o,i,l,u,s))}else{let p=h();a.push(()=>p.then(f=>{if(!f)throw new Error(`Couldn't resolve component "${u}" at "${l.path}"`);const y=ry(f)?f.default:f;l.mods[u]=f,l.components[u]=y;const k=(y.__vccOpts||y)[t];return k&&Cs(k,o,i,l,u,s)()}))}}return a}function Uy(e,t){const o=[],i=[],s=[],a=Math.max(t.matched.length,e.matched.length);for(let l=0;l<a;l++){const u=t.matched[l];u&&(e.matched.find(p=>Bi(p,u))?i.push(u):o.push(u));const h=e.matched[l];h&&(t.matched.find(p=>Bi(p,h))||s.push(h))}return[o,i,s]}let zy=()=>location.protocol+"//"+location.host;function op(e,t){const{pathname:o,search:i,hash:s}=t,a=e.indexOf("#");if(a>-1){let l=s.includes(e.slice(a))?e.slice(a).length:1,u=s.slice(l);return u[0]!=="/"&&(u="/"+u),Ed(u,"")}return Ed(o,e)+i+s}function Hy(e,t,o,i){let s=[],a=[],l=null;const u=({state:k})=>{const I=op(e,location),M=o.value,b=t.value;let B=0;if(k){if(o.value=I,t.value=k,l&&l===M){l=null;return}B=b?k.position-b.position:0}else i(I);s.forEach(E=>{E(o.value,M,{delta:B,type:xc.pop,direction:B?B>0?oc.forward:oc.back:oc.unknown})})};function h(){l=o.value}function p(k){s.push(k);const I=()=>{const M=s.indexOf(k);M>-1&&s.splice(M,1)};return a.push(I),I}function f(){if(document.visibilityState==="hidden"){const{history:k}=window;if(!k.state)return;k.replaceState(bt({},k.state,{scroll:gl()}),"")}}function y(){for(const k of a)k();a=[],window.removeEventListener("popstate",u),window.removeEventListener("pagehide",f),document.removeEventListener("visibilitychange",f)}return window.addEventListener("popstate",u),window.addEventListener("pagehide",f),document.addEventListener("visibilitychange",f),{pauseListeners:h,listen:p,destroy:y}}function Bd(e,t,o,i=!1,s=!1){return{back:e,current:t,forward:o,replaced:i,position:window.history.length,scroll:s?gl():null}}function Vy(e){const{history:t,location:o}=window,i={value:op(e,o)},s={value:t.state};s.value||a(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function a(h,p,f){const y=e.indexOf("#"),k=y>-1?(o.host&&document.querySelector("base")?e:e.slice(y))+h:zy()+e+h;try{t[f?"replaceState":"pushState"](p,"",k),s.value=p}catch(I){console.error(I),o[f?"replace":"assign"](k)}}function l(h,p){a(h,bt({},t.state,Bd(s.value.back,h,s.value.forward,!0),p,{position:s.value.position}),!0),i.value=h}function u(h,p){const f=bt({},s.value,t.state,{forward:h,scroll:gl()});a(f.current,f,!0),a(h,bt({},Bd(i.value,h,null),{position:f.position+1},p),!1),i.value=h}return{location:i,state:s,push:u,replace:l}}function Gy(e){e=Ty(e);const t=Vy(e),o=Hy(e,t.state,t.location,t.replace);function i(a,l=!0){l||o.pauseListeners(),history.go(a)}const s=bt({location:"",base:e,go:i,createHref:$y.bind(null,e)},t,o);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function Zy(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),Gy(e)}let Xs=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var jt=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(jt||{});const jy={type:Xs.Static,value:""},Wy=/[a-zA-Z0-9_]/;function qy(e){if(!e)return[[]];if(e==="/")return[[jy]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(I){throw new Error(`ERR (${o})/"${p}": ${I}`)}let o=jt.Static,i=o;const s=[];let a;function l(){a&&s.push(a),a=[]}let u=0,h,p="",f="";function y(){p&&(o===jt.Static?a.push({type:Xs.Static,value:p}):o===jt.Param||o===jt.ParamRegExp||o===jt.ParamRegExpEnd?(a.length>1&&(h==="*"||h==="+")&&t(`A repeatable param (${p}) must be alone in its segment. eg: '/:ids+.`),a.push({type:Xs.Param,value:p,regexp:f,repeatable:h==="*"||h==="+",optional:h==="*"||h==="?"})):t("Invalid state to consume buffer"),p="")}function k(){p+=h}for(;u<e.length;){if(h=e[u++],h==="\\"&&o!==jt.ParamRegExp){i=o,o=jt.EscapeNext;continue}switch(o){case jt.Static:h==="/"?(p&&y(),l()):h===":"?(y(),o=jt.Param):k();break;case jt.EscapeNext:k(),o=i;break;case jt.Param:h==="("?o=jt.ParamRegExp:Wy.test(h)?k():(y(),o=jt.Static,h!=="*"&&h!=="?"&&h!=="+"&&u--);break;case jt.ParamRegExp:h===")"?f[f.length-1]=="\\"?f=f.slice(0,-1)+h:o=jt.ParamRegExpEnd:f+=h;break;case jt.ParamRegExpEnd:y(),o=jt.Static,h!=="*"&&h!=="?"&&h!=="+"&&u--,f="";break;default:t("Unknown state");break}}return o===jt.ParamRegExp&&t(`Unfinished custom RegExp for param "${p}"`),y(),l(),s}const Nd="[^/]+?",Ky={sensitive:!1,strict:!1,start:!0,end:!0};var fn=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(fn||{});const Yy=/[.+*?^${}()[\]/\\]/g;function Jy(e,t){const o=bt({},Ky,t),i=[];let s=o.start?"^":"";const a=[];for(const p of e){const f=p.length?[]:[fn.Root];o.strict&&!p.length&&(s+="/");for(let y=0;y<p.length;y++){const k=p[y];let I=fn.Segment+(o.sensitive?fn.BonusCaseSensitive:0);if(k.type===Xs.Static)y||(s+="/"),s+=k.value.replace(Yy,"\\$&"),I+=fn.Static;else if(k.type===Xs.Param){const{value:M,repeatable:b,optional:B,regexp:E}=k;a.push({name:M,repeatable:b,optional:B});const A=E||Nd;if(A!==Nd){I+=fn.BonusCustomRegExp;try{`${A}`}catch(x){throw new Error(`Invalid custom RegExp for param "${M}" (${A}): `+x.message)}}let C=b?`((?:${A})(?:/(?:${A}))*)`:`(${A})`;y||(C=B&&p.length<2?`(?:/${C})`:"/"+C),B&&(C+="?"),s+=C,I+=fn.Dynamic,B&&(I+=fn.BonusOptional),b&&(I+=fn.BonusRepeatable),A===".*"&&(I+=fn.BonusWildcard)}f.push(I)}i.push(f)}if(o.strict&&o.end){const p=i.length-1;i[p][i[p].length-1]+=fn.BonusStrict}o.strict||(s+="/?"),o.end?s+="$":o.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const l=new RegExp(s,o.sensitive?"":"i");function u(p){const f=p.match(l),y={};if(!f)return null;for(let k=1;k<f.length;k++){const I=f[k]||"",M=a[k-1];y[M.name]=I&&M.repeatable?I.split("/"):I}return y}function h(p){let f="",y=!1;for(const k of e){(!y||!f.endsWith("/"))&&(f+="/"),y=!1;for(const I of k)if(I.type===Xs.Static)f+=I.value;else if(I.type===Xs.Param){const{value:M,repeatable:b,optional:B}=I,E=M in p?p[M]:"";if(fo(E)&&!b)throw new Error(`Provided param "${M}" is an array but it is not repeatable (* or + modifiers)`);const A=fo(E)?E.join("/"):E;if(!A)if(B)k.length<2&&(f.endsWith("/")?f=f.slice(0,-1):y=!0);else throw new Error(`Missing required param "${M}"`);f+=A}}return f||"/"}return{re:l,score:i,keys:a,parse:u,stringify:h}}function Xy(e,t){let o=0;for(;o<e.length&&o<t.length;){const i=t[o]-e[o];if(i)return i;o++}return e.length<t.length?e.length===1&&e[0]===fn.Static+fn.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===fn.Static+fn.Segment?1:-1:0}function sp(e,t){let o=0;const i=e.score,s=t.score;for(;o<i.length&&o<s.length;){const a=Xy(i[o],s[o]);if(a)return a;o++}if(Math.abs(s.length-i.length)===1){if(Fd(i))return 1;if(Fd(s))return-1}return s.length-i.length}function Fd(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const Qy={strict:!1,end:!0,sensitive:!1};function e_(e,t,o){const i=Jy(qy(e.path),o),s=bt(i,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function t_(e,t){const o=[],i=new Map;t=Ad(Qy,t);function s(y){return i.get(y)}function a(y,k,I){const M=!I,b=zd(y);b.aliasOf=I&&I.record;const B=Ad(t,y),E=[b];if("alias"in y){const x=typeof y.alias=="string"?[y.alias]:y.alias;for(const T of x)E.push(zd(bt({},b,{components:I?I.record.components:b.components,path:T,aliasOf:I?I.record:b})))}let A,C;for(const x of E){const{path:T}=x;if(k&&T[0]!=="/"){const S=k.record.path,$=S[S.length-1]==="/"?"":"/";x.path=k.record.path+(T&&$+T)}if(A=e_(x,k,B),I?I.alias.push(A):(C=C||A,C!==A&&C.alias.push(A),M&&y.name&&!Hd(A)&&l(y.name)),ip(A)&&h(A),b.children){const S=b.children;for(let $=0;$<S.length;$++)a(S[$],A,I&&I.children[$])}I=I||A}return C?()=>{l(C)}:Sa}function l(y){if(tp(y)){const k=i.get(y);k&&(i.delete(y),o.splice(o.indexOf(k),1),k.children.forEach(l),k.alias.forEach(l))}else{const k=o.indexOf(y);k>-1&&(o.splice(k,1),y.record.name&&i.delete(y.record.name),y.children.forEach(l),y.alias.forEach(l))}}function u(){return o}function h(y){const k=s_(y,o);o.splice(k,0,y),y.record.name&&!Hd(y)&&i.set(y.record.name,y)}function p(y,k){let I,M={},b,B;if("name"in y&&y.name){if(I=i.get(y.name),!I)throw Ni(Bt.MATCHER_NOT_FOUND,{location:y});B=I.record.name,M=bt(Ud(k.params,I.keys.filter(C=>!C.optional).concat(I.parent?I.parent.keys.filter(C=>C.optional):[]).map(C=>C.name)),y.params&&Ud(y.params,I.keys.map(C=>C.name))),b=I.stringify(M)}else if(y.path!=null)b=y.path,I=o.find(C=>C.re.test(b)),I&&(M=I.parse(b),B=I.record.name);else{if(I=k.name?i.get(k.name):o.find(C=>C.re.test(k.path)),!I)throw Ni(Bt.MATCHER_NOT_FOUND,{location:y,currentLocation:k});B=I.record.name,M=bt({},k.params,y.params),b=I.stringify(M)}const E=[];let A=I;for(;A;)E.unshift(A.record),A=A.parent;return{name:B,path:b,params:M,matched:E,meta:o_(E)}}e.forEach(y=>a(y));function f(){o.length=0,i.clear()}return{addRoute:a,resolve:p,removeRoute:l,clearRoutes:f,getRoutes:u,getRecordMatcher:s}}function Ud(e,t){const o={};for(const i of t)i in e&&(o[i]=e[i]);return o}function zd(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:n_(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function n_(e){const t={},o=e.props||!1;if("component"in e)t.default=o;else for(const i in e.components)t[i]=typeof o=="object"?o[i]:o;return t}function Hd(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function o_(e){return e.reduce((t,o)=>bt(t,o.meta),{})}function s_(e,t){let o=0,i=t.length;for(;o!==i;){const a=o+i>>1;sp(e,t[a])<0?i=a:o=a+1}const s=i_(e);return s&&(i=t.lastIndexOf(s,i-1)),i}function i_(e){let t=e;for(;t=t.parent;)if(ip(t)&&sp(e,t)===0)return t}function ip({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Vd(e){const t=Wn(yl),o=Wn(ru),i=J(()=>{const h=z(e.to);return t.resolve(h)}),s=J(()=>{const{matched:h}=i.value,{length:p}=h,f=h[p-1],y=o.matched;if(!f||!y.length)return-1;const k=y.findIndex(Bi.bind(null,f));if(k>-1)return k;const I=Gd(h[p-2]);return p>1&&Gd(f)===I&&y[y.length-1].path!==I?y.findIndex(Bi.bind(null,h[p-2])):k}),a=J(()=>s.value>-1&&u_(o.params,i.value.params)),l=J(()=>s.value>-1&&s.value===o.matched.length-1&&ep(o.params,i.value.params));function u(h={}){if(c_(h)){const p=t[z(e.replace)?"replace":"push"](z(e.to)).catch(Sa);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>p),p}return Promise.resolve()}return{route:i,href:J(()=>i.value.href),isActive:a,isExactActive:l,navigate:u}}function a_(e){return e.length===1?e[0]:e}const r_=ff({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Vd,setup(e,{slots:t}){const o=Na(Vd(e)),{options:i}=Wn(yl),s=J(()=>({[Zd(e.activeClass,i.linkActiveClass,"router-link-active")]:o.isActive,[Zd(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:o.isExactActive}));return()=>{const a=t.default&&a_(t.default(o));return e.custom?a:su("a",{"aria-current":o.isExactActive?e.ariaCurrentValue:null,href:o.href,onClick:o.navigate,class:s.value},a)}}}),l_=r_;function c_(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function u_(e,t){for(const o in t){const i=t[o],s=e[o];if(typeof i=="string"){if(i!==s)return!1}else if(!fo(s)||s.length!==i.length||i.some((a,l)=>a.valueOf()!==s[l].valueOf()))return!1}return!0}function Gd(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Zd=(e,t,o)=>e??t??o,d_=ff({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:o}){const i=Wn(Ic),s=J(()=>e.route||i.value),a=Wn(Rd,0),l=J(()=>{let p=z(a);const{matched:f}=s.value;let y;for(;(y=f[p])&&!y.components;)p++;return p}),u=J(()=>s.value.matched[l.value]);Er(Rd,J(()=>l.value+1)),Er(Fy,u),Er(Ic,s);const h=P();return qe(()=>[h.value,u.value,e.name],([p,f,y],[k,I,M])=>{f&&(f.instances[y]=p,I&&I!==f&&p&&p===k&&(f.leaveGuards.size||(f.leaveGuards=I.leaveGuards),f.updateGuards.size||(f.updateGuards=I.updateGuards))),p&&f&&(!I||!Bi(f,I)||!k)&&(f.enterCallbacks[y]||[]).forEach(b=>b(p))},{flush:"post"}),()=>{const p=s.value,f=e.name,y=u.value,k=y&&y.components[f];if(!k)return jd(o.default,{Component:k,route:p});const I=y.props[f],M=I?I===!0?p.params:typeof I=="function"?I(p):I:null,B=su(k,bt({},M,t,{onVnodeUnmounted:E=>{E.component.isUnmounted&&(y.instances[f]=null)},ref:h}));return jd(o.default,{Component:B,route:p})||B}}});function jd(e,t){if(!e)return null;const o=e(t);return o.length===1?o[0]:o}const h_=d_;function f_(e){const t=t_(e.routes,e),o=e.parseQuery||By,i=e.stringifyQuery||Od,s=e.history,a=ua(),l=ua(),u=ua(),h=Qv(ys);let p=ys;xi&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const f=tc.bind(null,re=>""+re),y=tc.bind(null,ky),k=tc.bind(null,Da);function I(re,ve){let q,fe;return tp(re)?(q=t.getRecordMatcher(re),fe=ve):fe=re,t.addRoute(fe,q)}function M(re){const ve=t.getRecordMatcher(re);ve&&t.removeRoute(ve)}function b(){return t.getRoutes().map(re=>re.record)}function B(re){return!!t.getRecordMatcher(re)}function E(re,ve){if(ve=bt({},ve||h.value),typeof re=="string"){const Y=nc(o,re,ve.path),Z=t.resolve({path:Y.path},ve),N=s.createHref(Y.fullPath);return bt(Y,Z,{params:k(Z.params),hash:Da(Y.hash),redirectedFrom:void 0,href:N})}let q;if(re.path!=null)q=bt({},re,{path:nc(o,re.path,ve.path).path});else{const Y=bt({},re.params);for(const Z in Y)Y[Z]==null&&delete Y[Z];q=bt({},re,{params:y(Y)}),ve.params=y(ve.params)}const fe=t.resolve(q,ve),Le=re.hash||"";fe.params=f(k(fe.params));const U=Cy(i,bt({},re,{hash:gy(Le),path:fe.path})),H=s.createHref(U);return bt({fullPath:U,hash:Le,query:i===Od?Ny(re.query):re.query||{}},fe,{redirectedFrom:void 0,href:H})}function A(re){return typeof re=="string"?nc(o,re,h.value.path):bt({},re)}function C(re,ve){if(p!==re)return Ni(Bt.NAVIGATION_CANCELLED,{from:ve,to:re})}function x(re){return $(re)}function T(re){return x(bt(A(re),{replace:!0}))}function S(re,ve){const q=re.matched[re.matched.length-1];if(q&&q.redirect){const{redirect:fe}=q;let Le=typeof fe=="function"?fe(re,ve):fe;return typeof Le=="string"&&(Le=Le.includes("?")||Le.includes("#")?Le=A(Le):{path:Le},Le.params={}),bt({query:re.query,hash:re.hash,params:Le.path!=null?{}:re.params},Le)}}function $(re,ve){const q=p=E(re),fe=h.value,Le=re.state,U=re.force,H=re.replace===!0,Y=S(q,fe);if(Y)return $(bt(A(Y),{state:typeof Y=="object"?bt({},Le,Y.state):Le,force:U,replace:H}),ve||q);const Z=q;Z.redirectedFrom=ve;let N;return!U&&Ly(i,fe,q)&&(N=Ni(Bt.NAVIGATION_DUPLICATED,{to:Z,from:fe}),be(fe,fe,!0,!1)),(N?Promise.resolve(N):_e(Z,fe)).catch(O=>Ho(O)?Ho(O,Bt.NAVIGATION_GUARD_REDIRECT)?O:te(O):X(O,Z,fe)).then(O=>{if(O){if(Ho(O,Bt.NAVIGATION_GUARD_REDIRECT))return $(bt({replace:H},A(O.to),{state:typeof O.to=="object"?bt({},Le,O.to.state):Le,force:U}),ve||Z)}else O=pe(Z,fe,!0,H,Le);return ae(Z,fe,O),O})}function se(re,ve){const q=C(re,ve);return q?Promise.reject(q):Promise.resolve()}function ce(re){const ve=Ee.values().next().value;return ve&&typeof ve.runWithContext=="function"?ve.runWithContext(re):re()}function _e(re,ve){let q;const[fe,Le,U]=Uy(re,ve);q=sc(fe.reverse(),"beforeRouteLeave",re,ve);for(const Y of fe)Y.leaveGuards.forEach(Z=>{q.push(Cs(Z,re,ve))});const H=se.bind(null,re,ve);return q.push(H),we(q).then(()=>{q=[];for(const Y of a.list())q.push(Cs(Y,re,ve));return q.push(H),we(q)}).then(()=>{q=sc(Le,"beforeRouteUpdate",re,ve);for(const Y of Le)Y.updateGuards.forEach(Z=>{q.push(Cs(Z,re,ve))});return q.push(H),we(q)}).then(()=>{q=[];for(const Y of U)if(Y.beforeEnter)if(fo(Y.beforeEnter))for(const Z of Y.beforeEnter)q.push(Cs(Z,re,ve));else q.push(Cs(Y.beforeEnter,re,ve));return q.push(H),we(q)}).then(()=>(re.matched.forEach(Y=>Y.enterCallbacks={}),q=sc(U,"beforeRouteEnter",re,ve,ce),q.push(H),we(q))).then(()=>{q=[];for(const Y of l.list())q.push(Cs(Y,re,ve));return q.push(H),we(q)}).catch(Y=>Ho(Y,Bt.NAVIGATION_CANCELLED)?Y:Promise.reject(Y))}function ae(re,ve,q){u.list().forEach(fe=>ce(()=>fe(re,ve,q)))}function pe(re,ve,q,fe,Le){const U=C(re,ve);if(U)return U;const H=ve===ys,Y=xi?history.state:{};q&&(fe||H?s.replace(re.fullPath,bt({scroll:H&&Y&&Y.scroll},Le)):s.push(re.fullPath,Le)),h.value=re,be(re,ve,q,H),te()}let Ie;function Be(){Ie||(Ie=s.listen((re,ve,q)=>{if(!xe.listening)return;const fe=E(re),Le=S(fe,xe.currentRoute.value);if(Le){$(bt(Le,{replace:!0,force:!0}),fe).catch(Sa);return}p=fe;const U=h.value;xi&&Ey(Dd(U.fullPath,q.delta),gl()),_e(fe,U).catch(H=>Ho(H,Bt.NAVIGATION_ABORTED|Bt.NAVIGATION_CANCELLED)?H:Ho(H,Bt.NAVIGATION_GUARD_REDIRECT)?($(bt(A(H.to),{force:!0}),fe).then(Y=>{Ho(Y,Bt.NAVIGATION_ABORTED|Bt.NAVIGATION_DUPLICATED)&&!q.delta&&q.type===xc.pop&&s.go(-1,!1)}).catch(Sa),Promise.reject()):(q.delta&&s.go(-q.delta,!1),X(H,fe,U))).then(H=>{H=H||pe(fe,U,!1),H&&(q.delta&&!Ho(H,Bt.NAVIGATION_CANCELLED)?s.go(-q.delta,!1):q.type===xc.pop&&Ho(H,Bt.NAVIGATION_ABORTED|Bt.NAVIGATION_DUPLICATED)&&s.go(-1,!1)),ae(fe,U,H)}).catch(Sa)}))}let Se=ua(),he=ua(),Q;function X(re,ve,q){te(re);const fe=he.list();return fe.length?fe.forEach(Le=>Le(re,ve,q)):console.error(re),Promise.reject(re)}function ue(){return Q&&h.value!==ys?Promise.resolve():new Promise((re,ve)=>{Se.add([re,ve])})}function te(re){return Q||(Q=!re,Be(),Se.list().forEach(([ve,q])=>re?q(re):ve()),Se.reset()),re}function be(re,ve,q,fe){const{scrollBehavior:Le}=e;if(!xi||!Le)return Promise.resolve();const U=!q&&Py(Dd(re.fullPath,0))||(fe||!q)&&history.state&&history.state.scroll||null;return Qo().then(()=>Le(re,ve,U)).then(H=>H&&Ay(H)).catch(H=>X(H,re,ve))}const Oe=re=>s.go(re);let ne;const Ee=new Set,xe={currentRoute:h,listening:!0,addRoute:I,removeRoute:M,clearRoutes:t.clearRoutes,hasRoute:B,getRoutes:b,resolve:E,options:e,push:x,replace:T,go:Oe,back:()=>Oe(-1),forward:()=>Oe(1),beforeEach:a.add,beforeResolve:l.add,afterEach:u.add,onError:he.add,isReady:ue,install(re){re.component("RouterLink",l_),re.component("RouterView",h_),re.config.globalProperties.$router=xe,Object.defineProperty(re.config.globalProperties,"$route",{enumerable:!0,get:()=>z(h)}),xi&&!ne&&h.value===ys&&(ne=!0,x(s.location).catch(fe=>{}));const ve={};for(const fe in ys)Object.defineProperty(ve,fe,{get:()=>h.value[fe],enumerable:!0});re.provide(yl,xe),re.provide(ru,Wh(ve)),re.provide(Ic,h);const q=re.unmount;Ee.add(re),re.unmount=function(){Ee.delete(re),Ee.size<1&&(p=ys,Ie&&Ie(),Ie=null,h.value=ys,ne=!1,Q=!1),q()}}};function we(re){return re.reduce((ve,q)=>ve.then(()=>ce(q)),Promise.resolve())}return xe}function za(){return Wn(yl)}function lu(e){return Wn(ru)}const p_={},v_={class:"home"},m_={class:"container"},g_={class:"actions"};function y_(e,t){const o=hl("router-link");return m(),g("div",v_,[c("div",m_,[t[1]||(t[1]=c("h1",null,"Volunteer Check-in System ",-1)),t[2]||(t[2]=c("p",{class:"subtitle"},"Manage race marshals and volunteers with ease",-1)),c("div",g_,[ze(o,{to:"/admin/login",class:"btn btn-primary"},{default:et(()=>[...t[0]||(t[0]=[Ze(" Admin Portal ",-1)])]),_:1})]),t[3]||(t[3]=Of('<div class="features" data-v-536ab6a4><div class="feature-card" data-v-536ab6a4><h3 data-v-536ab6a4>For Admins</h3><ul data-v-536ab6a4><li data-v-536ab6a4>Create and manage events</li><li data-v-536ab6a4>Define marshal locations</li><li data-v-536ab6a4>Assign marshals to locations</li><li data-v-536ab6a4>Real-time check-in monitoring</li><li data-v-536ab6a4>Map view of all locations</li></ul></div><div class="feature-card" data-v-536ab6a4><h3 data-v-536ab6a4>For Marshals</h3><ul data-v-536ab6a4><li data-v-536ab6a4>View your assigned location</li><li data-v-536ab6a4>Check in with GPS verification</li><li data-v-536ab6a4>Access emergency contact info</li><li data-v-536ab6a4>View all marshal locations</li></ul></div></div>',1))])])}const __=Ye(p_,[["render",y_],["__scopeId","data-v-536ab6a4"]]);function ap(e,t){return function(){return e.apply(t,arguments)}}const{toString:k_}=Object.prototype,{getPrototypeOf:cu}=Object,{iterator:_l,toStringTag:rp}=Symbol,kl=(e=>t=>{const o=k_.call(t);return e[o]||(e[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),vo=e=>(e=e.toLowerCase(),t=>kl(t)===e),bl=e=>t=>typeof t===e,{isArray:zi}=Array,Fi=bl("undefined");function Ha(e){return e!==null&&!Fi(e)&&e.constructor!==null&&!Fi(e.constructor)&&Ln(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const lp=vo("ArrayBuffer");function b_(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&lp(e.buffer),t}const w_=bl("string"),Ln=bl("function"),cp=bl("number"),Va=e=>e!==null&&typeof e=="object",C_=e=>e===!0||e===!1,Br=e=>{if(kl(e)!=="object")return!1;const t=cu(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(rp in e)&&!(_l in e)},L_=e=>{if(!Va(e)||Ha(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},S_=vo("Date"),x_=vo("File"),T_=vo("Blob"),I_=vo("FileList"),$_=e=>Va(e)&&Ln(e.pipe),M_=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Ln(e.append)&&((t=kl(e))==="formdata"||t==="object"&&Ln(e.toString)&&e.toString()==="[object FormData]"))},A_=vo("URLSearchParams"),[E_,P_,D_,O_]=["ReadableStream","Request","Response","Headers"].map(vo),R_=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ga(e,t,{allOwnKeys:o=!1}={}){if(e===null||typeof e>"u")return;let i,s;if(typeof e!="object"&&(e=[e]),zi(e))for(i=0,s=e.length;i<s;i++)t.call(null,e[i],i,e);else{if(Ha(e))return;const a=o?Object.getOwnPropertyNames(e):Object.keys(e),l=a.length;let u;for(i=0;i<l;i++)u=a[i],t.call(null,e[u],u,e)}}function up(e,t){if(Ha(e))return null;t=t.toLowerCase();const o=Object.keys(e);let i=o.length,s;for(;i-- >0;)if(s=o[i],t===s.toLowerCase())return s;return null}const Qs=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,dp=e=>!Fi(e)&&e!==Qs;function $c(){const{caseless:e,skipUndefined:t}=dp(this)&&this||{},o={},i=(s,a)=>{const l=e&&up(o,a)||a;Br(o[l])&&Br(s)?o[l]=$c(o[l],s):Br(s)?o[l]=$c({},s):zi(s)?o[l]=s.slice():(!t||!Fi(s))&&(o[l]=s)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&Ga(arguments[s],i);return o}const B_=(e,t,o,{allOwnKeys:i}={})=>(Ga(t,(s,a)=>{o&&Ln(s)?e[a]=ap(s,o):e[a]=s},{allOwnKeys:i}),e),N_=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),F_=(e,t,o,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),o&&Object.assign(e.prototype,o)},U_=(e,t,o,i)=>{let s,a,l;const u={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),a=s.length;a-- >0;)l=s[a],(!i||i(l,e,t))&&!u[l]&&(t[l]=e[l],u[l]=!0);e=o!==!1&&cu(e)}while(e&&(!o||o(e,t))&&e!==Object.prototype);return t},z_=(e,t,o)=>{e=String(e),(o===void 0||o>e.length)&&(o=e.length),o-=t.length;const i=e.indexOf(t,o);return i!==-1&&i===o},H_=e=>{if(!e)return null;if(zi(e))return e;let t=e.length;if(!cp(t))return null;const o=new Array(t);for(;t-- >0;)o[t]=e[t];return o},V_=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&cu(Uint8Array)),G_=(e,t)=>{const i=(e&&e[_l]).call(e);let s;for(;(s=i.next())&&!s.done;){const a=s.value;t.call(e,a[0],a[1])}},Z_=(e,t)=>{let o;const i=[];for(;(o=e.exec(t))!==null;)i.push(o);return i},j_=vo("HTMLFormElement"),W_=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,i,s){return i.toUpperCase()+s}),Wd=(({hasOwnProperty:e})=>(t,o)=>e.call(t,o))(Object.prototype),q_=vo("RegExp"),hp=(e,t)=>{const o=Object.getOwnPropertyDescriptors(e),i={};Ga(o,(s,a)=>{let l;(l=t(s,a,e))!==!1&&(i[a]=l||s)}),Object.defineProperties(e,i)},K_=e=>{hp(e,(t,o)=>{if(Ln(e)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const i=e[o];if(Ln(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},Y_=(e,t)=>{const o={},i=s=>{s.forEach(a=>{o[a]=!0})};return zi(e)?i(e):i(String(e).split(t)),o},J_=()=>{},X_=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Q_(e){return!!(e&&Ln(e.append)&&e[rp]==="FormData"&&e[_l])}const e1=e=>{const t=new Array(10),o=(i,s)=>{if(Va(i)){if(t.indexOf(i)>=0)return;if(Ha(i))return i;if(!("toJSON"in i)){t[s]=i;const a=zi(i)?[]:{};return Ga(i,(l,u)=>{const h=o(l,s+1);!Fi(h)&&(a[u]=h)}),t[s]=void 0,a}}return i};return o(e,0)},t1=vo("AsyncFunction"),n1=e=>e&&(Va(e)||Ln(e))&&Ln(e.then)&&Ln(e.catch),fp=((e,t)=>e?setImmediate:t?((o,i)=>(Qs.addEventListener("message",({source:s,data:a})=>{s===Qs&&a===o&&i.length&&i.shift()()},!1),s=>{i.push(s),Qs.postMessage(o,"*")}))(`axios@${Math.random()}`,[]):o=>setTimeout(o))(typeof setImmediate=="function",Ln(Qs.postMessage)),o1=typeof queueMicrotask<"u"?queueMicrotask.bind(Qs):typeof process<"u"&&process.nextTick||fp,s1=e=>e!=null&&Ln(e[_l]),ye={isArray:zi,isArrayBuffer:lp,isBuffer:Ha,isFormData:M_,isArrayBufferView:b_,isString:w_,isNumber:cp,isBoolean:C_,isObject:Va,isPlainObject:Br,isEmptyObject:L_,isReadableStream:E_,isRequest:P_,isResponse:D_,isHeaders:O_,isUndefined:Fi,isDate:S_,isFile:x_,isBlob:T_,isRegExp:q_,isFunction:Ln,isStream:$_,isURLSearchParams:A_,isTypedArray:V_,isFileList:I_,forEach:Ga,merge:$c,extend:B_,trim:R_,stripBOM:N_,inherits:F_,toFlatObject:U_,kindOf:kl,kindOfTest:vo,endsWith:z_,toArray:H_,forEachEntry:G_,matchAll:Z_,isHTMLForm:j_,hasOwnProperty:Wd,hasOwnProp:Wd,reduceDescriptors:hp,freezeMethods:K_,toObjectSet:Y_,toCamelCase:W_,noop:J_,toFiniteNumber:X_,findKey:up,global:Qs,isContextDefined:dp,isSpecCompliantForm:Q_,toJSONObject:e1,isAsyncFn:t1,isThenable:n1,setImmediate:fp,asap:o1,isIterable:s1};function ft(e,t,o,i,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),o&&(this.config=o),i&&(this.request=i),s&&(this.response=s,this.status=s.status?s.status:null)}ye.inherits(ft,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ye.toJSONObject(this.config),code:this.code,status:this.status}}});const pp=ft.prototype,vp={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{vp[e]={value:e}});Object.defineProperties(ft,vp);Object.defineProperty(pp,"isAxiosError",{value:!0});ft.from=(e,t,o,i,s,a)=>{const l=Object.create(pp);ye.toFlatObject(e,l,function(f){return f!==Error.prototype},p=>p!=="isAxiosError");const u=e&&e.message?e.message:"Error",h=t==null&&e?e.code:t;return ft.call(l,u,h,o,i,s),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",a&&Object.assign(l,a),l};const i1=null;function Mc(e){return ye.isPlainObject(e)||ye.isArray(e)}function mp(e){return ye.endsWith(e,"[]")?e.slice(0,-2):e}function qd(e,t,o){return e?e.concat(t).map(function(s,a){return s=mp(s),!o&&a?"["+s+"]":s}).join(o?".":""):t}function a1(e){return ye.isArray(e)&&!e.some(Mc)}const r1=ye.toFlatObject(ye,{},null,function(t){return/^is[A-Z]/.test(t)});function wl(e,t,o){if(!ye.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,o=ye.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(b,B){return!ye.isUndefined(B[b])});const i=o.metaTokens,s=o.visitor||f,a=o.dots,l=o.indexes,h=(o.Blob||typeof Blob<"u"&&Blob)&&ye.isSpecCompliantForm(t);if(!ye.isFunction(s))throw new TypeError("visitor must be a function");function p(M){if(M===null)return"";if(ye.isDate(M))return M.toISOString();if(ye.isBoolean(M))return M.toString();if(!h&&ye.isBlob(M))throw new ft("Blob is not supported. Use a Buffer instead.");return ye.isArrayBuffer(M)||ye.isTypedArray(M)?h&&typeof Blob=="function"?new Blob([M]):Buffer.from(M):M}function f(M,b,B){let E=M;if(M&&!B&&typeof M=="object"){if(ye.endsWith(b,"{}"))b=i?b:b.slice(0,-2),M=JSON.stringify(M);else if(ye.isArray(M)&&a1(M)||(ye.isFileList(M)||ye.endsWith(b,"[]"))&&(E=ye.toArray(M)))return b=mp(b),E.forEach(function(C,x){!(ye.isUndefined(C)||C===null)&&t.append(l===!0?qd([b],x,a):l===null?b:b+"[]",p(C))}),!1}return Mc(M)?!0:(t.append(qd(B,b,a),p(M)),!1)}const y=[],k=Object.assign(r1,{defaultVisitor:f,convertValue:p,isVisitable:Mc});function I(M,b){if(!ye.isUndefined(M)){if(y.indexOf(M)!==-1)throw Error("Circular reference detected in "+b.join("."));y.push(M),ye.forEach(M,function(E,A){(!(ye.isUndefined(E)||E===null)&&s.call(t,E,ye.isString(A)?A.trim():A,b,k))===!0&&I(E,b?b.concat(A):[A])}),y.pop()}}if(!ye.isObject(e))throw new TypeError("data must be an object");return I(e),t}function Kd(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function uu(e,t){this._pairs=[],e&&wl(e,this,t)}const gp=uu.prototype;gp.append=function(t,o){this._pairs.push([t,o])};gp.toString=function(t){const o=t?function(i){return t.call(this,i,Kd)}:Kd;return this._pairs.map(function(s){return o(s[0])+"="+o(s[1])},"").join("&")};function l1(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function yp(e,t,o){if(!t)return e;const i=o&&o.encode||l1;ye.isFunction(o)&&(o={serialize:o});const s=o&&o.serialize;let a;if(s?a=s(t,o):a=ye.isURLSearchParams(t)?t.toString():new uu(t,o).toString(i),a){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class Yd{constructor(){this.handlers=[]}use(t,o,i){return this.handlers.push({fulfilled:t,rejected:o,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ye.forEach(this.handlers,function(i){i!==null&&t(i)})}}const _p={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},c1=typeof URLSearchParams<"u"?URLSearchParams:uu,u1=typeof FormData<"u"?FormData:null,d1=typeof Blob<"u"?Blob:null,h1={isBrowser:!0,classes:{URLSearchParams:c1,FormData:u1,Blob:d1},protocols:["http","https","file","blob","url","data"]},du=typeof window<"u"&&typeof document<"u",Ac=typeof navigator=="object"&&navigator||void 0,f1=du&&(!Ac||["ReactNative","NativeScript","NS"].indexOf(Ac.product)<0),p1=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",v1=du&&window.location.href||"http://localhost",m1=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:du,hasStandardBrowserEnv:f1,hasStandardBrowserWebWorkerEnv:p1,navigator:Ac,origin:v1},Symbol.toStringTag,{value:"Module"})),ln={...m1,...h1};function g1(e,t){return wl(e,new ln.classes.URLSearchParams,{visitor:function(o,i,s,a){return ln.isNode&&ye.isBuffer(o)?(this.append(i,o.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function y1(e){return ye.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function _1(e){const t={},o=Object.keys(e);let i;const s=o.length;let a;for(i=0;i<s;i++)a=o[i],t[a]=e[a];return t}function kp(e){function t(o,i,s,a){let l=o[a++];if(l==="__proto__")return!0;const u=Number.isFinite(+l),h=a>=o.length;return l=!l&&ye.isArray(s)?s.length:l,h?(ye.hasOwnProp(s,l)?s[l]=[s[l],i]:s[l]=i,!u):((!s[l]||!ye.isObject(s[l]))&&(s[l]=[]),t(o,i,s[l],a)&&ye.isArray(s[l])&&(s[l]=_1(s[l])),!u)}if(ye.isFormData(e)&&ye.isFunction(e.entries)){const o={};return ye.forEachEntry(e,(i,s)=>{t(y1(i),s,o,0)}),o}return null}function k1(e,t,o){if(ye.isString(e))try{return(t||JSON.parse)(e),ye.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(o||JSON.stringify)(e)}const Za={transitional:_p,adapter:["xhr","http","fetch"],transformRequest:[function(t,o){const i=o.getContentType()||"",s=i.indexOf("application/json")>-1,a=ye.isObject(t);if(a&&ye.isHTMLForm(t)&&(t=new FormData(t)),ye.isFormData(t))return s?JSON.stringify(kp(t)):t;if(ye.isArrayBuffer(t)||ye.isBuffer(t)||ye.isStream(t)||ye.isFile(t)||ye.isBlob(t)||ye.isReadableStream(t))return t;if(ye.isArrayBufferView(t))return t.buffer;if(ye.isURLSearchParams(t))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(a){if(i.indexOf("application/x-www-form-urlencoded")>-1)return g1(t,this.formSerializer).toString();if((u=ye.isFileList(t))||i.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return wl(u?{"files[]":t}:t,h&&new h,this.formSerializer)}}return a||s?(o.setContentType("application/json",!1),k1(t)):t}],transformResponse:[function(t){const o=this.transitional||Za.transitional,i=o&&o.forcedJSONParsing,s=this.responseType==="json";if(ye.isResponse(t)||ye.isReadableStream(t))return t;if(t&&ye.isString(t)&&(i&&!this.responseType||s)){const l=!(o&&o.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(u){if(l)throw u.name==="SyntaxError"?ft.from(u,ft.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ln.classes.FormData,Blob:ln.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ye.forEach(["delete","get","head","post","put","patch"],e=>{Za.headers[e]={}});const b1=ye.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),w1=e=>{const t={};let o,i,s;return e&&e.split(`
`).forEach(function(l){s=l.indexOf(":"),o=l.substring(0,s).trim().toLowerCase(),i=l.substring(s+1).trim(),!(!o||t[o]&&b1[o])&&(o==="set-cookie"?t[o]?t[o].push(i):t[o]=[i]:t[o]=t[o]?t[o]+", "+i:i)}),t},Jd=Symbol("internals");function da(e){return e&&String(e).trim().toLowerCase()}function Nr(e){return e===!1||e==null?e:ye.isArray(e)?e.map(Nr):String(e)}function C1(e){const t=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=o.exec(e);)t[i[1]]=i[2];return t}const L1=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function ic(e,t,o,i,s){if(ye.isFunction(i))return i.call(this,t,o);if(s&&(t=o),!!ye.isString(t)){if(ye.isString(i))return t.indexOf(i)!==-1;if(ye.isRegExp(i))return i.test(t)}}function S1(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,o,i)=>o.toUpperCase()+i)}function x1(e,t){const o=ye.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+o,{value:function(s,a,l){return this[i].call(this,t,s,a,l)},configurable:!0})})}let Sn=class{constructor(t){t&&this.set(t)}set(t,o,i){const s=this;function a(u,h,p){const f=da(h);if(!f)throw new Error("header name must be a non-empty string");const y=ye.findKey(s,f);(!y||s[y]===void 0||p===!0||p===void 0&&s[y]!==!1)&&(s[y||h]=Nr(u))}const l=(u,h)=>ye.forEach(u,(p,f)=>a(p,f,h));if(ye.isPlainObject(t)||t instanceof this.constructor)l(t,o);else if(ye.isString(t)&&(t=t.trim())&&!L1(t))l(w1(t),o);else if(ye.isObject(t)&&ye.isIterable(t)){let u={},h,p;for(const f of t){if(!ye.isArray(f))throw TypeError("Object iterator must return a key-value pair");u[p=f[0]]=(h=u[p])?ye.isArray(h)?[...h,f[1]]:[h,f[1]]:f[1]}l(u,o)}else t!=null&&a(o,t,i);return this}get(t,o){if(t=da(t),t){const i=ye.findKey(this,t);if(i){const s=this[i];if(!o)return s;if(o===!0)return C1(s);if(ye.isFunction(o))return o.call(this,s,i);if(ye.isRegExp(o))return o.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,o){if(t=da(t),t){const i=ye.findKey(this,t);return!!(i&&this[i]!==void 0&&(!o||ic(this,this[i],i,o)))}return!1}delete(t,o){const i=this;let s=!1;function a(l){if(l=da(l),l){const u=ye.findKey(i,l);u&&(!o||ic(i,i[u],u,o))&&(delete i[u],s=!0)}}return ye.isArray(t)?t.forEach(a):a(t),s}clear(t){const o=Object.keys(this);let i=o.length,s=!1;for(;i--;){const a=o[i];(!t||ic(this,this[a],a,t,!0))&&(delete this[a],s=!0)}return s}normalize(t){const o=this,i={};return ye.forEach(this,(s,a)=>{const l=ye.findKey(i,a);if(l){o[l]=Nr(s),delete o[a];return}const u=t?S1(a):String(a).trim();u!==a&&delete o[a],o[u]=Nr(s),i[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const o=Object.create(null);return ye.forEach(this,(i,s)=>{i!=null&&i!==!1&&(o[s]=t&&ye.isArray(i)?i.join(", "):i)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,o])=>t+": "+o).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...o){const i=new this(t);return o.forEach(s=>i.set(s)),i}static accessor(t){const i=(this[Jd]=this[Jd]={accessors:{}}).accessors,s=this.prototype;function a(l){const u=da(l);i[u]||(x1(s,l),i[u]=!0)}return ye.isArray(t)?t.forEach(a):a(t),this}};Sn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ye.reduceDescriptors(Sn.prototype,({value:e},t)=>{let o=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[o]=i}}});ye.freezeMethods(Sn);function ac(e,t){const o=this||Za,i=t||o,s=Sn.from(i.headers);let a=i.data;return ye.forEach(e,function(u){a=u.call(o,a,s.normalize(),t?t.status:void 0)}),s.normalize(),a}function bp(e){return!!(e&&e.__CANCEL__)}function Hi(e,t,o){ft.call(this,e??"canceled",ft.ERR_CANCELED,t,o),this.name="CanceledError"}ye.inherits(Hi,ft,{__CANCEL__:!0});function wp(e,t,o){const i=o.config.validateStatus;!o.status||!i||i(o.status)?e(o):t(new ft("Request failed with status code "+o.status,[ft.ERR_BAD_REQUEST,ft.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}function T1(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function I1(e,t){e=e||10;const o=new Array(e),i=new Array(e);let s=0,a=0,l;return t=t!==void 0?t:1e3,function(h){const p=Date.now(),f=i[a];l||(l=p),o[s]=h,i[s]=p;let y=a,k=0;for(;y!==s;)k+=o[y++],y=y%e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),p-l<t)return;const I=f&&p-f;return I?Math.round(k*1e3/I):void 0}}function $1(e,t){let o=0,i=1e3/t,s,a;const l=(p,f=Date.now())=>{o=f,s=null,a&&(clearTimeout(a),a=null),e(...p)};return[(...p)=>{const f=Date.now(),y=f-o;y>=i?l(p,f):(s=p,a||(a=setTimeout(()=>{a=null,l(s)},i-y)))},()=>s&&l(s)]}const Yr=(e,t,o=3)=>{let i=0;const s=I1(50,250);return $1(a=>{const l=a.loaded,u=a.lengthComputable?a.total:void 0,h=l-i,p=s(h),f=l<=u;i=l;const y={loaded:l,total:u,progress:u?l/u:void 0,bytes:h,rate:p||void 0,estimated:p&&u&&f?(u-l)/p:void 0,event:a,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(y)},o)},Xd=(e,t)=>{const o=e!=null;return[i=>t[0]({lengthComputable:o,total:e,loaded:i}),t[1]]},Qd=e=>(...t)=>ye.asap(()=>e(...t)),M1=ln.hasStandardBrowserEnv?((e,t)=>o=>(o=new URL(o,ln.origin),e.protocol===o.protocol&&e.host===o.host&&(t||e.port===o.port)))(new URL(ln.origin),ln.navigator&&/(msie|trident)/i.test(ln.navigator.userAgent)):()=>!0,A1=ln.hasStandardBrowserEnv?{write(e,t,o,i,s,a,l){if(typeof document>"u")return;const u=[`${e}=${encodeURIComponent(t)}`];ye.isNumber(o)&&u.push(`expires=${new Date(o).toUTCString()}`),ye.isString(i)&&u.push(`path=${i}`),ye.isString(s)&&u.push(`domain=${s}`),a===!0&&u.push("secure"),ye.isString(l)&&u.push(`SameSite=${l}`),document.cookie=u.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function E1(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function P1(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Cp(e,t,o){let i=!E1(t);return e&&(i||o==!1)?P1(e,t):t}const eh=e=>e instanceof Sn?{...e}:e;function ri(e,t){t=t||{};const o={};function i(p,f,y,k){return ye.isPlainObject(p)&&ye.isPlainObject(f)?ye.merge.call({caseless:k},p,f):ye.isPlainObject(f)?ye.merge({},f):ye.isArray(f)?f.slice():f}function s(p,f,y,k){if(ye.isUndefined(f)){if(!ye.isUndefined(p))return i(void 0,p,y,k)}else return i(p,f,y,k)}function a(p,f){if(!ye.isUndefined(f))return i(void 0,f)}function l(p,f){if(ye.isUndefined(f)){if(!ye.isUndefined(p))return i(void 0,p)}else return i(void 0,f)}function u(p,f,y){if(y in t)return i(p,f);if(y in e)return i(void 0,p)}const h={url:a,method:a,data:a,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:u,headers:(p,f,y)=>s(eh(p),eh(f),y,!0)};return ye.forEach(Object.keys({...e,...t}),function(f){const y=h[f]||s,k=y(e[f],t[f],f);ye.isUndefined(k)&&y!==u||(o[f]=k)}),o}const Lp=e=>{const t=ri({},e);let{data:o,withXSRFToken:i,xsrfHeaderName:s,xsrfCookieName:a,headers:l,auth:u}=t;if(t.headers=l=Sn.from(l),t.url=yp(Cp(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&l.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),ye.isFormData(o)){if(ln.hasStandardBrowserEnv||ln.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(ye.isFunction(o.getHeaders)){const h=o.getHeaders(),p=["content-type","content-length"];Object.entries(h).forEach(([f,y])=>{p.includes(f.toLowerCase())&&l.set(f,y)})}}if(ln.hasStandardBrowserEnv&&(i&&ye.isFunction(i)&&(i=i(t)),i||i!==!1&&M1(t.url))){const h=s&&a&&A1.read(a);h&&l.set(s,h)}return t},D1=typeof XMLHttpRequest<"u",O1=D1&&function(e){return new Promise(function(o,i){const s=Lp(e);let a=s.data;const l=Sn.from(s.headers).normalize();let{responseType:u,onUploadProgress:h,onDownloadProgress:p}=s,f,y,k,I,M;function b(){I&&I(),M&&M(),s.cancelToken&&s.cancelToken.unsubscribe(f),s.signal&&s.signal.removeEventListener("abort",f)}let B=new XMLHttpRequest;B.open(s.method.toUpperCase(),s.url,!0),B.timeout=s.timeout;function E(){if(!B)return;const C=Sn.from("getAllResponseHeaders"in B&&B.getAllResponseHeaders()),T={data:!u||u==="text"||u==="json"?B.responseText:B.response,status:B.status,statusText:B.statusText,headers:C,config:e,request:B};wp(function($){o($),b()},function($){i($),b()},T),B=null}"onloadend"in B?B.onloadend=E:B.onreadystatechange=function(){!B||B.readyState!==4||B.status===0&&!(B.responseURL&&B.responseURL.indexOf("file:")===0)||setTimeout(E)},B.onabort=function(){B&&(i(new ft("Request aborted",ft.ECONNABORTED,e,B)),B=null)},B.onerror=function(x){const T=x&&x.message?x.message:"Network Error",S=new ft(T,ft.ERR_NETWORK,e,B);S.event=x||null,i(S),B=null},B.ontimeout=function(){let x=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const T=s.transitional||_p;s.timeoutErrorMessage&&(x=s.timeoutErrorMessage),i(new ft(x,T.clarifyTimeoutError?ft.ETIMEDOUT:ft.ECONNABORTED,e,B)),B=null},a===void 0&&l.setContentType(null),"setRequestHeader"in B&&ye.forEach(l.toJSON(),function(x,T){B.setRequestHeader(T,x)}),ye.isUndefined(s.withCredentials)||(B.withCredentials=!!s.withCredentials),u&&u!=="json"&&(B.responseType=s.responseType),p&&([k,M]=Yr(p,!0),B.addEventListener("progress",k)),h&&B.upload&&([y,I]=Yr(h),B.upload.addEventListener("progress",y),B.upload.addEventListener("loadend",I)),(s.cancelToken||s.signal)&&(f=C=>{B&&(i(!C||C.type?new Hi(null,e,B):C),B.abort(),B=null)},s.cancelToken&&s.cancelToken.subscribe(f),s.signal&&(s.signal.aborted?f():s.signal.addEventListener("abort",f)));const A=T1(s.url);if(A&&ln.protocols.indexOf(A)===-1){i(new ft("Unsupported protocol "+A+":",ft.ERR_BAD_REQUEST,e));return}B.send(a||null)})},R1=(e,t)=>{const{length:o}=e=e?e.filter(Boolean):[];if(t||o){let i=new AbortController,s;const a=function(p){if(!s){s=!0,u();const f=p instanceof Error?p:this.reason;i.abort(f instanceof ft?f:new Hi(f instanceof Error?f.message:f))}};let l=t&&setTimeout(()=>{l=null,a(new ft(`timeout ${t} of ms exceeded`,ft.ETIMEDOUT))},t);const u=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(p=>{p.unsubscribe?p.unsubscribe(a):p.removeEventListener("abort",a)}),e=null)};e.forEach(p=>p.addEventListener("abort",a));const{signal:h}=i;return h.unsubscribe=()=>ye.asap(u),h}},B1=function*(e,t){let o=e.byteLength;if(o<t){yield e;return}let i=0,s;for(;i<o;)s=i+t,yield e.slice(i,s),i=s},N1=async function*(e,t){for await(const o of F1(e))yield*B1(o,t)},F1=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:o,value:i}=await t.read();if(o)break;yield i}}finally{await t.cancel()}},th=(e,t,o,i)=>{const s=N1(e,t);let a=0,l,u=h=>{l||(l=!0,i&&i(h))};return new ReadableStream({async pull(h){try{const{done:p,value:f}=await s.next();if(p){u(),h.close();return}let y=f.byteLength;if(o){let k=a+=y;o(k)}h.enqueue(new Uint8Array(f))}catch(p){throw u(p),p}},cancel(h){return u(h),s.return()}},{highWaterMark:2})},nh=64*1024,{isFunction:xr}=ye,U1=(({Request:e,Response:t})=>({Request:e,Response:t}))(ye.global),{ReadableStream:oh,TextEncoder:sh}=ye.global,ih=(e,...t)=>{try{return!!e(...t)}catch{return!1}},z1=e=>{e=ye.merge.call({skipUndefined:!0},U1,e);const{fetch:t,Request:o,Response:i}=e,s=t?xr(t):typeof fetch=="function",a=xr(o),l=xr(i);if(!s)return!1;const u=s&&xr(oh),h=s&&(typeof sh=="function"?(M=>b=>M.encode(b))(new sh):async M=>new Uint8Array(await new o(M).arrayBuffer())),p=a&&u&&ih(()=>{let M=!1;const b=new o(ln.origin,{body:new oh,method:"POST",get duplex(){return M=!0,"half"}}).headers.has("Content-Type");return M&&!b}),f=l&&u&&ih(()=>ye.isReadableStream(new i("").body)),y={stream:f&&(M=>M.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(M=>{!y[M]&&(y[M]=(b,B)=>{let E=b&&b[M];if(E)return E.call(b);throw new ft(`Response type '${M}' is not supported`,ft.ERR_NOT_SUPPORT,B)})});const k=async M=>{if(M==null)return 0;if(ye.isBlob(M))return M.size;if(ye.isSpecCompliantForm(M))return(await new o(ln.origin,{method:"POST",body:M}).arrayBuffer()).byteLength;if(ye.isArrayBufferView(M)||ye.isArrayBuffer(M))return M.byteLength;if(ye.isURLSearchParams(M)&&(M=M+""),ye.isString(M))return(await h(M)).byteLength},I=async(M,b)=>{const B=ye.toFiniteNumber(M.getContentLength());return B??k(b)};return async M=>{let{url:b,method:B,data:E,signal:A,cancelToken:C,timeout:x,onDownloadProgress:T,onUploadProgress:S,responseType:$,headers:se,withCredentials:ce="same-origin",fetchOptions:_e}=Lp(M),ae=t||fetch;$=$?($+"").toLowerCase():"text";let pe=R1([A,C&&C.toAbortSignal()],x),Ie=null;const Be=pe&&pe.unsubscribe&&(()=>{pe.unsubscribe()});let Se;try{if(S&&p&&B!=="get"&&B!=="head"&&(Se=await I(se,E))!==0){let be=new o(b,{method:"POST",body:E,duplex:"half"}),Oe;if(ye.isFormData(E)&&(Oe=be.headers.get("content-type"))&&se.setContentType(Oe),be.body){const[ne,Ee]=Xd(Se,Yr(Qd(S)));E=th(be.body,nh,ne,Ee)}}ye.isString(ce)||(ce=ce?"include":"omit");const he=a&&"credentials"in o.prototype,Q={..._e,signal:pe,method:B.toUpperCase(),headers:se.normalize().toJSON(),body:E,duplex:"half",credentials:he?ce:void 0};Ie=a&&new o(b,Q);let X=await(a?ae(Ie,_e):ae(b,Q));const ue=f&&($==="stream"||$==="response");if(f&&(T||ue&&Be)){const be={};["status","statusText","headers"].forEach(xe=>{be[xe]=X[xe]});const Oe=ye.toFiniteNumber(X.headers.get("content-length")),[ne,Ee]=T&&Xd(Oe,Yr(Qd(T),!0))||[];X=new i(th(X.body,nh,ne,()=>{Ee&&Ee(),Be&&Be()}),be)}$=$||"text";let te=await y[ye.findKey(y,$)||"text"](X,M);return!ue&&Be&&Be(),await new Promise((be,Oe)=>{wp(be,Oe,{data:te,headers:Sn.from(X.headers),status:X.status,statusText:X.statusText,config:M,request:Ie})})}catch(he){throw Be&&Be(),he&&he.name==="TypeError"&&/Load failed|fetch/i.test(he.message)?Object.assign(new ft("Network Error",ft.ERR_NETWORK,M,Ie),{cause:he.cause||he}):ft.from(he,he&&he.code,M,Ie)}}},H1=new Map,Sp=e=>{let t=e&&e.env||{};const{fetch:o,Request:i,Response:s}=t,a=[i,s,o];let l=a.length,u=l,h,p,f=H1;for(;u--;)h=a[u],p=f.get(h),p===void 0&&f.set(h,p=u?new Map:z1(t)),f=p;return p};Sp();const hu={http:i1,xhr:O1,fetch:{get:Sp}};ye.forEach(hu,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const ah=e=>`- ${e}`,V1=e=>ye.isFunction(e)||e===null||e===!1;function G1(e,t){e=ye.isArray(e)?e:[e];const{length:o}=e;let i,s;const a={};for(let l=0;l<o;l++){i=e[l];let u;if(s=i,!V1(i)&&(s=hu[(u=String(i)).toLowerCase()],s===void 0))throw new ft(`Unknown adapter '${u}'`);if(s&&(ye.isFunction(s)||(s=s.get(t))))break;a[u||"#"+l]=s}if(!s){const l=Object.entries(a).map(([h,p])=>`adapter ${h} `+(p===!1?"is not supported by the environment":"is not available in the build"));let u=o?l.length>1?`since :
`+l.map(ah).join(`
`):" "+ah(l[0]):"as no adapter specified";throw new ft("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return s}const xp={getAdapter:G1,adapters:hu};function rc(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Hi(null,e)}function rh(e){return rc(e),e.headers=Sn.from(e.headers),e.data=ac.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),xp.getAdapter(e.adapter||Za.adapter,e)(e).then(function(i){return rc(e),i.data=ac.call(e,e.transformResponse,i),i.headers=Sn.from(i.headers),i},function(i){return bp(i)||(rc(e),i&&i.response&&(i.response.data=ac.call(e,e.transformResponse,i.response),i.response.headers=Sn.from(i.response.headers))),Promise.reject(i)})}const Tp="1.13.2",Cl={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Cl[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});const lh={};Cl.transitional=function(t,o,i){function s(a,l){return"[Axios v"+Tp+"] Transitional option '"+a+"'"+l+(i?". "+i:"")}return(a,l,u)=>{if(t===!1)throw new ft(s(l," has been removed"+(o?" in "+o:"")),ft.ERR_DEPRECATED);return o&&!lh[l]&&(lh[l]=!0,console.warn(s(l," has been deprecated since v"+o+" and will be removed in the near future"))),t?t(a,l,u):!0}};Cl.spelling=function(t){return(o,i)=>(console.warn(`${i} is likely a misspelling of ${t}`),!0)};function Z1(e,t,o){if(typeof e!="object")throw new ft("options must be an object",ft.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let s=i.length;for(;s-- >0;){const a=i[s],l=t[a];if(l){const u=e[a],h=u===void 0||l(u,a,e);if(h!==!0)throw new ft("option "+a+" must be "+h,ft.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new ft("Unknown option "+a,ft.ERR_BAD_OPTION)}}const Fr={assertOptions:Z1,validators:Cl},bo=Fr.validators;let si=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Yd,response:new Yd}}async request(t,o){try{return await this._request(t,o)}catch(i){if(i instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{i.stack?a&&!String(i.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+a):i.stack=a}catch{}}throw i}}_request(t,o){typeof t=="string"?(o=o||{},o.url=t):o=t||{},o=ri(this.defaults,o);const{transitional:i,paramsSerializer:s,headers:a}=o;i!==void 0&&Fr.assertOptions(i,{silentJSONParsing:bo.transitional(bo.boolean),forcedJSONParsing:bo.transitional(bo.boolean),clarifyTimeoutError:bo.transitional(bo.boolean)},!1),s!=null&&(ye.isFunction(s)?o.paramsSerializer={serialize:s}:Fr.assertOptions(s,{encode:bo.function,serialize:bo.function},!0)),o.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?o.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:o.allowAbsoluteUrls=!0),Fr.assertOptions(o,{baseUrl:bo.spelling("baseURL"),withXsrfToken:bo.spelling("withXSRFToken")},!0),o.method=(o.method||this.defaults.method||"get").toLowerCase();let l=a&&ye.merge(a.common,a[o.method]);a&&ye.forEach(["delete","get","head","post","put","patch","common"],M=>{delete a[M]}),o.headers=Sn.concat(l,a);const u=[];let h=!0;this.interceptors.request.forEach(function(b){typeof b.runWhen=="function"&&b.runWhen(o)===!1||(h=h&&b.synchronous,u.unshift(b.fulfilled,b.rejected))});const p=[];this.interceptors.response.forEach(function(b){p.push(b.fulfilled,b.rejected)});let f,y=0,k;if(!h){const M=[rh.bind(this),void 0];for(M.unshift(...u),M.push(...p),k=M.length,f=Promise.resolve(o);y<k;)f=f.then(M[y++],M[y++]);return f}k=u.length;let I=o;for(;y<k;){const M=u[y++],b=u[y++];try{I=M(I)}catch(B){b.call(this,B);break}}try{f=rh.call(this,I)}catch(M){return Promise.reject(M)}for(y=0,k=p.length;y<k;)f=f.then(p[y++],p[y++]);return f}getUri(t){t=ri(this.defaults,t);const o=Cp(t.baseURL,t.url,t.allowAbsoluteUrls);return yp(o,t.params,t.paramsSerializer)}};ye.forEach(["delete","get","head","options"],function(t){si.prototype[t]=function(o,i){return this.request(ri(i||{},{method:t,url:o,data:(i||{}).data}))}});ye.forEach(["post","put","patch"],function(t){function o(i){return function(a,l,u){return this.request(ri(u||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}si.prototype[t]=o(),si.prototype[t+"Form"]=o(!0)});let j1=class Ip{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(a){o=a});const i=this;this.promise.then(s=>{if(!i._listeners)return;let a=i._listeners.length;for(;a-- >0;)i._listeners[a](s);i._listeners=null}),this.promise.then=s=>{let a;const l=new Promise(u=>{i.subscribe(u),a=u}).then(s);return l.cancel=function(){i.unsubscribe(a)},l},t(function(a,l,u){i.reason||(i.reason=new Hi(a,l,u),o(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const o=this._listeners.indexOf(t);o!==-1&&this._listeners.splice(o,1)}toAbortSignal(){const t=new AbortController,o=i=>{t.abort(i)};return this.subscribe(o),t.signal.unsubscribe=()=>this.unsubscribe(o),t.signal}static source(){let t;return{token:new Ip(function(s){t=s}),cancel:t}}};function W1(e){return function(o){return e.apply(null,o)}}function q1(e){return ye.isObject(e)&&e.isAxiosError===!0}const Ec={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Ec).forEach(([e,t])=>{Ec[t]=e});function $p(e){const t=new si(e),o=ap(si.prototype.request,t);return ye.extend(o,si.prototype,t,{allOwnKeys:!0}),ye.extend(o,t,null,{allOwnKeys:!0}),o.create=function(s){return $p(ri(e,s))},o}const zt=$p(Za);zt.Axios=si;zt.CanceledError=Hi;zt.CancelToken=j1;zt.isCancel=bp;zt.VERSION=Tp;zt.toFormData=wl;zt.AxiosError=ft;zt.Cancel=zt.CanceledError;zt.all=function(t){return Promise.all(t)};zt.spread=W1;zt.isAxiosError=q1;zt.mergeConfig=ri;zt.AxiosHeaders=Sn;zt.formToJSON=e=>kp(ye.isHTMLForm(e)?new FormData(e):e);zt.getAdapter=xp.getAdapter;zt.HttpStatusCode=Ec;zt.default=zt;const{Axios:C8,AxiosError:L8,CanceledError:S8,isCancel:x8,CancelToken:T8,VERSION:I8,all:$8,Cancel:M8,isAxiosError:A8,spread:E8,toFormData:P8,AxiosHeaders:D8,HttpStatusCode:O8,formToJSON:R8,getAdapter:B8,mergeConfig:N8}=zt,K1="https://sterobson-volunteercheckin-testing.azurewebsites.net/api",Y1="VolunteerCheckinOffline",J1=1;let ro=null;async function ss(){return ro||new Promise((e,t)=>{const o=indexedDB.open(Y1,J1);o.onerror=()=>{console.error("Failed to open IndexedDB:",o.error),t(o.error)},o.onsuccess=()=>{ro=o.result,e(ro)},o.onupgradeneeded=i=>{const s=i.target.result;s.objectStoreNames.contains("eventData")||s.createObjectStore("eventData",{keyPath:"eventId"}),s.objectStoreNames.contains("pendingActions")||s.createObjectStore("pendingActions",{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),s.objectStoreNames.contains("syncMeta")||s.createObjectStore("syncMeta",{keyPath:"key"})}})}async function Oa(e,t){return await ss(),new Promise((o,i)=>{const s=ro.transaction(["eventData","syncMeta"],"readwrite"),a=s.objectStore("eventData"),l=s.objectStore("syncMeta"),u={eventId:e,...t,cachedAt:new Date().toISOString()};a.put(u),l.put({key:`lastSync_${e}`,value:new Date().toISOString()}),s.oncomplete=()=>o(),s.onerror=()=>i(s.error)})}async function Is(e){return await ss(),new Promise((t,o)=>{const a=ro.transaction(["eventData"],"readonly").objectStore("eventData").get(e);a.onsuccess=()=>t(a.result||null),a.onerror=()=>o(a.error)})}async function fa(e,t,o){const i=await Is(e);i&&(i[t]=o,i.cachedAt=new Date().toISOString(),await Oa(e,i))}async function X1(e){return await ss(),new Promise((t,o)=>{const s=ro.transaction(["pendingActions"],"readwrite").objectStore("pendingActions"),a={...e,createdAt:new Date().toISOString(),attempts:0,lastAttempt:null,status:"pending"},l=s.add(a);l.onsuccess=()=>t(l.result),l.onerror=()=>o(l.error)})}async function Mp(){return await ss(),new Promise((e,t)=>{const a=ro.transaction(["pendingActions"],"readonly").objectStore("pendingActions").index("createdAt").getAll();a.onsuccess=()=>{const l=a.result.filter(u=>u.status==="pending"||u.status==="retrying");e(l)},a.onerror=()=>t(a.error)})}async function Jr(){return(await Mp()).length}async function ch(e,t){return await ss(),new Promise((o,i)=>{const s=ro.transaction(["pendingActions"],"readwrite"),a=s.objectStore("pendingActions"),l=a.get(e);l.onsuccess=()=>{const u=l.result;u&&(Object.assign(u,t),a.put(u))},s.oncomplete=()=>o(),s.onerror=()=>i(s.error)})}async function uh(e){return await ss(),new Promise((t,o)=>{const a=ro.transaction(["pendingActions"],"readwrite").objectStore("pendingActions").delete(e);a.onsuccess=()=>t(),a.onerror=()=>o(a.error)})}async function Q1(e){return await ss(),new Promise((t,o)=>{const a=ro.transaction(["syncMeta"],"readonly").objectStore("syncMeta").get(`lastSync_${e}`);a.onsuccess=()=>t(a.result?.value||null),a.onerror=()=>o(a.error)})}const He=zt.create({baseURL:K1,headers:{"Content-Type":"application/json"},timeout:15e3});let Pc=!1;async function ek(){}function dh(e){const t=[/\/events\/([^/]+)/,/\/assignments\/([^/]+)/,/\/locations\/([^/]+)/,/\/checklist-items\/([^/]+)/,/\/areas\/([^/]+)/,/\/marshals\/([^/]+)/];for(const o of t){const i=e.match(o);if(i)return i[1]}return null}function tk(e){return!!(!e.response&&e.request||e.response&&e.response.status>=500||e.code==="ECONNABORTED")}He.interceptors.request.use(e=>{const t=localStorage.getItem("adminEmail");t&&(e.headers["X-Admin-Email"]=t);const o=localStorage.getItem("sessionToken");return o&&(e.headers.Authorization=`Bearer ${o}`),e});let Dc=0;const nk=2;function ok(){if(Dc++,Dc>=nk){localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken");const e=window.location.hash||"";!e.includes("/login")&&!e.includes("/verify")&&(window.location.href="/VolunteerCheckin/testing/#/admin/login")}}function sk(){Dc=0}He.interceptors.response.use(e=>{Pc=!1,sk();const t=e.config.url,o=dh(t);return e.config.method,e},async e=>{const t=e.config;if(e.response&&(e.response.status===401||e.response.status===403))return ok(),Promise.reject(e);if(tk(e)&&(Pc=!0,t.method==="get")){const o=dh(t.url);if(o){const i=await Is(o);if(i)return console.log("Returning cached data for:",t.url),Promise.resolve({data:i,status:200,statusText:"OK (cached)",headers:{},config:t,cached:!0})}}return Promise.reject(e)});async function En(e,t,o){return await X1({type:e,payload:t,eventId:t.eventId}),await ek(),{data:o,status:200,statusText:"OK (queued)",queued:!0}}function on(){return Pc||!navigator.onLine}const ik={check:()=>He.head("/health")},Lo={requestLogin:e=>He.post("/auth/request-login",{email:e}),verifyToken:e=>He.post("/auth/verify-token",{token:e}),instantLogin:e=>He.post("/auth/instant-login",{email:e}),createAdmin:e=>He.post("/auth/create-admin",{email:e}),marshalLogin:(e,t)=>He.post("/auth/marshal-login",{eventId:e,magicCode:t}),getMe:e=>He.get("/auth/me",{params:{eventId:e}}),logout:()=>He.post("/auth/logout")},Tr={getProfile:()=>He.get("/auth/profile"),updateProfile:e=>He.put("/auth/profile",e),getPerson:(e,t)=>He.get(`/people/${e}`,{params:{eventId:t}}),updatePerson:(e,t,o)=>He.put(`/people/${e}`,o,{params:{eventId:t}})},Ks={create:e=>He.post("/events",e),getAll:()=>He.get("/events"),getById:e=>He.get(`/events/${e}`),update:(e,t)=>He.put(`/events/${e}`,t),delete:e=>He.delete(`/events/${e}`),uploadGpx:(e,t)=>{const o=new FormData;return o.append("gpx",t),He.post(`/events/${e}/upload-gpx`,o,{headers:{"Content-Type":"multipart/form-data"}})}},wn={create:e=>He.post("/locations",e),getById:(e,t)=>He.get(`/locations/${e}/${t}`),getByEvent:e=>He.get(`/events/${e}/locations`),update:(e,t,o)=>He.put(`/locations/${e}/${t}`,o),delete:(e,t)=>He.delete(`/locations/${e}/${t}`),importCsv:(e,t,o)=>{const i=new FormData;return i.append("csv",t),He.post(`/locations/import/${e}?deleteExisting=${o}`,i,{headers:{"Content-Type":"multipart/form-data"}})},bulkUpdateTimes:(e,t)=>He.post(`/locations/bulk-update-times/${e}`,{timeDelta:t}),updatePosition:(e,t,o)=>He.post(`/locations/${e}/${t}/update-position`,o),getDynamicCheckpoints:e=>He.get(`/events/${e}/dynamic-checkpoints`)},pa={create:e=>He.post("/assignments",e),getById:(e,t)=>He.get(`/assignments/${e}/${t}`),getByEvent:e=>He.get(`/assignments/event/${e}`),delete:(e,t)=>He.delete(`/assignments/${e}/${t}`),getEventStatus:e=>He.get(`/events/${e}/status`)},Yo={checkIn:e=>He.post("/checkin",e),adminCheckIn:(e,t)=>He.post(`/checkin/admin/${e}/${t}`)},lc={getAdmins:e=>He.get(`/events/${e}/admins`),addAdmin:(e,t)=>He.post(`/events/${e}/admins`,{userEmail:t}),removeAdmin:(e,t)=>He.delete(`/events/${e}/admins/${t}`)},So={create:e=>He.post("/marshals",e),getByEvent:e=>He.get(`/events/${e}/marshals`),getById:(e,t)=>He.get(`/marshals/${e}/${t}`),update:(e,t,o)=>He.put(`/marshals/${e}/${t}`,o),delete:(e,t)=>He.delete(`/marshals/${e}/${t}`),getMagicLink:(e,t)=>He.get(`/marshals/${e}/${t}/magic-link`),sendMagicLink:(e,t)=>He.post(`/marshals/${e}/${t}/send-magic-link`),importCsv:(e,t)=>{const o=new FormData;return o.append("csv",t),He.post(`/marshals/import/${e}`,o,{headers:{"Content-Type":"multipart/form-data"}})}},Ss={create:e=>He.post("/areas",e),getByEvent:e=>He.get(`/events/${e}/areas`),getById:(e,t)=>He.get(`/areas/${e}/${t}`),update:(e,t,o)=>He.put(`/areas/${e}/${t}`,o),delete:(e,t)=>He.delete(`/areas/${e}/${t}`),recalculate:e=>He.post(`/areas/recalculate/${e}`),getCheckpoints:(e,t)=>He.get(`/areas/${e}/${t}/locations`),getAreaLeadDashboard:e=>He.get(`/events/${e}/area-lead-dashboard`)},Pt={create:(e,t)=>He.post(`/events/${e}/checklist-items`,t),getByEvent:e=>He.get(`/events/${e}/checklist-items`),getById:(e,t)=>He.get(`/checklist-items/${e}/${t}`),update:(e,t,o)=>He.put(`/checklist-items/${e}/${t}`,o),delete:(e,t)=>He.delete(`/checklist-items/${e}/${t}`),getReport:e=>He.get(`/events/${e}/checklist-report`),getMarshalChecklist:(e,t)=>He.get(`/events/${e}/marshals/${t}/checklist`),getCheckpointChecklist:(e,t)=>He.get(`/events/${e}/locations/${t}/checklist`),getAreaChecklist:(e,t)=>He.get(`/events/${e}/areas/${t}/checklist`),complete:(e,t,o)=>He.post(`/checklist-items/${e}/${t}/complete`,o),uncomplete:(e,t,o)=>He.post(`/checklist-items/${e}/${t}/uncomplete`,o)},Zo={create:(e,t)=>He.post(`/events/${e}/notes`,t),getByEvent:e=>He.get(`/events/${e}/notes`),getById:(e,t)=>He.get(`/events/${e}/notes/${t}`),update:(e,t,o)=>He.put(`/events/${e}/notes/${t}`,o),delete:(e,t)=>He.delete(`/events/${e}/notes/${t}`),getMarshalNotes:(e,t)=>He.get(`/events/${e}/marshals/${t}/notes`),getMyNotes:e=>He.get(`/events/${e}/my-notes`)},Ti={create:(e,t)=>He.post(`/events/${e}/contacts`,t),getByEvent:e=>He.get(`/events/${e}/contacts`),getById:(e,t)=>He.get(`/events/${e}/contacts/${t}`),update:(e,t,o)=>He.put(`/events/${e}/contacts/${t}`,o),delete:(e,t)=>He.delete(`/events/${e}/contacts/${t}`),getRoles:e=>He.get(`/events/${e}/contact-roles`),getMarshalContacts:(e,t)=>He.get(`/events/${e}/marshals/${t}/contacts`),getMyContacts:e=>He.get(`/events/${e}/my-contacts`)},ja=iu("auth",()=>{const e=P(localStorage.getItem("adminEmail")||null),t=P(!!e.value),o=P(!1);return{adminEmail:e,isAuthenticated:t,loginPending:o,requestLogin:async u=>{const h=await Lo.requestLogin(u);return h.data.success&&(o.value=!0),h.data},verifyToken:async u=>{const h=await Lo.verifyToken(u);return h.data.success&&(e.value=h.data.person?.email,t.value=!0,o.value=!1,localStorage.setItem("adminEmail",h.data.person?.email),localStorage.setItem("sessionToken",h.data.sessionToken)),h.data},instantLogin:async u=>{const h=await Lo.instantLogin(u);return h.data.success&&(e.value=h.data.email,t.value=!0,localStorage.setItem("adminEmail",h.data.email),h.data.sessionToken&&localStorage.setItem("sessionToken",h.data.sessionToken)),h.data},logout:async()=>{try{await Lo.logout()}catch{}e.value=null,t.value=!1,o.value=!1,localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken")}}}),ak={class:"admin-login"},rk={class:"login-card"},lk={key:0,class:"email-sent"},ck={class:"form-group"},uk=["disabled"],dk={key:0,class:"error"},hk={__name:"AdminLogin",setup(e){const t=ja(),o=P(""),i=P(!1),s=P(null),a=P(!1),l=async()=>{i.value=!0,s.value=null;try{const h=await t.requestLogin(o.value);h.success?a.value=!0:s.value=h.message||"Failed to send login link. Please try again."}catch{s.value="Failed to send login link. Please try again."}finally{i.value=!1}},u=()=>{o.value="",a.value=!1,s.value=null};return(h,p)=>{const f=hl("router-link");return m(),g("div",ak,[c("div",rk,[p[7]||(p[7]=c("h2",null,"Admin login",-1)),a.value?(m(),g("div",lk,[p[2]||(p[2]=c("div",{class:"check-icon"},"",-1)),p[3]||(p[3]=c("h3",null,"Check your email!",-1)),c("p",null,[p[1]||(p[1]=Ze("We've sent a login link to ",-1)),c("strong",null,_(o.value),1)]),p[4]||(p[4]=c("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),c("button",{onClick:u,class:"btn btn-secondary"}," Use a different email ")])):(m(),g(Ce,{key:1},[p[5]||(p[5]=c("p",{class:"instruction"},"Enter your email to receive a login link",-1)),c("form",{onSubmit:vt(l,["prevent"])},[c("div",ck,[je(c("input",{"onUpdate:modelValue":p[0]||(p[0]=y=>o.value=y),type:"email",placeholder:"admin@example.com",required:"",class:"form-input"},null,512),[[ht,o.value]])]),c("button",{type:"submit",class:"btn btn-primary",disabled:i.value},_(i.value?"Sending...":"Send login link"),9,uk)],32),s.value?(m(),g("div",dk,_(s.value),1)):R("",!0)],64)),ze(f,{to:"/",class:"back-link"},{default:et(()=>[...p[6]||(p[6]=[Ze(" Back to Home",-1)])]),_:1})])])}}},fk=Ye(hk,[["__scopeId","data-v-1eafb4d9"]]),pk={class:"admin-verify"},vk={class:"verify-card"},mk={key:0,class:"status"},gk={key:1,class:"status error"},yk={key:2,class:"status success"},_k={__name:"AdminVerify",setup(e){const t=za(),o=lu(),i=ja(),s=P(!0),a=P(null);return Qt(async()=>{const l=o.query.token;if(!l){a.value="No login token provided. Please request a new login link.",s.value=!1;return}try{const u=await i.verifyToken(l);u.success?setTimeout(()=>{t.push({name:"AdminDashboard"})},1e3):a.value=u.message||"Invalid or expired login link. Please request a new one."}catch(u){console.error("Verification error:",u),a.value="Failed to verify login. Please try again."}finally{s.value=!1}}),(l,u)=>{const h=hl("router-link");return m(),g("div",pk,[c("div",vk,[s.value?(m(),g("div",mk,[...u[0]||(u[0]=[c("div",{class:"spinner"},null,-1),c("h2",null,"Verifying your login...",-1),c("p",null,"Please wait while we confirm your identity.",-1)])])):a.value?(m(),g("div",gk,[u[2]||(u[2]=c("h2",null,"Login failed",-1)),c("p",null,_(a.value),1),ze(h,{to:"/admin/login",class:"btn btn-primary"},{default:et(()=>[...u[1]||(u[1]=[Ze(" Try again ",-1)])]),_:1})])):(m(),g("div",yk,[...u[3]||(u[3]=[c("h2",null,"Login successful!",-1),c("p",null,"Redirecting to dashboard...",-1)])]))])])}}},kk=Ye(_k,[["__scopeId","data-v-5012f94a"]]),Ap=iu("events",()=>{const e=P([]),t=P(null),o=P([]),i=P([]),s=P(null),a=P(!1),l=P(null),u=async()=>{a.value=!0,l.value=null;try{const S=await Ks.getAll();e.value=S.data}catch(S){throw l.value=S.message,S}finally{a.value=!1}},h=async S=>{a.value=!0,l.value=null;try{const $=await Ks.getById(S);t.value=$.data}catch($){throw l.value=$.message,$}finally{a.value=!1}},p=async S=>{a.value=!0,l.value=null;try{const $=await Ks.create(S);return e.value.push($.data),$.data}catch($){throw l.value=$.message,$}finally{a.value=!1}},f=async(S,$)=>{a.value=!0,l.value=null;try{const se=await Ks.update(S,$),ce=e.value.findIndex(_e=>_e.id===S);return ce!==-1&&(e.value[ce]=se.data),t.value?.id===S&&(t.value=se.data),se.data}catch(se){throw l.value=se.message,se}finally{a.value=!1}},y=async S=>{a.value=!0,l.value=null;try{await Ks.delete(S),e.value=e.value.filter($=>$.id!==S)}catch($){throw l.value=$.message,$}finally{a.value=!1}},k=async S=>{a.value=!0,l.value=null;try{const $=await wn.getByEvent(S);o.value=$.data}catch($){throw l.value=$.message,$}finally{a.value=!1}};return{events:e,currentEvent:t,locations:o,assignments:i,eventStatus:s,loading:a,error:l,fetchEvents:u,fetchEvent:h,createEvent:p,updateEvent:f,deleteEvent:y,fetchLocations:k,createLocation:async S=>{a.value=!0,l.value=null;try{const $=await wn.create(S);return o.value.push($.data),$.data}catch($){throw l.value=$.message,$}finally{a.value=!1}},updateLocation:async(S,$,se)=>{a.value=!0,l.value=null;try{const ce=await wn.update(S,$,se),_e=o.value.findIndex(ae=>ae.id===$);return _e!==-1&&(o.value[_e]=ce.data),ce.data}catch(ce){throw l.value=ce.message,ce}finally{a.value=!1}},deleteLocation:async(S,$)=>{a.value=!0,l.value=null;try{await wn.delete(S,$),o.value=o.value.filter(se=>se.id!==$)}catch(se){throw l.value=se.message,se}finally{a.value=!1}},bulkUpdateLocationTimes:async(S,$)=>{a.value=!0,l.value=null;try{const se=await wn.bulkUpdateTimes(S,$);return await k(S),se.data}catch(se){throw l.value=se.message,se}finally{a.value=!1}},fetchAssignments:async S=>{a.value=!0,l.value=null;try{const $=await pa.getByEvent(S);i.value=$.data}catch($){throw l.value=$.message,$}finally{a.value=!1}},createAssignment:async S=>{a.value=!0,l.value=null;try{const $=await pa.create(S);return i.value.push($.data),$.data}catch($){throw l.value=$.message,$}finally{a.value=!1}},deleteAssignment:async(S,$)=>{a.value=!0,l.value=null;try{await pa.delete(S,$),i.value=i.value.filter(se=>se.id!==$)}catch(se){throw l.value=se.message,se}finally{a.value=!1}},fetchEventStatus:async S=>{a.value=!0,l.value=null;try{const $=await pa.getEventStatus(S);return s.value=$.data,$.data}catch($){throw l.value=$.message,$}finally{a.value=!1}},updateAssignmentCheckIn:S=>{const $=i.value.findIndex(se=>se.id===S.id);$!==-1&&(i.value[$]=S),s.value&&s.value.locations.forEach(se=>{const ce=se.assignments.findIndex(_e=>_e.id===S.id);ce!==-1&&(se.assignments[ce]=S,se.checkedInCount=se.assignments.filter(_e=>_e.isCheckedIn).length)})}}}),bk={class:"confirm-modal"},wk={class:"confirm-actions"},Ck={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"}},emits:["confirm","cancel"],setup(e,{emit:t}){const o=t,i=()=>{o("confirm")},s=()=>{o("cancel")};return(a,l)=>e.show?(m(),g("div",{key:0,class:"modal-overlay",onClick:vt(s,["self"])},[c("div",bk,[c("h3",null,_(e.title),1),c("p",null,_(e.message),1),c("div",wk,[c("button",{onClick:s,class:"btn btn-secondary"},_(e.cancelText),1),c("button",{onClick:i,class:"btn btn-primary"},_(e.confirmText),1)])])])):R("",!0)}},Ll=Ye(Ck,[["__scopeId","data-v-87d61c7a"]]),Lk={class:"base-modal-header"},Sk={key:0,class:"base-modal-title"},xk={key:0,class:"base-modal-tab-header"},Tk={class:"base-modal-body"},Ik={key:1,class:"base-modal-footer"},$k={key:0,class:"base-modal-actions"},Mk={__name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},variant:{type:String,default:"center",validator:e=>["center","sidebar"].includes(e)},zIndex:{type:Number,default:1e3},closeOnOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},confirmOnClose:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=e,i=t,s=P(!1),a=P(!1),l=()=>{o.closeOnOverlay&&u()},u=()=>{o.confirmOnClose&&o.isDirty?s.value=!0:i("close")},h=()=>{s.value=!1,i("close")},p=()=>{s.value=!1};return(f,y)=>e.show?(m(),g("div",{key:0,class:"base-modal-overlay",style:st({zIndex:e.zIndex}),onClick:vt(l,["self"])},[c("div",{class:Te(["base-modal",[`base-modal--${e.size}`,`base-modal--${e.variant}`]])},[c("div",Lk,[ra(f.$slots,"header",{},()=>[e.title?(m(),g("h2",Sk,_(e.title),1)):R("",!0)]),e.showCloseButton?(m(),g("button",{key:0,onClick:u,class:"base-modal-close",type:"button","aria-label":"Close"},"  ")):R("",!0)]),f.$slots["tab-header"]?(m(),g("div",xk,[ra(f.$slots,"tab-header",{},void 0)])):R("",!0),c("div",Tk,[ra(f.$slots,"default",{},void 0)]),f.$slots.footer||f.$slots.actions?(m(),g("div",Ik,[ra(f.$slots,"footer",{},()=>[f.$slots.actions?(m(),g("div",$k,[ra(f.$slots,"actions",{},void 0,!0)])):R("",!0)])])):R("",!0)],2),e.confirmOnClose&&!a.value?(m(),ct(Ll,{key:0,show:s.value,title:"Unsaved changes",message:"You have unsaved changes. Are you sure you want to close?",onConfirm:h,onCancel:p},null,8,["show"])):R("",!0)],4)):R("",!0)}},Ht=Ye(Mk,[["__scopeId","data-v-2b6c2aa3"]]);function Ep(e="details",t=[]){const o=P(e),i=y=>{o.value=y},s=()=>{o.value=e},a=y=>o.value===y,l=J(()=>t.length===0?-1:t.indexOf(o.value)),u=(y=!1)=>{if(t.length===0)return;const k=l.value;if(k===-1)return;const I=k+1;I<t.length?o.value=t[I]:y&&(o.value=t[0])},h=(y=!1)=>{if(t.length===0)return;const k=l.value;if(k===-1)return;const I=k-1;I>=0?o.value=t[I]:y&&(o.value=t[t.length-1])},p=J(()=>{if(t.length===0)return!1;const y=l.value;return y!==-1&&y<t.length-1}),f=J(()=>t.length===0?!1:l.value>0);return{activeTab:o,activeTabIndex:l,hasNextTab:p,hasPreviousTab:f,switchTab:i,resetTab:s,isActiveTab:a,nextTab:u,previousTab:h}}const Pp=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET/CEST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Australia/Sydney",label:"Sydney (AEDT/AEST)"}],Ak={class:"tabs"},Ek={class:"tab-content"},Pk={class:"form-group"},Dk={class:"form-group"},Ok={class:"form-group"},Rk={class:"form-group"},Bk=["value"],Nk={class:"tab-content"},Fk={class:"emergency-contacts-section"},Uk={key:0,class:"empty-state"},zk={class:"card-header"},Hk=["onClick"],Vk={class:"form-group"},Gk=["onUpdate:modelValue"],Zk={class:"form-group"},jk=["onUpdate:modelValue"],Wk={class:"form-group"},qk=["onUpdate:modelValue"],Kk={__name:"EventFormModal",props:{show:{type:Boolean,default:!1},eventData:{type:Object,default:()=>({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]})},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const o=e,i=t,{activeTab:s,switchTab:a,resetTab:l}=Ep("basic",["basic","emergency"]),u=P({...o.eventData});qe(()=>o.eventData,k=>{u.value={...k},u.value.emergencyContacts||(u.value.emergencyContacts=[])},{deep:!0}),qe(()=>o.show,k=>{k&&l()});const h=()=>{u.value.emergencyContacts.push({name:"",phone:"",details:""})},p=k=>{u.value.emergencyContacts.splice(k,1)},f=()=>{i("submit",{...u.value})},y=()=>{i("close")};return(k,I)=>(m(),ct(Ht,{show:e.show,title:e.isEditing?"Edit event":"Create new event",size:"large",onClose:y},{"tab-header":et(()=>[c("div",Ak,[c("button",{type:"button",onClick:I[0]||(I[0]=M=>z(a)("basic")),class:Te(["tab-button",{active:z(s)==="basic"}])}," Basic details ",2),c("button",{type:"button",onClick:I[1]||(I[1]=M=>z(a)("emergency")),class:Te(["tab-button",{active:z(s)==="emergency"}])}," Emergency contacts ",2)])]),actions:et(()=>[c("button",{type:"button",onClick:y,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:f,class:"btn btn-primary"},_(e.isEditing?"Update":"Create"),1)]),default:et(()=>[c("form",{onSubmit:vt(f,["prevent"])},[je(c("div",Ek,[c("div",Pk,[I[6]||(I[6]=c("label",null,"Event name *",-1)),je(c("input",{"onUpdate:modelValue":I[2]||(I[2]=M=>u.value.name=M),type:"text",required:"",class:"form-input"},null,512),[[ht,u.value.name]])]),c("div",Dk,[I[7]||(I[7]=c("label",null,"Description",-1)),je(c("textarea",{"onUpdate:modelValue":I[3]||(I[3]=M=>u.value.description=M),rows:"3",class:"form-input"},null,512),[[ht,u.value.description]])]),c("div",Ok,[I[8]||(I[8]=c("label",null,"Event date *",-1)),je(c("input",{"onUpdate:modelValue":I[4]||(I[4]=M=>u.value.eventDate=M),type:"datetime-local",required:"",class:"form-input"},null,512),[[ht,u.value.eventDate]])]),c("div",Rk,[I[9]||(I[9]=c("label",null,"Time zone *",-1)),je(c("select",{"onUpdate:modelValue":I[5]||(I[5]=M=>u.value.timeZoneId=M),required:"",class:"form-input"},[(m(!0),g(Ce,null,Re(z(Pp),M=>(m(),g("option",{key:M.value,value:M.value},_(M.label),9,Bk))),128))],512),[[bn,u.value.timeZoneId]])])],512),[[Ms,z(s)==="basic"]]),je(c("div",Nk,[c("div",Fk,[c("div",{class:"section-header-small"},[I[10]||(I[10]=c("h3",null,"Emergency contacts",-1)),c("button",{type:"button",onClick:h,class:"btn btn-small btn-primary"}," + Add contact ")]),u.value.emergencyContacts.length===0?(m(),g("div",Uk,[...I[11]||(I[11]=[c("p",null,'No emergency contacts added yet. Click "Add contact" to add one.',-1)])])):R("",!0),(m(!0),g(Ce,null,Re(u.value.emergencyContacts,(M,b)=>(m(),g("div",{key:b,class:"emergency-contact-card"},[c("div",zk,[c("h4",null,"Contact "+_(b+1),1),c("button",{type:"button",onClick:B=>p(b),class:"btn-remove"},"  ",8,Hk)]),c("div",Vk,[I[12]||(I[12]=c("label",null,"Name *",-1)),je(c("input",{"onUpdate:modelValue":B=>M.name=B,type:"text",required:"",class:"form-input",placeholder:"Contact person name"},null,8,Gk),[[ht,M.name]])]),c("div",Zk,[I[13]||(I[13]=c("label",null,"Phone *",-1)),je(c("input",{"onUpdate:modelValue":B=>M.phone=B,type:"tel",required:"",class:"form-input",placeholder:"+1 (555) 123-4567"},null,8,jk),[[ht,M.phone]])]),c("div",Wk,[I[14]||(I[14]=c("label",null,"Additional details",-1)),je(c("textarea",{"onUpdate:modelValue":B=>M.details=B,rows:"2",class:"form-input",placeholder:"Role, availability, or other important information..."},null,8,qk),[[ht,M.details]])])]))),128))])],512),[[Ms,z(s)==="emergency"]])],32)]),_:1},8,["show","title"]))}},Yk=Ye(Kk,[["__scopeId","data-v-9d79dd39"]]),Dp="admin-theme-preference",js=P(Jk());function Jk(){return typeof window>"u"?"system":localStorage.getItem(Dp)||"system"}function Xk(e){localStorage.setItem(Dp,e)}function fu(){const e=J(()=>js.value==="system"?"light dark":js.value),t=s=>{js.value=s,Xk(s)},o=()=>{const s=["system","light","dark"],l=(s.indexOf(js.value)+1)%s.length;t(s[l])},i=J(()=>js.value==="dark"?!0:js.value==="light"?!1:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1);return{theme:js,colorScheme:e,isDark:i,setTheme:t,cycleTheme:o}}const Qk=["aria-expanded"],eb=["innerHTML"],tb={class:"theme-label"},nb={key:0,class:"dropdown-menu"},ob=["onClick"],sb=["innerHTML"],ib={__name:"ThemeToggle",setup(e){const{theme:t,setTheme:o}=fu(),i=P(!1),s=P(null),a={light:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
  </svg>`,dark:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
  </svg>`,system:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
    <line x1="8" y1="21" x2="16" y2="21"></line>
    <line x1="12" y1="17" x2="12" y2="21"></line>
  </svg>`},l=[{value:"system",label:"System",icon:a.system},{value:"light",label:"Light",icon:a.light},{value:"dark",label:"Dark",icon:a.dark}],u=J(()=>a[t.value]||a.system),h=J(()=>{const k=l.find(I=>I.value===t.value);return k?k.label:"System"}),p=()=>{i.value=!i.value},f=k=>{o(k),i.value=!1},y=k=>{s.value&&!s.value.contains(k.target)&&(i.value=!1)};return Qt(()=>{document.addEventListener("click",y)}),po(()=>{document.removeEventListener("click",y)}),(k,I)=>(m(),g("div",{class:"theme-dropdown",ref_key:"dropdownRef",ref:s},[c("button",{class:"theme-toggle-btn",onClick:p,type:"button","aria-expanded":i.value},[c("span",{class:"theme-icon",innerHTML:u.value},null,8,eb),c("span",tb,_(h.value),1),(m(),g("svg",{class:Te(["chevron",{open:i.value}]),width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[...I[0]||(I[0]=[c("polyline",{points:"6 9 12 15 18 9"},null,-1)])],2))],8,Qk),i.value?(m(),g("div",nb,[(m(),g(Ce,null,Re(l,M=>c("button",{key:M.value,class:Te(["dropdown-item",{active:z(t)===M.value}]),onClick:b=>f(M.value)},[c("span",{class:"option-icon",innerHTML:M.icon},null,8,sb),c("span",null,_(M.label),1)],10,ob)),64))])):R("",!0)],512))}},Op=Ye(ib,[["__scopeId","data-v-42a3ed0e"]]),ab={class:"header"},rb={class:"header-actions"},lb={class:"user-email"},cb={class:"container"},ub={class:"section"},db={class:"section-header"},hb={key:0,class:"loading"},fb={key:1,class:"empty"},pb={key:2,class:"events-grid"},vb=["onClick"],mb={class:"event-date"},gb={class:"event-desc"},yb={class:"event-actions"},_b=["onClick"],kb=["onClick"],bb={__name:"AdminDashboard",setup(e){const t=za(),{colorScheme:o}=fu(),i=ja(),s=Ap(),a=P(!0),l=P(!1),u=P(null),h=P({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}),p=P([]),f=P(!1),y=P(""),k=P(""),I=P(null),M=async()=>{a.value=!0;try{await s.fetchEvents(),p.value=s.events}catch(_e){console.error("Failed to load events:",_e)}finally{a.value=!1}},b=async _e=>{try{const ae={..._e,adminEmail:i.adminEmail};u.value?await s.updateEvent(u.value.id,ae):await s.createEvent(ae),p.value=s.events,x()}catch(ae){console.error("Failed to save event:",ae),alert("Failed to save event. Please try again.")}},B=_e=>{u.value=_e,h.value={name:_e.name,description:_e.description,eventDate:ce(_e.eventDate),timeZoneId:_e.timeZoneId||"UTC",emergencyContacts:_e.emergencyContacts?JSON.parse(JSON.stringify(_e.emergencyContacts)):[]}},E=async _e=>{y.value="Delete event",k.value=`Are you sure you want to delete "${_e.name}"?`,I.value=async()=>{try{await s.deleteEvent(_e.id),p.value=s.events}catch(ae){console.error("Failed to delete event:",ae),alert("Failed to delete event. Please try again.")}},f.value=!0},A=()=>{f.value=!1,I.value&&(I.value(),I.value=null)},C=()=>{f.value=!1,I.value=null},x=()=>{l.value=!1,u.value=null,h.value={name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}},T=_e=>{if(!_e){console.error("Cannot navigate to event: eventId is undefined");return}t.push({name:"AdminEventManage",params:{eventId:_e}})},S=()=>{t.push({name:"AdminProfile"})},$=()=>{i.logout(),t.push({name:"Home"})},se=_e=>new Date(_e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),ce=_e=>{const ae=new Date(_e),pe=ae.getFullYear(),Ie=String(ae.getMonth()+1).padStart(2,"0"),Be=String(ae.getDate()).padStart(2,"0"),Se=String(ae.getHours()).padStart(2,"0"),he=String(ae.getMinutes()).padStart(2,"0");return`${pe}-${Ie}-${Be}T${Se}:${he}`};return Qt(()=>{M()}),(_e,ae)=>(m(),g("div",{class:"admin-dashboard",style:st({colorScheme:z(o)})},[c("header",ab,[ae[1]||(ae[1]=c("h1",null,"Admin dashboard",-1)),c("div",rb,[ze(Op),c("span",lb,_(z(i).adminEmail),1),c("button",{onClick:S,class:"btn btn-secondary"},"Profile"),c("button",{onClick:$,class:"btn btn-secondary"},"Logout")])]),c("div",cb,[c("div",ub,[c("div",db,[ae[2]||(ae[2]=c("h2",null,"Your events",-1)),c("button",{onClick:ae[0]||(ae[0]=pe=>l.value=!0),class:"btn btn-primary"}," Create new event ")]),a.value?(m(),g("div",hb,"Loading events...")):p.value.length===0?(m(),g("div",fb,[...ae[3]||(ae[3]=[c("p",null,"No events yet. Create your first event to get started!",-1)])])):(m(),g("div",pb,[(m(!0),g(Ce,null,Re(p.value,pe=>(m(),g("div",{key:pe.id,class:"event-card",onClick:Ie=>T(pe.id)},[c("h3",null,_(pe.name),1),c("p",mb,_(se(pe.eventDate)),1),c("p",gb,_(pe.description),1),c("div",yb,[c("button",{onClick:vt(Ie=>B(pe),["stop"]),class:"btn btn-small btn-secondary"}," Edit ",8,_b),c("button",{onClick:vt(Ie=>E(pe),["stop"]),class:"btn btn-small btn-danger"}," Delete ",8,kb)])],8,vb))),128))]))])]),ze(Yk,{show:l.value||!!u.value,"event-data":h.value,"is-editing":!!u.value,onClose:x,onSubmit:b},null,8,["show","event-data","is-editing"]),ze(Ll,{show:f.value,title:y.value,message:k.value,onConfirm:A,onCancel:C},null,8,["show","title","message"])],4))}},wb=Ye(bb,[["__scopeId","data-v-07dbfcd8"]]),Cb=iu("profile",()=>{const e=P(null),t=P(!1),o=P(null);return{profile:e,loading:t,error:o,fetchProfile:async()=>{t.value=!0,o.value=null;try{const h=await Tr.getProfile();return e.value=h.data,h.data}catch(h){throw o.value=h.response?.data?.message||"Failed to load profile",h}finally{t.value=!1}},updateProfile:async h=>{t.value=!0,o.value=null;try{const p=await Tr.updateProfile(h);return e.value=p.data,p.data}catch(p){throw o.value=p.response?.data?.message||"Failed to update profile",p}finally{t.value=!1}},fetchPerson:async(h,p)=>{t.value=!0,o.value=null;try{return(await Tr.getPerson(h,p)).data}catch(f){throw o.value=f.response?.data?.message||"Failed to load person",f}finally{t.value=!1}},updatePerson:async(h,p,f)=>{t.value=!0,o.value=null;try{return(await Tr.updatePerson(h,p,f)).data}catch(y){throw o.value=y.response?.data?.message||"Failed to update person",y}finally{t.value=!1}},clearProfile:()=>{e.value=null,o.value=null}}}),Lb={class:"form-group"},Sb={class:"form-group"},xb={class:"form-group"},Tb={__name:"EditProfileModal",props:{show:{type:Boolean,default:!1},profile:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=P({name:"",email:"",phone:""});qe(()=>o.profile,h=>{h&&(s.value={name:h.name||"",email:h.email||"",phone:h.phone||""})},{immediate:!0,deep:!0}),qe(()=>o.show,h=>{h&&o.profile&&(s.value={name:o.profile.name||"",email:o.profile.email||"",phone:o.profile.phone||""})});const a=()=>{i("update:isDirty",!0)},l=()=>{if(!s.value.name.trim()){alert("Name is required");return}if(!s.value.email.trim()){alert("Email is required");return}i("submit",{name:s.value.name.trim(),email:s.value.email.trim(),phone:s.value.phone?.trim()||""})},u=()=>{i("close")};return(h,p)=>(m(),ct(Ht,{show:e.show,title:"Edit profile",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:et(()=>[c("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:l,class:"btn btn-primary"}," Save changes ")]),default:et(()=>[c("form",{onSubmit:vt(l,["prevent"])},[c("div",Lb,[p[3]||(p[3]=c("label",null,"Name *",-1)),je(c("input",{"onUpdate:modelValue":p[0]||(p[0]=f=>s.value.name=f),type:"text",required:"",class:"form-input",placeholder:"Your name",onInput:a},null,544),[[ht,s.value.name]])]),c("div",Sb,[p[4]||(p[4]=c("label",null,"Email *",-1)),je(c("input",{"onUpdate:modelValue":p[1]||(p[1]=f=>s.value.email=f),type:"email",required:"",class:"form-input",placeholder:"Your email address",onInput:a},null,544),[[ht,s.value.email]])]),c("div",xb,[p[5]||(p[5]=c("label",null,"Phone",-1)),je(c("input",{"onUpdate:modelValue":p[2]||(p[2]=f=>s.value.phone=f),type:"tel",class:"form-input",placeholder:"Your phone number",onInput:a},null,544),[[ht,s.value.phone]])])],32)]),_:1},8,["show","is-dirty"]))}},Ib=Ye(Tb,[["__scopeId","data-v-9a8cb8be"]]),$b={class:"admin-profile"},Mb={class:"header"},Ab={class:"header-actions"},Eb={class:"user-email"},Pb={class:"container"},Db={class:"section"},Ob={class:"section-header"},Rb={key:0,class:"loading"},Bb={key:1,class:"error"},Nb={key:2,class:"profile-details"},Fb={class:"profile-field"},Ub={class:"field-value"},zb={class:"profile-field"},Hb={class:"field-value"},Vb={class:"profile-field"},Gb={class:"field-value"},Zb={class:"profile-field"},jb={class:"field-value"},Wb={__name:"AdminProfile",setup(e){const t=za(),o=ja(),i=Cb(),s=P(!1),a=async()=>{try{await i.fetchProfile()}catch(p){console.error("Failed to load profile:",p)}},l=async p=>{try{await i.updateProfile(p),s.value=!1}catch(f){console.error("Failed to save profile:",f),alert("Failed to save profile. Please try again.")}},u=()=>{o.logout(),t.push({name:"Home"})},h=()=>{t.push({name:"AdminDashboard"})};return Qt(()=>{a()}),(p,f)=>(m(),g("div",$b,[c("header",Mb,[f[2]||(f[2]=c("h1",null,"My profile",-1)),c("div",Ab,[c("span",Eb,_(z(o).adminEmail),1),c("button",{onClick:u,class:"btn btn-secondary"},"Logout")])]),c("div",Pb,[c("div",Db,[c("div",Ob,[f[3]||(f[3]=c("h2",null,"Profile information",-1)),c("button",{onClick:f[0]||(f[0]=y=>s.value=!0),class:"btn btn-primary"}," Edit profile ")]),z(i).loading?(m(),g("div",Rb,"Loading profile...")):z(i).error?(m(),g("div",Bb,[c("p",null,_(z(i).error),1),c("button",{onClick:a,class:"btn btn-secondary"},"Retry")])):z(i).profile?(m(),g("div",Nb,[c("div",Fb,[f[4]||(f[4]=c("label",null,"Name",-1)),c("div",Ub,_(z(i).profile.name||""),1)]),c("div",zb,[f[5]||(f[5]=c("label",null,"Email",-1)),c("div",Hb,_(z(i).profile.email||""),1)]),c("div",Vb,[f[6]||(f[6]=c("label",null,"Phone",-1)),c("div",Gb,_(z(i).profile.phone||""),1)]),c("div",Zb,[f[7]||(f[7]=c("label",null,"System admin",-1)),c("div",jb,[c("span",{class:Te(["badge",z(i).profile.isSystemAdmin?"badge-success":"badge-secondary"])},_(z(i).profile.isSystemAdmin?"Yes":"No"),3)])])])):R("",!0)]),c("div",{class:"section"},[c("button",{onClick:h,class:"btn btn-secondary"}," Back to Dashboard ")])]),ze(Ib,{show:s.value,profile:z(i).profile,onClose:f[1]||(f[1]=y=>s.value=!1),onSubmit:l},null,8,["show","profile"])]))}},qb=Ye(Wb,[["__scopeId","data-v-4d07684c"]]);function Kb(){const e=P(!1),t=P(""),o=P(""),i=P(null);return{showConfirmModal:e,confirmModalTitle:t,confirmModalMessage:o,showConfirm:(h,p,f)=>{t.value=h,o.value=p,i.value=f,e.value=!0},handleConfirmModalConfirm:()=>{e.value=!1,i.value&&(i.value(),i.value=null)},handleConfirmModalCancel:()=>{e.value=!1,i.value=null},closeConfirmModal:()=>{e.value=!1,i.value=null}}}const Ii=P({people:"Marshals",checkpoint:"Checkpoints",area:"Areas",checklist:"Checklists",course:"Course"}),Jo={people:{People:{singular:"Person",plural:"People"},Marshals:{singular:"Marshal",plural:"Marshals"},Volunteers:{singular:"Volunteer",plural:"Volunteers"},Helpers:{singular:"Helper",plural:"Helpers"},Staff:{singular:"Staff member",plural:"Staff"},Stewards:{singular:"Steward",plural:"Stewards"},"Team members":{singular:"Team member",plural:"Team members"},Drivers:{singular:"Driver",plural:"Drivers"},Pilots:{singular:"Pilot",plural:"Pilots"}},checkpoint:{Checkpoints:{singular:"Checkpoint",plural:"Checkpoints"},Stations:{singular:"Station",plural:"Stations"},Locations:{singular:"Location",plural:"Locations"},"Feed stations":{singular:"Feed station",plural:"Feed stations"},"Aid stations":{singular:"Aid station",plural:"Aid stations"},"Water stations":{singular:"Water station",plural:"Water stations"},"Person points":{singular:null,plural:null,dynamic:!0}},area:{Areas:{singular:"Area",plural:"Areas"},Regions:{singular:"Region",plural:"Regions"},Zones:{singular:"Zone",plural:"Zones"}},checklist:{Checklists:{singular:"Checklist",plural:"Checklists"},Tasks:{singular:"Task",plural:"Tasks"},Jobs:{singular:"Job",plural:"Jobs"}},course:{Course:{singular:"Course",plural:"Courses"},Route:{singular:"Route",plural:"Routes"},Track:{singular:"Track",plural:"Tracks"},Trail:{singular:"Trail",plural:"Trails"},Path:{singular:"Path",plural:"Paths"}}},Ko={people:["Drivers","Helpers","Marshals","People","Pilots","Staff","Stewards","Team members","Volunteers"],checkpoint:["Aid stations","Checkpoints","Feed stations","Locations","Person points","Stations","Water stations"],area:["Areas","Regions","Zones"],checklist:["Checklists","Jobs","Tasks"],course:["Course","Path","Route","Track","Trail"]};function Ys(e,t,o="Marshals"){if(!t)return"";const i=Jo[e]?.[t];return e==="checkpoint"&&t==="Person points"?`${Jo.people[o]?.singular||"Person"} point`:i?.singular?i.singular:t.endsWith("s")&&!t.endsWith("ss")?t.slice(0,-1):t}function Rp(e,t,o="Marshals"){if(!t)return"";const i=Jo[e]?.[t];return t==="Person points"?`${Jo.people[o]?.singular||"Person"} points`:i?.plural?i.plural:t}function Oc(e,t){return e==="Person points"?`${Jo.people[t]?.singular||"Person"} points`:e}function Rc(e){e&&(Ii.value={people:e.peopleTerm||"Marshals",checkpoint:e.checkpointTerm||"Checkpoints",area:e.areaTerm||"Areas",checklist:e.checklistTerm||"Checklists",course:e.courseTerm||"Course"})}const so=e=>e.toLowerCase(),io=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();function Ct(){const e=f=>{const y=Ii.value[f],k=Jo[f]?.[y];if(f==="checkpoint"&&y==="Person points"){const I=Ii.value.people;return`${Jo.people[I]?.singular||"Person"} point`}return k?.singular||y},t=f=>{const y=Ii.value[f],k=Jo[f]?.[y];if(f==="checkpoint"&&y==="Person points"){const I=Ii.value.people;return`${Jo.people[I]?.singular||"Person"} points`}return k?.plural||y},o=J(()=>({person:e("people"),checkpoint:e("checkpoint"),area:e("area"),checklist:e("checklist"),course:e("course"),people:t("people"),checkpoints:t("checkpoint"),areas:t("area"),checklists:t("checklist"),courses:t("course")})),i=J(()=>({person:so(e("people")),checkpoint:so(e("checkpoint")),area:so(e("area")),checklist:so(e("checklist")),course:so(e("course")),people:so(t("people")),checkpoints:so(t("checkpoint")),areas:so(t("area")),checklists:so(t("checklist")),courses:so(t("course"))})),s=J(()=>({person:io(e("people")),checkpoint:io(e("checkpoint")),area:io(e("area")),checklist:io(e("checklist")),course:io(e("course")),people:io(t("people")),checkpoints:io(t("checkpoint")),areas:io(t("area")),checklists:io(t("checklist")),courses:io(t("course"))})),a=J(()=>({course:o.value.course,checkpoints:o.value.checkpoints,areas:o.value.areas,marshals:o.value.people,checklists:o.value.checklists,notes:"Notes",details:"Event details"}));return{terms:o,termsLower:i,termsSentence:s,tabLabels:a,singular:e,plural:t,formatCount:(f,y)=>y===1?`1 ${e(f)}`:`${y} ${t(f)}`,lower:(f,y=!0)=>so(y?t(f):e(f)),title:(f,y=!0)=>y?t(f):e(f),sentence:(f,y=!0)=>io(y?t(f):e(f)),terminology:Ii}}function Yb(){const e=P(!1),t=P(null),o=P({}),i=P(null),s=P(null),a=P([]),l=P(null),u=P(null),h=P(!1),p=P(!1),f=P(1),y=J(()=>t.value==="place-checkpoint"||t.value==="move-checkpoint"?i.value!==null:t.value==="draw-area"?s.value&&s.value.length>=3:t.value==="add-multiple"),k=Ie=>{if(Ie){const Be=Ie.getMapCenter?.(),Se=Ie.getMapZoom?.();Be&&Se!==null&&(l.value=Be,u.value=Se)}},I=(Ie={})=>{i.value=null,e.value=!0,t.value="place-checkpoint",o.value={title:Ie.title||"Select checkpoint location",description:Ie.description||"Click on the map to set the location. Click again to reposition."}},M=(Ie,Be="checkpoint")=>{i.value=null,e.value=!0,t.value="move-checkpoint",o.value={title:`Move ${Be}: ${Ie}`,description:"Click on the map to set the new location"}},b=(Ie={})=>{e.value=!0,t.value="draw-area",h.value=!0,o.value={title:Ie.title||"Draw area boundary",description:Ie.description||"Click to add points. Click Done when finished to complete the area."}},B=(Ie=1)=>{f.value=Ie,a.value=[],e.value=!0,t.value="add-multiple",p.value=!0,o.value={title:"Add multiple checkpoints",description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},E=Ie=>{t.value==="place-checkpoint"||t.value==="move-checkpoint"?i.value=Ie:t.value==="add-multiple"&&A(Ie)},A=Ie=>{a.value.push({id:`temp-${f.value}`,name:`Checkpoint ${f.value}`,description:"",latitude:Ie.lat,longitude:Ie.lng,requiredMarshals:1,what3Words:"",assignments:[],isTemporary:!0}),f.value++,o.value={...o.value,description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},C=Ie=>{s.value=Ie},x=()=>s.value&&s.value.length>=3?s.value.map(Ie=>({lat:Ie.lat,lng:Ie.lng})):null,T=()=>{e.value=!1,t.value=null,o.value={},i.value=null,l.value=null,u.value=null,s.value=null,h.value&&(h.value=!1)};return{isFullscreenMapActive:e,fullscreenMode:t,fullscreenContext:o,tempLocationCoords:i,currentDrawingPolygon:s,tempCheckpoints:a,savedMapCenter:l,savedMapZoom:u,isDrawingAreaBoundary:h,isAddingMultipleCheckpoints:p,multiCheckpointCounter:f,canCompleteFullscreen:y,saveMapState:k,enterPlaceCheckpointMode:I,enterMoveCheckpointMode:M,enterDrawAreaMode:b,enterAddMultipleMode:B,handleFullscreenMapClick:E,handlePolygonDrawing:C,getCompletedPolygon:x,exitFullscreen:T,cancelFullscreen:()=>{t.value==="add-multiple"?(a.value=[],p.value=!1):t.value==="draw-area"&&(h.value=!1,s.value=null),T()},getTempCheckpoints:()=>[...a.value],clearTempCheckpoints:()=>{a.value=[],p.value=!1},getPlacedCoords:()=>i.value,createDisplayCheckpoints:(Ie,Be,Se)=>J(()=>{const he=[...Ie.value];return t.value==="place-checkpoint"&&i.value&&he.push({id:"temp-single",name:Be.value?.name||"New Checkpoint",latitude:i.value.lat,longitude:i.value.lng,requiredMarshals:Be.value?.requiredMarshals||1,assignments:[],isTemporary:!0}),t.value==="move-checkpoint"&&i.value&&Se.value&&he.push({id:"temp-move",name:Se.value.name+" (new position)",latitude:i.value.lat,longitude:i.value.lng,requiredMarshals:Se.value.requiredMarshals,assignments:[],isTemporary:!0}),t.value==="add-multiple"&&he.push(...a.value),he}),createDisplayAreas:(Ie,Be)=>J(()=>{const Se=[...Ie.value];if(t.value==="draw-area"&&Be.value?.polygon?.length>0){const he=Se.findIndex(Q=>Q.id===Be.value.id);he>=0?Se[he]={...Be.value}:Se.push({...Be.value,id:Be.value.id||"temp-area"})}return Se}),calculateStartingNumber:Ie=>{const Be=Ie.value.map(Se=>{const he=Se.name.match(/^Checkpoint (\d+)$/);return he?parseInt(he[1]):0}).filter(Se=>Se>0);return Be.length>0?Math.max(...Be)+1:1}}}function Jb(e){const t=P([]),o=P(!1);return{eventAdmins:t,showAddAdmin:o,loadEventAdmins:async()=>{try{const h=await lc.getAdmins(e.value);return t.value=h.data,h.data}catch(h){throw console.error("Failed to load event admins:",h),h}},openAddAdminModal:()=>{o.value=!0},closeAddAdminModal:()=>{o.value=!1},addAdmin:async h=>{await lc.addAdmin(e.value,h)},removeAdmin:async h=>{await lc.removeAdmin(e.value,h)}}}function Xb(e){const t=P(!1),o=P(!1),i=P(!1),s=P(!1),a=P(!1),l=P(!1),u=P(null),h=P(null),p=P(null),f=P(null);return{showUploadRoute:t,showImportLocations:o,showImportMarshals:i,uploading:s,importing:a,importingMarshals:l,uploadError:u,importError:h,importResult:p,importMarshalsResult:f,openUploadRouteModal:()=>{u.value=null,t.value=!0},closeUploadRouteModal:()=>{t.value=!1,u.value=null},uploadRoute:async T=>{if(!T)return u.value="Please select a GPX file",null;s.value=!0,u.value=null;try{return await Ks.uploadGpx(e.value,T),!0}catch(S){return console.error("Failed to upload route:",S),u.value=S.response?.data?.message||"Failed to upload route. Please try again.",null}finally{s.value=!1}},openImportLocationsModal:()=>{h.value=null,p.value=null,o.value=!0},closeImportLocationsModal:()=>{o.value=!1,h.value=null,p.value=null},importLocations:async(T,S)=>{if(!T)return h.value="Please select a CSV file",null;a.value=!0,h.value=null,p.value=null;try{const $=await wn.importCsv(e.value,T,S);return p.value=$.data,$.data}catch($){return console.error("Failed to import locations:",$),h.value=$.response?.data?.message||"Failed to import locations. Please try again.",null}finally{a.value=!1}},openImportMarshalsModal:()=>{h.value=null,f.value=null,i.value=!0},closeImportMarshalsModal:()=>{i.value=!1,h.value=null,f.value=null},importMarshals:async T=>{if(!T)return h.value="Please select a CSV file",null;l.value=!0,h.value=null,f.value=null;try{const S=await So.importCsv(e.value,T);return f.value=S.data,S.data}catch(S){return console.error("Failed to import marshals:",S),h.value=S.response?.data?.message||"Failed to import marshals. Please try again.",null}finally{l.value=!1}},formatImportResultMessage:(T,S="location")=>{const $=S==="location"?"location(s)":"marshal(s)";let ce=`<p>Created <strong>${T[S==="location"?"locationsCreated":"marshalsCreated"]}</strong> ${$} and <strong>${T.assignmentsCreated}</strong> assignment(s)</p>`;return T.errors&&T.errors.length>0&&(ce+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',T.errors.forEach(_e=>{ce+=`<li>${_e}</li>`}),ce+="</ul>"),ce}}}const Bp=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",Ra=e=>{if(!e)return"";const t=new Date(e),o=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0");return`${o}-${i}-${s}T${a}:${l}`},Xr=e=>{if(!e||e.trim()==="")return!0;if(!/^[a-z]{1,20}[./][a-z]{1,20}[./][a-z]{1,20}$/.test(e))return!1;const o=e.includes("."),i=e.includes("/");return o!==i};function Qb(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var va={exports:{}};var ew=va.exports,hh;function tw(){return hh||(hh=1,(function(e,t){(function(o,i){i(t)})(ew,(function(o){var i="1.9.4";function s(n){var r,d,v,w;for(d=1,v=arguments.length;d<v;d++){w=arguments[d];for(r in w)n[r]=w[r]}return n}var a=Object.create||(function(){function n(){}return function(r){return n.prototype=r,new n}})();function l(n,r){var d=Array.prototype.slice;if(n.bind)return n.bind.apply(n,d.call(arguments,1));var v=d.call(arguments,2);return function(){return n.apply(r,v.length?v.concat(d.call(arguments)):arguments)}}var u=0;function h(n){return"_leaflet_id"in n||(n._leaflet_id=++u),n._leaflet_id}function p(n,r,d){var v,w,D,K;return K=function(){v=!1,w&&(D.apply(d,w),w=!1)},D=function(){v?w=arguments:(n.apply(d,arguments),setTimeout(K,r),v=!0)},D}function f(n,r,d){var v=r[1],w=r[0],D=v-w;return n===v&&d?n:((n-w)%D+D)%D+w}function y(){return!1}function k(n,r){if(r===!1)return n;var d=Math.pow(10,r===void 0?6:r);return Math.round(n*d)/d}function I(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function M(n){return I(n).split(/\s+/)}function b(n,r){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?a(n.options):{});for(var d in r)n.options[d]=r[d];return n.options}function B(n,r,d){var v=[];for(var w in n)v.push(encodeURIComponent(d?w.toUpperCase():w)+"="+encodeURIComponent(n[w]));return(!r||r.indexOf("?")===-1?"?":"&")+v.join("&")}var E=/\{ *([\w_ -]+) *\}/g;function A(n,r){return n.replace(E,function(d,v){var w=r[v];if(w===void 0)throw new Error("No value provided for variable "+d);return typeof w=="function"&&(w=w(r)),w})}var C=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function x(n,r){for(var d=0;d<n.length;d++)if(n[d]===r)return d;return-1}var T="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function S(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var $=0;function se(n){var r=+new Date,d=Math.max(0,16-(r-$));return $=r+d,window.setTimeout(n,d)}var ce=window.requestAnimationFrame||S("RequestAnimationFrame")||se,_e=window.cancelAnimationFrame||S("CancelAnimationFrame")||S("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function ae(n,r,d){if(d&&ce===se)n.call(r);else return ce.call(window,l(n,r))}function pe(n){n&&_e.call(window,n)}var Ie={__proto__:null,extend:s,create:a,bind:l,get lastId(){return u},stamp:h,throttle:p,wrapNum:f,falseFn:y,formatNum:k,trim:I,splitWords:M,setOptions:b,getParamString:B,template:A,isArray:C,indexOf:x,emptyImageUrl:T,requestFn:ce,cancelFn:_e,requestAnimFrame:ae,cancelAnimFrame:pe};function Be(){}Be.extend=function(n){var r=function(){b(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},d=r.__super__=this.prototype,v=a(d);v.constructor=r,r.prototype=v;for(var w in this)Object.prototype.hasOwnProperty.call(this,w)&&w!=="prototype"&&w!=="__super__"&&(r[w]=this[w]);return n.statics&&s(r,n.statics),n.includes&&(Se(n.includes),s.apply(null,[v].concat(n.includes))),s(v,n),delete v.statics,delete v.includes,v.options&&(v.options=d.options?a(d.options):{},s(v.options,n.options)),v._initHooks=[],v.callInitHooks=function(){if(!this._initHooksCalled){d.callInitHooks&&d.callInitHooks.call(this),this._initHooksCalled=!0;for(var D=0,K=v._initHooks.length;D<K;D++)v._initHooks[D].call(this)}},r},Be.include=function(n){var r=this.prototype.options;return s(this.prototype,n),n.options&&(this.prototype.options=r,this.mergeOptions(n.options)),this},Be.mergeOptions=function(n){return s(this.prototype.options,n),this},Be.addInitHook=function(n){var r=Array.prototype.slice.call(arguments,1),d=typeof n=="function"?n:function(){this[n].apply(this,r)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(d),this};function Se(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=C(n)?n:[n];for(var r=0;r<n.length;r++)n[r]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var he={on:function(n,r,d){if(typeof n=="object")for(var v in n)this._on(v,n[v],r);else{n=M(n);for(var w=0,D=n.length;w<D;w++)this._on(n[w],r,d)}return this},off:function(n,r,d){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var v in n)this._off(v,n[v],r);else{n=M(n);for(var w=arguments.length===1,D=0,K=n.length;D<K;D++)w?this._off(n[D]):this._off(n[D],r,d)}return this},_on:function(n,r,d,v){if(typeof r!="function"){console.warn("wrong listener type: "+typeof r);return}if(this._listens(n,r,d)===!1){d===this&&(d=void 0);var w={fn:r,ctx:d};v&&(w.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(w)}},_off:function(n,r,d){var v,w,D;if(this._events&&(v=this._events[n],!!v)){if(arguments.length===1){if(this._firingCount)for(w=0,D=v.length;w<D;w++)v[w].fn=y;delete this._events[n];return}if(typeof r!="function"){console.warn("wrong listener type: "+typeof r);return}var K=this._listens(n,r,d);if(K!==!1){var de=v[K];this._firingCount&&(de.fn=y,this._events[n]=v=v.slice()),v.splice(K,1)}}},fire:function(n,r,d){if(!this.listens(n,d))return this;var v=s({},r,{type:n,target:this,sourceTarget:r&&r.sourceTarget||this});if(this._events){var w=this._events[n];if(w){this._firingCount=this._firingCount+1||1;for(var D=0,K=w.length;D<K;D++){var de=w[D],ge=de.fn;de.once&&this.off(n,ge,de.ctx),ge.call(de.ctx||this,v)}this._firingCount--}}return d&&this._propagateEvent(v),this},listens:function(n,r,d,v){typeof n!="string"&&console.warn('"string" type argument expected');var w=r;typeof r!="function"&&(v=!!r,w=void 0,d=void 0);var D=this._events&&this._events[n];if(D&&D.length&&this._listens(n,w,d)!==!1)return!0;if(v){for(var K in this._eventParents)if(this._eventParents[K].listens(n,r,d,v))return!0}return!1},_listens:function(n,r,d){if(!this._events)return!1;var v=this._events[n]||[];if(!r)return!!v.length;d===this&&(d=void 0);for(var w=0,D=v.length;w<D;w++)if(v[w].fn===r&&v[w].ctx===d)return w;return!1},once:function(n,r,d){if(typeof n=="object")for(var v in n)this._on(v,n[v],r,!0);else{n=M(n);for(var w=0,D=n.length;w<D;w++)this._on(n[w],r,d,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[h(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[h(n)],this},_propagateEvent:function(n){for(var r in this._eventParents)this._eventParents[r].fire(n.type,s({layer:n.target,propagatedFrom:n.target},n),!0)}};he.addEventListener=he.on,he.removeEventListener=he.clearAllEventListeners=he.off,he.addOneTimeEventListener=he.once,he.fireEvent=he.fire,he.hasEventListeners=he.listens;var Q=Be.extend(he);function X(n,r,d){this.x=d?Math.round(n):n,this.y=d?Math.round(r):r}var ue=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};X.prototype={clone:function(){return new X(this.x,this.y)},add:function(n){return this.clone()._add(te(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(te(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new X(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new X(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ue(this.x),this.y=ue(this.y),this},distanceTo:function(n){n=te(n);var r=n.x-this.x,d=n.y-this.y;return Math.sqrt(r*r+d*d)},equals:function(n){return n=te(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=te(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+k(this.x)+", "+k(this.y)+")"}};function te(n,r,d){return n instanceof X?n:C(n)?new X(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new X(n.x,n.y):new X(n,r,d)}function be(n,r){if(n)for(var d=r?[n,r]:n,v=0,w=d.length;v<w;v++)this.extend(d[v])}be.prototype={extend:function(n){var r,d;if(!n)return this;if(n instanceof X||typeof n[0]=="number"||"x"in n)r=d=te(n);else if(n=Oe(n),r=n.min,d=n.max,!r||!d)return this;return!this.min&&!this.max?(this.min=r.clone(),this.max=d.clone()):(this.min.x=Math.min(r.x,this.min.x),this.max.x=Math.max(d.x,this.max.x),this.min.y=Math.min(r.y,this.min.y),this.max.y=Math.max(d.y,this.max.y)),this},getCenter:function(n){return te((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return te(this.min.x,this.max.y)},getTopRight:function(){return te(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var r,d;return typeof n[0]=="number"||n instanceof X?n=te(n):n=Oe(n),n instanceof be?(r=n.min,d=n.max):r=d=n,r.x>=this.min.x&&d.x<=this.max.x&&r.y>=this.min.y&&d.y<=this.max.y},intersects:function(n){n=Oe(n);var r=this.min,d=this.max,v=n.min,w=n.max,D=w.x>=r.x&&v.x<=d.x,K=w.y>=r.y&&v.y<=d.y;return D&&K},overlaps:function(n){n=Oe(n);var r=this.min,d=this.max,v=n.min,w=n.max,D=w.x>r.x&&v.x<d.x,K=w.y>r.y&&v.y<d.y;return D&&K},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var r=this.min,d=this.max,v=Math.abs(r.x-d.x)*n,w=Math.abs(r.y-d.y)*n;return Oe(te(r.x-v,r.y-w),te(d.x+v,d.y+w))},equals:function(n){return n?(n=Oe(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function Oe(n,r){return!n||n instanceof be?n:new be(n,r)}function ne(n,r){if(n)for(var d=r?[n,r]:n,v=0,w=d.length;v<w;v++)this.extend(d[v])}ne.prototype={extend:function(n){var r=this._southWest,d=this._northEast,v,w;if(n instanceof xe)v=n,w=n;else if(n instanceof ne){if(v=n._southWest,w=n._northEast,!v||!w)return this}else return n?this.extend(we(n)||Ee(n)):this;return!r&&!d?(this._southWest=new xe(v.lat,v.lng),this._northEast=new xe(w.lat,w.lng)):(r.lat=Math.min(v.lat,r.lat),r.lng=Math.min(v.lng,r.lng),d.lat=Math.max(w.lat,d.lat),d.lng=Math.max(w.lng,d.lng)),this},pad:function(n){var r=this._southWest,d=this._northEast,v=Math.abs(r.lat-d.lat)*n,w=Math.abs(r.lng-d.lng)*n;return new ne(new xe(r.lat-v,r.lng-w),new xe(d.lat+v,d.lng+w))},getCenter:function(){return new xe((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new xe(this.getNorth(),this.getWest())},getSouthEast:function(){return new xe(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof xe||"lat"in n?n=we(n):n=Ee(n);var r=this._southWest,d=this._northEast,v,w;return n instanceof ne?(v=n.getSouthWest(),w=n.getNorthEast()):v=w=n,v.lat>=r.lat&&w.lat<=d.lat&&v.lng>=r.lng&&w.lng<=d.lng},intersects:function(n){n=Ee(n);var r=this._southWest,d=this._northEast,v=n.getSouthWest(),w=n.getNorthEast(),D=w.lat>=r.lat&&v.lat<=d.lat,K=w.lng>=r.lng&&v.lng<=d.lng;return D&&K},overlaps:function(n){n=Ee(n);var r=this._southWest,d=this._northEast,v=n.getSouthWest(),w=n.getNorthEast(),D=w.lat>r.lat&&v.lat<d.lat,K=w.lng>r.lng&&v.lng<d.lng;return D&&K},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,r){return n?(n=Ee(n),this._southWest.equals(n.getSouthWest(),r)&&this._northEast.equals(n.getNorthEast(),r)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Ee(n,r){return n instanceof ne?n:new ne(n,r)}function xe(n,r,d){if(isNaN(n)||isNaN(r))throw new Error("Invalid LatLng object: ("+n+", "+r+")");this.lat=+n,this.lng=+r,d!==void 0&&(this.alt=+d)}xe.prototype={equals:function(n,r){if(!n)return!1;n=we(n);var d=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return d<=(r===void 0?1e-9:r)},toString:function(n){return"LatLng("+k(this.lat,n)+", "+k(this.lng,n)+")"},distanceTo:function(n){return ve.distance(this,we(n))},wrap:function(){return ve.wrapLatLng(this)},toBounds:function(n){var r=180*n/40075017,d=r/Math.cos(Math.PI/180*this.lat);return Ee([this.lat-r,this.lng-d],[this.lat+r,this.lng+d])},clone:function(){return new xe(this.lat,this.lng,this.alt)}};function we(n,r,d){return n instanceof xe?n:C(n)&&typeof n[0]!="object"?n.length===3?new xe(n[0],n[1],n[2]):n.length===2?new xe(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new xe(n.lat,"lng"in n?n.lng:n.lon,n.alt):r===void 0?null:new xe(n,r,d)}var re={latLngToPoint:function(n,r){var d=this.projection.project(n),v=this.scale(r);return this.transformation._transform(d,v)},pointToLatLng:function(n,r){var d=this.scale(r),v=this.transformation.untransform(n,d);return this.projection.unproject(v)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var r=this.projection.bounds,d=this.scale(n),v=this.transformation.transform(r.min,d),w=this.transformation.transform(r.max,d);return new be(v,w)},infinite:!1,wrapLatLng:function(n){var r=this.wrapLng?f(n.lng,this.wrapLng,!0):n.lng,d=this.wrapLat?f(n.lat,this.wrapLat,!0):n.lat,v=n.alt;return new xe(d,r,v)},wrapLatLngBounds:function(n){var r=n.getCenter(),d=this.wrapLatLng(r),v=r.lat-d.lat,w=r.lng-d.lng;if(v===0&&w===0)return n;var D=n.getSouthWest(),K=n.getNorthEast(),de=new xe(D.lat-v,D.lng-w),ge=new xe(K.lat-v,K.lng-w);return new ne(de,ge)}},ve=s({},re,{wrapLng:[-180,180],R:6371e3,distance:function(n,r){var d=Math.PI/180,v=n.lat*d,w=r.lat*d,D=Math.sin((r.lat-n.lat)*d/2),K=Math.sin((r.lng-n.lng)*d/2),de=D*D+Math.cos(v)*Math.cos(w)*K*K,ge=2*Math.atan2(Math.sqrt(de),Math.sqrt(1-de));return this.R*ge}}),q=6378137,fe={R:q,MAX_LATITUDE:85.0511287798,project:function(n){var r=Math.PI/180,d=this.MAX_LATITUDE,v=Math.max(Math.min(d,n.lat),-d),w=Math.sin(v*r);return new X(this.R*n.lng*r,this.R*Math.log((1+w)/(1-w))/2)},unproject:function(n){var r=180/Math.PI;return new xe((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*r,n.x*r/this.R)},bounds:(function(){var n=q*Math.PI;return new be([-n,-n],[n,n])})()};function Le(n,r,d,v){if(C(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=r,this._c=d,this._d=v}Le.prototype={transform:function(n,r){return this._transform(n.clone(),r)},_transform:function(n,r){return r=r||1,n.x=r*(this._a*n.x+this._b),n.y=r*(this._c*n.y+this._d),n},untransform:function(n,r){return r=r||1,new X((n.x/r-this._b)/this._a,(n.y/r-this._d)/this._c)}};function U(n,r,d,v){return new Le(n,r,d,v)}var H=s({},ve,{code:"EPSG:3857",projection:fe,transformation:(function(){var n=.5/(Math.PI*fe.R);return U(n,.5,-n,.5)})()}),Y=s({},H,{code:"EPSG:900913"});function Z(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function N(n,r){var d="",v,w,D,K,de,ge;for(v=0,D=n.length;v<D;v++){for(de=n[v],w=0,K=de.length;w<K;w++)ge=de[w],d+=(w?"L":"M")+ge.x+" "+ge.y;d+=r?Je.svg?"z":"x":""}return d||"M0 0"}var O=document.documentElement.style,W="ActiveXObject"in window,me=W&&!document.addEventListener,$e="msLaunchUri"in navigator&&!("documentMode"in document),ke=Ut("webkit"),Ne=Ut("android"),Fe=Ut("android 2")||Ut("android 3"),Ue=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),We=Ne&&Ut("Google")&&Ue<537&&!("AudioNode"in window),oe=!!window.opera,ee=!$e&&Ut("chrome"),j=Ut("gecko")&&!ke&&!oe&&!W,Ve=!ee&&Ut("safari"),Xe=Ut("phantom"),nt="OTransition"in O,at=navigator.platform.indexOf("Win")===0,tt=W&&"transition"in O,St="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Fe,$t="MozPerspective"in O,yt=!window.L_DISABLE_3D&&(tt||St||$t)&&!nt&&!Xe,xn=typeof orientation<"u"||Ut("mobile"),To=xn&&ke,Yn=xn&&St,Dt=!window.PointerEvent&&window.MSPointerEvent,Rn=!!(window.PointerEvent||Dt),Bn="ontouchstart"in window||!!window.TouchEvent,Jn=!window.L_NO_TOUCH&&(Bn||Rn),mo=xn&&oe,Io=xn&&j,$o=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Xn=(function(){var n=!1;try{var r=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",y,r),window.removeEventListener("testPassiveEventSupport",y,r)}catch{}return n})(),Nn=(function(){return!!document.createElement("canvas").getContext})(),Tn=!!(document.createElementNS&&Z("svg").createSVGRect),Mo=!!Tn&&(function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),is=!Tn&&(function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var r=n.firstChild;return r.style.behavior="url(#default#VML)",r&&typeof r.adj=="object"}catch{return!1}})(),Ps=navigator.platform.indexOf("Mac")===0,Ao=navigator.platform.indexOf("Linux")===0;function Ut(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var Je={ie:W,ielt9:me,edge:$e,webkit:ke,android:Ne,android23:Fe,androidStock:We,opera:oe,chrome:ee,gecko:j,safari:Ve,phantom:Xe,opera12:nt,win:at,ie3d:tt,webkit3d:St,gecko3d:$t,any3d:yt,mobile:xn,mobileWebkit:To,mobileWebkit3d:Yn,msPointer:Dt,pointer:Rn,touch:Jn,touchNative:Bn,mobileOpera:mo,mobileGecko:Io,retina:$o,passiveEvents:Xn,canvas:Nn,svg:Tn,vml:is,inlineSvg:Mo,mac:Ps,linux:Ao},Eo=Je.msPointer?"MSPointerDown":"pointerdown",Po=Je.msPointer?"MSPointerMove":"pointermove",Qn=Je.msPointer?"MSPointerUp":"pointerup",vn=Je.msPointer?"MSPointerCancel":"pointercancel",In={touchstart:Eo,touchmove:Po,touchend:Qn,touchcancel:vn},eo={touchstart:ls,touchmove:rs,touchend:rs,touchcancel:rs},mn={},Ds=!1;function Vi(n,r,d){return r==="touchstart"&&Yt(),eo[r]?(d=eo[r].bind(this,d),n.addEventListener(In[r],d,!1),d):(console.warn("wrong event specified:",r),y)}function Gi(n,r,d){if(!In[r]){console.warn("wrong event specified:",r);return}n.removeEventListener(In[r],d,!1)}function Zi(n){mn[n.pointerId]=n}function as(n){mn[n.pointerId]&&(mn[n.pointerId]=n)}function go(n){delete mn[n.pointerId]}function Yt(){Ds||(document.addEventListener(Eo,Zi,!0),document.addEventListener(Po,as,!0),document.addEventListener(Qn,go,!0),document.addEventListener(vn,go,!0),Ds=!0)}function rs(n,r){if(r.pointerType!==(r.MSPOINTER_TYPE_MOUSE||"mouse")){r.touches=[];for(var d in mn)r.touches.push(mn[d]);r.changedTouches=[r],n(r)}}function ls(n,r){r.MSPOINTER_TYPE_TOUCH&&r.pointerType===r.MSPOINTER_TYPE_TOUCH&&Gt(r),rs(n,r)}function cs(n){var r={},d,v;for(v in n)d=n[v],r[v]=d&&d.bind?d.bind(n):d;return n=r,r.type="dblclick",r.detail=2,r.isTrusted=!1,r._simulated=!0,r}var Os=200;function li(n,r){n.addEventListener("dblclick",r);var d=0,v;function w(D){if(D.detail!==1){v=D.detail;return}if(!(D.pointerType==="mouse"||D.sourceCapabilities&&!D.sourceCapabilities.firesTouchEvents)){var K=Yi(D);if(!(K.some(function(ge){return ge instanceof HTMLLabelElement&&ge.attributes.for})&&!K.some(function(ge){return ge instanceof HTMLInputElement||ge instanceof HTMLSelectElement}))){var de=Date.now();de-d<=Os?(v++,v===2&&r(cs(D))):v=1,d=de}}}return n.addEventListener("click",w),{dblclick:r,simDblclick:w}}function Ot(n,r){n.removeEventListener("dblclick",r.dblclick),n.removeEventListener("click",r.simDblclick)}var us=Hn(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),$n=Hn(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ds=$n==="webkitTransition"||$n==="OTransition"?$n+"End":"transitionend";function ci(n){return typeof n=="string"?document.getElementById(n):n}function Fn(n,r){var d=n.style[r]||n.currentStyle&&n.currentStyle[r];if((!d||d==="auto")&&document.defaultView){var v=document.defaultView.getComputedStyle(n,null);d=v?v[r]:null}return d==="auto"?null:d}function rt(n,r,d){var v=document.createElement(n);return v.className=r||"",d&&d.appendChild(v),v}function Lt(n){var r=n.parentNode;r&&r.removeChild(n)}function to(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function Un(n){var r=n.parentNode;r&&r.lastChild!==n&&r.appendChild(n)}function zn(n){var r=n.parentNode;r&&r.firstChild!==n&&r.insertBefore(n,r.firstChild)}function no(n,r){if(n.classList!==void 0)return n.classList.contains(r);var d=fs(n);return d.length>0&&new RegExp("(^|\\s)"+r+"(\\s|$)").test(d)}function lt(n,r){if(n.classList!==void 0)for(var d=M(r),v=0,w=d.length;v<w;v++)n.classList.add(d[v]);else if(!no(n,r)){var D=fs(n);hs(n,(D?D+" ":"")+r)}}function Mt(n,r){n.classList!==void 0?n.classList.remove(r):hs(n,I((" "+fs(n)+" ").replace(" "+r+" "," ")))}function hs(n,r){n.className.baseVal===void 0?n.className=r:n.className.baseVal=r}function fs(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function Jt(n,r){"opacity"in n.style?n.style.opacity=r:"filter"in n.style&&Rs(n,r)}function Rs(n,r){var d=!1,v="DXImageTransform.Microsoft.Alpha";try{d=n.filters.item(v)}catch{if(r===1)return}r=Math.round(r*100),d?(d.Enabled=r!==100,d.Opacity=r):n.style.filter+=" progid:"+v+"(opacity="+r+")"}function Hn(n){for(var r=document.documentElement.style,d=0;d<n.length;d++)if(n[d]in r)return n[d];return!1}function Vn(n,r,d){var v=r||new X(0,0);n.style[us]=(Je.ie3d?"translate("+v.x+"px,"+v.y+"px)":"translate3d("+v.x+"px,"+v.y+"px,0)")+(d?" scale("+d+")":"")}function Tt(n,r){n._leaflet_pos=r,Je.any3d?Vn(n,r):(n.style.left=r.x+"px",n.style.top=r.y+"px")}function V(n){return n._leaflet_pos||new X(0,0)}var G,ie,Me;if("onselectstart"in document)G=function(){ut(window,"selectstart",Gt)},ie=function(){kt(window,"selectstart",Gt)};else{var Ge=Hn(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);G=function(){if(Ge){var n=document.documentElement.style;Me=n[Ge],n[Ge]="none"}},ie=function(){Ge&&(document.documentElement.style[Ge]=Me,Me=void 0)}}function it(){ut(window,"dragstart",Gt)}function Rt(){kt(window,"dragstart",Gt)}var Vt,en;function Bs(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(ui(),Vt=n,en=n.style.outlineStyle,n.style.outlineStyle="none",ut(window,"keydown",ui))}function ui(){Vt&&(Vt.style.outlineStyle=en,Vt=void 0,en=void 0,kt(window,"keydown",ui))}function di(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function ji(n){var r=n.getBoundingClientRect();return{x:r.width/n.offsetWidth||1,y:r.height/n.offsetHeight||1,boundingClientRect:r}}var Il={__proto__:null,TRANSFORM:us,TRANSITION:$n,TRANSITION_END:ds,get:ci,getStyle:Fn,create:rt,remove:Lt,empty:to,toFront:Un,toBack:zn,hasClass:no,addClass:lt,removeClass:Mt,setClass:hs,getClass:fs,setOpacity:Jt,testProp:Hn,setTransform:Vn,setPosition:Tt,getPosition:V,get disableTextSelection(){return G},get enableTextSelection(){return ie},disableImageDrag:it,enableImageDrag:Rt,preventOutline:Bs,restoreOutline:ui,getSizedParentNode:di,getScale:ji};function ut(n,r,d,v){if(r&&typeof r=="object")for(var w in r)Wi(n,w,r[w],d);else{r=M(r);for(var D=0,K=r.length;D<K;D++)Wi(n,r[D],d,v)}return this}var Gn="_leaflet_events";function kt(n,r,d,v){if(arguments.length===1)Wa(n),delete n[Gn];else if(r&&typeof r=="object")for(var w in r)qi(n,w,r[w],d);else if(r=M(r),arguments.length===2)Wa(n,function(de){return x(r,de)!==-1});else for(var D=0,K=r.length;D<K;D++)qi(n,r[D],d,v);return this}function Wa(n,r){for(var d in n[Gn]){var v=d.split(/\d/)[0];(!r||r(v))&&qi(n,v,null,null,d)}}var hi={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Wi(n,r,d,v){var w=r+h(d)+(v?"_"+h(v):"");if(n[Gn]&&n[Gn][w])return this;var D=function(de){return d.call(v||n,de||window.event)},K=D;!Je.touchNative&&Je.pointer&&r.indexOf("touch")===0?D=Vi(n,r,D):Je.touch&&r==="dblclick"?D=li(n,D):"addEventListener"in n?r==="touchstart"||r==="touchmove"||r==="wheel"||r==="mousewheel"?n.addEventListener(hi[r]||r,D,Je.passiveEvents?{passive:!1}:!1):r==="mouseenter"||r==="mouseleave"?(D=function(de){de=de||window.event,Ji(n,de)&&K(de)},n.addEventListener(hi[r],D,!1)):n.addEventListener(r,K,!1):n.attachEvent("on"+r,D),n[Gn]=n[Gn]||{},n[Gn][w]=D}function qi(n,r,d,v,w){w=w||r+h(d)+(v?"_"+h(v):"");var D=n[Gn]&&n[Gn][w];if(!D)return this;!Je.touchNative&&Je.pointer&&r.indexOf("touch")===0?Gi(n,r,D):Je.touch&&r==="dblclick"?Ot(n,D):"removeEventListener"in n?n.removeEventListener(hi[r]||r,D,!1):n.detachEvent("on"+r,D),n[Gn][w]=null}function oo(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function Ki(n){return Wi(n,"wheel",oo),this}function Ns(n){return ut(n,"mousedown touchstart dblclick contextmenu",oo),n._leaflet_disable_click=!0,this}function Gt(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function Do(n){return Gt(n),oo(n),this}function Yi(n){if(n.composedPath)return n.composedPath();for(var r=[],d=n.target;d;)r.push(d),d=d.parentNode;return r}function qa(n,r){if(!r)return new X(n.clientX,n.clientY);var d=ji(r),v=d.boundingClientRect;return new X((n.clientX-v.left)/d.x-r.clientLeft,(n.clientY-v.top)/d.y-r.clientTop)}var Ka=Je.linux&&Je.chrome?window.devicePixelRatio:Je.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ya(n){return Je.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/Ka:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function Ji(n,r){var d=r.relatedTarget;if(!d)return!0;try{for(;d&&d!==n;)d=d.parentNode}catch{return!1}return d!==n}var $l={__proto__:null,on:ut,off:kt,stopPropagation:oo,disableScrollPropagation:Ki,disableClickPropagation:Ns,preventDefault:Gt,stop:Do,getPropagationPath:Yi,getMousePosition:qa,getWheelDelta:Ya,isExternalTarget:Ji,addListener:ut,removeListener:kt},Ja=Q.extend({run:function(n,r,d,v){this.stop(),this._el=n,this._inProgress=!0,this._duration=d||.25,this._easeOutPower=1/Math.max(v||.5,.2),this._startPos=V(n),this._offset=r.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=ae(this._animate,this),this._step()},_step:function(n){var r=+new Date-this._startTime,d=this._duration*1e3;r<d?this._runFrame(this._easeOut(r/d),n):(this._runFrame(1),this._complete())},_runFrame:function(n,r){var d=this._startPos.add(this._offset.multiplyBy(n));r&&d._round(),Tt(this._el,d),this.fire("step")},_complete:function(){pe(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),mt=Q.extend({options:{crs:H,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,r){r=b(this,r),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),r.maxBounds&&this.setMaxBounds(r.maxBounds),r.zoom!==void 0&&(this._zoom=this._limitZoom(r.zoom)),r.center&&r.zoom!==void 0&&this.setView(we(r.center),r.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=$n&&Je.any3d&&!Je.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),ut(this._proxy,ds,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,r,d){if(r=r===void 0?this._zoom:this._limitZoom(r),n=this._limitCenter(we(n),r,this.options.maxBounds),d=d||{},this._stop(),this._loaded&&!d.reset&&d!==!0){d.animate!==void 0&&(d.zoom=s({animate:d.animate},d.zoom),d.pan=s({animate:d.animate,duration:d.duration},d.pan));var v=this._zoom!==r?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,r,d.zoom):this._tryAnimatedPan(n,d.pan);if(v)return clearTimeout(this._sizeTimer),this}return this._resetView(n,r,d.pan&&d.pan.noMoveStart),this},setZoom:function(n,r){return this._loaded?this.setView(this.getCenter(),n,{zoom:r}):(this._zoom=n,this)},zoomIn:function(n,r){return n=n||(Je.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,r)},zoomOut:function(n,r){return n=n||(Je.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,r)},setZoomAround:function(n,r,d){var v=this.getZoomScale(r),w=this.getSize().divideBy(2),D=n instanceof X?n:this.latLngToContainerPoint(n),K=D.subtract(w).multiplyBy(1-1/v),de=this.containerPointToLatLng(w.add(K));return this.setView(de,r,{zoom:d})},_getBoundsCenterZoom:function(n,r){r=r||{},n=n.getBounds?n.getBounds():Ee(n);var d=te(r.paddingTopLeft||r.padding||[0,0]),v=te(r.paddingBottomRight||r.padding||[0,0]),w=this.getBoundsZoom(n,!1,d.add(v));if(w=typeof r.maxZoom=="number"?Math.min(r.maxZoom,w):w,w===1/0)return{center:n.getCenter(),zoom:w};var D=v.subtract(d).divideBy(2),K=this.project(n.getSouthWest(),w),de=this.project(n.getNorthEast(),w),ge=this.unproject(K.add(de).divideBy(2).add(D),w);return{center:ge,zoom:w}},fitBounds:function(n,r){if(n=Ee(n),!n.isValid())throw new Error("Bounds are not valid.");var d=this._getBoundsCenterZoom(n,r);return this.setView(d.center,d.zoom,r)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,r){return this.setView(n,this._zoom,{pan:r})},panBy:function(n,r){if(n=te(n).round(),r=r||{},!n.x&&!n.y)return this.fire("moveend");if(r.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ja,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),r.noMoveStart||this.fire("movestart"),r.animate!==!1){lt(this._mapPane,"leaflet-pan-anim");var d=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,d,r.duration||.25,r.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,r,d){if(d=d||{},d.animate===!1||!Je.any3d)return this.setView(n,r,d);this._stop();var v=this.project(this.getCenter()),w=this.project(n),D=this.getSize(),K=this._zoom;n=we(n),r=r===void 0?K:r;var de=Math.max(D.x,D.y),ge=de*this.getZoomScale(K,r),Ae=w.distanceTo(v)||1,Ke=1.42,ot=Ke*Ke;function pt(Zt){var kr=Zt?-1:1,gv=Zt?ge:de,yv=ge*ge-de*de+kr*ot*ot*Ae*Ae,_v=2*gv*ot*Ae,zl=yv/_v,Fu=Math.sqrt(zl*zl+1)-zl,kv=Fu<1e-9?-18:Math.log(Fu);return kv}function cn(Zt){return(Math.exp(Zt)-Math.exp(-Zt))/2}function Wt(Zt){return(Math.exp(Zt)+Math.exp(-Zt))/2}function Zn(Zt){return cn(Zt)/Wt(Zt)}var _n=pt(0);function wi(Zt){return de*(Wt(_n)/Wt(_n+Ke*Zt))}function fv(Zt){return de*(Wt(_n)*Zn(_n+Ke*Zt)-cn(_n))/ot}function pv(Zt){return 1-Math.pow(1-Zt,1.5)}var vv=Date.now(),Bu=(pt(1)-_n)/Ke,mv=d.duration?1e3*d.duration:1e3*Bu*.8;function Nu(){var Zt=(Date.now()-vv)/mv,kr=pv(Zt)*Bu;Zt<=1?(this._flyToFrame=ae(Nu,this),this._move(this.unproject(v.add(w.subtract(v).multiplyBy(fv(kr)/Ae)),K),this.getScaleZoom(de/wi(kr),K),{flyTo:!0})):this._move(n,r)._moveEnd(!0)}return this._moveStart(!0,d.noMoveStart),Nu.call(this),this},flyToBounds:function(n,r){var d=this._getBoundsCenterZoom(n,r);return this.flyTo(d.center,d.zoom,r)},setMaxBounds:function(n){return n=Ee(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var r=this.options.minZoom;return this.options.minZoom=n,this._loaded&&r!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var r=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&r!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,r){this._enforcingBounds=!0;var d=this.getCenter(),v=this._limitCenter(d,this._zoom,Ee(n));return d.equals(v)||this.panTo(v,r),this._enforcingBounds=!1,this},panInside:function(n,r){r=r||{};var d=te(r.paddingTopLeft||r.padding||[0,0]),v=te(r.paddingBottomRight||r.padding||[0,0]),w=this.project(this.getCenter()),D=this.project(n),K=this.getPixelBounds(),de=Oe([K.min.add(d),K.max.subtract(v)]),ge=de.getSize();if(!de.contains(D)){this._enforcingBounds=!0;var Ae=D.subtract(de.getCenter()),Ke=de.extend(D).getSize().subtract(ge);w.x+=Ae.x<0?-Ke.x:Ke.x,w.y+=Ae.y<0?-Ke.y:Ke.y,this.panTo(this.unproject(w),r),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=s({animate:!1,pan:!0},n===!0?{animate:!0}:n);var r=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var d=this.getSize(),v=r.divideBy(2).round(),w=d.divideBy(2).round(),D=v.subtract(w);return!D.x&&!D.y?this:(n.animate&&n.pan?this.panBy(D):(n.pan&&this._rawPanBy(D),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:r,newSize:d}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=s({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var r=l(this._handleGeolocationResponse,this),d=l(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(r,d,n):navigator.geolocation.getCurrentPosition(r,d,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var r=n.code,d=n.message||(r===1?"permission denied":r===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:r,message:"Geolocation error: "+d+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var r=n.coords.latitude,d=n.coords.longitude,v=new xe(r,d),w=v.toBounds(n.coords.accuracy*2),D=this._locateOptions;if(D.setView){var K=this.getBoundsZoom(w);this.setView(v,D.maxZoom?Math.min(K,D.maxZoom):K)}var de={latlng:v,bounds:w,timestamp:n.timestamp};for(var ge in n.coords)typeof n.coords[ge]=="number"&&(de[ge]=n.coords[ge]);this.fire("locationfound",de)}},addHandler:function(n,r){if(!r)return this;var d=this[n]=new r(this);return this._handlers.push(d),this.options[n]&&d.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Lt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(pe(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)Lt(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,r){var d="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),v=rt("div",d,r||this._mapPane);return n&&(this._panes[n]=v),v},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),r=this.unproject(n.getBottomLeft()),d=this.unproject(n.getTopRight());return new ne(r,d)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,r,d){n=Ee(n),d=te(d||[0,0]);var v=this.getZoom()||0,w=this.getMinZoom(),D=this.getMaxZoom(),K=n.getNorthWest(),de=n.getSouthEast(),ge=this.getSize().subtract(d),Ae=Oe(this.project(de,v),this.project(K,v)).getSize(),Ke=Je.any3d?this.options.zoomSnap:1,ot=ge.x/Ae.x,pt=ge.y/Ae.y,cn=r?Math.max(ot,pt):Math.min(ot,pt);return v=this.getScaleZoom(cn,v),Ke&&(v=Math.round(v/(Ke/100))*(Ke/100),v=r?Math.ceil(v/Ke)*Ke:Math.floor(v/Ke)*Ke),Math.max(w,Math.min(D,v))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new X(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,r){var d=this._getTopLeftPoint(n,r);return new be(d,d.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,r){var d=this.options.crs;return r=r===void 0?this._zoom:r,d.scale(n)/d.scale(r)},getScaleZoom:function(n,r){var d=this.options.crs;r=r===void 0?this._zoom:r;var v=d.zoom(n*d.scale(r));return isNaN(v)?1/0:v},project:function(n,r){return r=r===void 0?this._zoom:r,this.options.crs.latLngToPoint(we(n),r)},unproject:function(n,r){return r=r===void 0?this._zoom:r,this.options.crs.pointToLatLng(te(n),r)},layerPointToLatLng:function(n){var r=te(n).add(this.getPixelOrigin());return this.unproject(r)},latLngToLayerPoint:function(n){var r=this.project(we(n))._round();return r._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(we(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(Ee(n))},distance:function(n,r){return this.options.crs.distance(we(n),we(r))},containerPointToLayerPoint:function(n){return te(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return te(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var r=this.containerPointToLayerPoint(te(n));return this.layerPointToLatLng(r)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(we(n)))},mouseEventToContainerPoint:function(n){return qa(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var r=this._container=ci(n);if(r){if(r._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");ut(r,"scroll",this._onScroll,this),this._containerId=h(r)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&Je.any3d,lt(n,"leaflet-container"+(Je.touch?" leaflet-touch":"")+(Je.retina?" leaflet-retina":"")+(Je.ielt9?" leaflet-oldie":"")+(Je.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var r=Fn(n,"position");r!=="absolute"&&r!=="relative"&&r!=="fixed"&&r!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Tt(this._mapPane,new X(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(lt(n.markerPane,"leaflet-zoom-hide"),lt(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,r,d){Tt(this._mapPane,new X(0,0));var v=!this._loaded;this._loaded=!0,r=this._limitZoom(r),this.fire("viewprereset");var w=this._zoom!==r;this._moveStart(w,d)._move(n,r)._moveEnd(w),this.fire("viewreset"),v&&this.fire("load")},_moveStart:function(n,r){return n&&this.fire("zoomstart"),r||this.fire("movestart"),this},_move:function(n,r,d,v){r===void 0&&(r=this._zoom);var w=this._zoom!==r;return this._zoom=r,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),v?d&&d.pinch&&this.fire("zoom",d):((w||d&&d.pinch)&&this.fire("zoom",d),this.fire("move",d)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return pe(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){Tt(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[h(this._container)]=this;var r=n?kt:ut;r(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&r(window,"resize",this._onResize,this),Je.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){pe(this._resizeRequest),this._resizeRequest=ae(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,r){for(var d=[],v,w=r==="mouseout"||r==="mouseover",D=n.target||n.srcElement,K=!1;D;){if(v=this._targets[h(D)],v&&(r==="click"||r==="preclick")&&this._draggableMoved(v)){K=!0;break}if(v&&v.listens(r,!0)&&(w&&!Ji(D,n)||(d.push(v),w))||D===this._container)break;D=D.parentNode}return!d.length&&!K&&!w&&this.listens(r,!0)&&(d=[this]),d},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var r=n.target||n.srcElement;if(!(!this._loaded||r._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(r))){var d=n.type;d==="mousedown"&&Bs(r),this._fireDOMEvent(n,d)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,r,d){if(n.type==="click"){var v=s({},n);v.type="preclick",this._fireDOMEvent(v,v.type,d)}var w=this._findEventTargets(n,r);if(d){for(var D=[],K=0;K<d.length;K++)d[K].listens(r,!0)&&D.push(d[K]);w=D.concat(w)}if(w.length){r==="contextmenu"&&Gt(n);var de=w[0],ge={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var Ae=de.getLatLng&&(!de._radius||de._radius<=10);ge.containerPoint=Ae?this.latLngToContainerPoint(de.getLatLng()):this.mouseEventToContainerPoint(n),ge.layerPoint=this.containerPointToLayerPoint(ge.containerPoint),ge.latlng=Ae?de.getLatLng():this.layerPointToLatLng(ge.layerPoint)}for(K=0;K<w.length;K++)if(w[K].fire(r,ge,!0),ge.originalEvent._stopped||w[K].options.bubblingMouseEvents===!1&&x(this._mouseEvents,r)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,r=this._handlers.length;n<r;n++)this._handlers[n].disable()},whenReady:function(n,r){return this._loaded?n.call(r||this,{target:this}):this.on("load",n,r),this},_getMapPanePos:function(){return V(this._mapPane)||new X(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,r){var d=n&&r!==void 0?this._getNewPixelOrigin(n,r):this.getPixelOrigin();return d.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,r){var d=this.getSize()._divideBy(2);return this.project(n,r)._subtract(d)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,r,d){var v=this._getNewPixelOrigin(d,r);return this.project(n,r)._subtract(v)},_latLngBoundsToNewLayerBounds:function(n,r,d){var v=this._getNewPixelOrigin(d,r);return Oe([this.project(n.getSouthWest(),r)._subtract(v),this.project(n.getNorthWest(),r)._subtract(v),this.project(n.getSouthEast(),r)._subtract(v),this.project(n.getNorthEast(),r)._subtract(v)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,r,d){if(!d)return n;var v=this.project(n,r),w=this.getSize().divideBy(2),D=new be(v.subtract(w),v.add(w)),K=this._getBoundsOffset(D,d,r);return Math.abs(K.x)<=1&&Math.abs(K.y)<=1?n:this.unproject(v.add(K),r)},_limitOffset:function(n,r){if(!r)return n;var d=this.getPixelBounds(),v=new be(d.min.add(n),d.max.add(n));return n.add(this._getBoundsOffset(v,r))},_getBoundsOffset:function(n,r,d){var v=Oe(this.project(r.getNorthEast(),d),this.project(r.getSouthWest(),d)),w=v.min.subtract(n.min),D=v.max.subtract(n.max),K=this._rebound(w.x,-D.x),de=this._rebound(w.y,-D.y);return new X(K,de)},_rebound:function(n,r){return n+r>0?Math.round(n-r)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(r))},_limitZoom:function(n){var r=this.getMinZoom(),d=this.getMaxZoom(),v=Je.any3d?this.options.zoomSnap:1;return v&&(n=Math.round(n/v)*v),Math.max(r,Math.min(d,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Mt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,r){var d=this._getCenterOffset(n)._trunc();return(r&&r.animate)!==!0&&!this.getSize().contains(d)?!1:(this.panBy(d,r),!0)},_createAnimProxy:function(){var n=this._proxy=rt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(r){var d=us,v=this._proxy.style[d];Vn(this._proxy,this.project(r.center,r.zoom),this.getZoomScale(r.zoom,1)),v===this._proxy.style[d]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Lt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),r=this.getZoom();Vn(this._proxy,this.project(n,r),this.getZoomScale(r,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,r,d){if(this._animatingZoom)return!0;if(d=d||{},!this._zoomAnimated||d.animate===!1||this._nothingToAnimate()||Math.abs(r-this._zoom)>this.options.zoomAnimationThreshold)return!1;var v=this.getZoomScale(r),w=this._getCenterOffset(n)._divideBy(1-1/v);return d.animate!==!0&&!this.getSize().contains(w)?!1:(ae(function(){this._moveStart(!0,d.noMoveStart||!1)._animateZoom(n,r,!0)},this),!0)},_animateZoom:function(n,r,d,v){this._mapPane&&(d&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=r,lt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:r,noUpdate:v}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Mt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Ml(n,r){return new mt(n,r)}var Mn=Be.extend({options:{position:"topright"},initialize:function(n){b(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var r=this._map;return r&&r.removeControl(this),this.options.position=n,r&&r.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var r=this._container=this.onAdd(n),d=this.getPosition(),v=n._controlCorners[d];return lt(r,"leaflet-control"),d.indexOf("bottom")!==-1?v.insertBefore(r,v.firstChild):v.appendChild(r),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Lt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),Fs=function(n){return new Mn(n)};mt.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},r="leaflet-",d=this._controlContainer=rt("div",r+"control-container",this._container);function v(w,D){var K=r+w+" "+r+D;n[w+D]=rt("div",K,d)}v("top","left"),v("top","right"),v("bottom","left"),v("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)Lt(this._controlCorners[n]);Lt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Xa=Mn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,r,d,v){return d<v?-1:v<d?1:0}},initialize:function(n,r,d){b(this,d),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var v in n)this._addLayer(n[v],v);for(v in r)this._addLayer(r[v],v,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return Mn.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,r){return this._addLayer(n,r),this._map?this._update():this},addOverlay:function(n,r){return this._addLayer(n,r,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var r=this._getLayer(h(n));return r&&this._layers.splice(this._layers.indexOf(r),1),this._map?this._update():this},expand:function(){lt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(lt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):Mt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Mt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",r=this._container=rt("div",n),d=this.options.collapsed;r.setAttribute("aria-haspopup",!0),Ns(r),Ki(r);var v=this._section=rt("section",n+"-list");d&&(this._map.on("click",this.collapse,this),ut(r,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var w=this._layersLink=rt("a",n+"-toggle",r);w.href="#",w.title="Layers",w.setAttribute("role","button"),ut(w,{keydown:function(D){D.keyCode===13&&this._expandSafely()},click:function(D){Gt(D),this._expandSafely()}},this),d||this.expand(),this._baseLayersList=rt("div",n+"-base",v),this._separator=rt("div",n+"-separator",v),this._overlaysList=rt("div",n+"-overlays",v),r.appendChild(v)},_getLayer:function(n){for(var r=0;r<this._layers.length;r++)if(this._layers[r]&&h(this._layers[r].layer)===n)return this._layers[r]},_addLayer:function(n,r,d){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:r,overlay:d}),this.options.sortLayers&&this._layers.sort(l(function(v,w){return this.options.sortFunction(v.layer,w.layer,v.name,w.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;to(this._baseLayersList),to(this._overlaysList),this._layerControlInputs=[];var n,r,d,v,w=0;for(d=0;d<this._layers.length;d++)v=this._layers[d],this._addItem(v),r=r||v.overlay,n=n||!v.overlay,w+=v.overlay?0:1;return this.options.hideSingleBase&&(n=n&&w>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=r&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var r=this._getLayer(h(n.target)),d=r.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;d&&this._map.fire(d,r)},_createRadioElement:function(n,r){var d='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(r?' checked="checked"':"")+"/>",v=document.createElement("div");return v.innerHTML=d,v.firstChild},_addItem:function(n){var r=document.createElement("label"),d=this._map.hasLayer(n.layer),v;n.overlay?(v=document.createElement("input"),v.type="checkbox",v.className="leaflet-control-layers-selector",v.defaultChecked=d):v=this._createRadioElement("leaflet-base-layers_"+h(this),d),this._layerControlInputs.push(v),v.layerId=h(n.layer),ut(v,"click",this._onInputClick,this);var w=document.createElement("span");w.innerHTML=" "+n.name;var D=document.createElement("span");r.appendChild(D),D.appendChild(v),D.appendChild(w);var K=n.overlay?this._overlaysList:this._baseLayersList;return K.appendChild(r),this._checkDisabledLayers(),r},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,r,d,v=[],w=[];this._handlingClick=!0;for(var D=n.length-1;D>=0;D--)r=n[D],d=this._getLayer(r.layerId).layer,r.checked?v.push(d):r.checked||w.push(d);for(D=0;D<w.length;D++)this._map.hasLayer(w[D])&&this._map.removeLayer(w[D]);for(D=0;D<v.length;D++)this._map.hasLayer(v[D])||this._map.addLayer(v[D]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,r,d,v=this._map.getZoom(),w=n.length-1;w>=0;w--)r=n[w],d=this._getLayer(r.layerId).layer,r.disabled=d.options.minZoom!==void 0&&v<d.options.minZoom||d.options.maxZoom!==void 0&&v>d.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,ut(n,"click",Gt),this.expand();var r=this;setTimeout(function(){kt(n,"click",Gt),r._preventClick=!1})}}),Al=function(n,r,d){return new Xa(n,r,d)},Xi=Mn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var r="leaflet-control-zoom",d=rt("div",r+" leaflet-bar"),v=this.options;return this._zoomInButton=this._createButton(v.zoomInText,v.zoomInTitle,r+"-in",d,this._zoomIn),this._zoomOutButton=this._createButton(v.zoomOutText,v.zoomOutTitle,r+"-out",d,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),d},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,r,d,v,w){var D=rt("a",d,v);return D.innerHTML=n,D.href="#",D.title=r,D.setAttribute("role","button"),D.setAttribute("aria-label",r),Ns(D),ut(D,"click",Do),ut(D,"click",w,this),ut(D,"click",this._refocusOnMap,this),D},_updateDisabled:function(){var n=this._map,r="leaflet-disabled";Mt(this._zoomInButton,r),Mt(this._zoomOutButton,r),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(lt(this._zoomOutButton,r),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(lt(this._zoomInButton,r),this._zoomInButton.setAttribute("aria-disabled","true"))}});mt.mergeOptions({zoomControl:!0}),mt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Xi,this.addControl(this.zoomControl))});var fi=function(n){return new Xi(n)},Qa=Mn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var r="leaflet-control-scale",d=rt("div",r),v=this.options;return this._addScales(v,r+"-line",d),n.on(v.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),d},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,r,d){n.metric&&(this._mScale=rt("div",r,d)),n.imperial&&(this._iScale=rt("div",r,d))},_update:function(){var n=this._map,r=n.getSize().y/2,d=n.distance(n.containerPointToLatLng([0,r]),n.containerPointToLatLng([this.options.maxWidth,r]));this._updateScales(d)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var r=this._getRoundNum(n),d=r<1e3?r+" m":r/1e3+" km";this._updateScale(this._mScale,d,r/n)},_updateImperial:function(n){var r=n*3.2808399,d,v,w;r>5280?(d=r/5280,v=this._getRoundNum(d),this._updateScale(this._iScale,v+" mi",v/d)):(w=this._getRoundNum(r),this._updateScale(this._iScale,w+" ft",w/r))},_updateScale:function(n,r,d){n.style.width=Math.round(this.options.maxWidth*d)+"px",n.innerHTML=r},_getRoundNum:function(n){var r=Math.pow(10,(Math.floor(n)+"").length-1),d=n/r;return d=d>=10?10:d>=5?5:d>=3?3:d>=2?2:1,r*d}}),pi=function(n){return new Qa(n)},El='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',vi=Mn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Je.inlineSvg?El+" ":"")+"Leaflet</a>"},initialize:function(n){b(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=rt("div","leaflet-control-attribution"),Ns(this._container);for(var r in n._layers)n._layers[r].getAttribution&&this.addAttribution(n._layers[r].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var r in this._attributions)this._attributions[r]&&n.push(r);var d=[];this.options.prefix&&d.push(this.options.prefix),n.length&&d.push(n.join(", ")),this._container.innerHTML=d.join(' <span aria-hidden="true">|</span> ')}}});mt.mergeOptions({attributionControl:!0}),mt.addInitHook(function(){this.options.attributionControl&&new vi().addTo(this)});var Qi=function(n){return new vi(n)};Mn.Layers=Xa,Mn.Zoom=Xi,Mn.Scale=Qa,Mn.Attribution=vi,Fs.layers=Al,Fs.zoom=fi,Fs.scale=pi,Fs.attribution=Qi;var gn=Be.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});gn.addTo=function(n,r){return n.addHandler(r,this),this};var Pl={Events:he},er=Je.touch?"touchstart mousedown":"mousedown",yo=Q.extend({options:{clickTolerance:3},initialize:function(n,r,d,v){b(this,v),this._element=n,this._dragStartTarget=r||n,this._preventOutline=d},enable:function(){this._enabled||(ut(this._dragStartTarget,er,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(yo._dragging===this&&this.finishDrag(!0),kt(this._dragStartTarget,er,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!no(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){yo._dragging===this&&this.finishDrag();return}if(!(yo._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(yo._dragging=this,this._preventOutline&&Bs(this._element),it(),G(),!this._moving)){this.fire("down");var r=n.touches?n.touches[0]:n,d=di(this._element);this._startPoint=new X(r.clientX,r.clientY),this._startPos=V(this._element),this._parentScale=ji(d);var v=n.type==="mousedown";ut(document,v?"mousemove":"touchmove",this._onMove,this),ut(document,v?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var r=n.touches&&n.touches.length===1?n.touches[0]:n,d=new X(r.clientX,r.clientY)._subtract(this._startPoint);!d.x&&!d.y||Math.abs(d.x)+Math.abs(d.y)<this.options.clickTolerance||(d.x/=this._parentScale.x,d.y/=this._parentScale.y,Gt(n),this._moved||(this.fire("dragstart"),this._moved=!0,lt(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),lt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(d),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),Tt(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){Mt(document.body,"leaflet-dragging"),this._lastTarget&&(Mt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),kt(document,"mousemove touchmove",this._onMove,this),kt(document,"mouseup touchend touchcancel",this._onUp,this),Rt(),ie();var r=this._moved&&this._moving;this._moving=!1,yo._dragging=!1,r&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function tr(n,r,d){var v,w=[1,4,2,8],D,K,de,ge,Ae,Ke,ot,pt;for(D=0,Ke=n.length;D<Ke;D++)n[D]._code=Oo(n[D],r);for(de=0;de<4;de++){for(ot=w[de],v=[],D=0,Ke=n.length,K=Ke-1;D<Ke;K=D++)ge=n[D],Ae=n[K],ge._code&ot?Ae._code&ot||(pt=ps(Ae,ge,ot,r,d),pt._code=Oo(pt,r),v.push(pt)):(Ae._code&ot&&(pt=ps(Ae,ge,ot,r,d),pt._code=Oo(pt,r),v.push(pt)),v.push(ge));n=v}return n}function nr(n,r){var d,v,w,D,K,de,ge,Ae,Ke;if(!n||n.length===0)throw new Error("latlngs not passed");yn(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var ot=we([0,0]),pt=Ee(n),cn=pt.getNorthWest().distanceTo(pt.getSouthWest())*pt.getNorthEast().distanceTo(pt.getNorthWest());cn<1700&&(ot=ea(n));var Wt=n.length,Zn=[];for(d=0;d<Wt;d++){var _n=we(n[d]);Zn.push(r.project(we([_n.lat-ot.lat,_n.lng-ot.lng])))}for(de=ge=Ae=0,d=0,v=Wt-1;d<Wt;v=d++)w=Zn[d],D=Zn[v],K=w.y*D.x-D.y*w.x,ge+=(w.x+D.x)*K,Ae+=(w.y+D.y)*K,de+=K*3;de===0?Ke=Zn[0]:Ke=[ge/de,Ae/de];var wi=r.unproject(te(Ke));return we([wi.lat+ot.lat,wi.lng+ot.lng])}function ea(n){for(var r=0,d=0,v=0,w=0;w<n.length;w++){var D=we(n[w]);r+=D.lat,d+=D.lng,v++}return we([r/v,d/v])}var Dl={__proto__:null,clipPolygon:tr,polygonCenter:nr,centroid:ea};function or(n,r){if(!r||!n.length)return n.slice();var d=r*r;return n=Rl(n,d),n=Ol(n,d),n}function sr(n,r,d){return Math.sqrt(Us(n,r,d,!0))}function ir(n,r,d){return Us(n,r,d)}function Ol(n,r){var d=n.length,v=typeof Uint8Array<"u"?Uint8Array:Array,w=new v(d);w[0]=w[d-1]=1,mi(n,w,r,0,d-1);var D,K=[];for(D=0;D<d;D++)w[D]&&K.push(n[D]);return K}function mi(n,r,d,v,w){var D=0,K,de,ge;for(de=v+1;de<=w-1;de++)ge=Us(n[de],n[v],n[w],!0),ge>D&&(K=de,D=ge);D>d&&(r[K]=1,mi(n,r,d,v,K),mi(n,r,d,K,w))}function Rl(n,r){for(var d=[n[0]],v=1,w=0,D=n.length;v<D;v++)lr(n[v],n[w])>r&&(d.push(n[v]),w=v);return w<D-1&&d.push(n[D-1]),d}var ar;function rr(n,r,d,v,w){var D=v?ar:Oo(n,d),K=Oo(r,d),de,ge,Ae;for(ar=K;;){if(!(D|K))return[n,r];if(D&K)return!1;de=D||K,ge=ps(n,r,de,d,w),Ae=Oo(ge,d),de===D?(n=ge,D=Ae):(r=ge,K=Ae)}}function ps(n,r,d,v,w){var D=r.x-n.x,K=r.y-n.y,de=v.min,ge=v.max,Ae,Ke;return d&8?(Ae=n.x+D*(ge.y-n.y)/K,Ke=ge.y):d&4?(Ae=n.x+D*(de.y-n.y)/K,Ke=de.y):d&2?(Ae=ge.x,Ke=n.y+K*(ge.x-n.x)/D):d&1&&(Ae=de.x,Ke=n.y+K*(de.x-n.x)/D),new X(Ae,Ke,w)}function Oo(n,r){var d=0;return n.x<r.min.x?d|=1:n.x>r.max.x&&(d|=2),n.y<r.min.y?d|=4:n.y>r.max.y&&(d|=8),d}function lr(n,r){var d=r.x-n.x,v=r.y-n.y;return d*d+v*v}function Us(n,r,d,v){var w=r.x,D=r.y,K=d.x-w,de=d.y-D,ge=K*K+de*de,Ae;return ge>0&&(Ae=((n.x-w)*K+(n.y-D)*de)/ge,Ae>1?(w=d.x,D=d.y):Ae>0&&(w+=K*Ae,D+=de*Ae)),K=n.x-w,de=n.y-D,v?K*K+de*de:new X(w,D)}function yn(n){return!C(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function vs(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),yn(n)}function ta(n,r){var d,v,w,D,K,de,ge,Ae;if(!n||n.length===0)throw new Error("latlngs not passed");yn(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var Ke=we([0,0]),ot=Ee(n),pt=ot.getNorthWest().distanceTo(ot.getSouthWest())*ot.getNorthEast().distanceTo(ot.getNorthWest());pt<1700&&(Ke=ea(n));var cn=n.length,Wt=[];for(d=0;d<cn;d++){var Zn=we(n[d]);Wt.push(r.project(we([Zn.lat-Ke.lat,Zn.lng-Ke.lng])))}for(d=0,v=0;d<cn-1;d++)v+=Wt[d].distanceTo(Wt[d+1])/2;if(v===0)Ae=Wt[0];else for(d=0,D=0;d<cn-1;d++)if(K=Wt[d],de=Wt[d+1],w=K.distanceTo(de),D+=w,D>v){ge=(D-v)/w,Ae=[de.x-ge*(de.x-K.x),de.y-ge*(de.y-K.y)];break}var _n=r.unproject(te(Ae));return we([_n.lat+Ke.lat,_n.lng+Ke.lng])}var cr={__proto__:null,simplify:or,pointToSegmentDistance:sr,closestPointOnSegment:ir,clipSegment:rr,_getEdgeIntersection:ps,_getBitCode:Oo,_sqClosestPointOnSegment:Us,isFlat:yn,_flat:vs,polylineCenter:ta},gi={project:function(n){return new X(n.lng,n.lat)},unproject:function(n){return new xe(n.y,n.x)},bounds:new be([-180,-90],[180,90])},F={R:6378137,R_MINOR:6356752314245179e-9,bounds:new be([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var r=Math.PI/180,d=this.R,v=n.lat*r,w=this.R_MINOR/d,D=Math.sqrt(1-w*w),K=D*Math.sin(v),de=Math.tan(Math.PI/4-v/2)/Math.pow((1-K)/(1+K),D/2);return v=-d*Math.log(Math.max(de,1e-10)),new X(n.lng*r*d,v)},unproject:function(n){for(var r=180/Math.PI,d=this.R,v=this.R_MINOR/d,w=Math.sqrt(1-v*v),D=Math.exp(-n.y/d),K=Math.PI/2-2*Math.atan(D),de=0,ge=.1,Ae;de<15&&Math.abs(ge)>1e-7;de++)Ae=w*Math.sin(K),Ae=Math.pow((1-Ae)/(1+Ae),w/2),ge=Math.PI/2-2*Math.atan(D*Ae)-K,K+=ge;return new xe(K*r,n.x*r/d)}},le={__proto__:null,LonLat:gi,Mercator:F,SphericalMercator:fe},De=s({},ve,{code:"EPSG:3395",projection:F,transformation:(function(){var n=.5/(Math.PI*F.R);return U(n,.5,-n,.5)})()}),Pe=s({},ve,{code:"EPSG:4326",projection:gi,transformation:U(1/180,1,-1/180,.5)}),_t=s({},re,{projection:gi,transformation:U(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,r){var d=r.lng-n.lng,v=r.lat-n.lat;return Math.sqrt(d*d+v*v)},infinite:!0});re.Earth=ve,re.EPSG3395=De,re.EPSG3857=H,re.EPSG900913=Y,re.EPSG4326=Pe,re.Simple=_t;var Et=Q.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[h(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[h(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var r=n.target;if(r.hasLayer(this)){if(this._map=r,this._zoomAnimated=r._zoomAnimated,this.getEvents){var d=this.getEvents();r.on(d,this),this.once("remove",function(){r.off(d,this)},this)}this.onAdd(r),this.fire("add"),r.fire("layeradd",{layer:this})}}});mt.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var r=h(n);return this._layers[r]?this:(this._layers[r]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var r=h(n);return this._layers[r]?(this._loaded&&n.onRemove(this),delete this._layers[r],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return h(n)in this._layers},eachLayer:function(n,r){for(var d in this._layers)n.call(r,this._layers[d]);return this},_addLayers:function(n){n=n?C(n)?n:[n]:[];for(var r=0,d=n.length;r<d;r++)this.addLayer(n[r])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[h(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var r=h(n);this._zoomBoundLayers[r]&&(delete this._zoomBoundLayers[r],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,r=-1/0,d=this._getZoomSpan();for(var v in this._zoomBoundLayers){var w=this._zoomBoundLayers[v].options;n=w.minZoom===void 0?n:Math.min(n,w.minZoom),r=w.maxZoom===void 0?r:Math.max(r,w.maxZoom)}this._layersMaxZoom=r===-1/0?void 0:r,this._layersMinZoom=n===1/0?void 0:n,d!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var tn=Et.extend({initialize:function(n,r){b(this,r),this._layers={};var d,v;if(n)for(d=0,v=n.length;d<v;d++)this.addLayer(n[d])},addLayer:function(n){var r=this.getLayerId(n);return this._layers[r]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var r=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[r]&&this._map.removeLayer(this._layers[r]),delete this._layers[r],this},hasLayer:function(n){var r=typeof n=="number"?n:this.getLayerId(n);return r in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var r=Array.prototype.slice.call(arguments,1),d,v;for(d in this._layers)v=this._layers[d],v[n]&&v[n].apply(v,r);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,r){for(var d in this._layers)n.call(r,this._layers[d]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return h(n)}}),zs=function(n,r){return new tn(n,r)},Ro=tn.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),tn.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),tn.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new ne;for(var r in this._layers){var d=this._layers[r];n.extend(d.getBounds?d.getBounds():d.getLatLng())}return n}}),Wp=function(n,r){return new Ro(n,r)},yi=Be.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){b(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,r){var d=this._getIconUrl(n);if(!d){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var v=this._createImg(d,r&&r.tagName==="IMG"?r:null);return this._setIconStyles(v,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),v},_setIconStyles:function(n,r){var d=this.options,v=d[r+"Size"];typeof v=="number"&&(v=[v,v]);var w=te(v),D=te(r==="shadow"&&d.shadowAnchor||d.iconAnchor||w&&w.divideBy(2,!0));n.className="leaflet-marker-"+r+" "+(d.className||""),D&&(n.style.marginLeft=-D.x+"px",n.style.marginTop=-D.y+"px"),w&&(n.style.width=w.x+"px",n.style.height=w.y+"px")},_createImg:function(n,r){return r=r||document.createElement("img"),r.src=n,r},_getIconUrl:function(n){return Je.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function qp(n){return new yi(n)}var na=yi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof na.imagePath!="string"&&(na.imagePath=this._detectIconPath()),(this.options.imagePath||na.imagePath)+yi.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var r=function(d,v,w){var D=v.exec(d);return D&&D[w]};return n=r(n,/^url\((['"])?(.+)\1\)$/,2),n&&r(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=rt("div","leaflet-default-icon-path",document.body),r=Fn(n,"background-image")||Fn(n,"backgroundImage");if(document.body.removeChild(n),r=this._stripUrl(r),r)return r;var d=document.querySelector('link[href$="leaflet.css"]');return d?d.href.substring(0,d.href.length-11-1):""}}),yu=gn.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new yo(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),lt(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Mt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var r=this._marker,d=r._map,v=this._marker.options.autoPanSpeed,w=this._marker.options.autoPanPadding,D=V(r._icon),K=d.getPixelBounds(),de=d.getPixelOrigin(),ge=Oe(K.min._subtract(de).add(w),K.max._subtract(de).subtract(w));if(!ge.contains(D)){var Ae=te((Math.max(ge.max.x,D.x)-ge.max.x)/(K.max.x-ge.max.x)-(Math.min(ge.min.x,D.x)-ge.min.x)/(K.min.x-ge.min.x),(Math.max(ge.max.y,D.y)-ge.max.y)/(K.max.y-ge.max.y)-(Math.min(ge.min.y,D.y)-ge.min.y)/(K.min.y-ge.min.y)).multiplyBy(v);d.panBy(Ae,{animate:!1}),this._draggable._newPos._add(Ae),this._draggable._startPos._add(Ae),Tt(r._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=ae(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(pe(this._panRequest),this._panRequest=ae(this._adjustPan.bind(this,n)))},_onDrag:function(n){var r=this._marker,d=r._shadow,v=V(r._icon),w=r._map.layerPointToLatLng(v);d&&Tt(d,v),r._latlng=w,n.latlng=w,n.oldLatLng=this._oldLatLng,r.fire("move",n).fire("drag",n)},_onDragEnd:function(n){pe(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),ur=Et.extend({options:{icon:new na,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,r){b(this,r),this._latlng=we(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var r=this._latlng;return this._latlng=we(n),this.update(),this.fire("move",{oldLatLng:r,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,r="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),d=n.icon.createIcon(this._icon),v=!1;d!==this._icon&&(this._icon&&this._removeIcon(),v=!0,n.title&&(d.title=n.title),d.tagName==="IMG"&&(d.alt=n.alt||"")),lt(d,r),n.keyboard&&(d.tabIndex="0",d.setAttribute("role","button")),this._icon=d,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ut(d,"focus",this._panOnFocus,this);var w=n.icon.createShadow(this._shadow),D=!1;w!==this._shadow&&(this._removeShadow(),D=!0),w&&(lt(w,r),w.alt=""),this._shadow=w,n.opacity<1&&this._updateOpacity(),v&&this.getPane().appendChild(this._icon),this._initInteraction(),w&&D&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&kt(this._icon,"focus",this._panOnFocus,this),Lt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Lt(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&Tt(this._icon,n),this._shadow&&Tt(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var r=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(r)},_initInteraction:function(){if(this.options.interactive&&(lt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),yu)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new yu(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&Jt(this._icon,n),this._shadow&&Jt(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var r=this.options.icon.options,d=r.iconSize?te(r.iconSize):te(0,0),v=r.iconAnchor?te(r.iconAnchor):te(0,0);n.panInside(this._latlng,{paddingTopLeft:v,paddingBottomRight:d.subtract(v)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Kp(n,r){return new ur(n,r)}var ms=Et.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return b(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),dr=ms.extend({options:{fill:!0,radius:10},initialize:function(n,r){b(this,r),this._latlng=we(n),this._radius=this.options.radius},setLatLng:function(n){var r=this._latlng;return this._latlng=we(n),this.redraw(),this.fire("move",{oldLatLng:r,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var r=n&&n.radius||this._radius;return ms.prototype.setStyle.call(this,n),this.setRadius(r),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,r=this._radiusY||n,d=this._clickTolerance(),v=[n+d,r+d];this._pxBounds=new be(this._point.subtract(v),this._point.add(v))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Yp(n,r){return new dr(n,r)}var Bl=dr.extend({initialize:function(n,r,d){if(typeof r=="number"&&(r=s({},d,{radius:r})),b(this,r),this._latlng=we(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new ne(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:ms.prototype.setStyle,_project:function(){var n=this._latlng.lng,r=this._latlng.lat,d=this._map,v=d.options.crs;if(v.distance===ve.distance){var w=Math.PI/180,D=this._mRadius/ve.R/w,K=d.project([r+D,n]),de=d.project([r-D,n]),ge=K.add(de).divideBy(2),Ae=d.unproject(ge).lat,Ke=Math.acos((Math.cos(D*w)-Math.sin(r*w)*Math.sin(Ae*w))/(Math.cos(r*w)*Math.cos(Ae*w)))/w;(isNaN(Ke)||Ke===0)&&(Ke=D/Math.cos(Math.PI/180*r)),this._point=ge.subtract(d.getPixelOrigin()),this._radius=isNaN(Ke)?0:ge.x-d.project([Ae,n-Ke]).x,this._radiusY=ge.y-K.y}else{var ot=v.unproject(v.project(this._latlng).subtract([this._mRadius,0]));this._point=d.latLngToLayerPoint(this._latlng),this._radius=this._point.x-d.latLngToLayerPoint(ot).x}this._updateBounds()}});function Jp(n,r,d){return new Bl(n,r,d)}var Bo=ms.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,r){b(this,r),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var r=1/0,d=null,v=Us,w,D,K=0,de=this._parts.length;K<de;K++)for(var ge=this._parts[K],Ae=1,Ke=ge.length;Ae<Ke;Ae++){w=ge[Ae-1],D=ge[Ae];var ot=v(n,w,D,!0);ot<r&&(r=ot,d=v(n,w,D))}return d&&(d.distance=Math.sqrt(r)),d},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ta(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,r){return r=r||this._defaultShape(),n=we(n),r.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new ne,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return yn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var r=[],d=yn(n),v=0,w=n.length;v<w;v++)d?(r[v]=we(n[v]),this._bounds.extend(r[v])):r[v]=this._convertLatLngs(n[v]);return r},_project:function(){var n=new be;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),r=new X(n,n);this._rawPxBounds&&(this._pxBounds=new be([this._rawPxBounds.min.subtract(r),this._rawPxBounds.max.add(r)]))},_projectLatlngs:function(n,r,d){var v=n[0]instanceof xe,w=n.length,D,K;if(v){for(K=[],D=0;D<w;D++)K[D]=this._map.latLngToLayerPoint(n[D]),d.extend(K[D]);r.push(K)}else for(D=0;D<w;D++)this._projectLatlngs(n[D],r,d)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var r=this._parts,d,v,w,D,K,de,ge;for(d=0,w=0,D=this._rings.length;d<D;d++)for(ge=this._rings[d],v=0,K=ge.length;v<K-1;v++)de=rr(ge[v],ge[v+1],n,v,!0),de&&(r[w]=r[w]||[],r[w].push(de[0]),(de[1]!==ge[v+1]||v===K-2)&&(r[w].push(de[1]),w++))}},_simplifyPoints:function(){for(var n=this._parts,r=this.options.smoothFactor,d=0,v=n.length;d<v;d++)n[d]=or(n[d],r)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,r){var d,v,w,D,K,de,ge=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(d=0,D=this._parts.length;d<D;d++)for(de=this._parts[d],v=0,K=de.length,w=K-1;v<K;w=v++)if(!(!r&&v===0)&&sr(n,de[w],de[v])<=ge)return!0;return!1}});function Xp(n,r){return new Bo(n,r)}Bo._flat=vs;var _i=Bo.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return nr(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var r=Bo.prototype._convertLatLngs.call(this,n),d=r.length;return d>=2&&r[0]instanceof xe&&r[0].equals(r[d-1])&&r.pop(),r},_setLatLngs:function(n){Bo.prototype._setLatLngs.call(this,n),yn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return yn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,r=this.options.weight,d=new X(r,r);if(n=new be(n.min.subtract(d),n.max.add(d)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var v=0,w=this._rings.length,D;v<w;v++)D=tr(this._rings[v],n,!0),D.length&&this._parts.push(D)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var r=!1,d,v,w,D,K,de,ge,Ae;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(D=0,ge=this._parts.length;D<ge;D++)for(d=this._parts[D],K=0,Ae=d.length,de=Ae-1;K<Ae;de=K++)v=d[K],w=d[de],v.y>n.y!=w.y>n.y&&n.x<(w.x-v.x)*(n.y-v.y)/(w.y-v.y)+v.x&&(r=!r);return r||Bo.prototype._containsPoint.call(this,n,!0)}});function Qp(n,r){return new _i(n,r)}var No=Ro.extend({initialize:function(n,r){b(this,r),this._layers={},n&&this.addData(n)},addData:function(n){var r=C(n)?n:n.features,d,v,w;if(r){for(d=0,v=r.length;d<v;d++)w=r[d],(w.geometries||w.geometry||w.features||w.coordinates)&&this.addData(w);return this}var D=this.options;if(D.filter&&!D.filter(n))return this;var K=hr(n,D);return K?(K.feature=vr(n),K.defaultOptions=K.options,this.resetStyle(K),D.onEachFeature&&D.onEachFeature(n,K),this.addLayer(K)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=s({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(r){this._setLayerStyle(r,n)},this)},_setLayerStyle:function(n,r){n.setStyle&&(typeof r=="function"&&(r=r(n.feature)),n.setStyle(r))}});function hr(n,r){var d=n.type==="Feature"?n.geometry:n,v=d?d.coordinates:null,w=[],D=r&&r.pointToLayer,K=r&&r.coordsToLatLng||Nl,de,ge,Ae,Ke;if(!v&&!d)return null;switch(d.type){case"Point":return de=K(v),_u(D,n,de,r);case"MultiPoint":for(Ae=0,Ke=v.length;Ae<Ke;Ae++)de=K(v[Ae]),w.push(_u(D,n,de,r));return new Ro(w);case"LineString":case"MultiLineString":return ge=fr(v,d.type==="LineString"?0:1,K),new Bo(ge,r);case"Polygon":case"MultiPolygon":return ge=fr(v,d.type==="Polygon"?1:2,K),new _i(ge,r);case"GeometryCollection":for(Ae=0,Ke=d.geometries.length;Ae<Ke;Ae++){var ot=hr({geometry:d.geometries[Ae],type:"Feature",properties:n.properties},r);ot&&w.push(ot)}return new Ro(w);case"FeatureCollection":for(Ae=0,Ke=d.features.length;Ae<Ke;Ae++){var pt=hr(d.features[Ae],r);pt&&w.push(pt)}return new Ro(w);default:throw new Error("Invalid GeoJSON object.")}}function _u(n,r,d,v){return n?n(r,d):new ur(d,v&&v.markersInheritOptions&&v)}function Nl(n){return new xe(n[1],n[0],n[2])}function fr(n,r,d){for(var v=[],w=0,D=n.length,K;w<D;w++)K=r?fr(n[w],r-1,d):(d||Nl)(n[w]),v.push(K);return v}function Fl(n,r){return n=we(n),n.alt!==void 0?[k(n.lng,r),k(n.lat,r),k(n.alt,r)]:[k(n.lng,r),k(n.lat,r)]}function pr(n,r,d,v){for(var w=[],D=0,K=n.length;D<K;D++)w.push(r?pr(n[D],yn(n[D])?0:r-1,d,v):Fl(n[D],v));return!r&&d&&w.length>0&&w.push(w[0].slice()),w}function ki(n,r){return n.feature?s({},n.feature,{geometry:r}):vr(r)}function vr(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var Ul={toGeoJSON:function(n){return ki(this,{type:"Point",coordinates:Fl(this.getLatLng(),n)})}};ur.include(Ul),Bl.include(Ul),dr.include(Ul),Bo.include({toGeoJSON:function(n){var r=!yn(this._latlngs),d=pr(this._latlngs,r?1:0,!1,n);return ki(this,{type:(r?"Multi":"")+"LineString",coordinates:d})}}),_i.include({toGeoJSON:function(n){var r=!yn(this._latlngs),d=r&&!yn(this._latlngs[0]),v=pr(this._latlngs,d?2:r?1:0,!0,n);return r||(v=[v]),ki(this,{type:(d?"Multi":"")+"Polygon",coordinates:v})}}),tn.include({toMultiPoint:function(n){var r=[];return this.eachLayer(function(d){r.push(d.toGeoJSON(n).geometry.coordinates)}),ki(this,{type:"MultiPoint",coordinates:r})},toGeoJSON:function(n){var r=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(r==="MultiPoint")return this.toMultiPoint(n);var d=r==="GeometryCollection",v=[];return this.eachLayer(function(w){if(w.toGeoJSON){var D=w.toGeoJSON(n);if(d)v.push(D.geometry);else{var K=vr(D);K.type==="FeatureCollection"?v.push.apply(v,K.features):v.push(K)}}}),d?ki(this,{geometries:v,type:"GeometryCollection"}):{type:"FeatureCollection",features:v}}});function ku(n,r){return new No(n,r)}var ev=ku,mr=Et.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,r,d){this._url=n,this._bounds=Ee(r),b(this,d)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(lt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Lt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&Un(this._image),this},bringToBack:function(){return this._map&&zn(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=Ee(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",r=this._image=n?this._url:rt("img");if(lt(r,"leaflet-image-layer"),this._zoomAnimated&&lt(r,"leaflet-zoom-animated"),this.options.className&&lt(r,this.options.className),r.onselectstart=y,r.onmousemove=y,r.onload=l(this.fire,this,"load"),r.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(r.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=r.src;return}r.src=this._url,r.alt=this.options.alt},_animateZoom:function(n){var r=this._map.getZoomScale(n.zoom),d=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;Vn(this._image,d,r)},_reset:function(){var n=this._image,r=new be(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),d=r.getSize();Tt(n,r.min),n.style.width=d.x+"px",n.style.height=d.y+"px"},_updateOpacity:function(){Jt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),tv=function(n,r,d){return new mr(n,r,d)},bu=mr.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",r=this._image=n?this._url:rt("video");if(lt(r,"leaflet-image-layer"),this._zoomAnimated&&lt(r,"leaflet-zoom-animated"),this.options.className&&lt(r,this.options.className),r.onselectstart=y,r.onmousemove=y,r.onloadeddata=l(this.fire,this,"load"),n){for(var d=r.getElementsByTagName("source"),v=[],w=0;w<d.length;w++)v.push(d[w].src);this._url=d.length>0?v:[r.src];return}C(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(r.style,"objectFit")&&(r.style.objectFit="fill"),r.autoplay=!!this.options.autoplay,r.loop=!!this.options.loop,r.muted=!!this.options.muted,r.playsInline=!!this.options.playsInline;for(var D=0;D<this._url.length;D++){var K=rt("source");K.src=this._url[D],r.appendChild(K)}}});function nv(n,r,d){return new bu(n,r,d)}var wu=mr.extend({_initImage:function(){var n=this._image=this._url;lt(n,"leaflet-image-layer"),this._zoomAnimated&&lt(n,"leaflet-zoom-animated"),this.options.className&&lt(n,this.options.className),n.onselectstart=y,n.onmousemove=y}});function ov(n,r,d){return new wu(n,r,d)}var _o=Et.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,r){n&&(n instanceof xe||C(n))?(this._latlng=we(n),b(this,r)):(b(this,n),this._source=r),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&Jt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&Jt(this._container,1),this.bringToFront(),this.options.interactive&&(lt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(Jt(this._container,0),this._removeTimeout=setTimeout(l(Lt,void 0,this._container),200)):Lt(this._container),this.options.interactive&&(Mt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=we(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Un(this._container),this},bringToBack:function(){return this._map&&zn(this._container),this},_prepareOpen:function(n){var r=this._source;if(!r._map)return!1;if(r instanceof Ro){r=null;var d=this._source._layers;for(var v in d)if(d[v]._map){r=d[v];break}if(!r)return!1;this._source=r}if(!n)if(r.getCenter)n=r.getCenter();else if(r.getLatLng)n=r.getLatLng();else if(r.getBounds)n=r.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,r=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof r=="string")n.innerHTML=r;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(r)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),r=te(this.options.offset),d=this._getAnchor();this._zoomAnimated?Tt(this._container,n.add(d)):r=r.add(n).add(d);var v=this._containerBottom=-r.y,w=this._containerLeft=-Math.round(this._containerWidth/2)+r.x;this._container.style.bottom=v+"px",this._container.style.left=w+"px"}},_getAnchor:function(){return[0,0]}});mt.include({_initOverlay:function(n,r,d,v){var w=r;return w instanceof n||(w=new n(v).setContent(r)),d&&w.setLatLng(d),w}}),Et.include({_initOverlay:function(n,r,d,v){var w=d;return w instanceof n?(b(w,v),w._source=this):(w=r&&!v?r:new n(v,this),w.setContent(d)),w}});var gr=_o.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,_o.prototype.openOn.call(this,n)},onAdd:function(n){_o.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ms||this._source.on("preclick",oo))},onRemove:function(n){_o.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ms||this._source.off("preclick",oo))},getEvents:function(){var n=_o.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",r=this._container=rt("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),d=this._wrapper=rt("div",n+"-content-wrapper",r);if(this._contentNode=rt("div",n+"-content",d),Ns(r),Ki(this._contentNode),ut(r,"contextmenu",oo),this._tipContainer=rt("div",n+"-tip-container",r),this._tip=rt("div",n+"-tip",this._tipContainer),this.options.closeButton){var v=this._closeButton=rt("a",n+"-close-button",r);v.setAttribute("role","button"),v.setAttribute("aria-label","Close popup"),v.href="#close",v.innerHTML='<span aria-hidden="true">&#215;</span>',ut(v,"click",function(w){Gt(w),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,r=n.style;r.width="",r.whiteSpace="nowrap";var d=n.offsetWidth;d=Math.min(d,this.options.maxWidth),d=Math.max(d,this.options.minWidth),r.width=d+1+"px",r.whiteSpace="",r.height="";var v=n.offsetHeight,w=this.options.maxHeight,D="leaflet-popup-scrolled";w&&v>w?(r.height=w+"px",lt(n,D)):Mt(n,D),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var r=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),d=this._getAnchor();Tt(this._container,r.add(d))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,r=parseInt(Fn(this._container,"marginBottom"),10)||0,d=this._container.offsetHeight+r,v=this._containerWidth,w=new X(this._containerLeft,-d-this._containerBottom);w._add(V(this._container));var D=n.layerPointToContainerPoint(w),K=te(this.options.autoPanPadding),de=te(this.options.autoPanPaddingTopLeft||K),ge=te(this.options.autoPanPaddingBottomRight||K),Ae=n.getSize(),Ke=0,ot=0;D.x+v+ge.x>Ae.x&&(Ke=D.x+v-Ae.x+ge.x),D.x-Ke-de.x<0&&(Ke=D.x-de.x),D.y+d+ge.y>Ae.y&&(ot=D.y+d-Ae.y+ge.y),D.y-ot-de.y<0&&(ot=D.y-de.y),(Ke||ot)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([Ke,ot]))}},_getAnchor:function(){return te(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),sv=function(n,r){return new gr(n,r)};mt.mergeOptions({closePopupOnClick:!0}),mt.include({openPopup:function(n,r,d){return this._initOverlay(gr,n,r,d).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),Et.include({bindPopup:function(n,r){return this._popup=this._initOverlay(gr,this._popup,n,r),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof Ro||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){Do(n);var r=n.layer||n.target;if(this._popup._source===r&&!(r instanceof ms)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=r,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var yr=_o.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){_o.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){_o.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=_o.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",r=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=rt("div",r),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+h(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var r,d,v=this._map,w=this._container,D=v.latLngToContainerPoint(v.getCenter()),K=v.layerPointToContainerPoint(n),de=this.options.direction,ge=w.offsetWidth,Ae=w.offsetHeight,Ke=te(this.options.offset),ot=this._getAnchor();de==="top"?(r=ge/2,d=Ae):de==="bottom"?(r=ge/2,d=0):de==="center"?(r=ge/2,d=Ae/2):de==="right"?(r=0,d=Ae/2):de==="left"?(r=ge,d=Ae/2):K.x<D.x?(de="right",r=0,d=Ae/2):(de="left",r=ge+(Ke.x+ot.x)*2,d=Ae/2),n=n.subtract(te(r,d,!0)).add(Ke).add(ot),Mt(w,"leaflet-tooltip-right"),Mt(w,"leaflet-tooltip-left"),Mt(w,"leaflet-tooltip-top"),Mt(w,"leaflet-tooltip-bottom"),lt(w,"leaflet-tooltip-"+de),Tt(w,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&Jt(this._container,n)},_animateZoom:function(n){var r=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(r)},_getAnchor:function(){return te(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),iv=function(n,r){return new yr(n,r)};mt.include({openTooltip:function(n,r,d){return this._initOverlay(yr,n,r,d).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),Et.include({bindTooltip:function(n,r){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(yr,this._tooltip,n,r),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var r=n?"off":"on",d={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?d.add=this._openTooltip:(d.mouseover=this._openTooltip,d.mouseout=this.closeTooltip,d.click=this._openTooltip,this._map?this._addFocusListeners():d.add=this._addFocusListeners),this._tooltip.options.sticky&&(d.mousemove=this._moveTooltip),this[r](d),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof Ro||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var r=typeof n.getElement=="function"&&n.getElement();r&&(ut(r,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),ut(r,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var r=typeof n.getElement=="function"&&n.getElement();r&&r.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var r=this;this._map.once("moveend",function(){r._openOnceFlag=!1,r._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var r=n.latlng,d,v;this._tooltip.options.sticky&&n.originalEvent&&(d=this._map.mouseEventToContainerPoint(n.originalEvent),v=this._map.containerPointToLayerPoint(d),r=this._map.layerPointToLatLng(v)),this._tooltip.setLatLng(r)}});var Cu=yi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var r=n&&n.tagName==="DIV"?n:document.createElement("div"),d=this.options;if(d.html instanceof Element?(to(r),r.appendChild(d.html)):r.innerHTML=d.html!==!1?d.html:"",d.bgPos){var v=te(d.bgPos);r.style.backgroundPosition=-v.x+"px "+-v.y+"px"}return this._setIconStyles(r,"icon"),r},createShadow:function(){return null}});function av(n){return new Cu(n)}yi.Default=na;var oa=Et.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Je.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){b(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),Lt(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Un(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(zn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof X?n:new X(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var r=this.getPane().children,d=-n(-1/0,1/0),v=0,w=r.length,D;v<w;v++)D=r[v].style.zIndex,r[v]!==this._container&&D&&(d=n(d,+D));isFinite(d)&&(this.options.zIndex=d+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Je.ielt9){Jt(this._container,this.options.opacity);var n=+new Date,r=!1,d=!1;for(var v in this._tiles){var w=this._tiles[v];if(!(!w.current||!w.loaded)){var D=Math.min(1,(n-w.loaded)/200);Jt(w.el,D),D<1?r=!0:(w.active?d=!0:this._onOpaqueTile(w),w.active=!0)}}d&&!this._noPrune&&this._pruneTiles(),r&&(pe(this._fadeFrame),this._fadeFrame=ae(this._updateOpacity,this))}},_onOpaqueTile:y,_initContainer:function(){this._container||(this._container=rt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,r=this.options.maxZoom;if(n!==void 0){for(var d in this._levels)d=Number(d),this._levels[d].el.children.length||d===n?(this._levels[d].el.style.zIndex=r-Math.abs(n-d),this._onUpdateLevel(d)):(Lt(this._levels[d].el),this._removeTilesAtZoom(d),this._onRemoveLevel(d),delete this._levels[d]);var v=this._levels[n],w=this._map;return v||(v=this._levels[n]={},v.el=rt("div","leaflet-tile-container leaflet-zoom-animated",this._container),v.el.style.zIndex=r,v.origin=w.project(w.unproject(w.getPixelOrigin()),n).round(),v.zoom=n,this._setZoomTransform(v,w.getCenter(),w.getZoom()),y(v.el.offsetWidth),this._onCreateLevel(v)),this._level=v,v}},_onUpdateLevel:y,_onRemoveLevel:y,_onCreateLevel:y,_pruneTiles:function(){if(this._map){var n,r,d=this._map.getZoom();if(d>this.options.maxZoom||d<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)r=this._tiles[n],r.retain=r.current;for(n in this._tiles)if(r=this._tiles[n],r.current&&!r.active){var v=r.coords;this._retainParent(v.x,v.y,v.z,v.z-5)||this._retainChildren(v.x,v.y,v.z,v.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var r in this._tiles)this._tiles[r].coords.z===n&&this._removeTile(r)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)Lt(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,r,d,v){var w=Math.floor(n/2),D=Math.floor(r/2),K=d-1,de=new X(+w,+D);de.z=+K;var ge=this._tileCoordsToKey(de),Ae=this._tiles[ge];return Ae&&Ae.active?(Ae.retain=!0,!0):(Ae&&Ae.loaded&&(Ae.retain=!0),K>v?this._retainParent(w,D,K,v):!1)},_retainChildren:function(n,r,d,v){for(var w=2*n;w<2*n+2;w++)for(var D=2*r;D<2*r+2;D++){var K=new X(w,D);K.z=d+1;var de=this._tileCoordsToKey(K),ge=this._tiles[de];if(ge&&ge.active){ge.retain=!0;continue}else ge&&ge.loaded&&(ge.retain=!0);d+1<v&&this._retainChildren(w,D,d+1,v)}},_resetView:function(n){var r=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),r,r)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var r=this.options;return r.minNativeZoom!==void 0&&n<r.minNativeZoom?r.minNativeZoom:r.maxNativeZoom!==void 0&&r.maxNativeZoom<n?r.maxNativeZoom:n},_setView:function(n,r,d,v){var w=Math.round(r);this.options.maxZoom!==void 0&&w>this.options.maxZoom||this.options.minZoom!==void 0&&w<this.options.minZoom?w=void 0:w=this._clampZoom(w);var D=this.options.updateWhenZooming&&w!==this._tileZoom;(!v||D)&&(this._tileZoom=w,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),w!==void 0&&this._update(n),d||this._pruneTiles(),this._noPrune=!!d),this._setZoomTransforms(n,r)},_setZoomTransforms:function(n,r){for(var d in this._levels)this._setZoomTransform(this._levels[d],n,r)},_setZoomTransform:function(n,r,d){var v=this._map.getZoomScale(d,n.zoom),w=n.origin.multiplyBy(v).subtract(this._map._getNewPixelOrigin(r,d)).round();Je.any3d?Vn(n.el,w,v):Tt(n.el,w)},_resetGrid:function(){var n=this._map,r=n.options.crs,d=this._tileSize=this.getTileSize(),v=this._tileZoom,w=this._map.getPixelWorldBounds(this._tileZoom);w&&(this._globalTileRange=this._pxBoundsToTileRange(w)),this._wrapX=r.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,r.wrapLng[0]],v).x/d.x),Math.ceil(n.project([0,r.wrapLng[1]],v).x/d.y)],this._wrapY=r.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([r.wrapLat[0],0],v).y/d.x),Math.ceil(n.project([r.wrapLat[1],0],v).y/d.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var r=this._map,d=r._animatingZoom?Math.max(r._animateToZoom,r.getZoom()):r.getZoom(),v=r.getZoomScale(d,this._tileZoom),w=r.project(n,this._tileZoom).floor(),D=r.getSize().divideBy(v*2);return new be(w.subtract(D),w.add(D))},_update:function(n){var r=this._map;if(r){var d=this._clampZoom(r.getZoom());if(n===void 0&&(n=r.getCenter()),this._tileZoom!==void 0){var v=this._getTiledPixelBounds(n),w=this._pxBoundsToTileRange(v),D=w.getCenter(),K=[],de=this.options.keepBuffer,ge=new be(w.getBottomLeft().subtract([de,-de]),w.getTopRight().add([de,-de]));if(!(isFinite(w.min.x)&&isFinite(w.min.y)&&isFinite(w.max.x)&&isFinite(w.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ae in this._tiles){var Ke=this._tiles[Ae].coords;(Ke.z!==this._tileZoom||!ge.contains(new X(Ke.x,Ke.y)))&&(this._tiles[Ae].current=!1)}if(Math.abs(d-this._tileZoom)>1){this._setView(n,d);return}for(var ot=w.min.y;ot<=w.max.y;ot++)for(var pt=w.min.x;pt<=w.max.x;pt++){var cn=new X(pt,ot);if(cn.z=this._tileZoom,!!this._isValidTile(cn)){var Wt=this._tiles[this._tileCoordsToKey(cn)];Wt?Wt.current=!0:K.push(cn)}}if(K.sort(function(_n,wi){return _n.distanceTo(D)-wi.distanceTo(D)}),K.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Zn=document.createDocumentFragment();for(pt=0;pt<K.length;pt++)this._addTile(K[pt],Zn);this._level.el.appendChild(Zn)}}}},_isValidTile:function(n){var r=this._map.options.crs;if(!r.infinite){var d=this._globalTileRange;if(!r.wrapLng&&(n.x<d.min.x||n.x>d.max.x)||!r.wrapLat&&(n.y<d.min.y||n.y>d.max.y))return!1}if(!this.options.bounds)return!0;var v=this._tileCoordsToBounds(n);return Ee(this.options.bounds).overlaps(v)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var r=this._map,d=this.getTileSize(),v=n.scaleBy(d),w=v.add(d),D=r.unproject(v,n.z),K=r.unproject(w,n.z);return[D,K]},_tileCoordsToBounds:function(n){var r=this._tileCoordsToNwSe(n),d=new ne(r[0],r[1]);return this.options.noWrap||(d=this._map.wrapLatLngBounds(d)),d},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var r=n.split(":"),d=new X(+r[0],+r[1]);return d.z=+r[2],d},_removeTile:function(n){var r=this._tiles[n];r&&(Lt(r.el),delete this._tiles[n],this.fire("tileunload",{tile:r.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){lt(n,"leaflet-tile");var r=this.getTileSize();n.style.width=r.x+"px",n.style.height=r.y+"px",n.onselectstart=y,n.onmousemove=y,Je.ielt9&&this.options.opacity<1&&Jt(n,this.options.opacity)},_addTile:function(n,r){var d=this._getTilePos(n),v=this._tileCoordsToKey(n),w=this.createTile(this._wrapCoords(n),l(this._tileReady,this,n));this._initTile(w),this.createTile.length<2&&ae(l(this._tileReady,this,n,null,w)),Tt(w,d),this._tiles[v]={el:w,coords:n,current:!0},r.appendChild(w),this.fire("tileloadstart",{tile:w,coords:n})},_tileReady:function(n,r,d){r&&this.fire("tileerror",{error:r,tile:d,coords:n});var v=this._tileCoordsToKey(n);d=this._tiles[v],d&&(d.loaded=+new Date,this._map._fadeAnimated?(Jt(d.el,0),pe(this._fadeFrame),this._fadeFrame=ae(this._updateOpacity,this)):(d.active=!0,this._pruneTiles()),r||(lt(d.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:d.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Je.ielt9||!this._map._fadeAnimated?ae(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var r=new X(this._wrapX?f(n.x,this._wrapX):n.x,this._wrapY?f(n.y,this._wrapY):n.y);return r.z=n.z,r},_pxBoundsToTileRange:function(n){var r=this.getTileSize();return new be(n.min.unscaleBy(r).floor(),n.max.unscaleBy(r).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function rv(n){return new oa(n)}var bi=oa.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,r){this._url=n,r=b(this,r),r.detectRetina&&Je.retina&&r.maxZoom>0?(r.tileSize=Math.floor(r.tileSize/2),r.zoomReverse?(r.zoomOffset--,r.minZoom=Math.min(r.maxZoom,r.minZoom+1)):(r.zoomOffset++,r.maxZoom=Math.max(r.minZoom,r.maxZoom-1)),r.minZoom=Math.max(0,r.minZoom)):r.zoomReverse?r.minZoom=Math.min(r.maxZoom,r.minZoom):r.maxZoom=Math.max(r.minZoom,r.maxZoom),typeof r.subdomains=="string"&&(r.subdomains=r.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,r){return this._url===n&&r===void 0&&(r=!0),this._url=n,r||this.redraw(),this},createTile:function(n,r){var d=document.createElement("img");return ut(d,"load",l(this._tileOnLoad,this,r,d)),ut(d,"error",l(this._tileOnError,this,r,d)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(d.referrerPolicy=this.options.referrerPolicy),d.alt="",d.src=this.getTileUrl(n),d},getTileUrl:function(n){var r={r:Je.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var d=this._globalTileRange.max.y-n.y;this.options.tms&&(r.y=d),r["-y"]=d}return A(this._url,s(r,this.options))},_tileOnLoad:function(n,r){Je.ielt9?setTimeout(l(n,this,null,r),0):n(null,r)},_tileOnError:function(n,r,d){var v=this.options.errorTileUrl;v&&r.getAttribute("src")!==v&&(r.src=v),n(d,r)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,r=this.options.maxZoom,d=this.options.zoomReverse,v=this.options.zoomOffset;return d&&(n=r-n),n+v},_getSubdomain:function(n){var r=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[r]},_abortLoading:function(){var n,r;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(r=this._tiles[n].el,r.onload=y,r.onerror=y,!r.complete)){r.src=T;var d=this._tiles[n].coords;Lt(r),delete this._tiles[n],this.fire("tileabort",{tile:r,coords:d})}},_removeTile:function(n){var r=this._tiles[n];if(r)return r.el.setAttribute("src",T),oa.prototype._removeTile.call(this,n)},_tileReady:function(n,r,d){if(!(!this._map||d&&d.getAttribute("src")===T))return oa.prototype._tileReady.call(this,n,r,d)}});function Lu(n,r){return new bi(n,r)}var Su=bi.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,r){this._url=n;var d=s({},this.defaultWmsParams);for(var v in r)v in this.options||(d[v]=r[v]);r=b(this,r);var w=r.detectRetina&&Je.retina?2:1,D=this.getTileSize();d.width=D.x*w,d.height=D.y*w,this.wmsParams=d},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var r=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[r]=this._crs.code,bi.prototype.onAdd.call(this,n)},getTileUrl:function(n){var r=this._tileCoordsToNwSe(n),d=this._crs,v=Oe(d.project(r[0]),d.project(r[1])),w=v.min,D=v.max,K=(this._wmsVersion>=1.3&&this._crs===Pe?[w.y,w.x,D.y,D.x]:[w.x,w.y,D.x,D.y]).join(","),de=bi.prototype.getTileUrl.call(this,n);return de+B(this.wmsParams,de,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+K},setParams:function(n,r){return s(this.wmsParams,n),r||this.redraw(),this}});function lv(n,r){return new Su(n,r)}bi.WMS=Su,Lu.wms=lv;var Fo=Et.extend({options:{padding:.1},initialize:function(n){b(this,n),h(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),lt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,r){var d=this._map.getZoomScale(r,this._zoom),v=this._map.getSize().multiplyBy(.5+this.options.padding),w=this._map.project(this._center,r),D=v.multiplyBy(-d).add(w).subtract(this._map._getNewPixelOrigin(n,r));Je.any3d?Vn(this._container,D,d):Tt(this._container,D)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,r=this._map.getSize(),d=this._map.containerPointToLayerPoint(r.multiplyBy(-n)).round();this._bounds=new be(d,d.add(r.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),xu=Fo.extend({options:{tolerance:0},getEvents:function(){var n=Fo.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Fo.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");ut(n,"mousemove",this._onMouseMove,this),ut(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),ut(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){pe(this._redrawRequest),delete this._ctx,Lt(this._container),kt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var r in this._layers)n=this._layers[r],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Fo.prototype._update.call(this);var n=this._bounds,r=this._container,d=n.getSize(),v=Je.retina?2:1;Tt(r,n.min),r.width=v*d.x,r.height=v*d.y,r.style.width=d.x+"px",r.style.height=d.y+"px",Je.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){Fo.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[h(n)]=n;var r=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=r),this._drawLast=r,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var r=n._order,d=r.next,v=r.prev;d?d.prev=v:this._drawLast=v,v?v.next=d:this._drawFirst=d,delete n._order,delete this._layers[h(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var r=n.options.dashArray.split(/[, ]+/),d=[],v,w;for(w=0;w<r.length;w++){if(v=Number(r[w]),isNaN(v))return;d.push(v)}n.options._dashArray=d}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||ae(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var r=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new be,this._redrawBounds.extend(n._pxBounds.min.subtract([r,r])),this._redrawBounds.extend(n._pxBounds.max.add([r,r]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var r=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,r.x,r.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,r=this._redrawBounds;if(this._ctx.save(),r){var d=r.getSize();this._ctx.beginPath(),this._ctx.rect(r.min.x,r.min.y,d.x,d.y),this._ctx.clip()}this._drawing=!0;for(var v=this._drawFirst;v;v=v.next)n=v.layer,(!r||n._pxBounds&&n._pxBounds.intersects(r))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,r){if(this._drawing){var d,v,w,D,K=n._parts,de=K.length,ge=this._ctx;if(de){for(ge.beginPath(),d=0;d<de;d++){for(v=0,w=K[d].length;v<w;v++)D=K[d][v],ge[v?"lineTo":"moveTo"](D.x,D.y);r&&ge.closePath()}this._fillStroke(ge,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var r=n._point,d=this._ctx,v=Math.max(Math.round(n._radius),1),w=(Math.max(Math.round(n._radiusY),1)||v)/v;w!==1&&(d.save(),d.scale(1,w)),d.beginPath(),d.arc(r.x,r.y/w,v,0,Math.PI*2,!1),w!==1&&d.restore(),this._fillStroke(d,n)}},_fillStroke:function(n,r){var d=r.options;d.fill&&(n.globalAlpha=d.fillOpacity,n.fillStyle=d.fillColor||d.color,n.fill(d.fillRule||"evenodd")),d.stroke&&d.weight!==0&&(n.setLineDash&&n.setLineDash(r.options&&r.options._dashArray||[]),n.globalAlpha=d.opacity,n.lineWidth=d.weight,n.strokeStyle=d.color,n.lineCap=d.lineCap,n.lineJoin=d.lineJoin,n.stroke())},_onClick:function(n){for(var r=this._map.mouseEventToLayerPoint(n),d,v,w=this._drawFirst;w;w=w.next)d=w.layer,d.options.interactive&&d._containsPoint(r)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(d))&&(v=d);this._fireEvent(v?[v]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var r=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,r)}},_handleMouseOut:function(n){var r=this._hoveredLayer;r&&(Mt(this._container,"leaflet-interactive"),this._fireEvent([r],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,r){if(!this._mouseHoverThrottled){for(var d,v,w=this._drawFirst;w;w=w.next)d=w.layer,d.options.interactive&&d._containsPoint(r)&&(v=d);v!==this._hoveredLayer&&(this._handleMouseOut(n),v&&(lt(this._container,"leaflet-interactive"),this._fireEvent([v],n,"mouseover"),this._hoveredLayer=v)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,r,d){this._map._fireDOMEvent(r,d||r.type,n)},_bringToFront:function(n){var r=n._order;if(r){var d=r.next,v=r.prev;if(d)d.prev=v;else return;v?v.next=d:d&&(this._drawFirst=d),r.prev=this._drawLast,this._drawLast.next=r,r.next=null,this._drawLast=r,this._requestRedraw(n)}},_bringToBack:function(n){var r=n._order;if(r){var d=r.next,v=r.prev;if(v)v.next=d;else return;d?d.prev=v:v&&(this._drawLast=v),r.prev=null,r.next=this._drawFirst,this._drawFirst.prev=r,this._drawFirst=r,this._requestRedraw(n)}}});function Tu(n){return Je.canvas?new xu(n):null}var sa=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),cv={_initContainer:function(){this._container=rt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Fo.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var r=n._container=sa("shape");lt(r,"leaflet-vml-shape "+(this.options.className||"")),r.coordsize="1 1",n._path=sa("path"),r.appendChild(n._path),this._updateStyle(n),this._layers[h(n)]=n},_addPath:function(n){var r=n._container;this._container.appendChild(r),n.options.interactive&&n.addInteractiveTarget(r)},_removePath:function(n){var r=n._container;Lt(r),n.removeInteractiveTarget(r),delete this._layers[h(n)]},_updateStyle:function(n){var r=n._stroke,d=n._fill,v=n.options,w=n._container;w.stroked=!!v.stroke,w.filled=!!v.fill,v.stroke?(r||(r=n._stroke=sa("stroke")),w.appendChild(r),r.weight=v.weight+"px",r.color=v.color,r.opacity=v.opacity,v.dashArray?r.dashStyle=C(v.dashArray)?v.dashArray.join(" "):v.dashArray.replace(/( *, *)/g," "):r.dashStyle="",r.endcap=v.lineCap.replace("butt","flat"),r.joinstyle=v.lineJoin):r&&(w.removeChild(r),n._stroke=null),v.fill?(d||(d=n._fill=sa("fill")),w.appendChild(d),d.color=v.fillColor||v.color,d.opacity=v.fillOpacity):d&&(w.removeChild(d),n._fill=null)},_updateCircle:function(n){var r=n._point.round(),d=Math.round(n._radius),v=Math.round(n._radiusY||d);this._setPath(n,n._empty()?"M0 0":"AL "+r.x+","+r.y+" "+d+","+v+" 0,"+65535*360)},_setPath:function(n,r){n._path.v=r},_bringToFront:function(n){Un(n._container)},_bringToBack:function(n){zn(n._container)}},_r=Je.vml?sa:Z,ia=Fo.extend({_initContainer:function(){this._container=_r("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=_r("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Lt(this._container),kt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Fo.prototype._update.call(this);var n=this._bounds,r=n.getSize(),d=this._container;(!this._svgSize||!this._svgSize.equals(r))&&(this._svgSize=r,d.setAttribute("width",r.x),d.setAttribute("height",r.y)),Tt(d,n.min),d.setAttribute("viewBox",[n.min.x,n.min.y,r.x,r.y].join(" ")),this.fire("update")}},_initPath:function(n){var r=n._path=_r("path");n.options.className&&lt(r,n.options.className),n.options.interactive&&lt(r,"leaflet-interactive"),this._updateStyle(n),this._layers[h(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){Lt(n._path),n.removeInteractiveTarget(n._path),delete this._layers[h(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var r=n._path,d=n.options;r&&(d.stroke?(r.setAttribute("stroke",d.color),r.setAttribute("stroke-opacity",d.opacity),r.setAttribute("stroke-width",d.weight),r.setAttribute("stroke-linecap",d.lineCap),r.setAttribute("stroke-linejoin",d.lineJoin),d.dashArray?r.setAttribute("stroke-dasharray",d.dashArray):r.removeAttribute("stroke-dasharray"),d.dashOffset?r.setAttribute("stroke-dashoffset",d.dashOffset):r.removeAttribute("stroke-dashoffset")):r.setAttribute("stroke","none"),d.fill?(r.setAttribute("fill",d.fillColor||d.color),r.setAttribute("fill-opacity",d.fillOpacity),r.setAttribute("fill-rule",d.fillRule||"evenodd")):r.setAttribute("fill","none"))},_updatePoly:function(n,r){this._setPath(n,N(n._parts,r))},_updateCircle:function(n){var r=n._point,d=Math.max(Math.round(n._radius),1),v=Math.max(Math.round(n._radiusY),1)||d,w="a"+d+","+v+" 0 1,0 ",D=n._empty()?"M0 0":"M"+(r.x-d)+","+r.y+w+d*2+",0 "+w+-d*2+",0 ";this._setPath(n,D)},_setPath:function(n,r){n._path.setAttribute("d",r)},_bringToFront:function(n){Un(n._path)},_bringToBack:function(n){zn(n._path)}});Je.vml&&ia.include(cv);function Iu(n){return Je.svg||Je.vml?new ia(n):null}mt.include({getRenderer:function(n){var r=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return r||(r=this._renderer=this._createRenderer()),this.hasLayer(r)||this.addLayer(r),r},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var r=this._paneRenderers[n];return r===void 0&&(r=this._createRenderer({pane:n}),this._paneRenderers[n]=r),r},_createRenderer:function(n){return this.options.preferCanvas&&Tu(n)||Iu(n)}});var $u=_i.extend({initialize:function(n,r){_i.prototype.initialize.call(this,this._boundsToLatLngs(n),r)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=Ee(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function uv(n,r){return new $u(n,r)}ia.create=_r,ia.pointsToPath=N,No.geometryToLayer=hr,No.coordsToLatLng=Nl,No.coordsToLatLngs=fr,No.latLngToCoords=Fl,No.latLngsToCoords=pr,No.getFeature=ki,No.asFeature=vr,mt.mergeOptions({boxZoom:!0});var Mu=gn.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){ut(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){kt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Lt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),G(),it(),this._startPoint=this._map.mouseEventToContainerPoint(n),ut(document,{contextmenu:Do,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=rt("div","leaflet-zoom-box",this._container),lt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var r=new be(this._point,this._startPoint),d=r.getSize();Tt(this._box,r.min),this._box.style.width=d.x+"px",this._box.style.height=d.y+"px"},_finish:function(){this._moved&&(Lt(this._box),Mt(this._container,"leaflet-crosshair")),ie(),Rt(),kt(document,{contextmenu:Do,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var r=new ne(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(r).fire("boxzoomend",{boxZoomBounds:r})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});mt.addInitHook("addHandler","boxZoom",Mu),mt.mergeOptions({doubleClickZoom:!0});var Au=gn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var r=this._map,d=r.getZoom(),v=r.options.zoomDelta,w=n.originalEvent.shiftKey?d-v:d+v;r.options.doubleClickZoom==="center"?r.setZoom(w):r.setZoomAround(n.containerPoint,w)}});mt.addInitHook("addHandler","doubleClickZoom",Au),mt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Eu=gn.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new yo(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}lt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Mt(this._map._container,"leaflet-grab"),Mt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var r=Ee(this._map.options.maxBounds);this._offsetLimit=Oe(this._map.latLngToContainerPoint(r.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(r.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var r=this._lastTime=+new Date,d=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(d),this._times.push(r),this._prunePositions(r)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),r=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=r.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,r){return n-(n-r)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),r=this._offsetLimit;n.x<r.min.x&&(n.x=this._viscousLimit(n.x,r.min.x)),n.y<r.min.y&&(n.y=this._viscousLimit(n.y,r.min.y)),n.x>r.max.x&&(n.x=this._viscousLimit(n.x,r.max.x)),n.y>r.max.y&&(n.y=this._viscousLimit(n.y,r.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,r=Math.round(n/2),d=this._initialWorldOffset,v=this._draggable._newPos.x,w=(v-r+d)%n+r-d,D=(v+r+d)%n-r-d,K=Math.abs(w+d)<Math.abs(D+d)?w:D;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=K},_onDragEnd:function(n){var r=this._map,d=r.options,v=!d.inertia||n.noInertia||this._times.length<2;if(r.fire("dragend",n),v)r.fire("moveend");else{this._prunePositions(+new Date);var w=this._lastPos.subtract(this._positions[0]),D=(this._lastTime-this._times[0])/1e3,K=d.easeLinearity,de=w.multiplyBy(K/D),ge=de.distanceTo([0,0]),Ae=Math.min(d.inertiaMaxSpeed,ge),Ke=de.multiplyBy(Ae/ge),ot=Ae/(d.inertiaDeceleration*K),pt=Ke.multiplyBy(-ot/2).round();!pt.x&&!pt.y?r.fire("moveend"):(pt=r._limitOffset(pt,r.options.maxBounds),ae(function(){r.panBy(pt,{duration:ot,easeLinearity:K,noMoveStart:!0,animate:!0})}))}}});mt.addInitHook("addHandler","dragging",Eu),mt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Pu=gn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),ut(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),kt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,r=document.documentElement,d=n.scrollTop||r.scrollTop,v=n.scrollLeft||r.scrollLeft;this._map._container.focus(),window.scrollTo(v,d)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var r=this._panKeys={},d=this.keyCodes,v,w;for(v=0,w=d.left.length;v<w;v++)r[d.left[v]]=[-1*n,0];for(v=0,w=d.right.length;v<w;v++)r[d.right[v]]=[n,0];for(v=0,w=d.down.length;v<w;v++)r[d.down[v]]=[0,n];for(v=0,w=d.up.length;v<w;v++)r[d.up[v]]=[0,-1*n]},_setZoomDelta:function(n){var r=this._zoomKeys={},d=this.keyCodes,v,w;for(v=0,w=d.zoomIn.length;v<w;v++)r[d.zoomIn[v]]=n;for(v=0,w=d.zoomOut.length;v<w;v++)r[d.zoomOut[v]]=-n},_addHooks:function(){ut(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){kt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var r=n.keyCode,d=this._map,v;if(r in this._panKeys){if(!d._panAnim||!d._panAnim._inProgress)if(v=this._panKeys[r],n.shiftKey&&(v=te(v).multiplyBy(3)),d.options.maxBounds&&(v=d._limitOffset(te(v),d.options.maxBounds)),d.options.worldCopyJump){var w=d.wrapLatLng(d.unproject(d.project(d.getCenter()).add(v)));d.panTo(w)}else d.panBy(v)}else if(r in this._zoomKeys)d.setZoom(d.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[r]);else if(r===27&&d._popup&&d._popup.options.closeOnEscapeKey)d.closePopup();else return;Do(n)}}});mt.addInitHook("addHandler","keyboard",Pu),mt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Du=gn.extend({addHooks:function(){ut(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){kt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var r=Ya(n),d=this._map.options.wheelDebounceTime;this._delta+=r,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var v=Math.max(d-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),v),Do(n)},_performZoom:function(){var n=this._map,r=n.getZoom(),d=this._map.options.zoomSnap||0;n._stop();var v=this._delta/(this._map.options.wheelPxPerZoomLevel*4),w=4*Math.log(2/(1+Math.exp(-Math.abs(v))))/Math.LN2,D=d?Math.ceil(w/d)*d:w,K=n._limitZoom(r+(this._delta>0?D:-D))-r;this._delta=0,this._startTime=null,K&&(n.options.scrollWheelZoom==="center"?n.setZoom(r+K):n.setZoomAround(this._lastMousePos,r+K))}});mt.addInitHook("addHandler","scrollWheelZoom",Du);var dv=600;mt.mergeOptions({tapHold:Je.touchNative&&Je.safari&&Je.mobile,tapTolerance:15});var Ou=gn.extend({addHooks:function(){ut(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){kt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var r=n.touches[0];this._startPos=this._newPos=new X(r.clientX,r.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(ut(document,"touchend",Gt),ut(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",r))},this),dv),ut(document,"touchend touchcancel contextmenu",this._cancel,this),ut(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){kt(document,"touchend",Gt),kt(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),kt(document,"touchend touchcancel contextmenu",this._cancel,this),kt(document,"touchmove",this._onMove,this)},_onMove:function(n){var r=n.touches[0];this._newPos=new X(r.clientX,r.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,r){var d=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:r.screenX,screenY:r.screenY,clientX:r.clientX,clientY:r.clientY});d._simulated=!0,r.target.dispatchEvent(d)}});mt.addInitHook("addHandler","tapHold",Ou),mt.mergeOptions({touchZoom:Je.touch,bounceAtZoomLimits:!0});var Ru=gn.extend({addHooks:function(){lt(this._map._container,"leaflet-touch-zoom"),ut(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Mt(this._map._container,"leaflet-touch-zoom"),kt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var r=this._map;if(!(!n.touches||n.touches.length!==2||r._animatingZoom||this._zooming)){var d=r.mouseEventToContainerPoint(n.touches[0]),v=r.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=r.getSize()._divideBy(2),this._startLatLng=r.containerPointToLatLng(this._centerPoint),r.options.touchZoom!=="center"&&(this._pinchStartLatLng=r.containerPointToLatLng(d.add(v)._divideBy(2))),this._startDist=d.distanceTo(v),this._startZoom=r.getZoom(),this._moved=!1,this._zooming=!0,r._stop(),ut(document,"touchmove",this._onTouchMove,this),ut(document,"touchend touchcancel",this._onTouchEnd,this),Gt(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var r=this._map,d=r.mouseEventToContainerPoint(n.touches[0]),v=r.mouseEventToContainerPoint(n.touches[1]),w=d.distanceTo(v)/this._startDist;if(this._zoom=r.getScaleZoom(w,this._startZoom),!r.options.bounceAtZoomLimits&&(this._zoom<r.getMinZoom()&&w<1||this._zoom>r.getMaxZoom()&&w>1)&&(this._zoom=r._limitZoom(this._zoom)),r.options.touchZoom==="center"){if(this._center=this._startLatLng,w===1)return}else{var D=d._add(v)._divideBy(2)._subtract(this._centerPoint);if(w===1&&D.x===0&&D.y===0)return;this._center=r.unproject(r.project(this._pinchStartLatLng,this._zoom).subtract(D),this._zoom)}this._moved||(r._moveStart(!0,!1),this._moved=!0),pe(this._animRequest);var K=l(r._move,r,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=ae(K,this,!0),Gt(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,pe(this._animRequest),kt(document,"touchmove",this._onTouchMove,this),kt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});mt.addInitHook("addHandler","touchZoom",Ru),mt.BoxZoom=Mu,mt.DoubleClickZoom=Au,mt.Drag=Eu,mt.Keyboard=Pu,mt.ScrollWheelZoom=Du,mt.TapHold=Ou,mt.TouchZoom=Ru,o.Bounds=be,o.Browser=Je,o.CRS=re,o.Canvas=xu,o.Circle=Bl,o.CircleMarker=dr,o.Class=Be,o.Control=Mn,o.DivIcon=Cu,o.DivOverlay=_o,o.DomEvent=$l,o.DomUtil=Il,o.Draggable=yo,o.Evented=Q,o.FeatureGroup=Ro,o.GeoJSON=No,o.GridLayer=oa,o.Handler=gn,o.Icon=yi,o.ImageOverlay=mr,o.LatLng=xe,o.LatLngBounds=ne,o.Layer=Et,o.LayerGroup=tn,o.LineUtil=cr,o.Map=mt,o.Marker=ur,o.Mixin=Pl,o.Path=ms,o.Point=X,o.PolyUtil=Dl,o.Polygon=_i,o.Polyline=Bo,o.Popup=gr,o.PosAnimation=Ja,o.Projection=le,o.Rectangle=$u,o.Renderer=Fo,o.SVG=ia,o.SVGOverlay=wu,o.TileLayer=bi,o.Tooltip=yr,o.Transformation=Le,o.Util=Ie,o.VideoOverlay=bu,o.bind=l,o.bounds=Oe,o.canvas=Tu,o.circle=Jp,o.circleMarker=Yp,o.control=Fs,o.divIcon=av,o.extend=s,o.featureGroup=Wp,o.geoJSON=ku,o.geoJson=ev,o.gridLayer=rv,o.icon=qp,o.imageOverlay=tv,o.latLng=we,o.latLngBounds=Ee,o.layerGroup=zs,o.map=Ml,o.marker=Kp,o.point=te,o.polygon=Qp,o.polyline=Xp,o.popup=sv,o.rectangle=uv,o.setOptions=b,o.stamp=h,o.svg=Iu,o.svgOverlay=ov,o.tileLayer=Lu,o.tooltip=iv,o.transformation=U,o.version=i,o.videoOverlay=nv;var hv=window.L;o.noConflict=function(){return window.L=hv,this},window.L=o}))})(va,va.exports)),va.exports}var nw=tw();const un=Qb(nw);(function(e,t,o){function i(s,a){for(;(s=s.parentElement)&&!s.classList.contains(a););return s}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(s,a){this._map=s,this._container=s._container,this._overlayPane=s._panes.overlayPane,this._popupPane=s._panes.popupPane,a&&a.shapeOptions&&(a.shapeOptions=L.Util.extend({},this.options.shapeOptions,a.shapeOptions)),L.setOptions(this,a);var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(L.DomUtil.disableTextSelection(),s.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(s){L.setOptions(this,s)},_fireCreatedEvent:function(s){this._map.fire(L.Draw.Event.CREATED,{layer:s,layerType:this.type})},_cancelDrawing:function(s){s.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(s,a){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,a&&a.drawError&&(a.drawError=L.Util.extend({},this.options.drawError,a.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var s=this._markers.pop(),a=this._poly,l=a.getLatLngs(),u=l.splice(-1,1)[0];this._poly.setLatLngs(l),this._markerGroup.removeLayer(s),a.getLatLngs().length<2&&this._map.removeLayer(a),this._vertexChanged(u,!1)}},addVertex:function(s){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(s))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(s)),this._poly.addLatLng(s),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(s,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var s=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),a=this._poly.newLatLngIntersects(s[s.length-1]);if(!this.options.allowIntersection&&a||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent),l=this._map.layerPointToLatLng(a);this._currentLatLng=l,this._updateTooltip(l),this._updateGuide(a),this._mouseMarker.setLatLng(l),L.DomEvent.preventDefault(s.originalEvent)},_vertexChanged:function(s,a){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(s,a),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(s){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(s),this._clickHandled=!0,this._disableNewMarkers();var a=s.originalEvent,l=a.clientX,u=a.clientY;this._startPoint.call(this,l,u)}},_startPoint:function(s,a){this._mouseDownOrigin=L.point(s,a)},_onMouseUp:function(s){var a=s.originalEvent,l=a.clientX,u=a.clientY;this._endPoint.call(this,l,u,s),this._clickHandled=null},_endPoint:function(s,a,l){if(this._mouseDownOrigin){var u=L.point(s,a).distanceTo(this._mouseDownOrigin),h=this._calculateFinishDistance(l.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(l.latlng),this._finishShape()):h<10&&L.Browser.touch?this._finishShape():Math.abs(u)<9*(e.devicePixelRatio||1)&&this.addVertex(l.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(s){var a,l,u=s.originalEvent;!u.touches||!u.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(a=u.touches[0].clientX,l=u.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,a,l),this._endPoint.call(this,a,l,s),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(s){var a;if(this._markers.length>0){var l;if(this.type===L.Draw.Polyline.TYPE)l=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;l=this._markers[0]}var u=this._map.latLngToContainerPoint(l.getLatLng()),h=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),p=this._map.latLngToContainerPoint(h.getLatLng());a=u.distanceTo(p)}else a=1/0;return a},_updateFinishHandler:function(){var s=this._markers.length;s>1&&this._markers[s-1].on("click",this._finishShape,this),s>2&&this._markers[s-2].off("click",this._finishShape,this)},_createMarker:function(s){var a=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(a),a},_updateGuide:function(s){var a=this._markers?this._markers.length:0;a>0&&(s=s||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[a-1].getLatLng()),s))},_updateTooltip:function(s){var a=this._getTooltipText();s&&this._tooltip.updatePosition(s),this._errorShown||this._tooltip.updateContent(a)},_drawGuide:function(s,a){var l,u,h,p=Math.floor(Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))),f=this.options.guidelineDistance,y=this.options.maxGuideLineLength,k=p>y?p-y:f;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));k<p;k+=this.options.guidelineDistance)l=k/p,u={x:Math.floor(s.x*(1-l)+l*a.x),y:Math.floor(s.y*(1-l)+l*a.y)},h=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),h.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(h,u)},_updateGuideColor:function(s){if(this._guidesContainer)for(var a=0,l=this._guidesContainer.childNodes.length;a<l;a++)this._guidesContainer.childNodes[a].style.backgroundColor=s},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var s,a,l=this.options.showLength;return this._markers.length===0?s={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(a=l?this._getMeasurementString():"",s=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:a}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:a}),s},_updateRunningMeasure:function(s,a){var l,u,h=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(l=h-(a?2:1),u=L.GeometryUtil.isVersion07x()?s.distanceTo(this._markers[l].getLatLng())*(this.options.factor||1):this._map.distance(s,this._markers[l].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=u*(a?1:-1))},_getMeasurementString:function(){var s,a=this._currentLatLng,l=this._markers[this._markers.length-1].getLatLng();return s=L.GeometryUtil.isVersion07x()?l&&a&&a.distanceTo?this._measurementRunningTotal+a.distanceTo(l)*(this.options.factor||1):this._measurementRunningTotal||0:l&&a?this._measurementRunningTotal+this._map.distance(a,l)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(s,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var s=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(s,a){L.Draw.Polyline.prototype.initialize.call(this,s,a),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var s=this._markers.length;s===1&&this._markers[0].on("click",this._finishShape,this),s>2&&(this._markers[s-1].on("dblclick",this._finishShape,this),s>3&&this._markers[s-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var s,a;return this._markers.length===0?s=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(s=L.drawLocal.draw.handlers.polygon.tooltip.cont,a=this._getMeasurementString()):(s=L.drawLocal.draw.handlers.polygon.tooltip.end,a=this._getMeasurementString()),{text:s,subtext:a}},_getMeasurementString:function(){var s=this._area,a="";return s||this.options.showLength?(this.options.showLength&&(a=L.Draw.Polyline.prototype._getMeasurementString.call(this)),s&&(a+="<br>"+L.GeometryUtil.readableArea(s,this.options.metric,this.options.precision)),a):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(s,a){var l;!this.options.allowIntersection&&this.options.showArea&&(l=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(l)),L.Draw.Polyline.prototype._vertexChanged.call(this,s,a)},_cleanUpShape:function(){var s=this._markers.length;s>0&&(this._markers[0].off("click",this._finishShape,this),s>2&&this._markers[s-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(s,a){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(s){this._isDrawing=!0,this._startLatLng=s.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(s.originalEvent)},_onMouseMove:function(s){var a=s.latlng;this._tooltip.updatePosition(a),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(a))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(s,a){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,a)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(s){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!i(s.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(s){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,s)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,s),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_getTooltipText:function(){var s,a,l,u=L.Draw.SimpleShape.prototype._getTooltipText.call(this),h=this._shape,p=this.options.showArea;return h&&(s=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),a=L.GeometryUtil.geodesicArea(s),l=p?L.GeometryUtil.readableArea(a,this.options.metric):""),{text:u.text,subtext:l}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(s,a){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(s){var a=s.latlng;this._tooltip.updatePosition(a),this._mouseMarker.setLatLng(a),this._marker?(a=this._mouseMarker.getLatLng(),this._marker.setLatLng(a)):(this._marker=this._createMarker(a),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(s){return new L.Marker(s,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(s){this._onMouseMove(s),this._onClick()},_fireCreatedEvent:function(){var s=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(s,a){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,a)},_fireCreatedEvent:function(){var s=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)},_createMarker:function(s){return new L.CircleMarker(s,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(s,a){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,a)},_drawShape:function(s){if(L.GeometryUtil.isVersion07x())var a=this._startLatLng.distanceTo(s);else var a=this._map.distance(this._startLatLng,s);this._shape?this._shape.setRadius(a):(this._shape=new L.Circle(this._startLatLng,a,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_onMouseMove:function(s){var a,l=s.latlng,u=this.options.showRadius,h=this.options.metric;if(this._tooltip.updatePosition(l),this._isDrawing){this._drawShape(l),a=this._shape.getRadius().toFixed(1);var p="";u&&(p=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(a,h,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:p})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(s,a){this._marker=s,L.setOptions(this,a)},addHooks:function(){var s=this._marker;s.dragging.enable(),s.on("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},removeHooks:function(){var s=this._marker;s.dragging.disable(),s.off("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},_onDragEnd:function(s){var a=s.target;a.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:a})},_toggleMarkerHighlight:function(){var s=this._marker._icon;s&&(s.style.display="none",L.DomUtil.hasClass(s,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,-4)):(L.DomUtil.addClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,4)),s.style.display="")},_offsetMarker:function(s,a){var l=parseInt(s.style.marginTop,10)-a,u=parseInt(s.style.marginLeft,10)-a;s.style.marginTop=l+"px",s.style.marginLeft=u+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(s){this.latlngs=[s._latlngs],s._holes&&(this.latlngs=this.latlngs.concat(s._holes)),this._poly=s,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(s){for(var a=0;a<this._verticesHandlers.length;a++)s(this._verticesHandlers[a])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(s){s.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(s){s.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(s){s.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var s=0;s<this.latlngs.length;s++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[s],this._poly.options.poly))},_updateLatLngs:function(s){this.latlngs=[s.layer._latlngs],s.layer._holes&&(this.latlngs=this.latlngs.concat(s.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(s,a,l){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=s,l&&l.drawError&&(l.drawError=L.Util.extend({},this.options.drawError,l.drawError)),this._latlngs=a,L.setOptions(this,l)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var s=this._poly,a=s._path;s instanceof L.Polygon||(s.options.fill=!1,s.options.editing&&(s.options.editing.fill=!1)),a&&s.options.editing&&s.options.editing.className&&(s.options.original.className&&s.options.original.className.split(" ").forEach(function(l){L.DomUtil.removeClass(a,l)}),s.options.editing.className.split(" ").forEach(function(l){L.DomUtil.addClass(a,l)})),s.setStyle(s.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var s=this._poly,a=s._path;a&&s.options.editing&&s.options.editing.className&&(s.options.editing.className.split(" ").forEach(function(l){L.DomUtil.removeClass(a,l)}),s.options.original.className&&s.options.original.className.split(" ").forEach(function(l){L.DomUtil.addClass(a,l)})),s.setStyle(s.options.original),s._map&&(s._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var s,a,l,u,h=this._defaultShape();for(s=0,l=h.length;s<l;s++)u=this._createMarker(h[s],s),u.on("click",this._onMarkerClick,this),u.on("contextmenu",this._onContextMenu,this),this._markers.push(u);var p,f;for(s=0,a=l-1;s<l;a=s++)(s!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(p=this._markers[a],f=this._markers[s],this._createMiddleMarker(p,f),this._updatePrevNext(p,f))},_createMarker:function(s,a){var l=new L.Marker.Touch(s,{draggable:!0,icon:this.options.icon});return l._origLatLng=s,l._index=a,l.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(l),l},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var s=this._defaultShape(),a=[].splice.apply(s,arguments);return this._poly._convertLatLngs(s,!0),this._poly.redraw(),a},_removeMarker:function(s){var a=s._index;this._markerGroup.removeLayer(s),this._markers.splice(a,1),this._spliceLatLngs(a,1),this._updateIndexes(a,-1),s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(s){var a=s.target,l=this._poly,u=L.LatLngUtil.cloneLatLng(a._origLatLng);if(L.extend(a._origLatLng,a._latlng),l.options.poly){var h=l._map._editTooltip;if(!l.options.poly.allowIntersection&&l.intersects()){L.extend(a._origLatLng,u),a.setLatLng(u);var p=l.options.color;l.setStyle({color:this.options.drawError.color}),h&&h.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){l.setStyle({color:p}),h&&h.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}a._middleLeft&&a._middleLeft.setLatLng(this._getMiddleLatLng(a._prev,a)),a._middleRight&&a._middleRight.setLatLng(this._getMiddleLatLng(a,a._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var f=this._poly.getLatLngs();this._poly._convertLatLngs(f,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(s){var a=L.Polygon&&this._poly instanceof L.Polygon?4:3,l=s.target;this._defaultShape().length<a||(this._removeMarker(l),this._updatePrevNext(l._prev,l._next),l._middleLeft&&this._markerGroup.removeLayer(l._middleLeft),l._middleRight&&this._markerGroup.removeLayer(l._middleRight),l._prev&&l._next?this._createMiddleMarker(l._prev,l._next):l._prev?l._next||(l._prev._middleRight=null):l._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(s){var a=s.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:a,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),l=this._map.layerPointToLatLng(a),u=s.target;L.extend(u._origLatLng,l),u._middleLeft&&u._middleLeft.setLatLng(this._getMiddleLatLng(u._prev,u)),u._middleRight&&u._middleRight.setLatLng(this._getMiddleLatLng(u,u._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(s,a){this._markerGroup.eachLayer(function(l){l._index>s&&(l._index+=a)})},_createMiddleMarker:function(s,a){var l,u,h,p=this._getMiddleLatLng(s,a),f=this._createMarker(p);f.setOpacity(.6),s._middleRight=a._middleLeft=f,u=function(){f.off("touchmove",u,this);var y=a._index;f._index=y,f.off("click",l,this).on("click",this._onMarkerClick,this),p.lat=f.getLatLng().lat,p.lng=f.getLatLng().lng,this._spliceLatLngs(y,0,p),this._markers.splice(y,0,f),f.setOpacity(1),this._updateIndexes(y,1),a._index++,this._updatePrevNext(s,f),this._updatePrevNext(f,a),this._poly.fire("editstart")},h=function(){f.off("dragstart",u,this),f.off("dragend",h,this),f.off("touchmove",u,this),this._createMiddleMarker(s,f),this._createMiddleMarker(f,a)},l=function(){u.call(this),h.call(this),this._fireEdit()},f.on("click",l,this).on("dragstart",u,this).on("dragend",h,this).on("touchmove",u,this),this._markerGroup.addLayer(f)},_updatePrevNext:function(s,a){s&&(s._next=a),a&&(a._prev=s)},_getMiddleLatLng:function(s,a){var l=this._poly._map,u=l.project(s.getLatLng()),h=l.project(a.getLatLng());return l.unproject(u._add(h)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(s,a){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=s,L.Util.setOptions(this,a)},addHooks:function(){var s=this._shape;this._shape._map&&(this._map=this._shape._map,s.setStyle(s.options.editing),s._map&&(this._map=s._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var s=this._shape;if(s.setStyle(s.options.original),s._map){this._unbindMarker(this._moveMarker);for(var a=0,l=this._resizeMarkers.length;a<l;a++)this._unbindMarker(this._resizeMarkers[a]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(s,a){var l=new L.Marker.Touch(s,{draggable:!0,icon:a,zIndexOffset:10});return this._bindMarker(l),this._markerGroup.addLayer(l),l},_bindMarker:function(s){s.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(s){s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(s){s.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(s){var a=s.target,l=a.getLatLng();a===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(s){s.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(s){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s),typeof this._getCorners=="function"){var a=this._getCorners(),l=s.target,u=l._cornerIndex;l.setOpacity(0),this._oppositeCorner=a[(u+2)%4],this._toggleCornerMarkers(0,u)}this._shape.fire("editstart")},_onTouchMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),l=this._map.layerPointToLatLng(a);return s.target===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),!1},_onTouchEnd:function(s){s.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getBounds(),a=s.getCenter();this._moveMarker=this._createMarker(a,this.options.moveIcon)},_createResizeMarker:function(){var s=this._getCorners();this._resizeMarkers=[];for(var a=0,l=s.length;a<l;a++)this._resizeMarkers.push(this._createMarker(s[a],this.options.resizeIcon)),this._resizeMarkers[a]._cornerIndex=a},_onMarkerDragStart:function(s){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s);var a=this._getCorners(),l=s.target,u=l._cornerIndex;this._oppositeCorner=a[(u+2)%4],this._toggleCornerMarkers(0,u)},_onMarkerDragEnd:function(s){var a,l,u=s.target;u===this._moveMarker&&(a=this._shape.getBounds(),l=a.getCenter(),u.setLatLng(l)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,s)},_move:function(s){for(var a,l=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),u=this._shape.getBounds(),h=u.getCenter(),p=[],f=0,y=l.length;f<y;f++)a=[l[f].lat-h.lat,l[f].lng-h.lng],p.push([s.lat+a[0],s.lng+a[1]]);this._shape.setLatLngs(p),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(s){var a;this._shape.setBounds(L.latLngBounds(s,this._oppositeCorner)),a=this._shape.getBounds(),this._moveMarker.setLatLng(a.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var s=this._shape.getBounds();return[s.getNorthWest(),s.getNorthEast(),s.getSouthEast(),s.getSouthWest()]},_toggleCornerMarkers:function(s){for(var a=0,l=this._resizeMarkers.length;a<l;a++)this._resizeMarkers[a].setOpacity(s)},_repositionCornerMarkers:function(){for(var s=this._getCorners(),a=0,l=this._resizeMarkers.length;a<l;a++)this._resizeMarkers[a].setLatLng(s[a])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getLatLng();this._moveMarker=this._createMarker(s,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(s){if(this._resizeMarkers.length){var a=this._getResizeMarkerPoint(s);this._resizeMarkers[0].setLatLng(a)}this._shape.setLatLng(s),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var s=this._shape.getLatLng(),a=this._getResizeMarkerPoint(s);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(a,this.options.resizeIcon))},_getResizeMarkerPoint:function(s){var a=this._shape._radius*Math.cos(Math.PI/4),l=this._map.project(s);return this._map.unproject([l.x+a,l.y-a])},_resize:function(s){var a=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=a.distanceTo(s):radius=this._map.distance(a,s),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(s,a){var l={};if(s.touches!==void 0){if(!s.touches.length)return;l=s.touches[0]}else if(s.pointerType!=="touch"||(l=s,!this._filterClick(s)))return;var u=this._map.mouseEventToContainerPoint(l),h=this._map.mouseEventToLayerPoint(l),p=this._map.layerPointToLatLng(h);this._map.fire(a,{latlng:p,layerPoint:h,containerPoint:u,pageX:l.pageX,pageY:l.pageY,originalEvent:s})},_filterClick:function(s){var a=s.timeStamp||s.originalEvent.timeStamp,l=L.DomEvent._lastClick&&a-L.DomEvent._lastClick;return l&&l>100&&l<500||s.target._simulatedClick&&!s._simulated?(L.DomEvent.stop(s),!1):(L.DomEvent._lastClick=a,!0)},_onTouchStart:function(s){this._map._loaded&&this._touchEvent(s,"touchstart")},_onTouchEnd:function(s){this._map._loaded&&this._touchEvent(s,"touchend")},_onTouchCancel:function(s){if(this._map._loaded){var a="touchcancel";this._detectIE()&&(a="pointercancel"),this._touchEvent(s,a)}},_onTouchLeave:function(s){this._map._loaded&&this._touchEvent(s,"touchleave")},_onTouchMove:function(s){this._map._loaded&&this._touchEvent(s,"touchmove")},_detectIE:function(){var s=e.navigator.userAgent,a=s.indexOf("MSIE ");if(a>0)return parseInt(s.substring(a+5,s.indexOf(".",a)),10);if(s.indexOf("Trident/")>0){var l=s.indexOf("rv:");return parseInt(s.substring(l+3,s.indexOf(".",l)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var s=this._icon,a=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?a.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):a.concat(["touchcancel"]),L.DomUtil.addClass(s,"leaflet-clickable"),L.DomEvent.on(s,"click",this._onMouseClick,this),L.DomEvent.on(s,"keypress",this._onKeyPress,this);for(var l=0;l<a.length;l++)L.DomEvent.on(s,a[l],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var s=e.navigator.userAgent,a=s.indexOf("MSIE ");if(a>0)return parseInt(s.substring(a+5,s.indexOf(".",a)),10);if(s.indexOf("Trident/")>0){var l=s.indexOf("rv:");return parseInt(s.substring(l+3,s.indexOf(".",l)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.LatLngUtil={cloneLatLngs:function(s){for(var a=[],l=0,u=s.length;l<u;l++)Array.isArray(s[l])?a.push(L.LatLngUtil.cloneLatLngs(s[l])):a.push(this.cloneLatLng(s[l]));return a},cloneLatLng:function(s){return L.latLng(s.lat,s.lng)}},(function(){var s={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(a){var l,u,h=a.length,p=0,f=Math.PI/180;if(h>2){for(var y=0;y<h;y++)l=a[y],u=a[(y+1)%h],p+=(u.lng-l.lng)*f*(2+Math.sin(l.lat*f)+Math.sin(u.lat*f));p=6378137*p*6378137/2}return Math.abs(p)},formattedNumber:function(a,l){var u=parseFloat(a).toFixed(l),h=L.drawLocal.format&&L.drawLocal.format.numeric,p=h&&h.delimiters,f=p&&p.thousands,y=p&&p.decimal;if(f||y){var k=u.split(".");u=f?k[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+f):k[0],y=y||".",k.length>1&&(u=u+y+k[1])}return u},readableArea:function(a,l,f){var h,p,f=L.Util.extend({},s,f);return l?(p=["ha","m"],type=typeof l,type==="string"?p=[l]:type!=="boolean"&&(p=l),h=a>=1e6&&p.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*a,f.km)+" km":a>=1e4&&p.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*a,f.ha)+" ha":L.GeometryUtil.formattedNumber(a,f.m)+" m"):(a/=.836127,h=a>=3097600?L.GeometryUtil.formattedNumber(a/3097600,f.mi)+" mi":a>=4840?L.GeometryUtil.formattedNumber(a/4840,f.ac)+" acres":L.GeometryUtil.formattedNumber(a,f.yd)+" yd"),h},readableDistance:function(a,l,u,h,y){var f,y=L.Util.extend({},s,y);switch(l?typeof l=="string"?l:"metric":u?"feet":h?"nauticalMile":"yards"){case"metric":f=a>1e3?L.GeometryUtil.formattedNumber(a/1e3,y.km)+" km":L.GeometryUtil.formattedNumber(a,y.m)+" m";break;case"feet":a*=3.28083,f=L.GeometryUtil.formattedNumber(a,y.ft)+" ft";break;case"nauticalMile":a*=.53996,f=L.GeometryUtil.formattedNumber(a/1e3,y.nm)+" nm";break;default:a*=1.09361,f=a>1760?L.GeometryUtil.formattedNumber(a/1760,y.mi)+" miles":L.GeometryUtil.formattedNumber(a,y.yd)+" yd"}return f},isVersion07x:function(){var a=L.version.split(".");return parseInt(a[0],10)===0&&parseInt(a[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(s,a,l,u){return this._checkCounterclockwise(s,l,u)!==this._checkCounterclockwise(a,l,u)&&this._checkCounterclockwise(s,a,l)!==this._checkCounterclockwise(s,a,u)},_checkCounterclockwise:function(s,a,l){return(l.y-s.y)*(a.x-s.x)>(a.y-s.y)*(l.x-s.x)}}),L.Polyline.include({intersects:function(){var s,a,l,u=this._getProjectedPoints(),h=u?u.length:0;if(this._tooFewPointsForIntersection())return!1;for(s=h-1;s>=3;s--)if(a=u[s-1],l=u[s],this._lineSegmentsIntersectsRange(a,l,s-2))return!0;return!1},newLatLngIntersects:function(s,a){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(s),a)},newPointIntersects:function(s,a){var l=this._getProjectedPoints(),u=l?l.length:0,h=l?l[u-1]:null,p=u-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(h,s,p,a?1:0)},_tooFewPointsForIntersection:function(s){var a=this._getProjectedPoints(),l=a?a.length:0;return l+=s||0,!a||l<=3},_lineSegmentsIntersectsRange:function(s,a,l,u){var h,p,f=this._getProjectedPoints();u=u||0;for(var y=l;y>u;y--)if(h=f[y-1],p=f[y],L.LineUtil.segmentsIntersect(s,a,h,p))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var s=[],a=this._defaultShape(),l=0;l<a.length;l++)s.push(this._map.latLngToLayerPoint(a[l]));return s}}),L.Polygon.include({intersects:function(){var s,a,l,u,h=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(s=h.length,a=h[0],l=h[s-1],u=s-2,this._lineSegmentsIntersectsRange(l,a,u,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(s){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,s);var a;this._toolbars={},L.DrawToolbar&&this.options.draw&&(a=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=a,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(a=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=a,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(s){var a,l=L.DomUtil.create("div","leaflet-draw"),u=!1;for(var h in this._toolbars)this._toolbars.hasOwnProperty(h)&&(a=this._toolbars[h].addToolbar(s))&&(u||(L.DomUtil.hasClass(a,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(a.childNodes[0],"leaflet-draw-toolbar-top"),u=!0),l.appendChild(a));return l},onRemove:function(){for(var s in this._toolbars)this._toolbars.hasOwnProperty(s)&&this._toolbars[s].removeToolbar()},setDrawingOptions:function(s){for(var a in this._toolbars)this._toolbars[a]instanceof L.DrawToolbar&&this._toolbars[a].setOptions(s)},_toolbarEnabled:function(s){var a=s.target;for(var l in this._toolbars)this._toolbars[l]!==a&&this._toolbars[l].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(s){L.setOptions(this,s),this._modes={},this._actionButtons=[],this._activeMode=null;var a=L.version.split(".");parseInt(a[0],10)===1&&parseInt(a[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(s){var a,l=L.DomUtil.create("div","leaflet-draw-section"),u=0,h=this._toolbarClass||"",p=this.getModeHandlers(s);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=s,a=0;a<p.length;a++)p[a].enabled&&this._initModeHandler(p[a].handler,this._toolbarContainer,u++,h,p[a].title);if(u)return this._lastButtonIndex=--u,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),l.appendChild(this._toolbarContainer),l.appendChild(this._actionsContainer),l},removeToolbar:function(){for(var s in this._modes)this._modes.hasOwnProperty(s)&&(this._disposeButton(this._modes[s].button,this._modes[s].handler.enable,this._modes[s].handler),this._modes[s].handler.disable(),this._modes[s].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var a=0,l=this._actionButtons.length;a<l;a++)this._disposeButton(this._actionButtons[a].button,this._actionButtons[a].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(s,a,l,u,h){var p=s.type;this._modes[p]={},this._modes[p].handler=s,this._modes[p].button=this._createButton({type:p,title:h,className:u+"-"+p,container:a,callback:this._modes[p].handler.enable,context:this._modes[p].handler}),this._modes[p].buttonIndex=l,this._modes[p].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(s){var a=L.DomUtil.create("a",s.className||"",s.container),l=L.DomUtil.create("span","sr-only",s.container);a.href="#",a.appendChild(l),s.title&&(a.title=s.title,l.innerHTML=s.title),s.text&&(a.innerHTML=s.text,l.innerHTML=s.text);var u=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(a,"click",L.DomEvent.stopPropagation).on(a,"mousedown",L.DomEvent.stopPropagation).on(a,"dblclick",L.DomEvent.stopPropagation).on(a,"touchstart",L.DomEvent.stopPropagation).on(a,"click",L.DomEvent.preventDefault).on(a,u,s.callback,s.context),a},_disposeButton:function(s,a){var l=this._detectIOS()?"touchstart":"click";L.DomEvent.off(s,"click",L.DomEvent.stopPropagation).off(s,"mousedown",L.DomEvent.stopPropagation).off(s,"dblclick",L.DomEvent.stopPropagation).off(s,"touchstart",L.DomEvent.stopPropagation).off(s,"click",L.DomEvent.preventDefault).off(s,l,a)},_handlerActivated:function(s){this.disable(),this._activeMode=this._modes[s.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(s){var a,l,u,h,p=this._actionsContainer,f=this.getActions(s),y=f.length;for(l=0,u=this._actionButtons.length;l<u;l++)this._disposeButton(this._actionButtons[l].button,this._actionButtons[l].callback);for(this._actionButtons=[];p.firstChild;)p.removeChild(p.firstChild);for(var k=0;k<y;k++)"enabled"in f[k]&&!f[k].enabled||(a=L.DomUtil.create("li","",p),h=this._createButton({title:f[k].title,text:f[k].text,container:a,callback:f[k].callback,context:f[k].context}),this._actionButtons.push({button:h,callback:f[k].callback}))},_showActionsToolbar:function(){var s=this._activeMode.buttonIndex,a=this._lastButtonIndex,l=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=l+"px",s===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),s===a&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(s){this._map=s,this._popupPane=s._panes.popupPane,this._visible=!1,this._container=s.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(s){return this._container?(s.subtext=s.subtext||"",s.subtext.length!==0||this._singleLineLabel?s.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(s.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+s.subtext+"</span><br />":"")+"<span>"+s.text+"</span>",s.text||s.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(s){var a=this._map.latLngToLayerPoint(s),l=this._container;return this._container&&(this._visible&&(l.style.visibility="inherit"),L.DomUtil.setPosition(l,a)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(s){for(var a in this.options)this.options.hasOwnProperty(a)&&s[a]&&(s[a]=L.extend({},this.options[a],s[a]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,s)},getModeHandlers:function(s){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(s,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(s,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(s,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(s,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(s,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(s,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(s){return[{enabled:s.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:s.completeShape,context:s},{enabled:s.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:s.deleteLastVertex,context:s},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(s){L.setOptions(this,s);for(var a in this._modes)this._modes.hasOwnProperty(a)&&s.hasOwnProperty(a)&&this._modes[a].handler.setOptions(s[a])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(s){s.edit&&(s.edit.selectedPathOptions===void 0&&(s.edit.selectedPathOptions=this.options.edit.selectedPathOptions),s.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,s.edit.selectedPathOptions)),s.remove&&(s.remove=L.extend({},this.options.remove,s.remove)),s.poly&&(s.poly=L.extend({},this.options.poly,s.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,s),this._selectedFeatureCount=0},getModeHandlers:function(s){var a=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(s,{featureGroup:a,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(s,{featureGroup:a}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(s){var a=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return s.removeAllLayers&&a.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),a},addToolbar:function(s){var a=L.Toolbar.prototype.addToolbar.call(this,s);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),a},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var s,a=this.options.featureGroup,l=a.getLayers().length!==0;this.options.edit&&(s=this._modes[L.EditToolbar.Edit.TYPE].button,l?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(s=this._modes[L.EditToolbar.Delete.TYPE].button,l?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(s,a){if(L.Handler.prototype.initialize.call(this,s),L.setOptions(this,a),this._featureGroup=a.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),s._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(s){this._revertLayer(s)},this)},save:function(){var s=new L.LayerGroup;this._featureGroup.eachLayer(function(a){a.edited&&(s.addLayer(a),a.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:s})},_backupLayer:function(s){var a=L.Util.stamp(s);this._uneditedLayerProps[a]||(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?this._uneditedLayerProps[a]={latlngs:L.LatLngUtil.cloneLatLngs(s.getLatLngs())}:s instanceof L.Circle?this._uneditedLayerProps[a]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng()),radius:s.getRadius()}:(s instanceof L.Marker||s instanceof L.CircleMarker)&&(this._uneditedLayerProps[a]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(s){var a=L.Util.stamp(s);s.edited=!1,this._uneditedLayerProps.hasOwnProperty(a)&&(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?s.setLatLngs(this._uneditedLayerProps[a].latlngs):s instanceof L.Circle?(s.setLatLng(this._uneditedLayerProps[a].latlng),s.setRadius(this._uneditedLayerProps[a].radius)):(s instanceof L.Marker||s instanceof L.CircleMarker)&&s.setLatLng(this._uneditedLayerProps[a].latlng),s.fire("revert-edited",{layer:s}))},_enableLayerEdit:function(s){var a,l,u=s.layer||s.target||s;this._backupLayer(u),this.options.poly&&(l=L.Util.extend({},this.options.poly),u.options.poly=l),this.options.selectedPathOptions&&(a=L.Util.extend({},this.options.selectedPathOptions),a.maintainColor&&(a.color=u.options.color,a.fillColor=u.options.fillColor),u.options.original=L.extend({},u.options),u.options.editing=a),u instanceof L.Marker?(u.editing&&u.editing.enable(),u.dragging.enable(),u.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):u.editing.enable()},_disableLayerEdit:function(s){var a=s.layer||s.target||s;a.edited=!1,a.editing&&a.editing.disable(),delete a.options.editing,delete a.options.original,this._selectedPathOptions&&(a instanceof L.Marker?this._toggleMarkerHighlight(a):(a.setStyle(a.options.previousOptions),delete a.options.previousOptions)),a instanceof L.Marker?(a.dragging.disable(),a.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):a.editing.disable()},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_onMarkerDragEnd:function(s){var a=s.target;a.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:a})},_onTouchMove:function(s){var a=s.originalEvent.changedTouches[0],l=this._map.mouseEventToLayerPoint(a),u=this._map.layerPointToLatLng(l);s.target.setLatLng(u)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(s,a){if(L.Handler.prototype.initialize.call(this,s),L.Util.setOptions(this,a),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(s){this._deletableLayers.addLayer(s),s.fire("revert-deleted",{layer:s})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(s){this._removeLayer({layer:s})},this),this.save()},_enableLayerDelete:function(s){(s.layer||s.target||s).on("click",this._removeLayer,this)},_disableLayerDelete:function(s){var a=s.layer||s.target||s;a.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(a)},_removeLayer:function(s){var a=s.layer||s.target||s;this._deletableLayers.removeLayer(a),this._deletedLayers.addLayer(a),a.fire("deleted")},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const Np=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"",fh=e=>e.length*6+12,cc=(e,t)=>!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom),ow=(e,t)=>{if(!e||t.length===0)return new Set;const o=[],i=e.getBounds();t.forEach(l=>{if(i.contains(l.getLatLng())){const u=e.latLngToContainerPoint(l.getLatLng()),h=l.locationData;h&&o.push({marker:l,pixelPos:u,location:h})}});const s=o.map(({marker:l,pixelPos:u,location:h})=>{const y=fh(h.name),k=h.description?fh(`${h.name}: ${Np(h.description,50)}`):y;return{marker:l,location:h,markerBox:{left:u.x-15,right:u.x+15,top:u.y-15,bottom:u.y+15},baseLabelBox:{left:u.x-y/2,right:u.x+y/2,top:u.y+15+2,bottom:u.y+15+2+20},descLabelBox:h.description?{left:u.x-k/2,right:u.x+k/2,top:u.y+15+2,bottom:u.y+15+2+20}:null}}),a=new Set;return s.forEach(({marker:l,location:u,markerBox:h,baseLabelBox:p,descLabelBox:f},y)=>{if(!u.description)return;let k=!1;for(let I=0;I<s.length;I++){if(y===I)continue;const M=s[I];if(cc(f,M.markerBox)||cc(f,M.baseLabelBox)){k=!0;break}if(M.descLabelBox&&a.has(M.location.id)&&cc(f,M.descLabelBox)){k=!0;break}}k||a.add(u.id)}),a},Ir=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"hexagon",label:"Hexagon"},{value:"pentagon",label:"Pentagon"},{value:"diamond",label:"Diamond"},{value:"star",label:"Star"},{value:"dot",label:"Dot"},{value:"none",label:"None"}],sw=[{value:"33",label:"Small (33%)"},{value:"66",label:"Medium (66%)"},{value:"100",label:"Normal (100%)"},{value:"150",label:"Large (150%)"}],Qr=[{value:"default",label:"Default",isShapeOnly:!1,category:"default"},{value:"dot",label:"Dot",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"circle",label:"Circle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"square",label:"Square",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"triangle",label:"Triangle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"diamond",label:"Diamond",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"star",label:"Star",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"hexagon",label:"Hexagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"pentagon",label:"Pentagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"car",label:"Car",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"bike",label:"Bike",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"water",label:"Water",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"food",label:"Food",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"medical",label:"Medical",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"photo",label:"Photo",isShapeOnly:!1,category:"content",defaultColor:"#8B5CF6"},{value:"music",label:"Music",isShapeOnly:!1,category:"content",defaultColor:"#EC4899"},{value:"start",label:"Start",isShapeOnly:!1,category:"content",defaultColor:"#10B981"},{value:"finish",label:"Finish",isShapeOnly:!1,category:"content",defaultColor:"#1F2937"},{value:"toilet",label:"Toilet",isShapeOnly:!1,category:"content",defaultColor:"#6366F1"},{value:"shower",label:"Shower",isShapeOnly:!1,category:"content",defaultColor:"#06B6D4"},{value:"bus",label:"Bus",isShapeOnly:!1,category:"content",defaultColor:"#F97316"},{value:"info",label:"Information",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"merch",label:"Merchandise",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"cone",label:"Road closure",isShapeOnly:!1,category:"content",defaultColor:"#FF6B00"},{value:"traffic",label:"Traffic management",isShapeOnly:!1,category:"content",defaultColor:"#374151"},{value:"track",label:"Track",isShapeOnly:!1,category:"content",defaultColor:"#78716C"},{value:"tunnel",label:"Tunnel",isShapeOnly:!1,category:"content",defaultColor:"#57534E"},{value:"bridge",label:"Bridge",isShapeOnly:!1,category:"content",defaultColor:"#0284C7"},{value:"plane",label:"Plane",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"hill",label:"Hill",isShapeOnly:!1,category:"content",defaultColor:"#65A30D"},{value:"baggage",label:"Baggage",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"crown",label:"Crown",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"crossing",label:"Crossing point",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"trees",label:"Trees",isShapeOnly:!1,category:"content",defaultColor:"#22C55E"},{value:"arrow-uturn-left",label:"Left u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-left",label:"Left turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-left",label:"Slight left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-straight",label:"Straight ahead",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-right",label:"Slight right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-right",label:"Right turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-uturn-right",label:"Right u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-left",label:"Left fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-right",label:"Right fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-left",label:"Keep left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-right",label:"Keep right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"}];function ii(e){return Qr.find(t=>t.value===e)||Qr[0]}function iw(e){return ii(e).defaultColor||"#667eea"}function aw(e,t){return t||iw(e)}const Bc={dot:(e,t=32)=>{const o=(t/2-2)*.33;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="1.5"/>
    </svg>`},circle:(e,t=32)=>{const o=t/2-2;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`},square:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect x="4" y="4" width="${t-8}" height="${t-8}" rx="4" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`,triangle:(e,t=32)=>{const o=t/2,i=4,s=t-4,a=4,l=t-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${i} ${l},${s} ${a},${s}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},diamond:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${i-s} ${o+s},${i} ${o},${i+s} ${o-s},${i}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},star:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-3,a=s*.4,l=[];for(let u=0;u<5;u++){const h=Math.PI/2*-1+u*2*Math.PI/5;l.push(`${o+s*Math.cos(h)},${i+s*Math.sin(h)}`);const p=h+Math.PI/5;l.push(`${o+a*Math.cos(p)},${i+a*Math.sin(p)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${l.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},hexagon:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4,a=[];for(let l=0;l<6;l++){const u=Math.PI/6+l*Math.PI/3;a.push(`${o+s*Math.cos(u)},${i+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${a.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},pentagon:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4,a=[];for(let l=0;l<5;l++){const u=Math.PI/2*-1+l*2*Math.PI/5;a.push(`${o+s*Math.cos(u)},${i+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${a.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},car:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Car body -->
      <rect x="6" y="13" width="20" height="8" rx="2" fill="#fff"/>
      <!-- Car roof/cabin -->
      <path d="M10 13 L12 9 L20 9 L22 13" fill="#fff" stroke="#fff" stroke-width="1"/>
      <!-- Windows -->
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${e}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${e}"/>
      <!-- Tires (always black) -->
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <!-- Wheel centers -->
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>
    </svg>`,bike:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Tires (same color as bike) -->
      <circle cx="9" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <!-- Wheel centers -->
      <circle cx="9" cy="20" r="1" fill="#fff"/>
      <circle cx="23" cy="20" r="1" fill="#fff"/>
      <!-- Frame -->
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
      <!-- Handlebars -->
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <!-- Seat -->
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="#fff"/>
    </svg>`},ph={water:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="#fff"/>
    </svg>`,food:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="#fff"/>
      <path d="M21 9v14h2V9h-2z" fill="#fff"/>
    </svg>`,medical:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#fff" stroke-width="2"/>
      <rect x="14" y="8" width="4" height="16" rx="1" fill="#fff"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="#fff"/>
    </svg>`,photo:(e=32)=>{const t="#8B5CF6";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="8" y="10" width="16" height="12" rx="2" fill="#fff"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" y="13" r="1" fill="${t}"/>
    </svg>`},music:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EC4899" stroke="#fff" stroke-width="2"/>
      <path d="M12 22c1.66 0 3-1.34 3-3v-9h5v4h-3v5c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.35 0 .69.07 1 .18V10c0-.55.45-1 1-1h5c.55 0 1 .45 1 1v6h-5v5c0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.7 0 1.37.15 2 .41" fill="#fff"/>
      <ellipse cx="12" cy="21" rx="2.5" ry="2" fill="#fff"/>
      <rect x="14" y="10" width="2" height="9" fill="#fff"/>
      <rect x="14" y="10" width="6" height="2" fill="#fff"/>
    </svg>`,start:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#10B981" stroke="#fff" stroke-width="2"/>
      <path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="#fff"/>
    </svg>`,finish:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#1F2937" stroke="#fff" stroke-width="2"/>
      <rect x="10" y="8" width="4" height="4" fill="#fff"/>
      <rect x="14" y="12" width="4" height="4" fill="#fff"/>
      <rect x="18" y="8" width="4" height="4" fill="#fff"/>
      <rect x="10" y="16" width="4" height="4" fill="#fff"/>
      <rect x="18" y="16" width="4" height="4" fill="#fff"/>
      <rect x="14" y="20" width="4" height="4" fill="#fff"/>
    </svg>`,toilet:(e=32)=>{const t="#6366F1";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="11" y="7" width="10" height="3" rx="1" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>
    </svg>`},shower:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#06B6D4" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="3" fill="#fff"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="#fff"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
    </svg>`,bus:(e=32)=>{const t="#F97316";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="9" y="9" width="14" height="12" rx="2" fill="#fff"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="#fff"/>
      <circle cx="12" cy="21" r="1.5" fill="#fff"/>
      <circle cx="20" cy="21" r="1.5" fill="#fff"/>
    </svg>`},info:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#0EA5E9" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="2" fill="#fff"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="#fff"/>
    </svg>`,merch:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#A855F7" stroke="#fff" stroke-width="2"/>
      <path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="#fff"/>
      <path d="M13 10 L16 7 L19 10" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>`,cone:(e=32)=>{const t="#FF6B00";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L21 22 H11 L16 6Z" fill="#fff"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="#fff"/>
    </svg>`},traffic:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#374151" stroke="#fff" stroke-width="2"/>
      <rect x="12" y="6" width="8" height="20" rx="2" fill="#fff"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>
    </svg>`,crown:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="#fff"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="#fff"/>
    </svg>`,crossing:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="#fff" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="#fff" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="#fff"/>
      <path d="M16 10 L16 16" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
    </svg>`,trees:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#22C55E" stroke="#fff" stroke-width="2"/>
      <!-- Left tree -->
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="#fff"/>
      <!-- Right tree -->
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="#fff"/>
    </svg>`,"arrow-uturn-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on right, curve left, down on left -->
      <path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on left side -->
      <path d="M7 15 L12 21 L17 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="#fff"/>
    </svg>`,"arrow-slight-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-straight":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
    </svg>`,"arrow-slight-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="#fff"/>
    </svg>`,"arrow-uturn-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on left, curve right, down on right -->
      <path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on right side -->
      <path d="M15 15 L20 21 L25 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-fork-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (correct way - with arrow) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M10 12 L6 10 L8 16 Z" fill="#fff"/>
      <!-- Right fork (wrong way - with X) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
    </svg>`,"arrow-fork-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (wrong way - with X) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <!-- Right fork (correct way - with arrow) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M22 12 L26 10 L24 16 Z" fill="#fff"/>
    </svg>`,"arrow-keep-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-keep-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`},$i={circle:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="14" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,square:({backgroundColor:e,borderColor:t})=>`<rect x="4" y="4" width="24" height="24" rx="4" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,hexagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=[];for(let a=0;a<6;a++){const l=Math.PI/6+a*Math.PI/3;s.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},pentagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=[];for(let a=0;a<5;a++){const l=Math.PI/2*-1+a*2*Math.PI/5;s.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},diamond:({backgroundColor:e,borderColor:t})=>`<polygon points="16,4 28,16 16,28 4,16" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}" stroke-linejoin="round"/>`,star:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=13,a=s*.4,l=[];for(let u=0;u<5;u++){const h=Math.PI/2*-1+u*2*Math.PI/5;l.push(`${16+s*Math.cos(h)},${16+s*Math.sin(h)}`);const p=h+Math.PI/5;l.push(`${16+a*Math.cos(p)},${16+a*Math.sin(p)}`)}return`<polygon points="${l.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},dot:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="5" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:1.5}"/>`,none:()=>""},vh={water:(e="#fff")=>`<path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="${e}"/>`,food:(e="#fff")=>`<path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="${e}"/>
      <path d="M21 9v14h2V9h-2z" fill="${e}"/>`,medical:(e="#fff")=>`<rect x="14" y="8" width="4" height="16" rx="1" fill="${e}"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="${e}"/>`,photo:(e="#fff",t="#667eea")=>`<rect x="8" y="10" width="16" height="12" rx="2" fill="${e}"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" cy="13" r="1" fill="${t}"/>`,music:(e="#fff")=>`<ellipse cx="12" cy="21" rx="2.5" ry="2" fill="${e}"/>
      <rect x="14" y="10" width="2" height="9" fill="${e}"/>
      <rect x="14" y="10" width="6" height="2" fill="${e}"/>`,start:(e="#fff")=>`<path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="${e}"/>`,finish:(e="#fff")=>`<rect x="10" y="8" width="4" height="4" fill="${e}"/>
      <rect x="14" y="12" width="4" height="4" fill="${e}"/>
      <rect x="18" y="8" width="4" height="4" fill="${e}"/>
      <rect x="10" y="16" width="4" height="4" fill="${e}"/>
      <rect x="18" y="16" width="4" height="4" fill="${e}"/>
      <rect x="14" y="20" width="4" height="4" fill="${e}"/>`,toilet:(e="#fff",t="#667eea")=>`<rect x="11" y="7" width="10" height="3" rx="1" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="${e}" stroke-width="2" fill="none" stroke-linecap="round"/>`,shower:(e="#fff")=>`<circle cx="16" cy="10" r="3" fill="${e}"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="${e}"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>`,bus:(e="#fff",t="#667eea")=>`<rect x="9" y="9" width="14" height="12" rx="2" fill="${e}"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="${e}"/>
      <circle cx="12" cy="21" r="1.5" fill="${e}"/>
      <circle cx="20" cy="21" r="1.5" fill="${e}"/>`,info:(e="#fff")=>`<circle cx="16" cy="10" r="2" fill="${e}"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="${e}"/>`,merch:(e="#fff")=>`<path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="${e}"/>
      <path d="M13 10 L16 7 L19 10" stroke="${e}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`,cone:(e="#fff",t="#667eea")=>`<path d="M16 6 L21 22 H11 L16 6Z" fill="${e}"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="${e}"/>`,traffic:(e="#fff")=>`<rect x="12" y="6" width="8" height="20" rx="2" fill="${e}"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>`,car:(e="#fff",t="#667eea")=>`<rect x="6" y="13" width="20" height="8" rx="2" fill="${e}"/>
      <path d="M10 13 L12 9 L20 9 L22 13" fill="${e}" stroke="${e}" stroke-width="1"/>
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${t}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${t}"/>
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>`,bike:(e="#fff")=>`<circle cx="9" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="9" cy="20" r="1" fill="${e}"/>
      <circle cx="23" cy="20" r="1" fill="${e}"/>
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="${e}" stroke-width="2" stroke-linejoin="round"/>
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="${e}"/>`,"arrow-uturn-left":(e="#fff")=>`<path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7 15 L12 21 L17 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-left":(e="#fff")=>`<path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="${e}"/>`,"arrow-slight-left":(e="#fff")=>`<g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-straight":(e="#fff")=>`<path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>`,"arrow-slight-right":(e="#fff")=>`<g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-right":(e="#fff")=>`<path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="${e}"/>`,"arrow-uturn-right":(e="#fff")=>`<path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 15 L20 21 L25 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-fork-left":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Left arrowhead -->
      <path d="M10 12 L6 10 L8 16 Z" fill="${e}"/>
      <!-- Wrong way indicator on right -->
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>`,"arrow-fork-right":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <!-- Wrong way indicator on left -->
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Right arrowhead -->
      <path d="M22 12 L26 10 L24 16 Z" fill="${e}"/>`,"arrow-keep-left":(e="#fff")=>`<g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-keep-right":(e="#fff")=>`<g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,track:(e="#fff")=>`
      <rect x="10" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="19.5" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="8" y="9" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="14.5" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="20" width="16" height="2.5" rx="0.5" fill="${e}"/>`,tunnel:(e="#fff")=>`
      <path d="M7 25 L7 14 C7 8 11 5 16 5 C21 5 25 8 25 14 L25 25" fill="none" stroke="${e}" stroke-width="2.5"/>
      <path d="M11 25 L11 16 C11 12 13 10 16 10 C19 10 21 12 21 16 L21 25" fill="none" stroke="${e}" stroke-width="1.5" opacity="0.6"/>`,bridge:(e="#fff")=>`
      <rect x="5" y="18" width="22" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="7" y="10" width="2" height="8" fill="${e}"/>
      <rect x="23" y="10" width="2" height="8" fill="${e}"/>
      <path d="M8 10 Q16 6 24 10" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <line x1="12" y1="13" x2="12" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="16" y1="11.5" x2="16" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="20" y1="13" x2="20" y2="18" stroke="${e}" stroke-width="1.5"/>`,plane:(e="#fff")=>`
      <g fill="${e}">
        <!-- Fuselage body -->
        <path d="M27 16 L24 14 L8 14 Q4 16 8 18 L24 18 L27 16 Z"/>
        <!-- Nose cone -->
        <path d="M8 14 Q4 16 8 18 L8 14 Z"/>
        <!-- Tail fin -->
        <path d="M26 14 L26 9 L22 14 Z"/>
        <!-- Main wing -->
        <path d="M20 16 L16 10 L14 10 L16 16 L14 22 L16 22 L20 16 Z"/>
        <!-- Cockpit window -->
        <ellipse cx="10" cy="16" rx="1.5" ry="1" fill="none" stroke="${e}" stroke-width="0.5" opacity="0.6"/>
      </g>`,hill:(e="#fff")=>`
      <path d="M6 24 L13 12 L16 16 L20 10 L26 24 Z" fill="${e}"/>
      <path d="M20 10 L22 13 L18 13 Z" fill="${e}" opacity="0.6"/>`,baggage:(e="#fff")=>`
      <rect x="8" y="12" width="16" height="12" rx="2" fill="${e}"/>
      <rect x="12" y="8" width="8" height="4" rx="1" fill="none" stroke="${e}" stroke-width="2"/>
      <line x1="12" y1="16" x2="20" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
      <line x1="12" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>`,crown:(e="#fff")=>`
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="${e}"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="${e}"/>`,crossing:(e="#fff")=>`
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="${e}" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="${e}" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="${e}"/>
      <path d="M16 10 L16 16" stroke="${e}" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>`,trees:(e="#fff")=>`
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="${e}"/>
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="${e}"/>`};function qt({type:e,backgroundShape:t="circle",backgroundColor:o,borderColor:i,iconColor:s,size:a="100",outputSize:l=null}){if(!e||e==="default"){if(!(o||i||s||t&&t!=="circle"&&t!=="default"))return null;e=t&&t!=="default"?t:"circle"}const u=ii(e),h=parseInt(a,10)/100,p=l||Math.round(32*h);let f="";if(u.isShapeOnly){const y=o||u.defaultColor||"#667eea",k=i||"#fff";if($i[e])f=$i[e]({backgroundColor:y,borderColor:k});else return Bc[e]?.(y,p)||null}else{const y=o||"#667eea",k=i||"#fff",I=s||"#fff",M=t||"circle";M!=="none"&&$i[M]&&(f+=$i[M]({backgroundColor:y,borderColor:k})),vh[e]&&(f+=vh[e](I,y))}return`<svg width="${p}" height="${p}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
    ${f}
  </svg>`}const rw={full:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#10B981" stroke="#fff" stroke-width="1.5"/>
    <path d="M4 7l2 2 4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </svg>`,partial:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#F59E0B" stroke="#fff" stroke-width="1.5"/>
    <rect x="6" y="3.5" width="2" height="4.5" rx="1" fill="#fff"/>
    <circle cx="7" cy="10" r="1" fill="#fff"/>
  </svg>`,missing:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#EF4444" stroke="#fff" stroke-width="1.5"/>
    <path d="M4.5 4.5l5 5M9.5 4.5l-5 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
  </svg>`};function lw(e,t){return e===0?"missing":e>=t?"full":"partial"}function Nc(e,t){const o=lw(e,t);return rw[o]}function cw(e,t,o=32){if(e==="default")return null;if(ph[e])return ph[e](o);if(Bc[e]){const i=t||"#667eea";return Bc[e](i,o)}return null}const uw=["circle","square","hexagon","pentagon"];function dw(e){return uw.includes(e)}function hw(e,t,o,i,s=32,a=!0){const l=cw(e,t,s),u=Nc(o,i);if(!l)return null;const h=a&&dw(e),p=aw(e,t),f=pw(p),y=Fp(p)?"0 1px 2px rgba(255,255,255,0.5)":"0 1px 2px rgba(0,0,0,0.5)",k=s>=36?"12px":"10px",I=h?`
    <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: ${f};
      font-weight: bold;
      font-size: ${k};
      text-shadow: ${y};
      pointer-events: none;
    ">${o}/${i}</div>
  `:"";return`
    <div style="position: relative; width: ${s}px; height: ${s}px;">
      ${l}
      ${I}
      <div style="position: absolute; bottom: -4px; right: -4px;">
        ${u}
      </div>
    </div>
  `}function fw(e){const t=e.replace("#",""),o=parseInt(t.substr(0,2),16)/255,i=parseInt(t.substr(2,2),16)/255,s=parseInt(t.substr(4,2),16)/255,a=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),l=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*a+.7152*l+.0722*u}function Fp(e){return!e||e.length<6?!1:fw(e)>.4}function pw(e){return Fp(e)?"#1F2937":"#FFFFFF"}const vw="#667eea",mw={__name:"MapView",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},clickable:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","polygon-complete","polygon-drawing"],setup(e,{expose:t,emit:o}){const i=e,s=o,a=P(null);let l=null;const u=P([]),h=P([]),p=P([]);let f=null,y=null;const k=()=>{if(l){const ne=l.getCenter();return{lat:ne.lat,lng:ne.lng}}return null},I=()=>l?l.getZoom():null,M=()=>{if(u.value.length>0){p.value.push([...u.value]);const ne=h.value.pop()||[];u.value=ne,ue(),s("polygon-drawing",u.value)}},b=()=>{if(p.value.length>0){h.value.push([...u.value]);const ne=p.value.pop();u.value=ne,ue(),s("polygon-drawing",u.value)}},B=()=>u.value.length>0,E=()=>p.value.length>0,A=()=>u.value.length,C=()=>{u.value.length>=3&&(s("polygon-complete",[...u.value]),x())},x=()=>{u.value=[],h.value=[],p.value=[],ue()};t({getMapCenter:k,getMapZoom:I,undoPolygonPoint:M,redoPolygonPoint:b,canUndo:B,canRedo:E,getPolygonPointCount:A,completePolygon:C,clearPolygonDrawing:x});const T=P([]);let S=null;const $=P(!0),se=P(!1),ce=P(new Set),_e=P([]);let ae=null,pe=null;const Ie=(ne,Ee,xe,we,re=!1)=>{const ve=xe?"36px":we?"20px":"30px",q=xe?"#667eea":"white",fe=re?"":Nc(ne,Ee);return`
    <div style="position: relative; width: ${ve}; height: ${ve};">
      <div style="
        background-color: ${vw};
        width: ${ve};
        height: ${ve};
        border-radius: 50%;
        border: 3px solid ${q};
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      "></div>
      ${re?"":`<div style="position: absolute; bottom: -4px; right: -4px;">
        ${fe}
      </div>`}
    </div>
  `},Be=()=>{if(!l)return;const ne=ow(l,T.value),Ee=Array.from(ce.value).sort().join(","),xe=Array.from(ne).sort().join(",");Ee!==xe&&(ce.value=ne,Oe())},Se=()=>{if(pe&&(pe.remove(),pe=null),!l||!i.userLocation)return;const ne=un.divIcon({className:"user-location-marker",html:`
      <div style="
        position: relative;
        width: 20px;
        height: 20px;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #4285f4;
          border: 3px solid white;
          border-radius: 50%;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        "></div>
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 40px;
          height: 40px;
          background-color: rgba(66, 133, 244, 0.2);
          border-radius: 50%;
          animation: pulse 2s ease-out infinite;
        "></div>
      </div>
    `,iconSize:[40,40],iconAnchor:[20,20]});pe=un.marker([i.userLocation.lat,i.userLocation.lng],{icon:ne}).addTo(l).bindPopup("Your location")},he=()=>{if(!a.value)return;let ne=51.505,Ee=-.09,xe=13;const we=i.allLocationsForBounds.length>0?i.allLocationsForBounds:i.locations,re=(q,fe)=>q!=null&&fe!=null&&!(q===0&&fe===0),ve=[];we.length>0&&ve.push(...we.filter(q=>re(q.latitude,q.longitude)).map(q=>({lat:q.latitude,lng:q.longitude}))),i.route&&i.route.length>0&&ve.push(...i.route.filter(q=>re(q.lat,q.lng)).map(q=>({lat:q.lat,lng:q.lng}))),i.center?(ne=i.center.lat,Ee=i.center.lng,xe=i.zoom??13):ve.length>0&&(ne=ve.reduce((q,fe)=>q+fe.lat,0)/ve.length,Ee=ve.reduce((q,fe)=>q+fe.lng,0)/ve.length,xe=10),l=un.map(a.value).setView([ne,Ee],xe),un.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(l),i.clickable&&l.on("click",q=>{i.drawingMode||s("map-click",{lat:q.latlng.lat,lng:q.latlng.lng})}),l.on("zoomend moveend",()=>{be?Oe():Be()}),Oe(),Q(),X(),Se(),te()},Q=()=>{if(S&&(S.remove(),S=null),!l||i.route.length===0)return;const ne=i.route.map(Ee=>[Ee.lat,Ee.lng]);S=un.polyline(ne,{color:"blue",weight:4,opacity:.7}).addTo(l)},X=()=>{_e.value.forEach(ne=>ne.remove()),_e.value=[],!(!l||i.areas.length===0)&&i.areas.forEach(ne=>{const Ee=typeof ne.polygon=="string"?JSON.parse(ne.polygon):ne.polygon;if(!Ee||Ee.length===0)return;const xe=Ee.map(q=>[q.lat,q.lng]),we=ne.id===i.selectedAreaId,re=ne.color||"#667eea",ve=un.polygon(xe,{color:re,fillColor:re,fillOpacity:we?.4:.2,weight:we?3:2,opacity:.8}).addTo(l);ve.setStyle({pane:"overlayPane"}),i.drawingMode||(ve.on("click",()=>s("area-click",ne)),ve.on("mouseover",()=>{ve.setStyle({fillOpacity:.4})}),ve.on("mouseout",()=>{ve.setStyle({fillOpacity:we?.4:.2})})),_e.value.push(ve)})},ue=()=>{if(l&&(f&&(f.remove(),f=null),y&&(y.remove(),y=null),u.value.length!==0&&(y=un.layerGroup().addTo(l),u.value.forEach((ne,Ee)=>{const xe=Ee===0,we=Ee===u.value.length-1,re=un.divIcon({className:"polygon-point-marker",html:`<div style="
        width: ${xe?"16px":"12px"};
        height: ${xe?"16px":"12px"};
        background-color: ${xe?"#667eea":we?"#ff9800":"white"};
        border: 3px solid #667eea;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      "></div>`,iconSize:[xe?16:12,xe?16:12],iconAnchor:[xe?8:6,xe?8:6]});un.marker([ne.lat,ne.lng],{icon:re,interactive:!1}).addTo(y)}),u.value.length>=2))){const ne=u.value.map(Ee=>[Ee.lat,Ee.lng]);u.value.length>=3&&ne.push(ne[0]),f=un.polyline(ne,{color:"#667eea",weight:3,opacity:.8,dashArray:u.value.length<3?"10, 10":null}).addTo(l)}},te=()=>{if(!l)return;if(ae||(ae=new un.FeatureGroup,l.addLayer(ae)),l._customDrawingHandlers&&(l.off("click",l._customDrawingHandlers.handleClick),l.getContainer().removeEventListener("touchstart",l._customDrawingHandlers.handleTouchStart),l.getContainer().removeEventListener("touchend",l._customDrawingHandlers.handleTouchEnd),l.getContainer().removeEventListener("touchmove",l._customDrawingHandlers.handleTouchMove),delete l._customDrawingHandlers),!i.drawingMode){x(),ae&&ae.clearLayers();return}let ne=0,Ee=null,xe=!1,we=!1;const re=300,ve=15,q=Y=>{h.value.push([...u.value]),p.value=[],u.value.push({lat:Y.lat,lng:Y.lng}),ue(),s("polygon-drawing",u.value)},fe=Y=>{Y.originalEvent&&Y.originalEvent.sourceCapabilities?.firesTouchEvents||q(Y.latlng)},Le=Y=>{if(Y.touches.length>1){we=!0;return}we=!1,ne=Date.now(),Ee={x:Y.touches[0].clientX,y:Y.touches[0].clientY},xe=!1},U=Y=>{if(!Ee||we)return;const Z=Y.touches[0].clientX-Ee.x,N=Y.touches[0].clientY-Ee.y;Math.sqrt(Z*Z+N*N)>ve&&(xe=!0)},H=Y=>{if(we){we=!1,Ee=null;return}if(Date.now()-ne<re&&!xe&&Ee){const N=Y.changedTouches[0],O=un.point(N.clientX-l.getContainer().getBoundingClientRect().left,N.clientY-l.getContainer().getBoundingClientRect().top),W=l.containerPointToLatLng(O);Y.preventDefault(),Y.stopPropagation(),q(W)}Ee=null,xe=!1};l.on("click",fe),l.getContainer().addEventListener("touchstart",Le,{passive:!0}),l.getContainer().addEventListener("touchmove",U,{passive:!0}),l.getContainer().addEventListener("touchend",H,{passive:!1}),l._customDrawingHandlers={handleClick:fe,handleTouchStart:Le,handleTouchMove:U,handleTouchEnd:H},ue()};let be=!1;const Oe=()=>{if(l&&l._animatingZoom){be=!0;return}if(be=!1,T.value.forEach(ne=>{ne._map&&(ne.off(),ne.remove())}),T.value=[],!!l){if(i.locations.forEach(ne=>{const Ee=ne.latitude??ne.Latitude,xe=ne.longitude??ne.Longitude;if(Ee==null||xe==null||Ee===0&&xe===0)return;const we=ne.checkedInCount||0,re=ne.requiredMarshals||1,ve=i.highlightLocationId===ne.id||i.highlightLocationIds.includes(ne.id),q=i.simplifyNonHighlighted&&!ve,fe=ne.resolvedStyleType||ne.ResolvedStyleType,Le=ne.resolvedStyleBackgroundColor||ne.ResolvedStyleBackgroundColor||ne.resolvedStyleColor||ne.ResolvedStyleColor,U=ne.resolvedStyleBorderColor||ne.ResolvedStyleBorderColor,H=ne.resolvedStyleIconColor||ne.ResolvedStyleIconColor,Y=ne.resolvedStyleBackgroundShape||ne.ResolvedStyleBackgroundShape,Z=fe&&fe!=="default"||Le||U||H||Y&&Y!=="circle"&&Y!=="default",N=ne.resolvedStyleMapRotation??ne.ResolvedStyleMapRotation??ne.styleMapRotation??ne.StyleMapRotation??0,O=parseInt(N,10)||0,W=ne.areaColor||"#999",me=ne.areaId&&!i.marshalMode,ke=ce.value.has(ne.id)&&ne.description?`${ne.name}: ${Np(ne.description,50)}`:ne.name,Ne=ve?`
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid #667eea;
        border-radius: 50%;
        animation: highlight-pulse 1.5s ease-out infinite;
      "></div>
    `:"",Fe=ve?"#667eea":q?"#e0e0e0":"white",Ue=ve?"white":q?"#888":"#333";let We;if(q){const tt="20px";We=`
        <div style="
          background-color: #999;
          width: ${tt};
          height: ${tt};
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        "></div>
      `}const oe=!i.marshalMode,ee=Nc(we,re),j=oe?`<div style="
      position: absolute;
      bottom: -2px;
      right: -6px;
      background-color: white;
      border-radius: 8px;
      padding: 1px 4px;
      font-size: 9px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    ">${we}/${re}</div>`:"";if(Z){const tt=ve?40:32,St=ne.resolvedStyleSize||ne.ResolvedStyleSize||"100",$t=qt({type:ne.resolvedStyleType||ne.ResolvedStyleType,backgroundShape:ne.resolvedStyleBackgroundShape||ne.ResolvedStyleBackgroundShape||"circle",backgroundColor:ne.resolvedStyleBackgroundColor||ne.ResolvedStyleBackgroundColor||ne.resolvedStyleColor||ne.ResolvedStyleColor||"",borderColor:ne.resolvedStyleBorderColor||ne.ResolvedStyleBorderColor||"",iconColor:ne.resolvedStyleIconColor||ne.ResolvedStyleIconColor||"",size:St});$t?We=$t:We=hw(ne.resolvedStyleType,ne.resolvedStyleColor,we,re,tt,oe)||Ie(we,re,ve,i.marshalMode,!0)}else We=Ie(we,re,ve,i.marshalMode,!0);const Ve=O!==0?`transform: rotate(${O}deg);`:"",Xe=un.divIcon({className:"custom-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
          ${Ne}
          <div style="position: relative; display: flex; align-items: center; gap: 4px;">
            ${me?`<div style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background-color: ${W};
              border: 2px solid white;
              box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            "></div>`:""}
            <div style="position: relative; display: inline-block;">
              <div style="${Ve}">
                ${We}
              </div>
              ${q?"":`<div style="position: absolute; top: -4px; right: -4px;">
                ${ee}
              </div>`}
              ${q?"":j}
            </div>
          </div>
          <div style="
            background-color: ${Fe};
            padding: 2px 6px;
            border-radius: 3px;
            font-size: ${ve?"12px":"11px"};
            font-weight: bold;
            color: ${Ue};
            white-space: nowrap;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${ke}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]}),nt=i.marshalMode?`<b>${ne.name}</b>${ne.description?`<br>${ne.description}`:""}`:`<b>${ne.name}</b><br>${ne.description||""}<br>Checked in: ${we}/${re}`,at=un.marker([ne.latitude,ne.longitude],{icon:Xe}).addTo(l).bindPopup(nt);at.on("click",()=>{s("location-click",ne)}),at.locationData=ne,T.value.push(at)}),l&&$.value&&!i.center&&!se.value){const ne=[],Ee=i.allLocationsForBounds.length>0?i.allLocationsForBounds:i.locations,xe=(we,re)=>we!=null&&re!=null&&!(we===0&&re===0);if(Ee.length>0&&ne.push(...Ee.filter(we=>xe(we.latitude,we.longitude)).map(we=>[we.latitude,we.longitude])),i.route.length>0&&ne.push(...i.route.filter(we=>xe(we.lat,we.lng)).map(we=>[we.lat,we.lng])),ne.length>0){const we=un.latLngBounds(ne);l.fitBounds(we,{padding:[50,50]}),$.value=!1,se.value=!0}}else i.center&&($.value=!1);setTimeout(()=>{l&&!l._animatingZoom&&Be()},100)}};return Qt(()=>{se.value=!1,$.value=!0,he();let ne,Ee=0,xe=0;const we=new ResizeObserver(re=>{if(l&&re.length>0){const{width:ve,height:q}=re[0].contentRect;(Math.abs(ve-Ee)>10||Math.abs(q-xe)>10)&&(Ee=ve,xe=q,clearTimeout(ne),ne=setTimeout(()=>{l.invalidateSize()},150))}});a.value&&we.observe(a.value),po(()=>{clearTimeout(ne),we.disconnect()})}),qe(()=>i.locations,ne=>{if(Oe(),l&&!se.value&&ne.length>0&&!i.center){const Ee=ne.map(ve=>ve.latitude),xe=ne.map(ve=>ve.longitude),we=Ee.reduce((ve,q)=>ve+q,0)/Ee.length,re=xe.reduce((ve,q)=>ve+q,0)/xe.length;l.setView([we,re],10),se.value=!0,$.value=!1}},{deep:!0}),qe(()=>i.route,ne=>{if(Q(),Oe(),l&&!se.value&&ne&&ne.length>0&&!i.center){const Ee=ne.map(ve=>ve.lat),xe=ne.map(ve=>ve.lng),we=Ee.reduce((ve,q)=>ve+q,0)/Ee.length,re=xe.reduce((ve,q)=>ve+q,0)/xe.length;l.setView([we,re],10),se.value=!0,$.value=!1}},{deep:!0}),qe(()=>i.center,ne=>{l&&l.setView([ne.lat,ne.lng],i.zoom)}),qe(()=>i.areas,()=>{X()},{deep:!0}),qe(()=>i.selectedAreaId,()=>{X()}),qe(()=>i.drawingMode,()=>{te()}),qe(()=>i.userLocation,()=>{Se()},{deep:!0}),qe(()=>i.highlightLocationId,()=>{Oe()}),qe(()=>i.highlightLocationIds,()=>{Oe()},{deep:!0}),qe(()=>i.marshalMode,()=>{Oe()}),qe(()=>i.simplifyNonHighlighted,()=>{Oe()}),qe(()=>i.clickable,ne=>{l&&(l.off("click"),ne&&l.on("click",Ee=>{i.drawingMode||s("map-click",{lat:Ee.latlng.lat,lng:Ee.latlng.lng})}))}),(ne,Ee)=>(m(),g("div",{ref_key:"mapContainer",ref:a,class:"map-container"},null,512))}},ei=Ye(mw,[["__scopeId","data-v-295c929a"]]);function Cn(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}const gw={class:"areas-selection"},yw={key:0,class:"areas-selection-header"},_w={class:"areas-list"},kw=["checked","onChange"],bw={__name:"AreasSelection",props:{areas:{type:Array,default:()=>[]},selectedAreaIds:{type:Array,default:()=>[]}},emits:["update:selectedAreaIds"],setup(e,{emit:t}){const o=e,i=t,s=J(()=>[...o.areas].sort((h,p)=>h.displayOrder!==p.displayOrder?h.displayOrder-p.displayOrder:Cn(h.name,p.name))),a=J(()=>o.areas.length>0&&o.selectedAreaIds.length===o.areas.length),l=h=>{const p=[...o.selectedAreaIds],f=p.indexOf(h);f>=0?p.splice(f,1):p.push(h),i("update:selectedAreaIds",p)},u=()=>{a.value?i("update:selectedAreaIds",[]):i("update:selectedAreaIds",o.areas.map(h=>h.id))};return(h,p)=>(m(),g("div",gw,[e.areas.length>1?(m(),g("div",yw,[c("button",{onClick:u,class:"toggle-all-btn"},_(a.value?"Deselect all":"Select all"),1)])):R("",!0),c("div",_w,[(m(!0),g(Ce,null,Re(s.value,f=>(m(),g("label",{class:"area-checkbox",key:f.id},[c("input",{type:"checkbox",checked:e.selectedAreaIds.includes(f.id),onChange:y=>l(f.id)},null,40,kw),c("span",{class:"area-color-dot",style:st({backgroundColor:f.color||"#667eea"})},null,4),Ze(" "+_(f.name),1)]))),128))])]))}},Up=Ye(bw,[["__scopeId","data-v-46364246"]]),ww={class:"course-areas-tab"},Cw={class:"map-wrapper"},Lw={key:0,class:"drawing-controls"},Sw={class:"point-count"},xw={class:"undo-redo-buttons"},Tw=["disabled"],Iw=["disabled"],$w={key:0},Mw={key:1},Aw={key:0,class:"filters-content"},Ew={class:"filter-section"},Pw={class:"filter-checkbox"},Dw={class:"filter-checkbox"},Ow={class:"filter-checkbox"},Rw={class:"filter-checkbox"},Bw={class:"filter-checkbox"},Nw={key:0,class:"filter-section"},Fw={key:0},Uw={key:1},zw={key:0,class:"add-menu-content"},Hw={__name:"CourseAreasTab",props:{checkpoints:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1}},emits:["map-click","location-click","area-click","import-checkpoints","upload-route","select-location","add-area","select-area","polygon-complete","cancel-drawing","add-checkpoint-from-map","add-many-checkpoints-from-map","add-area-from-map"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=Ct(),a=e,l=o,u=P(null),h=P(null),p=P(!0),f=P(!1),y=P(null),k=P(0),I=P(!1),M=P(!1),b=P({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreas:[]}),B=()=>{p.value=!p.value,p.value||(f.value=!1)},E=()=>{f.value=!f.value,f.value&&(p.value=!0)},A=he=>{f.value=!1,he==="checkpoint"?(l("add-checkpoint-from-map"),ce()):he==="many-checkpoints"?(l("add-many-checkpoints-from-map"),ce()):he==="area"&&(l("add-area-from-map"),ce())},C=()=>{f.value=!1,l("import-checkpoints")},x=()=>{f.value=!1,l("upload-route")},T=he=>{k.value=he?.length||0,S()},S=()=>{h.value&&(I.value=h.value.canUndo(),M.value=h.value.canRedo())},$=()=>{h.value&&(h.value.undoPolygonPoint(),S())},se=()=>{h.value&&(h.value.redoPolygonPoint(),S())},ce=()=>{u.value&&u.value.scrollIntoView({behavior:"smooth",block:"start"})};t({scrollMapIntoView:ce,getMapCenter:()=>h.value?.getMapCenter()||null,getMapZoom:()=>h.value?.getMapZoom()||null}),qe(()=>a.areas,he=>{if(he.length>0){const Q=new Set(b.value.selectedAreas);he.forEach(X=>{Q.has(X.id)||b.value.selectedAreas.push(X.id)}),b.value.selectedAreas=b.value.selectedAreas.filter(X=>he.some(ue=>ue.id===X))}},{immediate:!0}),qe(()=>a.drawingMode,he=>{he||(k.value=0,I.value=!1,M.value=!1)}),J(()=>[...a.areas].sort((he,Q)=>he.displayOrder!==Q.displayOrder?he.displayOrder-Q.displayOrder:Cn(he.name,Q.name)));const pe=J(()=>b.value.showRoute?a.route:[]),Ie=he=>{const Q=he.checkedInCount||0,X=he.requiredMarshals||1;return Q===0?"unchecked":Q>=X?"full":"partial"},Be=J(()=>!b.value.showUncheckedIn&&!b.value.showPartiallyCheckedIn&&!b.value.showFullyCheckedIn?[]:a.checkpoints.filter(he=>{const Q=Ie(he);if(Q==="unchecked"&&!b.value.showUncheckedIn||Q==="partial"&&!b.value.showPartiallyCheckedIn||Q==="full"&&!b.value.showFullyCheckedIn)return!1;const X=he.areaIds||he.AreaIds;return X&&Array.isArray(X)?X.some(ue=>b.value.selectedAreas.includes(ue)):he.areaId?b.value.selectedAreas.includes(he.areaId):!1})),Se=J(()=>b.value.showAreas?a.areas.filter(he=>b.value.selectedAreas.includes(he.id)):[]);return(he,Q)=>(m(),g("div",ww,[c("div",{class:"map-section",ref_key:"mapSection",ref:u},[c("div",Cw,[ze(ei,{ref_key:"mapView",ref:h,locations:Be.value,route:pe.value,areas:Se.value,"all-locations-for-bounds":e.checkpoints,"selected-area-id":e.selectedAreaId,clickable:!0,"drawing-mode":e.drawingMode,onMapClick:Q[0]||(Q[0]=X=>he.$emit("map-click",X)),onLocationClick:Q[1]||(Q[1]=X=>he.$emit("location-click",X)),onAreaClick:Q[2]||(Q[2]=X=>he.$emit("area-click",X)),onPolygonComplete:Q[3]||(Q[3]=X=>he.$emit("polygon-complete",X)),onPolygonDrawing:T},null,8,["locations","route","areas","all-locations-for-bounds","selected-area-id","drawing-mode"]),e.drawingMode&&k.value>0?(m(),g("div",Lw,[c("div",Sw,_(k.value)+" point"+_(k.value!==1?"s":""),1),c("div",xw,[c("button",{onClick:$,class:"btn-drawing undo-btn",disabled:!I.value,title:"Undo last point"},"  Undo ",8,Tw),c("button",{onClick:se,class:"btn-drawing redo-btn",disabled:!M.value,title:"Redo point"}," Redo  ",8,Iw)])])):R("",!0)]),f.value?R("",!0):(m(),g("div",{key:0,class:Te(["visibility-filters",{collapsed:p.value}])},[c("button",{onClick:B,class:"filters-toggle"},[p.value?(m(),g("span",$w,"Show...")):(m(),g("span",Mw,""))]),p.value?R("",!0):(m(),g("div",Aw,[c("div",Ew,[Q[13]||(Q[13]=c("h4",null,"Show on map:",-1)),c("label",Pw,[je(c("input",{type:"checkbox","onUpdate:modelValue":Q[4]||(Q[4]=X=>b.value.showRoute=X)},null,512),[[Ls,b.value.showRoute]]),Ze(" "+_(z(i).course),1)]),c("label",Dw,[je(c("input",{type:"checkbox","onUpdate:modelValue":Q[5]||(Q[5]=X=>b.value.showUncheckedIn=X)},null,512),[[Ls,b.value.showUncheckedIn]]),Ze(" Unchecked-in "+_(z(s).checkpoints),1)]),c("label",Ow,[je(c("input",{type:"checkbox","onUpdate:modelValue":Q[6]||(Q[6]=X=>b.value.showPartiallyCheckedIn=X)},null,512),[[Ls,b.value.showPartiallyCheckedIn]]),Ze(" Partially checked-in "+_(z(s).checkpoints),1)]),c("label",Rw,[je(c("input",{type:"checkbox","onUpdate:modelValue":Q[7]||(Q[7]=X=>b.value.showFullyCheckedIn=X)},null,512),[[Ls,b.value.showFullyCheckedIn]]),Ze(" Fully checked-in "+_(z(s).checkpoints),1)]),c("label",Bw,[je(c("input",{type:"checkbox","onUpdate:modelValue":Q[8]||(Q[8]=X=>b.value.showAreas=X)},null,512),[[Ls,b.value.showAreas]]),Ze(" "+_(z(i).areas),1)])]),e.areas.length>0&&b.value.showAreas?(m(),g("div",Nw,[c("h4",null,"Filter "+_(z(s).areas)+":",1),ze(Up,{areas:e.areas,"selected-area-ids":b.value.selectedAreas,"onUpdate:selectedAreaIds":Q[9]||(Q[9]=X=>b.value.selectedAreas=X)},null,8,["areas","selected-area-ids"])])):R("",!0)]))],2)),p.value?(m(),g("div",{key:1,class:Te(["add-menu",{expanded:f.value}])},[c("button",{onClick:E,class:"add-toggle",ref_key:"addButtonRef",ref:y},[f.value?(m(),g("span",Fw,"")):(m(),g("span",Uw,"Add..."))],512),f.value?(m(),g("div",zw,[c("button",{onClick:Q[10]||(Q[10]=X=>A("checkpoint")),class:"add-menu-item"}," Checkpoint "),c("button",{onClick:Q[11]||(Q[11]=X=>A("many-checkpoints")),class:"add-menu-item"}," Many checkpoints "),c("button",{onClick:Q[12]||(Q[12]=X=>A("area")),class:"add-menu-item"}," Area "),c("button",{onClick:C,class:"add-menu-item"}," Import checkpoints... "),c("button",{onClick:x,class:"add-menu-item"}," Upload route... ")])):R("",!0)],2)):R("",!0)],512)]))}},Vw=Ye(Hw,[["__scopeId","data-v-08ee7bde"]]),Gw=(e,t)=>{const o=String(e).trim(),i=String(t).trim(),s=parseFloat(o),a=parseFloat(i),l=!isNaN(s)&&String(s)===o,u=!isNaN(a)&&String(a)===i;return l&&u?s-a:o.localeCompare(i,void 0,{numeric:!0,sensitivity:"base"})},Zw=e=>e&&e.isCheckedIn?"":"",jw={class:"marshals-tab"},Ww={class:"marshals-tab-header"},qw={class:"button-group"},Kw={class:"marshals-grid"},Yw={class:"marshals-table"},Jw={key:0,class:"sort-indicator"},Xw={key:0,class:"sort-indicator"},Qw={key:0,class:"sort-indicator"},e0={key:0,class:"sort-indicator"},t0=["onClick"],n0=["rowspan"],o0=["value","onChange"],s0=["rowspan"],i0={key:0,class:"last-active-text"},a0={key:1,class:"last-active-never"},r0=["onClick"],l0={style:{color:"#999","font-style":"italic"}},c0={class:"hide-on-mobile last-active-cell"},u0={key:0,class:"last-active-text"},d0={key:1,class:"last-active-never"},h0={__name:"MarshalsTab",props:{marshals:{type:Array,required:!0},assignments:{type:Array,required:!0},locations:{type:Array,required:!0}},emits:["add-marshal","import-marshals","select-marshal","delete-marshal","change-assignment-status"],setup(e,{emit:t}){const{terms:o}=Ct(),i=e,s=P("name"),a=P("asc"),l=I=>{s.value===I?a.value=a.value==="asc"?"desc":"asc":(s.value=I,a.value="asc")},u=I=>i.assignments.filter(M=>M.marshalId===I),h=I=>{const M=i.locations.find(b=>b.id===I);return M?M.name:"Unknown"},p=I=>{if(!I)return"";const M=new Date(I),B=new Date-M,E=Math.floor(B/6e4),A=Math.floor(E/60),C=Math.floor(A/24);return E<1?"just now":E<60?`${E}m ago`:A<24?`${A}h ago`:C===1?"yesterday":C<7?`${C}d ago`:M.toLocaleDateString()},f=J(()=>{const I=[...i.marshals];return I.sort((M,b)=>{let B=0;if(s.value==="name")B=M.name.localeCompare(b.name);else if(s.value==="checkpoint"){const E=u(M.id),A=u(b.id),C=E.length>0?h(E[0].locationId):"",x=A.length>0?h(A[0].locationId):"";B=Gw(C,x)}else if(s.value==="status"){const E=u(M.id),A=u(b.id),C=E.length>0&&E[0].isCheckedIn?1:0;B=(A.length>0&&A[0].isCheckedIn?1:0)-C}else if(s.value==="lastActive"){const E=M.lastAccessedDate?new Date(M.lastAccessedDate).getTime():0;B=(b.lastAccessedDate?new Date(b.lastAccessedDate).getTime():0)-E}return a.value==="asc"?B:-B}),I}),y=I=>I.isAdminCheckedIn?"admin-checked-in":I.isWrongLocation?"wrong-location":I.isCheckedIn?"checked-in":"not-checked-in",k=I=>I.isCheckedIn?"status-checked-in":"status-not-checked-in";return(I,M)=>(m(),g("div",jw,[c("div",Ww,[c("h2",null,_(z(o).people)+" management",1),c("div",qw,[c("button",{onClick:M[0]||(M[0]=b=>I.$emit("add-marshal")),class:"btn btn-primary"}," Add "+_(z(o).person.toLowerCase()),1),c("button",{onClick:M[1]||(M[1]=b=>I.$emit("import-marshals")),class:"btn btn-secondary"}," Import CSV ")])]),c("div",Kw,[c("table",Yw,[c("thead",null,[c("tr",null,[c("th",{onClick:M[2]||(M[2]=b=>l("name")),class:"sortable"},[M[7]||(M[7]=Ze(" Name ",-1)),s.value==="name"?(m(),g("span",Jw,_(a.value==="asc"?"":""),1)):R("",!0)]),c("th",{onClick:M[3]||(M[3]=b=>l("checkpoint")),class:"sortable"},[Ze(_(z(o).checkpoint)+" ",1),s.value==="checkpoint"?(m(),g("span",Xw,_(a.value==="asc"?"":""),1)):R("",!0)]),c("th",{onClick:M[4]||(M[4]=b=>l("status")),class:"sortable"},[M[8]||(M[8]=Ze(" Status ",-1)),s.value==="status"?(m(),g("span",Qw,_(a.value==="asc"?"":""),1)):R("",!0)]),c("th",{onClick:M[5]||(M[5]=b=>l("lastActive")),class:"sortable hide-on-mobile"},[M[9]||(M[9]=Ze(" Last active ",-1)),s.value==="lastActive"?(m(),g("span",e0,_(a.value==="asc"?"":""),1)):R("",!0)])])]),c("tbody",null,[(m(!0),g(Ce,null,Re(f.value,b=>(m(),g(Ce,{key:b.id},[u(b.id).length>0?(m(!0),g(Ce,{key:0},Re(u(b.id),(B,E)=>(m(),g("tr",{key:`${b.id}-${B.id}`,class:"marshal-row",onClick:A=>I.$emit("select-marshal",b)},[E===0?(m(),g("td",{key:0,rowspan:u(b.id).length},_(b.name),9,n0)):R("",!0),c("td",null,_(h(B.locationId)),1),c("td",{onClick:M[6]||(M[6]=vt(()=>{},["stop"]))},[c("select",{value:y(B),onChange:A=>I.$emit("change-assignment-status",{assignment:B,status:A.target.value}),class:Te(["status-select hide-on-mobile",k(B)])},[...M[10]||(M[10]=[c("option",{value:"not-checked-in"},"Not checked-in",-1),c("option",{value:"checked-in"},"Checked-in",-1),c("option",{value:"admin-checked-in"},"Admin checked-in",-1),c("option",{value:"wrong-location"},"Checked-in but not at correct location",-1)])],42,o0),c("span",{class:Te(["status-icon show-on-mobile",k(B)])},_(z(Zw)(B)),3)]),E===0?(m(),g("td",{key:1,rowspan:u(b.id).length,class:"hide-on-mobile last-active-cell"},[b.lastAccessedDate?(m(),g("span",i0,_(p(b.lastAccessedDate)),1)):(m(),g("span",a0,"Never"))],8,s0)):R("",!0)],8,t0))),128)):(m(),g("tr",{key:1,class:"marshal-row",onClick:B=>I.$emit("select-marshal",b)},[c("td",null,_(b.name),1),c("td",l0,"No "+_(z(o).checkpoint.toLowerCase())+" assigned",1),M[11]||(M[11]=c("td",null,[c("span",{class:"hide-on-mobile"},"-"),c("span",{class:"status-icon show-on-mobile",style:{color:"#999"}},"-")],-1)),c("td",c0,[b.lastAccessedDate?(m(),g("span",u0,_(p(b.lastAccessedDate)),1)):(m(),g("span",d0,"Never"))])],8,r0))],64))),128))])])])]))}},f0=Ye(h0,[["__scopeId","data-v-32d40275"]]),p0={class:"checklists-tab"},v0={class:"checklists-tab-header"},m0={class:"button-group"},g0={class:"filters-section"},y0={class:"filter-group"},_0={class:"filter-checkbox"},k0=["checked"],b0={key:0,class:"checkbox-dropdown"},w0={class:"checkbox-dropdown-header"},C0={class:"checkbox-list"},L0=["checked","onChange"],S0={class:"filter-group"},x0={class:"filter-checkbox"},T0=["checked"],I0={key:0,class:"checkbox-dropdown"},$0={class:"checkbox-dropdown-header"},M0={class:"checkbox-list"},A0=["checked","onChange"],E0={class:"filter-group"},P0={class:"filter-checkbox"},D0=["checked"],O0={key:0,class:"checkbox-dropdown"},R0={class:"checkbox-dropdown-header"},B0={class:"checkbox-list"},N0=["checked","onChange"],F0={class:"checklist-items-list"},U0={key:0,class:"empty-state"},z0={class:"checklist-item-content"},H0=["onClick"],V0={class:"checklist-item-scopes"},G0=["onClick"],Z0={__name:"ChecklistsTab",props:{checklistItems:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},completionReport:{type:Object,default:null}},emits:["add-checklist-item","select-checklist-item"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=e,a=P(!0),l=P(!0),u=P(!0),h=P([]),p=P([]),f=P([]),y=J(()=>[...s.areas].sort((ue,te)=>ue.displayOrder!==te.displayOrder?ue.displayOrder-te.displayOrder:Cn(ue.name,te.name))),k=J(()=>[...s.locations].sort((ue,te)=>Cn(ue.name,te.name))),I=J(()=>[...s.marshals].sort((ue,te)=>Cn(ue.name,te.name))),M=J(()=>s.areas.length>0&&h.value.length===s.areas.length),b=J(()=>s.locations.length>0&&p.value.length===s.locations.length),B=J(()=>s.marshals.length>0&&f.value.length===s.marshals.length),E=J(()=>!a.value||!l.value||!u.value),A=()=>{a.value=!a.value,!a.value&&h.value.length===0&&(h.value=s.areas.map(ue=>ue.id))},C=()=>{l.value=!l.value,!l.value&&p.value.length===0&&(p.value=s.locations.map(ue=>ue.id))},x=()=>{u.value=!u.value,!u.value&&f.value.length===0&&(f.value=s.marshals.map(ue=>ue.id))},T=ue=>{const te=h.value.indexOf(ue);te>=0?h.value.splice(te,1):h.value.push(ue)},S=ue=>{const te=p.value.indexOf(ue);te>=0?p.value.splice(te,1):p.value.push(ue)},$=ue=>{const te=f.value.indexOf(ue);te>=0?f.value.splice(te,1):f.value.push(ue)},se=()=>{M.value?h.value=[]:h.value=s.areas.map(ue=>ue.id)},ce=()=>{b.value?p.value=[]:p.value=s.locations.map(ue=>ue.id)},_e=()=>{B.value?f.value=[]:f.value=s.marshals.map(ue=>ue.id)},ae=()=>{a.value=!0,l.value=!0,u.value=!0,h.value=[],p.value=[],f.value=[]},pe=ue=>{const te=s.marshals.find(be=>be.id===ue);return!te||!te.assignments?[]:te.assignments.map(be=>be.locationId)},Ie=ue=>{const te=new Set;return ue.forEach(be=>{const Oe=s.locations.find(ne=>ne.id===be);Oe&&Oe.areaIds&&Oe.areaIds.forEach(ne=>te.add(ne))}),Array.from(te)},Be=(ue,te)=>{if(!te)return!1;const be=pe(ue),Oe=Ie(be);return te.scope==="SpecificPeople"&&te.itemType==="Marshal"?te.ids.includes(ue)||te.ids.includes("ALL_MARSHALS"):te.scope==="EveryoneAtCheckpoints"&&te.itemType==="Checkpoint"?te.ids.includes("ALL_CHECKPOINTS")||be.some(ne=>te.ids.includes(ne)):te.scope==="OnePerCheckpoint"&&te.itemType==="Checkpoint"?te.ids.includes("ALL_CHECKPOINTS")||be.some(ne=>te.ids.includes(ne)):te.scope==="OnePerCheckpoint"&&te.itemType==="Area"?te.ids.includes("ALL_AREAS")||Oe.some(ne=>te.ids.includes(ne)):te.scope==="EveryoneInAreas"&&te.itemType==="Area"?te.ids.includes("ALL_AREAS")||Oe.some(ne=>te.ids.includes(ne)):te.scope==="OnePerArea"&&te.itemType==="Area"?te.ids.includes("ALL_AREAS")||Oe.some(ne=>te.ids.includes(ne)):(te.scope==="EveryAreaLead"||te.scope==="OneLeadPerArea")&&te.itemType==="Area"?te.ids.includes("ALL_AREAS")||Oe.some(ne=>te.ids.includes(ne)):!1},Se=J(()=>{let ue=s.checklistItems;return!a.value&&h.value.length>0&&(ue=ue.filter(te=>te.scopeConfigurations?te.scopeConfigurations.some(be=>be.itemType==="Area"&&h.value.some(Oe=>be.ids.includes(Oe))):!1)),!l.value&&p.value.length>0&&(ue=ue.filter(te=>te.scopeConfigurations?te.scopeConfigurations.some(be=>be.itemType==="Checkpoint"&&p.value.some(Oe=>be.ids.includes(Oe))):!1)),!u.value&&f.value.length>0&&(ue=ue.filter(te=>te.scopeConfigurations?f.value.some(be=>te.scopeConfigurations.some(Oe=>Be(be,Oe))):!1)),ue}),he=J(()=>[...Se.value].sort((ue,te)=>ue.displayOrder!==te.displayOrder?ue.displayOrder-te.displayOrder:Cn(ue.text,te.text))),Q=ue=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${i.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${i.value.checkpoints}`,SpecificPeople:`Specific ${i.value.people}`,OnePerArea:`One per ${i.value.area}`,OnePerCheckpoint:`One per ${i.value.checkpoint}`,EveryAreaLead:`Every ${i.value.area} lead`,OneLeadPerArea:`One lead per ${i.value.area}`,AreaLead:`${o.value.area} lead`})[ue]||ue,X=ue=>{if(!ue)return"";const te=Q(ue.scope);if(ue.itemType===null)return te;const be=ue.ids||[];if(be.includes("ALL_MARSHALS"))return`${te} (Everyone)`;if(be.includes("ALL_AREAS"))return`${te} (All ${i.value.areas})`;if(be.includes("ALL_CHECKPOINTS"))return`${te} (All ${i.value.checkpoints})`;const Oe=be.length;return Oe===0?te:`${te} (${Oe})`};return(ue,te)=>(m(),g("div",p0,[c("div",v0,[c("h2",null,_(z(o).checklists),1),c("div",m0,[c("button",{onClick:te[0]||(te[0]=be=>ue.$emit("add-checklist-item")),class:"btn btn-primary"}," Add "+_(z(i).checklist),1)])]),c("div",g0,[c("div",y0,[c("h4",null,"Filter by "+_(z(i).area)+":",1),c("label",_0,[c("input",{type:"checkbox",checked:a.value,onChange:A},null,40,k0),Ze(" All "+_(z(i).areas),1)]),a.value?R("",!0):(m(),g("div",b0,[c("div",w0,[c("button",{onClick:se,class:"toggle-all-btn"},_(M.value?"Deselect all":"Select all"),1)]),c("div",C0,[(m(!0),g(Ce,null,Re(y.value,be=>(m(),g("label",{key:be.id,class:"checkbox-item"},[c("input",{type:"checkbox",checked:h.value.includes(be.id),onChange:Oe=>T(be.id)},null,40,L0),c("span",{class:"area-color-dot",style:st({backgroundColor:be.color||"#667eea"})},null,4),Ze(" "+_(be.name),1)]))),128))])]))]),c("div",S0,[c("h4",null,"Filter by "+_(z(i).checkpoint)+":",1),c("label",x0,[c("input",{type:"checkbox",checked:l.value,onChange:C},null,40,T0),Ze(" All "+_(z(i).checkpoints),1)]),l.value?R("",!0):(m(),g("div",I0,[c("div",$0,[c("button",{onClick:ce,class:"toggle-all-btn"},_(b.value?"Deselect all":"Select all"),1)]),c("div",M0,[(m(!0),g(Ce,null,Re(k.value,be=>(m(),g("label",{key:be.id,class:"checkbox-item"},[c("input",{type:"checkbox",checked:p.value.includes(be.id),onChange:Oe=>S(be.id)},null,40,A0),Ze(" "+_(be.name),1)]))),128))])]))]),c("div",E0,[c("h4",null,"Filter by "+_(z(i).person)+":",1),c("label",P0,[c("input",{type:"checkbox",checked:u.value,onChange:x},null,40,D0),Ze(" All "+_(z(i).people),1)]),u.value?R("",!0):(m(),g("div",O0,[c("div",R0,[c("button",{onClick:_e,class:"toggle-all-btn"},_(B.value?"Deselect all":"Select all"),1)]),c("div",B0,[(m(!0),g(Ce,null,Re(I.value,be=>(m(),g("label",{key:be.id,class:"checkbox-item"},[c("input",{type:"checkbox",checked:f.value.includes(be.id),onChange:Oe=>$(be.id)},null,40,N0),Ze(" "+_(be.name),1)]))),128))])]))]),E.value?(m(),g("button",{key:0,onClick:ae,class:"btn btn-secondary btn-small"}," Clear filters ")):R("",!0)]),c("div",F0,[Se.value.length===0?(m(),g("div",U0,[c("p",null,_(E.value?"No checklist items match the selected filters.":"No checklist items yet. Create one to get started!"),1)])):R("",!0),(m(!0),g(Ce,null,Re(he.value,be=>(m(),g("div",{key:be.itemId,class:"checklist-item-card"},[c("div",z0,[c("div",{class:"checklist-item-title",onClick:Oe=>ue.$emit("select-checklist-item",be,"details")},[c("strong",null,_(be.text),1)],8,H0),c("div",V0,[(m(!0),g(Ce,null,Re(be.scopeConfigurations,(Oe,ne)=>(m(),g("span",{key:ne,class:"scope-badge",onClick:Ee=>ue.$emit("select-checklist-item",be,"visibility")},_(X(Oe)),9,G0))),128))])])]))),128))])]))}},j0=Ye(Z0,[["__scopeId","data-v-212a4524"]]),W0={class:"notes-tab"},q0={class:"notes-tab-header"},K0={class:"button-group"},Y0={class:"filters-section"},J0={class:"filter-group"},X0={class:"priority-filters"},Q0=["checked","onChange"],eC={class:"filter-group"},tC={class:"filter-checkbox"},nC=["checked"],oC={key:0,class:"checkbox-dropdown"},sC={class:"checkbox-list"},iC=["checked","onChange"],aC={class:"notes-list"},rC={key:0,class:"empty-state"},lC=["onClick"],cC={class:"note-header"},uC={class:"note-title-row"},dC={key:0,class:"pin-icon",title:"Pinned"},hC={class:"note-meta"},fC={key:0,class:"category-badge"},pC={class:"created-info"},vC={key:0,class:"note-preview"},mC={class:"note-scopes"},gC={__name:"NotesTab",props:{notes:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["add-note","select-note"],setup(e,{emit:t}){const{termsLower:o}=Ct(),i=e,s=[{value:"Urgent",label:"Urgent"},{value:"High",label:"High"},{value:"Normal",label:"Normal"},{value:"Low",label:"Low"}],a=P(!0),l=P([]),u=P(["Urgent","High","Normal","Low"]),h=J(()=>[...i.areas].sort((x,T)=>x.displayOrder!==T.displayOrder?x.displayOrder-T.displayOrder:Cn(x.name,T.name))),p=J(()=>!a.value||u.value.length<4),f=()=>{a.value=!a.value,!a.value&&l.value.length===0&&(l.value=i.areas.map(x=>x.id))},y=x=>{const T=l.value.indexOf(x);T>=0?l.value.splice(T,1):l.value.push(x)},k=x=>{const T=u.value.indexOf(x);T>=0?u.value.splice(T,1):u.value.push(x)},I=()=>{a.value=!0,l.value=[],u.value=["Urgent","High","Normal","Low"]},M=J(()=>{let x=i.notes;return u.value.length<4&&(x=x.filter(T=>u.value.includes(T.priority||"Normal"))),!a.value&&l.value.length>0&&(x=x.filter(T=>T.scopeConfigurations?T.scopeConfigurations.some(S=>S.itemType==="Area"&&l.value.some($=>S.ids.includes($))):!1)),x}),b=J(()=>{const x={Urgent:0,High:1,Normal:2,Low:3};return[...M.value].sort((T,S)=>{if(T.isPinned!==S.isPinned)return T.isPinned?-1:1;const $=x[T.priority]??2,se=x[S.priority]??2;return $!==se?$-se:T.displayOrder!==S.displayOrder?T.displayOrder-S.displayOrder:Cn(T.title,S.title)})}),B=x=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${o.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${o.value.checkpoints}`,SpecificPeople:`Specific ${o.value.people}`,EveryAreaLead:`Every ${o.value.area} lead`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,OnePerArea:`One per ${o.value.area}`,OneLeadPerArea:`One lead per ${o.value.area}`})[x]||x,E=x=>{if(!x)return"";const T=B(x.scope);if(x.itemType===null)return T;const S=x.ids||[];if(S.includes("ALL_MARSHALS"))return`${T} (Everyone)`;if(S.includes("ALL_AREAS"))return`${T} (All ${o.value.areas})`;if(S.includes("ALL_CHECKPOINTS"))return`${T} (All ${o.value.checkpoints})`;const $=S.length;return $===0?T:`${T} (${$})`},A=x=>{if(!x)return"";const T=150;return x.length<=T?x:x.substring(0,T)+"..."},C=x=>{if(!x)return"";const T=new Date(x),$=new Date-T,se=Math.floor($/6e4),ce=Math.floor($/36e5),_e=Math.floor($/864e5);return se<1?"Just now":se<60?`${se}m ago`:ce<24?`${ce}h ago`:_e<7?`${_e}d ago`:T.toLocaleDateString()};return(x,T)=>(m(),g("div",W0,[c("div",q0,[T[1]||(T[1]=c("h2",null,"Notes",-1)),c("div",K0,[c("button",{onClick:T[0]||(T[0]=S=>x.$emit("add-note")),class:"btn btn-primary"}," Add note ")])]),c("div",Y0,[c("div",J0,[T[2]||(T[2]=c("h4",null,"Filter by priority:",-1)),c("div",X0,[(m(),g(Ce,null,Re(s,S=>c("label",{key:S.value,class:"filter-checkbox"},[c("input",{type:"checkbox",checked:u.value.includes(S.value),onChange:$=>k(S.value)},null,40,Q0),c("span",{class:Te(["priority-dot",S.value.toLowerCase()])},null,2),Ze(" "+_(S.label),1)])),64))])]),c("div",eC,[T[4]||(T[4]=c("h4",null,"Filter by area:",-1)),c("label",tC,[c("input",{type:"checkbox",checked:a.value,onChange:f},null,40,nC),T[3]||(T[3]=Ze(" All areas ",-1))]),a.value?R("",!0):(m(),g("div",oC,[c("div",sC,[(m(!0),g(Ce,null,Re(h.value,S=>(m(),g("label",{key:S.id,class:"checkbox-item"},[c("input",{type:"checkbox",checked:l.value.includes(S.id),onChange:$=>y(S.id)},null,40,iC),c("span",{class:"area-color-dot",style:st({backgroundColor:S.color||"#667eea"})},null,4),Ze(" "+_(S.name),1)]))),128))])]))]),p.value?(m(),g("button",{key:0,onClick:I,class:"btn btn-secondary btn-small"}," Clear filters ")):R("",!0)]),c("div",aC,[M.value.length===0?(m(),g("div",rC,[c("p",null,_(p.value?"No notes match the selected filters.":"No notes yet. Create one to get started!"),1)])):R("",!0),(m(!0),g(Ce,null,Re(b.value,S=>(m(),g("div",{key:S.noteId,class:Te(["note-card",{pinned:S.isPinned}]),onClick:$=>x.$emit("select-note",S)},[c("div",cC,[c("div",uC,[S.isPinned?(m(),g("span",dC,"")):R("",!0),c("span",{class:Te(["priority-indicator",S.priority?.toLowerCase()||"normal"])},null,2),c("strong",null,_(S.title),1)]),c("div",hC,[S.category?(m(),g("span",fC,_(S.category),1)):R("",!0),c("span",pC,_(C(S.createdAt)),1)])]),S.content?(m(),g("div",vC,_(A(S.content)),1)):R("",!0),c("div",mC,[(m(!0),g(Ce,null,Re(S.scopeConfigurations,($,se)=>(m(),g("span",{key:se,class:"scope-badge"},_(E($)),1))),128))])],10,lC))),128))])]))}},yC=Ye(gC,[["__scopeId","data-v-c5d152b0"]]),_C={class:"contacts-tab"},kC={class:"contacts-tab-header"},bC={class:"button-group"},wC={class:"filters-section"},CC={class:"filter-group"},LC={class:"filter-checkbox"},SC=["checked"],xC={key:0,class:"checkbox-dropdown"},TC={class:"checkbox-list"},IC=["checked","onChange"],$C={class:"contacts-list"},MC={key:0,class:"empty-state"},AC=["onClick"],EC={class:"contact-header"},PC={class:"contact-title-row"},DC={key:0,class:"primary-badge",title:"Primary contact"},OC={class:"role-badge"},RC={class:"contact-details"},BC={key:0,class:"contact-phone"},NC={key:1,class:"contact-email"},FC={key:0,class:"contact-notes"},UC={class:"contact-scopes"},zC={__name:"ContactsTab",props:{contacts:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})}},emits:["add-contact","select-contact"],setup(e,{emit:t}){const{termsLower:o}=Ct(),i=e,s=P(!0),a=P([]),l=J(()=>{const E=new Set([...i.availableRoles.builtInRoles||[],...i.availableRoles.customRoles||[],...i.contacts.map(A=>A.role)]);return Array.from(E).sort()}),u=J(()=>!s.value),h=()=>{s.value=!s.value,!s.value&&a.value.length===0&&(a.value=[...l.value])},p=E=>{const A=a.value.indexOf(E);A>=0?a.value.splice(A,1):a.value.push(E)},f=()=>{s.value=!0,a.value=[]},y=J(()=>{let E=i.contacts;return!s.value&&a.value.length>0&&(E=E.filter(A=>a.value.includes(A.role))),E}),k=J(()=>[...y.value].sort((E,A)=>{if(E.isPrimary!==A.isPrimary)return E.isPrimary?-1:1;const C=E.role.localeCompare(A.role);return C!==0?C:E.displayOrder!==A.displayOrder?E.displayOrder-A.displayOrder:Cn(E.name,A.name)})),I=E=>E?E==="AreaLead"?`${o.value.area.charAt(0).toUpperCase()+o.value.area.slice(1)} Lead`:E.replace(/([A-Z])/g," $1").replace(/^./,A=>A.toUpperCase()).trim():"",M=E=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${o.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${o.value.checkpoints}`,SpecificPeople:`Specific ${o.value.people}`,EveryAreaLead:`Every ${o.value.area} lead`})[E]||E,b=E=>{if(!E)return"";const A=M(E.scope);if(E.itemType===null)return A;const C=E.ids||[];if(C.includes("ALL_MARSHALS"))return`${A} (Everyone)`;if(C.includes("ALL_AREAS"))return`${A} (All ${o.value.areas})`;if(C.includes("ALL_CHECKPOINTS"))return`${A} (All ${o.value.checkpoints})`;const x=C.length;return x===0?A:`${A} (${x})`},B=E=>{if(!E)return"";const A=100;return E.length<=A?E:E.substring(0,A)+"..."};return(E,A)=>(m(),g("div",_C,[c("div",kC,[A[1]||(A[1]=c("h2",null,"Contacts",-1)),c("div",bC,[c("button",{onClick:A[0]||(A[0]=C=>E.$emit("add-contact")),class:"btn btn-primary"}," Add contact ")])]),c("div",wC,[c("div",CC,[A[3]||(A[3]=c("h4",null,"Filter by role:",-1)),c("label",LC,[c("input",{type:"checkbox",checked:s.value,onChange:h},null,40,SC),A[2]||(A[2]=Ze(" All roles ",-1))]),s.value?R("",!0):(m(),g("div",xC,[c("div",TC,[(m(!0),g(Ce,null,Re(l.value,C=>(m(),g("label",{key:C,class:"checkbox-item"},[c("input",{type:"checkbox",checked:a.value.includes(C),onChange:x=>p(C)},null,40,IC),Ze(" "+_(I(C)),1)]))),128))])]))]),u.value?(m(),g("button",{key:0,onClick:f,class:"btn btn-secondary btn-small"}," Clear filters ")):R("",!0)]),c("div",$C,[y.value.length===0?(m(),g("div",MC,[c("p",null,_(u.value?"No contacts match the selected filters.":"No contacts yet. Create one to get started!"),1)])):R("",!0),(m(!0),g(Ce,null,Re(k.value,C=>(m(),g("div",{key:C.contactId,class:Te(["contact-card",{primary:C.isPrimary}]),onClick:x=>E.$emit("select-contact",C)},[c("div",EC,[c("div",PC,[C.isPrimary?(m(),g("span",DC,"")):R("",!0),c("strong",null,_(C.name),1),c("span",OC,_(I(C.role)),1)]),c("div",RC,[C.phone?(m(),g("span",BC,_(C.phone),1)):R("",!0),C.email?(m(),g("span",NC,_(C.email),1)):R("",!0)])]),C.notes?(m(),g("div",FC,_(B(C.notes)),1)):R("",!0),c("div",UC,[(m(!0),g(Ce,null,Re(C.scopeConfigurations,(x,T)=>(m(),g("span",{key:T,class:"scope-badge"},_(b(x)),1))),128))])],10,AC))),128))])]))}},HC=Ye(zC,[["__scopeId","data-v-0700af03"]]),VC={class:"event-details-tab"},GC={class:"event-info-card"},ZC={class:"form-group"},jC={class:"form-group"},WC={class:"form-row"},qC={class:"form-group"},KC={class:"form-group"},YC=["value"],JC={class:"form-actions"},XC=["disabled"],QC={__name:"EventDetailsTab",props:{eventData:{type:Object,required:!0},formDirty:{type:Boolean,default:!1}},emits:["submit","update:formDirty"],setup(e,{emit:t}){const o=e,i=t,s=P({...o.eventData});qe(()=>o.eventData,u=>{s.value={...u}},{deep:!0});const a=()=>{i("update:formDirty",!0)},l=()=>{i("submit",{...s.value})};return(u,h)=>(m(),g("div",VC,[c("div",GC,[c("form",{onSubmit:vt(l,["prevent"]),class:"event-details-form"},[c("div",ZC,[h[4]||(h[4]=c("label",null,"Event name",-1)),je(c("input",{"onUpdate:modelValue":h[0]||(h[0]=p=>s.value.name=p),type:"text",required:"",class:"form-input",onInput:a},null,544),[[ht,s.value.name]])]),c("div",jC,[h[5]||(h[5]=c("label",null,"Description",-1)),je(c("textarea",{"onUpdate:modelValue":h[1]||(h[1]=p=>s.value.description=p),rows:"3",class:"form-input",onInput:a},null,544),[[ht,s.value.description]])]),c("div",WC,[c("div",qC,[h[6]||(h[6]=c("label",null,"Event date & time",-1)),je(c("input",{"onUpdate:modelValue":h[2]||(h[2]=p=>s.value.eventDate=p),type:"datetime-local",required:"",class:"form-input",onInput:a},null,544),[[ht,s.value.eventDate]])]),c("div",KC,[h[7]||(h[7]=c("label",null,"Time zone",-1)),je(c("select",{"onUpdate:modelValue":h[3]||(h[3]=p=>s.value.timeZoneId=p),required:"",class:"form-input",onChange:a},[(m(!0),g(Ce,null,Re(z(Pp),p=>(m(),g("option",{key:p.value,value:p.value},_(p.label),9,YC))),128))],544),[[bn,s.value.timeZoneId]])])]),c("div",JC,[c("button",{type:"submit",class:"btn btn-primary",disabled:!e.formDirty}," Save Changes ",8,XC)])],32)])]))}},eL=Ye(QC,[["__scopeId","data-v-0f443e74"]]),tL={class:"admins-list"},nL={class:"admin-info"},oL={class:"admin-role"},sL=["onClick"],iL={__name:"AdminsList",props:{admins:{type:Array,required:!0}},emits:["add-admin","remove-admin"],setup(e){return(t,o)=>(m(),g("div",null,[o[1]||(o[1]=c("h3",null,"Event administrators",-1)),c("button",{onClick:o[0]||(o[0]=i=>t.$emit("add-admin")),class:"btn btn-small btn-primary"}," Add administrator "),c("div",tL,[(m(!0),g(Ce,null,Re(e.admins,i=>(m(),g("div",{key:i.userEmail,class:"admin-item"},[c("div",nL,[c("strong",null,_(i.userEmail),1),c("span",oL,_(i.role),1)]),e.admins.length>1?(m(),g("button",{key:0,onClick:s=>t.$emit("remove-admin",i.userEmail),class:"btn btn-small btn-danger"}," Remove ",8,sL)):R("",!0)]))),128))])]))}},aL=Ye(iL,[["__scopeId","data-v-c76441fb"]]),An=[{name:"Charcoal",hex:"#2d3748"},{name:"Dark Gray",hex:"#4a5568"},{name:"Gray",hex:"#718096"},{name:"Red",hex:"#f56565"},{name:"Coral",hex:"#ff6b6b"},{name:"Rose",hex:"#fb7185"},{name:"Pink",hex:"#ed64a6"},{name:"Magenta",hex:"#d946ef"},{name:"Fuchsia",hex:"#e879f9"},{name:"Purple",hex:"#9f7aea"},{name:"Violet",hex:"#a78bfa"},{name:"Lavender",hex:"#b197fc"},{name:"Indigo",hex:"#5a67d8"},{name:"Navy",hex:"#4263eb"},{name:"Blue",hex:"#667eea"},{name:"Sky",hex:"#0ea5e9"},{name:"Cyan",hex:"#0bc5ea"},{name:"Aqua",hex:"#22d3ee"},{name:"Teal",hex:"#38b2ac"},{name:"Emerald",hex:"#10b981"},{name:"Green",hex:"#48bb78"},{name:"Mint",hex:"#51cf66"},{name:"Lime",hex:"#84cc16"},{name:"Olive",hex:"#a3b18a"},{name:"Yellow",hex:"#ecc94b"},{name:"Amber",hex:"#f59e0b"},{name:"Orange",hex:"#ed8936"},{name:"Peach",hex:"#ff922b"},{name:"Light Gray",hex:"#cbd5e0"},{name:"Silver",hex:"#e2e8f0"},{name:"Cream",hex:"#f7fafc"}],Ur="#667eea";function mh(e){const t=e.map(i=>i.color);return An.find(i=>!t.includes(i.hex))?.hex||Ur}const rL={class:"modal-content"},lL={class:"modal-body"},cL={class:"preview-section"},uL={class:"map-preview"},dL=["innerHTML"],hL={class:"options-grid"},fL={class:"option-button-content"},pL={class:"option-button-value icon-value"},vL=["innerHTML"],mL={class:"option-button-content"},gL={class:"option-button-value color-value"},yL=["disabled"],_L={class:"option-button-content"},kL={class:"option-button-value color-value"},bL={class:"option-button-content"},wL={class:"option-button-value icon-value"},CL=["innerHTML"],LL=["disabled"],SL={class:"option-button-content"},xL={class:"option-button-value color-value"},TL={class:"option-button-content"},IL={class:"option-button-value"},$L={class:"option-button-content"},ML={class:"option-button-value"},AL={key:0,class:"centered-popup"},EL={class:"popup-grid"},PL=["onClick"],DL=["innerHTML"],OL={key:0},RL={key:1,class:"centered-popup"},BL={class:"popup-grid"},NL=["title","onClick"],FL=["innerHTML"],UL={key:0},zL={key:2,class:"centered-popup"},HL={class:"popup-grid"},VL=["title","onClick"],GL=["innerHTML"],ZL={key:0},jL={key:3,class:"centered-popup icon-popup"},WL={class:"popup-grid"},qL=["onClick"],KL=["innerHTML"],YL={key:0},JL={key:4,class:"centered-popup"},XL={class:"popup-grid"},QL=["title","onClick"],e2=["innerHTML"],t2={key:0},n2={key:5,class:"centered-popup"},o2={class:"size-grid"},s2=["onClick"],i2=["innerHTML"],a2={key:6,class:"centered-popup"},r2={class:"rotation-content"},l2={class:"rotation-preview-container"},c2=["innerHTML"],u2={class:"rotation-control"},d2={class:"rotation-slider-container"},h2=["value"],f2={class:"rotation-value"},p2={class:"rotation-presets"},v2="#667eea",m2={__name:"IconCustomizationModal",props:{isOpen:{type:Boolean,default:!1},iconType:{type:String,default:"none"},backgroundShape:{type:String,default:"circle"},backgroundColor:{type:String,default:""},borderColor:{type:String,default:""},iconColor:{type:String,default:""},size:{type:String,default:"100"},mapRotation:{type:[String,Number],default:""},level:{type:String,default:"checkpoint"},inheritedType:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""}},emits:["update:isOpen","apply","cancel"],setup(e,{emit:t}){const o=e,i=t,s=P(o.backgroundShape||"circle"),a=P(o.iconType||"none"),l=P(o.backgroundColor||""),u=P(o.borderColor||""),h=P(o.iconColor||""),p=P(o.size||"100"),f=P(o.mapRotation??""),y=P(null),k=oe=>oe==="default"?o.inheritedBackgroundShape||"circle":oe==="none"?"none":oe||"circle",I=oe=>oe==="default"||!oe?ce():oe==="none"?"transparent":oe,M=oe=>oe==="default"?o.inheritedBorderColor||"#ffffff":oe==="none"||!oe?"transparent":oe,b=oe=>{if(oe==="default"){const ee=o.inheritedType;return ee&&ee!=="default"&&ii(ee).category==="content"?ee:"none"}return oe==="none"||!oe?"none":oe},B=oe=>oe==="default"||!oe?o.inheritedIconColor||"#ffffff":oe==="none"?"transparent":oe,E=oe=>oe==="default"?o.inheritedSize||"100":oe||"100",A=oe=>{if(oe==="default"||oe===""){const ee=o.inheritedMapRotation;return ee!==""&&ee!==void 0&&ee!==null&&parseInt(ee,10)||0}return parseInt(oe,10)||0},C=J(()=>{const oe=o.inheritedBackgroundShape||"circle",ee=Ir.find(j=>j.value===oe)?.label||"Circle";return[{value:"none",label:"None",showLabel:!0},{value:"default",label:`Default (${ee})`,showLabel:!0},...Ir.filter(j=>j.value!=="none").map(j=>({...j,showLabel:!1}))]}),x=J(()=>{const oe=Qr.filter(Ve=>Ve.category==="content"),ee=[{value:"none",label:"None",category:"content",showLabel:!0}],j=o.inheritedType;if(j&&j!=="default"){const Ve=ii(j);Ve.category==="content"&&ee.push({value:"default",label:`Default (${Ve.label||j})`,category:"content",showLabel:!0})}return ee.push(...oe.map(Ve=>({...Ve,showLabel:!1}))),ee}),T=J(()=>{const oe={33:"Small",66:"Medium",100:"Normal",150:"Large"};return[{value:"default",label:`Default (${oe[o.inheritedSize]||"Normal"})`},...sw.map(j=>({value:j.value,label:oe[j.value]||j.label}))]}),S=J(()=>k(s.value)!=="none"),$=J(()=>b(a.value)!=="none"),se=J(()=>{const oe=o.inheritedBackgroundColor;return oe&&oe!=="default"&&oe.startsWith("#")?oe:v2}),ce=()=>se.value,_e=J(()=>l.value&&l.value!=="default"?l.value:ce()),ae=J(()=>u.value==="none"?"transparent":u.value?u.value:o.inheritedBorderColor&&o.inheritedBorderColor!=="none"?o.inheritedBorderColor:"#ffffff"),pe=J(()=>h.value?h.value:o.inheritedIconColor?o.inheritedIconColor:"#ffffff"),Ie=J(()=>{const oe=se.value,ee=An.find(j=>j.hex.toLowerCase()===oe.toLowerCase())?.name||"Custom";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ee})`,showLabel:!0},...An.map(j=>({hex:j.hex,name:j.name,showLabel:!1}))]}),Be=J(()=>{const oe=o.inheritedBorderColor||"#ffffff",ee=oe==="#ffffff"?"White":An.find(j=>j.hex===oe)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ee})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...An.filter(j=>j.hex!=="#ffffff").map(j=>({hex:j.hex,name:j.name,showLabel:!1}))]}),Se=J(()=>{const oe=o.inheritedIconColor||"#ffffff",ee=oe==="#ffffff"?"White":An.find(j=>j.hex===oe)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ee})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...An.filter(j=>j.hex!=="#ffffff").map(j=>({hex:j.hex,name:j.name,showLabel:!1}))]}),he=oe=>oe==="default"?!l.value||l.value==="default":l.value===oe,Q=oe=>oe==="#ffffff"?!h.value||h.value==="#ffffff":h.value===oe,X=oe=>{if(oe==="none")return"None";if(oe==="default"){const j=o.inheritedBackgroundShape;return j?`Default (${Ir.find(Xe=>Xe.value===j)?.label||"Circle"})`:"Default (Circle)"}const ee=Ir.find(j=>j.value===oe);return ee?ee.label:"Circle"},ue=oe=>{if(oe==="none")return"None";if(oe==="default"){const j=o.inheritedType;if(j&&j!=="default"){const Ve=ii(j);if(Ve.category==="content")return`Default (${Ve.label||j})`}return"Default"}const ee=Qr.find(j=>j.value===oe);return ee?ee.label:"None"},te=oe=>{if(oe==="none")return"None";if(!oe||oe==="default"){const j=se.value;return`Default (${An.find(Xe=>Xe.hex.toLowerCase()===j.toLowerCase())?.name||"Custom"})`}const ee=[...An].find(j=>j.hex.toLowerCase()===oe.toLowerCase());return ee?ee.name:oe},be=oe=>{if(oe==="none")return"None";if(oe==="default"){const j=o.inheritedBorderColor;return j&&j!=="none"?`Default (${j==="#ffffff"?"White":An.find(Xe=>Xe.hex===j)?.name||"Custom"})`:"Default (White)"}if(!oe||oe==="#ffffff")return"White";const ee=[...Be.value].find(j=>j.hex===oe);return ee?ee.name:oe},Oe=oe=>{if(oe==="none")return"None";if(oe==="default"){const j=o.inheritedIconColor;return j?`Default (${j==="#ffffff"?"White":An.find(Xe=>Xe.hex===j)?.name||"Custom"})`:"Default (White)"}if(!oe||oe==="#ffffff")return"White";const ee=[...Se.value].find(j=>j.hex===oe);return ee?ee.name:oe},ne=oe=>{const ee={33:"Small",66:"Medium",100:"Normal",150:"Large"};if(oe==="default"){const j=o.inheritedSize;return`Default (${ee[j]||"Normal"})`}return ee[oe]||"Normal"},Ee=oe=>{if(oe==="default"||oe===""||oe===void 0||oe===null){const ee=o.inheritedMapRotation;return ee!==""&&ee!==void 0&&ee!==null?`Default (${ee})`:"Default (0)"}return`${oe}`},xe=oe=>{if(oe==="none")return`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`;const ee=k(oe),j=I(l.value),Ve=M(u.value);return $i[ee]?`<svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">${$i[ee]({backgroundColor:j,borderColor:Ve==="transparent"?"none":Ve})}</svg>`:""},we=oe=>{const ee=b(oe);return ee==="none"?`<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
      <rect x="1" y="1" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`:qt({type:ee,backgroundShape:"circle",backgroundColor:"#94a3b8",borderColor:"none",iconColor:"#fff",size:"75"})},re=oe=>{const ee=k(oe);if(ee==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="none" stroke="#ccc" stroke-width="2" stroke-dasharray="4"/>
    </svg>`;const j=I(l.value),Ve=M(u.value),Xe=b(a.value),nt=B(h.value);return qt({type:Xe!=="none"?Xe:ee,backgroundShape:ee,backgroundColor:j,borderColor:Ve==="transparent"?"none":Ve,iconColor:nt,size:"100",outputSize:28})},ve=oe=>{const ee=I(oe),j=k(s.value),Ve=M(u.value),Xe=b(a.value),nt=B(h.value);return j==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ee==="transparent"?"#e2e8f0":ee}"/>
    </svg>`:qt({type:Xe!=="none"?Xe:j,backgroundShape:j,backgroundColor:ee==="transparent"?"#e2e8f0":ee,borderColor:Ve==="transparent"?"none":Ve,iconColor:nt,size:"100",outputSize:28})},q=oe=>{const ee=M(oe),j=k(s.value),Ve=I(l.value),Xe=b(a.value),nt=B(h.value);return j==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0" stroke="${ee}" stroke-width="2"/>
    </svg>`:qt({type:Xe!=="none"?Xe:j,backgroundShape:j,backgroundColor:Ve,borderColor:ee==="transparent"?"none":ee,iconColor:nt,size:"100",outputSize:28})},fe=oe=>{const ee=b(oe),j=k(s.value),Ve=I(l.value),Xe=M(u.value),nt=B(h.value);if(ee==="none"&&j==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0"/>
      <line x1="8" y1="8" x2="20" y2="20" stroke="#a0aec0" stroke-width="2" stroke-linecap="round"/>
    </svg>`;const at=j!=="none"?j:"circle";return qt({type:ee!=="none"?ee:at,backgroundShape:at,backgroundColor:Ve,borderColor:Xe==="transparent"?"none":Xe,iconColor:nt,size:"100",outputSize:42})},Le=oe=>{const ee=B(oe),j=k(s.value),Ve=I(l.value),Xe=M(u.value),nt=b(a.value);return nt==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ee==="transparent"?"#e2e8f0":ee}"/>
    </svg>`:qt({type:nt,backgroundShape:j!=="none"?j:"circle",backgroundColor:Ve,borderColor:Xe==="transparent"?"none":Xe,iconColor:ee==="transparent"?"#e2e8f0":ee,size:"100",outputSize:28})},U=oe=>{const ee=E(oe),j=k(s.value),Ve=I(l.value),Xe=M(u.value),nt=b(a.value),at=B(h.value);if(j==="none"&&nt==="none")return"";const tt=j!=="none"?j:"circle";return qt({type:nt!=="none"?nt:tt,backgroundShape:tt,backgroundColor:Ve,borderColor:Xe==="transparent"?"none":Xe,iconColor:at,size:ee})},H=J(()=>{const oe=k(s.value),ee=I(l.value),j=M(u.value),Ve=b(a.value),Xe=B(h.value),nt=E(p.value);return oe==="none"&&Ve==="none"?"":qt(oe==="none"&&Ve!=="none"?{type:Ve,backgroundShape:"none",backgroundColor:ee,borderColor:"none",iconColor:Xe,size:nt}:{type:Ve!=="none"?Ve:oe,backgroundShape:oe,backgroundColor:ee,borderColor:j==="transparent"?"none":j,iconColor:Xe,size:nt})}),Y=oe=>{y.value=y.value===oe?null:oe},Z=()=>{y.value=null},N=oe=>{s.value=oe,Z()},O=oe=>{l.value=oe,Z()},W=oe=>{u.value=oe,Z()},me=oe=>{a.value=oe,Z()},$e=oe=>{h.value=oe,Z()},ke=oe=>{p.value=oe,Z()},Ne=oe=>{f.value=oe,Z()},Fe=oe=>{f.value=oe};qe(()=>o.isOpen,oe=>{if(oe){const ee=o.backgroundShape&&o.backgroundShape!=="default"&&o.backgroundShape!=="circle",j=o.iconType&&o.iconType!=="none"&&o.iconType!=="default",Ve=o.backgroundColor&&o.backgroundColor!=="",Xe=o.borderColor&&o.borderColor!=="",nt=o.iconColor&&o.iconColor!=="",at=o.size&&o.size!==""&&o.size!=="100",tt=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null&&o.mapRotation!==0;ee||j||Ve||Xe||nt||at||tt?(s.value=o.backgroundShape||"default",a.value=o.iconType||"default",l.value=o.backgroundColor||"default",u.value=o.borderColor||"default",h.value=o.iconColor||"default",p.value=o.size||"default",f.value=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null?o.mapRotation:"default"):(s.value="default",a.value="default",l.value="default",u.value="default",h.value="default",p.value="default",f.value="default"),y.value=null}});const Ue=()=>{Z(),i("update:isOpen",!1),i("cancel")},We=()=>{Z();const oe=Ve=>Ve==="default"?"":Ve;let ee="";a.value==="none"?ee="none":a.value&&a.value!=="default"&&(ee=a.value);let j="";f.value!=="default"&&f.value!==""&&f.value!==void 0&&(j=parseInt(f.value,10)||0),i("apply",{iconType:ee,backgroundShape:oe(s.value),backgroundColor:oe(l.value),borderColor:oe(u.value),iconColor:oe(h.value),size:oe(p.value),mapRotation:j}),i("update:isOpen",!1)};return(oe,ee)=>e.isOpen?(m(),g("div",{key:0,class:"modal-overlay",onClick:vt(Ue,["self"])},[c("div",rL,[c("div",{class:"modal-header"},[ee[15]||(ee[15]=c("h3",null,"Customise marker style",-1)),c("button",{class:"close-btn",onClick:Ue},"")]),c("div",lL,[c("div",cL,[c("div",uL,[ee[16]||(ee[16]=c("div",{class:"map-background"},null,-1)),c("div",{class:"preview-icon",style:st({transform:`rotate(${A(f.value)}deg)`}),innerHTML:H.value},null,12,dL)])]),c("div",hL,[c("button",{type:"button",class:Te(["option-button",{active:y.value==="shape"}]),onClick:ee[0]||(ee[0]=j=>Y("shape"))},[c("div",fL,[ee[17]||(ee[17]=c("span",{class:"option-button-label"},"Shape",-1)),c("div",pL,[c("div",{class:"icon-preview-small",innerHTML:xe(s.value)},null,8,vL),c("span",null,_(X(s.value)),1)])]),ee[18]||(ee[18]=c("span",{class:"option-button-arrow"},"",-1))],2),c("button",{type:"button",class:Te(["option-button",{active:y.value==="bgColor"}]),onClick:ee[1]||(ee[1]=j=>Y("bgColor"))},[c("div",mL,[ee[19]||(ee[19]=c("span",{class:"option-button-label"},"Background",-1)),c("div",gL,[c("span",{class:"color-swatch",style:st({backgroundColor:_e.value})},null,4),c("span",null,_(te(l.value)),1)])]),ee[20]||(ee[20]=c("span",{class:"option-button-arrow"},"",-1))],2),c("button",{type:"button",class:Te(["option-button",{active:y.value==="borderColor",disabled:!S.value}]),disabled:!S.value,onClick:ee[2]||(ee[2]=j=>Y("borderColor"))},[c("div",_L,[ee[21]||(ee[21]=c("span",{class:"option-button-label"},"Border",-1)),c("div",kL,[c("span",{class:Te(["color-swatch",{"no-border":u.value==="none"}]),style:st(u.value!=="none"?{backgroundColor:ae.value}:{})},null,6),c("span",null,_(be(u.value)),1)])]),ee[22]||(ee[22]=c("span",{class:"option-button-arrow"},"",-1))],10,yL),c("button",{type:"button",class:Te(["option-button",{active:y.value==="icon"}]),onClick:ee[3]||(ee[3]=j=>Y("icon"))},[c("div",bL,[ee[23]||(ee[23]=c("span",{class:"option-button-label"},"Icon",-1)),c("div",wL,[c("div",{class:"icon-preview-small",innerHTML:we(a.value)},null,8,CL),c("span",null,_(ue(a.value)),1)])]),ee[24]||(ee[24]=c("span",{class:"option-button-arrow"},"",-1))],2),c("button",{type:"button",class:Te(["option-button",{active:y.value==="iconColor",disabled:!$.value}]),disabled:!$.value,onClick:ee[4]||(ee[4]=j=>Y("iconColor"))},[c("div",SL,[ee[25]||(ee[25]=c("span",{class:"option-button-label"},"Colour",-1)),c("div",xL,[c("span",{class:"color-swatch",style:st({backgroundColor:pe.value})},null,4),c("span",null,_(Oe(h.value)),1)])]),ee[26]||(ee[26]=c("span",{class:"option-button-arrow"},"",-1))],10,LL),c("button",{type:"button",class:Te(["option-button",{active:y.value==="size"}]),onClick:ee[5]||(ee[5]=j=>Y("size"))},[c("div",TL,[ee[27]||(ee[27]=c("span",{class:"option-button-label"},"Size",-1)),c("span",IL,_(ne(p.value)),1)]),ee[28]||(ee[28]=c("span",{class:"option-button-arrow"},"",-1))],2),c("button",{type:"button",class:Te(["option-button option-button-full",{active:y.value==="mapRotation"}]),onClick:ee[6]||(ee[6]=j=>Y("mapRotation"))},[c("div",$L,[ee[29]||(ee[29]=c("span",{class:"option-button-label"},"Map rotation",-1)),c("span",ML,_(Ee(f.value)),1)]),ee[30]||(ee[30]=c("span",{class:"option-button-arrow"},"",-1))],2)]),y.value==="shape"?(m(),g("div",AL,[c("div",{class:"popup-header"},[ee[31]||(ee[31]=c("span",null,"Select shape",-1)),c("button",{type:"button",class:"popup-close",onClick:Z},"")]),c("div",EL,[(m(!0),g(Ce,null,Re(C.value,j=>(m(),g("button",{key:j.value,type:"button",class:Te(["popup-grid-item",{selected:s.value===j.value}]),onClick:Ve=>N(j.value)},[c("div",{class:"popup-item-preview",innerHTML:re(j.value)},null,8,DL),j.showLabel?(m(),g("span",OL,_(j.label),1)):R("",!0)],10,PL))),128))])])):R("",!0),y.value==="bgColor"?(m(),g("div",RL,[c("div",{class:"popup-header"},[ee[32]||(ee[32]=c("span",null,"Select background",-1)),c("button",{type:"button",class:"popup-close",onClick:Z},"")]),c("div",BL,[(m(!0),g(Ce,null,Re(Ie.value,j=>(m(),g("button",{key:j.hex,type:"button",class:Te(["popup-grid-item",{selected:he(j.hex)}]),title:j.name,onClick:Ve=>O(j.hex)},[c("div",{class:"popup-item-preview",innerHTML:ve(j.hex)},null,8,FL),j.showLabel?(m(),g("span",UL,_(j.name),1)):R("",!0)],10,NL))),128))])])):R("",!0),y.value==="borderColor"?(m(),g("div",zL,[c("div",{class:"popup-header"},[ee[33]||(ee[33]=c("span",null,"Select border",-1)),c("button",{type:"button",class:"popup-close",onClick:Z},"")]),c("div",HL,[(m(!0),g(Ce,null,Re(Be.value,j=>(m(),g("button",{key:j.hex,type:"button",class:Te(["popup-grid-item",{selected:u.value===j.hex}]),title:j.name,onClick:Ve=>W(j.hex)},[c("div",{class:"popup-item-preview",innerHTML:q(j.hex)},null,8,GL),j.showLabel?(m(),g("span",ZL,_(j.name),1)):R("",!0)],10,VL))),128))])])):R("",!0),y.value==="icon"?(m(),g("div",jL,[c("div",{class:"popup-header"},[ee[34]||(ee[34]=c("span",null,"Select icon",-1)),c("button",{type:"button",class:"popup-close",onClick:Z},"")]),c("div",WL,[(m(!0),g(Ce,null,Re(x.value,j=>(m(),g("button",{key:j.value,type:"button",class:Te(["popup-grid-item",{selected:a.value===j.value}]),onClick:Ve=>me(j.value)},[c("div",{class:"popup-item-preview",innerHTML:fe(j.value)},null,8,KL),j.showLabel?(m(),g("span",YL,_(j.label),1)):R("",!0)],10,qL))),128))])])):R("",!0),y.value==="iconColor"?(m(),g("div",JL,[c("div",{class:"popup-header"},[ee[35]||(ee[35]=c("span",null,"Select colour",-1)),c("button",{type:"button",class:"popup-close",onClick:Z},"")]),c("div",XL,[(m(!0),g(Ce,null,Re(Se.value,j=>(m(),g("button",{key:j.hex,type:"button",class:Te(["popup-grid-item",{selected:Q(j.hex)}]),title:j.name,onClick:Ve=>$e(j.hex)},[c("div",{class:"popup-item-preview",innerHTML:Le(j.hex)},null,8,e2),j.showLabel?(m(),g("span",t2,_(j.name),1)):R("",!0)],10,QL))),128))])])):R("",!0),y.value==="size"?(m(),g("div",n2,[c("div",{class:"popup-header"},[ee[36]||(ee[36]=c("span",null,"Select size",-1)),c("button",{type:"button",class:"popup-close",onClick:Z},"")]),c("div",o2,[(m(!0),g(Ce,null,Re(T.value,j=>(m(),g("button",{key:j.value,type:"button",class:Te(["size-grid-item",{selected:p.value===j.value}]),onClick:Ve=>ke(j.value)},[c("div",{class:"size-preview",innerHTML:U(j.value)},null,8,i2),c("span",null,_(j.label),1)],10,s2))),128))])])):R("",!0),y.value==="mapRotation"?(m(),g("div",a2,[c("div",{class:"popup-header"},[ee[37]||(ee[37]=c("span",null,"Set map rotation",-1)),c("button",{type:"button",class:"popup-close",onClick:Z},"")]),c("div",r2,[c("div",l2,[c("div",{class:"rotation-preview-icon",style:st({transform:`rotate(${A(f.value)}deg)`}),innerHTML:H.value},null,12,c2)]),ee[38]||(ee[38]=c("p",{class:"rotation-description"}," Rotate the marker on the map. This rotation is added to any map rotation. ",-1)),c("div",u2,[c("button",{type:"button",class:Te(["rotation-preset",{selected:f.value==="default"||f.value===""}]),onClick:ee[7]||(ee[7]=j=>Ne("default"))}," Default ",2),c("div",d2,[c("input",{type:"range",min:"-180",max:"180",step:"5",class:"rotation-slider",value:f.value==="default"||f.value===""?0:f.value,onInput:ee[8]||(ee[8]=j=>Fe(parseInt(j.target.value,10)))},null,40,h2),c("div",f2,_(f.value==="default"||f.value===""?"0":f.value)+" ",1)])]),c("div",p2,[c("button",{type:"button",class:Te(["rotation-preset-btn",{selected:f.value===-90}]),onClick:ee[9]||(ee[9]=j=>Ne(-90))},"-90",2),c("button",{type:"button",class:Te(["rotation-preset-btn",{selected:f.value===-45}]),onClick:ee[10]||(ee[10]=j=>Ne(-45))},"-45",2),c("button",{type:"button",class:Te(["rotation-preset-btn",{selected:f.value===0}]),onClick:ee[11]||(ee[11]=j=>Ne(0))},"0",2),c("button",{type:"button",class:Te(["rotation-preset-btn",{selected:f.value===45}]),onClick:ee[12]||(ee[12]=j=>Ne(45))},"+45",2),c("button",{type:"button",class:Te(["rotation-preset-btn",{selected:f.value===90}]),onClick:ee[13]||(ee[13]=j=>Ne(90))},"+90",2),c("button",{type:"button",class:Te(["rotation-preset-btn",{selected:f.value===180}]),onClick:ee[14]||(ee[14]=j=>Ne(180))},"180",2)])])])):R("",!0)]),c("div",{class:"modal-footer"},[c("button",{type:"button",class:"btn-cancel",onClick:Ue},"Cancel"),c("button",{type:"button",class:"btn-apply",onClick:We},"Apply")])])])):R("",!0)}},g2=Ye(m2,[["__scopeId","data-v-b13795fe"]]),y2={class:"checkpoint-style-picker"},_2={class:"form-group"},k2={class:"style-options"},b2=["innerHTML"],w2={class:"option-label"},C2=["innerHTML"],L2="#667eea",S2={__name:"CheckpointStylePicker",props:{styleType:{type:String,default:"default"},styleColor:{type:String,default:""},styleBackgroundShape:{type:String,default:""},styleBackgroundColor:{type:String,default:""},styleBorderColor:{type:String,default:""},styleIconColor:{type:String,default:""},styleSize:{type:String,default:""},styleMapRotation:{type:[String,Number],default:""},iconLabel:{type:String,default:"Marker style"},showPreview:{type:Boolean,default:!0},inheritedStyleType:{type:String,default:"default"},inheritedStyleColor:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""},defaultLabel:{type:String,default:"Default"},level:{type:String,default:"checkpoint"}},emits:["update:styleType","update:styleColor","update:styleBackgroundShape","update:styleBackgroundColor","update:styleBorderColor","update:styleIconColor","update:styleSize","update:styleMapRotation","change"],setup(e,{emit:t}){const o=e,i=t,s=P(o.styleType),a=P(o.styleColor||""),l=P(o.styleBackgroundShape||"default"),u=P(o.styleBackgroundColor||""),h=P(o.styleBorderColor||""),p=P(o.styleIconColor||""),f=P(o.styleSize||"default"),y=P(o.styleMapRotation||""),k=ae=>!ae||ae==="default"?!1:ii(ae).category==="content",I=P(o.styleType&&o.styleType!=="default"&&o.styleType!=="custom"&&k(o.styleType)?o.styleType:"default"),M=P(!1),b=J(()=>!!(s.value&&s.value!=="default"||l.value&&l.value!=="default"&&l.value!=="circle"||u.value||h.value||p.value||f.value&&f.value!=="default"&&f.value!=="100")),B=ae=>ae&&ae!==""&&ae!=="default",E=ae=>ae&&ae.startsWith("#"),A=J(()=>{const pe=B(o.inheritedStyleType),Ie=B(o.inheritedBackgroundShape),Be=E(o.inheritedBackgroundColor)||E(o.inheritedStyleColor),Se=E(o.inheritedBorderColor),he=E(o.inheritedIconColor),Q=B(o.inheritedSize);if(pe||Ie||Be||Se||he||Q){const ue=pe?o.inheritedStyleType:Ie?o.inheritedBackgroundShape:"circle",te=(E(o.inheritedBackgroundColor)?o.inheritedBackgroundColor:null)||(E(o.inheritedStyleColor)?o.inheritedStyleColor:null)||L2;return qt({type:ue,backgroundShape:o.inheritedBackgroundShape||"circle",backgroundColor:te,borderColor:o.inheritedBorderColor||"#ffffff",iconColor:o.inheritedIconColor||"#ffffff",size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#10B981"/>
        <stop offset="50%" style="stop-color:#F59E0B"/>
        <stop offset="100%" style="stop-color:#EF4444"/>
      </linearGradient>
    </defs>
    <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#defaultGradient)" stroke="#fff" stroke-width="1.5"/>
  </svg>`}),C=J(()=>{const ae=o.inheritedMapRotation;return ae!==""&&ae!==void 0&&ae!==null&&ae!==0?{transform:`rotate(${ae}deg)`}:{}}),x=J(()=>{if(y.value!==""&&y.value!==void 0&&y.value!==null){const pe=parseInt(y.value,10)||0;if(pe!==0)return{transform:`rotate(${pe}deg)`}}const ae=o.inheritedMapRotation;return ae!==""&&ae!==void 0&&ae!==null&&ae!==0?{transform:`rotate(${ae}deg)`}:{}}),T=J(()=>{if(b.value){const ae=I.value&&I.value!=="none"&&I.value!=="default";let pe=null;o.inheritedStyleType&&o.inheritedStyleType!=="default"&&o.inheritedStyleType!=="custom"&&ii(o.inheritedStyleType).category==="content"&&(pe=o.inheritedStyleType);const Ie=I.value==="default"&&pe,Be=ae||Ie,Se=ae?I.value:Ie?pe:null,he=l.value&&l.value!=="default"?l.value:o.inheritedBackgroundShape||"circle",Q=Be?Se:he,X=u.value||o.inheritedBackgroundColor||o.inheritedStyleColor||"#667eea",ue=h.value||o.inheritedBorderColor||"#ffffff",te=p.value||o.inheritedIconColor||"#ffffff";return qt({type:Q,backgroundShape:he,backgroundColor:X,borderColor:ue,iconColor:te,size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#e2e8f0" stroke="#cbd5e0" stroke-width="1.5"/>
    <path d="M12 8v8M8 12h8" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
  </svg>`}),S=()=>{s.value="default",I.value="default",i("update:styleType","default"),l.value="default",u.value="",a.value="",h.value="",p.value="",f.value="default",y.value="",i("update:styleBackgroundShape",""),i("update:styleBackgroundColor",""),i("update:styleColor",""),i("update:styleBorderColor",""),i("update:styleIconColor",""),i("update:styleSize",""),i("update:styleMapRotation",""),_e()},$=()=>{M.value=!0},se=ae=>{ae.iconType==="none"?I.value="none":ae.iconType?I.value=ae.iconType:I.value="default",l.value=ae.backgroundShape||"default",u.value=ae.backgroundColor||"",h.value=ae.borderColor||"",p.value=ae.iconColor||"",f.value=ae.size||"default",y.value=ae.mapRotation??"";const pe=ae.iconType==="none"||ae.iconType&&ae.iconType!==""||ae.backgroundShape||ae.backgroundColor||ae.borderColor||ae.iconColor||ae.size||ae.mapRotation!==""&&ae.mapRotation!==0;ae.iconType&&ae.iconType!=="none"?s.value=ae.iconType:pe?s.value="custom":s.value="default",i("update:styleType",s.value),i("update:styleBackgroundShape",ae.backgroundShape),i("update:styleBackgroundColor",ae.backgroundColor),i("update:styleBorderColor",ae.borderColor),i("update:styleIconColor",ae.iconColor),i("update:styleSize",ae.size),i("update:styleMapRotation",ae.mapRotation??""),_e()},ce=()=>{},_e=()=>{i("change",{styleType:s.value,styleColor:u.value||a.value,styleBackgroundShape:l.value,styleBackgroundColor:u.value,styleBorderColor:h.value,styleIconColor:p.value,styleSize:f.value,styleMapRotation:y.value})};return qe(()=>o.styleType,ae=>{s.value=ae,ae&&ae!=="default"&&ae!=="custom"&&k(ae)?I.value=ae:I.value="default"}),qe(()=>o.styleColor,ae=>{a.value=ae||""}),qe(()=>o.styleBackgroundShape,ae=>{l.value=ae||"default"}),qe(()=>o.styleBackgroundColor,ae=>{u.value=ae||""}),qe(()=>o.styleBorderColor,ae=>{h.value=ae||""}),qe(()=>o.styleIconColor,ae=>{p.value=ae||""}),qe(()=>o.styleSize,ae=>{f.value=ae||"default"}),qe(()=>o.styleMapRotation,ae=>{y.value=ae??""}),(ae,pe)=>(m(),g("div",y2,[c("div",_2,[c("label",null,_(e.iconLabel),1),c("div",k2,[c("button",{type:"button",class:Te(["style-option-button",{selected:!b.value}]),onClick:S},[c("div",{class:"option-preview",style:st(C.value),innerHTML:A.value},null,12,b2),c("span",w2,_(e.defaultLabel),1)],2),c("button",{type:"button",class:Te(["style-option-button",{selected:b.value}]),onClick:$},[c("div",{class:"option-preview",style:st(x.value),innerHTML:T.value},null,12,C2),pe[1]||(pe[1]=c("span",{class:"option-label"},"Custom",-1))],2)])]),ze(g2,{isOpen:M.value,"onUpdate:isOpen":pe[0]||(pe[0]=Ie=>M.value=Ie),"icon-type":I.value,"background-shape":l.value,"background-color":u.value,"border-color":h.value,"icon-color":p.value,size:f.value,"map-rotation":y.value,level:e.level,"inherited-type":e.inheritedStyleType,"inherited-background-shape":e.inheritedBackgroundShape,"inherited-background-color":e.inheritedBackgroundColor||e.inheritedStyleColor,"inherited-border-color":e.inheritedBorderColor,"inherited-icon-color":e.inheritedIconColor,"inherited-size":e.inheritedSize,"inherited-map-rotation":e.inheritedMapRotation,onApply:se,onCancel:ce},null,8,["isOpen","icon-type","background-shape","background-color","border-color","icon-color","size","map-rotation","level","inherited-type","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])]))}},pu=Ye(S2,[["__scopeId","data-v-c066da64"]]),x2={class:"logo-uploader"},T2={key:0,class:"logo-preview"},I2=["src"],$2=["disabled"],M2={key:0,class:"upload-progress"},A2={key:1,class:"upload-prompt"},E2={key:2,class:"error-message"},gh=500*1024,P2={__name:"LogoUploader",props:{modelValue:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,i=t,s=P(null),a=P(!1),l=P(!1),u=P(""),h=["image/png","image/jpeg","image/svg+xml","image/gif","image/webp"];function p(){a.value||s.value?.click()}function f(M){const b=M.target.files?.[0];b&&k(b),s.value&&(s.value.value="")}function y(M){l.value=!1;const b=M.dataTransfer?.files?.[0];b&&k(b)}async function k(M){if(u.value="",!h.includes(M.type)){u.value="Invalid file type. Please use PNG, JPEG, SVG, GIF, or WebP.";return}if(M.size>gh){u.value=`File too large. Maximum size is ${gh/1024}KB.`;return}a.value=!0;try{const b=await fetch(`/api/events/${o.eventId}/logo`,{method:"POST",headers:{"Content-Type":M.type,"X-Admin-Email":o.adminEmail},body:M});if(!b.ok){const E=await b.json().catch(()=>({}));throw new Error(E.message||"Upload failed")}const B=await b.json();i("update:modelValue",B.logoUrl)}catch(b){console.error("Logo upload error:",b),u.value=b.message||"Failed to upload logo. Please try again."}finally{a.value=!1}}async function I(){u.value="",a.value=!0;try{const M=await fetch(`/api/events/${o.eventId}/logo`,{method:"DELETE",headers:{"X-Admin-Email":o.adminEmail}});if(!M.ok){const b=await M.json().catch(()=>({}));throw new Error(b.message||"Delete failed")}i("update:modelValue","")}catch(M){console.error("Logo delete error:",M),u.value=M.message||"Failed to remove logo. Please try again."}finally{a.value=!1}}return(M,b)=>(m(),g("div",x2,[b[4]||(b[4]=c("label",{class:"uploader-label"},"Event Logo",-1)),e.modelValue?(m(),g("div",T2,[c("img",{src:e.modelValue,alt:"Event logo",class:"logo-image"},null,8,I2),c("button",{type:"button",class:"remove-btn",onClick:I,disabled:a.value}," Remove ",8,$2)])):(m(),g("div",{key:1,class:Te(["upload-area",{"drag-over":l.value,uploading:a.value}]),onDragover:b[0]||(b[0]=vt(B=>l.value=!0,["prevent"])),onDragleave:b[1]||(b[1]=vt(B=>l.value=!1,["prevent"])),onDrop:vt(y,["prevent"]),onClick:p},[c("input",{ref_key:"fileInput",ref:s,type:"file",accept:"image/png,image/jpeg,image/svg+xml,image/gif,image/webp",class:"file-input",onChange:f},null,544),a.value?(m(),g("div",M2,[...b[2]||(b[2]=[c("div",{class:"spinner"},null,-1),c("span",null,"Uploading...",-1)])])):(m(),g("div",A2,[...b[3]||(b[3]=[c("div",{class:"upload-icon"},"+",-1),c("span",{class:"upload-text"},"Click or drag to upload logo",-1),c("span",{class:"upload-hint"},"PNG, JPEG, SVG, GIF, WebP (max 500KB)",-1)])]))],34)),u.value?(m(),g("div",E2,_(u.value),1)):R("",!0)]))}},D2=Ye(P2,[["__scopeId","data-v-9c7104d5"]]),zp=[{name:"Default",headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},{name:"Wasp",headerGradientStart:"#333333",headerGradientEnd:"#333333",accentColor:"#FFD700",pageGradientStart:"#FFD700",pageGradientEnd:"#333333"},{name:"Ocean",headerGradientStart:"#0077be",headerGradientEnd:"#00a8e8",accentColor:"#0077be",pageGradientStart:"#0077be",pageGradientEnd:"#00a8e8"},{name:"Forest",headerGradientStart:"#228b22",headerGradientEnd:"#32cd32",accentColor:"#228b22",pageGradientStart:"#228b22",pageGradientEnd:"#32cd32"},{name:"Sunset",headerGradientStart:"#ff6b35",headerGradientEnd:"#f7931e",accentColor:"#ff6b35",pageGradientStart:"#ff6b35",pageGradientEnd:"#f7931e"},{name:"Berry",headerGradientStart:"#8e2de2",headerGradientEnd:"#4a00e0",accentColor:"#8e2de2",pageGradientStart:"#8e2de2",pageGradientEnd:"#4a00e0"},{name:"Coral",headerGradientStart:"#ff758c",headerGradientEnd:"#ff7eb3",accentColor:"#ff758c",pageGradientStart:"#ff758c",pageGradientEnd:"#ff7eb3"},{name:"Steel",headerGradientStart:"#485563",headerGradientEnd:"#29323c",accentColor:"#485563",pageGradientStart:"#485563",pageGradientEnd:"#29323c"},{name:"Mint",headerGradientStart:"#11998e",headerGradientEnd:"#38ef7d",accentColor:"#11998e",pageGradientStart:"#11998e",pageGradientEnd:"#38ef7d"},{name:"Cherry",headerGradientStart:"#eb3349",headerGradientEnd:"#f45c43",accentColor:"#eb3349",pageGradientStart:"#eb3349",pageGradientEnd:"#f45c43"},{name:"Midnight",headerGradientStart:"#232526",headerGradientEnd:"#414345",accentColor:"#5c5c5c",pageGradientStart:"#232526",pageGradientEnd:"#414345"},{name:"Lavender",headerGradientStart:"#a18cd1",headerGradientEnd:"#fbc2eb",accentColor:"#a18cd1",pageGradientStart:"#a18cd1",pageGradientEnd:"#fbc2eb"},{name:"Gold",headerGradientStart:"#f7971e",headerGradientEnd:"#ffd200",accentColor:"#f7971e",pageGradientStart:"#f7971e",pageGradientEnd:"#ffd200"}];function O2(){return{...zp[0]}}function R2(e,t){return{...e,headerGradientStart:t.headerGradientStart,headerGradientEnd:t.headerGradientEnd,accentColor:t.accentColor,pageGradientStart:t.pageGradientStart,pageGradientEnd:t.pageGradientEnd,logoUrl:"",logoPosition:""}}function Fc(e){const t=e.replace("#",""),o=parseInt(t.slice(0,2),16)/255,i=parseInt(t.slice(2,4),16)/255,s=parseInt(t.slice(4,6),16)/255,a=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),l=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*a+.7152*l+.0722*u}function Hp(e){return!e||e===""?"#ffffff":Fc(e)>.179?"#333333":"#ffffff"}function Vp(e,t){const o=e||kn.headerGradientStart,i=t||kn.headerGradientEnd,s=Fc(o),a=Fc(i);return(s+a)/2>.35?"#333333":"#ffffff"}const kn={headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},B2={class:"marshal-mockup-container"},N2={class:"presets-section"},F2={class:"presets-row"},U2=["title","onClick"],z2={class:"preset-name"},H2={class:"mockup-frame"},V2={key:0,class:"logo-cover-bg"},G2=["src"],Z2=["src"],j2={key:1,class:"logo-placeholder"},W2={class:"event-name"},q2={class:"mockup-buttons"},K2=["src"],Y2={key:1,class:"logo-placeholder"},J2={class:"mockup-body"},X2={class:"mockup-card"},Q2={class:"card-content"},eS={class:"editor-modal"},tS={class:"editor-header"},nS={class:"editor-content"},oS={class:"color-grid-inline"},sS={class:"color-field"},iS={class:"color-swatches"},aS=["title","onClick"],rS={key:0,class:"check"},lS={class:"color-field"},cS={class:"color-swatches"},uS=["title","onClick"],dS={key:0,class:"check"},hS={class:"logo-position-section"},fS={class:"position-buttons"},pS={class:"color-swatches"},vS=["title","onClick"],mS={key:0,class:"check"},gS={class:"color-grid-inline"},yS={class:"color-field"},_S={class:"color-swatches"},kS=["title","onClick"],bS={key:0,class:"check"},wS={class:"color-field"},CS={class:"color-swatches"},LS=["title","onClick"],SS={key:0,class:"check"},xS={class:"editor-footer"},TS={__name:"MarshalModeMockup",props:{branding:{type:Object,required:!0},eventName:{type:String,default:""},eventDate:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:branding"],setup(e,{emit:t}){const o=An,i=e,s=t,a=P(null),l=zp,u={header:"Header gradient",logo:"Event logo",accent:"Accent colour",page:"Page background"},h=J(()=>i.branding.headerGradientStart||kn.headerGradientStart),p=J(()=>i.branding.headerGradientEnd||kn.headerGradientEnd),f=J(()=>i.branding.accentColor||kn.accentColor),y=J(()=>i.branding.pageGradientStart||kn.pageGradientStart),k=J(()=>i.branding.pageGradientEnd||kn.pageGradientEnd),I=J(()=>i.branding.logoPosition||"left"),M=J(()=>({background:`linear-gradient(135deg, ${h.value} 0%, ${p.value} 100%)`})),b=J(()=>Vp(h.value,p.value)),B=J(()=>({background:f.value,color:Hp(f.value)})),E=J(()=>({background:`linear-gradient(135deg, ${y.value} 0%, ${k.value} 100%)`}));function A(T){a.value=a.value===T?null:T}function C(T,S){s("update:branding",{...i.branding,[T]:S})}function x(T){s("update:branding",R2(i.branding,T)),a.value=null}return(T,S)=>(m(),g("div",B2,[c("div",N2,[S[13]||(S[13]=c("span",{class:"presets-label"},"Quick themes:",-1)),c("div",F2,[(m(!0),g(Ce,null,Re(z(l),$=>(m(),g("button",{key:$.name,type:"button",class:"preset-btn",title:$.name,onClick:se=>x($)},[c("span",{class:"preset-preview",style:st({background:`linear-gradient(135deg, ${$.pageGradientStart} 0%, ${$.pageGradientEnd} 100%)`})},null,4),c("span",z2,_($.name),1)],8,U2))),128))])]),c("div",H2,[c("div",{class:Te(["mockup-page",{"region-active":a.value==="page"}]),style:st(E.value),onClick:S[5]||(S[5]=$=>A("page"))},[c("div",{class:Te(["mockup-header",[{"region-active":a.value==="header"},`logo-${I.value}`]]),style:st(M.value),onClick:S[3]||(S[3]=vt($=>A("header"),["stop"]))},[e.branding.logoUrl&&I.value==="cover"?(m(),g("div",V2,[c("img",{src:e.branding.logoUrl,alt:"Logo",class:"logo-cover-img"},null,8,G2)])):R("",!0),I.value==="left"?(m(),g("div",{key:1,class:Te(["mockup-logo logo-left",{"region-active":a.value==="logo"}]),onClick:S[0]||(S[0]=vt($=>A("logo"),["stop"]))},[e.branding.logoUrl?(m(),g("img",{key:0,src:e.branding.logoUrl,alt:"Logo",class:"logo-img"},null,8,Z2)):(m(),g("span",j2,"+ Logo"))],2)):R("",!0),c("div",{class:Te(["header-center",{"region-active":a.value==="logo"&&!e.branding.logoUrl&&I.value!=="left"&&I.value!=="right"}]),onClick:S[1]||(S[1]=vt($=>A("logo"),["stop"]))},[c("div",{class:"mockup-title",style:st({color:b.value})},[c("span",W2,_(e.eventName||"Event Name"),1)],4),c("div",{class:"mockup-date",style:st({color:b.value})},_(e.eventDate||"Event Date"),5),c("div",q2,[S[14]||(S[14]=c("span",{class:"btn-emergency"},"Emergency",-1)),c("span",{class:"btn-logout",style:st({color:b.value})},"Logout",4)])],2),I.value==="right"?(m(),g("div",{key:2,class:Te(["mockup-logo logo-right",{"region-active":a.value==="logo"}]),onClick:S[2]||(S[2]=vt($=>A("logo"),["stop"]))},[e.branding.logoUrl?(m(),g("img",{key:0,src:e.branding.logoUrl,alt:"Logo",class:"logo-img"},null,8,K2)):(m(),g("span",Y2,"+ Logo"))],2)):R("",!0)],6),c("div",J2,[c("div",X2,[S[15]||(S[15]=c("div",{class:"card-header"},"Your checkpoints (2)",-1)),c("div",Q2,[c("div",{class:Te(["mockup-checkin-btn",{"region-active":a.value==="accent"}]),style:st(B.value),onClick:S[4]||(S[4]=vt($=>A("accent"),["stop"]))}," GPS Check-In ",6)])])])],6)]),a.value?(m(),g("div",{key:0,class:"editor-overlay",onClick:S[12]||(S[12]=vt($=>a.value=null,["self"]))},[c("div",eS,[c("div",tS,[c("span",null,_(u[a.value]),1),c("button",{type:"button",class:"editor-close",onClick:S[6]||(S[6]=$=>a.value=null)},"")]),c("div",nS,[a.value==="header"?(m(),g(Ce,{key:0},[S[18]||(S[18]=c("p",{class:"editor-description"},"Choose the colours for the header gradient.",-1)),c("div",oS,[c("div",sS,[S[16]||(S[16]=c("label",null,"Start colour",-1)),c("div",iS,[(m(!0),g(Ce,null,Re(z(o),$=>(m(),g("button",{key:"hs-"+$.hex,type:"button",class:Te(["color-swatch-btn",{selected:e.branding.headerGradientStart===$.hex}]),style:st({backgroundColor:$.hex}),title:$.name,onClick:se=>C("headerGradientStart",$.hex)},[e.branding.headerGradientStart===$.hex?(m(),g("span",rS,"")):R("",!0)],14,aS))),128))])]),c("div",lS,[S[17]||(S[17]=c("label",null,"End colour",-1)),c("div",cS,[(m(!0),g(Ce,null,Re(z(o),$=>(m(),g("button",{key:"he-"+$.hex,type:"button",class:Te(["color-swatch-btn",{selected:e.branding.headerGradientEnd===$.hex}]),style:st({backgroundColor:$.hex}),title:$.name,onClick:se=>C("headerGradientEnd",$.hex)},[e.branding.headerGradientEnd===$.hex?(m(),g("span",dS,"")):R("",!0)],14,uS))),128))])])])],64)):R("",!0),a.value==="logo"?(m(),g(Ce,{key:1},[c("div",hS,[S[19]||(S[19]=c("label",{class:"editor-label"},"Position",-1)),c("div",fS,[c("button",{type:"button",class:Te(["position-btn",{selected:I.value==="left"}]),onClick:S[7]||(S[7]=$=>C("logoPosition","left"))}," Left ",2),c("button",{type:"button",class:Te(["position-btn",{selected:I.value==="right"}]),onClick:S[8]||(S[8]=$=>C("logoPosition","right"))}," Right ",2),c("button",{type:"button",class:Te(["position-btn",{selected:I.value==="cover"}]),onClick:S[9]||(S[9]=$=>C("logoPosition","cover"))}," Cover ",2)])]),ze(D2,{"model-value":e.branding.logoUrl,"event-id":e.eventId,"admin-email":e.adminEmail,"onUpdate:modelValue":S[10]||(S[10]=$=>C("logoUrl",$))},null,8,["model-value","event-id","admin-email"])],64)):R("",!0),a.value==="accent"?(m(),g(Ce,{key:2},[S[20]||(S[20]=c("p",{class:"editor-description"},"Choose the accent colour for buttons.",-1)),c("div",pS,[(m(!0),g(Ce,null,Re(z(o),$=>(m(),g("button",{key:"ac-"+$.hex,type:"button",class:Te(["color-swatch-btn",{selected:e.branding.accentColor===$.hex}]),style:st({backgroundColor:$.hex}),title:$.name,onClick:se=>C("accentColor",$.hex)},[e.branding.accentColor===$.hex?(m(),g("span",mS,"")):R("",!0)],14,vS))),128))])],64)):R("",!0),a.value==="page"?(m(),g(Ce,{key:3},[S[23]||(S[23]=c("p",{class:"editor-description"},"Choose the colours for the page background gradient.",-1)),c("div",gS,[c("div",yS,[S[21]||(S[21]=c("label",null,"Start colour",-1)),c("div",_S,[(m(!0),g(Ce,null,Re(z(o),$=>(m(),g("button",{key:"ps-"+$.hex,type:"button",class:Te(["color-swatch-btn",{selected:e.branding.pageGradientStart===$.hex}]),style:st({backgroundColor:$.hex}),title:$.name,onClick:se=>C("pageGradientStart",$.hex)},[e.branding.pageGradientStart===$.hex?(m(),g("span",bS,"")):R("",!0)],14,kS))),128))])]),c("div",wS,[S[22]||(S[22]=c("label",null,"End colour",-1)),c("div",CS,[(m(!0),g(Ce,null,Re(z(o),$=>(m(),g("button",{key:"pe-"+$.hex,type:"button",class:Te(["color-swatch-btn",{selected:e.branding.pageGradientEnd===$.hex}]),style:st({backgroundColor:$.hex}),title:$.name,onClick:se=>C("pageGradientEnd",$.hex)},[e.branding.pageGradientEnd===$.hex?(m(),g("span",SS,"")):R("",!0)],14,LS))),128))])])])],64)):R("",!0)]),c("div",xS,[c("button",{type:"button",class:"btn-done",onClick:S[11]||(S[11]=$=>a.value=null)},"Done")])])])):R("",!0),S[24]||(S[24]=c("p",{class:"instructions"}," Click on different parts of the preview to customise them. The emergency button stays red for safety. ",-1))]))}},IS=Ye(TS,[["__scopeId","data-v-0a85c419"]]),$S={class:"settings-tab"},MS={class:"accordion"},AS={class:"accordion-section"},ES={class:"accordion-title"},PS={class:"accordion-icon"},DS={key:0,class:"accordion-content"},OS={class:"accordion-section"},RS={class:"accordion-icon"},BS={key:0,class:"accordion-content"},NS={class:"terminology-grid"},FS={class:"term-group"},US=["value"],zS={class:"term-group"},HS=["value"],VS={class:"term-group"},GS=["value"],ZS={class:"term-group"},jS=["value"],WS={class:"term-group"},qS=["value"],KS={class:"form-actions"},YS=["disabled"],JS={class:"accordion-section"},XS={class:"accordion-title"},QS={class:"accordion-icon"},ex={key:0,class:"accordion-content"},tx={class:"section-description"},nx={class:"form-actions"},ox=["disabled"],sx={class:"accordion-section"},ix={class:"accordion-title"},ax={class:"accordion-icon"},rx={key:0,class:"accordion-content"},lx={class:"section-description"},cx={class:"form-actions"},ux=["disabled"],yh="admin_settings_accordion",dx={__name:"SettingsTab",props:{eventData:{type:Object,required:!0},admins:{type:Array,default:()=>[]},formDirty:{type:Boolean,default:!1},eventId:{type:String,default:""}},emits:["submit","add-admin","remove-admin","update:formDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=ja(),a=J(()=>s.adminEmail||""),l=e,u=t,h=P({...l.eventData}),p=()=>l.eventId?`${yh}_${l.eventId}`:yh,f=P(null);Qt(()=>{const C=localStorage.getItem(p());C&&(f.value=C)});const y=J(()=>{const C=h.value.peopleTerm||"Marshals";return Ko.checkpoint.map(x=>({value:x,label:Oc(x,C)}))}),k=C=>{const x=f.value===C?null:C;f.value=x,x?localStorage.setItem(p(),x):localStorage.removeItem(p())};qe(()=>l.eventData,C=>{h.value={...C}},{deep:!0});const I=()=>{u("update:formDirty",!0)},M=(C,x)=>{h.value[C]=x,I()},b=J(()=>({headerGradientStart:h.value.brandingHeaderGradientStart||"",headerGradientEnd:h.value.brandingHeaderGradientEnd||"",logoUrl:h.value.brandingLogoUrl||"",logoPosition:h.value.brandingLogoPosition||"",accentColor:h.value.brandingAccentColor||"",pageGradientStart:h.value.brandingPageGradientStart||"",pageGradientEnd:h.value.brandingPageGradientEnd||""})),B=C=>{h.value.brandingHeaderGradientStart=C.headerGradientStart,h.value.brandingHeaderGradientEnd=C.headerGradientEnd,h.value.brandingLogoUrl=C.logoUrl,h.value.brandingLogoPosition=C.logoPosition,h.value.brandingAccentColor=C.accentColor,h.value.brandingPageGradientStart=C.pageGradientStart,h.value.brandingPageGradientEnd=C.pageGradientEnd,I()},E=()=>{O2(),h.value.brandingHeaderGradientStart="",h.value.brandingHeaderGradientEnd="",h.value.brandingLogoUrl="",h.value.brandingLogoPosition="",h.value.brandingAccentColor="",h.value.brandingPageGradientStart="",h.value.brandingPageGradientEnd="",I()},A=()=>{u("submit",{...h.value})};return(C,x)=>(m(),g("div",$S,[c("div",MS,[c("div",AS,[c("button",{class:Te(["accordion-header",{active:f.value==="admins"}]),onClick:x[0]||(x[0]=T=>k("admins"))},[c("span",ES,"Administrators ("+_(e.admins.length)+")",1),c("span",PS,_(f.value==="admins"?"-":"+"),1)],2),f.value==="admins"?(m(),g("div",DS,[ze(aL,{admins:e.admins,onAddAdmin:x[1]||(x[1]=T=>C.$emit("add-admin")),onRemoveAdmin:x[2]||(x[2]=T=>C.$emit("remove-admin",T))},null,8,["admins"])])):R("",!0)]),c("div",OS,[c("button",{class:Te(["accordion-header",{active:f.value==="terminology"}]),onClick:x[3]||(x[3]=T=>k("terminology"))},[x[19]||(x[19]=c("span",{class:"accordion-title"},"Terminology",-1)),c("span",RS,_(f.value==="terminology"?"-":"+"),1)],2),f.value==="terminology"?(m(),g("div",BS,[x[20]||(x[20]=c("p",{class:"section-description"}," Customise how things are named throughout the application. ",-1)),c("div",NS,[c("div",FS,[c("label",null,_(z(o).people)+" are called",1),je(c("select",{"onUpdate:modelValue":x[4]||(x[4]=T=>h.value.peopleTerm=T),class:"form-input",onChange:I},[(m(!0),g(Ce,null,Re(z(Ko).people,T=>(m(),g("option",{key:T,value:T},_(T),9,US))),128))],544),[[bn,h.value.peopleTerm]])]),c("div",zS,[c("label",null,_(z(o).checkpoints)+" are called",1),je(c("select",{"onUpdate:modelValue":x[5]||(x[5]=T=>h.value.checkpointTerm=T),class:"form-input",onChange:I},[(m(!0),g(Ce,null,Re(y.value,T=>(m(),g("option",{key:T.value,value:T.value},_(T.label),9,HS))),128))],544),[[bn,h.value.checkpointTerm]])]),c("div",VS,[c("label",null,_(z(o).areas)+" are called",1),je(c("select",{"onUpdate:modelValue":x[6]||(x[6]=T=>h.value.areaTerm=T),class:"form-input",onChange:I},[(m(!0),g(Ce,null,Re(z(Ko).area,T=>(m(),g("option",{key:T,value:T},_(T),9,GS))),128))],544),[[bn,h.value.areaTerm]])]),c("div",ZS,[c("label",null,_(z(o).checklists)+" are called",1),je(c("select",{"onUpdate:modelValue":x[7]||(x[7]=T=>h.value.checklistTerm=T),class:"form-input",onChange:I},[(m(!0),g(Ce,null,Re(z(Ko).checklist,T=>(m(),g("option",{key:T,value:T},_(T),9,jS))),128))],544),[[bn,h.value.checklistTerm]])]),c("div",WS,[c("label",null,_(z(o).course)+" is called",1),je(c("select",{"onUpdate:modelValue":x[8]||(x[8]=T=>h.value.courseTerm=T),class:"form-input",onChange:I},[(m(!0),g(Ce,null,Re(z(Ko).course,T=>(m(),g("option",{key:T,value:T},_(T),9,qS))),128))],544),[[bn,h.value.courseTerm]])])]),c("div",KS,[c("button",{onClick:A,class:"btn btn-primary",disabled:!e.formDirty}," Save Changes ",8,YS)])])):R("",!0)]),c("div",JS,[c("button",{class:Te(["accordion-header",{active:f.value==="appearance"}]),onClick:x[9]||(x[9]=T=>k("appearance"))},[c("span",XS,_(z(o).checkpoint)+" appearance",1),c("span",QS,_(f.value==="appearance"?"-":"+"),1)],2),f.value==="appearance"?(m(),g("div",ex,[c("p",tx," Set the default marker style for all "+_(z(i).checkpoints)+" in this event. Individual "+_(z(i).areas)+" and "+_(z(i).checkpoints)+" can override this setting. ",1),ze(pu,{"style-type":h.value.defaultCheckpointStyleType||"default","style-color":h.value.defaultCheckpointStyleColor||"","style-background-shape":h.value.defaultCheckpointStyleBackgroundShape||"","style-background-color":h.value.defaultCheckpointStyleBackgroundColor||"","style-border-color":h.value.defaultCheckpointStyleBorderColor||"","style-icon-color":h.value.defaultCheckpointStyleIconColor||"","style-size":h.value.defaultCheckpointStyleSize||"","style-map-rotation":h.value.defaultCheckpointStyleMapRotation??"","icon-label":"Default marker style",level:"event","show-preview":!0,"onUpdate:styleType":x[10]||(x[10]=T=>M("defaultCheckpointStyleType",T)),"onUpdate:styleColor":x[11]||(x[11]=T=>M("defaultCheckpointStyleColor",T)),"onUpdate:styleBackgroundShape":x[12]||(x[12]=T=>M("defaultCheckpointStyleBackgroundShape",T)),"onUpdate:styleBackgroundColor":x[13]||(x[13]=T=>M("defaultCheckpointStyleBackgroundColor",T)),"onUpdate:styleBorderColor":x[14]||(x[14]=T=>M("defaultCheckpointStyleBorderColor",T)),"onUpdate:styleIconColor":x[15]||(x[15]=T=>M("defaultCheckpointStyleIconColor",T)),"onUpdate:styleSize":x[16]||(x[16]=T=>M("defaultCheckpointStyleSize",T)),"onUpdate:styleMapRotation":x[17]||(x[17]=T=>M("defaultCheckpointStyleMapRotation",T))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation"]),c("div",nx,[c("button",{onClick:A,class:"btn btn-primary",disabled:!e.formDirty}," Save Changes ",8,ox)])])):R("",!0)]),c("div",sx,[c("button",{class:Te(["accordion-header",{active:f.value==="branding"}]),onClick:x[18]||(x[18]=T=>k("branding"))},[c("span",ix,_(z(o).person)+" branding",1),c("span",ax,_(f.value==="branding"?"-":"+"),1)],2),f.value==="branding"?(m(),g("div",rx,[c("p",lx," Customise the appearance of the "+_(z(i).person)+" view to match your organisation's branding. ",1),ze(IS,{branding:b.value,"event-name":h.value.name,"event-date":z(Bp)(h.value.eventDate),"event-id":e.eventId,"admin-email":a.value,"onUpdate:branding":B},null,8,["branding","event-name","event-date","event-id","admin-email"]),c("div",cx,[c("button",{onClick:A,class:"btn btn-primary",disabled:!e.formDirty}," Save Changes ",8,ux),c("button",{onClick:E,class:"btn btn-secondary"}," Reset to Default ")])])):R("",!0)])])]))}},hx=Ye(dx,[["__scopeId","data-v-3ed53f3e"]]),fx={class:"button-group"},px={key:0,class:"add-dropdown"},vx={key:0,class:"filter-group"},mx={class:"filter-checkbox"},gx=["checked"],yx={class:"locations-list"},_x=["onClick"],kx={class:"location-info"},bx={class:"location-header"},wx=["innerHTML"],Cx={class:"location-name-desc"},Lx={key:0,class:"location-description"},Sx={class:"location-status"},xx={class:"location-assignments"},Tx={__name:"CheckpointsList",props:{locations:{type:Array,required:!0},areas:{type:Array,default:()=>[]}},emits:["add-checkpoint-manually","import-checkpoints","select-location"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=e,a=t,l=P(!0),u=P([]),h=P(null),p=P(null),f=P(!1),y=()=>{f.value=!f.value},k=()=>{f.value=!1,a("add-checkpoint-manually")},I=()=>{f.value=!1,a("import-checkpoints")},M=x=>{p.value&&!p.value.contains(x.target)&&(f.value=!1)};Qt(()=>{document.addEventListener("click",M)}),po(()=>{document.removeEventListener("click",M)});const b=()=>{l.value=!l.value,!l.value&&u.value.length===0&&(u.value=s.areas.map(x=>x.id))},B=J(()=>{let x=s.locations;return!l.value&&u.value.length>0&&(x=x.filter(T=>(T.areaIds||T.AreaIds||[]).some($=>u.value.includes($)))),[...x].sort((T,S)=>Cn(T.name,S.name))}),E=x=>{const T=s.areas.find(S=>S.id===x);return T?T.name:null},A=x=>{const T=s.areas.find(S=>S.id===x);return T?T.color:"#999"},C=x=>{const T=x.resolvedStyleType||x.ResolvedStyleType,S=x.resolvedStyleBackgroundColor||x.ResolvedStyleBackgroundColor||x.resolvedStyleColor||x.ResolvedStyleColor,$=x.resolvedStyleBorderColor||x.ResolvedStyleBorderColor,se=x.resolvedStyleIconColor||x.ResolvedStyleIconColor,ce=x.resolvedStyleBackgroundShape||x.ResolvedStyleBackgroundShape;return T&&T!=="default"||S||$||se||ce&&ce!=="circle"?qt({type:T||"circle",backgroundShape:ce||"circle",backgroundColor:S||"#667eea",borderColor:$||"#ffffff",iconColor:se||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`};return(x,T)=>(m(),g("div",null,[c("h3",null,_(z(o).checkpoints)+" ("+_(e.locations.length)+")",1),c("div",fx,[c("div",{class:"add-menu-wrapper",ref_key:"menuWrapperRef",ref:p},[c("button",{ref_key:"addButtonRef",ref:h,onClick:y,class:"btn btn-small btn-primary"}," Add... ",512),f.value?(m(),g("div",px,[c("button",{onClick:k,class:"dropdown-item"}," Add "+_(z(i).checkpoint)+" manually ",1),c("button",{onClick:I,class:"dropdown-item"}," Import from CSV... ")])):R("",!0)],512)]),e.areas.length>0?(m(),g("div",vx,[c("h4",null,"Filter by "+_(z(o).area.toLowerCase())+":",1),c("label",mx,[c("input",{type:"checkbox",checked:l.value,onChange:b},null,40,gx),Ze(" All "+_(z(o).areas.toLowerCase())+" ("+_(e.locations.length)+") ",1)]),l.value?R("",!0):(m(),ct(Up,{key:0,areas:e.areas,"selected-area-ids":u.value,"onUpdate:selectedAreaIds":T[0]||(T[0]=S=>u.value=S)},null,8,["areas","selected-area-ids"]))])):R("",!0),c("div",yx,[(m(!0),g(Ce,null,Re(B.value,S=>(m(),g("div",{key:S.id,class:Te(["location-item",{"location-full":S.checkedInCount>=S.requiredMarshals,"location-missing":S.checkedInCount===0}]),onClick:$=>x.$emit("select-location",S)},[c("div",kx,[c("div",bx,[c("span",{class:"checkpoint-icon",innerHTML:C(S)},null,8,wx),c("div",Cx,[c("strong",null,_(S.name),1),S.description?(m(),g("span",Lx," - "+_(S.description),1)):R("",!0)]),(m(!0),g(Ce,null,Re(S.areaIds||S.AreaIds||[],$=>(m(),g("span",{key:$,class:"area-badge",style:st({backgroundColor:A($)})},_(E($)),5))),128)),c("span",Sx,_(S.checkedInCount)+"/"+_(S.requiredMarshals),1)])]),c("div",xx,[(m(!0),g(Ce,null,Re(S.assignments,$=>(m(),g("span",{key:$.id,class:Te(["assignment-badge",{"checked-in":$.isCheckedIn}])},_($.marshalName),3))),128))])],10,_x))),128))])]))}},Ix=Ye(Tx,[["__scopeId","data-v-6e5f3a03"]]),$x={class:"button-group"},Mx={class:"areas-list"},Ax=["onClick"],Ex={class:"area-info"},Px={class:"area-header"},Dx={key:0,class:"default-badge"},Ox={key:0,class:"area-description"},Rx={class:"area-stats"},Bx={class:"stat-badge"},Nx={class:"stat-badge"},Fx={key:0,class:"empty-state"},Ux={__name:"AreasList",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["add-area","select-area"],setup(e){const{terms:t}=Ct(),o=e,i=J(()=>[...o.areas].sort((p,f)=>p.displayOrder!==f.displayOrder?p.displayOrder-f.displayOrder:Cn(p.name,f.name))),s=p=>p.checkpointCount!==void 0?p.checkpointCount:o.checkpoints.filter(f=>f.areaId===p.id).length,a=p=>o.contacts.filter(f=>f.scopeConfigurations?f.scopeConfigurations.some(y=>y.scope==="EveryoneInAreas"&&y.itemType==="Area"?y.ids?.includes("ALL_AREAS")?!0:y.ids?.includes(p.id):!1):!1).length,l=p=>p.peopleTerm||o.eventPeopleTerm||"Marshals",u=(p,f)=>{const y=p.checkpointTerm||o.eventCheckpointTerm||"Checkpoints",k=l(p);return f===1?Ys("checkpoint",y,k):Rp("checkpoint",y,k)},h=p=>{const f=s(p),y=u(p,f).toLowerCase();return`${f} ${y}`};return(p,f)=>(m(),g("div",null,[c("h3",null,_(z(t).areas)+" ("+_(e.areas.length)+")",1),c("div",$x,[c("button",{onClick:f[0]||(f[0]=y=>p.$emit("add-area")),class:"btn btn-small btn-primary"}," Add "+_(z(t).area.toLowerCase()),1)]),c("div",Mx,[(m(!0),g(Ce,null,Re(i.value,y=>(m(),g("div",{key:y.id,class:"area-item",style:st({borderLeftColor:y.color||"#667eea"}),onClick:k=>p.$emit("select-area",y)},[c("div",Ex,[c("div",Px,[c("strong",null,_(y.name),1),y.isDefault?(m(),g("span",Dx,"Default")):R("",!0)]),y.description?(m(),g("p",Ox,_(y.description),1)):R("",!0),c("div",Rx,[c("span",Bx,_(h(y)),1),c("span",Nx,_(a(y))+" contact"+_(a(y)===1?"":"s"),1)])])],12,Ax))),128)),e.areas.length===0?(m(),g("div",Fx,[c("p",null,"No "+_(z(t).areas.toLowerCase())+' yet. Click "Add '+_(z(t).area.toLowerCase())+'" to create one.',1)])):R("",!0)])]))}},zx=Ye(Ux,[["__scopeId","data-v-65c30be2"]]),Hx={course:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>',checkpoint:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',area:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',marshal:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',checklist:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>',notes:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/></svg>',details:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16h6"/></svg>',location:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',contacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>',people:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polygon points="22 8 19.5 10 20.5 13 18 11.5 15.5 13 16.5 10 14 8 17 8 18 5 19 8 22 8" fill="currentColor"/></svg>',eventContacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 8V6a2 2 0 0 0-2-2h-2"/><path d="M22 12v2a2 2 0 0 1-2 2h-2"/></svg>',event:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>',appearance:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12.5" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>'},Pn=e=>Hx[e]||"",Vx={class:"responsive-tabs"},Gx=["onClick"],Zx=["innerHTML"],jx=["innerHTML"],Wx={class:"hamburger-label"},qx=["onClick"],Kx=["innerHTML"],Yx={__name:"ResponsiveTabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,i=t,s=P(null),a=P(null),l=P(null),u=P(!1),h=P({}),p=P(!1),f=J(()=>o.tabs.find(E=>E.value===o.modelValue)),y=J(()=>f.value?f.value.label:"Menu"),k=()=>{if(u.value=!u.value,u.value&&a.value){const E=a.value.getBoundingClientRect();h.value={top:`${E.bottom+4}px`}}},I=E=>{i("update:modelValue",E),u.value=!1},M=E=>{if(!s.value)return;const A=s.value.contains(E.target);u.value&&!A&&(u.value=!1)},b=()=>{if(!l.value)return;const E=l.value,A=p.value;A&&(E.style.visibility="visible",E.style.position="static");const C=E.scrollWidth>E.clientWidth;A&&(E.style.visibility="",E.style.position=""),p.value=C};let B=null;return Qt(()=>{document.addEventListener("click",M),Qo(()=>{b()}),Qo(()=>{const E=l.value?.parentElement;E&&(B=new ResizeObserver(()=>{b()}),B.observe(E))})}),po(()=>{document.removeEventListener("click",M),B&&B.disconnect()}),qe(()=>o.tabs,()=>{Qo(()=>{b()})},{deep:!0}),(E,A)=>(m(),g("div",Vx,[c("div",{ref_key:"visibleTabsRef",ref:l,class:Te(["visible-tabs",{"is-hidden":p.value}])},[(m(!0),g(Ce,null,Re(e.tabs,C=>(m(),g("button",{key:C.value,class:Te(["tab-button",{active:e.modelValue===C.value}]),onClick:x=>E.$emit("update:modelValue",C.value),type:"button"},[C.icon?(m(),g("span",{key:0,class:"tab-icon",innerHTML:z(Pn)(C.icon)},null,8,Zx)):R("",!0),Ze(" "+_(C.label),1)],10,Gx))),128))],2),c("div",{class:Te(["hamburger-only",{"is-visible":p.value}])},[c("div",{class:"hamburger-menu",ref_key:"hamburgerMenu",ref:s},[c("button",{ref_key:"hamburgerButton",ref:a,class:Te(["hamburger-button",{active:u.value}]),onClick:vt(k,["stop"]),type:"button"},[A[1]||(A[1]=c("span",{class:"hamburger-icon"},"",-1)),f.value?.icon?(m(),g("span",{key:0,class:"tab-icon",innerHTML:z(Pn)(f.value.icon)},null,8,jx)):R("",!0),c("span",Wx,_(y.value),1)],2),u.value?(m(),g("div",{key:0,class:"hamburger-dropdown",style:st(h.value),onClick:A[0]||(A[0]=vt(()=>{},["stop"]))},[(m(!0),g(Ce,null,Re(e.tabs,C=>(m(),g("button",{key:C.value,class:Te(["dropdown-item",{active:e.modelValue===C.value}]),onClick:vt(x=>I(C.value),["stop"]),type:"button"},[C.icon?(m(),g("span",{key:0,class:"tab-icon",innerHTML:z(Pn)(C.icon)},null,8,Kx)):R("",!0),Ze(" "+_(C.label),1)],10,qx))),128))],4)):R("",!0)],512)],2)]))}},Jx=Ye(Yx,[["__scopeId","data-v-bf1f766d"]]),Xx={class:"share-link-container"},Qx=["value"],eT={__name:"ShareLinkModal",props:{show:{type:Boolean,default:!1},link:{type:String,required:!0},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=t,i=P(!1),s=P(null),a=()=>{s.value&&(s.value.select(),document.execCommand("copy"),i.value=!0,setTimeout(()=>{i.value=!1},2e3))},l=()=>{o("close")};return(u,h)=>(m(),ct(Ht,{show:e.show,title:"Marshal check-in link",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:l},{actions:et(()=>[c("button",{onClick:l,class:"btn btn-secondary"},"Close")]),default:et(()=>[h[0]||(h[0]=c("p",{class:"instruction"},"Share this link with marshals so they can check in:",-1)),c("div",Xx,[c("input",{value:e.link,readonly:"",class:"form-input",ref_key:"linkInput",ref:s},null,8,Qx),c("button",{onClick:a,class:"btn btn-primary"},_(i.value?"Copied!":"Copy"),1)])]),_:1},8,["show","is-dirty"]))}},tT=Ye(eT,[["__scopeId","data-v-e3c38c66"]]),nT={class:"success-content"},oT={class:"success-message"},sT={class:"link-section"},iT={class:"help-text"},aT={key:0,class:"loading-text"},rT={key:1,class:"magic-link-container"},lT=["value"],cT={class:"magic-link-actions"},uT=["disabled"],dT={key:0,class:"success-text"},hT={key:1,class:"error-text"},fT={key:2,class:"error-text"},pT={__name:"MarshalCreatedModal",props:{show:{type:Boolean,default:!1},eventId:{type:String,required:!0},marshalId:{type:String,default:null},marshalName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const{terms:o}=Ct(),i=e,s=t,a=P(""),l=P(!1),u=P(!1),h=P(""),p=P(!1),f=P(!1),y=P(!1),k=P(""),I=async()=>{if(!(!i.eventId||!i.marshalId)){u.value=!0,h.value="";try{const E=await So.getMagicLink(i.eventId,i.marshalId);a.value=E.data.magicLink,l.value=E.data.hasEmail}catch(E){console.error("Failed to fetch magic link:",E),h.value="Failed to load login link"}finally{u.value=!1}}},M=async()=>{try{await navigator.clipboard.writeText(a.value),p.value=!0,setTimeout(()=>{p.value=!1},2e3)}catch(E){console.error("Failed to copy:",E)}},b=async()=>{if(!(!i.eventId||!i.marshalId)){f.value=!0,y.value=!1,k.value="";try{await So.sendMagicLink(i.eventId,i.marshalId),y.value=!0,setTimeout(()=>{y.value=!1},3e3)}catch(E){console.error("Failed to send email:",E),k.value=E.response?.data?.message||"Failed to send email"}finally{f.value=!1}}},B=()=>{s("close")};return qe(()=>i.show,E=>{E&&i.marshalId?I():(a.value="",l.value=!1,h.value="",p.value=!1,y.value=!1,k.value="")},{immediate:!0}),(E,A)=>(m(),ct(Ht,{show:e.show,title:`${z(o).person} created`,size:"medium","confirm-on-close":!1,"is-dirty":!1,onClose:B},{actions:et(()=>[c("button",{onClick:B,class:"btn btn-primary"},"Done")]),default:et(()=>[c("div",nT,[A[2]||(A[2]=c("div",{class:"success-icon"},"",-1)),c("p",oT,[c("strong",null,_(e.marshalName),1),A[1]||(A[1]=Ze(" has been added successfully. ",-1))])]),c("div",sT,[A[3]||(A[3]=c("label",null,"Login link",-1)),c("p",iT," Share this unique link with "+_(e.marshalName)+" so they can access their dashboard and check in. ",1),u.value?(m(),g("div",aT,"Loading link...")):a.value?(m(),g("div",rT,[c("input",{type:"text",value:a.value,readonly:"",class:"form-input magic-link-input",onFocus:A[0]||(A[0]=C=>C.target.select())},null,40,lT),c("div",cT,[c("button",{type:"button",class:"btn btn-secondary",onClick:M},_(p.value?"Copied!":"Copy link"),1),l.value?(m(),g("button",{key:0,type:"button",class:"btn btn-primary",disabled:f.value,onClick:b},_(f.value?"Sending...":"Send via email"),9,uT)):R("",!0)]),y.value?(m(),g("p",dT,"Email sent successfully!")):R("",!0),k.value?(m(),g("p",hT,_(k.value),1)):R("",!0)])):h.value?(m(),g("div",fT,_(h.value),1)):R("",!0)])]),_:1},8,["show","title"]))}},vT=Ye(pT,[["__scopeId","data-v-0de41f28"]]),mT={class:"form-group"},gT={__name:"AddAdminModal",props:{show:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=P("");qe(()=>o.show,h=>{h||(s.value="")});const a=()=>{i("update:isDirty",!0)},l=()=>{i("submit",s.value)},u=()=>{i("close")};return(h,p)=>(m(),ct(Ht,{show:e.show,title:"Add event administrator",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:et(()=>[c("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:l,class:"btn btn-primary"}," Add administrator ")]),default:et(()=>[p[2]||(p[2]=c("p",{class:"instruction"},"Enter the email address of the administrator to add",-1)),c("form",{onSubmit:vt(l,["prevent"])},[c("div",mT,[p[1]||(p[1]=c("label",null,"Email address",-1)),je(c("input",{"onUpdate:modelValue":p[0]||(p[0]=f=>s.value=f),type:"email",required:"",class:"form-input",placeholder:"admin@example.com",onInput:a},null,544),[[ht,s.value]])])],32)]),_:1},8,["show","is-dirty"]))}},yT=Ye(gT,[["__scopeId","data-v-43ad537f"]]),_T={class:"form-group"},kT={key:0,class:"error"},bT=["disabled"],wT={__name:"UploadRouteModal",props:{show:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},error:{type:String,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=P(null);qe(()=>o.show,h=>{h||(s.value=null)});const a=h=>{s.value=h.target.files[0],i("update:isDirty",!0)},l=()=>{s.value&&i("submit",s.value)},u=()=>{i("close")};return(h,p)=>(m(),ct(Ht,{show:e.show,title:"Upload GPX route",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:et(()=>[c("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:l,class:"btn btn-primary",disabled:e.uploading},_(e.uploading?"Uploading...":"Upload route"),9,bT)]),default:et(()=>[p[1]||(p[1]=c("p",{class:"instruction"},"Upload a GPX file to display the event route on the map",-1)),c("form",{onSubmit:vt(l,["prevent"])},[c("div",_T,[p[0]||(p[0]=c("label",null,"GPX file",-1)),c("input",{type:"file",accept:".gpx",onChange:a,required:"",class:"form-input"},null,32)]),e.error?(m(),g("div",kT,_(e.error),1)):R("",!0)],32)]),_:1},8,["show","is-dirty"]))}},CT=Ye(wT,[["__scopeId","data-v-1c1d3033"]]),LT={class:"instruction"},ST={class:"form-group"},xT={class:"form-group"},TT={class:"checkbox-label"},IT={key:0,class:"error"},$T={key:1,class:"import-result"},MT={key:0,class:"import-errors"},AT=["disabled"],ET={__name:"ImportLocationsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=e,a=t,l=P(null),u=P(!1);qe(()=>s.show,k=>{k||(l.value=null,u.value=!1)});const h=k=>{l.value=k.target.files[0],a("update:isDirty",!0)},p=()=>{a("update:isDirty",!0)},f=()=>{l.value&&a("submit",{file:l.value,deleteExisting:u.value})},y=()=>{a("close")};return(k,I)=>(m(),ct(Ht,{show:e.show,title:`Import ${z(i).checkpoints} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:y},{actions:et(()=>[c("button",{type:"button",onClick:y,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:f,class:"btn btn-primary",disabled:e.importing},_(e.importing?"Importing...":`Import ${z(i).checkpoints}`),9,AT)]),default:et(()=>[c("p",LT,"Upload a CSV file with columns: Label, Lat/Latitude, Long/Longitude, What3Words (optional), "+_(z(o).people)+" (optional)",1),I[3]||(I[3]=c("div",{class:"csv-example"},[c("strong",null,"Example CSV format:"),c("pre",null,`Label,Latitude,Longitude,What3Words,Marshals
Checkpoint 1,51.505,-0.09,filled.count.soap,"John Doe, Jane Smith"
Checkpoint 2,51.510,-0.10,index.home.raft,Bob Wilson`)],-1)),c("form",{onSubmit:vt(f,["prevent"])},[c("div",ST,[I[1]||(I[1]=c("label",null,"CSV file",-1)),c("input",{type:"file",accept:".csv",onChange:h,required:"",class:"form-input"},null,32)]),c("div",xT,[c("label",TT,[je(c("input",{type:"checkbox","onUpdate:modelValue":I[0]||(I[0]=M=>u.value=M),onChange:p},null,544),[[Ls,u.value]]),Ze(" Delete existing "+_(z(i).checkpoints)+" before import ",1)])]),e.error?(m(),g("div",IT,_(e.error),1)):R("",!0),e.result?(m(),g("div",$T,[c("p",null,"Created "+_(e.result.locationsCreated)+" "+_(z(i).checkpoints)+" and "+_(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(m(),g("div",MT,[I[2]||(I[2]=c("strong",null,"Errors:",-1)),c("ul",null,[(m(!0),g(Ce,null,Re(e.result.errors,(M,b)=>(m(),g("li",{key:b},_(M),1))),128))])])):R("",!0)])):R("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},PT=Ye(ET,[["__scopeId","data-v-e0a01848"]]),DT={class:"instruction"},OT={class:"form-group"},RT={key:0,class:"error"},BT={key:1,class:"import-result"},NT={key:0,class:"import-errors"},FT=["disabled"],UT={__name:"ImportMarshalsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=e,a=t,l=P(null);qe(()=>s.show,f=>{f||(l.value=null)});const u=f=>{l.value=f.target.files[0],a("update:isDirty",!0)},h=()=>{l.value&&a("submit",l.value)},p=()=>{a("close")};return(f,y)=>(m(),ct(Ht,{show:e.show,title:`Import ${z(i).people} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:p},{actions:et(()=>[c("button",{type:"button",onClick:p,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:h,class:"btn btn-primary",disabled:e.importing},_(e.importing?"Importing...":`Import ${z(i).people}`),9,FT)]),default:et(()=>[c("p",DT,"Upload a CSV file with columns: Name, Email (optional), Phone (optional), "+_(z(o).checkpoint)+" (optional)",1),y[2]||(y[2]=c("div",{class:"csv-example"},[c("strong",null,"Example CSV format:"),c("pre",null,`Name,Email,Phone,Checkpoint
John Doe,john@example.com,555-1234,Checkpoint 1
Jane Smith,jane@example.com,555-5678,Checkpoint 2`)],-1)),c("form",{onSubmit:vt(h,["prevent"])},[c("div",OT,[y[0]||(y[0]=c("label",null,"CSV file",-1)),c("input",{type:"file",accept:".csv",onChange:u,required:"",class:"form-input"},null,32)]),e.error?(m(),g("div",RT,_(e.error),1)):R("",!0),e.result?(m(),g("div",BT,[c("p",null,"Imported "+_(e.result.marshalsCreated)+" "+_(z(i).people)+" and "+_(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(m(),g("div",NT,[y[1]||(y[1]=c("strong",null,"Errors:",-1)),c("ul",null,[(m(!0),g(Ce,null,Re(e.result.errors,(k,I)=>(m(),g("li",{key:I},_(k),1))),128))])])):R("",!0)])):R("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},zT=Ye(UT,[["__scopeId","data-v-dcaed17c"]]),HT={key:0,class:"tabs"},VT=["onClick"],GT=["innerHTML"],ZT=["innerHTML"],jT={class:"current-tab-label"},WT={key:0,class:"hamburger-menu"},qT=["onClick"],KT=["innerHTML"],YT=400,JT={__name:"TabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,i=t,s=P(null),a=P(null),l=P(!1),u=P(!1),h=J(()=>{const b=o.tabs.find(B=>B.value===o.modelValue);return b?b.label:""}),p=J(()=>o.tabs.find(B=>B.value===o.modelValue)?.icon||null),f=()=>{if(!s.value)return;const b=s.value.clientWidth,B=o.tabs.length*100;l.value=B>b||b<YT},y=()=>{u.value=!u.value},k=b=>{i("update:modelValue",b),u.value=!1},I=b=>{a.value&&!a.value.contains(b.target)&&(u.value=!1)};let M=null;return Qt(()=>{Qo(()=>{f(),s.value&&typeof ResizeObserver<"u"&&(M=new ResizeObserver(()=>{f()}),M.observe(s.value)),document.addEventListener("click",I)})}),po(()=>{M&&M.disconnect(),document.removeEventListener("click",I)}),qe(()=>o.tabs,()=>{Qo(()=>{f()})},{deep:!0}),(b,B)=>(m(),g("div",{class:"tabs-container",ref_key:"containerRef",ref:s},[l.value?(m(),g("div",{key:1,class:"hamburger-container",ref_key:"hamburgerRef",ref:a},[c("button",{class:"hamburger-button",onClick:y,type:"button","aria-label":"Tab menu"},[p.value?(m(),g("span",{key:0,class:"current-tab-icon",innerHTML:z(Pn)(p.value)},null,8,ZT)):R("",!0),c("span",jT,_(h.value),1),B[0]||(B[0]=c("span",{class:"hamburger-chevron"},"",-1))]),u.value?(m(),g("div",WT,[(m(!0),g(Ce,null,Re(e.tabs,E=>(m(),g("button",{key:E.value,class:Te(["menu-item",{active:e.modelValue===E.value}]),onClick:A=>k(E.value),type:"button"},[E.icon?(m(),g("span",{key:0,class:"tab-icon",innerHTML:z(Pn)(E.icon)},null,8,KT)):R("",!0),Ze(" "+_(E.label),1)],10,qT))),128))])):R("",!0)],512)):(m(),g("div",HT,[(m(!0),g(Ce,null,Re(e.tabs,E=>(m(),g("button",{key:E.value,class:Te(["tab-button",{active:e.modelValue===E.value}]),onClick:A=>b.$emit("update:modelValue",E.value),type:"button"},[E.icon?(m(),g("span",{key:0,class:"tab-icon",innerHTML:z(Pn)(E.icon)},null,8,GT)):R("",!0),Ze(" "+_(E.label),1)],10,VT))),128))]))],512))}},vu=Ye(JT,[["__scopeId","data-v-a3662104"]]),XT={class:"tab-content"},QT={class:"form-group"},eI=["value"],tI={class:"form-group"},nI=["value"],oI={class:"form-group"},sI={class:"area-display"},iI={key:0,class:"no-area"},aI={class:"form-help"},rI={class:"form-group checkbox-group"},lI={class:"checkbox-label"},cI=["checked"],uI={class:"form-help"},dI={key:0,class:"custom-times-section"},hI={class:"form-group"},fI=["value"],pI={class:"form-help"},vI={class:"form-group"},mI=["value"],gI={class:"form-help"},yI={__name:"LocationDetailsTab",props:{form:{type:Object,required:!0},areas:{type:Array,default:()=>[]},eventDate:{type:String,default:""},areaTermSingular:{type:String,default:"Area"},areaTermPlural:{type:String,default:"Areas"},checkpointTermSingular:{type:String,default:"checkpoint"},peopleTermPlural:{type:String,default:"marshals"}},emits:["update:form","input","save"],setup(e,{emit:t}){const o=e,i=t,s=J(()=>(o.form.areaIds||o.form.AreaIds||[]).map(h=>o.areas.find(p=>p.id===h)).filter(h=>h!==void 0)),a=(u,h)=>{i("update:form",{...o.form,[u]:h}),i("input")},l=u=>{const h={...o.form,useCustomTimes:u};if(!u)h.startTime="",h.endTime="";else if(!h.startTime&&!h.endTime&&o.eventDate){const p=Ra(o.eventDate);h.startTime=p,h.endTime=p}i("update:form",h),i("input")};return(u,h)=>(m(),g("div",XT,[c("form",{onSubmit:h[5]||(h[5]=vt(p=>u.$emit("save"),["prevent"]))},[c("div",QT,[h[6]||(h[6]=c("label",null,"Name",-1)),c("input",{value:e.form.name,onInput:h[0]||(h[0]=p=>a("name",p.target.value)),type:"text",required:"",class:"form-input"},null,40,eI)]),c("div",tI,[h[7]||(h[7]=c("label",null,"Description (optional)",-1)),c("input",{value:e.form.description,onInput:h[1]||(h[1]=p=>a("description",p.target.value)),type:"text",class:"form-input"},null,40,nI)]),c("div",oI,[c("label",null,_(e.areaTermSingular)+" (auto-assigned by location)",1),c("div",sI,[s.value.length===0?(m(),g("span",iI," Not in any "+_(e.areaTermSingular.toLowerCase())+" polygon ",1)):R("",!0),(m(!0),g(Ce,null,Re(s.value,p=>(m(),g("span",{key:p.id,class:"area-badge",style:st({backgroundColor:p.color||"#667eea"})},_(p.name),5))),128))]),c("small",aI,_(e.areaTermPlural)+" are automatically assigned based on "+_(e.checkpointTermSingular.toLowerCase())+" location within "+_(e.areaTermSingular.toLowerCase())+" boundaries ",1)]),c("div",rI,[c("label",lI,[c("input",{checked:e.form.useCustomTimes,onChange:h[2]||(h[2]=p=>l(p.target.checked)),type:"checkbox"},null,40,cI),c("span",null,"Use custom date/time for this "+_(e.checkpointTermSingular.toLowerCase()),1)]),c("small",uI," By default, "+_(e.peopleTermPlural.toLowerCase())+" are expected during the event date/time. Enable this to set a specific time range. ",1)]),e.form.useCustomTimes?(m(),g("div",dI,[c("div",hI,[h[8]||(h[8]=c("label",null,"Start date & time (optional)",-1)),c("input",{value:e.form.startTime,onInput:h[3]||(h[3]=p=>a("startTime",p.target.value)),type:"datetime-local",class:"form-input"},null,40,fI),c("small",pI," When "+_(e.peopleTermPlural.toLowerCase())+" should arrive at this "+_(e.checkpointTermSingular.toLowerCase()),1)]),c("div",vI,[h[9]||(h[9]=c("label",null,"End date & time (optional)",-1)),c("input",{value:e.form.endTime,onInput:h[4]||(h[4]=p=>a("endTime",p.target.value)),type:"datetime-local",class:"form-input"},null,40,mI),c("small",gI," When "+_(e.peopleTermPlural.toLowerCase())+" can leave this "+_(e.checkpointTermSingular.toLowerCase()),1)])])):R("",!0)],32)]))}},_I=Ye(yI,[["__scopeId","data-v-617deeb9"]]),kI={class:"scope-configuration-editor"},bI={class:"editor-header"},wI={class:"scope-types-list"},CI=["onClick"],LI={class:"scope-type-label"},SI={class:"scope-type-pill"},xI={class:"expand-label"},TI={class:"expand-icon"},II={class:"modal-content"},$I={class:"modal-header"},MI={class:"modal-body"},AI={class:"scope-help"},EI={key:0,class:"form-group"},PI={class:"checkbox-label special-option"},DI=["checked"],OI={key:0,class:"specific-selection"},RI=["placeholder"],BI={class:"checkbox-group scrollable"},NI=["checked","onChange"],FI={key:1,class:"form-group"},UI={class:"checkbox-label special-option"},zI=["checked"],HI={key:0,class:"specific-selection"},VI={class:"checkbox-group scrollable"},GI=["checked","onChange"],ZI={key:2,class:"form-group"},jI={class:"checkbox-label special-option"},WI=["checked"],qI={key:0,class:"specific-selection"},KI=["placeholder"],YI={class:"checkbox-group scrollable"},JI={key:0,class:"checkbox-label this-checkpoint-option"},XI=["checked"],QI={class:"checkpoint-info"},e$={class:"checkpoint-name"},t$=["checked","onChange"],n$={class:"checkpoint-info"},o$={class:"checkpoint-name"},s$={key:0,class:"checkpoint-description"},i$={__name:"ScopeConfigurationEditor",props:{modelValue:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},excludeScopes:{type:Array,default:()=>[]},headerText:{type:String,default:""},intent:{type:String,default:"completion",validator:e=>["completion","location-update"].includes(e)},currentCheckpointId:{type:String,default:null}},emits:["update:modelValue","user-changed"],setup(e,{emit:t}){const{termsLower:o}=Ct(),i=e,s=t,a=J(()=>[{scope:"SpecificPeople",label:`Specific ${o.value.people}`},{scope:"EveryoneAtCheckpoints",label:`Every ${o.value.person} at specified ${o.value.checkpoints}`},{scope:"OnePerCheckpoint",label:`One ${o.value.person} at each specified ${o.value.checkpoint}`},{scope:"OnePerArea",label:`One ${o.value.person} in specified ${o.value.areas}`},{scope:"EveryoneInAreas",label:`Everyone in specified ${o.value.areas}`},{scope:"EveryAreaLead",label:`Every ${o.value.area} lead at specified ${o.value.areas}`},{scope:"OneLeadPerArea",label:`One lead per specified ${o.value.area}`}]),l=P({SpecificPeople:{enabled:!0,ids:["ALL_MARSHALS"]},EveryoneInAreas:{enabled:!1,ids:[]},EveryoneAtCheckpoints:{enabled:!1,ids:[]},OnePerCheckpoint:{enabled:!1,ids:[]},OnePerArea:{enabled:!1,ids:[]},EveryAreaLead:{enabled:!1,ids:[]},OneLeadPerArea:{enabled:!1,ids:[]}}),u=P(null),h=P(""),p=P(""),f=P(!i.isEditing);let y=!0,k=!1;const I=J(()=>a.value.filter(q=>!i.excludeScopes.includes(q.scope))),M=J(()=>f.value?I.value:I.value.filter(q=>_e(q.scope))),b=J(()=>I.value.filter(fe=>_e(fe.scope)).length<I.value.length),B=J(()=>{const q=I.value.filter(fe=>_e(fe.scope)).length;return I.value.length-q}),E=J(()=>!i.currentCheckpointId&&i.intent==="location-update");qe(()=>i.modelValue,q=>{if(q){if(k){k=!1;return}y=!0,Object.keys(l.value).forEach(fe=>{l.value[fe]={enabled:!1,ids:[]}}),q.forEach(fe=>{fe.scope==="Everyone"?l.value.SpecificPeople={enabled:!0,ids:["ALL_MARSHALS"]}:fe.scope==="AreaLead"?l.value.EveryAreaLead={enabled:!0,ids:[...fe.ids]}:l.value[fe.scope]&&(l.value[fe.scope]={enabled:!0,ids:[...fe.ids]})}),y=!1}},{immediate:!0});const A=()=>{const q=[];return Object.keys(l.value).forEach(fe=>{const Le=l.value[fe];if(Le.enabled){const U={scope:fe,itemType:C(fe),ids:[...Le.ids]};q.push(U)}}),q};qe(l,()=>{if(y)return;if(Object.keys(l.value).some(Le=>Le!=="SpecificPeople"&&l.value[Le].enabled)&&l.value.SpecificPeople?.ids.includes("ALL_MARSHALS")){const Le=l.value.SpecificPeople.ids.indexOf("ALL_MARSHALS");l.value.SpecificPeople.ids.splice(Le,1),l.value.SpecificPeople.ids.length===0&&(l.value.SpecificPeople.enabled=!1)}k=!0;const fe=A();s("update:modelValue",fe),s("user-changed")},{deep:!0});const C=q=>x(q)?"Area":T(q)?"Checkpoint":S(q)?"Marshal":null,x=q=>q==="EveryoneInAreas"||q==="OnePerArea"||q==="EveryAreaLead"||q==="OneLeadPerArea",T=q=>q==="EveryoneAtCheckpoints"||q==="OnePerCheckpoint",S=q=>q==="SpecificPeople",$=q=>{const fe=a.value.find(Le=>Le.scope===q);return fe?fe.label:q},se=J(()=>i.headerText?i.headerText:i.intent==="location-update"?"Who can update this location?":"Who can see and complete this item?"),ce=q=>i.intent==="location-update"?{SpecificPeople:`Select "Everyone" or choose specific ${o.value.people} who can update the location`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} can update the location`,OnePerCheckpoint:`Any ${o.value.person} at each selected ${o.value.checkpoint} can update the location`,OnePerArea:`Any ${o.value.person} in each selected ${o.value.area} can update the location`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} can update the location`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} can update the location`,OneLeadPerArea:`Any ${o.value.area} lead at the selected ${o.value.areas} can update the location`}[q]||"":{SpecificPeople:`Select "Everyone at the event" or choose specific ${o.value.people} who must complete this (personal completion)`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} must complete this (personal completion)`,OnePerCheckpoint:`One completion needed at each selected ${o.value.checkpoint} (shared completion)`,OnePerArea:`One completion needed in each selected ${o.value.area} (shared completion)`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} must complete this (personal completion)`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} must complete this individually (personal completion)`,OneLeadPerArea:`One completion per ${o.value.area}, only ${o.value.area} leads can complete (shared among leads)`}[q]||"",_e=q=>l.value[q]?.enabled||!1,ae=q=>{const fe=l.value[q];if(!fe||!fe.enabled)return"No";const Le=fe.ids||[];if(x(q)){if(Le.includes("ALL_AREAS"))return`All ${o.value.areas}`;const U=Le.length;return U>0?`${U} ${U!==1?o.value.areas:o.value.area}`:`Select ${o.value.areas}...`}if(T(q)){if(Le.includes("ALL_CHECKPOINTS"))return`All ${o.value.checkpoints}`;if(Le.length===1&&Le[0]==="THIS_CHECKPOINT")return`This ${o.value.checkpoint}`;const U=Le.length;return U>0?`${U} ${U!==1?o.value.checkpoints:o.value.checkpoint}`:`Select ${o.value.checkpoints}...`}if(S(q)){if(Le.includes("ALL_MARSHALS"))return"Everyone";const U=Le.length;return U>0?`${U} ${U!==1?o.value.people:o.value.person}`:`Select ${o.value.people}...`}return"Configured"},pe=q=>{u.value=q,h.value="",p.value=""},Ie=()=>{u.value=null},Be=()=>{u.value&&(l.value[u.value]={enabled:!1,ids:[]}),Ie()},Se=()=>u.value&&l.value[u.value]?.ids.includes("ALL_MARSHALS"),he=()=>{if(!u.value)return;const q=l.value[u.value];Se()?(q.ids=[],q.enabled=!1):(q.ids=["ALL_MARSHALS"],q.enabled=!0)},Q=q=>u.value&&l.value[u.value]?.ids.includes(q),X=q=>{if(!u.value)return;const fe=l.value[u.value],Le=fe.ids.indexOf(q);Le>=0?(fe.ids.splice(Le,1),fe.ids.length===0&&(fe.enabled=!1)):(fe.ids.push(q),fe.enabled=!0)},ue=J(()=>{if(!p.value)return i.marshals;const q=p.value.toLowerCase();return i.marshals.filter(fe=>fe.name.toLowerCase().includes(q)||fe.email&&fe.email.toLowerCase().includes(q))}),te=()=>u.value&&l.value[u.value]?.ids.includes("ALL_AREAS"),be=()=>{if(!u.value)return;const q=l.value[u.value];te()?(q.ids=[],q.enabled=!1):(q.ids=["ALL_AREAS"],q.enabled=!0)},Oe=q=>u.value&&l.value[u.value]?.ids.includes(q),ne=q=>{if(!u.value)return;const fe=l.value[u.value],Le=fe.ids.indexOf(q);Le>=0?(fe.ids.splice(Le,1),fe.ids.length===0&&(fe.enabled=!1)):(fe.ids.push(q),fe.enabled=!0)},Ee=()=>u.value&&l.value[u.value]?.ids.includes("ALL_CHECKPOINTS"),xe=()=>{if(!u.value)return;const q=l.value[u.value];Ee()?(q.ids=[],q.enabled=!1):(q.ids=["ALL_CHECKPOINTS"],q.enabled=!0)},we=q=>u.value&&l.value[u.value]?.ids.includes(q),re=q=>{if(!u.value)return;const fe=l.value[u.value],Le=fe.ids.indexOf(q);Le>=0?(fe.ids.splice(Le,1),fe.ids.length===0&&(fe.enabled=!1)):(fe.ids.push(q),fe.enabled=!0)},ve=J(()=>{let q=i.locations;if(h.value){const fe=h.value.toLowerCase();q=q.filter(Le=>Le.name.toLowerCase().includes(fe)||Le.description&&Le.description.toLowerCase().includes(fe))}return[...q].sort((fe,Le)=>Cn(fe.name,Le.name))});return(q,fe)=>(m(),g("div",kI,[c("div",bI,[c("h4",null,_(se.value),1)]),c("div",wI,[(m(!0),g(Ce,null,Re(M.value,Le=>(m(),g("div",{key:Le.scope,class:Te(["scope-type-row",{active:_e(Le.scope)}]),onClick:U=>pe(Le.scope)},[c("div",LI,_(Le.label),1),c("div",SI,_(ae(Le.scope)),1)],10,CI))),128)),b.value?(m(),g("div",{key:0,class:"expand-row",onClick:fe[0]||(fe[0]=Le=>f.value=!f.value)},[c("div",xI,_(f.value?"Show less":`Show ${B.value} more option${B.value!==1?"s":""}...`),1),c("div",TI,_(f.value?"":""),1)])):R("",!0)]),u.value?(m(),g("div",{key:0,class:"scope-config-modal",onClick:vt(Ie,["self"])},[c("div",II,[c("div",$I,[c("h5",null,_($(u.value)),1),c("button",{onClick:Ie,class:"btn-close",type:"button"},"")]),c("div",MI,[c("p",AI,_(ce(u.value)),1),S(u.value)?(m(),g("div",EI,[c("label",PI,[c("input",{type:"checkbox",checked:Se(),onChange:he},null,40,DI),c("span",null,[fe[4]||(fe[4]=c("strong",null,"Everyone at the event",-1)),Ze(" (all current and future "+_(z(o).people)+")",1)])]),Se()?R("",!0):(m(),g("div",OI,[je(c("input",{"onUpdate:modelValue":fe[1]||(fe[1]=Le=>p.value=Le),type:"text",placeholder:`Search ${z(o).people}...`,class:"search-input"},null,8,RI),[[ht,p.value]]),c("div",BI,[(m(!0),g(Ce,null,Re(ue.value,Le=>(m(),g("label",{key:Le.id,class:"checkbox-label"},[c("input",{type:"checkbox",checked:Q(Le.id),onChange:U=>X(Le.id)},null,40,NI),c("span",null,_(Le.name),1)]))),128))])]))])):R("",!0),x(u.value)?(m(),g("div",FI,[c("label",UI,[c("input",{type:"checkbox",checked:te(),onChange:be},null,40,zI),c("span",null,[c("strong",null,"All "+_(z(o).areas),1),Ze(" (includes future "+_(z(o).areas)+")",1)])]),te()?R("",!0):(m(),g("div",HI,[c("div",VI,[(m(!0),g(Ce,null,Re(e.areas,Le=>(m(),g("label",{key:Le.id,class:"checkbox-label"},[c("input",{type:"checkbox",checked:Oe(Le.id),onChange:U=>ne(Le.id)},null,40,GI),c("span",{class:"area-color-dot",style:st({backgroundColor:Le.color||"#667eea"})},null,4),c("span",null,_(Le.name),1)]))),128))])]))])):R("",!0),T(u.value)?(m(),g("div",ZI,[c("label",jI,[c("input",{type:"checkbox",checked:Ee(),onChange:xe},null,40,WI),c("span",null,[c("strong",null,"All "+_(z(o).checkpoints),1),Ze(" (includes future "+_(z(o).checkpoints)+")",1)])]),Ee()?R("",!0):(m(),g("div",qI,[je(c("input",{"onUpdate:modelValue":fe[2]||(fe[2]=Le=>h.value=Le),type:"text",placeholder:`Search ${z(o).checkpoints}...`,class:"search-input"},null,8,KI),[[ht,h.value]]),c("div",YI,[E.value?(m(),g("label",JI,[c("input",{type:"checkbox",checked:we("THIS_CHECKPOINT"),onChange:fe[3]||(fe[3]=Le=>re("THIS_CHECKPOINT"))},null,40,XI),c("div",QI,[c("span",e$,[c("strong",null,"This "+_(z(o).checkpoint),1)])])])):R("",!0),(m(!0),g(Ce,null,Re(ve.value,Le=>(m(),g("label",{key:Le.id,class:"checkbox-label"},[c("input",{type:"checkbox",checked:we(Le.id),onChange:U=>re(Le.id)},null,40,t$),c("div",n$,[c("span",o$,_(Le.name),1),Le.description?(m(),g("span",s$," - "+_(Le.description),1)):R("",!0)])]))),128))])]))])):R("",!0)]),c("div",{class:"modal-footer"},[c("button",{onClick:Be,class:"btn btn-secondary",type:"button"},"Deselect all"),c("button",{onClick:Ie,class:"btn btn-primary",type:"button"},"Done")])])])):R("",!0)]))}},Sl=Ye(i$,[["__scopeId","data-v-97d31f0e"]]),a$={class:"tab-content"},r$={class:"form-group"},l$=["value"],c$={key:0,class:"form-error"},u$={class:"form-row"},d$={class:"form-group"},h$=["value","disabled"],f$={class:"form-group"},p$=["value","disabled"],v$={class:"form-group"},m$={class:"accordion-item"},g$={class:"accordion-preview"},y$={class:"accordion-arrow"},_$={key:0,class:"accordion-content"},k$={class:"section-description"},b$={class:"dynamic-checkbox"},w$=["checked"],C$={key:0,class:"dynamic-settings"},L$={__name:"LocationCoordinatesTab",props:{form:{type:Object,required:!0},isMoving:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:"Checkpoint"},peopleTermPlural:{type:String,default:"Marshals"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:form","input","save","move-location"],setup(e,{emit:t}){const o=e,i=t,s=P(!1),a=y=>y==null||y===""?"":Number(y).toFixed(6),l=(y,k)=>{i("update:form",{...o.form,[y]:k}),i("input")},u=(y,k)=>{i("update:form",{...o.form,[y]:Number(k)}),i("input")},h=y=>{if(y){const k=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],I=o.form.locationUpdateScopeConfigurations||[],M=I.length>0?I:k;i("update:form",{...o.form,isDynamic:!0,latitude:0,longitude:0,locationUpdateScopeConfigurations:M})}else i("update:form",{...o.form,isDynamic:!1});i("input")},p=y=>{i("update:form",{...o.form,locationUpdateScopeConfigurations:y}),i("input")},f=y=>{if(!y)return!0;const k=y.includes(".")?y.split("."):y.split("/");if(k.length!==3)return!1;const I=/^[a-z]{1,20}$/;return k.every(M=>I.test(M))};return(y,k)=>(m(),g("div",a$,[c("form",{onSubmit:k[4]||(k[4]=vt(I=>y.$emit("save"),["prevent"]))},[c("div",r$,[k[8]||(k[8]=c("label",null,"What3Words (optional)",-1)),c("input",{value:e.form.what3Words,onInput:k[0]||(k[0]=I=>l("what3Words",I.target.value)),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap"},null,40,l$),e.form.what3Words&&!f(e.form.what3Words)?(m(),g("small",c$," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):R("",!0)]),e.form.isDynamic?R("",!0):(m(),g(Ce,{key:0},[c("div",u$,[c("div",d$,[k[9]||(k[9]=c("label",null,"Longitude",-1)),c("input",{value:a(e.form.longitude),onInput:k[1]||(k[1]=I=>u("longitude",I.target.value)),type:"number",step:"0.000001",required:"",class:"form-input",disabled:e.isMoving,placeholder:"e.g., -0.091234"},null,40,h$)]),c("div",f$,[k[10]||(k[10]=c("label",null,"Latitude",-1)),c("input",{value:a(e.form.latitude),onInput:k[2]||(k[2]=I=>u("latitude",I.target.value)),type:"number",step:"0.000001",required:"",class:"form-input",disabled:e.isMoving,placeholder:"e.g., 51.505123"},null,40,p$)])]),c("div",v$,[c("button",{type:"button",onClick:k[3]||(k[3]=I=>y.$emit("move-location")),class:Te(["btn btn-secondary btn-with-icon",{"btn-primary":e.isMoving}])},[k[11]||(k[11]=c("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),Ze(" "+_(e.isMoving?"Click on map to set new location...":`Move ${e.checkpointTermSingular.toLowerCase()}...`),1)],2)])],64))],32),c("div",m$,[c("button",{type:"button",class:Te(["accordion-header",{expanded:s.value}]),onClick:k[5]||(k[5]=I=>s.value=!s.value)},[k[12]||(k[12]=Of('<div class="accordion-icon" data-v-b33d55cc><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-b33d55cc><path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="#F59E0B" opacity="0.3" data-v-b33d55cc></path><path d="M12 6L13.5 9L17 9.5L14.5 12L15 15.5L12 14L9 15.5L9.5 12L7 9.5L10.5 9L12 6Z" fill="#F59E0B" data-v-b33d55cc></path><circle cx="12" cy="11" r="2" fill="white" data-v-b33d55cc></circle></svg></div><span class="accordion-title" data-v-b33d55cc>Dynamic location</span>',2)),c("span",g$,_(e.form.isDynamic?"Enabled":"Disabled"),1),c("span",y$,_(s.value?"":""),1)],2),s.value?(m(),g("div",_$,[c("p",k$," Enable this for lead cars, sweep vehicles, or other moving "+_(e.checkpointTermSingular.toLowerCase())+"s whose location can be updated by designated "+_(e.peopleTermPlural.toLowerCase())+" during the event. ",1),c("label",b$,[c("input",{type:"checkbox",checked:e.form.isDynamic,onChange:k[6]||(k[6]=I=>h(I.target.checked))},null,40,w$),c("span",null,"This "+_(e.checkpointTermSingular.toLowerCase())+" can move",1)]),e.form.isDynamic?(m(),g("div",C$,[ze(Sl,{"model-value":e.form.locationUpdateScopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":e.isEditing,"header-text":`Who can update this ${e.checkpointTermSingular.toLowerCase()}'s location?`,"exclude-scopes":["OnePerCheckpoint","OneLeadPerArea","OnePerArea"],intent:"location-update","current-checkpoint-id":e.form.id,"onUpdate:modelValue":p,onUserChanged:k[7]||(k[7]=I=>y.$emit("input"))},null,8,["model-value","areas","locations","marshals","is-editing","header-text","current-checkpoint-id"])])):R("",!0)])):R("",!0)])]))}},S$=Ye(L$,[["__scopeId","data-v-b33d55cc"]]);function Gp(e){const t=P(new Map),o=f=>t.value.has(f.id)?t.value.get(f.id):f.isCheckedIn;return{pendingCheckInChanges:t,getEffectiveCheckInStatus:o,handleToggleCheckIn:f=>{const k=!o(f);k===f.isCheckedIn?t.value.delete(f.id):t.value.set(f.id,k),e&&e()},getStatusIcon:f=>o(f)?"":"",getStatusColor:f=>o(f)?"#28a745":"#dc3545",getStatusText:f=>o(f)?"Checked in":"Not checked in",formatTime:f=>f?new Date(f).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",clearPendingChanges:()=>{t.value.clear()},getPendingChanges:()=>Array.from(t.value.entries()).map(([f,y])=>({assignmentId:f,shouldBeCheckedIn:y}))}}const x$={class:"tab-content"},T$={class:"form-group"},I$=["value"],$$={class:"section-title"},M$={class:"assignments-list"},A$={class:"assignment-info"},E$={class:"assignment-header"},P$=["title"],D$={key:1,class:"status-indicator pending-indicator",title:"Will be assigned on save"},O$={key:2,class:"pending-badge"},R$={key:3,class:"pending-badge"},B$={key:0,class:"check-in-info"},N$={class:"check-in-method"},F$={class:"assignment-actions"},U$=["onClick"],z$=["onClick"],H$={class:"assign-section"},V$={__name:"LocationAssignmentsTab",props:{form:{type:Object,required:!0},assignments:{type:Array,default:()=>[]},peopleTerm:{type:String,default:"Marshals"},personTerm:{type:String,default:"Marshal"}},emits:["update:form","input","remove-assignment","open-assign-modal"],setup(e,{expose:t,emit:o}){const i=e,s=J(()=>i.peopleTerm.toLowerCase()),a=J(()=>i.personTerm.toLowerCase()),l=o,{pendingCheckInChanges:u,getEffectiveCheckInStatus:h,handleToggleCheckIn:p,getStatusIcon:f,getStatusColor:y,getStatusText:k,formatTime:I}=Gp(()=>l("input")),M=J(()=>i.assignments?.length||0),b=J(()=>i.assignments?[...i.assignments].sort((E,A)=>{const C=E.marshalName?.toLowerCase()||"",x=A.marshalName?.toLowerCase()||"";return C.localeCompare(x)}):[]),B=(E,A)=>{l("update:form",{...i.form,[E]:Number(A)}),l("input")};return t({pendingCheckInChanges:u,clearPendingChanges:()=>{u.value.clear()},getPendingChanges:()=>Array.from(u.value.entries()).map(([E,A])=>({assignmentId:E,shouldBeCheckedIn:A}))}),(E,A)=>(m(),g("div",x$,[c("div",T$,[c("label",null,"Required "+_(s.value),1),c("input",{value:e.form.requiredMarshals,onInput:A[0]||(A[0]=C=>B("requiredMarshals",C.target.value)),type:"number",min:"1",required:"",class:"form-input"},null,40,I$)]),c("h3",$$,"Assigned "+_(s.value)+" ("+_(M.value)+")",1),c("div",M$,[(m(!0),g(Ce,null,Re(b.value,C=>(m(),g("div",{key:C.id,class:Te(["assignment-item",{"checked-in":!C.isPending&&z(h)(C),"is-pending":C.isPending}])},[c("div",A$,[c("div",E$,[C.isPending?(m(),g("span",D$,"  ")):(m(),g("span",{key:0,class:"status-indicator",style:st({color:z(y)(C)}),title:z(k)(C)},_(z(f)(C)),13,P$)),c("strong",null,_(C.marshalName),1),C.isPending?(m(),g("span",O$," (will be assigned on save) ")):z(u).has(C.id)?(m(),g("span",R$," (unsaved) ")):R("",!0)]),!C.isPending&&z(h)(C)?(m(),g("span",B$,[C.isCheckedIn&&!z(u).has(C.id)?(m(),g(Ce,{key:0},[Ze(_(z(I)(C.checkInTime))+" ",1),c("span",N$,"("+_(C.checkInMethod)+")",1)],64)):(m(),g(Ce,{key:1},[Ze(" Will be checked in on save ")],64))])):R("",!0)]),c("div",F$,[C.isPending?R("",!0):(m(),g("button",{key:0,onClick:x=>z(p)(C),class:Te(["btn btn-small",z(h)(C)?"btn-danger":"btn-secondary"])},_(z(h)(C)?"Undo":"Check in"),11,U$)),c("button",{onClick:x=>E.$emit("remove-assignment",C),class:"btn btn-small btn-danger"}," Remove ",8,z$)])],2))),128)),c("div",H$,[c("button",{type:"button",class:"btn btn-primary assign-btn",onClick:A[1]||(A[1]=C=>E.$emit("open-assign-modal"))}," + Assign "+_(a.value)+"... ",1)])])]))}},G$=Ye(V$,[["__scopeId","data-v-cff2a7ac"]]),Z$={class:"checkpoint-checklist-view"},j$={key:0,class:"loading-state"},W$={key:1,class:"error-state"},q$={key:2,class:"empty-state"},K$={key:3,class:"empty-state"},Y$={key:4,class:"checklist-items"},J$={class:"item-checkbox"},X$=["checked","disabled","onChange"],Q$={class:"item-content"},eM={class:"item-header"},tM={class:"item-text-wrapper"},nM={class:"item-text"},oM={key:0,class:"item-context"},sM={class:"item-scope"},iM=["title"],aM={key:0,class:"completion-info"},rM={key:0,class:"pending-text"},lM={class:"completion-text"},cM={class:"completion-time"},uM={key:1,class:"uncomplete-info"},dM={key:2,class:"disabled-reason"},hM={__name:"CheckpointChecklistView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=Ct(),a=e,l=o,u=P([]),h=P(!1),p=P(null),f=P(new Map),y=J(()=>a.assignments.length===0),k=J(()=>u.value.map(T=>{const S=f.value.get(`${T.itemId}|||${T.completionContextId}`),$=S!==void 0?S.complete:T.isCompleted,se=S!==void 0&&S.complete!==T.isCompleted;return{...T,localIsCompleted:$,isModified:se}})),I=async()=>{if(!(!a.eventId||!a.locationId&&!a.areaId)){h.value=!0,p.value=null;try{const T=a.locationId?await Pt.getCheckpointChecklist(a.eventId,a.locationId):await Pt.getAreaChecklist(a.eventId,a.areaId);if(u.value=T.data||[],a.modelValue&&a.modelValue.length>0){const S=new Map;a.modelValue.forEach($=>{S.set(`${$.itemId}|||${$.contextId}`,{complete:$.complete,contextType:$.contextType,contextId:$.contextId})}),f.value=S}}catch(T){console.error("Failed to load checklist:",T),p.value=T.response?.data?.message||"Failed to load checklist"}finally{h.value=!1}}},M=T=>{const S=T.contextOwnerMarshalId||(a.assignments.length>0?a.assignments[0].marshalId:null);if(!S)return;const $=`${T.itemId}|||${T.completionContextId}`,se=f.value.get($),ce=se!==void 0?se.complete:T.isCompleted;f.value.set($,{complete:!ce,contextType:T.completionContextType,contextId:T.completionContextId,marshalId:S}),b()},b=()=>{const T=[];for(const[S,$]of f.value.entries()){const[se,ce]=S.split("|||"),_e=u.value.find(ae=>ae.itemId===se&&ae.completionContextId===ce);_e&&$.complete!==_e.isCompleted&&T.push({itemId:se,complete:$.complete,contextType:$.contextType,contextId:$.contextId,marshalId:$.marshalId})}l("update:modelValue",T),l("change",T)};t({resetLocalState:()=>{if(f.value=new Map,a.modelValue&&a.modelValue.length>0){const T=new Map;a.modelValue.forEach(S=>{T.set(`${S.itemId}|||${S.contextId}`,{complete:S.complete,contextType:S.contextType,contextId:S.contextId,marshalId:S.marshalId})}),f.value=T}},loadChecklist:I});const E=T=>({Everyone:"Everyone",SpecificPeople:"Assigned to you",EveryoneInAreas:`Your ${s.value.areas}`,EveryoneAtCheckpoints:`Your ${s.value.checkpoints}`,OnePerCheckpoint:`One per ${s.value.checkpoint}`,OnePerArea:`One per ${s.value.area}`,EveryAreaLead:`${i.value.area} lead`,OneLeadPerArea:`One lead per ${s.value.area}`})[T.matchedScope]||T.matchedScope,A=T=>({Everyone:"This item is for everyone at the event",SpecificPeople:"This item is specifically assigned to certain people",EveryoneInAreas:`This item is for everyone in certain ${s.value.areas}`,EveryoneAtCheckpoints:`This item is for everyone at certain ${s.value.checkpoints}`,OnePerCheckpoint:`One person at the ${s.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${s.value.area} needs to complete this`,EveryAreaLead:`This item is for ${s.value.area} leads only`,OneLeadPerArea:`One ${s.value.area} lead needs to complete this`})[T.matchedScope]||"",C=T=>{if(!T.completionContextType||!T.completionContextId)return null;if(T.completionContextType==="Checkpoint"){const S=a.locations.find(se=>se.id===T.completionContextId);if(!S)return null;const $=S.description?`${S.name} - ${S.description}`:S.name;return`at ${s.value.checkpoint} ${$}`}if(T.completionContextType==="Area"){const S=a.areas.find($=>$.id===T.completionContextId);return S?`in ${s.value.area} ${S.name}`:null}return T.completionContextType==="Personal"?T.contextOwnerName?`for ${T.contextOwnerName}`:"assigned individually":null},x=T=>T?new Date(T).toLocaleString():"";return qe(()=>[a.eventId,a.locationId,a.areaId],()=>{I()},{immediate:!0}),(T,S)=>(m(),g("div",Z$,[h.value?(m(),g("div",j$," Loading checklist... ")):p.value?(m(),g("div",W$,[c("p",null,_(p.value),1),c("button",{onClick:I,class:"btn btn-secondary btn-small"}," Retry ")])):y.value?(m(),g("div",q$,[...S[0]||(S[0]=[c("p",null,"No marshals assigned to this checkpoint yet.",-1),c("p",{class:"help-text"},"Assign marshals to enable checklist completion.",-1)])])):u.value.length===0?(m(),g("div",K$,[...S[1]||(S[1]=[c("p",null,"No checklist items for this checkpoint.",-1)])])):(m(),g("div",Y$,[(m(!0),g(Ce,null,Re(k.value,$=>(m(),g("div",{key:`${$.itemId}-${$.completionContextId}`,class:Te(["checklist-item",{"item-completed":$.localIsCompleted,"item-modified":$.isModified}])},[c("div",J$,[c("input",{type:"checkbox",checked:$.localIsCompleted,disabled:!$.canBeCompletedByMe&&!$.localIsCompleted,onChange:se=>M($)},null,40,X$)]),c("div",Q$,[c("div",eM,[c("div",tM,[c("div",nM,_($.text),1),C($)?(m(),g("div",oM,_(C($)),1)):R("",!0)]),c("div",sM,[c("span",{class:"scope-pill",title:A($)},_(E($)),9,iM)])]),$.localIsCompleted?(m(),g("div",aM,[$.isModified&&!$.isCompleted?(m(),g("span",rM," Will be marked as completed (pending save) ")):(m(),g(Ce,{key:1},[c("span",lM," Completed by "+_($.completedByActorName||"Unknown"),1),c("span",cM,_(x($.completedAt)),1)],64))])):R("",!0),$.isModified&&$.isCompleted&&!$.localIsCompleted?(m(),g("div",uM,[...S[2]||(S[2]=[c("span",{class:"pending-text"},"Will be marked as incomplete (pending save)",-1)])])):R("",!0),!$.canBeCompletedByMe&&!$.localIsCompleted?(m(),g("div",dM," Already completed by someone else ")):R("",!0)])],2))),128))]))]))}},Zp=Ye(hM,[["__scopeId","data-v-9dc97489"]]),fM={class:"notes-view"},pM={key:0,class:"loading-state"},vM={key:1,class:"error-state"},mM={key:2,class:"empty-state"},gM={key:3,class:"notes-list"},yM={class:"note-header"},_M={class:"note-title-row"},kM={key:0,class:"pin-icon",title:"Pinned"},bM={class:"note-title"},wM={class:"note-meta"},CM={key:0,class:"category-badge"},LM={key:0,class:"note-content"},SM={class:"note-footer"},xM={class:"created-info"},TM={key:0,class:"scope-info"},IM={__name:"NotesView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},marshalId:{type:String,default:null},allNotes:{type:Array,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},showScope:{type:Boolean,default:!0}},setup(e,{expose:t}){const o=e,i=P([]),s=P(!1),a=P(null),l=J(()=>o.marshalId?"No notes for this marshal.":o.areaId?"No notes for this area.":o.locationId?"No notes for this checkpoint.":"No notes available."),u=J(()=>o.areaId?o.locations.filter(E=>E.areaIds&&E.areaIds.includes(o.areaId)):[]),h=J(()=>u.value.map(E=>E.id)),p=J(()=>{if(!o.areaId)return[];const E=new Set;return o.assignments.filter(A=>h.value.includes(A.locationId)).forEach(A=>E.add(A.marshalId)),Array.from(E)}),f=E=>o.assignments.filter(A=>A.marshalId===E).map(A=>A.locationId),y=E=>{const A=f(E),C=new Set;for(const x of A){const T=o.locations.find(S=>S.id===x);T?.areaIds&&T.areaIds.forEach(S=>C.add(S))}return Array.from(C)},k=(E,A)=>{if(!E.scopeConfigurations)return null;for(const C of E.scopeConfigurations){if(C.itemType==="Area"){if(A.type==="area"&&(C.ids.includes(A.areaId)||C.ids.includes("ALL_AREAS")))return{matched:!0,scope:C.scope==="EveryAreaLead"?"Area leads":"Area"};if(A.type==="checkpoint"){const T=o.locations.find(S=>S.id===A.locationId)?.areaIds||[];if(C.ids.includes("ALL_AREAS")||T.some(S=>C.ids.includes(S)))return{matched:!0,scope:C.scope==="EveryAreaLead"?"Area leads":"Area"}}}if(C.itemType==="Checkpoint"){if(A.type==="checkpoint"&&(C.ids.includes(A.locationId)||C.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint"};if(A.type==="area"&&A.checkpointIds.some(T=>C.ids.includes(T)||C.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint in area"}}if(C.itemType==="Marshal"){if(A.type==="marshal"&&(C.ids.includes(A.marshalId)||C.ids.includes("ALL_MARSHALS")))return{matched:!0,scope:"Marshal"};if(A.type==="checkpoint"){const x=o.assignments.filter(S=>S.locationId===A.locationId).map(S=>S.marshalId);if(C.ids.includes("ALL_MARSHALS")||x.some(S=>C.ids.includes(S)))return{matched:!0,scope:"Marshal at checkpoint"}}if(A.type==="area"&&(C.ids.includes("ALL_MARSHALS")||A.marshalIds.some(T=>C.ids.includes(T))))return{matched:!0,scope:"Marshal in area"}}if(A.type==="marshal"&&A.checkpointIds&&A.areaIds){if(C.itemType==="Checkpoint"&&(C.ids.includes("ALL_CHECKPOINTS")||A.checkpointIds.some(T=>C.ids.includes(T))))return{matched:!0,scope:"Assigned checkpoint"};if(C.itemType==="Area"&&(C.ids.includes("ALL_AREAS")||A.areaIds.some(T=>C.ids.includes(T))))return{matched:!0,scope:C.scope==="EveryAreaLead"?"Area lead":"Area"}}}return null},I=J(()=>{const E=o.allNotes||i.value;if(!E||E.length===0)return[];if(o.areaId&&o.allNotes){const A={type:"area",areaId:o.areaId,checkpointIds:h.value,marshalIds:p.value},C=[],x=new Set;for(const T of E){if(x.has(T.noteId))continue;const S=k(T,A);S&&(x.add(T.noteId),C.push({...T,matchedScope:S.scope}))}return C}if(o.locationId&&o.allNotes){const A={type:"checkpoint",locationId:o.locationId},C=[],x=new Set;for(const T of E){if(x.has(T.noteId))continue;const S=k(T,A);S&&(x.add(T.noteId),C.push({...T,matchedScope:S.scope}))}return C}if(o.marshalId&&o.allNotes){const A=f(o.marshalId),C=y(o.marshalId),x={type:"marshal",marshalId:o.marshalId,checkpointIds:A,areaIds:C},T=[],S=new Set;for(const $ of E){if(S.has($.noteId))continue;const se=k($,x);se&&(S.add($.noteId),T.push({...$,matchedScope:se.scope}))}return T}return E}),M=J(()=>{const E={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return[...I.value].sort((A,C)=>{if(A.isPinned!==C.isPinned)return A.isPinned?-1:1;const x=E[A.priority]??2,T=E[C.priority]??2;return x!==T?x-T:A.displayOrder!==C.displayOrder?A.displayOrder-C.displayOrder:new Date(C.createdAt)-new Date(A.createdAt)})}),b=async()=>{if(o.allNotes===null&&o.eventId){s.value=!0,a.value=null;try{let E;o.marshalId?E=await Zo.getMarshalNotes(o.eventId,o.marshalId):E=await Zo.getByEvent(o.eventId),i.value=E.data||[]}catch(E){console.error("Failed to load notes:",E),a.value=E.response?.data?.message||"Failed to load notes"}finally{s.value=!1}}};qe(()=>[o.eventId,o.locationId,o.areaId,o.marshalId],()=>{o.allNotes===null&&b()},{immediate:!0});const B=E=>{if(!E)return"";const A=new Date(E),x=new Date-A,T=Math.floor(x/6e4),S=Math.floor(x/36e5),$=Math.floor(x/864e5);return T<1?"just now":T<60?`${T}m ago`:S<24?`${S}h ago`:$<7?`${$}d ago`:A.toLocaleDateString()};return t({loadNotes:b}),(E,A)=>(m(),g("div",fM,[s.value?(m(),g("div",pM," Loading notes... ")):a.value?(m(),g("div",vM,[c("p",null,_(a.value),1),c("button",{onClick:b,class:"btn btn-secondary btn-small"}," Retry ")])):I.value.length===0?(m(),g("div",mM,[c("p",null,_(l.value),1)])):(m(),g("div",gM,[(m(!0),g(Ce,null,Re(M.value,C=>(m(),g("div",{key:C.noteId,class:Te(["note-item",{pinned:C.isPinned}])},[c("div",yM,[c("div",_M,[C.isPinned?(m(),g("span",kM,"")):R("",!0),c("span",{class:Te(["priority-indicator",(C.priority||"Normal").toLowerCase()])},null,2),c("strong",bM,_(C.title),1)]),c("div",wM,[C.category?(m(),g("span",CM,_(C.category),1)):R("",!0),c("span",{class:Te(["priority-badge",(C.priority||"Normal").toLowerCase()])},_(C.priority||"Normal"),3)])]),C.content?(m(),g("div",LM,_(C.content),1)):R("",!0),c("div",SM,[c("span",xM," Created by "+_(C.createdByName||"Unknown")+"  "+_(B(C.createdAt)),1),C.matchedScope&&e.showScope?(m(),g("span",TM,_(C.matchedScope),1)):R("",!0)])],2))),128))]))]))}},xl=Ye(IM,[["__scopeId","data-v-6dd44fa8"]]),$M={class:"checklist-preview"},MM={class:"preview-actions"},AM={class:"preview-header"},EM={key:0,class:"add-item-form"},PM=["placeholder"],DM=["disabled"],OM={key:1,class:"pending-items"},RM={class:"item-content"},BM={class:"item-header"},NM={class:"item-text"},FM={class:"item-scope"},UM=["onClick"],zM={key:2,class:"empty-state"},HM={key:0,class:"help-text"},VM={key:3,class:"checklist-items"},GM={class:"item-content"},ZM={class:"item-header"},jM={class:"item-text"},WM={class:"item-scope"},qM=["title"],KM={key:0,class:"item-context"},YM={__name:"ChecklistPreviewForLocation",props:{allChecklistItems:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=e,a=J(()=>s.checkpointTermSingular?s.checkpointTermSingular.toLowerCase():i.value.checkpoint),l=t,u=P(!1),h=P(""),p=P([...s.modelValue]);qe(()=>s.modelValue,C=>{p.value=[...C]},{deep:!0});const f=()=>{h.value.trim()&&(p.value.push({text:h.value.trim(),isNew:!0}),h.value="",u.value=!1,k())},y=C=>{p.value.splice(C,1),k()},k=()=>{l("update:modelValue",[...p.value]),l("change")},I=C=>{const x=C.scope,T=C.itemType,S=C.ids||[];return(x==="EveryoneAtCheckpoints"||x==="OnePerCheckpoint")&&T==="Checkpoint"?S.includes("ALL_CHECKPOINTS"):x==="OnePerCheckpoint"&&T==="Area"?S.includes("ALL_AREAS")?!0:S.some($=>s.pendingAreaIds.includes($)):(x==="EveryoneInAreas"||x==="OnePerArea"||x==="EveryAreaLead"||x==="OneLeadPerArea")&&T==="Area"?S.includes("ALL_AREAS")?!0:S.some($=>s.pendingAreaIds.includes($)):!1},M=J(()=>s.allChecklistItems.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(x=>I(x)):!1)),b=C=>({EveryoneAtCheckpoints:`All at ${i.value.checkpoints}`,OnePerCheckpoint:`One per ${i.value.checkpoint}`,EveryoneInAreas:`All in ${i.value.areas}`,OnePerArea:`One per ${i.value.area}`,EveryAreaLead:`${i.value.area} leads`,OneLeadPerArea:`One lead per ${i.value.area}`})[C]||C,B=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const x=C.scopeConfigurations.find(S=>I(S));if(!x)return b(C.scopeConfigurations[0].scope);const T=x.ids||[];return T.includes("ALL_CHECKPOINTS")?`All ${i.value.checkpoints}`:T.includes("ALL_AREAS")?`All ${i.value.areas}`:b(x.scope)},E=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const x=C.scopeConfigurations.find(S=>I(S));return x&&{EveryoneAtCheckpoints:`This item is for everyone at specified ${i.value.checkpoints}`,OnePerCheckpoint:`One person at each ${i.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${i.value.areas}`,OnePerArea:`One person in each ${i.value.area} needs to complete this`,EveryAreaLead:`This item is for ${i.value.area} leads only`,OneLeadPerArea:`One ${i.value.area} lead needs to complete this`}[x.scope]||""},A=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const x=C.scopeConfigurations.find($=>I($));if(!x)return null;const T=x.itemType,S=x.ids||[];if(S.includes("ALL_CHECKPOINTS")||S.includes("ALL_AREAS"))return null;if(T==="Area"){const $=s.areas.filter(se=>S.includes(se.id)&&s.pendingAreaIds.includes(se.id)).map(se=>se.name);if($.length>0)return`In: ${$.join(", ")}`}return null};return(C,x)=>(m(),g("div",$M,[c("div",MM,[c("p",AM,_(e.isEditing?`Add new ${z(i).checklist} for this ${a.value}:`:`${z(o).checklists} that will apply at this ${a.value}:`),1),c("button",{type:"button",class:"add-item-btn",onClick:x[0]||(x[0]=T=>u.value=!u.value)},_(u.value?"Cancel":`+ Add ${z(i).checklist}`),1)]),u.value?(m(),g("div",EM,[je(c("input",{"onUpdate:modelValue":x[1]||(x[1]=T=>h.value=T),type:"text",placeholder:`Enter ${z(i).checklist} text...`,class:"add-item-input",onKeyup:Vf(f,["enter"])},null,40,PM),[[ht,h.value]]),c("button",{type:"button",class:"save-item-btn",disabled:!h.value.trim(),onClick:f}," Add ",8,DM)])):R("",!0),p.value.length>0?(m(),g("div",OM,[(m(!0),g(Ce,null,Re(p.value,(T,S)=>(m(),g("div",{key:`pending-${S}`,class:"checklist-item pending"},[x[3]||(x[3]=c("div",{class:"item-checkbox"},[c("input",{type:"checkbox",checked:!1,disabled:""})],-1)),c("div",RM,[c("div",BM,[c("div",NM,_(T.text),1),c("div",FM,[x[2]||(x[2]=c("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),c("button",{type:"button",class:"remove-item-btn",onClick:$=>y(S),title:"Remove"},"  ",8,UM)])])])]))),128))])):R("",!0),!e.isEditing&&M.value.length===0&&p.value.length===0?(m(),g("div",zM,[c("p",null,"No "+_(z(i).checklists)+" will apply based on the current "+_(z(i).area)+" assignments.",1),e.pendingAreaIds.length===0?(m(),g("p",HM," Assign "+_(z(i).areas)+" to see relevant "+_(z(i).checklists)+". ",1)):R("",!0)])):R("",!0),!e.isEditing&&M.value.length>0?(m(),g("div",VM,[(m(!0),g(Ce,null,Re(M.value,T=>(m(),g("div",{key:T.id,class:"checklist-item"},[x[4]||(x[4]=c("div",{class:"item-checkbox"},[c("input",{type:"checkbox",checked:!1,disabled:""})],-1)),c("div",GM,[c("div",ZM,[c("div",jM,_(T.text),1),c("div",WM,[c("span",{class:"scope-pill",title:E(T)},_(B(T)),9,qM)])]),A(T)?(m(),g("div",KM,_(A(T)),1)):R("",!0)])]))),128))])):R("",!0)]))}},JM=Ye(YM,[["__scopeId","data-v-c2119cba"]]),XM={class:"notes-preview"},QM={class:"preview-actions"},eA={class:"preview-header"},tA={key:0,class:"add-item-form"},nA={class:"add-form-fields"},oA=["disabled"],sA={key:1,class:"pending-items"},iA={class:"note-header"},aA={class:"note-title"},rA={class:"note-actions"},lA=["onClick"],cA={key:0,class:"note-content"},uA={key:2,class:"empty-state"},dA={key:0,class:"help-text"},hA={key:3,class:"notes-list"},fA={class:"note-header"},pA={class:"note-title"},vA=["title"],mA={key:0,class:"note-content"},gA={key:1,class:"note-context"},yA={__name:"NotesPreviewForLocation",props:{allNotes:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=Ct(),i=e,s=t,a=J(()=>i.checkpointTermSingular?i.checkpointTermSingular.toLowerCase():o.value.checkpoint),l=P(!1),u=P(""),h=P(""),p=P([...i.modelValue]);qe(()=>i.modelValue,C=>{p.value=[...C]},{deep:!0});const f=()=>{!u.value.trim()&&!h.value.trim()||(p.value.push({title:u.value.trim(),content:h.value.trim(),isNew:!0}),u.value="",h.value="",l.value=!1,k())},y=C=>{p.value.splice(C,1),k()},k=()=>{s("update:modelValue",[...p.value]),s("change")},I=C=>{const x=C.scope,T=C.itemType,S=C.ids||[];return x==="EveryoneAtCheckpoints"&&T==="Checkpoint"?S.includes("ALL_CHECKPOINTS"):x==="EveryoneInAreas"&&T==="Area"?S.includes("ALL_AREAS")?!0:S.some($=>i.pendingAreaIds.includes($)):!1},M=J(()=>i.allNotes.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(x=>I(x)):!1)),b=C=>({EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[C]||C,B=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const x=C.scopeConfigurations.find(S=>I(S));if(!x)return b(C.scopeConfigurations[0].scope);const T=x.ids||[];return T.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:T.includes("ALL_AREAS")?`All ${o.value.areas}`:b(x.scope)},E=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const x=C.scopeConfigurations.find(S=>I(S));return x&&{EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[x.scope]||""},A=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const x=C.scopeConfigurations.find($=>I($));if(!x)return null;const T=x.itemType,S=x.ids||[];if(S.includes("ALL_CHECKPOINTS")||S.includes("ALL_AREAS"))return null;if(T==="Area"){const $=i.areas.filter(se=>S.includes(se.id)&&i.pendingAreaIds.includes(se.id)).map(se=>se.name);if($.length>0)return`In: ${$.join(", ")}`}return null};return(C,x)=>(m(),g("div",XM,[c("div",QM,[c("p",eA,_(e.isEditing?`Add new note for this ${a.value}:`:`Notes that will be visible at this ${a.value}:`),1),c("button",{type:"button",class:"add-item-btn",onClick:x[0]||(x[0]=T=>l.value=!l.value)},_(l.value?"Cancel":"+ Add note"),1)]),l.value?(m(),g("div",tA,[c("div",nA,[je(c("input",{"onUpdate:modelValue":x[1]||(x[1]=T=>u.value=T),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[ht,u.value]]),je(c("textarea",{"onUpdate:modelValue":x[2]||(x[2]=T=>h.value=T),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[ht,h.value]])]),c("button",{type:"button",class:"save-item-btn",disabled:!u.value.trim()&&!h.value.trim(),onClick:f}," Add ",8,oA)])):R("",!0),p.value.length>0?(m(),g("div",sA,[(m(!0),g(Ce,null,Re(p.value,(T,S)=>(m(),g("div",{key:`pending-${S}`,class:"note-item pending"},[c("div",iA,[c("span",aA,_(T.title||"Untitled"),1),c("div",rA,[x[3]||(x[3]=c("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),c("button",{type:"button",class:"remove-item-btn",onClick:$=>y(S),title:"Remove"},"  ",8,lA)])]),T.content?(m(),g("div",cA,_(T.content),1)):R("",!0)]))),128))])):R("",!0),!e.isEditing&&M.value.length===0&&p.value.length===0?(m(),g("div",uA,[c("p",null,"No notes will apply based on the current "+_(z(o).area)+" assignments.",1),e.pendingAreaIds.length===0?(m(),g("p",dA," Assign "+_(z(o).areas)+" to see relevant notes. ",1)):R("",!0)])):R("",!0),!e.isEditing&&M.value.length>0?(m(),g("div",hA,[(m(!0),g(Ce,null,Re(M.value,T=>(m(),g("div",{key:T.id,class:"note-item"},[c("div",fA,[c("span",pA,_(T.title||"Untitled"),1),c("span",{class:"scope-pill",title:E(T)},_(B(T)),9,vA)]),T.content?(m(),g("div",mA,_(T.content),1)):R("",!0),A(T)?(m(),g("div",gA,_(A(T)),1)):R("",!0)]))),128))])):R("",!0)]))}},_A=Ye(yA,[["__scopeId","data-v-729a6eeb"]]),kA={class:"base-modal-title modal-title-with-icon"},bA=["innerHTML"],wA={key:7,class:"tab-content appearance-tab"},CA={class:"accordion-item"},LA=["innerHTML"],SA={class:"accordion-title"},xA={class:"accordion-arrow"},TA={key:0,class:"accordion-content"},IA={class:"section-description"},$A={class:"accordion-item"},MA={class:"accordion-preview"},AA={class:"accordion-arrow"},EA={key:0,class:"accordion-content"},PA={class:"section-description"},DA={class:"terminology-row"},OA={class:"terminology-field"},RA=["value"],BA={value:""},NA=["value"],FA={class:"terminology-field"},UA=["value"],zA={value:""},HA=["value"],VA={class:"custom-footer"},GA={key:1},_h="edit_location_accordion",ZA={__name:"EditLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:null},assignments:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventDate:{type:String,default:""},areas:{type:Array,default:()=>[]},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},availableMarshals:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},zIndex:{type:Number,default:1e3}},emits:["close","save","delete","move-location","toggle-check-in","remove-assignment","open-assign-modal","update:isDirty"],setup(e,{emit:t}){const{terms:o}=Ct(),i=e,s=t,a=P("details"),l=P(!1),u=P(null),h=P(null),p=P([]),f=P([]),y=P([]),k=P({id:null,name:"",description:"",what3Words:"",latitude:0,longitude:0,requiredMarshals:1,useCustomTimes:!1,startTime:"",endTime:"",areaIds:[],styleType:"default",styleColor:"",styleBackgroundShape:"",styleBackgroundColor:"",styleBorderColor:"",styleIconColor:"",styleSize:"",styleMapRotation:"",peopleTerm:"",checkpointTerm:"",isDynamic:!1,locationUpdateScopeConfigurations:[]}),I=()=>i.eventId?`${_h}_${i.eventId}`:_h,M=P({iconStyle:!1,terminology:!1});Qt(()=>{const Z=localStorage.getItem(I());if(Z)try{const N=JSON.parse(Z);M.value={...M.value,...N}}catch{}});const b=Z=>{M.value[Z]=!M.value[Z],localStorage.setItem(I(),JSON.stringify(M.value))},B=J(()=>{const Z=k.value.areaIds||[];if(Z.length>0){const N=i.areas.filter(O=>Z.includes(O.id)&&O.peopleTerm).sort((O,W)=>(O.checkpointCount||0)-(W.checkpointCount||0));if(N.length>0)return N[0].peopleTerm}return i.eventPeopleTerm||"Marshals"}),E=J(()=>k.value.peopleTerm?k.value.peopleTerm:B.value),A=J(()=>{const Z=k.value.areaIds||[];if(Z.length>0){const N=i.areas.filter(O=>Z.includes(O.id)&&O.checkpointTerm).sort((O,W)=>(O.checkpointCount||0)-(W.checkpointCount||0));if(N.length>0)return N[0].checkpointTerm}return o.value.checkpoint});J(()=>A.value.toLowerCase());const C=J(()=>{const Z=k.value.checkpointTerm||i.location?.checkpointTerm||i.location?.CheckpointTerm;if(Z)return Ys("checkpoint",Z,E.value);const N=k.value.areaIds||[];let O=null;if(N.length>0){const W=i.areas.filter(me=>N.includes(me.id)&&me.checkpointTerm).sort((me,$e)=>(me.checkpointCount||0)-($e.checkpointCount||0));W.length>0&&(O=W[0].checkpointTerm)}return O?Ys("checkpoint",O,E.value):o.value.checkpoint}),x=J(()=>C.value.toLowerCase()),T=J(()=>{const Z=E.value;return Ys("people",Z)});J(()=>T.value.toLowerCase());const S=J(()=>o.value.area);J(()=>S.value.toLowerCase());const $=J(()=>o.value.area),se=J(()=>$.value.toLowerCase()),ce=J(()=>o.value.areas),_e=J(()=>!!(i.location&&i.location.id)),ae=J(()=>_e.value?`Edit ${x.value}: ${i.location?.name||""}`:`Add ${x.value}`),pe=J(()=>[{value:"details",label:"Details",icon:"details"},{value:"location",label:"Location",icon:"location"},{value:"marshals",label:E.value,icon:"marshal"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}]),Ie=J(()=>pe.value.findIndex(Z=>Z.value===a.value)),Be=J(()=>Ie.value===pe.value.length-1),Se=J(()=>{const Z=k.value.areaIds||[],N=i.areas.filter(j=>Z.includes(j.id)).sort((j,Ve)=>(j.checkpointCount||0)-(Ve.checkpointCount||0)),O=(j,Ve)=>{for(const Xe of N){const nt=j(Xe);if(nt&&nt!=="default")return{value:nt,source:"area"}}return Ve&&Ve!=="default"?{value:Ve,source:"event"}:{value:"",source:"none"}},W=O(j=>j.checkpointStyleType||j.CheckpointStyleType,i.eventDefaultStyleType),me=O(j=>j.checkpointStyleColor||j.CheckpointStyleColor,i.eventDefaultStyleColor),$e=O(j=>j.checkpointStyleBackgroundShape||j.CheckpointStyleBackgroundShape,i.eventDefaultStyleBackgroundShape),ke=O(j=>j.checkpointStyleBackgroundColor||j.CheckpointStyleBackgroundColor||j.checkpointStyleColor||j.CheckpointStyleColor,i.eventDefaultStyleBackgroundColor||i.eventDefaultStyleColor),Ne=O(j=>j.checkpointStyleBorderColor||j.CheckpointStyleBorderColor,i.eventDefaultStyleBorderColor),Fe=O(j=>j.checkpointStyleIconColor||j.CheckpointStyleIconColor,i.eventDefaultStyleIconColor),Ue=O(j=>j.checkpointStyleSize||j.CheckpointStyleSize,i.eventDefaultStyleSize),We=O(j=>j.checkpointStyleMapRotation??j.CheckpointStyleMapRotation,i.eventDefaultStyleMapRotation),ee=[W,$e,ke,Ne,Fe,Ue,We].some(j=>j.source==="area");return{type:W.value||"default",color:me.value,backgroundShape:$e.value,backgroundColor:ke.value,borderColor:Ne.value,iconColor:Fe.value,size:Ue.value,mapRotation:We.value,source:ee?"area":W.value?"event":"none"}}),he=J(()=>Se.value.source==="area"?`${$.value} default`:"Event default"),Q=J(()=>{const Z=k.value.styleType&&k.value.styleType!=="default"&&k.value.styleType!=="custom"?k.value.styleType:Se.value.type,N=k.value.styleBackgroundShape||Se.value.backgroundShape||"circle",O=k.value.styleBackgroundColor||Se.value.backgroundColor||"#667eea",W=k.value.styleBorderColor||Se.value.borderColor||"#ffffff",me=k.value.styleIconColor||Se.value.iconColor||"#ffffff";return qt({type:Z||"circle",backgroundShape:N,backgroundColor:O,borderColor:W,iconColor:me,size:"100"})}),X=J(()=>{let Z,N,O,W,me;return _e.value&&i.location?(Z=i.location.resolvedStyleType||i.location.ResolvedStyleType,N=i.location.resolvedStyleBackgroundShape||i.location.ResolvedStyleBackgroundShape||"circle",O=i.location.resolvedStyleBackgroundColor||i.location.ResolvedStyleBackgroundColor||i.location.resolvedStyleColor||i.location.ResolvedStyleColor||"#667eea",W=i.location.resolvedStyleBorderColor||i.location.ResolvedStyleBorderColor||"#ffffff",me=i.location.resolvedStyleIconColor||i.location.ResolvedStyleIconColor||"#ffffff"):(Z=k.value.styleType&&k.value.styleType!=="default"&&k.value.styleType!=="custom"?k.value.styleType:Se.value.type,N=k.value.styleBackgroundShape||Se.value.backgroundShape||"circle",O=k.value.styleBackgroundColor||Se.value.backgroundColor||"#667eea",W=k.value.styleBorderColor||Se.value.borderColor||"#ffffff",me=k.value.styleIconColor||Se.value.iconColor||"#ffffff"),qt({type:Z||"circle",backgroundShape:N,backgroundColor:O,borderColor:W,iconColor:me,size:"100",outputSize:28})}),ue=J(()=>{const Z=!!k.value.checkpointTerm,N=!!k.value.peopleTerm;return Z&&N?`${Ys("checkpoint",k.value.checkpointTerm,k.value.peopleTerm)}, ${k.value.peopleTerm}`:Z?Ys("checkpoint",k.value.checkpointTerm,E.value):N?k.value.peopleTerm:"Using defaults"}),te=J(()=>Be.value?null:pe.value[Ie.value+1]),be=J(()=>Be.value?`Create ${x.value}`:`Add ${te.value.label.toLowerCase()}...`),Oe=P(!1),ne=P(null);qe(()=>i.location,Z=>{if(Z){const N=Z.id||"new";if(ne.value!==N){ne.value=N,Oe.value=!0;let O="",W="";Z.startTime&&(O=Ra(Z.startTime)),Z.endTime&&(W=Ra(Z.endTime)),k.value={id:Z.id||null,name:Z.name||"",description:Z.description||"",what3Words:Z.what3Words||"",latitude:Z.latitude||0,longitude:Z.longitude||0,requiredMarshals:Z.requiredMarshals||1,useCustomTimes:!!(Z.startTime||Z.endTime),startTime:O,endTime:W,areaIds:Z.areaIds||Z.AreaIds||[],styleType:Z.styleType||Z.StyleType||"default",styleColor:Z.styleColor||Z.StyleColor||"",styleBackgroundShape:Z.styleBackgroundShape||Z.StyleBackgroundShape||"",styleBackgroundColor:Z.styleBackgroundColor||Z.StyleBackgroundColor||"",styleBorderColor:Z.styleBorderColor||Z.StyleBorderColor||"",styleIconColor:Z.styleIconColor||Z.StyleIconColor||"",styleSize:Z.styleSize||Z.StyleSize||"",styleMapRotation:Z.styleMapRotation??Z.StyleMapRotation??"",peopleTerm:Z.peopleTerm||"",checkpointTerm:Z.checkpointTerm||"",isDynamic:Z.isDynamic||!1,locationUpdateScopeConfigurations:Z.locationUpdateScopeConfigurations||[]}}}},{immediate:!0,deep:!0}),qe(()=>i.show,Z=>{Z?(a.value="details",l.value=!1,p.value=[],f.value=[],y.value=[],u.value?.clearPendingChanges&&u.value.clearPendingChanges(),h.value?.resetLocalState&&h.value.resetLocalState()):(ne.value=null,Oe.value=!1)});const Ee=Z=>{k.value=Z},xe=()=>{s("update:isDirty",!0)},we=()=>{l.value=!l.value,s("move-location",{isMoving:l.value,formData:{...k.value}})},re=Z=>{p.value=Z,xe()},ve=()=>{_e.value||Be.value?q():a.value=te.value.value},q=()=>{const Z={...k.value,startTime:k.value.useCustomTimes&&k.value.startTime?new Date(k.value.startTime).toISOString():null,endTime:k.value.useCustomTimes&&k.value.endTime?new Date(k.value.endTime).toISOString():null,checkInChanges:u.value?.getPendingChanges?.()||[],checklistChanges:p.value||[],pendingAssignments:i.assignments.filter(N=>N.isPending).map(N=>({marshalId:N.marshalId})),pendingNewChecklistItems:f.value,pendingNewNotes:y.value};s("save",Z)},fe=()=>{i.location&&i.location.id&&s("delete",i.location.id)},Le=Z=>{s("remove-assignment",Z)},U=()=>{s("open-assign-modal")},H=()=>{s("close")},Y=(Z,N)=>{k.value[Z]=N,xe()};return(Z,N)=>(m(),ct(Ht,{show:e.show,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:H},{header:et(()=>[c("h2",kA,[X.value?(m(),g("span",{key:0,class:"modal-title-icon",innerHTML:X.value},null,8,bA)):R("",!0),Ze(" "+_(ae.value),1)])]),"tab-header":et(()=>[ze(vu,{modelValue:a.value,"onUpdate:modelValue":N[0]||(N[0]=O=>a.value=O),tabs:pe.value},null,8,["modelValue","tabs"])]),footer:et(()=>[c("div",VA,[_e.value?(m(),g("button",{key:0,type:"button",onClick:fe,class:"btn btn-danger"}," Delete "+_(x.value),1)):(m(),g("div",GA)),c("button",{type:"button",onClick:ve,class:"btn btn-primary"},_(_e.value?"Save changes":be.value),1)])]),default:et(()=>[a.value==="details"?(m(),ct(_I,{key:0,form:k.value,areas:e.areas,"event-date":e.eventDate,"area-term-singular":$.value,"area-term-plural":ce.value,"checkpoint-term-singular":C.value,"people-term-plural":E.value,"onUpdate:form":Ee,onInput:xe,onSave:q},null,8,["form","areas","event-date","area-term-singular","area-term-plural","checkpoint-term-singular","people-term-plural"])):R("",!0),a.value==="location"?(m(),ct(S$,{key:1,form:k.value,"is-moving":l.value,"checkpoint-term-singular":C.value,"people-term-plural":E.value,areas:e.areas,locations:e.allLocations,marshals:e.availableMarshals,"is-editing":_e.value,"onUpdate:form":Ee,onInput:xe,onSave:q,onMoveLocation:we},null,8,["form","is-moving","checkpoint-term-singular","people-term-plural","areas","locations","marshals","is-editing"])):R("",!0),a.value==="marshals"?(m(),ct(G$,{key:2,ref_key:"assignmentsTabRef",ref:u,form:k.value,assignments:e.assignments,"people-term":E.value,"person-term":T.value,"onUpdate:form":Ee,onInput:xe,onRemoveAssignment:Le,onOpenAssignModal:U},null,8,["form","assignments","people-term","person-term"])):R("",!0),a.value==="checklists"&&_e.value?(m(),ct(Zp,{key:3,ref_key:"checklistTabRef",ref:h,modelValue:p.value,"onUpdate:modelValue":N[1]||(N[1]=O=>p.value=O),"event-id":e.eventId,"location-id":e.location.id,locations:e.allLocations,areas:e.areas,assignments:e.assignments,onChange:re},null,8,["modelValue","event-id","location-id","locations","areas","assignments"])):R("",!0),a.value==="checklists"?(m(),ct(JM,{key:4,modelValue:f.value,"onUpdate:modelValue":N[2]||(N[2]=O=>f.value=O),"all-checklist-items":e.allChecklistItems,"pending-area-ids":k.value.areaIds,areas:e.areas,"is-editing":_e.value,"checkpoint-term-singular":C.value,onChange:xe},null,8,["modelValue","all-checklist-items","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):R("",!0),a.value==="notes"&&_e.value?(m(),ct(xl,{key:5,"event-id":e.eventId,"location-id":e.location?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","location-id","all-notes","locations","areas","assignments"])):R("",!0),a.value==="notes"?(m(),ct(_A,{key:6,modelValue:y.value,"onUpdate:modelValue":N[3]||(N[3]=O=>y.value=O),"all-notes":e.notes,"pending-area-ids":k.value.areaIds,areas:e.areas,"is-editing":_e.value,"checkpoint-term-singular":C.value,onChange:xe},null,8,["modelValue","all-notes","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):R("",!0),a.value==="appearance"?(m(),g("div",wA,[c("div",CA,[c("button",{type:"button",class:Te(["accordion-header",{expanded:M.value.iconStyle}]),onClick:N[4]||(N[4]=O=>b("iconStyle"))},[c("div",{class:"accordion-icon",innerHTML:Q.value},null,8,LA),c("span",SA,_(C.value)+" marker style",1),c("span",xA,_(M.value.iconStyle?"":""),1)],2),M.value.iconStyle?(m(),g("div",TA,[c("p",IA," Choose a custom icon for this "+_(x.value)+", or leave as Default to inherit from "+_(se.value)+" or event settings. ",1),ze(pu,{"style-type":k.value.styleType||"default","style-color":k.value.styleColor||"","style-background-shape":k.value.styleBackgroundShape||"","style-background-color":k.value.styleBackgroundColor||"","style-border-color":k.value.styleBorderColor||"","style-icon-color":k.value.styleIconColor||"","style-size":k.value.styleSize||"","style-map-rotation":k.value.styleMapRotation??"","inherited-style-type":Se.value.type,"inherited-style-color":Se.value.color,"inherited-background-shape":Se.value.backgroundShape||"","inherited-background-color":Se.value.backgroundColor||Se.value.color||"","inherited-border-color":Se.value.borderColor||"","inherited-icon-color":Se.value.iconColor||"","inherited-size":Se.value.size||"","inherited-map-rotation":Se.value.mapRotation??"","default-label":he.value,"icon-label":"Marker style",level:"checkpoint","show-preview":!0,"onUpdate:styleType":N[5]||(N[5]=O=>Y("styleType",O)),"onUpdate:styleColor":N[6]||(N[6]=O=>Y("styleColor",O)),"onUpdate:styleBackgroundShape":N[7]||(N[7]=O=>Y("styleBackgroundShape",O)),"onUpdate:styleBackgroundColor":N[8]||(N[8]=O=>Y("styleBackgroundColor",O)),"onUpdate:styleBorderColor":N[9]||(N[9]=O=>Y("styleBorderColor",O)),"onUpdate:styleIconColor":N[10]||(N[10]=O=>Y("styleIconColor",O)),"onUpdate:styleSize":N[11]||(N[11]=O=>Y("styleSize",O)),"onUpdate:styleMapRotation":N[12]||(N[12]=O=>Y("styleMapRotation",O))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation","default-label"])])):R("",!0)]),c("div",$A,[c("button",{type:"button",class:Te(["accordion-header",{expanded:M.value.terminology}]),onClick:N[13]||(N[13]=O=>b("terminology"))},[N[16]||(N[16]=c("div",{class:"accordion-icon"},[c("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[c("circle",{cx:"9",cy:"8",r:"3",fill:"#6366F1"}),c("path",{d:"M3 18c0-3.3 2.7-6 6-6s6 2.7 6 6",fill:"#6366F1",opacity:"0.5"}),c("circle",{cx:"17",cy:"14",r:"5",fill:"#10B981",opacity:"0.3"}),c("circle",{cx:"17",cy:"14",r:"3",fill:"#10B981"}),c("circle",{cx:"17",cy:"14",r:"1",fill:"white"})])],-1)),N[17]||(N[17]=c("span",{class:"accordion-title"},"Terminology",-1)),c("span",MA,_(ue.value),1),c("span",AA,_(M.value.terminology?"":""),1)],2),M.value.terminology?(m(),g("div",EA,[c("p",PA," Customise what this "+_(x.value)+" and its "+_(E.value.toLowerCase())+" are called. ",1),c("div",DA,[c("div",OA,[c("label",null,"What is this "+_(x.value)+" called?",1),c("select",{value:k.value.checkpointTerm,class:"form-input",onChange:N[14]||(N[14]=O=>{Ee({...k.value,checkpointTerm:O.target.value}),xe()})},[c("option",BA,"Use "+_(se.value)+" default ("+_(C.value)+")",1),N[18]||(N[18]=c("option",{value:"Vehicle"},"Vehicle",-1)),N[19]||(N[19]=c("option",{value:"Car"},"Car",-1)),N[20]||(N[20]=c("option",{value:"Bike"},"Bike",-1)),(m(!0),g(Ce,null,Re(z(Ko).checkpoint,O=>(m(),g("option",{key:O,value:O},_(O),9,NA))),128))],40,RA)]),c("div",FA,[c("label",null,"What are "+_(E.value.toLowerCase())+" called here?",1),c("select",{value:k.value.peopleTerm,class:"form-input",onChange:N[15]||(N[15]=O=>{Ee({...k.value,peopleTerm:O.target.value}),xe()})},[c("option",zA,"Use "+_(se.value)+" default ("+_(B.value)+")",1),(m(!0),g(Ce,null,Re(z(Ko).people,O=>(m(),g("option",{key:O,value:O},_(O),9,HA))),128))],40,UA)])])])):R("",!0)])])):R("",!0)]),_:1},8,["show","is-dirty","z-index"]))}},jA=Ye(ZA,[["__scopeId","data-v-90735dd4"]]),WA={class:"tab-content"},qA={class:"form-group"},KA=["value"],YA={class:"form-group"},JA=["value"],XA={class:"form-group"},QA=["value"],eE={class:"form-group"},tE=["value"],nE={key:0,class:"magic-link-section"},oE={key:0,class:"loading-text"},sE={key:1,class:"magic-link-container"},iE={class:"magic-link-row"},aE=["value"],rE={key:0,class:"magic-link-actions"},lE=["disabled"],cE={key:1,class:"success-text"},uE={key:2,class:"error-text"},dE={key:2,class:"error-text"},hE={__name:"MarshalDetailsTab",props:{form:{type:Object,required:!0},eventId:{type:String,default:null},marshalId:{type:String,default:null}},emits:["update:form","input"],setup(e,{emit:t}){const o=e,i=t,s=P(""),a=P(!1),l=P(!1),u=P(""),h=P(!1),p=P(!1),f=P(!1),y=P(""),k=(B,E)=>{i("update:form",{...o.form,[B]:E}),i("input")},I=async()=>{if(!(!o.eventId||!o.marshalId)){l.value=!0,u.value="";try{const B=await So.getMagicLink(o.eventId,o.marshalId);s.value=B.data.magicLink,a.value=B.data.hasEmail}catch(B){console.error("Failed to fetch magic link:",B),u.value="Failed to load login link"}finally{l.value=!1}}},M=async()=>{try{await navigator.clipboard.writeText(s.value),h.value=!0,setTimeout(()=>{h.value=!1},2e3)}catch(B){console.error("Failed to copy:",B)}},b=async()=>{if(!(!o.eventId||!o.marshalId)){p.value=!0,f.value=!1,y.value="";try{await So.sendMagicLink(o.eventId,o.marshalId),f.value=!0,setTimeout(()=>{f.value=!1},3e3)}catch(B){console.error("Failed to send email:",B),y.value=B.response?.data?.message||"Failed to send email"}finally{p.value=!1}}};return qe(()=>o.marshalId,B=>{B?I():(s.value="",a.value=!1)},{immediate:!0}),(B,E)=>(m(),g("div",WA,[c("div",qA,[E[5]||(E[5]=c("label",null,"Name *",-1)),c("input",{value:e.form.name,onInput:E[0]||(E[0]=A=>k("name",A.target.value)),type:"text",required:"",class:"form-input"},null,40,KA)]),c("div",YA,[E[6]||(E[6]=c("label",null,"Email",-1)),c("input",{value:e.form.email,onInput:E[1]||(E[1]=A=>k("email",A.target.value)),type:"email",class:"form-input"},null,40,JA)]),c("div",XA,[E[7]||(E[7]=c("label",null,"Phone number",-1)),c("input",{value:e.form.phoneNumber,onInput:E[2]||(E[2]=A=>k("phoneNumber",A.target.value)),type:"tel",class:"form-input"},null,40,QA)]),c("div",eE,[E[8]||(E[8]=c("label",null,"Notes",-1)),c("textarea",{value:e.form.notes,onInput:E[3]||(E[3]=A=>k("notes",A.target.value)),class:"form-input",rows:"3",placeholder:"e.g., Needs to leave by 11am"},null,40,tE)]),e.marshalId?(m(),g("div",nE,[E[9]||(E[9]=c("label",null,"Login link",-1)),E[10]||(E[10]=c("p",{class:"help-text"},"Share this unique link with the marshal so they can access their dashboard.",-1)),l.value?(m(),g("div",oE,"Loading link...")):s.value?(m(),g("div",sE,[c("div",iE,[c("input",{type:"text",value:s.value,readonly:"",class:"form-input magic-link-input",onFocus:E[4]||(E[4]=A=>A.target.select())},null,40,aE),c("button",{type:"button",class:"btn btn-secondary",onClick:M},_(h.value?"Copied!":"Copy link"),1)]),a.value?(m(),g("div",rE,[c("button",{type:"button",class:"btn btn-primary",disabled:p.value,onClick:b},_(p.value?"Sending...":"Send via email"),9,lE)])):R("",!0),f.value?(m(),g("p",cE,"Email sent successfully!")):R("",!0),y.value?(m(),g("p",uE,_(y.value),1)):R("",!0)])):u.value?(m(),g("div",dE,_(u.value),1)):R("",!0)])):R("",!0)]))}},fE=Ye(hE,[["__scopeId","data-v-fbbb0e01"]]),pE={class:"tab-content"},vE={class:"section-title"},mE={class:"assignments-list"},gE={class:"assignment-info"},yE={class:"assignment-header"},_E=["title"],kE={key:1,class:"status-indicator pending-indicator",title:"Will be assigned on save"},bE={key:2,class:"pending-badge"},wE={key:3,class:"pending-badge"},CE={key:0,class:"check-in-info"},LE={class:"check-in-method"},SE={class:"assignment-actions"},xE=["onClick"],TE=["onClick"],IE={key:0,class:"form-group",style:{"margin-top":"1.5rem"}},$E={value:""},ME=["value"],AE={__name:"MarshalCheckpointsTab",props:{assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},isNewMarshal:{type:Boolean,default:!1}},emits:["input","remove-assignment","assign-to-location"],setup(e,{expose:t,emit:o}){const{termsLower:i}=Ct(),s=e,a=o,{pendingCheckInChanges:l,getEffectiveCheckInStatus:u,handleToggleCheckIn:h,getStatusIcon:p,getStatusColor:f,getStatusText:y,formatTime:k}=Gp(()=>a("input")),I=P(""),M=J(()=>s.assignments?.length||0),b=J(()=>{const E=[...s.availableLocations];return E.sort((A,C)=>A.name.localeCompare(C.name,void 0,{numeric:!0,sensitivity:"base"})),E}),B=()=>{I.value&&(a("assign-to-location",I.value),I.value="")};return t({pendingCheckInChanges:l,clearPendingChanges:()=>{l.value.clear(),I.value=""},getPendingChanges:()=>Array.from(l.value.entries()).map(([E,A])=>({assignmentId:E,shouldBeCheckedIn:A}))}),(E,A)=>(m(),g("div",pE,[c("h3",vE,"Assigned "+_(z(i).checkpoints)+" ("+_(M.value)+")",1),c("div",mE,[(m(!0),g(Ce,null,Re(e.assignments,C=>(m(),g("div",{key:C.id,class:Te(["assignment-item",{"checked-in":!C.isPending&&z(u)(C),"is-pending":C.isPending}])},[c("div",gE,[c("div",yE,[C.isPending?(m(),g("span",kE,"  ")):(m(),g("span",{key:0,class:"status-indicator",style:st({color:z(f)(C)}),title:z(y)(C)},_(z(p)(C)),13,_E)),c("strong",null,_(C.locationName),1),C.isPending?(m(),g("span",bE," (will be assigned on save) ")):z(l).has(C.id)?(m(),g("span",wE," (unsaved) ")):R("",!0)]),!C.isPending&&z(u)(C)?(m(),g("span",CE,[C.isCheckedIn&&!z(l).has(C.id)?(m(),g(Ce,{key:0},[Ze(_(z(k)(C.checkInTime))+" ",1),c("span",LE,"("+_(C.checkInMethod)+")",1)],64)):(m(),g(Ce,{key:1},[Ze(" Will be checked in on save ")],64))])):R("",!0)]),c("div",SE,[C.isPending?R("",!0):(m(),g("button",{key:0,onClick:x=>z(h)(C),class:Te(["btn btn-small",z(u)(C)?"btn-danger":"btn-secondary"])},_(z(u)(C)?"Undo":"Check in"),11,xE)),c("button",{onClick:x=>E.$emit("remove-assignment",C),class:"btn btn-small btn-danger"}," Remove ",8,TE)])],2))),128)),b.value.length>0?(m(),g("div",IE,[c("label",null,"Assign to "+_(z(i).checkpoint),1),je(c("select",{"onUpdate:modelValue":A[0]||(A[0]=C=>I.value=C),class:"form-input",onChange:B},[c("option",$E,"Select a "+_(z(i).checkpoint)+"...",1),(m(!0),g(Ce,null,Re(b.value,C=>(m(),g("option",{key:C.id,value:C.id},[Ze(_(C.name),1),C.description?(m(),g(Ce,{key:0},[Ze(" - "+_(C.description),1)],64)):R("",!0)],8,ME))),128))],544),[[bn,I.value]])])):R("",!0)])]))}},EE=Ye(AE,[["__scopeId","data-v-ac2d3b20"]]),PE={class:"marshal-checklist-view"},DE={key:0,class:"loading-state"},OE={key:1,class:"error-state"},RE={key:2,class:"empty-state"},BE={key:3,class:"checklist-items"},NE={class:"item-checkbox"},FE=["checked","disabled","onChange"],UE={class:"item-content"},zE={class:"item-header"},HE={class:"item-text-wrapper"},VE={class:"item-text"},GE={key:0,class:"item-context"},ZE={class:"item-scope"},jE=["title"],WE={key:0,class:"completion-info"},qE={key:0,class:"pending-text"},KE={class:"completion-text"},YE={class:"completion-time"},JE={key:1,class:"uncomplete-info"},XE={key:2,class:"disabled-reason"},QE={__name:"MarshalChecklistView",props:{eventId:{type:String,required:!0},marshalId:{type:String,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=Ct(),a=e,l=o,u=P([]),h=P(!1),p=P(null),f=P(new Map),y=J(()=>u.value.map(T=>{const S=f.value.get(T.itemId),$=S!==void 0?S.complete:T.isCompleted,se=S!==void 0&&S.complete!==T.isCompleted;return{...T,localIsCompleted:$,isModified:se}})),k=async()=>{if(!(!a.eventId||!a.marshalId)){h.value=!0,p.value=null;try{const T=await Pt.getMarshalChecklist(a.eventId,a.marshalId);if(u.value=T.data||[],a.modelValue&&a.modelValue.length>0){const S=new Map;a.modelValue.forEach($=>{S.set($.itemId,{complete:$.complete,contextType:$.contextType,contextId:$.contextId})}),f.value=S}}catch(T){console.error("Failed to load checklist:",T),p.value=T.response?.data?.message||"Failed to load checklist"}finally{h.value=!1}}},I=T=>{const S=f.value.get(T.itemId),$=S!==void 0?S.complete:T.isCompleted;f.value.set(T.itemId,{complete:!$,contextType:T.completionContextType,contextId:T.completionContextId}),M()},M=()=>{const T=[];for(const[S,$]of f.value.entries()){const se=u.value.find(ce=>ce.itemId===S);se&&$.complete!==se.isCompleted&&T.push({itemId:S,complete:$.complete,contextType:$.contextType,contextId:$.contextId})}l("update:modelValue",T),l("change",T)};t({resetLocalState:()=>{if(f.value=new Map,a.modelValue&&a.modelValue.length>0){const T=new Map;a.modelValue.forEach(S=>{T.set(S.itemId,{complete:S.complete,contextType:S.contextType,contextId:S.contextId})}),f.value=T}},loadChecklist:k});const B=T=>({Everyone:"Everyone",SpecificPeople:"Assigned to you",EveryoneInAreas:`Your ${s.value.areas}`,EveryoneAtCheckpoints:`Your ${s.value.checkpoints}`,OnePerCheckpoint:`One per ${s.value.checkpoint}`,OnePerArea:`One per ${s.value.area}`,EveryAreaLead:`${i.value.area} lead`,OneLeadPerArea:`One lead per ${s.value.area}`})[T.matchedScope]||T.matchedScope,E=T=>({Everyone:"This item is for everyone at the event",SpecificPeople:"This item is specifically assigned to this person",EveryoneInAreas:`This item is for everyone in certain ${s.value.areas}`,EveryoneAtCheckpoints:`This item is for everyone at certain ${s.value.checkpoints}`,OnePerCheckpoint:`One person at the ${s.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${s.value.area} needs to complete this`,EveryAreaLead:`This item is for ${s.value.area} leads only`,OneLeadPerArea:`One ${s.value.area} lead needs to complete this`})[T.matchedScope]||"",A=T=>T.completionContextType==="Checkpoint"||T.completionContextType==="Area"?"Already completed by someone else":"Cannot be completed",C=T=>{if(!T.completionContextType||!T.completionContextId)return null;if(T.completionContextType==="Checkpoint"){const S=a.locations.find(se=>se.id===T.completionContextId);if(!S)return null;const $=S.description?`${S.name} - ${S.description}`:S.name;return`at ${s.value.checkpoint} ${$}`}if(T.completionContextType==="Area"){const S=a.areas.find($=>$.id===T.completionContextId);return S?`in ${s.value.area} ${S.name}`:null}return T.completionContextType==="Personal"?T.contextOwnerName?`for ${T.contextOwnerName}`:"assigned individually":null},x=T=>T?new Date(T).toLocaleString():"";return qe(()=>[a.eventId,a.marshalId],()=>{k()},{immediate:!0}),(T,S)=>(m(),g("div",PE,[h.value?(m(),g("div",DE," Loading checklist... ")):p.value?(m(),g("div",OE,[c("p",null,_(p.value),1),c("button",{onClick:k,class:"btn btn-secondary btn-small"}," Retry ")])):u.value.length===0?(m(),g("div",RE,[...S[0]||(S[0]=[c("p",null,"No checklist items for this person.",-1)])])):(m(),g("div",BE,[(m(!0),g(Ce,null,Re(y.value,$=>(m(),g("div",{key:`${$.itemId}_${$.completionContextType}_${$.completionContextId}`,class:Te(["checklist-item",{"item-completed":$.localIsCompleted,"item-modified":$.isModified}])},[c("div",NE,[c("input",{type:"checkbox",checked:$.localIsCompleted,disabled:!$.canBeCompletedByMe,onChange:se=>I($)},null,40,FE)]),c("div",UE,[c("div",zE,[c("div",HE,[c("div",VE,_($.text),1),C($)?(m(),g("div",GE,_(C($)),1)):R("",!0)]),c("div",ZE,[c("span",{class:"scope-pill",title:E($)},_(B($)),9,jE)])]),$.localIsCompleted?(m(),g("div",WE,[$.isModified&&!$.isCompleted?(m(),g("span",qE," Will be marked as completed (pending save) ")):(m(),g(Ce,{key:1},[c("span",KE," Completed by "+_($.completedByActorName||"Unknown"),1),c("span",YE,_(x($.completedAt)),1)],64))])):R("",!0),$.isModified&&$.isCompleted&&!$.localIsCompleted?(m(),g("div",JE,[...S[1]||(S[1]=[c("span",{class:"pending-text"},"Will be marked as incomplete (pending save)",-1)])])):R("",!0),!$.canBeCompletedByMe&&!$.localIsCompleted?(m(),g("div",XE,_(A($)),1)):R("",!0)])],2))),128))]))]))}},eP=Ye(QE,[["__scopeId","data-v-25f2e028"]]),tP={class:"checklist-preview"},nP={class:"preview-actions"},oP={class:"preview-header"},sP={key:0,class:"add-item-form"},iP=["placeholder"],aP=["disabled"],rP={key:1,class:"pending-items"},lP={class:"item-content"},cP={class:"item-header"},uP={class:"item-text"},dP={class:"item-scope"},hP=["onClick"],fP={key:2,class:"empty-state"},pP={key:0,class:"help-text"},vP={key:3,class:"checklist-items"},mP={class:"item-content"},gP={class:"item-header"},yP={class:"item-text"},_P={class:"item-scope"},kP=["title"],bP={key:0,class:"item-context"},wP={__name:"ChecklistPreview",props:{allChecklistItems:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=Ct(),i=e,s=t,a=P(!1),l=P(""),u=P([...i.modelValue]);qe(()=>i.modelValue,A=>{u.value=[...A]},{deep:!0});const h=()=>{l.value.trim()&&(u.value.push({text:l.value.trim(),isNew:!0}),l.value="",a.value=!1,f())},p=A=>{u.value.splice(A,1),f()},f=()=>{s("update:modelValue",[...u.value]),s("change")},y=J(()=>{const A=new Set;for(const C of i.pendingLocationIds){const x=i.allLocations.find(T=>T.id===C);x&&(x.areaIds||x.AreaIds||[]).forEach(S=>A.add(S))}return[...A]}),k=A=>{const C=A.scope,x=A.itemType,T=A.ids||[];return C==="SpecificPeople"&&x==="Marshal"?T.includes("ALL_MARSHALS"):(C==="EveryoneAtCheckpoints"||C==="OnePerCheckpoint")&&x==="Checkpoint"?T.includes("ALL_CHECKPOINTS")?!0:T.some(S=>i.pendingLocationIds.includes(S)):C==="OnePerCheckpoint"&&x==="Area"?T.includes("ALL_AREAS")?!0:T.some(S=>y.value.includes(S)):(C==="EveryoneInAreas"||C==="OnePerArea"||C==="EveryAreaLead"||C==="OneLeadPerArea")&&x==="Area"?T.includes("ALL_AREAS")?!0:T.some(S=>y.value.includes(S)):!1},I=J(()=>i.allChecklistItems.filter(A=>A.scopeConfigurations&&A.scopeConfigurations.length>0?A.scopeConfigurations.some(C=>k(C)):!1)),M=A=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,EveryoneInAreas:`All in ${o.value.areas}`,OnePerArea:`One per ${o.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${o.value.area}`})[A]||A,b=A=>{if(!A.scopeConfigurations||A.scopeConfigurations.length===0)return"Unknown";const C=A.scopeConfigurations.find(T=>k(T));if(!C)return M(A.scopeConfigurations[0].scope);const x=C.ids||[];return x.includes("ALL_MARSHALS")?"Everyone":x.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:x.includes("ALL_AREAS")?`All ${o.value.areas}`:M(C.scope)},B=A=>{if(!A.scopeConfigurations||A.scopeConfigurations.length===0)return"";const C=A.scopeConfigurations.find(T=>k(T));return C&&{SpecificPeople:"This item is for everyone at the event",EveryoneAtCheckpoints:`This item is for everyone at specified ${o.value.checkpoints}`,OnePerCheckpoint:`One person at each ${o.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${o.value.areas}`,OnePerArea:`One person in each ${o.value.area} needs to complete this`,EveryAreaLead:`This item is for ${o.value.area} leads only`,OneLeadPerArea:`One ${o.value.area} lead needs to complete this`}[C.scope]||""},E=A=>{if(!A.scopeConfigurations||A.scopeConfigurations.length===0)return null;const C=A.scopeConfigurations.find(S=>k(S));if(!C)return null;const x=C.itemType,T=C.ids||[];if(T.includes("ALL_MARSHALS")||T.includes("ALL_CHECKPOINTS")||T.includes("ALL_AREAS"))return null;if(x==="Checkpoint"){const S=i.allLocations.filter($=>T.includes($.id)&&i.pendingLocationIds.includes($.id)).map($=>$.name);if(S.length>0)return`At: ${S.join(", ")}`}if(x==="Area"){const S=i.areas.filter($=>T.includes($.id)&&y.value.includes($.id)).map($=>$.name);if(S.length>0)return`In: ${S.join(", ")}`}return null};return(A,C)=>(m(),g("div",tP,[c("div",nP,[c("p",oP,_(e.isEditing?`Add new ${z(o).checklist} for this ${z(o).person}:`:`${z(o).checklists} that will apply to this ${z(o).person}:`),1),c("button",{type:"button",class:"add-item-btn",onClick:C[0]||(C[0]=x=>a.value=!a.value)},_(a.value?"Cancel":`+ Add ${z(o).checklist}`),1)]),a.value?(m(),g("div",sP,[je(c("input",{"onUpdate:modelValue":C[1]||(C[1]=x=>l.value=x),type:"text",placeholder:`Enter ${z(o).checklist} text...`,class:"add-item-input",onKeyup:Vf(h,["enter"])},null,40,iP),[[ht,l.value]]),c("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim(),onClick:h}," Add ",8,aP)])):R("",!0),u.value.length>0?(m(),g("div",rP,[(m(!0),g(Ce,null,Re(u.value,(x,T)=>(m(),g("div",{key:`pending-${T}`,class:"checklist-item pending"},[C[3]||(C[3]=c("div",{class:"item-checkbox"},[c("input",{type:"checkbox",checked:!1,disabled:""})],-1)),c("div",lP,[c("div",cP,[c("div",uP,_(x.text),1),c("div",dP,[C[2]||(C[2]=c("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),c("button",{type:"button",class:"remove-item-btn",onClick:S=>p(T),title:"Remove"},"  ",8,hP)])])])]))),128))])):R("",!0),!e.isEditing&&I.value.length===0&&u.value.length===0?(m(),g("div",fP,[c("p",null,"No "+_(z(o).checklists)+" will apply based on the current "+_(z(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(m(),g("p",pP," Assign "+_(z(o).checkpoints)+" to see relevant "+_(z(o).checklists)+". ",1)):R("",!0)])):R("",!0),!e.isEditing&&I.value.length>0?(m(),g("div",vP,[(m(!0),g(Ce,null,Re(I.value,x=>(m(),g("div",{key:x.id,class:"checklist-item"},[C[4]||(C[4]=c("div",{class:"item-checkbox"},[c("input",{type:"checkbox",checked:!1,disabled:""})],-1)),c("div",mP,[c("div",gP,[c("div",yP,_(x.text),1),c("div",_P,[c("span",{class:"scope-pill",title:B(x)},_(b(x)),9,kP)])]),E(x)?(m(),g("div",bP,_(E(x)),1)):R("",!0)])]))),128))])):R("",!0)]))}},CP=Ye(wP,[["__scopeId","data-v-1c92d629"]]),LP={class:"notes-preview"},SP={class:"preview-actions"},xP={class:"preview-header"},TP={key:0,class:"add-item-form"},IP={class:"add-form-fields"},$P=["disabled"],MP={key:1,class:"pending-items"},AP={class:"note-header"},EP={class:"note-title"},PP={class:"note-actions"},DP=["onClick"],OP={key:0,class:"note-content"},RP={key:2,class:"empty-state"},BP={key:0,class:"help-text"},NP={key:3,class:"notes-list"},FP={class:"note-header"},UP={class:"note-title"},zP=["title"],HP={key:0,class:"note-content"},VP={key:1,class:"note-context"},GP={__name:"NotesPreview",props:{allNotes:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=Ct(),i=e,s=t,a=P(!1),l=P(""),u=P(""),h=P([...i.modelValue]);qe(()=>i.modelValue,C=>{h.value=[...C]},{deep:!0});const p=()=>{!l.value.trim()&&!u.value.trim()||(h.value.push({title:l.value.trim(),content:u.value.trim(),isNew:!0}),l.value="",u.value="",a.value=!1,y())},f=C=>{h.value.splice(C,1),y()},y=()=>{s("update:modelValue",[...h.value]),s("change")},k=J(()=>{const C=new Set;for(const x of i.pendingLocationIds){const T=i.allLocations.find(S=>S.id===x);T&&(T.areaIds||T.AreaIds||[]).forEach($=>C.add($))}return[...C]}),I=C=>{const x=C.scope,T=C.itemType,S=C.ids||[];return x==="SpecificPeople"&&T==="Marshal"?S.includes("ALL_MARSHALS"):x==="EveryoneAtCheckpoints"&&T==="Checkpoint"?S.includes("ALL_CHECKPOINTS")?!0:S.some($=>i.pendingLocationIds.includes($)):x==="EveryoneInAreas"&&T==="Area"?S.includes("ALL_AREAS")?!0:S.some($=>k.value.includes($)):!1},M=J(()=>i.allNotes.filter(C=>C.scopeConfigurations&&C.scopeConfigurations.length>0?C.scopeConfigurations.some(x=>I(x)):!1)),b=C=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[C]||C,B=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"Unknown";const x=C.scopeConfigurations.find(S=>I(S));if(!x)return b(C.scopeConfigurations[0].scope);const T=x.ids||[];return T.includes("ALL_MARSHALS")?"Everyone":T.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:T.includes("ALL_AREAS")?`All ${o.value.areas}`:b(x.scope)},E=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return"";const x=C.scopeConfigurations.find(S=>I(S));return x&&{SpecificPeople:"This note is for everyone at the event",EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[x.scope]||""},A=C=>{if(!C.scopeConfigurations||C.scopeConfigurations.length===0)return null;const x=C.scopeConfigurations.find($=>I($));if(!x)return null;const T=x.itemType,S=x.ids||[];if(S.includes("ALL_MARSHALS")||S.includes("ALL_CHECKPOINTS")||S.includes("ALL_AREAS"))return null;if(T==="Checkpoint"){const $=i.allLocations.filter(se=>S.includes(se.id)&&i.pendingLocationIds.includes(se.id)).map(se=>se.name);if($.length>0)return`At: ${$.join(", ")}`}if(T==="Area"){const $=i.areas.filter(se=>S.includes(se.id)&&k.value.includes(se.id)).map(se=>se.name);if($.length>0)return`In: ${$.join(", ")}`}return null};return(C,x)=>(m(),g("div",LP,[c("div",SP,[c("p",xP,_(e.isEditing?`Add new note for this ${z(o).person}:`:`Notes that will be visible to this ${z(o).person}:`),1),c("button",{type:"button",class:"add-item-btn",onClick:x[0]||(x[0]=T=>a.value=!a.value)},_(a.value?"Cancel":"+ Add note"),1)]),a.value?(m(),g("div",TP,[c("div",IP,[je(c("input",{"onUpdate:modelValue":x[1]||(x[1]=T=>l.value=T),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[ht,l.value]]),je(c("textarea",{"onUpdate:modelValue":x[2]||(x[2]=T=>u.value=T),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[ht,u.value]])]),c("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim()&&!u.value.trim(),onClick:p}," Add ",8,$P)])):R("",!0),h.value.length>0?(m(),g("div",MP,[(m(!0),g(Ce,null,Re(h.value,(T,S)=>(m(),g("div",{key:`pending-${S}`,class:"note-item pending"},[c("div",AP,[c("span",EP,_(T.title||"Untitled"),1),c("div",PP,[x[3]||(x[3]=c("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),c("button",{type:"button",class:"remove-item-btn",onClick:$=>f(S),title:"Remove"},"  ",8,DP)])]),T.content?(m(),g("div",OP,_(T.content),1)):R("",!0)]))),128))])):R("",!0),!e.isEditing&&M.value.length===0&&h.value.length===0?(m(),g("div",RP,[c("p",null,"No notes will be visible based on the current "+_(z(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(m(),g("p",BP," Assign "+_(z(o).checkpoints)+" to see relevant notes. ",1)):R("",!0)])):R("",!0),!e.isEditing&&M.value.length>0?(m(),g("div",NP,[(m(!0),g(Ce,null,Re(M.value,T=>(m(),g("div",{key:T.id,class:"note-item"},[c("div",FP,[c("span",UP,_(T.title||"Untitled"),1),c("span",{class:"scope-pill",title:E(T)},_(B(T)),9,zP)]),T.content?(m(),g("div",HP,_(T.content),1)):R("",!0),A(T)?(m(),g("div",VP,_(A(T)),1)):R("",!0)]))),128))])):R("",!0)]))}},ZP=Ye(GP,[["__scopeId","data-v-dc8ac5e7"]]),jP={class:"custom-footer"},WP={key:1},qP={__name:"EditMarshalModal",props:{show:{type:Boolean,default:!1},marshal:{type:Object,default:null},eventId:{type:String,required:!0},assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1},eventNotes:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]}},emits:["close","save","delete","toggle-check-in","remove-assignment","assign-to-location","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=e,a=t,l=P("details"),u=P(null),h=P(null),p=P([]),f=P([]),y=P([]),k=P([]),I=P({name:"",email:"",phoneNumber:"",notes:""}),M=J(()=>{const he=s.isEditing?`Edit ${i.value.person}`:`Create ${i.value.person}`,Q=I.value.name?.trim();return Q?`${he} - ${Q}`:he}),b=J(()=>[{value:"details",label:"Details",icon:"details"},{value:"checkpoints",label:o.value.checkpoints,icon:"checkpoint"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}]),B=J(()=>b.value.findIndex(he=>he.value===l.value)),E=J(()=>B.value===b.value.length-1),A=J(()=>E.value?null:b.value[B.value+1]),C=J(()=>E.value?`Create ${i.value.person}`:`Add ${A.value.label.toLowerCase()}...`),x=J(()=>f.value.map(he=>he.locationId)),T=J(()=>s.isEditing?s.assignments:f.value.map(he=>({id:`pending-${he.locationId}`,locationId:he.locationId,locationName:s.allLocations.find(Q=>Q.id===he.locationId)?.name||"Unknown",isPending:!0}))),S=J(()=>{if(s.isEditing)return s.availableLocations;const he=f.value.map(Q=>Q.locationId);return s.allLocations.filter(Q=>!he.includes(Q.id))});qe(()=>s.marshal,he=>{he?I.value={name:he.name||"",email:he.email||"",phoneNumber:he.phoneNumber||"",notes:he.notes||""}:I.value={name:"",email:"",phoneNumber:"",notes:""}},{immediate:!0,deep:!0}),qe(()=>s.show,he=>{he&&(l.value="details",p.value=[],f.value=[],y.value=[],k.value=[],s.isEditing||(I.value={name:"",email:"",phoneNumber:"",notes:""}),u.value?.clearPendingChanges&&u.value.clearPendingChanges(),h.value?.resetLocalState&&h.value.resetLocalState())});const $=he=>{I.value=he},se=()=>{a("update:isDirty",!0)},ce=()=>{a("update:isDirty",!0)},_e=()=>{s.isEditing||E.value?ae():l.value=A.value.value},ae=()=>{const he={...I.value,checkInChanges:u.value?.getPendingChanges?.()||[],checklistChanges:p.value||[],pendingAssignments:s.isEditing?[]:f.value,pendingNewChecklistItems:y.value,pendingNewNotes:k.value};a("save",he)},pe=()=>{a("delete")},Ie=he=>{!s.isEditing&&he.isPending?f.value=f.value.filter(Q=>Q.locationId!==he.locationId):a("remove-assignment",he)},Be=he=>{s.isEditing?a("assign-to-location",he):(f.value.push({locationId:he}),a("update:isDirty",!0))},Se=()=>{a("close")};return(he,Q)=>(m(),ct(Ht,{show:e.show,title:M.value,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:Se},{"tab-header":et(()=>[ze(vu,{modelValue:l.value,"onUpdate:modelValue":Q[0]||(Q[0]=X=>l.value=X),tabs:b.value},null,8,["modelValue","tabs"])]),footer:et(()=>[c("div",jP,[e.isEditing?(m(),g("button",{key:0,type:"button",onClick:pe,class:"btn btn-danger"}," Delete "+_(z(i).person),1)):(m(),g("div",WP)),c("button",{type:"button",onClick:_e,class:"btn btn-primary"},_(e.isEditing?"Save changes":C.value),1)])]),default:et(()=>[l.value==="details"?(m(),ct(fE,{key:0,form:I.value,"event-id":e.eventId,"marshal-id":e.isEditing?e.marshal?.id:null,"onUpdate:form":$,onInput:se},null,8,["form","event-id","marshal-id"])):R("",!0),l.value==="checkpoints"?(m(),ct(EE,{key:1,ref_key:"checkpointsTabRef",ref:u,assignments:T.value,"available-locations":S.value,"is-new-marshal":!e.isEditing,onInput:se,onRemoveAssignment:Ie,onAssignToLocation:Be},null,8,["assignments","available-locations","is-new-marshal"])):R("",!0),l.value==="checklists"&&e.isEditing?(m(),ct(eP,{key:2,ref_key:"checklistTabRef",ref:h,modelValue:p.value,"onUpdate:modelValue":Q[1]||(Q[1]=X=>p.value=X),"event-id":e.eventId,"marshal-id":e.marshal.id,locations:e.allLocations,areas:e.areas,onChange:ce},null,8,["modelValue","event-id","marshal-id","locations","areas"])):R("",!0),l.value==="checklists"?(m(),ct(CP,{key:3,modelValue:y.value,"onUpdate:modelValue":Q[2]||(Q[2]=X=>y.value=X),"all-checklist-items":e.allChecklistItems,"pending-location-ids":x.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:se},null,8,["modelValue","all-checklist-items","pending-location-ids","all-locations","areas","is-editing"])):R("",!0),l.value==="notes"&&e.isEditing?(m(),ct(xl,{key:4,"event-id":e.eventId,"marshal-id":e.marshal?.id,"all-notes":e.eventNotes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","marshal-id","all-notes","locations","areas","assignments"])):R("",!0),l.value==="notes"?(m(),ct(ZP,{key:5,modelValue:k.value,"onUpdate:modelValue":Q[3]||(Q[3]=X=>k.value=X),"all-notes":e.eventNotes,"pending-location-ids":x.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:se},null,8,["modelValue","all-notes","pending-location-ids","all-locations","areas","is-editing"])):R("",!0)]),_:1},8,["show","title","is-dirty"]))}},KP=Ye(qP,[["__scopeId","data-v-84f3c0d3"]]),YP={class:"locations-list"},JP={class:"conflict-actions"},XP={__name:"AssignmentConflictModal",props:{show:{type:Boolean,default:!1},conflictData:{type:Object,default:()=>({marshalName:"",locations:[]})}},emits:["close","choice"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=t,a=u=>{s("choice",u)},l=()=>{s("close")};return(u,h)=>(m(),ct(Ht,{show:e.show,title:`${z(o).person} already assigned`,size:"medium","z-index":1100,onClose:l},{actions:et(()=>[c("div",JP,[c("button",{onClick:h[0]||(h[0]=p=>a("move")),class:"btn btn-primary btn-full"}," Move to this "+_(z(i).checkpoint)+" (remove from others) ",1),c("button",{onClick:h[1]||(h[1]=p=>a("both")),class:"btn btn-secondary btn-full"}," Assign to both (keep existing assignments) "),c("button",{onClick:h[2]||(h[2]=p=>a("choose-other")),class:"btn btn-secondary btn-full"}," Choose someone else "),c("button",{onClick:h[3]||(h[3]=p=>a("cancel")),class:"btn btn-secondary btn-full"}," Cancel ")])]),default:et(()=>[c("p",null,[c("strong",null,_(e.conflictData.marshalName),1),h[4]||(h[4]=Ze(" is currently assigned to: ",-1))]),c("ul",YP,[(m(!0),g(Ce,null,Re(e.conflictData.locations,p=>(m(),g("li",{key:p},_(p),1))),128))]),h[5]||(h[5]=c("p",null,"What would you like to do?",-1))]),_:1},8,["show","title"]))}},QP=Ye(XP,[["__scopeId","data-v-b64e5b37"]]),e4={key:0,class:"assign-marshal-section"},t4={value:""},n4=["value"],o4=["disabled"],s4={key:1,class:"assign-marshal-section create-mode"},i4={class:"form-group"},a4={class:"form-group"},r4={class:"form-group"},l4={__name:"AssignMarshalModal",props:{show:{type:Boolean,default:!1},locationName:{type:String,default:""},marshals:{type:Array,default:()=>[]}},emits:["close","assign-existing","create-and-assign"],setup(e,{emit:t}){const{termsLower:o}=Ct(),i=e,s=t,a=P(!1),l=P(""),u=P({name:"",email:"",phoneNumber:""});qe(()=>i.show,I=>{I||(a.value=!1,l.value="",u.value={name:"",email:"",phoneNumber:""})});const h=()=>{a.value=!0},p=()=>{l.value&&s("assign-existing",l.value)},f=()=>{u.value.name&&s("create-and-assign",{...u.value})},y=()=>{a.value=!1,u.value={name:"",email:"",phoneNumber:""}},k=()=>{s("close")};return(I,M)=>(m(),ct(Ht,{show:e.show,title:a.value?`Create new ${z(o).person}`:`Assign ${z(o).person} to ${e.locationName}`,size:"medium",onClose:k},{actions:et(()=>[a.value?(m(),g(Ce,{key:0},[c("button",{onClick:y,class:"btn btn-secondary"}," Cancel "),c("button",{onClick:f,class:"btn btn-primary"}," Create & assign ")],64)):R("",!0)]),default:et(()=>[a.value?(m(),g("div",s4,[c("h3",null,"Create new "+_(z(o).person),1),c("div",i4,[M[5]||(M[5]=c("label",null,"Name *",-1)),je(c("input",{"onUpdate:modelValue":M[1]||(M[1]=b=>u.value.name=b),type:"text",required:"",class:"form-input"},null,512),[[ht,u.value.name]])]),c("div",a4,[M[6]||(M[6]=c("label",null,"Email",-1)),je(c("input",{"onUpdate:modelValue":M[2]||(M[2]=b=>u.value.email=b),type:"email",class:"form-input"},null,512),[[ht,u.value.email]])]),c("div",r4,[M[7]||(M[7]=c("label",null,"Phone",-1)),je(c("input",{"onUpdate:modelValue":M[3]||(M[3]=b=>u.value.phoneNumber=b),type:"tel",class:"form-input"},null,512),[[ht,u.value.phoneNumber]])])])):(m(),g("div",e4,[c("h3",null,"Select existing "+_(z(o).person),1),je(c("select",{"onUpdate:modelValue":M[0]||(M[0]=b=>l.value=b),class:"form-input"},[c("option",t4,"Choose a "+_(z(o).person)+"...",1),(m(!0),g(Ce,null,Re(e.marshals,b=>(m(),g("option",{key:b.id,value:b.id},[Ze(_(b.name)+" ",1),b.assignedLocationIds&&b.assignedLocationIds.length>0?(m(),g(Ce,{key:0},[Ze(" (assigned to "+_(b.assignedLocationIds.length)+" "+_(b.assignedLocationIds.length>1?z(o).checkpoints:z(o).checkpoint)+") ",1)],64)):R("",!0)],8,n4))),128))],512),[[bn,l.value]]),c("button",{onClick:p,class:"btn btn-primary btn-full",style:{"margin-top":"1rem"},disabled:!l.value}," Assign selected "+_(z(o).person),9,o4),M[4]||(M[4]=c("div",{class:"divider"},"OR",-1)),c("button",{onClick:h,class:"btn btn-secondary btn-full"}," Create new "+_(z(o).person),1)]))]),_:1},8,["show","title"]))}},c4=Ye(l4,[["__scopeId","data-v-f95e76a2"]]),u4={class:"shift-times-content"},d4={class:"info-text"},h4={class:"time-delta-info"},f4={class:"delta-detail"},p4={class:"delta-detail"},v4={class:"delta-summary"},m4={class:"affected-checkpoints"},g4={class:"option-selection"},y4={class:"radio-option"},_4={class:"radio-option"},k4={__name:"ShiftCheckpointTimesModal",props:{show:{type:Boolean,default:!1},oldEventDate:{type:String,required:!0},newEventDate:{type:String,required:!0},affectedCheckpointsCount:{type:Number,default:0}},emits:["confirm","cancel"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=e,a=t,l=P("shift"),u=J(()=>{const k=new Date(s.oldEventDate);return new Date(s.newEventDate)-k}),h=k=>new Date(k).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),p=k=>{const I=Math.abs(k),M=k>=0?"+":"-",b=Math.floor(I/(1e3*60*60*24)),B=Math.floor(I%(1e3*60*60*24)/(1e3*60*60)),E=Math.floor(I%(1e3*60*60)/(1e3*60)),A=[];return b>0&&A.push(`${b}d`),B>0&&A.push(`${B}h`),E>0&&A.push(`${E}m`),`${M}${A.join(" ")}`},f=()=>{a("confirm",{shouldShift:l.value==="shift",timeDelta:u.value})},y=()=>{a("cancel")};return(k,I)=>(m(),ct(Ht,{show:e.show,title:`Shift ${z(o).checkpoint} Times?`,size:"medium",onClose:y},{actions:et(()=>[c("button",{type:"button",onClick:y,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:f,class:"btn btn-primary"},_(l.value==="shift"?"Shift Times":"Keep Times"),1)]),default:et(()=>[c("div",u4,[c("p",d4," You've changed the event date/time. Some "+_(z(i).checkpoints)+" have custom times set. ",1),c("div",h4,[I[2]||(I[2]=c("strong",null,"Event time change:",-1)),c("div",f4," Old: "+_(h(e.oldEventDate)),1),c("div",p4," New: "+_(h(e.newEventDate)),1),c("div",v4," Delta: "+_(p(u.value)),1)]),c("p",m4,[c("strong",null,_(e.affectedCheckpointsCount)+" "+_(e.affectedCheckpointsCount===1?z(i).checkpoint:z(i).checkpoints),1),I[3]||(I[3]=Ze(" with custom times will be shifted by the same amount. ",-1))]),c("div",g4,[c("label",y4,[je(c("input",{"onUpdate:modelValue":I[0]||(I[0]=M=>l.value=M),type:"radio",value:"shift",name:"shift-option"},null,512),[[xd,l.value]]),c("div",null,[c("strong",null,"Shift all "+_(z(i).checkpoint)+" times",1),I[4]||(I[4]=c("small",null,"Recommended: Maintains relative timing",-1))])]),c("label",_4,[je(c("input",{"onUpdate:modelValue":I[1]||(I[1]=M=>l.value=M),type:"radio",value:"keep",name:"shift-option"},null,512),[[xd,l.value]]),c("div",null,[c("strong",null,"Keep "+_(z(i).checkpoint)+" times unchanged",1),c("small",null,_(z(o).checkpoint)+" times will stay at their current values",1)])])])])]),_:1},8,["show","title"]))}},b4=Ye(k4,[["__scopeId","data-v-0e706cff"]]),w4={key:0,class:"tab-content"},C4={class:"form-group"},L4=["disabled"],S4={class:"form-group"},x4={key:1,class:"tab-content"},T4={class:"boundary-section"},I4={class:"boundary-actions"},$4={key:2,class:"tab-content"},M4={class:"section-title"},A4={class:"contacts-actions"},E4={key:0,class:"area-contacts-list"},P4=["onClick"],D4={class:"contact-info"},O4={key:0,class:"contact-role-badge"},R4={key:1,class:"contact-details"},B4={key:0},N4={key:1},F4={key:3,class:"tab-content"},U4={class:"section-title"},z4={key:0,class:"empty-state"},H4={key:1,class:"checkpoints-list"},V4=["onClick"],G4={class:"checkpoint-header"},Z4=["innerHTML"],j4={class:"checkpoint-name-section"},W4={key:0,class:"checkpoint-description"},q4={class:"checkpoint-stats"},K4={class:"checkpoint-details"},Y4={class:"detail-row with-pills"},J4={class:"detail-label"},X4={class:"detail-value"},Q4={key:0,class:"warning-text"},e3={key:0,class:"marshal-pills"},t3={class:"detail-row"},n3={class:"detail-value"},o3={key:0,class:"detail-row"},s3={key:1,class:"detail-row"},i3={key:4,class:"placeholder-message"},a3={key:6,class:"placeholder-message"},r3={key:8,class:"placeholder-message"},l3={key:9,class:"tab-content appearance-tab"},c3={class:"accordion-item"},u3=["innerHTML"],d3={class:"accordion-title"},h3={class:"accordion-arrow"},f3={key:0,class:"accordion-content"},p3={class:"section-description"},v3={class:"color-picker"},m3=["title","onClick"],g3={class:"accordion-item"},y3=["innerHTML"],_3={class:"accordion-title"},k3={class:"accordion-arrow"},b3={key:0,class:"accordion-content"},w3={class:"section-description"},C3={class:"accordion-item"},L3={class:"accordion-title"},S3={class:"accordion-preview"},x3={class:"accordion-arrow"},T3={key:0,class:"accordion-content"},I3={class:"section-description"},$3={class:"form-group"},M3={value:""},A3=["value"],E3={class:"accordion-item"},P3={class:"accordion-title"},D3={class:"accordion-preview"},O3={class:"accordion-arrow"},R3={key:0,class:"accordion-content"},B3={class:"section-description"},N3={class:"form-group"},F3={value:""},U3=["value"],z3={class:"custom-footer"},H3={key:1},kh="edit_area_accordion",V3={__name:"EditAreaModal",props:{show:{type:Boolean,default:!1},area:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["close","save","delete","draw-boundary","update:isDirty","select-checkpoint","add-area-contact","edit-contact"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Ct(),s=()=>b.value.peopleTerm?b.value.peopleTerm:h.eventPeopleTerm||"Marshals",a=(N=!0)=>{const O=b.value.checkpointTerm||h.eventCheckpointTerm||"Checkpoints",W=s();return N?Rp("checkpoint",O,W):Ys("checkpoint",O,W)},l=(N=!0)=>a(N).toLowerCase(),u=N=>N.resolvedPeopleTerm?N.resolvedPeopleTerm:N.peopleTerm?N.peopleTerm:b.value.peopleTerm?b.value.peopleTerm:h.eventPeopleTerm||"Marshals",h=e,p=t,f=P("details"),y=P(null),k=P([]),I=P({}),M=P({}),b=P({name:"",description:"",color:Ur,displayOrder:0,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),B=()=>h.eventId?`${kh}_${h.eventId}`:kh,E=P({polygonColor:!1,iconStyle:!1,peopleTerm:!1,checkpointTerm:!1});Qt(()=>{const N=localStorage.getItem(B());if(N)try{const O=JSON.parse(N);E.value={...E.value,...O}}catch{}});const A=N=>{E.value[N]=!E.value[N],localStorage.setItem(B(),JSON.stringify(E.value))},C=J(()=>`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <polygon points="4,8 7,3 14,2 20,5 22,12 19,18 12,21 5,19 2,14" fill="${b.value.color||Ur}" stroke="#fff" stroke-width="1.5" opacity="0.8"/>
  </svg>`),x=J(()=>{const N=b.value.checkpointStyleType!=="default"||b.value.checkpointStyleBackgroundShape||b.value.checkpointStyleBackgroundColor||b.value.checkpointStyleBorderColor||b.value.checkpointStyleIconColor||b.value.checkpointStyleSize,O=h.eventDefaultStyleType!=="default"||h.eventDefaultStyleBackgroundShape||h.eventDefaultStyleBackgroundColor||h.eventDefaultStyleColor||h.eventDefaultStyleBorderColor||h.eventDefaultStyleIconColor||h.eventDefaultStyleSize;if(!N&&!O)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="areaDefaultGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981"/>
          <stop offset="50%" style="stop-color:#F59E0B"/>
          <stop offset="100%" style="stop-color:#EF4444"/>
        </linearGradient>
      </defs>
      <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#areaDefaultGrad)" stroke="#fff" stroke-width="1.5"/>
    </svg>`;const W=b.value.checkpointStyleType&&b.value.checkpointStyleType!=="default"?b.value.checkpointStyleType:h.eventDefaultStyleType&&h.eventDefaultStyleType!=="default"?h.eventDefaultStyleType:"default",me=b.value.checkpointStyleBackgroundShape||h.eventDefaultStyleBackgroundShape||"circle",$e=b.value.checkpointStyleBackgroundColor||h.eventDefaultStyleBackgroundColor||h.eventDefaultStyleColor||"#667eea",ke=b.value.checkpointStyleBorderColor||h.eventDefaultStyleBorderColor||"#ffffff",Ne=b.value.checkpointStyleIconColor||h.eventDefaultStyleIconColor||"#ffffff",Fe=b.value.checkpointStyleSize||h.eventDefaultStyleSize||"100";return qt({type:W!=="default"?W:me,backgroundShape:me,backgroundColor:$e,borderColor:ke,iconColor:Ne,size:Fe,outputSize:24})}),T=J(()=>h.area&&h.area.id),S=J(()=>[{value:"details",label:"Details",icon:"details"},{value:"boundary",label:"Boundary",icon:"area"},{value:"contacts",label:"Contacts",icon:"marshal"},{value:"checkpoints",label:a(),icon:"checkpoint"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}]),$=J(()=>S.value.findIndex(N=>N.value===f.value)),se=J(()=>$.value===S.value.length-1),ce=J(()=>se.value?null:S.value[$.value+1]),_e=J(()=>se.value?`Create ${i.value.area}`:`Add ${ce.value.label.toLowerCase()}...`),ae=J(()=>{if(!h.area||!h.area.id)return[];const N=h.checkpoints.filter(O=>O.areaIds&&O.areaIds.includes(h.area.id)).map(O=>O.id);return h.assignments.filter(O=>N.includes(O.locationId))}),pe=J(()=>!h.area||!h.area.id?[]:h.checkpoints.filter(N=>N.areaIds&&N.areaIds.includes(h.area.id))),Ie=J(()=>{const N=[...pe.value];return N.sort((O,W)=>{const me=O.name.match(/^(\d+)/),$e=W.name.match(/^(\d+)/);if(me&&$e){const ke=parseInt(me[1]),Ne=parseInt($e[1]);if(ke!==Ne)return ke-Ne}return O.name.localeCompare(W.name,void 0,{numeric:!0,sensitivity:"base"})}),N}),Be=J(()=>!h.area||!h.area.id?[]:h.contacts.filter(N=>N.scopeConfigurations?N.scopeConfigurations.some(O=>O.scope==="EveryoneInAreas"&&O.itemType==="Area"?O.ids?.includes("ALL_AREAS")?!0:O.ids?.includes(h.area.id):!1):!1)),Se=N=>h.assignments.filter(O=>O.locationId===N),he=N=>[...Se(N)].sort((W,me)=>(W.marshalName||"").localeCompare(me.marshalName||"",void 0,{sensitivity:"base"})),Q=N=>Se(N.id).filter(W=>W.isCheckedIn).length,X=N=>{const O=Se(N.id);if(O.length===0)return"status-none";const W=O.filter(me=>me.isCheckedIn).length;return W===0?"status-none":W===O.length?"status-complete":"status-partial"},ue=N=>{const O=Se(N.id),W=u(N).toLowerCase();if(O.length===0)return`No ${W}`;const me=O.filter($e=>$e.isCheckedIn).length;return me===0?"Not checked in":me===O.length?"Fully checked in":`Partially checked in (${me}/${O.length})`},te=N=>{const O=I.value[N];return!O||O.total===0?"":O.completed===O.total?"status-complete":O.completed===0?"status-none":"status-partial"},be=N=>{const O=I.value[N];return O?O.total===0?"No tasks":O.completed===O.total?"All tasks completed":`${O.completed}/${O.total} completed`:""},Oe=async N=>{if(!(I.value[N]||M.value[N])){M.value[N]=!0;try{const W=(await Pt.getCheckpointChecklist(h.eventId,N)).data||[];I.value[N]={total:W.length,completed:W.filter(me=>me.isCompleted).length}}catch(O){console.error("Failed to load checklist status for checkpoint:",N,O),I.value[N]={total:0,completed:0}}finally{M.value[N]=!1}}};qe(()=>h.area,N=>{if(N){const O=N.polygon?typeof N.polygon=="string"?JSON.parse(N.polygon):N.polygon:[];b.value={name:N.name||"",description:N.description||"",color:N.color||Ur,displayOrder:N.displayOrder||0,isDefault:N.isDefault||!1,polygon:O,checkpointStyleType:N.checkpointStyleType||"default",checkpointStyleColor:N.checkpointStyleColor||"",checkpointStyleBackgroundShape:N.checkpointStyleBackgroundShape||"",checkpointStyleBackgroundColor:N.checkpointStyleBackgroundColor||"",checkpointStyleBorderColor:N.checkpointStyleBorderColor||"",checkpointStyleIconColor:N.checkpointStyleIconColor||"",checkpointStyleSize:N.checkpointStyleSize||"",checkpointStyleMapRotation:N.checkpointStyleMapRotation??"",peopleTerm:N.peopleTerm||"",checkpointTerm:N.checkpointTerm||""}}else b.value={name:"",description:"",color:mh(h.areas),displayOrder:h.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}},{immediate:!0,deep:!0}),qe(()=>h.show,N=>{N&&(f.value="details",k.value=[],I.value={},M.value={},T.value||(b.value={name:"",description:"",color:mh(h.areas),displayOrder:h.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),y.value?.resetLocalState&&y.value.resetLocalState())}),qe(f,N=>{N==="checkpoints"&&h.area&&h.area.id&&pe.value.forEach(O=>{setTimeout(()=>Oe(O.id),0)})});const ne=()=>{p("update:isDirty",!0)},Ee=N=>{b.value.color=N,ne()},xe=(N,O)=>{b.value[N]=O,ne()},we=()=>{p("draw-boundary",b.value)},re=()=>{b.value.polygon=[],ne()},ve=()=>{p("add-area-contact",h.area)},q=N=>N?N.replace(/([A-Z])/g," $1").replace(/^./,O=>O.toUpperCase()).trim():"",fe=N=>{k.value=N,ne()},Le=()=>{T.value||se.value?U():f.value=ce.value.value},U=()=>{const N=h.area?{name:b.value.name,description:b.value.description,color:b.value.color,polygon:b.value.polygon.length>0?b.value.polygon:null,displayOrder:b.value.displayOrder,checkpointStyleType:b.value.checkpointStyleType,checkpointStyleColor:b.value.checkpointStyleColor,checkpointStyleBackgroundShape:b.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:b.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:b.value.checkpointStyleBorderColor,checkpointStyleIconColor:b.value.checkpointStyleIconColor,checkpointStyleSize:b.value.checkpointStyleSize,checkpointStyleMapRotation:b.value.checkpointStyleMapRotation!=null&&b.value.checkpointStyleMapRotation!==""?String(b.value.checkpointStyleMapRotation):null,peopleTerm:b.value.peopleTerm,checkpointTerm:b.value.checkpointTerm,checklistChanges:k.value||[]}:{name:b.value.name,description:b.value.description,color:b.value.color,polygon:b.value.polygon.length>0?b.value.polygon:null,checkpointStyleType:b.value.checkpointStyleType,checkpointStyleColor:b.value.checkpointStyleColor,checkpointStyleBackgroundShape:b.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:b.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:b.value.checkpointStyleBorderColor,checkpointStyleIconColor:b.value.checkpointStyleIconColor,checkpointStyleSize:b.value.checkpointStyleSize,checkpointStyleMapRotation:b.value.checkpointStyleMapRotation!=null&&b.value.checkpointStyleMapRotation!==""?String(b.value.checkpointStyleMapRotation):null,peopleTerm:b.value.peopleTerm,checkpointTerm:b.value.checkpointTerm};p("save",N)},H=()=>{p("delete",h.area.id)},Y=()=>{p("close")},Z=N=>{const O=N.resolvedStyleType||N.ResolvedStyleType,W=N.resolvedStyleBackgroundColor||N.ResolvedStyleBackgroundColor||N.resolvedStyleColor||N.ResolvedStyleColor,me=N.resolvedStyleBorderColor||N.ResolvedStyleBorderColor,$e=N.resolvedStyleIconColor||N.ResolvedStyleIconColor,ke=N.resolvedStyleBackgroundShape||N.ResolvedStyleBackgroundShape;return O&&O!=="default"||W||me||$e||ke&&ke!=="circle"?qt({type:O||"circle",backgroundShape:ke||"circle",backgroundColor:W||"#667eea",borderColor:me||"#ffffff",iconColor:$e||"#ffffff",size:"75",outputSize:20}):`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
    <circle cx="10" cy="10" r="8" fill="#667eea" stroke="#fff" stroke-width="1.5"/>
  </svg>`};return(N,O)=>(m(),ct(Ht,{show:e.show,title:e.area&&e.area.id?`Edit ${z(i).area}: ${e.area.name}`:`Create new ${z(i).area}`,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:Y},{"tab-header":et(()=>[ze(vu,{modelValue:f.value,"onUpdate:modelValue":O[0]||(O[0]=W=>f.value=W),tabs:S.value},null,8,["modelValue","tabs"])]),footer:et(()=>[c("div",z3,[T.value&&!b.value.isDefault?(m(),g("button",{key:0,type:"button",onClick:H,class:"btn btn-danger"}," Delete "+_(z(i).area),1)):(m(),g("div",H3)),c("button",{type:"button",onClick:Le,class:"btn btn-primary"},_(T.value?"Save changes":_e.value),1)])]),default:et(()=>[f.value==="details"?(m(),g("div",w4,[c("form",{onSubmit:vt(U,["prevent"])},[c("div",C4,[O[18]||(O[18]=c("label",null,"Name *",-1)),je(c("input",{"onUpdate:modelValue":O[1]||(O[1]=W=>b.value.name=W),type:"text",required:"",class:"form-input",disabled:b.value.isDefault,onInput:ne},null,40,L4),[[ht,b.value.name]])]),c("div",S4,[O[19]||(O[19]=c("label",null,"Description",-1)),je(c("textarea",{"onUpdate:modelValue":O[2]||(O[2]=W=>b.value.description=W),class:"form-input",rows:"3",onInput:ne},null,544),[[ht,b.value.description]])])],32)])):R("",!0),f.value==="boundary"?(m(),g("div",x4,[c("div",T4,[O[20]||(O[20]=c("div",{class:"instructions-card"},[c("p",null,[c("strong",null,"Draw a polygon on the map to define this area's boundary")]),c("p",null,' Click "Draw on Map" to activate drawing mode. Click on the map to add vertices, and double-click to complete the polygon. ')],-1)),c("div",I4,[c("button",{onClick:we,class:"btn btn-primary btn-full"}," Draw on Map "),b.value.polygon&&b.value.polygon.length>0?(m(),g("button",{key:0,onClick:re,class:"btn btn-danger btn-full"}," Clear Boundary ")):R("",!0)])])])):R("",!0),f.value==="contacts"?(m(),g("div",$4,[c("h3",M4,_(z(o).area)+" contacts",1),c("div",A4,[c("button",{onClick:ve,class:"btn btn-primary btn-full"}," Add contact for this "+_(z(i).area),1)]),Be.value.length>0?(m(),g("div",E4,[c("h4",null,"Contacts visible in this "+_(z(i).area)+" ("+_(Be.value.length)+")",1),(m(!0),g(Ce,null,Re(Be.value,W=>(m(),g("div",{key:W.contactId,class:"contact-item",onClick:me=>N.$emit("edit-contact",W)},[c("div",D4,[c("strong",null,_(W.name),1),W.role?(m(),g("span",O4,_(q(W.role)),1)):R("",!0),W.phone||W.email?(m(),g("div",R4,[W.phone?(m(),g("span",B4,_(W.phone),1)):R("",!0),W.email?(m(),g("span",N4,_(W.email),1)):R("",!0)])):R("",!0)])],8,P4))),128))])):R("",!0)])):R("",!0),f.value==="checkpoints"&&T.value?(m(),g("div",F4,[c("h3",U4,_(a())+" in "+_(e.area?.name)+" ("+_(pe.value.length)+")",1),pe.value.length===0?(m(),g("div",z4,[c("p",null,"No "+_(l())+" in this "+_(z(i).area)+" yet.",1)])):(m(),g("div",H4,[(m(!0),g(Ce,null,Re(Ie.value,W=>(m(),g("div",{key:W.id,class:"checkpoint-card",onClick:me=>N.$emit("select-checkpoint",W)},[c("div",G4,[c("span",{class:"checkpoint-icon",innerHTML:Z(W)},null,8,Z4),c("div",j4,[c("h4",null,[Ze(_(W.name),1),W.description?(m(),g("span",W4," - "+_(W.description),1)):R("",!0)])]),c("div",q4,[c("div",{class:Te(["stat-badge",X(W)])},_(ue(W)),3)])]),c("div",K4,[c("div",Y4,[c("span",J4,_(u(W))+":",1),c("span",X4,[Ze(_(Se(W.id).length)+" / "+_(W.requiredMarshals)+" ",1),Se(W.id).length<W.requiredMarshals?(m(),g("span",Q4," ("+_(W.requiredMarshals-Se(W.id).length)+" needed) ",1)):R("",!0)]),Se(W.id).length>0?(m(),g("div",e3,[(m(!0),g(Ce,null,Re(he(W.id),me=>(m(),g("span",{key:me.id,class:Te(["marshal-pill",{"checked-in":me.isCheckedIn}])},_(me.marshalName),3))),128))])):R("",!0)]),c("div",t3,[O[21]||(O[21]=c("span",{class:"detail-label"},"Checked in:",-1)),c("span",n3,_(Q(W))+" / "+_(Se(W.id).length),1)]),I.value[W.id]?(m(),g("div",o3,[O[22]||(O[22]=c("span",{class:"detail-label"},"Tasks:",-1)),c("span",{class:Te(["detail-value",te(W.id)])},_(be(W.id)),3)])):M.value[W.id]?(m(),g("div",s3,[...O[23]||(O[23]=[c("span",{class:"detail-label"},"Tasks:",-1),c("span",{class:"detail-value loading-text"},"Loading...",-1)])])):R("",!0)])],8,V4))),128))]))])):R("",!0),f.value==="checkpoints"&&!T.value?(m(),g("div",i3,[c("p",null,_(a())+" will be automatically assigned based on boundaries after the "+_(z(i).area)+" is created.",1)])):R("",!0),f.value==="checklists"&&T.value?(m(),ct(Zp,{key:5,ref_key:"checklistTabRef",ref:y,modelValue:k.value,"onUpdate:modelValue":O[3]||(O[3]=W=>k.value=W),"event-id":e.eventId,"area-id":e.area.id,locations:e.allLocations,areas:e.areas,assignments:ae.value,onChange:fe},null,8,["modelValue","event-id","area-id","locations","areas","assignments"])):R("",!0),f.value==="checklists"&&!T.value?(m(),g("div",a3,[c("p",null,_(z(o).checklists)+" can be assigned after the "+_(z(i).area)+" is created.",1)])):R("",!0),f.value==="notes"&&T.value?(m(),ct(xl,{key:7,"event-id":e.eventId,"area-id":e.area?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","area-id","all-notes","locations","areas","assignments"])):R("",!0),f.value==="notes"&&!T.value?(m(),g("div",r3,[c("p",null,"Notes can be viewed after the "+_(z(i).area)+" is created.",1)])):R("",!0),f.value==="appearance"?(m(),g("div",l3,[c("div",c3,[c("button",{type:"button",class:Te(["accordion-header",{expanded:E.value.polygonColor}]),onClick:O[4]||(O[4]=W=>A("polygonColor"))},[c("div",{class:"accordion-icon",innerHTML:C.value},null,8,u3),c("span",d3,_(z(o).area)+" polygon colour",1),c("span",h3,_(E.value.polygonColor?"":""),1)],2),E.value.polygonColor?(m(),g("div",f3,[c("p",p3," Choose a colour for this "+_(z(i).area)+"'s boundary on the map. ",1),c("div",v3,[(m(!0),g(Ce,null,Re(z(An),W=>(m(),g("div",{key:W.hex,class:Te(["color-swatch",{selected:b.value.color===W.hex}]),style:st({backgroundColor:W.hex}),title:W.name,onClick:me=>Ee(W.hex)},null,14,m3))),128))])])):R("",!0)]),c("div",g3,[c("button",{type:"button",class:Te(["accordion-header",{expanded:E.value.iconStyle}]),onClick:O[5]||(O[5]=W=>A("iconStyle"))},[c("div",{class:"accordion-icon",innerHTML:x.value},null,8,y3),c("span",_3,_(a(!1))+" marker style",1),c("span",k3,_(E.value.iconStyle?"":""),1)],2),E.value.iconStyle?(m(),g("div",b3,[c("p",w3," Set a default marker style for all "+_(l())+" in this "+_(z(i).area)+". Individual "+_(l())+" can override this setting. ",1),ze(pu,{"style-type":b.value.checkpointStyleType||"default","style-color":b.value.checkpointStyleColor||"","style-background-shape":b.value.checkpointStyleBackgroundShape||"","style-background-color":b.value.checkpointStyleBackgroundColor||"","style-border-color":b.value.checkpointStyleBorderColor||"","style-icon-color":b.value.checkpointStyleIconColor||"","style-size":b.value.checkpointStyleSize||"","style-map-rotation":b.value.checkpointStyleMapRotation??"","inherited-style-type":e.eventDefaultStyleType,"inherited-style-color":e.eventDefaultStyleColor,"inherited-background-shape":e.eventDefaultStyleBackgroundShape||"","inherited-background-color":e.eventDefaultStyleBackgroundColor||e.eventDefaultStyleColor||"","inherited-border-color":e.eventDefaultStyleBorderColor||"","inherited-icon-color":e.eventDefaultStyleIconColor||"","inherited-size":e.eventDefaultStyleSize||"","inherited-map-rotation":e.eventDefaultStyleMapRotation??"","default-label":"Event default","icon-label":"Marker style",level:"area","show-preview":!0,"onUpdate:styleType":O[6]||(O[6]=W=>xe("checkpointStyleType",W)),"onUpdate:styleColor":O[7]||(O[7]=W=>xe("checkpointStyleColor",W)),"onUpdate:styleBackgroundShape":O[8]||(O[8]=W=>xe("checkpointStyleBackgroundShape",W)),"onUpdate:styleBackgroundColor":O[9]||(O[9]=W=>xe("checkpointStyleBackgroundColor",W)),"onUpdate:styleBorderColor":O[10]||(O[10]=W=>xe("checkpointStyleBorderColor",W)),"onUpdate:styleIconColor":O[11]||(O[11]=W=>xe("checkpointStyleIconColor",W)),"onUpdate:styleSize":O[12]||(O[12]=W=>xe("checkpointStyleSize",W)),"onUpdate:styleMapRotation":O[13]||(O[13]=W=>xe("checkpointStyleMapRotation",W))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])])):R("",!0)]),c("div",C3,[c("button",{type:"button",class:Te(["accordion-header",{expanded:E.value.peopleTerm}]),onClick:O[14]||(O[14]=W=>A("peopleTerm"))},[O[24]||(O[24]=c("div",{class:"accordion-icon"},[c("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[c("circle",{cx:"12",cy:"8",r:"4",fill:"#6366F1"}),c("path",{d:"M4 20c0-4.4 3.6-8 8-8s8 3.6 8 8",fill:"#6366F1",opacity:"0.6"})])],-1)),c("span",L3,_(s())+" terminology",1),c("span",S3,_(b.value.peopleTerm||`${e.eventPeopleTerm} (event default)`),1),c("span",x3,_(E.value.peopleTerm?"":""),1)],2),E.value.peopleTerm?(m(),g("div",T3,[c("p",I3," Choose what "+_(s().toLowerCase())+" are called in this "+_(z(i).area)+". This will be inherited by "+_(l())+" unless they override it. ",1),c("div",$3,[O[25]||(O[25]=c("label",null,"What are people called?",-1)),je(c("select",{"onUpdate:modelValue":O[15]||(O[15]=W=>b.value.peopleTerm=W),class:"form-input",onChange:ne},[c("option",M3,"Use event default ("+_(e.eventPeopleTerm)+")",1),(m(!0),g(Ce,null,Re(z(Ko).people,W=>(m(),g("option",{key:W,value:W},_(W),9,A3))),128))],544),[[bn,b.value.peopleTerm]])])])):R("",!0)]),c("div",E3,[c("button",{type:"button",class:Te(["accordion-header",{expanded:E.value.checkpointTerm}]),onClick:O[16]||(O[16]=W=>A("checkpointTerm"))},[O[26]||(O[26]=c("div",{class:"accordion-icon"},[c("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[c("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z",fill:"#10B981"}),c("circle",{cx:"12",cy:"9",r:"2.5",fill:"white"})])],-1)),c("span",P3,_(a(!1))+" terminology",1),c("span",D3,_(b.value.checkpointTerm?z(Oc)(b.value.checkpointTerm,s()):`${e.eventCheckpointTerm} (event default)`),1),c("span",O3,_(E.value.checkpointTerm?"":""),1)],2),E.value.checkpointTerm?(m(),g("div",R3,[c("p",B3," Choose what "+_(l())+" are called in this "+_(z(i).area)+". ",1),c("div",N3,[c("label",null,"What are "+_(l())+" called?",1),je(c("select",{"onUpdate:modelValue":O[17]||(O[17]=W=>b.value.checkpointTerm=W),class:"form-input",onChange:ne},[c("option",F3,"Use event default ("+_(e.eventCheckpointTerm)+")",1),(m(!0),g(Ce,null,Re(z(Ko).checkpoint,W=>(m(),g("option",{key:W,value:W},_(z(Oc)(W,s())),9,U3))),128))],544),[[bn,b.value.checkpointTerm]])])])):R("",!0)])])):R("",!0)]),_:1},8,["show","title","is-dirty"]))}},G3=Ye(V3,[["__scopeId","data-v-094e8954"]]),Z3=["innerHTML"],j3={__name:"InfoModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Information"},message:{type:String,required:!0},okText:{type:String,default:"OK"}},emits:["close"],setup(e,{emit:t}){const o=t,i=()=>{o("close")};return(s,a)=>(m(),ct(Ht,{show:e.show,title:e.title,size:"small","z-index":2e3,onClose:i},{actions:et(()=>[c("button",{onClick:i,class:"btn btn-primary"},_(e.okText),1)]),default:et(()=>[c("div",{class:"info-content",innerHTML:e.message},null,8,Z3)]),_:1},8,["show","title"]))}},Tl=Ye(j3,[["__scopeId","data-v-319bcdc8"]]),W3={class:"tab-headers"},q3={class:"tab-content"},K3={class:"form-group"},Y3=["placeholder"],J3={key:0,class:"checkbox-label-inline create-separate-items"},X3={class:"tab-content"},Q3={class:"custom-footer"},eD={__name:"EditChecklistItemModal",props:{show:{type:Boolean,default:!1},checklistItem:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=P(!1),a=P(""),l=P("details"),u=P({text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0}),h=J(()=>!!o.checklistItem);qe(()=>o.show,E=>{E&&(l.value=o.initialTab,o.checklistItem?u.value={text:o.checklistItem.text||"",scopeConfigurations:o.checklistItem.scopeConfigurations?JSON.parse(JSON.stringify(o.checklistItem.scopeConfigurations)):[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:o.checklistItem.displayOrder||0,isRequired:o.checklistItem.isRequired!==!1,visibleFrom:o.checklistItem.visibleFrom?p(o.checklistItem.visibleFrom):null,visibleUntil:o.checklistItem.visibleUntil?p(o.checklistItem.visibleUntil):null,mustCompleteBy:o.checklistItem.mustCompleteBy?p(o.checklistItem.mustCompleteBy):null,createSeparateItems:!1}:u.value={text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0},i("update:isDirty",!1))});const p=E=>{if(!E)return null;const A=new Date(E),C=A.getTimezoneOffset();return new Date(A.getTime()-C*60*1e3).toISOString().slice(0,16)},f=E=>E?new Date(E).toISOString():null,y=()=>{i("update:isDirty",!0)},k=()=>{i("close")},I=()=>{l.value="visibility"},M=E=>{a.value=E,s.value=!0},b=()=>{if(!u.value.text||!u.value.text.trim()){M("Please enter checklist item text");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){M("Please select at least one scope");return}if(!u.value.scopeConfigurations.some(C=>!(C.itemType!==null&&(!C.ids||C.ids.length===0)))){M("Please configure at least one scope with valid selections");return}const A={text:u.value.text,scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,isRequired:u.value.isRequired,visibleFrom:f(u.value.visibleFrom),visibleUntil:f(u.value.visibleUntil),mustCompleteBy:f(u.value.mustCompleteBy)};h.value||(A.createSeparateItems=u.value.createSeparateItems),i("save",A)},B=()=>{i("delete",o.checklistItem.itemId)};return(E,A)=>(m(),g(Ce,null,[ze(Ht,{show:e.show,title:h.value?"Edit checklist item":"Create checklist item",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:k},{footer:et(()=>[c("div",Q3,[h.value?(m(),g("button",{key:0,type:"button",onClick:B,class:"btn btn-danger"}," Delete ")):R("",!0),!h.value&&l.value==="details"?(m(),g("button",{key:1,type:"button",onClick:I,class:"btn btn-primary"}," Next ")):R("",!0),h.value||l.value==="visibility"?(m(),g("button",{key:2,type:"button",onClick:b,class:"btn btn-primary"},_(h.value?"Save changes":"Create"),1)):R("",!0)])]),default:et(()=>[c("div",W3,[c("button",{type:"button",class:Te(["tab-header",{active:l.value==="details"}]),onClick:A[0]||(A[0]=C=>l.value="details")}," Details ",2),c("button",{type:"button",class:Te(["tab-header",{active:l.value==="visibility"}]),onClick:A[1]||(A[1]=C=>l.value="visibility")}," Visibility ",2)]),c("form",{onSubmit:vt(b,["prevent"]),class:"checklist-form"},[je(c("div",q3,[c("div",K3,[A[7]||(A[7]=c("label",{for:"text"},"Checklist text: *",-1)),je(c("textarea",{id:"text","onUpdate:modelValue":A[2]||(A[2]=C=>u.value.text=C),onInput:y,required:"",rows:"3",placeholder:u.value.createSeparateItems?"Enter checklist items, one per line...":"Enter the checklist item text..."},null,40,Y3),[[ht,u.value.text]]),h.value?R("",!0):(m(),g("label",J3,[je(c("input",{type:"checkbox","onUpdate:modelValue":A[3]||(A[3]=C=>u.value.createSeparateItems=C),onChange:y},null,544),[[Ls,u.value.createSeparateItems]]),A[6]||(A[6]=c("span",null,"Each line creates a new item",-1))]))])],512),[[Ms,l.value==="details"]]),je(c("div",X3,[ze(Sl,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":A[4]||(A[4]=C=>u.value.scopeConfigurations=C),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":h.value,onUserChanged:y},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[Ms,l.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),ze(Tl,{show:s.value,title:"Validation error",message:a.value,onClose:A[5]||(A[5]=C=>s.value=!1)},null,8,["show","message"])],64))}},tD=Ye(eD,[["__scopeId","data-v-bb89c7c7"]]),nD={class:"tab-headers"},oD={class:"tab-content"},sD={class:"form-group"},iD={class:"form-group"},aD={class:"form-row"},rD={class:"form-group"},lD={class:"form-group"},cD={class:"form-row"},uD={class:"form-group"},dD={class:"form-group checkbox-group-inline"},hD={class:"checkbox-label-inline"},fD={class:"tab-content"},pD={class:"custom-footer"},vD={__name:"EditNoteModal",props:{show:{type:Boolean,default:!1},note:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=P(!1),a=P(""),l=P("details"),u=P({title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1}),h=J(()=>!!o.note);qe(()=>o.show,b=>{b&&(l.value=o.initialTab,o.note?u.value={title:o.note.title||"",content:o.note.content||"",scopeConfigurations:o.note.scopeConfigurations?JSON.parse(JSON.stringify(o.note.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:o.note.displayOrder||0,priority:o.note.priority||"Normal",category:o.note.category||"",isPinned:o.note.isPinned||!1}:u.value={title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1},i("update:isDirty",!1))});const p=()=>{i("update:isDirty",!0)},f=()=>{i("close")},y=()=>{l.value="visibility"},k=b=>{a.value=b,s.value=!0},I=()=>{if(!u.value.title||!u.value.title.trim()){k("Please enter a note title");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){k("Please select at least one visibility scope");return}if(!u.value.scopeConfigurations.some(E=>!(E.itemType!==null&&(!E.ids||E.ids.length===0)))){k("Please configure at least one scope with valid selections");return}const B={title:u.value.title.trim(),content:u.value.content||"",scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,priority:u.value.priority||"Normal",category:u.value.category?.trim()||null,isPinned:u.value.isPinned||!1};i("save",B)},M=()=>{i("delete",o.note.noteId)};return(b,B)=>(m(),g(Ce,null,[ze(Ht,{show:e.show,title:h.value?"Edit note":"Create note",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:f},{footer:et(()=>[c("div",pD,[h.value?(m(),g("button",{key:0,type:"button",onClick:M,class:"btn btn-danger"}," Delete ")):R("",!0),!h.value&&l.value==="details"?(m(),g("button",{key:1,type:"button",onClick:y,class:"btn btn-primary"}," Next ")):R("",!0),h.value||l.value==="visibility"?(m(),g("button",{key:2,type:"button",onClick:I,class:"btn btn-primary"},_(h.value?"Save changes":"Create"),1)):R("",!0)])]),default:et(()=>[c("div",nD,[c("button",{type:"button",class:Te(["tab-header",{active:l.value==="details"}]),onClick:B[0]||(B[0]=E=>l.value="details")}," Details ",2),c("button",{type:"button",class:Te(["tab-header",{active:l.value==="visibility"}]),onClick:B[1]||(B[1]=E=>l.value="visibility")}," Visibility ",2)]),c("form",{onSubmit:vt(I,["prevent"]),class:"note-form"},[je(c("div",oD,[c("div",sD,[B[10]||(B[10]=c("label",{for:"title"},"Title: *",-1)),je(c("input",{id:"title","onUpdate:modelValue":B[2]||(B[2]=E=>u.value.title=E),type:"text",onInput:p,required:"",placeholder:"Enter note title..."},null,544),[[ht,u.value.title]])]),c("div",iD,[B[11]||(B[11]=c("label",{for:"content"},"Content:",-1)),je(c("textarea",{id:"content","onUpdate:modelValue":B[3]||(B[3]=E=>u.value.content=E),onInput:p,rows:"6",placeholder:"Enter note content (supports markdown)..."},null,544),[[ht,u.value.content]])]),c("div",aD,[c("div",rD,[B[13]||(B[13]=c("label",{for:"priority"},"Priority:",-1)),je(c("select",{id:"priority","onUpdate:modelValue":B[4]||(B[4]=E=>u.value.priority=E),onChange:p},[...B[12]||(B[12]=[c("option",{value:"Emergency"},"Emergency",-1),c("option",{value:"Urgent"},"Urgent",-1),c("option",{value:"High"},"High",-1),c("option",{value:"Normal"},"Normal",-1),c("option",{value:"Low"},"Low",-1)])],544),[[bn,u.value.priority]])]),c("div",lD,[B[14]||(B[14]=c("label",{for:"category"},"Category:",-1)),je(c("input",{id:"category","onUpdate:modelValue":B[5]||(B[5]=E=>u.value.category=E),type:"text",onInput:p,placeholder:"e.g., Safety, Logistics..."},null,544),[[ht,u.value.category]])])]),c("div",cD,[c("div",uD,[B[15]||(B[15]=c("label",{for:"displayOrder"},"Display order:",-1)),je(c("input",{id:"displayOrder","onUpdate:modelValue":B[6]||(B[6]=E=>u.value.displayOrder=E),type:"number",onInput:p,min:"0"},null,544),[[ht,u.value.displayOrder,void 0,{number:!0}]]),B[16]||(B[16]=c("span",{class:"help-text"},"Lower numbers appear first",-1))]),c("div",dD,[c("label",hD,[je(c("input",{type:"checkbox","onUpdate:modelValue":B[7]||(B[7]=E=>u.value.isPinned=E),onChange:p},null,544),[[Ls,u.value.isPinned]]),B[17]||(B[17]=c("span",null,"Pin to top",-1))]),B[18]||(B[18]=c("span",{class:"help-text"},"Pinned notes always appear at the top",-1))])])],512),[[Ms,l.value==="details"]]),je(c("div",fD,[ze(Sl,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":B[8]||(B[8]=E=>u.value.scopeConfigurations=E),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":h.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this note?",onUserChanged:p},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[Ms,l.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),ze(Tl,{show:s.value,title:"Validation error",message:a.value,onClose:B[9]||(B[9]=E=>s.value=!1)},null,8,["show","message"])],64))}},mD=Ye(vD,[["__scopeId","data-v-1a34c03e"]]),gD={class:"tab-headers"},yD={class:"tab-content"},_D={class:"form-group"},kD={for:"marshalId"},bD=["value"],wD={class:"help-text"},CD={class:"form-group"},LD=["disabled"],SD={class:"form-group"},xD={class:"role-input-group"},TD={key:0,label:"Built-in Roles"},ID=["value"],$D={key:1,label:"Custom Roles"},MD=["value"],AD={class:"form-row"},ED={class:"form-group"},PD={class:"form-group"},DD={class:"form-group"},OD={class:"tab-content"},RD={class:"custom-footer"},BD={__name:"EditContactModal",props:{show:{type:Boolean,default:!1},contact:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},isDirty:{type:Boolean,default:!1},preselectedArea:{type:Object,default:null}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{terms:o}=Ct(),i=e,s=t,a=P(!1),l=P(""),u=P("details"),h=P(!1),p=P({role:"",name:"",phone:"",email:"",notes:"",marshalId:null,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}),f=J(()=>!!i.contact),y=J(()=>!!p.value.marshalId),k=J(()=>[...i.marshals].sort((T,S)=>Cn(T.name,S.name)));qe(()=>i.show,T=>{if(T){if(u.value=i.initialTab,i.contact){const S=[...i.availableRoles.builtInRoles||[],...i.availableRoles.customRoles||[]];h.value=i.contact.role&&!S.includes(i.contact.role),p.value={role:i.contact.role||"",name:i.contact.name||"",phone:i.contact.phone||"",email:i.contact.email||"",notes:i.contact.notes||"",marshalId:i.contact.marshalId||null,scopeConfigurations:i.contact.scopeConfigurations?JSON.parse(JSON.stringify(i.contact.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}}else{h.value=!1;const S=i.preselectedArea?[{scope:"EveryoneInAreas",itemType:"Area",ids:[i.preselectedArea.id]}]:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}];p.value={role:"",name:"",phone:"",email:"",notes:"",marshalId:null,scopeConfigurations:S}}s("update:isDirty",!1)}});const I=T=>T?T==="AreaLead"?`${o.value.area} Lead`:T.replace(/([A-Z])/g," $1").replace(/^./,S=>S.toUpperCase()).trim():"",M=()=>{s("update:isDirty",!0)},b=()=>{if(p.value.marshalId){const T=i.marshals.find(S=>S.id===p.value.marshalId);T&&(p.value.name=T.name,!p.value.phone&&T.phoneNumber&&(p.value.phone=T.phoneNumber),!p.value.email&&T.email&&(p.value.email=T.email))}M()},B=()=>{s("close")},E=()=>{if(!p.value.role||!p.value.role.trim()){A("Please select or enter a role");return}if(!p.value.name||!p.value.name.trim()){A("Please enter a contact name");return}u.value="visibility"},A=T=>{l.value=T,a.value=!0},C=()=>{if(!p.value.role||!p.value.role.trim()){A("Please select or enter a role");return}if(!p.value.name||!p.value.name.trim()){A("Please enter a contact name");return}if(!p.value.scopeConfigurations||p.value.scopeConfigurations.length===0){A("Please select at least one visibility scope");return}if(!p.value.scopeConfigurations.some($=>!($.itemType!==null&&(!$.ids||$.ids.length===0)))){A("Please configure at least one scope with valid selections");return}const S={role:p.value.role.trim(),name:p.value.name.trim(),phone:p.value.phone?.trim()||null,email:p.value.email?.trim()||null,notes:p.value.notes?.trim()||null,marshalId:p.value.marshalId||null,scopeConfigurations:p.value.scopeConfigurations};s("save",S)},x=()=>{s("delete",i.contact.contactId)};return(T,S)=>(m(),g(Ce,null,[ze(Ht,{show:e.show,title:f.value?"Edit contact":"Create contact",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:B},{footer:et(()=>[c("div",RD,[f.value?(m(),g("button",{key:0,type:"button",onClick:x,class:"btn btn-danger"}," Delete ")):R("",!0),!f.value&&u.value==="details"?(m(),g("button",{key:1,type:"button",onClick:E,class:"btn btn-primary"}," Next ")):R("",!0),f.value||u.value==="visibility"?(m(),g("button",{key:2,type:"button",onClick:C,class:"btn btn-primary"},_(f.value?"Save changes":"Create"),1)):R("",!0)])]),default:et(()=>[c("div",gD,[c("button",{type:"button",class:Te(["tab-header",{active:u.value==="details"}]),onClick:S[0]||(S[0]=$=>u.value="details")}," Details ",2),c("button",{type:"button",class:Te(["tab-header",{active:u.value==="visibility"}]),onClick:S[1]||(S[1]=$=>u.value="visibility")}," Visibility ",2)]),c("form",{onSubmit:vt(C,["prevent"]),class:"contact-form"},[je(c("div",yD,[c("div",_D,[c("label",kD,"Link to "+_(z(o).person.toLowerCase())+":",1),je(c("select",{id:"marshalId","onUpdate:modelValue":S[2]||(S[2]=$=>p.value.marshalId=$),onChange:b},[S[12]||(S[12]=c("option",{value:null},"-- Not linked --",-1)),(m(!0),g(Ce,null,Re(k.value,$=>(m(),g("option",{key:$.id,value:$.id},_($.name),9,bD))),128))],544),[[bn,p.value.marshalId]]),c("span",wD,"Optionally link to an existing "+_(z(o).person.toLowerCase())+" in the system",1)]),c("div",CD,[S[13]||(S[13]=c("label",{for:"name"},"Name: *",-1)),je(c("input",{id:"name","onUpdate:modelValue":S[3]||(S[3]=$=>p.value.name=$),type:"text",onInput:M,disabled:y.value,class:Te({"input-disabled":y.value}),placeholder:"Contact name..."},null,42,LD),[[ht,p.value.name]])]),c("div",SD,[S[15]||(S[15]=c("label",{for:"role"},"Role: *",-1)),c("div",xD,[h.value?je((m(),g("input",{key:1,id:"customRole","onUpdate:modelValue":S[5]||(S[5]=$=>p.value.role=$),type:"text",onInput:M,placeholder:"Enter custom role name..."},null,544)),[[ht,p.value.role]]):je((m(),g("select",{key:0,id:"role","onUpdate:modelValue":S[4]||(S[4]=$=>p.value.role=$),onChange:M},[S[14]||(S[14]=c("option",{value:"",disabled:""},"Select a role...",-1)),e.availableRoles.builtInRoles?.length>0?(m(),g("optgroup",TD,[(m(!0),g(Ce,null,Re(e.availableRoles.builtInRoles,$=>(m(),g("option",{key:$,value:$},_(I($)),9,ID))),128))])):R("",!0),e.availableRoles.customRoles?.length>0?(m(),g("optgroup",$D,[(m(!0),g(Ce,null,Re(e.availableRoles.customRoles,$=>(m(),g("option",{key:$,value:$},_(I($)),9,MD))),128))])):R("",!0)],544)),[[bn,p.value.role]]),c("button",{type:"button",class:"toggle-custom-btn",onClick:S[6]||(S[6]=$=>h.value=!h.value)},_(h.value?"Use existing":"Custom"),1)])]),c("div",AD,[c("div",ED,[S[16]||(S[16]=c("label",{for:"phone"},"Phone:",-1)),je(c("input",{id:"phone","onUpdate:modelValue":S[7]||(S[7]=$=>p.value.phone=$),type:"tel",onInput:M,placeholder:"Phone number..."},null,544),[[ht,p.value.phone]])]),c("div",PD,[S[17]||(S[17]=c("label",{for:"email"},"Email:",-1)),je(c("input",{id:"email","onUpdate:modelValue":S[8]||(S[8]=$=>p.value.email=$),type:"email",onInput:M,placeholder:"Email address..."},null,544),[[ht,p.value.email]])])]),c("div",DD,[S[18]||(S[18]=c("label",{for:"notes"},"Notes / Instructions:",-1)),je(c("textarea",{id:"notes","onUpdate:modelValue":S[9]||(S[9]=$=>p.value.notes=$),onInput:M,rows:"3",placeholder:"Additional notes or instructions for when to contact..."},null,544),[[ht,p.value.notes]])])],512),[[Ms,u.value==="details"]]),je(c("div",OD,[ze(Sl,{modelValue:p.value.scopeConfigurations,"onUpdate:modelValue":S[10]||(S[10]=$=>p.value.scopeConfigurations=$),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":f.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this contact?",onUserChanged:M},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[Ms,u.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),ze(Tl,{show:a.value,title:"Validation error",message:l.value,onClose:S[11]||(S[11]=$=>a.value=!1)},null,8,["show","message"])],64))}},ND=Ye(BD,[["__scopeId","data-v-62986ae5"]]),FD={key:0,class:"fullscreen-map-overlay"},UD={class:"fullscreen-map-header"},zD={class:"context-info"},HD={key:0},VD={class:"action-buttons"},GD=["disabled"],ZD={class:"fullscreen-map-container"},jD={key:0,class:"drawing-controls"},WD={class:"point-count"},qD={class:"undo-redo-buttons"},KD=["disabled"],YD=["disabled"],JD=Object.assign({inheritAttrs:!1},{__name:"FullscreenMapOverlay",props:{show:{type:Boolean,required:!0},mode:{type:String,validator:e=>["place-checkpoint","move-checkpoint","draw-area","add-multiple"].includes(e)},contextTitle:{type:String,default:""},contextDescription:{type:String,default:""},canComplete:{type:Boolean,default:!1},drawingMode:{type:Boolean,default:!1}},emits:["done","cancel","map-click","polygon-complete","polygon-drawing","location-click","area-click"],setup(e,{emit:t}){const o=e,i=t,s=P(null),a=P(0),l=P(!1),u=P(!1),h=()=>{i("done")},p=()=>{i("cancel")},f=b=>{a.value=b?.length||0,y(),i("polygon-drawing",b)},y=()=>{s.value&&(l.value=s.value.canUndo(),u.value=s.value.canRedo())},k=()=>{s.value&&(s.value.undoPolygonPoint(),y())},I=()=>{s.value&&(s.value.redoPolygonPoint(),y())};qe(()=>o.show,b=>{b||(a.value=0,l.value=!1,u.value=!1)});const M=b=>{b.key==="Escape"&&o.show&&p(),o.show&&o.drawingMode&&((b.ctrlKey||b.metaKey)&&b.key==="z"&&!b.shiftKey?(b.preventDefault(),k()):(b.ctrlKey||b.metaKey)&&(b.key==="y"||b.key==="z"&&b.shiftKey)&&(b.preventDefault(),I()))};return Qt(()=>{document.addEventListener("keydown",M)}),po(()=>{document.removeEventListener("keydown",M)}),(b,B)=>(m(),ct(gm,{to:"body"},[e.show?(m(),g("div",FD,[c("div",UD,[c("div",zD,[c("h3",null,_(e.contextTitle),1),e.contextDescription?(m(),g("p",HD,_(e.contextDescription),1)):R("",!0)]),c("div",VD,[c("button",{onClick:p,class:"btn btn-cancel"}," Cancel "),c("button",{onClick:h,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,GD)])]),c("div",ZD,[ze(ei,Rf({ref_key:"mapViewRef",ref:s,"drawing-mode":e.drawingMode},b.$attrs,{onMapClick:B[0]||(B[0]=E=>b.$emit("map-click",E)),onPolygonComplete:B[1]||(B[1]=E=>b.$emit("polygon-complete",E)),onPolygonDrawing:f,onLocationClick:B[2]||(B[2]=E=>b.$emit("location-click",E)),onAreaClick:B[3]||(B[3]=E=>b.$emit("area-click",E))}),null,16,["drawing-mode"]),e.drawingMode&&a.value>0?(m(),g("div",jD,[c("div",WD,_(a.value)+" point"+_(a.value!==1?"s":""),1),c("div",qD,[c("button",{onClick:k,class:"btn-drawing undo-btn",disabled:!l.value,title:"Undo last point"},"  Undo ",8,KD),c("button",{onClick:I,class:"btn-drawing redo-btn",disabled:!u.value,title:"Redo point"}," Redo  ",8,YD)])])):R("",!0)])])):R("",!0)]))}}),XD=Ye(JD,[["__scopeId","data-v-a7562744"]]),QD={class:"form-group"},e6={class:"form-group"},t6={class:"form-group"},n6={key:0,class:"form-error"},o6={class:"form-row"},s6={class:"form-group",style:{flex:"1"}},i6={class:"form-group",style:{flex:"1"}},a6={class:"form-group",style:{flex:"0 0 auto"}},r6={class:"form-group"},l6={__name:"AddLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:()=>({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""})},isDirty:{type:Boolean,default:!1}},emits:["close","save","set-on-map","update:isDirty","update:location"],setup(e,{emit:t}){const{termsLower:o}=Ct(),i=e,s=t,a=P({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""});qe(()=>i.location,p=>{p&&(a.value={...p})},{immediate:!0,deep:!0});const l=()=>{s("update:isDirty",!0),s("update:location",{...a.value})},u=()=>{if(!Xr(a.value.what3Words)&&a.value.what3Words){alert("Invalid What3Words format.");return}s("save",a.value)},h=()=>{s("close")};return(p,f)=>(m(),ct(Ht,{show:e.show,title:`Add ${z(o).checkpoint}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:h},{actions:et(()=>[c("button",{type:"button",onClick:h,class:"btn btn-secondary"}," Cancel "),c("button",{type:"button",onClick:u,class:"btn btn-primary"}," Add "+_(z(o).checkpoint),1)]),default:et(()=>[c("form",{onSubmit:vt(u,["prevent"])},[c("div",QD,[f[7]||(f[7]=c("label",null,"Name",-1)),je(c("input",{"onUpdate:modelValue":f[0]||(f[0]=y=>a.value.name=y),type:"text",required:"",class:"form-input",onInput:l},null,544),[[ht,a.value.name]])]),c("div",e6,[f[8]||(f[8]=c("label",null,"Description",-1)),je(c("input",{"onUpdate:modelValue":f[1]||(f[1]=y=>a.value.description=y),type:"text",class:"form-input",onInput:l},null,544),[[ht,a.value.description]])]),c("div",t6,[f[9]||(f[9]=c("label",null,"What3Words (optional)",-1)),je(c("input",{"onUpdate:modelValue":f[2]||(f[2]=y=>a.value.what3Words=y),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap",onInput:l},null,544),[[ht,a.value.what3Words]]),a.value.what3Words&&!z(Xr)(a.value.what3Words)?(m(),g("small",n6," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):R("",!0)]),c("div",o6,[c("div",s6,[f[10]||(f[10]=c("label",null,"Longitude",-1)),je(c("input",{"onUpdate:modelValue":f[3]||(f[3]=y=>a.value.longitude=y),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[ht,a.value.longitude,void 0,{number:!0}]])]),c("div",i6,[f[11]||(f[11]=c("label",null,"Latitude",-1)),je(c("input",{"onUpdate:modelValue":f[4]||(f[4]=y=>a.value.latitude=y),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[ht,a.value.latitude,void 0,{number:!0}]])]),c("div",a6,[f[12]||(f[12]=c("label",null,"",-1)),c("button",{type:"button",class:"icon-btn",title:"Set location on map",onClick:f[5]||(f[5]=y=>p.$emit("set-on-map"))},"  ")])]),c("div",r6,[c("label",null,"Required "+_(z(o).people),1),je(c("input",{"onUpdate:modelValue":f[6]||(f[6]=y=>a.value.requiredMarshals=y),type:"number",min:"1",required:"",class:"form-input",onInput:l},null,544),[[ht,a.value.requiredMarshals,void 0,{number:!0}]])])],32)]),_:1},8,["show","title","is-dirty"]))}},c6=Ye(l6,[["__scopeId","data-v-dcbdc216"]]),u6={class:"header"},d6={class:"header-left"},h6={key:0},f6={class:"event-date"},p6={class:"header-actions"},v6={class:"container"},m6={class:"tabs-nav"},g6={class:"tab-content-wrapper"},y6={key:1,class:"tab-panel"},_6={key:2,class:"tab-panel"},k6={__name:"AdminEventManage",setup(e){const t=lu(),o=za(),i=Ap(),s=J(()=>t.params.eventId),{activeTab:a,switchTab:l}=Ep("details",["details","course","areas","checkpoints","marshals","notes","checklists","contacts","settings"]),{showConfirmModal:u,confirmModalTitle:h,confirmModalMessage:p,showConfirm:f,handleConfirmModalConfirm:y,handleConfirmModalCancel:k}=Kb(),{tabLabels:I,termsLower:M}=Ct(),b=Yb(),B=Xb(s),E=Jb(s),{colorScheme:A}=fu(),C=J(()=>[{value:"details",label:"Event details",icon:"details"},{value:"course",label:I.value.course,icon:"course"},{value:"areas",label:I.value.areas,icon:"area"},{value:"checkpoints",label:I.value.checkpoints,icon:"checkpoint"},{value:"marshals",label:I.value.marshals,icon:"marshal"},{value:"notes",label:"Notes",icon:"notes"},{value:"checklists",label:I.value.checklists,icon:"checklist"},{value:"contacts",label:"Contacts",icon:"contacts"},{value:"settings",label:"Settings",icon:"settings"}]),x=P(null),T=P([]),S=P([]),$=P(null),se=P(!1),ce=P(null),_e=P(!1),ae=P(!1),pe=P(null),Ie=P(""),Be=E.eventAdmins,Se=E.showAddAdmin,he=B.showUploadRoute,Q=B.uploading,X=B.uploadError,ue=B.showImportLocations,te=B.showImportMarshals,be=B.importing,Oe=B.importingMarshals,ne=B.importError,Ee=B.importResult,xe=B.importMarshalsResult,we=P(!1),re=P(!1),ve=P({id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),q=P(!1),fe=P(!1),Le=P({marshalName:"",locations:[],marshal:null}),U=P(null),H=P([]),Y=P(!1),Z=P(null),N=P({id:"",name:"",email:"",phoneNumber:"",notes:""}),O=P(!1),W=P([]),me=P([]),$e=P([]),ke=P([]),Ne=P(!1),Fe=P(""),Ue=P(""),We=P({name:"",description:"",eventDate:"",timeZoneId:"UTC",peopleTerm:"Marshals",defaultCheckpointStyleBackgroundShape:"",defaultCheckpointStyleBackgroundColor:"",defaultCheckpointStyleBorderColor:"",defaultCheckpointStyleIconColor:"",defaultCheckpointStyleSize:"",defaultCheckpointStyleMapRotation:"",checkpointTerm:"Checkpoints",areaTerm:"Areas",checklistTerm:"Checklists",courseTerm:"Course",defaultCheckpointStyleType:"default",defaultCheckpointStyleColor:""}),oe=P(!1),ee=P(!1),j=P(""),Ve=P(""),Xe=P(0),nt=P({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),at=P([]),tt=P(null),St=P(!1),$t=P(null),yt=P(null),xn=b.isAddingMultipleCheckpoints,To=b.multiCheckpointCounter,Yn=b.isFullscreenMapActive,Dt=b.fullscreenMode,Rn=b.fullscreenContext,Bn=b.tempLocationCoords,Jn=b.tempCheckpoints,mo=b.savedMapCenter,Io=b.savedMapZoom,$o=b.isDrawingAreaBoundary,Xn=P(null),Nn=P([]),Tn=P(null),Mo=P(!1),is=P("details"),Ps=P(null),Ao=P([]),Ut=P(null),Je=P(!1),Eo=P("details"),Po=P([]),Qn=P({builtInRoles:[],customRoles:[]}),vn=P(null),In=P(!1),eo=P("details"),mn=P(null),Ds=P(null),Vi=J(()=>Ds.value?.marshalId!=null),Gi=()=>{o.push(`/event/${t.params.eventId}`)},Zi=J(()=>`${window.location.origin}/#/event/${t.params.eventId}`),as=J(()=>{const F=[];return S.value.forEach(le=>{le.assignments&&F.push(...le.assignments)}),F}),go=J(()=>{if(!Z.value)return S.value;const F=Z.value.assignedLocationIds||[],le=$e.value.map(Pe=>Pe.locationId),De=ke.value;return S.value.filter(Pe=>!F.includes(Pe.id)&&!le.includes(Pe.id)||De.includes(Pe.id))}),Yt=J(()=>{let F=H.value;if($.value){const le=$.value.assignments.map(Pe=>Pe.marshalName),De=W.value.map(Pe=>Pe.marshalName);F=H.value.filter(Pe=>!le.includes(Pe.name)&&!De.includes(Pe.name))}return F.slice().sort((le,De)=>le.name.localeCompare(De.name))}),rs=J(()=>Dt.value==="draw-area"&&tt.value?.polygon?.length>0||b.canCompleteFullscreen.value),ls=J(()=>{const F=[...S.value];return Dt.value==="place-checkpoint"&&Bn.value&&F.push({id:"temp-single",name:nt.value.name||"New Checkpoint",latitude:Bn.value.lat,longitude:Bn.value.lng,requiredMarshals:nt.value.requiredMarshals||1,assignments:[],isTemporary:!0}),Dt.value==="move-checkpoint"&&Bn.value&&$.value&&F.push({id:"temp-move",name:$.value.name+" (new position)",latitude:Bn.value.lat,longitude:Bn.value.lng,requiredMarshals:$.value.requiredMarshals,assignments:[],isTemporary:!0}),Dt.value==="add-multiple"&&F.push(...Jn.value),F}),cs=J(()=>{const F=[...at.value];if(Dt.value==="draw-area"&&tt.value?.polygon?.length>0){const le=F.findIndex(De=>De.id===tt.value.id);le>=0?F[le]={...tt.value}:F.push({...tt.value,id:tt.value.id||"temp-area"})}return F}),Os=()=>{o.push("/admin/dashboard")},li=()=>{o.push({name:"AdminProfile"})},Ot=(F=!0)=>{O.value=F},us=()=>{oe.value=!0},$n=async F=>{try{F&&(We.value={...F});const le=Ra(x.value.eventDate),De=We.value.eventDate;if(le!==De){const Pe=T.value.filter(_t=>_t.startTime||_t.endTime);if(Pe.length>0){j.value=le,Ve.value=De,Xe.value=Pe.length,ee.value=!0;return}}await ds(!1,null)}catch(le){console.error("Failed to update event:",le),alert("Failed to update event. Please try again.")}},ds=async(F,le)=>{try{if(await i.updateEvent(t.params.eventId,{...We.value,defaultCheckpointStyleMapRotation:We.value.defaultCheckpointStyleMapRotation!=null?String(We.value.defaultCheckpointStyleMapRotation):null}),F&&le!==null){const De=Math.floor(Math.abs(le)/1e3),Pe=le<0,_t=Math.floor(De/3600),Et=Math.floor(De%3600/60),tn=De%60,zs=`${Pe?"-":""}${_t.toString().padStart(2,"0")}:${Et.toString().padStart(2,"0")}:${tn.toString().padStart(2,"0")}`;await i.bulkUpdateLocationTimes(t.params.eventId,zs)}await rt(),oe.value=!1}catch(De){console.error("Failed to update event:",De),alert("Failed to update event. Please try again.")}},ci=async({shouldShift:F,timeDelta:le})=>{ee.value=!1,await ds(F,le)},Fn=()=>{ee.value=!1,rt()},rt=async()=>{try{await i.fetchEvent(t.params.eventId),x.value=i.currentEvent,x.value&&(We.value={name:x.value.name||"",description:x.value.description||"",eventDate:Ra(x.value.eventDate),timeZoneId:x.value.timeZoneId||"UTC",peopleTerm:x.value.peopleTerm||"Marshals",checkpointTerm:x.value.checkpointTerm||"Checkpoints",areaTerm:x.value.areaTerm||"Areas",checklistTerm:x.value.checklistTerm||"Checklists",courseTerm:x.value.courseTerm||"Course",defaultCheckpointStyleType:x.value.defaultCheckpointStyleType||"default",defaultCheckpointStyleColor:x.value.defaultCheckpointStyleColor||"",defaultCheckpointStyleBackgroundShape:x.value.defaultCheckpointStyleBackgroundShape||"",defaultCheckpointStyleBackgroundColor:x.value.defaultCheckpointStyleBackgroundColor||"",defaultCheckpointStyleBorderColor:x.value.defaultCheckpointStyleBorderColor||"",defaultCheckpointStyleIconColor:x.value.defaultCheckpointStyleIconColor||"",defaultCheckpointStyleSize:x.value.defaultCheckpointStyleSize||"",defaultCheckpointStyleMapRotation:x.value.defaultCheckpointStyleMapRotation??"",brandingHeaderGradientStart:x.value.brandingHeaderGradientStart||"",brandingHeaderGradientEnd:x.value.brandingHeaderGradientEnd||"",brandingLogoUrl:x.value.brandingLogoUrl||"",brandingLogoPosition:x.value.brandingLogoPosition||"",brandingAccentColor:x.value.brandingAccentColor||"",brandingPageGradientStart:x.value.brandingPageGradientStart||"",brandingPageGradientEnd:x.value.brandingPageGradientEnd||""},oe.value=!1,Rc(x.value));const F=await Promise.allSettled([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId),oo(),Lt(),to(),Un(),zn(),no()]);T.value=i.locations,S.value=i.eventStatus.locations,F.forEach((le,De)=>{le.status==="rejected"&&console.error(`Failed to load ${["locations","eventStatus","admins","marshals","areas","checklists","notes","contacts"][De]}:`,le.reason)})}catch(F){console.error("Failed to load event data:",F)}},Lt=async()=>{try{const F=await So.getByEvent(t.params.eventId);H.value=F.data}catch(F){console.error("Failed to load marshals:",F)}},to=async()=>{try{const F=await Ss.getByEvent(t.params.eventId);at.value=F.data}catch(F){console.error("Failed to load areas:",F)}},Un=async()=>{try{const[F,le]=await Promise.all([Pt.getByEvent(t.params.eventId),Pt.getReport(t.params.eventId)]);Nn.value=F.data,Ps.value=le.data}catch(F){console.error("Failed to load checklists:",F)}},zn=async()=>{try{const F=await Zo.getByEvent(t.params.eventId);Ao.value=F.data}catch(F){console.error("Failed to load notes:",F)}},no=async()=>{try{const[F,le]=await Promise.all([Ti.getByEvent(t.params.eventId),Ti.getRoles(t.params.eventId)]);Po.value=F.data,Qn.value=le.data}catch(F){console.error("Failed to load contacts:",F)}},lt=async()=>{await Promise.all([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId)]),T.value=i.locations,S.value=i.eventStatus.locations},Mt=async()=>{await Promise.all([Lt(),i.fetchEventStatus(t.params.eventId)]),S.value=i.eventStatus.locations},hs=async()=>{await Promise.all([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId),to()]),T.value=i.locations,S.value=i.eventStatus.locations},fs=async()=>{await i.fetchEventStatus(t.params.eventId),S.value=i.eventStatus.locations},Jt=()=>{tt.value=null,O.value=!1,St.value=!0},Rs=F=>{tt.value=F,$t.value=F.id,O.value=!1,St.value=!0},Hn=async F=>{try{if(tt.value&&tt.value.id){if(await Ss.update(t.params.eventId,tt.value.id,F),F.checklistChanges&&F.checklistChanges.length>0)for(const le of F.checklistChanges)try{le.complete?await Pt.complete(t.params.eventId,le.itemId,{marshalId:le.marshalId,contextType:le.contextType,contextId:le.contextId}):await Pt.uncomplete(t.params.eventId,le.itemId,{marshalId:le.marshalId,contextType:le.contextType,contextId:le.contextId})}catch(De){console.error("Failed to update checklist item:",le,De)}}else await Ss.create({eventId:t.params.eventId,...F});await to(),await rt(),Tt()}catch(le){console.error("Failed to save area:",le),alert(le.response?.data?.message||"Failed to save area. Please try again.")}},Vn=async F=>{f("Delete area","Are you sure you want to delete this area? Checkpoints will be automatically reassigned.",async()=>{try{await Ss.delete(t.params.eventId,F),await Ss.recalculate(t.params.eventId),await to(),await rt(),Tt()}catch(le){console.error("Failed to delete area:",le),alert(le.response?.data?.message||"Failed to delete area. Please try again.")}})},Tt=()=>{St.value=!1,tt.value=null,$t.value=null,O.value=!1,$o.value=!1,yt.value=null},V=F=>{Tt(),vn.value=null,eo.value="details",O.value=!1,mn.value=F,In.value=!0},G=F=>{vn.value=F,eo.value="details",O.value=!1,In.value=!0},ie=()=>{Tn.value=null,is.value="details",O.value=!1,Mo.value=!0},Me=(F,le="details")=>{Tn.value=F,is.value=le,O.value=!1,Mo.value=!0},Ge=async F=>{try{if(Tn.value&&Tn.value.itemId)await Pt.update(t.params.eventId,Tn.value.itemId,F);else{const le=await Pt.create(t.params.eventId,F);le.data.count&&le.data.count>1&&(Fe.value="Checklist Items Created",Ue.value=`Successfully created ${le.data.count} checklist items.`,Ne.value=!0)}await Un(),Rt()}catch(le){console.error("Failed to save checklist item:",le);const De=le.response?.data?.message||"Failed to save checklist item. Please try again.";alert(De)}},it=async F=>{f("Delete checklist item","Are you sure you want to delete this checklist item?",async()=>{try{await Pt.delete(t.params.eventId,F),await Un(),Rt()}catch(le){console.error("Failed to delete checklist item:",le),alert(le.response?.data?.message||"Failed to delete checklist item. Please try again.")}})},Rt=()=>{Mo.value=!1,Tn.value=null,O.value=!1},Vt=()=>{Ut.value=null,Eo.value="details",O.value=!1,Je.value=!0},en=F=>{Ut.value=F,Eo.value="details",O.value=!1,Je.value=!0},Bs=async F=>{try{Ut.value&&Ut.value.noteId?await Zo.update(t.params.eventId,Ut.value.noteId,F):await Zo.create(t.params.eventId,F),await zn(),di()}catch(le){console.error("Failed to save note:",le);const De=le.response?.data?.message||"Failed to save note. Please try again.";alert(De)}},ui=async F=>{f("Delete note","Are you sure you want to delete this note?",async()=>{try{await Zo.delete(t.params.eventId,F),await zn(),di()}catch(le){console.error("Failed to delete note:",le),alert(le.response?.data?.message||"Failed to delete note. Please try again.")}})},di=()=>{Je.value=!1,Ut.value=null,O.value=!1},ji=()=>{vn.value=null,eo.value="details",mn.value=null,O.value=!1,In.value=!0},Il=F=>{vn.value=F,eo.value="details",O.value=!1,In.value=!0},ut=async F=>{try{vn.value&&vn.value.contactId?await Ti.update(t.params.eventId,vn.value.contactId,F):await Ti.create(t.params.eventId,F),await no(),kt()}catch(le){console.error("Failed to save contact:",le);const De=le.response?.data?.message||"Failed to save contact. Please try again.";alert(De)}},Gn=async F=>{f("Delete contact","Are you sure you want to delete this contact?",async()=>{try{await Ti.delete(t.params.eventId,F),await no(),kt()}catch(le){console.error("Failed to delete contact:",le),alert(le.response?.data?.message||"Failed to delete contact. Please try again.")}})},kt=()=>{In.value=!1,vn.value=null,mn.value=null,O.value=!1},Wa=F=>{if(yt.value=F,St.value=!1,ce.value){const le=ce.value.getMapCenter(),De=ce.value.getMapZoom();le&&De!==null&&(mo.value=le,Io.value=De)}Yn.value=!0,Dt.value="draw-area",$o.value=!0,Rn.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},hi=F=>{yt.value?tt.value={...tt.value||{},...yt.value,polygon:F}:tt.value={...tt.value,polygon:F}},Wi=F=>{b.handlePolygonDrawing(F)},qi=()=>{$o.value=!1,yt.value&&(tt.value=yt.value,St.value=!0,yt.value=null)},oo=()=>E.loadEventAdmins(),Ki=async F=>{try{await E.addAdmin(F),await oo(),Gt()}catch(le){console.error("Failed to add admin:",le),alert(le.response?.data?.message||"Failed to add administrator. Please try again.")}},Ns=async F=>{f("Remove Administrator",`Remove ${F} as an administrator?`,async()=>{try{await E.removeAdmin(F),await oo()}catch(le){console.error("Failed to remove admin:",le),alert(le.response?.data?.message||"Failed to remove administrator. Please try again.")}})},Gt=()=>{E.closeAddAdminModal(),O.value=!1},Do=async F=>{await B.uploadRoute(F)&&(await lt(),Yi())},Yi=()=>{B.closeUploadRouteModal()},qa=async({file:F,deleteExisting:le})=>{const De=await B.importLocations(F,le);if(De){await hs(),Ka();const Pe=B.formatImportResultMessage(De,"location");Fe.value="Import Complete",Ue.value=Pe,Ne.value=!0}},Ka=()=>{B.closeImportLocationsModal()},Ya=async F=>{if(se.value)nt.value.latitude=F.lat,nt.value.longitude=F.lng;else if(re.value)ve.value.latitude=F.lat,ve.value.longitude=F.lng,$.value&&($.value={...$.value,latitude:F.lat,longitude:F.lng}),re.value=!1,we.value=!0,Ot();else if(xn.value)try{await i.createLocation({eventId:t.params.eventId,name:`Checkpoint ${To.value}`,description:"",latitude:F.lat,longitude:F.lng,requiredMarshals:1,what3Words:""}),To.value++,await rt()}catch(le){console.error("Failed to create checkpoint:",le),alert("Failed to create checkpoint. Please try again.")}},Ji=F=>{b.handleFullscreenMapClick(F)},$l=F=>{nt.value={...F}},Ja=()=>{se.value=!1,b.enterPlaceCheckpointMode()},mt=()=>{b.saveMapState(ce.value),nt.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},b.enterPlaceCheckpointMode()},Ml=()=>{b.saveMapState(ce.value),tt.value={id:null,name:"",description:"",color:"#667eea",polygon:[],checkpointIds:[],marshalIds:[],displayOrder:at.value.length},b.enterDrawAreaMode()},Mn=()=>{$.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},ve.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},W.value=[],me.value=[],O.value=!1,we.value=!0},Fs=()=>{const F=b.calculateStartingNumber(S);b.saveMapState(ce.value),b.enterAddMultipleMode(F)},Xa=()=>{if(Dt.value==="place-checkpoint"){const F=b.getPlacedCoords()||{lat:0,lng:0};$.value={id:null,name:"",description:"",latitude:F.lat,longitude:F.lng,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},ve.value={id:null,name:"",description:"",latitude:F.lat,longitude:F.lng,requiredMarshals:1,what3Words:""},W.value=[],me.value=[],O.value=!1,fi(),we.value=!0}else if(Dt.value==="move-checkpoint"){const F=b.getPlacedCoords();F&&(ve.value.latitude=F.lat,ve.value.longitude=F.lng,$.value&&($.value={...$.value,...Xn.value||{},latitude:F.lat,longitude:F.lng}),Ot()),Xn.value=null,fi(),we.value=!0}else if(Dt.value==="draw-area"){const F=b.getCompletedPolygon();F&&(yt.value?tt.value={...tt.value||{},...yt.value,polygon:F}:tt.value={...tt.value||{},polygon:F}),fi(),St.value=!0,yt.value=null}else Dt.value==="add-multiple"&&Al()},Al=async()=>{const F=b.getTempCheckpoints();try{for(const le of F)await i.createLocation({eventId:t.params.eventId,name:le.name,description:le.description,latitude:le.latitude,longitude:le.longitude,requiredMarshals:le.requiredMarshals,what3Words:le.what3Words});b.clearTempCheckpoints(),fi(),await rt()}catch(le){console.error("Failed to create checkpoints:",le),alert("Failed to create checkpoints. Please try again.")}},Xi=()=>{Dt.value==="draw-area"?yt.value&&(tt.value=yt.value,St.value=!0,yt.value=null):Dt.value==="move-checkpoint"&&(Xn.value&&$.value&&Object.assign($.value,Xn.value),we.value=!0,re.value=!1),b.cancelFullscreen()},fi=()=>{b.exitFullscreen()},Qa=F=>{pi(F)},pi=F=>{$.value=F,ve.value={id:F.id,name:F.name,description:F.description||"",latitude:F.latitude,longitude:F.longitude,requiredMarshals:F.requiredMarshals,what3Words:F.what3Words||""},W.value=[],me.value=[],O.value=!1,we.value=!0,setTimeout(()=>{ce.value?.scrollMapIntoView()},100)},El=async F=>{if(!Xr(F.what3Words)){alert("Invalid What3Words format. Please use word.word.word or word/word/word (lowercase letters only, 1-20 characters each)");return}try{await i.createLocation({eventId:t.params.eventId,...F}),await rt(),vi()}catch(le){console.error("Failed to save location:",le),alert("Failed to save location. Please try again.")}},vi=()=>{se.value=!1,nt.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},O.value=!1,O.value=!1},Qi=()=>{we.value=!1,$.value=null,re.value=!1,q.value=!1,Xn.value=null,ve.value={id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},W.value=[],me.value=[],O.value=!1},gn=()=>{q.value=!1},Pl=()=>{q.value=!0},er=F=>{if(F?.formData&&(Xn.value=F.formData),we.value=!1,Bn.value=null,ce.value){const De=ce.value.getMapCenter(),Pe=ce.value.getMapZoom();De&&Pe!==null&&(mo.value=De,Io.value=Pe)}const le=Xn.value?.name||$.value?.name;Yn.value=!0,Dt.value="move-checkpoint",Rn.value={title:`Move ${M.value.checkpoint}: ${le}`,description:"Click on the map to set the new location"}},yo=async F=>{if(!Xr(F.what3Words)){alert("Invalid What3Words format.");return}try{const le=!$.value.id;if(le){const De=await i.createLocation({eventId:t.params.eventId,name:F.name,description:F.description,latitude:F.latitude,longitude:F.longitude,requiredMarshals:F.requiredMarshals,what3Words:F.what3Words||null,startTime:F.startTime,endTime:F.endTime,styleType:F.styleType,styleColor:F.styleColor,styleBackgroundShape:F.styleBackgroundShape,styleBackgroundColor:F.styleBackgroundColor,styleBorderColor:F.styleBorderColor,styleIconColor:F.styleIconColor,styleSize:F.styleSize,styleMapRotation:F.styleMapRotation!=null?String(F.styleMapRotation):null,peopleTerm:F.peopleTerm,checkpointTerm:F.checkpointTerm,isDynamic:F.isDynamic||!1,locationUpdateScopeConfigurations:F.locationUpdateScopeConfigurations||[],pendingNewChecklistItems:F.pendingNewChecklistItems||[],pendingNewNotes:F.pendingNewNotes||[]});if(F.pendingAssignments&&F.pendingAssignments.length>0)for(const Pe of F.pendingAssignments)await i.createAssignment({eventId:t.params.eventId,locationId:De.id,marshalId:Pe.marshalId})}else{const De=$.value.id;if(await wn.update(t.params.eventId,De,{eventId:t.params.eventId,name:F.name,description:F.description,latitude:F.latitude,longitude:F.longitude,requiredMarshals:F.requiredMarshals,what3Words:F.what3Words||null,startTime:F.startTime,endTime:F.endTime,styleType:F.styleType,styleColor:F.styleColor,styleBackgroundShape:F.styleBackgroundShape,styleBackgroundColor:F.styleBackgroundColor,styleBorderColor:F.styleBorderColor,styleIconColor:F.styleIconColor,styleSize:F.styleSize,styleMapRotation:F.styleMapRotation!=null?String(F.styleMapRotation):null,peopleTerm:F.peopleTerm,checkpointTerm:F.checkpointTerm,isDynamic:F.isDynamic||!1,locationUpdateScopeConfigurations:F.locationUpdateScopeConfigurations||[]}),F.pendingNewChecklistItems&&F.pendingNewChecklistItems.length>0)for(const Pe of F.pendingNewChecklistItems)Pe.text?.trim()&&await Pt.create(t.params.eventId,{text:Pe.text,scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[De]}],displayOrder:0,isRequired:!1});if(F.pendingNewNotes&&F.pendingNewNotes.length>0)for(const Pe of F.pendingNewNotes)!Pe.title?.trim()&&!Pe.content?.trim()||await Zo.create(t.params.eventId,{title:Pe.title||"Untitled",content:Pe.content||"",scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[De]}],displayOrder:0,priority:"Normal",isPinned:!1});for(const Pe of me.value)await i.deleteAssignment(t.params.eventId,Pe);for(const Pe of W.value)await i.createAssignment({eventId:t.params.eventId,locationId:$.value.id,marshalId:Pe.marshalId});if(F.checkInChanges&&F.checkInChanges.length>0)for(const Pe of F.checkInChanges){const _t=$.value.assignments.find(Et=>Et.id===Pe.assignmentId);_t&&_t.isCheckedIn!==Pe.shouldBeCheckedIn&&await Yo.adminCheckIn(t.params.eventId,Pe.assignmentId)}}if(!le&&F.checklistChanges&&F.checklistChanges.length>0)for(const De of F.checklistChanges)try{De.complete?await Pt.complete(t.params.eventId,De.itemId,{marshalId:De.marshalId,contextType:De.contextType,contextId:De.contextId}):await Pt.uncomplete(t.params.eventId,De.itemId,{marshalId:De.marshalId,contextType:De.contextType,contextId:De.contextId})}catch(Pe){console.error("Failed to update checklist item:",De,Pe)}await rt(),Qi()}catch(le){console.error("Failed to update location:",le),alert("Failed to update location. Please try again.")}},tr=async F=>{f("Delete location","Are you sure you want to delete this location?",async()=>{try{await wn.delete(t.params.eventId,F),await hs(),Qi()}catch(le){console.error("Failed to delete location:",le),alert("Failed to delete location. Please try again.")}})},nr=F=>{const le=F?.id??F;if(le?.toString().startsWith("temp-")){const De=$.value.assignments.find(Pe=>Pe.id===le);De&&(W.value=W.value.filter(Pe=>Pe.marshalId!==De.marshalId)),$.value.assignments=$.value.assignments.filter(Pe=>Pe.id!==le),Ot()}else me.value.includes(le)||(me.value.push(le),$.value.assignments=$.value.assignments.filter(De=>De.id!==le),Ot())},ea=async F=>{const le=H.value.find(Pe=>Pe.id===F);if(!le)return;const De=S.value.filter(Pe=>Pe.assignments?.some(_t=>_t.marshalId===F&&Pe.id!==$.value.id));if(De.length>0){Le.value={marshalName:le.name,locations:De.map(_t=>_t.name),marshal:le};const Pe=await new Promise(_t=>{U.value=_t,fe.value=!0});if(Pe==="cancel"||Pe==="choose-other")return;if(Pe==="move")for(const _t of De){const Et=_t.assignments.find(tn=>tn.marshalId===F);if(Et){me.value.push(Et.id);const tn=S.value.findIndex(zs=>zs.id===_t.id);tn!==-1&&(S.value[tn].assignments=S.value[tn].assignments.filter(zs=>zs.id!==Et.id))}}}W.value.push({marshalId:le.id,marshalName:le.name}),$.value.assignments||($.value.assignments=[]),$.value.assignments.push({id:`temp-${Date.now()}`,marshalId:le.id,marshalName:le.name,locationId:$.value.id,isCheckedIn:!1,isPending:!0}),Ot(),gn()},Dl=async F=>{try{const De=(await So.create({eventId:t.params.eventId,name:F.name,email:F.email,phoneNumber:F.phoneNumber})).data;await Lt(),W.value.push({marshalId:De.id,marshalName:De.name}),$.value&&($.value.assignments||($.value.assignments=[]),$.value.assignments.push({id:`temp-${Date.now()}`,marshalId:De.id,marshalName:De.name,locationId:$.value.id,isCheckedIn:!1,isPending:!0})),Ot(),gn()}catch(le){console.error("Failed to create marshal:",le),alert("Failed to create marshal. Please try again.")}},or=()=>{Z.value=null,N.value={id:"",name:"",email:"",phoneNumber:"",notes:""},$e.value=[],ke.value=[],O.value=!1,Y.value=!0},sr=F=>{Z.value=F,N.value={id:F.id,name:F.name,email:F.email||"",phoneNumber:F.phoneNumber||"",notes:F.notes||""},$e.value=[],ke.value=[],O.value=!1,Y.value=!0},ir=()=>{if(!Z.value)return[];const F=[];return S.value.forEach(le=>{le.assignments.filter(Pe=>Pe.marshalName===Z.value.name).forEach(Pe=>{F.push({...Pe,locationName:le.name})})}),F},Ol=async F=>{try{let le=Z.value?.id,De=!1;if(Z.value){if(await So.update(t.params.eventId,Z.value.id,{name:F.name,email:F.email,phoneNumber:F.phoneNumber,notes:F.notes}),F.pendingNewChecklistItems&&F.pendingNewChecklistItems.length>0)for(const Pe of F.pendingNewChecklistItems)Pe.text?.trim()&&await Pt.create(t.params.eventId,{text:Pe.text,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[le]}],displayOrder:0,isRequired:!1});if(F.pendingNewNotes&&F.pendingNewNotes.length>0)for(const Pe of F.pendingNewNotes)!Pe.title?.trim()&&!Pe.content?.trim()||await Zo.create(t.params.eventId,{title:Pe.title||"Untitled",content:Pe.content||"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[le]}],displayOrder:0,priority:"Normal",isPinned:!1})}else le=(await So.create({eventId:t.params.eventId,name:F.name,email:F.email,phoneNumber:F.phoneNumber,notes:F.notes,pendingNewChecklistItems:F.pendingNewChecklistItems||[],pendingNewNotes:F.pendingNewNotes||[]})).data.id,De=!0;for(const Pe of ke.value)await i.deleteAssignment(t.params.eventId,Pe);for(const Pe of $e.value)await i.createAssignment({eventId:t.params.eventId,locationId:Pe.locationId,marshalId:le});if(F.pendingAssignments&&F.pendingAssignments.length>0)for(const Pe of F.pendingAssignments)await i.createAssignment({eventId:t.params.eventId,locationId:Pe.locationId,marshalId:le});if(F.checkInChanges&&F.checkInChanges.length>0){const Pe=ir();for(const _t of F.checkInChanges){const Et=Pe.find(tn=>tn.id===_t.assignmentId);Et&&Et.isCheckedIn!==_t.shouldBeCheckedIn&&await Yo.adminCheckIn(t.params.eventId,_t.assignmentId)}}if(F.checklistChanges&&F.checklistChanges.length>0)for(const Pe of F.checklistChanges)try{const _t={marshalId:le};Pe.contextType&&Pe.contextId&&(_t.contextType=Pe.contextType,_t.contextId=Pe.contextId),Pe.complete?await Pt.complete(t.params.eventId,Pe.itemId,_t):await Pt.uncomplete(t.params.eventId,Pe.itemId,_t)}catch(_t){console.error("Failed to process checklist change:",_t);const Et=_t.response?.data?.message||"Failed to update checklist item";alert(`Error: ${Et}`)}await rt(),ps(),De&&(pe.value=le,Ie.value=F.name,ae.value=!0)}catch(le){console.error("Failed to save marshal:",le),alert("Failed to save marshal. Please try again.")}},mi=async F=>{const le=F||Z.value?.id;if(!le){console.error("No marshal ID to delete");return}const De=M.value.person;f(`Delete ${De}`,`Are you sure you want to delete this ${De}?`,async()=>{try{await So.delete(t.params.eventId,le),await Mt(),ps()}catch(Pe){console.error(`Failed to delete ${De}:`,Pe),alert(`Failed to delete ${De}. Please try again.`)}})},Rl=F=>{mi(F.id)},ar=F=>{ke.value.includes(F)||(ke.value.push(F),Ot())},rr=F=>{$e.value.push({locationId:F}),Ot()},ps=()=>{Y.value=!1,Z.value=null,N.value={id:"",name:"",email:"",phoneNumber:"",notes:""},$e.value=[],ke.value=[],O.value=!1},Oo=async({file:F})=>{const le=await B.importMarshals(F);if(le){await Mt(),lr();const De=B.formatImportResultMessage(le,"marshal");Fe.value="Import Complete",Ue.value=De,Ne.value=!0}},lr=()=>{B.closeImportMarshalsModal()},Us=F=>{U.value&&(U.value(F),U.value=null),fe.value=!1},yn=async({assignment:F,status:le})=>{try{if(le==="not-checked-in"?F.isCheckedIn&&await Yo.adminCheckIn(t.params.eventId,F.id):F.isCheckedIn||await Yo.adminCheckIn(t.params.eventId,F.id),await fs(),$.value){const De=S.value.find(Pe=>Pe.id===$.value.id);De&&($.value=De)}}catch(De){console.error("Failed to change assignment status:",De),alert("Failed to change status. Please try again.")}};let vs=null;const ta=async()=>{try{const F=t.params.eventId,le=await wn.getDynamicCheckpoints(F);if(le.data&&Array.isArray(le.data))for(const De of le.data){const Pe=S.value.find(_t=>_t.id===De.checkpointId);Pe&&(Pe.latitude=De.latitude,Pe.longitude=De.longitude,Pe.lastLocationUpdate=De.lastLocationUpdate)}}catch(F){console.warn("Failed to poll dynamic checkpoints:",F)}},cr=()=>{vs||!S.value.some(le=>le.isDynamic||le.IsDynamic)||(ta(),vs=setInterval(ta,6e4))},gi=()=>{vs&&(clearInterval(vs),vs=null)};return qe(a,F=>{F==="course"?cr():gi()}),Qt(async()=>{await rt();try{const F=await Lo.getMe(t.params.eventId);Ds.value=F.data}catch(F){console.warn("Failed to fetch user claims:",F)}a.value==="course"&&cr()}),po(()=>{gi()}),(F,le)=>(m(),g("div",{class:"admin-event-manage",style:st({colorScheme:z(A)})},[c("header",u6,[c("div",d6,[c("button",{onClick:Os,class:"btn-back",title:"Back to Dashboard"}," Dashboard"),x.value?(m(),g("div",h6,[c("h1",null,_(x.value.name),1),c("p",f6,_(z(Bp)(x.value.eventDate)),1)])):R("",!0)]),c("div",p6,[ze(Op),Vi.value?(m(),g("button",{key:0,onClick:Gi,class:"btn btn-marshal-mode"}," Switch to Marshal ")):R("",!0),c("button",{onClick:li,class:"btn btn-secondary"},"Profile")])]),c("div",v6,[c("div",m6,[ze(Jx,{tabs:C.value,"model-value":z(a),"onUpdate:modelValue":z(l)},null,8,["tabs","model-value","onUpdate:modelValue"])]),c("div",g6,[z(a)==="course"?(m(),ct(Vw,{key:0,ref_key:"courseAreasTab",ref:ce,checkpoints:S.value,areas:at.value,route:x.value?.route||[],"selected-area-id":$t.value,"drawing-mode":z($o),onMapClick:Ya,onLocationClick:Qa,onAreaClick:Rs,onImportCheckpoints:le[0]||(le[0]=De=>ue.value=!0),onUploadRoute:le[1]||(le[1]=De=>he.value=!0),onSelectLocation:pi,onAddArea:Jt,onSelectArea:Rs,onPolygonComplete:hi,onCancelDrawing:qi,onAddCheckpointFromMap:mt,onAddManyCheckpointsFromMap:Fs,onAddAreaFromMap:Ml},null,8,["checkpoints","areas","route","selected-area-id","drawing-mode"])):R("",!0),z(a)==="checkpoints"?(m(),g("div",y6,[ze(Ix,{locations:S.value,areas:at.value,onAddCheckpointManually:Mn,onImportCheckpoints:le[2]||(le[2]=De=>ue.value=!0),onSelectLocation:pi},null,8,["locations","areas"])])):R("",!0),z(a)==="areas"?(m(),g("div",_6,[ze(zx,{areas:at.value,checkpoints:S.value,contacts:Po.value,"event-people-term":x.value?.peopleTerm||"Marshals","event-checkpoint-term":x.value?.checkpointTerm||"Checkpoints",onAddArea:Jt,onSelectArea:Rs},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term"])])):R("",!0),z(a)==="marshals"?(m(),ct(f0,{key:3,marshals:H.value,assignments:as.value,locations:S.value,onAddMarshal:or,onImportMarshals:le[3]||(le[3]=De=>te.value=!0),onSelectMarshal:sr,onDeleteMarshal:Rl,onChangeAssignmentStatus:yn},null,8,["marshals","assignments","locations"])):R("",!0),z(a)==="checklists"?(m(),ct(j0,{key:4,"checklist-items":Nn.value,areas:at.value,locations:S.value,marshals:H.value,"completion-report":Ps.value,onAddChecklistItem:ie,onSelectChecklistItem:Me},null,8,["checklist-items","areas","locations","marshals","completion-report"])):R("",!0),z(a)==="notes"?(m(),ct(yC,{key:5,notes:Ao.value,areas:at.value,locations:S.value,marshals:H.value,onAddNote:Vt,onSelectNote:en},null,8,["notes","areas","locations","marshals"])):R("",!0),z(a)==="contacts"?(m(),ct(HC,{key:6,contacts:Po.value,areas:at.value,locations:S.value,marshals:H.value,"available-roles":Qn.value,onAddContact:ji,onSelectContact:Il},null,8,["contacts","areas","locations","marshals","available-roles"])):R("",!0),z(a)==="details"?(m(),ct(eL,{key:7,"event-data":We.value,"form-dirty":oe.value,onSubmit:$n,"onUpdate:formDirty":us},null,8,["event-data","form-dirty"])):R("",!0),z(a)==="settings"?(m(),ct(hx,{key:8,"event-data":We.value,"event-id":z(t).params.eventId,admins:z(Be),"form-dirty":oe.value,onSubmit:$n,onAddAdmin:le[4]||(le[4]=De=>Se.value=!0),onRemoveAdmin:Ns,"onUpdate:formDirty":us},null,8,["event-data","event-id","admins","form-dirty"])):R("",!0)])]),ze(c6,{show:se.value,location:nt.value,"is-dirty":O.value,onClose:vi,onSave:El,onSetOnMap:Ja,"onUpdate:isDirty":Ot,"onUpdate:location":$l},null,8,["show","location","is-dirty"]),ze(jA,{show:we.value,location:$.value,assignments:$.value?.assignments||[],"event-date":x.value?.eventDate||"",areas:at.value,"event-id":z(t).params.eventId,"all-locations":S.value,notes:Ao.value,"available-marshals":Yt.value,"all-checklist-items":Nn.value,"is-dirty":O.value,"event-default-style-type":x.value?.defaultCheckpointStyleType||x.value?.DefaultCheckpointStyleType||"default","event-default-style-color":x.value?.defaultCheckpointStyleColor||x.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":x.value?.defaultCheckpointStyleBackgroundShape||x.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":x.value?.defaultCheckpointStyleBackgroundColor||x.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":x.value?.defaultCheckpointStyleBorderColor||x.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":x.value?.defaultCheckpointStyleIconColor||x.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":x.value?.defaultCheckpointStyleSize||x.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":x.value?.defaultCheckpointStyleMapRotation??x.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":x.value?.peopleTerm||"Marshals","z-index":St.value?1100:1e3,onClose:Qi,onSave:yo,onDelete:tr,onMoveLocation:er,onRemoveAssignment:nr,onOpenAssignModal:Pl,"onUpdate:isDirty":Ot},null,8,["show","location","assignments","event-date","areas","event-id","all-locations","notes","available-marshals","all-checklist-items","is-dirty","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","z-index"]),ze(tT,{show:_e.value,link:Zi.value,"is-dirty":!1,onClose:le[5]||(le[5]=De=>_e.value=!1)},null,8,["show","link"]),ze(vT,{show:ae.value,"event-id":z(t).params.eventId,"marshal-id":pe.value,"marshal-name":Ie.value,onClose:le[6]||(le[6]=De=>ae.value=!1)},null,8,["show","event-id","marshal-id","marshal-name"]),ze(yT,{show:z(Se),"is-dirty":O.value,onClose:Gt,onSubmit:Ki,"onUpdate:isDirty":Ot},null,8,["show","is-dirty"]),ze(CT,{show:z(he),uploading:z(Q),error:z(X),"is-dirty":O.value,onClose:Yi,onSubmit:Do,"onUpdate:isDirty":Ot},null,8,["show","uploading","error","is-dirty"]),ze(PT,{show:z(ue),importing:z(be),error:z(ne),result:z(Ee),"is-dirty":O.value,onClose:Ka,onSubmit:qa,"onUpdate:isDirty":Ot},null,8,["show","importing","error","result","is-dirty"]),ze(KP,{show:Y.value,marshal:Z.value,"event-id":z(t).params.eventId,assignments:ir(),"available-locations":go.value,"all-locations":S.value,areas:at.value,"is-editing":!!Z.value,"event-notes":Ao.value,"all-checklist-items":Nn.value,"is-dirty":O.value,onClose:ps,onSave:Ol,onDelete:mi,onRemoveAssignment:ar,onAssignToLocation:rr,"onUpdate:isDirty":Ot},null,8,["show","marshal","event-id","assignments","available-locations","all-locations","areas","is-editing","event-notes","all-checklist-items","is-dirty"]),ze(zT,{show:z(te),importing:z(Oe),error:z(ne),result:z(xe),"is-dirty":O.value,onClose:lr,onSubmit:Oo,"onUpdate:isDirty":Ot},null,8,["show","importing","error","result","is-dirty"]),ze(QP,{show:fe.value,"conflict-data":Le.value,onClose:le[7]||(le[7]=De=>fe.value=!1),onChoice:Us},null,8,["show","conflict-data"]),ze(c4,{show:q.value,"location-name":$.value?.name||"",marshals:Yt.value,onClose:gn,onAssignExisting:ea,onCreateAndAssign:Dl},null,8,["show","location-name","marshals"]),ze(b4,{show:ee.value,"old-event-date":j.value,"new-event-date":Ve.value,"affected-checkpoints-count":Xe.value,onConfirm:ci,onCancel:Fn},null,8,["show","old-event-date","new-event-date","affected-checkpoints-count"]),ze(G3,{show:St.value,area:tt.value,checkpoints:S.value,marshals:H.value,areas:at.value,"is-dirty":O.value,"event-id":z(t).params.eventId,"all-locations":S.value,assignments:as.value,notes:Ao.value,contacts:Po.value,"event-default-style-type":x.value?.defaultCheckpointStyleType||x.value?.DefaultCheckpointStyleType||"default","event-default-style-color":x.value?.defaultCheckpointStyleColor||x.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":x.value?.defaultCheckpointStyleBackgroundShape||x.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":x.value?.defaultCheckpointStyleBackgroundColor||x.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":x.value?.defaultCheckpointStyleBorderColor||x.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":x.value?.defaultCheckpointStyleIconColor||x.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":x.value?.defaultCheckpointStyleSize||x.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":x.value?.defaultCheckpointStyleMapRotation??x.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":x.value?.peopleTerm||"Marshals","event-checkpoint-term":x.value?.checkpointTerm||"Checkpoints",onClose:Tt,onSave:Hn,onDelete:Vn,onDrawBoundary:Wa,"onUpdate:isDirty":Ot,onSelectCheckpoint:pi,onAddAreaContact:V,onEditContact:G},null,8,["show","area","checkpoints","marshals","areas","is-dirty","event-id","all-locations","assignments","notes","contacts","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","event-checkpoint-term"]),ze(tD,{show:Mo.value,"checklist-item":Tn.value,"initial-tab":is.value,areas:at.value,locations:S.value,marshals:H.value,"is-dirty":O.value,onClose:Rt,onSave:Ge,onDelete:it,"onUpdate:isDirty":Ot},null,8,["show","checklist-item","initial-tab","areas","locations","marshals","is-dirty"]),ze(mD,{show:Je.value,note:Ut.value,"initial-tab":Eo.value,areas:at.value,locations:S.value,marshals:H.value,"is-dirty":O.value,onClose:di,onSave:Bs,onDelete:ui,"onUpdate:isDirty":Ot},null,8,["show","note","initial-tab","areas","locations","marshals","is-dirty"]),ze(ND,{show:In.value,contact:vn.value,"initial-tab":eo.value,areas:at.value,locations:S.value,marshals:H.value,"available-roles":Qn.value,"is-dirty":O.value,"preselected-area":mn.value,onClose:kt,onSave:ut,onDelete:Gn,"onUpdate:isDirty":Ot},null,8,["show","contact","initial-tab","areas","locations","marshals","available-roles","is-dirty","preselected-area"]),ze(XD,{show:z(Yn),mode:z(Dt),"context-title":z(Rn).title,"context-description":z(Rn).description,"can-complete":rs.value,clickable:z(Dt)!=="draw-area","drawing-mode":z(Dt)==="draw-area"&&z($o),locations:ls.value,areas:cs.value,route:x.value?.route||[],"selected-area-id":$t.value,center:z(mo),zoom:z(Io),onMapClick:Ji,onPolygonComplete:hi,onPolygonDrawing:Wi,onDone:Xa,onCancel:Xi},null,8,["show","mode","context-title","context-description","can-complete","clickable","drawing-mode","locations","areas","route","selected-area-id","center","zoom"]),ze(Tl,{show:Ne.value,title:Fe.value,message:Ue.value,onClose:le[8]||(le[8]=De=>Ne.value=!1)},null,8,["show","title","message"]),ze(Ll,{show:z(u),title:z(h),message:z(p),onConfirm:z(y),onCancel:z(k)},null,8,["show","title","message","onConfirm","onCancel"])],4))}},b6=Ye(k6,[["__scopeId","data-v-a3b73180"]]),w6={key:0,class:"emergency-notes-section"},C6={class:"emergency-notes-list"},L6={class:"note-header"},S6={key:0,class:"note-content"},x6={key:1,class:"emergency-contacts-section"},T6={class:"emergency-contacts-list"},I6={class:"contact-header"},$6={key:0,class:"role-badge"},M6={class:"contact-details"},A6={key:0,class:"info-section"},E6=["href"],P6={key:1,class:"info-section"},D6=["href"],O6={key:2,class:"info-section"},R6=["href"],B6={key:2,class:"no-contacts"},N6={__name:"EmergencyContactModal",props:{show:{type:Boolean,default:!1},contacts:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const o=e,i=t,s=J(()=>o.notes?[...o.notes].sort((u,h)=>{const p=u.priority||u.Priority,f=h.priority||h.Priority;return p==="Emergency"&&f!=="Emergency"?-1:f==="Emergency"&&p!=="Emergency"?1:0}):[]),a=()=>{i("close")},l=u=>u?{EmergencyContact:"Emergency Contact",EventDirector:"Event Director",MedicalLead:"Medical Lead",SafetyOfficer:"Safety Officer",Logistics:"Logistics"}[u]||u.replace(/([A-Z])/g," $1").trim():"";return(u,h)=>(m(),ct(Ht,{show:e.show,title:"Emergency information",size:"medium",onClose:a},{actions:et(()=>[c("button",{onClick:a,class:"btn btn-secondary"},"Close")]),default:et(()=>[e.notes&&e.notes.length>0?(m(),g("div",w6,[h[0]||(h[0]=c("h2",{class:"section-header"},"Emergency notes",-1)),c("div",C6,[(m(!0),g(Ce,null,Re(s.value,p=>(m(),g("div",{key:p.noteId||p.NoteId,class:Te(["emergency-note-item",{"is-emergency":(p.priority||p.Priority)==="Emergency"}])},[c("div",L6,[c("h3",null,_(p.title||p.Title),1),c("span",{class:Te(["priority-badge",(p.priority||p.Priority).toLowerCase()])},_(p.priority||p.Priority),3)]),p.content||p.Content?(m(),g("div",S6,_(p.content||p.Content),1)):R("",!0)],2))),128))])])):R("",!0),e.contacts&&e.contacts.length>0?(m(),g("div",x6,[h[4]||(h[4]=c("h2",{class:"section-header"},"Emergency contacts",-1)),c("div",T6,[(m(!0),g(Ce,null,Re(e.contacts,p=>(m(),g("div",{key:p.contactId||p.name,class:"emergency-contact-item"},[c("div",I6,[c("h3",null,_(p.name),1),p.role?(m(),g("span",$6,_(l(p.role)),1)):R("",!0)]),c("div",M6,[p.phone?(m(),g("div",A6,[h[1]||(h[1]=c("label",null,"Phone number",-1)),c("a",{href:`tel:${p.phone}`,class:"phone-link"},_(p.phone),9,E6)])):R("",!0),p.email?(m(),g("div",P6,[h[2]||(h[2]=c("label",null,"Email",-1)),c("a",{href:`mailto:${p.email}`,class:"email-link"},_(p.email),9,D6)])):R("",!0),p.notes||p.details?(m(),g("div",O6,[h[3]||(h[3]=c("label",null,"Details",-1)),c("p",null,_(p.notes||p.details),1)])):R("",!0)]),p.phone?(m(),g("a",{key:0,href:`tel:${p.phone}`,class:"btn btn-danger btn-full"}," Call "+_(p.name),9,R6)):R("",!0)]))),128))])])):R("",!0),(!e.contacts||e.contacts.length===0)&&(!e.notes||e.notes.length===0)?(m(),g("div",B6,[...h[5]||(h[5]=[c("p",null,"No emergency information has been set up for this event.",-1)])])):R("",!0)]),_:1},8,["show"]))}},F6=Ye(N6,[["__scopeId","data-v-3f42c790"]]),$r=P(navigator.onLine),xs=P(!0),ti=P(0),Mr=P(null),Js=P("idle"),Di=P(null);let bh=null,uc=!1,ao=null;function U6(e=1e3,t=1e4){return Math.floor(Math.random()*(t-e+1))+e}function Uc(){ao&&(clearTimeout(ao),ao=null);const e=U6(1e3,1e4);console.log(`Scheduling auto-sync in ${e}ms`),ao=setTimeout(async()=>{if(ao=null,!navigator.onLine){console.log("Auto-sync cancelled: offline");return}if(await Jr()===0){console.log("Auto-sync cancelled: no pending actions");return}console.log("Starting auto-sync..."),await el();const o=await Jr();o>0&&navigator.onLine&&(console.log(`${o} actions remaining, scheduling retry...`),Uc())},e)}async function ma(){if(!navigator.onLine)return xs.value=!1,!1;try{return await ik.check(),xs.value=!0,!0}catch(e){return e.response?.status===404?(xs.value=!0,!0):(e.code==="ECONNABORTED"&&console.warn("Server health check timed out"),xs.value=!1,!1)}}async function z6(e){try{switch(e.type){case"checkin":await Yo.checkIn(e.payload);break;case"checkin_admin":await Yo.adminCheckIn(e.payload.eventId,e.payload.assignmentId);break;case"checklist_complete":await Pt.complete(e.payload.eventId,e.payload.itemId,e.payload.data);break;case"checklist_uncomplete":await Pt.uncomplete(e.payload.eventId,e.payload.itemId,e.payload.data);break;default:return console.warn("Unknown action type:",e.type),!1}return!0}catch(t){return console.error("Failed to sync action:",e,t),t.response&&t.response.status>=400&&t.response.status<500?"permanent_failure":!1}}async function el(){if(!uc&&navigator.onLine){uc=!0,Js.value="syncing",Di.value=null;try{const e=await Mp();if(e.length===0){Js.value="success",ti.value=0;return}let t=0,o=0;for(const i of e){const s=await z6(i);if(s===!0)await uh(i.id),t++;else if(s==="permanent_failure")await uh(i.id),o++;else{const a=(i.attempts||0)+1;a>=5?(await ch(i.id,{status:"failed",attempts:a,lastAttempt:new Date().toISOString()}),o++):await ch(i.id,{status:"retrying",attempts:a,lastAttempt:new Date().toISOString()})}}ti.value=await Jr(),o>0?(Js.value="error",Di.value=`${o} action(s) failed to sync`):Js.value="success"}catch(e){console.error("Sync error:",e),Js.value="error",Di.value="Failed to sync pending actions"}finally{uc=!1}}}function H6(){bh||(bh=setInterval(async()=>{navigator.onLine&&(await ma(),xs.value&&ti.value>0&&await el())},3e4))}function mu(){const e=J(()=>$r.value&&xs.value);async function t(){ti.value=await Jr()}async function o(){$r.value=!0,await ma()&&ti.value>0&&Uc()}function i(){$r.value=!1,xs.value=!1,ao&&(clearTimeout(ao),ao=null)}Qt(async()=>{await ss(),await t(),window.addEventListener("online",o),window.addEventListener("offline",i),navigator.onLine&&await ma()&&ti.value>0&&Uc(),H6()}),po(()=>{window.removeEventListener("online",o),window.removeEventListener("offline",i),ao&&(clearTimeout(ao),ao=null)});async function s(h,p){if(!e.value)return console.warn("Cannot refresh cache while offline"),!1;try{const f=await p();return await Oa(h,f),Mr.value=new Date().toISOString(),!0}catch(f){return console.error("Failed to refresh cache:",f),!1}}async function a(h){const p=await Is(h);return p&&(Mr.value=p.cachedAt),p}async function l(h){Mr.value=await Q1(h)}async function u(){return navigator.onLine?await ma()?(await el(),Js.value==="success"):(Di.value="Server is not responding",!1):(Di.value="Cannot sync while offline",!1)}return{isOnline:$r,isServerHealthy:xs,isFullyOnline:e,pendingActionsCount:ti,lastSyncTime:Mr,syncStatus:Js,syncError:Di,checkServerHealth:ma,syncPendingActions:el,updatePendingCount:t,refreshCache:s,getCachedData:a,loadLastSyncTime:l,forcSync:u}}const V6={class:"area-lead-content"},G6={key:0,class:"loading-state"},Z6={key:1,class:"error-state"},j6={key:2,class:"empty-state"},W6={key:3,class:"checkpoint-accordion"},q6=["onClick"],K6={class:"checkpoint-header-content"},Y6={class:"checkpoint-title-row"},J6={class:"checkpoint-name"},X6={key:0,class:"area-badge"},Q6={key:0,class:"checkpoint-description-preview"},eO={class:"checkpoint-status-row"},tO={class:"status-badge marshals-status"},nO={key:0,class:"status-badge tasks-status"},oO={class:"accordion-icon"},sO={key:0,class:"checkpoint-accordion-content"},iO={class:"checkpoint-mini-map"},aO={class:"checkpoint-marshals-section"},rO={class:"marshals-label"},lO={key:0,class:"empty-state"},cO={key:1,class:"marshals-list"},uO=["onClick"],dO={class:"marshal-header"},hO={class:"marshal-name-row"},fO={class:"marshal-name"},pO={key:0,class:"task-count"},vO={class:"check-status-row"},mO=["onClick","disabled"],gO={key:0,class:"check-in-time"},yO={key:0},_O={key:1,class:"last-access-time"},kO={key:0,class:"checkpoint-tasks-section"},bO={class:"marshals-label"},wO={class:"tasks-list"},CO=["disabled","onChange"],LO={class:"task-text"},SO={key:0,class:"marshal-details-modal"},xO={class:"details-section"},TO={class:"contact-info"},IO={key:0,class:"contact-row"},$O=["href"],MO={key:1,class:"contact-row"},AO=["href"],EO={key:2,class:"no-contact"},PO={class:"details-section"},DO={key:0,class:"checked-in-section"},OO={class:"checked-in-details"},RO={class:"check-time-detail"},BO={key:0,class:"check-method"},NO=["disabled"],FO={key:1,class:"not-checked-in-section"},UO=["disabled"],zO={key:2,class:"last-access-detail"},HO={class:"details-section"},VO={key:0,class:"no-tasks"},GO={key:1,class:"tasks-list modal-tasks"},ZO=["disabled","onChange"],jO={class:"task-text"},WO={class:"details-section contact-actions-section"},qO={class:"contact-buttons"},KO=["href"],YO=["href"],JO=["href"],XO={__name:"AreaLeadSection",props:{eventId:{type:String,required:!0},areaIds:{type:Array,default:()=>[]},marshalId:{type:String,required:!0},route:{type:Array,default:()=>[]}},emits:["checklist-updated","loaded","checkin-updated"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=Ct(),{updatePendingCount:a}=mu(),l=e,u=o,h=P(!1),p=P(null),f=P([]),y=P([]),k=P(null),I=P(!1),M=P(null),b=J(()=>[...y.value].sort((Q,X)=>Cn(Q.name,X.name))),B=(Q,X=60)=>Q?Q.length<=X?Q:Q.substring(0,X).trim()+"...":"";t({areas:f,checkpoints:y,loading:h});const E=P(!1),A=P(null),C=P(null),x=async()=>{if(!(!l.eventId||l.areaIds.length===0)){if(h.value=!0,p.value=null,on()){try{const Q=await Is(l.eventId);if(Q?.areaLeadDashboard){f.value=Q.areaLeadDashboard.areas||[],y.value=Q.areaLeadDashboard.checkpoints||[],h.value=!1;return}}catch(Q){console.warn("Failed to load cached dashboard:",Q)}p.value="Offline - no cached data available",h.value=!1;return}try{const Q=await Ss.getAreaLeadDashboard(l.eventId);f.value=Q.data.areas||[],y.value=Q.data.checkpoints||[];try{const X=JSON.parse(JSON.stringify({areas:f.value,checkpoints:y.value}));await Is(l.eventId)?await fa(l.eventId,"areaLeadDashboard",X):await Oa(l.eventId,{areaLeadDashboard:X})}catch(X){console.warn("Failed to cache dashboard:",X)}}catch(Q){console.error("Failed to load area lead dashboard:",Q);try{const X=await Is(l.eventId);if(X?.areaLeadDashboard){console.log("Loading area lead dashboard from cache after error"),f.value=X.areaLeadDashboard.areas||[],y.value=X.areaLeadDashboard.checkpoints||[],h.value=!1;return}}catch(X){console.warn("Failed to load cached dashboard:",X)}p.value=Q.response?.data?.message||"Failed to load dashboard"}finally{h.value=!1}}},T=Q=>{k.value=k.value===Q?null:Q},S=Q=>Q.marshals.filter(X=>X.isCheckedIn).length,$=Q=>{const X=Q.marshals.reduce((ue,te)=>ue+te.outstandingTaskCount,0);return Q.outstandingTaskCount+X},se=(Q,X)=>{A.value=Q,C.value=X,E.value=!0},ce=()=>{E.value=!1,A.value=null,C.value=null},_e=async(Q,X)=>{if(M.value)return;const ue=Q.assignmentId||Q.id;if(!ue){console.error("No assignment ID found for marshal:",Q);return}M.value=Q.marshalId;try{if(on())await En("checkin_admin",{eventId:l.eventId,assignmentId:ue}),Q.isCheckedIn=!0,Q.checkInTime=new Date().toISOString(),Q.checkInMethod="AreaLead (pending)",await a(),u("checkin-updated");else if(await Yo.adminCheckIn(l.eventId,ue),await x(),u("checkin-updated"),A.value?.marshalId===Q.marshalId&&C.value){const te=y.value.find(be=>be.checkpointId===C.value.checkpointId);if(te){const be=te.marshals.find(Oe=>Oe.marshalId===Q.marshalId);be&&(A.value=be)}}}catch(te){console.error("Failed to check in marshal:",te),(on()||!te.response)&&(await En("checkin_admin",{eventId:l.eventId,assignmentId:ue}),Q.isCheckedIn=!0,Q.checkInTime=new Date().toISOString(),Q.checkInMethod="AreaLead (pending)",await a(),u("checkin-updated"))}finally{M.value=null}},ae=async(Q,X)=>{if(I.value)return;I.value=!0;const te={marshalId:X.marshals.length>0?X.marshals[0].marshalId:l.marshalId,contextType:Q.contextType,contextId:Q.contextId};try{on()?(await En("checklist_complete",{eventId:l.eventId,itemId:Q.itemId,data:te}),X.outstandingTasks=X.outstandingTasks.filter(be=>be.itemId!==Q.itemId),X.outstandingTaskCount=Math.max(0,X.outstandingTaskCount-1),await a(),u("checklist-updated")):(await Pt.complete(l.eventId,Q.itemId,te),await x(),u("checklist-updated"))}catch(be){console.error("Failed to complete task:",be),(on()||!be.response)&&(await En("checklist_complete",{eventId:l.eventId,itemId:Q.itemId,data:te}),X.outstandingTasks=X.outstandingTasks.filter(Oe=>Oe.itemId!==Q.itemId),X.outstandingTaskCount=Math.max(0,X.outstandingTaskCount-1),await a(),u("checklist-updated"))}finally{I.value=!1}},pe=async Q=>{if(I.value||!A.value)return;I.value=!0;const X={marshalId:A.value.marshalId,contextType:Q.contextType,contextId:Q.contextId};try{if(on())await En("checklist_complete",{eventId:l.eventId,itemId:Q.itemId,data:X}),A.value.outstandingTasks=A.value.outstandingTasks.filter(ue=>ue.itemId!==Q.itemId),A.value.outstandingTaskCount=Math.max(0,A.value.outstandingTaskCount-1),await a(),u("checklist-updated");else{if(await Pt.complete(l.eventId,Q.itemId,X),await x(),A.value&&C.value){const ue=y.value.find(te=>te.checkpointId===C.value.checkpointId);if(ue){const te=ue.marshals.find(be=>be.marshalId===A.value.marshalId);te&&(A.value=te)}}u("checklist-updated")}}catch(ue){console.error("Failed to complete task:",ue),(on()||!ue.response)&&(await En("checklist_complete",{eventId:l.eventId,itemId:Q.itemId,data:X}),A.value.outstandingTasks=A.value.outstandingTasks.filter(te=>te.itemId!==Q.itemId),A.value.outstandingTaskCount=Math.max(0,A.value.outstandingTaskCount-1),await a(),u("checklist-updated"))}finally{I.value=!1}},Ie=Q=>Q?new Date(Q).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",Be=Q=>Q?new Date(Q).toLocaleString():"",Se=Q=>{if(!Q)return"";const X=new Date(Q),te=new Date-X,be=Math.floor(te/6e4),Oe=Math.floor(be/60),ne=Math.floor(Oe/24);return be<1?"just now":be<60?`${be}m ago`:Oe<24?`${Oe}h ago`:ne===1?"yesterday":ne<7?`${ne}d ago`:X.toLocaleDateString()},he=Q=>({GPS:"GPS",Manual:"Manual",Admin:"Admin",AreaLead:`${i.value.area} Lead`})[Q]||Q;return qe(()=>[l.eventId,l.areaIds],()=>{x()},{immediate:!0}),(Q,X)=>(m(),g("div",V6,[h.value?(m(),g("div",G6," Loading dashboard... ")):p.value?(m(),g("div",Z6,[c("p",null,_(p.value),1),c("button",{onClick:x,class:"btn btn-secondary"},"Retry")])):b.value.length===0?(m(),g("div",j6,[c("p",null,"No "+_(z(s).checkpoints)+" in your "+_(z(s).areas)+".",1)])):(m(),g("div",W6,[(m(!0),g(Ce,null,Re(b.value,ue=>(m(),g("div",{key:ue.checkpointId,class:"checkpoint-accordion-section"},[c("button",{class:Te(["checkpoint-accordion-header",{active:k.value===ue.checkpointId}]),onClick:te=>T(ue.checkpointId)},[c("div",K6,[c("div",Y6,[c("span",J6,_(ue.name),1),ue.areaName?(m(),g("span",X6,_(ue.areaName),1)):R("",!0)]),ue.description?(m(),g("div",Q6,_(B(ue.description)),1)):R("",!0),c("div",eO,[c("span",tO,_(S(ue))+" / "+_(ue.marshals.length)+" checked in ",1),$(ue)>0?(m(),g("span",nO,_($(ue))+" tasks ",1)):R("",!0)])]),c("span",oO,_(k.value===ue.checkpointId?"":"+"),1)],10,q6),k.value===ue.checkpointId?(m(),g("div",sO,[c("div",iO,[ze(ei,{locations:[{id:ue.checkpointId,name:ue.name,description:ue.description,latitude:ue.latitude,longitude:ue.longitude}],route:e.route,center:{lat:ue.latitude,lng:ue.longitude},zoom:16,"highlight-location-id":ue.checkpointId,"marshal-mode":!0},null,8,["locations","route","center","highlight-location-id"])]),c("div",aO,[c("div",rO,_(z(i).people)+" ("+_(ue.marshals.length)+")",1),ue.marshals.length===0?(m(),g("div",lO," No "+_(z(s).people)+" assigned to this "+_(z(s).checkpoint)+". ",1)):(m(),g("div",cO,[(m(!0),g(Ce,null,Re(ue.marshals,te=>(m(),g("div",{key:te.marshalId,class:Te(["marshal-card",{"is-checked-in":te.isCheckedIn}]),onClick:be=>se(te,ue)},[c("div",dO,[c("div",hO,[c("span",fO,_(te.name),1),te.outstandingTaskCount>0?(m(),g("span",pO,_(te.outstandingTaskCount)+" tasks ",1)):R("",!0)]),c("div",vO,[c("div",{class:Te(["check-status",{"checked-in":te.isCheckedIn}])},_(te.isCheckedIn?" Checked In":"Not Checked In"),3),c("button",{onClick:vt(be=>_e(te),["stop"]),class:Te(["quick-checkin-btn",{"undo-btn":te.isCheckedIn}]),disabled:M.value===te.marshalId},_(M.value===te.marshalId?"...":te.isCheckedIn?"Undo":"Check In"),11,mO)])]),te.isCheckedIn&&te.checkInTime?(m(),g("div",gO,[Ze(_(Ie(te.checkInTime))+" ",1),te.checkInMethod?(m(),g("span",yO," ("+_(he(te.checkInMethod))+")",1)):R("",!0)])):R("",!0),te.lastAccessedAt?(m(),g("div",_O," Last active: "+_(Se(te.lastAccessedAt)),1)):R("",!0)],10,uO))),128))]))]),ue.outstandingTaskCount>0?(m(),g("div",kO,[c("div",bO,"Outstanding "+_(z(s).checkpoint)+" tasks ("+_(ue.outstandingTaskCount)+")",1),c("div",wO,[(m(!0),g(Ce,null,Re(ue.outstandingTasks,te=>(m(),g("div",{key:te.itemId,class:"task-item"},[c("input",{type:"checkbox",disabled:I.value,onChange:be=>ae(te,ue)},null,40,CO),c("span",LO,_(te.text),1)]))),128))])])):R("",!0)])):R("",!0)]))),128))])),ze(Ht,{show:E.value,title:A.value?.name||"Marshal Details",size:"large",onClose:ce},{actions:et(()=>[c("button",{onClick:ce,class:"btn btn-secondary"},"Close")]),default:et(()=>[A.value?(m(),g("div",SO,[c("div",xO,[X[4]||(X[4]=c("h4",null,"Contact Details",-1)),c("div",TO,[A.value.email?(m(),g("div",IO,[X[2]||(X[2]=c("span",{class:"contact-label"},"Email:",-1)),c("a",{href:`mailto:${A.value.email}`},_(A.value.email),9,$O)])):R("",!0),A.value.phoneNumber?(m(),g("div",MO,[X[3]||(X[3]=c("span",{class:"contact-label"},"Phone:",-1)),c("a",{href:`tel:${A.value.phoneNumber}`},_(A.value.phoneNumber),9,AO)])):R("",!0),!A.value.email&&!A.value.phoneNumber?(m(),g("div",EO," No contact details available. ")):R("",!0)])]),c("div",PO,[X[8]||(X[8]=c("h4",null,"Check-in Status",-1)),A.value.isCheckedIn?(m(),g("div",DO,[c("div",OO,[X[6]||(X[6]=c("span",{class:"check-icon"},"",-1)),c("div",null,[X[5]||(X[5]=c("strong",null,"Checked In",-1)),c("p",RO,_(Be(A.value.checkInTime)),1),A.value.checkInMethod?(m(),g("p",BO," Method: "+_(he(A.value.checkInMethod)),1)):R("",!0)])]),c("button",{onClick:X[0]||(X[0]=ue=>_e(A.value,C.value)),class:"btn btn-secondary undo-checkin-btn",disabled:M.value===A.value.marshalId},_(M.value===A.value.marshalId?"Undoing...":"Undo Check-in"),9,NO)])):(m(),g("div",FO,[X[7]||(X[7]=c("div",{class:"not-checked-in"},[c("span",{class:"not-checked-icon"},""),c("span",null,"Not checked in")],-1)),c("button",{onClick:X[1]||(X[1]=ue=>_e(A.value,C.value)),class:"btn btn-primary check-in-btn",disabled:M.value===A.value.marshalId},_(M.value===A.value.marshalId?"Checking in...":"Check In"),9,UO)])),A.value.lastAccessedAt?(m(),g("div",zO," Last active: "+_(Se(A.value.lastAccessedAt)),1)):R("",!0)]),c("div",HO,[c("h4",null,_(z(i).checklists)+" ("+_(A.value.outstandingTasks?.length||0)+" outstanding)",1),!A.value.outstandingTasks||A.value.outstandingTasks.length===0?(m(),g("div",VO," No outstanding tasks. ")):(m(),g("div",GO,[(m(!0),g(Ce,null,Re(A.value.outstandingTasks,ue=>(m(),g("div",{key:ue.itemId,class:"task-item"},[c("input",{type:"checkbox",disabled:I.value,onChange:te=>pe(ue)},null,40,ZO),c("span",jO,_(ue.text),1)]))),128))]))]),c("div",WO,[c("div",qO,[A.value.phoneNumber?(m(),g("a",{key:0,href:`tel:${A.value.phoneNumber}`,class:"btn btn-primary"}," Call ",8,KO)):R("",!0),A.value.phoneNumber?(m(),g("a",{key:1,href:`sms:${A.value.phoneNumber}`,class:"btn btn-secondary"}," Text ",8,YO)):R("",!0),A.value.email?(m(),g("a",{key:2,href:`mailto:${A.value.email}`,class:"btn btn-secondary"}," Email ",8,JO)):R("",!0)])])])):R("",!0)]),_:1},8,["show","title"])]))}},QO=Ye(XO,[["__scopeId","data-v-7df6c747"]]),e5={class:"offline-indicator-container"},t5={key:0,class:"offline-banner"},n5={class:"offline-text"},o5={key:0,class:"last-sync"},s5={class:"pending-text"},i5={key:0,class:"pending-subtext"},a5={key:1,class:"syncing-text"},r5={__name:"OfflineIndicator",setup(e){const{isOnline:t,isFullyOnline:o,pendingActionsCount:i,lastSyncTime:s,syncStatus:a,syncError:l,forcSync:u}=mu(),h=P(!1),p=P(""),f=P(""),y=J(()=>{if(!s.value)return"";const I=new Date(s.value),b=new Date-I,B=Math.floor(b/6e4),E=Math.floor(B/60);return B<1?"just now":B<60?`${B}m ago`:E<24?`${E}h ago`:I.toLocaleDateString()}),k=async()=>{await u()};return qe(a,I=>{I==="success"&&i.value===0?(p.value="All actions synced successfully!",f.value="success",h.value=!0,setTimeout(()=>{h.value=!1},3e3)):I==="error"&&(p.value=l.value||"Sync failed",f.value="error",h.value=!0,setTimeout(()=>{h.value=!1},5e3))}),(I,M)=>(m(),g("div",e5,[ze(Yl,{name:"slide"},{default:et(()=>[z(o)?R("",!0):(m(),g("div",t5,[M[0]||(M[0]=c("span",{class:"offline-icon"},[c("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"})])],-1)),c("span",n5,_(z(t)?"Server unavailable":"You're offline"),1),z(s)?(m(),g("span",o5," Last synced: "+_(y.value),1)):R("",!0)]))]),_:1}),ze(Yl,{name:"fade"},{default:et(()=>[z(i)>0?(m(),g("div",{key:0,class:Te(["pending-banner",{"offline-pending":!z(o)}])},[M[1]||(M[1]=c("span",{class:"pending-icon"},[c("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})])],-1)),c("span",s5,[Ze(_(z(i))+" pending action"+_(z(i)!==1?"s":"")+" ",1),z(o)?R("",!0):(m(),g("span",i5,"(will sync when online)"))]),z(o)&&z(a)!=="syncing"?(m(),g("button",{key:0,onClick:k,class:"sync-button"}," Sync Now ")):z(a)==="syncing"?(m(),g("span",a5,"Syncing...")):R("",!0)],2)):R("",!0)]),_:1}),ze(Yl,{name:"fade"},{default:et(()=>[h.value?(m(),g("div",{key:0,class:Te(["sync-toast",f.value])},_(p.value),3)):R("",!0)]),_:1})]))}},l5=Ye(r5,[["__scopeId","data-v-61340ead"]]),c5={key:0,class:"header-logo-cover"},u5=["src"],d5={key:1,class:"header-logo header-logo-left"},h5=["src"],f5={class:"header-center"},p5={key:0},v5={key:1,class:"header-event-date"},m5={class:"header-actions"},g5={key:2,class:"header-logo header-logo-right"},y5=["src"],_5={class:"container"},k5={key:0,class:"selection-card"},b5={key:1,class:"selection-card"},w5={key:0,class:"loading"},C5={key:2,class:"selection-card error-card"},L5={class:"error"},S5={key:3,class:"dashboard"},x5={key:0,class:"welcome-bar"},T5={class:"welcome-info"},I5={key:0,class:"welcome-email"},$5={key:0,class:"mode-switch"},M5={key:1,class:"mode-switch"},A5={class:"accordion"},E5={class:"accordion-section"},P5={class:"accordion-title"},D5=["innerHTML"],O5={key:0,class:"location-status active"},R5={key:1,class:"location-status"},B5={class:"accordion-icon"},N5={key:0,class:"accordion-content map-content"},F5={key:0,class:"map-selection-banner"},U5={class:"map-wrapper"},z5={class:"accordion-section"},H5={class:"accordion-title"},V5=["innerHTML"],G5={class:"accordion-icon"},Z5={key:0,class:"accordion-content assignments-accordion-content"},j5={key:0,class:"empty-state"},W5={key:1,class:"checkpoint-accordion"},q5=["onClick"],K5={class:"checkpoint-header-content"},Y5={class:"checkpoint-title-row"},J5=["innerHTML"],X5={key:0,class:"checkpoint-check-icon"},Q5={class:"checkpoint-name"},eR={key:1,class:"area-badge"},tR={key:2,class:"checkpoint-time-badge"},nR={key:0,class:"checkpoint-description-preview"},oR={class:"accordion-icon"},sR={key:0,class:"checkpoint-accordion-content"},iR={key:0,class:"checkpoint-mini-map"},aR=["onClick"],rR={class:"checkpoint-marshals"},lR={class:"marshals-label"},cR={class:"marshals-list"},uR={key:0,class:"check-badge"},dR={key:1,class:"checkpoint-area-contacts"},hR={class:"marshals-label"},fR={class:"contact-list"},pR={class:"contact-info"},vR={class:"contact-name"},mR={key:0,class:"contact-role"},gR={key:1,class:"contact-detail"},yR={key:2,class:"contact-detail"},_R={class:"contact-actions"},kR=["href"],bR=["href"],wR=["href"],CR={key:2,class:"checked-in-status"},LR={class:"check-time"},SR={key:3,class:"check-in-actions"},xR=["onClick","disabled"],TR=["onClick","disabled"],IR={key:4,class:"error"},$R={key:5,class:"dynamic-location-section"},MR={class:"dynamic-location-header"},AR={class:"dynamic-badge"},ER={key:0,class:"last-update"},PR={class:"dynamic-location-actions"},DR=["onClick","disabled"],OR=["onClick","title"],RR={class:"accordion-section"},BR={class:"accordion-title"},NR=["innerHTML"],FR={class:"accordion-icon"},UR={key:0,class:"accordion-content"},zR={key:0,class:"loading"},HR={key:1,class:"error"},VR={key:2,class:"empty-state"},GR={key:3,class:"checklist-items"},ZR={class:"item-checkbox"},jR=["checked","disabled","onChange"],WR={class:"item-content"},qR={key:0,class:"item-context"},KR={key:1,class:"completion-info"},YR={class:"completion-text"},JR={class:"completion-time"},XR={key:0,class:"accordion-section"},QR={class:"accordion-title"},eB=["innerHTML"],tB={class:"accordion-icon"},nB={key:0,class:"accordion-content"},oB={key:0,class:"loading"},sB={key:1,class:"contact-list"},iB={class:"contact-info"},aB={class:"contact-name-row"},rB={key:0,class:"primary-badge"},lB={class:"contact-name"},cB={key:1,class:"contact-role-badge"},uB={key:0,class:"contact-notes-text"},dB={key:1,class:"contact-detail"},hB={key:2,class:"contact-detail"},fB={class:"contact-actions"},pB=["href"],vB=["href"],mB=["href"],gB={class:"accordion-section"},yB={class:"accordion-title"},_B=["innerHTML"],kB={class:"accordion-icon"},bB={key:0,class:"accordion-content"},wB={key:1,class:"accordion-section"},CB={class:"accordion-title"},LB=["innerHTML"],SB={key:0,class:"area-lead-badges"},xB={class:"accordion-icon"},TB={key:0,class:"accordion-content area-lead-accordion-content"},IB={key:2,class:"accordion-section"},$B={class:"accordion-title"},MB=["innerHTML"],AB={class:"accordion-icon"},EB={key:0,class:"accordion-content"},PB={class:"event-details"},DB={key:0,class:"event-detail-row"},OB={class:"detail-value"},RB={key:1,class:"event-description"},BB={class:"detail-value"},NB={class:"modal-content check-in-reminder-modal"},FB={class:"modal-header warning"},UB={class:"modal-body"},zB={class:"reminder-message"},HB={key:0},VB={class:"reminder-hint"},GB={class:"modal-footer"},ZB={class:"modal-content location-update-modal"},jB={class:"modal-header"},WB={class:"modal-body"},qB={key:0,class:"success-message"},KB={key:1},YB={class:"modal-description"},JB={key:0,class:"last-update-info"},XB={key:1,class:"gps-status active"},QB={class:"update-option"},e8=["disabled"],t8={class:"update-option auto-update-option"},n8={class:"checkbox-label"},o8=["checked"],s8={class:"option-hint"},i8={class:"update-option"},a8=["disabled"],r8={class:"update-option"},l8={class:"option-label"},c8={key:0,class:"checkpoint-list"},u8=["onClick","disabled"],d8={key:1,class:"no-checkpoints"},h8={key:2,class:"error"},f8={key:2,class:"fullscreen-map-overlay"},p8={key:0,class:"fullscreen-map-banner"},v8={key:1,class:"fullscreen-map-container"},m8={key:2,class:"fullscreen-map-container"},g8={key:3,class:"fullscreen-map-actions"},y8={__name:"MarshalView",setup(e){const{terms:t,termsLower:o}=Ct(),{updatePendingCount:i}=mu(),s=lu(),a=za(),l=P(!1),u=P(!1),h=P(null),p=P(null),f=P(null),y=P(null),k=J(()=>y.value?.eventRoles?y.value.eventRoles.filter(G=>G.role==="EventAreaLead").flatMap(G=>G.areaIds||[]):[]),I=J(()=>k.value.length>0),M=J(()=>y.value?.eventRoles?y.value.eventRoles.some(V=>V.role==="EventAdmin"):!1),b=J(()=>y.value?.authMethod==="SecureEmailLink"&&M.value),B=J(()=>y.value?.authMethod==="MarshalMagicCode"&&M.value),E=()=>{a.push(`/admin/events/${s.params.eventId}`)},A=P(null),C=P([]),x=P([]),T=P([]),S=P(!0),$=J(()=>{const V=A.value?.brandingPageGradientStart||kn.pageGradientStart,G=A.value?.brandingPageGradientEnd||kn.pageGradientEnd;return{background:`linear-gradient(135deg, ${V} 0%, ${G} 100%)`}}),se=J(()=>{const V=A.value?.brandingHeaderGradientStart||kn.headerGradientStart,G=A.value?.brandingHeaderGradientEnd||kn.headerGradientEnd;return{background:`linear-gradient(135deg, ${V} 0%, ${G} 100%)`}}),ce=J(()=>{const V=A.value?.brandingHeaderGradientStart||kn.headerGradientStart,G=A.value?.brandingHeaderGradientEnd||kn.headerGradientEnd;return Vp(V,G)}),_e=J(()=>A.value?.brandingAccentColor||kn.accentColor),ae=J(()=>Hp(_e.value)),pe=J(()=>({background:_e.value,color:ae.value})),Ie=J(()=>A.value?.brandingLogoUrl||""),Be=J(()=>A.value?.brandingLogoPosition||"left"),Se=P("assignments"),he=P(null),Q=P(null),X=P(null),ue=P([]),te=P(!1),be=P(null),Oe=P(!1),ne=P([]),Ee=P(!1),xe=P(null),we=P(null),re=P(null),ve=P(!1),q=P(!1);let fe=null,Le=null;const U=P(null),H=P(!1),Y=P(!1),Z=P(""),N=P(""),O=P(null),W=P(!1),me=P(null),$e=P(new Set),ke=P(null),Ne=P(null),Fe=V=>{if(!V)return!0;const G=new Date(V);return(new Date-G)/(1e3*60*60)>24},Ue=P(null),We=P(null);let oe=null;const ee=V=>{Se.value=Se.value===V?null:V},j=P(null),Ve=V=>{j.value=j.value===V?null:V};qe(()=>x.value,V=>{V.length===1&&j.value===null&&(j.value=V[0].id)},{immediate:!0});const Xe=J(()=>x.value.map(V=>{const G=C.value.find(en=>en.id===V.locationId),ie=G?.areaIds||G?.AreaIds||[];let Me=null;ie.length>0&&T.value.length>0&&(Me=T.value.find(Bs=>ie.includes(Bs.id))?.name);const it=(G?.assignments||[]).map(en=>({...en,effectiveIsCheckedIn:en.isCheckedIn&&!Fe(en.checkInTime)})),Rt=Nn.value.filter(en=>ie.includes(en.areaId)),Vt=V.isCheckedIn&&!Fe(V.checkInTime);return{...V,location:G,areaName:Me,areaIds:ie,allMarshals:it,areaContacts:Rt,locationName:G?.name||"Unknown Location",effectiveIsCheckedIn:Vt}})),nt=J(()=>x.value.length>0?x.value[0]:null),at=J(()=>x.value.map(V=>V.locationId)),tt=J(()=>Xe.value.some(V=>V.location?.isDynamic||V.location?.IsDynamic)),St=J(()=>Xe.value.find(V=>V.location?.isDynamic||V.location?.IsDynamic)),$t=J(()=>{if(!A.value||!Xe.value.length)return[];const V=new Date,G=A.value.eventDate?new Date(A.value.eventDate):null;return Xe.value.filter(ie=>{if(ie.effectiveIsCheckedIn||$e.value.has(ie.id))return!1;const Me=ie.location;if(!Me)return!1;const Ge=Me.startTime?new Date(Me.startTime):G;if(!Ge)return!1;let it;if(Me.endTime)it=new Date(Me.endTime);else if(G)it=new Date(G.getTime()+7200*1e3);else return!1;return V>=Ge&&V<it})});qe($t,V=>{V.length>0&&!W.value&&(me.value=V[0],W.value=!0)},{immediate:!0});const yt=V=>{$e.value.add(V),W.value=!1,me.value=null},xn=(V,G=null)=>{ke.value=V,Ne.value=G,document.body.style.overflow="hidden"},To=()=>{ke.value=null,Ne.value=null,document.body.style.overflow=""},Yn=J(()=>A.value?.route?(typeof A.value.route=="string"?JSON.parse(A.value.route):A.value.route)||[]:[]),Dt=J(()=>!nt.value||!C.value.length?null:C.value.find(V=>V.id===nt.value.locationId)),Rn=J(()=>ue.value.filter(V=>V.isCompleted&&["OnePerCheckpoint","OnePerArea","OneLeadPerArea"].includes(V.matchedScope)?V.completedByActorId===f.value:!0)),Bn=J(()=>Rn.value.filter(V=>V.isCompleted).length),Jn=P([]),mo=P(!1),Io=J(()=>Jn.value),$o=J(()=>{const V=["EmergencyContact","EventDirector","MedicalLead","SafetyOfficer"];return Jn.value.filter(G=>V.includes(G.role))}),Xn=J(()=>ne.value.filter(V=>{const G=V.priority||V.Priority;return G==="Emergency"||G==="Urgent"})),Nn=P([]);J(()=>{if(Nn.value.length===0)return[];const V={};for(const G of Nn.value){const ie=G.areaId||"unknown";V[ie]||(V[ie]={areaId:G.areaId,areaName:G.areaName||"Unknown Area",contacts:[]}),V[ie].contacts.push(G)}return Object.values(V)}),J(()=>Nn.value.length);const Tn=(V,G)=>V.localeCompare(G,void 0,{numeric:!0,sensitivity:"base"}),Mo=J(()=>{if(!xe.value)return[];const V=xe.value.locationId;return C.value.filter(G=>G.id!==V&&G.latitude!==0&&G.longitude!==0).sort((G,ie)=>Tn(G.name,ie.name))}),is=J(()=>Dt.value?{lat:Dt.value.latitude,lng:Dt.value.longitude}:Ue.value?Ue.value:C.value.length>0?{lat:C.value[0].latitude,lng:C.value[0].longitude}:{lat:51.505,lng:-.09}),Ps=async(V,G)=>{u.value=!0,h.value=null,console.log("Authenticating with magic code:",{eventId:V,code:G});try{const ie=await Lo.marshalLogin(V,G);if(console.log("Auth response:",ie.data),ie.data.success){localStorage.setItem("sessionToken",ie.data.sessionToken),localStorage.setItem(`marshal_${V}`,ie.data.marshalId),p.value=ie.data.person,f.value=ie.data.marshalId,l.value=!0,console.log("Authenticated as marshal:",f.value,p.value?.name);try{const Me=await Lo.getMe(V);y.value=Me.data,console.log("User claims:",y.value)}catch(Me){console.warn("Failed to fetch claims:",Me)}a.replace({path:s.path,query:{}}),Vn(),await Ut()}else h.value=ie.data.message||"Authentication failed"}catch(ie){console.error("Authentication failed:",ie),h.value=ie.response?.data?.message||"Invalid or expired login link"}finally{u.value=!1}},Ao=async V=>{const G=localStorage.getItem("sessionToken"),ie=localStorage.getItem(`marshal_${V}`);if(!G||!ie)return!1;try{const Me=await Lo.getMe(V);if(Me.data&&Me.data.marshalId)return y.value=Me.data,p.value={personId:Me.data.personId,name:Me.data.personName,email:Me.data.personEmail},f.value=Me.data.marshalId,l.value=!0,Vn(),!0}catch{localStorage.removeItem("sessionToken"),localStorage.removeItem(`marshal_${V}`)}return!1},Ut=async()=>{const V=s.params.eventId;if(console.log("Loading event data for:",{eventId:V,marshalId:f.value}),on()){console.log("Offline mode detected, attempting to load from cache...");const Ge=await Is(V);if(Ge){if(console.log("Loaded cached data from:",Ge.cachedAt),A.value=Ge.event,T.value=Ge.areas||[],C.value=Ge.locations||[],ue.value=Ge.checklist||[],Jn.value=Ge.contacts||[],ne.value=Ge.notes||[],A.value&&Rc(A.value),f.value){const it=[];for(const Rt of C.value){const Vt=Rt.assignments?.find(en=>en.marshalId===f.value);Vt&&it.push(Vt)}x.value=it}return}else console.warn("No cached data available while offline")}console.log("Fetching event data in parallel...");const[G,ie,Me]=await Promise.allSettled([Ks.getById(V),Ss.getByEvent(V),pa.getEventStatus(V)]);if(G.status==="fulfilled"?(A.value=G.value.data,console.log("Event loaded:",A.value?.name),A.value&&Rc(A.value)):console.error("Failed to load event:",G.reason),ie.status==="fulfilled"?(T.value=ie.value.data||[],console.log("Areas loaded:",T.value.length)):console.error("Failed to load areas:",ie.reason),Me.status==="fulfilled"){if(C.value=Me.value.data?.locations||[],console.log("Locations loaded:",C.value.length),f.value){const Ge=[];for(const it of C.value){const Rt=it.assignments?.find(Vt=>Vt.marshalId===f.value);Rt&&Ge.push(Rt)}x.value=Ge,console.log("Total assignments found:",x.value.length)}}else console.error("Failed to load event status:",Me.reason);await Promise.allSettled([Qn(),Po(),Eo()]);try{const Ge=JSON.parse(JSON.stringify({event:A.value,areas:T.value,locations:C.value,checklist:ue.value,contacts:Jn.value,notes:ne.value,marshalId:f.value}));await Oa(V,Ge),console.log("Event data cached for offline access")}catch(Ge){console.warn("Failed to cache event data:",Ge)}Lt()},Je=async()=>{const V=s.params.eventId;if(on()){console.log("Skipping background preload: offline");return}console.log("Starting background preload for offline data...");try{const G=await Ss.getAreaLeadDashboard(V);if(G.data){const ie=JSON.parse(JSON.stringify({areas:G.data.areas||[],checkpoints:G.data.checkpoints||[]}));await Is(V)?await fa(V,"areaLeadDashboard",ie):await Oa(V,{areaLeadDashboard:ie}),console.log("Area lead dashboard cached for offline access")}}catch(G){G.response?.status!==403&&console.warn("Failed to preload area lead dashboard:",G)}console.log("Background preload complete")},Eo=async()=>{const V=s.params.eventId;try{const G=await Zo.getMyNotes(V);ne.value=G.data||[],console.log("Notes loaded:",ne.value.length)}catch(G){console.error("Failed to load notes:",G)}},Po=async()=>{const V=s.params.eventId;mo.value=!0;try{const G=await Ti.getMyContacts(V);Jn.value=G.data||[],console.log("Contacts loaded:",Jn.value.length)}catch(G){console.warn("Failed to load contacts:",G),Jn.value=[]}finally{mo.value=!1}},Qn=async()=>{if(!f.value){console.warn("No marshal ID, skipping checklist load");return}te.value=!0,be.value=null;try{console.log("Fetching checklist for marshal:",f.value);const V=await Pt.getMarshalChecklist(s.params.eventId,f.value);ue.value=V.data||[],console.log("Checklist loaded:",ue.value.length,"items")}catch(V){console.error("Failed to load checklist:",V.response?.status,V.response?.data),be.value=V.response?.data?.message||"Failed to load checklist"}finally{te.value=!1}},vn=async V=>{if(Oe.value)return;Oe.value=!0;const G=s.params.eventId,ie={marshalId:f.value,contextType:V.completionContextType,contextId:V.completionContextId};try{V.isCompleted?on()?(await En("checklist_uncomplete",{eventId:G,itemId:V.itemId,data:ie}),V.isCompleted=!1,V.completedAt=null,V.completedByActorName=null,await i()):(await Pt.uncomplete(G,V.itemId,ie),await Qn()):on()?(await En("checklist_complete",{eventId:G,itemId:V.itemId,data:ie}),V.isCompleted=!0,V.completedAt=new Date().toISOString(),V.completedByActorName=p.value?.name||"You",await i()):(await Pt.complete(G,V.itemId,ie),await Qn()),await fa(G,"checklist",ue.value)}catch(Me){if(console.error("Failed to toggle checklist item:",Me),on()||!Me.response){const Ge=V.isCompleted?"checklist_uncomplete":"checklist_complete";await En(Ge,{eventId:G,itemId:V.itemId,data:ie}),V.isCompleted=!V.isCompleted,await i()}else be.value=Me.response?.data?.message||"Failed to update checklist",setTimeout(()=>{be.value=null},3e3)}finally{Oe.value=!1}},In=V=>{if(!V.completionContextType||!V.completionContextId)return null;if(V.completionContextType==="Checkpoint"){const G=C.value.find(Me=>Me.id===V.completionContextId);if(!G)return null;const ie=G.description?` - ${G.description}`:"";return`At ${o.value.checkpoint} ${G.name}${ie}`}if(V.completionContextType==="Area"){const G=T.value.find(ie=>ie.id===V.completionContextId);return G?`At ${o.value.area} ${G.name}`:null}return V.completionContextType==="Personal"?"Personal item":null},eo=()=>{if(!("geolocation"in navigator)){console.warn("Geolocation not supported");return}console.log("Starting location tracking..."),oe=navigator.geolocation.watchPosition(V=>{Ue.value={lat:V.coords.latitude,lng:V.coords.longitude},We.value=Date.now()},V=>{console.warn("Geolocation error:",{1:"Location permission denied. Please allow location access in your browser settings.",2:"Location unavailable. Make sure GPS is enabled on your device.",3:"Location request timed out. Please try again."}[V.code]||V.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},mn=()=>{oe!==null&&(navigator.geolocation.clearWatch(oe),oe=null)},Ds=async V=>{he.value=V.id,Q.value=V.id,X.value=null;const G=s.params.eventId;try{if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const ie=await new Promise((Ge,it)=>{navigator.geolocation.getCurrentPosition(Ge,it,{enableHighAccuracy:!0,timeout:1e4})}),Me={eventId:G,assignmentId:V.id,latitude:ie.coords.latitude,longitude:ie.coords.longitude,manualCheckIn:!1};if(on()){await En("checkin",Me);const Ge=x.value.findIndex(it=>it.id===V.id);Ge!==-1&&(x.value[Ge]={...x.value[Ge],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"GPS (pending)",checkInLatitude:ie.coords.latitude,checkInLongitude:ie.coords.longitude}),await i(),await fa(G,"locations",C.value)}else{const Ge=await Yo.checkIn(Me),it=x.value.findIndex(Rt=>Rt.id===V.id);it!==-1&&(x.value[it]=Ge.data)}}catch(ie){if(on()||!ie.response){const Me={eventId:G,assignmentId:V.id,latitude:Ue.value?.lat||null,longitude:Ue.value?.lng||null,manualCheckIn:!0};await En("checkin",Me);const Ge=x.value.findIndex(it=>it.id===V.id);Ge!==-1&&(x.value[Ge]={...x.value[Ge],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"Manual (pending)"}),await i()}else ie.response?.data?.message?X.value=ie.response.data.message:ie.message?X.value=ie.message:X.value="Failed to check in. Please try manual check-in."}finally{he.value=null,Q.value=null}},Vi=V=>{Z.value="Manual Check-In",N.value="Are you sure you want to check in manually? This should only be used if GPS is not available.",O.value=async()=>{he.value=V.id,Q.value=V.id,X.value=null;const G=s.params.eventId,ie={eventId:G,assignmentId:V.id,latitude:null,longitude:null,manualCheckIn:!0};try{if(on()){await En("checkin",ie);const Me=x.value.findIndex(Ge=>Ge.id===V.id);Me!==-1&&(x.value[Me]={...x.value[Me],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"Manual (pending)"}),await i(),await fa(G,"locations",C.value)}else{const Me=await Yo.checkIn(ie),Ge=x.value.findIndex(it=>it.id===V.id);Ge!==-1&&(x.value[Ge]=Me.data)}}catch(Me){if(on()||!Me.response){await En("checkin",ie);const Ge=x.value.findIndex(it=>it.id===V.id);Ge!==-1&&(x.value[Ge]={...x.value[Ge],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"Manual (pending)"}),await i()}else X.value="Failed to check in manually. Please contact the admin."}finally{he.value=null,Q.value=null}},Y.value=!0},Gi=()=>{Y.value=!1,O.value&&(O.value(),O.value=null)},Zi=()=>{Y.value=!1,O.value=null},as=V=>{xe.value=V,we.value=null,re.value=null,Ee.value=!0},go=()=>{Ee.value=!1,xe.value=null,we.value=null,re.value=null,Yt.value=!1},Yt=P(!1),rs=()=>{Yt.value=!0,Ee.value=!1,Se.value="map"},ls=V=>{if(Yt.value&&xe.value){Os(xe.value.locationId,V.lat,V.lng,"manual"),Yt.value=!1,xe.value=null;return}if(tt.value&&St.value){const G=St.value;Z.value="Update location",N.value=`Update ${G.location?.name||"dynamic checkpoint"} to this location?`,O.value=async()=>{await Os(G.locationId,V.lat,V.lng,"manual")},Y.value=!0}},cs=V=>{if(!Yt.value&&tt.value&&St.value){const G=St.value;if(V.id===G.locationId)return;Z.value="Copy location",N.value=`Copy location from "${V.name}" to ${G.location?.name||"your dynamic checkpoint"}?`,O.value=async()=>{await Os(G.locationId,V.latitude,V.longitude,"checkpoint",V.id)},Y.value=!0}},Os=async(V,G,ie,Me,Ge=null)=>{ve.value=!0;try{const it=s.params.eventId,Rt={latitude:G,longitude:ie,sourceType:Me};Ge&&(Rt.sourceCheckpointId=Ge);const Vt=await wn.updatePosition(it,V,Rt);Vt.data.success&&(q.value&&Fn(),$n(V,Vt.data.latitude,Vt.data.longitude,Vt.data.lastLocationUpdate))}catch(it){console.error("Failed to update location:",it),it.response?.status===403?alert("You do not have permission to update this location."):alert("Failed to update location. Please try again.")}finally{ve.value=!1}},li=()=>{Yt.value=!1,Ee.value=!0},Ot=async()=>{if(xe.value){ve.value=!0,we.value=null;try{let V,G;if(Ue.value&&We.value&&Date.now()-We.value<3e4&&(V=Ue.value.lat,G=Ue.value.lng),!V||!G){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const it=await new Promise((Rt,Vt)=>{navigator.geolocation.getCurrentPosition(Rt,Vt,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4})});V=it.coords.latitude,G=it.coords.longitude}const ie=s.params.eventId,Me=xe.value.locationId,Ge=await wn.updatePosition(ie,Me,{latitude:V,longitude:G,sourceType:"gps"});Ge.data.success&&(re.value="Location updated successfully!",$n(Me,Ge.data.latitude,Ge.data.longitude,Ge.data.lastLocationUpdate),setTimeout(()=>go(),1500))}catch(V){console.error("Failed to update location with GPS:",V),V.response?.status===403?we.value="You do not have permission to update this location.":V.code===1?we.value="Location access denied. Please enable location permissions.":V.code===2?we.value="Unable to determine your location. Please try again.":V.code===3||V.message?.includes("Timeout")?we.value="GPS timed out. Please ensure location services are enabled and try again.":we.value="Failed to update location. Please try again."}finally{ve.value=!1}}},us=async V=>{if(!xe.value)return;const G=C.value.find(ie=>ie.id===V);if(!G){we.value="Source checkpoint not found.";return}ve.value=!0,we.value=null;try{const ie=s.params.eventId,Me=xe.value.locationId,Ge=await wn.updatePosition(ie,Me,{latitude:G.latitude,longitude:G.longitude,sourceType:"checkpoint",sourceCheckpointId:V});Ge.data.success&&(q.value&&Fn(),re.value=`Location copied from ${G.name}!`,$n(Me,Ge.data.latitude,Ge.data.longitude,Ge.data.lastLocationUpdate),setTimeout(()=>go(),1500))}catch(ie){console.error("Failed to copy location from checkpoint:",ie),ie.response?.status===403?we.value="You do not have permission to update this location.":we.value="Failed to update location. Please try again."}finally{ve.value=!1}},$n=(V,G,ie,Me)=>{const Ge=C.value.find(it=>it.id===V);Ge&&(Ge.latitude=G,Ge.longitude=ie,Ge.lastLocationUpdate=Me)},ds=V=>{q.value?Fn():ci(V)},ci=V=>{q.value=!0,rt(V),fe=setInterval(()=>{rt(V)},6e4)},Fn=()=>{q.value=!1,fe&&(clearInterval(fe),fe=null)},rt=async V=>{if(!(!V||!("geolocation"in navigator)))try{const G=await new Promise((Ge,it)=>{navigator.geolocation.getCurrentPosition(Ge,it,{enableHighAccuracy:!0,timeout:15e3})}),ie=s.params.eventId,Me=V.locationId;await wn.updatePosition(ie,Me,{latitude:G.coords.latitude,longitude:G.coords.longitude,sourceType:"gps"}),$n(Me,G.coords.latitude,G.coords.longitude,new Date().toISOString())}catch(G){console.warn("Auto-update location failed:",G)}},Lt=()=>{Le||!C.value.some(G=>G.isDynamic||G.IsDynamic)||(Le=setInterval(async()=>{try{const G=s.params.eventId,ie=await wn.getDynamicCheckpoints(G);if(ie.data&&Array.isArray(ie.data))for(const Me of ie.data){const Ge=C.value.find(it=>it.id===Me.checkpointId);Ge&&(Ge.latitude=Me.latitude,Ge.longitude=Me.longitude,Ge.lastLocationUpdate=Me.lastLocationUpdate)}}catch(G){console.warn("Failed to poll dynamic checkpoints:",G)}},6e4))},to=()=>{Le&&(clearInterval(Le),Le=null)},Un=V=>V?.isDynamic===!0||V?.IsDynamic===!0,zn=async()=>{try{await Lo.logout()}catch{}localStorage.removeItem("sessionToken"),localStorage.removeItem(`marshal_${s.params.eventId}`),l.value=!1,p.value=null,f.value=null,x.value=[],ue.value=[],Nn.value=[],a.push("/")},no=V=>V?new Date(V).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",lt=V=>V?new Date(V).toLocaleString():"",Mt=(V,G)=>{if(!V&&!G)return"";const ie=V?no(V):"?",Me=G?no(G):"?";return`${ie} - ${Me}`},hs=V=>V?new Date(V).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",fs=V=>V?new Date(V).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",Jt=V=>V?V.replace(/([A-Z])/g," $1").replace(/^./,G=>G.toUpperCase()).trim():"",Rs=V=>{if(!V)return"";const G=V.resolvedStyleType||V.ResolvedStyleType,ie=V.resolvedStyleBackgroundColor||V.ResolvedStyleBackgroundColor||V.resolvedStyleColor||V.ResolvedStyleColor,Me=V.resolvedStyleBorderColor||V.ResolvedStyleBorderColor,Ge=V.resolvedStyleIconColor||V.ResolvedStyleIconColor,it=V.resolvedStyleBackgroundShape||V.ResolvedStyleBackgroundShape;return G&&G!=="default"||ie||Me||Ge||it&&it!=="circle"?qt({type:G||"circle",backgroundShape:it||"circle",backgroundColor:ie||"#667eea",borderColor:Me||"#ffffff",iconColor:Ge||"#ffffff",size:"75",outputSize:20}):`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
    <circle cx="10" cy="10" r="8" fill="#667eea" stroke="#fff" stroke-width="1.5"/>
  </svg>`};Qt(async()=>{const V=s.params.eventId,G=s.query.code;S.value=!0;try{G?await Ps(V,G):await Ao(V)&&await Ut()}finally{S.value=!1}l.value&&(eo(),"requestIdleCallback"in window?requestIdleCallback(()=>{Je()},{timeout:5e3}):setTimeout(()=>{Je()},2e3))}),qe(l,V=>{V?eo():mn()}),qe(()=>s.query.code,async V=>{if(V&&l.value){S.value=!0;try{await Ps(s.params.eventId,V)}finally{S.value=!1}}});let Hn=null;const Vn=()=>{Hn||(Hn=setInterval(async()=>{if(y.value?.marshalId)try{await Lo.getMe(s.params.eventId)}catch(V){console.debug("Heartbeat failed:",V)}},300*1e3))},Tt=()=>{Hn&&(clearInterval(Hn),Hn=null)};return po(()=>{mn(),Tt(),Fn(),to()}),(V,G)=>(m(),g("div",{class:"marshal-view",style:st($.value)},[ze(l5),c("header",{class:Te(["header",`logo-${Be.value}`]),style:st(se.value)},[Ie.value&&Be.value==="cover"?(m(),g("div",c5,[c("img",{src:Ie.value,alt:"Event logo",class:"header-logo-cover-img"},null,8,u5)])):R("",!0),Ie.value&&Be.value==="left"?(m(),g("div",d5,[c("img",{src:Ie.value,alt:"Event logo",class:"header-logo-img"},null,8,h5)])):R("",!0),c("div",f5,[c("div",{class:"header-title",style:st({color:ce.value})},[A.value?(m(),g("h1",p5,_(A.value.name),1)):R("",!0),A.value?.eventDate?(m(),g("div",v5,_(fs(A.value.eventDate)),1)):R("",!0)],4),c("div",m5,[l.value?(m(),g("button",{key:0,onClick:G[0]||(G[0]=ie=>H.value=!0),class:"btn-emergency"}," Emergency Info ")):R("",!0),l.value?(m(),g("button",{key:1,onClick:zn,class:"btn-logout",style:st({color:ce.value})}," Logout "+_(p.value?.name||""),5)):R("",!0)])]),Ie.value&&Be.value==="right"?(m(),g("div",g5,[c("img",{src:Ie.value,alt:"Event logo",class:"header-logo-img"},null,8,y5)])):R("",!0)],6),c("div",_5,[S.value?(m(),g("div",k5,[...G[17]||(G[17]=[c("div",{class:"loading"},"Loading...",-1)])])):!l.value&&!h.value?(m(),g("div",b5,[G[18]||(G[18]=c("h2",null,"Welcome",-1)),G[19]||(G[19]=c("p",{class:"instruction"},"Please use the login link sent to you to access your marshal dashboard.",-1)),u.value?(m(),g("p",w5,"Authenticating...")):R("",!0)])):h.value?(m(),g("div",C5,[G[20]||(G[20]=c("h2",null,"Login failed",-1)),c("p",L5,_(h.value),1),G[21]||(G[21]=c("p",{class:"instruction"},"Please contact the event organiser for a new login link.",-1))])):(m(),g("div",S5,[b.value||B.value?(m(),g("div",x5,[c("div",T5,[p.value?.email?(m(),g("span",I5,_(p.value.email),1)):R("",!0)]),b.value?(m(),g("div",$5,[c("button",{onClick:E,class:"btn-mode-switch"}," Switch to Admin ")])):B.value?(m(),g("div",M5,[...G[22]||(G[22]=[c("span",{class:"reauth-hint",title:"Login via admin flow to access admin features"}," Admin access requires re-login ",-1)])])):R("",!0)])):R("",!0),c("div",A5,[c("div",E5,[c("button",{class:Te(["accordion-header",{active:Se.value==="map"}]),onClick:G[1]||(G[1]=ie=>ee("map"))},[c("span",P5,[c("span",{class:"section-icon",innerHTML:z(Pn)("course")},null,8,D5),Ze(" "+_(z(t).course)+" ",1),Ue.value?(m(),g("span",O5,"GPS Active")):(m(),g("span",R5,"GPS Inactive"))]),c("span",B5,_(Se.value==="map"?"":"+"),1)],2),Se.value==="map"?(m(),g("div",N5,[Yt.value?(m(),g("div",F5,[c("span",null,[G[23]||(G[23]=Ze("Click on the map to set the new location for ",-1)),c("strong",null,_(xe.value?.location?.name),1)]),c("button",{onClick:li,class:"btn btn-secondary btn-sm"},"Cancel")])):R("",!0),c("div",U5,[ze(ei,{locations:C.value,route:Yn.value,center:is.value,zoom:15,"user-location":Ue.value,"highlight-location-ids":at.value,"marshal-mode":!0,clickable:Yt.value||tt.value,class:Te({"selecting-location":Yt.value}),onMapClick:ls,onLocationClick:cs},null,8,["locations","route","center","user-location","highlight-location-ids","clickable","class"]),c("button",{class:"fullscreen-btn",onClick:G[2]||(G[2]=ie=>xn("course")),title:"Full screen"},[...G[24]||(G[24]=[c("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20"},[c("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"})],-1)])])])])):R("",!0)]),c("div",z5,[c("button",{class:Te(["accordion-header",{active:Se.value==="assignments"}]),onClick:G[3]||(G[3]=ie=>ee("assignments"))},[c("span",H5,[c("span",{class:"section-icon",innerHTML:z(Pn)("checkpoint")},null,8,V5),Ze(" Your "+_(z(o).checkpoints)+" ("+_(x.value.length)+") ",1)]),c("span",G5,_(Se.value==="assignments"?"":"+"),1)],2),Se.value==="assignments"?(m(),g("div",Z5,[x.value.length===0?(m(),g("div",j5,[c("p",null,"You don't have any "+_(z(o).checkpoint)+" assignments yet.",1)])):(m(),g("div",W5,[(m(!0),g(Ce,null,Re(Xe.value,ie=>(m(),g("div",{key:ie.id,class:"checkpoint-accordion-section"},[c("button",{class:Te(["checkpoint-accordion-header",{active:j.value===ie.id,"checked-in":ie.effectiveIsCheckedIn}]),onClick:Me=>Ve(ie.id)},[c("div",K5,[c("div",Y5,[c("span",{class:"checkpoint-icon",innerHTML:Rs(ie.location)},null,8,J5),ie.effectiveIsCheckedIn?(m(),g("span",X5,"")):R("",!0),c("span",Q5,_(ie.location?.name||ie.locationName),1),ie.areaName?(m(),g("span",eR,_(ie.areaName),1)):R("",!0),ie.location?.startTime||ie.location?.endTime?(m(),g("span",tR,_(Mt(ie.location.startTime,ie.location.endTime)),1)):R("",!0)]),ie.location?.description?(m(),g("div",nR,_(ie.location.description),1)):R("",!0)]),c("span",oR,_(j.value===ie.id?"":"+"),1)],10,q5),j.value===ie.id?(m(),g("div",sR,[ie.location?(m(),g("div",iR,[ze(ei,{locations:C.value,route:Yn.value,center:{lat:ie.location.latitude,lng:ie.location.longitude},zoom:16,"user-location":Ue.value,"highlight-location-id":ie.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:tt.value,onMapClick:ls,onLocationClick:cs},null,8,["locations","route","center","user-location","highlight-location-id","clickable"]),c("button",{class:"fullscreen-btn",onClick:Me=>xn(ie.id,ie),title:"Full screen"},[...G[25]||(G[25]=[c("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18"},[c("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"})],-1)])],8,aR)])):R("",!0),c("div",rR,[c("div",lR,_(z(t).people)+":",1),c("div",cR,[(m(!0),g(Ce,null,Re(ie.allMarshals,Me=>(m(),g("span",{key:Me.marshalId,class:Te(["marshal-tag",{"is-you":Me.marshalId===f.value,"checked-in":Me.effectiveIsCheckedIn}])},[Ze(_(Me.marshalName)+_(Me.marshalId===f.value?" (you)":"")+" ",1),Me.effectiveIsCheckedIn?(m(),g("span",uR,"")):R("",!0)],2))),128))])]),ie.areaContacts.length>0?(m(),g("div",dR,[c("div",hR,_(z(t).area)+" contacts:",1),c("div",fR,[(m(!0),g(Ce,null,Re(ie.areaContacts,Me=>(m(),g("div",{key:Me.marshalId,class:"contact-item"},[c("div",pR,[c("div",vR,_(Me.marshalName),1),Me.role?(m(),g("div",mR,_(Me.role),1)):R("",!0),Me.phone?(m(),g("div",gR,_(Me.phone),1)):R("",!0),Me.email?(m(),g("div",yR,_(Me.email),1)):R("",!0)]),c("div",_R,[Me.phone?(m(),g("a",{key:0,href:`tel:${Me.phone}`,class:"contact-link"},[...G[26]||(G[26]=[c("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Ze(" Call ",-1)])],8,kR)):R("",!0),Me.phone?(m(),g("a",{key:1,href:`sms:${Me.phone}`,class:"contact-link"},[...G[27]||(G[27]=[c("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Ze(" Text ",-1)])],8,bR)):R("",!0),Me.email?(m(),g("a",{key:2,href:`mailto:${Me.email}`,class:"contact-link"},[...G[28]||(G[28]=[c("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Ze(" Email ",-1)])],8,wR)):R("",!0)])]))),128))])])):R("",!0),ie.effectiveIsCheckedIn?(m(),g("div",CR,[G[30]||(G[30]=c("span",{class:"check-icon"},"",-1)),c("div",null,[G[29]||(G[29]=c("strong",null,"Checked In",-1)),c("p",LR,_(no(ie.checkInTime)),1)])])):(m(),g("div",SR,[c("button",{onClick:Me=>Ds(ie),class:"btn btn-primary",disabled:he.value===ie.id,style:st(pe.value)},_(he.value===ie.id?"Checking in...":"GPS Check-In"),13,xR),c("button",{onClick:Me=>Vi(ie),class:"btn btn-secondary",disabled:he.value===ie.id}," Manual ",8,TR)])),X.value&&Q.value===ie.id?(m(),g("div",IR,_(X.value),1)):R("",!0),Un(ie.location)?(m(),g("div",$R,[c("div",MR,[c("span",AR,"Dynamic "+_(ie.location.resolvedCheckpointTerm||z(t).checkpoint),1),ie.location.lastLocationUpdate?(m(),g("span",ER," Last updated: "+_(lt(ie.location.lastLocationUpdate)),1)):R("",!0)]),c("div",PR,[c("button",{onClick:Me=>as(ie),class:"btn btn-update-location",disabled:ve.value},[...G[31]||(G[31]=[c("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1),Ze(" Update location ",-1)])],8,DR),c("button",{onClick:Me=>ds(ie),class:Te(["btn btn-auto-update",{active:q.value}]),title:q.value?"Stop auto-updating":"Auto-update every 60 seconds"},[G[32]||(G[32]=c("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})],-1)),Ze(" "+_(q.value?"Stop":"Auto"),1)],10,OR)])])):R("",!0)])):R("",!0)]))),128))]))])):R("",!0)]),c("div",RR,[c("button",{class:Te(["accordion-header",{active:Se.value==="checklist"}]),onClick:G[4]||(G[4]=ie=>ee("checklist"))},[c("span",BR,[c("span",{class:"section-icon",innerHTML:z(Pn)("checklist")},null,8,NR),Ze(" Your "+_(z(o).checklists)+" ("+_(Bn.value)+" of "+_(Rn.value.length)+" complete) ",1)]),c("span",FR,_(Se.value==="checklist"?"":"+"),1)],2),Se.value==="checklist"?(m(),g("div",UR,[te.value?(m(),g("div",zR,"Loading checklist...")):be.value?(m(),g("div",HR,_(be.value),1)):Rn.value.length===0?(m(),g("div",VR,[c("p",null,"No "+_(z(o).checklists)+" for you.",1)])):(m(),g("div",GR,[(m(!0),g(Ce,null,Re(Rn.value,ie=>(m(),g("div",{key:`${ie.itemId}_${ie.completionContextType}_${ie.completionContextId}`,class:Te(["checklist-item",{"item-completed":ie.isCompleted}])},[c("div",ZR,[c("input",{type:"checkbox",checked:ie.isCompleted,disabled:!ie.canBeCompletedByMe||Oe.value,onChange:Me=>vn(ie)},null,40,jR)]),c("div",WR,[c("div",{class:Te(["item-text",{"text-completed":ie.isCompleted}])},_(ie.text),3),In(ie)?(m(),g("div",qR,_(In(ie)),1)):R("",!0),ie.isCompleted?(m(),g("div",KR,[c("span",YR," Completed by "+_(ie.completedByActorName||"Unknown"),1),c("span",JR,_(lt(ie.completedAt)),1)])):R("",!0)])],2))),128))]))])):R("",!0)]),Io.value.length>0||mo.value?(m(),g("div",XR,[c("button",{class:Te(["accordion-header",{active:Se.value==="eventContacts"}]),onClick:G[5]||(G[5]=ie=>ee("eventContacts"))},[c("span",QR,[c("span",{class:"section-icon",innerHTML:z(Pn)("contacts")},null,8,eB),Ze(" Your contacts ("+_(Io.value.length)+") ",1)]),c("span",tB,_(Se.value==="eventContacts"?"":"+"),1)],2),Se.value==="eventContacts"?(m(),g("div",nB,[mo.value?(m(),g("div",oB,"Loading contacts...")):(m(),g("div",sB,[(m(!0),g(Ce,null,Re(Io.value,ie=>(m(),g("div",{key:ie.contactId,class:Te(["contact-item",{"primary-contact":ie.isPrimary}])},[c("div",iB,[c("div",aB,[ie.isPrimary?(m(),g("span",rB,"")):R("",!0),c("span",lB,_(ie.name),1),ie.role?(m(),g("span",cB,_(Jt(ie.role)),1)):R("",!0)]),ie.notes?(m(),g("div",uB,_(ie.notes),1)):R("",!0),ie.phone?(m(),g("div",dB,_(ie.phone),1)):R("",!0),ie.email?(m(),g("div",hB,_(ie.email),1)):R("",!0)]),c("div",fB,[ie.phone?(m(),g("a",{key:0,href:`tel:${ie.phone}`,class:"contact-link"},[...G[33]||(G[33]=[c("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Ze(" Call ",-1)])],8,pB)):R("",!0),ie.phone?(m(),g("a",{key:1,href:`sms:${ie.phone}`,class:"contact-link"},[...G[34]||(G[34]=[c("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Ze(" Text ",-1)])],8,vB)):R("",!0),ie.email?(m(),g("a",{key:2,href:`mailto:${ie.email}`,class:"contact-link"},[...G[35]||(G[35]=[c("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Ze(" Email ",-1)])],8,mB)):R("",!0)])],2))),128))]))])):R("",!0)])):R("",!0),c("div",gB,[c("button",{class:Te(["accordion-header",{active:Se.value==="notes"}]),onClick:G[6]||(G[6]=ie=>ee("notes"))},[c("span",yB,[c("span",{class:"section-icon",innerHTML:z(Pn)("notes")},null,8,_B),Ze(" Your notes ("+_(ne.value.length)+") ",1)]),c("span",kB,_(Se.value==="notes"?"":"+"),1)],2),Se.value==="notes"?(m(),g("div",bB,[ze(xl,{"event-id":z(s).params.eventId,"all-notes":ne.value,locations:C.value,areas:T.value,assignments:x.value,"show-scope":!1,onNotesChanged:Eo},null,8,["event-id","all-notes","locations","areas","assignments"])])):R("",!0)]),I.value?(m(),g("div",wB,[c("button",{class:Te(["accordion-header",{active:Se.value==="areaLead"}]),onClick:G[7]||(G[7]=ie=>ee("areaLead"))},[c("span",CB,[c("span",{class:"section-icon",innerHTML:z(Pn)("people")},null,8,LB),Ze(" Your "+_(z(o).people)+" ",1),U.value?.areas?.length>0?(m(),g("span",SB,[(m(!0),g(Ce,null,Re(U.value.areas,ie=>(m(),g("span",{key:ie.areaId,class:"area-lead-badge",style:st({backgroundColor:ie.color||"#667eea"})},_(ie.name),5))),128))])):R("",!0)]),c("span",xB,_(Se.value==="areaLead"?"":"+"),1)],2),Se.value==="areaLead"?(m(),g("div",TB,[ze(QO,{ref_key:"areaLeadRef",ref:U,"event-id":z(s).params.eventId,"area-ids":k.value,"marshal-id":f.value,route:Yn.value,onChecklistUpdated:Qn},null,8,["event-id","area-ids","marshal-id","route"])])):R("",!0)])):R("",!0),A.value?.eventDate||A.value?.description?(m(),g("div",IB,[c("button",{class:Te(["accordion-header",{active:Se.value==="eventDetails"}]),onClick:G[8]||(G[8]=ie=>ee("eventDetails"))},[c("span",$B,[c("span",{class:"section-icon",innerHTML:z(Pn)("event")},null,8,MB),G[36]||(G[36]=Ze(" Event details ",-1))]),c("span",AB,_(Se.value==="eventDetails"?"":"+"),1)],2),Se.value==="eventDetails"?(m(),g("div",EB,[c("div",PB,[A.value.eventDate?(m(),g("div",DB,[G[37]||(G[37]=c("span",{class:"detail-label"},"Date and time",-1)),c("span",OB,_(hs(A.value.eventDate)),1)])):R("",!0),A.value.description?(m(),g("div",RB,[G[38]||(G[38]=c("span",{class:"detail-label"},"Description",-1)),c("p",BB,_(A.value.description),1)])):R("",!0)])])):R("",!0)])):R("",!0)])]))]),ze(F6,{show:H.value,contacts:$o.value,notes:Xn.value,onClose:G[9]||(G[9]=ie=>H.value=!1)},null,8,["show","contacts","notes"]),ze(Ll,{show:Y.value,title:Z.value,message:N.value,onConfirm:Gi,onCancel:Zi},null,8,["show","title","message"]),W.value&&me.value?(m(),g("div",{key:0,class:"modal-overlay",onClick:G[13]||(G[13]=vt(ie=>yt(me.value.id),["self"]))},[c("div",NB,[c("div",FB,[G[39]||(G[39]=c("h3",null,"Check-in reminder",-1)),c("button",{class:"modal-close",onClick:G[10]||(G[10]=ie=>yt(me.value.id))},"")]),c("div",UB,[G[41]||(G[41]=c("div",{class:"reminder-icon"},"",-1)),c("p",zB,[Ze(" You have not checked in yet to "+_(z(t).checkpoint.toLowerCase())+" ",1),c("strong",null,_(me.value.location?.name),1),me.value.location?.description?(m(),g("span",HB," - "+_(me.value.location.description),1)):R("",!0),G[40]||(G[40]=Ze(". ",-1))]),c("p",VB," Please check in when you arrive at your "+_(z(t).checkpoint.toLowerCase())+". ",1)]),c("div",GB,[c("button",{onClick:G[11]||(G[11]=ie=>yt(me.value.id)),class:"btn btn-secondary"}," Dismiss "),c("button",{onClick:G[12]||(G[12]=ie=>{yt(me.value.id),Se.value="assignments",j.value=me.value.id}),class:"btn btn-primary",style:st(pe.value)}," Go to "+_(z(t).checkpoint),5)])])])):R("",!0),Ee.value?(m(),g("div",{key:1,class:"modal-overlay",onClick:vt(go,["self"])},[c("div",ZB,[c("div",jB,[c("h3",null,"Update "+_((xe.value?.location?.resolvedCheckpointTerm||z(t).checkpoint).toLowerCase())+" location",1),c("button",{class:"modal-close",onClick:go},"")]),c("div",WB,[re.value?(m(),g("div",qB,_(re.value),1)):(m(),g("div",KB,[c("p",YB,[G[42]||(G[42]=Ze(" Update the position of ",-1)),c("strong",null,_(xe.value?.location?.name),1)]),xe.value?.location?.lastLocationUpdate?(m(),g("div",JB," Last updated: "+_(lt(xe.value.location.lastLocationUpdate)),1)):R("",!0),Ue.value?(m(),g("div",XB,[...G[43]||(G[43]=[c("svg",{class:"status-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),Ze(" GPS active ",-1)])])):R("",!0),c("div",QB,[c("button",{onClick:Ot,class:"btn btn-primary btn-full",disabled:ve.value,style:st(pe.value)},[G[44]||(G[44]=c("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),Ze(" "+_(ve.value?"Updating...":"Use current GPS location"),1)],12,e8)]),c("div",t8,[c("label",n8,[c("input",{type:"checkbox",checked:q.value,onChange:G[14]||(G[14]=ie=>ds(xe.value))},null,40,o8),G[45]||(G[45]=c("span",null,"Auto-update every 60 seconds",-1))]),c("p",s8,"Automatically updates the "+_(z(o).checkpoint)+" location using your GPS every minute.",1)]),c("div",i8,[c("button",{onClick:rs,class:"btn btn-secondary btn-full",disabled:ve.value},[...G[46]||(G[46]=[c("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"})],-1),Ze(" Select location on map ",-1)])],8,a8)]),c("div",r8,[c("label",l8,"Or copy location from another "+_(z(o).checkpoint)+":",1),Mo.value.length>0?(m(),g("div",c8,[(m(!0),g(Ce,null,Re(Mo.value,ie=>(m(),g("button",{key:ie.id,onClick:Me=>us(ie.id),class:"btn btn-secondary btn-checkpoint-source",disabled:ve.value},_(ie.name),9,u8))),128))])):(m(),g("p",d8," No other "+_(z(o).checkpoints)+" available to copy from. ",1))]),we.value?(m(),g("div",h8,_(we.value),1)):R("",!0)]))]),c("div",{class:"modal-footer"},[c("button",{onClick:go,class:"btn btn-secondary"}," Cancel ")])])])):R("",!0),ke.value?(m(),g("div",f8,[c("div",{class:"fullscreen-map-header",style:st(se.value)},[c("div",{class:"fullscreen-map-title",style:st({color:ce.value})},[ke.value==="course"?(m(),g(Ce,{key:0},[Ze(_(z(t).course),1)],64)):Ne.value?(m(),g(Ce,{key:1},[Ze(_(Ne.value.location?.name),1)],64)):R("",!0)],4),c("button",{class:"fullscreen-close-btn",style:st({color:ce.value}),onClick:To},[...G[47]||(G[47]=[c("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24"},[c("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)])],4)],4),Yt.value?(m(),g("div",p8,[c("span",null,[G[48]||(G[48]=Ze("Click on the map to set the new location for ",-1)),c("strong",null,_(xe.value?.location?.name),1)]),c("button",{onClick:li,class:"btn btn-secondary btn-sm"},"Cancel")])):R("",!0),ke.value==="course"?(m(),g("div",v8,[ze(ei,{locations:C.value,route:Yn.value,center:is.value,zoom:15,"user-location":Ue.value,"highlight-location-ids":at.value,"marshal-mode":!0,clickable:Yt.value||tt.value,class:Te({"selecting-location":Yt.value}),onMapClick:ls,onLocationClick:cs},null,8,["locations","route","center","user-location","highlight-location-ids","clickable","class"])])):Ne.value?.location?(m(),g("div",m8,[ze(ei,{locations:C.value,route:Yn.value,center:{lat:Ne.value.location.latitude,lng:Ne.value.location.longitude},zoom:16,"user-location":Ue.value,"highlight-location-id":Ne.value.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:tt.value,onMapClick:ls,onLocationClick:cs},null,8,["locations","route","center","user-location","highlight-location-id","clickable"])])):R("",!0),Ne.value?.location?.isDynamic||ke.value==="course"&&tt.value?(m(),g("div",g8,[Ne.value?(m(),g("button",{key:0,class:"btn btn-primary",style:st(pe.value),onClick:G[15]||(G[15]=ie=>as(Ne.value))}," Update Location ",4)):St.value?(m(),g("button",{key:1,class:"btn btn-primary",style:st(pe.value),onClick:G[16]||(G[16]=ie=>as(St.value))}," Update "+_(St.value.location?.name)+" Location ",5)):R("",!0)])):R("",!0)])):R("",!0)],4))}},_8=Ye(y8,[["__scopeId","data-v-f7cabb29"]]),k8=[{path:"/",name:"Home",component:__},{path:"/admin/login",name:"AdminLogin",component:fk},{path:"/admin/verify",name:"AdminVerify",component:kk},{path:"/admin/dashboard",name:"AdminDashboard",component:wb,meta:{requiresAuth:!0}},{path:"/admin/profile",name:"AdminProfile",component:qb,meta:{requiresAuth:!0}},{path:"/admin/event/:eventId",name:"AdminEventManage",component:b6,meta:{requiresAuth:!0}},{path:"/event/:eventId",name:"MarshalView",component:_8},{path:"/:pathMatch(.*)*",redirect:"/"}],jp=f_({history:Zy("/VolunteerCheckin/testing/"),routes:k8});jp.beforeEach((e,t,o)=>{const i=localStorage.getItem("adminEmail");e.meta.requiresAuth&&!i?o({name:"AdminLogin"}):o()});ss().then(()=>{console.log("Offline database initialized")}).catch(e=>{console.warn("Failed to initialize offline database:",e)});const gu=qg(ay);gu.use(Jg());gu.use(jp);gu.mount("#app");
