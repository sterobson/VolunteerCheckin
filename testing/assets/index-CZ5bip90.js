(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();function af(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const Qt={},jl=[],_a=()=>{},wm=()=>!1,Mu=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),sf=e=>e.startsWith("onUpdate:"),Rn=Object.assign,lf=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},D1=Object.prototype.hasOwnProperty,qt=(e,t)=>D1.call(e,t),dt=Array.isArray,Wl=e=>lc(e)==="[object Map]",ar=e=>lc(e)==="[object Set]",Wf=e=>lc(e)==="[object Date]",bt=e=>typeof e=="function",hn=e=>typeof e=="string",La=e=>typeof e=="symbol",Yt=e=>e!==null&&typeof e=="object",Cm=e=>(Yt(e)||bt(e))&&bt(e.then)&&bt(e.catch),Lm=Object.prototype.toString,lc=e=>Lm.call(e),R1=e=>lc(e).slice(8,-1),Sm=e=>lc(e)==="[object Object]",Au=e=>hn(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Er=af(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Eu=e=>{const t=Object.create(null);return(n=>t[n]||(t[n]=e(n)))},O1=/-\w/g,aa=Eu(e=>e.replace(O1,t=>t.slice(1).toUpperCase())),B1=/\B([A-Z])/g,mi=Eu(e=>e.replace(B1,"-$1").toLowerCase()),Pu=Eu(e=>e.charAt(0).toUpperCase()+e.slice(1)),yd=Eu(e=>e?`on${Pu(e)}`:""),ci=(e,t)=>!Object.is(e,t),Vc=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},Im=(e,t,n,a=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:a,value:n})},Du=e=>{const t=parseFloat(e);return isNaN(t)?e:t},N1=e=>{const t=hn(e)?Number(e):NaN;return isNaN(t)?e:t};let Zf;const Ru=()=>Zf||(Zf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function nt(e){if(dt(e)){const t={};for(let n=0;n<e.length;n++){const a=e[n],o=hn(a)?H1(a):nt(a);if(o)for(const i in o)t[i]=o[i]}return t}else if(hn(e)||Yt(e))return e}const F1=/;(?![^(]*\))/g,U1=/:([^]+)/,z1=/\/\*[^]*?\*\//g;function H1(e){const t={};return e.replace(z1,"").split(F1).forEach(n=>{if(n){const a=n.split(U1);a.length>1&&(t[a[0].trim()]=a[1].trim())}}),t}function le(e){let t="";if(hn(e))t=e;else if(dt(e))for(let n=0;n<e.length;n++){const a=le(e[n]);a&&(t+=a+" ")}else if(Yt(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const V1="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",G1=af(V1);function xm(e){return!!e||e===""}function q1(e,t){if(e.length!==t.length)return!1;let n=!0;for(let a=0;n&&a<e.length;a++)n=ll(e[a],t[a]);return n}function ll(e,t){if(e===t)return!0;let n=Wf(e),a=Wf(t);if(n||a)return n&&a?e.getTime()===t.getTime():!1;if(n=La(e),a=La(t),n||a)return e===t;if(n=dt(e),a=dt(t),n||a)return n&&a?q1(e,t):!1;if(n=Yt(e),a=Yt(t),n||a){if(!n||!a)return!1;const o=Object.keys(e).length,i=Object.keys(t).length;if(o!==i)return!1;for(const l in e){const c=e.hasOwnProperty(l),d=t.hasOwnProperty(l);if(c&&!d||!c&&d||!ll(e[l],t[l]))return!1}}return String(e)===String(t)}function rf(e,t){return e.findIndex(n=>ll(n,t))}const $m=e=>!!(e&&e.__v_isRef===!0),b=e=>hn(e)?e:e==null?"":dt(e)||Yt(e)&&(e.toString===Lm||!bt(e.toString))?$m(e)?b(e.value):JSON.stringify(e,Tm,2):String(e),Tm=(e,t)=>$m(t)?Tm(e,t.value):Wl(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[a,o],i)=>(n[kd(a,i)+" =>"]=o,n),{})}:ar(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>kd(n))}:La(t)?kd(t):Yt(t)&&!dt(t)&&!Sm(t)?String(t):t,kd=(e,t="")=>{var n;return La(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};function j1(e){return e==null?"initial":typeof e=="string"?e===""?" ":e:String(e)}let Yn;class Mm{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Yn,!t&&Yn&&(this.index=(Yn.scopes||(Yn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=Yn;try{return Yn=this,t()}finally{Yn=n}}}on(){++this._on===1&&(this.prevScope=Yn,Yn=this)}off(){this._on>0&&--this._on===0&&(Yn=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let n,a;for(n=0,a=this.effects.length;n<a;n++)this.effects[n].stop();for(this.effects.length=0,n=0,a=this.cleanups.length;n<a;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,a=this.scopes.length;n<a;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0}}}function Am(e){return new Mm(e)}function Em(){return Yn}function W1(e,t=!1){Yn&&Yn.cleanups.push(e)}let nn;const bd=new WeakSet;class Pm{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Yn&&Yn.active&&Yn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,bd.has(this)&&(bd.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Rm(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Kf(this),Om(this);const t=nn,n=wa;nn=this,wa=!0;try{return this.fn()}finally{Bm(this),nn=t,wa=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)df(t);this.deps=this.depsTail=void 0,Kf(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?bd.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){bh(this)&&this.run()}get dirty(){return bh(this)}}let Dm=0,Pr,Dr;function Rm(e,t=!1){if(e.flags|=8,t){e.next=Dr,Dr=e;return}e.next=Pr,Pr=e}function cf(){Dm++}function uf(){if(--Dm>0)return;if(Dr){let t=Dr;for(Dr=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;Pr;){let t=Pr;for(Pr=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(a){e||(e=a)}t=n}}if(e)throw e}function Om(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Bm(e){let t,n=e.depsTail,a=n;for(;a;){const o=a.prevDep;a.version===-1?(a===n&&(n=o),df(a),Z1(a)):t=a,a.dep.activeLink=a.prevActiveLink,a.prevActiveLink=void 0,a=o}e.deps=t,e.depsTail=n}function bh(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Nm(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Nm(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Kr)||(e.globalVersion=Kr,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!bh(e))))return;e.flags|=2;const t=e.dep,n=nn,a=wa;nn=e,wa=!0;try{Om(e);const o=e.fn(e._value);(t.version===0||ci(o,e._value))&&(e.flags|=128,e._value=o,t.version++)}catch(o){throw t.version++,o}finally{nn=n,wa=a,Bm(e),e.flags&=-3}}function df(e,t=!1){const{dep:n,prevSub:a,nextSub:o}=e;if(a&&(a.nextSub=o,e.prevSub=void 0),o&&(o.prevSub=a,e.nextSub=void 0),n.subs===e&&(n.subs=a,!a&&n.computed)){n.computed.flags&=-5;for(let i=n.computed.deps;i;i=i.nextDep)df(i,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function Z1(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let wa=!0;const Fm=[];function Is(){Fm.push(wa),wa=!1}function xs(){const e=Fm.pop();wa=e===void 0?!0:e}function Kf(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=nn;nn=void 0;try{t()}finally{nn=n}}}let Kr=0;class K1{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class hf{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!nn||!wa||nn===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==nn)n=this.activeLink=new K1(nn,this),nn.deps?(n.prevDep=nn.depsTail,nn.depsTail.nextDep=n,nn.depsTail=n):nn.deps=nn.depsTail=n,Um(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const a=n.nextDep;a.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=a),n.prevDep=nn.depsTail,n.nextDep=void 0,nn.depsTail.nextDep=n,nn.depsTail=n,nn.deps===n&&(nn.deps=a)}return n}trigger(t){this.version++,Kr++,this.notify(t)}notify(t){cf();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{uf()}}}function Um(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let a=t.deps;a;a=a.nextDep)Um(a)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const ou=new WeakMap,ol=Symbol(""),_h=Symbol(""),Yr=Symbol("");function Qn(e,t,n){if(wa&&nn){let a=ou.get(e);a||ou.set(e,a=new Map);let o=a.get(n);o||(a.set(n,o=new hf),o.map=a,o.key=n),o.track()}}function gs(e,t,n,a,o,i){const l=ou.get(e);if(!l){Kr++;return}const c=d=>{d&&d.trigger()};if(cf(),t==="clear")l.forEach(c);else{const d=dt(e),h=d&&Au(n);if(d&&n==="length"){const f=Number(a);l.forEach((m,y)=>{(y==="length"||y===Yr||!La(y)&&y>=f)&&c(m)})}else switch((n!==void 0||l.has(void 0))&&c(l.get(n)),h&&c(l.get(Yr)),t){case"add":d?h&&c(l.get("length")):(c(l.get(ol)),Wl(e)&&c(l.get(_h)));break;case"delete":d||(c(l.get(ol)),Wl(e)&&c(l.get(_h)));break;case"set":Wl(e)&&c(l.get(ol));break}}uf()}function Y1(e,t){const n=ou.get(e);return n&&n.get(t)}function Dl(e){const t=Bt(e);return t===e?t:(Qn(t,"iterate",Yr),Vo(e)?t:t.map(Sa))}function Ou(e){return Qn(e=Bt(e),"iterate",Yr),e}function Qs(e,t){return $s(e)?Ls(e)?Xl(Sa(t)):Xl(t):Sa(t)}const J1={__proto__:null,[Symbol.iterator](){return _d(this,Symbol.iterator,e=>Qs(this,e))},concat(...e){return Dl(this).concat(...e.map(t=>dt(t)?Dl(t):t))},entries(){return _d(this,"entries",e=>(e[1]=Qs(this,e[1]),e))},every(e,t){return ds(this,"every",e,t,void 0,arguments)},filter(e,t){return ds(this,"filter",e,t,n=>n.map(a=>Qs(this,a)),arguments)},find(e,t){return ds(this,"find",e,t,n=>Qs(this,n),arguments)},findIndex(e,t){return ds(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return ds(this,"findLast",e,t,n=>Qs(this,n),arguments)},findLastIndex(e,t){return ds(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return ds(this,"forEach",e,t,void 0,arguments)},includes(...e){return wd(this,"includes",e)},indexOf(...e){return wd(this,"indexOf",e)},join(e){return Dl(this).join(e)},lastIndexOf(...e){return wd(this,"lastIndexOf",e)},map(e,t){return ds(this,"map",e,t,void 0,arguments)},pop(){return kr(this,"pop")},push(...e){return kr(this,"push",e)},reduce(e,...t){return Yf(this,"reduce",e,t)},reduceRight(e,...t){return Yf(this,"reduceRight",e,t)},shift(){return kr(this,"shift")},some(e,t){return ds(this,"some",e,t,void 0,arguments)},splice(...e){return kr(this,"splice",e)},toReversed(){return Dl(this).toReversed()},toSorted(e){return Dl(this).toSorted(e)},toSpliced(...e){return Dl(this).toSpliced(...e)},unshift(...e){return kr(this,"unshift",e)},values(){return _d(this,"values",e=>Qs(this,e))}};function _d(e,t,n){const a=Ou(e),o=a[t]();return a!==e&&!Vo(e)&&(o._next=o.next,o.next=()=>{const i=o._next();return i.done||(i.value=n(i.value)),i}),o}const X1=Array.prototype;function ds(e,t,n,a,o,i){const l=Ou(e),c=l!==e&&!Vo(e),d=l[t];if(d!==X1[t]){const m=d.apply(e,i);return c?Sa(m):m}let h=n;l!==e&&(c?h=function(m,y){return n.call(this,Qs(e,m),y,e)}:n.length>2&&(h=function(m,y){return n.call(this,m,y,e)}));const f=d.call(l,h,a);return c&&o?o(f):f}function Yf(e,t,n,a){const o=Ou(e);let i=n;return o!==e&&(Vo(e)?n.length>3&&(i=function(l,c,d){return n.call(this,l,c,d,e)}):i=function(l,c,d){return n.call(this,l,Qs(e,c),d,e)}),o[t](i,...a)}function wd(e,t,n){const a=Bt(e);Qn(a,"iterate",Yr);const o=a[t](...n);return(o===-1||o===!1)&&Bu(n[0])?(n[0]=Bt(n[0]),a[t](...n)):o}function kr(e,t,n=[]){Is(),cf();const a=Bt(e)[t].apply(e,n);return uf(),xs(),a}const Q1=af("__proto__,__v_isRef,__isVue"),zm=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(La));function ek(e){La(e)||(e=String(e));const t=Bt(this);return Qn(t,"has",e),t.hasOwnProperty(e)}class Hm{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,a){if(n==="__v_skip")return t.__v_skip;const o=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!o;if(n==="__v_isReadonly")return o;if(n==="__v_isShallow")return i;if(n==="__v_raw")return a===(o?i?uk:jm:i?qm:Gm).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(a)?t:void 0;const l=dt(t);if(!o){let d;if(l&&(d=J1[n]))return d;if(n==="hasOwnProperty")return ek}const c=Reflect.get(t,n,un(t)?t:a);if((La(n)?zm.has(n):Q1(n))||(o||Qn(t,"get",n),i))return c;if(un(c)){const d=l&&Au(n)?c:c.value;return o&&Yt(d)?Ch(d):d}return Yt(c)?o?Ch(c):ul(c):c}}class Vm extends Hm{constructor(t=!1){super(!1,t)}set(t,n,a,o){let i=t[n];const l=dt(t)&&Au(n);if(!this._isShallow){const h=$s(i);if(!Vo(a)&&!$s(a)&&(i=Bt(i),a=Bt(a)),!l&&un(i)&&!un(a))return h||(i.value=a),!0}const c=l?Number(n)<t.length:qt(t,n),d=Reflect.set(t,n,a,un(t)?t:o);return t===Bt(o)&&(c?ci(a,i)&&gs(t,"set",n,a):gs(t,"add",n,a)),d}deleteProperty(t,n){const a=qt(t,n);t[n];const o=Reflect.deleteProperty(t,n);return o&&a&&gs(t,"delete",n,void 0),o}has(t,n){const a=Reflect.has(t,n);return(!La(n)||!zm.has(n))&&Qn(t,"has",n),a}ownKeys(t){return Qn(t,"iterate",dt(t)?"length":ol),Reflect.ownKeys(t)}}class tk extends Hm{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const nk=new Vm,ok=new tk,ak=new Vm(!0);const wh=e=>e,Tc=e=>Reflect.getPrototypeOf(e);function sk(e,t,n){return function(...a){const o=this.__v_raw,i=Bt(o),l=Wl(i),c=e==="entries"||e===Symbol.iterator&&l,d=e==="keys"&&l,h=o[e](...a),f=n?wh:t?Xl:Sa;return!t&&Qn(i,"iterate",d?_h:ol),{next(){const{value:m,done:y}=h.next();return y?{value:m,done:y}:{value:c?[f(m[0]),f(m[1])]:f(m),done:y}},[Symbol.iterator](){return this}}}}function Mc(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function ik(e,t){const n={get(o){const i=this.__v_raw,l=Bt(i),c=Bt(o);e||(ci(o,c)&&Qn(l,"get",o),Qn(l,"get",c));const{has:d}=Tc(l),h=t?wh:e?Xl:Sa;if(d.call(l,o))return h(i.get(o));if(d.call(l,c))return h(i.get(c));i!==l&&i.get(o)},get size(){const o=this.__v_raw;return!e&&Qn(Bt(o),"iterate",ol),o.size},has(o){const i=this.__v_raw,l=Bt(i),c=Bt(o);return e||(ci(o,c)&&Qn(l,"has",o),Qn(l,"has",c)),o===c?i.has(o):i.has(o)||i.has(c)},forEach(o,i){const l=this,c=l.__v_raw,d=Bt(c),h=t?wh:e?Xl:Sa;return!e&&Qn(d,"iterate",ol),c.forEach((f,m)=>o.call(i,h(f),h(m),l))}};return Rn(n,e?{add:Mc("add"),set:Mc("set"),delete:Mc("delete"),clear:Mc("clear")}:{add(o){!t&&!Vo(o)&&!$s(o)&&(o=Bt(o));const i=Bt(this);return Tc(i).has.call(i,o)||(i.add(o),gs(i,"add",o,o)),this},set(o,i){!t&&!Vo(i)&&!$s(i)&&(i=Bt(i));const l=Bt(this),{has:c,get:d}=Tc(l);let h=c.call(l,o);h||(o=Bt(o),h=c.call(l,o));const f=d.call(l,o);return l.set(o,i),h?ci(i,f)&&gs(l,"set",o,i):gs(l,"add",o,i),this},delete(o){const i=Bt(this),{has:l,get:c}=Tc(i);let d=l.call(i,o);d||(o=Bt(o),d=l.call(i,o)),c&&c.call(i,o);const h=i.delete(o);return d&&gs(i,"delete",o,void 0),h},clear(){const o=Bt(this),i=o.size!==0,l=o.clear();return i&&gs(o,"clear",void 0,void 0),l}}),["keys","values","entries",Symbol.iterator].forEach(o=>{n[o]=sk(o,e,t)}),n}function ff(e,t){const n=ik(e,t);return(a,o,i)=>o==="__v_isReactive"?!e:o==="__v_isReadonly"?e:o==="__v_raw"?a:Reflect.get(qt(n,o)&&o in a?n:a,o,i)}const lk={get:ff(!1,!1)},rk={get:ff(!1,!0)},ck={get:ff(!0,!1)};const Gm=new WeakMap,qm=new WeakMap,jm=new WeakMap,uk=new WeakMap;function dk(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function hk(e){return e.__v_skip||!Object.isExtensible(e)?0:dk(R1(e))}function ul(e){return $s(e)?e:pf(e,!1,nk,lk,Gm)}function Wm(e){return pf(e,!1,ak,rk,qm)}function Ch(e){return pf(e,!0,ok,ck,jm)}function pf(e,t,n,a,o){if(!Yt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=hk(e);if(i===0)return e;const l=o.get(e);if(l)return l;const c=new Proxy(e,i===2?a:n);return o.set(e,c),c}function Ls(e){return $s(e)?Ls(e.__v_raw):!!(e&&e.__v_isReactive)}function $s(e){return!!(e&&e.__v_isReadonly)}function Vo(e){return!!(e&&e.__v_isShallow)}function Bu(e){return e?!!e.__v_raw:!1}function Bt(e){const t=e&&e.__v_raw;return t?Bt(t):e}function vf(e){return!qt(e,"__v_skip")&&Object.isExtensible(e)&&Im(e,"__v_skip",!0),e}const Sa=e=>Yt(e)?ul(e):e,Xl=e=>Yt(e)?Ch(e):e;function un(e){return e?e.__v_isRef===!0:!1}function P(e){return Zm(e,!1)}function fk(e){return Zm(e,!0)}function Zm(e,t){return un(e)?e:new pk(e,t)}class pk{constructor(t,n){this.dep=new hf,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:Bt(t),this._value=n?t:Sa(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,a=this.__v_isShallow||Vo(t)||$s(t);t=a?t:Bt(t),ci(t,n)&&(this._rawValue=t,this._value=a?t:Sa(t),this.dep.trigger())}}function N(e){return un(e)?e.value:e}function au(e){return bt(e)?e():N(e)}const vk={get:(e,t,n)=>t==="__v_raw"?e:N(Reflect.get(e,t,n)),set:(e,t,n,a)=>{const o=e[t];return un(o)&&!un(n)?(o.value=n,!0):Reflect.set(e,t,n,a)}};function Km(e){return Ls(e)?e:new Proxy(e,vk)}function mk(e){const t=dt(e)?new Array(e.length):{};for(const n in e)t[n]=yk(e,n);return t}class gk{constructor(t,n,a){this._object=t,this._key=n,this._defaultValue=a,this.__v_isRef=!0,this._value=void 0,this._raw=Bt(t);let o=!0,i=t;if(!dt(t)||!Au(String(n)))do o=!Bu(i)||Vo(i);while(o&&(i=i.__v_raw));this._shallow=o}get value(){let t=this._object[this._key];return this._shallow&&(t=N(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&un(this._raw[this._key])){const n=this._object[this._key];if(un(n)){n.value=t;return}}this._object[this._key]=t}get dep(){return Y1(this._raw,this._key)}}function yk(e,t,n){return new gk(e,t,n)}class kk{constructor(t,n,a){this.fn=t,this.setter=n,this._value=void 0,this.dep=new hf(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Kr-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=a}notify(){if(this.flags|=16,!(this.flags&8)&&nn!==this)return Rm(this,!0),!0}get value(){const t=this.dep.track();return Nm(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function bk(e,t,n=!1){let a,o;return bt(e)?a=e:(a=e.get,o=e.set),new kk(a,o,n)}const Ac={},su=new WeakMap;let Ki;function _k(e,t=!1,n=Ki){if(n){let a=su.get(n);a||su.set(n,a=[]),a.push(e)}}function wk(e,t,n=Qt){const{immediate:a,deep:o,once:i,scheduler:l,augmentJob:c,call:d}=n,h=I=>o?I:Vo(I)||o===!1||o===0?ys(I,1):ys(I);let f,m,y,k,S=!1,x=!1;if(un(e)?(m=()=>e.value,S=Vo(e)):Ls(e)?(m=()=>h(e),S=!0):dt(e)?(x=!0,S=e.some(I=>Ls(I)||Vo(I)),m=()=>e.map(I=>{if(un(I))return I.value;if(Ls(I))return h(I);if(bt(I))return d?d(I,2):I()})):bt(e)?t?m=d?()=>d(e,2):e:m=()=>{if(y){Is();try{y()}finally{xs()}}const I=Ki;Ki=f;try{return d?d(e,3,[k]):e(k)}finally{Ki=I}}:m=_a,t&&o){const I=m,T=o===!0?1/0:o;m=()=>ys(I(),T)}const E=Em(),$=()=>{f.stop(),E&&E.active&&lf(E.effects,f)};if(i&&t){const I=t;t=(...T)=>{I(...T),$()}}let w=x?new Array(e.length).fill(Ac):Ac;const _=I=>{if(!(!(f.flags&1)||!f.dirty&&!I))if(t){const T=f.run();if(o||S||(x?T.some((B,M)=>ci(B,w[M])):ci(T,w))){y&&y();const B=Ki;Ki=f;try{const M=[T,w===Ac?void 0:x&&w[0]===Ac?[]:w,k];w=T,d?d(t,3,M):t(...M)}finally{Ki=B}}}else f.run()};return c&&c(_),f=new Pm(m),f.scheduler=l?()=>l(_,!1):_,k=I=>_k(I,!1,f),y=f.onStop=()=>{const I=su.get(f);if(I){if(d)d(I,4);else for(const T of I)T();su.delete(f)}},t?a?_(!0):w=f.run():l?l(_.bind(null,!0),!0):f.run(),$.pause=f.pause.bind(f),$.resume=f.resume.bind(f),$.stop=$,$}function ys(e,t=1/0,n){if(t<=0||!Yt(e)||e.__v_skip||(n=n||new Map,(n.get(e)||0)>=t))return e;if(n.set(e,t),t--,un(e))ys(e.value,t,n);else if(dt(e))for(let a=0;a<e.length;a++)ys(e[a],t,n);else if(ar(e)||Wl(e))e.forEach(a=>{ys(a,t,n)});else if(Sm(e)){for(const a in e)ys(e[a],t,n);for(const a of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,a)&&ys(e[a],t,n)}return e}function rc(e,t,n,a){try{return a?e(...a):e()}catch(o){Nu(o,t,n)}}function Ia(e,t,n,a){if(bt(e)){const o=rc(e,t,n,a);return o&&Cm(o)&&o.catch(i=>{Nu(i,t,n)}),o}if(dt(e)){const o=[];for(let i=0;i<e.length;i++)o.push(Ia(e[i],t,n,a));return o}}function Nu(e,t,n,a=!0){const o=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:l}=t&&t.appContext.config||Qt;if(t){let c=t.parent;const d=t.proxy,h=`https://vuejs.org/error-reference/#runtime-${n}`;for(;c;){const f=c.ec;if(f){for(let m=0;m<f.length;m++)if(f[m](e,d,h)===!1)return}c=c.parent}if(i){Is(),rc(i,null,10,[e,d,h]),xs();return}}Ck(e,n,o,a,l)}function Ck(e,t,n,a=!0,o=!1){if(o)throw e;console.error(e)}const yo=[];let Ga=-1;const Zl=[];let ei=null,Fl=0;const Ym=Promise.resolve();let iu=null;function dn(e){const t=iu||Ym;return e?t.then(this?e.bind(this):e):t}function Lk(e){let t=Ga+1,n=yo.length;for(;t<n;){const a=t+n>>>1,o=yo[a],i=Jr(o);i<e||i===e&&o.flags&2?t=a+1:n=a}return t}function mf(e){if(!(e.flags&1)){const t=Jr(e),n=yo[yo.length-1];!n||!(e.flags&2)&&t>=Jr(n)?yo.push(e):yo.splice(Lk(t),0,e),e.flags|=1,Jm()}}function Jm(){iu||(iu=Ym.then(eg))}function Xm(e){dt(e)?Zl.push(...e):ei&&e.id===-1?ei.splice(Fl+1,0,e):e.flags&1||(Zl.push(e),e.flags|=1),Jm()}function Jf(e,t,n=Ga+1){for(;n<yo.length;n++){const a=yo[n];if(a&&a.flags&2){if(e&&a.id!==e.uid)continue;yo.splice(n,1),n--,a.flags&4&&(a.flags&=-2),a(),a.flags&4||(a.flags&=-2)}}}function Qm(e){if(Zl.length){const t=[...new Set(Zl)].sort((n,a)=>Jr(n)-Jr(a));if(Zl.length=0,ei){ei.push(...t);return}for(ei=t,Fl=0;Fl<ei.length;Fl++){const n=ei[Fl];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}ei=null,Fl=0}}const Jr=e=>e.id==null?e.flags&2?-1:1/0:e.id;function eg(e){try{for(Ga=0;Ga<yo.length;Ga++){const t=yo[Ga];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),rc(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Ga<yo.length;Ga++){const t=yo[Ga];t&&(t.flags&=-2)}Ga=-1,yo.length=0,Qm(),iu=null,(yo.length||Zl.length)&&eg()}}let Gn=null,tg=null;function lu(e){const t=Gn;return Gn=e,tg=e&&e.type.__scopeId||null,t}function Ue(e,t=Gn,n){if(!t||e._n)return e;const a=(...o)=>{a._d&&uu(-1);const i=lu(t);let l;try{l=e(...o)}finally{lu(i),a._d&&uu(1)}return l};return a._n=!0,a._c=!0,a._d=!0,a}function Ge(e,t){if(Gn===null)return e;const n=Gu(Gn),a=e.dirs||(e.dirs=[]);for(let o=0;o<t.length;o++){let[i,l,c,d=Qt]=t[o];i&&(bt(i)&&(i={mounted:i,updated:i}),i.deep&&ys(l),a.push({dir:i,instance:n,value:l,oldValue:void 0,arg:c,modifiers:d}))}return e}function zi(e,t,n,a){const o=e.dirs,i=t&&t.dirs;for(let l=0;l<o.length;l++){const c=o[l];i&&(c.oldValue=i[l].value);let d=c.dir[a];d&&(Is(),Ia(d,n,8,[e.el,c,e,t]),xs())}}function Rr(e,t){if(to){let n=to.provides;const a=to.parent&&to.parent.provides;a===n&&(n=to.provides=Object.create(a)),n[e]=t}}function $o(e,t,n=!1){const a=Vu();if(a||al){let o=al?al._context.provides:a?a.parent==null||a.ce?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides:void 0;if(o&&e in o)return o[e];if(arguments.length>1)return n&&bt(t)?t.call(a&&a.proxy):t}}function Sk(){return!!(Vu()||al)}const Ik=Symbol.for("v-scx"),xk=()=>$o(Ik);function Ye(e,t,n){return ng(e,t,n)}function ng(e,t,n=Qt){const{immediate:a,deep:o,flush:i,once:l}=n,c=Rn({},n),d=t&&a||!t&&i!=="post";let h;if(nc){if(i==="sync"){const k=xk();h=k.__watcherHandles||(k.__watcherHandles=[])}else if(!d){const k=()=>{};return k.stop=_a,k.resume=_a,k.pause=_a,k}}const f=to;c.call=(k,S,x)=>Ia(k,f,S,x);let m=!1;i==="post"?c.scheduler=k=>{mo(k,f&&f.suspense)}:i!=="sync"&&(m=!0,c.scheduler=(k,S)=>{S?k():mf(k)}),c.augmentJob=k=>{t&&(k.flags|=4),m&&(k.flags|=2,f&&(k.id=f.uid,k.i=f))};const y=wk(e,t,c);return nc&&(h?h.push(y):d&&y()),y}function $k(e,t,n){const a=this.proxy,o=hn(e)?e.includes(".")?og(a,e):()=>a[e]:e.bind(a,a);let i;bt(t)?i=t:(i=t.handler,n=t);const l=cc(this),c=ng(o,i.bind(a),n);return l(),c}function og(e,t){const n=t.split(".");return()=>{let a=e;for(let o=0;o<n.length&&a;o++)a=a[n[o]];return a}}const ag=Symbol("_vte"),sg=e=>e.__isTeleport,Or=e=>e&&(e.disabled||e.disabled===""),Xf=e=>e&&(e.defer||e.defer===""),Qf=e=>typeof SVGElement<"u"&&e instanceof SVGElement,ep=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Lh=(e,t)=>{const n=e&&e.to;return hn(n)?t?t(n):null:n},ig={name:"Teleport",__isTeleport:!0,process(e,t,n,a,o,i,l,c,d,h){const{mc:f,pc:m,pbc:y,o:{insert:k,querySelector:S,createText:x,createComment:E}}=h,$=Or(t.props);let{shapeFlag:w,children:_,dynamicChildren:I}=t;if(e==null){const T=t.el=x(""),B=t.anchor=x("");k(T,n,a),k(B,n,a);const M=(A,G)=>{w&16&&f(_,A,G,o,i,l,c,d)},R=()=>{const A=t.target=Lh(t.props,S),G=lg(A,t,x,k);A&&(l!=="svg"&&Qf(A)?l="svg":l!=="mathml"&&ep(A)&&(l="mathml"),o&&o.isCE&&(o.ce._teleportTargets||(o.ce._teleportTargets=new Set)).add(A),$||(M(A,G),Gc(t,!1)))};$&&(M(n,B),Gc(t,!0)),Xf(t.props)?(t.el.__isMounted=!1,mo(()=>{R(),delete t.el.__isMounted},i)):R()}else{if(Xf(t.props)&&e.el.__isMounted===!1){mo(()=>{ig.process(e,t,n,a,o,i,l,c,d,h)},i);return}t.el=e.el,t.targetStart=e.targetStart;const T=t.anchor=e.anchor,B=t.target=e.target,M=t.targetAnchor=e.targetAnchor,R=Or(e.props),A=R?n:B,G=R?T:M;if(l==="svg"||Qf(B)?l="svg":(l==="mathml"||ep(B))&&(l="mathml"),I?(y(e.dynamicChildren,I,A,o,i,l,c),_f(e,t,!0)):d||m(e,t,A,G,o,i,l,c,!1),$)R?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):Ec(t,n,T,h,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const F=t.target=Lh(t.props,S);F&&Ec(t,F,null,h,0)}else R&&Ec(t,B,M,h,1);Gc(t,$)}},remove(e,t,n,{um:a,o:{remove:o}},i){const{shapeFlag:l,children:c,anchor:d,targetStart:h,targetAnchor:f,target:m,props:y}=e;if(m&&(o(h),o(f)),i&&o(d),l&16){const k=i||!Or(y);for(let S=0;S<c.length;S++){const x=c[S];a(x,t,n,k,!!x.dynamicChildren)}}},move:Ec,hydrate:Tk};function Ec(e,t,n,{o:{insert:a},m:o},i=2){i===0&&a(e.targetAnchor,t,n);const{el:l,anchor:c,shapeFlag:d,children:h,props:f}=e,m=i===2;if(m&&a(l,t,n),(!m||Or(f))&&d&16)for(let y=0;y<h.length;y++)o(h[y],t,n,2);m&&a(c,t,n)}function Tk(e,t,n,a,o,i,{o:{nextSibling:l,parentNode:c,querySelector:d,insert:h,createText:f}},m){function y(x,E,$,w){E.anchor=m(l(x),E,c(x),n,a,o,i),E.targetStart=$,E.targetAnchor=w}const k=t.target=Lh(t.props,d),S=Or(t.props);if(k){const x=k._lpa||k.firstChild;if(t.shapeFlag&16)if(S)y(e,t,x,x&&l(x));else{t.anchor=l(e);let E=x;for(;E;){if(E&&E.nodeType===8){if(E.data==="teleport start anchor")t.targetStart=E;else if(E.data==="teleport anchor"){t.targetAnchor=E,k._lpa=t.targetAnchor&&l(t.targetAnchor);break}}E=l(E)}t.targetAnchor||lg(k,t,f,h),m(x&&l(x),t,k,n,a,o,i)}Gc(t,S)}else S&&t.shapeFlag&16&&y(e,t,e,l(e));return t.anchor&&l(t.anchor)}const Xr=ig;function Gc(e,t){const n=e.ctx;if(n&&n.ut){let a,o;for(t?(a=e.el,o=e.anchor):(a=e.targetStart,o=e.targetAnchor);a&&a!==o;)a.nodeType===1&&a.setAttribute("data-v-owner",n.uid),a=a.nextSibling;n.ut()}}function lg(e,t,n,a){const o=t.targetStart=n(""),i=t.targetAnchor=n("");return o[ag]=i,e&&(a(o,e),a(i,e)),i}const ms=Symbol("_leaveCb"),Pc=Symbol("_enterCb");function Mk(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return rn(()=>{e.isMounted=!0}),gg(()=>{e.isUnmounting=!0}),e}const ea=[Function,Array],rg={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ea,onEnter:ea,onAfterEnter:ea,onEnterCancelled:ea,onBeforeLeave:ea,onLeave:ea,onAfterLeave:ea,onLeaveCancelled:ea,onBeforeAppear:ea,onAppear:ea,onAfterAppear:ea,onAppearCancelled:ea},cg=e=>{const t=e.subTree;return t.component?cg(t.component):t},Ak={name:"BaseTransition",props:rg,setup(e,{slots:t}){const n=Vu(),a=Mk();return()=>{const o=t.default&&hg(t.default(),!0);if(!o||!o.length)return;const i=ug(o),l=Bt(e),{mode:c}=l;if(a.isLeaving)return Cd(i);const d=tp(i);if(!d)return Cd(i);let h=Sh(d,l,a,n,m=>h=m);d.type!==eo&&Qr(d,h);let f=n.subTree&&tp(n.subTree);if(f&&f.type!==eo&&!Ji(f,d)&&cg(n).type!==eo){let m=Sh(f,l,a,n);if(Qr(f,m),c==="out-in"&&d.type!==eo)return a.isLeaving=!0,m.afterLeave=()=>{a.isLeaving=!1,n.job.flags&8||n.update(),delete m.afterLeave,f=void 0},Cd(i);c==="in-out"&&d.type!==eo?m.delayLeave=(y,k,S)=>{const x=dg(a,f);x[String(f.key)]=f,y[ms]=()=>{k(),y[ms]=void 0,delete h.delayedLeave,f=void 0},h.delayedLeave=()=>{S(),delete h.delayedLeave,f=void 0}}:f=void 0}else f&&(f=void 0);return i}}};function ug(e){let t=e[0];if(e.length>1){for(const n of e)if(n.type!==eo){t=n;break}}return t}const Ek=Ak;function dg(e,t){const{leavingVNodes:n}=e;let a=n.get(t.type);return a||(a=Object.create(null),n.set(t.type,a)),a}function Sh(e,t,n,a,o){const{appear:i,mode:l,persisted:c=!1,onBeforeEnter:d,onEnter:h,onAfterEnter:f,onEnterCancelled:m,onBeforeLeave:y,onLeave:k,onAfterLeave:S,onLeaveCancelled:x,onBeforeAppear:E,onAppear:$,onAfterAppear:w,onAppearCancelled:_}=t,I=String(e.key),T=dg(n,e),B=(A,G)=>{A&&Ia(A,a,9,G)},M=(A,G)=>{const F=G[1];B(A,G),dt(A)?A.every(j=>j.length<=1)&&F():A.length<=1&&F()},R={mode:l,persisted:c,beforeEnter(A){let G=d;if(!n.isMounted)if(i)G=E||d;else return;A[ms]&&A[ms](!0);const F=T[I];F&&Ji(e,F)&&F.el[ms]&&F.el[ms](),B(G,[A])},enter(A){let G=h,F=f,j=m;if(!n.isMounted)if(i)G=$||h,F=w||f,j=_||m;else return;let K=!1;const J=A[Pc]=ue=>{K||(K=!0,ue?B(j,[A]):B(F,[A]),R.delayedLeave&&R.delayedLeave(),A[Pc]=void 0)};G?M(G,[A,J]):J()},leave(A,G){const F=String(e.key);if(A[Pc]&&A[Pc](!0),n.isUnmounting)return G();B(y,[A]);let j=!1;const K=A[ms]=J=>{j||(j=!0,G(),J?B(x,[A]):B(S,[A]),A[ms]=void 0,T[F]===e&&delete T[F])};T[F]=e,k?M(k,[A,K]):K()},clone(A){const G=Sh(A,t,n,a,o);return o&&o(G),G}};return R}function Cd(e){if(Fu(e))return e=hi(e),e.children=null,e}function tp(e){if(!Fu(e))return sg(e.type)&&e.children?ug(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:n}=e;if(n){if(t&16)return n[0];if(t&32&&bt(n.default))return n.default()}}function Qr(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Qr(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function hg(e,t=!1,n){let a=[],o=0;for(let i=0;i<e.length;i++){let l=e[i];const c=n==null?l.key:String(n)+String(l.key!=null?l.key:i);l.type===xe?(l.patchFlag&128&&o++,a=a.concat(hg(l.children,t,c))):(t||l.type!==eo)&&a.push(c!=null?hi(l,{key:c}):l)}if(o>1)for(let i=0;i<a.length;i++)a[i].patchFlag=-2;return a}function fg(e,t){return bt(e)?Rn({name:e.name},t,{setup:e}):e}function pg(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const ru=new WeakMap;function Br(e,t,n,a,o=!1){if(dt(e)){e.forEach((S,x)=>Br(S,t&&(dt(t)?t[x]:t),n,a,o));return}if(Kl(a)&&!o){a.shapeFlag&512&&a.type.__asyncResolved&&a.component.subTree.component&&Br(e,t,n,a.component.subTree);return}const i=a.shapeFlag&4?Gu(a.component):a.el,l=o?null:i,{i:c,r:d}=e,h=t&&t.r,f=c.refs===Qt?c.refs={}:c.refs,m=c.setupState,y=Bt(m),k=m===Qt?wm:S=>qt(y,S);if(h!=null&&h!==d){if(np(t),hn(h))f[h]=null,k(h)&&(m[h]=null);else if(un(h)){h.value=null;const S=t;S.k&&(f[S.k]=null)}}if(bt(d))rc(d,c,12,[l,f]);else{const S=hn(d),x=un(d);if(S||x){const E=()=>{if(e.f){const $=S?k(d)?m[d]:f[d]:d.value;if(o)dt($)&&lf($,i);else if(dt($))$.includes(i)||$.push(i);else if(S)f[d]=[i],k(d)&&(m[d]=f[d]);else{const w=[i];d.value=w,e.k&&(f[e.k]=w)}}else S?(f[d]=l,k(d)&&(m[d]=l)):x&&(d.value=l,e.k&&(f[e.k]=l))};if(l){const $=()=>{E(),ru.delete(e)};$.id=-1,ru.set(e,$),mo($,n)}else np(e),E()}}}function np(e){const t=ru.get(e);t&&(t.flags|=8,ru.delete(e))}Ru().requestIdleCallback;Ru().cancelIdleCallback;const Kl=e=>!!e.type.__asyncLoader,Fu=e=>e.type.__isKeepAlive;function Pk(e,t){vg(e,"a",t)}function Dk(e,t){vg(e,"da",t)}function vg(e,t,n=to){const a=e.__wdc||(e.__wdc=()=>{let o=n;for(;o;){if(o.isDeactivated)return;o=o.parent}return e()});if(Uu(t,a,n),n){let o=n.parent;for(;o&&o.parent;)Fu(o.parent.vnode)&&Rk(a,t,n,o),o=o.parent}}function Rk(e,t,n,a){const o=Uu(t,e,a,!0);An(()=>{lf(a[t],o)},n)}function Uu(e,t,n=to,a=!1){if(n){const o=n[e]||(n[e]=[]),i=t.__weh||(t.__weh=(...l)=>{Is();const c=cc(n),d=Ia(t,n,e,l);return c(),xs(),d});return a?o.unshift(i):o.push(i),i}}const Ms=e=>(t,n=to)=>{(!nc||e==="sp")&&Uu(e,(...a)=>t(...a),n)},Ok=Ms("bm"),rn=Ms("m"),mg=Ms("bu"),Bk=Ms("u"),gg=Ms("bum"),An=Ms("um"),Nk=Ms("sp"),Fk=Ms("rtg"),Uk=Ms("rtc");function zk(e,t=to){Uu("ec",e,t)}const yg="components";function gf(e,t){return bg(yg,e,!0,t)||e}const kg=Symbol.for("v-ndc");function Hk(e){return hn(e)?bg(yg,e,!1)||e:e||kg}function bg(e,t,n=!0,a=!1){const o=Gn||to;if(o){const i=o.type;{const c=S0(i,!1);if(c&&(c===t||c===aa(t)||c===Pu(aa(t))))return i}const l=op(o[e]||i[e],t)||op(o.appContext[e],t);return!l&&a?i:l}}function op(e,t){return e&&(e[t]||e[aa(t)]||e[Pu(aa(t))])}function qe(e,t,n,a){let o;const i=n,l=dt(e);if(l||hn(e)){const c=l&&Ls(e);let d=!1,h=!1;c&&(d=!Vo(e),h=$s(e),e=Ou(e)),o=new Array(e.length);for(let f=0,m=e.length;f<m;f++)o[f]=t(d?h?Xl(Sa(e[f])):Sa(e[f]):e[f],f,void 0,i)}else if(typeof e=="number"){o=new Array(e);for(let c=0;c<e;c++)o[c]=t(c+1,c,void 0,i)}else if(Yt(e))if(e[Symbol.iterator])o=Array.from(e,(c,d)=>t(c,d,void 0,i));else{const c=Object.keys(e);o=new Array(c.length);for(let d=0,h=c.length;d<h;d++){const f=c[d];o[d]=t(e[f],f,d,i)}}else o=[];return o}function yf(e,t){for(let n=0;n<t.length;n++){const a=t[n];if(dt(a))for(let o=0;o<a.length;o++)e[a[o].name]=a[o].fn;else a&&(e[a.name]=a.key?(...o)=>{const i=a.fn(...o);return i&&(i.key=a.key),i}:a.fn)}return e}function ko(e,t,n={},a,o){if(Gn.ce||Gn.parent&&Kl(Gn.parent)&&Gn.parent.ce){const h=Object.keys(n).length>0;return t!=="default"&&(n.name=t),p(),ze(xe,null,[Ee("slot",n,a&&a())],h?-2:64)}let i=e[t];i&&i._c&&(i._d=!1),p();const l=i&&_g(i(n)),c=n.key||l&&l.key,d=ze(xe,{key:(c&&!La(c)?c:`_${t}`)+(!l&&a?"_fb":"")},l||(a?a():[]),l&&e._===1?64:-2);return!o&&d.scopeId&&(d.slotScopeIds=[d.scopeId+"-s"]),i&&i._c&&(i._d=!0),d}function _g(e){return e.some(t=>tc(t)?!(t.type===eo||t.type===xe&&!_g(t.children)):!0)?e:null}const Ih=e=>e?Ug(e)?Gu(e):Ih(e.parent):null,Nr=Rn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Ih(e.parent),$root:e=>Ih(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Cg(e),$forceUpdate:e=>e.f||(e.f=()=>{mf(e.update)}),$nextTick:e=>e.n||(e.n=dn.bind(e.proxy)),$watch:e=>$k.bind(e)}),Ld=(e,t)=>e!==Qt&&!e.__isScriptSetup&&qt(e,t),Vk={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:a,data:o,props:i,accessCache:l,type:c,appContext:d}=e;if(t[0]!=="$"){const y=l[t];if(y!==void 0)switch(y){case 1:return a[t];case 2:return o[t];case 4:return n[t];case 3:return i[t]}else{if(Ld(a,t))return l[t]=1,a[t];if(o!==Qt&&qt(o,t))return l[t]=2,o[t];if(qt(i,t))return l[t]=3,i[t];if(n!==Qt&&qt(n,t))return l[t]=4,n[t];xh&&(l[t]=0)}}const h=Nr[t];let f,m;if(h)return t==="$attrs"&&Qn(e.attrs,"get",""),h(e);if((f=c.__cssModules)&&(f=f[t]))return f;if(n!==Qt&&qt(n,t))return l[t]=4,n[t];if(m=d.config.globalProperties,qt(m,t))return m[t]},set({_:e},t,n){const{data:a,setupState:o,ctx:i}=e;return Ld(o,t)?(o[t]=n,!0):a!==Qt&&qt(a,t)?(a[t]=n,!0):qt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:a,appContext:o,props:i,type:l}},c){let d;return!!(n[c]||e!==Qt&&c[0]!=="$"&&qt(e,c)||Ld(t,c)||qt(i,c)||qt(a,c)||qt(Nr,c)||qt(o.config.globalProperties,c)||(d=l.__cssModules)&&d[c])},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:qt(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function ap(e){return dt(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let xh=!0;function Gk(e){const t=Cg(e),n=e.proxy,a=e.ctx;xh=!1,t.beforeCreate&&sp(t.beforeCreate,e,"bc");const{data:o,computed:i,methods:l,watch:c,provide:d,inject:h,created:f,beforeMount:m,mounted:y,beforeUpdate:k,updated:S,activated:x,deactivated:E,beforeDestroy:$,beforeUnmount:w,destroyed:_,unmounted:I,render:T,renderTracked:B,renderTriggered:M,errorCaptured:R,serverPrefetch:A,expose:G,inheritAttrs:F,components:j,directives:K,filters:J}=t;if(h&&qk(h,a,null),l)for(const se in l){const U=l[se];bt(U)&&(a[se]=U.bind(n))}if(o){const se=o.call(n,n);Yt(se)&&(e.data=ul(se))}if(xh=!0,i)for(const se in i){const U=i[se],Q=bt(U)?U.bind(n,n):bt(U.get)?U.get.bind(n,n):_a,oe=!bt(U)&&bt(U.set)?U.set.bind(n):_a,he=z({get:Q,set:oe});Object.defineProperty(a,se,{enumerable:!0,configurable:!0,get:()=>he.value,set:Te=>he.value=Te})}if(c)for(const se in c)wg(c[se],a,n,se);if(d){const se=bt(d)?d.call(n):d;Reflect.ownKeys(se).forEach(U=>{Rr(U,se[U])})}f&&sp(f,e,"c");function Z(se,U){dt(U)?U.forEach(Q=>se(Q.bind(n))):U&&se(U.bind(n))}if(Z(Ok,m),Z(rn,y),Z(mg,k),Z(Bk,S),Z(Pk,x),Z(Dk,E),Z(zk,R),Z(Uk,B),Z(Fk,M),Z(gg,w),Z(An,I),Z(Nk,A),dt(G))if(G.length){const se=e.exposed||(e.exposed={});G.forEach(U=>{Object.defineProperty(se,U,{get:()=>n[U],set:Q=>n[U]=Q,enumerable:!0})})}else e.exposed||(e.exposed={});T&&e.render===_a&&(e.render=T),F!=null&&(e.inheritAttrs=F),j&&(e.components=j),K&&(e.directives=K),A&&pg(e)}function qk(e,t,n=_a){dt(e)&&(e=$h(e));for(const a in e){const o=e[a];let i;Yt(o)?"default"in o?i=$o(o.from||a,o.default,!0):i=$o(o.from||a):i=$o(o),un(i)?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>i.value,set:l=>i.value=l}):t[a]=i}}function sp(e,t,n){Ia(dt(e)?e.map(a=>a.bind(t.proxy)):e.bind(t.proxy),t,n)}function wg(e,t,n,a){let o=a.includes(".")?og(n,a):()=>n[a];if(hn(e)){const i=t[e];bt(i)&&Ye(o,i)}else if(bt(e))Ye(o,e.bind(n));else if(Yt(e))if(dt(e))e.forEach(i=>wg(i,t,n,a));else{const i=bt(e.handler)?e.handler.bind(n):t[e.handler];bt(i)&&Ye(o,i,e)}}function Cg(e){const t=e.type,{mixins:n,extends:a}=t,{mixins:o,optionsCache:i,config:{optionMergeStrategies:l}}=e.appContext,c=i.get(t);let d;return c?d=c:!o.length&&!n&&!a?d=t:(d={},o.length&&o.forEach(h=>cu(d,h,l,!0)),cu(d,t,l)),Yt(t)&&i.set(t,d),d}function cu(e,t,n,a=!1){const{mixins:o,extends:i}=t;i&&cu(e,i,n,!0),o&&o.forEach(l=>cu(e,l,n,!0));for(const l in t)if(!(a&&l==="expose")){const c=jk[l]||n&&n[l];e[l]=c?c(e[l],t[l]):t[l]}return e}const jk={data:ip,props:lp,emits:lp,methods:Sr,computed:Sr,beforeCreate:po,created:po,beforeMount:po,mounted:po,beforeUpdate:po,updated:po,beforeDestroy:po,beforeUnmount:po,destroyed:po,unmounted:po,activated:po,deactivated:po,errorCaptured:po,serverPrefetch:po,components:Sr,directives:Sr,watch:Zk,provide:ip,inject:Wk};function ip(e,t){return t?e?function(){return Rn(bt(e)?e.call(this,this):e,bt(t)?t.call(this,this):t)}:t:e}function Wk(e,t){return Sr($h(e),$h(t))}function $h(e){if(dt(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function po(e,t){return e?[...new Set([].concat(e,t))]:t}function Sr(e,t){return e?Rn(Object.create(null),e,t):t}function lp(e,t){return e?dt(e)&&dt(t)?[...new Set([...e,...t])]:Rn(Object.create(null),ap(e),ap(t??{})):t}function Zk(e,t){if(!e)return t;if(!t)return e;const n=Rn(Object.create(null),e);for(const a in t)n[a]=po(e[a],t[a]);return n}function Lg(){return{app:null,config:{isNativeTag:wm,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Kk=0;function Yk(e,t){return function(a,o=null){bt(a)||(a=Rn({},a)),o!=null&&!Yt(o)&&(o=null);const i=Lg(),l=new WeakSet,c=[];let d=!1;const h=i.app={_uid:Kk++,_component:a,_props:o,_container:null,_context:i,_instance:null,version:x0,get config(){return i.config},set config(f){},use(f,...m){return l.has(f)||(f&&bt(f.install)?(l.add(f),f.install(h,...m)):bt(f)&&(l.add(f),f(h,...m))),h},mixin(f){return i.mixins.includes(f)||i.mixins.push(f),h},component(f,m){return m?(i.components[f]=m,h):i.components[f]},directive(f,m){return m?(i.directives[f]=m,h):i.directives[f]},mount(f,m,y){if(!d){const k=h._ceVNode||Ee(a,o);return k.appContext=i,y===!0?y="svg":y===!1&&(y=void 0),e(k,f,y),d=!0,h._container=f,f.__vue_app__=h,Gu(k.component)}},onUnmount(f){c.push(f)},unmount(){d&&(Ia(c,h._instance,16),e(null,h._container),delete h._container.__vue_app__)},provide(f,m){return i.provides[f]=m,h},runWithContext(f){const m=al;al=h;try{return f()}finally{al=m}}};return h}}let al=null;const Jk=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${aa(t)}Modifiers`]||e[`${mi(t)}Modifiers`];function Xk(e,t,...n){if(e.isUnmounted)return;const a=e.vnode.props||Qt;let o=n;const i=t.startsWith("update:"),l=i&&Jk(a,t.slice(7));l&&(l.trim&&(o=n.map(f=>hn(f)?f.trim():f)),l.number&&(o=n.map(Du)));let c,d=a[c=yd(t)]||a[c=yd(aa(t))];!d&&i&&(d=a[c=yd(mi(t))]),d&&Ia(d,e,6,o);const h=a[c+"Once"];if(h){if(!e.emitted)e.emitted={};else if(e.emitted[c])return;e.emitted[c]=!0,Ia(h,e,6,o)}}const Qk=new WeakMap;function Sg(e,t,n=!1){const a=n?Qk:t.emitsCache,o=a.get(e);if(o!==void 0)return o;const i=e.emits;let l={},c=!1;if(!bt(e)){const d=h=>{const f=Sg(h,t,!0);f&&(c=!0,Rn(l,f))};!n&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}return!i&&!c?(Yt(e)&&a.set(e,null),null):(dt(i)?i.forEach(d=>l[d]=null):Rn(l,i),Yt(e)&&a.set(e,l),l)}function zu(e,t){return!e||!Mu(t)?!1:(t=t.slice(2).replace(/Once$/,""),qt(e,t[0].toLowerCase()+t.slice(1))||qt(e,mi(t))||qt(e,t))}function rp(e){const{type:t,vnode:n,proxy:a,withProxy:o,propsOptions:[i],slots:l,attrs:c,emit:d,render:h,renderCache:f,props:m,data:y,setupState:k,ctx:S,inheritAttrs:x}=e,E=lu(e);let $,w;try{if(n.shapeFlag&4){const I=o||a,T=I;$=ja(h.call(T,I,f,m,k,y,S)),w=c}else{const I=t;$=ja(I.length>1?I(m,{attrs:c,slots:l,emit:d}):I(m,null)),w=t.props?c:e0(c)}}catch(I){Ur.length=0,Nu(I,e,1),$=Ee(eo)}let _=$;if(w&&x!==!1){const I=Object.keys(w),{shapeFlag:T}=_;I.length&&T&7&&(i&&I.some(sf)&&(w=t0(w,i)),_=hi(_,w,!1,!0))}return n.dirs&&(_=hi(_,null,!1,!0),_.dirs=_.dirs?_.dirs.concat(n.dirs):n.dirs),n.transition&&Qr(_,n.transition),$=_,lu(E),$}const e0=e=>{let t;for(const n in e)(n==="class"||n==="style"||Mu(n))&&((t||(t={}))[n]=e[n]);return t},t0=(e,t)=>{const n={};for(const a in e)(!sf(a)||!(a.slice(9)in t))&&(n[a]=e[a]);return n};function n0(e,t,n){const{props:a,children:o,component:i}=e,{props:l,children:c,patchFlag:d}=t,h=i.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&d>=0){if(d&1024)return!0;if(d&16)return a?cp(a,l,h):!!l;if(d&8){const f=t.dynamicProps;for(let m=0;m<f.length;m++){const y=f[m];if(l[y]!==a[y]&&!zu(h,y))return!0}}}else return(o||c)&&(!c||!c.$stable)?!0:a===l?!1:a?l?cp(a,l,h):!0:!!l;return!1}function cp(e,t,n){const a=Object.keys(t);if(a.length!==Object.keys(e).length)return!0;for(let o=0;o<a.length;o++){const i=a[o];if(t[i]!==e[i]&&!zu(n,i))return!0}return!1}function o0({vnode:e,parent:t},n){for(;t;){const a=t.subTree;if(a.suspense&&a.suspense.activeBranch===e&&(a.el=e.el),a===e)(e=t.vnode).el=n,t=t.parent;else break}}const Ig={},xg=()=>Object.create(Ig),$g=e=>Object.getPrototypeOf(e)===Ig;function a0(e,t,n,a=!1){const o={},i=xg();e.propsDefaults=Object.create(null),Tg(e,t,o,i);for(const l in e.propsOptions[0])l in o||(o[l]=void 0);n?e.props=a?o:Wm(o):e.type.props?e.props=o:e.props=i,e.attrs=i}function s0(e,t,n,a){const{props:o,attrs:i,vnode:{patchFlag:l}}=e,c=Bt(o),[d]=e.propsOptions;let h=!1;if((a||l>0)&&!(l&16)){if(l&8){const f=e.vnode.dynamicProps;for(let m=0;m<f.length;m++){let y=f[m];if(zu(e.emitsOptions,y))continue;const k=t[y];if(d)if(qt(i,y))k!==i[y]&&(i[y]=k,h=!0);else{const S=aa(y);o[S]=Th(d,c,S,k,e,!1)}else k!==i[y]&&(i[y]=k,h=!0)}}}else{Tg(e,t,o,i)&&(h=!0);let f;for(const m in c)(!t||!qt(t,m)&&((f=mi(m))===m||!qt(t,f)))&&(d?n&&(n[m]!==void 0||n[f]!==void 0)&&(o[m]=Th(d,c,m,void 0,e,!0)):delete o[m]);if(i!==c)for(const m in i)(!t||!qt(t,m))&&(delete i[m],h=!0)}h&&gs(e.attrs,"set","")}function Tg(e,t,n,a){const[o,i]=e.propsOptions;let l=!1,c;if(t)for(let d in t){if(Er(d))continue;const h=t[d];let f;o&&qt(o,f=aa(d))?!i||!i.includes(f)?n[f]=h:(c||(c={}))[f]=h:zu(e.emitsOptions,d)||(!(d in a)||h!==a[d])&&(a[d]=h,l=!0)}if(i){const d=Bt(n),h=c||Qt;for(let f=0;f<i.length;f++){const m=i[f];n[m]=Th(o,d,m,h[m],e,!qt(h,m))}}return l}function Th(e,t,n,a,o,i){const l=e[n];if(l!=null){const c=qt(l,"default");if(c&&a===void 0){const d=l.default;if(l.type!==Function&&!l.skipFactory&&bt(d)){const{propsDefaults:h}=o;if(n in h)a=h[n];else{const f=cc(o);a=h[n]=d.call(null,t),f()}}else a=d;o.ce&&o.ce._setProp(n,a)}l[0]&&(i&&!c?a=!1:l[1]&&(a===""||a===mi(n))&&(a=!0))}return a}const i0=new WeakMap;function Mg(e,t,n=!1){const a=n?i0:t.propsCache,o=a.get(e);if(o)return o;const i=e.props,l={},c=[];let d=!1;if(!bt(e)){const f=m=>{d=!0;const[y,k]=Mg(m,t,!0);Rn(l,y),k&&c.push(...k)};!n&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}if(!i&&!d)return Yt(e)&&a.set(e,jl),jl;if(dt(i))for(let f=0;f<i.length;f++){const m=aa(i[f]);up(m)&&(l[m]=Qt)}else if(i)for(const f in i){const m=aa(f);if(up(m)){const y=i[f],k=l[m]=dt(y)||bt(y)?{type:y}:Rn({},y),S=k.type;let x=!1,E=!0;if(dt(S))for(let $=0;$<S.length;++$){const w=S[$],_=bt(w)&&w.name;if(_==="Boolean"){x=!0;break}else _==="String"&&(E=!1)}else x=bt(S)&&S.name==="Boolean";k[0]=x,k[1]=E,(x||qt(k,"default"))&&c.push(m)}}const h=[l,c];return Yt(e)&&a.set(e,h),h}function up(e){return e[0]!=="$"&&!Er(e)}const kf=e=>e==="_"||e==="_ctx"||e==="$stable",bf=e=>dt(e)?e.map(ja):[ja(e)],l0=(e,t,n)=>{if(t._n)return t;const a=Ue((...o)=>bf(t(...o)),n);return a._c=!1,a},Ag=(e,t,n)=>{const a=e._ctx;for(const o in e){if(kf(o))continue;const i=e[o];if(bt(i))t[o]=l0(o,i,a);else if(i!=null){const l=bf(i);t[o]=()=>l}}},Eg=(e,t)=>{const n=bf(t);e.slots.default=()=>n},Pg=(e,t,n)=>{for(const a in t)(n||!kf(a))&&(e[a]=t[a])},r0=(e,t,n)=>{const a=e.slots=xg();if(e.vnode.shapeFlag&32){const o=t._;o?(Pg(a,t,n),n&&Im(a,"_",o,!0)):Ag(t,a)}else t&&Eg(e,t)},c0=(e,t,n)=>{const{vnode:a,slots:o}=e;let i=!0,l=Qt;if(a.shapeFlag&32){const c=t._;c?n&&c===1?i=!1:Pg(o,t,n):(i=!t.$stable,Ag(t,o)),l=t}else t&&(Eg(e,t),l={default:1});if(i)for(const c in o)!kf(c)&&l[c]==null&&delete o[c]},mo=p0;function u0(e){return d0(e)}function d0(e,t){const n=Ru();n.__VUE__=!0;const{insert:a,remove:o,patchProp:i,createElement:l,createText:c,createComment:d,setText:h,setElementText:f,parentNode:m,nextSibling:y,setScopeId:k=_a,insertStaticContent:S}=e,x=(q,X,ee,Ce=null,Ne=null,Be=null,Ae=void 0,ne=null,ye=!!X.dynamicChildren)=>{if(q===X)return;q&&!Ji(q,X)&&(Ce=V(q),Te(q,Ne,Be,!0),q=null),X.patchFlag===-2&&(ye=!1,X.dynamicChildren=null);const{type:De,ref:Pe,shapeFlag:Ie}=X;switch(De){case Hu:E(q,X,ee,Ce);break;case eo:$(q,X,ee,Ce);break;case Fr:q==null&&w(X,ee,Ce,Ae);break;case xe:j(q,X,ee,Ce,Ne,Be,Ae,ne,ye);break;default:Ie&1?T(q,X,ee,Ce,Ne,Be,Ae,ne,ye):Ie&6?K(q,X,ee,Ce,Ne,Be,Ae,ne,ye):(Ie&64||Ie&128)&&De.process(q,X,ee,Ce,Ne,Be,Ae,ne,ye,ie)}Pe!=null&&Ne?Br(Pe,q&&q.ref,Be,X||q,!X):Pe==null&&q&&q.ref!=null&&Br(q.ref,null,Be,q,!0)},E=(q,X,ee,Ce)=>{if(q==null)a(X.el=c(X.children),ee,Ce);else{const Ne=X.el=q.el;X.children!==q.children&&h(Ne,X.children)}},$=(q,X,ee,Ce)=>{q==null?a(X.el=d(X.children||""),ee,Ce):X.el=q.el},w=(q,X,ee,Ce)=>{[q.el,q.anchor]=S(q.children,X,ee,Ce,q.el,q.anchor)},_=({el:q,anchor:X},ee,Ce)=>{let Ne;for(;q&&q!==X;)Ne=y(q),a(q,ee,Ce),q=Ne;a(X,ee,Ce)},I=({el:q,anchor:X})=>{let ee;for(;q&&q!==X;)ee=y(q),o(q),q=ee;o(X)},T=(q,X,ee,Ce,Ne,Be,Ae,ne,ye)=>{if(X.type==="svg"?Ae="svg":X.type==="math"&&(Ae="mathml"),q==null)B(X,ee,Ce,Ne,Be,Ae,ne,ye);else{const De=q.el&&q.el._isVueCE?q.el:null;try{De&&De._beginPatch(),A(q,X,Ne,Be,Ae,ne,ye)}finally{De&&De._endPatch()}}},B=(q,X,ee,Ce,Ne,Be,Ae,ne)=>{let ye,De;const{props:Pe,shapeFlag:Ie,transition:me,dirs:Ke}=q;if(ye=q.el=l(q.type,Be,Pe&&Pe.is,Pe),Ie&8?f(ye,q.children):Ie&16&&R(q.children,ye,null,Ce,Ne,Sd(q,Be),Ae,ne),Ke&&zi(q,null,Ce,"created"),M(ye,q,q.scopeId,Ae,Ce),Pe){for(const de in Pe)de!=="value"&&!Er(de)&&i(ye,de,null,Pe[de],Be,Ce);"value"in Pe&&i(ye,"value",null,Pe.value,Be),(De=Pe.onVnodeBeforeMount)&&za(De,Ce,q)}Ke&&zi(q,null,Ce,"beforeMount");const Ve=h0(Ne,me);Ve&&me.beforeEnter(ye),a(ye,X,ee),((De=Pe&&Pe.onVnodeMounted)||Ve||Ke)&&mo(()=>{De&&za(De,Ce,q),Ve&&me.enter(ye),Ke&&zi(q,null,Ce,"mounted")},Ne)},M=(q,X,ee,Ce,Ne)=>{if(ee&&k(q,ee),Ce)for(let Be=0;Be<Ce.length;Be++)k(q,Ce[Be]);if(Ne){let Be=Ne.subTree;if(X===Be||Og(Be.type)&&(Be.ssContent===X||Be.ssFallback===X)){const Ae=Ne.vnode;M(q,Ae,Ae.scopeId,Ae.slotScopeIds,Ne.parent)}}},R=(q,X,ee,Ce,Ne,Be,Ae,ne,ye=0)=>{for(let De=ye;De<q.length;De++){const Pe=q[De]=ne?ti(q[De]):ja(q[De]);x(null,Pe,X,ee,Ce,Ne,Be,Ae,ne)}},A=(q,X,ee,Ce,Ne,Be,Ae)=>{const ne=X.el=q.el;let{patchFlag:ye,dynamicChildren:De,dirs:Pe}=X;ye|=q.patchFlag&16;const Ie=q.props||Qt,me=X.props||Qt;let Ke;if(ee&&Hi(ee,!1),(Ke=me.onVnodeBeforeUpdate)&&za(Ke,ee,X,q),Pe&&zi(X,q,ee,"beforeUpdate"),ee&&Hi(ee,!0),(Ie.innerHTML&&me.innerHTML==null||Ie.textContent&&me.textContent==null)&&f(ne,""),De?G(q.dynamicChildren,De,ne,ee,Ce,Sd(X,Ne),Be):Ae||U(q,X,ne,null,ee,Ce,Sd(X,Ne),Be,!1),ye>0){if(ye&16)F(ne,Ie,me,ee,Ne);else if(ye&2&&Ie.class!==me.class&&i(ne,"class",null,me.class,Ne),ye&4&&i(ne,"style",Ie.style,me.style,Ne),ye&8){const Ve=X.dynamicProps;for(let de=0;de<Ve.length;de++){const ke=Ve[de],te=Ie[ke],ge=me[ke];(ge!==te||ke==="value")&&i(ne,ke,te,ge,Ne,ee)}}ye&1&&q.children!==X.children&&f(ne,X.children)}else!Ae&&De==null&&F(ne,Ie,me,ee,Ne);((Ke=me.onVnodeUpdated)||Pe)&&mo(()=>{Ke&&za(Ke,ee,X,q),Pe&&zi(X,q,ee,"updated")},Ce)},G=(q,X,ee,Ce,Ne,Be,Ae)=>{for(let ne=0;ne<X.length;ne++){const ye=q[ne],De=X[ne],Pe=ye.el&&(ye.type===xe||!Ji(ye,De)||ye.shapeFlag&198)?m(ye.el):ee;x(ye,De,Pe,null,Ce,Ne,Be,Ae,!0)}},F=(q,X,ee,Ce,Ne)=>{if(X!==ee){if(X!==Qt)for(const Be in X)!Er(Be)&&!(Be in ee)&&i(q,Be,X[Be],null,Ne,Ce);for(const Be in ee){if(Er(Be))continue;const Ae=ee[Be],ne=X[Be];Ae!==ne&&Be!=="value"&&i(q,Be,ne,Ae,Ne,Ce)}"value"in ee&&i(q,"value",X.value,ee.value,Ne)}},j=(q,X,ee,Ce,Ne,Be,Ae,ne,ye)=>{const De=X.el=q?q.el:c(""),Pe=X.anchor=q?q.anchor:c("");let{patchFlag:Ie,dynamicChildren:me,slotScopeIds:Ke}=X;Ke&&(ne=ne?ne.concat(Ke):Ke),q==null?(a(De,ee,Ce),a(Pe,ee,Ce),R(X.children||[],ee,Pe,Ne,Be,Ae,ne,ye)):Ie>0&&Ie&64&&me&&q.dynamicChildren&&q.dynamicChildren.length===me.length?(G(q.dynamicChildren,me,ee,Ne,Be,Ae,ne),(X.key!=null||Ne&&X===Ne.subTree)&&_f(q,X,!0)):U(q,X,ee,Pe,Ne,Be,Ae,ne,ye)},K=(q,X,ee,Ce,Ne,Be,Ae,ne,ye)=>{X.slotScopeIds=ne,q==null?X.shapeFlag&512?Ne.ctx.activate(X,ee,Ce,Ae,ye):J(X,ee,Ce,Ne,Be,Ae,ye):ue(q,X,ye)},J=(q,X,ee,Ce,Ne,Be,Ae)=>{const ne=q.component=b0(q,Ce,Ne);if(Fu(q)&&(ne.ctx.renderer=ie),_0(ne,!1,Ae),ne.asyncDep){if(Ne&&Ne.registerDep(ne,Z,Ae),!q.el){const ye=ne.subTree=Ee(eo);$(null,ye,X,ee),q.placeholder=ye.el}}else Z(ne,q,X,ee,Ne,Be,Ae)},ue=(q,X,ee)=>{const Ce=X.component=q.component;if(n0(q,X,ee))if(Ce.asyncDep&&!Ce.asyncResolved){se(Ce,X,ee);return}else Ce.next=X,Ce.update();else X.el=q.el,Ce.vnode=X},Z=(q,X,ee,Ce,Ne,Be,Ae)=>{const ne=()=>{if(q.isMounted){let{next:Ie,bu:me,u:Ke,parent:Ve,vnode:de}=q;{const ut=Dg(q);if(ut){Ie&&(Ie.el=de.el,se(q,Ie,Ae)),ut.asyncDep.then(()=>{q.isUnmounted||ne()});return}}let ke=Ie,te;Hi(q,!1),Ie?(Ie.el=de.el,se(q,Ie,Ae)):Ie=de,me&&Vc(me),(te=Ie.props&&Ie.props.onVnodeBeforeUpdate)&&za(te,Ve,Ie,de),Hi(q,!0);const ge=rp(q),Fe=q.subTree;q.subTree=ge,x(Fe,ge,m(Fe.el),V(Fe),q,Ne,Be),Ie.el=ge.el,ke===null&&o0(q,ge.el),Ke&&mo(Ke,Ne),(te=Ie.props&&Ie.props.onVnodeUpdated)&&mo(()=>za(te,Ve,Ie,de),Ne)}else{let Ie;const{el:me,props:Ke}=X,{bm:Ve,m:de,parent:ke,root:te,type:ge}=q,Fe=Kl(X);Hi(q,!1),Ve&&Vc(Ve),!Fe&&(Ie=Ke&&Ke.onVnodeBeforeMount)&&za(Ie,ke,X),Hi(q,!0);{te.ce&&te.ce._def.shadowRoot!==!1&&te.ce._injectChildStyle(ge);const ut=q.subTree=rp(q);x(null,ut,ee,Ce,q,Ne,Be),X.el=ut.el}if(de&&mo(de,Ne),!Fe&&(Ie=Ke&&Ke.onVnodeMounted)){const ut=X;mo(()=>za(Ie,ke,ut),Ne)}(X.shapeFlag&256||ke&&Kl(ke.vnode)&&ke.vnode.shapeFlag&256)&&q.a&&mo(q.a,Ne),q.isMounted=!0,X=ee=Ce=null}};q.scope.on();const ye=q.effect=new Pm(ne);q.scope.off();const De=q.update=ye.run.bind(ye),Pe=q.job=ye.runIfDirty.bind(ye);Pe.i=q,Pe.id=q.uid,ye.scheduler=()=>mf(Pe),Hi(q,!0),De()},se=(q,X,ee)=>{X.component=q;const Ce=q.vnode.props;q.vnode=X,q.next=null,s0(q,X.props,Ce,ee),c0(q,X.children,ee),Is(),Jf(q),xs()},U=(q,X,ee,Ce,Ne,Be,Ae,ne,ye=!1)=>{const De=q&&q.children,Pe=q?q.shapeFlag:0,Ie=X.children,{patchFlag:me,shapeFlag:Ke}=X;if(me>0){if(me&128){oe(De,Ie,ee,Ce,Ne,Be,Ae,ne,ye);return}else if(me&256){Q(De,Ie,ee,Ce,Ne,Be,Ae,ne,ye);return}}Ke&8?(Pe&16&&be(De,Ne,Be),Ie!==De&&f(ee,Ie)):Pe&16?Ke&16?oe(De,Ie,ee,Ce,Ne,Be,Ae,ne,ye):be(De,Ne,Be,!0):(Pe&8&&f(ee,""),Ke&16&&R(Ie,ee,Ce,Ne,Be,Ae,ne,ye))},Q=(q,X,ee,Ce,Ne,Be,Ae,ne,ye)=>{q=q||jl,X=X||jl;const De=q.length,Pe=X.length,Ie=Math.min(De,Pe);let me;for(me=0;me<Ie;me++){const Ke=X[me]=ye?ti(X[me]):ja(X[me]);x(q[me],Ke,ee,null,Ne,Be,Ae,ne,ye)}De>Pe?be(q,Ne,Be,!0,!1,Ie):R(X,ee,Ce,Ne,Be,Ae,ne,ye,Ie)},oe=(q,X,ee,Ce,Ne,Be,Ae,ne,ye)=>{let De=0;const Pe=X.length;let Ie=q.length-1,me=Pe-1;for(;De<=Ie&&De<=me;){const Ke=q[De],Ve=X[De]=ye?ti(X[De]):ja(X[De]);if(Ji(Ke,Ve))x(Ke,Ve,ee,null,Ne,Be,Ae,ne,ye);else break;De++}for(;De<=Ie&&De<=me;){const Ke=q[Ie],Ve=X[me]=ye?ti(X[me]):ja(X[me]);if(Ji(Ke,Ve))x(Ke,Ve,ee,null,Ne,Be,Ae,ne,ye);else break;Ie--,me--}if(De>Ie){if(De<=me){const Ke=me+1,Ve=Ke<Pe?X[Ke].el:Ce;for(;De<=me;)x(null,X[De]=ye?ti(X[De]):ja(X[De]),ee,Ve,Ne,Be,Ae,ne,ye),De++}}else if(De>me)for(;De<=Ie;)Te(q[De],Ne,Be,!0),De++;else{const Ke=De,Ve=De,de=new Map;for(De=Ve;De<=me;De++){const Ct=X[De]=ye?ti(X[De]):ja(X[De]);Ct.key!=null&&de.set(Ct.key,De)}let ke,te=0;const ge=me-Ve+1;let Fe=!1,ut=0;const gt=new Array(ge);for(De=0;De<ge;De++)gt[De]=0;for(De=Ke;De<=Ie;De++){const Ct=q[De];if(te>=ge){Te(Ct,Ne,Be,!0);continue}let Pt;if(Ct.key!=null)Pt=de.get(Ct.key);else for(ke=Ve;ke<=me;ke++)if(gt[ke-Ve]===0&&Ji(Ct,X[ke])){Pt=ke;break}Pt===void 0?Te(Ct,Ne,Be,!0):(gt[Pt-Ve]=De+1,Pt>=ut?ut=Pt:Fe=!0,x(Ct,X[Pt],ee,null,Ne,Be,Ae,ne,ye),te++)}const xt=Fe?f0(gt):jl;for(ke=xt.length-1,De=ge-1;De>=0;De--){const Ct=Ve+De,Pt=X[Ct],Wt=X[Ct+1],_o=Ct+1<Pe?Wt.el||Rg(Wt):Ce;gt[De]===0?x(null,Pt,ee,_o,Ne,Be,Ae,ne,ye):Fe&&(ke<0||De!==xt[ke]?he(Pt,ee,_o,2):ke--)}}},he=(q,X,ee,Ce,Ne=null)=>{const{el:Be,type:Ae,transition:ne,children:ye,shapeFlag:De}=q;if(De&6){he(q.component.subTree,X,ee,Ce);return}if(De&128){q.suspense.move(X,ee,Ce);return}if(De&64){Ae.move(q,X,ee,ie);return}if(Ae===xe){a(Be,X,ee);for(let Ie=0;Ie<ye.length;Ie++)he(ye[Ie],X,ee,Ce);a(q.anchor,X,ee);return}if(Ae===Fr){_(q,X,ee);return}if(Ce!==2&&De&1&&ne)if(Ce===0)ne.beforeEnter(Be),a(Be,X,ee),mo(()=>ne.enter(Be),Ne);else{const{leave:Ie,delayLeave:me,afterLeave:Ke}=ne,Ve=()=>{q.ctx.isUnmounted?o(Be):a(Be,X,ee)},de=()=>{Be._isLeaving&&Be[ms](!0),Ie(Be,()=>{Ve(),Ke&&Ke()})};me?me(Be,Ve,de):de()}else a(Be,X,ee)},Te=(q,X,ee,Ce=!1,Ne=!1)=>{const{type:Be,props:Ae,ref:ne,children:ye,dynamicChildren:De,shapeFlag:Pe,patchFlag:Ie,dirs:me,cacheIndex:Ke}=q;if(Ie===-2&&(Ne=!1),ne!=null&&(Is(),Br(ne,null,ee,q,!0),xs()),Ke!=null&&(X.renderCache[Ke]=void 0),Pe&256){X.ctx.deactivate(q);return}const Ve=Pe&1&&me,de=!Kl(q);let ke;if(de&&(ke=Ae&&Ae.onVnodeBeforeUnmount)&&za(ke,X,q),Pe&6)We(q.component,ee,Ce);else{if(Pe&128){q.suspense.unmount(ee,Ce);return}Ve&&zi(q,null,X,"beforeUnmount"),Pe&64?q.type.remove(q,X,ee,ie,Ce):De&&!De.hasOnce&&(Be!==xe||Ie>0&&Ie&64)?be(De,X,ee,!1,!0):(Be===xe&&Ie&384||!Ne&&Pe&16)&&be(ye,X,ee),Ce&&je(q)}(de&&(ke=Ae&&Ae.onVnodeUnmounted)||Ve)&&mo(()=>{ke&&za(ke,X,q),Ve&&zi(q,null,X,"unmounted")},ee)},je=q=>{const{type:X,el:ee,anchor:Ce,transition:Ne}=q;if(X===xe){He(ee,Ce);return}if(X===Fr){I(q);return}const Be=()=>{o(ee),Ne&&!Ne.persisted&&Ne.afterLeave&&Ne.afterLeave()};if(q.shapeFlag&1&&Ne&&!Ne.persisted){const{leave:Ae,delayLeave:ne}=Ne,ye=()=>Ae(ee,Be);ne?ne(q.el,Be,ye):ye()}else Be()},He=(q,X)=>{let ee;for(;q!==X;)ee=y(q),o(q),q=ee;o(X)},We=(q,X,ee)=>{const{bum:Ce,scope:Ne,job:Be,subTree:Ae,um:ne,m:ye,a:De}=q;dp(ye),dp(De),Ce&&Vc(Ce),Ne.stop(),Be&&(Be.flags|=8,Te(Ae,q,X,ee)),ne&&mo(ne,X),mo(()=>{q.isUnmounted=!0},X)},be=(q,X,ee,Ce=!1,Ne=!1,Be=0)=>{for(let Ae=Be;Ae<q.length;Ae++)Te(q[Ae],X,ee,Ce,Ne)},V=q=>{if(q.shapeFlag&6)return V(q.component.subTree);if(q.shapeFlag&128)return q.suspense.next();const X=y(q.anchor||q.el),ee=X&&X[ag];return ee?y(ee):X};let Y=!1;const re=(q,X,ee)=>{let Ce;q==null?X._vnode&&(Te(X._vnode,null,null,!0),Ce=X._vnode.component):x(X._vnode||null,q,X,null,null,null,ee),X._vnode=q,Y||(Y=!0,Jf(Ce),Qm(),Y=!1)},ie={p:x,um:Te,m:he,r:je,mt:J,mc:R,pc:U,pbc:G,n:V,o:e};return{render:re,hydrate:void 0,createApp:Yk(re)}}function Sd({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function Hi({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function h0(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function _f(e,t,n=!1){const a=e.children,o=t.children;if(dt(a)&&dt(o))for(let i=0;i<a.length;i++){const l=a[i];let c=o[i];c.shapeFlag&1&&!c.dynamicChildren&&((c.patchFlag<=0||c.patchFlag===32)&&(c=o[i]=ti(o[i]),c.el=l.el),!n&&c.patchFlag!==-2&&_f(l,c)),c.type===Hu&&(c.patchFlag!==-1?c.el=l.el:c.__elIndex=i+(e.type===xe?1:0)),c.type===eo&&!c.el&&(c.el=l.el)}}function f0(e){const t=e.slice(),n=[0];let a,o,i,l,c;const d=e.length;for(a=0;a<d;a++){const h=e[a];if(h!==0){if(o=n[n.length-1],e[o]<h){t[a]=o,n.push(a);continue}for(i=0,l=n.length-1;i<l;)c=i+l>>1,e[n[c]]<h?i=c+1:l=c;h<e[n[i]]&&(i>0&&(t[a]=n[i-1]),n[i]=a)}}for(i=n.length,l=n[i-1];i-- >0;)n[i]=l,l=t[l];return n}function Dg(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Dg(t)}function dp(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function Rg(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?Rg(t.subTree):null}const Og=e=>e.__isSuspense;function p0(e,t){t&&t.pendingBranch?dt(e)?t.effects.push(...e):t.effects.push(e):Xm(e)}const xe=Symbol.for("v-fgt"),Hu=Symbol.for("v-txt"),eo=Symbol.for("v-cmt"),Fr=Symbol.for("v-stc"),Ur=[];let Ho=null;function p(e=!1){Ur.push(Ho=e?null:[])}function v0(){Ur.pop(),Ho=Ur[Ur.length-1]||null}let ec=1;function uu(e,t=!1){ec+=e,e<0&&Ho&&t&&(Ho.hasOnce=!0)}function Bg(e){return e.dynamicChildren=ec>0?Ho||jl:null,v0(),ec>0&&Ho&&Ho.push(e),e}function g(e,t,n,a,o,i){return Bg(r(e,t,n,a,o,i,!0))}function ze(e,t,n,a,o){return Bg(Ee(e,t,n,a,o,!0))}function tc(e){return e?e.__v_isVNode===!0:!1}function Ji(e,t){return e.type===t.type&&e.key===t.key}const Ng=({key:e})=>e??null,qc=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?hn(e)||un(e)||bt(e)?{i:Gn,r:e,k:t,f:!!n}:e:null);function r(e,t=null,n=null,a=0,o=null,i=e===xe?0:1,l=!1,c=!1){const d={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Ng(t),ref:t&&qc(t),scopeId:tg,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:a,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:Gn};return c?(wf(d,n),i&128&&e.normalize(d)):n&&(d.shapeFlag|=hn(n)?8:16),ec>0&&!l&&Ho&&(d.patchFlag>0||i&6)&&d.patchFlag!==32&&Ho.push(d),d}const Ee=m0;function m0(e,t=null,n=null,a=0,o=null,i=!1){if((!e||e===kg)&&(e=eo),tc(e)){const c=hi(e,t,!0);return n&&wf(c,n),ec>0&&!i&&Ho&&(c.shapeFlag&6?Ho[Ho.indexOf(e)]=c:Ho.push(c)),c.patchFlag=-2,c}if(I0(e)&&(e=e.__vccOpts),t){t=g0(t);let{class:c,style:d}=t;c&&!hn(c)&&(t.class=le(c)),Yt(d)&&(Bu(d)&&!dt(d)&&(d=Rn({},d)),t.style=nt(d))}const l=hn(e)?1:Og(e)?128:sg(e)?64:Yt(e)?4:bt(e)?2:0;return r(e,t,n,a,o,l,i,!0)}function g0(e){return e?Bu(e)||$g(e)?Rn({},e):e:null}function hi(e,t,n=!1,a=!1){const{props:o,ref:i,patchFlag:l,children:c,transition:d}=e,h=t?Fg(o||{},t):o,f={__v_isVNode:!0,__v_skip:!0,type:e.type,props:h,key:h&&Ng(h),ref:t&&t.ref?n&&i?dt(i)?i.concat(qc(t)):[i,qc(t)]:qc(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:c,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==xe?l===-1?16:l|16:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:d,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&hi(e.ssContent),ssFallback:e.ssFallback&&hi(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return d&&a&&Qr(f,d.clone(f)),f}function Je(e=" ",t=0){return Ee(Hu,null,e,t)}function fi(e,t){const n=Ee(Fr,null,e);return n.staticCount=t,n}function D(e="",t=!1){return t?(p(),ze(eo,null,e)):Ee(eo,null,e)}function ja(e){return e==null||typeof e=="boolean"?Ee(eo):dt(e)?Ee(xe,null,e.slice()):tc(e)?ti(e):Ee(Hu,null,String(e))}function ti(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:hi(e)}function wf(e,t){let n=0;const{shapeFlag:a}=e;if(t==null)t=null;else if(dt(t))n=16;else if(typeof t=="object")if(a&65){const o=t.default;o&&(o._c&&(o._d=!1),wf(e,o()),o._c&&(o._d=!0));return}else{n=32;const o=t._;!o&&!$g(t)?t._ctx=Gn:o===3&&Gn&&(Gn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else bt(t)?(t={default:t,_ctx:Gn},n=32):(t=String(t),a&64?(n=16,t=[Je(t)]):n=8);e.children=t,e.shapeFlag|=n}function Fg(...e){const t={};for(let n=0;n<e.length;n++){const a=e[n];for(const o in a)if(o==="class")t.class!==a.class&&(t.class=le([t.class,a.class]));else if(o==="style")t.style=nt([t.style,a.style]);else if(Mu(o)){const i=t[o],l=a[o];l&&i!==l&&!(dt(i)&&i.includes(l))&&(t[o]=i?[].concat(i,l):l)}else o!==""&&(t[o]=a[o])}return t}function za(e,t,n,a=null){Ia(e,t,7,[n,a])}const y0=Lg();let k0=0;function b0(e,t,n){const a=e.type,o=(t?t.appContext:e.appContext)||y0,i={uid:k0++,vnode:e,type:a,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Mm(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Mg(a,o),emitsOptions:Sg(a,o),emit:null,emitted:null,propsDefaults:Qt,inheritAttrs:a.inheritAttrs,ctx:Qt,data:Qt,props:Qt,attrs:Qt,slots:Qt,refs:Qt,setupState:Qt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=Xk.bind(null,i),e.ce&&e.ce(i),i}let to=null;const Vu=()=>to||Gn;let du,Mh;{const e=Ru(),t=(n,a)=>{let o;return(o=e[n])||(o=e[n]=[]),o.push(a),i=>{o.length>1?o.forEach(l=>l(i)):o[0](i)}};du=t("__VUE_INSTANCE_SETTERS__",n=>to=n),Mh=t("__VUE_SSR_SETTERS__",n=>nc=n)}const cc=e=>{const t=to;return du(e),e.scope.on(),()=>{e.scope.off(),du(t)}},hp=()=>{to&&to.scope.off(),du(null)};function Ug(e){return e.vnode.shapeFlag&4}let nc=!1;function _0(e,t=!1,n=!1){t&&Mh(t);const{props:a,children:o}=e.vnode,i=Ug(e);a0(e,a,i,t),r0(e,o,n||t);const l=i?w0(e,t):void 0;return t&&Mh(!1),l}function w0(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Vk);const{setup:a}=n;if(a){Is();const o=e.setupContext=a.length>1?L0(e):null,i=cc(e),l=rc(a,e,0,[e.props,o]),c=Cm(l);if(xs(),i(),(c||e.sp)&&!Kl(e)&&pg(e),c){if(l.then(hp,hp),t)return l.then(d=>{fp(e,d)}).catch(d=>{Nu(d,e,0)});e.asyncDep=l}else fp(e,l)}else zg(e)}function fp(e,t,n){bt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Yt(t)&&(e.setupState=Km(t)),zg(e)}function zg(e,t,n){const a=e.type;e.render||(e.render=a.render||_a);{const o=cc(e);Is();try{Gk(e)}finally{xs(),o()}}}const C0={get(e,t){return Qn(e,"get",""),e[t]}};function L0(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,C0),slots:e.slots,emit:e.emit,expose:t}}function Gu(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Km(vf(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Nr)return Nr[n](e)},has(t,n){return n in t||n in Nr}})):e.proxy}function S0(e,t=!0){return bt(e)?e.displayName||e.name:e.name||t&&e.__name}function I0(e){return bt(e)&&"__vccOpts"in e}const z=(e,t)=>bk(e,t,nc);function Cf(e,t,n){try{uu(-1);const a=arguments.length;return a===2?Yt(t)&&!dt(t)?tc(t)?Ee(e,null,[t]):Ee(e,t):Ee(e,null,t):(a>3?n=Array.prototype.slice.call(arguments,2):a===3&&tc(n)&&(n=[n]),Ee(e,t,n))}finally{uu(1)}}const x0="3.5.26";let Ah;const pp=typeof window<"u"&&window.trustedTypes;if(pp)try{Ah=pp.createPolicy("vue",{createHTML:e=>e})}catch{}const Hg=Ah?e=>Ah.createHTML(e):e=>e,$0="http://www.w3.org/2000/svg",T0="http://www.w3.org/1998/Math/MathML",vs=typeof document<"u"?document:null,vp=vs&&vs.createElement("template"),M0={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,a)=>{const o=t==="svg"?vs.createElementNS($0,e):t==="mathml"?vs.createElementNS(T0,e):n?vs.createElement(e,{is:n}):vs.createElement(e);return e==="select"&&a&&a.multiple!=null&&o.setAttribute("multiple",a.multiple),o},createText:e=>vs.createTextNode(e),createComment:e=>vs.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>vs.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,a,o,i){const l=n?n.previousSibling:t.lastChild;if(o&&(o===i||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),n),!(o===i||!(o=o.nextSibling)););else{vp.innerHTML=Hg(a==="svg"?`<svg>${e}</svg>`:a==="mathml"?`<math>${e}</math>`:e);const c=vp.content;if(a==="svg"||a==="mathml"){const d=c.firstChild;for(;d.firstChild;)c.appendChild(d.firstChild);c.removeChild(d)}t.insertBefore(c,n)}return[l?l.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},Ks="transition",br="animation",oc=Symbol("_vtc"),Vg={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},A0=Rn({},rg,Vg),E0=e=>(e.displayName="Transition",e.props=A0,e),Ca=E0((e,{slots:t})=>Cf(Ek,P0(e),t)),Vi=(e,t=[])=>{dt(e)?e.forEach(n=>n(...t)):e&&e(...t)},mp=e=>e?dt(e)?e.some(t=>t.length>1):e.length>1:!1;function P0(e){const t={};for(const j in e)j in Vg||(t[j]=e[j]);if(e.css===!1)return t;const{name:n="v",type:a,duration:o,enterFromClass:i=`${n}-enter-from`,enterActiveClass:l=`${n}-enter-active`,enterToClass:c=`${n}-enter-to`,appearFromClass:d=i,appearActiveClass:h=l,appearToClass:f=c,leaveFromClass:m=`${n}-leave-from`,leaveActiveClass:y=`${n}-leave-active`,leaveToClass:k=`${n}-leave-to`}=e,S=D0(o),x=S&&S[0],E=S&&S[1],{onBeforeEnter:$,onEnter:w,onEnterCancelled:_,onLeave:I,onLeaveCancelled:T,onBeforeAppear:B=$,onAppear:M=w,onAppearCancelled:R=_}=t,A=(j,K,J,ue)=>{j._enterCancelled=ue,Gi(j,K?f:c),Gi(j,K?h:l),J&&J()},G=(j,K)=>{j._isLeaving=!1,Gi(j,m),Gi(j,k),Gi(j,y),K&&K()},F=j=>(K,J)=>{const ue=j?M:w,Z=()=>A(K,j,J);Vi(ue,[K,Z]),gp(()=>{Gi(K,j?d:i),hs(K,j?f:c),mp(ue)||yp(K,a,x,Z)})};return Rn(t,{onBeforeEnter(j){Vi($,[j]),hs(j,i),hs(j,l)},onBeforeAppear(j){Vi(B,[j]),hs(j,d),hs(j,h)},onEnter:F(!1),onAppear:F(!0),onLeave(j,K){j._isLeaving=!0;const J=()=>G(j,K);hs(j,m),j._enterCancelled?(hs(j,y),_p(j)):(_p(j),hs(j,y)),gp(()=>{j._isLeaving&&(Gi(j,m),hs(j,k),mp(I)||yp(j,a,E,J))}),Vi(I,[j,J])},onEnterCancelled(j){A(j,!1,void 0,!0),Vi(_,[j])},onAppearCancelled(j){A(j,!0,void 0,!0),Vi(R,[j])},onLeaveCancelled(j){G(j),Vi(T,[j])}})}function D0(e){if(e==null)return null;if(Yt(e))return[Id(e.enter),Id(e.leave)];{const t=Id(e);return[t,t]}}function Id(e){return N1(e)}function hs(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e[oc]||(e[oc]=new Set)).add(t)}function Gi(e,t){t.split(/\s+/).forEach(a=>a&&e.classList.remove(a));const n=e[oc];n&&(n.delete(t),n.size||(e[oc]=void 0))}function gp(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let R0=0;function yp(e,t,n,a){const o=e._endId=++R0,i=()=>{o===e._endId&&a()};if(n!=null)return setTimeout(i,n);const{type:l,timeout:c,propCount:d}=O0(e,t);if(!l)return a();const h=l+"end";let f=0;const m=()=>{e.removeEventListener(h,y),i()},y=k=>{k.target===e&&++f>=d&&m()};setTimeout(()=>{f<d&&m()},c+1),e.addEventListener(h,y)}function O0(e,t){const n=window.getComputedStyle(e),a=S=>(n[S]||"").split(", "),o=a(`${Ks}Delay`),i=a(`${Ks}Duration`),l=kp(o,i),c=a(`${br}Delay`),d=a(`${br}Duration`),h=kp(c,d);let f=null,m=0,y=0;t===Ks?l>0&&(f=Ks,m=l,y=i.length):t===br?h>0&&(f=br,m=h,y=d.length):(m=Math.max(l,h),f=m>0?l>h?Ks:br:null,y=f?f===Ks?i.length:d.length:0);const k=f===Ks&&/\b(?:transform|all)(?:,|$)/.test(a(`${Ks}Property`).toString());return{type:f,timeout:m,propCount:y,hasTransform:k}}function kp(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,a)=>bp(n)+bp(e[a])))}function bp(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function _p(e){return(e?e.ownerDocument:document).body.offsetHeight}function B0(e,t,n){const a=e[oc];a&&(t=(t?[t,...a]:[...a]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const hu=Symbol("_vod"),Gg=Symbol("_vsh"),sa={name:"show",beforeMount(e,{value:t},{transition:n}){e[hu]=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):_r(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:a}){!t!=!n&&(a?t?(a.beforeEnter(e),_r(e,!0),a.enter(e)):a.leave(e,()=>{_r(e,!1)}):_r(e,t))},beforeUnmount(e,{value:t}){_r(e,t)}};function _r(e,t){e.style.display=t?e[hu]:"none",e[Gg]=!t}const qg=Symbol("");function N0(e){const t=Vu();if(!t)return;const n=t.ut=(o=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(i=>fu(i,o))},a=()=>{const o=e(t.proxy);t.ce?fu(t.ce,o):Eh(t.subTree,o),n(o)};mg(()=>{Xm(a)}),rn(()=>{Ye(a,_a,{flush:"post"});const o=new MutationObserver(a);o.observe(t.subTree.el.parentNode,{childList:!0}),An(()=>o.disconnect())})}function Eh(e,t){if(e.shapeFlag&128){const n=e.suspense;e=n.activeBranch,n.pendingBranch&&!n.isHydrating&&n.effects.push(()=>{Eh(n.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)fu(e.el,t);else if(e.type===xe)e.children.forEach(n=>Eh(n,t));else if(e.type===Fr){let{el:n,anchor:a}=e;for(;n&&(fu(n,t),n!==a);)n=n.nextSibling}}function fu(e,t){if(e.nodeType===1){const n=e.style;let a="";for(const o in t){const i=j1(t[o]);n.setProperty(`--${o}`,i),a+=`--${o}: ${i};`}n[qg]=a}}const F0=/(?:^|;)\s*display\s*:/;function U0(e,t,n){const a=e.style,o=hn(n);let i=!1;if(n&&!o){if(t)if(hn(t))for(const l of t.split(";")){const c=l.slice(0,l.indexOf(":")).trim();n[c]==null&&jc(a,c,"")}else for(const l in t)n[l]==null&&jc(a,l,"");for(const l in n)l==="display"&&(i=!0),jc(a,l,n[l])}else if(o){if(t!==n){const l=a[qg];l&&(n+=";"+l),a.cssText=n,i=F0.test(n)}}else t&&e.removeAttribute("style");hu in e&&(e[hu]=i?a.display:"",e[Gg]&&(a.display="none"))}const wp=/\s*!important$/;function jc(e,t,n){if(dt(n))n.forEach(a=>jc(e,t,a));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const a=z0(e,t);wp.test(n)?e.setProperty(mi(a),n.replace(wp,""),"important"):e[a]=n}}const Cp=["Webkit","Moz","ms"],xd={};function z0(e,t){const n=xd[t];if(n)return n;let a=aa(t);if(a!=="filter"&&a in e)return xd[t]=a;a=Pu(a);for(let o=0;o<Cp.length;o++){const i=Cp[o]+a;if(i in e)return xd[t]=i}return t}const Lp="http://www.w3.org/1999/xlink";function Sp(e,t,n,a,o,i=G1(t)){a&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(Lp,t.slice(6,t.length)):e.setAttributeNS(Lp,t,n):n==null||i&&!xm(n)?e.removeAttribute(t):e.setAttribute(t,i?"":La(n)?String(n):n)}function Ip(e,t,n,a,o){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?Hg(n):n);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const c=i==="OPTION"?e.getAttribute("value")||"":e.value,d=n==null?e.type==="checkbox"?"on":"":String(n);(c!==d||!("_value"in e))&&(e.value=d),n==null&&e.removeAttribute(t),e._value=n;return}let l=!1;if(n===""||n==null){const c=typeof e[t];c==="boolean"?n=xm(n):n==null&&c==="string"?(n="",l=!0):c==="number"&&(n=0,l=!0)}try{e[t]=n}catch{}l&&e.removeAttribute(o||t)}function ks(e,t,n,a){e.addEventListener(t,n,a)}function H0(e,t,n,a){e.removeEventListener(t,n,a)}const xp=Symbol("_vei");function V0(e,t,n,a,o=null){const i=e[xp]||(e[xp]={}),l=i[t];if(a&&l)l.value=a;else{const[c,d]=G0(t);if(a){const h=i[t]=W0(a,o);ks(e,c,h,d)}else l&&(H0(e,c,l,d),i[t]=void 0)}}const $p=/(?:Once|Passive|Capture)$/;function G0(e){let t;if($p.test(e)){t={};let a;for(;a=e.match($p);)e=e.slice(0,e.length-a[0].length),t[a[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):mi(e.slice(2)),t]}let $d=0;const q0=Promise.resolve(),j0=()=>$d||(q0.then(()=>$d=0),$d=Date.now());function W0(e,t){const n=a=>{if(!a._vts)a._vts=Date.now();else if(a._vts<=n.attached)return;Ia(Z0(a,n.value),t,5,[a])};return n.value=e,n.attached=j0(),n}function Z0(e,t){if(dt(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(a=>o=>!o._stopped&&a&&a(o))}else return t}const Tp=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,K0=(e,t,n,a,o,i)=>{const l=o==="svg";t==="class"?B0(e,a,l):t==="style"?U0(e,n,a):Mu(t)?sf(t)||V0(e,t,n,a,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Y0(e,t,a,l))?(Ip(e,t,a),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Sp(e,t,a,l,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!hn(a))?Ip(e,aa(t),a,i,t):(t==="true-value"?e._trueValue=a:t==="false-value"&&(e._falseValue=a),Sp(e,t,a,l))};function Y0(e,t,n,a){if(a)return!!(t==="innerHTML"||t==="textContent"||t in e&&Tp(t)&&bt(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const o=e.tagName;if(o==="IMG"||o==="VIDEO"||o==="CANVAS"||o==="SOURCE")return!1}return Tp(t)&&hn(n)?!1:t in e}const pi=e=>{const t=e.props["onUpdate:modelValue"]||!1;return dt(t)?n=>Vc(t,n):t};function J0(e){e.target.composing=!0}function Mp(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const oa=Symbol("_assign");function Ap(e,t,n){return t&&(e=e.trim()),n&&(e=Du(e)),e}const st={created(e,{modifiers:{lazy:t,trim:n,number:a}},o){e[oa]=pi(o);const i=a||o.props&&o.props.type==="number";ks(e,t?"change":"input",l=>{l.target.composing||e[oa](Ap(e.value,n,i))}),(n||i)&&ks(e,"change",()=>{e.value=Ap(e.value,n,i)}),t||(ks(e,"compositionstart",J0),ks(e,"compositionend",Mp),ks(e,"change",Mp))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:a,trim:o,number:i}},l){if(e[oa]=pi(l),e.composing)return;const c=(i||e.type==="number")&&!/^0\d/.test(e.value)?Du(e.value):e.value,d=t??"";c!==d&&(document.activeElement===e&&e.type!=="range"&&(a&&t===n||o&&e.value.trim()===d)||(e.value=d))}},xa={deep:!0,created(e,t,n){e[oa]=pi(n),ks(e,"change",()=>{const a=e._modelValue,o=Ql(e),i=e.checked,l=e[oa];if(dt(a)){const c=rf(a,o),d=c!==-1;if(i&&!d)l(a.concat(o));else if(!i&&d){const h=[...a];h.splice(c,1),l(h)}}else if(ar(a)){const c=new Set(a);i?c.add(o):c.delete(o),l(c)}else l(jg(e,i))})},mounted:Ep,beforeUpdate(e,t,n){e[oa]=pi(n),Ep(e,t,n)}};function Ep(e,{value:t,oldValue:n},a){e._modelValue=t;let o;if(dt(t))o=rf(t,a.props.value)>-1;else if(ar(t))o=t.has(a.props.value);else{if(t===n)return;o=ll(t,jg(e,!0))}e.checked!==o&&(e.checked=o)}const Pp={created(e,{value:t},n){e.checked=ll(t,n.props.value),e[oa]=pi(n),ks(e,"change",()=>{e[oa](Ql(e))})},beforeUpdate(e,{value:t,oldValue:n},a){e[oa]=pi(a),t!==n&&(e.checked=ll(t,a.props.value))}},no={deep:!0,created(e,{value:t,modifiers:{number:n}},a){const o=ar(t);ks(e,"change",()=>{const i=Array.prototype.filter.call(e.options,l=>l.selected).map(l=>n?Du(Ql(l)):Ql(l));e[oa](e.multiple?o?new Set(i):i:i[0]),e._assigning=!0,dn(()=>{e._assigning=!1})}),e[oa]=pi(a)},mounted(e,{value:t}){Dp(e,t)},beforeUpdate(e,t,n){e[oa]=pi(n)},updated(e,{value:t}){e._assigning||Dp(e,t)}};function Dp(e,t){const n=e.multiple,a=dt(t);if(!(n&&!a&&!ar(t))){for(let o=0,i=e.options.length;o<i;o++){const l=e.options[o],c=Ql(l);if(n)if(a){const d=typeof c;d==="string"||d==="number"?l.selected=t.some(h=>String(h)===String(c)):l.selected=rf(t,c)>-1}else l.selected=t.has(c);else if(ll(Ql(l),t)){e.selectedIndex!==o&&(e.selectedIndex=o);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Ql(e){return"_value"in e?e._value:e.value}function jg(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const X0=["ctrl","shift","alt","meta"],Q0={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>X0.some(n=>e[`${n}Key`]&&!t.includes(n))},ct=(e,t)=>{const n=e._withMods||(e._withMods={}),a=t.join(".");return n[a]||(n[a]=((o,...i)=>{for(let l=0;l<t.length;l++){const c=Q0[t[l]];if(c&&c(o,t))return}return e(o,...i)}))},eb={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},ya=(e,t)=>{const n=e._withKeys||(e._withKeys={}),a=t.join(".");return n[a]||(n[a]=(o=>{if(!("key"in o))return;const i=mi(o.key);if(t.some(l=>l===i||eb[l]===i))return e(o)}))},tb=Rn({patchProp:K0},M0);let Rp;function nb(){return Rp||(Rp=u0(tb))}const ob=((...e)=>{const t=nb().createApp(...e),{mount:n}=t;return t.mount=a=>{const o=sb(a);if(!o)return;const i=t._component;!bt(i)&&!i.render&&!i.template&&(i.template=o.innerHTML),o.nodeType===1&&(o.textContent="");const l=n(o,!1,ab(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),l},t});function ab(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function sb(e){return hn(e)?document.querySelector(e):e}let Wg;const qu=e=>Wg=e,Zg=Symbol();function Ph(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var zr;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(zr||(zr={}));function ib(){const e=Am(!0),t=e.run(()=>P({}));let n=[],a=[];const o=vf({install(i){qu(o),o._a=i,i.provide(Zg,o),i.config.globalProperties.$pinia=o,a.forEach(l=>n.push(l)),a=[]},use(i){return this._a?n.push(i):a.push(i),this},_p:n,_a:null,_e:e,_s:new Map,state:t});return o}const Kg=()=>{};function Op(e,t,n,a=Kg){e.add(t);const o=()=>{e.delete(t)&&a()};return!n&&Em()&&W1(o),o}function Rl(e,...t){e.forEach(n=>{n(...t)})}const lb=e=>e(),Bp=Symbol(),Td=Symbol();function Dh(e,t){e instanceof Map&&t instanceof Map?t.forEach((n,a)=>e.set(a,n)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const n in t){if(!t.hasOwnProperty(n))continue;const a=t[n],o=e[n];Ph(o)&&Ph(a)&&e.hasOwnProperty(n)&&!un(a)&&!Ls(a)?e[n]=Dh(o,a):e[n]=a}return e}const rb=Symbol();function cb(e){return!Ph(e)||!Object.prototype.hasOwnProperty.call(e,rb)}const{assign:Xs}=Object;function ub(e){return!!(un(e)&&e.effect)}function db(e,t,n,a){const{state:o,actions:i,getters:l}=t,c=n.state.value[e];let d;function h(){c||(n.state.value[e]=o?o():{});const f=mk(n.state.value[e]);return Xs(f,i,Object.keys(l||{}).reduce((m,y)=>(m[y]=vf(z(()=>{qu(n);const k=n._s.get(e);return l[y].call(k,k)})),m),{}))}return d=Yg(e,h,t,n,a,!0),d}function Yg(e,t,n={},a,o,i){let l;const c=Xs({actions:{}},n),d={deep:!0};let h,f,m=new Set,y=new Set,k;const S=a.state.value[e];!i&&!S&&(a.state.value[e]={}),P({});let x;function E(R){let A;h=f=!1,typeof R=="function"?(R(a.state.value[e]),A={type:zr.patchFunction,storeId:e,events:k}):(Dh(a.state.value[e],R),A={type:zr.patchObject,payload:R,storeId:e,events:k});const G=x=Symbol();dn().then(()=>{x===G&&(h=!0)}),f=!0,Rl(m,A,a.state.value[e])}const $=i?function(){const{state:A}=n,G=A?A():{};this.$patch(F=>{Xs(F,G)})}:Kg;function w(){l.stop(),m.clear(),y.clear(),a._s.delete(e)}const _=(R,A="")=>{if(Bp in R)return R[Td]=A,R;const G=function(){qu(a);const F=Array.from(arguments),j=new Set,K=new Set;function J(se){j.add(se)}function ue(se){K.add(se)}Rl(y,{args:F,name:G[Td],store:T,after:J,onError:ue});let Z;try{Z=R.apply(this&&this.$id===e?this:T,F)}catch(se){throw Rl(K,se),se}return Z instanceof Promise?Z.then(se=>(Rl(j,se),se)).catch(se=>(Rl(K,se),Promise.reject(se))):(Rl(j,Z),Z)};return G[Bp]=!0,G[Td]=A,G},I={_p:a,$id:e,$onAction:Op.bind(null,y),$patch:E,$reset:$,$subscribe(R,A={}){const G=Op(m,R,A.detached,()=>F()),F=l.run(()=>Ye(()=>a.state.value[e],j=>{(A.flush==="sync"?f:h)&&R({storeId:e,type:zr.direct,events:k},j)},Xs({},d,A)));return G},$dispose:w},T=ul(I);a._s.set(e,T);const M=(a._a&&a._a.runWithContext||lb)(()=>a._e.run(()=>(l=Am()).run(()=>t({action:_}))));for(const R in M){const A=M[R];if(un(A)&&!ub(A)||Ls(A))i||(S&&cb(A)&&(un(A)?A.value=S[R]:Dh(A,S[R])),a.state.value[e][R]=A);else if(typeof A=="function"){const G=_(A,R);M[R]=G,c.actions[R]=A}}return Xs(T,M),Xs(Bt(T),M),Object.defineProperty(T,"$state",{get:()=>a.state.value[e],set:R=>{E(A=>{Xs(A,R)})}}),a._p.forEach(R=>{Xs(T,l.run(()=>R({store:T,app:a._a,pinia:a,options:c})))}),S&&i&&n.hydrate&&n.hydrate(T.$state,S),h=!0,f=!0,T}function Lf(e,t,n){let a;const o=typeof t=="function";a=o?n:t;function i(l,c){const d=Sk();return l=l||(d?$o(Zg,null):null),l&&qu(l),l=Wg,l._s.has(e)||(o?Yg(e,t,a,l):db(e,a,l)),l._s.get(e)}return i.$id=e,i}const Ul=typeof document<"u";function Jg(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function hb(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&Jg(e.default)}const Gt=Object.assign;function Md(e,t){const n={};for(const a in t){const o=t[a];n[a]=$a(o)?o.map(e):e(o)}return n}const Hr=()=>{},$a=Array.isArray;function Np(e,t){const n={};for(const a in e)n[a]=a in t?t[a]:e[a];return n}const Xg=/#/g,fb=/&/g,pb=/\//g,vb=/=/g,mb=/\?/g,Qg=/\+/g,gb=/%5B/g,yb=/%5D/g,ey=/%5E/g,kb=/%60/g,ty=/%7B/g,bb=/%7C/g,ny=/%7D/g,_b=/%20/g;function Sf(e){return e==null?"":encodeURI(""+e).replace(bb,"|").replace(gb,"[").replace(yb,"]")}function wb(e){return Sf(e).replace(ty,"{").replace(ny,"}").replace(ey,"^")}function Rh(e){return Sf(e).replace(Qg,"%2B").replace(_b,"+").replace(Xg,"%23").replace(fb,"%26").replace(kb,"`").replace(ty,"{").replace(ny,"}").replace(ey,"^")}function Cb(e){return Rh(e).replace(vb,"%3D")}function Lb(e){return Sf(e).replace(Xg,"%23").replace(mb,"%3F")}function Sb(e){return Lb(e).replace(pb,"%2F")}function ac(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const Ib=/\/$/,xb=e=>e.replace(Ib,"");function Ad(e,t,n="/"){let a,o={},i="",l="";const c=t.indexOf("#");let d=t.indexOf("?");return d=c>=0&&d>c?-1:d,d>=0&&(a=t.slice(0,d),i=t.slice(d,c>0?c:t.length),o=e(i.slice(1))),c>=0&&(a=a||t.slice(0,c),l=t.slice(c,t.length)),a=Ab(a??t,n),{fullPath:a+i+l,path:a,query:o,hash:ac(l)}}function $b(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function Fp(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Tb(e,t,n){const a=t.matched.length-1,o=n.matched.length-1;return a>-1&&a===o&&er(t.matched[a],n.matched[o])&&oy(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function er(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function oy(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e)if(!Mb(e[n],t[n]))return!1;return!0}function Mb(e,t){return $a(e)?Up(e,t):$a(t)?Up(t,e):e?.valueOf()===t?.valueOf()}function Up(e,t){return $a(t)?e.length===t.length&&e.every((n,a)=>n===t[a]):e.length===1&&e[0]===t}function Ab(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),a=e.split("/"),o=a[a.length-1];(o===".."||o===".")&&a.push("");let i=n.length-1,l,c;for(l=0;l<a.length;l++)if(c=a[l],c!==".")if(c==="..")i>1&&i--;else break;return n.slice(0,i).join("/")+"/"+a.slice(l).join("/")}const Ys={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let Oh=(function(e){return e.pop="pop",e.push="push",e})({}),Ed=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function Eb(e){if(!e)if(Ul){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),xb(e)}const Pb=/^[^#]+#/;function Db(e,t){return e.replace(Pb,"#")+t}function Rb(e,t){const n=document.documentElement.getBoundingClientRect(),a=e.getBoundingClientRect();return{behavior:t.behavior,left:a.left-n.left-(t.left||0),top:a.top-n.top-(t.top||0)}}const ju=()=>({left:window.scrollX,top:window.scrollY});function Ob(e){let t;if("el"in e){const n=e.el,a=typeof n=="string"&&n.startsWith("#"),o=typeof n=="string"?a?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!o)return;t=Rb(o,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function zp(e,t){return(history.state?history.state.position-t:-1)+e}const Bh=new Map;function Bb(e,t){Bh.set(e,t)}function Nb(e){const t=Bh.get(e);return Bh.delete(e),t}function Fb(e){return typeof e=="string"||e&&typeof e=="object"}function ay(e){return typeof e=="string"||typeof e=="symbol"}let yn=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const sy=Symbol("");yn.MATCHER_NOT_FOUND+"",yn.NAVIGATION_GUARD_REDIRECT+"",yn.NAVIGATION_ABORTED+"",yn.NAVIGATION_CANCELLED+"",yn.NAVIGATION_DUPLICATED+"";function tr(e,t){return Gt(new Error,{type:e,[sy]:!0},t)}function fs(e,t){return e instanceof Error&&sy in e&&(t==null||!!(e.type&t))}const Ub=["params","query","hash"];function zb(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const n of Ub)n in e&&(t[n]=e[n]);return JSON.stringify(t,null,2)}function Hb(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let a=0;a<n.length;++a){const o=n[a].replace(Qg," "),i=o.indexOf("="),l=ac(i<0?o:o.slice(0,i)),c=i<0?null:ac(o.slice(i+1));if(l in t){let d=t[l];$a(d)||(d=t[l]=[d]),d.push(c)}else t[l]=c}return t}function Hp(e){let t="";for(let n in e){const a=e[n];if(n=Cb(n),a==null){a!==void 0&&(t+=(t.length?"&":"")+n);continue}($a(a)?a.map(o=>o&&Rh(o)):[a&&Rh(a)]).forEach(o=>{o!==void 0&&(t+=(t.length?"&":"")+n,o!=null&&(t+="="+o))})}return t}function Vb(e){const t={};for(const n in e){const a=e[n];a!==void 0&&(t[n]=$a(a)?a.map(o=>o==null?null:""+o):a==null?a:""+a)}return t}const Gb=Symbol(""),Vp=Symbol(""),Wu=Symbol(""),If=Symbol(""),Nh=Symbol("");function wr(){let e=[];function t(a){return e.push(a),()=>{const o=e.indexOf(a);o>-1&&e.splice(o,1)}}function n(){e=[]}return{add:t,list:()=>e.slice(),reset:n}}function ni(e,t,n,a,o,i=l=>l()){const l=a&&(a.enterCallbacks[o]=a.enterCallbacks[o]||[]);return()=>new Promise((c,d)=>{const h=y=>{y===!1?d(tr(yn.NAVIGATION_ABORTED,{from:n,to:t})):y instanceof Error?d(y):Fb(y)?d(tr(yn.NAVIGATION_GUARD_REDIRECT,{from:t,to:y})):(l&&a.enterCallbacks[o]===l&&typeof y=="function"&&l.push(y),c())},f=i(()=>e.call(a&&a.instances[o],t,n,h));let m=Promise.resolve(f);e.length<3&&(m=m.then(h)),m.catch(y=>d(y))})}function Pd(e,t,n,a,o=i=>i()){const i=[];for(const l of e)for(const c in l.components){let d=l.components[c];if(!(t!=="beforeRouteEnter"&&!l.instances[c]))if(Jg(d)){const h=(d.__vccOpts||d)[t];h&&i.push(ni(h,n,a,l,c,o))}else{let h=d();i.push(()=>h.then(f=>{if(!f)throw new Error(`Couldn't resolve component "${c}" at "${l.path}"`);const m=hb(f)?f.default:f;l.mods[c]=f,l.components[c]=m;const y=(m.__vccOpts||m)[t];return y&&ni(y,n,a,l,c,o)()}))}}return i}function qb(e,t){const n=[],a=[],o=[],i=Math.max(t.matched.length,e.matched.length);for(let l=0;l<i;l++){const c=t.matched[l];c&&(e.matched.find(h=>er(h,c))?a.push(c):n.push(c));const d=e.matched[l];d&&(t.matched.find(h=>er(h,d))||o.push(d))}return[n,a,o]}let jb=()=>location.protocol+"//"+location.host;function iy(e,t){const{pathname:n,search:a,hash:o}=t,i=e.indexOf("#");if(i>-1){let l=o.includes(e.slice(i))?e.slice(i).length:1,c=o.slice(l);return c[0]!=="/"&&(c="/"+c),Fp(c,"")}return Fp(n,e)+a+o}function Wb(e,t,n,a){let o=[],i=[],l=null;const c=({state:y})=>{const k=iy(e,location),S=n.value,x=t.value;let E=0;if(y){if(n.value=k,t.value=y,l&&l===S){l=null;return}E=x?y.position-x.position:0}else a(k);o.forEach($=>{$(n.value,S,{delta:E,type:Oh.pop,direction:E?E>0?Ed.forward:Ed.back:Ed.unknown})})};function d(){l=n.value}function h(y){o.push(y);const k=()=>{const S=o.indexOf(y);S>-1&&o.splice(S,1)};return i.push(k),k}function f(){if(document.visibilityState==="hidden"){const{history:y}=window;if(!y.state)return;y.replaceState(Gt({},y.state,{scroll:ju()}),"")}}function m(){for(const y of i)y();i=[],window.removeEventListener("popstate",c),window.removeEventListener("pagehide",f),document.removeEventListener("visibilitychange",f)}return window.addEventListener("popstate",c),window.addEventListener("pagehide",f),document.addEventListener("visibilitychange",f),{pauseListeners:d,listen:h,destroy:m}}function Gp(e,t,n,a=!1,o=!1){return{back:e,current:t,forward:n,replaced:a,position:window.history.length,scroll:o?ju():null}}function Zb(e){const{history:t,location:n}=window,a={value:iy(e,n)},o={value:t.state};o.value||i(a.value,{back:null,current:a.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(d,h,f){const m=e.indexOf("#"),y=m>-1?(n.host&&document.querySelector("base")?e:e.slice(m))+d:jb()+e+d;try{t[f?"replaceState":"pushState"](h,"",y),o.value=h}catch(k){console.error(k),n[f?"replace":"assign"](y)}}function l(d,h){i(d,Gt({},t.state,Gp(o.value.back,d,o.value.forward,!0),h,{position:o.value.position}),!0),a.value=d}function c(d,h){const f=Gt({},o.value,t.state,{forward:d,scroll:ju()});i(f.current,f,!0),i(d,Gt({},Gp(a.value,d,null),{position:f.position+1},h),!1),a.value=d}return{location:a,state:o,push:c,replace:l}}function Kb(e){e=Eb(e);const t=Zb(e),n=Wb(e,t.state,t.location,t.replace);function a(i,l=!0){l||n.pauseListeners(),history.go(i)}const o=Gt({location:"",base:e,go:a,createHref:Db.bind(null,e)},t,n);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>t.state.value}),o}function Yb(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),Kb(e)}let tl=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var Tn=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(Tn||{});const Jb={type:tl.Static,value:""},Xb=/[a-zA-Z0-9_]/;function Qb(e){if(!e)return[[]];if(e==="/")return[[Jb]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(k){throw new Error(`ERR (${n})/"${h}": ${k}`)}let n=Tn.Static,a=n;const o=[];let i;function l(){i&&o.push(i),i=[]}let c=0,d,h="",f="";function m(){h&&(n===Tn.Static?i.push({type:tl.Static,value:h}):n===Tn.Param||n===Tn.ParamRegExp||n===Tn.ParamRegExpEnd?(i.length>1&&(d==="*"||d==="+")&&t(`A repeatable param (${h}) must be alone in its segment. eg: '/:ids+.`),i.push({type:tl.Param,value:h,regexp:f,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):t("Invalid state to consume buffer"),h="")}function y(){h+=d}for(;c<e.length;){if(d=e[c++],d==="\\"&&n!==Tn.ParamRegExp){a=n,n=Tn.EscapeNext;continue}switch(n){case Tn.Static:d==="/"?(h&&m(),l()):d===":"?(m(),n=Tn.Param):y();break;case Tn.EscapeNext:y(),n=a;break;case Tn.Param:d==="("?n=Tn.ParamRegExp:Xb.test(d)?y():(m(),n=Tn.Static,d!=="*"&&d!=="?"&&d!=="+"&&c--);break;case Tn.ParamRegExp:d===")"?f[f.length-1]=="\\"?f=f.slice(0,-1)+d:n=Tn.ParamRegExpEnd:f+=d;break;case Tn.ParamRegExpEnd:m(),n=Tn.Static,d!=="*"&&d!=="?"&&d!=="+"&&c--,f="";break;default:t("Unknown state");break}}return n===Tn.ParamRegExp&&t(`Unfinished custom RegExp for param "${h}"`),m(),l(),o}const qp="[^/]+?",e_={sensitive:!1,strict:!1,start:!0,end:!0};var go=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(go||{});const t_=/[.+*?^${}()[\]/\\]/g;function n_(e,t){const n=Gt({},e_,t),a=[];let o=n.start?"^":"";const i=[];for(const h of e){const f=h.length?[]:[go.Root];n.strict&&!h.length&&(o+="/");for(let m=0;m<h.length;m++){const y=h[m];let k=go.Segment+(n.sensitive?go.BonusCaseSensitive:0);if(y.type===tl.Static)m||(o+="/"),o+=y.value.replace(t_,"\\$&"),k+=go.Static;else if(y.type===tl.Param){const{value:S,repeatable:x,optional:E,regexp:$}=y;i.push({name:S,repeatable:x,optional:E});const w=$||qp;if(w!==qp){k+=go.BonusCustomRegExp;try{`${w}`}catch(I){throw new Error(`Invalid custom RegExp for param "${S}" (${w}): `+I.message)}}let _=x?`((?:${w})(?:/(?:${w}))*)`:`(${w})`;m||(_=E&&h.length<2?`(?:/${_})`:"/"+_),E&&(_+="?"),o+=_,k+=go.Dynamic,E&&(k+=go.BonusOptional),x&&(k+=go.BonusRepeatable),w===".*"&&(k+=go.BonusWildcard)}f.push(k)}a.push(f)}if(n.strict&&n.end){const h=a.length-1;a[h][a[h].length-1]+=go.BonusStrict}n.strict||(o+="/?"),n.end?o+="$":n.strict&&!o.endsWith("/")&&(o+="(?:/|$)");const l=new RegExp(o,n.sensitive?"":"i");function c(h){const f=h.match(l),m={};if(!f)return null;for(let y=1;y<f.length;y++){const k=f[y]||"",S=i[y-1];m[S.name]=k&&S.repeatable?k.split("/"):k}return m}function d(h){let f="",m=!1;for(const y of e){(!m||!f.endsWith("/"))&&(f+="/"),m=!1;for(const k of y)if(k.type===tl.Static)f+=k.value;else if(k.type===tl.Param){const{value:S,repeatable:x,optional:E}=k,$=S in h?h[S]:"";if($a($)&&!x)throw new Error(`Provided param "${S}" is an array but it is not repeatable (* or + modifiers)`);const w=$a($)?$.join("/"):$;if(!w)if(E)y.length<2&&(f.endsWith("/")?f=f.slice(0,-1):m=!0);else throw new Error(`Missing required param "${S}"`);f+=w}}return f||"/"}return{re:l,score:a,keys:i,parse:c,stringify:d}}function o_(e,t){let n=0;for(;n<e.length&&n<t.length;){const a=t[n]-e[n];if(a)return a;n++}return e.length<t.length?e.length===1&&e[0]===go.Static+go.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===go.Static+go.Segment?1:-1:0}function ly(e,t){let n=0;const a=e.score,o=t.score;for(;n<a.length&&n<o.length;){const i=o_(a[n],o[n]);if(i)return i;n++}if(Math.abs(o.length-a.length)===1){if(jp(a))return 1;if(jp(o))return-1}return o.length-a.length}function jp(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const a_={strict:!1,end:!0,sensitive:!1};function s_(e,t,n){const a=n_(Qb(e.path),n),o=Gt(a,{record:e,parent:t,children:[],alias:[]});return t&&!o.record.aliasOf==!t.record.aliasOf&&t.children.push(o),o}function i_(e,t){const n=[],a=new Map;t=Np(a_,t);function o(m){return a.get(m)}function i(m,y,k){const S=!k,x=Zp(m);x.aliasOf=k&&k.record;const E=Np(t,m),$=[x];if("alias"in m){const I=typeof m.alias=="string"?[m.alias]:m.alias;for(const T of I)$.push(Zp(Gt({},x,{components:k?k.record.components:x.components,path:T,aliasOf:k?k.record:x})))}let w,_;for(const I of $){const{path:T}=I;if(y&&T[0]!=="/"){const B=y.record.path,M=B[B.length-1]==="/"?"":"/";I.path=y.record.path+(T&&M+T)}if(w=s_(I,y,E),k?k.alias.push(w):(_=_||w,_!==w&&_.alias.push(w),S&&m.name&&!Kp(w)&&l(m.name)),ry(w)&&d(w),x.children){const B=x.children;for(let M=0;M<B.length;M++)i(B[M],w,k&&k.children[M])}k=k||w}return _?()=>{l(_)}:Hr}function l(m){if(ay(m)){const y=a.get(m);y&&(a.delete(m),n.splice(n.indexOf(y),1),y.children.forEach(l),y.alias.forEach(l))}else{const y=n.indexOf(m);y>-1&&(n.splice(y,1),m.record.name&&a.delete(m.record.name),m.children.forEach(l),m.alias.forEach(l))}}function c(){return n}function d(m){const y=c_(m,n);n.splice(y,0,m),m.record.name&&!Kp(m)&&a.set(m.record.name,m)}function h(m,y){let k,S={},x,E;if("name"in m&&m.name){if(k=a.get(m.name),!k)throw tr(yn.MATCHER_NOT_FOUND,{location:m});E=k.record.name,S=Gt(Wp(y.params,k.keys.filter(_=>!_.optional).concat(k.parent?k.parent.keys.filter(_=>_.optional):[]).map(_=>_.name)),m.params&&Wp(m.params,k.keys.map(_=>_.name))),x=k.stringify(S)}else if(m.path!=null)x=m.path,k=n.find(_=>_.re.test(x)),k&&(S=k.parse(x),E=k.record.name);else{if(k=y.name?a.get(y.name):n.find(_=>_.re.test(y.path)),!k)throw tr(yn.MATCHER_NOT_FOUND,{location:m,currentLocation:y});E=k.record.name,S=Gt({},y.params,m.params),x=k.stringify(S)}const $=[];let w=k;for(;w;)$.unshift(w.record),w=w.parent;return{name:E,path:x,params:S,matched:$,meta:r_($)}}e.forEach(m=>i(m));function f(){n.length=0,a.clear()}return{addRoute:i,resolve:h,removeRoute:l,clearRoutes:f,getRoutes:c,getRecordMatcher:o}}function Wp(e,t){const n={};for(const a of t)a in e&&(n[a]=e[a]);return n}function Zp(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:l_(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function l_(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const a in e.components)t[a]=typeof n=="object"?n[a]:n;return t}function Kp(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function r_(e){return e.reduce((t,n)=>Gt(t,n.meta),{})}function c_(e,t){let n=0,a=t.length;for(;n!==a;){const i=n+a>>1;ly(e,t[i])<0?a=i:n=i+1}const o=u_(e);return o&&(a=t.lastIndexOf(o,a-1)),a}function u_(e){let t=e;for(;t=t.parent;)if(ry(t)&&ly(e,t)===0)return t}function ry({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Yp(e){const t=$o(Wu),n=$o(If),a=z(()=>{const d=N(e.to);return t.resolve(d)}),o=z(()=>{const{matched:d}=a.value,{length:h}=d,f=d[h-1],m=n.matched;if(!f||!m.length)return-1;const y=m.findIndex(er.bind(null,f));if(y>-1)return y;const k=Jp(d[h-2]);return h>1&&Jp(f)===k&&m[m.length-1].path!==k?m.findIndex(er.bind(null,d[h-2])):y}),i=z(()=>o.value>-1&&v_(n.params,a.value.params)),l=z(()=>o.value>-1&&o.value===n.matched.length-1&&oy(n.params,a.value.params));function c(d={}){if(p_(d)){const h=t[N(e.replace)?"replace":"push"](N(e.to)).catch(Hr);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>h),h}return Promise.resolve()}return{route:a,href:z(()=>a.value.href),isActive:i,isExactActive:l,navigate:c}}function d_(e){return e.length===1?e[0]:e}const h_=fg({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Yp,setup(e,{slots:t}){const n=ul(Yp(e)),{options:a}=$o(Wu),o=z(()=>({[Xp(e.activeClass,a.linkActiveClass,"router-link-active")]:n.isActive,[Xp(e.exactActiveClass,a.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=t.default&&d_(t.default(n));return e.custom?i:Cf("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:o.value},i)}}}),f_=h_;function p_(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function v_(e,t){for(const n in t){const a=t[n],o=e[n];if(typeof a=="string"){if(a!==o)return!1}else if(!$a(o)||o.length!==a.length||a.some((i,l)=>i.valueOf()!==o[l].valueOf()))return!1}return!0}function Jp(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Xp=(e,t,n)=>e??t??n,m_=fg({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const a=$o(Nh),o=z(()=>e.route||a.value),i=$o(Vp,0),l=z(()=>{let h=N(i);const{matched:f}=o.value;let m;for(;(m=f[h])&&!m.components;)h++;return h}),c=z(()=>o.value.matched[l.value]);Rr(Vp,z(()=>l.value+1)),Rr(Gb,c),Rr(Nh,o);const d=P();return Ye(()=>[d.value,c.value,e.name],([h,f,m],[y,k,S])=>{f&&(f.instances[m]=h,k&&k!==f&&h&&h===y&&(f.leaveGuards.size||(f.leaveGuards=k.leaveGuards),f.updateGuards.size||(f.updateGuards=k.updateGuards))),h&&f&&(!k||!er(f,k)||!y)&&(f.enterCallbacks[m]||[]).forEach(x=>x(h))},{flush:"post"}),()=>{const h=o.value,f=e.name,m=c.value,y=m&&m.components[f];if(!y)return Qp(n.default,{Component:y,route:h});const k=m.props[f],S=k?k===!0?h.params:typeof k=="function"?k(h):k:null,E=Cf(y,Gt({},S,t,{onVnodeUnmounted:$=>{$.component.isUnmounted&&(m.instances[f]=null)},ref:d}));return Qp(n.default,{Component:E,route:h})||E}}});function Qp(e,t){if(!e)return null;const n=e(t);return n.length===1?n[0]:n}const g_=m_;function y_(e){const t=i_(e.routes,e),n=e.parseQuery||Hb,a=e.stringifyQuery||Hp,o=e.history,i=wr(),l=wr(),c=wr(),d=fk(Ys);let h=Ys;Ul&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const f=Md.bind(null,V=>""+V),m=Md.bind(null,Sb),y=Md.bind(null,ac);function k(V,Y){let re,ie;return ay(V)?(re=t.getRecordMatcher(V),ie=Y):ie=V,t.addRoute(ie,re)}function S(V){const Y=t.getRecordMatcher(V);Y&&t.removeRoute(Y)}function x(){return t.getRoutes().map(V=>V.record)}function E(V){return!!t.getRecordMatcher(V)}function $(V,Y){if(Y=Gt({},Y||d.value),typeof V=="string"){const ee=Ad(n,V,Y.path),Ce=t.resolve({path:ee.path},Y),Ne=o.createHref(ee.fullPath);return Gt(ee,Ce,{params:y(Ce.params),hash:ac(ee.hash),redirectedFrom:void 0,href:Ne})}let re;if(V.path!=null)re=Gt({},V,{path:Ad(n,V.path,Y.path).path});else{const ee=Gt({},V.params);for(const Ce in ee)ee[Ce]==null&&delete ee[Ce];re=Gt({},V,{params:m(ee)}),Y.params=m(Y.params)}const ie=t.resolve(re,Y),$e=V.hash||"";ie.params=f(y(ie.params));const q=$b(a,Gt({},V,{hash:wb($e),path:ie.path})),X=o.createHref(q);return Gt({fullPath:q,hash:$e,query:a===Hp?Vb(V.query):V.query||{}},ie,{redirectedFrom:void 0,href:X})}function w(V){return typeof V=="string"?Ad(n,V,d.value.path):Gt({},V)}function _(V,Y){if(h!==V)return tr(yn.NAVIGATION_CANCELLED,{from:Y,to:V})}function I(V){return M(V)}function T(V){return I(Gt(w(V),{replace:!0}))}function B(V,Y){const re=V.matched[V.matched.length-1];if(re&&re.redirect){const{redirect:ie}=re;let $e=typeof ie=="function"?ie(V,Y):ie;return typeof $e=="string"&&($e=$e.includes("?")||$e.includes("#")?$e=w($e):{path:$e},$e.params={}),Gt({query:V.query,hash:V.hash,params:$e.path!=null?{}:V.params},$e)}}function M(V,Y){const re=h=$(V),ie=d.value,$e=V.state,q=V.force,X=V.replace===!0,ee=B(re,ie);if(ee)return M(Gt(w(ee),{state:typeof ee=="object"?Gt({},$e,ee.state):$e,force:q,replace:X}),Y||re);const Ce=re;Ce.redirectedFrom=Y;let Ne;return!q&&Tb(a,ie,re)&&(Ne=tr(yn.NAVIGATION_DUPLICATED,{to:Ce,from:ie}),he(ie,ie,!0,!1)),(Ne?Promise.resolve(Ne):G(Ce,ie)).catch(Be=>fs(Be)?fs(Be,yn.NAVIGATION_GUARD_REDIRECT)?Be:oe(Be):U(Be,Ce,ie)).then(Be=>{if(Be){if(fs(Be,yn.NAVIGATION_GUARD_REDIRECT))return M(Gt({replace:X},w(Be.to),{state:typeof Be.to=="object"?Gt({},$e,Be.to.state):$e,force:q}),Y||Ce)}else Be=j(Ce,ie,!0,X,$e);return F(Ce,ie,Be),Be})}function R(V,Y){const re=_(V,Y);return re?Promise.reject(re):Promise.resolve()}function A(V){const Y=He.values().next().value;return Y&&typeof Y.runWithContext=="function"?Y.runWithContext(V):V()}function G(V,Y){let re;const[ie,$e,q]=qb(V,Y);re=Pd(ie.reverse(),"beforeRouteLeave",V,Y);for(const ee of ie)ee.leaveGuards.forEach(Ce=>{re.push(ni(Ce,V,Y))});const X=R.bind(null,V,Y);return re.push(X),be(re).then(()=>{re=[];for(const ee of i.list())re.push(ni(ee,V,Y));return re.push(X),be(re)}).then(()=>{re=Pd($e,"beforeRouteUpdate",V,Y);for(const ee of $e)ee.updateGuards.forEach(Ce=>{re.push(ni(Ce,V,Y))});return re.push(X),be(re)}).then(()=>{re=[];for(const ee of q)if(ee.beforeEnter)if($a(ee.beforeEnter))for(const Ce of ee.beforeEnter)re.push(ni(Ce,V,Y));else re.push(ni(ee.beforeEnter,V,Y));return re.push(X),be(re)}).then(()=>(V.matched.forEach(ee=>ee.enterCallbacks={}),re=Pd(q,"beforeRouteEnter",V,Y,A),re.push(X),be(re))).then(()=>{re=[];for(const ee of l.list())re.push(ni(ee,V,Y));return re.push(X),be(re)}).catch(ee=>fs(ee,yn.NAVIGATION_CANCELLED)?ee:Promise.reject(ee))}function F(V,Y,re){c.list().forEach(ie=>A(()=>ie(V,Y,re)))}function j(V,Y,re,ie,$e){const q=_(V,Y);if(q)return q;const X=Y===Ys,ee=Ul?history.state:{};re&&(ie||X?o.replace(V.fullPath,Gt({scroll:X&&ee&&ee.scroll},$e)):o.push(V.fullPath,$e)),d.value=V,he(V,Y,re,X),oe()}let K;function J(){K||(K=o.listen((V,Y,re)=>{if(!We.listening)return;const ie=$(V),$e=B(ie,We.currentRoute.value);if($e){M(Gt($e,{replace:!0,force:!0}),ie).catch(Hr);return}h=ie;const q=d.value;Ul&&Bb(zp(q.fullPath,re.delta),ju()),G(ie,q).catch(X=>fs(X,yn.NAVIGATION_ABORTED|yn.NAVIGATION_CANCELLED)?X:fs(X,yn.NAVIGATION_GUARD_REDIRECT)?(M(Gt(w(X.to),{force:!0}),ie).then(ee=>{fs(ee,yn.NAVIGATION_ABORTED|yn.NAVIGATION_DUPLICATED)&&!re.delta&&re.type===Oh.pop&&o.go(-1,!1)}).catch(Hr),Promise.reject()):(re.delta&&o.go(-re.delta,!1),U(X,ie,q))).then(X=>{X=X||j(ie,q,!1),X&&(re.delta&&!fs(X,yn.NAVIGATION_CANCELLED)?o.go(-re.delta,!1):re.type===Oh.pop&&fs(X,yn.NAVIGATION_ABORTED|yn.NAVIGATION_DUPLICATED)&&o.go(-1,!1)),F(ie,q,X)}).catch(Hr)}))}let ue=wr(),Z=wr(),se;function U(V,Y,re){oe(V);const ie=Z.list();return ie.length?ie.forEach($e=>$e(V,Y,re)):console.error(V),Promise.reject(V)}function Q(){return se&&d.value!==Ys?Promise.resolve():new Promise((V,Y)=>{ue.add([V,Y])})}function oe(V){return se||(se=!V,J(),ue.list().forEach(([Y,re])=>V?re(V):Y()),ue.reset()),V}function he(V,Y,re,ie){const{scrollBehavior:$e}=e;if(!Ul||!$e)return Promise.resolve();const q=!re&&Nb(zp(V.fullPath,0))||(ie||!re)&&history.state&&history.state.scroll||null;return dn().then(()=>$e(V,Y,q)).then(X=>X&&Ob(X)).catch(X=>U(X,V,Y))}const Te=V=>o.go(V);let je;const He=new Set,We={currentRoute:d,listening:!0,addRoute:k,removeRoute:S,clearRoutes:t.clearRoutes,hasRoute:E,getRoutes:x,resolve:$,options:e,push:I,replace:T,go:Te,back:()=>Te(-1),forward:()=>Te(1),beforeEach:i.add,beforeResolve:l.add,afterEach:c.add,onError:Z.add,isReady:Q,install(V){V.component("RouterLink",f_),V.component("RouterView",g_),V.config.globalProperties.$router=We,Object.defineProperty(V.config.globalProperties,"$route",{enumerable:!0,get:()=>N(d)}),Ul&&!je&&d.value===Ys&&(je=!0,I(o.location).catch(ie=>{}));const Y={};for(const ie in Ys)Object.defineProperty(Y,ie,{get:()=>d.value[ie],enumerable:!0});V.provide(Wu,We),V.provide(If,Wm(Y)),V.provide(Nh,d);const re=V.unmount;He.add(V),V.unmount=function(){He.delete(V),He.size<1&&(h=Ys,K&&K(),K=null,d.value=Ys,je=!1,se=!1),re()}}};function be(V){return V.reduce((Y,re)=>Y.then(()=>A(re)),Promise.resolve())}return We}function sr(){return $o(Wu)}function Zu(e){return $o(If)}const k_=500,b_=3e3,__=500,Xi=P(new Map),xf=P(!1),pu=P("");let w_=0,Vr=null;function C_(e){const t=(e||"get").toUpperCase();return["POST","PUT","PATCH","DELETE"].includes(t)?{message:"Saving...",delay:k_}:{message:"Loading...",delay:b_}}function L_(){Vr&&(clearTimeout(Vr),Vr=null)}function S_(e){if(e.skipLoadingOverlay)return null;L_();const t=++w_,{message:n,delay:a}=C_(e.method),o=setTimeout(()=>{Xi.value.has(t)&&(pu.value=n,xf.value=!0)},a);return Xi.value.set(t,{config:e,message:n,timeoutId:o}),e._loadingRequestId=t,t}function ev(e){if(e===null)return;const t=Xi.value.get(e);if(t)if(clearTimeout(t.timeoutId),Xi.value.delete(e),Xi.value.size===0)Vr=setTimeout(()=>{Xi.value.size===0&&(xf.value=!1,pu.value=""),Vr=null},__);else{const n=Xi.value.values().next().value;n&&(pu.value=n.message)}}function tv(e){return e?._loadingRequestId}function I_(){return{showOverlay:xf,overlayMessage:pu}}const Ze=(e,t)=>{const n=e.__vccOpts||e;for(const[a,o]of t)n[a]=o;return n},x_={key:0,class:"loading-overlay"},$_={class:"loading-content"},T_={class:"loading-message"},M_={__name:"LoadingOverlay",setup(e){const{showOverlay:t,overlayMessage:n}=I_();return(a,o)=>(p(),ze(Ca,{name:"fade"},{default:Ue(()=>[N(t)?(p(),g("div",x_,[r("div",$_,[o[0]||(o[0]=r("div",{class:"spinner"},null,-1)),r("p",T_,b(N(n)||"Loading..."),1)])])):D("",!0)]),_:1}))}},A_=Ze(M_,[["__scopeId","data-v-fdee3530"]]),E_={__name:"App",setup(e){const t=sr(),n=P(""),a=["/","/sessions"];return Ye(()=>t.currentRoute.value,(o,i)=>{if(!i?.path){n.value="";return}const l=a.indexOf(o.path),c=a.indexOf(i.path);l!==-1&&c!==-1?n.value=l>c?"slide-left":"slide-right":n.value=""},{immediate:!0}),(o,i)=>{const l=gf("router-view");return p(),g(xe,null,[Ee(l,null,{default:Ue(({Component:c,route:d})=>[Ee(Ca,{name:n.value,mode:"out-in"},{default:Ue(()=>[(p(),ze(Hk(c),{key:d.path}))]),_:2},1032,["name"])]),_:1}),Ee(A_)],64)}}},ir="marshalSessions",P_=30;function vu(e,t){return`${e}:${t}`}function $f(e){const[t,n]=e.split(":");return{eventId:t,marshalId:n}}function gi(){try{return JSON.parse(localStorage.getItem(ir)||"{}")}catch{return{}}}function mu(e){const t=gi(),n=Object.entries(t).filter(([a])=>a.startsWith(`${e}:`)).map(([a,o])=>({sessionKey:a,...o}));return n.length===0?null:(n.sort((a,o)=>new Date(o.lastAccessed)-new Date(a.lastAccessed)),n[0])}function nv(e,t){if(!t.marshalId){console.error("Cannot save session without marshalId");return}const n=gi(),a=vu(e,t.marshalId);n[a]={...n[a],...t,eventId:e,lastAccessed:new Date().toISOString()},localStorage.setItem(ir,JSON.stringify(n))}function Fh(e){const t=gi(),{eventId:n,marshalId:a}=$f(e);delete t[e],localStorage.setItem(ir,JSON.stringify(t)),localStorage.removeItem(`marshalCode_${n}_${a}`)}function cy(e,t){const n=gi(),a=vu(e,t);n[a]&&(n[a].lastAccessed=new Date().toISOString(),localStorage.setItem(ir,JSON.stringify(n)))}function uy(){const e=gi(),t=new Date;t.setDate(t.getDate()-P_);let n=!1;for(const a of Object.keys(e))if(new Date(e[a].lastAccessed)<t){const{eventId:i,marshalId:l}=$f(a);delete e[a],localStorage.removeItem(`marshalCode_${i}_${l}`),n=!0}n&&localStorage.setItem(ir,JSON.stringify(e))}function dy(){const e=gi(),t=[];for(let a=0;a<localStorage.length;a++){const o=localStorage.key(a);if(o&&o.startsWith("marshal_")&&!o.startsWith("marshalCode_")&&!o.startsWith("marshalSessions")){const i=o.replace("marshal_",""),l=localStorage.getItem(o);if(l){const c=vu(i,l);e[c]||(e[c]={marshalId:l,eventId:i,token:null,lastAccessed:new Date().toISOString()})}t.push(o)}}const n=Object.keys(e).filter(a=>!a.includes(":"));for(const a of n){const o=e[a];if(o&&o.marshalId){const i=vu(a,o.marshalId);e[i]||(e[i]={...o,eventId:a}),delete e[a]}}(t.length>0||n.length>0)&&(localStorage.setItem(ir,JSON.stringify(e)),t.forEach(a=>localStorage.removeItem(a)))}function D_(){const e=gi();return Object.entries(e).map(([t,n])=>{const{eventId:a,marshalId:o}=$f(t);return{sessionKey:t,eventId:a,marshalId:o,...n}}).filter(t=>t.token).sort((t,n)=>t.eventDate&&n.eventDate?new Date(t.eventDate)-new Date(n.eventDate):new Date(n.lastAccessed)-new Date(t.lastAccessed))}function hy(){const e=gi();return Object.values(e).some(t=>t.token)}function fy(e,t){const n=`marshalCode_${e}_${t}`,a=localStorage.getItem(n);return a||localStorage.getItem(`marshalCode_${e}`)}function R_(e,t,n){localStorage.setItem(`marshalCode_${e}_${t}`,n)}function py(e,t){return function(){return e.apply(t,arguments)}}const{toString:O_}=Object.prototype,{getPrototypeOf:Tf}=Object,{iterator:Ku,toStringTag:vy}=Symbol,Yu=(e=>t=>{const n=O_.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Ta=e=>(e=e.toLowerCase(),t=>Yu(t)===e),Ju=e=>t=>typeof t===e,{isArray:lr}=Array,nr=Ju("undefined");function uc(e){return e!==null&&!nr(e)&&e.constructor!==null&&!nr(e.constructor)&&To(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const my=Ta("ArrayBuffer");function B_(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&my(e.buffer),t}const N_=Ju("string"),To=Ju("function"),gy=Ju("number"),dc=e=>e!==null&&typeof e=="object",F_=e=>e===!0||e===!1,Wc=e=>{if(Yu(e)!=="object")return!1;const t=Tf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(vy in e)&&!(Ku in e)},U_=e=>{if(!dc(e)||uc(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},z_=Ta("Date"),H_=Ta("File"),V_=Ta("Blob"),G_=Ta("FileList"),q_=e=>dc(e)&&To(e.pipe),j_=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||To(e.append)&&((t=Yu(e))==="formdata"||t==="object"&&To(e.toString)&&e.toString()==="[object FormData]"))},W_=Ta("URLSearchParams"),[Z_,K_,Y_,J_]=["ReadableStream","Request","Response","Headers"].map(Ta),X_=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function hc(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let a,o;if(typeof e!="object"&&(e=[e]),lr(e))for(a=0,o=e.length;a<o;a++)t.call(null,e[a],a,e);else{if(uc(e))return;const i=n?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let c;for(a=0;a<l;a++)c=i[a],t.call(null,e[c],c,e)}}function yy(e,t){if(uc(e))return null;t=t.toLowerCase();const n=Object.keys(e);let a=n.length,o;for(;a-- >0;)if(o=n[a],t===o.toLowerCase())return o;return null}const nl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ky=e=>!nr(e)&&e!==nl;function Uh(){const{caseless:e,skipUndefined:t}=ky(this)&&this||{},n={},a=(o,i)=>{const l=e&&yy(n,i)||i;Wc(n[l])&&Wc(o)?n[l]=Uh(n[l],o):Wc(o)?n[l]=Uh({},o):lr(o)?n[l]=o.slice():(!t||!nr(o))&&(n[l]=o)};for(let o=0,i=arguments.length;o<i;o++)arguments[o]&&hc(arguments[o],a);return n}const Q_=(e,t,n,{allOwnKeys:a}={})=>(hc(t,(o,i)=>{n&&To(o)?e[i]=py(o,n):e[i]=o},{allOwnKeys:a}),e),ew=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),tw=(e,t,n,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},nw=(e,t,n,a)=>{let o,i,l;const c={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),i=o.length;i-- >0;)l=o[i],(!a||a(l,e,t))&&!c[l]&&(t[l]=e[l],c[l]=!0);e=n!==!1&&Tf(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},ow=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const a=e.indexOf(t,n);return a!==-1&&a===n},aw=e=>{if(!e)return null;if(lr(e))return e;let t=e.length;if(!gy(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},sw=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Tf(Uint8Array)),iw=(e,t)=>{const a=(e&&e[Ku]).call(e);let o;for(;(o=a.next())&&!o.done;){const i=o.value;t.call(e,i[0],i[1])}},lw=(e,t)=>{let n;const a=[];for(;(n=e.exec(t))!==null;)a.push(n);return a},rw=Ta("HTMLFormElement"),cw=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,a,o){return a.toUpperCase()+o}),ov=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),uw=Ta("RegExp"),by=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),a={};hc(n,(o,i)=>{let l;(l=t(o,i,e))!==!1&&(a[i]=l||o)}),Object.defineProperties(e,a)},dw=e=>{by(e,(t,n)=>{if(To(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const a=e[n];if(To(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},hw=(e,t)=>{const n={},a=o=>{o.forEach(i=>{n[i]=!0})};return lr(e)?a(e):a(String(e).split(t)),n},fw=()=>{},pw=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function vw(e){return!!(e&&To(e.append)&&e[vy]==="FormData"&&e[Ku])}const mw=e=>{const t=new Array(10),n=(a,o)=>{if(dc(a)){if(t.indexOf(a)>=0)return;if(uc(a))return a;if(!("toJSON"in a)){t[o]=a;const i=lr(a)?[]:{};return hc(a,(l,c)=>{const d=n(l,o+1);!nr(d)&&(i[c]=d)}),t[o]=void 0,i}}return a};return n(e,0)},gw=Ta("AsyncFunction"),yw=e=>e&&(dc(e)||To(e))&&To(e.then)&&To(e.catch),_y=((e,t)=>e?setImmediate:t?((n,a)=>(nl.addEventListener("message",({source:o,data:i})=>{o===nl&&i===n&&a.length&&a.shift()()},!1),o=>{a.push(o),nl.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",To(nl.postMessage)),kw=typeof queueMicrotask<"u"?queueMicrotask.bind(nl):typeof process<"u"&&process.nextTick||_y,bw=e=>e!=null&&To(e[Ku]),Oe={isArray:lr,isArrayBuffer:my,isBuffer:uc,isFormData:j_,isArrayBufferView:B_,isString:N_,isNumber:gy,isBoolean:F_,isObject:dc,isPlainObject:Wc,isEmptyObject:U_,isReadableStream:Z_,isRequest:K_,isResponse:Y_,isHeaders:J_,isUndefined:nr,isDate:z_,isFile:H_,isBlob:V_,isRegExp:uw,isFunction:To,isStream:q_,isURLSearchParams:W_,isTypedArray:sw,isFileList:G_,forEach:hc,merge:Uh,extend:Q_,trim:X_,stripBOM:ew,inherits:tw,toFlatObject:nw,kindOf:Yu,kindOfTest:Ta,endsWith:ow,toArray:aw,forEachEntry:iw,matchAll:lw,isHTMLForm:rw,hasOwnProperty:ov,hasOwnProp:ov,reduceDescriptors:by,freezeMethods:dw,toObjectSet:hw,toCamelCase:cw,noop:fw,toFiniteNumber:pw,findKey:yy,global:nl,isContextDefined:ky,isSpecCompliantForm:vw,toJSONObject:mw,isAsyncFn:gw,isThenable:yw,setImmediate:_y,asap:kw,isIterable:bw};function It(e,t,n,a,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),a&&(this.request=a),o&&(this.response=o,this.status=o.status?o.status:null)}Oe.inherits(It,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Oe.toJSONObject(this.config),code:this.code,status:this.status}}});const wy=It.prototype,Cy={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Cy[e]={value:e}});Object.defineProperties(It,Cy);Object.defineProperty(wy,"isAxiosError",{value:!0});It.from=(e,t,n,a,o,i)=>{const l=Object.create(wy);Oe.toFlatObject(e,l,function(f){return f!==Error.prototype},h=>h!=="isAxiosError");const c=e&&e.message?e.message:"Error",d=t==null&&e?e.code:t;return It.call(l,c,d,n,a,o),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",i&&Object.assign(l,i),l};const _w=null;function zh(e){return Oe.isPlainObject(e)||Oe.isArray(e)}function Ly(e){return Oe.endsWith(e,"[]")?e.slice(0,-2):e}function av(e,t,n){return e?e.concat(t).map(function(o,i){return o=Ly(o),!n&&i?"["+o+"]":o}).join(n?".":""):t}function ww(e){return Oe.isArray(e)&&!e.some(zh)}const Cw=Oe.toFlatObject(Oe,{},null,function(t){return/^is[A-Z]/.test(t)});function Xu(e,t,n){if(!Oe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=Oe.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,E){return!Oe.isUndefined(E[x])});const a=n.metaTokens,o=n.visitor||f,i=n.dots,l=n.indexes,d=(n.Blob||typeof Blob<"u"&&Blob)&&Oe.isSpecCompliantForm(t);if(!Oe.isFunction(o))throw new TypeError("visitor must be a function");function h(S){if(S===null)return"";if(Oe.isDate(S))return S.toISOString();if(Oe.isBoolean(S))return S.toString();if(!d&&Oe.isBlob(S))throw new It("Blob is not supported. Use a Buffer instead.");return Oe.isArrayBuffer(S)||Oe.isTypedArray(S)?d&&typeof Blob=="function"?new Blob([S]):Buffer.from(S):S}function f(S,x,E){let $=S;if(S&&!E&&typeof S=="object"){if(Oe.endsWith(x,"{}"))x=a?x:x.slice(0,-2),S=JSON.stringify(S);else if(Oe.isArray(S)&&ww(S)||(Oe.isFileList(S)||Oe.endsWith(x,"[]"))&&($=Oe.toArray(S)))return x=Ly(x),$.forEach(function(_,I){!(Oe.isUndefined(_)||_===null)&&t.append(l===!0?av([x],I,i):l===null?x:x+"[]",h(_))}),!1}return zh(S)?!0:(t.append(av(E,x,i),h(S)),!1)}const m=[],y=Object.assign(Cw,{defaultVisitor:f,convertValue:h,isVisitable:zh});function k(S,x){if(!Oe.isUndefined(S)){if(m.indexOf(S)!==-1)throw Error("Circular reference detected in "+x.join("."));m.push(S),Oe.forEach(S,function($,w){(!(Oe.isUndefined($)||$===null)&&o.call(t,$,Oe.isString(w)?w.trim():w,x,y))===!0&&k($,x?x.concat(w):[w])}),m.pop()}}if(!Oe.isObject(e))throw new TypeError("data must be an object");return k(e),t}function sv(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function Mf(e,t){this._pairs=[],e&&Xu(e,this,t)}const Sy=Mf.prototype;Sy.append=function(t,n){this._pairs.push([t,n])};Sy.toString=function(t){const n=t?function(a){return t.call(this,a,sv)}:sv;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};function Lw(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Iy(e,t,n){if(!t)return e;const a=n&&n.encode||Lw;Oe.isFunction(n)&&(n={serialize:n});const o=n&&n.serialize;let i;if(o?i=o(t,n):i=Oe.isURLSearchParams(t)?t.toString():new Mf(t,n).toString(a),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class iv{constructor(){this.handlers=[]}use(t,n,a){return this.handlers.push({fulfilled:t,rejected:n,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Oe.forEach(this.handlers,function(a){a!==null&&t(a)})}}const xy={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Sw=typeof URLSearchParams<"u"?URLSearchParams:Mf,Iw=typeof FormData<"u"?FormData:null,xw=typeof Blob<"u"?Blob:null,$w={isBrowser:!0,classes:{URLSearchParams:Sw,FormData:Iw,Blob:xw},protocols:["http","https","file","blob","url","data"]},Af=typeof window<"u"&&typeof document<"u",Hh=typeof navigator=="object"&&navigator||void 0,Tw=Af&&(!Hh||["ReactNative","NativeScript","NS"].indexOf(Hh.product)<0),Mw=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Aw=Af&&window.location.href||"http://localhost",Ew=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Af,hasStandardBrowserEnv:Tw,hasStandardBrowserWebWorkerEnv:Mw,navigator:Hh,origin:Aw},Symbol.toStringTag,{value:"Module"})),oo={...Ew,...$w};function Pw(e,t){return Xu(e,new oo.classes.URLSearchParams,{visitor:function(n,a,o,i){return oo.isNode&&Oe.isBuffer(n)?(this.append(a,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function Dw(e){return Oe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Rw(e){const t={},n=Object.keys(e);let a;const o=n.length;let i;for(a=0;a<o;a++)i=n[a],t[i]=e[i];return t}function $y(e){function t(n,a,o,i){let l=n[i++];if(l==="__proto__")return!0;const c=Number.isFinite(+l),d=i>=n.length;return l=!l&&Oe.isArray(o)?o.length:l,d?(Oe.hasOwnProp(o,l)?o[l]=[o[l],a]:o[l]=a,!c):((!o[l]||!Oe.isObject(o[l]))&&(o[l]=[]),t(n,a,o[l],i)&&Oe.isArray(o[l])&&(o[l]=Rw(o[l])),!c)}if(Oe.isFormData(e)&&Oe.isFunction(e.entries)){const n={};return Oe.forEachEntry(e,(a,o)=>{t(Dw(a),o,n,0)}),n}return null}function Ow(e,t,n){if(Oe.isString(e))try{return(t||JSON.parse)(e),Oe.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(n||JSON.stringify)(e)}const fc={transitional:xy,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const a=n.getContentType()||"",o=a.indexOf("application/json")>-1,i=Oe.isObject(t);if(i&&Oe.isHTMLForm(t)&&(t=new FormData(t)),Oe.isFormData(t))return o?JSON.stringify($y(t)):t;if(Oe.isArrayBuffer(t)||Oe.isBuffer(t)||Oe.isStream(t)||Oe.isFile(t)||Oe.isBlob(t)||Oe.isReadableStream(t))return t;if(Oe.isArrayBufferView(t))return t.buffer;if(Oe.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let c;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return Pw(t,this.formSerializer).toString();if((c=Oe.isFileList(t))||a.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return Xu(c?{"files[]":t}:t,d&&new d,this.formSerializer)}}return i||o?(n.setContentType("application/json",!1),Ow(t)):t}],transformResponse:[function(t){const n=this.transitional||fc.transitional,a=n&&n.forcedJSONParsing,o=this.responseType==="json";if(Oe.isResponse(t)||Oe.isReadableStream(t))return t;if(t&&Oe.isString(t)&&(a&&!this.responseType||o)){const l=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(t,this.parseReviver)}catch(c){if(l)throw c.name==="SyntaxError"?It.from(c,It.ERR_BAD_RESPONSE,this,null,this.response):c}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:oo.classes.FormData,Blob:oo.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Oe.forEach(["delete","get","head","post","put","patch"],e=>{fc.headers[e]={}});const Bw=Oe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Nw=e=>{const t={};let n,a,o;return e&&e.split(`
`).forEach(function(l){o=l.indexOf(":"),n=l.substring(0,o).trim().toLowerCase(),a=l.substring(o+1).trim(),!(!n||t[n]&&Bw[n])&&(n==="set-cookie"?t[n]?t[n].push(a):t[n]=[a]:t[n]=t[n]?t[n]+", "+a:a)}),t},lv=Symbol("internals");function Cr(e){return e&&String(e).trim().toLowerCase()}function Zc(e){return e===!1||e==null?e:Oe.isArray(e)?e.map(Zc):String(e)}function Fw(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=n.exec(e);)t[a[1]]=a[2];return t}const Uw=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Dd(e,t,n,a,o){if(Oe.isFunction(a))return a.call(this,t,n);if(o&&(t=n),!!Oe.isString(t)){if(Oe.isString(a))return t.indexOf(a)!==-1;if(Oe.isRegExp(a))return a.test(t)}}function zw(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,a)=>n.toUpperCase()+a)}function Hw(e,t){const n=Oe.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+n,{value:function(o,i,l){return this[a].call(this,t,o,i,l)},configurable:!0})})}let Mo=class{constructor(t){t&&this.set(t)}set(t,n,a){const o=this;function i(c,d,h){const f=Cr(d);if(!f)throw new Error("header name must be a non-empty string");const m=Oe.findKey(o,f);(!m||o[m]===void 0||h===!0||h===void 0&&o[m]!==!1)&&(o[m||d]=Zc(c))}const l=(c,d)=>Oe.forEach(c,(h,f)=>i(h,f,d));if(Oe.isPlainObject(t)||t instanceof this.constructor)l(t,n);else if(Oe.isString(t)&&(t=t.trim())&&!Uw(t))l(Nw(t),n);else if(Oe.isObject(t)&&Oe.isIterable(t)){let c={},d,h;for(const f of t){if(!Oe.isArray(f))throw TypeError("Object iterator must return a key-value pair");c[h=f[0]]=(d=c[h])?Oe.isArray(d)?[...d,f[1]]:[d,f[1]]:f[1]}l(c,n)}else t!=null&&i(n,t,a);return this}get(t,n){if(t=Cr(t),t){const a=Oe.findKey(this,t);if(a){const o=this[a];if(!n)return o;if(n===!0)return Fw(o);if(Oe.isFunction(n))return n.call(this,o,a);if(Oe.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Cr(t),t){const a=Oe.findKey(this,t);return!!(a&&this[a]!==void 0&&(!n||Dd(this,this[a],a,n)))}return!1}delete(t,n){const a=this;let o=!1;function i(l){if(l=Cr(l),l){const c=Oe.findKey(a,l);c&&(!n||Dd(a,a[c],c,n))&&(delete a[c],o=!0)}}return Oe.isArray(t)?t.forEach(i):i(t),o}clear(t){const n=Object.keys(this);let a=n.length,o=!1;for(;a--;){const i=n[a];(!t||Dd(this,this[i],i,t,!0))&&(delete this[i],o=!0)}return o}normalize(t){const n=this,a={};return Oe.forEach(this,(o,i)=>{const l=Oe.findKey(a,i);if(l){n[l]=Zc(o),delete n[i];return}const c=t?zw(i):String(i).trim();c!==i&&delete n[i],n[c]=Zc(o),a[c]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return Oe.forEach(this,(a,o)=>{a!=null&&a!==!1&&(n[o]=t&&Oe.isArray(a)?a.join(", "):a)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const a=new this(t);return n.forEach(o=>a.set(o)),a}static accessor(t){const a=(this[lv]=this[lv]={accessors:{}}).accessors,o=this.prototype;function i(l){const c=Cr(l);a[c]||(Hw(o,l),a[c]=!0)}return Oe.isArray(t)?t.forEach(i):i(t),this}};Mo.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Oe.reduceDescriptors(Mo.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[n]=a}}});Oe.freezeMethods(Mo);function Rd(e,t){const n=this||fc,a=t||n,o=Mo.from(a.headers);let i=a.data;return Oe.forEach(e,function(c){i=c.call(n,i,o.normalize(),t?t.status:void 0)}),o.normalize(),i}function Ty(e){return!!(e&&e.__CANCEL__)}function rr(e,t,n){It.call(this,e??"canceled",It.ERR_CANCELED,t,n),this.name="CanceledError"}Oe.inherits(rr,It,{__CANCEL__:!0});function My(e,t,n){const a=n.config.validateStatus;!n.status||!a||a(n.status)?e(n):t(new It("Request failed with status code "+n.status,[It.ERR_BAD_REQUEST,It.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function Vw(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Gw(e,t){e=e||10;const n=new Array(e),a=new Array(e);let o=0,i=0,l;return t=t!==void 0?t:1e3,function(d){const h=Date.now(),f=a[i];l||(l=h),n[o]=d,a[o]=h;let m=i,y=0;for(;m!==o;)y+=n[m++],m=m%e;if(o=(o+1)%e,o===i&&(i=(i+1)%e),h-l<t)return;const k=f&&h-f;return k?Math.round(y*1e3/k):void 0}}function qw(e,t){let n=0,a=1e3/t,o,i;const l=(h,f=Date.now())=>{n=f,o=null,i&&(clearTimeout(i),i=null),e(...h)};return[(...h)=>{const f=Date.now(),m=f-n;m>=a?l(h,f):(o=h,i||(i=setTimeout(()=>{i=null,l(o)},a-m)))},()=>o&&l(o)]}const gu=(e,t,n=3)=>{let a=0;const o=Gw(50,250);return qw(i=>{const l=i.loaded,c=i.lengthComputable?i.total:void 0,d=l-a,h=o(d),f=l<=c;a=l;const m={loaded:l,total:c,progress:c?l/c:void 0,bytes:d,rate:h||void 0,estimated:h&&c&&f?(c-l)/h:void 0,event:i,lengthComputable:c!=null,[t?"download":"upload"]:!0};e(m)},n)},rv=(e,t)=>{const n=e!=null;return[a=>t[0]({lengthComputable:n,total:e,loaded:a}),t[1]]},cv=e=>(...t)=>Oe.asap(()=>e(...t)),jw=oo.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,oo.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(oo.origin),oo.navigator&&/(msie|trident)/i.test(oo.navigator.userAgent)):()=>!0,Ww=oo.hasStandardBrowserEnv?{write(e,t,n,a,o,i,l){if(typeof document>"u")return;const c=[`${e}=${encodeURIComponent(t)}`];Oe.isNumber(n)&&c.push(`expires=${new Date(n).toUTCString()}`),Oe.isString(a)&&c.push(`path=${a}`),Oe.isString(o)&&c.push(`domain=${o}`),i===!0&&c.push("secure"),Oe.isString(l)&&c.push(`SameSite=${l}`),document.cookie=c.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function Zw(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Kw(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Ay(e,t,n){let a=!Zw(t);return e&&(a||n==!1)?Kw(e,t):t}const uv=e=>e instanceof Mo?{...e}:e;function rl(e,t){t=t||{};const n={};function a(h,f,m,y){return Oe.isPlainObject(h)&&Oe.isPlainObject(f)?Oe.merge.call({caseless:y},h,f):Oe.isPlainObject(f)?Oe.merge({},f):Oe.isArray(f)?f.slice():f}function o(h,f,m,y){if(Oe.isUndefined(f)){if(!Oe.isUndefined(h))return a(void 0,h,m,y)}else return a(h,f,m,y)}function i(h,f){if(!Oe.isUndefined(f))return a(void 0,f)}function l(h,f){if(Oe.isUndefined(f)){if(!Oe.isUndefined(h))return a(void 0,h)}else return a(void 0,f)}function c(h,f,m){if(m in t)return a(h,f);if(m in e)return a(void 0,h)}const d={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:c,headers:(h,f,m)=>o(uv(h),uv(f),m,!0)};return Oe.forEach(Object.keys({...e,...t}),function(f){const m=d[f]||o,y=m(e[f],t[f],f);Oe.isUndefined(y)&&m!==c||(n[f]=y)}),n}const Ey=e=>{const t=rl({},e);let{data:n,withXSRFToken:a,xsrfHeaderName:o,xsrfCookieName:i,headers:l,auth:c}=t;if(t.headers=l=Mo.from(l),t.url=Iy(Ay(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),c&&l.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),Oe.isFormData(n)){if(oo.hasStandardBrowserEnv||oo.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(Oe.isFunction(n.getHeaders)){const d=n.getHeaders(),h=["content-type","content-length"];Object.entries(d).forEach(([f,m])=>{h.includes(f.toLowerCase())&&l.set(f,m)})}}if(oo.hasStandardBrowserEnv&&(a&&Oe.isFunction(a)&&(a=a(t)),a||a!==!1&&jw(t.url))){const d=o&&i&&Ww.read(i);d&&l.set(o,d)}return t},Yw=typeof XMLHttpRequest<"u",Jw=Yw&&function(e){return new Promise(function(n,a){const o=Ey(e);let i=o.data;const l=Mo.from(o.headers).normalize();let{responseType:c,onUploadProgress:d,onDownloadProgress:h}=o,f,m,y,k,S;function x(){k&&k(),S&&S(),o.cancelToken&&o.cancelToken.unsubscribe(f),o.signal&&o.signal.removeEventListener("abort",f)}let E=new XMLHttpRequest;E.open(o.method.toUpperCase(),o.url,!0),E.timeout=o.timeout;function $(){if(!E)return;const _=Mo.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders()),T={data:!c||c==="text"||c==="json"?E.responseText:E.response,status:E.status,statusText:E.statusText,headers:_,config:e,request:E};My(function(M){n(M),x()},function(M){a(M),x()},T),E=null}"onloadend"in E?E.onloadend=$:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout($)},E.onabort=function(){E&&(a(new It("Request aborted",It.ECONNABORTED,e,E)),E=null)},E.onerror=function(I){const T=I&&I.message?I.message:"Network Error",B=new It(T,It.ERR_NETWORK,e,E);B.event=I||null,a(B),E=null},E.ontimeout=function(){let I=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const T=o.transitional||xy;o.timeoutErrorMessage&&(I=o.timeoutErrorMessage),a(new It(I,T.clarifyTimeoutError?It.ETIMEDOUT:It.ECONNABORTED,e,E)),E=null},i===void 0&&l.setContentType(null),"setRequestHeader"in E&&Oe.forEach(l.toJSON(),function(I,T){E.setRequestHeader(T,I)}),Oe.isUndefined(o.withCredentials)||(E.withCredentials=!!o.withCredentials),c&&c!=="json"&&(E.responseType=o.responseType),h&&([y,S]=gu(h,!0),E.addEventListener("progress",y)),d&&E.upload&&([m,k]=gu(d),E.upload.addEventListener("progress",m),E.upload.addEventListener("loadend",k)),(o.cancelToken||o.signal)&&(f=_=>{E&&(a(!_||_.type?new rr(null,e,E):_),E.abort(),E=null)},o.cancelToken&&o.cancelToken.subscribe(f),o.signal&&(o.signal.aborted?f():o.signal.addEventListener("abort",f)));const w=Vw(o.url);if(w&&oo.protocols.indexOf(w)===-1){a(new It("Unsupported protocol "+w+":",It.ERR_BAD_REQUEST,e));return}E.send(i||null)})},Xw=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let a=new AbortController,o;const i=function(h){if(!o){o=!0,c();const f=h instanceof Error?h:this.reason;a.abort(f instanceof It?f:new rr(f instanceof Error?f.message:f))}};let l=t&&setTimeout(()=>{l=null,i(new It(`timeout ${t} of ms exceeded`,It.ETIMEDOUT))},t);const c=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(h=>{h.unsubscribe?h.unsubscribe(i):h.removeEventListener("abort",i)}),e=null)};e.forEach(h=>h.addEventListener("abort",i));const{signal:d}=a;return d.unsubscribe=()=>Oe.asap(c),d}},Qw=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let a=0,o;for(;a<n;)o=a+t,yield e.slice(a,o),a=o},eC=async function*(e,t){for await(const n of tC(e))yield*Qw(n,t)},tC=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:a}=await t.read();if(n)break;yield a}}finally{await t.cancel()}},dv=(e,t,n,a)=>{const o=eC(e,t);let i=0,l,c=d=>{l||(l=!0,a&&a(d))};return new ReadableStream({async pull(d){try{const{done:h,value:f}=await o.next();if(h){c(),d.close();return}let m=f.byteLength;if(n){let y=i+=m;n(y)}d.enqueue(new Uint8Array(f))}catch(h){throw c(h),h}},cancel(d){return c(d),o.return()}},{highWaterMark:2})},hv=64*1024,{isFunction:Dc}=Oe,nC=(({Request:e,Response:t})=>({Request:e,Response:t}))(Oe.global),{ReadableStream:fv,TextEncoder:pv}=Oe.global,vv=(e,...t)=>{try{return!!e(...t)}catch{return!1}},oC=e=>{e=Oe.merge.call({skipUndefined:!0},nC,e);const{fetch:t,Request:n,Response:a}=e,o=t?Dc(t):typeof fetch=="function",i=Dc(n),l=Dc(a);if(!o)return!1;const c=o&&Dc(fv),d=o&&(typeof pv=="function"?(S=>x=>S.encode(x))(new pv):async S=>new Uint8Array(await new n(S).arrayBuffer())),h=i&&c&&vv(()=>{let S=!1;const x=new n(oo.origin,{body:new fv,method:"POST",get duplex(){return S=!0,"half"}}).headers.has("Content-Type");return S&&!x}),f=l&&c&&vv(()=>Oe.isReadableStream(new a("").body)),m={stream:f&&(S=>S.body)};o&&["text","arrayBuffer","blob","formData","stream"].forEach(S=>{!m[S]&&(m[S]=(x,E)=>{let $=x&&x[S];if($)return $.call(x);throw new It(`Response type '${S}' is not supported`,It.ERR_NOT_SUPPORT,E)})});const y=async S=>{if(S==null)return 0;if(Oe.isBlob(S))return S.size;if(Oe.isSpecCompliantForm(S))return(await new n(oo.origin,{method:"POST",body:S}).arrayBuffer()).byteLength;if(Oe.isArrayBufferView(S)||Oe.isArrayBuffer(S))return S.byteLength;if(Oe.isURLSearchParams(S)&&(S=S+""),Oe.isString(S))return(await d(S)).byteLength},k=async(S,x)=>{const E=Oe.toFiniteNumber(S.getContentLength());return E??y(x)};return async S=>{let{url:x,method:E,data:$,signal:w,cancelToken:_,timeout:I,onDownloadProgress:T,onUploadProgress:B,responseType:M,headers:R,withCredentials:A="same-origin",fetchOptions:G}=Ey(S),F=t||fetch;M=M?(M+"").toLowerCase():"text";let j=Xw([w,_&&_.toAbortSignal()],I),K=null;const J=j&&j.unsubscribe&&(()=>{j.unsubscribe()});let ue;try{if(B&&h&&E!=="get"&&E!=="head"&&(ue=await k(R,$))!==0){let he=new n(x,{method:"POST",body:$,duplex:"half"}),Te;if(Oe.isFormData($)&&(Te=he.headers.get("content-type"))&&R.setContentType(Te),he.body){const[je,He]=rv(ue,gu(cv(B)));$=dv(he.body,hv,je,He)}}Oe.isString(A)||(A=A?"include":"omit");const Z=i&&"credentials"in n.prototype,se={...G,signal:j,method:E.toUpperCase(),headers:R.normalize().toJSON(),body:$,duplex:"half",credentials:Z?A:void 0};K=i&&new n(x,se);let U=await(i?F(K,G):F(x,se));const Q=f&&(M==="stream"||M==="response");if(f&&(T||Q&&J)){const he={};["status","statusText","headers"].forEach(We=>{he[We]=U[We]});const Te=Oe.toFiniteNumber(U.headers.get("content-length")),[je,He]=T&&rv(Te,gu(cv(T),!0))||[];U=new a(dv(U.body,hv,je,()=>{He&&He(),J&&J()}),he)}M=M||"text";let oe=await m[Oe.findKey(m,M)||"text"](U,S);return!Q&&J&&J(),await new Promise((he,Te)=>{My(he,Te,{data:oe,headers:Mo.from(U.headers),status:U.status,statusText:U.statusText,config:S,request:K})})}catch(Z){throw J&&J(),Z&&Z.name==="TypeError"&&/Load failed|fetch/i.test(Z.message)?Object.assign(new It("Network Error",It.ERR_NETWORK,S,K),{cause:Z.cause||Z}):It.from(Z,Z&&Z.code,S,K)}}},aC=new Map,Py=e=>{let t=e&&e.env||{};const{fetch:n,Request:a,Response:o}=t,i=[a,o,n];let l=i.length,c=l,d,h,f=aC;for(;c--;)d=i[c],h=f.get(d),h===void 0&&f.set(d,h=c?new Map:oC(t)),f=h;return h};Py();const Ef={http:_w,xhr:Jw,fetch:{get:Py}};Oe.forEach(Ef,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const mv=e=>`- ${e}`,sC=e=>Oe.isFunction(e)||e===null||e===!1;function iC(e,t){e=Oe.isArray(e)?e:[e];const{length:n}=e;let a,o;const i={};for(let l=0;l<n;l++){a=e[l];let c;if(o=a,!sC(a)&&(o=Ef[(c=String(a)).toLowerCase()],o===void 0))throw new It(`Unknown adapter '${c}'`);if(o&&(Oe.isFunction(o)||(o=o.get(t))))break;i[c||"#"+l]=o}if(!o){const l=Object.entries(i).map(([d,h])=>`adapter ${d} `+(h===!1?"is not supported by the environment":"is not available in the build"));let c=n?l.length>1?`since :
`+l.map(mv).join(`
`):" "+mv(l[0]):"as no adapter specified";throw new It("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return o}const Dy={getAdapter:iC,adapters:Ef};function Od(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new rr(null,e)}function gv(e){return Od(e),e.headers=Mo.from(e.headers),e.data=Rd.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Dy.getAdapter(e.adapter||fc.adapter,e)(e).then(function(a){return Od(e),a.data=Rd.call(e,e.transformResponse,a),a.headers=Mo.from(a.headers),a},function(a){return Ty(a)||(Od(e),a&&a.response&&(a.response.data=Rd.call(e,e.transformResponse,a.response),a.response.headers=Mo.from(a.response.headers))),Promise.reject(a)})}const Ry="1.13.2",Qu={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Qu[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const yv={};Qu.transitional=function(t,n,a){function o(i,l){return"[Axios v"+Ry+"] Transitional option '"+i+"'"+l+(a?". "+a:"")}return(i,l,c)=>{if(t===!1)throw new It(o(l," has been removed"+(n?" in "+n:"")),It.ERR_DEPRECATED);return n&&!yv[l]&&(yv[l]=!0,console.warn(o(l," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(i,l,c):!0}};Qu.spelling=function(t){return(n,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function lC(e,t,n){if(typeof e!="object")throw new It("options must be an object",It.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let o=a.length;for(;o-- >0;){const i=a[o],l=t[i];if(l){const c=e[i],d=c===void 0||l(c,i,e);if(d!==!0)throw new It("option "+i+" must be "+d,It.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new It("Unknown option "+i,It.ERR_BAD_OPTION)}}const Kc={assertOptions:lC,validators:Qu},Ha=Kc.validators;let sl=class{constructor(t){this.defaults=t||{},this.interceptors={request:new iv,response:new iv}}async request(t,n){try{return await this._request(t,n)}catch(a){if(a instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const i=o.stack?o.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=rl(this.defaults,n);const{transitional:a,paramsSerializer:o,headers:i}=n;a!==void 0&&Kc.assertOptions(a,{silentJSONParsing:Ha.transitional(Ha.boolean),forcedJSONParsing:Ha.transitional(Ha.boolean),clarifyTimeoutError:Ha.transitional(Ha.boolean)},!1),o!=null&&(Oe.isFunction(o)?n.paramsSerializer={serialize:o}:Kc.assertOptions(o,{encode:Ha.function,serialize:Ha.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Kc.assertOptions(n,{baseUrl:Ha.spelling("baseURL"),withXsrfToken:Ha.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let l=i&&Oe.merge(i.common,i[n.method]);i&&Oe.forEach(["delete","get","head","post","put","patch","common"],S=>{delete i[S]}),n.headers=Mo.concat(l,i);const c=[];let d=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(n)===!1||(d=d&&x.synchronous,c.unshift(x.fulfilled,x.rejected))});const h=[];this.interceptors.response.forEach(function(x){h.push(x.fulfilled,x.rejected)});let f,m=0,y;if(!d){const S=[gv.bind(this),void 0];for(S.unshift(...c),S.push(...h),y=S.length,f=Promise.resolve(n);m<y;)f=f.then(S[m++],S[m++]);return f}y=c.length;let k=n;for(;m<y;){const S=c[m++],x=c[m++];try{k=S(k)}catch(E){x.call(this,E);break}}try{f=gv.call(this,k)}catch(S){return Promise.reject(S)}for(m=0,y=h.length;m<y;)f=f.then(h[m++],h[m++]);return f}getUri(t){t=rl(this.defaults,t);const n=Ay(t.baseURL,t.url,t.allowAbsoluteUrls);return Iy(n,t.params,t.paramsSerializer)}};Oe.forEach(["delete","get","head","options"],function(t){sl.prototype[t]=function(n,a){return this.request(rl(a||{},{method:t,url:n,data:(a||{}).data}))}});Oe.forEach(["post","put","patch"],function(t){function n(a){return function(i,l,c){return this.request(rl(c||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}sl.prototype[t]=n(),sl.prototype[t+"Form"]=n(!0)});let rC=class Oy{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const a=this;this.promise.then(o=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](o);a._listeners=null}),this.promise.then=o=>{let i;const l=new Promise(c=>{a.subscribe(c),i=c}).then(o);return l.cancel=function(){a.unsubscribe(i)},l},t(function(i,l,c){a.reason||(a.reason=new rr(i,l,c),n(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=a=>{t.abort(a)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new Oy(function(o){t=o}),cancel:t}}};function cC(e){return function(n){return e.apply(null,n)}}function uC(e){return Oe.isObject(e)&&e.isAxiosError===!0}const Vh={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Vh).forEach(([e,t])=>{Vh[t]=e});function By(e){const t=new sl(e),n=py(sl.prototype.request,t);return Oe.extend(n,sl.prototype,t,{allOwnKeys:!0}),Oe.extend(n,t,null,{allOwnKeys:!0}),n.create=function(o){return By(rl(e,o))},n}const bn=By(fc);bn.Axios=sl;bn.CanceledError=rr;bn.CancelToken=rC;bn.isCancel=Ty;bn.VERSION=Ry;bn.toFormData=Xu;bn.AxiosError=It;bn.Cancel=bn.CanceledError;bn.all=function(t){return Promise.all(t)};bn.spread=cC;bn.isAxiosError=uC;bn.mergeConfig=rl;bn.AxiosHeaders=Mo;bn.formToJSON=e=>$y(Oe.isHTMLForm(e)?new FormData(e):e);bn.getAdapter=Dy.getAdapter;bn.HttpStatusCode=Vh;bn.default=bn;const{Axios:UY,AxiosError:zY,CanceledError:HY,isCancel:VY,CancelToken:GY,VERSION:qY,all:jY,Cancel:WY,isAxiosError:ZY,spread:KY,toFormData:YY,AxiosHeaders:JY,HttpStatusCode:XY,formToJSON:QY,getAdapter:eJ,mergeConfig:tJ}=bn,ai="https://sterobson-volunteercheckin-testing.azurewebsites.net/api",dC="VolunteerCheckinOffline",hC=1;let ba=null;async function As(){return ba||new Promise((e,t)=>{const n=indexedDB.open(dC,hC);n.onerror=()=>{console.error("Failed to open IndexedDB:",n.error),t(n.error)},n.onsuccess=()=>{ba=n.result,e(ba)},n.onupgradeneeded=a=>{const o=a.target.result;o.objectStoreNames.contains("eventData")||o.createObjectStore("eventData",{keyPath:"eventId"}),o.objectStoreNames.contains("pendingActions")||o.createObjectStore("pendingActions",{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),o.objectStoreNames.contains("syncMeta")||o.createObjectStore("syncMeta",{keyPath:"key"})}})}async function sc(e,t){return await As(),new Promise((n,a)=>{const o=ba.transaction(["eventData","syncMeta"],"readwrite"),i=o.objectStore("eventData"),l=o.objectStore("syncMeta"),c={eventId:e,...t,cachedAt:new Date().toISOString()};i.put(c),l.put({key:`lastSync_${e}`,value:new Date().toISOString()}),o.oncomplete=()=>n(),o.onerror=()=>a(o.error)})}async function ui(e){return await As(),new Promise((t,n)=>{const i=ba.transaction(["eventData"],"readonly").objectStore("eventData").get(e);i.onsuccess=()=>t(i.result||null),i.onerror=()=>n(i.error)})}async function Yc(e,t,n){const a=await ui(e);a&&(a[t]=n,a.cachedAt=new Date().toISOString(),await sc(e,a))}async function fC(e){return await As(),new Promise((t,n)=>{const o=ba.transaction(["pendingActions"],"readwrite").objectStore("pendingActions"),i={...e,createdAt:new Date().toISOString(),attempts:0,lastAttempt:null,status:"pending"},l=o.add(i);l.onsuccess=()=>t(l.result),l.onerror=()=>n(l.error)})}async function Ny(){return await As(),new Promise((e,t)=>{const i=ba.transaction(["pendingActions"],"readonly").objectStore("pendingActions").index("createdAt").getAll();i.onsuccess=()=>{const l=i.result.filter(c=>c.status==="pending"||c.status==="retrying");e(l)},i.onerror=()=>t(i.error)})}async function yu(){return(await Ny()).length}async function kv(e,t){return await As(),new Promise((n,a)=>{const o=ba.transaction(["pendingActions"],"readwrite"),i=o.objectStore("pendingActions"),l=i.get(e);l.onsuccess=()=>{const c=l.result;c&&(Object.assign(c,t),i.put(c))},o.oncomplete=()=>n(),o.onerror=()=>a(o.error)})}async function bv(e){return await As(),new Promise((t,n)=>{const i=ba.transaction(["pendingActions"],"readwrite").objectStore("pendingActions").delete(e);i.onsuccess=()=>t(),i.onerror=()=>n(i.error)})}async function pC(e){return await As(),new Promise((t,n)=>{const i=ba.transaction(["syncMeta"],"readonly").objectStore("syncMeta").get(`lastSync_${e}`);i.onsuccess=()=>t(i.result?.value||null),i.onerror=()=>n(i.error)})}const et=bn.create({baseURL:ai,headers:{"Content-Type":"application/json"},timeout:15e3});let Gh=!1,Fy={type:null,eventId:null};function Uo(e,t=null){Fy={type:e,eventId:t}}async function vC(){}function _v(e){const t=[/\/events\/([^/]+)/,/\/assignments\/([^/]+)/,/\/locations\/([^/]+)/,/\/checklist-items\/([^/]+)/,/\/areas\/([^/]+)/,/\/marshals\/([^/]+)/];for(const n of t){const a=e.match(n);if(a)return a[1]}return null}function mC(e){return!!(!e.response&&e.request||e.response&&e.response.status>=500||e.code==="ECONNABORTED")}function Uy(){const e=window.location.hash||"";if(e.includes("/admin/"))return{type:"admin",eventId:null};const t=e.match(/#\/event\/([^/?]+)/);return t?{type:"marshal",eventId:t[1]}:e.includes("/marshal")?{type:null,eventId:null}:Fy}const gC=["/auth/marshal-login","/auth/request-login","/auth/verify-token","/auth/instant-login"];et.interceptors.request.use(e=>{if(gC.some(i=>e.url?.includes(i)))return e;const n=localStorage.getItem("adminEmail");n&&(e.headers["X-Admin-Email"]=n);const a=Uy();let o=null;if(a.type==="marshal"&&a.eventId){const i=mu(a.eventId);i?.token&&(o=i.token)}return o||(o=localStorage.getItem("sessionToken")),o&&(e.headers.Authorization=`Bearer ${o}`),S_(e),e});let ku=0;const yC=2;function kC(){if(ku++,ku>=yC&&Uy().type!=="marshal"){localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken");const t=window.location.hash||"";!t.includes("login")&&!t.includes("/verify")&&(window.location.href="/VolunteerCheckin/testing/#/?login=true")}}function bC(){ku=0}function Bd(){ku=0}function _C(e){if(!e?.url)return!1;const t=localStorage.getItem("sessionToken"),n=e.headers?.Authorization||e.headers?.authorization;if(n&&t&&n.replace("Bearer ","")!==t||(e.url||"").includes("/auth/marshal-login"))return!0;const o=window.location.hash||"";return!!(o.match(/#\/event\/[^/?]+/)||o==="#/marshal"||o.startsWith("#/marshal?"))}et.interceptors.response.use(e=>{const t=tv(e.config);t&&ev(t),Gh=!1,bC();const n=e.config.url,a=_v(n);return e.config.method,e},async e=>{const t=e.config,n=tv(t);if(n&&ev(n),e.response&&(e.response.status===401||e.response.status===403))return _C(t)||kC(),Promise.reject(e);if(mC(e)&&(Gh=!0,t.method==="get")){const a=_v(t.url);if(a){const o=await ui(a);if(o)return console.log("Returning cached data for:",t.url),Promise.resolve({data:o,status:200,statusText:"OK (cached)",headers:{},config:t,cached:!0})}}return Promise.reject(e)});async function Fo(e,t,n){return await fC({type:e,payload:t,eventId:t.eventId}),await vC(),{data:n,status:200,statusText:"OK (queued)",queued:!0}}function Jn(){return Gh||!navigator.onLine}const wC={check:()=>et.head("/health")},qh=()=>"https://sterobson.github.io/VolunteerCheckin/testing".replace(/\/?#?\/?$/,""),Za={requestLogin:e=>et.post("/auth/request-login",{email:e,frontendUrl:qh()}),verifyToken:e=>et.post("/auth/verify-token",{token:e}),instantLogin:e=>et.post("/auth/instant-login",{email:e}),createAdmin:e=>et.post("/auth/create-admin",{email:e}),marshalLogin:(e,t)=>et.post("/auth/marshal-login",{eventId:e,magicCode:t}),getMe:e=>et.get("/auth/me",{params:{eventId:e}}),logout:()=>et.post("/auth/logout")},Rc={getProfile:()=>et.get("/auth/profile"),updateProfile:e=>et.put("/auth/profile",e),getPerson:(e,t)=>et.get(`/people/${e}`,{params:{eventId:t}}),updatePerson:(e,t,n)=>et.put(`/people/${e}`,n,{params:{eventId:t}})},si={create:e=>et.post("/events",e),getAll:()=>et.get("/events"),getById:e=>et.get(`/events/${e}`),update:(e,t)=>et.put(`/events/${e}`,t),delete:e=>et.delete(`/events/${e}`),uploadGpx:(e,t)=>{const n=new FormData;return n.append("gpx",t),et.post(`/events/${e}/upload-gpx`,n,{headers:{"Content-Type":"multipart/form-data"}})}},Xn={create:e=>et.post("/locations",e),getById:(e,t)=>et.get(`/locations/${e}/${t}`),getByEvent:(e,t={})=>et.get(`/events/${e}/locations`,t),update:(e,t,n)=>et.put(`/locations/${e}/${t}`,n),delete:(e,t)=>et.delete(`/locations/${e}/${t}`),importCsv:(e,t,n)=>{const a=new FormData;return a.append("csv",t),et.post(`/locations/import/${e}?deleteExisting=${n}`,a,{headers:{"Content-Type":"multipart/form-data"}})},bulkUpdateTimes:(e,t)=>et.post(`/locations/bulk-update-times/${e}`,{timeDelta:t}),updatePosition:(e,t,n,a={})=>et.post(`/locations/${e}/${t}/update-position`,n,a),getDynamicCheckpoints:(e,t={})=>et.get(`/events/${e}/dynamic-checkpoints`,t)},Ir={create:e=>et.post("/assignments",e),getById:(e,t)=>et.get(`/assignments/${e}/${t}`),getByEvent:e=>et.get(`/assignments/event/${e}`),delete:(e,t)=>et.delete(`/assignments/${e}/${t}`),getEventStatus:e=>et.get(`/events/${e}/status`)},di={checkIn:e=>et.post("/checkin",e),toggleCheckIn:(e,t,{latitude:n,longitude:a,action:o}={})=>et.post(`/checkin/${e}/${t}/toggle`,{latitude:n??null,longitude:a??null,action:o??null}),adminCheckIn:(e,t)=>et.post(`/checkin/admin/${e}/${t}`)},Nd={getAdmins:e=>et.get(`/events/${e}/admins`),addAdmin:(e,t)=>et.post(`/events/${e}/admins`,{userEmail:t}),removeAdmin:(e,t)=>et.delete(`/events/${e}/admins/${t}`)},ka={create:e=>et.post("/marshals",e),getByEvent:e=>et.get(`/events/${e}/marshals`),getById:(e,t)=>et.get(`/marshals/${e}/${t}`),update:(e,t,n)=>et.put(`/marshals/${e}/${t}`,n),delete:(e,t)=>et.delete(`/marshals/${e}/${t}`),getMagicLink:(e,t)=>et.get(`/marshals/${e}/${t}/magic-link`,{params:{frontendUrl:qh()}}),sendMagicLink:(e,t)=>et.post(`/marshals/${e}/${t}/send-magic-link`,{frontendUrl:qh()}),importCsv:(e,t)=>{const n=new FormData;return n.append("csv",t),et.post(`/marshals/import/${e}`,n,{headers:{"Content-Type":"multipart/form-data"}})}},bs={create:e=>et.post("/areas",e),getByEvent:e=>et.get(`/events/${e}/areas`),getById:(e,t)=>et.get(`/areas/${e}/${t}`),update:(e,t,n)=>et.put(`/areas/${e}/${t}`,n),delete:(e,t)=>et.delete(`/areas/${e}/${t}`),recalculate:e=>et.post(`/areas/recalculate/${e}`),getCheckpoints:(e,t)=>et.get(`/areas/${e}/${t}/locations`),getAreaLeadDashboard:e=>et.get(`/events/${e}/area-lead-dashboard`)},Nt={create:(e,t)=>et.post(`/events/${e}/checklist-items`,t),getByEvent:e=>et.get(`/events/${e}/checklist-items`),getById:(e,t)=>et.get(`/checklist-items/${e}/${t}`),update:(e,t,n)=>et.put(`/checklist-items/${e}/${t}`,n),delete:(e,t)=>et.delete(`/checklist-items/${e}/${t}`),getReport:e=>et.get(`/events/${e}/checklist-report`),getDetailedReport:e=>et.get(`/events/${e}/checklist-report/detailed`),getMarshalChecklist:(e,t)=>et.get(`/events/${e}/marshals/${t}/checklist`),getCheckpointChecklist:(e,t)=>et.get(`/events/${e}/locations/${t}/checklist`),getAreaChecklist:(e,t)=>et.get(`/events/${e}/areas/${t}/checklist`),complete:(e,t,n)=>et.post(`/checklist-items/${e}/${t}/complete`,n),uncomplete:(e,t,n)=>et.post(`/checklist-items/${e}/${t}/uncomplete`,n),reorder:(e,t)=>et.post(`/events/${e}/checklist-items/reorder`,{items:t})},ma={create:(e,t)=>et.post(`/events/${e}/notes`,t),getByEvent:e=>et.get(`/events/${e}/notes`),getById:(e,t)=>et.get(`/events/${e}/notes/${t}`),update:(e,t,n)=>et.put(`/events/${e}/notes/${t}`,n),delete:(e,t)=>et.delete(`/events/${e}/notes/${t}`),getMarshalNotes:(e,t)=>et.get(`/events/${e}/marshals/${t}/notes`),getMyNotes:e=>et.get(`/events/${e}/my-notes`),reorder:(e,t)=>et.post(`/events/${e}/notes/reorder`,{items:t})},ps={create:(e,t)=>et.post(`/events/${e}/contacts`,t),getByEvent:e=>et.get(`/events/${e}/contacts`),getById:(e,t)=>et.get(`/events/${e}/contacts/${t}`),update:(e,t,n)=>et.put(`/events/${e}/contacts/${t}`,n),delete:(e,t)=>et.delete(`/events/${e}/contacts/${t}`),getRoles:e=>et.get(`/events/${e}/contact-roles`),getMarshalContacts:(e,t)=>et.get(`/events/${e}/marshals/${t}/contacts`),getMyContacts:e=>et.get(`/events/${e}/my-contacts`),reorder:(e,t)=>et.post(`/events/${e}/contacts/reorder`,{items:t})},qi={getAll:e=>et.get(`/events/${e}/role-definitions`),create:(e,t)=>et.post(`/events/${e}/role-definitions`,t),update:(e,t,n)=>et.put(`/events/${e}/role-definitions/${t}`,n),delete:(e,t)=>et.delete(`/events/${e}/role-definitions/${t}`),getPeople:(e,t)=>et.get(`/events/${e}/role-definitions/${t}/people`),updatePeople:(e,t,n)=>et.put(`/events/${e}/role-definitions/${t}/people`,n),reorder:(e,t)=>et.post(`/events/${e}/role-definitions/reorder`,{items:t})},Wa={create:(e,t)=>et.post(`/events/${e}/incidents`,t),getAll:(e,t={})=>et.get(`/events/${e}/incidents`,{params:t}),getForArea:(e,t)=>et.get(`/events/${e}/areas/${t}/incidents`),get:(e,t)=>et.get(`/events/${e}/incidents/${t}`),updateStatus:(e,t,n)=>et.patch(`/events/${e}/incidents/${t}`,n),addNote:(e,t,n)=>et.post(`/events/${e}/incidents/${t}/notes`,{note:n})},CC={class:"hero-animation-container"},LC={__name:"HeroMapAnimation",props:{animate:{type:Boolean,default:!0}},setup(e){const t=e,n=P(!1);return rn(()=>{t.animate?requestAnimationFrame(()=>{n.value=!0}):n.value=!0}),(a,o)=>(p(),g("div",CC,[(p(),g("svg",{viewBox:"0 0 400 350",class:le(["hero-map-svg",{animate:n.value&&e.animate,"no-animate":n.value&&!e.animate}])},[...o[0]||(o[0]=[fi(`<defs data-v-cec8ae43><clipPath id="mapClip" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" data-v-cec8ae43></polygon></clipPath></defs><g class="map-group" data-v-cec8ae43><polygon points="80,0 320,0 420,350 -20,350" fill="#c8e6c0" stroke="#8fbc8f" stroke-width="3" data-v-cec8ae43></polygon><g clip-path="url(#mapClip)" class="contours" data-v-cec8ae43><ellipse cx="300" cy="60" rx="35" ry="12" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="25" ry="8" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="300" cy="60" rx="15" ry="5" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="80" ry="40" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="55" ry="28" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="80" cy="220" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="50" ry="25" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse><ellipse cx="320" cy="180" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-cec8ae43></ellipse></g><g clip-path="url(#mapClip)" class="roads" data-v-cec8ae43><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#1a5276" stroke-width="18" stroke-linecap="round" data-v-cec8ae43></path><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#5dade2" stroke-width="12" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#cc8800" stroke-width="10" stroke-linecap="round" data-v-cec8ae43></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#ffcc00" stroke-width="6" stroke-linecap="round" data-v-cec8ae43></path></g><path id="routePath" d="M 60,360
             L 200,250
             L 150,150
             L 280,100
             L 450,60" fill="none" stroke="none" data-v-cec8ae43></path><g class="trail-segments" data-v-cec8ae43><path class="trail-seg trail-seg-1" d="M 60,360 L 200,250" fill="none" stroke="#dc3545" stroke-width="12" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-2" d="M 200,250 L 150,150" fill="none" stroke="#dc3545" stroke-width="9" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-3" d="M 150,150 L 280,100" fill="none" stroke="#dc3545" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path><path class="trail-seg trail-seg-4" d="M 280,100 L 450,60" fill="none" stroke="#dc3545" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" data-v-cec8ae43></path></g><g class="checkpoint checkpoint-1" transform="translate(200, 250)" data-v-cec8ae43><ellipse cx="0" cy="8" rx="40" ry="12" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="4" rx="30" ry="10" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="25" ry="8" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-2" transform="translate(150, 150)" data-v-cec8ae43><ellipse cx="0" cy="6" rx="18" ry="8" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="3" rx="15" ry="6" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="12" ry="5" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="checkpoint checkpoint-3" transform="translate(280, 100)" data-v-cec8ae43><ellipse cx="0" cy="4" rx="12" ry="5" fill="#4a5aba" opacity="0.4" data-v-cec8ae43></ellipse><ellipse cx="0" cy="2" rx="10" ry="4" fill="#667eea" data-v-cec8ae43></ellipse><ellipse cx="0" cy="0" rx="8" ry="3" fill="#8b9ff0" data-v-cec8ae43></ellipse></g><g class="marshal marshal-1" transform="translate(200, 250)" data-v-cec8ae43><circle cx="0" cy="-28" r="12" fill="#444" data-v-cec8ae43></circle><path d="M 20,0 v-8 a12 12 0 0 0-12-12 h-16 a12 12 0 0 0-12 12 v8" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-2" transform="translate(150, 150)" data-v-cec8ae43><circle cx="0" cy="-18" r="8" fill="#444" data-v-cec8ae43></circle><path d="M 12,0 v-5 a8 8 0 0 0-8-8 h-8 a8 8 0 0 0-8 8 v5" fill="#444" data-v-cec8ae43></path></g><g class="marshal marshal-3" transform="translate(280, 100)" data-v-cec8ae43><circle cx="0" cy="-12" r="6" fill="#444" data-v-cec8ae43></circle><path d="M 9,0 v-4 a6 6 0 0 0-6-6 h-6 a6 6 0 0 0-6 6 v4" fill="#444" data-v-cec8ae43></path></g><g clip-path="url(#mapClip)" class="trees" data-v-cec8ae43><g transform="translate(45, 280)" data-v-cec8ae43><polygon points="0,-20 12,0 -12,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-34 10,-12 -10,-12" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-46 8,-26 -8,-26" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-3" y="0" width="6" height="8" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(75, 255)" data-v-cec8ae43><polygon points="0,-18 10,0 -10,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-30 8,-10 -8,-10" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-40 6,-22 -6,-22" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="6" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(350, 230)" data-v-cec8ae43><polygon points="0,-20 11,0 -11,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-33 9,-11 -9,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-44 7,-24 -7,-24" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-2.5" y="0" width="5" height="7" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(60, 140)" data-v-cec8ae43><polygon points="0,-12 7,0 -7,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-20 5.5,-8 -5.5,-8" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-27 4,-15 -4,-15" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="4" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 70)" data-v-cec8ae43><polygon points="0,-9 5,0 -5,0" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-15 4,-6 -4,-6" fill="#2d5a2d" data-v-cec8ae43></polygon><polygon points="0,-20 3,-11 -3,-11" fill="#2d5a2d" data-v-cec8ae43></polygon><rect x="-1" y="0" width="2" height="3" fill="#5d4037" data-v-cec8ae43></rect></g><g transform="translate(320, 140)" data-v-cec8ae43><polygon points="0,-14 8,0 -8,0" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-24 6,-9 -6,-9" fill="#3d6a3d" data-v-cec8ae43></polygon><polygon points="0,-32 5,-18 -5,-18" fill="#3d6a3d" data-v-cec8ae43></polygon><rect x="-1.5" y="0" width="3" height="5" fill="#5d4037" data-v-cec8ae43></rect></g></g></g>`,2)])],2))]))}},SC=Ze(LC,[["__scopeId","data-v-cec8ae43"]]),IC={class:"hero-header"},xC={__name:"HeroHeader",props:{title:{type:String,default:""}},setup(e){const t=P(!1);return rn(()=>{window.__heroAnimationPlayed?t.value=!1:(t.value=!0,window.__heroAnimationPlayed=!0)}),(n,a)=>(p(),g("div",IC,[Ee(SC,{animate:t.value},null,8,["animate"]),e.title?(p(),g("div",{key:0,class:le(["hero-overlay",{"no-animate":!t.value}])},[r("h1",null,b(e.title),1)],2)):D("",!0)]))}},zy=Ze(xC,[["__scopeId","data-v-c824ab01"]]),pc=Lf("auth",()=>{const e=P(localStorage.getItem("adminEmail")||null),t=P(!!e.value),n=P(!1);return{adminEmail:e,isAuthenticated:t,loginPending:n,requestLogin:async c=>{const d=await Za.requestLogin(c);return d.data.success&&(n.value=!0),d.data},verifyToken:async c=>{const d=await Za.verifyToken(c);return d.data.success&&(e.value=d.data.person?.email,t.value=!0,n.value=!1,localStorage.setItem("adminEmail",d.data.person?.email),localStorage.setItem("sessionToken",d.data.sessionToken),Uo("admin")),d.data},instantLogin:async c=>{const d=await Za.instantLogin(c);return d.data.success&&(e.value=d.data.email,t.value=!0,localStorage.setItem("adminEmail",d.data.email),d.data.sessionToken&&localStorage.setItem("sessionToken",d.data.sessionToken),Uo("admin")),d.data},logout:async()=>{try{await Za.logout()}catch{}e.value=null,t.value=!1,n.value=!1,localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken"),Uo(null)}}}),$C={class:"modal-card"},TC={key:0,class:"email-sent"},MC={key:1},AC={class:"form-group"},EC=["disabled"],PC={key:0,class:"error"},DC={__name:"LoginModal",props:{show:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3}},emits:["close","success"],setup(e,{emit:t}){const n=e,a=t,o=pc(),i=P(""),l=P(!1),c=P(null),d=P(!1);async function h(){l.value=!0,c.value=null;try{const y=await o.requestLogin(i.value);y.success?(d.value=!0,a("success",i.value)):c.value=y.message||"Failed to send login link. Please try again."}catch{c.value="Failed to send login link. Please try again."}finally{l.value=!1}}function f(){i.value="",d.value=!1,c.value=null}function m(){a("close")}return Ye(()=>n.show,y=>{y||setTimeout(()=>{f()},200)}),(y,k)=>(p(),ze(Xr,{to:"body"},[Ee(Ca,{name:"modal"},{default:Ue(()=>[e.show?(p(),g("div",{key:0,class:"modal-overlay",style:nt({zIndex:e.zIndex}),onClick:ct(m,["self"])},[r("div",$C,[r("button",{class:"modal-close",onClick:m},""),d.value?(p(),g("div",TC,[k[2]||(k[2]=r("div",{class:"check-icon"},"",-1)),k[3]||(k[3]=r("h3",null,"Check your email!",-1)),r("p",null,[k[1]||(k[1]=Je("We've sent a login link to ",-1)),r("strong",null,b(i.value),1)]),k[4]||(k[4]=r("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),r("button",{onClick:f,class:"btn btn-secondary"}," Use a different email ")])):(p(),g("div",MC,[k[5]||(k[5]=r("h2",null,"Join us or login",-1)),k[6]||(k[6]=r("p",{class:"instruction"},"Enter your email to receive a login link",-1)),r("form",{onSubmit:ct(h,["prevent"])},[r("div",AC,[Ge(r("input",{"onUpdate:modelValue":k[0]||(k[0]=S=>i.value=S),type:"email",placeholder:"you@example.com",required:"",class:"form-input"},null,512),[[st,i.value]])]),r("button",{type:"submit",class:"btn btn-primary btn-full",disabled:l.value},b(l.value?"Sending...":"Send login link"),9,EC)],32),c.value?(p(),g("div",PC,b(c.value),1)):D("",!0)]))])],4)):D("",!0)]),_:1})]))}},Hy=Ze(DC,[["__scopeId","data-v-7c646305"]]),RC={class:"home"},OC={class:"hero-section"},BC={class:"content-section"},NC={class:"container"},FC={class:"carousel"},UC={class:"carousel-indicators"},zC=["onClick"],HC={__name:"Home",setup(e){const t=Zu(),n=sr();function a(){const y=!!localStorage.getItem("adminEmail"),k=hy();return y||k}function o(){a()?n.push("/sessions"):f.value=!0}const i=P(0);let l=null;function c(y){i.value=y,h()}function d(){i.value=(i.value+1)%2}function h(){l&&clearInterval(l),l=setInterval(d,1e4)}const f=P(!1);function m(){f.value=!1,t.query.login&&n.replace({query:{}})}return rn(()=>{h(),t.query.login&&(a()?n.replace("/sessions"):f.value=!0)}),An(()=>{l&&clearInterval(l)}),(y,k)=>(p(),g("div",RC,[r("section",OC,[Ee(zy,{title:"OnTheDay"}),k[0]||(k[0]=r("p",{class:"subtitle"},"Manage your event's marshals and volunteers with ease",-1)),r("button",{class:"btn btn-primary",onClick:o}," Join us or login ")]),r("section",BC,[r("div",NC,[k[2]||(k[2]=fi('<div class="features-grid" data-v-aaecbd22><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For admins</h3><ul data-v-aaecbd22><li data-v-aaecbd22>Create and manage events</li><li data-v-aaecbd22>Define marshal locations</li><li data-v-aaecbd22>Real-time check-in monitoring</li><li data-v-aaecbd22>Map view of everything in your event</li><li data-v-aaecbd22>Manage incidents</li></ul></div><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For marshals</h3><ul data-v-aaecbd22><li data-v-aaecbd22>View the entire route</li><li data-v-aaecbd22>View your assigned location</li><li data-v-aaecbd22>Check in with GPS verification</li><li data-v-aaecbd22>Access emergency contact info</li><li data-v-aaecbd22>Record incidents</li></ul></div></div>',1)),r("div",FC,[r("div",{class:"carousel-track",style:nt({transform:`translateX(-${i.value*100}%)`})},[...k[1]||(k[1]=[fi('<div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For admins</h3><ul data-v-aaecbd22><li data-v-aaecbd22>Create and manage events</li><li data-v-aaecbd22>Define marshal locations</li><li data-v-aaecbd22>Real-time check-in monitoring</li><li data-v-aaecbd22>Map view of everything in your event</li><li data-v-aaecbd22>Manage incidents</li></ul></div><div class="feature-card" data-v-aaecbd22><h3 data-v-aaecbd22>For marshals</h3><ul data-v-aaecbd22><li data-v-aaecbd22>View the entire route</li><li data-v-aaecbd22>View your assigned location</li><li data-v-aaecbd22>Check in with GPS verification</li><li data-v-aaecbd22>Access emergency contact info</li><li data-v-aaecbd22>Record incidents</li></ul></div>',2)])],4),r("div",UC,[(p(),g(xe,null,qe(2,(S,x)=>r("button",{key:x,class:le(["indicator",{active:i.value===x}]),onClick:E=>c(x)},null,10,zC)),64))])])])]),Ee(Hy,{show:f.value,onClose:m},null,8,["show"])]))}},VC=Ze(HC,[["__scopeId","data-v-aaecbd22"]]),GC={class:"admin-login"},qC={class:"login-card"},jC={key:0,class:"email-sent"},WC={class:"form-group"},ZC=["disabled"],KC={key:0,class:"error"},YC={__name:"AdminLogin",setup(e){const t=pc(),n=P(""),a=P(!1),o=P(null),i=P(!1),l=async()=>{a.value=!0,o.value=null;try{const d=await t.requestLogin(n.value);d.success?i.value=!0:o.value=d.message||"Failed to send login link. Please try again."}catch{o.value="Failed to send login link. Please try again."}finally{a.value=!1}},c=()=>{n.value="",i.value=!1,o.value=null};return(d,h)=>{const f=gf("router-link");return p(),g("div",GC,[r("div",qC,[h[7]||(h[7]=r("h2",null,"Admin login",-1)),i.value?(p(),g("div",jC,[h[2]||(h[2]=r("div",{class:"check-icon"},"",-1)),h[3]||(h[3]=r("h3",null,"Check your email!",-1)),r("p",null,[h[1]||(h[1]=Je("We've sent a login link to ",-1)),r("strong",null,b(n.value),1)]),h[4]||(h[4]=r("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),r("button",{onClick:c,class:"btn btn-secondary"}," Use a different email ")])):(p(),g(xe,{key:1},[h[5]||(h[5]=r("p",{class:"instruction"},"Enter your email to receive a login link",-1)),r("form",{onSubmit:ct(l,["prevent"])},[r("div",WC,[Ge(r("input",{"onUpdate:modelValue":h[0]||(h[0]=m=>n.value=m),type:"email",placeholder:"admin@example.com",required:"",class:"form-input"},null,512),[[st,n.value]])]),r("button",{type:"submit",class:"btn btn-primary",disabled:a.value},b(a.value?"Sending...":"Send login link"),9,ZC)],32),o.value?(p(),g("div",KC,b(o.value),1)):D("",!0)],64)),Ee(f,{to:"/",class:"back-link"},{default:Ue(()=>[...h[6]||(h[6]=[Je(" Back to Home",-1)])]),_:1})])])}}},JC=Ze(YC,[["__scopeId","data-v-5d0a88c2"]]),XC={class:"admin-verify"},QC={class:"verify-card"},e2={key:0,class:"status"},t2={key:1,class:"status error"},n2={key:2,class:"status success"},o2={__name:"AdminVerify",setup(e){const t=sr(),n=Zu(),a=pc(),o=P(!0),i=P(null);return rn(async()=>{const l=n.query.token;if(!l){i.value="No login token provided. Please request a new login link.",o.value=!1;return}try{const c=await a.verifyToken(l);c.success?setTimeout(()=>{t.push({name:"Sessions"})},1e3):i.value=c.message||"Invalid or expired login link. Please request a new one."}catch(c){console.error("Verification error:",c),i.value="Failed to verify login. Please try again."}finally{o.value=!1}}),(l,c)=>{const d=gf("router-link");return p(),g("div",XC,[r("div",QC,[o.value?(p(),g("div",e2,[...c[0]||(c[0]=[r("div",{class:"spinner"},null,-1),r("h2",null,"Verifying your login...",-1),r("p",null,"Please wait while we confirm your identity.",-1)])])):i.value?(p(),g("div",t2,[c[2]||(c[2]=r("h2",null,"Login failed",-1)),r("p",null,b(i.value),1),Ee(d,{to:{name:"Home",query:{login:"true"}},class:"btn btn-primary"},{default:Ue(()=>[...c[1]||(c[1]=[Je(" Try again ",-1)])]),_:1})])):(p(),g("div",n2,[...c[3]||(c[3]=[r("h2",null,"Login successful!",-1),r("p",null,"Redirecting to your sessions...",-1)])]))])])}}},a2=Ze(o2,[["__scopeId","data-v-b2435a84"]]),Vy=Lf("events",()=>{const e=P([]),t=P(null),n=P([]),a=P([]),o=P(null),i=P(!1),l=P(null),c=async()=>{i.value=!0,l.value=null;try{const B=await si.getAll();e.value=B.data}catch(B){throw l.value=B.message,B}finally{i.value=!1}},d=async B=>{i.value=!0,l.value=null;try{const M=await si.getById(B);t.value=M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}},h=async B=>{i.value=!0,l.value=null;try{const M=await si.create(B);return e.value.push(M.data),M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}},f=async(B,M)=>{i.value=!0,l.value=null;try{const R=await si.update(B,M),A=e.value.findIndex(G=>G.id===B);return A!==-1&&(e.value[A]=R.data),t.value?.id===B&&(t.value=R.data),R.data}catch(R){throw l.value=R.message,R}finally{i.value=!1}},m=async B=>{i.value=!0,l.value=null;try{await si.delete(B),e.value=e.value.filter(M=>M.id!==B)}catch(M){throw l.value=M.message,M}finally{i.value=!1}},y=async B=>{i.value=!0,l.value=null;try{const M=await Xn.getByEvent(B);n.value=M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}};return{events:e,currentEvent:t,locations:n,assignments:a,eventStatus:o,loading:i,error:l,fetchEvents:c,fetchEvent:d,createEvent:h,updateEvent:f,deleteEvent:m,fetchLocations:y,createLocation:async B=>{i.value=!0,l.value=null;try{const M=await Xn.create(B);return n.value.push(M.data),M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}},updateLocation:async(B,M,R)=>{i.value=!0,l.value=null;try{const A=await Xn.update(B,M,R),G=n.value.findIndex(F=>F.id===M);return G!==-1&&(n.value[G]=A.data),A.data}catch(A){throw l.value=A.message,A}finally{i.value=!1}},deleteLocation:async(B,M)=>{i.value=!0,l.value=null;try{await Xn.delete(B,M),n.value=n.value.filter(R=>R.id!==M)}catch(R){throw l.value=R.message,R}finally{i.value=!1}},bulkUpdateLocationTimes:async(B,M)=>{i.value=!0,l.value=null;try{const R=await Xn.bulkUpdateTimes(B,M);return await y(B),R.data}catch(R){throw l.value=R.message,R}finally{i.value=!1}},fetchAssignments:async B=>{i.value=!0,l.value=null;try{const M=await Ir.getByEvent(B);a.value=M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}},createAssignment:async B=>{i.value=!0,l.value=null;try{const M=await Ir.create(B);return a.value.push(M.data),M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}},deleteAssignment:async(B,M)=>{i.value=!0,l.value=null;try{await Ir.delete(B,M),a.value=a.value.filter(R=>R.id!==M)}catch(R){throw l.value=R.message,R}finally{i.value=!1}},fetchEventStatus:async B=>{i.value=!0,l.value=null;try{const M=await Ir.getEventStatus(B);return o.value=M.data,M.data}catch(M){throw l.value=M.message,M}finally{i.value=!1}},updateAssignmentCheckIn:B=>{const M=a.value.findIndex(R=>R.id===B.id);M!==-1&&(a.value[M]=B),o.value&&o.value.locations.forEach(R=>{const A=R.assignments.findIndex(G=>G.id===B.id);A!==-1&&(R.assignments[A]=B,R.checkedInCount=R.assignments.filter(G=>G.isCheckedIn).length)})}}});function Gy(e="details",t=[]){const n=P(e),a=m=>{n.value=m},o=()=>{n.value=e},i=m=>n.value===m,l=z(()=>t.length===0?-1:t.indexOf(n.value)),c=(m=!1)=>{if(t.length===0)return;const y=l.value;if(y===-1)return;const k=y+1;k<t.length?n.value=t[k]:m&&(n.value=t[0])},d=(m=!1)=>{if(t.length===0)return;const y=l.value;if(y===-1)return;const k=y-1;k>=0?n.value=t[k]:m&&(n.value=t[t.length-1])},h=z(()=>{if(t.length===0)return!1;const m=l.value;return m!==-1&&m<t.length-1}),f=z(()=>t.length===0?!1:l.value>0);return{activeTab:n,activeTabIndex:l,hasNextTab:h,hasPreviousTab:f,switchTab:a,resetTab:o,isActiveTab:i,nextTab:c,previousTab:d}}function s2(){const e=P(!1),t=P(""),n=P(""),a=P(null),o=P(!1),i=P("OK");return{showConfirmModal:e,confirmModalTitle:t,confirmModalMessage:n,confirmModalIsDanger:o,confirmModalConfirmText:i,showConfirm:(f,m,y,k={})=>{t.value=f,n.value=m,a.value=y,o.value=k.isDanger||!1,i.value=k.confirmText||"OK",e.value=!0},handleConfirmModalConfirm:()=>{e.value=!1,a.value&&(a.value(),a.value=null)},handleConfirmModalCancel:()=>{e.value=!1,a.value=null},closeConfirmModal:()=>{e.value=!1,a.value=null}}}const zl=P({people:"Marshals",checkpoint:"Checkpoints",area:"Areas",checklist:"Checklists",course:"Course"}),ws={people:{People:{singular:"Person",plural:"People"},Marshals:{singular:"Marshal",plural:"Marshals"},Volunteers:{singular:"Volunteer",plural:"Volunteers"},Helpers:{singular:"Helper",plural:"Helpers"},Staff:{singular:"Staff member",plural:"Staff"},Stewards:{singular:"Steward",plural:"Stewards"},"Team members":{singular:"Team member",plural:"Team members"},Drivers:{singular:"Driver",plural:"Drivers"},Pilots:{singular:"Pilot",plural:"Pilots"}},checkpoint:{Checkpoints:{singular:"Checkpoint",plural:"Checkpoints"},Stations:{singular:"Station",plural:"Stations"},Locations:{singular:"Location",plural:"Locations"},"Feed stations":{singular:"Feed station",plural:"Feed stations"},"Aid stations":{singular:"Aid station",plural:"Aid stations"},"Water stations":{singular:"Water station",plural:"Water stations"},"Person points":{singular:null,plural:null,dynamic:!0}},area:{Areas:{singular:"Area",plural:"Areas"},Regions:{singular:"Region",plural:"Regions"},Zones:{singular:"Zone",plural:"Zones"}},checklist:{Checklists:{singular:"Checklist",plural:"Checklists"},Tasks:{singular:"Task",plural:"Tasks"},Jobs:{singular:"Job",plural:"Jobs"}},course:{Course:{singular:"Course",plural:"Courses"},Route:{singular:"Route",plural:"Routes"},Track:{singular:"Track",plural:"Tracks"},Trail:{singular:"Trail",plural:"Trails"},Path:{singular:"Path",plural:"Paths"}}},_s={people:["Drivers","Helpers","Marshals","People","Pilots","Staff","Stewards","Team members","Volunteers"],checkpoint:["Aid stations","Checkpoints","Feed stations","Locations","Person points","Stations","Water stations"],area:["Areas","Regions","Zones"],checklist:["Checklists","Jobs","Tasks"],course:["Course","Path","Route","Track","Trail"]};function Qi(e,t,n="Marshals"){if(!t)return"";const a=ws[e]?.[t];return e==="checkpoint"&&t==="Person points"?`${ws.people[n]?.singular||"Person"} point`:a?.singular?a.singular:t.endsWith("s")&&!t.endsWith("ss")?t.slice(0,-1):t}function qy(e,t,n="Marshals"){if(!t)return"";const a=ws[e]?.[t];return t==="Person points"?`${ws.people[n]?.singular||"Person"} points`:a?.plural?a.plural:t}function jh(e,t){return e==="Person points"?`${ws.people[t]?.singular||"Person"} points`:e}function Wh(e){e&&(zl.value={people:e.peopleTerm||"Marshals",checkpoint:e.checkpointTerm||"Checkpoints",area:e.areaTerm||"Areas",checklist:e.checklistTerm||"Checklists",course:e.courseTerm||"Course"})}const fa=e=>e.toLowerCase(),pa=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();function ht(){const e=f=>{const m=zl.value[f],y=ws[f]?.[m];if(f==="checkpoint"&&m==="Person points"){const k=zl.value.people;return`${ws.people[k]?.singular||"Person"} point`}return y?.singular||m},t=f=>{const m=zl.value[f],y=ws[f]?.[m];if(f==="checkpoint"&&m==="Person points"){const k=zl.value.people;return`${ws.people[k]?.singular||"Person"} points`}return y?.plural||m},n=z(()=>({person:e("people"),checkpoint:e("checkpoint"),area:e("area"),checklist:e("checklist"),course:e("course"),people:t("people"),checkpoints:t("checkpoint"),areas:t("area"),checklists:t("checklist"),courses:t("course")})),a=z(()=>({person:fa(e("people")),checkpoint:fa(e("checkpoint")),area:fa(e("area")),checklist:fa(e("checklist")),course:fa(e("course")),people:fa(t("people")),checkpoints:fa(t("checkpoint")),areas:fa(t("area")),checklists:fa(t("checklist")),courses:fa(t("course"))})),o=z(()=>({person:pa(e("people")),checkpoint:pa(e("checkpoint")),area:pa(e("area")),checklist:pa(e("checklist")),course:pa(e("course")),people:pa(t("people")),checkpoints:pa(t("checkpoint")),areas:pa(t("area")),checklists:pa(t("checklist")),courses:pa(t("course"))})),i=z(()=>({course:n.value.course,checkpoints:n.value.checkpoints,areas:n.value.areas,marshals:n.value.people,checklists:n.value.checklists,notes:"Notes",details:"Event details"}));return{terms:n,termsLower:a,termsSentence:o,tabLabels:i,singular:e,plural:t,formatCount:(f,m)=>m===1?`1 ${e(f)}`:`${m} ${t(f)}`,lower:(f,m=!0)=>fa(m?t(f):e(f)),title:(f,m=!0)=>m?t(f):e(f),sentence:(f,m=!0)=>pa(m?t(f):e(f)),terminology:zl}}function i2(){const e=P(!1),t=P(null),n=P({}),a=P(null),o=P(null),i=P([]),l=P(null),c=P(null),d=P(!1),h=P(!1),f=P(1),m=z(()=>t.value==="place-checkpoint"||t.value==="move-checkpoint"?a.value!==null:t.value==="draw-area"?o.value&&o.value.length>=3:t.value==="add-multiple"),y=K=>{if(K){const J=K.getMapCenter?.(),ue=K.getMapZoom?.();J&&ue!==null&&(l.value=J,c.value=ue)}},k=(K={})=>{a.value=null,e.value=!0,t.value="place-checkpoint",n.value={title:K.title||"Select checkpoint location",description:K.description||"Click on the map to set the location. Click again to reposition."}},S=(K,J="checkpoint")=>{a.value=null,e.value=!0,t.value="move-checkpoint",n.value={title:`Move ${J}: ${K}`,description:"Click on the map to set the new location"}},x=(K={})=>{e.value=!0,t.value="draw-area",d.value=!0,n.value={title:K.title||"Draw area boundary",description:K.description||"Click to add points. Click Done when finished to complete the area."}},E=(K=1)=>{f.value=K,i.value=[],e.value=!0,t.value="add-multiple",h.value=!0,n.value={title:"Add multiple checkpoints",description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},$=K=>{t.value==="place-checkpoint"||t.value==="move-checkpoint"?a.value=K:t.value==="add-multiple"&&w(K)},w=K=>{i.value.push({id:`temp-${f.value}`,name:`Checkpoint ${f.value}`,description:"",latitude:K.lat,longitude:K.lng,requiredMarshals:1,what3Words:"",assignments:[],isTemporary:!0}),f.value++,n.value={...n.value,description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},_=K=>{o.value=K},I=()=>o.value&&o.value.length>=3?o.value.map(K=>({lat:K.lat,lng:K.lng})):null,T=()=>{e.value=!1,t.value=null,n.value={},a.value=null,l.value=null,c.value=null,o.value=null,d.value&&(d.value=!1)};return{isFullscreenMapActive:e,fullscreenMode:t,fullscreenContext:n,tempLocationCoords:a,currentDrawingPolygon:o,tempCheckpoints:i,savedMapCenter:l,savedMapZoom:c,isDrawingAreaBoundary:d,isAddingMultipleCheckpoints:h,multiCheckpointCounter:f,canCompleteFullscreen:m,saveMapState:y,enterPlaceCheckpointMode:k,enterMoveCheckpointMode:S,enterDrawAreaMode:x,enterAddMultipleMode:E,handleFullscreenMapClick:$,handlePolygonDrawing:_,getCompletedPolygon:I,exitFullscreen:T,cancelFullscreen:()=>{t.value==="add-multiple"?(i.value=[],h.value=!1):t.value==="draw-area"&&(d.value=!1,o.value=null),T()},getTempCheckpoints:()=>[...i.value],clearTempCheckpoints:()=>{i.value=[],h.value=!1},getPlacedCoords:()=>a.value,createDisplayCheckpoints:(K,J,ue)=>z(()=>{const Z=[...K.value];return t.value==="place-checkpoint"&&a.value&&Z.push({id:"temp-single",name:J.value?.name||"New Checkpoint",latitude:a.value.lat,longitude:a.value.lng,requiredMarshals:J.value?.requiredMarshals||1,assignments:[],isTemporary:!0}),t.value==="move-checkpoint"&&a.value&&ue.value&&Z.push({id:"temp-move",name:ue.value.name+" (new position)",latitude:a.value.lat,longitude:a.value.lng,requiredMarshals:ue.value.requiredMarshals,assignments:[],isTemporary:!0}),t.value==="add-multiple"&&Z.push(...i.value),Z}),createDisplayAreas:(K,J)=>z(()=>{const ue=[...K.value];if(t.value==="draw-area"&&J.value?.polygon?.length>0){const Z=ue.findIndex(se=>se.id===J.value.id);Z>=0?ue[Z]={...J.value}:ue.push({...J.value,id:J.value.id||"temp-area"})}return ue}),calculateStartingNumber:K=>{const J=K.value.map(ue=>{const Z=ue.name.match(/^Checkpoint (\d+)$/);return Z?parseInt(Z[1]):0}).filter(ue=>ue>0);return J.length>0?Math.max(...J)+1:1}}}function l2(e){const t=P([]),n=P(!1);return{eventAdmins:t,showAddAdmin:n,loadEventAdmins:async()=>{try{const d=await Nd.getAdmins(e.value);return t.value=d.data,d.data}catch(d){throw console.error("Failed to load event admins:",d),d}},openAddAdminModal:()=>{n.value=!0},closeAddAdminModal:()=>{n.value=!1},addAdmin:async d=>{await Nd.addAdmin(e.value,d)},removeAdmin:async d=>{await Nd.removeAdmin(e.value,d)}}}function r2(e){const t=P(!1),n=P(!1),a=P(!1),o=P(!1),i=P(!1),l=P(!1),c=P(null),d=P(null),h=P(null),f=P(null);return{showUploadRoute:t,showImportLocations:n,showImportMarshals:a,uploading:o,importing:i,importingMarshals:l,uploadError:c,importError:d,importResult:h,importMarshalsResult:f,openUploadRouteModal:()=>{c.value=null,t.value=!0},closeUploadRouteModal:()=>{t.value=!1,c.value=null},uploadRoute:async T=>{if(!T)return c.value="Please select a GPX file",null;o.value=!0,c.value=null;try{return await si.uploadGpx(e.value,T),!0}catch(B){return console.error("Failed to upload route:",B),c.value=B.response?.data?.message||"Failed to upload route. Please try again.",null}finally{o.value=!1}},openImportLocationsModal:()=>{d.value=null,h.value=null,n.value=!0},closeImportLocationsModal:()=>{n.value=!1,d.value=null,h.value=null},importLocations:async(T,B)=>{if(!T)return d.value="Please select a CSV file",null;i.value=!0,d.value=null,h.value=null;try{const M=await Xn.importCsv(e.value,T,B);return h.value=M.data,M.data}catch(M){return console.error("Failed to import locations:",M),d.value=M.response?.data?.message||"Failed to import locations. Please try again.",null}finally{i.value=!1}},openImportMarshalsModal:()=>{d.value=null,f.value=null,a.value=!0},closeImportMarshalsModal:()=>{a.value=!1,d.value=null,f.value=null},importMarshals:async T=>{if(!T)return d.value="Please select a CSV file",null;l.value=!0,d.value=null,f.value=null;try{const B=await ka.importCsv(e.value,T);return f.value=B.data,B.data}catch(B){return console.error("Failed to import marshals:",B),d.value=B.response?.data?.message||"Failed to import marshals. Please try again.",null}finally{l.value=!1}},formatImportResultMessage:(T,B="location")=>{const M=B==="location"?"location(s)":"marshal(s)";let A=`<p>Created <strong>${T[B==="location"?"locationsCreated":"marshalsCreated"]}</strong> ${M} and <strong>${T.assignmentsCreated}</strong> assignment(s)</p>`;return T.errors&&T.errors.length>0&&(A+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',T.errors.forEach(G=>{A+=`<li>${G}</li>`}),A+="</ul>"),A}}}const jy="admin-theme-preference",ji=P(c2());function c2(){return typeof window>"u"?"system":localStorage.getItem(jy)||"system"}function u2(e){localStorage.setItem(jy,e)}function Wy(){const e=z(()=>ji.value==="system"?"light dark":ji.value),t=(o,i=!0)=>{i&&typeof document<"u"&&(document.documentElement.classList.add("theme-transitioning"),setTimeout(()=>{document.documentElement.classList.remove("theme-transitioning")},1e3)),ji.value=o,u2(o)},n=()=>{const o=["system","light","dark"],l=(o.indexOf(ji.value)+1)%o.length;t(o[l])},a=z(()=>ji.value==="dark"?!0:ji.value==="light"?!1:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1);return{theme:ji,colorScheme:e,isDark:a,setTheme:t,cycleTheme:n}}const Zy=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",ic=e=>{if(!e)return"";const t=new Date(e),n=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0");return`${n}-${a}-${o}T${i}:${l}`},bu=e=>{if(!e||e.trim()==="")return!0;if(!/^[a-z]{1,20}[./][a-z]{1,20}[./][a-z]{1,20}$/.test(e))return!1;const n=e.includes("."),a=e.includes("/");return n!==a},dl=(e,t,n,a)=>{const i=e*Math.PI/180,l=n*Math.PI/180,c=(n-e)*Math.PI/180,d=(a-t)*Math.PI/180,h=Math.sin(c/2)*Math.sin(c/2)+Math.cos(i)*Math.cos(l)*Math.sin(d/2)*Math.sin(d/2);return 6371e3*(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)))},d2=e=>!e&&e!==0?"":e<1e3?`${Math.round(e)} m`:`${(e/1e3).toFixed(2)} km`;function Fd(e,{areas:t=[],locations:n=[],marshals:a=[]}){if(!e||e.length===0)return e;const o=new Set(t.map(h=>h.id)),i=new Set(n.map(h=>h.id)),l=new Set(a.map(h=>h.id)),c=new Set(["ALL_MARSHALS","ALL_AREAS","ALL_CHECKPOINTS","THIS_CHECKPOINT"]);return e.map(h=>{const f=h.itemType,m=h.ids||[];if(!f||m.length===0)return h;const y=m.filter(k=>c.has(k)?!0:f==="Area"?o.has(k):f==="Checkpoint"?i.has(k):f==="Marshal"?l.has(k):!0);return{...h,ids:y}}).filter(h=>h.itemType?h.ids&&h.ids.length>0:!0)}function Ky({scopeConfigurations:e=[],marshalId:t,marshalAssignmentLocationIds:n=[],areaLeadAreaIds:a=[],locationId:o,locationAreaIds:i=[]}){if(!e||e.length===0)return!0;for(const l of e){const c=l.scope||l.Scope,d=l.ids||l.Ids||[];switch(c){case"SpecificPeople":if(d.includes("ALL_MARSHALS")||d.includes(t))return!0;break;case"EveryoneAtCheckpoints":if(d.includes("ALL_CHECKPOINTS")){if(n.length>0)return!0}else if((d.includes("THIS_CHECKPOINT")||d.includes(o))&&n.includes(o)||d.some(f=>n.includes(f)))return!0;break;case"EveryoneInAreas":if(d.includes("ALL_AREAS")){if(n.length>0)return!0}else if(d.some(f=>i.includes(f))&&n.includes(o))return!0;break;case"EveryAreaLead":if(d.includes("ALL_AREAS")){if(a.length>0)return!0}else if(d.some(f=>a.includes(f)))return!0;break}}return!1}function Yy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var xr={exports:{}};var h2=xr.exports,wv;function f2(){return wv||(wv=1,(function(e,t){(function(n,a){a(t)})(h2,(function(n){var a="1.9.4";function o(s){var u,v,C,O;for(v=1,C=arguments.length;v<C;v++){O=arguments[v];for(u in O)s[u]=O[u]}return s}var i=Object.create||(function(){function s(){}return function(u){return s.prototype=u,new s}})();function l(s,u){var v=Array.prototype.slice;if(s.bind)return s.bind.apply(s,v.call(arguments,1));var C=v.call(arguments,2);return function(){return s.apply(u,C.length?C.concat(v.call(arguments)):arguments)}}var c=0;function d(s){return"_leaflet_id"in s||(s._leaflet_id=++c),s._leaflet_id}function h(s,u,v){var C,O,W,ce;return ce=function(){C=!1,O&&(W.apply(v,O),O=!1)},W=function(){C?O=arguments:(s.apply(v,arguments),setTimeout(ce,u),C=!0)},W}function f(s,u,v){var C=u[1],O=u[0],W=C-O;return s===C&&v?s:((s-O)%W+W)%W+O}function m(){return!1}function y(s,u){if(u===!1)return s;var v=Math.pow(10,u===void 0?6:u);return Math.round(s*v)/v}function k(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function S(s){return k(s).split(/\s+/)}function x(s,u){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?i(s.options):{});for(var v in u)s.options[v]=u[v];return s.options}function E(s,u,v){var C=[];for(var O in s)C.push(encodeURIComponent(v?O.toUpperCase():O)+"="+encodeURIComponent(s[O]));return(!u||u.indexOf("?")===-1?"?":"&")+C.join("&")}var $=/\{ *([\w_ -]+) *\}/g;function w(s,u){return s.replace($,function(v,C){var O=u[C];if(O===void 0)throw new Error("No value provided for variable "+v);return typeof O=="function"&&(O=O(u)),O})}var _=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function I(s,u){for(var v=0;v<s.length;v++)if(s[v]===u)return v;return-1}var T="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function B(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var M=0;function R(s){var u=+new Date,v=Math.max(0,16-(u-M));return M=u+v,window.setTimeout(s,v)}var A=window.requestAnimationFrame||B("RequestAnimationFrame")||R,G=window.cancelAnimationFrame||B("CancelAnimationFrame")||B("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function F(s,u,v){if(v&&A===R)s.call(u);else return A.call(window,l(s,u))}function j(s){s&&G.call(window,s)}var K={__proto__:null,extend:o,create:i,bind:l,get lastId(){return c},stamp:d,throttle:h,wrapNum:f,falseFn:m,formatNum:y,trim:k,splitWords:S,setOptions:x,getParamString:E,template:w,isArray:_,indexOf:I,emptyImageUrl:T,requestFn:A,cancelFn:G,requestAnimFrame:F,cancelAnimFrame:j};function J(){}J.extend=function(s){var u=function(){x(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},v=u.__super__=this.prototype,C=i(v);C.constructor=u,u.prototype=C;for(var O in this)Object.prototype.hasOwnProperty.call(this,O)&&O!=="prototype"&&O!=="__super__"&&(u[O]=this[O]);return s.statics&&o(u,s.statics),s.includes&&(ue(s.includes),o.apply(null,[C].concat(s.includes))),o(C,s),delete C.statics,delete C.includes,C.options&&(C.options=v.options?i(v.options):{},o(C.options,s.options)),C._initHooks=[],C.callInitHooks=function(){if(!this._initHooksCalled){v.callInitHooks&&v.callInitHooks.call(this),this._initHooksCalled=!0;for(var W=0,ce=C._initHooks.length;W<ce;W++)C._initHooks[W].call(this)}},u},J.include=function(s){var u=this.prototype.options;return o(this.prototype,s),s.options&&(this.prototype.options=u,this.mergeOptions(s.options)),this},J.mergeOptions=function(s){return o(this.prototype.options,s),this},J.addInitHook=function(s){var u=Array.prototype.slice.call(arguments,1),v=typeof s=="function"?s:function(){this[s].apply(this,u)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(v),this};function ue(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=_(s)?s:[s];for(var u=0;u<s.length;u++)s[u]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Z={on:function(s,u,v){if(typeof s=="object")for(var C in s)this._on(C,s[C],u);else{s=S(s);for(var O=0,W=s.length;O<W;O++)this._on(s[O],u,v)}return this},off:function(s,u,v){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var C in s)this._off(C,s[C],u);else{s=S(s);for(var O=arguments.length===1,W=0,ce=s.length;W<ce;W++)O?this._off(s[W]):this._off(s[W],u,v)}return this},_on:function(s,u,v,C){if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}if(this._listens(s,u,v)===!1){v===this&&(v=void 0);var O={fn:u,ctx:v};C&&(O.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(O)}},_off:function(s,u,v){var C,O,W;if(this._events&&(C=this._events[s],!!C)){if(arguments.length===1){if(this._firingCount)for(O=0,W=C.length;O<W;O++)C[O].fn=m;delete this._events[s];return}if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}var ce=this._listens(s,u,v);if(ce!==!1){var Me=C[ce];this._firingCount&&(Me.fn=m,this._events[s]=C=C.slice()),C.splice(ce,1)}}},fire:function(s,u,v){if(!this.listens(s,v))return this;var C=o({},u,{type:s,target:this,sourceTarget:u&&u.sourceTarget||this});if(this._events){var O=this._events[s];if(O){this._firingCount=this._firingCount+1||1;for(var W=0,ce=O.length;W<ce;W++){var Me=O[W],Re=Me.fn;Me.once&&this.off(s,Re,Me.ctx),Re.call(Me.ctx||this,C)}this._firingCount--}}return v&&this._propagateEvent(C),this},listens:function(s,u,v,C){typeof s!="string"&&console.warn('"string" type argument expected');var O=u;typeof u!="function"&&(C=!!u,O=void 0,v=void 0);var W=this._events&&this._events[s];if(W&&W.length&&this._listens(s,O,v)!==!1)return!0;if(C){for(var ce in this._eventParents)if(this._eventParents[ce].listens(s,u,v,C))return!0}return!1},_listens:function(s,u,v){if(!this._events)return!1;var C=this._events[s]||[];if(!u)return!!C.length;v===this&&(v=void 0);for(var O=0,W=C.length;O<W;O++)if(C[O].fn===u&&C[O].ctx===v)return O;return!1},once:function(s,u,v){if(typeof s=="object")for(var C in s)this._on(C,s[C],u,!0);else{s=S(s);for(var O=0,W=s.length;O<W;O++)this._on(s[O],u,v,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[d(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[d(s)],this},_propagateEvent:function(s){for(var u in this._eventParents)this._eventParents[u].fire(s.type,o({layer:s.target,propagatedFrom:s.target},s),!0)}};Z.addEventListener=Z.on,Z.removeEventListener=Z.clearAllEventListeners=Z.off,Z.addOneTimeEventListener=Z.once,Z.fireEvent=Z.fire,Z.hasEventListeners=Z.listens;var se=J.extend(Z);function U(s,u,v){this.x=v?Math.round(s):s,this.y=v?Math.round(u):u}var Q=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};U.prototype={clone:function(){return new U(this.x,this.y)},add:function(s){return this.clone()._add(oe(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(oe(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new U(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new U(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Q(this.x),this.y=Q(this.y),this},distanceTo:function(s){s=oe(s);var u=s.x-this.x,v=s.y-this.y;return Math.sqrt(u*u+v*v)},equals:function(s){return s=oe(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=oe(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+y(this.x)+", "+y(this.y)+")"}};function oe(s,u,v){return s instanceof U?s:_(s)?new U(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new U(s.x,s.y):new U(s,u,v)}function he(s,u){if(s)for(var v=u?[s,u]:s,C=0,O=v.length;C<O;C++)this.extend(v[C])}he.prototype={extend:function(s){var u,v;if(!s)return this;if(s instanceof U||typeof s[0]=="number"||"x"in s)u=v=oe(s);else if(s=Te(s),u=s.min,v=s.max,!u||!v)return this;return!this.min&&!this.max?(this.min=u.clone(),this.max=v.clone()):(this.min.x=Math.min(u.x,this.min.x),this.max.x=Math.max(v.x,this.max.x),this.min.y=Math.min(u.y,this.min.y),this.max.y=Math.max(v.y,this.max.y)),this},getCenter:function(s){return oe((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return oe(this.min.x,this.max.y)},getTopRight:function(){return oe(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var u,v;return typeof s[0]=="number"||s instanceof U?s=oe(s):s=Te(s),s instanceof he?(u=s.min,v=s.max):u=v=s,u.x>=this.min.x&&v.x<=this.max.x&&u.y>=this.min.y&&v.y<=this.max.y},intersects:function(s){s=Te(s);var u=this.min,v=this.max,C=s.min,O=s.max,W=O.x>=u.x&&C.x<=v.x,ce=O.y>=u.y&&C.y<=v.y;return W&&ce},overlaps:function(s){s=Te(s);var u=this.min,v=this.max,C=s.min,O=s.max,W=O.x>u.x&&C.x<v.x,ce=O.y>u.y&&C.y<v.y;return W&&ce},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var u=this.min,v=this.max,C=Math.abs(u.x-v.x)*s,O=Math.abs(u.y-v.y)*s;return Te(oe(u.x-C,u.y-O),oe(v.x+C,v.y+O))},equals:function(s){return s?(s=Te(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function Te(s,u){return!s||s instanceof he?s:new he(s,u)}function je(s,u){if(s)for(var v=u?[s,u]:s,C=0,O=v.length;C<O;C++)this.extend(v[C])}je.prototype={extend:function(s){var u=this._southWest,v=this._northEast,C,O;if(s instanceof We)C=s,O=s;else if(s instanceof je){if(C=s._southWest,O=s._northEast,!C||!O)return this}else return s?this.extend(be(s)||He(s)):this;return!u&&!v?(this._southWest=new We(C.lat,C.lng),this._northEast=new We(O.lat,O.lng)):(u.lat=Math.min(C.lat,u.lat),u.lng=Math.min(C.lng,u.lng),v.lat=Math.max(O.lat,v.lat),v.lng=Math.max(O.lng,v.lng)),this},pad:function(s){var u=this._southWest,v=this._northEast,C=Math.abs(u.lat-v.lat)*s,O=Math.abs(u.lng-v.lng)*s;return new je(new We(u.lat-C,u.lng-O),new We(v.lat+C,v.lng+O))},getCenter:function(){return new We((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new We(this.getNorth(),this.getWest())},getSouthEast:function(){return new We(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof We||"lat"in s?s=be(s):s=He(s);var u=this._southWest,v=this._northEast,C,O;return s instanceof je?(C=s.getSouthWest(),O=s.getNorthEast()):C=O=s,C.lat>=u.lat&&O.lat<=v.lat&&C.lng>=u.lng&&O.lng<=v.lng},intersects:function(s){s=He(s);var u=this._southWest,v=this._northEast,C=s.getSouthWest(),O=s.getNorthEast(),W=O.lat>=u.lat&&C.lat<=v.lat,ce=O.lng>=u.lng&&C.lng<=v.lng;return W&&ce},overlaps:function(s){s=He(s);var u=this._southWest,v=this._northEast,C=s.getSouthWest(),O=s.getNorthEast(),W=O.lat>u.lat&&C.lat<v.lat,ce=O.lng>u.lng&&C.lng<v.lng;return W&&ce},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,u){return s?(s=He(s),this._southWest.equals(s.getSouthWest(),u)&&this._northEast.equals(s.getNorthEast(),u)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function He(s,u){return s instanceof je?s:new je(s,u)}function We(s,u,v){if(isNaN(s)||isNaN(u))throw new Error("Invalid LatLng object: ("+s+", "+u+")");this.lat=+s,this.lng=+u,v!==void 0&&(this.alt=+v)}We.prototype={equals:function(s,u){if(!s)return!1;s=be(s);var v=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return v<=(u===void 0?1e-9:u)},toString:function(s){return"LatLng("+y(this.lat,s)+", "+y(this.lng,s)+")"},distanceTo:function(s){return Y.distance(this,be(s))},wrap:function(){return Y.wrapLatLng(this)},toBounds:function(s){var u=180*s/40075017,v=u/Math.cos(Math.PI/180*this.lat);return He([this.lat-u,this.lng-v],[this.lat+u,this.lng+v])},clone:function(){return new We(this.lat,this.lng,this.alt)}};function be(s,u,v){return s instanceof We?s:_(s)&&typeof s[0]!="object"?s.length===3?new We(s[0],s[1],s[2]):s.length===2?new We(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new We(s.lat,"lng"in s?s.lng:s.lon,s.alt):u===void 0?null:new We(s,u,v)}var V={latLngToPoint:function(s,u){var v=this.projection.project(s),C=this.scale(u);return this.transformation._transform(v,C)},pointToLatLng:function(s,u){var v=this.scale(u),C=this.transformation.untransform(s,v);return this.projection.unproject(C)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var u=this.projection.bounds,v=this.scale(s),C=this.transformation.transform(u.min,v),O=this.transformation.transform(u.max,v);return new he(C,O)},infinite:!1,wrapLatLng:function(s){var u=this.wrapLng?f(s.lng,this.wrapLng,!0):s.lng,v=this.wrapLat?f(s.lat,this.wrapLat,!0):s.lat,C=s.alt;return new We(v,u,C)},wrapLatLngBounds:function(s){var u=s.getCenter(),v=this.wrapLatLng(u),C=u.lat-v.lat,O=u.lng-v.lng;if(C===0&&O===0)return s;var W=s.getSouthWest(),ce=s.getNorthEast(),Me=new We(W.lat-C,W.lng-O),Re=new We(ce.lat-C,ce.lng-O);return new je(Me,Re)}},Y=o({},V,{wrapLng:[-180,180],R:6371e3,distance:function(s,u){var v=Math.PI/180,C=s.lat*v,O=u.lat*v,W=Math.sin((u.lat-s.lat)*v/2),ce=Math.sin((u.lng-s.lng)*v/2),Me=W*W+Math.cos(C)*Math.cos(O)*ce*ce,Re=2*Math.atan2(Math.sqrt(Me),Math.sqrt(1-Me));return this.R*Re}}),re=6378137,ie={R:re,MAX_LATITUDE:85.0511287798,project:function(s){var u=Math.PI/180,v=this.MAX_LATITUDE,C=Math.max(Math.min(v,s.lat),-v),O=Math.sin(C*u);return new U(this.R*s.lng*u,this.R*Math.log((1+O)/(1-O))/2)},unproject:function(s){var u=180/Math.PI;return new We((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*u,s.x*u/this.R)},bounds:(function(){var s=re*Math.PI;return new he([-s,-s],[s,s])})()};function $e(s,u,v,C){if(_(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=u,this._c=v,this._d=C}$e.prototype={transform:function(s,u){return this._transform(s.clone(),u)},_transform:function(s,u){return u=u||1,s.x=u*(this._a*s.x+this._b),s.y=u*(this._c*s.y+this._d),s},untransform:function(s,u){return u=u||1,new U((s.x/u-this._b)/this._a,(s.y/u-this._d)/this._c)}};function q(s,u,v,C){return new $e(s,u,v,C)}var X=o({},Y,{code:"EPSG:3857",projection:ie,transformation:(function(){var s=.5/(Math.PI*ie.R);return q(s,.5,-s,.5)})()}),ee=o({},X,{code:"EPSG:900913"});function Ce(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function Ne(s,u){var v="",C,O,W,ce,Me,Re;for(C=0,W=s.length;C<W;C++){for(Me=s[C],O=0,ce=Me.length;O<ce;O++)Re=Me[O],v+=(O?"L":"M")+Re.x+" "+Re.y;v+=u?Qe.svg?"z":"x":""}return v||"M0 0"}var Be=document.documentElement.style,Ae="ActiveXObject"in window,ne=Ae&&!document.addEventListener,ye="msLaunchUri"in navigator&&!("documentMode"in document),De=lt("webkit"),Pe=lt("android"),Ie=lt("android 2")||lt("android 3"),me=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ke=Pe&&lt("Google")&&me<537&&!("AudioNode"in window),Ve=!!window.opera,de=!ye&&lt("chrome"),ke=lt("gecko")&&!De&&!Ve&&!Ae,te=!de&&lt("safari"),ge=lt("phantom"),Fe="OTransition"in Be,ut=navigator.platform.indexOf("Win")===0,gt=Ae&&"transition"in Be,xt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ie,Ct="MozPerspective"in Be,Pt=!window.L_DISABLE_3D&&(gt||xt||Ct)&&!Fe&&!ge,Wt=typeof orientation<"u"||lt("mobile"),_o=Wt&&De,cn=Wt&&xt,ft=!window.PointerEvent&&window.MSPointerEvent,Dt=!!(window.PointerEvent||ft),$t="ontouchstart"in window||!!window.TouchEvent,In=!window.L_NO_TOUCH&&($t||Dt),En=Wt&&Ve,wo=Wt&&ke,Ao=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,en=(function(){var s=!1;try{var u=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",m,u),window.removeEventListener("testPassiveEventSupport",m,u)}catch{}return s})(),Ma=(function(){return!!document.createElement("canvas").getContext})(),On=!!(document.createElementNS&&Ce("svg").createSVGRect),Go=!!On&&(function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),pe=!On&&(function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var u=s.firstChild;return u.style.behavior="url(#default#VML)",u&&typeof u.adj=="object"}catch{return!1}})(),ve=navigator.platform.indexOf("Mac")===0,Le=navigator.platform.indexOf("Linux")===0;function lt(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var Qe={ie:Ae,ielt9:ne,edge:ye,webkit:De,android:Pe,android23:Ie,androidStock:Ke,opera:Ve,chrome:de,gecko:ke,safari:te,phantom:ge,opera12:Fe,win:ut,ie3d:gt,webkit3d:xt,gecko3d:Ct,any3d:Pt,mobile:Wt,mobileWebkit:_o,mobileWebkit3d:cn,msPointer:ft,pointer:Dt,touch:In,touchNative:$t,mobileOpera:En,mobileGecko:wo,retina:Ao,passiveEvents:en,canvas:Ma,svg:On,vml:pe,inlineSvg:Go,mac:ve,linux:Le},Rt=Qe.msPointer?"MSPointerDown":"pointerdown",tn=Qe.msPointer?"MSPointerMove":"pointermove",an=Qe.msPointer?"MSPointerUp":"pointerup",Bn=Qe.msPointer?"MSPointerCancel":"pointercancel",ao={touchstart:Rt,touchmove:tn,touchend:an,touchcancel:Bn},Ja={touchstart:Xa,touchmove:Nn,touchend:Nn,touchcancel:Nn},qo={},yi=!1;function yl(s,u,v){return u==="touchstart"&&bi(),Ja[u]?(v=Ja[u].bind(this,v),s.addEventListener(ao[u],v,!1),v):(console.warn("wrong event specified:",u),m)}function ki(s,u,v){if(!ao[u]){console.warn("wrong event specified:",u);return}s.removeEventListener(ao[u],v,!1)}function jo(s){qo[s.pointerId]=s}function ia(s){qo[s.pointerId]&&(qo[s.pointerId]=s)}function la(s){delete qo[s.pointerId]}function bi(){yi||(document.addEventListener(Rt,jo,!0),document.addEventListener(tn,ia,!0),document.addEventListener(an,la,!0),document.addEventListener(Bn,la,!0),yi=!0)}function Nn(s,u){if(u.pointerType!==(u.MSPOINTER_TYPE_MOUSE||"mouse")){u.touches=[];for(var v in qo)u.touches.push(qo[v]);u.changedTouches=[u],s(u)}}function Xa(s,u){u.MSPOINTER_TYPE_TOUCH&&u.pointerType===u.MSPOINTER_TYPE_TOUCH&&Zt(u),Nn(s,u)}function xn(s){var u={},v,C;for(C in s)v=s[C],u[C]=v&&v.bind?v.bind(s):v;return s=u,u.type="dblclick",u.detail=2,u.isTrusted=!1,u._simulated=!0,u}var Aa=200;function Ps(s,u){s.addEventListener("dblclick",u);var v=0,C;function O(W){if(W.detail!==1){C=W.detail;return}if(!(W.pointerType==="mouse"||W.sourceCapabilities&&!W.sourceCapabilities.firesTouchEvents)){var ce=Ra(W);if(!(ce.some(function(Re){return Re instanceof HTMLLabelElement&&Re.attributes.for})&&!ce.some(function(Re){return Re instanceof HTMLInputElement||Re instanceof HTMLSelectElement}))){var Me=Date.now();Me-v<=Aa?(C++,C===2&&u(xn(W))):C=1,v=Me}}}return s.addEventListener("click",O),{dblclick:u,simDblclick:O}}function _i(s,u){s.removeEventListener("dblclick",u.dblclick),s.removeEventListener("click",u.simDblclick)}var so=Do(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Eo=Do(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Co=Eo==="webkitTransition"||Eo==="OTransition"?Eo+"End":"transitionend";function Qa(s){return typeof s=="string"?document.getElementById(s):s}function _n(s,u){var v=s.style[u]||s.currentStyle&&s.currentStyle[u];if((!v||v==="auto")&&document.defaultView){var C=document.defaultView.getComputedStyle(s,null);v=C?C[u]:null}return v==="auto"?null:v}function _t(s,u,v){var C=document.createElement(s);return C.className=u||"",v&&v.appendChild(C),C}function Mt(s){var u=s.parentNode;u&&u.removeChild(s)}function Fn(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function io(s){var u=s.parentNode;u&&u.lastChild!==s&&u.appendChild(s)}function Un(s){var u=s.parentNode;u&&u.firstChild!==s&&u.insertBefore(s,u.firstChild)}function Lo(s,u){if(s.classList!==void 0)return s.classList.contains(u);var v=lo(s);return v.length>0&&new RegExp("(^|\\s)"+u+"(\\s|$)").test(v)}function yt(s,u){if(s.classList!==void 0)for(var v=S(u),C=0,O=v.length;C<O;C++)s.classList.add(v[C]);else if(!Lo(s,u)){var W=lo(s);Po(s,(W?W+" ":"")+u)}}function Ft(s,u){s.classList!==void 0?s.classList.remove(u):Po(s,k((" "+lo(s)+" ").replace(" "+u+" "," ")))}function Po(s,u){s.className.baseVal===void 0?s.className=u:s.className.baseVal=u}function lo(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function fn(s,u){"opacity"in s.style?s.style.opacity=u:"filter"in s.style&&es(s,u)}function es(s,u){var v=!1,C="DXImageTransform.Microsoft.Alpha";try{v=s.filters.item(C)}catch{if(u===1)return}u=Math.round(u*100),v?(v.Enabled=u!==100,v.Opacity=u):s.style.filter+=" progid:"+C+"(opacity="+u+")"}function Do(s){for(var u=document.documentElement.style,v=0;v<s.length;v++)if(s[v]in u)return s[v];return!1}function qn(s,u,v){var C=u||new U(0,0);s.style[so]=(Qe.ie3d?"translate("+C.x+"px,"+C.y+"px)":"translate3d("+C.x+"px,"+C.y+"px,0)")+(v?" scale("+v+")":"")}function on(s,u){s._leaflet_pos=u,Qe.any3d?qn(s,u):(s.style.left=u.x+"px",s.style.top=u.y+"px")}function Wo(s){return s._leaflet_pos||new U(0,0)}var ts,Ea,Ds;if("onselectstart"in document)ts=function(){rt(window,"selectstart",Zt)},Ea=function(){Ut(window,"selectstart",Zt)};else{var ns=Do(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);ts=function(){if(ns){var s=document.documentElement.style;Ds=s[ns],s[ns]="none"}},Ea=function(){ns&&(document.documentElement.style[ns]=Ds,Ds=void 0)}}function Pa(){rt(window,"dragstart",Zt)}function Rs(){Ut(window,"dragstart",Zt)}var Da,Os;function wi(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(Bs(),Da=s,Os=s.style.outlineStyle,s.style.outlineStyle="none",rt(window,"keydown",Bs))}function Bs(){Da&&(Da.style.outlineStyle=Os,Da=void 0,Os=void 0,Ut(window,"keydown",Bs))}function kl(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function Ci(s){var u=s.getBoundingClientRect();return{x:u.width/s.offsetWidth||1,y:u.height/s.offsetHeight||1,boundingClientRect:u}}var Li={__proto__:null,TRANSFORM:so,TRANSITION:Eo,TRANSITION_END:Co,get:Qa,getStyle:_n,create:_t,remove:Mt,empty:Fn,toFront:io,toBack:Un,hasClass:Lo,addClass:yt,removeClass:Ft,setClass:Po,getClass:lo,setOpacity:fn,testProp:Do,setTransform:qn,setPosition:on,getPosition:Wo,get disableTextSelection(){return ts},get enableTextSelection(){return Ea},disableImageDrag:Pa,enableImageDrag:Rs,preventOutline:wi,restoreOutline:Bs,getSizedParentNode:kl,getScale:Ci};function rt(s,u,v,C){if(u&&typeof u=="object")for(var O in u)Ii(s,O,u[O],v);else{u=S(u);for(var W=0,ce=u.length;W<ce;W++)Ii(s,u[W],v,C)}return this}var pn="_leaflet_events";function Ut(s,u,v,C){if(arguments.length===1)os(s),delete s[pn];else if(u&&typeof u=="object")for(var O in u)sn(s,O,u[O],v);else if(u=S(u),arguments.length===2)os(s,function(Me){return I(u,Me)!==-1});else for(var W=0,ce=u.length;W<ce;W++)sn(s,u[W],v,C);return this}function os(s,u){for(var v in s[pn]){var C=v.split(/\d/)[0];(!u||u(C))&&sn(s,C,null,null,v)}}var Si={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ii(s,u,v,C){var O=u+d(v)+(C?"_"+d(C):"");if(s[pn]&&s[pn][O])return this;var W=function(Me){return v.call(C||s,Me||window.event)},ce=W;!Qe.touchNative&&Qe.pointer&&u.indexOf("touch")===0?W=yl(s,u,W):Qe.touch&&u==="dblclick"?W=Ps(s,W):"addEventListener"in s?u==="touchstart"||u==="touchmove"||u==="wheel"||u==="mousewheel"?s.addEventListener(Si[u]||u,W,Qe.passiveEvents?{passive:!1}:!1):u==="mouseenter"||u==="mouseleave"?(W=function(Me){Me=Me||window.event,Ns(s,Me)&&ce(Me)},s.addEventListener(Si[u],W,!1)):s.addEventListener(u,ce,!1):s.attachEvent("on"+u,W),s[pn]=s[pn]||{},s[pn][O]=W}function sn(s,u,v,C,O){O=O||u+d(v)+(C?"_"+d(C):"");var W=s[pn]&&s[pn][O];if(!W)return this;!Qe.touchNative&&Qe.pointer&&u.indexOf("touch")===0?ki(s,u,W):Qe.touch&&u==="dblclick"?_i(s,W):"removeEventListener"in s?s.removeEventListener(Si[u]||u,W,!1):s.detachEvent("on"+u,W),s[pn][O]=null}function vn(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function ra(s){return Ii(s,"wheel",vn),this}function Ro(s){return rt(s,"mousedown touchstart dblclick contextmenu",vn),s._leaflet_disable_click=!0,this}function Zt(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function ro(s){return Zt(s),vn(s),this}function Ra(s){if(s.composedPath)return s.composedPath();for(var u=[],v=s.target;v;)u.push(v),v=v.parentNode;return u}function Oa(s,u){if(!u)return new U(s.clientX,s.clientY);var v=Ci(u),C=v.boundingClientRect;return new U((s.clientX-C.left)/v.x-u.clientLeft,(s.clientY-C.top)/v.y-u.clientTop)}var bl=Qe.linux&&Qe.chrome?window.devicePixelRatio:Qe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function xi(s){return Qe.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/bl:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function Ns(s,u){var v=u.relatedTarget;if(!v)return!0;try{for(;v&&v!==s;)v=v.parentNode}catch{return!1}return v!==s}var cr={__proto__:null,on:rt,off:Ut,stopPropagation:vn,disableScrollPropagation:ra,disableClickPropagation:Ro,preventDefault:Zt,stop:ro,getPropagationPath:Ra,getMousePosition:Oa,getWheelDelta:xi,isExternalTarget:Ns,addListener:rt,removeListener:Ut},Fs=se.extend({run:function(s,u,v,C){this.stop(),this._el=s,this._inProgress=!0,this._duration=v||.25,this._easeOutPower=1/Math.max(C||.5,.2),this._startPos=Wo(s),this._offset=u.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=F(this._animate,this),this._step()},_step:function(s){var u=+new Date-this._startTime,v=this._duration*1e3;u<v?this._runFrame(this._easeOut(u/v),s):(this._runFrame(1),this._complete())},_runFrame:function(s,u){var v=this._startPos.add(this._offset.multiplyBy(s));u&&v._round(),on(this._el,v),this.fire("step")},_complete:function(){j(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),Lt=se.extend({options:{crs:X,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,u){u=x(this,u),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),u.maxBounds&&this.setMaxBounds(u.maxBounds),u.zoom!==void 0&&(this._zoom=this._limitZoom(u.zoom)),u.center&&u.zoom!==void 0&&this.setView(be(u.center),u.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Eo&&Qe.any3d&&!Qe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),rt(this._proxy,Co,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,u,v){if(u=u===void 0?this._zoom:this._limitZoom(u),s=this._limitCenter(be(s),u,this.options.maxBounds),v=v||{},this._stop(),this._loaded&&!v.reset&&v!==!0){v.animate!==void 0&&(v.zoom=o({animate:v.animate},v.zoom),v.pan=o({animate:v.animate,duration:v.duration},v.pan));var C=this._zoom!==u?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,u,v.zoom):this._tryAnimatedPan(s,v.pan);if(C)return clearTimeout(this._sizeTimer),this}return this._resetView(s,u,v.pan&&v.pan.noMoveStart),this},setZoom:function(s,u){return this._loaded?this.setView(this.getCenter(),s,{zoom:u}):(this._zoom=s,this)},zoomIn:function(s,u){return s=s||(Qe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,u)},zoomOut:function(s,u){return s=s||(Qe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,u)},setZoomAround:function(s,u,v){var C=this.getZoomScale(u),O=this.getSize().divideBy(2),W=s instanceof U?s:this.latLngToContainerPoint(s),ce=W.subtract(O).multiplyBy(1-1/C),Me=this.containerPointToLatLng(O.add(ce));return this.setView(Me,u,{zoom:v})},_getBoundsCenterZoom:function(s,u){u=u||{},s=s.getBounds?s.getBounds():He(s);var v=oe(u.paddingTopLeft||u.padding||[0,0]),C=oe(u.paddingBottomRight||u.padding||[0,0]),O=this.getBoundsZoom(s,!1,v.add(C));if(O=typeof u.maxZoom=="number"?Math.min(u.maxZoom,O):O,O===1/0)return{center:s.getCenter(),zoom:O};var W=C.subtract(v).divideBy(2),ce=this.project(s.getSouthWest(),O),Me=this.project(s.getNorthEast(),O),Re=this.unproject(ce.add(Me).divideBy(2).add(W),O);return{center:Re,zoom:O}},fitBounds:function(s,u){if(s=He(s),!s.isValid())throw new Error("Bounds are not valid.");var v=this._getBoundsCenterZoom(s,u);return this.setView(v.center,v.zoom,u)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,u){return this.setView(s,this._zoom,{pan:u})},panBy:function(s,u){if(s=oe(s).round(),u=u||{},!s.x&&!s.y)return this.fire("moveend");if(u.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Fs,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),u.noMoveStart||this.fire("movestart"),u.animate!==!1){yt(this._mapPane,"leaflet-pan-anim");var v=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,v,u.duration||.25,u.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,u,v){if(v=v||{},v.animate===!1||!Qe.any3d)return this.setView(s,u,v);this._stop();var C=this.project(this.getCenter()),O=this.project(s),W=this.getSize(),ce=this._zoom;s=be(s),u=u===void 0?ce:u;var Me=Math.max(W.x,W.y),Re=Me*this.getZoomScale(ce,u),Xe=O.distanceTo(C)||1,it=1.42,pt=it*it;function At(Cn){var $c=Cn?-1:1,M1=Cn?Re:Me,A1=Re*Re-Me*Me+$c*pt*pt*Xe*Xe,E1=2*M1*pt*Xe,gd=A1/E1,jf=Math.sqrt(gd*gd+1)-gd,P1=jf<1e-9?-18:Math.log(jf);return P1}function fo(Cn){return(Math.exp(Cn)-Math.exp(-Cn))/2}function Dn(Cn){return(Math.exp(Cn)+Math.exp(-Cn))/2}function Qo(Cn){return fo(Cn)/Dn(Cn)}var Io=At(0);function Pl(Cn){return Me*(Dn(Io)/Dn(Io+it*Cn))}function I1(Cn){return Me*(Dn(Io)*Qo(Io+it*Cn)-fo(Io))/pt}function x1(Cn){return 1-Math.pow(1-Cn,1.5)}var $1=Date.now(),Gf=(At(1)-Io)/it,T1=v.duration?1e3*v.duration:1e3*Gf*.8;function qf(){var Cn=(Date.now()-$1)/T1,$c=x1(Cn)*Gf;Cn<=1?(this._flyToFrame=F(qf,this),this._move(this.unproject(C.add(O.subtract(C).multiplyBy(I1($c)/Xe)),ce),this.getScaleZoom(Me/Pl($c),ce),{flyTo:!0})):this._move(s,u)._moveEnd(!0)}return this._moveStart(!0,v.noMoveStart),qf.call(this),this},flyToBounds:function(s,u){var v=this._getBoundsCenterZoom(s,u);return this.flyTo(v.center,v.zoom,u)},setMaxBounds:function(s){return s=He(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var u=this.options.minZoom;return this.options.minZoom=s,this._loaded&&u!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var u=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&u!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,u){this._enforcingBounds=!0;var v=this.getCenter(),C=this._limitCenter(v,this._zoom,He(s));return v.equals(C)||this.panTo(C,u),this._enforcingBounds=!1,this},panInside:function(s,u){u=u||{};var v=oe(u.paddingTopLeft||u.padding||[0,0]),C=oe(u.paddingBottomRight||u.padding||[0,0]),O=this.project(this.getCenter()),W=this.project(s),ce=this.getPixelBounds(),Me=Te([ce.min.add(v),ce.max.subtract(C)]),Re=Me.getSize();if(!Me.contains(W)){this._enforcingBounds=!0;var Xe=W.subtract(Me.getCenter()),it=Me.extend(W).getSize().subtract(Re);O.x+=Xe.x<0?-it.x:it.x,O.y+=Xe.y<0?-it.y:it.y,this.panTo(this.unproject(O),u),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=o({animate:!1,pan:!0},s===!0?{animate:!0}:s);var u=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var v=this.getSize(),C=u.divideBy(2).round(),O=v.divideBy(2).round(),W=C.subtract(O);return!W.x&&!W.y?this:(s.animate&&s.pan?this.panBy(W):(s.pan&&this._rawPanBy(W),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:u,newSize:v}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=o({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var u=l(this._handleGeolocationResponse,this),v=l(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(u,v,s):navigator.geolocation.getCurrentPosition(u,v,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var u=s.code,v=s.message||(u===1?"permission denied":u===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:u,message:"Geolocation error: "+v+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var u=s.coords.latitude,v=s.coords.longitude,C=new We(u,v),O=C.toBounds(s.coords.accuracy*2),W=this._locateOptions;if(W.setView){var ce=this.getBoundsZoom(O);this.setView(C,W.maxZoom?Math.min(ce,W.maxZoom):ce)}var Me={latlng:C,bounds:O,timestamp:s.timestamp};for(var Re in s.coords)typeof s.coords[Re]=="number"&&(Me[Re]=s.coords[Re]);this.fire("locationfound",Me)}},addHandler:function(s,u){if(!u)return this;var v=this[s]=new u(this);return this._handlers.push(v),this.options[s]&&v.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Mt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(j(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)Mt(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,u){var v="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),C=_t("div",v,u||this._mapPane);return s&&(this._panes[s]=C),C},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),u=this.unproject(s.getBottomLeft()),v=this.unproject(s.getTopRight());return new je(u,v)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,u,v){s=He(s),v=oe(v||[0,0]);var C=this.getZoom()||0,O=this.getMinZoom(),W=this.getMaxZoom(),ce=s.getNorthWest(),Me=s.getSouthEast(),Re=this.getSize().subtract(v),Xe=Te(this.project(Me,C),this.project(ce,C)).getSize(),it=Qe.any3d?this.options.zoomSnap:1,pt=Re.x/Xe.x,At=Re.y/Xe.y,fo=u?Math.max(pt,At):Math.min(pt,At);return C=this.getScaleZoom(fo,C),it&&(C=Math.round(C/(it/100))*(it/100),C=u?Math.ceil(C/it)*it:Math.floor(C/it)*it),Math.max(O,Math.min(W,C))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new U(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,u){var v=this._getTopLeftPoint(s,u);return new he(v,v.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,u){var v=this.options.crs;return u=u===void 0?this._zoom:u,v.scale(s)/v.scale(u)},getScaleZoom:function(s,u){var v=this.options.crs;u=u===void 0?this._zoom:u;var C=v.zoom(s*v.scale(u));return isNaN(C)?1/0:C},project:function(s,u){return u=u===void 0?this._zoom:u,this.options.crs.latLngToPoint(be(s),u)},unproject:function(s,u){return u=u===void 0?this._zoom:u,this.options.crs.pointToLatLng(oe(s),u)},layerPointToLatLng:function(s){var u=oe(s).add(this.getPixelOrigin());return this.unproject(u)},latLngToLayerPoint:function(s){var u=this.project(be(s))._round();return u._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(be(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(He(s))},distance:function(s,u){return this.options.crs.distance(be(s),be(u))},containerPointToLayerPoint:function(s){return oe(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return oe(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var u=this.containerPointToLayerPoint(oe(s));return this.layerPointToLatLng(u)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(be(s)))},mouseEventToContainerPoint:function(s){return Oa(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var u=this._container=Qa(s);if(u){if(u._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");rt(u,"scroll",this._onScroll,this),this._containerId=d(u)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&Qe.any3d,yt(s,"leaflet-container"+(Qe.touch?" leaflet-touch":"")+(Qe.retina?" leaflet-retina":"")+(Qe.ielt9?" leaflet-oldie":"")+(Qe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var u=_n(s,"position");u!=="absolute"&&u!=="relative"&&u!=="fixed"&&u!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),on(this._mapPane,new U(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(yt(s.markerPane,"leaflet-zoom-hide"),yt(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,u,v){on(this._mapPane,new U(0,0));var C=!this._loaded;this._loaded=!0,u=this._limitZoom(u),this.fire("viewprereset");var O=this._zoom!==u;this._moveStart(O,v)._move(s,u)._moveEnd(O),this.fire("viewreset"),C&&this.fire("load")},_moveStart:function(s,u){return s&&this.fire("zoomstart"),u||this.fire("movestart"),this},_move:function(s,u,v,C){u===void 0&&(u=this._zoom);var O=this._zoom!==u;return this._zoom=u,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),C?v&&v.pinch&&this.fire("zoom",v):((O||v&&v.pinch)&&this.fire("zoom",v),this.fire("move",v)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return j(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){on(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[d(this._container)]=this;var u=s?Ut:rt;u(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&u(window,"resize",this._onResize,this),Qe.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){j(this._resizeRequest),this._resizeRequest=F(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,u){for(var v=[],C,O=u==="mouseout"||u==="mouseover",W=s.target||s.srcElement,ce=!1;W;){if(C=this._targets[d(W)],C&&(u==="click"||u==="preclick")&&this._draggableMoved(C)){ce=!0;break}if(C&&C.listens(u,!0)&&(O&&!Ns(W,s)||(v.push(C),O))||W===this._container)break;W=W.parentNode}return!v.length&&!ce&&!O&&this.listens(u,!0)&&(v=[this]),v},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var u=s.target||s.srcElement;if(!(!this._loaded||u._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(u))){var v=s.type;v==="mousedown"&&wi(u),this._fireDOMEvent(s,v)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,u,v){if(s.type==="click"){var C=o({},s);C.type="preclick",this._fireDOMEvent(C,C.type,v)}var O=this._findEventTargets(s,u);if(v){for(var W=[],ce=0;ce<v.length;ce++)v[ce].listens(u,!0)&&W.push(v[ce]);O=W.concat(O)}if(O.length){u==="contextmenu"&&Zt(s);var Me=O[0],Re={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var Xe=Me.getLatLng&&(!Me._radius||Me._radius<=10);Re.containerPoint=Xe?this.latLngToContainerPoint(Me.getLatLng()):this.mouseEventToContainerPoint(s),Re.layerPoint=this.containerPointToLayerPoint(Re.containerPoint),Re.latlng=Xe?Me.getLatLng():this.layerPointToLatLng(Re.layerPoint)}for(ce=0;ce<O.length;ce++)if(O[ce].fire(u,Re,!0),Re.originalEvent._stopped||O[ce].options.bubblingMouseEvents===!1&&I(this._mouseEvents,u)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,u=this._handlers.length;s<u;s++)this._handlers[s].disable()},whenReady:function(s,u){return this._loaded?s.call(u||this,{target:this}):this.on("load",s,u),this},_getMapPanePos:function(){return Wo(this._mapPane)||new U(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,u){var v=s&&u!==void 0?this._getNewPixelOrigin(s,u):this.getPixelOrigin();return v.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,u){var v=this.getSize()._divideBy(2);return this.project(s,u)._subtract(v)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,u,v){var C=this._getNewPixelOrigin(v,u);return this.project(s,u)._subtract(C)},_latLngBoundsToNewLayerBounds:function(s,u,v){var C=this._getNewPixelOrigin(v,u);return Te([this.project(s.getSouthWest(),u)._subtract(C),this.project(s.getNorthWest(),u)._subtract(C),this.project(s.getSouthEast(),u)._subtract(C),this.project(s.getNorthEast(),u)._subtract(C)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,u,v){if(!v)return s;var C=this.project(s,u),O=this.getSize().divideBy(2),W=new he(C.subtract(O),C.add(O)),ce=this._getBoundsOffset(W,v,u);return Math.abs(ce.x)<=1&&Math.abs(ce.y)<=1?s:this.unproject(C.add(ce),u)},_limitOffset:function(s,u){if(!u)return s;var v=this.getPixelBounds(),C=new he(v.min.add(s),v.max.add(s));return s.add(this._getBoundsOffset(C,u))},_getBoundsOffset:function(s,u,v){var C=Te(this.project(u.getNorthEast(),v),this.project(u.getSouthWest(),v)),O=C.min.subtract(s.min),W=C.max.subtract(s.max),ce=this._rebound(O.x,-W.x),Me=this._rebound(O.y,-W.y);return new U(ce,Me)},_rebound:function(s,u){return s+u>0?Math.round(s-u)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(u))},_limitZoom:function(s){var u=this.getMinZoom(),v=this.getMaxZoom(),C=Qe.any3d?this.options.zoomSnap:1;return C&&(s=Math.round(s/C)*C),Math.max(u,Math.min(v,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Ft(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,u){var v=this._getCenterOffset(s)._trunc();return(u&&u.animate)!==!0&&!this.getSize().contains(v)?!1:(this.panBy(v,u),!0)},_createAnimProxy:function(){var s=this._proxy=_t("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(u){var v=so,C=this._proxy.style[v];qn(this._proxy,this.project(u.center,u.zoom),this.getZoomScale(u.zoom,1)),C===this._proxy.style[v]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Mt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),u=this.getZoom();qn(this._proxy,this.project(s,u),this.getZoomScale(u,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,u,v){if(this._animatingZoom)return!0;if(v=v||{},!this._zoomAnimated||v.animate===!1||this._nothingToAnimate()||Math.abs(u-this._zoom)>this.options.zoomAnimationThreshold)return!1;var C=this.getZoomScale(u),O=this._getCenterOffset(s)._divideBy(1-1/C);return v.animate!==!0&&!this.getSize().contains(O)?!1:(F(function(){this._moveStart(!0,v.noMoveStart||!1)._animateZoom(s,u,!0)},this),!0)},_animateZoom:function(s,u,v,C){this._mapPane&&(v&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=u,yt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:u,noUpdate:C}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Ft(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ur(s,u){return new Lt(s,u)}var co=J.extend({options:{position:"topright"},initialize:function(s){x(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var u=this._map;return u&&u.removeControl(this),this.options.position=s,u&&u.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var u=this._container=this.onAdd(s),v=this.getPosition(),C=s._controlCorners[v];return yt(u,"leaflet-control"),v.indexOf("bottom")!==-1?C.insertBefore(u,C.firstChild):C.appendChild(u),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Mt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),uo=function(s){return new co(s)};Lt.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},u="leaflet-",v=this._controlContainer=_t("div",u+"control-container",this._container);function C(O,W){var ce=u+O+" "+u+W;s[O+W]=_t("div",ce,v)}C("top","left"),C("top","right"),C("bottom","left"),C("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)Mt(this._controlCorners[s]);Mt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Us=co.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,u,v,C){return v<C?-1:C<v?1:0}},initialize:function(s,u,v){x(this,v),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var C in s)this._addLayer(s[C],C);for(C in u)this._addLayer(u[C],C,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return co.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,u){return this._addLayer(s,u),this._map?this._update():this},addOverlay:function(s,u){return this._addLayer(s,u,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var u=this._getLayer(d(s));return u&&this._layers.splice(this._layers.indexOf(u),1),this._map?this._update():this},expand:function(){yt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(yt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):Ft(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Ft(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",u=this._container=_t("div",s),v=this.options.collapsed;u.setAttribute("aria-haspopup",!0),Ro(u),ra(u);var C=this._section=_t("section",s+"-list");v&&(this._map.on("click",this.collapse,this),rt(u,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var O=this._layersLink=_t("a",s+"-toggle",u);O.href="#",O.title="Layers",O.setAttribute("role","button"),rt(O,{keydown:function(W){W.keyCode===13&&this._expandSafely()},click:function(W){Zt(W),this._expandSafely()}},this),v||this.expand(),this._baseLayersList=_t("div",s+"-base",C),this._separator=_t("div",s+"-separator",C),this._overlaysList=_t("div",s+"-overlays",C),u.appendChild(C)},_getLayer:function(s){for(var u=0;u<this._layers.length;u++)if(this._layers[u]&&d(this._layers[u].layer)===s)return this._layers[u]},_addLayer:function(s,u,v){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:u,overlay:v}),this.options.sortLayers&&this._layers.sort(l(function(C,O){return this.options.sortFunction(C.layer,O.layer,C.name,O.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Fn(this._baseLayersList),Fn(this._overlaysList),this._layerControlInputs=[];var s,u,v,C,O=0;for(v=0;v<this._layers.length;v++)C=this._layers[v],this._addItem(C),u=u||C.overlay,s=s||!C.overlay,O+=C.overlay?0:1;return this.options.hideSingleBase&&(s=s&&O>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=u&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var u=this._getLayer(d(s.target)),v=u.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;v&&this._map.fire(v,u)},_createRadioElement:function(s,u){var v='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(u?' checked="checked"':"")+"/>",C=document.createElement("div");return C.innerHTML=v,C.firstChild},_addItem:function(s){var u=document.createElement("label"),v=this._map.hasLayer(s.layer),C;s.overlay?(C=document.createElement("input"),C.type="checkbox",C.className="leaflet-control-layers-selector",C.defaultChecked=v):C=this._createRadioElement("leaflet-base-layers_"+d(this),v),this._layerControlInputs.push(C),C.layerId=d(s.layer),rt(C,"click",this._onInputClick,this);var O=document.createElement("span");O.innerHTML=" "+s.name;var W=document.createElement("span");u.appendChild(W),W.appendChild(C),W.appendChild(O);var ce=s.overlay?this._overlaysList:this._baseLayersList;return ce.appendChild(u),this._checkDisabledLayers(),u},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,u,v,C=[],O=[];this._handlingClick=!0;for(var W=s.length-1;W>=0;W--)u=s[W],v=this._getLayer(u.layerId).layer,u.checked?C.push(v):u.checked||O.push(v);for(W=0;W<O.length;W++)this._map.hasLayer(O[W])&&this._map.removeLayer(O[W]);for(W=0;W<C.length;W++)this._map.hasLayer(C[W])||this._map.addLayer(C[W]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,u,v,C=this._map.getZoom(),O=s.length-1;O>=0;O--)u=s[O],v=this._getLayer(u.layerId).layer,u.disabled=v.options.minZoom!==void 0&&C<v.options.minZoom||v.options.maxZoom!==void 0&&C>v.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,rt(s,"click",Zt),this.expand();var u=this;setTimeout(function(){Ut(s,"click",Zt),u._preventClick=!1})}}),dr=function(s,u,v){return new Us(s,u,v)},$i=co.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var u="leaflet-control-zoom",v=_t("div",u+" leaflet-bar"),C=this.options;return this._zoomInButton=this._createButton(C.zoomInText,C.zoomInTitle,u+"-in",v,this._zoomIn),this._zoomOutButton=this._createButton(C.zoomOutText,C.zoomOutTitle,u+"-out",v,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),v},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,u,v,C,O){var W=_t("a",v,C);return W.innerHTML=s,W.href="#",W.title=u,W.setAttribute("role","button"),W.setAttribute("aria-label",u),Ro(W),rt(W,"click",ro),rt(W,"click",O,this),rt(W,"click",this._refocusOnMap,this),W},_updateDisabled:function(){var s=this._map,u="leaflet-disabled";Ft(this._zoomInButton,u),Ft(this._zoomOutButton,u),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(yt(this._zoomOutButton,u),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(yt(this._zoomInButton,u),this._zoomInButton.setAttribute("aria-disabled","true"))}});Lt.mergeOptions({zoomControl:!0}),Lt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new $i,this.addControl(this.zoomControl))});var as=function(s){return new $i(s)},zs=co.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var u="leaflet-control-scale",v=_t("div",u),C=this.options;return this._addScales(C,u+"-line",v),s.on(C.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),v},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,u,v){s.metric&&(this._mScale=_t("div",u,v)),s.imperial&&(this._iScale=_t("div",u,v))},_update:function(){var s=this._map,u=s.getSize().y/2,v=s.distance(s.containerPointToLatLng([0,u]),s.containerPointToLatLng([this.options.maxWidth,u]));this._updateScales(v)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var u=this._getRoundNum(s),v=u<1e3?u+" m":u/1e3+" km";this._updateScale(this._mScale,v,u/s)},_updateImperial:function(s){var u=s*3.2808399,v,C,O;u>5280?(v=u/5280,C=this._getRoundNum(v),this._updateScale(this._iScale,C+" mi",C/v)):(O=this._getRoundNum(u),this._updateScale(this._iScale,O+" ft",O/u))},_updateScale:function(s,u,v){s.style.width=Math.round(this.options.maxWidth*v)+"px",s.innerHTML=u},_getRoundNum:function(s){var u=Math.pow(10,(Math.floor(s)+"").length-1),v=s/u;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,u*v}}),Ba=function(s){return new zs(s)},Ti='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Na=co.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Qe.inlineSvg?Ti+" ":"")+"Leaflet</a>"},initialize:function(s){x(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=_t("div","leaflet-control-attribution"),Ro(this._container);for(var u in s._layers)s._layers[u].getAttribution&&this.addAttribution(s._layers[u].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var u in this._attributions)this._attributions[u]&&s.push(u);var v=[];this.options.prefix&&v.push(this.options.prefix),s.length&&v.push(s.join(", ")),this._container.innerHTML=v.join(' <span aria-hidden="true">|</span> ')}}});Lt.mergeOptions({attributionControl:!0}),Lt.addInitHook(function(){this.options.attributionControl&&new Na().addTo(this)});var _l=function(s){return new Na(s)};co.Layers=Us,co.Zoom=$i,co.Scale=zs,co.Attribution=Na,uo.layers=dr,uo.zoom=as,uo.scale=Ba,uo.attribution=_l;var ho=J.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ho.addTo=function(s,u){return s.addHandler(u,this),this};var hr={Events:Z},wl=Qe.touch?"touchstart mousedown":"mousedown",Oo=se.extend({options:{clickTolerance:3},initialize:function(s,u,v,C){x(this,C),this._element=s,this._dragStartTarget=u||s,this._preventOutline=v},enable:function(){this._enabled||(rt(this._dragStartTarget,wl,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Oo._dragging===this&&this.finishDrag(!0),Ut(this._dragStartTarget,wl,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!Lo(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){Oo._dragging===this&&this.finishDrag();return}if(!(Oo._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(Oo._dragging=this,this._preventOutline&&wi(this._element),Pa(),ts(),!this._moving)){this.fire("down");var u=s.touches?s.touches[0]:s,v=kl(this._element);this._startPoint=new U(u.clientX,u.clientY),this._startPos=Wo(this._element),this._parentScale=Ci(v);var C=s.type==="mousedown";rt(document,C?"mousemove":"touchmove",this._onMove,this),rt(document,C?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var u=s.touches&&s.touches.length===1?s.touches[0]:s,v=new U(u.clientX,u.clientY)._subtract(this._startPoint);!v.x&&!v.y||Math.abs(v.x)+Math.abs(v.y)<this.options.clickTolerance||(v.x/=this._parentScale.x,v.y/=this._parentScale.y,Zt(s),this._moved||(this.fire("dragstart"),this._moved=!0,yt(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),yt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(v),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),on(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){Ft(document.body,"leaflet-dragging"),this._lastTarget&&(Ft(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ut(document,"mousemove touchmove",this._onMove,this),Ut(document,"mouseup touchend touchcancel",this._onUp,this),Rs(),Ea();var u=this._moved&&this._moving;this._moving=!1,Oo._dragging=!1,u&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function Hs(s,u,v){var C,O=[1,4,2,8],W,ce,Me,Re,Xe,it,pt,At;for(W=0,it=s.length;W<it;W++)s[W]._code=Zo(s[W],u);for(Me=0;Me<4;Me++){for(pt=O[Me],C=[],W=0,it=s.length,ce=it-1;W<it;ce=W++)Re=s[W],Xe=s[ce],Re._code&pt?Xe._code&pt||(At=ls(Xe,Re,pt,u,v),At._code=Zo(At,u),C.push(At)):(Xe._code&pt&&(At=ls(Xe,Re,pt,u,v),At._code=Zo(At,u),C.push(At)),C.push(Re));s=C}return s}function ss(s,u){var v,C,O,W,ce,Me,Re,Xe,it;if(!s||s.length===0)throw new Error("latlngs not passed");we(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var pt=be([0,0]),At=He(s),fo=At.getNorthWest().distanceTo(At.getSouthWest())*At.getNorthEast().distanceTo(At.getNorthWest());fo<1700&&(pt=is(s));var Dn=s.length,Qo=[];for(v=0;v<Dn;v++){var Io=be(s[v]);Qo.push(u.project(be([Io.lat-pt.lat,Io.lng-pt.lng])))}for(Me=Re=Xe=0,v=0,C=Dn-1;v<Dn;C=v++)O=Qo[v],W=Qo[C],ce=O.y*W.x-W.y*O.x,Re+=(O.x+W.x)*ce,Xe+=(O.y+W.y)*ce,Me+=ce*3;Me===0?it=Qo[0]:it=[Re/Me,Xe/Me];var Pl=u.unproject(oe(it));return be([Pl.lat+pt.lat,Pl.lng+pt.lng])}function is(s){for(var u=0,v=0,C=0,O=0;O<s.length;O++){var W=be(s[O]);u+=W.lat,v+=W.lng,C++}return be([u/C,v/C])}var fr={__proto__:null,clipPolygon:Hs,polygonCenter:ss,centroid:is};function Mi(s,u){if(!u||!s.length)return s.slice();var v=u*u;return s=Pi(s,v),s=Ei(s,v),s}function Ai(s,u,v){return Math.sqrt(ca(s,u,v,!0))}function pr(s,u,v){return ca(s,u,v)}function Ei(s,u){var v=s.length,C=typeof Uint8Array<"u"?Uint8Array:Array,O=new C(v);O[0]=O[v-1]=1,Vs(s,O,u,0,v-1);var W,ce=[];for(W=0;W<v;W++)O[W]&&ce.push(s[W]);return ce}function Vs(s,u,v,C,O){var W=0,ce,Me,Re;for(Me=C+1;Me<=O-1;Me++)Re=ca(s[Me],s[C],s[O],!0),Re>W&&(ce=Me,W=Re);W>v&&(u[ce]=1,Vs(s,u,v,C,ce),Vs(s,u,v,ce,O))}function Pi(s,u){for(var v=[s[0]],C=1,O=0,W=s.length;C<W;C++)Sl(s[C],s[O])>u&&(v.push(s[C]),O=C);return O<W-1&&v.push(s[W-1]),v}var Cl;function Ll(s,u,v,C,O){var W=C?Cl:Zo(s,v),ce=Zo(u,v),Me,Re,Xe;for(Cl=ce;;){if(!(W|ce))return[s,u];if(W&ce)return!1;Me=W||ce,Re=ls(s,u,Me,v,O),Xe=Zo(Re,v),Me===W?(s=Re,W=Xe):(u=Re,ce=Xe)}}function ls(s,u,v,C,O){var W=u.x-s.x,ce=u.y-s.y,Me=C.min,Re=C.max,Xe,it;return v&8?(Xe=s.x+W*(Re.y-s.y)/ce,it=Re.y):v&4?(Xe=s.x+W*(Me.y-s.y)/ce,it=Me.y):v&2?(Xe=Re.x,it=s.y+ce*(Re.x-s.x)/W):v&1&&(Xe=Me.x,it=s.y+ce*(Me.x-s.x)/W),new U(Xe,it,O)}function Zo(s,u){var v=0;return s.x<u.min.x?v|=1:s.x>u.max.x&&(v|=2),s.y<u.min.y?v|=4:s.y>u.max.y&&(v|=8),v}function Sl(s,u){var v=u.x-s.x,C=u.y-s.y;return v*v+C*C}function ca(s,u,v,C){var O=u.x,W=u.y,ce=v.x-O,Me=v.y-W,Re=ce*ce+Me*Me,Xe;return Re>0&&(Xe=((s.x-O)*ce+(s.y-W)*Me)/Re,Xe>1?(O=v.x,W=v.y):Xe>0&&(O+=ce*Xe,W+=Me*Xe)),ce=s.x-O,Me=s.y-W,C?ce*ce+Me*Me:new U(O,W)}function we(s){return!_(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function Se(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),we(s)}function ot(s,u){var v,C,O,W,ce,Me,Re,Xe;if(!s||s.length===0)throw new Error("latlngs not passed");we(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var it=be([0,0]),pt=He(s),At=pt.getNorthWest().distanceTo(pt.getSouthWest())*pt.getNorthEast().distanceTo(pt.getNorthWest());At<1700&&(it=is(s));var fo=s.length,Dn=[];for(v=0;v<fo;v++){var Qo=be(s[v]);Dn.push(u.project(be([Qo.lat-it.lat,Qo.lng-it.lng])))}for(v=0,C=0;v<fo-1;v++)C+=Dn[v].distanceTo(Dn[v+1])/2;if(C===0)Xe=Dn[0];else for(v=0,W=0;v<fo-1;v++)if(ce=Dn[v],Me=Dn[v+1],O=ce.distanceTo(Me),W+=O,W>C){Re=(W-C)/O,Xe=[Me.x-Re*(Me.x-ce.x),Me.y-Re*(Me.y-ce.y)];break}var Io=u.unproject(oe(Xe));return be([Io.lat+it.lat,Io.lng+it.lng])}var kt={__proto__:null,simplify:Mi,pointToSegmentDistance:Ai,closestPointOnSegment:pr,clipSegment:Ll,_getEdgeIntersection:ls,_getBitCode:Zo,_sqClosestPointOnSegment:ca,isFlat:we,_flat:Se,polylineCenter:ot},Jt={project:function(s){return new U(s.lng,s.lat)},unproject:function(s){return new We(s.y,s.x)},bounds:new he([-180,-90],[180,90])},kn={R:6378137,R_MINOR:6356752314245179e-9,bounds:new he([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var u=Math.PI/180,v=this.R,C=s.lat*u,O=this.R_MINOR/v,W=Math.sqrt(1-O*O),ce=W*Math.sin(C),Me=Math.tan(Math.PI/4-C/2)/Math.pow((1-ce)/(1+ce),W/2);return C=-v*Math.log(Math.max(Me,1e-10)),new U(s.lng*u*v,C)},unproject:function(s){for(var u=180/Math.PI,v=this.R,C=this.R_MINOR/v,O=Math.sqrt(1-C*C),W=Math.exp(-s.y/v),ce=Math.PI/2-2*Math.atan(W),Me=0,Re=.1,Xe;Me<15&&Math.abs(Re)>1e-7;Me++)Xe=O*Math.sin(ce),Xe=Math.pow((1-Xe)/(1+Xe),O/2),Re=Math.PI/2-2*Math.atan(W*Xe)-ce,ce+=Re;return new We(ce*u,s.x*u/v)}},jn={__proto__:null,LonLat:Jt,Mercator:kn,SphericalMercator:ie},zn=o({},Y,{code:"EPSG:3395",projection:kn,transformation:(function(){var s=.5/(Math.PI*kn.R);return q(s,.5,-s,.5)})()}),Vt=o({},Y,{code:"EPSG:4326",projection:Jt,transformation:q(1/180,1,-1/180,.5)}),wn=o({},V,{projection:Jt,transformation:q(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,u){var v=u.lng-s.lng,C=u.lat-s.lat;return Math.sqrt(v*v+C*C)},infinite:!0});V.Earth=Y,V.EPSG3395=zn,V.EPSG3857=X,V.EPSG900913=ee,V.EPSG4326=Vt,V.Simple=wn;var wt=se.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[d(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[d(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var u=s.target;if(u.hasLayer(this)){if(this._map=u,this._zoomAnimated=u._zoomAnimated,this.getEvents){var v=this.getEvents();u.on(v,this),this.once("remove",function(){u.off(v,this)},this)}this.onAdd(u),this.fire("add"),u.fire("layeradd",{layer:this})}}});Lt.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var u=d(s);return this._layers[u]?this:(this._layers[u]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var u=d(s);return this._layers[u]?(this._loaded&&s.onRemove(this),delete this._layers[u],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return d(s)in this._layers},eachLayer:function(s,u){for(var v in this._layers)s.call(u,this._layers[v]);return this},_addLayers:function(s){s=s?_(s)?s:[s]:[];for(var u=0,v=s.length;u<v;u++)this.addLayer(s[u])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[d(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var u=d(s);this._zoomBoundLayers[u]&&(delete this._zoomBoundLayers[u],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,u=-1/0,v=this._getZoomSpan();for(var C in this._zoomBoundLayers){var O=this._zoomBoundLayers[C].options;s=O.minZoom===void 0?s:Math.min(s,O.minZoom),u=O.maxZoom===void 0?u:Math.max(u,O.maxZoom)}this._layersMaxZoom=u===-1/0?void 0:u,this._layersMinZoom=s===1/0?void 0:s,v!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Xt=wt.extend({initialize:function(s,u){x(this,u),this._layers={};var v,C;if(s)for(v=0,C=s.length;v<C;v++)this.addLayer(s[v])},addLayer:function(s){var u=this.getLayerId(s);return this._layers[u]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var u=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[u]&&this._map.removeLayer(this._layers[u]),delete this._layers[u],this},hasLayer:function(s){var u=typeof s=="number"?s:this.getLayerId(s);return u in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var u=Array.prototype.slice.call(arguments,1),v,C;for(v in this._layers)C=this._layers[v],C[s]&&C[s].apply(C,u);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,u){for(var v in this._layers)s.call(u,this._layers[v]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return d(s)}}),So=function(s,u){return new Xt(s,u)},Pn=Xt.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),Xt.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),Xt.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new je;for(var u in this._layers){var v=this._layers[u];s.extend(v.getBounds?v.getBounds():v.getLatLng())}return s}}),Wn=function(s,u){return new Pn(s,u)},Ko=J.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){x(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,u){var v=this._getIconUrl(s);if(!v){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var C=this._createImg(v,u&&u.tagName==="IMG"?u:null);return this._setIconStyles(C,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(C.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),C},_setIconStyles:function(s,u){var v=this.options,C=v[u+"Size"];typeof C=="number"&&(C=[C,C]);var O=oe(C),W=oe(u==="shadow"&&v.shadowAnchor||v.iconAnchor||O&&O.divideBy(2,!0));s.className="leaflet-marker-"+u+" "+(v.className||""),W&&(s.style.marginLeft=-W.x+"px",s.style.marginTop=-W.y+"px"),O&&(s.style.width=O.x+"px",s.style.height=O.y+"px")},_createImg:function(s,u){return u=u||document.createElement("img"),u.src=s,u},_getIconUrl:function(s){return Qe.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function Di(s){return new Ko(s)}var Fa=Ko.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof Fa.imagePath!="string"&&(Fa.imagePath=this._detectIconPath()),(this.options.imagePath||Fa.imagePath)+Ko.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var u=function(v,C,O){var W=C.exec(v);return W&&W[O]};return s=u(s,/^url\((['"])?(.+)\1\)$/,2),s&&u(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=_t("div","leaflet-default-icon-path",document.body),u=_n(s,"background-image")||_n(s,"backgroundImage");if(document.body.removeChild(s),u=this._stripUrl(u),u)return u;var v=document.querySelector('link[href$="leaflet.css"]');return v?v.href.substring(0,v.href.length-11-1):""}}),bc=ho.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new Oo(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),yt(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Ft(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var u=this._marker,v=u._map,C=this._marker.options.autoPanSpeed,O=this._marker.options.autoPanPadding,W=Wo(u._icon),ce=v.getPixelBounds(),Me=v.getPixelOrigin(),Re=Te(ce.min._subtract(Me).add(O),ce.max._subtract(Me).subtract(O));if(!Re.contains(W)){var Xe=oe((Math.max(Re.max.x,W.x)-Re.max.x)/(ce.max.x-Re.max.x)-(Math.min(Re.min.x,W.x)-Re.min.x)/(ce.min.x-Re.min.x),(Math.max(Re.max.y,W.y)-Re.max.y)/(ce.max.y-Re.max.y)-(Math.min(Re.min.y,W.y)-Re.min.y)/(ce.min.y-Re.min.y)).multiplyBy(C);v.panBy(Xe,{animate:!1}),this._draggable._newPos._add(Xe),this._draggable._startPos._add(Xe),on(u._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=F(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(j(this._panRequest),this._panRequest=F(this._adjustPan.bind(this,s)))},_onDrag:function(s){var u=this._marker,v=u._shadow,C=Wo(u._icon),O=u._map.layerPointToLatLng(C);v&&on(v,C),u._latlng=O,s.latlng=O,s.oldLatLng=this._oldLatLng,u.fire("move",s).fire("drag",s)},_onDragEnd:function(s){j(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),Ri=wt.extend({options:{icon:new Fa,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,u){x(this,u),this._latlng=be(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var u=this._latlng;return this._latlng=be(s),this.update(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,u="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),v=s.icon.createIcon(this._icon),C=!1;v!==this._icon&&(this._icon&&this._removeIcon(),C=!0,s.title&&(v.title=s.title),v.tagName==="IMG"&&(v.alt=s.alt||"")),yt(v,u),s.keyboard&&(v.tabIndex="0",v.setAttribute("role","button")),this._icon=v,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&rt(v,"focus",this._panOnFocus,this);var O=s.icon.createShadow(this._shadow),W=!1;O!==this._shadow&&(this._removeShadow(),W=!0),O&&(yt(O,u),O.alt=""),this._shadow=O,s.opacity<1&&this._updateOpacity(),C&&this.getPane().appendChild(this._icon),this._initInteraction(),O&&W&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ut(this._icon,"focus",this._panOnFocus,this),Mt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Mt(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&on(this._icon,s),this._shadow&&on(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var u=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(u)},_initInteraction:function(){if(this.options.interactive&&(yt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),bc)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new bc(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&fn(this._icon,s),this._shadow&&fn(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var u=this.options.icon.options,v=u.iconSize?oe(u.iconSize):oe(0,0),C=u.iconAnchor?oe(u.iconAnchor):oe(0,0);s.panInside(this._latlng,{paddingTopLeft:C,paddingBottomRight:v.subtract(C)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function od(s,u){return new Ri(s,u)}var ua=wt.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return x(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Il=ua.extend({options:{fill:!0,radius:10},initialize:function(s,u){x(this,u),this._latlng=be(s),this._radius=this.options.radius},setLatLng:function(s){var u=this._latlng;return this._latlng=be(s),this.redraw(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var u=s&&s.radius||this._radius;return ua.prototype.setStyle.call(this,s),this.setRadius(u),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,u=this._radiusY||s,v=this._clickTolerance(),C=[s+v,u+v];this._pxBounds=new he(this._point.subtract(C),this._point.add(C))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function ad(s,u){return new Il(s,u)}var vr=Il.extend({initialize:function(s,u,v){if(typeof u=="number"&&(u=o({},v,{radius:u})),x(this,u),this._latlng=be(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new je(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:ua.prototype.setStyle,_project:function(){var s=this._latlng.lng,u=this._latlng.lat,v=this._map,C=v.options.crs;if(C.distance===Y.distance){var O=Math.PI/180,W=this._mRadius/Y.R/O,ce=v.project([u+W,s]),Me=v.project([u-W,s]),Re=ce.add(Me).divideBy(2),Xe=v.unproject(Re).lat,it=Math.acos((Math.cos(W*O)-Math.sin(u*O)*Math.sin(Xe*O))/(Math.cos(u*O)*Math.cos(Xe*O)))/O;(isNaN(it)||it===0)&&(it=W/Math.cos(Math.PI/180*u)),this._point=Re.subtract(v.getPixelOrigin()),this._radius=isNaN(it)?0:Re.x-v.project([Xe,s-it]).x,this._radiusY=Re.y-ce.y}else{var pt=C.unproject(C.project(this._latlng).subtract([this._mRadius,0]));this._point=v.latLngToLayerPoint(this._latlng),this._radius=this._point.x-v.latLngToLayerPoint(pt).x}this._updateBounds()}});function sd(s,u,v){return new vr(s,u,v)}var da=ua.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,u){x(this,u),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var u=1/0,v=null,C=ca,O,W,ce=0,Me=this._parts.length;ce<Me;ce++)for(var Re=this._parts[ce],Xe=1,it=Re.length;Xe<it;Xe++){O=Re[Xe-1],W=Re[Xe];var pt=C(s,O,W,!0);pt<u&&(u=pt,v=C(s,O,W))}return v&&(v.distance=Math.sqrt(u)),v},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ot(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,u){return u=u||this._defaultShape(),s=be(s),u.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new je,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return we(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var u=[],v=we(s),C=0,O=s.length;C<O;C++)v?(u[C]=be(s[C]),this._bounds.extend(u[C])):u[C]=this._convertLatLngs(s[C]);return u},_project:function(){var s=new he;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),u=new U(s,s);this._rawPxBounds&&(this._pxBounds=new he([this._rawPxBounds.min.subtract(u),this._rawPxBounds.max.add(u)]))},_projectLatlngs:function(s,u,v){var C=s[0]instanceof We,O=s.length,W,ce;if(C){for(ce=[],W=0;W<O;W++)ce[W]=this._map.latLngToLayerPoint(s[W]),v.extend(ce[W]);u.push(ce)}else for(W=0;W<O;W++)this._projectLatlngs(s[W],u,v)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var u=this._parts,v,C,O,W,ce,Me,Re;for(v=0,O=0,W=this._rings.length;v<W;v++)for(Re=this._rings[v],C=0,ce=Re.length;C<ce-1;C++)Me=Ll(Re[C],Re[C+1],s,C,!0),Me&&(u[O]=u[O]||[],u[O].push(Me[0]),(Me[1]!==Re[C+1]||C===ce-2)&&(u[O].push(Me[1]),O++))}},_simplifyPoints:function(){for(var s=this._parts,u=this.options.smoothFactor,v=0,C=s.length;v<C;v++)s[v]=Mi(s[v],u)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,u){var v,C,O,W,ce,Me,Re=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(v=0,W=this._parts.length;v<W;v++)for(Me=this._parts[v],C=0,ce=Me.length,O=ce-1;C<ce;O=C++)if(!(!u&&C===0)&&Ai(s,Me[O],Me[C])<=Re)return!0;return!1}});function id(s,u){return new da(s,u)}da._flat=Se;var Gs=da.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ss(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var u=da.prototype._convertLatLngs.call(this,s),v=u.length;return v>=2&&u[0]instanceof We&&u[0].equals(u[v-1])&&u.pop(),u},_setLatLngs:function(s){da.prototype._setLatLngs.call(this,s),we(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return we(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,u=this.options.weight,v=new U(u,u);if(s=new he(s.min.subtract(v),s.max.add(v)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var C=0,O=this._rings.length,W;C<O;C++)W=Hs(this._rings[C],s,!0),W.length&&this._parts.push(W)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var u=!1,v,C,O,W,ce,Me,Re,Xe;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(W=0,Re=this._parts.length;W<Re;W++)for(v=this._parts[W],ce=0,Xe=v.length,Me=Xe-1;ce<Xe;Me=ce++)C=v[ce],O=v[Me],C.y>s.y!=O.y>s.y&&s.x<(O.x-C.x)*(s.y-C.y)/(O.y-C.y)+C.x&&(u=!u);return u||da.prototype._containsPoint.call(this,s,!0)}});function ld(s,u){return new Gs(s,u)}var ha=Pn.extend({initialize:function(s,u){x(this,u),this._layers={},s&&this.addData(s)},addData:function(s){var u=_(s)?s:s.features,v,C,O;if(u){for(v=0,C=u.length;v<C;v++)O=u[v],(O.geometries||O.geometry||O.features||O.coordinates)&&this.addData(O);return this}var W=this.options;if(W.filter&&!W.filter(s))return this;var ce=xl(s,W);return ce?(ce.feature=Oi(s),ce.defaultOptions=ce.options,this.resetStyle(ce),W.onEachFeature&&W.onEachFeature(s,ce),this.addLayer(ce)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=o({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(u){this._setLayerStyle(u,s)},this)},_setLayerStyle:function(s,u){s.setStyle&&(typeof u=="function"&&(u=u(s.feature)),s.setStyle(u))}});function xl(s,u){var v=s.type==="Feature"?s.geometry:s,C=v?v.coordinates:null,O=[],W=u&&u.pointToLayer,ce=u&&u.coordsToLatLng||mr,Me,Re,Xe,it;if(!C&&!v)return null;switch(v.type){case"Point":return Me=ce(C),_c(W,s,Me,u);case"MultiPoint":for(Xe=0,it=C.length;Xe<it;Xe++)Me=ce(C[Xe]),O.push(_c(W,s,Me,u));return new Pn(O);case"LineString":case"MultiLineString":return Re=rs(C,v.type==="LineString"?0:1,ce),new da(Re,u);case"Polygon":case"MultiPolygon":return Re=rs(C,v.type==="Polygon"?1:2,ce),new Gs(Re,u);case"GeometryCollection":for(Xe=0,it=v.geometries.length;Xe<it;Xe++){var pt=xl({geometry:v.geometries[Xe],type:"Feature",properties:s.properties},u);pt&&O.push(pt)}return new Pn(O);case"FeatureCollection":for(Xe=0,it=v.features.length;Xe<it;Xe++){var At=xl(v.features[Xe],u);At&&O.push(At)}return new Pn(O);default:throw new Error("Invalid GeoJSON object.")}}function _c(s,u,v,C){return s?s(u,v):new Ri(v,C&&C.markersInheritOptions&&C)}function mr(s){return new We(s[1],s[0],s[2])}function rs(s,u,v){for(var C=[],O=0,W=s.length,ce;O<W;O++)ce=u?rs(s[O],u-1,v):(v||mr)(s[O]),C.push(ce);return C}function gr(s,u){return s=be(s),s.alt!==void 0?[y(s.lng,u),y(s.lat,u),y(s.alt,u)]:[y(s.lng,u),y(s.lat,u)]}function cs(s,u,v,C){for(var O=[],W=0,ce=s.length;W<ce;W++)O.push(u?cs(s[W],we(s[W])?0:u-1,v,C):gr(s[W],C));return!u&&v&&O.length>0&&O.push(O[0].slice()),O}function qs(s,u){return s.feature?o({},s.feature,{geometry:u}):Oi(u)}function Oi(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var Bi={toGeoJSON:function(s){return qs(this,{type:"Point",coordinates:gr(this.getLatLng(),s)})}};Ri.include(Bi),vr.include(Bi),Il.include(Bi),da.include({toGeoJSON:function(s){var u=!we(this._latlngs),v=cs(this._latlngs,u?1:0,!1,s);return qs(this,{type:(u?"Multi":"")+"LineString",coordinates:v})}}),Gs.include({toGeoJSON:function(s){var u=!we(this._latlngs),v=u&&!we(this._latlngs[0]),C=cs(this._latlngs,v?2:u?1:0,!0,s);return u||(C=[C]),qs(this,{type:(v?"Multi":"")+"Polygon",coordinates:C})}}),Xt.include({toMultiPoint:function(s){var u=[];return this.eachLayer(function(v){u.push(v.toGeoJSON(s).geometry.coordinates)}),qs(this,{type:"MultiPoint",coordinates:u})},toGeoJSON:function(s){var u=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(u==="MultiPoint")return this.toMultiPoint(s);var v=u==="GeometryCollection",C=[];return this.eachLayer(function(O){if(O.toGeoJSON){var W=O.toGeoJSON(s);if(v)C.push(W.geometry);else{var ce=Oi(W);ce.type==="FeatureCollection"?C.push.apply(C,ce.features):C.push(ce)}}}),v?qs(this,{geometries:C,type:"GeometryCollection"}):{type:"FeatureCollection",features:C}}});function $l(s,u){return new ha(s,u)}var rd=$l,Tl=wt.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,u,v){this._url=s,this._bounds=He(u),x(this,v)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(yt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Mt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&io(this._image),this},bringToBack:function(){return this._map&&Un(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=He(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",u=this._image=s?this._url:_t("img");if(yt(u,"leaflet-image-layer"),this._zoomAnimated&&yt(u,"leaflet-zoom-animated"),this.options.className&&yt(u,this.options.className),u.onselectstart=m,u.onmousemove=m,u.onload=l(this.fire,this,"load"),u.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(u.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=u.src;return}u.src=this._url,u.alt=this.options.alt},_animateZoom:function(s){var u=this._map.getZoomScale(s.zoom),v=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;qn(this._image,v,u)},_reset:function(){var s=this._image,u=new he(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),v=u.getSize();on(s,u.min),s.style.width=v.x+"px",s.style.height=v.y+"px"},_updateOpacity:function(){fn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),cd=function(s,u,v){return new Tl(s,u,v)},wc=Tl.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",u=this._image=s?this._url:_t("video");if(yt(u,"leaflet-image-layer"),this._zoomAnimated&&yt(u,"leaflet-zoom-animated"),this.options.className&&yt(u,this.options.className),u.onselectstart=m,u.onmousemove=m,u.onloadeddata=l(this.fire,this,"load"),s){for(var v=u.getElementsByTagName("source"),C=[],O=0;O<v.length;O++)C.push(v[O].src);this._url=v.length>0?C:[u.src];return}_(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(u.style,"objectFit")&&(u.style.objectFit="fill"),u.autoplay=!!this.options.autoplay,u.loop=!!this.options.loop,u.muted=!!this.options.muted,u.playsInline=!!this.options.playsInline;for(var W=0;W<this._url.length;W++){var ce=_t("source");ce.src=this._url[W],u.appendChild(ce)}}});function ud(s,u,v){return new wc(s,u,v)}var Cc=Tl.extend({_initImage:function(){var s=this._image=this._url;yt(s,"leaflet-image-layer"),this._zoomAnimated&&yt(s,"leaflet-zoom-animated"),this.options.className&&yt(s,this.options.className),s.onselectstart=m,s.onmousemove=m}});function dd(s,u,v){return new Cc(s,u,v)}var Yo=wt.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,u){s&&(s instanceof We||_(s))?(this._latlng=be(s),x(this,u)):(x(this,s),this._source=u),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&fn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&fn(this._container,1),this.bringToFront(),this.options.interactive&&(yt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(fn(this._container,0),this._removeTimeout=setTimeout(l(Mt,void 0,this._container),200)):Mt(this._container),this.options.interactive&&(Ft(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=be(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&io(this._container),this},bringToBack:function(){return this._map&&Un(this._container),this},_prepareOpen:function(s){var u=this._source;if(!u._map)return!1;if(u instanceof Pn){u=null;var v=this._source._layers;for(var C in v)if(v[C]._map){u=v[C];break}if(!u)return!1;this._source=u}if(!s)if(u.getCenter)s=u.getCenter();else if(u.getLatLng)s=u.getLatLng();else if(u.getBounds)s=u.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,u=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof u=="string")s.innerHTML=u;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(u)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),u=oe(this.options.offset),v=this._getAnchor();this._zoomAnimated?on(this._container,s.add(v)):u=u.add(s).add(v);var C=this._containerBottom=-u.y,O=this._containerLeft=-Math.round(this._containerWidth/2)+u.x;this._container.style.bottom=C+"px",this._container.style.left=O+"px"}},_getAnchor:function(){return[0,0]}});Lt.include({_initOverlay:function(s,u,v,C){var O=u;return O instanceof s||(O=new s(C).setContent(u)),v&&O.setLatLng(v),O}}),wt.include({_initOverlay:function(s,u,v,C){var O=v;return O instanceof s?(x(O,C),O._source=this):(O=u&&!C?u:new s(C,this),O.setContent(v)),O}});var Ml=Yo.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,Yo.prototype.openOn.call(this,s)},onAdd:function(s){Yo.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ua||this._source.on("preclick",vn))},onRemove:function(s){Yo.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ua||this._source.off("preclick",vn))},getEvents:function(){var s=Yo.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",u=this._container=_t("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),v=this._wrapper=_t("div",s+"-content-wrapper",u);if(this._contentNode=_t("div",s+"-content",v),Ro(u),ra(this._contentNode),rt(u,"contextmenu",vn),this._tipContainer=_t("div",s+"-tip-container",u),this._tip=_t("div",s+"-tip",this._tipContainer),this.options.closeButton){var C=this._closeButton=_t("a",s+"-close-button",u);C.setAttribute("role","button"),C.setAttribute("aria-label","Close popup"),C.href="#close",C.innerHTML='<span aria-hidden="true">&#215;</span>',rt(C,"click",function(O){Zt(O),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,u=s.style;u.width="",u.whiteSpace="nowrap";var v=s.offsetWidth;v=Math.min(v,this.options.maxWidth),v=Math.max(v,this.options.minWidth),u.width=v+1+"px",u.whiteSpace="",u.height="";var C=s.offsetHeight,O=this.options.maxHeight,W="leaflet-popup-scrolled";O&&C>O?(u.height=O+"px",yt(s,W)):Ft(s,W),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var u=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),v=this._getAnchor();on(this._container,u.add(v))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,u=parseInt(_n(this._container,"marginBottom"),10)||0,v=this._container.offsetHeight+u,C=this._containerWidth,O=new U(this._containerLeft,-v-this._containerBottom);O._add(Wo(this._container));var W=s.layerPointToContainerPoint(O),ce=oe(this.options.autoPanPadding),Me=oe(this.options.autoPanPaddingTopLeft||ce),Re=oe(this.options.autoPanPaddingBottomRight||ce),Xe=s.getSize(),it=0,pt=0;W.x+C+Re.x>Xe.x&&(it=W.x+C-Xe.x+Re.x),W.x-it-Me.x<0&&(it=W.x-Me.x),W.y+v+Re.y>Xe.y&&(pt=W.y+v-Xe.y+Re.y),W.y-pt-Me.y<0&&(pt=W.y-Me.y),(it||pt)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([it,pt]))}},_getAnchor:function(){return oe(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),hd=function(s,u){return new Ml(s,u)};Lt.mergeOptions({closePopupOnClick:!0}),Lt.include({openPopup:function(s,u,v){return this._initOverlay(Ml,s,u,v).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),wt.include({bindPopup:function(s,u){return this._popup=this._initOverlay(Ml,this._popup,s,u),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof Pn||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){ro(s);var u=s.layer||s.target;if(this._popup._source===u&&!(u instanceof ua)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=u,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var Ni=Yo.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){Yo.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){Yo.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=Yo.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",u=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=_t("div",u),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var u,v,C=this._map,O=this._container,W=C.latLngToContainerPoint(C.getCenter()),ce=C.layerPointToContainerPoint(s),Me=this.options.direction,Re=O.offsetWidth,Xe=O.offsetHeight,it=oe(this.options.offset),pt=this._getAnchor();Me==="top"?(u=Re/2,v=Xe):Me==="bottom"?(u=Re/2,v=0):Me==="center"?(u=Re/2,v=Xe/2):Me==="right"?(u=0,v=Xe/2):Me==="left"?(u=Re,v=Xe/2):ce.x<W.x?(Me="right",u=0,v=Xe/2):(Me="left",u=Re+(it.x+pt.x)*2,v=Xe/2),s=s.subtract(oe(u,v,!0)).add(it).add(pt),Ft(O,"leaflet-tooltip-right"),Ft(O,"leaflet-tooltip-left"),Ft(O,"leaflet-tooltip-top"),Ft(O,"leaflet-tooltip-bottom"),yt(O,"leaflet-tooltip-"+Me),on(O,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&fn(this._container,s)},_animateZoom:function(s){var u=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(u)},_getAnchor:function(){return oe(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),fd=function(s,u){return new Ni(s,u)};Lt.include({openTooltip:function(s,u,v){return this._initOverlay(Ni,s,u,v).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),wt.include({bindTooltip:function(s,u){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Ni,this._tooltip,s,u),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var u=s?"off":"on",v={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?v.add=this._openTooltip:(v.mouseover=this._openTooltip,v.mouseout=this.closeTooltip,v.click=this._openTooltip,this._map?this._addFocusListeners():v.add=this._addFocusListeners),this._tooltip.options.sticky&&(v.mousemove=this._moveTooltip),this[u](v),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof Pn||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var u=typeof s.getElement=="function"&&s.getElement();u&&(rt(u,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),rt(u,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var u=typeof s.getElement=="function"&&s.getElement();u&&u.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var u=this;this._map.once("moveend",function(){u._openOnceFlag=!1,u._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var u=s.latlng,v,C;this._tooltip.options.sticky&&s.originalEvent&&(v=this._map.mouseEventToContainerPoint(s.originalEvent),C=this._map.containerPointToLayerPoint(v),u=this._map.layerPointToLatLng(C)),this._tooltip.setLatLng(u)}});var yr=Ko.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var u=s&&s.tagName==="DIV"?s:document.createElement("div"),v=this.options;if(v.html instanceof Element?(Fn(u),u.appendChild(v.html)):u.innerHTML=v.html!==!1?v.html:"",v.bgPos){var C=oe(v.bgPos);u.style.backgroundPosition=-C.x+"px "+-C.y+"px"}return this._setIconStyles(u,"icon"),u},createShadow:function(){return null}});function pd(s){return new yr(s)}Ko.Default=Fa;var Fi=wt.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Qe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){x(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),Mt(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(io(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Un(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=h(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof U?s:new U(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var u=this.getPane().children,v=-s(-1/0,1/0),C=0,O=u.length,W;C<O;C++)W=u[C].style.zIndex,u[C]!==this._container&&W&&(v=s(v,+W));isFinite(v)&&(this.options.zIndex=v+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Qe.ielt9){fn(this._container,this.options.opacity);var s=+new Date,u=!1,v=!1;for(var C in this._tiles){var O=this._tiles[C];if(!(!O.current||!O.loaded)){var W=Math.min(1,(s-O.loaded)/200);fn(O.el,W),W<1?u=!0:(O.active?v=!0:this._onOpaqueTile(O),O.active=!0)}}v&&!this._noPrune&&this._pruneTiles(),u&&(j(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=_t("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,u=this.options.maxZoom;if(s!==void 0){for(var v in this._levels)v=Number(v),this._levels[v].el.children.length||v===s?(this._levels[v].el.style.zIndex=u-Math.abs(s-v),this._onUpdateLevel(v)):(Mt(this._levels[v].el),this._removeTilesAtZoom(v),this._onRemoveLevel(v),delete this._levels[v]);var C=this._levels[s],O=this._map;return C||(C=this._levels[s]={},C.el=_t("div","leaflet-tile-container leaflet-zoom-animated",this._container),C.el.style.zIndex=u,C.origin=O.project(O.unproject(O.getPixelOrigin()),s).round(),C.zoom=s,this._setZoomTransform(C,O.getCenter(),O.getZoom()),m(C.el.offsetWidth),this._onCreateLevel(C)),this._level=C,C}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var s,u,v=this._map.getZoom();if(v>this.options.maxZoom||v<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)u=this._tiles[s],u.retain=u.current;for(s in this._tiles)if(u=this._tiles[s],u.current&&!u.active){var C=u.coords;this._retainParent(C.x,C.y,C.z,C.z-5)||this._retainChildren(C.x,C.y,C.z,C.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var u in this._tiles)this._tiles[u].coords.z===s&&this._removeTile(u)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)Mt(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,u,v,C){var O=Math.floor(s/2),W=Math.floor(u/2),ce=v-1,Me=new U(+O,+W);Me.z=+ce;var Re=this._tileCoordsToKey(Me),Xe=this._tiles[Re];return Xe&&Xe.active?(Xe.retain=!0,!0):(Xe&&Xe.loaded&&(Xe.retain=!0),ce>C?this._retainParent(O,W,ce,C):!1)},_retainChildren:function(s,u,v,C){for(var O=2*s;O<2*s+2;O++)for(var W=2*u;W<2*u+2;W++){var ce=new U(O,W);ce.z=v+1;var Me=this._tileCoordsToKey(ce),Re=this._tiles[Me];if(Re&&Re.active){Re.retain=!0;continue}else Re&&Re.loaded&&(Re.retain=!0);v+1<C&&this._retainChildren(O,W,v+1,C)}},_resetView:function(s){var u=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),u,u)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var u=this.options;return u.minNativeZoom!==void 0&&s<u.minNativeZoom?u.minNativeZoom:u.maxNativeZoom!==void 0&&u.maxNativeZoom<s?u.maxNativeZoom:s},_setView:function(s,u,v,C){var O=Math.round(u);this.options.maxZoom!==void 0&&O>this.options.maxZoom||this.options.minZoom!==void 0&&O<this.options.minZoom?O=void 0:O=this._clampZoom(O);var W=this.options.updateWhenZooming&&O!==this._tileZoom;(!C||W)&&(this._tileZoom=O,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),O!==void 0&&this._update(s),v||this._pruneTiles(),this._noPrune=!!v),this._setZoomTransforms(s,u)},_setZoomTransforms:function(s,u){for(var v in this._levels)this._setZoomTransform(this._levels[v],s,u)},_setZoomTransform:function(s,u,v){var C=this._map.getZoomScale(v,s.zoom),O=s.origin.multiplyBy(C).subtract(this._map._getNewPixelOrigin(u,v)).round();Qe.any3d?qn(s.el,O,C):on(s.el,O)},_resetGrid:function(){var s=this._map,u=s.options.crs,v=this._tileSize=this.getTileSize(),C=this._tileZoom,O=this._map.getPixelWorldBounds(this._tileZoom);O&&(this._globalTileRange=this._pxBoundsToTileRange(O)),this._wrapX=u.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,u.wrapLng[0]],C).x/v.x),Math.ceil(s.project([0,u.wrapLng[1]],C).x/v.y)],this._wrapY=u.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([u.wrapLat[0],0],C).y/v.x),Math.ceil(s.project([u.wrapLat[1],0],C).y/v.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var u=this._map,v=u._animatingZoom?Math.max(u._animateToZoom,u.getZoom()):u.getZoom(),C=u.getZoomScale(v,this._tileZoom),O=u.project(s,this._tileZoom).floor(),W=u.getSize().divideBy(C*2);return new he(O.subtract(W),O.add(W))},_update:function(s){var u=this._map;if(u){var v=this._clampZoom(u.getZoom());if(s===void 0&&(s=u.getCenter()),this._tileZoom!==void 0){var C=this._getTiledPixelBounds(s),O=this._pxBoundsToTileRange(C),W=O.getCenter(),ce=[],Me=this.options.keepBuffer,Re=new he(O.getBottomLeft().subtract([Me,-Me]),O.getTopRight().add([Me,-Me]));if(!(isFinite(O.min.x)&&isFinite(O.min.y)&&isFinite(O.max.x)&&isFinite(O.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Xe in this._tiles){var it=this._tiles[Xe].coords;(it.z!==this._tileZoom||!Re.contains(new U(it.x,it.y)))&&(this._tiles[Xe].current=!1)}if(Math.abs(v-this._tileZoom)>1){this._setView(s,v);return}for(var pt=O.min.y;pt<=O.max.y;pt++)for(var At=O.min.x;At<=O.max.x;At++){var fo=new U(At,pt);if(fo.z=this._tileZoom,!!this._isValidTile(fo)){var Dn=this._tiles[this._tileCoordsToKey(fo)];Dn?Dn.current=!0:ce.push(fo)}}if(ce.sort(function(Io,Pl){return Io.distanceTo(W)-Pl.distanceTo(W)}),ce.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Qo=document.createDocumentFragment();for(At=0;At<ce.length;At++)this._addTile(ce[At],Qo);this._level.el.appendChild(Qo)}}}},_isValidTile:function(s){var u=this._map.options.crs;if(!u.infinite){var v=this._globalTileRange;if(!u.wrapLng&&(s.x<v.min.x||s.x>v.max.x)||!u.wrapLat&&(s.y<v.min.y||s.y>v.max.y))return!1}if(!this.options.bounds)return!0;var C=this._tileCoordsToBounds(s);return He(this.options.bounds).overlaps(C)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var u=this._map,v=this.getTileSize(),C=s.scaleBy(v),O=C.add(v),W=u.unproject(C,s.z),ce=u.unproject(O,s.z);return[W,ce]},_tileCoordsToBounds:function(s){var u=this._tileCoordsToNwSe(s),v=new je(u[0],u[1]);return this.options.noWrap||(v=this._map.wrapLatLngBounds(v)),v},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var u=s.split(":"),v=new U(+u[0],+u[1]);return v.z=+u[2],v},_removeTile:function(s){var u=this._tiles[s];u&&(Mt(u.el),delete this._tiles[s],this.fire("tileunload",{tile:u.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){yt(s,"leaflet-tile");var u=this.getTileSize();s.style.width=u.x+"px",s.style.height=u.y+"px",s.onselectstart=m,s.onmousemove=m,Qe.ielt9&&this.options.opacity<1&&fn(s,this.options.opacity)},_addTile:function(s,u){var v=this._getTilePos(s),C=this._tileCoordsToKey(s),O=this.createTile(this._wrapCoords(s),l(this._tileReady,this,s));this._initTile(O),this.createTile.length<2&&F(l(this._tileReady,this,s,null,O)),on(O,v),this._tiles[C]={el:O,coords:s,current:!0},u.appendChild(O),this.fire("tileloadstart",{tile:O,coords:s})},_tileReady:function(s,u,v){u&&this.fire("tileerror",{error:u,tile:v,coords:s});var C=this._tileCoordsToKey(s);v=this._tiles[C],v&&(v.loaded=+new Date,this._map._fadeAnimated?(fn(v.el,0),j(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this)):(v.active=!0,this._pruneTiles()),u||(yt(v.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:v.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Qe.ielt9||!this._map._fadeAnimated?F(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var u=new U(this._wrapX?f(s.x,this._wrapX):s.x,this._wrapY?f(s.y,this._wrapY):s.y);return u.z=s.z,u},_pxBoundsToTileRange:function(s){var u=this.getTileSize();return new he(s.min.unscaleBy(u).floor(),s.max.unscaleBy(u).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function vd(s){return new Fi(s)}var Ua=Fi.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,u){this._url=s,u=x(this,u),u.detectRetina&&Qe.retina&&u.maxZoom>0?(u.tileSize=Math.floor(u.tileSize/2),u.zoomReverse?(u.zoomOffset--,u.minZoom=Math.min(u.maxZoom,u.minZoom+1)):(u.zoomOffset++,u.maxZoom=Math.max(u.minZoom,u.maxZoom-1)),u.minZoom=Math.max(0,u.minZoom)):u.zoomReverse?u.minZoom=Math.min(u.maxZoom,u.minZoom):u.maxZoom=Math.max(u.minZoom,u.maxZoom),typeof u.subdomains=="string"&&(u.subdomains=u.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,u){return this._url===s&&u===void 0&&(u=!0),this._url=s,u||this.redraw(),this},createTile:function(s,u){var v=document.createElement("img");return rt(v,"load",l(this._tileOnLoad,this,u,v)),rt(v,"error",l(this._tileOnError,this,u,v)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(v.referrerPolicy=this.options.referrerPolicy),v.alt="",v.src=this.getTileUrl(s),v},getTileUrl:function(s){var u={r:Qe.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var v=this._globalTileRange.max.y-s.y;this.options.tms&&(u.y=v),u["-y"]=v}return w(this._url,o(u,this.options))},_tileOnLoad:function(s,u){Qe.ielt9?setTimeout(l(s,this,null,u),0):s(null,u)},_tileOnError:function(s,u,v){var C=this.options.errorTileUrl;C&&u.getAttribute("src")!==C&&(u.src=C),s(v,u)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,u=this.options.maxZoom,v=this.options.zoomReverse,C=this.options.zoomOffset;return v&&(s=u-s),s+C},_getSubdomain:function(s){var u=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[u]},_abortLoading:function(){var s,u;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(u=this._tiles[s].el,u.onload=m,u.onerror=m,!u.complete)){u.src=T;var v=this._tiles[s].coords;Mt(u),delete this._tiles[s],this.fire("tileabort",{tile:u,coords:v})}},_removeTile:function(s){var u=this._tiles[s];if(u)return u.el.setAttribute("src",T),Fi.prototype._removeTile.call(this,s)},_tileReady:function(s,u,v){if(!(!this._map||v&&v.getAttribute("src")===T))return Fi.prototype._tileReady.call(this,s,u,v)}});function Lc(s,u){return new Ua(s,u)}var Sc=Ua.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,u){this._url=s;var v=o({},this.defaultWmsParams);for(var C in u)C in this.options||(v[C]=u[C]);u=x(this,u);var O=u.detectRetina&&Qe.retina?2:1,W=this.getTileSize();v.width=W.x*O,v.height=W.y*O,this.wmsParams=v},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var u=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[u]=this._crs.code,Ua.prototype.onAdd.call(this,s)},getTileUrl:function(s){var u=this._tileCoordsToNwSe(s),v=this._crs,C=Te(v.project(u[0]),v.project(u[1])),O=C.min,W=C.max,ce=(this._wmsVersion>=1.3&&this._crs===Vt?[O.y,O.x,W.y,W.x]:[O.x,O.y,W.x,W.y]).join(","),Me=Ua.prototype.getTileUrl.call(this,s);return Me+E(this.wmsParams,Me,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ce},setParams:function(s,u){return o(this.wmsParams,s),u||this.redraw(),this}});function md(s,u){return new Sc(s,u)}Ua.WMS=Sc,Lc.wms=md;var Jo=wt.extend({options:{padding:.1},initialize:function(s){x(this,s),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),yt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,u){var v=this._map.getZoomScale(u,this._zoom),C=this._map.getSize().multiplyBy(.5+this.options.padding),O=this._map.project(this._center,u),W=C.multiplyBy(-v).add(O).subtract(this._map._getNewPixelOrigin(s,u));Qe.any3d?qn(this._container,W,v):on(this._container,W)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,u=this._map.getSize(),v=this._map.containerPointToLayerPoint(u.multiplyBy(-s)).round();this._bounds=new he(v,v.add(u.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ic=Jo.extend({options:{tolerance:0},getEvents:function(){var s=Jo.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Jo.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");rt(s,"mousemove",this._onMouseMove,this),rt(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),rt(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){j(this._redrawRequest),delete this._ctx,Mt(this._container),Ut(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var u in this._layers)s=this._layers[u],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Jo.prototype._update.call(this);var s=this._bounds,u=this._container,v=s.getSize(),C=Qe.retina?2:1;on(u,s.min),u.width=C*v.x,u.height=C*v.y,u.style.width=v.x+"px",u.style.height=v.y+"px",Qe.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){Jo.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[d(s)]=s;var u=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=u),this._drawLast=u,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var u=s._order,v=u.next,C=u.prev;v?v.prev=C:this._drawLast=C,C?C.next=v:this._drawFirst=v,delete s._order,delete this._layers[d(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var u=s.options.dashArray.split(/[, ]+/),v=[],C,O;for(O=0;O<u.length;O++){if(C=Number(u[O]),isNaN(C))return;v.push(C)}s.options._dashArray=v}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||F(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var u=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new he,this._redrawBounds.extend(s._pxBounds.min.subtract([u,u])),this._redrawBounds.extend(s._pxBounds.max.add([u,u]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var u=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,u.x,u.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,u=this._redrawBounds;if(this._ctx.save(),u){var v=u.getSize();this._ctx.beginPath(),this._ctx.rect(u.min.x,u.min.y,v.x,v.y),this._ctx.clip()}this._drawing=!0;for(var C=this._drawFirst;C;C=C.next)s=C.layer,(!u||s._pxBounds&&s._pxBounds.intersects(u))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,u){if(this._drawing){var v,C,O,W,ce=s._parts,Me=ce.length,Re=this._ctx;if(Me){for(Re.beginPath(),v=0;v<Me;v++){for(C=0,O=ce[v].length;C<O;C++)W=ce[v][C],Re[C?"lineTo":"moveTo"](W.x,W.y);u&&Re.closePath()}this._fillStroke(Re,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var u=s._point,v=this._ctx,C=Math.max(Math.round(s._radius),1),O=(Math.max(Math.round(s._radiusY),1)||C)/C;O!==1&&(v.save(),v.scale(1,O)),v.beginPath(),v.arc(u.x,u.y/O,C,0,Math.PI*2,!1),O!==1&&v.restore(),this._fillStroke(v,s)}},_fillStroke:function(s,u){var v=u.options;v.fill&&(s.globalAlpha=v.fillOpacity,s.fillStyle=v.fillColor||v.color,s.fill(v.fillRule||"evenodd")),v.stroke&&v.weight!==0&&(s.setLineDash&&s.setLineDash(u.options&&u.options._dashArray||[]),s.globalAlpha=v.opacity,s.lineWidth=v.weight,s.strokeStyle=v.color,s.lineCap=v.lineCap,s.lineJoin=v.lineJoin,s.stroke())},_onClick:function(s){for(var u=this._map.mouseEventToLayerPoint(s),v,C,O=this._drawFirst;O;O=O.next)v=O.layer,v.options.interactive&&v._containsPoint(u)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(v))&&(C=v);this._fireEvent(C?[C]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var u=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,u)}},_handleMouseOut:function(s){var u=this._hoveredLayer;u&&(Ft(this._container,"leaflet-interactive"),this._fireEvent([u],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,u){if(!this._mouseHoverThrottled){for(var v,C,O=this._drawFirst;O;O=O.next)v=O.layer,v.options.interactive&&v._containsPoint(u)&&(C=v);C!==this._hoveredLayer&&(this._handleMouseOut(s),C&&(yt(this._container,"leaflet-interactive"),this._fireEvent([C],s,"mouseover"),this._hoveredLayer=C)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,u,v){this._map._fireDOMEvent(u,v||u.type,s)},_bringToFront:function(s){var u=s._order;if(u){var v=u.next,C=u.prev;if(v)v.prev=C;else return;C?C.next=v:v&&(this._drawFirst=v),u.prev=this._drawLast,this._drawLast.next=u,u.next=null,this._drawLast=u,this._requestRedraw(s)}},_bringToBack:function(s){var u=s._order;if(u){var v=u.next,C=u.prev;if(C)C.next=v;else return;v?v.prev=C:C&&(this._drawLast=C),u.prev=null,u.next=this._drawFirst,this._drawFirst.prev=u,this._drawFirst=u,this._requestRedraw(s)}}});function js(s){return Qe.canvas?new Ic(s):null}var Ws=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),xc={_initContainer:function(){this._container=_t("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Jo.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var u=s._container=Ws("shape");yt(u,"leaflet-vml-shape "+(this.options.className||"")),u.coordsize="1 1",s._path=Ws("path"),u.appendChild(s._path),this._updateStyle(s),this._layers[d(s)]=s},_addPath:function(s){var u=s._container;this._container.appendChild(u),s.options.interactive&&s.addInteractiveTarget(u)},_removePath:function(s){var u=s._container;Mt(u),s.removeInteractiveTarget(u),delete this._layers[d(s)]},_updateStyle:function(s){var u=s._stroke,v=s._fill,C=s.options,O=s._container;O.stroked=!!C.stroke,O.filled=!!C.fill,C.stroke?(u||(u=s._stroke=Ws("stroke")),O.appendChild(u),u.weight=C.weight+"px",u.color=C.color,u.opacity=C.opacity,C.dashArray?u.dashStyle=_(C.dashArray)?C.dashArray.join(" "):C.dashArray.replace(/( *, *)/g," "):u.dashStyle="",u.endcap=C.lineCap.replace("butt","flat"),u.joinstyle=C.lineJoin):u&&(O.removeChild(u),s._stroke=null),C.fill?(v||(v=s._fill=Ws("fill")),O.appendChild(v),v.color=C.fillColor||C.color,v.opacity=C.fillOpacity):v&&(O.removeChild(v),s._fill=null)},_updateCircle:function(s){var u=s._point.round(),v=Math.round(s._radius),C=Math.round(s._radiusY||v);this._setPath(s,s._empty()?"M0 0":"AL "+u.x+","+u.y+" "+v+","+C+" 0,"+65535*360)},_setPath:function(s,u){s._path.v=u},_bringToFront:function(s){io(s._container)},_bringToBack:function(s){Un(s._container)}},Ui=Qe.vml?Ws:Ce,H=Jo.extend({_initContainer:function(){this._container=Ui("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ui("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Mt(this._container),Ut(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Jo.prototype._update.call(this);var s=this._bounds,u=s.getSize(),v=this._container;(!this._svgSize||!this._svgSize.equals(u))&&(this._svgSize=u,v.setAttribute("width",u.x),v.setAttribute("height",u.y)),on(v,s.min),v.setAttribute("viewBox",[s.min.x,s.min.y,u.x,u.y].join(" ")),this.fire("update")}},_initPath:function(s){var u=s._path=Ui("path");s.options.className&&yt(u,s.options.className),s.options.interactive&&yt(u,"leaflet-interactive"),this._updateStyle(s),this._layers[d(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){Mt(s._path),s.removeInteractiveTarget(s._path),delete this._layers[d(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var u=s._path,v=s.options;u&&(v.stroke?(u.setAttribute("stroke",v.color),u.setAttribute("stroke-opacity",v.opacity),u.setAttribute("stroke-width",v.weight),u.setAttribute("stroke-linecap",v.lineCap),u.setAttribute("stroke-linejoin",v.lineJoin),v.dashArray?u.setAttribute("stroke-dasharray",v.dashArray):u.removeAttribute("stroke-dasharray"),v.dashOffset?u.setAttribute("stroke-dashoffset",v.dashOffset):u.removeAttribute("stroke-dashoffset")):u.setAttribute("stroke","none"),v.fill?(u.setAttribute("fill",v.fillColor||v.color),u.setAttribute("fill-opacity",v.fillOpacity),u.setAttribute("fill-rule",v.fillRule||"evenodd")):u.setAttribute("fill","none"))},_updatePoly:function(s,u){this._setPath(s,Ne(s._parts,u))},_updateCircle:function(s){var u=s._point,v=Math.max(Math.round(s._radius),1),C=Math.max(Math.round(s._radiusY),1)||v,O="a"+v+","+C+" 0 1,0 ",W=s._empty()?"M0 0":"M"+(u.x-v)+","+u.y+O+v*2+",0 "+O+-v*2+",0 ";this._setPath(s,W)},_setPath:function(s,u){s._path.setAttribute("d",u)},_bringToFront:function(s){io(s._path)},_bringToBack:function(s){Un(s._path)}});Qe.vml&&H.include(xc);function ae(s){return Qe.svg||Qe.vml?new H(s):null}Lt.include({getRenderer:function(s){var u=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return u||(u=this._renderer=this._createRenderer()),this.hasLayer(u)||this.addLayer(u),u},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var u=this._paneRenderers[s];return u===void 0&&(u=this._createRenderer({pane:s}),this._paneRenderers[s]=u),u},_createRenderer:function(s){return this.options.preferCanvas&&js(s)||ae(s)}});var fe=Gs.extend({initialize:function(s,u){Gs.prototype.initialize.call(this,this._boundsToLatLngs(s),u)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=He(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function _e(s,u){return new fe(s,u)}H.create=Ui,H.pointsToPath=Ne,ha.geometryToLayer=xl,ha.coordsToLatLng=mr,ha.coordsToLatLngs=rs,ha.latLngToCoords=gr,ha.latLngsToCoords=cs,ha.getFeature=qs,ha.asFeature=Oi,Lt.mergeOptions({boxZoom:!0});var at=ho.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){rt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ut(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Mt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),ts(),Pa(),this._startPoint=this._map.mouseEventToContainerPoint(s),rt(document,{contextmenu:ro,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=_t("div","leaflet-zoom-box",this._container),yt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var u=new he(this._point,this._startPoint),v=u.getSize();on(this._box,u.min),this._box.style.width=v.x+"px",this._box.style.height=v.y+"px"},_finish:function(){this._moved&&(Mt(this._box),Ft(this._container,"leaflet-crosshair")),Ea(),Rs(),Ut(document,{contextmenu:ro,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var u=new je(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(u).fire("boxzoomend",{boxZoomBounds:u})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Lt.addInitHook("addHandler","boxZoom",at),Lt.mergeOptions({doubleClickZoom:!0});var Tt=ho.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var u=this._map,v=u.getZoom(),C=u.options.zoomDelta,O=s.originalEvent.shiftKey?v-C:v+C;u.options.doubleClickZoom==="center"?u.setZoom(O):u.setZoomAround(s.containerPoint,O)}});Lt.addInitHook("addHandler","doubleClickZoom",Tt),Lt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var zt=ho.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new Oo(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}yt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Ft(this._map._container,"leaflet-grab"),Ft(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var u=He(this._map.options.maxBounds);this._offsetLimit=Te(this._map.latLngToContainerPoint(u.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(u.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var u=this._lastTime=+new Date,v=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(v),this._times.push(u),this._prunePositions(u)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),u=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=u.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,u){return s-(s-u)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),u=this._offsetLimit;s.x<u.min.x&&(s.x=this._viscousLimit(s.x,u.min.x)),s.y<u.min.y&&(s.y=this._viscousLimit(s.y,u.min.y)),s.x>u.max.x&&(s.x=this._viscousLimit(s.x,u.max.x)),s.y>u.max.y&&(s.y=this._viscousLimit(s.y,u.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,u=Math.round(s/2),v=this._initialWorldOffset,C=this._draggable._newPos.x,O=(C-u+v)%s+u-v,W=(C+u+v)%s-u-v,ce=Math.abs(O+v)<Math.abs(W+v)?O:W;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ce},_onDragEnd:function(s){var u=this._map,v=u.options,C=!v.inertia||s.noInertia||this._times.length<2;if(u.fire("dragend",s),C)u.fire("moveend");else{this._prunePositions(+new Date);var O=this._lastPos.subtract(this._positions[0]),W=(this._lastTime-this._times[0])/1e3,ce=v.easeLinearity,Me=O.multiplyBy(ce/W),Re=Me.distanceTo([0,0]),Xe=Math.min(v.inertiaMaxSpeed,Re),it=Me.multiplyBy(Xe/Re),pt=Xe/(v.inertiaDeceleration*ce),At=it.multiplyBy(-pt/2).round();!At.x&&!At.y?u.fire("moveend"):(At=u._limitOffset(At,u.options.maxBounds),F(function(){u.panBy(At,{duration:pt,easeLinearity:ce,noMoveStart:!0,animate:!0})}))}}});Lt.addInitHook("addHandler","dragging",zt),Lt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var $n=ho.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),rt(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ut(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,u=document.documentElement,v=s.scrollTop||u.scrollTop,C=s.scrollLeft||u.scrollLeft;this._map._container.focus(),window.scrollTo(C,v)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var u=this._panKeys={},v=this.keyCodes,C,O;for(C=0,O=v.left.length;C<O;C++)u[v.left[C]]=[-1*s,0];for(C=0,O=v.right.length;C<O;C++)u[v.right[C]]=[s,0];for(C=0,O=v.down.length;C<O;C++)u[v.down[C]]=[0,s];for(C=0,O=v.up.length;C<O;C++)u[v.up[C]]=[0,-1*s]},_setZoomDelta:function(s){var u=this._zoomKeys={},v=this.keyCodes,C,O;for(C=0,O=v.zoomIn.length;C<O;C++)u[v.zoomIn[C]]=s;for(C=0,O=v.zoomOut.length;C<O;C++)u[v.zoomOut[C]]=-s},_addHooks:function(){rt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ut(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var u=s.keyCode,v=this._map,C;if(u in this._panKeys){if(!v._panAnim||!v._panAnim._inProgress)if(C=this._panKeys[u],s.shiftKey&&(C=oe(C).multiplyBy(3)),v.options.maxBounds&&(C=v._limitOffset(oe(C),v.options.maxBounds)),v.options.worldCopyJump){var O=v.wrapLatLng(v.unproject(v.project(v.getCenter()).add(C)));v.panTo(O)}else v.panBy(C)}else if(u in this._zoomKeys)v.setZoom(v.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[u]);else if(u===27&&v._popup&&v._popup.options.closeOnEscapeKey)v.closePopup();else return;ro(s)}}});Lt.addInitHook("addHandler","keyboard",$n),Lt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Zs=ho.extend({addHooks:function(){rt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ut(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var u=xi(s),v=this._map.options.wheelDebounceTime;this._delta+=u,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var C=Math.max(v-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),C),ro(s)},_performZoom:function(){var s=this._map,u=s.getZoom(),v=this._map.options.zoomSnap||0;s._stop();var C=this._delta/(this._map.options.wheelPxPerZoomLevel*4),O=4*Math.log(2/(1+Math.exp(-Math.abs(C))))/Math.LN2,W=v?Math.ceil(O/v)*v:O,ce=s._limitZoom(u+(this._delta>0?W:-W))-u;this._delta=0,this._startTime=null,ce&&(s.options.scrollWheelZoom==="center"?s.setZoom(u+ce):s.setZoomAround(this._lastMousePos,u+ce))}});Lt.addInitHook("addHandler","scrollWheelZoom",Zs);var Al=600;Lt.mergeOptions({tapHold:Qe.touchNative&&Qe.safari&&Qe.mobile,tapTolerance:15});var El=ho.extend({addHooks:function(){rt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ut(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var u=s.touches[0];this._startPos=this._newPos=new U(u.clientX,u.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(rt(document,"touchend",Zt),rt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",u))},this),Al),rt(document,"touchend touchcancel contextmenu",this._cancel,this),rt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){Ut(document,"touchend",Zt),Ut(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),Ut(document,"touchend touchcancel contextmenu",this._cancel,this),Ut(document,"touchmove",this._onMove,this)},_onMove:function(s){var u=s.touches[0];this._newPos=new U(u.clientX,u.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,u){var v=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:u.screenX,screenY:u.screenY,clientX:u.clientX,clientY:u.clientY});v._simulated=!0,u.target.dispatchEvent(v)}});Lt.addInitHook("addHandler","tapHold",El),Lt.mergeOptions({touchZoom:Qe.touch,bounceAtZoomLimits:!0});var us=ho.extend({addHooks:function(){yt(this._map._container,"leaflet-touch-zoom"),rt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Ft(this._map._container,"leaflet-touch-zoom"),Ut(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var u=this._map;if(!(!s.touches||s.touches.length!==2||u._animatingZoom||this._zooming)){var v=u.mouseEventToContainerPoint(s.touches[0]),C=u.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=u.getSize()._divideBy(2),this._startLatLng=u.containerPointToLatLng(this._centerPoint),u.options.touchZoom!=="center"&&(this._pinchStartLatLng=u.containerPointToLatLng(v.add(C)._divideBy(2))),this._startDist=v.distanceTo(C),this._startZoom=u.getZoom(),this._moved=!1,this._zooming=!0,u._stop(),rt(document,"touchmove",this._onTouchMove,this),rt(document,"touchend touchcancel",this._onTouchEnd,this),Zt(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var u=this._map,v=u.mouseEventToContainerPoint(s.touches[0]),C=u.mouseEventToContainerPoint(s.touches[1]),O=v.distanceTo(C)/this._startDist;if(this._zoom=u.getScaleZoom(O,this._startZoom),!u.options.bounceAtZoomLimits&&(this._zoom<u.getMinZoom()&&O<1||this._zoom>u.getMaxZoom()&&O>1)&&(this._zoom=u._limitZoom(this._zoom)),u.options.touchZoom==="center"){if(this._center=this._startLatLng,O===1)return}else{var W=v._add(C)._divideBy(2)._subtract(this._centerPoint);if(O===1&&W.x===0&&W.y===0)return;this._center=u.unproject(u.project(this._pinchStartLatLng,this._zoom).subtract(W),this._zoom)}this._moved||(u._moveStart(!0,!1),this._moved=!0),j(this._animRequest);var ce=l(u._move,u,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=F(ce,this,!0),Zt(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,j(this._animRequest),Ut(document,"touchmove",this._onTouchMove,this),Ut(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Lt.addInitHook("addHandler","touchZoom",us),Lt.BoxZoom=at,Lt.DoubleClickZoom=Tt,Lt.Drag=zt,Lt.Keyboard=$n,Lt.ScrollWheelZoom=Zs,Lt.TapHold=El,Lt.TouchZoom=us,n.Bounds=he,n.Browser=Qe,n.CRS=V,n.Canvas=Ic,n.Circle=vr,n.CircleMarker=Il,n.Class=J,n.Control=co,n.DivIcon=yr,n.DivOverlay=Yo,n.DomEvent=cr,n.DomUtil=Li,n.Draggable=Oo,n.Evented=se,n.FeatureGroup=Pn,n.GeoJSON=ha,n.GridLayer=Fi,n.Handler=ho,n.Icon=Ko,n.ImageOverlay=Tl,n.LatLng=We,n.LatLngBounds=je,n.Layer=wt,n.LayerGroup=Xt,n.LineUtil=kt,n.Map=Lt,n.Marker=Ri,n.Mixin=hr,n.Path=ua,n.Point=U,n.PolyUtil=fr,n.Polygon=Gs,n.Polyline=da,n.Popup=Ml,n.PosAnimation=Fs,n.Projection=jn,n.Rectangle=fe,n.Renderer=Jo,n.SVG=H,n.SVGOverlay=Cc,n.TileLayer=Ua,n.Tooltip=Ni,n.Transformation=$e,n.Util=K,n.VideoOverlay=wc,n.bind=l,n.bounds=Te,n.canvas=js,n.circle=sd,n.circleMarker=ad,n.control=uo,n.divIcon=pd,n.extend=o,n.featureGroup=Wn,n.geoJSON=$l,n.geoJson=rd,n.gridLayer=vd,n.icon=Di,n.imageOverlay=cd,n.latLng=be,n.latLngBounds=He,n.layerGroup=So,n.map=ur,n.marker=od,n.point=oe,n.polygon=ld,n.polyline=id,n.popup=hd,n.rectangle=_e,n.setOptions=x,n.stamp=d,n.svg=ae,n.svgOverlay=dd,n.tileLayer=Lc,n.tooltip=fd,n.transformation=q,n.version=a,n.videoOverlay=ud;var Xo=window.L;n.noConflict=function(){return window.L=Xo,this},window.L=n}))})(xr,xr.exports)),xr.exports}var p2=f2();const Kt=Yy(p2);(function(e,t,n){function a(o,i){for(;(o=o.parentElement)&&!o.classList.contains(i););return o}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(o,i){this._map=o,this._container=o._container,this._overlayPane=o._panes.overlayPane,this._popupPane=o._panes.popupPane,i&&i.shapeOptions&&(i.shapeOptions=L.Util.extend({},this.options.shapeOptions,i.shapeOptions)),L.setOptions(this,i);var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var o=this._map;o&&(L.DomUtil.disableTextSelection(),o.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(o){L.setOptions(this,o)},_fireCreatedEvent:function(o){this._map.fire(L.Draw.Event.CREATED,{layer:o,layerType:this.type})},_cancelDrawing:function(o){o.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(o,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,o,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var o=this._markers.pop(),i=this._poly,l=i.getLatLngs(),c=l.splice(-1,1)[0];this._poly.setLatLngs(l),this._markerGroup.removeLayer(o),i.getLatLngs().length<2&&this._map.removeLayer(i),this._vertexChanged(c,!1)}},addVertex:function(o){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(o))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(o)),this._poly.addLatLng(o),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(o,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var o=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),i=this._poly.newLatLngIntersects(o[o.length-1]);if(!this.options.allowIntersection&&i||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(o){var i=this._map.mouseEventToLayerPoint(o.originalEvent),l=this._map.layerPointToLatLng(i);this._currentLatLng=l,this._updateTooltip(l),this._updateGuide(i),this._mouseMarker.setLatLng(l),L.DomEvent.preventDefault(o.originalEvent)},_vertexChanged:function(o,i){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(o,i),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(o){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(o),this._clickHandled=!0,this._disableNewMarkers();var i=o.originalEvent,l=i.clientX,c=i.clientY;this._startPoint.call(this,l,c)}},_startPoint:function(o,i){this._mouseDownOrigin=L.point(o,i)},_onMouseUp:function(o){var i=o.originalEvent,l=i.clientX,c=i.clientY;this._endPoint.call(this,l,c,o),this._clickHandled=null},_endPoint:function(o,i,l){if(this._mouseDownOrigin){var c=L.point(o,i).distanceTo(this._mouseDownOrigin),d=this._calculateFinishDistance(l.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(l.latlng),this._finishShape()):d<10&&L.Browser.touch?this._finishShape():Math.abs(c)<9*(e.devicePixelRatio||1)&&this.addVertex(l.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(o){var i,l,c=o.originalEvent;!c.touches||!c.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(i=c.touches[0].clientX,l=c.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,i,l),this._endPoint.call(this,i,l,o),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(o){var i;if(this._markers.length>0){var l;if(this.type===L.Draw.Polyline.TYPE)l=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;l=this._markers[0]}var c=this._map.latLngToContainerPoint(l.getLatLng()),d=new L.Marker(o,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),h=this._map.latLngToContainerPoint(d.getLatLng());i=c.distanceTo(h)}else i=1/0;return i},_updateFinishHandler:function(){var o=this._markers.length;o>1&&this._markers[o-1].on("click",this._finishShape,this),o>2&&this._markers[o-2].off("click",this._finishShape,this)},_createMarker:function(o){var i=new L.Marker(o,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(i),i},_updateGuide:function(o){var i=this._markers?this._markers.length:0;i>0&&(o=o||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[i-1].getLatLng()),o))},_updateTooltip:function(o){var i=this._getTooltipText();o&&this._tooltip.updatePosition(o),this._errorShown||this._tooltip.updateContent(i)},_drawGuide:function(o,i){var l,c,d,h=Math.floor(Math.sqrt(Math.pow(i.x-o.x,2)+Math.pow(i.y-o.y,2))),f=this.options.guidelineDistance,m=this.options.maxGuideLineLength,y=h>m?h-m:f;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));y<h;y+=this.options.guidelineDistance)l=y/h,c={x:Math.floor(o.x*(1-l)+l*i.x),y:Math.floor(o.y*(1-l)+l*i.y)},d=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),d.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(d,c)},_updateGuideColor:function(o){if(this._guidesContainer)for(var i=0,l=this._guidesContainer.childNodes.length;i<l;i++)this._guidesContainer.childNodes[i].style.backgroundColor=o},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var o,i,l=this.options.showLength;return this._markers.length===0?o={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(i=l?this._getMeasurementString():"",o=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:i}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:i}),o},_updateRunningMeasure:function(o,i){var l,c,d=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(l=d-(i?2:1),c=L.GeometryUtil.isVersion07x()?o.distanceTo(this._markers[l].getLatLng())*(this.options.factor||1):this._map.distance(o,this._markers[l].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=c*(i?1:-1))},_getMeasurementString:function(){var o,i=this._currentLatLng,l=this._markers[this._markers.length-1].getLatLng();return o=L.GeometryUtil.isVersion07x()?l&&i&&i.distanceTo?this._measurementRunningTotal+i.distanceTo(l)*(this.options.factor||1):this._measurementRunningTotal||0:l&&i?this._measurementRunningTotal+this._map.distance(i,l)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(o,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var o=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,o)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(o,i){L.Draw.Polyline.prototype.initialize.call(this,o,i),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var o=this._markers.length;o===1&&this._markers[0].on("click",this._finishShape,this),o>2&&(this._markers[o-1].on("dblclick",this._finishShape,this),o>3&&this._markers[o-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var o,i;return this._markers.length===0?o=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(o=L.drawLocal.draw.handlers.polygon.tooltip.cont,i=this._getMeasurementString()):(o=L.drawLocal.draw.handlers.polygon.tooltip.end,i=this._getMeasurementString()),{text:o,subtext:i}},_getMeasurementString:function(){var o=this._area,i="";return o||this.options.showLength?(this.options.showLength&&(i=L.Draw.Polyline.prototype._getMeasurementString.call(this)),o&&(i+="<br>"+L.GeometryUtil.readableArea(o,this.options.metric,this.options.precision)),i):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(o,i){var l;!this.options.allowIntersection&&this.options.showArea&&(l=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(l)),L.Draw.Polyline.prototype._vertexChanged.call(this,o,i)},_cleanUpShape:function(){var o=this._markers.length;o>0&&(this._markers[0].off("click",this._finishShape,this),o>2&&this._markers[o-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(o,i){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,o,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(o){this._isDrawing=!0,this._startLatLng=o.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(o.originalEvent)},_onMouseMove:function(o){var i=o.latlng;this._tooltip.updatePosition(i),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(i))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(o,i){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,o,i)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(o){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!a(o.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(o){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,o)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,o),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var o=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,o)},_getTooltipText:function(){var o,i,l,c=L.Draw.SimpleShape.prototype._getTooltipText.call(this),d=this._shape,h=this.options.showArea;return d&&(o=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),i=L.GeometryUtil.geodesicArea(o),l=h?L.GeometryUtil.readableArea(i,this.options.metric):""),{text:c.text,subtext:l}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(o,i){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,o,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(o){var i=o.latlng;this._tooltip.updatePosition(i),this._mouseMarker.setLatLng(i),this._marker?(i=this._mouseMarker.getLatLng(),this._marker.setLatLng(i)):(this._marker=this._createMarker(i),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(o){return new L.Marker(o,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(o){this._onMouseMove(o),this._onClick()},_fireCreatedEvent:function(){var o=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,o)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(o,i){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,o,i)},_fireCreatedEvent:function(){var o=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,o)},_createMarker:function(o){return new L.CircleMarker(o,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(o,i){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,o,i)},_drawShape:function(o){if(L.GeometryUtil.isVersion07x())var i=this._startLatLng.distanceTo(o);else var i=this._map.distance(this._startLatLng,o);this._shape?this._shape.setRadius(i):(this._shape=new L.Circle(this._startLatLng,i,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var o=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,o)},_onMouseMove:function(o){var i,l=o.latlng,c=this.options.showRadius,d=this.options.metric;if(this._tooltip.updatePosition(l),this._isDrawing){this._drawShape(l),i=this._shape.getRadius().toFixed(1);var h="";c&&(h=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(i,d,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:h})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(o,i){this._marker=o,L.setOptions(this,i)},addHooks:function(){var o=this._marker;o.dragging.enable(),o.on("dragend",this._onDragEnd,o),this._toggleMarkerHighlight()},removeHooks:function(){var o=this._marker;o.dragging.disable(),o.off("dragend",this._onDragEnd,o),this._toggleMarkerHighlight()},_onDragEnd:function(o){var i=o.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_toggleMarkerHighlight:function(){var o=this._marker._icon;o&&(o.style.display="none",L.DomUtil.hasClass(o,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(o,"leaflet-edit-marker-selected"),this._offsetMarker(o,-4)):(L.DomUtil.addClass(o,"leaflet-edit-marker-selected"),this._offsetMarker(o,4)),o.style.display="")},_offsetMarker:function(o,i){var l=parseInt(o.style.marginTop,10)-i,c=parseInt(o.style.marginLeft,10)-i;o.style.marginTop=l+"px",o.style.marginLeft=c+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(o){this.latlngs=[o._latlngs],o._holes&&(this.latlngs=this.latlngs.concat(o._holes)),this._poly=o,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(o){for(var i=0;i<this._verticesHandlers.length;i++)o(this._verticesHandlers[i])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(o){o.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(o){o.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(o){o.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var o=0;o<this.latlngs.length;o++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[o],this._poly.options.poly))},_updateLatLngs:function(o){this.latlngs=[o.layer._latlngs],o.layer._holes&&(this.latlngs=this.latlngs.concat(o.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(o,i,l){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=o,l&&l.drawError&&(l.drawError=L.Util.extend({},this.options.drawError,l.drawError)),this._latlngs=i,L.setOptions(this,l)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var o=this._poly,i=o._path;o instanceof L.Polygon||(o.options.fill=!1,o.options.editing&&(o.options.editing.fill=!1)),i&&o.options.editing&&o.options.editing.className&&(o.options.original.className&&o.options.original.className.split(" ").forEach(function(l){L.DomUtil.removeClass(i,l)}),o.options.editing.className.split(" ").forEach(function(l){L.DomUtil.addClass(i,l)})),o.setStyle(o.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var o=this._poly,i=o._path;i&&o.options.editing&&o.options.editing.className&&(o.options.editing.className.split(" ").forEach(function(l){L.DomUtil.removeClass(i,l)}),o.options.original.className&&o.options.original.className.split(" ").forEach(function(l){L.DomUtil.addClass(i,l)})),o.setStyle(o.options.original),o._map&&(o._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var o,i,l,c,d=this._defaultShape();for(o=0,l=d.length;o<l;o++)c=this._createMarker(d[o],o),c.on("click",this._onMarkerClick,this),c.on("contextmenu",this._onContextMenu,this),this._markers.push(c);var h,f;for(o=0,i=l-1;o<l;i=o++)(o!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(h=this._markers[i],f=this._markers[o],this._createMiddleMarker(h,f),this._updatePrevNext(h,f))},_createMarker:function(o,i){var l=new L.Marker.Touch(o,{draggable:!0,icon:this.options.icon});return l._origLatLng=o,l._index=i,l.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(l),l},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var o=this._defaultShape(),i=[].splice.apply(o,arguments);return this._poly._convertLatLngs(o,!0),this._poly.redraw(),i},_removeMarker:function(o){var i=o._index;this._markerGroup.removeLayer(o),this._markers.splice(i,1),this._spliceLatLngs(i,1),this._updateIndexes(i,-1),o.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(o){var i=o.target,l=this._poly,c=L.LatLngUtil.cloneLatLng(i._origLatLng);if(L.extend(i._origLatLng,i._latlng),l.options.poly){var d=l._map._editTooltip;if(!l.options.poly.allowIntersection&&l.intersects()){L.extend(i._origLatLng,c),i.setLatLng(c);var h=l.options.color;l.setStyle({color:this.options.drawError.color}),d&&d.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){l.setStyle({color:h}),d&&d.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}i._middleLeft&&i._middleLeft.setLatLng(this._getMiddleLatLng(i._prev,i)),i._middleRight&&i._middleRight.setLatLng(this._getMiddleLatLng(i,i._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var f=this._poly.getLatLngs();this._poly._convertLatLngs(f,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(o){var i=L.Polygon&&this._poly instanceof L.Polygon?4:3,l=o.target;this._defaultShape().length<i||(this._removeMarker(l),this._updatePrevNext(l._prev,l._next),l._middleLeft&&this._markerGroup.removeLayer(l._middleLeft),l._middleRight&&this._markerGroup.removeLayer(l._middleRight),l._prev&&l._next?this._createMiddleMarker(l._prev,l._next):l._prev?l._next||(l._prev._middleRight=null):l._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(o){var i=o.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:i,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(o){var i=this._map.mouseEventToLayerPoint(o.originalEvent.touches[0]),l=this._map.layerPointToLatLng(i),c=o.target;L.extend(c._origLatLng,l),c._middleLeft&&c._middleLeft.setLatLng(this._getMiddleLatLng(c._prev,c)),c._middleRight&&c._middleRight.setLatLng(this._getMiddleLatLng(c,c._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(o,i){this._markerGroup.eachLayer(function(l){l._index>o&&(l._index+=i)})},_createMiddleMarker:function(o,i){var l,c,d,h=this._getMiddleLatLng(o,i),f=this._createMarker(h);f.setOpacity(.6),o._middleRight=i._middleLeft=f,c=function(){f.off("touchmove",c,this);var m=i._index;f._index=m,f.off("click",l,this).on("click",this._onMarkerClick,this),h.lat=f.getLatLng().lat,h.lng=f.getLatLng().lng,this._spliceLatLngs(m,0,h),this._markers.splice(m,0,f),f.setOpacity(1),this._updateIndexes(m,1),i._index++,this._updatePrevNext(o,f),this._updatePrevNext(f,i),this._poly.fire("editstart")},d=function(){f.off("dragstart",c,this),f.off("dragend",d,this),f.off("touchmove",c,this),this._createMiddleMarker(o,f),this._createMiddleMarker(f,i)},l=function(){c.call(this),d.call(this),this._fireEdit()},f.on("click",l,this).on("dragstart",c,this).on("dragend",d,this).on("touchmove",c,this),this._markerGroup.addLayer(f)},_updatePrevNext:function(o,i){o&&(o._next=i),i&&(i._prev=o)},_getMiddleLatLng:function(o,i){var l=this._poly._map,c=l.project(o.getLatLng()),d=l.project(i.getLatLng());return l.unproject(c._add(d)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(o,i){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=o,L.Util.setOptions(this,i)},addHooks:function(){var o=this._shape;this._shape._map&&(this._map=this._shape._map,o.setStyle(o.options.editing),o._map&&(this._map=o._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var o=this._shape;if(o.setStyle(o.options.original),o._map){this._unbindMarker(this._moveMarker);for(var i=0,l=this._resizeMarkers.length;i<l;i++)this._unbindMarker(this._resizeMarkers[i]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(o,i){var l=new L.Marker.Touch(o,{draggable:!0,icon:i,zIndexOffset:10});return this._bindMarker(l),this._markerGroup.addLayer(l),l},_bindMarker:function(o){o.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(o){o.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(o){o.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(o){var i=o.target,l=i.getLatLng();i===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(o){o.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(o){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,o),typeof this._getCorners=="function"){var i=this._getCorners(),l=o.target,c=l._cornerIndex;l.setOpacity(0),this._oppositeCorner=i[(c+2)%4],this._toggleCornerMarkers(0,c)}this._shape.fire("editstart")},_onTouchMove:function(o){var i=this._map.mouseEventToLayerPoint(o.originalEvent.touches[0]),l=this._map.layerPointToLatLng(i);return o.target===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),!1},_onTouchEnd:function(o){o.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var o=this._shape.getBounds(),i=o.getCenter();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){var o=this._getCorners();this._resizeMarkers=[];for(var i=0,l=o.length;i<l;i++)this._resizeMarkers.push(this._createMarker(o[i],this.options.resizeIcon)),this._resizeMarkers[i]._cornerIndex=i},_onMarkerDragStart:function(o){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,o);var i=this._getCorners(),l=o.target,c=l._cornerIndex;this._oppositeCorner=i[(c+2)%4],this._toggleCornerMarkers(0,c)},_onMarkerDragEnd:function(o){var i,l,c=o.target;c===this._moveMarker&&(i=this._shape.getBounds(),l=i.getCenter(),c.setLatLng(l)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,o)},_move:function(o){for(var i,l=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),c=this._shape.getBounds(),d=c.getCenter(),h=[],f=0,m=l.length;f<m;f++)i=[l[f].lat-d.lat,l[f].lng-d.lng],h.push([o.lat+i[0],o.lng+i[1]]);this._shape.setLatLngs(h),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(o){var i;this._shape.setBounds(L.latLngBounds(o,this._oppositeCorner)),i=this._shape.getBounds(),this._moveMarker.setLatLng(i.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var o=this._shape.getBounds();return[o.getNorthWest(),o.getNorthEast(),o.getSouthEast(),o.getSouthWest()]},_toggleCornerMarkers:function(o){for(var i=0,l=this._resizeMarkers.length;i<l;i++)this._resizeMarkers[i].setOpacity(o)},_repositionCornerMarkers:function(){for(var o=this._getCorners(),i=0,l=this._resizeMarkers.length;i<l;i++)this._resizeMarkers[i].setLatLng(o[i])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var o=this._shape.getLatLng();this._moveMarker=this._createMarker(o,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(o){if(this._resizeMarkers.length){var i=this._getResizeMarkerPoint(o);this._resizeMarkers[0].setLatLng(i)}this._shape.setLatLng(o),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var o=this._shape.getLatLng(),i=this._getResizeMarkerPoint(o);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(i,this.options.resizeIcon))},_getResizeMarkerPoint:function(o){var i=this._shape._radius*Math.cos(Math.PI/4),l=this._map.project(o);return this._map.unproject([l.x+i,l.y-i])},_resize:function(o){var i=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=i.distanceTo(o):radius=this._map.distance(i,o),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(o){this._map=o,this._container=o._container,this._pane=o._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(o,i){var l={};if(o.touches!==void 0){if(!o.touches.length)return;l=o.touches[0]}else if(o.pointerType!=="touch"||(l=o,!this._filterClick(o)))return;var c=this._map.mouseEventToContainerPoint(l),d=this._map.mouseEventToLayerPoint(l),h=this._map.layerPointToLatLng(d);this._map.fire(i,{latlng:h,layerPoint:d,containerPoint:c,pageX:l.pageX,pageY:l.pageY,originalEvent:o})},_filterClick:function(o){var i=o.timeStamp||o.originalEvent.timeStamp,l=L.DomEvent._lastClick&&i-L.DomEvent._lastClick;return l&&l>100&&l<500||o.target._simulatedClick&&!o._simulated?(L.DomEvent.stop(o),!1):(L.DomEvent._lastClick=i,!0)},_onTouchStart:function(o){this._map._loaded&&this._touchEvent(o,"touchstart")},_onTouchEnd:function(o){this._map._loaded&&this._touchEvent(o,"touchend")},_onTouchCancel:function(o){if(this._map._loaded){var i="touchcancel";this._detectIE()&&(i="pointercancel"),this._touchEvent(o,i)}},_onTouchLeave:function(o){this._map._loaded&&this._touchEvent(o,"touchleave")},_onTouchMove:function(o){this._map._loaded&&this._touchEvent(o,"touchmove")},_detectIE:function(){var o=e.navigator.userAgent,i=o.indexOf("MSIE ");if(i>0)return parseInt(o.substring(i+5,o.indexOf(".",i)),10);if(o.indexOf("Trident/")>0){var l=o.indexOf("rv:");return parseInt(o.substring(l+3,o.indexOf(".",l)),10)}var c=o.indexOf("Edge/");return c>0&&parseInt(o.substring(c+5,o.indexOf(".",c)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var o=this._icon,i=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?i.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):i.concat(["touchcancel"]),L.DomUtil.addClass(o,"leaflet-clickable"),L.DomEvent.on(o,"click",this._onMouseClick,this),L.DomEvent.on(o,"keypress",this._onKeyPress,this);for(var l=0;l<i.length;l++)L.DomEvent.on(o,i[l],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var o=e.navigator.userAgent,i=o.indexOf("MSIE ");if(i>0)return parseInt(o.substring(i+5,o.indexOf(".",i)),10);if(o.indexOf("Trident/")>0){var l=o.indexOf("rv:");return parseInt(o.substring(l+3,o.indexOf(".",l)),10)}var c=o.indexOf("Edge/");return c>0&&parseInt(o.substring(c+5,o.indexOf(".",c)),10)}}),L.LatLngUtil={cloneLatLngs:function(o){for(var i=[],l=0,c=o.length;l<c;l++)Array.isArray(o[l])?i.push(L.LatLngUtil.cloneLatLngs(o[l])):i.push(this.cloneLatLng(o[l]));return i},cloneLatLng:function(o){return L.latLng(o.lat,o.lng)}},(function(){var o={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(i){var l,c,d=i.length,h=0,f=Math.PI/180;if(d>2){for(var m=0;m<d;m++)l=i[m],c=i[(m+1)%d],h+=(c.lng-l.lng)*f*(2+Math.sin(l.lat*f)+Math.sin(c.lat*f));h=6378137*h*6378137/2}return Math.abs(h)},formattedNumber:function(i,l){var c=parseFloat(i).toFixed(l),d=L.drawLocal.format&&L.drawLocal.format.numeric,h=d&&d.delimiters,f=h&&h.thousands,m=h&&h.decimal;if(f||m){var y=c.split(".");c=f?y[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+f):y[0],m=m||".",y.length>1&&(c=c+m+y[1])}return c},readableArea:function(i,l,f){var d,h,f=L.Util.extend({},o,f);return l?(h=["ha","m"],type=typeof l,type==="string"?h=[l]:type!=="boolean"&&(h=l),d=i>=1e6&&h.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*i,f.km)+" km":i>=1e4&&h.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*i,f.ha)+" ha":L.GeometryUtil.formattedNumber(i,f.m)+" m"):(i/=.836127,d=i>=3097600?L.GeometryUtil.formattedNumber(i/3097600,f.mi)+" mi":i>=4840?L.GeometryUtil.formattedNumber(i/4840,f.ac)+" acres":L.GeometryUtil.formattedNumber(i,f.yd)+" yd"),d},readableDistance:function(i,l,c,d,m){var f,m=L.Util.extend({},o,m);switch(l?typeof l=="string"?l:"metric":c?"feet":d?"nauticalMile":"yards"){case"metric":f=i>1e3?L.GeometryUtil.formattedNumber(i/1e3,m.km)+" km":L.GeometryUtil.formattedNumber(i,m.m)+" m";break;case"feet":i*=3.28083,f=L.GeometryUtil.formattedNumber(i,m.ft)+" ft";break;case"nauticalMile":i*=.53996,f=L.GeometryUtil.formattedNumber(i/1e3,m.nm)+" nm";break;default:i*=1.09361,f=i>1760?L.GeometryUtil.formattedNumber(i/1760,m.mi)+" miles":L.GeometryUtil.formattedNumber(i,m.yd)+" yd"}return f},isVersion07x:function(){var i=L.version.split(".");return parseInt(i[0],10)===0&&parseInt(i[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(o,i,l,c){return this._checkCounterclockwise(o,l,c)!==this._checkCounterclockwise(i,l,c)&&this._checkCounterclockwise(o,i,l)!==this._checkCounterclockwise(o,i,c)},_checkCounterclockwise:function(o,i,l){return(l.y-o.y)*(i.x-o.x)>(i.y-o.y)*(l.x-o.x)}}),L.Polyline.include({intersects:function(){var o,i,l,c=this._getProjectedPoints(),d=c?c.length:0;if(this._tooFewPointsForIntersection())return!1;for(o=d-1;o>=3;o--)if(i=c[o-1],l=c[o],this._lineSegmentsIntersectsRange(i,l,o-2))return!0;return!1},newLatLngIntersects:function(o,i){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(o),i)},newPointIntersects:function(o,i){var l=this._getProjectedPoints(),c=l?l.length:0,d=l?l[c-1]:null,h=c-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(d,o,h,i?1:0)},_tooFewPointsForIntersection:function(o){var i=this._getProjectedPoints(),l=i?i.length:0;return l+=o||0,!i||l<=3},_lineSegmentsIntersectsRange:function(o,i,l,c){var d,h,f=this._getProjectedPoints();c=c||0;for(var m=l;m>c;m--)if(d=f[m-1],h=f[m],L.LineUtil.segmentsIntersect(o,i,d,h))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var o=[],i=this._defaultShape(),l=0;l<i.length;l++)o.push(this._map.latLngToLayerPoint(i[l]));return o}}),L.Polygon.include({intersects:function(){var o,i,l,c,d=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(o=d.length,i=d[0],l=d[o-1],c=o-2,this._lineSegmentsIntersectsRange(l,i,c,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(o){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,o);var i;this._toolbars={},L.DrawToolbar&&this.options.draw&&(i=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=i,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(i=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=i,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(o){var i,l=L.DomUtil.create("div","leaflet-draw"),c=!1;for(var d in this._toolbars)this._toolbars.hasOwnProperty(d)&&(i=this._toolbars[d].addToolbar(o))&&(c||(L.DomUtil.hasClass(i,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(i.childNodes[0],"leaflet-draw-toolbar-top"),c=!0),l.appendChild(i));return l},onRemove:function(){for(var o in this._toolbars)this._toolbars.hasOwnProperty(o)&&this._toolbars[o].removeToolbar()},setDrawingOptions:function(o){for(var i in this._toolbars)this._toolbars[i]instanceof L.DrawToolbar&&this._toolbars[i].setOptions(o)},_toolbarEnabled:function(o){var i=o.target;for(var l in this._toolbars)this._toolbars[l]!==i&&this._toolbars[l].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(o){L.setOptions(this,o),this._modes={},this._actionButtons=[],this._activeMode=null;var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(o){var i,l=L.DomUtil.create("div","leaflet-draw-section"),c=0,d=this._toolbarClass||"",h=this.getModeHandlers(o);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=o,i=0;i<h.length;i++)h[i].enabled&&this._initModeHandler(h[i].handler,this._toolbarContainer,c++,d,h[i].title);if(c)return this._lastButtonIndex=--c,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),l.appendChild(this._toolbarContainer),l.appendChild(this._actionsContainer),l},removeToolbar:function(){for(var o in this._modes)this._modes.hasOwnProperty(o)&&(this._disposeButton(this._modes[o].button,this._modes[o].handler.enable,this._modes[o].handler),this._modes[o].handler.disable(),this._modes[o].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var i=0,l=this._actionButtons.length;i<l;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(o,i,l,c,d){var h=o.type;this._modes[h]={},this._modes[h].handler=o,this._modes[h].button=this._createButton({type:h,title:d,className:c+"-"+h,container:i,callback:this._modes[h].handler.enable,context:this._modes[h].handler}),this._modes[h].buttonIndex=l,this._modes[h].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(o){var i=L.DomUtil.create("a",o.className||"",o.container),l=L.DomUtil.create("span","sr-only",o.container);i.href="#",i.appendChild(l),o.title&&(i.title=o.title,l.innerHTML=o.title),o.text&&(i.innerHTML=o.text,l.innerHTML=o.text);var c=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(i,"click",L.DomEvent.stopPropagation).on(i,"mousedown",L.DomEvent.stopPropagation).on(i,"dblclick",L.DomEvent.stopPropagation).on(i,"touchstart",L.DomEvent.stopPropagation).on(i,"click",L.DomEvent.preventDefault).on(i,c,o.callback,o.context),i},_disposeButton:function(o,i){var l=this._detectIOS()?"touchstart":"click";L.DomEvent.off(o,"click",L.DomEvent.stopPropagation).off(o,"mousedown",L.DomEvent.stopPropagation).off(o,"dblclick",L.DomEvent.stopPropagation).off(o,"touchstart",L.DomEvent.stopPropagation).off(o,"click",L.DomEvent.preventDefault).off(o,l,i)},_handlerActivated:function(o){this.disable(),this._activeMode=this._modes[o.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(o){var i,l,c,d,h=this._actionsContainer,f=this.getActions(o),m=f.length;for(l=0,c=this._actionButtons.length;l<c;l++)this._disposeButton(this._actionButtons[l].button,this._actionButtons[l].callback);for(this._actionButtons=[];h.firstChild;)h.removeChild(h.firstChild);for(var y=0;y<m;y++)"enabled"in f[y]&&!f[y].enabled||(i=L.DomUtil.create("li","",h),d=this._createButton({title:f[y].title,text:f[y].text,container:i,callback:f[y].callback,context:f[y].context}),this._actionButtons.push({button:d,callback:f[y].callback}))},_showActionsToolbar:function(){var o=this._activeMode.buttonIndex,i=this._lastButtonIndex,l=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=l+"px",o===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),o===i&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(o){this._map=o,this._popupPane=o._panes.popupPane,this._visible=!1,this._container=o.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(o){return this._container?(o.subtext=o.subtext||"",o.subtext.length!==0||this._singleLineLabel?o.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(o.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+o.subtext+"</span><br />":"")+"<span>"+o.text+"</span>",o.text||o.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(o){var i=this._map.latLngToLayerPoint(o),l=this._container;return this._container&&(this._visible&&(l.style.visibility="inherit"),L.DomUtil.setPosition(l,i)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(o){for(var i in this.options)this.options.hasOwnProperty(i)&&o[i]&&(o[i]=L.extend({},this.options[i],o[i]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,o)},getModeHandlers:function(o){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(o,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(o,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(o,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(o,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(o,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(o,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(o){return[{enabled:o.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:o.completeShape,context:o},{enabled:o.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:o.deleteLastVertex,context:o},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(o){L.setOptions(this,o);for(var i in this._modes)this._modes.hasOwnProperty(i)&&o.hasOwnProperty(i)&&this._modes[i].handler.setOptions(o[i])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(o){o.edit&&(o.edit.selectedPathOptions===void 0&&(o.edit.selectedPathOptions=this.options.edit.selectedPathOptions),o.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,o.edit.selectedPathOptions)),o.remove&&(o.remove=L.extend({},this.options.remove,o.remove)),o.poly&&(o.poly=L.extend({},this.options.poly,o.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,o),this._selectedFeatureCount=0},getModeHandlers:function(o){var i=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(o,{featureGroup:i,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(o,{featureGroup:i}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(o){var i=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return o.removeAllLayers&&i.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),i},addToolbar:function(o){var i=L.Toolbar.prototype.addToolbar.call(this,o);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),i},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var o,i=this.options.featureGroup,l=i.getLayers().length!==0;this.options.edit&&(o=this._modes[L.EditToolbar.Edit.TYPE].button,l?L.DomUtil.removeClass(o,"leaflet-disabled"):L.DomUtil.addClass(o,"leaflet-disabled"),o.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(o=this._modes[L.EditToolbar.Delete.TYPE].button,l?L.DomUtil.removeClass(o,"leaflet-disabled"):L.DomUtil.addClass(o,"leaflet-disabled"),o.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(o,i){if(L.Handler.prototype.initialize.call(this,o),L.setOptions(this,i),this._featureGroup=i.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var o=this._map;o&&(o.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),o._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(o){this._revertLayer(o)},this)},save:function(){var o=new L.LayerGroup;this._featureGroup.eachLayer(function(i){i.edited&&(o.addLayer(i),i.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:o})},_backupLayer:function(o){var i=L.Util.stamp(o);this._uneditedLayerProps[i]||(o instanceof L.Polyline||o instanceof L.Polygon||o instanceof L.Rectangle?this._uneditedLayerProps[i]={latlngs:L.LatLngUtil.cloneLatLngs(o.getLatLngs())}:o instanceof L.Circle?this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(o.getLatLng()),radius:o.getRadius()}:(o instanceof L.Marker||o instanceof L.CircleMarker)&&(this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(o.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(o){var i=L.Util.stamp(o);o.edited=!1,this._uneditedLayerProps.hasOwnProperty(i)&&(o instanceof L.Polyline||o instanceof L.Polygon||o instanceof L.Rectangle?o.setLatLngs(this._uneditedLayerProps[i].latlngs):o instanceof L.Circle?(o.setLatLng(this._uneditedLayerProps[i].latlng),o.setRadius(this._uneditedLayerProps[i].radius)):(o instanceof L.Marker||o instanceof L.CircleMarker)&&o.setLatLng(this._uneditedLayerProps[i].latlng),o.fire("revert-edited",{layer:o}))},_enableLayerEdit:function(o){var i,l,c=o.layer||o.target||o;this._backupLayer(c),this.options.poly&&(l=L.Util.extend({},this.options.poly),c.options.poly=l),this.options.selectedPathOptions&&(i=L.Util.extend({},this.options.selectedPathOptions),i.maintainColor&&(i.color=c.options.color,i.fillColor=c.options.fillColor),c.options.original=L.extend({},c.options),c.options.editing=i),c instanceof L.Marker?(c.editing&&c.editing.enable(),c.dragging.enable(),c.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):c.editing.enable()},_disableLayerEdit:function(o){var i=o.layer||o.target||o;i.edited=!1,i.editing&&i.editing.disable(),delete i.options.editing,delete i.options.original,this._selectedPathOptions&&(i instanceof L.Marker?this._toggleMarkerHighlight(i):(i.setStyle(i.options.previousOptions),delete i.options.previousOptions)),i instanceof L.Marker?(i.dragging.disable(),i.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):i.editing.disable()},_onMouseMove:function(o){this._tooltip.updatePosition(o.latlng)},_onMarkerDragEnd:function(o){var i=o.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_onTouchMove:function(o){var i=o.originalEvent.changedTouches[0],l=this._map.mouseEventToLayerPoint(i),c=this._map.layerPointToLatLng(l);o.target.setLatLng(c)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(o,i){if(L.Handler.prototype.initialize.call(this,o),L.Util.setOptions(this,i),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var o=this._map;o&&(o.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(o){this._deletableLayers.addLayer(o),o.fire("revert-deleted",{layer:o})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(o){this._removeLayer({layer:o})},this),this.save()},_enableLayerDelete:function(o){(o.layer||o.target||o).on("click",this._removeLayer,this)},_disableLayerDelete:function(o){var i=o.layer||o.target||o;i.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(i)},_removeLayer:function(o){var i=o.layer||o.target||o;this._deletableLayers.removeLayer(i),this._deletedLayers.addLayer(i),i.fire("deleted")},_onMouseMove:function(o){this._tooltip.updatePosition(o.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const Jy=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"",Cv=e=>e.length*6+12,Ud=(e,t)=>!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom),v2=(e,t)=>{if(!e||t.length===0)return new Set;const n=[],a=e.getBounds();t.forEach(l=>{if(a.contains(l.getLatLng())){const c=e.latLngToContainerPoint(l.getLatLng()),d=l.locationData;d&&n.push({marker:l,pixelPos:c,location:d})}});const o=n.map(({marker:l,pixelPos:c,location:d})=>{const m=Cv(d.name),y=d.description?Cv(`${d.name}: ${Jy(d.description,50)}`):m;return{marker:l,location:d,markerBox:{left:c.x-15,right:c.x+15,top:c.y-15,bottom:c.y+15},baseLabelBox:{left:c.x-m/2,right:c.x+m/2,top:c.y+15+2,bottom:c.y+15+2+20},descLabelBox:d.description?{left:c.x-y/2,right:c.x+y/2,top:c.y+15+2,bottom:c.y+15+2+20}:null}}),i=new Set;return o.forEach(({marker:l,location:c,markerBox:d,baseLabelBox:h,descLabelBox:f},m)=>{if(!c.description)return;let y=!1;for(let k=0;k<o.length;k++){if(m===k)continue;const S=o[k];if(Ud(f,S.markerBox)||Ud(f,S.baseLabelBox)){y=!0;break}if(S.descLabelBox&&i.has(S.location.id)&&Ud(f,S.descLabelBox)){y=!0;break}}y||i.add(c.id)}),i},Oc=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"hexagon",label:"Hexagon"},{value:"pentagon",label:"Pentagon"},{value:"diamond",label:"Diamond"},{value:"star",label:"Star"},{value:"dot",label:"Dot"},{value:"none",label:"None"}],m2=[{value:"33",label:"Small (33%)"},{value:"66",label:"Medium (66%)"},{value:"100",label:"Normal (100%)"},{value:"150",label:"Large (150%)"}],_u=[{value:"default",label:"Default",isShapeOnly:!1,category:"default"},{value:"dot",label:"Dot",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"circle",label:"Circle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"square",label:"Square",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"triangle",label:"Triangle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"diamond",label:"Diamond",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"star",label:"Star",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"hexagon",label:"Hexagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"pentagon",label:"Pentagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"car",label:"Car",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"bike",label:"Bike",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"water",label:"Water",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"food",label:"Food",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"medical",label:"Medical",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"photo",label:"Photo",isShapeOnly:!1,category:"content",defaultColor:"#8B5CF6"},{value:"music",label:"Music",isShapeOnly:!1,category:"content",defaultColor:"#EC4899"},{value:"start",label:"Start",isShapeOnly:!1,category:"content",defaultColor:"#10B981"},{value:"finish",label:"Finish",isShapeOnly:!1,category:"content",defaultColor:"#1F2937"},{value:"toilet",label:"Toilet",isShapeOnly:!1,category:"content",defaultColor:"#6366F1"},{value:"shower",label:"Shower",isShapeOnly:!1,category:"content",defaultColor:"#06B6D4"},{value:"bus",label:"Bus",isShapeOnly:!1,category:"content",defaultColor:"#F97316"},{value:"info",label:"Information",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"merch",label:"Merchandise",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"cone",label:"Road closure",isShapeOnly:!1,category:"content",defaultColor:"#FF6B00"},{value:"traffic",label:"Traffic management",isShapeOnly:!1,category:"content",defaultColor:"#374151"},{value:"track",label:"Track",isShapeOnly:!1,category:"content",defaultColor:"#78716C"},{value:"tunnel",label:"Tunnel",isShapeOnly:!1,category:"content",defaultColor:"#57534E"},{value:"bridge",label:"Bridge",isShapeOnly:!1,category:"content",defaultColor:"#0284C7"},{value:"plane",label:"Plane",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"hill",label:"Hill",isShapeOnly:!1,category:"content",defaultColor:"#65A30D"},{value:"baggage",label:"Baggage",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"crown",label:"Crown",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"crossing",label:"Crossing point",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"trees",label:"Trees",isShapeOnly:!1,category:"content",defaultColor:"#22C55E"},{value:"arrow-uturn-left",label:"Left u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-left",label:"Left turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-left",label:"Slight left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-straight",label:"Straight ahead",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-right",label:"Slight right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-right",label:"Right turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-uturn-right",label:"Right u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-left",label:"Left fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-right",label:"Right fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-left",label:"Keep left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-right",label:"Keep right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"}];function il(e){return _u.find(t=>t.value===e)||_u[0]}function g2(e){return il(e).defaultColor||"#667eea"}function y2(e,t){return t||g2(e)}const Zh={dot:(e,t=32)=>{const n=(t/2-2)*.33;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${n}" fill="${e}" stroke="#fff" stroke-width="1.5"/>
    </svg>`},circle:(e,t=32)=>{const n=t/2-2;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${n}" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`},square:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect x="4" y="4" width="${t-8}" height="${t-8}" rx="4" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`,triangle:(e,t=32)=>{const n=t/2,a=4,o=t-4,i=4,l=t-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${n},${a} ${l},${o} ${i},${o}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},diamond:(e,t=32)=>{const n=t/2,a=t/2,o=t/2-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${n},${a-o} ${n+o},${a} ${n},${a+o} ${n-o},${a}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},star:(e,t=32)=>{const n=t/2,a=t/2,o=t/2-3,i=o*.4,l=[];for(let c=0;c<5;c++){const d=Math.PI/2*-1+c*2*Math.PI/5;l.push(`${n+o*Math.cos(d)},${a+o*Math.sin(d)}`);const h=d+Math.PI/5;l.push(`${n+i*Math.cos(h)},${a+i*Math.sin(h)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${l.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},hexagon:(e,t=32)=>{const n=t/2,a=t/2,o=t/2-4,i=[];for(let l=0;l<6;l++){const c=Math.PI/6+l*Math.PI/3;i.push(`${n+o*Math.cos(c)},${a+o*Math.sin(c)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},pentagon:(e,t=32)=>{const n=t/2,a=t/2,o=t/2-4,i=[];for(let l=0;l<5;l++){const c=Math.PI/2*-1+l*2*Math.PI/5;i.push(`${n+o*Math.cos(c)},${a+o*Math.sin(c)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${i.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},car:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Car body -->
      <rect x="6" y="13" width="20" height="8" rx="2" fill="#fff"/>
      <!-- Car roof/cabin -->
      <path d="M10 13 L12 9 L20 9 L22 13" fill="#fff" stroke="#fff" stroke-width="1"/>
      <!-- Windows -->
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${e}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${e}"/>
      <!-- Tires (always black) -->
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <!-- Wheel centers -->
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>
    </svg>`,bike:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Tires (same color as bike) -->
      <circle cx="9" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <!-- Wheel centers -->
      <circle cx="9" cy="20" r="1" fill="#fff"/>
      <circle cx="23" cy="20" r="1" fill="#fff"/>
      <!-- Frame -->
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
      <!-- Handlebars -->
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <!-- Seat -->
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="#fff"/>
    </svg>`},Lv={water:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="#fff"/>
    </svg>`,food:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="#fff"/>
      <path d="M21 9v14h2V9h-2z" fill="#fff"/>
    </svg>`,medical:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#fff" stroke-width="2"/>
      <rect x="14" y="8" width="4" height="16" rx="1" fill="#fff"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="#fff"/>
    </svg>`,photo:(e=32)=>{const t="#8B5CF6";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="8" y="10" width="16" height="12" rx="2" fill="#fff"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" y="13" r="1" fill="${t}"/>
    </svg>`},music:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EC4899" stroke="#fff" stroke-width="2"/>
      <path d="M12 22c1.66 0 3-1.34 3-3v-9h5v4h-3v5c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.35 0 .69.07 1 .18V10c0-.55.45-1 1-1h5c.55 0 1 .45 1 1v6h-5v5c0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.7 0 1.37.15 2 .41" fill="#fff"/>
      <ellipse cx="12" cy="21" rx="2.5" ry="2" fill="#fff"/>
      <rect x="14" y="10" width="2" height="9" fill="#fff"/>
      <rect x="14" y="10" width="6" height="2" fill="#fff"/>
    </svg>`,start:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#10B981" stroke="#fff" stroke-width="2"/>
      <path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="#fff"/>
    </svg>`,finish:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#1F2937" stroke="#fff" stroke-width="2"/>
      <rect x="10" y="8" width="4" height="4" fill="#fff"/>
      <rect x="14" y="12" width="4" height="4" fill="#fff"/>
      <rect x="18" y="8" width="4" height="4" fill="#fff"/>
      <rect x="10" y="16" width="4" height="4" fill="#fff"/>
      <rect x="18" y="16" width="4" height="4" fill="#fff"/>
      <rect x="14" y="20" width="4" height="4" fill="#fff"/>
    </svg>`,toilet:(e=32)=>{const t="#6366F1";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="11" y="7" width="10" height="3" rx="1" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>
    </svg>`},shower:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#06B6D4" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="3" fill="#fff"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="#fff"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
    </svg>`,bus:(e=32)=>{const t="#F97316";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="9" y="9" width="14" height="12" rx="2" fill="#fff"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="#fff"/>
      <circle cx="12" cy="21" r="1.5" fill="#fff"/>
      <circle cx="20" cy="21" r="1.5" fill="#fff"/>
    </svg>`},info:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#0EA5E9" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="2" fill="#fff"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="#fff"/>
    </svg>`,merch:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#A855F7" stroke="#fff" stroke-width="2"/>
      <path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="#fff"/>
      <path d="M13 10 L16 7 L19 10" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>`,cone:(e=32)=>{const t="#FF6B00";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L21 22 H11 L16 6Z" fill="#fff"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="#fff"/>
    </svg>`},traffic:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#374151" stroke="#fff" stroke-width="2"/>
      <rect x="12" y="6" width="8" height="20" rx="2" fill="#fff"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>
    </svg>`,crown:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="#fff"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="#fff"/>
    </svg>`,crossing:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="#fff" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="#fff" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="#fff"/>
      <path d="M16 10 L16 16" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
    </svg>`,trees:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#22C55E" stroke="#fff" stroke-width="2"/>
      <!-- Left tree -->
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="#fff"/>
      <!-- Right tree -->
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="#fff"/>
    </svg>`,"arrow-uturn-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on right, curve left, down on left -->
      <path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on left side -->
      <path d="M7 15 L12 21 L17 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="#fff"/>
    </svg>`,"arrow-slight-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-straight":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
    </svg>`,"arrow-slight-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="#fff"/>
    </svg>`,"arrow-uturn-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on left, curve right, down on right -->
      <path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on right side -->
      <path d="M15 15 L20 21 L25 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-fork-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (correct way - with arrow) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M10 12 L6 10 L8 16 Z" fill="#fff"/>
      <!-- Right fork (wrong way - with X) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
    </svg>`,"arrow-fork-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (wrong way - with X) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <!-- Right fork (correct way - with arrow) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M22 12 L26 10 L24 16 Z" fill="#fff"/>
    </svg>`,"arrow-keep-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-keep-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`},Vl={circle:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="14" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,square:({backgroundColor:e,borderColor:t})=>`<rect x="4" y="4" width="24" height="24" rx="4" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,hexagon:({backgroundColor:e,borderColor:t})=>{const n=t==="none"?"none":t||"#fff",a=t==="none"?0:2,o=[];for(let i=0;i<6;i++){const l=Math.PI/6+i*Math.PI/3;o.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${o.join(" ")}" fill="${e}" stroke="${n}" stroke-width="${a}" stroke-linejoin="round"/>`},pentagon:({backgroundColor:e,borderColor:t})=>{const n=t==="none"?"none":t||"#fff",a=t==="none"?0:2,o=[];for(let i=0;i<5;i++){const l=Math.PI/2*-1+i*2*Math.PI/5;o.push(`${16+12*Math.cos(l)},${16+12*Math.sin(l)}`)}return`<polygon points="${o.join(" ")}" fill="${e}" stroke="${n}" stroke-width="${a}" stroke-linejoin="round"/>`},diamond:({backgroundColor:e,borderColor:t})=>`<polygon points="16,4 28,16 16,28 4,16" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}" stroke-linejoin="round"/>`,star:({backgroundColor:e,borderColor:t})=>{const n=t==="none"?"none":t||"#fff",a=t==="none"?0:2,o=13,i=o*.4,l=[];for(let c=0;c<5;c++){const d=Math.PI/2*-1+c*2*Math.PI/5;l.push(`${16+o*Math.cos(d)},${16+o*Math.sin(d)}`);const h=d+Math.PI/5;l.push(`${16+i*Math.cos(h)},${16+i*Math.sin(h)}`)}return`<polygon points="${l.join(" ")}" fill="${e}" stroke="${n}" stroke-width="${a}" stroke-linejoin="round"/>`},dot:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="5" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:1.5}"/>`,none:()=>""},Sv={water:(e="#fff")=>`<path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="${e}"/>`,food:(e="#fff")=>`<path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="${e}"/>
      <path d="M21 9v14h2V9h-2z" fill="${e}"/>`,medical:(e="#fff")=>`<rect x="14" y="8" width="4" height="16" rx="1" fill="${e}"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="${e}"/>`,photo:(e="#fff",t="#667eea")=>`<rect x="8" y="10" width="16" height="12" rx="2" fill="${e}"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" cy="13" r="1" fill="${t}"/>`,music:(e="#fff")=>`<ellipse cx="12" cy="21" rx="2.5" ry="2" fill="${e}"/>
      <rect x="14" y="10" width="2" height="9" fill="${e}"/>
      <rect x="14" y="10" width="6" height="2" fill="${e}"/>`,start:(e="#fff")=>`<path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="${e}"/>`,finish:(e="#fff")=>`<rect x="10" y="8" width="4" height="4" fill="${e}"/>
      <rect x="14" y="12" width="4" height="4" fill="${e}"/>
      <rect x="18" y="8" width="4" height="4" fill="${e}"/>
      <rect x="10" y="16" width="4" height="4" fill="${e}"/>
      <rect x="18" y="16" width="4" height="4" fill="${e}"/>
      <rect x="14" y="20" width="4" height="4" fill="${e}"/>`,toilet:(e="#fff",t="#667eea")=>`<rect x="11" y="7" width="10" height="3" rx="1" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="${e}" stroke-width="2" fill="none" stroke-linecap="round"/>`,shower:(e="#fff")=>`<circle cx="16" cy="10" r="3" fill="${e}"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="${e}"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>`,bus:(e="#fff",t="#667eea")=>`<rect x="9" y="9" width="14" height="12" rx="2" fill="${e}"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="${e}"/>
      <circle cx="12" cy="21" r="1.5" fill="${e}"/>
      <circle cx="20" cy="21" r="1.5" fill="${e}"/>`,info:(e="#fff")=>`<circle cx="16" cy="10" r="2" fill="${e}"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="${e}"/>`,merch:(e="#fff")=>`<path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="${e}"/>
      <path d="M13 10 L16 7 L19 10" stroke="${e}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`,cone:(e="#fff",t="#667eea")=>`<path d="M16 6 L21 22 H11 L16 6Z" fill="${e}"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="${e}"/>`,traffic:(e="#fff")=>`<rect x="12" y="6" width="8" height="20" rx="2" fill="${e}"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>`,car:(e="#fff",t="#667eea")=>`<rect x="6" y="13" width="20" height="8" rx="2" fill="${e}"/>
      <path d="M10 13 L12 9 L20 9 L22 13" fill="${e}" stroke="${e}" stroke-width="1"/>
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${t}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${t}"/>
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>`,bike:(e="#fff")=>`<circle cx="9" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="9" cy="20" r="1" fill="${e}"/>
      <circle cx="23" cy="20" r="1" fill="${e}"/>
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="${e}" stroke-width="2" stroke-linejoin="round"/>
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="${e}"/>`,"arrow-uturn-left":(e="#fff")=>`<path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7 15 L12 21 L17 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-left":(e="#fff")=>`<path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="${e}"/>`,"arrow-slight-left":(e="#fff")=>`<g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-straight":(e="#fff")=>`<path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>`,"arrow-slight-right":(e="#fff")=>`<g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-right":(e="#fff")=>`<path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="${e}"/>`,"arrow-uturn-right":(e="#fff")=>`<path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 15 L20 21 L25 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-fork-left":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Left arrowhead -->
      <path d="M10 12 L6 10 L8 16 Z" fill="${e}"/>
      <!-- Wrong way indicator on right -->
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>`,"arrow-fork-right":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <!-- Wrong way indicator on left -->
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Right arrowhead -->
      <path d="M22 12 L26 10 L24 16 Z" fill="${e}"/>`,"arrow-keep-left":(e="#fff")=>`<g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-keep-right":(e="#fff")=>`<g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,track:(e="#fff")=>`
      <rect x="10" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="19.5" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="8" y="9" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="14.5" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="20" width="16" height="2.5" rx="0.5" fill="${e}"/>`,tunnel:(e="#fff")=>`
      <path d="M7 25 L7 14 C7 8 11 5 16 5 C21 5 25 8 25 14 L25 25" fill="none" stroke="${e}" stroke-width="2.5"/>
      <path d="M11 25 L11 16 C11 12 13 10 16 10 C19 10 21 12 21 16 L21 25" fill="none" stroke="${e}" stroke-width="1.5" opacity="0.6"/>`,bridge:(e="#fff")=>`
      <rect x="5" y="18" width="22" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="7" y="10" width="2" height="8" fill="${e}"/>
      <rect x="23" y="10" width="2" height="8" fill="${e}"/>
      <path d="M8 10 Q16 6 24 10" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <line x1="12" y1="13" x2="12" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="16" y1="11.5" x2="16" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="20" y1="13" x2="20" y2="18" stroke="${e}" stroke-width="1.5"/>`,plane:(e="#fff")=>`
      <g fill="${e}">
        <!-- Fuselage body -->
        <path d="M27 16 L24 14 L8 14 Q4 16 8 18 L24 18 L27 16 Z"/>
        <!-- Nose cone -->
        <path d="M8 14 Q4 16 8 18 L8 14 Z"/>
        <!-- Tail fin -->
        <path d="M26 14 L26 9 L22 14 Z"/>
        <!-- Main wing -->
        <path d="M20 16 L16 10 L14 10 L16 16 L14 22 L16 22 L20 16 Z"/>
        <!-- Cockpit window -->
        <ellipse cx="10" cy="16" rx="1.5" ry="1" fill="none" stroke="${e}" stroke-width="0.5" opacity="0.6"/>
      </g>`,hill:(e="#fff")=>`
      <path d="M6 24 L13 12 L16 16 L20 10 L26 24 Z" fill="${e}"/>
      <path d="M20 10 L22 13 L18 13 Z" fill="${e}" opacity="0.6"/>`,baggage:(e="#fff")=>`
      <rect x="8" y="12" width="16" height="12" rx="2" fill="${e}"/>
      <rect x="12" y="8" width="8" height="4" rx="1" fill="none" stroke="${e}" stroke-width="2"/>
      <line x1="12" y1="16" x2="20" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
      <line x1="12" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>`,crown:(e="#fff")=>`
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="${e}"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="${e}"/>`,crossing:(e="#fff")=>`
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="${e}" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="${e}" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="${e}"/>
      <path d="M16 10 L16 16" stroke="${e}" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>`,trees:(e="#fff")=>`
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="${e}"/>
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="${e}"/>`};function Vn({type:e,backgroundShape:t="circle",backgroundColor:n,borderColor:a,iconColor:o,size:i="100",outputSize:l=null}){if(!e||e==="default"){if(!(n||a||o||t&&t!=="circle"&&t!=="default"))return null;e=t&&t!=="default"?t:"circle"}const c=il(e),d=parseInt(i,10)/100,h=l||Math.round(32*d);let f="";if(c.isShapeOnly){const m=n||c.defaultColor||"#667eea",y=a||"#fff";if(Vl[e])f=Vl[e]({backgroundColor:m,borderColor:y});else return Zh[e]?.(m,h)||null}else{const m=n||"#667eea",y=a||"#fff",k=o||"#fff",S=t||"circle";S!=="none"&&Vl[S]&&(f+=Vl[S]({backgroundColor:m,borderColor:y})),Sv[e]&&(f+=Sv[e](k,m))}return`<svg width="${h}" height="${h}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
    ${f}
  </svg>`}const k2={full:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#10B981" stroke="#fff" stroke-width="1.5"/>
    <path d="M4 7l2 2 4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </svg>`,partial:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#F59E0B" stroke="#fff" stroke-width="1.5"/>
    <rect x="6" y="3.5" width="2" height="4.5" rx="1" fill="#fff"/>
    <circle cx="7" cy="10" r="1" fill="#fff"/>
  </svg>`,missing:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#EF4444" stroke="#fff" stroke-width="1.5"/>
    <path d="M4.5 4.5l5 5M9.5 4.5l-5 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
  </svg>`};function b2(e,t){return e===0?"missing":e>=t?"full":"partial"}function Kh(e,t){const n=b2(e,t);return k2[n]}function _2(e,t,n=32){if(e==="default")return null;if(Lv[e])return Lv[e](n);if(Zh[e]){const a=t||"#667eea";return Zh[e](a,n)}return null}const w2=["circle","square","hexagon","pentagon"];function C2(e){return w2.includes(e)}function L2(e,t,n,a,o=32,i=!0){const l=_2(e,t,o),c=Kh(n,a);if(!l)return null;const d=i&&C2(e),h=y2(e,t),f=I2(h),m=Xy(h)?"0 1px 2px rgba(255,255,255,0.5)":"0 1px 2px rgba(0,0,0,0.5)",y=o>=36?"12px":"10px",k=d?`
    <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: ${f};
      font-weight: bold;
      font-size: ${y};
      text-shadow: ${m};
      pointer-events: none;
    ">${n}/${a}</div>
  `:"";return`
    <div style="position: relative; width: ${o}px; height: ${o}px;">
      ${l}
      ${k}
      <div style="position: absolute; bottom: -4px; right: -4px;">
        ${c}
      </div>
    </div>
  `}function S2(e){const t=e.replace("#",""),n=parseInt(t.substr(0,2),16)/255,a=parseInt(t.substr(2,2),16)/255,o=parseInt(t.substr(4,2),16)/255,i=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4),l=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),c=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4);return .2126*i+.7152*l+.0722*c}function Xy(e){return!e||e.length<6?!1:S2(e)>.4}function I2(e){return Xy(e)?"#1F2937":"#FFFFFF"}const x2={class:"map-container-wrapper"},$2="#667eea",T2={__name:"MapView",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},clickable:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1},editingPolygon:{type:Array,default:null},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","polygon-complete","polygon-drawing","polygon-update","visibility-change"],setup(e,{expose:t,emit:n}){const a=e,o=n,i=P(null);let l=null;const c=P([]),d=P([]),h=P([]);let f=null,m=null;const y=P([]);let k=null,S=null,x=!1;const E=P(!1),$=()=>{if(l){const Pe=l.getCenter();return{lat:Pe.lat,lng:Pe.lng}}return null},w=()=>l?l.getZoom():null,_=()=>{if(c.value.length>0){h.value.push([...c.value]);const Pe=d.value.pop()||[];c.value=Pe,Ce(),o("polygon-drawing",c.value)}},I=()=>{if(h.value.length>0){d.value.push([...c.value]);const Pe=h.value.pop();c.value=Pe,Ce(),o("polygon-drawing",c.value)}},T=()=>c.value.length>0,B=()=>h.value.length>0,M=()=>c.value.length,R=()=>{c.value.length>=3&&(o("polygon-complete",[...c.value]),A())},A=()=>{c.value=[],d.value=[],h.value=[],Ce()},G=()=>{!l||!a.userLocation||(l.setView([a.userLocation.lat,a.userLocation.lng],l.getZoom(),{animate:!0,duration:.5}),E.value=!0)},F=(Pe,Ie,me=null)=>{if(!l||Pe==null||Ie==null)return;l.setView([Pe,Ie],me??l.getZoom(),{animate:!0,duration:.5});const Ke=a.center&&Math.abs(a.center.lat-Pe)<1e-4&&Math.abs(a.center.lng-Ie)<1e-4;E.value=!Ke},j=P(!0),K=P(!0),J=(Pe,Ie)=>{if(!l||Pe==null||Ie==null)return!0;const me=l.getBounds(),Ke=Kt.latLng(Pe,Ie);return me.contains(Ke)};t({getMapCenter:$,getMapZoom:w,undoPolygonPoint:_,redoPolygonPoint:I,canUndo:T,canRedo:B,getPolygonPointCount:M,completePolygon:R,clearPolygonDrawing:A,recenterOnUserLocation:G,recenterOnLocation:F,isLocationInView:J,userLocationInView:K,highlightedLocationInView:j});const ue=P([]);let Z=null;const se=P(!0),U=P(!1),Q=P(new Set),oe=P([]);let he=null,Te=null;const je=z(()=>a.hideRecenterButton||!a.highlightLocationId||!E.value?!1:!j.value),He=P({}),We=()=>{const Pe={};if(a.highlightLocationId){const Ie=a.locations.find(me=>me.id===a.highlightLocationId);if(Ie?.latitude&&Ie?.longitude){const me=J(Ie.latitude,Ie.longitude);j.value=me,Pe[a.highlightLocationId]=me,He.value=Pe;return}}if(a.highlightLocationIds&&a.highlightLocationIds.length>0){let Ie=!0;for(const me of a.highlightLocationIds){const Ke=a.locations.find(Ve=>Ve.id===me);if(Ke?.latitude&&Ke?.longitude){const Ve=J(Ke.latitude,Ke.longitude);Pe[me]=Ve,Ve||(Ie=!1)}else Pe[me]=!0}j.value=Ie,He.value=Pe;return}if(!l){j.value=!0,He.value={};return}j.value=!0,He.value={}},be=()=>{if(!l||!a.userLocation){K.value=!0;return}K.value=J(a.userLocation.lat,a.userLocation.lng)},V=()=>{We(),be(),o("visibility-change",{userLocationInView:K.value,highlightedLocationInView:j.value,highlightedLocationsVisibility:He.value})},Y=()=>{if(!l||!a.highlightLocationId)return;const Pe=a.locations.find(Ie=>Ie.id===a.highlightLocationId);!Pe||!Pe.latitude||!Pe.longitude||(l.setView([Pe.latitude,Pe.longitude],l.getZoom(),{animate:!0,duration:.5}),E.value=!1,j.value=!0)},re=(Pe,Ie,me,Ke,Ve=!1)=>{const de=me?"36px":Ke?"20px":"30px",ke=me?"#667eea":"white",te=Ve?"":Kh(Pe,Ie);return`
    <div style="position: relative; width: ${de}; height: ${de};">
      <div style="
        background-color: ${$2};
        width: ${de};
        height: ${de};
        border-radius: 50%;
        border: 3px solid ${ke};
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      "></div>
      ${Ve?"":`<div style="position: absolute; bottom: -4px; right: -4px;">
        ${te}
      </div>`}
    </div>
  `},ie=()=>{if(!l)return;const Pe=v2(l,ue.value),Ie=Array.from(Q.value).sort().join(","),me=Array.from(Pe).sort().join(",");Ie!==me&&(Q.value=Pe,De())},$e=()=>{if(Te&&(Te.remove(),Te=null),!l||!a.userLocation)return;const Pe=Kt.divIcon({className:"user-location-marker",html:`
      <div style="
        position: relative;
        width: 20px;
        height: 20px;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #4285f4;
          border: 3px solid white;
          border-radius: 50%;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        "></div>
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 40px;
          height: 40px;
          background-color: rgba(66, 133, 244, 0.2);
          border-radius: 50%;
          animation: pulse 2s ease-out infinite;
        "></div>
      </div>
    `,iconSize:[40,40],iconAnchor:[20,20]});Te=Kt.marker([a.userLocation.lat,a.userLocation.lng],{icon:Pe}).addTo(l).bindPopup("Your location")},q=()=>{if(!i.value)return;let Pe=51.505,Ie=-.09,me=13;const Ke=a.allLocationsForBounds.length>0?a.allLocationsForBounds:a.locations,Ve=(ke,te)=>ke!=null&&te!=null&&!(ke===0&&te===0),de=[];Ke.length>0&&de.push(...Ke.filter(ke=>Ve(ke.latitude,ke.longitude)).map(ke=>({lat:ke.latitude,lng:ke.longitude}))),a.route&&a.route.length>0&&de.push(...a.route.filter(ke=>Ve(ke.lat,ke.lng)).map(ke=>({lat:ke.lat,lng:ke.lng}))),a.center?(Pe=a.center.lat,Ie=a.center.lng,me=a.zoom??13):de.length>0&&(Pe=de.reduce((ke,te)=>ke+te.lat,0)/de.length,Ie=de.reduce((ke,te)=>ke+te.lng,0)/de.length,me=10),l=Kt.map(i.value,{markerZoomAnimation:!1,fadeAnimation:!1}).setView([Pe,Ie],me),Kt.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(l),a.clickable&&l.on("click",ke=>{a.drawingMode||o("map-click",{lat:ke.latlng.lat,lng:ke.latlng.lng})}),l.on("zoomstart",()=>{ye=!0}),l.on("zoomend moveend",()=>{ye=!1,ne?De():ie(),V()}),l.on("dragstart",()=>{E.value=!0}),De(),X(),ee(),$e(),Ae(),Be(),l.whenReady(()=>{V()})},X=()=>{if(Z&&(Z.remove(),Z=null),!l||a.route.length===0)return;const Pe=a.route.map(Ie=>[Ie.lat,Ie.lng]);Z=Kt.polyline(Pe,{color:"blue",weight:4,opacity:.7}).addTo(l)},ee=()=>{oe.value.forEach(Pe=>Pe.remove()),oe.value=[],!(!l||a.areas.length===0)&&a.areas.forEach(Pe=>{const Ie=typeof Pe.polygon=="string"?JSON.parse(Pe.polygon):Pe.polygon;if(!Ie||Ie.length===0)return;const me=Ie.map(ke=>[ke.lat,ke.lng]),Ke=Pe.id===a.selectedAreaId,Ve=Pe.color||"#667eea",de=Kt.polygon(me,{color:Ve,fillColor:Ve,fillOpacity:Ke?.4:.2,weight:Ke?3:2,opacity:.8}).addTo(l);de.setStyle({pane:"overlayPane"}),a.drawingMode||(de.on("click",()=>o("area-click",Pe)),de.on("mouseover",()=>{de.setStyle({fillOpacity:.4})}),de.on("mouseout",()=>{de.setStyle({fillOpacity:Ke?.4:.2})})),oe.value.push(de)})},Ce=()=>{if(l&&(f&&(f.remove(),f=null),m&&(m.remove(),m=null),c.value.length!==0&&(m=Kt.layerGroup().addTo(l),c.value.forEach((Pe,Ie)=>{const me=Ie===0,Ke=Ie===c.value.length-1,Ve=Kt.divIcon({className:"polygon-point-marker",html:`<div style="
        width: ${me?"16px":"12px"};
        height: ${me?"16px":"12px"};
        background-color: ${me?"#667eea":Ke?"#ff9800":"white"};
        border: 3px solid #667eea;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      "></div>`,iconSize:[me?16:12,me?16:12],iconAnchor:[me?8:6,me?8:6]});Kt.marker([Pe.lat,Pe.lng],{icon:Ve,interactive:!1}).addTo(m)}),c.value.length>=2))){const Pe=c.value.map(Ie=>[Ie.lat,Ie.lng]);c.value.length>=3&&Pe.push(Pe[0]),f=Kt.polyline(Pe,{color:"#667eea",weight:3,opacity:.8,dashArray:c.value.length<3?"10, 10":null}).addTo(l)}},Ne=()=>{if(!l||(k&&(k.remove(),k=null),S&&(S.remove(),S=null),y.value.length===0))return;const Pe=y.value.map(me=>[me.lat,me.lng]);k=Kt.polygon(Pe,{color:"#667eea",fillColor:"#667eea",fillOpacity:.2,weight:3,opacity:.8,pane:"overlayPane"}).addTo(l),k.bringToFront(),S=Kt.layerGroup({pane:"markerPane"}).addTo(l);const Ie=me=>{y.value.length<=3||(y.value.splice(me,1),x=!0,o("polygon-update",[...y.value]),Ne())};y.value.forEach((me,Ke)=>{const Ve=y.value.length>3,de=Kt.divIcon({className:"polygon-edit-marker",html:`<div class="vertex-marker" style="
        position: relative;
        width: 16px;
        height: 16px;
        background-color: #667eea;
        border: 3px solid white;
        border-radius: 50%;
        box-shadow: 0 2px 6px rgba(0,0,0,0.4);
        cursor: move;
      "></div>`,iconSize:[16,16],iconAnchor:[8,8]}),ke=Kt.marker([me.lat,me.lng],{icon:de,draggable:!0}).addTo(S);if(ke.on("drag",te=>{const ge=te.target.getLatLng();y.value[Ke]={lat:ge.lat,lng:ge.lng};const Fe=y.value.map(ut=>[ut.lat,ut.lng]);k.setLatLngs(Fe)}),ke.on("dragend",()=>{x=!0,o("polygon-update",[...y.value])}),ke.on("contextmenu",te=>{Kt.DomEvent.preventDefault(te),Ve&&Ie(Ke)}),Ve){const te=document.createElement("div"),ge=document.createElement("button");ge.textContent="Delete point",ge.style.cssText=`
        background: #dc3545;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9rem;
      `;const Fe=ut=>{ut.preventDefault(),ut.stopPropagation(),ke.closePopup(),Ie(Ke)};ge.addEventListener("click",Fe),ge.addEventListener("touchend",Fe),te.appendChild(ge),ke.bindPopup(te,{closeButton:!1,className:"vertex-popup"})}})},Be=(Pe=!0)=>{if(l){if(!a.editingPolygon||a.editingPolygon.length===0){k&&(k.remove(),k=null),S&&(S.remove(),S=null),y.value=[];return}if(y.value=a.editingPolygon.map(Ie=>({lat:Ie.lat,lng:Ie.lng})),Ne(),Pe&&y.value.length>=3){const Ie=Kt.latLngBounds(y.value.map(me=>[me.lat,me.lng]));l.fitBounds(Ie,{padding:[50,50]})}}},Ae=()=>{if(!l)return;if(he||(he=new Kt.FeatureGroup,l.addLayer(he)),l._customDrawingHandlers&&(l.off("click",l._customDrawingHandlers.handleClick),l.getContainer().removeEventListener("touchstart",l._customDrawingHandlers.handleTouchStart),l.getContainer().removeEventListener("touchend",l._customDrawingHandlers.handleTouchEnd),l.getContainer().removeEventListener("touchmove",l._customDrawingHandlers.handleTouchMove),delete l._customDrawingHandlers),!a.drawingMode){A(),he&&he.clearLayers();return}let Pe=0,Ie=null,me=!1,Ke=!1;const Ve=300,de=15,ke=gt=>{d.value.push([...c.value]),h.value=[],c.value.push({lat:gt.lat,lng:gt.lng}),Ce(),o("polygon-drawing",c.value)},te=gt=>{gt.originalEvent&&gt.originalEvent.sourceCapabilities?.firesTouchEvents||ke(gt.latlng)},ge=gt=>{if(gt.touches.length>1){Ke=!0;return}Ke=!1,Pe=Date.now(),Ie={x:gt.touches[0].clientX,y:gt.touches[0].clientY},me=!1},Fe=gt=>{if(!Ie||Ke)return;const xt=gt.touches[0].clientX-Ie.x,Ct=gt.touches[0].clientY-Ie.y;Math.sqrt(xt*xt+Ct*Ct)>de&&(me=!0)},ut=gt=>{if(Ke){Ke=!1,Ie=null;return}if(Date.now()-Pe<Ve&&!me&&Ie){const Ct=gt.changedTouches[0],Pt=Kt.point(Ct.clientX-l.getContainer().getBoundingClientRect().left,Ct.clientY-l.getContainer().getBoundingClientRect().top),Wt=l.containerPointToLatLng(Pt);gt.preventDefault(),gt.stopPropagation(),ke(Wt)}Ie=null,me=!1};l.on("click",te),l.getContainer().addEventListener("touchstart",ge,{passive:!0}),l.getContainer().addEventListener("touchmove",Fe,{passive:!0}),l.getContainer().addEventListener("touchend",ut,{passive:!1}),l._customDrawingHandlers={handleClick:te,handleTouchStart:ge,handleTouchMove:Fe,handleTouchEnd:ut},Ce()};let ne=!1,ye=!1;const De=()=>{if(l&&(l._animatingZoom||ye)){ne=!0;return}if(ne=!1,ue.value.forEach(me=>{me._map&&(me.off(),me.remove())}),ue.value=[],!l)return;const Pe=i.value?.clientWidth||400,Ie=Math.floor(Pe*.75);if(a.locations.forEach(me=>{const Ke=me.latitude??me.Latitude,Ve=me.longitude??me.Longitude;if(Ke==null||Ve==null||Ke===0&&Ve===0)return;const de=me.checkedInCount||0,ke=me.requiredMarshals||1,te=a.highlightLocationId===me.id||a.highlightLocationIds.includes(me.id),ge=me.isDynamic||me.IsDynamic,Fe=a.simplifyNonHighlighted&&!te&&!ge,ut=me.resolvedStyleType||me.ResolvedStyleType,gt=me.resolvedStyleBackgroundColor||me.ResolvedStyleBackgroundColor||me.resolvedStyleColor||me.ResolvedStyleColor,xt=me.resolvedStyleBorderColor||me.ResolvedStyleBorderColor,Ct=me.resolvedStyleIconColor||me.ResolvedStyleIconColor,Pt=me.resolvedStyleBackgroundShape||me.ResolvedStyleBackgroundShape,Wt=ut&&ut!=="default"||gt||xt||Ct||Pt&&Pt!=="circle"&&Pt!=="default",_o=me.resolvedStyleMapRotation??me.ResolvedStyleMapRotation??me.styleMapRotation??me.StyleMapRotation??0,cn=parseInt(_o,10)||0,ft=me.areaColor||"#999",Dt=me.areaId&&!a.marshalMode,In=Q.value.has(me.id)&&me.description?`${me.name}: ${Jy(me.description,50)}`:me.name,En=te?`
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid #667eea;
        border-radius: 50%;
        animation: highlight-pulse 1.5s ease-out infinite;
      "></div>
    `:"",wo=te?"#667eea":Fe?"#e0e0e0":"white",Ao=te?"white":Fe?"#888":"#333";let en;if(Fe){const Qe="20px";en=`
        <div style="
          background-color: #999;
          width: ${Qe};
          height: ${Qe};
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        "></div>
      `}const Ma=!a.marshalMode,On=Kh(de,ke),Go=Ma?`<div style="
      position: absolute;
      bottom: -2px;
      right: -6px;
      background-color: white;
      border-radius: 8px;
      padding: 1px 4px;
      font-size: 9px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    ">${de}/${ke}</div>`:"";if(!Fe&&Wt){const Qe=te?40:32,Rt=me.resolvedStyleSize||me.ResolvedStyleSize||"100",tn=Vn({type:me.resolvedStyleType||me.ResolvedStyleType,backgroundShape:me.resolvedStyleBackgroundShape||me.ResolvedStyleBackgroundShape||"circle",backgroundColor:me.resolvedStyleBackgroundColor||me.ResolvedStyleBackgroundColor||me.resolvedStyleColor||me.ResolvedStyleColor||"",borderColor:me.resolvedStyleBorderColor||me.ResolvedStyleBorderColor||"",iconColor:me.resolvedStyleIconColor||me.ResolvedStyleIconColor||"",size:Rt});tn?en=tn:en=L2(me.resolvedStyleType,me.resolvedStyleColor,de,ke,Qe,Ma)||re(de,ke,te,a.marshalMode,!0)}else Fe||(en=re(de,ke,te,a.marshalMode,!0));const pe=cn!==0?`transform: rotate(${cn}deg);`:"",ve=Kt.divIcon({className:"custom-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
          ${En}
          <div style="position: relative; display: flex; align-items: center; gap: 4px;">
            ${Dt?`<div style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background-color: ${ft};
              border: 2px solid white;
              box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            "></div>`:""}
            <div style="position: relative; display: inline-block;">
              <div style="${pe}">
                ${en}
              </div>
              ${Fe||a.marshalMode?"":`<div style="position: absolute; top: -4px; right: -4px;">
                ${On}
              </div>`}
              ${Fe?"":Go}
            </div>
          </div>
          <div style="
            background-color: ${wo};
            padding: 2px 6px;
            border-radius: 3px;
            font-size: ${te?"12px":"11px"};
            font-weight: bold;
            color: ${Ao};
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: ${Ie}px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${In}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]}),Le=a.marshalMode?`<b>${me.name}</b>${me.description?`<br>${me.description}`:""}`:`<b>${me.name}</b><br>${me.description||""}<br>Checked in: ${de}/${ke}`,lt=Kt.marker([me.latitude,me.longitude],{icon:ve}).addTo(l).bindPopup(Le);lt.on("click",()=>{o("location-click",me)}),lt.locationData=me,ue.value.push(lt)}),l&&se.value&&!a.center&&!U.value){const me=[],Ke=a.allLocationsForBounds.length>0?a.allLocationsForBounds:a.locations,Ve=(de,ke)=>de!=null&&ke!=null&&!(de===0&&ke===0);if(Ke.length>0&&me.push(...Ke.filter(de=>Ve(de.latitude,de.longitude)).map(de=>[de.latitude,de.longitude])),a.route.length>0&&me.push(...a.route.filter(de=>Ve(de.lat,de.lng)).map(de=>[de.lat,de.lng])),me.length>0){const de=Kt.latLngBounds(me);l.fitBounds(de,{padding:[50,50]}),se.value=!1,U.value=!0}}else a.center&&(se.value=!1);setTimeout(()=>{l&&!l._animatingZoom&&ie()},100)};return rn(()=>{U.value=!1,se.value=!0,q();let Pe,Ie=0,me=0;const Ke=new ResizeObserver(Ve=>{if(l&&Ve.length>0){const{width:de,height:ke}=Ve[0].contentRect;(Math.abs(de-Ie)>10||Math.abs(ke-me)>10)&&(Ie=de,me=ke,clearTimeout(Pe),Pe=setTimeout(()=>{l.invalidateSize()},150))}});i.value&&Ke.observe(i.value),An(()=>{clearTimeout(Pe),Ke.disconnect()})}),Ye(()=>a.locations,Pe=>{if(De(),l&&!U.value&&Pe.length>0&&!a.center){const Ie=Pe.map(de=>de.latitude),me=Pe.map(de=>de.longitude),Ke=Ie.reduce((de,ke)=>de+ke,0)/Ie.length,Ve=me.reduce((de,ke)=>de+ke,0)/me.length;l.setView([Ke,Ve],10),U.value=!0,se.value=!1}l&&setTimeout(()=>V(),50)},{deep:!0}),Ye(()=>a.route,Pe=>{if(X(),De(),l&&!U.value&&Pe&&Pe.length>0&&!a.center){const Ie=Pe.map(de=>de.lat),me=Pe.map(de=>de.lng),Ke=Ie.reduce((de,ke)=>de+ke,0)/Ie.length,Ve=me.reduce((de,ke)=>de+ke,0)/me.length;l.setView([Ke,Ve],10),U.value=!0,se.value=!1}},{deep:!0}),Ye(()=>a.center,(Pe,Ie)=>{l&&!E.value&&(!Ie||Math.abs(Pe.lat-Ie.lat)>1e-6||Math.abs(Pe.lng-Ie.lng)>1e-6)&&l.setView([Pe.lat,Pe.lng],a.zoom)}),Ye(()=>a.areas,()=>{ee()},{deep:!0}),Ye(()=>a.selectedAreaId,()=>{ee()}),Ye(()=>a.drawingMode,()=>{Ae()}),Ye(()=>a.editingPolygon,()=>{if(x){x=!1;return}Be()},{deep:!0}),Ye(()=>a.userLocation,()=>{$e()},{deep:!0}),Ye(()=>a.highlightLocationId,()=>{De()}),Ye(()=>a.highlightLocationIds,()=>{De(),l&&setTimeout(()=>V(),50)},{deep:!0}),Ye(()=>a.marshalMode,()=>{De()}),Ye(()=>a.simplifyNonHighlighted,()=>{De()}),Ye(()=>a.clickable,Pe=>{l&&(l.off("click"),Pe&&l.on("click",Ie=>{a.drawingMode||o("map-click",{lat:Ie.latlng.lat,lng:Ie.latlng.lng})}))}),(Pe,Ie)=>(p(),g("div",x2,[r("div",{ref_key:"mapContainer",ref:i,class:"map-container"},null,512),je.value?(p(),g("button",{key:0,class:"recenter-btn",onClick:Y,title:"Recenter on checkpoint"},[...Ie[0]||(Ie[0]=[r("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),r("span",null,"Recenter",-1)])])):D("",!0)]))}},Yh=Ze(T2,[["__scopeId","data-v-ddef834a"]]);function na(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}const M2={class:"areas-selection"},A2={key:0,class:"areas-selection-header"},E2={class:"areas-list"},P2=["checked","onChange"],D2={__name:"AreasSelection",props:{areas:{type:Array,default:()=>[]},selectedAreaIds:{type:Array,default:()=>[]}},emits:["update:selectedAreaIds"],setup(e,{emit:t}){const n=e,a=t,o=z(()=>[...n.areas].sort((d,h)=>d.displayOrder!==h.displayOrder?d.displayOrder-h.displayOrder:na(d.name,h.name))),i=z(()=>n.areas.length>0&&n.selectedAreaIds.length===n.areas.length),l=d=>{const h=[...n.selectedAreaIds],f=h.indexOf(d);f>=0?h.splice(f,1):h.push(d),a("update:selectedAreaIds",h)},c=()=>{i.value?a("update:selectedAreaIds",[]):a("update:selectedAreaIds",n.areas.map(d=>d.id))};return(d,h)=>(p(),g("div",M2,[e.areas.length>1?(p(),g("div",A2,[r("button",{onClick:c,class:"toggle-all-btn"},b(i.value?"Deselect all":"Select all"),1)])):D("",!0),r("div",E2,[(p(!0),g(xe,null,qe(o.value,f=>(p(),g("label",{class:"area-checkbox",key:f.id},[r("input",{type:"checkbox",checked:e.selectedAreaIds.includes(f.id),onChange:m=>l(f.id)},null,40,P2),r("span",{class:"area-color-dot",style:nt({backgroundColor:f.color||"#667eea"})},null,4),Je(" "+b(f.name),1)]))),128))])]))}},R2=Ze(D2,[["__scopeId","data-v-ba19009b"]]),O2={key:1,class:"toolbar-btn-wrapper filters-wrapper"},B2={key:1,class:"dropdown-content filters-dropdown"},N2={class:"filters-header"},F2={class:"filter-section"},U2={class:"filter-checkbox"},z2=["checked"],H2={key:0,class:"filter-checkbox"},V2=["checked"],G2={class:"filter-section"},q2={class:"filter-checkbox"},j2=["checked"],W2={class:"filter-checkbox"},Z2=["checked"],K2={class:"filter-checkbox"},Y2=["checked"],J2={key:0,class:"filter-section"},X2=["onClick","title"],Q2={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},eL={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},tL=["innerHTML"],nL={key:0,class:"dropdown-content action-dropdown"},oL=["onClick"],aL={__name:"MapToolbar",props:{showFullscreen:{type:Boolean,default:!1},showFilters:{type:Boolean,default:!1},filters:{type:Object,default:()=>({showRoute:!0,showAreaOverlays:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},areas:{type:Array,default:()=>[]},actions:{type:Array,default:()=>[]},position:{type:String,default:"top-right",validator:e=>["top-right","top-left"].includes(e)}},emits:["fullscreen-click","filter-change","action-click"],setup(e,{expose:t,emit:n}){const{terms:a}=ht(),o=e,i=n,l=P(!1),c=P(null),d=z(()=>c.value!==null),h=()=>{l.value=!l.value,l.value&&(c.value=null)},f=(S,x)=>{i("filter-change",{...o.filters,[S]:x})},m=S=>{S.items&&S.items.length>0?c.value===S.id?c.value=null:(c.value=S.id,l.value=!1):i("action-click",{actionId:S.id})},y=(S,x)=>{c.value=null,i("action-click",{actionId:S,itemId:x})};return t({closeDropdowns:()=>{l.value=!1,c.value=null}}),(S,x)=>(p(),g("div",{class:le(["map-toolbar",[`position-${e.position}`]])},[e.showFullscreen?(p(),g("button",{key:0,class:"toolbar-btn",onClick:x[0]||(x[0]=E=>S.$emit("fullscreen-click")),title:"Fullscreen"},[...x[9]||(x[9]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})],-1)])])):D("",!0),e.showFilters&&!d.value?(p(),g("div",O2,[l.value?(p(),g("div",{key:0,class:"mobile-backdrop",onClick:x[1]||(x[1]=E=>l.value=!1)})):D("",!0),r("button",{class:le(["toolbar-btn",{active:l.value}]),onClick:h,title:"Show/hide options"},[...x[10]||(x[10]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),r("circle",{cx:"12",cy:"12",r:"3"})],-1)])],2),l.value?(p(),g("div",B2,[r("div",N2,[x[12]||(x[12]=r("span",{class:"filters-title"},"Map filters",-1)),r("button",{class:"close-filters-btn",onClick:x[2]||(x[2]=E=>l.value=!1),title:"Close"},[...x[11]||(x[11]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])]),r("div",F2,[x[13]||(x[13]=r("h4",null,"Display",-1)),r("label",U2,[r("input",{type:"checkbox",checked:e.filters.showRoute,onChange:x[3]||(x[3]=E=>f("showRoute",E.target.checked))},null,40,z2),r("span",null,b(N(a).course)+" line",1)]),e.areas.length>0?(p(),g("label",H2,[r("input",{type:"checkbox",checked:e.filters.showAreaOverlays!==!1,onChange:x[4]||(x[4]=E=>f("showAreaOverlays",E.target.checked))},null,40,V2),r("span",null,b(N(a).area)+" overlays",1)])):D("",!0)]),r("div",G2,[r("h4",null,b(N(a).checkpoints),1),r("label",q2,[r("input",{type:"checkbox",checked:e.filters.showUncheckedIn,onChange:x[5]||(x[5]=E=>f("showUncheckedIn",E.target.checked))},null,40,j2),x[14]||(x[14]=r("span",{class:"status-indicator unchecked"},null,-1)),x[15]||(x[15]=r("span",null,"Unchecked-in",-1))]),r("label",W2,[r("input",{type:"checkbox",checked:e.filters.showPartiallyCheckedIn,onChange:x[6]||(x[6]=E=>f("showPartiallyCheckedIn",E.target.checked))},null,40,Z2),x[16]||(x[16]=r("span",{class:"status-indicator partial"},null,-1)),x[17]||(x[17]=r("span",null,"Partially checked-in",-1))]),r("label",K2,[r("input",{type:"checkbox",checked:e.filters.showFullyCheckedIn,onChange:x[7]||(x[7]=E=>f("showFullyCheckedIn",E.target.checked))},null,40,Y2),x[18]||(x[18]=r("span",{class:"status-indicator full"},null,-1)),x[19]||(x[19]=r("span",null,"Fully checked-in",-1))])]),e.areas.length>0?(p(),g("div",J2,[r("h4",null,b(N(a).areas),1),Ee(R2,{areas:e.areas,"selected-area-ids":e.filters.selectedAreaIds,"onUpdate:selectedAreaIds":x[8]||(x[8]=E=>f("selectedAreaIds",E))},null,8,["areas","selected-area-ids"])])):D("",!0)])):D("",!0)])):D("",!0),(p(!0),g(xe,null,qe(e.actions,E=>(p(),g("div",{key:E.id,class:le(["toolbar-btn-wrapper",{hidden:l.value}])},[r("button",{class:le(["toolbar-btn",{active:c.value===E.id}]),onClick:$=>m(E),title:E.label||E.id},[E.icon==="plus"?(p(),g("svg",Q2,[...x[20]||(x[20]=[r("line",{x1:"12",y1:"5",x2:"12",y2:"19"},null,-1),r("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1)])])):E.icon==="edit"?(p(),g("svg",eL,[...x[21]||(x[21]=[r("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},null,-1),r("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1)])])):E.icon==="custom"?(p(),g("span",{key:2,innerHTML:E.customIcon},null,8,tL)):D("",!0)],10,X2),E.items&&c.value===E.id?(p(),g("div",nL,[(p(!0),g(xe,null,qe(E.items,$=>(p(),g("button",{key:$.id,onClick:w=>y(E.id,$.id),class:"dropdown-item"},b($.label),9,oL))),128))])):D("",!0)],2))),128))],2))}},Iv=Ze(aL,[["__scopeId","data-v-adedd545"]]),sL={key:0,class:"drawing-controls"},iL={class:"point-count"},lL={class:"undo-redo-buttons"},rL=["disabled"],cL=["disabled"],uL={__name:"MapDrawingControls",props:{pointCount:{type:Number,default:0},canUndo:{type:Boolean,default:!1},canRedo:{type:Boolean,default:!1},show:{type:Boolean,default:!0}},emits:["undo","redo"],setup(e,{emit:t}){const n=e,a=t,o=z(()=>n.show&&n.pointCount>0),i=l=>{if(!o.value)return;const d=navigator.platform.toUpperCase().indexOf("MAC")>=0?l.metaKey:l.ctrlKey;d&&l.key==="z"&&!l.shiftKey?(l.preventDefault(),n.canUndo&&a("undo")):d&&(l.key==="y"||l.key==="z"&&l.shiftKey)&&(l.preventDefault(),n.canRedo&&a("redo"))};return rn(()=>{document.addEventListener("keydown",i)}),An(()=>{document.removeEventListener("keydown",i)}),(l,c)=>o.value?(p(),g("div",sL,[r("div",iL,b(e.pointCount)+" point"+b(e.pointCount!==1?"s":""),1),r("div",lL,[r("button",{onClick:c[0]||(c[0]=d=>l.$emit("undo")),class:"btn-drawing undo-btn",disabled:!e.canUndo,title:"Undo last point (Ctrl+Z)"},"  Undo ",8,rL),r("button",{onClick:c[1]||(c[1]=d=>l.$emit("redo")),class:"btn-drawing redo-btn",disabled:!e.canRedo,title:"Redo point (Ctrl+Y)"}," Redo  ",8,cL)])])):D("",!0)}},xv=Ze(uL,[["__scopeId","data-v-6cd009cb"]]),dL={class:"context-info"},hL={class:"action-buttons"},fL=["disabled"],pL={key:0,class:"fullscreen-map-banner"},vL={class:"fullscreen-map-container"},mL={key:1,class:"fullscreen-map-footer"},gL={__name:"MapFullscreenModal",props:{show:{type:Boolean,required:!0},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},title:{type:String,default:""},description:{type:String,default:""},canComplete:{type:Boolean,default:!1},headerStyle:{type:Object,default:()=>({})},headerTextColor:{type:String,default:""}},emits:["done","cancel","close"],setup(e,{emit:t}){const n=e,a=z(()=>n.headerTextColor?{color:n.headerTextColor}:{}),o=t,i=()=>{o("done")},l=()=>{o("cancel")},c=()=>{o("close")},d=h=>{h.key==="Escape"&&n.show&&(n.mode==="view"?c():l())};return Ye(()=>n.show,h=>{h?(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"):(document.body.style.overflow="",document.documentElement.style.overflow="")},{immediate:!0}),rn(()=>{document.addEventListener("keydown",d)}),An(()=>{document.removeEventListener("keydown",d),document.body.style.overflow="",document.documentElement.style.overflow=""}),(h,f)=>(p(),ze(Xr,{to:"body"},[e.show?(p(),g("div",{key:0,class:"fullscreen-map-overlay",onTouchmove:f[0]||(f[0]=ct(()=>{},["prevent","self"]))},[r("div",{class:le(["fullscreen-map-header",{compact:e.mode==="view"}]),style:nt(e.headerStyle)},[r("div",dL,[r("h3",{style:nt({color:e.headerTextColor})},b(e.title),5),e.description?(p(),g("p",{key:0,style:nt({color:e.headerTextColor,opacity:.85})},b(e.description),5)):D("",!0)]),r("div",hL,[ko(h.$slots,"actions",{},void 0,!0),e.mode==="view"?(p(),g("button",{key:0,type:"button",onClick:ct(c,["stop"]),class:"btn btn-close-x",style:nt(a.value),title:"Close"},[...f[1]||(f[1]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"20",height:"20"},[r("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])],4)):(p(),g(xe,{key:1},[r("button",{type:"button",onClick:l,class:"btn btn-cancel"}," Cancel "),r("button",{type:"button",onClick:i,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,fL)],64))])],6),h.$slots.banner?(p(),g("div",pL,[ko(h.$slots,"banner",{},void 0,!0)])):D("",!0),r("div",vL,[ko(h.$slots,"default",{},void 0,!0)]),h.$slots.footer?(p(),g("div",mL,[ko(h.$slots,"footer",{},void 0,!0)])):D("",!0)],32)):D("",!0)]))}},yL=Ze(gL,[["__scopeId","data-v-a1e3e36c"]]),kL={class:"map-wrapper"},bL={class:"fullscreen-map-wrapper"},_L={__name:"CommonMap",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},editingPolygon:{type:Array,default:null},height:{type:String,default:"400px"},showFullscreen:{type:Boolean,default:!0},showFilters:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]},toolbarPosition:{type:String,default:"top-right"},filters:{type:Object,default:()=>({showRoute:!0,showAreaOverlays:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},fullscreenTitle:{type:String,default:""},fullscreenDescription:{type:String,default:""},fullscreenHeaderStyle:{type:Object,default:()=>({})},fullscreenHeaderTextColor:{type:String,default:""},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","visibility-change","point-selected","polygon-complete","polygon-drawing","polygon-update","fullscreen-change","filter-change","action-click","fullscreen-done","fullscreen-cancel"],setup(e,{expose:t,emit:n}){const a=e,o=n,i=P(null),l=P(null),c=P(null),d=P(null),h=P(!1),f=P(0),m=P(!1),y=P(!1),k=P({...a.filters});Ye(()=>a.filters,Z=>{k.value={...Z}},{deep:!0}),Ye(()=>a.areas,Z=>{a.showFilters&&Z.length>0&&(!k.value.selectedAreaIds||k.value.selectedAreaIds.length===0)&&(k.value.selectedAreaIds=Z.map(se=>se.id))},{immediate:!0});const S=z(()=>a.showFilters?a.locations.filter(Z=>{const se=Z.checkedInCount||0,U=Z.requiredMarshals||1,Q=se===0,oe=se>0&&se<U,he=se>=U;if(Q&&!k.value.showUncheckedIn||oe&&!k.value.showPartiallyCheckedIn||he&&!k.value.showFullyCheckedIn)return!1;const Te=Z.areaIds||Z.AreaIds||[];return!(a.areas.length>0&&Te.length>0&&(!k.value.selectedAreaIds||k.value.selectedAreaIds.length===0||!Te.some(He=>k.value.selectedAreaIds.includes(He))))}):a.locations),x=z(()=>a.showFilters?k.value.showRoute?a.route:[]:a.route),E=z(()=>a.showFilters?k.value.showAreaOverlays===!1?[]:k.value.selectedAreaIds&&k.value.selectedAreaIds.length>0?a.areas.filter(Z=>k.value.selectedAreaIds.includes(Z.id)):a.areas.length>0?[]:a.areas:a.areas),$=z(()=>a.mode==="select-point"?!0:a.mode==="draw-polygon"?f.value>=3:!0),w=()=>h.value?l.value:i.value,_=()=>{h.value=!0,o("fullscreen-change",!0)},I=()=>{h.value=!1,o("fullscreen-change",!1)},T=()=>{if(a.mode==="draw-polygon"){const Z=w();Z&&Z.clearPolygonDrawing(),f.value=0,m.value=!1,y.value=!1}h.value=!1,o("fullscreen-cancel"),o("fullscreen-change",!1)},B=()=>{if(a.mode==="draw-polygon"&&f.value>=3){const Z=w();Z&&Z.completePolygon()}h.value=!1,o("fullscreen-done"),o("fullscreen-change",!1)},M=Z=>{k.value=Z,o("filter-change",Z)},R=Z=>{a.mode==="select-point"&&o("point-selected",Z),o("map-click",Z)},A=Z=>{f.value=Z?.length||0,j(),o("polygon-drawing",Z)},G=Z=>{o("polygon-complete",Z),f.value=0,m.value=!1,y.value=!1},F=Z=>{o("polygon-update",Z)},j=()=>{const Z=w();Z&&(m.value=Z.canUndo?Z.canUndo():!1,y.value=Z.canRedo?Z.canRedo():!1)},K=()=>{const Z=w();Z&&Z.undoPolygonPoint&&(Z.undoPolygonPoint(),j())},J=()=>{const Z=w();Z&&Z.redoPolygonPoint&&(Z.redoPolygonPoint(),j())};return t({getMapCenter:()=>w()?.getMapCenter?.(),getMapZoom:()=>w()?.getMapZoom?.(),undoPolygonPoint:K,redoPolygonPoint:J,canUndo:()=>m.value,canRedo:()=>y.value,getPolygonPointCount:()=>f.value,completePolygon:()=>w()?.completePolygon?.(),clearPolygonDrawing:()=>{w()?.clearPolygonDrawing?.(),f.value=0,m.value=!1,y.value=!1},recenterOnUserLocation:()=>w()?.recenterOnUserLocation?.(),recenterOnLocation:(Z,se,U)=>w()?.recenterOnLocation?.(Z,se,U),isLocationInView:(Z,se)=>w()?.isLocationInView?.(Z,se)??!0,getUserLocationInView:()=>w()?.userLocationInView?.value??!0,getHighlightedLocationInView:()=>w()?.highlightedLocationInView?.value??!0,openFullscreen:()=>{h.value=!0,o("fullscreen-change",!0)},closeFullscreen:I,closeDropdowns:()=>{c.value&&c.value.closeDropdowns(),d.value&&d.value.closeDropdowns()}}),(Z,se)=>(p(),g("div",{class:"common-map",style:nt({height:e.height})},[r("div",kL,[Ee(Yh,{ref_key:"mapViewRef",ref:i,locations:S.value,route:x.value,areas:E.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:se[0]||(se[0]=U=>Z.$emit("location-click",U)),onMapClick:R,onAreaClick:se[1]||(se[1]=U=>Z.$emit("area-click",U)),onPolygonComplete:G,onPolygonDrawing:A,onPolygonUpdate:F,onVisibilityChange:se[2]||(se[2]=U=>Z.$emit("visibility-change",U))},null,8,["locations","route","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Ee(Iv,{ref_key:"toolbarRef",ref:c,"show-fullscreen":e.showFullscreen,"show-filters":e.showFilters,filters:k.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFullscreenClick:_,onFilterChange:M,onActionClick:se[3]||(se[3]=U=>Z.$emit("action-click",U))},null,8,["show-fullscreen","show-filters","filters","areas","actions","position"]),Ee(xv,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":m.value,"can-redo":y.value,onUndo:K,onRedo:J},null,8,["show","point-count","can-undo","can-redo"])]),Ee(yL,{show:h.value,mode:e.mode,title:e.fullscreenTitle,description:e.fullscreenDescription,"can-complete":$.value,"header-style":e.fullscreenHeaderStyle,"header-text-color":e.fullscreenHeaderTextColor,onDone:B,onCancel:T,onClose:I},yf({default:Ue(()=>[r("div",bL,[Ee(Yh,{ref_key:"fullscreenMapViewRef",ref:l,locations:S.value,route:x.value,areas:E.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:se[4]||(se[4]=U=>Z.$emit("location-click",U)),onMapClick:R,onAreaClick:se[5]||(se[5]=U=>Z.$emit("area-click",U)),onPolygonComplete:G,onPolygonDrawing:A,onPolygonUpdate:F,onVisibilityChange:se[6]||(se[6]=U=>Z.$emit("visibility-change",U))},null,8,["locations","route","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Ee(Iv,{ref_key:"fullscreenToolbarRef",ref:d,"show-fullscreen":!1,"show-filters":e.showFilters,filters:k.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFilterChange:M,onActionClick:se[7]||(se[7]=U=>Z.$emit("action-click",U))},null,8,["show-filters","filters","areas","actions","position"]),Ee(xv,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":m.value,"can-redo":y.value,onUndo:K,onRedo:J},null,8,["show","point-count","can-undo","can-redo"])])]),_:2},[Z.$slots["fullscreen-actions"]?{name:"actions",fn:Ue(()=>[ko(Z.$slots,"fullscreen-actions",{},void 0,!0)]),key:"0"}:void 0,Z.$slots["fullscreen-banner"]?{name:"banner",fn:Ue(()=>[ko(Z.$slots,"fullscreen-banner",{},void 0,!0)]),key:"1"}:void 0,Z.$slots["fullscreen-footer"]?{name:"footer",fn:Ue(()=>[ko(Z.$slots,"fullscreen-footer",{},void 0,!0)]),key:"2"}:void 0]),1032,["show","mode","title","description","can-complete","header-style","header-text-color"])],4))}},hl=Ze(_L,[["__scopeId","data-v-4ba30c05"]]),wL={class:"course-areas-tab"},CL={__name:"CourseAreasTab",props:{checkpoints:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1}},emits:["map-click","location-click","area-click","import-checkpoints","upload-route","select-location","add-area","select-area","polygon-complete","cancel-drawing","add-checkpoint-from-map","add-many-checkpoints-from-map","add-area-from-map"],setup(e,{expose:t,emit:n}){const{terms:a,termsLower:o}=ht(),i=e,l=n,c=P(null),d=P(null),h=P(0),f=P({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]}),m=z(()=>[{id:"add",icon:"plus",label:"Add",items:[{id:"checkpoint",label:a.value.checkpoint},{id:"many-checkpoints",label:`Many ${o.value.checkpoints}`},{id:"area",label:a.value.area},{id:"import",label:`Import ${o.value.checkpoints}...`},{id:"upload",label:`Upload ${o.value.course}...`}]}]),y=({actionId:w,itemId:_})=>{w==="add"&&(_==="checkpoint"?(l("add-checkpoint-from-map"),x()):_==="many-checkpoints"?(l("add-many-checkpoints-from-map"),x()):_==="area"?(l("add-area-from-map"),x()):_==="import"?l("import-checkpoints"):_==="upload"&&l("upload-route"))},k=w=>{f.value=w},S=w=>{h.value=w?.length||0},x=()=>{c.value&&c.value.scrollIntoView({behavior:"smooth",block:"start"})};return t({scrollMapIntoView:x,getMapCenter:()=>d.value?.getMapCenter()||null,getMapZoom:()=>d.value?.getMapZoom()||null}),Ye(()=>i.areas,w=>{if(w.length>0){const _=new Set(f.value.selectedAreaIds);w.forEach(I=>{_.has(I.id)||f.value.selectedAreaIds.push(I.id)}),f.value.selectedAreaIds=f.value.selectedAreaIds.filter(I=>w.some(T=>T.id===I))}},{immediate:!0}),Ye(()=>i.drawingMode,w=>{w||(h.value=0)}),(w,_)=>(p(),g("div",wL,[r("div",{class:"map-section",ref_key:"mapSection",ref:c},[Ee(hl,{ref_key:"commonMapRef",ref:d,locations:e.checkpoints,route:e.route,areas:e.areas,"all-locations-for-bounds":e.checkpoints,"selected-area-id":e.selectedAreaId,clickable:!0,mode:e.drawingMode?"draw-polygon":"view",height:"100%","show-filters":"",filters:f.value,"toolbar-actions":m.value,"fullscreen-title":e.drawingMode?`Draw ${N(o).area} boundary`:N(a).course,"fullscreen-description":e.drawingMode?"Click on the map to draw the boundary":"",onMapClick:_[0]||(_[0]=I=>w.$emit("map-click",I)),onLocationClick:_[1]||(_[1]=I=>w.$emit("location-click",I)),onAreaClick:_[2]||(_[2]=I=>w.$emit("area-click",I)),onPolygonComplete:_[3]||(_[3]=I=>w.$emit("polygon-complete",I)),onPolygonDrawing:S,onFilterChange:k,onActionClick:y},null,8,["locations","route","areas","all-locations-for-bounds","selected-area-id","mode","filters","toolbar-actions","fullscreen-title","fullscreen-description"])],512)]))}},LL=Ze(CL,[["__scopeId","data-v-c0e54ae9"]]),SL=(e,t)=>{const n=String(e).trim(),a=String(t).trim(),o=parseFloat(n),i=parseFloat(a),l=!isNaN(o)&&String(o)===n,c=!isNaN(i)&&String(i)===a;return l&&c?o-i:n.localeCompare(a,void 0,{numeric:!0,sensitivity:"base"})},IL={__name:"StatusPill",props:{variant:{type:String,default:"neutral",validator:e=>["neutral","success","warning","danger","info","purple"].includes(e)},active:{type:Boolean,default:!1}},emits:["click"],setup(e){return(t,n)=>(p(),g("button",{class:le(["status-pill",[e.variant,{active:e.active}]]),onClick:n[0]||(n[0]=a=>t.$emit("click"))},[ko(t.$slots,"default",{},void 0,!0)],2))}},Et=Ze(IL,[["__scopeId","data-v-a94deea5"]]),xL={class:"check-in-toggle-container"},$L=["disabled"],TL={key:0,class:"toggle-spinner"},ML={key:1,class:"toggle-icon"},AL={class:"toggle-label"},EL={key:0,class:"check-in-details"},PL={key:0,class:"check-in-method"},DL={__name:"CheckInToggleButton",props:{isCheckedIn:{type:Boolean,default:!1},checkInTime:{type:String,default:null},checkInMethod:{type:String,default:null},checkedInBy:{type:String,default:null},marshalName:{type:String,default:null},isLoading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},distance:{type:Number,default:null}},emits:["toggle","distance-click"],setup(e){const t=e,n=z(()=>t.distance===null||t.distance===void 0?null:t.distance<1e3?`${Math.round(t.distance)} m`:`${(t.distance/1e3).toFixed(2)} km`),a=z(()=>t.distance===null||t.distance===void 0?"":t.distance<=50?"distance-close":t.distance<=100?"distance-medium":"distance-far"),o=z(()=>t.isLoading?t.isCheckedIn?"Checking out...":"Checking in...":t.isCheckedIn?"Checked in":"Check in"),i=z(()=>{const{checkedInBy:c,checkInMethod:d,marshalName:h}=t;return c&&c!==h?c:d||""}),l=c=>c?new Date(c).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"";return(c,d)=>(p(),g("div",xL,[r("button",{class:le(["check-in-toggle",{"is-checked-in":e.isCheckedIn}]),disabled:e.disabled||e.isLoading,onClick:d[0]||(d[0]=h=>c.$emit("toggle"))},[e.isLoading?(p(),g("span",TL)):e.isCheckedIn?(p(),g("span",ML,"")):D("",!0),r("span",AL,b(o.value),1)],10,$L),e.isCheckedIn&&e.checkInTime&&!e.isLoading?(p(),g("span",EL,[Je(b(l(e.checkInTime))+" ",1),i.value?(p(),g("span",PL,"("+b(i.value)+")",1)):D("",!0),n.value?(p(),g("span",{key:1,class:le(["check-in-distance",a.value]),onClick:d[1]||(d[1]=ct(h=>c.$emit("distance-click"),["stop"]))},b(n.value),3)):D("",!0)])):D("",!0)]))}},wu=Ze(DL,[["__scopeId","data-v-f08ae7ff"]]),RL={class:"confirm-modal"},OL={class:"confirm-actions"},BL={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},showCancel:{type:Boolean,default:!0},isDanger:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(e,{emit:t}){const n=t,a=()=>{n("confirm")},o=()=>{n("cancel")};return(i,l)=>e.show?(p(),g("div",{key:0,class:"modal-overlay",onClick:ct(o,["self"])},[r("div",RL,[r("h3",null,b(e.title),1),r("p",null,b(e.message),1),r("div",OL,[e.showCancel?(p(),g("button",{key:0,onClick:o,class:"btn btn-secondary"},b(e.cancelText),1)):D("",!0),r("button",{onClick:a,class:le(["btn",e.isDanger?"btn-danger":"btn-primary"])},b(e.confirmText),3)])])])):D("",!0)}},vi=Ze(BL,[["__scopeId","data-v-b3f01e55"]]),NL={class:"base-modal-header"},FL={class:"base-modal-header-content"},UL={key:0,class:"base-modal-title"},zL={key:0,class:"base-modal-tab-header"},HL={key:1,class:"base-modal-footer"},VL={key:0,class:"base-modal-actions"},GL={__name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},variant:{type:String,default:"center",validator:e=>["center","sidebar"].includes(e)},zIndex:{type:Number,default:1e3},closeOnOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},confirmOnClose:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const n=()=>{const _=document.documentElement,I=getComputedStyle(_).getPropertyValue("--modal-resize-duration").trim();return I.endsWith("s")?parseFloat(I)*1e3:300},a=e,o=t,i=P(!1),l=P(!1),c=P(null),d=P(null);let h=null,f=!1,m=0;const y=()=>{if(!d.value||!c.value||f)return;const _=d.value.scrollHeight,I=m;if(I===_||m===0){m=_;return}f=!0,d.value.style.height=`${I}px`,d.value.style.overflow="hidden",d.value.offsetHeight,d.value.style.transition="height var(--modal-resize-duration, 0.3s) ease",d.value.style.height=`${_}px`;const T=n();setTimeout(()=>{d.value&&(d.value.style.height="",d.value.style.overflow="",d.value.style.transition=""),f=!1,m=_},T)},k=()=>{!c.value||typeof MutationObserver>"u"||(d.value&&(m=d.value.scrollHeight),h=new MutationObserver(()=>{dn(()=>{y()})}),h.observe(c.value,{childList:!0,subtree:!0,attributes:!0,characterData:!0}))},S=()=>{h&&(h.disconnect(),h=null)};rn(()=>{dn(()=>{a.show&&k()})}),An(()=>{S()}),Ye(()=>a.show,_=>{_?dn(()=>{m=0,k()}):S()});const x=()=>{a.closeOnOverlay&&E()},E=()=>{a.confirmOnClose&&a.isDirty?i.value=!0:o("close")},$=()=>{i.value=!1,o("close")},w=()=>{i.value=!1};return(_,I)=>(p(),ze(Ca,{name:"modal",appear:""},{default:Ue(()=>[e.show?(p(),g("div",{key:0,class:"base-modal-overlay",style:nt({zIndex:e.zIndex}),onClick:ct(x,["self"])},[r("div",{class:le(["base-modal",[`base-modal--${e.size}`,`base-modal--${e.variant}`]])},[r("div",NL,[r("div",FL,[ko(_.$slots,"header",{},()=>[e.title?(p(),g("h2",UL,b(e.title),1)):D("",!0)],!0)]),e.showCloseButton?(p(),g("button",{key:0,onClick:E,class:"base-modal-close",type:"button","aria-label":"Close"},"  ")):D("",!0)]),_.$slots["tab-header"]?(p(),g("div",zL,[ko(_.$slots,"tab-header",{},void 0,!0)])):D("",!0),r("div",{class:"base-modal-body",ref_key:"bodyRef",ref:c},[r("div",{class:"base-modal-body-content",ref_key:"contentRef",ref:d},[ko(_.$slots,"default",{},void 0,!0)],512)],512),_.$slots.footer||_.$slots.actions?(p(),g("div",HL,[ko(_.$slots,"footer",{},()=>[_.$slots.actions?(p(),g("div",VL,[ko(_.$slots,"actions",{},void 0,!0)])):D("",!0)],!0)])):D("",!0)],2),e.confirmOnClose&&!l.value?(p(),ze(vi,{key:0,show:i.value,title:"Unsaved changes",message:"You have unsaved changes. Are you sure you want to close?",onConfirm:$,onCancel:w},null,8,["show"])):D("",!0)],4)):D("",!0)]),_:3}))}},jt=Ze(GL,[["__scopeId","data-v-141bdab1"]]),qL={class:"map-modal-content"},jL={class:"location-info"},WL={key:0,class:"info-row"},ZL={class:"info-value"},KL={key:1,class:"info-row"},YL={class:"info-label"},JL={class:"info-value"},XL={key:2,class:"info-row distance-row"},QL={__name:"CheckInLocationMapModal",props:{show:{type:Boolean,default:!1},marshalName:{type:String,default:""},checkpointName:{type:String,default:""},checkInLocation:{type:Object,default:null},checkpointLocation:{type:Object,default:null},distance:{type:Number,default:null},zIndex:{type:Number,default:1100}},emits:["close"],setup(e){const{terms:t}=ht(),n=e,a=P(null);let o=null,i=null,l=null;const c=z(()=>t.value.checkpoint),d=z(()=>n.marshalName&&n.checkpointName?`${n.marshalName} - ${n.checkpointName}`:n.marshalName?n.marshalName:"Check-in location"),h=z(()=>n.distance===null?"":n.distance<1e3?`${Math.round(n.distance)} m`:`${(n.distance/1e3).toFixed(2)} km`),f=z(()=>n.distance===null?"":n.distance<=50?"distance-close":n.distance<=100?"distance-medium":"distance-far"),m=(x,E)=>x==null||E==null?"Unknown":`${x.toFixed(6)}, ${E.toFixed(6)}`,y=()=>{if(!a.value||o)return;let x=[51.505,-.09],E=15;n.checkInLocation&&(x=[n.checkInLocation.lat,n.checkInLocation.lng]),o=Kt.map(a.value).setView(x,E),Kt.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors",maxZoom:19}).addTo(o),k()},k=()=>{if(!o)return;i&&(i.remove(),i=null),l&&(l.remove(),l=null);const x=[];if(n.checkInLocation){const E=Kt.divIcon({className:"check-in-location-marker",html:`
        <div style="position: relative; width: 24px; height: 24px;">
          <div style="
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background-color: #4285f4;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
          "></div>
          <div style="
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            background-color: rgba(66, 133, 244, 0.2);
            border-radius: 50%;
            animation: pulse 2s ease-out infinite;
          "></div>
        </div>
      `,iconSize:[40,40],iconAnchor:[20,20]});i=Kt.marker([n.checkInLocation.lat,n.checkInLocation.lng],{icon:E}).addTo(o).bindPopup(`<b>${n.marshalName||"Marshal"}</b><br>Check-in location`),x.push([n.checkInLocation.lat,n.checkInLocation.lng])}if(n.checkpointLocation&&n.checkpointLocation.lat&&n.checkpointLocation.lng){const E=Kt.divIcon({className:"checkpoint-location-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center;">
          <div style="
            width: 32px;
            height: 32px;
            background-color: #667eea;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
          ">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="white">
              <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
            </svg>
          </div>
          <div style="
            background-color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: bold;
            color: #333;
            white-space: nowrap;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${n.checkpointName||t.value.checkpoint}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]});l=Kt.marker([n.checkpointLocation.lat,n.checkpointLocation.lng],{icon:E}).addTo(o).bindPopup(`<b>${n.checkpointName||t.value.checkpoint}</b><br>${t.value.checkpoint} location`),x.push([n.checkpointLocation.lat,n.checkpointLocation.lng])}if(x.length===2){const E=Kt.latLngBounds(x);o.fitBounds(E,{padding:[50,50],maxZoom:17})}else x.length===1&&o.setView(x[0],16)},S=()=>{o&&(o.remove(),o=null,i=null,l=null)};return Ye(()=>n.show,async x=>{x?(await dn(),setTimeout(()=>{y()},100)):S()}),Ye([()=>n.checkInLocation,()=>n.checkpointLocation],()=>{o&&k()},{deep:!0}),rn(()=>{n.show&&dn(()=>{setTimeout(()=>{y()},100)})}),An(()=>{S()}),(x,E)=>(p(),ze(jt,{show:e.show,title:d.value,size:"medium","z-index":e.zIndex,onClose:E[0]||(E[0]=$=>x.$emit("close"))},{default:Ue(()=>[r("div",qL,[r("div",{class:"map-container",ref_key:"mapContainer",ref:a},null,512),r("div",jL,[e.checkInLocation?(p(),g("div",WL,[E[1]||(E[1]=r("span",{class:"info-label"},"Check-in location:",-1)),r("span",ZL,b(m(e.checkInLocation.lat,e.checkInLocation.lng)),1)])):D("",!0),e.checkpointLocation?(p(),g("div",KL,[r("span",YL,b(c.value)+" location:",1),r("span",JL,b(m(e.checkpointLocation.lat,e.checkpointLocation.lng)),1)])):D("",!0),e.distance!==null?(p(),g("div",XL,[E[2]||(E[2]=r("span",{class:"info-label"},"Distance:",-1)),r("span",{class:le(["info-value distance-value",f.value])},b(h.value),3)])):D("",!0)])])]),_:1},8,["show","title","z-index"]))}},Pf=Ze(QL,[["__scopeId","data-v-011fa479"]]),eS={class:"marshals-tab"},tS={class:"tab-header"},nS={class:"button-group"},oS={key:0,class:"status-pills"},aS={class:"filters-section"},sS={class:"search-group"},iS={class:"marshals-grid"},lS={class:"marshals-table"},rS={key:0,class:"sort-indicator"},cS={key:0,class:"sort-indicator"},uS={key:0,class:"sort-indicator"},dS={key:0,class:"sort-indicator"},hS=["onClick"],fS=["rowspan"],pS={class:"checkpoint-cell"},vS={class:"checkpoint-name"},mS={key:0,class:"checkpoint-description"},gS=["rowspan"],yS={key:0,class:"last-active-text"},kS={key:1,class:"last-active-never"},bS=["onClick"],_S={class:"no-checkpoint-text"},wS={class:"hide-on-mobile last-active-cell"},CS={key:0,class:"last-active-text"},LS={key:1,class:"last-active-never"},SS={__name:"MarshalsTab",props:{marshals:{type:Array,required:!0},assignments:{type:Array,required:!0},locations:{type:Array,required:!0}},emits:["add-marshal","import-marshals","select-marshal","delete-marshal","toggle-check-in"],setup(e,{expose:t,emit:n}){const{terms:a}=ht(),o=e,i=n,l=P(null),c=P(!1),d=P(null),h=V=>{l.value=V},f=V=>{d.value=V,c.value=!0},m=()=>{c.value=!1,d.value=null},y=z(()=>d.value?Te(d.value.marshalId):""),k=z(()=>d.value?oe(d.value.locationId):""),S=z(()=>{if(!d.value)return null;const{checkInLatitude:V,checkInLongitude:Y}=d.value;return!V||!Y?null:{lat:V,lng:Y}}),x=z(()=>{if(!d.value)return null;const V=Q(d.value.locationId);return!V?.latitude||!V?.longitude?null:{lat:V.latitude,lng:V.longitude}}),E=z(()=>d.value?je(d.value):null),$=P(!1),w=P(null),_=V=>{V.isCheckedIn?(w.value=V,$.value=!0):i("toggle-check-in",V)},I=()=>{w.value&&i("toggle-check-in",w.value),$.value=!1,w.value=null},T=()=>{$.value=!1,w.value=null},B=z(()=>w.value?`Are you sure you want to undo ${Te(w.value.marshalId)}'s check-in?`:"");t({setCheckingIn:h});const M=P("name"),R=P("asc"),A=P(""),G=P("all"),F=V=>{G.value=V},j=V=>{M.value===V?R.value=R.value==="asc"?"desc":"asc":(M.value=V,R.value="asc")},K=V=>o.assignments.filter(Y=>Y.marshalId===V),J=z(()=>new Set(o.assignments.filter(V=>V.isCheckedIn).map(V=>V.marshalId))),ue=z(()=>new Set(o.assignments.map(V=>V.marshalId))),Z=z(()=>J.value.size),se=z(()=>o.marshals.filter(V=>!ue.value.has(V.id)).length),U=z(()=>o.marshals.filter(V=>ue.value.has(V.id)&&!J.value.has(V.id)).length),Q=V=>o.locations.find(Y=>Y.id===V),oe=V=>{const Y=Q(V);return Y?Y.name:"Unknown"},he=V=>{const Y=Q(V);return Y?Y.description:""},Te=V=>{const Y=o.marshals.find(re=>re.id===V);return Y?Y.name:""},je=V=>{const{checkInLatitude:Y,checkInLongitude:re,locationId:ie}=V,$e=Q(ie);return!Y||!re||!$e?.latitude||!$e?.longitude?null:dl(Y,re,$e.latitude,$e.longitude)},He=V=>{if(!V)return"";const Y=new Date(V),ie=new Date-Y,$e=Math.floor(ie/6e4),q=Math.floor($e/60),X=Math.floor(q/24);return $e<1?"just now":$e<60?`${$e}m ago`:q<24?`${q}h ago`:X===1?"yesterday":X<7?`${X}d ago`:Y.toLocaleDateString()},We=z(()=>{let V=o.marshals;if(G.value==="unassigned"?V=V.filter(Y=>!ue.value.has(Y.id)):G.value==="checked-in"?V=V.filter(Y=>J.value.has(Y.id)):G.value==="not-checked-in"&&(V=V.filter(Y=>ue.value.has(Y.id)&&!J.value.has(Y.id))),A.value.trim()){const Y=A.value.toLowerCase().trim().split(/\s+/);V=V.filter(re=>{const $e=K(re.id).map(X=>{const ee=Q(X.locationId);return ee?`${ee.name||""} ${ee.description||""}`:""}).join(" "),q=`${re.name} ${$e}`.toLowerCase();return Y.every(X=>q.includes(X))})}return V}),be=z(()=>{const V=[...We.value];return V.sort((Y,re)=>{let ie=0;if(M.value==="name")ie=Y.name.localeCompare(re.name);else if(M.value==="checkpoint"){const $e=K(Y.id),q=K(re.id),X=$e.length>0?oe($e[0].locationId):"",ee=q.length>0?oe(q[0].locationId):"";ie=SL(X,ee)}else if(M.value==="status"){const $e=K(Y.id),q=K(re.id),X=$e.length>0&&$e[0].isCheckedIn?1:0;ie=(q.length>0&&q[0].isCheckedIn?1:0)-X}else if(M.value==="lastActive"){const $e=Y.lastAccessedDate?new Date(Y.lastAccessedDate).getTime():0;ie=(re.lastAccessedDate?new Date(re.lastAccessedDate).getTime():0)-$e}return R.value==="asc"?ie:-ie}),V});return(V,Y)=>(p(),g("div",eS,[r("div",tS,[r("div",nS,[r("button",{onClick:Y[0]||(Y[0]=re=>V.$emit("add-marshal")),class:"btn btn-primary"}," Add "+b(N(a).person.toLowerCase()),1),r("button",{onClick:Y[1]||(Y[1]=re=>V.$emit("import-marshals")),class:"btn btn-secondary"}," Import CSV ")]),e.marshals.length>0?(p(),g("div",oS,[Ee(Et,{variant:"neutral",active:G.value==="all",onClick:Y[2]||(Y[2]=re=>F("all"))},{default:Ue(()=>[Je(b(e.marshals.length)+" total ",1)]),_:1},8,["active"]),se.value>0&&se.value<e.marshals.length?(p(),ze(Et,{key:0,variant:"warning",active:G.value==="unassigned",onClick:Y[3]||(Y[3]=re=>F("unassigned"))},{default:Ue(()=>[Je(b(se.value)+" unassigned ",1)]),_:1},8,["active"])):D("",!0),Z.value>0&&Z.value<e.marshals.length?(p(),ze(Et,{key:1,variant:"success",active:G.value==="checked-in",onClick:Y[4]||(Y[4]=re=>F("checked-in"))},{default:Ue(()=>[Je(b(Z.value)+" checked in ",1)]),_:1},8,["active"])):D("",!0),U.value>0&&U.value<e.marshals.length?(p(),ze(Et,{key:2,variant:"danger",active:G.value==="not-checked-in",onClick:Y[5]||(Y[5]=re=>F("not-checked-in"))},{default:Ue(()=>[Je(b(U.value)+" not checked in ",1)]),_:1},8,["active"])):D("",!0)])):D("",!0)]),r("div",aS,[r("div",sS,[Ge(r("input",{"onUpdate:modelValue":Y[6]||(Y[6]=re=>A.value=re),type:"text",class:"search-input",placeholder:"Search by name, checkpoint, or description..."},null,512),[[st,A.value]])])]),r("div",iS,[r("table",lS,[r("thead",null,[r("tr",null,[r("th",{onClick:Y[7]||(Y[7]=re=>j("name")),class:"sortable"},[Y[12]||(Y[12]=Je(" Name ",-1)),M.value==="name"?(p(),g("span",rS,b(R.value==="asc"?"":""),1)):D("",!0)]),r("th",{onClick:Y[8]||(Y[8]=re=>j("checkpoint")),class:"sortable"},[Je(b(N(a).checkpoint)+" ",1),M.value==="checkpoint"?(p(),g("span",cS,b(R.value==="asc"?"":""),1)):D("",!0)]),r("th",{onClick:Y[9]||(Y[9]=re=>j("status")),class:"sortable"},[Y[13]||(Y[13]=Je(" Status ",-1)),M.value==="status"?(p(),g("span",uS,b(R.value==="asc"?"":""),1)):D("",!0)]),r("th",{onClick:Y[10]||(Y[10]=re=>j("lastActive")),class:"sortable hide-on-mobile"},[Y[14]||(Y[14]=Je(" Last active ",-1)),M.value==="lastActive"?(p(),g("span",dS,b(R.value==="asc"?"":""),1)):D("",!0)])])]),r("tbody",null,[(p(!0),g(xe,null,qe(be.value,re=>(p(),g(xe,{key:re.id},[K(re.id).length>0?(p(!0),g(xe,{key:0},qe(K(re.id),(ie,$e)=>(p(),g("tr",{key:`${re.id}-${ie.id}`,class:"marshal-row",onClick:q=>V.$emit("select-marshal",re)},[$e===0?(p(),g("td",{key:0,rowspan:K(re.id).length},b(re.name),9,fS)):D("",!0),r("td",pS,[r("div",vS,b(oe(ie.locationId)),1),he(ie.locationId)?(p(),g("div",mS,b(he(ie.locationId)),1)):D("",!0)]),r("td",{onClick:Y[11]||(Y[11]=ct(()=>{},["stop"])),class:"check-in-cell"},[Ee(wu,{"is-checked-in":ie.isCheckedIn,"check-in-time":ie.checkInTime,"check-in-method":ie.checkInMethod,"checked-in-by":ie.checkedInBy,"marshal-name":Te(ie.marshalId),"is-loading":l.value===ie.id,distance:je(ie),onToggle:q=>_(ie),onDistanceClick:q=>f(ie)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","distance","onToggle","onDistanceClick"])]),$e===0?(p(),g("td",{key:1,rowspan:K(re.id).length,class:"hide-on-mobile last-active-cell"},[re.lastAccessedDate?(p(),g("span",yS,b(He(re.lastAccessedDate)),1)):(p(),g("span",kS,"Never"))],8,gS)):D("",!0)],8,hS))),128)):(p(),g("tr",{key:1,class:"marshal-row",onClick:ie=>V.$emit("select-marshal",re)},[r("td",null,b(re.name),1),r("td",_S,"No "+b(N(a).checkpoint.toLowerCase())+" assigned",1),Y[15]||(Y[15]=r("td",null,[r("span",{class:"hide-on-mobile"},"-"),r("span",{class:"status-icon show-on-mobile no-checkpoint-text"},"-")],-1)),r("td",wS,[re.lastAccessedDate?(p(),g("span",CS,b(He(re.lastAccessedDate)),1)):(p(),g("span",LS,"Never"))])],8,bS))],64))),128))])])]),Ee(Pf,{show:c.value,"marshal-name":y.value,"checkpoint-name":k.value,"check-in-location":S.value,"checkpoint-location":x.value,distance:E.value,onClose:m},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance"]),Ee(vi,{show:$.value,title:"Confirm check-out",message:B.value,"confirm-text":"Check out","is-danger":!0,onConfirm:I,onCancel:T},null,8,["show","message"])]))}},IS=Ze(SS,[["__scopeId","data-v-bdb66e38"]]),xS={class:"assignment-pills"},$S={__name:"ScopedAssignmentPills",props:{scopeConfigurations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},maxExpandedItems:{type:Number,default:5}},emits:["click"],setup(e){const{terms:t,termsLower:n}=ht(),a=e,o=h=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${n.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${n.value.checkpoints}`,SpecificPeople:`Specific ${n.value.people}`,EveryAreaLead:`Every ${n.value.area} lead`,OnePerCheckpoint:`One per ${n.value.checkpoint}`,OnePerArea:`One per ${n.value.area}`,OneLeadPerArea:`One lead per ${n.value.area}`,AreaLead:`${t.value.area} lead`})[h]||h,i=h=>({Everyone:"",EveryoneInAreas:"Everyone in",EveryoneAtCheckpoints:"Everyone at",SpecificPeople:"",EveryAreaLead:`${n.value.area} lead in`,OnePerCheckpoint:"One at",OnePerArea:"One in",OneLeadPerArea:"Lead in"})[h]||"",l=(h,f)=>f==="Area"?a.areas.find(y=>y.id===h)?.name||null:f==="Checkpoint"?a.locations.find(y=>y.id===h)?.name||null:f==="Marshal"&&a.marshals.find(y=>y.id===h)?.name||null,c=h=>{if(!h)return[];const f=o(h.scope),m=h.ids||[];if(h.itemType===null||m.length===0)return[f];if(m.includes("ALL_MARSHALS"))return["Everyone"];if(m.includes("ALL_AREAS"))return[`${f} (All ${n.value.areas})`];if(m.includes("ALL_CHECKPOINTS"))return[`${f} (All ${n.value.checkpoints})`];const y=m.filter(S=>l(S,h.itemType)!==null);if(y.length===0)return[];if(y.length>a.maxExpandedItems)return[`${f} (${y.length})`];const k=i(h.scope);return y.map(S=>{const x=l(S,h.itemType);return k?`${k} ${x}`:x})},d=z(()=>{if(!a.scopeConfigurations||a.scopeConfigurations.length===0)return[];const h=[];for(const f of a.scopeConfigurations)h.push(...c(f));return h});return(h,f)=>(p(),g("div",xS,[(p(!0),g(xe,null,qe(d.value,(m,y)=>(p(),g("span",{key:y,class:"scope-badge",onClick:f[0]||(f[0]=k=>h.$emit("click"))},b(m),1))),128))]))}},cl=Ze($S,[["__scopeId","data-v-82c305e5"]]);function $v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,a)}return n}function Ya(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$v(Object(n),!0).forEach(function(a){TS(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$v(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Jc(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Jc=function(t){return typeof t}:Jc=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jc(e)}function TS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ts(){return Ts=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ts.apply(this,arguments)}function MS(e,t){if(e==null)return{};var n={},a=Object.keys(e),o,i;for(i=0;i<a.length;i++)o=a[i],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function AS(e,t){if(e==null)return{};var n=MS(e,t),a,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)a=i[o],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var ES="1.14.0";function Ss(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var Es=Ss(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),vc=Ss(/Edge/i),Tv=Ss(/firefox/i),Gr=Ss(/safari/i)&&!Ss(/chrome/i)&&!Ss(/android/i),Qy=Ss(/iP(ad|od|hone)/i),PS=Ss(/chrome/i)&&Ss(/android/i),e1={capture:!1,passive:!1};function Ht(e,t,n){e.addEventListener(t,n,!Es&&e1)}function Ot(e,t,n){e.removeEventListener(t,n,!Es&&e1)}function Cu(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function DS(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function qa(e,t,n,a){if(e){n=n||document;do{if(t!=null&&(t[0]===">"?e.parentNode===n&&Cu(e,t):Cu(e,t))||a&&e===n)return e;if(e===n)break}while(e=DS(e))}return null}var Mv=/\s+/g;function Bo(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var a=(" "+e.className+" ").replace(Mv," ").replace(" "+t+" "," ");e.className=(a+(n?" "+t:"")).replace(Mv," ")}}function vt(e,t,n){var a=e&&e.style;if(a){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),t===void 0?n:n[t];!(t in a)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),a[t]=n+(typeof n=="string"?"":"px")}}function Yl(e,t){var n="";if(typeof e=="string")n=e;else do{var a=vt(e,"transform");a&&a!=="none"&&(n=a+" "+n)}while(!t&&(e=e.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function t1(e,t,n){if(e){var a=e.getElementsByTagName(t),o=0,i=a.length;if(n)for(;o<i;o++)n(a[o],o);return a}return[]}function Ka(){var e=document.scrollingElement;return e||document.documentElement}function Mn(e,t,n,a,o){if(!(!e.getBoundingClientRect&&e!==window)){var i,l,c,d,h,f,m;if(e!==window&&e.parentNode&&e!==Ka()?(i=e.getBoundingClientRect(),l=i.top,c=i.left,d=i.bottom,h=i.right,f=i.height,m=i.width):(l=0,c=0,d=window.innerHeight,h=window.innerWidth,f=window.innerHeight,m=window.innerWidth),(t||n)&&e!==window&&(o=o||e.parentNode,!Es))do if(o&&o.getBoundingClientRect&&(vt(o,"transform")!=="none"||n&&vt(o,"position")!=="static")){var y=o.getBoundingClientRect();l-=y.top+parseInt(vt(o,"border-top-width")),c-=y.left+parseInt(vt(o,"border-left-width")),d=l+i.height,h=c+i.width;break}while(o=o.parentNode);if(a&&e!==window){var k=Yl(o||e),S=k&&k.a,x=k&&k.d;k&&(l/=x,c/=S,m/=S,f/=x,d=l+f,h=c+m)}return{top:l,left:c,bottom:d,right:h,width:m,height:f}}}function Av(e,t,n){for(var a=li(e,!0),o=Mn(e)[t];a;){var i=Mn(a)[n],l=void 0;if(l=o>=i,!l)return a;if(a===Ka())break;a=li(a,!1)}return!1}function or(e,t,n,a){for(var o=0,i=0,l=e.children;i<l.length;){if(l[i].style.display!=="none"&&l[i]!==mt.ghost&&(a||l[i]!==mt.dragged)&&qa(l[i],n.draggable,e,!1)){if(o===t)return l[i];o++}i++}return null}function Df(e,t){for(var n=e.lastElementChild;n&&(n===mt.ghost||vt(n,"display")==="none"||t&&!Cu(n,t));)n=n.previousElementSibling;return n||null}function ta(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==mt.clone&&(!t||Cu(e,t))&&n++;return n}function Ev(e){var t=0,n=0,a=Ka();if(e)do{var o=Yl(e),i=o.a,l=o.d;t+=e.scrollLeft*i,n+=e.scrollTop*l}while(e!==a&&(e=e.parentNode));return[t,n]}function RS(e,t){for(var n in e)if(e.hasOwnProperty(n)){for(var a in t)if(t.hasOwnProperty(a)&&t[a]===e[n][a])return Number(n)}return-1}function li(e,t){if(!e||!e.getBoundingClientRect)return Ka();var n=e,a=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=vt(n);if(n.clientWidth<n.scrollWidth&&(o.overflowX=="auto"||o.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(o.overflowY=="auto"||o.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return Ka();if(a||t)return n;a=!0}}while(n=n.parentNode);return Ka()}function OS(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function zd(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var qr;function n1(e,t){return function(){if(!qr){var n=arguments,a=this;n.length===1?e.call(a,n[0]):e.apply(a,n),qr=setTimeout(function(){qr=void 0},t)}}}function BS(){clearTimeout(qr),qr=void 0}function o1(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function a1(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}var zo="Sortable"+new Date().getTime();function NS(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var a=[].slice.call(this.el.children);a.forEach(function(o){if(!(vt(o,"display")==="none"||o===mt.ghost)){e.push({target:o,rect:Mn(o)});var i=Ya({},e[e.length-1].rect);if(o.thisAnimationDuration){var l=Yl(o,!0);l&&(i.top-=l.f,i.left-=l.e)}o.fromRect=i}})}},addAnimationState:function(a){e.push(a)},removeAnimationState:function(a){e.splice(RS(e,{target:a}),1)},animateAll:function(a){var o=this;if(!this.options.animation){clearTimeout(t),typeof a=="function"&&a();return}var i=!1,l=0;e.forEach(function(c){var d=0,h=c.target,f=h.fromRect,m=Mn(h),y=h.prevFromRect,k=h.prevToRect,S=c.rect,x=Yl(h,!0);x&&(m.top-=x.f,m.left-=x.e),h.toRect=m,h.thisAnimationDuration&&zd(y,m)&&!zd(f,m)&&(S.top-m.top)/(S.left-m.left)===(f.top-m.top)/(f.left-m.left)&&(d=US(S,y,k,o.options)),zd(m,f)||(h.prevFromRect=f,h.prevToRect=m,d||(d=o.options.animation),o.animate(h,S,m,d)),d&&(i=!0,l=Math.max(l,d),clearTimeout(h.animationResetTimer),h.animationResetTimer=setTimeout(function(){h.animationTime=0,h.prevFromRect=null,h.fromRect=null,h.prevToRect=null,h.thisAnimationDuration=null},d),h.thisAnimationDuration=d)}),clearTimeout(t),i?t=setTimeout(function(){typeof a=="function"&&a()},l):typeof a=="function"&&a(),e=[]},animate:function(a,o,i,l){if(l){vt(a,"transition",""),vt(a,"transform","");var c=Yl(this.el),d=c&&c.a,h=c&&c.d,f=(o.left-i.left)/(d||1),m=(o.top-i.top)/(h||1);a.animatingX=!!f,a.animatingY=!!m,vt(a,"transform","translate3d("+f+"px,"+m+"px,0)"),this.forRepaintDummy=FS(a),vt(a,"transition","transform "+l+"ms"+(this.options.easing?" "+this.options.easing:"")),vt(a,"transform","translate3d(0,0,0)"),typeof a.animated=="number"&&clearTimeout(a.animated),a.animated=setTimeout(function(){vt(a,"transition",""),vt(a,"transform",""),a.animated=!1,a.animatingX=!1,a.animatingY=!1},l)}}}}function FS(e){return e.offsetWidth}function US(e,t,n,a){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*a.animation}var Ol=[],Hd={initializeByDefault:!0},mc={mount:function(t){for(var n in Hd)Hd.hasOwnProperty(n)&&!(n in t)&&(t[n]=Hd[n]);Ol.forEach(function(a){if(a.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Ol.push(t)},pluginEvent:function(t,n,a){var o=this;this.eventCanceled=!1,a.cancel=function(){o.eventCanceled=!0};var i=t+"Global";Ol.forEach(function(l){n[l.pluginName]&&(n[l.pluginName][i]&&n[l.pluginName][i](Ya({sortable:n},a)),n.options[l.pluginName]&&n[l.pluginName][t]&&n[l.pluginName][t](Ya({sortable:n},a)))})},initializePlugins:function(t,n,a,o){Ol.forEach(function(c){var d=c.pluginName;if(!(!t.options[d]&&!c.initializeByDefault)){var h=new c(t,n,t.options);h.sortable=t,h.options=t.options,t[d]=h,Ts(a,h.defaults)}});for(var i in t.options)if(t.options.hasOwnProperty(i)){var l=this.modifyOption(t,i,t.options[i]);typeof l<"u"&&(t.options[i]=l)}},getEventProperties:function(t,n){var a={};return Ol.forEach(function(o){typeof o.eventProperties=="function"&&Ts(a,o.eventProperties.call(n[o.pluginName],t))}),a},modifyOption:function(t,n,a){var o;return Ol.forEach(function(i){t[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[n]=="function"&&(o=i.optionListeners[n].call(t[i.pluginName],a))}),o}};function zS(e){var t=e.sortable,n=e.rootEl,a=e.name,o=e.targetEl,i=e.cloneEl,l=e.toEl,c=e.fromEl,d=e.oldIndex,h=e.newIndex,f=e.oldDraggableIndex,m=e.newDraggableIndex,y=e.originalEvent,k=e.putSortable,S=e.extraEventProperties;if(t=t||n&&n[zo],!!t){var x,E=t.options,$="on"+a.charAt(0).toUpperCase()+a.substr(1);window.CustomEvent&&!Es&&!vc?x=new CustomEvent(a,{bubbles:!0,cancelable:!0}):(x=document.createEvent("Event"),x.initEvent(a,!0,!0)),x.to=l||n,x.from=c||n,x.item=o||n,x.clone=i,x.oldIndex=d,x.newIndex=h,x.oldDraggableIndex=f,x.newDraggableIndex=m,x.originalEvent=y,x.pullMode=k?k.lastPutMode:void 0;var w=Ya(Ya({},S),mc.getEventProperties(a,t));for(var _ in w)x[_]=w[_];n&&n.dispatchEvent(x),E[$]&&E[$].call(t,x)}}var HS=["evt"],xo=function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=a.evt,i=AS(a,HS);mc.pluginEvent.bind(mt)(t,n,Ya({dragEl:tt,parentEl:mn,ghostEl:St,rootEl:ln,nextEl:Yi,lastDownEl:Xc,cloneEl:gn,cloneHidden:ii,dragStarted:$r,putSortable:Hn,activeSortable:mt.active,originalEvent:o,oldIndex:Gl,oldDraggableIndex:jr,newIndex:No,newDraggableIndex:oi,hideGhostForTarget:r1,unhideGhostForTarget:c1,cloneNowHidden:function(){ii=!0},cloneNowShown:function(){ii=!1},dispatchSortableEvent:function(c){vo({sortable:n,name:c,originalEvent:o})}},i))};function vo(e){zS(Ya({putSortable:Hn,cloneEl:gn,targetEl:tt,rootEl:ln,oldIndex:Gl,oldDraggableIndex:jr,newIndex:No,newDraggableIndex:oi},e))}var tt,mn,St,ln,Yi,Xc,gn,ii,Gl,No,jr,oi,Bc,Hn,Hl=!1,Lu=!1,Su=[],Wi,va,Vd,Gd,Pv,Dv,$r,Bl,Wr,Zr=!1,Nc=!1,Qc,Zn,qd=[],Jh=!1,Iu=[],ed=typeof document<"u",Fc=Qy,Rv=vc||Es?"cssFloat":"float",VS=ed&&!PS&&!Qy&&"draggable"in document.createElement("div"),s1=(function(){if(ed){if(Es)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}})(),i1=function(t,n){var a=vt(t),o=parseInt(a.width)-parseInt(a.paddingLeft)-parseInt(a.paddingRight)-parseInt(a.borderLeftWidth)-parseInt(a.borderRightWidth),i=or(t,0,n),l=or(t,1,n),c=i&&vt(i),d=l&&vt(l),h=c&&parseInt(c.marginLeft)+parseInt(c.marginRight)+Mn(i).width,f=d&&parseInt(d.marginLeft)+parseInt(d.marginRight)+Mn(l).width;if(a.display==="flex")return a.flexDirection==="column"||a.flexDirection==="column-reverse"?"vertical":"horizontal";if(a.display==="grid")return a.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&c.float&&c.float!=="none"){var m=c.float==="left"?"left":"right";return l&&(d.clear==="both"||d.clear===m)?"vertical":"horizontal"}return i&&(c.display==="block"||c.display==="flex"||c.display==="table"||c.display==="grid"||h>=o&&a[Rv]==="none"||l&&a[Rv]==="none"&&h+f>o)?"vertical":"horizontal"},GS=function(t,n,a){var o=a?t.left:t.top,i=a?t.right:t.bottom,l=a?t.width:t.height,c=a?n.left:n.top,d=a?n.right:n.bottom,h=a?n.width:n.height;return o===c||i===d||o+l/2===c+h/2},qS=function(t,n){var a;return Su.some(function(o){var i=o[zo].options.emptyInsertThreshold;if(!(!i||Df(o))){var l=Mn(o),c=t>=l.left-i&&t<=l.right+i,d=n>=l.top-i&&n<=l.bottom+i;if(c&&d)return a=o}}),a},l1=function(t){function n(i,l){return function(c,d,h,f){var m=c.options.group.name&&d.options.group.name&&c.options.group.name===d.options.group.name;if(i==null&&(l||m))return!0;if(i==null||i===!1)return!1;if(l&&i==="clone")return i;if(typeof i=="function")return n(i(c,d,h,f),l)(c,d,h,f);var y=(l?c:d).options.group.name;return i===!0||typeof i=="string"&&i===y||i.join&&i.indexOf(y)>-1}}var a={},o=t.group;(!o||Jc(o)!="object")&&(o={name:o}),a.name=o.name,a.checkPull=n(o.pull,!0),a.checkPut=n(o.put),a.revertClone=o.revertClone,t.group=a},r1=function(){!s1&&St&&vt(St,"display","none")},c1=function(){!s1&&St&&vt(St,"display","")};ed&&document.addEventListener("click",function(e){if(Lu)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Lu=!1,!1},!0);var Zi=function(t){if(tt){t=t.touches?t.touches[0]:t;var n=qS(t.clientX,t.clientY);if(n){var a={};for(var o in t)t.hasOwnProperty(o)&&(a[o]=t[o]);a.target=a.rootEl=n,a.preventDefault=void 0,a.stopPropagation=void 0,n[zo]._onDragOver(a)}}},jS=function(t){tt&&tt.parentNode[zo]._isOutsideThisEl(t.target)};function mt(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=Ts({},t),e[zo]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return i1(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(l,c){l.setData("Text",c.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:mt.supportPointer!==!1&&"PointerEvent"in window&&!Gr,emptyInsertThreshold:5};mc.initializePlugins(this,e,n);for(var a in n)!(a in t)&&(t[a]=n[a]);l1(t);for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this));this.nativeDraggable=t.forceFallback?!1:VS,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?Ht(e,"pointerdown",this._onTapStart):(Ht(e,"mousedown",this._onTapStart),Ht(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(Ht(e,"dragover",this),Ht(e,"dragenter",this)),Su.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Ts(this,NS())}mt.prototype={constructor:mt,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Bl=null)},_getDirection:function(t,n){return typeof this.options.direction=="function"?this.options.direction.call(this,t,n,tt):this.options.direction},_onTapStart:function(t){if(t.cancelable){var n=this,a=this.el,o=this.options,i=o.preventOnFilter,l=t.type,c=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,d=(c||t).target,h=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||d,f=o.filter;if(eI(a),!tt&&!(/mousedown|pointerdown/.test(l)&&t.button!==0||o.disabled)&&!h.isContentEditable&&!(!this.nativeDraggable&&Gr&&d&&d.tagName.toUpperCase()==="SELECT")&&(d=qa(d,o.draggable,a,!1),!(d&&d.animated)&&Xc!==d)){if(Gl=ta(d),jr=ta(d,o.draggable),typeof f=="function"){if(f.call(this,t,d,this)){vo({sortable:n,rootEl:h,name:"filter",targetEl:d,toEl:a,fromEl:a}),xo("filter",n,{evt:t}),i&&t.cancelable&&t.preventDefault();return}}else if(f&&(f=f.split(",").some(function(m){if(m=qa(h,m.trim(),a,!1),m)return vo({sortable:n,rootEl:m,name:"filter",targetEl:d,fromEl:a,toEl:a}),xo("filter",n,{evt:t}),!0}),f)){i&&t.cancelable&&t.preventDefault();return}o.handle&&!qa(h,o.handle,a,!1)||this._prepareDragStart(t,c,d)}}},_prepareDragStart:function(t,n,a){var o=this,i=o.el,l=o.options,c=i.ownerDocument,d;if(a&&!tt&&a.parentNode===i){var h=Mn(a);if(ln=i,tt=a,mn=tt.parentNode,Yi=tt.nextSibling,Xc=a,Bc=l.group,mt.dragged=tt,Wi={target:tt,clientX:(n||t).clientX,clientY:(n||t).clientY},Pv=Wi.clientX-h.left,Dv=Wi.clientY-h.top,this._lastX=(n||t).clientX,this._lastY=(n||t).clientY,tt.style["will-change"]="all",d=function(){if(xo("delayEnded",o,{evt:t}),mt.eventCanceled){o._onDrop();return}o._disableDelayedDragEvents(),!Tv&&o.nativeDraggable&&(tt.draggable=!0),o._triggerDragStart(t,n),vo({sortable:o,name:"choose",originalEvent:t}),Bo(tt,l.chosenClass,!0)},l.ignore.split(",").forEach(function(f){t1(tt,f.trim(),jd)}),Ht(c,"dragover",Zi),Ht(c,"mousemove",Zi),Ht(c,"touchmove",Zi),Ht(c,"mouseup",o._onDrop),Ht(c,"touchend",o._onDrop),Ht(c,"touchcancel",o._onDrop),Tv&&this.nativeDraggable&&(this.options.touchStartThreshold=4,tt.draggable=!0),xo("delayStart",this,{evt:t}),l.delay&&(!l.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(vc||Es))){if(mt.eventCanceled){this._onDrop();return}Ht(c,"mouseup",o._disableDelayedDrag),Ht(c,"touchend",o._disableDelayedDrag),Ht(c,"touchcancel",o._disableDelayedDrag),Ht(c,"mousemove",o._delayedDragTouchMoveHandler),Ht(c,"touchmove",o._delayedDragTouchMoveHandler),l.supportPointer&&Ht(c,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(d,l.delay)}else d()}},_delayedDragTouchMoveHandler:function(t){var n=t.touches?t.touches[0]:t;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){tt&&jd(tt),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;Ot(t,"mouseup",this._disableDelayedDrag),Ot(t,"touchend",this._disableDelayedDrag),Ot(t,"touchcancel",this._disableDelayedDrag),Ot(t,"mousemove",this._delayedDragTouchMoveHandler),Ot(t,"touchmove",this._delayedDragTouchMoveHandler),Ot(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,n){n=n||t.pointerType=="touch"&&t,!this.nativeDraggable||n?this.options.supportPointer?Ht(document,"pointermove",this._onTouchMove):n?Ht(document,"touchmove",this._onTouchMove):Ht(document,"mousemove",this._onTouchMove):(Ht(tt,"dragend",this),Ht(ln,"dragstart",this._onDragStart));try{document.selection?eu(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,n){if(Hl=!1,ln&&tt){xo("dragStarted",this,{evt:n}),this.nativeDraggable&&Ht(document,"dragover",jS);var a=this.options;!t&&Bo(tt,a.dragClass,!1),Bo(tt,a.ghostClass,!0),mt.active=this,t&&this._appendGhost(),vo({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(va){this._lastX=va.clientX,this._lastY=va.clientY,r1();for(var t=document.elementFromPoint(va.clientX,va.clientY),n=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(va.clientX,va.clientY),t!==n);)n=t;if(tt.parentNode[zo]._isOutsideThisEl(t),n)do{if(n[zo]){var a=void 0;if(a=n[zo]._onDragOver({clientX:va.clientX,clientY:va.clientY,target:t,rootEl:n}),a&&!this.options.dragoverBubble)break}t=n}while(n=n.parentNode);c1()}},_onTouchMove:function(t){if(Wi){var n=this.options,a=n.fallbackTolerance,o=n.fallbackOffset,i=t.touches?t.touches[0]:t,l=St&&Yl(St,!0),c=St&&l&&l.a,d=St&&l&&l.d,h=Fc&&Zn&&Ev(Zn),f=(i.clientX-Wi.clientX+o.x)/(c||1)+(h?h[0]-qd[0]:0)/(c||1),m=(i.clientY-Wi.clientY+o.y)/(d||1)+(h?h[1]-qd[1]:0)/(d||1);if(!mt.active&&!Hl){if(a&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<a)return;this._onDragStart(t,!0)}if(St){l?(l.e+=f-(Vd||0),l.f+=m-(Gd||0)):l={a:1,b:0,c:0,d:1,e:f,f:m};var y="matrix(".concat(l.a,",").concat(l.b,",").concat(l.c,",").concat(l.d,",").concat(l.e,",").concat(l.f,")");vt(St,"webkitTransform",y),vt(St,"mozTransform",y),vt(St,"msTransform",y),vt(St,"transform",y),Vd=f,Gd=m,va=i}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!St){var t=this.options.fallbackOnBody?document.body:ln,n=Mn(tt,!0,Fc,!0,t),a=this.options;if(Fc){for(Zn=t;vt(Zn,"position")==="static"&&vt(Zn,"transform")==="none"&&Zn!==document;)Zn=Zn.parentNode;Zn!==document.body&&Zn!==document.documentElement?(Zn===document&&(Zn=Ka()),n.top+=Zn.scrollTop,n.left+=Zn.scrollLeft):Zn=Ka(),qd=Ev(Zn)}St=tt.cloneNode(!0),Bo(St,a.ghostClass,!1),Bo(St,a.fallbackClass,!0),Bo(St,a.dragClass,!0),vt(St,"transition",""),vt(St,"transform",""),vt(St,"box-sizing","border-box"),vt(St,"margin",0),vt(St,"top",n.top),vt(St,"left",n.left),vt(St,"width",n.width),vt(St,"height",n.height),vt(St,"opacity","0.8"),vt(St,"position",Fc?"absolute":"fixed"),vt(St,"zIndex","100000"),vt(St,"pointerEvents","none"),mt.ghost=St,t.appendChild(St),vt(St,"transform-origin",Pv/parseInt(St.style.width)*100+"% "+Dv/parseInt(St.style.height)*100+"%")}},_onDragStart:function(t,n){var a=this,o=t.dataTransfer,i=a.options;if(xo("dragStart",this,{evt:t}),mt.eventCanceled){this._onDrop();return}xo("setupClone",this),mt.eventCanceled||(gn=a1(tt),gn.draggable=!1,gn.style["will-change"]="",this._hideClone(),Bo(gn,this.options.chosenClass,!1),mt.clone=gn),a.cloneId=eu(function(){xo("clone",a),!mt.eventCanceled&&(a.options.removeCloneOnHide||ln.insertBefore(gn,tt),a._hideClone(),vo({sortable:a,name:"clone"}))}),!n&&Bo(tt,i.dragClass,!0),n?(Lu=!0,a._loopId=setInterval(a._emulateDragOver,50)):(Ot(document,"mouseup",a._onDrop),Ot(document,"touchend",a._onDrop),Ot(document,"touchcancel",a._onDrop),o&&(o.effectAllowed="move",i.setData&&i.setData.call(a,o,tt)),Ht(document,"drop",a),vt(tt,"transform","translateZ(0)")),Hl=!0,a._dragStartId=eu(a._dragStarted.bind(a,n,t)),Ht(document,"selectstart",a),$r=!0,Gr&&vt(document.body,"user-select","none")},_onDragOver:function(t){var n=this.el,a=t.target,o,i,l,c=this.options,d=c.group,h=mt.active,f=Bc===d,m=c.sort,y=Hn||h,k,S=this,x=!1;if(Jh)return;function E(U,Q){xo(U,S,Ya({evt:t,isOwner:f,axis:k?"vertical":"horizontal",revert:l,dragRect:o,targetRect:i,canSort:m,fromSortable:y,target:a,completed:w,onMove:function(he,Te){return Uc(ln,n,tt,o,he,Mn(he),t,Te)},changed:_},Q))}function $(){E("dragOverAnimationCapture"),S.captureAnimationState(),S!==y&&y.captureAnimationState()}function w(U){return E("dragOverCompleted",{insertion:U}),U&&(f?h._hideClone():h._showClone(S),S!==y&&(Bo(tt,Hn?Hn.options.ghostClass:h.options.ghostClass,!1),Bo(tt,c.ghostClass,!0)),Hn!==S&&S!==mt.active?Hn=S:S===mt.active&&Hn&&(Hn=null),y===S&&(S._ignoreWhileAnimating=a),S.animateAll(function(){E("dragOverAnimationComplete"),S._ignoreWhileAnimating=null}),S!==y&&(y.animateAll(),y._ignoreWhileAnimating=null)),(a===tt&&!tt.animated||a===n&&!a.animated)&&(Bl=null),!c.dragoverBubble&&!t.rootEl&&a!==document&&(tt.parentNode[zo]._isOutsideThisEl(t.target),!U&&Zi(t)),!c.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),x=!0}function _(){No=ta(tt),oi=ta(tt,c.draggable),vo({sortable:S,name:"change",toEl:n,newIndex:No,newDraggableIndex:oi,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),a=qa(a,c.draggable,n,!0),E("dragOver"),mt.eventCanceled)return x;if(tt.contains(t.target)||a.animated&&a.animatingX&&a.animatingY||S._ignoreWhileAnimating===a)return w(!1);if(Lu=!1,h&&!c.disabled&&(f?m||(l=mn!==ln):Hn===this||(this.lastPutMode=Bc.checkPull(this,h,tt,t))&&d.checkPut(this,h,tt,t))){if(k=this._getDirection(t,a)==="vertical",o=Mn(tt),E("dragOverValid"),mt.eventCanceled)return x;if(l)return mn=ln,$(),this._hideClone(),E("revert"),mt.eventCanceled||(Yi?ln.insertBefore(tt,Yi):ln.appendChild(tt)),w(!0);var I=Df(n,c.draggable);if(!I||YS(t,k,this)&&!I.animated){if(I===tt)return w(!1);if(I&&n===t.target&&(a=I),a&&(i=Mn(a)),Uc(ln,n,tt,o,a,i,t,!!a)!==!1)return $(),n.appendChild(tt),mn=n,_(),w(!0)}else if(I&&KS(t,k,this)){var T=or(n,0,c,!0);if(T===tt)return w(!1);if(a=T,i=Mn(a),Uc(ln,n,tt,o,a,i,t,!1)!==!1)return $(),n.insertBefore(tt,T),mn=n,_(),w(!0)}else if(a.parentNode===n){i=Mn(a);var B=0,M,R=tt.parentNode!==n,A=!GS(tt.animated&&tt.toRect||o,a.animated&&a.toRect||i,k),G=k?"top":"left",F=Av(a,"top","top")||Av(tt,"top","top"),j=F?F.scrollTop:void 0;Bl!==a&&(M=i[G],Zr=!1,Nc=!A&&c.invertSwap||R),B=JS(t,a,i,k,A?1:c.swapThreshold,c.invertedSwapThreshold==null?c.swapThreshold:c.invertedSwapThreshold,Nc,Bl===a);var K;if(B!==0){var J=ta(tt);do J-=B,K=mn.children[J];while(K&&(vt(K,"display")==="none"||K===St))}if(B===0||K===a)return w(!1);Bl=a,Wr=B;var ue=a.nextElementSibling,Z=!1;Z=B===1;var se=Uc(ln,n,tt,o,a,i,t,Z);if(se!==!1)return(se===1||se===-1)&&(Z=se===1),Jh=!0,setTimeout(ZS,30),$(),Z&&!ue?n.appendChild(tt):a.parentNode.insertBefore(tt,Z?ue:a),F&&o1(F,0,j-F.scrollTop),mn=tt.parentNode,M!==void 0&&!Nc&&(Qc=Math.abs(M-Mn(a)[G])),_(),w(!0)}if(n.contains(tt))return w(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){Ot(document,"mousemove",this._onTouchMove),Ot(document,"touchmove",this._onTouchMove),Ot(document,"pointermove",this._onTouchMove),Ot(document,"dragover",Zi),Ot(document,"mousemove",Zi),Ot(document,"touchmove",Zi)},_offUpEvents:function(){var t=this.el.ownerDocument;Ot(t,"mouseup",this._onDrop),Ot(t,"touchend",this._onDrop),Ot(t,"pointerup",this._onDrop),Ot(t,"touchcancel",this._onDrop),Ot(document,"selectstart",this)},_onDrop:function(t){var n=this.el,a=this.options;if(No=ta(tt),oi=ta(tt,a.draggable),xo("drop",this,{evt:t}),mn=tt&&tt.parentNode,No=ta(tt),oi=ta(tt,a.draggable),mt.eventCanceled){this._nulling();return}Hl=!1,Nc=!1,Zr=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Xh(this.cloneId),Xh(this._dragStartId),this.nativeDraggable&&(Ot(document,"drop",this),Ot(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Gr&&vt(document.body,"user-select",""),vt(tt,"transform",""),t&&($r&&(t.cancelable&&t.preventDefault(),!a.dropBubble&&t.stopPropagation()),St&&St.parentNode&&St.parentNode.removeChild(St),(ln===mn||Hn&&Hn.lastPutMode!=="clone")&&gn&&gn.parentNode&&gn.parentNode.removeChild(gn),tt&&(this.nativeDraggable&&Ot(tt,"dragend",this),jd(tt),tt.style["will-change"]="",$r&&!Hl&&Bo(tt,Hn?Hn.options.ghostClass:this.options.ghostClass,!1),Bo(tt,this.options.chosenClass,!1),vo({sortable:this,name:"unchoose",toEl:mn,newIndex:null,newDraggableIndex:null,originalEvent:t}),ln!==mn?(No>=0&&(vo({rootEl:mn,name:"add",toEl:mn,fromEl:ln,originalEvent:t}),vo({sortable:this,name:"remove",toEl:mn,originalEvent:t}),vo({rootEl:mn,name:"sort",toEl:mn,fromEl:ln,originalEvent:t}),vo({sortable:this,name:"sort",toEl:mn,originalEvent:t})),Hn&&Hn.save()):No!==Gl&&No>=0&&(vo({sortable:this,name:"update",toEl:mn,originalEvent:t}),vo({sortable:this,name:"sort",toEl:mn,originalEvent:t})),mt.active&&((No==null||No===-1)&&(No=Gl,oi=jr),vo({sortable:this,name:"end",toEl:mn,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){xo("nulling",this),ln=tt=mn=St=Yi=gn=Xc=ii=Wi=va=$r=No=oi=Gl=jr=Bl=Wr=Hn=Bc=mt.dragged=mt.ghost=mt.clone=mt.active=null,Iu.forEach(function(t){t.checked=!0}),Iu.length=Vd=Gd=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":tt&&(this._onDragOver(t),WS(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],n,a=this.el.children,o=0,i=a.length,l=this.options;o<i;o++)n=a[o],qa(n,l.draggable,this.el,!1)&&t.push(n.getAttribute(l.dataIdAttr)||QS(n));return t},sort:function(t,n){var a={},o=this.el;this.toArray().forEach(function(i,l){var c=o.children[l];qa(c,this.options.draggable,o,!1)&&(a[i]=c)},this),n&&this.captureAnimationState(),t.forEach(function(i){a[i]&&(o.removeChild(a[i]),o.appendChild(a[i]))}),n&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,n){return qa(t,n||this.options.draggable,this.el,!1)},option:function(t,n){var a=this.options;if(n===void 0)return a[t];var o=mc.modifyOption(this,t,n);typeof o<"u"?a[t]=o:a[t]=n,t==="group"&&l1(a)},destroy:function(){xo("destroy",this);var t=this.el;t[zo]=null,Ot(t,"mousedown",this._onTapStart),Ot(t,"touchstart",this._onTapStart),Ot(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(Ot(t,"dragover",this),Ot(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Su.splice(Su.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!ii){if(xo("hideClone",this),mt.eventCanceled)return;vt(gn,"display","none"),this.options.removeCloneOnHide&&gn.parentNode&&gn.parentNode.removeChild(gn),ii=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(ii){if(xo("showClone",this),mt.eventCanceled)return;tt.parentNode==ln&&!this.options.group.revertClone?ln.insertBefore(gn,tt):Yi?ln.insertBefore(gn,Yi):ln.appendChild(gn),this.options.group.revertClone&&this.animate(tt,gn),vt(gn,"display",""),ii=!1}}};function WS(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function Uc(e,t,n,a,o,i,l,c){var d,h=e[zo],f=h.options.onMove,m;return window.CustomEvent&&!Es&&!vc?d=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(d=document.createEvent("Event"),d.initEvent("move",!0,!0)),d.to=t,d.from=e,d.dragged=n,d.draggedRect=a,d.related=o||t,d.relatedRect=i||Mn(t),d.willInsertAfter=c,d.originalEvent=l,e.dispatchEvent(d),f&&(m=f.call(h,d,l)),m}function jd(e){e.draggable=!1}function ZS(){Jh=!1}function KS(e,t,n){var a=Mn(or(n.el,0,n.options,!0)),o=10;return t?e.clientX<a.left-o||e.clientY<a.top&&e.clientX<a.right:e.clientY<a.top-o||e.clientY<a.bottom&&e.clientX<a.left}function YS(e,t,n){var a=Mn(Df(n.el,n.options.draggable)),o=10;return t?e.clientX>a.right+o||e.clientX<=a.right&&e.clientY>a.bottom&&e.clientX>=a.left:e.clientX>a.right&&e.clientY>a.top||e.clientX<=a.right&&e.clientY>a.bottom+o}function JS(e,t,n,a,o,i,l,c){var d=a?e.clientY:e.clientX,h=a?n.height:n.width,f=a?n.top:n.left,m=a?n.bottom:n.right,y=!1;if(!l){if(c&&Qc<h*o){if(!Zr&&(Wr===1?d>f+h*i/2:d<m-h*i/2)&&(Zr=!0),Zr)y=!0;else if(Wr===1?d<f+Qc:d>m-Qc)return-Wr}else if(d>f+h*(1-o)/2&&d<m-h*(1-o)/2)return XS(t)}return y=y||l,y&&(d<f+h*i/2||d>m-h*i/2)?d>f+h/2?1:-1:0}function XS(e){return ta(tt)<ta(e)?1:-1}function QS(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,a=0;n--;)a+=t.charCodeAt(n);return a.toString(36)}function eI(e){Iu.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var a=t[n];a.checked&&Iu.push(a)}}function eu(e){return setTimeout(e,0)}function Xh(e){return clearTimeout(e)}ed&&Ht(document,"touchmove",function(e){(mt.active||Hl)&&e.cancelable&&e.preventDefault()});mt.utils={on:Ht,off:Ot,css:vt,find:t1,is:function(t,n){return!!qa(t,n,t,!1)},extend:OS,throttle:n1,closest:qa,toggleClass:Bo,clone:a1,index:ta,nextTick:eu,cancelNextTick:Xh,detectDirection:i1,getChild:or};mt.get=function(e){return e[zo]};mt.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach(function(a){if(!a.prototype||!a.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(a));a.utils&&(mt.utils=Ya(Ya({},mt.utils),a.utils)),mc.mount(a)})};mt.create=function(e,t){return new mt(e,t)};mt.version=ES;var Ln=[],Tr,Qh,ef=!1,Wd,Zd,xu,Mr;function tI(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(n){var a=n.originalEvent;this.sortable.nativeDraggable?Ht(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Ht(document,"pointermove",this._handleFallbackAutoScroll):a.touches?Ht(document,"touchmove",this._handleFallbackAutoScroll):Ht(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var a=n.originalEvent;!this.options.dragOverBubble&&!a.rootEl&&this._handleAutoScroll(a)},drop:function(){this.sortable.nativeDraggable?Ot(document,"dragover",this._handleAutoScroll):(Ot(document,"pointermove",this._handleFallbackAutoScroll),Ot(document,"touchmove",this._handleFallbackAutoScroll),Ot(document,"mousemove",this._handleFallbackAutoScroll)),Ov(),tu(),BS()},nulling:function(){xu=Qh=Tr=ef=Mr=Wd=Zd=null,Ln.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,a){var o=this,i=(n.touches?n.touches[0]:n).clientX,l=(n.touches?n.touches[0]:n).clientY,c=document.elementFromPoint(i,l);if(xu=n,a||this.options.forceAutoScrollFallback||vc||Es||Gr){Kd(n,this.options,c,a);var d=li(c,!0);ef&&(!Mr||i!==Wd||l!==Zd)&&(Mr&&Ov(),Mr=setInterval(function(){var h=li(document.elementFromPoint(i,l),!0);h!==d&&(d=h,tu()),Kd(n,o.options,h,a)},10),Wd=i,Zd=l)}else{if(!this.options.bubbleScroll||li(c,!0)===Ka()){tu();return}Kd(n,this.options,li(c,!1),!1)}}},Ts(e,{pluginName:"scroll",initializeByDefault:!0})}function tu(){Ln.forEach(function(e){clearInterval(e.pid)}),Ln=[]}function Ov(){clearInterval(Mr)}var Kd=n1(function(e,t,n,a){if(t.scroll){var o=(e.touches?e.touches[0]:e).clientX,i=(e.touches?e.touches[0]:e).clientY,l=t.scrollSensitivity,c=t.scrollSpeed,d=Ka(),h=!1,f;Qh!==n&&(Qh=n,tu(),Tr=t.scroll,f=t.scrollFn,Tr===!0&&(Tr=li(n,!0)));var m=0,y=Tr;do{var k=y,S=Mn(k),x=S.top,E=S.bottom,$=S.left,w=S.right,_=S.width,I=S.height,T=void 0,B=void 0,M=k.scrollWidth,R=k.scrollHeight,A=vt(k),G=k.scrollLeft,F=k.scrollTop;k===d?(T=_<M&&(A.overflowX==="auto"||A.overflowX==="scroll"||A.overflowX==="visible"),B=I<R&&(A.overflowY==="auto"||A.overflowY==="scroll"||A.overflowY==="visible")):(T=_<M&&(A.overflowX==="auto"||A.overflowX==="scroll"),B=I<R&&(A.overflowY==="auto"||A.overflowY==="scroll"));var j=T&&(Math.abs(w-o)<=l&&G+_<M)-(Math.abs($-o)<=l&&!!G),K=B&&(Math.abs(E-i)<=l&&F+I<R)-(Math.abs(x-i)<=l&&!!F);if(!Ln[m])for(var J=0;J<=m;J++)Ln[J]||(Ln[J]={});(Ln[m].vx!=j||Ln[m].vy!=K||Ln[m].el!==k)&&(Ln[m].el=k,Ln[m].vx=j,Ln[m].vy=K,clearInterval(Ln[m].pid),(j!=0||K!=0)&&(h=!0,Ln[m].pid=setInterval((function(){a&&this.layer===0&&mt.active._onTouchMove(xu);var ue=Ln[this.layer].vy?Ln[this.layer].vy*c:0,Z=Ln[this.layer].vx?Ln[this.layer].vx*c:0;typeof f=="function"&&f.call(mt.dragged.parentNode[zo],Z,ue,e,xu,Ln[this.layer].el)!=="continue"||o1(Ln[this.layer].el,Z,ue)}).bind({layer:m}),24))),m++}while(t.bubbleScroll&&y!==d&&(y=li(y,!1)));ef=h}},30),u1=function(t){var n=t.originalEvent,a=t.putSortable,o=t.dragEl,i=t.activeSortable,l=t.dispatchSortableEvent,c=t.hideGhostForTarget,d=t.unhideGhostForTarget;if(n){var h=a||i;c();var f=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,m=document.elementFromPoint(f.clientX,f.clientY);d(),h&&!h.el.contains(m)&&(l("spill"),this.onSpill({dragEl:o,putSortable:a}))}};function Rf(){}Rf.prototype={startIndex:null,dragStart:function(t){var n=t.oldDraggableIndex;this.startIndex=n},onSpill:function(t){var n=t.dragEl,a=t.putSortable;this.sortable.captureAnimationState(),a&&a.captureAnimationState();var o=or(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(n,o):this.sortable.el.appendChild(n),this.sortable.animateAll(),a&&a.animateAll()},drop:u1};Ts(Rf,{pluginName:"revertOnSpill"});function Of(){}Of.prototype={onSpill:function(t){var n=t.dragEl,a=t.putSortable,o=a||this.sortable;o.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),o.animateAll()},drop:u1};Ts(Of,{pluginName:"removeOnSpill"});mt.mount(new tI);mt.mount(Of,Rf);const nI=["data-id"],oI={key:0,class:"order-overlay"},fl={__name:"DraggableList",props:{items:{type:Array,required:!0},itemKey:{type:String,default:"id"},pinnedKey:{type:String,default:null},disabled:{type:Boolean,default:!1},layout:{type:String,default:"list"},showOrderOverlay:{type:Boolean,default:!0}},emits:["reorder"],setup(e,{emit:t}){const n=e,a=t,o=P(null),i=P(!1);let l=null;const c=P([...n.items]);Ye(()=>n.items,k=>{c.value=[...k]},{deep:!0}),Ye(()=>n.disabled,k=>{l&&l.option("disabled",k)});const d=k=>{i.value=!1;const{oldIndex:S,newIndex:x}=k;if(S===x)return;const E=c.value.splice(S,1)[0];c.value.splice(x,0,E);const $=c.value.map((w,_)=>({id:w[n.itemKey],displayOrder:_+1}));a("reorder",{items:c.value,changes:$})},h=()=>{i.value=!0},f=k=>{if(!n.pinnedKey)return!0;const S=k.dragged.dataset.id,x=c.value.find(I=>String(I[n.itemKey])===S);if(!x)return!0;const E=x[n.pinnedKey],$=k.related.dataset.id,w=c.value.find(I=>String(I[n.itemKey])===$);if(!w)return!0;const _=w[n.pinnedKey];return E===_},m=()=>{o.value&&(l=mt.create(o.value,{animation:200,handle:".drag-handle",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",disabled:n.disabled,onMove:f,onStart:h,onEnd:d}))},y=()=>{l&&(l.destroy(),l=null)};return rn(()=>{dn(()=>{m()})}),An(()=>{y()}),(k,S)=>(p(),g("div",{ref_key:"listRef",ref:o,class:le(["draggable-list",{"draggable-grid":e.layout==="grid","is-dragging":i.value}])},[(p(!0),g(xe,null,qe(c.value,(x,E)=>(p(),g("div",{key:x[e.itemKey],"data-id":x[e.itemKey],class:"draggable-item"},[ko(k.$slots,"item",{element:x,index:E}),i.value&&e.showOrderOverlay?(p(),g("div",oI,b(E+1),1)):D("",!0)],8,nI))),128))],2))}},aI=["title"],pl={__name:"DragHandle",props:{disabled:{type:Boolean,default:!1}},setup(e){return(t,n)=>(p(),g("span",{class:le(["drag-handle",{disabled:e.disabled}]),title:e.disabled?"":"Drag to reorder"},[...n[0]||(n[0]=[fi('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><circle cx="5" cy="3" r="1.5"></circle><circle cx="11" cy="3" r="1.5"></circle><circle cx="5" cy="8" r="1.5"></circle><circle cx="11" cy="8" r="1.5"></circle><circle cx="5" cy="13" r="1.5"></circle><circle cx="11" cy="13" r="1.5"></circle></svg>',1)])],10,aI))}},sI={class:"checklists-tab"},iI={class:"tab-header"},lI={class:"button-group"},rI={class:"view-toggle"},cI={key:0,class:"status-pills"},uI={key:1,class:"status-pills"},dI={key:2,class:"status-pills"},hI={key:3,class:"status-pills"},fI={class:"filters-section"},pI={class:"search-group"},vI=["placeholder"],mI={class:"checklist-items-list"},gI={key:0,class:"empty-state"},yI={class:"checklist-item-card"},kI={class:"checklist-item-content"},bI=["onClick"],_I={key:0,class:"loading-state"},wI={key:1,class:"empty-state"},CI={class:"filters-section"},LI={class:"search-group"},SI=["placeholder"],II={class:"report-list"},xI={key:0,class:"empty-state"},$I=["onClick"],TI={class:"report-card-title"},MI={class:"expand-icon"},AI={class:"report-card-stats"},EI={key:0,class:"report-card-body"},PI={class:"task-text"},DI={key:0,class:"task-completed-by"},RI={key:0,class:"loading-state"},OI={key:1,class:"empty-state"},BI={class:"filters-section"},NI={class:"search-group"},FI=["placeholder"],UI={class:"report-list"},zI={key:0,class:"empty-state"},HI=["onClick"],VI={class:"report-card-title"},GI={class:"expand-icon"},qI={class:"report-card-stats"},jI={key:0,class:"report-card-body"},WI={key:0,class:"empty-state small"},ZI={class:"task-text"},KI={key:0,class:"task-completed-by"},YI={key:0,class:"loading-state"},JI={key:1,class:"empty-state"},XI={class:"filters-section"},QI={class:"search-group"},ex=["placeholder"],tx={class:"report-list"},nx={key:0,class:"empty-state"},ox=["onClick"],ax={class:"report-card-title"},sx={class:"expand-icon"},ix={class:"report-card-stats"},lx={class:"stat-badge secondary"},rx={key:0,class:"report-card-body nested-body"},cx=["onClick"],ux={class:"nested-card-title"},dx={class:"expand-icon"},hx={class:"nested-card-stats"},fx={key:0,class:"nested-card-body"},px={class:"task-text"},vx={key:0,class:"task-completed-by"},mx={key:0,class:"loading-state"},gx={key:1,class:"empty-state"},yx={class:"filters-section"},kx={class:"search-group"},bx=["placeholder"],_x={class:"report-list"},wx={key:0,class:"empty-state"},Cx=["onClick"],Lx={class:"report-card-title"},Sx={class:"expand-icon"},Ix={class:"report-card-title-text"},xx={key:0,class:"report-card-description"},$x={class:"report-card-stats"},Tx={class:"stat-badge secondary"},Mx={key:0,class:"report-card-body nested-body"},Ax=["onClick"],Ex={class:"nested-card-title"},Px={class:"expand-icon"},Dx={class:"nested-card-stats"},Rx={key:0,class:"nested-card-body"},Ox={class:"task-text"},Bx={key:0,class:"task-completed-by"},Nx={__name:"ChecklistsTab",props:{checklistItems:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},completionReport:{type:Object,default:null},detailedReport:{type:Object,default:null},isLoadingDetailedReport:{type:Boolean,default:!1}},emits:["add-checklist-item","select-checklist-item","reorder","load-detailed-report"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=P("define"),l=P(""),c=P(""),d=P(""),h=P(""),f=P(""),m=P("all"),y=P("all"),k=P("all"),S=P("all"),x=P(new Set),E=P(new Set),$=P(new Set),w=P(new Set),_=P(new Set),I=P(new Set),T=be=>{i.value=be,(be==="byPerson"||be==="byTask"||be==="byCheckpoint"||be==="byArea")&&!a.detailedReport&&!a.isLoadingDetailedReport&&o("load-detailed-report")},B=be=>{x.value.has(be)?x.value.delete(be):(x.value.clear(),x.value.add(be)),x.value=new Set(x.value)},M=be=>{E.value.has(be)?E.value.delete(be):(E.value.clear(),E.value.add(be)),E.value=new Set(E.value)},R=be=>{$.value.has(be)?($.value.delete(be),_.value.clear()):($.value.clear(),_.value.clear(),$.value.add(be)),$.value=new Set($.value),_.value=new Set(_.value)},A=be=>{w.value.has(be)?(w.value.delete(be),I.value.clear()):(w.value.clear(),I.value.clear(),w.value.add(be)),w.value=new Set(w.value),I.value=new Set(I.value)},G=(be,V)=>{const Y=`${be}:${V}`;_.value.has(Y)?_.value.delete(Y):([..._.value].filter(ie=>ie.startsWith(`${be}:`)).forEach(ie=>_.value.delete(ie)),_.value.add(Y)),_.value=new Set(_.value)},F=(be,V)=>{const Y=`${be}:${V}`;I.value.has(Y)?I.value.delete(Y):([...I.value].filter(ie=>ie.startsWith(`${be}:`)).forEach(ie=>I.value.delete(ie)),I.value.add(Y)),I.value=new Set(I.value)},j=z(()=>{if(!l.value.trim())return a.checklistItems;const be=l.value.toLowerCase().trim().split(/\s+/);return a.checklistItems.filter(V=>{const Y=(V.text||"").toLowerCase();return be.every(re=>Y.includes(re))})}),K=z(()=>[...j.value].sort((be,V)=>be.displayOrder!==V.displayOrder?be.displayOrder-V.displayOrder:na(be.text,V.text))),J=(be,V)=>be===0?"incomplete":be===V?"complete":"partial",ue=(be,V)=>be===0?"not-started":be===V?"complete":"partial",Z=z(()=>{if(!a.detailedReport?.detailedByPerson)return{total:0,incomplete:0,partial:0,complete:0};const be=a.detailedReport.detailedByPerson;return{total:be.length,incomplete:be.filter(V=>J(V.completedTasks,V.totalTasks)==="incomplete").length,partial:be.filter(V=>J(V.completedTasks,V.totalTasks)==="partial").length,complete:be.filter(V=>J(V.completedTasks,V.totalTasks)==="complete").length}}),se=z(()=>{if(!a.detailedReport?.detailedByTask)return{total:0,incomplete:0,partial:0,complete:0};const be=a.detailedReport.detailedByTask;return{total:be.length,incomplete:be.filter(V=>J(V.completedCount,V.applicableCount)==="incomplete").length,partial:be.filter(V=>J(V.completedCount,V.applicableCount)==="partial").length,complete:be.filter(V=>J(V.completedCount,V.applicableCount)==="complete").length}}),U=z(()=>{if(!a.detailedReport?.detailedByCheckpoint)return{total:0,incomplete:0,partial:0,complete:0};const be=a.detailedReport.detailedByCheckpoint;return{total:be.length,incomplete:be.filter(V=>J(V.completedTasks,V.totalTasks)==="incomplete").length,partial:be.filter(V=>J(V.completedTasks,V.totalTasks)==="partial").length,complete:be.filter(V=>J(V.completedTasks,V.totalTasks)==="complete").length}}),Q=z(()=>{if(!a.detailedReport?.detailedByArea)return{total:0,incomplete:0,partial:0,complete:0};const be=a.detailedReport.detailedByArea;return{total:be.length,incomplete:be.filter(V=>J(V.completedTasks,V.totalTasks)==="incomplete").length,partial:be.filter(V=>J(V.completedTasks,V.totalTasks)==="partial").length,complete:be.filter(V=>J(V.completedTasks,V.totalTasks)==="complete").length}}),oe=z(()=>{if(!a.detailedReport?.detailedByPerson)return[];let be=a.detailedReport.detailedByPerson;if(m.value!=="all"&&(be=be.filter(V=>J(V.completedTasks,V.totalTasks)===m.value)),c.value.trim()){const V=c.value.toLowerCase().trim().split(/\s+/);be=be.filter(Y=>{const re=(Y.marshalName||"").toLowerCase();return V.every(ie=>re.includes(ie))})}return be}),he=z(()=>{if(!a.detailedReport?.detailedByTask)return[];let be=a.detailedReport.detailedByTask;if(y.value!=="all"&&(be=be.filter(V=>J(V.completedCount,V.applicableCount)===y.value)),d.value.trim()){const V=d.value.toLowerCase().trim().split(/\s+/);be=be.filter(Y=>{const re=(Y.text||"").toLowerCase();return V.every(ie=>re.includes(ie))})}return be}),Te=z(()=>{if(!a.detailedReport?.detailedByCheckpoint)return[];let be=[...a.detailedReport.detailedByCheckpoint];if(k.value!=="all"&&(be=be.filter(V=>J(V.completedTasks,V.totalTasks)===k.value)),h.value.trim()){const V=h.value.toLowerCase().trim().split(/\s+/);be=be.filter(Y=>{const re=(Y.checkpointName||"").toLowerCase();return V.every(ie=>re.includes(ie))})}return be.sort((V,Y)=>na(V.checkpointName,Y.checkpointName)),be}),je=z(()=>{if(!a.detailedReport?.detailedByArea)return[];let be=[...a.detailedReport.detailedByArea];if(S.value!=="all"&&(be=be.filter(V=>J(V.completedTasks,V.totalTasks)===S.value)),f.value.trim()){const V=f.value.toLowerCase().trim().split(/\s+/);be=be.filter(Y=>{const re=(Y.areaName||"").toLowerCase();return V.every(ie=>re.includes(ie))})}return be.sort((V,Y)=>na(V.areaName,Y.areaName)),be}),He=be=>[...be].sort((V,Y)=>V.displayOrder!==Y.displayOrder?V.displayOrder-Y.displayOrder:na(V.text,Y.text)),We=({changes:be})=>{o("reorder",be)};return(be,V)=>(p(),g("div",sI,[r("div",iI,[r("div",lI,[r("div",rI,[r("button",{class:le(["view-toggle-btn",{active:i.value==="define"}]),onClick:V[0]||(V[0]=Y=>T("define"))}," Define ",2),r("button",{class:le(["view-toggle-btn",{active:i.value==="byArea"}]),onClick:V[1]||(V[1]=Y=>T("byArea"))}," By "+b(N(n).area),3),r("button",{class:le(["view-toggle-btn",{active:i.value==="byCheckpoint"}]),onClick:V[2]||(V[2]=Y=>T("byCheckpoint"))}," By "+b(N(n).checkpoint),3),r("button",{class:le(["view-toggle-btn",{active:i.value==="byPerson"}]),onClick:V[3]||(V[3]=Y=>T("byPerson"))}," By "+b(N(n).person),3),r("button",{class:le(["view-toggle-btn",{active:i.value==="byTask"}]),onClick:V[4]||(V[4]=Y=>T("byTask"))}," By "+b(N(n).checklist),3)]),i.value==="define"?(p(),g("button",{key:0,onClick:V[5]||(V[5]=Y=>be.$emit("add-checklist-item")),class:"btn btn-primary"}," Add "+b(N(n).checklist),1)):D("",!0)]),i.value==="byArea"&&Q.value.total>0?(p(),g("div",cI,[Ee(Et,{variant:"neutral",active:S.value==="all",onClick:V[6]||(V[6]=Y=>S.value="all")},{default:Ue(()=>[Je(b(Q.value.total)+" total ",1)]),_:1},8,["active"]),Q.value.incomplete>0?(p(),ze(Et,{key:0,variant:"danger",active:S.value==="incomplete",onClick:V[7]||(V[7]=Y=>S.value="incomplete")},{default:Ue(()=>[Je(b(Q.value.incomplete)+" not started ",1)]),_:1},8,["active"])):D("",!0),Q.value.partial>0?(p(),ze(Et,{key:1,variant:"warning",active:S.value==="partial",onClick:V[8]||(V[8]=Y=>S.value="partial")},{default:Ue(()=>[Je(b(Q.value.partial)+" partial ",1)]),_:1},8,["active"])):D("",!0),Q.value.complete>0?(p(),ze(Et,{key:2,variant:"success",active:S.value==="complete",onClick:V[9]||(V[9]=Y=>S.value="complete")},{default:Ue(()=>[Je(b(Q.value.complete)+" complete ",1)]),_:1},8,["active"])):D("",!0)])):D("",!0),i.value==="byCheckpoint"&&U.value.total>0?(p(),g("div",uI,[Ee(Et,{variant:"neutral",active:k.value==="all",onClick:V[10]||(V[10]=Y=>k.value="all")},{default:Ue(()=>[Je(b(U.value.total)+" total ",1)]),_:1},8,["active"]),U.value.incomplete>0?(p(),ze(Et,{key:0,variant:"danger",active:k.value==="incomplete",onClick:V[11]||(V[11]=Y=>k.value="incomplete")},{default:Ue(()=>[Je(b(U.value.incomplete)+" not started ",1)]),_:1},8,["active"])):D("",!0),U.value.partial>0?(p(),ze(Et,{key:1,variant:"warning",active:k.value==="partial",onClick:V[12]||(V[12]=Y=>k.value="partial")},{default:Ue(()=>[Je(b(U.value.partial)+" partial ",1)]),_:1},8,["active"])):D("",!0),U.value.complete>0?(p(),ze(Et,{key:2,variant:"success",active:k.value==="complete",onClick:V[13]||(V[13]=Y=>k.value="complete")},{default:Ue(()=>[Je(b(U.value.complete)+" complete ",1)]),_:1},8,["active"])):D("",!0)])):D("",!0),i.value==="byPerson"&&Z.value.total>0?(p(),g("div",dI,[Ee(Et,{variant:"neutral",active:m.value==="all",onClick:V[14]||(V[14]=Y=>m.value="all")},{default:Ue(()=>[Je(b(Z.value.total)+" total ",1)]),_:1},8,["active"]),Z.value.incomplete>0?(p(),ze(Et,{key:0,variant:"danger",active:m.value==="incomplete",onClick:V[15]||(V[15]=Y=>m.value="incomplete")},{default:Ue(()=>[Je(b(Z.value.incomplete)+" not started ",1)]),_:1},8,["active"])):D("",!0),Z.value.partial>0?(p(),ze(Et,{key:1,variant:"warning",active:m.value==="partial",onClick:V[16]||(V[16]=Y=>m.value="partial")},{default:Ue(()=>[Je(b(Z.value.partial)+" partial ",1)]),_:1},8,["active"])):D("",!0),Z.value.complete>0?(p(),ze(Et,{key:2,variant:"success",active:m.value==="complete",onClick:V[17]||(V[17]=Y=>m.value="complete")},{default:Ue(()=>[Je(b(Z.value.complete)+" complete ",1)]),_:1},8,["active"])):D("",!0)])):D("",!0),i.value==="byTask"&&se.value.total>0?(p(),g("div",hI,[Ee(Et,{variant:"neutral",active:y.value==="all",onClick:V[18]||(V[18]=Y=>y.value="all")},{default:Ue(()=>[Je(b(se.value.total)+" total ",1)]),_:1},8,["active"]),se.value.incomplete>0?(p(),ze(Et,{key:0,variant:"danger",active:y.value==="incomplete",onClick:V[19]||(V[19]=Y=>y.value="incomplete")},{default:Ue(()=>[Je(b(se.value.incomplete)+" not started ",1)]),_:1},8,["active"])):D("",!0),se.value.partial>0?(p(),ze(Et,{key:1,variant:"warning",active:y.value==="partial",onClick:V[20]||(V[20]=Y=>y.value="partial")},{default:Ue(()=>[Je(b(se.value.partial)+" partial ",1)]),_:1},8,["active"])):D("",!0),se.value.complete>0?(p(),ze(Et,{key:2,variant:"success",active:y.value==="complete",onClick:V[21]||(V[21]=Y=>y.value="complete")},{default:Ue(()=>[Je(b(se.value.complete)+" complete ",1)]),_:1},8,["active"])):D("",!0)])):D("",!0)]),i.value==="define"?(p(),g(xe,{key:0},[r("div",fI,[r("div",pI,[Ge(r("input",{"onUpdate:modelValue":V[22]||(V[22]=Y=>l.value=Y),type:"text",class:"search-input",placeholder:`Search ${N(n).checklists}...`},null,8,vI),[[st,l.value]])])]),r("div",mI,[j.value.length===0?(p(),g("div",gI,[r("p",null,b(l.value?`No ${N(n).checklists} match your search.`:`No ${N(n).checklists} yet. Create one to get started!`),1)])):(p(),ze(fl,{key:1,items:K.value,"item-key":"itemId",disabled:!!l.value,onReorder:We},{item:Ue(({element:Y})=>[r("div",yI,[l.value?D("",!0):(p(),ze(pl,{key:0})),r("div",kI,[r("div",{class:"checklist-item-title",onClick:re=>be.$emit("select-checklist-item",Y,"details")},[r("strong",null,b(Y.text),1)],8,bI),Ee(cl,{class:"checklist-item-scopes","scope-configurations":Y.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,onClick:re=>be.$emit("select-checklist-item",Y,"visibility")},null,8,["scope-configurations","areas","locations","marshals","onClick"])])])]),_:1},8,["items","disabled"]))])],64)):i.value==="byPerson"?(p(),g(xe,{key:1},[e.isLoadingDetailedReport?(p(),g("div",_I,[...V[27]||(V[27]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),g(xe,{key:2},[r("div",CI,[r("div",LI,[Ge(r("input",{"onUpdate:modelValue":V[23]||(V[23]=Y=>c.value=Y),type:"text",class:"search-input",placeholder:`Search ${N(n).people}...`},null,8,SI),[[st,c.value]])])]),r("div",II,[oe.value.length===0?(p(),g("div",xI,[r("p",null,b(c.value||m.value!=="all"?`No ${N(n).people} match your filters.`:`No ${N(n).people} with ${N(n).checklists}.`),1)])):D("",!0),(p(!0),g(xe,null,qe(oe.value,Y=>(p(),g("div",{key:Y.marshalId,class:"report-card"},[r("div",{class:"report-card-header",onClick:re=>B(Y.marshalId)},[r("div",TI,[r("span",MI,b(x.value.has(Y.marshalId)?"":""),1),r("strong",null,b(Y.marshalName),1)]),r("div",AI,[r("span",{class:le(["stat-badge",ue(Y.completedTasks,Y.totalTasks)])},b(Y.completedTasks)+" / "+b(Y.totalTasks),3)])],8,$I),x.value.has(Y.marshalId)?(p(),g("div",EI,[(p(!0),g(xe,null,qe(He(Y.tasks),re=>(p(),g("div",{key:re.itemId,class:"task-row"},[r("span",{class:le(["task-status",re.isCompleted?"completed":"pending"])},b(re.isCompleted?"":""),3),r("span",PI,b(re.text),1),re.isCompleted&&re.completedBy?(p(),g("span",DI," by "+b(re.completedBy),1)):D("",!0)]))),128))])):D("",!0)]))),128))])],64)):(p(),g("div",wI,[...V[28]||(V[28]=[r("p",null,"No report data available.",-1)])]))],64)):i.value==="byTask"?(p(),g(xe,{key:2},[e.isLoadingDetailedReport?(p(),g("div",RI,[...V[29]||(V[29]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),g(xe,{key:2},[r("div",BI,[r("div",NI,[Ge(r("input",{"onUpdate:modelValue":V[24]||(V[24]=Y=>d.value=Y),type:"text",class:"search-input",placeholder:`Search ${N(n).checklists}...`},null,8,FI),[[st,d.value]])])]),r("div",UI,[he.value.length===0?(p(),g("div",zI,[r("p",null,b(d.value||y.value!=="all"?`No ${N(n).checklists} match your filters.`:`No ${N(n).checklists} defined.`),1)])):D("",!0),(p(!0),g(xe,null,qe(he.value,Y=>(p(),g("div",{key:Y.itemId,class:"report-card"},[r("div",{class:"report-card-header",onClick:re=>M(Y.itemId)},[r("div",VI,[r("span",GI,b(E.value.has(Y.itemId)?"":""),1),r("strong",null,b(Y.text),1)]),r("div",qI,[r("span",{class:le(["stat-badge",ue(Y.completedCount,Y.applicableCount)])},b(Y.completedCount)+" / "+b(Y.applicableCount),3)])],8,HI),E.value.has(Y.itemId)?(p(),g("div",jI,[Y.marshals.length===0?(p(),g("div",WI,[r("p",null,"No "+b(N(n).people)+" assigned to this "+b(N(n).checklist)+".",1)])):D("",!0),(p(!0),g(xe,null,qe(Y.marshals,re=>(p(),g("div",{key:re.marshalId,class:"task-row"},[r("span",{class:le(["task-status",re.isCompleted?"completed":"pending"])},b(re.isCompleted?"":""),3),r("span",ZI,b(re.marshalName),1),re.isCompleted&&re.completedBy?(p(),g("span",KI," by "+b(re.completedBy),1)):D("",!0)]))),128))])):D("",!0)]))),128))])],64)):(p(),g("div",OI,[...V[30]||(V[30]=[r("p",null,"No report data available.",-1)])]))],64)):i.value==="byArea"?(p(),g(xe,{key:3},[e.isLoadingDetailedReport?(p(),g("div",YI,[...V[31]||(V[31]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),g(xe,{key:2},[r("div",XI,[r("div",QI,[Ge(r("input",{"onUpdate:modelValue":V[25]||(V[25]=Y=>f.value=Y),type:"text",class:"search-input",placeholder:`Search ${N(n).areas}...`},null,8,ex),[[st,f.value]])])]),r("div",tx,[je.value.length===0?(p(),g("div",nx,[r("p",null,b(f.value||S.value!=="all"?`No ${N(n).areas} match your filters.`:`No ${N(n).areas} with ${N(n).people}.`),1)])):D("",!0),(p(!0),g(xe,null,qe(je.value,Y=>(p(),g("div",{key:Y.areaId,class:"report-card"},[r("div",{class:"report-card-header",onClick:re=>A(Y.areaId)},[r("div",ax,[r("span",sx,b(w.value.has(Y.areaId)?"":""),1),r("strong",null,b(Y.areaName),1)]),r("div",ix,[r("span",lx,b(Y.totalPeople)+" "+b(Y.totalPeople===1?N(n).person:N(n).people),1),r("span",{class:le(["stat-badge",ue(Y.completedTasks,Y.totalTasks)])},b(Y.completedTasks)+" / "+b(Y.totalTasks),3)])],8,ox),w.value.has(Y.areaId)?(p(),g("div",rx,[(p(!0),g(xe,null,qe(Y.people,re=>(p(),g("div",{key:re.marshalId,class:"nested-card"},[r("div",{class:"nested-card-header",onClick:ct(ie=>F(Y.areaId,re.marshalId),["stop"])},[r("div",ux,[r("span",dx,b(I.value.has(`${Y.areaId}:${re.marshalId}`)?"":""),1),r("strong",null,b(re.marshalName),1)]),r("div",hx,[r("span",{class:le(["stat-badge small",ue(re.completedTasks,re.totalTasks)])},b(re.completedTasks)+" / "+b(re.totalTasks),3)])],8,cx),I.value.has(`${Y.areaId}:${re.marshalId}`)?(p(),g("div",fx,[(p(!0),g(xe,null,qe(He(re.tasks),ie=>(p(),g("div",{key:ie.itemId,class:"task-row"},[r("span",{class:le(["task-status",ie.isCompleted?"completed":"pending"])},b(ie.isCompleted?"":""),3),r("span",px,b(ie.text),1),ie.isCompleted&&ie.completedBy?(p(),g("span",vx," by "+b(ie.completedBy),1)):D("",!0)]))),128))])):D("",!0)]))),128))])):D("",!0)]))),128))])],64)):(p(),g("div",JI,[...V[32]||(V[32]=[r("p",null,"No report data available.",-1)])]))],64)):i.value==="byCheckpoint"?(p(),g(xe,{key:4},[e.isLoadingDetailedReport?(p(),g("div",mx,[...V[33]||(V[33]=[r("p",null,"Loading report...",-1)])])):e.detailedReport?(p(),g(xe,{key:2},[r("div",yx,[r("div",kx,[Ge(r("input",{"onUpdate:modelValue":V[26]||(V[26]=Y=>h.value=Y),type:"text",class:"search-input",placeholder:`Search ${N(n).checkpoints}...`},null,8,bx),[[st,h.value]])])]),r("div",_x,[Te.value.length===0?(p(),g("div",wx,[r("p",null,b(h.value||k.value!=="all"?`No ${N(n).checkpoints} match your filters.`:`No ${N(n).checkpoints} with ${N(n).people}.`),1)])):D("",!0),(p(!0),g(xe,null,qe(Te.value,Y=>(p(),g("div",{key:Y.checkpointId,class:"report-card"},[r("div",{class:"report-card-header",onClick:re=>R(Y.checkpointId)},[r("div",Lx,[r("span",Sx,b($.value.has(Y.checkpointId)?"":""),1),r("div",Ix,[r("strong",null,b(Y.checkpointName),1),Y.checkpointDescription?(p(),g("span",xx,b(Y.checkpointDescription),1)):D("",!0)])]),r("div",$x,[r("span",Tx,b(Y.totalPeople)+" "+b(Y.totalPeople===1?N(n).person:N(n).people),1),r("span",{class:le(["stat-badge",ue(Y.completedTasks,Y.totalTasks)])},b(Y.completedTasks)+" / "+b(Y.totalTasks),3)])],8,Cx),$.value.has(Y.checkpointId)?(p(),g("div",Mx,[(p(!0),g(xe,null,qe(Y.people,re=>(p(),g("div",{key:re.marshalId,class:"nested-card"},[r("div",{class:"nested-card-header",onClick:ct(ie=>G(Y.checkpointId,re.marshalId),["stop"])},[r("div",Ex,[r("span",Px,b(_.value.has(`${Y.checkpointId}:${re.marshalId}`)?"":""),1),r("strong",null,b(re.marshalName),1)]),r("div",Dx,[r("span",{class:le(["stat-badge small",ue(re.completedTasks,re.totalTasks)])},b(re.completedTasks)+" / "+b(re.totalTasks),3)])],8,Ax),_.value.has(`${Y.checkpointId}:${re.marshalId}`)?(p(),g("div",Rx,[(p(!0),g(xe,null,qe(He(re.tasks),ie=>(p(),g("div",{key:ie.itemId,class:"task-row"},[r("span",{class:le(["task-status",ie.isCompleted?"completed":"pending"])},b(ie.isCompleted?"":""),3),r("span",Ox,b(ie.text),1),ie.isCompleted&&ie.completedBy?(p(),g("span",Bx," by "+b(ie.completedBy),1)):D("",!0)]))),128))])):D("",!0)]))),128))])):D("",!0)]))),128))])],64)):(p(),g("div",gx,[...V[34]||(V[34]=[r("p",null,"No report data available.",-1)])]))],64)):D("",!0)]))}},Fx=Ze(Nx,[["__scopeId","data-v-48e233e8"]]),Ux={class:"notes-tab"},zx={class:"tab-header"},Hx={class:"button-group"},Vx={class:"filters-section"},Gx={class:"search-group"},qx={class:"notes-list"},jx={key:0,class:"empty-state"},Wx=["onClick"],Zx={class:"note-header"},Kx={class:"note-title-row"},Yx={key:0,class:"pin-icon",title:"Pinned"},Jx={key:1,class:"emergency-indicator",title:"Shown in emergency info"},Xx={class:"note-meta"},Qx={key:0,class:"category-badge"},e$={class:"created-info"},t$={key:0,class:"note-preview"},n$={__name:"NotesTab",props:{notes:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["add-note","select-note","reorder"],setup(e,{emit:t}){const n=e,a=t,o=P(""),i=z(()=>{if(!o.value.trim())return n.notes;const f=o.value.toLowerCase().trim().split(/\s+/);return n.notes.filter(m=>{const y=`${m.title||""} ${m.content||""} ${m.priority||""}`.toLowerCase();return f.every(k=>y.includes(k))})}),l=z(()=>{const f={Urgent:0,High:1,Normal:2,Low:3};return[...i.value].sort((m,y)=>{if(m.isPinned!==y.isPinned)return m.isPinned?-1:1;const k=f[m.priority]??2,S=f[y.priority]??2;return k!==S?k-S:m.displayOrder!==y.displayOrder?m.displayOrder-y.displayOrder:na(m.title,y.title)})}),c=({changes:f})=>{const m=f.map(y=>({id:y.id,displayOrder:y.displayOrder}));a("reorder",m)},d=f=>{if(!f)return"";const m=150;return f.length<=m?f:f.substring(0,m)+"..."},h=f=>{if(!f)return"";const m=new Date(f),k=new Date-m,S=Math.floor(k/6e4),x=Math.floor(k/36e5),E=Math.floor(k/864e5);return S<1?"Just now":S<60?`${S}m ago`:x<24?`${x}h ago`:E<7?`${E}d ago`:m.toLocaleDateString()};return(f,m)=>(p(),g("div",Ux,[r("div",zx,[r("div",Hx,[r("button",{onClick:m[0]||(m[0]=y=>f.$emit("add-note")),class:"btn btn-primary"}," Add note ")])]),r("div",Vx,[r("div",Gx,[Ge(r("input",{"onUpdate:modelValue":m[1]||(m[1]=y=>o.value=y),type:"text",class:"search-input",placeholder:"Search by title, content, or priority..."},null,512),[[st,o.value]])])]),r("div",qx,[i.value.length===0?(p(),g("div",jx,[r("p",null,b(o.value?"No notes match your search.":"No notes yet. Create one to get started!"),1)])):(p(),ze(fl,{key:1,items:l.value,"item-key":"noteId","pinned-key":"isPinned",disabled:!!o.value,onReorder:c},{item:Ue(({element:y})=>[r("div",{class:le(["note-card",{pinned:y.isPinned}])},[o.value?D("",!0):(p(),ze(pl,{key:0})),r("div",{class:"note-content",onClick:k=>f.$emit("select-note",y)},[r("div",Zx,[r("div",Kx,[y.isPinned?(p(),g("span",Yx,"")):D("",!0),r("span",{class:le(["priority-indicator",y.priority?.toLowerCase()||"normal"])},null,2),r("strong",null,b(y.title),1),y.showInEmergencyInfo?(p(),g("span",Jx,"")):D("",!0)]),r("div",Xx,[y.category?(p(),g("span",Qx,b(y.category),1)):D("",!0),r("span",e$,b(h(y.createdAt)),1)])]),y.content?(p(),g("div",t$,b(d(y.content)),1)):D("",!0),Ee(cl,{"scope-configurations":y.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])],8,Wx)],2)]),_:1},8,["items","disabled"]))])]))}},o$=Ze(n$,[["__scopeId","data-v-715ffc72"]]),a$={class:"contacts-tab"},s$={class:"tab-header"},i$={class:"button-group"},l$={key:0,class:"status-pills"},r$={class:"filters-section"},c$={class:"search-group"},u$={class:"contacts-list"},d$={key:0,class:"empty-state"},h$=["onClick"],f$={class:"contact-header"},p$={class:"contact-name-row"},v$={key:0,class:"pin-icon",title:"Pinned"},m$={key:1,class:"primary-badge",title:"Primary contact"},g$={key:2,class:"emergency-indicator",title:"Shown in emergency info"},y$={class:"contact-roles"},k$={class:"contact-details"},b$={key:0,class:"contact-detail"},_$={key:1,class:"contact-detail"},w$={key:0,class:"contact-notes"},C$={key:2,class:"no-scope-warning"},L$={__name:"ContactsTab",props:{contacts:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},roleDefinitions:{type:Array,default:()=>[]}},emits:["add-contact","select-contact","reorder"],setup(e,{emit:t}){const n=e,a=t,o=P(""),i=P("all"),l=z(()=>n.contacts.filter(_=>!_.scopeConfigurations||_.scopeConfigurations.length===0).length),c=z(()=>n.contacts.filter(_=>_.scopeConfigurations&&_.scopeConfigurations.length>0).length),d=_=>{i.value=_},h=_=>_?_.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",f=z(()=>{const _=new Map;for(const I of n.roleDefinitions)_.set(I.roleId,I.name),_.set(I.name,I.name);return _}),m=_=>{if(!_)return"";const I=f.value.get(_);return I||_.replace(/([A-Z])/g," $1").replace(/^./,T=>T.toUpperCase()).trim()},y=_=>_.roles&&Array.isArray(_.roles)&&_.roles.length>0?_.roles:_.role?[_.role]:[],k=_=>y(_).map(m).join(" "),S=_=>{if(!_)return"";const I=100;return _.length<=I?_:_.substring(0,I)+"..."},x=z(()=>{let _=n.contacts;if(i.value==="no-scope"?_=_.filter(I=>!I.scopeConfigurations||I.scopeConfigurations.length===0):i.value==="with-scope"&&(_=_.filter(I=>I.scopeConfigurations&&I.scopeConfigurations.length>0)),o.value.trim()){const T=h(o.value).split(" ").filter(B=>B.length>0);_=_.filter(B=>{const M=k(B),R=h(`${B.name||""} ${M} ${B.email||""} ${B.phone||""}`);return T.every(A=>R.includes(A))})}return _}),E=z(()=>[...x.value].sort((_,I)=>{if(_.isPinned!==I.isPinned)return _.isPinned?-1:1;const T=_.displayOrder||0,B=I.displayOrder||0;return T!==B?T-B:(_.name||"").localeCompare(I.name||"",void 0,{sensitivity:"base"})})),$=z(()=>{const _=o.value.trim();return i.value==="no-scope"?_?"No unassigned contacts match your search.":"All contacts are assigned.":i.value==="with-scope"?_?"No assigned contacts match your search.":"No contacts are assigned yet.":_?"No contacts match your search.":"No contacts yet. Create one to get started!"}),w=({changes:_})=>{a("reorder",_)};return(_,I)=>(p(),g("div",a$,[r("div",s$,[r("div",i$,[r("button",{onClick:I[0]||(I[0]=T=>_.$emit("add-contact")),class:"btn btn-primary"}," Add contact ")]),e.contacts.length>0?(p(),g("div",l$,[Ee(Et,{variant:"neutral",active:i.value==="all",onClick:I[1]||(I[1]=T=>d("all"))},{default:Ue(()=>[Je(b(e.contacts.length)+" total ",1)]),_:1},8,["active"]),c.value>0&&c.value<e.contacts.length?(p(),ze(Et,{key:0,variant:"success",active:i.value==="with-scope",onClick:I[2]||(I[2]=T=>d("with-scope"))},{default:Ue(()=>[Je(b(c.value)+" assigned ",1)]),_:1},8,["active"])):D("",!0),l.value>0&&l.value<e.contacts.length?(p(),ze(Et,{key:1,variant:"danger",active:i.value==="no-scope",onClick:I[3]||(I[3]=T=>d("no-scope"))},{default:Ue(()=>[Je(b(l.value)+" unassigned ",1)]),_:1},8,["active"])):D("",!0)])):D("",!0)]),r("div",r$,[r("div",c$,[Ge(r("input",{"onUpdate:modelValue":I[4]||(I[4]=T=>o.value=T),type:"text",class:"search-input",placeholder:"Search by name, role, email, or phone..."},null,512),[[st,o.value]])])]),r("div",u$,[x.value.length===0?(p(),g("div",d$,[r("p",null,b($.value),1)])):(p(),ze(fl,{key:1,items:E.value,"item-key":"contactId","pinned-key":"isPinned",layout:"grid",disabled:!!o.value||i.value!=="all",onReorder:w},{item:Ue(({element:T})=>[r("div",{class:le(["contact-card",{pinned:T.isPinned,primary:T.isPrimary}])},[!o.value&&i.value==="all"?(p(),ze(pl,{key:0})):D("",!0),r("div",{class:"contact-content",onClick:B=>_.$emit("select-contact",T)},[r("div",f$,[r("div",p$,[T.isPinned?(p(),g("span",v$,"")):D("",!0),T.isPrimary?(p(),g("span",m$,"")):D("",!0),r("strong",null,b(T.name),1),T.showInEmergencyInfo?(p(),g("span",g$,"")):D("",!0)]),r("div",y$,[(p(!0),g(xe,null,qe(y(T),B=>(p(),g("span",{key:B,class:le(["role-badge",{"emergency-role":B==="Emergency"}])},b(m(B)),3))),128))])]),r("div",k$,[T.phone?(p(),g("span",b$,b(T.phone),1)):D("",!0),T.email?(p(),g("span",_$,b(T.email),1)):D("",!0)]),T.notes?(p(),g("div",w$,b(S(T.notes)),1)):D("",!0),T.scopeConfigurations&&T.scopeConfigurations.length>0?(p(),ze(cl,{key:1,"scope-configurations":T.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])):(p(),g("div",C$," No visibility scope configured "))],8,h$)],2)]),_:1},8,["items","disabled"]))])]))}},S$=Ze(L$,[["__scopeId","data-v-83f433bf"]]),I$={class:"roles-tab"},x$={class:"tab-header"},$$={class:"button-group"},T$={key:0,class:"status-pills"},M$={class:"filters-section"},A$={class:"search-group"},E$={class:"roles-list"},P$={key:0,class:"empty-state"},D$=["onClick"],R$={class:"role-header"},O$={class:"role-name-row"},B$={key:0,class:"built-in-badge",title:"Built-in role"},N$={class:"role-usage"},F$={key:0,class:"role-notes"},U$={key:1,class:"role-notes empty"},z$={__name:"RolesTab",props:{roleDefinitions:{type:Array,required:!0}},emits:["add-role","select-role","reorder"],setup(e,{emit:t}){const n=e,a=t,o=P(""),i=z(()=>n.roleDefinitions.reduce((y,k)=>y+(k.usageCount||0),0)),l=y=>y?y.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",c=y=>{if(!y)return"";const k=150;return y.length<=k?y:y.substring(0,k)+"..."},d=z(()=>{if(!o.value.trim())return n.roleDefinitions;const k=l(o.value).split(" ").filter(S=>S.length>0);return n.roleDefinitions.filter(S=>{const x=l(`${S.name||""} ${S.notes||""}`);return k.every(E=>x.includes(E))})}),h=z(()=>[...d.value].sort((y,k)=>{const S=y.displayOrder||0,x=k.displayOrder||0;return S!==x?S-x:(y.name||"").localeCompare(k.name||"",void 0,{numeric:!0,sensitivity:"base"})})),f=z(()=>o.value.trim()?"No roles match your search.":"No roles defined yet. Create one to get started!"),m=({changes:y})=>{a("reorder",y)};return(y,k)=>(p(),g("div",I$,[r("div",x$,[r("div",$$,[r("button",{onClick:k[0]||(k[0]=S=>y.$emit("add-role")),class:"btn btn-primary"}," Add role ")]),e.roleDefinitions.length>0?(p(),g("div",T$,[Ee(Et,{variant:"neutral"},{default:Ue(()=>[Je(b(e.roleDefinitions.length)+" "+b(e.roleDefinitions.length===1?"role":"roles"),1)]),_:1}),i.value>0?(p(),ze(Et,{key:0,variant:"success"},{default:Ue(()=>[Je(b(i.value)+" "+b(i.value===1?"assignment":"assignments"),1)]),_:1})):D("",!0)])):D("",!0)]),r("div",M$,[r("div",A$,[Ge(r("input",{"onUpdate:modelValue":k[1]||(k[1]=S=>o.value=S),type:"text",class:"search-input",placeholder:"Search by name or notes..."},null,512),[[st,o.value]])])]),r("div",E$,[d.value.length===0?(p(),g("div",P$,[r("p",null,b(f.value),1)])):(p(),ze(fl,{key:1,items:h.value,"item-key":"roleId",disabled:!!o.value,onReorder:m},{item:Ue(({element:S})=>[r("div",{class:le(["role-card",{"built-in":S.isBuiltIn}])},[o.value?D("",!0):(p(),ze(pl,{key:0})),r("div",{class:"role-content",onClick:x=>y.$emit("select-role",S)},[r("div",R$,[r("div",O$,[r("strong",null,b(S.name),1),S.isBuiltIn?(p(),g("span",B$,"Built-in")):D("",!0)]),r("div",N$,[r("span",{class:le(["usage-badge",{"has-usage":S.usageCount>0}])},b(S.usageCount)+" "+b(S.usageCount===1?"person":"people"),3)])]),S.notes?(p(),g("div",F$,b(c(S.notes)),1)):(p(),g("div",U$," No notes "))],8,D$)],2)]),_:1},8,["items","disabled"]))])]))}},H$=Ze(z$,[["__scopeId","data-v-634d49c0"]]),d1=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET/CEST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Australia/Sydney",label:"Sydney (AEDT/AEST)"}],V$={class:"event-details-tab"},G$={class:"event-info-card"},q$={class:"form-group"},j$={class:"form-group"},W$={class:"form-row"},Z$={class:"form-group"},K$={class:"form-group"},Y$=["value"],J$={class:"form-actions"},X$=["disabled"],Q$={__name:"EventDetailsTab",props:{eventData:{type:Object,required:!0},formDirty:{type:Boolean,default:!1}},emits:["submit","update:formDirty"],setup(e,{emit:t}){const n=e,a=t,o=P({...n.eventData});Ye(()=>n.eventData,c=>{o.value={...c}},{deep:!0});const i=()=>{a("update:formDirty",!0)},l=()=>{a("submit",{...o.value})};return(c,d)=>(p(),g("div",V$,[r("div",G$,[r("form",{onSubmit:ct(l,["prevent"]),class:"event-details-form"},[r("div",q$,[d[4]||(d[4]=r("label",null,"Event name",-1)),Ge(r("input",{"onUpdate:modelValue":d[0]||(d[0]=h=>o.value.name=h),type:"text",required:"",class:"form-input",onInput:i},null,544),[[st,o.value.name]])]),r("div",j$,[d[5]||(d[5]=r("label",null,"Description",-1)),Ge(r("textarea",{"onUpdate:modelValue":d[1]||(d[1]=h=>o.value.description=h),rows:"3",class:"form-input",onInput:i},null,544),[[st,o.value.description]])]),r("div",W$,[r("div",Z$,[d[6]||(d[6]=r("label",null,"Event date & time",-1)),Ge(r("input",{"onUpdate:modelValue":d[2]||(d[2]=h=>o.value.eventDate=h),type:"datetime-local",required:"",class:"form-input",onInput:i},null,544),[[st,o.value.eventDate]])]),r("div",K$,[d[7]||(d[7]=r("label",null,"Time zone",-1)),Ge(r("select",{"onUpdate:modelValue":d[3]||(d[3]=h=>o.value.timeZoneId=h),required:"",class:"form-input",onChange:i},[(p(!0),g(xe,null,qe(N(d1),h=>(p(),g("option",{key:h.value,value:h.value},b(h.label),9,Y$))),128))],544),[[no,o.value.timeZoneId]])])]),r("div",J$,[r("button",{type:"submit",class:"btn btn-save",disabled:!e.formDirty}," Save ",8,X$)])],32)])]))}},eT=Ze(Q$,[["__scopeId","data-v-2754c3cc"]]),tT={class:"admins-list"},nT={class:"admin-info"},oT={class:"admin-role"},aT=["onClick"],sT={__name:"AdminsList",props:{admins:{type:Array,required:!0}},emits:["add-admin","remove-admin"],setup(e){return(t,n)=>(p(),g("div",null,[r("button",{onClick:n[0]||(n[0]=a=>t.$emit("add-admin")),class:"btn btn-small btn-primary"}," Add administrator "),r("div",tT,[(p(!0),g(xe,null,qe(e.admins,a=>(p(),g("div",{key:a.userEmail,class:"admin-item"},[r("div",nT,[r("strong",null,b(a.userEmail),1),r("span",oT,b(a.role),1)]),e.admins.length>1?(p(),g("button",{key:0,onClick:o=>t.$emit("remove-admin",a.userEmail),class:"btn btn-small btn-danger"}," Remove ",8,aT)):D("",!0)]))),128))])]))}},iT=Ze(sT,[["__scopeId","data-v-e526860b"]]),Kn=[{name:"Charcoal",hex:"#2d3748"},{name:"Dark Gray",hex:"#4a5568"},{name:"Gray",hex:"#718096"},{name:"Red",hex:"#f56565"},{name:"Coral",hex:"#ff6b6b"},{name:"Rose",hex:"#fb7185"},{name:"Pink",hex:"#ed64a6"},{name:"Magenta",hex:"#d946ef"},{name:"Fuchsia",hex:"#e879f9"},{name:"Purple",hex:"#9f7aea"},{name:"Violet",hex:"#a78bfa"},{name:"Lavender",hex:"#b197fc"},{name:"Indigo",hex:"#5a67d8"},{name:"Navy",hex:"#4263eb"},{name:"Blue",hex:"#667eea"},{name:"Sky",hex:"#0ea5e9"},{name:"Cyan",hex:"#0bc5ea"},{name:"Aqua",hex:"#22d3ee"},{name:"Teal",hex:"#38b2ac"},{name:"Emerald",hex:"#10b981"},{name:"Green",hex:"#48bb78"},{name:"Mint",hex:"#51cf66"},{name:"Lime",hex:"#84cc16"},{name:"Olive",hex:"#a3b18a"},{name:"Yellow",hex:"#ecc94b"},{name:"Amber",hex:"#f59e0b"},{name:"Orange",hex:"#ed8936"},{name:"Peach",hex:"#ff922b"},{name:"Light Gray",hex:"#cbd5e0"},{name:"Silver",hex:"#e2e8f0"},{name:"Cream",hex:"#f7fafc"}],nu="#667eea";function lT(e){const t=e.map(a=>a.color);return Kn.find(a=>!t.includes(a.hex))?.hex||nu}const rT={class:"modal-content"},cT={class:"modal-body"},uT={class:"preview-section"},dT={class:"map-preview"},hT=["innerHTML"],fT={class:"options-grid"},pT={class:"option-button-content"},vT={class:"option-button-value icon-value"},mT=["innerHTML"],gT={class:"option-button-content"},yT={class:"option-button-value color-value"},kT=["disabled"],bT={class:"option-button-content"},_T={class:"option-button-value color-value"},wT={class:"option-button-content"},CT={class:"option-button-value icon-value"},LT=["innerHTML"],ST=["disabled"],IT={class:"option-button-content"},xT={class:"option-button-value color-value"},$T={class:"option-button-content"},TT={class:"option-button-value"},MT={class:"option-button-content"},AT={class:"option-button-value"},ET={key:0,class:"centered-popup"},PT={class:"popup-grid"},DT=["onClick"],RT=["innerHTML"],OT={key:0},BT={key:1,class:"centered-popup"},NT={class:"popup-grid"},FT=["title","onClick"],UT=["innerHTML"],zT={key:0},HT={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},VT={key:1,class:"custom-check-mark"},GT={key:0,class:"custom-hex-input"},qT={class:"hex-input-row"},jT=["disabled"],WT={key:0,class:"hex-error"},ZT={key:2,class:"centered-popup"},KT={class:"popup-grid"},YT=["title","onClick"],JT=["innerHTML"],XT={key:0},QT={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},eM={key:1,class:"custom-check-mark"},tM={key:0,class:"custom-hex-input"},nM={class:"hex-input-row"},oM=["disabled"],aM={key:0,class:"hex-error"},sM={key:3,class:"centered-popup icon-popup"},iM={class:"popup-grid"},lM=["onClick"],rM=["innerHTML"],cM={key:0},uM={key:4,class:"centered-popup"},dM={class:"popup-grid"},hM=["title","onClick"],fM=["innerHTML"],pM={key:0},vM={key:0,class:"custom-color-icon",viewBox:"0 0 24 24",fill:"currentColor"},mM={key:1,class:"custom-check-mark"},gM={key:0,class:"custom-hex-input"},yM={class:"hex-input-row"},kM=["disabled"],bM={key:0,class:"hex-error"},_M={key:5,class:"centered-popup"},wM={class:"size-grid"},CM=["onClick"],LM=["innerHTML"],SM={key:6,class:"centered-popup"},IM={class:"rotation-content"},xM={class:"rotation-preview-container"},$M=["innerHTML"],TM={class:"rotation-control"},MM={class:"rotation-slider-container"},AM=["value"],EM={class:"rotation-value"},PM={class:"rotation-presets"},DM="#667eea",RM={__name:"IconCustomizationModal",props:{isOpen:{type:Boolean,default:!1},iconType:{type:String,default:"none"},backgroundShape:{type:String,default:"circle"},backgroundColor:{type:String,default:""},borderColor:{type:String,default:""},iconColor:{type:String,default:""},size:{type:String,default:"100"},mapRotation:{type:[String,Number],default:""},level:{type:String,default:"checkpoint"},inheritedType:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""}},emits:["update:isOpen","apply","cancel"],setup(e,{emit:t}){const n=e,a=t,o=P(n.backgroundShape||"circle"),i=P(n.iconType||"none"),l=P(n.backgroundColor||""),c=P(n.borderColor||""),d=P(n.iconColor||""),h=P(n.size||"100"),f=P(n.mapRotation??""),m=P(null),y=P(!1),k=P(!1),S=P(!1),x=P(""),E=P(""),$=P(""),w=P(null),_=P(null),I=P(null),T=pe=>pe==="default"?n.inheritedBackgroundShape||"circle":pe==="none"?"none":pe||"circle",B=pe=>pe==="default"||!pe?U():pe==="none"?"transparent":pe,M=pe=>pe==="default"?n.inheritedBorderColor||"#ffffff":pe==="none"||!pe?"transparent":pe,R=pe=>{if(pe==="default"){const ve=n.inheritedType;return ve&&ve!=="default"&&il(ve).category==="content"?ve:"none"}return pe==="none"||!pe?"none":pe},A=pe=>pe==="default"||!pe?n.inheritedIconColor||"#ffffff":pe==="none"?"transparent":pe,G=pe=>pe==="default"?n.inheritedSize||"100":pe||"100",F=pe=>{if(pe==="default"||pe===""){const ve=n.inheritedMapRotation;return ve!==""&&ve!==void 0&&ve!==null&&parseInt(ve,10)||0}return parseInt(pe,10)||0},j=z(()=>{const pe=n.inheritedBackgroundShape||"circle",ve=Oc.find(Le=>Le.value===pe)?.label||"Circle";return[{value:"none",label:"None",showLabel:!0},{value:"default",label:`Default (${ve})`,showLabel:!0},...Oc.filter(Le=>Le.value!=="none").map(Le=>({...Le,showLabel:!1}))]}),K=z(()=>{const pe=_u.filter(lt=>lt.category==="content"),ve=[{value:"none",label:"None",category:"content",showLabel:!0}],Le=n.inheritedType;if(Le&&Le!=="default"){const lt=il(Le);lt.category==="content"&&ve.push({value:"default",label:`Default (${lt.label||Le})`,category:"content",showLabel:!0})}return ve.push(...pe.map(lt=>({...lt,showLabel:!1}))),ve}),J=z(()=>{const pe={33:"Small",66:"Medium",100:"Normal",150:"Large"};return[{value:"default",label:`Default (${pe[n.inheritedSize]||"Normal"})`},...m2.map(Le=>({value:Le.value,label:pe[Le.value]||Le.label}))]}),ue=z(()=>T(o.value)!=="none"),Z=z(()=>R(i.value)!=="none"),se=z(()=>{const pe=n.inheritedBackgroundColor;return pe&&pe!=="default"&&pe.startsWith("#")?pe:DM}),U=()=>se.value,Q=z(()=>l.value&&l.value!=="default"?l.value:U()),oe=z(()=>c.value==="none"?"transparent":c.value?c.value:n.inheritedBorderColor&&n.inheritedBorderColor!=="none"?n.inheritedBorderColor:"#ffffff"),he=z(()=>d.value?d.value:n.inheritedIconColor?n.inheritedIconColor:"#ffffff"),Te=z(()=>{const pe=se.value,ve=Kn.find(Le=>Le.hex.toLowerCase()===pe.toLowerCase())?.name||"Custom";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ve})`,showLabel:!0},...Kn.map(Le=>({hex:Le.hex,name:Le.name,showLabel:!1}))]}),je=z(()=>{const pe=n.inheritedBorderColor||"#ffffff",ve=pe==="#ffffff"?"White":Kn.find(Le=>Le.hex===pe)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ve})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Kn.filter(Le=>Le.hex!=="#ffffff").map(Le=>({hex:Le.hex,name:Le.name,showLabel:!1}))]}),He=z(()=>{const pe=n.inheritedIconColor||"#ffffff",ve=pe==="#ffffff"?"White":Kn.find(Le=>Le.hex===pe)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${ve})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...Kn.filter(Le=>Le.hex!=="#ffffff").map(Le=>({hex:Le.hex,name:Le.name,showLabel:!1}))]}),We=pe=>pe==="default"?!l.value||l.value==="default":l.value===pe,be=pe=>pe==="#ffffff"?!d.value||d.value==="#ffffff":d.value===pe,V=z(()=>{const pe=l.value;return!pe||pe==="default"||pe==="none"?!1:!Kn.some(ve=>ve.hex.toLowerCase()===pe.toLowerCase())}),Y=z(()=>{const pe=c.value;return!pe||pe==="default"||pe==="none"||pe==="#ffffff"||pe==="#000000"?!1:!Kn.some(ve=>ve.hex.toLowerCase()===pe.toLowerCase())}),re=z(()=>{const pe=d.value;return!pe||pe==="default"||pe==="none"||pe==="#ffffff"||pe==="#000000"?!1:!Kn.some(ve=>ve.hex.toLowerCase()===pe.toLowerCase())}),ie=z(()=>{if(!x.value)return!1;const pe=x.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(pe)||/^[0-9A-Fa-f]{3}$/.test(pe)}),$e=z(()=>{if(!E.value)return!1;const pe=E.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(pe)||/^[0-9A-Fa-f]{3}$/.test(pe)}),q=z(()=>{if(!$.value)return!1;const pe=$.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(pe)||/^[0-9A-Fa-f]{3}$/.test(pe)}),X=pe=>{if(pe==="none")return"None";if(pe==="default"){const Le=n.inheritedBackgroundShape;return Le?`Default (${Oc.find(Qe=>Qe.value===Le)?.label||"Circle"})`:"Default (Circle)"}const ve=Oc.find(Le=>Le.value===pe);return ve?ve.label:"Circle"},ee=pe=>{if(pe==="none")return"None";if(pe==="default"){const Le=n.inheritedType;if(Le&&Le!=="default"){const lt=il(Le);if(lt.category==="content")return`Default (${lt.label||Le})`}return"Default"}const ve=_u.find(Le=>Le.value===pe);return ve?ve.label:"None"},Ce=pe=>{if(pe==="none")return"None";if(!pe||pe==="default"){const Le=se.value;return`Default (${Kn.find(Qe=>Qe.hex.toLowerCase()===Le.toLowerCase())?.name||"Custom"})`}const ve=[...Kn].find(Le=>Le.hex.toLowerCase()===pe.toLowerCase());return ve?ve.name:pe},Ne=pe=>{if(pe==="none")return"None";if(pe==="default"){const Le=n.inheritedBorderColor;return Le&&Le!=="none"?`Default (${Le==="#ffffff"?"White":Kn.find(Qe=>Qe.hex===Le)?.name||"Custom"})`:"Default (White)"}if(!pe||pe==="#ffffff")return"White";const ve=[...je.value].find(Le=>Le.hex===pe);return ve?ve.name:pe},Be=pe=>{if(pe==="none")return"None";if(pe==="default"){const Le=n.inheritedIconColor;return Le?`Default (${Le==="#ffffff"?"White":Kn.find(Qe=>Qe.hex===Le)?.name||"Custom"})`:"Default (White)"}if(!pe||pe==="#ffffff")return"White";const ve=[...He.value].find(Le=>Le.hex===pe);return ve?ve.name:pe},Ae=pe=>{const ve={33:"Small",66:"Medium",100:"Normal",150:"Large"};if(pe==="default"){const Le=n.inheritedSize;return`Default (${ve[Le]||"Normal"})`}return ve[pe]||"Normal"},ne=pe=>{if(pe==="default"||pe===""||pe===void 0||pe===null){const ve=n.inheritedMapRotation;return ve!==""&&ve!==void 0&&ve!==null?`Default (${ve})`:"Default (0)"}return`${pe}`},ye=pe=>{if(pe==="none")return`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`;const ve=T(pe),Le=B(l.value),lt=M(c.value);return Vl[ve]?`<svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">${Vl[ve]({backgroundColor:Le,borderColor:lt==="transparent"?"none":lt})}</svg>`:""},De=pe=>{const ve=R(pe);return ve==="none"?`<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
      <rect x="1" y="1" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`:Vn({type:ve,backgroundShape:"circle",backgroundColor:"#94a3b8",borderColor:"none",iconColor:"#fff",size:"75"})},Pe=pe=>{const ve=T(pe);if(ve==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="none" stroke="#ccc" stroke-width="2" stroke-dasharray="4"/>
    </svg>`;const Le=B(l.value),lt=M(c.value),Qe=R(i.value),Rt=A(d.value);return Vn({type:Qe!=="none"?Qe:ve,backgroundShape:ve,backgroundColor:Le,borderColor:lt==="transparent"?"none":lt,iconColor:Rt,size:"100",outputSize:28})},Ie=pe=>{const ve=B(pe),Le=T(o.value),lt=M(c.value),Qe=R(i.value),Rt=A(d.value);return Le==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ve==="transparent"?"#e2e8f0":ve}"/>
    </svg>`:Vn({type:Qe!=="none"?Qe:Le,backgroundShape:Le,backgroundColor:ve==="transparent"?"#e2e8f0":ve,borderColor:lt==="transparent"?"none":lt,iconColor:Rt,size:"100",outputSize:28})},me=pe=>{const ve=M(pe),Le=T(o.value),lt=B(l.value),Qe=R(i.value),Rt=A(d.value);return Le==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0" stroke="${ve}" stroke-width="2"/>
    </svg>`:Vn({type:Qe!=="none"?Qe:Le,backgroundShape:Le,backgroundColor:lt,borderColor:ve==="transparent"?"none":ve,iconColor:Rt,size:"100",outputSize:28})},Ke=pe=>{const ve=R(pe),Le=T(o.value),lt=B(l.value),Qe=M(c.value),Rt=A(d.value);if(ve==="none"&&Le==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0"/>
      <line x1="8" y1="8" x2="20" y2="20" stroke="#a0aec0" stroke-width="2" stroke-linecap="round"/>
    </svg>`;const tn=Le!=="none"?Le:"circle";return Vn({type:ve!=="none"?ve:tn,backgroundShape:tn,backgroundColor:lt,borderColor:Qe==="transparent"?"none":Qe,iconColor:Rt,size:"100",outputSize:42})},Ve=pe=>{const ve=A(pe),Le=T(o.value),lt=B(l.value),Qe=M(c.value),Rt=R(i.value);return Rt==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${ve==="transparent"?"#e2e8f0":ve}"/>
    </svg>`:Vn({type:Rt,backgroundShape:Le!=="none"?Le:"circle",backgroundColor:lt,borderColor:Qe==="transparent"?"none":Qe,iconColor:ve==="transparent"?"#e2e8f0":ve,size:"100",outputSize:28})},de=pe=>{const ve=G(pe),Le=T(o.value),lt=B(l.value),Qe=M(c.value),Rt=R(i.value),tn=A(d.value);if(Le==="none"&&Rt==="none")return"";const an=Le!=="none"?Le:"circle";return Vn({type:Rt!=="none"?Rt:an,backgroundShape:an,backgroundColor:lt,borderColor:Qe==="transparent"?"none":Qe,iconColor:tn,size:ve})},ke=z(()=>{const pe=T(o.value),ve=B(l.value),Le=M(c.value),lt=R(i.value),Qe=A(d.value),Rt=G(h.value);return pe==="none"&&lt==="none"?"":Vn(pe==="none"&&lt!=="none"?{type:lt,backgroundShape:"none",backgroundColor:ve,borderColor:"none",iconColor:Qe,size:Rt}:{type:lt!=="none"?lt:pe,backgroundShape:pe,backgroundColor:ve,borderColor:Le==="transparent"?"none":Le,iconColor:Qe,size:Rt})}),te=pe=>{m.value=m.value===pe?null:pe},ge=()=>{m.value=null,y.value=!1,k.value=!1,S.value=!1},Fe=pe=>{o.value=pe,ge()},ut=pe=>{l.value=pe,ge()},gt=pe=>{c.value=pe,ge()},xt=pe=>{i.value=pe,ge()},Ct=pe=>{d.value=pe,ge()},Pt=pe=>{h.value=pe,ge()},Wt=pe=>{f.value=pe,ge()},_o=()=>{y.value=!y.value,y.value&&(V.value?x.value=l.value.replace(/^#/,""):x.value="",dn(()=>w.value?.focus()))},cn=()=>{k.value=!k.value,k.value&&(Y.value?E.value=c.value.replace(/^#/,""):E.value="",dn(()=>_.value?.focus()))},ft=()=>{S.value=!S.value,S.value&&(re.value?$.value=d.value.replace(/^#/,""):$.value="",dn(()=>I.value?.focus()))},Dt=()=>{x.value=x.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},$t=()=>{E.value=E.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},In=()=>{$.value=$.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},En=pe=>pe.length===3?pe[0]+pe[0]+pe[1]+pe[1]+pe[2]+pe[2]:pe,wo=()=>{if(!ie.value)return;const pe=En(x.value);l.value="#"+pe,y.value=!1,ge()},Ao=()=>{if(!$e.value)return;const pe=En(E.value);c.value="#"+pe,k.value=!1,ge()},en=()=>{if(!q.value)return;const pe=En($.value);d.value="#"+pe,S.value=!1,ge()},Ma=pe=>{f.value=pe};Ye(()=>n.isOpen,pe=>{if(pe){const ve=n.backgroundShape&&n.backgroundShape!=="default"&&n.backgroundShape!=="circle",Le=n.iconType&&n.iconType!=="none"&&n.iconType!=="default",lt=n.backgroundColor&&n.backgroundColor!=="",Qe=n.borderColor&&n.borderColor!=="",Rt=n.iconColor&&n.iconColor!=="",tn=n.size&&n.size!==""&&n.size!=="100",an=n.mapRotation!==""&&n.mapRotation!==void 0&&n.mapRotation!==null&&n.mapRotation!==0;ve||Le||lt||Qe||Rt||tn||an?(o.value=n.backgroundShape||"default",i.value=n.iconType||"default",l.value=n.backgroundColor||"default",c.value=n.borderColor||"default",d.value=n.iconColor||"default",h.value=n.size||"default",f.value=n.mapRotation!==""&&n.mapRotation!==void 0&&n.mapRotation!==null?n.mapRotation:"default"):(o.value="default",i.value="default",l.value="default",c.value="default",d.value="default",h.value="default",f.value="default"),m.value=null}});const On=()=>{ge(),a("update:isOpen",!1),a("cancel")},Go=()=>{ge();const pe=lt=>lt==="default"?"":lt;let ve="";i.value==="none"?ve="none":i.value&&i.value!=="default"&&(ve=i.value);let Le="";f.value!=="default"&&f.value!==""&&f.value!==void 0&&(Le=parseInt(f.value,10)||0),a("apply",{iconType:ve,backgroundShape:pe(o.value),backgroundColor:pe(l.value),borderColor:pe(c.value),iconColor:pe(d.value),size:pe(h.value),mapRotation:Le}),a("update:isOpen",!1)};return(pe,ve)=>e.isOpen?(p(),g("div",{key:0,class:"modal-overlay",onClick:ct(On,["self"])},[r("div",rT,[r("div",{class:"modal-header"},[ve[18]||(ve[18]=r("h3",null,"Customise marker style",-1)),r("button",{class:"close-btn",onClick:On},"")]),r("div",cT,[r("div",uT,[r("div",dT,[ve[19]||(ve[19]=r("div",{class:"map-background"},null,-1)),r("div",{class:"preview-icon",style:nt({transform:`rotate(${F(f.value)}deg)`}),innerHTML:ke.value},null,12,hT)])]),r("div",fT,[r("button",{type:"button",class:le(["option-button",{active:m.value==="shape"}]),onClick:ve[0]||(ve[0]=Le=>te("shape"))},[r("div",pT,[ve[20]||(ve[20]=r("span",{class:"option-button-label"},"Shape",-1)),r("div",vT,[r("div",{class:"icon-preview-small",innerHTML:ye(o.value)},null,8,mT),r("span",null,b(X(o.value)),1)])]),ve[21]||(ve[21]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button",{active:m.value==="bgColor"}]),onClick:ve[1]||(ve[1]=Le=>te("bgColor"))},[r("div",gT,[ve[22]||(ve[22]=r("span",{class:"option-button-label"},"Background",-1)),r("div",yT,[r("span",{class:"color-swatch",style:nt({backgroundColor:Q.value})},null,4),r("span",null,b(Ce(l.value)),1)])]),ve[23]||(ve[23]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button",{active:m.value==="borderColor",disabled:!ue.value}]),disabled:!ue.value,onClick:ve[2]||(ve[2]=Le=>te("borderColor"))},[r("div",bT,[ve[24]||(ve[24]=r("span",{class:"option-button-label"},"Border",-1)),r("div",_T,[r("span",{class:le(["color-swatch",{"no-border":c.value==="none"}]),style:nt(c.value!=="none"?{backgroundColor:oe.value}:{})},null,6),r("span",null,b(Ne(c.value)),1)])]),ve[25]||(ve[25]=r("span",{class:"option-button-arrow"},"",-1))],10,kT),r("button",{type:"button",class:le(["option-button",{active:m.value==="icon"}]),onClick:ve[3]||(ve[3]=Le=>te("icon"))},[r("div",wT,[ve[26]||(ve[26]=r("span",{class:"option-button-label"},"Icon",-1)),r("div",CT,[r("div",{class:"icon-preview-small",innerHTML:De(i.value)},null,8,LT),r("span",null,b(ee(i.value)),1)])]),ve[27]||(ve[27]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button",{active:m.value==="iconColor",disabled:!Z.value}]),disabled:!Z.value,onClick:ve[4]||(ve[4]=Le=>te("iconColor"))},[r("div",IT,[ve[28]||(ve[28]=r("span",{class:"option-button-label"},"Colour",-1)),r("div",xT,[r("span",{class:"color-swatch",style:nt({backgroundColor:he.value})},null,4),r("span",null,b(Be(d.value)),1)])]),ve[29]||(ve[29]=r("span",{class:"option-button-arrow"},"",-1))],10,ST),r("button",{type:"button",class:le(["option-button",{active:m.value==="size"}]),onClick:ve[5]||(ve[5]=Le=>te("size"))},[r("div",$T,[ve[30]||(ve[30]=r("span",{class:"option-button-label"},"Size",-1)),r("span",TT,b(Ae(h.value)),1)]),ve[31]||(ve[31]=r("span",{class:"option-button-arrow"},"",-1))],2),r("button",{type:"button",class:le(["option-button option-button-full",{active:m.value==="mapRotation"}]),onClick:ve[6]||(ve[6]=Le=>te("mapRotation"))},[r("div",MT,[ve[32]||(ve[32]=r("span",{class:"option-button-label"},"Map rotation",-1)),r("span",AT,b(ne(f.value)),1)]),ve[33]||(ve[33]=r("span",{class:"option-button-arrow"},"",-1))],2)]),m.value==="shape"?(p(),g("div",ET,[r("div",{class:"popup-header"},[ve[34]||(ve[34]=r("span",null,"Select shape",-1)),r("button",{type:"button",class:"popup-close",onClick:ge},"")]),r("div",PT,[(p(!0),g(xe,null,qe(j.value,Le=>(p(),g("button",{key:Le.value,type:"button",class:le(["popup-grid-item",{selected:o.value===Le.value}]),onClick:lt=>Fe(Le.value)},[r("div",{class:"popup-item-preview",innerHTML:Pe(Le.value)},null,8,RT),Le.showLabel?(p(),g("span",OT,b(Le.label),1)):D("",!0)],10,DT))),128))])])):D("",!0),m.value==="bgColor"?(p(),g("div",BT,[r("div",{class:"popup-header"},[ve[35]||(ve[35]=r("span",null,"Select background",-1)),r("button",{type:"button",class:"popup-close",onClick:ge},"")]),r("div",NT,[(p(!0),g(xe,null,qe(Te.value,Le=>(p(),g("button",{key:Le.hex,type:"button",class:le(["popup-grid-item",{selected:We(Le.hex)}]),title:Le.name,onClick:lt=>ut(Le.hex)},[r("div",{class:"popup-item-preview",innerHTML:Ie(Le.hex)},null,8,UT),Le.showLabel?(p(),g("span",zT,b(Le.name),1)):D("",!0)],10,FT))),128)),r("button",{type:"button",class:le(["popup-grid-item custom-color-option",{selected:V.value}]),style:nt(V.value?{"--custom-color":l.value}:{}),title:"Custom colour",onClick:_o},[r("div",{class:"popup-item-preview custom-color-preview",style:nt(V.value?{backgroundColor:l.value}:{})},[V.value?D("",!0):(p(),g("svg",HT,[...ve[36]||(ve[36]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),V.value?(p(),g("span",VT,"")):D("",!0)],4),ve[37]||(ve[37]=r("span",null,"Custom",-1))],6)]),y.value?(p(),g("div",GT,[ve[39]||(ve[39]=r("label",null,"Enter hex code",-1)),r("div",qT,[ve[38]||(ve[38]=r("span",{class:"hex-prefix"},"#",-1)),Ge(r("input",{ref_key:"bgHexInput",ref:w,"onUpdate:modelValue":ve[7]||(ve[7]=Le=>x.value=Le),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:x.value&&!ie.value}]),onInput:Dt,onKeydown:ya(wo,["enter"])},null,34),[[st,x.value]]),r("div",{class:"hex-preview",style:nt({backgroundColor:ie.value?"#"+x.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!ie.value,onClick:wo}," Apply ",8,jT)]),x.value&&!ie.value?(p(),g("span",WT," Invalid hex code ")):D("",!0)])):D("",!0)])):D("",!0),m.value==="borderColor"?(p(),g("div",ZT,[r("div",{class:"popup-header"},[ve[40]||(ve[40]=r("span",null,"Select border",-1)),r("button",{type:"button",class:"popup-close",onClick:ge},"")]),r("div",KT,[(p(!0),g(xe,null,qe(je.value,Le=>(p(),g("button",{key:Le.hex,type:"button",class:le(["popup-grid-item",{selected:c.value===Le.hex}]),title:Le.name,onClick:lt=>gt(Le.hex)},[r("div",{class:"popup-item-preview",innerHTML:me(Le.hex)},null,8,JT),Le.showLabel?(p(),g("span",XT,b(Le.name),1)):D("",!0)],10,YT))),128)),r("button",{type:"button",class:le(["popup-grid-item custom-color-option",{selected:Y.value}]),style:nt(Y.value?{"--custom-color":c.value}:{}),title:"Custom colour",onClick:cn},[r("div",{class:"popup-item-preview custom-color-preview",style:nt(Y.value?{backgroundColor:c.value}:{})},[Y.value?D("",!0):(p(),g("svg",QT,[...ve[41]||(ve[41]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),Y.value?(p(),g("span",eM,"")):D("",!0)],4),ve[42]||(ve[42]=r("span",null,"Custom",-1))],6)]),k.value?(p(),g("div",tM,[ve[44]||(ve[44]=r("label",null,"Enter hex code",-1)),r("div",nM,[ve[43]||(ve[43]=r("span",{class:"hex-prefix"},"#",-1)),Ge(r("input",{ref_key:"borderHexInput",ref:_,"onUpdate:modelValue":ve[8]||(ve[8]=Le=>E.value=Le),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:E.value&&!$e.value}]),onInput:$t,onKeydown:ya(Ao,["enter"])},null,34),[[st,E.value]]),r("div",{class:"hex-preview",style:nt({backgroundColor:$e.value?"#"+E.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!$e.value,onClick:Ao}," Apply ",8,oM)]),E.value&&!$e.value?(p(),g("span",aM," Invalid hex code ")):D("",!0)])):D("",!0)])):D("",!0),m.value==="icon"?(p(),g("div",sM,[r("div",{class:"popup-header"},[ve[45]||(ve[45]=r("span",null,"Select icon",-1)),r("button",{type:"button",class:"popup-close",onClick:ge},"")]),r("div",iM,[(p(!0),g(xe,null,qe(K.value,Le=>(p(),g("button",{key:Le.value,type:"button",class:le(["popup-grid-item",{selected:i.value===Le.value}]),onClick:lt=>xt(Le.value)},[r("div",{class:"popup-item-preview",innerHTML:Ke(Le.value)},null,8,rM),Le.showLabel?(p(),g("span",cM,b(Le.label),1)):D("",!0)],10,lM))),128))])])):D("",!0),m.value==="iconColor"?(p(),g("div",uM,[r("div",{class:"popup-header"},[ve[46]||(ve[46]=r("span",null,"Select colour",-1)),r("button",{type:"button",class:"popup-close",onClick:ge},"")]),r("div",dM,[(p(!0),g(xe,null,qe(He.value,Le=>(p(),g("button",{key:Le.hex,type:"button",class:le(["popup-grid-item",{selected:be(Le.hex)}]),title:Le.name,onClick:lt=>Ct(Le.hex)},[r("div",{class:"popup-item-preview",innerHTML:Ve(Le.hex)},null,8,fM),Le.showLabel?(p(),g("span",pM,b(Le.name),1)):D("",!0)],10,hM))),128)),r("button",{type:"button",class:le(["popup-grid-item custom-color-option",{selected:re.value}]),style:nt(re.value?{"--custom-color":d.value}:{}),title:"Custom colour",onClick:ft},[r("div",{class:"popup-item-preview custom-color-preview",style:nt(re.value?{backgroundColor:d.value}:{})},[re.value?D("",!0):(p(),g("svg",vM,[...ve[47]||(ve[47]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])])),re.value?(p(),g("span",mM,"")):D("",!0)],4),ve[48]||(ve[48]=r("span",null,"Custom",-1))],6)]),S.value?(p(),g("div",gM,[ve[50]||(ve[50]=r("label",null,"Enter hex code",-1)),r("div",yM,[ve[49]||(ve[49]=r("span",{class:"hex-prefix"},"#",-1)),Ge(r("input",{ref_key:"iconHexInput",ref:I,"onUpdate:modelValue":ve[9]||(ve[9]=Le=>$.value=Le),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:$.value&&!q.value}]),onInput:In,onKeydown:ya(en,["enter"])},null,34),[[st,$.value]]),r("div",{class:"hex-preview",style:nt({backgroundColor:q.value?"#"+$.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!q.value,onClick:en}," Apply ",8,kM)]),$.value&&!q.value?(p(),g("span",bM," Invalid hex code ")):D("",!0)])):D("",!0)])):D("",!0),m.value==="size"?(p(),g("div",_M,[r("div",{class:"popup-header"},[ve[51]||(ve[51]=r("span",null,"Select size",-1)),r("button",{type:"button",class:"popup-close",onClick:ge},"")]),r("div",wM,[(p(!0),g(xe,null,qe(J.value,Le=>(p(),g("button",{key:Le.value,type:"button",class:le(["size-grid-item",{selected:h.value===Le.value}]),onClick:lt=>Pt(Le.value)},[r("div",{class:"size-preview",innerHTML:de(Le.value)},null,8,LM),r("span",null,b(Le.label),1)],10,CM))),128))])])):D("",!0),m.value==="mapRotation"?(p(),g("div",SM,[r("div",{class:"popup-header"},[ve[52]||(ve[52]=r("span",null,"Set map rotation",-1)),r("button",{type:"button",class:"popup-close",onClick:ge},"")]),r("div",IM,[r("div",xM,[r("div",{class:"rotation-preview-icon",style:nt({transform:`rotate(${F(f.value)}deg)`}),innerHTML:ke.value},null,12,$M)]),ve[53]||(ve[53]=r("p",{class:"rotation-description"}," Rotate the marker on the map. This rotation is added to any map rotation. ",-1)),r("div",TM,[r("button",{type:"button",class:le(["rotation-preset",{selected:f.value==="default"||f.value===""}]),onClick:ve[10]||(ve[10]=Le=>Wt("default"))}," Default ",2),r("div",MM,[r("input",{type:"range",min:"-180",max:"180",step:"5",class:"rotation-slider",value:f.value==="default"||f.value===""?0:f.value,onInput:ve[11]||(ve[11]=Le=>Ma(parseInt(Le.target.value,10)))},null,40,AM),r("div",EM,b(f.value==="default"||f.value===""?"0":f.value)+" ",1)])]),r("div",PM,[r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===-90}]),onClick:ve[12]||(ve[12]=Le=>Wt(-90))},"-90",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===-45}]),onClick:ve[13]||(ve[13]=Le=>Wt(-45))},"-45",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===0}]),onClick:ve[14]||(ve[14]=Le=>Wt(0))},"0",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===45}]),onClick:ve[15]||(ve[15]=Le=>Wt(45))},"+45",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===90}]),onClick:ve[16]||(ve[16]=Le=>Wt(90))},"+90",2),r("button",{type:"button",class:le(["rotation-preset-btn",{selected:f.value===180}]),onClick:ve[17]||(ve[17]=Le=>Wt(180))},"180",2)])])])):D("",!0)]),r("div",{class:"modal-footer"},[r("button",{type:"button",class:"btn-cancel",onClick:On},"Cancel"),r("button",{type:"button",class:"btn-apply",onClick:Go},"Apply")])])])):D("",!0)}},OM=Ze(RM,[["__scopeId","data-v-bbab1a46"]]),BM={class:"checkpoint-style-picker"},NM={class:"form-group"},FM={class:"style-options"},UM=["innerHTML"],zM={class:"option-label"},HM=["innerHTML"],VM="#667eea",GM={__name:"CheckpointStylePicker",props:{styleType:{type:String,default:"default"},styleColor:{type:String,default:""},styleBackgroundShape:{type:String,default:""},styleBackgroundColor:{type:String,default:""},styleBorderColor:{type:String,default:""},styleIconColor:{type:String,default:""},styleSize:{type:String,default:""},styleMapRotation:{type:[String,Number],default:""},iconLabel:{type:String,default:"Marker style"},showPreview:{type:Boolean,default:!0},inheritedStyleType:{type:String,default:"default"},inheritedStyleColor:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""},defaultLabel:{type:String,default:"Default"},level:{type:String,default:"checkpoint"}},emits:["update:styleType","update:styleColor","update:styleBackgroundShape","update:styleBackgroundColor","update:styleBorderColor","update:styleIconColor","update:styleSize","update:styleMapRotation","change"],setup(e,{emit:t}){const n=e,a=t,o=P(n.styleType),i=P(n.styleColor||""),l=P(n.styleBackgroundShape||"default"),c=P(n.styleBackgroundColor||""),d=P(n.styleBorderColor||""),h=P(n.styleIconColor||""),f=P(n.styleSize||"default"),m=P(n.styleMapRotation||""),y=F=>!F||F==="default"?!1:il(F).category==="content",k=P(n.styleType&&n.styleType!=="default"&&n.styleType!=="custom"&&y(n.styleType)?n.styleType:"default"),S=P(!1),x=z(()=>!!(o.value&&o.value!=="default"||l.value&&l.value!=="default"&&l.value!=="circle"||c.value||d.value||h.value||f.value&&f.value!=="default"&&f.value!=="100")),E=F=>F&&F!==""&&F!=="default",$=F=>F&&F.startsWith("#"),w=z(()=>{const j=E(n.inheritedStyleType),K=E(n.inheritedBackgroundShape),J=$(n.inheritedBackgroundColor)||$(n.inheritedStyleColor),ue=$(n.inheritedBorderColor),Z=$(n.inheritedIconColor),se=E(n.inheritedSize);if(j||K||J||ue||Z||se){const Q=j?n.inheritedStyleType:K?n.inheritedBackgroundShape:"circle",oe=($(n.inheritedBackgroundColor)?n.inheritedBackgroundColor:null)||($(n.inheritedStyleColor)?n.inheritedStyleColor:null)||VM;return Vn({type:Q,backgroundShape:n.inheritedBackgroundShape||"circle",backgroundColor:oe,borderColor:n.inheritedBorderColor||"#ffffff",iconColor:n.inheritedIconColor||"#ffffff",size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#10B981"/>
        <stop offset="50%" style="stop-color:#F59E0B"/>
        <stop offset="100%" style="stop-color:#EF4444"/>
      </linearGradient>
    </defs>
    <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#defaultGradient)" stroke="#fff" stroke-width="1.5"/>
  </svg>`}),_=z(()=>{const F=n.inheritedMapRotation;return F!==""&&F!==void 0&&F!==null&&F!==0?{transform:`rotate(${F}deg)`}:{}}),I=z(()=>{if(m.value!==""&&m.value!==void 0&&m.value!==null){const j=parseInt(m.value,10)||0;if(j!==0)return{transform:`rotate(${j}deg)`}}const F=n.inheritedMapRotation;return F!==""&&F!==void 0&&F!==null&&F!==0?{transform:`rotate(${F}deg)`}:{}}),T=z(()=>{if(x.value){const F=k.value&&k.value!=="none"&&k.value!=="default";let j=null;n.inheritedStyleType&&n.inheritedStyleType!=="default"&&n.inheritedStyleType!=="custom"&&il(n.inheritedStyleType).category==="content"&&(j=n.inheritedStyleType);const K=k.value==="default"&&j,J=F||K,ue=F?k.value:K?j:null,Z=l.value&&l.value!=="default"?l.value:n.inheritedBackgroundShape||"circle",se=J?ue:Z,U=c.value||n.inheritedBackgroundColor||n.inheritedStyleColor||"#667eea",Q=d.value||n.inheritedBorderColor||"#ffffff",oe=h.value||n.inheritedIconColor||"#ffffff";return Vn({type:se,backgroundShape:Z,backgroundColor:U,borderColor:Q,iconColor:oe,size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#e2e8f0" stroke="#cbd5e0" stroke-width="1.5"/>
    <path d="M12 8v8M8 12h8" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
  </svg>`}),B=()=>{o.value="default",k.value="default",a("update:styleType","default"),l.value="default",c.value="",i.value="",d.value="",h.value="",f.value="default",m.value="",a("update:styleBackgroundShape",""),a("update:styleBackgroundColor",""),a("update:styleColor",""),a("update:styleBorderColor",""),a("update:styleIconColor",""),a("update:styleSize",""),a("update:styleMapRotation",""),G()},M=()=>{S.value=!0},R=F=>{F.iconType==="none"?k.value="none":F.iconType?k.value=F.iconType:k.value="default",l.value=F.backgroundShape||"default",c.value=F.backgroundColor||"",d.value=F.borderColor||"",h.value=F.iconColor||"",f.value=F.size||"default",m.value=F.mapRotation??"";const j=F.iconType==="none"||F.iconType&&F.iconType!==""||F.backgroundShape||F.backgroundColor||F.borderColor||F.iconColor||F.size||F.mapRotation!==""&&F.mapRotation!==0;F.iconType&&F.iconType!=="none"?o.value=F.iconType:j?o.value="custom":o.value="default",a("update:styleType",o.value),a("update:styleBackgroundShape",F.backgroundShape),a("update:styleBackgroundColor",F.backgroundColor),a("update:styleBorderColor",F.borderColor),a("update:styleIconColor",F.iconColor),a("update:styleSize",F.size),a("update:styleMapRotation",F.mapRotation??""),G()},A=()=>{},G=()=>{a("change",{styleType:o.value,styleColor:c.value||i.value,styleBackgroundShape:l.value,styleBackgroundColor:c.value,styleBorderColor:d.value,styleIconColor:h.value,styleSize:f.value,styleMapRotation:m.value})};return Ye(()=>n.styleType,F=>{o.value=F,F&&F!=="default"&&F!=="custom"&&y(F)?k.value=F:k.value="default"}),Ye(()=>n.styleColor,F=>{i.value=F||""}),Ye(()=>n.styleBackgroundShape,F=>{l.value=F||"default"}),Ye(()=>n.styleBackgroundColor,F=>{c.value=F||""}),Ye(()=>n.styleBorderColor,F=>{d.value=F||""}),Ye(()=>n.styleIconColor,F=>{h.value=F||""}),Ye(()=>n.styleSize,F=>{f.value=F||"default"}),Ye(()=>n.styleMapRotation,F=>{m.value=F??""}),(F,j)=>(p(),g("div",BM,[r("div",NM,[r("label",null,b(e.iconLabel),1),r("div",FM,[r("button",{type:"button",class:le(["style-option-button",{selected:!x.value}]),onClick:B},[r("div",{class:"option-preview",style:nt(_.value),innerHTML:w.value},null,12,UM),r("span",zM,b(e.defaultLabel),1)],2),r("button",{type:"button",class:le(["style-option-button",{selected:x.value}]),onClick:M},[r("div",{class:"option-preview",style:nt(I.value),innerHTML:T.value},null,12,HM),j[1]||(j[1]=r("span",{class:"option-label"},"Custom",-1))],2)])]),Ee(OM,{isOpen:S.value,"onUpdate:isOpen":j[0]||(j[0]=K=>S.value=K),"icon-type":k.value,"background-shape":l.value,"background-color":c.value,"border-color":d.value,"icon-color":h.value,size:f.value,"map-rotation":m.value,level:e.level,"inherited-type":e.inheritedStyleType,"inherited-background-shape":e.inheritedBackgroundShape,"inherited-background-color":e.inheritedBackgroundColor||e.inheritedStyleColor,"inherited-border-color":e.inheritedBorderColor,"inherited-icon-color":e.inheritedIconColor,"inherited-size":e.inheritedSize,"inherited-map-rotation":e.inheritedMapRotation,onApply:R,onCancel:A},null,8,["isOpen","icon-type","background-shape","background-color","border-color","icon-color","size","map-rotation","level","inherited-type","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])]))}},Bf=Ze(GM,[["__scopeId","data-v-c066da64"]]),qM={class:"logo-uploader"},jM={key:0,class:"logo-preview"},WM=["src"],ZM=["disabled"],KM={key:0,class:"upload-progress"},YM={key:1,class:"upload-prompt"},JM={key:2,class:"error-message"},Bv=5*1024*1024,XM={__name:"LogoUploader",props:{modelValue:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0},staged:{type:Boolean,default:!1}},emits:["update:modelValue","staged-change"],setup(e,{expose:t,emit:n}){const a=Z=>Z?Z.startsWith("/api")?ai+Z.substring(4):Z:"",o=e;function i(){const Z={},se=localStorage.getItem("adminEmail");se&&(Z["X-Admin-Email"]=se);const U=localStorage.getItem("sessionToken");return U&&(Z.Authorization=`Bearer ${U}`),Z}const l=n;function c(){l("staged-change",{hasPendingChanges:k.value!==null||x.value,isPendingDelete:x.value,displayUrl:S.value||(x.value?"":o.modelValue)||""})}const d=P(null),h=P(!1),f=P(!1),m=P(""),y=P(Date.now()),k=P(null),S=P(""),x=P(!1),E=z(()=>{if(o.staged){if(S.value)return!0;if(x.value)return!1}return!!o.modelValue}),$=z(()=>{if(o.staged&&x.value)return"";if(o.staged&&S.value)return S.value;if(!o.modelValue)return"";const Z=a(o.modelValue),se=Z.includes("?")?"&":"?";return`${Z}${se}_t=${y.value}`});function w(){S.value&&(URL.revokeObjectURL(S.value),S.value="")}An(()=>{w()});const _=["image/png","image/jpeg","image/svg+xml","image/gif","image/webp"];function I(){h.value||d.value?.click()}function T(Z){const se=Z.target.files?.[0];se&&M(se),d.value&&(d.value.value="")}function B(Z){f.value=!1;const se=Z.dataTransfer?.files?.[0];se&&M(se)}async function M(Z){if(m.value="",!_.includes(Z.type)){m.value="Invalid file type. Please use PNG, JPEG, SVG, GIF, or WebP.";return}if(Z.size>Bv){m.value=`File too large. Maximum size is ${Bv/(1024*1024)}MB.`;return}if(o.staged){w(),k.value=Z,S.value=URL.createObjectURL(Z),x.value=!1,c();return}h.value=!0;try{const se=await fetch(`${ai}/events/${o.eventId}/logo`,{method:"POST",headers:{"Content-Type":Z.type,...i()},body:Z});if(!se.ok){const Q=await se.text().catch(()=>"");let oe=`Upload failed (${se.status})`;try{oe=JSON.parse(Q).message||oe}catch{Q&&(oe=Q)}throw new Error(oe)}const U=await se.json();y.value=Date.now(),l("update:modelValue",U.logoUrl)}catch(se){console.error("Logo upload error:",se),se.name==="TypeError"&&se.message==="Failed to fetch"?m.value="Network error. Check your connection or try a smaller file.":se.message?.includes("401")||se.message?.includes("403")?m.value="Not authorized. Please refresh the page and try again.":m.value=se.message||"Failed to upload logo. Please try again."}finally{h.value=!1}}async function R(){if(m.value="",o.staged){k.value?(w(),k.value=null):o.modelValue&&(x.value=!0),c();return}h.value=!0;try{const Z=await fetch(`${ai}/events/${o.eventId}/logo`,{method:"DELETE",headers:i()});if(!Z.ok){const se=await Z.json().catch(()=>({}));throw new Error(se.message||"Delete failed")}l("update:modelValue","")}catch(Z){console.error("Logo delete error:",Z),m.value=Z.message||"Failed to remove logo. Please try again."}finally{h.value=!1}}async function A(){if(!k.value)return{success:!0,logoUrl:x.value?"":o.modelValue};h.value=!0,m.value="";try{const Z=await fetch(`${ai}/events/${o.eventId}/logo`,{method:"POST",headers:{"Content-Type":k.value.type,...i()},body:k.value});if(!Z.ok){const U=await Z.text().catch(()=>"");let Q=`Upload failed (${Z.status})`;try{Q=JSON.parse(U).message||Q}catch{U&&(Q=U)}throw new Error(Q)}const se=await Z.json();return y.value=Date.now(),w(),k.value=null,x.value=!1,{success:!0,logoUrl:se.logoUrl}}catch(Z){return console.error("Logo upload error:",Z),m.value=Z.message||"Failed to upload logo. Please try again.",{success:!1,error:Z.message}}finally{h.value=!1}}async function G(){if(!x.value)return{success:!0};h.value=!0,m.value="";try{const Z=await fetch(`${ai}/events/${o.eventId}/logo`,{method:"DELETE",headers:i()});if(!Z.ok){const se=await Z.json().catch(()=>({}));throw new Error(se.message||"Delete failed")}return x.value=!1,{success:!0}}catch(Z){return console.error("Logo delete error:",Z),m.value=Z.message||"Failed to remove logo. Please try again.",{success:!1,error:Z.message}}finally{h.value=!1}}function F(){return k.value!==null||x.value}function j(){return k.value}function K(){return x.value}function J(){return S.value?S.value:x.value?"":a(o.modelValue)||""}function ue(){w(),k.value=null,x.value=!1}return t({uploadStagedFile:A,deleteStagedLogo:G,hasPendingChanges:F,getStagedFile:j,isPendingDelete:K,getDisplayUrl:J,resetStagedState:ue}),(Z,se)=>(p(),g("div",qM,[se[4]||(se[4]=r("label",{class:"uploader-label"},"Event Logo",-1)),E.value?(p(),g("div",jM,[r("img",{src:$.value,alt:"Event logo",class:"logo-image"},null,8,WM),r("button",{type:"button",class:"remove-btn",onClick:R,disabled:h.value}," Remove ",8,ZM)])):(p(),g("div",{key:1,class:le(["upload-area",{"drag-over":f.value,uploading:h.value}]),onDragover:se[0]||(se[0]=ct(U=>f.value=!0,["prevent"])),onDragleave:se[1]||(se[1]=ct(U=>f.value=!1,["prevent"])),onDrop:ct(B,["prevent"]),onClick:I},[r("input",{ref_key:"fileInput",ref:d,type:"file",accept:"image/png,image/jpeg,image/svg+xml,image/gif,image/webp",class:"file-input",onChange:T},null,544),h.value?(p(),g("div",KM,[...se[2]||(se[2]=[r("div",{class:"spinner"},null,-1),r("span",null,"Uploading...",-1)])])):(p(),g("div",YM,[...se[3]||(se[3]=[r("div",{class:"upload-icon"},"+",-1),r("span",{class:"upload-text"},"Click or drag to upload logo",-1),r("span",{class:"upload-hint"},"PNG, JPEG, SVG, GIF, WebP (max 5MB)",-1)])]))],34)),m.value?(p(),g("div",JM,b(m.value),1)):D("",!0)]))}},QM=Ze(XM,[["__scopeId","data-v-bfb1b332"]]),h1=[{name:"Default",headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},{name:"Wasp",headerGradientStart:"#333333",headerGradientEnd:"#333333",accentColor:"#FFD700",pageGradientStart:"#FFD700",pageGradientEnd:"#333333"},{name:"Ocean",headerGradientStart:"#0077be",headerGradientEnd:"#00a8e8",accentColor:"#0077be",pageGradientStart:"#0077be",pageGradientEnd:"#00a8e8"},{name:"Forest",headerGradientStart:"#228b22",headerGradientEnd:"#32cd32",accentColor:"#228b22",pageGradientStart:"#228b22",pageGradientEnd:"#32cd32"},{name:"Sunset",headerGradientStart:"#ff6b35",headerGradientEnd:"#f7931e",accentColor:"#ff6b35",pageGradientStart:"#ff6b35",pageGradientEnd:"#f7931e"},{name:"Berry",headerGradientStart:"#8e2de2",headerGradientEnd:"#4a00e0",accentColor:"#8e2de2",pageGradientStart:"#8e2de2",pageGradientEnd:"#4a00e0"},{name:"Coral",headerGradientStart:"#ff758c",headerGradientEnd:"#ff7eb3",accentColor:"#ff758c",pageGradientStart:"#ff758c",pageGradientEnd:"#ff7eb3"},{name:"Steel",headerGradientStart:"#485563",headerGradientEnd:"#29323c",accentColor:"#485563",pageGradientStart:"#485563",pageGradientEnd:"#29323c"},{name:"Mint",headerGradientStart:"#11998e",headerGradientEnd:"#38ef7d",accentColor:"#11998e",pageGradientStart:"#11998e",pageGradientEnd:"#38ef7d"},{name:"Cherry",headerGradientStart:"#eb3349",headerGradientEnd:"#f45c43",accentColor:"#eb3349",pageGradientStart:"#eb3349",pageGradientEnd:"#f45c43"},{name:"Midnight",headerGradientStart:"#232526",headerGradientEnd:"#414345",accentColor:"#5c5c5c",pageGradientStart:"#232526",pageGradientEnd:"#414345"},{name:"Lavender",headerGradientStart:"#a18cd1",headerGradientEnd:"#fbc2eb",accentColor:"#a18cd1",pageGradientStart:"#a18cd1",pageGradientEnd:"#fbc2eb"},{name:"Gold",headerGradientStart:"#f7971e",headerGradientEnd:"#ffd200",accentColor:"#f7971e",pageGradientStart:"#f7971e",pageGradientEnd:"#ffd200"}];function eA(){return{...h1[0]}}function tA(e,t){return{...e,headerGradientStart:t.headerGradientStart,headerGradientEnd:t.headerGradientEnd,accentColor:t.accentColor,pageGradientStart:t.pageGradientStart,pageGradientEnd:t.pageGradientEnd,logoUrl:e.logoUrl||"",logoPosition:e.logoPosition||""}}function tf(e){const t=e.replace("#",""),n=parseInt(t.slice(0,2),16)/255,a=parseInt(t.slice(2,4),16)/255,o=parseInt(t.slice(4,6),16)/255,i=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4),l=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),c=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4);return .2126*i+.7152*l+.0722*c}function nf(e){return!e||e===""?"#ffffff":tf(e)>.179?"#333333":"#ffffff"}function f1(e,t){const n=e||Sn.headerGradientStart,a=t||Sn.headerGradientEnd,o=tf(n),i=tf(a);return(o+i)/2>.35?"#333333":"#ffffff"}const Sn={headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},nA={class:"marshal-mockup-container"},oA={class:"presets-section"},aA={class:"presets-row"},sA=["title","onClick"],iA={class:"preset-name"},lA={class:"mockup-frame"},rA={key:0,class:"logo-cover-bg"},cA=["src"],uA=["src"],dA={class:"header-center"},hA={class:"event-name"},fA={class:"mockup-buttons"},pA=["src"],vA={class:"mockup-body"},mA={class:"mockup-card"},gA={class:"card-content"},yA={class:"editor-header"},kA={class:"editor-content"},bA={class:"color-grid-inline"},_A={class:"color-field"},wA={class:"color-swatches"},CA=["title","onClick"],LA={key:0,class:"check"},SA={class:"custom-color-wrapper"},IA={class:"hex-popup-header"},xA={class:"hex-input-row"},$A=["disabled"],TA={key:0,class:"hex-error"},MA={class:"gradient-toggle"},AA={key:0,class:"color-field"},EA={class:"color-swatches"},PA=["title","onClick"],DA={key:0,class:"check"},RA={class:"custom-color-wrapper"},OA={class:"hex-popup-header"},BA={class:"hex-input-row"},NA=["disabled"],FA={key:0,class:"hex-error"},UA={key:1,class:"logo-position-section"},zA={class:"position-buttons"},HA={class:"color-swatches"},VA=["title","onClick"],GA={key:0,class:"check"},qA={class:"custom-color-wrapper"},jA={class:"hex-popup-header"},WA={class:"hex-input-row"},ZA=["disabled"],KA={key:0,class:"hex-error"},YA={class:"color-grid-inline"},JA={class:"color-field"},XA={class:"color-swatches"},QA=["title","onClick"],eE={key:0,class:"check"},tE={class:"custom-color-wrapper"},nE={class:"hex-popup-header"},oE={class:"hex-input-row"},aE=["disabled"],sE={key:0,class:"hex-error"},iE={class:"gradient-toggle"},lE={key:0,class:"color-field"},rE={class:"color-swatches"},cE=["title","onClick"],uE={key:0,class:"check"},dE={class:"custom-color-wrapper"},hE={class:"hex-popup-header"},fE={class:"hex-input-row"},pE=["disabled"],vE={key:0,class:"hex-error"},mE={class:"editor-footer"},gE={__name:"MarshalModeMockup",props:{branding:{type:Object,required:!0},eventName:{type:String,default:""},eventDate:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:branding","logo-staged-change"],setup(e,{expose:t,emit:n}){const a=Ae=>Ae?Ae.startsWith("/api")?ai+Ae.substring(4):Ae:"",o=Kn,i=e,l=n,c=P(null),d=h1,h=P(!1),f=P(!1),m=P(null),y=P(!1),k=P(""),S=Ae=>{typeof Ae=="object"&&Ae!==null?(y.value=Ae.isPendingDelete,k.value=Ae.displayUrl||"",l("logo-staged-change",Ae.hasPendingChanges)):(m.value&&(y.value=m.value.isPendingDelete(),k.value=m.value.getDisplayUrl()||""),l("logo-staged-change",!!Ae))},x=P(null),E=P(""),$=P(null),w=P(null),_=P({left:"50%",right:"auto",transform:"translateX(-50%)"}),I=Ae=>Ae?!o.some(ne=>ne.hex.toLowerCase()===Ae.toLowerCase()):!1,T=Ae=>!Ae||!I(Ae)?"#666666":nf(Ae),B=Ae=>!Ae||!I(Ae)?"#e0e0e0":Ae,M=z(()=>{if(!E.value)return!1;const Ae=E.value.replace(/^#/,"");return/^[0-9A-Fa-f]{6}$/.test(Ae)||/^[0-9A-Fa-f]{3}$/.test(Ae)}),R=(Ae,ne)=>{if(x.value===Ae)x.value=null;else{x.value=Ae;let ye="";switch(Ae){case"headerStart":ye=i.branding.headerGradientStart;break;case"headerEnd":ye=i.branding.headerGradientEnd;break;case"pageStart":ye=i.branding.pageGradientStart;break;case"pageEnd":ye=i.branding.pageGradientEnd;break;case"accent":ye=i.branding.accentColor;break}if(ye&&I(ye)?E.value=ye.replace(/^#/,""):E.value="",ne&&w.value){const De=ne.currentTarget,Pe=w.value,Ie=De.getBoundingClientRect(),me=Pe.getBoundingClientRect(),Ke=220,Ve=12,de=Ie.left+Ie.width/2-me.left,ke=me.width,te=de-Ke/2;de+Ke/2>ke-Ve?_.value={left:"auto",right:"0",transform:"none"}:te<Ve?_.value={left:"0",right:"auto",transform:"none"}:_.value={left:"50%",right:"auto",transform:"translateX(-50%)"}}dn(()=>$.value?.focus())}},A=()=>{E.value=E.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase()},G=()=>{if(!M.value||!x.value)return;let Ae=E.value;Ae.length===3&&(Ae=Ae[0]+Ae[0]+Ae[1]+Ae[1]+Ae[2]+Ae[2]);const ne="#"+Ae;switch(x.value){case"headerStart":Y("start",ne);break;case"headerEnd":V("headerGradientEnd",ne);break;case"pageStart":re("start",ne);break;case"pageEnd":V("pageGradientEnd",ne);break;case"accent":V("accentColor",ne);break}x.value=null};Ye(c,Ae=>{if(x.value=null,E.value="",Ae==="header"){const ne=i.branding.headerGradientStart||Sn.headerGradientStart,ye=i.branding.headerGradientEnd||Sn.headerGradientEnd;h.value=ne!==ye}else if(Ae==="page"){const ne=i.branding.pageGradientStart||Sn.pageGradientStart,ye=i.branding.pageGradientEnd||Sn.pageGradientEnd;f.value=ne!==ye}});const F={header:"Header colour",logo:"Event logo",accent:"Accent colour",page:"Page background"},j=z(()=>i.branding.headerGradientStart||Sn.headerGradientStart),K=z(()=>i.branding.headerGradientEnd||Sn.headerGradientEnd),J=z(()=>i.branding.accentColor||Sn.accentColor),ue=z(()=>i.branding.pageGradientStart||Sn.pageGradientStart),Z=z(()=>i.branding.pageGradientEnd||Sn.pageGradientEnd),se=z(()=>i.branding.logoPosition||"left"),U=P(Date.now());Ye(()=>i.branding.logoUrl,()=>{U.value=Date.now(),y.value=!1,k.value=""});const Q=z(()=>y.value?!1:!!(k.value||i.branding.logoUrl)),oe=z(()=>{if(y.value)return"";if(k.value){if(k.value.startsWith("blob:"))return k.value;const ye=a(k.value),De=ye.includes("?")?"&":"?";return`${ye}${De}_t=${U.value}`}if(!i.branding.logoUrl)return"";const Ae=a(i.branding.logoUrl),ne=Ae.includes("?")?"&":"?";return`${Ae}${ne}_t=${U.value}`}),he=z(()=>({background:`linear-gradient(135deg, ${j.value} 0%, ${K.value} 100%)`})),Te=z(()=>f1(j.value,K.value)),je=z(()=>({background:J.value,color:nf(J.value)})),He=z(()=>({background:`linear-gradient(135deg, ${ue.value} 0%, ${Z.value} 100%)`}));function We(Ae){c.value=c.value===Ae?null:Ae}function be(Ae){!Q.value&&Ae&&V("logoPosition",Ae),We("logo")}function V(Ae,ne){l("update:branding",{...i.branding,[Ae]:ne})}function Y(Ae,ne){h.value?V("headerGradientStart",ne):l("update:branding",{...i.branding,headerGradientStart:ne,headerGradientEnd:ne})}function re(Ae,ne){f.value?V("pageGradientStart",ne):l("update:branding",{...i.branding,pageGradientStart:ne,pageGradientEnd:ne})}function ie(){if(!h.value){const Ae=i.branding.headerGradientStart||Sn.headerGradientStart;V("headerGradientEnd",Ae)}}function $e(){if(!f.value){const Ae=i.branding.pageGradientStart||Sn.pageGradientStart;V("pageGradientEnd",Ae)}}function q(Ae){l("update:branding",tA(i.branding,Ae)),c.value=null}async function X(){return m.value?await m.value.uploadStagedFile():{success:!0,logoUrl:i.branding.logoUrl}}async function ee(){return m.value?await m.value.deleteStagedLogo():{success:!0}}function Ce(){return m.value?.hasPendingChanges()||!1}function Ne(){return m.value?.isPendingDelete()||!1}function Be(){m.value&&m.value.resetStagedState(),y.value=!1,k.value=""}return t({uploadStagedLogo:X,deleteStagedLogo:ee,hasLogoChanges:Ce,isLogoPendingDelete:Ne,resetLogo:Be}),(Ae,ne)=>(p(),g("div",nA,[r("div",oA,[ne[32]||(ne[32]=r("span",{class:"presets-label"},"Quick themes:",-1)),r("div",aA,[(p(!0),g(xe,null,qe(N(d),ye=>(p(),g("button",{key:ye.name,type:"button",class:"preset-btn",title:ye.name,onClick:De=>q(ye)},[r("span",{class:"preset-preview",style:nt({background:`linear-gradient(135deg, ${ye.pageGradientStart} 0%, ${ye.pageGradientEnd} 100%)`})},null,4),r("span",iA,b(ye.name),1)],8,sA))),128))])]),r("div",lA,[r("div",{class:le(["mockup-page",{"region-active":c.value==="page"}]),style:nt(He.value),onClick:ne[7]||(ne[7]=ye=>We("page"))},[r("div",{class:le(["mockup-header",[{"region-active":c.value==="header"},Q.value?`logo-${se.value}`:"logo-none"]]),style:nt(he.value),onClick:ne[5]||(ne[5]=ct(ye=>We("header"),["stop"]))},[Q.value&&se.value==="cover"?(p(),g("div",rA,[r("img",{src:oe.value,alt:"Logo",class:"logo-cover-img"},null,8,cA)])):D("",!0),Q.value&&se.value==="cover"?(p(),g("button",{key:1,type:"button",class:le(["logo-cover-edit-btn",{"region-active":c.value==="logo"}]),onClick:ne[0]||(ne[0]=ct(ye=>We("logo"),["stop"])),title:"Edit logo"},[...ne[33]||(ne[33]=[r("span",null,"",-1)])],2)):D("",!0),Q.value&&se.value==="left"?(p(),g("div",{key:2,class:le(["mockup-logo logo-left",{"region-active":c.value==="logo"}]),onClick:ne[1]||(ne[1]=ct(ye=>We("logo"),["stop"]))},[r("img",{src:oe.value,alt:"Logo",class:"logo-img"},null,8,uA)],2)):D("",!0),Q.value?D("",!0):(p(),g("div",{key:3,class:le(["logo-add-area logo-add-left",{"region-active":c.value==="logo"}]),onClick:ne[2]||(ne[2]=ct(ye=>be("left"),["stop"]))},[...ne[34]||(ne[34]=[r("span",{class:"logo-add-text"},"+ Logo",-1)])],2)),r("div",dA,[r("div",{class:"mockup-title",style:nt({color:Te.value})},[r("span",hA,b(e.eventName||"Event Name"),1)],4),r("div",{class:"mockup-date",style:nt({color:Te.value})},b(e.eventDate||"Event Date"),5),r("div",fA,[ne[35]||(ne[35]=r("span",{class:"btn-emergency"},"Emergency",-1)),r("span",{class:"btn-logout",style:nt({color:Te.value})},"Logout",4)])]),Q.value&&se.value==="right"?(p(),g("div",{key:4,class:le(["mockup-logo logo-right",{"region-active":c.value==="logo"}]),onClick:ne[3]||(ne[3]=ct(ye=>We("logo"),["stop"]))},[r("img",{src:oe.value,alt:"Logo",class:"logo-img"},null,8,pA)],2)):D("",!0),Q.value?D("",!0):(p(),g("div",{key:5,class:le(["logo-add-area logo-add-right",{"region-active":c.value==="logo"}]),onClick:ne[4]||(ne[4]=ct(ye=>be("right"),["stop"]))},[...ne[36]||(ne[36]=[r("span",{class:"logo-add-text"},"+ Logo",-1)])],2))],6),r("div",vA,[r("div",mA,[ne[37]||(ne[37]=r("div",{class:"card-header"},"Your checkpoints (2)",-1)),r("div",gA,[r("div",{class:le(["mockup-checkin-btn",{"region-active":c.value==="accent"}]),style:nt(je.value),onClick:ne[6]||(ne[6]=ct(ye=>We("accent"),["stop"]))}," GPS Check-In ",6)])])])],6)]),Ge(r("div",{class:"editor-overlay",onClick:ne[31]||(ne[31]=ct(ye=>c.value=null,["self"]))},[r("div",{ref_key:"editorModalRef",ref:w,class:"editor-modal"},[r("div",yA,[r("span",null,b(F[c.value]),1),r("button",{type:"button",class:"editor-close",onClick:ne[8]||(ne[8]=ye=>c.value=null)},"")]),r("div",kA,[c.value==="header"?(p(),g(xe,{key:0},[ne[46]||(ne[46]=r("p",{class:"editor-description"},"Choose the colour for the header.",-1)),r("div",bA,[r("div",_A,[r("label",null,b(h.value?"Start colour":"Colour"),1),r("div",wA,[(p(!0),g(xe,null,qe(N(o),ye=>(p(),g("button",{key:"hs-"+ye.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.headerGradientStart===ye.hex}]),style:nt({backgroundColor:ye.hex}),title:ye.name,onClick:De=>Y("start",ye.hex)},[e.branding.headerGradientStart===ye.hex?(p(),g("span",LA,"")):D("",!0)],14,CA))),128)),r("div",SA,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:I(e.branding.headerGradientStart)}]),style:nt({backgroundColor:B(e.branding.headerGradientStart)}),title:"Custom colour",onClick:ne[9]||(ne[9]=ye=>R("headerStart",ye))},[(p(),g("svg",{class:"custom-icon",style:nt({color:T(e.branding.headerGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...ne[38]||(ne[38]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="headerStart"?(p(),g("div",{key:0,class:"custom-hex-popup",style:nt(_.value)},[r("div",IA,[ne[39]||(ne[39]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:ne[10]||(ne[10]=ye=>x.value=null)},"")]),r("div",xA,[ne[40]||(ne[40]=r("span",{class:"hex-prefix"},"#",-1)),Ge(r("input",{ref_key:"hexInputRef",ref:$,"onUpdate:modelValue":ne[11]||(ne[11]=ye=>E.value=ye),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:E.value&&!M.value}]),onInput:A,onKeydown:ya(G,["enter"])},null,34),[[st,E.value]]),r("div",{class:"hex-preview",style:nt({backgroundColor:M.value?"#"+E.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!M.value,onClick:G}," Apply ",8,$A)]),E.value&&!M.value?(p(),g("span",TA,"Invalid hex code")):D("",!0)],4)):D("",!0)])]),r("label",MA,[Ge(r("input",{type:"checkbox","onUpdate:modelValue":ne[12]||(ne[12]=ye=>h.value=ye),onChange:ie},null,544),[[xa,h.value]]),ne[41]||(ne[41]=r("span",null,"Use gradient",-1))])]),h.value?(p(),g("div",AA,[ne[45]||(ne[45]=r("label",null,"End colour",-1)),r("div",EA,[(p(!0),g(xe,null,qe(N(o),ye=>(p(),g("button",{key:"he-"+ye.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.headerGradientEnd===ye.hex}]),style:nt({backgroundColor:ye.hex}),title:ye.name,onClick:De=>V("headerGradientEnd",ye.hex)},[e.branding.headerGradientEnd===ye.hex?(p(),g("span",DA,"")):D("",!0)],14,PA))),128)),r("div",RA,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:I(e.branding.headerGradientEnd)}]),style:nt({backgroundColor:B(e.branding.headerGradientEnd)}),title:"Custom colour",onClick:ne[13]||(ne[13]=ye=>R("headerEnd",ye))},[(p(),g("svg",{class:"custom-icon",style:nt({color:T(e.branding.headerGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...ne[42]||(ne[42]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="headerEnd"?(p(),g("div",{key:0,class:"custom-hex-popup",style:nt(_.value)},[r("div",OA,[ne[43]||(ne[43]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:ne[14]||(ne[14]=ye=>x.value=null)},"")]),r("div",BA,[ne[44]||(ne[44]=r("span",{class:"hex-prefix"},"#",-1)),Ge(r("input",{ref_key:"hexInputRef",ref:$,"onUpdate:modelValue":ne[15]||(ne[15]=ye=>E.value=ye),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:E.value&&!M.value}]),onInput:A,onKeydown:ya(G,["enter"])},null,34),[[st,E.value]]),r("div",{class:"hex-preview",style:nt({backgroundColor:M.value?"#"+E.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!M.value,onClick:G}," Apply ",8,NA)]),E.value&&!M.value?(p(),g("span",FA,"Invalid hex code")):D("",!0)],4)):D("",!0)])])])):D("",!0)])],64)):D("",!0),c.value==="logo"?(p(),g("div",UA,[ne[47]||(ne[47]=r("label",{class:"editor-label"},"Position",-1)),r("div",zA,[r("button",{type:"button",class:le(["position-btn",{selected:se.value==="left"}]),onClick:ne[16]||(ne[16]=ye=>V("logoPosition","left"))}," Left ",2),r("button",{type:"button",class:le(["position-btn",{selected:se.value==="cover"}]),onClick:ne[17]||(ne[17]=ye=>V("logoPosition","cover"))}," Cover ",2),r("button",{type:"button",class:le(["position-btn",{selected:se.value==="right"}]),onClick:ne[18]||(ne[18]=ye=>V("logoPosition","right"))}," Right ",2)])])):D("",!0),Ge(Ee(QM,{ref_key:"logoUploaderRef",ref:m,"model-value":e.branding.logoUrl,"event-id":e.eventId,"admin-email":e.adminEmail,staged:"","onUpdate:modelValue":ne[19]||(ne[19]=ye=>V("logoUrl",ye)),onStagedChange:S},null,8,["model-value","event-id","admin-email"]),[[sa,c.value==="logo"]]),c.value==="accent"?(p(),g(xe,{key:2},[ne[51]||(ne[51]=r("p",{class:"editor-description"},"Choose the accent colour for buttons.",-1)),r("div",HA,[(p(!0),g(xe,null,qe(N(o),ye=>(p(),g("button",{key:"ac-"+ye.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.accentColor===ye.hex}]),style:nt({backgroundColor:ye.hex}),title:ye.name,onClick:De=>V("accentColor",ye.hex)},[e.branding.accentColor===ye.hex?(p(),g("span",GA,"")):D("",!0)],14,VA))),128)),r("div",qA,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:I(e.branding.accentColor)}]),style:nt({backgroundColor:B(e.branding.accentColor)}),title:"Custom colour",onClick:ne[20]||(ne[20]=ye=>R("accent",ye))},[(p(),g("svg",{class:"custom-icon",style:nt({color:T(e.branding.accentColor)}),viewBox:"0 0 24 24",fill:"currentColor"},[...ne[48]||(ne[48]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="accent"?(p(),g("div",{key:0,class:"custom-hex-popup",style:nt(_.value)},[r("div",jA,[ne[49]||(ne[49]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:ne[21]||(ne[21]=ye=>x.value=null)},"")]),r("div",WA,[ne[50]||(ne[50]=r("span",{class:"hex-prefix"},"#",-1)),Ge(r("input",{ref_key:"hexInputRef",ref:$,"onUpdate:modelValue":ne[22]||(ne[22]=ye=>E.value=ye),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:E.value&&!M.value}]),onInput:A,onKeydown:ya(G,["enter"])},null,34),[[st,E.value]]),r("div",{class:"hex-preview",style:nt({backgroundColor:M.value?"#"+E.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!M.value,onClick:G}," Apply ",8,ZA)]),E.value&&!M.value?(p(),g("span",KA,"Invalid hex code")):D("",!0)],4)):D("",!0)])])],64)):D("",!0),c.value==="page"?(p(),g(xe,{key:3},[ne[60]||(ne[60]=r("p",{class:"editor-description"},"Choose the colour for the page background.",-1)),r("div",YA,[r("div",JA,[r("label",null,b(f.value?"Start colour":"Colour"),1),r("div",XA,[(p(!0),g(xe,null,qe(N(o),ye=>(p(),g("button",{key:"ps-"+ye.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.pageGradientStart===ye.hex}]),style:nt({backgroundColor:ye.hex}),title:ye.name,onClick:De=>re("start",ye.hex)},[e.branding.pageGradientStart===ye.hex?(p(),g("span",eE,"")):D("",!0)],14,QA))),128)),r("div",tE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:I(e.branding.pageGradientStart)}]),style:nt({backgroundColor:B(e.branding.pageGradientStart)}),title:"Custom colour",onClick:ne[23]||(ne[23]=ye=>R("pageStart",ye))},[(p(),g("svg",{class:"custom-icon",style:nt({color:T(e.branding.pageGradientStart)}),viewBox:"0 0 24 24",fill:"currentColor"},[...ne[52]||(ne[52]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="pageStart"?(p(),g("div",{key:0,class:"custom-hex-popup",style:nt(_.value)},[r("div",nE,[ne[53]||(ne[53]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:ne[24]||(ne[24]=ye=>x.value=null)},"")]),r("div",oE,[ne[54]||(ne[54]=r("span",{class:"hex-prefix"},"#",-1)),Ge(r("input",{ref_key:"hexInputRef",ref:$,"onUpdate:modelValue":ne[25]||(ne[25]=ye=>E.value=ye),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:E.value&&!M.value}]),onInput:A,onKeydown:ya(G,["enter"])},null,34),[[st,E.value]]),r("div",{class:"hex-preview",style:nt({backgroundColor:M.value?"#"+E.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!M.value,onClick:G}," Apply ",8,aE)]),E.value&&!M.value?(p(),g("span",sE,"Invalid hex code")):D("",!0)],4)):D("",!0)])]),r("label",iE,[Ge(r("input",{type:"checkbox","onUpdate:modelValue":ne[26]||(ne[26]=ye=>f.value=ye),onChange:$e},null,544),[[xa,f.value]]),ne[55]||(ne[55]=r("span",null,"Use gradient",-1))])]),f.value?(p(),g("div",lE,[ne[59]||(ne[59]=r("label",null,"End colour",-1)),r("div",rE,[(p(!0),g(xe,null,qe(N(o),ye=>(p(),g("button",{key:"pe-"+ye.hex,type:"button",class:le(["color-swatch-btn",{selected:e.branding.pageGradientEnd===ye.hex}]),style:nt({backgroundColor:ye.hex}),title:ye.name,onClick:De=>V("pageGradientEnd",ye.hex)},[e.branding.pageGradientEnd===ye.hex?(p(),g("span",uE,"")):D("",!0)],14,cE))),128)),r("div",dE,[r("button",{type:"button",class:le(["color-swatch-btn custom-color-btn",{selected:I(e.branding.pageGradientEnd)}]),style:nt({backgroundColor:B(e.branding.pageGradientEnd)}),title:"Custom colour",onClick:ne[27]||(ne[27]=ye=>R("pageEnd",ye))},[(p(),g("svg",{class:"custom-icon",style:nt({color:T(e.branding.pageGradientEnd)}),viewBox:"0 0 24 24",fill:"currentColor"},[...ne[56]||(ne[56]=[r("path",{d:"M17.66 5.41l.92.92-2.69 2.69-.92-.92 2.69-2.69M17.67 3c-.26 0-.51.1-.71.29l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42l-2.34-2.34c-.2-.19-.45-.29-.7-.29zM6.92 19L5 17.08l8.06-8.06 1.92 1.92L6.92 19z"},null,-1)])],4))],6),x.value==="pageEnd"?(p(),g("div",{key:0,class:"custom-hex-popup",style:nt(_.value)},[r("div",hE,[ne[57]||(ne[57]=r("span",null,"Custom colour",-1)),r("button",{type:"button",class:"hex-popup-close",onClick:ne[28]||(ne[28]=ye=>x.value=null)},"")]),r("div",fE,[ne[58]||(ne[58]=r("span",{class:"hex-prefix"},"#",-1)),Ge(r("input",{ref_key:"hexInputRef",ref:$,"onUpdate:modelValue":ne[29]||(ne[29]=ye=>E.value=ye),type:"text",maxlength:"6",placeholder:"000000",class:le(["hex-input",{invalid:E.value&&!M.value}]),onInput:A,onKeydown:ya(G,["enter"])},null,34),[[st,E.value]]),r("div",{class:"hex-preview",style:nt({backgroundColor:M.value?"#"+E.value:"#ccc"})},null,4),r("button",{type:"button",class:"hex-apply-btn",disabled:!M.value,onClick:G}," Apply ",8,pE)]),E.value&&!M.value?(p(),g("span",vE,"Invalid hex code")):D("",!0)],4)):D("",!0)])])])):D("",!0)])],64)):D("",!0)]),r("div",mE,[r("button",{type:"button",class:"btn-done",onClick:ne[30]||(ne[30]=ye=>c.value=null)},"Done")])],512)],512),[[sa,c.value]]),ne[61]||(ne[61]=r("p",{class:"instructions"}," Click on different parts of the preview to customise them. The emergency button stays red for safety. ",-1))]))}},yE=Ze(gE,[["__scopeId","data-v-01af4f2d"]]),kE={class:"settings-tab"},bE={class:"accordion"},_E={class:"accordion-section"},wE={class:"accordion-title"},CE={class:"accordion-icon"},LE={key:0,class:"accordion-content"},SE={class:"accordion-section"},IE={class:"accordion-icon"},xE={key:0,class:"accordion-content"},$E={class:"terminology-grid"},TE={class:"term-group"},ME=["value"],AE={class:"term-group"},EE=["value"],PE={class:"term-group"},DE=["value"],RE={class:"term-group"},OE=["value"],BE={class:"term-group"},NE=["value"],FE={class:"form-actions"},UE=["disabled"],zE={class:"accordion-section"},HE={class:"accordion-title"},VE={class:"accordion-icon"},GE={key:0,class:"accordion-content"},qE={class:"section-description"},jE={class:"form-actions"},WE=["disabled"],ZE={class:"accordion-section"},KE={class:"accordion-title"},YE={class:"accordion-icon"},JE={key:0,class:"accordion-content"},XE={class:"section-description"},QE={class:"form-actions"},e4=["disabled"],t4=["disabled"],Nv="admin_settings_accordion",n4={__name:"SettingsTab",props:{eventData:{type:Object,required:!0},admins:{type:Array,default:()=>[]},formDirty:{type:Boolean,default:!1},eventId:{type:String,default:""}},emits:["submit","add-admin","remove-admin","update:formDirty"],setup(e,{emit:t}){const{terms:n,termsLower:a}=ht(),o=pc(),i=z(()=>o.adminEmail||""),l=e,c=t,d=P({...l.eventData}),h=P(null),f=P(!1),m=()=>l.eventId?`${Nv}_${l.eventId}`:Nv,y=P(null);rn(()=>{const M=localStorage.getItem(m());M&&(y.value=M)});const k=z(()=>{const M=d.value.peopleTerm||"Marshals";return _s.checkpoint.map(R=>({value:R,label:jh(R,M)}))}),S=M=>{const R=y.value===M?null:M;y.value=R,R?localStorage.setItem(m(),R):localStorage.removeItem(m())};Ye(()=>l.eventData,M=>{d.value={...M},w.value=!1},{deep:!0});const x=()=>{c("update:formDirty",!0)},E=(M,R)=>{d.value[M]=R,x()},$=z(()=>({headerGradientStart:d.value.brandingHeaderGradientStart||"",headerGradientEnd:d.value.brandingHeaderGradientEnd||"",logoUrl:d.value.brandingLogoUrl||"",logoPosition:d.value.brandingLogoPosition||"",accentColor:d.value.brandingAccentColor||"",pageGradientStart:d.value.brandingPageGradientStart||"",pageGradientEnd:d.value.brandingPageGradientEnd||""})),w=P(!1),_=M=>{w.value=M},I=M=>{d.value.brandingHeaderGradientStart=M.headerGradientStart,d.value.brandingHeaderGradientEnd=M.headerGradientEnd,d.value.brandingLogoUrl=M.logoUrl,d.value.brandingLogoPosition=M.logoPosition,d.value.brandingAccentColor=M.accentColor,d.value.brandingPageGradientStart=M.pageGradientStart,d.value.brandingPageGradientEnd=M.pageGradientEnd,x()},T=()=>{eA(),d.value.brandingHeaderGradientStart="",d.value.brandingHeaderGradientEnd="",d.value.brandingLogoUrl="",d.value.brandingLogoPosition="",d.value.brandingAccentColor="",d.value.brandingPageGradientStart="",d.value.brandingPageGradientEnd="",w.value=!1,h.value?.resetLogo(),x()},B=async()=>{if(!f.value){f.value=!0;try{if(w.value&&h.value){if(h.value.isLogoPendingDelete()){const R=await h.value.deleteStagedLogo();if(!R.success){console.error("Failed to delete logo:",R.error);return}d.value.brandingLogoUrl=""}else{const R=await h.value.uploadStagedLogo();if(!R.success){console.error("Failed to upload logo:",R.error);return}R.logoUrl&&!R.logoUrl.startsWith("blob:")&&(d.value.brandingLogoUrl=R.logoUrl)}w.value=!1}c("submit",{...d.value})}finally{f.value=!1}}};return(M,R)=>(p(),g("div",kE,[r("div",bE,[r("div",_E,[r("button",{class:le(["accordion-header",{active:y.value==="admins"}]),onClick:R[0]||(R[0]=A=>S("admins"))},[r("span",wE,"Administrators ("+b(e.admins.length)+")",1),r("span",CE,b(y.value==="admins"?"-":"+"),1)],2),y.value==="admins"?(p(),g("div",LE,[Ee(iT,{admins:e.admins,onAddAdmin:R[1]||(R[1]=A=>M.$emit("add-admin")),onRemoveAdmin:R[2]||(R[2]=A=>M.$emit("remove-admin",A))},null,8,["admins"])])):D("",!0)]),r("div",SE,[r("button",{class:le(["accordion-header",{active:y.value==="terminology"}]),onClick:R[3]||(R[3]=A=>S("terminology"))},[R[19]||(R[19]=r("span",{class:"accordion-title"},"Terminology",-1)),r("span",IE,b(y.value==="terminology"?"-":"+"),1)],2),y.value==="terminology"?(p(),g("div",xE,[R[20]||(R[20]=r("p",{class:"section-description"}," Customise how things are named throughout the application. ",-1)),r("div",$E,[r("div",TE,[r("label",null,b(N(n).people)+" are called",1),Ge(r("select",{"onUpdate:modelValue":R[4]||(R[4]=A=>d.value.peopleTerm=A),class:"form-input",onChange:x},[(p(!0),g(xe,null,qe(N(_s).people,A=>(p(),g("option",{key:A,value:A},b(A),9,ME))),128))],544),[[no,d.value.peopleTerm]])]),r("div",AE,[r("label",null,b(N(n).checkpoints)+" are called",1),Ge(r("select",{"onUpdate:modelValue":R[5]||(R[5]=A=>d.value.checkpointTerm=A),class:"form-input",onChange:x},[(p(!0),g(xe,null,qe(k.value,A=>(p(),g("option",{key:A.value,value:A.value},b(A.label),9,EE))),128))],544),[[no,d.value.checkpointTerm]])]),r("div",PE,[r("label",null,b(N(n).areas)+" are called",1),Ge(r("select",{"onUpdate:modelValue":R[6]||(R[6]=A=>d.value.areaTerm=A),class:"form-input",onChange:x},[(p(!0),g(xe,null,qe(N(_s).area,A=>(p(),g("option",{key:A,value:A},b(A),9,DE))),128))],544),[[no,d.value.areaTerm]])]),r("div",RE,[r("label",null,b(N(n).checklists)+" are called",1),Ge(r("select",{"onUpdate:modelValue":R[7]||(R[7]=A=>d.value.checklistTerm=A),class:"form-input",onChange:x},[(p(!0),g(xe,null,qe(N(_s).checklist,A=>(p(),g("option",{key:A,value:A},b(A),9,OE))),128))],544),[[no,d.value.checklistTerm]])]),r("div",BE,[r("label",null,b(N(n).course)+" is called",1),Ge(r("select",{"onUpdate:modelValue":R[8]||(R[8]=A=>d.value.courseTerm=A),class:"form-input",onChange:x},[(p(!0),g(xe,null,qe(N(_s).course,A=>(p(),g("option",{key:A,value:A},b(A),9,NE))),128))],544),[[no,d.value.courseTerm]])])]),r("div",FE,[r("button",{onClick:B,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,UE)])])):D("",!0)]),r("div",zE,[r("button",{class:le(["accordion-header",{active:y.value==="appearance"}]),onClick:R[9]||(R[9]=A=>S("appearance"))},[r("span",HE,b(N(n).checkpoint)+" appearance",1),r("span",VE,b(y.value==="appearance"?"-":"+"),1)],2),y.value==="appearance"?(p(),g("div",GE,[r("p",qE," Set the default marker style for all "+b(N(a).checkpoints)+" in this event. Individual "+b(N(a).areas)+" and "+b(N(a).checkpoints)+" can override this setting. ",1),Ee(Bf,{"style-type":d.value.defaultCheckpointStyleType||"default","style-color":d.value.defaultCheckpointStyleColor||"","style-background-shape":d.value.defaultCheckpointStyleBackgroundShape||"","style-background-color":d.value.defaultCheckpointStyleBackgroundColor||"","style-border-color":d.value.defaultCheckpointStyleBorderColor||"","style-icon-color":d.value.defaultCheckpointStyleIconColor||"","style-size":d.value.defaultCheckpointStyleSize||"","style-map-rotation":d.value.defaultCheckpointStyleMapRotation??"","icon-label":"Default marker style",level:"event","show-preview":!0,"onUpdate:styleType":R[10]||(R[10]=A=>E("defaultCheckpointStyleType",A)),"onUpdate:styleColor":R[11]||(R[11]=A=>E("defaultCheckpointStyleColor",A)),"onUpdate:styleBackgroundShape":R[12]||(R[12]=A=>E("defaultCheckpointStyleBackgroundShape",A)),"onUpdate:styleBackgroundColor":R[13]||(R[13]=A=>E("defaultCheckpointStyleBackgroundColor",A)),"onUpdate:styleBorderColor":R[14]||(R[14]=A=>E("defaultCheckpointStyleBorderColor",A)),"onUpdate:styleIconColor":R[15]||(R[15]=A=>E("defaultCheckpointStyleIconColor",A)),"onUpdate:styleSize":R[16]||(R[16]=A=>E("defaultCheckpointStyleSize",A)),"onUpdate:styleMapRotation":R[17]||(R[17]=A=>E("defaultCheckpointStyleMapRotation",A))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation"]),r("div",jE,[r("button",{onClick:B,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,WE)])])):D("",!0)]),r("div",ZE,[r("button",{class:le(["accordion-header",{active:y.value==="branding"}]),onClick:R[18]||(R[18]=A=>S("branding"))},[r("span",KE,b(N(n).person)+" branding",1),r("span",YE,b(y.value==="branding"?"-":"+"),1)],2),y.value==="branding"?(p(),g("div",JE,[r("p",XE," Customise the appearance of the "+b(N(a).person)+" view to match your organisation's branding. ",1),Ee(yE,{ref_key:"brandingMockupRef",ref:h,branding:$.value,"event-name":d.value.name,"event-date":N(Zy)(d.value.eventDate),"event-id":e.eventId,"admin-email":i.value,"onUpdate:branding":I,onLogoStagedChange:_},null,8,["branding","event-name","event-date","event-id","admin-email"]),r("div",QE,[r("button",{onClick:T,class:"btn btn-secondary",disabled:f.value}," Reset to default ",8,e4),r("button",{onClick:B,class:"btn btn-primary",disabled:!e.formDirty&&!w.value||f.value},b(f.value?"Saving...":"Save"),9,t4)])])):D("",!0)])])]))}},o4=Ze(n4,[["__scopeId","data-v-bb7e241a"]]),a4={class:"incident-header"},s4={class:"incident-title-row"},i4={class:"incident-title"},l4={class:"incident-badges"},r4={key:0,class:"incident-description"},c4={class:"incident-context"},u4={key:0,class:"context-item"},d4={key:1,class:"context-item"},h4={key:2,class:"context-item"},f4={class:"incident-footer"},p4={class:"reporter-info"},v4={class:"time-info"},m4={__name:"IncidentCard",props:{incident:{type:Object,required:!0}},emits:["select"],setup(e){const t=e,n=z(()=>{if(t.incident.title)return t.incident.title;const c=t.incident.description||"";return c.length<=60?c:c.substring(0,57).trim()+"..."}),a=c=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[c]||c,o=c=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[c]||c,i=(c,d=120)=>!c||c.length<=d?c:c.substring(0,d).trim()+"...",l=c=>{if(!c)return"";const d=new Date(c),f=new Date-d,m=Math.floor(f/6e4),y=Math.floor(f/36e5),k=Math.floor(f/864e5);return m<1?"just now":m<60?`${m}m ago`:y<24?`${y}h ago`:k<7?`${k}d ago`:d.toLocaleDateString()};return(c,d)=>(p(),g("div",{class:le(["incident-card",[`severity-${e.incident.severity}`,`status-${e.incident.status}`]]),onClick:d[0]||(d[0]=h=>c.$emit("select",e.incident))},[r("div",a4,[r("div",s4,[r("span",{class:le(["severity-indicator",e.incident.severity])},null,2),r("strong",i4,b(n.value),1)]),r("div",l4,[r("span",{class:le(["severity-badge",e.incident.severity])},b(a(e.incident.severity)),3),r("span",{class:le(["status-badge",e.incident.status])},b(o(e.incident.status)),3)])]),e.incident.title&&e.incident.description?(p(),g("div",r4,b(i(e.incident.description)),1)):D("",!0),r("div",c4,[e.incident.context?.checkpoint?(p(),g("div",u4,[d[1]||(d[1]=r("span",{class:"context-icon"},"",-1)),r("span",null,b(e.incident.context.checkpoint.name),1)])):e.incident.latitude&&e.incident.longitude?(p(),g("div",d4,[...d[2]||(d[2]=[r("span",{class:"context-icon"},"",-1),r("span",null,"GPS Location",-1)])])):D("",!0),e.incident.area?(p(),g("div",h4,[d[3]||(d[3]=r("span",{class:"context-icon"},"",-1)),r("span",null,b(e.incident.area.areaName),1)])):D("",!0)]),r("div",f4,[r("span",p4," Reported by "+b(e.incident.reportedBy?.name||"Unknown"),1),r("span",v4,b(l(e.incident.incidentTime||e.incident.createdAt)),1)])],2))}},gc=Ze(m4,[["__scopeId","data-v-690fd385"]]),g4={class:"incidents-tab"},y4={class:"tab-header"},k4={class:"button-group"},b4={key:0,class:"status-pills"},_4={class:"filters-section"},w4={class:"search-group"},C4={class:"incidents-list"},L4={key:0,class:"loading-state"},S4={key:1,class:"empty-state"},I4={__name:"IncidentsTab",props:{incidents:{type:Array,required:!0},areas:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["select-incident","report-incident"],setup(e,{emit:t}){const n=e,a=P(""),o=P("all"),i=y=>{o.value=y},l=z(()=>n.incidents.filter(y=>y.status==="open").length),c=z(()=>n.incidents.filter(y=>y.status==="in_progress"||y.status==="acknowledged").length),d=z(()=>n.incidents.filter(y=>y.status==="resolved").length),h=z(()=>n.incidents.filter(y=>y.status==="closed").length),f=z(()=>{let y=n.incidents;if(o.value==="open"?y=y.filter(k=>k.status==="open"):o.value==="in-progress"?y=y.filter(k=>k.status==="in_progress"||k.status==="acknowledged"):o.value==="resolved"?y=y.filter(k=>k.status==="resolved"):o.value==="closed"&&(y=y.filter(k=>k.status==="closed")),a.value.trim()){const k=a.value.toLowerCase().trim().split(/\s+/);y=y.filter(S=>{const x=`${S.context?.checkpoint?.name||""} ${S.context?.checkpoint?.description||""}`,E=S.area?.areaName||"",$=[S.reportedBy?.name||"",...(S.context?.peopleAtCheckpoint||[]).map(I=>I.name||"")].join(" "),w=(S.updates||[]).map(I=>I.note||"").join(" "),_=`${S.title||""} ${S.description||""} ${x} ${E} ${$} ${w}`.toLowerCase();return k.every(I=>_.includes(I))})}return y}),m=z(()=>[...f.value].sort((y,k)=>new Date(k.incidentTime||k.createdAt)-new Date(y.incidentTime||y.createdAt)));return(y,k)=>(p(),g("div",g4,[r("div",y4,[r("div",k4,[r("button",{onClick:k[0]||(k[0]=S=>y.$emit("report-incident")),class:"btn btn-primary"}," Report incident ")]),e.incidents.length>0?(p(),g("div",b4,[Ee(Et,{variant:"neutral",active:o.value==="all",onClick:k[1]||(k[1]=S=>i("all"))},{default:Ue(()=>[Je(b(e.incidents.length)+" total ",1)]),_:1},8,["active"]),l.value>0&&l.value<e.incidents.length?(p(),ze(Et,{key:0,variant:"info",active:o.value==="open",onClick:k[2]||(k[2]=S=>i("open"))},{default:Ue(()=>[Je(b(l.value)+" open ",1)]),_:1},8,["active"])):D("",!0),c.value>0&&c.value<e.incidents.length?(p(),ze(Et,{key:1,variant:"purple",active:o.value==="in-progress",onClick:k[3]||(k[3]=S=>i("in-progress"))},{default:Ue(()=>[Je(b(c.value)+" in progress ",1)]),_:1},8,["active"])):D("",!0),d.value>0&&d.value<e.incidents.length?(p(),ze(Et,{key:2,variant:"success",active:o.value==="resolved",onClick:k[4]||(k[4]=S=>i("resolved"))},{default:Ue(()=>[Je(b(d.value)+" resolved ",1)]),_:1},8,["active"])):D("",!0),h.value>0&&h.value<e.incidents.length?(p(),ze(Et,{key:3,variant:"neutral",active:o.value==="closed",onClick:k[5]||(k[5]=S=>i("closed"))},{default:Ue(()=>[Je(b(h.value)+" closed ",1)]),_:1},8,["active"])):D("",!0)])):D("",!0)]),r("div",_4,[r("div",w4,[Ge(r("input",{"onUpdate:modelValue":k[6]||(k[6]=S=>a.value=S),type:"text",class:"search-input",placeholder:"Search by title, description, location, area, or person..."},null,512),[[st,a.value]])])]),r("div",C4,[e.loading?(p(),g("div",L4," Loading incidents... ")):f.value.length===0?(p(),g("div",S4,[r("p",null,b(a.value||o.value!=="all"?"No incidents match your search or filter.":"No incidents reported yet."),1)])):D("",!0),(p(!0),g(xe,null,qe(m.value,S=>(p(),ze(gc,{key:S.incidentId,incident:S,onSelect:x=>y.$emit("select-incident",S)},null,8,["incident","onSelect"]))),128))])]))}},x4=Ze(I4,[["__scopeId","data-v-f24c84f4"]]),$4={key:0,class:"empty-state"},T4={key:0,class:"empty-hint"},M4={__name:"CardsGrid",props:{isEmpty:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No items."},emptyHint:{type:String,default:""},gridClass:{type:String,default:""}},setup(e){return(t,n)=>e.isEmpty?(p(),g("div",$4,[r("p",null,b(e.emptyMessage),1),e.emptyHint?(p(),g("p",T4,b(e.emptyHint),1)):D("",!0)])):(p(),g("div",{key:1,class:le(["cards-grid",e.gridClass])},[ko(t.$slots,"default",{},void 0,!0)],2))}},yc=Ze(M4,[["__scopeId","data-v-a842b7b1"]]),A4={class:"checkpoint-card-header"},E4={class:"checkpoint-name-row"},P4=["innerHTML"],D4={class:"checkpoint-name"},R4={key:0,class:"checkpoint-description"},O4={key:0,class:"checkpoint-card-areas"},B4={class:"checkpoint-card-stats"},N4={key:1,class:"checkpoint-card-marshals"},F4={__name:"CheckpointCard",props:{checkpoint:{type:Object,required:!0},areas:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const n=e,a=t,o=z(()=>n.checkpoint.areaIds||n.checkpoint.AreaIds||[]),i=E=>{const $=n.areas.find(w=>w.id===E);return $?$.name:null},l=E=>{const $=n.areas.find(w=>w.id===E);return $?$.color:"#999"},c=z(()=>{const E=n.checkpoint,$=E.resolvedStyleBackgroundColor||E.ResolvedStyleBackgroundColor||E.resolvedStyleColor||E.ResolvedStyleColor;return $||(o.value.length>0?l(o.value[0]):"#667eea")}),d=z(()=>{const E=n.checkpoint,$=(E.assignments||[]).length;return E.requiredMarshals===0?null:$>=E.requiredMarshals?"full":$>0?"partial":"none"}),h=z(()=>[...n.checkpoint.assignments||[]].sort(($,w)=>($.marshalName||"").localeCompare(w.marshalName||"",void 0,{sensitivity:"base"}))),f=z(()=>(n.checkpoint.assignments||[]).length),m=z(()=>(n.checkpoint.assignments||[]).filter(E=>E.isCheckedIn).length),y=z(()=>d.value?`staffing-${d.value}`:""),k=z(()=>{const E=f.value,$=m.value;return E===0?"":$===0?"checkin-none":$>=E?"checkin-full":"checkin-partial"}),S=z(()=>{const E=n.checkpoint,$=E.resolvedStyleType||E.ResolvedStyleType,w=E.resolvedStyleBackgroundColor||E.ResolvedStyleBackgroundColor||E.resolvedStyleColor||E.ResolvedStyleColor,_=E.resolvedStyleBorderColor||E.ResolvedStyleBorderColor,I=E.resolvedStyleIconColor||E.ResolvedStyleIconColor,T=E.resolvedStyleBackgroundShape||E.ResolvedStyleBackgroundShape;return $&&$!=="default"||w||_||I||T&&T!=="circle"?Vn({type:$||"circle",backgroundShape:T||"circle",backgroundColor:w||"#667eea",borderColor:_||"#ffffff",iconColor:I||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),x=()=>{n.clickable&&a("click",n.checkpoint)};return(E,$)=>(p(),g("div",{class:le(["checkpoint-card",{"is-clickable":e.clickable,"staffed-full":d.value==="full","staffed-partial":d.value==="partial","staffed-none":d.value==="none"}]),style:nt({borderLeftColor:c.value}),onClick:x},[r("div",A4,[r("div",{class:le(["checkpoint-card-title",{clickable:e.clickable}])},[r("span",E4,[r("span",{class:"checkpoint-icon",innerHTML:S.value},null,8,P4),r("span",D4,b(e.checkpoint.name),1),e.checkpoint.description?(p(),g("span",R4,"  "+b(e.checkpoint.description),1)):D("",!0)])],2)]),o.value.length>0?(p(),g("div",O4,[(p(!0),g(xe,null,qe(o.value,w=>(p(),g("span",{key:w,class:"area-badge",style:nt({backgroundColor:l(w)})},b(i(w)),5))),128))])):D("",!0),r("div",B4,[r("span",{class:le(["stat-badge staffing-badge",y.value])},b(f.value)+"/"+b(e.checkpoint.requiredMarshals)+" staffed ",3),f.value>0?(p(),g("span",{key:0,class:le(["stat-badge",k.value])},b(m.value)+"/"+b(f.value)+" checked in ",3)):D("",!0)]),h.value.length>0?(p(),g("div",N4,[(p(!0),g(xe,null,qe(h.value,w=>(p(),g("span",{key:w.id,class:le(["marshal-badge",{"checked-in":w.isCheckedIn}])},b(w.marshalName),3))),128))])):D("",!0)],6))}},U4=Ze(F4,[["__scopeId","data-v-7ae260df"]]),p1={__name:"CheckpointsGrid",props:{checkpoints:{type:Array,required:!0},areas:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No checkpoints."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,n)=>(p(),ze(yc,{"is-empty":e.checkpoints.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ue(()=>[(p(!0),g(xe,null,qe(e.checkpoints,a=>(p(),ze(U4,{key:a.id,checkpoint:a,areas:e.areas,clickable:!0,onClick:n[0]||(n[0]=o=>t.$emit("select",o))},null,8,["checkpoint","areas"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},z4={class:"checkpoints-tab"},H4={class:"tab-header"},V4={class:"button-group"},G4={key:0,class:"status-pills"},q4={class:"filters-section"},j4={class:"search-group"},W4=["placeholder"],Z4={__name:"CheckpointsList",props:{locations:{type:Array,required:!0},areas:{type:Array,default:()=>[]}},emits:["add-checkpoint-manually","import-checkpoints","select-location"],setup(e){const{termsLower:t}=ht(),n=e,a=P(""),o=P("all"),i=w=>{o.value=w},l=w=>(w.assignments||[]).length,c=w=>(w.assignments||[]).filter(_=>_.isCheckedIn).length,d=z(()=>n.locations.filter(w=>l(w)>=w.requiredMarshals&&w.requiredMarshals>0).length),h=z(()=>n.locations.filter(w=>l(w)>0&&l(w)<w.requiredMarshals).length),f=z(()=>n.locations.filter(w=>l(w)===0&&w.requiredMarshals>0).length),m=z(()=>n.locations.filter(w=>{const _=l(w),I=c(w);return _>0&&I>=_}).length),y=z(()=>n.locations.filter(w=>{const _=l(w),I=c(w);return _>0&&I>0&&I<_}).length),k=z(()=>n.locations.filter(w=>{const _=l(w),I=c(w);return _>0&&I===0}).length),S=w=>{const _=n.areas.find(I=>I.id===w);return _?_.name:null},x=z(()=>{let w=n.locations;if(o.value==="full"?w=w.filter(_=>l(_)>=_.requiredMarshals&&_.requiredMarshals>0):o.value==="partial"?w=w.filter(_=>l(_)>0&&l(_)<_.requiredMarshals):o.value==="missing"?w=w.filter(_=>l(_)===0&&_.requiredMarshals>0):o.value==="checkin-full"?w=w.filter(_=>{const I=l(_),T=c(_);return I>0&&T>=I}):o.value==="checkin-partial"?w=w.filter(_=>{const I=l(_),T=c(_);return I>0&&T>0&&T<I}):o.value==="checkin-none"&&(w=w.filter(_=>{const I=l(_),T=c(_);return I>0&&T===0})),a.value.trim()){const _=a.value.toLowerCase().trim().split(/\s+/);w=w.filter(I=>{const B=(I.areaIds||I.AreaIds||[]).map(A=>S(A)||"").join(" "),M=(I.assignments||[]).map(A=>A.marshalName||"").join(" "),R=`${I.name||""} ${I.description||""} ${B} ${M}`.toLowerCase();return _.every(A=>R.includes(A))})}return w}),E=z(()=>[...x.value].sort((w,_)=>na(w.name,_.name))),$=z(()=>{const w=a.value.trim();return o.value==="full"?w?`No fully staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully staffed.`:o.value==="partial"?w?`No partially staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially staffed.`:o.value==="missing"?w?`No unstaffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are unstaffed.`:o.value==="checkin-full"?w?`No fully checked in ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully checked in.`:o.value==="checkin-partial"?w?`No partially checked in ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially checked in.`:o.value==="checkin-none"?w?`No ${t.value.checkpoints} without check-ins match your search.`:`No ${t.value.checkpoints} are without check-ins.`:w?`No ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} yet. Add one to get started!`});return(w,_)=>(p(),g("div",z4,[r("div",H4,[r("div",V4,[r("button",{onClick:_[0]||(_[0]=I=>w.$emit("add-checkpoint-manually")),class:"btn btn-primary"}," Add "+b(N(t).checkpoint),1),r("button",{onClick:_[1]||(_[1]=I=>w.$emit("import-checkpoints")),class:"btn btn-secondary"}," Import CSV ")]),e.locations.length>0?(p(),g("div",G4,[Ee(Et,{variant:"neutral",active:o.value==="all",onClick:_[2]||(_[2]=I=>i("all"))},{default:Ue(()=>[Je(b(e.locations.length)+" total ",1)]),_:1},8,["active"]),d.value>0&&d.value<e.locations.length?(p(),ze(Et,{key:0,variant:"success",active:o.value==="full",onClick:_[3]||(_[3]=I=>i("full"))},{default:Ue(()=>[Je(b(d.value)+" fully staffed ",1)]),_:1},8,["active"])):D("",!0),h.value>0&&h.value<e.locations.length?(p(),ze(Et,{key:1,variant:"warning",active:o.value==="partial",onClick:_[4]||(_[4]=I=>i("partial"))},{default:Ue(()=>[Je(b(h.value)+" partially staffed ",1)]),_:1},8,["active"])):D("",!0),f.value>0&&f.value<e.locations.length?(p(),ze(Et,{key:2,variant:"danger",active:o.value==="missing",onClick:_[5]||(_[5]=I=>i("missing"))},{default:Ue(()=>[Je(b(f.value)+" unstaffed ",1)]),_:1},8,["active"])):D("",!0),m.value>0&&m.value<e.locations.length?(p(),ze(Et,{key:3,variant:"success",active:o.value==="checkin-full",onClick:_[6]||(_[6]=I=>i("checkin-full"))},{default:Ue(()=>[Je(b(m.value)+" fully checked in ",1)]),_:1},8,["active"])):D("",!0),y.value>0&&y.value<e.locations.length?(p(),ze(Et,{key:4,variant:"warning",active:o.value==="checkin-partial",onClick:_[7]||(_[7]=I=>i("checkin-partial"))},{default:Ue(()=>[Je(b(y.value)+" partially checked in ",1)]),_:1},8,["active"])):D("",!0),k.value>0&&k.value<e.locations.length?(p(),ze(Et,{key:5,variant:"danger",active:o.value==="checkin-none",onClick:_[8]||(_[8]=I=>i("checkin-none"))},{default:Ue(()=>[Je(b(k.value)+" not checked in ",1)]),_:1},8,["active"])):D("",!0)])):D("",!0)]),r("div",q4,[r("div",j4,[Ge(r("input",{"onUpdate:modelValue":_[9]||(_[9]=I=>a.value=I),type:"text",class:"search-input",placeholder:`Search by name, description, ${N(t).area}, or ${N(t).person}...`},null,8,W4),[[st,a.value]])])]),Ee(p1,{checkpoints:E.value,areas:e.areas,"empty-message":$.value,onSelect:_[10]||(_[10]=I=>w.$emit("select-location",I))},null,8,["checkpoints","areas","empty-message"])]))}},K4=Ze(Z4,[["__scopeId","data-v-846aa906"]]),Y4={class:"area-card-header"},J4={class:"area-name-row"},X4={class:"area-name"},Q4={key:0,class:"default-badge"},e3={key:0,class:"area-description"},t3={class:"area-card-stats"},n3={class:"stat-badge"},o3={class:"stat-badge"},a3={__name:"AreaCard",props:{area:{type:Object,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const n=e,a=t,o=z(()=>n.area.checkpointCount!==void 0?n.area.checkpointCount:n.checkpoints.filter(f=>(f.areaIds||f.AreaIds||[]).includes(n.area.id)||f.areaId===n.area.id).length),i=z(()=>n.contacts.filter(f=>f.scopeConfigurations?f.scopeConfigurations.some(m=>m.scope==="EveryoneInAreas"&&m.itemType==="Area"?m.ids?.includes("ALL_AREAS")?!0:m.ids?.includes(n.area.id):!1):!1).length),l=z(()=>n.area.peopleTerm||n.eventPeopleTerm||"Marshals"),c=z(()=>{const f=n.area.checkpointTerm||n.eventCheckpointTerm||"Checkpoints";return o.value===1?Qi("checkpoint",f,l.value):qy("checkpoint",f,l.value)}),d=z(()=>`${o.value} ${c.value.toLowerCase()}`),h=()=>{n.clickable&&a("click",n.area)};return(f,m)=>(p(),g("div",{class:le(["area-card",{"is-clickable":e.clickable,"is-default":e.area.isDefault}]),style:nt({borderLeftColor:e.area.color||"#667eea"}),onClick:h},[r("div",Y4,[r("div",{class:le(["area-card-title",{clickable:e.clickable}])},[r("div",J4,[r("span",X4,b(e.area.name),1),e.area.isDefault?(p(),g("span",Q4,"Default")):D("",!0)]),e.area.description?(p(),g("span",e3,b(e.area.description),1)):D("",!0)],2)]),r("div",t3,[r("span",n3,b(d.value),1),r("span",o3,b(i.value)+" contact"+b(i.value===1?"":"s"),1)])],6))}},s3=Ze(a3,[["__scopeId","data-v-8ac20bf2"]]),i3={__name:"AreasGrid",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},emptyMessage:{type:String,default:"No areas."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,n)=>(p(),ze(yc,{"is-empty":e.areas.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ue(()=>[(p(!0),g(xe,null,qe(e.areas,a=>(p(),ze(s3,{key:a.id,area:a,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,clickable:!0,onClick:n[0]||(n[0]=o=>t.$emit("select",o))},null,8,["area","checkpoints","contacts","event-people-term","event-checkpoint-term"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},l3={class:"areas-tab"},r3={class:"tab-header"},c3={class:"button-group"},u3={key:0,class:"status-pills"},d3={class:"filters-section"},h3={class:"search-group"},f3=["placeholder"],p3={__name:"AreasList",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["add-area","select-area"],setup(e){const{termsLower:t}=ht(),n=e,a=P(""),o=d=>n.checkpoints.filter(h=>(h.areaIds||h.AreaIds||[]).includes(d)||h.areaId===d),i=z(()=>{if(!a.value.trim())return n.areas;const d=a.value.toLowerCase().trim().split(/\s+/);return n.areas.filter(h=>{const m=o(h.id).map(k=>`${k.name||""} ${k.description||""}`).join(" "),y=`${h.name||""} ${h.description||""} ${m}`.toLowerCase();return d.every(k=>y.includes(k))})}),l=z(()=>[...i.value].sort((d,h)=>d.displayOrder!==h.displayOrder?d.displayOrder-h.displayOrder:na(d.name,h.name))),c=z(()=>a.value.trim()?`No ${t.value.areas} match your search.`:`No ${t.value.areas} yet. Click "Add ${t.value.area}" to create one.`);return(d,h)=>(p(),g("div",l3,[r("div",r3,[r("div",c3,[r("button",{onClick:h[0]||(h[0]=f=>d.$emit("add-area")),class:"btn btn-primary"}," Add "+b(N(t).area),1)]),e.areas.length>0?(p(),g("div",u3,[Ee(Et,{variant:"neutral",active:!1},{default:Ue(()=>[Je(b(e.areas.length)+" "+b(e.areas.length===1?N(t).area:N(t).areas),1)]),_:1})])):D("",!0)]),r("div",d3,[r("div",h3,[Ge(r("input",{"onUpdate:modelValue":h[1]||(h[1]=f=>a.value=f),type:"text",class:"search-input",placeholder:`Search by ${N(t).area} name or ${N(t).checkpoint} name...`},null,8,f3),[[st,a.value]])])]),Ee(i3,{areas:l.value,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,"empty-message":c.value,onSelect:h[2]||(h[2]=f=>d.$emit("select-area",f))},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term","empty-message"])]))}},v3=Ze(p3,[["__scopeId","data-v-203f9606"]]),m3={course:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>',checkpoint:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',area:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',marshal:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',checklist:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>',notes:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/></svg>',incidents:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>',details:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16h6"/></svg>',location:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',contacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>',people:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polygon points="22 8 19.5 10 20.5 13 18 11.5 15.5 13 16.5 10 14 8 17 8 18 5 19 8 22 8" fill="currentColor"/></svg>',eventContacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 8V6a2 2 0 0 0-2-2h-2"/><path d="M22 12v2a2 2 0 0 1-2 2h-2"/></svg>',event:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>',roles:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 15c0-4 3.5-7 8-7s8 3 8 7"/><path d="M4 15c0 1.5 3.5 3 8 3s8-1.5 8-3"/><path d="M20 15h2c.5 0 1-.5 1-1v-1c0-1-1-2-2.5-2H20"/><circle cx="12" cy="8" r="1"/></svg>',appearance:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12.5" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>',logout:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>'},bo=e=>m3[e]||"",g3={class:"responsive-tabs"},y3=["onClick"],k3=["innerHTML"],b3=["innerHTML"],_3={class:"hamburger-label"},w3=["onClick"],C3=["innerHTML"],L3={__name:"ResponsiveTabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,a=t,o=P(null),i=P(null),l=P(null),c=P(!1),d=P({}),h=P(!1),f=z(()=>n.tabs.find($=>$.value===n.modelValue)),m=z(()=>f.value?f.value.label:"Menu"),y=()=>{if(c.value=!c.value,c.value&&i.value){const $=i.value.getBoundingClientRect();d.value={top:`${$.bottom+4}px`}}},k=$=>{a("update:modelValue",$),c.value=!1},S=$=>{if(!o.value)return;const w=o.value.contains($.target);c.value&&!w&&(c.value=!1)},x=()=>{if(!l.value)return;const $=l.value,w=h.value;w&&($.style.visibility="visible",$.style.position="static");const _=$.scrollWidth>$.clientWidth;w&&($.style.visibility="",$.style.position=""),h.value=_};let E=null;return rn(()=>{document.addEventListener("click",S),dn(()=>{x()}),dn(()=>{const $=l.value?.parentElement;$&&(E=new ResizeObserver(()=>{x()}),E.observe($))})}),An(()=>{document.removeEventListener("click",S),E&&E.disconnect()}),Ye(()=>n.tabs,()=>{dn(()=>{x()})},{deep:!0}),($,w)=>(p(),g("div",g3,[r("div",{ref_key:"visibleTabsRef",ref:l,class:le(["visible-tabs",{"is-hidden":h.value}])},[(p(!0),g(xe,null,qe(e.tabs,_=>(p(),g("button",{key:_.value,class:le(["tab-button",{active:e.modelValue===_.value}]),onClick:I=>$.$emit("update:modelValue",_.value),type:"button"},[_.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:N(bo)(_.icon)},null,8,k3)):D("",!0),Je(" "+b(_.label),1)],10,y3))),128))],2),r("div",{class:le(["hamburger-only",{"is-visible":h.value}])},[r("div",{class:"hamburger-menu",ref_key:"hamburgerMenu",ref:o},[r("button",{ref_key:"hamburgerButton",ref:i,class:le(["hamburger-button",{active:c.value}]),onClick:ct(y,["stop"]),type:"button"},[w[1]||(w[1]=r("span",{class:"hamburger-icon"},"",-1)),f.value?.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:N(bo)(f.value.icon)},null,8,b3)):D("",!0),r("span",_3,b(m.value),1)],2),c.value?(p(),g("div",{key:0,class:"hamburger-dropdown",style:nt(d.value),onClick:w[0]||(w[0]=ct(()=>{},["stop"]))},[(p(!0),g(xe,null,qe(e.tabs,_=>(p(),g("button",{key:_.value,class:le(["dropdown-item",{active:e.modelValue===_.value}]),onClick:ct(I=>k(_.value),["stop"]),type:"button"},[_.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:N(bo)(_.icon)},null,8,C3)):D("",!0),Je(" "+b(_.label),1)],10,w3))),128))],4)):D("",!0)],512)],2)]))}},S3=Ze(L3,[["__scopeId","data-v-2467c6fc"]]),I3={class:"instruction"},x3={class:"share-link-container"},$3=["value"],T3={__name:"ShareLinkModal",props:{show:{type:Boolean,default:!1},link:{type:String,required:!0},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const{terms:n,termsLower:a}=ht(),o=t,i=P(!1),l=P(null),c=()=>{l.value&&(l.value.select(),document.execCommand("copy"),i.value=!0,setTimeout(()=>{i.value=!1},2e3))},d=()=>{o("close")};return(h,f)=>(p(),ze(jt,{show:e.show,title:`${N(n).person} check-in link`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:Ue(()=>[r("button",{onClick:d,class:"btn btn-secondary"},"Close")]),default:Ue(()=>[r("p",I3,"Share this link with "+b(N(a).peoplePlural)+" so they can check in:",1),r("div",x3,[r("input",{value:e.link,readonly:"",class:"form-input",ref_key:"linkInput",ref:l},null,8,$3),r("button",{onClick:c,class:"btn btn-primary"},b(i.value?"Copied!":"Copy"),1)])]),_:1},8,["show","title","is-dirty"]))}},M3=Ze(T3,[["__scopeId","data-v-b037c39b"]]);var Nl={},Yd,Fv;function A3(){return Fv||(Fv=1,Yd=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),Yd}var Jd={},Js={},Uv;function vl(){if(Uv)return Js;Uv=1;let e;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Js.getSymbolSize=function(a){if(!a)throw new Error('"version" cannot be null or undefined');if(a<1||a>40)throw new Error('"version" should be in range from 1 to 40');return a*4+17},Js.getSymbolTotalCodewords=function(a){return t[a]},Js.getBCHDigit=function(n){let a=0;for(;n!==0;)a++,n>>>=1;return a},Js.setToSJISFunction=function(a){if(typeof a!="function")throw new Error('"toSJISFunc" is not a valid function.');e=a},Js.isKanjiModeEnabled=function(){return typeof e<"u"},Js.toSJIS=function(a){return e(a)},Js}var Xd={},zv;function Nf(){return zv||(zv=1,(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+n)}}e.isValid=function(a){return a&&typeof a.bit<"u"&&a.bit>=0&&a.bit<4},e.from=function(a,o){if(e.isValid(a))return a;try{return t(a)}catch{return o}}})(Xd)),Xd}var Qd,Hv;function E3(){if(Hv)return Qd;Hv=1;function e(){this.buffer=[],this.length=0}return e.prototype={get:function(t){const n=Math.floor(t/8);return(this.buffer[n]>>>7-t%8&1)===1},put:function(t,n){for(let a=0;a<n;a++)this.putBit((t>>>n-a-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),t&&(this.buffer[n]|=128>>>this.length%8),this.length++}},Qd=e,Qd}var eh,Vv;function P3(){if(Vv)return eh;Vv=1;function e(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return e.prototype.set=function(t,n,a,o){const i=t*this.size+n;this.data[i]=a,o&&(this.reservedBit[i]=!0)},e.prototype.get=function(t,n){return this.data[t*this.size+n]},e.prototype.xor=function(t,n,a){this.data[t*this.size+n]^=a},e.prototype.isReserved=function(t,n){return this.reservedBit[t*this.size+n]},eh=e,eh}var th={},Gv;function D3(){return Gv||(Gv=1,(function(e){const t=vl().getSymbolSize;e.getRowColCoords=function(a){if(a===1)return[];const o=Math.floor(a/7)+2,i=t(a),l=i===145?26:Math.ceil((i-13)/(2*o-2))*2,c=[i-7];for(let d=1;d<o-1;d++)c[d]=c[d-1]-l;return c.push(6),c.reverse()},e.getPositions=function(a){const o=[],i=e.getRowColCoords(a),l=i.length;for(let c=0;c<l;c++)for(let d=0;d<l;d++)c===0&&d===0||c===0&&d===l-1||c===l-1&&d===0||o.push([i[c],i[d]]);return o}})(th)),th}var nh={},qv;function R3(){if(qv)return nh;qv=1;const e=vl().getSymbolSize,t=7;return nh.getPositions=function(a){const o=e(a);return[[0,0],[o-t,0],[0,o-t]]},nh}var oh={},jv;function O3(){return jv||(jv=1,(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(o){return o!=null&&o!==""&&!isNaN(o)&&o>=0&&o<=7},e.from=function(o){return e.isValid(o)?parseInt(o,10):void 0},e.getPenaltyN1=function(o){const i=o.size;let l=0,c=0,d=0,h=null,f=null;for(let m=0;m<i;m++){c=d=0,h=f=null;for(let y=0;y<i;y++){let k=o.get(m,y);k===h?c++:(c>=5&&(l+=t.N1+(c-5)),h=k,c=1),k=o.get(y,m),k===f?d++:(d>=5&&(l+=t.N1+(d-5)),f=k,d=1)}c>=5&&(l+=t.N1+(c-5)),d>=5&&(l+=t.N1+(d-5))}return l},e.getPenaltyN2=function(o){const i=o.size;let l=0;for(let c=0;c<i-1;c++)for(let d=0;d<i-1;d++){const h=o.get(c,d)+o.get(c,d+1)+o.get(c+1,d)+o.get(c+1,d+1);(h===4||h===0)&&l++}return l*t.N2},e.getPenaltyN3=function(o){const i=o.size;let l=0,c=0,d=0;for(let h=0;h<i;h++){c=d=0;for(let f=0;f<i;f++)c=c<<1&2047|o.get(h,f),f>=10&&(c===1488||c===93)&&l++,d=d<<1&2047|o.get(f,h),f>=10&&(d===1488||d===93)&&l++}return l*t.N3},e.getPenaltyN4=function(o){let i=0;const l=o.data.length;for(let d=0;d<l;d++)i+=o.data[d];return Math.abs(Math.ceil(i*100/l/5)-10)*t.N4};function n(a,o,i){switch(a){case e.Patterns.PATTERN000:return(o+i)%2===0;case e.Patterns.PATTERN001:return o%2===0;case e.Patterns.PATTERN010:return i%3===0;case e.Patterns.PATTERN011:return(o+i)%3===0;case e.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(i/3))%2===0;case e.Patterns.PATTERN101:return o*i%2+o*i%3===0;case e.Patterns.PATTERN110:return(o*i%2+o*i%3)%2===0;case e.Patterns.PATTERN111:return(o*i%3+(o+i)%2)%2===0;default:throw new Error("bad maskPattern:"+a)}}e.applyMask=function(o,i){const l=i.size;for(let c=0;c<l;c++)for(let d=0;d<l;d++)i.isReserved(d,c)||i.xor(d,c,n(o,d,c))},e.getBestMask=function(o,i){const l=Object.keys(e.Patterns).length;let c=0,d=1/0;for(let h=0;h<l;h++){i(h),e.applyMask(h,o);const f=e.getPenaltyN1(o)+e.getPenaltyN2(o)+e.getPenaltyN3(o)+e.getPenaltyN4(o);e.applyMask(h,o),f<d&&(d=f,c=h)}return c}})(oh)),oh}var zc={},Wv;function v1(){if(Wv)return zc;Wv=1;const e=Nf(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return zc.getBlocksCount=function(o,i){switch(i){case e.L:return t[(o-1)*4+0];case e.M:return t[(o-1)*4+1];case e.Q:return t[(o-1)*4+2];case e.H:return t[(o-1)*4+3];default:return}},zc.getTotalCodewordsCount=function(o,i){switch(i){case e.L:return n[(o-1)*4+0];case e.M:return n[(o-1)*4+1];case e.Q:return n[(o-1)*4+2];case e.H:return n[(o-1)*4+3];default:return}},zc}var ah={},Lr={},Zv;function B3(){if(Zv)return Lr;Zv=1;const e=new Uint8Array(512),t=new Uint8Array(256);return(function(){let a=1;for(let o=0;o<255;o++)e[o]=a,t[a]=o,a<<=1,a&256&&(a^=285);for(let o=255;o<512;o++)e[o]=e[o-255]})(),Lr.log=function(a){if(a<1)throw new Error("log("+a+")");return t[a]},Lr.exp=function(a){return e[a]},Lr.mul=function(a,o){return a===0||o===0?0:e[t[a]+t[o]]},Lr}var Kv;function N3(){return Kv||(Kv=1,(function(e){const t=B3();e.mul=function(a,o){const i=new Uint8Array(a.length+o.length-1);for(let l=0;l<a.length;l++)for(let c=0;c<o.length;c++)i[l+c]^=t.mul(a[l],o[c]);return i},e.mod=function(a,o){let i=new Uint8Array(a);for(;i.length-o.length>=0;){const l=i[0];for(let d=0;d<o.length;d++)i[d]^=t.mul(o[d],l);let c=0;for(;c<i.length&&i[c]===0;)c++;i=i.slice(c)}return i},e.generateECPolynomial=function(a){let o=new Uint8Array([1]);for(let i=0;i<a;i++)o=e.mul(o,new Uint8Array([1,t.exp(i)]));return o}})(ah)),ah}var sh,Yv;function F3(){if(Yv)return sh;Yv=1;const e=N3();function t(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(a){this.degree=a,this.genPoly=e.generateECPolynomial(this.degree)},t.prototype.encode=function(a){if(!this.genPoly)throw new Error("Encoder not initialized");const o=new Uint8Array(a.length+this.degree);o.set(a);const i=e.mod(o,this.genPoly),l=this.degree-i.length;if(l>0){const c=new Uint8Array(this.degree);return c.set(i,l),c}return i},sh=t,sh}var ih={},lh={},rh={},Jv;function m1(){return Jv||(Jv=1,rh.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),rh}var Va={},Xv;function g1(){if(Xv)return Va;Xv=1;const e="[0-9]+",t="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const a="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;Va.KANJI=new RegExp(n,"g"),Va.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Va.BYTE=new RegExp(a,"g"),Va.NUMERIC=new RegExp(e,"g"),Va.ALPHANUMERIC=new RegExp(t,"g");const o=new RegExp("^"+n+"$"),i=new RegExp("^"+e+"$"),l=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Va.testKanji=function(d){return o.test(d)},Va.testNumeric=function(d){return i.test(d)},Va.testAlphanumeric=function(d){return l.test(d)},Va}var Qv;function ml(){return Qv||(Qv=1,(function(e){const t=m1(),n=g1();e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(i,l){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!t.isValid(l))throw new Error("Invalid version: "+l);return l>=1&&l<10?i.ccBits[0]:l<27?i.ccBits[1]:i.ccBits[2]},e.getBestModeForData=function(i){return n.testNumeric(i)?e.NUMERIC:n.testAlphanumeric(i)?e.ALPHANUMERIC:n.testKanji(i)?e.KANJI:e.BYTE},e.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},e.isValid=function(i){return i&&i.bit&&i.ccBits};function a(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+o)}}e.from=function(i,l){if(e.isValid(i))return i;try{return a(i)}catch{return l}}})(lh)),lh}var em;function U3(){return em||(em=1,(function(e){const t=vl(),n=v1(),a=Nf(),o=ml(),i=m1(),l=7973,c=t.getBCHDigit(l);function d(y,k,S){for(let x=1;x<=40;x++)if(k<=e.getCapacity(x,S,y))return x}function h(y,k){return o.getCharCountIndicator(y,k)+4}function f(y,k){let S=0;return y.forEach(function(x){const E=h(x.mode,k);S+=E+x.getBitsLength()}),S}function m(y,k){for(let S=1;S<=40;S++)if(f(y,S)<=e.getCapacity(S,k,o.MIXED))return S}e.from=function(k,S){return i.isValid(k)?parseInt(k,10):S},e.getCapacity=function(k,S,x){if(!i.isValid(k))throw new Error("Invalid QR Code version");typeof x>"u"&&(x=o.BYTE);const E=t.getSymbolTotalCodewords(k),$=n.getTotalCodewordsCount(k,S),w=(E-$)*8;if(x===o.MIXED)return w;const _=w-h(x,k);switch(x){case o.NUMERIC:return Math.floor(_/10*3);case o.ALPHANUMERIC:return Math.floor(_/11*2);case o.KANJI:return Math.floor(_/13);case o.BYTE:default:return Math.floor(_/8)}},e.getBestVersionForData=function(k,S){let x;const E=a.from(S,a.M);if(Array.isArray(k)){if(k.length>1)return m(k,E);if(k.length===0)return 1;x=k[0]}else x=k;return d(x.mode,x.getLength(),E)},e.getEncodedBits=function(k){if(!i.isValid(k)||k<7)throw new Error("Invalid QR Code version");let S=k<<12;for(;t.getBCHDigit(S)-c>=0;)S^=l<<t.getBCHDigit(S)-c;return k<<12|S}})(ih)),ih}var ch={},tm;function z3(){if(tm)return ch;tm=1;const e=vl(),t=1335,n=21522,a=e.getBCHDigit(t);return ch.getEncodedBits=function(i,l){const c=i.bit<<3|l;let d=c<<10;for(;e.getBCHDigit(d)-a>=0;)d^=t<<e.getBCHDigit(d)-a;return(c<<10|d)^n},ch}var uh={},dh,nm;function H3(){if(nm)return dh;nm=1;const e=ml();function t(n){this.mode=e.NUMERIC,this.data=n.toString()}return t.getBitsLength=function(a){return 10*Math.floor(a/3)+(a%3?a%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(a){let o,i,l;for(o=0;o+3<=this.data.length;o+=3)i=this.data.substr(o,3),l=parseInt(i,10),a.put(l,10);const c=this.data.length-o;c>0&&(i=this.data.substr(o),l=parseInt(i,10),a.put(l,c*3+1))},dh=t,dh}var hh,om;function V3(){if(om)return hh;om=1;const e=ml(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(a){this.mode=e.ALPHANUMERIC,this.data=a}return n.getBitsLength=function(o){return 11*Math.floor(o/2)+6*(o%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(o){let i;for(i=0;i+2<=this.data.length;i+=2){let l=t.indexOf(this.data[i])*45;l+=t.indexOf(this.data[i+1]),o.put(l,11)}this.data.length%2&&o.put(t.indexOf(this.data[i]),6)},hh=n,hh}var fh,am;function G3(){if(am)return fh;am=1;const e=ml();function t(n){this.mode=e.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return t.getBitsLength=function(a){return a*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(n){for(let a=0,o=this.data.length;a<o;a++)n.put(this.data[a],8)},fh=t,fh}var ph,sm;function q3(){if(sm)return ph;sm=1;const e=ml(),t=vl();function n(a){this.mode=e.KANJI,this.data=a}return n.getBitsLength=function(o){return o*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(a){let o;for(o=0;o<this.data.length;o++){let i=t.toSJIS(this.data[o]);if(i>=33088&&i<=40956)i-=33088;else if(i>=57408&&i<=60351)i-=49472;else throw new Error("Invalid SJIS character: "+this.data[o]+`
Make sure your charset is UTF-8`);i=(i>>>8&255)*192+(i&255),a.put(i,13)}},ph=n,ph}var vh={exports:{}},im;function j3(){return im||(im=1,(function(e){var t={single_source_shortest_paths:function(n,a,o){var i={},l={};l[a]=0;var c=t.PriorityQueue.make();c.push(a,0);for(var d,h,f,m,y,k,S,x,E;!c.empty();){d=c.pop(),h=d.value,m=d.cost,y=n[h]||{};for(f in y)y.hasOwnProperty(f)&&(k=y[f],S=m+k,x=l[f],E=typeof l[f]>"u",(E||x>S)&&(l[f]=S,c.push(f,S),i[f]=h))}if(typeof o<"u"&&typeof l[o]>"u"){var $=["Could not find a path from ",a," to ",o,"."].join("");throw new Error($)}return i},extract_shortest_path_from_predecessor_list:function(n,a){for(var o=[],i=a;i;)o.push(i),n[i],i=n[i];return o.reverse(),o},find_path:function(n,a,o){var i=t.single_source_shortest_paths(n,a,o);return t.extract_shortest_path_from_predecessor_list(i,o)},PriorityQueue:{make:function(n){var a=t.PriorityQueue,o={},i;n=n||{};for(i in a)a.hasOwnProperty(i)&&(o[i]=a[i]);return o.queue=[],o.sorter=n.sorter||a.default_sorter,o},default_sorter:function(n,a){return n.cost-a.cost},push:function(n,a){var o={value:n,cost:a};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(vh)),vh.exports}var lm;function W3(){return lm||(lm=1,(function(e){const t=ml(),n=H3(),a=V3(),o=G3(),i=q3(),l=g1(),c=vl(),d=j3();function h($){return unescape(encodeURIComponent($)).length}function f($,w,_){const I=[];let T;for(;(T=$.exec(_))!==null;)I.push({data:T[0],index:T.index,mode:w,length:T[0].length});return I}function m($){const w=f(l.NUMERIC,t.NUMERIC,$),_=f(l.ALPHANUMERIC,t.ALPHANUMERIC,$);let I,T;return c.isKanjiModeEnabled()?(I=f(l.BYTE,t.BYTE,$),T=f(l.KANJI,t.KANJI,$)):(I=f(l.BYTE_KANJI,t.BYTE,$),T=[]),w.concat(_,I,T).sort(function(M,R){return M.index-R.index}).map(function(M){return{data:M.data,mode:M.mode,length:M.length}})}function y($,w){switch(w){case t.NUMERIC:return n.getBitsLength($);case t.ALPHANUMERIC:return a.getBitsLength($);case t.KANJI:return i.getBitsLength($);case t.BYTE:return o.getBitsLength($)}}function k($){return $.reduce(function(w,_){const I=w.length-1>=0?w[w.length-1]:null;return I&&I.mode===_.mode?(w[w.length-1].data+=_.data,w):(w.push(_),w)},[])}function S($){const w=[];for(let _=0;_<$.length;_++){const I=$[_];switch(I.mode){case t.NUMERIC:w.push([I,{data:I.data,mode:t.ALPHANUMERIC,length:I.length},{data:I.data,mode:t.BYTE,length:I.length}]);break;case t.ALPHANUMERIC:w.push([I,{data:I.data,mode:t.BYTE,length:I.length}]);break;case t.KANJI:w.push([I,{data:I.data,mode:t.BYTE,length:h(I.data)}]);break;case t.BYTE:w.push([{data:I.data,mode:t.BYTE,length:h(I.data)}])}}return w}function x($,w){const _={},I={start:{}};let T=["start"];for(let B=0;B<$.length;B++){const M=$[B],R=[];for(let A=0;A<M.length;A++){const G=M[A],F=""+B+A;R.push(F),_[F]={node:G,lastCount:0},I[F]={};for(let j=0;j<T.length;j++){const K=T[j];_[K]&&_[K].node.mode===G.mode?(I[K][F]=y(_[K].lastCount+G.length,G.mode)-y(_[K].lastCount,G.mode),_[K].lastCount+=G.length):(_[K]&&(_[K].lastCount=G.length),I[K][F]=y(G.length,G.mode)+4+t.getCharCountIndicator(G.mode,w))}}T=R}for(let B=0;B<T.length;B++)I[T[B]].end=0;return{map:I,table:_}}function E($,w){let _;const I=t.getBestModeForData($);if(_=t.from(w,I),_!==t.BYTE&&_.bit<I.bit)throw new Error('"'+$+'" cannot be encoded with mode '+t.toString(_)+`.
 Suggested mode is: `+t.toString(I));switch(_===t.KANJI&&!c.isKanjiModeEnabled()&&(_=t.BYTE),_){case t.NUMERIC:return new n($);case t.ALPHANUMERIC:return new a($);case t.KANJI:return new i($);case t.BYTE:return new o($)}}e.fromArray=function(w){return w.reduce(function(_,I){return typeof I=="string"?_.push(E(I,null)):I.data&&_.push(E(I.data,I.mode)),_},[])},e.fromString=function(w,_){const I=m(w,c.isKanjiModeEnabled()),T=S(I),B=x(T,_),M=d.find_path(B.map,"start","end"),R=[];for(let A=1;A<M.length-1;A++)R.push(B.table[M[A]].node);return e.fromArray(k(R))},e.rawSplit=function(w){return e.fromArray(m(w,c.isKanjiModeEnabled()))}})(uh)),uh}var rm;function Z3(){if(rm)return Jd;rm=1;const e=vl(),t=Nf(),n=E3(),a=P3(),o=D3(),i=R3(),l=O3(),c=v1(),d=F3(),h=U3(),f=z3(),m=ml(),y=W3();function k(B,M){const R=B.size,A=i.getPositions(M);for(let G=0;G<A.length;G++){const F=A[G][0],j=A[G][1];for(let K=-1;K<=7;K++)if(!(F+K<=-1||R<=F+K))for(let J=-1;J<=7;J++)j+J<=-1||R<=j+J||(K>=0&&K<=6&&(J===0||J===6)||J>=0&&J<=6&&(K===0||K===6)||K>=2&&K<=4&&J>=2&&J<=4?B.set(F+K,j+J,!0,!0):B.set(F+K,j+J,!1,!0))}}function S(B){const M=B.size;for(let R=8;R<M-8;R++){const A=R%2===0;B.set(R,6,A,!0),B.set(6,R,A,!0)}}function x(B,M){const R=o.getPositions(M);for(let A=0;A<R.length;A++){const G=R[A][0],F=R[A][1];for(let j=-2;j<=2;j++)for(let K=-2;K<=2;K++)j===-2||j===2||K===-2||K===2||j===0&&K===0?B.set(G+j,F+K,!0,!0):B.set(G+j,F+K,!1,!0)}}function E(B,M){const R=B.size,A=h.getEncodedBits(M);let G,F,j;for(let K=0;K<18;K++)G=Math.floor(K/3),F=K%3+R-8-3,j=(A>>K&1)===1,B.set(G,F,j,!0),B.set(F,G,j,!0)}function $(B,M,R){const A=B.size,G=f.getEncodedBits(M,R);let F,j;for(F=0;F<15;F++)j=(G>>F&1)===1,F<6?B.set(F,8,j,!0):F<8?B.set(F+1,8,j,!0):B.set(A-15+F,8,j,!0),F<8?B.set(8,A-F-1,j,!0):F<9?B.set(8,15-F-1+1,j,!0):B.set(8,15-F-1,j,!0);B.set(A-8,8,1,!0)}function w(B,M){const R=B.size;let A=-1,G=R-1,F=7,j=0;for(let K=R-1;K>0;K-=2)for(K===6&&K--;;){for(let J=0;J<2;J++)if(!B.isReserved(G,K-J)){let ue=!1;j<M.length&&(ue=(M[j]>>>F&1)===1),B.set(G,K-J,ue),F--,F===-1&&(j++,F=7)}if(G+=A,G<0||R<=G){G-=A,A=-A;break}}}function _(B,M,R){const A=new n;R.forEach(function(J){A.put(J.mode.bit,4),A.put(J.getLength(),m.getCharCountIndicator(J.mode,B)),J.write(A)});const G=e.getSymbolTotalCodewords(B),F=c.getTotalCodewordsCount(B,M),j=(G-F)*8;for(A.getLengthInBits()+4<=j&&A.put(0,4);A.getLengthInBits()%8!==0;)A.putBit(0);const K=(j-A.getLengthInBits())/8;for(let J=0;J<K;J++)A.put(J%2?17:236,8);return I(A,B,M)}function I(B,M,R){const A=e.getSymbolTotalCodewords(M),G=c.getTotalCodewordsCount(M,R),F=A-G,j=c.getBlocksCount(M,R),K=A%j,J=j-K,ue=Math.floor(A/j),Z=Math.floor(F/j),se=Z+1,U=ue-Z,Q=new d(U);let oe=0;const he=new Array(j),Te=new Array(j);let je=0;const He=new Uint8Array(B.buffer);for(let re=0;re<j;re++){const ie=re<J?Z:se;he[re]=He.slice(oe,oe+ie),Te[re]=Q.encode(he[re]),oe+=ie,je=Math.max(je,ie)}const We=new Uint8Array(A);let be=0,V,Y;for(V=0;V<je;V++)for(Y=0;Y<j;Y++)V<he[Y].length&&(We[be++]=he[Y][V]);for(V=0;V<U;V++)for(Y=0;Y<j;Y++)We[be++]=Te[Y][V];return We}function T(B,M,R,A){let G;if(Array.isArray(B))G=y.fromArray(B);else if(typeof B=="string"){let ue=M;if(!ue){const Z=y.rawSplit(B);ue=h.getBestVersionForData(Z,R)}G=y.fromString(B,ue||40)}else throw new Error("Invalid data");const F=h.getBestVersionForData(G,R);if(!F)throw new Error("The amount of data is too big to be stored in a QR Code");if(!M)M=F;else if(M<F)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+F+`.
`);const j=_(M,R,G),K=e.getSymbolSize(M),J=new a(K);return k(J,M),S(J),x(J,M),$(J,R,0),M>=7&&E(J,M),w(J,j),isNaN(A)&&(A=l.getBestMask(J,$.bind(null,J,R))),l.applyMask(A,J),$(J,R,A),{modules:J,version:M,errorCorrectionLevel:R,maskPattern:A,segments:G}}return Jd.create=function(M,R){if(typeof M>"u"||M==="")throw new Error("No input text");let A=t.M,G,F;return typeof R<"u"&&(A=t.from(R.errorCorrectionLevel,t.M),G=h.from(R.version),F=l.from(R.maskPattern),R.toSJISFunc&&e.setToSJISFunction(R.toSJISFunc)),T(M,G,A,F)},Jd}var mh={},gh={},cm;function y1(){return cm||(cm=1,(function(e){function t(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let a=n.slice().replace("#","").split("");if(a.length<3||a.length===5||a.length>8)throw new Error("Invalid hex color: "+n);(a.length===3||a.length===4)&&(a=Array.prototype.concat.apply([],a.map(function(i){return[i,i]}))),a.length===6&&a.push("F","F");const o=parseInt(a.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:o&255,hex:"#"+a.slice(0,6).join("")}}e.getOptions=function(a){a||(a={}),a.color||(a.color={});const o=typeof a.margin>"u"||a.margin===null||a.margin<0?4:a.margin,i=a.width&&a.width>=21?a.width:void 0,l=a.scale||4;return{width:i,scale:i?4:l,margin:o,color:{dark:t(a.color.dark||"#000000ff"),light:t(a.color.light||"#ffffffff")},type:a.type,rendererOpts:a.rendererOpts||{}}},e.getScale=function(a,o){return o.width&&o.width>=a+o.margin*2?o.width/(a+o.margin*2):o.scale},e.getImageWidth=function(a,o){const i=e.getScale(a,o);return Math.floor((a+o.margin*2)*i)},e.qrToImageData=function(a,o,i){const l=o.modules.size,c=o.modules.data,d=e.getScale(l,i),h=Math.floor((l+i.margin*2)*d),f=i.margin*d,m=[i.color.light,i.color.dark];for(let y=0;y<h;y++)for(let k=0;k<h;k++){let S=(y*h+k)*4,x=i.color.light;if(y>=f&&k>=f&&y<h-f&&k<h-f){const E=Math.floor((y-f)/d),$=Math.floor((k-f)/d);x=m[c[E*l+$]?1:0]}a[S++]=x.r,a[S++]=x.g,a[S++]=x.b,a[S]=x.a}}})(gh)),gh}var um;function K3(){return um||(um=1,(function(e){const t=y1();function n(o,i,l){o.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=l,i.width=l,i.style.height=l+"px",i.style.width=l+"px"}function a(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(i,l,c){let d=c,h=l;typeof d>"u"&&(!l||!l.getContext)&&(d=l,l=void 0),l||(h=a()),d=t.getOptions(d);const f=t.getImageWidth(i.modules.size,d),m=h.getContext("2d"),y=m.createImageData(f,f);return t.qrToImageData(y.data,i,d),n(m,h,f),m.putImageData(y,0,0),h},e.renderToDataURL=function(i,l,c){let d=c;typeof d>"u"&&(!l||!l.getContext)&&(d=l,l=void 0),d||(d={});const h=e.render(i,l,d),f=d.type||"image/png",m=d.rendererOpts||{};return h.toDataURL(f,m.quality)}})(mh)),mh}var yh={},dm;function Y3(){if(dm)return yh;dm=1;const e=y1();function t(o,i){const l=o.a/255,c=i+'="'+o.hex+'"';return l<1?c+" "+i+'-opacity="'+l.toFixed(2).slice(1)+'"':c}function n(o,i,l){let c=o+i;return typeof l<"u"&&(c+=" "+l),c}function a(o,i,l){let c="",d=0,h=!1,f=0;for(let m=0;m<o.length;m++){const y=Math.floor(m%i),k=Math.floor(m/i);!y&&!h&&(h=!0),o[m]?(f++,m>0&&y>0&&o[m-1]||(c+=h?n("M",y+l,.5+k+l):n("m",d,0),d=0,h=!1),y+1<i&&o[m+1]||(c+=n("h",f),f=0)):d++}return c}return yh.render=function(i,l,c){const d=e.getOptions(l),h=i.modules.size,f=i.modules.data,m=h+d.margin*2,y=d.color.light.a?"<path "+t(d.color.light,"fill")+' d="M0 0h'+m+"v"+m+'H0z"/>':"",k="<path "+t(d.color.dark,"stroke")+' d="'+a(f,h,d.margin)+'"/>',S='viewBox="0 0 '+m+" "+m+'"',E='<svg xmlns="http://www.w3.org/2000/svg" '+(d.width?'width="'+d.width+'" height="'+d.width+'" ':"")+S+' shape-rendering="crispEdges">'+y+k+`</svg>
`;return typeof c=="function"&&c(null,E),E},yh}var hm;function J3(){if(hm)return Nl;hm=1;const e=A3(),t=Z3(),n=K3(),a=Y3();function o(i,l,c,d,h){const f=[].slice.call(arguments,1),m=f.length,y=typeof f[m-1]=="function";if(!y&&!e())throw new Error("Callback required as last argument");if(y){if(m<2)throw new Error("Too few arguments provided");m===2?(h=c,c=l,l=d=void 0):m===3&&(l.getContext&&typeof h>"u"?(h=d,d=void 0):(h=d,d=c,c=l,l=void 0))}else{if(m<1)throw new Error("Too few arguments provided");return m===1?(c=l,l=d=void 0):m===2&&!l.getContext&&(d=c,c=l,l=void 0),new Promise(function(k,S){try{const x=t.create(c,d);k(i(x,l,d))}catch(x){S(x)}})}try{const k=t.create(c,d);h(null,i(k,l,d))}catch(k){h(k)}}return Nl.create=t.create,Nl.toCanvas=o.bind(null,n.render),Nl.toDataURL=o.bind(null,n.renderToDataURL),Nl.toString=o.bind(null,function(i,l,c){return a.render(i,c)}),Nl}var X3=J3();const Q3=Yy(X3),eP={class:"qr-container"},tP={key:0,class:"qr-warning"},nP={key:1,class:"error-text"},oP={__name:"QrCodeModal",props:{show:{type:Boolean,default:!1},url:{type:String,required:!0},title:{type:String,default:"Scan QR code"},zIndex:{type:Number,default:1e3},warning:{type:String,default:""}},emits:["close"],setup(e){const t=e,n=P(null),a=P(""),o=async()=>{if(!(!n.value||!t.url)){a.value="";try{await Q3.toCanvas(n.value,t.url,{width:280,margin:2,color:{dark:"#000000",light:"#ffffff"}})}catch(i){console.error("Failed to generate QR code:",i),a.value="Failed to generate QR code"}}};return Ye(()=>[t.show,t.url],([i])=>{i&&t.url&&setTimeout(o,50)},{immediate:!0}),(i,l)=>(p(),ze(jt,{show:e.show,title:e.title,size:"small","z-index":e.zIndex,"confirm-on-close":!1,onClose:l[1]||(l[1]=c=>i.$emit("close"))},{actions:Ue(()=>[r("button",{onClick:l[0]||(l[0]=c=>i.$emit("close")),class:"btn btn-primary"},"Done")]),default:Ue(()=>[r("div",eP,[e.warning?(p(),g("p",tP,b(e.warning),1)):D("",!0),r("canvas",{ref_key:"canvasRef",ref:n,class:"qr-canvas"},null,512),a.value?(p(),g("p",nP,b(a.value),1)):D("",!0)])]),_:1},8,["show","title","z-index"]))}},Ff=Ze(oP,[["__scopeId","data-v-401727ed"]]),aP={class:"success-content"},sP={class:"success-message"},iP={class:"link-section"},lP={class:"help-text"},rP={key:0,class:"loading-text"},cP={key:1,class:"magic-link-container"},uP=["value"],dP={class:"magic-link-actions"},hP=["disabled"],fP={key:0,class:"success-text"},pP={key:1,class:"error-text"},vP={key:2,class:"error-text"},mP={__name:"MarshalCreatedModal",props:{show:{type:Boolean,default:!1},eventId:{type:String,required:!0},marshalId:{type:String,default:null},marshalName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const{terms:n}=ht(),a=e,o=t,i=P(""),l=P(!1),c=P(!1),d=P(""),h=P(!1),f=P(!1),m=P(!1),y=P(""),k=P(!1),S=async()=>{if(!(!a.eventId||!a.marshalId)){c.value=!0,d.value="";try{const w=await ka.getMagicLink(a.eventId,a.marshalId);i.value=w.data.magicLink,l.value=w.data.hasEmail}catch(w){console.error("Failed to fetch magic link:",w),d.value="Failed to load login link"}finally{c.value=!1}}},x=async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(i.value);else{const w=document.createElement("textarea");w.value=i.value,w.style.position="fixed",w.style.left="-9999px",document.body.appendChild(w),w.select(),document.execCommand("copy"),document.body.removeChild(w)}h.value=!0,setTimeout(()=>{h.value=!1},2e3)}catch(w){console.error("Failed to copy:",w)}},E=async()=>{if(!(!a.eventId||!a.marshalId)){f.value=!0,m.value=!1,y.value="";try{await ka.sendMagicLink(a.eventId,a.marshalId),m.value=!0,setTimeout(()=>{m.value=!1},3e3)}catch(w){console.error("Failed to send email:",w),y.value=w.response?.data?.message||"Failed to send email"}finally{f.value=!1}}},$=()=>{o("close")};return Ye(()=>a.show,w=>{w&&a.marshalId?S():(i.value="",l.value=!1,d.value="",h.value=!1,m.value=!1,y.value="",k.value=!1)},{immediate:!0}),(w,_)=>(p(),g(xe,null,[Ee(jt,{show:e.show,title:`${N(n).person} created`,size:"medium","confirm-on-close":!1,"is-dirty":!1,onClose:$},{actions:Ue(()=>[r("button",{onClick:$,class:"btn btn-primary"},"Done")]),default:Ue(()=>[r("div",aP,[_[4]||(_[4]=r("div",{class:"success-icon"},"",-1)),r("p",sP,[r("strong",null,b(e.marshalName),1),_[3]||(_[3]=Je(" has been added successfully. ",-1))])]),r("div",iP,[_[6]||(_[6]=r("label",null,"Login link",-1)),r("p",lP," Share this unique link with "+b(e.marshalName)+" so they can access their dashboard and check in. ",1),c.value?(p(),g("div",rP,"Loading link...")):i.value?(p(),g("div",cP,[r("input",{type:"text",value:i.value,readonly:"",class:"form-input magic-link-input",onFocus:_[0]||(_[0]=I=>I.target.select())},null,40,uP),r("div",dP,[r("button",{type:"button",class:"btn btn-secondary",onClick:x},b(h.value?"Copied!":"Copy link"),1),r("button",{type:"button",class:"btn btn-secondary",onClick:_[1]||(_[1]=I=>k.value=!0),title:"Show QR code"},[..._[5]||(_[5]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("rect",{x:"3",y:"3",width:"7",height:"7"}),r("rect",{x:"14",y:"3",width:"7",height:"7"}),r("rect",{x:"3",y:"14",width:"7",height:"7"}),r("rect",{x:"14",y:"14",width:"3",height:"3"}),r("rect",{x:"19",y:"14",width:"2",height:"2"}),r("rect",{x:"14",y:"19",width:"2",height:"2"}),r("rect",{x:"19",y:"19",width:"2",height:"2"})],-1)])]),l.value?(p(),g("button",{key:0,type:"button",class:"btn btn-primary",disabled:f.value,onClick:E},b(f.value?"Sending...":"Send via email"),9,hP)):D("",!0)]),m.value?(p(),g("p",fP,"Email sent successfully!")):D("",!0),y.value?(p(),g("p",pP,b(y.value),1)):D("",!0)])):d.value?(p(),g("div",vP,b(d.value),1)):D("",!0)])]),_:1},8,["show","title"]),Ee(Ff,{show:k.value,url:i.value,title:"Scan to log in","z-index":1100,onClose:_[2]||(_[2]=I=>k.value=!1)},null,8,["show","url"])],64))}},gP=Ze(mP,[["__scopeId","data-v-9aa97b04"]]),yP={class:"form-group"},kP={__name:"AddAdminModal",props:{show:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const n=e,a=t,o=P("");Ye(()=>n.show,d=>{d||(o.value="")});const i=()=>{a("update:isDirty",!0)},l=()=>{a("submit",o.value)},c=()=>{a("close")};return(d,h)=>(p(),ze(jt,{show:e.show,title:"Add event administrator",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:c},{actions:Ue(()=>[r("button",{type:"button",onClick:c,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-primary"}," Add administrator ")]),default:Ue(()=>[h[2]||(h[2]=r("p",{class:"instruction"},"Enter the email address of the administrator to add",-1)),r("form",{onSubmit:ct(l,["prevent"])},[r("div",yP,[h[1]||(h[1]=r("label",null,"Email address",-1)),Ge(r("input",{"onUpdate:modelValue":h[0]||(h[0]=f=>o.value=f),type:"email",required:"",class:"form-input",placeholder:"admin@example.com",onInput:i},null,544),[[st,o.value]])])],32)]),_:1},8,["show","is-dirty"]))}},bP=Ze(kP,[["__scopeId","data-v-a82da194"]]),_P={class:"form-group"},wP={key:0,class:"error"},CP=["disabled"],LP={__name:"UploadRouteModal",props:{show:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},error:{type:String,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const n=e,a=t,o=P(null);Ye(()=>n.show,d=>{d||(o.value=null)});const i=d=>{o.value=d.target.files[0],a("update:isDirty",!0)},l=()=>{o.value&&a("submit",o.value)},c=()=>{a("close")};return(d,h)=>(p(),ze(jt,{show:e.show,title:"Upload GPX route",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:c},{actions:Ue(()=>[r("button",{type:"button",onClick:c,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:l,class:"btn btn-primary",disabled:e.uploading},b(e.uploading?"Uploading...":"Upload route"),9,CP)]),default:Ue(()=>[h[1]||(h[1]=r("p",{class:"instruction"},"Upload a GPX file to display the event route on the map",-1)),r("form",{onSubmit:ct(l,["prevent"])},[r("div",_P,[h[0]||(h[0]=r("label",null,"GPX file",-1)),r("input",{type:"file",accept:".gpx",onChange:i,required:"",class:"form-input"},null,32)]),e.error?(p(),g("div",wP,b(e.error),1)):D("",!0)],32)]),_:1},8,["show","is-dirty"]))}},SP=Ze(LP,[["__scopeId","data-v-317975db"]]),IP={class:"instruction"},xP={class:"form-group"},$P={class:"form-group"},TP={class:"checkbox-label"},MP={key:0,class:"error"},AP={key:1,class:"import-result"},EP={key:0,class:"import-errors"},PP=["disabled"],DP={__name:"ImportLocationsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:n,termsLower:a}=ht(),o=e,i=t,l=P(null),c=P(!1);Ye(()=>o.show,y=>{y||(l.value=null,c.value=!1)});const d=y=>{l.value=y.target.files[0],i("update:isDirty",!0)},h=()=>{i("update:isDirty",!0)},f=()=>{l.value&&i("submit",{file:l.value,deleteExisting:c.value})},m=()=>{i("close")};return(y,k)=>(p(),ze(jt,{show:e.show,title:`Import ${N(a).checkpoints} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:m},{actions:Ue(()=>[r("button",{type:"button",onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-primary",disabled:e.importing},b(e.importing?"Importing...":`Import ${N(a).checkpoints}`),9,PP)]),default:Ue(()=>[r("p",IP,"Upload a CSV file with columns: Label, Lat/Latitude, Long/Longitude, What3Words (optional), "+b(N(n).people)+" (optional)",1),k[3]||(k[3]=r("div",{class:"csv-example"},[r("strong",null,"Example CSV format:"),r("pre",null,`Label,Latitude,Longitude,What3Words,Marshals
Checkpoint 1,51.505,-0.09,filled.count.soap,"John Doe, Jane Smith"
Checkpoint 2,51.510,-0.10,index.home.raft,Bob Wilson`)],-1)),r("form",{onSubmit:ct(f,["prevent"])},[r("div",xP,[k[1]||(k[1]=r("label",null,"CSV file",-1)),r("input",{type:"file",accept:".csv",onChange:d,required:"",class:"form-input"},null,32)]),r("div",$P,[r("label",TP,[Ge(r("input",{type:"checkbox","onUpdate:modelValue":k[0]||(k[0]=S=>c.value=S),onChange:h},null,544),[[xa,c.value]]),Je(" Delete existing "+b(N(a).checkpoints)+" before import ",1)])]),e.error?(p(),g("div",MP,b(e.error),1)):D("",!0),e.result?(p(),g("div",AP,[r("p",null,"Created "+b(e.result.locationsCreated)+" "+b(N(a).checkpoints)+" and "+b(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(p(),g("div",EP,[k[2]||(k[2]=r("strong",null,"Errors:",-1)),r("ul",null,[(p(!0),g(xe,null,qe(e.result.errors,(S,x)=>(p(),g("li",{key:x},b(S),1))),128))])])):D("",!0)])):D("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},RP=Ze(DP,[["__scopeId","data-v-75c79d31"]]),OP={class:"instruction"},BP={class:"form-group"},NP={key:0,class:"error"},FP={key:1,class:"import-result"},UP={key:0,class:"import-errors"},zP=["disabled"],HP={__name:"ImportMarshalsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:n,termsLower:a}=ht(),o=e,i=t,l=P(null);Ye(()=>o.show,f=>{f||(l.value=null)});const c=f=>{l.value=f.target.files[0],i("update:isDirty",!0)},d=()=>{l.value&&i("submit",l.value)},h=()=>{i("close")};return(f,m)=>(p(),ze(jt,{show:e.show,title:`Import ${N(a).people} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:h},{actions:Ue(()=>[r("button",{type:"button",onClick:h,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:d,class:"btn btn-primary",disabled:e.importing},b(e.importing?"Importing...":`Import ${N(a).people}`),9,zP)]),default:Ue(()=>[r("p",OP,"Upload a CSV file with columns: Name, Email (optional), Phone (optional), "+b(N(n).checkpoint)+" (optional)",1),m[2]||(m[2]=r("div",{class:"csv-example"},[r("strong",null,"Example CSV format:"),r("pre",null,`Name,Email,Phone,Checkpoint
John Doe,john@example.com,555-1234,Checkpoint 1
Jane Smith,jane@example.com,555-5678,Checkpoint 2`)],-1)),r("form",{onSubmit:ct(d,["prevent"])},[r("div",BP,[m[0]||(m[0]=r("label",null,"CSV file",-1)),r("input",{type:"file",accept:".csv",onChange:c,required:"",class:"form-input"},null,32)]),e.error?(p(),g("div",NP,b(e.error),1)):D("",!0),e.result?(p(),g("div",FP,[r("p",null,"Imported "+b(e.result.marshalsCreated)+" "+b(N(a).people)+" and "+b(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(p(),g("div",UP,[m[1]||(m[1]=r("strong",null,"Errors:",-1)),r("ul",null,[(p(!0),g(xe,null,qe(e.result.errors,(y,k)=>(p(),g("li",{key:k},b(y),1))),128))])])):D("",!0)])):D("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},VP=Ze(HP,[["__scopeId","data-v-be89bf1f"]]),GP=["onClick"],qP=["innerHTML"],jP={class:"hamburger-nav"},WP=["disabled"],ZP=["innerHTML"],KP={class:"current-tab-label"},YP=["disabled"],JP={key:0,class:"hamburger-menu"},XP=["onClick"],QP=["innerHTML"],e5=400,t5={__name:"TabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,a=t,o=P(null),i=P(null),l=P(null),c=P(!1),d=P(!1),h=z(()=>{const T=n.tabs.find(B=>B.value===n.modelValue);return T?T.label:""}),f=z(()=>n.tabs.find(B=>B.value===n.modelValue)?.icon||null),m=z(()=>n.tabs.findIndex(T=>T.value===n.modelValue)),y=z(()=>m.value>0),k=z(()=>m.value<n.tabs.length-1),S=()=>{y.value&&a("update:modelValue",n.tabs[m.value-1].value)},x=()=>{k.value&&a("update:modelValue",n.tabs[m.value+1].value)},E=()=>{if(!o.value)return;const T=o.value.clientWidth;if(T<e5){c.value=!0;return}if(i.value&&!c.value){i.value.scrollWidth>T&&(c.value=!0);return}const B=n.tabs.some(A=>A.icon)?110:90,M=n.tabs.length*B,R=(n.tabs.length-1)*8;M+R<=T&&(c.value=!1,dn(()=>{i.value&&i.value.scrollWidth>T&&(c.value=!0)}))},$=()=>{d.value=!d.value},w=T=>{a("update:modelValue",T),d.value=!1},_=T=>{l.value&&!l.value.contains(T.target)&&(d.value=!1)};let I=null;return rn(()=>{dn(()=>{E(),o.value&&typeof ResizeObserver<"u"&&(I=new ResizeObserver(()=>{E()}),I.observe(o.value)),document.addEventListener("click",_)})}),An(()=>{I&&I.disconnect(),document.removeEventListener("click",_)}),Ye(()=>n.tabs,()=>{dn(()=>{E()})},{deep:!0}),(T,B)=>(p(),g("div",{class:"tabs-container",ref_key:"containerRef",ref:o},[c.value?(p(),g("div",{key:1,class:"hamburger-container",ref_key:"hamburgerRef",ref:l},[r("div",jP,[r("button",{class:le(["nav-arrow",{invisible:!y.value}]),onClick:S,type:"button","aria-label":"Previous tab",disabled:!y.value},"  ",10,WP),r("button",{class:"hamburger-button",onClick:$,type:"button","aria-label":"Tab menu"},[f.value?(p(),g("span",{key:0,class:"current-tab-icon",innerHTML:N(bo)(f.value)},null,8,ZP)):D("",!0),r("span",KP,b(h.value),1),B[0]||(B[0]=r("span",{class:"hamburger-chevron"},"",-1))]),r("button",{class:le(["nav-arrow",{invisible:!k.value}]),onClick:x,type:"button","aria-label":"Next tab",disabled:!k.value},"  ",10,YP)]),d.value?(p(),g("div",JP,[(p(!0),g(xe,null,qe(e.tabs,M=>(p(),g("button",{key:M.value,class:le(["menu-item",{active:e.modelValue===M.value}]),onClick:R=>w(M.value),type:"button"},[M.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:N(bo)(M.icon)},null,8,QP)):D("",!0),Je(" "+b(M.label),1)],10,XP))),128))])):D("",!0)],512)):(p(),g("div",{key:0,class:"tabs",ref_key:"tabsRef",ref:i},[(p(!0),g(xe,null,qe(e.tabs,M=>(p(),g("button",{key:M.value,class:le(["tab-button",{active:e.modelValue===M.value}]),onClick:R=>T.$emit("update:modelValue",M.value),type:"button"},[M.icon?(p(),g("span",{key:0,class:"tab-icon",innerHTML:N(bo)(M.icon)},null,8,qP)):D("",!0),Je(" "+b(M.label),1)],10,GP))),128))],512))],512))}},gl=Ze(t5,[["__scopeId","data-v-736c5d0a"]]),n5={class:"tab-content"},o5={class:"form-group"},a5=["value"],s5={class:"form-group"},i5=["value"],l5={class:"form-group"},r5={class:"area-display"},c5={key:0,class:"no-area"},u5={class:"form-help"},d5={class:"form-group checkbox-group"},h5={class:"checkbox-label"},f5=["checked"],p5={class:"form-help"},v5={key:0,class:"custom-times-section"},m5={class:"form-group"},g5=["value"],y5={class:"form-help"},k5={class:"form-group"},b5=["value"],_5={class:"form-help"},w5={__name:"LocationDetailsTab",props:{form:{type:Object,required:!0},areas:{type:Array,default:()=>[]},eventDate:{type:String,default:""},areaTermSingular:{type:String,default:"Area"},areaTermPlural:{type:String,default:"Areas"},checkpointTermSingular:{type:String,default:"checkpoint"},peopleTermPlural:{type:String,default:"marshals"}},emits:["update:form","input","save"],setup(e,{emit:t}){const n=e,a=t,o=z(()=>(n.form.areaIds||n.form.AreaIds||[]).map(d=>n.areas.find(h=>h.id===d)).filter(d=>d!==void 0)),i=(c,d)=>{a("update:form",{...n.form,[c]:d}),a("input")},l=c=>{const d={...n.form,useCustomTimes:c};if(!c)d.startTime="",d.endTime="";else if(!d.startTime&&!d.endTime&&n.eventDate){const h=ic(n.eventDate);d.startTime=h,d.endTime=h}a("update:form",d),a("input")};return(c,d)=>(p(),g("div",n5,[r("form",{onSubmit:d[5]||(d[5]=ct(h=>c.$emit("save"),["prevent"]))},[r("div",o5,[d[6]||(d[6]=r("label",null,"Name",-1)),r("input",{value:e.form.name,onInput:d[0]||(d[0]=h=>i("name",h.target.value)),type:"text",required:"",class:"form-input"},null,40,a5)]),r("div",s5,[d[7]||(d[7]=r("label",null,"Description (optional)",-1)),r("input",{value:e.form.description,onInput:d[1]||(d[1]=h=>i("description",h.target.value)),type:"text",class:"form-input"},null,40,i5)]),r("div",l5,[r("label",null,b(e.areaTermSingular)+" (auto-assigned by location)",1),r("div",r5,[o.value.length===0?(p(),g("span",c5," Not in any "+b(e.areaTermSingular.toLowerCase())+" polygon ",1)):D("",!0),(p(!0),g(xe,null,qe(o.value,h=>(p(),g("span",{key:h.id,class:"area-badge",style:nt({backgroundColor:h.color||"var(--brand-primary)"})},b(h.name),5))),128))]),r("small",u5,b(e.areaTermPlural)+" are automatically assigned based on "+b(e.checkpointTermSingular.toLowerCase())+" location within "+b(e.areaTermSingular.toLowerCase())+" boundaries ",1)]),r("div",d5,[r("label",h5,[r("input",{checked:e.form.useCustomTimes,onChange:d[2]||(d[2]=h=>l(h.target.checked)),type:"checkbox"},null,40,f5),r("span",null,"Use custom date/time for this "+b(e.checkpointTermSingular.toLowerCase()),1)]),r("small",p5," By default, "+b(e.peopleTermPlural.toLowerCase())+" are expected during the event date/time. Enable this to set a specific time range. ",1)]),e.form.useCustomTimes?(p(),g("div",v5,[r("div",m5,[d[8]||(d[8]=r("label",null,"Start date & time (optional)",-1)),r("input",{value:e.form.startTime,onInput:d[3]||(d[3]=h=>i("startTime",h.target.value)),type:"datetime-local",class:"form-input"},null,40,g5),r("small",y5," When "+b(e.peopleTermPlural.toLowerCase())+" should arrive at this "+b(e.checkpointTermSingular.toLowerCase()),1)]),r("div",k5,[d[9]||(d[9]=r("label",null,"End date & time (optional)",-1)),r("input",{value:e.form.endTime,onInput:d[4]||(d[4]=h=>i("endTime",h.target.value)),type:"datetime-local",class:"form-input"},null,40,b5),r("small",_5," When "+b(e.peopleTermPlural.toLowerCase())+" can leave this "+b(e.checkpointTermSingular.toLowerCase()),1)])])):D("",!0)],32)]))}},C5=Ze(w5,[["__scopeId","data-v-aa628901"]]),L5={class:"scope-configuration-editor"},S5={class:"editor-header"},I5={class:"scope-types-list"},x5=["onClick"],$5={class:"scope-type-label"},T5={class:"scope-type-pill"},M5={class:"expand-label"},A5={class:"expand-icon"},E5={class:"modal-content"},P5={class:"modal-header"},D5={class:"modal-body"},R5={class:"scope-help"},O5={key:0,class:"form-group"},B5={class:"checkbox-label special-option"},N5=["checked"],F5={key:0,class:"specific-selection"},U5=["placeholder"],z5={class:"checkbox-group scrollable"},H5=["checked","onChange"],V5={key:1,class:"form-group"},G5={class:"checkbox-label special-option"},q5=["checked"],j5={key:0,class:"specific-selection"},W5={class:"checkbox-group scrollable"},Z5=["checked","onChange"],K5={key:2,class:"form-group"},Y5={class:"checkbox-label special-option"},J5=["checked"],X5={key:0,class:"specific-selection"},Q5=["placeholder"],e6={class:"checkbox-group scrollable"},t6={key:0,class:"checkbox-label this-checkpoint-option"},n6=["checked"],o6={class:"checkpoint-info"},a6={class:"checkpoint-name"},s6=["checked","onChange"],i6={class:"checkpoint-info"},l6={class:"checkpoint-name"},r6={key:0,class:"checkpoint-description"},c6={__name:"ScopeConfigurationEditor",props:{modelValue:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},excludeScopes:{type:Array,default:()=>[]},headerText:{type:String,default:""},intent:{type:String,default:"completion",validator:e=>["completion","location-update"].includes(e)},currentCheckpointId:{type:String,default:null}},emits:["update:modelValue","user-changed"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=z(()=>[{scope:"SpecificPeople",label:`Specific ${n.value.people}`},{scope:"EveryoneAtCheckpoints",label:`Every ${n.value.person} at specified ${n.value.checkpoints}`},{scope:"OnePerCheckpoint",label:`One ${n.value.person} at each specified ${n.value.checkpoint}`},{scope:"OnePerArea",label:`One ${n.value.person} in specified ${n.value.areas}`},{scope:"EveryoneInAreas",label:`Everyone in specified ${n.value.areas}`},{scope:"EveryAreaLead",label:`Every ${n.value.area} lead at specified ${n.value.areas}`},{scope:"OneLeadPerArea",label:`One lead per specified ${n.value.area}`}]),l=P({SpecificPeople:{enabled:!0,ids:["ALL_MARSHALS"]},EveryoneInAreas:{enabled:!1,ids:[]},EveryoneAtCheckpoints:{enabled:!1,ids:[]},OnePerCheckpoint:{enabled:!1,ids:[]},OnePerArea:{enabled:!1,ids:[]},EveryAreaLead:{enabled:!1,ids:[]},OneLeadPerArea:{enabled:!1,ids:[]}}),c=P(null),d=P(""),h=P(""),f=P(!a.isEditing);let m=!0,y=!1;const k=z(()=>i.value.filter(ie=>!a.excludeScopes.includes(ie.scope))),S=z(()=>f.value?k.value:k.value.filter(ie=>G(ie.scope))),x=z(()=>k.value.filter($e=>G($e.scope)).length<k.value.length),E=z(()=>{const ie=k.value.filter($e=>G($e.scope)).length;return k.value.length-ie}),$=z(()=>!a.currentCheckpointId&&a.intent==="location-update");Ye(()=>a.modelValue,ie=>{if(ie){if(y){y=!1;return}m=!0,Object.keys(l.value).forEach($e=>{l.value[$e]={enabled:!1,ids:[]}}),ie.forEach($e=>{$e.scope==="Everyone"?l.value.SpecificPeople={enabled:!0,ids:["ALL_MARSHALS"]}:$e.scope==="AreaLead"?l.value.EveryAreaLead={enabled:!0,ids:[...$e.ids]}:l.value[$e.scope]&&(l.value[$e.scope]={enabled:!0,ids:[...$e.ids]})}),m=!1}},{immediate:!0});const w=()=>{const ie=[];return Object.keys(l.value).forEach($e=>{const q=l.value[$e];if(q.enabled){const X={scope:$e,itemType:_($e),ids:[...q.ids]};ie.push(X)}}),ie};Ye(l,()=>{if(m)return;if(Object.keys(l.value).some(q=>q!=="SpecificPeople"&&l.value[q].enabled)&&l.value.SpecificPeople?.ids.includes("ALL_MARSHALS")){const q=l.value.SpecificPeople.ids.indexOf("ALL_MARSHALS");l.value.SpecificPeople.ids.splice(q,1),l.value.SpecificPeople.ids.length===0&&(l.value.SpecificPeople.enabled=!1)}y=!0;const $e=w();o("update:modelValue",$e),o("user-changed")},{deep:!0});const _=ie=>I(ie)?"Area":T(ie)?"Checkpoint":B(ie)?"Marshal":null,I=ie=>ie==="EveryoneInAreas"||ie==="OnePerArea"||ie==="EveryAreaLead"||ie==="OneLeadPerArea",T=ie=>ie==="EveryoneAtCheckpoints"||ie==="OnePerCheckpoint",B=ie=>ie==="SpecificPeople",M=ie=>{const $e=i.value.find(q=>q.scope===ie);return $e?$e.label:ie},R=z(()=>a.headerText?a.headerText:a.intent==="location-update"?"Who can update this location?":`Who can see and complete this ${n.value.checklist}?`),A=ie=>a.intent==="location-update"?{SpecificPeople:`Select "Everyone" or choose specific ${n.value.people} who can update the location`,EveryoneAtCheckpoints:`Every ${n.value.person} at the selected ${n.value.checkpoints} can update the location`,OnePerCheckpoint:`Any ${n.value.person} at each selected ${n.value.checkpoint} can update the location`,OnePerArea:`Any ${n.value.person} in each selected ${n.value.area} can update the location`,EveryoneInAreas:`Every ${n.value.person} in the selected ${n.value.areas} can update the location`,EveryAreaLead:`Every ${n.value.area} lead at the selected ${n.value.areas} can update the location`,OneLeadPerArea:`Any ${n.value.area} lead at the selected ${n.value.areas} can update the location`}[ie]||"":{SpecificPeople:`Select "Everyone at the event" or choose specific ${n.value.people} who must complete this (personal completion)`,EveryoneAtCheckpoints:`Every ${n.value.person} at the selected ${n.value.checkpoints} must complete this (personal completion)`,OnePerCheckpoint:`One completion needed at each selected ${n.value.checkpoint} (shared completion)`,OnePerArea:`One completion needed in each selected ${n.value.area} (shared completion)`,EveryoneInAreas:`Every ${n.value.person} in the selected ${n.value.areas} must complete this (personal completion)`,EveryAreaLead:`Every ${n.value.area} lead at the selected ${n.value.areas} must complete this individually (personal completion)`,OneLeadPerArea:`One completion per ${n.value.area}, only ${n.value.area} leads can complete (shared among leads)`}[ie]||"",G=ie=>l.value[ie]?.enabled||!1,F=ie=>{const $e=l.value[ie];if(!$e||!$e.enabled)return"No";const q=$e.ids||[];if(I(ie)){if(q.includes("ALL_AREAS"))return`All ${n.value.areas}`;const X=q.length;return X>0?`${X} ${X!==1?n.value.areas:n.value.area}`:`Select ${n.value.areas}...`}if(T(ie)){if(q.includes("ALL_CHECKPOINTS"))return`All ${n.value.checkpoints}`;if(q.length===1&&q[0]==="THIS_CHECKPOINT")return`This ${n.value.checkpoint}`;const X=q.length;return X>0?`${X} ${X!==1?n.value.checkpoints:n.value.checkpoint}`:`Select ${n.value.checkpoints}...`}if(B(ie)){if(q.includes("ALL_MARSHALS"))return"Everyone";const X=q.length;return X>0?`${X} ${X!==1?n.value.people:n.value.person}`:`Select ${n.value.people}...`}return"Configured"},j=ie=>{c.value=ie,d.value="",h.value=""},K=()=>{c.value=null},J=()=>{c.value&&(l.value[c.value]={enabled:!1,ids:[]}),K()},ue=()=>c.value&&l.value[c.value]?.ids.includes("ALL_MARSHALS"),Z=()=>{if(!c.value)return;const ie=l.value[c.value];ue()?(ie.ids=[],ie.enabled=!1):(ie.ids=["ALL_MARSHALS"],ie.enabled=!0)},se=ie=>c.value&&l.value[c.value]?.ids.includes(ie),U=ie=>{if(!c.value)return;const $e=l.value[c.value],q=$e.ids.indexOf(ie);q>=0?($e.ids.splice(q,1),$e.ids.length===0&&($e.enabled=!1)):($e.ids.push(ie),$e.enabled=!0)},Q=()=>{let ie=a.marshals;if(h.value){const q=h.value.toLowerCase();ie=ie.filter(X=>X.name.toLowerCase().includes(q)||X.email&&X.email.toLowerCase().includes(q))}const $e=c.value?l.value[c.value]?.ids||[]:[];return[...ie].sort((q,X)=>{const ee=$e.includes(q.id),Ce=$e.includes(X.id);return ee&&!Ce?-1:!ee&&Ce?1:q.name.localeCompare(X.name,void 0,{sensitivity:"base"})})},oe=()=>c.value&&l.value[c.value]?.ids.includes("ALL_AREAS"),he=()=>{if(!c.value)return;const ie=l.value[c.value];oe()?(ie.ids=[],ie.enabled=!1):(ie.ids=["ALL_AREAS"],ie.enabled=!0)},Te=ie=>c.value&&l.value[c.value]?.ids.includes(ie),je=()=>{const ie=c.value?l.value[c.value]?.ids||[]:[];return[...a.areas].sort(($e,q)=>{const X=ie.includes($e.id),ee=ie.includes(q.id);return X&&!ee?-1:!X&&ee?1:$e.name.localeCompare(q.name,void 0,{sensitivity:"base"})})},He=ie=>{if(!c.value)return;const $e=l.value[c.value],q=$e.ids.indexOf(ie);q>=0?($e.ids.splice(q,1),$e.ids.length===0&&($e.enabled=!1)):($e.ids.push(ie),$e.enabled=!0)},We=()=>c.value&&l.value[c.value]?.ids.includes("ALL_CHECKPOINTS"),be=()=>{if(!c.value)return;const ie=l.value[c.value];We()?(ie.ids=[],ie.enabled=!1):(ie.ids=["ALL_CHECKPOINTS"],ie.enabled=!0)},V=ie=>c.value&&l.value[c.value]?.ids.includes(ie),Y=ie=>{if(!c.value)return;const $e=l.value[c.value],q=$e.ids.indexOf(ie);q>=0?($e.ids.splice(q,1),$e.ids.length===0&&($e.enabled=!1)):($e.ids.push(ie),$e.enabled=!0)},re=()=>{let ie=a.locations;if(d.value){const q=d.value.toLowerCase();ie=ie.filter(X=>X.name.toLowerCase().includes(q)||X.description&&X.description.toLowerCase().includes(q))}const $e=c.value?l.value[c.value]?.ids||[]:[];return[...ie].sort((q,X)=>{const ee=$e.includes(q.id),Ce=$e.includes(X.id);return ee&&!Ce?-1:!ee&&Ce?1:na(q.name,X.name)})};return(ie,$e)=>(p(),g("div",L5,[r("div",S5,[r("h4",null,b(R.value),1)]),r("div",I5,[(p(!0),g(xe,null,qe(S.value,q=>(p(),g("div",{key:q.scope,class:le(["scope-type-row",{active:G(q.scope)}]),onClick:X=>j(q.scope)},[r("div",$5,b(q.label),1),r("div",T5,b(F(q.scope)),1)],10,x5))),128)),x.value?(p(),g("div",{key:0,class:"expand-row",onClick:$e[0]||($e[0]=q=>f.value=!f.value)},[r("div",M5,b(f.value?"Show less":`Show ${E.value} more option${E.value!==1?"s":""}...`),1),r("div",A5,b(f.value?"":""),1)])):D("",!0)]),c.value?(p(),g("div",{key:0,class:"scope-config-modal",onClick:ct(K,["self"])},[r("div",E5,[r("div",P5,[r("h5",null,b(M(c.value)),1),r("button",{onClick:K,class:"btn-close",type:"button"},"")]),r("div",D5,[r("p",R5,b(A(c.value)),1),B(c.value)?(p(),g("div",O5,[r("label",B5,[r("input",{type:"checkbox",checked:ue(),onChange:Z},null,40,N5),r("span",null,[$e[4]||($e[4]=r("strong",null,"Everyone at the event",-1)),Je(" (all current and future "+b(N(n).people)+")",1)])]),ue()?D("",!0):(p(),g("div",F5,[Ge(r("input",{"onUpdate:modelValue":$e[1]||($e[1]=q=>h.value=q),type:"text",placeholder:`Search ${N(n).people}...`,class:"search-input"},null,8,U5),[[st,h.value]]),r("div",z5,[(p(!0),g(xe,null,qe(Q(),q=>(p(),g("label",{key:q.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:se(q.id),onChange:X=>U(q.id)},null,40,H5),r("span",null,b(q.name),1)]))),128))])]))])):D("",!0),I(c.value)?(p(),g("div",V5,[r("label",G5,[r("input",{type:"checkbox",checked:oe(),onChange:he},null,40,q5),r("span",null,[r("strong",null,"All "+b(N(n).areas),1),Je(" (includes future "+b(N(n).areas)+")",1)])]),oe()?D("",!0):(p(),g("div",j5,[r("div",W5,[(p(!0),g(xe,null,qe(je(),q=>(p(),g("label",{key:q.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:Te(q.id),onChange:X=>He(q.id)},null,40,Z5),r("span",{class:"area-color-dot",style:nt({backgroundColor:q.color||"#667eea"})},null,4),r("span",null,b(q.name),1)]))),128))])]))])):D("",!0),T(c.value)?(p(),g("div",K5,[r("label",Y5,[r("input",{type:"checkbox",checked:We(),onChange:be},null,40,J5),r("span",null,[r("strong",null,"All "+b(N(n).checkpoints),1),Je(" (includes future "+b(N(n).checkpoints)+")",1)])]),We()?D("",!0):(p(),g("div",X5,[Ge(r("input",{"onUpdate:modelValue":$e[2]||($e[2]=q=>d.value=q),type:"text",placeholder:`Search ${N(n).checkpoints}...`,class:"search-input"},null,8,Q5),[[st,d.value]]),r("div",e6,[$.value?(p(),g("label",t6,[r("input",{type:"checkbox",checked:V("THIS_CHECKPOINT"),onChange:$e[3]||($e[3]=q=>Y("THIS_CHECKPOINT"))},null,40,n6),r("div",o6,[r("span",a6,[r("strong",null,"This "+b(N(n).checkpoint),1)])])])):D("",!0),(p(!0),g(xe,null,qe(re(),q=>(p(),g("label",{key:q.id,class:"checkbox-label"},[r("input",{type:"checkbox",checked:V(q.id),onChange:X=>Y(q.id)},null,40,s6),r("div",i6,[r("span",l6,b(q.name),1),q.description?(p(),g("span",r6," - "+b(q.description),1)):D("",!0)])]))),128))])]))])):D("",!0)]),r("div",{class:"modal-footer"},[r("button",{onClick:J,class:"btn btn-secondary",type:"button"},"Deselect all"),r("button",{onClick:K,class:"btn btn-primary",type:"button"},"Done")])])])):D("",!0)]))}},td=Ze(c6,[["__scopeId","data-v-d465703e"]]),u6={class:"tab-content"},d6={class:"form-group"},h6=["value"],f6={key:0,class:"form-error"},p6={class:"form-row"},v6={class:"form-group"},m6=["disabled"],g6={class:"form-group"},y6=["disabled"],k6={class:"form-group"},b6={class:"accordion-item"},_6={class:"accordion-preview"},w6={class:"accordion-arrow"},C6={key:0,class:"accordion-content"},L6={class:"section-description"},S6={class:"dynamic-checkbox"},I6=["checked"],x6={key:0,class:"dynamic-settings"},$6={__name:"LocationCoordinatesTab",props:{form:{type:Object,required:!0},isMoving:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:"Checkpoint"},peopleTermPlural:{type:String,default:"Marshals"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:form","input","save","move-location"],setup(e,{emit:t}){const n=e,a=t,o=P(!1),i=P(""),l=P(""),c=k=>k==null||k===""||isNaN(k)?"":Number(k).toFixed(6);Ye(()=>n.form.longitude,k=>{i.value=c(k)},{immediate:!0}),Ye(()=>n.form.latitude,k=>{l.value=c(k)},{immediate:!0});const d=k=>{const S=k==="longitude"?i:l,x=parseFloat(S.value);isNaN(x)?S.value.trim()===""&&(a("update:form",{...n.form,[k]:0}),a("input"),S.value=c(0)):(a("update:form",{...n.form,[k]:x}),a("input"),S.value=c(x))},h=(k,S)=>{a("update:form",{...n.form,[k]:S}),a("input")},f=k=>{if(k){const x=[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[n.form.id||"THIS_CHECKPOINT"]}];a("update:form",{...n.form,isDynamic:!0,latitude:0,longitude:0,locationUpdateScopeConfigurations:x})}else a("update:form",{...n.form,isDynamic:!1});a("input")},m=k=>{a("update:form",{...n.form,locationUpdateScopeConfigurations:k}),a("input")},y=k=>{if(!k)return!0;const S=k.includes(".")?k.split("."):k.split("/");if(S.length!==3)return!1;const x=/^[a-z]{1,20}$/;return S.every(E=>x.test(E))};return(k,S)=>(p(),g("div",u6,[r("form",{onSubmit:S[6]||(S[6]=ct(x=>k.$emit("save"),["prevent"]))},[r("div",d6,[S[10]||(S[10]=r("label",null,"What3Words (optional)",-1)),r("input",{value:e.form.what3Words,onInput:S[0]||(S[0]=x=>h("what3Words",x.target.value)),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap"},null,40,h6),e.form.what3Words&&!y(e.form.what3Words)?(p(),g("small",f6," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):D("",!0)]),e.form.isDynamic?D("",!0):(p(),g(xe,{key:0},[r("div",p6,[r("div",v6,[S[11]||(S[11]=r("label",null,"Longitude",-1)),Ge(r("input",{"onUpdate:modelValue":S[1]||(S[1]=x=>i.value=x),onBlur:S[2]||(S[2]=x=>d("longitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., -0.091234"},null,40,m6),[[st,i.value]])]),r("div",g6,[S[12]||(S[12]=r("label",null,"Latitude",-1)),Ge(r("input",{"onUpdate:modelValue":S[3]||(S[3]=x=>l.value=x),onBlur:S[4]||(S[4]=x=>d("latitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., 51.505123"},null,40,y6),[[st,l.value]])])]),r("div",k6,[r("button",{type:"button",onClick:S[5]||(S[5]=x=>k.$emit("move-location")),class:le(["btn btn-secondary btn-with-icon",{"btn-primary":e.isMoving}])},[S[13]||(S[13]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),Je(" "+b(e.isMoving?"Click on map to set new location...":`Move ${e.checkpointTermSingular.toLowerCase()}...`),1)],2)])],64))],32),r("div",b6,[r("button",{type:"button",class:le(["accordion-header",{expanded:o.value}]),onClick:S[7]||(S[7]=x=>o.value=!o.value)},[S[14]||(S[14]=fi('<div class="accordion-icon" data-v-bd432637><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-bd432637><path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="#F59E0B" opacity="0.3" data-v-bd432637></path><path d="M12 6L13.5 9L17 9.5L14.5 12L15 15.5L12 14L9 15.5L9.5 12L7 9.5L10.5 9L12 6Z" fill="#F59E0B" data-v-bd432637></path><circle cx="12" cy="11" r="2" fill="white" data-v-bd432637></circle></svg></div><span class="accordion-title" data-v-bd432637>Dynamic location</span>',2)),r("span",_6,b(e.form.isDynamic?"Enabled":"Disabled"),1),r("span",w6,b(o.value?"":""),1)],2),o.value?(p(),g("div",C6,[r("p",L6," Enable this for lead cars, sweep vehicles, or other moving "+b(e.checkpointTermSingular.toLowerCase())+"s whose location can be updated by designated "+b(e.peopleTermPlural.toLowerCase())+" during the event. ",1),r("label",S6,[r("input",{type:"checkbox",checked:e.form.isDynamic,onChange:S[8]||(S[8]=x=>f(x.target.checked))},null,40,I6),r("span",null,"This "+b(e.checkpointTermSingular.toLowerCase())+" can move",1)]),e.form.isDynamic?(p(),g("div",x6,[Ee(td,{"model-value":e.form.locationUpdateScopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":e.isEditing,"header-text":`Who can update this ${e.checkpointTermSingular.toLowerCase()}'s location?`,"exclude-scopes":["OnePerCheckpoint","OneLeadPerArea","OnePerArea"],intent:"location-update","current-checkpoint-id":e.form.id,"onUpdate:modelValue":m,onUserChanged:S[9]||(S[9]=x=>k.$emit("input"))},null,8,["model-value","areas","locations","marshals","is-editing","header-text","current-checkpoint-id"])])):D("",!0)])):D("",!0)])]))}},T6=Ze($6,[["__scopeId","data-v-bd432637"]]);function k1(e){const t=P(new Map),n=f=>t.value.has(f.id)?t.value.get(f.id):f.isCheckedIn;return{pendingCheckInChanges:t,getEffectiveCheckInStatus:n,handleToggleCheckIn:f=>{const y=!n(f);y===f.isCheckedIn?t.value.delete(f.id):t.value.set(f.id,y),e&&e()},getStatusIcon:f=>n(f)?"":"",getStatusColor:f=>n(f)?"#28a745":"#dc3545",getStatusText:f=>n(f)?"Checked in":"Not checked in",formatTime:f=>f?new Date(f).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",clearPendingChanges:()=>{t.value.clear()},getPendingChanges:()=>Array.from(t.value.entries()).map(([f,m])=>({assignmentId:f,shouldBeCheckedIn:m}))}}const M6={class:"card-main"},A6={class:"card-title"},E6={class:"marshal-name"},P6={key:0,class:"card-check-in"},D6={class:"toggle-icon"},R6={class:"toggle-label"},O6={key:0,class:"check-in-time"},B6={key:0,class:"check-in-method"},N6={key:1,class:"unsaved-indicator"},F6={key:1,class:"card-status-readonly"},U6={class:"status-icon"},z6={key:0,class:"check-in-time"},H6={key:0,class:"check-in-method"},V6={key:2,class:"card-badge"},G6={key:3,class:"card-badge"},q6={__name:"MarshalAssignmentCard",props:{assignment:{type:Object,required:!0},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},location:{type:Object,default:null}},emits:["click","toggle-check-in","remove","undo-remove","distance-click"],setup(e,{emit:t}){const n=e,a=t,o=()=>{a("distance-click",n.assignment)},i=y=>y?new Date(y).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",l=z(()=>{const{checkedInBy:y,checkInMethod:k,marshalName:S}=n.assignment;return y&&y!==S?y:k||""}),c=z(()=>!n.assignment.isPending&&!n.isMarkedForRemoval&&!n.readOnly),d=z(()=>{const{checkInLatitude:y,checkInLongitude:k}=n.assignment,S=n.location;return!y||!k||!S?.latitude||!S?.longitude?null:dl(y,k,S.latitude,S.longitude)}),h=z(()=>d.value===null?null:d2(d.value)),f=z(()=>d.value===null?"":d.value<=50?"distance-close":d.value<=100?"distance-medium":"distance-far"),m=()=>{c.value&&a("click",n.assignment)};return(y,k)=>(p(),g("div",{class:le(["marshal-assignment-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-clickable":c.value}]),onClick:m},[r("div",M6,[r("div",A6,[r("span",E6,b(e.assignment.marshalName),1)]),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.readOnly?(p(),g("div",P6,[r("button",{class:le(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:k[0]||(k[0]=ct(S=>y.$emit("toggle-check-in",e.assignment),["stop"]))},[r("span",D6,b(e.effectiveCheckInStatus?"":""),1),r("span",R6,b(e.effectiveCheckInStatus?"Checked in":"Check in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(p(),g("span",O6,[Je(b(i(e.assignment.checkInTime))+" ",1),l.value?(p(),g("span",B6,"("+b(l.value)+")",1)):D("",!0),h.value?(p(),g("span",{key:1,class:le(["check-in-distance",f.value]),onClick:ct(o,["stop"])},b(h.value),3)):D("",!0)])):e.hasUnsavedChanges?(p(),g("span",N6," Unsaved ")):D("",!0)])):D("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&e.readOnly?(p(),g("div",F6,[r("span",{class:le(["status-badge",e.effectiveCheckInStatus?"status-checked-in":"status-not-checked-in"])},[r("span",U6,b(e.effectiveCheckInStatus?"":""),1),Je(" "+b(e.effectiveCheckInStatus?"Checked in":"Not checked in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime?(p(),g("span",z6,[Je(b(i(e.assignment.checkInTime))+" ",1),l.value?(p(),g("span",H6,"("+b(l.value)+")",1)):D("",!0),h.value?(p(),g("span",{key:1,class:le(["check-in-distance",f.value]),onClick:ct(o,["stop"])},b(h.value),3)):D("",!0)])):D("",!0)])):D("",!0),e.assignment.isPending?(p(),g("div",V6,[...k[3]||(k[3]=[r("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):D("",!0),e.isMarkedForRemoval?(p(),g("div",G6,[...k[4]||(k[4]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):D("",!0)]),!e.readOnly&&!e.isMarkedForRemoval?(p(),g("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:k[1]||(k[1]=ct(S=>y.$emit("remove",e.assignment),["stop"]))},"  ")):D("",!0),e.isMarkedForRemoval?(p(),g("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:k[2]||(k[2]=ct(S=>y.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):D("",!0)],2))}},j6=Ze(q6,[["__scopeId","data-v-85a18d73"]]),W6={class:"tab-content"},Z6={key:0,class:"read-only-notice"},K6={key:1,class:"form-group"},Y6=["value"],J6={class:"section-title"},X6={key:2,class:"assign-section"},Q6={__name:"LocationAssignmentsTab",props:{form:{type:Object,required:!0},assignments:{type:Array,default:()=>[]},peopleTerm:{type:String,default:"Marshals"},personTerm:{type:String,default:"Marshal"},checkpointTerm:{type:String,default:"Checkpoint"},readOnly:{type:Boolean,default:!1}},emits:["update:form","input","remove-assignment","open-assign-modal","select-marshal","distance-click"],setup(e,{expose:t,emit:n}){const a=e,o=z(()=>a.peopleTerm.toLowerCase()),i=z(()=>a.personTerm.toLowerCase()),l=z(()=>a.checkpointTerm.toLowerCase()),c=n,{pendingCheckInChanges:d,getEffectiveCheckInStatus:h,handleToggleCheckIn:f}=k1(()=>c("input")),m=P(new Set),y=z(()=>a.assignments?.length||0),k=z(()=>a.assignments?[...a.assignments].sort((A,G)=>(A.marshalName||"").localeCompare(G.marshalName||"",void 0,{sensitivity:"base"})):[]),S=A=>m.value.has(A),x=A=>{A.isPending||c("select-marshal",A)},E=P(!1),$=P(null),w=A=>{h(A)?($.value=A,E.value=!0):f(A)},_=()=>{$.value&&f($.value),E.value=!1,$.value=null},I=()=>{E.value=!1,$.value=null},T=z(()=>$.value?`Are you sure you want to undo ${$.value.marshalName||"this marshal"}'s check-in?`:""),B=A=>{A.isPending?c("remove-assignment",A):(m.value.add(A.id),c("input"))},M=A=>{m.value.delete(A.id),c("input")},R=(A,G)=>{c("update:form",{...a.form,[A]:Number(G)}),c("input")};return t({pendingCheckInChanges:d,clearPendingChanges:()=>{d.value.clear(),m.value.clear()},getPendingChanges:()=>Array.from(d.value.entries()).map(([A,G])=>({assignmentId:A,shouldBeCheckedIn:G})),getMarkedForRemoval:()=>Array.from(m.value)}),(A,G)=>(p(),g("div",W6,[e.readOnly?(p(),g("div",Z6," Viewing from "+b(i.value)+" - "+b(o.value)+" cannot be modified here. ",1)):D("",!0),e.readOnly?D("",!0):(p(),g("div",K6,[r("label",null,"Required "+b(o.value),1),r("input",{value:e.form.requiredMarshals,onInput:G[0]||(G[0]=F=>R("requiredMarshals",F.target.value)),type:"number",min:"1",required:"",class:"form-input"},null,40,Y6)])),r("h3",J6,"Assigned "+b(o.value)+" ("+b(y.value)+")",1),Ee(yc,{"is-empty":e.assignments.length===0,"empty-message":`No ${o.value} assigned yet.`,"empty-hint":`Use the button below to assign ${o.value} to this ${l.value}.`},{default:Ue(()=>[(p(!0),g(xe,null,qe(k.value,F=>(p(),ze(j6,{key:F.id,assignment:F,"effective-check-in-status":N(h)(F),"has-unsaved-changes":N(d).has(F.id),"is-marked-for-removal":S(F.id),"read-only":e.readOnly,location:e.form,onClick:x,onToggleCheckIn:w,onRemove:B,onUndoRemove:M,onDistanceClick:G[1]||(G[1]=j=>A.$emit("distance-click",j))},null,8,["assignment","effective-check-in-status","has-unsaved-changes","is-marked-for-removal","read-only","location"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),e.readOnly?D("",!0):(p(),g("div",X6,[r("button",{type:"button",class:"btn btn-primary assign-btn",onClick:G[2]||(G[2]=F=>A.$emit("open-assign-modal"))}," + Assign "+b(i.value)+"... ",1)])),Ee(vi,{show:E.value,title:"Confirm check-out",message:T.value,"confirm-text":"Check out","is-danger":!0,onConfirm:_,onCancel:I},null,8,["show","message"])]))}},e8=Ze(Q6,[["__scopeId","data-v-7124720e"]]),t8={class:"grouped-tasks-list"},n8={key:0,class:"empty-state"},o8=["onClick"],a8={class:"task-header-content"},s8={class:"task-checkbox-area"},i8={class:"task-info"},l8={class:"task-name"},r8={class:"task-summary"},c8={key:0,class:"modified-badge"},u8={class:"task-scope"},d8=["title"],h8={class:"expand-arrow"},f8={key:1,class:"task-group-details"},p8={class:"detail-checkbox"},v8=["checked","disabled","onChange"],m8={class:"detail-content"},g8={class:"detail-context"},y8={key:0,class:"detail-completion"},k8={key:0,class:"pending-text"},b8={class:"completion-text"},_8={class:"completion-time"},w8={key:1,class:"detail-uncomplete"},C8={key:2,class:"detail-disabled"},L8={__name:"GroupedTasksList",props:{items:{type:Array,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["toggle-complete","reorder"],setup(e,{emit:t}){const{terms:n,termsLower:a}=ht(),o=e,i=t,l=P(new Set),c=z(()=>{const E=new Map;for(const $ of o.items){E.has($.itemId)||E.set($.itemId,{itemId:$.itemId,text:$.text,displayOrder:$.displayOrder||0,items:[],totalCount:0,completedCount:0,allCompleted:!1,hasModified:!1});const w=E.get($.itemId);w.items.push($),w.totalCount++,$.localIsCompleted&&w.completedCount++,$.isModified&&(w.hasModified=!0)}for(const $ of E.values())$.allCompleted=$.completedCount===$.totalCount,$.items.sort((w,_)=>{const I=S(w),T=S(_);return I.localeCompare(T,void 0,{numeric:!0,sensitivity:"base"})});return Array.from(E.values()).sort(($,w)=>{const _=$.displayOrder||0,I=w.displayOrder||0;return _!==I?_-I:$.text.localeCompare(w.text,void 0,{sensitivity:"base"})})}),d=E=>{l.value.has(E)?l.value.delete(E):l.value.add(E),l.value=new Set(l.value)},h=({changes:E})=>{i("reorder",E)},f=E=>E.hasModified?"status-modified":E.allCompleted?"status-completed":E.completedCount>0?"status-partial":"status-pending",m=E=>E.allCompleted?"":E.completedCount>0?"":"",y=E=>({Everyone:"Everyone",SpecificPeople:"Assigned individually",EveryoneInAreas:`Per ${a.value.area}`,EveryoneAtCheckpoints:`Per ${a.value.checkpoint}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,OnePerArea:`One per ${a.value.area}`,EveryAreaLead:`${n.value.area} leads`,OneLeadPerArea:`One lead per ${a.value.area}`})[E.matchedScope]||E.matchedScope,k=E=>({Everyone:"This task is for everyone at the event",SpecificPeople:"This task is specifically assigned to certain people",EveryoneInAreas:`This task is for everyone in certain ${a.value.areas}`,EveryoneAtCheckpoints:`This task is for everyone at certain ${a.value.checkpoints}`,OnePerCheckpoint:`One person at the ${a.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${a.value.area} needs to complete this`,EveryAreaLead:`This task is for ${a.value.area} leads only`,OneLeadPerArea:`One ${a.value.area} lead needs to complete this`})[E.matchedScope]||"",S=E=>{if(!E.completionContextType||!E.completionContextId)return"Everyone";if(E.completionContextType==="Checkpoint"){const $=o.locations.find(w=>w.id===E.completionContextId);return $?$.description?`${$.name} - ${$.description}`:$.name:`${n.value.checkpoint} (unknown)`}if(E.completionContextType==="Area"){const $=o.areas.find(w=>w.id===E.completionContextId);return $?$.name:`${n.value.area} (unknown)`}if(E.completionContextType==="Personal"){if(E.contextOwnerName)return E.contextOwnerName;if(E.completionContextId&&o.marshals.length>0){const $=o.marshals.find(w=>w.id===E.completionContextId||w.marshalId===E.completionContextId);if($)return $.name||$.marshalName}return"Assigned individually"}return E.completionContextType},x=E=>E?new Date(E).toLocaleString():"";return(E,$)=>(p(),g("div",t8,[c.value.length===0?(p(),g("div",n8,[...$[0]||($[0]=[r("p",null,"No tasks available.",-1)])])):(p(),ze(fl,{key:1,items:c.value,"item-key":"itemId",disabled:!e.allowReorder,"show-order-overlay":e.allowReorder,onReorder:h},{item:Ue(({element:w})=>[r("div",{class:le(["task-group",{"all-completed":w.allCompleted,"has-modified":w.hasModified}])},[e.allowReorder?(p(),ze(pl,{key:0,class:"task-drag-handle"})):D("",!0),r("button",{type:"button",class:"task-group-header",onClick:_=>d(w.itemId)},[r("div",a8,[r("div",s8,[r("span",{class:le(["task-status-icon",f(w)])},b(m(w)),3)]),r("div",i8,[r("div",l8,b(w.text),1),r("div",r8,[r("span",{class:le(["completion-count",{"all-done":w.allCompleted}])},b(w.completedCount)+"/"+b(w.totalCount)+" completed ",3),w.hasModified?(p(),g("span",c8," Modified ")):D("",!0)])]),r("div",u8,[w.items[0]?.scopeConfigurations?.length?(p(),ze(cl,{key:0,"scope-configurations":w.items[0].scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):(p(),g("span",{key:1,class:"scope-pill",title:k(w.items[0])},b(y(w.items[0])),9,d8))])]),r("span",h8,b(l.value.has(w.itemId)?"":""),1)],8,o8),l.value.has(w.itemId)?(p(),g("div",f8,[(p(!0),g(xe,null,qe(w.items,_=>(p(),g("div",{key:`${_.itemId}-${_.completionContextId}`,class:le(["task-detail-item",{"item-completed":_.localIsCompleted,"item-modified":_.isModified}])},[r("div",p8,[r("input",{type:"checkbox",checked:_.localIsCompleted,disabled:!_.canBeCompletedByMe&&!_.localIsCompleted,onChange:I=>E.$emit("toggle-complete",_)},null,40,v8)]),r("div",m8,[r("div",g8,b(S(_)),1),_.localIsCompleted?(p(),g("div",y8,[_.isModified&&!_.isCompleted?(p(),g("span",k8," Will be marked as completed ")):(p(),g(xe,{key:1},[r("span",b8,b(_.completedByActorName||"Unknown"),1),r("span",_8,b(x(_.completedAt)),1)],64))])):_.isModified&&_.isCompleted?(p(),g("div",w8,[...$[1]||($[1]=[r("span",{class:"pending-text"},"Will be marked as incomplete",-1)])])):_.canBeCompletedByMe?D("",!0):(p(),g("div",C8," Already completed by someone else "))])],2))),128))])):D("",!0)],2)]),_:1},8,["items","disabled","show-order-overlay"]))]))}},Uf=Ze(L8,[["__scopeId","data-v-e3f86c38"]]),S8={class:"checkpoint-checklist-view"},I8={key:0,class:"loading-state"},x8={key:1,class:"error-state"},$8={key:2,class:"empty-state"},T8={class:"help-text"},M8={key:3,class:"empty-state"},A8={__name:"CheckpointChecklistView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["update:modelValue","change","reorder"],setup(e,{expose:t,emit:n}){const{termsLower:a}=ht(),o=e,i=n,l=P([]),c=P(!1),d=P(null),h=P(new Map),f=z(()=>o.assignments.length===0),m=z(()=>l.value.map($=>{const w=h.value.get(`${$.itemId}|||${$.completionContextId}`),_=w!==void 0?w.complete:$.isCompleted,I=w!==void 0&&w.complete!==$.isCompleted;return{...$,localIsCompleted:_,isModified:I}})),y=async()=>{if(!(!o.eventId||!o.locationId&&!o.areaId)){c.value=!0,d.value=null;try{const $=o.locationId?await Nt.getCheckpointChecklist(o.eventId,o.locationId):await Nt.getAreaChecklist(o.eventId,o.areaId);if(l.value=$.data||[],o.modelValue&&o.modelValue.length>0){const w=new Map;o.modelValue.forEach(_=>{w.set(`${_.itemId}|||${_.contextId}`,{complete:_.complete,contextType:_.contextType,contextId:_.contextId})}),h.value=w}}catch($){console.error("Failed to load checklist:",$),d.value=$.response?.data?.message||"Failed to load checklist"}finally{c.value=!1}}},k=$=>{const w=$.contextOwnerMarshalId||(o.assignments.length>0?o.assignments[0].marshalId:null);if(!w)return;const _=`${$.itemId}|||${$.completionContextId}`,I=h.value.get(_),T=I!==void 0?I.complete:$.isCompleted;h.value.set(_,{complete:!T,contextType:$.completionContextType,contextId:$.completionContextId,marshalId:w}),S()},S=()=>{const $=[];for(const[w,_]of h.value.entries()){const[I,T]=w.split("|||"),B=l.value.find(M=>M.itemId===I&&M.completionContextId===T);B&&_.complete!==B.isCompleted&&$.push({itemId:I,complete:_.complete,contextType:_.contextType,contextId:_.contextId,marshalId:_.marshalId})}i("update:modelValue",$),i("change",$)},x=$=>{i("reorder",$)};return t({resetLocalState:()=>{if(h.value=new Map,o.modelValue&&o.modelValue.length>0){const $=new Map;o.modelValue.forEach(w=>{$.set(`${w.itemId}|||${w.contextId}`,{complete:w.complete,contextType:w.contextType,contextId:w.contextId,marshalId:w.marshalId})}),h.value=$}},loadChecklist:y}),Ye(()=>[o.eventId,o.locationId,o.areaId],()=>{y()},{immediate:!0}),($,w)=>(p(),g("div",S8,[c.value?(p(),g("div",I8," Loading checklist... ")):d.value?(p(),g("div",x8,[r("p",null,b(d.value),1),r("button",{onClick:y,class:"btn btn-secondary btn-small"}," Retry ")])):f.value?(p(),g("div",$8,[r("p",null,"No "+b(N(a).peoplePlural)+" assigned to this "+b(N(a).checkpoint)+" yet.",1),r("p",T8,"Assign "+b(N(a).peoplePlural)+" to enable "+b(N(a).checklist)+" completion.",1)])):l.value.length===0?(p(),g("div",M8,[r("p",null,"No checklist items for this "+b(N(a).checkpoint)+".",1)])):(p(),ze(Uf,{key:4,items:m.value,locations:e.locations,areas:e.areas,marshals:e.marshals,"allow-reorder":e.allowReorder,onToggleComplete:k,onReorder:x},null,8,["items","locations","areas","marshals","allow-reorder"]))]))}},b1=Ze(A8,[["__scopeId","data-v-d3deb94b"]]),E8={class:"notes-view"},P8={key:0,class:"loading-state"},D8={key:1,class:"error-state"},R8={key:2,class:"empty-state"},O8={class:"note-item-content"},B8={class:"note-header"},N8={class:"note-title-row"},F8={key:0,class:"pin-icon",title:"Pinned"},U8={class:"note-title"},z8={class:"note-meta"},H8={key:0,class:"category-badge"},V8={key:0,class:"note-content"},G8={class:"note-footer"},q8={class:"created-info"},j8={key:1,class:"scope-info"},W8={key:1,class:"notes-list"},Z8={class:"note-header"},K8={class:"note-title-row"},Y8={key:0,class:"pin-icon",title:"Pinned"},J8={class:"note-title"},X8={class:"note-meta"},Q8={key:0,class:"category-badge"},eD={key:0,class:"note-content"},tD={class:"note-footer"},nD={class:"created-info"},oD={key:1,class:"scope-info"},aD={__name:"NotesView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},marshalId:{type:String,default:null},allNotes:{type:Array,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},showScope:{type:Boolean,default:!0},allowReorder:{type:Boolean,default:!1}},emits:["reorder"],setup(e,{expose:t,emit:n}){const a=e,o=n,i=P([]),l=P(!1),c=P(null),d=z(()=>a.marshalId?"No notes for this marshal.":a.areaId?"No notes for this area.":a.locationId?"No notes for this checkpoint.":"No notes available."),h=z(()=>a.areaId?a.locations.filter(I=>I.areaIds&&I.areaIds.includes(a.areaId)):[]),f=z(()=>h.value.map(I=>I.id)),m=z(()=>{if(!a.areaId)return[];const I=new Set;return a.assignments.filter(T=>f.value.includes(T.locationId)).forEach(T=>I.add(T.marshalId)),Array.from(I)}),y=I=>a.assignments.filter(T=>T.marshalId===I).map(T=>T.locationId),k=I=>{const T=y(I),B=new Set;for(const M of T){const R=a.locations.find(A=>A.id===M);R?.areaIds&&R.areaIds.forEach(A=>B.add(A))}return Array.from(B)},S=(I,T)=>{if(!I.scopeConfigurations)return null;for(const B of I.scopeConfigurations){if(B.itemType==="Area"){if(T.type==="area"&&(B.ids.includes(T.areaId)||B.ids.includes("ALL_AREAS")))return{matched:!0,scope:B.scope==="EveryAreaLead"?"Area leads":"Area"};if(T.type==="checkpoint"){const R=a.locations.find(A=>A.id===T.locationId)?.areaIds||[];if(B.ids.includes("ALL_AREAS")||R.some(A=>B.ids.includes(A)))return{matched:!0,scope:B.scope==="EveryAreaLead"?"Area leads":"Area"}}}if(B.itemType==="Checkpoint"){if(T.type==="checkpoint"&&(B.ids.includes(T.locationId)||B.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint"};if(T.type==="area"&&T.checkpointIds.some(R=>B.ids.includes(R)||B.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint in area"}}if(B.itemType==="Marshal"){if(T.type==="marshal"&&(B.ids.includes(T.marshalId)||B.ids.includes("ALL_MARSHALS")))return{matched:!0,scope:"Marshal"};if(T.type==="checkpoint"){const M=a.assignments.filter(A=>A.locationId===T.locationId).map(A=>A.marshalId);if(B.ids.includes("ALL_MARSHALS")||M.some(A=>B.ids.includes(A)))return{matched:!0,scope:"Marshal at checkpoint"}}if(T.type==="area"&&(B.ids.includes("ALL_MARSHALS")||T.marshalIds.some(R=>B.ids.includes(R))))return{matched:!0,scope:"Marshal in area"}}if(T.type==="marshal"&&T.checkpointIds&&T.areaIds){if(B.itemType==="Checkpoint"&&(B.ids.includes("ALL_CHECKPOINTS")||T.checkpointIds.some(R=>B.ids.includes(R))))return{matched:!0,scope:"Assigned checkpoint"};if(B.itemType==="Area"&&(B.ids.includes("ALL_AREAS")||T.areaIds.some(R=>B.ids.includes(R))))return{matched:!0,scope:B.scope==="EveryAreaLead"?"Area lead":"Area"}}}return null},x=z(()=>{const I=a.allNotes||i.value;if(!I||I.length===0)return[];if(a.areaId&&a.allNotes){const T={type:"area",areaId:a.areaId,checkpointIds:f.value,marshalIds:m.value},B=[],M=new Set;for(const R of I){if(M.has(R.noteId))continue;const A=S(R,T);A&&(M.add(R.noteId),B.push({...R,matchedScope:A.scope}))}return B}if(a.locationId&&a.allNotes){const T={type:"checkpoint",locationId:a.locationId},B=[],M=new Set;for(const R of I){if(M.has(R.noteId))continue;const A=S(R,T);A&&(M.add(R.noteId),B.push({...R,matchedScope:A.scope}))}return B}if(a.marshalId&&a.allNotes){const T=y(a.marshalId),B=k(a.marshalId),M={type:"marshal",marshalId:a.marshalId,checkpointIds:T,areaIds:B},R=[],A=new Set;for(const G of I){if(A.has(G.noteId))continue;const F=S(G,M);F&&(A.add(G.noteId),R.push({...G,matchedScope:F.scope}))}return R}return I}),E=z(()=>{const I={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return[...x.value].sort((T,B)=>{if(T.isPinned!==B.isPinned)return T.isPinned?-1:1;const M=I[T.priority]??2,R=I[B.priority]??2;return M!==R?M-R:T.displayOrder!==B.displayOrder?T.displayOrder-B.displayOrder:new Date(B.createdAt)-new Date(T.createdAt)})}),$=({changes:I})=>{o("reorder",I)},w=async()=>{if(a.allNotes===null&&a.eventId){l.value=!0,c.value=null;try{let I;a.marshalId?I=await ma.getMarshalNotes(a.eventId,a.marshalId):I=await ma.getByEvent(a.eventId),i.value=I.data||[]}catch(I){console.error("Failed to load notes:",I),c.value=I.response?.data?.message||"Failed to load notes"}finally{l.value=!1}}};Ye(()=>[a.eventId,a.locationId,a.areaId,a.marshalId],()=>{a.allNotes===null&&w()},{immediate:!0});const _=I=>{if(!I)return"";const T=new Date(I),M=new Date-T,R=Math.floor(M/6e4),A=Math.floor(M/36e5),G=Math.floor(M/864e5);return R<1?"just now":R<60?`${R}m ago`:A<24?`${A}h ago`:G<7?`${G}d ago`:T.toLocaleDateString()};return t({loadNotes:w}),(I,T)=>(p(),g("div",E8,[l.value?(p(),g("div",P8," Loading notes... ")):c.value?(p(),g("div",D8,[r("p",null,b(c.value),1),r("button",{onClick:w,class:"btn btn-secondary btn-small"}," Retry ")])):x.value.length===0?(p(),g("div",R8,[r("p",null,b(d.value),1)])):(p(),g(xe,{key:3},[e.allowReorder?(p(),ze(fl,{key:0,items:E.value,"item-key":"noteId","pinned-key":"isPinned",onReorder:$,class:"notes-list"},{item:Ue(({element:B})=>[r("div",{class:le(["note-item",{pinned:B.isPinned}])},[Ee(pl),r("div",O8,[r("div",B8,[r("div",N8,[B.isPinned?(p(),g("span",F8,"")):D("",!0),r("span",{class:le(["priority-indicator",(B.priority||"Normal").toLowerCase()])},null,2),r("strong",U8,b(B.title),1)]),r("div",z8,[B.category?(p(),g("span",H8,b(B.category),1)):D("",!0),r("span",{class:le(["priority-badge",(B.priority||"Normal").toLowerCase()])},b(B.priority||"Normal"),3)])]),B.content?(p(),g("div",V8,b(B.content),1)):D("",!0),r("div",G8,[r("span",q8," Created by "+b(B.createdByName||"Unknown")+"  "+b(_(B.createdAt)),1),B.scopeConfigurations?.length&&e.showScope?(p(),ze(cl,{key:0,class:"scope-pills","scope-configurations":B.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):B.matchedScope&&e.showScope?(p(),g("span",j8,b(B.matchedScope),1)):D("",!0)])])],2)]),_:1},8,["items"])):(p(),g("div",W8,[(p(!0),g(xe,null,qe(E.value,B=>(p(),g("div",{key:B.noteId,class:le(["note-item",{pinned:B.isPinned}])},[r("div",Z8,[r("div",K8,[B.isPinned?(p(),g("span",Y8,"")):D("",!0),r("span",{class:le(["priority-indicator",(B.priority||"Normal").toLowerCase()])},null,2),r("strong",J8,b(B.title),1)]),r("div",X8,[B.category?(p(),g("span",Q8,b(B.category),1)):D("",!0),r("span",{class:le(["priority-badge",(B.priority||"Normal").toLowerCase()])},b(B.priority||"Normal"),3)])]),B.content?(p(),g("div",eD,b(B.content),1)):D("",!0),r("div",tD,[r("span",nD," Created by "+b(B.createdByName||"Unknown")+"  "+b(_(B.createdAt)),1),B.scopeConfigurations?.length&&e.showScope?(p(),ze(cl,{key:0,class:"scope-pills","scope-configurations":B.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"max-expanded-items":3},null,8,["scope-configurations","areas","locations","marshals"])):B.matchedScope&&e.showScope?(p(),g("span",oD,b(B.matchedScope),1)):D("",!0)])],2))),128))]))],64))]))}},nd=Ze(aD,[["__scopeId","data-v-b63fe4a2"]]),sD={class:"checklist-preview"},iD={class:"preview-actions"},lD={class:"preview-header"},rD={key:0,class:"add-item-form"},cD=["placeholder"],uD=["disabled"],dD={key:1,class:"pending-items"},hD={class:"item-content"},fD={class:"item-header"},pD={class:"item-text"},vD={class:"item-scope"},mD=["onClick"],gD={key:2,class:"empty-state"},yD={key:0,class:"help-text"},kD={key:3,class:"checklist-items"},bD={class:"item-content"},_D={class:"item-header"},wD={class:"item-text"},CD={class:"item-scope"},LD=["title"],SD={key:0,class:"item-context"},ID={__name:"ChecklistPreviewForLocation",props:{allChecklistItems:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{terms:n,termsLower:a}=ht(),o=e,i=z(()=>o.checkpointTermSingular?o.checkpointTermSingular.toLowerCase():a.value.checkpoint),l=t,c=P(!1),d=P(""),h=P([...o.modelValue]);Ye(()=>o.modelValue,_=>{h.value=[..._]},{deep:!0});const f=()=>{d.value.trim()&&(h.value.push({text:d.value.trim(),isNew:!0}),d.value="",c.value=!1,y())},m=_=>{h.value.splice(_,1),y()},y=()=>{l("update:modelValue",[...h.value]),l("change")},k=_=>{const I=_.scope,T=_.itemType,B=_.ids||[];return(I==="EveryoneAtCheckpoints"||I==="OnePerCheckpoint")&&T==="Checkpoint"?B.includes("ALL_CHECKPOINTS"):I==="OnePerCheckpoint"&&T==="Area"?B.includes("ALL_AREAS")?!0:B.some(M=>o.pendingAreaIds.includes(M)):(I==="EveryoneInAreas"||I==="OnePerArea"||I==="EveryAreaLead"||I==="OneLeadPerArea")&&T==="Area"?B.includes("ALL_AREAS")?!0:B.some(M=>o.pendingAreaIds.includes(M)):!1},S=z(()=>o.allChecklistItems.filter(_=>_.scopeConfigurations&&_.scopeConfigurations.length>0?_.scopeConfigurations.some(I=>k(I)):!1)),x=_=>({EveryoneAtCheckpoints:`All at ${a.value.checkpoints}`,OnePerCheckpoint:`One per ${a.value.checkpoint}`,EveryoneInAreas:`All in ${a.value.areas}`,OnePerArea:`One per ${a.value.area}`,EveryAreaLead:`${a.value.area} leads`,OneLeadPerArea:`One lead per ${a.value.area}`})[_]||_,E=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"Unknown";const I=_.scopeConfigurations.find(B=>k(B));if(!I)return x(_.scopeConfigurations[0].scope);const T=I.ids||[];return T.includes("ALL_CHECKPOINTS")?`All ${a.value.checkpoints}`:T.includes("ALL_AREAS")?`All ${a.value.areas}`:x(I.scope)},$=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"";const I=_.scopeConfigurations.find(B=>k(B));return I&&{EveryoneAtCheckpoints:`This item is for everyone at specified ${a.value.checkpoints}`,OnePerCheckpoint:`One person at each ${a.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${a.value.areas}`,OnePerArea:`One person in each ${a.value.area} needs to complete this`,EveryAreaLead:`This item is for ${a.value.area} leads only`,OneLeadPerArea:`One ${a.value.area} lead needs to complete this`}[I.scope]||""},w=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return null;const I=_.scopeConfigurations.find(M=>k(M));if(!I)return null;const T=I.itemType,B=I.ids||[];if(B.includes("ALL_CHECKPOINTS")||B.includes("ALL_AREAS"))return null;if(T==="Area"){const M=o.areas.filter(R=>B.includes(R.id)&&o.pendingAreaIds.includes(R.id)).map(R=>R.name);if(M.length>0)return`In: ${M.join(", ")}`}return null};return(_,I)=>(p(),g("div",sD,[r("div",iD,[r("p",lD,b(e.isEditing?`Add new ${N(a).checklist} for this ${i.value}:`:`${N(n).checklists} that will apply at this ${i.value}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:I[0]||(I[0]=T=>c.value=!c.value)},b(c.value?"Cancel":`Add ${N(a).checklist}`),1)]),c.value?(p(),g("div",rD,[Ge(r("input",{"onUpdate:modelValue":I[1]||(I[1]=T=>d.value=T),type:"text",placeholder:`Enter ${N(a).checklist} text...`,class:"add-item-input",onKeyup:ya(f,["enter"])},null,40,cD),[[st,d.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!d.value.trim(),onClick:f}," Add ",8,uD)])):D("",!0),h.value.length>0?(p(),g("div",dD,[(p(!0),g(xe,null,qe(h.value,(T,B)=>(p(),g("div",{key:`pending-${B}`,class:"checklist-item pending"},[I[3]||(I[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",hD,[r("div",fD,[r("div",pD,b(T.text),1),r("div",vD,[I[2]||(I[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:M=>m(B),title:"Remove"},"  ",8,mD)])])])]))),128))])):D("",!0),!e.isEditing&&S.value.length===0&&h.value.length===0?(p(),g("div",gD,[r("p",null,"No "+b(N(a).checklists)+" will apply based on the current "+b(N(a).area)+" assignments.",1),e.pendingAreaIds.length===0?(p(),g("p",yD," Assign "+b(N(a).areas)+" to see relevant "+b(N(a).checklists)+". ",1)):D("",!0)])):D("",!0),!e.isEditing&&S.value.length>0?(p(),g("div",kD,[(p(!0),g(xe,null,qe(S.value,T=>(p(),g("div",{key:T.id,class:"checklist-item"},[I[4]||(I[4]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",bD,[r("div",_D,[r("div",wD,b(T.text),1),r("div",CD,[r("span",{class:"scope-pill",title:$(T)},b(E(T)),9,LD)])]),w(T)?(p(),g("div",SD,b(w(T)),1)):D("",!0)])]))),128))])):D("",!0)]))}},xD=Ze(ID,[["__scopeId","data-v-7d943b21"]]),$D={class:"notes-preview"},TD={class:"preview-actions"},MD={class:"preview-header"},AD={key:0,class:"add-item-form"},ED={class:"add-form-fields"},PD=["disabled"],DD={key:1,class:"pending-items"},RD={class:"note-header"},OD={class:"note-title"},BD={class:"note-actions"},ND=["onClick"],FD={key:0,class:"note-content"},UD={key:2,class:"empty-state"},zD={key:0,class:"help-text"},HD={key:3,class:"notes-list"},VD={class:"note-header"},GD={class:"note-title"},qD=["title"],jD={key:0,class:"note-content"},WD={key:1,class:"note-context"},ZD={__name:"NotesPreviewForLocation",props:{allNotes:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=z(()=>a.checkpointTermSingular?a.checkpointTermSingular.toLowerCase():n.value.checkpoint),l=P(!1),c=P(""),d=P(""),h=P([...a.modelValue]);Ye(()=>a.modelValue,_=>{h.value=[..._]},{deep:!0});const f=()=>{!c.value.trim()&&!d.value.trim()||(h.value.push({title:c.value.trim(),content:d.value.trim(),isNew:!0}),c.value="",d.value="",l.value=!1,y())},m=_=>{h.value.splice(_,1),y()},y=()=>{o("update:modelValue",[...h.value]),o("change")},k=_=>{const I=_.scope,T=_.itemType,B=_.ids||[];return I==="EveryoneAtCheckpoints"&&T==="Checkpoint"?B.includes("ALL_CHECKPOINTS"):I==="EveryoneInAreas"&&T==="Area"?B.includes("ALL_AREAS")?!0:B.some(M=>a.pendingAreaIds.includes(M)):!1},S=z(()=>a.allNotes.filter(_=>_.scopeConfigurations&&_.scopeConfigurations.length>0?_.scopeConfigurations.some(I=>k(I)):!1)),x=_=>({EveryoneAtCheckpoints:`All at ${n.value.checkpoints}`,EveryoneInAreas:`All in ${n.value.areas}`})[_]||_,E=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"Unknown";const I=_.scopeConfigurations.find(B=>k(B));if(!I)return x(_.scopeConfigurations[0].scope);const T=I.ids||[];return T.includes("ALL_CHECKPOINTS")?`All ${n.value.checkpoints}`:T.includes("ALL_AREAS")?`All ${n.value.areas}`:x(I.scope)},$=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"";const I=_.scopeConfigurations.find(B=>k(B));return I&&{EveryoneAtCheckpoints:`This note is for everyone at specified ${n.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${n.value.areas}`}[I.scope]||""},w=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return null;const I=_.scopeConfigurations.find(M=>k(M));if(!I)return null;const T=I.itemType,B=I.ids||[];if(B.includes("ALL_CHECKPOINTS")||B.includes("ALL_AREAS"))return null;if(T==="Area"){const M=a.areas.filter(R=>B.includes(R.id)&&a.pendingAreaIds.includes(R.id)).map(R=>R.name);if(M.length>0)return`In: ${M.join(", ")}`}return null};return(_,I)=>(p(),g("div",$D,[r("div",TD,[r("p",MD,b(e.isEditing?`Add new note for this ${i.value}:`:`Notes that will be visible at this ${i.value}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:I[0]||(I[0]=T=>l.value=!l.value)},b(l.value?"Cancel":"Add note"),1)]),l.value?(p(),g("div",AD,[r("div",ED,[Ge(r("input",{"onUpdate:modelValue":I[1]||(I[1]=T=>c.value=T),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[st,c.value]]),Ge(r("textarea",{"onUpdate:modelValue":I[2]||(I[2]=T=>d.value=T),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[st,d.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!c.value.trim()&&!d.value.trim(),onClick:f}," Add ",8,PD)])):D("",!0),h.value.length>0?(p(),g("div",DD,[(p(!0),g(xe,null,qe(h.value,(T,B)=>(p(),g("div",{key:`pending-${B}`,class:"note-item pending"},[r("div",RD,[r("span",OD,b(T.title||"Untitled"),1),r("div",BD,[I[3]||(I[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:M=>m(B),title:"Remove"},"  ",8,ND)])]),T.content?(p(),g("div",FD,b(T.content),1)):D("",!0)]))),128))])):D("",!0),!e.isEditing&&S.value.length===0&&h.value.length===0?(p(),g("div",UD,[r("p",null,"No notes will apply based on the current "+b(N(n).area)+" assignments.",1),e.pendingAreaIds.length===0?(p(),g("p",zD," Assign "+b(N(n).areas)+" to see relevant notes. ",1)):D("",!0)])):D("",!0),!e.isEditing&&S.value.length>0?(p(),g("div",HD,[(p(!0),g(xe,null,qe(S.value,T=>(p(),g("div",{key:T.id,class:"note-item"},[r("div",VD,[r("span",GD,b(T.title||"Untitled"),1),r("span",{class:"scope-pill",title:$(T)},b(E(T)),9,qD)]),T.content?(p(),g("div",jD,b(T.content),1)):D("",!0),w(T)?(p(),g("div",WD,b(w(T)),1)):D("",!0)]))),128))])):D("",!0)]))}},KD=Ze(ZD,[["__scopeId","data-v-71646c3f"]]),YD={class:"base-modal-title modal-title-with-icon"},JD=["innerHTML"],XD={key:7,class:"tab-content appearance-tab"},QD={class:"accordion-item"},eR=["innerHTML"],tR={class:"accordion-title"},nR={class:"accordion-arrow"},oR={key:0,class:"accordion-content"},aR={class:"section-description"},sR={class:"accordion-item"},iR={class:"accordion-preview"},lR={class:"accordion-arrow"},rR={key:0,class:"accordion-content"},cR={class:"section-description"},uR={class:"terminology-row"},dR={class:"terminology-field"},hR=["value"],fR={value:""},pR=["value"],vR={class:"terminology-field"},mR=["value"],gR={value:""},yR=["value"],kR={key:8,class:"tab-content incidents-tab"},bR={class:"incidents-list"},_R={class:"custom-footer"},wR={class:"footer-left"},fm="edit_location_accordion",CR={__name:"EditLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:null},assignments:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventDate:{type:String,default:""},areas:{type:Array,default:()=>[]},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},availableMarshals:{type:Array,default:()=>[]},allMarshals:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},zIndex:{type:Number,default:1e3},incidents:{type:Array,default:()=>[]},lockedFromMarshal:{type:Boolean,default:!1}},emits:["close","save","delete","move-location","toggle-check-in","remove-assignment","open-assign-modal","update:isDirty","select-incident","select-marshal","reorder-notes","reorder-checklists"],setup(e,{emit:t}){const{terms:n}=ht(),a=e,o=t,i=P("details"),l=P(!1),c=P(null),d=P(null),h=P([]),f=P([]),m=P([]),y=P({id:null,name:"",description:"",what3Words:"",latitude:0,longitude:0,requiredMarshals:1,useCustomTimes:!1,startTime:"",endTime:"",areaIds:[],styleType:"default",styleColor:"",styleBackgroundShape:"",styleBackgroundColor:"",styleBorderColor:"",styleIconColor:"",styleSize:"",styleMapRotation:"",peopleTerm:"",checkpointTerm:"",isDynamic:!1,locationUpdateScopeConfigurations:[]}),k=P(!1),S=P(null),x=de=>{S.value=de,k.value=!0},E=()=>{k.value=!1,S.value=null},$=z(()=>S.value&&S.value.marshalName||""),w=z(()=>y.value.name||a.location?.name||""),_=z(()=>{if(!S.value)return null;const{checkInLatitude:de,checkInLongitude:ke}=S.value;return!de||!ke?null:{lat:de,lng:ke}}),I=z(()=>{const de=y.value.latitude,ke=y.value.longitude;return!de||!ke?null:{lat:de,lng:ke}}),T=z(()=>{if(!S.value)return null;const{checkInLatitude:de,checkInLongitude:ke}=S.value,te=y.value.latitude,ge=y.value.longitude;return!de||!ke||!te||!ge?null:dl(de,ke,te,ge)}),B=()=>a.eventId?`${fm}_${a.eventId}`:fm,M=P({iconStyle:!1,terminology:!1});rn(()=>{const de=localStorage.getItem(B());if(de)try{const ke=JSON.parse(de);M.value={...M.value,...ke}}catch{}});const R=de=>{M.value[de]=!M.value[de],localStorage.setItem(B(),JSON.stringify(M.value))},A=z(()=>{const de=y.value.areaIds||[];if(de.length>0){const ke=a.areas.filter(te=>de.includes(te.id)&&te.peopleTerm).sort((te,ge)=>(te.checkpointCount||0)-(ge.checkpointCount||0));if(ke.length>0)return ke[0].peopleTerm}return a.eventPeopleTerm||"Marshals"}),G=z(()=>y.value.peopleTerm?y.value.peopleTerm:A.value),F=z(()=>{const de=y.value.areaIds||[];if(de.length>0){const ke=a.areas.filter(te=>de.includes(te.id)&&te.checkpointTerm).sort((te,ge)=>(te.checkpointCount||0)-(ge.checkpointCount||0));if(ke.length>0)return ke[0].checkpointTerm}return n.value.checkpoint});z(()=>F.value.toLowerCase());const j=z(()=>{const de=y.value.checkpointTerm||a.location?.checkpointTerm||a.location?.CheckpointTerm;if(de)return Qi("checkpoint",de,G.value);const ke=y.value.areaIds||[];let te=null;if(ke.length>0){const ge=a.areas.filter(Fe=>ke.includes(Fe.id)&&Fe.checkpointTerm).sort((Fe,ut)=>(Fe.checkpointCount||0)-(ut.checkpointCount||0));ge.length>0&&(te=ge[0].checkpointTerm)}return te?Qi("checkpoint",te,G.value):n.value.checkpoint}),K=z(()=>j.value.toLowerCase()),J=z(()=>{const de=G.value;return Qi("people",de)});z(()=>J.value.toLowerCase());const ue=z(()=>n.value.area);z(()=>ue.value.toLowerCase());const Z=z(()=>n.value.area),se=z(()=>Z.value.toLowerCase()),U=z(()=>n.value.areas),Q=z(()=>!!(a.location&&a.location.id)),oe=z(()=>Q.value?`Edit ${K.value}: ${a.location?.name||""}`:`Add ${K.value}`),he=z(()=>{const de=[{value:"details",label:"Details",icon:"details"},{value:"location",label:"Location",icon:"location"},{value:"marshals",label:G.value,icon:"marshal"},{value:"checklists",label:n.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return a.incidents&&a.incidents.length>0&&de.push({value:"incidents",label:"Incidents",icon:"incidents"}),de}),Te=z(()=>he.value.findIndex(de=>de.value===i.value)),je=z(()=>Te.value===he.value.length-1),He=z(()=>{const de=y.value.areaIds||[],ke=a.areas.filter(ft=>de.includes(ft.id)).sort((ft,Dt)=>(ft.checkpointCount||0)-(Dt.checkpointCount||0)),te=(ft,Dt)=>{for(const $t of ke){const In=ft($t);if(In&&In!=="default")return{value:In,source:"area"}}return Dt&&Dt!=="default"?{value:Dt,source:"event"}:{value:"",source:"none"}},ge=te(ft=>ft.checkpointStyleType||ft.CheckpointStyleType,a.eventDefaultStyleType),Fe=te(ft=>ft.checkpointStyleColor||ft.CheckpointStyleColor,a.eventDefaultStyleColor),ut=te(ft=>ft.checkpointStyleBackgroundShape||ft.CheckpointStyleBackgroundShape,a.eventDefaultStyleBackgroundShape),gt=te(ft=>ft.checkpointStyleBackgroundColor||ft.CheckpointStyleBackgroundColor||ft.checkpointStyleColor||ft.CheckpointStyleColor,a.eventDefaultStyleBackgroundColor||a.eventDefaultStyleColor),xt=te(ft=>ft.checkpointStyleBorderColor||ft.CheckpointStyleBorderColor,a.eventDefaultStyleBorderColor),Ct=te(ft=>ft.checkpointStyleIconColor||ft.CheckpointStyleIconColor,a.eventDefaultStyleIconColor),Pt=te(ft=>ft.checkpointStyleSize||ft.CheckpointStyleSize,a.eventDefaultStyleSize),Wt=te(ft=>ft.checkpointStyleMapRotation??ft.CheckpointStyleMapRotation,a.eventDefaultStyleMapRotation),cn=[ge,ut,gt,xt,Ct,Pt,Wt].some(ft=>ft.source==="area");return{type:ge.value||"default",color:Fe.value,backgroundShape:ut.value,backgroundColor:gt.value,borderColor:xt.value,iconColor:Ct.value,size:Pt.value,mapRotation:Wt.value,source:cn?"area":ge.value?"event":"none"}}),We=z(()=>He.value.source==="area"?`${Z.value} default`:"Event default"),be=z(()=>{const de=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:He.value.type,ke=y.value.styleBackgroundShape||He.value.backgroundShape||"circle",te=y.value.styleBackgroundColor||He.value.backgroundColor||"#667eea",ge=y.value.styleBorderColor||He.value.borderColor||"#ffffff",Fe=y.value.styleIconColor||He.value.iconColor||"#ffffff";return Vn({type:de||"circle",backgroundShape:ke,backgroundColor:te,borderColor:ge,iconColor:Fe,size:"100"})}),V=z(()=>{let de,ke,te,ge,Fe;return Q.value&&a.location?(de=a.location.resolvedStyleType||a.location.ResolvedStyleType,ke=a.location.resolvedStyleBackgroundShape||a.location.ResolvedStyleBackgroundShape||"circle",te=a.location.resolvedStyleBackgroundColor||a.location.ResolvedStyleBackgroundColor||a.location.resolvedStyleColor||a.location.ResolvedStyleColor||"#667eea",ge=a.location.resolvedStyleBorderColor||a.location.ResolvedStyleBorderColor||"#ffffff",Fe=a.location.resolvedStyleIconColor||a.location.ResolvedStyleIconColor||"#ffffff"):(de=y.value.styleType&&y.value.styleType!=="default"&&y.value.styleType!=="custom"?y.value.styleType:He.value.type,ke=y.value.styleBackgroundShape||He.value.backgroundShape||"circle",te=y.value.styleBackgroundColor||He.value.backgroundColor||"#667eea",ge=y.value.styleBorderColor||He.value.borderColor||"#ffffff",Fe=y.value.styleIconColor||He.value.iconColor||"#ffffff"),Vn({type:de||"circle",backgroundShape:ke,backgroundColor:te,borderColor:ge,iconColor:Fe,size:"100",outputSize:28})}),Y=z(()=>{const de=!!y.value.checkpointTerm,ke=!!y.value.peopleTerm;return de&&ke?`${Qi("checkpoint",y.value.checkpointTerm,y.value.peopleTerm)}, ${y.value.peopleTerm}`:de?Qi("checkpoint",y.value.checkpointTerm,G.value):ke?y.value.peopleTerm:"Using defaults"}),re=z(()=>je.value?null:he.value[Te.value+1]),ie=z(()=>re.value?`${re.value.label}...`:""),$e=P(!1),q=P(null);Ye(()=>a.location,de=>{if(de){const ke=de.id||"new";if(q.value!==ke){q.value=ke,$e.value=!0;let te="",ge="";de.startTime&&(te=ic(de.startTime)),de.endTime&&(ge=ic(de.endTime)),y.value={id:de.id||null,name:de.name||"",description:de.description||"",what3Words:de.what3Words||"",latitude:de.latitude||0,longitude:de.longitude||0,requiredMarshals:de.requiredMarshals||1,useCustomTimes:!!(de.startTime||de.endTime),startTime:te,endTime:ge,areaIds:de.areaIds||de.AreaIds||[],styleType:de.styleType||de.StyleType||"default",styleColor:de.styleColor||de.StyleColor||"",styleBackgroundShape:de.styleBackgroundShape||de.StyleBackgroundShape||"",styleBackgroundColor:de.styleBackgroundColor||de.StyleBackgroundColor||"",styleBorderColor:de.styleBorderColor||de.StyleBorderColor||"",styleIconColor:de.styleIconColor||de.StyleIconColor||"",styleSize:de.styleSize||de.StyleSize||"",styleMapRotation:de.styleMapRotation??de.StyleMapRotation??"",peopleTerm:de.peopleTerm||"",checkpointTerm:de.checkpointTerm||"",isDynamic:de.isDynamic||!1,locationUpdateScopeConfigurations:de.locationUpdateScopeConfigurations||[]}}}},{immediate:!0,deep:!0}),Ye(()=>a.show,de=>{de?(i.value="details",l.value=!1,h.value=[],f.value=[],m.value=[],c.value?.clearPendingChanges&&c.value.clearPendingChanges(),d.value?.resetLocalState&&d.value.resetLocalState()):(q.value=null,$e.value=!1)});const X=de=>{y.value=de},ee=()=>{o("update:isDirty",!0)},Ce=()=>{l.value=!l.value,o("move-location",{isMoving:l.value,formData:{...y.value}})},Ne=de=>{h.value=de,ee()},Be=()=>{re.value&&(i.value=re.value.value)},Ae=()=>{const de={...y.value,startTime:y.value.useCustomTimes&&y.value.startTime?new Date(y.value.startTime).toISOString():null,endTime:y.value.useCustomTimes&&y.value.endTime?new Date(y.value.endTime).toISOString():null,checkInChanges:c.value?.getPendingChanges?.()||[],assignmentsToRemove:c.value?.getMarkedForRemoval?.()||[],checklistChanges:h.value||[],pendingAssignments:a.assignments.filter(ke=>ke.isPending).map(ke=>({marshalId:ke.marshalId})),pendingNewChecklistItems:f.value,pendingNewNotes:m.value};o("save",de)},ne=()=>{a.location&&a.location.id&&o("delete",a.location.id)},ye=de=>{o("remove-assignment",de)},De=()=>{o("open-assign-modal")},Pe=de=>{o("select-marshal",de)},Ie=()=>{o("close")},me=(de,ke)=>{y.value[de]=ke,ee()},Ke=de=>{o("reorder-notes",de)},Ve=de=>{o("reorder-checklists",de)};return(de,ke)=>(p(),ze(jt,{show:e.show,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:Ie},{header:Ue(()=>[r("h2",YD,[V.value?(p(),g("span",{key:0,class:"modal-title-icon",innerHTML:V.value},null,8,JD)):D("",!0),Je(" "+b(oe.value),1)])]),"tab-header":Ue(()=>[Ee(gl,{modelValue:i.value,"onUpdate:modelValue":ke[0]||(ke[0]=te=>i.value=te),tabs:he.value},null,8,["modelValue","tabs"])]),footer:Ue(()=>[r("div",_R,[r("div",wR,[Q.value&&!e.lockedFromMarshal?(p(),g("button",{key:0,type:"button",onClick:ne,class:"btn btn-danger"}," Delete ")):D("",!0),!Q.value&&!je.value?(p(),g("button",{key:1,type:"button",onClick:Be,class:"btn btn-secondary mobile-only"},b(ie.value),1)):D("",!0)]),r("button",{type:"button",onClick:Ae,class:"btn btn-success"}," Save ")])]),default:Ue(()=>[i.value==="details"?(p(),ze(C5,{key:0,form:y.value,areas:e.areas,"event-date":e.eventDate,"area-term-singular":Z.value,"area-term-plural":U.value,"checkpoint-term-singular":j.value,"people-term-plural":G.value,"onUpdate:form":X,onInput:ee,onSave:Ae},null,8,["form","areas","event-date","area-term-singular","area-term-plural","checkpoint-term-singular","people-term-plural"])):D("",!0),i.value==="location"?(p(),ze(T6,{key:1,form:y.value,"is-moving":l.value,"checkpoint-term-singular":j.value,"people-term-plural":G.value,areas:e.areas,locations:e.allLocations,marshals:e.allMarshals,"is-editing":Q.value,"onUpdate:form":X,onInput:ee,onSave:Ae,onMoveLocation:Ce},null,8,["form","is-moving","checkpoint-term-singular","people-term-plural","areas","locations","marshals","is-editing"])):D("",!0),i.value==="marshals"?(p(),ze(e8,{key:2,ref_key:"assignmentsTabRef",ref:c,form:y.value,assignments:e.assignments,"people-term":G.value,"person-term":J.value,"checkpoint-term":j.value,"read-only":e.lockedFromMarshal,"onUpdate:form":X,onInput:ee,onRemoveAssignment:ye,onOpenAssignModal:De,onSelectMarshal:Pe,onDistanceClick:x},null,8,["form","assignments","people-term","person-term","checkpoint-term","read-only"])):D("",!0),i.value==="checklists"&&Q.value?(p(),ze(b1,{key:3,ref_key:"checklistTabRef",ref:d,modelValue:h.value,"onUpdate:modelValue":ke[1]||(ke[1]=te=>h.value=te),"event-id":e.eventId,"location-id":e.location.id,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals,"allow-reorder":!0,onChange:Ne,onReorder:Ve},null,8,["modelValue","event-id","location-id","locations","areas","assignments","marshals"])):D("",!0),i.value==="checklists"?(p(),ze(xD,{key:4,modelValue:f.value,"onUpdate:modelValue":ke[2]||(ke[2]=te=>f.value=te),"all-checklist-items":e.allChecklistItems,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":Q.value,"checkpoint-term-singular":j.value,onChange:ee},null,8,["modelValue","all-checklist-items","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):D("",!0),i.value==="notes"&&Q.value?(p(),ze(nd,{key:5,"event-id":e.eventId,"location-id":e.location?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals,"allow-reorder":!0,onReorder:Ke},null,8,["event-id","location-id","all-notes","locations","areas","assignments","marshals"])):D("",!0),i.value==="notes"?(p(),ze(KD,{key:6,modelValue:m.value,"onUpdate:modelValue":ke[3]||(ke[3]=te=>m.value=te),"all-notes":e.notes,"pending-area-ids":y.value.areaIds,areas:e.areas,"is-editing":Q.value,"checkpoint-term-singular":j.value,onChange:ee},null,8,["modelValue","all-notes","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):D("",!0),i.value==="appearance"?(p(),g("div",XD,[r("div",QD,[r("button",{type:"button",class:le(["accordion-header",{expanded:M.value.iconStyle}]),onClick:ke[4]||(ke[4]=te=>R("iconStyle"))},[r("div",{class:"accordion-icon",innerHTML:be.value},null,8,eR),r("span",tR,b(j.value)+" marker style",1),r("span",nR,b(M.value.iconStyle?"":""),1)],2),M.value.iconStyle?(p(),g("div",oR,[r("p",aR," Choose a custom icon for this "+b(K.value)+", or leave as Default to inherit from "+b(se.value)+" or event settings. ",1),Ee(Bf,{"style-type":y.value.styleType||"default","style-color":y.value.styleColor||"","style-background-shape":y.value.styleBackgroundShape||"","style-background-color":y.value.styleBackgroundColor||"","style-border-color":y.value.styleBorderColor||"","style-icon-color":y.value.styleIconColor||"","style-size":y.value.styleSize||"","style-map-rotation":y.value.styleMapRotation??"","inherited-style-type":He.value.type,"inherited-style-color":He.value.color,"inherited-background-shape":He.value.backgroundShape||"","inherited-background-color":He.value.backgroundColor||He.value.color||"","inherited-border-color":He.value.borderColor||"","inherited-icon-color":He.value.iconColor||"","inherited-size":He.value.size||"","inherited-map-rotation":He.value.mapRotation??"","default-label":We.value,"icon-label":"Marker style",level:"checkpoint","show-preview":!0,"onUpdate:styleType":ke[5]||(ke[5]=te=>me("styleType",te)),"onUpdate:styleColor":ke[6]||(ke[6]=te=>me("styleColor",te)),"onUpdate:styleBackgroundShape":ke[7]||(ke[7]=te=>me("styleBackgroundShape",te)),"onUpdate:styleBackgroundColor":ke[8]||(ke[8]=te=>me("styleBackgroundColor",te)),"onUpdate:styleBorderColor":ke[9]||(ke[9]=te=>me("styleBorderColor",te)),"onUpdate:styleIconColor":ke[10]||(ke[10]=te=>me("styleIconColor",te)),"onUpdate:styleSize":ke[11]||(ke[11]=te=>me("styleSize",te)),"onUpdate:styleMapRotation":ke[12]||(ke[12]=te=>me("styleMapRotation",te))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation","default-label"])])):D("",!0)]),r("div",sR,[r("button",{type:"button",class:le(["accordion-header",{expanded:M.value.terminology}]),onClick:ke[13]||(ke[13]=te=>R("terminology"))},[ke[17]||(ke[17]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("circle",{cx:"9",cy:"8",r:"3",fill:"#6366F1"}),r("path",{d:"M3 18c0-3.3 2.7-6 6-6s6 2.7 6 6",fill:"#6366F1",opacity:"0.5"}),r("circle",{cx:"17",cy:"14",r:"5",fill:"#10B981",opacity:"0.3"}),r("circle",{cx:"17",cy:"14",r:"3",fill:"#10B981"}),r("circle",{cx:"17",cy:"14",r:"1",fill:"white"})])],-1)),ke[18]||(ke[18]=r("span",{class:"accordion-title"},"Terminology",-1)),r("span",iR,b(Y.value),1),r("span",lR,b(M.value.terminology?"":""),1)],2),M.value.terminology?(p(),g("div",rR,[r("p",cR," Customise what this "+b(K.value)+" and its "+b(G.value.toLowerCase())+" are called. ",1),r("div",uR,[r("div",dR,[r("label",null,"What is this "+b(K.value)+" called?",1),r("select",{value:y.value.checkpointTerm,class:"form-input",onChange:ke[14]||(ke[14]=te=>{X({...y.value,checkpointTerm:te.target.value}),ee()})},[r("option",fR,"Use "+b(se.value)+" default ("+b(j.value)+")",1),ke[19]||(ke[19]=r("option",{value:"Vehicle"},"Vehicle",-1)),ke[20]||(ke[20]=r("option",{value:"Car"},"Car",-1)),ke[21]||(ke[21]=r("option",{value:"Bike"},"Bike",-1)),(p(!0),g(xe,null,qe(N(_s).checkpoint,te=>(p(),g("option",{key:te,value:te},b(te),9,pR))),128))],40,hR)]),r("div",vR,[r("label",null,"What are "+b(G.value.toLowerCase())+" called here?",1),r("select",{value:y.value.peopleTerm,class:"form-input",onChange:ke[15]||(ke[15]=te=>{X({...y.value,peopleTerm:te.target.value}),ee()})},[r("option",gR,"Use "+b(se.value)+" default ("+b(A.value)+")",1),(p(!0),g(xe,null,qe(N(_s).people,te=>(p(),g("option",{key:te,value:te},b(te),9,yR))),128))],40,mR)])])])):D("",!0)])])):D("",!0),i.value==="incidents"?(p(),g("div",kR,[r("div",bR,[(p(!0),g(xe,null,qe(e.incidents,te=>(p(),ze(gc,{key:te.incidentId,incident:te,onSelect:ke[16]||(ke[16]=ge=>de.$emit("select-incident",ge))},null,8,["incident"]))),128))])])):D("",!0),Ee(Pf,{show:k.value,"marshal-name":$.value,"checkpoint-name":w.value,"check-in-location":_.value,"checkpoint-location":I.value,distance:T.value,"z-index":e.zIndex+100,onClose:E},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance","z-index"])]),_:1},8,["show","is-dirty","z-index"]))}},LR=Ze(CR,[["__scopeId","data-v-221a28c2"]]),SR={class:"tab-content"},IR={key:0,class:"error-banner"},xR=["value"],$R={key:0,class:"field-error"},TR={class:"contact-row"},MR=["value"],AR={key:0,class:"field-error"},ER=["value"],PR={key:0,class:"field-error"},DR=["value"],RR={key:0,class:"field-error"},OR={key:1,class:"magic-link-section"},BR={key:0,class:"loading-text"},NR={key:1,class:"magic-link-container"},FR={class:"magic-link-row"},UR=["value"],zR={key:0,class:"error-text"},HR={key:1,class:"magic-link-actions"},VR=["disabled"],GR={key:2,class:"success-text"},qR={key:3,class:"error-text"},jR={key:2,class:"error-text"},WR={__name:"MarshalDetailsTab",props:{form:{type:Object,required:!0},eventId:{type:String,default:null},marshalId:{type:String,default:null},validationErrors:{type:Object,default:()=>({})}},emits:["update:form","input"],setup(e,{expose:t,emit:n}){const a=e,o=n,i=P(null),l=P(null),c=P(null),d=P(null),h=P(""),f=P(!1),m=P(!1),y=P(""),k=P(!1),S=P(!1),x=P(!1),E=P(""),$=P(!1),w=(R,A)=>{o("update:form",{...a.form,[R]:A}),o("input")},_=async()=>{if(!(!a.eventId||!a.marshalId)){m.value=!0,y.value="";try{const R=await ka.getMagicLink(a.eventId,a.marshalId);h.value=R.data.magicLink,f.value=R.data.hasEmail}catch(R){console.error("Failed to fetch magic link:",R),y.value="Failed to load login link"}finally{m.value=!1}}},I=P(""),T=async()=>{I.value="";try{if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(h.value),k.value=!0,setTimeout(()=>{k.value=!1},2e3);return}}catch(R){console.warn("Clipboard API failed, trying fallback:",R)}try{const R=document.createElement("textarea");R.value=h.value,R.style.position="fixed",R.style.left="-9999px",R.style.top="0",document.body.appendChild(R),R.focus(),R.select();const A=document.execCommand("copy");document.body.removeChild(R),A?(k.value=!0,setTimeout(()=>{k.value=!1},2e3)):(I.value="Copy failed. Please select and copy the link manually.",setTimeout(()=>{I.value=""},4e3))}catch(R){console.error("Fallback copy failed:",R),I.value="Copy not supported. Please select and copy the link manually.",setTimeout(()=>{I.value=""},4e3)}},B=async()=>{if(!(!a.eventId||!a.marshalId)){S.value=!0,x.value=!1,E.value="";try{await ka.sendMagicLink(a.eventId,a.marshalId),x.value=!0,setTimeout(()=>{x.value=!1},3e3)}catch(R){console.error("Failed to send email:",R),E.value=R.response?.data?.message||"Failed to send email"}finally{S.value=!1}}};return Ye(()=>a.marshalId,R=>{R?_():(h.value="",f.value=!1)},{immediate:!0}),t({focusField:R=>{dn(()=>{const G={name:i,email:l,phoneNumber:c,notes:d}[R];G?.value&&(G.value.focus(),G.value.scrollIntoView({behavior:"smooth",block:"center"}))})}}),(R,A)=>(p(),g("div",SR,[e.validationErrors.general?(p(),g("div",IR,b(e.validationErrors.general),1)):D("",!0),r("div",{class:le(["form-group",{"has-error":e.validationErrors.name}])},[A[7]||(A[7]=r("label",null,"Name *",-1)),r("input",{ref_key:"nameInputRef",ref:i,value:e.form.name,onInput:A[0]||(A[0]=G=>w("name",G.target.value)),type:"text",required:"",class:le(["form-input",{"input-error":e.validationErrors.name}])},null,42,xR),e.validationErrors.name?(p(),g("span",$R,b(e.validationErrors.name),1)):D("",!0)],2),r("div",TR,[r("div",{class:le(["form-group contact-email",{"has-error":e.validationErrors.email}])},[A[8]||(A[8]=r("label",null,"Email",-1)),r("input",{ref_key:"emailInputRef",ref:l,value:e.form.email,onInput:A[1]||(A[1]=G=>w("email",G.target.value)),type:"email",class:le(["form-input",{"input-error":e.validationErrors.email}])},null,42,MR),e.validationErrors.email?(p(),g("span",AR,b(e.validationErrors.email),1)):D("",!0)],2),r("div",{class:le(["form-group contact-phone",{"has-error":e.validationErrors.phoneNumber}])},[A[9]||(A[9]=r("label",null,"Phone number",-1)),r("input",{ref_key:"phoneInputRef",ref:c,value:e.form.phoneNumber,onInput:A[2]||(A[2]=G=>w("phoneNumber",G.target.value)),type:"tel",class:le(["form-input",{"input-error":e.validationErrors.phoneNumber}])},null,42,ER),e.validationErrors.phoneNumber?(p(),g("span",PR,b(e.validationErrors.phoneNumber),1)):D("",!0)],2)]),r("div",{class:le(["form-group",{"has-error":e.validationErrors.notes}])},[A[10]||(A[10]=r("label",null,"Additional details",-1)),r("textarea",{ref_key:"notesInputRef",ref:d,value:e.form.notes,onInput:A[3]||(A[3]=G=>w("notes",G.target.value)),class:le(["form-input",{"input-error":e.validationErrors.notes}]),rows:"3",placeholder:"e.g., Needs to leave by 11am"},null,42,DR),e.validationErrors.notes?(p(),g("span",RR,b(e.validationErrors.notes),1)):D("",!0)],2),e.marshalId?(p(),g("div",OR,[A[12]||(A[12]=r("label",null,"Login link",-1)),A[13]||(A[13]=r("p",{class:"help-text"},"Share this unique link with the marshal so they can access their dashboard.",-1)),m.value?(p(),g("div",BR,"Loading link...")):h.value?(p(),g("div",NR,[r("div",FR,[r("input",{type:"text",value:h.value,readonly:"",class:"form-input magic-link-input",onFocus:A[4]||(A[4]=G=>G.target.select())},null,40,UR),r("button",{type:"button",class:"btn btn-secondary",onClick:T},b(k.value?"Copied!":"Copy link"),1),r("button",{type:"button",class:"btn btn-secondary",onClick:A[5]||(A[5]=G=>$.value=!0),title:"Show QR code"},[...A[11]||(A[11]=[fi('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-6c3801fd><rect x="3" y="3" width="7" height="7" data-v-6c3801fd></rect><rect x="14" y="3" width="7" height="7" data-v-6c3801fd></rect><rect x="3" y="14" width="7" height="7" data-v-6c3801fd></rect><rect x="14" y="14" width="3" height="3" data-v-6c3801fd></rect><rect x="19" y="14" width="2" height="2" data-v-6c3801fd></rect><rect x="14" y="19" width="2" height="2" data-v-6c3801fd></rect><rect x="19" y="19" width="2" height="2" data-v-6c3801fd></rect></svg>',1)])])]),I.value?(p(),g("p",zR,b(I.value),1)):D("",!0),f.value?(p(),g("div",HR,[r("button",{type:"button",class:"btn btn-primary",disabled:S.value,onClick:B},b(S.value?"Sending...":"Send via email"),9,VR)])):D("",!0),x.value?(p(),g("p",GR,"Email sent successfully!")):D("",!0),E.value?(p(),g("p",qR,b(E.value),1)):D("",!0)])):y.value?(p(),g("div",jR,b(y.value),1)):D("",!0)])):D("",!0),Ee(Ff,{show:$.value,url:h.value,title:"Scan to log in",onClose:A[6]||(A[6]=G=>$.value=!1)},null,8,["show","url"])]))}},ZR=Ze(WR,[["__scopeId","data-v-6c3801fd"]]),KR={class:"card-header"},YR={class:"checkpoint-name-row"},JR=["innerHTML"],XR={class:"checkpoint-name"},QR={key:0,class:"checkpoint-description"},eO={key:0,class:"card-areas"},tO={key:1,class:"card-check-in"},nO={key:0,class:"check-in-time"},oO={key:0,class:"check-in-method"},aO={key:1,class:"unsaved-indicator"},sO={key:2,class:"card-locked"},iO={class:"locked-badge"},lO={key:3,class:"card-badge"},rO={key:4,class:"card-badge"},cO={__name:"MarshalCheckpointCard",props:{assignment:{type:Object,required:!0},location:{type:Object,default:null},areas:{type:Array,default:()=>[]},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isLocked:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1}},emits:["click","toggle-check-in","remove","undo-remove","distance-click"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=z(()=>a.location?a.location.areaIds||a.location.AreaIds||[]:[]),l=z(()=>i.value.map($=>{const w=a.areas.find(_=>_.id===$);return w?w.name:null}).filter(Boolean)),c=z(()=>i.value.map($=>{const w=a.areas.find(_=>_.id===$);return w?w.color:"#999"})),d=z(()=>{if(!a.location)return"#667eea";const $=a.location,w=$.resolvedStyleBackgroundColor||$.ResolvedStyleBackgroundColor||$.resolvedStyleColor||$.ResolvedStyleColor;if(w)return w;if(i.value.length>0){const _=a.areas.find(I=>I.id===i.value[0]);if(_)return _.color}return"#667eea"}),h=z(()=>{if(!a.location)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
    </svg>`;const $=a.location,w=$.resolvedStyleType||$.ResolvedStyleType,_=$.resolvedStyleBackgroundColor||$.ResolvedStyleBackgroundColor||$.resolvedStyleColor||$.ResolvedStyleColor,I=$.resolvedStyleBorderColor||$.ResolvedStyleBorderColor,T=$.resolvedStyleIconColor||$.ResolvedStyleIconColor,B=$.resolvedStyleBackgroundShape||$.ResolvedStyleBackgroundShape;return w&&w!=="default"||_||I||T||B&&B!=="circle"?Vn({type:w||"circle",backgroundShape:B||"circle",backgroundColor:_||"#667eea",borderColor:I||"#ffffff",iconColor:T||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),f=$=>$?new Date($).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",m=z(()=>{const{checkedInBy:$,checkInMethod:w,marshalName:_}=a.assignment;return $&&$!==_?$:w||""}),y=z(()=>{const{checkInLatitude:$,checkInLongitude:w}=a.assignment,_=a.location;return!$||!w||!_?.latitude||!_?.longitude?null:dl($,w,_.latitude,_.longitude)}),k=z(()=>y.value===null?null:y.value<1e3?`${Math.round(y.value)} m`:`${(y.value/1e3).toFixed(2)} km`),S=z(()=>y.value===null?"":y.value<=50?"distance-close":y.value<=100?"distance-medium":"distance-far"),x=()=>{!a.assignment.isPending&&!a.isMarkedForRemoval&&!a.isLocked&&o("click",a.assignment)},E=()=>{o("distance-click",a.assignment)};return($,w)=>(p(),g("div",{class:le(["marshal-checkpoint-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-locked":e.isLocked}]),style:nt({borderLeftColor:e.isMarkedForRemoval?void 0:d.value})},[r("div",KR,[r("div",{class:"card-title",onClick:x},[r("span",YR,[r("span",{class:"checkpoint-icon",innerHTML:h.value},null,8,JR),r("span",XR,b(e.assignment.locationName),1),e.assignment.locationDescription?(p(),g("span",QR,"  "+b(e.assignment.locationDescription),1)):D("",!0)])]),!e.isLocked&&!e.isMarkedForRemoval?(p(),g("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:w[0]||(w[0]=ct(_=>$.$emit("remove",e.assignment),["stop"]))},"  ")):D("",!0),e.isMarkedForRemoval?(p(),g("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:w[1]||(w[1]=ct(_=>$.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):D("",!0)]),l.value.length>0&&!e.isMarkedForRemoval?(p(),g("div",eO,[(p(!0),g(xe,null,qe(l.value,(_,I)=>(p(),g("span",{key:I,class:"area-badge",style:nt({backgroundColor:c.value[I]})},b(_),5))),128))])):D("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.isLocked?(p(),g("div",tO,[r("button",{class:le(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:w[2]||(w[2]=_=>$.$emit("toggle-check-in",e.assignment))},[...w[3]||(w[3]=[r("span",{class:"toggle-icon"},"",-1),r("span",{class:"toggle-label-wrapper"},[r("span",{class:"toggle-label toggle-label-check-in"},"Check in"),r("span",{class:"toggle-label toggle-label-checked-in"},"Checked in")],-1)])],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(p(),g("span",nO,[Je(b(f(e.assignment.checkInTime))+" ",1),m.value?(p(),g("span",oO,"("+b(m.value)+")",1)):D("",!0),k.value?(p(),g("span",{key:1,class:le(["check-in-distance",S.value]),onClick:ct(E,["stop"])},b(k.value),3)):D("",!0)])):e.hasUnsavedChanges?(p(),g("span",aO," Unsaved ")):D("",!0)])):D("",!0),e.isLocked&&!e.isMarkedForRemoval?(p(),g("div",sO,[r("span",iO,"Viewing from this "+b(N(n).checkpoint),1)])):D("",!0),e.assignment.isPending?(p(),g("div",lO,[...w[4]||(w[4]=[r("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):D("",!0),e.isMarkedForRemoval?(p(),g("div",rO,[...w[5]||(w[5]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):D("",!0)],6))}},uO=Ze(cO,[["__scopeId","data-v-d3de6925"]]),dO={class:"tab-content"},hO={key:0,class:"read-only-notice"},fO={class:"section-title"},pO={key:1,class:"form-group",style:{"margin-top":"1.5rem"}},vO={value:""},mO=["value"],gO={__name:"MarshalCheckpointsTab",props:{assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isNewMarshal:{type:Boolean,default:!1},lockedCheckpointId:{type:String,default:null}},emits:["input","remove-assignment","assign-to-location","select-checkpoint","distance-click"],setup(e,{expose:t,emit:n}){const{termsLower:a}=ht(),o=e,i=n,{pendingCheckInChanges:l,getEffectiveCheckInStatus:c,handleToggleCheckIn:d}=k1(()=>i("input")),h=P(""),f=P(new Set),m=z(()=>o.assignments?.length||0),y=G=>o.allLocations&&o.allLocations.find(F=>F.id===G)||null,k=z(()=>[...o.assignments].sort((G,F)=>(G.locationName||"").localeCompare(F.locationName||"",void 0,{numeric:!0,sensitivity:"base"}))),S=G=>f.value.has(G),x=G=>{G.isPending||i("select-checkpoint",G)},E=P(!1),$=P(null),w=G=>{c(G)?($.value=G,E.value=!0):d(G)},_=()=>{$.value&&d($.value),E.value=!1,$.value=null},I=()=>{E.value=!1,$.value=null},T=z(()=>$.value?`Are you sure you want to undo ${$.value.marshalName||"this marshal"}'s check-in?`:""),B=G=>{G.isPending?i("remove-assignment",G):(f.value.add(G.id),i("input"))},M=G=>{f.value.delete(G.id),i("input")},R=z(()=>{const G=[...o.availableLocations];return G.sort((F,j)=>F.name.localeCompare(j.name,void 0,{numeric:!0,sensitivity:"base"})),G}),A=()=>{h.value&&(i("assign-to-location",h.value),h.value="")};return t({pendingCheckInChanges:l,clearPendingChanges:()=>{l.value.clear(),f.value.clear(),h.value=""},getPendingChanges:()=>Array.from(l.value.entries()).map(([G,F])=>({assignmentId:G,shouldBeCheckedIn:F})),getMarkedForRemoval:()=>Array.from(f.value)}),(G,F)=>(p(),g("div",dO,[e.lockedCheckpointId?(p(),g("div",hO," Viewing from "+b(N(a).checkpoint)+" - "+b(N(a).checkpoints)+" cannot be modified here. ",1)):D("",!0),r("h3",fO,"Assigned "+b(N(a).checkpoints)+" ("+b(m.value)+")",1),Ee(yc,{"is-empty":e.assignments.length===0,"empty-message":`No ${N(a).checkpoints} assigned yet.`,"empty-hint":e.lockedCheckpointId?"":`Use the dropdown below to assign this ${N(a).person} to ${N(a).checkpoints}.`},{default:Ue(()=>[(p(!0),g(xe,null,qe(k.value,j=>(p(),ze(uO,{key:j.id,assignment:j,location:y(j.locationId),areas:e.areas,"effective-check-in-status":N(c)(j),"has-unsaved-changes":N(l).has(j.id),"is-locked":!!e.lockedCheckpointId,"is-marked-for-removal":S(j.id),onClick:x,onToggleCheckIn:w,onRemove:B,onUndoRemove:M,onDistanceClick:F[0]||(F[0]=K=>G.$emit("distance-click",K))},null,8,["assignment","location","areas","effective-check-in-status","has-unsaved-changes","is-locked","is-marked-for-removal"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),!e.lockedCheckpointId&&R.value.length>0?(p(),g("div",pO,[r("label",null,"Assign to "+b(N(a).checkpoint),1),Ge(r("select",{"onUpdate:modelValue":F[1]||(F[1]=j=>h.value=j),class:"form-input",onChange:A},[r("option",vO,"Select a "+b(N(a).checkpoint)+"...",1),(p(!0),g(xe,null,qe(R.value,j=>(p(),g("option",{key:j.id,value:j.id},[Je(b(j.name),1),j.description?(p(),g(xe,{key:0},[Je(" - "+b(j.description),1)],64)):D("",!0)],8,mO))),128))],544),[[no,h.value]])])):D("",!0),Ee(vi,{show:E.value,title:"Confirm check-out",message:T.value,"confirm-text":"Check out","is-danger":!0,onConfirm:_,onCancel:I},null,8,["show","message"])]))}},yO=Ze(gO,[["__scopeId","data-v-07754949"]]),kO={class:"tab-content roles-tab"},bO={key:0,class:"empty-state"},_O={class:"help-text"},wO={key:1,class:"roles-list"},CO={class:"roles-label"},LO={class:"available-roles"},SO=["onClick"],IO={class:"role-checkbox"},xO=["checked","onChange"],$O={class:"role-info"},TO={class:"role-name"},MO={__name:"MarshalRolesTab",props:{roles:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]}},emits:["update:roles","input"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=z(()=>a.roles||[]),l=P(new Set);Ye(()=>a.roles,f=>{l.value.size===0&&f&&f.length>0&&(l.value=new Set(f))},{immediate:!0});const c=z(()=>[...a.roleDefinitions].sort((f,m)=>{const y=l.value.has(f.roleId),k=l.value.has(m.roleId);return y!==k?y?-1:1:f.displayOrder!==m.displayOrder?(f.displayOrder||0)-(m.displayOrder||0):(f.name||"").localeCompare(m.name||"",void 0,{numeric:!0,sensitivity:"base"})})),d=z(()=>c.value),h=f=>{const m=i.value.includes(f);let y;m?y=i.value.filter(k=>k!==f):y=[...i.value,f],o("update:roles",y),o("input")};return(f,m)=>(p(),g("div",kO,[e.roleDefinitions.length===0?(p(),g("div",bO,[m[1]||(m[1]=r("p",null,"No roles have been defined for this event yet.",-1)),r("p",_O,"Create roles in the Roles tab to assign them to "+b(N(n).people)+".",1)])):(p(),g("div",wO,[r("label",CO,"Select roles for this "+b(N(n).person),1),r("div",LO,[(p(!0),g(xe,null,qe(d.value,y=>(p(),g("div",{key:y.roleId,class:le(["role-option",{selected:i.value.includes(y.roleId)}]),onClick:k=>h(y.roleId)},[r("div",IO,[r("input",{type:"checkbox",checked:i.value.includes(y.roleId),onClick:m[0]||(m[0]=ct(()=>{},["stop"])),onChange:k=>h(y.roleId)},null,40,xO)]),r("div",$O,[r("span",TO,b(y.name),1)])],10,SO))),128))])]))]))}},AO=Ze(MO,[["__scopeId","data-v-f56e155c"]]),EO={class:"marshal-checklist-view"},PO={key:0,class:"loading-state"},DO={key:1,class:"error-state"},RO={key:2,class:"empty-state"},OO={__name:"MarshalChecklistView",props:{eventId:{type:String,required:!0},marshalId:{type:String,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["update:modelValue","change","reorder"],setup(e,{expose:t,emit:n}){const{termsLower:a}=ht(),o=e,i=n,l=P([]),c=P(!1),d=P(null),h=P(new Map),f=z(()=>l.value.map(E=>{const $=h.value.get(E.itemId),w=$!==void 0?$.complete:E.isCompleted,_=$!==void 0&&$.complete!==E.isCompleted;return{...E,localIsCompleted:w,isModified:_}})),m=async()=>{if(!(!o.eventId||!o.marshalId)){c.value=!0,d.value=null;try{const E=await Nt.getMarshalChecklist(o.eventId,o.marshalId);if(l.value=E.data||[],o.modelValue&&o.modelValue.length>0){const $=new Map;o.modelValue.forEach(w=>{$.set(w.itemId,{complete:w.complete,contextType:w.contextType,contextId:w.contextId})}),h.value=$}}catch(E){console.error("Failed to load checklist:",E),d.value=E.response?.data?.message||"Failed to load checklist"}finally{c.value=!1}}},y=E=>{const $=h.value.get(E.itemId),w=$!==void 0?$.complete:E.isCompleted;h.value.set(E.itemId,{complete:!w,contextType:E.completionContextType,contextId:E.completionContextId}),k()},k=()=>{const E=[];for(const[$,w]of h.value.entries()){const _=l.value.find(I=>I.itemId===$);_&&w.complete!==_.isCompleted&&E.push({itemId:$,complete:w.complete,contextType:w.contextType,contextId:w.contextId})}i("update:modelValue",E),i("change",E)},S=E=>{i("reorder",E)};return t({resetLocalState:()=>{if(h.value=new Map,o.modelValue&&o.modelValue.length>0){const E=new Map;o.modelValue.forEach($=>{E.set($.itemId,{complete:$.complete,contextType:$.contextType,contextId:$.contextId})}),h.value=E}},loadChecklist:m}),Ye(()=>[o.eventId,o.marshalId],()=>{m()},{immediate:!0}),(E,$)=>(p(),g("div",EO,[c.value?(p(),g("div",PO," Loading checklist... ")):d.value?(p(),g("div",DO,[r("p",null,b(d.value),1),r("button",{onClick:m,class:"btn btn-secondary btn-small"}," Retry ")])):l.value.length===0?(p(),g("div",RO,[r("p",null,"No checklist items for this "+b(N(a).person)+".",1)])):(p(),ze(Uf,{key:3,items:f.value,locations:e.locations,areas:e.areas,"allow-reorder":e.allowReorder,onToggleComplete:y,onReorder:S},null,8,["items","locations","areas","allow-reorder"]))]))}},BO=Ze(OO,[["__scopeId","data-v-38a322f4"]]),NO={class:"checklist-preview"},FO={class:"preview-actions"},UO={class:"preview-header"},zO={key:0,class:"add-item-form"},HO=["placeholder"],VO=["disabled"],GO={key:1,class:"pending-items"},qO={class:"item-content"},jO={class:"item-header"},WO={class:"item-text"},ZO={class:"item-scope"},KO=["onClick"],YO={key:2,class:"empty-state"},JO={key:0,class:"help-text"},XO={key:3,class:"checklist-items"},QO={class:"item-content"},eB={class:"item-header"},tB={class:"item-text"},nB={class:"item-scope"},oB=["title"],aB={key:0,class:"item-context"},sB={__name:"ChecklistPreview",props:{allChecklistItems:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=P(!1),l=P(""),c=P([...a.modelValue]);Ye(()=>a.modelValue,w=>{c.value=[...w]},{deep:!0});const d=()=>{l.value.trim()&&(c.value.push({text:l.value.trim(),isNew:!0}),l.value="",i.value=!1,f())},h=w=>{c.value.splice(w,1),f()},f=()=>{o("update:modelValue",[...c.value]),o("change")},m=z(()=>{const w=new Set;for(const _ of a.pendingLocationIds){const I=a.allLocations.find(T=>T.id===_);I&&(I.areaIds||I.AreaIds||[]).forEach(B=>w.add(B))}return[...w]}),y=w=>{const _=w.scope,I=w.itemType,T=w.ids||[];return _==="SpecificPeople"&&I==="Marshal"?T.includes("ALL_MARSHALS"):(_==="EveryoneAtCheckpoints"||_==="OnePerCheckpoint")&&I==="Checkpoint"?T.includes("ALL_CHECKPOINTS")?!0:T.some(B=>a.pendingLocationIds.includes(B)):_==="OnePerCheckpoint"&&I==="Area"?T.includes("ALL_AREAS")?!0:T.some(B=>m.value.includes(B)):(_==="EveryoneInAreas"||_==="OnePerArea"||_==="EveryAreaLead"||_==="OneLeadPerArea")&&I==="Area"?T.includes("ALL_AREAS")?!0:T.some(B=>m.value.includes(B)):!1},k=z(()=>a.allChecklistItems.filter(w=>w.scopeConfigurations&&w.scopeConfigurations.length>0?w.scopeConfigurations.some(_=>y(_)):!1)),S=w=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${n.value.checkpoints}`,OnePerCheckpoint:`One per ${n.value.checkpoint}`,EveryoneInAreas:`All in ${n.value.areas}`,OnePerArea:`One per ${n.value.area}`,EveryAreaLead:`${n.value.area} leads`,OneLeadPerArea:`One lead per ${n.value.area}`})[w]||w,x=w=>{if(!w.scopeConfigurations||w.scopeConfigurations.length===0)return"Unknown";const _=w.scopeConfigurations.find(T=>y(T));if(!_)return S(w.scopeConfigurations[0].scope);const I=_.ids||[];return I.includes("ALL_MARSHALS")?"Everyone":I.includes("ALL_CHECKPOINTS")?`All ${n.value.checkpoints}`:I.includes("ALL_AREAS")?`All ${n.value.areas}`:S(_.scope)},E=w=>{if(!w.scopeConfigurations||w.scopeConfigurations.length===0)return"";const _=w.scopeConfigurations.find(T=>y(T));return _&&{SpecificPeople:"This item is for everyone at the event",EveryoneAtCheckpoints:`This item is for everyone at specified ${n.value.checkpoints}`,OnePerCheckpoint:`One person at each ${n.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${n.value.areas}`,OnePerArea:`One person in each ${n.value.area} needs to complete this`,EveryAreaLead:`This item is for ${n.value.area} leads only`,OneLeadPerArea:`One ${n.value.area} lead needs to complete this`}[_.scope]||""},$=w=>{if(!w.scopeConfigurations||w.scopeConfigurations.length===0)return null;const _=w.scopeConfigurations.find(B=>y(B));if(!_)return null;const I=_.itemType,T=_.ids||[];if(T.includes("ALL_MARSHALS")||T.includes("ALL_CHECKPOINTS")||T.includes("ALL_AREAS"))return null;if(I==="Checkpoint"){const B=a.allLocations.filter(M=>T.includes(M.id)&&a.pendingLocationIds.includes(M.id)).map(M=>M.name);if(B.length>0)return`At: ${B.join(", ")}`}if(I==="Area"){const B=a.areas.filter(M=>T.includes(M.id)&&m.value.includes(M.id)).map(M=>M.name);if(B.length>0)return`In: ${B.join(", ")}`}return null};return(w,_)=>(p(),g("div",NO,[r("div",FO,[r("p",UO,b(e.isEditing?`Add new ${N(n).checklist} for this ${N(n).person}:`:`${N(n).checklists} that will apply to this ${N(n).person}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:_[0]||(_[0]=I=>i.value=!i.value)},b(i.value?"Cancel":`Add ${N(n).checklist}`),1)]),i.value?(p(),g("div",zO,[Ge(r("input",{"onUpdate:modelValue":_[1]||(_[1]=I=>l.value=I),type:"text",placeholder:`Enter ${N(n).checklist} text...`,class:"add-item-input",onKeyup:ya(d,["enter"])},null,40,HO),[[st,l.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim(),onClick:d}," Add ",8,VO)])):D("",!0),c.value.length>0?(p(),g("div",GO,[(p(!0),g(xe,null,qe(c.value,(I,T)=>(p(),g("div",{key:`pending-${T}`,class:"checklist-item pending"},[_[3]||(_[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",qO,[r("div",jO,[r("div",WO,b(I.text),1),r("div",ZO,[_[2]||(_[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:B=>h(T),title:"Remove"},"  ",8,KO)])])])]))),128))])):D("",!0),!e.isEditing&&k.value.length===0&&c.value.length===0?(p(),g("div",YO,[r("p",null,"No "+b(N(n).checklists)+" will apply based on the current "+b(N(n).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(p(),g("p",JO," Assign "+b(N(n).checkpoints)+" to see relevant "+b(N(n).checklists)+". ",1)):D("",!0)])):D("",!0),!e.isEditing&&k.value.length>0?(p(),g("div",XO,[(p(!0),g(xe,null,qe(k.value,I=>(p(),g("div",{key:I.id,class:"checklist-item"},[_[4]||(_[4]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",QO,[r("div",eB,[r("div",tB,b(I.text),1),r("div",nB,[r("span",{class:"scope-pill",title:E(I)},b(x(I)),9,oB)])]),$(I)?(p(),g("div",aB,b($(I)),1)):D("",!0)])]))),128))])):D("",!0)]))}},iB=Ze(sB,[["__scopeId","data-v-6deaacc2"]]),lB={class:"notes-preview"},rB={class:"preview-actions"},cB={class:"preview-header"},uB={key:0,class:"add-item-form"},dB={class:"add-form-fields"},hB=["disabled"],fB={key:1,class:"pending-items"},pB={class:"note-header"},vB={class:"note-title"},mB={class:"note-actions"},gB=["onClick"],yB={key:0,class:"note-content"},kB={key:2,class:"empty-state"},bB={key:0,class:"help-text"},_B={key:3,class:"notes-list"},wB={class:"note-header"},CB={class:"note-title"},LB=["title"],SB={key:0,class:"note-content"},IB={key:1,class:"note-context"},xB={__name:"NotesPreview",props:{allNotes:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=P(!1),l=P(""),c=P(""),d=P([...a.modelValue]);Ye(()=>a.modelValue,_=>{d.value=[..._]},{deep:!0});const h=()=>{!l.value.trim()&&!c.value.trim()||(d.value.push({title:l.value.trim(),content:c.value.trim(),isNew:!0}),l.value="",c.value="",i.value=!1,m())},f=_=>{d.value.splice(_,1),m()},m=()=>{o("update:modelValue",[...d.value]),o("change")},y=z(()=>{const _=new Set;for(const I of a.pendingLocationIds){const T=a.allLocations.find(B=>B.id===I);T&&(T.areaIds||T.AreaIds||[]).forEach(M=>_.add(M))}return[..._]}),k=_=>{const I=_.scope,T=_.itemType,B=_.ids||[];return I==="SpecificPeople"&&T==="Marshal"?B.includes("ALL_MARSHALS"):I==="EveryoneAtCheckpoints"&&T==="Checkpoint"?B.includes("ALL_CHECKPOINTS")?!0:B.some(M=>a.pendingLocationIds.includes(M)):I==="EveryoneInAreas"&&T==="Area"?B.includes("ALL_AREAS")?!0:B.some(M=>y.value.includes(M)):!1},S=z(()=>a.allNotes.filter(_=>_.scopeConfigurations&&_.scopeConfigurations.length>0?_.scopeConfigurations.some(I=>k(I)):!1)),x=_=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${n.value.checkpoints}`,EveryoneInAreas:`All in ${n.value.areas}`})[_]||_,E=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"Unknown";const I=_.scopeConfigurations.find(B=>k(B));if(!I)return x(_.scopeConfigurations[0].scope);const T=I.ids||[];return T.includes("ALL_MARSHALS")?"Everyone":T.includes("ALL_CHECKPOINTS")?`All ${n.value.checkpoints}`:T.includes("ALL_AREAS")?`All ${n.value.areas}`:x(I.scope)},$=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return"";const I=_.scopeConfigurations.find(B=>k(B));return I&&{SpecificPeople:"This note is for everyone at the event",EveryoneAtCheckpoints:`This note is for everyone at specified ${n.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${n.value.areas}`}[I.scope]||""},w=_=>{if(!_.scopeConfigurations||_.scopeConfigurations.length===0)return null;const I=_.scopeConfigurations.find(M=>k(M));if(!I)return null;const T=I.itemType,B=I.ids||[];if(B.includes("ALL_MARSHALS")||B.includes("ALL_CHECKPOINTS")||B.includes("ALL_AREAS"))return null;if(T==="Checkpoint"){const M=a.allLocations.filter(R=>B.includes(R.id)&&a.pendingLocationIds.includes(R.id)).map(R=>R.name);if(M.length>0)return`At: ${M.join(", ")}`}if(T==="Area"){const M=a.areas.filter(R=>B.includes(R.id)&&y.value.includes(R.id)).map(R=>R.name);if(M.length>0)return`In: ${M.join(", ")}`}return null};return(_,I)=>(p(),g("div",lB,[r("div",rB,[r("p",cB,b(e.isEditing?`Add new note for this ${N(n).person}:`:`Notes that will be visible to this ${N(n).person}:`),1),r("button",{type:"button",class:"add-item-btn",onClick:I[0]||(I[0]=T=>i.value=!i.value)},b(i.value?"Cancel":"Add note"),1)]),i.value?(p(),g("div",uB,[r("div",dB,[Ge(r("input",{"onUpdate:modelValue":I[1]||(I[1]=T=>l.value=T),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[st,l.value]]),Ge(r("textarea",{"onUpdate:modelValue":I[2]||(I[2]=T=>c.value=T),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[st,c.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim()&&!c.value.trim(),onClick:h}," Add ",8,hB)])):D("",!0),d.value.length>0?(p(),g("div",fB,[(p(!0),g(xe,null,qe(d.value,(T,B)=>(p(),g("div",{key:`pending-${B}`,class:"note-item pending"},[r("div",pB,[r("span",vB,b(T.title||"Untitled"),1),r("div",mB,[I[3]||(I[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:M=>f(B),title:"Remove"},"  ",8,gB)])]),T.content?(p(),g("div",yB,b(T.content),1)):D("",!0)]))),128))])):D("",!0),!e.isEditing&&S.value.length===0&&d.value.length===0?(p(),g("div",kB,[r("p",null,"No notes will be visible based on the current "+b(N(n).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(p(),g("p",bB," Assign "+b(N(n).checkpoints)+" to see relevant notes. ",1)):D("",!0)])):D("",!0),!e.isEditing&&S.value.length>0?(p(),g("div",_B,[(p(!0),g(xe,null,qe(S.value,T=>(p(),g("div",{key:T.id,class:"note-item"},[r("div",wB,[r("span",CB,b(T.title||"Untitled"),1),r("span",{class:"scope-pill",title:$(T)},b(E(T)),9,LB)]),T.content?(p(),g("div",SB,b(T.content),1)):D("",!0),w(T)?(p(),g("div",IB,b(w(T)),1)):D("",!0)]))),128))])):D("",!0)]))}},$B=Ze(xB,[["__scopeId","data-v-e8e0946a"]]),TB={key:6,class:"tab-content incidents-tab"},MB={class:"incidents-list"},AB={class:"custom-footer"},EB={class:"footer-left"},PB={__name:"EditMarshalModal",props:{show:{type:Boolean,default:!1},marshal:{type:Object,default:null},eventId:{type:String,required:!0},assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1},eventNotes:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},incidents:{type:Array,default:()=>[]},allMarshals:{type:Array,default:()=>[]},validationErrors:{type:Object,default:()=>({})},lockedCheckpointId:{type:String,default:null},zIndex:{type:Number,default:1e3},roleDefinitions:{type:Array,default:()=>[]}},emits:["close","save","delete","toggle-check-in","remove-assignment","assign-to-location","update:isDirty","select-incident","select-checkpoint","reorder-notes","reorder-checklists"],setup(e,{expose:t,emit:n}){const{terms:a,termsLower:o}=ht(),i=e,l=n,c=P("details"),d=P(null),h=P(null),f=P(null),m=P([]),y=P([]),k=P([]),S=P([]),x=P({name:"",email:"",phoneNumber:"",notes:"",roles:[]}),E=P(!1),$=P(null),w=ee=>{$.value=ee,E.value=!0},_=()=>{E.value=!1,$.value=null},I=ee=>i.allLocations.find(Ce=>Ce.id===ee),T=z(()=>x.value.name||i.marshal?.name||""),B=z(()=>$.value&&I($.value.locationId)?.name||""),M=z(()=>{if(!$.value)return null;const{checkInLatitude:ee,checkInLongitude:Ce}=$.value;return!ee||!Ce?null:{lat:ee,lng:Ce}}),R=z(()=>{if(!$.value)return null;const ee=I($.value.locationId);return!ee?.latitude||!ee?.longitude?null:{lat:ee.latitude,lng:ee.longitude}}),A=z(()=>{if(!$.value)return null;const{checkInLatitude:ee,checkInLongitude:Ce,locationId:Ne}=$.value,Be=I(Ne);return!ee||!Ce||!Be?.latitude||!Be?.longitude?null:dl(ee,Ce,Be.latitude,Be.longitude)}),G=z(()=>{const ee=i.isEditing?`Edit ${o.value.person}`:`Create ${o.value.person}`,Ce=x.value.name?.trim();return Ce?`${ee} - ${Ce}`:ee}),F=z(()=>{const ee=[{value:"details",label:"Details",icon:"details"},{value:"checkpoints",label:a.value.checkpoints,icon:"checkpoint"},{value:"checklists",label:a.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}];return i.incidents&&i.incidents.length>0&&ee.push({value:"incidents",label:"Incidents",icon:"incidents"}),ee.push({value:"roles",label:"Roles",icon:"roles"}),ee}),j=z(()=>F.value.findIndex(ee=>ee.value===c.value)),K=z(()=>j.value===F.value.length-1),J=z(()=>K.value?null:F.value[j.value+1]),ue=z(()=>J.value?`${J.value.label}...`:""),Z=z(()=>y.value.map(ee=>ee.locationId)),se=z(()=>i.isEditing?i.assignments:y.value.map(ee=>({id:`pending-${ee.locationId}`,locationId:ee.locationId,locationName:i.allLocations.find(Ce=>Ce.id===ee.locationId)?.name||"Unknown",isPending:!0}))),U=z(()=>{if(i.isEditing)return i.availableLocations;const ee=y.value.map(Ce=>Ce.locationId);return i.allLocations.filter(Ce=>!ee.includes(Ce.id))});Ye(()=>i.marshal,ee=>{ee?x.value={name:ee.name||"",email:ee.email||"",phoneNumber:ee.phoneNumber||"",notes:ee.notes||"",roles:ee.roles||[]}:x.value={name:"",email:"",phoneNumber:"",notes:"",roles:[]}},{immediate:!0,deep:!0}),Ye(()=>i.show,ee=>{ee&&(c.value="details",m.value=[],y.value=[],k.value=[],S.value=[],i.isEditing||(x.value={name:"",email:"",phoneNumber:"",notes:"",roles:[]}),h.value?.clearPendingChanges&&h.value.clearPendingChanges(),f.value?.resetLocalState&&f.value.resetLocalState())});const Q=ee=>{x.value=ee},oe=ee=>{x.value={...x.value,roles:ee}},he=()=>{l("update:isDirty",!0)},Te=()=>{l("update:isDirty",!0)},je=()=>{J.value&&(c.value=J.value.value)},He=ee=>{l("reorder-notes",ee)},We=ee=>{l("reorder-checklists",ee)},be=()=>{const ee={...x.value,checkInChanges:h.value?.getPendingChanges?.()||[],assignmentsToRemove:h.value?.getMarkedForRemoval?.()||[],checklistChanges:m.value||[],pendingAssignments:i.isEditing?[]:y.value,pendingNewChecklistItems:k.value,pendingNewNotes:S.value};l("save",ee)},V=()=>{l("delete")},Y=ee=>{!i.isEditing&&ee.isPending?y.value=y.value.filter(Ce=>Ce.locationId!==ee.locationId):l("remove-assignment",ee)},re=ee=>{i.isEditing?l("assign-to-location",ee):(y.value.push({locationId:ee}),l("update:isDirty",!0))},ie=ee=>{l("select-checkpoint",ee)},$e=()=>{l("close")};return t({switchToTab:ee=>{c.value=ee},focusField:ee=>{d.value?.focusField&&d.value.focusField(ee)}}),(ee,Ce)=>(p(),ze(jt,{show:e.show,title:G.value,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:$e},{"tab-header":Ue(()=>[Ee(gl,{modelValue:c.value,"onUpdate:modelValue":Ce[0]||(Ce[0]=Ne=>c.value=Ne),tabs:F.value},null,8,["modelValue","tabs"])]),footer:Ue(()=>[r("div",AB,[r("div",EB,[e.isEditing&&!e.lockedCheckpointId?(p(),g("button",{key:0,type:"button",onClick:V,class:"btn btn-danger"}," Delete ")):D("",!0),!e.isEditing&&!K.value?(p(),g("button",{key:1,type:"button",onClick:je,class:"btn btn-secondary mobile-only"},b(ue.value),1)):D("",!0)]),r("button",{type:"button",onClick:be,class:"btn btn-success"}," Save ")])]),default:Ue(()=>[c.value==="details"?(p(),ze(ZR,{key:0,ref_key:"detailsTabRef",ref:d,form:x.value,"event-id":e.eventId,"marshal-id":e.isEditing?e.marshal?.id:null,"validation-errors":e.validationErrors,"onUpdate:form":Q,onInput:he},null,8,["form","event-id","marshal-id","validation-errors"])):D("",!0),c.value==="checkpoints"?(p(),ze(yO,{key:1,ref_key:"checkpointsTabRef",ref:h,assignments:se.value,"available-locations":U.value,"all-locations":e.allLocations,areas:e.areas,"is-new-marshal":!e.isEditing,"locked-checkpoint-id":e.lockedCheckpointId,onInput:he,onRemoveAssignment:Y,onAssignToLocation:re,onSelectCheckpoint:ie,onDistanceClick:w},null,8,["assignments","available-locations","all-locations","areas","is-new-marshal","locked-checkpoint-id"])):D("",!0),c.value==="checklists"&&e.isEditing?(p(),ze(BO,{key:2,ref_key:"checklistTabRef",ref:f,modelValue:m.value,"onUpdate:modelValue":Ce[1]||(Ce[1]=Ne=>m.value=Ne),"event-id":e.eventId,"marshal-id":e.marshal.id,locations:e.allLocations,areas:e.areas,"allow-reorder":!0,onChange:Te,onReorder:We},null,8,["modelValue","event-id","marshal-id","locations","areas"])):D("",!0),c.value==="checklists"?(p(),ze(iB,{key:3,modelValue:k.value,"onUpdate:modelValue":Ce[2]||(Ce[2]=Ne=>k.value=Ne),"all-checklist-items":e.allChecklistItems,"pending-location-ids":Z.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:he},null,8,["modelValue","all-checklist-items","pending-location-ids","all-locations","areas","is-editing"])):D("",!0),c.value==="notes"&&e.isEditing?(p(),ze(nd,{key:4,"event-id":e.eventId,"marshal-id":e.marshal?.id,"all-notes":e.eventNotes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.allMarshals,"allow-reorder":!0,onReorder:He},null,8,["event-id","marshal-id","all-notes","locations","areas","assignments","marshals"])):D("",!0),c.value==="notes"?(p(),ze($B,{key:5,modelValue:S.value,"onUpdate:modelValue":Ce[3]||(Ce[3]=Ne=>S.value=Ne),"all-notes":e.eventNotes,"pending-location-ids":Z.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:he},null,8,["modelValue","all-notes","pending-location-ids","all-locations","areas","is-editing"])):D("",!0),c.value==="incidents"?(p(),g("div",TB,[r("div",MB,[(p(!0),g(xe,null,qe(e.incidents,Ne=>(p(),ze(gc,{key:Ne.incidentId,incident:Ne,onSelect:Ce[4]||(Ce[4]=Be=>ee.$emit("select-incident",Be))},null,8,["incident"]))),128))])])):D("",!0),c.value==="roles"?(p(),ze(AO,{key:7,roles:x.value.roles,"role-definitions":e.roleDefinitions,"onUpdate:roles":oe,onInput:he},null,8,["roles","role-definitions"])):D("",!0),Ee(Pf,{show:E.value,"marshal-name":T.value,"checkpoint-name":B.value,"check-in-location":M.value,"checkpoint-location":R.value,distance:A.value,"z-index":e.zIndex+100,onClose:_},null,8,["show","marshal-name","checkpoint-name","check-in-location","checkpoint-location","distance","z-index"])]),_:1},8,["show","title","is-dirty","z-index"]))}},DB=Ze(PB,[["__scopeId","data-v-131580b5"]]),RB={class:"locations-list"},OB={class:"conflict-actions"},BB={__name:"AssignmentConflictModal",props:{show:{type:Boolean,default:!1},conflictData:{type:Object,default:()=>({marshalName:"",locations:[]})}},emits:["close","choice"],setup(e,{emit:t}){const{terms:n,termsLower:a}=ht(),o=t,i=c=>{o("choice",c)},l=()=>{o("close")};return(c,d)=>(p(),ze(jt,{show:e.show,title:`${N(n).person} already assigned`,size:"medium","z-index":1100,onClose:l},{actions:Ue(()=>[r("div",OB,[r("button",{onClick:d[0]||(d[0]=h=>i("move")),class:"btn btn-primary btn-full"}," Move to this "+b(N(a).checkpoint)+" (remove from others) ",1),r("button",{onClick:d[1]||(d[1]=h=>i("both")),class:"btn btn-secondary btn-full"}," Assign to both (keep existing assignments) "),r("button",{onClick:d[2]||(d[2]=h=>i("choose-other")),class:"btn btn-secondary btn-full"}," Choose someone else "),r("button",{onClick:d[3]||(d[3]=h=>i("cancel")),class:"btn btn-secondary btn-full"}," Cancel ")])]),default:Ue(()=>[r("p",null,[r("strong",null,b(e.conflictData.marshalName),1),d[4]||(d[4]=Je(" is currently assigned to: ",-1))]),r("ul",RB,[(p(!0),g(xe,null,qe(e.conflictData.locations,h=>(p(),g("li",{key:h},b(h),1))),128))]),d[5]||(d[5]=r("p",null,"What would you like to do?",-1))]),_:1},8,["show","title"]))}},NB=Ze(BB,[["__scopeId","data-v-997e8aaa"]]),FB={key:0,class:"assign-marshal-section"},UB={value:""},zB=["value"],HB=["disabled"],VB={key:1,class:"assign-marshal-section create-mode"},GB={class:"form-group"},qB={class:"form-group"},jB={class:"form-group"},WB={__name:"AssignMarshalModal",props:{show:{type:Boolean,default:!1},locationName:{type:String,default:""},marshals:{type:Array,default:()=>[]}},emits:["close","assign-existing","create-and-assign"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=P(!1),l=P(""),c=P({name:"",email:"",phoneNumber:""});Ye(()=>a.show,k=>{k||(i.value=!1,l.value="",c.value={name:"",email:"",phoneNumber:""})});const d=()=>{i.value=!0},h=()=>{l.value&&o("assign-existing",l.value)},f=()=>{c.value.name&&o("create-and-assign",{...c.value})},m=()=>{i.value=!1,c.value={name:"",email:"",phoneNumber:""}},y=()=>{o("close")};return(k,S)=>(p(),ze(jt,{show:e.show,title:i.value?`Create new ${N(n).person}`:`Assign ${N(n).person} to ${e.locationName}`,size:"medium",onClose:y},{actions:Ue(()=>[i.value?(p(),g(xe,{key:0},[r("button",{onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{onClick:f,class:"btn btn-primary"}," Create & assign ")],64)):D("",!0)]),default:Ue(()=>[i.value?(p(),g("div",VB,[r("h3",null,"Create new "+b(N(n).person),1),r("div",GB,[S[5]||(S[5]=r("label",null,"Name *",-1)),Ge(r("input",{"onUpdate:modelValue":S[1]||(S[1]=x=>c.value.name=x),type:"text",required:"",class:"form-input"},null,512),[[st,c.value.name]])]),r("div",qB,[S[6]||(S[6]=r("label",null,"Email",-1)),Ge(r("input",{"onUpdate:modelValue":S[2]||(S[2]=x=>c.value.email=x),type:"email",class:"form-input"},null,512),[[st,c.value.email]])]),r("div",jB,[S[7]||(S[7]=r("label",null,"Phone",-1)),Ge(r("input",{"onUpdate:modelValue":S[3]||(S[3]=x=>c.value.phoneNumber=x),type:"tel",class:"form-input"},null,512),[[st,c.value.phoneNumber]])])])):(p(),g("div",FB,[r("h3",null,"Select existing "+b(N(n).person),1),Ge(r("select",{"onUpdate:modelValue":S[0]||(S[0]=x=>l.value=x),class:"form-input"},[r("option",UB,"Choose a "+b(N(n).person)+"...",1),(p(!0),g(xe,null,qe(e.marshals,x=>(p(),g("option",{key:x.id,value:x.id},[Je(b(x.name)+" ",1),x.assignedLocationIds&&x.assignedLocationIds.length>0?(p(),g(xe,{key:0},[Je(" (assigned to "+b(x.assignedLocationIds.length)+" "+b(x.assignedLocationIds.length>1?N(n).checkpoints:N(n).checkpoint)+") ",1)],64)):D("",!0)],8,zB))),128))],512),[[no,l.value]]),r("button",{onClick:h,class:"btn btn-primary btn-full",style:{"margin-top":"1rem"},disabled:!l.value}," Assign selected "+b(N(n).person),9,HB),S[4]||(S[4]=r("div",{class:"divider"},"OR",-1)),r("button",{onClick:d,class:"btn btn-secondary btn-full"}," Create new "+b(N(n).person),1)]))]),_:1},8,["show","title"]))}},ZB=Ze(WB,[["__scopeId","data-v-fa70b913"]]),KB={class:"shift-times-content"},YB={class:"info-text"},JB={class:"time-delta-info"},XB={class:"delta-detail"},QB={class:"delta-detail"},eN={class:"delta-summary"},tN={class:"affected-checkpoints"},nN={class:"option-selection"},oN={class:"radio-option"},aN={class:"radio-option"},sN={__name:"ShiftCheckpointTimesModal",props:{show:{type:Boolean,default:!1},oldEventDate:{type:String,required:!0},newEventDate:{type:String,required:!0},affectedCheckpointsCount:{type:Number,default:0}},emits:["confirm","cancel"],setup(e,{emit:t}){const{terms:n,termsLower:a}=ht(),o=e,i=t,l=P("shift"),c=z(()=>{const y=new Date(o.oldEventDate);return new Date(o.newEventDate)-y}),d=y=>new Date(y).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),h=y=>{const k=Math.abs(y),S=y>=0?"+":"-",x=Math.floor(k/(1e3*60*60*24)),E=Math.floor(k%(1e3*60*60*24)/(1e3*60*60)),$=Math.floor(k%(1e3*60*60)/(1e3*60)),w=[];return x>0&&w.push(`${x}d`),E>0&&w.push(`${E}h`),$>0&&w.push(`${$}m`),`${S}${w.join(" ")}`},f=()=>{i("confirm",{shouldShift:l.value==="shift",timeDelta:c.value})},m=()=>{i("cancel")};return(y,k)=>(p(),ze(jt,{show:e.show,title:`Shift ${N(n).checkpoint} Times?`,size:"medium",onClose:m},{actions:Ue(()=>[r("button",{type:"button",onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-primary"},b(l.value==="shift"?"Shift Times":"Keep Times"),1)]),default:Ue(()=>[r("div",KB,[r("p",YB," You've changed the event date/time. Some "+b(N(a).checkpoints)+" have custom times set. ",1),r("div",JB,[k[2]||(k[2]=r("strong",null,"Event time change:",-1)),r("div",XB," Old: "+b(d(e.oldEventDate)),1),r("div",QB," New: "+b(d(e.newEventDate)),1),r("div",eN," Delta: "+b(h(c.value)),1)]),r("p",tN,[r("strong",null,b(e.affectedCheckpointsCount)+" "+b(e.affectedCheckpointsCount===1?N(a).checkpoint:N(a).checkpoints),1),k[3]||(k[3]=Je(" with custom times will be shifted by the same amount. ",-1))]),r("div",nN,[r("label",oN,[Ge(r("input",{"onUpdate:modelValue":k[0]||(k[0]=S=>l.value=S),type:"radio",value:"shift",name:"shift-option"},null,512),[[Pp,l.value]]),r("div",null,[r("strong",null,"Shift all "+b(N(a).checkpoint)+" times",1),k[4]||(k[4]=r("small",null,"Recommended: Maintains relative timing",-1))])]),r("label",aN,[Ge(r("input",{"onUpdate:modelValue":k[1]||(k[1]=S=>l.value=S),type:"radio",value:"keep",name:"shift-option"},null,512),[[Pp,l.value]]),r("div",null,[r("strong",null,"Keep "+b(N(a).checkpoint)+" times unchanged",1),r("small",null,b(N(n).checkpoint)+" times will stay at their current values",1)])])])])]),_:1},8,["show","title"]))}},iN=Ze(sN,[["__scopeId","data-v-a6454aff"]]),lN={class:"checklist-preview"},rN={class:"preview-actions"},cN={class:"preview-header"},uN={key:0,class:"add-item-form"},dN=["placeholder"],hN=["disabled"],fN={key:1,class:"pending-items"},pN={class:"item-content"},vN={class:"item-header"},mN={class:"item-text"},gN={class:"item-scope"},yN=["onClick"],kN={key:2,class:"empty-state"},bN={__name:"ChecklistPreviewForArea",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=P(!1),l=P(""),c=P([...a.modelValue]);Ye(()=>a.modelValue,m=>{c.value=[...m]},{deep:!0});const d=()=>{l.value.trim()&&(c.value.push({text:l.value.trim(),isNew:!0}),l.value="",i.value=!1,f())},h=m=>{c.value.splice(m,1),f()},f=()=>{o("update:modelValue",[...c.value]),o("change")};return(m,y)=>(p(),g("div",lN,[r("div",rN,[r("p",cN," Add new "+b(N(n).checklist)+" for this "+b(N(n).area)+": ",1),r("button",{type:"button",class:"add-item-btn",onClick:y[0]||(y[0]=k=>i.value=!i.value)},b(i.value?"Cancel":`Add ${N(n).checklist}`),1)]),i.value?(p(),g("div",uN,[Ge(r("input",{"onUpdate:modelValue":y[1]||(y[1]=k=>l.value=k),type:"text",placeholder:`Enter ${N(n).checklist} text...`,class:"add-item-input",onKeyup:ya(d,["enter"])},null,40,dN),[[st,l.value]]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim(),onClick:d}," Add ",8,hN)])):D("",!0),c.value.length>0?(p(),g("div",fN,[(p(!0),g(xe,null,qe(c.value,(k,S)=>(p(),g("div",{key:`pending-${S}`,class:"checklist-item pending"},[y[3]||(y[3]=r("div",{class:"item-checkbox"},[r("input",{type:"checkbox",checked:!1,disabled:""})],-1)),r("div",pN,[r("div",vN,[r("div",mN,b(k.text),1),r("div",gN,[y[2]||(y[2]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:x=>h(S),title:"Remove"},"  ",8,yN)])])])]))),128))])):D("",!0),c.value.length===0&&!i.value?(p(),g("div",kN,[r("p",null,"No new "+b(N(n).checklists)+" to add. Click the button above to create one.",1)])):D("",!0)]))}},_N=Ze(bN,[["__scopeId","data-v-a394c400"]]),wN={class:"notes-preview"},CN={class:"preview-actions"},LN={class:"preview-header"},SN={key:0,class:"add-item-form"},IN={class:"add-form-fields"},xN=["disabled"],$N={key:1,class:"pending-items"},TN={class:"note-header"},MN={class:"note-title"},AN={class:"note-actions"},EN=["onClick"],PN={key:0,class:"note-content"},DN={key:2,class:"empty-state"},RN={__name:"NotesPreviewForArea",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=P(!1),l=P(""),c=P(""),d=P([...a.modelValue]);Ye(()=>a.modelValue,y=>{d.value=[...y]},{deep:!0});const h=()=>{!l.value.trim()&&!c.value.trim()||(d.value.push({title:l.value.trim(),content:c.value.trim(),isNew:!0}),l.value="",c.value="",i.value=!1,m())},f=y=>{d.value.splice(y,1),m()},m=()=>{o("update:modelValue",[...d.value]),o("change")};return(y,k)=>(p(),g("div",wN,[r("div",CN,[r("p",LN," Add new note for this "+b(N(n).area)+": ",1),r("button",{type:"button",class:"add-item-btn",onClick:k[0]||(k[0]=S=>i.value=!i.value)},b(i.value?"Cancel":"Add note"),1)]),i.value?(p(),g("div",SN,[r("div",IN,[Ge(r("input",{"onUpdate:modelValue":k[1]||(k[1]=S=>l.value=S),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[st,l.value]]),Ge(r("textarea",{"onUpdate:modelValue":k[2]||(k[2]=S=>c.value=S),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[st,c.value]])]),r("button",{type:"button",class:"save-item-btn",disabled:!l.value.trim()&&!c.value.trim(),onClick:h}," Add ",8,xN)])):D("",!0),d.value.length>0?(p(),g("div",$N,[(p(!0),g(xe,null,qe(d.value,(S,x)=>(p(),g("div",{key:`pending-${x}`,class:"note-item pending"},[r("div",TN,[r("span",MN,b(S.title||"Untitled"),1),r("div",AN,[k[3]||(k[3]=r("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),r("button",{type:"button",class:"remove-item-btn",onClick:E=>f(x),title:"Remove"},"  ",8,EN)])]),S.content?(p(),g("div",PN,b(S.content),1)):D("",!0)]))),128))])):D("",!0),d.value.length===0&&!i.value?(p(),g("div",DN,[...k[4]||(k[4]=[r("p",null,"No new notes to add. Click the button above to create one.",-1)])])):D("",!0)]))}},ON=Ze(RN,[["__scopeId","data-v-5e6bdcab"]]),BN={class:"search-section"},NN={class:"form-group"},FN={class:"suggestions-list"},UN={class:"suggestion-content"},zN={key:0,class:"suggestion-detail"},HN=["onClick"],VN={class:"suggestion-content"},GN={class:"suggestion-name"},qN={key:0,class:"suggestion-detail"},jN=["onClick"],WN={class:"suggestion-content"},ZN={class:"suggestion-name"},KN={key:0,class:"suggestion-detail"},YN={key:1,class:"no-results"},JN={key:2,class:"no-results"},XN={__name:"AddAreaContactModal",props:{show:{type:Boolean,default:!1},areaName:{type:String,default:""},areaId:{type:String,default:""},contacts:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},excludeContactIds:{type:Array,default:()=>[]}},emits:["close","select-contact","create-from-marshal","create-new"],setup(e,{emit:t}){const{terms:n}=ht(),a=e,o=t,i=P(""),l=P(null),c=z(()=>a.contacts.filter(M=>a.excludeContactIds.includes(M.contactId)&&M.marshalId).map(M=>M.marshalId)),d=z(()=>a.contacts.filter(M=>M.marshalId).map(M=>M.marshalId)),h=z(()=>a.contacts.filter(M=>!a.excludeContactIds.includes(M.contactId))),f=z(()=>a.marshals.filter(M=>!c.value.includes(M.id)&&!d.value.includes(M.id))),m=M=>M?M.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",y=z(()=>{const M=m(i.value);return M?M.split(" ").filter(R=>R.length>0):[]}),k=(M,R)=>{if(R.length===0)return{score:1,isPartial:!1};const A=m(M);let G=0;for(const F of R)A.includes(F)&&G++;return{score:G,isPartial:G>0&&G<R.length,isFullMatch:G===R.length}},S=z(()=>{const M=y.value,R=[];return h.value.forEach(A=>{const G=`${A.name||""} ${A.role||""}`,F=k(G,M);(M.length===0||F.score>0)&&R.push({key:`contact-${A.contactId}`,type:"contact",name:A.name,detail:A.role?B(A.role):null,data:A,matchScore:F.score,isPartial:F.isPartial,isFullMatch:F.isFullMatch})}),f.value.forEach(A=>{const G=`${A.name||""} ${A.email||""}`,F=k(G,M);(M.length===0||F.score>0)&&R.push({key:`marshal-${A.id}`,type:"marshal",name:A.name,detail:A.email||A.phoneNumber||null,data:A,matchScore:F.score,isPartial:F.isPartial,isFullMatch:F.isFullMatch})}),R.sort((A,G)=>G.matchScore!==A.matchScore?G.matchScore-A.matchScore:A.name.localeCompare(G.name,void 0,{sensitivity:"base"})),R}),x=z(()=>y.value.length===0?S.value:S.value.filter(M=>M.isFullMatch)),E=z(()=>y.value.length===0?[]:S.value.filter(M=>M.isPartial)),$=z(()=>E.value.length>0);Ye(()=>a.show,async M=>{M&&(i.value="",await dn(),l.value?.focus())});const w=M=>{const R=a.contacts.find(A=>A.marshalId===M.id);if(R){if(a.excludeContactIds.includes(R.contactId))return;o("select-contact",R)}else o("create-from-marshal",M)},_=M=>{o("select-contact",M)},I=()=>{o("create-new",i.value.trim())},T=()=>{o("close")},B=M=>M?M.replace(/([A-Z])/g," $1").replace(/^./,R=>R.toUpperCase()).trim():"";return(M,R)=>(p(),ze(jt,{show:e.show,title:`Add contact to ${e.areaName}`,size:"medium",onClose:T},{actions:Ue(()=>[r("button",{onClick:T,class:"btn btn-secondary"}," Cancel ")]),default:Ue(()=>[r("div",BN,[r("div",NN,[R[1]||(R[1]=r("label",null,"Search or create",-1)),Ge(r("input",{ref_key:"searchInputRef",ref:l,"onUpdate:modelValue":R[0]||(R[0]=A=>i.value=A),type:"text",class:"form-input",placeholder:"Filter by name..."},null,512),[[st,i.value]])]),r("div",FN,[r("div",{class:"suggestion-item create-new",onClick:I},[R[3]||(R[3]=r("span",{class:"suggestion-icon create-icon"},"+",-1)),r("div",UN,[R[2]||(R[2]=r("span",{class:"suggestion-name"},"Create new contact",-1)),i.value.trim()?(p(),g("span",zN,'"'+b(i.value.trim())+'"',1)):D("",!0)])]),(p(!0),g(xe,null,qe(x.value,A=>(p(),g("div",{key:A.key,class:"suggestion-item",onClick:G=>A.type==="marshal"?w(A.data):_(A.data)},[r("span",{class:le(["suggestion-icon",A.type==="marshal"?"marshal-icon":"contact-icon"])},b(A.type==="marshal"?"M":"C"),3),r("div",VN,[r("span",GN,b(A.name),1),A.detail?(p(),g("span",qN,b(A.detail),1)):D("",!0)]),r("span",{class:le(["suggestion-badge",{"contact-badge":A.type==="contact"}])},b(A.type==="marshal"?N(n).person:"Contact"),3)],8,HN))),128)),$.value?(p(),g(xe,{key:0},[R[4]||(R[4]=r("div",{class:"suggestion-section-header"},"Partial matches",-1)),(p(!0),g(xe,null,qe(E.value,A=>(p(),g("div",{key:A.key,class:"suggestion-item",onClick:G=>A.type==="marshal"?w(A.data):_(A.data)},[r("span",{class:le(["suggestion-icon",A.type==="marshal"?"marshal-icon":"contact-icon"])},b(A.type==="marshal"?"M":"C"),3),r("div",WN,[r("span",ZN,b(A.name),1),A.detail?(p(),g("span",KN,b(A.detail),1)):D("",!0)]),r("span",{class:le(["suggestion-badge",{"contact-badge":A.type==="contact"}])},b(A.type==="marshal"?N(n).person:"Contact"),3)],8,jN))),128))],64)):D("",!0),i.value.trim()&&x.value.length===0&&E.value.length===0?(p(),g("div",YN," No matching "+b(N(n).people.toLowerCase())+" or contacts found. ",1)):D("",!0),!i.value.trim()&&x.value.length===0?(p(),g("div",JN," No "+b(N(n).people.toLowerCase())+" or contacts available to add. ",1)):D("",!0)])])]),_:1},8,["show","title"]))}},QN=Ze(XN,[["__scopeId","data-v-e25ca97b"]]),eF={class:"contact-card-header"},tF={class:"contact-name-row"},nF={key:0,class:"pin-icon",title:"Pinned"},oF={key:1,class:"primary-badge",title:"Primary contact"},aF={class:"contact-name"},sF={key:0,class:"contact-role"},iF={key:0,class:"emergency-indicator",title:"Shown in emergency info"},lF={key:1,class:"no-scope-warning",title:"This contact has no visibility scope configured"},rF=["title"],cF={key:0,class:"contact-card-details"},uF={key:0,class:"contact-phone"},dF={key:1,class:"contact-email"},hF={key:1,class:"contact-card-notes"},fF={key:3,class:"contact-card-badge"},pF={key:4,class:"contact-card-badge"},vF={__name:"ContactCard",props:{contact:{type:Object,required:!0},isPending:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:String,default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},clickable:{type:Boolean,default:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]}},emits:["click","remove","undo-remove"],setup(e,{emit:t}){const{terms:n}=ht(),a=e,o=t,i=z(()=>{const m=new Map;for(const y of a.roleDefinitions)m.set(y.roleId,y.name),m.set(y.name,y.name);return m}),l=z(()=>a.contact.roles&&Array.isArray(a.contact.roles)&&a.contact.roles.length>0?a.contact.roles:a.contact.role?[a.contact.role]:[]),c=z(()=>{const m=a.contact.scopeConfigurations;return!m||m.length===0}),d=()=>{a.clickable&&!a.isPending&&!a.isMarkedForRemoval&&o("click",a.contact)},h=m=>{if(!m)return"";const y=i.value.get(m);return y||(m==="AreaLead"?`${n.value.area} Lead`:m.replace(/([A-Z])/g," $1").replace(/^./,k=>k.toUpperCase()).trim())},f=m=>{if(!m)return"";const y=100;return m.length<=y?m:m.substring(0,y)+"..."};return(m,y)=>(p(),g("div",{class:le(["contact-card",{"is-pending":e.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-primary":e.contact.isPrimary&&!e.isMarkedForRemoval,"is-pinned":e.contact.isPinned&&!e.isMarkedForRemoval&&!e.contact.isPrimary,"is-clickable":e.clickable&&!e.isMarkedForRemoval}]),onClick:d},[r("div",eF,[r("div",{class:le(["contact-card-title",{clickable:e.clickable&&!e.isMarkedForRemoval}])},[r("div",tF,[e.contact.isPinned&&!e.isMarkedForRemoval?(p(),g("span",nF,"")):D("",!0),e.contact.isPrimary&&!e.isMarkedForRemoval?(p(),g("span",oF,"")):D("",!0),r("span",aF,b(e.contact.name),1)]),l.value.length>0?(p(),g("span",sF,b(l.value.map(h).join(", ")),1)):D("",!0)],2),e.contact.showInEmergencyInfo&&!e.isMarkedForRemoval?(p(),g("span",iF,"")):D("",!0),c.value&&!e.isMarkedForRemoval&&!e.isPending?(p(),g("span",lF,"!")):D("",!0),e.showRemoveButton&&!e.isMarkedForRemoval?(p(),g("button",{key:2,type:"button",class:"contact-remove-btn",title:e.removeTitle,onClick:y[0]||(y[0]=ct(k=>m.$emit("remove",e.contact.contactId),["stop"]))},"  ",8,rF)):D("",!0),e.isMarkedForRemoval?(p(),g("button",{key:3,type:"button",class:"contact-undo-btn",title:"Cancel removal",onClick:y[1]||(y[1]=ct(k=>m.$emit("undo-remove",e.contact.contactId),["stop"]))}," Undo ")):D("",!0)]),e.contact.phone||e.contact.email?(p(),g("div",cF,[e.contact.phone?(p(),g("span",uF,b(e.contact.phone),1)):D("",!0),e.contact.email?(p(),g("span",dF,b(e.contact.email),1)):D("",!0)])):D("",!0),e.contact.notes&&e.showNotes?(p(),g("div",hF,b(f(e.contact.notes)),1)):D("",!0),e.showScopes&&e.contact.scopeConfigurations?.length>0&&!e.isMarkedForRemoval?(p(),ze(cl,{key:2,class:"contact-card-scopes","scope-configurations":e.contact.scopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals},null,8,["scope-configurations","areas","locations","marshals"])):D("",!0),e.isPending?(p(),g("div",fF,[...y[2]||(y[2]=[r("span",{class:"pending-indicator"},"Will be added on save",-1)])])):D("",!0),e.isMarkedForRemoval?(p(),g("div",pF,[...y[3]||(y[3]=[r("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):D("",!0)],2))}},mF=Ze(vF,[["__scopeId","data-v-9a194a03"]]),gF={class:"contact-card-wrapper"},yF={__name:"ContactsGrid",props:{contacts:{type:Array,required:!0},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:[String,Function],default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No contacts."},emptyHint:{type:String,default:""},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]},allowReorder:{type:Boolean,default:!1}},emits:["select","remove","undo-remove","reorder"],setup(e,{emit:t}){const n=e,a=t,o=z(()=>[...n.contacts].sort((d,h)=>{if(d.isPinned!==h.isPinned)return d.isPinned?-1:1;const f=d.displayOrder||0,m=h.displayOrder||0;return f!==m?f-m:(d.name||"").localeCompare(h.name||"",void 0,{sensitivity:"base"})})),i=d=>typeof n.removeTitle=="function"?n.removeTitle(d):n.removeTitle,l=d=>!d.isPending,c=({changes:d})=>{a("reorder",d)};return(d,h)=>(p(),ze(yc,{"is-empty":e.contacts.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ue(()=>[e.contacts.length>0?(p(),ze(fl,{key:0,items:o.value,"item-key":"contactId","pinned-key":"isPinned",layout:"grid",disabled:!e.allowReorder,"show-order-overlay":e.allowReorder,onReorder:c},{item:Ue(({element:f})=>[r("div",gF,[e.allowReorder?(p(),ze(pl,{key:0})):D("",!0),Ee(mF,{contact:f,"is-pending":f.isPending,"is-marked-for-removal":f.isMarkedForRemoval,"show-remove-button":e.showRemoveButton,"remove-title":i(f),"show-notes":e.showNotes,"show-scopes":e.showScopes,clickable:l(f),areas:e.areas,locations:e.locations,marshals:e.marshals,"role-definitions":e.roleDefinitions,onClick:m=>d.$emit("select",f),onRemove:h[0]||(h[0]=m=>d.$emit("remove",m)),onUndoRemove:h[1]||(h[1]=m=>d.$emit("undo-remove",m))},null,8,["contact","is-pending","is-marked-for-removal","show-remove-button","remove-title","show-notes","show-scopes","clickable","areas","locations","marshals","role-definitions","onClick"])])]),_:1},8,["items","disabled","show-order-overlay"])):D("",!0)]),_:1},8,["is-empty","empty-message","empty-hint"]))}},kF=Ze(yF,[["__scopeId","data-v-4c025463"]]),bF={key:0,class:"tab-content"},_F={class:"form-group"},wF=["disabled"],CF={class:"form-group"},LF={key:1,class:"tab-content"},SF={class:"boundary-section"},IF={key:0,class:"boundary-preview"},xF={class:"boundary-actions"},$F={key:2,class:"tab-content"},TF={class:"contacts-header"},MF={class:"section-title"},AF={key:3,class:"tab-content"},EF={class:"section-title"},PF={key:4,class:"placeholder-message"},DF={key:7,class:"placeholder-message"},RF={key:10,class:"placeholder-message"},OF={key:11,class:"tab-content appearance-tab"},BF={class:"accordion-item"},NF=["innerHTML"],FF={class:"accordion-title"},UF={class:"accordion-arrow"},zF={key:0,class:"accordion-content"},HF={class:"section-description"},VF={class:"color-picker"},GF=["title","onClick"],qF={class:"accordion-item"},jF=["innerHTML"],WF={class:"accordion-title"},ZF={class:"accordion-arrow"},KF={key:0,class:"accordion-content"},YF={class:"section-description"},JF={class:"accordion-item"},XF={class:"accordion-title"},QF={class:"accordion-preview"},e9={class:"accordion-arrow"},t9={key:0,class:"accordion-content"},n9={class:"section-description"},o9={class:"form-group"},a9={value:""},s9=["value"],i9={class:"accordion-item"},l9={class:"accordion-title"},r9={class:"accordion-preview"},c9={class:"accordion-arrow"},u9={key:0,class:"accordion-content"},d9={class:"section-description"},h9={class:"form-group"},f9={value:""},p9=["value"],v9={key:12,class:"tab-content incidents-tab"},m9={class:"incidents-list"},g9={class:"custom-footer"},y9={class:"footer-left"},pm="edit_area_accordion",k9={__name:"EditAreaModal",props:{show:{type:Boolean,default:!1},area:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},incidents:{type:Array,default:()=>[]},roleDefinitions:{type:Array,default:()=>[]},initialTab:{type:String,default:"details"},route:{type:Array,default:()=>[]}},emits:["close","save","delete","draw-boundary","update:isDirty","select-checkpoint","create-contact-from-marshal","create-new-contact","edit-contact","select-incident","reorder-notes","reorder-checklists","reorder-contacts"],setup(e,{expose:t,emit:n}){const{terms:a,termsLower:o}=ht(),i=()=>T.value.peopleTerm?T.value.peopleTerm:d.eventPeopleTerm||"Marshals",l=(te=!0)=>{const ge=T.value.checkpointTerm||d.eventCheckpointTerm||"Checkpoints",Fe=i();return te?qy("checkpoint",ge,Fe):Qi("checkpoint",ge,Fe)},c=(te=!0)=>l(te).toLowerCase(),d=e,h=n,f=P("details"),m=P(null),y=P([]),k=P({}),S=P({}),x=P(!1),E=P(!1),$=P([]),w=P([]),_=P([]),I=P([]),T=P({name:"",description:"",color:nu,displayOrder:0,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),B=()=>({name:"",description:"",color:lT(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),M=()=>d.eventId?`${pm}_${d.eventId}`:pm,R=P({polygonColor:!1,iconStyle:!1,peopleTerm:!1,checkpointTerm:!1});rn(()=>{const te=localStorage.getItem(M());if(te)try{const ge=JSON.parse(te);R.value={...R.value,...ge}}catch{}});const A=te=>{R.value[te]=!R.value[te],localStorage.setItem(M(),JSON.stringify(R.value))},G=z(()=>`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <polygon points="4,8 7,3 14,2 20,5 22,12 19,18 12,21 5,19 2,14" fill="${T.value.color||nu}" stroke="#fff" stroke-width="1.5" opacity="0.8"/>
  </svg>`),F=z(()=>{const te=T.value.checkpointStyleType!=="default"||T.value.checkpointStyleBackgroundShape||T.value.checkpointStyleBackgroundColor||T.value.checkpointStyleBorderColor||T.value.checkpointStyleIconColor||T.value.checkpointStyleSize,ge=d.eventDefaultStyleType!=="default"||d.eventDefaultStyleBackgroundShape||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||d.eventDefaultStyleBorderColor||d.eventDefaultStyleIconColor||d.eventDefaultStyleSize;if(!te&&!ge)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="areaDefaultGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981"/>
          <stop offset="50%" style="stop-color:#F59E0B"/>
          <stop offset="100%" style="stop-color:#EF4444"/>
        </linearGradient>
      </defs>
      <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#areaDefaultGrad)" stroke="#fff" stroke-width="1.5"/>
    </svg>`;const Fe=T.value.checkpointStyleType&&T.value.checkpointStyleType!=="default"?T.value.checkpointStyleType:d.eventDefaultStyleType&&d.eventDefaultStyleType!=="default"?d.eventDefaultStyleType:"default",ut=T.value.checkpointStyleBackgroundShape||d.eventDefaultStyleBackgroundShape||"circle",gt=T.value.checkpointStyleBackgroundColor||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||"#667eea",xt=T.value.checkpointStyleBorderColor||d.eventDefaultStyleBorderColor||"#ffffff",Ct=T.value.checkpointStyleIconColor||d.eventDefaultStyleIconColor||"#ffffff",Pt=T.value.checkpointStyleSize||d.eventDefaultStyleSize||"100";return Vn({type:Fe!=="default"?Fe:ut,backgroundShape:ut,backgroundColor:gt,borderColor:xt,iconColor:Ct,size:Pt,outputSize:24})}),j=z(()=>d.area&&d.area.id),K=z(()=>!T.value.polygon||T.value.polygon.length===0?[]:T.value.polygon.map((te,ge)=>({id:`polygon-point-${ge}`,latitude:te.lat,longitude:te.lng}))),J=z(()=>d.area?.id?d.areas.filter(te=>te.id!==d.area.id).map(te=>({...te,color:"#999999"})):d.areas.map(te=>({...te,color:"#999999"})));z(()=>he.value.map(te=>te.id));const ue=z(()=>{const te=[{value:"details",label:"Details",icon:"details"},{value:"boundary",label:"Boundary",icon:"area"},{value:"contacts",label:"Contacts",icon:"marshal"},{value:"checkpoints",label:l(),icon:"checkpoint"},{value:"checklists",label:a.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return d.incidents&&d.incidents.length>0&&te.push({value:"incidents",label:"Incidents",icon:"incidents"}),te}),Z=z(()=>ue.value.findIndex(te=>te.value===f.value)),se=z(()=>Z.value===ue.value.length-1),U=z(()=>se.value?null:ue.value[Z.value+1]),Q=z(()=>U.value?`${U.value.label}...`:""),oe=z(()=>{if(!d.area||!d.area.id)return[];const te=d.checkpoints.filter(ge=>ge.areaIds&&ge.areaIds.includes(d.area.id)).map(ge=>ge.id);return d.assignments.filter(ge=>te.includes(ge.locationId))}),he=z(()=>!d.area||!d.area.id?[]:d.checkpoints.filter(te=>te.areaIds&&te.areaIds.includes(d.area.id))),Te=z(()=>{const te=[...he.value];return te.sort((ge,Fe)=>{const ut=ge.name.match(/^(\d+)/),gt=Fe.name.match(/^(\d+)/);if(ut&&gt){const xt=parseInt(ut[1]),Ct=parseInt(gt[1]);if(xt!==Ct)return xt-Ct}return ge.name.localeCompare(Fe.name,void 0,{numeric:!0,sensitivity:"base"})}),te}),je=z(()=>!d.area||!d.area.id?[]:d.contacts.filter(te=>te.scopeConfigurations?te.scopeConfigurations.some(ge=>ge.scope==="EveryoneInAreas"&&ge.itemType==="Area"?ge.ids?.includes("ALL_AREAS")?!0:ge.ids?.includes(d.area.id):!1):!1)),He=z(()=>{const te=new Set(je.value.map(ut=>ut.contactId)),ge=je.value.map(ut=>({...ut,isPending:!1,isExisting:!0,isMarkedForRemoval:w.value.includes(ut.contactId)})),Fe=$.value.filter(ut=>!te.has(ut.contactId)).map(ut=>({...ut,isPending:!0,isExisting:!1,isMarkedForRemoval:!1}));return[...ge,...Fe].sort((ut,gt)=>ut.name.localeCompare(gt.name,void 0,{sensitivity:"base"}))}),We=z(()=>{const te=je.value.map(Fe=>Fe.contactId),ge=$.value.map(Fe=>Fe.contactId);return[...te,...ge]}),be=async te=>{if(!(k.value[te]||S.value[te])){S.value[te]=!0;try{const Fe=(await Nt.getCheckpointChecklist(d.eventId,te)).data||[];k.value[te]={total:Fe.length,completed:Fe.filter(ut=>ut.isCompleted).length}}catch(ge){console.error("Failed to load checklist status for checkpoint:",te,ge),k.value[te]={total:0,completed:0}}finally{S.value[te]=!1}}};Ye(()=>d.area,te=>{if(te){const ge=te.polygon?typeof te.polygon=="string"?JSON.parse(te.polygon):te.polygon:[];T.value={name:te.name||"",description:te.description||"",color:te.color||nu,displayOrder:te.displayOrder||0,isDefault:te.isDefault||!1,polygon:ge,checkpointStyleType:te.checkpointStyleType||"default",checkpointStyleColor:te.checkpointStyleColor||"",checkpointStyleBackgroundShape:te.checkpointStyleBackgroundShape||"",checkpointStyleBackgroundColor:te.checkpointStyleBackgroundColor||"",checkpointStyleBorderColor:te.checkpointStyleBorderColor||"",checkpointStyleIconColor:te.checkpointStyleIconColor||"",checkpointStyleSize:te.checkpointStyleSize||"",checkpointStyleMapRotation:te.checkpointStyleMapRotation??"",peopleTerm:te.peopleTerm||"",checkpointTerm:te.checkpointTerm||""}}else T.value=B()},{immediate:!0,deep:!0}),Ye(()=>d.show,te=>{te&&(f.value=d.initialTab||"details",y.value=[],k.value={},S.value={},$.value=[],w.value=[],_.value=[],I.value=[],E.value=!1,j.value||(T.value=B()),m.value?.resetLocalState&&m.value.resetLocalState())}),Ye(f,te=>{te==="checkpoints"&&d.area&&d.area.id&&he.value.forEach(ge=>{setTimeout(()=>be(ge.id),0)})});const V=()=>{h("update:isDirty",!0)},Y=te=>{T.value.color=te,V()},re=(te,ge)=>{T.value[te]=ge,V()},ie=()=>{h("draw-boundary",T.value)},$e=te=>{T.value.polygon=te,V()},q=()=>{T.value.polygon=[],x.value=!1,V()},X=te=>{E.value=!1,h("create-contact-from-marshal",{marshal:te,area:d.area})},ee=te=>{E.value=!1,h("create-new-contact",{name:te,area:d.area})},Ce=te=>{$.value.find(ge=>ge.contactId===te.contactId)||($.value.push(te),V()),E.value=!1},Ne=te=>{$.value=$.value.filter(ge=>ge.contactId!==te),V()},Be=te=>{w.value.includes(te)||(w.value.push(te),V())},Ae=te=>te.isPending?"Remove pending contact":`Remove from ${o.value.area}`,ne=te=>{He.value.find(Fe=>Fe.contactId===te)?.isPending?Ne(te):Be(te)},ye=te=>{w.value=w.value.filter(ge=>ge!==te),V()},De=te=>{y.value=te,V()},Pe=()=>{U.value&&(f.value=U.value.value)},Ie=te=>{h("reorder-notes",te)},me=te=>{h("reorder-checklists",te)},Ke=te=>{h("reorder-contacts",te)},Ve=()=>{const te=d.area?{name:T.value.name,description:T.value.description,color:T.value.color,polygon:T.value.polygon.length>0?T.value.polygon:null,displayOrder:T.value.displayOrder,checkpointStyleType:T.value.checkpointStyleType,checkpointStyleColor:T.value.checkpointStyleColor,checkpointStyleBackgroundShape:T.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:T.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:T.value.checkpointStyleBorderColor,checkpointStyleIconColor:T.value.checkpointStyleIconColor,checkpointStyleSize:T.value.checkpointStyleSize,checkpointStyleMapRotation:T.value.checkpointStyleMapRotation!=null&&T.value.checkpointStyleMapRotation!==""?String(T.value.checkpointStyleMapRotation):null,peopleTerm:T.value.peopleTerm,checkpointTerm:T.value.checkpointTerm,checklistChanges:y.value||[],pendingContacts:$.value||[],contactsToRemove:w.value||[],pendingNewChecklistItems:_.value||[],pendingNewNotes:I.value||[]}:{name:T.value.name,description:T.value.description,color:T.value.color,polygon:T.value.polygon.length>0?T.value.polygon:null,checkpointStyleType:T.value.checkpointStyleType,checkpointStyleColor:T.value.checkpointStyleColor,checkpointStyleBackgroundShape:T.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:T.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:T.value.checkpointStyleBorderColor,checkpointStyleIconColor:T.value.checkpointStyleIconColor,checkpointStyleSize:T.value.checkpointStyleSize,checkpointStyleMapRotation:T.value.checkpointStyleMapRotation!=null&&T.value.checkpointStyleMapRotation!==""?String(T.value.checkpointStyleMapRotation):null,peopleTerm:T.value.peopleTerm,checkpointTerm:T.value.checkpointTerm,pendingContacts:$.value||[]};h("save",te)},de=()=>{h("delete",d.area.id)},ke=()=>{h("close")};return t({addPendingContact:te=>{te&&!$.value.find(ge=>ge.contactId===te.contactId)&&($.value.push(te),V())},removeContactById:te=>{const ge=$.value.some(Fe=>Fe.contactId===te);$.value=$.value.filter(Fe=>Fe.contactId!==te),w.value=w.value.filter(Fe=>Fe!==te),ge&&V()}}),(te,ge)=>(p(),ze(jt,{show:e.show,title:e.area&&e.area.id?`Edit ${N(o).area}: ${e.area.name}`:`Create new ${N(o).area}`,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:ke},{"tab-header":Ue(()=>[Ee(gl,{modelValue:f.value,"onUpdate:modelValue":ge[0]||(ge[0]=Fe=>f.value=Fe),tabs:ue.value},null,8,["modelValue","tabs"])]),footer:Ue(()=>[r("div",g9,[r("div",y9,[j.value&&!T.value.isDefault?(p(),g("button",{key:0,type:"button",onClick:de,class:"btn btn-danger"}," Delete ")):D("",!0),!j.value&&!se.value?(p(),g("button",{key:1,type:"button",onClick:Pe,class:"btn btn-secondary mobile-only"},b(Q.value),1)):D("",!0)]),r("button",{type:"button",onClick:Ve,class:"btn btn-success"}," Save ")])]),default:Ue(()=>[f.value==="details"?(p(),g("div",bF,[r("form",{onSubmit:ct(Ve,["prevent"])},[r("div",_F,[ge[27]||(ge[27]=r("label",null,"Name *",-1)),Ge(r("input",{"onUpdate:modelValue":ge[1]||(ge[1]=Fe=>T.value.name=Fe),type:"text",required:"",class:"form-input",disabled:T.value.isDefault,onInput:V},null,40,wF),[[st,T.value.name]])]),r("div",CF,[ge[28]||(ge[28]=r("label",null,"Description",-1)),Ge(r("textarea",{"onUpdate:modelValue":ge[2]||(ge[2]=Fe=>T.value.description=Fe),class:"form-input",rows:"3",onInput:V},null,544),[[st,T.value.description]])])],32)])):D("",!0),f.value==="boundary"?(p(),g("div",LF,[r("div",SF,[T.value.polygon&&T.value.polygon.length>0?(p(),g("div",IF,[Ee(hl,{mode:"edit-polygon","editing-polygon":T.value.polygon,route:e.route,locations:e.checkpoints,areas:J.value,"all-locations-for-bounds":K.value,height:"300px",onPolygonUpdate:$e},null,8,["editing-polygon","route","locations","areas","all-locations-for-bounds"]),ge[29]||(ge[29]=r("p",{class:"boundary-hint"},"Drag points to move them. Click a point to delete it (minimum 3 required).",-1))])):D("",!0),r("div",xF,[!T.value.polygon||T.value.polygon.length===0?(p(),g("button",{key:0,onClick:ie,class:"btn btn-primary btn-full"}," Draw on map ")):(p(),g(xe,{key:1},[r("button",{onClick:ie,class:"btn btn-secondary"}," Redraw "),r("button",{onClick:ge[3]||(ge[3]=Fe=>x.value=!0),class:"btn btn-danger"}," Delete boundary ")],64))])])])):D("",!0),Ee(vi,{show:x.value,title:"Delete boundary",message:"Are you sure you want to delete this boundary? This cannot be undone.","confirm-text":"Delete","is-danger":!0,onConfirm:q,onCancel:ge[4]||(ge[4]=Fe=>x.value=!1)},null,8,["show"]),f.value==="contacts"?(p(),g("div",$F,[r("div",TF,[r("h3",MF,b(N(a).area)+" contacts ("+b(He.value.length)+")",1),r("button",{onClick:ge[5]||(ge[5]=Fe=>E.value=!0),class:"btn btn-primary btn-small"}," Add contact ")]),Ee(kF,{contacts:He.value,"show-remove-button":!0,"remove-title":Ae,"empty-message":`No contacts assigned to this ${N(o).area}.`,"empty-hint":`Click 'Add contact' to assign contacts who will be visible to ${N(o).people} in this ${N(o).area}.`,"allow-reorder":j.value,"role-definitions":e.roleDefinitions,onSelect:ge[6]||(ge[6]=Fe=>te.$emit("edit-contact",Fe)),onRemove:ne,onUndoRemove:ye,onReorder:Ke},null,8,["contacts","empty-message","empty-hint","allow-reorder","role-definitions"])])):D("",!0),Ee(QN,{show:E.value,"area-name":T.value.name||"this "+N(o).area,"area-id":d.area?.id||"",contacts:d.contacts,marshals:d.marshals,"exclude-contact-ids":We.value,onClose:ge[7]||(ge[7]=Fe=>E.value=!1),onSelectContact:Ce,onCreateFromMarshal:X,onCreateNew:ee},null,8,["show","area-name","area-id","contacts","marshals","exclude-contact-ids"]),f.value==="checkpoints"&&j.value?(p(),g("div",AF,[r("h3",EF,b(l())+" in "+b(e.area?.name)+" ("+b(he.value.length)+")",1),Ee(p1,{checkpoints:Te.value,areas:e.areas,"empty-message":`No ${c()} in this ${N(o).area} yet.`,onSelect:ge[8]||(ge[8]=Fe=>te.$emit("select-checkpoint",Fe))},null,8,["checkpoints","areas","empty-message"])])):D("",!0),f.value==="checkpoints"&&!j.value?(p(),g("div",PF,[r("p",null,b(l())+" will be automatically assigned based on boundaries after the "+b(N(o).area)+" is created.",1)])):D("",!0),f.value==="checklists"&&j.value?(p(),ze(b1,{key:5,ref_key:"checklistTabRef",ref:m,modelValue:y.value,"onUpdate:modelValue":ge[9]||(ge[9]=Fe=>y.value=Fe),"event-id":e.eventId,"area-id":e.area.id,locations:e.allLocations,areas:e.areas,assignments:oe.value,marshals:e.marshals,"allow-reorder":!0,onChange:De,onReorder:me},null,8,["modelValue","event-id","area-id","locations","areas","assignments","marshals"])):D("",!0),f.value==="checklists"&&j.value?(p(),ze(_N,{key:6,modelValue:_.value,"onUpdate:modelValue":ge[10]||(ge[10]=Fe=>_.value=Fe),onChange:V},null,8,["modelValue"])):D("",!0),f.value==="checklists"&&!j.value?(p(),g("div",DF,[r("p",null,b(N(a).checklists)+" can be assigned after the "+b(N(o).area)+" is created.",1)])):D("",!0),f.value==="notes"&&j.value?(p(),ze(nd,{key:8,"event-id":e.eventId,"area-id":e.area?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments,marshals:e.marshals,"allow-reorder":!0,onReorder:Ie},null,8,["event-id","area-id","all-notes","locations","areas","assignments","marshals"])):D("",!0),f.value==="notes"&&j.value?(p(),ze(ON,{key:9,modelValue:I.value,"onUpdate:modelValue":ge[11]||(ge[11]=Fe=>I.value=Fe),onChange:V},null,8,["modelValue"])):D("",!0),f.value==="notes"&&!j.value?(p(),g("div",RF,[r("p",null,"Notes can be viewed after the "+b(N(o).area)+" is created.",1)])):D("",!0),f.value==="appearance"?(p(),g("div",OF,[r("div",BF,[r("button",{type:"button",class:le(["accordion-header",{expanded:R.value.polygonColor}]),onClick:ge[12]||(ge[12]=Fe=>A("polygonColor"))},[r("div",{class:"accordion-icon",innerHTML:G.value},null,8,NF),r("span",FF,b(N(a).area)+" polygon colour",1),r("span",UF,b(R.value.polygonColor?"":""),1)],2),R.value.polygonColor?(p(),g("div",zF,[r("p",HF," Choose a colour for this "+b(N(o).area)+"'s boundary on the map. ",1),r("div",VF,[(p(!0),g(xe,null,qe(N(Kn),Fe=>(p(),g("div",{key:Fe.hex,class:le(["color-swatch",{selected:T.value.color===Fe.hex}]),style:nt({backgroundColor:Fe.hex}),title:Fe.name,onClick:ut=>Y(Fe.hex)},null,14,GF))),128))])])):D("",!0)]),r("div",qF,[r("button",{type:"button",class:le(["accordion-header",{expanded:R.value.iconStyle}]),onClick:ge[13]||(ge[13]=Fe=>A("iconStyle"))},[r("div",{class:"accordion-icon",innerHTML:F.value},null,8,jF),r("span",WF,b(l(!1))+" marker style",1),r("span",ZF,b(R.value.iconStyle?"":""),1)],2),R.value.iconStyle?(p(),g("div",KF,[r("p",YF," Set a default marker style for all "+b(c())+" in this "+b(N(o).area)+". Individual "+b(c())+" can override this setting. ",1),Ee(Bf,{"style-type":T.value.checkpointStyleType||"default","style-color":T.value.checkpointStyleColor||"","style-background-shape":T.value.checkpointStyleBackgroundShape||"","style-background-color":T.value.checkpointStyleBackgroundColor||"","style-border-color":T.value.checkpointStyleBorderColor||"","style-icon-color":T.value.checkpointStyleIconColor||"","style-size":T.value.checkpointStyleSize||"","style-map-rotation":T.value.checkpointStyleMapRotation??"","inherited-style-type":e.eventDefaultStyleType,"inherited-style-color":e.eventDefaultStyleColor,"inherited-background-shape":e.eventDefaultStyleBackgroundShape||"","inherited-background-color":e.eventDefaultStyleBackgroundColor||e.eventDefaultStyleColor||"","inherited-border-color":e.eventDefaultStyleBorderColor||"","inherited-icon-color":e.eventDefaultStyleIconColor||"","inherited-size":e.eventDefaultStyleSize||"","inherited-map-rotation":e.eventDefaultStyleMapRotation??"","default-label":"Event default","icon-label":"Marker style",level:"area","show-preview":!0,"onUpdate:styleType":ge[14]||(ge[14]=Fe=>re("checkpointStyleType",Fe)),"onUpdate:styleColor":ge[15]||(ge[15]=Fe=>re("checkpointStyleColor",Fe)),"onUpdate:styleBackgroundShape":ge[16]||(ge[16]=Fe=>re("checkpointStyleBackgroundShape",Fe)),"onUpdate:styleBackgroundColor":ge[17]||(ge[17]=Fe=>re("checkpointStyleBackgroundColor",Fe)),"onUpdate:styleBorderColor":ge[18]||(ge[18]=Fe=>re("checkpointStyleBorderColor",Fe)),"onUpdate:styleIconColor":ge[19]||(ge[19]=Fe=>re("checkpointStyleIconColor",Fe)),"onUpdate:styleSize":ge[20]||(ge[20]=Fe=>re("checkpointStyleSize",Fe)),"onUpdate:styleMapRotation":ge[21]||(ge[21]=Fe=>re("checkpointStyleMapRotation",Fe))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])])):D("",!0)]),r("div",JF,[r("button",{type:"button",class:le(["accordion-header",{expanded:R.value.peopleTerm}]),onClick:ge[22]||(ge[22]=Fe=>A("peopleTerm"))},[ge[30]||(ge[30]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("circle",{cx:"12",cy:"8",r:"4",fill:"#6366F1"}),r("path",{d:"M4 20c0-4.4 3.6-8 8-8s8 3.6 8 8",fill:"#6366F1",opacity:"0.6"})])],-1)),r("span",XF,b(i())+" terminology",1),r("span",QF,b(T.value.peopleTerm||`${e.eventPeopleTerm} (event default)`),1),r("span",e9,b(R.value.peopleTerm?"":""),1)],2),R.value.peopleTerm?(p(),g("div",t9,[r("p",n9," Choose what "+b(i().toLowerCase())+" are called in this "+b(N(o).area)+". This will be inherited by "+b(c())+" unless they override it. ",1),r("div",o9,[ge[31]||(ge[31]=r("label",null,"What are people called?",-1)),Ge(r("select",{"onUpdate:modelValue":ge[23]||(ge[23]=Fe=>T.value.peopleTerm=Fe),class:"form-input",onChange:V},[r("option",a9,"Use event default ("+b(e.eventPeopleTerm)+")",1),(p(!0),g(xe,null,qe(N(_s).people,Fe=>(p(),g("option",{key:Fe,value:Fe},b(Fe),9,s9))),128))],544),[[no,T.value.peopleTerm]])])])):D("",!0)]),r("div",i9,[r("button",{type:"button",class:le(["accordion-header",{expanded:R.value.checkpointTerm}]),onClick:ge[24]||(ge[24]=Fe=>A("checkpointTerm"))},[ge[32]||(ge[32]=r("div",{class:"accordion-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z",fill:"#10B981"}),r("circle",{cx:"12",cy:"9",r:"2.5",fill:"white"})])],-1)),r("span",l9,b(l(!1))+" terminology",1),r("span",r9,b(T.value.checkpointTerm?N(jh)(T.value.checkpointTerm,i()):`${e.eventCheckpointTerm} (event default)`),1),r("span",c9,b(R.value.checkpointTerm?"":""),1)],2),R.value.checkpointTerm?(p(),g("div",u9,[r("p",d9," Choose what "+b(c())+" are called in this "+b(N(o).area)+". ",1),r("div",h9,[r("label",null,"What are "+b(c())+" called?",1),Ge(r("select",{"onUpdate:modelValue":ge[25]||(ge[25]=Fe=>T.value.checkpointTerm=Fe),class:"form-input",onChange:V},[r("option",f9,"Use event default ("+b(e.eventCheckpointTerm)+")",1),(p(!0),g(xe,null,qe(N(_s).checkpoint,Fe=>(p(),g("option",{key:Fe,value:Fe},b(N(jh)(Fe,i())),9,p9))),128))],544),[[no,T.value.checkpointTerm]])])])):D("",!0)])])):D("",!0),f.value==="incidents"?(p(),g("div",v9,[r("div",m9,[(p(!0),g(xe,null,qe(e.incidents,Fe=>(p(),ze(gc,{key:Fe.incidentId,incident:Fe,onSelect:ge[26]||(ge[26]=ut=>te.$emit("select-incident",ut))},null,8,["incident"]))),128))])])):D("",!0)]),_:1},8,["show","title","is-dirty"]))}},b9=Ze(k9,[["__scopeId","data-v-cff313be"]]),_9=["innerHTML"],w9={__name:"InfoModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Information"},message:{type:String,required:!0},okText:{type:String,default:"OK"}},emits:["close"],setup(e,{emit:t}){const n=t,a=()=>{n("close")};return(o,i)=>(p(),ze(jt,{show:e.show,title:e.title,size:"small","z-index":2e3,onClose:a},{actions:Ue(()=>[r("button",{onClick:a,class:"btn btn-primary"},b(e.okText),1)]),default:Ue(()=>[r("div",{class:"info-content",innerHTML:e.message},null,8,_9)]),_:1},8,["show","title"]))}},kc=Ze(w9,[["__scopeId","data-v-a6e7148c"]]),C9={class:"tab-content"},L9={class:"form-group"},S9={for:"text"},I9=["placeholder"],x9={key:0,class:"checkbox-label-inline create-separate-items"},$9={key:0,class:"form-group link-to-checkin"},T9={class:"checkbox-label-inline"},M9={class:"help-text"},A9={key:1,class:"form-group link-to-checkin-warning"},E9={class:"help-text warning"},P9={class:"tab-content"},D9={class:"custom-footer"},R9={class:"footer-left"},O9={__name:"EditChecklistItemModal",props:{show:{type:Boolean,default:!1},checklistItem:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{termsLower:n,termsSentence:a}=ht(),o=e,i=t,l=P(!1),c=P(""),d=P("details"),h=P({text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0,linksToCheckIn:!1}),f=z(()=>!!o.checklistItem),m=z(()=>{const R=h.value.scopeConfigurations.filter(A=>A.scope&&(A.ids?.length>0||A.scope==="Everyone"||A.scope==="EveryoneAtCheckpoints"||A.scope==="SpecificPeople"));return R.length===0?!1:R.every(A=>A.scope==="EveryoneAtCheckpoints"||A.scope==="SpecificPeople")}),y=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],k=z(()=>y.findIndex(R=>R.value===d.value)),S=z(()=>k.value===y.length-1),x=z(()=>S.value?"":y[k.value+1]?.label||"");Ye(()=>o.show,R=>{R&&(d.value=o.initialTab,o.checklistItem?h.value={text:o.checklistItem.text||"",scopeConfigurations:o.checklistItem.scopeConfigurations?JSON.parse(JSON.stringify(o.checklistItem.scopeConfigurations)):[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:o.checklistItem.displayOrder||0,isRequired:o.checklistItem.isRequired!==!1,visibleFrom:o.checklistItem.visibleFrom?E(o.checklistItem.visibleFrom):null,visibleUntil:o.checklistItem.visibleUntil?E(o.checklistItem.visibleUntil):null,mustCompleteBy:o.checklistItem.mustCompleteBy?E(o.checklistItem.mustCompleteBy):null,createSeparateItems:!1,linksToCheckIn:o.checklistItem.linksToCheckIn||!1}:h.value={text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0,linksToCheckIn:!1},i("update:isDirty",!1))});const E=R=>{if(!R)return null;const A=new Date(R),G=A.getTimezoneOffset();return new Date(A.getTime()-G*60*1e3).toISOString().slice(0,16)},$=R=>R?new Date(R).toISOString():null,w=()=>{i("update:isDirty",!0)},_=()=>{i("close")},I=()=>{S.value||(d.value=y[k.value+1].value)},T=R=>{c.value=R,l.value=!0},B=()=>{if(!h.value.text||!h.value.text.trim()){T(`Please enter ${n.value.checklist} text`);return}if(!h.value.scopeConfigurations||h.value.scopeConfigurations.length===0){T("Please select at least one scope");return}if(!h.value.scopeConfigurations.some(G=>!(G.itemType!==null&&(!G.ids||G.ids.length===0)))){T("Please configure at least one scope with valid selections");return}const A={text:h.value.text,scopeConfigurations:h.value.scopeConfigurations,displayOrder:h.value.displayOrder||0,isRequired:h.value.isRequired,visibleFrom:$(h.value.visibleFrom),visibleUntil:$(h.value.visibleUntil),mustCompleteBy:$(h.value.mustCompleteBy),linksToCheckIn:h.value.linksToCheckIn};f.value||(A.createSeparateItems=h.value.createSeparateItems),i("save",A)},M=()=>{i("delete",o.checklistItem.itemId)};return(R,A)=>(p(),g(xe,null,[Ee(jt,{show:e.show,title:f.value?`Edit ${N(n).checklist}`:`Create ${N(n).checklist}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:_},{"tab-header":Ue(()=>[Ee(gl,{modelValue:d.value,"onUpdate:modelValue":A[0]||(A[0]=G=>d.value=G),tabs:y},null,8,["modelValue"])]),footer:Ue(()=>[r("div",D9,[r("div",R9,[f.value?(p(),g("button",{key:0,type:"button",onClick:M,class:"btn btn-danger"}," Delete ")):D("",!0),!f.value&&!S.value?(p(),g("button",{key:1,type:"button",onClick:I,class:"btn btn-secondary mobile-only"},b(x.value)+"... ",1)):D("",!0)]),r("button",{type:"button",onClick:B,class:"btn btn-success"}," Save ")])]),default:Ue(()=>[r("form",{onSubmit:ct(B,["prevent"]),class:"checklist-form"},[Ge(r("div",C9,[r("div",L9,[r("label",S9,b(N(a).checklist)+" text: *",1),Ge(r("textarea",{id:"text","onUpdate:modelValue":A[1]||(A[1]=G=>h.value.text=G),onInput:w,required:"",rows:"3",placeholder:h.value.createSeparateItems?`Enter ${N(n).checklists}, one per line...`:`Enter the ${N(n).checklist} text...`},null,40,I9),[[st,h.value.text]]),f.value?D("",!0):(p(),g("label",x9,[Ge(r("input",{type:"checkbox","onUpdate:modelValue":A[2]||(A[2]=G=>h.value.createSeparateItems=G),onChange:w},null,544),[[xa,h.value.createSeparateItems]]),A[6]||(A[6]=r("span",null,"Each line creates a new item",-1))]))]),m.value?(p(),g("div",$9,[r("label",T9,[Ge(r("input",{type:"checkbox","onUpdate:modelValue":A[3]||(A[3]=G=>h.value.linksToCheckIn=G),onChange:w},null,544),[[xa,h.value.linksToCheckIn]]),A[7]||(A[7]=r("span",null,"Link to check-in status",-1))]),r("p",M9," Completing this "+b(N(n).checklist)+" will check the "+b(N(n).person)+" in at the "+b(N(n).checkpoint)+". Checking in will complete this "+b(N(n).checklist)+". ",1)])):h.value.linksToCheckIn?(p(),g("div",A9,[r("p",E9,[A[8]||(A[8]=r("strong",null,"Note:",-1)),Je(' Link to check-in is currently enabled but the visibility settings are incompatible. Change visibility to "Everyone at specific '+b(N(n).checkpoints)+'" or "Specific '+b(N(n).people)+'" to use this feature. ',1)])])):D("",!0)],512),[[sa,d.value==="details"]]),Ge(r("div",P9,[Ee(td,{modelValue:h.value.scopeConfigurations,"onUpdate:modelValue":A[4]||(A[4]=G=>h.value.scopeConfigurations=G),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":f.value,onUserChanged:w},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[sa,d.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ee(kc,{show:l.value,title:"Validation error",message:c.value,onClose:A[5]||(A[5]=G=>l.value=!1)},null,8,["show","message"])],64))}},B9=Ze(O9,[["__scopeId","data-v-47f5ca39"]]),N9={class:"tab-content"},F9={class:"form-group"},U9={class:"form-group"},z9={class:"form-row"},H9={class:"form-group"},V9={class:"checkbox-label-inline show-emergency-checkbox"},G9={class:"form-group"},q9={class:"form-row"},j9={class:"form-group"},W9={class:"form-group checkbox-group-inline"},Z9={class:"checkbox-label-inline"},K9={class:"tab-content"},Y9={class:"custom-footer"},J9={class:"footer-left"},X9={__name:"EditNoteModal",props:{show:{type:Boolean,default:!1},note:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const n=e,a=t,o=P(!1),i=P(""),l=P("details"),c=P({title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1}),d=I=>I==="Urgent"||I==="Emergency",h=z(()=>!!n.note),f=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],m=z(()=>f.findIndex(I=>I.value===l.value)),y=z(()=>m.value===f.length-1),k=z(()=>y.value?"":f[m.value+1]?.label||"");Ye(()=>n.show,I=>{I&&(l.value=n.initialTab,n.note?c.value={title:n.note.title||"",content:n.note.content||"",scopeConfigurations:n.note.scopeConfigurations?JSON.parse(JSON.stringify(n.note.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:n.note.displayOrder||0,priority:n.note.priority||"Normal",category:n.note.category||"",isPinned:n.note.isPinned||!1,showInEmergencyInfo:n.note.showInEmergencyInfo??d(n.note.priority)}:c.value={title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1,showInEmergencyInfo:!1},a("update:isDirty",!1))}),Ye(()=>c.value.priority,(I,T)=>{!h.value&&I!==T&&(d(I)?c.value.showInEmergencyInfo=!0:d(T)&&(c.value.showInEmergencyInfo=!1))});const S=()=>{a("update:isDirty",!0)},x=()=>{a("close")},E=()=>{y.value||(l.value=f[m.value+1].value)},$=I=>{i.value=I,o.value=!0},w=()=>{if(!c.value.title||!c.value.title.trim()){$("Please enter a note title");return}if(!c.value.scopeConfigurations||c.value.scopeConfigurations.length===0){$("Please select at least one visibility scope");return}if(!c.value.scopeConfigurations.some(B=>!(B.itemType!==null&&(!B.ids||B.ids.length===0)))){$("Please configure at least one scope with valid selections");return}const T={title:c.value.title.trim(),content:c.value.content||"",scopeConfigurations:c.value.scopeConfigurations,displayOrder:c.value.displayOrder||0,priority:c.value.priority||"Normal",category:c.value.category?.trim()||null,isPinned:c.value.isPinned||!1,showInEmergencyInfo:c.value.showInEmergencyInfo};a("save",T)},_=()=>{a("delete",n.note.noteId)};return(I,T)=>(p(),g(xe,null,[Ee(jt,{show:e.show,title:h.value?"Edit note":"Create note",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:x},{"tab-header":Ue(()=>[Ee(gl,{modelValue:l.value,"onUpdate:modelValue":T[0]||(T[0]=B=>l.value=B),tabs:f},null,8,["modelValue"])]),footer:Ue(()=>[r("div",Y9,[r("div",J9,[h.value?(p(),g("button",{key:0,type:"button",onClick:_,class:"btn btn-danger"}," Delete ")):D("",!0),!h.value&&!y.value?(p(),g("button",{key:1,type:"button",onClick:E,class:"btn btn-secondary mobile-only"},b(k.value)+"... ",1)):D("",!0)]),r("button",{type:"button",onClick:w,class:"btn btn-success"}," Save ")])]),default:Ue(()=>[r("form",{onSubmit:ct(w,["prevent"]),class:"note-form"},[Ge(r("div",N9,[r("div",F9,[T[10]||(T[10]=r("label",{for:"title"},"Title: *",-1)),Ge(r("input",{id:"title","onUpdate:modelValue":T[1]||(T[1]=B=>c.value.title=B),type:"text",onInput:S,required:"",placeholder:"Enter note title..."},null,544),[[st,c.value.title]])]),r("div",U9,[T[11]||(T[11]=r("label",{for:"content"},"Content:",-1)),Ge(r("textarea",{id:"content","onUpdate:modelValue":T[2]||(T[2]=B=>c.value.content=B),onInput:S,rows:"6",placeholder:"Enter note content (supports markdown)..."},null,544),[[st,c.value.content]])]),r("div",z9,[r("div",H9,[T[14]||(T[14]=r("label",{for:"priority"},"Priority:",-1)),Ge(r("select",{id:"priority","onUpdate:modelValue":T[3]||(T[3]=B=>c.value.priority=B),onChange:S},[...T[12]||(T[12]=[r("option",{value:"Emergency"},"Emergency",-1),r("option",{value:"Urgent"},"Urgent",-1),r("option",{value:"High"},"High",-1),r("option",{value:"Normal"},"Normal",-1),r("option",{value:"Low"},"Low",-1)])],544),[[no,c.value.priority]]),r("label",V9,[Ge(r("input",{type:"checkbox","onUpdate:modelValue":T[4]||(T[4]=B=>c.value.showInEmergencyInfo=B),onChange:S},null,544),[[xa,c.value.showInEmergencyInfo]]),T[13]||(T[13]=r("span",null,"Show in emergency info",-1))])]),r("div",G9,[T[15]||(T[15]=r("label",{for:"category"},"Category:",-1)),Ge(r("input",{id:"category","onUpdate:modelValue":T[5]||(T[5]=B=>c.value.category=B),type:"text",onInput:S,placeholder:"e.g., Safety, Logistics..."},null,544),[[st,c.value.category]])])]),r("div",q9,[r("div",j9,[T[16]||(T[16]=r("label",{for:"displayOrder"},"Display order:",-1)),Ge(r("input",{id:"displayOrder","onUpdate:modelValue":T[6]||(T[6]=B=>c.value.displayOrder=B),type:"number",onInput:S,min:"0"},null,544),[[st,c.value.displayOrder,void 0,{number:!0}]]),T[17]||(T[17]=r("span",{class:"help-text"},"Lower numbers appear first",-1))]),r("div",W9,[r("label",Z9,[Ge(r("input",{type:"checkbox","onUpdate:modelValue":T[7]||(T[7]=B=>c.value.isPinned=B),onChange:S},null,544),[[xa,c.value.isPinned]]),T[18]||(T[18]=r("span",null,"Pin to top",-1))]),T[19]||(T[19]=r("span",{class:"help-text"},"Pinned notes always appear at the top",-1))])])],512),[[sa,l.value==="details"]]),Ge(r("div",K9,[Ee(td,{modelValue:c.value.scopeConfigurations,"onUpdate:modelValue":T[8]||(T[8]=B=>c.value.scopeConfigurations=B),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":h.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this note?",onUserChanged:S},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[sa,l.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ee(kc,{show:o.value,title:"Validation error",message:i.value,onClose:T[9]||(T[9]=B=>o.value=!1)},null,8,["show","message"])],64))}},Q9=Ze(X9,[["__scopeId","data-v-e8488047"]]),e7={class:"incident-detail-header"},t7={class:"header-title-row"},n7={class:"modal-title"},o7={class:"header-badges"},a7=["disabled"],s7={key:0,class:"status-dropdown-menu"},i7=["onClick","disabled"],l7={key:0,class:"incident-detail-content"},r7={class:"accordion-section"},c7={class:"accordion-arrow"},u7={key:0,class:"accordion-content"},d7={class:"description-text"},h7={class:"accordion-section"},f7={class:"accordion-arrow"},p7={key:0,class:"accordion-content"},v7={class:"info-grid"},m7={class:"info-item"},g7={class:"info-value"},y7={class:"info-item"},k7={class:"info-value"},b7={key:0,class:"info-item"},_7={class:"info-label"},w7={class:"info-value"},C7={key:1,class:"info-item"},L7={class:"info-label"},S7={class:"info-value"},I7={key:2,class:"info-item"},x7={class:"info-value"},$7={key:0,class:"incident-map-container"},T7={class:"accordion-section"},M7={class:"accordion-preview"},A7={class:"accordion-arrow"},E7={key:0,class:"accordion-content"},P7={class:"reporter-info"},D7={class:"reporter-name"},R7={key:0,class:"accordion-section"},O7={class:"accordion-title"},B7={class:"accordion-preview"},N7={class:"accordion-arrow"},F7={key:0,class:"accordion-content"},U7={class:"marshals-list"},z7={class:"marshal-name"},H7={key:0,class:"checkin-badge success"},V7={key:1,class:"checkin-badge not-checked-in"},G7={class:"accordion-section"},q7={key:0,class:"accordion-preview"},j7={class:"accordion-arrow"},W7={key:0,class:"accordion-content"},Z7={key:0,class:"notes-timeline"},K7={class:"note-header"},Y7={class:"note-author"},J7={class:"note-time"},X7={key:0,class:"note-status-change"},Q7={key:1,class:"note-text"},eU={key:1,class:"no-notes"},tU={__name:"IncidentDetailModal",props:{show:{type:Boolean,required:!0},incident:{type:Object,default:null},canManage:{type:Boolean,default:!1},route:{type:Array,default:()=>[]},checkpoints:{type:Array,default:()=>[]}},emits:["close","status-change","open-add-note"],setup(e,{emit:t}){const{terms:n,termsSentence:a}=ht(),o=e,i=t,l=P(!1),c=P(!1),d=P(null),h=P({description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1});Ye(()=>o.show,G=>{G&&(h.value={description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1},c.value=!1)});const f=G=>{d.value&&!d.value.contains(G.target)&&(c.value=!1)};Ye(c,G=>{G?document.addEventListener("click",f):document.removeEventListener("click",f)});const m=()=>{c.value=!c.value},y=G=>{o.incident?.status!==G&&(c.value=!1,A(G))},k=G=>{const F=h.value[G];Object.keys(h.value).forEach(j=>{h.value[j]=!1}),F||(h.value[G]=!0)},S=z(()=>o.incident?.latitude!=null&&o.incident?.longitude!=null),x=z(()=>S.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),E=z(()=>S.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),$=z(()=>{if(!o.incident)return"Incident Details";if(o.incident.title)return o.incident.title;const G=o.incident.description||"";return G.length<=50?G:G.substring(0,47)+"..."}),w=z(()=>[...o.incident?.context?.marshalsPresentAtCheckpoint||[]].sort((F,j)=>(F.name||"").localeCompare(j.name||"",void 0,{sensitivity:"base"}))),_=[{value:"open",label:"Open"},{value:"acknowledged",label:"Acknowledged"},{value:"in_progress",label:"In Progress"},{value:"resolved",label:"Resolved"},{value:"closed",label:"Closed"}],I=G=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[G]||G,T=G=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[G]||G,B=G=>{if(!G)return"";let F=G.name||"";if(G.description){const j=G.description,K=40,J=j.length>K?j.substring(0,K-3)+"...":j;F+=` - ${J}`}return F},M=G=>G?new Date(G).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",R=G=>{if(!G)return"";const F=new Date(G),K=new Date-F,J=Math.floor(K/6e4),ue=Math.floor(K/36e5),Z=Math.floor(K/864e5);return J<1?"just now":J<60?`${J}m ago`:ue<24?`${ue}h ago`:Z<7?`${Z}d ago`:F.toLocaleDateString()},A=async G=>{if(o.incident?.status!==G){l.value=!0;try{i("status-change",{incidentId:o.incident.incidentId,status:G})}finally{l.value=!1}}};return(G,F)=>(p(),ze(jt,{show:e.show,title:$.value,size:"large",onClose:F[7]||(F[7]=j=>G.$emit("close"))},{header:Ue(()=>[r("div",e7,[r("div",t7,[r("span",{class:le(["severity-indicator",e.incident?.severity])},null,2),r("h2",n7,b($.value),1)]),r("div",o7,[r("span",{class:le(["severity-badge",e.incident?.severity])},b(I(e.incident?.severity)),3),e.canManage?(p(),g("div",{key:0,class:"status-dropdown-container",ref_key:"statusDropdownRef",ref:d},[r("button",{type:"button",class:le(["status-badge status-dropdown-trigger",e.incident?.status]),onClick:m,disabled:l.value},[Je(b(T(e.incident?.status))+" ",1),F[8]||(F[8]=r("span",{class:"dropdown-arrow"},"",-1))],10,a7),c.value?(p(),g("div",s7,[(p(),g(xe,null,qe(_,j=>r("button",{key:j.value,type:"button",class:le(["status-dropdown-item",{active:e.incident?.status===j.value}]),onClick:K=>y(j.value),disabled:e.incident?.status===j.value},[r("span",{class:le(["status-dot",j.value])},null,2),Je(" "+b(j.label),1)],10,i7)),64))])):D("",!0)],512)):(p(),g("span",{key:1,class:le(["status-badge",e.incident?.status])},b(T(e.incident?.status)),3))])])]),footer:Ue(()=>[r("button",{class:"btn btn-secondary",onClick:F[6]||(F[6]=j=>G.$emit("close"))},"Close")]),default:Ue(()=>[e.incident?(p(),g("div",l7,[r("div",r7,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.description}]),onClick:F[0]||(F[0]=j=>k("description"))},[F[9]||(F[9]=r("span",{class:"accordion-title"},"Description",-1)),r("span",c7,b(h.value.description?"":""),1)],2),h.value.description?(p(),g("div",u7,[r("p",d7,b(e.incident.description),1)])):D("",!0)]),r("div",h7,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.timeLocation}]),onClick:F[1]||(F[1]=j=>k("timeLocation"))},[F[10]||(F[10]=r("span",{class:"accordion-title"},"Time & location",-1)),r("span",f7,b(h.value.timeLocation?"":""),1)],2),h.value.timeLocation?(p(),g("div",p7,[r("div",v7,[r("div",m7,[F[11]||(F[11]=r("span",{class:"info-label"},"Incident time",-1)),r("span",g7,b(M(e.incident.incidentTime)),1)]),r("div",y7,[F[12]||(F[12]=r("span",{class:"info-label"},"Reported at",-1)),r("span",k7,b(M(e.incident.createdAt)),1)]),e.incident.context?.checkpoint?(p(),g("div",b7,[r("span",_7,b(N(a).checkpoint),1),r("span",w7,b(B(e.incident.context.checkpoint)),1)])):D("",!0),e.incident.area?(p(),g("div",C7,[r("span",L7,b(N(a).area),1),r("span",S7,b(e.incident.area.areaName),1)])):D("",!0),S.value?(p(),g("div",I7,[F[13]||(F[13]=r("span",{class:"info-label"},"GPS location",-1)),r("span",x7,b(e.incident.latitude.toFixed(6))+", "+b(e.incident.longitude.toFixed(6)),1)])):D("",!0)]),S.value?(p(),g("div",$7,[Ee(hl,{locations:e.checkpoints,route:e.route,center:x.value,zoom:15,"user-location":E.value,height:"200px"},null,8,["locations","route","center","user-location"])])):D("",!0)])):D("",!0)]),r("div",T7,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.reporter}]),onClick:F[2]||(F[2]=j=>k("reporter"))},[F[14]||(F[14]=r("span",{class:"accordion-title"},"Reported by",-1)),r("span",M7,b(e.incident.reportedBy?.name||"Unknown"),1),r("span",A7,b(h.value.reporter?"":""),1)],2),h.value.reporter?(p(),g("div",E7,[r("div",P7,[r("span",D7,b(e.incident.reportedBy?.name||"Unknown"),1)])])):D("",!0)]),w.value.length?(p(),g("div",R7,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.marshals}]),onClick:F[3]||(F[3]=j=>k("marshals"))},[r("span",O7,b(N(n).peoplePlural)+" at "+b(N(n).checkpoint.toLowerCase()),1),r("span",B7,b(w.value.length),1),r("span",N7,b(h.value.marshals?"":""),1)],2),h.value.marshals?(p(),g("div",F7,[r("div",U7,[(p(!0),g(xe,null,qe(w.value,j=>(p(),g("div",{key:j.marshalId,class:le(["marshal-item",{"checked-in":j.wasCheckedIn}])},[r("span",z7,b(j.name),1),j.wasCheckedIn?(p(),g("span",H7," Checked in "+b(R(j.checkInTime)),1)):(p(),g("span",V7," Not checked in "))],2))),128))])])):D("",!0)])):D("",!0),r("div",G7,[r("button",{type:"button",class:le(["accordion-header",{expanded:h.value.notes}]),onClick:F[4]||(F[4]=j=>k("notes"))},[F[15]||(F[15]=r("span",{class:"accordion-title"},"Updates",-1)),e.incident.updates?.length?(p(),g("span",q7,b(e.incident.updates.length),1)):D("",!0),r("span",j7,b(h.value.notes?"":""),1)],2),h.value.notes?(p(),g("div",W7,[e.incident.updates?.length?(p(),g("div",Z7,[(p(!0),g(xe,null,qe(e.incident.updates,(j,K)=>(p(),g("div",{key:K,class:"note-item"},[r("div",K7,[r("span",Y7,b(j.authorName||"System"),1),r("span",J7,b(R(j.timestamp)),1)]),j.statusChange?(p(),g("div",X7,[F[16]||(F[16]=Je(" Status changed to ",-1)),r("span",{class:le(["status-badge",j.statusChange])},b(T(j.statusChange)),3)])):j.note?(p(),g("p",Q7,b(j.note),1)):D("",!0)]))),128))])):(p(),g("div",eU," No updates yet. ")),r("button",{type:"button",class:"btn btn-primary add-note-btn",onClick:F[5]||(F[5]=j=>G.$emit("open-add-note"))}," Add update ")])):D("",!0)])])):D("",!0)]),_:1},8,["show","title"]))}},_1=Ze(tU,[["__scopeId","data-v-df0707d4"]]),nU={class:"form-group"},oU={class:"form-group"},aU={class:"form-row"},sU={class:"form-group form-group-half"},iU=["value"],lU={class:"form-group form-group-half"},rU={key:0,class:"form-group"},cU={for:"checkpoint",class:"form-label"},uU=["value"],dU={key:1,class:"form-group"},hU={class:"form-label"},fU={class:"checkpoint-toggle"},pU={class:"checkbox-label"},vU={class:"checkpoint-name"},mU={key:0,class:"checkpoint-description"},gU={class:"form-group"},yU={class:"location-options"},kU={class:"location-buttons"},bU={key:0,class:"location-status"},_U={key:0,class:"location-getting"},wU={key:1,class:"location-display"},CU={key:0,class:"location-accuracy"},LU={key:2,class:"location-error"},SU={key:1,class:"map-picker-container"},IU={key:0,class:"map-picker-hint"},xU={key:2,class:"location-display"},$U={key:2,class:"error-message"},TU={class:"modal-actions"},MU=["disabled"],AU={__name:"ReportIncidentModal",props:{show:{type:Boolean,required:!0},eventId:{type:String,required:!0},checkpoint:{type:Object,default:null},initialLocation:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]}},emits:["close","submit"],setup(e,{emit:t}){const{termsSentence:n}=ht(),a=e,o=t,i=P({title:"",description:"",severity:"medium",incidentTime:""}),l=P(""),c=P(!0),d=P("none"),h=P(!1),f=P(null),m=P(null),y=P(null),k=P(!1),S=P(!1),x=P(null),E=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],$=()=>{const j=new Date,K=j.getFullYear(),J=String(j.getMonth()+1).padStart(2,"0"),ue=String(j.getDate()).padStart(2,"0"),Z=String(j.getHours()).padStart(2,"0"),se=String(j.getMinutes()).padStart(2,"0");return`${K}-${J}-${ue}T${Z}:${se}`},w=j=>j?new Date(j).toISOString():null,_=z(()=>a.checkpoints||[]),I=z(()=>{if(f.value?.latitude!=null)return{lat:f.value.latitude,lng:f.value.longitude};if(l.value){const j=_.value.find(K=>K.id===l.value);if(j?.latitude!=null)return{lat:j.latitude,lng:j.longitude}}if(a.initialLocation?.latitude!=null)return{lat:a.initialLocation.latitude,lng:a.initialLocation.longitude};if(a.checkpoint?.latitude!=null)return{lat:a.checkpoint.latitude,lng:a.checkpoint.longitude};if(_.value.length>0){const j=_.value[0];if(j.latitude!=null)return{lat:j.latitude,lng:j.longitude}}if(a.route?.length>0){const j=a.route[0];if(j?.lat!=null)return{lat:j.lat,lng:j.lng}}return{lat:-33.9,lng:151.2}}),T=z(()=>i.value.description.trim()!==""),B=z(()=>i.value.description.trim()!=="");Ye(()=>a.show,j=>{j&&(i.value={title:"",description:"",severity:"medium",incidentTime:$()},l.value="",c.value=!0,S.value=!1,x.value=null,y.value=null,f.value=null,m.value=null,a.initialLocation&&a.initialLocation.latitude!=null?(f.value={latitude:a.initialLocation.latitude,longitude:a.initialLocation.longitude},m.value=a.initialLocation.accuracy,d.value="gps",h.value=!1):(d.value="none",h.value=!1),a.checkpoint&&(l.value=a.checkpoint.locationId||a.checkpoint.id||""))});const M=j=>{y.value=null,j==="map"?d.value==="map"?h.value=!h.value:(d.value="map",h.value=!0,m.value=null):j==="gps"?(d.value="gps",h.value=!1,A()):(d.value="none",h.value=!1,f.value=null,m.value=null)},R=j=>{f.value={latitude:j.lat,longitude:j.lng},m.value=null,h.value=!1},A=()=>{if(a.initialLocation&&a.initialLocation.latitude!=null){f.value={latitude:a.initialLocation.latitude,longitude:a.initialLocation.longitude},m.value=a.initialLocation.accuracy;return}if(!navigator.geolocation){y.value="GPS is not available on this device.";return}k.value=!0,navigator.geolocation.getCurrentPosition(j=>{f.value={latitude:j.coords.latitude,longitude:j.coords.longitude},m.value=j.coords.accuracy,k.value=!1},j=>{y.value="Unable to get your location.",k.value=!1},{enableHighAccuracy:!0,timeout:1e4})},G=async()=>{if(!(!B.value||S.value)){S.value=!0,x.value=null;try{const j=(d.value==="gps"||d.value==="map")&&f.value;let K=null,J=!1;_.value.length>0?l.value?K=l.value:J=!0:a.checkpoint&&(c.value?K=a.checkpoint.locationId||a.checkpoint.id||null:J=!0);const ue={title:i.value.title.trim()||null,description:i.value.description.trim(),severity:i.value.severity,incidentTime:w(i.value.incidentTime),latitude:j?f.value.latitude:null,longitude:j?f.value.longitude:null,checkpointId:K,skipCheckpointAutoAssign:J};o("submit",ue)}catch(j){x.value=j.message||"Failed to report incident. Please try again.",S.value=!1}}},F=()=>{o("close")};return(j,K)=>(p(),ze(jt,{show:e.show,title:"Report Incident",size:"medium","confirm-on-close":!0,"is-dirty":T.value,onClose:F},{footer:Ue(()=>[r("div",TU,[r("button",{type:"button",class:"btn btn-secondary",onClick:F}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:G,disabled:!B.value||S.value},b(S.value?"Reporting...":"Report Incident"),9,MU)])]),default:Ue(()=>[r("form",{onSubmit:ct(G,["prevent"]),class:"incident-form"},[r("div",nU,[K[10]||(K[10]=r("label",{for:"title",class:"form-label"},"Title",-1)),Ge(r("input",{id:"title","onUpdate:modelValue":K[0]||(K[0]=J=>i.value.title=J),type:"text",class:"form-input",placeholder:"Brief summary (optional)"},null,512),[[st,i.value.title]])]),r("div",oU,[K[11]||(K[11]=r("label",{for:"description",class:"form-label"},[Je("Description "),r("span",{class:"required"},"*")],-1)),Ge(r("textarea",{id:"description","onUpdate:modelValue":K[1]||(K[1]=J=>i.value.description=J),class:"form-input form-textarea",placeholder:"Describe what happened...",rows:"3",required:""},null,512),[[st,i.value.description]])]),r("div",aU,[r("div",sU,[K[12]||(K[12]=r("label",{for:"severity",class:"form-label"},"Severity",-1)),Ge(r("select",{id:"severity","onUpdate:modelValue":K[2]||(K[2]=J=>i.value.severity=J),class:"form-input form-select"},[(p(),g(xe,null,qe(E,J=>r("option",{key:J.value,value:J.value},b(J.label),9,iU)),64))],512),[[no,i.value.severity]])]),r("div",lU,[K[13]||(K[13]=r("label",{for:"incidentTime",class:"form-label"},"When",-1)),Ge(r("input",{id:"incidentTime","onUpdate:modelValue":K[3]||(K[3]=J=>i.value.incidentTime=J),type:"datetime-local",class:"form-input"},null,512),[[st,i.value.incidentTime]])])]),_.value.length>0?(p(),g("div",rU,[r("label",cU,b(N(n).checkpoint),1),Ge(r("select",{id:"checkpoint","onUpdate:modelValue":K[4]||(K[4]=J=>l.value=J),class:"form-input form-select"},[K[14]||(K[14]=r("option",{value:""},"-- None / Unknown --",-1)),(p(!0),g(xe,null,qe(_.value,J=>(p(),g("option",{key:J.id,value:J.id},b(J.name)+b(J.description?` - ${J.description}`:""),9,uU))),128))],512),[[no,l.value]])])):e.checkpoint?(p(),g("div",dU,[r("label",hU,b(N(n).checkpoint),1),r("div",fU,[r("label",pU,[Ge(r("input",{type:"checkbox","onUpdate:modelValue":K[5]||(K[5]=J=>c.value=J)},null,512),[[xa,c.value]]),r("span",vU,b(e.checkpoint.name),1),e.checkpoint.description?(p(),g("span",mU," - "+b(e.checkpoint.description),1)):D("",!0)])])])):D("",!0),r("div",gU,[K[15]||(K[15]=r("label",{class:"form-label"},"Location (optional)",-1)),r("div",yU,[r("div",kU,[r("button",{type:"button",class:le(["location-btn",{active:d.value==="gps"}]),onClick:K[6]||(K[6]=J=>M("gps"))}," GPS ",2),r("button",{type:"button",class:le(["location-btn",{active:d.value==="map"}]),onClick:K[7]||(K[7]=J=>M("map"))}," Pick on map ",2),r("button",{type:"button",class:le(["location-btn",{active:d.value==="none"}]),onClick:K[8]||(K[8]=J=>M("none"))}," None ",2)]),d.value==="gps"?(p(),g("div",bU,[k.value?(p(),g("div",_U," Getting location... ")):f.value&&f.value.latitude!=null?(p(),g("div",wU,[r("span",null,b(f.value.latitude.toFixed(5))+", "+b(f.value.longitude.toFixed(5)),1),m.value?(p(),g("span",CU,"("+b(Math.round(m.value))+"m)",1)):D("",!0)])):y.value?(p(),g("div",LU,b(y.value),1)):D("",!0)])):D("",!0),d.value==="map"?(p(),g("div",SU,[h.value?(p(),g("div",IU,"Tap to select location")):D("",!0),h.value?(p(),ze(hl,{key:1,locations:_.value,route:e.route,center:I.value,zoom:14,mode:"select-point","user-location":e.initialLocation,"highlight-location-id":l.value,height:"150px",onPointSelected:R},null,8,["locations","route","center","user-location","highlight-location-id"])):D("",!0),f.value&&f.value.latitude!=null?(p(),g("div",xU,[r("span",null,b(f.value.latitude.toFixed(5))+", "+b(f.value.longitude.toFixed(5)),1),h.value?D("",!0):(p(),g("button",{key:0,type:"button",class:"location-edit-btn",onClick:K[9]||(K[9]=J=>h.value=!0)},"Edit"))])):D("",!0)])):D("",!0)])]),x.value?(p(),g("div",$U,b(x.value),1)):D("",!0)],32)]),_:1},8,["show","is-dirty"]))}},w1=Ze(AU,[["__scopeId","data-v-20b520b6"]]),EU={class:"tab-content"},PU={key:0,class:"form-group"},DU={for:"marshalId"},RU=["value"],OU={class:"help-text"},BU={key:1,class:"form-group"},NU={class:"linked-marshal-info"},FU={class:"linked-marshal-name"},UU={class:"linked-marshal-hint"},zU={key:2,class:"form-group"},HU={class:"form-group"},VU={key:0,class:"selected-roles"},GU=["onClick"],qU={class:"role-input-group"},jU=["value"],WU={class:"checkbox-label-inline show-emergency-checkbox"},ZU={class:"form-row"},KU={class:"form-group"},YU={class:"form-group"},JU={class:"form-group"},XU={class:"form-row"},QU={class:"form-group"},ez={class:"form-group checkbox-group-inline"},tz={class:"checkbox-label-inline"},nz={class:"tab-content"},oz={class:"custom-footer"},az={class:"footer-left"},sz=["disabled"],iz={__name:"EditContactModal",props:{show:{type:Boolean,default:!1},contact:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},roleDefinitions:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},preselectedArea:{type:Object,default:null},prefilledName:{type:String,default:""},prefilledMarshalId:{type:String,default:null},createFromAreaContext:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{terms:n}=ht(),a=e,o=t,i=P(!1),l=P(""),c=P("details"),d=P(""),h=P({roles:[],name:"",phone:"",email:"",notes:"",marshalId:null,showInEmergencyInfo:!1,displayOrder:0,isPinned:!1,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}),f=z(()=>[...a.roleDefinitions].sort((J,ue)=>J.isBuiltIn!==ue.isBuiltIn?J.isBuiltIn?-1:1:J.displayOrder!==ue.displayOrder?(J.displayOrder||0)-(ue.displayOrder||0):(J.name||"").localeCompare(ue.name||"",void 0,{numeric:!0,sensitivity:"base"}))),m=z(()=>{const J=h.value.roles||[];return f.value.filter(ue=>!J.includes(ue.roleId))}),y=J=>a.roleDefinitions.find(Z=>Z.roleId===J)?.name||J,k=J=>a.roleDefinitions.find(Z=>Z.roleId===J)?.name==="EmergencyContact",S=()=>{d.value&&!h.value.roles.includes(d.value)&&(h.value.roles.push(d.value),k(d.value)&&(h.value.showInEmergencyInfo=!0),M()),d.value=""},x=J=>{const ue=h.value.roles.indexOf(J);ue>-1&&(h.value.roles.splice(ue,1),k(J)&&!h.value.roles.some(Z=>k(Z))&&(h.value.showInEmergencyInfo=!1),M())},E=z(()=>!!a.contact),$=z(()=>a.createFromAreaContext?[{value:"details",label:"Details"}]:[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}]),w=z(()=>!!h.value.marshalId),_=z(()=>!E.value&&!!a.prefilledMarshalId),I=z(()=>E.value&&!!a.contact?.marshalId),T=z(()=>a.contact?.marshalId?a.marshals.find(ue=>ue.id===a.contact.marshalId)?.name||"Unknown":""),B=z(()=>[...a.marshals].sort((J,ue)=>na(J.name,ue.name)));Ye(()=>a.show,J=>{if(J){if(c.value=a.initialTab,d.value="",a.contact){let ue=[];a.contact.roles&&Array.isArray(a.contact.roles)&&(ue=[...a.contact.roles]),h.value={roles:ue,name:a.contact.name||"",phone:a.contact.phone||"",email:a.contact.email||"",notes:a.contact.notes||"",marshalId:a.contact.marshalId||null,showInEmergencyInfo:a.contact.showInEmergencyInfo??ue.some(Z=>k(Z)),displayOrder:a.contact.displayOrder||0,isPinned:a.contact.isPinned||!1,scopeConfigurations:a.contact.scopeConfigurations?JSON.parse(JSON.stringify(a.contact.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}}else{let ue;a.createFromAreaContext?ue=[]:a.preselectedArea?ue=[{scope:"EveryoneInAreas",itemType:"Area",ids:[a.preselectedArea.id]}]:ue=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}];let Z={name:a.prefilledName||"",phone:"",email:"",roles:[]};if(a.prefilledMarshalId){const se=a.marshals.find(U=>U.id===a.prefilledMarshalId);se&&(Z={name:se.name||"",phone:se.phoneNumber||"",email:se.email||"",roles:se.roles||[]})}h.value={roles:[...Z.roles],name:Z.name,phone:Z.phone,email:Z.email,notes:"",marshalId:a.prefilledMarshalId||null,showInEmergencyInfo:Z.roles.some(se=>k(se)),displayOrder:0,isPinned:!1,scopeConfigurations:ue}}o("update:isDirty",!1)}});const M=()=>{o("update:isDirty",!0)},R=()=>{if(h.value.marshalId){const J=a.marshals.find(ue=>ue.id===h.value.marshalId);J&&(h.value.name=J.name,!h.value.phone&&J.phoneNumber&&(h.value.phone=J.phoneNumber),!h.value.email&&J.email&&(h.value.email=J.email),h.value.roles=J.roles?[...J.roles]:[],h.value.showInEmergencyInfo=h.value.roles.some(ue=>k(ue)))}else h.value.name="";M()},A=()=>{o("close")},G=()=>{if(!h.value.roles||h.value.roles.length===0){F("Please select or enter at least one role");return}if(!h.value.name||!h.value.name.trim()){F("Please enter a contact name");return}c.value="visibility"},F=J=>{l.value=J,i.value=!0},j=()=>{if(!h.value.roles||h.value.roles.length===0){F("Please select or enter at least one role");return}if(!h.value.name||!h.value.name.trim()){F("Please enter a contact name");return}if(!a.createFromAreaContext){if(!h.value.scopeConfigurations||h.value.scopeConfigurations.length===0){F("Please select at least one visibility scope");return}if(!h.value.scopeConfigurations.some(Z=>!(Z.itemType!==null&&(!Z.ids||Z.ids.length===0)))){F("Please configure at least one scope with valid selections");return}}const J={roles:h.value.roles,name:h.value.name.trim(),phone:h.value.phone?.trim()||null,email:h.value.email?.trim()||null,notes:h.value.notes?.trim()||null,marshalId:h.value.marshalId||null,showInEmergencyInfo:h.value.showInEmergencyInfo,displayOrder:h.value.displayOrder||0,isPinned:h.value.isPinned||!1,scopeConfigurations:h.value.scopeConfigurations};o("save",J)},K=()=>{o("delete",a.contact.contactId)};return(J,ue)=>(p(),g(xe,null,[Ee(jt,{show:e.show,title:E.value?"Edit contact":"Create contact",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:A},{"tab-header":Ue(()=>[Ee(gl,{modelValue:c.value,"onUpdate:modelValue":ue[0]||(ue[0]=Z=>c.value=Z),tabs:$.value},null,8,["modelValue","tabs"])]),footer:Ue(()=>[r("div",oz,[r("div",az,[E.value?(p(),g("button",{key:0,type:"button",onClick:K,class:"btn btn-danger"}," Delete ")):D("",!0),!E.value&&c.value==="details"?(p(),g("button",{key:1,type:"button",onClick:G,class:"btn btn-secondary mobile-only"}," Visibility... ")):D("",!0)]),r("button",{type:"button",onClick:j,class:"btn btn-success",disabled:E.value&&!e.isDirty}," Save ",8,sz)])]),default:Ue(()=>[r("form",{onSubmit:ct(j,["prevent"]),class:"contact-form"},[Ge(r("div",EU,[!_.value&&!I.value?(p(),g("div",PU,[r("label",DU,"Link to "+b(N(n).person.toLowerCase())+":",1),Ge(r("select",{id:"marshalId","onUpdate:modelValue":ue[1]||(ue[1]=Z=>h.value.marshalId=Z),onChange:R},[ue[12]||(ue[12]=r("option",{value:null},"-- Not linked --",-1)),(p(!0),g(xe,null,qe(B.value,Z=>(p(),g("option",{key:Z.id,value:Z.id},b(Z.name),9,RU))),128))],544),[[no,h.value.marshalId]]),r("span",OU,"Optionally link to an existing "+b(N(n).person.toLowerCase())+" in the system",1)])):D("",!0),I.value?(p(),g("div",BU,[r("label",null,"Linked "+b(N(n).person.toLowerCase())+":",1),r("div",NU,[r("span",FU,b(T.value),1),r("span",UU,"Contact details are synced with this "+b(N(n).person.toLowerCase()),1)])])):D("",!0),w.value?D("",!0):(p(),g("div",zU,[ue[13]||(ue[13]=r("label",{for:"name"},"Name: *",-1)),Ge(r("input",{id:"name","onUpdate:modelValue":ue[2]||(ue[2]=Z=>h.value.name=Z),type:"text",onInput:M,placeholder:"Contact name..."},null,544),[[st,h.value.name]])])),r("div",HU,[ue[16]||(ue[16]=r("label",null,"Roles: *",-1)),h.value.roles.length>0?(p(),g("div",VU,[(p(!0),g(xe,null,qe(h.value.roles,Z=>(p(),g("span",{key:Z,class:"role-pill"},[Je(b(y(Z))+" ",1),r("button",{type:"button",class:"remove-role-btn",onClick:se=>x(Z),title:"Remove role"},"",8,GU)]))),128))])):D("",!0),r("div",qU,[Ge(r("select",{id:"role","onUpdate:modelValue":ue[3]||(ue[3]=Z=>d.value=Z),onChange:S},[ue[14]||(ue[14]=r("option",{value:"",disabled:""},"Add a role...",-1)),(p(!0),g(xe,null,qe(m.value,Z=>(p(),g("option",{key:Z.roleId,value:Z.roleId},b(Z.name),9,jU))),128))],544),[[no,d.value]])]),r("label",WU,[Ge(r("input",{type:"checkbox","onUpdate:modelValue":ue[4]||(ue[4]=Z=>h.value.showInEmergencyInfo=Z),onChange:M},null,544),[[xa,h.value.showInEmergencyInfo]]),ue[15]||(ue[15]=r("span",null,"Show in emergency info",-1))])]),r("div",ZU,[r("div",KU,[ue[17]||(ue[17]=r("label",{for:"phone"},"Phone:",-1)),Ge(r("input",{id:"phone","onUpdate:modelValue":ue[5]||(ue[5]=Z=>h.value.phone=Z),type:"tel",onInput:M,placeholder:"Phone number..."},null,544),[[st,h.value.phone]])]),r("div",YU,[ue[18]||(ue[18]=r("label",{for:"email"},"Email:",-1)),Ge(r("input",{id:"email","onUpdate:modelValue":ue[6]||(ue[6]=Z=>h.value.email=Z),type:"email",onInput:M,placeholder:"Email address..."},null,544),[[st,h.value.email]])])]),r("div",JU,[ue[19]||(ue[19]=r("label",{for:"notes"},"Notes / Instructions:",-1)),Ge(r("textarea",{id:"notes","onUpdate:modelValue":ue[7]||(ue[7]=Z=>h.value.notes=Z),onInput:M,rows:"3",placeholder:"Additional notes or instructions for when to contact..."},null,544),[[st,h.value.notes]])]),r("div",XU,[r("div",QU,[ue[20]||(ue[20]=r("label",{for:"displayOrder"},"Display order:",-1)),Ge(r("input",{id:"displayOrder","onUpdate:modelValue":ue[8]||(ue[8]=Z=>h.value.displayOrder=Z),type:"number",onInput:M,min:"0"},null,544),[[st,h.value.displayOrder,void 0,{number:!0}]]),ue[21]||(ue[21]=r("span",{class:"help-text"},"Lower numbers appear first",-1))]),r("div",ez,[r("label",tz,[Ge(r("input",{type:"checkbox","onUpdate:modelValue":ue[9]||(ue[9]=Z=>h.value.isPinned=Z),onChange:M},null,544),[[xa,h.value.isPinned]]),ue[22]||(ue[22]=r("span",null,"Pin to top",-1))]),ue[23]||(ue[23]=r("span",{class:"help-text"},"Pinned contacts always appear at the top",-1))])])],512),[[sa,c.value==="details"]]),Ge(r("div",nz,[Ee(td,{modelValue:h.value.scopeConfigurations,"onUpdate:modelValue":ue[10]||(ue[10]=Z=>h.value.scopeConfigurations=Z),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":E.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this contact?",onUserChanged:M},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[sa,c.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ee(kc,{show:i.value,title:"Validation error",message:l.value,onClose:ue[11]||(ue[11]=Z=>i.value=!1)},null,8,["show","message"])],64))}},lz=Ze(iz,[["__scopeId","data-v-300a990f"]]),rz={class:"tab-content"},cz={class:"form-group"},uz={class:"form-group"},dz={class:"form-group checkbox-group"},hz={class:"checkbox-label"},fz={class:"checkbox-text"},pz={class:"help-text"},vz={class:"tab-content"},mz={key:0,class:"loading-state"},gz={key:1,class:"empty-state"},yz={key:2,class:"people-list"},kz={class:"search-row"},bz={class:"people-items"},_z=["checked","onChange"],wz={class:"person-name"},Cz={class:"person-type-badge marshal"},Lz={key:0,class:"empty-search"},Sz={class:"custom-footer"},Iz={class:"footer-left"},xz=["disabled","title"],$z={__name:"EditRoleDefinitionModal",props:{show:{type:Boolean,default:!1},role:{type:Object,default:null},initialTab:{type:String,default:"details"},people:{type:Array,default:()=>[]},loadingPeople:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty","load-people","toggle-person-role"],setup(e,{emit:t}){const{terms:n}=ht(),a=e,o=t,i=P(!1),l=P(""),c=P(""),d=P(new Map),h=[{value:"details",label:"Details"},{value:"assignments",label:"Assignments"}],f=P(a.initialTab),m=P({name:"",notes:"",canManageAreaCheckpoints:!1}),y=z(()=>!!a.role?.roleId);Ye(()=>[a.show,a.role],([B,M])=>{B&&(f.value=a.initialTab,c.value="",d.value=new Map,M?m.value={name:M.name||"",notes:M.notes||"",canManageAreaCheckpoints:M.canManageAreaCheckpoints||!1}:m.value={name:"",notes:"",canManageAreaCheckpoints:!1},o("update:isDirty",!1))},{immediate:!0}),Ye(f,B=>{B==="assignments"&&y.value&&a.people.length===0&&o("load-people",a.role.roleId)}),Ye(()=>a.people,B=>{if(B.length>0&&d.value.size===0){const M=new Map;for(const R of B)M.set(R.id,R.hasRole);d.value=M}},{immediate:!0});const k=()=>{o("update:isDirty",!0)},S=B=>B==="Linked"?"Linked":B==="Marshal"?n.value.person:B==="Contact"?"Contact":B,x=z(()=>{let B=[...a.people];if(c.value.trim()){const M=c.value.toLowerCase();B=B.filter(R=>R.name.toLowerCase().includes(M))}return B.sort((M,R)=>{const A=d.value.get(M.id)??!1,G=d.value.get(R.id)??!1;return A!==G?A?-1:1:M.name.localeCompare(R.name,void 0,{sensitivity:"base"})})}),E=z(()=>a.people.length>0&&a.people.every(B=>B.hasRole)),$=()=>{const B=!E.value;for(const M of a.people)M.hasRole!==B&&o("toggle-person-role",{person:M,addRole:B})},w=B=>{o("toggle-person-role",{person:B,addRole:!B.hasRole})},_=()=>{if(!m.value.name.trim()){l.value="Role name is required.",i.value=!0;return}o("save",{name:m.value.name.trim(),notes:m.value.notes.trim(),canManageAreaCheckpoints:m.value.canManageAreaCheckpoints})},I=()=>{if(a.role?.usageCount>0){l.value="Cannot delete a role that is still assigned to people. Remove the role from all people first.",i.value=!0;return}o("delete",a.role.roleId)},T=()=>{o("close")};return(B,M)=>(p(),g(xe,null,[Ee(jt,{show:e.show,title:y.value?"Edit role":"Create role",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:T},{"tab-header":Ue(()=>[Ee(gl,{modelValue:f.value,"onUpdate:modelValue":M[0]||(M[0]=R=>f.value=R),tabs:h},null,8,["modelValue"])]),footer:Ue(()=>[r("div",Sz,[r("div",Iz,[y.value?(p(),g("button",{key:0,type:"button",onClick:I,class:"btn btn-danger",disabled:e.role?.usageCount>0,title:e.role?.usageCount>0?"Cannot delete role that is in use":"Delete this role"}," Delete ",8,xz)):D("",!0)]),r("button",{type:"button",onClick:_,class:"btn btn-success"}," Save ")])]),default:Ue(()=>[r("form",{onSubmit:ct(_,["prevent"]),class:"role-form"},[Ge(r("div",rz,[r("div",cz,[M[6]||(M[6]=r("label",{for:"name"},"Name: *",-1)),Ge(r("input",{id:"name","onUpdate:modelValue":M[1]||(M[1]=R=>m.value.name=R),type:"text",onInput:k,required:"",placeholder:"Enter role name..."},null,544),[[st,m.value.name]])]),r("div",uz,[M[7]||(M[7]=r("label",{for:"notes"},"Notes:",-1)),Ge(r("textarea",{id:"notes","onUpdate:modelValue":M[2]||(M[2]=R=>m.value.notes=R),onInput:k,rows:"6",placeholder:"Enter role description or notes..."},null,544),[[st,m.value.notes]]),M[8]||(M[8]=r("span",{class:"help-text"},"Describe what this role is responsible for",-1))]),r("div",dz,[r("label",hz,[Ge(r("input",{type:"checkbox","onUpdate:modelValue":M[3]||(M[3]=R=>m.value.canManageAreaCheckpoints=R),onChange:k},null,544),[[xa,m.value.canManageAreaCheckpoints]]),r("span",fz,"Is "+b(N(n).area.toLowerCase())+" lead",1)]),r("span",pz,"When enabled, "+b(N(n).people.toLowerCase())+" with this role can view all other "+b(N(n).checkpoints.toLowerCase())+" and "+b(N(n).people.toLowerCase())+" in their "+b(N(n).area.toLowerCase())+".",1)])],512),[[sa,f.value==="details"]]),Ge(r("div",vz,[M[11]||(M[11]=r("div",{class:"assignments-header"},[r("h4",null,"Who has this role?"),r("p",{class:"help-text"},"Select the people who should have this role assigned.")],-1)),e.loadingPeople?(p(),g("div",mz," Loading people... ")):e.people.length===0?(p(),g("div",gz,[...M[9]||(M[9]=[r("p",null,"No marshals or contacts to assign.",-1)])])):(p(),g("div",yz,[r("div",kz,[Ge(r("input",{"onUpdate:modelValue":M[4]||(M[4]=R=>c.value=R),type:"text",class:"search-input",placeholder:"Search by name..."},null,512),[[st,c.value]]),r("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:$},b(E.value?"Deselect all":"Select all"),1)]),r("div",bz,[(p(!0),g(xe,null,qe(x.value,R=>(p(),g("label",{key:R.id,class:le(["person-item",{checked:R.hasRole}])},[r("input",{type:"checkbox",checked:R.hasRole,onChange:A=>w(R)},null,40,_z),r("span",wz,b(R.name),1),R.personType==="Linked"?(p(),g(xe,{key:0},[r("span",Cz,b(N(n).person),1),M[10]||(M[10]=r("span",{class:"person-type-badge contact"},"Contact",-1))],64)):(p(),g("span",{key:1,class:le(["person-type-badge",R.personType.toLowerCase()])},b(S(R.personType)),3))],2))),128))]),x.value.length===0?(p(),g("div",Lz," No people match your search. ")):D("",!0)]))],512),[[sa,f.value==="assignments"]])],32)]),_:1},8,["show","title","is-dirty"]),Ee(kc,{show:i.value,title:"Validation error",message:l.value,onClose:M[5]||(M[5]=R=>i.value=!1)},null,8,["show","message"])],64))}},Tz=Ze($z,[["__scopeId","data-v-191faf4f"]]),Mz={key:0,class:"fullscreen-map-overlay"},Az={class:"fullscreen-map-header"},Ez={class:"context-info"},Pz={key:0},Dz={class:"action-buttons"},Rz=["disabled"],Oz={class:"fullscreen-map-container"},Bz={key:0,class:"drawing-controls"},Nz={class:"point-count"},Fz={class:"undo-redo-buttons"},Uz=["disabled"],zz=["disabled"],Hz=Object.assign({inheritAttrs:!1},{__name:"FullscreenMapOverlay",props:{show:{type:Boolean,required:!0},mode:{type:String,validator:e=>["place-checkpoint","move-checkpoint","draw-area","add-multiple","view"].includes(e)},contextTitle:{type:String,default:""},contextDescription:{type:String,default:""},canComplete:{type:Boolean,default:!1},drawingMode:{type:Boolean,default:!1}},emits:["done","cancel","map-click","polygon-complete","polygon-drawing","location-click","area-click"],setup(e,{emit:t}){const n=e,a=t,o=P(null),i=P(0),l=P(!1),c=P(!1),d=()=>{a("done")},h=()=>{a("cancel")},f=x=>{i.value=x?.length||0,m(),a("polygon-drawing",x)},m=()=>{o.value&&(l.value=o.value.canUndo(),c.value=o.value.canRedo())},y=()=>{o.value&&(o.value.undoPolygonPoint(),m())},k=()=>{o.value&&(o.value.redoPolygonPoint(),m())};Ye(()=>n.show,x=>{x||(i.value=0,l.value=!1,c.value=!1)});const S=x=>{x.key==="Escape"&&n.show&&h(),n.show&&n.drawingMode&&((x.ctrlKey||x.metaKey)&&x.key==="z"&&!x.shiftKey?(x.preventDefault(),y()):(x.ctrlKey||x.metaKey)&&(x.key==="y"||x.key==="z"&&x.shiftKey)&&(x.preventDefault(),k()))};return rn(()=>{document.addEventListener("keydown",S)}),An(()=>{document.removeEventListener("keydown",S)}),(x,E)=>(p(),ze(Xr,{to:"body"},[e.show?(p(),g("div",Mz,[r("div",Az,[r("div",Ez,[r("h3",null,b(e.contextTitle),1),e.contextDescription?(p(),g("p",Pz,b(e.contextDescription),1)):D("",!0)]),r("div",Dz,[e.mode==="view"?(p(),g("button",{key:0,onClick:h,class:"btn btn-done"}," Close ")):(p(),g(xe,{key:1},[r("button",{onClick:h,class:"btn btn-cancel"}," Cancel "),r("button",{onClick:d,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,Rz)],64))])]),r("div",Oz,[Ee(Yh,Fg({ref_key:"mapViewRef",ref:o,"drawing-mode":e.drawingMode},x.$attrs,{onMapClick:E[0]||(E[0]=$=>x.$emit("map-click",$)),onPolygonComplete:E[1]||(E[1]=$=>x.$emit("polygon-complete",$)),onPolygonDrawing:f,onLocationClick:E[2]||(E[2]=$=>x.$emit("location-click",$)),onAreaClick:E[3]||(E[3]=$=>x.$emit("area-click",$))}),null,16,["drawing-mode"]),e.drawingMode&&i.value>0?(p(),g("div",Bz,[r("div",Nz,b(i.value)+" point"+b(i.value!==1?"s":""),1),r("div",Fz,[r("button",{onClick:y,class:"btn-drawing undo-btn",disabled:!l.value,title:"Undo last point"},"  Undo ",8,Uz),r("button",{onClick:k,class:"btn-drawing redo-btn",disabled:!c.value,title:"Redo point"}," Redo  ",8,zz)])])):D("",!0)])])):D("",!0)]))}}),Vz=Ze(Hz,[["__scopeId","data-v-9ce62b55"]]),Gz={class:"form-group"},qz={class:"form-group"},jz={class:"form-group"},Wz={key:0,class:"form-error"},Zz={class:"form-row"},Kz={class:"form-group",style:{flex:"1"}},Yz={class:"form-group",style:{flex:"1"}},Jz={class:"form-group",style:{flex:"0 0 auto"}},Xz={class:"form-group"},Qz={__name:"AddLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:()=>({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""})},isDirty:{type:Boolean,default:!1}},emits:["close","save","set-on-map","update:isDirty","update:location"],setup(e,{emit:t}){const{termsLower:n}=ht(),a=e,o=t,i=P({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""});Ye(()=>a.location,h=>{h&&(i.value={...h})},{immediate:!0,deep:!0});const l=()=>{o("update:isDirty",!0),o("update:location",{...i.value})},c=()=>{if(!bu(i.value.what3Words)&&i.value.what3Words){alert("Invalid What3Words format.");return}o("save",i.value)},d=()=>{o("close")};return(h,f)=>(p(),ze(jt,{show:e.show,title:`Add ${N(n).checkpoint}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:Ue(()=>[r("button",{type:"button",onClick:d,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:c,class:"btn btn-primary"}," Add "+b(N(n).checkpoint),1)]),default:Ue(()=>[r("form",{onSubmit:ct(c,["prevent"])},[r("div",Gz,[f[7]||(f[7]=r("label",null,"Name",-1)),Ge(r("input",{"onUpdate:modelValue":f[0]||(f[0]=m=>i.value.name=m),type:"text",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.name]])]),r("div",qz,[f[8]||(f[8]=r("label",null,"Description",-1)),Ge(r("input",{"onUpdate:modelValue":f[1]||(f[1]=m=>i.value.description=m),type:"text",class:"form-input",onInput:l},null,544),[[st,i.value.description]])]),r("div",jz,[f[9]||(f[9]=r("label",null,"What3Words (optional)",-1)),Ge(r("input",{"onUpdate:modelValue":f[2]||(f[2]=m=>i.value.what3Words=m),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap",onInput:l},null,544),[[st,i.value.what3Words]]),i.value.what3Words&&!N(bu)(i.value.what3Words)?(p(),g("small",Wz," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):D("",!0)]),r("div",Zz,[r("div",Kz,[f[10]||(f[10]=r("label",null,"Longitude",-1)),Ge(r("input",{"onUpdate:modelValue":f[3]||(f[3]=m=>i.value.longitude=m),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.longitude,void 0,{number:!0}]])]),r("div",Yz,[f[11]||(f[11]=r("label",null,"Latitude",-1)),Ge(r("input",{"onUpdate:modelValue":f[4]||(f[4]=m=>i.value.latitude=m),type:"number",step:"0.00001",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.latitude,void 0,{number:!0}]])]),r("div",Jz,[f[12]||(f[12]=r("label",null,"",-1)),r("button",{type:"button",class:"icon-btn",title:"Set location on map",onClick:f[5]||(f[5]=m=>h.$emit("set-on-map"))},"  ")])]),r("div",Xz,[r("label",null,"Required "+b(N(n).people),1),Ge(r("input",{"onUpdate:modelValue":f[6]||(f[6]=m=>i.value.requiredMarshals=m),type:"number",min:"1",required:"",class:"form-input",onInput:l},null,544),[[st,i.value.requiredMarshals,void 0,{number:!0}]])])],32)]),_:1},8,["show","title","is-dirty"]))}},eH=Ze(Qz,[["__scopeId","data-v-fb51fed0"]]),tH=["aria-expanded","title"],nH=["innerHTML"],oH={key:0,class:"dropdown-menu"},aH=["onClick"],sH=["innerHTML"],iH={__name:"ThemeToggle",setup(e){const{theme:t,isDark:n,setTheme:a}=Wy(),o=P(!1),i=P(null),l={light:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
  </svg>`,dark:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
  </svg>`,system:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
    <line x1="8" y1="21" x2="16" y2="21"></line>
    <line x1="12" y1="17" x2="12" y2="21"></line>
  </svg>`},c=[{value:"system",label:"System",icon:l.system},{value:"light",label:"Light",icon:l.light},{value:"dark",label:"Dark",icon:l.dark}],d=z(()=>n.value?l.dark:l.light),h=()=>{o.value=!o.value},f=y=>{a(y),o.value=!1},m=y=>{i.value&&!i.value.contains(y.target)&&(o.value=!1)};return rn(()=>{document.addEventListener("click",m)}),An(()=>{document.removeEventListener("click",m)}),(y,k)=>(p(),g("div",{class:"theme-dropdown",ref_key:"dropdownRef",ref:i},[r("button",{class:"theme-toggle-btn",onClick:h,type:"button","aria-expanded":o.value,title:N(n)?"Dark mode":"Light mode"},[r("span",{class:"theme-icon",innerHTML:d.value},null,8,nH)],8,tH),o.value?(p(),g("div",oH,[(p(),g(xe,null,qe(c,S=>r("button",{key:S.value,class:le(["dropdown-item",{active:N(t)===S.value}]),onClick:x=>f(S.value)},[r("span",{class:"option-icon",innerHTML:S.icon},null,8,sH),r("span",null,b(S.label),1)],10,aH)),64))])):D("",!0)],512))}},lH=Ze(iH,[["__scopeId","data-v-969124a4"]]),rH={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"app-logo"},cH=["id"],uH=["filter"],dH={__name:"AppLogo",props:{size:{type:[Number,String],default:48},animate:{type:Boolean,default:!1}},setup(e){N0(n=>({v1c2199cd:typeof e.size=="number"?e.size+"px":e.size}));const t=z(()=>`discShadow-${Math.random().toString(36).substr(2,9)}`);return(n,a)=>(p(),g("svg",rH,[r("defs",null,[r("filter",{id:t.value,x:"-20%",y:"-20%",width:"140%",height:"140%"},[...a[0]||(a[0]=[r("feDropShadow",{dx:"0",dy:"6",stdDeviation:"8","flood-color":"#000","flood-opacity":"0.25"},null,-1)])],8,cH)]),r("ellipse",{cx:"256",cy:"400",rx:"220",ry:"70",fill:"#667eea",filter:`url(#${t.value})`},null,8,uH),a[2]||(a[2]=r("ellipse",{cx:"256",cy:"394",rx:"185",ry:"55",fill:"none",stroke:"rgba(255,255,255,0.3)","stroke-width":"4"},null,-1)),r("g",{class:le({"marshal-figure":e.animate})},[...a[1]||(a[1]=[r("circle",{cx:"256",cy:"160",r:"55",fill:"currentColor"},null,-1),r("path",{d:"M365 380 v-30 a55 55 0 0 0-55-55 H202 a55 55 0 0 0-55 55 v30",fill:"currentColor"},null,-1)])],2)]))}},hH=Ze(dH,[["__scopeId","data-v-3e647831"]]),fH={class:"header"},pH={class:"header-left"},vH={key:0},mH={class:"event-date"},gH={class:"header-actions"},yH={class:"container"},kH={class:"tabs-nav"},bH={class:"tab-content-wrapper"},_H={class:"add-note-form"},wH={class:"modal-footer-actions"},CH=["disabled"],LH=6e4,SH={__name:"AdminEventManage",setup(e){const t=Zu(),n=sr(),a=Vy(),o=z(()=>t.params.eventId),{activeTab:i,switchTab:l}=Gy("details",["details","course","areas","checkpoints","marshals","notes","checklists","contacts","roles","settings"]),{showConfirmModal:c,confirmModalTitle:d,confirmModalMessage:h,confirmModalIsDanger:f,confirmModalConfirmText:m,showConfirm:y,handleConfirmModalConfirm:k,handleConfirmModalCancel:S}=s2(),{tabLabels:x,terms:E,termsLower:$}=ht(),w=i2(),_=r2(o),I=l2(o),{colorScheme:T}=Wy(),B=z(()=>[{value:"details",label:"Event details",icon:"details"},{value:"course",label:x.value.course,icon:"course"},{value:"areas",label:x.value.areas,icon:"area"},{value:"checkpoints",label:x.value.checkpoints,icon:"checkpoint"},{value:"marshals",label:x.value.marshals,icon:"marshal"},{value:"notes",label:"Notes",icon:"notes"},{value:"incidents",label:"Incidents",icon:"incidents"},{value:"checklists",label:x.value.checklists,icon:"checklist"},{value:"contacts",label:"Contacts",icon:"contacts"},{value:"roles",label:"Roles",icon:"roles"},{value:"settings",label:"Settings",icon:"settings"}]),M=P(null),R=P([]),A=P([]),G=P({marshals:0,areas:0,checkpoints:0,checklists:0,notes:0,incidents:0,contacts:0,roles:0}),F=P(null),j=P(!1),K=P(!1),J=P(null),ue=P(null),Z=P(!1),se=P(!1),U=P(null),Q=P(""),oe=I.eventAdmins,he=I.showAddAdmin,Te=_.showUploadRoute,je=_.uploading,He=_.uploadError,We=_.showImportLocations,be=_.showImportMarshals,V=_.importing,Y=_.importingMarshals,re=_.importError,ie=_.importResult,$e=_.importMarshalsResult,q=P(!1),X=P(!1),ee=P({id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Ce=P(!1),Ne=P(!1),Be=P({marshalName:"",locations:[],marshal:null}),Ae=P(null),ne=P([]),ye=P(!1),De=P(null),Pe=P(null),Ie=P(null),me=P({}),Ke=P({id:"",name:"",email:"",phoneNumber:"",notes:""}),Ve=P(!1),de=P([]),ke=P([]),te=P([]),ge=P([]),Fe=P(!1),ut=P(""),gt=P(""),xt=P({name:"",description:"",eventDate:"",timeZoneId:"UTC",peopleTerm:"Marshals",defaultCheckpointStyleBackgroundShape:"",defaultCheckpointStyleBackgroundColor:"",defaultCheckpointStyleBorderColor:"",defaultCheckpointStyleIconColor:"",defaultCheckpointStyleSize:"",defaultCheckpointStyleMapRotation:"",checkpointTerm:"Checkpoints",areaTerm:"Areas",checklistTerm:"Checklists",courseTerm:"Course",defaultCheckpointStyleType:"default",defaultCheckpointStyleColor:""}),Ct=P(!1),Pt=P(!1),Wt=P(""),_o=P(""),cn=P(0),ft=P({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Dt=P([]),$t=P(null),In=P(!1),En=P("details"),wo=P(null),Ao=P(null),en=P(null),Ma=w.isAddingMultipleCheckpoints,On=w.multiCheckpointCounter,Go=w.isFullscreenMapActive,pe=w.fullscreenMode,ve=w.fullscreenContext,Le=w.tempLocationCoords,lt=w.tempCheckpoints,Qe=w.savedMapCenter,Rt=w.savedMapZoom,tn=w.isDrawingAreaBoundary,an=P(null),Bn=P([]),ao=P(null),Ja=P(!1),qo=P("details"),yi=P(null),yl=P(null),ki=P(!1),jo=P([]),ia=P(null),la=P(!1),bi=P("details"),Nn=P([]),Xa=P(!1),xn=P(null),Aa=P(!1),Ps=P(!1),_i=P(!1),so=P(""),Eo=P(!1),Co=P([]),Qa=P({builtInRoles:[],customRoles:[]}),_n=P(null),_t=P(!1),Mt=P([]),Fn=P(null),io=P(!1),Un=P("details"),Lo=P([]),yt=P(!1),Ft=P("details"),Po=P(null),lo=P(""),fn=P(null),es=P(null),Do=z(()=>es.value?.marshalId!=null),qn=()=>{n.push(`/event/${t.params.eventId}`)},on=z(()=>`${window.location.origin}/#/event/${t.params.eventId}`),Wo=z(()=>{const H=[];return A.value.forEach(ae=>{ae.assignments&&H.push(...ae.assignments)}),H}),ts=z(()=>{if(!De.value)return A.value;const H=De.value.assignedLocationIds||[],ae=te.value.map(_e=>_e.locationId),fe=ge.value;return A.value.filter(_e=>!H.includes(_e.id)&&!ae.includes(_e.id)||fe.includes(_e.id))}),Ea=z(()=>{let H=ne.value;if(F.value){const ae=F.value.assignments.map(_e=>_e.marshalName),fe=de.value.map(_e=>_e.marshalName);H=ne.value.filter(_e=>!ae.includes(_e.name)&&!fe.includes(_e.name))}return H.slice().sort((ae,fe)=>ae.name.localeCompare(fe.name))}),Ds=z(()=>pe.value==="draw-area"&&$t.value?.polygon?.length>0||w.canCompleteFullscreen.value),ns=z(()=>pe.value==="move-checkpoint"&&F.value?.id?F.value.id:null),Pa=z(()=>{const H=[...A.value];return pe.value==="place-checkpoint"&&Le.value&&H.push({id:"temp-single",name:ft.value.name||"New Checkpoint",latitude:Le.value.lat,longitude:Le.value.lng,requiredMarshals:ft.value.requiredMarshals||1,assignments:[],isTemporary:!0}),pe.value==="move-checkpoint"&&Le.value&&F.value&&H.push({id:"temp-move",name:F.value.name+" (new position)",latitude:Le.value.lat,longitude:Le.value.lng,requiredMarshals:F.value.requiredMarshals,assignments:[],isTemporary:!0}),pe.value==="add-multiple"&&H.push(...lt.value),H}),Rs=z(()=>{let H=[...Dt.value];return pe.value==="draw-area"&&$t.value?.id&&(H=H.filter(ae=>ae.id!==$t.value.id)),pe.value==="draw-area"&&$t.value?.polygon?.length>0&&H.push({...$t.value,id:$t.value.id||"temp-area"}),H}),Da=z(()=>{if(!De.value||!Nn.value.length)return[];const H=De.value.id,ae=De.value.assignedLocationIds||[];return Nn.value.filter(fe=>{if(fe.reportedBy?.marshalId===H)return!0;const _e=fe.context?.checkpoint?.checkpointId;return!!(_e&&ae.includes(_e))}).sort((fe,_e)=>new Date(_e.incidentTime||_e.createdAt)-new Date(fe.incidentTime||fe.createdAt))}),Os=z(()=>{if(!F.value||!Nn.value.length)return[];const H=F.value.id;return Nn.value.filter(ae=>ae.context?.checkpoint?.checkpointId===H).sort((ae,fe)=>new Date(fe.incidentTime||fe.createdAt)-new Date(ae.incidentTime||ae.createdAt))}),wi=z(()=>{if(!$t.value||!Nn.value.length)return[];const H=$t.value.id,ae=A.value.filter(fe=>fe.areaIds&&fe.areaIds.includes(H)).map(fe=>fe.id);return Nn.value.filter(fe=>{const _e=fe.context?.checkpoint?.checkpointId;return _e&&ae.includes(_e)}).sort((fe,_e)=>new Date(_e.incidentTime||_e.createdAt)-new Date(fe.incidentTime||fe.createdAt))}),Bs=H=>{xn.value=H,Aa.value=!0},kl=H=>{xn.value=H,Aa.value=!0},Ci=H=>{xn.value=H,Aa.value=!0},Li=()=>{n.push("/sessions")},rt=(H=!0)=>{Ve.value=H},pn=()=>{Ct.value=!0},Ut=async H=>{try{H&&(xt.value={...H});const ae=ic(M.value.eventDate),fe=xt.value.eventDate;if(ae!==fe){const _e=R.value.filter(at=>at.startTime||at.endTime);if(_e.length>0){Wt.value=ae,_o.value=fe,cn.value=_e.length,Pt.value=!0;return}}await os(!1,null)}catch(ae){console.error("Failed to update event:",ae),alert("Failed to update event. Please try again.")}},os=async(H,ae)=>{try{if(await a.updateEvent(t.params.eventId,{...xt.value,defaultCheckpointStyleMapRotation:xt.value.defaultCheckpointStyleMapRotation!=null?String(xt.value.defaultCheckpointStyleMapRotation):null}),H&&ae!==null){const fe=Math.floor(Math.abs(ae)/1e3),_e=ae<0,at=Math.floor(fe/3600),Tt=Math.floor(fe%3600/60),zt=fe%60,$n=`${_e?"-":""}${at.toString().padStart(2,"0")}:${Tt.toString().padStart(2,"0")}:${zt.toString().padStart(2,"0")}`;await a.bulkUpdateLocationTimes(t.params.eventId,$n)}await sn(),Ct.value=!1}catch(fe){console.error("Failed to update event:",fe),alert("Failed to update event. Please try again.")}},Si=async({shouldShift:H,timeDelta:ae})=>{Pt.value=!1,await os(H,ae)},Ii=()=>{Pt.value=!1,sn()},sn=async()=>{try{await a.fetchEvent(t.params.eventId),M.value=a.currentEvent,M.value&&(xt.value={name:M.value.name||"",description:M.value.description||"",eventDate:ic(M.value.eventDate),timeZoneId:M.value.timeZoneId||"UTC",peopleTerm:M.value.peopleTerm||"Marshals",checkpointTerm:M.value.checkpointTerm||"Checkpoints",areaTerm:M.value.areaTerm||"Areas",checklistTerm:M.value.checklistTerm||"Checklists",courseTerm:M.value.courseTerm||"Course",defaultCheckpointStyleType:M.value.defaultCheckpointStyleType||"default",defaultCheckpointStyleColor:M.value.defaultCheckpointStyleColor||"",defaultCheckpointStyleBackgroundShape:M.value.defaultCheckpointStyleBackgroundShape||"",defaultCheckpointStyleBackgroundColor:M.value.defaultCheckpointStyleBackgroundColor||"",defaultCheckpointStyleBorderColor:M.value.defaultCheckpointStyleBorderColor||"",defaultCheckpointStyleIconColor:M.value.defaultCheckpointStyleIconColor||"",defaultCheckpointStyleSize:M.value.defaultCheckpointStyleSize||"",defaultCheckpointStyleMapRotation:M.value.defaultCheckpointStyleMapRotation??"",brandingHeaderGradientStart:M.value.brandingHeaderGradientStart||"",brandingHeaderGradientEnd:M.value.brandingHeaderGradientEnd||"",brandingLogoUrl:M.value.brandingLogoUrl||"",brandingLogoPosition:M.value.brandingLogoPosition||"",brandingAccentColor:M.value.brandingAccentColor||"",brandingPageGradientStart:M.value.brandingPageGradientStart||"",brandingPageGradientEnd:M.value.brandingPageGradientEnd||""},Ct.value=!1,Wh(M.value));const H=await Promise.allSettled([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId),Wn(),vn(),ra(),Ro(),ro(),Ra(),Oa()]);R.value=a.locations,A.value=a.eventStatus.locations,H.forEach((ae,fe)=>{ae.status==="rejected"&&console.error(`Failed to load ${["locations","eventStatus","admins","marshals","areas","checklists","notes","contacts"][fe]}:`,ae.reason)})}catch(H){console.error("Failed to load event data:",H)}},vn=async()=>{try{const H=await ka.getByEvent(t.params.eventId);ne.value=H.data,G.value.marshals=Date.now()}catch(H){console.error("Failed to load marshals:",H)}},ra=async()=>{try{const H=await bs.getByEvent(t.params.eventId);Dt.value=H.data,G.value.areas=Date.now()}catch(H){console.error("Failed to load areas:",H)}},Ro=async()=>{try{const[H,ae]=await Promise.all([Nt.getByEvent(t.params.eventId),Nt.getReport(t.params.eventId)]);Bn.value=H.data,yi.value=ae.data,G.value.checklists=Date.now()}catch(H){console.error("Failed to load checklists:",H)}},Zt=async()=>{try{ki.value=!0;const H=await Nt.getDetailedReport(t.params.eventId);yl.value=H.data}catch(H){console.error("Failed to load detailed report:",H)}finally{ki.value=!1}},ro=async()=>{try{const H=await ma.getByEvent(t.params.eventId);jo.value=H.data,G.value.notes=Date.now()}catch(H){console.error("Failed to load notes:",H)}},Ra=async()=>{Xa.value=!0;try{const H=await Wa.getAll(t.params.eventId);Nn.value=H.data.incidents||[],G.value.incidents=Date.now()}catch(H){console.error("Failed to load incidents:",H)}finally{Xa.value=!1}},Oa=async()=>{try{const[H,ae]=await Promise.all([ps.getByEvent(t.params.eventId),ps.getRoles(t.params.eventId)]);Co.value=H.data,Qa.value=ae.data,G.value.contacts=Date.now()}catch(H){console.error("Failed to load contacts:",H)}},bl=async()=>{await Promise.all([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId)]),R.value=a.locations,G.value.checkpoints=Date.now(),A.value=a.eventStatus.locations},xi=async()=>{await Promise.all([vn(),a.fetchEventStatus(t.params.eventId)]),A.value=a.eventStatus.locations},Ns=async()=>{await Promise.all([a.fetchLocations(t.params.eventId),a.fetchEventStatus(t.params.eventId),ra()]),R.value=a.locations,A.value=a.eventStatus.locations},cr=async()=>{await a.fetchEventStatus(t.params.eventId),A.value=a.eventStatus.locations},Fs=()=>{$t.value=null,En.value="details",Ve.value=!1,In.value=!0},Lt=H=>{$t.value=H,Ao.value=H.id,En.value="details",Ve.value=!1,In.value=!0},ur=async H=>{try{let ae;if($t.value&&$t.value.id){if(ae=$t.value.id,await bs.update(t.params.eventId,ae,H),H.checklistChanges&&H.checklistChanges.length>0)for(const fe of H.checklistChanges)try{fe.complete?await Nt.complete(t.params.eventId,fe.itemId,{marshalId:fe.marshalId,contextType:fe.contextType,contextId:fe.contextId}):await Nt.uncomplete(t.params.eventId,fe.itemId,{marshalId:fe.marshalId,contextType:fe.contextType,contextId:fe.contextId})}catch(_e){console.error("Failed to update checklist item:",fe,_e)}}else ae=(await bs.create({eventId:t.params.eventId,...H})).data.id;if(H.pendingContacts&&H.pendingContacts.length>0&&ae)for(const fe of H.pendingContacts)try{const _e=fe.scopeConfigurations?JSON.parse(JSON.stringify(fe.scopeConfigurations)):[],at=_e.find(Tt=>Tt.scope==="EveryoneInAreas"&&Tt.itemType==="Area");at?(at.ids||(at.ids=[]),at.ids.includes(ae)||at.ids.push(ae)):_e.push({scope:"EveryoneInAreas",itemType:"Area",ids:[ae]}),await ps.update(t.params.eventId,fe.contactId,{...fe,scopeConfigurations:_e})}catch(_e){console.error("Failed to add area to contact:",fe,_e)}if(H.contactsToRemove&&H.contactsToRemove.length>0&&ae)for(const fe of H.contactsToRemove)try{const _e=Co.value.find(zt=>zt.contactId===fe);if(!_e)continue;const at=_e.scopeConfigurations?JSON.parse(JSON.stringify(_e.scopeConfigurations)):[],Tt=at.find(zt=>zt.scope==="EveryoneInAreas"&&zt.itemType==="Area");if(Tt&&Tt.ids){Tt.ids=Tt.ids.filter($n=>$n!==ae);const zt=Tt.ids.length>0?at:at.filter($n=>!($n.scope==="EveryoneInAreas"&&$n.itemType==="Area"));await ps.update(t.params.eventId,fe,{..._e,scopeConfigurations:zt})}}catch(_e){console.error("Failed to remove area from contact:",fe,_e)}if((H.pendingContacts&&H.pendingContacts.length>0||H.contactsToRemove&&H.contactsToRemove.length>0)&&await Oa(),H.pendingNewChecklistItems&&H.pendingNewChecklistItems.length>0&&ae){for(const fe of H.pendingNewChecklistItems)if(fe.text?.trim())try{await Nt.create(t.params.eventId,{text:fe.text,scopeConfigurations:[{scope:"EveryoneInAreas",itemType:"Area",ids:[ae]}],displayOrder:0,isRequired:!1})}catch(_e){console.error("Failed to create checklist item:",fe,_e)}await Ro()}if(H.pendingNewNotes&&H.pendingNewNotes.length>0&&ae){for(const fe of H.pendingNewNotes)if(!(!fe.title?.trim()&&!fe.content?.trim()))try{await ma.create(t.params.eventId,{title:fe.title||"Untitled",content:fe.content||"",scopeConfigurations:[{scope:"EveryoneInAreas",itemType:"Area",ids:[ae]}],displayOrder:0,priority:"Normal",isPinned:!1})}catch(_e){console.error("Failed to create note:",fe,_e)}await ro()}await ra(),await sn(),uo()}catch(ae){console.error("Failed to save area:",ae),alert(ae.response?.data?.message||"Failed to save area. Please try again.")}},co=async H=>{y(`Delete ${$.value.area}`,`Are you sure you want to delete this ${$.value.area}? ${E.value.checkpoints} will be automatically reassigned.`,async()=>{try{await bs.delete(t.params.eventId,H),await bs.recalculate(t.params.eventId),await ra(),await sn(),uo()}catch(ae){console.error(`Failed to delete ${$.value.area}:`,ae),alert(ae.response?.data?.message||`Failed to delete ${$.value.area}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},uo=()=>{In.value=!1,$t.value=null,Ao.value=null,Ve.value=!1,tn.value=!1,en.value=null},Us=({marshal:H,area:ae})=>{_n.value=null,Ft.value="details",Ve.value=!1,Po.value=ae,lo.value="",fn.value=H.id,_t.value=!0},dr=({name:H,area:ae})=>{_n.value=null,Ft.value="details",Ve.value=!1,Po.value=ae,lo.value=H,fn.value=null,_t.value=!0},$i=H=>{_n.value=H,Ft.value="details",Ve.value=!1,_t.value=!0},as=()=>{ao.value=null,qo.value="details",Ve.value=!1,Ja.value=!0},zs=(H,ae="details")=>{ao.value=H,qo.value=ae,Ve.value=!1,Ja.value=!0},Ba=async H=>{try{const ae={...H,scopeConfigurations:Fd(H.scopeConfigurations,{areas:Dt.value,locations:A.value,marshals:ne.value})};if(ao.value&&ao.value.itemId)await Nt.update(t.params.eventId,ao.value.itemId,ae);else{const fe=await Nt.create(t.params.eventId,ae);fe.data.count&&fe.data.count>1&&(ut.value="Checklist Items Created",gt.value=`Successfully created ${fe.data.count} checklist items.`,Fe.value=!0)}await Ro(),Na()}catch(ae){console.error("Failed to save checklist item:",ae);const fe=ae.response?.data?.message||"Failed to save checklist item. Please try again.";alert(fe)}},Ti=async H=>{y(`Delete ${$.value.checklist}`,`Are you sure you want to delete this ${$.value.checklist}?`,async()=>{try{await Nt.delete(t.params.eventId,H),await Ro(),Na()}catch(ae){console.error(`Failed to delete ${$.value.checklist}:`,ae),alert(ae.response?.data?.message||`Failed to delete ${$.value.checklist}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},Na=()=>{Ja.value=!1,ao.value=null,Ve.value=!1},_l=async H=>{const ae=[...Bn.value];H.forEach(fe=>{const _e=Bn.value.find(at=>at.itemId===fe.id);_e&&(_e.displayOrder=fe.displayOrder)});try{await Nt.reorder(t.params.eventId,H)}catch(fe){Bn.value=ae,console.error("Failed to reorder checklist items:",fe),alert("Failed to save order. Changes have been reverted.")}},ho=()=>{ia.value=null,bi.value="details",Ve.value=!1,la.value=!0},hr=H=>{ia.value=H,bi.value="details",Ve.value=!1,la.value=!0},wl=async H=>{try{const ae={...H,scopeConfigurations:Fd(H.scopeConfigurations,{areas:Dt.value,locations:A.value,marshals:ne.value})};ia.value&&ia.value.noteId?await ma.update(t.params.eventId,ia.value.noteId,ae):await ma.create(t.params.eventId,ae),await ro(),Hs()}catch(ae){console.error("Failed to save note:",ae);const fe=ae.response?.data?.message||"Failed to save note. Please try again.";alert(fe)}},Oo=async H=>{y("Delete note","Are you sure you want to delete this note?",async()=>{try{await ma.delete(t.params.eventId,H),await ro(),Hs()}catch(ae){console.error("Failed to delete note:",ae),alert(ae.response?.data?.message||"Failed to delete note. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Hs=()=>{la.value=!1,ia.value=null,Ve.value=!1},ss=async H=>{const ae=[...jo.value];H.forEach(fe=>{const _e=jo.value.find(at=>at.noteId===fe.id);_e&&(_e.displayOrder=fe.displayOrder)});try{await ma.reorder(t.params.eventId,H)}catch(fe){jo.value=ae,console.error("Failed to reorder notes:",fe),alert("Failed to save order. Changes have been reverted.")}},is=async H=>{const ae=[...Bn.value];H.forEach(fe=>{const _e=Bn.value.find(at=>at.itemId===fe.id);_e&&(_e.displayOrder=fe.displayOrder)});try{await Nt.reorder(t.params.eventId,H)}catch(fe){Bn.value=ae,console.error("Failed to reorder checklists:",fe),alert("Failed to save order. Changes have been reverted.")}},fr=()=>{Ps.value=!0},Mi=async H=>{try{await Wa.create(t.params.eventId,H),Ps.value=!1,await Ra()}catch(ae){console.error("Failed to report incident:",ae),alert(ae.response?.data?.message||"Failed to report incident. Please try again.")}},Ai=H=>{xn.value=H,Aa.value=!0},pr=()=>{Aa.value=!1,xn.value=null},Ei=async({incidentId:H,status:ae})=>{try{if(await Wa.updateStatus(t.params.eventId,H,{status:ae}),await Ra(),xn.value?.incidentId===H){const fe=Nn.value.find(_e=>_e.incidentId===H);fe&&(xn.value=fe)}}catch(fe){console.error("Failed to update incident status:",fe),alert(fe.response?.data?.message||"Failed to update status. Please try again.")}},Vs=()=>{so.value="",_i.value=!0},Pi=()=>{_i.value=!1,so.value=""},Cl=async()=>{if(!(!so.value.trim()||!xn.value)){Eo.value=!0;try{await Wa.addNote(t.params.eventId,xn.value.incidentId,so.value.trim()),Pi(),await Ra();const H=Nn.value.find(ae=>ae.incidentId===xn.value.incidentId);H&&(xn.value=H)}catch(H){console.error("Failed to add note to incident:",H),alert(H.response?.data?.message||"Failed to add note. Please try again.")}finally{Eo.value=!1}}},Ll=()=>{_n.value=null,Ft.value="details",Po.value=null,Ve.value=!1,_t.value=!0},ls=H=>{_n.value=H,Ft.value="details",Ve.value=!1,_t.value=!0},Zo=async H=>{try{const ae={...H,scopeConfigurations:Fd(H.scopeConfigurations,{areas:Dt.value,locations:A.value,marshals:ne.value})};let fe=null;const _e=!_n.value||!_n.value.contactId,at=!!Po.value;if(_n.value&&_n.value.contactId)await ps.update(t.params.eventId,_n.value.contactId,ae);else{const Tt=await ps.create(t.params.eventId,ae);fe=Tt.data?.contactId||Tt.data?.id}if(await Oa(),_e&&at&&fe&&wo.value){const Tt=Co.value.find(zt=>zt.contactId===fe);Tt&&wo.value.addPendingContact(Tt)}ca()}catch(ae){console.error("Failed to save contact:",ae);const fe=ae.response?.data?.message||"Failed to save contact. Please try again.";alert(fe)}},Sl=async H=>{y("Delete contact","Are you sure you want to delete this contact?",async()=>{try{await ps.delete(t.params.eventId,H),await Oa(),wo.value&&wo.value.removeContactById(H),ca()}catch(ae){console.error("Failed to delete contact:",ae),alert(ae.response?.data?.message||"Failed to delete contact. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},ca=()=>{_t.value=!1,_n.value=null,Po.value=null,lo.value="",fn.value=null,Ve.value=!1},we=async H=>{const ae=[...Co.value];H.forEach(fe=>{const _e=Co.value.find(at=>at.contactId===fe.id);_e&&(_e.displayOrder=fe.displayOrder)});try{await ps.reorder(t.params.eventId,H)}catch(fe){Co.value=ae,console.error("Failed to reorder contacts:",fe),alert("Failed to save order. Changes have been reverted.")}},Se=async()=>{try{const H=await qi.getAll(t.params.eventId);Mt.value=H.data,G.value.roles=Date.now()}catch(H){console.error("Failed to load role definitions:",H)}},ot=()=>{Fn.value=null,Un.value="details",Lo.value=[],Ve.value=!1,io.value=!0},kt=H=>{Fn.value=H,Un.value="details",Lo.value=[],Ve.value=!1,io.value=!0},Jt=async H=>{try{Fn.value?.roleId?await qi.update(t.params.eventId,Fn.value.roleId,H):await qi.create(t.params.eventId,H),await Se(),jn()}catch(ae){console.error("Failed to save role:",ae);const fe=ae.response?.data?.message||"Failed to save role. Please try again.";alert(fe)}},kn=async H=>{y("Delete role","Are you sure you want to delete this role?",async()=>{try{await qi.delete(t.params.eventId,H),await Se(),jn()}catch(ae){console.error("Failed to delete role:",ae),alert(ae.response?.data?.message||"Failed to delete role. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},jn=()=>{io.value=!1,Fn.value=null,Lo.value=[],Ve.value=!1},zn=async H=>{yt.value=!0;try{const ae=await qi.getPeople(t.params.eventId,H);Lo.value=ae.data}catch(ae){console.error("Failed to load people for role:",ae)}finally{yt.value=!1}},Vt=async({person:H,addRole:ae})=>{if(!Fn.value?.roleId)return;const fe=Fn.value.roleId,_e={marshalIdsToAdd:[],marshalIdsToRemove:[],contactIdsToAdd:[],contactIdsToRemove:[]};H.personType==="Marshal"||H.personType==="Linked"?ae?_e.marshalIdsToAdd.push(H.marshalId):_e.marshalIdsToRemove.push(H.marshalId):H.personType==="Contact"&&(ae?_e.contactIdsToAdd.push(H.contactId):_e.contactIdsToRemove.push(H.contactId));try{const at=await qi.updatePeople(t.params.eventId,fe,_e);Lo.value=at.data,await Se()}catch(at){console.error("Failed to update role assignment:",at),alert("Failed to update role assignment. Please try again.")}},wn=async H=>{const ae=[...Mt.value];H.forEach(fe=>{const _e=Mt.value.find(at=>at.roleId===fe.id);_e&&(_e.displayOrder=fe.displayOrder)});try{await qi.reorder(t.params.eventId,H)}catch(fe){Mt.value=ae,console.error("Failed to reorder roles:",fe),alert("Failed to save order. Changes have been reverted.")}},wt=H=>{en.value={...H,id:$t.value?.id};const ae={...H,id:$t.value?.id,polygon:[]};$t.value=ae;let fe=!1;if(H.polygon&&H.polygon.length>0){const _e=H.polygon.map(Xo=>Xo.lat||Xo[0]),at=H.polygon.map(Xo=>Xo.lng||Xo[1]),Tt=Math.min(..._e),zt=Math.max(..._e),$n=Math.min(...at),Zs=Math.max(...at);Qe.value={lat:(Tt+zt)/2,lng:($n+Zs)/2};const Al=zt-Tt,El=Zs-$n,us=Math.max(Al,El);Rt.value=us<.005?17:us<.01?16:us<.02?15:us<.05?14:13,fe=!0}if(!fe&&H.checkpointIds&&H.checkpointIds.length>0){const _e=A.value.filter(at=>H.checkpointIds.includes(at.id));if(_e.length>0){const at=_e.map(zt=>zt.latitude).filter(Boolean),Tt=_e.map(zt=>zt.longitude).filter(Boolean);if(at.length>0&&Tt.length>0){const zt=Math.min(...at),$n=Math.max(...at),Zs=Math.min(...Tt),Al=Math.max(...Tt);Qe.value={lat:(zt+$n)/2,lng:(Zs+Al)/2};const El=$n-zt,us=Al-Zs,Xo=Math.max(El,us);Rt.value=Xo<.005?16:Xo<.01?15:Xo<.02?14:Xo<.05?13:12,fe=!0}}}if(!fe&&J.value){const _e=J.value.getMapCenter(),at=J.value.getMapZoom();_e&&at!==null&&(Qe.value=_e,Rt.value=at)}Go.value=!0,pe.value="draw-area",tn.value=!0,ve.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},Xt=H=>{en.value?$t.value={...$t.value||{},...en.value,polygon:H}:$t.value={...$t.value,polygon:H}},So=H=>{w.handlePolygonDrawing(H)},Pn=()=>{tn.value=!1,en.value&&($t.value=en.value,In.value=!0,en.value=null)},Wn=()=>I.loadEventAdmins(),Ko=async H=>{try{await I.addAdmin(H),await Wn(),Fa()}catch(ae){console.error("Failed to add admin:",ae),alert(ae.response?.data?.message||"Failed to add administrator. Please try again.")}},Di=async H=>{y("Remove administrator",`Remove ${H} as an administrator?`,async()=>{try{await I.removeAdmin(H),await Wn()}catch(ae){console.error("Failed to remove admin:",ae),alert(ae.response?.data?.message||"Failed to remove administrator. Please try again.")}},{isDanger:!0,confirmText:"Remove"})},Fa=()=>{I.closeAddAdminModal(),Ve.value=!1},bc=async H=>{await _.uploadRoute(H)&&(await bl(),Ri())},Ri=()=>{_.closeUploadRouteModal()},od=async({file:H,deleteExisting:ae})=>{const fe=await _.importLocations(H,ae);if(fe){await Ns(),ua();const _e=_.formatImportResultMessage(fe,"location");ut.value="Import Complete",gt.value=_e,Fe.value=!0}},ua=()=>{_.closeImportLocationsModal()},Il=async H=>{if(K.value)ft.value.latitude=H.lat,ft.value.longitude=H.lng;else if(X.value)ee.value.latitude=H.lat,ee.value.longitude=H.lng,F.value&&(F.value={...F.value,latitude:H.lat,longitude:H.lng}),X.value=!1,q.value=!0,rt();else if(Ma.value)try{await a.createLocation({eventId:t.params.eventId,name:`Checkpoint ${On.value}`,description:"",latitude:H.lat,longitude:H.lng,requiredMarshals:1,what3Words:""}),On.value++,await sn()}catch(ae){console.error("Failed to create checkpoint:",ae),alert("Failed to create checkpoint. Please try again.")}},ad=H=>{w.handleFullscreenMapClick(H)},vr=H=>{ft.value={...H}},sd=()=>{K.value=!1,w.enterPlaceCheckpointMode()},da=()=>{w.saveMapState(J.value),ft.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},w.enterPlaceCheckpointMode()},id=()=>{w.saveMapState(J.value),Go.value=!0,pe.value="view",ve.value={title:"Course map",description:""}},Gs=()=>{w.saveMapState(J.value),$t.value={id:null,name:"",description:"",color:"#667eea",polygon:[],checkpointIds:[],marshalIds:[],displayOrder:Dt.value.length},w.enterDrawAreaMode()},ld=()=>{F.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},ee.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},de.value=[],ke.value=[],Ve.value=!1,q.value=!0},ha=()=>{const H=w.calculateStartingNumber(A);w.saveMapState(J.value),w.enterAddMultipleMode(H)},xl=()=>{if(pe.value==="place-checkpoint"){const H=w.getPlacedCoords()||{lat:0,lng:0};F.value={id:null,name:"",description:"",latitude:H.lat,longitude:H.lng,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},ee.value={id:null,name:"",description:"",latitude:H.lat,longitude:H.lng,requiredMarshals:1,what3Words:""},de.value=[],ke.value=[],Ve.value=!1,rs(),q.value=!0}else if(pe.value==="move-checkpoint"){const H=w.getPlacedCoords();H&&(ee.value.latitude=H.lat,ee.value.longitude=H.lng,F.value&&(F.value={...F.value,...an.value||{},latitude:H.lat,longitude:H.lng}),rt()),an.value=null,rs(),q.value=!0}else if(pe.value==="draw-area"){const H=w.getCompletedPolygon();H&&(en.value?$t.value={...$t.value||{},...en.value,polygon:H}:$t.value={...$t.value||{},polygon:H}),en.value=null,rs()}else pe.value==="add-multiple"&&_c()},_c=async()=>{const H=w.getTempCheckpoints();try{for(const ae of H)await a.createLocation({eventId:t.params.eventId,name:ae.name,description:ae.description,latitude:ae.latitude,longitude:ae.longitude,requiredMarshals:ae.requiredMarshals,what3Words:ae.what3Words});w.clearTempCheckpoints(),rs(),await sn()}catch(ae){console.error("Failed to create checkpoints:",ae),alert("Failed to create checkpoints. Please try again.")}},mr=()=>{pe.value==="draw-area"?en.value&&($t.value=en.value,en.value=null):pe.value==="move-checkpoint"&&(an.value&&F.value&&Object.assign(F.value,an.value),q.value=!0,X.value=!1),w.cancelFullscreen()},rs=()=>{w.exitFullscreen()},gr=H=>{cs(H)},cs=H=>{F.value=H,ee.value={id:H.id,name:H.name,description:H.description||"",latitude:H.latitude,longitude:H.longitude,requiredMarshals:H.requiredMarshals,what3Words:H.what3Words||""},de.value=[],ke.value=[],Ve.value=!1,q.value=!0,setTimeout(()=>{J.value?.scrollMapIntoView()},100)},qs=async H=>{if(!bu(H.what3Words)){alert("Invalid What3Words format. Please use word.word.word or word/word/word (lowercase letters only, 1-20 characters each)");return}try{await a.createLocation({eventId:t.params.eventId,...H}),await sn(),Oi()}catch(ae){console.error("Failed to save location:",ae),alert("Failed to save location. Please try again.")}},Oi=()=>{K.value=!1,ft.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},Ve.value=!1,Ve.value=!1},Bi=()=>{q.value=!1,F.value=null,j.value=!1,X.value=!1,Ce.value=!1,an.value=null,ee.value={id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},de.value=[],ke.value=[],Ve.value=!1},$l=()=>{Ce.value=!1},rd=()=>{Ce.value=!0},Tl=H=>{H?.formData&&(an.value=H.formData),q.value=!1,Le.value=null;const ae=an.value?.latitude??F.value?.latitude,fe=an.value?.longitude??F.value?.longitude;if(ae&&fe)Qe.value={lat:ae,lng:fe},Rt.value=16;else if(J.value){const at=J.value.getMapCenter(),Tt=J.value.getMapZoom();at&&Tt!==null&&(Qe.value=at,Rt.value=Tt)}const _e=an.value?.name||F.value?.name;Go.value=!0,pe.value="move-checkpoint",ve.value={title:`Move ${$.value.checkpoint}: ${_e}`,description:"Click on the map to set the new location"}},cd=async H=>{if(!bu(H.what3Words)){alert("Invalid What3Words format.");return}try{const ae=!F.value.id;if(ae){const fe=await a.createLocation({eventId:t.params.eventId,name:H.name,description:H.description,latitude:H.latitude,longitude:H.longitude,requiredMarshals:H.requiredMarshals,what3Words:H.what3Words||null,startTime:H.startTime,endTime:H.endTime,styleType:H.styleType,styleColor:H.styleColor,styleBackgroundShape:H.styleBackgroundShape,styleBackgroundColor:H.styleBackgroundColor,styleBorderColor:H.styleBorderColor,styleIconColor:H.styleIconColor,styleSize:H.styleSize,styleMapRotation:H.styleMapRotation!=null?String(H.styleMapRotation):null,peopleTerm:H.peopleTerm,checkpointTerm:H.checkpointTerm,isDynamic:H.isDynamic||!1,locationUpdateScopeConfigurations:H.locationUpdateScopeConfigurations||[],pendingNewChecklistItems:H.pendingNewChecklistItems||[],pendingNewNotes:H.pendingNewNotes||[]});if(H.pendingAssignments&&H.pendingAssignments.length>0)for(const _e of H.pendingAssignments)await a.createAssignment({eventId:t.params.eventId,locationId:fe.id,marshalId:_e.marshalId})}else{const fe=F.value.id;if(await Xn.update(t.params.eventId,fe,{eventId:t.params.eventId,name:H.name,description:H.description,latitude:H.latitude,longitude:H.longitude,requiredMarshals:H.requiredMarshals,what3Words:H.what3Words||null,startTime:H.startTime,endTime:H.endTime,styleType:H.styleType,styleColor:H.styleColor,styleBackgroundShape:H.styleBackgroundShape,styleBackgroundColor:H.styleBackgroundColor,styleBorderColor:H.styleBorderColor,styleIconColor:H.styleIconColor,styleSize:H.styleSize,styleMapRotation:H.styleMapRotation!=null?String(H.styleMapRotation):null,peopleTerm:H.peopleTerm,checkpointTerm:H.checkpointTerm,isDynamic:H.isDynamic||!1,locationUpdateScopeConfigurations:H.locationUpdateScopeConfigurations||[]}),H.pendingNewChecklistItems&&H.pendingNewChecklistItems.length>0)for(const _e of H.pendingNewChecklistItems)_e.text?.trim()&&await Nt.create(t.params.eventId,{text:_e.text,scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[fe]}],displayOrder:0,isRequired:!1});if(H.pendingNewNotes&&H.pendingNewNotes.length>0)for(const _e of H.pendingNewNotes)!_e.title?.trim()&&!_e.content?.trim()||await ma.create(t.params.eventId,{title:_e.title||"Untitled",content:_e.content||"",scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[fe]}],displayOrder:0,priority:"Normal",isPinned:!1});for(const _e of ke.value)await a.deleteAssignment(t.params.eventId,_e);if(H.assignmentsToRemove&&H.assignmentsToRemove.length>0)for(const _e of H.assignmentsToRemove)await a.deleteAssignment(t.params.eventId,_e);for(const _e of de.value)await a.createAssignment({eventId:t.params.eventId,locationId:F.value.id,marshalId:_e.marshalId});if(H.checkInChanges&&H.checkInChanges.length>0)for(const _e of H.checkInChanges){const at=F.value.assignments.find(Tt=>Tt.id===_e.assignmentId);at&&at.isCheckedIn!==_e.shouldBeCheckedIn&&await di.adminCheckIn(t.params.eventId,_e.assignmentId)}}if(!ae&&H.checklistChanges&&H.checklistChanges.length>0)for(const fe of H.checklistChanges)try{fe.complete?await Nt.complete(t.params.eventId,fe.itemId,{marshalId:fe.marshalId,contextType:fe.contextType,contextId:fe.contextId}):await Nt.uncomplete(t.params.eventId,fe.itemId,{marshalId:fe.marshalId,contextType:fe.contextType,contextId:fe.contextId})}catch(_e){console.error("Failed to update checklist item:",fe,_e)}await sn(),Bi()}catch(ae){console.error("Failed to update location:",ae),alert("Failed to update location. Please try again.")}},wc=async H=>{y(`Delete ${$.value.checkpoint}`,`Are you sure you want to delete this ${$.value.checkpoint}?`,async()=>{try{await Xn.delete(t.params.eventId,H),await Ns(),Bi()}catch(ae){console.error(`Failed to delete ${$.value.checkpoint}:`,ae),alert(`Failed to delete ${$.value.checkpoint}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},ud=async H=>{try{if(ue.value&&ue.value.setCheckingIn(H.id),await di.adminCheckIn(t.params.eventId,H.id),await cr(),F.value){const ae=A.value.find(fe=>fe.id===F.value.id);ae&&(F.value=ae)}}catch(ae){console.error("Failed to toggle check-in:",ae),alert("Failed to toggle check-in. Please try again.")}finally{ue.value&&ue.value.setCheckingIn(null)}},Cc=H=>{const ae=H?.id??H;if(ae?.toString().startsWith("temp-")){const fe=F.value.assignments.find(_e=>_e.id===ae);fe&&(de.value=de.value.filter(_e=>_e.marshalId!==fe.marshalId)),F.value.assignments=F.value.assignments.filter(_e=>_e.id!==ae),rt()}else ke.value.includes(ae)||(ke.value.push(ae),F.value.assignments=F.value.assignments.filter(fe=>fe.id!==ae),rt())},dd=async H=>{const ae=ne.value.find(_e=>_e.id===H);if(!ae)return;const fe=A.value.filter(_e=>_e.assignments?.some(at=>at.marshalId===H&&_e.id!==F.value.id));if(fe.length>0){Be.value={marshalName:ae.name,locations:fe.map(at=>at.name),marshal:ae};const _e=await new Promise(at=>{Ae.value=at,Ne.value=!0});if(_e==="cancel"||_e==="choose-other")return;if(_e==="move")for(const at of fe){const Tt=at.assignments.find(zt=>zt.marshalId===H);if(Tt){ke.value.push(Tt.id);const zt=A.value.findIndex($n=>$n.id===at.id);zt!==-1&&(A.value[zt].assignments=A.value[zt].assignments.filter($n=>$n.id!==Tt.id))}}}de.value.push({marshalId:ae.id,marshalName:ae.name}),F.value.assignments||(F.value.assignments=[]),F.value.assignments.push({id:`temp-${Date.now()}`,marshalId:ae.id,marshalName:ae.name,locationId:F.value.id,isCheckedIn:!1,isPending:!0}),rt(),$l()},Yo=async H=>{try{const fe=(await ka.create({eventId:t.params.eventId,name:H.name,email:H.email,phoneNumber:H.phoneNumber})).data;await vn(),de.value.push({marshalId:fe.id,marshalName:fe.name}),F.value&&(F.value.assignments||(F.value.assignments=[]),F.value.assignments.push({id:`temp-${Date.now()}`,marshalId:fe.id,marshalName:fe.name,locationId:F.value.id,isCheckedIn:!1,isPending:!0})),rt(),$l()}catch(ae){console.error("Failed to create marshal:",ae),alert("Failed to create marshal. Please try again.")}},Ml=()=>{De.value=null,me.value={},Ke.value={id:"",name:"",email:"",phoneNumber:"",notes:""},te.value=[],ge.value=[],Ve.value=!1,ye.value=!0},hd=H=>{De.value=H,me.value={},Ke.value={id:H.id,name:H.name,email:H.email||"",phoneNumber:H.phoneNumber||"",notes:H.notes||""},te.value=[],ge.value=[],Ve.value=!1,ye.value=!0},Ni=z(()=>{if(!De.value)return[];const H=[];return A.value.forEach(ae=>{ae.assignments.filter(_e=>_e.marshalName===De.value.name&&!ge.value.includes(_e.id)).forEach(_e=>{H.push({..._e,locationName:ae.name,locationDescription:ae.description||""})})}),te.value.forEach((ae,fe)=>{const _e=A.value.find(at=>at.id===ae.locationId);_e&&H.push({id:`pending-${fe}`,locationId:ae.locationId,locationName:_e.name,locationDescription:_e.description||"",marshalId:De.value.id,marshalName:De.value.name,isCheckedIn:!1,isPending:!0})}),H}),fd=async H=>{try{let ae=De.value?.id,fe=!1;if(De.value){if(await ka.update(t.params.eventId,De.value.id,{name:H.name,email:H.email,phoneNumber:H.phoneNumber,notes:H.notes,roles:H.roles||[]}),H.pendingNewChecklistItems&&H.pendingNewChecklistItems.length>0)for(const _e of H.pendingNewChecklistItems)_e.text?.trim()&&await Nt.create(t.params.eventId,{text:_e.text,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[ae]}],displayOrder:0,isRequired:!1});if(H.pendingNewNotes&&H.pendingNewNotes.length>0)for(const _e of H.pendingNewNotes)!_e.title?.trim()&&!_e.content?.trim()||await ma.create(t.params.eventId,{title:_e.title||"Untitled",content:_e.content||"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[ae]}],displayOrder:0,priority:"Normal",isPinned:!1})}else ae=(await ka.create({eventId:t.params.eventId,name:H.name,email:H.email,phoneNumber:H.phoneNumber,notes:H.notes,roles:H.roles||[],pendingNewChecklistItems:H.pendingNewChecklistItems||[],pendingNewNotes:H.pendingNewNotes||[]})).data.id,fe=!0;for(const _e of ge.value)await a.deleteAssignment(t.params.eventId,_e);if(H.assignmentsToRemove&&H.assignmentsToRemove.length>0)for(const _e of H.assignmentsToRemove)await a.deleteAssignment(t.params.eventId,_e);for(const _e of te.value)await a.createAssignment({eventId:t.params.eventId,locationId:_e.locationId,marshalId:ae});if(H.pendingAssignments&&H.pendingAssignments.length>0)for(const _e of H.pendingAssignments)await a.createAssignment({eventId:t.params.eventId,locationId:_e.locationId,marshalId:ae});if(H.checkInChanges&&H.checkInChanges.length>0){const _e=Ni.value;for(const at of H.checkInChanges){const Tt=_e.find(zt=>zt.id===at.assignmentId);Tt&&Tt.isCheckedIn!==at.shouldBeCheckedIn&&await di.adminCheckIn(t.params.eventId,at.assignmentId)}}if(H.checklistChanges&&H.checklistChanges.length>0)for(const _e of H.checklistChanges)try{const at={marshalId:ae};_e.contextType&&_e.contextId&&(at.contextType=_e.contextType,at.contextId=_e.contextId),_e.complete?await Nt.complete(t.params.eventId,_e.itemId,at):await Nt.uncomplete(t.params.eventId,_e.itemId,at)}catch(at){console.error("Failed to process checklist change:",at);const Tt=at.response?.data?.message||"Failed to update checklist item";alert(`Error: ${Tt}`)}if(await sn(),F.value){const _e=A.value.find(at=>at.id===F.value.id);_e&&(F.value=_e)}Ua(),fe&&(U.value=ae,Q.value=H.name,se.value=!0)}catch(ae){console.error("Failed to save marshal:",ae);const fe=ae.response?.data?.message||"Failed to save marshal. Please try again.";if(ae.response?.status===400){const _e=fe.toLowerCase();_e.includes("name")?(me.value={name:fe},Ie.value&&(Ie.value.switchToTab("details"),Ie.value.focusField("name"))):_e.includes("email")?(me.value={email:fe},Ie.value&&(Ie.value.switchToTab("details"),Ie.value.focusField("email"))):(me.value={general:fe},Ie.value&&Ie.value.switchToTab("details"))}else me.value={general:fe},Ie.value&&Ie.value.switchToTab("details")}},yr=async H=>{const ae=H||De.value?.id;if(!ae){console.error("No marshal ID to delete");return}const fe=$.value.person;y(`Delete ${fe}`,`Are you sure you want to delete this ${fe}?`,async()=>{try{await ka.delete(t.params.eventId,ae),await xi(),Ua()}catch(_e){console.error(`Failed to delete ${fe}:`,_e),alert(`Failed to delete ${fe}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},pd=H=>{yr(H.id)},Fi=H=>{const ae=H?.id??H;if(ae?.toString().startsWith("pending-")){const fe=H?.locationId;fe&&(te.value=te.value.filter(_e=>_e.locationId!==fe)),rt()}else ge.value.includes(ae)||(ge.value.push(ae),rt())},vd=H=>{te.value.push({locationId:H}),rt()},Ua=()=>{ye.value=!1,De.value=null,Pe.value=null,me.value={},Ke.value={id:"",name:"",email:"",phoneNumber:"",notes:""},te.value=[],ge.value=[],Ve.value=!1},Lc=async H=>{const ae=ne.value.find(fe=>fe.id===H.marshalId);if(!ae){console.error("Marshal not found:",H.marshalId);return}Pe.value=F.value?.id||null,Ve.value=!1,De.value=ae,ye.value=!0},Sc=H=>{const ae=A.value.find(fe=>fe.id===H.locationId);if(!ae){console.error("Location not found:",H.locationId);return}j.value=!0,Ve.value=!1,F.value=ae,q.value=!0},md=async({file:H})=>{const ae=await _.importMarshals(H);if(ae){await xi(),Jo();const fe=_.formatImportResultMessage(ae,"marshal");ut.value="Import Complete",gt.value=fe,Fe.value=!0}},Jo=()=>{_.closeImportMarshalsModal()},Ic=H=>{Ae.value&&(Ae.value(H),Ae.value=null),Ne.value=!1};let js=null;const Ws=async()=>{try{const H=t.params.eventId,ae=await Xn.getDynamicCheckpoints(H);if(ae.data&&Array.isArray(ae.data))for(const fe of ae.data){const _e=A.value.find(at=>at.id===fe.checkpointId);_e&&(_e.latitude=fe.latitude,_e.longitude=fe.longitude,_e.lastLocationUpdate=fe.lastLocationUpdate)}}catch(H){console.warn("Failed to poll dynamic checkpoints:",H)}},xc=()=>{js||!A.value.some(ae=>ae.isDynamic||ae.IsDynamic)||(Ws(),js=setInterval(Ws,6e4))},Ui=()=>{js&&(clearInterval(js),js=null)};return Ye(i,H=>{H==="course"?xc():Ui();const ae=Date.now(),fe=_e=>ae-G.value[_e]>LH;switch(H){case"marshals":fe("marshals")&&vn();break;case"areas":fe("areas")&&ra(),fe("roles")&&Se();break;case"checkpoints":fe("checkpoints")&&bl();break;case"checklists":fe("checklists")&&Ro();break;case"notes":fe("notes")&&ro();break;case"incidents":fe("incidents")&&Ra();break;case"contacts":fe("contacts")&&Oa(),fe("roles")&&Se();break;case"roles":fe("roles")&&Se();break}}),rn(async()=>{await sn();try{const H=await Za.getMe(t.params.eventId);es.value=H.data}catch(H){console.warn("Failed to fetch user claims:",H)}i.value==="course"&&xc()}),Ye(M,H=>{H&&(document.title="OnTheDay App - Admin")},{immediate:!0}),An(()=>{Ui()}),(H,ae)=>(p(),g("div",{class:"admin-event-manage",style:nt({colorScheme:N(T)})},[r("header",fH,[r("div",pH,[r("button",{onClick:Li,class:"btn-back",title:"Back to sessions"},[Ee(hH,{size:48,animate:""})]),M.value?(p(),g("div",vH,[r("h1",null,b(M.value.name),1),r("p",mH,b(N(Zy)(M.value.eventDate)),1)])):D("",!0)]),r("div",gH,[Do.value?(p(),g("button",{key:0,onClick:qn,class:"btn btn-marshal-mode"}," Switch to Marshal ")):D("",!0)]),Ee(lH,{class:"theme-toggle-fixed"})]),r("div",yH,[r("div",kH,[Ee(S3,{tabs:B.value,"model-value":N(i),"onUpdate:modelValue":N(l)},null,8,["tabs","model-value","onUpdate:modelValue"])]),r("div",bH,[N(i)==="course"?(p(),ze(LL,{key:0,ref_key:"courseAreasTab",ref:J,checkpoints:A.value,areas:Dt.value,route:M.value?.route||[],"selected-area-id":Ao.value,"drawing-mode":N(tn),onMapClick:Il,onLocationClick:gr,onAreaClick:Lt,onImportCheckpoints:ae[0]||(ae[0]=fe=>We.value=!0),onUploadRoute:ae[1]||(ae[1]=fe=>Te.value=!0),onSelectLocation:cs,onAddArea:Fs,onSelectArea:Lt,onPolygonComplete:Xt,onCancelDrawing:Pn,onAddCheckpointFromMap:da,onAddManyCheckpointsFromMap:ha,onAddAreaFromMap:Gs,onFullscreen:id},null,8,["checkpoints","areas","route","selected-area-id","drawing-mode"])):D("",!0),N(i)==="checkpoints"?(p(),ze(K4,{key:1,locations:A.value,areas:Dt.value,onAddCheckpointManually:ld,onImportCheckpoints:ae[2]||(ae[2]=fe=>We.value=!0),onSelectLocation:cs},null,8,["locations","areas"])):D("",!0),N(i)==="areas"?(p(),ze(v3,{key:2,areas:Dt.value,checkpoints:A.value,contacts:Co.value,"event-people-term":M.value?.peopleTerm||"Marshals","event-checkpoint-term":M.value?.checkpointTerm||"Checkpoints",onAddArea:Fs,onSelectArea:Lt},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term"])):D("",!0),N(i)==="marshals"?(p(),ze(IS,{key:3,ref_key:"marshalsTabRef",ref:ue,marshals:ne.value,assignments:Wo.value,locations:A.value,onAddMarshal:Ml,onImportMarshals:ae[3]||(ae[3]=fe=>be.value=!0),onSelectMarshal:hd,onDeleteMarshal:pd,onToggleCheckIn:ud},null,8,["marshals","assignments","locations"])):D("",!0),N(i)==="checklists"?(p(),ze(Fx,{key:4,"checklist-items":Bn.value,areas:Dt.value,locations:A.value,marshals:ne.value,"completion-report":yi.value,"detailed-report":yl.value,"is-loading-detailed-report":ki.value,onAddChecklistItem:as,onSelectChecklistItem:zs,onReorder:_l,onLoadDetailedReport:Zt},null,8,["checklist-items","areas","locations","marshals","completion-report","detailed-report","is-loading-detailed-report"])):D("",!0),N(i)==="notes"?(p(),ze(o$,{key:5,notes:jo.value,areas:Dt.value,locations:A.value,marshals:ne.value,onAddNote:ho,onSelectNote:hr,onReorder:ss},null,8,["notes","areas","locations","marshals"])):D("",!0),N(i)==="incidents"?(p(),ze(x4,{key:6,incidents:Nn.value,areas:Dt.value,loading:Xa.value,onSelectIncident:Ai,onReportIncident:fr},null,8,["incidents","areas","loading"])):D("",!0),N(i)==="contacts"?(p(),ze(S$,{key:7,contacts:Co.value,areas:Dt.value,locations:A.value,marshals:ne.value,"available-roles":Qa.value,"role-definitions":Mt.value,onAddContact:Ll,onSelectContact:ls,onReorder:we},null,8,["contacts","areas","locations","marshals","available-roles","role-definitions"])):D("",!0),N(i)==="roles"?(p(),ze(H$,{key:8,"role-definitions":Mt.value,onAddRole:ot,onSelectRole:kt,onReorder:wn},null,8,["role-definitions"])):D("",!0),N(i)==="details"?(p(),ze(eT,{key:9,"event-data":xt.value,"form-dirty":Ct.value,onSubmit:Ut,"onUpdate:formDirty":pn},null,8,["event-data","form-dirty"])):D("",!0),N(i)==="settings"?(p(),ze(o4,{key:10,"event-data":xt.value,"event-id":N(t).params.eventId,admins:N(oe),"form-dirty":Ct.value,onSubmit:Ut,onAddAdmin:ae[4]||(ae[4]=fe=>he.value=!0),onRemoveAdmin:Di,"onUpdate:formDirty":pn},null,8,["event-data","event-id","admins","form-dirty"])):D("",!0)])]),Ee(eH,{show:K.value,location:ft.value,"is-dirty":Ve.value,onClose:Oi,onSave:qs,onSetOnMap:sd,"onUpdate:isDirty":rt,"onUpdate:location":vr},null,8,["show","location","is-dirty"]),Ee(LR,{show:q.value,location:F.value,assignments:F.value?.assignments||[],"event-date":M.value?.eventDate||"",areas:Dt.value,"event-id":N(t).params.eventId,"all-locations":A.value,notes:jo.value,"available-marshals":Ea.value,"all-marshals":ne.value,"all-checklist-items":Bn.value,incidents:Os.value,"is-dirty":Ve.value,"event-default-style-type":M.value?.defaultCheckpointStyleType||M.value?.DefaultCheckpointStyleType||"default","event-default-style-color":M.value?.defaultCheckpointStyleColor||M.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":M.value?.defaultCheckpointStyleBackgroundShape||M.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":M.value?.defaultCheckpointStyleBackgroundColor||M.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":M.value?.defaultCheckpointStyleBorderColor||M.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":M.value?.defaultCheckpointStyleIconColor||M.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":M.value?.defaultCheckpointStyleSize||M.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":M.value?.defaultCheckpointStyleMapRotation??M.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":M.value?.peopleTerm||"Marshals","z-index":In.value?1200:j.value?1100:1e3,"locked-from-marshal":j.value,onClose:Bi,onSave:cd,onDelete:wc,onMoveLocation:Tl,onRemoveAssignment:Cc,onOpenAssignModal:rd,"onUpdate:isDirty":rt,onSelectIncident:kl,onSelectMarshal:Lc,onReorderNotes:ss,onReorderChecklists:is},null,8,["show","location","assignments","event-date","areas","event-id","all-locations","notes","available-marshals","all-marshals","all-checklist-items","incidents","is-dirty","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","z-index","locked-from-marshal"]),Ee(M3,{show:Z.value,link:on.value,"is-dirty":!1,onClose:ae[5]||(ae[5]=fe=>Z.value=!1)},null,8,["show","link"]),Ee(gP,{show:se.value,"event-id":N(t).params.eventId,"marshal-id":U.value,"marshal-name":Q.value,onClose:ae[6]||(ae[6]=fe=>se.value=!1)},null,8,["show","event-id","marshal-id","marshal-name"]),Ee(bP,{show:N(he),"is-dirty":Ve.value,onClose:Fa,onSubmit:Ko,"onUpdate:isDirty":rt},null,8,["show","is-dirty"]),Ee(SP,{show:N(Te),uploading:N(je),error:N(He),"is-dirty":Ve.value,onClose:Ri,onSubmit:bc,"onUpdate:isDirty":rt},null,8,["show","uploading","error","is-dirty"]),Ee(RP,{show:N(We),importing:N(V),error:N(re),result:N(ie),"is-dirty":Ve.value,onClose:ua,onSubmit:od,"onUpdate:isDirty":rt},null,8,["show","importing","error","result","is-dirty"]),Ee(DB,{ref_key:"editMarshalModalRef",ref:Ie,show:ye.value,marshal:De.value,"event-id":N(t).params.eventId,assignments:Ni.value,"available-locations":ts.value,"all-locations":A.value,areas:Dt.value,"is-editing":!!De.value,"event-notes":jo.value,"all-checklist-items":Bn.value,incidents:Da.value,"all-marshals":ne.value,"is-dirty":Ve.value,"validation-errors":me.value,"locked-checkpoint-id":Pe.value,"z-index":Pe.value?1100:1e3,"role-definitions":Mt.value,onClose:Ua,onSave:fd,onDelete:yr,onRemoveAssignment:Fi,onAssignToLocation:vd,"onUpdate:isDirty":rt,onSelectIncident:Bs,onSelectCheckpoint:Sc,onReorderNotes:ss,onReorderChecklists:is},null,8,["show","marshal","event-id","assignments","available-locations","all-locations","areas","is-editing","event-notes","all-checklist-items","incidents","all-marshals","is-dirty","validation-errors","locked-checkpoint-id","z-index","role-definitions"]),Ee(VP,{show:N(be),importing:N(Y),error:N(re),result:N($e),"is-dirty":Ve.value,onClose:Jo,onSubmit:md,"onUpdate:isDirty":rt},null,8,["show","importing","error","result","is-dirty"]),Ee(NB,{show:Ne.value,"conflict-data":Be.value,onClose:ae[7]||(ae[7]=fe=>Ne.value=!1),onChoice:Ic},null,8,["show","conflict-data"]),Ee(ZB,{show:Ce.value,"location-name":F.value?.name||"",marshals:Ea.value,onClose:$l,onAssignExisting:dd,onCreateAndAssign:Yo},null,8,["show","location-name","marshals"]),Ee(iN,{show:Pt.value,"old-event-date":Wt.value,"new-event-date":_o.value,"affected-checkpoints-count":cn.value,onConfirm:Si,onCancel:Ii},null,8,["show","old-event-date","new-event-date","affected-checkpoints-count"]),Ee(b9,{ref_key:"editAreaModalRef",ref:wo,show:In.value,area:$t.value,"initial-tab":En.value,checkpoints:A.value,marshals:ne.value,areas:Dt.value,route:M.value?.route||[],"is-dirty":Ve.value,"event-id":N(t).params.eventId,"all-locations":A.value,assignments:Wo.value,notes:jo.value,contacts:Co.value,incidents:wi.value,"role-definitions":Mt.value,"event-default-style-type":M.value?.defaultCheckpointStyleType||M.value?.DefaultCheckpointStyleType||"default","event-default-style-color":M.value?.defaultCheckpointStyleColor||M.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":M.value?.defaultCheckpointStyleBackgroundShape||M.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":M.value?.defaultCheckpointStyleBackgroundColor||M.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":M.value?.defaultCheckpointStyleBorderColor||M.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":M.value?.defaultCheckpointStyleIconColor||M.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":M.value?.defaultCheckpointStyleSize||M.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":M.value?.defaultCheckpointStyleMapRotation??M.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":M.value?.peopleTerm||"Marshals","event-checkpoint-term":M.value?.checkpointTerm||"Checkpoints",onClose:uo,onSave:ur,onDelete:co,onDrawBoundary:wt,"onUpdate:isDirty":rt,onSelectCheckpoint:cs,onCreateContactFromMarshal:Us,onCreateNewContact:dr,onEditContact:$i,onSelectIncident:Ci,onReorderNotes:ss,onReorderChecklists:is,onReorderContacts:we},null,8,["show","area","initial-tab","checkpoints","marshals","areas","route","is-dirty","event-id","all-locations","assignments","notes","contacts","incidents","role-definitions","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","event-checkpoint-term"]),Ee(B9,{show:Ja.value,"checklist-item":ao.value,"initial-tab":qo.value,areas:Dt.value,locations:A.value,marshals:ne.value,"is-dirty":Ve.value,onClose:Na,onSave:Ba,onDelete:Ti,"onUpdate:isDirty":rt},null,8,["show","checklist-item","initial-tab","areas","locations","marshals","is-dirty"]),Ee(Q9,{show:la.value,note:ia.value,"initial-tab":bi.value,areas:Dt.value,locations:A.value,marshals:ne.value,"is-dirty":Ve.value,onClose:Hs,onSave:wl,onDelete:Oo,"onUpdate:isDirty":rt},null,8,["show","note","initial-tab","areas","locations","marshals","is-dirty"]),Ee(_1,{show:Aa.value,incident:xn.value,route:M.value?.route||[],checkpoints:A.value,"can-manage":!0,onClose:pr,onStatusChange:Ei,onOpenAddNote:Vs},null,8,["show","incident","route","checkpoints"]),Ee(jt,{show:_i.value,title:"Add update",size:"small",onClose:Pi},{footer:Ue(()=>[r("div",wH,[r("button",{type:"button",class:"btn btn-secondary",onClick:Pi}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:Cl,disabled:!so.value.trim()||Eo.value},b(Eo.value?"Adding...":"Add update"),9,CH)])]),default:Ue(()=>[r("div",_H,[Ge(r("textarea",{"onUpdate:modelValue":ae[8]||(ae[8]=fe=>so.value=fe),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[st,so.value]])])]),_:1},8,["show"]),Ee(w1,{show:Ps.value,"event-id":N(t).params.eventId,checkpoint:null,"initial-location":null,checkpoints:A.value,route:M.value?.route||[],onClose:ae[9]||(ae[9]=fe=>Ps.value=!1),onSubmit:Mi},null,8,["show","event-id","checkpoints","route"]),Ee(lz,{show:_t.value,contact:_n.value,"initial-tab":Ft.value,areas:Dt.value,locations:A.value,marshals:ne.value,"available-roles":Qa.value,"role-definitions":Mt.value,"is-dirty":Ve.value,"prefilled-name":lo.value,"prefilled-marshal-id":fn.value,"create-from-area-context":!!Po.value,onClose:ca,onSave:Zo,onDelete:Sl,"onUpdate:isDirty":rt},null,8,["show","contact","initial-tab","areas","locations","marshals","available-roles","role-definitions","is-dirty","prefilled-name","prefilled-marshal-id","create-from-area-context"]),Ee(Tz,{show:io.value,role:Fn.value,"initial-tab":Un.value,people:Lo.value,"loading-people":yt.value,"is-dirty":Ve.value,onClose:jn,onSave:Jt,onDelete:kn,"onUpdate:isDirty":rt,onLoadPeople:zn,onTogglePersonRole:Vt},null,8,["show","role","initial-tab","people","loading-people","is-dirty"]),Ee(Vz,{show:N(Go),mode:N(pe),"context-title":N(ve).title,"context-description":N(ve).description,"can-complete":Ds.value,clickable:N(pe)!=="draw-area","drawing-mode":N(pe)==="draw-area"&&N(tn),locations:Pa.value,areas:Rs.value,route:M.value?.route||[],"selected-area-id":Ao.value,center:N(Qe),zoom:N(Rt),"highlight-location-id":ns.value,onMapClick:ad,onPolygonComplete:Xt,onPolygonDrawing:So,onDone:xl,onCancel:mr},null,8,["show","mode","context-title","context-description","can-complete","clickable","drawing-mode","locations","areas","route","selected-area-id","center","zoom","highlight-location-id"]),Ee(kc,{show:Fe.value,title:ut.value,message:gt.value,onClose:ae[10]||(ae[10]=fe=>Fe.value=!1)},null,8,["show","title","message"]),Ee(vi,{show:N(c),title:N(d),message:N(h),"is-danger":N(f),"confirm-text":N(m),onConfirm:N(k),onCancel:N(S)},null,8,["show","title","message","is-danger","confirm-text","onConfirm","onCancel"])],4))}},IH=Ze(SH,[["__scopeId","data-v-3eeda75d"]]),xH={key:0,class:"emergency-notes-section"},$H={class:"emergency-notes-list"},TH={class:"note-header"},MH={key:0,class:"note-content"},AH={key:1,class:"emergency-contacts-section"},EH={class:"emergency-contacts-list"},PH={class:"contact-header"},DH={key:0,class:"role-badge"},RH={class:"contact-details"},OH={key:0,class:"info-section"},BH=["href"],NH={key:1,class:"info-section"},FH=["href"],UH={key:2,class:"info-section"},zH=["href"],HH={key:2,class:"no-contacts"},VH={__name:"EmergencyContactModal",props:{show:{type:Boolean,default:!1},contacts:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const n=e,a=t,o=z(()=>n.notes?[...n.notes].filter(h=>h.showInEmergencyInfo||h.ShowInEmergencyInfo).sort((h,f)=>{const m=h.isPinned||h.IsPinned,y=f.isPinned||f.IsPinned;if(m!==y)return m?-1:1;const k=h.displayOrder||h.DisplayOrder||0,S=f.displayOrder||f.DisplayOrder||0;if(k!==S)return k-S;const x=h.priority||h.Priority,E=f.priority||f.Priority;return x==="Emergency"&&E!=="Emergency"?-1:E==="Emergency"&&x!=="Emergency"?1:0}):[]),i=z(()=>n.contacts?n.contacts.filter(h=>h.showInEmergencyInfo||h.ShowInEmergencyInfo).sort((h,f)=>{const m=h.isPinned||h.IsPinned,y=f.isPinned||f.IsPinned;if(m!==y)return m?-1:1;const k=h.displayOrder||h.DisplayOrder||0,S=f.displayOrder||f.DisplayOrder||0;if(k!==S)return k-S;const x=h.name||h.Name||"",E=f.name||f.Name||"";return x.localeCompare(E,void 0,{sensitivity:"base"})}):[]),l=()=>{a("close")},c=h=>h?{EmergencyContact:"Emergency Contact",EventDirector:"Event Director",MedicalLead:"Medical Lead",SafetyOfficer:"Safety Officer",Logistics:"Logistics"}[h]||h.replace(/([A-Z])/g," $1").trim():"",d=h=>h.roles&&Array.isArray(h.roles)&&h.roles.length>0?h.roles:h.role?[h.role]:[];return(h,f)=>(p(),ze(jt,{show:e.show,title:"Emergency information",size:"medium",onClose:l},{actions:Ue(()=>[r("button",{onClick:l,class:"btn btn-secondary"},"Close")]),default:Ue(()=>[o.value.length>0?(p(),g("div",xH,[f[0]||(f[0]=r("h2",{class:"section-header"},"Emergency notes",-1)),r("div",$H,[(p(!0),g(xe,null,qe(o.value,m=>(p(),g("div",{key:m.noteId||m.NoteId,class:le(["emergency-note-item",{"is-emergency":(m.priority||m.Priority)==="Emergency"}])},[r("div",TH,[r("h3",null,b(m.title||m.Title),1),r("span",{class:le(["priority-badge",(m.priority||m.Priority).toLowerCase()])},b(m.priority||m.Priority),3)]),m.content||m.Content?(p(),g("div",MH,b(m.content||m.Content),1)):D("",!0)],2))),128))])])):D("",!0),i.value&&i.value.length>0?(p(),g("div",AH,[f[4]||(f[4]=r("h2",{class:"section-header"},"Emergency contacts",-1)),r("div",EH,[(p(!0),g(xe,null,qe(i.value,m=>(p(),g("div",{key:m.contactId||m.name,class:"emergency-contact-item"},[r("div",PH,[r("h3",null,b(m.name),1),d(m).length>0?(p(),g("span",DH,b(d(m).map(c).join(", ")),1)):D("",!0)]),r("div",RH,[m.phone?(p(),g("div",OH,[f[1]||(f[1]=r("label",null,"Phone number",-1)),r("a",{href:`tel:${m.phone}`,class:"phone-link"},b(m.phone),9,BH)])):D("",!0),m.email?(p(),g("div",NH,[f[2]||(f[2]=r("label",null,"Email",-1)),r("a",{href:`mailto:${m.email}`,class:"email-link"},b(m.email),9,FH)])):D("",!0),m.notes||m.details?(p(),g("div",UH,[f[3]||(f[3]=r("label",null,"Details",-1)),r("p",null,b(m.notes||m.details),1)])):D("",!0)]),m.phone?(p(),g("a",{key:0,href:`tel:${m.phone}`,class:"btn btn-danger btn-full"}," Call "+b(m.name),9,zH)):D("",!0)]))),128))])])):D("",!0),i.value.length===0&&o.value.length===0?(p(),g("div",HH,[...f[5]||(f[5]=[r("p",null,"No emergency information has been set up for this event.",-1)])])):D("",!0)]),_:1},8,["show"]))}},GH=Ze(VH,[["__scopeId","data-v-6ae197f1"]]),Ar=P(navigator.onLine),Cs=P(!0),ri=P(0),Hc=P(null),el=P("idle"),Jl=P(null),of=P(!1);let vm=null,kh=!1,ga=null,mm=0;function qH(e=1e3,t=1e4){return Math.floor(Math.random()*(t-e+1))+e}function $u(){ga&&(clearTimeout(ga),ga=null);const e=qH(1e3,1e4);console.log(`Scheduling auto-sync in ${e}ms`),ga=setTimeout(async()=>{if(ga=null,!navigator.onLine){console.log("Auto-sync cancelled: offline");return}if(await yu()===0){console.log("Auto-sync cancelled: no pending actions");return}console.log("Starting auto-sync..."),await Tu();const n=await yu();n>0&&navigator.onLine&&(console.log(`${n} actions remaining, scheduling retry...`),$u())},e)}async function ql(){if(!navigator.onLine)return Cs.value=!1,!1;try{return await wC.check(),Cs.value=!0,!0}catch(e){return e.response?.status===404?(Cs.value=!0,!0):(e.code==="ECONNABORTED"&&console.warn("Server health check timed out"),Cs.value=!1,!1)}}async function zf(){const e=Date.now();if(e-mm<2e3)return;mm=e;const t=navigator.onLine;if(Ar.value=t,!t){Cs.value=!1;return}of.value=!0;try{await ql()&&ri.value>0&&$u()}finally{of.value=!1}}function gm(){document.visibilityState==="visible"&&(console.log("Page became visible, checking connectivity..."),zf())}function ym(){console.log("Window focused, checking connectivity..."),zf()}async function jH(e){try{switch(e.type){case"checkin":await di.checkIn(e.payload);break;case"checkin_toggle":await di.toggleCheckIn(e.payload.eventId,e.payload.assignmentId,e.payload.gpsData||{});break;case"checkin_admin":await di.adminCheckIn(e.payload.eventId,e.payload.assignmentId);break;case"checklist_complete":await Nt.complete(e.payload.eventId,e.payload.itemId,e.payload.data);break;case"checklist_uncomplete":await Nt.uncomplete(e.payload.eventId,e.payload.itemId,e.payload.data);break;default:return console.warn("Unknown action type:",e.type),!1}return!0}catch(t){if(console.error("Failed to sync action:",e,t),t.response&&t.response.status===400){const n=t.response.data?.message||t.response.data||"",a=typeof n=="string"?n.toLowerCase():"";if(a.includes("already checked in"))return console.log("Action already completed (already checked in), treating as success"),!0;if(a.includes("already completed")||a.includes("already uncompleted"))return console.log("Action already completed (checklist state), treating as success"),!0}return t.response&&t.response.status>=400&&t.response.status<500?"permanent_failure":!1}}async function Tu(){if(!kh&&navigator.onLine){kh=!0,el.value="syncing",Jl.value=null;try{const e=await Ny();if(e.length===0){el.value="success",ri.value=0;return}let t=0,n=0;for(const a of e){const o=await jH(a);if(o===!0)await bv(a.id),t++;else if(o==="permanent_failure")await bv(a.id),n++;else{const i=(a.attempts||0)+1;i>=5?(await kv(a.id,{status:"failed",attempts:i,lastAttempt:new Date().toISOString()}),n++):await kv(a.id,{status:"retrying",attempts:i,lastAttempt:new Date().toISOString()})}}ri.value=await yu(),n>0?(el.value="error",Jl.value=`${n} action(s) failed to sync`):el.value="success"}catch(e){console.error("Sync error:",e),el.value="error",Jl.value="Failed to sync pending actions"}finally{kh=!1}}}function WH(){vm||(vm=setInterval(async()=>{navigator.onLine&&(await ql(),Cs.value&&ri.value>0&&await Tu())},3e4))}function Hf(){const e=z(()=>Ar.value&&Cs.value);async function t(){ri.value=await yu()}async function n(){Ar.value=!0,await ql()&&ri.value>0&&$u()}function a(){Ar.value=!1,Cs.value=!1,ga&&(clearTimeout(ga),ga=null)}rn(async()=>{await As(),await t(),window.addEventListener("online",n),window.addEventListener("offline",a),document.addEventListener("visibilitychange",gm),window.addEventListener("focus",ym),navigator.onLine&&await ql()&&ri.value>0&&$u(),WH()}),An(()=>{window.removeEventListener("online",n),window.removeEventListener("offline",a),document.removeEventListener("visibilitychange",gm),window.removeEventListener("focus",ym),ga&&(clearTimeout(ga),ga=null)});async function o(d,h){if(!e.value)return console.warn("Cannot refresh cache while offline"),!1;try{const f=await h();return await sc(d,f),Hc.value=new Date().toISOString(),!0}catch(f){return console.error("Failed to refresh cache:",f),!1}}async function i(d){const h=await ui(d);return h&&(Hc.value=h.cachedAt),h}async function l(d){Hc.value=await pC(d)}async function c(){return navigator.onLine?await ql()?(await Tu(),el.value==="success"):(Jl.value="Server is not responding",!1):(Jl.value="Cannot sync while offline",!1)}return{isOnline:Ar,isServerHealthy:Cs,isFullyOnline:e,isCheckingStatus:of,pendingActionsCount:ri,lastSyncTime:Hc,syncStatus:el,syncError:Jl,checkServerHealth:ql,quickConnectivityCheck:zf,syncPendingActions:Tu,updatePendingCount:t,refreshCache:o,getCachedData:i,loadLastSyncTime:l,forcSync:c}}const ZH={class:"offline-indicator-container"},KH={class:"offline-icon"},YH={key:0,viewBox:"0 0 24 24",fill:"currentColor"},JH={key:1,class:"spinner",viewBox:"0 0 24 24",fill:"currentColor"},XH={class:"offline-text"},QH={key:0,class:"last-sync"},eV={class:"pending-text"},tV={key:0,class:"pending-subtext"},nV={key:1,class:"syncing-text"},oV={__name:"OfflineIndicator",setup(e){const{isOnline:t,isFullyOnline:n,isCheckingStatus:a,pendingActionsCount:o,lastSyncTime:i,syncStatus:l,syncError:c,forcSync:d}=Hf(),h=P(!1),f=P(""),m=P(""),y=z(()=>{if(!i.value)return"";const S=new Date(i.value),E=new Date-S,$=Math.floor(E/6e4),w=Math.floor($/60);return $<1?"just now":$<60?`${$}m ago`:w<24?`${w}h ago`:S.toLocaleDateString()}),k=async()=>{await d()};return Ye(l,S=>{S==="success"&&o.value===0?(f.value="All actions synced successfully!",m.value="success",h.value=!0,setTimeout(()=>{h.value=!1},3e3)):S==="error"&&(f.value=c.value||"Sync failed",m.value="error",h.value=!0,setTimeout(()=>{h.value=!1},5e3))}),(S,x)=>(p(),g("div",ZH,[Ee(Ca,{name:"slide"},{default:Ue(()=>[N(n)?D("",!0):(p(),g("div",{key:0,class:le(["offline-banner",{checking:N(a)}])},[r("span",KH,[N(a)?(p(),g("svg",JH,[...x[1]||(x[1]=[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8z"},null,-1)])])):(p(),g("svg",YH,[...x[0]||(x[0]=[r("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"},null,-1)])]))]),r("span",XH,b(N(a)?"Checking connection...":N(t)?"Server unavailable":"You're offline"),1),N(i)&&!N(a)?(p(),g("span",QH," Last synced: "+b(y.value),1)):D("",!0)],2))]),_:1}),Ee(Ca,{name:"fade"},{default:Ue(()=>[N(o)>0?(p(),g("div",{key:0,class:le(["pending-banner",{"offline-pending":!N(n)}])},[x[2]||(x[2]=r("span",{class:"pending-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})])],-1)),r("span",eV,[Je(b(N(o))+" pending action"+b(N(o)!==1?"s":"")+" ",1),N(n)?D("",!0):(p(),g("span",tV,"(will sync when online)"))]),N(n)&&N(l)!=="syncing"?(p(),g("button",{key:0,onClick:k,class:"sync-button"}," Sync Now ")):N(l)==="syncing"?(p(),g("span",nV,"Syncing...")):D("",!0)],2)):D("",!0)]),_:1}),Ee(Ca,{name:"fade"},{default:Ue(()=>[h.value?(p(),g("div",{key:0,class:le(["sync-toast",m.value])},b(f.value),3)):D("",!0)]),_:1})]))}},aV=Ze(oV,[["__scopeId","data-v-9c1e58f4"]]),sV={class:"modal-content check-in-reminder-modal"},iV={class:"modal-header warning"},lV={class:"modal-body"},rV={class:"reminder-message"},cV={key:0},uV={class:"reminder-hint"},dV={class:"modal-footer"},hV={__name:"CheckInReminderModal",props:{show:{type:Boolean,required:!0},checkpoint:{type:Object,default:null},accentButtonStyle:{type:Object,default:()=>({})}},emits:["dismiss","go-to-checkpoint"],setup(e){const{termsLower:t}=ht();return(n,a)=>(p(),ze(Ca,{name:"modal"},{default:Ue(()=>[e.show&&e.checkpoint?(p(),g("div",{key:0,class:"modal-overlay",onClick:a[3]||(a[3]=ct(o=>n.$emit("dismiss"),["self"]))},[r("div",sV,[r("div",iV,[a[4]||(a[4]=r("h3",null,"Check-in reminder",-1)),r("button",{class:"modal-close",onClick:a[0]||(a[0]=o=>n.$emit("dismiss"))},"")]),r("div",lV,[a[6]||(a[6]=r("div",{class:"reminder-icon"},"",-1)),r("p",rV,[Je(" You have not checked in yet to "+b(N(t).checkpoint)+" ",1),r("strong",null,b(e.checkpoint.location?.name),1),e.checkpoint.location?.description?(p(),g("span",cV," - "+b(e.checkpoint.location.description),1)):D("",!0),a[5]||(a[5]=Je(". ",-1))]),r("p",uV," Please check in when you arrive at your "+b(N(t).checkpoint)+". ",1)]),r("div",dV,[r("button",{onClick:a[1]||(a[1]=o=>n.$emit("dismiss")),class:"btn btn-secondary"}," Dismiss "),r("button",{onClick:a[2]||(a[2]=o=>n.$emit("go-to-checkpoint")),class:"btn btn-primary",style:nt(e.accentButtonStyle)}," Go to "+b(N(t).checkpoint),5)])])])):D("",!0)]),_:1}))}},fV=Ze(hV,[["__scopeId","data-v-4761fdb9"]]),pV={class:"modal-content location-update-modal"},vV={class:"modal-header"},mV={class:"modal-body"},gV={key:0,class:"success-message"},yV={key:1},kV={class:"modal-description"},bV={key:0,class:"last-update-info"},_V={key:1,class:"gps-status active"},wV={class:"update-option"},CV=["disabled"],LV={class:"update-option auto-update-option"},SV={class:"checkbox-label"},IV=["checked"],xV={class:"option-hint"},$V={class:"update-option"},TV=["disabled"],MV={class:"update-option"},AV={class:"option-label"},EV={key:0,class:"checkpoint-list"},PV=["onClick","disabled"],DV={class:"checkpoint-name"},RV={key:0,class:"checkpoint-description"},OV={key:1,class:"no-checkpoints"},BV={key:2,class:"error"},NV={class:"modal-footer"},FV={__name:"LocationUpdateModal",props:{show:{type:Boolean,required:!0},assignment:{type:Object,default:null},userLocation:{type:Object,default:null},autoUpdateEnabled:{type:Boolean,default:!1},updating:{type:Boolean,default:!1},error:{type:String,default:""},success:{type:String,default:""},availableCheckpoints:{type:Array,default:()=>[]},accentButtonStyle:{type:Object,default:()=>({})}},emits:["close","update-gps","toggle-auto-update","select-on-map","copy-from-checkpoint"],setup(e){const{termsLower:t}=ht(),n=o=>o?new Date(o).toLocaleString():"",a=(o,i=50)=>o?o.length<=i?o:o.substring(0,i).trim()+"...":"";return(o,i)=>(p(),ze(Ca,{name:"modal"},{default:Ue(()=>[e.show?(p(),g("div",{key:0,class:"modal-overlay",onClick:i[5]||(i[5]=ct(l=>o.$emit("close"),["self"]))},[r("div",pV,[r("div",vV,[r("h3",null,"Update "+b(N(t).checkpoint)+" location",1),r("button",{class:"modal-close",onClick:i[0]||(i[0]=l=>o.$emit("close"))},"")]),r("div",mV,[e.success?(p(),g("div",gV,b(e.success),1)):(p(),g("div",yV,[r("p",kV,[i[6]||(i[6]=Je(" Update the position of ",-1)),r("strong",null,b(e.assignment?.location?.name),1)]),e.assignment?.location?.lastLocationUpdate?(p(),g("div",bV," Last updated: "+b(n(e.assignment.location.lastLocationUpdate)),1)):D("",!0),e.userLocation?(p(),g("div",_V,[...i[7]||(i[7]=[r("svg",{class:"status-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),Je(" GPS active ",-1)])])):D("",!0),r("div",wV,[r("button",{onClick:i[1]||(i[1]=l=>o.$emit("update-gps")),class:"btn btn-primary btn-full",disabled:e.updating,style:nt(e.accentButtonStyle)},[i[8]||(i[8]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),Je(" "+b(e.updating?"Updating...":"Use current GPS location"),1)],12,CV)]),r("div",LV,[r("label",SV,[r("input",{type:"checkbox",checked:e.autoUpdateEnabled,onChange:i[2]||(i[2]=l=>o.$emit("toggle-auto-update"))},null,40,IV),i[9]||(i[9]=r("span",null,"Auto-update every 60 seconds",-1))]),r("p",xV,"Automatically updates the "+b(N(t).checkpoint)+" location using your GPS every minute.",1)]),r("div",$V,[r("button",{onClick:i[3]||(i[3]=l=>o.$emit("select-on-map")),class:"btn btn-secondary btn-full",disabled:e.updating},[...i[10]||(i[10]=[r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"})],-1),Je(" Select location on map ",-1)])],8,TV)]),r("div",MV,[r("label",AV,"Or copy location from another "+b(N(t).checkpoint)+":",1),e.availableCheckpoints.length>0?(p(),g("div",EV,[(p(!0),g(xe,null,qe(e.availableCheckpoints,l=>(p(),g("button",{key:l.id,onClick:c=>o.$emit("copy-from-checkpoint",l.id),class:"btn btn-secondary btn-checkpoint-source",disabled:e.updating},[r("span",DV,b(l.name),1),l.description?(p(),g("span",RV,b(a(l.description)),1)):D("",!0)],8,PV))),128))])):(p(),g("p",OV," No other "+b(N(t).checkpoints)+" available to copy from. ",1))]),e.error?(p(),g("div",BV,b(e.error),1)):D("",!0)]))]),r("div",NV,[r("button",{onClick:i[4]||(i[4]=l=>o.$emit("close")),class:"btn btn-secondary"},b(e.success?"Ok":"Cancel"),1)])])])):D("",!0)]),_:1}))}},UV=Ze(FV,[["__scopeId","data-v-b3924a32"]]),zV={class:"contact-info"},HV={class:"contact-name-row"},VV={key:0,class:"primary-badge"},GV={class:"contact-name"},qV={key:0,class:"contact-notes-text"},jV={key:1,class:"contact-detail"},WV={key:2,class:"contact-detail"},ZV={class:"contact-actions"},KV=["href"],YV=["href"],JV=["href"],XV={__name:"ContactCard",props:{name:{type:String,required:!0},role:{type:String,default:""},roles:{type:Array,default:()=>[]},phone:{type:String,default:""},email:{type:String,default:""},notes:{type:String,default:""},isPrimary:{type:Boolean,default:!1}},setup(e){const t=e,n=z(()=>t.roles&&t.roles.length>0?t.roles:t.role?[t.role]:[]),a=["Emergency","Safety","Medical","First Aid"],o=z(()=>n.value.length===0?!1:n.value.some(c=>a.some(d=>c.toLowerCase().includes(d.toLowerCase())))),i=c=>c?c.replace(/([A-Z])/g," $1").replace(/^./,d=>d.toUpperCase()).trim():"",l=z(()=>n.value.length===0?"":n.value.map(i).join(", "));return(c,d)=>(p(),g("div",{class:le(["contact-item",{"primary-contact":e.isPrimary}])},[r("div",zV,[r("div",HV,[e.isPrimary?(p(),g("span",VV,"")):D("",!0),r("span",GV,b(e.name),1),n.value.length>0?(p(),g("span",{key:1,class:le(["contact-role-badge",{"emergency-role":o.value}])},b(l.value),3)):D("",!0)]),e.notes?(p(),g("div",qV,b(e.notes),1)):D("",!0),e.phone?(p(),g("div",jV,b(e.phone),1)):D("",!0),e.email?(p(),g("div",WV,b(e.email),1)):D("",!0)]),r("div",ZV,[e.phone?(p(),g("a",{key:0,href:`tel:${e.phone}`,class:"contact-link"},[...d[0]||(d[0]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Je(" Call ",-1)])],8,KV)):D("",!0),e.phone?(p(),g("a",{key:1,href:`sms:${e.phone}`,class:"contact-link"},[...d[1]||(d[1]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Je(" Text ",-1)])],8,YV)):D("",!0),e.email?(p(),g("a",{key:2,href:`mailto:${e.email}`,class:"contact-link"},[...d[2]||(d[2]=[r("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Je(" Email ",-1)])],8,JV)):D("",!0)])],2))}},C1=Ze(XV,[["__scopeId","data-v-2fdc8dea"]]),QV={key:0,class:"accordion-section"},eG={class:"accordion-title"},tG=["innerHTML"],nG={class:"accordion-icon"},oG={key:0,class:"accordion-content"},aG={key:0,class:"loading"},sG={key:1,class:"contact-list"},iG={__name:"MarshalContactsSection",props:{contacts:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){return(t,n)=>e.contacts.length>0||e.loading?(p(),g("div",QV,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=a=>t.$emit("toggle"))},[r("span",eG,[r("span",{class:"section-icon",innerHTML:N(bo)("contacts")},null,8,tG),Je(" Your "+b(e.contacts.length===1?"contact":"contacts")+b(e.contacts.length>1?` (${e.contacts.length})`:""),1)]),r("span",nG,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",oG,[e.loading?(p(),g("div",aG,"Loading contacts...")):(p(),g("div",sG,[(p(!0),g(xe,null,qe(e.contacts,a=>(p(),ze(C1,{key:a.contactId,name:a.name,roles:a.roles,role:a.role,phone:a.phone,email:a.email,notes:a.notes,"is-primary":a.isPrimary},null,8,["name","roles","role","phone","email","notes","is-primary"]))),128))]))])):D("",!0)])):D("",!0)}},lG=Ze(iG,[["__scopeId","data-v-c3b5d73d"]]),rG={key:0,class:"accordion-section"},cG={class:"accordion-title"},uG=["innerHTML"],dG={class:"accordion-icon"},hG={key:0,class:"accordion-content"},fG={key:0,class:"loading-state"},pG={key:1,class:"empty-state"},vG={key:2,class:"incidents-list"},mG={__name:"MarshalIncidentsSection",props:{incidents:{type:Array,required:!0},loading:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1}},emits:["toggle","select-incident"],setup(e){return(t,n)=>e.incidents.length>0||e.loading?(p(),g("div",rG,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=a=>t.$emit("toggle"))},[r("span",cG,[r("span",{class:"section-icon",innerHTML:N(bo)("incidents")},null,8,uG),Je(" Your "+b(e.incidents.length===1?"incident":"incidents")+b(e.incidents.length>1?` (${e.incidents.length})`:""),1)]),r("span",dG,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",hG,[e.loading?(p(),g("div",fG," Loading incidents... ")):e.incidents.length===0?(p(),g("div",pG,[...n[1]||(n[1]=[r("p",null,"No incidents to show.",-1)])])):(p(),g("div",vG,[(p(!0),g(xe,null,qe(e.incidents,a=>(p(),ze(gc,{key:a.incidentId,incident:a,onSelect:o=>t.$emit("select-incident",a)},null,8,["incident","onSelect"]))),128))]))])):D("",!0)])):D("",!0)}},gG=Ze(mG,[["__scopeId","data-v-e84cbdf1"]]),yG={key:0,class:"accordion-section"},kG={class:"accordion-title"},bG=["innerHTML"],_G={class:"accordion-icon"},wG={key:0,class:"accordion-content"},CG={class:"event-details"},LG={key:0,class:"event-detail-row"},SG={class:"detail-value"},IG={key:1,class:"event-description"},xG={class:"detail-value"},$G={__name:"MarshalEventDetailsSection",props:{eventDate:{type:String,default:null},description:{type:String,default:""},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(e){const t=n=>n?new Date(n).toLocaleString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"}):"";return(n,a)=>e.eventDate||e.description?(p(),g("div",yG,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:a[0]||(a[0]=o=>n.$emit("toggle"))},[r("span",kG,[r("span",{class:"section-icon",innerHTML:N(bo)("event")},null,8,bG),a[1]||(a[1]=Je(" Event details ",-1))]),r("span",_G,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",wG,[r("div",CG,[e.eventDate?(p(),g("div",LG,[a[2]||(a[2]=r("span",{class:"detail-label"},"Date and time",-1)),r("span",SG,b(t(e.eventDate)),1)])):D("",!0),e.description?(p(),g("div",IG,[a[3]||(a[3]=r("span",{class:"detail-label"},"Description",-1)),r("p",xG,b(e.description),1)])):D("",!0)])])):D("",!0)])):D("",!0)}},TG=Ze($G,[["__scopeId","data-v-7c880ad1"]]),MG={class:"accordion-section"},AG={class:"accordion-title"},EG=["innerHTML"],PG={class:"accordion-icon"},DG={key:0,class:"accordion-content"},RG={key:0,class:"loading"},OG={key:1,class:"error"},BG={key:2,class:"empty-state"},NG={class:"checklist-section"},FG={key:0,class:"empty-state small"},UG={key:1,class:"my-jobs-list"},zG=["checked","disabled","onChange"],HG={key:0,class:"checklist-section"},VG={class:"checklist-section-title"},GG={key:0,class:"checklist-items"},qG={class:"item-checkbox"},jG=["checked","disabled","onChange"],WG={class:"item-content"},ZG={key:0,class:"item-context"},KG={key:1,class:"completion-info"},YG={class:"completion-text"},JG={class:"completion-time"},XG={key:1,class:"checklist-groups"},QG=["onClick"],eq={class:"group-title"},tq={class:"group-status"},nq={class:"group-count"},oq={class:"group-expand-icon"},aq={key:0,class:"checklist-group-items"},sq={class:"item-checkbox"},iq=["checked","disabled","onChange"],lq={class:"item-content"},rq={key:0,class:"completion-info"},cq={class:"completion-text"},uq={class:"completion-time"},dq={__name:"MarshalChecklistSection",props:{loading:{type:Boolean,default:!1},error:{type:String,default:""},isExpanded:{type:Boolean,default:!1},isAreaLead:{type:Boolean,default:!1},myItems:{type:Array,default:()=>[]},areaItems:{type:Array,default:()=>[]},areaItemsWithLocalState:{type:Array,default:()=>[]},visibleItems:{type:Array,default:()=>[]},groupedItems:{type:Array,default:()=>[]},completedCount:{type:Number,default:0},saving:{type:Boolean,default:!1},effectiveGroupBy:{type:String,default:"none"},expandedGroup:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},getContextName:{type:Function,default:()=>""}},emits:["toggle","toggle-item","toggle-group"],setup(e){const{termsLower:t}=ht(),n=e,a=z(()=>n.visibleItems.length),o=i=>i?new Date(i).toLocaleString():"";return(i,l)=>(p(),g("div",MG,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:l[0]||(l[0]=c=>i.$emit("toggle"))},[r("span",AG,[r("span",{class:"section-icon",innerHTML:N(bo)("checklist")},null,8,EG),Je(" Your "+b(N(t).checklists)+" ("+b(e.completedCount)+" of "+b(a.value)+" complete) ",1)]),r("span",PG,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",DG,[e.loading?(p(),g("div",RG,"Loading checklist...")):e.error?(p(),g("div",OG,b(e.error),1)):a.value===0?(p(),g("div",BG,[r("p",null,"No "+b(N(t).checklists)+" for you.",1)])):e.isAreaLead?(p(),g(xe,{key:3},[r("div",NG,[l[3]||(l[3]=r("h4",{class:"checklist-section-title"},"Your jobs",-1)),e.myItems.length===0?(p(),g("div",FG,[...l[2]||(l[2]=[r("p",null,"No jobs assigned to you.",-1)])])):(p(),g("div",UG,[(p(!0),g(xe,null,qe(e.myItems,c=>(p(),g("div",{key:`${c.itemId}_${c.completionContextType}_${c.completionContextId}`,class:"my-job-item"},[r("input",{type:"checkbox",checked:c.isCompleted,disabled:e.saving,onChange:d=>i.$emit("toggle-item",c)},null,40,zG),r("span",{class:le(["my-job-text",{completed:c.isCompleted}])},b(c.text),3)]))),128))]))]),e.areaItems.length>0?(p(),g("div",HG,[r("h4",VG,"Your "+b(N(t).area)+"'s jobs",1),Ee(Uf,{items:e.areaItemsWithLocalState,locations:e.locations,areas:e.areas,marshals:e.marshals,onToggleComplete:l[1]||(l[1]=c=>i.$emit("toggle-item",c))},null,8,["items","locations","areas","marshals"])])):D("",!0)],64)):(p(),g(xe,{key:4},[e.effectiveGroupBy==="none"?(p(),g("div",GG,[(p(!0),g(xe,null,qe(e.visibleItems,c=>(p(),g("div",{key:`${c.itemId}_${c.completionContextType}_${c.completionContextId}`,class:le(["checklist-item",{"item-completed":c.isCompleted}])},[r("div",qG,[r("input",{type:"checkbox",checked:c.isCompleted,disabled:!c.canBeCompletedByMe||e.saving,onChange:d=>i.$emit("toggle-item",c)},null,40,jG)]),r("div",WG,[r("div",{class:le(["item-text",{"text-completed":c.isCompleted}])},b(c.text),3),e.getContextName(c)?(p(),g("div",ZG,b(e.getContextName(c)),1)):D("",!0),c.isCompleted?(p(),g("div",KG,[r("span",YG," Completed by "+b(c.completedByActorName||"Unknown"),1),r("span",JG,b(o(c.completedAt)),1)])):D("",!0)])],2))),128))])):(p(),g("div",XG,[(p(!0),g(xe,null,qe(e.groupedItems,c=>(p(),g("div",{key:c.key,class:"checklist-group"},[r("button",{class:le(["checklist-group-header",{expanded:e.expandedGroup===c.key,"all-complete":c.completedCount===c.items.length}]),onClick:d=>i.$emit("toggle-group",c.key)},[r("span",eq,b(c.name),1),r("span",tq,[r("span",nq,b(c.completedCount)+"/"+b(c.items.length),1),r("span",oq,b(e.expandedGroup===c.key?"":"+"),1)])],10,QG),e.expandedGroup===c.key?(p(),g("div",aq,[(p(!0),g(xe,null,qe(c.items,d=>(p(),g("div",{key:`${d.itemId}_${d.completionContextType}_${d.completionContextId}`,class:le(["checklist-item",{"item-completed":d.isCompleted}])},[r("div",sq,[r("input",{type:"checkbox",checked:d.isCompleted,disabled:!d.canBeCompletedByMe||e.saving,onChange:h=>i.$emit("toggle-item",d)},null,40,iq)]),r("div",lq,[r("div",{class:le(["item-text",{"text-completed":d.isCompleted}])},b(d.text),3),d.isCompleted?(p(),g("div",rq,[r("span",cq,b(d.completedByActorName||"Unknown"),1),r("span",uq,b(o(d.completedAt)),1)])):D("",!0)])],2))),128))])):D("",!0)]))),128))]))],64))])):D("",!0)]))}},hq=Ze(dq,[["__scopeId","data-v-b2878e4f"]]),fq={class:"accordion-section"},pq={class:"accordion-title"},vq=["innerHTML"],mq={class:"accordion-icon"},gq={key:0,class:"accordion-content"},yq={__name:"MarshalNotesSection",props:{eventId:{type:String,required:!0},notes:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},isExpanded:{type:Boolean,default:!1}},emits:["toggle","notes-changed"],setup(e){return(t,n)=>(p(),g("div",fq,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:n[0]||(n[0]=a=>t.$emit("toggle"))},[r("span",pq,[r("span",{class:"section-icon",innerHTML:N(bo)("notes")},null,8,vq),Je(" Your "+b(e.notes.length===1?"note":"notes")+b(e.notes.length>1?` (${e.notes.length})`:""),1)]),r("span",mq,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",gq,[Ee(nd,{"event-id":e.eventId,"all-notes":e.notes,locations:e.locations,areas:e.areas,assignments:e.assignments,"show-scope":!1,onNotesChanged:n[1]||(n[1]=a=>t.$emit("notes-changed"))},null,8,["event-id","all-notes","locations","areas","assignments"])])):D("",!0)]))}},kq=Ze(yq,[["__scopeId","data-v-10b7523a"]]),bq={class:"accordion-section"},_q={class:"accordion-title"},wq=["innerHTML"],Cq={key:0,class:"location-status active"},Lq={key:1,class:"location-status"},Sq={class:"accordion-icon"},Iq={key:0,class:"accordion-content map-content"},xq={key:0,class:"map-selection-banner"},$q={class:"map-wrapper"},Tq={__name:"MarshalRouteSection",props:{isExpanded:{type:Boolean,default:!1},userLocation:{type:Object,default:null},selectingLocation:{type:Boolean,default:!1},selectingLocationName:{type:String,default:""},locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},highlightLocationIds:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]}},emits:["toggle","cancel-select","map-click","location-click","action-click","visibility-change"],setup(e,{expose:t}){const{terms:n}=ht(),a=$o("marshalBranding",{headerStyle:{},headerTextColor:""}),o=ul({headerStyle:z(()=>au(a.headerStyle)),headerTextColor:z(()=>au(a.headerTextColor))}),i=P(null);return t({mapRef:i,recenterOnLocation:(l,c,d)=>i.value?.recenterOnLocation?.(l,c,d),recenterOnUserLocation:()=>i.value?.recenterOnUserLocation?.(),openFullscreen:()=>i.value?.openFullscreen?.()}),(l,c)=>(p(),g("div",bq,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:c[0]||(c[0]=d=>l.$emit("toggle"))},[r("span",_q,[r("span",{class:"section-icon",innerHTML:N(bo)("course")},null,8,wq),Je(" "+b(N(n).course)+" ",1),e.userLocation?(p(),g("span",Cq,"GPS Active")):(p(),g("span",Lq,"GPS Inactive"))]),r("span",Sq,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",Iq,[e.selectingLocation?(p(),g("div",xq,[r("span",null,[c[7]||(c[7]=Je("Click on the map to set the new location for ",-1)),r("strong",null,b(e.selectingLocationName),1)]),r("button",{onClick:c[1]||(c[1]=d=>l.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")])):D("",!0),r("div",$q,[Ee(hl,{ref_key:"mapRef",ref:i,locations:e.locations,route:e.route,center:e.center,zoom:15,"user-location":e.userLocation,"highlight-location-ids":e.highlightLocationIds,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:e.clickable,"show-fullscreen":!0,"fullscreen-title":N(n).course,"fullscreen-header-style":o.headerStyle,"fullscreen-header-text-color":o.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,class:le({"selecting-location":e.selectingLocation}),height:"100%",onMapClick:c[3]||(c[3]=d=>l.$emit("map-click",d)),onLocationClick:c[4]||(c[4]=d=>l.$emit("location-click",d)),onActionClick:c[5]||(c[5]=d=>l.$emit("action-click",d)),onVisibilityChange:c[6]||(c[6]=d=>l.$emit("visibility-change",d))},yf({_:2},[e.selectingLocation?{name:"fullscreen-banner",fn:Ue(()=>[r("span",null,[c[8]||(c[8]=Je("Click on the map to set the new location for ",-1)),r("strong",null,b(e.selectingLocationName),1)]),r("button",{onClick:c[2]||(c[2]=d=>l.$emit("cancel-select")),class:"btn btn-secondary btn-sm"},"Cancel")]),key:"0"}:void 0]),1032,["locations","route","center","user-location","highlight-location-ids","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions","class"])])])):D("",!0)]))}},Mq=Ze(Tq,[["__scopeId","data-v-bbbe1950"]]),Aq={class:"area-lead-content"},Eq={key:0,class:"loading-state"},Pq={key:1,class:"error-state"},Dq={key:2,class:"empty-state"},Rq={key:3,class:"checkpoint-accordion"},Oq=["onClick"],Bq={class:"checkpoint-header-content"},Nq={class:"checkpoint-title-row"},Fq={class:"checkpoint-name"},Uq={key:0,class:"area-badge"},zq={key:0,class:"checkpoint-description-preview"},Hq={class:"checkpoint-status-row"},Vq={class:"status-badge marshals-status"},Gq={key:0,class:"status-badge tasks-status"},qq={class:"accordion-icon"},jq={key:0,class:"checkpoint-accordion-content"},Wq={class:"checkpoint-mini-map"},Zq={class:"checkpoint-marshals-section"},Kq={class:"marshals-label"},Yq={key:0,class:"empty-state"},Jq={key:1,class:"marshals-list"},Xq=["onClick"],Qq={class:"marshal-header"},ej={class:"marshal-name-row"},tj={class:"marshal-name"},nj={key:0,class:"task-count"},oj={class:"check-status-row"},aj=["onClick","disabled"],sj={key:0,class:"check-in-time"},ij={key:0},lj={key:1,class:"last-access-time"},rj={key:0,class:"checkpoint-tasks-section"},cj={class:"marshals-label"},uj={class:"tasks-list"},dj=["disabled","onChange"],hj={class:"task-text"},fj=["disabled","onChange"],pj={class:"task-text"},vj={key:0,class:"marshal-details-modal"},mj={class:"details-section"},gj={class:"contact-info"},yj={key:0,class:"contact-row"},kj=["href"],bj={key:1,class:"contact-row"},_j=["href"],wj={key:2,class:"no-contact"},Cj={class:"details-section"},Lj={key:0,class:"checked-in-section"},Sj={class:"checked-in-details"},Ij={class:"check-time-detail"},xj={key:0,class:"check-method"},$j=["disabled"],Tj={key:1,class:"not-checked-in-section"},Mj=["disabled"],Aj={key:2,class:"last-access-detail"},Ej={class:"details-section"},Pj={key:0,class:"no-tasks"},Dj={key:1,class:"tasks-list modal-tasks"},Rj=["disabled","onChange"],Oj={class:"task-text"},Bj={class:"details-section contact-actions-section"},Nj={class:"contact-buttons"},Fj=["href"],Uj=["href"],zj=["href"],Hj={__name:"AreaLeadSection",props:{eventId:{type:String,required:!0},areaIds:{type:Array,default:()=>[]},marshalId:{type:String,required:!0},route:{type:Array,default:()=>[]}},emits:["checklist-updated","loaded","checkin-updated"],setup(e,{expose:t,emit:n}){const{terms:a,termsLower:o}=ht(),{updatePendingCount:i}=Hf(),l=e,c=n,d=P(!1),h=P(null),f=P([]),m=P([]),y=P(null),k=P(!1),S=P(null),x=z(()=>{const U=new Set(l.areaIds);return U.size===0?[...m.value].sort((Q,oe)=>na(Q.name,oe.name)):m.value.filter(Q=>(Q.areaIds||[]).some(he=>U.has(he))).sort((Q,oe)=>na(Q.name,oe.name))}),E=(U,Q=60)=>U?U.length<=Q?U:U.substring(0,Q).trim()+"...":"",$=P(!1),w=P(null),_=P(null),I=async()=>{if(!(!l.eventId||l.areaIds.length===0)){if(d.value=!0,h.value=null,Jn()){try{const U=await ui(l.eventId);if(U?.areaLeadDashboard){f.value=U.areaLeadDashboard.areas||[],m.value=U.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(U){console.warn("Failed to load cached dashboard:",U)}h.value="Offline - no cached data available",d.value=!1;return}try{const U=await bs.getAreaLeadDashboard(l.eventId);f.value=U.data.areas||[],m.value=U.data.checkpoints||[];try{const Q=JSON.parse(JSON.stringify({areas:f.value,checkpoints:m.value}));await ui(l.eventId)?await Yc(l.eventId,"areaLeadDashboard",Q):await sc(l.eventId,{areaLeadDashboard:Q})}catch(Q){console.warn("Failed to cache dashboard:",Q)}}catch(U){console.error("Failed to load area lead dashboard:",U);try{const Q=await ui(l.eventId);if(Q?.areaLeadDashboard){console.log("Loading area lead dashboard from cache after error"),f.value=Q.areaLeadDashboard.areas||[],m.value=Q.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(Q){console.warn("Failed to load cached dashboard:",Q)}h.value=U.response?.data?.message||"Failed to load dashboard"}finally{d.value=!1}}},T=U=>{y.value=y.value===U?null:U},B=U=>U.marshals.filter(Q=>Q.isCheckedIn).length,M=U=>{const Q=U.marshals.reduce((oe,he)=>oe+he.outstandingTaskCount,0);return U.outstandingTaskCount+Q},R=(U,Q)=>{w.value=U,_.value=Q,$.value=!0},A=()=>{$.value=!1,w.value=null,_.value=null},G=async(U,Q)=>{if(S.value)return;const oe=U.assignmentId||U.id;if(!oe){console.error("No assignment ID found for marshal:",U);return}S.value=U.marshalId;try{if(Jn())await Fo("checkin_toggle",{eventId:l.eventId,assignmentId:oe}),U.isCheckedIn=!0,U.checkInTime=new Date().toISOString(),U.checkInMethod="AreaLead (pending)",await i(),c("checkin-updated");else if(await di.toggleCheckIn(l.eventId,oe),await I(),c("checkin-updated"),w.value?.marshalId===U.marshalId&&_.value){const he=m.value.find(Te=>Te.checkpointId===_.value.checkpointId);if(he){const Te=he.marshals.find(je=>je.marshalId===U.marshalId);Te&&(w.value=Te)}}}catch(he){console.error("Failed to check in marshal:",he),(Jn()||!he.response)&&(await Fo("checkin_toggle",{eventId:l.eventId,assignmentId:oe}),U.isCheckedIn=!0,U.checkInTime=new Date().toISOString(),U.checkInMethod="AreaLead (pending)",await i(),c("checkin-updated"))}finally{S.value=null}},F=async(U,Q)=>{if(k.value)return;k.value=!0;const he={marshalId:Q.marshals.length>0?Q.marshals[0].marshalId:l.marshalId,contextType:U.contextType,contextId:U.contextId};try{Jn()?(await Fo("checklist_complete",{eventId:l.eventId,itemId:U.itemId,data:he}),Q.outstandingTasks=Q.outstandingTasks.filter(Te=>Te.itemId!==U.itemId),Q.outstandingTaskCount=Math.max(0,Q.outstandingTaskCount-1),await i(),c("checklist-updated")):(await Nt.complete(l.eventId,U.itemId,he),await I(),c("checklist-updated"))}catch(Te){console.error("Failed to complete task:",Te),(Jn()||!Te.response)&&(await Fo("checklist_complete",{eventId:l.eventId,itemId:U.itemId,data:he}),Q.outstandingTasks=Q.outstandingTasks.filter(je=>je.itemId!==U.itemId),Q.outstandingTaskCount=Math.max(0,Q.outstandingTaskCount-1),await i(),c("checklist-updated"))}finally{k.value=!1}},j=async(U,Q)=>{if(k.value)return;k.value=!0;const he={marshalId:Q.marshals.length>0?Q.marshals[0].marshalId:l.marshalId,contextType:U.contextType,contextId:U.contextId,actorMarshalId:l.marshalId};try{Jn()?(await Fo("checklist_uncomplete",{eventId:l.eventId,itemId:U.itemId,data:he}),Q.completedTasks&&(Q.completedTasks=Q.completedTasks.filter(Te=>Te.itemId!==U.itemId)),Q.outstandingTasks||(Q.outstandingTasks=[]),Q.outstandingTasks.push(U),Q.outstandingTaskCount=(Q.outstandingTaskCount||0)+1,await i(),c("checklist-updated")):(await Nt.uncomplete(l.eventId,U.itemId,he),await I(),c("checklist-updated"))}catch(Te){console.error("Failed to uncomplete task:",Te),(Jn()||!Te.response)&&(await Fo("checklist_uncomplete",{eventId:l.eventId,itemId:U.itemId,data:he}),Q.completedTasks&&(Q.completedTasks=Q.completedTasks.filter(je=>je.itemId!==U.itemId)),Q.outstandingTasks||(Q.outstandingTasks=[]),Q.outstandingTasks.push(U),Q.outstandingTaskCount=(Q.outstandingTaskCount||0)+1,await i(),c("checklist-updated"))}finally{k.value=!1}},K=async U=>{if(k.value||!w.value)return;k.value=!0;const Q={marshalId:w.value.marshalId,contextType:U.contextType,contextId:U.contextId};try{if(Jn())await Fo("checklist_complete",{eventId:l.eventId,itemId:U.itemId,data:Q}),w.value.outstandingTasks=w.value.outstandingTasks.filter(oe=>oe.itemId!==U.itemId),w.value.outstandingTaskCount=Math.max(0,w.value.outstandingTaskCount-1),await i(),c("checklist-updated");else{if(await Nt.complete(l.eventId,U.itemId,Q),await I(),w.value&&_.value){const oe=m.value.find(he=>he.checkpointId===_.value.checkpointId);if(oe){const he=oe.marshals.find(Te=>Te.marshalId===w.value.marshalId);he&&(w.value=he)}}c("checklist-updated")}}catch(oe){console.error("Failed to complete task:",oe),(Jn()||!oe.response)&&(await Fo("checklist_complete",{eventId:l.eventId,itemId:U.itemId,data:Q}),w.value.outstandingTasks=w.value.outstandingTasks.filter(he=>he.itemId!==U.itemId),w.value.outstandingTaskCount=Math.max(0,w.value.outstandingTaskCount-1),await i(),c("checklist-updated"))}finally{k.value=!1}},J=U=>U?new Date(U).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",ue=U=>U?new Date(U).toLocaleString():"",Z=U=>{if(!U)return"";const Q=new Date(U),he=new Date-Q,Te=Math.floor(he/6e4),je=Math.floor(Te/60),He=Math.floor(je/24);return Te<1?"just now":Te<60?`${Te}m ago`:je<24?`${je}h ago`:He===1?"yesterday":He<7?`${He}d ago`:Q.toLocaleDateString()},se=U=>({GPS:"GPS",Manual:"Manual",Admin:"Admin",AreaLead:`${a.value.area} Lead`})[U]||U;return t({areas:f,checkpoints:m,loading:d,loadDashboard:I}),Ye(()=>l.eventId,()=>{I()},{immediate:!0}),(U,Q)=>(p(),g("div",Aq,[d.value?(p(),g("div",Eq," Loading dashboard... ")):h.value?(p(),g("div",Pq,[r("p",null,b(h.value),1),r("button",{onClick:I,class:"btn btn-secondary"},"Retry")])):x.value.length===0?(p(),g("div",Dq,[r("p",null,"No "+b(N(o).checkpoints)+" in your "+b(N(o).areas)+".",1)])):(p(),g("div",Rq,[(p(!0),g(xe,null,qe(x.value,oe=>(p(),g("div",{key:oe.checkpointId,class:"checkpoint-accordion-section"},[r("button",{class:le(["checkpoint-accordion-header",{active:y.value===oe.checkpointId}]),onClick:he=>T(oe.checkpointId)},[r("div",Bq,[r("div",Nq,[r("span",Fq,b(oe.name),1),oe.areaName?(p(),g("span",Uq,b(oe.areaName),1)):D("",!0)]),oe.description?(p(),g("div",zq,b(E(oe.description)),1)):D("",!0),r("div",Hq,[r("span",Vq,b(B(oe))+" / "+b(oe.marshals.length)+" checked in ",1),M(oe)>0?(p(),g("span",Gq,b(M(oe))+" tasks ",1)):D("",!0)])]),r("span",qq,b(y.value===oe.checkpointId?"":"+"),1)],10,Oq),y.value===oe.checkpointId?(p(),g("div",jq,[r("div",Wq,[Ee(hl,{locations:[{id:oe.checkpointId,name:oe.name,description:oe.description,latitude:oe.latitude,longitude:oe.longitude}],route:e.route,center:{lat:oe.latitude,lng:oe.longitude},zoom:16,"highlight-location-id":oe.checkpointId,"marshal-mode":!0,height:"280px"},null,8,["locations","route","center","highlight-location-id"])]),r("div",Zq,[r("div",Kq,b(N(a).people)+" ("+b(oe.marshals.length)+")",1),oe.marshals.length===0?(p(),g("div",Yq," No "+b(N(o).people)+" assigned to this "+b(N(o).checkpoint)+". ",1)):(p(),g("div",Jq,[(p(!0),g(xe,null,qe(oe.marshals,he=>(p(),g("div",{key:he.marshalId,class:le(["marshal-card",{"is-checked-in":he.isCheckedIn}]),onClick:Te=>R(he,oe)},[r("div",Qq,[r("div",ej,[r("span",tj,b(he.name),1),he.outstandingTaskCount>0?(p(),g("span",nj,b(he.outstandingTaskCount)+" tasks ",1)):D("",!0)]),r("div",oj,[r("div",{class:le(["check-status",{"checked-in":he.isCheckedIn}])},b(he.isCheckedIn?" Checked In":"Not Checked In"),3),r("button",{onClick:ct(Te=>G(he),["stop"]),class:le(["quick-checkin-btn",{"undo-btn":he.isCheckedIn}]),disabled:S.value===he.marshalId},b(S.value===he.marshalId?"...":he.isCheckedIn?"Undo":"Check In"),11,aj)])]),he.isCheckedIn&&he.checkInTime?(p(),g("div",sj,[Je(b(J(he.checkInTime))+" ",1),he.checkInMethod?(p(),g("span",ij," ("+b(se(he.checkInMethod))+")",1)):D("",!0)])):D("",!0),he.lastAccessedAt?(p(),g("div",lj," Last active: "+b(Z(he.lastAccessedAt)),1)):D("",!0)],10,Xq))),128))]))]),oe.outstandingTaskCount>0||oe.completedTasks&&oe.completedTasks.length>0?(p(),g("div",rj,[r("div",cj,b(N(a).checkpoint)+" tasks",1),r("div",uj,[(p(!0),g(xe,null,qe(oe.outstandingTasks,he=>(p(),g("div",{key:he.itemId,class:"task-item"},[r("input",{type:"checkbox",disabled:k.value,onChange:Te=>F(he,oe)},null,40,dj),r("span",hj,b(he.text),1)]))),128)),(p(!0),g(xe,null,qe(oe.completedTasks||[],he=>(p(),g("div",{key:`completed-${he.itemId}`,class:"task-item task-completed"},[r("input",{type:"checkbox",checked:"",disabled:k.value,onChange:Te=>j(he,oe)},null,40,fj),r("span",pj,b(he.text),1)]))),128))])])):D("",!0)])):D("",!0)]))),128))])),Ee(jt,{show:$.value,title:w.value?.name||"Marshal Details",size:"large",onClose:A},{actions:Ue(()=>[r("button",{onClick:A,class:"btn btn-secondary"},"Close")]),default:Ue(()=>[w.value?(p(),g("div",vj,[r("div",mj,[Q[4]||(Q[4]=r("h4",null,"Contact Details",-1)),r("div",gj,[w.value.email?(p(),g("div",yj,[Q[2]||(Q[2]=r("span",{class:"contact-label"},"Email:",-1)),r("a",{href:`mailto:${w.value.email}`},b(w.value.email),9,kj)])):D("",!0),w.value.phoneNumber?(p(),g("div",bj,[Q[3]||(Q[3]=r("span",{class:"contact-label"},"Phone:",-1)),r("a",{href:`tel:${w.value.phoneNumber}`},b(w.value.phoneNumber),9,_j)])):D("",!0),!w.value.email&&!w.value.phoneNumber?(p(),g("div",wj," No contact details available. ")):D("",!0)])]),r("div",Cj,[Q[8]||(Q[8]=r("h4",null,"Check-in Status",-1)),w.value.isCheckedIn?(p(),g("div",Lj,[r("div",Sj,[Q[6]||(Q[6]=r("span",{class:"check-icon"},"",-1)),r("div",null,[Q[5]||(Q[5]=r("strong",null,"Checked In",-1)),r("p",Ij,b(ue(w.value.checkInTime)),1),w.value.checkInMethod?(p(),g("p",xj," Method: "+b(se(w.value.checkInMethod)),1)):D("",!0)])]),r("button",{onClick:Q[0]||(Q[0]=oe=>G(w.value,_.value)),class:"btn btn-secondary undo-checkin-btn",disabled:S.value===w.value.marshalId},b(S.value===w.value.marshalId?"Undoing...":"Undo Check-in"),9,$j)])):(p(),g("div",Tj,[Q[7]||(Q[7]=r("div",{class:"not-checked-in"},[r("span",{class:"not-checked-icon"},""),r("span",null,"Not checked in")],-1)),r("button",{onClick:Q[1]||(Q[1]=oe=>G(w.value,_.value)),class:"btn btn-primary check-in-btn",disabled:S.value===w.value.marshalId},b(S.value===w.value.marshalId?"Checking in...":"Check In"),9,Mj)])),w.value.lastAccessedAt?(p(),g("div",Aj," Last active: "+b(Z(w.value.lastAccessedAt)),1)):D("",!0)]),r("div",Ej,[r("h4",null,b(N(a).checklists)+" ("+b(w.value.outstandingTasks?.length||0)+" outstanding)",1),!w.value.outstandingTasks||w.value.outstandingTasks.length===0?(p(),g("div",Pj," No outstanding tasks. ")):(p(),g("div",Dj,[(p(!0),g(xe,null,qe(w.value.outstandingTasks,oe=>(p(),g("div",{key:oe.itemId,class:"task-item"},[r("input",{type:"checkbox",disabled:k.value,onChange:he=>K(oe)},null,40,Rj),r("span",Oj,b(oe.text),1)]))),128))]))]),r("div",Bj,[r("div",Nj,[w.value.phoneNumber?(p(),g("a",{key:0,href:`tel:${w.value.phoneNumber}`,class:"btn btn-primary"}," Call ",8,Fj)):D("",!0),w.value.phoneNumber?(p(),g("a",{key:1,href:`sms:${w.value.phoneNumber}`,class:"btn btn-secondary"}," Text ",8,Uj)):D("",!0),w.value.email?(p(),g("a",{key:2,href:`mailto:${w.value.email}`,class:"btn btn-secondary"}," Email ",8,zj)):D("",!0)])])])):D("",!0)]),_:1},8,["show","title"])]))}},Vj=Ze(Hj,[["__scopeId","data-v-067e0528"]]),Gj={key:0,class:"accordion-section"},qj={class:"accordion-title"},jj=["innerHTML"],Wj={class:"accordion-icon"},Zj={key:0,class:"accordion-content area-lead-accordion-content"},Kj={key:0,class:"area-filter-pills"},Yj=["onClick"],Jj={__name:"MarshalAreaLeadSection",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedFilters:{type:Set,default:()=>new Set},filteredAreaIds:{type:Array,default:()=>[]},eventId:{type:String,required:!0},marshalId:{type:String,default:""},route:{type:Array,default:()=>[]}},emits:["toggle","toggle-filter","checklist-updated"],setup(e,{expose:t}){const{termsLower:n}=ht(),a=P(null);return t({areaLeadRef:a}),(o,i)=>e.isAreaLead?(p(),g("div",Gj,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=l=>o.$emit("toggle"))},[r("span",qj,[r("span",{class:"section-icon",innerHTML:N(bo)("area")},null,8,jj),Je(" Your "+b(e.areas.length===1?N(n).area:N(n).areas)+b(e.areas.length>1?` (${e.areas.length})`:""),1)]),r("span",Wj,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",Zj,[e.areas.length>1?(p(),g("div",Kj,[(p(!0),g(xe,null,qe(e.areas,l=>(p(),g("button",{key:l.areaId,class:le(["area-filter-pill",{selected:e.selectedFilters.has(l.areaId)}]),style:nt(e.selectedFilters.has(l.areaId)?{backgroundColor:l.color||"#667eea",borderColor:l.color||"#667eea"}:{}),onClick:c=>o.$emit("toggle-filter",l.areaId)},b(l.name),15,Yj))),128))])):D("",!0),Ee(Vj,{ref_key:"areaLeadRef",ref:a,"event-id":e.eventId,"area-ids":e.filteredAreaIds,"marshal-id":e.marshalId,route:e.route,onChecklistUpdated:i[1]||(i[1]=l=>o.$emit("checklist-updated"))},null,8,["event-id","area-ids","marshal-id","route"])])):D("",!0)])):D("",!0)}},Xj=Ze(Jj,[["__scopeId","data-v-9278e6a8"]]),Qj={key:0,class:"accordion-section"},eW={class:"accordion-title"},tW=["innerHTML"],nW={class:"accordion-icon"},oW={key:0,class:"accordion-content area-lead-marshals-content"},aW={class:"area-lead-marshals-list"},sW=["onClick"],iW={class:"marshal-header-info"},lW={class:"marshal-name-row"},rW={class:"marshal-name"},cW={class:"marshal-meta"},uW={class:"marshal-checkpoint"},dW={key:0,class:"marshal-task-count"},hW={class:"accordion-icon"},fW={key:0,class:"area-lead-marshal-content"},pW={key:0,class:"marshal-actions-row"},vW=["onClick"],mW={key:1,class:"marshal-contact-section"},gW=["href"],yW=["href"],kW={key:2,class:"marshal-tasks-section"},bW={class:"tasks-label"},_W={class:"tasks-list"},wW=["checked","disabled","onChange"],CW={class:"task-text"},LW={key:3,class:"no-tasks-message"},SW={__name:"MarshalMarshalsList",props:{isAreaLead:{type:Boolean,default:!1},isExpanded:{type:Boolean,default:!1},marshals:{type:Array,default:()=>[]},expandedMarshalId:{type:String,default:null},checkingInMarshalId:{type:String,default:null},savingTask:{type:Boolean,default:!1},currentMarshalId:{type:String,default:null}},emits:["toggle","toggle-marshal","check-in","toggle-task","show-qr"],setup(e){const{terms:t,termsLower:n}=ht(),a=o=>{if(!o||o.length===0)return"";const i=l=>l.description?`${l.name} - ${l.description}`:l.name;return o.length===1?i(o[0]):o.map(i).join(", ")};return(o,i)=>e.isAreaLead&&e.marshals.length>0?(p(),g("div",Qj,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:i[0]||(i[0]=l=>o.$emit("toggle"))},[r("span",eW,[r("span",{class:"section-icon",innerHTML:N(bo)("marshal")},null,8,tW),Je(" Your "+b(e.marshals.length===1?N(n).person:N(n).people)+b(e.marshals.length>1?` (${e.marshals.length})`:""),1)]),r("span",nW,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",oW,[r("div",aW,[(p(!0),g(xe,null,qe(e.marshals,l=>(p(),g("div",{key:l.marshalId,class:"area-lead-marshal-item"},[r("button",{class:le(["area-lead-marshal-header",{active:e.expandedMarshalId===l.marshalId,"is-checked-in":l.isCheckedIn}]),onClick:c=>o.$emit("toggle-marshal",l.marshalId)},[r("div",iW,[r("div",lW,[r("span",rW,b(l.name),1),r("span",{class:le(["check-status-badge",{"checked-in":l.isCheckedIn}])},b(l.isCheckedIn?"":""),3)]),r("div",cW,[r("span",uW,b(a(l.checkpoints)),1),l.totalTaskCount>0?(p(),g("span",dW,b(l.completedTaskCount)+" / "+b(l.totalTaskCount)+" "+b(N(n).checklists)+" complete ",1)):D("",!0)])]),r("span",hW,b(e.expandedMarshalId===l.marshalId?"":"+"),1)],10,sW),e.expandedMarshalId===l.marshalId?(p(),g("div",fW,[l.marshalId!==e.currentMarshalId?(p(),g("div",pW,[Ee(wu,{"is-checked-in":l.isCheckedIn,"check-in-time":l.checkInTime,"check-in-method":l.checkInMethod,"checked-in-by":l.checkedInBy,"marshal-name":l.marshalName,"is-loading":e.checkingInMarshalId===l.id,onToggle:c=>o.$emit("check-in",l)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"]),r("button",{class:"btn btn-secondary btn-qr-icon",onClick:ct(c=>o.$emit("show-qr",l),["stop"]),title:"Show QR code for magic link"},[...i[1]||(i[1]=[fi('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-f53b5160><rect x="3" y="3" width="7" height="7" data-v-f53b5160></rect><rect x="14" y="3" width="7" height="7" data-v-f53b5160></rect><rect x="3" y="14" width="7" height="7" data-v-f53b5160></rect><rect x="14" y="14" width="3" height="3" data-v-f53b5160></rect><rect x="19" y="14" width="2" height="2" data-v-f53b5160></rect><rect x="14" y="19" width="2" height="2" data-v-f53b5160></rect><rect x="19" y="19" width="2" height="2" data-v-f53b5160></rect></svg>',1)])],8,vW)])):D("",!0),l.email||l.phoneNumber?(p(),g("div",mW,[l.phoneNumber?(p(),g("a",{key:0,href:`tel:${l.phoneNumber}`,class:"contact-link"},b(l.phoneNumber),9,gW)):D("",!0),l.email?(p(),g("a",{key:1,href:`mailto:${l.email}`,class:"contact-link"},b(l.email),9,yW)):D("",!0)])):D("",!0),l.allTasks.length>0?(p(),g("div",kW,[r("div",bW,b(N(t).checklists),1),r("div",_W,[(p(!0),g(xe,null,qe(l.allTasks,c=>(p(),g("div",{key:`${c.itemId}-${c.contextId}`,class:le(["task-item",{"task-completed":c.isCompleted}])},[r("input",{type:"checkbox",checked:c.isCompleted,disabled:e.savingTask,onChange:d=>o.$emit("toggle-task",c,l)},null,40,wW),r("span",CW,b(c.text),1)],2))),128))])])):(p(),g("div",LW," No "+b(N(n).checklists)+" assigned. ",1))])):D("",!0)]))),128))])])):D("",!0)])):D("",!0)}},IW=Ze(SW,[["__scopeId","data-v-f53b5160"]]),xW={class:"checkpoint-note-header"},$W={key:0,class:"pin-icon",title:"Pinned"},TW={class:"checkpoint-note-title"},MW={key:0,class:"checkpoint-note-content"},AW={__name:"NoteCard",props:{title:{type:String,required:!0},content:{type:String,default:""},priority:{type:String,default:"Normal"},isPinned:{type:Boolean,default:!1}},setup(e){const t=e,n=z(()=>(t.priority||"Normal").toLowerCase());return(a,o)=>(p(),g("div",{class:le(["checkpoint-note-item",n.value])},[r("div",xW,[e.isPinned?(p(),g("span",$W,"")):D("",!0),r("span",{class:le(["priority-indicator",n.value])},null,2),r("strong",TW,b(e.title),1),r("span",{class:le(["priority-badge",n.value])},b(e.priority),3)]),e.content?(p(),g("div",MW,b(e.content),1)):D("",!0)],2))}},EW=Ze(AW,[["__scopeId","data-v-5f2df920"]]),PW={class:"checkpoint-accordion-section"},DW={class:"checkpoint-header-content"},RW={class:"checkpoint-title-row"},OW=["innerHTML"],BW={key:0,class:"checkpoint-check-icon"},NW={class:"checkpoint-name"},FW={key:1,class:"area-badge"},UW={key:2,class:"checkpoint-time-badge"},zW={key:3,class:"checkpoint-distance-badge"},HW={key:0,class:"checkpoint-description-preview"},VW={class:"accordion-icon"},GW={key:0,class:"checkpoint-accordion-content"},qW={key:0,class:"checkpoint-mini-map"},jW={viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",style:{"margin-right":"0.5rem"}},WW={class:"my-checkin-section"},ZW={key:0,class:"check-in-error"},KW={key:1,class:"dynamic-location-section"},YW={class:"dynamic-location-header"},JW={class:"dynamic-badge"},XW={key:0,class:"last-update"},QW={key:0,class:"dynamic-location-actions"},eZ=["disabled"],tZ=["title"],nZ={class:"checkpoint-marshals"},oZ={class:"marshals-label"},aZ={key:0,class:"marshals-list"},sZ={key:0,class:"check-badge"},iZ={key:1,class:"marshals-list-expanded"},lZ=["onClick"],rZ={class:"marshal-name-text"},cZ={class:"marshal-status-icons"},uZ={key:0,class:"check-badge"},dZ={class:"expand-icon"},hZ={key:0,class:"marshal-details-panel"},fZ={class:"detail-row"},pZ={key:0,class:"detail-row"},vZ={key:1,class:"detail-row"},mZ={key:2,class:"detail-row"},gZ=["href"],yZ={key:3,class:"detail-row"},kZ=["href"],bZ={key:4,class:"contact-buttons-mini"},_Z=["href"],wZ=["href"],CZ=["href"],LZ={key:5,class:"checkpoint-marshal-actions"},SZ=["onClick"],IZ={key:2,class:"checkpoint-area-contacts"},xZ={class:"marshals-label"},$Z={class:"contact-list"},TZ={key:3,class:"checkpoint-notes"},MZ={class:"checkpoint-notes-list"},AZ={__name:"CheckpointCard",props:{assignment:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},userLocation:{type:Object,default:null},toolbarActions:{type:Array,default:()=>[]},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},isCheckingIn:{type:Boolean,default:!1},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},isAreaLeadForCheckpoint:{type:Boolean,default:!1},expandedMarshalId:{type:String,default:null},notes:{type:Array,default:()=>[]},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},areaLeadAreaIds:{type:Array,default:()=>[]},allAssignmentLocationIds:{type:Array,default:()=>[]}},emits:["toggle","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update","show-marshal-qr"],setup(e,{expose:t}){const{terms:n,termsLower:a}=ht(),o=$o("marshalBranding",{headerStyle:{},headerTextColor:""}),i=ul({headerStyle:z(()=>au(o.headerStyle)),headerTextColor:z(()=>au(o.headerTextColor))}),l=e,c=P(null),d=z(()=>l.assignment.location?.isDynamic),h=z(()=>{const w=l.assignment.location?.name||l.assignment.locationName,_=l.assignment.location?.description;return _?`${w}  ${_}`:w}),f=z(()=>{if(!d.value)return!1;const w=l.assignment.location,_=w?.locationUpdateScopeConfigurations||w?.LocationUpdateScopeConfigurations||[];return Ky({scopeConfigurations:_,marshalId:l.currentMarshalId,marshalAssignmentLocationIds:l.allAssignmentLocationIds,areaLeadAreaIds:l.areaLeadAreaIds,locationId:l.assignment.locationId,locationAreaIds:l.assignment.areaIds||[]})}),m=z(()=>{if(!l.userLocation?.lat||!l.userLocation?.lng)return null;const w=l.assignment.location;return!w?.latitude||!w?.longitude?null:dl(l.userLocation.lat,l.userLocation.lng,w.latitude,w.longitude)}),y=z(()=>{const w=m.value;return w==null?null:w<1e3?`${Math.round(w/10)*10} m`:`${(Math.round(w/100)/10).toFixed(1)} km`});t({mapRef:c});const k=w=>{const _=w?.iconType||"checkpoint",I=w?.iconColor||"#667eea",T={checkpoint:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>`,flag:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"/></svg>`,star:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>`,water:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M12 2c-5.33 4.55-8 8.48-8 11.8 0 4.98 3.8 8.2 8 8.2s8-3.22 8-8.2c0-3.32-2.67-7.25-8-11.8z"/></svg>`,medical:`<svg viewBox="0 0 24 24" fill="${I}" width="20" height="20"><path d="M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4v4z"/></svg>`};return T[_]||T.checkpoint},S=(w,_)=>{const I=T=>T?new Date(T).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"";return w&&_?`${I(w)} - ${I(_)}`:w?`from ${I(w)}`:_?`until ${I(_)}`:""},x=w=>w?new Date(w).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}):"",E=w=>({manual:"Manual",qr:"QR Code",gps:"GPS",admin:"Admin"})[w]||w,$=w=>w?new Date(w).toLocaleString():"";return(w,_)=>(p(),g("div",PW,[r("button",{class:le(["checkpoint-accordion-header",{active:e.isExpanded,"checked-in":e.assignment.effectiveIsCheckedIn}]),onClick:_[0]||(_[0]=I=>w.$emit("toggle"))},[r("div",DW,[r("div",RW,[r("span",{class:"checkpoint-icon",innerHTML:k(e.assignment.location)},null,8,OW),e.assignment.effectiveIsCheckedIn?(p(),g("span",BW,"")):D("",!0),r("span",NW,b(e.assignment.location?.name||e.assignment.locationName),1),e.assignment.areaName?(p(),g("span",FW,b(e.assignment.areaName),1)):D("",!0),e.assignment.location?.startTime||e.assignment.location?.endTime?(p(),g("span",UW,b(S(e.assignment.location.startTime,e.assignment.location.endTime)),1)):D("",!0),y.value?(p(),g("span",zW,b(y.value),1)):D("",!0)]),e.assignment.location?.description?(p(),g("div",HW,b(e.assignment.location.description),1)):D("",!0)]),r("span",VW,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",GW,[e.assignment.location?(p(),g("div",qW,[Ee(hl,{ref_key:"mapRef",ref:c,locations:e.allLocations,route:e.route,center:{lat:e.assignment.location.latitude,lng:e.assignment.location.longitude},zoom:16,"user-location":e.userLocation,"highlight-location-id":e.assignment.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:e.hasDynamicAssignment,"show-fullscreen":!0,"fullscreen-title":h.value,"fullscreen-header-style":i.headerStyle,"fullscreen-header-text-color":i.headerTextColor,"toolbar-actions":e.toolbarActions,"hide-recenter-button":!0,height:"280px",onMapClick:_[2]||(_[2]=I=>w.$emit("map-click",I)),onLocationClick:_[3]||(_[3]=I=>w.$emit("location-click",I)),onActionClick:_[4]||(_[4]=I=>w.$emit("action-click",I)),onVisibilityChange:_[5]||(_[5]=I=>w.$emit("visibility-change",I))},yf({_:2},[f.value?{name:"fullscreen-footer",fn:Ue(()=>[r("button",{class:"btn btn-primary",onClick:_[1]||(_[1]=I=>w.$emit("update-location"))},[(p(),g("svg",jW,[..._[9]||(_[9]=[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"},null,-1)])])),_[10]||(_[10]=Je(" Update location ",-1))])]),key:"0"}:void 0]),1032,["locations","route","center","user-location","highlight-location-id","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions"])])):D("",!0),r("div",WW,[Ee(wu,{"is-checked-in":e.assignment.effectiveIsCheckedIn,"check-in-time":e.assignment.checkInTime,"check-in-method":e.assignment.checkInMethod,"checked-in-by":e.assignment.checkedInBy,"marshal-name":e.currentMarshalName,"is-loading":e.isCheckingIn,onToggle:_[6]||(_[6]=I=>w.$emit("check-in"))},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading"]),e.checkInError?(p(),g("div",ZW,b(e.checkInError),1)):D("",!0)]),d.value?(p(),g("div",KW,[r("div",YW,[r("span",JW,"Dynamic "+b(e.assignment.location.resolvedCheckpointTerm||N(a).checkpoint),1),e.assignment.location.lastLocationUpdate?(p(),g("span",XW," Last updated: "+b($(e.assignment.location.lastLocationUpdate)),1)):D("",!0)]),f.value?(p(),g("div",QW,[r("button",{onClick:_[7]||(_[7]=I=>w.$emit("update-location")),class:"btn btn-update-location",disabled:e.updatingLocation},[..._[11]||(_[11]=[r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1),Je(" Update location ",-1)])],8,eZ),r("button",{onClick:_[8]||(_[8]=I=>w.$emit("toggle-auto-update")),class:le(["btn btn-auto-update",{active:e.autoUpdateEnabled}]),title:e.autoUpdateEnabled?"Stop auto-updating":"Auto-update every 60 seconds"},[_[12]||(_[12]=r("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})],-1)),Je(" "+b(e.autoUpdateEnabled?"Stop":"Auto"),1)],10,tZ)])):D("",!0)])):D("",!0),r("div",nZ,[r("div",oZ,b(N(n).people)+":",1),e.isAreaLeadForCheckpoint?(p(),g("div",iZ,[(p(!0),g(xe,null,qe(e.assignment.allMarshals,I=>(p(),g("div",{key:I.marshalId,class:le(["marshal-card-mini",{"is-you":I.marshalId===e.currentMarshalId,"checked-in":I.effectiveIsCheckedIn,expanded:e.expandedMarshalId===I.marshalId}])},[r("button",{class:"marshal-card-header",onClick:T=>w.$emit("toggle-marshal",I.marshalId)},[r("span",rZ,b(I.marshalName)+b(I.marshalId===e.currentMarshalId?" (you)":""),1),r("span",cZ,[I.effectiveIsCheckedIn?(p(),g("span",uZ,"")):D("",!0),r("span",dZ,b(e.expandedMarshalId===I.marshalId?"":"+"),1)])],8,lZ),e.expandedMarshalId===I.marshalId?(p(),g("div",hZ,[r("div",fZ,[_[13]||(_[13]=r("span",{class:"detail-label"},"Status:",-1)),r("span",{class:le(I.effectiveIsCheckedIn?"status-checked-in":"status-not-checked-in")},b(I.effectiveIsCheckedIn?"Checked in":"Not checked in"),3)]),I.effectiveIsCheckedIn&&I.checkInTime?(p(),g("div",pZ,[_[14]||(_[14]=r("span",{class:"detail-label"},"Check-in time:",-1)),r("span",null,b(x(I.checkInTime)),1)])):D("",!0),I.checkInMethod?(p(),g("div",vZ,[_[15]||(_[15]=r("span",{class:"detail-label"},"Method:",-1)),r("span",null,b(E(I.checkInMethod)),1)])):D("",!0),I.email?(p(),g("div",mZ,[_[16]||(_[16]=r("span",{class:"detail-label"},"Email:",-1)),r("a",{href:"mailto:"+I.email},b(I.email),9,gZ)])):D("",!0),I.phoneNumber?(p(),g("div",yZ,[_[17]||(_[17]=r("span",{class:"detail-label"},"Phone:",-1)),r("a",{href:"tel:"+I.phoneNumber},b(I.phoneNumber),9,kZ)])):D("",!0),I.email||I.phoneNumber?(p(),g("div",bZ,[I.phoneNumber?(p(),g("a",{key:0,href:"tel:"+I.phoneNumber,class:"btn btn-sm btn-primary"},"Call",8,_Z)):D("",!0),I.phoneNumber?(p(),g("a",{key:1,href:"sms:"+I.phoneNumber,class:"btn btn-sm btn-secondary"},"Text",8,wZ)):D("",!0),I.email?(p(),g("a",{key:2,href:"mailto:"+I.email,class:"btn btn-sm btn-secondary"},"Email",8,CZ)):D("",!0)])):D("",!0),I.marshalId!==e.currentMarshalId?(p(),g("div",LZ,[Ee(wu,{"is-checked-in":I.effectiveIsCheckedIn,"check-in-time":I.checkInTime,"check-in-method":I.checkInMethod,"checked-in-by":I.checkedInBy,"marshal-name":I.marshalName,"is-loading":e.checkingInMarshalId===I.id,onToggle:T=>w.$emit("marshal-check-in",I)},null,8,["is-checked-in","check-in-time","check-in-method","checked-in-by","marshal-name","is-loading","onToggle"]),r("button",{class:"btn btn-secondary btn-qr-icon",onClick:ct(T=>w.$emit("show-marshal-qr",I),["stop"]),title:"Show QR code for magic link"},[..._[18]||(_[18]=[fi('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-3b247184><rect x="3" y="3" width="7" height="7" data-v-3b247184></rect><rect x="14" y="3" width="7" height="7" data-v-3b247184></rect><rect x="3" y="14" width="7" height="7" data-v-3b247184></rect><rect x="14" y="14" width="3" height="3" data-v-3b247184></rect><rect x="19" y="14" width="2" height="2" data-v-3b247184></rect><rect x="14" y="19" width="2" height="2" data-v-3b247184></rect><rect x="19" y="19" width="2" height="2" data-v-3b247184></rect></svg>',1)])],8,SZ)])):D("",!0)])):D("",!0)],2))),128))])):(p(),g("div",aZ,[(p(!0),g(xe,null,qe(e.assignment.allMarshals,I=>(p(),g("span",{key:I.marshalId,class:le(["marshal-tag",{"is-you":I.marshalId===e.currentMarshalId,"checked-in":I.effectiveIsCheckedIn}])},[Je(b(I.marshalName)+b(I.marshalId===e.currentMarshalId?" (you)":"")+" ",1),I.effectiveIsCheckedIn?(p(),g("span",sZ,"")):D("",!0)],2))),128))]))]),e.assignment.areaContacts.length>0?(p(),g("div",IZ,[r("div",xZ,b(N(n).area)+" contacts:",1),r("div",$Z,[(p(!0),g(xe,null,qe(e.assignment.areaContacts,I=>(p(),ze(C1,{key:I.marshalId,name:I.marshalName,role:I.role,phone:I.phone,email:I.email},null,8,["name","role","phone","email"]))),128))])])):D("",!0),e.notes.length>0?(p(),g("div",TZ,[_[19]||(_[19]=r("div",{class:"marshals-label"},"Notes:",-1)),r("div",MZ,[(p(!0),g(xe,null,qe(e.notes,I=>(p(),ze(EW,{key:I.noteId,title:I.title,content:I.content,priority:I.priority,"is-pinned":I.isPinned},null,8,["title","content","priority","is-pinned"]))),128))])])):D("",!0)])):D("",!0)]))}},EZ=Ze(AZ,[["__scopeId","data-v-3b247184"]]),PZ={class:"accordion-section"},DZ={class:"accordion-title"},RZ=["innerHTML"],OZ={class:"accordion-icon"},BZ={key:0,class:"accordion-content assignments-accordion-content"},NZ={key:0,class:"empty-state"},FZ={key:1,class:"checkpoint-accordion"},UZ={__name:"MarshalAssignmentsSection",props:{isExpanded:{type:Boolean,default:!1},assignments:{type:Array,default:()=>[]},expandedCheckpointId:{type:String,default:null},allLocations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},userLocation:{type:Object,default:null},hasDynamicAssignment:{type:Boolean,default:!1},currentMarshalId:{type:String,default:""},currentMarshalName:{type:String,default:""},checkingInId:{type:String,default:null},checkingInAssignmentId:{type:String,default:null},checkInError:{type:String,default:""},checkingInMarshalId:{type:String,default:null},expandedMarshalId:{type:String,default:null},updatingLocation:{type:Boolean,default:!1},autoUpdateEnabled:{type:Boolean,default:!1},areaLeadAreaIds:{type:Array,default:()=>[]},getToolbarActions:{type:Function,default:()=>[]},isAreaLeadForAreas:{type:Function,default:()=>!1},getNotesForCheckpoint:{type:Function,default:()=>[]}},emits:["toggle","toggle-checkpoint","map-click","location-click","action-click","visibility-change","update-location","check-in","toggle-marshal","marshal-check-in","toggle-auto-update","show-marshal-qr"],setup(e,{expose:t}){const{termsLower:n}=ht(),a=e,o=z(()=>a.assignments.map(c=>c.locationId)),i={},l=(c,d)=>{d?i[c]=d:delete i[c]};return t({checkpointRefs:i}),(c,d)=>(p(),g("div",PZ,[r("button",{class:le(["accordion-header",{active:e.isExpanded}]),onClick:d[0]||(d[0]=h=>c.$emit("toggle"))},[r("span",DZ,[r("span",{class:"section-icon",innerHTML:N(bo)("checkpoint")},null,8,RZ),Je(" Your "+b(e.assignments.length===1?N(n).checkpoint:N(n).checkpoints)+b(e.assignments.length>1?` (${e.assignments.length})`:""),1)]),r("span",OZ,b(e.isExpanded?"":"+"),1)],2),e.isExpanded?(p(),g("div",BZ,[e.assignments.length===0?(p(),g("div",NZ,[r("p",null,"You don't have any "+b(N(n).checkpoint)+" assignments yet.",1)])):(p(),g("div",FZ,[(p(!0),g(xe,null,qe(e.assignments,h=>(p(),ze(EZ,{key:h.id,ref_for:!0,ref:f=>l(h.id,f),assignment:h,"is-expanded":e.expandedCheckpointId===h.id,"all-locations":e.allLocations,route:e.route,"user-location":e.userLocation,"toolbar-actions":e.getToolbarActions(h.id),"has-dynamic-assignment":e.hasDynamicAssignment,"current-marshal-id":e.currentMarshalId,"current-marshal-name":e.currentMarshalName,"is-checking-in":e.checkingInId===h.id,"check-in-error":e.checkingInAssignmentId===h.id?e.checkInError:"","checking-in-marshal-id":e.checkingInMarshalId,"is-area-lead-for-checkpoint":e.isAreaLeadForAreas(h.areaIds),"expanded-marshal-id":e.expandedMarshalId,notes:e.getNotesForCheckpoint(h.locationId,h.areaIds),"updating-location":e.updatingLocation,"auto-update-enabled":e.autoUpdateEnabled,"area-lead-area-ids":e.areaLeadAreaIds,"all-assignment-location-ids":o.value,onToggle:f=>c.$emit("toggle-checkpoint",h.id),onMapClick:d[1]||(d[1]=f=>c.$emit("map-click",f)),onLocationClick:d[2]||(d[2]=f=>c.$emit("location-click",f)),onActionClick:f=>c.$emit("action-click",h,f),onVisibilityChange:f=>c.$emit("visibility-change",h.id,f),onUpdateLocation:f=>c.$emit("update-location",h),onCheckIn:f=>c.$emit("check-in",h),onToggleMarshal:d[3]||(d[3]=f=>c.$emit("toggle-marshal",f)),onMarshalCheckIn:f=>c.$emit("marshal-check-in",f,h.locationId),onToggleAutoUpdate:f=>c.$emit("toggle-auto-update",h),onShowMarshalQr:d[4]||(d[4]=f=>c.$emit("show-marshal-qr",f))},null,8,["assignment","is-expanded","all-locations","route","user-location","toolbar-actions","has-dynamic-assignment","current-marshal-id","current-marshal-name","is-checking-in","check-in-error","checking-in-marshal-id","is-area-lead-for-checkpoint","expanded-marshal-id","notes","updating-location","auto-update-enabled","area-lead-area-ids","all-assignment-location-ids","onToggle","onActionClick","onVisibilityChange","onUpdateLocation","onCheckIn","onMarshalCheckIn","onToggleAutoUpdate"]))),128))]))])):D("",!0)]))}},zZ=Ze(UZ,[["__scopeId","data-v-2f49c5ae"]]),L1="marshal-branding-cache";function HZ(e){if(!e||typeof window>"u")return null;try{const t=localStorage.getItem(`${L1}-${e}`);return t?JSON.parse(t):null}catch{return null}}function VZ(e,t){if(!(!e||typeof window>"u"))try{localStorage.setItem(`${L1}-${e}`,JSON.stringify(t))}catch{}}function GZ(e,t=null){const n=P(t?HZ(t):null);Ye(()=>e.value,y=>{if(y&&t){const k={brandingPageGradientStart:y.brandingPageGradientStart,brandingPageGradientEnd:y.brandingPageGradientEnd,brandingHeaderGradientStart:y.brandingHeaderGradientStart,brandingHeaderGradientEnd:y.brandingHeaderGradientEnd,brandingAccentColor:y.brandingAccentColor,brandingLogoUrl:y.brandingLogoUrl,brandingLogoPosition:y.brandingLogoPosition};VZ(t,k),n.value=k}},{immediate:!0});const a=(y,k)=>e.value?.[y]||n.value?.[y]||k,o=z(()=>{const y=a("brandingPageGradientStart",Sn.pageGradientStart),k=a("brandingPageGradientEnd",Sn.pageGradientEnd);return{background:`linear-gradient(135deg, ${y} 0%, ${k} 100%)`}}),i=z(()=>{const y=a("brandingHeaderGradientStart",Sn.headerGradientStart),k=a("brandingHeaderGradientEnd",Sn.headerGradientEnd);return{background:`linear-gradient(135deg, ${y} 0%, ${k} 100%)`}}),l=z(()=>{const y=a("brandingHeaderGradientStart",Sn.headerGradientStart),k=a("brandingHeaderGradientEnd",Sn.headerGradientEnd);return f1(y,k)}),c=z(()=>a("brandingAccentColor",Sn.accentColor)),d=z(()=>nf(c.value)),h=z(()=>({background:c.value,color:d.value})),f=z(()=>{const y=a("brandingLogoUrl","");return y?y.startsWith("/api")?ai+y.substring(4):y:""}),m=z(()=>a("brandingLogoPosition","left"));return{pageBackgroundStyle:o,headerStyle:i,headerTextColor:l,accentColor:c,accentTextColor:d,accentButtonStyle:h,brandingLogoUrl:f,brandingLogoPosition:m}}function qZ(){const e=P(null),t=P(null);let n=null;const a=()=>{if(!("geolocation"in navigator)){console.warn("Geolocation not supported");return}console.log("Starting location tracking..."),n=navigator.geolocation.watchPosition(i=>{e.value={lat:i.coords.latitude,lng:i.coords.longitude},t.value=Date.now()},i=>{console.warn("Geolocation error:",{1:"Location permission denied. Please allow location access in your browser settings.",2:"Location unavailable. Make sure GPS is enabled on your device.",3:"Location request timed out. Please try again."}[i.code]||i.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},o=()=>{n!==null&&(navigator.geolocation.clearWatch(n),n=null)};return An(()=>{o()}),{userLocation:e,locationLastUpdated:t,startLocationTracking:a,stopLocationTracking:o}}function jZ({eventId:e,currentMarshalId:t,currentPerson:n,assignments:a,areaLeadAreaIds:o,isAreaLead:i,allLocations:l,areas:c,terms:d,termsLower:h,areaLeadRef:f,areaLeadCheckpoints:m,sectionLastLoadedAt:y,updateCachedField:k,updatePendingCount:S}){const x=P([]),E=P(!1),$=P(null),w=P(!1),_=P("person"),I=P(null),T=z(()=>x.value.filter(U=>U.isCompleted&&["OnePerCheckpoint","OnePerArea","OneLeadPerArea"].includes(U.matchedScope)?U.completedByActorId===t.value:!0)),B=z(()=>T.value.filter(U=>U.isCompleted).length),M=z(()=>{const U=a.value.map(Q=>Q.locationId);return T.value.filter(Q=>Q.completionContextType==="Personal"?Q.contextOwnerMarshalId===t.value:Q.completionContextType==="Checkpoint"?U.includes(Q.completionContextId):Q.completionContextType==="Area"?o.value.includes(Q.completionContextId):!0)}),R=z(()=>{if(!i.value)return[];const U=a.value.map(Q=>Q.locationId);return T.value.filter(Q=>Q.completionContextType==="Personal"?Q.contextOwnerMarshalId!==t.value:Q.completionContextType==="Checkpoint"?!U.includes(Q.completionContextId):Q.completionContextType==="Area"?!o.value.includes(Q.completionContextId):!1)}),A=z(()=>M.value.map(U=>({...U,localIsCompleted:U.isCompleted,isModified:!1})).sort((U,Q)=>(U.displayOrder||0)-(Q.displayOrder||0))),G=z(()=>R.value.map(U=>({...U,localIsCompleted:U.isCompleted,isModified:!1})).sort((U,Q)=>(U.displayOrder||0)-(Q.displayOrder||0))),F=z(()=>{const U=f.value?.checkpoints||m.value||[];if(U.length===0)return[];const Q=[],oe=new Set;for(const he of U)for(const Te of he.marshals||[])oe.has(Te.marshalId)||(oe.add(Te.marshalId),Q.push(Te));return Q}),j=z(()=>{if(i.value)return"none";const U=T.value,Q=new Set;for(const oe of U)oe.completionContextType==="Checkpoint"&&oe.completionContextId&&Q.add(oe.completionContextId);return Q.size>1?"checkpoint":"none"}),K=z(()=>{const U=T.value,Q={};for(const oe of U){let he,Te;oe.completionContextType==="Checkpoint"&&oe.completionContextId?(he=`checkpoint_${oe.completionContextId}`,Te=l.value.find(He=>He.id===oe.completionContextId)?.name||"Unknown "+d.value.checkpoint):oe.completionContextType==="Area"&&oe.completionContextId?(he=`area_${oe.completionContextId}`,Te=c.value.find(He=>He.id===oe.completionContextId)?.name||"Unknown "+d.value.area):(he="personal",Te="Personal"),Q[he]||(Q[he]={key:he,name:Te,items:[],completedCount:0}),Q[he].items.push(oe),oe.isCompleted&&Q[he].completedCount++}for(const oe of Object.values(Q))oe.items.sort((he,Te)=>{const je=he.displayOrder||0,He=Te.displayOrder||0;return je-He});return Object.values(Q).sort((oe,he)=>oe.name.localeCompare(he.name,void 0,{numeric:!0,sensitivity:"base"}))}),J=U=>{I.value=I.value===U?null:U},ue=U=>{if(!U.completionContextType||!U.completionContextId)return null;if(U.completionContextType==="Checkpoint"){const Q=l.value.find(he=>he.id===U.completionContextId);if(!Q)return null;const oe=Q.description?` - ${Q.description}`:"";return`At ${h.value.checkpoint} ${Q.name}${oe}`}if(U.completionContextType==="Area"){const Q=c.value.find(oe=>oe.id===U.completionContextId);return Q?`At ${h.value.area} ${Q.name}`:null}return U.completionContextType==="Personal"?"Personal item":null},Z=async(U=!1)=>{if(!t.value){console.warn("No marshal ID, skipping checklist load");return}U||(E.value=!0),$.value=null;try{const Q=e.value;console.log("Fetching checklist for marshal:",t.value);let he=(await Nt.getMarshalChecklist(Q,t.value)).data||[];if(i.value&&o.value.length>0){console.log("Fetching area checklists for areas:",o.value);const Te=o.value.map(We=>Nt.getAreaChecklist(Q,We).catch(be=>(console.warn(`Failed to fetch checklist for area ${We}:`,be),{data:[]}))),je=await Promise.all(Te),He=new Map;for(const We of he){const be=`${We.itemId}_${We.completionContextType}_${We.completionContextId}`;He.set(be,We)}for(const We of je)for(const be of We.data||[]){const V=`${be.itemId}_${be.completionContextType}_${be.completionContextId}`;He.has(V)||He.set(V,be)}he=Array.from(He.values()),console.log("Merged checklist items:",he.length)}x.value=he,y?.value&&(y.value.checklist=Date.now()),console.log("Checklist loaded:",x.value.length,"items")}catch(Q){console.error("Failed to load checklist:",Q.response?.status,Q.response?.data),$.value=Q.response?.data?.message||"Failed to load checklist"}finally{U||(E.value=!1)}};return{checklistItems:x,checklistLoading:E,checklistError:$,savingChecklist:w,checklistGroupBy:_,expandedChecklistGroup:I,visibleChecklistItems:T,completedChecklistCount:B,myChecklistItems:M,areaChecklistItems:R,myChecklistItemsWithLocalState:A,areaChecklistItemsWithLocalState:G,areaMarshalsForChecklist:F,effectiveChecklistGroupBy:j,groupedChecklistItems:K,loadChecklist:Z,handleToggleChecklist:async U=>{if(w.value)return;w.value=!0;const Q=e.value,oe={marshalId:U.contextOwnerMarshalId||t.value,contextType:U.completionContextType,contextId:U.completionContextId,actorMarshalId:t.value};try{if(U.isCompleted)if(Jn())await Fo("checklist_uncomplete",{eventId:Q,itemId:U.itemId,data:oe}),U.isCompleted=!1,U.completedAt=null,U.completedByActorName=null,S&&await S();else{if(await Nt.uncomplete(Q,U.itemId,oe),U.linksToCheckIn&&U.linkedCheckpointId){const he=a.value.find(Te=>Te.locationId===U.linkedCheckpointId);he&&(he.isCheckedIn=!1,he.checkedInAt=null,console.log(`Linked check-out: Checked out from ${U.linkedCheckpointName||"checkpoint"}`))}await Z(!0)}else if(Jn())await Fo("checklist_complete",{eventId:Q,itemId:U.itemId,data:oe}),U.isCompleted=!0,U.completedAt=new Date().toISOString(),U.completedByActorName=n.value?.name||"You",S&&await S();else{const he=await Nt.complete(Q,U.itemId,oe);if(he.data?.linkedCheckIn){const Te=he.data.linkedCheckIn,je=a.value.find(He=>He.locationId===Te.locationId||He.id===Te.assignmentId||He.assignmentId===Te.assignmentId);je?(je.isCheckedIn=!0,je.checkedInAt=Te.checkedInAt,console.log(`Linked check-in: Checked in at ${Te.locationName}`)):console.warn("Could not find assignment for linked check-in:",Te)}await Z(!0)}k&&await k(Q,"checklist",JSON.parse(JSON.stringify(x.value)))}catch(he){if(console.error("Failed to toggle checklist item:",he),Jn()||!he.response){const Te=U.isCompleted?"checklist_uncomplete":"checklist_complete";await Fo(Te,{eventId:Q,itemId:U.itemId,data:oe}),U.isCompleted?(U.isCompleted=!1,U.completedAt=null,U.completedByActorName=null):(U.isCompleted=!0,U.completedAt=new Date().toISOString(),U.completedByActorName=n.value?.name||"You"),S&&await S(),k&&await k(Q,"checklist",JSON.parse(JSON.stringify(x.value)))}}finally{w.value=!1}},toggleChecklistGroup:J,getContextName:ue}}function WZ({eventId:e,allLocations:t,userLocation:n,locationLastUpdated:a}){const o=P(!1),i=P(null),l=P(null),c=P(null),d=P(!1),h=P(!1),f=P(!1);let m=null,y=null,k=null;const S=U=>U?.isDynamic===!0||U?.IsDynamic===!0,x=(U,Q,oe,he)=>{const Te=t.value.find(je=>je.id===U);Te&&(Te.latitude=Q,Te.longitude=oe,Te.lastLocationUpdate=he)},E=U=>{i.value=U,l.value=null,c.value=null,o.value=!0},$=()=>{o.value=!1,i.value=null,l.value=null,c.value=null,f.value=!1},w=()=>{o.value=!1,f.value=!0},_=()=>{f.value=!1,o.value=!0},I=async(U,Q,oe,he,Te=null)=>{d.value=!0;try{const je=e.value,He={latitude:Q,longitude:oe,sourceType:he};Te&&(He.sourceCheckpointId=Te);const We=await Xn.updatePosition(je,U,He);We.data.success&&(h.value&&G(),x(U,We.data.latitude,We.data.longitude,We.data.lastLocationUpdate))}catch(je){console.error("Failed to update location:",je),je.response?.status===403?alert("You do not have permission to update this location."):alert("Failed to update location. Please try again.")}finally{d.value=!1}},T=async()=>{if(i.value){d.value=!0,l.value=null;try{let U,Q;if(n.value&&a?.value&&Date.now()-a.value<3e4&&(U=n.value.lat,Q=n.value.lng),!U||!Q){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const je=await new Promise((He,We)=>{navigator.geolocation.getCurrentPosition(He,We,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4})});U=je.coords.latitude,Q=je.coords.longitude}const oe=e.value,he=i.value.locationId,Te=await Xn.updatePosition(oe,he,{latitude:U,longitude:Q,sourceType:"gps"});Te.data.success&&(c.value="Location updated successfully!",x(he,Te.data.latitude,Te.data.longitude,Te.data.lastLocationUpdate),setTimeout(()=>$(),1500))}catch(U){console.error("Failed to update location with GPS:",U),U.response?.status===403?l.value="You do not have permission to update this location.":U.code===1?l.value="Location access denied. Please enable location permissions.":U.code===2?l.value="Unable to determine your location. Please try again.":U.code===3||U.message?.includes("Timeout")?l.value="GPS timed out. Please ensure location services are enabled and try again.":l.value="Failed to update location. Please try again."}finally{d.value=!1}}},B=async U=>{if(!i.value)return;const Q=t.value.find(oe=>oe.id===U);if(!Q){l.value="Source checkpoint not found.";return}d.value=!0,l.value=null;try{const oe=e.value,he=i.value.locationId,Te=await Xn.updatePosition(oe,he,{latitude:Q.latitude,longitude:Q.longitude,sourceType:"checkpoint",sourceCheckpointId:U});Te.data.success&&(h.value&&G(),c.value=`Location copied from ${Q.name}!`,x(he,Te.data.latitude,Te.data.longitude,Te.data.lastLocationUpdate),setTimeout(()=>$(),1500))}catch(oe){console.error("Failed to copy location from checkpoint:",oe),oe.response?.status===403?l.value="You do not have permission to update this location.":l.value="Failed to update location. Please try again."}finally{d.value=!1}},M=async(U,Q)=>{if(i.value){d.value=!0,l.value=null;try{const oe=e.value,he=i.value.locationId,Te=await Xn.updatePosition(oe,he,{latitude:U,longitude:Q,sourceType:"manual"});Te.data.success&&(c.value="Location updated successfully!",x(he,Te.data.latitude,Te.data.longitude,Te.data.lastLocationUpdate),setTimeout(()=>$(),1500))}catch(oe){console.error("Failed to update location manually:",oe),oe.response?.status===403?l.value="You do not have permission to update this location.":l.value="Failed to update location. Please try again."}finally{d.value=!1}}},R=async U=>{if(!(!U||!("geolocation"in navigator)))try{const Q=await new Promise((Te,je)=>{navigator.geolocation.getCurrentPosition(Te,je,{enableHighAccuracy:!0,timeout:15e3})}),oe=e.value,he=U.locationId;await Xn.updatePosition(oe,he,{latitude:Q.coords.latitude,longitude:Q.coords.longitude,sourceType:"gps"},{skipLoadingOverlay:!0}),x(he,Q.coords.latitude,Q.coords.longitude,new Date().toISOString())}catch(Q){console.warn("Auto-update location failed:",Q)}},A=U=>{h.value=!0,R(U),m=setInterval(()=>{R(U)},6e4)},G=()=>{h.value=!1,m&&(clearInterval(m),m=null)},F=U=>{h.value?G():A(U)},j=()=>{y||!t.value.some(Q=>Q.isDynamic||Q.IsDynamic)||(y=setInterval(async()=>{try{const Q=e.value,oe=await Xn.getDynamicCheckpoints(Q,{skipLoadingOverlay:!0});if(oe.data&&Array.isArray(oe.data))for(const he of oe.data){const Te=t.value.find(je=>je.id===he.checkpointId);Te&&(Te.latitude=he.latitude,Te.longitude=he.longitude,Te.lastLocationUpdate=he.lastLocationUpdate)}}catch(Q){console.warn("Failed to poll dynamic checkpoints:",Q)}},6e4))},K=()=>{y&&(clearInterval(y),y=null)},J=async()=>{try{const U=e.value,Q=await Xn.getByEvent(U,{skipLoadingOverlay:!0});if(Q.data&&Array.isArray(Q.data))for(const oe of Q.data){const he=t.value.find(Te=>Te.id===oe.id);he&&(he.latitude=oe.latitude,he.longitude=oe.longitude,oe.lastLocationUpdate&&(he.lastLocationUpdate=oe.lastLocationUpdate))}}catch(U){console.warn("Failed to poll all checkpoint locations:",U)}};return{showLocationUpdateModal:o,updatingLocationFor:i,locationUpdateError:l,locationUpdateSuccess:c,updatingLocation:d,autoUpdateEnabled:h,selectingLocationOnMap:f,isDynamicCheckpoint:S,openLocationUpdateModal:E,closeLocationUpdateModal:$,startMapLocationSelect:w,cancelMapLocationSelect:_,updateDynamicCheckpointLocation:I,updateLocationWithGps:T,updateLocationFromCheckpoint:B,updateLocationManually:M,toggleAutoUpdate:F,startAutoUpdate:A,stopAutoUpdate:G,startDynamicCheckpointPolling:j,stopDynamicCheckpointPolling:K,startAllCheckpointsPolling:()=>{k||(J(),k=setInterval(J,6e4))},stopAllCheckpointsPolling:()=>{k&&(clearInterval(k),k=null)},handleMapClickForLocation:U=>{f.value&&i.value&&(I(i.value.locationId,U.lat,U.lng,"manual"),f.value=!1)}}}function ZZ({eventId:e,assignments:t,allLocations:n,areaLeadRef:a,areaLeadCheckpoints:o,areaLeadMarshalDataVersion:i,updatePendingCount:l,updateCachedField:c,reloadChecklist:d}){const{termsLower:h}=ht(),f=P(null),m=P(null),y=P(null),k=P(!1),S=P(null),x=P(new Set),E=P(!1),$=P(""),w=F=>{if(!F)return!0;const j=new Date(F);return(new Date-j)/(1e3*60*60)>24},_=F=>F?new Date(F).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",I=F=>{if(!F)return"";switch(F){case"GPS":return"GPS";case"Manual":return"Manual";case"AreaLead":return"By area lead";default:return F}},T=F=>{x.value.add(F),k.value=!1,S.value=null},B=()=>{E.value=!1,$.value=""},M=F=>F<1e3?`${Math.round(F/10)*10} m`:`${(Math.round(F/100)/10).toFixed(1)} km`,R=(F,j,K)=>{if(F==null||j==null)return;const J=n.value?.find(U=>U.id===K);if(!J)return;const ue=J.latitude,Z=J.longitude;if(ue==null||Z==null)return;const se=dl(F,j,ue,Z);if(se>50){const U=M(se);$.value=`Thanks for checking in. Just so you know, it's possible you are more than ${U} from your ${h.value.checkpoint} area.`,E.value=!0}},A=async(F,j=!0,K=null)=>{if(!F?.id){y.value="Cannot check in: Assignment ID is missing";return}f.value=F.id,m.value=F.id,y.value=null;const J=e.value;if(!J){y.value="Cannot check in: Event ID is missing",f.value=null,m.value=null;return}const ue=F.effectiveIsCheckedIn!==void 0?F.effectiveIsCheckedIn:F.isCheckedIn&&!w(F.checkInTime),Z=F.isCheckedIn&&!ue,se=ue?"check-out":Z?"refresh":"check-in",U=!ue;let Q=null,oe=null,he="Manual";if(j&&!ue&&"geolocation"in navigator)try{const je=await new Promise((He,We)=>{navigator.geolocation.getCurrentPosition(He,We,{enableHighAccuracy:!0,timeout:5e3})});Q=je.coords.latitude,oe=je.coords.longitude,he="GPS"}catch(je){console.log("GPS unavailable, using manual check-in:",je.message)}const Te={latitude:Q,longitude:oe,action:se};try{if(Jn()){await Fo("checkin_toggle",{eventId:J,assignmentId:F.id,gpsData:Te});const je=t.value.findIndex(He=>He.id===F.id);if(je!==-1&&(t.value[je]={...t.value[je],isCheckedIn:U,checkInTime:U?new Date().toISOString():null,checkInMethod:U?`${he} (pending)`:null,checkInLatitude:Q,checkInLongitude:oe}),K){const He=n.value.find(We=>We.id===K);if(He?.assignments){const We=He.assignments.find(be=>be.id===F.id||be.marshalId===F.marshalId);We&&(We.isCheckedIn=U,We.checkInTime=U?new Date().toISOString():null)}}l&&await l(),c&&await c(J,"locations",n.value)}else{const je=await di.toggleCheckIn(J,F.id,Te),He=je.data?.assignment||je.data,We=je.data?.linkedTasksCompleted||[],be=je.data?.linkedTasksUncompleted||0,V=t.value.findIndex(Y=>Y.id===F.id);if(V!==-1&&(t.value[V]=He),K){const Y=n.value.find(re=>re.id===K);if(Y?.assignments){const re=Y.assignments.find(ie=>ie.id===F.id||ie.marshalId===F.marshalId);re&&Object.assign(re,He)}}d&&We.length>0&&(console.log("Linked tasks completed via check-in:",We.length),await d(!0)),d&&be>0&&(console.log("Linked tasks uncompleted via check-out:",be),await d(!0))}if(K&&a?.value?.loadDashboard&&await a.value.loadDashboard(),i&&i.value++,U&&Q!=null&&oe!=null){const je=K||F.locationId;je&&R(Q,oe,je)}}catch(je){if(Jn()||!je.response){await Fo("checkin_toggle",{eventId:J,assignmentId:F.id,gpsData:Te});const He=t.value.findIndex(We=>We.id===F.id);He!==-1&&(t.value[He]={...t.value[He],isCheckedIn:U,checkInTime:U?new Date().toISOString():null,checkInMethod:U?"Manual (pending)":null}),l&&await l()}else je.response?.data?.message?y.value=je.response.data.message:je.message?y.value=je.message:y.value=`Failed to ${se}. Please try again.`}finally{f.value=null,m.value=null}};return{checkingIn:f,checkingInAssignment:m,checkInError:y,showCheckInReminderModal:k,checkInReminderCheckpoint:S,dismissedCheckInReminders:x,showDistanceWarning:E,distanceWarningMessage:$,isCheckInStale:w,formatCheckInTime:_,formatCheckInMethod:I,handleCheckInToggle:A,handleAreaLeadMarshalCheckIn:async F=>{const K=(a?.value?.checkpoints||o?.value||[]).find(Q=>Q.marshals?.some(oe=>oe.marshalId===F.marshalId));if(!K){console.error("Could not find checkpoint for marshal:",F);return}const J=K.marshals.find(Q=>Q.marshalId===F.marshalId);if(!J)return;const ue=J.assignmentId||J.id;if(!ue){console.error("No assignment ID found for marshal:",J);return}const Z=!F.isCheckedIn,se={id:ue,marshalId:F.marshalId,isCheckedIn:F.isCheckedIn,effectiveIsCheckedIn:F.isCheckedIn};await A(se,!1,K.checkpointId||K.locationId);const U=[a?.value?.checkpoints,o?.value].filter(Boolean);for(const Q of U)for(const oe of Q){const he=oe.marshals?.find(Te=>Te.marshalId===F.marshalId);he&&(he.isCheckedIn=Z,he.checkInTime=Z?new Date().toISOString():null,he.checkInMethod=Z?"AreaLead":null)}i&&i.value++},dismissCheckInReminder:T,dismissDistanceWarning:B}}function KZ({eventId:e,currentMarshalId:t,isAreaLead:n,areaLeadAreaIds:a,sectionLastLoadedAt:o,showMessage:i}){const l=P([]),c=P(!1),d=P(null),h=P(!1),f=P(!1),m=P(""),y=P(!1),k=P(!1),S=P(!1),x=z(()=>l.value.filter(R=>R.status==="open"||R.status==="acknowledged"||R.status==="in_progress").length),E=async()=>{const R=e.value;c.value=!0;try{const A=new Map;if(n.value&&a.value.length>0)for(const G of a.value)try{const j=(await Wa.getForArea(R,G)).data.incidents||[];for(const K of j)A.set(K.incidentId,K)}catch(F){console.warn(`Failed to load incidents for area ${G}:`,F)}try{const F=(await Wa.getAll(R)).data.incidents||[];for(const j of F)j.reportedBy?.marshalId===t.value&&A.set(j.incidentId,j)}catch(G){console.debug("Could not load all incidents:",G)}l.value=Array.from(A.values()).sort((G,F)=>new Date(F.incidentTime||F.createdAt)-new Date(G.incidentTime||G.createdAt)),o?.value&&(o.value.incidents=Date.now()),console.log("My incidents loaded:",l.value.length)}catch(A){console.error("Failed to load incidents:",A)}finally{c.value=!1}},$=async R=>{S.value=!0;try{await Wa.create(e.value,R),k.value=!1,E(),i&&i("Incident Reported","An administrator will review it shortly.")}catch(A){console.error("Failed to report incident:",A),i&&i("Error",A.response?.data?.message||"Failed to report incident. Please try again.")}finally{S.value=!1}},w=R=>{d.value=R,h.value=!0},_=()=>{h.value=!1,d.value=null},I=async({incidentId:R,status:A})=>{try{await Wa.updateStatus(e.value,R,{status:A});const G=l.value.find(F=>F.incidentId===R);G&&(G.status=A),d.value?.incidentId===R&&(d.value.status=A)}catch(G){console.error("Failed to update incident status:",G),i&&i("Error","Failed to update status. Please try again.")}},T=()=>{m.value="",f.value=!0},B=()=>{f.value=!1,m.value=""};return{myIncidents:l,incidentsLoading:c,selectedIncident:d,showIncidentDetail:h,showAddIncidentNoteModal:f,incidentNoteText:m,submittingIncidentNote:y,showReportIncident:k,reportingIncident:S,openIncidentsCount:x,loadMyIncidents:E,handleReportIncident:$,openIncidentDetail:w,closeIncidentDetail:_,handleIncidentStatusChange:I,openAddIncidentNoteModal:T,closeAddIncidentNoteModal:B,submitIncidentNote:async()=>{if(!(!m.value.trim()||!d.value)){y.value=!0;try{await Wa.addNote(e.value,d.value.incidentId,m.value.trim()),B(),E();const R=await Wa.get(e.value,d.value.incidentId);d.value=R.data}catch(R){console.error("Failed to add note:",R),i&&i("Error","Failed to add note. Please try again.")}finally{y.value=!1}}}}}const km='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><circle cx="12" cy="12" r="4"/><path d="M13 4.069V2h-2v2.069A8.01 8.01 0 0 0 4.069 11H2v2h2.069A8.008 8.008 0 0 0 11 19.931V22h2v-2.069A8.007 8.007 0 0 0 19.931 13H22v-2h-2.069A8.008 8.008 0 0 0 13 4.069zM12 18c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6z"/></svg>',bm='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>',YZ='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="18" height="18"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>',JZ='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="18" height="18"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>';function XZ({userLocation:e,assignmentsWithDetails:t,courseMapRef:n}){const{termsLower:a}=ht(),o=P({userLocationInView:!1,highlightedLocationInView:!1,highlightedLocationsVisibility:{}}),i=P(!1),l=P(-1),c=P({}),d={},h=z(()=>t.value.filter($=>$.location?.latitude&&$.location?.longitude&&!($.location.latitude===0&&$.location.longitude===0))),f=z(()=>{const $=[];return $.push({id:"toggle-other-checkpoints",label:i.value?"Show all "+a.value.checkpoints:"Show only mine",icon:"custom",customIcon:i.value?YZ:JZ}),e.value&&!o.value.userLocationInView&&$.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:km}),h.value.length>0&&!o.value.highlightedLocationInView&&$.push({id:"recenter-checkpoint",label:"My "+a.value.checkpoint,icon:"custom",customIcon:bm}),$}),m=$=>{const w=o.value,_=w.userLocationInView!==$.userLocationInView||w.highlightedLocationInView!==$.highlightedLocationInView,I=JSON.stringify(w.highlightedLocationsVisibility)!==JSON.stringify($.highlightedLocationsVisibility||{});(_||I)&&(o.value={...$,highlightedLocationsVisibility:$.highlightedLocationsVisibility||{}})},y=()=>{const $=h.value;if($.length===0)return null;if($.length===1)return l.value=0,$[0];const w=o.value.highlightedLocationsVisibility||{},_=[];for(let B=0;B<$.length;B++){const M=$[B].locationId;w[M]===!1&&_.push(B)}if(_.length===0)return l.value=0,$[0];if(_.length===1)return l.value=_[0],$[_[0]];const I=l.value;let T=-1;for(const B of _)if(B>I){T=B;break}return T===-1&&(T=_[0]),l.value=T,$[T]};return{courseMapVisibility:o,courseMapActions:f,hideOtherCheckpoints:i,handleCourseMapVisibilityChange:m,handleCourseMapAction:({actionId:$})=>{if($==="toggle-other-checkpoints")i.value=!i.value;else if($==="recenter-user"&&e.value)n.value?.recenterOnUserLocation();else if($==="recenter-checkpoint"){const w=y();w?.location&&n.value?.recenterOnLocation(w.location.latitude,w.location.longitude)}},checkpointMapVisibility:c,checkpointMapRefs:d,getCheckpointMapActions:$=>{const w=[],_=c.value[$]||{userLocationInView:!1,highlightedLocationInView:!1};return e.value&&!_.userLocationInView&&w.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:km}),_.highlightedLocationInView||w.push({id:"recenter-checkpoint",label:a.value.checkpoint.charAt(0).toUpperCase()+a.value.checkpoint.slice(1),icon:"custom",customIcon:bm}),w},handleCheckpointMapVisibilityChange:($,w)=>{const _=c.value[$];(!_||_.userLocationInView!==w.userLocationInView||_.highlightedLocationInView!==w.highlightedLocationInView)&&(c.value={...c.value,[$]:w})},handleCheckpointMapAction:($,{actionId:w})=>{const _=d[$.id];w==="recenter-user"&&e.value?_?.recenterOnUserLocation():w==="recenter-checkpoint"&&$.location&&_?.recenterOnLocation($.location.latitude,$.location.longitude)}}}function QZ({eventId:e,currentMarshalId:t,areaLeadRef:n,areaLeadCheckpoints:a,areaChecklistItems:o,myChecklistItems:i,areaLeadAreaIds:l,loadChecklist:c}){const d=P(null),h=P(!1),f=P(0),m=S=>{d.value=d.value===S?null:S},y=z(()=>{f.value;const S=n?.value?.checkpoints,x=a?.value,E=S?.length>0?S:x||[],$=o?.value||[],w=i?.value||[],_=[...$,...w],I=new Map;for(const B of E){const M=B.marshals||B.Marshals||[],R=B.checkpointId||B.CheckpointId,A=B.name||B.Name,G=B.description||B.Description,F=B.areaIds||B.AreaIds||[];for(const j of M){const K=j.marshalId||j.MarshalId;if(!K)continue;I.has(K)||I.set(K,{...j,marshalId:K,checkpoints:[],checkpointIds:new Set,areaIds:new Set,allTasks:[],totalTaskCount:0,completedTaskCount:0});const J=I.get(K);J.checkpoints.push({checkpointId:R,name:A,description:G}),J.checkpointIds.add(R);for(const ue of F)J.areaIds.add(ue)}}for(const B of _){const M=B.completionContextType,R=B.completionContextId;let A=[];if(M==="Personal"){const G=B.contextOwnerMarshalId;G&&I.has(G)&&(A=[I.get(G)])}else if(M==="Checkpoint")for(const G of I.values())G.checkpointIds.has(R)&&A.push(G);else if(M==="Area")for(const G of I.values())G.areaIds.has(R)&&A.push(G);else A=Array.from(I.values());for(const G of A)G.allTasks.push({...B,isCompleted:B.isCompleted||B.localIsCompleted}),G.totalTaskCount++,(B.isCompleted||B.localIsCompleted)&&G.completedTaskCount++}return Array.from(I.values()).map(B=>({...B,checkpointIds:Array.from(B.checkpointIds),areaIds:Array.from(B.areaIds)})).sort((B,M)=>(B.name||"").localeCompare(M.name||"",void 0,{sensitivity:"base"}))});return{expandedAreaLeadMarshal:d,savingAreaLeadMarshalTask:h,areaLeadMarshalDataVersion:f,allAreaLeadMarshals:y,toggleAreaLeadMarshalExpansion:m,toggleAreaLeadMarshalTask:async(S,x)=>{if(h.value)return;h.value=!0;const E={marshalId:x.marshalId,contextType:S.contextType,contextId:S.contextId,actorMarshalId:t.value};try{S.isCompleted?await Nt.uncomplete(e.value,S.itemId,E):await Nt.complete(e.value,S.itemId,E),n?.value?.loadDashboard&&await n.value.loadDashboard(),f.value++,c&&await c(!0)}catch($){console.error("Failed to toggle area lead marshal task:",$)}finally{h.value=!1}}}}function eK({router:e,route:t,onAuthSuccess:n}){const a=P(!1),o=P(!1),i=P(null),l=P(null),c=P(null),d=P(null),h=z(()=>l.value?.name||null),f=z(()=>d.value?.eventRoles?d.value.eventRoles.filter(A=>A.role==="EventAreaLead").flatMap(A=>A.areaIds||[]):[]),m=z(()=>f.value.length>0),y=z(()=>d.value?.eventRoles?d.value.eventRoles.some(R=>R.role==="EventAdmin"):!1),k=z(()=>d.value?.authMethod==="SecureEmailLink"&&y.value),S=z(()=>d.value?.authMethod==="MarshalMagicCode"&&y.value);let x=null;const E=()=>{x||(x=setInterval(async()=>{if(d.value?.marshalId)try{await Za.getMe(t.params.eventId)}catch(R){console.debug("Heartbeat failed:",R)}},300*1e3))},$=()=>{x&&(clearInterval(x),x=null)},w=async(R,A,G=!1)=>{o.value=!0,i.value=null,console.log("Authenticating with magic code:",{eventId:R,code:A,isReauth:G}),Bd();try{Uo("marshal",R);const F=await Za.marshalLogin(R,A);if(console.log("Auth response:",F.data),F.data.success){nv(R,{token:F.data.sessionToken,marshalId:F.data.marshalId,marshalName:F.data.person?.name||null}),R_(R,F.data.marshalId,A),l.value=F.data.person,c.value=F.data.marshalId,a.value=!0,console.log("Authenticated as marshal:",c.value,l.value?.name);try{const j=await Za.getMe(R);d.value=j.data,console.log("User claims:",d.value)}catch(j){console.warn("Failed to fetch claims:",j)}e.replace({path:t.path,query:{}}),E(),n&&await n()}else i.value=F.data.message||"Authentication failed"}catch(F){console.error("Authentication failed:",F),i.value=F.response?.data?.message||"Invalid or expired login link"}finally{o.value=!1}};return{isAuthenticated:a,authenticating:o,loginError:i,currentPerson:l,currentMarshalId:c,userClaims:d,currentMarshalName:h,areaLeadAreaIds:f,isAreaLead:m,isEventAdmin:y,canSwitchToAdmin:k,isAdminButNeedsReauth:S,authenticateWithMagicCode:w,checkExistingSession:async R=>{Uo("marshal",R);const A=mu(R),G=A?.marshalId,F=G?fy(R,G):null;if(!A?.token)return F?(console.log("No session but have stored code, attempting re-authentication..."),Bd(),await w(R,F,!0),a.value):!1;try{const j=await Za.getMe(R);if(j.data&&j.data.marshalId)return d.value=j.data,l.value={personId:j.data.personId,name:j.data.personName,email:j.data.personEmail},c.value=j.data.marshalId,a.value=!0,cy(R,j.data.marshalId),E(),!0}catch(j){if(console.log("Session validation failed, attempting re-authentication...",j),F)try{if(Bd(),await w(R,F,!0),a.value)return console.log("Re-authentication successful"),!0}catch(K){console.error("Re-authentication failed:",K)}A?.sessionKey&&Fh(A.sessionKey)}return!1},handleClose:R=>{$(),Uo(null),a.value=!1,l.value=null,c.value=null,d.value=null,R&&R(),e.push("/marshal")},handleRemoveSession:async R=>{const[A]=R.split(":");Uo("marshal",A);try{await Za.logout()}catch{}Fh(R),Uo(null)},updateSessionEventInfo:(R,A,G)=>{const F=mu(R);F&&F.marshalId&&nv(R,{marshalId:F.marshalId,marshalName:F.marshalName,token:F.token,eventName:A,eventDate:G})},switchToAdminMode:()=>{e.push(`/admin/events/${t.params.eventId}`)},startHeartbeat:E,stopHeartbeat:$}}function tK({eventDate:e,latitude:t,longitude:n}){const a=P(null),o=P(!1),i=P(null),l=["US","LR","MM"],c=z(()=>{try{const w=(navigator.language||"en-GB").split("-")[1]?.toUpperCase();return l.includes(w)}catch{return!1}}),d=z(()=>c.value?"fahrenheit":"celsius"),h=z(()=>{if(!e.value)return null;const $=new Date,w=new Date(e.value);return $.setHours(0,0,0,0),w.setHours(0,0,0,0),Math.floor((w-$)/(1e3*60*60*24))}),f=z(()=>{const $=h.value;return $===null?!1:$>=-1&&$<=7}),m=$=>$>3?720*60*1e3:$>1?10800*1e3:3600*1e3,y=($,w,_)=>`weather_${$.toFixed(2)}_${w.toFixed(2)}_${_}`,k=($,w,_,I)=>{try{const T=y($,w,_),B=localStorage.getItem(T);if(!B)return null;const{data:M,timestamp:R}=JSON.parse(B),A=m(I);return Date.now()-R<A?M:(localStorage.removeItem(T),null)}catch{return null}},S=($,w,_,I)=>{try{const T=y($,w,_);localStorage.setItem(T,JSON.stringify({data:I,timestamp:Date.now()}))}catch{}},x={0:{icon:"sun",description:"Clear"},1:{icon:"sun",description:"Mainly clear"},2:{icon:"cloud-sun",description:"Partly cloudy"},3:{icon:"cloud",description:"Overcast"},45:{icon:"fog",description:"Fog"},48:{icon:"fog",description:"Icy fog"},51:{icon:"drizzle",description:"Light drizzle"},53:{icon:"drizzle",description:"Drizzle"},55:{icon:"drizzle",description:"Heavy drizzle"},56:{icon:"drizzle",description:"Freezing drizzle"},57:{icon:"drizzle",description:"Heavy freezing drizzle"},61:{icon:"rain",description:"Light rain"},63:{icon:"rain",description:"Rain"},65:{icon:"rain",description:"Heavy rain"},66:{icon:"rain",description:"Freezing rain"},67:{icon:"rain",description:"Heavy freezing rain"},71:{icon:"snow",description:"Light snow"},73:{icon:"snow",description:"Snow"},75:{icon:"snow",description:"Heavy snow"},77:{icon:"snow",description:"Snow grains"},80:{icon:"showers",description:"Light showers"},81:{icon:"showers",description:"Showers"},82:{icon:"showers",description:"Heavy showers"},85:{icon:"snow",description:"Light snow showers"},86:{icon:"snow",description:"Heavy snow showers"},95:{icon:"thunderstorm",description:"Thunderstorm"},96:{icon:"thunderstorm",description:"Thunderstorm with hail"},99:{icon:"thunderstorm",description:"Severe thunderstorm"}},E=async()=>{const $=t.value,w=n.value,_=e.value,I=h.value;if(!$||!w||!_||!f.value){a.value=null;return}const T=new Date(_).toISOString().split("T")[0],B=k($,w,T,I);if(B){a.value=B;return}o.value=!0,i.value=null;try{const M=c.value?"fahrenheit":"celsius",R=`https://api.open-meteo.com/v1/forecast?latitude=${$}&longitude=${w}&daily=temperature_2m_max,temperature_2m_min,weathercode&temperature_unit=${M}&timezone=auto`,A=await fetch(R);if(!A.ok)throw new Error("Weather API request failed");const G=await A.json(),F=G.daily.time.indexOf(T);if(F===-1){a.value=null;return}const j=G.daily.weathercode[F],K=Math.round(G.daily.temperature_2m_max[F]),J=Math.round(G.daily.temperature_2m_min[F]),ue=x[j]||{icon:"cloud",description:"Unknown"},Z={tempMax:K,tempMin:J,unit:c.value?"F":"C",icon:ue.icon,description:ue.description,weatherCode:j};S($,w,T,Z),a.value=Z}catch(M){console.warn("Failed to fetch weather:",M),i.value=M.message,a.value=null}finally{o.value=!1}};return Ye([e,t,n,f],()=>{f.value&&t.value&&n.value?E():a.value=null},{immediate:!0}),{weather:a,loading:o,error:i,shouldShowWeather:f,daysUntilEvent:h,temperatureUnit:d,fetchWeather:E}}const nK=["aria-label"],oK={__name:"WeatherIcon",props:{icon:{type:String,required:!0},size:{type:[Number,String],default:20},alt:{type:String,default:"Weather"},color:{type:String,default:"currentColor"}},setup(e){const t=e,n={sun:"clear-day","cloud-sun":"partly-cloudy-day",cloud:"cloudy",fog:"fog",drizzle:"drizzle",rain:"rain",showers:"overcast-rain",snow:"snow",sleet:"sleet",thunderstorm:"thunderstorms-rain"},a=z(()=>`https://bmcdn.nl/assets/weather-icons/v3.0/fill/svg/${n[t.icon]||"cloudy"}.svg`),o=z(()=>{const l=t.size;return typeof l=="number"?`${l}px`:l}),i=z(()=>({width:o.value,height:o.value,backgroundColor:t.color,maskImage:`url(${a.value})`,WebkitMaskImage:`url(${a.value})`,maskSize:"contain",WebkitMaskSize:"contain",maskRepeat:"no-repeat",WebkitMaskRepeat:"no-repeat",maskPosition:"center",WebkitMaskPosition:"center"}));return(l,c)=>(p(),g("span",{class:"weather-icon",style:nt(i.value),role:"img","aria-label":e.alt},null,12,nK))}},aK=Ze(oK,[["__scopeId","data-v-9861a237"]]),sK={key:0,class:"header-logo-cover"},iK=["src"],lK={key:2,class:"header-logo header-logo-left"},rK=["src"],cK={class:"header-center"},uK={key:0},dK={key:1,class:"header-event-date"},hK=["title"],fK={class:"weather-temp"},pK={key:0,class:"header-actions"},vK={key:3,class:"header-logo header-logo-right"},mK=["src"],gK={class:"container"},yK={key:0,class:"selection-card"},kK={key:1,class:"selection-card"},bK={key:0,class:"loading"},_K={key:2,class:"selection-card error-card"},wK={class:"error"},CK={key:3,class:"dashboard"},LK={key:0,class:"welcome-bar"},SK={class:"welcome-info"},IK={key:0,class:"welcome-email"},xK={key:0,class:"mode-switch"},$K={key:1,class:"mode-switch"},TK={class:"accordion"},MK={class:"add-note-form"},AK={class:"modal-actions"},EK=["disabled"],PK={key:0,class:"qr-loading-state"},DK={key:1,class:"qr-error-state"},RK=6e4,OK={__name:"MarshalView",setup(e){const{terms:t,termsLower:n}=ht(),{updatePendingCount:a}=Hf(),o=Zu(),i=sr(),l=z(()=>o.params.eventId),c={onAuthSuccess:null},{isAuthenticated:d,authenticating:h,loginError:f,currentPerson:m,currentMarshalId:y,currentMarshalName:k,areaLeadAreaIds:S,isAreaLead:x,canSwitchToAdmin:E,isAdminButNeedsReauth:$,authenticateWithMagicCode:w,checkExistingSession:_,handleClose:I,updateSessionEventInfo:T,switchToAdminMode:B,stopHeartbeat:M}=eK({router:i,route:o,onAuthSuccess:()=>c.onAuthSuccess?.()}),R=P(new Set),A=z(()=>S.value.length?Z.value.filter(we=>S.value.includes(we.id)).map(we=>({areaId:we.id,name:we.name,color:we.color})).sort((we,Se)=>(we.name||"").localeCompare(Se.name||"",void 0,{numeric:!0,sensitivity:"base"})):[]);Ye(A,we=>{we.length>0&&R.value.size===0&&(R.value=new Set(we.map(Se=>Se.areaId)))},{immediate:!0});const G=z(()=>S.value.filter(we=>R.value.has(we))),F=we=>{const Se=new Set(R.value);Se.has(we)?Se.delete(we):Se.add(we),R.value=Se},j=z(()=>{const we=Zt.value.find(ot=>ot.isCheckedIn&&!so(ot.checkInTime)&&ot.location);if(we?.location)return{id:we.location.id,locationId:we.location.id,name:we.location.name,description:we.location.description};if(vn.value){const ot=Zt.value.find(kt=>kt.id===vn.value);if(ot?.location)return{id:ot.location.id,locationId:ot.location.id,name:ot.location.name,description:ot.location.description}}const Se=Zt.value[0];return Se?.location?{id:Se.location.id,locationId:Se.location.id,name:Se.location.name,description:Se.location.description}:null}),K=P(null),J=P([]),ue=P([]),Z=P([]),se=P(!0),{pageBackgroundStyle:U,headerStyle:Q,headerTextColor:oe,accentColor:he,accentTextColor:Te,accentButtonStyle:je,brandingLogoUrl:He,brandingLogoPosition:We}=GZ(K,o.params.eventId);Rr("marshalBranding",{headerStyle:Q,headerTextColor:oe,accentButtonStyle:je,accentColor:he,accentTextColor:Te});const be=z(()=>{if(!J.value.length)return null;const we=J.value.filter(Se=>Se.latitude&&Se.longitude);return we.length?we.reduce((Se,ot)=>Se+ot.latitude,0)/we.length:null}),V=z(()=>{if(!J.value.length)return null;const we=J.value.filter(Se=>Se.latitude&&Se.longitude);return we.length?we.reduce((Se,ot)=>Se+ot.longitude,0)/we.length:null}),Y=z(()=>K.value?.eventDate||null),{weather:re,shouldShowWeather:ie}=tK({eventDate:Y,latitude:be,longitude:V}),$e=P("assignments"),q=P({checklist:0,notes:0,incidents:0,eventContacts:0}),X=P([]),ee=P([]),Ce=P(null),Ne=z(()=>Ce.value?.areaLeadRef?.value),{checklistItems:Be,checklistLoading:Ae,checklistError:ne,savingChecklist:ye,expandedChecklistGroup:De,visibleChecklistItems:Pe,completedChecklistCount:Ie,myChecklistItems:me,areaChecklistItems:Ke,areaChecklistItemsWithLocalState:Ve,areaMarshalsForChecklist:de,effectiveChecklistGroupBy:ke,groupedChecklistItems:te,loadChecklist:ge,handleToggleChecklist:Fe,toggleChecklistGroup:ut,getContextName:gt}=jZ({eventId:l,currentMarshalId:y,currentPerson:m,assignments:ue,areaLeadAreaIds:S,isAreaLead:x,allLocations:J,areas:Z,terms:t,termsLower:n,areaLeadRef:Ne,areaLeadCheckpoints:X,sectionLastLoadedAt:q,updateCachedField:Yc,updatePendingCount:a}),{userLocation:xt,locationLastUpdated:Ct,startLocationTracking:Pt,stopLocationTracking:Wt}=qZ(),{showLocationUpdateModal:_o,updatingLocationFor:cn,locationUpdateError:ft,locationUpdateSuccess:Dt,updatingLocation:$t,autoUpdateEnabled:In,selectingLocationOnMap:En,openLocationUpdateModal:wo,closeLocationUpdateModal:Ao,startMapLocationSelect:en,cancelMapLocationSelect:Ma,updateDynamicCheckpointLocation:On,updateLocationWithGps:Go,updateLocationFromCheckpoint:pe,toggleAutoUpdate:ve,stopAutoUpdate:Le,startDynamicCheckpointPolling:lt,stopDynamicCheckpointPolling:Qe,startAllCheckpointsPolling:Rt,stopAllCheckpointsPolling:tn}=WZ({eventId:l,allLocations:J,userLocation:xt,locationLastUpdated:Ct});let an=null;const Bn=async()=>{en(),an=$e.value,$e.value="map",await dn(),pn.value?.openFullscreen?.()},ao=()=>{an&&($e.value=an,an=null)},Ja=()=>{Ma(),pn.value?.mapRef?.closeFullscreen?.(),ao()},{expandedAreaLeadMarshal:qo,savingAreaLeadMarshalTask:yi,areaLeadMarshalDataVersion:yl,allAreaLeadMarshals:ki,toggleAreaLeadMarshalExpansion:jo,toggleAreaLeadMarshalTask:ia}=QZ({eventId:l,currentMarshalId:y,areaLeadRef:Ne,areaLeadCheckpoints:X,areaChecklistItems:Ke,myChecklistItems:me,areaLeadAreaIds:S,loadChecklist:ge}),{checkingIn:la,checkingInAssignment:bi,checkInError:Nn,showCheckInReminderModal:Xa,checkInReminderCheckpoint:xn,dismissedCheckInReminders:Aa,showDistanceWarning:Ps,distanceWarningMessage:_i,isCheckInStale:so,handleCheckInToggle:Eo,handleAreaLeadMarshalCheckIn:Co,dismissCheckInReminder:Qa,dismissDistanceWarning:_n}=ZZ({eventId:l,assignments:ue,allLocations:J,areaLeadRef:Ne,areaLeadCheckpoints:X,areaLeadMarshalDataVersion:yl,updatePendingCount:a,updateCachedField:Yc,reloadChecklist:ge}),_t=P(!1),Mt=P(!1),Fn=P(""),io=P(""),Un=P(null),Lo=P(!1),yt=P(""),Ft=P(""),Po=(we,Se)=>{yt.value=we,Ft.value=Se,Lo.value=!0},lo=P(!1),fn=P(""),es=P(""),Do=P(!1),qn=P(""),on=async we=>{es.value=we.name||we.marshalName||"",fn.value="",qn.value="",Do.value=!0,lo.value=!0;try{const Se=await ka.getMagicLink(l.value,we.marshalId);fn.value=Se.data.magicLink,Do.value=!1}catch(Se){Do.value=!1,qn.value=Se.response?.data?.message||"Failed to load magic link"}},{myIncidents:Wo,incidentsLoading:ts,selectedIncident:Ea,showIncidentDetail:Ds,showAddIncidentNoteModal:ns,incidentNoteText:Pa,submittingIncidentNote:Rs,showReportIncident:Da,loadMyIncidents:Os,handleReportIncident:wi,openIncidentDetail:Bs,handleIncidentStatusChange:kl,openAddIncidentNoteModal:Ci,closeAddIncidentNoteModal:Li,submitIncidentNote:rt}=KZ({eventId:l,currentMarshalId:y,isAreaLead:x,areaLeadAreaIds:S,sectionLastLoadedAt:q,showMessage:Po}),pn=P(null),Ut=z(()=>pn.value),os=P(null),Si=we=>!we||we.length===0?!1:we.some(Se=>S.value.includes(Se)),Ii=we=>{os.value=os.value===we?null:we},sn=we=>{const Se=$e.value===we;if($e.value=Se?null:we,!Se){const ot=Date.now(),kt=Jt=>ot-q.value[Jt]>RK;switch(we){case"checklist":kt("checklist")&&ge();break;case"notes":kt("notes")&&Ei();break;case"incidents":kt("incidents")&&Os();break;case"eventContacts":kt("eventContacts")&&Vs();break}}},vn=P(null),ra=we=>{vn.value=vn.value===we?null:we};Ye(()=>ue.value,we=>{we.length===1&&vn.value===null&&(vn.value=we[0].id)},{immediate:!0});const Ro=z(()=>$e.value==="map"||$e.value==="assignments"&&vn.value!==null);Ye(Ro,we=>{we?Rt():tn()});const Zt=z(()=>ue.value.map(we=>{const Se=J.value.find(wt=>wt.id===we.locationId),ot=Se?.areaIds||Se?.AreaIds||[];let kt=null;ot.length>0&&Z.value.length>0&&(kt=Z.value.find(Xt=>ot.includes(Xt.id))?.name);const kn=(Se?.assignments||[]).map(wt=>({...wt,effectiveIsCheckedIn:wt.isCheckedIn&&!so(wt.checkInTime)})).sort((wt,Xt)=>(wt.marshalName||"").localeCompare(Xt.marshalName||"",void 0,{sensitivity:"base"})),jn=Oo.value.filter(wt=>ot.includes(wt.areaId)&&(!wt.marshalId||wt.marshalId!==y.value)),zn=new Set,Vt=jn.filter(wt=>{const Xt=JSON.stringify({name:wt.name||"",marshalId:wt.marshalId||"",role:wt.role||"",phone:wt.phone||"",email:wt.email||"",notes:wt.notes||""});return zn.has(Xt)?!1:(zn.add(Xt),!0)}).sort((wt,Xt)=>(wt.marshalName||wt.name||"").localeCompare(Xt.marshalName||Xt.name||"",void 0,{sensitivity:"base"})),wn=we.isCheckedIn&&!so(we.checkInTime);return{...we,location:Se,areaName:kt,areaIds:ot,allMarshals:kn,areaContacts:Vt,locationName:Se?.name||"Unknown Location",effectiveIsCheckedIn:wn}})),{courseMapActions:ro,hideOtherCheckpoints:Ra,handleCourseMapVisibilityChange:Oa,handleCourseMapAction:bl,getCheckpointMapActions:xi,handleCheckpointMapVisibilityChange:Ns,handleCheckpointMapAction:cr}=XZ({userLocation:xt,assignmentsWithDetails:Zt,courseMapRef:Ut}),Fs=z(()=>ue.value.length>0?ue.value[0]:null),Lt=z(()=>ue.value.map(we=>we.locationId)),ur=z(()=>Ra.value?J.value.filter(we=>{const Se=Lt.value.includes(we.id),ot=we.isDynamic||we.IsDynamic;return Se||ot}):J.value),co=z(()=>Zt.value.some(we=>we.location?.isDynamic||we.location?.IsDynamic)),uo=z(()=>Zt.value.find(we=>we.location?.isDynamic||we.location?.IsDynamic)),Us=z(()=>{const we=uo.value;if(!we)return!1;const Se=we.location,ot=Se?.locationUpdateScopeConfigurations||Se?.LocationUpdateScopeConfigurations||[];return Ky({scopeConfigurations:ot,marshalId:y.value,marshalAssignmentLocationIds:Lt.value,areaLeadAreaIds:S.value,locationId:we.locationId,locationAreaIds:we.areaIds||[]})}),dr=z(()=>{if(!K.value||!Zt.value.length)return[];const we=new Date,Se=K.value.eventDate?new Date(K.value.eventDate):null;return Zt.value.filter(ot=>{if(ot.effectiveIsCheckedIn||Aa.value.has(ot.id))return!1;const kt=ot.location;if(!kt)return!1;const Jt=kt.startTime?new Date(kt.startTime):Se;if(!Jt)return!1;let kn;if(kt.endTime)kn=new Date(kt.endTime);else if(Se)kn=new Date(Se.getTime()+7200*1e3);else return!1;return we>=Jt&&we<kn})});Ye(dr,we=>{we.length>0&&!Xa.value&&(xn.value=we[0],Xa.value=!0)},{immediate:!0}),Ye(Ps,we=>{we&&(Po("Distance notice",_i.value),_n())});const $i=()=>{const we=xn.value;we&&(Qa(we.id),$e.value="assignments",vn.value=we.id)},as=z(()=>K.value?.route?(typeof K.value.route=="string"?JSON.parse(K.value.route):K.value.route)||[]:[]),zs=z(()=>!Fs.value||!J.value.length?null:J.value.find(we=>we.id===Fs.value.locationId)),Ba=P([]),Ti=P(!1),Na=z(()=>{const we=Ba.value.filter(kt=>!kt.marshalId||kt.marshalId!==y.value),Se=new Set;return we.filter(kt=>{const Jt=JSON.stringify({name:kt.name||"",marshalId:kt.marshalId||"",role:kt.role||"",phone:kt.phone||"",email:kt.email||"",notes:kt.notes||""});return Se.has(Jt)?!1:(Se.add(Jt),!0)}).sort((kt,Jt)=>{if(kt.isPinned!==Jt.isPinned)return kt.isPinned?-1:1;const kn=kt.displayOrder||0,jn=Jt.displayOrder||0;return kn!==jn?kn-jn:(kt.name||"").localeCompare(Jt.name||"",void 0,{sensitivity:"base"})})}),_l=z(()=>Na.value.filter(we=>we.showInEmergencyInfo)),ho=z(()=>ee.value.filter(we=>we.showInEmergencyInfo)),hr=z(()=>_l.value.length>0||ho.value.length>0),wl=(we,Se=[])=>{if(!ee.value||ee.value.length===0)return[];const ot=J.value.find(Vt=>Vt.id===we),kt=ot?.areaIds||ot?.AreaIds||[],Jt=Se.length>0?Se:kt,kn=[],jn=new Set;for(const Vt of ee.value){const wn=Vt.noteId||Vt.NoteId||Vt.id;if(jn.has(wn))continue;const wt=Vt.scopeConfigurations||Vt.ScopeConfigurations||[];let Xt=!1;if(wt.length>0)for(const So of wt){const Pn=So.itemType||So.ItemType,Wn=So.ids||So.Ids||[];if(Pn==="Checkpoint"&&(Wn.includes(we)||Wn.includes("ALL_CHECKPOINTS"))){Xt=!0;break}if(Pn==="Area"&&(Wn.includes("ALL_AREAS")||Jt.length>0&&Jt.some(Di=>Wn.includes(Di)))){Xt=!0;break}}else{const So=Vt.matchedScope||Vt.MatchedScope||"";["EveryoneInAreas","EveryAreaLead","EveryoneAtCheckpoints","Area","Checkpoint"].some(Wn=>So.includes(Wn)||So===Wn)&&(Xt=!0)}Xt&&(jn.add(wn),kn.push(Vt))}const zn={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return kn.sort((Vt,wn)=>{const wt=Vt.isPinned||Vt.IsPinned,Xt=wn.isPinned||wn.IsPinned;if(wt&&!Xt)return-1;if(!wt&&Xt)return 1;const So=zn[Vt.priority||Vt.Priority||"Normal"]??3,Pn=zn[wn.priority||wn.Priority||"Normal"]??3;if(So!==Pn)return So-Pn;const Wn=Vt.displayOrder||Vt.DisplayOrder||0,Ko=wn.displayOrder||wn.DisplayOrder||0;if(Wn!==Ko)return Wn-Ko;const Di=Vt.createdAt||Vt.CreatedAt,Fa=wn.createdAt||wn.CreatedAt;return new Date(Fa)-new Date(Di)})},Oo=P([]),Hs=(we,Se)=>we.localeCompare(Se,void 0,{numeric:!0,sensitivity:"base"}),ss=z(()=>{if(!cn.value)return[];const we=cn.value.locationId;return J.value.filter(Se=>Se.id!==we&&Se.latitude!==0&&Se.longitude!==0).sort((Se,ot)=>Hs(Se.name,ot.name))}),is=z(()=>zs.value?{lat:zs.value.latitude,lng:zs.value.longitude}:xt.value?xt.value:J.value.length>0?{lat:J.value[0].latitude,lng:J.value[0].longitude}:{lat:51.505,lng:-.09}),fr=we=>{if(K.value=we.event,Z.value=we.areas||[],J.value=we.locations||[],Be.value=we.checklist||[],Ba.value=we.contacts||[],ee.value=we.notes||[],we.areaLeadDashboard?.checkpoints&&(X.value=we.areaLeadDashboard.checkpoints),K.value&&Wh(K.value),y.value){const Se=[];for(const ot of J.value){const kt=ot.assignments?.find(Jt=>Jt.marshalId===y.value);kt&&Se.push(kt)}ue.value=Se}},Mi=async()=>{const we=o.params.eventId;console.log("Loading event data for:",{eventId:we,marshalId:y.value});const Se=await ui(we);let ot=!1;if(Se&&(console.log("Loaded cached data from:",Se.cachedAt),fr(Se),ot=!0,se.value=!1),Jn())if(ot){console.log("Offline mode - using cached data");return}else{console.warn("No cached data available while offline");return}console.log("Fetching fresh event data in parallel...");const[kt,Jt,kn]=await Promise.allSettled([si.getById(we),bs.getByEvent(we),Ir.getEventStatus(we)]);if(kt.status==="fulfilled"?(K.value=kt.value.data,console.log("Event loaded:",K.value?.name),K.value&&(Wh(K.value),T(we,K.value.name,K.value.eventDate))):console.error("Failed to load event:",kt.reason),Jt.status==="fulfilled"?(Z.value=Jt.value.data||[],console.log("Areas loaded:",Z.value.length)):console.error("Failed to load areas:",Jt.reason),kn.status==="fulfilled"){if(J.value=kn.value.data?.locations||[],console.log("Locations loaded:",J.value.length),y.value){const zn=[];for(const Vt of J.value){const wn=Vt.assignments?.find(wt=>wt.marshalId===y.value);wn&&zn.push(wn)}ue.value=zn,console.log("Total assignments found:",ue.value.length)}}else console.error("Failed to load event status:",kn.reason);const jn=[ge(),Vs(),Ei(),Os()];x.value&&jn.push(pr()),await Promise.allSettled(jn);try{const zn={event:K.value,areas:Z.value,locations:J.value,checklist:Be.value,contacts:Ba.value,notes:ee.value,marshalId:y.value};X.value.length>0&&(zn.areaLeadDashboard={checkpoints:X.value});const Vt=JSON.parse(JSON.stringify(zn));await sc(we,Vt),console.log("Event data cached for offline access")}catch(zn){console.warn("Failed to cache event data:",zn)}lt()};c.onAuthSuccess=Mi;const Ai=async()=>{const we=o.params.eventId;if(Jn()){console.log("Skipping background preload: offline");return}console.log("Starting background preload for offline data...");try{const Se=await bs.getAreaLeadDashboard(we);if(Se.data){X.value=Se.data.checkpoints||[];const ot=JSON.parse(JSON.stringify({areas:Se.data.areas||[],checkpoints:Se.data.checkpoints||[]}));await ui(we)?await Yc(we,"areaLeadDashboard",ot):await sc(we,{areaLeadDashboard:ot}),console.log("Area lead dashboard cached for offline access")}}catch(Se){Se.response?.status!==403&&console.warn("Failed to preload area lead dashboard:",Se)}console.log("Background preload complete")},pr=async()=>{const we=o.params.eventId;try{const Se=await bs.getAreaLeadDashboard(we);Se.data?.checkpoints&&(X.value=Se.data.checkpoints,console.log("Area lead dashboard loaded:",X.value.length,"checkpoints"))}catch(Se){Se.response?.status!==403&&console.warn("Failed to load area lead dashboard:",Se)}},Ei=async()=>{const we=o.params.eventId;try{const Se=await ma.getMyNotes(we);ee.value=Se.data||[],q.value.notes=Date.now(),console.log("Notes loaded:",ee.value.length)}catch(Se){console.error("Failed to load notes:",Se)}},Vs=async()=>{const we=o.params.eventId;Ti.value=!0;try{const Se=await ps.getMyContacts(we);Ba.value=Se.data||[],q.value.eventContacts=Date.now(),console.log("Contacts loaded:",Ba.value.length)}catch(Se){console.warn("Failed to load contacts:",Se),Ba.value=[]}finally{Ti.value=!1}},Pi=()=>{Mt.value=!1,Un.value&&(Un.value(),Un.value=null)},Cl=()=>{Mt.value=!1,Un.value=null},Ll=()=>{Lo.value=!1},ls=async we=>{if(En.value&&cn.value){await On(cn.value.locationId,we.lat,we.lng,"manual"),En.value=!1,cn.value=null,pn.value?.mapRef?.closeFullscreen?.(),ao();return}if(Us.value&&uo.value){const Se=uo.value;Fn.value="Update location",io.value=`Update ${Se.location?.name||"dynamic checkpoint"} to this location?`,Un.value=async()=>{await On(Se.locationId,we.lat,we.lng,"manual"),pn.value?.mapRef?.closeFullscreen?.()},Mt.value=!0}},Zo=async we=>{if(En.value&&cn.value){if(we.id===cn.value.locationId)return;await On(cn.value.locationId,we.latitude,we.longitude,"checkpoint",we.id),En.value=!1,pn.value?.mapRef?.closeFullscreen?.(),ao();return}if(Us.value&&uo.value){const Se=uo.value;if(we.id===Se.locationId)return;Fn.value="Copy location",io.value=`Copy location from "${we.name}" to ${Se.location?.name||"your dynamic checkpoint"}?`,Un.value=async()=>{await On(Se.locationId,we.latitude,we.longitude,"checkpoint",we.id),pn.value?.mapRef?.closeFullscreen?.()},Mt.value=!0}},Sl=()=>{I(()=>{ue.value=[],Be.value=[],Oo.value=[]})},ca=we=>we?new Date(we).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return rn(async()=>{const we=o.params.eventId,Se=o.query.code;se.value=!0;try{Se?await w(we,Se):await _(we)&&await Mi()}finally{se.value=!1}d.value&&(Pt(),"requestIdleCallback"in window?requestIdleCallback(()=>{Ai()},{timeout:5e3}):setTimeout(()=>{Ai()},2e3))}),Ye(d,we=>{we?Pt():Wt()}),Ye(()=>o.query.code,async we=>{if(we&&d.value){se.value=!0;try{await w(o.params.eventId,we)}finally{se.value=!1}}}),Ye(K,we=>{we&&(document.title=`OnTheDay App - ${t.value.person}`)},{immediate:!0}),An(()=>{M(),Le(),Qe(),tn()}),(we,Se)=>(p(),g("div",{class:"marshal-view",style:nt(N(U))},[Ee(aV),r("header",{class:le(["header",`logo-${N(We)}`]),style:nt(N(Q))},[N(He)&&N(We)==="cover"?(p(),g("div",sK,[r("img",{src:N(He),alt:"Event logo",class:"header-logo-cover-img"},null,8,iK)])):D("",!0),N(d)&&N(We)==="right"?(p(),g("button",{key:1,onClick:Sl,class:"btn-close-session btn-close-left",style:nt({color:N(oe)}),title:"Close session"},"  ",4)):D("",!0),N(He)&&N(We)==="left"?(p(),g("div",lK,[r("img",{src:N(He),alt:"Event logo",class:"header-logo-img"},null,8,rK)])):D("",!0),r("div",cK,[r("div",{class:"header-title",style:nt({color:N(oe)})},[K.value?(p(),g("h1",uK,b(K.value.name),1)):D("",!0),K.value?.eventDate?(p(),g("div",dK,[Je(b(ca(K.value.eventDate))+" ",1),N(ie)&&N(re)?(p(),g("span",{key:0,class:"header-weather",title:N(re).description},[Ee(aK,{icon:N(re).icon,size:18,alt:N(re).description,color:N(oe)},null,8,["icon","alt","color"]),r("span",fK,b(N(re).tempMax)+""+b(N(re).unit),1)],8,hK)):D("",!0)])):D("",!0)],4),N(d)?(p(),g("div",pK,[r("button",{onClick:Se[0]||(Se[0]=ot=>Da.value=!0),class:"btn-header-action btn-report-incident"}," Report Incident "),hr.value?(p(),g("button",{key:0,onClick:Se[1]||(Se[1]=ot=>_t.value=!0),class:"btn-header-action btn-emergency"}," Emergency Info ")):D("",!0)])):D("",!0)]),N(He)&&N(We)==="right"?(p(),g("div",vK,[r("img",{src:N(He),alt:"Event logo",class:"header-logo-img"},null,8,mK)])):D("",!0),N(d)&&N(We)!=="right"?(p(),g("button",{key:4,onClick:Sl,class:"btn-close-session btn-close-right",style:nt({color:N(oe)}),title:"Close session"},"  ",4)):D("",!0)],6),r("div",gK,[se.value?(p(),g("div",yK,[...Se[24]||(Se[24]=[r("div",{class:"loading"},"Loading...",-1)])])):!N(d)&&!N(f)?(p(),g("div",kK,[Se[25]||(Se[25]=r("h2",null,"Welcome",-1)),Se[26]||(Se[26]=r("p",{class:"instruction"},"Please use the login link sent to you to access your marshal dashboard.",-1)),N(h)?(p(),g("p",bK,"Authenticating...")):D("",!0)])):N(f)?(p(),g("div",_K,[Se[27]||(Se[27]=r("h2",null,"Login failed",-1)),r("p",wK,b(N(f)),1),Se[28]||(Se[28]=r("p",{class:"instruction"},"Please contact the event organiser for a new login link.",-1))])):(p(),g("div",CK,[N(E)||N($)?(p(),g("div",LK,[r("div",SK,[N(m)?.email?(p(),g("span",IK,b(N(m).email),1)):D("",!0)]),N(E)?(p(),g("div",xK,[r("button",{onClick:Se[2]||(Se[2]=(...ot)=>N(B)&&N(B)(...ot)),class:"btn-mode-switch"}," Switch to Admin ")])):N($)?(p(),g("div",$K,[...Se[29]||(Se[29]=[r("span",{class:"reauth-hint",title:"Login via admin flow to access admin features"}," Admin access requires re-login ",-1)])])):D("",!0)])):D("",!0),r("div",TK,[Ee(zZ,{ref:"assignmentsSectionRef","is-expanded":$e.value==="assignments",assignments:Zt.value,"expanded-checkpoint-id":vn.value,"all-locations":J.value,route:as.value,"user-location":N(xt),"has-dynamic-assignment":co.value,"current-marshal-id":N(y),"current-marshal-name":N(k),"checking-in-id":N(la),"checking-in-assignment-id":N(bi),"check-in-error":N(Nn),"checking-in-marshal-id":N(la),"expanded-marshal-id":os.value,"updating-location":N($t),"auto-update-enabled":N(In),"get-toolbar-actions":N(xi),"is-area-lead-for-areas":Si,"get-notes-for-checkpoint":wl,"area-lead-area-ids":N(S),onToggle:Se[3]||(Se[3]=ot=>sn("assignments")),onToggleCheckpoint:ra,onMapClick:ls,onLocationClick:Zo,onActionClick:N(cr),onVisibilityChange:N(Ns),onUpdateLocation:N(wo),onCheckIn:Se[4]||(Se[4]=ot=>N(Eo)(ot,!0)),onToggleMarshal:Ii,onMarshalCheckIn:Se[5]||(Se[5]=(ot,kt)=>N(Eo)(ot,!1,kt)),onToggleAutoUpdate:N(ve),onShowMarshalQr:on},null,8,["is-expanded","assignments","expanded-checkpoint-id","all-locations","route","user-location","has-dynamic-assignment","current-marshal-id","current-marshal-name","checking-in-id","checking-in-assignment-id","check-in-error","checking-in-marshal-id","expanded-marshal-id","updating-location","auto-update-enabled","get-toolbar-actions","area-lead-area-ids","onActionClick","onVisibilityChange","onUpdateLocation","onToggleAutoUpdate"]),Ee(hq,{loading:N(Ae),error:N(ne),"is-expanded":$e.value==="checklist","is-area-lead":N(x),"my-items":N(me),"area-items":N(Ke),"area-items-with-local-state":N(Ve),"visible-items":N(Pe),"grouped-items":N(te),"completed-count":N(Ie),saving:N(ye),"effective-group-by":N(ke),"expanded-group":N(De),locations:J.value,areas:Z.value,marshals:N(de),"get-context-name":N(gt),onToggle:Se[6]||(Se[6]=ot=>sn("checklist")),onToggleItem:N(Fe),onToggleGroup:N(ut)},null,8,["loading","error","is-expanded","is-area-lead","my-items","area-items","area-items-with-local-state","visible-items","grouped-items","completed-count","saving","effective-group-by","expanded-group","locations","areas","marshals","get-context-name","onToggleItem","onToggleGroup"]),Ee(kq,{"event-id":N(o).params.eventId,notes:ee.value,locations:J.value,areas:Z.value,assignments:ue.value,"is-expanded":$e.value==="notes",onToggle:Se[7]||(Se[7]=ot=>sn("notes")),onNotesChanged:Ei},null,8,["event-id","notes","locations","areas","assignments","is-expanded"]),Ee(lG,{contacts:Na.value,loading:Ti.value,"is-expanded":$e.value==="eventContacts",onToggle:Se[8]||(Se[8]=ot=>sn("eventContacts"))},null,8,["contacts","loading","is-expanded"]),Ee(gG,{incidents:N(Wo),loading:N(ts),"is-expanded":$e.value==="incidents",onToggle:Se[9]||(Se[9]=ot=>sn("incidents")),onSelectIncident:N(Bs)},null,8,["incidents","loading","is-expanded","onSelectIncident"]),Ee(Xj,{ref_key:"areaLeadSectionRef",ref:Ce,"is-area-lead":N(x),"is-expanded":$e.value==="areaLead",areas:A.value,"selected-filters":R.value,"filtered-area-ids":G.value,"event-id":N(o).params.eventId,"marshal-id":N(y),route:as.value,onToggle:Se[10]||(Se[10]=ot=>sn("areaLead")),onToggleFilter:F,onChecklistUpdated:N(ge)},null,8,["is-area-lead","is-expanded","areas","selected-filters","filtered-area-ids","event-id","marshal-id","route","onChecklistUpdated"]),Ee(IW,{"is-area-lead":N(x),"is-expanded":$e.value==="areaLeadMarshals",marshals:N(ki),"expanded-marshal-id":N(qo),"checking-in-marshal-id":N(la),"saving-task":N(yi),"current-marshal-id":N(y),onToggle:Se[11]||(Se[11]=ot=>sn("areaLeadMarshals")),onToggleMarshal:N(jo),onCheckIn:N(Co),onToggleTask:N(ia),onShowQr:on},null,8,["is-area-lead","is-expanded","marshals","expanded-marshal-id","checking-in-marshal-id","saving-task","current-marshal-id","onToggleMarshal","onCheckIn","onToggleTask"]),Ee(Mq,{ref_key:"routeSectionRef",ref:pn,"is-expanded":$e.value==="map","user-location":N(xt),"selecting-location":N(En),"selecting-location-name":N(cn)?.location?.name||"",locations:ur.value,route:as.value,center:is.value,"highlight-location-ids":Lt.value,clickable:N(En)||Us.value,"toolbar-actions":N(ro),onToggle:Se[12]||(Se[12]=ot=>sn("map")),onCancelSelect:Ja,onMapClick:ls,onLocationClick:Zo,onActionClick:N(bl),onVisibilityChange:N(Oa)},null,8,["is-expanded","user-location","selecting-location","selecting-location-name","locations","route","center","highlight-location-ids","clickable","toolbar-actions","onActionClick","onVisibilityChange"]),Ee(TG,{"event-date":K.value?.eventDate,description:K.value?.description,"is-expanded":$e.value==="eventDetails",onToggle:Se[13]||(Se[13]=ot=>sn("eventDetails"))},null,8,["event-date","description","is-expanded"])])]))]),Ee(GH,{show:_t.value,contacts:_l.value,notes:ho.value,onClose:Se[14]||(Se[14]=ot=>_t.value=!1)},null,8,["show","contacts","notes"]),Ee(w1,{show:N(Da),"event-id":l.value||"",checkpoint:j.value,"initial-location":N(xt),checkpoints:J.value,route:as.value,onClose:Se[15]||(Se[15]=ot=>Da.value=!1),onSubmit:N(wi)},null,8,["show","event-id","checkpoint","initial-location","checkpoints","route","onSubmit"]),Ee(_1,{show:N(Ds),incident:N(Ea),route:as.value,checkpoints:J.value,"can-manage":N(x),onClose:Se[16]||(Se[16]=ot=>Ds.value=!1),onStatusChange:N(kl),onOpenAddNote:N(Ci)},null,8,["show","incident","route","checkpoints","can-manage","onStatusChange","onOpenAddNote"]),Ee(jt,{show:N(ns),title:"Add update",size:"small",onClose:N(Li)},{footer:Ue(()=>[r("div",AK,[r("button",{type:"button",class:"btn btn-secondary",onClick:Se[18]||(Se[18]=(...ot)=>N(Li)&&N(Li)(...ot))}," Cancel "),r("button",{type:"button",class:"btn btn-primary",onClick:Se[19]||(Se[19]=(...ot)=>N(rt)&&N(rt)(...ot)),disabled:!N(Pa).trim()||N(Rs)},b(N(Rs)?"Adding...":"Add update"),9,EK)])]),default:Ue(()=>[r("div",MK,[Ge(r("textarea",{"onUpdate:modelValue":Se[17]||(Se[17]=ot=>un(Pa)?Pa.value=ot:null),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[st,N(Pa)]])])]),_:1},8,["show","onClose"]),Ee(vi,{show:Mt.value,title:Fn.value,message:io.value,onConfirm:Pi,onCancel:Cl},null,8,["show","title","message"]),Ee(vi,{show:Lo.value,title:yt.value,message:Ft.value,"show-cancel":!1,onConfirm:Ll},null,8,["show","title","message"]),Ee(fV,{show:N(Xa),checkpoint:N(xn),"accent-button-style":N(je),onDismiss:Se[20]||(Se[20]=ot=>N(Qa)(N(xn)?.id)),onGoToCheckpoint:$i},null,8,["show","checkpoint","accent-button-style"]),Ee(UV,{show:N(_o),assignment:N(cn),"user-location":N(xt),"auto-update-enabled":N(In),updating:N($t),error:N(ft),success:N(Dt),"available-checkpoints":ss.value,"accent-button-style":N(je),onClose:N(Ao),onUpdateGps:N(Go),onToggleAutoUpdate:Se[21]||(Se[21]=ot=>N(ve)(N(cn))),onSelectOnMap:Bn,onCopyFromCheckpoint:N(pe)},null,8,["show","assignment","user-location","auto-update-enabled","updating","error","success","available-checkpoints","accent-button-style","onClose","onUpdateGps","onCopyFromCheckpoint"]),!Do.value&&!qn.value&&fn.value?(p(),ze(Ff,{key:0,show:lo.value,url:fn.value,title:`Magic link for ${es.value}`,warning:`Only share this QR code with ${es.value}. This link provides full access to their ${N(n).person} dashboard.`,"z-index":1100,onClose:Se[22]||(Se[22]=ot=>lo.value=!1)},null,8,["show","url","title","warning"])):D("",!0),Do.value||qn.value?(p(),ze(jt,{key:1,show:lo.value,title:`Magic link for ${es.value}`,size:"small","z-index":1100,onClose:Se[23]||(Se[23]=ot=>lo.value=!1)},{default:Ue(()=>[Do.value?(p(),g("div",PK,[...Se[30]||(Se[30]=[r("p",null,"Loading magic link...",-1)])])):qn.value?(p(),g("div",DK,[r("p",null,b(qn.value),1)])):D("",!0)]),_:1},8,["show","title"])):D("",!0)],4))}},BK=Ze(OK,[["__scopeId","data-v-c3a16098"]]),NK={class:"form-group"},FK={class:"form-group"},UK={class:"form-group"},zK={class:"actions-left"},HK={__name:"EditProfileModal",props:{show:{type:Boolean,default:!1},profile:{type:Object,default:null},isDirty:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3},showLogout:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty","logout"],setup(e,{emit:t}){const n=e,a=t,o=P({name:"",email:"",phone:""});Ye(()=>n.profile,h=>{h&&(o.value={name:h.name||"",email:h.email||"",phone:h.phone||""})},{immediate:!0,deep:!0}),Ye(()=>n.show,h=>{h&&n.profile&&(o.value={name:n.profile.name||"",email:n.profile.email||"",phone:n.profile.phone||""})});const i=()=>{a("update:isDirty",!0)},l=()=>{if(!o.value.name.trim()){alert("Name is required");return}if(!o.value.email.trim()){alert("Email is required");return}a("submit",{name:o.value.name.trim(),email:o.value.email.trim(),phone:o.value.phone?.trim()||""})},c=()=>{a("close")},d=()=>{a("logout")};return(h,f)=>(p(),ze(jt,{show:e.show,title:"Edit profile",size:"medium","z-index":e.zIndex,"confirm-on-close":!0,"is-dirty":e.isDirty,onClose:c},{actions:Ue(()=>[r("div",zK,[e.showLogout?(p(),g("button",{key:0,type:"button",onClick:d,class:"btn btn-danger"}," Log out ")):D("",!0)]),r("button",{type:"button",onClick:l,class:"btn btn-success"}," Save ")]),default:Ue(()=>[r("form",{onSubmit:ct(l,["prevent"])},[r("div",NK,[f[3]||(f[3]=r("label",null,"Name *",-1)),Ge(r("input",{"onUpdate:modelValue":f[0]||(f[0]=m=>o.value.name=m),type:"text",required:"",class:"form-input",placeholder:"Your name",onInput:i},null,544),[[st,o.value.name]])]),r("div",FK,[f[4]||(f[4]=r("label",null,"Email *",-1)),Ge(r("input",{"onUpdate:modelValue":f[1]||(f[1]=m=>o.value.email=m),type:"email",required:"",class:"form-input",placeholder:"Your email address",onInput:i},null,544),[[st,o.value.email]])]),r("div",UK,[f[5]||(f[5]=r("label",null,"Phone",-1)),Ge(r("input",{"onUpdate:modelValue":f[2]||(f[2]=m=>o.value.phone=m),type:"tel",class:"form-input",placeholder:"Your phone number",onInput:i},null,544),[[st,o.value.phone]])])],32)]),_:1},8,["show","z-index","is-dirty"]))}},VK=Ze(HK,[["__scopeId","data-v-178e5f48"]]),GK={class:"tabs"},qK={class:"tab-content"},jK={class:"form-group"},WK={class:"form-group"},ZK={class:"form-group"},KK={class:"form-group"},YK=["value"],JK={class:"tab-content"},XK={class:"emergency-contacts-section"},QK={key:0,class:"empty-state"},eY={class:"card-header"},tY=["onClick"],nY={class:"form-group"},oY=["onUpdate:modelValue"],aY={class:"form-group"},sY=["onUpdate:modelValue"],iY={class:"form-group"},lY=["onUpdate:modelValue"],rY={__name:"EventFormModal",props:{show:{type:Boolean,default:!1},eventData:{type:Object,default:()=>({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]})},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const n=e,a=t,{activeTab:o,switchTab:i,resetTab:l}=Gy("basic",["basic","emergency"]),c=P({...n.eventData});Ye(()=>n.eventData,y=>{c.value={...y},c.value.emergencyContacts||(c.value.emergencyContacts=[])},{deep:!0}),Ye(()=>n.show,y=>{y&&l()});const d=()=>{c.value.emergencyContacts.push({name:"",phone:"",details:""})},h=y=>{c.value.emergencyContacts.splice(y,1)},f=()=>{a("submit",{...c.value})},m=()=>{a("close")};return(y,k)=>(p(),ze(jt,{show:e.show,title:e.isEditing?"Edit event":"Create new event",size:"large",onClose:m},{"tab-header":Ue(()=>[r("div",GK,[r("button",{type:"button",onClick:k[0]||(k[0]=S=>N(i)("basic")),class:le(["tab-button",{active:N(o)==="basic"}])}," Basic details ",2),r("button",{type:"button",onClick:k[1]||(k[1]=S=>N(i)("emergency")),class:le(["tab-button",{active:N(o)==="emergency"}])}," Emergency contacts ",2)])]),actions:Ue(()=>[r("button",{type:"button",onClick:m,class:"btn btn-secondary"}," Cancel "),r("button",{type:"button",onClick:f,class:"btn btn-success"}," Save ")]),default:Ue(()=>[r("form",{onSubmit:ct(f,["prevent"])},[Ge(r("div",qK,[r("div",jK,[k[6]||(k[6]=r("label",null,"Event name *",-1)),Ge(r("input",{"onUpdate:modelValue":k[2]||(k[2]=S=>c.value.name=S),type:"text",required:"",class:"form-input"},null,512),[[st,c.value.name]])]),r("div",WK,[k[7]||(k[7]=r("label",null,"Description",-1)),Ge(r("textarea",{"onUpdate:modelValue":k[3]||(k[3]=S=>c.value.description=S),rows:"3",class:"form-input"},null,512),[[st,c.value.description]])]),r("div",ZK,[k[8]||(k[8]=r("label",null,"Event date *",-1)),Ge(r("input",{"onUpdate:modelValue":k[4]||(k[4]=S=>c.value.eventDate=S),type:"datetime-local",required:"",class:"form-input"},null,512),[[st,c.value.eventDate]])]),r("div",KK,[k[9]||(k[9]=r("label",null,"Time zone *",-1)),Ge(r("select",{"onUpdate:modelValue":k[5]||(k[5]=S=>c.value.timeZoneId=S),required:"",class:"form-input"},[(p(!0),g(xe,null,qe(N(d1),S=>(p(),g("option",{key:S.value,value:S.value},b(S.label),9,YK))),128))],512),[[no,c.value.timeZoneId]])])],512),[[sa,N(o)==="basic"]]),Ge(r("div",JK,[r("div",XK,[r("div",{class:"section-header-small"},[k[10]||(k[10]=r("h3",null,"Emergency contacts",-1)),r("button",{type:"button",onClick:d,class:"btn btn-small btn-primary"}," Add contact ")]),c.value.emergencyContacts.length===0?(p(),g("div",QK,[...k[11]||(k[11]=[r("p",null,'No emergency contacts added yet. Click "Add contact" to add one.',-1)])])):D("",!0),(p(!0),g(xe,null,qe(c.value.emergencyContacts,(S,x)=>(p(),g("div",{key:x,class:"emergency-contact-card"},[r("div",eY,[r("h4",null,"Contact "+b(x+1),1),r("button",{type:"button",onClick:E=>h(x),class:"btn-remove"},"  ",8,tY)]),r("div",nY,[k[12]||(k[12]=r("label",null,"Name *",-1)),Ge(r("input",{"onUpdate:modelValue":E=>S.name=E,type:"text",required:"",class:"form-input",placeholder:"Contact person name"},null,8,oY),[[st,S.name]])]),r("div",aY,[k[13]||(k[13]=r("label",null,"Phone *",-1)),Ge(r("input",{"onUpdate:modelValue":E=>S.phone=E,type:"tel",required:"",class:"form-input",placeholder:"+1 (555) 123-4567"},null,8,sY),[[st,S.phone]])]),r("div",iY,[k[14]||(k[14]=r("label",null,"Additional details",-1)),Ge(r("textarea",{"onUpdate:modelValue":E=>S.details=E,rows:"2",class:"form-input",placeholder:"Role, availability, or other important information..."},null,8,lY),[[st,S.details]])])]))),128))])],512),[[sa,N(o)==="emergency"]])],32)]),_:1},8,["show","title"]))}},cY=Ze(rY,[["__scopeId","data-v-d820eb4f"]]),uY=Lf("profile",()=>{const e=P(null),t=P(!1),n=P(null);return{profile:e,loading:t,error:n,fetchProfile:async()=>{t.value=!0,n.value=null;try{const d=await Rc.getProfile();return e.value=d.data,d.data}catch(d){throw n.value=d.response?.data?.message||"Failed to load profile",d}finally{t.value=!1}},updateProfile:async d=>{t.value=!0,n.value=null;try{const h=await Rc.updateProfile(d);return e.value=h.data,h.data}catch(h){throw n.value=h.response?.data?.message||"Failed to update profile",h}finally{t.value=!1}},fetchPerson:async(d,h)=>{t.value=!0,n.value=null;try{return(await Rc.getPerson(d,h)).data}catch(f){throw n.value=f.response?.data?.message||"Failed to load person",f}finally{t.value=!1}},updatePerson:async(d,h,f)=>{t.value=!0,n.value=null;try{return(await Rc.updatePerson(d,h,f)).data}catch(m){throw n.value=m.response?.data?.message||"Failed to update person",m}finally{t.value=!1}},clearProfile:()=>{e.value=null,n.value=null}}}),dY={class:"sessions-view"},hY={class:"sessions-container"},fY={key:0,class:"loading-state"},pY={key:1,class:"empty-state"},vY={key:2,class:"sessions-list"},mY={class:"section-header"},gY={class:"section-actions"},yY=["onClick"],kY={class:"session-info"},bY={class:"event-name"},_Y={key:0,class:"event-date"},wY={key:1,class:"sign-in-section"},CY={key:2,class:"section-header"},LY=["onClick"],SY={class:"session-info"},IY={class:"event-name"},xY={class:"role-name"},$Y={key:0,class:"event-date"},TY=["onClick"],MY={class:"modal-card"},AY={class:"modal-actions"},EY={class:"modal-card"},PY={class:"modal-actions"},DY={__name:"SessionsView",setup(e){const t=sr(),n=pc(),a=Vy(),o=uY(),i=P([]),l=P([]),c=P(!0),d=P(!1),h=P(!1),f=P(!1),m=P(!1),y=P(null),k=P(!1),S=P({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}),x=z(()=>localStorage.getItem("adminEmail")),E=z(()=>!!x.value),$=()=>{i.value=D_()},w=se=>{cy(se.eventId,se.marshalId),t.push(`/event/${se.eventId}`)},_=se=>{y.value=se,f.value=!0},I=async()=>{if(!y.value)return;const{sessionKey:se,eventId:U}=y.value;try{Uo("marshal",U),await authApi.logout()}catch{}Fh(se),Uo(null),$(),f.value=!1,y.value=null},T=()=>{m.value=!0},B=async()=>{await n.logout(),l.value=[],m.value=!1},M=async()=>{if(h.value=!0,!o.profile)try{await o.fetchProfile()}catch(se){console.error("Failed to load profile:",se)}},R=async se=>{try{await o.updateProfile(se),h.value=!1}catch(U){console.error("Failed to save profile:",U),alert("Failed to save profile. Please try again.")}},A=async()=>{await n.logout(),l.value=[],h.value=!1},G=se=>se?new Date(se).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric"}):"",F=async()=>{if(E.value)try{Uo("admin");const se=await si.getAll();l.value=se.data||[]}catch(se){console.error("Failed to load admin events:",se),l.value=[]}},j=se=>{t.push(`/admin/event/${se}`)},K=()=>{t.push("/")},J=()=>{},ue=()=>{k.value=!1,S.value={name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}},Z=async se=>{try{const U={...se,adminEmail:n.adminEmail};await a.createEvent(U),ue(),await F()}catch(U){console.error("Failed to create event:",U),alert("Failed to create event. Please try again.")}};return rn(async()=>{document.title="OnTheDay App - Sessions",dy(),uy(),$(),await F(),c.value=!1}),(se,U)=>(p(),g("div",dY,[r("div",hY,[Ee(zy,{title:"Your sessions"}),c.value?(p(),g("div",fY,[...U[9]||(U[9]=[r("p",null,"Loading sessions...",-1)])])):i.value.length===0&&l.value.length===0?(p(),g("div",pY,[U[10]||(U[10]=r("p",null,"No active sessions.",-1)),U[11]||(U[11]=r("p",{class:"hint"},"Sign in to access your events, or use a login link from your event organiser.",-1)),r("button",{class:"btn btn-primary",onClick:U[0]||(U[0]=Q=>d.value=!0)}," Sign in ")])):(p(),g("div",vY,[E.value?(p(),g(xe,{key:0},[r("div",mY,[U[12]||(U[12]=r("span",{class:"section-label"},"Admin events",-1)),r("div",gY,[r("button",{class:"btn btn-small btn-primary",onClick:M}," Profile "),r("button",{class:"btn btn-small btn-primary",onClick:U[1]||(U[1]=Q=>k.value=!0)}," Create event ")])]),(p(!0),g(xe,null,qe(l.value,Q=>(p(),g("div",{key:"admin-"+Q.id,class:"session-card admin-card",onClick:oe=>j(Q.id)},[U[14]||(U[14]=r("div",{class:"card-icon admin-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"})])],-1)),r("div",kY,[r("div",bY,b(Q.name),1),U[13]||(U[13]=r("div",{class:"role-name"},"Admin",-1)),Q.eventDate?(p(),g("div",_Y,b(G(Q.eventDate)),1)):D("",!0)]),r("button",{class:"btn-logout",onClick:ct(T,["stop"]),title:"Log out as admin"},"  ")],8,yY))),128))],64)):(p(),g("div",wY,[r("button",{class:"btn btn-primary",onClick:U[2]||(U[2]=Q=>d.value=!0)}," Sign in ")])),i.value.length>0?(p(),g("div",CY,[...U[15]||(U[15]=[r("span",{class:"section-label"},"Marshal sessions",-1)])])):D("",!0),(p(!0),g(xe,null,qe(i.value,Q=>(p(),g("div",{key:Q.sessionKey,class:"session-card",onClick:oe=>w(Q)},[U[16]||(U[16]=r("div",{class:"card-icon marshal-icon"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})])],-1)),r("div",SY,[r("div",IY,b(Q.eventName||"Event"),1),r("div",xY,b(Q.marshalName||"Marshal"),1),Q.eventDate?(p(),g("div",$Y,b(G(Q.eventDate)),1)):D("",!0)]),r("button",{class:"btn-logout",onClick:ct(oe=>_(Q),["stop"]),title:"Log out from this session"},"  ",8,TY)],8,LY))),128))])),r("button",{class:"btn-back-home",onClick:K,title:"Back to home"},"  ")]),Ee(Hy,{show:d.value,onClose:U[3]||(U[3]=Q=>d.value=!1),onSuccess:J},null,8,["show"]),Ee(VK,{show:h.value,profile:N(o).profile,"show-logout":!0,onClose:U[4]||(U[4]=Q=>h.value=!1),onSubmit:R,onLogout:A},null,8,["show","profile"]),Ee(cY,{show:k.value,"event-data":S.value,"is-editing":!1,onClose:ue,onSubmit:Z},null,8,["show","event-data"]),(p(),ze(Xr,{to:"body"},[Ee(Ca,{name:"modal"},{default:Ue(()=>[m.value?(p(),g("div",{key:0,class:"modal-overlay",onClick:U[6]||(U[6]=ct(Q=>m.value=!1,["self"]))},[r("div",MY,[U[17]||(U[17]=r("h3",null,"Log out as admin?",-1)),U[18]||(U[18]=r("p",null,"This will log you out from all admin events.",-1)),U[19]||(U[19]=r("p",{class:"hint"},"You can log back in using the sign-in button.",-1)),r("div",AY,[r("button",{class:"btn btn-secondary",onClick:U[5]||(U[5]=Q=>m.value=!1)},"Cancel"),r("button",{class:"btn btn-danger",onClick:B},"Log out")])])])):D("",!0)]),_:1})])),(p(),ze(Xr,{to:"body"},[Ee(Ca,{name:"modal"},{default:Ue(()=>[f.value?(p(),g("div",{key:0,class:"modal-overlay",onClick:U[8]||(U[8]=ct(Q=>f.value=!1,["self"]))},[r("div",EY,[U[22]||(U[22]=r("h3",null,"Log out from session?",-1)),r("p",null,[U[20]||(U[20]=Je("This will log you out from ",-1)),r("strong",null,b(y.value?.eventName||"this event"),1),U[21]||(U[21]=Je(".",-1))]),U[23]||(U[23]=r("p",{class:"hint"},"You can log back in using the link from your event organiser.",-1)),r("div",PY,[r("button",{class:"btn btn-secondary",onClick:U[7]||(U[7]=Q=>f.value=!1)},"Cancel"),r("button",{class:"btn btn-danger",onClick:I},"Log out")])])])):D("",!0)]),_:1})]))]))}},RY=Ze(DY,[["__scopeId","data-v-add55e1c"]]);let _m=!1;function OY(){_m||(_m=!0,dy(),uy())}const BY=[{path:"/",name:"Home",component:VC},{path:"/admin/login",name:"AdminLogin",component:JC},{path:"/admin/verify",name:"AdminVerify",component:a2},{path:"/sessions",name:"Sessions",component:RY},{path:"/admin/dashboard",redirect:"/sessions"},{path:"/admin/profile",redirect:"/sessions"},{path:"/admin/event/:eventId",name:"AdminEventManage",component:IH,meta:{requiresAuth:!0}},{path:"/marshal",redirect:"/sessions"},{path:"/event/:eventId",name:"MarshalView",component:BK},{path:"/:pathMatch(.*)*",redirect:"/"}],S1=y_({history:Yb("/VolunteerCheckin/testing/"),routes:BY});S1.beforeEach((e,t,n)=>{OY();const a=localStorage.getItem("adminEmail");if(e.meta.requiresAuth&&!a){n({name:"AdminLogin"});return}if(e.meta.requiresAuth?Uo("admin"):e.name!=="MarshalView"&&e.name!=="Sessions"&&Uo(null),e.name==="MarshalView"){const o=e.params.eventId,i=!!e.query.code,l=mu(o),c=l?.marshalId?fy(o,l.marshalId):null;if(i){n();return}if(l?.token){n();return}if(c){n();return}if(hy()){n({name:"Sessions"});return}}n()});As().then(()=>{console.log("Offline database initialized")}).catch(e=>{console.warn("Failed to initialize offline database:",e)});const Vf=ob(E_);Vf.use(ib());Vf.use(S1);Vf.mount("#app");
