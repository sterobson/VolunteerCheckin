(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function o(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=o(s);fetch(s.href,a)}})();function Xc(e){const t=Object.create(null);for(const o of e.split(","))t[o]=1;return o=>o in t}const Tt={},Yi=[],Wo=()=>{},Eh=()=>!1,ll=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Qc=e=>e.startsWith("onUpdate:"),Qt=Object.assign,eu=(e,t)=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},Sv=Object.prototype.hasOwnProperty,Ct=(e,t)=>Sv.call(e,t),tt=Array.isArray,Ji=e=>Ja(e)==="[object Map]",aa=e=>Ja(e)==="[object Set]",Yu=e=>Ja(e)==="[object Date]",ut=e=>typeof e=="function",zt=e=>typeof e=="string",ko=e=>typeof e=="symbol",xt=e=>e!==null&&typeof e=="object",Ph=e=>(xt(e)||ut(e))&&ut(e.then)&&ut(e.catch),Dh=Object.prototype.toString,Ja=e=>Dh.call(e),xv=e=>Ja(e).slice(8,-1),Oh=e=>Ja(e)==="[object Object]",cl=e=>zt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Ma=Xc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ul=e=>{const t=Object.create(null);return(o=>t[o]||(t[o]=e(o)))},$v=/-\w/g,lo=ul(e=>e.replace($v,t=>t.slice(1).toUpperCase())),Iv=/\B([A-Z])/g,oi=ul(e=>e.replace(Iv,"-$1").toLowerCase()),dl=ul(e=>e.charAt(0).toUpperCase()+e.slice(1)),Ql=ul(e=>e?`on${dl(e)}`:""),Xs=(e,t)=>!Object.is(e,t),Nr=(e,...t)=>{for(let o=0;o<e.length;o++)e[o](...t)},Rh=(e,t,o,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:o})},hl=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Tv=e=>{const t=zt(e)?Number(e):NaN;return isNaN(t)?e:t};let Ju;const fl=()=>Ju||(Ju=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function ot(e){if(tt(e)){const t={};for(let o=0;o<e.length;o++){const i=e[o],s=zt(i)?Pv(i):ot(i);if(s)for(const a in s)t[a]=s[a]}return t}else if(zt(e)||xt(e))return e}const Mv=/;(?![^(]*\))/g,Av=/:([^]+)/,Ev=/\/\*[^]*?\*\//g;function Pv(e){const t={};return e.replace(Ev,"").split(Mv).forEach(o=>{if(o){const i=o.split(Av);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function _e(e){let t="";if(zt(e))t=e;else if(tt(e))for(let o=0;o<e.length;o++){const i=_e(e[o]);i&&(t+=i+" ")}else if(xt(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}const Dv="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Ov=Xc(Dv);function Bh(e){return!!e||e===""}function Rv(e,t){if(e.length!==t.length)return!1;let o=!0;for(let i=0;o&&i<e.length;i++)o=Ai(e[i],t[i]);return o}function Ai(e,t){if(e===t)return!0;let o=Yu(e),i=Yu(t);if(o||i)return o&&i?e.getTime()===t.getTime():!1;if(o=ko(e),i=ko(t),o||i)return e===t;if(o=tt(e),i=tt(t),o||i)return o&&i?Rv(e,t):!1;if(o=xt(e),i=xt(t),o||i){if(!o||!i)return!1;const s=Object.keys(e).length,a=Object.keys(t).length;if(s!==a)return!1;for(const c in e){const u=e.hasOwnProperty(c),d=t.hasOwnProperty(c);if(u&&!d||!u&&d||!Ai(e[c],t[c]))return!1}}return String(e)===String(t)}function tu(e,t){return e.findIndex(o=>Ai(o,t))}const Nh=e=>!!(e&&e.__v_isRef===!0),_=e=>zt(e)?e:e==null?"":tt(e)||xt(e)&&(e.toString===Dh||!ut(e.toString))?Nh(e)?_(e.value):JSON.stringify(e,Fh,2):String(e),Fh=(e,t)=>Nh(t)?Fh(e,t.value):Ji(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((o,[i,s],a)=>(o[ec(i,a)+" =>"]=s,o),{})}:aa(t)?{[`Set(${t.size})`]:[...t.values()].map(o=>ec(o))}:ko(t)?ec(t):xt(t)&&!tt(t)&&!Oh(t)?String(t):t,ec=(e,t="")=>{var o;return ko(e)?`Symbol(${(o=e.description)!=null?o:t})`:e};let cn;class Uh{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=cn,!t&&cn&&(this.index=(cn.scopes||(cn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].pause();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].resume();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].resume()}}run(t){if(this._active){const o=cn;try{return cn=this,t()}finally{cn=o}}}on(){++this._on===1&&(this.prevScope=cn,cn=this)}off(){this._on>0&&--this._on===0&&(cn=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let o,i;for(o=0,i=this.effects.length;o<i;o++)this.effects[o].stop();for(this.effects.length=0,o=0,i=this.cleanups.length;o<i;o++)this.cleanups[o]();if(this.cleanups.length=0,this.scopes){for(o=0,i=this.scopes.length;o<i;o++)this.scopes[o].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function zh(e){return new Uh(e)}function Hh(){return cn}function Bv(e,t=!1){cn&&cn.cleanups.push(e)}let Et;const tc=new WeakSet;class Vh{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,cn&&cn.active&&cn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,tc.has(this)&&(tc.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Zh(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Xu(this),jh(this);const t=Et,o=_o;Et=this,_o=!0;try{return this.fn()}finally{Wh(this),Et=t,_o=o,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)su(t);this.deps=this.depsTail=void 0,Xu(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?tc.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){wc(this)&&this.run()}get dirty(){return wc(this)}}let Gh=0,Aa,Ea;function Zh(e,t=!1){if(e.flags|=8,t){e.next=Ea,Ea=e;return}e.next=Aa,Aa=e}function nu(){Gh++}function ou(){if(--Gh>0)return;if(Ea){let t=Ea;for(Ea=void 0;t;){const o=t.next;t.next=void 0,t.flags&=-9,t=o}}let e;for(;Aa;){let t=Aa;for(Aa=void 0;t;){const o=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){e||(e=i)}t=o}}if(e)throw e}function jh(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Wh(e){let t,o=e.depsTail,i=o;for(;i;){const s=i.prevDep;i.version===-1?(i===o&&(o=s),su(i),Nv(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=s}e.deps=t,e.depsTail=o}function wc(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(qh(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function qh(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Fa)||(e.globalVersion=Fa,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!wc(e))))return;e.flags|=2;const t=e.dep,o=Et,i=_o;Et=e,_o=!0;try{jh(e);const s=e.fn(e._value);(t.version===0||Xs(s,e._value))&&(e.flags|=128,e._value=s,t.version++)}catch(s){throw t.version++,s}finally{Et=o,_o=i,Wh(e),e.flags&=-3}}function su(e,t=!1){const{dep:o,prevSub:i,nextSub:s}=e;if(i&&(i.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=i,e.nextSub=void 0),o.subs===e&&(o.subs=i,!i&&o.computed)){o.computed.flags&=-5;for(let a=o.computed.deps;a;a=a.nextDep)su(a,!0)}!t&&!--o.sc&&o.map&&o.map.delete(o.key)}function Nv(e){const{prevDep:t,nextDep:o}=e;t&&(t.nextDep=o,e.prevDep=void 0),o&&(o.prevDep=t,e.nextDep=void 0)}let _o=!0;const Kh=[];function Ss(){Kh.push(_o),_o=!1}function xs(){const e=Kh.pop();_o=e===void 0?!0:e}function Xu(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const o=Et;Et=void 0;try{t()}finally{Et=o}}}let Fa=0;class Fv{constructor(t,o){this.sub=t,this.dep=o,this.version=o.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class iu{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!Et||!_o||Et===this.computed)return;let o=this.activeLink;if(o===void 0||o.sub!==Et)o=this.activeLink=new Fv(Et,this),Et.deps?(o.prevDep=Et.depsTail,Et.depsTail.nextDep=o,Et.depsTail=o):Et.deps=Et.depsTail=o,Yh(o);else if(o.version===-1&&(o.version=this.version,o.nextDep)){const i=o.nextDep;i.prevDep=o.prevDep,o.prevDep&&(o.prevDep.nextDep=i),o.prevDep=Et.depsTail,o.nextDep=void 0,Et.depsTail.nextDep=o,Et.depsTail=o,Et.deps===o&&(Et.deps=i)}return o}trigger(t){this.version++,Fa++,this.notify(t)}notify(t){nu();try{for(let o=this.subs;o;o=o.prevSub)o.sub.notify()&&o.sub.dep.notify()}finally{ou()}}}function Yh(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)Yh(i)}const o=e.dep.subs;o!==e&&(e.prevSub=o,o&&(o.nextSub=e)),e.dep.subs=e}}const qr=new WeakMap,$i=Symbol(""),Cc=Symbol(""),Ua=Symbol("");function hn(e,t,o){if(_o&&Et){let i=qr.get(e);i||qr.set(e,i=new Map);let s=i.get(o);s||(i.set(o,s=new iu),s.map=i,s.key=o),s.track()}}function vs(e,t,o,i,s,a){const c=qr.get(e);if(!c){Fa++;return}const u=d=>{d&&d.trigger()};if(nu(),t==="clear")c.forEach(u);else{const d=tt(e),p=d&&cl(o);if(d&&o==="length"){const f=Number(i);c.forEach((y,b)=>{(b==="length"||b===Ua||!ko(b)&&b>=f)&&u(y)})}else switch((o!==void 0||c.has(void 0))&&u(c.get(o)),p&&u(c.get(Ua)),t){case"add":d?p&&u(c.get("length")):(u(c.get($i)),Ji(e)&&u(c.get(Cc)));break;case"delete":d||(u(c.get($i)),Ji(e)&&u(c.get(Cc)));break;case"set":Ji(e)&&u(c.get($i));break}}ou()}function Uv(e,t){const o=qr.get(e);return o&&o.get(t)}function Vi(e){const t=kt(e);return t===e?t:(hn(t,"iterate",Ua),Xn(e)?t:t.map(bo))}function pl(e){return hn(e=kt(e),"iterate",Ua),e}function js(e,t){return $s(e)?Cs(e)?ta(bo(t)):ta(t):bo(t)}const zv={__proto__:null,[Symbol.iterator](){return nc(this,Symbol.iterator,e=>js(this,e))},concat(...e){return Vi(this).concat(...e.map(t=>tt(t)?Vi(t):t))},entries(){return nc(this,"entries",e=>(e[1]=js(this,e[1]),e))},every(e,t){return cs(this,"every",e,t,void 0,arguments)},filter(e,t){return cs(this,"filter",e,t,o=>o.map(i=>js(this,i)),arguments)},find(e,t){return cs(this,"find",e,t,o=>js(this,o),arguments)},findIndex(e,t){return cs(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return cs(this,"findLast",e,t,o=>js(this,o),arguments)},findLastIndex(e,t){return cs(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return cs(this,"forEach",e,t,void 0,arguments)},includes(...e){return oc(this,"includes",e)},indexOf(...e){return oc(this,"indexOf",e)},join(e){return Vi(this).join(e)},lastIndexOf(...e){return oc(this,"lastIndexOf",e)},map(e,t){return cs(this,"map",e,t,void 0,arguments)},pop(){return _a(this,"pop")},push(...e){return _a(this,"push",e)},reduce(e,...t){return Qu(this,"reduce",e,t)},reduceRight(e,...t){return Qu(this,"reduceRight",e,t)},shift(){return _a(this,"shift")},some(e,t){return cs(this,"some",e,t,void 0,arguments)},splice(...e){return _a(this,"splice",e)},toReversed(){return Vi(this).toReversed()},toSorted(e){return Vi(this).toSorted(e)},toSpliced(...e){return Vi(this).toSpliced(...e)},unshift(...e){return _a(this,"unshift",e)},values(){return nc(this,"values",e=>js(this,e))}};function nc(e,t,o){const i=pl(e),s=i[t]();return i!==e&&!Xn(e)&&(s._next=s.next,s.next=()=>{const a=s._next();return a.done||(a.value=o(a.value)),a}),s}const Hv=Array.prototype;function cs(e,t,o,i,s,a){const c=pl(e),u=c!==e&&!Xn(e),d=c[t];if(d!==Hv[t]){const y=d.apply(e,a);return u?bo(y):y}let p=o;c!==e&&(u?p=function(y,b){return o.call(this,js(e,y),b,e)}:o.length>2&&(p=function(y,b){return o.call(this,y,b,e)}));const f=d.call(c,p,i);return u&&s?s(f):f}function Qu(e,t,o,i){const s=pl(e);let a=o;return s!==e&&(Xn(e)?o.length>3&&(a=function(c,u,d){return o.call(this,c,u,d,e)}):a=function(c,u,d){return o.call(this,c,js(e,u),d,e)}),s[t](a,...i)}function oc(e,t,o){const i=kt(e);hn(i,"iterate",Ua);const s=i[t](...o);return(s===-1||s===!1)&&vl(o[0])?(o[0]=kt(o[0]),i[t](...o)):s}function _a(e,t,o=[]){Ss(),nu();const i=kt(e)[t].apply(e,o);return ou(),xs(),i}const Vv=Xc("__proto__,__v_isRef,__isVue"),Jh=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(ko));function Gv(e){ko(e)||(e=String(e));const t=kt(this);return hn(t,"has",e),t.hasOwnProperty(e)}class Xh{constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,i){if(o==="__v_skip")return t.__v_skip;const s=this._isReadonly,a=this._isShallow;if(o==="__v_isReactive")return!s;if(o==="__v_isReadonly")return s;if(o==="__v_isShallow")return a;if(o==="__v_raw")return i===(s?a?em:nf:a?tf:ef).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const c=tt(t);if(!s){let d;if(c&&(d=zv[o]))return d;if(o==="hasOwnProperty")return Gv}const u=Reflect.get(t,o,Ut(t)?t:i);if((ko(o)?Jh.has(o):Vv(o))||(s||hn(t,"get",o),a))return u;if(Ut(u)){const d=c&&cl(o)?u:u.value;return s&&xt(d)?Sc(d):d}return xt(u)?s?Sc(u):Xa(u):u}}class Qh extends Xh{constructor(t=!1){super(!1,t)}set(t,o,i,s){let a=t[o];const c=tt(t)&&cl(o);if(!this._isShallow){const p=$s(a);if(!Xn(i)&&!$s(i)&&(a=kt(a),i=kt(i)),!c&&Ut(a)&&!Ut(i))return p||(a.value=i),!0}const u=c?Number(o)<t.length:Ct(t,o),d=Reflect.set(t,o,i,Ut(t)?t:s);return t===kt(s)&&(u?Xs(i,a)&&vs(t,"set",o,i):vs(t,"add",o,i)),d}deleteProperty(t,o){const i=Ct(t,o);t[o];const s=Reflect.deleteProperty(t,o);return s&&i&&vs(t,"delete",o,void 0),s}has(t,o){const i=Reflect.has(t,o);return(!ko(o)||!Jh.has(o))&&hn(t,"has",o),i}ownKeys(t){return hn(t,"iterate",tt(t)?"length":$i),Reflect.ownKeys(t)}}class Zv extends Xh{constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const jv=new Qh,Wv=new Zv,qv=new Qh(!0);const Lc=e=>e,Ir=e=>Reflect.getPrototypeOf(e);function Kv(e,t,o){return function(...i){const s=this.__v_raw,a=kt(s),c=Ji(a),u=e==="entries"||e===Symbol.iterator&&c,d=e==="keys"&&c,p=s[e](...i),f=o?Lc:t?ta:bo;return!t&&hn(a,"iterate",d?Cc:$i),{next(){const{value:y,done:b}=p.next();return b?{value:y,done:b}:{value:u?[f(y[0]),f(y[1])]:f(y),done:b}},[Symbol.iterator](){return this}}}}function Tr(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Yv(e,t){const o={get(s){const a=this.__v_raw,c=kt(a),u=kt(s);e||(Xs(s,u)&&hn(c,"get",s),hn(c,"get",u));const{has:d}=Ir(c),p=t?Lc:e?ta:bo;if(d.call(c,s))return p(a.get(s));if(d.call(c,u))return p(a.get(u));a!==c&&a.get(s)},get size(){const s=this.__v_raw;return!e&&hn(kt(s),"iterate",$i),s.size},has(s){const a=this.__v_raw,c=kt(a),u=kt(s);return e||(Xs(s,u)&&hn(c,"has",s),hn(c,"has",u)),s===u?a.has(s):a.has(s)||a.has(u)},forEach(s,a){const c=this,u=c.__v_raw,d=kt(u),p=t?Lc:e?ta:bo;return!e&&hn(d,"iterate",$i),u.forEach((f,y)=>s.call(a,p(f),p(y),c))}};return Qt(o,e?{add:Tr("add"),set:Tr("set"),delete:Tr("delete"),clear:Tr("clear")}:{add(s){!t&&!Xn(s)&&!$s(s)&&(s=kt(s));const a=kt(this);return Ir(a).has.call(a,s)||(a.add(s),vs(a,"add",s,s)),this},set(s,a){!t&&!Xn(a)&&!$s(a)&&(a=kt(a));const c=kt(this),{has:u,get:d}=Ir(c);let p=u.call(c,s);p||(s=kt(s),p=u.call(c,s));const f=d.call(c,s);return c.set(s,a),p?Xs(a,f)&&vs(c,"set",s,a):vs(c,"add",s,a),this},delete(s){const a=kt(this),{has:c,get:u}=Ir(a);let d=c.call(a,s);d||(s=kt(s),d=c.call(a,s)),u&&u.call(a,s);const p=a.delete(s);return d&&vs(a,"delete",s,void 0),p},clear(){const s=kt(this),a=s.size!==0,c=s.clear();return a&&vs(s,"clear",void 0,void 0),c}}),["keys","values","entries",Symbol.iterator].forEach(s=>{o[s]=Kv(s,e,t)}),o}function au(e,t){const o=Yv(e,t);return(i,s,a)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?i:Reflect.get(Ct(o,s)&&s in i?o:i,s,a)}const Jv={get:au(!1,!1)},Xv={get:au(!1,!0)},Qv={get:au(!0,!1)};const ef=new WeakMap,tf=new WeakMap,nf=new WeakMap,em=new WeakMap;function tm(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function nm(e){return e.__v_skip||!Object.isExtensible(e)?0:tm(xv(e))}function Xa(e){return $s(e)?e:ru(e,!1,jv,Jv,ef)}function of(e){return ru(e,!1,qv,Xv,tf)}function Sc(e){return ru(e,!0,Wv,Qv,nf)}function ru(e,t,o,i,s){if(!xt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=nm(e);if(a===0)return e;const c=s.get(e);if(c)return c;const u=new Proxy(e,a===2?i:o);return s.set(e,u),u}function Cs(e){return $s(e)?Cs(e.__v_raw):!!(e&&e.__v_isReactive)}function $s(e){return!!(e&&e.__v_isReadonly)}function Xn(e){return!!(e&&e.__v_isShallow)}function vl(e){return e?!!e.__v_raw:!1}function kt(e){const t=e&&e.__v_raw;return t?kt(t):e}function lu(e){return!Ct(e,"__v_skip")&&Object.isExtensible(e)&&Rh(e,"__v_skip",!0),e}const bo=e=>xt(e)?Xa(e):e,ta=e=>xt(e)?Sc(e):e;function Ut(e){return e?e.__v_isRef===!0:!1}function P(e){return sf(e,!1)}function om(e){return sf(e,!0)}function sf(e,t){return Ut(e)?e:new sm(e,t)}class sm{constructor(t,o){this.dep=new iu,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=o?t:kt(t),this._value=o?t:bo(t),this.__v_isShallow=o}get value(){return this.dep.track(),this._value}set value(t){const o=this._rawValue,i=this.__v_isShallow||Xn(t)||$s(t);t=i?t:kt(t),Xs(t,o)&&(this._rawValue=t,this._value=i?t:bo(t),this.dep.trigger())}}function V(e){return Ut(e)?e.value:e}const im={get:(e,t,o)=>t==="__v_raw"?e:V(Reflect.get(e,t,o)),set:(e,t,o,i)=>{const s=e[t];return Ut(s)&&!Ut(o)?(s.value=o,!0):Reflect.set(e,t,o,i)}};function af(e){return Cs(e)?e:new Proxy(e,im)}function am(e){const t=tt(e)?new Array(e.length):{};for(const o in e)t[o]=lm(e,o);return t}class rm{constructor(t,o,i){this._object=t,this._key=o,this._defaultValue=i,this.__v_isRef=!0,this._value=void 0,this._raw=kt(t);let s=!0,a=t;if(!tt(t)||!cl(String(o)))do s=!vl(a)||Xn(a);while(s&&(a=a.__v_raw));this._shallow=s}get value(){let t=this._object[this._key];return this._shallow&&(t=V(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&Ut(this._raw[this._key])){const o=this._object[this._key];if(Ut(o)){o.value=t;return}}this._object[this._key]=t}get dep(){return Uv(this._raw,this._key)}}function lm(e,t,o){return new rm(e,t,o)}class cm{constructor(t,o,i){this.fn=t,this.setter=o,this._value=void 0,this.dep=new iu(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Fa-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!o,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&Et!==this)return Zh(this,!0),!0}get value(){const t=this.dep.track();return qh(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function um(e,t,o=!1){let i,s;return ut(e)?i=e:(i=e.get,s=e.set),new cm(i,s,o)}const Mr={},Kr=new WeakMap;let _i;function dm(e,t=!1,o=_i){if(o){let i=Kr.get(o);i||Kr.set(o,i=[]),i.push(e)}}function hm(e,t,o=Tt){const{immediate:i,deep:s,once:a,scheduler:c,augmentJob:u,call:d}=o,p=C=>s?C:Xn(C)||s===!1||s===0?ms(C,1):ms(C);let f,y,b,I,T=!1,S=!1;if(Ut(e)?(y=()=>e.value,T=Xn(e)):Cs(e)?(y=()=>p(e),T=!0):tt(e)?(S=!0,T=e.some(C=>Cs(C)||Xn(C)),y=()=>e.map(C=>{if(Ut(C))return C.value;if(Cs(C))return p(C);if(ut(C))return d?d(C,2):C()})):ut(e)?t?y=d?()=>d(e,2):e:y=()=>{if(b){Ss();try{b()}finally{xs()}}const C=_i;_i=f;try{return d?d(e,3,[I]):e(I)}finally{_i=C}}:y=Wo,t&&s){const C=y,w=s===!0?1/0:s;y=()=>ms(C(),w)}const O=Hh(),E=()=>{f.stop(),O&&O.active&&eu(O.effects,f)};if(a&&t){const C=t;t=(...w)=>{C(...w),E()}}let A=S?new Array(e.length).fill(Mr):Mr;const $=C=>{if(!(!(f.flags&1)||!f.dirty&&!C))if(t){const w=f.run();if(s||T||(S?w.some((k,M)=>Xs(k,A[M])):Xs(w,A))){b&&b();const k=_i;_i=f;try{const M=[w,A===Mr?void 0:S&&A[0]===Mr?[]:A,I];A=w,d?d(t,3,M):t(...M)}finally{_i=k}}}else f.run()};return u&&u($),f=new Vh(y),f.scheduler=c?()=>c($,!1):$,I=C=>dm(C,!1,f),b=f.onStop=()=>{const C=Kr.get(f);if(C){if(d)d(C,4);else for(const w of C)w();Kr.delete(f)}},t?i?$(!0):A=f.run():c?c($.bind(null,!0),!0):f.run(),E.pause=f.pause.bind(f),E.resume=f.resume.bind(f),E.stop=E,E}function ms(e,t=1/0,o){if(t<=0||!xt(e)||e.__v_skip||(o=o||new Map,(o.get(e)||0)>=t))return e;if(o.set(e,t),t--,Ut(e))ms(e.value,t,o);else if(tt(e))for(let i=0;i<e.length;i++)ms(e[i],t,o);else if(aa(e)||Ji(e))e.forEach(i=>{ms(i,t,o)});else if(Oh(e)){for(const i in e)ms(e[i],t,o);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&ms(e[i],t,o)}return e}function Qa(e,t,o,i){try{return i?e(...i):e()}catch(s){ml(s,t,o)}}function wo(e,t,o,i){if(ut(e)){const s=Qa(e,t,o,i);return s&&Ph(s)&&s.catch(a=>{ml(a,t,o)}),s}if(tt(e)){const s=[];for(let a=0;a<e.length;a++)s.push(wo(e[a],t,o,i));return s}}function ml(e,t,o,i=!0){const s=t?t.vnode:null,{errorHandler:a,throwUnhandledErrorInProduction:c}=t&&t.appContext.config||Tt;if(t){let u=t.parent;const d=t.proxy,p=`https://vuejs.org/error-reference/#runtime-${o}`;for(;u;){const f=u.ec;if(f){for(let y=0;y<f.length;y++)if(f[y](e,d,p)===!1)return}u=u.parent}if(a){Ss(),Qa(a,null,10,[e,d,p]),xs();return}}fm(e,o,s,i,c)}function fm(e,t,o,i=!0,s=!1){if(s)throw e;console.error(e)}const Mn=[];let Vo=-1;const Xi=[];let Ws=null,Zi=0;const rf=Promise.resolve();let Yr=null;function Ls(e){const t=Yr||rf;return e?t.then(this?e.bind(this):e):t}function pm(e){let t=Vo+1,o=Mn.length;for(;t<o;){const i=t+o>>>1,s=Mn[i],a=za(s);a<e||a===e&&s.flags&2?t=i+1:o=i}return t}function cu(e){if(!(e.flags&1)){const t=za(e),o=Mn[Mn.length-1];!o||!(e.flags&2)&&t>=za(o)?Mn.push(e):Mn.splice(pm(t),0,e),e.flags|=1,lf()}}function lf(){Yr||(Yr=rf.then(uf))}function vm(e){tt(e)?Xi.push(...e):Ws&&e.id===-1?Ws.splice(Zi+1,0,e):e.flags&1||(Xi.push(e),e.flags|=1),lf()}function ed(e,t,o=Vo+1){for(;o<Mn.length;o++){const i=Mn[o];if(i&&i.flags&2){if(e&&i.id!==e.uid)continue;Mn.splice(o,1),o--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function cf(e){if(Xi.length){const t=[...new Set(Xi)].sort((o,i)=>za(o)-za(i));if(Xi.length=0,Ws){Ws.push(...t);return}for(Ws=t,Zi=0;Zi<Ws.length;Zi++){const o=Ws[Zi];o.flags&4&&(o.flags&=-2),o.flags&8||o(),o.flags&=-2}Ws=null,Zi=0}}const za=e=>e.id==null?e.flags&2?-1:1/0:e.id;function uf(e){try{for(Vo=0;Vo<Mn.length;Vo++){const t=Mn[Vo];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Qa(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Vo<Mn.length;Vo++){const t=Mn[Vo];t&&(t.flags&=-2)}Vo=-1,Mn.length=0,cf(),Yr=null,(Mn.length||Xi.length)&&uf()}}let nn=null,df=null;function Jr(e){const t=nn;return nn=e,df=e&&e.type.__scopeId||null,t}function Qe(e,t=nn,o){if(!t||e._n)return e;const i=(...s)=>{i._d&&el(-1);const a=Jr(t);let c;try{c=e(...s)}finally{Jr(a),i._d&&el(1)}return c};return i._n=!0,i._c=!0,i._d=!0,i}function Ge(e,t){if(nn===null)return e;const o=wl(nn),i=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[a,c,u,d=Tt]=t[s];a&&(ut(a)&&(a={mounted:a,updated:a}),a.deep&&ms(c),i.push({dir:a,instance:o,value:c,oldValue:void 0,arg:u,modifiers:d}))}return e}function pi(e,t,o,i){const s=e.dirs,a=t&&t.dirs;for(let c=0;c<s.length;c++){const u=s[c];a&&(u.oldValue=a[c].value);let d=u.dir[i];d&&(Ss(),wo(d,o,8,[e.el,u,e,t]),xs())}}function Fr(e,t){if(pn){let o=pn.provides;const i=pn.parent&&pn.parent.provides;i===o&&(o=pn.provides=Object.create(i)),o[e]=t}}function ao(e,t,o=!1){const i=pu();if(i||Ii){let s=Ii?Ii._context.provides:i?i.parent==null||i.ce?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return o&&ut(t)?t.call(i&&i.proxy):t}}function mm(){return!!(pu()||Ii)}const gm=Symbol.for("v-scx"),ym=()=>ao(gm);function We(e,t,o){return hf(e,t,o)}function hf(e,t,o=Tt){const{immediate:i,deep:s,flush:a,once:c}=o,u=Qt({},o),d=t&&i||!t&&a!=="post";let p;if(Za){if(a==="sync"){const I=ym();p=I.__watcherHandles||(I.__watcherHandles=[])}else if(!d){const I=()=>{};return I.stop=Wo,I.resume=Wo,I.pause=Wo,I}}const f=pn;u.call=(I,T,S)=>wo(I,f,T,S);let y=!1;a==="post"?u.scheduler=I=>{In(I,f&&f.suspense)}:a!=="sync"&&(y=!0,u.scheduler=(I,T)=>{T?I():cu(I)}),u.augmentJob=I=>{t&&(I.flags|=4),y&&(I.flags|=2,f&&(I.id=f.uid,I.i=f))};const b=hm(e,t,u);return Za&&(p?p.push(b):d&&b()),b}function _m(e,t,o){const i=this.proxy,s=zt(e)?e.includes(".")?ff(i,e):()=>i[e]:e.bind(i,i);let a;ut(t)?a=t:(a=t.handler,o=t);const c=er(this),u=hf(s,a.bind(i),o);return c(),u}function ff(e,t){const o=t.split(".");return()=>{let i=e;for(let s=0;s<o.length&&i;s++)i=i[o[s]];return i}}const pf=Symbol("_vte"),vf=e=>e.__isTeleport,Pa=e=>e&&(e.disabled||e.disabled===""),td=e=>e&&(e.defer||e.defer===""),nd=e=>typeof SVGElement<"u"&&e instanceof SVGElement,od=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,xc=(e,t)=>{const o=e&&e.to;return zt(o)?t?t(o):null:o},mf={name:"Teleport",__isTeleport:!0,process(e,t,o,i,s,a,c,u,d,p){const{mc:f,pc:y,pbc:b,o:{insert:I,querySelector:T,createText:S,createComment:O}}=p,E=Pa(t.props);let{shapeFlag:A,children:$,dynamicChildren:C}=t;if(e==null){const w=t.el=S(""),k=t.anchor=S("");I(w,o,i),I(k,o,i);const M=(ne,ce)=>{A&16&&f($,ne,ce,s,a,c,u,d)},G=()=>{const ne=t.target=xc(t.props,T),ce=gf(ne,t,S,I);ne&&(c!=="svg"&&nd(ne)?c="svg":c!=="mathml"&&od(ne)&&(c="mathml"),s&&s.isCE&&(s.ce._teleportTargets||(s.ce._teleportTargets=new Set)).add(ne),E||(M(ne,ce),Ur(t,!1)))};E&&(M(o,k),Ur(t,!0)),td(t.props)?(t.el.__isMounted=!1,In(()=>{G(),delete t.el.__isMounted},a)):G()}else{if(td(t.props)&&e.el.__isMounted===!1){In(()=>{mf.process(e,t,o,i,s,a,c,u,d,p)},a);return}t.el=e.el,t.targetStart=e.targetStart;const w=t.anchor=e.anchor,k=t.target=e.target,M=t.targetAnchor=e.targetAnchor,G=Pa(e.props),ne=G?o:k,ce=G?w:M;if(c==="svg"||nd(k)?c="svg":(c==="mathml"||od(k))&&(c="mathml"),C?(b(e.dynamicChildren,C,ne,s,a,c,u),hu(e,t,!0)):d||y(e,t,ne,ce,s,a,c,u,!1),E)G?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):Ar(t,o,w,p,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const K=t.target=xc(t.props,T);K&&Ar(t,K,null,p,0)}else G&&Ar(t,k,M,p,1);Ur(t,E)}},remove(e,t,o,{um:i,o:{remove:s}},a){const{shapeFlag:c,children:u,anchor:d,targetStart:p,targetAnchor:f,target:y,props:b}=e;if(y&&(s(p),s(f)),a&&s(d),c&16){const I=a||!Pa(b);for(let T=0;T<u.length;T++){const S=u[T];i(S,t,o,I,!!S.dynamicChildren)}}},move:Ar,hydrate:km};function Ar(e,t,o,{o:{insert:i},m:s},a=2){a===0&&i(e.targetAnchor,t,o);const{el:c,anchor:u,shapeFlag:d,children:p,props:f}=e,y=a===2;if(y&&i(c,t,o),(!y||Pa(f))&&d&16)for(let b=0;b<p.length;b++)s(p[b],t,o,2);y&&i(u,t,o)}function km(e,t,o,i,s,a,{o:{nextSibling:c,parentNode:u,querySelector:d,insert:p,createText:f}},y){function b(S,O,E,A){O.anchor=y(c(S),O,u(S),o,i,s,a),O.targetStart=E,O.targetAnchor=A}const I=t.target=xc(t.props,d),T=Pa(t.props);if(I){const S=I._lpa||I.firstChild;if(t.shapeFlag&16)if(T)b(e,t,S,S&&c(S));else{t.anchor=c(e);let O=S;for(;O;){if(O&&O.nodeType===8){if(O.data==="teleport start anchor")t.targetStart=O;else if(O.data==="teleport anchor"){t.targetAnchor=O,I._lpa=t.targetAnchor&&c(t.targetAnchor);break}}O=c(O)}t.targetAnchor||gf(I,t,f,p),y(S&&c(S),t,I,o,i,s,a)}Ur(t,T)}else T&&t.shapeFlag&16&&b(e,t,e,c(e));return t.anchor&&c(t.anchor)}const bm=mf;function Ur(e,t){const o=e.ctx;if(o&&o.ut){let i,s;for(t?(i=e.el,s=e.anchor):(i=e.targetStart,s=e.targetAnchor);i&&i!==s;)i.nodeType===1&&i.setAttribute("data-v-owner",o.uid),i=i.nextSibling;o.ut()}}function gf(e,t,o,i){const s=t.targetStart=o(""),a=t.targetAnchor=o("");return s[pf]=a,e&&(i(s,e),i(a,e)),a}const fs=Symbol("_leaveCb"),Er=Symbol("_enterCb");function wm(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return on(()=>{e.isMounted=!0}),xf(()=>{e.isUnmounting=!0}),e}const io=[Function,Array],yf={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:io,onEnter:io,onAfterEnter:io,onEnterCancelled:io,onBeforeLeave:io,onLeave:io,onAfterLeave:io,onLeaveCancelled:io,onBeforeAppear:io,onAppear:io,onAfterAppear:io,onAppearCancelled:io},_f=e=>{const t=e.subTree;return t.component?_f(t.component):t},Cm={name:"BaseTransition",props:yf,setup(e,{slots:t}){const o=pu(),i=wm();return()=>{const s=t.default&&wf(t.default(),!0);if(!s||!s.length)return;const a=kf(s),c=kt(e),{mode:u}=c;if(i.isLeaving)return sc(a);const d=sd(a);if(!d)return sc(a);let p=$c(d,c,i,o,y=>p=y);d.type!==fn&&Ha(d,p);let f=o.subTree&&sd(o.subTree);if(f&&f.type!==fn&&!ki(f,d)&&_f(o).type!==fn){let y=$c(f,c,i,o);if(Ha(f,y),u==="out-in"&&d.type!==fn)return i.isLeaving=!0,y.afterLeave=()=>{i.isLeaving=!1,o.job.flags&8||o.update(),delete y.afterLeave,f=void 0},sc(a);u==="in-out"&&d.type!==fn?y.delayLeave=(b,I,T)=>{const S=bf(i,f);S[String(f.key)]=f,b[fs]=()=>{I(),b[fs]=void 0,delete p.delayedLeave,f=void 0},p.delayedLeave=()=>{T(),delete p.delayedLeave,f=void 0}}:f=void 0}else f&&(f=void 0);return a}}};function kf(e){let t=e[0];if(e.length>1){for(const o of e)if(o.type!==fn){t=o;break}}return t}const Lm=Cm;function bf(e,t){const{leavingVNodes:o}=e;let i=o.get(t.type);return i||(i=Object.create(null),o.set(t.type,i)),i}function $c(e,t,o,i,s){const{appear:a,mode:c,persisted:u=!1,onBeforeEnter:d,onEnter:p,onAfterEnter:f,onEnterCancelled:y,onBeforeLeave:b,onLeave:I,onAfterLeave:T,onLeaveCancelled:S,onBeforeAppear:O,onAppear:E,onAfterAppear:A,onAppearCancelled:$}=t,C=String(e.key),w=bf(o,e),k=(ne,ce)=>{ne&&wo(ne,i,9,ce)},M=(ne,ce)=>{const K=ce[1];k(ne,ce),tt(ne)?ne.every(se=>se.length<=1)&&K():ne.length<=1&&K()},G={mode:c,persisted:u,beforeEnter(ne){let ce=d;if(!o.isMounted)if(a)ce=O||d;else return;ne[fs]&&ne[fs](!0);const K=w[C];K&&ki(e,K)&&K.el[fs]&&K.el[fs](),k(ce,[ne])},enter(ne){let ce=p,K=f,se=y;if(!o.isMounted)if(a)ce=E||p,K=A||f,se=$||y;else return;let me=!1;const Re=ne[Er]=Oe=>{me||(me=!0,Oe?k(se,[ne]):k(K,[ne]),G.delayedLeave&&G.delayedLeave(),ne[Er]=void 0)};ce?M(ce,[ne,Re]):Re()},leave(ne,ce){const K=String(e.key);if(ne[Er]&&ne[Er](!0),o.isUnmounting)return ce();k(b,[ne]);let se=!1;const me=ne[fs]=Re=>{se||(se=!0,ce(),Re?k(S,[ne]):k(T,[ne]),ne[fs]=void 0,w[K]===e&&delete w[K])};w[K]=e,I?M(I,[ne,me]):me()},clone(ne){const ce=$c(ne,t,o,i,s);return s&&s(ce),ce}};return G}function sc(e){if(gl(e))return e=ei(e),e.children=null,e}function sd(e){if(!gl(e))return vf(e.type)&&e.children?kf(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:o}=e;if(o){if(t&16)return o[0];if(t&32&&ut(o.default))return o.default()}}function Ha(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Ha(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function wf(e,t=!1,o){let i=[],s=0;for(let a=0;a<e.length;a++){let c=e[a];const u=o==null?c.key:String(o)+String(c.key!=null?c.key:a);c.type===we?(c.patchFlag&128&&s++,i=i.concat(wf(c.children,t,u))):(t||c.type!==fn)&&i.push(u!=null?ei(c,{key:u}):c)}if(s>1)for(let a=0;a<i.length;a++)i[a].patchFlag=-2;return i}function Cf(e,t){return ut(e)?Qt({name:e.name},t,{setup:e}):e}function Lf(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const Xr=new WeakMap;function Da(e,t,o,i,s=!1){if(tt(e)){e.forEach((T,S)=>Da(T,t&&(tt(t)?t[S]:t),o,i,s));return}if(Qi(i)&&!s){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&Da(e,t,o,i.component.subTree);return}const a=i.shapeFlag&4?wl(i.component):i.el,c=s?null:a,{i:u,r:d}=e,p=t&&t.r,f=u.refs===Tt?u.refs={}:u.refs,y=u.setupState,b=kt(y),I=y===Tt?Eh:T=>Ct(b,T);if(p!=null&&p!==d){if(id(t),zt(p))f[p]=null,I(p)&&(y[p]=null);else if(Ut(p)){p.value=null;const T=t;T.k&&(f[T.k]=null)}}if(ut(d))Qa(d,u,12,[c,f]);else{const T=zt(d),S=Ut(d);if(T||S){const O=()=>{if(e.f){const E=T?I(d)?y[d]:f[d]:d.value;if(s)tt(E)&&eu(E,a);else if(tt(E))E.includes(a)||E.push(a);else if(T)f[d]=[a],I(d)&&(y[d]=f[d]);else{const A=[a];d.value=A,e.k&&(f[e.k]=A)}}else T?(f[d]=c,I(d)&&(y[d]=c)):S&&(d.value=c,e.k&&(f[e.k]=c))};if(c){const E=()=>{O(),Xr.delete(e)};E.id=-1,Xr.set(e,E),In(E,o)}else id(e),O()}}}function id(e){const t=Xr.get(e);t&&(t.flags|=8,Xr.delete(e))}fl().requestIdleCallback;fl().cancelIdleCallback;const Qi=e=>!!e.type.__asyncLoader,gl=e=>e.type.__isKeepAlive;function Sm(e,t){Sf(e,"a",t)}function xm(e,t){Sf(e,"da",t)}function Sf(e,t,o=pn){const i=e.__wdc||(e.__wdc=()=>{let s=o;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(yl(t,i,o),o){let s=o.parent;for(;s&&s.parent;)gl(s.parent.vnode)&&$m(i,t,o,s),s=s.parent}}function $m(e,t,o,i){const s=yl(t,e,i,!0);Lo(()=>{eu(i[t],s)},o)}function yl(e,t,o=pn,i=!1){if(o){const s=o[e]||(o[e]=[]),a=t.__weh||(t.__weh=(...c)=>{Ss();const u=er(o),d=wo(t,o,e,c);return u(),xs(),d});return i?s.unshift(a):s.push(a),a}}const Is=e=>(t,o=pn)=>{(!Za||e==="sp")&&yl(e,(...i)=>t(...i),o)},Im=Is("bm"),on=Is("m"),Tm=Is("bu"),Mm=Is("u"),xf=Is("bum"),Lo=Is("um"),Am=Is("sp"),Em=Is("rtg"),Pm=Is("rtc");function Dm(e,t=pn){yl("ec",e,t)}const Om="components";function _l(e,t){return Bm(Om,e,!0,t)||e}const Rm=Symbol.for("v-ndc");function Bm(e,t,o=!0,i=!1){const s=nn||pn;if(s){const a=s.type;{const u=kg(a,!1);if(u&&(u===t||u===lo(t)||u===dl(lo(t))))return a}const c=ad(s[e]||a[e],t)||ad(s.appContext[e],t);return!c&&i?a:c}}function ad(e,t){return e&&(e[t]||e[lo(t)]||e[dl(lo(t))])}function Pe(e,t,o,i){let s;const a=o,c=tt(e);if(c||zt(e)){const u=c&&Cs(e);let d=!1,p=!1;u&&(d=!Xn(e),p=$s(e),e=pl(e)),s=new Array(e.length);for(let f=0,y=e.length;f<y;f++)s[f]=t(d?p?ta(bo(e[f])):bo(e[f]):e[f],f,void 0,a)}else if(typeof e=="number"){s=new Array(e);for(let u=0;u<e;u++)s[u]=t(u+1,u,void 0,a)}else if(xt(e))if(e[Symbol.iterator])s=Array.from(e,(u,d)=>t(u,d,void 0,a));else{const u=Object.keys(e);s=new Array(u.length);for(let d=0,p=u.length;d<p;d++){const f=u[d];s[d]=t(e[f],f,d,a)}}else s=[];return s}function ka(e,t,o={},i,s){if(nn.ce||nn.parent&&Qi(nn.parent)&&nn.parent.ce){const p=Object.keys(o).length>0;return t!=="default"&&(o.name=t),v(),et(we,null,[Ne("slot",o,i&&i())],p?-2:64)}let a=e[t];a&&a._c&&(a._d=!1),v();const c=a&&$f(a(o)),u=o.key||c&&c.key,d=et(we,{key:(u&&!ko(u)?u:`_${t}`)+(!c&&i?"_fb":"")},c||(i?i():[]),c&&e._===1?64:-2);return a&&a._c&&(a._d=!0),d}function $f(e){return e.some(t=>Ga(t)?!(t.type===fn||t.type===we&&!$f(t.children)):!0)?e:null}const Ic=e=>e?Wf(e)?wl(e):Ic(e.parent):null,Oa=Qt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Ic(e.parent),$root:e=>Ic(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Tf(e),$forceUpdate:e=>e.f||(e.f=()=>{cu(e.update)}),$nextTick:e=>e.n||(e.n=Ls.bind(e.proxy)),$watch:e=>_m.bind(e)}),ic=(e,t)=>e!==Tt&&!e.__isScriptSetup&&Ct(e,t),Nm={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:o,setupState:i,data:s,props:a,accessCache:c,type:u,appContext:d}=e;if(t[0]!=="$"){const b=c[t];if(b!==void 0)switch(b){case 1:return i[t];case 2:return s[t];case 4:return o[t];case 3:return a[t]}else{if(ic(i,t))return c[t]=1,i[t];if(s!==Tt&&Ct(s,t))return c[t]=2,s[t];if(Ct(a,t))return c[t]=3,a[t];if(o!==Tt&&Ct(o,t))return c[t]=4,o[t];Tc&&(c[t]=0)}}const p=Oa[t];let f,y;if(p)return t==="$attrs"&&hn(e.attrs,"get",""),p(e);if((f=u.__cssModules)&&(f=f[t]))return f;if(o!==Tt&&Ct(o,t))return c[t]=4,o[t];if(y=d.config.globalProperties,Ct(y,t))return y[t]},set({_:e},t,o){const{data:i,setupState:s,ctx:a}=e;return ic(s,t)?(s[t]=o,!0):i!==Tt&&Ct(i,t)?(i[t]=o,!0):Ct(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=o,!0)},has({_:{data:e,setupState:t,accessCache:o,ctx:i,appContext:s,props:a,type:c}},u){let d;return!!(o[u]||e!==Tt&&u[0]!=="$"&&Ct(e,u)||ic(t,u)||Ct(a,u)||Ct(i,u)||Ct(Oa,u)||Ct(s.config.globalProperties,u)||(d=c.__cssModules)&&d[u])},defineProperty(e,t,o){return o.get!=null?e._.accessCache[t]=0:Ct(o,"value")&&this.set(e,t,o.value,null),Reflect.defineProperty(e,t,o)}};function rd(e){return tt(e)?e.reduce((t,o)=>(t[o]=null,t),{}):e}let Tc=!0;function Fm(e){const t=Tf(e),o=e.proxy,i=e.ctx;Tc=!1,t.beforeCreate&&ld(t.beforeCreate,e,"bc");const{data:s,computed:a,methods:c,watch:u,provide:d,inject:p,created:f,beforeMount:y,mounted:b,beforeUpdate:I,updated:T,activated:S,deactivated:O,beforeDestroy:E,beforeUnmount:A,destroyed:$,unmounted:C,render:w,renderTracked:k,renderTriggered:M,errorCaptured:G,serverPrefetch:ne,expose:ce,inheritAttrs:K,components:se,directives:me,filters:Re}=t;if(p&&Um(p,i,null),c)for(const he in c){const ve=c[he];ut(ve)&&(i[he]=ve.bind(o))}if(s){const he=s.call(o,o);xt(he)&&(e.data=Xa(he))}if(Tc=!0,a)for(const he in a){const ve=a[he],Te=ut(ve)?ve.bind(o,o):ut(ve.get)?ve.get.bind(o,o):Wo,fe=!ut(ve)&&ut(ve.set)?ve.set.bind(o):Wo,xe=Y({get:Te,set:fe});Object.defineProperty(i,he,{enumerable:!0,configurable:!0,get:()=>xe.value,set:Be=>xe.value=Be})}if(u)for(const he in u)If(u[he],i,o,he);if(d){const he=ut(d)?d.call(o):d;Reflect.ownKeys(he).forEach(ve=>{Fr(ve,he[ve])})}f&&ld(f,e,"c");function de(he,ve){tt(ve)?ve.forEach(Te=>he(Te.bind(o))):ve&&he(ve.bind(o))}if(de(Im,y),de(on,b),de(Tm,I),de(Mm,T),de(Sm,S),de(xm,O),de(Dm,G),de(Pm,k),de(Em,M),de(xf,A),de(Lo,C),de(Am,ne),tt(ce))if(ce.length){const he=e.exposed||(e.exposed={});ce.forEach(ve=>{Object.defineProperty(he,ve,{get:()=>o[ve],set:Te=>o[ve]=Te,enumerable:!0})})}else e.exposed||(e.exposed={});w&&e.render===Wo&&(e.render=w),K!=null&&(e.inheritAttrs=K),se&&(e.components=se),me&&(e.directives=me),ne&&Lf(e)}function Um(e,t,o=Wo){tt(e)&&(e=Mc(e));for(const i in e){const s=e[i];let a;xt(s)?"default"in s?a=ao(s.from||i,s.default,!0):a=ao(s.from||i):a=ao(s),Ut(a)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>a.value,set:c=>a.value=c}):t[i]=a}}function ld(e,t,o){wo(tt(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,o)}function If(e,t,o,i){let s=i.includes(".")?ff(o,i):()=>o[i];if(zt(e)){const a=t[e];ut(a)&&We(s,a)}else if(ut(e))We(s,e.bind(o));else if(xt(e))if(tt(e))e.forEach(a=>If(a,t,o,i));else{const a=ut(e.handler)?e.handler.bind(o):t[e.handler];ut(a)&&We(s,a,e)}}function Tf(e){const t=e.type,{mixins:o,extends:i}=t,{mixins:s,optionsCache:a,config:{optionMergeStrategies:c}}=e.appContext,u=a.get(t);let d;return u?d=u:!s.length&&!o&&!i?d=t:(d={},s.length&&s.forEach(p=>Qr(d,p,c,!0)),Qr(d,t,c)),xt(t)&&a.set(t,d),d}function Qr(e,t,o,i=!1){const{mixins:s,extends:a}=t;a&&Qr(e,a,o,!0),s&&s.forEach(c=>Qr(e,c,o,!0));for(const c in t)if(!(i&&c==="expose")){const u=zm[c]||o&&o[c];e[c]=u?u(e[c],t[c]):t[c]}return e}const zm={data:cd,props:ud,emits:ud,methods:Sa,computed:Sa,beforeCreate:$n,created:$n,beforeMount:$n,mounted:$n,beforeUpdate:$n,updated:$n,beforeDestroy:$n,beforeUnmount:$n,destroyed:$n,unmounted:$n,activated:$n,deactivated:$n,errorCaptured:$n,serverPrefetch:$n,components:Sa,directives:Sa,watch:Vm,provide:cd,inject:Hm};function cd(e,t){return t?e?function(){return Qt(ut(e)?e.call(this,this):e,ut(t)?t.call(this,this):t)}:t:e}function Hm(e,t){return Sa(Mc(e),Mc(t))}function Mc(e){if(tt(e)){const t={};for(let o=0;o<e.length;o++)t[e[o]]=e[o];return t}return e}function $n(e,t){return e?[...new Set([].concat(e,t))]:t}function Sa(e,t){return e?Qt(Object.create(null),e,t):t}function ud(e,t){return e?tt(e)&&tt(t)?[...new Set([...e,...t])]:Qt(Object.create(null),rd(e),rd(t??{})):t}function Vm(e,t){if(!e)return t;if(!t)return e;const o=Qt(Object.create(null),e);for(const i in t)o[i]=$n(e[i],t[i]);return o}function Mf(){return{app:null,config:{isNativeTag:Eh,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Gm=0;function Zm(e,t){return function(i,s=null){ut(i)||(i=Qt({},i)),s!=null&&!xt(s)&&(s=null);const a=Mf(),c=new WeakSet,u=[];let d=!1;const p=a.app={_uid:Gm++,_component:i,_props:s,_container:null,_context:a,_instance:null,version:wg,get config(){return a.config},set config(f){},use(f,...y){return c.has(f)||(f&&ut(f.install)?(c.add(f),f.install(p,...y)):ut(f)&&(c.add(f),f(p,...y))),p},mixin(f){return a.mixins.includes(f)||a.mixins.push(f),p},component(f,y){return y?(a.components[f]=y,p):a.components[f]},directive(f,y){return y?(a.directives[f]=y,p):a.directives[f]},mount(f,y,b){if(!d){const I=p._ceVNode||Ne(i,s);return I.appContext=a,b===!0?b="svg":b===!1&&(b=void 0),e(I,f,b),d=!0,p._container=f,f.__vue_app__=p,wl(I.component)}},onUnmount(f){u.push(f)},unmount(){d&&(wo(u,p._instance,16),e(null,p._container),delete p._container.__vue_app__)},provide(f,y){return a.provides[f]=y,p},runWithContext(f){const y=Ii;Ii=p;try{return f()}finally{Ii=y}}};return p}}let Ii=null;const jm=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${lo(t)}Modifiers`]||e[`${oi(t)}Modifiers`];function Wm(e,t,...o){if(e.isUnmounted)return;const i=e.vnode.props||Tt;let s=o;const a=t.startsWith("update:"),c=a&&jm(i,t.slice(7));c&&(c.trim&&(s=o.map(f=>zt(f)?f.trim():f)),c.number&&(s=o.map(hl)));let u,d=i[u=Ql(t)]||i[u=Ql(lo(t))];!d&&a&&(d=i[u=Ql(oi(t))]),d&&wo(d,e,6,s);const p=i[u+"Once"];if(p){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,wo(p,e,6,s)}}const qm=new WeakMap;function Af(e,t,o=!1){const i=o?qm:t.emitsCache,s=i.get(e);if(s!==void 0)return s;const a=e.emits;let c={},u=!1;if(!ut(e)){const d=p=>{const f=Af(p,t,!0);f&&(u=!0,Qt(c,f))};!o&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}return!a&&!u?(xt(e)&&i.set(e,null),null):(tt(a)?a.forEach(d=>c[d]=null):Qt(c,a),xt(e)&&i.set(e,c),c)}function kl(e,t){return!e||!ll(t)?!1:(t=t.slice(2).replace(/Once$/,""),Ct(e,t[0].toLowerCase()+t.slice(1))||Ct(e,oi(t))||Ct(e,t))}function dd(e){const{type:t,vnode:o,proxy:i,withProxy:s,propsOptions:[a],slots:c,attrs:u,emit:d,render:p,renderCache:f,props:y,data:b,setupState:I,ctx:T,inheritAttrs:S}=e,O=Jr(e);let E,A;try{if(o.shapeFlag&4){const C=s||i,w=C;E=Go(p.call(w,C,f,y,I,b,T)),A=u}else{const C=t;E=Go(C.length>1?C(y,{attrs:u,slots:c,emit:d}):C(y,null)),A=t.props?u:Km(u)}}catch(C){Ra.length=0,ml(C,e,1),E=Ne(fn)}let $=E;if(A&&S!==!1){const C=Object.keys(A),{shapeFlag:w}=$;C.length&&w&7&&(a&&C.some(Qc)&&(A=Ym(A,a)),$=ei($,A,!1,!0))}return o.dirs&&($=ei($,null,!1,!0),$.dirs=$.dirs?$.dirs.concat(o.dirs):o.dirs),o.transition&&Ha($,o.transition),E=$,Jr(O),E}const Km=e=>{let t;for(const o in e)(o==="class"||o==="style"||ll(o))&&((t||(t={}))[o]=e[o]);return t},Ym=(e,t)=>{const o={};for(const i in e)(!Qc(i)||!(i.slice(9)in t))&&(o[i]=e[i]);return o};function Jm(e,t,o){const{props:i,children:s,component:a}=e,{props:c,children:u,patchFlag:d}=t,p=a.emitsOptions;if(t.dirs||t.transition)return!0;if(o&&d>=0){if(d&1024)return!0;if(d&16)return i?hd(i,c,p):!!c;if(d&8){const f=t.dynamicProps;for(let y=0;y<f.length;y++){const b=f[y];if(c[b]!==i[b]&&!kl(p,b))return!0}}}else return(s||u)&&(!u||!u.$stable)?!0:i===c?!1:i?c?hd(i,c,p):!0:!!c;return!1}function hd(e,t,o){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let s=0;s<i.length;s++){const a=i[s];if(t[a]!==e[a]&&!kl(o,a))return!0}return!1}function Xm({vnode:e,parent:t},o){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=o,t=t.parent;else break}}const Ef={},Pf=()=>Object.create(Ef),Df=e=>Object.getPrototypeOf(e)===Ef;function Qm(e,t,o,i=!1){const s={},a=Pf();e.propsDefaults=Object.create(null),Of(e,t,s,a);for(const c in e.propsOptions[0])c in s||(s[c]=void 0);o?e.props=i?s:of(s):e.type.props?e.props=s:e.props=a,e.attrs=a}function eg(e,t,o,i){const{props:s,attrs:a,vnode:{patchFlag:c}}=e,u=kt(s),[d]=e.propsOptions;let p=!1;if((i||c>0)&&!(c&16)){if(c&8){const f=e.vnode.dynamicProps;for(let y=0;y<f.length;y++){let b=f[y];if(kl(e.emitsOptions,b))continue;const I=t[b];if(d)if(Ct(a,b))I!==a[b]&&(a[b]=I,p=!0);else{const T=lo(b);s[T]=Ac(d,u,T,I,e,!1)}else I!==a[b]&&(a[b]=I,p=!0)}}}else{Of(e,t,s,a)&&(p=!0);let f;for(const y in u)(!t||!Ct(t,y)&&((f=oi(y))===y||!Ct(t,f)))&&(d?o&&(o[y]!==void 0||o[f]!==void 0)&&(s[y]=Ac(d,u,y,void 0,e,!0)):delete s[y]);if(a!==u)for(const y in a)(!t||!Ct(t,y))&&(delete a[y],p=!0)}p&&vs(e.attrs,"set","")}function Of(e,t,o,i){const[s,a]=e.propsOptions;let c=!1,u;if(t)for(let d in t){if(Ma(d))continue;const p=t[d];let f;s&&Ct(s,f=lo(d))?!a||!a.includes(f)?o[f]=p:(u||(u={}))[f]=p:kl(e.emitsOptions,d)||(!(d in i)||p!==i[d])&&(i[d]=p,c=!0)}if(a){const d=kt(o),p=u||Tt;for(let f=0;f<a.length;f++){const y=a[f];o[y]=Ac(s,d,y,p[y],e,!Ct(p,y))}}return c}function Ac(e,t,o,i,s,a){const c=e[o];if(c!=null){const u=Ct(c,"default");if(u&&i===void 0){const d=c.default;if(c.type!==Function&&!c.skipFactory&&ut(d)){const{propsDefaults:p}=s;if(o in p)i=p[o];else{const f=er(s);i=p[o]=d.call(null,t),f()}}else i=d;s.ce&&s.ce._setProp(o,i)}c[0]&&(a&&!u?i=!1:c[1]&&(i===""||i===oi(o))&&(i=!0))}return i}const tg=new WeakMap;function Rf(e,t,o=!1){const i=o?tg:t.propsCache,s=i.get(e);if(s)return s;const a=e.props,c={},u=[];let d=!1;if(!ut(e)){const f=y=>{d=!0;const[b,I]=Rf(y,t,!0);Qt(c,b),I&&u.push(...I)};!o&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}if(!a&&!d)return xt(e)&&i.set(e,Yi),Yi;if(tt(a))for(let f=0;f<a.length;f++){const y=lo(a[f]);fd(y)&&(c[y]=Tt)}else if(a)for(const f in a){const y=lo(f);if(fd(y)){const b=a[f],I=c[y]=tt(b)||ut(b)?{type:b}:Qt({},b),T=I.type;let S=!1,O=!0;if(tt(T))for(let E=0;E<T.length;++E){const A=T[E],$=ut(A)&&A.name;if($==="Boolean"){S=!0;break}else $==="String"&&(O=!1)}else S=ut(T)&&T.name==="Boolean";I[0]=S,I[1]=O,(S||Ct(I,"default"))&&u.push(y)}}const p=[c,u];return xt(e)&&i.set(e,p),p}function fd(e){return e[0]!=="$"&&!Ma(e)}const uu=e=>e==="_"||e==="_ctx"||e==="$stable",du=e=>tt(e)?e.map(Go):[Go(e)],ng=(e,t,o)=>{if(t._n)return t;const i=Qe((...s)=>du(t(...s)),o);return i._c=!1,i},Bf=(e,t,o)=>{const i=e._ctx;for(const s in e){if(uu(s))continue;const a=e[s];if(ut(a))t[s]=ng(s,a,i);else if(a!=null){const c=du(a);t[s]=()=>c}}},Nf=(e,t)=>{const o=du(t);e.slots.default=()=>o},Ff=(e,t,o)=>{for(const i in t)(o||!uu(i))&&(e[i]=t[i])},og=(e,t,o)=>{const i=e.slots=Pf();if(e.vnode.shapeFlag&32){const s=t._;s?(Ff(i,t,o),o&&Rh(i,"_",s,!0)):Bf(t,i)}else t&&Nf(e,t)},sg=(e,t,o)=>{const{vnode:i,slots:s}=e;let a=!0,c=Tt;if(i.shapeFlag&32){const u=t._;u?o&&u===1?a=!1:Ff(s,t,o):(a=!t.$stable,Bf(t,s)),c=t}else t&&(Nf(e,t),c={default:1});if(a)for(const u in s)!uu(u)&&c[u]==null&&delete s[u]},In=cg;function ig(e){return ag(e)}function ag(e,t){const o=fl();o.__VUE__=!0;const{insert:i,remove:s,patchProp:a,createElement:c,createText:u,createComment:d,setText:p,setElementText:f,parentNode:y,nextSibling:b,setScopeId:I=Wo,insertStaticContent:T}=e,S=(B,j,X,q=null,F=null,N=null,W=void 0,ge=null,Se=!!j.dynamicChildren)=>{if(B===j)return;B&&!ki(B,j)&&(q=ue(B),Be(B,F,N,!0),B=null),j.patchFlag===-2&&(Se=!1,j.dynamicChildren=null);const{type:Ce,ref:ze,shapeFlag:Fe}=j;switch(Ce){case bl:O(B,j,X,q);break;case fn:E(B,j,X,q);break;case zr:B==null&&A(j,X,q,W);break;case we:se(B,j,X,q,F,N,W,ge,Se);break;default:Fe&1?w(B,j,X,q,F,N,W,ge,Se):Fe&6?me(B,j,X,q,F,N,W,ge,Se):(Fe&64||Fe&128)&&Ce.process(B,j,X,q,F,N,W,ge,Se,ee)}ze!=null&&F?Da(ze,B&&B.ref,N,j||B,!j):ze==null&&B&&B.ref!=null&&Da(B.ref,null,N,B,!0)},O=(B,j,X,q)=>{if(B==null)i(j.el=u(j.children),X,q);else{const F=j.el=B.el;j.children!==B.children&&p(F,j.children)}},E=(B,j,X,q)=>{B==null?i(j.el=d(j.children||""),X,q):j.el=B.el},A=(B,j,X,q)=>{[B.el,B.anchor]=T(B.children,j,X,q,B.el,B.anchor)},$=({el:B,anchor:j},X,q)=>{let F;for(;B&&B!==j;)F=b(B),i(B,X,q),B=F;i(j,X,q)},C=({el:B,anchor:j})=>{let X;for(;B&&B!==j;)X=b(B),s(B),B=X;s(j)},w=(B,j,X,q,F,N,W,ge,Se)=>{if(j.type==="svg"?W="svg":j.type==="math"&&(W="mathml"),B==null)k(j,X,q,F,N,W,ge,Se);else{const Ce=B.el&&B.el._isVueCE?B.el:null;try{Ce&&Ce._beginPatch(),ne(B,j,F,N,W,ge,Se)}finally{Ce&&Ce._endPatch()}}},k=(B,j,X,q,F,N,W,ge)=>{let Se,Ce;const{props:ze,shapeFlag:Fe,transition:je,dirs:Je}=B;if(Se=B.el=c(B.type,N,ze&&ze.is,ze),Fe&8?f(Se,B.children):Fe&16&&G(B.children,Se,null,q,F,ac(B,N),W,ge),Je&&pi(B,null,q,"created"),M(Se,B,B.scopeId,W,q),ze){for(const oe in ze)oe!=="value"&&!Ma(oe)&&a(Se,oe,null,ze[oe],N,q);"value"in ze&&a(Se,"value",null,ze.value,N),(Ce=ze.onVnodeBeforeMount)&&zo(Ce,q,B)}Je&&pi(B,null,q,"beforeMount");const ae=rg(F,je);ae&&je.beforeEnter(Se),i(Se,j,X),((Ce=ze&&ze.onVnodeMounted)||ae||Je)&&In(()=>{Ce&&zo(Ce,q,B),ae&&je.enter(Se),Je&&pi(B,null,q,"mounted")},F)},M=(B,j,X,q,F)=>{if(X&&I(B,X),q)for(let N=0;N<q.length;N++)I(B,q[N]);if(F){let N=F.subTree;if(j===N||Hf(N.type)&&(N.ssContent===j||N.ssFallback===j)){const W=F.vnode;M(B,W,W.scopeId,W.slotScopeIds,F.parent)}}},G=(B,j,X,q,F,N,W,ge,Se=0)=>{for(let Ce=Se;Ce<B.length;Ce++){const ze=B[Ce]=ge?qs(B[Ce]):Go(B[Ce]);S(null,ze,j,X,q,F,N,W,ge)}},ne=(B,j,X,q,F,N,W)=>{const ge=j.el=B.el;let{patchFlag:Se,dynamicChildren:Ce,dirs:ze}=j;Se|=B.patchFlag&16;const Fe=B.props||Tt,je=j.props||Tt;let Je;if(X&&vi(X,!1),(Je=je.onVnodeBeforeUpdate)&&zo(Je,X,j,B),ze&&pi(j,B,X,"beforeUpdate"),X&&vi(X,!0),(Fe.innerHTML&&je.innerHTML==null||Fe.textContent&&je.textContent==null)&&f(ge,""),Ce?ce(B.dynamicChildren,Ce,ge,X,q,ac(j,F),N):W||ve(B,j,ge,null,X,q,ac(j,F),N,!1),Se>0){if(Se&16)K(ge,Fe,je,X,F);else if(Se&2&&Fe.class!==je.class&&a(ge,"class",null,je.class,F),Se&4&&a(ge,"style",Fe.style,je.style,F),Se&8){const ae=j.dynamicProps;for(let oe=0;oe<ae.length;oe++){const J=ae[oe],Ze=Fe[J],Xe=je[J];(Xe!==Ze||J==="value")&&a(ge,J,Ze,Xe,F,X)}}Se&1&&B.children!==j.children&&f(ge,j.children)}else!W&&Ce==null&&K(ge,Fe,je,X,F);((Je=je.onVnodeUpdated)||ze)&&In(()=>{Je&&zo(Je,X,j,B),ze&&pi(j,B,X,"updated")},q)},ce=(B,j,X,q,F,N,W)=>{for(let ge=0;ge<j.length;ge++){const Se=B[ge],Ce=j[ge],ze=Se.el&&(Se.type===we||!ki(Se,Ce)||Se.shapeFlag&198)?y(Se.el):X;S(Se,Ce,ze,null,q,F,N,W,!0)}},K=(B,j,X,q,F)=>{if(j!==X){if(j!==Tt)for(const N in j)!Ma(N)&&!(N in X)&&a(B,N,j[N],null,F,q);for(const N in X){if(Ma(N))continue;const W=X[N],ge=j[N];W!==ge&&N!=="value"&&a(B,N,ge,W,F,q)}"value"in X&&a(B,"value",j.value,X.value,F)}},se=(B,j,X,q,F,N,W,ge,Se)=>{const Ce=j.el=B?B.el:u(""),ze=j.anchor=B?B.anchor:u("");let{patchFlag:Fe,dynamicChildren:je,slotScopeIds:Je}=j;Je&&(ge=ge?ge.concat(Je):Je),B==null?(i(Ce,X,q),i(ze,X,q),G(j.children||[],X,ze,F,N,W,ge,Se)):Fe>0&&Fe&64&&je&&B.dynamicChildren&&B.dynamicChildren.length===je.length?(ce(B.dynamicChildren,je,X,F,N,W,ge),(j.key!=null||F&&j===F.subTree)&&hu(B,j,!0)):ve(B,j,X,ze,F,N,W,ge,Se)},me=(B,j,X,q,F,N,W,ge,Se)=>{j.slotScopeIds=ge,B==null?j.shapeFlag&512?F.ctx.activate(j,X,q,W,Se):Re(j,X,q,F,N,W,Se):Oe(B,j,Se)},Re=(B,j,X,q,F,N,W)=>{const ge=B.component=vg(B,q,F);if(gl(B)&&(ge.ctx.renderer=ee),mg(ge,!1,W),ge.asyncDep){if(F&&F.registerDep(ge,de,W),!B.el){const Se=ge.subTree=Ne(fn);E(null,Se,j,X),B.placeholder=Se.el}}else de(ge,B,j,X,F,N,W)},Oe=(B,j,X)=>{const q=j.component=B.component;if(Jm(B,j,X))if(q.asyncDep&&!q.asyncResolved){he(q,j,X);return}else q.next=j,q.update();else j.el=B.el,q.vnode=j},de=(B,j,X,q,F,N,W)=>{const ge=()=>{if(B.isMounted){let{next:Fe,bu:je,u:Je,parent:ae,vnode:oe}=B;{const ft=Uf(B);if(ft){Fe&&(Fe.el=oe.el,he(B,Fe,W)),ft.asyncDep.then(()=>{B.isUnmounted||ge()});return}}let J=Fe,Ze;vi(B,!1),Fe?(Fe.el=oe.el,he(B,Fe,W)):Fe=oe,je&&Nr(je),(Ze=Fe.props&&Fe.props.onVnodeBeforeUpdate)&&zo(Ze,ae,Fe,oe),vi(B,!0);const Xe=dd(B),rt=B.subTree;B.subTree=Xe,S(rt,Xe,y(rt.el),ue(rt),B,F,N),Fe.el=Xe.el,J===null&&Xm(B,Xe.el),Je&&In(Je,F),(Ze=Fe.props&&Fe.props.onVnodeUpdated)&&In(()=>zo(Ze,ae,Fe,oe),F)}else{let Fe;const{el:je,props:Je}=j,{bm:ae,m:oe,parent:J,root:Ze,type:Xe}=B,rt=Qi(j);vi(B,!1),ae&&Nr(ae),!rt&&(Fe=Je&&Je.onVnodeBeforeMount)&&zo(Fe,J,j),vi(B,!0);{Ze.ce&&Ze.ce._def.shadowRoot!==!1&&Ze.ce._injectChildStyle(Xe);const ft=B.subTree=dd(B);S(null,ft,X,q,B,F,N),j.el=ft.el}if(oe&&In(oe,F),!rt&&(Fe=Je&&Je.onVnodeMounted)){const ft=j;In(()=>zo(Fe,J,ft),F)}(j.shapeFlag&256||J&&Qi(J.vnode)&&J.vnode.shapeFlag&256)&&B.a&&In(B.a,F),B.isMounted=!0,j=X=q=null}};B.scope.on();const Se=B.effect=new Vh(ge);B.scope.off();const Ce=B.update=Se.run.bind(Se),ze=B.job=Se.runIfDirty.bind(Se);ze.i=B,ze.id=B.uid,Se.scheduler=()=>cu(ze),vi(B,!0),Ce()},he=(B,j,X)=>{j.component=B;const q=B.vnode.props;B.vnode=j,B.next=null,eg(B,j.props,q,X),sg(B,j.children,X),Ss(),ed(B),xs()},ve=(B,j,X,q,F,N,W,ge,Se=!1)=>{const Ce=B&&B.children,ze=B?B.shapeFlag:0,Fe=j.children,{patchFlag:je,shapeFlag:Je}=j;if(je>0){if(je&128){fe(Ce,Fe,X,q,F,N,W,ge,Se);return}else if(je&256){Te(Ce,Fe,X,q,F,N,W,ge,Se);return}}Je&8?(ze&16&&$e(Ce,F,N),Fe!==Ce&&f(X,Fe)):ze&16?Je&16?fe(Ce,Fe,X,q,F,N,W,ge,Se):$e(Ce,F,N,!0):(ze&8&&f(X,""),Je&16&&G(Fe,X,q,F,N,W,ge,Se))},Te=(B,j,X,q,F,N,W,ge,Se)=>{B=B||Yi,j=j||Yi;const Ce=B.length,ze=j.length,Fe=Math.min(Ce,ze);let je;for(je=0;je<Fe;je++){const Je=j[je]=Se?qs(j[je]):Go(j[je]);S(B[je],Je,X,null,F,N,W,ge,Se)}Ce>ze?$e(B,F,N,!0,!1,Fe):G(j,X,q,F,N,W,ge,Se,Fe)},fe=(B,j,X,q,F,N,W,ge,Se)=>{let Ce=0;const ze=j.length;let Fe=B.length-1,je=ze-1;for(;Ce<=Fe&&Ce<=je;){const Je=B[Ce],ae=j[Ce]=Se?qs(j[Ce]):Go(j[Ce]);if(ki(Je,ae))S(Je,ae,X,null,F,N,W,ge,Se);else break;Ce++}for(;Ce<=Fe&&Ce<=je;){const Je=B[Fe],ae=j[je]=Se?qs(j[je]):Go(j[je]);if(ki(Je,ae))S(Je,ae,X,null,F,N,W,ge,Se);else break;Fe--,je--}if(Ce>Fe){if(Ce<=je){const Je=je+1,ae=Je<ze?j[Je].el:q;for(;Ce<=je;)S(null,j[Ce]=Se?qs(j[Ce]):Go(j[Ce]),X,ae,F,N,W,ge,Se),Ce++}}else if(Ce>je)for(;Ce<=Fe;)Be(B[Ce],F,N,!0),Ce++;else{const Je=Ce,ae=Ce,oe=new Map;for(Ce=ae;Ce<=je;Ce++){const ht=j[Ce]=Se?qs(j[Ce]):Go(j[Ce]);ht.key!=null&&oe.set(ht.key,Ce)}let J,Ze=0;const Xe=je-ae+1;let rt=!1,ft=0;const vt=new Array(Xe);for(Ce=0;Ce<Xe;Ce++)vt[Ce]=0;for(Ce=Je;Ce<=Fe;Ce++){const ht=B[Ce];if(Ze>=Xe){Be(ht,F,N,!0);continue}let Ht;if(ht.key!=null)Ht=oe.get(ht.key);else for(J=ae;J<=je;J++)if(vt[J-ae]===0&&ki(ht,j[J])){Ht=J;break}Ht===void 0?Be(ht,F,N,!0):(vt[Ht-ae]=Ce+1,Ht>=ft?ft=Ht:rt=!0,S(ht,j[Ht],X,null,F,N,W,ge,Se),Ze++)}const pt=rt?lg(vt):Yi;for(J=pt.length-1,Ce=Xe-1;Ce>=0;Ce--){const ht=ae+Ce,Ht=j[ht],St=j[ht+1],qt=ht+1<ze?St.el||zf(St):q;vt[Ce]===0?S(null,Ht,X,qt,F,N,W,ge,Se):rt&&(J<0||Ce!==pt[J]?xe(Ht,X,qt,2):J--)}}},xe=(B,j,X,q,F=null)=>{const{el:N,type:W,transition:ge,children:Se,shapeFlag:Ce}=B;if(Ce&6){xe(B.component.subTree,j,X,q);return}if(Ce&128){B.suspense.move(j,X,q);return}if(Ce&64){W.move(B,j,X,ee);return}if(W===we){i(N,j,X);for(let Fe=0;Fe<Se.length;Fe++)xe(Se[Fe],j,X,q);i(B.anchor,j,X);return}if(W===zr){$(B,j,X);return}if(q!==2&&Ce&1&&ge)if(q===0)ge.beforeEnter(N),i(N,j,X),In(()=>ge.enter(N),F);else{const{leave:Fe,delayLeave:je,afterLeave:Je}=ge,ae=()=>{B.ctx.isUnmounted?s(N):i(N,j,X)},oe=()=>{N._isLeaving&&N[fs](!0),Fe(N,()=>{ae(),Je&&Je()})};je?je(N,ae,oe):oe()}else i(N,j,X)},Be=(B,j,X,q=!1,F=!1)=>{const{type:N,props:W,ref:ge,children:Se,dynamicChildren:Ce,shapeFlag:ze,patchFlag:Fe,dirs:je,cacheIndex:Je}=B;if(Fe===-2&&(F=!1),ge!=null&&(Ss(),Da(ge,null,X,B,!0),xs()),Je!=null&&(j.renderCache[Je]=void 0),ze&256){j.ctx.deactivate(B);return}const ae=ze&1&&je,oe=!Qi(B);let J;if(oe&&(J=W&&W.onVnodeBeforeUnmount)&&zo(J,j,B),ze&6)Me(B.component,X,q);else{if(ze&128){B.suspense.unmount(X,q);return}ae&&pi(B,null,j,"beforeUnmount"),ze&64?B.type.remove(B,j,X,ee,q):Ce&&!Ce.hasOnce&&(N!==we||Fe>0&&Fe&64)?$e(Ce,j,X,!1,!0):(N===we&&Fe&384||!F&&ze&16)&&$e(Se,j,X),q&&re(B)}(oe&&(J=W&&W.onVnodeUnmounted)||ae)&&In(()=>{J&&zo(J,j,B),ae&&pi(B,null,j,"unmounted")},X)},re=B=>{const{type:j,el:X,anchor:q,transition:F}=B;if(j===we){Ee(X,q);return}if(j===zr){C(B);return}const N=()=>{s(X),F&&!F.persisted&&F.afterLeave&&F.afterLeave()};if(B.shapeFlag&1&&F&&!F.persisted){const{leave:W,delayLeave:ge}=F,Se=()=>W(X,N);ge?ge(B.el,N,Se):Se()}else N()},Ee=(B,j)=>{let X;for(;B!==j;)X=b(B),s(B),B=X;s(j)},Me=(B,j,X)=>{const{bum:q,scope:F,job:N,subTree:W,um:ge,m:Se,a:Ce}=B;pd(Se),pd(Ce),q&&Nr(q),F.stop(),N&&(N.flags|=8,Be(W,B,j,X)),ge&&In(ge,j),In(()=>{B.isUnmounted=!0},j)},$e=(B,j,X,q=!1,F=!1,N=0)=>{for(let W=N;W<B.length;W++)Be(B[W],j,X,q,F)},ue=B=>{if(B.shapeFlag&6)return ue(B.component.subTree);if(B.shapeFlag&128)return B.suspense.next();const j=b(B.anchor||B.el),X=j&&j[pf];return X?b(X):j};let ye=!1;const z=(B,j,X)=>{let q;B==null?j._vnode&&(Be(j._vnode,null,null,!0),q=j._vnode.component):S(j._vnode||null,B,j,null,null,null,X),j._vnode=B,ye||(ye=!0,ed(q),cf(),ye=!1)},ee={p:S,um:Be,m:xe,r:re,mt:Re,mc:G,pc:ve,pbc:ce,n:ue,o:e};return{render:z,hydrate:void 0,createApp:Zm(z)}}function ac({type:e,props:t},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:o}function vi({effect:e,job:t},o){o?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function rg(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function hu(e,t,o=!1){const i=e.children,s=t.children;if(tt(i)&&tt(s))for(let a=0;a<i.length;a++){const c=i[a];let u=s[a];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=s[a]=qs(s[a]),u.el=c.el),!o&&u.patchFlag!==-2&&hu(c,u)),u.type===bl&&(u.patchFlag!==-1?u.el=c.el:u.__elIndex=a+(e.type===we?1:0)),u.type===fn&&!u.el&&(u.el=c.el)}}function lg(e){const t=e.slice(),o=[0];let i,s,a,c,u;const d=e.length;for(i=0;i<d;i++){const p=e[i];if(p!==0){if(s=o[o.length-1],e[s]<p){t[i]=s,o.push(i);continue}for(a=0,c=o.length-1;a<c;)u=a+c>>1,e[o[u]]<p?a=u+1:c=u;p<e[o[a]]&&(a>0&&(t[i]=o[a-1]),o[a]=i)}}for(a=o.length,c=o[a-1];a-- >0;)o[a]=c,c=t[c];return o}function Uf(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Uf(t)}function pd(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function zf(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?zf(t.subTree):null}const Hf=e=>e.__isSuspense;function cg(e,t){t&&t.pendingBranch?tt(e)?t.effects.push(...e):t.effects.push(e):vm(e)}const we=Symbol.for("v-fgt"),bl=Symbol.for("v-txt"),fn=Symbol.for("v-cmt"),zr=Symbol.for("v-stc"),Ra=[];let Jn=null;function v(e=!1){Ra.push(Jn=e?null:[])}function ug(){Ra.pop(),Jn=Ra[Ra.length-1]||null}let Va=1;function el(e,t=!1){Va+=e,e<0&&Jn&&t&&(Jn.hasOnce=!0)}function Vf(e){return e.dynamicChildren=Va>0?Jn||Yi:null,ug(),Va>0&&Jn&&Jn.push(e),e}function m(e,t,o,i,s,a){return Vf(l(e,t,o,i,s,a,!0))}function et(e,t,o,i,s){return Vf(Ne(e,t,o,i,s,!0))}function Ga(e){return e?e.__v_isVNode===!0:!1}function ki(e,t){return e.type===t.type&&e.key===t.key}const Gf=({key:e})=>e??null,Hr=({ref:e,ref_key:t,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?zt(e)||Ut(e)||ut(e)?{i:nn,r:e,k:t,f:!!o}:e:null);function l(e,t=null,o=null,i=0,s=null,a=e===we?0:1,c=!1,u=!1){const d={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Gf(t),ref:t&&Hr(t),scopeId:df,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:nn};return u?(fu(d,o),a&128&&e.normalize(d)):o&&(d.shapeFlag|=zt(o)?8:16),Va>0&&!c&&Jn&&(d.patchFlag>0||a&6)&&d.patchFlag!==32&&Jn.push(d),d}const Ne=dg;function dg(e,t=null,o=null,i=0,s=null,a=!1){if((!e||e===Rm)&&(e=fn),Ga(e)){const u=ei(e,t,!0);return o&&fu(u,o),Va>0&&!a&&Jn&&(u.shapeFlag&6?Jn[Jn.indexOf(e)]=u:Jn.push(u)),u.patchFlag=-2,u}if(bg(e)&&(e=e.__vccOpts),t){t=hg(t);let{class:u,style:d}=t;u&&!zt(u)&&(t.class=_e(u)),xt(d)&&(vl(d)&&!tt(d)&&(d=Qt({},d)),t.style=ot(d))}const c=zt(e)?1:Hf(e)?128:vf(e)?64:xt(e)?4:ut(e)?2:0;return l(e,t,o,i,s,c,a,!0)}function hg(e){return e?vl(e)||Df(e)?Qt({},e):e:null}function ei(e,t,o=!1,i=!1){const{props:s,ref:a,patchFlag:c,children:u,transition:d}=e,p=t?jf(s||{},t):s,f={__v_isVNode:!0,__v_skip:!0,type:e.type,props:p,key:p&&Gf(p),ref:t&&t.ref?o&&a?tt(a)?a.concat(Hr(t)):[a,Hr(t)]:Hr(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==we?c===-1?16:c|16:c,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:d,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ei(e.ssContent),ssFallback:e.ssFallback&&ei(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return d&&i&&Ha(f,d.clone(f)),f}function Ve(e=" ",t=0){return Ne(bl,null,e,t)}function Zf(e,t){const o=Ne(zr,null,e);return o.staticCount=t,o}function D(e="",t=!1){return t?(v(),et(fn,null,e)):Ne(fn,null,e)}function Go(e){return e==null||typeof e=="boolean"?Ne(fn):tt(e)?Ne(we,null,e.slice()):Ga(e)?qs(e):Ne(bl,null,String(e))}function qs(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:ei(e)}function fu(e,t){let o=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(tt(t))o=16;else if(typeof t=="object")if(i&65){const s=t.default;s&&(s._c&&(s._d=!1),fu(e,s()),s._c&&(s._d=!0));return}else{o=32;const s=t._;!s&&!Df(t)?t._ctx=nn:s===3&&nn&&(nn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else ut(t)?(t={default:t,_ctx:nn},o=32):(t=String(t),i&64?(o=16,t=[Ve(t)]):o=8);e.children=t,e.shapeFlag|=o}function jf(...e){const t={};for(let o=0;o<e.length;o++){const i=e[o];for(const s in i)if(s==="class")t.class!==i.class&&(t.class=_e([t.class,i.class]));else if(s==="style")t.style=ot([t.style,i.style]);else if(ll(s)){const a=t[s],c=i[s];c&&a!==c&&!(tt(a)&&a.includes(c))&&(t[s]=a?[].concat(a,c):c)}else s!==""&&(t[s]=i[s])}return t}function zo(e,t,o,i=null){wo(e,t,7,[o,i])}const fg=Mf();let pg=0;function vg(e,t,o){const i=e.type,s=(t?t.appContext:e.appContext)||fg,a={uid:pg++,vnode:e,type:i,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Uh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Rf(i,s),emitsOptions:Af(i,s),emit:null,emitted:null,propsDefaults:Tt,inheritAttrs:i.inheritAttrs,ctx:Tt,data:Tt,props:Tt,attrs:Tt,slots:Tt,refs:Tt,setupState:Tt,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=Wm.bind(null,a),e.ce&&e.ce(a),a}let pn=null;const pu=()=>pn||nn;let tl,Ec;{const e=fl(),t=(o,i)=>{let s;return(s=e[o])||(s=e[o]=[]),s.push(i),a=>{s.length>1?s.forEach(c=>c(a)):s[0](a)}};tl=t("__VUE_INSTANCE_SETTERS__",o=>pn=o),Ec=t("__VUE_SSR_SETTERS__",o=>Za=o)}const er=e=>{const t=pn;return tl(e),e.scope.on(),()=>{e.scope.off(),tl(t)}},vd=()=>{pn&&pn.scope.off(),tl(null)};function Wf(e){return e.vnode.shapeFlag&4}let Za=!1;function mg(e,t=!1,o=!1){t&&Ec(t);const{props:i,children:s}=e.vnode,a=Wf(e);Qm(e,i,a,t),og(e,s,o||t);const c=a?gg(e,t):void 0;return t&&Ec(!1),c}function gg(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Nm);const{setup:i}=o;if(i){Ss();const s=e.setupContext=i.length>1?_g(e):null,a=er(e),c=Qa(i,e,0,[e.props,s]),u=Ph(c);if(xs(),a(),(u||e.sp)&&!Qi(e)&&Lf(e),u){if(c.then(vd,vd),t)return c.then(d=>{md(e,d)}).catch(d=>{ml(d,e,0)});e.asyncDep=c}else md(e,c)}else qf(e)}function md(e,t,o){ut(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:xt(t)&&(e.setupState=af(t)),qf(e)}function qf(e,t,o){const i=e.type;e.render||(e.render=i.render||Wo);{const s=er(e);Ss();try{Fm(e)}finally{xs(),s()}}}const yg={get(e,t){return hn(e,"get",""),e[t]}};function _g(e){const t=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,yg),slots:e.slots,emit:e.emit,expose:t}}function wl(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(af(lu(e.exposed)),{get(t,o){if(o in t)return t[o];if(o in Oa)return Oa[o](e)},has(t,o){return o in t||o in Oa}})):e.proxy}function kg(e,t=!0){return ut(e)?e.displayName||e.name:e.name||t&&e.__name}function bg(e){return ut(e)&&"__vccOpts"in e}const Y=(e,t)=>um(e,t,Za);function vu(e,t,o){try{el(-1);const i=arguments.length;return i===2?xt(t)&&!tt(t)?Ga(t)?Ne(e,null,[t]):Ne(e,t):Ne(e,null,t):(i>3?o=Array.prototype.slice.call(arguments,2):i===3&&Ga(o)&&(o=[o]),Ne(e,t,o))}finally{el(1)}}const wg="3.5.26";let Pc;const gd=typeof window<"u"&&window.trustedTypes;if(gd)try{Pc=gd.createPolicy("vue",{createHTML:e=>e})}catch{}const Kf=Pc?e=>Pc.createHTML(e):e=>e,Cg="http://www.w3.org/2000/svg",Lg="http://www.w3.org/1998/Math/MathML",hs=typeof document<"u"?document:null,yd=hs&&hs.createElement("template"),Sg={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,i)=>{const s=t==="svg"?hs.createElementNS(Cg,e):t==="mathml"?hs.createElementNS(Lg,e):o?hs.createElement(e,{is:o}):hs.createElement(e);return e==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:e=>hs.createTextNode(e),createComment:e=>hs.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>hs.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,o,i,s,a){const c=o?o.previousSibling:t.lastChild;if(s&&(s===a||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),o),!(s===a||!(s=s.nextSibling)););else{yd.innerHTML=Kf(i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e);const u=yd.content;if(i==="svg"||i==="mathml"){const d=u.firstChild;for(;d.firstChild;)u.appendChild(d.firstChild);u.removeChild(d)}t.insertBefore(u,o)}return[c?c.nextSibling:t.firstChild,o?o.previousSibling:t.lastChild]}},Vs="transition",ba="animation",ja=Symbol("_vtc"),Yf={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},xg=Qt({},yf,Yf),$g=e=>(e.displayName="Transition",e.props=xg,e),rc=$g((e,{slots:t})=>vu(Lm,Ig(e),t)),mi=(e,t=[])=>{tt(e)?e.forEach(o=>o(...t)):e&&e(...t)},_d=e=>e?tt(e)?e.some(t=>t.length>1):e.length>1:!1;function Ig(e){const t={};for(const se in e)se in Yf||(t[se]=e[se]);if(e.css===!1)return t;const{name:o="v",type:i,duration:s,enterFromClass:a=`${o}-enter-from`,enterActiveClass:c=`${o}-enter-active`,enterToClass:u=`${o}-enter-to`,appearFromClass:d=a,appearActiveClass:p=c,appearToClass:f=u,leaveFromClass:y=`${o}-leave-from`,leaveActiveClass:b=`${o}-leave-active`,leaveToClass:I=`${o}-leave-to`}=e,T=Tg(s),S=T&&T[0],O=T&&T[1],{onBeforeEnter:E,onEnter:A,onEnterCancelled:$,onLeave:C,onLeaveCancelled:w,onBeforeAppear:k=E,onAppear:M=A,onAppearCancelled:G=$}=t,ne=(se,me,Re,Oe)=>{se._enterCancelled=Oe,gi(se,me?f:u),gi(se,me?p:c),Re&&Re()},ce=(se,me)=>{se._isLeaving=!1,gi(se,y),gi(se,I),gi(se,b),me&&me()},K=se=>(me,Re)=>{const Oe=se?M:A,de=()=>ne(me,se,Re);mi(Oe,[me,de]),kd(()=>{gi(me,se?d:a),us(me,se?f:u),_d(Oe)||bd(me,i,S,de)})};return Qt(t,{onBeforeEnter(se){mi(E,[se]),us(se,a),us(se,c)},onBeforeAppear(se){mi(k,[se]),us(se,d),us(se,p)},onEnter:K(!1),onAppear:K(!0),onLeave(se,me){se._isLeaving=!0;const Re=()=>ce(se,me);us(se,y),se._enterCancelled?(us(se,b),Ld(se)):(Ld(se),us(se,b)),kd(()=>{se._isLeaving&&(gi(se,y),us(se,I),_d(C)||bd(se,i,O,Re))}),mi(C,[se,Re])},onEnterCancelled(se){ne(se,!1,void 0,!0),mi($,[se])},onAppearCancelled(se){ne(se,!0,void 0,!0),mi(G,[se])},onLeaveCancelled(se){ce(se),mi(w,[se])}})}function Tg(e){if(e==null)return null;if(xt(e))return[lc(e.enter),lc(e.leave)];{const t=lc(e);return[t,t]}}function lc(e){return Tv(e)}function us(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e[ja]||(e[ja]=new Set)).add(t)}function gi(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const o=e[ja];o&&(o.delete(t),o.size||(e[ja]=void 0))}function kd(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Mg=0;function bd(e,t,o,i){const s=e._endId=++Mg,a=()=>{s===e._endId&&i()};if(o!=null)return setTimeout(a,o);const{type:c,timeout:u,propCount:d}=Ag(e,t);if(!c)return i();const p=c+"end";let f=0;const y=()=>{e.removeEventListener(p,b),a()},b=I=>{I.target===e&&++f>=d&&y()};setTimeout(()=>{f<d&&y()},u+1),e.addEventListener(p,b)}function Ag(e,t){const o=window.getComputedStyle(e),i=T=>(o[T]||"").split(", "),s=i(`${Vs}Delay`),a=i(`${Vs}Duration`),c=wd(s,a),u=i(`${ba}Delay`),d=i(`${ba}Duration`),p=wd(u,d);let f=null,y=0,b=0;t===Vs?c>0&&(f=Vs,y=c,b=a.length):t===ba?p>0&&(f=ba,y=p,b=d.length):(y=Math.max(c,p),f=y>0?c>p?Vs:ba:null,b=f?f===Vs?a.length:d.length:0);const I=f===Vs&&/\b(?:transform|all)(?:,|$)/.test(i(`${Vs}Property`).toString());return{type:f,timeout:y,propCount:b,hasTransform:I}}function wd(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((o,i)=>Cd(o)+Cd(e[i])))}function Cd(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function Ld(e){return(e?e.ownerDocument:document).body.offsetHeight}function Eg(e,t,o){const i=e[ja];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}const nl=Symbol("_vod"),Jf=Symbol("_vsh"),ti={name:"show",beforeMount(e,{value:t},{transition:o}){e[nl]=e.style.display==="none"?"":e.style.display,o&&t?o.beforeEnter(e):wa(e,t)},mounted(e,{value:t},{transition:o}){o&&t&&o.enter(e)},updated(e,{value:t,oldValue:o},{transition:i}){!t!=!o&&(i?t?(i.beforeEnter(e),wa(e,!0),i.enter(e)):i.leave(e,()=>{wa(e,!1)}):wa(e,t))},beforeUnmount(e,{value:t}){wa(e,t)}};function wa(e,t){e.style.display=t?e[nl]:"none",e[Jf]=!t}const Pg=Symbol(""),Dg=/(?:^|;)\s*display\s*:/;function Og(e,t,o){const i=e.style,s=zt(o);let a=!1;if(o&&!s){if(t)if(zt(t))for(const c of t.split(";")){const u=c.slice(0,c.indexOf(":")).trim();o[u]==null&&Vr(i,u,"")}else for(const c in t)o[c]==null&&Vr(i,c,"");for(const c in o)c==="display"&&(a=!0),Vr(i,c,o[c])}else if(s){if(t!==o){const c=i[Pg];c&&(o+=";"+c),i.cssText=o,a=Dg.test(o)}}else t&&e.removeAttribute("style");nl in e&&(e[nl]=a?i.display:"",e[Jf]&&(i.display="none"))}const Sd=/\s*!important$/;function Vr(e,t,o){if(tt(o))o.forEach(i=>Vr(e,t,i));else if(o==null&&(o=""),t.startsWith("--"))e.setProperty(t,o);else{const i=Rg(e,t);Sd.test(o)?e.setProperty(oi(i),o.replace(Sd,""),"important"):e[i]=o}}const xd=["Webkit","Moz","ms"],cc={};function Rg(e,t){const o=cc[t];if(o)return o;let i=lo(t);if(i!=="filter"&&i in e)return cc[t]=i;i=dl(i);for(let s=0;s<xd.length;s++){const a=xd[s]+i;if(a in e)return cc[t]=a}return t}const $d="http://www.w3.org/1999/xlink";function Id(e,t,o,i,s,a=Ov(t)){i&&t.startsWith("xlink:")?o==null?e.removeAttributeNS($d,t.slice(6,t.length)):e.setAttributeNS($d,t,o):o==null||a&&!Bh(o)?e.removeAttribute(t):e.setAttribute(t,a?"":ko(o)?String(o):o)}function Td(e,t,o,i,s){if(t==="innerHTML"||t==="textContent"){o!=null&&(e[t]=t==="innerHTML"?Kf(o):o);return}const a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){const u=a==="OPTION"?e.getAttribute("value")||"":e.value,d=o==null?e.type==="checkbox"?"on":"":String(o);(u!==d||!("_value"in e))&&(e.value=d),o==null&&e.removeAttribute(t),e._value=o;return}let c=!1;if(o===""||o==null){const u=typeof e[t];u==="boolean"?o=Bh(o):o==null&&u==="string"?(o="",c=!0):u==="number"&&(o=0,c=!0)}try{e[t]=o}catch{}c&&e.removeAttribute(s||t)}function gs(e,t,o,i){e.addEventListener(t,o,i)}function Bg(e,t,o,i){e.removeEventListener(t,o,i)}const Md=Symbol("_vei");function Ng(e,t,o,i,s=null){const a=e[Md]||(e[Md]={}),c=a[t];if(i&&c)c.value=i;else{const[u,d]=Fg(t);if(i){const p=a[t]=Hg(i,s);gs(e,u,p,d)}else c&&(Bg(e,u,c,d),a[t]=void 0)}}const Ad=/(?:Once|Passive|Capture)$/;function Fg(e){let t;if(Ad.test(e)){t={};let i;for(;i=e.match(Ad);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):oi(e.slice(2)),t]}let uc=0;const Ug=Promise.resolve(),zg=()=>uc||(Ug.then(()=>uc=0),uc=Date.now());function Hg(e,t){const o=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=o.attached)return;wo(Vg(i,o.value),t,5,[i])};return o.value=e,o.attached=zg(),o}function Vg(e,t){if(tt(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map(i=>s=>!s._stopped&&i&&i(s))}else return t}const Ed=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Gg=(e,t,o,i,s,a)=>{const c=s==="svg";t==="class"?Eg(e,i,c):t==="style"?Og(e,o,i):ll(t)?Qc(t)||Ng(e,t,o,i,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Zg(e,t,i,c))?(Td(e,t,i),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Id(e,t,i,c,a,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!zt(i))?Td(e,lo(t),i,a,t):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),Id(e,t,i,c))};function Zg(e,t,o,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&Ed(t)&&ut(o));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Ed(t)&&zt(o)?!1:t in e}const ni=e=>{const t=e.props["onUpdate:modelValue"]||!1;return tt(t)?o=>Nr(t,o):t};function jg(e){e.target.composing=!0}function Pd(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const ro=Symbol("_assign");function Dd(e,t,o){return t&&(e=e.trim()),o&&(e=hl(e)),e}const at={created(e,{modifiers:{lazy:t,trim:o,number:i}},s){e[ro]=ni(s);const a=i||s.props&&s.props.type==="number";gs(e,t?"change":"input",c=>{c.target.composing||e[ro](Dd(e.value,o,a))}),(o||a)&&gs(e,"change",()=>{e.value=Dd(e.value,o,a)}),t||(gs(e,"compositionstart",jg),gs(e,"compositionend",Pd),gs(e,"change",Pd))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:o,modifiers:{lazy:i,trim:s,number:a}},c){if(e[ro]=ni(c),e.composing)return;const u=(a||e.type==="number")&&!/^0\d/.test(e.value)?hl(e.value):e.value,d=t??"";u!==d&&(document.activeElement===e&&e.type!=="range"&&(i&&t===o||s&&e.value.trim()===d)||(e.value=d))}},ys={deep:!0,created(e,t,o){e[ro]=ni(o),gs(e,"change",()=>{const i=e._modelValue,s=na(e),a=e.checked,c=e[ro];if(tt(i)){const u=tu(i,s),d=u!==-1;if(a&&!d)c(i.concat(s));else if(!a&&d){const p=[...i];p.splice(u,1),c(p)}}else if(aa(i)){const u=new Set(i);a?u.add(s):u.delete(s),c(u)}else c(Xf(e,a))})},mounted:Od,beforeUpdate(e,t,o){e[ro]=ni(o),Od(e,t,o)}};function Od(e,{value:t,oldValue:o},i){e._modelValue=t;let s;if(tt(t))s=tu(t,i.props.value)>-1;else if(aa(t))s=t.has(i.props.value);else{if(t===o)return;s=Ai(t,Xf(e,!0))}e.checked!==s&&(e.checked=s)}const Rd={created(e,{value:t},o){e.checked=Ai(t,o.props.value),e[ro]=ni(o),gs(e,"change",()=>{e[ro](na(e))})},beforeUpdate(e,{value:t,oldValue:o},i){e[ro]=ni(i),t!==o&&(e.checked=Ai(t,i.props.value))}},vn={deep:!0,created(e,{value:t,modifiers:{number:o}},i){const s=aa(t);gs(e,"change",()=>{const a=Array.prototype.filter.call(e.options,c=>c.selected).map(c=>o?hl(na(c)):na(c));e[ro](e.multiple?s?new Set(a):a:a[0]),e._assigning=!0,Ls(()=>{e._assigning=!1})}),e[ro]=ni(i)},mounted(e,{value:t}){Bd(e,t)},beforeUpdate(e,t,o){e[ro]=ni(o)},updated(e,{value:t}){e._assigning||Bd(e,t)}};function Bd(e,t){const o=e.multiple,i=tt(t);if(!(o&&!i&&!aa(t))){for(let s=0,a=e.options.length;s<a;s++){const c=e.options[s],u=na(c);if(o)if(i){const d=typeof u;d==="string"||d==="number"?c.selected=t.some(p=>String(p)===String(u)):c.selected=tu(t,u)>-1}else c.selected=t.has(u);else if(Ai(na(c),t)){e.selectedIndex!==s&&(e.selectedIndex=s);return}}!o&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function na(e){return"_value"in e?e._value:e.value}function Xf(e,t){const o=t?"_trueValue":"_falseValue";return o in e?e[o]:t}const Wg=["ctrl","shift","alt","meta"],qg={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Wg.some(o=>e[`${o}Key`]&&!t.includes(o))},gt=(e,t)=>{const o=e._withMods||(e._withMods={}),i=t.join(".");return o[i]||(o[i]=((s,...a)=>{for(let c=0;c<t.length;c++){const u=qg[t[c]];if(u&&u(s,t))return}return e(s,...a)}))},Kg={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Qf=(e,t)=>{const o=e._withKeys||(e._withKeys={}),i=t.join(".");return o[i]||(o[i]=(s=>{if(!("key"in s))return;const a=oi(s.key);if(t.some(c=>c===a||Kg[c]===a))return e(s)}))},Yg=Qt({patchProp:Gg},Sg);let Nd;function Jg(){return Nd||(Nd=ig(Yg))}const Xg=((...e)=>{const t=Jg().createApp(...e),{mount:o}=t;return t.mount=i=>{const s=ey(i);if(!s)return;const a=t._component;!ut(a)&&!a.render&&!a.template&&(a.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const c=o(s,!1,Qg(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),c},t});function Qg(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function ey(e){return zt(e)?document.querySelector(e):e}let ep;const Cl=e=>ep=e,tp=Symbol();function Dc(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Ba;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Ba||(Ba={}));function ty(){const e=zh(!0),t=e.run(()=>P({}));let o=[],i=[];const s=lu({install(a){Cl(s),s._a=a,a.provide(tp,s),a.config.globalProperties.$pinia=s,i.forEach(c=>o.push(c)),i=[]},use(a){return this._a?o.push(a):i.push(a),this},_p:o,_a:null,_e:e,_s:new Map,state:t});return s}const np=()=>{};function Fd(e,t,o,i=np){e.add(t);const s=()=>{e.delete(t)&&i()};return!o&&Hh()&&Bv(s),s}function Gi(e,...t){e.forEach(o=>{o(...t)})}const ny=e=>e(),Ud=Symbol(),dc=Symbol();function Oc(e,t){e instanceof Map&&t instanceof Map?t.forEach((o,i)=>e.set(i,o)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const o in t){if(!t.hasOwnProperty(o))continue;const i=t[o],s=e[o];Dc(s)&&Dc(i)&&e.hasOwnProperty(o)&&!Ut(i)&&!Cs(i)?e[o]=Oc(s,i):e[o]=i}return e}const oy=Symbol();function sy(e){return!Dc(e)||!Object.prototype.hasOwnProperty.call(e,oy)}const{assign:Zs}=Object;function iy(e){return!!(Ut(e)&&e.effect)}function ay(e,t,o,i){const{state:s,actions:a,getters:c}=t,u=o.state.value[e];let d;function p(){u||(o.state.value[e]=s?s():{});const f=am(o.state.value[e]);return Zs(f,a,Object.keys(c||{}).reduce((y,b)=>(y[b]=lu(Y(()=>{Cl(o);const I=o._s.get(e);return c[b].call(I,I)})),y),{}))}return d=op(e,p,t,o,i,!0),d}function op(e,t,o={},i,s,a){let c;const u=Zs({actions:{}},o),d={deep:!0};let p,f,y=new Set,b=new Set,I;const T=i.state.value[e];!a&&!T&&(i.state.value[e]={}),P({});let S;function O(G){let ne;p=f=!1,typeof G=="function"?(G(i.state.value[e]),ne={type:Ba.patchFunction,storeId:e,events:I}):(Oc(i.state.value[e],G),ne={type:Ba.patchObject,payload:G,storeId:e,events:I});const ce=S=Symbol();Ls().then(()=>{S===ce&&(p=!0)}),f=!0,Gi(y,ne,i.state.value[e])}const E=a?function(){const{state:ne}=o,ce=ne?ne():{};this.$patch(K=>{Zs(K,ce)})}:np;function A(){c.stop(),y.clear(),b.clear(),i._s.delete(e)}const $=(G,ne="")=>{if(Ud in G)return G[dc]=ne,G;const ce=function(){Cl(i);const K=Array.from(arguments),se=new Set,me=new Set;function Re(he){se.add(he)}function Oe(he){me.add(he)}Gi(b,{args:K,name:ce[dc],store:w,after:Re,onError:Oe});let de;try{de=G.apply(this&&this.$id===e?this:w,K)}catch(he){throw Gi(me,he),he}return de instanceof Promise?de.then(he=>(Gi(se,he),he)).catch(he=>(Gi(me,he),Promise.reject(he))):(Gi(se,de),de)};return ce[Ud]=!0,ce[dc]=ne,ce},C={_p:i,$id:e,$onAction:Fd.bind(null,b),$patch:O,$reset:E,$subscribe(G,ne={}){const ce=Fd(y,G,ne.detached,()=>K()),K=c.run(()=>We(()=>i.state.value[e],se=>{(ne.flush==="sync"?f:p)&&G({storeId:e,type:Ba.direct,events:I},se)},Zs({},d,ne)));return ce},$dispose:A},w=Xa(C);i._s.set(e,w);const M=(i._a&&i._a.runWithContext||ny)(()=>i._e.run(()=>(c=zh()).run(()=>t({action:$}))));for(const G in M){const ne=M[G];if(Ut(ne)&&!iy(ne)||Cs(ne))a||(T&&sy(ne)&&(Ut(ne)?ne.value=T[G]:Oc(ne,T[G])),i.state.value[e][G]=ne);else if(typeof ne=="function"){const ce=$(ne,G);M[G]=ce,u.actions[G]=ne}}return Zs(w,M),Zs(kt(w),M),Object.defineProperty(w,"$state",{get:()=>i.state.value[e],set:G=>{O(ne=>{Zs(ne,G)})}}),i._p.forEach(G=>{Zs(w,c.run(()=>G({store:w,app:i._a,pinia:i,options:u})))}),T&&a&&o.hydrate&&o.hydrate(w.$state,T),p=!0,f=!0,w}function mu(e,t,o){let i;const s=typeof t=="function";i=s?o:t;function a(c,u){const d=mm();return c=c||(d?ao(tp,null):null),c&&Cl(c),c=ep,c._s.has(e)||(s?op(e,t,i,c):ay(e,i,c)),c._s.get(e)}return a.$id=e,a}const Ye=(e,t)=>{const o=e.__vccOpts||e;for(const[i,s]of t)o[i]=s;return o},ry={},ly={id:"app"};function cy(e,t){const o=_l("router-view");return v(),m("div",ly,[Ne(o)])}const uy=Ye(ry,[["render",cy]]);const ji=typeof document<"u";function sp(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function dy(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&sp(e.default)}const wt=Object.assign;function hc(e,t){const o={};for(const i in t){const s=t[i];o[i]=Co(s)?s.map(e):e(s)}return o}const Na=()=>{},Co=Array.isArray;function zd(e,t){const o={};for(const i in e)o[i]=i in t?t[i]:e[i];return o}const ip=/#/g,hy=/&/g,fy=/\//g,py=/=/g,vy=/\?/g,ap=/\+/g,my=/%5B/g,gy=/%5D/g,rp=/%5E/g,yy=/%60/g,lp=/%7B/g,_y=/%7C/g,cp=/%7D/g,ky=/%20/g;function gu(e){return e==null?"":encodeURI(""+e).replace(_y,"|").replace(my,"[").replace(gy,"]")}function by(e){return gu(e).replace(lp,"{").replace(cp,"}").replace(rp,"^")}function Rc(e){return gu(e).replace(ap,"%2B").replace(ky,"+").replace(ip,"%23").replace(hy,"%26").replace(yy,"`").replace(lp,"{").replace(cp,"}").replace(rp,"^")}function wy(e){return Rc(e).replace(py,"%3D")}function Cy(e){return gu(e).replace(ip,"%23").replace(vy,"%3F")}function Ly(e){return Cy(e).replace(fy,"%2F")}function Wa(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const Sy=/\/$/,xy=e=>e.replace(Sy,"");function fc(e,t,o="/"){let i,s={},a="",c="";const u=t.indexOf("#");let d=t.indexOf("?");return d=u>=0&&d>u?-1:d,d>=0&&(i=t.slice(0,d),a=t.slice(d,u>0?u:t.length),s=e(a.slice(1))),u>=0&&(i=i||t.slice(0,u),c=t.slice(u,t.length)),i=My(i??t,o),{fullPath:i+a+c,path:i,query:s,hash:Wa(c)}}function $y(e,t){const o=t.query?e(t.query):"";return t.path+(o&&"?")+o+(t.hash||"")}function Hd(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Iy(e,t,o){const i=t.matched.length-1,s=o.matched.length-1;return i>-1&&i===s&&oa(t.matched[i],o.matched[s])&&up(t.params,o.params)&&e(t.query)===e(o.query)&&t.hash===o.hash}function oa(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function up(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var o in e)if(!Ty(e[o],t[o]))return!1;return!0}function Ty(e,t){return Co(e)?Vd(e,t):Co(t)?Vd(t,e):e?.valueOf()===t?.valueOf()}function Vd(e,t){return Co(t)?e.length===t.length&&e.every((o,i)=>o===t[i]):e.length===1&&e[0]===t}function My(e,t){if(e.startsWith("/"))return e;if(!e)return t;const o=t.split("/"),i=e.split("/"),s=i[i.length-1];(s===".."||s===".")&&i.push("");let a=o.length-1,c,u;for(c=0;c<i.length;c++)if(u=i[c],u!==".")if(u==="..")a>1&&a--;else break;return o.slice(0,a).join("/")+"/"+i.slice(c).join("/")}const Gs={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let Bc=(function(e){return e.pop="pop",e.push="push",e})({}),pc=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function Ay(e){if(!e)if(ji){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),xy(e)}const Ey=/^[^#]+#/;function Py(e,t){return e.replace(Ey,"#")+t}function Dy(e,t){const o=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-o.left-(t.left||0),top:i.top-o.top-(t.top||0)}}const Ll=()=>({left:window.scrollX,top:window.scrollY});function Oy(e){let t;if("el"in e){const o=e.el,i=typeof o=="string"&&o.startsWith("#"),s=typeof o=="string"?i?document.getElementById(o.slice(1)):document.querySelector(o):o;if(!s)return;t=Dy(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function Gd(e,t){return(history.state?history.state.position-t:-1)+e}const Nc=new Map;function Ry(e,t){Nc.set(e,t)}function By(e){const t=Nc.get(e);return Nc.delete(e),t}function Ny(e){return typeof e=="string"||e&&typeof e=="object"}function dp(e){return typeof e=="string"||typeof e=="symbol"}let Ft=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const hp=Symbol("");Ft.MATCHER_NOT_FOUND+"",Ft.NAVIGATION_GUARD_REDIRECT+"",Ft.NAVIGATION_ABORTED+"",Ft.NAVIGATION_CANCELLED+"",Ft.NAVIGATION_DUPLICATED+"";function sa(e,t){return wt(new Error,{type:e,[hp]:!0},t)}function ds(e,t){return e instanceof Error&&hp in e&&(t==null||!!(e.type&t))}const Fy=["params","query","hash"];function Uy(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const o of Fy)o in e&&(t[o]=e[o]);return JSON.stringify(t,null,2)}function zy(e){const t={};if(e===""||e==="?")return t;const o=(e[0]==="?"?e.slice(1):e).split("&");for(let i=0;i<o.length;++i){const s=o[i].replace(ap," "),a=s.indexOf("="),c=Wa(a<0?s:s.slice(0,a)),u=a<0?null:Wa(s.slice(a+1));if(c in t){let d=t[c];Co(d)||(d=t[c]=[d]),d.push(u)}else t[c]=u}return t}function Zd(e){let t="";for(let o in e){const i=e[o];if(o=wy(o),i==null){i!==void 0&&(t+=(t.length?"&":"")+o);continue}(Co(i)?i.map(s=>s&&Rc(s)):[i&&Rc(i)]).forEach(s=>{s!==void 0&&(t+=(t.length?"&":"")+o,s!=null&&(t+="="+s))})}return t}function Hy(e){const t={};for(const o in e){const i=e[o];i!==void 0&&(t[o]=Co(i)?i.map(s=>s==null?null:""+s):i==null?i:""+i)}return t}const Vy=Symbol(""),jd=Symbol(""),Sl=Symbol(""),yu=Symbol(""),Fc=Symbol("");function Ca(){let e=[];function t(i){return e.push(i),()=>{const s=e.indexOf(i);s>-1&&e.splice(s,1)}}function o(){e=[]}return{add:t,list:()=>e.slice(),reset:o}}function Ks(e,t,o,i,s,a=c=>c()){const c=i&&(i.enterCallbacks[s]=i.enterCallbacks[s]||[]);return()=>new Promise((u,d)=>{const p=b=>{b===!1?d(sa(Ft.NAVIGATION_ABORTED,{from:o,to:t})):b instanceof Error?d(b):Ny(b)?d(sa(Ft.NAVIGATION_GUARD_REDIRECT,{from:t,to:b})):(c&&i.enterCallbacks[s]===c&&typeof b=="function"&&c.push(b),u())},f=a(()=>e.call(i&&i.instances[s],t,o,p));let y=Promise.resolve(f);e.length<3&&(y=y.then(p)),y.catch(b=>d(b))})}function vc(e,t,o,i,s=a=>a()){const a=[];for(const c of e)for(const u in c.components){let d=c.components[u];if(!(t!=="beforeRouteEnter"&&!c.instances[u]))if(sp(d)){const p=(d.__vccOpts||d)[t];p&&a.push(Ks(p,o,i,c,u,s))}else{let p=d();a.push(()=>p.then(f=>{if(!f)throw new Error(`Couldn't resolve component "${u}" at "${c.path}"`);const y=dy(f)?f.default:f;c.mods[u]=f,c.components[u]=y;const b=(y.__vccOpts||y)[t];return b&&Ks(b,o,i,c,u,s)()}))}}return a}function Gy(e,t){const o=[],i=[],s=[],a=Math.max(t.matched.length,e.matched.length);for(let c=0;c<a;c++){const u=t.matched[c];u&&(e.matched.find(p=>oa(p,u))?i.push(u):o.push(u));const d=e.matched[c];d&&(t.matched.find(p=>oa(p,d))||s.push(d))}return[o,i,s]}let Zy=()=>location.protocol+"//"+location.host;function fp(e,t){const{pathname:o,search:i,hash:s}=t,a=e.indexOf("#");if(a>-1){let c=s.includes(e.slice(a))?e.slice(a).length:1,u=s.slice(c);return u[0]!=="/"&&(u="/"+u),Hd(u,"")}return Hd(o,e)+i+s}function jy(e,t,o,i){let s=[],a=[],c=null;const u=({state:b})=>{const I=fp(e,location),T=o.value,S=t.value;let O=0;if(b){if(o.value=I,t.value=b,c&&c===T){c=null;return}O=S?b.position-S.position:0}else i(I);s.forEach(E=>{E(o.value,T,{delta:O,type:Bc.pop,direction:O?O>0?pc.forward:pc.back:pc.unknown})})};function d(){c=o.value}function p(b){s.push(b);const I=()=>{const T=s.indexOf(b);T>-1&&s.splice(T,1)};return a.push(I),I}function f(){if(document.visibilityState==="hidden"){const{history:b}=window;if(!b.state)return;b.replaceState(wt({},b.state,{scroll:Ll()}),"")}}function y(){for(const b of a)b();a=[],window.removeEventListener("popstate",u),window.removeEventListener("pagehide",f),document.removeEventListener("visibilitychange",f)}return window.addEventListener("popstate",u),window.addEventListener("pagehide",f),document.addEventListener("visibilitychange",f),{pauseListeners:d,listen:p,destroy:y}}function Wd(e,t,o,i=!1,s=!1){return{back:e,current:t,forward:o,replaced:i,position:window.history.length,scroll:s?Ll():null}}function Wy(e){const{history:t,location:o}=window,i={value:fp(e,o)},s={value:t.state};s.value||a(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function a(d,p,f){const y=e.indexOf("#"),b=y>-1?(o.host&&document.querySelector("base")?e:e.slice(y))+d:Zy()+e+d;try{t[f?"replaceState":"pushState"](p,"",b),s.value=p}catch(I){console.error(I),o[f?"replace":"assign"](b)}}function c(d,p){a(d,wt({},t.state,Wd(s.value.back,d,s.value.forward,!0),p,{position:s.value.position}),!0),i.value=d}function u(d,p){const f=wt({},s.value,t.state,{forward:d,scroll:Ll()});a(f.current,f,!0),a(d,wt({},Wd(i.value,d,null),{position:f.position+1},p),!1),i.value=d}return{location:i,state:s,push:u,replace:c}}function qy(e){e=Ay(e);const t=Wy(e),o=jy(e,t.state,t.location,t.replace);function i(a,c=!0){c||o.pauseListeners(),history.go(a)}const s=wt({location:"",base:e,go:i,createHref:Py.bind(null,e)},t,o);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function Ky(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),qy(e)}let Li=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var Wt=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(Wt||{});const Yy={type:Li.Static,value:""},Jy=/[a-zA-Z0-9_]/;function Xy(e){if(!e)return[[]];if(e==="/")return[[Yy]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(I){throw new Error(`ERR (${o})/"${p}": ${I}`)}let o=Wt.Static,i=o;const s=[];let a;function c(){a&&s.push(a),a=[]}let u=0,d,p="",f="";function y(){p&&(o===Wt.Static?a.push({type:Li.Static,value:p}):o===Wt.Param||o===Wt.ParamRegExp||o===Wt.ParamRegExpEnd?(a.length>1&&(d==="*"||d==="+")&&t(`A repeatable param (${p}) must be alone in its segment. eg: '/:ids+.`),a.push({type:Li.Param,value:p,regexp:f,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):t("Invalid state to consume buffer"),p="")}function b(){p+=d}for(;u<e.length;){if(d=e[u++],d==="\\"&&o!==Wt.ParamRegExp){i=o,o=Wt.EscapeNext;continue}switch(o){case Wt.Static:d==="/"?(p&&y(),c()):d===":"?(y(),o=Wt.Param):b();break;case Wt.EscapeNext:b(),o=i;break;case Wt.Param:d==="("?o=Wt.ParamRegExp:Jy.test(d)?b():(y(),o=Wt.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--);break;case Wt.ParamRegExp:d===")"?f[f.length-1]=="\\"?f=f.slice(0,-1)+d:o=Wt.ParamRegExpEnd:f+=d;break;case Wt.ParamRegExpEnd:y(),o=Wt.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--,f="";break;default:t("Unknown state");break}}return o===Wt.ParamRegExp&&t(`Unfinished custom RegExp for param "${p}"`),y(),c(),s}const qd="[^/]+?",Qy={sensitive:!1,strict:!1,start:!0,end:!0};var Tn=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(Tn||{});const e_=/[.+*?^${}()[\]/\\]/g;function t_(e,t){const o=wt({},Qy,t),i=[];let s=o.start?"^":"";const a=[];for(const p of e){const f=p.length?[]:[Tn.Root];o.strict&&!p.length&&(s+="/");for(let y=0;y<p.length;y++){const b=p[y];let I=Tn.Segment+(o.sensitive?Tn.BonusCaseSensitive:0);if(b.type===Li.Static)y||(s+="/"),s+=b.value.replace(e_,"\\$&"),I+=Tn.Static;else if(b.type===Li.Param){const{value:T,repeatable:S,optional:O,regexp:E}=b;a.push({name:T,repeatable:S,optional:O});const A=E||qd;if(A!==qd){I+=Tn.BonusCustomRegExp;try{`${A}`}catch(C){throw new Error(`Invalid custom RegExp for param "${T}" (${A}): `+C.message)}}let $=S?`((?:${A})(?:/(?:${A}))*)`:`(${A})`;y||($=O&&p.length<2?`(?:/${$})`:"/"+$),O&&($+="?"),s+=$,I+=Tn.Dynamic,O&&(I+=Tn.BonusOptional),S&&(I+=Tn.BonusRepeatable),A===".*"&&(I+=Tn.BonusWildcard)}f.push(I)}i.push(f)}if(o.strict&&o.end){const p=i.length-1;i[p][i[p].length-1]+=Tn.BonusStrict}o.strict||(s+="/?"),o.end?s+="$":o.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const c=new RegExp(s,o.sensitive?"":"i");function u(p){const f=p.match(c),y={};if(!f)return null;for(let b=1;b<f.length;b++){const I=f[b]||"",T=a[b-1];y[T.name]=I&&T.repeatable?I.split("/"):I}return y}function d(p){let f="",y=!1;for(const b of e){(!y||!f.endsWith("/"))&&(f+="/"),y=!1;for(const I of b)if(I.type===Li.Static)f+=I.value;else if(I.type===Li.Param){const{value:T,repeatable:S,optional:O}=I,E=T in p?p[T]:"";if(Co(E)&&!S)throw new Error(`Provided param "${T}" is an array but it is not repeatable (* or + modifiers)`);const A=Co(E)?E.join("/"):E;if(!A)if(O)b.length<2&&(f.endsWith("/")?f=f.slice(0,-1):y=!0);else throw new Error(`Missing required param "${T}"`);f+=A}}return f||"/"}return{re:c,score:i,keys:a,parse:u,stringify:d}}function n_(e,t){let o=0;for(;o<e.length&&o<t.length;){const i=t[o]-e[o];if(i)return i;o++}return e.length<t.length?e.length===1&&e[0]===Tn.Static+Tn.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===Tn.Static+Tn.Segment?1:-1:0}function pp(e,t){let o=0;const i=e.score,s=t.score;for(;o<i.length&&o<s.length;){const a=n_(i[o],s[o]);if(a)return a;o++}if(Math.abs(s.length-i.length)===1){if(Kd(i))return 1;if(Kd(s))return-1}return s.length-i.length}function Kd(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const o_={strict:!1,end:!0,sensitive:!1};function s_(e,t,o){const i=t_(Xy(e.path),o),s=wt(i,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function i_(e,t){const o=[],i=new Map;t=zd(o_,t);function s(y){return i.get(y)}function a(y,b,I){const T=!I,S=Jd(y);S.aliasOf=I&&I.record;const O=zd(t,y),E=[S];if("alias"in y){const C=typeof y.alias=="string"?[y.alias]:y.alias;for(const w of C)E.push(Jd(wt({},S,{components:I?I.record.components:S.components,path:w,aliasOf:I?I.record:S})))}let A,$;for(const C of E){const{path:w}=C;if(b&&w[0]!=="/"){const k=b.record.path,M=k[k.length-1]==="/"?"":"/";C.path=b.record.path+(w&&M+w)}if(A=s_(C,b,O),I?I.alias.push(A):($=$||A,$!==A&&$.alias.push(A),T&&y.name&&!Xd(A)&&c(y.name)),vp(A)&&d(A),S.children){const k=S.children;for(let M=0;M<k.length;M++)a(k[M],A,I&&I.children[M])}I=I||A}return $?()=>{c($)}:Na}function c(y){if(dp(y)){const b=i.get(y);b&&(i.delete(y),o.splice(o.indexOf(b),1),b.children.forEach(c),b.alias.forEach(c))}else{const b=o.indexOf(y);b>-1&&(o.splice(b,1),y.record.name&&i.delete(y.record.name),y.children.forEach(c),y.alias.forEach(c))}}function u(){return o}function d(y){const b=l_(y,o);o.splice(b,0,y),y.record.name&&!Xd(y)&&i.set(y.record.name,y)}function p(y,b){let I,T={},S,O;if("name"in y&&y.name){if(I=i.get(y.name),!I)throw sa(Ft.MATCHER_NOT_FOUND,{location:y});O=I.record.name,T=wt(Yd(b.params,I.keys.filter($=>!$.optional).concat(I.parent?I.parent.keys.filter($=>$.optional):[]).map($=>$.name)),y.params&&Yd(y.params,I.keys.map($=>$.name))),S=I.stringify(T)}else if(y.path!=null)S=y.path,I=o.find($=>$.re.test(S)),I&&(T=I.parse(S),O=I.record.name);else{if(I=b.name?i.get(b.name):o.find($=>$.re.test(b.path)),!I)throw sa(Ft.MATCHER_NOT_FOUND,{location:y,currentLocation:b});O=I.record.name,T=wt({},b.params,y.params),S=I.stringify(T)}const E=[];let A=I;for(;A;)E.unshift(A.record),A=A.parent;return{name:O,path:S,params:T,matched:E,meta:r_(E)}}e.forEach(y=>a(y));function f(){o.length=0,i.clear()}return{addRoute:a,resolve:p,removeRoute:c,clearRoutes:f,getRoutes:u,getRecordMatcher:s}}function Yd(e,t){const o={};for(const i of t)i in e&&(o[i]=e[i]);return o}function Jd(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:a_(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function a_(e){const t={},o=e.props||!1;if("component"in e)t.default=o;else for(const i in e.components)t[i]=typeof o=="object"?o[i]:o;return t}function Xd(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function r_(e){return e.reduce((t,o)=>wt(t,o.meta),{})}function l_(e,t){let o=0,i=t.length;for(;o!==i;){const a=o+i>>1;pp(e,t[a])<0?i=a:o=a+1}const s=c_(e);return s&&(i=t.lastIndexOf(s,i-1)),i}function c_(e){let t=e;for(;t=t.parent;)if(vp(t)&&pp(e,t)===0)return t}function vp({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Qd(e){const t=ao(Sl),o=ao(yu),i=Y(()=>{const d=V(e.to);return t.resolve(d)}),s=Y(()=>{const{matched:d}=i.value,{length:p}=d,f=d[p-1],y=o.matched;if(!f||!y.length)return-1;const b=y.findIndex(oa.bind(null,f));if(b>-1)return b;const I=eh(d[p-2]);return p>1&&eh(f)===I&&y[y.length-1].path!==I?y.findIndex(oa.bind(null,d[p-2])):b}),a=Y(()=>s.value>-1&&p_(o.params,i.value.params)),c=Y(()=>s.value>-1&&s.value===o.matched.length-1&&up(o.params,i.value.params));function u(d={}){if(f_(d)){const p=t[V(e.replace)?"replace":"push"](V(e.to)).catch(Na);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>p),p}return Promise.resolve()}return{route:i,href:Y(()=>i.value.href),isActive:a,isExactActive:c,navigate:u}}function u_(e){return e.length===1?e[0]:e}const d_=Cf({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Qd,setup(e,{slots:t}){const o=Xa(Qd(e)),{options:i}=ao(Sl),s=Y(()=>({[th(e.activeClass,i.linkActiveClass,"router-link-active")]:o.isActive,[th(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:o.isExactActive}));return()=>{const a=t.default&&u_(t.default(o));return e.custom?a:vu("a",{"aria-current":o.isExactActive?e.ariaCurrentValue:null,href:o.href,onClick:o.navigate,class:s.value},a)}}}),h_=d_;function f_(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function p_(e,t){for(const o in t){const i=t[o],s=e[o];if(typeof i=="string"){if(i!==s)return!1}else if(!Co(s)||s.length!==i.length||i.some((a,c)=>a.valueOf()!==s[c].valueOf()))return!1}return!0}function eh(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const th=(e,t,o)=>e??t??o,v_=Cf({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:o}){const i=ao(Fc),s=Y(()=>e.route||i.value),a=ao(jd,0),c=Y(()=>{let p=V(a);const{matched:f}=s.value;let y;for(;(y=f[p])&&!y.components;)p++;return p}),u=Y(()=>s.value.matched[c.value]);Fr(jd,Y(()=>c.value+1)),Fr(Vy,u),Fr(Fc,s);const d=P();return We(()=>[d.value,u.value,e.name],([p,f,y],[b,I,T])=>{f&&(f.instances[y]=p,I&&I!==f&&p&&p===b&&(f.leaveGuards.size||(f.leaveGuards=I.leaveGuards),f.updateGuards.size||(f.updateGuards=I.updateGuards))),p&&f&&(!I||!oa(f,I)||!b)&&(f.enterCallbacks[y]||[]).forEach(S=>S(p))},{flush:"post"}),()=>{const p=s.value,f=e.name,y=u.value,b=y&&y.components[f];if(!b)return nh(o.default,{Component:b,route:p});const I=y.props[f],T=I?I===!0?p.params:typeof I=="function"?I(p):I:null,O=vu(b,wt({},T,t,{onVnodeUnmounted:E=>{E.component.isUnmounted&&(y.instances[f]=null)},ref:d}));return nh(o.default,{Component:O,route:p})||O}}});function nh(e,t){if(!e)return null;const o=e(t);return o.length===1?o[0]:o}const m_=v_;function g_(e){const t=i_(e.routes,e),o=e.parseQuery||zy,i=e.stringifyQuery||Zd,s=e.history,a=Ca(),c=Ca(),u=Ca(),d=om(Gs);let p=Gs;ji&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const f=hc.bind(null,ue=>""+ue),y=hc.bind(null,Ly),b=hc.bind(null,Wa);function I(ue,ye){let z,ee;return dp(ue)?(z=t.getRecordMatcher(ue),ee=ye):ee=ue,t.addRoute(ee,z)}function T(ue){const ye=t.getRecordMatcher(ue);ye&&t.removeRoute(ye)}function S(){return t.getRoutes().map(ue=>ue.record)}function O(ue){return!!t.getRecordMatcher(ue)}function E(ue,ye){if(ye=wt({},ye||d.value),typeof ue=="string"){const X=fc(o,ue,ye.path),q=t.resolve({path:X.path},ye),F=s.createHref(X.fullPath);return wt(X,q,{params:b(q.params),hash:Wa(X.hash),redirectedFrom:void 0,href:F})}let z;if(ue.path!=null)z=wt({},ue,{path:fc(o,ue.path,ye.path).path});else{const X=wt({},ue.params);for(const q in X)X[q]==null&&delete X[q];z=wt({},ue,{params:y(X)}),ye.params=y(ye.params)}const ee=t.resolve(z,ye),ie=ue.hash||"";ee.params=f(b(ee.params));const B=$y(i,wt({},ue,{hash:by(ie),path:ee.path})),j=s.createHref(B);return wt({fullPath:B,hash:ie,query:i===Zd?Hy(ue.query):ue.query||{}},ee,{redirectedFrom:void 0,href:j})}function A(ue){return typeof ue=="string"?fc(o,ue,d.value.path):wt({},ue)}function $(ue,ye){if(p!==ue)return sa(Ft.NAVIGATION_CANCELLED,{from:ye,to:ue})}function C(ue){return M(ue)}function w(ue){return C(wt(A(ue),{replace:!0}))}function k(ue,ye){const z=ue.matched[ue.matched.length-1];if(z&&z.redirect){const{redirect:ee}=z;let ie=typeof ee=="function"?ee(ue,ye):ee;return typeof ie=="string"&&(ie=ie.includes("?")||ie.includes("#")?ie=A(ie):{path:ie},ie.params={}),wt({query:ue.query,hash:ue.hash,params:ie.path!=null?{}:ue.params},ie)}}function M(ue,ye){const z=p=E(ue),ee=d.value,ie=ue.state,B=ue.force,j=ue.replace===!0,X=k(z,ee);if(X)return M(wt(A(X),{state:typeof X=="object"?wt({},ie,X.state):ie,force:B,replace:j}),ye||z);const q=z;q.redirectedFrom=ye;let F;return!B&&Iy(i,ee,z)&&(F=sa(Ft.NAVIGATION_DUPLICATED,{to:q,from:ee}),xe(ee,ee,!0,!1)),(F?Promise.resolve(F):ce(q,ee)).catch(N=>ds(N)?ds(N,Ft.NAVIGATION_GUARD_REDIRECT)?N:fe(N):ve(N,q,ee)).then(N=>{if(N){if(ds(N,Ft.NAVIGATION_GUARD_REDIRECT))return M(wt({replace:j},A(N.to),{state:typeof N.to=="object"?wt({},ie,N.to.state):ie,force:B}),ye||q)}else N=se(q,ee,!0,j,ie);return K(q,ee,N),N})}function G(ue,ye){const z=$(ue,ye);return z?Promise.reject(z):Promise.resolve()}function ne(ue){const ye=Ee.values().next().value;return ye&&typeof ye.runWithContext=="function"?ye.runWithContext(ue):ue()}function ce(ue,ye){let z;const[ee,ie,B]=Gy(ue,ye);z=vc(ee.reverse(),"beforeRouteLeave",ue,ye);for(const X of ee)X.leaveGuards.forEach(q=>{z.push(Ks(q,ue,ye))});const j=G.bind(null,ue,ye);return z.push(j),$e(z).then(()=>{z=[];for(const X of a.list())z.push(Ks(X,ue,ye));return z.push(j),$e(z)}).then(()=>{z=vc(ie,"beforeRouteUpdate",ue,ye);for(const X of ie)X.updateGuards.forEach(q=>{z.push(Ks(q,ue,ye))});return z.push(j),$e(z)}).then(()=>{z=[];for(const X of B)if(X.beforeEnter)if(Co(X.beforeEnter))for(const q of X.beforeEnter)z.push(Ks(q,ue,ye));else z.push(Ks(X.beforeEnter,ue,ye));return z.push(j),$e(z)}).then(()=>(ue.matched.forEach(X=>X.enterCallbacks={}),z=vc(B,"beforeRouteEnter",ue,ye,ne),z.push(j),$e(z))).then(()=>{z=[];for(const X of c.list())z.push(Ks(X,ue,ye));return z.push(j),$e(z)}).catch(X=>ds(X,Ft.NAVIGATION_CANCELLED)?X:Promise.reject(X))}function K(ue,ye,z){u.list().forEach(ee=>ne(()=>ee(ue,ye,z)))}function se(ue,ye,z,ee,ie){const B=$(ue,ye);if(B)return B;const j=ye===Gs,X=ji?history.state:{};z&&(ee||j?s.replace(ue.fullPath,wt({scroll:j&&X&&X.scroll},ie)):s.push(ue.fullPath,ie)),d.value=ue,xe(ue,ye,z,j),fe()}let me;function Re(){me||(me=s.listen((ue,ye,z)=>{if(!Me.listening)return;const ee=E(ue),ie=k(ee,Me.currentRoute.value);if(ie){M(wt(ie,{replace:!0,force:!0}),ee).catch(Na);return}p=ee;const B=d.value;ji&&Ry(Gd(B.fullPath,z.delta),Ll()),ce(ee,B).catch(j=>ds(j,Ft.NAVIGATION_ABORTED|Ft.NAVIGATION_CANCELLED)?j:ds(j,Ft.NAVIGATION_GUARD_REDIRECT)?(M(wt(A(j.to),{force:!0}),ee).then(X=>{ds(X,Ft.NAVIGATION_ABORTED|Ft.NAVIGATION_DUPLICATED)&&!z.delta&&z.type===Bc.pop&&s.go(-1,!1)}).catch(Na),Promise.reject()):(z.delta&&s.go(-z.delta,!1),ve(j,ee,B))).then(j=>{j=j||se(ee,B,!1),j&&(z.delta&&!ds(j,Ft.NAVIGATION_CANCELLED)?s.go(-z.delta,!1):z.type===Bc.pop&&ds(j,Ft.NAVIGATION_ABORTED|Ft.NAVIGATION_DUPLICATED)&&s.go(-1,!1)),K(ee,B,j)}).catch(Na)}))}let Oe=Ca(),de=Ca(),he;function ve(ue,ye,z){fe(ue);const ee=de.list();return ee.length?ee.forEach(ie=>ie(ue,ye,z)):console.error(ue),Promise.reject(ue)}function Te(){return he&&d.value!==Gs?Promise.resolve():new Promise((ue,ye)=>{Oe.add([ue,ye])})}function fe(ue){return he||(he=!ue,Re(),Oe.list().forEach(([ye,z])=>ue?z(ue):ye()),Oe.reset()),ue}function xe(ue,ye,z,ee){const{scrollBehavior:ie}=e;if(!ji||!ie)return Promise.resolve();const B=!z&&By(Gd(ue.fullPath,0))||(ee||!z)&&history.state&&history.state.scroll||null;return Ls().then(()=>ie(ue,ye,B)).then(j=>j&&Oy(j)).catch(j=>ve(j,ue,ye))}const Be=ue=>s.go(ue);let re;const Ee=new Set,Me={currentRoute:d,listening:!0,addRoute:I,removeRoute:T,clearRoutes:t.clearRoutes,hasRoute:O,getRoutes:S,resolve:E,options:e,push:C,replace:w,go:Be,back:()=>Be(-1),forward:()=>Be(1),beforeEach:a.add,beforeResolve:c.add,afterEach:u.add,onError:de.add,isReady:Te,install(ue){ue.component("RouterLink",h_),ue.component("RouterView",m_),ue.config.globalProperties.$router=Me,Object.defineProperty(ue.config.globalProperties,"$route",{enumerable:!0,get:()=>V(d)}),ji&&!re&&d.value===Gs&&(re=!0,C(s.location).catch(ee=>{}));const ye={};for(const ee in Gs)Object.defineProperty(ye,ee,{get:()=>d.value[ee],enumerable:!0});ue.provide(Sl,Me),ue.provide(yu,of(ye)),ue.provide(Fc,d);const z=ue.unmount;Ee.add(ue),ue.unmount=function(){Ee.delete(ue),Ee.size<1&&(p=Gs,me&&me(),me=null,d.value=Gs,re=!1,he=!1),z()}}};function $e(ue){return ue.reduce((ye,z)=>ye.then(()=>ne(z)),Promise.resolve())}return Me}function tr(){return ao(Sl)}function _u(e){return ao(yu)}const y_={},__={class:"home"},k_={class:"container"},b_={class:"actions"};function w_(e,t){const o=_l("router-link");return v(),m("div",__,[l("div",k_,[t[1]||(t[1]=l("h1",null,"Volunteer Check-in System ",-1)),t[2]||(t[2]=l("p",{class:"subtitle"},"Manage race marshals and volunteers with ease",-1)),l("div",b_,[Ne(o,{to:"/admin/login",class:"btn btn-primary"},{default:Qe(()=>[...t[0]||(t[0]=[Ve(" Admin Portal ",-1)])]),_:1})]),t[3]||(t[3]=Zf('<div class="features" data-v-536ab6a4><div class="feature-card" data-v-536ab6a4><h3 data-v-536ab6a4>For Admins</h3><ul data-v-536ab6a4><li data-v-536ab6a4>Create and manage events</li><li data-v-536ab6a4>Define marshal locations</li><li data-v-536ab6a4>Assign marshals to locations</li><li data-v-536ab6a4>Real-time check-in monitoring</li><li data-v-536ab6a4>Map view of all locations</li></ul></div><div class="feature-card" data-v-536ab6a4><h3 data-v-536ab6a4>For Marshals</h3><ul data-v-536ab6a4><li data-v-536ab6a4>View your assigned location</li><li data-v-536ab6a4>Check in with GPS verification</li><li data-v-536ab6a4>Access emergency contact info</li><li data-v-536ab6a4>View all marshal locations</li></ul></div></div>',1))])])}const C_=Ye(y_,[["render",w_],["__scopeId","data-v-536ab6a4"]]);function mp(e,t){return function(){return e.apply(t,arguments)}}const{toString:L_}=Object.prototype,{getPrototypeOf:ku}=Object,{iterator:xl,toStringTag:gp}=Symbol,$l=(e=>t=>{const o=L_.call(t);return e[o]||(e[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),So=e=>(e=e.toLowerCase(),t=>$l(t)===e),Il=e=>t=>typeof t===e,{isArray:ra}=Array,ia=Il("undefined");function nr(e){return e!==null&&!ia(e)&&e.constructor!==null&&!ia(e.constructor)&&Un(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const yp=So("ArrayBuffer");function S_(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&yp(e.buffer),t}const x_=Il("string"),Un=Il("function"),_p=Il("number"),or=e=>e!==null&&typeof e=="object",$_=e=>e===!0||e===!1,Gr=e=>{if($l(e)!=="object")return!1;const t=ku(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(gp in e)&&!(xl in e)},I_=e=>{if(!or(e)||nr(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},T_=So("Date"),M_=So("File"),A_=So("Blob"),E_=So("FileList"),P_=e=>or(e)&&Un(e.pipe),D_=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Un(e.append)&&((t=$l(e))==="formdata"||t==="object"&&Un(e.toString)&&e.toString()==="[object FormData]"))},O_=So("URLSearchParams"),[R_,B_,N_,F_]=["ReadableStream","Request","Response","Headers"].map(So),U_=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function sr(e,t,{allOwnKeys:o=!1}={}){if(e===null||typeof e>"u")return;let i,s;if(typeof e!="object"&&(e=[e]),ra(e))for(i=0,s=e.length;i<s;i++)t.call(null,e[i],i,e);else{if(nr(e))return;const a=o?Object.getOwnPropertyNames(e):Object.keys(e),c=a.length;let u;for(i=0;i<c;i++)u=a[i],t.call(null,e[u],u,e)}}function kp(e,t){if(nr(e))return null;t=t.toLowerCase();const o=Object.keys(e);let i=o.length,s;for(;i-- >0;)if(s=o[i],t===s.toLowerCase())return s;return null}const Si=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,bp=e=>!ia(e)&&e!==Si;function Uc(){const{caseless:e,skipUndefined:t}=bp(this)&&this||{},o={},i=(s,a)=>{const c=e&&kp(o,a)||a;Gr(o[c])&&Gr(s)?o[c]=Uc(o[c],s):Gr(s)?o[c]=Uc({},s):ra(s)?o[c]=s.slice():(!t||!ia(s))&&(o[c]=s)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&sr(arguments[s],i);return o}const z_=(e,t,o,{allOwnKeys:i}={})=>(sr(t,(s,a)=>{o&&Un(s)?e[a]=mp(s,o):e[a]=s},{allOwnKeys:i}),e),H_=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),V_=(e,t,o,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),o&&Object.assign(e.prototype,o)},G_=(e,t,o,i)=>{let s,a,c;const u={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),a=s.length;a-- >0;)c=s[a],(!i||i(c,e,t))&&!u[c]&&(t[c]=e[c],u[c]=!0);e=o!==!1&&ku(e)}while(e&&(!o||o(e,t))&&e!==Object.prototype);return t},Z_=(e,t,o)=>{e=String(e),(o===void 0||o>e.length)&&(o=e.length),o-=t.length;const i=e.indexOf(t,o);return i!==-1&&i===o},j_=e=>{if(!e)return null;if(ra(e))return e;let t=e.length;if(!_p(t))return null;const o=new Array(t);for(;t-- >0;)o[t]=e[t];return o},W_=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&ku(Uint8Array)),q_=(e,t)=>{const i=(e&&e[xl]).call(e);let s;for(;(s=i.next())&&!s.done;){const a=s.value;t.call(e,a[0],a[1])}},K_=(e,t)=>{let o;const i=[];for(;(o=e.exec(t))!==null;)i.push(o);return i},Y_=So("HTMLFormElement"),J_=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,i,s){return i.toUpperCase()+s}),oh=(({hasOwnProperty:e})=>(t,o)=>e.call(t,o))(Object.prototype),X_=So("RegExp"),wp=(e,t)=>{const o=Object.getOwnPropertyDescriptors(e),i={};sr(o,(s,a)=>{let c;(c=t(s,a,e))!==!1&&(i[a]=c||s)}),Object.defineProperties(e,i)},Q_=e=>{wp(e,(t,o)=>{if(Un(e)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const i=e[o];if(Un(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},e1=(e,t)=>{const o={},i=s=>{s.forEach(a=>{o[a]=!0})};return ra(e)?i(e):i(String(e).split(t)),o},t1=()=>{},n1=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function o1(e){return!!(e&&Un(e.append)&&e[gp]==="FormData"&&e[xl])}const s1=e=>{const t=new Array(10),o=(i,s)=>{if(or(i)){if(t.indexOf(i)>=0)return;if(nr(i))return i;if(!("toJSON"in i)){t[s]=i;const a=ra(i)?[]:{};return sr(i,(c,u)=>{const d=o(c,s+1);!ia(d)&&(a[u]=d)}),t[s]=void 0,a}}return i};return o(e,0)},i1=So("AsyncFunction"),a1=e=>e&&(or(e)||Un(e))&&Un(e.then)&&Un(e.catch),Cp=((e,t)=>e?setImmediate:t?((o,i)=>(Si.addEventListener("message",({source:s,data:a})=>{s===Si&&a===o&&i.length&&i.shift()()},!1),s=>{i.push(s),Si.postMessage(o,"*")}))(`axios@${Math.random()}`,[]):o=>setTimeout(o))(typeof setImmediate=="function",Un(Si.postMessage)),r1=typeof queueMicrotask<"u"?queueMicrotask.bind(Si):typeof process<"u"&&process.nextTick||Cp,l1=e=>e!=null&&Un(e[xl]),be={isArray:ra,isArrayBuffer:yp,isBuffer:nr,isFormData:D_,isArrayBufferView:S_,isString:x_,isNumber:_p,isBoolean:$_,isObject:or,isPlainObject:Gr,isEmptyObject:I_,isReadableStream:R_,isRequest:B_,isResponse:N_,isHeaders:F_,isUndefined:ia,isDate:T_,isFile:M_,isBlob:A_,isRegExp:X_,isFunction:Un,isStream:P_,isURLSearchParams:O_,isTypedArray:W_,isFileList:E_,forEach:sr,merge:Uc,extend:z_,trim:U_,stripBOM:H_,inherits:V_,toFlatObject:G_,kindOf:$l,kindOfTest:So,endsWith:Z_,toArray:j_,forEachEntry:q_,matchAll:K_,isHTMLForm:Y_,hasOwnProperty:oh,hasOwnProp:oh,reduceDescriptors:wp,freezeMethods:Q_,toObjectSet:e1,toCamelCase:J_,noop:t1,toFiniteNumber:n1,findKey:kp,global:Si,isContextDefined:bp,isSpecCompliantForm:o1,toJSONObject:s1,isAsyncFn:i1,isThenable:a1,setImmediate:Cp,asap:r1,isIterable:l1};function dt(e,t,o,i,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),o&&(this.config=o),i&&(this.request=i),s&&(this.response=s,this.status=s.status?s.status:null)}be.inherits(dt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:be.toJSONObject(this.config),code:this.code,status:this.status}}});const Lp=dt.prototype,Sp={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Sp[e]={value:e}});Object.defineProperties(dt,Sp);Object.defineProperty(Lp,"isAxiosError",{value:!0});dt.from=(e,t,o,i,s,a)=>{const c=Object.create(Lp);be.toFlatObject(e,c,function(f){return f!==Error.prototype},p=>p!=="isAxiosError");const u=e&&e.message?e.message:"Error",d=t==null&&e?e.code:t;return dt.call(c,u,d,o,i,s),e&&c.cause==null&&Object.defineProperty(c,"cause",{value:e,configurable:!0}),c.name=e&&e.name||"Error",a&&Object.assign(c,a),c};const c1=null;function zc(e){return be.isPlainObject(e)||be.isArray(e)}function xp(e){return be.endsWith(e,"[]")?e.slice(0,-2):e}function sh(e,t,o){return e?e.concat(t).map(function(s,a){return s=xp(s),!o&&a?"["+s+"]":s}).join(o?".":""):t}function u1(e){return be.isArray(e)&&!e.some(zc)}const d1=be.toFlatObject(be,{},null,function(t){return/^is[A-Z]/.test(t)});function Tl(e,t,o){if(!be.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,o=be.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,O){return!be.isUndefined(O[S])});const i=o.metaTokens,s=o.visitor||f,a=o.dots,c=o.indexes,d=(o.Blob||typeof Blob<"u"&&Blob)&&be.isSpecCompliantForm(t);if(!be.isFunction(s))throw new TypeError("visitor must be a function");function p(T){if(T===null)return"";if(be.isDate(T))return T.toISOString();if(be.isBoolean(T))return T.toString();if(!d&&be.isBlob(T))throw new dt("Blob is not supported. Use a Buffer instead.");return be.isArrayBuffer(T)||be.isTypedArray(T)?d&&typeof Blob=="function"?new Blob([T]):Buffer.from(T):T}function f(T,S,O){let E=T;if(T&&!O&&typeof T=="object"){if(be.endsWith(S,"{}"))S=i?S:S.slice(0,-2),T=JSON.stringify(T);else if(be.isArray(T)&&u1(T)||(be.isFileList(T)||be.endsWith(S,"[]"))&&(E=be.toArray(T)))return S=xp(S),E.forEach(function($,C){!(be.isUndefined($)||$===null)&&t.append(c===!0?sh([S],C,a):c===null?S:S+"[]",p($))}),!1}return zc(T)?!0:(t.append(sh(O,S,a),p(T)),!1)}const y=[],b=Object.assign(d1,{defaultVisitor:f,convertValue:p,isVisitable:zc});function I(T,S){if(!be.isUndefined(T)){if(y.indexOf(T)!==-1)throw Error("Circular reference detected in "+S.join("."));y.push(T),be.forEach(T,function(E,A){(!(be.isUndefined(E)||E===null)&&s.call(t,E,be.isString(A)?A.trim():A,S,b))===!0&&I(E,S?S.concat(A):[A])}),y.pop()}}if(!be.isObject(e))throw new TypeError("data must be an object");return I(e),t}function ih(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function bu(e,t){this._pairs=[],e&&Tl(e,this,t)}const $p=bu.prototype;$p.append=function(t,o){this._pairs.push([t,o])};$p.toString=function(t){const o=t?function(i){return t.call(this,i,ih)}:ih;return this._pairs.map(function(s){return o(s[0])+"="+o(s[1])},"").join("&")};function h1(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Ip(e,t,o){if(!t)return e;const i=o&&o.encode||h1;be.isFunction(o)&&(o={serialize:o});const s=o&&o.serialize;let a;if(s?a=s(t,o):a=be.isURLSearchParams(t)?t.toString():new bu(t,o).toString(i),a){const c=e.indexOf("#");c!==-1&&(e=e.slice(0,c)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class ah{constructor(){this.handlers=[]}use(t,o,i){return this.handlers.push({fulfilled:t,rejected:o,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){be.forEach(this.handlers,function(i){i!==null&&t(i)})}}const Tp={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},f1=typeof URLSearchParams<"u"?URLSearchParams:bu,p1=typeof FormData<"u"?FormData:null,v1=typeof Blob<"u"?Blob:null,m1={isBrowser:!0,classes:{URLSearchParams:f1,FormData:p1,Blob:v1},protocols:["http","https","file","blob","url","data"]},wu=typeof window<"u"&&typeof document<"u",Hc=typeof navigator=="object"&&navigator||void 0,g1=wu&&(!Hc||["ReactNative","NativeScript","NS"].indexOf(Hc.product)<0),y1=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",_1=wu&&window.location.href||"http://localhost",k1=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:wu,hasStandardBrowserEnv:g1,hasStandardBrowserWebWorkerEnv:y1,navigator:Hc,origin:_1},Symbol.toStringTag,{value:"Module"})),mn={...k1,...m1};function b1(e,t){return Tl(e,new mn.classes.URLSearchParams,{visitor:function(o,i,s,a){return mn.isNode&&be.isBuffer(o)?(this.append(i,o.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function w1(e){return be.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function C1(e){const t={},o=Object.keys(e);let i;const s=o.length;let a;for(i=0;i<s;i++)a=o[i],t[a]=e[a];return t}function Mp(e){function t(o,i,s,a){let c=o[a++];if(c==="__proto__")return!0;const u=Number.isFinite(+c),d=a>=o.length;return c=!c&&be.isArray(s)?s.length:c,d?(be.hasOwnProp(s,c)?s[c]=[s[c],i]:s[c]=i,!u):((!s[c]||!be.isObject(s[c]))&&(s[c]=[]),t(o,i,s[c],a)&&be.isArray(s[c])&&(s[c]=C1(s[c])),!u)}if(be.isFormData(e)&&be.isFunction(e.entries)){const o={};return be.forEachEntry(e,(i,s)=>{t(w1(i),s,o,0)}),o}return null}function L1(e,t,o){if(be.isString(e))try{return(t||JSON.parse)(e),be.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(o||JSON.stringify)(e)}const ir={transitional:Tp,adapter:["xhr","http","fetch"],transformRequest:[function(t,o){const i=o.getContentType()||"",s=i.indexOf("application/json")>-1,a=be.isObject(t);if(a&&be.isHTMLForm(t)&&(t=new FormData(t)),be.isFormData(t))return s?JSON.stringify(Mp(t)):t;if(be.isArrayBuffer(t)||be.isBuffer(t)||be.isStream(t)||be.isFile(t)||be.isBlob(t)||be.isReadableStream(t))return t;if(be.isArrayBufferView(t))return t.buffer;if(be.isURLSearchParams(t))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(a){if(i.indexOf("application/x-www-form-urlencoded")>-1)return b1(t,this.formSerializer).toString();if((u=be.isFileList(t))||i.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return Tl(u?{"files[]":t}:t,d&&new d,this.formSerializer)}}return a||s?(o.setContentType("application/json",!1),L1(t)):t}],transformResponse:[function(t){const o=this.transitional||ir.transitional,i=o&&o.forcedJSONParsing,s=this.responseType==="json";if(be.isResponse(t)||be.isReadableStream(t))return t;if(t&&be.isString(t)&&(i&&!this.responseType||s)){const c=!(o&&o.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(u){if(c)throw u.name==="SyntaxError"?dt.from(u,dt.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:mn.classes.FormData,Blob:mn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};be.forEach(["delete","get","head","post","put","patch"],e=>{ir.headers[e]={}});const S1=be.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),x1=e=>{const t={};let o,i,s;return e&&e.split(`
`).forEach(function(c){s=c.indexOf(":"),o=c.substring(0,s).trim().toLowerCase(),i=c.substring(s+1).trim(),!(!o||t[o]&&S1[o])&&(o==="set-cookie"?t[o]?t[o].push(i):t[o]=[i]:t[o]=t[o]?t[o]+", "+i:i)}),t},rh=Symbol("internals");function La(e){return e&&String(e).trim().toLowerCase()}function Zr(e){return e===!1||e==null?e:be.isArray(e)?e.map(Zr):String(e)}function $1(e){const t=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=o.exec(e);)t[i[1]]=i[2];return t}const I1=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function mc(e,t,o,i,s){if(be.isFunction(i))return i.call(this,t,o);if(s&&(t=o),!!be.isString(t)){if(be.isString(i))return t.indexOf(i)!==-1;if(be.isRegExp(i))return i.test(t)}}function T1(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,o,i)=>o.toUpperCase()+i)}function M1(e,t){const o=be.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+o,{value:function(s,a,c){return this[i].call(this,t,s,a,c)},configurable:!0})})}let zn=class{constructor(t){t&&this.set(t)}set(t,o,i){const s=this;function a(u,d,p){const f=La(d);if(!f)throw new Error("header name must be a non-empty string");const y=be.findKey(s,f);(!y||s[y]===void 0||p===!0||p===void 0&&s[y]!==!1)&&(s[y||d]=Zr(u))}const c=(u,d)=>be.forEach(u,(p,f)=>a(p,f,d));if(be.isPlainObject(t)||t instanceof this.constructor)c(t,o);else if(be.isString(t)&&(t=t.trim())&&!I1(t))c(x1(t),o);else if(be.isObject(t)&&be.isIterable(t)){let u={},d,p;for(const f of t){if(!be.isArray(f))throw TypeError("Object iterator must return a key-value pair");u[p=f[0]]=(d=u[p])?be.isArray(d)?[...d,f[1]]:[d,f[1]]:f[1]}c(u,o)}else t!=null&&a(o,t,i);return this}get(t,o){if(t=La(t),t){const i=be.findKey(this,t);if(i){const s=this[i];if(!o)return s;if(o===!0)return $1(s);if(be.isFunction(o))return o.call(this,s,i);if(be.isRegExp(o))return o.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,o){if(t=La(t),t){const i=be.findKey(this,t);return!!(i&&this[i]!==void 0&&(!o||mc(this,this[i],i,o)))}return!1}delete(t,o){const i=this;let s=!1;function a(c){if(c=La(c),c){const u=be.findKey(i,c);u&&(!o||mc(i,i[u],u,o))&&(delete i[u],s=!0)}}return be.isArray(t)?t.forEach(a):a(t),s}clear(t){const o=Object.keys(this);let i=o.length,s=!1;for(;i--;){const a=o[i];(!t||mc(this,this[a],a,t,!0))&&(delete this[a],s=!0)}return s}normalize(t){const o=this,i={};return be.forEach(this,(s,a)=>{const c=be.findKey(i,a);if(c){o[c]=Zr(s),delete o[a];return}const u=t?T1(a):String(a).trim();u!==a&&delete o[a],o[u]=Zr(s),i[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const o=Object.create(null);return be.forEach(this,(i,s)=>{i!=null&&i!==!1&&(o[s]=t&&be.isArray(i)?i.join(", "):i)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,o])=>t+": "+o).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...o){const i=new this(t);return o.forEach(s=>i.set(s)),i}static accessor(t){const i=(this[rh]=this[rh]={accessors:{}}).accessors,s=this.prototype;function a(c){const u=La(c);i[u]||(M1(s,c),i[u]=!0)}return be.isArray(t)?t.forEach(a):a(t),this}};zn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);be.reduceDescriptors(zn.prototype,({value:e},t)=>{let o=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[o]=i}}});be.freezeMethods(zn);function gc(e,t){const o=this||ir,i=t||o,s=zn.from(i.headers);let a=i.data;return be.forEach(e,function(u){a=u.call(o,a,s.normalize(),t?t.status:void 0)}),s.normalize(),a}function Ap(e){return!!(e&&e.__CANCEL__)}function la(e,t,o){dt.call(this,e??"canceled",dt.ERR_CANCELED,t,o),this.name="CanceledError"}be.inherits(la,dt,{__CANCEL__:!0});function Ep(e,t,o){const i=o.config.validateStatus;!o.status||!i||i(o.status)?e(o):t(new dt("Request failed with status code "+o.status,[dt.ERR_BAD_REQUEST,dt.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}function A1(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function E1(e,t){e=e||10;const o=new Array(e),i=new Array(e);let s=0,a=0,c;return t=t!==void 0?t:1e3,function(d){const p=Date.now(),f=i[a];c||(c=p),o[s]=d,i[s]=p;let y=a,b=0;for(;y!==s;)b+=o[y++],y=y%e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),p-c<t)return;const I=f&&p-f;return I?Math.round(b*1e3/I):void 0}}function P1(e,t){let o=0,i=1e3/t,s,a;const c=(p,f=Date.now())=>{o=f,s=null,a&&(clearTimeout(a),a=null),e(...p)};return[(...p)=>{const f=Date.now(),y=f-o;y>=i?c(p,f):(s=p,a||(a=setTimeout(()=>{a=null,c(s)},i-y)))},()=>s&&c(s)]}const ol=(e,t,o=3)=>{let i=0;const s=E1(50,250);return P1(a=>{const c=a.loaded,u=a.lengthComputable?a.total:void 0,d=c-i,p=s(d),f=c<=u;i=c;const y={loaded:c,total:u,progress:u?c/u:void 0,bytes:d,rate:p||void 0,estimated:p&&u&&f?(u-c)/p:void 0,event:a,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(y)},o)},lh=(e,t)=>{const o=e!=null;return[i=>t[0]({lengthComputable:o,total:e,loaded:i}),t[1]]},ch=e=>(...t)=>be.asap(()=>e(...t)),D1=mn.hasStandardBrowserEnv?((e,t)=>o=>(o=new URL(o,mn.origin),e.protocol===o.protocol&&e.host===o.host&&(t||e.port===o.port)))(new URL(mn.origin),mn.navigator&&/(msie|trident)/i.test(mn.navigator.userAgent)):()=>!0,O1=mn.hasStandardBrowserEnv?{write(e,t,o,i,s,a,c){if(typeof document>"u")return;const u=[`${e}=${encodeURIComponent(t)}`];be.isNumber(o)&&u.push(`expires=${new Date(o).toUTCString()}`),be.isString(i)&&u.push(`path=${i}`),be.isString(s)&&u.push(`domain=${s}`),a===!0&&u.push("secure"),be.isString(c)&&u.push(`SameSite=${c}`),document.cookie=u.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function R1(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function B1(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Pp(e,t,o){let i=!R1(t);return e&&(i||o==!1)?B1(e,t):t}const uh=e=>e instanceof zn?{...e}:e;function Ei(e,t){t=t||{};const o={};function i(p,f,y,b){return be.isPlainObject(p)&&be.isPlainObject(f)?be.merge.call({caseless:b},p,f):be.isPlainObject(f)?be.merge({},f):be.isArray(f)?f.slice():f}function s(p,f,y,b){if(be.isUndefined(f)){if(!be.isUndefined(p))return i(void 0,p,y,b)}else return i(p,f,y,b)}function a(p,f){if(!be.isUndefined(f))return i(void 0,f)}function c(p,f){if(be.isUndefined(f)){if(!be.isUndefined(p))return i(void 0,p)}else return i(void 0,f)}function u(p,f,y){if(y in t)return i(p,f);if(y in e)return i(void 0,p)}const d={url:a,method:a,data:a,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:u,headers:(p,f,y)=>s(uh(p),uh(f),y,!0)};return be.forEach(Object.keys({...e,...t}),function(f){const y=d[f]||s,b=y(e[f],t[f],f);be.isUndefined(b)&&y!==u||(o[f]=b)}),o}const Dp=e=>{const t=Ei({},e);let{data:o,withXSRFToken:i,xsrfHeaderName:s,xsrfCookieName:a,headers:c,auth:u}=t;if(t.headers=c=zn.from(c),t.url=Ip(Pp(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&c.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),be.isFormData(o)){if(mn.hasStandardBrowserEnv||mn.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if(be.isFunction(o.getHeaders)){const d=o.getHeaders(),p=["content-type","content-length"];Object.entries(d).forEach(([f,y])=>{p.includes(f.toLowerCase())&&c.set(f,y)})}}if(mn.hasStandardBrowserEnv&&(i&&be.isFunction(i)&&(i=i(t)),i||i!==!1&&D1(t.url))){const d=s&&a&&O1.read(a);d&&c.set(s,d)}return t},N1=typeof XMLHttpRequest<"u",F1=N1&&function(e){return new Promise(function(o,i){const s=Dp(e);let a=s.data;const c=zn.from(s.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:p}=s,f,y,b,I,T;function S(){I&&I(),T&&T(),s.cancelToken&&s.cancelToken.unsubscribe(f),s.signal&&s.signal.removeEventListener("abort",f)}let O=new XMLHttpRequest;O.open(s.method.toUpperCase(),s.url,!0),O.timeout=s.timeout;function E(){if(!O)return;const $=zn.from("getAllResponseHeaders"in O&&O.getAllResponseHeaders()),w={data:!u||u==="text"||u==="json"?O.responseText:O.response,status:O.status,statusText:O.statusText,headers:$,config:e,request:O};Ep(function(M){o(M),S()},function(M){i(M),S()},w),O=null}"onloadend"in O?O.onloadend=E:O.onreadystatechange=function(){!O||O.readyState!==4||O.status===0&&!(O.responseURL&&O.responseURL.indexOf("file:")===0)||setTimeout(E)},O.onabort=function(){O&&(i(new dt("Request aborted",dt.ECONNABORTED,e,O)),O=null)},O.onerror=function(C){const w=C&&C.message?C.message:"Network Error",k=new dt(w,dt.ERR_NETWORK,e,O);k.event=C||null,i(k),O=null},O.ontimeout=function(){let C=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const w=s.transitional||Tp;s.timeoutErrorMessage&&(C=s.timeoutErrorMessage),i(new dt(C,w.clarifyTimeoutError?dt.ETIMEDOUT:dt.ECONNABORTED,e,O)),O=null},a===void 0&&c.setContentType(null),"setRequestHeader"in O&&be.forEach(c.toJSON(),function(C,w){O.setRequestHeader(w,C)}),be.isUndefined(s.withCredentials)||(O.withCredentials=!!s.withCredentials),u&&u!=="json"&&(O.responseType=s.responseType),p&&([b,T]=ol(p,!0),O.addEventListener("progress",b)),d&&O.upload&&([y,I]=ol(d),O.upload.addEventListener("progress",y),O.upload.addEventListener("loadend",I)),(s.cancelToken||s.signal)&&(f=$=>{O&&(i(!$||$.type?new la(null,e,O):$),O.abort(),O=null)},s.cancelToken&&s.cancelToken.subscribe(f),s.signal&&(s.signal.aborted?f():s.signal.addEventListener("abort",f)));const A=A1(s.url);if(A&&mn.protocols.indexOf(A)===-1){i(new dt("Unsupported protocol "+A+":",dt.ERR_BAD_REQUEST,e));return}O.send(a||null)})},U1=(e,t)=>{const{length:o}=e=e?e.filter(Boolean):[];if(t||o){let i=new AbortController,s;const a=function(p){if(!s){s=!0,u();const f=p instanceof Error?p:this.reason;i.abort(f instanceof dt?f:new la(f instanceof Error?f.message:f))}};let c=t&&setTimeout(()=>{c=null,a(new dt(`timeout ${t} of ms exceeded`,dt.ETIMEDOUT))},t);const u=()=>{e&&(c&&clearTimeout(c),c=null,e.forEach(p=>{p.unsubscribe?p.unsubscribe(a):p.removeEventListener("abort",a)}),e=null)};e.forEach(p=>p.addEventListener("abort",a));const{signal:d}=i;return d.unsubscribe=()=>be.asap(u),d}},z1=function*(e,t){let o=e.byteLength;if(o<t){yield e;return}let i=0,s;for(;i<o;)s=i+t,yield e.slice(i,s),i=s},H1=async function*(e,t){for await(const o of V1(e))yield*z1(o,t)},V1=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:o,value:i}=await t.read();if(o)break;yield i}}finally{await t.cancel()}},dh=(e,t,o,i)=>{const s=H1(e,t);let a=0,c,u=d=>{c||(c=!0,i&&i(d))};return new ReadableStream({async pull(d){try{const{done:p,value:f}=await s.next();if(p){u(),d.close();return}let y=f.byteLength;if(o){let b=a+=y;o(b)}d.enqueue(new Uint8Array(f))}catch(p){throw u(p),p}},cancel(d){return u(d),s.return()}},{highWaterMark:2})},hh=64*1024,{isFunction:Pr}=be,G1=(({Request:e,Response:t})=>({Request:e,Response:t}))(be.global),{ReadableStream:fh,TextEncoder:ph}=be.global,vh=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Z1=e=>{e=be.merge.call({skipUndefined:!0},G1,e);const{fetch:t,Request:o,Response:i}=e,s=t?Pr(t):typeof fetch=="function",a=Pr(o),c=Pr(i);if(!s)return!1;const u=s&&Pr(fh),d=s&&(typeof ph=="function"?(T=>S=>T.encode(S))(new ph):async T=>new Uint8Array(await new o(T).arrayBuffer())),p=a&&u&&vh(()=>{let T=!1;const S=new o(mn.origin,{body:new fh,method:"POST",get duplex(){return T=!0,"half"}}).headers.has("Content-Type");return T&&!S}),f=c&&u&&vh(()=>be.isReadableStream(new i("").body)),y={stream:f&&(T=>T.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(T=>{!y[T]&&(y[T]=(S,O)=>{let E=S&&S[T];if(E)return E.call(S);throw new dt(`Response type '${T}' is not supported`,dt.ERR_NOT_SUPPORT,O)})});const b=async T=>{if(T==null)return 0;if(be.isBlob(T))return T.size;if(be.isSpecCompliantForm(T))return(await new o(mn.origin,{method:"POST",body:T}).arrayBuffer()).byteLength;if(be.isArrayBufferView(T)||be.isArrayBuffer(T))return T.byteLength;if(be.isURLSearchParams(T)&&(T=T+""),be.isString(T))return(await d(T)).byteLength},I=async(T,S)=>{const O=be.toFiniteNumber(T.getContentLength());return O??b(S)};return async T=>{let{url:S,method:O,data:E,signal:A,cancelToken:$,timeout:C,onDownloadProgress:w,onUploadProgress:k,responseType:M,headers:G,withCredentials:ne="same-origin",fetchOptions:ce}=Dp(T),K=t||fetch;M=M?(M+"").toLowerCase():"text";let se=U1([A,$&&$.toAbortSignal()],C),me=null;const Re=se&&se.unsubscribe&&(()=>{se.unsubscribe()});let Oe;try{if(k&&p&&O!=="get"&&O!=="head"&&(Oe=await I(G,E))!==0){let xe=new o(S,{method:"POST",body:E,duplex:"half"}),Be;if(be.isFormData(E)&&(Be=xe.headers.get("content-type"))&&G.setContentType(Be),xe.body){const[re,Ee]=lh(Oe,ol(ch(k)));E=dh(xe.body,hh,re,Ee)}}be.isString(ne)||(ne=ne?"include":"omit");const de=a&&"credentials"in o.prototype,he={...ce,signal:se,method:O.toUpperCase(),headers:G.normalize().toJSON(),body:E,duplex:"half",credentials:de?ne:void 0};me=a&&new o(S,he);let ve=await(a?K(me,ce):K(S,he));const Te=f&&(M==="stream"||M==="response");if(f&&(w||Te&&Re)){const xe={};["status","statusText","headers"].forEach(Me=>{xe[Me]=ve[Me]});const Be=be.toFiniteNumber(ve.headers.get("content-length")),[re,Ee]=w&&lh(Be,ol(ch(w),!0))||[];ve=new i(dh(ve.body,hh,re,()=>{Ee&&Ee(),Re&&Re()}),xe)}M=M||"text";let fe=await y[be.findKey(y,M)||"text"](ve,T);return!Te&&Re&&Re(),await new Promise((xe,Be)=>{Ep(xe,Be,{data:fe,headers:zn.from(ve.headers),status:ve.status,statusText:ve.statusText,config:T,request:me})})}catch(de){throw Re&&Re(),de&&de.name==="TypeError"&&/Load failed|fetch/i.test(de.message)?Object.assign(new dt("Network Error",dt.ERR_NETWORK,T,me),{cause:de.cause||de}):dt.from(de,de&&de.code,T,me)}}},j1=new Map,Op=e=>{let t=e&&e.env||{};const{fetch:o,Request:i,Response:s}=t,a=[i,s,o];let c=a.length,u=c,d,p,f=j1;for(;u--;)d=a[u],p=f.get(d),p===void 0&&f.set(d,p=u?new Map:Z1(t)),f=p;return p};Op();const Cu={http:c1,xhr:F1,fetch:{get:Op}};be.forEach(Cu,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const mh=e=>`- ${e}`,W1=e=>be.isFunction(e)||e===null||e===!1;function q1(e,t){e=be.isArray(e)?e:[e];const{length:o}=e;let i,s;const a={};for(let c=0;c<o;c++){i=e[c];let u;if(s=i,!W1(i)&&(s=Cu[(u=String(i)).toLowerCase()],s===void 0))throw new dt(`Unknown adapter '${u}'`);if(s&&(be.isFunction(s)||(s=s.get(t))))break;a[u||"#"+c]=s}if(!s){const c=Object.entries(a).map(([d,p])=>`adapter ${d} `+(p===!1?"is not supported by the environment":"is not available in the build"));let u=o?c.length>1?`since :
`+c.map(mh).join(`
`):" "+mh(c[0]):"as no adapter specified";throw new dt("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return s}const Rp={getAdapter:q1,adapters:Cu};function yc(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new la(null,e)}function gh(e){return yc(e),e.headers=zn.from(e.headers),e.data=gc.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Rp.getAdapter(e.adapter||ir.adapter,e)(e).then(function(i){return yc(e),i.data=gc.call(e,e.transformResponse,i),i.headers=zn.from(i.headers),i},function(i){return Ap(i)||(yc(e),i&&i.response&&(i.response.data=gc.call(e,e.transformResponse,i.response),i.response.headers=zn.from(i.response.headers))),Promise.reject(i)})}const Bp="1.13.2",Ml={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Ml[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});const yh={};Ml.transitional=function(t,o,i){function s(a,c){return"[Axios v"+Bp+"] Transitional option '"+a+"'"+c+(i?". "+i:"")}return(a,c,u)=>{if(t===!1)throw new dt(s(c," has been removed"+(o?" in "+o:"")),dt.ERR_DEPRECATED);return o&&!yh[c]&&(yh[c]=!0,console.warn(s(c," has been deprecated since v"+o+" and will be removed in the near future"))),t?t(a,c,u):!0}};Ml.spelling=function(t){return(o,i)=>(console.warn(`${i} is likely a misspelling of ${t}`),!0)};function K1(e,t,o){if(typeof e!="object")throw new dt("options must be an object",dt.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let s=i.length;for(;s-- >0;){const a=i[s],c=t[a];if(c){const u=e[a],d=u===void 0||c(u,a,e);if(d!==!0)throw new dt("option "+a+" must be "+d,dt.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new dt("Unknown option "+a,dt.ERR_BAD_OPTION)}}const jr={assertOptions:K1,validators:Ml},Ho=jr.validators;let Ti=class{constructor(t){this.defaults=t||{},this.interceptors={request:new ah,response:new ah}}async request(t,o){try{return await this._request(t,o)}catch(i){if(i instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{i.stack?a&&!String(i.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+a):i.stack=a}catch{}}throw i}}_request(t,o){typeof t=="string"?(o=o||{},o.url=t):o=t||{},o=Ei(this.defaults,o);const{transitional:i,paramsSerializer:s,headers:a}=o;i!==void 0&&jr.assertOptions(i,{silentJSONParsing:Ho.transitional(Ho.boolean),forcedJSONParsing:Ho.transitional(Ho.boolean),clarifyTimeoutError:Ho.transitional(Ho.boolean)},!1),s!=null&&(be.isFunction(s)?o.paramsSerializer={serialize:s}:jr.assertOptions(s,{encode:Ho.function,serialize:Ho.function},!0)),o.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?o.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:o.allowAbsoluteUrls=!0),jr.assertOptions(o,{baseUrl:Ho.spelling("baseURL"),withXsrfToken:Ho.spelling("withXSRFToken")},!0),o.method=(o.method||this.defaults.method||"get").toLowerCase();let c=a&&be.merge(a.common,a[o.method]);a&&be.forEach(["delete","get","head","post","put","patch","common"],T=>{delete a[T]}),o.headers=zn.concat(c,a);const u=[];let d=!0;this.interceptors.request.forEach(function(S){typeof S.runWhen=="function"&&S.runWhen(o)===!1||(d=d&&S.synchronous,u.unshift(S.fulfilled,S.rejected))});const p=[];this.interceptors.response.forEach(function(S){p.push(S.fulfilled,S.rejected)});let f,y=0,b;if(!d){const T=[gh.bind(this),void 0];for(T.unshift(...u),T.push(...p),b=T.length,f=Promise.resolve(o);y<b;)f=f.then(T[y++],T[y++]);return f}b=u.length;let I=o;for(;y<b;){const T=u[y++],S=u[y++];try{I=T(I)}catch(O){S.call(this,O);break}}try{f=gh.call(this,I)}catch(T){return Promise.reject(T)}for(y=0,b=p.length;y<b;)f=f.then(p[y++],p[y++]);return f}getUri(t){t=Ei(this.defaults,t);const o=Pp(t.baseURL,t.url,t.allowAbsoluteUrls);return Ip(o,t.params,t.paramsSerializer)}};be.forEach(["delete","get","head","options"],function(t){Ti.prototype[t]=function(o,i){return this.request(Ei(i||{},{method:t,url:o,data:(i||{}).data}))}});be.forEach(["post","put","patch"],function(t){function o(i){return function(a,c,u){return this.request(Ei(u||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:a,data:c}))}}Ti.prototype[t]=o(),Ti.prototype[t+"Form"]=o(!0)});let Y1=class Np{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(a){o=a});const i=this;this.promise.then(s=>{if(!i._listeners)return;let a=i._listeners.length;for(;a-- >0;)i._listeners[a](s);i._listeners=null}),this.promise.then=s=>{let a;const c=new Promise(u=>{i.subscribe(u),a=u}).then(s);return c.cancel=function(){i.unsubscribe(a)},c},t(function(a,c,u){i.reason||(i.reason=new la(a,c,u),o(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const o=this._listeners.indexOf(t);o!==-1&&this._listeners.splice(o,1)}toAbortSignal(){const t=new AbortController,o=i=>{t.abort(i)};return this.subscribe(o),t.signal.unsubscribe=()=>this.unsubscribe(o),t.signal}static source(){let t;return{token:new Np(function(s){t=s}),cancel:t}}};function J1(e){return function(o){return e.apply(null,o)}}function X1(e){return be.isObject(e)&&e.isAxiosError===!0}const Vc={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Vc).forEach(([e,t])=>{Vc[t]=e});function Fp(e){const t=new Ti(e),o=mp(Ti.prototype.request,t);return be.extend(o,Ti.prototype,t,{allOwnKeys:!0}),be.extend(o,t,null,{allOwnKeys:!0}),o.create=function(s){return Fp(Ei(e,s))},o}const Vt=Fp(ir);Vt.Axios=Ti;Vt.CanceledError=la;Vt.CancelToken=Y1;Vt.isCancel=Ap;Vt.VERSION=Bp;Vt.toFormData=Tl;Vt.AxiosError=dt;Vt.Cancel=Vt.CanceledError;Vt.all=function(t){return Promise.all(t)};Vt.spread=J1;Vt.isAxiosError=X1;Vt.mergeConfig=Ei;Vt.AxiosHeaders=zn;Vt.formToJSON=e=>Mp(be.isHTMLForm(e)?new FormData(e):e);Vt.getAdapter=Rp.getAdapter;Vt.HttpStatusCode=Vc;Vt.default=Vt;const{Axios:f7,AxiosError:p7,CanceledError:v7,isCancel:m7,CancelToken:g7,VERSION:y7,all:_7,Cancel:k7,isAxiosError:b7,spread:w7,toFormData:C7,AxiosHeaders:L7,HttpStatusCode:S7,formToJSON:x7,getAdapter:$7,mergeConfig:I7}=Vt,Q1="https://sterobson-volunteercheckin-testing.azurewebsites.net/api",ek="VolunteerCheckinOffline",tk=1;let yo=null;async function Ts(){return yo||new Promise((e,t)=>{const o=indexedDB.open(ek,tk);o.onerror=()=>{console.error("Failed to open IndexedDB:",o.error),t(o.error)},o.onsuccess=()=>{yo=o.result,e(yo)},o.onupgradeneeded=i=>{const s=i.target.result;s.objectStoreNames.contains("eventData")||s.createObjectStore("eventData",{keyPath:"eventId"}),s.objectStoreNames.contains("pendingActions")||s.createObjectStore("pendingActions",{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),s.objectStoreNames.contains("syncMeta")||s.createObjectStore("syncMeta",{keyPath:"key"})}})}async function qa(e,t){return await Ts(),new Promise((o,i)=>{const s=yo.transaction(["eventData","syncMeta"],"readwrite"),a=s.objectStore("eventData"),c=s.objectStore("syncMeta"),u={eventId:e,...t,cachedAt:new Date().toISOString()};a.put(u),c.put({key:`lastSync_${e}`,value:new Date().toISOString()}),s.oncomplete=()=>o(),s.onerror=()=>i(s.error)})}async function Qs(e){return await Ts(),new Promise((t,o)=>{const a=yo.transaction(["eventData"],"readonly").objectStore("eventData").get(e);a.onsuccess=()=>t(a.result||null),a.onerror=()=>o(a.error)})}async function xa(e,t,o){const i=await Qs(e);i&&(i[t]=o,i.cachedAt=new Date().toISOString(),await qa(e,i))}async function nk(e){return await Ts(),new Promise((t,o)=>{const s=yo.transaction(["pendingActions"],"readwrite").objectStore("pendingActions"),a={...e,createdAt:new Date().toISOString(),attempts:0,lastAttempt:null,status:"pending"},c=s.add(a);c.onsuccess=()=>t(c.result),c.onerror=()=>o(c.error)})}async function Up(){return await Ts(),new Promise((e,t)=>{const a=yo.transaction(["pendingActions"],"readonly").objectStore("pendingActions").index("createdAt").getAll();a.onsuccess=()=>{const c=a.result.filter(u=>u.status==="pending"||u.status==="retrying");e(c)},a.onerror=()=>t(a.error)})}async function sl(){return(await Up()).length}async function _h(e,t){return await Ts(),new Promise((o,i)=>{const s=yo.transaction(["pendingActions"],"readwrite"),a=s.objectStore("pendingActions"),c=a.get(e);c.onsuccess=()=>{const u=c.result;u&&(Object.assign(u,t),a.put(u))},s.oncomplete=()=>o(),s.onerror=()=>i(s.error)})}async function kh(e){return await Ts(),new Promise((t,o)=>{const a=yo.transaction(["pendingActions"],"readwrite").objectStore("pendingActions").delete(e);a.onsuccess=()=>t(),a.onerror=()=>o(a.error)})}async function ok(e){return await Ts(),new Promise((t,o)=>{const a=yo.transaction(["syncMeta"],"readonly").objectStore("syncMeta").get(`lastSync_${e}`);a.onsuccess=()=>t(a.result?.value||null),a.onerror=()=>o(a.error)})}const Ue=Vt.create({baseURL:Q1,headers:{"Content-Type":"application/json"},timeout:15e3});let Gc=!1;async function sk(){}function bh(e){const t=[/\/events\/([^/]+)/,/\/assignments\/([^/]+)/,/\/locations\/([^/]+)/,/\/checklist-items\/([^/]+)/,/\/areas\/([^/]+)/,/\/marshals\/([^/]+)/];for(const o of t){const i=e.match(o);if(i)return i[1]}return null}function ik(e){return!!(!e.response&&e.request||e.response&&e.response.status>=500||e.code==="ECONNABORTED")}Ue.interceptors.request.use(e=>{const t=localStorage.getItem("adminEmail");t&&(e.headers["X-Admin-Email"]=t);const o=localStorage.getItem("sessionToken");return o&&(e.headers.Authorization=`Bearer ${o}`),e});let Zc=0;const ak=2;function rk(){if(Zc++,Zc>=ak){localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken");const e=window.location.hash||"";!e.includes("/login")&&!e.includes("/verify")&&(window.location.href="/VolunteerCheckin/testing/#/admin/login")}}function lk(){Zc=0}Ue.interceptors.response.use(e=>{Gc=!1,lk();const t=e.config.url,o=bh(t);return e.config.method,e},async e=>{const t=e.config;if(e.response&&(e.response.status===401||e.response.status===403))return rk(),Promise.reject(e);if(ik(e)&&(Gc=!0,t.method==="get")){const o=bh(t.url);if(o){const i=await Qs(o);if(i)return console.log("Returning cached data for:",t.url),Promise.resolve({data:i,status:200,statusText:"OK (cached)",headers:{},config:t,cached:!0})}}return Promise.reject(e)});async function Kn(e,t,o){return await nk({type:e,payload:t,eventId:t.eventId}),await sk(),{data:o,status:200,statusText:"OK (queued)",queued:!0}}function dn(){return Gc||!navigator.onLine}const ck={check:()=>Ue.head("/health")},Zo={requestLogin:e=>Ue.post("/auth/request-login",{email:e}),verifyToken:e=>Ue.post("/auth/verify-token",{token:e}),instantLogin:e=>Ue.post("/auth/instant-login",{email:e}),createAdmin:e=>Ue.post("/auth/create-admin",{email:e}),marshalLogin:(e,t)=>Ue.post("/auth/marshal-login",{eventId:e,magicCode:t}),getMe:e=>Ue.get("/auth/me",{params:{eventId:e}}),logout:()=>Ue.post("/auth/logout")},Dr={getProfile:()=>Ue.get("/auth/profile"),updateProfile:e=>Ue.put("/auth/profile",e),getPerson:(e,t)=>Ue.get(`/people/${e}`,{params:{eventId:t}}),updatePerson:(e,t,o)=>Ue.put(`/people/${e}`,o,{params:{eventId:t}})},bi={create:e=>Ue.post("/events",e),getAll:()=>Ue.get("/events"),getById:e=>Ue.get(`/events/${e}`),update:(e,t)=>Ue.put(`/events/${e}`,t),delete:e=>Ue.delete(`/events/${e}`),uploadGpx:(e,t)=>{const o=new FormData;return o.append("gpx",t),Ue.post(`/events/${e}/upload-gpx`,o,{headers:{"Content-Type":"multipart/form-data"}})}},Nn={create:e=>Ue.post("/locations",e),getById:(e,t)=>Ue.get(`/locations/${e}/${t}`),getByEvent:e=>Ue.get(`/events/${e}/locations`),update:(e,t,o)=>Ue.put(`/locations/${e}/${t}`,o),delete:(e,t)=>Ue.delete(`/locations/${e}/${t}`),importCsv:(e,t,o)=>{const i=new FormData;return i.append("csv",t),Ue.post(`/locations/import/${e}?deleteExisting=${o}`,i,{headers:{"Content-Type":"multipart/form-data"}})},bulkUpdateTimes:(e,t)=>Ue.post(`/locations/bulk-update-times/${e}`,{timeDelta:t}),updatePosition:(e,t,o)=>Ue.post(`/locations/${e}/${t}/update-position`,o),getDynamicCheckpoints:e=>Ue.get(`/events/${e}/dynamic-checkpoints`)},$a={create:e=>Ue.post("/assignments",e),getById:(e,t)=>Ue.get(`/assignments/${e}/${t}`),getByEvent:e=>Ue.get(`/assignments/event/${e}`),delete:(e,t)=>Ue.delete(`/assignments/${e}/${t}`),getEventStatus:e=>Ue.get(`/events/${e}/status`)},ks={checkIn:e=>Ue.post("/checkin",e),adminCheckIn:(e,t)=>Ue.post(`/checkin/admin/${e}/${t}`)},_c={getAdmins:e=>Ue.get(`/events/${e}/admins`),addAdmin:(e,t)=>Ue.post(`/events/${e}/admins`,{userEmail:t}),removeAdmin:(e,t)=>Ue.delete(`/events/${e}/admins/${t}`)},jo={create:e=>Ue.post("/marshals",e),getByEvent:e=>Ue.get(`/events/${e}/marshals`),getById:(e,t)=>Ue.get(`/marshals/${e}/${t}`),update:(e,t,o)=>Ue.put(`/marshals/${e}/${t}`,o),delete:(e,t)=>Ue.delete(`/marshals/${e}/${t}`),getMagicLink:(e,t)=>Ue.get(`/marshals/${e}/${t}/magic-link`),sendMagicLink:(e,t)=>Ue.post(`/marshals/${e}/${t}/send-magic-link`),importCsv:(e,t)=>{const o=new FormData;return o.append("csv",t),Ue.post(`/marshals/import/${e}`,o,{headers:{"Content-Type":"multipart/form-data"}})}},Ys={create:e=>Ue.post("/areas",e),getByEvent:e=>Ue.get(`/events/${e}/areas`),getById:(e,t)=>Ue.get(`/areas/${e}/${t}`),update:(e,t,o)=>Ue.put(`/areas/${e}/${t}`,o),delete:(e,t)=>Ue.delete(`/areas/${e}/${t}`),recalculate:e=>Ue.post(`/areas/recalculate/${e}`),getCheckpoints:(e,t)=>Ue.get(`/areas/${e}/${t}/locations`),getAreaLeadDashboard:e=>Ue.get(`/events/${e}/area-lead-dashboard`)},Ot={create:(e,t)=>Ue.post(`/events/${e}/checklist-items`,t),getByEvent:e=>Ue.get(`/events/${e}/checklist-items`),getById:(e,t)=>Ue.get(`/checklist-items/${e}/${t}`),update:(e,t,o)=>Ue.put(`/checklist-items/${e}/${t}`,o),delete:(e,t)=>Ue.delete(`/checklist-items/${e}/${t}`),getReport:e=>Ue.get(`/events/${e}/checklist-report`),getMarshalChecklist:(e,t)=>Ue.get(`/events/${e}/marshals/${t}/checklist`),getCheckpointChecklist:(e,t)=>Ue.get(`/events/${e}/locations/${t}/checklist`),getAreaChecklist:(e,t)=>Ue.get(`/events/${e}/areas/${t}/checklist`),complete:(e,t,o)=>Ue.post(`/checklist-items/${e}/${t}/complete`,o),uncomplete:(e,t,o)=>Ue.post(`/checklist-items/${e}/${t}/uncomplete`,o)},ps={create:(e,t)=>Ue.post(`/events/${e}/notes`,t),getByEvent:e=>Ue.get(`/events/${e}/notes`),getById:(e,t)=>Ue.get(`/events/${e}/notes/${t}`),update:(e,t,o)=>Ue.put(`/events/${e}/notes/${t}`,o),delete:(e,t)=>Ue.delete(`/events/${e}/notes/${t}`),getMarshalNotes:(e,t)=>Ue.get(`/events/${e}/marshals/${t}/notes`),getMyNotes:e=>Ue.get(`/events/${e}/my-notes`)},Wi={create:(e,t)=>Ue.post(`/events/${e}/contacts`,t),getByEvent:e=>Ue.get(`/events/${e}/contacts`),getById:(e,t)=>Ue.get(`/events/${e}/contacts/${t}`),update:(e,t,o)=>Ue.put(`/events/${e}/contacts/${t}`,o),delete:(e,t)=>Ue.delete(`/events/${e}/contacts/${t}`),getRoles:e=>Ue.get(`/events/${e}/contact-roles`),getMarshalContacts:(e,t)=>Ue.get(`/events/${e}/marshals/${t}/contacts`),getMyContacts:e=>Ue.get(`/events/${e}/my-contacts`)},Yn={create:(e,t)=>Ue.post(`/events/${e}/incidents`,t),getAll:(e,t={})=>Ue.get(`/events/${e}/incidents`,{params:t}),getForArea:(e,t)=>Ue.get(`/events/${e}/areas/${t}/incidents`),get:(e,t)=>Ue.get(`/events/${e}/incidents/${t}`),updateStatus:(e,t,o)=>Ue.patch(`/events/${e}/incidents/${t}`,o),addNote:(e,t,o)=>Ue.post(`/events/${e}/incidents/${t}/notes`,{note:o})},ar=mu("auth",()=>{const e=P(localStorage.getItem("adminEmail")||null),t=P(!!e.value),o=P(!1);return{adminEmail:e,isAuthenticated:t,loginPending:o,requestLogin:async u=>{const d=await Zo.requestLogin(u);return d.data.success&&(o.value=!0),d.data},verifyToken:async u=>{const d=await Zo.verifyToken(u);return d.data.success&&(e.value=d.data.person?.email,t.value=!0,o.value=!1,localStorage.setItem("adminEmail",d.data.person?.email),localStorage.setItem("sessionToken",d.data.sessionToken)),d.data},instantLogin:async u=>{const d=await Zo.instantLogin(u);return d.data.success&&(e.value=d.data.email,t.value=!0,localStorage.setItem("adminEmail",d.data.email),d.data.sessionToken&&localStorage.setItem("sessionToken",d.data.sessionToken)),d.data},logout:async()=>{try{await Zo.logout()}catch{}e.value=null,t.value=!1,o.value=!1,localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken")}}}),uk={class:"admin-login"},dk={class:"login-card"},hk={key:0,class:"email-sent"},fk={class:"form-group"},pk=["disabled"],vk={key:0,class:"error"},mk={__name:"AdminLogin",setup(e){const t=ar(),o=P(""),i=P(!1),s=P(null),a=P(!1),c=async()=>{i.value=!0,s.value=null;try{const d=await t.requestLogin(o.value);d.success?a.value=!0:s.value=d.message||"Failed to send login link. Please try again."}catch{s.value="Failed to send login link. Please try again."}finally{i.value=!1}},u=()=>{o.value="",a.value=!1,s.value=null};return(d,p)=>{const f=_l("router-link");return v(),m("div",uk,[l("div",dk,[p[7]||(p[7]=l("h2",null,"Admin login",-1)),a.value?(v(),m("div",hk,[p[2]||(p[2]=l("div",{class:"check-icon"},"",-1)),p[3]||(p[3]=l("h3",null,"Check your email!",-1)),l("p",null,[p[1]||(p[1]=Ve("We've sent a login link to ",-1)),l("strong",null,_(o.value),1)]),p[4]||(p[4]=l("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),l("button",{onClick:u,class:"btn btn-secondary"}," Use a different email ")])):(v(),m(we,{key:1},[p[5]||(p[5]=l("p",{class:"instruction"},"Enter your email to receive a login link",-1)),l("form",{onSubmit:gt(c,["prevent"])},[l("div",fk,[Ge(l("input",{"onUpdate:modelValue":p[0]||(p[0]=y=>o.value=y),type:"email",placeholder:"admin@example.com",required:"",class:"form-input"},null,512),[[at,o.value]])]),l("button",{type:"submit",class:"btn btn-primary",disabled:i.value},_(i.value?"Sending...":"Send login link"),9,pk)],32),s.value?(v(),m("div",vk,_(s.value),1)):D("",!0)],64)),Ne(f,{to:"/",class:"back-link"},{default:Qe(()=>[...p[6]||(p[6]=[Ve(" Back to Home",-1)])]),_:1})])])}}},gk=Ye(mk,[["__scopeId","data-v-1eafb4d9"]]),yk={class:"admin-verify"},_k={class:"verify-card"},kk={key:0,class:"status"},bk={key:1,class:"status error"},wk={key:2,class:"status success"},Ck={__name:"AdminVerify",setup(e){const t=tr(),o=_u(),i=ar(),s=P(!0),a=P(null);return on(async()=>{const c=o.query.token;if(!c){a.value="No login token provided. Please request a new login link.",s.value=!1;return}try{const u=await i.verifyToken(c);u.success?setTimeout(()=>{t.push({name:"AdminDashboard"})},1e3):a.value=u.message||"Invalid or expired login link. Please request a new one."}catch(u){console.error("Verification error:",u),a.value="Failed to verify login. Please try again."}finally{s.value=!1}}),(c,u)=>{const d=_l("router-link");return v(),m("div",yk,[l("div",_k,[s.value?(v(),m("div",kk,[...u[0]||(u[0]=[l("div",{class:"spinner"},null,-1),l("h2",null,"Verifying your login...",-1),l("p",null,"Please wait while we confirm your identity.",-1)])])):a.value?(v(),m("div",bk,[u[2]||(u[2]=l("h2",null,"Login failed",-1)),l("p",null,_(a.value),1),Ne(d,{to:"/admin/login",class:"btn btn-primary"},{default:Qe(()=>[...u[1]||(u[1]=[Ve(" Try again ",-1)])]),_:1})])):(v(),m("div",wk,[...u[3]||(u[3]=[l("h2",null,"Login successful!",-1),l("p",null,"Redirecting to dashboard...",-1)])]))])])}}},Lk=Ye(Ck,[["__scopeId","data-v-5012f94a"]]),zp=mu("events",()=>{const e=P([]),t=P(null),o=P([]),i=P([]),s=P(null),a=P(!1),c=P(null),u=async()=>{a.value=!0,c.value=null;try{const k=await bi.getAll();e.value=k.data}catch(k){throw c.value=k.message,k}finally{a.value=!1}},d=async k=>{a.value=!0,c.value=null;try{const M=await bi.getById(k);t.value=M.data}catch(M){throw c.value=M.message,M}finally{a.value=!1}},p=async k=>{a.value=!0,c.value=null;try{const M=await bi.create(k);return e.value.push(M.data),M.data}catch(M){throw c.value=M.message,M}finally{a.value=!1}},f=async(k,M)=>{a.value=!0,c.value=null;try{const G=await bi.update(k,M),ne=e.value.findIndex(ce=>ce.id===k);return ne!==-1&&(e.value[ne]=G.data),t.value?.id===k&&(t.value=G.data),G.data}catch(G){throw c.value=G.message,G}finally{a.value=!1}},y=async k=>{a.value=!0,c.value=null;try{await bi.delete(k),e.value=e.value.filter(M=>M.id!==k)}catch(M){throw c.value=M.message,M}finally{a.value=!1}},b=async k=>{a.value=!0,c.value=null;try{const M=await Nn.getByEvent(k);o.value=M.data}catch(M){throw c.value=M.message,M}finally{a.value=!1}};return{events:e,currentEvent:t,locations:o,assignments:i,eventStatus:s,loading:a,error:c,fetchEvents:u,fetchEvent:d,createEvent:p,updateEvent:f,deleteEvent:y,fetchLocations:b,createLocation:async k=>{a.value=!0,c.value=null;try{const M=await Nn.create(k);return o.value.push(M.data),M.data}catch(M){throw c.value=M.message,M}finally{a.value=!1}},updateLocation:async(k,M,G)=>{a.value=!0,c.value=null;try{const ne=await Nn.update(k,M,G),ce=o.value.findIndex(K=>K.id===M);return ce!==-1&&(o.value[ce]=ne.data),ne.data}catch(ne){throw c.value=ne.message,ne}finally{a.value=!1}},deleteLocation:async(k,M)=>{a.value=!0,c.value=null;try{await Nn.delete(k,M),o.value=o.value.filter(G=>G.id!==M)}catch(G){throw c.value=G.message,G}finally{a.value=!1}},bulkUpdateLocationTimes:async(k,M)=>{a.value=!0,c.value=null;try{const G=await Nn.bulkUpdateTimes(k,M);return await b(k),G.data}catch(G){throw c.value=G.message,G}finally{a.value=!1}},fetchAssignments:async k=>{a.value=!0,c.value=null;try{const M=await $a.getByEvent(k);i.value=M.data}catch(M){throw c.value=M.message,M}finally{a.value=!1}},createAssignment:async k=>{a.value=!0,c.value=null;try{const M=await $a.create(k);return i.value.push(M.data),M.data}catch(M){throw c.value=M.message,M}finally{a.value=!1}},deleteAssignment:async(k,M)=>{a.value=!0,c.value=null;try{await $a.delete(k,M),i.value=i.value.filter(G=>G.id!==M)}catch(G){throw c.value=G.message,G}finally{a.value=!1}},fetchEventStatus:async k=>{a.value=!0,c.value=null;try{const M=await $a.getEventStatus(k);return s.value=M.data,M.data}catch(M){throw c.value=M.message,M}finally{a.value=!1}},updateAssignmentCheckIn:k=>{const M=i.value.findIndex(G=>G.id===k.id);M!==-1&&(i.value[M]=k),s.value&&s.value.locations.forEach(G=>{const ne=G.assignments.findIndex(ce=>ce.id===k.id);ne!==-1&&(G.assignments[ne]=k,G.checkedInCount=G.assignments.filter(ce=>ce.isCheckedIn).length)})}}}),Sk={class:"confirm-modal"},xk={class:"confirm-actions"},$k={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},showCancel:{type:Boolean,default:!0}},emits:["confirm","cancel"],setup(e,{emit:t}){const o=t,i=()=>{o("confirm")},s=()=>{o("cancel")};return(a,c)=>e.show?(v(),m("div",{key:0,class:"modal-overlay",onClick:gt(s,["self"])},[l("div",Sk,[l("h3",null,_(e.title),1),l("p",null,_(e.message),1),l("div",xk,[e.showCancel?(v(),m("button",{key:0,onClick:s,class:"btn btn-secondary"},_(e.cancelText),1)):D("",!0),l("button",{onClick:i,class:"btn btn-primary"},_(e.confirmText),1)])])])):D("",!0)}},Ka=Ye($k,[["__scopeId","data-v-9f0156d7"]]),Ik={class:"base-modal-header"},Tk={key:0,class:"base-modal-title"},Mk={key:0,class:"base-modal-tab-header"},Ak={class:"base-modal-body"},Ek={key:1,class:"base-modal-footer"},Pk={key:0,class:"base-modal-actions"},Dk={__name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},variant:{type:String,default:"center",validator:e=>["center","sidebar"].includes(e)},zIndex:{type:Number,default:1e3},closeOnOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},confirmOnClose:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=e,i=t,s=P(!1),a=P(!1),c=()=>{o.closeOnOverlay&&u()},u=()=>{o.confirmOnClose&&o.isDirty?s.value=!0:i("close")},d=()=>{s.value=!1,i("close")},p=()=>{s.value=!1};return(f,y)=>e.show?(v(),m("div",{key:0,class:"base-modal-overlay",style:ot({zIndex:e.zIndex}),onClick:gt(c,["self"])},[l("div",{class:_e(["base-modal",[`base-modal--${e.size}`,`base-modal--${e.variant}`]])},[l("div",Ik,[ka(f.$slots,"header",{},()=>[e.title?(v(),m("h2",Tk,_(e.title),1)):D("",!0)]),e.showCloseButton?(v(),m("button",{key:0,onClick:u,class:"base-modal-close",type:"button","aria-label":"Close"},"  ")):D("",!0)]),f.$slots["tab-header"]?(v(),m("div",Mk,[ka(f.$slots,"tab-header",{},void 0)])):D("",!0),l("div",Ak,[ka(f.$slots,"default",{},void 0)]),f.$slots.footer||f.$slots.actions?(v(),m("div",Ek,[ka(f.$slots,"footer",{},()=>[f.$slots.actions?(v(),m("div",Pk,[ka(f.$slots,"actions",{},void 0,!0)])):D("",!0)])])):D("",!0)],2),e.confirmOnClose&&!a.value?(v(),et(Ka,{key:0,show:s.value,title:"Unsaved changes",message:"You have unsaved changes. Are you sure you want to close?",onConfirm:d,onCancel:p},null,8,["show"])):D("",!0)],4)):D("",!0)}},Dt=Ye(Dk,[["__scopeId","data-v-2b6c2aa3"]]);function Hp(e="details",t=[]){const o=P(e),i=y=>{o.value=y},s=()=>{o.value=e},a=y=>o.value===y,c=Y(()=>t.length===0?-1:t.indexOf(o.value)),u=(y=!1)=>{if(t.length===0)return;const b=c.value;if(b===-1)return;const I=b+1;I<t.length?o.value=t[I]:y&&(o.value=t[0])},d=(y=!1)=>{if(t.length===0)return;const b=c.value;if(b===-1)return;const I=b-1;I>=0?o.value=t[I]:y&&(o.value=t[t.length-1])},p=Y(()=>{if(t.length===0)return!1;const y=c.value;return y!==-1&&y<t.length-1}),f=Y(()=>t.length===0?!1:c.value>0);return{activeTab:o,activeTabIndex:c,hasNextTab:p,hasPreviousTab:f,switchTab:i,resetTab:s,isActiveTab:a,nextTab:u,previousTab:d}}const Vp=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET/CEST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Australia/Sydney",label:"Sydney (AEDT/AEST)"}],Ok={class:"tabs"},Rk={class:"tab-content"},Bk={class:"form-group"},Nk={class:"form-group"},Fk={class:"form-group"},Uk={class:"form-group"},zk=["value"],Hk={class:"tab-content"},Vk={class:"emergency-contacts-section"},Gk={key:0,class:"empty-state"},Zk={class:"card-header"},jk=["onClick"],Wk={class:"form-group"},qk=["onUpdate:modelValue"],Kk={class:"form-group"},Yk=["onUpdate:modelValue"],Jk={class:"form-group"},Xk=["onUpdate:modelValue"],Qk={__name:"EventFormModal",props:{show:{type:Boolean,default:!1},eventData:{type:Object,default:()=>({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]})},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const o=e,i=t,{activeTab:s,switchTab:a,resetTab:c}=Hp("basic",["basic","emergency"]),u=P({...o.eventData});We(()=>o.eventData,b=>{u.value={...b},u.value.emergencyContacts||(u.value.emergencyContacts=[])},{deep:!0}),We(()=>o.show,b=>{b&&c()});const d=()=>{u.value.emergencyContacts.push({name:"",phone:"",details:""})},p=b=>{u.value.emergencyContacts.splice(b,1)},f=()=>{i("submit",{...u.value})},y=()=>{i("close")};return(b,I)=>(v(),et(Dt,{show:e.show,title:e.isEditing?"Edit event":"Create new event",size:"large",onClose:y},{"tab-header":Qe(()=>[l("div",Ok,[l("button",{type:"button",onClick:I[0]||(I[0]=T=>V(a)("basic")),class:_e(["tab-button",{active:V(s)==="basic"}])}," Basic details ",2),l("button",{type:"button",onClick:I[1]||(I[1]=T=>V(a)("emergency")),class:_e(["tab-button",{active:V(s)==="emergency"}])}," Emergency contacts ",2)])]),actions:Qe(()=>[l("button",{type:"button",onClick:y,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:f,class:"btn btn-primary"},_(e.isEditing?"Update":"Create"),1)]),default:Qe(()=>[l("form",{onSubmit:gt(f,["prevent"])},[Ge(l("div",Rk,[l("div",Bk,[I[6]||(I[6]=l("label",null,"Event name *",-1)),Ge(l("input",{"onUpdate:modelValue":I[2]||(I[2]=T=>u.value.name=T),type:"text",required:"",class:"form-input"},null,512),[[at,u.value.name]])]),l("div",Nk,[I[7]||(I[7]=l("label",null,"Description",-1)),Ge(l("textarea",{"onUpdate:modelValue":I[3]||(I[3]=T=>u.value.description=T),rows:"3",class:"form-input"},null,512),[[at,u.value.description]])]),l("div",Fk,[I[8]||(I[8]=l("label",null,"Event date *",-1)),Ge(l("input",{"onUpdate:modelValue":I[4]||(I[4]=T=>u.value.eventDate=T),type:"datetime-local",required:"",class:"form-input"},null,512),[[at,u.value.eventDate]])]),l("div",Uk,[I[9]||(I[9]=l("label",null,"Time zone *",-1)),Ge(l("select",{"onUpdate:modelValue":I[5]||(I[5]=T=>u.value.timeZoneId=T),required:"",class:"form-input"},[(v(!0),m(we,null,Pe(V(Vp),T=>(v(),m("option",{key:T.value,value:T.value},_(T.label),9,zk))),128))],512),[[vn,u.value.timeZoneId]])])],512),[[ti,V(s)==="basic"]]),Ge(l("div",Hk,[l("div",Vk,[l("div",{class:"section-header-small"},[I[10]||(I[10]=l("h3",null,"Emergency contacts",-1)),l("button",{type:"button",onClick:d,class:"btn btn-small btn-primary"}," + Add contact ")]),u.value.emergencyContacts.length===0?(v(),m("div",Gk,[...I[11]||(I[11]=[l("p",null,'No emergency contacts added yet. Click "Add contact" to add one.',-1)])])):D("",!0),(v(!0),m(we,null,Pe(u.value.emergencyContacts,(T,S)=>(v(),m("div",{key:S,class:"emergency-contact-card"},[l("div",Zk,[l("h4",null,"Contact "+_(S+1),1),l("button",{type:"button",onClick:O=>p(S),class:"btn-remove"},"  ",8,jk)]),l("div",Wk,[I[12]||(I[12]=l("label",null,"Name *",-1)),Ge(l("input",{"onUpdate:modelValue":O=>T.name=O,type:"text",required:"",class:"form-input",placeholder:"Contact person name"},null,8,qk),[[at,T.name]])]),l("div",Kk,[I[13]||(I[13]=l("label",null,"Phone *",-1)),Ge(l("input",{"onUpdate:modelValue":O=>T.phone=O,type:"tel",required:"",class:"form-input",placeholder:"+1 (555) 123-4567"},null,8,Yk),[[at,T.phone]])]),l("div",Jk,[I[14]||(I[14]=l("label",null,"Additional details",-1)),Ge(l("textarea",{"onUpdate:modelValue":O=>T.details=O,rows:"2",class:"form-input",placeholder:"Role, availability, or other important information..."},null,8,Xk),[[at,T.details]])])]))),128))])],512),[[ti,V(s)==="emergency"]])],32)]),_:1},8,["show","title"]))}},eb=Ye(Qk,[["__scopeId","data-v-9d79dd39"]]),Gp="admin-theme-preference",yi=P(tb());function tb(){return typeof window>"u"?"system":localStorage.getItem(Gp)||"system"}function nb(e){localStorage.setItem(Gp,e)}function Lu(){const e=Y(()=>yi.value==="system"?"light dark":yi.value),t=s=>{yi.value=s,nb(s)},o=()=>{const s=["system","light","dark"],c=(s.indexOf(yi.value)+1)%s.length;t(s[c])},i=Y(()=>yi.value==="dark"?!0:yi.value==="light"?!1:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1);return{theme:yi,colorScheme:e,isDark:i,setTheme:t,cycleTheme:o}}const ob=["aria-expanded"],sb=["innerHTML"],ib={class:"theme-label"},ab={key:0,class:"dropdown-menu"},rb=["onClick"],lb=["innerHTML"],cb={__name:"ThemeToggle",setup(e){const{theme:t,setTheme:o}=Lu(),i=P(!1),s=P(null),a={light:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
  </svg>`,dark:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
  </svg>`,system:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
    <line x1="8" y1="21" x2="16" y2="21"></line>
    <line x1="12" y1="17" x2="12" y2="21"></line>
  </svg>`},c=[{value:"system",label:"System",icon:a.system},{value:"light",label:"Light",icon:a.light},{value:"dark",label:"Dark",icon:a.dark}],u=Y(()=>a[t.value]||a.system),d=Y(()=>{const b=c.find(I=>I.value===t.value);return b?b.label:"System"}),p=()=>{i.value=!i.value},f=b=>{o(b),i.value=!1},y=b=>{s.value&&!s.value.contains(b.target)&&(i.value=!1)};return on(()=>{document.addEventListener("click",y)}),Lo(()=>{document.removeEventListener("click",y)}),(b,I)=>(v(),m("div",{class:"theme-dropdown",ref_key:"dropdownRef",ref:s},[l("button",{class:"theme-toggle-btn",onClick:p,type:"button","aria-expanded":i.value},[l("span",{class:"theme-icon",innerHTML:u.value},null,8,sb),l("span",ib,_(d.value),1),(v(),m("svg",{class:_e(["chevron",{open:i.value}]),width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[...I[0]||(I[0]=[l("polyline",{points:"6 9 12 15 18 9"},null,-1)])],2))],8,ob),i.value?(v(),m("div",ab,[(v(),m(we,null,Pe(c,T=>l("button",{key:T.value,class:_e(["dropdown-item",{active:V(t)===T.value}]),onClick:S=>f(T.value)},[l("span",{class:"option-icon",innerHTML:T.icon},null,8,lb),l("span",null,_(T.label),1)],10,rb)),64))])):D("",!0)],512))}},Zp=Ye(cb,[["__scopeId","data-v-42a3ed0e"]]),ub={class:"header"},db={class:"header-actions"},hb={class:"user-email"},fb={class:"container"},pb={class:"section"},vb={class:"section-header"},mb={key:0,class:"loading"},gb={key:1,class:"empty"},yb={key:2,class:"events-grid"},_b=["onClick"],kb={class:"event-date"},bb={class:"event-desc"},wb={class:"event-actions"},Cb=["onClick"],Lb=["onClick"],Sb={__name:"AdminDashboard",setup(e){const t=tr(),{colorScheme:o}=Lu(),i=ar(),s=zp(),a=P(!0),c=P(!1),u=P(null),d=P({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}),p=P([]),f=P(!1),y=P(""),b=P(""),I=P(null),T=async()=>{a.value=!0;try{await s.fetchEvents(),p.value=s.events}catch(ce){console.error("Failed to load events:",ce)}finally{a.value=!1}},S=async ce=>{try{const K={...ce,adminEmail:i.adminEmail};u.value?await s.updateEvent(u.value.id,K):await s.createEvent(K),p.value=s.events,C()}catch(K){console.error("Failed to save event:",K),alert("Failed to save event. Please try again.")}},O=ce=>{u.value=ce,d.value={name:ce.name,description:ce.description,eventDate:ne(ce.eventDate),timeZoneId:ce.timeZoneId||"UTC",emergencyContacts:ce.emergencyContacts?JSON.parse(JSON.stringify(ce.emergencyContacts)):[]}},E=async ce=>{y.value="Delete event",b.value=`Are you sure you want to delete "${ce.name}"?`,I.value=async()=>{try{await s.deleteEvent(ce.id),p.value=s.events}catch(K){console.error("Failed to delete event:",K),alert("Failed to delete event. Please try again.")}},f.value=!0},A=()=>{f.value=!1,I.value&&(I.value(),I.value=null)},$=()=>{f.value=!1,I.value=null},C=()=>{c.value=!1,u.value=null,d.value={name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}},w=ce=>{if(!ce){console.error("Cannot navigate to event: eventId is undefined");return}t.push({name:"AdminEventManage",params:{eventId:ce}})},k=()=>{t.push({name:"AdminProfile"})},M=()=>{i.logout(),t.push({name:"Home"})},G=ce=>new Date(ce).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),ne=ce=>{const K=new Date(ce),se=K.getFullYear(),me=String(K.getMonth()+1).padStart(2,"0"),Re=String(K.getDate()).padStart(2,"0"),Oe=String(K.getHours()).padStart(2,"0"),de=String(K.getMinutes()).padStart(2,"0");return`${se}-${me}-${Re}T${Oe}:${de}`};return on(()=>{T()}),(ce,K)=>(v(),m("div",{class:"admin-dashboard",style:ot({colorScheme:V(o)})},[l("header",ub,[K[1]||(K[1]=l("h1",null,"Admin dashboard",-1)),l("div",db,[Ne(Zp),l("span",hb,_(V(i).adminEmail),1),l("button",{onClick:k,class:"btn btn-secondary"},"Profile"),l("button",{onClick:M,class:"btn btn-secondary"},"Logout")])]),l("div",fb,[l("div",pb,[l("div",vb,[K[2]||(K[2]=l("h2",null,"Your events",-1)),l("button",{onClick:K[0]||(K[0]=se=>c.value=!0),class:"btn btn-primary"}," Create new event ")]),a.value?(v(),m("div",mb,"Loading events...")):p.value.length===0?(v(),m("div",gb,[...K[3]||(K[3]=[l("p",null,"No events yet. Create your first event to get started!",-1)])])):(v(),m("div",yb,[(v(!0),m(we,null,Pe(p.value,se=>(v(),m("div",{key:se.id,class:"event-card",onClick:me=>w(se.id)},[l("h3",null,_(se.name),1),l("p",kb,_(G(se.eventDate)),1),l("p",bb,_(se.description),1),l("div",wb,[l("button",{onClick:gt(me=>O(se),["stop"]),class:"btn btn-small btn-secondary"}," Edit ",8,Cb),l("button",{onClick:gt(me=>E(se),["stop"]),class:"btn btn-small btn-danger"}," Delete ",8,Lb)])],8,_b))),128))]))])]),Ne(eb,{show:c.value||!!u.value,"event-data":d.value,"is-editing":!!u.value,onClose:C,onSubmit:S},null,8,["show","event-data","is-editing"]),Ne(Ka,{show:f.value,title:y.value,message:b.value,onConfirm:A,onCancel:$},null,8,["show","title","message"])],4))}},xb=Ye(Sb,[["__scopeId","data-v-07dbfcd8"]]),$b=mu("profile",()=>{const e=P(null),t=P(!1),o=P(null);return{profile:e,loading:t,error:o,fetchProfile:async()=>{t.value=!0,o.value=null;try{const d=await Dr.getProfile();return e.value=d.data,d.data}catch(d){throw o.value=d.response?.data?.message||"Failed to load profile",d}finally{t.value=!1}},updateProfile:async d=>{t.value=!0,o.value=null;try{const p=await Dr.updateProfile(d);return e.value=p.data,p.data}catch(p){throw o.value=p.response?.data?.message||"Failed to update profile",p}finally{t.value=!1}},fetchPerson:async(d,p)=>{t.value=!0,o.value=null;try{return(await Dr.getPerson(d,p)).data}catch(f){throw o.value=f.response?.data?.message||"Failed to load person",f}finally{t.value=!1}},updatePerson:async(d,p,f)=>{t.value=!0,o.value=null;try{return(await Dr.updatePerson(d,p,f)).data}catch(y){throw o.value=y.response?.data?.message||"Failed to update person",y}finally{t.value=!1}},clearProfile:()=>{e.value=null,o.value=null}}}),Ib={class:"form-group"},Tb={class:"form-group"},Mb={class:"form-group"},Ab={__name:"EditProfileModal",props:{show:{type:Boolean,default:!1},profile:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=P({name:"",email:"",phone:""});We(()=>o.profile,d=>{d&&(s.value={name:d.name||"",email:d.email||"",phone:d.phone||""})},{immediate:!0,deep:!0}),We(()=>o.show,d=>{d&&o.profile&&(s.value={name:o.profile.name||"",email:o.profile.email||"",phone:o.profile.phone||""})});const a=()=>{i("update:isDirty",!0)},c=()=>{if(!s.value.name.trim()){alert("Name is required");return}if(!s.value.email.trim()){alert("Email is required");return}i("submit",{name:s.value.name.trim(),email:s.value.email.trim(),phone:s.value.phone?.trim()||""})},u=()=>{i("close")};return(d,p)=>(v(),et(Dt,{show:e.show,title:"Edit profile",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:Qe(()=>[l("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:c,class:"btn btn-primary"}," Save changes ")]),default:Qe(()=>[l("form",{onSubmit:gt(c,["prevent"])},[l("div",Ib,[p[3]||(p[3]=l("label",null,"Name *",-1)),Ge(l("input",{"onUpdate:modelValue":p[0]||(p[0]=f=>s.value.name=f),type:"text",required:"",class:"form-input",placeholder:"Your name",onInput:a},null,544),[[at,s.value.name]])]),l("div",Tb,[p[4]||(p[4]=l("label",null,"Email *",-1)),Ge(l("input",{"onUpdate:modelValue":p[1]||(p[1]=f=>s.value.email=f),type:"email",required:"",class:"form-input",placeholder:"Your email address",onInput:a},null,544),[[at,s.value.email]])]),l("div",Mb,[p[5]||(p[5]=l("label",null,"Phone",-1)),Ge(l("input",{"onUpdate:modelValue":p[2]||(p[2]=f=>s.value.phone=f),type:"tel",class:"form-input",placeholder:"Your phone number",onInput:a},null,544),[[at,s.value.phone]])])],32)]),_:1},8,["show","is-dirty"]))}},Eb=Ye(Ab,[["__scopeId","data-v-9a8cb8be"]]),Pb={class:"admin-profile"},Db={class:"header"},Ob={class:"header-actions"},Rb={class:"user-email"},Bb={class:"container"},Nb={class:"section"},Fb={class:"section-header"},Ub={key:0,class:"loading"},zb={key:1,class:"error"},Hb={key:2,class:"profile-details"},Vb={class:"profile-field"},Gb={class:"field-value"},Zb={class:"profile-field"},jb={class:"field-value"},Wb={class:"profile-field"},qb={class:"field-value"},Kb={class:"profile-field"},Yb={class:"field-value"},Jb={__name:"AdminProfile",setup(e){const t=tr(),o=ar(),i=$b(),s=P(!1),a=async()=>{try{await i.fetchProfile()}catch(p){console.error("Failed to load profile:",p)}},c=async p=>{try{await i.updateProfile(p),s.value=!1}catch(f){console.error("Failed to save profile:",f),alert("Failed to save profile. Please try again.")}},u=()=>{o.logout(),t.push({name:"Home"})},d=()=>{t.push({name:"AdminDashboard"})};return on(()=>{a()}),(p,f)=>(v(),m("div",Pb,[l("header",Db,[f[2]||(f[2]=l("h1",null,"My profile",-1)),l("div",Ob,[l("span",Rb,_(V(o).adminEmail),1),l("button",{onClick:u,class:"btn btn-secondary"},"Logout")])]),l("div",Bb,[l("div",Nb,[l("div",Fb,[f[3]||(f[3]=l("h2",null,"Profile information",-1)),l("button",{onClick:f[0]||(f[0]=y=>s.value=!0),class:"btn btn-primary"}," Edit profile ")]),V(i).loading?(v(),m("div",Ub,"Loading profile...")):V(i).error?(v(),m("div",zb,[l("p",null,_(V(i).error),1),l("button",{onClick:a,class:"btn btn-secondary"},"Retry")])):V(i).profile?(v(),m("div",Hb,[l("div",Vb,[f[4]||(f[4]=l("label",null,"Name",-1)),l("div",Gb,_(V(i).profile.name||""),1)]),l("div",Zb,[f[5]||(f[5]=l("label",null,"Email",-1)),l("div",jb,_(V(i).profile.email||""),1)]),l("div",Wb,[f[6]||(f[6]=l("label",null,"Phone",-1)),l("div",qb,_(V(i).profile.phone||""),1)]),l("div",Kb,[f[7]||(f[7]=l("label",null,"System admin",-1)),l("div",Yb,[l("span",{class:_e(["badge",V(i).profile.isSystemAdmin?"badge-success":"badge-secondary"])},_(V(i).profile.isSystemAdmin?"Yes":"No"),3)])])])):D("",!0)]),l("div",{class:"section"},[l("button",{onClick:d,class:"btn btn-secondary"}," Back to Dashboard ")])]),Ne(Eb,{show:s.value,profile:V(i).profile,onClose:f[1]||(f[1]=y=>s.value=!1),onSubmit:c},null,8,["show","profile"])]))}},Xb=Ye(Jb,[["__scopeId","data-v-4d07684c"]]);function Qb(){const e=P(!1),t=P(""),o=P(""),i=P(null);return{showConfirmModal:e,confirmModalTitle:t,confirmModalMessage:o,showConfirm:(d,p,f)=>{t.value=d,o.value=p,i.value=f,e.value=!0},handleConfirmModalConfirm:()=>{e.value=!1,i.value&&(i.value(),i.value=null)},handleConfirmModalCancel:()=>{e.value=!1,i.value=null},closeConfirmModal:()=>{e.value=!1,i.value=null}}}const qi=P({people:"Marshals",checkpoint:"Checkpoints",area:"Areas",checklist:"Checklists",course:"Course"}),bs={people:{People:{singular:"Person",plural:"People"},Marshals:{singular:"Marshal",plural:"Marshals"},Volunteers:{singular:"Volunteer",plural:"Volunteers"},Helpers:{singular:"Helper",plural:"Helpers"},Staff:{singular:"Staff member",plural:"Staff"},Stewards:{singular:"Steward",plural:"Stewards"},"Team members":{singular:"Team member",plural:"Team members"},Drivers:{singular:"Driver",plural:"Drivers"},Pilots:{singular:"Pilot",plural:"Pilots"}},checkpoint:{Checkpoints:{singular:"Checkpoint",plural:"Checkpoints"},Stations:{singular:"Station",plural:"Stations"},Locations:{singular:"Location",plural:"Locations"},"Feed stations":{singular:"Feed station",plural:"Feed stations"},"Aid stations":{singular:"Aid station",plural:"Aid stations"},"Water stations":{singular:"Water station",plural:"Water stations"},"Person points":{singular:null,plural:null,dynamic:!0}},area:{Areas:{singular:"Area",plural:"Areas"},Regions:{singular:"Region",plural:"Regions"},Zones:{singular:"Zone",plural:"Zones"}},checklist:{Checklists:{singular:"Checklist",plural:"Checklists"},Tasks:{singular:"Task",plural:"Tasks"},Jobs:{singular:"Job",plural:"Jobs"}},course:{Course:{singular:"Course",plural:"Courses"},Route:{singular:"Route",plural:"Routes"},Track:{singular:"Track",plural:"Tracks"},Trail:{singular:"Trail",plural:"Trails"},Path:{singular:"Path",plural:"Paths"}}},_s={people:["Drivers","Helpers","Marshals","People","Pilots","Staff","Stewards","Team members","Volunteers"],checkpoint:["Aid stations","Checkpoints","Feed stations","Locations","Person points","Stations","Water stations"],area:["Areas","Regions","Zones"],checklist:["Checklists","Jobs","Tasks"],course:["Course","Path","Route","Track","Trail"]};function wi(e,t,o="Marshals"){if(!t)return"";const i=bs[e]?.[t];return e==="checkpoint"&&t==="Person points"?`${bs.people[o]?.singular||"Person"} point`:i?.singular?i.singular:t.endsWith("s")&&!t.endsWith("ss")?t.slice(0,-1):t}function jp(e,t,o="Marshals"){if(!t)return"";const i=bs[e]?.[t];return t==="Person points"?`${bs.people[o]?.singular||"Person"} points`:i?.plural?i.plural:t}function jc(e,t){return e==="Person points"?`${bs.people[t]?.singular||"Person"} points`:e}function Wc(e){e&&(qi.value={people:e.peopleTerm||"Marshals",checkpoint:e.checkpointTerm||"Checkpoints",area:e.areaTerm||"Areas",checklist:e.checklistTerm||"Checklists",course:e.courseTerm||"Course"})}const vo=e=>e.toLowerCase(),mo=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();function Lt(){const e=f=>{const y=qi.value[f],b=bs[f]?.[y];if(f==="checkpoint"&&y==="Person points"){const I=qi.value.people;return`${bs.people[I]?.singular||"Person"} point`}return b?.singular||y},t=f=>{const y=qi.value[f],b=bs[f]?.[y];if(f==="checkpoint"&&y==="Person points"){const I=qi.value.people;return`${bs.people[I]?.singular||"Person"} points`}return b?.plural||y},o=Y(()=>({person:e("people"),checkpoint:e("checkpoint"),area:e("area"),checklist:e("checklist"),course:e("course"),people:t("people"),checkpoints:t("checkpoint"),areas:t("area"),checklists:t("checklist"),courses:t("course")})),i=Y(()=>({person:vo(e("people")),checkpoint:vo(e("checkpoint")),area:vo(e("area")),checklist:vo(e("checklist")),course:vo(e("course")),people:vo(t("people")),checkpoints:vo(t("checkpoint")),areas:vo(t("area")),checklists:vo(t("checklist")),courses:vo(t("course"))})),s=Y(()=>({person:mo(e("people")),checkpoint:mo(e("checkpoint")),area:mo(e("area")),checklist:mo(e("checklist")),course:mo(e("course")),people:mo(t("people")),checkpoints:mo(t("checkpoint")),areas:mo(t("area")),checklists:mo(t("checklist")),courses:mo(t("course"))})),a=Y(()=>({course:o.value.course,checkpoints:o.value.checkpoints,areas:o.value.areas,marshals:o.value.people,checklists:o.value.checklists,notes:"Notes",details:"Event details"}));return{terms:o,termsLower:i,termsSentence:s,tabLabels:a,singular:e,plural:t,formatCount:(f,y)=>y===1?`1 ${e(f)}`:`${y} ${t(f)}`,lower:(f,y=!0)=>vo(y?t(f):e(f)),title:(f,y=!0)=>y?t(f):e(f),sentence:(f,y=!0)=>mo(y?t(f):e(f)),terminology:qi}}function ew(){const e=P(!1),t=P(null),o=P({}),i=P(null),s=P(null),a=P([]),c=P(null),u=P(null),d=P(!1),p=P(!1),f=P(1),y=Y(()=>t.value==="place-checkpoint"||t.value==="move-checkpoint"?i.value!==null:t.value==="draw-area"?s.value&&s.value.length>=3:t.value==="add-multiple"),b=me=>{if(me){const Re=me.getMapCenter?.(),Oe=me.getMapZoom?.();Re&&Oe!==null&&(c.value=Re,u.value=Oe)}},I=(me={})=>{i.value=null,e.value=!0,t.value="place-checkpoint",o.value={title:me.title||"Select checkpoint location",description:me.description||"Click on the map to set the location. Click again to reposition."}},T=(me,Re="checkpoint")=>{i.value=null,e.value=!0,t.value="move-checkpoint",o.value={title:`Move ${Re}: ${me}`,description:"Click on the map to set the new location"}},S=(me={})=>{e.value=!0,t.value="draw-area",d.value=!0,o.value={title:me.title||"Draw area boundary",description:me.description||"Click to add points. Click Done when finished to complete the area."}},O=(me=1)=>{f.value=me,a.value=[],e.value=!0,t.value="add-multiple",p.value=!0,o.value={title:"Add multiple checkpoints",description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},E=me=>{t.value==="place-checkpoint"||t.value==="move-checkpoint"?i.value=me:t.value==="add-multiple"&&A(me)},A=me=>{a.value.push({id:`temp-${f.value}`,name:`Checkpoint ${f.value}`,description:"",latitude:me.lat,longitude:me.lng,requiredMarshals:1,what3Words:"",assignments:[],isTemporary:!0}),f.value++,o.value={...o.value,description:`Click on map to add checkpoints. Next: Checkpoint ${f.value}`}},$=me=>{s.value=me},C=()=>s.value&&s.value.length>=3?s.value.map(me=>({lat:me.lat,lng:me.lng})):null,w=()=>{e.value=!1,t.value=null,o.value={},i.value=null,c.value=null,u.value=null,s.value=null,d.value&&(d.value=!1)};return{isFullscreenMapActive:e,fullscreenMode:t,fullscreenContext:o,tempLocationCoords:i,currentDrawingPolygon:s,tempCheckpoints:a,savedMapCenter:c,savedMapZoom:u,isDrawingAreaBoundary:d,isAddingMultipleCheckpoints:p,multiCheckpointCounter:f,canCompleteFullscreen:y,saveMapState:b,enterPlaceCheckpointMode:I,enterMoveCheckpointMode:T,enterDrawAreaMode:S,enterAddMultipleMode:O,handleFullscreenMapClick:E,handlePolygonDrawing:$,getCompletedPolygon:C,exitFullscreen:w,cancelFullscreen:()=>{t.value==="add-multiple"?(a.value=[],p.value=!1):t.value==="draw-area"&&(d.value=!1,s.value=null),w()},getTempCheckpoints:()=>[...a.value],clearTempCheckpoints:()=>{a.value=[],p.value=!1},getPlacedCoords:()=>i.value,createDisplayCheckpoints:(me,Re,Oe)=>Y(()=>{const de=[...me.value];return t.value==="place-checkpoint"&&i.value&&de.push({id:"temp-single",name:Re.value?.name||"New Checkpoint",latitude:i.value.lat,longitude:i.value.lng,requiredMarshals:Re.value?.requiredMarshals||1,assignments:[],isTemporary:!0}),t.value==="move-checkpoint"&&i.value&&Oe.value&&de.push({id:"temp-move",name:Oe.value.name+" (new position)",latitude:i.value.lat,longitude:i.value.lng,requiredMarshals:Oe.value.requiredMarshals,assignments:[],isTemporary:!0}),t.value==="add-multiple"&&de.push(...a.value),de}),createDisplayAreas:(me,Re)=>Y(()=>{const Oe=[...me.value];if(t.value==="draw-area"&&Re.value?.polygon?.length>0){const de=Oe.findIndex(he=>he.id===Re.value.id);de>=0?Oe[de]={...Re.value}:Oe.push({...Re.value,id:Re.value.id||"temp-area"})}return Oe}),calculateStartingNumber:me=>{const Re=me.value.map(Oe=>{const de=Oe.name.match(/^Checkpoint (\d+)$/);return de?parseInt(de[1]):0}).filter(Oe=>Oe>0);return Re.length>0?Math.max(...Re)+1:1}}}function tw(e){const t=P([]),o=P(!1);return{eventAdmins:t,showAddAdmin:o,loadEventAdmins:async()=>{try{const d=await _c.getAdmins(e.value);return t.value=d.data,d.data}catch(d){throw console.error("Failed to load event admins:",d),d}},openAddAdminModal:()=>{o.value=!0},closeAddAdminModal:()=>{o.value=!1},addAdmin:async d=>{await _c.addAdmin(e.value,d)},removeAdmin:async d=>{await _c.removeAdmin(e.value,d)}}}function nw(e){const t=P(!1),o=P(!1),i=P(!1),s=P(!1),a=P(!1),c=P(!1),u=P(null),d=P(null),p=P(null),f=P(null);return{showUploadRoute:t,showImportLocations:o,showImportMarshals:i,uploading:s,importing:a,importingMarshals:c,uploadError:u,importError:d,importResult:p,importMarshalsResult:f,openUploadRouteModal:()=>{u.value=null,t.value=!0},closeUploadRouteModal:()=>{t.value=!1,u.value=null},uploadRoute:async w=>{if(!w)return u.value="Please select a GPX file",null;s.value=!0,u.value=null;try{return await bi.uploadGpx(e.value,w),!0}catch(k){return console.error("Failed to upload route:",k),u.value=k.response?.data?.message||"Failed to upload route. Please try again.",null}finally{s.value=!1}},openImportLocationsModal:()=>{d.value=null,p.value=null,o.value=!0},closeImportLocationsModal:()=>{o.value=!1,d.value=null,p.value=null},importLocations:async(w,k)=>{if(!w)return d.value="Please select a CSV file",null;a.value=!0,d.value=null,p.value=null;try{const M=await Nn.importCsv(e.value,w,k);return p.value=M.data,M.data}catch(M){return console.error("Failed to import locations:",M),d.value=M.response?.data?.message||"Failed to import locations. Please try again.",null}finally{a.value=!1}},openImportMarshalsModal:()=>{d.value=null,f.value=null,i.value=!0},closeImportMarshalsModal:()=>{i.value=!1,d.value=null,f.value=null},importMarshals:async w=>{if(!w)return d.value="Please select a CSV file",null;c.value=!0,d.value=null,f.value=null;try{const k=await jo.importCsv(e.value,w);return f.value=k.data,k.data}catch(k){return console.error("Failed to import marshals:",k),d.value=k.response?.data?.message||"Failed to import marshals. Please try again.",null}finally{c.value=!1}},formatImportResultMessage:(w,k="location")=>{const M=k==="location"?"location(s)":"marshal(s)";let ne=`<p>Created <strong>${w[k==="location"?"locationsCreated":"marshalsCreated"]}</strong> ${M} and <strong>${w.assignmentsCreated}</strong> assignment(s)</p>`;return w.errors&&w.errors.length>0&&(ne+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',w.errors.forEach(ce=>{ne+=`<li>${ce}</li>`}),ne+="</ul>"),ne}}}const Wp=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",Ya=e=>{if(!e)return"";const t=new Date(e),o=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=String(t.getHours()).padStart(2,"0"),c=String(t.getMinutes()).padStart(2,"0");return`${o}-${i}-${s}T${a}:${c}`},il=e=>{if(!e||e.trim()==="")return!0;if(!/^[a-z]{1,20}[./][a-z]{1,20}[./][a-z]{1,20}$/.test(e))return!1;const o=e.includes("."),i=e.includes("/");return o!==i};function ow(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ia={exports:{}};var sw=Ia.exports,wh;function iw(){return wh||(wh=1,(function(e,t){(function(o,i){i(t)})(sw,(function(o){var i="1.9.4";function s(n){var r,h,g,x;for(h=1,g=arguments.length;h<g;h++){x=arguments[h];for(r in x)n[r]=x[r]}return n}var a=Object.create||(function(){function n(){}return function(r){return n.prototype=r,new n}})();function c(n,r){var h=Array.prototype.slice;if(n.bind)return n.bind.apply(n,h.call(arguments,1));var g=h.call(arguments,2);return function(){return n.apply(r,g.length?g.concat(h.call(arguments)):arguments)}}var u=0;function d(n){return"_leaflet_id"in n||(n._leaflet_id=++u),n._leaflet_id}function p(n,r,h){var g,x,R,te;return te=function(){g=!1,x&&(R.apply(h,x),x=!1)},R=function(){g?x=arguments:(n.apply(h,arguments),setTimeout(te,r),g=!0)},R}function f(n,r,h){var g=r[1],x=r[0],R=g-x;return n===g&&h?n:((n-x)%R+R)%R+x}function y(){return!1}function b(n,r){if(r===!1)return n;var h=Math.pow(10,r===void 0?6:r);return Math.round(n*h)/h}function I(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function T(n){return I(n).split(/\s+/)}function S(n,r){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?a(n.options):{});for(var h in r)n.options[h]=r[h];return n.options}function O(n,r,h){var g=[];for(var x in n)g.push(encodeURIComponent(h?x.toUpperCase():x)+"="+encodeURIComponent(n[x]));return(!r||r.indexOf("?")===-1?"?":"&")+g.join("&")}var E=/\{ *([\w_ -]+) *\}/g;function A(n,r){return n.replace(E,function(h,g){var x=r[g];if(x===void 0)throw new Error("No value provided for variable "+h);return typeof x=="function"&&(x=x(r)),x})}var $=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function C(n,r){for(var h=0;h<n.length;h++)if(n[h]===r)return h;return-1}var w="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function k(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var M=0;function G(n){var r=+new Date,h=Math.max(0,16-(r-M));return M=r+h,window.setTimeout(n,h)}var ne=window.requestAnimationFrame||k("RequestAnimationFrame")||G,ce=window.cancelAnimationFrame||k("CancelAnimationFrame")||k("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function K(n,r,h){if(h&&ne===G)n.call(r);else return ne.call(window,c(n,r))}function se(n){n&&ce.call(window,n)}var me={__proto__:null,extend:s,create:a,bind:c,get lastId(){return u},stamp:d,throttle:p,wrapNum:f,falseFn:y,formatNum:b,trim:I,splitWords:T,setOptions:S,getParamString:O,template:A,isArray:$,indexOf:C,emptyImageUrl:w,requestFn:ne,cancelFn:ce,requestAnimFrame:K,cancelAnimFrame:se};function Re(){}Re.extend=function(n){var r=function(){S(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=r.__super__=this.prototype,g=a(h);g.constructor=r,r.prototype=g;for(var x in this)Object.prototype.hasOwnProperty.call(this,x)&&x!=="prototype"&&x!=="__super__"&&(r[x]=this[x]);return n.statics&&s(r,n.statics),n.includes&&(Oe(n.includes),s.apply(null,[g].concat(n.includes))),s(g,n),delete g.statics,delete g.includes,g.options&&(g.options=h.options?a(h.options):{},s(g.options,n.options)),g._initHooks=[],g.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var R=0,te=g._initHooks.length;R<te;R++)g._initHooks[R].call(this)}},r},Re.include=function(n){var r=this.prototype.options;return s(this.prototype,n),n.options&&(this.prototype.options=r,this.mergeOptions(n.options)),this},Re.mergeOptions=function(n){return s(this.prototype.options,n),this},Re.addInitHook=function(n){var r=Array.prototype.slice.call(arguments,1),h=typeof n=="function"?n:function(){this[n].apply(this,r)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function Oe(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=$(n)?n:[n];for(var r=0;r<n.length;r++)n[r]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var de={on:function(n,r,h){if(typeof n=="object")for(var g in n)this._on(g,n[g],r);else{n=T(n);for(var x=0,R=n.length;x<R;x++)this._on(n[x],r,h)}return this},off:function(n,r,h){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var g in n)this._off(g,n[g],r);else{n=T(n);for(var x=arguments.length===1,R=0,te=n.length;R<te;R++)x?this._off(n[R]):this._off(n[R],r,h)}return this},_on:function(n,r,h,g){if(typeof r!="function"){console.warn("wrong listener type: "+typeof r);return}if(this._listens(n,r,h)===!1){h===this&&(h=void 0);var x={fn:r,ctx:h};g&&(x.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(x)}},_off:function(n,r,h){var g,x,R;if(this._events&&(g=this._events[n],!!g)){if(arguments.length===1){if(this._firingCount)for(x=0,R=g.length;x<R;x++)g[x].fn=y;delete this._events[n];return}if(typeof r!="function"){console.warn("wrong listener type: "+typeof r);return}var te=this._listens(n,r,h);if(te!==!1){var pe=g[te];this._firingCount&&(pe.fn=y,this._events[n]=g=g.slice()),g.splice(te,1)}}},fire:function(n,r,h){if(!this.listens(n,h))return this;var g=s({},r,{type:n,target:this,sourceTarget:r&&r.sourceTarget||this});if(this._events){var x=this._events[n];if(x){this._firingCount=this._firingCount+1||1;for(var R=0,te=x.length;R<te;R++){var pe=x[R],ke=pe.fn;pe.once&&this.off(n,ke,pe.ctx),ke.call(pe.ctx||this,g)}this._firingCount--}}return h&&this._propagateEvent(g),this},listens:function(n,r,h,g){typeof n!="string"&&console.warn('"string" type argument expected');var x=r;typeof r!="function"&&(g=!!r,x=void 0,h=void 0);var R=this._events&&this._events[n];if(R&&R.length&&this._listens(n,x,h)!==!1)return!0;if(g){for(var te in this._eventParents)if(this._eventParents[te].listens(n,r,h,g))return!0}return!1},_listens:function(n,r,h){if(!this._events)return!1;var g=this._events[n]||[];if(!r)return!!g.length;h===this&&(h=void 0);for(var x=0,R=g.length;x<R;x++)if(g[x].fn===r&&g[x].ctx===h)return x;return!1},once:function(n,r,h){if(typeof n=="object")for(var g in n)this._on(g,n[g],r,!0);else{n=T(n);for(var x=0,R=n.length;x<R;x++)this._on(n[x],r,h,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[d(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[d(n)],this},_propagateEvent:function(n){for(var r in this._eventParents)this._eventParents[r].fire(n.type,s({layer:n.target,propagatedFrom:n.target},n),!0)}};de.addEventListener=de.on,de.removeEventListener=de.clearAllEventListeners=de.off,de.addOneTimeEventListener=de.once,de.fireEvent=de.fire,de.hasEventListeners=de.listens;var he=Re.extend(de);function ve(n,r,h){this.x=h?Math.round(n):n,this.y=h?Math.round(r):r}var Te=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};ve.prototype={clone:function(){return new ve(this.x,this.y)},add:function(n){return this.clone()._add(fe(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(fe(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new ve(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new ve(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Te(this.x),this.y=Te(this.y),this},distanceTo:function(n){n=fe(n);var r=n.x-this.x,h=n.y-this.y;return Math.sqrt(r*r+h*h)},equals:function(n){return n=fe(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=fe(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+b(this.x)+", "+b(this.y)+")"}};function fe(n,r,h){return n instanceof ve?n:$(n)?new ve(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new ve(n.x,n.y):new ve(n,r,h)}function xe(n,r){if(n)for(var h=r?[n,r]:n,g=0,x=h.length;g<x;g++)this.extend(h[g])}xe.prototype={extend:function(n){var r,h;if(!n)return this;if(n instanceof ve||typeof n[0]=="number"||"x"in n)r=h=fe(n);else if(n=Be(n),r=n.min,h=n.max,!r||!h)return this;return!this.min&&!this.max?(this.min=r.clone(),this.max=h.clone()):(this.min.x=Math.min(r.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(r.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(n){return fe((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return fe(this.min.x,this.max.y)},getTopRight:function(){return fe(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var r,h;return typeof n[0]=="number"||n instanceof ve?n=fe(n):n=Be(n),n instanceof xe?(r=n.min,h=n.max):r=h=n,r.x>=this.min.x&&h.x<=this.max.x&&r.y>=this.min.y&&h.y<=this.max.y},intersects:function(n){n=Be(n);var r=this.min,h=this.max,g=n.min,x=n.max,R=x.x>=r.x&&g.x<=h.x,te=x.y>=r.y&&g.y<=h.y;return R&&te},overlaps:function(n){n=Be(n);var r=this.min,h=this.max,g=n.min,x=n.max,R=x.x>r.x&&g.x<h.x,te=x.y>r.y&&g.y<h.y;return R&&te},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var r=this.min,h=this.max,g=Math.abs(r.x-h.x)*n,x=Math.abs(r.y-h.y)*n;return Be(fe(r.x-g,r.y-x),fe(h.x+g,h.y+x))},equals:function(n){return n?(n=Be(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function Be(n,r){return!n||n instanceof xe?n:new xe(n,r)}function re(n,r){if(n)for(var h=r?[n,r]:n,g=0,x=h.length;g<x;g++)this.extend(h[g])}re.prototype={extend:function(n){var r=this._southWest,h=this._northEast,g,x;if(n instanceof Me)g=n,x=n;else if(n instanceof re){if(g=n._southWest,x=n._northEast,!g||!x)return this}else return n?this.extend($e(n)||Ee(n)):this;return!r&&!h?(this._southWest=new Me(g.lat,g.lng),this._northEast=new Me(x.lat,x.lng)):(r.lat=Math.min(g.lat,r.lat),r.lng=Math.min(g.lng,r.lng),h.lat=Math.max(x.lat,h.lat),h.lng=Math.max(x.lng,h.lng)),this},pad:function(n){var r=this._southWest,h=this._northEast,g=Math.abs(r.lat-h.lat)*n,x=Math.abs(r.lng-h.lng)*n;return new re(new Me(r.lat-g,r.lng-x),new Me(h.lat+g,h.lng+x))},getCenter:function(){return new Me((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Me(this.getNorth(),this.getWest())},getSouthEast:function(){return new Me(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof Me||"lat"in n?n=$e(n):n=Ee(n);var r=this._southWest,h=this._northEast,g,x;return n instanceof re?(g=n.getSouthWest(),x=n.getNorthEast()):g=x=n,g.lat>=r.lat&&x.lat<=h.lat&&g.lng>=r.lng&&x.lng<=h.lng},intersects:function(n){n=Ee(n);var r=this._southWest,h=this._northEast,g=n.getSouthWest(),x=n.getNorthEast(),R=x.lat>=r.lat&&g.lat<=h.lat,te=x.lng>=r.lng&&g.lng<=h.lng;return R&&te},overlaps:function(n){n=Ee(n);var r=this._southWest,h=this._northEast,g=n.getSouthWest(),x=n.getNorthEast(),R=x.lat>r.lat&&g.lat<h.lat,te=x.lng>r.lng&&g.lng<h.lng;return R&&te},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,r){return n?(n=Ee(n),this._southWest.equals(n.getSouthWest(),r)&&this._northEast.equals(n.getNorthEast(),r)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Ee(n,r){return n instanceof re?n:new re(n,r)}function Me(n,r,h){if(isNaN(n)||isNaN(r))throw new Error("Invalid LatLng object: ("+n+", "+r+")");this.lat=+n,this.lng=+r,h!==void 0&&(this.alt=+h)}Me.prototype={equals:function(n,r){if(!n)return!1;n=$e(n);var h=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return h<=(r===void 0?1e-9:r)},toString:function(n){return"LatLng("+b(this.lat,n)+", "+b(this.lng,n)+")"},distanceTo:function(n){return ye.distance(this,$e(n))},wrap:function(){return ye.wrapLatLng(this)},toBounds:function(n){var r=180*n/40075017,h=r/Math.cos(Math.PI/180*this.lat);return Ee([this.lat-r,this.lng-h],[this.lat+r,this.lng+h])},clone:function(){return new Me(this.lat,this.lng,this.alt)}};function $e(n,r,h){return n instanceof Me?n:$(n)&&typeof n[0]!="object"?n.length===3?new Me(n[0],n[1],n[2]):n.length===2?new Me(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new Me(n.lat,"lng"in n?n.lng:n.lon,n.alt):r===void 0?null:new Me(n,r,h)}var ue={latLngToPoint:function(n,r){var h=this.projection.project(n),g=this.scale(r);return this.transformation._transform(h,g)},pointToLatLng:function(n,r){var h=this.scale(r),g=this.transformation.untransform(n,h);return this.projection.unproject(g)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var r=this.projection.bounds,h=this.scale(n),g=this.transformation.transform(r.min,h),x=this.transformation.transform(r.max,h);return new xe(g,x)},infinite:!1,wrapLatLng:function(n){var r=this.wrapLng?f(n.lng,this.wrapLng,!0):n.lng,h=this.wrapLat?f(n.lat,this.wrapLat,!0):n.lat,g=n.alt;return new Me(h,r,g)},wrapLatLngBounds:function(n){var r=n.getCenter(),h=this.wrapLatLng(r),g=r.lat-h.lat,x=r.lng-h.lng;if(g===0&&x===0)return n;var R=n.getSouthWest(),te=n.getNorthEast(),pe=new Me(R.lat-g,R.lng-x),ke=new Me(te.lat-g,te.lng-x);return new re(pe,ke)}},ye=s({},ue,{wrapLng:[-180,180],R:6371e3,distance:function(n,r){var h=Math.PI/180,g=n.lat*h,x=r.lat*h,R=Math.sin((r.lat-n.lat)*h/2),te=Math.sin((r.lng-n.lng)*h/2),pe=R*R+Math.cos(g)*Math.cos(x)*te*te,ke=2*Math.atan2(Math.sqrt(pe),Math.sqrt(1-pe));return this.R*ke}}),z=6378137,ee={R:z,MAX_LATITUDE:85.0511287798,project:function(n){var r=Math.PI/180,h=this.MAX_LATITUDE,g=Math.max(Math.min(h,n.lat),-h),x=Math.sin(g*r);return new ve(this.R*n.lng*r,this.R*Math.log((1+x)/(1-x))/2)},unproject:function(n){var r=180/Math.PI;return new Me((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*r,n.x*r/this.R)},bounds:(function(){var n=z*Math.PI;return new xe([-n,-n],[n,n])})()};function ie(n,r,h,g){if($(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=r,this._c=h,this._d=g}ie.prototype={transform:function(n,r){return this._transform(n.clone(),r)},_transform:function(n,r){return r=r||1,n.x=r*(this._a*n.x+this._b),n.y=r*(this._c*n.y+this._d),n},untransform:function(n,r){return r=r||1,new ve((n.x/r-this._b)/this._a,(n.y/r-this._d)/this._c)}};function B(n,r,h,g){return new ie(n,r,h,g)}var j=s({},ye,{code:"EPSG:3857",projection:ee,transformation:(function(){var n=.5/(Math.PI*ee.R);return B(n,.5,-n,.5)})()}),X=s({},j,{code:"EPSG:900913"});function q(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function F(n,r){var h="",g,x,R,te,pe,ke;for(g=0,R=n.length;g<R;g++){for(pe=n[g],x=0,te=pe.length;x<te;x++)ke=pe[x],h+=(x?"L":"M")+ke.x+" "+ke.y;h+=r?qe.svg?"z":"x":""}return h||"M0 0"}var N=document.documentElement.style,W="ActiveXObject"in window,ge=W&&!document.addEventListener,Se="msLaunchUri"in navigator&&!("documentMode"in document),Ce=Yt("webkit"),ze=Yt("android"),Fe=Yt("android 2")||Yt("android 3"),je=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Je=ze&&Yt("Google")&&je<537&&!("AudioNode"in window),ae=!!window.opera,oe=!Se&&Yt("chrome"),J=Yt("gecko")&&!Ce&&!ae&&!W,Ze=!oe&&Yt("safari"),Xe=Yt("phantom"),rt="OTransition"in N,ft=navigator.platform.indexOf("Win")===0,vt=W&&"transition"in N,pt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Fe,ht="MozPerspective"in N,Ht=!window.L_DISABLE_3D&&(vt||pt||ht)&&!rt&&!Xe,St=typeof orientation<"u"||Yt("mobile"),qt=St&&Ce,Ms=St&&pt,Bt=!window.PointerEvent&&window.MSPointerEvent,Rt=!!(window.PointerEvent||Bt),Qn="ontouchstart"in window||!!window.TouchEvent,Kt=!window.L_NO_TOUCH&&(Qn||Rt),An=St&&ae,si=St&&J,gn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,xo=(function(){var n=!1;try{var r=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",y,r),window.removeEventListener("testPassiveEventSupport",y,r)}catch{}return n})(),eo=(function(){return!!document.createElement("canvas").getContext})(),sn=!!(document.createElementNS&&q("svg").createSVGRect),en=!!sn&&(function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),As=!sn&&(function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var r=n.firstChild;return r.style.behavior="url(#default#VML)",r&&typeof r.adj=="object"}catch{return!1}})(),$o=navigator.platform.indexOf("Mac")===0,ii=navigator.platform.indexOf("Linux")===0;function Yt(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var qe={ie:W,ielt9:ge,edge:Se,webkit:Ce,android:ze,android23:Fe,androidStock:Je,opera:ae,chrome:oe,gecko:J,safari:Ze,phantom:Xe,opera12:rt,win:ft,ie3d:vt,webkit3d:pt,gecko3d:ht,any3d:Ht,mobile:St,mobileWebkit:qt,mobileWebkit3d:Ms,msPointer:Bt,pointer:Rt,touch:Kt,touchNative:Qn,mobileOpera:An,mobileGecko:si,retina:gn,passiveEvents:xo,canvas:eo,svg:sn,vml:As,inlineSvg:en,mac:$o,linux:ii},co=qe.msPointer?"MSPointerDown":"pointerdown",uo=qe.msPointer?"MSPointerMove":"pointermove",ho=qe.msPointer?"MSPointerUp":"pointerup",En=qe.msPointer?"MSPointerCancel":"pointercancel",Gt={touchstart:co,touchmove:uo,touchend:ho,touchcancel:En},to={touchstart:Ko,touchmove:Vn,touchend:Vn,touchcancel:Vn},Hn={},Es=!1;function yn(n,r,h){return r==="touchstart"&&Io(),to[r]?(h=to[r].bind(this,h),n.addEventListener(Gt[r],h,!1),h):(console.warn("wrong event specified:",r),y)}function Ps(n,r,h){if(!Gt[r]){console.warn("wrong event specified:",r);return}n.removeEventListener(Gt[r],h,!1)}function qo(n){Hn[n.pointerId]=n}function Ds(n){Hn[n.pointerId]&&(Hn[n.pointerId]=n)}function _n(n){delete Hn[n.pointerId]}function Io(){Es||(document.addEventListener(co,qo,!0),document.addEventListener(uo,Ds,!0),document.addEventListener(ho,_n,!0),document.addEventListener(En,_n,!0),Es=!0)}function Vn(n,r){if(r.pointerType!==(r.MSPOINTER_TYPE_MOUSE||"mouse")){r.touches=[];for(var h in Hn)r.touches.push(Hn[h]);r.changedTouches=[r],n(r)}}function Ko(n,r){r.MSPOINTER_TYPE_TOUCH&&r.pointerType===r.MSPOINTER_TYPE_TOUCH&&Nt(r),Vn(n,r)}function Os(n){var r={},h,g;for(g in n)h=n[g],r[g]=h&&h.bind?h.bind(n):h;return n=r,r.type="dblclick",r.detail=2,r.isTrusted=!1,r._simulated=!0,r}var Rs=200;function Pi(n,r){n.addEventListener("dblclick",r);var h=0,g;function x(R){if(R.detail!==1){g=R.detail;return}if(!(R.pointerType==="mouse"||R.sourceCapabilities&&!R.sourceCapabilities.firesTouchEvents)){var te=Z(R);if(!(te.some(function(ke){return ke instanceof HTMLLabelElement&&ke.attributes.for})&&!te.some(function(ke){return ke instanceof HTMLInputElement||ke instanceof HTMLSelectElement}))){var pe=Date.now();pe-h<=Rs?(g++,g===2&&r(Os(R))):g=1,h=pe}}}return n.addEventListener("click",x),{dblclick:r,simDblclick:x}}function Yo(n,r){n.removeEventListener("dblclick",r.dblclick),n.removeEventListener("click",r.simDblclick)}var ai=kn(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),To=kn(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Bs=To==="webkitTransition"||To==="OTransition"?To+"End":"transitionend";function ri(n){return typeof n=="string"?document.getElementById(n):n}function Mo(n,r){var h=n.style[r]||n.currentStyle&&n.currentStyle[r];if((!h||h==="auto")&&document.defaultView){var g=document.defaultView.getComputedStyle(n,null);h=g?g[r]:null}return h==="auto"?null:h}function yt(n,r,h){var g=document.createElement(n);return g.className=r||"",h&&h.appendChild(g),g}function $t(n){var r=n.parentNode;r&&r.removeChild(n)}function Ns(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function Gn(n){var r=n.parentNode;r&&r.lastChild!==n&&r.appendChild(n)}function Ao(n){var r=n.parentNode;r&&r.firstChild!==n&&r.insertBefore(n,r.firstChild)}function Pt(n,r){if(n.classList!==void 0)return n.classList.contains(r);var h=Eo(n);return h.length>0&&new RegExp("(^|\\s)"+r+"(\\s|$)").test(h)}function ct(n,r){if(n.classList!==void 0)for(var h=T(r),g=0,x=h.length;g<x;g++)n.classList.add(h[g]);else if(!Pt(n,r)){var R=Eo(n);Fs(n,(R?R+" ":"")+r)}}function Mt(n,r){n.classList!==void 0?n.classList.remove(r):Fs(n,I((" "+Eo(n)+" ").replace(" "+r+" "," ")))}function Fs(n,r){n.className.baseVal===void 0?n.className=r:n.className.baseVal=r}function Eo(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function an(n,r){"opacity"in n.style?n.style.opacity=r:"filter"in n.style&&rn(n,r)}function rn(n,r){var h=!1,g="DXImageTransform.Microsoft.Alpha";try{h=n.filters.item(g)}catch{if(r===1)return}r=Math.round(r*100),h?(h.Enabled=r!==100,h.Opacity=r):n.style.filter+=" progid:"+g+"(opacity="+r+")"}function kn(n){for(var r=document.documentElement.style,h=0;h<n.length;h++)if(n[h]in r)return n[h];return!1}function At(n,r,h){var g=r||new ve(0,0);n.style[ai]=(qe.ie3d?"translate("+g.x+"px,"+g.y+"px)":"translate3d("+g.x+"px,"+g.y+"px,0)")+(h?" scale("+h+")":"")}function It(n,r){n._leaflet_pos=r,qe.any3d?At(n,r):(n.style.left=r.x+"px",n.style.top=r.y+"px")}function tn(n){return n._leaflet_pos||new ve(0,0)}var ln,Pn,Jo;if("onselectstart"in document)ln=function(){lt(window,"selectstart",Nt)},Pn=function(){bt(window,"selectstart",Nt)};else{var Po=kn(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);ln=function(){if(Po){var n=document.documentElement.style;Jo=n[Po],n[Po]="none"}},Pn=function(){Po&&(document.documentElement.style[Po]=Jo,Jo=void 0)}}function Us(){lt(window,"dragstart",Nt)}function Do(){bt(window,"dragstart",Nt)}var Oo,Xo;function Ro(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(Qo(),Oo=n,Xo=n.style.outlineStyle,n.style.outlineStyle="none",lt(window,"keydown",Qo))}function Qo(){Oo&&(Oo.style.outlineStyle=Xo,Oo=void 0,Xo=void 0,bt(window,"keydown",Qo))}function es(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function li(n){var r=n.getBoundingClientRect();return{x:r.width/n.offsetWidth||1,y:r.height/n.offsetHeight||1,boundingClientRect:r}}var ca={__proto__:null,TRANSFORM:ai,TRANSITION:To,TRANSITION_END:Bs,get:ri,getStyle:Mo,create:yt,remove:$t,empty:Ns,toFront:Gn,toBack:Ao,hasClass:Pt,addClass:ct,removeClass:Mt,setClass:Fs,getClass:Eo,setOpacity:an,testProp:kn,setTransform:At,setPosition:It,getPosition:tn,get disableTextSelection(){return ln},get enableTextSelection(){return Pn},disableImageDrag:Us,enableImageDrag:Do,preventOutline:Ro,restoreOutline:Qo,getSizedParentNode:es,getScale:li};function lt(n,r,h,g){if(r&&typeof r=="object")for(var x in r)ci(n,x,r[x],h);else{r=T(r);for(var R=0,te=r.length;R<te;R++)ci(n,r[R],h,g)}return this}var bn="_leaflet_events";function bt(n,r,h,g){if(arguments.length===1)zs(n),delete n[bn];else if(r&&typeof r=="object")for(var x in r)ui(n,x,r[x],h);else if(r=T(r),arguments.length===2)zs(n,function(pe){return C(r,pe)!==-1});else for(var R=0,te=r.length;R<te;R++)ui(n,r[R],h,g);return this}function zs(n,r){for(var h in n[bn]){var g=h.split(/\d/)[0];(!r||r(g))&&ui(n,g,null,null,h)}}var ts={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ci(n,r,h,g){var x=r+d(h)+(g?"_"+d(g):"");if(n[bn]&&n[bn][x])return this;var R=function(pe){return h.call(g||n,pe||window.event)},te=R;!qe.touchNative&&qe.pointer&&r.indexOf("touch")===0?R=yn(n,r,R):qe.touch&&r==="dblclick"?R=Pi(n,R):"addEventListener"in n?r==="touchstart"||r==="touchmove"||r==="wheel"||r==="mousewheel"?n.addEventListener(ts[r]||r,R,qe.passiveEvents?{passive:!1}:!1):r==="mouseenter"||r==="mouseleave"?(R=function(pe){pe=pe||window.event,He(n,pe)&&te(pe)},n.addEventListener(ts[r],R,!1)):n.addEventListener(r,te,!1):n.attachEvent("on"+r,R),n[bn]=n[bn]||{},n[bn][x]=R}function ui(n,r,h,g,x){x=x||r+d(h)+(g?"_"+d(g):"");var R=n[bn]&&n[bn][x];if(!R)return this;!qe.touchNative&&qe.pointer&&r.indexOf("touch")===0?Ps(n,r,R):qe.touch&&r==="dblclick"?Yo(n,R):"removeEventListener"in n?n.removeEventListener(ts[r]||r,R,!1):n.detachEvent("on"+r,R),n[bn][x]=null}function fo(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function di(n){return ci(n,"wheel",fo),this}function wn(n){return lt(n,"mousedown touchstart dblclick contextmenu",fo),n._leaflet_disable_click=!0,this}function Nt(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function po(n){return Nt(n),fo(n),this}function Z(n){if(n.composedPath)return n.composedPath();for(var r=[],h=n.target;h;)r.push(h),h=h.parentNode;return r}function H(n,r){if(!r)return new ve(n.clientX,n.clientY);var h=li(r),g=h.boundingClientRect;return new ve((n.clientX-g.left)/h.x-r.clientLeft,(n.clientY-g.top)/h.y-r.clientTop)}var Q=qe.linux&&qe.chrome?window.devicePixelRatio:qe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Le(n){return qe.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/Q:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function He(n,r){var h=r.relatedTarget;if(!h)return!0;try{for(;h&&h!==n;)h=h.parentNode}catch{return!1}return h!==n}var st={__proto__:null,on:lt,off:bt,stopPropagation:fo,disableScrollPropagation:di,disableClickPropagation:wn,preventDefault:Nt,stop:po,getPropagationPath:Z,getMousePosition:H,getWheelDelta:Le,isExternalTarget:He,addListener:lt,removeListener:bt},jt=he.extend({run:function(n,r,h,g){this.stop(),this._el=n,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(g||.5,.2),this._startPos=tn(n),this._offset=r.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=K(this._animate,this),this._step()},_step:function(n){var r=+new Date-this._startTime,h=this._duration*1e3;r<h?this._runFrame(this._easeOut(r/h),n):(this._runFrame(1),this._complete())},_runFrame:function(n,r){var h=this._startPos.add(this._offset.multiplyBy(n));r&&h._round(),It(this._el,h),this.fire("step")},_complete:function(){se(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),nt=he.extend({options:{crs:j,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,r){r=S(this,r),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=c(this._onResize,this),this._initEvents(),r.maxBounds&&this.setMaxBounds(r.maxBounds),r.zoom!==void 0&&(this._zoom=this._limitZoom(r.zoom)),r.center&&r.zoom!==void 0&&this.setView($e(r.center),r.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=To&&qe.any3d&&!qe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),lt(this._proxy,Bs,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,r,h){if(r=r===void 0?this._zoom:this._limitZoom(r),n=this._limitCenter($e(n),r,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=s({animate:h.animate},h.zoom),h.pan=s({animate:h.animate,duration:h.duration},h.pan));var g=this._zoom!==r?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,r,h.zoom):this._tryAnimatedPan(n,h.pan);if(g)return clearTimeout(this._sizeTimer),this}return this._resetView(n,r,h.pan&&h.pan.noMoveStart),this},setZoom:function(n,r){return this._loaded?this.setView(this.getCenter(),n,{zoom:r}):(this._zoom=n,this)},zoomIn:function(n,r){return n=n||(qe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,r)},zoomOut:function(n,r){return n=n||(qe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,r)},setZoomAround:function(n,r,h){var g=this.getZoomScale(r),x=this.getSize().divideBy(2),R=n instanceof ve?n:this.latLngToContainerPoint(n),te=R.subtract(x).multiplyBy(1-1/g),pe=this.containerPointToLatLng(x.add(te));return this.setView(pe,r,{zoom:h})},_getBoundsCenterZoom:function(n,r){r=r||{},n=n.getBounds?n.getBounds():Ee(n);var h=fe(r.paddingTopLeft||r.padding||[0,0]),g=fe(r.paddingBottomRight||r.padding||[0,0]),x=this.getBoundsZoom(n,!1,h.add(g));if(x=typeof r.maxZoom=="number"?Math.min(r.maxZoom,x):x,x===1/0)return{center:n.getCenter(),zoom:x};var R=g.subtract(h).divideBy(2),te=this.project(n.getSouthWest(),x),pe=this.project(n.getNorthEast(),x),ke=this.unproject(te.add(pe).divideBy(2).add(R),x);return{center:ke,zoom:x}},fitBounds:function(n,r){if(n=Ee(n),!n.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(n,r);return this.setView(h.center,h.zoom,r)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,r){return this.setView(n,this._zoom,{pan:r})},panBy:function(n,r){if(n=fe(n).round(),r=r||{},!n.x&&!n.y)return this.fire("moveend");if(r.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new jt,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),r.noMoveStart||this.fire("movestart"),r.animate!==!1){ct(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,h,r.duration||.25,r.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,r,h){if(h=h||{},h.animate===!1||!qe.any3d)return this.setView(n,r,h);this._stop();var g=this.project(this.getCenter()),x=this.project(n),R=this.getSize(),te=this._zoom;n=$e(n),r=r===void 0?te:r;var pe=Math.max(R.x,R.y),ke=pe*this.getZoomScale(te,r),De=x.distanceTo(g)||1,Ke=1.42,it=Ke*Ke;function mt(Zt){var $r=Zt?-1:1,bv=Zt?ke:pe,wv=ke*ke-pe*pe+$r*it*it*De*De,Cv=2*bv*it*De,Xl=wv/Cv,Ku=Math.sqrt(Xl*Xl+1)-Xl,Lv=Ku<1e-9?-18:Math.log(Ku);return Lv}function Sn(Zt){return(Math.exp(Zt)-Math.exp(-Zt))/2}function Jt(Zt){return(Math.exp(Zt)+Math.exp(-Zt))/2}function so(Zt){return Sn(Zt)/Jt(Zt)}var Rn=mt(0);function Hi(Zt){return pe*(Jt(Rn)/Jt(Rn+Ke*Zt))}function gv(Zt){return pe*(Jt(Rn)*so(Rn+Ke*Zt)-Sn(Rn))/it}function yv(Zt){return 1-Math.pow(1-Zt,1.5)}var _v=Date.now(),Wu=(mt(1)-Rn)/Ke,kv=h.duration?1e3*h.duration:1e3*Wu*.8;function qu(){var Zt=(Date.now()-_v)/kv,$r=yv(Zt)*Wu;Zt<=1?(this._flyToFrame=K(qu,this),this._move(this.unproject(g.add(x.subtract(g).multiplyBy(gv($r)/De)),te),this.getScaleZoom(pe/Hi($r),te),{flyTo:!0})):this._move(n,r)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),qu.call(this),this},flyToBounds:function(n,r){var h=this._getBoundsCenterZoom(n,r);return this.flyTo(h.center,h.zoom,r)},setMaxBounds:function(n){return n=Ee(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var r=this.options.minZoom;return this.options.minZoom=n,this._loaded&&r!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var r=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&r!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,r){this._enforcingBounds=!0;var h=this.getCenter(),g=this._limitCenter(h,this._zoom,Ee(n));return h.equals(g)||this.panTo(g,r),this._enforcingBounds=!1,this},panInside:function(n,r){r=r||{};var h=fe(r.paddingTopLeft||r.padding||[0,0]),g=fe(r.paddingBottomRight||r.padding||[0,0]),x=this.project(this.getCenter()),R=this.project(n),te=this.getPixelBounds(),pe=Be([te.min.add(h),te.max.subtract(g)]),ke=pe.getSize();if(!pe.contains(R)){this._enforcingBounds=!0;var De=R.subtract(pe.getCenter()),Ke=pe.extend(R).getSize().subtract(ke);x.x+=De.x<0?-Ke.x:Ke.x,x.y+=De.y<0?-Ke.y:Ke.y,this.panTo(this.unproject(x),r),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=s({animate:!1,pan:!0},n===!0?{animate:!0}:n);var r=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),g=r.divideBy(2).round(),x=h.divideBy(2).round(),R=g.subtract(x);return!R.x&&!R.y?this:(n.animate&&n.pan?this.panBy(R):(n.pan&&this._rawPanBy(R),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:r,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=s({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var r=c(this._handleGeolocationResponse,this),h=c(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(r,h,n):navigator.geolocation.getCurrentPosition(r,h,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var r=n.code,h=n.message||(r===1?"permission denied":r===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:r,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var r=n.coords.latitude,h=n.coords.longitude,g=new Me(r,h),x=g.toBounds(n.coords.accuracy*2),R=this._locateOptions;if(R.setView){var te=this.getBoundsZoom(x);this.setView(g,R.maxZoom?Math.min(te,R.maxZoom):te)}var pe={latlng:g,bounds:x,timestamp:n.timestamp};for(var ke in n.coords)typeof n.coords[ke]=="number"&&(pe[ke]=n.coords[ke]);this.fire("locationfound",pe)}},addHandler:function(n,r){if(!r)return this;var h=this[n]=new r(this);return this._handlers.push(h),this.options[n]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),$t(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(se(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)$t(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,r){var h="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),g=yt("div",h,r||this._mapPane);return n&&(this._panes[n]=g),g},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),r=this.unproject(n.getBottomLeft()),h=this.unproject(n.getTopRight());return new re(r,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,r,h){n=Ee(n),h=fe(h||[0,0]);var g=this.getZoom()||0,x=this.getMinZoom(),R=this.getMaxZoom(),te=n.getNorthWest(),pe=n.getSouthEast(),ke=this.getSize().subtract(h),De=Be(this.project(pe,g),this.project(te,g)).getSize(),Ke=qe.any3d?this.options.zoomSnap:1,it=ke.x/De.x,mt=ke.y/De.y,Sn=r?Math.max(it,mt):Math.min(it,mt);return g=this.getScaleZoom(Sn,g),Ke&&(g=Math.round(g/(Ke/100))*(Ke/100),g=r?Math.ceil(g/Ke)*Ke:Math.floor(g/Ke)*Ke),Math.max(x,Math.min(R,g))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ve(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,r){var h=this._getTopLeftPoint(n,r);return new xe(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,r){var h=this.options.crs;return r=r===void 0?this._zoom:r,h.scale(n)/h.scale(r)},getScaleZoom:function(n,r){var h=this.options.crs;r=r===void 0?this._zoom:r;var g=h.zoom(n*h.scale(r));return isNaN(g)?1/0:g},project:function(n,r){return r=r===void 0?this._zoom:r,this.options.crs.latLngToPoint($e(n),r)},unproject:function(n,r){return r=r===void 0?this._zoom:r,this.options.crs.pointToLatLng(fe(n),r)},layerPointToLatLng:function(n){var r=fe(n).add(this.getPixelOrigin());return this.unproject(r)},latLngToLayerPoint:function(n){var r=this.project($e(n))._round();return r._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng($e(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(Ee(n))},distance:function(n,r){return this.options.crs.distance($e(n),$e(r))},containerPointToLayerPoint:function(n){return fe(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return fe(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var r=this.containerPointToLayerPoint(fe(n));return this.layerPointToLatLng(r)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint($e(n)))},mouseEventToContainerPoint:function(n){return H(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var r=this._container=ri(n);if(r){if(r._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");lt(r,"scroll",this._onScroll,this),this._containerId=d(r)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&qe.any3d,ct(n,"leaflet-container"+(qe.touch?" leaflet-touch":"")+(qe.retina?" leaflet-retina":"")+(qe.ielt9?" leaflet-oldie":"")+(qe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var r=Mo(n,"position");r!=="absolute"&&r!=="relative"&&r!=="fixed"&&r!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),It(this._mapPane,new ve(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ct(n.markerPane,"leaflet-zoom-hide"),ct(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,r,h){It(this._mapPane,new ve(0,0));var g=!this._loaded;this._loaded=!0,r=this._limitZoom(r),this.fire("viewprereset");var x=this._zoom!==r;this._moveStart(x,h)._move(n,r)._moveEnd(x),this.fire("viewreset"),g&&this.fire("load")},_moveStart:function(n,r){return n&&this.fire("zoomstart"),r||this.fire("movestart"),this},_move:function(n,r,h,g){r===void 0&&(r=this._zoom);var x=this._zoom!==r;return this._zoom=r,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),g?h&&h.pinch&&this.fire("zoom",h):((x||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return se(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){It(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[d(this._container)]=this;var r=n?bt:lt;r(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&r(window,"resize",this._onResize,this),qe.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){se(this._resizeRequest),this._resizeRequest=K(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,r){for(var h=[],g,x=r==="mouseout"||r==="mouseover",R=n.target||n.srcElement,te=!1;R;){if(g=this._targets[d(R)],g&&(r==="click"||r==="preclick")&&this._draggableMoved(g)){te=!0;break}if(g&&g.listens(r,!0)&&(x&&!He(R,n)||(h.push(g),x))||R===this._container)break;R=R.parentNode}return!h.length&&!te&&!x&&this.listens(r,!0)&&(h=[this]),h},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var r=n.target||n.srcElement;if(!(!this._loaded||r._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(r))){var h=n.type;h==="mousedown"&&Ro(r),this._fireDOMEvent(n,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,r,h){if(n.type==="click"){var g=s({},n);g.type="preclick",this._fireDOMEvent(g,g.type,h)}var x=this._findEventTargets(n,r);if(h){for(var R=[],te=0;te<h.length;te++)h[te].listens(r,!0)&&R.push(h[te]);x=R.concat(x)}if(x.length){r==="contextmenu"&&Nt(n);var pe=x[0],ke={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var De=pe.getLatLng&&(!pe._radius||pe._radius<=10);ke.containerPoint=De?this.latLngToContainerPoint(pe.getLatLng()):this.mouseEventToContainerPoint(n),ke.layerPoint=this.containerPointToLayerPoint(ke.containerPoint),ke.latlng=De?pe.getLatLng():this.layerPointToLatLng(ke.layerPoint)}for(te=0;te<x.length;te++)if(x[te].fire(r,ke,!0),ke.originalEvent._stopped||x[te].options.bubblingMouseEvents===!1&&C(this._mouseEvents,r)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,r=this._handlers.length;n<r;n++)this._handlers[n].disable()},whenReady:function(n,r){return this._loaded?n.call(r||this,{target:this}):this.on("load",n,r),this},_getMapPanePos:function(){return tn(this._mapPane)||new ve(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,r){var h=n&&r!==void 0?this._getNewPixelOrigin(n,r):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,r){var h=this.getSize()._divideBy(2);return this.project(n,r)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,r,h){var g=this._getNewPixelOrigin(h,r);return this.project(n,r)._subtract(g)},_latLngBoundsToNewLayerBounds:function(n,r,h){var g=this._getNewPixelOrigin(h,r);return Be([this.project(n.getSouthWest(),r)._subtract(g),this.project(n.getNorthWest(),r)._subtract(g),this.project(n.getSouthEast(),r)._subtract(g),this.project(n.getNorthEast(),r)._subtract(g)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,r,h){if(!h)return n;var g=this.project(n,r),x=this.getSize().divideBy(2),R=new xe(g.subtract(x),g.add(x)),te=this._getBoundsOffset(R,h,r);return Math.abs(te.x)<=1&&Math.abs(te.y)<=1?n:this.unproject(g.add(te),r)},_limitOffset:function(n,r){if(!r)return n;var h=this.getPixelBounds(),g=new xe(h.min.add(n),h.max.add(n));return n.add(this._getBoundsOffset(g,r))},_getBoundsOffset:function(n,r,h){var g=Be(this.project(r.getNorthEast(),h),this.project(r.getSouthWest(),h)),x=g.min.subtract(n.min),R=g.max.subtract(n.max),te=this._rebound(x.x,-R.x),pe=this._rebound(x.y,-R.y);return new ve(te,pe)},_rebound:function(n,r){return n+r>0?Math.round(n-r)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(r))},_limitZoom:function(n){var r=this.getMinZoom(),h=this.getMaxZoom(),g=qe.any3d?this.options.zoomSnap:1;return g&&(n=Math.round(n/g)*g),Math.max(r,Math.min(h,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Mt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,r){var h=this._getCenterOffset(n)._trunc();return(r&&r.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,r),!0)},_createAnimProxy:function(){var n=this._proxy=yt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(r){var h=ai,g=this._proxy.style[h];At(this._proxy,this.project(r.center,r.zoom),this.getZoomScale(r.zoom,1)),g===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){$t(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),r=this.getZoom();At(this._proxy,this.project(n,r),this.getZoomScale(r,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,r,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(r-this._zoom)>this.options.zoomAnimationThreshold)return!1;var g=this.getZoomScale(r),x=this._getCenterOffset(n)._divideBy(1-1/g);return h.animate!==!0&&!this.getSize().contains(x)?!1:(K(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(n,r,!0)},this),!0)},_animateZoom:function(n,r,h,g){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=r,ct(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:r,noUpdate:g}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(c(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Mt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Dn(n,r){return new nt(n,r)}var Cn=Re.extend({options:{position:"topright"},initialize:function(n){S(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var r=this._map;return r&&r.removeControl(this),this.options.position=n,r&&r.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var r=this._container=this.onAdd(n),h=this.getPosition(),g=n._controlCorners[h];return ct(r,"leaflet-control"),h.indexOf("bottom")!==-1?g.insertBefore(r,g.firstChild):g.appendChild(r),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?($t(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),ns=function(n){return new Cn(n)};nt.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},r="leaflet-",h=this._controlContainer=yt("div",r+"control-container",this._container);function g(x,R){var te=r+x+" "+r+R;n[x+R]=yt("div",te,h)}g("top","left"),g("top","right"),g("bottom","left"),g("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)$t(this._controlCorners[n]);$t(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var lr=Cn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,r,h,g){return h<g?-1:g<h?1:0}},initialize:function(n,r,h){S(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var g in n)this._addLayer(n[g],g);for(g in r)this._addLayer(r[g],g,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return Cn.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,r){return this._addLayer(n,r),this._map?this._update():this},addOverlay:function(n,r){return this._addLayer(n,r,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var r=this._getLayer(d(n));return r&&this._layers.splice(this._layers.indexOf(r),1),this._map?this._update():this},expand:function(){ct(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(ct(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):Mt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Mt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",r=this._container=yt("div",n),h=this.options.collapsed;r.setAttribute("aria-haspopup",!0),wn(r),di(r);var g=this._section=yt("section",n+"-list");h&&(this._map.on("click",this.collapse,this),lt(r,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var x=this._layersLink=yt("a",n+"-toggle",r);x.href="#",x.title="Layers",x.setAttribute("role","button"),lt(x,{keydown:function(R){R.keyCode===13&&this._expandSafely()},click:function(R){Nt(R),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=yt("div",n+"-base",g),this._separator=yt("div",n+"-separator",g),this._overlaysList=yt("div",n+"-overlays",g),r.appendChild(g)},_getLayer:function(n){for(var r=0;r<this._layers.length;r++)if(this._layers[r]&&d(this._layers[r].layer)===n)return this._layers[r]},_addLayer:function(n,r,h){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:r,overlay:h}),this.options.sortLayers&&this._layers.sort(c(function(g,x){return this.options.sortFunction(g.layer,x.layer,g.name,x.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Ns(this._baseLayersList),Ns(this._overlaysList),this._layerControlInputs=[];var n,r,h,g,x=0;for(h=0;h<this._layers.length;h++)g=this._layers[h],this._addItem(g),r=r||g.overlay,n=n||!g.overlay,x+=g.overlay?0:1;return this.options.hideSingleBase&&(n=n&&x>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=r&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var r=this._getLayer(d(n.target)),h=r.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;h&&this._map.fire(h,r)},_createRadioElement:function(n,r){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(r?' checked="checked"':"")+"/>",g=document.createElement("div");return g.innerHTML=h,g.firstChild},_addItem:function(n){var r=document.createElement("label"),h=this._map.hasLayer(n.layer),g;n.overlay?(g=document.createElement("input"),g.type="checkbox",g.className="leaflet-control-layers-selector",g.defaultChecked=h):g=this._createRadioElement("leaflet-base-layers_"+d(this),h),this._layerControlInputs.push(g),g.layerId=d(n.layer),lt(g,"click",this._onInputClick,this);var x=document.createElement("span");x.innerHTML=" "+n.name;var R=document.createElement("span");r.appendChild(R),R.appendChild(g),R.appendChild(x);var te=n.overlay?this._overlaysList:this._baseLayersList;return te.appendChild(r),this._checkDisabledLayers(),r},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,r,h,g=[],x=[];this._handlingClick=!0;for(var R=n.length-1;R>=0;R--)r=n[R],h=this._getLayer(r.layerId).layer,r.checked?g.push(h):r.checked||x.push(h);for(R=0;R<x.length;R++)this._map.hasLayer(x[R])&&this._map.removeLayer(x[R]);for(R=0;R<g.length;R++)this._map.hasLayer(g[R])||this._map.addLayer(g[R]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,r,h,g=this._map.getZoom(),x=n.length-1;x>=0;x--)r=n[x],h=this._getLayer(r.layerId).layer,r.disabled=h.options.minZoom!==void 0&&g<h.options.minZoom||h.options.maxZoom!==void 0&&g>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,lt(n,"click",Nt),this.expand();var r=this;setTimeout(function(){bt(n,"click",Nt),r._preventClick=!1})}}),cr=function(n,r,h){return new lr(n,r,h)},ua=Cn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var r="leaflet-control-zoom",h=yt("div",r+" leaflet-bar"),g=this.options;return this._zoomInButton=this._createButton(g.zoomInText,g.zoomInTitle,r+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(g.zoomOutText,g.zoomOutTitle,r+"-out",h,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,r,h,g,x){var R=yt("a",h,g);return R.innerHTML=n,R.href="#",R.title=r,R.setAttribute("role","button"),R.setAttribute("aria-label",r),wn(R),lt(R,"click",po),lt(R,"click",x,this),lt(R,"click",this._refocusOnMap,this),R},_updateDisabled:function(){var n=this._map,r="leaflet-disabled";Mt(this._zoomInButton,r),Mt(this._zoomOutButton,r),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(ct(this._zoomOutButton,r),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(ct(this._zoomInButton,r),this._zoomInButton.setAttribute("aria-disabled","true"))}});nt.mergeOptions({zoomControl:!0}),nt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new ua,this.addControl(this.zoomControl))});var Dl=function(n){return new ua(n)},Di=Cn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var r="leaflet-control-scale",h=yt("div",r),g=this.options;return this._addScales(g,r+"-line",h),n.on(g.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),h},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,r,h){n.metric&&(this._mScale=yt("div",r,h)),n.imperial&&(this._iScale=yt("div",r,h))},_update:function(){var n=this._map,r=n.getSize().y/2,h=n.distance(n.containerPointToLatLng([0,r]),n.containerPointToLatLng([this.options.maxWidth,r]));this._updateScales(h)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var r=this._getRoundNum(n),h=r<1e3?r+" m":r/1e3+" km";this._updateScale(this._mScale,h,r/n)},_updateImperial:function(n){var r=n*3.2808399,h,g,x;r>5280?(h=r/5280,g=this._getRoundNum(h),this._updateScale(this._iScale,g+" mi",g/h)):(x=this._getRoundNum(r),this._updateScale(this._iScale,x+" ft",x/r))},_updateScale:function(n,r,h){n.style.width=Math.round(this.options.maxWidth*h)+"px",n.innerHTML=r},_getRoundNum:function(n){var r=Math.pow(10,(Math.floor(n)+"").length-1),h=n/r;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,r*h}}),Ol=function(n){return new Di(n)},Rl='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Oi=Cn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(qe.inlineSvg?Rl+" ":"")+"Leaflet</a>"},initialize:function(n){S(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=yt("div","leaflet-control-attribution"),wn(this._container);for(var r in n._layers)n._layers[r].getAttribution&&this.addAttribution(n._layers[r].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var r in this._attributions)this._attributions[r]&&n.push(r);var h=[];this.options.prefix&&h.push(this.options.prefix),n.length&&h.push(n.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});nt.mergeOptions({attributionControl:!0}),nt.addInitHook(function(){this.options.attributionControl&&new Oi().addTo(this)});var Bl=function(n){return new Oi(n)};Cn.Layers=lr,Cn.Zoom=ua,Cn.Scale=Di,Cn.Attribution=Oi,ns.layers=cr,ns.zoom=Dl,ns.scale=Ol,ns.attribution=Bl;var Zn=Re.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Zn.addTo=function(n,r){return n.addHandler(r,this),this};var Nl={Events:de},da=qe.touch?"touchstart mousedown":"mousedown",Bo=he.extend({options:{clickTolerance:3},initialize:function(n,r,h,g){S(this,g),this._element=n,this._dragStartTarget=r||n,this._preventOutline=h},enable:function(){this._enabled||(lt(this._dragStartTarget,da,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Bo._dragging===this&&this.finishDrag(!0),bt(this._dragStartTarget,da,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!Pt(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){Bo._dragging===this&&this.finishDrag();return}if(!(Bo._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(Bo._dragging=this,this._preventOutline&&Ro(this._element),Us(),ln(),!this._moving)){this.fire("down");var r=n.touches?n.touches[0]:n,h=es(this._element);this._startPoint=new ve(r.clientX,r.clientY),this._startPos=tn(this._element),this._parentScale=li(h);var g=n.type==="mousedown";lt(document,g?"mousemove":"touchmove",this._onMove,this),lt(document,g?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var r=n.touches&&n.touches.length===1?n.touches[0]:n,h=new ve(r.clientX,r.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,Nt(n),this._moved||(this.fire("dragstart"),this._moved=!0,ct(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ct(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),It(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){Mt(document.body,"leaflet-dragging"),this._lastTarget&&(Mt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),bt(document,"mousemove touchmove",this._onMove,this),bt(document,"mouseup touchend touchcancel",this._onUp,this),Do(),Pn();var r=this._moved&&this._moving;this._moving=!1,Bo._dragging=!1,r&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function ur(n,r,h){var g,x=[1,4,2,8],R,te,pe,ke,De,Ke,it,mt;for(R=0,Ke=n.length;R<Ke;R++)n[R]._code=ss(n[R],r);for(pe=0;pe<4;pe++){for(it=x[pe],g=[],R=0,Ke=n.length,te=Ke-1;R<Ke;te=R++)ke=n[R],De=n[te],ke._code&it?De._code&it||(mt=os(De,ke,it,r,h),mt._code=ss(mt,r),g.push(mt)):(De._code&it&&(mt=os(De,ke,it,r,h),mt._code=ss(mt,r),g.push(mt)),g.push(ke));n=g}return n}function dr(n,r){var h,g,x,R,te,pe,ke,De,Ke;if(!n||n.length===0)throw new Error("latlngs not passed");On(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var it=$e([0,0]),mt=Ee(n),Sn=mt.getNorthWest().distanceTo(mt.getSouthWest())*mt.getNorthEast().distanceTo(mt.getNorthWest());Sn<1700&&(it=ha(n));var Jt=n.length,so=[];for(h=0;h<Jt;h++){var Rn=$e(n[h]);so.push(r.project($e([Rn.lat-it.lat,Rn.lng-it.lng])))}for(pe=ke=De=0,h=0,g=Jt-1;h<Jt;g=h++)x=so[h],R=so[g],te=x.y*R.x-R.y*x.x,ke+=(x.x+R.x)*te,De+=(x.y+R.y)*te,pe+=te*3;pe===0?Ke=so[0]:Ke=[ke/pe,De/pe];var Hi=r.unproject(fe(Ke));return $e([Hi.lat+it.lat,Hi.lng+it.lng])}function ha(n){for(var r=0,h=0,g=0,x=0;x<n.length;x++){var R=$e(n[x]);r+=R.lat,h+=R.lng,g++}return $e([r/g,h/g])}var Fl={__proto__:null,clipPolygon:ur,polygonCenter:dr,centroid:ha};function hr(n,r){if(!r||!n.length)return n.slice();var h=r*r;return n=Hl(n,h),n=zl(n,h),n}function fr(n,r,h){return Math.sqrt(is(n,r,h,!0))}function Ul(n,r,h){return is(n,r,h)}function zl(n,r){var h=n.length,g=typeof Uint8Array<"u"?Uint8Array:Array,x=new g(h);x[0]=x[h-1]=1,fa(n,x,r,0,h-1);var R,te=[];for(R=0;R<h;R++)x[R]&&te.push(n[R]);return te}function fa(n,r,h,g,x){var R=0,te,pe,ke;for(pe=g+1;pe<=x-1;pe++)ke=is(n[pe],n[g],n[x],!0),ke>R&&(te=pe,R=ke);R>h&&(r[te]=1,fa(n,r,h,g,te),fa(n,r,h,te,x))}function Hl(n,r){for(var h=[n[0]],g=1,x=0,R=n.length;g<R;g++)vr(n[g],n[x])>r&&(h.push(n[g]),x=g);return x<R-1&&h.push(n[R-1]),h}var hi;function pr(n,r,h,g,x){var R=g?hi:ss(n,h),te=ss(r,h),pe,ke,De;for(hi=te;;){if(!(R|te))return[n,r];if(R&te)return!1;pe=R||te,ke=os(n,r,pe,h,x),De=ss(ke,h),pe===R?(n=ke,R=De):(r=ke,te=De)}}function os(n,r,h,g,x){var R=r.x-n.x,te=r.y-n.y,pe=g.min,ke=g.max,De,Ke;return h&8?(De=n.x+R*(ke.y-n.y)/te,Ke=ke.y):h&4?(De=n.x+R*(pe.y-n.y)/te,Ke=pe.y):h&2?(De=ke.x,Ke=n.y+te*(ke.x-n.x)/R):h&1&&(De=pe.x,Ke=n.y+te*(pe.x-n.x)/R),new ve(De,Ke,x)}function ss(n,r){var h=0;return n.x<r.min.x?h|=1:n.x>r.max.x&&(h|=2),n.y<r.min.y?h|=4:n.y>r.max.y&&(h|=8),h}function vr(n,r){var h=r.x-n.x,g=r.y-n.y;return h*h+g*g}function is(n,r,h,g){var x=r.x,R=r.y,te=h.x-x,pe=h.y-R,ke=te*te+pe*pe,De;return ke>0&&(De=((n.x-x)*te+(n.y-R)*pe)/ke,De>1?(x=h.x,R=h.y):De>0&&(x+=te*De,R+=pe*De)),te=n.x-x,pe=n.y-R,g?te*te+pe*pe:new ve(x,R)}function On(n){return!$(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function Ri(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),On(n)}function mr(n,r){var h,g,x,R,te,pe,ke,De;if(!n||n.length===0)throw new Error("latlngs not passed");On(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var Ke=$e([0,0]),it=Ee(n),mt=it.getNorthWest().distanceTo(it.getSouthWest())*it.getNorthEast().distanceTo(it.getNorthWest());mt<1700&&(Ke=ha(n));var Sn=n.length,Jt=[];for(h=0;h<Sn;h++){var so=$e(n[h]);Jt.push(r.project($e([so.lat-Ke.lat,so.lng-Ke.lng])))}for(h=0,g=0;h<Sn-1;h++)g+=Jt[h].distanceTo(Jt[h+1])/2;if(g===0)De=Jt[0];else for(h=0,R=0;h<Sn-1;h++)if(te=Jt[h],pe=Jt[h+1],x=te.distanceTo(pe),R+=x,R>g){ke=(R-g)/x,De=[pe.x-ke*(pe.x-te.x),pe.y-ke*(pe.y-te.y)];break}var Rn=r.unproject(fe(De));return $e([Rn.lat+Ke.lat,Rn.lng+Ke.lng])}var Vl={__proto__:null,simplify:hr,pointToSegmentDistance:fr,closestPointOnSegment:Ul,clipSegment:pr,_getEdgeIntersection:os,_getBitCode:ss,_sqClosestPointOnSegment:is,isFlat:On,_flat:Ri,polylineCenter:mr},pa={project:function(n){return new ve(n.lng,n.lat)},unproject:function(n){return new Me(n.y,n.x)},bounds:new xe([-180,-90],[180,90])},va={R:6378137,R_MINOR:6356752314245179e-9,bounds:new xe([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var r=Math.PI/180,h=this.R,g=n.lat*r,x=this.R_MINOR/h,R=Math.sqrt(1-x*x),te=R*Math.sin(g),pe=Math.tan(Math.PI/4-g/2)/Math.pow((1-te)/(1+te),R/2);return g=-h*Math.log(Math.max(pe,1e-10)),new ve(n.lng*r*h,g)},unproject:function(n){for(var r=180/Math.PI,h=this.R,g=this.R_MINOR/h,x=Math.sqrt(1-g*g),R=Math.exp(-n.y/h),te=Math.PI/2-2*Math.atan(R),pe=0,ke=.1,De;pe<15&&Math.abs(ke)>1e-7;pe++)De=x*Math.sin(te),De=Math.pow((1-De)/(1+De),x/2),ke=Math.PI/2-2*Math.atan(R*De)-te,te+=ke;return new Me(te*r,n.x*r/h)}},Gl={__proto__:null,LonLat:pa,Mercator:va,SphericalMercator:ee},Zl=s({},ye,{code:"EPSG:3395",projection:va,transformation:(function(){var n=.5/(Math.PI*va.R);return B(n,.5,-n,.5)})()}),gr=s({},ye,{code:"EPSG:4326",projection:pa,transformation:B(1/180,1,-1/180,.5)}),jl=s({},ue,{projection:pa,transformation:B(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,r){var h=r.lng-n.lng,g=r.lat-n.lat;return Math.sqrt(h*h+g*g)},infinite:!0});ue.Earth=ye,ue.EPSG3395=Zl,ue.EPSG3857=j,ue.EPSG900913=X,ue.EPSG4326=gr,ue.Simple=jl;var jn=he.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[d(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[d(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var r=n.target;if(r.hasLayer(this)){if(this._map=r,this._zoomAnimated=r._zoomAnimated,this.getEvents){var h=this.getEvents();r.on(h,this),this.once("remove",function(){r.off(h,this)},this)}this.onAdd(r),this.fire("add"),r.fire("layeradd",{layer:this})}}});nt.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var r=d(n);return this._layers[r]?this:(this._layers[r]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var r=d(n);return this._layers[r]?(this._loaded&&n.onRemove(this),delete this._layers[r],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return d(n)in this._layers},eachLayer:function(n,r){for(var h in this._layers)n.call(r,this._layers[h]);return this},_addLayers:function(n){n=n?$(n)?n:[n]:[];for(var r=0,h=n.length;r<h;r++)this.addLayer(n[r])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[d(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var r=d(n);this._zoomBoundLayers[r]&&(delete this._zoomBoundLayers[r],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,r=-1/0,h=this._getZoomSpan();for(var g in this._zoomBoundLayers){var x=this._zoomBoundLayers[g].options;n=x.minZoom===void 0?n:Math.min(n,x.minZoom),r=x.maxZoom===void 0?r:Math.max(r,x.maxZoom)}this._layersMaxZoom=r===-1/0?void 0:r,this._layersMinZoom=n===1/0?void 0:n,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var as=jn.extend({initialize:function(n,r){S(this,r),this._layers={};var h,g;if(n)for(h=0,g=n.length;h<g;h++)this.addLayer(n[h])},addLayer:function(n){var r=this.getLayerId(n);return this._layers[r]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var r=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[r]&&this._map.removeLayer(this._layers[r]),delete this._layers[r],this},hasLayer:function(n){var r=typeof n=="number"?n:this.getLayerId(n);return r in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var r=Array.prototype.slice.call(arguments,1),h,g;for(h in this._layers)g=this._layers[h],g[n]&&g[n].apply(g,r);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,r){for(var h in this._layers)n.call(r,this._layers[h]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return d(n)}}),Wl=function(n,r){return new as(n,r)},no=as.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),as.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),as.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new re;for(var r in this._layers){var h=this._layers[r];n.extend(h.getBounds?h.getBounds():h.getLatLng())}return n}}),ql=function(n,r){return new no(n,r)},Hs=Re.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){S(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,r){var h=this._getIconUrl(n);if(!h){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var g=this._createImg(h,r&&r.tagName==="IMG"?r:null);return this._setIconStyles(g,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(g.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),g},_setIconStyles:function(n,r){var h=this.options,g=h[r+"Size"];typeof g=="number"&&(g=[g,g]);var x=fe(g),R=fe(r==="shadow"&&h.shadowAnchor||h.iconAnchor||x&&x.divideBy(2,!0));n.className="leaflet-marker-"+r+" "+(h.className||""),R&&(n.style.marginLeft=-R.x+"px",n.style.marginTop=-R.y+"px"),x&&(n.style.width=x.x+"px",n.style.height=x.y+"px")},_createImg:function(n,r){return r=r||document.createElement("img"),r.src=n,r},_getIconUrl:function(n){return qe.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function Kl(n){return new Hs(n)}var rs=Hs.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof rs.imagePath!="string"&&(rs.imagePath=this._detectIconPath()),(this.options.imagePath||rs.imagePath)+Hs.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var r=function(h,g,x){var R=g.exec(h);return R&&R[x]};return n=r(n,/^url\((['"])?(.+)\1\)$/,2),n&&r(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=yt("div","leaflet-default-icon-path",document.body),r=Mo(n,"background-image")||Mo(n,"backgroundImage");if(document.body.removeChild(n),r=this._stripUrl(r),r)return r;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),yr=Zn.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new Bo(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ct(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Mt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var r=this._marker,h=r._map,g=this._marker.options.autoPanSpeed,x=this._marker.options.autoPanPadding,R=tn(r._icon),te=h.getPixelBounds(),pe=h.getPixelOrigin(),ke=Be(te.min._subtract(pe).add(x),te.max._subtract(pe).subtract(x));if(!ke.contains(R)){var De=fe((Math.max(ke.max.x,R.x)-ke.max.x)/(te.max.x-ke.max.x)-(Math.min(ke.min.x,R.x)-ke.min.x)/(te.min.x-ke.min.x),(Math.max(ke.max.y,R.y)-ke.max.y)/(te.max.y-ke.max.y)-(Math.min(ke.min.y,R.y)-ke.min.y)/(te.min.y-ke.min.y)).multiplyBy(g);h.panBy(De,{animate:!1}),this._draggable._newPos._add(De),this._draggable._startPos._add(De),It(r._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=K(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(se(this._panRequest),this._panRequest=K(this._adjustPan.bind(this,n)))},_onDrag:function(n){var r=this._marker,h=r._shadow,g=tn(r._icon),x=r._map.layerPointToLatLng(g);h&&It(h,g),r._latlng=x,n.latlng=x,n.oldLatLng=this._oldLatLng,r.fire("move",n).fire("drag",n)},_onDragEnd:function(n){se(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),Bi=jn.extend({options:{icon:new rs,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,r){S(this,r),this._latlng=$e(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var r=this._latlng;return this._latlng=$e(n),this.update(),this.fire("move",{oldLatLng:r,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,r="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=n.icon.createIcon(this._icon),g=!1;h!==this._icon&&(this._icon&&this._removeIcon(),g=!0,n.title&&(h.title=n.title),h.tagName==="IMG"&&(h.alt=n.alt||"")),ct(h,r),n.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&lt(h,"focus",this._panOnFocus,this);var x=n.icon.createShadow(this._shadow),R=!1;x!==this._shadow&&(this._removeShadow(),R=!0),x&&(ct(x,r),x.alt=""),this._shadow=x,n.opacity<1&&this._updateOpacity(),g&&this.getPane().appendChild(this._icon),this._initInteraction(),x&&R&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&bt(this._icon,"focus",this._panOnFocus,this),$t(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&$t(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&It(this._icon,n),this._shadow&&It(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var r=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(r)},_initInteraction:function(){if(this.options.interactive&&(ct(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),yr)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new yr(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&an(this._icon,n),this._shadow&&an(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var r=this.options.icon.options,h=r.iconSize?fe(r.iconSize):fe(0,0),g=r.iconAnchor?fe(r.iconAnchor):fe(0,0);n.panInside(this._latlng,{paddingTopLeft:g,paddingBottomRight:h.subtract(g)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function _r(n,r){return new Bi(n,r)}var No=jn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return S(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ni=No.extend({options:{fill:!0,radius:10},initialize:function(n,r){S(this,r),this._latlng=$e(n),this._radius=this.options.radius},setLatLng:function(n){var r=this._latlng;return this._latlng=$e(n),this.redraw(),this.fire("move",{oldLatLng:r,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var r=n&&n.radius||this._radius;return No.prototype.setStyle.call(this,n),this.setRadius(r),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,r=this._radiusY||n,h=this._clickTolerance(),g=[n+h,r+h];this._pxBounds=new xe(this._point.subtract(g),this._point.add(g))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function fi(n,r){return new Ni(n,r)}var Fi=Ni.extend({initialize:function(n,r,h){if(typeof r=="number"&&(r=s({},h,{radius:r})),S(this,r),this._latlng=$e(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new re(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:No.prototype.setStyle,_project:function(){var n=this._latlng.lng,r=this._latlng.lat,h=this._map,g=h.options.crs;if(g.distance===ye.distance){var x=Math.PI/180,R=this._mRadius/ye.R/x,te=h.project([r+R,n]),pe=h.project([r-R,n]),ke=te.add(pe).divideBy(2),De=h.unproject(ke).lat,Ke=Math.acos((Math.cos(R*x)-Math.sin(r*x)*Math.sin(De*x))/(Math.cos(r*x)*Math.cos(De*x)))/x;(isNaN(Ke)||Ke===0)&&(Ke=R/Math.cos(Math.PI/180*r)),this._point=ke.subtract(h.getPixelOrigin()),this._radius=isNaN(Ke)?0:ke.x-h.project([De,n-Ke]).x,this._radiusY=ke.y-te.y}else{var it=g.unproject(g.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(it).x}this._updateBounds()}});function kr(n,r,h){return new Fi(n,r,h)}var oo=No.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,r){S(this,r),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var r=1/0,h=null,g=is,x,R,te=0,pe=this._parts.length;te<pe;te++)for(var ke=this._parts[te],De=1,Ke=ke.length;De<Ke;De++){x=ke[De-1],R=ke[De];var it=g(n,x,R,!0);it<r&&(r=it,h=g(n,x,R))}return h&&(h.distance=Math.sqrt(r)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return mr(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,r){return r=r||this._defaultShape(),n=$e(n),r.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new re,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return On(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var r=[],h=On(n),g=0,x=n.length;g<x;g++)h?(r[g]=$e(n[g]),this._bounds.extend(r[g])):r[g]=this._convertLatLngs(n[g]);return r},_project:function(){var n=new xe;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),r=new ve(n,n);this._rawPxBounds&&(this._pxBounds=new xe([this._rawPxBounds.min.subtract(r),this._rawPxBounds.max.add(r)]))},_projectLatlngs:function(n,r,h){var g=n[0]instanceof Me,x=n.length,R,te;if(g){for(te=[],R=0;R<x;R++)te[R]=this._map.latLngToLayerPoint(n[R]),h.extend(te[R]);r.push(te)}else for(R=0;R<x;R++)this._projectLatlngs(n[R],r,h)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var r=this._parts,h,g,x,R,te,pe,ke;for(h=0,x=0,R=this._rings.length;h<R;h++)for(ke=this._rings[h],g=0,te=ke.length;g<te-1;g++)pe=pr(ke[g],ke[g+1],n,g,!0),pe&&(r[x]=r[x]||[],r[x].push(pe[0]),(pe[1]!==ke[g+1]||g===te-2)&&(r[x].push(pe[1]),x++))}},_simplifyPoints:function(){for(var n=this._parts,r=this.options.smoothFactor,h=0,g=n.length;h<g;h++)n[h]=hr(n[h],r)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,r){var h,g,x,R,te,pe,ke=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(h=0,R=this._parts.length;h<R;h++)for(pe=this._parts[h],g=0,te=pe.length,x=te-1;g<te;x=g++)if(!(!r&&g===0)&&fr(n,pe[x],pe[g])<=ke)return!0;return!1}});function U(n,r){return new oo(n,r)}oo._flat=Ri;var le=oo.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return dr(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var r=oo.prototype._convertLatLngs.call(this,n),h=r.length;return h>=2&&r[0]instanceof Me&&r[0].equals(r[h-1])&&r.pop(),r},_setLatLngs:function(n){oo.prototype._setLatLngs.call(this,n),On(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return On(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,r=this.options.weight,h=new ve(r,r);if(n=new xe(n.min.subtract(h),n.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var g=0,x=this._rings.length,R;g<x;g++)R=ur(this._rings[g],n,!0),R.length&&this._parts.push(R)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var r=!1,h,g,x,R,te,pe,ke,De;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(R=0,ke=this._parts.length;R<ke;R++)for(h=this._parts[R],te=0,De=h.length,pe=De-1;te<De;pe=te++)g=h[te],x=h[pe],g.y>n.y!=x.y>n.y&&n.x<(x.x-g.x)*(n.y-g.y)/(x.y-g.y)+g.x&&(r=!r);return r||oo.prototype._containsPoint.call(this,n,!0)}});function Ie(n,r){return new le(n,r)}var Ae=no.extend({initialize:function(n,r){S(this,r),this._layers={},n&&this.addData(n)},addData:function(n){var r=$(n)?n:n.features,h,g,x;if(r){for(h=0,g=r.length;h<g;h++)x=r[h],(x.geometries||x.geometry||x.features||x.coordinates)&&this.addData(x);return this}var R=this.options;if(R.filter&&!R.filter(n))return this;var te=_t(n,R);return te?(te.feature=wr(n),te.defaultOptions=te.options,this.resetStyle(te),R.onEachFeature&&R.onEachFeature(n,te),this.addLayer(te)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=s({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(r){this._setLayerStyle(r,n)},this)},_setLayerStyle:function(n,r){n.setStyle&&(typeof r=="function"&&(r=r(n.feature)),n.setStyle(r))}});function _t(n,r){var h=n.type==="Feature"?n.geometry:n,g=h?h.coordinates:null,x=[],R=r&&r.pointToLayer,te=r&&r.coordsToLatLng||Wn,pe,ke,De,Ke;if(!g&&!h)return null;switch(h.type){case"Point":return pe=te(g),Ln(R,n,pe,r);case"MultiPoint":for(De=0,Ke=g.length;De<Ke;De++)pe=te(g[De]),x.push(Ln(R,n,pe,r));return new no(x);case"LineString":case"MultiLineString":return ke=Fo(g,h.type==="LineString"?0:1,te),new oo(ke,r);case"Polygon":case"MultiPolygon":return ke=Fo(g,h.type==="Polygon"?1:2,te),new le(ke,r);case"GeometryCollection":for(De=0,Ke=h.geometries.length;De<Ke;De++){var it=_t({geometry:h.geometries[De],type:"Feature",properties:n.properties},r);it&&x.push(it)}return new no(x);case"FeatureCollection":for(De=0,Ke=h.features.length;De<Ke;De++){var mt=_t(h.features[De],r);mt&&x.push(mt)}return new no(x);default:throw new Error("Invalid GeoJSON object.")}}function Ln(n,r,h,g){return n?n(r,h):new Bi(h,g&&g.markersInheritOptions&&g)}function Wn(n){return new Me(n[1],n[0],n[2])}function Fo(n,r,h){for(var g=[],x=0,R=n.length,te;x<R;x++)te=r?Fo(n[x],r-1,h):(h||Wn)(n[x]),g.push(te);return g}function Yl(n,r){return n=$e(n),n.alt!==void 0?[b(n.lng,r),b(n.lat,r),b(n.alt,r)]:[b(n.lng,r),b(n.lat,r)]}function br(n,r,h,g){for(var x=[],R=0,te=n.length;R<te;R++)x.push(r?br(n[R],On(n[R])?0:r-1,h,g):Yl(n[R],g));return!r&&h&&x.length>0&&x.push(x[0].slice()),x}function Ui(n,r){return n.feature?s({},n.feature,{geometry:r}):wr(r)}function wr(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var Jl={toGeoJSON:function(n){return Ui(this,{type:"Point",coordinates:Yl(this.getLatLng(),n)})}};Bi.include(Jl),Fi.include(Jl),Ni.include(Jl),oo.include({toGeoJSON:function(n){var r=!On(this._latlngs),h=br(this._latlngs,r?1:0,!1,n);return Ui(this,{type:(r?"Multi":"")+"LineString",coordinates:h})}}),le.include({toGeoJSON:function(n){var r=!On(this._latlngs),h=r&&!On(this._latlngs[0]),g=br(this._latlngs,h?2:r?1:0,!0,n);return r||(g=[g]),Ui(this,{type:(h?"Multi":"")+"Polygon",coordinates:g})}}),as.include({toMultiPoint:function(n){var r=[];return this.eachLayer(function(h){r.push(h.toGeoJSON(n).geometry.coordinates)}),Ui(this,{type:"MultiPoint",coordinates:r})},toGeoJSON:function(n){var r=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(r==="MultiPoint")return this.toMultiPoint(n);var h=r==="GeometryCollection",g=[];return this.eachLayer(function(x){if(x.toGeoJSON){var R=x.toGeoJSON(n);if(h)g.push(R.geometry);else{var te=wr(R);te.type==="FeatureCollection"?g.push.apply(g,te.features):g.push(te)}}}),h?Ui(this,{geometries:g,type:"GeometryCollection"}):{type:"FeatureCollection",features:g}}});function Mu(n,r){return new Ae(n,r)}var sv=Mu,Cr=jn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,r,h){this._url=n,this._bounds=Ee(r),S(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ct(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){$t(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&Gn(this._image),this},bringToBack:function(){return this._map&&Ao(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=Ee(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",r=this._image=n?this._url:yt("img");if(ct(r,"leaflet-image-layer"),this._zoomAnimated&&ct(r,"leaflet-zoom-animated"),this.options.className&&ct(r,this.options.className),r.onselectstart=y,r.onmousemove=y,r.onload=c(this.fire,this,"load"),r.onerror=c(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(r.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=r.src;return}r.src=this._url,r.alt=this.options.alt},_animateZoom:function(n){var r=this._map.getZoomScale(n.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;At(this._image,h,r)},_reset:function(){var n=this._image,r=new xe(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=r.getSize();It(n,r.min),n.style.width=h.x+"px",n.style.height=h.y+"px"},_updateOpacity:function(){an(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),iv=function(n,r,h){return new Cr(n,r,h)},Au=Cr.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",r=this._image=n?this._url:yt("video");if(ct(r,"leaflet-image-layer"),this._zoomAnimated&&ct(r,"leaflet-zoom-animated"),this.options.className&&ct(r,this.options.className),r.onselectstart=y,r.onmousemove=y,r.onloadeddata=c(this.fire,this,"load"),n){for(var h=r.getElementsByTagName("source"),g=[],x=0;x<h.length;x++)g.push(h[x].src);this._url=h.length>0?g:[r.src];return}$(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(r.style,"objectFit")&&(r.style.objectFit="fill"),r.autoplay=!!this.options.autoplay,r.loop=!!this.options.loop,r.muted=!!this.options.muted,r.playsInline=!!this.options.playsInline;for(var R=0;R<this._url.length;R++){var te=yt("source");te.src=this._url[R],r.appendChild(te)}}});function av(n,r,h){return new Au(n,r,h)}var Eu=Cr.extend({_initImage:function(){var n=this._image=this._url;ct(n,"leaflet-image-layer"),this._zoomAnimated&&ct(n,"leaflet-zoom-animated"),this.options.className&&ct(n,this.options.className),n.onselectstart=y,n.onmousemove=y}});function rv(n,r,h){return new Eu(n,r,h)}var Uo=jn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,r){n&&(n instanceof Me||$(n))?(this._latlng=$e(n),S(this,r)):(S(this,n),this._source=r),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&an(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&an(this._container,1),this.bringToFront(),this.options.interactive&&(ct(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(an(this._container,0),this._removeTimeout=setTimeout(c($t,void 0,this._container),200)):$t(this._container),this.options.interactive&&(Mt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=$e(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Gn(this._container),this},bringToBack:function(){return this._map&&Ao(this._container),this},_prepareOpen:function(n){var r=this._source;if(!r._map)return!1;if(r instanceof no){r=null;var h=this._source._layers;for(var g in h)if(h[g]._map){r=h[g];break}if(!r)return!1;this._source=r}if(!n)if(r.getCenter)n=r.getCenter();else if(r.getLatLng)n=r.getLatLng();else if(r.getBounds)n=r.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,r=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof r=="string")n.innerHTML=r;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(r)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),r=fe(this.options.offset),h=this._getAnchor();this._zoomAnimated?It(this._container,n.add(h)):r=r.add(n).add(h);var g=this._containerBottom=-r.y,x=this._containerLeft=-Math.round(this._containerWidth/2)+r.x;this._container.style.bottom=g+"px",this._container.style.left=x+"px"}},_getAnchor:function(){return[0,0]}});nt.include({_initOverlay:function(n,r,h,g){var x=r;return x instanceof n||(x=new n(g).setContent(r)),h&&x.setLatLng(h),x}}),jn.include({_initOverlay:function(n,r,h,g){var x=h;return x instanceof n?(S(x,g),x._source=this):(x=r&&!g?r:new n(g,this),x.setContent(h)),x}});var Lr=Uo.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,Uo.prototype.openOn.call(this,n)},onAdd:function(n){Uo.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof No||this._source.on("preclick",fo))},onRemove:function(n){Uo.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof No||this._source.off("preclick",fo))},getEvents:function(){var n=Uo.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",r=this._container=yt("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=yt("div",n+"-content-wrapper",r);if(this._contentNode=yt("div",n+"-content",h),wn(r),di(this._contentNode),lt(r,"contextmenu",fo),this._tipContainer=yt("div",n+"-tip-container",r),this._tip=yt("div",n+"-tip",this._tipContainer),this.options.closeButton){var g=this._closeButton=yt("a",n+"-close-button",r);g.setAttribute("role","button"),g.setAttribute("aria-label","Close popup"),g.href="#close",g.innerHTML='<span aria-hidden="true">&#215;</span>',lt(g,"click",function(x){Nt(x),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,r=n.style;r.width="",r.whiteSpace="nowrap";var h=n.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),r.width=h+1+"px",r.whiteSpace="",r.height="";var g=n.offsetHeight,x=this.options.maxHeight,R="leaflet-popup-scrolled";x&&g>x?(r.height=x+"px",ct(n,R)):Mt(n,R),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var r=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),h=this._getAnchor();It(this._container,r.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,r=parseInt(Mo(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+r,g=this._containerWidth,x=new ve(this._containerLeft,-h-this._containerBottom);x._add(tn(this._container));var R=n.layerPointToContainerPoint(x),te=fe(this.options.autoPanPadding),pe=fe(this.options.autoPanPaddingTopLeft||te),ke=fe(this.options.autoPanPaddingBottomRight||te),De=n.getSize(),Ke=0,it=0;R.x+g+ke.x>De.x&&(Ke=R.x+g-De.x+ke.x),R.x-Ke-pe.x<0&&(Ke=R.x-pe.x),R.y+h+ke.y>De.y&&(it=R.y+h-De.y+ke.y),R.y-it-pe.y<0&&(it=R.y-pe.y),(Ke||it)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([Ke,it]))}},_getAnchor:function(){return fe(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),lv=function(n,r){return new Lr(n,r)};nt.mergeOptions({closePopupOnClick:!0}),nt.include({openPopup:function(n,r,h){return this._initOverlay(Lr,n,r,h).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),jn.include({bindPopup:function(n,r){return this._popup=this._initOverlay(Lr,this._popup,n,r),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof no||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){po(n);var r=n.layer||n.target;if(this._popup._source===r&&!(r instanceof No)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=r,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var Sr=Uo.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){Uo.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){Uo.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=Uo.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",r=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=yt("div",r),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var r,h,g=this._map,x=this._container,R=g.latLngToContainerPoint(g.getCenter()),te=g.layerPointToContainerPoint(n),pe=this.options.direction,ke=x.offsetWidth,De=x.offsetHeight,Ke=fe(this.options.offset),it=this._getAnchor();pe==="top"?(r=ke/2,h=De):pe==="bottom"?(r=ke/2,h=0):pe==="center"?(r=ke/2,h=De/2):pe==="right"?(r=0,h=De/2):pe==="left"?(r=ke,h=De/2):te.x<R.x?(pe="right",r=0,h=De/2):(pe="left",r=ke+(Ke.x+it.x)*2,h=De/2),n=n.subtract(fe(r,h,!0)).add(Ke).add(it),Mt(x,"leaflet-tooltip-right"),Mt(x,"leaflet-tooltip-left"),Mt(x,"leaflet-tooltip-top"),Mt(x,"leaflet-tooltip-bottom"),ct(x,"leaflet-tooltip-"+pe),It(x,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&an(this._container,n)},_animateZoom:function(n){var r=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(r)},_getAnchor:function(){return fe(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),cv=function(n,r){return new Sr(n,r)};nt.include({openTooltip:function(n,r,h){return this._initOverlay(Sr,n,r,h).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),jn.include({bindTooltip:function(n,r){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Sr,this._tooltip,n,r),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var r=n?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[r](h),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof no||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var r=typeof n.getElement=="function"&&n.getElement();r&&(lt(r,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),lt(r,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var r=typeof n.getElement=="function"&&n.getElement();r&&r.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var r=this;this._map.once("moveend",function(){r._openOnceFlag=!1,r._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var r=n.latlng,h,g;this._tooltip.options.sticky&&n.originalEvent&&(h=this._map.mouseEventToContainerPoint(n.originalEvent),g=this._map.containerPointToLayerPoint(h),r=this._map.layerPointToLatLng(g)),this._tooltip.setLatLng(r)}});var Pu=Hs.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var r=n&&n.tagName==="DIV"?n:document.createElement("div"),h=this.options;if(h.html instanceof Element?(Ns(r),r.appendChild(h.html)):r.innerHTML=h.html!==!1?h.html:"",h.bgPos){var g=fe(h.bgPos);r.style.backgroundPosition=-g.x+"px "+-g.y+"px"}return this._setIconStyles(r,"icon"),r},createShadow:function(){return null}});function uv(n){return new Pu(n)}Hs.Default=rs;var ma=jn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:qe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){S(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),$t(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Gn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ao(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof ve?n:new ve(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var r=this.getPane().children,h=-n(-1/0,1/0),g=0,x=r.length,R;g<x;g++)R=r[g].style.zIndex,r[g]!==this._container&&R&&(h=n(h,+R));isFinite(h)&&(this.options.zIndex=h+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!qe.ielt9){an(this._container,this.options.opacity);var n=+new Date,r=!1,h=!1;for(var g in this._tiles){var x=this._tiles[g];if(!(!x.current||!x.loaded)){var R=Math.min(1,(n-x.loaded)/200);an(x.el,R),R<1?r=!0:(x.active?h=!0:this._onOpaqueTile(x),x.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),r&&(se(this._fadeFrame),this._fadeFrame=K(this._updateOpacity,this))}},_onOpaqueTile:y,_initContainer:function(){this._container||(this._container=yt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,r=this.options.maxZoom;if(n!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===n?(this._levels[h].el.style.zIndex=r-Math.abs(n-h),this._onUpdateLevel(h)):($t(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var g=this._levels[n],x=this._map;return g||(g=this._levels[n]={},g.el=yt("div","leaflet-tile-container leaflet-zoom-animated",this._container),g.el.style.zIndex=r,g.origin=x.project(x.unproject(x.getPixelOrigin()),n).round(),g.zoom=n,this._setZoomTransform(g,x.getCenter(),x.getZoom()),y(g.el.offsetWidth),this._onCreateLevel(g)),this._level=g,g}},_onUpdateLevel:y,_onRemoveLevel:y,_onCreateLevel:y,_pruneTiles:function(){if(this._map){var n,r,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)r=this._tiles[n],r.retain=r.current;for(n in this._tiles)if(r=this._tiles[n],r.current&&!r.active){var g=r.coords;this._retainParent(g.x,g.y,g.z,g.z-5)||this._retainChildren(g.x,g.y,g.z,g.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var r in this._tiles)this._tiles[r].coords.z===n&&this._removeTile(r)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)$t(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,r,h,g){var x=Math.floor(n/2),R=Math.floor(r/2),te=h-1,pe=new ve(+x,+R);pe.z=+te;var ke=this._tileCoordsToKey(pe),De=this._tiles[ke];return De&&De.active?(De.retain=!0,!0):(De&&De.loaded&&(De.retain=!0),te>g?this._retainParent(x,R,te,g):!1)},_retainChildren:function(n,r,h,g){for(var x=2*n;x<2*n+2;x++)for(var R=2*r;R<2*r+2;R++){var te=new ve(x,R);te.z=h+1;var pe=this._tileCoordsToKey(te),ke=this._tiles[pe];if(ke&&ke.active){ke.retain=!0;continue}else ke&&ke.loaded&&(ke.retain=!0);h+1<g&&this._retainChildren(x,R,h+1,g)}},_resetView:function(n){var r=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),r,r)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var r=this.options;return r.minNativeZoom!==void 0&&n<r.minNativeZoom?r.minNativeZoom:r.maxNativeZoom!==void 0&&r.maxNativeZoom<n?r.maxNativeZoom:n},_setView:function(n,r,h,g){var x=Math.round(r);this.options.maxZoom!==void 0&&x>this.options.maxZoom||this.options.minZoom!==void 0&&x<this.options.minZoom?x=void 0:x=this._clampZoom(x);var R=this.options.updateWhenZooming&&x!==this._tileZoom;(!g||R)&&(this._tileZoom=x,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),x!==void 0&&this._update(n),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(n,r)},_setZoomTransforms:function(n,r){for(var h in this._levels)this._setZoomTransform(this._levels[h],n,r)},_setZoomTransform:function(n,r,h){var g=this._map.getZoomScale(h,n.zoom),x=n.origin.multiplyBy(g).subtract(this._map._getNewPixelOrigin(r,h)).round();qe.any3d?At(n.el,x,g):It(n.el,x)},_resetGrid:function(){var n=this._map,r=n.options.crs,h=this._tileSize=this.getTileSize(),g=this._tileZoom,x=this._map.getPixelWorldBounds(this._tileZoom);x&&(this._globalTileRange=this._pxBoundsToTileRange(x)),this._wrapX=r.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,r.wrapLng[0]],g).x/h.x),Math.ceil(n.project([0,r.wrapLng[1]],g).x/h.y)],this._wrapY=r.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([r.wrapLat[0],0],g).y/h.x),Math.ceil(n.project([r.wrapLat[1],0],g).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var r=this._map,h=r._animatingZoom?Math.max(r._animateToZoom,r.getZoom()):r.getZoom(),g=r.getZoomScale(h,this._tileZoom),x=r.project(n,this._tileZoom).floor(),R=r.getSize().divideBy(g*2);return new xe(x.subtract(R),x.add(R))},_update:function(n){var r=this._map;if(r){var h=this._clampZoom(r.getZoom());if(n===void 0&&(n=r.getCenter()),this._tileZoom!==void 0){var g=this._getTiledPixelBounds(n),x=this._pxBoundsToTileRange(g),R=x.getCenter(),te=[],pe=this.options.keepBuffer,ke=new xe(x.getBottomLeft().subtract([pe,-pe]),x.getTopRight().add([pe,-pe]));if(!(isFinite(x.min.x)&&isFinite(x.min.y)&&isFinite(x.max.x)&&isFinite(x.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var De in this._tiles){var Ke=this._tiles[De].coords;(Ke.z!==this._tileZoom||!ke.contains(new ve(Ke.x,Ke.y)))&&(this._tiles[De].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(n,h);return}for(var it=x.min.y;it<=x.max.y;it++)for(var mt=x.min.x;mt<=x.max.x;mt++){var Sn=new ve(mt,it);if(Sn.z=this._tileZoom,!!this._isValidTile(Sn)){var Jt=this._tiles[this._tileCoordsToKey(Sn)];Jt?Jt.current=!0:te.push(Sn)}}if(te.sort(function(Rn,Hi){return Rn.distanceTo(R)-Hi.distanceTo(R)}),te.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var so=document.createDocumentFragment();for(mt=0;mt<te.length;mt++)this._addTile(te[mt],so);this._level.el.appendChild(so)}}}},_isValidTile:function(n){var r=this._map.options.crs;if(!r.infinite){var h=this._globalTileRange;if(!r.wrapLng&&(n.x<h.min.x||n.x>h.max.x)||!r.wrapLat&&(n.y<h.min.y||n.y>h.max.y))return!1}if(!this.options.bounds)return!0;var g=this._tileCoordsToBounds(n);return Ee(this.options.bounds).overlaps(g)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var r=this._map,h=this.getTileSize(),g=n.scaleBy(h),x=g.add(h),R=r.unproject(g,n.z),te=r.unproject(x,n.z);return[R,te]},_tileCoordsToBounds:function(n){var r=this._tileCoordsToNwSe(n),h=new re(r[0],r[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var r=n.split(":"),h=new ve(+r[0],+r[1]);return h.z=+r[2],h},_removeTile:function(n){var r=this._tiles[n];r&&($t(r.el),delete this._tiles[n],this.fire("tileunload",{tile:r.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){ct(n,"leaflet-tile");var r=this.getTileSize();n.style.width=r.x+"px",n.style.height=r.y+"px",n.onselectstart=y,n.onmousemove=y,qe.ielt9&&this.options.opacity<1&&an(n,this.options.opacity)},_addTile:function(n,r){var h=this._getTilePos(n),g=this._tileCoordsToKey(n),x=this.createTile(this._wrapCoords(n),c(this._tileReady,this,n));this._initTile(x),this.createTile.length<2&&K(c(this._tileReady,this,n,null,x)),It(x,h),this._tiles[g]={el:x,coords:n,current:!0},r.appendChild(x),this.fire("tileloadstart",{tile:x,coords:n})},_tileReady:function(n,r,h){r&&this.fire("tileerror",{error:r,tile:h,coords:n});var g=this._tileCoordsToKey(n);h=this._tiles[g],h&&(h.loaded=+new Date,this._map._fadeAnimated?(an(h.el,0),se(this._fadeFrame),this._fadeFrame=K(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),r||(ct(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),qe.ielt9||!this._map._fadeAnimated?K(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var r=new ve(this._wrapX?f(n.x,this._wrapX):n.x,this._wrapY?f(n.y,this._wrapY):n.y);return r.z=n.z,r},_pxBoundsToTileRange:function(n){var r=this.getTileSize();return new xe(n.min.unscaleBy(r).floor(),n.max.unscaleBy(r).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function dv(n){return new ma(n)}var zi=ma.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,r){this._url=n,r=S(this,r),r.detectRetina&&qe.retina&&r.maxZoom>0?(r.tileSize=Math.floor(r.tileSize/2),r.zoomReverse?(r.zoomOffset--,r.minZoom=Math.min(r.maxZoom,r.minZoom+1)):(r.zoomOffset++,r.maxZoom=Math.max(r.minZoom,r.maxZoom-1)),r.minZoom=Math.max(0,r.minZoom)):r.zoomReverse?r.minZoom=Math.min(r.maxZoom,r.minZoom):r.maxZoom=Math.max(r.minZoom,r.maxZoom),typeof r.subdomains=="string"&&(r.subdomains=r.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,r){return this._url===n&&r===void 0&&(r=!0),this._url=n,r||this.redraw(),this},createTile:function(n,r){var h=document.createElement("img");return lt(h,"load",c(this._tileOnLoad,this,r,h)),lt(h,"error",c(this._tileOnError,this,r,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(n),h},getTileUrl:function(n){var r={r:qe.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-n.y;this.options.tms&&(r.y=h),r["-y"]=h}return A(this._url,s(r,this.options))},_tileOnLoad:function(n,r){qe.ielt9?setTimeout(c(n,this,null,r),0):n(null,r)},_tileOnError:function(n,r,h){var g=this.options.errorTileUrl;g&&r.getAttribute("src")!==g&&(r.src=g),n(h,r)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,r=this.options.maxZoom,h=this.options.zoomReverse,g=this.options.zoomOffset;return h&&(n=r-n),n+g},_getSubdomain:function(n){var r=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[r]},_abortLoading:function(){var n,r;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(r=this._tiles[n].el,r.onload=y,r.onerror=y,!r.complete)){r.src=w;var h=this._tiles[n].coords;$t(r),delete this._tiles[n],this.fire("tileabort",{tile:r,coords:h})}},_removeTile:function(n){var r=this._tiles[n];if(r)return r.el.setAttribute("src",w),ma.prototype._removeTile.call(this,n)},_tileReady:function(n,r,h){if(!(!this._map||h&&h.getAttribute("src")===w))return ma.prototype._tileReady.call(this,n,r,h)}});function Du(n,r){return new zi(n,r)}var Ou=zi.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,r){this._url=n;var h=s({},this.defaultWmsParams);for(var g in r)g in this.options||(h[g]=r[g]);r=S(this,r);var x=r.detectRetina&&qe.retina?2:1,R=this.getTileSize();h.width=R.x*x,h.height=R.y*x,this.wmsParams=h},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var r=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[r]=this._crs.code,zi.prototype.onAdd.call(this,n)},getTileUrl:function(n){var r=this._tileCoordsToNwSe(n),h=this._crs,g=Be(h.project(r[0]),h.project(r[1])),x=g.min,R=g.max,te=(this._wmsVersion>=1.3&&this._crs===gr?[x.y,x.x,R.y,R.x]:[x.x,x.y,R.x,R.y]).join(","),pe=zi.prototype.getTileUrl.call(this,n);return pe+O(this.wmsParams,pe,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+te},setParams:function(n,r){return s(this.wmsParams,n),r||this.redraw(),this}});function hv(n,r){return new Ou(n,r)}zi.WMS=Ou,Du.wms=hv;var ls=jn.extend({options:{padding:.1},initialize:function(n){S(this,n),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ct(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,r){var h=this._map.getZoomScale(r,this._zoom),g=this._map.getSize().multiplyBy(.5+this.options.padding),x=this._map.project(this._center,r),R=g.multiplyBy(-h).add(x).subtract(this._map._getNewPixelOrigin(n,r));qe.any3d?At(this._container,R,h):It(this._container,R)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,r=this._map.getSize(),h=this._map.containerPointToLayerPoint(r.multiplyBy(-n)).round();this._bounds=new xe(h,h.add(r.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ru=ls.extend({options:{tolerance:0},getEvents:function(){var n=ls.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ls.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");lt(n,"mousemove",this._onMouseMove,this),lt(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),lt(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){se(this._redrawRequest),delete this._ctx,$t(this._container),bt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var r in this._layers)n=this._layers[r],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ls.prototype._update.call(this);var n=this._bounds,r=this._container,h=n.getSize(),g=qe.retina?2:1;It(r,n.min),r.width=g*h.x,r.height=g*h.y,r.style.width=h.x+"px",r.style.height=h.y+"px",qe.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){ls.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[d(n)]=n;var r=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=r),this._drawLast=r,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var r=n._order,h=r.next,g=r.prev;h?h.prev=g:this._drawLast=g,g?g.next=h:this._drawFirst=h,delete n._order,delete this._layers[d(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var r=n.options.dashArray.split(/[, ]+/),h=[],g,x;for(x=0;x<r.length;x++){if(g=Number(r[x]),isNaN(g))return;h.push(g)}n.options._dashArray=h}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||K(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var r=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new xe,this._redrawBounds.extend(n._pxBounds.min.subtract([r,r])),this._redrawBounds.extend(n._pxBounds.max.add([r,r]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var r=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,r.x,r.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,r=this._redrawBounds;if(this._ctx.save(),r){var h=r.getSize();this._ctx.beginPath(),this._ctx.rect(r.min.x,r.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var g=this._drawFirst;g;g=g.next)n=g.layer,(!r||n._pxBounds&&n._pxBounds.intersects(r))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,r){if(this._drawing){var h,g,x,R,te=n._parts,pe=te.length,ke=this._ctx;if(pe){for(ke.beginPath(),h=0;h<pe;h++){for(g=0,x=te[h].length;g<x;g++)R=te[h][g],ke[g?"lineTo":"moveTo"](R.x,R.y);r&&ke.closePath()}this._fillStroke(ke,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var r=n._point,h=this._ctx,g=Math.max(Math.round(n._radius),1),x=(Math.max(Math.round(n._radiusY),1)||g)/g;x!==1&&(h.save(),h.scale(1,x)),h.beginPath(),h.arc(r.x,r.y/x,g,0,Math.PI*2,!1),x!==1&&h.restore(),this._fillStroke(h,n)}},_fillStroke:function(n,r){var h=r.options;h.fill&&(n.globalAlpha=h.fillOpacity,n.fillStyle=h.fillColor||h.color,n.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(n.setLineDash&&n.setLineDash(r.options&&r.options._dashArray||[]),n.globalAlpha=h.opacity,n.lineWidth=h.weight,n.strokeStyle=h.color,n.lineCap=h.lineCap,n.lineJoin=h.lineJoin,n.stroke())},_onClick:function(n){for(var r=this._map.mouseEventToLayerPoint(n),h,g,x=this._drawFirst;x;x=x.next)h=x.layer,h.options.interactive&&h._containsPoint(r)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(h))&&(g=h);this._fireEvent(g?[g]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var r=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,r)}},_handleMouseOut:function(n){var r=this._hoveredLayer;r&&(Mt(this._container,"leaflet-interactive"),this._fireEvent([r],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,r){if(!this._mouseHoverThrottled){for(var h,g,x=this._drawFirst;x;x=x.next)h=x.layer,h.options.interactive&&h._containsPoint(r)&&(g=h);g!==this._hoveredLayer&&(this._handleMouseOut(n),g&&(ct(this._container,"leaflet-interactive"),this._fireEvent([g],n,"mouseover"),this._hoveredLayer=g)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(c(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,r,h){this._map._fireDOMEvent(r,h||r.type,n)},_bringToFront:function(n){var r=n._order;if(r){var h=r.next,g=r.prev;if(h)h.prev=g;else return;g?g.next=h:h&&(this._drawFirst=h),r.prev=this._drawLast,this._drawLast.next=r,r.next=null,this._drawLast=r,this._requestRedraw(n)}},_bringToBack:function(n){var r=n._order;if(r){var h=r.next,g=r.prev;if(g)g.next=h;else return;h?h.prev=g:g&&(this._drawLast=g),r.prev=null,r.next=this._drawFirst,this._drawFirst.prev=r,this._drawFirst=r,this._requestRedraw(n)}}});function Bu(n){return qe.canvas?new Ru(n):null}var ga=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),fv={_initContainer:function(){this._container=yt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ls.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var r=n._container=ga("shape");ct(r,"leaflet-vml-shape "+(this.options.className||"")),r.coordsize="1 1",n._path=ga("path"),r.appendChild(n._path),this._updateStyle(n),this._layers[d(n)]=n},_addPath:function(n){var r=n._container;this._container.appendChild(r),n.options.interactive&&n.addInteractiveTarget(r)},_removePath:function(n){var r=n._container;$t(r),n.removeInteractiveTarget(r),delete this._layers[d(n)]},_updateStyle:function(n){var r=n._stroke,h=n._fill,g=n.options,x=n._container;x.stroked=!!g.stroke,x.filled=!!g.fill,g.stroke?(r||(r=n._stroke=ga("stroke")),x.appendChild(r),r.weight=g.weight+"px",r.color=g.color,r.opacity=g.opacity,g.dashArray?r.dashStyle=$(g.dashArray)?g.dashArray.join(" "):g.dashArray.replace(/( *, *)/g," "):r.dashStyle="",r.endcap=g.lineCap.replace("butt","flat"),r.joinstyle=g.lineJoin):r&&(x.removeChild(r),n._stroke=null),g.fill?(h||(h=n._fill=ga("fill")),x.appendChild(h),h.color=g.fillColor||g.color,h.opacity=g.fillOpacity):h&&(x.removeChild(h),n._fill=null)},_updateCircle:function(n){var r=n._point.round(),h=Math.round(n._radius),g=Math.round(n._radiusY||h);this._setPath(n,n._empty()?"M0 0":"AL "+r.x+","+r.y+" "+h+","+g+" 0,"+65535*360)},_setPath:function(n,r){n._path.v=r},_bringToFront:function(n){Gn(n._container)},_bringToBack:function(n){Ao(n._container)}},xr=qe.vml?ga:q,ya=ls.extend({_initContainer:function(){this._container=xr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=xr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){$t(this._container),bt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ls.prototype._update.call(this);var n=this._bounds,r=n.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(r))&&(this._svgSize=r,h.setAttribute("width",r.x),h.setAttribute("height",r.y)),It(h,n.min),h.setAttribute("viewBox",[n.min.x,n.min.y,r.x,r.y].join(" ")),this.fire("update")}},_initPath:function(n){var r=n._path=xr("path");n.options.className&&ct(r,n.options.className),n.options.interactive&&ct(r,"leaflet-interactive"),this._updateStyle(n),this._layers[d(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){$t(n._path),n.removeInteractiveTarget(n._path),delete this._layers[d(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var r=n._path,h=n.options;r&&(h.stroke?(r.setAttribute("stroke",h.color),r.setAttribute("stroke-opacity",h.opacity),r.setAttribute("stroke-width",h.weight),r.setAttribute("stroke-linecap",h.lineCap),r.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?r.setAttribute("stroke-dasharray",h.dashArray):r.removeAttribute("stroke-dasharray"),h.dashOffset?r.setAttribute("stroke-dashoffset",h.dashOffset):r.removeAttribute("stroke-dashoffset")):r.setAttribute("stroke","none"),h.fill?(r.setAttribute("fill",h.fillColor||h.color),r.setAttribute("fill-opacity",h.fillOpacity),r.setAttribute("fill-rule",h.fillRule||"evenodd")):r.setAttribute("fill","none"))},_updatePoly:function(n,r){this._setPath(n,F(n._parts,r))},_updateCircle:function(n){var r=n._point,h=Math.max(Math.round(n._radius),1),g=Math.max(Math.round(n._radiusY),1)||h,x="a"+h+","+g+" 0 1,0 ",R=n._empty()?"M0 0":"M"+(r.x-h)+","+r.y+x+h*2+",0 "+x+-h*2+",0 ";this._setPath(n,R)},_setPath:function(n,r){n._path.setAttribute("d",r)},_bringToFront:function(n){Gn(n._path)},_bringToBack:function(n){Ao(n._path)}});qe.vml&&ya.include(fv);function Nu(n){return qe.svg||qe.vml?new ya(n):null}nt.include({getRenderer:function(n){var r=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return r||(r=this._renderer=this._createRenderer()),this.hasLayer(r)||this.addLayer(r),r},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var r=this._paneRenderers[n];return r===void 0&&(r=this._createRenderer({pane:n}),this._paneRenderers[n]=r),r},_createRenderer:function(n){return this.options.preferCanvas&&Bu(n)||Nu(n)}});var Fu=le.extend({initialize:function(n,r){le.prototype.initialize.call(this,this._boundsToLatLngs(n),r)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=Ee(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function pv(n,r){return new Fu(n,r)}ya.create=xr,ya.pointsToPath=F,Ae.geometryToLayer=_t,Ae.coordsToLatLng=Wn,Ae.coordsToLatLngs=Fo,Ae.latLngToCoords=Yl,Ae.latLngsToCoords=br,Ae.getFeature=Ui,Ae.asFeature=wr,nt.mergeOptions({boxZoom:!0});var Uu=Zn.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){lt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){bt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){$t(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),ln(),Us(),this._startPoint=this._map.mouseEventToContainerPoint(n),lt(document,{contextmenu:po,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=yt("div","leaflet-zoom-box",this._container),ct(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var r=new xe(this._point,this._startPoint),h=r.getSize();It(this._box,r.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&($t(this._box),Mt(this._container,"leaflet-crosshair")),Pn(),Do(),bt(document,{contextmenu:po,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0);var r=new re(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(r).fire("boxzoomend",{boxZoomBounds:r})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});nt.addInitHook("addHandler","boxZoom",Uu),nt.mergeOptions({doubleClickZoom:!0});var zu=Zn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var r=this._map,h=r.getZoom(),g=r.options.zoomDelta,x=n.originalEvent.shiftKey?h-g:h+g;r.options.doubleClickZoom==="center"?r.setZoom(x):r.setZoomAround(n.containerPoint,x)}});nt.addInitHook("addHandler","doubleClickZoom",zu),nt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Hu=Zn.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new Bo(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}ct(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Mt(this._map._container,"leaflet-grab"),Mt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var r=Ee(this._map.options.maxBounds);this._offsetLimit=Be(this._map.latLngToContainerPoint(r.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(r.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var r=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(r),this._prunePositions(r)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),r=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=r.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,r){return n-(n-r)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),r=this._offsetLimit;n.x<r.min.x&&(n.x=this._viscousLimit(n.x,r.min.x)),n.y<r.min.y&&(n.y=this._viscousLimit(n.y,r.min.y)),n.x>r.max.x&&(n.x=this._viscousLimit(n.x,r.max.x)),n.y>r.max.y&&(n.y=this._viscousLimit(n.y,r.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,r=Math.round(n/2),h=this._initialWorldOffset,g=this._draggable._newPos.x,x=(g-r+h)%n+r-h,R=(g+r+h)%n-r-h,te=Math.abs(x+h)<Math.abs(R+h)?x:R;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=te},_onDragEnd:function(n){var r=this._map,h=r.options,g=!h.inertia||n.noInertia||this._times.length<2;if(r.fire("dragend",n),g)r.fire("moveend");else{this._prunePositions(+new Date);var x=this._lastPos.subtract(this._positions[0]),R=(this._lastTime-this._times[0])/1e3,te=h.easeLinearity,pe=x.multiplyBy(te/R),ke=pe.distanceTo([0,0]),De=Math.min(h.inertiaMaxSpeed,ke),Ke=pe.multiplyBy(De/ke),it=De/(h.inertiaDeceleration*te),mt=Ke.multiplyBy(-it/2).round();!mt.x&&!mt.y?r.fire("moveend"):(mt=r._limitOffset(mt,r.options.maxBounds),K(function(){r.panBy(mt,{duration:it,easeLinearity:te,noMoveStart:!0,animate:!0})}))}}});nt.addInitHook("addHandler","dragging",Hu),nt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Vu=Zn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),lt(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),bt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,r=document.documentElement,h=n.scrollTop||r.scrollTop,g=n.scrollLeft||r.scrollLeft;this._map._container.focus(),window.scrollTo(g,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var r=this._panKeys={},h=this.keyCodes,g,x;for(g=0,x=h.left.length;g<x;g++)r[h.left[g]]=[-1*n,0];for(g=0,x=h.right.length;g<x;g++)r[h.right[g]]=[n,0];for(g=0,x=h.down.length;g<x;g++)r[h.down[g]]=[0,n];for(g=0,x=h.up.length;g<x;g++)r[h.up[g]]=[0,-1*n]},_setZoomDelta:function(n){var r=this._zoomKeys={},h=this.keyCodes,g,x;for(g=0,x=h.zoomIn.length;g<x;g++)r[h.zoomIn[g]]=n;for(g=0,x=h.zoomOut.length;g<x;g++)r[h.zoomOut[g]]=-n},_addHooks:function(){lt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){bt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var r=n.keyCode,h=this._map,g;if(r in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(g=this._panKeys[r],n.shiftKey&&(g=fe(g).multiplyBy(3)),h.options.maxBounds&&(g=h._limitOffset(fe(g),h.options.maxBounds)),h.options.worldCopyJump){var x=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(g)));h.panTo(x)}else h.panBy(g)}else if(r in this._zoomKeys)h.setZoom(h.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[r]);else if(r===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;po(n)}}});nt.addInitHook("addHandler","keyboard",Vu),nt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Gu=Zn.extend({addHooks:function(){lt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){bt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var r=Le(n),h=this._map.options.wheelDebounceTime;this._delta+=r,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var g=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(c(this._performZoom,this),g),po(n)},_performZoom:function(){var n=this._map,r=n.getZoom(),h=this._map.options.zoomSnap||0;n._stop();var g=this._delta/(this._map.options.wheelPxPerZoomLevel*4),x=4*Math.log(2/(1+Math.exp(-Math.abs(g))))/Math.LN2,R=h?Math.ceil(x/h)*h:x,te=n._limitZoom(r+(this._delta>0?R:-R))-r;this._delta=0,this._startTime=null,te&&(n.options.scrollWheelZoom==="center"?n.setZoom(r+te):n.setZoomAround(this._lastMousePos,r+te))}});nt.addInitHook("addHandler","scrollWheelZoom",Gu);var vv=600;nt.mergeOptions({tapHold:qe.touchNative&&qe.safari&&qe.mobile,tapTolerance:15});var Zu=Zn.extend({addHooks:function(){lt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){bt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var r=n.touches[0];this._startPos=this._newPos=new ve(r.clientX,r.clientY),this._holdTimeout=setTimeout(c(function(){this._cancel(),this._isTapValid()&&(lt(document,"touchend",Nt),lt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",r))},this),vv),lt(document,"touchend touchcancel contextmenu",this._cancel,this),lt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){bt(document,"touchend",Nt),bt(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),bt(document,"touchend touchcancel contextmenu",this._cancel,this),bt(document,"touchmove",this._onMove,this)},_onMove:function(n){var r=n.touches[0];this._newPos=new ve(r.clientX,r.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,r){var h=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:r.screenX,screenY:r.screenY,clientX:r.clientX,clientY:r.clientY});h._simulated=!0,r.target.dispatchEvent(h)}});nt.addInitHook("addHandler","tapHold",Zu),nt.mergeOptions({touchZoom:qe.touch,bounceAtZoomLimits:!0});var ju=Zn.extend({addHooks:function(){ct(this._map._container,"leaflet-touch-zoom"),lt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Mt(this._map._container,"leaflet-touch-zoom"),bt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var r=this._map;if(!(!n.touches||n.touches.length!==2||r._animatingZoom||this._zooming)){var h=r.mouseEventToContainerPoint(n.touches[0]),g=r.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=r.getSize()._divideBy(2),this._startLatLng=r.containerPointToLatLng(this._centerPoint),r.options.touchZoom!=="center"&&(this._pinchStartLatLng=r.containerPointToLatLng(h.add(g)._divideBy(2))),this._startDist=h.distanceTo(g),this._startZoom=r.getZoom(),this._moved=!1,this._zooming=!0,r._stop(),lt(document,"touchmove",this._onTouchMove,this),lt(document,"touchend touchcancel",this._onTouchEnd,this),Nt(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var r=this._map,h=r.mouseEventToContainerPoint(n.touches[0]),g=r.mouseEventToContainerPoint(n.touches[1]),x=h.distanceTo(g)/this._startDist;if(this._zoom=r.getScaleZoom(x,this._startZoom),!r.options.bounceAtZoomLimits&&(this._zoom<r.getMinZoom()&&x<1||this._zoom>r.getMaxZoom()&&x>1)&&(this._zoom=r._limitZoom(this._zoom)),r.options.touchZoom==="center"){if(this._center=this._startLatLng,x===1)return}else{var R=h._add(g)._divideBy(2)._subtract(this._centerPoint);if(x===1&&R.x===0&&R.y===0)return;this._center=r.unproject(r.project(this._pinchStartLatLng,this._zoom).subtract(R),this._zoom)}this._moved||(r._moveStart(!0,!1),this._moved=!0),se(this._animRequest);var te=c(r._move,r,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=K(te,this,!0),Nt(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,se(this._animRequest),bt(document,"touchmove",this._onTouchMove,this),bt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});nt.addInitHook("addHandler","touchZoom",ju),nt.BoxZoom=Uu,nt.DoubleClickZoom=zu,nt.Drag=Hu,nt.Keyboard=Vu,nt.ScrollWheelZoom=Gu,nt.TapHold=Zu,nt.TouchZoom=ju,o.Bounds=xe,o.Browser=qe,o.CRS=ue,o.Canvas=Ru,o.Circle=Fi,o.CircleMarker=Ni,o.Class=Re,o.Control=Cn,o.DivIcon=Pu,o.DivOverlay=Uo,o.DomEvent=st,o.DomUtil=ca,o.Draggable=Bo,o.Evented=he,o.FeatureGroup=no,o.GeoJSON=Ae,o.GridLayer=ma,o.Handler=Zn,o.Icon=Hs,o.ImageOverlay=Cr,o.LatLng=Me,o.LatLngBounds=re,o.Layer=jn,o.LayerGroup=as,o.LineUtil=Vl,o.Map=nt,o.Marker=Bi,o.Mixin=Nl,o.Path=No,o.Point=ve,o.PolyUtil=Fl,o.Polygon=le,o.Polyline=oo,o.Popup=Lr,o.PosAnimation=jt,o.Projection=Gl,o.Rectangle=Fu,o.Renderer=ls,o.SVG=ya,o.SVGOverlay=Eu,o.TileLayer=zi,o.Tooltip=Sr,o.Transformation=ie,o.Util=me,o.VideoOverlay=Au,o.bind=c,o.bounds=Be,o.canvas=Bu,o.circle=kr,o.circleMarker=fi,o.control=ns,o.divIcon=uv,o.extend=s,o.featureGroup=ql,o.geoJSON=Mu,o.geoJson=sv,o.gridLayer=dv,o.icon=Kl,o.imageOverlay=iv,o.latLng=$e,o.latLngBounds=Ee,o.layerGroup=Wl,o.map=Dn,o.marker=_r,o.point=fe,o.polygon=Ie,o.polyline=U,o.popup=lv,o.rectangle=pv,o.setOptions=S,o.stamp=d,o.svg=Nu,o.svgOverlay=rv,o.tileLayer=Du,o.tooltip=cv,o.transformation=B,o.version=i,o.videoOverlay=av;var mv=window.L;o.noConflict=function(){return window.L=mv,this},window.L=o}))})(Ia,Ia.exports)),Ia.exports}var aw=iw();const xn=ow(aw);(function(e,t,o){function i(s,a){for(;(s=s.parentElement)&&!s.classList.contains(a););return s}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(s,a){this._map=s,this._container=s._container,this._overlayPane=s._panes.overlayPane,this._popupPane=s._panes.popupPane,a&&a.shapeOptions&&(a.shapeOptions=L.Util.extend({},this.options.shapeOptions,a.shapeOptions)),L.setOptions(this,a);var c=L.version.split(".");parseInt(c[0],10)===1&&parseInt(c[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(L.DomUtil.disableTextSelection(),s.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(s){L.setOptions(this,s)},_fireCreatedEvent:function(s){this._map.fire(L.Draw.Event.CREATED,{layer:s,layerType:this.type})},_cancelDrawing:function(s){s.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(s,a){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,a&&a.drawError&&(a.drawError=L.Util.extend({},this.options.drawError,a.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var s=this._markers.pop(),a=this._poly,c=a.getLatLngs(),u=c.splice(-1,1)[0];this._poly.setLatLngs(c),this._markerGroup.removeLayer(s),a.getLatLngs().length<2&&this._map.removeLayer(a),this._vertexChanged(u,!1)}},addVertex:function(s){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(s))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(s)),this._poly.addLatLng(s),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(s,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var s=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),a=this._poly.newLatLngIntersects(s[s.length-1]);if(!this.options.allowIntersection&&a||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent),c=this._map.layerPointToLatLng(a);this._currentLatLng=c,this._updateTooltip(c),this._updateGuide(a),this._mouseMarker.setLatLng(c),L.DomEvent.preventDefault(s.originalEvent)},_vertexChanged:function(s,a){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(s,a),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(s){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(s),this._clickHandled=!0,this._disableNewMarkers();var a=s.originalEvent,c=a.clientX,u=a.clientY;this._startPoint.call(this,c,u)}},_startPoint:function(s,a){this._mouseDownOrigin=L.point(s,a)},_onMouseUp:function(s){var a=s.originalEvent,c=a.clientX,u=a.clientY;this._endPoint.call(this,c,u,s),this._clickHandled=null},_endPoint:function(s,a,c){if(this._mouseDownOrigin){var u=L.point(s,a).distanceTo(this._mouseDownOrigin),d=this._calculateFinishDistance(c.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(c.latlng),this._finishShape()):d<10&&L.Browser.touch?this._finishShape():Math.abs(u)<9*(e.devicePixelRatio||1)&&this.addVertex(c.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(s){var a,c,u=s.originalEvent;!u.touches||!u.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(a=u.touches[0].clientX,c=u.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,a,c),this._endPoint.call(this,a,c,s),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(s){var a;if(this._markers.length>0){var c;if(this.type===L.Draw.Polyline.TYPE)c=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;c=this._markers[0]}var u=this._map.latLngToContainerPoint(c.getLatLng()),d=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),p=this._map.latLngToContainerPoint(d.getLatLng());a=u.distanceTo(p)}else a=1/0;return a},_updateFinishHandler:function(){var s=this._markers.length;s>1&&this._markers[s-1].on("click",this._finishShape,this),s>2&&this._markers[s-2].off("click",this._finishShape,this)},_createMarker:function(s){var a=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(a),a},_updateGuide:function(s){var a=this._markers?this._markers.length:0;a>0&&(s=s||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[a-1].getLatLng()),s))},_updateTooltip:function(s){var a=this._getTooltipText();s&&this._tooltip.updatePosition(s),this._errorShown||this._tooltip.updateContent(a)},_drawGuide:function(s,a){var c,u,d,p=Math.floor(Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))),f=this.options.guidelineDistance,y=this.options.maxGuideLineLength,b=p>y?p-y:f;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));b<p;b+=this.options.guidelineDistance)c=b/p,u={x:Math.floor(s.x*(1-c)+c*a.x),y:Math.floor(s.y*(1-c)+c*a.y)},d=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),d.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(d,u)},_updateGuideColor:function(s){if(this._guidesContainer)for(var a=0,c=this._guidesContainer.childNodes.length;a<c;a++)this._guidesContainer.childNodes[a].style.backgroundColor=s},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var s,a,c=this.options.showLength;return this._markers.length===0?s={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(a=c?this._getMeasurementString():"",s=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:a}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:a}),s},_updateRunningMeasure:function(s,a){var c,u,d=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(c=d-(a?2:1),u=L.GeometryUtil.isVersion07x()?s.distanceTo(this._markers[c].getLatLng())*(this.options.factor||1):this._map.distance(s,this._markers[c].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=u*(a?1:-1))},_getMeasurementString:function(){var s,a=this._currentLatLng,c=this._markers[this._markers.length-1].getLatLng();return s=L.GeometryUtil.isVersion07x()?c&&a&&a.distanceTo?this._measurementRunningTotal+a.distanceTo(c)*(this.options.factor||1):this._measurementRunningTotal||0:c&&a?this._measurementRunningTotal+this._map.distance(a,c)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(s,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var s=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(s,a){L.Draw.Polyline.prototype.initialize.call(this,s,a),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var s=this._markers.length;s===1&&this._markers[0].on("click",this._finishShape,this),s>2&&(this._markers[s-1].on("dblclick",this._finishShape,this),s>3&&this._markers[s-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var s,a;return this._markers.length===0?s=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(s=L.drawLocal.draw.handlers.polygon.tooltip.cont,a=this._getMeasurementString()):(s=L.drawLocal.draw.handlers.polygon.tooltip.end,a=this._getMeasurementString()),{text:s,subtext:a}},_getMeasurementString:function(){var s=this._area,a="";return s||this.options.showLength?(this.options.showLength&&(a=L.Draw.Polyline.prototype._getMeasurementString.call(this)),s&&(a+="<br>"+L.GeometryUtil.readableArea(s,this.options.metric,this.options.precision)),a):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(s,a){var c;!this.options.allowIntersection&&this.options.showArea&&(c=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(c)),L.Draw.Polyline.prototype._vertexChanged.call(this,s,a)},_cleanUpShape:function(){var s=this._markers.length;s>0&&(this._markers[0].off("click",this._finishShape,this),s>2&&this._markers[s-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(s,a){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(s){this._isDrawing=!0,this._startLatLng=s.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(s.originalEvent)},_onMouseMove:function(s){var a=s.latlng;this._tooltip.updatePosition(a),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(a))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(s,a){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,a)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(s){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!i(s.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(s){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,s)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,s),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_getTooltipText:function(){var s,a,c,u=L.Draw.SimpleShape.prototype._getTooltipText.call(this),d=this._shape,p=this.options.showArea;return d&&(s=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),a=L.GeometryUtil.geodesicArea(s),c=p?L.GeometryUtil.readableArea(a,this.options.metric):""),{text:u.text,subtext:c}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(s,a){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(s){var a=s.latlng;this._tooltip.updatePosition(a),this._mouseMarker.setLatLng(a),this._marker?(a=this._mouseMarker.getLatLng(),this._marker.setLatLng(a)):(this._marker=this._createMarker(a),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(s){return new L.Marker(s,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(s){this._onMouseMove(s),this._onClick()},_fireCreatedEvent:function(){var s=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(s,a){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,a)},_fireCreatedEvent:function(){var s=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)},_createMarker:function(s){return new L.CircleMarker(s,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(s,a){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,a)},_drawShape:function(s){if(L.GeometryUtil.isVersion07x())var a=this._startLatLng.distanceTo(s);else var a=this._map.distance(this._startLatLng,s);this._shape?this._shape.setRadius(a):(this._shape=new L.Circle(this._startLatLng,a,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_onMouseMove:function(s){var a,c=s.latlng,u=this.options.showRadius,d=this.options.metric;if(this._tooltip.updatePosition(c),this._isDrawing){this._drawShape(c),a=this._shape.getRadius().toFixed(1);var p="";u&&(p=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(a,d,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:p})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(s,a){this._marker=s,L.setOptions(this,a)},addHooks:function(){var s=this._marker;s.dragging.enable(),s.on("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},removeHooks:function(){var s=this._marker;s.dragging.disable(),s.off("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},_onDragEnd:function(s){var a=s.target;a.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:a})},_toggleMarkerHighlight:function(){var s=this._marker._icon;s&&(s.style.display="none",L.DomUtil.hasClass(s,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,-4)):(L.DomUtil.addClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,4)),s.style.display="")},_offsetMarker:function(s,a){var c=parseInt(s.style.marginTop,10)-a,u=parseInt(s.style.marginLeft,10)-a;s.style.marginTop=c+"px",s.style.marginLeft=u+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(s){this.latlngs=[s._latlngs],s._holes&&(this.latlngs=this.latlngs.concat(s._holes)),this._poly=s,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(s){for(var a=0;a<this._verticesHandlers.length;a++)s(this._verticesHandlers[a])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(s){s.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(s){s.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(s){s.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var s=0;s<this.latlngs.length;s++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[s],this._poly.options.poly))},_updateLatLngs:function(s){this.latlngs=[s.layer._latlngs],s.layer._holes&&(this.latlngs=this.latlngs.concat(s.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(s,a,c){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=s,c&&c.drawError&&(c.drawError=L.Util.extend({},this.options.drawError,c.drawError)),this._latlngs=a,L.setOptions(this,c)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var s=this._poly,a=s._path;s instanceof L.Polygon||(s.options.fill=!1,s.options.editing&&(s.options.editing.fill=!1)),a&&s.options.editing&&s.options.editing.className&&(s.options.original.className&&s.options.original.className.split(" ").forEach(function(c){L.DomUtil.removeClass(a,c)}),s.options.editing.className.split(" ").forEach(function(c){L.DomUtil.addClass(a,c)})),s.setStyle(s.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var s=this._poly,a=s._path;a&&s.options.editing&&s.options.editing.className&&(s.options.editing.className.split(" ").forEach(function(c){L.DomUtil.removeClass(a,c)}),s.options.original.className&&s.options.original.className.split(" ").forEach(function(c){L.DomUtil.addClass(a,c)})),s.setStyle(s.options.original),s._map&&(s._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var s,a,c,u,d=this._defaultShape();for(s=0,c=d.length;s<c;s++)u=this._createMarker(d[s],s),u.on("click",this._onMarkerClick,this),u.on("contextmenu",this._onContextMenu,this),this._markers.push(u);var p,f;for(s=0,a=c-1;s<c;a=s++)(s!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(p=this._markers[a],f=this._markers[s],this._createMiddleMarker(p,f),this._updatePrevNext(p,f))},_createMarker:function(s,a){var c=new L.Marker.Touch(s,{draggable:!0,icon:this.options.icon});return c._origLatLng=s,c._index=a,c.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(c),c},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var s=this._defaultShape(),a=[].splice.apply(s,arguments);return this._poly._convertLatLngs(s,!0),this._poly.redraw(),a},_removeMarker:function(s){var a=s._index;this._markerGroup.removeLayer(s),this._markers.splice(a,1),this._spliceLatLngs(a,1),this._updateIndexes(a,-1),s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(s){var a=s.target,c=this._poly,u=L.LatLngUtil.cloneLatLng(a._origLatLng);if(L.extend(a._origLatLng,a._latlng),c.options.poly){var d=c._map._editTooltip;if(!c.options.poly.allowIntersection&&c.intersects()){L.extend(a._origLatLng,u),a.setLatLng(u);var p=c.options.color;c.setStyle({color:this.options.drawError.color}),d&&d.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){c.setStyle({color:p}),d&&d.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}a._middleLeft&&a._middleLeft.setLatLng(this._getMiddleLatLng(a._prev,a)),a._middleRight&&a._middleRight.setLatLng(this._getMiddleLatLng(a,a._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var f=this._poly.getLatLngs();this._poly._convertLatLngs(f,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(s){var a=L.Polygon&&this._poly instanceof L.Polygon?4:3,c=s.target;this._defaultShape().length<a||(this._removeMarker(c),this._updatePrevNext(c._prev,c._next),c._middleLeft&&this._markerGroup.removeLayer(c._middleLeft),c._middleRight&&this._markerGroup.removeLayer(c._middleRight),c._prev&&c._next?this._createMiddleMarker(c._prev,c._next):c._prev?c._next||(c._prev._middleRight=null):c._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(s){var a=s.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:a,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),c=this._map.layerPointToLatLng(a),u=s.target;L.extend(u._origLatLng,c),u._middleLeft&&u._middleLeft.setLatLng(this._getMiddleLatLng(u._prev,u)),u._middleRight&&u._middleRight.setLatLng(this._getMiddleLatLng(u,u._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(s,a){this._markerGroup.eachLayer(function(c){c._index>s&&(c._index+=a)})},_createMiddleMarker:function(s,a){var c,u,d,p=this._getMiddleLatLng(s,a),f=this._createMarker(p);f.setOpacity(.6),s._middleRight=a._middleLeft=f,u=function(){f.off("touchmove",u,this);var y=a._index;f._index=y,f.off("click",c,this).on("click",this._onMarkerClick,this),p.lat=f.getLatLng().lat,p.lng=f.getLatLng().lng,this._spliceLatLngs(y,0,p),this._markers.splice(y,0,f),f.setOpacity(1),this._updateIndexes(y,1),a._index++,this._updatePrevNext(s,f),this._updatePrevNext(f,a),this._poly.fire("editstart")},d=function(){f.off("dragstart",u,this),f.off("dragend",d,this),f.off("touchmove",u,this),this._createMiddleMarker(s,f),this._createMiddleMarker(f,a)},c=function(){u.call(this),d.call(this),this._fireEdit()},f.on("click",c,this).on("dragstart",u,this).on("dragend",d,this).on("touchmove",u,this),this._markerGroup.addLayer(f)},_updatePrevNext:function(s,a){s&&(s._next=a),a&&(a._prev=s)},_getMiddleLatLng:function(s,a){var c=this._poly._map,u=c.project(s.getLatLng()),d=c.project(a.getLatLng());return c.unproject(u._add(d)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(s,a){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=s,L.Util.setOptions(this,a)},addHooks:function(){var s=this._shape;this._shape._map&&(this._map=this._shape._map,s.setStyle(s.options.editing),s._map&&(this._map=s._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var s=this._shape;if(s.setStyle(s.options.original),s._map){this._unbindMarker(this._moveMarker);for(var a=0,c=this._resizeMarkers.length;a<c;a++)this._unbindMarker(this._resizeMarkers[a]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(s,a){var c=new L.Marker.Touch(s,{draggable:!0,icon:a,zIndexOffset:10});return this._bindMarker(c),this._markerGroup.addLayer(c),c},_bindMarker:function(s){s.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(s){s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(s){s.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(s){var a=s.target,c=a.getLatLng();a===this._moveMarker?this._move(c):this._resize(c),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(s){s.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(s){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s),typeof this._getCorners=="function"){var a=this._getCorners(),c=s.target,u=c._cornerIndex;c.setOpacity(0),this._oppositeCorner=a[(u+2)%4],this._toggleCornerMarkers(0,u)}this._shape.fire("editstart")},_onTouchMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),c=this._map.layerPointToLatLng(a);return s.target===this._moveMarker?this._move(c):this._resize(c),this._shape.redraw(),!1},_onTouchEnd:function(s){s.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getBounds(),a=s.getCenter();this._moveMarker=this._createMarker(a,this.options.moveIcon)},_createResizeMarker:function(){var s=this._getCorners();this._resizeMarkers=[];for(var a=0,c=s.length;a<c;a++)this._resizeMarkers.push(this._createMarker(s[a],this.options.resizeIcon)),this._resizeMarkers[a]._cornerIndex=a},_onMarkerDragStart:function(s){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s);var a=this._getCorners(),c=s.target,u=c._cornerIndex;this._oppositeCorner=a[(u+2)%4],this._toggleCornerMarkers(0,u)},_onMarkerDragEnd:function(s){var a,c,u=s.target;u===this._moveMarker&&(a=this._shape.getBounds(),c=a.getCenter(),u.setLatLng(c)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,s)},_move:function(s){for(var a,c=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),u=this._shape.getBounds(),d=u.getCenter(),p=[],f=0,y=c.length;f<y;f++)a=[c[f].lat-d.lat,c[f].lng-d.lng],p.push([s.lat+a[0],s.lng+a[1]]);this._shape.setLatLngs(p),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(s){var a;this._shape.setBounds(L.latLngBounds(s,this._oppositeCorner)),a=this._shape.getBounds(),this._moveMarker.setLatLng(a.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var s=this._shape.getBounds();return[s.getNorthWest(),s.getNorthEast(),s.getSouthEast(),s.getSouthWest()]},_toggleCornerMarkers:function(s){for(var a=0,c=this._resizeMarkers.length;a<c;a++)this._resizeMarkers[a].setOpacity(s)},_repositionCornerMarkers:function(){for(var s=this._getCorners(),a=0,c=this._resizeMarkers.length;a<c;a++)this._resizeMarkers[a].setLatLng(s[a])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getLatLng();this._moveMarker=this._createMarker(s,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(s){if(this._resizeMarkers.length){var a=this._getResizeMarkerPoint(s);this._resizeMarkers[0].setLatLng(a)}this._shape.setLatLng(s),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var s=this._shape.getLatLng(),a=this._getResizeMarkerPoint(s);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(a,this.options.resizeIcon))},_getResizeMarkerPoint:function(s){var a=this._shape._radius*Math.cos(Math.PI/4),c=this._map.project(s);return this._map.unproject([c.x+a,c.y-a])},_resize:function(s){var a=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=a.distanceTo(s):radius=this._map.distance(a,s),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(s,a){var c={};if(s.touches!==void 0){if(!s.touches.length)return;c=s.touches[0]}else if(s.pointerType!=="touch"||(c=s,!this._filterClick(s)))return;var u=this._map.mouseEventToContainerPoint(c),d=this._map.mouseEventToLayerPoint(c),p=this._map.layerPointToLatLng(d);this._map.fire(a,{latlng:p,layerPoint:d,containerPoint:u,pageX:c.pageX,pageY:c.pageY,originalEvent:s})},_filterClick:function(s){var a=s.timeStamp||s.originalEvent.timeStamp,c=L.DomEvent._lastClick&&a-L.DomEvent._lastClick;return c&&c>100&&c<500||s.target._simulatedClick&&!s._simulated?(L.DomEvent.stop(s),!1):(L.DomEvent._lastClick=a,!0)},_onTouchStart:function(s){this._map._loaded&&this._touchEvent(s,"touchstart")},_onTouchEnd:function(s){this._map._loaded&&this._touchEvent(s,"touchend")},_onTouchCancel:function(s){if(this._map._loaded){var a="touchcancel";this._detectIE()&&(a="pointercancel"),this._touchEvent(s,a)}},_onTouchLeave:function(s){this._map._loaded&&this._touchEvent(s,"touchleave")},_onTouchMove:function(s){this._map._loaded&&this._touchEvent(s,"touchmove")},_detectIE:function(){var s=e.navigator.userAgent,a=s.indexOf("MSIE ");if(a>0)return parseInt(s.substring(a+5,s.indexOf(".",a)),10);if(s.indexOf("Trident/")>0){var c=s.indexOf("rv:");return parseInt(s.substring(c+3,s.indexOf(".",c)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var s=this._icon,a=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?a.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):a.concat(["touchcancel"]),L.DomUtil.addClass(s,"leaflet-clickable"),L.DomEvent.on(s,"click",this._onMouseClick,this),L.DomEvent.on(s,"keypress",this._onKeyPress,this);for(var c=0;c<a.length;c++)L.DomEvent.on(s,a[c],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var s=e.navigator.userAgent,a=s.indexOf("MSIE ");if(a>0)return parseInt(s.substring(a+5,s.indexOf(".",a)),10);if(s.indexOf("Trident/")>0){var c=s.indexOf("rv:");return parseInt(s.substring(c+3,s.indexOf(".",c)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.LatLngUtil={cloneLatLngs:function(s){for(var a=[],c=0,u=s.length;c<u;c++)Array.isArray(s[c])?a.push(L.LatLngUtil.cloneLatLngs(s[c])):a.push(this.cloneLatLng(s[c]));return a},cloneLatLng:function(s){return L.latLng(s.lat,s.lng)}},(function(){var s={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(a){var c,u,d=a.length,p=0,f=Math.PI/180;if(d>2){for(var y=0;y<d;y++)c=a[y],u=a[(y+1)%d],p+=(u.lng-c.lng)*f*(2+Math.sin(c.lat*f)+Math.sin(u.lat*f));p=6378137*p*6378137/2}return Math.abs(p)},formattedNumber:function(a,c){var u=parseFloat(a).toFixed(c),d=L.drawLocal.format&&L.drawLocal.format.numeric,p=d&&d.delimiters,f=p&&p.thousands,y=p&&p.decimal;if(f||y){var b=u.split(".");u=f?b[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+f):b[0],y=y||".",b.length>1&&(u=u+y+b[1])}return u},readableArea:function(a,c,f){var d,p,f=L.Util.extend({},s,f);return c?(p=["ha","m"],type=typeof c,type==="string"?p=[c]:type!=="boolean"&&(p=c),d=a>=1e6&&p.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*a,f.km)+" km":a>=1e4&&p.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*a,f.ha)+" ha":L.GeometryUtil.formattedNumber(a,f.m)+" m"):(a/=.836127,d=a>=3097600?L.GeometryUtil.formattedNumber(a/3097600,f.mi)+" mi":a>=4840?L.GeometryUtil.formattedNumber(a/4840,f.ac)+" acres":L.GeometryUtil.formattedNumber(a,f.yd)+" yd"),d},readableDistance:function(a,c,u,d,y){var f,y=L.Util.extend({},s,y);switch(c?typeof c=="string"?c:"metric":u?"feet":d?"nauticalMile":"yards"){case"metric":f=a>1e3?L.GeometryUtil.formattedNumber(a/1e3,y.km)+" km":L.GeometryUtil.formattedNumber(a,y.m)+" m";break;case"feet":a*=3.28083,f=L.GeometryUtil.formattedNumber(a,y.ft)+" ft";break;case"nauticalMile":a*=.53996,f=L.GeometryUtil.formattedNumber(a/1e3,y.nm)+" nm";break;default:a*=1.09361,f=a>1760?L.GeometryUtil.formattedNumber(a/1760,y.mi)+" miles":L.GeometryUtil.formattedNumber(a,y.yd)+" yd"}return f},isVersion07x:function(){var a=L.version.split(".");return parseInt(a[0],10)===0&&parseInt(a[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(s,a,c,u){return this._checkCounterclockwise(s,c,u)!==this._checkCounterclockwise(a,c,u)&&this._checkCounterclockwise(s,a,c)!==this._checkCounterclockwise(s,a,u)},_checkCounterclockwise:function(s,a,c){return(c.y-s.y)*(a.x-s.x)>(a.y-s.y)*(c.x-s.x)}}),L.Polyline.include({intersects:function(){var s,a,c,u=this._getProjectedPoints(),d=u?u.length:0;if(this._tooFewPointsForIntersection())return!1;for(s=d-1;s>=3;s--)if(a=u[s-1],c=u[s],this._lineSegmentsIntersectsRange(a,c,s-2))return!0;return!1},newLatLngIntersects:function(s,a){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(s),a)},newPointIntersects:function(s,a){var c=this._getProjectedPoints(),u=c?c.length:0,d=c?c[u-1]:null,p=u-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(d,s,p,a?1:0)},_tooFewPointsForIntersection:function(s){var a=this._getProjectedPoints(),c=a?a.length:0;return c+=s||0,!a||c<=3},_lineSegmentsIntersectsRange:function(s,a,c,u){var d,p,f=this._getProjectedPoints();u=u||0;for(var y=c;y>u;y--)if(d=f[y-1],p=f[y],L.LineUtil.segmentsIntersect(s,a,d,p))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var s=[],a=this._defaultShape(),c=0;c<a.length;c++)s.push(this._map.latLngToLayerPoint(a[c]));return s}}),L.Polygon.include({intersects:function(){var s,a,c,u,d=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(s=d.length,a=d[0],c=d[s-1],u=s-2,this._lineSegmentsIntersectsRange(c,a,u,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(s){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,s);var a;this._toolbars={},L.DrawToolbar&&this.options.draw&&(a=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=a,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(a=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=a,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(s){var a,c=L.DomUtil.create("div","leaflet-draw"),u=!1;for(var d in this._toolbars)this._toolbars.hasOwnProperty(d)&&(a=this._toolbars[d].addToolbar(s))&&(u||(L.DomUtil.hasClass(a,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(a.childNodes[0],"leaflet-draw-toolbar-top"),u=!0),c.appendChild(a));return c},onRemove:function(){for(var s in this._toolbars)this._toolbars.hasOwnProperty(s)&&this._toolbars[s].removeToolbar()},setDrawingOptions:function(s){for(var a in this._toolbars)this._toolbars[a]instanceof L.DrawToolbar&&this._toolbars[a].setOptions(s)},_toolbarEnabled:function(s){var a=s.target;for(var c in this._toolbars)this._toolbars[c]!==a&&this._toolbars[c].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(s){L.setOptions(this,s),this._modes={},this._actionButtons=[],this._activeMode=null;var a=L.version.split(".");parseInt(a[0],10)===1&&parseInt(a[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(s){var a,c=L.DomUtil.create("div","leaflet-draw-section"),u=0,d=this._toolbarClass||"",p=this.getModeHandlers(s);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=s,a=0;a<p.length;a++)p[a].enabled&&this._initModeHandler(p[a].handler,this._toolbarContainer,u++,d,p[a].title);if(u)return this._lastButtonIndex=--u,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),c.appendChild(this._toolbarContainer),c.appendChild(this._actionsContainer),c},removeToolbar:function(){for(var s in this._modes)this._modes.hasOwnProperty(s)&&(this._disposeButton(this._modes[s].button,this._modes[s].handler.enable,this._modes[s].handler),this._modes[s].handler.disable(),this._modes[s].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var a=0,c=this._actionButtons.length;a<c;a++)this._disposeButton(this._actionButtons[a].button,this._actionButtons[a].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(s,a,c,u,d){var p=s.type;this._modes[p]={},this._modes[p].handler=s,this._modes[p].button=this._createButton({type:p,title:d,className:u+"-"+p,container:a,callback:this._modes[p].handler.enable,context:this._modes[p].handler}),this._modes[p].buttonIndex=c,this._modes[p].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(s){var a=L.DomUtil.create("a",s.className||"",s.container),c=L.DomUtil.create("span","sr-only",s.container);a.href="#",a.appendChild(c),s.title&&(a.title=s.title,c.innerHTML=s.title),s.text&&(a.innerHTML=s.text,c.innerHTML=s.text);var u=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(a,"click",L.DomEvent.stopPropagation).on(a,"mousedown",L.DomEvent.stopPropagation).on(a,"dblclick",L.DomEvent.stopPropagation).on(a,"touchstart",L.DomEvent.stopPropagation).on(a,"click",L.DomEvent.preventDefault).on(a,u,s.callback,s.context),a},_disposeButton:function(s,a){var c=this._detectIOS()?"touchstart":"click";L.DomEvent.off(s,"click",L.DomEvent.stopPropagation).off(s,"mousedown",L.DomEvent.stopPropagation).off(s,"dblclick",L.DomEvent.stopPropagation).off(s,"touchstart",L.DomEvent.stopPropagation).off(s,"click",L.DomEvent.preventDefault).off(s,c,a)},_handlerActivated:function(s){this.disable(),this._activeMode=this._modes[s.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(s){var a,c,u,d,p=this._actionsContainer,f=this.getActions(s),y=f.length;for(c=0,u=this._actionButtons.length;c<u;c++)this._disposeButton(this._actionButtons[c].button,this._actionButtons[c].callback);for(this._actionButtons=[];p.firstChild;)p.removeChild(p.firstChild);for(var b=0;b<y;b++)"enabled"in f[b]&&!f[b].enabled||(a=L.DomUtil.create("li","",p),d=this._createButton({title:f[b].title,text:f[b].text,container:a,callback:f[b].callback,context:f[b].context}),this._actionButtons.push({button:d,callback:f[b].callback}))},_showActionsToolbar:function(){var s=this._activeMode.buttonIndex,a=this._lastButtonIndex,c=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=c+"px",s===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),s===a&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(s){this._map=s,this._popupPane=s._panes.popupPane,this._visible=!1,this._container=s.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(s){return this._container?(s.subtext=s.subtext||"",s.subtext.length!==0||this._singleLineLabel?s.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(s.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+s.subtext+"</span><br />":"")+"<span>"+s.text+"</span>",s.text||s.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(s){var a=this._map.latLngToLayerPoint(s),c=this._container;return this._container&&(this._visible&&(c.style.visibility="inherit"),L.DomUtil.setPosition(c,a)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(s){for(var a in this.options)this.options.hasOwnProperty(a)&&s[a]&&(s[a]=L.extend({},this.options[a],s[a]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,s)},getModeHandlers:function(s){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(s,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(s,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(s,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(s,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(s,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(s,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(s){return[{enabled:s.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:s.completeShape,context:s},{enabled:s.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:s.deleteLastVertex,context:s},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(s){L.setOptions(this,s);for(var a in this._modes)this._modes.hasOwnProperty(a)&&s.hasOwnProperty(a)&&this._modes[a].handler.setOptions(s[a])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(s){s.edit&&(s.edit.selectedPathOptions===void 0&&(s.edit.selectedPathOptions=this.options.edit.selectedPathOptions),s.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,s.edit.selectedPathOptions)),s.remove&&(s.remove=L.extend({},this.options.remove,s.remove)),s.poly&&(s.poly=L.extend({},this.options.poly,s.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,s),this._selectedFeatureCount=0},getModeHandlers:function(s){var a=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(s,{featureGroup:a,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(s,{featureGroup:a}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(s){var a=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return s.removeAllLayers&&a.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),a},addToolbar:function(s){var a=L.Toolbar.prototype.addToolbar.call(this,s);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),a},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var s,a=this.options.featureGroup,c=a.getLayers().length!==0;this.options.edit&&(s=this._modes[L.EditToolbar.Edit.TYPE].button,c?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",c?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(s=this._modes[L.EditToolbar.Delete.TYPE].button,c?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",c?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(s,a){if(L.Handler.prototype.initialize.call(this,s),L.setOptions(this,a),this._featureGroup=a.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var c=L.version.split(".");parseInt(c[0],10)===1&&parseInt(c[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),s._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(s){this._revertLayer(s)},this)},save:function(){var s=new L.LayerGroup;this._featureGroup.eachLayer(function(a){a.edited&&(s.addLayer(a),a.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:s})},_backupLayer:function(s){var a=L.Util.stamp(s);this._uneditedLayerProps[a]||(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?this._uneditedLayerProps[a]={latlngs:L.LatLngUtil.cloneLatLngs(s.getLatLngs())}:s instanceof L.Circle?this._uneditedLayerProps[a]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng()),radius:s.getRadius()}:(s instanceof L.Marker||s instanceof L.CircleMarker)&&(this._uneditedLayerProps[a]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(s){var a=L.Util.stamp(s);s.edited=!1,this._uneditedLayerProps.hasOwnProperty(a)&&(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?s.setLatLngs(this._uneditedLayerProps[a].latlngs):s instanceof L.Circle?(s.setLatLng(this._uneditedLayerProps[a].latlng),s.setRadius(this._uneditedLayerProps[a].radius)):(s instanceof L.Marker||s instanceof L.CircleMarker)&&s.setLatLng(this._uneditedLayerProps[a].latlng),s.fire("revert-edited",{layer:s}))},_enableLayerEdit:function(s){var a,c,u=s.layer||s.target||s;this._backupLayer(u),this.options.poly&&(c=L.Util.extend({},this.options.poly),u.options.poly=c),this.options.selectedPathOptions&&(a=L.Util.extend({},this.options.selectedPathOptions),a.maintainColor&&(a.color=u.options.color,a.fillColor=u.options.fillColor),u.options.original=L.extend({},u.options),u.options.editing=a),u instanceof L.Marker?(u.editing&&u.editing.enable(),u.dragging.enable(),u.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):u.editing.enable()},_disableLayerEdit:function(s){var a=s.layer||s.target||s;a.edited=!1,a.editing&&a.editing.disable(),delete a.options.editing,delete a.options.original,this._selectedPathOptions&&(a instanceof L.Marker?this._toggleMarkerHighlight(a):(a.setStyle(a.options.previousOptions),delete a.options.previousOptions)),a instanceof L.Marker?(a.dragging.disable(),a.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):a.editing.disable()},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_onMarkerDragEnd:function(s){var a=s.target;a.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:a})},_onTouchMove:function(s){var a=s.originalEvent.changedTouches[0],c=this._map.mouseEventToLayerPoint(a),u=this._map.layerPointToLatLng(c);s.target.setLatLng(u)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(s,a){if(L.Handler.prototype.initialize.call(this,s),L.Util.setOptions(this,a),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var c=L.version.split(".");parseInt(c[0],10)===1&&parseInt(c[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(s){this._deletableLayers.addLayer(s),s.fire("revert-deleted",{layer:s})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(s){this._removeLayer({layer:s})},this),this.save()},_enableLayerDelete:function(s){(s.layer||s.target||s).on("click",this._removeLayer,this)},_disableLayerDelete:function(s){var a=s.layer||s.target||s;a.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(a)},_removeLayer:function(s){var a=s.layer||s.target||s;this._deletableLayers.removeLayer(a),this._deletedLayers.addLayer(a),a.fire("deleted")},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const qp=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"",Ch=e=>e.length*6+12,kc=(e,t)=>!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom),rw=(e,t)=>{if(!e||t.length===0)return new Set;const o=[],i=e.getBounds();t.forEach(c=>{if(i.contains(c.getLatLng())){const u=e.latLngToContainerPoint(c.getLatLng()),d=c.locationData;d&&o.push({marker:c,pixelPos:u,location:d})}});const s=o.map(({marker:c,pixelPos:u,location:d})=>{const y=Ch(d.name),b=d.description?Ch(`${d.name}: ${qp(d.description,50)}`):y;return{marker:c,location:d,markerBox:{left:u.x-15,right:u.x+15,top:u.y-15,bottom:u.y+15},baseLabelBox:{left:u.x-y/2,right:u.x+y/2,top:u.y+15+2,bottom:u.y+15+2+20},descLabelBox:d.description?{left:u.x-b/2,right:u.x+b/2,top:u.y+15+2,bottom:u.y+15+2+20}:null}}),a=new Set;return s.forEach(({marker:c,location:u,markerBox:d,baseLabelBox:p,descLabelBox:f},y)=>{if(!u.description)return;let b=!1;for(let I=0;I<s.length;I++){if(y===I)continue;const T=s[I];if(kc(f,T.markerBox)||kc(f,T.baseLabelBox)){b=!0;break}if(T.descLabelBox&&a.has(T.location.id)&&kc(f,T.descLabelBox)){b=!0;break}}b||a.add(u.id)}),a},Or=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"hexagon",label:"Hexagon"},{value:"pentagon",label:"Pentagon"},{value:"diamond",label:"Diamond"},{value:"star",label:"Star"},{value:"dot",label:"Dot"},{value:"none",label:"None"}],lw=[{value:"33",label:"Small (33%)"},{value:"66",label:"Medium (66%)"},{value:"100",label:"Normal (100%)"},{value:"150",label:"Large (150%)"}],al=[{value:"default",label:"Default",isShapeOnly:!1,category:"default"},{value:"dot",label:"Dot",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"circle",label:"Circle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"square",label:"Square",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"triangle",label:"Triangle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"diamond",label:"Diamond",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"star",label:"Star",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"hexagon",label:"Hexagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"pentagon",label:"Pentagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"car",label:"Car",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"bike",label:"Bike",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"water",label:"Water",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"food",label:"Food",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"medical",label:"Medical",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"photo",label:"Photo",isShapeOnly:!1,category:"content",defaultColor:"#8B5CF6"},{value:"music",label:"Music",isShapeOnly:!1,category:"content",defaultColor:"#EC4899"},{value:"start",label:"Start",isShapeOnly:!1,category:"content",defaultColor:"#10B981"},{value:"finish",label:"Finish",isShapeOnly:!1,category:"content",defaultColor:"#1F2937"},{value:"toilet",label:"Toilet",isShapeOnly:!1,category:"content",defaultColor:"#6366F1"},{value:"shower",label:"Shower",isShapeOnly:!1,category:"content",defaultColor:"#06B6D4"},{value:"bus",label:"Bus",isShapeOnly:!1,category:"content",defaultColor:"#F97316"},{value:"info",label:"Information",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"merch",label:"Merchandise",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"cone",label:"Road closure",isShapeOnly:!1,category:"content",defaultColor:"#FF6B00"},{value:"traffic",label:"Traffic management",isShapeOnly:!1,category:"content",defaultColor:"#374151"},{value:"track",label:"Track",isShapeOnly:!1,category:"content",defaultColor:"#78716C"},{value:"tunnel",label:"Tunnel",isShapeOnly:!1,category:"content",defaultColor:"#57534E"},{value:"bridge",label:"Bridge",isShapeOnly:!1,category:"content",defaultColor:"#0284C7"},{value:"plane",label:"Plane",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"hill",label:"Hill",isShapeOnly:!1,category:"content",defaultColor:"#65A30D"},{value:"baggage",label:"Baggage",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"crown",label:"Crown",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"crossing",label:"Crossing point",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"trees",label:"Trees",isShapeOnly:!1,category:"content",defaultColor:"#22C55E"},{value:"arrow-uturn-left",label:"Left u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-left",label:"Left turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-left",label:"Slight left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-straight",label:"Straight ahead",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-right",label:"Slight right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-right",label:"Right turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-uturn-right",label:"Right u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-left",label:"Left fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-right",label:"Right fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-left",label:"Keep left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-right",label:"Keep right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"}];function Mi(e){return al.find(t=>t.value===e)||al[0]}function cw(e){return Mi(e).defaultColor||"#667eea"}function uw(e,t){return t||cw(e)}const qc={dot:(e,t=32)=>{const o=(t/2-2)*.33;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="1.5"/>
    </svg>`},circle:(e,t=32)=>{const o=t/2-2;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`},square:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect x="4" y="4" width="${t-8}" height="${t-8}" rx="4" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`,triangle:(e,t=32)=>{const o=t/2,i=4,s=t-4,a=4,c=t-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${i} ${c},${s} ${a},${s}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},diamond:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${i-s} ${o+s},${i} ${o},${i+s} ${o-s},${i}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},star:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-3,a=s*.4,c=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;c.push(`${o+s*Math.cos(d)},${i+s*Math.sin(d)}`);const p=d+Math.PI/5;c.push(`${o+a*Math.cos(p)},${i+a*Math.sin(p)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${c.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},hexagon:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4,a=[];for(let c=0;c<6;c++){const u=Math.PI/6+c*Math.PI/3;a.push(`${o+s*Math.cos(u)},${i+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${a.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},pentagon:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4,a=[];for(let c=0;c<5;c++){const u=Math.PI/2*-1+c*2*Math.PI/5;a.push(`${o+s*Math.cos(u)},${i+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${a.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},car:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Car body -->
      <rect x="6" y="13" width="20" height="8" rx="2" fill="#fff"/>
      <!-- Car roof/cabin -->
      <path d="M10 13 L12 9 L20 9 L22 13" fill="#fff" stroke="#fff" stroke-width="1"/>
      <!-- Windows -->
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${e}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${e}"/>
      <!-- Tires (always black) -->
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <!-- Wheel centers -->
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>
    </svg>`,bike:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Tires (same color as bike) -->
      <circle cx="9" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <!-- Wheel centers -->
      <circle cx="9" cy="20" r="1" fill="#fff"/>
      <circle cx="23" cy="20" r="1" fill="#fff"/>
      <!-- Frame -->
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
      <!-- Handlebars -->
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <!-- Seat -->
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="#fff"/>
    </svg>`},Lh={water:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="#fff"/>
    </svg>`,food:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="#fff"/>
      <path d="M21 9v14h2V9h-2z" fill="#fff"/>
    </svg>`,medical:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#fff" stroke-width="2"/>
      <rect x="14" y="8" width="4" height="16" rx="1" fill="#fff"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="#fff"/>
    </svg>`,photo:(e=32)=>{const t="#8B5CF6";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="8" y="10" width="16" height="12" rx="2" fill="#fff"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" y="13" r="1" fill="${t}"/>
    </svg>`},music:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EC4899" stroke="#fff" stroke-width="2"/>
      <path d="M12 22c1.66 0 3-1.34 3-3v-9h5v4h-3v5c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.35 0 .69.07 1 .18V10c0-.55.45-1 1-1h5c.55 0 1 .45 1 1v6h-5v5c0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.7 0 1.37.15 2 .41" fill="#fff"/>
      <ellipse cx="12" cy="21" rx="2.5" ry="2" fill="#fff"/>
      <rect x="14" y="10" width="2" height="9" fill="#fff"/>
      <rect x="14" y="10" width="6" height="2" fill="#fff"/>
    </svg>`,start:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#10B981" stroke="#fff" stroke-width="2"/>
      <path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="#fff"/>
    </svg>`,finish:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#1F2937" stroke="#fff" stroke-width="2"/>
      <rect x="10" y="8" width="4" height="4" fill="#fff"/>
      <rect x="14" y="12" width="4" height="4" fill="#fff"/>
      <rect x="18" y="8" width="4" height="4" fill="#fff"/>
      <rect x="10" y="16" width="4" height="4" fill="#fff"/>
      <rect x="18" y="16" width="4" height="4" fill="#fff"/>
      <rect x="14" y="20" width="4" height="4" fill="#fff"/>
    </svg>`,toilet:(e=32)=>{const t="#6366F1";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="11" y="7" width="10" height="3" rx="1" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>
    </svg>`},shower:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#06B6D4" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="3" fill="#fff"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="#fff"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
    </svg>`,bus:(e=32)=>{const t="#F97316";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="9" y="9" width="14" height="12" rx="2" fill="#fff"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="#fff"/>
      <circle cx="12" cy="21" r="1.5" fill="#fff"/>
      <circle cx="20" cy="21" r="1.5" fill="#fff"/>
    </svg>`},info:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#0EA5E9" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="2" fill="#fff"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="#fff"/>
    </svg>`,merch:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#A855F7" stroke="#fff" stroke-width="2"/>
      <path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="#fff"/>
      <path d="M13 10 L16 7 L19 10" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>`,cone:(e=32)=>{const t="#FF6B00";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L21 22 H11 L16 6Z" fill="#fff"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="#fff"/>
    </svg>`},traffic:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#374151" stroke="#fff" stroke-width="2"/>
      <rect x="12" y="6" width="8" height="20" rx="2" fill="#fff"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>
    </svg>`,crown:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="#fff"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="#fff"/>
    </svg>`,crossing:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="#fff" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="#fff" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="#fff"/>
      <path d="M16 10 L16 16" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
    </svg>`,trees:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#22C55E" stroke="#fff" stroke-width="2"/>
      <!-- Left tree -->
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="#fff"/>
      <!-- Right tree -->
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="#fff"/>
    </svg>`,"arrow-uturn-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on right, curve left, down on left -->
      <path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on left side -->
      <path d="M7 15 L12 21 L17 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="#fff"/>
    </svg>`,"arrow-slight-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-straight":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
    </svg>`,"arrow-slight-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="#fff"/>
    </svg>`,"arrow-uturn-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on left, curve right, down on right -->
      <path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on right side -->
      <path d="M15 15 L20 21 L25 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-fork-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (correct way - with arrow) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M10 12 L6 10 L8 16 Z" fill="#fff"/>
      <!-- Right fork (wrong way - with X) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
    </svg>`,"arrow-fork-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (wrong way - with X) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <!-- Right fork (correct way - with arrow) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M22 12 L26 10 L24 16 Z" fill="#fff"/>
    </svg>`,"arrow-keep-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-keep-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`},Ki={circle:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="14" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,square:({backgroundColor:e,borderColor:t})=>`<rect x="4" y="4" width="24" height="24" rx="4" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,hexagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=[];for(let a=0;a<6;a++){const c=Math.PI/6+a*Math.PI/3;s.push(`${16+12*Math.cos(c)},${16+12*Math.sin(c)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},pentagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=[];for(let a=0;a<5;a++){const c=Math.PI/2*-1+a*2*Math.PI/5;s.push(`${16+12*Math.cos(c)},${16+12*Math.sin(c)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},diamond:({backgroundColor:e,borderColor:t})=>`<polygon points="16,4 28,16 16,28 4,16" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}" stroke-linejoin="round"/>`,star:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=13,a=s*.4,c=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;c.push(`${16+s*Math.cos(d)},${16+s*Math.sin(d)}`);const p=d+Math.PI/5;c.push(`${16+a*Math.cos(p)},${16+a*Math.sin(p)}`)}return`<polygon points="${c.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},dot:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="5" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:1.5}"/>`,none:()=>""},Sh={water:(e="#fff")=>`<path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="${e}"/>`,food:(e="#fff")=>`<path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="${e}"/>
      <path d="M21 9v14h2V9h-2z" fill="${e}"/>`,medical:(e="#fff")=>`<rect x="14" y="8" width="4" height="16" rx="1" fill="${e}"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="${e}"/>`,photo:(e="#fff",t="#667eea")=>`<rect x="8" y="10" width="16" height="12" rx="2" fill="${e}"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" cy="13" r="1" fill="${t}"/>`,music:(e="#fff")=>`<ellipse cx="12" cy="21" rx="2.5" ry="2" fill="${e}"/>
      <rect x="14" y="10" width="2" height="9" fill="${e}"/>
      <rect x="14" y="10" width="6" height="2" fill="${e}"/>`,start:(e="#fff")=>`<path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="${e}"/>`,finish:(e="#fff")=>`<rect x="10" y="8" width="4" height="4" fill="${e}"/>
      <rect x="14" y="12" width="4" height="4" fill="${e}"/>
      <rect x="18" y="8" width="4" height="4" fill="${e}"/>
      <rect x="10" y="16" width="4" height="4" fill="${e}"/>
      <rect x="18" y="16" width="4" height="4" fill="${e}"/>
      <rect x="14" y="20" width="4" height="4" fill="${e}"/>`,toilet:(e="#fff",t="#667eea")=>`<rect x="11" y="7" width="10" height="3" rx="1" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="${e}" stroke-width="2" fill="none" stroke-linecap="round"/>`,shower:(e="#fff")=>`<circle cx="16" cy="10" r="3" fill="${e}"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="${e}"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>`,bus:(e="#fff",t="#667eea")=>`<rect x="9" y="9" width="14" height="12" rx="2" fill="${e}"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="${e}"/>
      <circle cx="12" cy="21" r="1.5" fill="${e}"/>
      <circle cx="20" cy="21" r="1.5" fill="${e}"/>`,info:(e="#fff")=>`<circle cx="16" cy="10" r="2" fill="${e}"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="${e}"/>`,merch:(e="#fff")=>`<path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="${e}"/>
      <path d="M13 10 L16 7 L19 10" stroke="${e}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`,cone:(e="#fff",t="#667eea")=>`<path d="M16 6 L21 22 H11 L16 6Z" fill="${e}"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="${e}"/>`,traffic:(e="#fff")=>`<rect x="12" y="6" width="8" height="20" rx="2" fill="${e}"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>`,car:(e="#fff",t="#667eea")=>`<rect x="6" y="13" width="20" height="8" rx="2" fill="${e}"/>
      <path d="M10 13 L12 9 L20 9 L22 13" fill="${e}" stroke="${e}" stroke-width="1"/>
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${t}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${t}"/>
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>`,bike:(e="#fff")=>`<circle cx="9" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="9" cy="20" r="1" fill="${e}"/>
      <circle cx="23" cy="20" r="1" fill="${e}"/>
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="${e}" stroke-width="2" stroke-linejoin="round"/>
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="${e}"/>`,"arrow-uturn-left":(e="#fff")=>`<path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7 15 L12 21 L17 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-left":(e="#fff")=>`<path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="${e}"/>`,"arrow-slight-left":(e="#fff")=>`<g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-straight":(e="#fff")=>`<path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>`,"arrow-slight-right":(e="#fff")=>`<g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-right":(e="#fff")=>`<path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="${e}"/>`,"arrow-uturn-right":(e="#fff")=>`<path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 15 L20 21 L25 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-fork-left":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Left arrowhead -->
      <path d="M10 12 L6 10 L8 16 Z" fill="${e}"/>
      <!-- Wrong way indicator on right -->
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>`,"arrow-fork-right":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <!-- Wrong way indicator on left -->
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Right arrowhead -->
      <path d="M22 12 L26 10 L24 16 Z" fill="${e}"/>`,"arrow-keep-left":(e="#fff")=>`<g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-keep-right":(e="#fff")=>`<g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,track:(e="#fff")=>`
      <rect x="10" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="19.5" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="8" y="9" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="14.5" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="20" width="16" height="2.5" rx="0.5" fill="${e}"/>`,tunnel:(e="#fff")=>`
      <path d="M7 25 L7 14 C7 8 11 5 16 5 C21 5 25 8 25 14 L25 25" fill="none" stroke="${e}" stroke-width="2.5"/>
      <path d="M11 25 L11 16 C11 12 13 10 16 10 C19 10 21 12 21 16 L21 25" fill="none" stroke="${e}" stroke-width="1.5" opacity="0.6"/>`,bridge:(e="#fff")=>`
      <rect x="5" y="18" width="22" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="7" y="10" width="2" height="8" fill="${e}"/>
      <rect x="23" y="10" width="2" height="8" fill="${e}"/>
      <path d="M8 10 Q16 6 24 10" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <line x1="12" y1="13" x2="12" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="16" y1="11.5" x2="16" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="20" y1="13" x2="20" y2="18" stroke="${e}" stroke-width="1.5"/>`,plane:(e="#fff")=>`
      <g fill="${e}">
        <!-- Fuselage body -->
        <path d="M27 16 L24 14 L8 14 Q4 16 8 18 L24 18 L27 16 Z"/>
        <!-- Nose cone -->
        <path d="M8 14 Q4 16 8 18 L8 14 Z"/>
        <!-- Tail fin -->
        <path d="M26 14 L26 9 L22 14 Z"/>
        <!-- Main wing -->
        <path d="M20 16 L16 10 L14 10 L16 16 L14 22 L16 22 L20 16 Z"/>
        <!-- Cockpit window -->
        <ellipse cx="10" cy="16" rx="1.5" ry="1" fill="none" stroke="${e}" stroke-width="0.5" opacity="0.6"/>
      </g>`,hill:(e="#fff")=>`
      <path d="M6 24 L13 12 L16 16 L20 10 L26 24 Z" fill="${e}"/>
      <path d="M20 10 L22 13 L18 13 Z" fill="${e}" opacity="0.6"/>`,baggage:(e="#fff")=>`
      <rect x="8" y="12" width="16" height="12" rx="2" fill="${e}"/>
      <rect x="12" y="8" width="8" height="4" rx="1" fill="none" stroke="${e}" stroke-width="2"/>
      <line x1="12" y1="16" x2="20" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
      <line x1="12" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>`,crown:(e="#fff")=>`
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="${e}"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="${e}"/>`,crossing:(e="#fff")=>`
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="${e}" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="${e}" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="${e}"/>
      <path d="M16 10 L16 16" stroke="${e}" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>`,trees:(e="#fff")=>`
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="${e}"/>
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="${e}"/>`};function Xt({type:e,backgroundShape:t="circle",backgroundColor:o,borderColor:i,iconColor:s,size:a="100",outputSize:c=null}){if(!e||e==="default"){if(!(o||i||s||t&&t!=="circle"&&t!=="default"))return null;e=t&&t!=="default"?t:"circle"}const u=Mi(e),d=parseInt(a,10)/100,p=c||Math.round(32*d);let f="";if(u.isShapeOnly){const y=o||u.defaultColor||"#667eea",b=i||"#fff";if(Ki[e])f=Ki[e]({backgroundColor:y,borderColor:b});else return qc[e]?.(y,p)||null}else{const y=o||"#667eea",b=i||"#fff",I=s||"#fff",T=t||"circle";T!=="none"&&Ki[T]&&(f+=Ki[T]({backgroundColor:y,borderColor:b})),Sh[e]&&(f+=Sh[e](I,y))}return`<svg width="${p}" height="${p}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
    ${f}
  </svg>`}const dw={full:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#10B981" stroke="#fff" stroke-width="1.5"/>
    <path d="M4 7l2 2 4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </svg>`,partial:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#F59E0B" stroke="#fff" stroke-width="1.5"/>
    <rect x="6" y="3.5" width="2" height="4.5" rx="1" fill="#fff"/>
    <circle cx="7" cy="10" r="1" fill="#fff"/>
  </svg>`,missing:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#EF4444" stroke="#fff" stroke-width="1.5"/>
    <path d="M4.5 4.5l5 5M9.5 4.5l-5 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
  </svg>`};function hw(e,t){return e===0?"missing":e>=t?"full":"partial"}function Kc(e,t){const o=hw(e,t);return dw[o]}function fw(e,t,o=32){if(e==="default")return null;if(Lh[e])return Lh[e](o);if(qc[e]){const i=t||"#667eea";return qc[e](i,o)}return null}const pw=["circle","square","hexagon","pentagon"];function vw(e){return pw.includes(e)}function mw(e,t,o,i,s=32,a=!0){const c=fw(e,t,s),u=Kc(o,i);if(!c)return null;const d=a&&vw(e),p=uw(e,t),f=yw(p),y=Kp(p)?"0 1px 2px rgba(255,255,255,0.5)":"0 1px 2px rgba(0,0,0,0.5)",b=s>=36?"12px":"10px",I=d?`
    <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: ${f};
      font-weight: bold;
      font-size: ${b};
      text-shadow: ${y};
      pointer-events: none;
    ">${o}/${i}</div>
  `:"";return`
    <div style="position: relative; width: ${s}px; height: ${s}px;">
      ${c}
      ${I}
      <div style="position: absolute; bottom: -4px; right: -4px;">
        ${u}
      </div>
    </div>
  `}function gw(e){const t=e.replace("#",""),o=parseInt(t.substr(0,2),16)/255,i=parseInt(t.substr(2,2),16)/255,s=parseInt(t.substr(4,2),16)/255,a=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),c=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*a+.7152*c+.0722*u}function Kp(e){return!e||e.length<6?!1:gw(e)>.4}function yw(e){return Kp(e)?"#1F2937":"#FFFFFF"}const _w="#667eea",kw={__name:"MapView",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},clickable:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","polygon-complete","polygon-drawing"],setup(e,{expose:t,emit:o}){const i=e,s=o,a=P(null);let c=null;const u=P([]),d=P([]),p=P([]);let f=null,y=null;const b=()=>{if(c){const re=c.getCenter();return{lat:re.lat,lng:re.lng}}return null},I=()=>c?c.getZoom():null,T=()=>{if(u.value.length>0){p.value.push([...u.value]);const re=d.value.pop()||[];u.value=re,Te(),s("polygon-drawing",u.value)}},S=()=>{if(p.value.length>0){d.value.push([...u.value]);const re=p.value.pop();u.value=re,Te(),s("polygon-drawing",u.value)}},O=()=>u.value.length>0,E=()=>p.value.length>0,A=()=>u.value.length,$=()=>{u.value.length>=3&&(s("polygon-complete",[...u.value]),C())},C=()=>{u.value=[],d.value=[],p.value=[],Te()};t({getMapCenter:b,getMapZoom:I,undoPolygonPoint:T,redoPolygonPoint:S,canUndo:O,canRedo:E,getPolygonPointCount:A,completePolygon:$,clearPolygonDrawing:C});const w=P([]);let k=null;const M=P(!0),G=P(!1),ne=P(new Set),ce=P([]);let K=null,se=null;const me=(re,Ee,Me,$e,ue=!1)=>{const ye=Me?"36px":$e?"20px":"30px",z=Me?"#667eea":"white",ee=ue?"":Kc(re,Ee);return`
    <div style="position: relative; width: ${ye}; height: ${ye};">
      <div style="
        background-color: ${_w};
        width: ${ye};
        height: ${ye};
        border-radius: 50%;
        border: 3px solid ${z};
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      "></div>
      ${ue?"":`<div style="position: absolute; bottom: -4px; right: -4px;">
        ${ee}
      </div>`}
    </div>
  `},Re=()=>{if(!c)return;const re=rw(c,w.value),Ee=Array.from(ne.value).sort().join(","),Me=Array.from(re).sort().join(",");Ee!==Me&&(ne.value=re,Be())},Oe=()=>{if(se&&(se.remove(),se=null),!c||!i.userLocation)return;const re=xn.divIcon({className:"user-location-marker",html:`
      <div style="
        position: relative;
        width: 20px;
        height: 20px;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #4285f4;
          border: 3px solid white;
          border-radius: 50%;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        "></div>
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 40px;
          height: 40px;
          background-color: rgba(66, 133, 244, 0.2);
          border-radius: 50%;
          animation: pulse 2s ease-out infinite;
        "></div>
      </div>
    `,iconSize:[40,40],iconAnchor:[20,20]});se=xn.marker([i.userLocation.lat,i.userLocation.lng],{icon:re}).addTo(c).bindPopup("Your location")},de=()=>{if(!a.value)return;let re=51.505,Ee=-.09,Me=13;const $e=i.allLocationsForBounds.length>0?i.allLocationsForBounds:i.locations,ue=(z,ee)=>z!=null&&ee!=null&&!(z===0&&ee===0),ye=[];$e.length>0&&ye.push(...$e.filter(z=>ue(z.latitude,z.longitude)).map(z=>({lat:z.latitude,lng:z.longitude}))),i.route&&i.route.length>0&&ye.push(...i.route.filter(z=>ue(z.lat,z.lng)).map(z=>({lat:z.lat,lng:z.lng}))),i.center?(re=i.center.lat,Ee=i.center.lng,Me=i.zoom??13):ye.length>0&&(re=ye.reduce((z,ee)=>z+ee.lat,0)/ye.length,Ee=ye.reduce((z,ee)=>z+ee.lng,0)/ye.length,Me=10),c=xn.map(a.value).setView([re,Ee],Me),xn.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(c),i.clickable&&c.on("click",z=>{i.drawingMode||s("map-click",{lat:z.latlng.lat,lng:z.latlng.lng})}),c.on("zoomend moveend",()=>{xe?Be():Re()}),Be(),he(),ve(),Oe(),fe()},he=()=>{if(k&&(k.remove(),k=null),!c||i.route.length===0)return;const re=i.route.map(Ee=>[Ee.lat,Ee.lng]);k=xn.polyline(re,{color:"blue",weight:4,opacity:.7}).addTo(c)},ve=()=>{ce.value.forEach(re=>re.remove()),ce.value=[],!(!c||i.areas.length===0)&&i.areas.forEach(re=>{const Ee=typeof re.polygon=="string"?JSON.parse(re.polygon):re.polygon;if(!Ee||Ee.length===0)return;const Me=Ee.map(z=>[z.lat,z.lng]),$e=re.id===i.selectedAreaId,ue=re.color||"#667eea",ye=xn.polygon(Me,{color:ue,fillColor:ue,fillOpacity:$e?.4:.2,weight:$e?3:2,opacity:.8}).addTo(c);ye.setStyle({pane:"overlayPane"}),i.drawingMode||(ye.on("click",()=>s("area-click",re)),ye.on("mouseover",()=>{ye.setStyle({fillOpacity:.4})}),ye.on("mouseout",()=>{ye.setStyle({fillOpacity:$e?.4:.2})})),ce.value.push(ye)})},Te=()=>{if(c&&(f&&(f.remove(),f=null),y&&(y.remove(),y=null),u.value.length!==0&&(y=xn.layerGroup().addTo(c),u.value.forEach((re,Ee)=>{const Me=Ee===0,$e=Ee===u.value.length-1,ue=xn.divIcon({className:"polygon-point-marker",html:`<div style="
        width: ${Me?"16px":"12px"};
        height: ${Me?"16px":"12px"};
        background-color: ${Me?"#667eea":$e?"#ff9800":"white"};
        border: 3px solid #667eea;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      "></div>`,iconSize:[Me?16:12,Me?16:12],iconAnchor:[Me?8:6,Me?8:6]});xn.marker([re.lat,re.lng],{icon:ue,interactive:!1}).addTo(y)}),u.value.length>=2))){const re=u.value.map(Ee=>[Ee.lat,Ee.lng]);u.value.length>=3&&re.push(re[0]),f=xn.polyline(re,{color:"#667eea",weight:3,opacity:.8,dashArray:u.value.length<3?"10, 10":null}).addTo(c)}},fe=()=>{if(!c)return;if(K||(K=new xn.FeatureGroup,c.addLayer(K)),c._customDrawingHandlers&&(c.off("click",c._customDrawingHandlers.handleClick),c.getContainer().removeEventListener("touchstart",c._customDrawingHandlers.handleTouchStart),c.getContainer().removeEventListener("touchend",c._customDrawingHandlers.handleTouchEnd),c.getContainer().removeEventListener("touchmove",c._customDrawingHandlers.handleTouchMove),delete c._customDrawingHandlers),!i.drawingMode){C(),K&&K.clearLayers();return}let re=0,Ee=null,Me=!1,$e=!1;const ue=300,ye=15,z=X=>{d.value.push([...u.value]),p.value=[],u.value.push({lat:X.lat,lng:X.lng}),Te(),s("polygon-drawing",u.value)},ee=X=>{X.originalEvent&&X.originalEvent.sourceCapabilities?.firesTouchEvents||z(X.latlng)},ie=X=>{if(X.touches.length>1){$e=!0;return}$e=!1,re=Date.now(),Ee={x:X.touches[0].clientX,y:X.touches[0].clientY},Me=!1},B=X=>{if(!Ee||$e)return;const q=X.touches[0].clientX-Ee.x,F=X.touches[0].clientY-Ee.y;Math.sqrt(q*q+F*F)>ye&&(Me=!0)},j=X=>{if($e){$e=!1,Ee=null;return}if(Date.now()-re<ue&&!Me&&Ee){const F=X.changedTouches[0],N=xn.point(F.clientX-c.getContainer().getBoundingClientRect().left,F.clientY-c.getContainer().getBoundingClientRect().top),W=c.containerPointToLatLng(N);X.preventDefault(),X.stopPropagation(),z(W)}Ee=null,Me=!1};c.on("click",ee),c.getContainer().addEventListener("touchstart",ie,{passive:!0}),c.getContainer().addEventListener("touchmove",B,{passive:!0}),c.getContainer().addEventListener("touchend",j,{passive:!1}),c._customDrawingHandlers={handleClick:ee,handleTouchStart:ie,handleTouchMove:B,handleTouchEnd:j},Te()};let xe=!1;const Be=()=>{if(c&&c._animatingZoom){xe=!0;return}if(xe=!1,w.value.forEach(re=>{re._map&&(re.off(),re.remove())}),w.value=[],!!c){if(i.locations.forEach(re=>{const Ee=re.latitude??re.Latitude,Me=re.longitude??re.Longitude;if(Ee==null||Me==null||Ee===0&&Me===0)return;const $e=re.checkedInCount||0,ue=re.requiredMarshals||1,ye=i.highlightLocationId===re.id||i.highlightLocationIds.includes(re.id),z=i.simplifyNonHighlighted&&!ye,ee=re.resolvedStyleType||re.ResolvedStyleType,ie=re.resolvedStyleBackgroundColor||re.ResolvedStyleBackgroundColor||re.resolvedStyleColor||re.ResolvedStyleColor,B=re.resolvedStyleBorderColor||re.ResolvedStyleBorderColor,j=re.resolvedStyleIconColor||re.ResolvedStyleIconColor,X=re.resolvedStyleBackgroundShape||re.ResolvedStyleBackgroundShape,q=ee&&ee!=="default"||ie||B||j||X&&X!=="circle"&&X!=="default",F=re.resolvedStyleMapRotation??re.ResolvedStyleMapRotation??re.styleMapRotation??re.StyleMapRotation??0,N=parseInt(F,10)||0,W=re.areaColor||"#999",ge=re.areaId&&!i.marshalMode,Ce=ne.value.has(re.id)&&re.description?`${re.name}: ${qp(re.description,50)}`:re.name,ze=ye?`
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid #667eea;
        border-radius: 50%;
        animation: highlight-pulse 1.5s ease-out infinite;
      "></div>
    `:"",Fe=ye?"#667eea":z?"#e0e0e0":"white",je=ye?"white":z?"#888":"#333";let Je;if(z){const vt="20px";Je=`
        <div style="
          background-color: #999;
          width: ${vt};
          height: ${vt};
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        "></div>
      `}const ae=!i.marshalMode,oe=Kc($e,ue),J=ae?`<div style="
      position: absolute;
      bottom: -2px;
      right: -6px;
      background-color: white;
      border-radius: 8px;
      padding: 1px 4px;
      font-size: 9px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    ">${$e}/${ue}</div>`:"";if(q){const vt=ye?40:32,pt=re.resolvedStyleSize||re.ResolvedStyleSize||"100",ht=Xt({type:re.resolvedStyleType||re.ResolvedStyleType,backgroundShape:re.resolvedStyleBackgroundShape||re.ResolvedStyleBackgroundShape||"circle",backgroundColor:re.resolvedStyleBackgroundColor||re.ResolvedStyleBackgroundColor||re.resolvedStyleColor||re.ResolvedStyleColor||"",borderColor:re.resolvedStyleBorderColor||re.ResolvedStyleBorderColor||"",iconColor:re.resolvedStyleIconColor||re.ResolvedStyleIconColor||"",size:pt});ht?Je=ht:Je=mw(re.resolvedStyleType,re.resolvedStyleColor,$e,ue,vt,ae)||me($e,ue,ye,i.marshalMode,!0)}else Je=me($e,ue,ye,i.marshalMode,!0);const Ze=N!==0?`transform: rotate(${N}deg);`:"",Xe=xn.divIcon({className:"custom-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
          ${ze}
          <div style="position: relative; display: flex; align-items: center; gap: 4px;">
            ${ge?`<div style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background-color: ${W};
              border: 2px solid white;
              box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            "></div>`:""}
            <div style="position: relative; display: inline-block;">
              <div style="${Ze}">
                ${Je}
              </div>
              ${z?"":`<div style="position: absolute; top: -4px; right: -4px;">
                ${oe}
              </div>`}
              ${z?"":J}
            </div>
          </div>
          <div style="
            background-color: ${Fe};
            padding: 2px 6px;
            border-radius: 3px;
            font-size: ${ye?"12px":"11px"};
            font-weight: bold;
            color: ${je};
            white-space: nowrap;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${Ce}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]}),rt=i.marshalMode?`<b>${re.name}</b>${re.description?`<br>${re.description}`:""}`:`<b>${re.name}</b><br>${re.description||""}<br>Checked in: ${$e}/${ue}`,ft=xn.marker([re.latitude,re.longitude],{icon:Xe}).addTo(c).bindPopup(rt);ft.on("click",()=>{s("location-click",re)}),ft.locationData=re,w.value.push(ft)}),c&&M.value&&!i.center&&!G.value){const re=[],Ee=i.allLocationsForBounds.length>0?i.allLocationsForBounds:i.locations,Me=($e,ue)=>$e!=null&&ue!=null&&!($e===0&&ue===0);if(Ee.length>0&&re.push(...Ee.filter($e=>Me($e.latitude,$e.longitude)).map($e=>[$e.latitude,$e.longitude])),i.route.length>0&&re.push(...i.route.filter($e=>Me($e.lat,$e.lng)).map($e=>[$e.lat,$e.lng])),re.length>0){const $e=xn.latLngBounds(re);c.fitBounds($e,{padding:[50,50]}),M.value=!1,G.value=!0}}else i.center&&(M.value=!1);setTimeout(()=>{c&&!c._animatingZoom&&Re()},100)}};return on(()=>{G.value=!1,M.value=!0,de();let re,Ee=0,Me=0;const $e=new ResizeObserver(ue=>{if(c&&ue.length>0){const{width:ye,height:z}=ue[0].contentRect;(Math.abs(ye-Ee)>10||Math.abs(z-Me)>10)&&(Ee=ye,Me=z,clearTimeout(re),re=setTimeout(()=>{c.invalidateSize()},150))}});a.value&&$e.observe(a.value),Lo(()=>{clearTimeout(re),$e.disconnect()})}),We(()=>i.locations,re=>{if(Be(),c&&!G.value&&re.length>0&&!i.center){const Ee=re.map(ye=>ye.latitude),Me=re.map(ye=>ye.longitude),$e=Ee.reduce((ye,z)=>ye+z,0)/Ee.length,ue=Me.reduce((ye,z)=>ye+z,0)/Me.length;c.setView([$e,ue],10),G.value=!0,M.value=!1}},{deep:!0}),We(()=>i.route,re=>{if(he(),Be(),c&&!G.value&&re&&re.length>0&&!i.center){const Ee=re.map(ye=>ye.lat),Me=re.map(ye=>ye.lng),$e=Ee.reduce((ye,z)=>ye+z,0)/Ee.length,ue=Me.reduce((ye,z)=>ye+z,0)/Me.length;c.setView([$e,ue],10),G.value=!0,M.value=!1}},{deep:!0}),We(()=>i.center,re=>{c&&c.setView([re.lat,re.lng],i.zoom)}),We(()=>i.areas,()=>{ve()},{deep:!0}),We(()=>i.selectedAreaId,()=>{ve()}),We(()=>i.drawingMode,()=>{fe()}),We(()=>i.userLocation,()=>{Oe()},{deep:!0}),We(()=>i.highlightLocationId,()=>{Be()}),We(()=>i.highlightLocationIds,()=>{Be()},{deep:!0}),We(()=>i.marshalMode,()=>{Be()}),We(()=>i.simplifyNonHighlighted,()=>{Be()}),We(()=>i.clickable,re=>{c&&(c.off("click"),re&&c.on("click",Ee=>{i.drawingMode||s("map-click",{lat:Ee.latlng.lat,lng:Ee.latlng.lng})}))}),(re,Ee)=>(v(),m("div",{ref_key:"mapContainer",ref:a,class:"map-container"},null,512))}},ws=Ye(kw,[["__scopeId","data-v-295c929a"]]);function Fn(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}const bw={class:"areas-selection"},ww={key:0,class:"areas-selection-header"},Cw={class:"areas-list"},Lw=["checked","onChange"],Sw={__name:"AreasSelection",props:{areas:{type:Array,default:()=>[]},selectedAreaIds:{type:Array,default:()=>[]}},emits:["update:selectedAreaIds"],setup(e,{emit:t}){const o=e,i=t,s=Y(()=>[...o.areas].sort((d,p)=>d.displayOrder!==p.displayOrder?d.displayOrder-p.displayOrder:Fn(d.name,p.name))),a=Y(()=>o.areas.length>0&&o.selectedAreaIds.length===o.areas.length),c=d=>{const p=[...o.selectedAreaIds],f=p.indexOf(d);f>=0?p.splice(f,1):p.push(d),i("update:selectedAreaIds",p)},u=()=>{a.value?i("update:selectedAreaIds",[]):i("update:selectedAreaIds",o.areas.map(d=>d.id))};return(d,p)=>(v(),m("div",bw,[e.areas.length>1?(v(),m("div",ww,[l("button",{onClick:u,class:"toggle-all-btn"},_(a.value?"Deselect all":"Select all"),1)])):D("",!0),l("div",Cw,[(v(!0),m(we,null,Pe(s.value,f=>(v(),m("label",{class:"area-checkbox",key:f.id},[l("input",{type:"checkbox",checked:e.selectedAreaIds.includes(f.id),onChange:y=>c(f.id)},null,40,Lw),l("span",{class:"area-color-dot",style:ot({backgroundColor:f.color||"#667eea"})},null,4),Ve(" "+_(f.name),1)]))),128))])]))}},Yp=Ye(Sw,[["__scopeId","data-v-46364246"]]),xw={class:"course-areas-tab"},$w={class:"map-wrapper"},Iw={key:0,class:"drawing-controls"},Tw={class:"point-count"},Mw={class:"undo-redo-buttons"},Aw=["disabled"],Ew=["disabled"],Pw={key:0},Dw={key:1},Ow={key:0,class:"filters-content"},Rw={class:"filter-section"},Bw={class:"filter-checkbox"},Nw={class:"filter-checkbox"},Fw={class:"filter-checkbox"},Uw={class:"filter-checkbox"},zw={class:"filter-checkbox"},Hw={key:0,class:"filter-section"},Vw={key:0},Gw={key:1},Zw={key:0,class:"add-menu-content"},jw={__name:"CourseAreasTab",props:{checkpoints:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1}},emits:["map-click","location-click","area-click","import-checkpoints","upload-route","select-location","add-area","select-area","polygon-complete","cancel-drawing","add-checkpoint-from-map","add-many-checkpoints-from-map","add-area-from-map"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=Lt(),a=e,c=o,u=P(null),d=P(null),p=P(!0),f=P(!1),y=P(null),b=P(0),I=P(!1),T=P(!1),S=P({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreas:[]}),O=()=>{p.value=!p.value,p.value||(f.value=!1)},E=()=>{f.value=!f.value,f.value&&(p.value=!0)},A=de=>{f.value=!1,de==="checkpoint"?(c("add-checkpoint-from-map"),ne()):de==="many-checkpoints"?(c("add-many-checkpoints-from-map"),ne()):de==="area"&&(c("add-area-from-map"),ne())},$=()=>{f.value=!1,c("import-checkpoints")},C=()=>{f.value=!1,c("upload-route")},w=de=>{b.value=de?.length||0,k()},k=()=>{d.value&&(I.value=d.value.canUndo(),T.value=d.value.canRedo())},M=()=>{d.value&&(d.value.undoPolygonPoint(),k())},G=()=>{d.value&&(d.value.redoPolygonPoint(),k())},ne=()=>{u.value&&u.value.scrollIntoView({behavior:"smooth",block:"start"})};t({scrollMapIntoView:ne,getMapCenter:()=>d.value?.getMapCenter()||null,getMapZoom:()=>d.value?.getMapZoom()||null}),We(()=>a.areas,de=>{if(de.length>0){const he=new Set(S.value.selectedAreas);de.forEach(ve=>{he.has(ve.id)||S.value.selectedAreas.push(ve.id)}),S.value.selectedAreas=S.value.selectedAreas.filter(ve=>de.some(Te=>Te.id===ve))}},{immediate:!0}),We(()=>a.drawingMode,de=>{de||(b.value=0,I.value=!1,T.value=!1)}),Y(()=>[...a.areas].sort((de,he)=>de.displayOrder!==he.displayOrder?de.displayOrder-he.displayOrder:Fn(de.name,he.name)));const se=Y(()=>S.value.showRoute?a.route:[]),me=de=>{const he=de.checkedInCount||0,ve=de.requiredMarshals||1;return he===0?"unchecked":he>=ve?"full":"partial"},Re=Y(()=>!S.value.showUncheckedIn&&!S.value.showPartiallyCheckedIn&&!S.value.showFullyCheckedIn?[]:a.checkpoints.filter(de=>{const he=me(de);if(he==="unchecked"&&!S.value.showUncheckedIn||he==="partial"&&!S.value.showPartiallyCheckedIn||he==="full"&&!S.value.showFullyCheckedIn)return!1;const ve=de.areaIds||de.AreaIds;return ve&&Array.isArray(ve)?ve.some(Te=>S.value.selectedAreas.includes(Te)):de.areaId?S.value.selectedAreas.includes(de.areaId):!1})),Oe=Y(()=>S.value.showAreas?a.areas.filter(de=>S.value.selectedAreas.includes(de.id)):[]);return(de,he)=>(v(),m("div",xw,[l("div",{class:"map-section",ref_key:"mapSection",ref:u},[l("div",$w,[Ne(ws,{ref_key:"mapView",ref:d,locations:Re.value,route:se.value,areas:Oe.value,"all-locations-for-bounds":e.checkpoints,"selected-area-id":e.selectedAreaId,clickable:!0,"drawing-mode":e.drawingMode,onMapClick:he[0]||(he[0]=ve=>de.$emit("map-click",ve)),onLocationClick:he[1]||(he[1]=ve=>de.$emit("location-click",ve)),onAreaClick:he[2]||(he[2]=ve=>de.$emit("area-click",ve)),onPolygonComplete:he[3]||(he[3]=ve=>de.$emit("polygon-complete",ve)),onPolygonDrawing:w},null,8,["locations","route","areas","all-locations-for-bounds","selected-area-id","drawing-mode"]),e.drawingMode&&b.value>0?(v(),m("div",Iw,[l("div",Tw,_(b.value)+" point"+_(b.value!==1?"s":""),1),l("div",Mw,[l("button",{onClick:M,class:"btn-drawing undo-btn",disabled:!I.value,title:"Undo last point"},"  Undo ",8,Aw),l("button",{onClick:G,class:"btn-drawing redo-btn",disabled:!T.value,title:"Redo point"}," Redo  ",8,Ew)])])):D("",!0)]),f.value?D("",!0):(v(),m("div",{key:0,class:_e(["visibility-filters",{collapsed:p.value}])},[l("button",{onClick:O,class:"filters-toggle"},[p.value?(v(),m("span",Pw,"Show...")):(v(),m("span",Dw,""))]),p.value?D("",!0):(v(),m("div",Ow,[l("div",Rw,[he[13]||(he[13]=l("h4",null,"Show on map:",-1)),l("label",Bw,[Ge(l("input",{type:"checkbox","onUpdate:modelValue":he[4]||(he[4]=ve=>S.value.showRoute=ve)},null,512),[[ys,S.value.showRoute]]),Ve(" "+_(V(i).course),1)]),l("label",Nw,[Ge(l("input",{type:"checkbox","onUpdate:modelValue":he[5]||(he[5]=ve=>S.value.showUncheckedIn=ve)},null,512),[[ys,S.value.showUncheckedIn]]),Ve(" Unchecked-in "+_(V(s).checkpoints),1)]),l("label",Fw,[Ge(l("input",{type:"checkbox","onUpdate:modelValue":he[6]||(he[6]=ve=>S.value.showPartiallyCheckedIn=ve)},null,512),[[ys,S.value.showPartiallyCheckedIn]]),Ve(" Partially checked-in "+_(V(s).checkpoints),1)]),l("label",Uw,[Ge(l("input",{type:"checkbox","onUpdate:modelValue":he[7]||(he[7]=ve=>S.value.showFullyCheckedIn=ve)},null,512),[[ys,S.value.showFullyCheckedIn]]),Ve(" Fully checked-in "+_(V(s).checkpoints),1)]),l("label",zw,[Ge(l("input",{type:"checkbox","onUpdate:modelValue":he[8]||(he[8]=ve=>S.value.showAreas=ve)},null,512),[[ys,S.value.showAreas]]),Ve(" "+_(V(i).areas),1)])]),e.areas.length>0&&S.value.showAreas?(v(),m("div",Hw,[l("h4",null,"Filter "+_(V(s).areas)+":",1),Ne(Yp,{areas:e.areas,"selected-area-ids":S.value.selectedAreas,"onUpdate:selectedAreaIds":he[9]||(he[9]=ve=>S.value.selectedAreas=ve)},null,8,["areas","selected-area-ids"])])):D("",!0)]))],2)),p.value?(v(),m("div",{key:1,class:_e(["add-menu",{expanded:f.value}])},[l("button",{onClick:E,class:"add-toggle",ref_key:"addButtonRef",ref:y},[f.value?(v(),m("span",Vw,"")):(v(),m("span",Gw,"Add..."))],512),f.value?(v(),m("div",Zw,[l("button",{onClick:he[10]||(he[10]=ve=>A("checkpoint")),class:"add-menu-item"}," Checkpoint "),l("button",{onClick:he[11]||(he[11]=ve=>A("many-checkpoints")),class:"add-menu-item"}," Many checkpoints "),l("button",{onClick:he[12]||(he[12]=ve=>A("area")),class:"add-menu-item"}," Area "),l("button",{onClick:$,class:"add-menu-item"}," Import checkpoints... "),l("button",{onClick:C,class:"add-menu-item"}," Upload route... ")])):D("",!0)],2)):D("",!0)],512)]))}},Ww=Ye(jw,[["__scopeId","data-v-08ee7bde"]]),qw=(e,t)=>{const o=String(e).trim(),i=String(t).trim(),s=parseFloat(o),a=parseFloat(i),c=!isNaN(s)&&String(s)===o,u=!isNaN(a)&&String(a)===i;return c&&u?s-a:o.localeCompare(i,void 0,{numeric:!0,sensitivity:"base"})},Kw=e=>e&&e.isCheckedIn?"":"",Yw={class:"marshals-tab"},Jw={class:"marshals-tab-header"},Xw={class:"button-group"},Qw={class:"marshals-grid"},e0={class:"marshals-table"},t0={key:0,class:"sort-indicator"},n0={key:0,class:"sort-indicator"},o0={key:0,class:"sort-indicator"},s0={key:0,class:"sort-indicator"},i0=["onClick"],a0=["rowspan"],r0=["value","onChange"],l0=["rowspan"],c0={key:0,class:"last-active-text"},u0={key:1,class:"last-active-never"},d0=["onClick"],h0={style:{color:"#999","font-style":"italic"}},f0={class:"hide-on-mobile last-active-cell"},p0={key:0,class:"last-active-text"},v0={key:1,class:"last-active-never"},m0={__name:"MarshalsTab",props:{marshals:{type:Array,required:!0},assignments:{type:Array,required:!0},locations:{type:Array,required:!0}},emits:["add-marshal","import-marshals","select-marshal","delete-marshal","change-assignment-status"],setup(e,{emit:t}){const{terms:o}=Lt(),i=e,s=P("name"),a=P("asc"),c=I=>{s.value===I?a.value=a.value==="asc"?"desc":"asc":(s.value=I,a.value="asc")},u=I=>i.assignments.filter(T=>T.marshalId===I),d=I=>{const T=i.locations.find(S=>S.id===I);return T?T.name:"Unknown"},p=I=>{if(!I)return"";const T=new Date(I),O=new Date-T,E=Math.floor(O/6e4),A=Math.floor(E/60),$=Math.floor(A/24);return E<1?"just now":E<60?`${E}m ago`:A<24?`${A}h ago`:$===1?"yesterday":$<7?`${$}d ago`:T.toLocaleDateString()},f=Y(()=>{const I=[...i.marshals];return I.sort((T,S)=>{let O=0;if(s.value==="name")O=T.name.localeCompare(S.name);else if(s.value==="checkpoint"){const E=u(T.id),A=u(S.id),$=E.length>0?d(E[0].locationId):"",C=A.length>0?d(A[0].locationId):"";O=qw($,C)}else if(s.value==="status"){const E=u(T.id),A=u(S.id),$=E.length>0&&E[0].isCheckedIn?1:0;O=(A.length>0&&A[0].isCheckedIn?1:0)-$}else if(s.value==="lastActive"){const E=T.lastAccessedDate?new Date(T.lastAccessedDate).getTime():0;O=(S.lastAccessedDate?new Date(S.lastAccessedDate).getTime():0)-E}return a.value==="asc"?O:-O}),I}),y=I=>I.isAdminCheckedIn?"admin-checked-in":I.isWrongLocation?"wrong-location":I.isCheckedIn?"checked-in":"not-checked-in",b=I=>I.isCheckedIn?"status-checked-in":"status-not-checked-in";return(I,T)=>(v(),m("div",Yw,[l("div",Jw,[l("h2",null,_(V(o).people)+" management",1),l("div",Xw,[l("button",{onClick:T[0]||(T[0]=S=>I.$emit("add-marshal")),class:"btn btn-primary"}," Add "+_(V(o).person.toLowerCase()),1),l("button",{onClick:T[1]||(T[1]=S=>I.$emit("import-marshals")),class:"btn btn-secondary"}," Import CSV ")])]),l("div",Qw,[l("table",e0,[l("thead",null,[l("tr",null,[l("th",{onClick:T[2]||(T[2]=S=>c("name")),class:"sortable"},[T[7]||(T[7]=Ve(" Name ",-1)),s.value==="name"?(v(),m("span",t0,_(a.value==="asc"?"":""),1)):D("",!0)]),l("th",{onClick:T[3]||(T[3]=S=>c("checkpoint")),class:"sortable"},[Ve(_(V(o).checkpoint)+" ",1),s.value==="checkpoint"?(v(),m("span",n0,_(a.value==="asc"?"":""),1)):D("",!0)]),l("th",{onClick:T[4]||(T[4]=S=>c("status")),class:"sortable"},[T[8]||(T[8]=Ve(" Status ",-1)),s.value==="status"?(v(),m("span",o0,_(a.value==="asc"?"":""),1)):D("",!0)]),l("th",{onClick:T[5]||(T[5]=S=>c("lastActive")),class:"sortable hide-on-mobile"},[T[9]||(T[9]=Ve(" Last active ",-1)),s.value==="lastActive"?(v(),m("span",s0,_(a.value==="asc"?"":""),1)):D("",!0)])])]),l("tbody",null,[(v(!0),m(we,null,Pe(f.value,S=>(v(),m(we,{key:S.id},[u(S.id).length>0?(v(!0),m(we,{key:0},Pe(u(S.id),(O,E)=>(v(),m("tr",{key:`${S.id}-${O.id}`,class:"marshal-row",onClick:A=>I.$emit("select-marshal",S)},[E===0?(v(),m("td",{key:0,rowspan:u(S.id).length},_(S.name),9,a0)):D("",!0),l("td",null,_(d(O.locationId)),1),l("td",{onClick:T[6]||(T[6]=gt(()=>{},["stop"]))},[l("select",{value:y(O),onChange:A=>I.$emit("change-assignment-status",{assignment:O,status:A.target.value}),class:_e(["status-select hide-on-mobile",b(O)])},[...T[10]||(T[10]=[l("option",{value:"not-checked-in"},"Not checked-in",-1),l("option",{value:"checked-in"},"Checked-in",-1),l("option",{value:"admin-checked-in"},"Admin checked-in",-1),l("option",{value:"wrong-location"},"Checked-in but not at correct location",-1)])],42,r0),l("span",{class:_e(["status-icon show-on-mobile",b(O)])},_(V(Kw)(O)),3)]),E===0?(v(),m("td",{key:1,rowspan:u(S.id).length,class:"hide-on-mobile last-active-cell"},[S.lastAccessedDate?(v(),m("span",c0,_(p(S.lastAccessedDate)),1)):(v(),m("span",u0,"Never"))],8,l0)):D("",!0)],8,i0))),128)):(v(),m("tr",{key:1,class:"marshal-row",onClick:O=>I.$emit("select-marshal",S)},[l("td",null,_(S.name),1),l("td",h0,"No "+_(V(o).checkpoint.toLowerCase())+" assigned",1),T[11]||(T[11]=l("td",null,[l("span",{class:"hide-on-mobile"},"-"),l("span",{class:"status-icon show-on-mobile",style:{color:"#999"}},"-")],-1)),l("td",f0,[S.lastAccessedDate?(v(),m("span",p0,_(p(S.lastAccessedDate)),1)):(v(),m("span",v0,"Never"))])],8,d0))],64))),128))])])])]))}},g0=Ye(m0,[["__scopeId","data-v-32d40275"]]),y0={class:"checklists-tab"},_0={class:"checklists-tab-header"},k0={class:"button-group"},b0={class:"filters-section"},w0={class:"filter-group"},C0={class:"filter-checkbox"},L0=["checked"],S0={key:0,class:"checkbox-dropdown"},x0={class:"checkbox-dropdown-header"},$0={class:"checkbox-list"},I0=["checked","onChange"],T0={class:"filter-group"},M0={class:"filter-checkbox"},A0=["checked"],E0={key:0,class:"checkbox-dropdown"},P0={class:"checkbox-dropdown-header"},D0={class:"checkbox-list"},O0=["checked","onChange"],R0={class:"filter-group"},B0={class:"filter-checkbox"},N0=["checked"],F0={key:0,class:"checkbox-dropdown"},U0={class:"checkbox-dropdown-header"},z0={class:"checkbox-list"},H0=["checked","onChange"],V0={class:"checklist-items-list"},G0={key:0,class:"empty-state"},Z0={class:"checklist-item-content"},j0=["onClick"],W0={class:"checklist-item-scopes"},q0=["onClick"],K0={__name:"ChecklistsTab",props:{checklistItems:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},completionReport:{type:Object,default:null}},emits:["add-checklist-item","select-checklist-item"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Lt(),s=e,a=P(!0),c=P(!0),u=P(!0),d=P([]),p=P([]),f=P([]),y=Y(()=>[...s.areas].sort((Te,fe)=>Te.displayOrder!==fe.displayOrder?Te.displayOrder-fe.displayOrder:Fn(Te.name,fe.name))),b=Y(()=>[...s.locations].sort((Te,fe)=>Fn(Te.name,fe.name))),I=Y(()=>[...s.marshals].sort((Te,fe)=>Fn(Te.name,fe.name))),T=Y(()=>s.areas.length>0&&d.value.length===s.areas.length),S=Y(()=>s.locations.length>0&&p.value.length===s.locations.length),O=Y(()=>s.marshals.length>0&&f.value.length===s.marshals.length),E=Y(()=>!a.value||!c.value||!u.value),A=()=>{a.value=!a.value,!a.value&&d.value.length===0&&(d.value=s.areas.map(Te=>Te.id))},$=()=>{c.value=!c.value,!c.value&&p.value.length===0&&(p.value=s.locations.map(Te=>Te.id))},C=()=>{u.value=!u.value,!u.value&&f.value.length===0&&(f.value=s.marshals.map(Te=>Te.id))},w=Te=>{const fe=d.value.indexOf(Te);fe>=0?d.value.splice(fe,1):d.value.push(Te)},k=Te=>{const fe=p.value.indexOf(Te);fe>=0?p.value.splice(fe,1):p.value.push(Te)},M=Te=>{const fe=f.value.indexOf(Te);fe>=0?f.value.splice(fe,1):f.value.push(Te)},G=()=>{T.value?d.value=[]:d.value=s.areas.map(Te=>Te.id)},ne=()=>{S.value?p.value=[]:p.value=s.locations.map(Te=>Te.id)},ce=()=>{O.value?f.value=[]:f.value=s.marshals.map(Te=>Te.id)},K=()=>{a.value=!0,c.value=!0,u.value=!0,d.value=[],p.value=[],f.value=[]},se=Te=>{const fe=s.marshals.find(xe=>xe.id===Te);return!fe||!fe.assignments?[]:fe.assignments.map(xe=>xe.locationId)},me=Te=>{const fe=new Set;return Te.forEach(xe=>{const Be=s.locations.find(re=>re.id===xe);Be&&Be.areaIds&&Be.areaIds.forEach(re=>fe.add(re))}),Array.from(fe)},Re=(Te,fe)=>{if(!fe)return!1;const xe=se(Te),Be=me(xe);return fe.scope==="SpecificPeople"&&fe.itemType==="Marshal"?fe.ids.includes(Te)||fe.ids.includes("ALL_MARSHALS"):fe.scope==="EveryoneAtCheckpoints"&&fe.itemType==="Checkpoint"?fe.ids.includes("ALL_CHECKPOINTS")||xe.some(re=>fe.ids.includes(re)):fe.scope==="OnePerCheckpoint"&&fe.itemType==="Checkpoint"?fe.ids.includes("ALL_CHECKPOINTS")||xe.some(re=>fe.ids.includes(re)):fe.scope==="OnePerCheckpoint"&&fe.itemType==="Area"?fe.ids.includes("ALL_AREAS")||Be.some(re=>fe.ids.includes(re)):fe.scope==="EveryoneInAreas"&&fe.itemType==="Area"?fe.ids.includes("ALL_AREAS")||Be.some(re=>fe.ids.includes(re)):fe.scope==="OnePerArea"&&fe.itemType==="Area"?fe.ids.includes("ALL_AREAS")||Be.some(re=>fe.ids.includes(re)):(fe.scope==="EveryAreaLead"||fe.scope==="OneLeadPerArea")&&fe.itemType==="Area"?fe.ids.includes("ALL_AREAS")||Be.some(re=>fe.ids.includes(re)):!1},Oe=Y(()=>{let Te=s.checklistItems;return!a.value&&d.value.length>0&&(Te=Te.filter(fe=>fe.scopeConfigurations?fe.scopeConfigurations.some(xe=>xe.itemType==="Area"&&d.value.some(Be=>xe.ids.includes(Be))):!1)),!c.value&&p.value.length>0&&(Te=Te.filter(fe=>fe.scopeConfigurations?fe.scopeConfigurations.some(xe=>xe.itemType==="Checkpoint"&&p.value.some(Be=>xe.ids.includes(Be))):!1)),!u.value&&f.value.length>0&&(Te=Te.filter(fe=>fe.scopeConfigurations?f.value.some(xe=>fe.scopeConfigurations.some(Be=>Re(xe,Be))):!1)),Te}),de=Y(()=>[...Oe.value].sort((Te,fe)=>Te.displayOrder!==fe.displayOrder?Te.displayOrder-fe.displayOrder:Fn(Te.text,fe.text))),he=Te=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${i.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${i.value.checkpoints}`,SpecificPeople:`Specific ${i.value.people}`,OnePerArea:`One per ${i.value.area}`,OnePerCheckpoint:`One per ${i.value.checkpoint}`,EveryAreaLead:`Every ${i.value.area} lead`,OneLeadPerArea:`One lead per ${i.value.area}`,AreaLead:`${o.value.area} lead`})[Te]||Te,ve=Te=>{if(!Te)return"";const fe=he(Te.scope);if(Te.itemType===null)return fe;const xe=Te.ids||[];if(xe.includes("ALL_MARSHALS"))return`${fe} (Everyone)`;if(xe.includes("ALL_AREAS"))return`${fe} (All ${i.value.areas})`;if(xe.includes("ALL_CHECKPOINTS"))return`${fe} (All ${i.value.checkpoints})`;const Be=xe.length;return Be===0?fe:`${fe} (${Be})`};return(Te,fe)=>(v(),m("div",y0,[l("div",_0,[l("h2",null,_(V(o).checklists),1),l("div",k0,[l("button",{onClick:fe[0]||(fe[0]=xe=>Te.$emit("add-checklist-item")),class:"btn btn-primary"}," Add "+_(V(i).checklist),1)])]),l("div",b0,[l("div",w0,[l("h4",null,"Filter by "+_(V(i).area)+":",1),l("label",C0,[l("input",{type:"checkbox",checked:a.value,onChange:A},null,40,L0),Ve(" All "+_(V(i).areas),1)]),a.value?D("",!0):(v(),m("div",S0,[l("div",x0,[l("button",{onClick:G,class:"toggle-all-btn"},_(T.value?"Deselect all":"Select all"),1)]),l("div",$0,[(v(!0),m(we,null,Pe(y.value,xe=>(v(),m("label",{key:xe.id,class:"checkbox-item"},[l("input",{type:"checkbox",checked:d.value.includes(xe.id),onChange:Be=>w(xe.id)},null,40,I0),l("span",{class:"area-color-dot",style:ot({backgroundColor:xe.color||"#667eea"})},null,4),Ve(" "+_(xe.name),1)]))),128))])]))]),l("div",T0,[l("h4",null,"Filter by "+_(V(i).checkpoint)+":",1),l("label",M0,[l("input",{type:"checkbox",checked:c.value,onChange:$},null,40,A0),Ve(" All "+_(V(i).checkpoints),1)]),c.value?D("",!0):(v(),m("div",E0,[l("div",P0,[l("button",{onClick:ne,class:"toggle-all-btn"},_(S.value?"Deselect all":"Select all"),1)]),l("div",D0,[(v(!0),m(we,null,Pe(b.value,xe=>(v(),m("label",{key:xe.id,class:"checkbox-item"},[l("input",{type:"checkbox",checked:p.value.includes(xe.id),onChange:Be=>k(xe.id)},null,40,O0),Ve(" "+_(xe.name),1)]))),128))])]))]),l("div",R0,[l("h4",null,"Filter by "+_(V(i).person)+":",1),l("label",B0,[l("input",{type:"checkbox",checked:u.value,onChange:C},null,40,N0),Ve(" All "+_(V(i).people),1)]),u.value?D("",!0):(v(),m("div",F0,[l("div",U0,[l("button",{onClick:ce,class:"toggle-all-btn"},_(O.value?"Deselect all":"Select all"),1)]),l("div",z0,[(v(!0),m(we,null,Pe(I.value,xe=>(v(),m("label",{key:xe.id,class:"checkbox-item"},[l("input",{type:"checkbox",checked:f.value.includes(xe.id),onChange:Be=>M(xe.id)},null,40,H0),Ve(" "+_(xe.name),1)]))),128))])]))]),E.value?(v(),m("button",{key:0,onClick:K,class:"btn btn-secondary btn-small"}," Clear filters ")):D("",!0)]),l("div",V0,[Oe.value.length===0?(v(),m("div",G0,[l("p",null,_(E.value?"No checklist items match the selected filters.":"No checklist items yet. Create one to get started!"),1)])):D("",!0),(v(!0),m(we,null,Pe(de.value,xe=>(v(),m("div",{key:xe.itemId,class:"checklist-item-card"},[l("div",Z0,[l("div",{class:"checklist-item-title",onClick:Be=>Te.$emit("select-checklist-item",xe,"details")},[l("strong",null,_(xe.text),1)],8,j0),l("div",W0,[(v(!0),m(we,null,Pe(xe.scopeConfigurations,(Be,re)=>(v(),m("span",{key:re,class:"scope-badge",onClick:Ee=>Te.$emit("select-checklist-item",xe,"visibility")},_(ve(Be)),9,q0))),128))])])]))),128))])]))}},Y0=Ye(K0,[["__scopeId","data-v-212a4524"]]),J0={class:"notes-tab"},X0={class:"notes-tab-header"},Q0={class:"button-group"},eC={class:"filters-section"},tC={class:"filter-group"},nC={class:"priority-filters"},oC=["checked","onChange"],sC={class:"filter-group"},iC={class:"filter-checkbox"},aC=["checked"],rC={key:0,class:"checkbox-dropdown"},lC={class:"checkbox-list"},cC=["checked","onChange"],uC={class:"notes-list"},dC={key:0,class:"empty-state"},hC=["onClick"],fC={class:"note-header"},pC={class:"note-title-row"},vC={key:0,class:"pin-icon",title:"Pinned"},mC={class:"note-meta"},gC={key:0,class:"category-badge"},yC={class:"created-info"},_C={key:0,class:"note-preview"},kC={class:"note-scopes"},bC={__name:"NotesTab",props:{notes:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["add-note","select-note"],setup(e,{emit:t}){const{termsLower:o}=Lt(),i=e,s=[{value:"Urgent",label:"Urgent"},{value:"High",label:"High"},{value:"Normal",label:"Normal"},{value:"Low",label:"Low"}],a=P(!0),c=P([]),u=P(["Urgent","High","Normal","Low"]),d=Y(()=>[...i.areas].sort((C,w)=>C.displayOrder!==w.displayOrder?C.displayOrder-w.displayOrder:Fn(C.name,w.name))),p=Y(()=>!a.value||u.value.length<4),f=()=>{a.value=!a.value,!a.value&&c.value.length===0&&(c.value=i.areas.map(C=>C.id))},y=C=>{const w=c.value.indexOf(C);w>=0?c.value.splice(w,1):c.value.push(C)},b=C=>{const w=u.value.indexOf(C);w>=0?u.value.splice(w,1):u.value.push(C)},I=()=>{a.value=!0,c.value=[],u.value=["Urgent","High","Normal","Low"]},T=Y(()=>{let C=i.notes;return u.value.length<4&&(C=C.filter(w=>u.value.includes(w.priority||"Normal"))),!a.value&&c.value.length>0&&(C=C.filter(w=>w.scopeConfigurations?w.scopeConfigurations.some(k=>k.itemType==="Area"&&c.value.some(M=>k.ids.includes(M))):!1)),C}),S=Y(()=>{const C={Urgent:0,High:1,Normal:2,Low:3};return[...T.value].sort((w,k)=>{if(w.isPinned!==k.isPinned)return w.isPinned?-1:1;const M=C[w.priority]??2,G=C[k.priority]??2;return M!==G?M-G:w.displayOrder!==k.displayOrder?w.displayOrder-k.displayOrder:Fn(w.title,k.title)})}),O=C=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${o.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${o.value.checkpoints}`,SpecificPeople:`Specific ${o.value.people}`,EveryAreaLead:`Every ${o.value.area} lead`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,OnePerArea:`One per ${o.value.area}`,OneLeadPerArea:`One lead per ${o.value.area}`})[C]||C,E=C=>{if(!C)return"";const w=O(C.scope);if(C.itemType===null)return w;const k=C.ids||[];if(k.includes("ALL_MARSHALS"))return`${w} (Everyone)`;if(k.includes("ALL_AREAS"))return`${w} (All ${o.value.areas})`;if(k.includes("ALL_CHECKPOINTS"))return`${w} (All ${o.value.checkpoints})`;const M=k.length;return M===0?w:`${w} (${M})`},A=C=>{if(!C)return"";const w=150;return C.length<=w?C:C.substring(0,w)+"..."},$=C=>{if(!C)return"";const w=new Date(C),M=new Date-w,G=Math.floor(M/6e4),ne=Math.floor(M/36e5),ce=Math.floor(M/864e5);return G<1?"Just now":G<60?`${G}m ago`:ne<24?`${ne}h ago`:ce<7?`${ce}d ago`:w.toLocaleDateString()};return(C,w)=>(v(),m("div",J0,[l("div",X0,[w[1]||(w[1]=l("h2",null,"Notes",-1)),l("div",Q0,[l("button",{onClick:w[0]||(w[0]=k=>C.$emit("add-note")),class:"btn btn-primary"}," Add note ")])]),l("div",eC,[l("div",tC,[w[2]||(w[2]=l("h4",null,"Filter by priority:",-1)),l("div",nC,[(v(),m(we,null,Pe(s,k=>l("label",{key:k.value,class:"filter-checkbox"},[l("input",{type:"checkbox",checked:u.value.includes(k.value),onChange:M=>b(k.value)},null,40,oC),l("span",{class:_e(["priority-dot",k.value.toLowerCase()])},null,2),Ve(" "+_(k.label),1)])),64))])]),l("div",sC,[w[4]||(w[4]=l("h4",null,"Filter by area:",-1)),l("label",iC,[l("input",{type:"checkbox",checked:a.value,onChange:f},null,40,aC),w[3]||(w[3]=Ve(" All areas ",-1))]),a.value?D("",!0):(v(),m("div",rC,[l("div",lC,[(v(!0),m(we,null,Pe(d.value,k=>(v(),m("label",{key:k.id,class:"checkbox-item"},[l("input",{type:"checkbox",checked:c.value.includes(k.id),onChange:M=>y(k.id)},null,40,cC),l("span",{class:"area-color-dot",style:ot({backgroundColor:k.color||"#667eea"})},null,4),Ve(" "+_(k.name),1)]))),128))])]))]),p.value?(v(),m("button",{key:0,onClick:I,class:"btn btn-secondary btn-small"}," Clear filters ")):D("",!0)]),l("div",uC,[T.value.length===0?(v(),m("div",dC,[l("p",null,_(p.value?"No notes match the selected filters.":"No notes yet. Create one to get started!"),1)])):D("",!0),(v(!0),m(we,null,Pe(S.value,k=>(v(),m("div",{key:k.noteId,class:_e(["note-card",{pinned:k.isPinned}]),onClick:M=>C.$emit("select-note",k)},[l("div",fC,[l("div",pC,[k.isPinned?(v(),m("span",vC,"")):D("",!0),l("span",{class:_e(["priority-indicator",k.priority?.toLowerCase()||"normal"])},null,2),l("strong",null,_(k.title),1)]),l("div",mC,[k.category?(v(),m("span",gC,_(k.category),1)):D("",!0),l("span",yC,_($(k.createdAt)),1)])]),k.content?(v(),m("div",_C,_(A(k.content)),1)):D("",!0),l("div",kC,[(v(!0),m(we,null,Pe(k.scopeConfigurations,(M,G)=>(v(),m("span",{key:G,class:"scope-badge"},_(E(M)),1))),128))])],10,hC))),128))])]))}},wC=Ye(bC,[["__scopeId","data-v-c5d152b0"]]),CC={class:"contacts-tab"},LC={class:"contacts-tab-header"},SC={class:"button-group"},xC={class:"filters-section"},$C={class:"filter-group"},IC={class:"filter-checkbox"},TC=["checked"],MC={key:0,class:"checkbox-dropdown"},AC={class:"checkbox-list"},EC=["checked","onChange"],PC={class:"contacts-list"},DC={key:0,class:"empty-state"},OC=["onClick"],RC={class:"contact-header"},BC={class:"contact-title-row"},NC={key:0,class:"primary-badge",title:"Primary contact"},FC={class:"role-badge"},UC={class:"contact-details"},zC={key:0,class:"contact-phone"},HC={key:1,class:"contact-email"},VC={key:0,class:"contact-notes"},GC={class:"contact-scopes"},ZC={__name:"ContactsTab",props:{contacts:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})}},emits:["add-contact","select-contact"],setup(e,{emit:t}){const{termsLower:o}=Lt(),i=e,s=P(!0),a=P([]),c=Y(()=>{const E=new Set([...i.availableRoles.builtInRoles||[],...i.availableRoles.customRoles||[],...i.contacts.map(A=>A.role)]);return Array.from(E).sort()}),u=Y(()=>!s.value),d=()=>{s.value=!s.value,!s.value&&a.value.length===0&&(a.value=[...c.value])},p=E=>{const A=a.value.indexOf(E);A>=0?a.value.splice(A,1):a.value.push(E)},f=()=>{s.value=!0,a.value=[]},y=Y(()=>{let E=i.contacts;return!s.value&&a.value.length>0&&(E=E.filter(A=>a.value.includes(A.role))),E}),b=Y(()=>[...y.value].sort((E,A)=>{if(E.isPrimary!==A.isPrimary)return E.isPrimary?-1:1;const $=E.role.localeCompare(A.role);return $!==0?$:E.displayOrder!==A.displayOrder?E.displayOrder-A.displayOrder:Fn(E.name,A.name)})),I=E=>E?E==="AreaLead"?`${o.value.area.charAt(0).toUpperCase()+o.value.area.slice(1)} Lead`:E.replace(/([A-Z])/g," $1").replace(/^./,A=>A.toUpperCase()).trim():"",T=E=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${o.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${o.value.checkpoints}`,SpecificPeople:`Specific ${o.value.people}`,EveryAreaLead:`Every ${o.value.area} lead`})[E]||E,S=E=>{if(!E)return"";const A=T(E.scope);if(E.itemType===null)return A;const $=E.ids||[];if($.includes("ALL_MARSHALS"))return`${A} (Everyone)`;if($.includes("ALL_AREAS"))return`${A} (All ${o.value.areas})`;if($.includes("ALL_CHECKPOINTS"))return`${A} (All ${o.value.checkpoints})`;const C=$.length;return C===0?A:`${A} (${C})`},O=E=>{if(!E)return"";const A=100;return E.length<=A?E:E.substring(0,A)+"..."};return(E,A)=>(v(),m("div",CC,[l("div",LC,[A[1]||(A[1]=l("h2",null,"Contacts",-1)),l("div",SC,[l("button",{onClick:A[0]||(A[0]=$=>E.$emit("add-contact")),class:"btn btn-primary"}," Add contact ")])]),l("div",xC,[l("div",$C,[A[3]||(A[3]=l("h4",null,"Filter by role:",-1)),l("label",IC,[l("input",{type:"checkbox",checked:s.value,onChange:d},null,40,TC),A[2]||(A[2]=Ve(" All roles ",-1))]),s.value?D("",!0):(v(),m("div",MC,[l("div",AC,[(v(!0),m(we,null,Pe(c.value,$=>(v(),m("label",{key:$,class:"checkbox-item"},[l("input",{type:"checkbox",checked:a.value.includes($),onChange:C=>p($)},null,40,EC),Ve(" "+_(I($)),1)]))),128))])]))]),u.value?(v(),m("button",{key:0,onClick:f,class:"btn btn-secondary btn-small"}," Clear filters ")):D("",!0)]),l("div",PC,[y.value.length===0?(v(),m("div",DC,[l("p",null,_(u.value?"No contacts match the selected filters.":"No contacts yet. Create one to get started!"),1)])):D("",!0),(v(!0),m(we,null,Pe(b.value,$=>(v(),m("div",{key:$.contactId,class:_e(["contact-card",{primary:$.isPrimary}]),onClick:C=>E.$emit("select-contact",$)},[l("div",RC,[l("div",BC,[$.isPrimary?(v(),m("span",NC,"")):D("",!0),l("strong",null,_($.name),1),l("span",FC,_(I($.role)),1)]),l("div",UC,[$.phone?(v(),m("span",zC,_($.phone),1)):D("",!0),$.email?(v(),m("span",HC,_($.email),1)):D("",!0)])]),$.notes?(v(),m("div",VC,_(O($.notes)),1)):D("",!0),l("div",GC,[(v(!0),m(we,null,Pe($.scopeConfigurations,(C,w)=>(v(),m("span",{key:w,class:"scope-badge"},_(S(C)),1))),128))])],10,OC))),128))])]))}},jC=Ye(ZC,[["__scopeId","data-v-0700af03"]]),WC={class:"event-details-tab"},qC={class:"event-info-card"},KC={class:"form-group"},YC={class:"form-group"},JC={class:"form-row"},XC={class:"form-group"},QC={class:"form-group"},e2=["value"],t2={class:"form-actions"},n2=["disabled"],o2={__name:"EventDetailsTab",props:{eventData:{type:Object,required:!0},formDirty:{type:Boolean,default:!1}},emits:["submit","update:formDirty"],setup(e,{emit:t}){const o=e,i=t,s=P({...o.eventData});We(()=>o.eventData,u=>{s.value={...u}},{deep:!0});const a=()=>{i("update:formDirty",!0)},c=()=>{i("submit",{...s.value})};return(u,d)=>(v(),m("div",WC,[l("div",qC,[l("form",{onSubmit:gt(c,["prevent"]),class:"event-details-form"},[l("div",KC,[d[4]||(d[4]=l("label",null,"Event name",-1)),Ge(l("input",{"onUpdate:modelValue":d[0]||(d[0]=p=>s.value.name=p),type:"text",required:"",class:"form-input",onInput:a},null,544),[[at,s.value.name]])]),l("div",YC,[d[5]||(d[5]=l("label",null,"Description",-1)),Ge(l("textarea",{"onUpdate:modelValue":d[1]||(d[1]=p=>s.value.description=p),rows:"3",class:"form-input",onInput:a},null,544),[[at,s.value.description]])]),l("div",JC,[l("div",XC,[d[6]||(d[6]=l("label",null,"Event date & time",-1)),Ge(l("input",{"onUpdate:modelValue":d[2]||(d[2]=p=>s.value.eventDate=p),type:"datetime-local",required:"",class:"form-input",onInput:a},null,544),[[at,s.value.eventDate]])]),l("div",QC,[d[7]||(d[7]=l("label",null,"Time zone",-1)),Ge(l("select",{"onUpdate:modelValue":d[3]||(d[3]=p=>s.value.timeZoneId=p),required:"",class:"form-input",onChange:a},[(v(!0),m(we,null,Pe(V(Vp),p=>(v(),m("option",{key:p.value,value:p.value},_(p.label),9,e2))),128))],544),[[vn,s.value.timeZoneId]])])]),l("div",t2,[l("button",{type:"submit",class:"btn btn-primary",disabled:!e.formDirty}," Save Changes ",8,n2)])],32)])]))}},s2=Ye(o2,[["__scopeId","data-v-0f443e74"]]),i2={class:"admins-list"},a2={class:"admin-info"},r2={class:"admin-role"},l2=["onClick"],c2={__name:"AdminsList",props:{admins:{type:Array,required:!0}},emits:["add-admin","remove-admin"],setup(e){return(t,o)=>(v(),m("div",null,[o[1]||(o[1]=l("h3",null,"Event administrators",-1)),l("button",{onClick:o[0]||(o[0]=i=>t.$emit("add-admin")),class:"btn btn-small btn-primary"}," Add administrator "),l("div",i2,[(v(!0),m(we,null,Pe(e.admins,i=>(v(),m("div",{key:i.userEmail,class:"admin-item"},[l("div",a2,[l("strong",null,_(i.userEmail),1),l("span",r2,_(i.role),1)]),e.admins.length>1?(v(),m("button",{key:0,onClick:s=>t.$emit("remove-admin",i.userEmail),class:"btn btn-small btn-danger"}," Remove ",8,l2)):D("",!0)]))),128))])]))}},u2=Ye(c2,[["__scopeId","data-v-c76441fb"]]),qn=[{name:"Charcoal",hex:"#2d3748"},{name:"Dark Gray",hex:"#4a5568"},{name:"Gray",hex:"#718096"},{name:"Red",hex:"#f56565"},{name:"Coral",hex:"#ff6b6b"},{name:"Rose",hex:"#fb7185"},{name:"Pink",hex:"#ed64a6"},{name:"Magenta",hex:"#d946ef"},{name:"Fuchsia",hex:"#e879f9"},{name:"Purple",hex:"#9f7aea"},{name:"Violet",hex:"#a78bfa"},{name:"Lavender",hex:"#b197fc"},{name:"Indigo",hex:"#5a67d8"},{name:"Navy",hex:"#4263eb"},{name:"Blue",hex:"#667eea"},{name:"Sky",hex:"#0ea5e9"},{name:"Cyan",hex:"#0bc5ea"},{name:"Aqua",hex:"#22d3ee"},{name:"Teal",hex:"#38b2ac"},{name:"Emerald",hex:"#10b981"},{name:"Green",hex:"#48bb78"},{name:"Mint",hex:"#51cf66"},{name:"Lime",hex:"#84cc16"},{name:"Olive",hex:"#a3b18a"},{name:"Yellow",hex:"#ecc94b"},{name:"Amber",hex:"#f59e0b"},{name:"Orange",hex:"#ed8936"},{name:"Peach",hex:"#ff922b"},{name:"Light Gray",hex:"#cbd5e0"},{name:"Silver",hex:"#e2e8f0"},{name:"Cream",hex:"#f7fafc"}],Wr="#667eea";function xh(e){const t=e.map(i=>i.color);return qn.find(i=>!t.includes(i.hex))?.hex||Wr}const d2={class:"modal-content"},h2={class:"modal-body"},f2={class:"preview-section"},p2={class:"map-preview"},v2=["innerHTML"],m2={class:"options-grid"},g2={class:"option-button-content"},y2={class:"option-button-value icon-value"},_2=["innerHTML"],k2={class:"option-button-content"},b2={class:"option-button-value color-value"},w2=["disabled"],C2={class:"option-button-content"},L2={class:"option-button-value color-value"},S2={class:"option-button-content"},x2={class:"option-button-value icon-value"},$2=["innerHTML"],I2=["disabled"],T2={class:"option-button-content"},M2={class:"option-button-value color-value"},A2={class:"option-button-content"},E2={class:"option-button-value"},P2={class:"option-button-content"},D2={class:"option-button-value"},O2={key:0,class:"centered-popup"},R2={class:"popup-grid"},B2=["onClick"],N2=["innerHTML"],F2={key:0},U2={key:1,class:"centered-popup"},z2={class:"popup-grid"},H2=["title","onClick"],V2=["innerHTML"],G2={key:0},Z2={key:2,class:"centered-popup"},j2={class:"popup-grid"},W2=["title","onClick"],q2=["innerHTML"],K2={key:0},Y2={key:3,class:"centered-popup icon-popup"},J2={class:"popup-grid"},X2=["onClick"],Q2=["innerHTML"],eL={key:0},tL={key:4,class:"centered-popup"},nL={class:"popup-grid"},oL=["title","onClick"],sL=["innerHTML"],iL={key:0},aL={key:5,class:"centered-popup"},rL={class:"size-grid"},lL=["onClick"],cL=["innerHTML"],uL={key:6,class:"centered-popup"},dL={class:"rotation-content"},hL={class:"rotation-preview-container"},fL=["innerHTML"],pL={class:"rotation-control"},vL={class:"rotation-slider-container"},mL=["value"],gL={class:"rotation-value"},yL={class:"rotation-presets"},_L="#667eea",kL={__name:"IconCustomizationModal",props:{isOpen:{type:Boolean,default:!1},iconType:{type:String,default:"none"},backgroundShape:{type:String,default:"circle"},backgroundColor:{type:String,default:""},borderColor:{type:String,default:""},iconColor:{type:String,default:""},size:{type:String,default:"100"},mapRotation:{type:[String,Number],default:""},level:{type:String,default:"checkpoint"},inheritedType:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""}},emits:["update:isOpen","apply","cancel"],setup(e,{emit:t}){const o=e,i=t,s=P(o.backgroundShape||"circle"),a=P(o.iconType||"none"),c=P(o.backgroundColor||""),u=P(o.borderColor||""),d=P(o.iconColor||""),p=P(o.size||"100"),f=P(o.mapRotation??""),y=P(null),b=ae=>ae==="default"?o.inheritedBackgroundShape||"circle":ae==="none"?"none":ae||"circle",I=ae=>ae==="default"||!ae?ne():ae==="none"?"transparent":ae,T=ae=>ae==="default"?o.inheritedBorderColor||"#ffffff":ae==="none"||!ae?"transparent":ae,S=ae=>{if(ae==="default"){const oe=o.inheritedType;return oe&&oe!=="default"&&Mi(oe).category==="content"?oe:"none"}return ae==="none"||!ae?"none":ae},O=ae=>ae==="default"||!ae?o.inheritedIconColor||"#ffffff":ae==="none"?"transparent":ae,E=ae=>ae==="default"?o.inheritedSize||"100":ae||"100",A=ae=>{if(ae==="default"||ae===""){const oe=o.inheritedMapRotation;return oe!==""&&oe!==void 0&&oe!==null&&parseInt(oe,10)||0}return parseInt(ae,10)||0},$=Y(()=>{const ae=o.inheritedBackgroundShape||"circle",oe=Or.find(J=>J.value===ae)?.label||"Circle";return[{value:"none",label:"None",showLabel:!0},{value:"default",label:`Default (${oe})`,showLabel:!0},...Or.filter(J=>J.value!=="none").map(J=>({...J,showLabel:!1}))]}),C=Y(()=>{const ae=al.filter(Ze=>Ze.category==="content"),oe=[{value:"none",label:"None",category:"content",showLabel:!0}],J=o.inheritedType;if(J&&J!=="default"){const Ze=Mi(J);Ze.category==="content"&&oe.push({value:"default",label:`Default (${Ze.label||J})`,category:"content",showLabel:!0})}return oe.push(...ae.map(Ze=>({...Ze,showLabel:!1}))),oe}),w=Y(()=>{const ae={33:"Small",66:"Medium",100:"Normal",150:"Large"};return[{value:"default",label:`Default (${ae[o.inheritedSize]||"Normal"})`},...lw.map(J=>({value:J.value,label:ae[J.value]||J.label}))]}),k=Y(()=>b(s.value)!=="none"),M=Y(()=>S(a.value)!=="none"),G=Y(()=>{const ae=o.inheritedBackgroundColor;return ae&&ae!=="default"&&ae.startsWith("#")?ae:_L}),ne=()=>G.value,ce=Y(()=>c.value&&c.value!=="default"?c.value:ne()),K=Y(()=>u.value==="none"?"transparent":u.value?u.value:o.inheritedBorderColor&&o.inheritedBorderColor!=="none"?o.inheritedBorderColor:"#ffffff"),se=Y(()=>d.value?d.value:o.inheritedIconColor?o.inheritedIconColor:"#ffffff"),me=Y(()=>{const ae=G.value,oe=qn.find(J=>J.hex.toLowerCase()===ae.toLowerCase())?.name||"Custom";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${oe})`,showLabel:!0},...qn.map(J=>({hex:J.hex,name:J.name,showLabel:!1}))]}),Re=Y(()=>{const ae=o.inheritedBorderColor||"#ffffff",oe=ae==="#ffffff"?"White":qn.find(J=>J.hex===ae)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${oe})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...qn.filter(J=>J.hex!=="#ffffff").map(J=>({hex:J.hex,name:J.name,showLabel:!1}))]}),Oe=Y(()=>{const ae=o.inheritedIconColor||"#ffffff",oe=ae==="#ffffff"?"White":qn.find(J=>J.hex===ae)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${oe})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...qn.filter(J=>J.hex!=="#ffffff").map(J=>({hex:J.hex,name:J.name,showLabel:!1}))]}),de=ae=>ae==="default"?!c.value||c.value==="default":c.value===ae,he=ae=>ae==="#ffffff"?!d.value||d.value==="#ffffff":d.value===ae,ve=ae=>{if(ae==="none")return"None";if(ae==="default"){const J=o.inheritedBackgroundShape;return J?`Default (${Or.find(Xe=>Xe.value===J)?.label||"Circle"})`:"Default (Circle)"}const oe=Or.find(J=>J.value===ae);return oe?oe.label:"Circle"},Te=ae=>{if(ae==="none")return"None";if(ae==="default"){const J=o.inheritedType;if(J&&J!=="default"){const Ze=Mi(J);if(Ze.category==="content")return`Default (${Ze.label||J})`}return"Default"}const oe=al.find(J=>J.value===ae);return oe?oe.label:"None"},fe=ae=>{if(ae==="none")return"None";if(!ae||ae==="default"){const J=G.value;return`Default (${qn.find(Xe=>Xe.hex.toLowerCase()===J.toLowerCase())?.name||"Custom"})`}const oe=[...qn].find(J=>J.hex.toLowerCase()===ae.toLowerCase());return oe?oe.name:ae},xe=ae=>{if(ae==="none")return"None";if(ae==="default"){const J=o.inheritedBorderColor;return J&&J!=="none"?`Default (${J==="#ffffff"?"White":qn.find(Xe=>Xe.hex===J)?.name||"Custom"})`:"Default (White)"}if(!ae||ae==="#ffffff")return"White";const oe=[...Re.value].find(J=>J.hex===ae);return oe?oe.name:ae},Be=ae=>{if(ae==="none")return"None";if(ae==="default"){const J=o.inheritedIconColor;return J?`Default (${J==="#ffffff"?"White":qn.find(Xe=>Xe.hex===J)?.name||"Custom"})`:"Default (White)"}if(!ae||ae==="#ffffff")return"White";const oe=[...Oe.value].find(J=>J.hex===ae);return oe?oe.name:ae},re=ae=>{const oe={33:"Small",66:"Medium",100:"Normal",150:"Large"};if(ae==="default"){const J=o.inheritedSize;return`Default (${oe[J]||"Normal"})`}return oe[ae]||"Normal"},Ee=ae=>{if(ae==="default"||ae===""||ae===void 0||ae===null){const oe=o.inheritedMapRotation;return oe!==""&&oe!==void 0&&oe!==null?`Default (${oe})`:"Default (0)"}return`${ae}`},Me=ae=>{if(ae==="none")return`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`;const oe=b(ae),J=I(c.value),Ze=T(u.value);return Ki[oe]?`<svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">${Ki[oe]({backgroundColor:J,borderColor:Ze==="transparent"?"none":Ze})}</svg>`:""},$e=ae=>{const oe=S(ae);return oe==="none"?`<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
      <rect x="1" y="1" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`:Xt({type:oe,backgroundShape:"circle",backgroundColor:"#94a3b8",borderColor:"none",iconColor:"#fff",size:"75"})},ue=ae=>{const oe=b(ae);if(oe==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="none" stroke="#ccc" stroke-width="2" stroke-dasharray="4"/>
    </svg>`;const J=I(c.value),Ze=T(u.value),Xe=S(a.value),rt=O(d.value);return Xt({type:Xe!=="none"?Xe:oe,backgroundShape:oe,backgroundColor:J,borderColor:Ze==="transparent"?"none":Ze,iconColor:rt,size:"100",outputSize:28})},ye=ae=>{const oe=I(ae),J=b(s.value),Ze=T(u.value),Xe=S(a.value),rt=O(d.value);return J==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${oe==="transparent"?"#e2e8f0":oe}"/>
    </svg>`:Xt({type:Xe!=="none"?Xe:J,backgroundShape:J,backgroundColor:oe==="transparent"?"#e2e8f0":oe,borderColor:Ze==="transparent"?"none":Ze,iconColor:rt,size:"100",outputSize:28})},z=ae=>{const oe=T(ae),J=b(s.value),Ze=I(c.value),Xe=S(a.value),rt=O(d.value);return J==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0" stroke="${oe}" stroke-width="2"/>
    </svg>`:Xt({type:Xe!=="none"?Xe:J,backgroundShape:J,backgroundColor:Ze,borderColor:oe==="transparent"?"none":oe,iconColor:rt,size:"100",outputSize:28})},ee=ae=>{const oe=S(ae),J=b(s.value),Ze=I(c.value),Xe=T(u.value),rt=O(d.value);if(oe==="none"&&J==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0"/>
      <line x1="8" y1="8" x2="20" y2="20" stroke="#a0aec0" stroke-width="2" stroke-linecap="round"/>
    </svg>`;const ft=J!=="none"?J:"circle";return Xt({type:oe!=="none"?oe:ft,backgroundShape:ft,backgroundColor:Ze,borderColor:Xe==="transparent"?"none":Xe,iconColor:rt,size:"100",outputSize:42})},ie=ae=>{const oe=O(ae),J=b(s.value),Ze=I(c.value),Xe=T(u.value),rt=S(a.value);return rt==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${oe==="transparent"?"#e2e8f0":oe}"/>
    </svg>`:Xt({type:rt,backgroundShape:J!=="none"?J:"circle",backgroundColor:Ze,borderColor:Xe==="transparent"?"none":Xe,iconColor:oe==="transparent"?"#e2e8f0":oe,size:"100",outputSize:28})},B=ae=>{const oe=E(ae),J=b(s.value),Ze=I(c.value),Xe=T(u.value),rt=S(a.value),ft=O(d.value);if(J==="none"&&rt==="none")return"";const vt=J!=="none"?J:"circle";return Xt({type:rt!=="none"?rt:vt,backgroundShape:vt,backgroundColor:Ze,borderColor:Xe==="transparent"?"none":Xe,iconColor:ft,size:oe})},j=Y(()=>{const ae=b(s.value),oe=I(c.value),J=T(u.value),Ze=S(a.value),Xe=O(d.value),rt=E(p.value);return ae==="none"&&Ze==="none"?"":Xt(ae==="none"&&Ze!=="none"?{type:Ze,backgroundShape:"none",backgroundColor:oe,borderColor:"none",iconColor:Xe,size:rt}:{type:Ze!=="none"?Ze:ae,backgroundShape:ae,backgroundColor:oe,borderColor:J==="transparent"?"none":J,iconColor:Xe,size:rt})}),X=ae=>{y.value=y.value===ae?null:ae},q=()=>{y.value=null},F=ae=>{s.value=ae,q()},N=ae=>{c.value=ae,q()},W=ae=>{u.value=ae,q()},ge=ae=>{a.value=ae,q()},Se=ae=>{d.value=ae,q()},Ce=ae=>{p.value=ae,q()},ze=ae=>{f.value=ae,q()},Fe=ae=>{f.value=ae};We(()=>o.isOpen,ae=>{if(ae){const oe=o.backgroundShape&&o.backgroundShape!=="default"&&o.backgroundShape!=="circle",J=o.iconType&&o.iconType!=="none"&&o.iconType!=="default",Ze=o.backgroundColor&&o.backgroundColor!=="",Xe=o.borderColor&&o.borderColor!=="",rt=o.iconColor&&o.iconColor!=="",ft=o.size&&o.size!==""&&o.size!=="100",vt=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null&&o.mapRotation!==0;oe||J||Ze||Xe||rt||ft||vt?(s.value=o.backgroundShape||"default",a.value=o.iconType||"default",c.value=o.backgroundColor||"default",u.value=o.borderColor||"default",d.value=o.iconColor||"default",p.value=o.size||"default",f.value=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null?o.mapRotation:"default"):(s.value="default",a.value="default",c.value="default",u.value="default",d.value="default",p.value="default",f.value="default"),y.value=null}});const je=()=>{q(),i("update:isOpen",!1),i("cancel")},Je=()=>{q();const ae=Ze=>Ze==="default"?"":Ze;let oe="";a.value==="none"?oe="none":a.value&&a.value!=="default"&&(oe=a.value);let J="";f.value!=="default"&&f.value!==""&&f.value!==void 0&&(J=parseInt(f.value,10)||0),i("apply",{iconType:oe,backgroundShape:ae(s.value),backgroundColor:ae(c.value),borderColor:ae(u.value),iconColor:ae(d.value),size:ae(p.value),mapRotation:J}),i("update:isOpen",!1)};return(ae,oe)=>e.isOpen?(v(),m("div",{key:0,class:"modal-overlay",onClick:gt(je,["self"])},[l("div",d2,[l("div",{class:"modal-header"},[oe[15]||(oe[15]=l("h3",null,"Customise marker style",-1)),l("button",{class:"close-btn",onClick:je},"")]),l("div",h2,[l("div",f2,[l("div",p2,[oe[16]||(oe[16]=l("div",{class:"map-background"},null,-1)),l("div",{class:"preview-icon",style:ot({transform:`rotate(${A(f.value)}deg)`}),innerHTML:j.value},null,12,v2)])]),l("div",m2,[l("button",{type:"button",class:_e(["option-button",{active:y.value==="shape"}]),onClick:oe[0]||(oe[0]=J=>X("shape"))},[l("div",g2,[oe[17]||(oe[17]=l("span",{class:"option-button-label"},"Shape",-1)),l("div",y2,[l("div",{class:"icon-preview-small",innerHTML:Me(s.value)},null,8,_2),l("span",null,_(ve(s.value)),1)])]),oe[18]||(oe[18]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:_e(["option-button",{active:y.value==="bgColor"}]),onClick:oe[1]||(oe[1]=J=>X("bgColor"))},[l("div",k2,[oe[19]||(oe[19]=l("span",{class:"option-button-label"},"Background",-1)),l("div",b2,[l("span",{class:"color-swatch",style:ot({backgroundColor:ce.value})},null,4),l("span",null,_(fe(c.value)),1)])]),oe[20]||(oe[20]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:_e(["option-button",{active:y.value==="borderColor",disabled:!k.value}]),disabled:!k.value,onClick:oe[2]||(oe[2]=J=>X("borderColor"))},[l("div",C2,[oe[21]||(oe[21]=l("span",{class:"option-button-label"},"Border",-1)),l("div",L2,[l("span",{class:_e(["color-swatch",{"no-border":u.value==="none"}]),style:ot(u.value!=="none"?{backgroundColor:K.value}:{})},null,6),l("span",null,_(xe(u.value)),1)])]),oe[22]||(oe[22]=l("span",{class:"option-button-arrow"},"",-1))],10,w2),l("button",{type:"button",class:_e(["option-button",{active:y.value==="icon"}]),onClick:oe[3]||(oe[3]=J=>X("icon"))},[l("div",S2,[oe[23]||(oe[23]=l("span",{class:"option-button-label"},"Icon",-1)),l("div",x2,[l("div",{class:"icon-preview-small",innerHTML:$e(a.value)},null,8,$2),l("span",null,_(Te(a.value)),1)])]),oe[24]||(oe[24]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:_e(["option-button",{active:y.value==="iconColor",disabled:!M.value}]),disabled:!M.value,onClick:oe[4]||(oe[4]=J=>X("iconColor"))},[l("div",T2,[oe[25]||(oe[25]=l("span",{class:"option-button-label"},"Colour",-1)),l("div",M2,[l("span",{class:"color-swatch",style:ot({backgroundColor:se.value})},null,4),l("span",null,_(Be(d.value)),1)])]),oe[26]||(oe[26]=l("span",{class:"option-button-arrow"},"",-1))],10,I2),l("button",{type:"button",class:_e(["option-button",{active:y.value==="size"}]),onClick:oe[5]||(oe[5]=J=>X("size"))},[l("div",A2,[oe[27]||(oe[27]=l("span",{class:"option-button-label"},"Size",-1)),l("span",E2,_(re(p.value)),1)]),oe[28]||(oe[28]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:_e(["option-button option-button-full",{active:y.value==="mapRotation"}]),onClick:oe[6]||(oe[6]=J=>X("mapRotation"))},[l("div",P2,[oe[29]||(oe[29]=l("span",{class:"option-button-label"},"Map rotation",-1)),l("span",D2,_(Ee(f.value)),1)]),oe[30]||(oe[30]=l("span",{class:"option-button-arrow"},"",-1))],2)]),y.value==="shape"?(v(),m("div",O2,[l("div",{class:"popup-header"},[oe[31]||(oe[31]=l("span",null,"Select shape",-1)),l("button",{type:"button",class:"popup-close",onClick:q},"")]),l("div",R2,[(v(!0),m(we,null,Pe($.value,J=>(v(),m("button",{key:J.value,type:"button",class:_e(["popup-grid-item",{selected:s.value===J.value}]),onClick:Ze=>F(J.value)},[l("div",{class:"popup-item-preview",innerHTML:ue(J.value)},null,8,N2),J.showLabel?(v(),m("span",F2,_(J.label),1)):D("",!0)],10,B2))),128))])])):D("",!0),y.value==="bgColor"?(v(),m("div",U2,[l("div",{class:"popup-header"},[oe[32]||(oe[32]=l("span",null,"Select background",-1)),l("button",{type:"button",class:"popup-close",onClick:q},"")]),l("div",z2,[(v(!0),m(we,null,Pe(me.value,J=>(v(),m("button",{key:J.hex,type:"button",class:_e(["popup-grid-item",{selected:de(J.hex)}]),title:J.name,onClick:Ze=>N(J.hex)},[l("div",{class:"popup-item-preview",innerHTML:ye(J.hex)},null,8,V2),J.showLabel?(v(),m("span",G2,_(J.name),1)):D("",!0)],10,H2))),128))])])):D("",!0),y.value==="borderColor"?(v(),m("div",Z2,[l("div",{class:"popup-header"},[oe[33]||(oe[33]=l("span",null,"Select border",-1)),l("button",{type:"button",class:"popup-close",onClick:q},"")]),l("div",j2,[(v(!0),m(we,null,Pe(Re.value,J=>(v(),m("button",{key:J.hex,type:"button",class:_e(["popup-grid-item",{selected:u.value===J.hex}]),title:J.name,onClick:Ze=>W(J.hex)},[l("div",{class:"popup-item-preview",innerHTML:z(J.hex)},null,8,q2),J.showLabel?(v(),m("span",K2,_(J.name),1)):D("",!0)],10,W2))),128))])])):D("",!0),y.value==="icon"?(v(),m("div",Y2,[l("div",{class:"popup-header"},[oe[34]||(oe[34]=l("span",null,"Select icon",-1)),l("button",{type:"button",class:"popup-close",onClick:q},"")]),l("div",J2,[(v(!0),m(we,null,Pe(C.value,J=>(v(),m("button",{key:J.value,type:"button",class:_e(["popup-grid-item",{selected:a.value===J.value}]),onClick:Ze=>ge(J.value)},[l("div",{class:"popup-item-preview",innerHTML:ee(J.value)},null,8,Q2),J.showLabel?(v(),m("span",eL,_(J.label),1)):D("",!0)],10,X2))),128))])])):D("",!0),y.value==="iconColor"?(v(),m("div",tL,[l("div",{class:"popup-header"},[oe[35]||(oe[35]=l("span",null,"Select colour",-1)),l("button",{type:"button",class:"popup-close",onClick:q},"")]),l("div",nL,[(v(!0),m(we,null,Pe(Oe.value,J=>(v(),m("button",{key:J.hex,type:"button",class:_e(["popup-grid-item",{selected:he(J.hex)}]),title:J.name,onClick:Ze=>Se(J.hex)},[l("div",{class:"popup-item-preview",innerHTML:ie(J.hex)},null,8,sL),J.showLabel?(v(),m("span",iL,_(J.name),1)):D("",!0)],10,oL))),128))])])):D("",!0),y.value==="size"?(v(),m("div",aL,[l("div",{class:"popup-header"},[oe[36]||(oe[36]=l("span",null,"Select size",-1)),l("button",{type:"button",class:"popup-close",onClick:q},"")]),l("div",rL,[(v(!0),m(we,null,Pe(w.value,J=>(v(),m("button",{key:J.value,type:"button",class:_e(["size-grid-item",{selected:p.value===J.value}]),onClick:Ze=>Ce(J.value)},[l("div",{class:"size-preview",innerHTML:B(J.value)},null,8,cL),l("span",null,_(J.label),1)],10,lL))),128))])])):D("",!0),y.value==="mapRotation"?(v(),m("div",uL,[l("div",{class:"popup-header"},[oe[37]||(oe[37]=l("span",null,"Set map rotation",-1)),l("button",{type:"button",class:"popup-close",onClick:q},"")]),l("div",dL,[l("div",hL,[l("div",{class:"rotation-preview-icon",style:ot({transform:`rotate(${A(f.value)}deg)`}),innerHTML:j.value},null,12,fL)]),oe[38]||(oe[38]=l("p",{class:"rotation-description"}," Rotate the marker on the map. This rotation is added to any map rotation. ",-1)),l("div",pL,[l("button",{type:"button",class:_e(["rotation-preset",{selected:f.value==="default"||f.value===""}]),onClick:oe[7]||(oe[7]=J=>ze("default"))}," Default ",2),l("div",vL,[l("input",{type:"range",min:"-180",max:"180",step:"5",class:"rotation-slider",value:f.value==="default"||f.value===""?0:f.value,onInput:oe[8]||(oe[8]=J=>Fe(parseInt(J.target.value,10)))},null,40,mL),l("div",gL,_(f.value==="default"||f.value===""?"0":f.value)+" ",1)])]),l("div",yL,[l("button",{type:"button",class:_e(["rotation-preset-btn",{selected:f.value===-90}]),onClick:oe[9]||(oe[9]=J=>ze(-90))},"-90",2),l("button",{type:"button",class:_e(["rotation-preset-btn",{selected:f.value===-45}]),onClick:oe[10]||(oe[10]=J=>ze(-45))},"-45",2),l("button",{type:"button",class:_e(["rotation-preset-btn",{selected:f.value===0}]),onClick:oe[11]||(oe[11]=J=>ze(0))},"0",2),l("button",{type:"button",class:_e(["rotation-preset-btn",{selected:f.value===45}]),onClick:oe[12]||(oe[12]=J=>ze(45))},"+45",2),l("button",{type:"button",class:_e(["rotation-preset-btn",{selected:f.value===90}]),onClick:oe[13]||(oe[13]=J=>ze(90))},"+90",2),l("button",{type:"button",class:_e(["rotation-preset-btn",{selected:f.value===180}]),onClick:oe[14]||(oe[14]=J=>ze(180))},"180",2)])])])):D("",!0)]),l("div",{class:"modal-footer"},[l("button",{type:"button",class:"btn-cancel",onClick:je},"Cancel"),l("button",{type:"button",class:"btn-apply",onClick:Je},"Apply")])])])):D("",!0)}},bL=Ye(kL,[["__scopeId","data-v-b13795fe"]]),wL={class:"checkpoint-style-picker"},CL={class:"form-group"},LL={class:"style-options"},SL=["innerHTML"],xL={class:"option-label"},$L=["innerHTML"],IL="#667eea",TL={__name:"CheckpointStylePicker",props:{styleType:{type:String,default:"default"},styleColor:{type:String,default:""},styleBackgroundShape:{type:String,default:""},styleBackgroundColor:{type:String,default:""},styleBorderColor:{type:String,default:""},styleIconColor:{type:String,default:""},styleSize:{type:String,default:""},styleMapRotation:{type:[String,Number],default:""},iconLabel:{type:String,default:"Marker style"},showPreview:{type:Boolean,default:!0},inheritedStyleType:{type:String,default:"default"},inheritedStyleColor:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""},defaultLabel:{type:String,default:"Default"},level:{type:String,default:"checkpoint"}},emits:["update:styleType","update:styleColor","update:styleBackgroundShape","update:styleBackgroundColor","update:styleBorderColor","update:styleIconColor","update:styleSize","update:styleMapRotation","change"],setup(e,{emit:t}){const o=e,i=t,s=P(o.styleType),a=P(o.styleColor||""),c=P(o.styleBackgroundShape||"default"),u=P(o.styleBackgroundColor||""),d=P(o.styleBorderColor||""),p=P(o.styleIconColor||""),f=P(o.styleSize||"default"),y=P(o.styleMapRotation||""),b=K=>!K||K==="default"?!1:Mi(K).category==="content",I=P(o.styleType&&o.styleType!=="default"&&o.styleType!=="custom"&&b(o.styleType)?o.styleType:"default"),T=P(!1),S=Y(()=>!!(s.value&&s.value!=="default"||c.value&&c.value!=="default"&&c.value!=="circle"||u.value||d.value||p.value||f.value&&f.value!=="default"&&f.value!=="100")),O=K=>K&&K!==""&&K!=="default",E=K=>K&&K.startsWith("#"),A=Y(()=>{const se=O(o.inheritedStyleType),me=O(o.inheritedBackgroundShape),Re=E(o.inheritedBackgroundColor)||E(o.inheritedStyleColor),Oe=E(o.inheritedBorderColor),de=E(o.inheritedIconColor),he=O(o.inheritedSize);if(se||me||Re||Oe||de||he){const Te=se?o.inheritedStyleType:me?o.inheritedBackgroundShape:"circle",fe=(E(o.inheritedBackgroundColor)?o.inheritedBackgroundColor:null)||(E(o.inheritedStyleColor)?o.inheritedStyleColor:null)||IL;return Xt({type:Te,backgroundShape:o.inheritedBackgroundShape||"circle",backgroundColor:fe,borderColor:o.inheritedBorderColor||"#ffffff",iconColor:o.inheritedIconColor||"#ffffff",size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#10B981"/>
        <stop offset="50%" style="stop-color:#F59E0B"/>
        <stop offset="100%" style="stop-color:#EF4444"/>
      </linearGradient>
    </defs>
    <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#defaultGradient)" stroke="#fff" stroke-width="1.5"/>
  </svg>`}),$=Y(()=>{const K=o.inheritedMapRotation;return K!==""&&K!==void 0&&K!==null&&K!==0?{transform:`rotate(${K}deg)`}:{}}),C=Y(()=>{if(y.value!==""&&y.value!==void 0&&y.value!==null){const se=parseInt(y.value,10)||0;if(se!==0)return{transform:`rotate(${se}deg)`}}const K=o.inheritedMapRotation;return K!==""&&K!==void 0&&K!==null&&K!==0?{transform:`rotate(${K}deg)`}:{}}),w=Y(()=>{if(S.value){const K=I.value&&I.value!=="none"&&I.value!=="default";let se=null;o.inheritedStyleType&&o.inheritedStyleType!=="default"&&o.inheritedStyleType!=="custom"&&Mi(o.inheritedStyleType).category==="content"&&(se=o.inheritedStyleType);const me=I.value==="default"&&se,Re=K||me,Oe=K?I.value:me?se:null,de=c.value&&c.value!=="default"?c.value:o.inheritedBackgroundShape||"circle",he=Re?Oe:de,ve=u.value||o.inheritedBackgroundColor||o.inheritedStyleColor||"#667eea",Te=d.value||o.inheritedBorderColor||"#ffffff",fe=p.value||o.inheritedIconColor||"#ffffff";return Xt({type:he,backgroundShape:de,backgroundColor:ve,borderColor:Te,iconColor:fe,size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#e2e8f0" stroke="#cbd5e0" stroke-width="1.5"/>
    <path d="M12 8v8M8 12h8" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
  </svg>`}),k=()=>{s.value="default",I.value="default",i("update:styleType","default"),c.value="default",u.value="",a.value="",d.value="",p.value="",f.value="default",y.value="",i("update:styleBackgroundShape",""),i("update:styleBackgroundColor",""),i("update:styleColor",""),i("update:styleBorderColor",""),i("update:styleIconColor",""),i("update:styleSize",""),i("update:styleMapRotation",""),ce()},M=()=>{T.value=!0},G=K=>{K.iconType==="none"?I.value="none":K.iconType?I.value=K.iconType:I.value="default",c.value=K.backgroundShape||"default",u.value=K.backgroundColor||"",d.value=K.borderColor||"",p.value=K.iconColor||"",f.value=K.size||"default",y.value=K.mapRotation??"";const se=K.iconType==="none"||K.iconType&&K.iconType!==""||K.backgroundShape||K.backgroundColor||K.borderColor||K.iconColor||K.size||K.mapRotation!==""&&K.mapRotation!==0;K.iconType&&K.iconType!=="none"?s.value=K.iconType:se?s.value="custom":s.value="default",i("update:styleType",s.value),i("update:styleBackgroundShape",K.backgroundShape),i("update:styleBackgroundColor",K.backgroundColor),i("update:styleBorderColor",K.borderColor),i("update:styleIconColor",K.iconColor),i("update:styleSize",K.size),i("update:styleMapRotation",K.mapRotation??""),ce()},ne=()=>{},ce=()=>{i("change",{styleType:s.value,styleColor:u.value||a.value,styleBackgroundShape:c.value,styleBackgroundColor:u.value,styleBorderColor:d.value,styleIconColor:p.value,styleSize:f.value,styleMapRotation:y.value})};return We(()=>o.styleType,K=>{s.value=K,K&&K!=="default"&&K!=="custom"&&b(K)?I.value=K:I.value="default"}),We(()=>o.styleColor,K=>{a.value=K||""}),We(()=>o.styleBackgroundShape,K=>{c.value=K||"default"}),We(()=>o.styleBackgroundColor,K=>{u.value=K||""}),We(()=>o.styleBorderColor,K=>{d.value=K||""}),We(()=>o.styleIconColor,K=>{p.value=K||""}),We(()=>o.styleSize,K=>{f.value=K||"default"}),We(()=>o.styleMapRotation,K=>{y.value=K??""}),(K,se)=>(v(),m("div",wL,[l("div",CL,[l("label",null,_(e.iconLabel),1),l("div",LL,[l("button",{type:"button",class:_e(["style-option-button",{selected:!S.value}]),onClick:k},[l("div",{class:"option-preview",style:ot($.value),innerHTML:A.value},null,12,SL),l("span",xL,_(e.defaultLabel),1)],2),l("button",{type:"button",class:_e(["style-option-button",{selected:S.value}]),onClick:M},[l("div",{class:"option-preview",style:ot(C.value),innerHTML:w.value},null,12,$L),se[1]||(se[1]=l("span",{class:"option-label"},"Custom",-1))],2)])]),Ne(bL,{isOpen:T.value,"onUpdate:isOpen":se[0]||(se[0]=me=>T.value=me),"icon-type":I.value,"background-shape":c.value,"background-color":u.value,"border-color":d.value,"icon-color":p.value,size:f.value,"map-rotation":y.value,level:e.level,"inherited-type":e.inheritedStyleType,"inherited-background-shape":e.inheritedBackgroundShape,"inherited-background-color":e.inheritedBackgroundColor||e.inheritedStyleColor,"inherited-border-color":e.inheritedBorderColor,"inherited-icon-color":e.inheritedIconColor,"inherited-size":e.inheritedSize,"inherited-map-rotation":e.inheritedMapRotation,onApply:G,onCancel:ne},null,8,["isOpen","icon-type","background-shape","background-color","border-color","icon-color","size","map-rotation","level","inherited-type","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])]))}},Su=Ye(TL,[["__scopeId","data-v-c066da64"]]),ML={class:"logo-uploader"},AL={key:0,class:"logo-preview"},EL=["src"],PL=["disabled"],DL={key:0,class:"upload-progress"},OL={key:1,class:"upload-prompt"},RL={key:2,class:"error-message"},$h=500*1024,BL={__name:"LogoUploader",props:{modelValue:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,i=t,s=P(null),a=P(!1),c=P(!1),u=P(""),d=["image/png","image/jpeg","image/svg+xml","image/gif","image/webp"];function p(){a.value||s.value?.click()}function f(T){const S=T.target.files?.[0];S&&b(S),s.value&&(s.value.value="")}function y(T){c.value=!1;const S=T.dataTransfer?.files?.[0];S&&b(S)}async function b(T){if(u.value="",!d.includes(T.type)){u.value="Invalid file type. Please use PNG, JPEG, SVG, GIF, or WebP.";return}if(T.size>$h){u.value=`File too large. Maximum size is ${$h/1024}KB.`;return}a.value=!0;try{const S=await fetch(`/api/events/${o.eventId}/logo`,{method:"POST",headers:{"Content-Type":T.type,"X-Admin-Email":o.adminEmail},body:T});if(!S.ok){const E=await S.json().catch(()=>({}));throw new Error(E.message||"Upload failed")}const O=await S.json();i("update:modelValue",O.logoUrl)}catch(S){console.error("Logo upload error:",S),u.value=S.message||"Failed to upload logo. Please try again."}finally{a.value=!1}}async function I(){u.value="",a.value=!0;try{const T=await fetch(`/api/events/${o.eventId}/logo`,{method:"DELETE",headers:{"X-Admin-Email":o.adminEmail}});if(!T.ok){const S=await T.json().catch(()=>({}));throw new Error(S.message||"Delete failed")}i("update:modelValue","")}catch(T){console.error("Logo delete error:",T),u.value=T.message||"Failed to remove logo. Please try again."}finally{a.value=!1}}return(T,S)=>(v(),m("div",ML,[S[4]||(S[4]=l("label",{class:"uploader-label"},"Event Logo",-1)),e.modelValue?(v(),m("div",AL,[l("img",{src:e.modelValue,alt:"Event logo",class:"logo-image"},null,8,EL),l("button",{type:"button",class:"remove-btn",onClick:I,disabled:a.value}," Remove ",8,PL)])):(v(),m("div",{key:1,class:_e(["upload-area",{"drag-over":c.value,uploading:a.value}]),onDragover:S[0]||(S[0]=gt(O=>c.value=!0,["prevent"])),onDragleave:S[1]||(S[1]=gt(O=>c.value=!1,["prevent"])),onDrop:gt(y,["prevent"]),onClick:p},[l("input",{ref_key:"fileInput",ref:s,type:"file",accept:"image/png,image/jpeg,image/svg+xml,image/gif,image/webp",class:"file-input",onChange:f},null,544),a.value?(v(),m("div",DL,[...S[2]||(S[2]=[l("div",{class:"spinner"},null,-1),l("span",null,"Uploading...",-1)])])):(v(),m("div",OL,[...S[3]||(S[3]=[l("div",{class:"upload-icon"},"+",-1),l("span",{class:"upload-text"},"Click or drag to upload logo",-1),l("span",{class:"upload-hint"},"PNG, JPEG, SVG, GIF, WebP (max 500KB)",-1)])]))],34)),u.value?(v(),m("div",RL,_(u.value),1)):D("",!0)]))}},NL=Ye(BL,[["__scopeId","data-v-9c7104d5"]]),Jp=[{name:"Default",headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},{name:"Wasp",headerGradientStart:"#333333",headerGradientEnd:"#333333",accentColor:"#FFD700",pageGradientStart:"#FFD700",pageGradientEnd:"#333333"},{name:"Ocean",headerGradientStart:"#0077be",headerGradientEnd:"#00a8e8",accentColor:"#0077be",pageGradientStart:"#0077be",pageGradientEnd:"#00a8e8"},{name:"Forest",headerGradientStart:"#228b22",headerGradientEnd:"#32cd32",accentColor:"#228b22",pageGradientStart:"#228b22",pageGradientEnd:"#32cd32"},{name:"Sunset",headerGradientStart:"#ff6b35",headerGradientEnd:"#f7931e",accentColor:"#ff6b35",pageGradientStart:"#ff6b35",pageGradientEnd:"#f7931e"},{name:"Berry",headerGradientStart:"#8e2de2",headerGradientEnd:"#4a00e0",accentColor:"#8e2de2",pageGradientStart:"#8e2de2",pageGradientEnd:"#4a00e0"},{name:"Coral",headerGradientStart:"#ff758c",headerGradientEnd:"#ff7eb3",accentColor:"#ff758c",pageGradientStart:"#ff758c",pageGradientEnd:"#ff7eb3"},{name:"Steel",headerGradientStart:"#485563",headerGradientEnd:"#29323c",accentColor:"#485563",pageGradientStart:"#485563",pageGradientEnd:"#29323c"},{name:"Mint",headerGradientStart:"#11998e",headerGradientEnd:"#38ef7d",accentColor:"#11998e",pageGradientStart:"#11998e",pageGradientEnd:"#38ef7d"},{name:"Cherry",headerGradientStart:"#eb3349",headerGradientEnd:"#f45c43",accentColor:"#eb3349",pageGradientStart:"#eb3349",pageGradientEnd:"#f45c43"},{name:"Midnight",headerGradientStart:"#232526",headerGradientEnd:"#414345",accentColor:"#5c5c5c",pageGradientStart:"#232526",pageGradientEnd:"#414345"},{name:"Lavender",headerGradientStart:"#a18cd1",headerGradientEnd:"#fbc2eb",accentColor:"#a18cd1",pageGradientStart:"#a18cd1",pageGradientEnd:"#fbc2eb"},{name:"Gold",headerGradientStart:"#f7971e",headerGradientEnd:"#ffd200",accentColor:"#f7971e",pageGradientStart:"#f7971e",pageGradientEnd:"#ffd200"}];function FL(){return{...Jp[0]}}function UL(e,t){return{...e,headerGradientStart:t.headerGradientStart,headerGradientEnd:t.headerGradientEnd,accentColor:t.accentColor,pageGradientStart:t.pageGradientStart,pageGradientEnd:t.pageGradientEnd,logoUrl:"",logoPosition:""}}function Yc(e){const t=e.replace("#",""),o=parseInt(t.slice(0,2),16)/255,i=parseInt(t.slice(2,4),16)/255,s=parseInt(t.slice(4,6),16)/255,a=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),c=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*a+.7152*c+.0722*u}function Xp(e){return!e||e===""?"#ffffff":Yc(e)>.179?"#333333":"#ffffff"}function Qp(e,t){const o=e||Bn.headerGradientStart,i=t||Bn.headerGradientEnd,s=Yc(o),a=Yc(i);return(s+a)/2>.35?"#333333":"#ffffff"}const Bn={headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},zL={class:"marshal-mockup-container"},HL={class:"presets-section"},VL={class:"presets-row"},GL=["title","onClick"],ZL={class:"preset-name"},jL={class:"mockup-frame"},WL={key:0,class:"logo-cover-bg"},qL=["src"],KL=["src"],YL={key:1,class:"logo-placeholder"},JL={class:"event-name"},XL={class:"mockup-buttons"},QL=["src"],eS={key:1,class:"logo-placeholder"},tS={class:"mockup-body"},nS={class:"mockup-card"},oS={class:"card-content"},sS={class:"editor-modal"},iS={class:"editor-header"},aS={class:"editor-content"},rS={class:"color-grid-inline"},lS={class:"color-field"},cS={class:"color-swatches"},uS=["title","onClick"],dS={key:0,class:"check"},hS={class:"color-field"},fS={class:"color-swatches"},pS=["title","onClick"],vS={key:0,class:"check"},mS={class:"logo-position-section"},gS={class:"position-buttons"},yS={class:"color-swatches"},_S=["title","onClick"],kS={key:0,class:"check"},bS={class:"color-grid-inline"},wS={class:"color-field"},CS={class:"color-swatches"},LS=["title","onClick"],SS={key:0,class:"check"},xS={class:"color-field"},$S={class:"color-swatches"},IS=["title","onClick"],TS={key:0,class:"check"},MS={class:"editor-footer"},AS={__name:"MarshalModeMockup",props:{branding:{type:Object,required:!0},eventName:{type:String,default:""},eventDate:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:branding"],setup(e,{emit:t}){const o=qn,i=e,s=t,a=P(null),c=Jp,u={header:"Header gradient",logo:"Event logo",accent:"Accent colour",page:"Page background"},d=Y(()=>i.branding.headerGradientStart||Bn.headerGradientStart),p=Y(()=>i.branding.headerGradientEnd||Bn.headerGradientEnd),f=Y(()=>i.branding.accentColor||Bn.accentColor),y=Y(()=>i.branding.pageGradientStart||Bn.pageGradientStart),b=Y(()=>i.branding.pageGradientEnd||Bn.pageGradientEnd),I=Y(()=>i.branding.logoPosition||"left"),T=Y(()=>({background:`linear-gradient(135deg, ${d.value} 0%, ${p.value} 100%)`})),S=Y(()=>Qp(d.value,p.value)),O=Y(()=>({background:f.value,color:Xp(f.value)})),E=Y(()=>({background:`linear-gradient(135deg, ${y.value} 0%, ${b.value} 100%)`}));function A(w){a.value=a.value===w?null:w}function $(w,k){s("update:branding",{...i.branding,[w]:k})}function C(w){s("update:branding",UL(i.branding,w)),a.value=null}return(w,k)=>(v(),m("div",zL,[l("div",HL,[k[13]||(k[13]=l("span",{class:"presets-label"},"Quick themes:",-1)),l("div",VL,[(v(!0),m(we,null,Pe(V(c),M=>(v(),m("button",{key:M.name,type:"button",class:"preset-btn",title:M.name,onClick:G=>C(M)},[l("span",{class:"preset-preview",style:ot({background:`linear-gradient(135deg, ${M.pageGradientStart} 0%, ${M.pageGradientEnd} 100%)`})},null,4),l("span",ZL,_(M.name),1)],8,GL))),128))])]),l("div",jL,[l("div",{class:_e(["mockup-page",{"region-active":a.value==="page"}]),style:ot(E.value),onClick:k[5]||(k[5]=M=>A("page"))},[l("div",{class:_e(["mockup-header",[{"region-active":a.value==="header"},`logo-${I.value}`]]),style:ot(T.value),onClick:k[3]||(k[3]=gt(M=>A("header"),["stop"]))},[e.branding.logoUrl&&I.value==="cover"?(v(),m("div",WL,[l("img",{src:e.branding.logoUrl,alt:"Logo",class:"logo-cover-img"},null,8,qL)])):D("",!0),I.value==="left"?(v(),m("div",{key:1,class:_e(["mockup-logo logo-left",{"region-active":a.value==="logo"}]),onClick:k[0]||(k[0]=gt(M=>A("logo"),["stop"]))},[e.branding.logoUrl?(v(),m("img",{key:0,src:e.branding.logoUrl,alt:"Logo",class:"logo-img"},null,8,KL)):(v(),m("span",YL,"+ Logo"))],2)):D("",!0),l("div",{class:_e(["header-center",{"region-active":a.value==="logo"&&!e.branding.logoUrl&&I.value!=="left"&&I.value!=="right"}]),onClick:k[1]||(k[1]=gt(M=>A("logo"),["stop"]))},[l("div",{class:"mockup-title",style:ot({color:S.value})},[l("span",JL,_(e.eventName||"Event Name"),1)],4),l("div",{class:"mockup-date",style:ot({color:S.value})},_(e.eventDate||"Event Date"),5),l("div",XL,[k[14]||(k[14]=l("span",{class:"btn-emergency"},"Emergency",-1)),l("span",{class:"btn-logout",style:ot({color:S.value})},"Logout",4)])],2),I.value==="right"?(v(),m("div",{key:2,class:_e(["mockup-logo logo-right",{"region-active":a.value==="logo"}]),onClick:k[2]||(k[2]=gt(M=>A("logo"),["stop"]))},[e.branding.logoUrl?(v(),m("img",{key:0,src:e.branding.logoUrl,alt:"Logo",class:"logo-img"},null,8,QL)):(v(),m("span",eS,"+ Logo"))],2)):D("",!0)],6),l("div",tS,[l("div",nS,[k[15]||(k[15]=l("div",{class:"card-header"},"Your checkpoints (2)",-1)),l("div",oS,[l("div",{class:_e(["mockup-checkin-btn",{"region-active":a.value==="accent"}]),style:ot(O.value),onClick:k[4]||(k[4]=gt(M=>A("accent"),["stop"]))}," GPS Check-In ",6)])])])],6)]),a.value?(v(),m("div",{key:0,class:"editor-overlay",onClick:k[12]||(k[12]=gt(M=>a.value=null,["self"]))},[l("div",sS,[l("div",iS,[l("span",null,_(u[a.value]),1),l("button",{type:"button",class:"editor-close",onClick:k[6]||(k[6]=M=>a.value=null)},"")]),l("div",aS,[a.value==="header"?(v(),m(we,{key:0},[k[18]||(k[18]=l("p",{class:"editor-description"},"Choose the colours for the header gradient.",-1)),l("div",rS,[l("div",lS,[k[16]||(k[16]=l("label",null,"Start colour",-1)),l("div",cS,[(v(!0),m(we,null,Pe(V(o),M=>(v(),m("button",{key:"hs-"+M.hex,type:"button",class:_e(["color-swatch-btn",{selected:e.branding.headerGradientStart===M.hex}]),style:ot({backgroundColor:M.hex}),title:M.name,onClick:G=>$("headerGradientStart",M.hex)},[e.branding.headerGradientStart===M.hex?(v(),m("span",dS,"")):D("",!0)],14,uS))),128))])]),l("div",hS,[k[17]||(k[17]=l("label",null,"End colour",-1)),l("div",fS,[(v(!0),m(we,null,Pe(V(o),M=>(v(),m("button",{key:"he-"+M.hex,type:"button",class:_e(["color-swatch-btn",{selected:e.branding.headerGradientEnd===M.hex}]),style:ot({backgroundColor:M.hex}),title:M.name,onClick:G=>$("headerGradientEnd",M.hex)},[e.branding.headerGradientEnd===M.hex?(v(),m("span",vS,"")):D("",!0)],14,pS))),128))])])])],64)):D("",!0),a.value==="logo"?(v(),m(we,{key:1},[l("div",mS,[k[19]||(k[19]=l("label",{class:"editor-label"},"Position",-1)),l("div",gS,[l("button",{type:"button",class:_e(["position-btn",{selected:I.value==="left"}]),onClick:k[7]||(k[7]=M=>$("logoPosition","left"))}," Left ",2),l("button",{type:"button",class:_e(["position-btn",{selected:I.value==="right"}]),onClick:k[8]||(k[8]=M=>$("logoPosition","right"))}," Right ",2),l("button",{type:"button",class:_e(["position-btn",{selected:I.value==="cover"}]),onClick:k[9]||(k[9]=M=>$("logoPosition","cover"))}," Cover ",2)])]),Ne(NL,{"model-value":e.branding.logoUrl,"event-id":e.eventId,"admin-email":e.adminEmail,"onUpdate:modelValue":k[10]||(k[10]=M=>$("logoUrl",M))},null,8,["model-value","event-id","admin-email"])],64)):D("",!0),a.value==="accent"?(v(),m(we,{key:2},[k[20]||(k[20]=l("p",{class:"editor-description"},"Choose the accent colour for buttons.",-1)),l("div",yS,[(v(!0),m(we,null,Pe(V(o),M=>(v(),m("button",{key:"ac-"+M.hex,type:"button",class:_e(["color-swatch-btn",{selected:e.branding.accentColor===M.hex}]),style:ot({backgroundColor:M.hex}),title:M.name,onClick:G=>$("accentColor",M.hex)},[e.branding.accentColor===M.hex?(v(),m("span",kS,"")):D("",!0)],14,_S))),128))])],64)):D("",!0),a.value==="page"?(v(),m(we,{key:3},[k[23]||(k[23]=l("p",{class:"editor-description"},"Choose the colours for the page background gradient.",-1)),l("div",bS,[l("div",wS,[k[21]||(k[21]=l("label",null,"Start colour",-1)),l("div",CS,[(v(!0),m(we,null,Pe(V(o),M=>(v(),m("button",{key:"ps-"+M.hex,type:"button",class:_e(["color-swatch-btn",{selected:e.branding.pageGradientStart===M.hex}]),style:ot({backgroundColor:M.hex}),title:M.name,onClick:G=>$("pageGradientStart",M.hex)},[e.branding.pageGradientStart===M.hex?(v(),m("span",SS,"")):D("",!0)],14,LS))),128))])]),l("div",xS,[k[22]||(k[22]=l("label",null,"End colour",-1)),l("div",$S,[(v(!0),m(we,null,Pe(V(o),M=>(v(),m("button",{key:"pe-"+M.hex,type:"button",class:_e(["color-swatch-btn",{selected:e.branding.pageGradientEnd===M.hex}]),style:ot({backgroundColor:M.hex}),title:M.name,onClick:G=>$("pageGradientEnd",M.hex)},[e.branding.pageGradientEnd===M.hex?(v(),m("span",TS,"")):D("",!0)],14,IS))),128))])])])],64)):D("",!0)]),l("div",MS,[l("button",{type:"button",class:"btn-done",onClick:k[11]||(k[11]=M=>a.value=null)},"Done")])])])):D("",!0),k[24]||(k[24]=l("p",{class:"instructions"}," Click on different parts of the preview to customise them. The emergency button stays red for safety. ",-1))]))}},ES=Ye(AS,[["__scopeId","data-v-0a85c419"]]),PS={class:"settings-tab"},DS={class:"accordion"},OS={class:"accordion-section"},RS={class:"accordion-title"},BS={class:"accordion-icon"},NS={key:0,class:"accordion-content"},FS={class:"accordion-section"},US={class:"accordion-icon"},zS={key:0,class:"accordion-content"},HS={class:"terminology-grid"},VS={class:"term-group"},GS=["value"],ZS={class:"term-group"},jS=["value"],WS={class:"term-group"},qS=["value"],KS={class:"term-group"},YS=["value"],JS={class:"term-group"},XS=["value"],QS={class:"form-actions"},ex=["disabled"],tx={class:"accordion-section"},nx={class:"accordion-title"},ox={class:"accordion-icon"},sx={key:0,class:"accordion-content"},ix={class:"section-description"},ax={class:"form-actions"},rx=["disabled"],lx={class:"accordion-section"},cx={class:"accordion-title"},ux={class:"accordion-icon"},dx={key:0,class:"accordion-content"},hx={class:"section-description"},fx={class:"form-actions"},px=["disabled"],Ih="admin_settings_accordion",vx={__name:"SettingsTab",props:{eventData:{type:Object,required:!0},admins:{type:Array,default:()=>[]},formDirty:{type:Boolean,default:!1},eventId:{type:String,default:""}},emits:["submit","add-admin","remove-admin","update:formDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Lt(),s=ar(),a=Y(()=>s.adminEmail||""),c=e,u=t,d=P({...c.eventData}),p=()=>c.eventId?`${Ih}_${c.eventId}`:Ih,f=P(null);on(()=>{const $=localStorage.getItem(p());$&&(f.value=$)});const y=Y(()=>{const $=d.value.peopleTerm||"Marshals";return _s.checkpoint.map(C=>({value:C,label:jc(C,$)}))}),b=$=>{const C=f.value===$?null:$;f.value=C,C?localStorage.setItem(p(),C):localStorage.removeItem(p())};We(()=>c.eventData,$=>{d.value={...$}},{deep:!0});const I=()=>{u("update:formDirty",!0)},T=($,C)=>{d.value[$]=C,I()},S=Y(()=>({headerGradientStart:d.value.brandingHeaderGradientStart||"",headerGradientEnd:d.value.brandingHeaderGradientEnd||"",logoUrl:d.value.brandingLogoUrl||"",logoPosition:d.value.brandingLogoPosition||"",accentColor:d.value.brandingAccentColor||"",pageGradientStart:d.value.brandingPageGradientStart||"",pageGradientEnd:d.value.brandingPageGradientEnd||""})),O=$=>{d.value.brandingHeaderGradientStart=$.headerGradientStart,d.value.brandingHeaderGradientEnd=$.headerGradientEnd,d.value.brandingLogoUrl=$.logoUrl,d.value.brandingLogoPosition=$.logoPosition,d.value.brandingAccentColor=$.accentColor,d.value.brandingPageGradientStart=$.pageGradientStart,d.value.brandingPageGradientEnd=$.pageGradientEnd,I()},E=()=>{FL(),d.value.brandingHeaderGradientStart="",d.value.brandingHeaderGradientEnd="",d.value.brandingLogoUrl="",d.value.brandingLogoPosition="",d.value.brandingAccentColor="",d.value.brandingPageGradientStart="",d.value.brandingPageGradientEnd="",I()},A=()=>{u("submit",{...d.value})};return($,C)=>(v(),m("div",PS,[l("div",DS,[l("div",OS,[l("button",{class:_e(["accordion-header",{active:f.value==="admins"}]),onClick:C[0]||(C[0]=w=>b("admins"))},[l("span",RS,"Administrators ("+_(e.admins.length)+")",1),l("span",BS,_(f.value==="admins"?"-":"+"),1)],2),f.value==="admins"?(v(),m("div",NS,[Ne(u2,{admins:e.admins,onAddAdmin:C[1]||(C[1]=w=>$.$emit("add-admin")),onRemoveAdmin:C[2]||(C[2]=w=>$.$emit("remove-admin",w))},null,8,["admins"])])):D("",!0)]),l("div",FS,[l("button",{class:_e(["accordion-header",{active:f.value==="terminology"}]),onClick:C[3]||(C[3]=w=>b("terminology"))},[C[19]||(C[19]=l("span",{class:"accordion-title"},"Terminology",-1)),l("span",US,_(f.value==="terminology"?"-":"+"),1)],2),f.value==="terminology"?(v(),m("div",zS,[C[20]||(C[20]=l("p",{class:"section-description"}," Customise how things are named throughout the application. ",-1)),l("div",HS,[l("div",VS,[l("label",null,_(V(o).people)+" are called",1),Ge(l("select",{"onUpdate:modelValue":C[4]||(C[4]=w=>d.value.peopleTerm=w),class:"form-input",onChange:I},[(v(!0),m(we,null,Pe(V(_s).people,w=>(v(),m("option",{key:w,value:w},_(w),9,GS))),128))],544),[[vn,d.value.peopleTerm]])]),l("div",ZS,[l("label",null,_(V(o).checkpoints)+" are called",1),Ge(l("select",{"onUpdate:modelValue":C[5]||(C[5]=w=>d.value.checkpointTerm=w),class:"form-input",onChange:I},[(v(!0),m(we,null,Pe(y.value,w=>(v(),m("option",{key:w.value,value:w.value},_(w.label),9,jS))),128))],544),[[vn,d.value.checkpointTerm]])]),l("div",WS,[l("label",null,_(V(o).areas)+" are called",1),Ge(l("select",{"onUpdate:modelValue":C[6]||(C[6]=w=>d.value.areaTerm=w),class:"form-input",onChange:I},[(v(!0),m(we,null,Pe(V(_s).area,w=>(v(),m("option",{key:w,value:w},_(w),9,qS))),128))],544),[[vn,d.value.areaTerm]])]),l("div",KS,[l("label",null,_(V(o).checklists)+" are called",1),Ge(l("select",{"onUpdate:modelValue":C[7]||(C[7]=w=>d.value.checklistTerm=w),class:"form-input",onChange:I},[(v(!0),m(we,null,Pe(V(_s).checklist,w=>(v(),m("option",{key:w,value:w},_(w),9,YS))),128))],544),[[vn,d.value.checklistTerm]])]),l("div",JS,[l("label",null,_(V(o).course)+" is called",1),Ge(l("select",{"onUpdate:modelValue":C[8]||(C[8]=w=>d.value.courseTerm=w),class:"form-input",onChange:I},[(v(!0),m(we,null,Pe(V(_s).course,w=>(v(),m("option",{key:w,value:w},_(w),9,XS))),128))],544),[[vn,d.value.courseTerm]])])]),l("div",QS,[l("button",{onClick:A,class:"btn btn-primary",disabled:!e.formDirty}," Save Changes ",8,ex)])])):D("",!0)]),l("div",tx,[l("button",{class:_e(["accordion-header",{active:f.value==="appearance"}]),onClick:C[9]||(C[9]=w=>b("appearance"))},[l("span",nx,_(V(o).checkpoint)+" appearance",1),l("span",ox,_(f.value==="appearance"?"-":"+"),1)],2),f.value==="appearance"?(v(),m("div",sx,[l("p",ix," Set the default marker style for all "+_(V(i).checkpoints)+" in this event. Individual "+_(V(i).areas)+" and "+_(V(i).checkpoints)+" can override this setting. ",1),Ne(Su,{"style-type":d.value.defaultCheckpointStyleType||"default","style-color":d.value.defaultCheckpointStyleColor||"","style-background-shape":d.value.defaultCheckpointStyleBackgroundShape||"","style-background-color":d.value.defaultCheckpointStyleBackgroundColor||"","style-border-color":d.value.defaultCheckpointStyleBorderColor||"","style-icon-color":d.value.defaultCheckpointStyleIconColor||"","style-size":d.value.defaultCheckpointStyleSize||"","style-map-rotation":d.value.defaultCheckpointStyleMapRotation??"","icon-label":"Default marker style",level:"event","show-preview":!0,"onUpdate:styleType":C[10]||(C[10]=w=>T("defaultCheckpointStyleType",w)),"onUpdate:styleColor":C[11]||(C[11]=w=>T("defaultCheckpointStyleColor",w)),"onUpdate:styleBackgroundShape":C[12]||(C[12]=w=>T("defaultCheckpointStyleBackgroundShape",w)),"onUpdate:styleBackgroundColor":C[13]||(C[13]=w=>T("defaultCheckpointStyleBackgroundColor",w)),"onUpdate:styleBorderColor":C[14]||(C[14]=w=>T("defaultCheckpointStyleBorderColor",w)),"onUpdate:styleIconColor":C[15]||(C[15]=w=>T("defaultCheckpointStyleIconColor",w)),"onUpdate:styleSize":C[16]||(C[16]=w=>T("defaultCheckpointStyleSize",w)),"onUpdate:styleMapRotation":C[17]||(C[17]=w=>T("defaultCheckpointStyleMapRotation",w))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation"]),l("div",ax,[l("button",{onClick:A,class:"btn btn-primary",disabled:!e.formDirty}," Save Changes ",8,rx)])])):D("",!0)]),l("div",lx,[l("button",{class:_e(["accordion-header",{active:f.value==="branding"}]),onClick:C[18]||(C[18]=w=>b("branding"))},[l("span",cx,_(V(o).person)+" branding",1),l("span",ux,_(f.value==="branding"?"-":"+"),1)],2),f.value==="branding"?(v(),m("div",dx,[l("p",hx," Customise the appearance of the "+_(V(i).person)+" view to match your organisation's branding. ",1),Ne(ES,{branding:S.value,"event-name":d.value.name,"event-date":V(Wp)(d.value.eventDate),"event-id":e.eventId,"admin-email":a.value,"onUpdate:branding":O},null,8,["branding","event-name","event-date","event-id","admin-email"]),l("div",fx,[l("button",{onClick:A,class:"btn btn-primary",disabled:!e.formDirty}," Save Changes ",8,px),l("button",{onClick:E,class:"btn btn-secondary"}," Reset to Default ")])])):D("",!0)])])]))}},mx=Ye(vx,[["__scopeId","data-v-3ed53f3e"]]),gx={class:"incident-header"},yx={class:"incident-title-row"},_x={class:"incident-title"},kx={class:"incident-badges"},bx={key:0,class:"incident-description"},wx={class:"incident-context"},Cx={key:0,class:"context-item"},Lx={key:1,class:"context-item"},Sx={key:2,class:"context-item"},xx={class:"incident-footer"},$x={class:"reporter-info"},Ix={class:"time-info"},Tx={__name:"IncidentCard",props:{incident:{type:Object,required:!0}},emits:["select"],setup(e){const t=e,o=Y(()=>{if(t.incident.title)return t.incident.title;const u=t.incident.description||"";return u.length<=60?u:u.substring(0,57).trim()+"..."}),i=u=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[u]||u,s=u=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[u]||u,a=(u,d=120)=>!u||u.length<=d?u:u.substring(0,d).trim()+"...",c=u=>{if(!u)return"";const d=new Date(u),f=new Date-d,y=Math.floor(f/6e4),b=Math.floor(f/36e5),I=Math.floor(f/864e5);return y<1?"just now":y<60?`${y}m ago`:b<24?`${b}h ago`:I<7?`${I}d ago`:d.toLocaleDateString()};return(u,d)=>(v(),m("div",{class:_e(["incident-card",[`severity-${e.incident.severity}`,`status-${e.incident.status}`]]),onClick:d[0]||(d[0]=p=>u.$emit("select",e.incident))},[l("div",gx,[l("div",yx,[l("span",{class:_e(["severity-indicator",e.incident.severity])},null,2),l("strong",_x,_(o.value),1)]),l("div",kx,[l("span",{class:_e(["severity-badge",e.incident.severity])},_(i(e.incident.severity)),3),l("span",{class:_e(["status-badge",e.incident.status])},_(s(e.incident.status)),3)])]),e.incident.title&&e.incident.description?(v(),m("div",bx,_(a(e.incident.description)),1)):D("",!0),l("div",wx,[e.incident.context?.checkpoint?(v(),m("div",Cx,[d[1]||(d[1]=l("span",{class:"context-icon"},"",-1)),l("span",null,_(e.incident.context.checkpoint.name),1)])):e.incident.latitude&&e.incident.longitude?(v(),m("div",Lx,[...d[2]||(d[2]=[l("span",{class:"context-icon"},"",-1),l("span",null,"GPS Location",-1)])])):D("",!0),e.incident.area?(v(),m("div",Sx,[d[3]||(d[3]=l("span",{class:"context-icon"},"",-1)),l("span",null,_(e.incident.area.areaName),1)])):D("",!0)]),l("div",xx,[l("span",$x," Reported by "+_(e.incident.reportedBy?.name||"Unknown"),1),l("span",Ix,_(c(e.incident.incidentTime||e.incident.createdAt)),1)])],2))}},rr=Ye(Tx,[["__scopeId","data-v-45be4359"]]),Mx={class:"incidents-tab"},Ax={class:"incidents-tab-header"},Ex={class:"header-left"},Px={key:0,class:"incidents-summary"},Dx={key:0,class:"summary-item open"},Ox={key:1,class:"summary-item in-progress"},Rx={key:2,class:"summary-item resolved"},Bx={class:"filters-section"},Nx={class:"filter-group"},Fx={class:"status-filters"},Ux=["checked","onChange"],zx={class:"filter-group"},Hx={class:"severity-filters"},Vx=["checked","onChange"],Gx={class:"incidents-list"},Zx={key:0,class:"loading-state"},jx={key:1,class:"empty-state"},Wx={__name:"IncidentsTab",props:{incidents:{type:Array,required:!0},areas:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["select-incident","report-incident"],setup(e,{emit:t}){const o=e,i=[{value:"open",label:"Open"},{value:"acknowledged",label:"Acknowledged"},{value:"in_progress",label:"In Progress"},{value:"resolved",label:"Resolved"},{value:"closed",label:"Closed"}],s=[{value:"critical",label:"Critical"},{value:"high",label:"High"},{value:"medium",label:"Medium"},{value:"low",label:"Low"}],a=P(["open","acknowledged","in_progress","resolved","closed"]),c=P(["critical","high","medium","low"]),u=Y(()=>a.value.length<5||c.value.length<4),d=Y(()=>o.incidents.filter(O=>O.status==="open").length),p=Y(()=>o.incidents.filter(O=>O.status==="in_progress"||O.status==="acknowledged").length),f=Y(()=>o.incidents.filter(O=>O.status==="resolved"||O.status==="closed").length),y=O=>{const E=a.value.indexOf(O);E>=0?a.value.splice(E,1):a.value.push(O)},b=O=>{const E=c.value.indexOf(O);E>=0?c.value.splice(E,1):c.value.push(O)},I=()=>{a.value=["open","acknowledged","in_progress","resolved","closed"],c.value=["critical","high","medium","low"]},T=Y(()=>o.incidents.filter(O=>{const E=a.value.includes(O.status),A=c.value.includes(O.severity);return E&&A})),S=Y(()=>[...T.value].sort((O,E)=>new Date(E.incidentTime||E.createdAt)-new Date(O.incidentTime||O.createdAt)));return(O,E)=>(v(),m("div",Mx,[l("div",Ax,[l("div",Ex,[E[1]||(E[1]=l("h2",null,"Incidents",-1)),e.incidents.length>0?(v(),m("div",Px,[d.value>0?(v(),m("span",Dx,_(d.value)+" open",1)):D("",!0),p.value>0?(v(),m("span",Ox,_(p.value)+" in progress",1)):D("",!0),f.value>0?(v(),m("span",Rx,_(f.value)+" resolved",1)):D("",!0)])):D("",!0)]),l("button",{onClick:E[0]||(E[0]=A=>O.$emit("report-incident")),class:"btn btn-primary"}," Report incident ")]),l("div",Bx,[l("div",Nx,[E[2]||(E[2]=l("h4",null,"Filter by status:",-1)),l("div",Fx,[(v(),m(we,null,Pe(i,A=>l("label",{key:A.value,class:"filter-checkbox"},[l("input",{type:"checkbox",checked:a.value.includes(A.value),onChange:$=>y(A.value)},null,40,Ux),l("span",{class:_e(["status-dot",A.value])},null,2),Ve(" "+_(A.label),1)])),64))])]),l("div",zx,[E[3]||(E[3]=l("h4",null,"Filter by severity:",-1)),l("div",Hx,[(v(),m(we,null,Pe(s,A=>l("label",{key:A.value,class:"filter-checkbox"},[l("input",{type:"checkbox",checked:c.value.includes(A.value),onChange:$=>b(A.value)},null,40,Vx),l("span",{class:_e(["severity-dot",A.value])},null,2),Ve(" "+_(A.label),1)])),64))])]),u.value?(v(),m("button",{key:0,onClick:I,class:"btn btn-secondary btn-small"}," Clear filters ")):D("",!0)]),l("div",Gx,[e.loading?(v(),m("div",Zx," Loading incidents... ")):T.value.length===0?(v(),m("div",jx,[l("p",null,_(u.value?"No incidents match the selected filters.":"No incidents reported yet."),1)])):D("",!0),(v(!0),m(we,null,Pe(S.value,A=>(v(),et(rr,{key:A.incidentId,incident:A,onSelect:$=>O.$emit("select-incident",A)},null,8,["incident","onSelect"]))),128))])]))}},qx=Ye(Wx,[["__scopeId","data-v-2c830662"]]),Kx={class:"button-group"},Yx={key:0,class:"add-dropdown"},Jx={key:0,class:"filter-group"},Xx={class:"filter-checkbox"},Qx=["checked"],e$={class:"locations-list"},t$=["onClick"],n$={class:"location-info"},o$={class:"location-header"},s$=["innerHTML"],i$={class:"location-name-desc"},a$={key:0,class:"location-description"},r$={class:"location-status"},l$={class:"location-assignments"},c$={__name:"CheckpointsList",props:{locations:{type:Array,required:!0},areas:{type:Array,default:()=>[]}},emits:["add-checkpoint-manually","import-checkpoints","select-location"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Lt(),s=e,a=t,c=P(!0),u=P([]),d=P(null),p=P(null),f=P(!1),y=()=>{f.value=!f.value},b=()=>{f.value=!1,a("add-checkpoint-manually")},I=()=>{f.value=!1,a("import-checkpoints")},T=C=>{p.value&&!p.value.contains(C.target)&&(f.value=!1)};on(()=>{document.addEventListener("click",T)}),Lo(()=>{document.removeEventListener("click",T)});const S=()=>{c.value=!c.value,!c.value&&u.value.length===0&&(u.value=s.areas.map(C=>C.id))},O=Y(()=>{let C=s.locations;return!c.value&&u.value.length>0&&(C=C.filter(w=>(w.areaIds||w.AreaIds||[]).some(M=>u.value.includes(M)))),[...C].sort((w,k)=>Fn(w.name,k.name))}),E=C=>{const w=s.areas.find(k=>k.id===C);return w?w.name:null},A=C=>{const w=s.areas.find(k=>k.id===C);return w?w.color:"#999"},$=C=>{const w=C.resolvedStyleType||C.ResolvedStyleType,k=C.resolvedStyleBackgroundColor||C.ResolvedStyleBackgroundColor||C.resolvedStyleColor||C.ResolvedStyleColor,M=C.resolvedStyleBorderColor||C.ResolvedStyleBorderColor,G=C.resolvedStyleIconColor||C.ResolvedStyleIconColor,ne=C.resolvedStyleBackgroundShape||C.ResolvedStyleBackgroundShape;return w&&w!=="default"||k||M||G||ne&&ne!=="circle"?Xt({type:w||"circle",backgroundShape:ne||"circle",backgroundColor:k||"#667eea",borderColor:M||"#ffffff",iconColor:G||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`};return(C,w)=>(v(),m("div",null,[l("h3",null,_(V(o).checkpoints)+" ("+_(e.locations.length)+")",1),l("div",Kx,[l("div",{class:"add-menu-wrapper",ref_key:"menuWrapperRef",ref:p},[l("button",{ref_key:"addButtonRef",ref:d,onClick:y,class:"btn btn-small btn-primary"}," Add... ",512),f.value?(v(),m("div",Yx,[l("button",{onClick:b,class:"dropdown-item"}," Add "+_(V(i).checkpoint)+" manually ",1),l("button",{onClick:I,class:"dropdown-item"}," Import from CSV... ")])):D("",!0)],512)]),e.areas.length>0?(v(),m("div",Jx,[l("h4",null,"Filter by "+_(V(o).area.toLowerCase())+":",1),l("label",Xx,[l("input",{type:"checkbox",checked:c.value,onChange:S},null,40,Qx),Ve(" All "+_(V(o).areas.toLowerCase())+" ("+_(e.locations.length)+") ",1)]),c.value?D("",!0):(v(),et(Yp,{key:0,areas:e.areas,"selected-area-ids":u.value,"onUpdate:selectedAreaIds":w[0]||(w[0]=k=>u.value=k)},null,8,["areas","selected-area-ids"]))])):D("",!0),l("div",e$,[(v(!0),m(we,null,Pe(O.value,k=>(v(),m("div",{key:k.id,class:_e(["location-item",{"location-full":k.checkedInCount>=k.requiredMarshals,"location-missing":k.checkedInCount===0}]),onClick:M=>C.$emit("select-location",k)},[l("div",n$,[l("div",o$,[l("span",{class:"checkpoint-icon",innerHTML:$(k)},null,8,s$),l("div",i$,[l("strong",null,_(k.name),1),k.description?(v(),m("span",a$," - "+_(k.description),1)):D("",!0)]),(v(!0),m(we,null,Pe(k.areaIds||k.AreaIds||[],M=>(v(),m("span",{key:M,class:"area-badge",style:ot({backgroundColor:A(M)})},_(E(M)),5))),128)),l("span",r$,_(k.checkedInCount)+"/"+_(k.requiredMarshals),1)])]),l("div",l$,[(v(!0),m(we,null,Pe(k.assignments,M=>(v(),m("span",{key:M.id,class:_e(["assignment-badge",{"checked-in":M.isCheckedIn}])},_(M.marshalName),3))),128))])],10,t$))),128))])]))}},u$=Ye(c$,[["__scopeId","data-v-6e5f3a03"]]),d$={class:"button-group"},h$={class:"areas-list"},f$=["onClick"],p$={class:"area-info"},v$={class:"area-header"},m$={key:0,class:"default-badge"},g$={key:0,class:"area-description"},y$={class:"area-stats"},_$={class:"stat-badge"},k$={class:"stat-badge"},b$={key:0,class:"empty-state"},w$={__name:"AreasList",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["add-area","select-area"],setup(e){const{terms:t}=Lt(),o=e,i=Y(()=>[...o.areas].sort((p,f)=>p.displayOrder!==f.displayOrder?p.displayOrder-f.displayOrder:Fn(p.name,f.name))),s=p=>p.checkpointCount!==void 0?p.checkpointCount:o.checkpoints.filter(f=>f.areaId===p.id).length,a=p=>o.contacts.filter(f=>f.scopeConfigurations?f.scopeConfigurations.some(y=>y.scope==="EveryoneInAreas"&&y.itemType==="Area"?y.ids?.includes("ALL_AREAS")?!0:y.ids?.includes(p.id):!1):!1).length,c=p=>p.peopleTerm||o.eventPeopleTerm||"Marshals",u=(p,f)=>{const y=p.checkpointTerm||o.eventCheckpointTerm||"Checkpoints",b=c(p);return f===1?wi("checkpoint",y,b):jp("checkpoint",y,b)},d=p=>{const f=s(p),y=u(p,f).toLowerCase();return`${f} ${y}`};return(p,f)=>(v(),m("div",null,[l("h3",null,_(V(t).areas)+" ("+_(e.areas.length)+")",1),l("div",d$,[l("button",{onClick:f[0]||(f[0]=y=>p.$emit("add-area")),class:"btn btn-small btn-primary"}," Add "+_(V(t).area.toLowerCase()),1)]),l("div",h$,[(v(!0),m(we,null,Pe(i.value,y=>(v(),m("div",{key:y.id,class:"area-item",style:ot({borderLeftColor:y.color||"#667eea"}),onClick:b=>p.$emit("select-area",y)},[l("div",p$,[l("div",v$,[l("strong",null,_(y.name),1),y.isDefault?(v(),m("span",m$,"Default")):D("",!0)]),y.description?(v(),m("p",g$,_(y.description),1)):D("",!0),l("div",y$,[l("span",_$,_(d(y)),1),l("span",k$,_(a(y))+" contact"+_(a(y)===1?"":"s"),1)])])],12,f$))),128)),e.areas.length===0?(v(),m("div",b$,[l("p",null,"No "+_(V(t).areas.toLowerCase())+' yet. Click "Add '+_(V(t).area.toLowerCase())+'" to create one.',1)])):D("",!0)])]))}},C$=Ye(w$,[["__scopeId","data-v-65c30be2"]]),L$={course:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>',checkpoint:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',area:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',marshal:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',checklist:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>',notes:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/></svg>',incidents:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>',details:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16h6"/></svg>',location:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',contacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>',people:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polygon points="22 8 19.5 10 20.5 13 18 11.5 15.5 13 16.5 10 14 8 17 8 18 5 19 8 22 8" fill="currentColor"/></svg>',eventContacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 8V6a2 2 0 0 0-2-2h-2"/><path d="M22 12v2a2 2 0 0 1-2 2h-2"/></svg>',event:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>',appearance:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12.5" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>',logout:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>'},un=e=>L$[e]||"",S$={class:"responsive-tabs"},x$=["onClick"],$$=["innerHTML"],I$=["innerHTML"],T$={class:"hamburger-label"},M$=["onClick"],A$=["innerHTML"],E$={__name:"ResponsiveTabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,i=t,s=P(null),a=P(null),c=P(null),u=P(!1),d=P({}),p=P(!1),f=Y(()=>o.tabs.find(E=>E.value===o.modelValue)),y=Y(()=>f.value?f.value.label:"Menu"),b=()=>{if(u.value=!u.value,u.value&&a.value){const E=a.value.getBoundingClientRect();d.value={top:`${E.bottom+4}px`}}},I=E=>{i("update:modelValue",E),u.value=!1},T=E=>{if(!s.value)return;const A=s.value.contains(E.target);u.value&&!A&&(u.value=!1)},S=()=>{if(!c.value)return;const E=c.value,A=p.value;A&&(E.style.visibility="visible",E.style.position="static");const $=E.scrollWidth>E.clientWidth;A&&(E.style.visibility="",E.style.position=""),p.value=$};let O=null;return on(()=>{document.addEventListener("click",T),Ls(()=>{S()}),Ls(()=>{const E=c.value?.parentElement;E&&(O=new ResizeObserver(()=>{S()}),O.observe(E))})}),Lo(()=>{document.removeEventListener("click",T),O&&O.disconnect()}),We(()=>o.tabs,()=>{Ls(()=>{S()})},{deep:!0}),(E,A)=>(v(),m("div",S$,[l("div",{ref_key:"visibleTabsRef",ref:c,class:_e(["visible-tabs",{"is-hidden":p.value}])},[(v(!0),m(we,null,Pe(e.tabs,$=>(v(),m("button",{key:$.value,class:_e(["tab-button",{active:e.modelValue===$.value}]),onClick:C=>E.$emit("update:modelValue",$.value),type:"button"},[$.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:V(un)($.icon)},null,8,$$)):D("",!0),Ve(" "+_($.label),1)],10,x$))),128))],2),l("div",{class:_e(["hamburger-only",{"is-visible":p.value}])},[l("div",{class:"hamburger-menu",ref_key:"hamburgerMenu",ref:s},[l("button",{ref_key:"hamburgerButton",ref:a,class:_e(["hamburger-button",{active:u.value}]),onClick:gt(b,["stop"]),type:"button"},[A[1]||(A[1]=l("span",{class:"hamburger-icon"},"",-1)),f.value?.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:V(un)(f.value.icon)},null,8,I$)):D("",!0),l("span",T$,_(y.value),1)],2),u.value?(v(),m("div",{key:0,class:"hamburger-dropdown",style:ot(d.value),onClick:A[0]||(A[0]=gt(()=>{},["stop"]))},[(v(!0),m(we,null,Pe(e.tabs,$=>(v(),m("button",{key:$.value,class:_e(["dropdown-item",{active:e.modelValue===$.value}]),onClick:gt(C=>I($.value),["stop"]),type:"button"},[$.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:V(un)($.icon)},null,8,A$)):D("",!0),Ve(" "+_($.label),1)],10,M$))),128))],4)):D("",!0)],512)],2)]))}},P$=Ye(E$,[["__scopeId","data-v-bf1f766d"]]),D$={class:"share-link-container"},O$=["value"],R$={__name:"ShareLinkModal",props:{show:{type:Boolean,default:!1},link:{type:String,required:!0},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=t,i=P(!1),s=P(null),a=()=>{s.value&&(s.value.select(),document.execCommand("copy"),i.value=!0,setTimeout(()=>{i.value=!1},2e3))},c=()=>{o("close")};return(u,d)=>(v(),et(Dt,{show:e.show,title:"Marshal check-in link",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:c},{actions:Qe(()=>[l("button",{onClick:c,class:"btn btn-secondary"},"Close")]),default:Qe(()=>[d[0]||(d[0]=l("p",{class:"instruction"},"Share this link with marshals so they can check in:",-1)),l("div",D$,[l("input",{value:e.link,readonly:"",class:"form-input",ref_key:"linkInput",ref:s},null,8,O$),l("button",{onClick:a,class:"btn btn-primary"},_(i.value?"Copied!":"Copy"),1)])]),_:1},8,["show","is-dirty"]))}},B$=Ye(R$,[["__scopeId","data-v-e3c38c66"]]),N$={class:"success-content"},F$={class:"success-message"},U$={class:"link-section"},z$={class:"help-text"},H$={key:0,class:"loading-text"},V$={key:1,class:"magic-link-container"},G$=["value"],Z$={class:"magic-link-actions"},j$=["disabled"],W$={key:0,class:"success-text"},q$={key:1,class:"error-text"},K$={key:2,class:"error-text"},Y$={__name:"MarshalCreatedModal",props:{show:{type:Boolean,default:!1},eventId:{type:String,required:!0},marshalId:{type:String,default:null},marshalName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const{terms:o}=Lt(),i=e,s=t,a=P(""),c=P(!1),u=P(!1),d=P(""),p=P(!1),f=P(!1),y=P(!1),b=P(""),I=async()=>{if(!(!i.eventId||!i.marshalId)){u.value=!0,d.value="";try{const E=await jo.getMagicLink(i.eventId,i.marshalId);a.value=E.data.magicLink,c.value=E.data.hasEmail}catch(E){console.error("Failed to fetch magic link:",E),d.value="Failed to load login link"}finally{u.value=!1}}},T=async()=>{try{await navigator.clipboard.writeText(a.value),p.value=!0,setTimeout(()=>{p.value=!1},2e3)}catch(E){console.error("Failed to copy:",E)}},S=async()=>{if(!(!i.eventId||!i.marshalId)){f.value=!0,y.value=!1,b.value="";try{await jo.sendMagicLink(i.eventId,i.marshalId),y.value=!0,setTimeout(()=>{y.value=!1},3e3)}catch(E){console.error("Failed to send email:",E),b.value=E.response?.data?.message||"Failed to send email"}finally{f.value=!1}}},O=()=>{s("close")};return We(()=>i.show,E=>{E&&i.marshalId?I():(a.value="",c.value=!1,d.value="",p.value=!1,y.value=!1,b.value="")},{immediate:!0}),(E,A)=>(v(),et(Dt,{show:e.show,title:`${V(o).person} created`,size:"medium","confirm-on-close":!1,"is-dirty":!1,onClose:O},{actions:Qe(()=>[l("button",{onClick:O,class:"btn btn-primary"},"Done")]),default:Qe(()=>[l("div",N$,[A[2]||(A[2]=l("div",{class:"success-icon"},"",-1)),l("p",F$,[l("strong",null,_(e.marshalName),1),A[1]||(A[1]=Ve(" has been added successfully. ",-1))])]),l("div",U$,[A[3]||(A[3]=l("label",null,"Login link",-1)),l("p",z$," Share this unique link with "+_(e.marshalName)+" so they can access their dashboard and check in. ",1),u.value?(v(),m("div",H$,"Loading link...")):a.value?(v(),m("div",V$,[l("input",{type:"text",value:a.value,readonly:"",class:"form-input magic-link-input",onFocus:A[0]||(A[0]=$=>$.target.select())},null,40,G$),l("div",Z$,[l("button",{type:"button",class:"btn btn-secondary",onClick:T},_(p.value?"Copied!":"Copy link"),1),c.value?(v(),m("button",{key:0,type:"button",class:"btn btn-primary",disabled:f.value,onClick:S},_(f.value?"Sending...":"Send via email"),9,j$)):D("",!0)]),y.value?(v(),m("p",W$,"Email sent successfully!")):D("",!0),b.value?(v(),m("p",q$,_(b.value),1)):D("",!0)])):d.value?(v(),m("div",K$,_(d.value),1)):D("",!0)])]),_:1},8,["show","title"]))}},J$=Ye(Y$,[["__scopeId","data-v-0de41f28"]]),X$={class:"form-group"},Q$={__name:"AddAdminModal",props:{show:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=P("");We(()=>o.show,d=>{d||(s.value="")});const a=()=>{i("update:isDirty",!0)},c=()=>{i("submit",s.value)},u=()=>{i("close")};return(d,p)=>(v(),et(Dt,{show:e.show,title:"Add event administrator",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:Qe(()=>[l("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:c,class:"btn btn-primary"}," Add administrator ")]),default:Qe(()=>[p[2]||(p[2]=l("p",{class:"instruction"},"Enter the email address of the administrator to add",-1)),l("form",{onSubmit:gt(c,["prevent"])},[l("div",X$,[p[1]||(p[1]=l("label",null,"Email address",-1)),Ge(l("input",{"onUpdate:modelValue":p[0]||(p[0]=f=>s.value=f),type:"email",required:"",class:"form-input",placeholder:"admin@example.com",onInput:a},null,544),[[at,s.value]])])],32)]),_:1},8,["show","is-dirty"]))}},eI=Ye(Q$,[["__scopeId","data-v-43ad537f"]]),tI={class:"form-group"},nI={key:0,class:"error"},oI=["disabled"],sI={__name:"UploadRouteModal",props:{show:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},error:{type:String,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=P(null);We(()=>o.show,d=>{d||(s.value=null)});const a=d=>{s.value=d.target.files[0],i("update:isDirty",!0)},c=()=>{s.value&&i("submit",s.value)},u=()=>{i("close")};return(d,p)=>(v(),et(Dt,{show:e.show,title:"Upload GPX route",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:Qe(()=>[l("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:c,class:"btn btn-primary",disabled:e.uploading},_(e.uploading?"Uploading...":"Upload route"),9,oI)]),default:Qe(()=>[p[1]||(p[1]=l("p",{class:"instruction"},"Upload a GPX file to display the event route on the map",-1)),l("form",{onSubmit:gt(c,["prevent"])},[l("div",tI,[p[0]||(p[0]=l("label",null,"GPX file",-1)),l("input",{type:"file",accept:".gpx",onChange:a,required:"",class:"form-input"},null,32)]),e.error?(v(),m("div",nI,_(e.error),1)):D("",!0)],32)]),_:1},8,["show","is-dirty"]))}},iI=Ye(sI,[["__scopeId","data-v-1c1d3033"]]),aI={class:"instruction"},rI={class:"form-group"},lI={class:"form-group"},cI={class:"checkbox-label"},uI={key:0,class:"error"},dI={key:1,class:"import-result"},hI={key:0,class:"import-errors"},fI=["disabled"],pI={__name:"ImportLocationsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Lt(),s=e,a=t,c=P(null),u=P(!1);We(()=>s.show,b=>{b||(c.value=null,u.value=!1)});const d=b=>{c.value=b.target.files[0],a("update:isDirty",!0)},p=()=>{a("update:isDirty",!0)},f=()=>{c.value&&a("submit",{file:c.value,deleteExisting:u.value})},y=()=>{a("close")};return(b,I)=>(v(),et(Dt,{show:e.show,title:`Import ${V(i).checkpoints} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:y},{actions:Qe(()=>[l("button",{type:"button",onClick:y,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:f,class:"btn btn-primary",disabled:e.importing},_(e.importing?"Importing...":`Import ${V(i).checkpoints}`),9,fI)]),default:Qe(()=>[l("p",aI,"Upload a CSV file with columns: Label, Lat/Latitude, Long/Longitude, What3Words (optional), "+_(V(o).people)+" (optional)",1),I[3]||(I[3]=l("div",{class:"csv-example"},[l("strong",null,"Example CSV format:"),l("pre",null,`Label,Latitude,Longitude,What3Words,Marshals
Checkpoint 1,51.505,-0.09,filled.count.soap,"John Doe, Jane Smith"
Checkpoint 2,51.510,-0.10,index.home.raft,Bob Wilson`)],-1)),l("form",{onSubmit:gt(f,["prevent"])},[l("div",rI,[I[1]||(I[1]=l("label",null,"CSV file",-1)),l("input",{type:"file",accept:".csv",onChange:d,required:"",class:"form-input"},null,32)]),l("div",lI,[l("label",cI,[Ge(l("input",{type:"checkbox","onUpdate:modelValue":I[0]||(I[0]=T=>u.value=T),onChange:p},null,544),[[ys,u.value]]),Ve(" Delete existing "+_(V(i).checkpoints)+" before import ",1)])]),e.error?(v(),m("div",uI,_(e.error),1)):D("",!0),e.result?(v(),m("div",dI,[l("p",null,"Created "+_(e.result.locationsCreated)+" "+_(V(i).checkpoints)+" and "+_(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),m("div",hI,[I[2]||(I[2]=l("strong",null,"Errors:",-1)),l("ul",null,[(v(!0),m(we,null,Pe(e.result.errors,(T,S)=>(v(),m("li",{key:S},_(T),1))),128))])])):D("",!0)])):D("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},vI=Ye(pI,[["__scopeId","data-v-e0a01848"]]),mI={class:"instruction"},gI={class:"form-group"},yI={key:0,class:"error"},_I={key:1,class:"import-result"},kI={key:0,class:"import-errors"},bI=["disabled"],wI={__name:"ImportMarshalsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Lt(),s=e,a=t,c=P(null);We(()=>s.show,f=>{f||(c.value=null)});const u=f=>{c.value=f.target.files[0],a("update:isDirty",!0)},d=()=>{c.value&&a("submit",c.value)},p=()=>{a("close")};return(f,y)=>(v(),et(Dt,{show:e.show,title:`Import ${V(i).people} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:p},{actions:Qe(()=>[l("button",{type:"button",onClick:p,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:d,class:"btn btn-primary",disabled:e.importing},_(e.importing?"Importing...":`Import ${V(i).people}`),9,bI)]),default:Qe(()=>[l("p",mI,"Upload a CSV file with columns: Name, Email (optional), Phone (optional), "+_(V(o).checkpoint)+" (optional)",1),y[2]||(y[2]=l("div",{class:"csv-example"},[l("strong",null,"Example CSV format:"),l("pre",null,`Name,Email,Phone,Checkpoint
John Doe,john@example.com,555-1234,Checkpoint 1
Jane Smith,jane@example.com,555-5678,Checkpoint 2`)],-1)),l("form",{onSubmit:gt(d,["prevent"])},[l("div",gI,[y[0]||(y[0]=l("label",null,"CSV file",-1)),l("input",{type:"file",accept:".csv",onChange:u,required:"",class:"form-input"},null,32)]),e.error?(v(),m("div",yI,_(e.error),1)):D("",!0),e.result?(v(),m("div",_I,[l("p",null,"Imported "+_(e.result.marshalsCreated)+" "+_(V(i).people)+" and "+_(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),m("div",kI,[y[1]||(y[1]=l("strong",null,"Errors:",-1)),l("ul",null,[(v(!0),m(we,null,Pe(e.result.errors,(b,I)=>(v(),m("li",{key:I},_(b),1))),128))])])):D("",!0)])):D("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},CI=Ye(wI,[["__scopeId","data-v-dcaed17c"]]),LI={key:0,class:"tabs"},SI=["onClick"],xI=["innerHTML"],$I=["innerHTML"],II={class:"current-tab-label"},TI={key:0,class:"hamburger-menu"},MI=["onClick"],AI=["innerHTML"],EI=400,PI={__name:"TabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,i=t,s=P(null),a=P(null),c=P(!1),u=P(!1),d=Y(()=>{const S=o.tabs.find(O=>O.value===o.modelValue);return S?S.label:""}),p=Y(()=>o.tabs.find(O=>O.value===o.modelValue)?.icon||null),f=()=>{if(!s.value)return;const S=s.value.clientWidth,O=o.tabs.length*100;c.value=O>S||S<EI},y=()=>{u.value=!u.value},b=S=>{i("update:modelValue",S),u.value=!1},I=S=>{a.value&&!a.value.contains(S.target)&&(u.value=!1)};let T=null;return on(()=>{Ls(()=>{f(),s.value&&typeof ResizeObserver<"u"&&(T=new ResizeObserver(()=>{f()}),T.observe(s.value)),document.addEventListener("click",I)})}),Lo(()=>{T&&T.disconnect(),document.removeEventListener("click",I)}),We(()=>o.tabs,()=>{Ls(()=>{f()})},{deep:!0}),(S,O)=>(v(),m("div",{class:"tabs-container",ref_key:"containerRef",ref:s},[c.value?(v(),m("div",{key:1,class:"hamburger-container",ref_key:"hamburgerRef",ref:a},[l("button",{class:"hamburger-button",onClick:y,type:"button","aria-label":"Tab menu"},[p.value?(v(),m("span",{key:0,class:"current-tab-icon",innerHTML:V(un)(p.value)},null,8,$I)):D("",!0),l("span",II,_(d.value),1),O[0]||(O[0]=l("span",{class:"hamburger-chevron"},"",-1))]),u.value?(v(),m("div",TI,[(v(!0),m(we,null,Pe(e.tabs,E=>(v(),m("button",{key:E.value,class:_e(["menu-item",{active:e.modelValue===E.value}]),onClick:A=>b(E.value),type:"button"},[E.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:V(un)(E.icon)},null,8,AI)):D("",!0),Ve(" "+_(E.label),1)],10,MI))),128))])):D("",!0)],512)):(v(),m("div",LI,[(v(!0),m(we,null,Pe(e.tabs,E=>(v(),m("button",{key:E.value,class:_e(["tab-button",{active:e.modelValue===E.value}]),onClick:A=>S.$emit("update:modelValue",E.value),type:"button"},[E.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:V(un)(E.icon)},null,8,xI)):D("",!0),Ve(" "+_(E.label),1)],10,SI))),128))]))],512))}},xu=Ye(PI,[["__scopeId","data-v-a3662104"]]),DI={class:"tab-content"},OI={class:"form-group"},RI=["value"],BI={class:"form-group"},NI=["value"],FI={class:"form-group"},UI={class:"area-display"},zI={key:0,class:"no-area"},HI={class:"form-help"},VI={class:"form-group checkbox-group"},GI={class:"checkbox-label"},ZI=["checked"],jI={class:"form-help"},WI={key:0,class:"custom-times-section"},qI={class:"form-group"},KI=["value"],YI={class:"form-help"},JI={class:"form-group"},XI=["value"],QI={class:"form-help"},eT={__name:"LocationDetailsTab",props:{form:{type:Object,required:!0},areas:{type:Array,default:()=>[]},eventDate:{type:String,default:""},areaTermSingular:{type:String,default:"Area"},areaTermPlural:{type:String,default:"Areas"},checkpointTermSingular:{type:String,default:"checkpoint"},peopleTermPlural:{type:String,default:"marshals"}},emits:["update:form","input","save"],setup(e,{emit:t}){const o=e,i=t,s=Y(()=>(o.form.areaIds||o.form.AreaIds||[]).map(d=>o.areas.find(p=>p.id===d)).filter(d=>d!==void 0)),a=(u,d)=>{i("update:form",{...o.form,[u]:d}),i("input")},c=u=>{const d={...o.form,useCustomTimes:u};if(!u)d.startTime="",d.endTime="";else if(!d.startTime&&!d.endTime&&o.eventDate){const p=Ya(o.eventDate);d.startTime=p,d.endTime=p}i("update:form",d),i("input")};return(u,d)=>(v(),m("div",DI,[l("form",{onSubmit:d[5]||(d[5]=gt(p=>u.$emit("save"),["prevent"]))},[l("div",OI,[d[6]||(d[6]=l("label",null,"Name",-1)),l("input",{value:e.form.name,onInput:d[0]||(d[0]=p=>a("name",p.target.value)),type:"text",required:"",class:"form-input"},null,40,RI)]),l("div",BI,[d[7]||(d[7]=l("label",null,"Description (optional)",-1)),l("input",{value:e.form.description,onInput:d[1]||(d[1]=p=>a("description",p.target.value)),type:"text",class:"form-input"},null,40,NI)]),l("div",FI,[l("label",null,_(e.areaTermSingular)+" (auto-assigned by location)",1),l("div",UI,[s.value.length===0?(v(),m("span",zI," Not in any "+_(e.areaTermSingular.toLowerCase())+" polygon ",1)):D("",!0),(v(!0),m(we,null,Pe(s.value,p=>(v(),m("span",{key:p.id,class:"area-badge",style:ot({backgroundColor:p.color||"#667eea"})},_(p.name),5))),128))]),l("small",HI,_(e.areaTermPlural)+" are automatically assigned based on "+_(e.checkpointTermSingular.toLowerCase())+" location within "+_(e.areaTermSingular.toLowerCase())+" boundaries ",1)]),l("div",VI,[l("label",GI,[l("input",{checked:e.form.useCustomTimes,onChange:d[2]||(d[2]=p=>c(p.target.checked)),type:"checkbox"},null,40,ZI),l("span",null,"Use custom date/time for this "+_(e.checkpointTermSingular.toLowerCase()),1)]),l("small",jI," By default, "+_(e.peopleTermPlural.toLowerCase())+" are expected during the event date/time. Enable this to set a specific time range. ",1)]),e.form.useCustomTimes?(v(),m("div",WI,[l("div",qI,[d[8]||(d[8]=l("label",null,"Start date & time (optional)",-1)),l("input",{value:e.form.startTime,onInput:d[3]||(d[3]=p=>a("startTime",p.target.value)),type:"datetime-local",class:"form-input"},null,40,KI),l("small",YI," When "+_(e.peopleTermPlural.toLowerCase())+" should arrive at this "+_(e.checkpointTermSingular.toLowerCase()),1)]),l("div",JI,[d[9]||(d[9]=l("label",null,"End date & time (optional)",-1)),l("input",{value:e.form.endTime,onInput:d[4]||(d[4]=p=>a("endTime",p.target.value)),type:"datetime-local",class:"form-input"},null,40,XI),l("small",QI," When "+_(e.peopleTermPlural.toLowerCase())+" can leave this "+_(e.checkpointTermSingular.toLowerCase()),1)])])):D("",!0)],32)]))}},tT=Ye(eT,[["__scopeId","data-v-617deeb9"]]),nT={class:"scope-configuration-editor"},oT={class:"editor-header"},sT={class:"scope-types-list"},iT=["onClick"],aT={class:"scope-type-label"},rT={class:"scope-type-pill"},lT={class:"expand-label"},cT={class:"expand-icon"},uT={class:"modal-content"},dT={class:"modal-header"},hT={class:"modal-body"},fT={class:"scope-help"},pT={key:0,class:"form-group"},vT={class:"checkbox-label special-option"},mT=["checked"],gT={key:0,class:"specific-selection"},yT=["placeholder"],_T={class:"checkbox-group scrollable"},kT=["checked","onChange"],bT={key:1,class:"form-group"},wT={class:"checkbox-label special-option"},CT=["checked"],LT={key:0,class:"specific-selection"},ST={class:"checkbox-group scrollable"},xT=["checked","onChange"],$T={key:2,class:"form-group"},IT={class:"checkbox-label special-option"},TT=["checked"],MT={key:0,class:"specific-selection"},AT=["placeholder"],ET={class:"checkbox-group scrollable"},PT={key:0,class:"checkbox-label this-checkpoint-option"},DT=["checked"],OT={class:"checkpoint-info"},RT={class:"checkpoint-name"},BT=["checked","onChange"],NT={class:"checkpoint-info"},FT={class:"checkpoint-name"},UT={key:0,class:"checkpoint-description"},zT={__name:"ScopeConfigurationEditor",props:{modelValue:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},excludeScopes:{type:Array,default:()=>[]},headerText:{type:String,default:""},intent:{type:String,default:"completion",validator:e=>["completion","location-update"].includes(e)},currentCheckpointId:{type:String,default:null}},emits:["update:modelValue","user-changed"],setup(e,{emit:t}){const{termsLower:o}=Lt(),i=e,s=t,a=Y(()=>[{scope:"SpecificPeople",label:`Specific ${o.value.people}`},{scope:"EveryoneAtCheckpoints",label:`Every ${o.value.person} at specified ${o.value.checkpoints}`},{scope:"OnePerCheckpoint",label:`One ${o.value.person} at each specified ${o.value.checkpoint}`},{scope:"OnePerArea",label:`One ${o.value.person} in specified ${o.value.areas}`},{scope:"EveryoneInAreas",label:`Everyone in specified ${o.value.areas}`},{scope:"EveryAreaLead",label:`Every ${o.value.area} lead at specified ${o.value.areas}`},{scope:"OneLeadPerArea",label:`One lead per specified ${o.value.area}`}]),c=P({SpecificPeople:{enabled:!0,ids:["ALL_MARSHALS"]},EveryoneInAreas:{enabled:!1,ids:[]},EveryoneAtCheckpoints:{enabled:!1,ids:[]},OnePerCheckpoint:{enabled:!1,ids:[]},OnePerArea:{enabled:!1,ids:[]},EveryAreaLead:{enabled:!1,ids:[]},OneLeadPerArea:{enabled:!1,ids:[]}}),u=P(null),d=P(""),p=P(""),f=P(!i.isEditing);let y=!0,b=!1;const I=Y(()=>a.value.filter(z=>!i.excludeScopes.includes(z.scope))),T=Y(()=>f.value?I.value:I.value.filter(z=>ce(z.scope))),S=Y(()=>I.value.filter(ee=>ce(ee.scope)).length<I.value.length),O=Y(()=>{const z=I.value.filter(ee=>ce(ee.scope)).length;return I.value.length-z}),E=Y(()=>!i.currentCheckpointId&&i.intent==="location-update");We(()=>i.modelValue,z=>{if(z){if(b){b=!1;return}y=!0,Object.keys(c.value).forEach(ee=>{c.value[ee]={enabled:!1,ids:[]}}),z.forEach(ee=>{ee.scope==="Everyone"?c.value.SpecificPeople={enabled:!0,ids:["ALL_MARSHALS"]}:ee.scope==="AreaLead"?c.value.EveryAreaLead={enabled:!0,ids:[...ee.ids]}:c.value[ee.scope]&&(c.value[ee.scope]={enabled:!0,ids:[...ee.ids]})}),y=!1}},{immediate:!0});const A=()=>{const z=[];return Object.keys(c.value).forEach(ee=>{const ie=c.value[ee];if(ie.enabled){const B={scope:ee,itemType:$(ee),ids:[...ie.ids]};z.push(B)}}),z};We(c,()=>{if(y)return;if(Object.keys(c.value).some(ie=>ie!=="SpecificPeople"&&c.value[ie].enabled)&&c.value.SpecificPeople?.ids.includes("ALL_MARSHALS")){const ie=c.value.SpecificPeople.ids.indexOf("ALL_MARSHALS");c.value.SpecificPeople.ids.splice(ie,1),c.value.SpecificPeople.ids.length===0&&(c.value.SpecificPeople.enabled=!1)}b=!0;const ee=A();s("update:modelValue",ee),s("user-changed")},{deep:!0});const $=z=>C(z)?"Area":w(z)?"Checkpoint":k(z)?"Marshal":null,C=z=>z==="EveryoneInAreas"||z==="OnePerArea"||z==="EveryAreaLead"||z==="OneLeadPerArea",w=z=>z==="EveryoneAtCheckpoints"||z==="OnePerCheckpoint",k=z=>z==="SpecificPeople",M=z=>{const ee=a.value.find(ie=>ie.scope===z);return ee?ee.label:z},G=Y(()=>i.headerText?i.headerText:i.intent==="location-update"?"Who can update this location?":"Who can see and complete this item?"),ne=z=>i.intent==="location-update"?{SpecificPeople:`Select "Everyone" or choose specific ${o.value.people} who can update the location`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} can update the location`,OnePerCheckpoint:`Any ${o.value.person} at each selected ${o.value.checkpoint} can update the location`,OnePerArea:`Any ${o.value.person} in each selected ${o.value.area} can update the location`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} can update the location`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} can update the location`,OneLeadPerArea:`Any ${o.value.area} lead at the selected ${o.value.areas} can update the location`}[z]||"":{SpecificPeople:`Select "Everyone at the event" or choose specific ${o.value.people} who must complete this (personal completion)`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} must complete this (personal completion)`,OnePerCheckpoint:`One completion needed at each selected ${o.value.checkpoint} (shared completion)`,OnePerArea:`One completion needed in each selected ${o.value.area} (shared completion)`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} must complete this (personal completion)`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} must complete this individually (personal completion)`,OneLeadPerArea:`One completion per ${o.value.area}, only ${o.value.area} leads can complete (shared among leads)`}[z]||"",ce=z=>c.value[z]?.enabled||!1,K=z=>{const ee=c.value[z];if(!ee||!ee.enabled)return"No";const ie=ee.ids||[];if(C(z)){if(ie.includes("ALL_AREAS"))return`All ${o.value.areas}`;const B=ie.length;return B>0?`${B} ${B!==1?o.value.areas:o.value.area}`:`Select ${o.value.areas}...`}if(w(z)){if(ie.includes("ALL_CHECKPOINTS"))return`All ${o.value.checkpoints}`;if(ie.length===1&&ie[0]==="THIS_CHECKPOINT")return`This ${o.value.checkpoint}`;const B=ie.length;return B>0?`${B} ${B!==1?o.value.checkpoints:o.value.checkpoint}`:`Select ${o.value.checkpoints}...`}if(k(z)){if(ie.includes("ALL_MARSHALS"))return"Everyone";const B=ie.length;return B>0?`${B} ${B!==1?o.value.people:o.value.person}`:`Select ${o.value.people}...`}return"Configured"},se=z=>{u.value=z,d.value="",p.value=""},me=()=>{u.value=null},Re=()=>{u.value&&(c.value[u.value]={enabled:!1,ids:[]}),me()},Oe=()=>u.value&&c.value[u.value]?.ids.includes("ALL_MARSHALS"),de=()=>{if(!u.value)return;const z=c.value[u.value];Oe()?(z.ids=[],z.enabled=!1):(z.ids=["ALL_MARSHALS"],z.enabled=!0)},he=z=>u.value&&c.value[u.value]?.ids.includes(z),ve=z=>{if(!u.value)return;const ee=c.value[u.value],ie=ee.ids.indexOf(z);ie>=0?(ee.ids.splice(ie,1),ee.ids.length===0&&(ee.enabled=!1)):(ee.ids.push(z),ee.enabled=!0)},Te=Y(()=>{if(!p.value)return i.marshals;const z=p.value.toLowerCase();return i.marshals.filter(ee=>ee.name.toLowerCase().includes(z)||ee.email&&ee.email.toLowerCase().includes(z))}),fe=()=>u.value&&c.value[u.value]?.ids.includes("ALL_AREAS"),xe=()=>{if(!u.value)return;const z=c.value[u.value];fe()?(z.ids=[],z.enabled=!1):(z.ids=["ALL_AREAS"],z.enabled=!0)},Be=z=>u.value&&c.value[u.value]?.ids.includes(z),re=z=>{if(!u.value)return;const ee=c.value[u.value],ie=ee.ids.indexOf(z);ie>=0?(ee.ids.splice(ie,1),ee.ids.length===0&&(ee.enabled=!1)):(ee.ids.push(z),ee.enabled=!0)},Ee=()=>u.value&&c.value[u.value]?.ids.includes("ALL_CHECKPOINTS"),Me=()=>{if(!u.value)return;const z=c.value[u.value];Ee()?(z.ids=[],z.enabled=!1):(z.ids=["ALL_CHECKPOINTS"],z.enabled=!0)},$e=z=>u.value&&c.value[u.value]?.ids.includes(z),ue=z=>{if(!u.value)return;const ee=c.value[u.value],ie=ee.ids.indexOf(z);ie>=0?(ee.ids.splice(ie,1),ee.ids.length===0&&(ee.enabled=!1)):(ee.ids.push(z),ee.enabled=!0)},ye=Y(()=>{let z=i.locations;if(d.value){const ee=d.value.toLowerCase();z=z.filter(ie=>ie.name.toLowerCase().includes(ee)||ie.description&&ie.description.toLowerCase().includes(ee))}return[...z].sort((ee,ie)=>Fn(ee.name,ie.name))});return(z,ee)=>(v(),m("div",nT,[l("div",oT,[l("h4",null,_(G.value),1)]),l("div",sT,[(v(!0),m(we,null,Pe(T.value,ie=>(v(),m("div",{key:ie.scope,class:_e(["scope-type-row",{active:ce(ie.scope)}]),onClick:B=>se(ie.scope)},[l("div",aT,_(ie.label),1),l("div",rT,_(K(ie.scope)),1)],10,iT))),128)),S.value?(v(),m("div",{key:0,class:"expand-row",onClick:ee[0]||(ee[0]=ie=>f.value=!f.value)},[l("div",lT,_(f.value?"Show less":`Show ${O.value} more option${O.value!==1?"s":""}...`),1),l("div",cT,_(f.value?"":""),1)])):D("",!0)]),u.value?(v(),m("div",{key:0,class:"scope-config-modal",onClick:gt(me,["self"])},[l("div",uT,[l("div",dT,[l("h5",null,_(M(u.value)),1),l("button",{onClick:me,class:"btn-close",type:"button"},"")]),l("div",hT,[l("p",fT,_(ne(u.value)),1),k(u.value)?(v(),m("div",pT,[l("label",vT,[l("input",{type:"checkbox",checked:Oe(),onChange:de},null,40,mT),l("span",null,[ee[4]||(ee[4]=l("strong",null,"Everyone at the event",-1)),Ve(" (all current and future "+_(V(o).people)+")",1)])]),Oe()?D("",!0):(v(),m("div",gT,[Ge(l("input",{"onUpdate:modelValue":ee[1]||(ee[1]=ie=>p.value=ie),type:"text",placeholder:`Search ${V(o).people}...`,class:"search-input"},null,8,yT),[[at,p.value]]),l("div",_T,[(v(!0),m(we,null,Pe(Te.value,ie=>(v(),m("label",{key:ie.id,class:"checkbox-label"},[l("input",{type:"checkbox",checked:he(ie.id),onChange:B=>ve(ie.id)},null,40,kT),l("span",null,_(ie.name),1)]))),128))])]))])):D("",!0),C(u.value)?(v(),m("div",bT,[l("label",wT,[l("input",{type:"checkbox",checked:fe(),onChange:xe},null,40,CT),l("span",null,[l("strong",null,"All "+_(V(o).areas),1),Ve(" (includes future "+_(V(o).areas)+")",1)])]),fe()?D("",!0):(v(),m("div",LT,[l("div",ST,[(v(!0),m(we,null,Pe(e.areas,ie=>(v(),m("label",{key:ie.id,class:"checkbox-label"},[l("input",{type:"checkbox",checked:Be(ie.id),onChange:B=>re(ie.id)},null,40,xT),l("span",{class:"area-color-dot",style:ot({backgroundColor:ie.color||"#667eea"})},null,4),l("span",null,_(ie.name),1)]))),128))])]))])):D("",!0),w(u.value)?(v(),m("div",$T,[l("label",IT,[l("input",{type:"checkbox",checked:Ee(),onChange:Me},null,40,TT),l("span",null,[l("strong",null,"All "+_(V(o).checkpoints),1),Ve(" (includes future "+_(V(o).checkpoints)+")",1)])]),Ee()?D("",!0):(v(),m("div",MT,[Ge(l("input",{"onUpdate:modelValue":ee[2]||(ee[2]=ie=>d.value=ie),type:"text",placeholder:`Search ${V(o).checkpoints}...`,class:"search-input"},null,8,AT),[[at,d.value]]),l("div",ET,[E.value?(v(),m("label",PT,[l("input",{type:"checkbox",checked:$e("THIS_CHECKPOINT"),onChange:ee[3]||(ee[3]=ie=>ue("THIS_CHECKPOINT"))},null,40,DT),l("div",OT,[l("span",RT,[l("strong",null,"This "+_(V(o).checkpoint),1)])])])):D("",!0),(v(!0),m(we,null,Pe(ye.value,ie=>(v(),m("label",{key:ie.id,class:"checkbox-label"},[l("input",{type:"checkbox",checked:$e(ie.id),onChange:B=>ue(ie.id)},null,40,BT),l("div",NT,[l("span",FT,_(ie.name),1),ie.description?(v(),m("span",UT," - "+_(ie.description),1)):D("",!0)])]))),128))])]))])):D("",!0)]),l("div",{class:"modal-footer"},[l("button",{onClick:Re,class:"btn btn-secondary",type:"button"},"Deselect all"),l("button",{onClick:me,class:"btn btn-primary",type:"button"},"Done")])])])):D("",!0)]))}},Al=Ye(zT,[["__scopeId","data-v-97d31f0e"]]),HT={class:"tab-content"},VT={class:"form-group"},GT=["value"],ZT={key:0,class:"form-error"},jT={class:"form-row"},WT={class:"form-group"},qT=["value","disabled"],KT={class:"form-group"},YT=["value","disabled"],JT={class:"form-group"},XT={class:"accordion-item"},QT={class:"accordion-preview"},eM={class:"accordion-arrow"},tM={key:0,class:"accordion-content"},nM={class:"section-description"},oM={class:"dynamic-checkbox"},sM=["checked"],iM={key:0,class:"dynamic-settings"},aM={__name:"LocationCoordinatesTab",props:{form:{type:Object,required:!0},isMoving:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:"Checkpoint"},peopleTermPlural:{type:String,default:"Marshals"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:form","input","save","move-location"],setup(e,{emit:t}){const o=e,i=t,s=P(!1),a=y=>y==null||y===""?"":Number(y).toFixed(6),c=(y,b)=>{i("update:form",{...o.form,[y]:b}),i("input")},u=(y,b)=>{i("update:form",{...o.form,[y]:Number(b)}),i("input")},d=y=>{if(y){const b=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],I=o.form.locationUpdateScopeConfigurations||[],T=I.length>0?I:b;i("update:form",{...o.form,isDynamic:!0,latitude:0,longitude:0,locationUpdateScopeConfigurations:T})}else i("update:form",{...o.form,isDynamic:!1});i("input")},p=y=>{i("update:form",{...o.form,locationUpdateScopeConfigurations:y}),i("input")},f=y=>{if(!y)return!0;const b=y.includes(".")?y.split("."):y.split("/");if(b.length!==3)return!1;const I=/^[a-z]{1,20}$/;return b.every(T=>I.test(T))};return(y,b)=>(v(),m("div",HT,[l("form",{onSubmit:b[4]||(b[4]=gt(I=>y.$emit("save"),["prevent"]))},[l("div",VT,[b[8]||(b[8]=l("label",null,"What3Words (optional)",-1)),l("input",{value:e.form.what3Words,onInput:b[0]||(b[0]=I=>c("what3Words",I.target.value)),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap"},null,40,GT),e.form.what3Words&&!f(e.form.what3Words)?(v(),m("small",ZT," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):D("",!0)]),e.form.isDynamic?D("",!0):(v(),m(we,{key:0},[l("div",jT,[l("div",WT,[b[9]||(b[9]=l("label",null,"Longitude",-1)),l("input",{value:a(e.form.longitude),onInput:b[1]||(b[1]=I=>u("longitude",I.target.value)),type:"number",step:"0.000001",required:"",class:"form-input",disabled:e.isMoving,placeholder:"e.g., -0.091234"},null,40,qT)]),l("div",KT,[b[10]||(b[10]=l("label",null,"Latitude",-1)),l("input",{value:a(e.form.latitude),onInput:b[2]||(b[2]=I=>u("latitude",I.target.value)),type:"number",step:"0.000001",required:"",class:"form-input",disabled:e.isMoving,placeholder:"e.g., 51.505123"},null,40,YT)])]),l("div",JT,[l("button",{type:"button",onClick:b[3]||(b[3]=I=>y.$emit("move-location")),class:_e(["btn btn-secondary btn-with-icon",{"btn-primary":e.isMoving}])},[b[11]||(b[11]=l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),Ve(" "+_(e.isMoving?"Click on map to set new location...":`Move ${e.checkpointTermSingular.toLowerCase()}...`),1)],2)])],64))],32),l("div",XT,[l("button",{type:"button",class:_e(["accordion-header",{expanded:s.value}]),onClick:b[5]||(b[5]=I=>s.value=!s.value)},[b[12]||(b[12]=Zf('<div class="accordion-icon" data-v-b33d55cc><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-b33d55cc><path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="#F59E0B" opacity="0.3" data-v-b33d55cc></path><path d="M12 6L13.5 9L17 9.5L14.5 12L15 15.5L12 14L9 15.5L9.5 12L7 9.5L10.5 9L12 6Z" fill="#F59E0B" data-v-b33d55cc></path><circle cx="12" cy="11" r="2" fill="white" data-v-b33d55cc></circle></svg></div><span class="accordion-title" data-v-b33d55cc>Dynamic location</span>',2)),l("span",QT,_(e.form.isDynamic?"Enabled":"Disabled"),1),l("span",eM,_(s.value?"":""),1)],2),s.value?(v(),m("div",tM,[l("p",nM," Enable this for lead cars, sweep vehicles, or other moving "+_(e.checkpointTermSingular.toLowerCase())+"s whose location can be updated by designated "+_(e.peopleTermPlural.toLowerCase())+" during the event. ",1),l("label",oM,[l("input",{type:"checkbox",checked:e.form.isDynamic,onChange:b[6]||(b[6]=I=>d(I.target.checked))},null,40,sM),l("span",null,"This "+_(e.checkpointTermSingular.toLowerCase())+" can move",1)]),e.form.isDynamic?(v(),m("div",iM,[Ne(Al,{"model-value":e.form.locationUpdateScopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":e.isEditing,"header-text":`Who can update this ${e.checkpointTermSingular.toLowerCase()}'s location?`,"exclude-scopes":["OnePerCheckpoint","OneLeadPerArea","OnePerArea"],intent:"location-update","current-checkpoint-id":e.form.id,"onUpdate:modelValue":p,onUserChanged:b[7]||(b[7]=I=>y.$emit("input"))},null,8,["model-value","areas","locations","marshals","is-editing","header-text","current-checkpoint-id"])])):D("",!0)])):D("",!0)])]))}},rM=Ye(aM,[["__scopeId","data-v-b33d55cc"]]);function ev(e){const t=P(new Map),o=f=>t.value.has(f.id)?t.value.get(f.id):f.isCheckedIn;return{pendingCheckInChanges:t,getEffectiveCheckInStatus:o,handleToggleCheckIn:f=>{const b=!o(f);b===f.isCheckedIn?t.value.delete(f.id):t.value.set(f.id,b),e&&e()},getStatusIcon:f=>o(f)?"":"",getStatusColor:f=>o(f)?"#28a745":"#dc3545",getStatusText:f=>o(f)?"Checked in":"Not checked in",formatTime:f=>f?new Date(f).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",clearPendingChanges:()=>{t.value.clear()},getPendingChanges:()=>Array.from(t.value.entries()).map(([f,y])=>({assignmentId:f,shouldBeCheckedIn:y}))}}const lM={class:"tab-content"},cM={class:"form-group"},uM=["value"],dM={class:"section-title"},hM={class:"assignments-list"},fM={class:"assignment-info"},pM={class:"assignment-header"},vM=["title"],mM={key:1,class:"status-indicator pending-indicator",title:"Will be assigned on save"},gM={key:2,class:"pending-badge"},yM={key:3,class:"pending-badge"},_M={key:0,class:"check-in-info"},kM={class:"check-in-method"},bM={class:"assignment-actions"},wM=["onClick"],CM=["onClick"],LM={class:"assign-section"},SM={__name:"LocationAssignmentsTab",props:{form:{type:Object,required:!0},assignments:{type:Array,default:()=>[]},peopleTerm:{type:String,default:"Marshals"},personTerm:{type:String,default:"Marshal"}},emits:["update:form","input","remove-assignment","open-assign-modal"],setup(e,{expose:t,emit:o}){const i=e,s=Y(()=>i.peopleTerm.toLowerCase()),a=Y(()=>i.personTerm.toLowerCase()),c=o,{pendingCheckInChanges:u,getEffectiveCheckInStatus:d,handleToggleCheckIn:p,getStatusIcon:f,getStatusColor:y,getStatusText:b,formatTime:I}=ev(()=>c("input")),T=Y(()=>i.assignments?.length||0),S=Y(()=>i.assignments?[...i.assignments].sort((E,A)=>{const $=E.marshalName?.toLowerCase()||"",C=A.marshalName?.toLowerCase()||"";return $.localeCompare(C)}):[]),O=(E,A)=>{c("update:form",{...i.form,[E]:Number(A)}),c("input")};return t({pendingCheckInChanges:u,clearPendingChanges:()=>{u.value.clear()},getPendingChanges:()=>Array.from(u.value.entries()).map(([E,A])=>({assignmentId:E,shouldBeCheckedIn:A}))}),(E,A)=>(v(),m("div",lM,[l("div",cM,[l("label",null,"Required "+_(s.value),1),l("input",{value:e.form.requiredMarshals,onInput:A[0]||(A[0]=$=>O("requiredMarshals",$.target.value)),type:"number",min:"1",required:"",class:"form-input"},null,40,uM)]),l("h3",dM,"Assigned "+_(s.value)+" ("+_(T.value)+")",1),l("div",hM,[(v(!0),m(we,null,Pe(S.value,$=>(v(),m("div",{key:$.id,class:_e(["assignment-item",{"checked-in":!$.isPending&&V(d)($),"is-pending":$.isPending}])},[l("div",fM,[l("div",pM,[$.isPending?(v(),m("span",mM,"  ")):(v(),m("span",{key:0,class:"status-indicator",style:ot({color:V(y)($)}),title:V(b)($)},_(V(f)($)),13,vM)),l("strong",null,_($.marshalName),1),$.isPending?(v(),m("span",gM," (will be assigned on save) ")):V(u).has($.id)?(v(),m("span",yM," (unsaved) ")):D("",!0)]),!$.isPending&&V(d)($)?(v(),m("span",_M,[$.isCheckedIn&&!V(u).has($.id)?(v(),m(we,{key:0},[Ve(_(V(I)($.checkInTime))+" ",1),l("span",kM,"("+_($.checkInMethod)+")",1)],64)):(v(),m(we,{key:1},[Ve(" Will be checked in on save ")],64))])):D("",!0)]),l("div",bM,[$.isPending?D("",!0):(v(),m("button",{key:0,onClick:C=>V(p)($),class:_e(["btn btn-small",V(d)($)?"btn-danger":"btn-secondary"])},_(V(d)($)?"Undo":"Check in"),11,wM)),l("button",{onClick:C=>E.$emit("remove-assignment",$),class:"btn btn-small btn-danger"}," Remove ",8,CM)])],2))),128)),l("div",LM,[l("button",{type:"button",class:"btn btn-primary assign-btn",onClick:A[1]||(A[1]=$=>E.$emit("open-assign-modal"))}," + Assign "+_(a.value)+"... ",1)])])]))}},xM=Ye(SM,[["__scopeId","data-v-cff2a7ac"]]),$M={class:"checkpoint-checklist-view"},IM={key:0,class:"loading-state"},TM={key:1,class:"error-state"},MM={key:2,class:"empty-state"},AM={key:3,class:"empty-state"},EM={key:4,class:"checklist-items"},PM={class:"item-checkbox"},DM=["checked","disabled","onChange"],OM={class:"item-content"},RM={class:"item-header"},BM={class:"item-text-wrapper"},NM={class:"item-text"},FM={key:0,class:"item-context"},UM={class:"item-scope"},zM=["title"],HM={key:0,class:"completion-info"},VM={key:0,class:"pending-text"},GM={class:"completion-text"},ZM={class:"completion-time"},jM={key:1,class:"uncomplete-info"},WM={key:2,class:"disabled-reason"},qM={__name:"CheckpointChecklistView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=Lt(),a=e,c=o,u=P([]),d=P(!1),p=P(null),f=P(new Map),y=Y(()=>a.assignments.length===0),b=Y(()=>u.value.map(w=>{const k=f.value.get(`${w.itemId}|||${w.completionContextId}`),M=k!==void 0?k.complete:w.isCompleted,G=k!==void 0&&k.complete!==w.isCompleted;return{...w,localIsCompleted:M,isModified:G}})),I=async()=>{if(!(!a.eventId||!a.locationId&&!a.areaId)){d.value=!0,p.value=null;try{const w=a.locationId?await Ot.getCheckpointChecklist(a.eventId,a.locationId):await Ot.getAreaChecklist(a.eventId,a.areaId);if(u.value=w.data||[],a.modelValue&&a.modelValue.length>0){const k=new Map;a.modelValue.forEach(M=>{k.set(`${M.itemId}|||${M.contextId}`,{complete:M.complete,contextType:M.contextType,contextId:M.contextId})}),f.value=k}}catch(w){console.error("Failed to load checklist:",w),p.value=w.response?.data?.message||"Failed to load checklist"}finally{d.value=!1}}},T=w=>{const k=w.contextOwnerMarshalId||(a.assignments.length>0?a.assignments[0].marshalId:null);if(!k)return;const M=`${w.itemId}|||${w.completionContextId}`,G=f.value.get(M),ne=G!==void 0?G.complete:w.isCompleted;f.value.set(M,{complete:!ne,contextType:w.completionContextType,contextId:w.completionContextId,marshalId:k}),S()},S=()=>{const w=[];for(const[k,M]of f.value.entries()){const[G,ne]=k.split("|||"),ce=u.value.find(K=>K.itemId===G&&K.completionContextId===ne);ce&&M.complete!==ce.isCompleted&&w.push({itemId:G,complete:M.complete,contextType:M.contextType,contextId:M.contextId,marshalId:M.marshalId})}c("update:modelValue",w),c("change",w)};t({resetLocalState:()=>{if(f.value=new Map,a.modelValue&&a.modelValue.length>0){const w=new Map;a.modelValue.forEach(k=>{w.set(`${k.itemId}|||${k.contextId}`,{complete:k.complete,contextType:k.contextType,contextId:k.contextId,marshalId:k.marshalId})}),f.value=w}},loadChecklist:I});const E=w=>({Everyone:"Everyone",SpecificPeople:"Assigned to you",EveryoneInAreas:`Your ${s.value.areas}`,EveryoneAtCheckpoints:`Your ${s.value.checkpoints}`,OnePerCheckpoint:`One per ${s.value.checkpoint}`,OnePerArea:`One per ${s.value.area}`,EveryAreaLead:`${i.value.area} lead`,OneLeadPerArea:`One lead per ${s.value.area}`})[w.matchedScope]||w.matchedScope,A=w=>({Everyone:"This item is for everyone at the event",SpecificPeople:"This item is specifically assigned to certain people",EveryoneInAreas:`This item is for everyone in certain ${s.value.areas}`,EveryoneAtCheckpoints:`This item is for everyone at certain ${s.value.checkpoints}`,OnePerCheckpoint:`One person at the ${s.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${s.value.area} needs to complete this`,EveryAreaLead:`This item is for ${s.value.area} leads only`,OneLeadPerArea:`One ${s.value.area} lead needs to complete this`})[w.matchedScope]||"",$=w=>{if(!w.completionContextType||!w.completionContextId)return null;if(w.completionContextType==="Checkpoint"){const k=a.locations.find(G=>G.id===w.completionContextId);if(!k)return null;const M=k.description?`${k.name} - ${k.description}`:k.name;return`at ${s.value.checkpoint} ${M}`}if(w.completionContextType==="Area"){const k=a.areas.find(M=>M.id===w.completionContextId);return k?`in ${s.value.area} ${k.name}`:null}return w.completionContextType==="Personal"?w.contextOwnerName?`for ${w.contextOwnerName}`:"assigned individually":null},C=w=>w?new Date(w).toLocaleString():"";return We(()=>[a.eventId,a.locationId,a.areaId],()=>{I()},{immediate:!0}),(w,k)=>(v(),m("div",$M,[d.value?(v(),m("div",IM," Loading checklist... ")):p.value?(v(),m("div",TM,[l("p",null,_(p.value),1),l("button",{onClick:I,class:"btn btn-secondary btn-small"}," Retry ")])):y.value?(v(),m("div",MM,[...k[0]||(k[0]=[l("p",null,"No marshals assigned to this checkpoint yet.",-1),l("p",{class:"help-text"},"Assign marshals to enable checklist completion.",-1)])])):u.value.length===0?(v(),m("div",AM,[...k[1]||(k[1]=[l("p",null,"No checklist items for this checkpoint.",-1)])])):(v(),m("div",EM,[(v(!0),m(we,null,Pe(b.value,M=>(v(),m("div",{key:`${M.itemId}-${M.completionContextId}`,class:_e(["checklist-item",{"item-completed":M.localIsCompleted,"item-modified":M.isModified}])},[l("div",PM,[l("input",{type:"checkbox",checked:M.localIsCompleted,disabled:!M.canBeCompletedByMe&&!M.localIsCompleted,onChange:G=>T(M)},null,40,DM)]),l("div",OM,[l("div",RM,[l("div",BM,[l("div",NM,_(M.text),1),$(M)?(v(),m("div",FM,_($(M)),1)):D("",!0)]),l("div",UM,[l("span",{class:"scope-pill",title:A(M)},_(E(M)),9,zM)])]),M.localIsCompleted?(v(),m("div",HM,[M.isModified&&!M.isCompleted?(v(),m("span",VM," Will be marked as completed (pending save) ")):(v(),m(we,{key:1},[l("span",GM," Completed by "+_(M.completedByActorName||"Unknown"),1),l("span",ZM,_(C(M.completedAt)),1)],64))])):D("",!0),M.isModified&&M.isCompleted&&!M.localIsCompleted?(v(),m("div",jM,[...k[2]||(k[2]=[l("span",{class:"pending-text"},"Will be marked as incomplete (pending save)",-1)])])):D("",!0),!M.canBeCompletedByMe&&!M.localIsCompleted?(v(),m("div",WM," Already completed by someone else ")):D("",!0)])],2))),128))]))]))}},tv=Ye(qM,[["__scopeId","data-v-9dc97489"]]),KM={class:"notes-view"},YM={key:0,class:"loading-state"},JM={key:1,class:"error-state"},XM={key:2,class:"empty-state"},QM={key:3,class:"notes-list"},eA={class:"note-header"},tA={class:"note-title-row"},nA={key:0,class:"pin-icon",title:"Pinned"},oA={class:"note-title"},sA={class:"note-meta"},iA={key:0,class:"category-badge"},aA={key:0,class:"note-content"},rA={class:"note-footer"},lA={class:"created-info"},cA={key:0,class:"scope-info"},uA={__name:"NotesView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},marshalId:{type:String,default:null},allNotes:{type:Array,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},showScope:{type:Boolean,default:!0}},setup(e,{expose:t}){const o=e,i=P([]),s=P(!1),a=P(null),c=Y(()=>o.marshalId?"No notes for this marshal.":o.areaId?"No notes for this area.":o.locationId?"No notes for this checkpoint.":"No notes available."),u=Y(()=>o.areaId?o.locations.filter(E=>E.areaIds&&E.areaIds.includes(o.areaId)):[]),d=Y(()=>u.value.map(E=>E.id)),p=Y(()=>{if(!o.areaId)return[];const E=new Set;return o.assignments.filter(A=>d.value.includes(A.locationId)).forEach(A=>E.add(A.marshalId)),Array.from(E)}),f=E=>o.assignments.filter(A=>A.marshalId===E).map(A=>A.locationId),y=E=>{const A=f(E),$=new Set;for(const C of A){const w=o.locations.find(k=>k.id===C);w?.areaIds&&w.areaIds.forEach(k=>$.add(k))}return Array.from($)},b=(E,A)=>{if(!E.scopeConfigurations)return null;for(const $ of E.scopeConfigurations){if($.itemType==="Area"){if(A.type==="area"&&($.ids.includes(A.areaId)||$.ids.includes("ALL_AREAS")))return{matched:!0,scope:$.scope==="EveryAreaLead"?"Area leads":"Area"};if(A.type==="checkpoint"){const w=o.locations.find(k=>k.id===A.locationId)?.areaIds||[];if($.ids.includes("ALL_AREAS")||w.some(k=>$.ids.includes(k)))return{matched:!0,scope:$.scope==="EveryAreaLead"?"Area leads":"Area"}}}if($.itemType==="Checkpoint"){if(A.type==="checkpoint"&&($.ids.includes(A.locationId)||$.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint"};if(A.type==="area"&&A.checkpointIds.some(w=>$.ids.includes(w)||$.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint in area"}}if($.itemType==="Marshal"){if(A.type==="marshal"&&($.ids.includes(A.marshalId)||$.ids.includes("ALL_MARSHALS")))return{matched:!0,scope:"Marshal"};if(A.type==="checkpoint"){const C=o.assignments.filter(k=>k.locationId===A.locationId).map(k=>k.marshalId);if($.ids.includes("ALL_MARSHALS")||C.some(k=>$.ids.includes(k)))return{matched:!0,scope:"Marshal at checkpoint"}}if(A.type==="area"&&($.ids.includes("ALL_MARSHALS")||A.marshalIds.some(w=>$.ids.includes(w))))return{matched:!0,scope:"Marshal in area"}}if(A.type==="marshal"&&A.checkpointIds&&A.areaIds){if($.itemType==="Checkpoint"&&($.ids.includes("ALL_CHECKPOINTS")||A.checkpointIds.some(w=>$.ids.includes(w))))return{matched:!0,scope:"Assigned checkpoint"};if($.itemType==="Area"&&($.ids.includes("ALL_AREAS")||A.areaIds.some(w=>$.ids.includes(w))))return{matched:!0,scope:$.scope==="EveryAreaLead"?"Area lead":"Area"}}}return null},I=Y(()=>{const E=o.allNotes||i.value;if(!E||E.length===0)return[];if(o.areaId&&o.allNotes){const A={type:"area",areaId:o.areaId,checkpointIds:d.value,marshalIds:p.value},$=[],C=new Set;for(const w of E){if(C.has(w.noteId))continue;const k=b(w,A);k&&(C.add(w.noteId),$.push({...w,matchedScope:k.scope}))}return $}if(o.locationId&&o.allNotes){const A={type:"checkpoint",locationId:o.locationId},$=[],C=new Set;for(const w of E){if(C.has(w.noteId))continue;const k=b(w,A);k&&(C.add(w.noteId),$.push({...w,matchedScope:k.scope}))}return $}if(o.marshalId&&o.allNotes){const A=f(o.marshalId),$=y(o.marshalId),C={type:"marshal",marshalId:o.marshalId,checkpointIds:A,areaIds:$},w=[],k=new Set;for(const M of E){if(k.has(M.noteId))continue;const G=b(M,C);G&&(k.add(M.noteId),w.push({...M,matchedScope:G.scope}))}return w}return E}),T=Y(()=>{const E={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return[...I.value].sort((A,$)=>{if(A.isPinned!==$.isPinned)return A.isPinned?-1:1;const C=E[A.priority]??2,w=E[$.priority]??2;return C!==w?C-w:A.displayOrder!==$.displayOrder?A.displayOrder-$.displayOrder:new Date($.createdAt)-new Date(A.createdAt)})}),S=async()=>{if(o.allNotes===null&&o.eventId){s.value=!0,a.value=null;try{let E;o.marshalId?E=await ps.getMarshalNotes(o.eventId,o.marshalId):E=await ps.getByEvent(o.eventId),i.value=E.data||[]}catch(E){console.error("Failed to load notes:",E),a.value=E.response?.data?.message||"Failed to load notes"}finally{s.value=!1}}};We(()=>[o.eventId,o.locationId,o.areaId,o.marshalId],()=>{o.allNotes===null&&S()},{immediate:!0});const O=E=>{if(!E)return"";const A=new Date(E),C=new Date-A,w=Math.floor(C/6e4),k=Math.floor(C/36e5),M=Math.floor(C/864e5);return w<1?"just now":w<60?`${w}m ago`:k<24?`${k}h ago`:M<7?`${M}d ago`:A.toLocaleDateString()};return t({loadNotes:S}),(E,A)=>(v(),m("div",KM,[s.value?(v(),m("div",YM," Loading notes... ")):a.value?(v(),m("div",JM,[l("p",null,_(a.value),1),l("button",{onClick:S,class:"btn btn-secondary btn-small"}," Retry ")])):I.value.length===0?(v(),m("div",XM,[l("p",null,_(c.value),1)])):(v(),m("div",QM,[(v(!0),m(we,null,Pe(T.value,$=>(v(),m("div",{key:$.noteId,class:_e(["note-item",{pinned:$.isPinned}])},[l("div",eA,[l("div",tA,[$.isPinned?(v(),m("span",nA,"")):D("",!0),l("span",{class:_e(["priority-indicator",($.priority||"Normal").toLowerCase()])},null,2),l("strong",oA,_($.title),1)]),l("div",sA,[$.category?(v(),m("span",iA,_($.category),1)):D("",!0),l("span",{class:_e(["priority-badge",($.priority||"Normal").toLowerCase()])},_($.priority||"Normal"),3)])]),$.content?(v(),m("div",aA,_($.content),1)):D("",!0),l("div",rA,[l("span",lA," Created by "+_($.createdByName||"Unknown")+"  "+_(O($.createdAt)),1),$.matchedScope&&e.showScope?(v(),m("span",cA,_($.matchedScope),1)):D("",!0)])],2))),128))]))]))}},El=Ye(uA,[["__scopeId","data-v-6dd44fa8"]]),dA={class:"checklist-preview"},hA={class:"preview-actions"},fA={class:"preview-header"},pA={key:0,class:"add-item-form"},vA=["placeholder"],mA=["disabled"],gA={key:1,class:"pending-items"},yA={class:"item-content"},_A={class:"item-header"},kA={class:"item-text"},bA={class:"item-scope"},wA=["onClick"],CA={key:2,class:"empty-state"},LA={key:0,class:"help-text"},SA={key:3,class:"checklist-items"},xA={class:"item-content"},$A={class:"item-header"},IA={class:"item-text"},TA={class:"item-scope"},MA=["title"],AA={key:0,class:"item-context"},EA={__name:"ChecklistPreviewForLocation",props:{allChecklistItems:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Lt(),s=e,a=Y(()=>s.checkpointTermSingular?s.checkpointTermSingular.toLowerCase():i.value.checkpoint),c=t,u=P(!1),d=P(""),p=P([...s.modelValue]);We(()=>s.modelValue,$=>{p.value=[...$]},{deep:!0});const f=()=>{d.value.trim()&&(p.value.push({text:d.value.trim(),isNew:!0}),d.value="",u.value=!1,b())},y=$=>{p.value.splice($,1),b()},b=()=>{c("update:modelValue",[...p.value]),c("change")},I=$=>{const C=$.scope,w=$.itemType,k=$.ids||[];return(C==="EveryoneAtCheckpoints"||C==="OnePerCheckpoint")&&w==="Checkpoint"?k.includes("ALL_CHECKPOINTS"):C==="OnePerCheckpoint"&&w==="Area"?k.includes("ALL_AREAS")?!0:k.some(M=>s.pendingAreaIds.includes(M)):(C==="EveryoneInAreas"||C==="OnePerArea"||C==="EveryAreaLead"||C==="OneLeadPerArea")&&w==="Area"?k.includes("ALL_AREAS")?!0:k.some(M=>s.pendingAreaIds.includes(M)):!1},T=Y(()=>s.allChecklistItems.filter($=>$.scopeConfigurations&&$.scopeConfigurations.length>0?$.scopeConfigurations.some(C=>I(C)):!1)),S=$=>({EveryoneAtCheckpoints:`All at ${i.value.checkpoints}`,OnePerCheckpoint:`One per ${i.value.checkpoint}`,EveryoneInAreas:`All in ${i.value.areas}`,OnePerArea:`One per ${i.value.area}`,EveryAreaLead:`${i.value.area} leads`,OneLeadPerArea:`One lead per ${i.value.area}`})[$]||$,O=$=>{if(!$.scopeConfigurations||$.scopeConfigurations.length===0)return"Unknown";const C=$.scopeConfigurations.find(k=>I(k));if(!C)return S($.scopeConfigurations[0].scope);const w=C.ids||[];return w.includes("ALL_CHECKPOINTS")?`All ${i.value.checkpoints}`:w.includes("ALL_AREAS")?`All ${i.value.areas}`:S(C.scope)},E=$=>{if(!$.scopeConfigurations||$.scopeConfigurations.length===0)return"";const C=$.scopeConfigurations.find(k=>I(k));return C&&{EveryoneAtCheckpoints:`This item is for everyone at specified ${i.value.checkpoints}`,OnePerCheckpoint:`One person at each ${i.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${i.value.areas}`,OnePerArea:`One person in each ${i.value.area} needs to complete this`,EveryAreaLead:`This item is for ${i.value.area} leads only`,OneLeadPerArea:`One ${i.value.area} lead needs to complete this`}[C.scope]||""},A=$=>{if(!$.scopeConfigurations||$.scopeConfigurations.length===0)return null;const C=$.scopeConfigurations.find(M=>I(M));if(!C)return null;const w=C.itemType,k=C.ids||[];if(k.includes("ALL_CHECKPOINTS")||k.includes("ALL_AREAS"))return null;if(w==="Area"){const M=s.areas.filter(G=>k.includes(G.id)&&s.pendingAreaIds.includes(G.id)).map(G=>G.name);if(M.length>0)return`In: ${M.join(", ")}`}return null};return($,C)=>(v(),m("div",dA,[l("div",hA,[l("p",fA,_(e.isEditing?`Add new ${V(i).checklist} for this ${a.value}:`:`${V(o).checklists} that will apply at this ${a.value}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:C[0]||(C[0]=w=>u.value=!u.value)},_(u.value?"Cancel":`+ Add ${V(i).checklist}`),1)]),u.value?(v(),m("div",pA,[Ge(l("input",{"onUpdate:modelValue":C[1]||(C[1]=w=>d.value=w),type:"text",placeholder:`Enter ${V(i).checklist} text...`,class:"add-item-input",onKeyup:Qf(f,["enter"])},null,40,vA),[[at,d.value]]),l("button",{type:"button",class:"save-item-btn",disabled:!d.value.trim(),onClick:f}," Add ",8,mA)])):D("",!0),p.value.length>0?(v(),m("div",gA,[(v(!0),m(we,null,Pe(p.value,(w,k)=>(v(),m("div",{key:`pending-${k}`,class:"checklist-item pending"},[C[3]||(C[3]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",yA,[l("div",_A,[l("div",kA,_(w.text),1),l("div",bA,[C[2]||(C[2]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:M=>y(k),title:"Remove"},"  ",8,wA)])])])]))),128))])):D("",!0),!e.isEditing&&T.value.length===0&&p.value.length===0?(v(),m("div",CA,[l("p",null,"No "+_(V(i).checklists)+" will apply based on the current "+_(V(i).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),m("p",LA," Assign "+_(V(i).areas)+" to see relevant "+_(V(i).checklists)+". ",1)):D("",!0)])):D("",!0),!e.isEditing&&T.value.length>0?(v(),m("div",SA,[(v(!0),m(we,null,Pe(T.value,w=>(v(),m("div",{key:w.id,class:"checklist-item"},[C[4]||(C[4]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",xA,[l("div",$A,[l("div",IA,_(w.text),1),l("div",TA,[l("span",{class:"scope-pill",title:E(w)},_(O(w)),9,MA)])]),A(w)?(v(),m("div",AA,_(A(w)),1)):D("",!0)])]))),128))])):D("",!0)]))}},PA=Ye(EA,[["__scopeId","data-v-c2119cba"]]),DA={class:"notes-preview"},OA={class:"preview-actions"},RA={class:"preview-header"},BA={key:0,class:"add-item-form"},NA={class:"add-form-fields"},FA=["disabled"],UA={key:1,class:"pending-items"},zA={class:"note-header"},HA={class:"note-title"},VA={class:"note-actions"},GA=["onClick"],ZA={key:0,class:"note-content"},jA={key:2,class:"empty-state"},WA={key:0,class:"help-text"},qA={key:3,class:"notes-list"},KA={class:"note-header"},YA={class:"note-title"},JA=["title"],XA={key:0,class:"note-content"},QA={key:1,class:"note-context"},eE={__name:"NotesPreviewForLocation",props:{allNotes:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=Lt(),i=e,s=t,a=Y(()=>i.checkpointTermSingular?i.checkpointTermSingular.toLowerCase():o.value.checkpoint),c=P(!1),u=P(""),d=P(""),p=P([...i.modelValue]);We(()=>i.modelValue,$=>{p.value=[...$]},{deep:!0});const f=()=>{!u.value.trim()&&!d.value.trim()||(p.value.push({title:u.value.trim(),content:d.value.trim(),isNew:!0}),u.value="",d.value="",c.value=!1,b())},y=$=>{p.value.splice($,1),b()},b=()=>{s("update:modelValue",[...p.value]),s("change")},I=$=>{const C=$.scope,w=$.itemType,k=$.ids||[];return C==="EveryoneAtCheckpoints"&&w==="Checkpoint"?k.includes("ALL_CHECKPOINTS"):C==="EveryoneInAreas"&&w==="Area"?k.includes("ALL_AREAS")?!0:k.some(M=>i.pendingAreaIds.includes(M)):!1},T=Y(()=>i.allNotes.filter($=>$.scopeConfigurations&&$.scopeConfigurations.length>0?$.scopeConfigurations.some(C=>I(C)):!1)),S=$=>({EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[$]||$,O=$=>{if(!$.scopeConfigurations||$.scopeConfigurations.length===0)return"Unknown";const C=$.scopeConfigurations.find(k=>I(k));if(!C)return S($.scopeConfigurations[0].scope);const w=C.ids||[];return w.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:w.includes("ALL_AREAS")?`All ${o.value.areas}`:S(C.scope)},E=$=>{if(!$.scopeConfigurations||$.scopeConfigurations.length===0)return"";const C=$.scopeConfigurations.find(k=>I(k));return C&&{EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[C.scope]||""},A=$=>{if(!$.scopeConfigurations||$.scopeConfigurations.length===0)return null;const C=$.scopeConfigurations.find(M=>I(M));if(!C)return null;const w=C.itemType,k=C.ids||[];if(k.includes("ALL_CHECKPOINTS")||k.includes("ALL_AREAS"))return null;if(w==="Area"){const M=i.areas.filter(G=>k.includes(G.id)&&i.pendingAreaIds.includes(G.id)).map(G=>G.name);if(M.length>0)return`In: ${M.join(", ")}`}return null};return($,C)=>(v(),m("div",DA,[l("div",OA,[l("p",RA,_(e.isEditing?`Add new note for this ${a.value}:`:`Notes that will be visible at this ${a.value}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:C[0]||(C[0]=w=>c.value=!c.value)},_(c.value?"Cancel":"+ Add note"),1)]),c.value?(v(),m("div",BA,[l("div",NA,[Ge(l("input",{"onUpdate:modelValue":C[1]||(C[1]=w=>u.value=w),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[at,u.value]]),Ge(l("textarea",{"onUpdate:modelValue":C[2]||(C[2]=w=>d.value=w),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[at,d.value]])]),l("button",{type:"button",class:"save-item-btn",disabled:!u.value.trim()&&!d.value.trim(),onClick:f}," Add ",8,FA)])):D("",!0),p.value.length>0?(v(),m("div",UA,[(v(!0),m(we,null,Pe(p.value,(w,k)=>(v(),m("div",{key:`pending-${k}`,class:"note-item pending"},[l("div",zA,[l("span",HA,_(w.title||"Untitled"),1),l("div",VA,[C[3]||(C[3]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:M=>y(k),title:"Remove"},"  ",8,GA)])]),w.content?(v(),m("div",ZA,_(w.content),1)):D("",!0)]))),128))])):D("",!0),!e.isEditing&&T.value.length===0&&p.value.length===0?(v(),m("div",jA,[l("p",null,"No notes will apply based on the current "+_(V(o).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),m("p",WA," Assign "+_(V(o).areas)+" to see relevant notes. ",1)):D("",!0)])):D("",!0),!e.isEditing&&T.value.length>0?(v(),m("div",qA,[(v(!0),m(we,null,Pe(T.value,w=>(v(),m("div",{key:w.id,class:"note-item"},[l("div",KA,[l("span",YA,_(w.title||"Untitled"),1),l("span",{class:"scope-pill",title:E(w)},_(O(w)),9,JA)]),w.content?(v(),m("div",XA,_(w.content),1)):D("",!0),A(w)?(v(),m("div",QA,_(A(w)),1)):D("",!0)]))),128))])):D("",!0)]))}},tE=Ye(eE,[["__scopeId","data-v-729a6eeb"]]),nE={class:"base-modal-title modal-title-with-icon"},oE=["innerHTML"],sE={key:7,class:"tab-content incidents-tab"},iE={key:0,class:"incidents-list"},aE={key:1,class:"empty-state"},rE={key:8,class:"tab-content appearance-tab"},lE={class:"accordion-item"},cE=["innerHTML"],uE={class:"accordion-title"},dE={class:"accordion-arrow"},hE={key:0,class:"accordion-content"},fE={class:"section-description"},pE={class:"accordion-item"},vE={class:"accordion-preview"},mE={class:"accordion-arrow"},gE={key:0,class:"accordion-content"},yE={class:"section-description"},_E={class:"terminology-row"},kE={class:"terminology-field"},bE=["value"],wE={value:""},CE=["value"],LE={class:"terminology-field"},SE=["value"],xE={value:""},$E=["value"],IE={class:"custom-footer"},TE={key:1},Th="edit_location_accordion",ME={__name:"EditLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:null},assignments:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventDate:{type:String,default:""},areas:{type:Array,default:()=>[]},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},availableMarshals:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},incidents:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},zIndex:{type:Number,default:1e3}},emits:["close","save","delete","move-location","toggle-check-in","remove-assignment","open-assign-modal","update:isDirty","select-incident"],setup(e,{emit:t}){const{terms:o}=Lt(),i=e,s=t,a=P("details"),c=P(!1),u=P(null),d=P(null),p=P([]),f=P([]),y=P([]),b=P({id:null,name:"",description:"",what3Words:"",latitude:0,longitude:0,requiredMarshals:1,useCustomTimes:!1,startTime:"",endTime:"",areaIds:[],styleType:"default",styleColor:"",styleBackgroundShape:"",styleBackgroundColor:"",styleBorderColor:"",styleIconColor:"",styleSize:"",styleMapRotation:"",peopleTerm:"",checkpointTerm:"",isDynamic:!1,locationUpdateScopeConfigurations:[]}),I=()=>i.eventId?`${Th}_${i.eventId}`:Th,T=P({iconStyle:!1,terminology:!1});on(()=>{const q=localStorage.getItem(I());if(q)try{const F=JSON.parse(q);T.value={...T.value,...F}}catch{}});const S=q=>{T.value[q]=!T.value[q],localStorage.setItem(I(),JSON.stringify(T.value))},O=Y(()=>{const q=b.value.areaIds||[];if(q.length>0){const F=i.areas.filter(N=>q.includes(N.id)&&N.peopleTerm).sort((N,W)=>(N.checkpointCount||0)-(W.checkpointCount||0));if(F.length>0)return F[0].peopleTerm}return i.eventPeopleTerm||"Marshals"}),E=Y(()=>b.value.peopleTerm?b.value.peopleTerm:O.value),A=Y(()=>{const q=b.value.areaIds||[];if(q.length>0){const F=i.areas.filter(N=>q.includes(N.id)&&N.checkpointTerm).sort((N,W)=>(N.checkpointCount||0)-(W.checkpointCount||0));if(F.length>0)return F[0].checkpointTerm}return o.value.checkpoint});Y(()=>A.value.toLowerCase());const $=Y(()=>{const q=b.value.checkpointTerm||i.location?.checkpointTerm||i.location?.CheckpointTerm;if(q)return wi("checkpoint",q,E.value);const F=b.value.areaIds||[];let N=null;if(F.length>0){const W=i.areas.filter(ge=>F.includes(ge.id)&&ge.checkpointTerm).sort((ge,Se)=>(ge.checkpointCount||0)-(Se.checkpointCount||0));W.length>0&&(N=W[0].checkpointTerm)}return N?wi("checkpoint",N,E.value):o.value.checkpoint}),C=Y(()=>$.value.toLowerCase()),w=Y(()=>{const q=E.value;return wi("people",q)});Y(()=>w.value.toLowerCase());const k=Y(()=>o.value.area);Y(()=>k.value.toLowerCase());const M=Y(()=>o.value.area),G=Y(()=>M.value.toLowerCase()),ne=Y(()=>o.value.areas),ce=Y(()=>!!(i.location&&i.location.id)),K=Y(()=>ce.value?`Edit ${C.value}: ${i.location?.name||""}`:`Add ${C.value}`),se=Y(()=>{const q=[{value:"details",label:"Details",icon:"details"},{value:"location",label:"Location",icon:"location"},{value:"marshals",label:E.value,icon:"marshal"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}];return i.incidents&&i.incidents.length>0&&q.push({value:"incidents",label:"Incidents",icon:"incidents"}),q.push({value:"appearance",label:"Appearance",icon:"appearance"}),q}),me=Y(()=>se.value.findIndex(q=>q.value===a.value)),Re=Y(()=>me.value===se.value.length-1),Oe=Y(()=>{const q=b.value.areaIds||[],F=i.areas.filter(J=>q.includes(J.id)).sort((J,Ze)=>(J.checkpointCount||0)-(Ze.checkpointCount||0)),N=(J,Ze)=>{for(const Xe of F){const rt=J(Xe);if(rt&&rt!=="default")return{value:rt,source:"area"}}return Ze&&Ze!=="default"?{value:Ze,source:"event"}:{value:"",source:"none"}},W=N(J=>J.checkpointStyleType||J.CheckpointStyleType,i.eventDefaultStyleType),ge=N(J=>J.checkpointStyleColor||J.CheckpointStyleColor,i.eventDefaultStyleColor),Se=N(J=>J.checkpointStyleBackgroundShape||J.CheckpointStyleBackgroundShape,i.eventDefaultStyleBackgroundShape),Ce=N(J=>J.checkpointStyleBackgroundColor||J.CheckpointStyleBackgroundColor||J.checkpointStyleColor||J.CheckpointStyleColor,i.eventDefaultStyleBackgroundColor||i.eventDefaultStyleColor),ze=N(J=>J.checkpointStyleBorderColor||J.CheckpointStyleBorderColor,i.eventDefaultStyleBorderColor),Fe=N(J=>J.checkpointStyleIconColor||J.CheckpointStyleIconColor,i.eventDefaultStyleIconColor),je=N(J=>J.checkpointStyleSize||J.CheckpointStyleSize,i.eventDefaultStyleSize),Je=N(J=>J.checkpointStyleMapRotation??J.CheckpointStyleMapRotation,i.eventDefaultStyleMapRotation),oe=[W,Se,Ce,ze,Fe,je,Je].some(J=>J.source==="area");return{type:W.value||"default",color:ge.value,backgroundShape:Se.value,backgroundColor:Ce.value,borderColor:ze.value,iconColor:Fe.value,size:je.value,mapRotation:Je.value,source:oe?"area":W.value?"event":"none"}}),de=Y(()=>Oe.value.source==="area"?`${M.value} default`:"Event default"),he=Y(()=>{const q=b.value.styleType&&b.value.styleType!=="default"&&b.value.styleType!=="custom"?b.value.styleType:Oe.value.type,F=b.value.styleBackgroundShape||Oe.value.backgroundShape||"circle",N=b.value.styleBackgroundColor||Oe.value.backgroundColor||"#667eea",W=b.value.styleBorderColor||Oe.value.borderColor||"#ffffff",ge=b.value.styleIconColor||Oe.value.iconColor||"#ffffff";return Xt({type:q||"circle",backgroundShape:F,backgroundColor:N,borderColor:W,iconColor:ge,size:"100"})}),ve=Y(()=>{let q,F,N,W,ge;return ce.value&&i.location?(q=i.location.resolvedStyleType||i.location.ResolvedStyleType,F=i.location.resolvedStyleBackgroundShape||i.location.ResolvedStyleBackgroundShape||"circle",N=i.location.resolvedStyleBackgroundColor||i.location.ResolvedStyleBackgroundColor||i.location.resolvedStyleColor||i.location.ResolvedStyleColor||"#667eea",W=i.location.resolvedStyleBorderColor||i.location.ResolvedStyleBorderColor||"#ffffff",ge=i.location.resolvedStyleIconColor||i.location.ResolvedStyleIconColor||"#ffffff"):(q=b.value.styleType&&b.value.styleType!=="default"&&b.value.styleType!=="custom"?b.value.styleType:Oe.value.type,F=b.value.styleBackgroundShape||Oe.value.backgroundShape||"circle",N=b.value.styleBackgroundColor||Oe.value.backgroundColor||"#667eea",W=b.value.styleBorderColor||Oe.value.borderColor||"#ffffff",ge=b.value.styleIconColor||Oe.value.iconColor||"#ffffff"),Xt({type:q||"circle",backgroundShape:F,backgroundColor:N,borderColor:W,iconColor:ge,size:"100",outputSize:28})}),Te=Y(()=>{const q=!!b.value.checkpointTerm,F=!!b.value.peopleTerm;return q&&F?`${wi("checkpoint",b.value.checkpointTerm,b.value.peopleTerm)}, ${b.value.peopleTerm}`:q?wi("checkpoint",b.value.checkpointTerm,E.value):F?b.value.peopleTerm:"Using defaults"}),fe=Y(()=>Re.value?null:se.value[me.value+1]),xe=Y(()=>Re.value?`Create ${C.value}`:`Add ${fe.value.label.toLowerCase()}...`),Be=P(!1),re=P(null);We(()=>i.location,q=>{if(q){const F=q.id||"new";if(re.value!==F){re.value=F,Be.value=!0;let N="",W="";q.startTime&&(N=Ya(q.startTime)),q.endTime&&(W=Ya(q.endTime)),b.value={id:q.id||null,name:q.name||"",description:q.description||"",what3Words:q.what3Words||"",latitude:q.latitude||0,longitude:q.longitude||0,requiredMarshals:q.requiredMarshals||1,useCustomTimes:!!(q.startTime||q.endTime),startTime:N,endTime:W,areaIds:q.areaIds||q.AreaIds||[],styleType:q.styleType||q.StyleType||"default",styleColor:q.styleColor||q.StyleColor||"",styleBackgroundShape:q.styleBackgroundShape||q.StyleBackgroundShape||"",styleBackgroundColor:q.styleBackgroundColor||q.StyleBackgroundColor||"",styleBorderColor:q.styleBorderColor||q.StyleBorderColor||"",styleIconColor:q.styleIconColor||q.StyleIconColor||"",styleSize:q.styleSize||q.StyleSize||"",styleMapRotation:q.styleMapRotation??q.StyleMapRotation??"",peopleTerm:q.peopleTerm||"",checkpointTerm:q.checkpointTerm||"",isDynamic:q.isDynamic||!1,locationUpdateScopeConfigurations:q.locationUpdateScopeConfigurations||[]}}}},{immediate:!0,deep:!0}),We(()=>i.show,q=>{q?(a.value="details",c.value=!1,p.value=[],f.value=[],y.value=[],u.value?.clearPendingChanges&&u.value.clearPendingChanges(),d.value?.resetLocalState&&d.value.resetLocalState()):(re.value=null,Be.value=!1)});const Ee=q=>{b.value=q},Me=()=>{s("update:isDirty",!0)},$e=()=>{c.value=!c.value,s("move-location",{isMoving:c.value,formData:{...b.value}})},ue=q=>{p.value=q,Me()},ye=()=>{ce.value||Re.value?z():a.value=fe.value.value},z=()=>{const q={...b.value,startTime:b.value.useCustomTimes&&b.value.startTime?new Date(b.value.startTime).toISOString():null,endTime:b.value.useCustomTimes&&b.value.endTime?new Date(b.value.endTime).toISOString():null,checkInChanges:u.value?.getPendingChanges?.()||[],checklistChanges:p.value||[],pendingAssignments:i.assignments.filter(F=>F.isPending).map(F=>({marshalId:F.marshalId})),pendingNewChecklistItems:f.value,pendingNewNotes:y.value};s("save",q)},ee=()=>{i.location&&i.location.id&&s("delete",i.location.id)},ie=q=>{s("remove-assignment",q)},B=()=>{s("open-assign-modal")},j=()=>{s("close")},X=(q,F)=>{b.value[q]=F,Me()};return(q,F)=>(v(),et(Dt,{show:e.show,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:j},{header:Qe(()=>[l("h2",nE,[ve.value?(v(),m("span",{key:0,class:"modal-title-icon",innerHTML:ve.value},null,8,oE)):D("",!0),Ve(" "+_(K.value),1)])]),"tab-header":Qe(()=>[Ne(xu,{modelValue:a.value,"onUpdate:modelValue":F[0]||(F[0]=N=>a.value=N),tabs:se.value},null,8,["modelValue","tabs"])]),footer:Qe(()=>[l("div",IE,[ce.value?(v(),m("button",{key:0,type:"button",onClick:ee,class:"btn btn-danger"}," Delete "+_(C.value),1)):(v(),m("div",TE)),l("button",{type:"button",onClick:ye,class:"btn btn-primary"},_(ce.value?"Save changes":xe.value),1)])]),default:Qe(()=>[a.value==="details"?(v(),et(tT,{key:0,form:b.value,areas:e.areas,"event-date":e.eventDate,"area-term-singular":M.value,"area-term-plural":ne.value,"checkpoint-term-singular":$.value,"people-term-plural":E.value,"onUpdate:form":Ee,onInput:Me,onSave:z},null,8,["form","areas","event-date","area-term-singular","area-term-plural","checkpoint-term-singular","people-term-plural"])):D("",!0),a.value==="location"?(v(),et(rM,{key:1,form:b.value,"is-moving":c.value,"checkpoint-term-singular":$.value,"people-term-plural":E.value,areas:e.areas,locations:e.allLocations,marshals:e.availableMarshals,"is-editing":ce.value,"onUpdate:form":Ee,onInput:Me,onSave:z,onMoveLocation:$e},null,8,["form","is-moving","checkpoint-term-singular","people-term-plural","areas","locations","marshals","is-editing"])):D("",!0),a.value==="marshals"?(v(),et(xM,{key:2,ref_key:"assignmentsTabRef",ref:u,form:b.value,assignments:e.assignments,"people-term":E.value,"person-term":w.value,"onUpdate:form":Ee,onInput:Me,onRemoveAssignment:ie,onOpenAssignModal:B},null,8,["form","assignments","people-term","person-term"])):D("",!0),a.value==="checklists"&&ce.value?(v(),et(tv,{key:3,ref_key:"checklistTabRef",ref:d,modelValue:p.value,"onUpdate:modelValue":F[1]||(F[1]=N=>p.value=N),"event-id":e.eventId,"location-id":e.location.id,locations:e.allLocations,areas:e.areas,assignments:e.assignments,onChange:ue},null,8,["modelValue","event-id","location-id","locations","areas","assignments"])):D("",!0),a.value==="checklists"?(v(),et(PA,{key:4,modelValue:f.value,"onUpdate:modelValue":F[2]||(F[2]=N=>f.value=N),"all-checklist-items":e.allChecklistItems,"pending-area-ids":b.value.areaIds,areas:e.areas,"is-editing":ce.value,"checkpoint-term-singular":$.value,onChange:Me},null,8,["modelValue","all-checklist-items","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):D("",!0),a.value==="notes"&&ce.value?(v(),et(El,{key:5,"event-id":e.eventId,"location-id":e.location?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","location-id","all-notes","locations","areas","assignments"])):D("",!0),a.value==="notes"?(v(),et(tE,{key:6,modelValue:y.value,"onUpdate:modelValue":F[3]||(F[3]=N=>y.value=N),"all-notes":e.notes,"pending-area-ids":b.value.areaIds,areas:e.areas,"is-editing":ce.value,"checkpoint-term-singular":$.value,onChange:Me},null,8,["modelValue","all-notes","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):D("",!0),a.value==="incidents"?(v(),m("div",sE,[e.incidents&&e.incidents.length>0?(v(),m("div",iE,[(v(!0),m(we,null,Pe(e.incidents,N=>(v(),et(rr,{key:N.incidentId,incident:N,onClick:W=>q.$emit("select-incident",N)},null,8,["incident","onClick"]))),128))])):(v(),m("div",aE," No incidents for this "+_(C.value)+". ",1))])):D("",!0),a.value==="appearance"?(v(),m("div",rE,[l("div",lE,[l("button",{type:"button",class:_e(["accordion-header",{expanded:T.value.iconStyle}]),onClick:F[4]||(F[4]=N=>S("iconStyle"))},[l("div",{class:"accordion-icon",innerHTML:he.value},null,8,cE),l("span",uE,_($.value)+" marker style",1),l("span",dE,_(T.value.iconStyle?"":""),1)],2),T.value.iconStyle?(v(),m("div",hE,[l("p",fE," Choose a custom icon for this "+_(C.value)+", or leave as Default to inherit from "+_(G.value)+" or event settings. ",1),Ne(Su,{"style-type":b.value.styleType||"default","style-color":b.value.styleColor||"","style-background-shape":b.value.styleBackgroundShape||"","style-background-color":b.value.styleBackgroundColor||"","style-border-color":b.value.styleBorderColor||"","style-icon-color":b.value.styleIconColor||"","style-size":b.value.styleSize||"","style-map-rotation":b.value.styleMapRotation??"","inherited-style-type":Oe.value.type,"inherited-style-color":Oe.value.color,"inherited-background-shape":Oe.value.backgroundShape||"","inherited-background-color":Oe.value.backgroundColor||Oe.value.color||"","inherited-border-color":Oe.value.borderColor||"","inherited-icon-color":Oe.value.iconColor||"","inherited-size":Oe.value.size||"","inherited-map-rotation":Oe.value.mapRotation??"","default-label":de.value,"icon-label":"Marker style",level:"checkpoint","show-preview":!0,"onUpdate:styleType":F[5]||(F[5]=N=>X("styleType",N)),"onUpdate:styleColor":F[6]||(F[6]=N=>X("styleColor",N)),"onUpdate:styleBackgroundShape":F[7]||(F[7]=N=>X("styleBackgroundShape",N)),"onUpdate:styleBackgroundColor":F[8]||(F[8]=N=>X("styleBackgroundColor",N)),"onUpdate:styleBorderColor":F[9]||(F[9]=N=>X("styleBorderColor",N)),"onUpdate:styleIconColor":F[10]||(F[10]=N=>X("styleIconColor",N)),"onUpdate:styleSize":F[11]||(F[11]=N=>X("styleSize",N)),"onUpdate:styleMapRotation":F[12]||(F[12]=N=>X("styleMapRotation",N))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation","default-label"])])):D("",!0)]),l("div",pE,[l("button",{type:"button",class:_e(["accordion-header",{expanded:T.value.terminology}]),onClick:F[13]||(F[13]=N=>S("terminology"))},[F[16]||(F[16]=l("div",{class:"accordion-icon"},[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("circle",{cx:"9",cy:"8",r:"3",fill:"#6366F1"}),l("path",{d:"M3 18c0-3.3 2.7-6 6-6s6 2.7 6 6",fill:"#6366F1",opacity:"0.5"}),l("circle",{cx:"17",cy:"14",r:"5",fill:"#10B981",opacity:"0.3"}),l("circle",{cx:"17",cy:"14",r:"3",fill:"#10B981"}),l("circle",{cx:"17",cy:"14",r:"1",fill:"white"})])],-1)),F[17]||(F[17]=l("span",{class:"accordion-title"},"Terminology",-1)),l("span",vE,_(Te.value),1),l("span",mE,_(T.value.terminology?"":""),1)],2),T.value.terminology?(v(),m("div",gE,[l("p",yE," Customise what this "+_(C.value)+" and its "+_(E.value.toLowerCase())+" are called. ",1),l("div",_E,[l("div",kE,[l("label",null,"What is this "+_(C.value)+" called?",1),l("select",{value:b.value.checkpointTerm,class:"form-input",onChange:F[14]||(F[14]=N=>{Ee({...b.value,checkpointTerm:N.target.value}),Me()})},[l("option",wE,"Use "+_(G.value)+" default ("+_($.value)+")",1),F[18]||(F[18]=l("option",{value:"Vehicle"},"Vehicle",-1)),F[19]||(F[19]=l("option",{value:"Car"},"Car",-1)),F[20]||(F[20]=l("option",{value:"Bike"},"Bike",-1)),(v(!0),m(we,null,Pe(V(_s).checkpoint,N=>(v(),m("option",{key:N,value:N},_(N),9,CE))),128))],40,bE)]),l("div",LE,[l("label",null,"What are "+_(E.value.toLowerCase())+" called here?",1),l("select",{value:b.value.peopleTerm,class:"form-input",onChange:F[15]||(F[15]=N=>{Ee({...b.value,peopleTerm:N.target.value}),Me()})},[l("option",xE,"Use "+_(G.value)+" default ("+_(O.value)+")",1),(v(!0),m(we,null,Pe(V(_s).people,N=>(v(),m("option",{key:N,value:N},_(N),9,$E))),128))],40,SE)])])])):D("",!0)])])):D("",!0)]),_:1},8,["show","is-dirty","z-index"]))}},AE=Ye(ME,[["__scopeId","data-v-2c6e7ab6"]]),EE={class:"tab-content"},PE={class:"form-group"},DE=["value"],OE={class:"form-group"},RE=["value"],BE={class:"form-group"},NE=["value"],FE={class:"form-group"},UE=["value"],zE={key:0,class:"magic-link-section"},HE={key:0,class:"loading-text"},VE={key:1,class:"magic-link-container"},GE={class:"magic-link-row"},ZE=["value"],jE={key:0,class:"magic-link-actions"},WE=["disabled"],qE={key:1,class:"success-text"},KE={key:2,class:"error-text"},YE={key:2,class:"error-text"},JE={__name:"MarshalDetailsTab",props:{form:{type:Object,required:!0},eventId:{type:String,default:null},marshalId:{type:String,default:null}},emits:["update:form","input"],setup(e,{emit:t}){const o=e,i=t,s=P(""),a=P(!1),c=P(!1),u=P(""),d=P(!1),p=P(!1),f=P(!1),y=P(""),b=(O,E)=>{i("update:form",{...o.form,[O]:E}),i("input")},I=async()=>{if(!(!o.eventId||!o.marshalId)){c.value=!0,u.value="";try{const O=await jo.getMagicLink(o.eventId,o.marshalId);s.value=O.data.magicLink,a.value=O.data.hasEmail}catch(O){console.error("Failed to fetch magic link:",O),u.value="Failed to load login link"}finally{c.value=!1}}},T=async()=>{try{await navigator.clipboard.writeText(s.value),d.value=!0,setTimeout(()=>{d.value=!1},2e3)}catch(O){console.error("Failed to copy:",O)}},S=async()=>{if(!(!o.eventId||!o.marshalId)){p.value=!0,f.value=!1,y.value="";try{await jo.sendMagicLink(o.eventId,o.marshalId),f.value=!0,setTimeout(()=>{f.value=!1},3e3)}catch(O){console.error("Failed to send email:",O),y.value=O.response?.data?.message||"Failed to send email"}finally{p.value=!1}}};return We(()=>o.marshalId,O=>{O?I():(s.value="",a.value=!1)},{immediate:!0}),(O,E)=>(v(),m("div",EE,[l("div",PE,[E[5]||(E[5]=l("label",null,"Name *",-1)),l("input",{value:e.form.name,onInput:E[0]||(E[0]=A=>b("name",A.target.value)),type:"text",required:"",class:"form-input"},null,40,DE)]),l("div",OE,[E[6]||(E[6]=l("label",null,"Email",-1)),l("input",{value:e.form.email,onInput:E[1]||(E[1]=A=>b("email",A.target.value)),type:"email",class:"form-input"},null,40,RE)]),l("div",BE,[E[7]||(E[7]=l("label",null,"Phone number",-1)),l("input",{value:e.form.phoneNumber,onInput:E[2]||(E[2]=A=>b("phoneNumber",A.target.value)),type:"tel",class:"form-input"},null,40,NE)]),l("div",FE,[E[8]||(E[8]=l("label",null,"Notes",-1)),l("textarea",{value:e.form.notes,onInput:E[3]||(E[3]=A=>b("notes",A.target.value)),class:"form-input",rows:"3",placeholder:"e.g., Needs to leave by 11am"},null,40,UE)]),e.marshalId?(v(),m("div",zE,[E[9]||(E[9]=l("label",null,"Login link",-1)),E[10]||(E[10]=l("p",{class:"help-text"},"Share this unique link with the marshal so they can access their dashboard.",-1)),c.value?(v(),m("div",HE,"Loading link...")):s.value?(v(),m("div",VE,[l("div",GE,[l("input",{type:"text",value:s.value,readonly:"",class:"form-input magic-link-input",onFocus:E[4]||(E[4]=A=>A.target.select())},null,40,ZE),l("button",{type:"button",class:"btn btn-secondary",onClick:T},_(d.value?"Copied!":"Copy link"),1)]),a.value?(v(),m("div",jE,[l("button",{type:"button",class:"btn btn-primary",disabled:p.value,onClick:S},_(p.value?"Sending...":"Send via email"),9,WE)])):D("",!0),f.value?(v(),m("p",qE,"Email sent successfully!")):D("",!0),y.value?(v(),m("p",KE,_(y.value),1)):D("",!0)])):u.value?(v(),m("div",YE,_(u.value),1)):D("",!0)])):D("",!0)]))}},XE=Ye(JE,[["__scopeId","data-v-fbbb0e01"]]),QE={class:"tab-content"},eP={class:"section-title"},tP={class:"assignments-list"},nP={class:"assignment-info"},oP={class:"assignment-header"},sP=["title"],iP={key:1,class:"status-indicator pending-indicator",title:"Will be assigned on save"},aP={key:2,class:"pending-badge"},rP={key:3,class:"pending-badge"},lP={key:0,class:"check-in-info"},cP={class:"check-in-method"},uP={class:"assignment-actions"},dP=["onClick"],hP=["onClick"],fP={key:0,class:"form-group",style:{"margin-top":"1.5rem"}},pP={value:""},vP=["value"],mP={__name:"MarshalCheckpointsTab",props:{assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},isNewMarshal:{type:Boolean,default:!1}},emits:["input","remove-assignment","assign-to-location"],setup(e,{expose:t,emit:o}){const{termsLower:i}=Lt(),s=e,a=o,{pendingCheckInChanges:c,getEffectiveCheckInStatus:u,handleToggleCheckIn:d,getStatusIcon:p,getStatusColor:f,getStatusText:y,formatTime:b}=ev(()=>a("input")),I=P(""),T=Y(()=>s.assignments?.length||0),S=Y(()=>{const E=[...s.availableLocations];return E.sort((A,$)=>A.name.localeCompare($.name,void 0,{numeric:!0,sensitivity:"base"})),E}),O=()=>{I.value&&(a("assign-to-location",I.value),I.value="")};return t({pendingCheckInChanges:c,clearPendingChanges:()=>{c.value.clear(),I.value=""},getPendingChanges:()=>Array.from(c.value.entries()).map(([E,A])=>({assignmentId:E,shouldBeCheckedIn:A}))}),(E,A)=>(v(),m("div",QE,[l("h3",eP,"Assigned "+_(V(i).checkpoints)+" ("+_(T.value)+")",1),l("div",tP,[(v(!0),m(we,null,Pe(e.assignments,$=>(v(),m("div",{key:$.id,class:_e(["assignment-item",{"checked-in":!$.isPending&&V(u)($),"is-pending":$.isPending}])},[l("div",nP,[l("div",oP,[$.isPending?(v(),m("span",iP,"  ")):(v(),m("span",{key:0,class:"status-indicator",style:ot({color:V(f)($)}),title:V(y)($)},_(V(p)($)),13,sP)),l("strong",null,_($.locationName),1),$.isPending?(v(),m("span",aP," (will be assigned on save) ")):V(c).has($.id)?(v(),m("span",rP," (unsaved) ")):D("",!0)]),!$.isPending&&V(u)($)?(v(),m("span",lP,[$.isCheckedIn&&!V(c).has($.id)?(v(),m(we,{key:0},[Ve(_(V(b)($.checkInTime))+" ",1),l("span",cP,"("+_($.checkInMethod)+")",1)],64)):(v(),m(we,{key:1},[Ve(" Will be checked in on save ")],64))])):D("",!0)]),l("div",uP,[$.isPending?D("",!0):(v(),m("button",{key:0,onClick:C=>V(d)($),class:_e(["btn btn-small",V(u)($)?"btn-danger":"btn-secondary"])},_(V(u)($)?"Undo":"Check in"),11,dP)),l("button",{onClick:C=>E.$emit("remove-assignment",$),class:"btn btn-small btn-danger"}," Remove ",8,hP)])],2))),128)),S.value.length>0?(v(),m("div",fP,[l("label",null,"Assign to "+_(V(i).checkpoint),1),Ge(l("select",{"onUpdate:modelValue":A[0]||(A[0]=$=>I.value=$),class:"form-input",onChange:O},[l("option",pP,"Select a "+_(V(i).checkpoint)+"...",1),(v(!0),m(we,null,Pe(S.value,$=>(v(),m("option",{key:$.id,value:$.id},[Ve(_($.name),1),$.description?(v(),m(we,{key:0},[Ve(" - "+_($.description),1)],64)):D("",!0)],8,vP))),128))],544),[[vn,I.value]])])):D("",!0)])]))}},gP=Ye(mP,[["__scopeId","data-v-ac2d3b20"]]),yP={class:"marshal-checklist-view"},_P={key:0,class:"loading-state"},kP={key:1,class:"error-state"},bP={key:2,class:"empty-state"},wP={key:3,class:"checklist-items"},CP={class:"item-checkbox"},LP=["checked","disabled","onChange"],SP={class:"item-content"},xP={class:"item-header"},$P={class:"item-text-wrapper"},IP={class:"item-text"},TP={key:0,class:"item-context"},MP={class:"item-scope"},AP=["title"],EP={key:0,class:"completion-info"},PP={key:0,class:"pending-text"},DP={class:"completion-text"},OP={class:"completion-time"},RP={key:1,class:"uncomplete-info"},BP={key:2,class:"disabled-reason"},NP={__name:"MarshalChecklistView",props:{eventId:{type:String,required:!0},marshalId:{type:String,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=Lt(),a=e,c=o,u=P([]),d=P(!1),p=P(null),f=P(new Map),y=Y(()=>u.value.map(w=>{const k=f.value.get(w.itemId),M=k!==void 0?k.complete:w.isCompleted,G=k!==void 0&&k.complete!==w.isCompleted;return{...w,localIsCompleted:M,isModified:G}})),b=async()=>{if(!(!a.eventId||!a.marshalId)){d.value=!0,p.value=null;try{const w=await Ot.getMarshalChecklist(a.eventId,a.marshalId);if(u.value=w.data||[],a.modelValue&&a.modelValue.length>0){const k=new Map;a.modelValue.forEach(M=>{k.set(M.itemId,{complete:M.complete,contextType:M.contextType,contextId:M.contextId})}),f.value=k}}catch(w){console.error("Failed to load checklist:",w),p.value=w.response?.data?.message||"Failed to load checklist"}finally{d.value=!1}}},I=w=>{const k=f.value.get(w.itemId),M=k!==void 0?k.complete:w.isCompleted;f.value.set(w.itemId,{complete:!M,contextType:w.completionContextType,contextId:w.completionContextId}),T()},T=()=>{const w=[];for(const[k,M]of f.value.entries()){const G=u.value.find(ne=>ne.itemId===k);G&&M.complete!==G.isCompleted&&w.push({itemId:k,complete:M.complete,contextType:M.contextType,contextId:M.contextId})}c("update:modelValue",w),c("change",w)};t({resetLocalState:()=>{if(f.value=new Map,a.modelValue&&a.modelValue.length>0){const w=new Map;a.modelValue.forEach(k=>{w.set(k.itemId,{complete:k.complete,contextType:k.contextType,contextId:k.contextId})}),f.value=w}},loadChecklist:b});const O=w=>({Everyone:"Everyone",SpecificPeople:"Assigned to you",EveryoneInAreas:`Your ${s.value.areas}`,EveryoneAtCheckpoints:`Your ${s.value.checkpoints}`,OnePerCheckpoint:`One per ${s.value.checkpoint}`,OnePerArea:`One per ${s.value.area}`,EveryAreaLead:`${i.value.area} lead`,OneLeadPerArea:`One lead per ${s.value.area}`})[w.matchedScope]||w.matchedScope,E=w=>({Everyone:"This item is for everyone at the event",SpecificPeople:"This item is specifically assigned to this person",EveryoneInAreas:`This item is for everyone in certain ${s.value.areas}`,EveryoneAtCheckpoints:`This item is for everyone at certain ${s.value.checkpoints}`,OnePerCheckpoint:`One person at the ${s.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${s.value.area} needs to complete this`,EveryAreaLead:`This item is for ${s.value.area} leads only`,OneLeadPerArea:`One ${s.value.area} lead needs to complete this`})[w.matchedScope]||"",A=w=>w.completionContextType==="Checkpoint"||w.completionContextType==="Area"?"Already completed by someone else":"Cannot be completed",$=w=>{if(!w.completionContextType||!w.completionContextId)return null;if(w.completionContextType==="Checkpoint"){const k=a.locations.find(G=>G.id===w.completionContextId);if(!k)return null;const M=k.description?`${k.name} - ${k.description}`:k.name;return`at ${s.value.checkpoint} ${M}`}if(w.completionContextType==="Area"){const k=a.areas.find(M=>M.id===w.completionContextId);return k?`in ${s.value.area} ${k.name}`:null}return w.completionContextType==="Personal"?w.contextOwnerName?`for ${w.contextOwnerName}`:"assigned individually":null},C=w=>w?new Date(w).toLocaleString():"";return We(()=>[a.eventId,a.marshalId],()=>{b()},{immediate:!0}),(w,k)=>(v(),m("div",yP,[d.value?(v(),m("div",_P," Loading checklist... ")):p.value?(v(),m("div",kP,[l("p",null,_(p.value),1),l("button",{onClick:b,class:"btn btn-secondary btn-small"}," Retry ")])):u.value.length===0?(v(),m("div",bP,[...k[0]||(k[0]=[l("p",null,"No checklist items for this person.",-1)])])):(v(),m("div",wP,[(v(!0),m(we,null,Pe(y.value,M=>(v(),m("div",{key:`${M.itemId}_${M.completionContextType}_${M.completionContextId}`,class:_e(["checklist-item",{"item-completed":M.localIsCompleted,"item-modified":M.isModified}])},[l("div",CP,[l("input",{type:"checkbox",checked:M.localIsCompleted,disabled:!M.canBeCompletedByMe,onChange:G=>I(M)},null,40,LP)]),l("div",SP,[l("div",xP,[l("div",$P,[l("div",IP,_(M.text),1),$(M)?(v(),m("div",TP,_($(M)),1)):D("",!0)]),l("div",MP,[l("span",{class:"scope-pill",title:E(M)},_(O(M)),9,AP)])]),M.localIsCompleted?(v(),m("div",EP,[M.isModified&&!M.isCompleted?(v(),m("span",PP," Will be marked as completed (pending save) ")):(v(),m(we,{key:1},[l("span",DP," Completed by "+_(M.completedByActorName||"Unknown"),1),l("span",OP,_(C(M.completedAt)),1)],64))])):D("",!0),M.isModified&&M.isCompleted&&!M.localIsCompleted?(v(),m("div",RP,[...k[1]||(k[1]=[l("span",{class:"pending-text"},"Will be marked as incomplete (pending save)",-1)])])):D("",!0),!M.canBeCompletedByMe&&!M.localIsCompleted?(v(),m("div",BP,_(A(M)),1)):D("",!0)])],2))),128))]))]))}},FP=Ye(NP,[["__scopeId","data-v-25f2e028"]]),UP={class:"checklist-preview"},zP={class:"preview-actions"},HP={class:"preview-header"},VP={key:0,class:"add-item-form"},GP=["placeholder"],ZP=["disabled"],jP={key:1,class:"pending-items"},WP={class:"item-content"},qP={class:"item-header"},KP={class:"item-text"},YP={class:"item-scope"},JP=["onClick"],XP={key:2,class:"empty-state"},QP={key:0,class:"help-text"},e4={key:3,class:"checklist-items"},t4={class:"item-content"},n4={class:"item-header"},o4={class:"item-text"},s4={class:"item-scope"},i4=["title"],a4={key:0,class:"item-context"},r4={__name:"ChecklistPreview",props:{allChecklistItems:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=Lt(),i=e,s=t,a=P(!1),c=P(""),u=P([...i.modelValue]);We(()=>i.modelValue,A=>{u.value=[...A]},{deep:!0});const d=()=>{c.value.trim()&&(u.value.push({text:c.value.trim(),isNew:!0}),c.value="",a.value=!1,f())},p=A=>{u.value.splice(A,1),f()},f=()=>{s("update:modelValue",[...u.value]),s("change")},y=Y(()=>{const A=new Set;for(const $ of i.pendingLocationIds){const C=i.allLocations.find(w=>w.id===$);C&&(C.areaIds||C.AreaIds||[]).forEach(k=>A.add(k))}return[...A]}),b=A=>{const $=A.scope,C=A.itemType,w=A.ids||[];return $==="SpecificPeople"&&C==="Marshal"?w.includes("ALL_MARSHALS"):($==="EveryoneAtCheckpoints"||$==="OnePerCheckpoint")&&C==="Checkpoint"?w.includes("ALL_CHECKPOINTS")?!0:w.some(k=>i.pendingLocationIds.includes(k)):$==="OnePerCheckpoint"&&C==="Area"?w.includes("ALL_AREAS")?!0:w.some(k=>y.value.includes(k)):($==="EveryoneInAreas"||$==="OnePerArea"||$==="EveryAreaLead"||$==="OneLeadPerArea")&&C==="Area"?w.includes("ALL_AREAS")?!0:w.some(k=>y.value.includes(k)):!1},I=Y(()=>i.allChecklistItems.filter(A=>A.scopeConfigurations&&A.scopeConfigurations.length>0?A.scopeConfigurations.some($=>b($)):!1)),T=A=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,EveryoneInAreas:`All in ${o.value.areas}`,OnePerArea:`One per ${o.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${o.value.area}`})[A]||A,S=A=>{if(!A.scopeConfigurations||A.scopeConfigurations.length===0)return"Unknown";const $=A.scopeConfigurations.find(w=>b(w));if(!$)return T(A.scopeConfigurations[0].scope);const C=$.ids||[];return C.includes("ALL_MARSHALS")?"Everyone":C.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:C.includes("ALL_AREAS")?`All ${o.value.areas}`:T($.scope)},O=A=>{if(!A.scopeConfigurations||A.scopeConfigurations.length===0)return"";const $=A.scopeConfigurations.find(w=>b(w));return $&&{SpecificPeople:"This item is for everyone at the event",EveryoneAtCheckpoints:`This item is for everyone at specified ${o.value.checkpoints}`,OnePerCheckpoint:`One person at each ${o.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${o.value.areas}`,OnePerArea:`One person in each ${o.value.area} needs to complete this`,EveryAreaLead:`This item is for ${o.value.area} leads only`,OneLeadPerArea:`One ${o.value.area} lead needs to complete this`}[$.scope]||""},E=A=>{if(!A.scopeConfigurations||A.scopeConfigurations.length===0)return null;const $=A.scopeConfigurations.find(k=>b(k));if(!$)return null;const C=$.itemType,w=$.ids||[];if(w.includes("ALL_MARSHALS")||w.includes("ALL_CHECKPOINTS")||w.includes("ALL_AREAS"))return null;if(C==="Checkpoint"){const k=i.allLocations.filter(M=>w.includes(M.id)&&i.pendingLocationIds.includes(M.id)).map(M=>M.name);if(k.length>0)return`At: ${k.join(", ")}`}if(C==="Area"){const k=i.areas.filter(M=>w.includes(M.id)&&y.value.includes(M.id)).map(M=>M.name);if(k.length>0)return`In: ${k.join(", ")}`}return null};return(A,$)=>(v(),m("div",UP,[l("div",zP,[l("p",HP,_(e.isEditing?`Add new ${V(o).checklist} for this ${V(o).person}:`:`${V(o).checklists} that will apply to this ${V(o).person}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:$[0]||($[0]=C=>a.value=!a.value)},_(a.value?"Cancel":`+ Add ${V(o).checklist}`),1)]),a.value?(v(),m("div",VP,[Ge(l("input",{"onUpdate:modelValue":$[1]||($[1]=C=>c.value=C),type:"text",placeholder:`Enter ${V(o).checklist} text...`,class:"add-item-input",onKeyup:Qf(d,["enter"])},null,40,GP),[[at,c.value]]),l("button",{type:"button",class:"save-item-btn",disabled:!c.value.trim(),onClick:d}," Add ",8,ZP)])):D("",!0),u.value.length>0?(v(),m("div",jP,[(v(!0),m(we,null,Pe(u.value,(C,w)=>(v(),m("div",{key:`pending-${w}`,class:"checklist-item pending"},[$[3]||($[3]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",WP,[l("div",qP,[l("div",KP,_(C.text),1),l("div",YP,[$[2]||($[2]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:k=>p(w),title:"Remove"},"  ",8,JP)])])])]))),128))])):D("",!0),!e.isEditing&&I.value.length===0&&u.value.length===0?(v(),m("div",XP,[l("p",null,"No "+_(V(o).checklists)+" will apply based on the current "+_(V(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),m("p",QP," Assign "+_(V(o).checkpoints)+" to see relevant "+_(V(o).checklists)+". ",1)):D("",!0)])):D("",!0),!e.isEditing&&I.value.length>0?(v(),m("div",e4,[(v(!0),m(we,null,Pe(I.value,C=>(v(),m("div",{key:C.id,class:"checklist-item"},[$[4]||($[4]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",t4,[l("div",n4,[l("div",o4,_(C.text),1),l("div",s4,[l("span",{class:"scope-pill",title:O(C)},_(S(C)),9,i4)])]),E(C)?(v(),m("div",a4,_(E(C)),1)):D("",!0)])]))),128))])):D("",!0)]))}},l4=Ye(r4,[["__scopeId","data-v-1c92d629"]]),c4={class:"notes-preview"},u4={class:"preview-actions"},d4={class:"preview-header"},h4={key:0,class:"add-item-form"},f4={class:"add-form-fields"},p4=["disabled"],v4={key:1,class:"pending-items"},m4={class:"note-header"},g4={class:"note-title"},y4={class:"note-actions"},_4=["onClick"],k4={key:0,class:"note-content"},b4={key:2,class:"empty-state"},w4={key:0,class:"help-text"},C4={key:3,class:"notes-list"},L4={class:"note-header"},S4={class:"note-title"},x4=["title"],$4={key:0,class:"note-content"},I4={key:1,class:"note-context"},T4={__name:"NotesPreview",props:{allNotes:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=Lt(),i=e,s=t,a=P(!1),c=P(""),u=P(""),d=P([...i.modelValue]);We(()=>i.modelValue,$=>{d.value=[...$]},{deep:!0});const p=()=>{!c.value.trim()&&!u.value.trim()||(d.value.push({title:c.value.trim(),content:u.value.trim(),isNew:!0}),c.value="",u.value="",a.value=!1,y())},f=$=>{d.value.splice($,1),y()},y=()=>{s("update:modelValue",[...d.value]),s("change")},b=Y(()=>{const $=new Set;for(const C of i.pendingLocationIds){const w=i.allLocations.find(k=>k.id===C);w&&(w.areaIds||w.AreaIds||[]).forEach(M=>$.add(M))}return[...$]}),I=$=>{const C=$.scope,w=$.itemType,k=$.ids||[];return C==="SpecificPeople"&&w==="Marshal"?k.includes("ALL_MARSHALS"):C==="EveryoneAtCheckpoints"&&w==="Checkpoint"?k.includes("ALL_CHECKPOINTS")?!0:k.some(M=>i.pendingLocationIds.includes(M)):C==="EveryoneInAreas"&&w==="Area"?k.includes("ALL_AREAS")?!0:k.some(M=>b.value.includes(M)):!1},T=Y(()=>i.allNotes.filter($=>$.scopeConfigurations&&$.scopeConfigurations.length>0?$.scopeConfigurations.some(C=>I(C)):!1)),S=$=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[$]||$,O=$=>{if(!$.scopeConfigurations||$.scopeConfigurations.length===0)return"Unknown";const C=$.scopeConfigurations.find(k=>I(k));if(!C)return S($.scopeConfigurations[0].scope);const w=C.ids||[];return w.includes("ALL_MARSHALS")?"Everyone":w.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:w.includes("ALL_AREAS")?`All ${o.value.areas}`:S(C.scope)},E=$=>{if(!$.scopeConfigurations||$.scopeConfigurations.length===0)return"";const C=$.scopeConfigurations.find(k=>I(k));return C&&{SpecificPeople:"This note is for everyone at the event",EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[C.scope]||""},A=$=>{if(!$.scopeConfigurations||$.scopeConfigurations.length===0)return null;const C=$.scopeConfigurations.find(M=>I(M));if(!C)return null;const w=C.itemType,k=C.ids||[];if(k.includes("ALL_MARSHALS")||k.includes("ALL_CHECKPOINTS")||k.includes("ALL_AREAS"))return null;if(w==="Checkpoint"){const M=i.allLocations.filter(G=>k.includes(G.id)&&i.pendingLocationIds.includes(G.id)).map(G=>G.name);if(M.length>0)return`At: ${M.join(", ")}`}if(w==="Area"){const M=i.areas.filter(G=>k.includes(G.id)&&b.value.includes(G.id)).map(G=>G.name);if(M.length>0)return`In: ${M.join(", ")}`}return null};return($,C)=>(v(),m("div",c4,[l("div",u4,[l("p",d4,_(e.isEditing?`Add new note for this ${V(o).person}:`:`Notes that will be visible to this ${V(o).person}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:C[0]||(C[0]=w=>a.value=!a.value)},_(a.value?"Cancel":"+ Add note"),1)]),a.value?(v(),m("div",h4,[l("div",f4,[Ge(l("input",{"onUpdate:modelValue":C[1]||(C[1]=w=>c.value=w),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[at,c.value]]),Ge(l("textarea",{"onUpdate:modelValue":C[2]||(C[2]=w=>u.value=w),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[at,u.value]])]),l("button",{type:"button",class:"save-item-btn",disabled:!c.value.trim()&&!u.value.trim(),onClick:p}," Add ",8,p4)])):D("",!0),d.value.length>0?(v(),m("div",v4,[(v(!0),m(we,null,Pe(d.value,(w,k)=>(v(),m("div",{key:`pending-${k}`,class:"note-item pending"},[l("div",m4,[l("span",g4,_(w.title||"Untitled"),1),l("div",y4,[C[3]||(C[3]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:M=>f(k),title:"Remove"},"  ",8,_4)])]),w.content?(v(),m("div",k4,_(w.content),1)):D("",!0)]))),128))])):D("",!0),!e.isEditing&&T.value.length===0&&d.value.length===0?(v(),m("div",b4,[l("p",null,"No notes will be visible based on the current "+_(V(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),m("p",w4," Assign "+_(V(o).checkpoints)+" to see relevant notes. ",1)):D("",!0)])):D("",!0),!e.isEditing&&T.value.length>0?(v(),m("div",C4,[(v(!0),m(we,null,Pe(T.value,w=>(v(),m("div",{key:w.id,class:"note-item"},[l("div",L4,[l("span",S4,_(w.title||"Untitled"),1),l("span",{class:"scope-pill",title:E(w)},_(O(w)),9,x4)]),w.content?(v(),m("div",$4,_(w.content),1)):D("",!0),A(w)?(v(),m("div",I4,_(A(w)),1)):D("",!0)]))),128))])):D("",!0)]))}},M4=Ye(T4,[["__scopeId","data-v-dc8ac5e7"]]),A4={key:6,class:"tab-content incidents-tab"},E4={key:0,class:"incidents-list"},P4={key:1,class:"empty-state"},D4={class:"custom-footer"},O4={key:1},R4={__name:"EditMarshalModal",props:{show:{type:Boolean,default:!1},marshal:{type:Object,default:null},eventId:{type:String,required:!0},assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1},eventNotes:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},incidents:{type:Array,default:()=>[]}},emits:["close","save","delete","toggle-check-in","remove-assignment","assign-to-location","update:isDirty","select-incident"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Lt(),s=e,a=t,c=P("details"),u=P(null),d=P(null),p=P([]),f=P([]),y=P([]),b=P([]),I=P({name:"",email:"",phoneNumber:"",notes:""}),T=Y(()=>{const de=s.isEditing?`Edit ${i.value.person}`:`Create ${i.value.person}`,he=I.value.name?.trim();return he?`${de} - ${he}`:de}),S=Y(()=>{const de=[{value:"details",label:"Details",icon:"details"},{value:"checkpoints",label:o.value.checkpoints,icon:"checkpoint"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}];return s.incidents&&s.incidents.length>0&&de.push({value:"incidents",label:"Incidents",icon:"incidents"}),de}),O=Y(()=>S.value.findIndex(de=>de.value===c.value)),E=Y(()=>O.value===S.value.length-1),A=Y(()=>E.value?null:S.value[O.value+1]),$=Y(()=>E.value?`Create ${i.value.person}`:`Add ${A.value.label.toLowerCase()}...`),C=Y(()=>f.value.map(de=>de.locationId)),w=Y(()=>s.isEditing?s.assignments:f.value.map(de=>({id:`pending-${de.locationId}`,locationId:de.locationId,locationName:s.allLocations.find(he=>he.id===de.locationId)?.name||"Unknown",isPending:!0}))),k=Y(()=>{if(s.isEditing)return s.availableLocations;const de=f.value.map(he=>he.locationId);return s.allLocations.filter(he=>!de.includes(he.id))});We(()=>s.marshal,de=>{de?I.value={name:de.name||"",email:de.email||"",phoneNumber:de.phoneNumber||"",notes:de.notes||""}:I.value={name:"",email:"",phoneNumber:"",notes:""}},{immediate:!0,deep:!0}),We(()=>s.show,de=>{de&&(c.value="details",p.value=[],f.value=[],y.value=[],b.value=[],s.isEditing||(I.value={name:"",email:"",phoneNumber:"",notes:""}),u.value?.clearPendingChanges&&u.value.clearPendingChanges(),d.value?.resetLocalState&&d.value.resetLocalState())});const M=de=>{I.value=de},G=()=>{a("update:isDirty",!0)},ne=()=>{a("update:isDirty",!0)},ce=()=>{s.isEditing||E.value?K():c.value=A.value.value},K=()=>{const de={...I.value,checkInChanges:u.value?.getPendingChanges?.()||[],checklistChanges:p.value||[],pendingAssignments:s.isEditing?[]:f.value,pendingNewChecklistItems:y.value,pendingNewNotes:b.value};a("save",de)},se=()=>{a("delete")},me=de=>{!s.isEditing&&de.isPending?f.value=f.value.filter(he=>he.locationId!==de.locationId):a("remove-assignment",de)},Re=de=>{s.isEditing?a("assign-to-location",de):(f.value.push({locationId:de}),a("update:isDirty",!0))},Oe=()=>{a("close")};return(de,he)=>(v(),et(Dt,{show:e.show,title:T.value,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:Oe},{"tab-header":Qe(()=>[Ne(xu,{modelValue:c.value,"onUpdate:modelValue":he[0]||(he[0]=ve=>c.value=ve),tabs:S.value},null,8,["modelValue","tabs"])]),footer:Qe(()=>[l("div",D4,[e.isEditing?(v(),m("button",{key:0,type:"button",onClick:se,class:"btn btn-danger"}," Delete "+_(V(i).person),1)):(v(),m("div",O4)),l("button",{type:"button",onClick:ce,class:"btn btn-primary"},_(e.isEditing?"Save changes":$.value),1)])]),default:Qe(()=>[c.value==="details"?(v(),et(XE,{key:0,form:I.value,"event-id":e.eventId,"marshal-id":e.isEditing?e.marshal?.id:null,"onUpdate:form":M,onInput:G},null,8,["form","event-id","marshal-id"])):D("",!0),c.value==="checkpoints"?(v(),et(gP,{key:1,ref_key:"checkpointsTabRef",ref:u,assignments:w.value,"available-locations":k.value,"is-new-marshal":!e.isEditing,onInput:G,onRemoveAssignment:me,onAssignToLocation:Re},null,8,["assignments","available-locations","is-new-marshal"])):D("",!0),c.value==="checklists"&&e.isEditing?(v(),et(FP,{key:2,ref_key:"checklistTabRef",ref:d,modelValue:p.value,"onUpdate:modelValue":he[1]||(he[1]=ve=>p.value=ve),"event-id":e.eventId,"marshal-id":e.marshal.id,locations:e.allLocations,areas:e.areas,onChange:ne},null,8,["modelValue","event-id","marshal-id","locations","areas"])):D("",!0),c.value==="checklists"?(v(),et(l4,{key:3,modelValue:y.value,"onUpdate:modelValue":he[2]||(he[2]=ve=>y.value=ve),"all-checklist-items":e.allChecklistItems,"pending-location-ids":C.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:G},null,8,["modelValue","all-checklist-items","pending-location-ids","all-locations","areas","is-editing"])):D("",!0),c.value==="notes"&&e.isEditing?(v(),et(El,{key:4,"event-id":e.eventId,"marshal-id":e.marshal?.id,"all-notes":e.eventNotes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","marshal-id","all-notes","locations","areas","assignments"])):D("",!0),c.value==="notes"?(v(),et(M4,{key:5,modelValue:b.value,"onUpdate:modelValue":he[3]||(he[3]=ve=>b.value=ve),"all-notes":e.eventNotes,"pending-location-ids":C.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:G},null,8,["modelValue","all-notes","pending-location-ids","all-locations","areas","is-editing"])):D("",!0),c.value==="incidents"?(v(),m("div",A4,[e.incidents&&e.incidents.length>0?(v(),m("div",E4,[(v(!0),m(we,null,Pe(e.incidents,ve=>(v(),et(rr,{key:ve.incidentId,incident:ve,onClick:Te=>de.$emit("select-incident",ve)},null,8,["incident","onClick"]))),128))])):(v(),m("div",P4," No incidents for this "+_(V(i).person)+". ",1))])):D("",!0)]),_:1},8,["show","title","is-dirty"]))}},B4=Ye(R4,[["__scopeId","data-v-a74973c9"]]),N4={class:"locations-list"},F4={class:"conflict-actions"},U4={__name:"AssignmentConflictModal",props:{show:{type:Boolean,default:!1},conflictData:{type:Object,default:()=>({marshalName:"",locations:[]})}},emits:["close","choice"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Lt(),s=t,a=u=>{s("choice",u)},c=()=>{s("close")};return(u,d)=>(v(),et(Dt,{show:e.show,title:`${V(o).person} already assigned`,size:"medium","z-index":1100,onClose:c},{actions:Qe(()=>[l("div",F4,[l("button",{onClick:d[0]||(d[0]=p=>a("move")),class:"btn btn-primary btn-full"}," Move to this "+_(V(i).checkpoint)+" (remove from others) ",1),l("button",{onClick:d[1]||(d[1]=p=>a("both")),class:"btn btn-secondary btn-full"}," Assign to both (keep existing assignments) "),l("button",{onClick:d[2]||(d[2]=p=>a("choose-other")),class:"btn btn-secondary btn-full"}," Choose someone else "),l("button",{onClick:d[3]||(d[3]=p=>a("cancel")),class:"btn btn-secondary btn-full"}," Cancel ")])]),default:Qe(()=>[l("p",null,[l("strong",null,_(e.conflictData.marshalName),1),d[4]||(d[4]=Ve(" is currently assigned to: ",-1))]),l("ul",N4,[(v(!0),m(we,null,Pe(e.conflictData.locations,p=>(v(),m("li",{key:p},_(p),1))),128))]),d[5]||(d[5]=l("p",null,"What would you like to do?",-1))]),_:1},8,["show","title"]))}},z4=Ye(U4,[["__scopeId","data-v-b64e5b37"]]),H4={key:0,class:"assign-marshal-section"},V4={value:""},G4=["value"],Z4=["disabled"],j4={key:1,class:"assign-marshal-section create-mode"},W4={class:"form-group"},q4={class:"form-group"},K4={class:"form-group"},Y4={__name:"AssignMarshalModal",props:{show:{type:Boolean,default:!1},locationName:{type:String,default:""},marshals:{type:Array,default:()=>[]}},emits:["close","assign-existing","create-and-assign"],setup(e,{emit:t}){const{termsLower:o}=Lt(),i=e,s=t,a=P(!1),c=P(""),u=P({name:"",email:"",phoneNumber:""});We(()=>i.show,I=>{I||(a.value=!1,c.value="",u.value={name:"",email:"",phoneNumber:""})});const d=()=>{a.value=!0},p=()=>{c.value&&s("assign-existing",c.value)},f=()=>{u.value.name&&s("create-and-assign",{...u.value})},y=()=>{a.value=!1,u.value={name:"",email:"",phoneNumber:""}},b=()=>{s("close")};return(I,T)=>(v(),et(Dt,{show:e.show,title:a.value?`Create new ${V(o).person}`:`Assign ${V(o).person} to ${e.locationName}`,size:"medium",onClose:b},{actions:Qe(()=>[a.value?(v(),m(we,{key:0},[l("button",{onClick:y,class:"btn btn-secondary"}," Cancel "),l("button",{onClick:f,class:"btn btn-primary"}," Create & assign ")],64)):D("",!0)]),default:Qe(()=>[a.value?(v(),m("div",j4,[l("h3",null,"Create new "+_(V(o).person),1),l("div",W4,[T[5]||(T[5]=l("label",null,"Name *",-1)),Ge(l("input",{"onUpdate:modelValue":T[1]||(T[1]=S=>u.value.name=S),type:"text",required:"",class:"form-input"},null,512),[[at,u.value.name]])]),l("div",q4,[T[6]||(T[6]=l("label",null,"Email",-1)),Ge(l("input",{"onUpdate:modelValue":T[2]||(T[2]=S=>u.value.email=S),type:"email",class:"form-input"},null,512),[[at,u.value.email]])]),l("div",K4,[T[7]||(T[7]=l("label",null,"Phone",-1)),Ge(l("input",{"onUpdate:modelValue":T[3]||(T[3]=S=>u.value.phoneNumber=S),type:"tel",class:"form-input"},null,512),[[at,u.value.phoneNumber]])])])):(v(),m("div",H4,[l("h3",null,"Select existing "+_(V(o).person),1),Ge(l("select",{"onUpdate:modelValue":T[0]||(T[0]=S=>c.value=S),class:"form-input"},[l("option",V4,"Choose a "+_(V(o).person)+"...",1),(v(!0),m(we,null,Pe(e.marshals,S=>(v(),m("option",{key:S.id,value:S.id},[Ve(_(S.name)+" ",1),S.assignedLocationIds&&S.assignedLocationIds.length>0?(v(),m(we,{key:0},[Ve(" (assigned to "+_(S.assignedLocationIds.length)+" "+_(S.assignedLocationIds.length>1?V(o).checkpoints:V(o).checkpoint)+") ",1)],64)):D("",!0)],8,G4))),128))],512),[[vn,c.value]]),l("button",{onClick:p,class:"btn btn-primary btn-full",style:{"margin-top":"1rem"},disabled:!c.value}," Assign selected "+_(V(o).person),9,Z4),T[4]||(T[4]=l("div",{class:"divider"},"OR",-1)),l("button",{onClick:d,class:"btn btn-secondary btn-full"}," Create new "+_(V(o).person),1)]))]),_:1},8,["show","title"]))}},J4=Ye(Y4,[["__scopeId","data-v-f95e76a2"]]),X4={class:"shift-times-content"},Q4={class:"info-text"},e3={class:"time-delta-info"},t3={class:"delta-detail"},n3={class:"delta-detail"},o3={class:"delta-summary"},s3={class:"affected-checkpoints"},i3={class:"option-selection"},a3={class:"radio-option"},r3={class:"radio-option"},l3={__name:"ShiftCheckpointTimesModal",props:{show:{type:Boolean,default:!1},oldEventDate:{type:String,required:!0},newEventDate:{type:String,required:!0},affectedCheckpointsCount:{type:Number,default:0}},emits:["confirm","cancel"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Lt(),s=e,a=t,c=P("shift"),u=Y(()=>{const b=new Date(s.oldEventDate);return new Date(s.newEventDate)-b}),d=b=>new Date(b).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),p=b=>{const I=Math.abs(b),T=b>=0?"+":"-",S=Math.floor(I/(1e3*60*60*24)),O=Math.floor(I%(1e3*60*60*24)/(1e3*60*60)),E=Math.floor(I%(1e3*60*60)/(1e3*60)),A=[];return S>0&&A.push(`${S}d`),O>0&&A.push(`${O}h`),E>0&&A.push(`${E}m`),`${T}${A.join(" ")}`},f=()=>{a("confirm",{shouldShift:c.value==="shift",timeDelta:u.value})},y=()=>{a("cancel")};return(b,I)=>(v(),et(Dt,{show:e.show,title:`Shift ${V(o).checkpoint} Times?`,size:"medium",onClose:y},{actions:Qe(()=>[l("button",{type:"button",onClick:y,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:f,class:"btn btn-primary"},_(c.value==="shift"?"Shift Times":"Keep Times"),1)]),default:Qe(()=>[l("div",X4,[l("p",Q4," You've changed the event date/time. Some "+_(V(i).checkpoints)+" have custom times set. ",1),l("div",e3,[I[2]||(I[2]=l("strong",null,"Event time change:",-1)),l("div",t3," Old: "+_(d(e.oldEventDate)),1),l("div",n3," New: "+_(d(e.newEventDate)),1),l("div",o3," Delta: "+_(p(u.value)),1)]),l("p",s3,[l("strong",null,_(e.affectedCheckpointsCount)+" "+_(e.affectedCheckpointsCount===1?V(i).checkpoint:V(i).checkpoints),1),I[3]||(I[3]=Ve(" with custom times will be shifted by the same amount. ",-1))]),l("div",i3,[l("label",a3,[Ge(l("input",{"onUpdate:modelValue":I[0]||(I[0]=T=>c.value=T),type:"radio",value:"shift",name:"shift-option"},null,512),[[Rd,c.value]]),l("div",null,[l("strong",null,"Shift all "+_(V(i).checkpoint)+" times",1),I[4]||(I[4]=l("small",null,"Recommended: Maintains relative timing",-1))])]),l("label",r3,[Ge(l("input",{"onUpdate:modelValue":I[1]||(I[1]=T=>c.value=T),type:"radio",value:"keep",name:"shift-option"},null,512),[[Rd,c.value]]),l("div",null,[l("strong",null,"Keep "+_(V(i).checkpoint)+" times unchanged",1),l("small",null,_(V(o).checkpoint)+" times will stay at their current values",1)])])])])]),_:1},8,["show","title"]))}},c3=Ye(l3,[["__scopeId","data-v-0e706cff"]]),u3={key:0,class:"tab-content"},d3={class:"form-group"},h3=["disabled"],f3={class:"form-group"},p3={key:1,class:"tab-content"},v3={class:"boundary-section"},m3={class:"boundary-actions"},g3={key:2,class:"tab-content"},y3={class:"section-title"},_3={class:"contacts-actions"},k3={key:0,class:"area-contacts-list"},b3=["onClick"],w3={class:"contact-info"},C3={key:0,class:"contact-role-badge"},L3={key:1,class:"contact-details"},S3={key:0},x3={key:1},$3={key:3,class:"tab-content"},I3={class:"section-title"},T3={key:0,class:"empty-state"},M3={key:1,class:"checkpoints-list"},A3=["onClick"],E3={class:"checkpoint-header"},P3=["innerHTML"],D3={class:"checkpoint-name-section"},O3={key:0,class:"checkpoint-description"},R3={class:"checkpoint-stats"},B3={class:"checkpoint-details"},N3={class:"detail-row with-pills"},F3={class:"detail-label"},U3={class:"detail-value"},z3={key:0,class:"warning-text"},H3={key:0,class:"marshal-pills"},V3={class:"detail-row"},G3={class:"detail-value"},Z3={key:0,class:"detail-row"},j3={key:1,class:"detail-row"},W3={key:4,class:"placeholder-message"},q3={key:6,class:"placeholder-message"},K3={key:8,class:"placeholder-message"},Y3={key:9,class:"tab-content appearance-tab"},J3={class:"accordion-item"},X3=["innerHTML"],Q3={class:"accordion-title"},eD={class:"accordion-arrow"},tD={key:0,class:"accordion-content"},nD={class:"section-description"},oD={class:"color-picker"},sD=["title","onClick"],iD={class:"accordion-item"},aD=["innerHTML"],rD={class:"accordion-title"},lD={class:"accordion-arrow"},cD={key:0,class:"accordion-content"},uD={class:"section-description"},dD={class:"accordion-item"},hD={class:"accordion-title"},fD={class:"accordion-preview"},pD={class:"accordion-arrow"},vD={key:0,class:"accordion-content"},mD={class:"section-description"},gD={class:"form-group"},yD={value:""},_D=["value"],kD={class:"accordion-item"},bD={class:"accordion-title"},wD={class:"accordion-preview"},CD={class:"accordion-arrow"},LD={key:0,class:"accordion-content"},SD={class:"section-description"},xD={class:"form-group"},$D={value:""},ID=["value"],TD={class:"custom-footer"},MD={key:1},Mh="edit_area_accordion",AD={__name:"EditAreaModal",props:{show:{type:Boolean,default:!1},area:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["close","save","delete","draw-boundary","update:isDirty","select-checkpoint","add-area-contact","edit-contact"],setup(e,{emit:t}){const{terms:o,termsLower:i}=Lt(),s=()=>S.value.peopleTerm?S.value.peopleTerm:d.eventPeopleTerm||"Marshals",a=(F=!0)=>{const N=S.value.checkpointTerm||d.eventCheckpointTerm||"Checkpoints",W=s();return F?jp("checkpoint",N,W):wi("checkpoint",N,W)},c=(F=!0)=>a(F).toLowerCase(),u=F=>F.resolvedPeopleTerm?F.resolvedPeopleTerm:F.peopleTerm?F.peopleTerm:S.value.peopleTerm?S.value.peopleTerm:d.eventPeopleTerm||"Marshals",d=e,p=t,f=P("details"),y=P(null),b=P([]),I=P({}),T=P({}),S=P({name:"",description:"",color:Wr,displayOrder:0,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),O=()=>d.eventId?`${Mh}_${d.eventId}`:Mh,E=P({polygonColor:!1,iconStyle:!1,peopleTerm:!1,checkpointTerm:!1});on(()=>{const F=localStorage.getItem(O());if(F)try{const N=JSON.parse(F);E.value={...E.value,...N}}catch{}});const A=F=>{E.value[F]=!E.value[F],localStorage.setItem(O(),JSON.stringify(E.value))},$=Y(()=>`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <polygon points="4,8 7,3 14,2 20,5 22,12 19,18 12,21 5,19 2,14" fill="${S.value.color||Wr}" stroke="#fff" stroke-width="1.5" opacity="0.8"/>
  </svg>`),C=Y(()=>{const F=S.value.checkpointStyleType!=="default"||S.value.checkpointStyleBackgroundShape||S.value.checkpointStyleBackgroundColor||S.value.checkpointStyleBorderColor||S.value.checkpointStyleIconColor||S.value.checkpointStyleSize,N=d.eventDefaultStyleType!=="default"||d.eventDefaultStyleBackgroundShape||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||d.eventDefaultStyleBorderColor||d.eventDefaultStyleIconColor||d.eventDefaultStyleSize;if(!F&&!N)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="areaDefaultGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981"/>
          <stop offset="50%" style="stop-color:#F59E0B"/>
          <stop offset="100%" style="stop-color:#EF4444"/>
        </linearGradient>
      </defs>
      <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#areaDefaultGrad)" stroke="#fff" stroke-width="1.5"/>
    </svg>`;const W=S.value.checkpointStyleType&&S.value.checkpointStyleType!=="default"?S.value.checkpointStyleType:d.eventDefaultStyleType&&d.eventDefaultStyleType!=="default"?d.eventDefaultStyleType:"default",ge=S.value.checkpointStyleBackgroundShape||d.eventDefaultStyleBackgroundShape||"circle",Se=S.value.checkpointStyleBackgroundColor||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||"#667eea",Ce=S.value.checkpointStyleBorderColor||d.eventDefaultStyleBorderColor||"#ffffff",ze=S.value.checkpointStyleIconColor||d.eventDefaultStyleIconColor||"#ffffff",Fe=S.value.checkpointStyleSize||d.eventDefaultStyleSize||"100";return Xt({type:W!=="default"?W:ge,backgroundShape:ge,backgroundColor:Se,borderColor:Ce,iconColor:ze,size:Fe,outputSize:24})}),w=Y(()=>d.area&&d.area.id),k=Y(()=>[{value:"details",label:"Details",icon:"details"},{value:"boundary",label:"Boundary",icon:"area"},{value:"contacts",label:"Contacts",icon:"marshal"},{value:"checkpoints",label:a(),icon:"checkpoint"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}]),M=Y(()=>k.value.findIndex(F=>F.value===f.value)),G=Y(()=>M.value===k.value.length-1),ne=Y(()=>G.value?null:k.value[M.value+1]),ce=Y(()=>G.value?`Create ${i.value.area}`:`Add ${ne.value.label.toLowerCase()}...`),K=Y(()=>{if(!d.area||!d.area.id)return[];const F=d.checkpoints.filter(N=>N.areaIds&&N.areaIds.includes(d.area.id)).map(N=>N.id);return d.assignments.filter(N=>F.includes(N.locationId))}),se=Y(()=>!d.area||!d.area.id?[]:d.checkpoints.filter(F=>F.areaIds&&F.areaIds.includes(d.area.id))),me=Y(()=>{const F=[...se.value];return F.sort((N,W)=>{const ge=N.name.match(/^(\d+)/),Se=W.name.match(/^(\d+)/);if(ge&&Se){const Ce=parseInt(ge[1]),ze=parseInt(Se[1]);if(Ce!==ze)return Ce-ze}return N.name.localeCompare(W.name,void 0,{numeric:!0,sensitivity:"base"})}),F}),Re=Y(()=>!d.area||!d.area.id?[]:d.contacts.filter(F=>F.scopeConfigurations?F.scopeConfigurations.some(N=>N.scope==="EveryoneInAreas"&&N.itemType==="Area"?N.ids?.includes("ALL_AREAS")?!0:N.ids?.includes(d.area.id):!1):!1)),Oe=F=>d.assignments.filter(N=>N.locationId===F),de=F=>[...Oe(F)].sort((W,ge)=>(W.marshalName||"").localeCompare(ge.marshalName||"",void 0,{sensitivity:"base"})),he=F=>Oe(F.id).filter(W=>W.isCheckedIn).length,ve=F=>{const N=Oe(F.id);if(N.length===0)return"status-none";const W=N.filter(ge=>ge.isCheckedIn).length;return W===0?"status-none":W===N.length?"status-complete":"status-partial"},Te=F=>{const N=Oe(F.id),W=u(F).toLowerCase();if(N.length===0)return`No ${W}`;const ge=N.filter(Se=>Se.isCheckedIn).length;return ge===0?"Not checked in":ge===N.length?"Fully checked in":`Partially checked in (${ge}/${N.length})`},fe=F=>{const N=I.value[F];return!N||N.total===0?"":N.completed===N.total?"status-complete":N.completed===0?"status-none":"status-partial"},xe=F=>{const N=I.value[F];return N?N.total===0?"No tasks":N.completed===N.total?"All tasks completed":`${N.completed}/${N.total} completed`:""},Be=async F=>{if(!(I.value[F]||T.value[F])){T.value[F]=!0;try{const W=(await Ot.getCheckpointChecklist(d.eventId,F)).data||[];I.value[F]={total:W.length,completed:W.filter(ge=>ge.isCompleted).length}}catch(N){console.error("Failed to load checklist status for checkpoint:",F,N),I.value[F]={total:0,completed:0}}finally{T.value[F]=!1}}};We(()=>d.area,F=>{if(F){const N=F.polygon?typeof F.polygon=="string"?JSON.parse(F.polygon):F.polygon:[];S.value={name:F.name||"",description:F.description||"",color:F.color||Wr,displayOrder:F.displayOrder||0,isDefault:F.isDefault||!1,polygon:N,checkpointStyleType:F.checkpointStyleType||"default",checkpointStyleColor:F.checkpointStyleColor||"",checkpointStyleBackgroundShape:F.checkpointStyleBackgroundShape||"",checkpointStyleBackgroundColor:F.checkpointStyleBackgroundColor||"",checkpointStyleBorderColor:F.checkpointStyleBorderColor||"",checkpointStyleIconColor:F.checkpointStyleIconColor||"",checkpointStyleSize:F.checkpointStyleSize||"",checkpointStyleMapRotation:F.checkpointStyleMapRotation??"",peopleTerm:F.peopleTerm||"",checkpointTerm:F.checkpointTerm||""}}else S.value={name:"",description:"",color:xh(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}},{immediate:!0,deep:!0}),We(()=>d.show,F=>{F&&(f.value="details",b.value=[],I.value={},T.value={},w.value||(S.value={name:"",description:"",color:xh(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),y.value?.resetLocalState&&y.value.resetLocalState())}),We(f,F=>{F==="checkpoints"&&d.area&&d.area.id&&se.value.forEach(N=>{setTimeout(()=>Be(N.id),0)})});const re=()=>{p("update:isDirty",!0)},Ee=F=>{S.value.color=F,re()},Me=(F,N)=>{S.value[F]=N,re()},$e=()=>{p("draw-boundary",S.value)},ue=()=>{S.value.polygon=[],re()},ye=()=>{p("add-area-contact",d.area)},z=F=>F?F.replace(/([A-Z])/g," $1").replace(/^./,N=>N.toUpperCase()).trim():"",ee=F=>{b.value=F,re()},ie=()=>{w.value||G.value?B():f.value=ne.value.value},B=()=>{const F=d.area?{name:S.value.name,description:S.value.description,color:S.value.color,polygon:S.value.polygon.length>0?S.value.polygon:null,displayOrder:S.value.displayOrder,checkpointStyleType:S.value.checkpointStyleType,checkpointStyleColor:S.value.checkpointStyleColor,checkpointStyleBackgroundShape:S.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:S.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:S.value.checkpointStyleBorderColor,checkpointStyleIconColor:S.value.checkpointStyleIconColor,checkpointStyleSize:S.value.checkpointStyleSize,checkpointStyleMapRotation:S.value.checkpointStyleMapRotation!=null&&S.value.checkpointStyleMapRotation!==""?String(S.value.checkpointStyleMapRotation):null,peopleTerm:S.value.peopleTerm,checkpointTerm:S.value.checkpointTerm,checklistChanges:b.value||[]}:{name:S.value.name,description:S.value.description,color:S.value.color,polygon:S.value.polygon.length>0?S.value.polygon:null,checkpointStyleType:S.value.checkpointStyleType,checkpointStyleColor:S.value.checkpointStyleColor,checkpointStyleBackgroundShape:S.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:S.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:S.value.checkpointStyleBorderColor,checkpointStyleIconColor:S.value.checkpointStyleIconColor,checkpointStyleSize:S.value.checkpointStyleSize,checkpointStyleMapRotation:S.value.checkpointStyleMapRotation!=null&&S.value.checkpointStyleMapRotation!==""?String(S.value.checkpointStyleMapRotation):null,peopleTerm:S.value.peopleTerm,checkpointTerm:S.value.checkpointTerm};p("save",F)},j=()=>{p("delete",d.area.id)},X=()=>{p("close")},q=F=>{const N=F.resolvedStyleType||F.ResolvedStyleType,W=F.resolvedStyleBackgroundColor||F.ResolvedStyleBackgroundColor||F.resolvedStyleColor||F.ResolvedStyleColor,ge=F.resolvedStyleBorderColor||F.ResolvedStyleBorderColor,Se=F.resolvedStyleIconColor||F.ResolvedStyleIconColor,Ce=F.resolvedStyleBackgroundShape||F.ResolvedStyleBackgroundShape;return N&&N!=="default"||W||ge||Se||Ce&&Ce!=="circle"?Xt({type:N||"circle",backgroundShape:Ce||"circle",backgroundColor:W||"#667eea",borderColor:ge||"#ffffff",iconColor:Se||"#ffffff",size:"75",outputSize:20}):`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
    <circle cx="10" cy="10" r="8" fill="#667eea" stroke="#fff" stroke-width="1.5"/>
  </svg>`};return(F,N)=>(v(),et(Dt,{show:e.show,title:e.area&&e.area.id?`Edit ${V(i).area}: ${e.area.name}`:`Create new ${V(i).area}`,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:X},{"tab-header":Qe(()=>[Ne(xu,{modelValue:f.value,"onUpdate:modelValue":N[0]||(N[0]=W=>f.value=W),tabs:k.value},null,8,["modelValue","tabs"])]),footer:Qe(()=>[l("div",TD,[w.value&&!S.value.isDefault?(v(),m("button",{key:0,type:"button",onClick:j,class:"btn btn-danger"}," Delete "+_(V(i).area),1)):(v(),m("div",MD)),l("button",{type:"button",onClick:ie,class:"btn btn-primary"},_(w.value?"Save changes":ce.value),1)])]),default:Qe(()=>[f.value==="details"?(v(),m("div",u3,[l("form",{onSubmit:gt(B,["prevent"])},[l("div",d3,[N[18]||(N[18]=l("label",null,"Name *",-1)),Ge(l("input",{"onUpdate:modelValue":N[1]||(N[1]=W=>S.value.name=W),type:"text",required:"",class:"form-input",disabled:S.value.isDefault,onInput:re},null,40,h3),[[at,S.value.name]])]),l("div",f3,[N[19]||(N[19]=l("label",null,"Description",-1)),Ge(l("textarea",{"onUpdate:modelValue":N[2]||(N[2]=W=>S.value.description=W),class:"form-input",rows:"3",onInput:re},null,544),[[at,S.value.description]])])],32)])):D("",!0),f.value==="boundary"?(v(),m("div",p3,[l("div",v3,[N[20]||(N[20]=l("div",{class:"instructions-card"},[l("p",null,[l("strong",null,"Draw a polygon on the map to define this area's boundary")]),l("p",null,' Click "Draw on Map" to activate drawing mode. Click on the map to add vertices, and double-click to complete the polygon. ')],-1)),l("div",m3,[l("button",{onClick:$e,class:"btn btn-primary btn-full"}," Draw on Map "),S.value.polygon&&S.value.polygon.length>0?(v(),m("button",{key:0,onClick:ue,class:"btn btn-danger btn-full"}," Clear Boundary ")):D("",!0)])])])):D("",!0),f.value==="contacts"?(v(),m("div",g3,[l("h3",y3,_(V(o).area)+" contacts",1),l("div",_3,[l("button",{onClick:ye,class:"btn btn-primary btn-full"}," Add contact for this "+_(V(i).area),1)]),Re.value.length>0?(v(),m("div",k3,[l("h4",null,"Contacts visible in this "+_(V(i).area)+" ("+_(Re.value.length)+")",1),(v(!0),m(we,null,Pe(Re.value,W=>(v(),m("div",{key:W.contactId,class:"contact-item",onClick:ge=>F.$emit("edit-contact",W)},[l("div",w3,[l("strong",null,_(W.name),1),W.role?(v(),m("span",C3,_(z(W.role)),1)):D("",!0),W.phone||W.email?(v(),m("div",L3,[W.phone?(v(),m("span",S3,_(W.phone),1)):D("",!0),W.email?(v(),m("span",x3,_(W.email),1)):D("",!0)])):D("",!0)])],8,b3))),128))])):D("",!0)])):D("",!0),f.value==="checkpoints"&&w.value?(v(),m("div",$3,[l("h3",I3,_(a())+" in "+_(e.area?.name)+" ("+_(se.value.length)+")",1),se.value.length===0?(v(),m("div",T3,[l("p",null,"No "+_(c())+" in this "+_(V(i).area)+" yet.",1)])):(v(),m("div",M3,[(v(!0),m(we,null,Pe(me.value,W=>(v(),m("div",{key:W.id,class:"checkpoint-card",onClick:ge=>F.$emit("select-checkpoint",W)},[l("div",E3,[l("span",{class:"checkpoint-icon",innerHTML:q(W)},null,8,P3),l("div",D3,[l("h4",null,[Ve(_(W.name),1),W.description?(v(),m("span",O3," - "+_(W.description),1)):D("",!0)])]),l("div",R3,[l("div",{class:_e(["stat-badge",ve(W)])},_(Te(W)),3)])]),l("div",B3,[l("div",N3,[l("span",F3,_(u(W))+":",1),l("span",U3,[Ve(_(Oe(W.id).length)+" / "+_(W.requiredMarshals)+" ",1),Oe(W.id).length<W.requiredMarshals?(v(),m("span",z3," ("+_(W.requiredMarshals-Oe(W.id).length)+" needed) ",1)):D("",!0)]),Oe(W.id).length>0?(v(),m("div",H3,[(v(!0),m(we,null,Pe(de(W.id),ge=>(v(),m("span",{key:ge.id,class:_e(["marshal-pill",{"checked-in":ge.isCheckedIn}])},_(ge.marshalName),3))),128))])):D("",!0)]),l("div",V3,[N[21]||(N[21]=l("span",{class:"detail-label"},"Checked in:",-1)),l("span",G3,_(he(W))+" / "+_(Oe(W.id).length),1)]),I.value[W.id]?(v(),m("div",Z3,[N[22]||(N[22]=l("span",{class:"detail-label"},"Tasks:",-1)),l("span",{class:_e(["detail-value",fe(W.id)])},_(xe(W.id)),3)])):T.value[W.id]?(v(),m("div",j3,[...N[23]||(N[23]=[l("span",{class:"detail-label"},"Tasks:",-1),l("span",{class:"detail-value loading-text"},"Loading...",-1)])])):D("",!0)])],8,A3))),128))]))])):D("",!0),f.value==="checkpoints"&&!w.value?(v(),m("div",W3,[l("p",null,_(a())+" will be automatically assigned based on boundaries after the "+_(V(i).area)+" is created.",1)])):D("",!0),f.value==="checklists"&&w.value?(v(),et(tv,{key:5,ref_key:"checklistTabRef",ref:y,modelValue:b.value,"onUpdate:modelValue":N[3]||(N[3]=W=>b.value=W),"event-id":e.eventId,"area-id":e.area.id,locations:e.allLocations,areas:e.areas,assignments:K.value,onChange:ee},null,8,["modelValue","event-id","area-id","locations","areas","assignments"])):D("",!0),f.value==="checklists"&&!w.value?(v(),m("div",q3,[l("p",null,_(V(o).checklists)+" can be assigned after the "+_(V(i).area)+" is created.",1)])):D("",!0),f.value==="notes"&&w.value?(v(),et(El,{key:7,"event-id":e.eventId,"area-id":e.area?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","area-id","all-notes","locations","areas","assignments"])):D("",!0),f.value==="notes"&&!w.value?(v(),m("div",K3,[l("p",null,"Notes can be viewed after the "+_(V(i).area)+" is created.",1)])):D("",!0),f.value==="appearance"?(v(),m("div",Y3,[l("div",J3,[l("button",{type:"button",class:_e(["accordion-header",{expanded:E.value.polygonColor}]),onClick:N[4]||(N[4]=W=>A("polygonColor"))},[l("div",{class:"accordion-icon",innerHTML:$.value},null,8,X3),l("span",Q3,_(V(o).area)+" polygon colour",1),l("span",eD,_(E.value.polygonColor?"":""),1)],2),E.value.polygonColor?(v(),m("div",tD,[l("p",nD," Choose a colour for this "+_(V(i).area)+"'s boundary on the map. ",1),l("div",oD,[(v(!0),m(we,null,Pe(V(qn),W=>(v(),m("div",{key:W.hex,class:_e(["color-swatch",{selected:S.value.color===W.hex}]),style:ot({backgroundColor:W.hex}),title:W.name,onClick:ge=>Ee(W.hex)},null,14,sD))),128))])])):D("",!0)]),l("div",iD,[l("button",{type:"button",class:_e(["accordion-header",{expanded:E.value.iconStyle}]),onClick:N[5]||(N[5]=W=>A("iconStyle"))},[l("div",{class:"accordion-icon",innerHTML:C.value},null,8,aD),l("span",rD,_(a(!1))+" marker style",1),l("span",lD,_(E.value.iconStyle?"":""),1)],2),E.value.iconStyle?(v(),m("div",cD,[l("p",uD," Set a default marker style for all "+_(c())+" in this "+_(V(i).area)+". Individual "+_(c())+" can override this setting. ",1),Ne(Su,{"style-type":S.value.checkpointStyleType||"default","style-color":S.value.checkpointStyleColor||"","style-background-shape":S.value.checkpointStyleBackgroundShape||"","style-background-color":S.value.checkpointStyleBackgroundColor||"","style-border-color":S.value.checkpointStyleBorderColor||"","style-icon-color":S.value.checkpointStyleIconColor||"","style-size":S.value.checkpointStyleSize||"","style-map-rotation":S.value.checkpointStyleMapRotation??"","inherited-style-type":e.eventDefaultStyleType,"inherited-style-color":e.eventDefaultStyleColor,"inherited-background-shape":e.eventDefaultStyleBackgroundShape||"","inherited-background-color":e.eventDefaultStyleBackgroundColor||e.eventDefaultStyleColor||"","inherited-border-color":e.eventDefaultStyleBorderColor||"","inherited-icon-color":e.eventDefaultStyleIconColor||"","inherited-size":e.eventDefaultStyleSize||"","inherited-map-rotation":e.eventDefaultStyleMapRotation??"","default-label":"Event default","icon-label":"Marker style",level:"area","show-preview":!0,"onUpdate:styleType":N[6]||(N[6]=W=>Me("checkpointStyleType",W)),"onUpdate:styleColor":N[7]||(N[7]=W=>Me("checkpointStyleColor",W)),"onUpdate:styleBackgroundShape":N[8]||(N[8]=W=>Me("checkpointStyleBackgroundShape",W)),"onUpdate:styleBackgroundColor":N[9]||(N[9]=W=>Me("checkpointStyleBackgroundColor",W)),"onUpdate:styleBorderColor":N[10]||(N[10]=W=>Me("checkpointStyleBorderColor",W)),"onUpdate:styleIconColor":N[11]||(N[11]=W=>Me("checkpointStyleIconColor",W)),"onUpdate:styleSize":N[12]||(N[12]=W=>Me("checkpointStyleSize",W)),"onUpdate:styleMapRotation":N[13]||(N[13]=W=>Me("checkpointStyleMapRotation",W))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])])):D("",!0)]),l("div",dD,[l("button",{type:"button",class:_e(["accordion-header",{expanded:E.value.peopleTerm}]),onClick:N[14]||(N[14]=W=>A("peopleTerm"))},[N[24]||(N[24]=l("div",{class:"accordion-icon"},[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("circle",{cx:"12",cy:"8",r:"4",fill:"#6366F1"}),l("path",{d:"M4 20c0-4.4 3.6-8 8-8s8 3.6 8 8",fill:"#6366F1",opacity:"0.6"})])],-1)),l("span",hD,_(s())+" terminology",1),l("span",fD,_(S.value.peopleTerm||`${e.eventPeopleTerm} (event default)`),1),l("span",pD,_(E.value.peopleTerm?"":""),1)],2),E.value.peopleTerm?(v(),m("div",vD,[l("p",mD," Choose what "+_(s().toLowerCase())+" are called in this "+_(V(i).area)+". This will be inherited by "+_(c())+" unless they override it. ",1),l("div",gD,[N[25]||(N[25]=l("label",null,"What are people called?",-1)),Ge(l("select",{"onUpdate:modelValue":N[15]||(N[15]=W=>S.value.peopleTerm=W),class:"form-input",onChange:re},[l("option",yD,"Use event default ("+_(e.eventPeopleTerm)+")",1),(v(!0),m(we,null,Pe(V(_s).people,W=>(v(),m("option",{key:W,value:W},_(W),9,_D))),128))],544),[[vn,S.value.peopleTerm]])])])):D("",!0)]),l("div",kD,[l("button",{type:"button",class:_e(["accordion-header",{expanded:E.value.checkpointTerm}]),onClick:N[16]||(N[16]=W=>A("checkpointTerm"))},[N[26]||(N[26]=l("div",{class:"accordion-icon"},[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z",fill:"#10B981"}),l("circle",{cx:"12",cy:"9",r:"2.5",fill:"white"})])],-1)),l("span",bD,_(a(!1))+" terminology",1),l("span",wD,_(S.value.checkpointTerm?V(jc)(S.value.checkpointTerm,s()):`${e.eventCheckpointTerm} (event default)`),1),l("span",CD,_(E.value.checkpointTerm?"":""),1)],2),E.value.checkpointTerm?(v(),m("div",LD,[l("p",SD," Choose what "+_(c())+" are called in this "+_(V(i).area)+". ",1),l("div",xD,[l("label",null,"What are "+_(c())+" called?",1),Ge(l("select",{"onUpdate:modelValue":N[17]||(N[17]=W=>S.value.checkpointTerm=W),class:"form-input",onChange:re},[l("option",$D,"Use event default ("+_(e.eventCheckpointTerm)+")",1),(v(!0),m(we,null,Pe(V(_s).checkpoint,W=>(v(),m("option",{key:W,value:W},_(V(jc)(W,s())),9,ID))),128))],544),[[vn,S.value.checkpointTerm]])])])):D("",!0)])])):D("",!0)]),_:1},8,["show","title","is-dirty"]))}},ED=Ye(AD,[["__scopeId","data-v-094e8954"]]),PD=["innerHTML"],DD={__name:"InfoModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Information"},message:{type:String,required:!0},okText:{type:String,default:"OK"}},emits:["close"],setup(e,{emit:t}){const o=t,i=()=>{o("close")};return(s,a)=>(v(),et(Dt,{show:e.show,title:e.title,size:"small","z-index":2e3,onClose:i},{actions:Qe(()=>[l("button",{onClick:i,class:"btn btn-primary"},_(e.okText),1)]),default:Qe(()=>[l("div",{class:"info-content",innerHTML:e.message},null,8,PD)]),_:1},8,["show","title"]))}},Pl=Ye(DD,[["__scopeId","data-v-319bcdc8"]]),OD={class:"tab-headers"},RD={class:"tab-content"},BD={class:"form-group"},ND=["placeholder"],FD={key:0,class:"checkbox-label-inline create-separate-items"},UD={class:"tab-content"},zD={class:"custom-footer"},HD={__name:"EditChecklistItemModal",props:{show:{type:Boolean,default:!1},checklistItem:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=P(!1),a=P(""),c=P("details"),u=P({text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0}),d=Y(()=>!!o.checklistItem);We(()=>o.show,E=>{E&&(c.value=o.initialTab,o.checklistItem?u.value={text:o.checklistItem.text||"",scopeConfigurations:o.checklistItem.scopeConfigurations?JSON.parse(JSON.stringify(o.checklistItem.scopeConfigurations)):[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:o.checklistItem.displayOrder||0,isRequired:o.checklistItem.isRequired!==!1,visibleFrom:o.checklistItem.visibleFrom?p(o.checklistItem.visibleFrom):null,visibleUntil:o.checklistItem.visibleUntil?p(o.checklistItem.visibleUntil):null,mustCompleteBy:o.checklistItem.mustCompleteBy?p(o.checklistItem.mustCompleteBy):null,createSeparateItems:!1}:u.value={text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0},i("update:isDirty",!1))});const p=E=>{if(!E)return null;const A=new Date(E),$=A.getTimezoneOffset();return new Date(A.getTime()-$*60*1e3).toISOString().slice(0,16)},f=E=>E?new Date(E).toISOString():null,y=()=>{i("update:isDirty",!0)},b=()=>{i("close")},I=()=>{c.value="visibility"},T=E=>{a.value=E,s.value=!0},S=()=>{if(!u.value.text||!u.value.text.trim()){T("Please enter checklist item text");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){T("Please select at least one scope");return}if(!u.value.scopeConfigurations.some($=>!($.itemType!==null&&(!$.ids||$.ids.length===0)))){T("Please configure at least one scope with valid selections");return}const A={text:u.value.text,scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,isRequired:u.value.isRequired,visibleFrom:f(u.value.visibleFrom),visibleUntil:f(u.value.visibleUntil),mustCompleteBy:f(u.value.mustCompleteBy)};d.value||(A.createSeparateItems=u.value.createSeparateItems),i("save",A)},O=()=>{i("delete",o.checklistItem.itemId)};return(E,A)=>(v(),m(we,null,[Ne(Dt,{show:e.show,title:d.value?"Edit checklist item":"Create checklist item",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:b},{footer:Qe(()=>[l("div",zD,[d.value?(v(),m("button",{key:0,type:"button",onClick:O,class:"btn btn-danger"}," Delete ")):D("",!0),!d.value&&c.value==="details"?(v(),m("button",{key:1,type:"button",onClick:I,class:"btn btn-primary"}," Next ")):D("",!0),d.value||c.value==="visibility"?(v(),m("button",{key:2,type:"button",onClick:S,class:"btn btn-primary"},_(d.value?"Save changes":"Create"),1)):D("",!0)])]),default:Qe(()=>[l("div",OD,[l("button",{type:"button",class:_e(["tab-header",{active:c.value==="details"}]),onClick:A[0]||(A[0]=$=>c.value="details")}," Details ",2),l("button",{type:"button",class:_e(["tab-header",{active:c.value==="visibility"}]),onClick:A[1]||(A[1]=$=>c.value="visibility")}," Visibility ",2)]),l("form",{onSubmit:gt(S,["prevent"]),class:"checklist-form"},[Ge(l("div",RD,[l("div",BD,[A[7]||(A[7]=l("label",{for:"text"},"Checklist text: *",-1)),Ge(l("textarea",{id:"text","onUpdate:modelValue":A[2]||(A[2]=$=>u.value.text=$),onInput:y,required:"",rows:"3",placeholder:u.value.createSeparateItems?"Enter checklist items, one per line...":"Enter the checklist item text..."},null,40,ND),[[at,u.value.text]]),d.value?D("",!0):(v(),m("label",FD,[Ge(l("input",{type:"checkbox","onUpdate:modelValue":A[3]||(A[3]=$=>u.value.createSeparateItems=$),onChange:y},null,544),[[ys,u.value.createSeparateItems]]),A[6]||(A[6]=l("span",null,"Each line creates a new item",-1))]))])],512),[[ti,c.value==="details"]]),Ge(l("div",UD,[Ne(Al,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":A[4]||(A[4]=$=>u.value.scopeConfigurations=$),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":d.value,onUserChanged:y},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ti,c.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ne(Pl,{show:s.value,title:"Validation error",message:a.value,onClose:A[5]||(A[5]=$=>s.value=!1)},null,8,["show","message"])],64))}},VD=Ye(HD,[["__scopeId","data-v-bb89c7c7"]]),GD={class:"tab-headers"},ZD={class:"tab-content"},jD={class:"form-group"},WD={class:"form-group"},qD={class:"form-row"},KD={class:"form-group"},YD={class:"form-group"},JD={class:"form-row"},XD={class:"form-group"},QD={class:"form-group checkbox-group-inline"},e6={class:"checkbox-label-inline"},t6={class:"tab-content"},n6={class:"custom-footer"},o6={__name:"EditNoteModal",props:{show:{type:Boolean,default:!1},note:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=P(!1),a=P(""),c=P("details"),u=P({title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1}),d=Y(()=>!!o.note);We(()=>o.show,S=>{S&&(c.value=o.initialTab,o.note?u.value={title:o.note.title||"",content:o.note.content||"",scopeConfigurations:o.note.scopeConfigurations?JSON.parse(JSON.stringify(o.note.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:o.note.displayOrder||0,priority:o.note.priority||"Normal",category:o.note.category||"",isPinned:o.note.isPinned||!1}:u.value={title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1},i("update:isDirty",!1))});const p=()=>{i("update:isDirty",!0)},f=()=>{i("close")},y=()=>{c.value="visibility"},b=S=>{a.value=S,s.value=!0},I=()=>{if(!u.value.title||!u.value.title.trim()){b("Please enter a note title");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){b("Please select at least one visibility scope");return}if(!u.value.scopeConfigurations.some(E=>!(E.itemType!==null&&(!E.ids||E.ids.length===0)))){b("Please configure at least one scope with valid selections");return}const O={title:u.value.title.trim(),content:u.value.content||"",scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,priority:u.value.priority||"Normal",category:u.value.category?.trim()||null,isPinned:u.value.isPinned||!1};i("save",O)},T=()=>{i("delete",o.note.noteId)};return(S,O)=>(v(),m(we,null,[Ne(Dt,{show:e.show,title:d.value?"Edit note":"Create note",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:f},{footer:Qe(()=>[l("div",n6,[d.value?(v(),m("button",{key:0,type:"button",onClick:T,class:"btn btn-danger"}," Delete ")):D("",!0),!d.value&&c.value==="details"?(v(),m("button",{key:1,type:"button",onClick:y,class:"btn btn-primary"}," Next ")):D("",!0),d.value||c.value==="visibility"?(v(),m("button",{key:2,type:"button",onClick:I,class:"btn btn-primary"},_(d.value?"Save changes":"Create"),1)):D("",!0)])]),default:Qe(()=>[l("div",GD,[l("button",{type:"button",class:_e(["tab-header",{active:c.value==="details"}]),onClick:O[0]||(O[0]=E=>c.value="details")}," Details ",2),l("button",{type:"button",class:_e(["tab-header",{active:c.value==="visibility"}]),onClick:O[1]||(O[1]=E=>c.value="visibility")}," Visibility ",2)]),l("form",{onSubmit:gt(I,["prevent"]),class:"note-form"},[Ge(l("div",ZD,[l("div",jD,[O[10]||(O[10]=l("label",{for:"title"},"Title: *",-1)),Ge(l("input",{id:"title","onUpdate:modelValue":O[2]||(O[2]=E=>u.value.title=E),type:"text",onInput:p,required:"",placeholder:"Enter note title..."},null,544),[[at,u.value.title]])]),l("div",WD,[O[11]||(O[11]=l("label",{for:"content"},"Content:",-1)),Ge(l("textarea",{id:"content","onUpdate:modelValue":O[3]||(O[3]=E=>u.value.content=E),onInput:p,rows:"6",placeholder:"Enter note content (supports markdown)..."},null,544),[[at,u.value.content]])]),l("div",qD,[l("div",KD,[O[13]||(O[13]=l("label",{for:"priority"},"Priority:",-1)),Ge(l("select",{id:"priority","onUpdate:modelValue":O[4]||(O[4]=E=>u.value.priority=E),onChange:p},[...O[12]||(O[12]=[l("option",{value:"Emergency"},"Emergency",-1),l("option",{value:"Urgent"},"Urgent",-1),l("option",{value:"High"},"High",-1),l("option",{value:"Normal"},"Normal",-1),l("option",{value:"Low"},"Low",-1)])],544),[[vn,u.value.priority]])]),l("div",YD,[O[14]||(O[14]=l("label",{for:"category"},"Category:",-1)),Ge(l("input",{id:"category","onUpdate:modelValue":O[5]||(O[5]=E=>u.value.category=E),type:"text",onInput:p,placeholder:"e.g., Safety, Logistics..."},null,544),[[at,u.value.category]])])]),l("div",JD,[l("div",XD,[O[15]||(O[15]=l("label",{for:"displayOrder"},"Display order:",-1)),Ge(l("input",{id:"displayOrder","onUpdate:modelValue":O[6]||(O[6]=E=>u.value.displayOrder=E),type:"number",onInput:p,min:"0"},null,544),[[at,u.value.displayOrder,void 0,{number:!0}]]),O[16]||(O[16]=l("span",{class:"help-text"},"Lower numbers appear first",-1))]),l("div",QD,[l("label",e6,[Ge(l("input",{type:"checkbox","onUpdate:modelValue":O[7]||(O[7]=E=>u.value.isPinned=E),onChange:p},null,544),[[ys,u.value.isPinned]]),O[17]||(O[17]=l("span",null,"Pin to top",-1))]),O[18]||(O[18]=l("span",{class:"help-text"},"Pinned notes always appear at the top",-1))])])],512),[[ti,c.value==="details"]]),Ge(l("div",t6,[Ne(Al,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":O[8]||(O[8]=E=>u.value.scopeConfigurations=E),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":d.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this note?",onUserChanged:p},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ti,c.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ne(Pl,{show:s.value,title:"Validation error",message:a.value,onClose:O[9]||(O[9]=E=>s.value=!1)},null,8,["show","message"])],64))}},s6=Ye(o6,[["__scopeId","data-v-1a34c03e"]]),i6={class:"incident-detail-header"},a6={class:"header-title-row"},r6={class:"modal-title"},l6={class:"header-badges"},c6=["disabled"],u6={key:0,class:"status-dropdown-menu"},d6=["onClick","disabled"],h6={key:0,class:"incident-detail-content"},f6={class:"accordion-section"},p6={class:"accordion-arrow"},v6={key:0,class:"accordion-content"},m6={class:"description-text"},g6={class:"accordion-section"},y6={class:"accordion-arrow"},_6={key:0,class:"accordion-content"},k6={class:"info-grid"},b6={class:"info-item"},w6={class:"info-value"},C6={class:"info-item"},L6={class:"info-value"},S6={key:0,class:"info-item"},x6={class:"info-value"},$6={key:1,class:"info-item"},I6={class:"info-value"},T6={key:2,class:"info-item"},M6={class:"info-value"},A6={key:0,class:"incident-map-container"},E6={class:"accordion-section"},P6={class:"accordion-preview"},D6={class:"accordion-arrow"},O6={key:0,class:"accordion-content"},R6={class:"reporter-info"},B6={class:"reporter-name"},N6={key:0,class:"accordion-section"},F6={class:"accordion-preview"},U6={class:"accordion-arrow"},z6={key:0,class:"accordion-content"},H6={class:"marshals-list"},V6={class:"marshal-name"},G6={key:0,class:"checkin-badge success"},Z6={key:1,class:"checkin-badge not-checked-in"},j6={class:"accordion-section"},W6={key:0,class:"accordion-preview"},q6={class:"accordion-arrow"},K6={key:0,class:"accordion-content"},Y6={key:0,class:"notes-timeline"},J6={class:"note-header"},X6={class:"note-author"},Q6={class:"note-time"},eO={key:0,class:"note-status-change"},tO={key:1,class:"note-text"},nO={key:1,class:"no-notes"},oO={__name:"IncidentDetailModal",props:{show:{type:Boolean,required:!0},incident:{type:Object,default:null},canManage:{type:Boolean,default:!1},route:{type:Array,default:()=>[]},checkpoints:{type:Array,default:()=>[]}},emits:["close","status-change","open-add-note"],setup(e,{emit:t}){const o=e,i=t,s=P(!1),a=P(!1),c=P(null),u=P({description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1});We(()=>o.show,G=>{G&&(u.value={description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1},a.value=!1)});const d=G=>{c.value&&!c.value.contains(G.target)&&(a.value=!1)};We(a,G=>{G?document.addEventListener("click",d):document.removeEventListener("click",d)});const p=()=>{a.value=!a.value},f=G=>{o.incident?.status!==G&&(a.value=!1,M(G))},y=G=>{const ne=u.value[G];Object.keys(u.value).forEach(ce=>{u.value[ce]=!1}),ne||(u.value[G]=!0)},b=Y(()=>o.incident?.latitude!=null&&o.incident?.longitude!=null),I=Y(()=>b.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),T=Y(()=>b.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),S=Y(()=>{if(!o.incident)return"Incident Details";if(o.incident.title)return o.incident.title;const G=o.incident.description||"";return G.length<=50?G:G.substring(0,47)+"..."}),O=Y(()=>[...o.incident?.context?.marshalsPresentAtCheckpoint||[]].sort((ne,ce)=>(ne.name||"").localeCompare(ce.name||"",void 0,{sensitivity:"base"}))),E=[{value:"open",label:"Open"},{value:"acknowledged",label:"Acknowledged"},{value:"in_progress",label:"In Progress"},{value:"resolved",label:"Resolved"},{value:"closed",label:"Closed"}],A=G=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[G]||G,$=G=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[G]||G,C=G=>{if(!G)return"";let ne=G.name||"";if(G.description){const ce=G.description,K=40,se=ce.length>K?ce.substring(0,K-3)+"...":ce;ne+=` - ${se}`}return ne},w=G=>G?new Date(G).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",k=G=>{if(!G)return"";const ne=new Date(G),K=new Date-ne,se=Math.floor(K/6e4),me=Math.floor(K/36e5),Re=Math.floor(K/864e5);return se<1?"just now":se<60?`${se}m ago`:me<24?`${me}h ago`:Re<7?`${Re}d ago`:ne.toLocaleDateString()},M=async G=>{if(o.incident?.status!==G){s.value=!0;try{i("status-change",{incidentId:o.incident.incidentId,status:G})}finally{s.value=!1}}};return(G,ne)=>(v(),et(Dt,{show:e.show,title:S.value,size:"large",onClose:ne[7]||(ne[7]=ce=>G.$emit("close"))},{header:Qe(()=>[l("div",i6,[l("div",a6,[l("span",{class:_e(["severity-indicator",e.incident?.severity])},null,2),l("h2",r6,_(S.value),1)]),l("div",l6,[l("span",{class:_e(["severity-badge",e.incident?.severity])},_(A(e.incident?.severity)),3),e.canManage?(v(),m("div",{key:0,class:"status-dropdown-container",ref_key:"statusDropdownRef",ref:c},[l("button",{type:"button",class:_e(["status-badge status-dropdown-trigger",e.incident?.status]),onClick:p,disabled:s.value},[Ve(_($(e.incident?.status))+" ",1),ne[8]||(ne[8]=l("span",{class:"dropdown-arrow"},"",-1))],10,c6),a.value?(v(),m("div",u6,[(v(),m(we,null,Pe(E,ce=>l("button",{key:ce.value,type:"button",class:_e(["status-dropdown-item",{active:e.incident?.status===ce.value}]),onClick:K=>f(ce.value),disabled:e.incident?.status===ce.value},[l("span",{class:_e(["status-dot",ce.value])},null,2),Ve(" "+_(ce.label),1)],10,d6)),64))])):D("",!0)],512)):(v(),m("span",{key:1,class:_e(["status-badge",e.incident?.status])},_($(e.incident?.status)),3))])])]),footer:Qe(()=>[l("button",{class:"btn btn-secondary",onClick:ne[6]||(ne[6]=ce=>G.$emit("close"))},"Close")]),default:Qe(()=>[e.incident?(v(),m("div",h6,[l("div",f6,[l("button",{type:"button",class:_e(["accordion-header",{expanded:u.value.description}]),onClick:ne[0]||(ne[0]=ce=>y("description"))},[ne[9]||(ne[9]=l("span",{class:"accordion-title"},"Description",-1)),l("span",p6,_(u.value.description?"":""),1)],2),u.value.description?(v(),m("div",v6,[l("p",m6,_(e.incident.description),1)])):D("",!0)]),l("div",g6,[l("button",{type:"button",class:_e(["accordion-header",{expanded:u.value.timeLocation}]),onClick:ne[1]||(ne[1]=ce=>y("timeLocation"))},[ne[10]||(ne[10]=l("span",{class:"accordion-title"},"Time & location",-1)),l("span",y6,_(u.value.timeLocation?"":""),1)],2),u.value.timeLocation?(v(),m("div",_6,[l("div",k6,[l("div",b6,[ne[11]||(ne[11]=l("span",{class:"info-label"},"Incident time",-1)),l("span",w6,_(w(e.incident.incidentTime)),1)]),l("div",C6,[ne[12]||(ne[12]=l("span",{class:"info-label"},"Reported at",-1)),l("span",L6,_(w(e.incident.createdAt)),1)]),e.incident.context?.checkpoint?(v(),m("div",S6,[ne[13]||(ne[13]=l("span",{class:"info-label"},"Checkpoint",-1)),l("span",x6,_(C(e.incident.context.checkpoint)),1)])):D("",!0),e.incident.area?(v(),m("div",$6,[ne[14]||(ne[14]=l("span",{class:"info-label"},"Area",-1)),l("span",I6,_(e.incident.area.areaName),1)])):D("",!0),b.value?(v(),m("div",T6,[ne[15]||(ne[15]=l("span",{class:"info-label"},"GPS location",-1)),l("span",M6,_(e.incident.latitude.toFixed(6))+", "+_(e.incident.longitude.toFixed(6)),1)])):D("",!0)]),b.value?(v(),m("div",A6,[Ne(ws,{locations:e.checkpoints,route:e.route,center:I.value,zoom:15,"user-location":T.value,class:"incident-location-map"},null,8,["locations","route","center","user-location"])])):D("",!0)])):D("",!0)]),l("div",E6,[l("button",{type:"button",class:_e(["accordion-header",{expanded:u.value.reporter}]),onClick:ne[2]||(ne[2]=ce=>y("reporter"))},[ne[16]||(ne[16]=l("span",{class:"accordion-title"},"Reported by",-1)),l("span",P6,_(e.incident.reportedBy?.name||"Unknown"),1),l("span",D6,_(u.value.reporter?"":""),1)],2),u.value.reporter?(v(),m("div",O6,[l("div",R6,[l("span",B6,_(e.incident.reportedBy?.name||"Unknown"),1)])])):D("",!0)]),O.value.length?(v(),m("div",N6,[l("button",{type:"button",class:_e(["accordion-header",{expanded:u.value.marshals}]),onClick:ne[3]||(ne[3]=ce=>y("marshals"))},[ne[17]||(ne[17]=l("span",{class:"accordion-title"},"Marshals at checkpoint",-1)),l("span",F6,_(O.value.length),1),l("span",U6,_(u.value.marshals?"":""),1)],2),u.value.marshals?(v(),m("div",z6,[l("div",H6,[(v(!0),m(we,null,Pe(O.value,ce=>(v(),m("div",{key:ce.marshalId,class:_e(["marshal-item",{"checked-in":ce.wasCheckedIn}])},[l("span",V6,_(ce.name),1),ce.wasCheckedIn?(v(),m("span",G6," Checked in "+_(k(ce.checkInTime)),1)):(v(),m("span",Z6," Not checked in "))],2))),128))])])):D("",!0)])):D("",!0),l("div",j6,[l("button",{type:"button",class:_e(["accordion-header",{expanded:u.value.notes}]),onClick:ne[4]||(ne[4]=ce=>y("notes"))},[ne[18]||(ne[18]=l("span",{class:"accordion-title"},"Updates",-1)),e.incident.updates?.length?(v(),m("span",W6,_(e.incident.updates.length),1)):D("",!0),l("span",q6,_(u.value.notes?"":""),1)],2),u.value.notes?(v(),m("div",K6,[e.incident.updates?.length?(v(),m("div",Y6,[(v(!0),m(we,null,Pe(e.incident.updates,(ce,K)=>(v(),m("div",{key:K,class:"note-item"},[l("div",J6,[l("span",X6,_(ce.authorName||"System"),1),l("span",Q6,_(k(ce.timestamp)),1)]),ce.statusChange?(v(),m("div",eO,[ne[19]||(ne[19]=Ve(" Status changed to ",-1)),l("span",{class:_e(["status-badge",ce.statusChange])},_($(ce.statusChange)),3)])):ce.note?(v(),m("p",tO,_(ce.note),1)):D("",!0)]))),128))])):(v(),m("div",nO," No updates yet. ")),l("button",{type:"button",class:"btn btn-primary add-note-btn",onClick:ne[5]||(ne[5]=ce=>G.$emit("open-add-note"))}," Add update ")])):D("",!0)])])):D("",!0)]),_:1},8,["show","title"]))}},$u=Ye(oO,[["__scopeId","data-v-ae741167"]]),sO={class:"form-group"},iO={class:"form-group"},aO={class:"form-row"},rO={class:"form-group form-group-half"},lO=["value"],cO={class:"form-group form-group-half"},uO={key:0,class:"form-group"},dO=["value"],hO={key:1,class:"form-group"},fO={class:"checkpoint-toggle"},pO={class:"checkbox-label"},vO={class:"checkpoint-name"},mO={key:0,class:"checkpoint-description"},gO={class:"form-group"},yO={class:"location-options"},_O={class:"location-buttons"},kO={key:0,class:"location-status"},bO={key:0,class:"location-getting"},wO={key:1,class:"location-display"},CO={key:0,class:"location-accuracy"},LO={key:2,class:"location-error"},SO={key:1,class:"map-picker-container"},xO={key:0,class:"map-picker-hint"},$O={key:2,class:"location-display"},IO={key:2,class:"error-message"},TO={class:"modal-actions"},MO=["disabled"],AO={__name:"ReportIncidentModal",props:{show:{type:Boolean,required:!0},eventId:{type:String,required:!0},checkpoint:{type:Object,default:null},initialLocation:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]}},emits:["close","submit"],setup(e,{emit:t}){const o=e,i=t,s=P({title:"",description:"",severity:"medium",incidentTime:""}),a=P(""),c=P(!0),u=P("none"),d=P(!1),p=P(null),f=P(null),y=P(null),b=P(!1),I=P(!1),T=P(null),S=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],O=()=>{const K=new Date,se=K.getFullYear(),me=String(K.getMonth()+1).padStart(2,"0"),Re=String(K.getDate()).padStart(2,"0"),Oe=String(K.getHours()).padStart(2,"0"),de=String(K.getMinutes()).padStart(2,"0");return`${se}-${me}-${Re}T${Oe}:${de}`},E=K=>K?new Date(K).toISOString():null,A=Y(()=>o.checkpoints||[]),$=Y(()=>{if(p.value?.latitude!=null)return{lat:p.value.latitude,lng:p.value.longitude};if(a.value){const K=A.value.find(se=>se.id===a.value);if(K?.latitude!=null)return{lat:K.latitude,lng:K.longitude}}if(o.initialLocation?.latitude!=null)return{lat:o.initialLocation.latitude,lng:o.initialLocation.longitude};if(o.checkpoint?.latitude!=null)return{lat:o.checkpoint.latitude,lng:o.checkpoint.longitude};if(A.value.length>0){const K=A.value[0];if(K.latitude!=null)return{lat:K.latitude,lng:K.longitude}}if(o.route?.length>0){const K=o.route[0];if(K?.lat!=null)return{lat:K.lat,lng:K.lng}}return{lat:-33.9,lng:151.2}}),C=Y(()=>s.value.description.trim()!==""),w=Y(()=>s.value.description.trim()!=="");We(()=>o.show,K=>{K&&(s.value={title:"",description:"",severity:"medium",incidentTime:O()},a.value="",c.value=!0,I.value=!1,T.value=null,y.value=null,p.value=null,f.value=null,o.initialLocation&&o.initialLocation.latitude!=null?(p.value={latitude:o.initialLocation.latitude,longitude:o.initialLocation.longitude},f.value=o.initialLocation.accuracy,u.value="gps",d.value=!1):(u.value="none",d.value=!1),o.checkpoint&&(a.value=o.checkpoint.locationId||o.checkpoint.id||""))});const k=K=>{y.value=null,K==="map"?u.value==="map"?d.value=!d.value:(u.value="map",d.value=!0,f.value=null):K==="gps"?(u.value="gps",d.value=!1,G()):(u.value="none",d.value=!1,p.value=null,f.value=null)},M=K=>{p.value={latitude:K.lat,longitude:K.lng},f.value=null,d.value=!1},G=()=>{if(o.initialLocation&&o.initialLocation.latitude!=null){p.value={latitude:o.initialLocation.latitude,longitude:o.initialLocation.longitude},f.value=o.initialLocation.accuracy;return}if(!navigator.geolocation){y.value="GPS is not available on this device.";return}b.value=!0,navigator.geolocation.getCurrentPosition(K=>{p.value={latitude:K.coords.latitude,longitude:K.coords.longitude},f.value=K.coords.accuracy,b.value=!1},K=>{y.value="Unable to get your location.",b.value=!1},{enableHighAccuracy:!0,timeout:1e4})},ne=async()=>{if(!(!w.value||I.value)){I.value=!0,T.value=null;try{const K=(u.value==="gps"||u.value==="map")&&p.value;let se=null,me=!1;A.value.length>0?a.value?se=a.value:me=!0:o.checkpoint&&(c.value?se=o.checkpoint.locationId||o.checkpoint.id||null:me=!0);const Re={title:s.value.title.trim()||null,description:s.value.description.trim(),severity:s.value.severity,incidentTime:E(s.value.incidentTime),latitude:K?p.value.latitude:null,longitude:K?p.value.longitude:null,checkpointId:se,skipCheckpointAutoAssign:me};i("submit",Re)}catch(K){T.value=K.message||"Failed to report incident. Please try again.",I.value=!1}}},ce=()=>{i("close")};return(K,se)=>(v(),et(Dt,{show:e.show,title:"Report Incident",size:"medium","confirm-on-close":!0,"is-dirty":C.value,onClose:ce},{footer:Qe(()=>[l("div",TO,[l("button",{type:"button",class:"btn btn-secondary",onClick:ce}," Cancel "),l("button",{type:"button",class:"btn btn-primary",onClick:ne,disabled:!w.value||I.value},_(I.value?"Reporting...":"Report Incident"),9,MO)])]),default:Qe(()=>[l("form",{onSubmit:gt(ne,["prevent"]),class:"incident-form"},[l("div",sO,[se[10]||(se[10]=l("label",{for:"title",class:"form-label"},"Title",-1)),Ge(l("input",{id:"title","onUpdate:modelValue":se[0]||(se[0]=me=>s.value.title=me),type:"text",class:"form-input",placeholder:"Brief summary (optional)"},null,512),[[at,s.value.title]])]),l("div",iO,[se[11]||(se[11]=l("label",{for:"description",class:"form-label"},[Ve("Description "),l("span",{class:"required"},"*")],-1)),Ge(l("textarea",{id:"description","onUpdate:modelValue":se[1]||(se[1]=me=>s.value.description=me),class:"form-input form-textarea",placeholder:"Describe what happened...",rows:"3",required:""},null,512),[[at,s.value.description]])]),l("div",aO,[l("div",rO,[se[12]||(se[12]=l("label",{for:"severity",class:"form-label"},"Severity",-1)),Ge(l("select",{id:"severity","onUpdate:modelValue":se[2]||(se[2]=me=>s.value.severity=me),class:"form-input form-select"},[(v(),m(we,null,Pe(S,me=>l("option",{key:me.value,value:me.value},_(me.label),9,lO)),64))],512),[[vn,s.value.severity]])]),l("div",cO,[se[13]||(se[13]=l("label",{for:"incidentTime",class:"form-label"},"When",-1)),Ge(l("input",{id:"incidentTime","onUpdate:modelValue":se[3]||(se[3]=me=>s.value.incidentTime=me),type:"datetime-local",class:"form-input"},null,512),[[at,s.value.incidentTime]])])]),A.value.length>0?(v(),m("div",uO,[se[15]||(se[15]=l("label",{for:"checkpoint",class:"form-label"},"Checkpoint",-1)),Ge(l("select",{id:"checkpoint","onUpdate:modelValue":se[4]||(se[4]=me=>a.value=me),class:"form-input form-select"},[se[14]||(se[14]=l("option",{value:""},"-- None / Unknown --",-1)),(v(!0),m(we,null,Pe(A.value,me=>(v(),m("option",{key:me.id,value:me.id},_(me.name)+_(me.description?` - ${me.description}`:""),9,dO))),128))],512),[[vn,a.value]])])):e.checkpoint?(v(),m("div",hO,[se[16]||(se[16]=l("label",{class:"form-label"},"Checkpoint",-1)),l("div",fO,[l("label",pO,[Ge(l("input",{type:"checkbox","onUpdate:modelValue":se[5]||(se[5]=me=>c.value=me)},null,512),[[ys,c.value]]),l("span",vO,_(e.checkpoint.name),1),e.checkpoint.description?(v(),m("span",mO," - "+_(e.checkpoint.description),1)):D("",!0)])])])):D("",!0),l("div",gO,[se[17]||(se[17]=l("label",{class:"form-label"},"Location (optional)",-1)),l("div",yO,[l("div",_O,[l("button",{type:"button",class:_e(["location-btn",{active:u.value==="gps"}]),onClick:se[6]||(se[6]=me=>k("gps"))}," GPS ",2),l("button",{type:"button",class:_e(["location-btn",{active:u.value==="map"}]),onClick:se[7]||(se[7]=me=>k("map"))}," Pick on map ",2),l("button",{type:"button",class:_e(["location-btn",{active:u.value==="none"}]),onClick:se[8]||(se[8]=me=>k("none"))}," None ",2)]),u.value==="gps"?(v(),m("div",kO,[b.value?(v(),m("div",bO," Getting location... ")):p.value&&p.value.latitude!=null?(v(),m("div",wO,[l("span",null,_(p.value.latitude.toFixed(5))+", "+_(p.value.longitude.toFixed(5)),1),f.value?(v(),m("span",CO,"("+_(Math.round(f.value))+"m)",1)):D("",!0)])):y.value?(v(),m("div",LO,_(y.value),1)):D("",!0)])):D("",!0),u.value==="map"?(v(),m("div",SO,[d.value?(v(),m("div",xO,"Tap to select location")):D("",!0),d.value?(v(),et(ws,{key:1,locations:A.value,route:e.route,center:$.value,zoom:14,clickable:!0,"user-location":e.initialLocation,"highlight-location-id":a.value,onMapClick:M,class:"location-picker-map"},null,8,["locations","route","center","user-location","highlight-location-id"])):D("",!0),p.value&&p.value.latitude!=null?(v(),m("div",$O,[l("span",null,_(p.value.latitude.toFixed(5))+", "+_(p.value.longitude.toFixed(5)),1),d.value?D("",!0):(v(),m("button",{key:0,type:"button",class:"location-edit-btn",onClick:se[9]||(se[9]=me=>d.value=!0)},"Edit"))])):D("",!0)])):D("",!0)])]),T.value?(v(),m("div",IO,_(T.value),1)):D("",!0)],32)]),_:1},8,["show","is-dirty"]))}},nv=Ye(AO,[["__scopeId","data-v-666fe4d5"]]),EO={class:"tab-headers"},PO={class:"tab-content"},DO={class:"form-group"},OO={for:"marshalId"},RO=["value"],BO={class:"help-text"},NO={class:"form-group"},FO=["disabled"],UO={class:"form-group"},zO={class:"role-input-group"},HO={key:0,label:"Built-in Roles"},VO=["value"],GO={key:1,label:"Custom Roles"},ZO=["value"],jO={class:"form-row"},WO={class:"form-group"},qO={class:"form-group"},KO={class:"form-group"},YO={class:"tab-content"},JO={class:"custom-footer"},XO={__name:"EditContactModal",props:{show:{type:Boolean,default:!1},contact:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},isDirty:{type:Boolean,default:!1},preselectedArea:{type:Object,default:null}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{terms:o}=Lt(),i=e,s=t,a=P(!1),c=P(""),u=P("details"),d=P(!1),p=P({role:"",name:"",phone:"",email:"",notes:"",marshalId:null,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}),f=Y(()=>!!i.contact),y=Y(()=>!!p.value.marshalId),b=Y(()=>[...i.marshals].sort((w,k)=>Fn(w.name,k.name)));We(()=>i.show,w=>{if(w){if(u.value=i.initialTab,i.contact){const k=[...i.availableRoles.builtInRoles||[],...i.availableRoles.customRoles||[]];d.value=i.contact.role&&!k.includes(i.contact.role),p.value={role:i.contact.role||"",name:i.contact.name||"",phone:i.contact.phone||"",email:i.contact.email||"",notes:i.contact.notes||"",marshalId:i.contact.marshalId||null,scopeConfigurations:i.contact.scopeConfigurations?JSON.parse(JSON.stringify(i.contact.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}}else{d.value=!1;const k=i.preselectedArea?[{scope:"EveryoneInAreas",itemType:"Area",ids:[i.preselectedArea.id]}]:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}];p.value={role:"",name:"",phone:"",email:"",notes:"",marshalId:null,scopeConfigurations:k}}s("update:isDirty",!1)}});const I=w=>w?w==="AreaLead"?`${o.value.area} Lead`:w.replace(/([A-Z])/g," $1").replace(/^./,k=>k.toUpperCase()).trim():"",T=()=>{s("update:isDirty",!0)},S=()=>{if(p.value.marshalId){const w=i.marshals.find(k=>k.id===p.value.marshalId);w&&(p.value.name=w.name,!p.value.phone&&w.phoneNumber&&(p.value.phone=w.phoneNumber),!p.value.email&&w.email&&(p.value.email=w.email))}T()},O=()=>{s("close")},E=()=>{if(!p.value.role||!p.value.role.trim()){A("Please select or enter a role");return}if(!p.value.name||!p.value.name.trim()){A("Please enter a contact name");return}u.value="visibility"},A=w=>{c.value=w,a.value=!0},$=()=>{if(!p.value.role||!p.value.role.trim()){A("Please select or enter a role");return}if(!p.value.name||!p.value.name.trim()){A("Please enter a contact name");return}if(!p.value.scopeConfigurations||p.value.scopeConfigurations.length===0){A("Please select at least one visibility scope");return}if(!p.value.scopeConfigurations.some(M=>!(M.itemType!==null&&(!M.ids||M.ids.length===0)))){A("Please configure at least one scope with valid selections");return}const k={role:p.value.role.trim(),name:p.value.name.trim(),phone:p.value.phone?.trim()||null,email:p.value.email?.trim()||null,notes:p.value.notes?.trim()||null,marshalId:p.value.marshalId||null,scopeConfigurations:p.value.scopeConfigurations};s("save",k)},C=()=>{s("delete",i.contact.contactId)};return(w,k)=>(v(),m(we,null,[Ne(Dt,{show:e.show,title:f.value?"Edit contact":"Create contact",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:O},{footer:Qe(()=>[l("div",JO,[f.value?(v(),m("button",{key:0,type:"button",onClick:C,class:"btn btn-danger"}," Delete ")):D("",!0),!f.value&&u.value==="details"?(v(),m("button",{key:1,type:"button",onClick:E,class:"btn btn-primary"}," Next ")):D("",!0),f.value||u.value==="visibility"?(v(),m("button",{key:2,type:"button",onClick:$,class:"btn btn-primary"},_(f.value?"Save changes":"Create"),1)):D("",!0)])]),default:Qe(()=>[l("div",EO,[l("button",{type:"button",class:_e(["tab-header",{active:u.value==="details"}]),onClick:k[0]||(k[0]=M=>u.value="details")}," Details ",2),l("button",{type:"button",class:_e(["tab-header",{active:u.value==="visibility"}]),onClick:k[1]||(k[1]=M=>u.value="visibility")}," Visibility ",2)]),l("form",{onSubmit:gt($,["prevent"]),class:"contact-form"},[Ge(l("div",PO,[l("div",DO,[l("label",OO,"Link to "+_(V(o).person.toLowerCase())+":",1),Ge(l("select",{id:"marshalId","onUpdate:modelValue":k[2]||(k[2]=M=>p.value.marshalId=M),onChange:S},[k[12]||(k[12]=l("option",{value:null},"-- Not linked --",-1)),(v(!0),m(we,null,Pe(b.value,M=>(v(),m("option",{key:M.id,value:M.id},_(M.name),9,RO))),128))],544),[[vn,p.value.marshalId]]),l("span",BO,"Optionally link to an existing "+_(V(o).person.toLowerCase())+" in the system",1)]),l("div",NO,[k[13]||(k[13]=l("label",{for:"name"},"Name: *",-1)),Ge(l("input",{id:"name","onUpdate:modelValue":k[3]||(k[3]=M=>p.value.name=M),type:"text",onInput:T,disabled:y.value,class:_e({"input-disabled":y.value}),placeholder:"Contact name..."},null,42,FO),[[at,p.value.name]])]),l("div",UO,[k[15]||(k[15]=l("label",{for:"role"},"Role: *",-1)),l("div",zO,[d.value?Ge((v(),m("input",{key:1,id:"customRole","onUpdate:modelValue":k[5]||(k[5]=M=>p.value.role=M),type:"text",onInput:T,placeholder:"Enter custom role name..."},null,544)),[[at,p.value.role]]):Ge((v(),m("select",{key:0,id:"role","onUpdate:modelValue":k[4]||(k[4]=M=>p.value.role=M),onChange:T},[k[14]||(k[14]=l("option",{value:"",disabled:""},"Select a role...",-1)),e.availableRoles.builtInRoles?.length>0?(v(),m("optgroup",HO,[(v(!0),m(we,null,Pe(e.availableRoles.builtInRoles,M=>(v(),m("option",{key:M,value:M},_(I(M)),9,VO))),128))])):D("",!0),e.availableRoles.customRoles?.length>0?(v(),m("optgroup",GO,[(v(!0),m(we,null,Pe(e.availableRoles.customRoles,M=>(v(),m("option",{key:M,value:M},_(I(M)),9,ZO))),128))])):D("",!0)],544)),[[vn,p.value.role]]),l("button",{type:"button",class:"toggle-custom-btn",onClick:k[6]||(k[6]=M=>d.value=!d.value)},_(d.value?"Use existing":"Custom"),1)])]),l("div",jO,[l("div",WO,[k[16]||(k[16]=l("label",{for:"phone"},"Phone:",-1)),Ge(l("input",{id:"phone","onUpdate:modelValue":k[7]||(k[7]=M=>p.value.phone=M),type:"tel",onInput:T,placeholder:"Phone number..."},null,544),[[at,p.value.phone]])]),l("div",qO,[k[17]||(k[17]=l("label",{for:"email"},"Email:",-1)),Ge(l("input",{id:"email","onUpdate:modelValue":k[8]||(k[8]=M=>p.value.email=M),type:"email",onInput:T,placeholder:"Email address..."},null,544),[[at,p.value.email]])])]),l("div",KO,[k[18]||(k[18]=l("label",{for:"notes"},"Notes / Instructions:",-1)),Ge(l("textarea",{id:"notes","onUpdate:modelValue":k[9]||(k[9]=M=>p.value.notes=M),onInput:T,rows:"3",placeholder:"Additional notes or instructions for when to contact..."},null,544),[[at,p.value.notes]])])],512),[[ti,u.value==="details"]]),Ge(l("div",YO,[Ne(Al,{modelValue:p.value.scopeConfigurations,"onUpdate:modelValue":k[10]||(k[10]=M=>p.value.scopeConfigurations=M),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":f.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this contact?",onUserChanged:T},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[ti,u.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Ne(Pl,{show:a.value,title:"Validation error",message:c.value,onClose:k[11]||(k[11]=M=>a.value=!1)},null,8,["show","message"])],64))}},QO=Ye(XO,[["__scopeId","data-v-62986ae5"]]),e5={key:0,class:"fullscreen-map-overlay"},t5={class:"fullscreen-map-header"},n5={class:"context-info"},o5={key:0},s5={class:"action-buttons"},i5=["disabled"],a5={class:"fullscreen-map-container"},r5={key:0,class:"drawing-controls"},l5={class:"point-count"},c5={class:"undo-redo-buttons"},u5=["disabled"],d5=["disabled"],h5=Object.assign({inheritAttrs:!1},{__name:"FullscreenMapOverlay",props:{show:{type:Boolean,required:!0},mode:{type:String,validator:e=>["place-checkpoint","move-checkpoint","draw-area","add-multiple"].includes(e)},contextTitle:{type:String,default:""},contextDescription:{type:String,default:""},canComplete:{type:Boolean,default:!1},drawingMode:{type:Boolean,default:!1}},emits:["done","cancel","map-click","polygon-complete","polygon-drawing","location-click","area-click"],setup(e,{emit:t}){const o=e,i=t,s=P(null),a=P(0),c=P(!1),u=P(!1),d=()=>{i("done")},p=()=>{i("cancel")},f=S=>{a.value=S?.length||0,y(),i("polygon-drawing",S)},y=()=>{s.value&&(c.value=s.value.canUndo(),u.value=s.value.canRedo())},b=()=>{s.value&&(s.value.undoPolygonPoint(),y())},I=()=>{s.value&&(s.value.redoPolygonPoint(),y())};We(()=>o.show,S=>{S||(a.value=0,c.value=!1,u.value=!1)});const T=S=>{S.key==="Escape"&&o.show&&p(),o.show&&o.drawingMode&&((S.ctrlKey||S.metaKey)&&S.key==="z"&&!S.shiftKey?(S.preventDefault(),b()):(S.ctrlKey||S.metaKey)&&(S.key==="y"||S.key==="z"&&S.shiftKey)&&(S.preventDefault(),I()))};return on(()=>{document.addEventListener("keydown",T)}),Lo(()=>{document.removeEventListener("keydown",T)}),(S,O)=>(v(),et(bm,{to:"body"},[e.show?(v(),m("div",e5,[l("div",t5,[l("div",n5,[l("h3",null,_(e.contextTitle),1),e.contextDescription?(v(),m("p",o5,_(e.contextDescription),1)):D("",!0)]),l("div",s5,[l("button",{onClick:p,class:"btn btn-cancel"}," Cancel "),l("button",{onClick:d,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,i5)])]),l("div",a5,[Ne(ws,jf({ref_key:"mapViewRef",ref:s,"drawing-mode":e.drawingMode},S.$attrs,{onMapClick:O[0]||(O[0]=E=>S.$emit("map-click",E)),onPolygonComplete:O[1]||(O[1]=E=>S.$emit("polygon-complete",E)),onPolygonDrawing:f,onLocationClick:O[2]||(O[2]=E=>S.$emit("location-click",E)),onAreaClick:O[3]||(O[3]=E=>S.$emit("area-click",E))}),null,16,["drawing-mode"]),e.drawingMode&&a.value>0?(v(),m("div",r5,[l("div",l5,_(a.value)+" point"+_(a.value!==1?"s":""),1),l("div",c5,[l("button",{onClick:b,class:"btn-drawing undo-btn",disabled:!c.value,title:"Undo last point"},"  Undo ",8,u5),l("button",{onClick:I,class:"btn-drawing redo-btn",disabled:!u.value,title:"Redo point"}," Redo  ",8,d5)])])):D("",!0)])])):D("",!0)]))}}),f5=Ye(h5,[["__scopeId","data-v-a7562744"]]),p5={class:"form-group"},v5={class:"form-group"},m5={class:"form-group"},g5={key:0,class:"form-error"},y5={class:"form-row"},_5={class:"form-group",style:{flex:"1"}},k5={class:"form-group",style:{flex:"1"}},b5={class:"form-group",style:{flex:"0 0 auto"}},w5={class:"form-group"},C5={__name:"AddLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:()=>({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""})},isDirty:{type:Boolean,default:!1}},emits:["close","save","set-on-map","update:isDirty","update:location"],setup(e,{emit:t}){const{termsLower:o}=Lt(),i=e,s=t,a=P({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""});We(()=>i.location,p=>{p&&(a.value={...p})},{immediate:!0,deep:!0});const c=()=>{s("update:isDirty",!0),s("update:location",{...a.value})},u=()=>{if(!il(a.value.what3Words)&&a.value.what3Words){alert("Invalid What3Words format.");return}s("save",a.value)},d=()=>{s("close")};return(p,f)=>(v(),et(Dt,{show:e.show,title:`Add ${V(o).checkpoint}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:Qe(()=>[l("button",{type:"button",onClick:d,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:u,class:"btn btn-primary"}," Add "+_(V(o).checkpoint),1)]),default:Qe(()=>[l("form",{onSubmit:gt(u,["prevent"])},[l("div",p5,[f[7]||(f[7]=l("label",null,"Name",-1)),Ge(l("input",{"onUpdate:modelValue":f[0]||(f[0]=y=>a.value.name=y),type:"text",required:"",class:"form-input",onInput:c},null,544),[[at,a.value.name]])]),l("div",v5,[f[8]||(f[8]=l("label",null,"Description",-1)),Ge(l("input",{"onUpdate:modelValue":f[1]||(f[1]=y=>a.value.description=y),type:"text",class:"form-input",onInput:c},null,544),[[at,a.value.description]])]),l("div",m5,[f[9]||(f[9]=l("label",null,"What3Words (optional)",-1)),Ge(l("input",{"onUpdate:modelValue":f[2]||(f[2]=y=>a.value.what3Words=y),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap",onInput:c},null,544),[[at,a.value.what3Words]]),a.value.what3Words&&!V(il)(a.value.what3Words)?(v(),m("small",g5," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):D("",!0)]),l("div",y5,[l("div",_5,[f[10]||(f[10]=l("label",null,"Longitude",-1)),Ge(l("input",{"onUpdate:modelValue":f[3]||(f[3]=y=>a.value.longitude=y),type:"number",step:"0.00001",required:"",class:"form-input",onInput:c},null,544),[[at,a.value.longitude,void 0,{number:!0}]])]),l("div",k5,[f[11]||(f[11]=l("label",null,"Latitude",-1)),Ge(l("input",{"onUpdate:modelValue":f[4]||(f[4]=y=>a.value.latitude=y),type:"number",step:"0.00001",required:"",class:"form-input",onInput:c},null,544),[[at,a.value.latitude,void 0,{number:!0}]])]),l("div",b5,[f[12]||(f[12]=l("label",null,"",-1)),l("button",{type:"button",class:"icon-btn",title:"Set location on map",onClick:f[5]||(f[5]=y=>p.$emit("set-on-map"))},"  ")])]),l("div",w5,[l("label",null,"Required "+_(V(o).people),1),Ge(l("input",{"onUpdate:modelValue":f[6]||(f[6]=y=>a.value.requiredMarshals=y),type:"number",min:"1",required:"",class:"form-input",onInput:c},null,544),[[at,a.value.requiredMarshals,void 0,{number:!0}]])])],32)]),_:1},8,["show","title","is-dirty"]))}},L5=Ye(C5,[["__scopeId","data-v-dcbdc216"]]),S5={class:"header"},x5={class:"header-left"},$5={key:0},I5={class:"event-date"},T5={class:"header-actions"},M5={class:"container"},A5={class:"tabs-nav"},E5={class:"tab-content-wrapper"},P5={key:1,class:"tab-panel"},D5={key:2,class:"tab-panel"},O5={class:"add-note-form"},R5={class:"modal-footer-actions"},B5=["disabled"],N5=6e4,F5={__name:"AdminEventManage",setup(e){const t=_u(),o=tr(),i=zp(),s=Y(()=>t.params.eventId),{activeTab:a,switchTab:c}=Hp("details",["details","course","areas","checkpoints","marshals","notes","checklists","contacts","settings"]),{showConfirmModal:u,confirmModalTitle:d,confirmModalMessage:p,showConfirm:f,handleConfirmModalConfirm:y,handleConfirmModalCancel:b}=Qb(),{tabLabels:I,termsLower:T}=Lt(),S=ew(),O=nw(s),E=tw(s),{colorScheme:A}=Lu(),$=Y(()=>[{value:"details",label:"Event details",icon:"details"},{value:"course",label:I.value.course,icon:"course"},{value:"areas",label:I.value.areas,icon:"area"},{value:"checkpoints",label:I.value.checkpoints,icon:"checkpoint"},{value:"marshals",label:I.value.marshals,icon:"marshal"},{value:"notes",label:"Notes",icon:"notes"},{value:"incidents",label:"Incidents",icon:"incidents"},{value:"checklists",label:I.value.checklists,icon:"checklist"},{value:"contacts",label:"Contacts",icon:"contacts"},{value:"settings",label:"Settings",icon:"settings"}]),C=P(null),w=P([]),k=P([]),M=P({marshals:0,areas:0,checkpoints:0,checklists:0,notes:0,incidents:0,contacts:0}),G=P(null),ne=P(!1),ce=P(null),K=P(!1),se=P(!1),me=P(null),Re=P(""),Oe=E.eventAdmins,de=E.showAddAdmin,he=O.showUploadRoute,ve=O.uploading,Te=O.uploadError,fe=O.showImportLocations,xe=O.showImportMarshals,Be=O.importing,re=O.importingMarshals,Ee=O.importError,Me=O.importResult,$e=O.importMarshalsResult,ue=P(!1),ye=P(!1),z=P({id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),ee=P(!1),ie=P(!1),B=P({marshalName:"",locations:[],marshal:null}),j=P(null),X=P([]),q=P(!1),F=P(null),N=P({id:"",name:"",email:"",phoneNumber:"",notes:""}),W=P(!1),ge=P([]),Se=P([]),Ce=P([]),ze=P([]),Fe=P(!1),je=P(""),Je=P(""),ae=P({name:"",description:"",eventDate:"",timeZoneId:"UTC",peopleTerm:"Marshals",defaultCheckpointStyleBackgroundShape:"",defaultCheckpointStyleBackgroundColor:"",defaultCheckpointStyleBorderColor:"",defaultCheckpointStyleIconColor:"",defaultCheckpointStyleSize:"",defaultCheckpointStyleMapRotation:"",checkpointTerm:"Checkpoints",areaTerm:"Areas",checklistTerm:"Checklists",courseTerm:"Course",defaultCheckpointStyleType:"default",defaultCheckpointStyleColor:""}),oe=P(!1),J=P(!1),Ze=P(""),Xe=P(""),rt=P(0),ft=P({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),vt=P([]),pt=P(null),ht=P(!1),Ht=P(null),St=P(null),qt=S.isAddingMultipleCheckpoints,Ms=S.multiCheckpointCounter,Bt=S.isFullscreenMapActive,Rt=S.fullscreenMode,Qn=S.fullscreenContext,Kt=S.tempLocationCoords,An=S.tempCheckpoints,si=S.savedMapCenter,gn=S.savedMapZoom,xo=S.isDrawingAreaBoundary,eo=P(null),sn=P([]),en=P(null),As=P(!1),$o=P("details"),ii=P(null),Yt=P([]),qe=P(null),co=P(!1),uo=P("details"),ho=P([]),En=P(!1),Gt=P(null),to=P(!1),Hn=P(!1),Es=P(!1),yn=P(""),Ps=P(!1),qo=P([]),Ds=P({builtInRoles:[],customRoles:[]}),_n=P(null),Io=P(!1),Vn=P("details"),Ko=P(null),Os=P(null),Rs=Y(()=>Os.value?.marshalId!=null),Pi=()=>{o.push(`/event/${t.params.eventId}`)},Yo=Y(()=>`${window.location.origin}/#/event/${t.params.eventId}`),ai=Y(()=>G.value?.id?ho.value.filter(U=>U.checkpointId===G.value.id):[]),To=Y(()=>{if(!F.value?.id)return[];const U=F.value.assignedLocationIds||[];return ho.value.filter(le=>U.includes(le.checkpointId))}),Bs=Y(()=>{const U=[];return k.value.forEach(le=>{le.assignments&&U.push(...le.assignments)}),U}),ri=Y(()=>{if(!F.value)return k.value;const U=F.value.assignedLocationIds||[],le=Ce.value.map(Ae=>Ae.locationId),Ie=ze.value;return k.value.filter(Ae=>!U.includes(Ae.id)&&!le.includes(Ae.id)||Ie.includes(Ae.id))}),Mo=Y(()=>{let U=X.value;if(G.value){const le=G.value.assignments.map(Ae=>Ae.marshalName),Ie=ge.value.map(Ae=>Ae.marshalName);U=X.value.filter(Ae=>!le.includes(Ae.name)&&!Ie.includes(Ae.name))}return U.slice().sort((le,Ie)=>le.name.localeCompare(Ie.name))}),yt=Y(()=>Rt.value==="draw-area"&&pt.value?.polygon?.length>0||S.canCompleteFullscreen.value),$t=Y(()=>{const U=[...k.value];return Rt.value==="place-checkpoint"&&Kt.value&&U.push({id:"temp-single",name:ft.value.name||"New Checkpoint",latitude:Kt.value.lat,longitude:Kt.value.lng,requiredMarshals:ft.value.requiredMarshals||1,assignments:[],isTemporary:!0}),Rt.value==="move-checkpoint"&&Kt.value&&G.value&&U.push({id:"temp-move",name:G.value.name+" (new position)",latitude:Kt.value.lat,longitude:Kt.value.lng,requiredMarshals:G.value.requiredMarshals,assignments:[],isTemporary:!0}),Rt.value==="add-multiple"&&U.push(...An.value),U}),Ns=Y(()=>{const U=[...vt.value];if(Rt.value==="draw-area"&&pt.value?.polygon?.length>0){const le=U.findIndex(Ie=>Ie.id===pt.value.id);le>=0?U[le]={...pt.value}:U.push({...pt.value,id:pt.value.id||"temp-area"})}return U}),Gn=()=>{o.push("/admin/dashboard")},Ao=()=>{o.push({name:"AdminProfile"})},Pt=(U=!0)=>{W.value=U},ct=()=>{oe.value=!0},Mt=async U=>{try{U&&(ae.value={...U});const le=Ya(C.value.eventDate),Ie=ae.value.eventDate;if(le!==Ie){const Ae=w.value.filter(_t=>_t.startTime||_t.endTime);if(Ae.length>0){Ze.value=le,Xe.value=Ie,rt.value=Ae.length,J.value=!0;return}}await Fs(!1,null)}catch(le){console.error("Failed to update event:",le),alert("Failed to update event. Please try again.")}},Fs=async(U,le)=>{try{if(await i.updateEvent(t.params.eventId,{...ae.value,defaultCheckpointStyleMapRotation:ae.value.defaultCheckpointStyleMapRotation!=null?String(ae.value.defaultCheckpointStyleMapRotation):null}),U&&le!==null){const Ie=Math.floor(Math.abs(le)/1e3),Ae=le<0,_t=Math.floor(Ie/3600),Ln=Math.floor(Ie%3600/60),Wn=Ie%60,Fo=`${Ae?"-":""}${_t.toString().padStart(2,"0")}:${Ln.toString().padStart(2,"0")}:${Wn.toString().padStart(2,"0")}`;await i.bulkUpdateLocationTimes(t.params.eventId,Fo)}await rn(),oe.value=!1}catch(Ie){console.error("Failed to update event:",Ie),alert("Failed to update event. Please try again.")}},Eo=async({shouldShift:U,timeDelta:le})=>{J.value=!1,await Fs(U,le)},an=()=>{J.value=!1,rn()},rn=async()=>{try{await i.fetchEvent(t.params.eventId),C.value=i.currentEvent,C.value&&(ae.value={name:C.value.name||"",description:C.value.description||"",eventDate:Ya(C.value.eventDate),timeZoneId:C.value.timeZoneId||"UTC",peopleTerm:C.value.peopleTerm||"Marshals",checkpointTerm:C.value.checkpointTerm||"Checkpoints",areaTerm:C.value.areaTerm||"Areas",checklistTerm:C.value.checklistTerm||"Checklists",courseTerm:C.value.courseTerm||"Course",defaultCheckpointStyleType:C.value.defaultCheckpointStyleType||"default",defaultCheckpointStyleColor:C.value.defaultCheckpointStyleColor||"",defaultCheckpointStyleBackgroundShape:C.value.defaultCheckpointStyleBackgroundShape||"",defaultCheckpointStyleBackgroundColor:C.value.defaultCheckpointStyleBackgroundColor||"",defaultCheckpointStyleBorderColor:C.value.defaultCheckpointStyleBorderColor||"",defaultCheckpointStyleIconColor:C.value.defaultCheckpointStyleIconColor||"",defaultCheckpointStyleSize:C.value.defaultCheckpointStyleSize||"",defaultCheckpointStyleMapRotation:C.value.defaultCheckpointStyleMapRotation??"",brandingHeaderGradientStart:C.value.brandingHeaderGradientStart||"",brandingHeaderGradientEnd:C.value.brandingHeaderGradientEnd||"",brandingLogoUrl:C.value.brandingLogoUrl||"",brandingLogoPosition:C.value.brandingLogoPosition||"",brandingAccentColor:C.value.brandingAccentColor||"",brandingPageGradientStart:C.value.brandingPageGradientStart||"",brandingPageGradientEnd:C.value.brandingPageGradientEnd||""},oe.value=!1,Wc(C.value));const U=await Promise.allSettled([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId),Di(),kn(),At(),It(),tn(),ln(),Pn()]);w.value=i.locations,k.value=i.eventStatus.locations,U.forEach((le,Ie)=>{le.status==="rejected"&&console.error(`Failed to load ${["locations","eventStatus","admins","marshals","areas","checklists","notes","contacts"][Ie]}:`,le.reason)})}catch(U){console.error("Failed to load event data:",U)}},kn=async()=>{try{const U=await jo.getByEvent(t.params.eventId);X.value=U.data,M.value.marshals=Date.now()}catch(U){console.error("Failed to load marshals:",U)}},At=async()=>{try{const U=await Ys.getByEvent(t.params.eventId);vt.value=U.data,M.value.areas=Date.now()}catch(U){console.error("Failed to load areas:",U)}},It=async()=>{try{const[U,le]=await Promise.all([Ot.getByEvent(t.params.eventId),Ot.getReport(t.params.eventId)]);sn.value=U.data,ii.value=le.data,M.value.checklists=Date.now()}catch(U){console.error("Failed to load checklists:",U)}},tn=async()=>{try{const U=await ps.getByEvent(t.params.eventId);Yt.value=U.data,M.value.notes=Date.now()}catch(U){console.error("Failed to load notes:",U)}},ln=async()=>{En.value=!0;try{const U=await Yn.getAll(t.params.eventId);ho.value=U.data.incidents||[],M.value.incidents=Date.now()}catch(U){console.error("Failed to load incidents:",U)}finally{En.value=!1}},Pn=async()=>{try{const[U,le]=await Promise.all([Wi.getByEvent(t.params.eventId),Wi.getRoles(t.params.eventId)]);qo.value=U.data,Ds.value=le.data,M.value.contacts=Date.now()}catch(U){console.error("Failed to load contacts:",U)}},Jo=async()=>{await Promise.all([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId)]),w.value=i.locations,M.value.checkpoints=Date.now(),k.value=i.eventStatus.locations},Po=async()=>{await Promise.all([kn(),i.fetchEventStatus(t.params.eventId)]),k.value=i.eventStatus.locations},Us=async()=>{await Promise.all([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId),At()]),w.value=i.locations,k.value=i.eventStatus.locations},Do=async()=>{await i.fetchEventStatus(t.params.eventId),k.value=i.eventStatus.locations},Oo=()=>{pt.value=null,W.value=!1,ht.value=!0},Xo=U=>{pt.value=U,Ht.value=U.id,W.value=!1,ht.value=!0},Ro=async U=>{try{if(pt.value&&pt.value.id){if(await Ys.update(t.params.eventId,pt.value.id,U),U.checklistChanges&&U.checklistChanges.length>0)for(const le of U.checklistChanges)try{le.complete?await Ot.complete(t.params.eventId,le.itemId,{marshalId:le.marshalId,contextType:le.contextType,contextId:le.contextId}):await Ot.uncomplete(t.params.eventId,le.itemId,{marshalId:le.marshalId,contextType:le.contextType,contextId:le.contextId})}catch(Ie){console.error("Failed to update checklist item:",le,Ie)}}else await Ys.create({eventId:t.params.eventId,...U});await At(),await rn(),es()}catch(le){console.error("Failed to save area:",le),alert(le.response?.data?.message||"Failed to save area. Please try again.")}},Qo=async U=>{f("Delete area","Are you sure you want to delete this area? Checkpoints will be automatically reassigned.",async()=>{try{await Ys.delete(t.params.eventId,U),await Ys.recalculate(t.params.eventId),await At(),await rn(),es()}catch(le){console.error("Failed to delete area:",le),alert(le.response?.data?.message||"Failed to delete area. Please try again.")}})},es=()=>{ht.value=!1,pt.value=null,Ht.value=null,W.value=!1,xo.value=!1,St.value=null},li=U=>{es(),_n.value=null,Vn.value="details",W.value=!1,Ko.value=U,Io.value=!0},ca=U=>{_n.value=U,Vn.value="details",W.value=!1,Io.value=!0},lt=()=>{en.value=null,$o.value="details",W.value=!1,As.value=!0},bn=(U,le="details")=>{en.value=U,$o.value=le,W.value=!1,As.value=!0},bt=async U=>{try{if(en.value&&en.value.itemId)await Ot.update(t.params.eventId,en.value.itemId,U);else{const le=await Ot.create(t.params.eventId,U);le.data.count&&le.data.count>1&&(je.value="Checklist Items Created",Je.value=`Successfully created ${le.data.count} checklist items.`,Fe.value=!0)}await It(),ts()}catch(le){console.error("Failed to save checklist item:",le);const Ie=le.response?.data?.message||"Failed to save checklist item. Please try again.";alert(Ie)}},zs=async U=>{f("Delete checklist item","Are you sure you want to delete this checklist item?",async()=>{try{await Ot.delete(t.params.eventId,U),await It(),ts()}catch(le){console.error("Failed to delete checklist item:",le),alert(le.response?.data?.message||"Failed to delete checklist item. Please try again.")}})},ts=()=>{As.value=!1,en.value=null,W.value=!1},ci=()=>{qe.value=null,uo.value="details",W.value=!1,co.value=!0},ui=U=>{qe.value=U,uo.value="details",W.value=!1,co.value=!0},fo=async U=>{try{qe.value&&qe.value.noteId?await ps.update(t.params.eventId,qe.value.noteId,U):await ps.create(t.params.eventId,U),await tn(),wn()}catch(le){console.error("Failed to save note:",le);const Ie=le.response?.data?.message||"Failed to save note. Please try again.";alert(Ie)}},di=async U=>{f("Delete note","Are you sure you want to delete this note?",async()=>{try{await ps.delete(t.params.eventId,U),await tn(),wn()}catch(le){console.error("Failed to delete note:",le),alert(le.response?.data?.message||"Failed to delete note. Please try again.")}})},wn=()=>{co.value=!1,qe.value=null,W.value=!1},Nt=()=>{Hn.value=!0},po=async U=>{try{await Yn.create(t.params.eventId,U),Hn.value=!1,await ln()}catch(le){console.error("Failed to report incident:",le),alert(le.response?.data?.message||"Failed to report incident. Please try again.")}},Z=U=>{Gt.value=U,to.value=!0},H=()=>{to.value=!1,Gt.value=null},Q=async({incidentId:U,status:le})=>{try{if(await Yn.updateStatus(t.params.eventId,U,{status:le}),await ln(),Gt.value?.incidentId===U){const Ie=ho.value.find(Ae=>Ae.incidentId===U);Ie&&(Gt.value=Ie)}}catch(Ie){console.error("Failed to update incident status:",Ie),alert(Ie.response?.data?.message||"Failed to update status. Please try again.")}},Le=()=>{yn.value="",Es.value=!0},He=()=>{Es.value=!1,yn.value=""},st=async()=>{if(!(!yn.value.trim()||!Gt.value)){Ps.value=!0;try{await Yn.addNote(t.params.eventId,Gt.value.incidentId,yn.value.trim()),He(),await ln();const U=ho.value.find(le=>le.incidentId===Gt.value.incidentId);U&&(Gt.value=U)}catch(U){console.error("Failed to add note to incident:",U),alert(U.response?.data?.message||"Failed to add note. Please try again.")}finally{Ps.value=!1}}},jt=()=>{_n.value=null,Vn.value="details",Ko.value=null,W.value=!1,Io.value=!0},nt=U=>{_n.value=U,Vn.value="details",W.value=!1,Io.value=!0},Dn=async U=>{try{_n.value&&_n.value.contactId?await Wi.update(t.params.eventId,_n.value.contactId,U):await Wi.create(t.params.eventId,U),await Pn(),ns()}catch(le){console.error("Failed to save contact:",le);const Ie=le.response?.data?.message||"Failed to save contact. Please try again.";alert(Ie)}},Cn=async U=>{f("Delete contact","Are you sure you want to delete this contact?",async()=>{try{await Wi.delete(t.params.eventId,U),await Pn(),ns()}catch(le){console.error("Failed to delete contact:",le),alert(le.response?.data?.message||"Failed to delete contact. Please try again.")}})},ns=()=>{Io.value=!1,_n.value=null,Ko.value=null,W.value=!1},lr=U=>{if(St.value=U,ht.value=!1,ce.value){const le=ce.value.getMapCenter(),Ie=ce.value.getMapZoom();le&&Ie!==null&&(si.value=le,gn.value=Ie)}Bt.value=!0,Rt.value="draw-area",xo.value=!0,Qn.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},cr=U=>{St.value?pt.value={...pt.value||{},...St.value,polygon:U}:pt.value={...pt.value,polygon:U}},ua=U=>{S.handlePolygonDrawing(U)},Dl=()=>{xo.value=!1,St.value&&(pt.value=St.value,ht.value=!0,St.value=null)},Di=()=>E.loadEventAdmins(),Ol=async U=>{try{await E.addAdmin(U),await Di(),Oi()}catch(le){console.error("Failed to add admin:",le),alert(le.response?.data?.message||"Failed to add administrator. Please try again.")}},Rl=async U=>{f("Remove Administrator",`Remove ${U} as an administrator?`,async()=>{try{await E.removeAdmin(U),await Di()}catch(le){console.error("Failed to remove admin:",le),alert(le.response?.data?.message||"Failed to remove administrator. Please try again.")}})},Oi=()=>{E.closeAddAdminModal(),W.value=!1},Bl=async U=>{await O.uploadRoute(U)&&(await Jo(),Zn())},Zn=()=>{O.closeUploadRouteModal()},Nl=async({file:U,deleteExisting:le})=>{const Ie=await O.importLocations(U,le);if(Ie){await Us(),da();const Ae=O.formatImportResultMessage(Ie,"location");je.value="Import Complete",Je.value=Ae,Fe.value=!0}},da=()=>{O.closeImportLocationsModal()},Bo=async U=>{if(ne.value)ft.value.latitude=U.lat,ft.value.longitude=U.lng;else if(ye.value)z.value.latitude=U.lat,z.value.longitude=U.lng,G.value&&(G.value={...G.value,latitude:U.lat,longitude:U.lng}),ye.value=!1,ue.value=!0,Pt();else if(qt.value)try{await i.createLocation({eventId:t.params.eventId,name:`Checkpoint ${Ms.value}`,description:"",latitude:U.lat,longitude:U.lng,requiredMarshals:1,what3Words:""}),Ms.value++,await rn()}catch(le){console.error("Failed to create checkpoint:",le),alert("Failed to create checkpoint. Please try again.")}},ur=U=>{S.handleFullscreenMapClick(U)},dr=U=>{ft.value={...U}},ha=()=>{ne.value=!1,S.enterPlaceCheckpointMode()},Fl=()=>{S.saveMapState(ce.value),ft.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},S.enterPlaceCheckpointMode()},hr=()=>{S.saveMapState(ce.value),pt.value={id:null,name:"",description:"",color:"#667eea",polygon:[],checkpointIds:[],marshalIds:[],displayOrder:vt.value.length},S.enterDrawAreaMode()},fr=()=>{G.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},z.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},ge.value=[],Se.value=[],W.value=!1,ue.value=!0},Ul=()=>{const U=S.calculateStartingNumber(k);S.saveMapState(ce.value),S.enterAddMultipleMode(U)},zl=()=>{if(Rt.value==="place-checkpoint"){const U=S.getPlacedCoords()||{lat:0,lng:0};G.value={id:null,name:"",description:"",latitude:U.lat,longitude:U.lng,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},z.value={id:null,name:"",description:"",latitude:U.lat,longitude:U.lng,requiredMarshals:1,what3Words:""},ge.value=[],Se.value=[],W.value=!1,hi(),ue.value=!0}else if(Rt.value==="move-checkpoint"){const U=S.getPlacedCoords();U&&(z.value.latitude=U.lat,z.value.longitude=U.lng,G.value&&(G.value={...G.value,...eo.value||{},latitude:U.lat,longitude:U.lng}),Pt()),eo.value=null,hi(),ue.value=!0}else if(Rt.value==="draw-area"){const U=S.getCompletedPolygon();U&&(St.value?pt.value={...pt.value||{},...St.value,polygon:U}:pt.value={...pt.value||{},polygon:U}),hi(),ht.value=!0,St.value=null}else Rt.value==="add-multiple"&&fa()},fa=async()=>{const U=S.getTempCheckpoints();try{for(const le of U)await i.createLocation({eventId:t.params.eventId,name:le.name,description:le.description,latitude:le.latitude,longitude:le.longitude,requiredMarshals:le.requiredMarshals,what3Words:le.what3Words});S.clearTempCheckpoints(),hi(),await rn()}catch(le){console.error("Failed to create checkpoints:",le),alert("Failed to create checkpoints. Please try again.")}},Hl=()=>{Rt.value==="draw-area"?St.value&&(pt.value=St.value,ht.value=!0,St.value=null):Rt.value==="move-checkpoint"&&(eo.value&&G.value&&Object.assign(G.value,eo.value),ue.value=!0,ye.value=!1),S.cancelFullscreen()},hi=()=>{S.exitFullscreen()},pr=U=>{os(U)},os=U=>{G.value=U,z.value={id:U.id,name:U.name,description:U.description||"",latitude:U.latitude,longitude:U.longitude,requiredMarshals:U.requiredMarshals,what3Words:U.what3Words||""},ge.value=[],Se.value=[],W.value=!1,ue.value=!0,setTimeout(()=>{ce.value?.scrollMapIntoView()},100)},ss=async U=>{if(!il(U.what3Words)){alert("Invalid What3Words format. Please use word.word.word or word/word/word (lowercase letters only, 1-20 characters each)");return}try{await i.createLocation({eventId:t.params.eventId,...U}),await rn(),vr()}catch(le){console.error("Failed to save location:",le),alert("Failed to save location. Please try again.")}},vr=()=>{ne.value=!1,ft.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},W.value=!1,W.value=!1},is=()=>{ue.value=!1,G.value=null,ye.value=!1,ee.value=!1,eo.value=null,z.value={id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},ge.value=[],Se.value=[],W.value=!1},On=U=>{Gt.value=U,to.value=!0},Ri=()=>{ee.value=!1},mr=()=>{ee.value=!0},Vl=U=>{if(U?.formData&&(eo.value=U.formData),ue.value=!1,Kt.value=null,ce.value){const Ie=ce.value.getMapCenter(),Ae=ce.value.getMapZoom();Ie&&Ae!==null&&(si.value=Ie,gn.value=Ae)}const le=eo.value?.name||G.value?.name;Bt.value=!0,Rt.value="move-checkpoint",Qn.value={title:`Move ${T.value.checkpoint}: ${le}`,description:"Click on the map to set the new location"}},pa=async U=>{if(!il(U.what3Words)){alert("Invalid What3Words format.");return}try{const le=!G.value.id;if(le){const Ie=await i.createLocation({eventId:t.params.eventId,name:U.name,description:U.description,latitude:U.latitude,longitude:U.longitude,requiredMarshals:U.requiredMarshals,what3Words:U.what3Words||null,startTime:U.startTime,endTime:U.endTime,styleType:U.styleType,styleColor:U.styleColor,styleBackgroundShape:U.styleBackgroundShape,styleBackgroundColor:U.styleBackgroundColor,styleBorderColor:U.styleBorderColor,styleIconColor:U.styleIconColor,styleSize:U.styleSize,styleMapRotation:U.styleMapRotation!=null?String(U.styleMapRotation):null,peopleTerm:U.peopleTerm,checkpointTerm:U.checkpointTerm,isDynamic:U.isDynamic||!1,locationUpdateScopeConfigurations:U.locationUpdateScopeConfigurations||[],pendingNewChecklistItems:U.pendingNewChecklistItems||[],pendingNewNotes:U.pendingNewNotes||[]});if(U.pendingAssignments&&U.pendingAssignments.length>0)for(const Ae of U.pendingAssignments)await i.createAssignment({eventId:t.params.eventId,locationId:Ie.id,marshalId:Ae.marshalId})}else{const Ie=G.value.id;if(await Nn.update(t.params.eventId,Ie,{eventId:t.params.eventId,name:U.name,description:U.description,latitude:U.latitude,longitude:U.longitude,requiredMarshals:U.requiredMarshals,what3Words:U.what3Words||null,startTime:U.startTime,endTime:U.endTime,styleType:U.styleType,styleColor:U.styleColor,styleBackgroundShape:U.styleBackgroundShape,styleBackgroundColor:U.styleBackgroundColor,styleBorderColor:U.styleBorderColor,styleIconColor:U.styleIconColor,styleSize:U.styleSize,styleMapRotation:U.styleMapRotation!=null?String(U.styleMapRotation):null,peopleTerm:U.peopleTerm,checkpointTerm:U.checkpointTerm,isDynamic:U.isDynamic||!1,locationUpdateScopeConfigurations:U.locationUpdateScopeConfigurations||[]}),U.pendingNewChecklistItems&&U.pendingNewChecklistItems.length>0)for(const Ae of U.pendingNewChecklistItems)Ae.text?.trim()&&await Ot.create(t.params.eventId,{text:Ae.text,scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[Ie]}],displayOrder:0,isRequired:!1});if(U.pendingNewNotes&&U.pendingNewNotes.length>0)for(const Ae of U.pendingNewNotes)!Ae.title?.trim()&&!Ae.content?.trim()||await ps.create(t.params.eventId,{title:Ae.title||"Untitled",content:Ae.content||"",scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[Ie]}],displayOrder:0,priority:"Normal",isPinned:!1});for(const Ae of Se.value)await i.deleteAssignment(t.params.eventId,Ae);for(const Ae of ge.value)await i.createAssignment({eventId:t.params.eventId,locationId:G.value.id,marshalId:Ae.marshalId});if(U.checkInChanges&&U.checkInChanges.length>0)for(const Ae of U.checkInChanges){const _t=G.value.assignments.find(Ln=>Ln.id===Ae.assignmentId);_t&&_t.isCheckedIn!==Ae.shouldBeCheckedIn&&await ks.adminCheckIn(t.params.eventId,Ae.assignmentId)}}if(!le&&U.checklistChanges&&U.checklistChanges.length>0)for(const Ie of U.checklistChanges)try{Ie.complete?await Ot.complete(t.params.eventId,Ie.itemId,{marshalId:Ie.marshalId,contextType:Ie.contextType,contextId:Ie.contextId}):await Ot.uncomplete(t.params.eventId,Ie.itemId,{marshalId:Ie.marshalId,contextType:Ie.contextType,contextId:Ie.contextId})}catch(Ae){console.error("Failed to update checklist item:",Ie,Ae)}await rn(),is()}catch(le){console.error("Failed to update location:",le),alert("Failed to update location. Please try again.")}},va=async U=>{f("Delete location","Are you sure you want to delete this location?",async()=>{try{await Nn.delete(t.params.eventId,U),await Us(),is()}catch(le){console.error("Failed to delete location:",le),alert("Failed to delete location. Please try again.")}})},Gl=U=>{const le=U?.id??U;if(le?.toString().startsWith("temp-")){const Ie=G.value.assignments.find(Ae=>Ae.id===le);Ie&&(ge.value=ge.value.filter(Ae=>Ae.marshalId!==Ie.marshalId)),G.value.assignments=G.value.assignments.filter(Ae=>Ae.id!==le),Pt()}else Se.value.includes(le)||(Se.value.push(le),G.value.assignments=G.value.assignments.filter(Ie=>Ie.id!==le),Pt())},Zl=async U=>{const le=X.value.find(Ae=>Ae.id===U);if(!le)return;const Ie=k.value.filter(Ae=>Ae.assignments?.some(_t=>_t.marshalId===U&&Ae.id!==G.value.id));if(Ie.length>0){B.value={marshalName:le.name,locations:Ie.map(_t=>_t.name),marshal:le};const Ae=await new Promise(_t=>{j.value=_t,ie.value=!0});if(Ae==="cancel"||Ae==="choose-other")return;if(Ae==="move")for(const _t of Ie){const Ln=_t.assignments.find(Wn=>Wn.marshalId===U);if(Ln){Se.value.push(Ln.id);const Wn=k.value.findIndex(Fo=>Fo.id===_t.id);Wn!==-1&&(k.value[Wn].assignments=k.value[Wn].assignments.filter(Fo=>Fo.id!==Ln.id))}}}ge.value.push({marshalId:le.id,marshalName:le.name}),G.value.assignments||(G.value.assignments=[]),G.value.assignments.push({id:`temp-${Date.now()}`,marshalId:le.id,marshalName:le.name,locationId:G.value.id,isCheckedIn:!1,isPending:!0}),Pt(),Ri()},gr=async U=>{try{const Ie=(await jo.create({eventId:t.params.eventId,name:U.name,email:U.email,phoneNumber:U.phoneNumber})).data;await kn(),ge.value.push({marshalId:Ie.id,marshalName:Ie.name}),G.value&&(G.value.assignments||(G.value.assignments=[]),G.value.assignments.push({id:`temp-${Date.now()}`,marshalId:Ie.id,marshalName:Ie.name,locationId:G.value.id,isCheckedIn:!1,isPending:!0})),Pt(),Ri()}catch(le){console.error("Failed to create marshal:",le),alert("Failed to create marshal. Please try again.")}},jl=()=>{F.value=null,N.value={id:"",name:"",email:"",phoneNumber:"",notes:""},Ce.value=[],ze.value=[],W.value=!1,q.value=!0},jn=U=>{F.value=U,N.value={id:U.id,name:U.name,email:U.email||"",phoneNumber:U.phoneNumber||"",notes:U.notes||""},Ce.value=[],ze.value=[],W.value=!1,q.value=!0},as=()=>{if(!F.value)return[];const U=[];return k.value.forEach(le=>{le.assignments.filter(Ae=>Ae.marshalName===F.value.name).forEach(Ae=>{U.push({...Ae,locationName:le.name})})}),U},Wl=async U=>{try{let le=F.value?.id,Ie=!1;if(F.value){if(await jo.update(t.params.eventId,F.value.id,{name:U.name,email:U.email,phoneNumber:U.phoneNumber,notes:U.notes}),U.pendingNewChecklistItems&&U.pendingNewChecklistItems.length>0)for(const Ae of U.pendingNewChecklistItems)Ae.text?.trim()&&await Ot.create(t.params.eventId,{text:Ae.text,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[le]}],displayOrder:0,isRequired:!1});if(U.pendingNewNotes&&U.pendingNewNotes.length>0)for(const Ae of U.pendingNewNotes)!Ae.title?.trim()&&!Ae.content?.trim()||await ps.create(t.params.eventId,{title:Ae.title||"Untitled",content:Ae.content||"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[le]}],displayOrder:0,priority:"Normal",isPinned:!1})}else le=(await jo.create({eventId:t.params.eventId,name:U.name,email:U.email,phoneNumber:U.phoneNumber,notes:U.notes,pendingNewChecklistItems:U.pendingNewChecklistItems||[],pendingNewNotes:U.pendingNewNotes||[]})).data.id,Ie=!0;for(const Ae of ze.value)await i.deleteAssignment(t.params.eventId,Ae);for(const Ae of Ce.value)await i.createAssignment({eventId:t.params.eventId,locationId:Ae.locationId,marshalId:le});if(U.pendingAssignments&&U.pendingAssignments.length>0)for(const Ae of U.pendingAssignments)await i.createAssignment({eventId:t.params.eventId,locationId:Ae.locationId,marshalId:le});if(U.checkInChanges&&U.checkInChanges.length>0){const Ae=as();for(const _t of U.checkInChanges){const Ln=Ae.find(Wn=>Wn.id===_t.assignmentId);Ln&&Ln.isCheckedIn!==_t.shouldBeCheckedIn&&await ks.adminCheckIn(t.params.eventId,_t.assignmentId)}}if(U.checklistChanges&&U.checklistChanges.length>0)for(const Ae of U.checklistChanges)try{const _t={marshalId:le};Ae.contextType&&Ae.contextId&&(_t.contextType=Ae.contextType,_t.contextId=Ae.contextId),Ae.complete?await Ot.complete(t.params.eventId,Ae.itemId,_t):await Ot.uncomplete(t.params.eventId,Ae.itemId,_t)}catch(_t){console.error("Failed to process checklist change:",_t);const Ln=_t.response?.data?.message||"Failed to update checklist item";alert(`Error: ${Ln}`)}await rn(),rs(),Ie&&(me.value=le,Re.value=U.name,se.value=!0)}catch(le){console.error("Failed to save marshal:",le),alert("Failed to save marshal. Please try again.")}},no=async U=>{const le=U||F.value?.id;if(!le){console.error("No marshal ID to delete");return}const Ie=T.value.person;f(`Delete ${Ie}`,`Are you sure you want to delete this ${Ie}?`,async()=>{try{await jo.delete(t.params.eventId,le),await Po(),rs()}catch(Ae){console.error(`Failed to delete ${Ie}:`,Ae),alert(`Failed to delete ${Ie}. Please try again.`)}})},ql=U=>{no(U.id)},Hs=U=>{ze.value.includes(U)||(ze.value.push(U),Pt())},Kl=U=>{Ce.value.push({locationId:U}),Pt()},rs=()=>{q.value=!1,F.value=null,N.value={id:"",name:"",email:"",phoneNumber:"",notes:""},Ce.value=[],ze.value=[],W.value=!1},yr=U=>{Gt.value=U,to.value=!0},Bi=async({file:U})=>{const le=await O.importMarshals(U);if(le){await Po(),_r();const Ie=O.formatImportResultMessage(le,"marshal");je.value="Import Complete",Je.value=Ie,Fe.value=!0}},_r=()=>{O.closeImportMarshalsModal()},No=U=>{j.value&&(j.value(U),j.value=null),ie.value=!1},Ni=async({assignment:U,status:le})=>{try{if(le==="not-checked-in"?U.isCheckedIn&&await ks.adminCheckIn(t.params.eventId,U.id):U.isCheckedIn||await ks.adminCheckIn(t.params.eventId,U.id),await Do(),G.value){const Ie=k.value.find(Ae=>Ae.id===G.value.id);Ie&&(G.value=Ie)}}catch(Ie){console.error("Failed to change assignment status:",Ie),alert("Failed to change status. Please try again.")}};let fi=null;const Fi=async()=>{try{const U=t.params.eventId,le=await Nn.getDynamicCheckpoints(U);if(le.data&&Array.isArray(le.data))for(const Ie of le.data){const Ae=k.value.find(_t=>_t.id===Ie.checkpointId);Ae&&(Ae.latitude=Ie.latitude,Ae.longitude=Ie.longitude,Ae.lastLocationUpdate=Ie.lastLocationUpdate)}}catch(U){console.warn("Failed to poll dynamic checkpoints:",U)}},kr=()=>{fi||!k.value.some(le=>le.isDynamic||le.IsDynamic)||(Fi(),fi=setInterval(Fi,6e4))},oo=()=>{fi&&(clearInterval(fi),fi=null)};return We(a,U=>{U==="course"?kr():oo();const le=Date.now(),Ie=Ae=>le-M.value[Ae]>N5;switch(U){case"marshals":Ie("marshals")&&kn();break;case"areas":Ie("areas")&&At();break;case"checkpoints":Ie("checkpoints")&&Jo();break;case"checklists":Ie("checklists")&&It();break;case"notes":Ie("notes")&&tn();break;case"incidents":Ie("incidents")&&ln();break;case"contacts":Ie("contacts")&&Pn();break}}),on(async()=>{await rn();try{const U=await Zo.getMe(t.params.eventId);Os.value=U.data}catch(U){console.warn("Failed to fetch user claims:",U)}a.value==="course"&&kr()}),Lo(()=>{oo()}),(U,le)=>(v(),m("div",{class:"admin-event-manage",style:ot({colorScheme:V(A)})},[l("header",S5,[l("div",x5,[l("button",{onClick:Gn,class:"btn-back",title:"Back to Dashboard"}," Dashboard"),C.value?(v(),m("div",$5,[l("h1",null,_(C.value.name),1),l("p",I5,_(V(Wp)(C.value.eventDate)),1)])):D("",!0)]),l("div",T5,[Ne(Zp),Rs.value?(v(),m("button",{key:0,onClick:Pi,class:"btn btn-marshal-mode"}," Switch to Marshal ")):D("",!0),l("button",{onClick:Ao,class:"btn btn-secondary"},"Profile")])]),l("div",M5,[l("div",A5,[Ne(P$,{tabs:$.value,"model-value":V(a),"onUpdate:modelValue":V(c)},null,8,["tabs","model-value","onUpdate:modelValue"])]),l("div",E5,[V(a)==="course"?(v(),et(Ww,{key:0,ref_key:"courseAreasTab",ref:ce,checkpoints:k.value,areas:vt.value,route:C.value?.route||[],"selected-area-id":Ht.value,"drawing-mode":V(xo),onMapClick:Bo,onLocationClick:pr,onAreaClick:Xo,onImportCheckpoints:le[0]||(le[0]=Ie=>fe.value=!0),onUploadRoute:le[1]||(le[1]=Ie=>he.value=!0),onSelectLocation:os,onAddArea:Oo,onSelectArea:Xo,onPolygonComplete:cr,onCancelDrawing:Dl,onAddCheckpointFromMap:Fl,onAddManyCheckpointsFromMap:Ul,onAddAreaFromMap:hr},null,8,["checkpoints","areas","route","selected-area-id","drawing-mode"])):D("",!0),V(a)==="checkpoints"?(v(),m("div",P5,[Ne(u$,{locations:k.value,areas:vt.value,onAddCheckpointManually:fr,onImportCheckpoints:le[2]||(le[2]=Ie=>fe.value=!0),onSelectLocation:os},null,8,["locations","areas"])])):D("",!0),V(a)==="areas"?(v(),m("div",D5,[Ne(C$,{areas:vt.value,checkpoints:k.value,contacts:qo.value,"event-people-term":C.value?.peopleTerm||"Marshals","event-checkpoint-term":C.value?.checkpointTerm||"Checkpoints",onAddArea:Oo,onSelectArea:Xo},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term"])])):D("",!0),V(a)==="marshals"?(v(),et(g0,{key:3,marshals:X.value,assignments:Bs.value,locations:k.value,onAddMarshal:jl,onImportMarshals:le[3]||(le[3]=Ie=>xe.value=!0),onSelectMarshal:jn,onDeleteMarshal:ql,onChangeAssignmentStatus:Ni},null,8,["marshals","assignments","locations"])):D("",!0),V(a)==="checklists"?(v(),et(Y0,{key:4,"checklist-items":sn.value,areas:vt.value,locations:k.value,marshals:X.value,"completion-report":ii.value,onAddChecklistItem:lt,onSelectChecklistItem:bn},null,8,["checklist-items","areas","locations","marshals","completion-report"])):D("",!0),V(a)==="notes"?(v(),et(wC,{key:5,notes:Yt.value,areas:vt.value,locations:k.value,marshals:X.value,onAddNote:ci,onSelectNote:ui},null,8,["notes","areas","locations","marshals"])):D("",!0),V(a)==="incidents"?(v(),et(qx,{key:6,incidents:ho.value,areas:vt.value,loading:En.value,onSelectIncident:Z,onReportIncident:Nt},null,8,["incidents","areas","loading"])):D("",!0),V(a)==="contacts"?(v(),et(jC,{key:7,contacts:qo.value,areas:vt.value,locations:k.value,marshals:X.value,"available-roles":Ds.value,onAddContact:jt,onSelectContact:nt},null,8,["contacts","areas","locations","marshals","available-roles"])):D("",!0),V(a)==="details"?(v(),et(s2,{key:8,"event-data":ae.value,"form-dirty":oe.value,onSubmit:Mt,"onUpdate:formDirty":ct},null,8,["event-data","form-dirty"])):D("",!0),V(a)==="settings"?(v(),et(mx,{key:9,"event-data":ae.value,"event-id":V(t).params.eventId,admins:V(Oe),"form-dirty":oe.value,onSubmit:Mt,onAddAdmin:le[4]||(le[4]=Ie=>de.value=!0),onRemoveAdmin:Rl,"onUpdate:formDirty":ct},null,8,["event-data","event-id","admins","form-dirty"])):D("",!0)])]),Ne(L5,{show:ne.value,location:ft.value,"is-dirty":W.value,onClose:vr,onSave:ss,onSetOnMap:ha,"onUpdate:isDirty":Pt,"onUpdate:location":dr},null,8,["show","location","is-dirty"]),Ne(AE,{show:ue.value,location:G.value,assignments:G.value?.assignments||[],"event-date":C.value?.eventDate||"",areas:vt.value,"event-id":V(t).params.eventId,"all-locations":k.value,notes:Yt.value,"available-marshals":Mo.value,"all-checklist-items":sn.value,"is-dirty":W.value,"event-default-style-type":C.value?.defaultCheckpointStyleType||C.value?.DefaultCheckpointStyleType||"default","event-default-style-color":C.value?.defaultCheckpointStyleColor||C.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":C.value?.defaultCheckpointStyleBackgroundShape||C.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":C.value?.defaultCheckpointStyleBackgroundColor||C.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":C.value?.defaultCheckpointStyleBorderColor||C.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":C.value?.defaultCheckpointStyleIconColor||C.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":C.value?.defaultCheckpointStyleSize||C.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":C.value?.defaultCheckpointStyleMapRotation??C.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":C.value?.peopleTerm||"Marshals",incidents:ai.value,"z-index":ht.value?1100:1e3,onClose:is,onSave:pa,onDelete:va,onMoveLocation:Vl,onRemoveAssignment:Gl,onOpenAssignModal:mr,"onUpdate:isDirty":Pt,onSelectIncident:On},null,8,["show","location","assignments","event-date","areas","event-id","all-locations","notes","available-marshals","all-checklist-items","is-dirty","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","incidents","z-index"]),Ne(B$,{show:K.value,link:Yo.value,"is-dirty":!1,onClose:le[5]||(le[5]=Ie=>K.value=!1)},null,8,["show","link"]),Ne(J$,{show:se.value,"event-id":V(t).params.eventId,"marshal-id":me.value,"marshal-name":Re.value,onClose:le[6]||(le[6]=Ie=>se.value=!1)},null,8,["show","event-id","marshal-id","marshal-name"]),Ne(eI,{show:V(de),"is-dirty":W.value,onClose:Oi,onSubmit:Ol,"onUpdate:isDirty":Pt},null,8,["show","is-dirty"]),Ne(iI,{show:V(he),uploading:V(ve),error:V(Te),"is-dirty":W.value,onClose:Zn,onSubmit:Bl,"onUpdate:isDirty":Pt},null,8,["show","uploading","error","is-dirty"]),Ne(vI,{show:V(fe),importing:V(Be),error:V(Ee),result:V(Me),"is-dirty":W.value,onClose:da,onSubmit:Nl,"onUpdate:isDirty":Pt},null,8,["show","importing","error","result","is-dirty"]),Ne(B4,{show:q.value,marshal:F.value,"event-id":V(t).params.eventId,assignments:as(),"available-locations":ri.value,"all-locations":k.value,areas:vt.value,"is-editing":!!F.value,"event-notes":Yt.value,"all-checklist-items":sn.value,incidents:To.value,"is-dirty":W.value,onClose:rs,onSave:Wl,onDelete:no,onRemoveAssignment:Hs,onAssignToLocation:Kl,"onUpdate:isDirty":Pt,onSelectIncident:yr},null,8,["show","marshal","event-id","assignments","available-locations","all-locations","areas","is-editing","event-notes","all-checklist-items","incidents","is-dirty"]),Ne(CI,{show:V(xe),importing:V(re),error:V(Ee),result:V($e),"is-dirty":W.value,onClose:_r,onSubmit:Bi,"onUpdate:isDirty":Pt},null,8,["show","importing","error","result","is-dirty"]),Ne(z4,{show:ie.value,"conflict-data":B.value,onClose:le[7]||(le[7]=Ie=>ie.value=!1),onChoice:No},null,8,["show","conflict-data"]),Ne(J4,{show:ee.value,"location-name":G.value?.name||"",marshals:Mo.value,onClose:Ri,onAssignExisting:Zl,onCreateAndAssign:gr},null,8,["show","location-name","marshals"]),Ne(c3,{show:J.value,"old-event-date":Ze.value,"new-event-date":Xe.value,"affected-checkpoints-count":rt.value,onConfirm:Eo,onCancel:an},null,8,["show","old-event-date","new-event-date","affected-checkpoints-count"]),Ne(ED,{show:ht.value,area:pt.value,checkpoints:k.value,marshals:X.value,areas:vt.value,"is-dirty":W.value,"event-id":V(t).params.eventId,"all-locations":k.value,assignments:Bs.value,notes:Yt.value,contacts:qo.value,"event-default-style-type":C.value?.defaultCheckpointStyleType||C.value?.DefaultCheckpointStyleType||"default","event-default-style-color":C.value?.defaultCheckpointStyleColor||C.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":C.value?.defaultCheckpointStyleBackgroundShape||C.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":C.value?.defaultCheckpointStyleBackgroundColor||C.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":C.value?.defaultCheckpointStyleBorderColor||C.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":C.value?.defaultCheckpointStyleIconColor||C.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":C.value?.defaultCheckpointStyleSize||C.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":C.value?.defaultCheckpointStyleMapRotation??C.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":C.value?.peopleTerm||"Marshals","event-checkpoint-term":C.value?.checkpointTerm||"Checkpoints",onClose:es,onSave:Ro,onDelete:Qo,onDrawBoundary:lr,"onUpdate:isDirty":Pt,onSelectCheckpoint:os,onAddAreaContact:li,onEditContact:ca},null,8,["show","area","checkpoints","marshals","areas","is-dirty","event-id","all-locations","assignments","notes","contacts","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","event-checkpoint-term"]),Ne(VD,{show:As.value,"checklist-item":en.value,"initial-tab":$o.value,areas:vt.value,locations:k.value,marshals:X.value,"is-dirty":W.value,onClose:ts,onSave:bt,onDelete:zs,"onUpdate:isDirty":Pt},null,8,["show","checklist-item","initial-tab","areas","locations","marshals","is-dirty"]),Ne(s6,{show:co.value,note:qe.value,"initial-tab":uo.value,areas:vt.value,locations:k.value,marshals:X.value,"is-dirty":W.value,onClose:wn,onSave:fo,onDelete:di,"onUpdate:isDirty":Pt},null,8,["show","note","initial-tab","areas","locations","marshals","is-dirty"]),Ne($u,{show:to.value,incident:Gt.value,route:C.value?.route||[],checkpoints:k.value,"can-manage":!0,onClose:H,onStatusChange:Q,onOpenAddNote:Le},null,8,["show","incident","route","checkpoints"]),Ne(Dt,{show:Es.value,title:"Add update",size:"small",onClose:He},{footer:Qe(()=>[l("div",R5,[l("button",{type:"button",class:"btn btn-secondary",onClick:He}," Cancel "),l("button",{type:"button",class:"btn btn-primary",onClick:st,disabled:!yn.value.trim()||Ps.value},_(Ps.value?"Adding...":"Add update"),9,B5)])]),default:Qe(()=>[l("div",O5,[Ge(l("textarea",{"onUpdate:modelValue":le[8]||(le[8]=Ie=>yn.value=Ie),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[at,yn.value]])])]),_:1},8,["show"]),Ne(nv,{show:Hn.value,"event-id":V(t).params.eventId,checkpoint:null,"initial-location":null,checkpoints:k.value,route:C.value?.route||[],onClose:le[9]||(le[9]=Ie=>Hn.value=!1),onSubmit:po},null,8,["show","event-id","checkpoints","route"]),Ne(QO,{show:Io.value,contact:_n.value,"initial-tab":Vn.value,areas:vt.value,locations:k.value,marshals:X.value,"available-roles":Ds.value,"is-dirty":W.value,"preselected-area":Ko.value,onClose:ns,onSave:Dn,onDelete:Cn,"onUpdate:isDirty":Pt},null,8,["show","contact","initial-tab","areas","locations","marshals","available-roles","is-dirty","preselected-area"]),Ne(f5,{show:V(Bt),mode:V(Rt),"context-title":V(Qn).title,"context-description":V(Qn).description,"can-complete":yt.value,clickable:V(Rt)!=="draw-area","drawing-mode":V(Rt)==="draw-area"&&V(xo),locations:$t.value,areas:Ns.value,route:C.value?.route||[],"selected-area-id":Ht.value,center:V(si),zoom:V(gn),onMapClick:ur,onPolygonComplete:cr,onPolygonDrawing:ua,onDone:zl,onCancel:Hl},null,8,["show","mode","context-title","context-description","can-complete","clickable","drawing-mode","locations","areas","route","selected-area-id","center","zoom"]),Ne(Pl,{show:Fe.value,title:je.value,message:Je.value,onClose:le[10]||(le[10]=Ie=>Fe.value=!1)},null,8,["show","title","message"]),Ne(Ka,{show:V(u),title:V(d),message:V(p),onConfirm:V(y),onCancel:V(b)},null,8,["show","title","message","onConfirm","onCancel"])],4))}},U5=Ye(F5,[["__scopeId","data-v-f5e0c0cb"]]),z5={key:0,class:"emergency-notes-section"},H5={class:"emergency-notes-list"},V5={class:"note-header"},G5={key:0,class:"note-content"},Z5={key:1,class:"emergency-contacts-section"},j5={class:"emergency-contacts-list"},W5={class:"contact-header"},q5={key:0,class:"role-badge"},K5={class:"contact-details"},Y5={key:0,class:"info-section"},J5=["href"],X5={key:1,class:"info-section"},Q5=["href"],eR={key:2,class:"info-section"},tR=["href"],nR={key:2,class:"no-contacts"},oR={__name:"EmergencyContactModal",props:{show:{type:Boolean,default:!1},contacts:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const o=e,i=t,s=Y(()=>o.notes?[...o.notes].sort((u,d)=>{const p=u.priority||u.Priority,f=d.priority||d.Priority;return p==="Emergency"&&f!=="Emergency"?-1:f==="Emergency"&&p!=="Emergency"?1:0}):[]),a=()=>{i("close")},c=u=>u?{EmergencyContact:"Emergency Contact",EventDirector:"Event Director",MedicalLead:"Medical Lead",SafetyOfficer:"Safety Officer",Logistics:"Logistics"}[u]||u.replace(/([A-Z])/g," $1").trim():"";return(u,d)=>(v(),et(Dt,{show:e.show,title:"Emergency information",size:"medium",onClose:a},{actions:Qe(()=>[l("button",{onClick:a,class:"btn btn-secondary"},"Close")]),default:Qe(()=>[e.notes&&e.notes.length>0?(v(),m("div",z5,[d[0]||(d[0]=l("h2",{class:"section-header"},"Emergency notes",-1)),l("div",H5,[(v(!0),m(we,null,Pe(s.value,p=>(v(),m("div",{key:p.noteId||p.NoteId,class:_e(["emergency-note-item",{"is-emergency":(p.priority||p.Priority)==="Emergency"}])},[l("div",V5,[l("h3",null,_(p.title||p.Title),1),l("span",{class:_e(["priority-badge",(p.priority||p.Priority).toLowerCase()])},_(p.priority||p.Priority),3)]),p.content||p.Content?(v(),m("div",G5,_(p.content||p.Content),1)):D("",!0)],2))),128))])])):D("",!0),e.contacts&&e.contacts.length>0?(v(),m("div",Z5,[d[4]||(d[4]=l("h2",{class:"section-header"},"Emergency contacts",-1)),l("div",j5,[(v(!0),m(we,null,Pe(e.contacts,p=>(v(),m("div",{key:p.contactId||p.name,class:"emergency-contact-item"},[l("div",W5,[l("h3",null,_(p.name),1),p.role?(v(),m("span",q5,_(c(p.role)),1)):D("",!0)]),l("div",K5,[p.phone?(v(),m("div",Y5,[d[1]||(d[1]=l("label",null,"Phone number",-1)),l("a",{href:`tel:${p.phone}`,class:"phone-link"},_(p.phone),9,J5)])):D("",!0),p.email?(v(),m("div",X5,[d[2]||(d[2]=l("label",null,"Email",-1)),l("a",{href:`mailto:${p.email}`,class:"email-link"},_(p.email),9,Q5)])):D("",!0),p.notes||p.details?(v(),m("div",eR,[d[3]||(d[3]=l("label",null,"Details",-1)),l("p",null,_(p.notes||p.details),1)])):D("",!0)]),p.phone?(v(),m("a",{key:0,href:`tel:${p.phone}`,class:"btn btn-danger btn-full"}," Call "+_(p.name),9,tR)):D("",!0)]))),128))])])):D("",!0),(!e.contacts||e.contacts.length===0)&&(!e.notes||e.notes.length===0)?(v(),m("div",nR,[...d[5]||(d[5]=[l("p",null,"No emergency information has been set up for this event.",-1)])])):D("",!0)]),_:1},8,["show"]))}},sR=Ye(oR,[["__scopeId","data-v-3f42c790"]]),Rr=P(navigator.onLine),Js=P(!0),xi=P(0),Br=P(null),Ci=P("idle"),ea=P(null);let Ah=null,bc=!1,go=null;function iR(e=1e3,t=1e4){return Math.floor(Math.random()*(t-e+1))+e}function Jc(){go&&(clearTimeout(go),go=null);const e=iR(1e3,1e4);console.log(`Scheduling auto-sync in ${e}ms`),go=setTimeout(async()=>{if(go=null,!navigator.onLine){console.log("Auto-sync cancelled: offline");return}if(await sl()===0){console.log("Auto-sync cancelled: no pending actions");return}console.log("Starting auto-sync..."),await rl();const o=await sl();o>0&&navigator.onLine&&(console.log(`${o} actions remaining, scheduling retry...`),Jc())},e)}async function Ta(){if(!navigator.onLine)return Js.value=!1,!1;try{return await ck.check(),Js.value=!0,!0}catch(e){return e.response?.status===404?(Js.value=!0,!0):(e.code==="ECONNABORTED"&&console.warn("Server health check timed out"),Js.value=!1,!1)}}async function aR(e){try{switch(e.type){case"checkin":await ks.checkIn(e.payload);break;case"checkin_admin":await ks.adminCheckIn(e.payload.eventId,e.payload.assignmentId);break;case"checklist_complete":await Ot.complete(e.payload.eventId,e.payload.itemId,e.payload.data);break;case"checklist_uncomplete":await Ot.uncomplete(e.payload.eventId,e.payload.itemId,e.payload.data);break;default:return console.warn("Unknown action type:",e.type),!1}return!0}catch(t){return console.error("Failed to sync action:",e,t),t.response&&t.response.status>=400&&t.response.status<500?"permanent_failure":!1}}async function rl(){if(!bc&&navigator.onLine){bc=!0,Ci.value="syncing",ea.value=null;try{const e=await Up();if(e.length===0){Ci.value="success",xi.value=0;return}let t=0,o=0;for(const i of e){const s=await aR(i);if(s===!0)await kh(i.id),t++;else if(s==="permanent_failure")await kh(i.id),o++;else{const a=(i.attempts||0)+1;a>=5?(await _h(i.id,{status:"failed",attempts:a,lastAttempt:new Date().toISOString()}),o++):await _h(i.id,{status:"retrying",attempts:a,lastAttempt:new Date().toISOString()})}}xi.value=await sl(),o>0?(Ci.value="error",ea.value=`${o} action(s) failed to sync`):Ci.value="success"}catch(e){console.error("Sync error:",e),Ci.value="error",ea.value="Failed to sync pending actions"}finally{bc=!1}}}function rR(){Ah||(Ah=setInterval(async()=>{navigator.onLine&&(await Ta(),Js.value&&xi.value>0&&await rl())},3e4))}function Iu(){const e=Y(()=>Rr.value&&Js.value);async function t(){xi.value=await sl()}async function o(){Rr.value=!0,await Ta()&&xi.value>0&&Jc()}function i(){Rr.value=!1,Js.value=!1,go&&(clearTimeout(go),go=null)}on(async()=>{await Ts(),await t(),window.addEventListener("online",o),window.addEventListener("offline",i),navigator.onLine&&await Ta()&&xi.value>0&&Jc(),rR()}),Lo(()=>{window.removeEventListener("online",o),window.removeEventListener("offline",i),go&&(clearTimeout(go),go=null)});async function s(d,p){if(!e.value)return console.warn("Cannot refresh cache while offline"),!1;try{const f=await p();return await qa(d,f),Br.value=new Date().toISOString(),!0}catch(f){return console.error("Failed to refresh cache:",f),!1}}async function a(d){const p=await Qs(d);return p&&(Br.value=p.cachedAt),p}async function c(d){Br.value=await ok(d)}async function u(){return navigator.onLine?await Ta()?(await rl(),Ci.value==="success"):(ea.value="Server is not responding",!1):(ea.value="Cannot sync while offline",!1)}return{isOnline:Rr,isServerHealthy:Js,isFullyOnline:e,pendingActionsCount:xi,lastSyncTime:Br,syncStatus:Ci,syncError:ea,checkServerHealth:Ta,syncPendingActions:rl,updatePendingCount:t,refreshCache:s,getCachedData:a,loadLastSyncTime:c,forcSync:u}}const lR={class:"area-lead-content"},cR={key:0,class:"loading-state"},uR={key:1,class:"error-state"},dR={key:2,class:"empty-state"},hR={key:3,class:"checkpoint-accordion"},fR=["onClick"],pR={class:"checkpoint-header-content"},vR={class:"checkpoint-title-row"},mR={class:"checkpoint-name"},gR={key:0,class:"area-badge"},yR={key:0,class:"checkpoint-description-preview"},_R={class:"checkpoint-status-row"},kR={class:"status-badge marshals-status"},bR={key:0,class:"status-badge tasks-status"},wR={class:"accordion-icon"},CR={key:0,class:"checkpoint-accordion-content"},LR={class:"checkpoint-mini-map"},SR={class:"checkpoint-marshals-section"},xR={class:"marshals-label"},$R={key:0,class:"empty-state"},IR={key:1,class:"marshals-list"},TR=["onClick"],MR={class:"marshal-header"},AR={class:"marshal-name-row"},ER={class:"marshal-name"},PR={key:0,class:"task-count"},DR={class:"check-status-row"},OR=["onClick","disabled"],RR={key:0,class:"check-in-time"},BR={key:0},NR={key:1,class:"last-access-time"},FR={key:0,class:"checkpoint-tasks-section"},UR={class:"marshals-label"},zR={class:"tasks-list"},HR=["disabled","onChange"],VR={class:"task-text"},GR={class:"incidents-accordion-section"},ZR={class:"incidents-header-content"},jR={key:0,class:"incidents-badge"},WR={class:"accordion-icon"},qR={key:0,class:"incidents-accordion-content"},KR={key:0,class:"loading-state"},YR={key:1,class:"empty-state"},JR={key:2,class:"incidents-list"},XR={key:0,class:"marshal-details-modal"},QR={class:"details-section"},e8={class:"contact-info"},t8={key:0,class:"contact-row"},n8=["href"],o8={key:1,class:"contact-row"},s8=["href"],i8={key:2,class:"no-contact"},a8={class:"details-section"},r8={key:0,class:"checked-in-section"},l8={class:"checked-in-details"},c8={class:"check-time-detail"},u8={key:0,class:"check-method"},d8=["disabled"],h8={key:1,class:"not-checked-in-section"},f8=["disabled"],p8={key:2,class:"last-access-detail"},v8={class:"details-section"},m8={key:0,class:"no-tasks"},g8={key:1,class:"tasks-list modal-tasks"},y8=["disabled","onChange"],_8={class:"task-text"},k8={class:"details-section contact-actions-section"},b8={class:"contact-buttons"},w8=["href"],C8=["href"],L8=["href"],S8={__name:"AreaLeadSection",props:{eventId:{type:String,required:!0},areaIds:{type:Array,default:()=>[]},marshalId:{type:String,required:!0},route:{type:Array,default:()=>[]}},emits:["checklist-updated","loaded","checkin-updated"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=Lt(),{updatePendingCount:a}=Iu(),c=e,u=o,d=P(!1),p=P(null),f=P([]),y=P([]),b=P(null),I=P(!1),T=P(null),S=Y(()=>[...y.value].sort((z,ee)=>Fn(z.name,ee.name))),O=(z,ee=60)=>z?z.length<=ee?z:z.substring(0,ee).trim()+"...":"";t({areas:f,checkpoints:y,loading:d});const E=P(!1),A=P(null),$=P(null),C=P([]),w=P(!1),k=P(!1),M=P(null),G=P(!1),ne=async()=>{if(!(!c.eventId||c.areaIds.length===0)){if(d.value=!0,p.value=null,dn()){try{const z=await Qs(c.eventId);if(z?.areaLeadDashboard){f.value=z.areaLeadDashboard.areas||[],y.value=z.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(z){console.warn("Failed to load cached dashboard:",z)}p.value="Offline - no cached data available",d.value=!1;return}try{const z=await Ys.getAreaLeadDashboard(c.eventId);f.value=z.data.areas||[],y.value=z.data.checkpoints||[];try{const ee=JSON.parse(JSON.stringify({areas:f.value,checkpoints:y.value}));await Qs(c.eventId)?await xa(c.eventId,"areaLeadDashboard",ee):await qa(c.eventId,{areaLeadDashboard:ee})}catch(ee){console.warn("Failed to cache dashboard:",ee)}}catch(z){console.error("Failed to load area lead dashboard:",z);try{const ee=await Qs(c.eventId);if(ee?.areaLeadDashboard){console.log("Loading area lead dashboard from cache after error"),f.value=ee.areaLeadDashboard.areas||[],y.value=ee.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(ee){console.warn("Failed to load cached dashboard:",ee)}p.value=z.response?.data?.message||"Failed to load dashboard"}finally{d.value=!1}}},ce=async()=>{if(!(!c.eventId||c.areaIds.length===0)){w.value=!0;try{const z=[];for(const ie of c.areaIds)try{const j=(await Yn.getForArea(c.eventId,ie)).data.incidents||[];z.push(...j)}catch(B){console.warn(`Failed to load incidents for area ${ie}:`,B)}const ee=z.reduce((ie,B)=>(ie.find(j=>j.incidentId===B.incidentId)||ie.push(B),ie),[]);C.value=ee.sort((ie,B)=>new Date(B.incidentTime||B.createdAt)-new Date(ie.incidentTime||ie.createdAt))}catch(z){console.error("Failed to load incidents:",z)}finally{w.value=!1}}},K=Y(()=>C.value.filter(z=>z.status==="open"||z.status==="acknowledged"||z.status==="in_progress").length),se=()=>{k.value=!k.value,k.value&&C.value.length===0&&ce()},me=z=>{M.value=z,G.value=!0},Re=()=>{G.value=!1,M.value=null},Oe=async({incidentId:z,status:ee})=>{try{if(await Yn.updateStatus(c.eventId,z,{status:ee}),await ce(),M.value?.incidentId===z){const ie=C.value.find(B=>B.incidentId===z);ie&&(M.value=ie)}}catch(ie){console.error("Failed to update incident status:",ie),alert(ie.response?.data?.message||"Failed to update status")}},de=async({incidentId:z,note:ee})=>{try{if(await Yn.addNote(c.eventId,z,ee),await ce(),M.value?.incidentId===z){const ie=C.value.find(B=>B.incidentId===z);ie&&(M.value=ie)}}catch(ie){console.error("Failed to add note to incident:",ie),alert(ie.response?.data?.message||"Failed to add note")}},he=z=>{b.value=b.value===z?null:z},ve=z=>z.marshals.filter(ee=>ee.isCheckedIn).length,Te=z=>{const ee=z.marshals.reduce((ie,B)=>ie+B.outstandingTaskCount,0);return z.outstandingTaskCount+ee},fe=(z,ee)=>{A.value=z,$.value=ee,E.value=!0},xe=()=>{E.value=!1,A.value=null,$.value=null},Be=async(z,ee)=>{if(T.value)return;const ie=z.assignmentId||z.id;if(!ie){console.error("No assignment ID found for marshal:",z);return}T.value=z.marshalId;try{if(dn())await Kn("checkin_admin",{eventId:c.eventId,assignmentId:ie}),z.isCheckedIn=!0,z.checkInTime=new Date().toISOString(),z.checkInMethod="AreaLead (pending)",await a(),u("checkin-updated");else if(await ks.adminCheckIn(c.eventId,ie),await ne(),u("checkin-updated"),A.value?.marshalId===z.marshalId&&$.value){const B=y.value.find(j=>j.checkpointId===$.value.checkpointId);if(B){const j=B.marshals.find(X=>X.marshalId===z.marshalId);j&&(A.value=j)}}}catch(B){console.error("Failed to check in marshal:",B),(dn()||!B.response)&&(await Kn("checkin_admin",{eventId:c.eventId,assignmentId:ie}),z.isCheckedIn=!0,z.checkInTime=new Date().toISOString(),z.checkInMethod="AreaLead (pending)",await a(),u("checkin-updated"))}finally{T.value=null}},re=async(z,ee)=>{if(I.value)return;I.value=!0;const B={marshalId:ee.marshals.length>0?ee.marshals[0].marshalId:c.marshalId,contextType:z.contextType,contextId:z.contextId};try{dn()?(await Kn("checklist_complete",{eventId:c.eventId,itemId:z.itemId,data:B}),ee.outstandingTasks=ee.outstandingTasks.filter(j=>j.itemId!==z.itemId),ee.outstandingTaskCount=Math.max(0,ee.outstandingTaskCount-1),await a(),u("checklist-updated")):(await Ot.complete(c.eventId,z.itemId,B),await ne(),u("checklist-updated"))}catch(j){console.error("Failed to complete task:",j),(dn()||!j.response)&&(await Kn("checklist_complete",{eventId:c.eventId,itemId:z.itemId,data:B}),ee.outstandingTasks=ee.outstandingTasks.filter(X=>X.itemId!==z.itemId),ee.outstandingTaskCount=Math.max(0,ee.outstandingTaskCount-1),await a(),u("checklist-updated"))}finally{I.value=!1}},Ee=async z=>{if(I.value||!A.value)return;I.value=!0;const ee={marshalId:A.value.marshalId,contextType:z.contextType,contextId:z.contextId};try{if(dn())await Kn("checklist_complete",{eventId:c.eventId,itemId:z.itemId,data:ee}),A.value.outstandingTasks=A.value.outstandingTasks.filter(ie=>ie.itemId!==z.itemId),A.value.outstandingTaskCount=Math.max(0,A.value.outstandingTaskCount-1),await a(),u("checklist-updated");else{if(await Ot.complete(c.eventId,z.itemId,ee),await ne(),A.value&&$.value){const ie=y.value.find(B=>B.checkpointId===$.value.checkpointId);if(ie){const B=ie.marshals.find(j=>j.marshalId===A.value.marshalId);B&&(A.value=B)}}u("checklist-updated")}}catch(ie){console.error("Failed to complete task:",ie),(dn()||!ie.response)&&(await Kn("checklist_complete",{eventId:c.eventId,itemId:z.itemId,data:ee}),A.value.outstandingTasks=A.value.outstandingTasks.filter(B=>B.itemId!==z.itemId),A.value.outstandingTaskCount=Math.max(0,A.value.outstandingTaskCount-1),await a(),u("checklist-updated"))}finally{I.value=!1}},Me=z=>z?new Date(z).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",$e=z=>z?new Date(z).toLocaleString():"",ue=z=>{if(!z)return"";const ee=new Date(z),B=new Date-ee,j=Math.floor(B/6e4),X=Math.floor(j/60),q=Math.floor(X/24);return j<1?"just now":j<60?`${j}m ago`:X<24?`${X}h ago`:q===1?"yesterday":q<7?`${q}d ago`:ee.toLocaleDateString()},ye=z=>({GPS:"GPS",Manual:"Manual",Admin:"Admin",AreaLead:`${i.value.area} Lead`})[z]||z;return We(()=>[c.eventId,c.areaIds],()=>{ne()},{immediate:!0}),(z,ee)=>(v(),m("div",lR,[d.value?(v(),m("div",cR," Loading dashboard... ")):p.value?(v(),m("div",uR,[l("p",null,_(p.value),1),l("button",{onClick:ne,class:"btn btn-secondary"},"Retry")])):S.value.length===0?(v(),m("div",dR,[l("p",null,"No "+_(V(s).checkpoints)+" in your "+_(V(s).areas)+".",1)])):(v(),m("div",hR,[(v(!0),m(we,null,Pe(S.value,ie=>(v(),m("div",{key:ie.checkpointId,class:"checkpoint-accordion-section"},[l("button",{class:_e(["checkpoint-accordion-header",{active:b.value===ie.checkpointId}]),onClick:B=>he(ie.checkpointId)},[l("div",pR,[l("div",vR,[l("span",mR,_(ie.name),1),ie.areaName?(v(),m("span",gR,_(ie.areaName),1)):D("",!0)]),ie.description?(v(),m("div",yR,_(O(ie.description)),1)):D("",!0),l("div",_R,[l("span",kR,_(ve(ie))+" / "+_(ie.marshals.length)+" checked in ",1),Te(ie)>0?(v(),m("span",bR,_(Te(ie))+" tasks ",1)):D("",!0)])]),l("span",wR,_(b.value===ie.checkpointId?"":"+"),1)],10,fR),b.value===ie.checkpointId?(v(),m("div",CR,[l("div",LR,[Ne(ws,{locations:[{id:ie.checkpointId,name:ie.name,description:ie.description,latitude:ie.latitude,longitude:ie.longitude}],route:e.route,center:{lat:ie.latitude,lng:ie.longitude},zoom:16,"highlight-location-id":ie.checkpointId,"marshal-mode":!0},null,8,["locations","route","center","highlight-location-id"])]),l("div",SR,[l("div",xR,_(V(i).people)+" ("+_(ie.marshals.length)+")",1),ie.marshals.length===0?(v(),m("div",$R," No "+_(V(s).people)+" assigned to this "+_(V(s).checkpoint)+". ",1)):(v(),m("div",IR,[(v(!0),m(we,null,Pe(ie.marshals,B=>(v(),m("div",{key:B.marshalId,class:_e(["marshal-card",{"is-checked-in":B.isCheckedIn}]),onClick:j=>fe(B,ie)},[l("div",MR,[l("div",AR,[l("span",ER,_(B.name),1),B.outstandingTaskCount>0?(v(),m("span",PR,_(B.outstandingTaskCount)+" tasks ",1)):D("",!0)]),l("div",DR,[l("div",{class:_e(["check-status",{"checked-in":B.isCheckedIn}])},_(B.isCheckedIn?" Checked In":"Not Checked In"),3),l("button",{onClick:gt(j=>Be(B),["stop"]),class:_e(["quick-checkin-btn",{"undo-btn":B.isCheckedIn}]),disabled:T.value===B.marshalId},_(T.value===B.marshalId?"...":B.isCheckedIn?"Undo":"Check In"),11,OR)])]),B.isCheckedIn&&B.checkInTime?(v(),m("div",RR,[Ve(_(Me(B.checkInTime))+" ",1),B.checkInMethod?(v(),m("span",BR," ("+_(ye(B.checkInMethod))+")",1)):D("",!0)])):D("",!0),B.lastAccessedAt?(v(),m("div",NR," Last active: "+_(ue(B.lastAccessedAt)),1)):D("",!0)],10,TR))),128))]))]),ie.outstandingTaskCount>0?(v(),m("div",FR,[l("div",UR,"Outstanding "+_(V(s).checkpoint)+" tasks ("+_(ie.outstandingTaskCount)+")",1),l("div",zR,[(v(!0),m(we,null,Pe(ie.outstandingTasks,B=>(v(),m("div",{key:B.itemId,class:"task-item"},[l("input",{type:"checkbox",disabled:I.value,onChange:j=>re(B,ie)},null,40,HR),l("span",VR,_(B.text),1)]))),128))])])):D("",!0)])):D("",!0)]))),128))])),l("div",GR,[l("button",{class:_e(["incidents-accordion-header",{active:k.value}]),onClick:se},[l("div",ZR,[ee[2]||(ee[2]=l("span",{class:"incidents-title"},"Incidents",-1)),K.value>0?(v(),m("span",jR,_(K.value)+" open ",1)):D("",!0)]),l("span",WR,_(k.value?"":"+"),1)],2),k.value?(v(),m("div",qR,[w.value?(v(),m("div",KR," Loading incidents... ")):C.value.length===0?(v(),m("div",YR,[...ee[3]||(ee[3]=[l("p",null,"No incidents reported in your areas.",-1)])])):(v(),m("div",JR,[(v(!0),m(we,null,Pe(C.value,ie=>(v(),et(rr,{key:ie.incidentId,incident:ie,onSelect:me},null,8,["incident"]))),128))]))])):D("",!0)]),Ne($u,{show:G.value,incident:M.value,"can-manage":!0,onClose:Re,onStatusChange:Oe,onAddNote:de},null,8,["show","incident"]),Ne(Dt,{show:E.value,title:A.value?.name||"Marshal Details",size:"large",onClose:xe},{actions:Qe(()=>[l("button",{onClick:xe,class:"btn btn-secondary"},"Close")]),default:Qe(()=>[A.value?(v(),m("div",XR,[l("div",QR,[ee[6]||(ee[6]=l("h4",null,"Contact Details",-1)),l("div",e8,[A.value.email?(v(),m("div",t8,[ee[4]||(ee[4]=l("span",{class:"contact-label"},"Email:",-1)),l("a",{href:`mailto:${A.value.email}`},_(A.value.email),9,n8)])):D("",!0),A.value.phoneNumber?(v(),m("div",o8,[ee[5]||(ee[5]=l("span",{class:"contact-label"},"Phone:",-1)),l("a",{href:`tel:${A.value.phoneNumber}`},_(A.value.phoneNumber),9,s8)])):D("",!0),!A.value.email&&!A.value.phoneNumber?(v(),m("div",i8," No contact details available. ")):D("",!0)])]),l("div",a8,[ee[10]||(ee[10]=l("h4",null,"Check-in Status",-1)),A.value.isCheckedIn?(v(),m("div",r8,[l("div",l8,[ee[8]||(ee[8]=l("span",{class:"check-icon"},"",-1)),l("div",null,[ee[7]||(ee[7]=l("strong",null,"Checked In",-1)),l("p",c8,_($e(A.value.checkInTime)),1),A.value.checkInMethod?(v(),m("p",u8," Method: "+_(ye(A.value.checkInMethod)),1)):D("",!0)])]),l("button",{onClick:ee[0]||(ee[0]=ie=>Be(A.value,$.value)),class:"btn btn-secondary undo-checkin-btn",disabled:T.value===A.value.marshalId},_(T.value===A.value.marshalId?"Undoing...":"Undo Check-in"),9,d8)])):(v(),m("div",h8,[ee[9]||(ee[9]=l("div",{class:"not-checked-in"},[l("span",{class:"not-checked-icon"},""),l("span",null,"Not checked in")],-1)),l("button",{onClick:ee[1]||(ee[1]=ie=>Be(A.value,$.value)),class:"btn btn-primary check-in-btn",disabled:T.value===A.value.marshalId},_(T.value===A.value.marshalId?"Checking in...":"Check In"),9,f8)])),A.value.lastAccessedAt?(v(),m("div",p8," Last active: "+_(ue(A.value.lastAccessedAt)),1)):D("",!0)]),l("div",v8,[l("h4",null,_(V(i).checklists)+" ("+_(A.value.outstandingTasks?.length||0)+" outstanding)",1),!A.value.outstandingTasks||A.value.outstandingTasks.length===0?(v(),m("div",m8," No outstanding tasks. ")):(v(),m("div",g8,[(v(!0),m(we,null,Pe(A.value.outstandingTasks,ie=>(v(),m("div",{key:ie.itemId,class:"task-item"},[l("input",{type:"checkbox",disabled:I.value,onChange:B=>Ee(ie)},null,40,y8),l("span",_8,_(ie.text),1)]))),128))]))]),l("div",k8,[l("div",b8,[A.value.phoneNumber?(v(),m("a",{key:0,href:`tel:${A.value.phoneNumber}`,class:"btn btn-primary"}," Call ",8,w8)):D("",!0),A.value.phoneNumber?(v(),m("a",{key:1,href:`sms:${A.value.phoneNumber}`,class:"btn btn-secondary"}," Text ",8,C8)):D("",!0),A.value.email?(v(),m("a",{key:2,href:`mailto:${A.value.email}`,class:"btn btn-secondary"}," Email ",8,L8)):D("",!0)])])])):D("",!0)]),_:1},8,["show","title"])]))}},x8=Ye(S8,[["__scopeId","data-v-2d8926ef"]]),$8={class:"offline-indicator-container"},I8={key:0,class:"offline-banner"},T8={class:"offline-text"},M8={key:0,class:"last-sync"},A8={class:"pending-text"},E8={key:0,class:"pending-subtext"},P8={key:1,class:"syncing-text"},D8={__name:"OfflineIndicator",setup(e){const{isOnline:t,isFullyOnline:o,pendingActionsCount:i,lastSyncTime:s,syncStatus:a,syncError:c,forcSync:u}=Iu(),d=P(!1),p=P(""),f=P(""),y=Y(()=>{if(!s.value)return"";const I=new Date(s.value),S=new Date-I,O=Math.floor(S/6e4),E=Math.floor(O/60);return O<1?"just now":O<60?`${O}m ago`:E<24?`${E}h ago`:I.toLocaleDateString()}),b=async()=>{await u()};return We(a,I=>{I==="success"&&i.value===0?(p.value="All actions synced successfully!",f.value="success",d.value=!0,setTimeout(()=>{d.value=!1},3e3)):I==="error"&&(p.value=c.value||"Sync failed",f.value="error",d.value=!0,setTimeout(()=>{d.value=!1},5e3))}),(I,T)=>(v(),m("div",$8,[Ne(rc,{name:"slide"},{default:Qe(()=>[V(o)?D("",!0):(v(),m("div",I8,[T[0]||(T[0]=l("span",{class:"offline-icon"},[l("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"})])],-1)),l("span",T8,_(V(t)?"Server unavailable":"You're offline"),1),V(s)?(v(),m("span",M8," Last synced: "+_(y.value),1)):D("",!0)]))]),_:1}),Ne(rc,{name:"fade"},{default:Qe(()=>[V(i)>0?(v(),m("div",{key:0,class:_e(["pending-banner",{"offline-pending":!V(o)}])},[T[1]||(T[1]=l("span",{class:"pending-icon"},[l("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})])],-1)),l("span",A8,[Ve(_(V(i))+" pending action"+_(V(i)!==1?"s":"")+" ",1),V(o)?D("",!0):(v(),m("span",E8,"(will sync when online)"))]),V(o)&&V(a)!=="syncing"?(v(),m("button",{key:0,onClick:b,class:"sync-button"}," Sync Now ")):V(a)==="syncing"?(v(),m("span",P8,"Syncing...")):D("",!0)],2)):D("",!0)]),_:1}),Ne(rc,{name:"fade"},{default:Qe(()=>[d.value?(v(),m("div",{key:0,class:_e(["sync-toast",f.value])},_(p.value),3)):D("",!0)]),_:1})]))}},O8=Ye(D8,[["__scopeId","data-v-61340ead"]]),R8={key:0,class:"header-logo-cover"},B8=["src"],N8=["title"],F8=["innerHTML"],U8={key:2,class:"header-logo header-logo-left"},z8=["src"],H8={class:"header-center"},V8={key:0},G8={key:1,class:"header-event-date"},Z8={key:0,class:"header-actions"},j8={key:3,class:"header-logo header-logo-right"},W8=["src"],q8=["title"],K8=["innerHTML"],Y8={class:"container"},J8={key:0,class:"selection-card"},X8={key:1,class:"selection-card"},Q8={key:0,class:"loading"},eB={key:2,class:"selection-card error-card"},tB={class:"error"},nB={key:3,class:"dashboard"},oB={key:0,class:"welcome-bar"},sB={class:"welcome-info"},iB={key:0,class:"welcome-email"},aB={key:0,class:"mode-switch"},rB={key:1,class:"mode-switch"},lB={class:"accordion"},cB={class:"accordion-section"},uB={class:"accordion-title"},dB=["innerHTML"],hB={key:0,class:"location-status active"},fB={key:1,class:"location-status"},pB={class:"accordion-icon"},vB={key:0,class:"accordion-content map-content"},mB={key:0,class:"map-selection-banner"},gB={class:"map-wrapper"},yB={class:"accordion-section"},_B={class:"accordion-title"},kB=["innerHTML"],bB={class:"accordion-icon"},wB={key:0,class:"accordion-content assignments-accordion-content"},CB={key:0,class:"empty-state"},LB={key:1,class:"checkpoint-accordion"},SB=["onClick"],xB={class:"checkpoint-header-content"},$B={class:"checkpoint-title-row"},IB=["innerHTML"],TB={key:0,class:"checkpoint-check-icon"},MB={class:"checkpoint-name"},AB={key:1,class:"area-badge"},EB={key:2,class:"checkpoint-time-badge"},PB={key:0,class:"checkpoint-description-preview"},DB={class:"accordion-icon"},OB={key:0,class:"checkpoint-accordion-content"},RB={key:0,class:"checkpoint-mini-map"},BB=["onClick"],NB={class:"checkpoint-marshals"},FB={class:"marshals-label"},UB={class:"marshals-list"},zB={key:0,class:"check-badge"},HB={key:1,class:"checkpoint-area-contacts"},VB={class:"marshals-label"},GB={class:"contact-list"},ZB={class:"contact-info"},jB={class:"contact-name"},WB={key:0,class:"contact-role"},qB={key:1,class:"contact-detail"},KB={key:2,class:"contact-detail"},YB={class:"contact-actions"},JB=["href"],XB=["href"],QB=["href"],eN={key:2,class:"checked-in-status"},tN={class:"check-time"},nN={key:3,class:"check-in-actions"},oN=["onClick","disabled"],sN=["onClick","disabled"],iN={key:4,class:"error"},aN={key:5,class:"dynamic-location-section"},rN={class:"dynamic-location-header"},lN={class:"dynamic-badge"},cN={key:0,class:"last-update"},uN={class:"dynamic-location-actions"},dN=["onClick","disabled"],hN=["onClick","title"],fN={class:"accordion-section"},pN={class:"accordion-title"},vN=["innerHTML"],mN={class:"accordion-icon"},gN={key:0,class:"accordion-content"},yN={key:0,class:"loading"},_N={key:1,class:"error"},kN={key:2,class:"empty-state"},bN={key:3,class:"checklist-items"},wN={class:"item-checkbox"},CN=["checked","disabled","onChange"],LN={class:"item-content"},SN={key:0,class:"item-context"},xN={key:1,class:"completion-info"},$N={class:"completion-text"},IN={class:"completion-time"},TN={key:0,class:"accordion-section"},MN={class:"accordion-title"},AN=["innerHTML"],EN={class:"accordion-icon"},PN={key:0,class:"accordion-content"},DN={key:0,class:"loading"},ON={key:1,class:"contact-list"},RN={class:"contact-info"},BN={class:"contact-name-row"},NN={key:0,class:"primary-badge"},FN={class:"contact-name"},UN={key:1,class:"contact-role-badge"},zN={key:0,class:"contact-notes-text"},HN={key:1,class:"contact-detail"},VN={key:2,class:"contact-detail"},GN={class:"contact-actions"},ZN=["href"],jN=["href"],WN=["href"],qN={class:"accordion-section"},KN={class:"accordion-title"},YN=["innerHTML"],JN={class:"accordion-icon"},XN={key:0,class:"accordion-content"},QN={key:1,class:"accordion-section"},eF={class:"accordion-title"},tF=["innerHTML"],nF={key:0,class:"incidents-badge-count"},oF={class:"accordion-icon"},sF={key:0,class:"accordion-content"},iF={key:0,class:"loading-state"},aF={key:1,class:"empty-state"},rF={key:2,class:"incidents-list"},lF={key:2,class:"accordion-section"},cF={class:"accordion-title"},uF=["innerHTML"],dF={key:0,class:"area-lead-badges"},hF={class:"accordion-icon"},fF={key:0,class:"accordion-content area-lead-accordion-content"},pF={key:3,class:"accordion-section"},vF={class:"accordion-title"},mF=["innerHTML"],gF={class:"accordion-icon"},yF={key:0,class:"accordion-content"},_F={class:"event-details"},kF={key:0,class:"event-detail-row"},bF={class:"detail-value"},wF={key:1,class:"event-description"},CF={class:"detail-value"},LF={class:"add-note-form"},SF={class:"modal-actions"},xF=["disabled"],$F={class:"modal-content check-in-reminder-modal"},IF={class:"modal-header warning"},TF={class:"modal-body"},MF={class:"reminder-message"},AF={key:0},EF={class:"reminder-hint"},PF={class:"modal-footer"},DF={class:"modal-content location-update-modal"},OF={class:"modal-header"},RF={class:"modal-body"},BF={key:0,class:"success-message"},NF={key:1},FF={class:"modal-description"},UF={key:0,class:"last-update-info"},zF={key:1,class:"gps-status active"},HF={class:"update-option"},VF=["disabled"],GF={class:"update-option auto-update-option"},ZF={class:"checkbox-label"},jF=["checked"],WF={class:"option-hint"},qF={class:"update-option"},KF=["disabled"],YF={class:"update-option"},JF={class:"option-label"},XF={key:0,class:"checkpoint-list"},QF=["onClick","disabled"],e7={key:1,class:"no-checkpoints"},t7={key:2,class:"error"},n7={key:2,class:"fullscreen-map-overlay"},o7={key:0,class:"fullscreen-map-banner"},s7={key:1,class:"fullscreen-map-container"},i7={key:2,class:"fullscreen-map-container"},a7={key:3,class:"fullscreen-map-actions"},r7=6e4,l7={__name:"MarshalView",setup(e){const{terms:t,termsLower:o}=Lt(),{updatePendingCount:i}=Iu(),s=_u(),a=tr(),c=Y(()=>s.params.eventId),u=P(!1),d=P(!1),p=P(null),f=P(null),y=P(null),b=P(null),I=Y(()=>b.value?.eventRoles?b.value.eventRoles.filter(H=>H.role==="EventAreaLead").flatMap(H=>H.areaIds||[]):[]),T=Y(()=>I.value.length>0);Y(()=>{const Z=new Map;for(const H of gn.value)H.location&&Z.set(H.location.id,{id:H.location.id,name:H.location.name,description:H.location.description,order:H.location.order??999});if(T.value)for(const H of w.value){if(Z.has(H.id))continue;(H.areaIds||H.AreaIds||[]).some(Le=>I.value.includes(Le))&&Z.set(H.id,{id:H.id,name:H.name,description:H.description,order:H.order??999})}return Array.from(Z.values()).sort((H,Q)=>H.order!==Q.order?H.order-Q.order:(H.name||"").localeCompare(Q.name||"",void 0,{numeric:!0,sensitivity:"base"}))});const S=Y(()=>{const Z=gn.value.find(Q=>Q.isCheckedIn&&!Ms(Q.checkInTime)&&Q.location);if(Z?.location)return{id:Z.location.id,locationId:Z.location.id,name:Z.location.name,description:Z.location.description};if(An.value){const Q=gn.value.find(Le=>Le.id===An.value);if(Q?.location)return{id:Q.location.id,locationId:Q.location.id,name:Q.location.name,description:Q.location.description}}const H=gn.value[0];return H?.location?{id:H.location.id,locationId:H.location.id,name:H.location.name,description:H.location.description}:null}),O=Y(()=>b.value?.eventRoles?b.value.eventRoles.some(Z=>Z.role==="EventAdmin"):!1),E=Y(()=>b.value?.authMethod==="SecureEmailLink"&&O.value),A=Y(()=>b.value?.authMethod==="MarshalMagicCode"&&O.value),$=()=>{a.push(`/admin/events/${s.params.eventId}`)},C=P(null),w=P([]),k=P([]),M=P([]),G=P(!0),ne=Y(()=>{const Z=C.value?.brandingPageGradientStart||Bn.pageGradientStart,H=C.value?.brandingPageGradientEnd||Bn.pageGradientEnd;return{background:`linear-gradient(135deg, ${Z} 0%, ${H} 100%)`}}),ce=Y(()=>{const Z=C.value?.brandingHeaderGradientStart||Bn.headerGradientStart,H=C.value?.brandingHeaderGradientEnd||Bn.headerGradientEnd;return{background:`linear-gradient(135deg, ${Z} 0%, ${H} 100%)`}}),K=Y(()=>{const Z=C.value?.brandingHeaderGradientStart||Bn.headerGradientStart,H=C.value?.brandingHeaderGradientEnd||Bn.headerGradientEnd;return Qp(Z,H)}),se=Y(()=>C.value?.brandingAccentColor||Bn.accentColor),me=Y(()=>Xp(se.value)),Re=Y(()=>({background:se.value,color:me.value})),Oe=Y(()=>C.value?.brandingLogoUrl||""),de=Y(()=>C.value?.brandingLogoPosition||"left"),he=P("assignments"),ve=P({checklist:0,notes:0,incidents:0,eventContacts:0}),Te=P(null),fe=P(null),xe=P(null),Be=P([]),re=P(!1),Ee=P(null),Me=P(!1),$e=P([]),ue=P([]),ye=P(!1),z=P(null),ee=P(!1),ie=P(!1),B=P(""),j=P(!1),X=Y(()=>ue.value.filter(Z=>Z.status==="open"||Z.status==="acknowledged"||Z.status==="in_progress").length),q=P(!1),F=P(null),N=P(null),W=P(null),ge=P(!1),Se=P(!1);let Ce=null,ze=null;const Fe=P(null),je=P(!1),Je=P(!1),ae=P(!1),oe=P(!1),J=P(""),Ze=P(""),Xe=P(null),rt=P(!1),ft=P(""),vt=P(""),pt=P(!1),ht=P(null),Ht=P(new Set),St=P(null),qt=P(null),Ms=Z=>{if(!Z)return!0;const H=new Date(Z);return(new Date-H)/(1e3*60*60)>24},Bt=P(null),Rt=P(null);let Qn=null;const Kt=Z=>{const H=he.value===Z;if(he.value=H?null:Z,!H){const Q=Date.now(),Le=He=>Q-ve.value[He]>r7;switch(Z){case"checklist":Le("checklist")&&Yo();break;case"notes":Le("notes")&&Os();break;case"incidents":Le("incidents")&&Rs();break;case"eventContacts":Le("eventContacts")&&Pi();break}}},An=P(null),si=Z=>{An.value=An.value===Z?null:Z};We(()=>k.value,Z=>{Z.length===1&&An.value===null&&(An.value=Z[0].id)},{immediate:!0});const gn=Y(()=>k.value.map(Z=>{const H=w.value.find(Dn=>Dn.id===Z.locationId),Q=H?.areaIds||H?.AreaIds||[];let Le=null;Q.length>0&&M.value.length>0&&(Le=M.value.find(Cn=>Q.includes(Cn.id))?.name);const st=(H?.assignments||[]).map(Dn=>({...Dn,effectiveIsCheckedIn:Dn.isCheckedIn&&!Ms(Dn.checkInTime)})),jt=yn.value.filter(Dn=>Q.includes(Dn.areaId)),nt=Z.isCheckedIn&&!Ms(Z.checkInTime);return{...Z,location:H,areaName:Le,areaIds:Q,allMarshals:st,areaContacts:jt,locationName:H?.name||"Unknown Location",effectiveIsCheckedIn:nt}})),xo=Y(()=>k.value.length>0?k.value[0]:null),eo=Y(()=>k.value.map(Z=>Z.locationId)),sn=Y(()=>gn.value.some(Z=>Z.location?.isDynamic||Z.location?.IsDynamic)),en=Y(()=>gn.value.find(Z=>Z.location?.isDynamic||Z.location?.IsDynamic)),As=Y(()=>{if(!C.value||!gn.value.length)return[];const Z=new Date,H=C.value.eventDate?new Date(C.value.eventDate):null;return gn.value.filter(Q=>{if(Q.effectiveIsCheckedIn||Ht.value.has(Q.id))return!1;const Le=Q.location;if(!Le)return!1;const He=Le.startTime?new Date(Le.startTime):H;if(!He)return!1;let st;if(Le.endTime)st=new Date(Le.endTime);else if(H)st=new Date(H.getTime()+7200*1e3);else return!1;return Z>=He&&Z<st})});We(As,Z=>{Z.length>0&&!pt.value&&(ht.value=Z[0],pt.value=!0)},{immediate:!0});const $o=Z=>{Ht.value.add(Z),pt.value=!1,ht.value=null},ii=(Z,H=null)=>{St.value=Z,qt.value=H,document.body.style.overflow="hidden"},Yt=()=>{St.value=null,qt.value=null,document.body.style.overflow=""},qe=Y(()=>C.value?.route?(typeof C.value.route=="string"?JSON.parse(C.value.route):C.value.route)||[]:[]),co=Y(()=>!xo.value||!w.value.length?null:w.value.find(Z=>Z.id===xo.value.locationId)),uo=Y(()=>Be.value.filter(Z=>Z.isCompleted&&["OnePerCheckpoint","OnePerArea","OneLeadPerArea"].includes(Z.matchedScope)?Z.completedByActorId===y.value:!0)),ho=Y(()=>uo.value.filter(Z=>Z.isCompleted).length),En=P([]),Gt=P(!1),to=Y(()=>En.value),Hn=Y(()=>{const Z=["EmergencyContact","EventDirector","MedicalLead","SafetyOfficer"];return En.value.filter(H=>Z.includes(H.role))}),Es=Y(()=>$e.value.filter(Z=>{const H=Z.priority||Z.Priority;return H==="Emergency"||H==="Urgent"})),yn=P([]);Y(()=>{if(yn.value.length===0)return[];const Z={};for(const H of yn.value){const Q=H.areaId||"unknown";Z[Q]||(Z[Q]={areaId:H.areaId,areaName:H.areaName||"Unknown Area",contacts:[]}),Z[Q].contacts.push(H)}return Object.values(Z)}),Y(()=>yn.value.length);const Ps=(Z,H)=>Z.localeCompare(H,void 0,{numeric:!0,sensitivity:"base"}),qo=Y(()=>{if(!F.value)return[];const Z=F.value.locationId;return w.value.filter(H=>H.id!==Z&&H.latitude!==0&&H.longitude!==0).sort((H,Q)=>Ps(H.name,Q.name))}),Ds=Y(()=>co.value?{lat:co.value.latitude,lng:co.value.longitude}:Bt.value?Bt.value:w.value.length>0?{lat:w.value[0].latitude,lng:w.value[0].longitude}:{lat:51.505,lng:-.09}),_n=async(Z,H)=>{d.value=!0,p.value=null,console.log("Authenticating with magic code:",{eventId:Z,code:H});try{const Q=await Zo.marshalLogin(Z,H);if(console.log("Auth response:",Q.data),Q.data.success){localStorage.setItem("sessionToken",Q.data.sessionToken),localStorage.setItem(`marshal_${Z}`,Q.data.marshalId),f.value=Q.data.person,y.value=Q.data.marshalId,u.value=!0,console.log("Authenticated as marshal:",y.value,f.value?.name);try{const Le=await Zo.getMe(Z);b.value=Le.data,console.log("User claims:",b.value)}catch(Le){console.warn("Failed to fetch claims:",Le)}a.replace({path:s.path,query:{}}),Nt(),await Vn()}else p.value=Q.data.message||"Authentication failed"}catch(Q){console.error("Authentication failed:",Q),p.value=Q.response?.data?.message||"Invalid or expired login link"}finally{d.value=!1}},Io=async Z=>{const H=localStorage.getItem("sessionToken"),Q=localStorage.getItem(`marshal_${Z}`);if(!H||!Q)return!1;try{const Le=await Zo.getMe(Z);if(Le.data&&Le.data.marshalId)return b.value=Le.data,f.value={personId:Le.data.personId,name:Le.data.personName,email:Le.data.personEmail},y.value=Le.data.marshalId,u.value=!0,Nt(),!0}catch{localStorage.removeItem("sessionToken"),localStorage.removeItem(`marshal_${Z}`)}return!1},Vn=async()=>{const Z=s.params.eventId;if(console.log("Loading event data for:",{eventId:Z,marshalId:y.value}),dn()){console.log("Offline mode detected, attempting to load from cache...");const He=await Qs(Z);if(He){if(console.log("Loaded cached data from:",He.cachedAt),C.value=He.event,M.value=He.areas||[],w.value=He.locations||[],Be.value=He.checklist||[],En.value=He.contacts||[],$e.value=He.notes||[],C.value&&Wc(C.value),y.value){const st=[];for(const jt of w.value){const nt=jt.assignments?.find(Dn=>Dn.marshalId===y.value);nt&&st.push(nt)}k.value=st}return}else console.warn("No cached data available while offline")}console.log("Fetching event data in parallel...");const[H,Q,Le]=await Promise.allSettled([bi.getById(Z),Ys.getByEvent(Z),$a.getEventStatus(Z)]);if(H.status==="fulfilled"?(C.value=H.value.data,console.log("Event loaded:",C.value?.name),C.value&&Wc(C.value)):console.error("Failed to load event:",H.reason),Q.status==="fulfilled"?(M.value=Q.value.data||[],console.log("Areas loaded:",M.value.length)):console.error("Failed to load areas:",Q.reason),Le.status==="fulfilled"){if(w.value=Le.value.data?.locations||[],console.log("Locations loaded:",w.value.length),y.value){const He=[];for(const st of w.value){const jt=st.assignments?.find(nt=>nt.marshalId===y.value);jt&&He.push(jt)}k.value=He,console.log("Total assignments found:",k.value.length)}}else console.error("Failed to load event status:",Le.reason);await Promise.allSettled([Yo(),Pi(),Os(),Rs()]);try{const He=JSON.parse(JSON.stringify({event:C.value,areas:M.value,locations:w.value,checklist:Be.value,contacts:En.value,notes:$e.value,marshalId:y.value}));await qa(Z,He),console.log("Event data cached for offline access")}catch(He){console.warn("Failed to cache event data:",He)}es()},Ko=async()=>{const Z=s.params.eventId;if(dn()){console.log("Skipping background preload: offline");return}console.log("Starting background preload for offline data...");try{const H=await Ys.getAreaLeadDashboard(Z);if(H.data){const Q=JSON.parse(JSON.stringify({areas:H.data.areas||[],checkpoints:H.data.checkpoints||[]}));await Qs(Z)?await xa(Z,"areaLeadDashboard",Q):await qa(Z,{areaLeadDashboard:Q}),console.log("Area lead dashboard cached for offline access")}}catch(H){H.response?.status!==403&&console.warn("Failed to preload area lead dashboard:",H)}console.log("Background preload complete")},Os=async()=>{const Z=s.params.eventId;try{const H=await ps.getMyNotes(Z);$e.value=H.data||[],ve.value.notes=Date.now(),console.log("Notes loaded:",$e.value.length)}catch(H){console.error("Failed to load notes:",H)}},Rs=async()=>{const Z=s.params.eventId;ye.value=!0;try{const H=new Map;if(T.value&&I.value.length>0)for(const Q of I.value)try{const He=(await Yn.getForArea(Z,Q)).data.incidents||[];for(const st of He)H.set(st.incidentId,st)}catch(Le){console.warn(`Failed to load incidents for area ${Q}:`,Le)}try{const Le=(await Yn.getAll(Z)).data.incidents||[];for(const He of Le)He.reportedBy?.marshalId===y.value&&H.set(He.incidentId,He)}catch(Q){console.debug("Could not load all incidents:",Q)}ue.value=Array.from(H.values()).sort((Q,Le)=>new Date(Le.incidentTime||Le.createdAt)-new Date(Q.incidentTime||Q.createdAt)),ve.value.incidents=Date.now(),console.log("My incidents loaded:",ue.value.length)}catch(H){console.error("Failed to load incidents:",H)}finally{ye.value=!1}},Pi=async()=>{const Z=s.params.eventId;Gt.value=!0;try{const H=await Wi.getMyContacts(Z);En.value=H.data||[],ve.value.eventContacts=Date.now(),console.log("Contacts loaded:",En.value.length)}catch(H){console.warn("Failed to load contacts:",H),En.value=[]}finally{Gt.value=!1}},Yo=async()=>{if(!y.value){console.warn("No marshal ID, skipping checklist load");return}re.value=!0,Ee.value=null;try{console.log("Fetching checklist for marshal:",y.value);const Z=await Ot.getMarshalChecklist(s.params.eventId,y.value);Be.value=Z.data||[],ve.value.checklist=Date.now(),console.log("Checklist loaded:",Be.value.length,"items")}catch(Z){console.error("Failed to load checklist:",Z.response?.status,Z.response?.data),Ee.value=Z.response?.data?.message||"Failed to load checklist"}finally{re.value=!1}},ai=async Z=>{if(Me.value)return;Me.value=!0;const H=s.params.eventId,Q={marshalId:y.value,contextType:Z.completionContextType,contextId:Z.completionContextId};try{Z.isCompleted?dn()?(await Kn("checklist_uncomplete",{eventId:H,itemId:Z.itemId,data:Q}),Z.isCompleted=!1,Z.completedAt=null,Z.completedByActorName=null,await i()):(await Ot.uncomplete(H,Z.itemId,Q),await Yo()):dn()?(await Kn("checklist_complete",{eventId:H,itemId:Z.itemId,data:Q}),Z.isCompleted=!0,Z.completedAt=new Date().toISOString(),Z.completedByActorName=f.value?.name||"You",await i()):(await Ot.complete(H,Z.itemId,Q),await Yo()),await xa(H,"checklist",Be.value)}catch(Le){if(console.error("Failed to toggle checklist item:",Le),dn()||!Le.response){const He=Z.isCompleted?"checklist_uncomplete":"checklist_complete";await Kn(He,{eventId:H,itemId:Z.itemId,data:Q}),Z.isCompleted=!Z.isCompleted,await i()}else Ee.value=Le.response?.data?.message||"Failed to update checklist",setTimeout(()=>{Ee.value=null},3e3)}finally{Me.value=!1}},To=Z=>{if(!Z.completionContextType||!Z.completionContextId)return null;if(Z.completionContextType==="Checkpoint"){const H=w.value.find(Le=>Le.id===Z.completionContextId);if(!H)return null;const Q=H.description?` - ${H.description}`:"";return`At ${o.value.checkpoint} ${H.name}${Q}`}if(Z.completionContextType==="Area"){const H=M.value.find(Q=>Q.id===Z.completionContextId);return H?`At ${o.value.area} ${H.name}`:null}return Z.completionContextType==="Personal"?"Personal item":null},Bs=()=>{if(!("geolocation"in navigator)){console.warn("Geolocation not supported");return}console.log("Starting location tracking..."),Qn=navigator.geolocation.watchPosition(Z=>{Bt.value={lat:Z.coords.latitude,lng:Z.coords.longitude},Rt.value=Date.now()},Z=>{console.warn("Geolocation error:",{1:"Location permission denied. Please allow location access in your browser settings.",2:"Location unavailable. Make sure GPS is enabled on your device.",3:"Location request timed out. Please try again."}[Z.code]||Z.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},ri=()=>{Qn!==null&&(navigator.geolocation.clearWatch(Qn),Qn=null)},Mo=async Z=>{Te.value=Z.id,fe.value=Z.id,xe.value=null;const H=s.params.eventId;try{if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const Q=await new Promise((He,st)=>{navigator.geolocation.getCurrentPosition(He,st,{enableHighAccuracy:!0,timeout:1e4})}),Le={eventId:H,assignmentId:Z.id,latitude:Q.coords.latitude,longitude:Q.coords.longitude,manualCheckIn:!1};if(dn()){await Kn("checkin",Le);const He=k.value.findIndex(st=>st.id===Z.id);He!==-1&&(k.value[He]={...k.value[He],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"GPS (pending)",checkInLatitude:Q.coords.latitude,checkInLongitude:Q.coords.longitude}),await i(),await xa(H,"locations",w.value)}else{const He=await ks.checkIn(Le),st=k.value.findIndex(jt=>jt.id===Z.id);st!==-1&&(k.value[st]=He.data)}}catch(Q){if(dn()||!Q.response){const Le={eventId:H,assignmentId:Z.id,latitude:Bt.value?.lat||null,longitude:Bt.value?.lng||null,manualCheckIn:!0};await Kn("checkin",Le);const He=k.value.findIndex(st=>st.id===Z.id);He!==-1&&(k.value[He]={...k.value[He],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"Manual (pending)"}),await i()}else Q.response?.data?.message?xe.value=Q.response.data.message:Q.message?xe.value=Q.message:xe.value="Failed to check in. Please try manual check-in."}finally{Te.value=null,fe.value=null}},yt=Z=>{J.value="Manual Check-In",Ze.value="Are you sure you want to check in manually? This should only be used if GPS is not available.",Xe.value=async()=>{Te.value=Z.id,fe.value=Z.id,xe.value=null;const H=s.params.eventId,Q={eventId:H,assignmentId:Z.id,latitude:null,longitude:null,manualCheckIn:!0};try{if(dn()){await Kn("checkin",Q);const Le=k.value.findIndex(He=>He.id===Z.id);Le!==-1&&(k.value[Le]={...k.value[Le],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"Manual (pending)"}),await i(),await xa(H,"locations",w.value)}else{const Le=await ks.checkIn(Q),He=k.value.findIndex(st=>st.id===Z.id);He!==-1&&(k.value[He]=Le.data)}}catch(Le){if(dn()||!Le.response){await Kn("checkin",Q);const He=k.value.findIndex(st=>st.id===Z.id);He!==-1&&(k.value[He]={...k.value[He],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"Manual (pending)"}),await i()}else xe.value="Failed to check in manually. Please contact the admin."}finally{Te.value=null,fe.value=null}},oe.value=!0},$t=()=>{oe.value=!1,Xe.value&&(Xe.value(),Xe.value=null)},Ns=()=>{oe.value=!1,Xe.value=null},Gn=(Z,H)=>{ft.value=Z,vt.value=H,rt.value=!0},Ao=()=>{rt.value=!1},Pt=async Z=>{ae.value=!0;try{await Yn.create(c.value,Z),Je.value=!1,Rs(),Gn("Incident Reported","An administrator will review it shortly.")}catch(H){console.error("Failed to report incident:",H),Gn("Error",H.response?.data?.message||"Failed to report incident. Please try again.")}finally{ae.value=!1}},ct=Z=>{z.value=Z,ee.value=!0},Mt=async({incidentId:Z,status:H})=>{try{await Yn.updateStatus(c.value,Z,{status:H});const Q=ue.value.find(Le=>Le.incidentId===Z);Q&&(Q.status=H),z.value?.incidentId===Z&&(z.value.status=H)}catch(Q){console.error("Failed to update incident status:",Q),Gn("Error","Failed to update status. Please try again.")}},Fs=()=>{B.value="",ie.value=!0},Eo=()=>{ie.value=!1,B.value=""},an=async()=>{if(!(!B.value.trim()||!z.value)){j.value=!0;try{await Yn.addNote(c.value,z.value.incidentId,B.value.trim()),Eo(),Rs();const Z=await Yn.get(c.value,z.value.incidentId);z.value=Z.data}catch(Z){console.error("Failed to add note:",Z),Gn("Error","Failed to add note. Please try again.")}finally{j.value=!1}}},rn=Z=>{F.value=Z,N.value=null,W.value=null,q.value=!0},kn=()=>{q.value=!1,F.value=null,N.value=null,W.value=null,At.value=!1},At=P(!1),It=()=>{At.value=!0,q.value=!1,he.value="map"},tn=Z=>{if(At.value&&F.value){Pn(F.value.locationId,Z.lat,Z.lng,"manual"),At.value=!1,F.value=null;return}if(sn.value&&en.value){const H=en.value;J.value="Update location",Ze.value=`Update ${H.location?.name||"dynamic checkpoint"} to this location?`,Xe.value=async()=>{await Pn(H.locationId,Z.lat,Z.lng,"manual")},oe.value=!0}},ln=Z=>{if(!At.value&&sn.value&&en.value){const H=en.value;if(Z.id===H.locationId)return;J.value="Copy location",Ze.value=`Copy location from "${Z.name}" to ${H.location?.name||"your dynamic checkpoint"}?`,Xe.value=async()=>{await Pn(H.locationId,Z.latitude,Z.longitude,"checkpoint",Z.id)},oe.value=!0}},Pn=async(Z,H,Q,Le,He=null)=>{ge.value=!0;try{const st=s.params.eventId,jt={latitude:H,longitude:Q,sourceType:Le};He&&(jt.sourceCheckpointId=He);const nt=await Nn.updatePosition(st,Z,jt);nt.data.success&&(Se.value&&Ro(),Do(Z,nt.data.latitude,nt.data.longitude,nt.data.lastLocationUpdate))}catch(st){console.error("Failed to update location:",st),st.response?.status===403?alert("You do not have permission to update this location."):alert("Failed to update location. Please try again.")}finally{ge.value=!1}},Jo=()=>{At.value=!1,q.value=!0},Po=async()=>{if(F.value){ge.value=!0,N.value=null;try{let Z,H;if(Bt.value&&Rt.value&&Date.now()-Rt.value<3e4&&(Z=Bt.value.lat,H=Bt.value.lng),!Z||!H){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const st=await new Promise((jt,nt)=>{navigator.geolocation.getCurrentPosition(jt,nt,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4})});Z=st.coords.latitude,H=st.coords.longitude}const Q=s.params.eventId,Le=F.value.locationId,He=await Nn.updatePosition(Q,Le,{latitude:Z,longitude:H,sourceType:"gps"});He.data.success&&(W.value="Location updated successfully!",Do(Le,He.data.latitude,He.data.longitude,He.data.lastLocationUpdate),setTimeout(()=>kn(),1500))}catch(Z){console.error("Failed to update location with GPS:",Z),Z.response?.status===403?N.value="You do not have permission to update this location.":Z.code===1?N.value="Location access denied. Please enable location permissions.":Z.code===2?N.value="Unable to determine your location. Please try again.":Z.code===3||Z.message?.includes("Timeout")?N.value="GPS timed out. Please ensure location services are enabled and try again.":N.value="Failed to update location. Please try again."}finally{ge.value=!1}}},Us=async Z=>{if(!F.value)return;const H=w.value.find(Q=>Q.id===Z);if(!H){N.value="Source checkpoint not found.";return}ge.value=!0,N.value=null;try{const Q=s.params.eventId,Le=F.value.locationId,He=await Nn.updatePosition(Q,Le,{latitude:H.latitude,longitude:H.longitude,sourceType:"checkpoint",sourceCheckpointId:Z});He.data.success&&(Se.value&&Ro(),W.value=`Location copied from ${H.name}!`,Do(Le,He.data.latitude,He.data.longitude,He.data.lastLocationUpdate),setTimeout(()=>kn(),1500))}catch(Q){console.error("Failed to copy location from checkpoint:",Q),Q.response?.status===403?N.value="You do not have permission to update this location.":N.value="Failed to update location. Please try again."}finally{ge.value=!1}},Do=(Z,H,Q,Le)=>{const He=w.value.find(st=>st.id===Z);He&&(He.latitude=H,He.longitude=Q,He.lastLocationUpdate=Le)},Oo=Z=>{Se.value?Ro():Xo(Z)},Xo=Z=>{Se.value=!0,Qo(Z),Ce=setInterval(()=>{Qo(Z)},6e4)},Ro=()=>{Se.value=!1,Ce&&(clearInterval(Ce),Ce=null)},Qo=async Z=>{if(!(!Z||!("geolocation"in navigator)))try{const H=await new Promise((He,st)=>{navigator.geolocation.getCurrentPosition(He,st,{enableHighAccuracy:!0,timeout:15e3})}),Q=s.params.eventId,Le=Z.locationId;await Nn.updatePosition(Q,Le,{latitude:H.coords.latitude,longitude:H.coords.longitude,sourceType:"gps"}),Do(Le,H.coords.latitude,H.coords.longitude,new Date().toISOString())}catch(H){console.warn("Auto-update location failed:",H)}},es=()=>{ze||!w.value.some(H=>H.isDynamic||H.IsDynamic)||(ze=setInterval(async()=>{try{const H=s.params.eventId,Q=await Nn.getDynamicCheckpoints(H);if(Q.data&&Array.isArray(Q.data))for(const Le of Q.data){const He=w.value.find(st=>st.id===Le.checkpointId);He&&(He.latitude=Le.latitude,He.longitude=Le.longitude,He.lastLocationUpdate=Le.lastLocationUpdate)}}catch(H){console.warn("Failed to poll dynamic checkpoints:",H)}},6e4))},li=()=>{ze&&(clearInterval(ze),ze=null)},ca=Z=>Z?.isDynamic===!0||Z?.IsDynamic===!0,lt=async()=>{try{await Zo.logout()}catch{}localStorage.removeItem("sessionToken"),localStorage.removeItem(`marshal_${s.params.eventId}`),u.value=!1,f.value=null,y.value=null,k.value=[],Be.value=[],yn.value=[],a.push("/")},bn=()=>{J.value="Logout",Ze.value=`Are you sure you want to logout${f.value?.name?`, ${f.value.name}`:""}?`,Xe.value=lt,oe.value=!0},bt=Z=>Z?new Date(Z).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",zs=Z=>Z?new Date(Z).toLocaleString():"",ts=(Z,H)=>{if(!Z&&!H)return"";const Q=Z?bt(Z):"?",Le=H?bt(H):"?";return`${Q} - ${Le}`},ci=Z=>Z?new Date(Z).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",ui=Z=>Z?new Date(Z).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",fo=Z=>Z?Z.replace(/([A-Z])/g," $1").replace(/^./,H=>H.toUpperCase()).trim():"",di=Z=>{if(!Z)return"";const H=Z.resolvedStyleType||Z.ResolvedStyleType,Q=Z.resolvedStyleBackgroundColor||Z.ResolvedStyleBackgroundColor||Z.resolvedStyleColor||Z.ResolvedStyleColor,Le=Z.resolvedStyleBorderColor||Z.ResolvedStyleBorderColor,He=Z.resolvedStyleIconColor||Z.ResolvedStyleIconColor,st=Z.resolvedStyleBackgroundShape||Z.ResolvedStyleBackgroundShape;return H&&H!=="default"||Q||Le||He||st&&st!=="circle"?Xt({type:H||"circle",backgroundShape:st||"circle",backgroundColor:Q||"#667eea",borderColor:Le||"#ffffff",iconColor:He||"#ffffff",size:"75",outputSize:20}):`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
    <circle cx="10" cy="10" r="8" fill="#667eea" stroke="#fff" stroke-width="1.5"/>
  </svg>`};on(async()=>{const Z=s.params.eventId,H=s.query.code;G.value=!0;try{H?await _n(Z,H):await Io(Z)&&await Vn()}finally{G.value=!1}u.value&&(Bs(),"requestIdleCallback"in window?requestIdleCallback(()=>{Ko()},{timeout:5e3}):setTimeout(()=>{Ko()},2e3))}),We(u,Z=>{Z?Bs():ri()}),We(()=>s.query.code,async Z=>{if(Z&&u.value){G.value=!0;try{await _n(s.params.eventId,Z)}finally{G.value=!1}}});let wn=null;const Nt=()=>{wn||(wn=setInterval(async()=>{if(b.value?.marshalId)try{await Zo.getMe(s.params.eventId)}catch(Z){console.debug("Heartbeat failed:",Z)}},300*1e3))},po=()=>{wn&&(clearInterval(wn),wn=null)};return Lo(()=>{ri(),po(),Ro(),li()}),(Z,H)=>(v(),m("div",{class:"marshal-view",style:ot(ne.value)},[Ne(O8),l("header",{class:_e(["header",`logo-${de.value}`]),style:ot(ce.value)},[Oe.value&&de.value==="cover"?(v(),m("div",R8,[l("img",{src:Oe.value,alt:"Event logo",class:"header-logo-cover-img"},null,8,B8)])):D("",!0),u.value&&de.value==="right"?(v(),m("button",{key:1,onClick:bn,class:"btn-logout-icon btn-logout-left",style:ot({color:K.value}),title:`Logout ${f.value?.name||""}`},[l("span",{innerHTML:V(un)("logout")},null,8,F8)],12,N8)):D("",!0),Oe.value&&de.value==="left"?(v(),m("div",U8,[l("img",{src:Oe.value,alt:"Event logo",class:"header-logo-img"},null,8,z8)])):D("",!0),l("div",H8,[l("div",{class:"header-title",style:ot({color:K.value})},[C.value?(v(),m("h1",V8,_(C.value.name),1)):D("",!0),C.value?.eventDate?(v(),m("div",G8,_(ui(C.value.eventDate)),1)):D("",!0)],4),u.value?(v(),m("div",Z8,[l("button",{onClick:H[0]||(H[0]=Q=>Je.value=!0),class:"btn-header-action btn-report-incident"}," Report Incident "),l("button",{onClick:H[1]||(H[1]=Q=>je.value=!0),class:"btn-header-action btn-emergency"}," Emergency Info ")])):D("",!0)]),Oe.value&&de.value==="right"?(v(),m("div",j8,[l("img",{src:Oe.value,alt:"Event logo",class:"header-logo-img"},null,8,W8)])):D("",!0),u.value&&de.value!=="right"?(v(),m("button",{key:4,onClick:bn,class:"btn-logout-icon btn-logout-right",style:ot({color:K.value}),title:`Logout ${f.value?.name||""}`},[l("span",{innerHTML:V(un)("logout")},null,8,K8)],12,q8)):D("",!0)],6),l("div",Y8,[G.value?(v(),m("div",J8,[...H[22]||(H[22]=[l("div",{class:"loading"},"Loading...",-1)])])):!u.value&&!p.value?(v(),m("div",X8,[H[23]||(H[23]=l("h2",null,"Welcome",-1)),H[24]||(H[24]=l("p",{class:"instruction"},"Please use the login link sent to you to access your marshal dashboard.",-1)),d.value?(v(),m("p",Q8,"Authenticating...")):D("",!0)])):p.value?(v(),m("div",eB,[H[25]||(H[25]=l("h2",null,"Login failed",-1)),l("p",tB,_(p.value),1),H[26]||(H[26]=l("p",{class:"instruction"},"Please contact the event organiser for a new login link.",-1))])):(v(),m("div",nB,[E.value||A.value?(v(),m("div",oB,[l("div",sB,[f.value?.email?(v(),m("span",iB,_(f.value.email),1)):D("",!0)]),E.value?(v(),m("div",aB,[l("button",{onClick:$,class:"btn-mode-switch"}," Switch to Admin ")])):A.value?(v(),m("div",rB,[...H[27]||(H[27]=[l("span",{class:"reauth-hint",title:"Login via admin flow to access admin features"}," Admin access requires re-login ",-1)])])):D("",!0)])):D("",!0),l("div",lB,[l("div",cB,[l("button",{class:_e(["accordion-header",{active:he.value==="map"}]),onClick:H[2]||(H[2]=Q=>Kt("map"))},[l("span",uB,[l("span",{class:"section-icon",innerHTML:V(un)("course")},null,8,dB),Ve(" "+_(V(t).course)+" ",1),Bt.value?(v(),m("span",hB,"GPS Active")):(v(),m("span",fB,"GPS Inactive"))]),l("span",pB,_(he.value==="map"?"":"+"),1)],2),he.value==="map"?(v(),m("div",vB,[At.value?(v(),m("div",mB,[l("span",null,[H[28]||(H[28]=Ve("Click on the map to set the new location for ",-1)),l("strong",null,_(F.value?.location?.name),1)]),l("button",{onClick:Jo,class:"btn btn-secondary btn-sm"},"Cancel")])):D("",!0),l("div",gB,[Ne(ws,{locations:w.value,route:qe.value,center:Ds.value,zoom:15,"user-location":Bt.value,"highlight-location-ids":eo.value,"marshal-mode":!0,clickable:At.value||sn.value,class:_e({"selecting-location":At.value}),onMapClick:tn,onLocationClick:ln},null,8,["locations","route","center","user-location","highlight-location-ids","clickable","class"]),l("button",{class:"fullscreen-btn",onClick:H[3]||(H[3]=Q=>ii("course")),title:"Full screen"},[...H[29]||(H[29]=[l("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20"},[l("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"})],-1)])])])])):D("",!0)]),l("div",yB,[l("button",{class:_e(["accordion-header",{active:he.value==="assignments"}]),onClick:H[4]||(H[4]=Q=>Kt("assignments"))},[l("span",_B,[l("span",{class:"section-icon",innerHTML:V(un)("checkpoint")},null,8,kB),Ve(" Your "+_(V(o).checkpoints)+" ("+_(k.value.length)+") ",1)]),l("span",bB,_(he.value==="assignments"?"":"+"),1)],2),he.value==="assignments"?(v(),m("div",wB,[k.value.length===0?(v(),m("div",CB,[l("p",null,"You don't have any "+_(V(o).checkpoint)+" assignments yet.",1)])):(v(),m("div",LB,[(v(!0),m(we,null,Pe(gn.value,Q=>(v(),m("div",{key:Q.id,class:"checkpoint-accordion-section"},[l("button",{class:_e(["checkpoint-accordion-header",{active:An.value===Q.id,"checked-in":Q.effectiveIsCheckedIn}]),onClick:Le=>si(Q.id)},[l("div",xB,[l("div",$B,[l("span",{class:"checkpoint-icon",innerHTML:di(Q.location)},null,8,IB),Q.effectiveIsCheckedIn?(v(),m("span",TB,"")):D("",!0),l("span",MB,_(Q.location?.name||Q.locationName),1),Q.areaName?(v(),m("span",AB,_(Q.areaName),1)):D("",!0),Q.location?.startTime||Q.location?.endTime?(v(),m("span",EB,_(ts(Q.location.startTime,Q.location.endTime)),1)):D("",!0)]),Q.location?.description?(v(),m("div",PB,_(Q.location.description),1)):D("",!0)]),l("span",DB,_(An.value===Q.id?"":"+"),1)],10,SB),An.value===Q.id?(v(),m("div",OB,[Q.location?(v(),m("div",RB,[Ne(ws,{locations:w.value,route:qe.value,center:{lat:Q.location.latitude,lng:Q.location.longitude},zoom:16,"user-location":Bt.value,"highlight-location-id":Q.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:sn.value,onMapClick:tn,onLocationClick:ln},null,8,["locations","route","center","user-location","highlight-location-id","clickable"]),l("button",{class:"fullscreen-btn",onClick:Le=>ii(Q.id,Q),title:"Full screen"},[...H[30]||(H[30]=[l("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18"},[l("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"})],-1)])],8,BB)])):D("",!0),l("div",NB,[l("div",FB,_(V(t).people)+":",1),l("div",UB,[(v(!0),m(we,null,Pe(Q.allMarshals,Le=>(v(),m("span",{key:Le.marshalId,class:_e(["marshal-tag",{"is-you":Le.marshalId===y.value,"checked-in":Le.effectiveIsCheckedIn}])},[Ve(_(Le.marshalName)+_(Le.marshalId===y.value?" (you)":"")+" ",1),Le.effectiveIsCheckedIn?(v(),m("span",zB,"")):D("",!0)],2))),128))])]),Q.areaContacts.length>0?(v(),m("div",HB,[l("div",VB,_(V(t).area)+" contacts:",1),l("div",GB,[(v(!0),m(we,null,Pe(Q.areaContacts,Le=>(v(),m("div",{key:Le.marshalId,class:"contact-item"},[l("div",ZB,[l("div",jB,_(Le.marshalName),1),Le.role?(v(),m("div",WB,_(Le.role),1)):D("",!0),Le.phone?(v(),m("div",qB,_(Le.phone),1)):D("",!0),Le.email?(v(),m("div",KB,_(Le.email),1)):D("",!0)]),l("div",YB,[Le.phone?(v(),m("a",{key:0,href:`tel:${Le.phone}`,class:"contact-link"},[...H[31]||(H[31]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Ve(" Call ",-1)])],8,JB)):D("",!0),Le.phone?(v(),m("a",{key:1,href:`sms:${Le.phone}`,class:"contact-link"},[...H[32]||(H[32]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Ve(" Text ",-1)])],8,XB)):D("",!0),Le.email?(v(),m("a",{key:2,href:`mailto:${Le.email}`,class:"contact-link"},[...H[33]||(H[33]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Ve(" Email ",-1)])],8,QB)):D("",!0)])]))),128))])])):D("",!0),Q.effectiveIsCheckedIn?(v(),m("div",eN,[H[35]||(H[35]=l("span",{class:"check-icon"},"",-1)),l("div",null,[H[34]||(H[34]=l("strong",null,"Checked In",-1)),l("p",tN,_(bt(Q.checkInTime)),1)])])):(v(),m("div",nN,[l("button",{onClick:Le=>Mo(Q),class:"btn btn-primary",disabled:Te.value===Q.id,style:ot(Re.value)},_(Te.value===Q.id?"Checking in...":"GPS Check-In"),13,oN),l("button",{onClick:Le=>yt(Q),class:"btn btn-secondary",disabled:Te.value===Q.id}," Manual ",8,sN)])),xe.value&&fe.value===Q.id?(v(),m("div",iN,_(xe.value),1)):D("",!0),ca(Q.location)?(v(),m("div",aN,[l("div",rN,[l("span",lN,"Dynamic "+_(Q.location.resolvedCheckpointTerm||V(t).checkpoint),1),Q.location.lastLocationUpdate?(v(),m("span",cN," Last updated: "+_(zs(Q.location.lastLocationUpdate)),1)):D("",!0)]),l("div",uN,[l("button",{onClick:Le=>rn(Q),class:"btn btn-update-location",disabled:ge.value},[...H[36]||(H[36]=[l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1),Ve(" Update location ",-1)])],8,dN),l("button",{onClick:Le=>Oo(Q),class:_e(["btn btn-auto-update",{active:Se.value}]),title:Se.value?"Stop auto-updating":"Auto-update every 60 seconds"},[H[37]||(H[37]=l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})],-1)),Ve(" "+_(Se.value?"Stop":"Auto"),1)],10,hN)])])):D("",!0)])):D("",!0)]))),128))]))])):D("",!0)]),l("div",fN,[l("button",{class:_e(["accordion-header",{active:he.value==="checklist"}]),onClick:H[5]||(H[5]=Q=>Kt("checklist"))},[l("span",pN,[l("span",{class:"section-icon",innerHTML:V(un)("checklist")},null,8,vN),Ve(" Your "+_(V(o).checklists)+" ("+_(ho.value)+" of "+_(uo.value.length)+" complete) ",1)]),l("span",mN,_(he.value==="checklist"?"":"+"),1)],2),he.value==="checklist"?(v(),m("div",gN,[re.value?(v(),m("div",yN,"Loading checklist...")):Ee.value?(v(),m("div",_N,_(Ee.value),1)):uo.value.length===0?(v(),m("div",kN,[l("p",null,"No "+_(V(o).checklists)+" for you.",1)])):(v(),m("div",bN,[(v(!0),m(we,null,Pe(uo.value,Q=>(v(),m("div",{key:`${Q.itemId}_${Q.completionContextType}_${Q.completionContextId}`,class:_e(["checklist-item",{"item-completed":Q.isCompleted}])},[l("div",wN,[l("input",{type:"checkbox",checked:Q.isCompleted,disabled:!Q.canBeCompletedByMe||Me.value,onChange:Le=>ai(Q)},null,40,CN)]),l("div",LN,[l("div",{class:_e(["item-text",{"text-completed":Q.isCompleted}])},_(Q.text),3),To(Q)?(v(),m("div",SN,_(To(Q)),1)):D("",!0),Q.isCompleted?(v(),m("div",xN,[l("span",$N," Completed by "+_(Q.completedByActorName||"Unknown"),1),l("span",IN,_(zs(Q.completedAt)),1)])):D("",!0)])],2))),128))]))])):D("",!0)]),to.value.length>0||Gt.value?(v(),m("div",TN,[l("button",{class:_e(["accordion-header",{active:he.value==="eventContacts"}]),onClick:H[6]||(H[6]=Q=>Kt("eventContacts"))},[l("span",MN,[l("span",{class:"section-icon",innerHTML:V(un)("contacts")},null,8,AN),Ve(" Your contacts ("+_(to.value.length)+") ",1)]),l("span",EN,_(he.value==="eventContacts"?"":"+"),1)],2),he.value==="eventContacts"?(v(),m("div",PN,[Gt.value?(v(),m("div",DN,"Loading contacts...")):(v(),m("div",ON,[(v(!0),m(we,null,Pe(to.value,Q=>(v(),m("div",{key:Q.contactId,class:_e(["contact-item",{"primary-contact":Q.isPrimary}])},[l("div",RN,[l("div",BN,[Q.isPrimary?(v(),m("span",NN,"")):D("",!0),l("span",FN,_(Q.name),1),Q.role?(v(),m("span",UN,_(fo(Q.role)),1)):D("",!0)]),Q.notes?(v(),m("div",zN,_(Q.notes),1)):D("",!0),Q.phone?(v(),m("div",HN,_(Q.phone),1)):D("",!0),Q.email?(v(),m("div",VN,_(Q.email),1)):D("",!0)]),l("div",GN,[Q.phone?(v(),m("a",{key:0,href:`tel:${Q.phone}`,class:"contact-link"},[...H[38]||(H[38]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Ve(" Call ",-1)])],8,ZN)):D("",!0),Q.phone?(v(),m("a",{key:1,href:`sms:${Q.phone}`,class:"contact-link"},[...H[39]||(H[39]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Ve(" Text ",-1)])],8,jN)):D("",!0),Q.email?(v(),m("a",{key:2,href:`mailto:${Q.email}`,class:"contact-link"},[...H[40]||(H[40]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Ve(" Email ",-1)])],8,WN)):D("",!0)])],2))),128))]))])):D("",!0)])):D("",!0),l("div",qN,[l("button",{class:_e(["accordion-header",{active:he.value==="notes"}]),onClick:H[7]||(H[7]=Q=>Kt("notes"))},[l("span",KN,[l("span",{class:"section-icon",innerHTML:V(un)("notes")},null,8,YN),Ve(" Your notes ("+_($e.value.length)+") ",1)]),l("span",JN,_(he.value==="notes"?"":"+"),1)],2),he.value==="notes"?(v(),m("div",XN,[Ne(El,{"event-id":V(s).params.eventId,"all-notes":$e.value,locations:w.value,areas:M.value,assignments:k.value,"show-scope":!1,onNotesChanged:Os},null,8,["event-id","all-notes","locations","areas","assignments"])])):D("",!0)]),ue.value.length>0||ye.value?(v(),m("div",QN,[l("button",{class:_e(["accordion-header",{active:he.value==="incidents"}]),onClick:H[8]||(H[8]=Q=>Kt("incidents"))},[l("span",eF,[l("span",{class:"section-icon",innerHTML:V(un)("incidents")},null,8,tF),Ve(" Your incidents ("+_(ue.value.length)+") ",1),X.value>0?(v(),m("span",nF,_(X.value)+" open ",1)):D("",!0)]),l("span",oF,_(he.value==="incidents"?"":"+"),1)],2),he.value==="incidents"?(v(),m("div",sF,[ye.value?(v(),m("div",iF," Loading incidents... ")):ue.value.length===0?(v(),m("div",aF,[...H[41]||(H[41]=[l("p",null,"No incidents to show.",-1)])])):(v(),m("div",rF,[(v(!0),m(we,null,Pe(ue.value,Q=>(v(),et(rr,{key:Q.incidentId,incident:Q,onSelect:Le=>ct(Q)},null,8,["incident","onSelect"]))),128))]))])):D("",!0)])):D("",!0),T.value?(v(),m("div",lF,[l("button",{class:_e(["accordion-header",{active:he.value==="areaLead"}]),onClick:H[9]||(H[9]=Q=>Kt("areaLead"))},[l("span",cF,[l("span",{class:"section-icon",innerHTML:V(un)("people")},null,8,uF),Ve(" Your "+_(V(o).people)+" ",1),Fe.value?.areas?.length>0?(v(),m("span",dF,[(v(!0),m(we,null,Pe(Fe.value.areas,Q=>(v(),m("span",{key:Q.areaId,class:"area-lead-badge",style:ot({backgroundColor:Q.color||"#667eea"})},_(Q.name),5))),128))])):D("",!0)]),l("span",hF,_(he.value==="areaLead"?"":"+"),1)],2),he.value==="areaLead"?(v(),m("div",fF,[Ne(x8,{ref_key:"areaLeadRef",ref:Fe,"event-id":V(s).params.eventId,"area-ids":I.value,"marshal-id":y.value,route:qe.value,onChecklistUpdated:Yo},null,8,["event-id","area-ids","marshal-id","route"])])):D("",!0)])):D("",!0),C.value?.eventDate||C.value?.description?(v(),m("div",pF,[l("button",{class:_e(["accordion-header",{active:he.value==="eventDetails"}]),onClick:H[10]||(H[10]=Q=>Kt("eventDetails"))},[l("span",vF,[l("span",{class:"section-icon",innerHTML:V(un)("event")},null,8,mF),H[42]||(H[42]=Ve(" Event details ",-1))]),l("span",gF,_(he.value==="eventDetails"?"":"+"),1)],2),he.value==="eventDetails"?(v(),m("div",yF,[l("div",_F,[C.value.eventDate?(v(),m("div",kF,[H[43]||(H[43]=l("span",{class:"detail-label"},"Date and time",-1)),l("span",bF,_(ci(C.value.eventDate)),1)])):D("",!0),C.value.description?(v(),m("div",wF,[H[44]||(H[44]=l("span",{class:"detail-label"},"Description",-1)),l("p",CF,_(C.value.description),1)])):D("",!0)])])):D("",!0)])):D("",!0)])]))]),Ne(sR,{show:je.value,contacts:Hn.value,notes:Es.value,onClose:H[11]||(H[11]=Q=>je.value=!1)},null,8,["show","contacts","notes"]),Ne(nv,{show:Je.value,"event-id":c.value||"",checkpoint:S.value,"initial-location":Bt.value,checkpoints:w.value,route:qe.value,onClose:H[12]||(H[12]=Q=>Je.value=!1),onSubmit:Pt},null,8,["show","event-id","checkpoint","initial-location","checkpoints","route"]),Ne($u,{show:ee.value,incident:z.value,route:qe.value,checkpoints:w.value,"can-manage":T.value,onClose:H[13]||(H[13]=Q=>ee.value=!1),onStatusChange:Mt,onOpenAddNote:Fs},null,8,["show","incident","route","checkpoints","can-manage"]),Ne(Dt,{show:ie.value,title:"Add update",size:"small",onClose:Eo},{footer:Qe(()=>[l("div",SF,[l("button",{type:"button",class:"btn btn-secondary",onClick:Eo}," Cancel "),l("button",{type:"button",class:"btn btn-primary",onClick:an,disabled:!B.value.trim()||j.value},_(j.value?"Adding...":"Add update"),9,xF)])]),default:Qe(()=>[l("div",LF,[Ge(l("textarea",{"onUpdate:modelValue":H[14]||(H[14]=Q=>B.value=Q),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[at,B.value]])])]),_:1},8,["show"]),Ne(Ka,{show:oe.value,title:J.value,message:Ze.value,onConfirm:$t,onCancel:Ns},null,8,["show","title","message"]),Ne(Ka,{show:rt.value,title:ft.value,message:vt.value,"show-cancel":!1,onConfirm:Ao},null,8,["show","title","message"]),pt.value&&ht.value?(v(),m("div",{key:0,class:"modal-overlay",onClick:H[18]||(H[18]=gt(Q=>$o(ht.value.id),["self"]))},[l("div",$F,[l("div",IF,[H[45]||(H[45]=l("h3",null,"Check-in reminder",-1)),l("button",{class:"modal-close",onClick:H[15]||(H[15]=Q=>$o(ht.value.id))},"")]),l("div",TF,[H[47]||(H[47]=l("div",{class:"reminder-icon"},"",-1)),l("p",MF,[Ve(" You have not checked in yet to "+_(V(t).checkpoint.toLowerCase())+" ",1),l("strong",null,_(ht.value.location?.name),1),ht.value.location?.description?(v(),m("span",AF," - "+_(ht.value.location.description),1)):D("",!0),H[46]||(H[46]=Ve(". ",-1))]),l("p",EF," Please check in when you arrive at your "+_(V(t).checkpoint.toLowerCase())+". ",1)]),l("div",PF,[l("button",{onClick:H[16]||(H[16]=Q=>$o(ht.value.id)),class:"btn btn-secondary"}," Dismiss "),l("button",{onClick:H[17]||(H[17]=Q=>{$o(ht.value.id),he.value="assignments",An.value=ht.value.id}),class:"btn btn-primary",style:ot(Re.value)}," Go to "+_(V(t).checkpoint),5)])])])):D("",!0),q.value?(v(),m("div",{key:1,class:"modal-overlay",onClick:gt(kn,["self"])},[l("div",DF,[l("div",OF,[l("h3",null,"Update "+_((F.value?.location?.resolvedCheckpointTerm||V(t).checkpoint).toLowerCase())+" location",1),l("button",{class:"modal-close",onClick:kn},"")]),l("div",RF,[W.value?(v(),m("div",BF,_(W.value),1)):(v(),m("div",NF,[l("p",FF,[H[48]||(H[48]=Ve(" Update the position of ",-1)),l("strong",null,_(F.value?.location?.name),1)]),F.value?.location?.lastLocationUpdate?(v(),m("div",UF," Last updated: "+_(zs(F.value.location.lastLocationUpdate)),1)):D("",!0),Bt.value?(v(),m("div",zF,[...H[49]||(H[49]=[l("svg",{class:"status-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),Ve(" GPS active ",-1)])])):D("",!0),l("div",HF,[l("button",{onClick:Po,class:"btn btn-primary btn-full",disabled:ge.value,style:ot(Re.value)},[H[50]||(H[50]=l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),Ve(" "+_(ge.value?"Updating...":"Use current GPS location"),1)],12,VF)]),l("div",GF,[l("label",ZF,[l("input",{type:"checkbox",checked:Se.value,onChange:H[19]||(H[19]=Q=>Oo(F.value))},null,40,jF),H[51]||(H[51]=l("span",null,"Auto-update every 60 seconds",-1))]),l("p",WF,"Automatically updates the "+_(V(o).checkpoint)+" location using your GPS every minute.",1)]),l("div",qF,[l("button",{onClick:It,class:"btn btn-secondary btn-full",disabled:ge.value},[...H[52]||(H[52]=[l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"})],-1),Ve(" Select location on map ",-1)])],8,KF)]),l("div",YF,[l("label",JF,"Or copy location from another "+_(V(o).checkpoint)+":",1),qo.value.length>0?(v(),m("div",XF,[(v(!0),m(we,null,Pe(qo.value,Q=>(v(),m("button",{key:Q.id,onClick:Le=>Us(Q.id),class:"btn btn-secondary btn-checkpoint-source",disabled:ge.value},_(Q.name),9,QF))),128))])):(v(),m("p",e7," No other "+_(V(o).checkpoints)+" available to copy from. ",1))]),N.value?(v(),m("div",t7,_(N.value),1)):D("",!0)]))]),l("div",{class:"modal-footer"},[l("button",{onClick:kn,class:"btn btn-secondary"}," Cancel ")])])])):D("",!0),St.value?(v(),m("div",n7,[l("div",{class:"fullscreen-map-header",style:ot(ce.value)},[l("div",{class:"fullscreen-map-title",style:ot({color:K.value})},[St.value==="course"?(v(),m(we,{key:0},[Ve(_(V(t).course),1)],64)):qt.value?(v(),m(we,{key:1},[Ve(_(qt.value.location?.name),1)],64)):D("",!0)],4),l("button",{class:"fullscreen-close-btn",style:ot({color:K.value}),onClick:Yt},[...H[53]||(H[53]=[l("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24"},[l("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)])],4)],4),At.value?(v(),m("div",o7,[l("span",null,[H[54]||(H[54]=Ve("Click on the map to set the new location for ",-1)),l("strong",null,_(F.value?.location?.name),1)]),l("button",{onClick:Jo,class:"btn btn-secondary btn-sm"},"Cancel")])):D("",!0),St.value==="course"?(v(),m("div",s7,[Ne(ws,{locations:w.value,route:qe.value,center:Ds.value,zoom:15,"user-location":Bt.value,"highlight-location-ids":eo.value,"marshal-mode":!0,clickable:At.value||sn.value,class:_e({"selecting-location":At.value}),onMapClick:tn,onLocationClick:ln},null,8,["locations","route","center","user-location","highlight-location-ids","clickable","class"])])):qt.value?.location?(v(),m("div",i7,[Ne(ws,{locations:w.value,route:qe.value,center:{lat:qt.value.location.latitude,lng:qt.value.location.longitude},zoom:16,"user-location":Bt.value,"highlight-location-id":qt.value.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:sn.value,onMapClick:tn,onLocationClick:ln},null,8,["locations","route","center","user-location","highlight-location-id","clickable"])])):D("",!0),qt.value?.location?.isDynamic||St.value==="course"&&sn.value?(v(),m("div",a7,[qt.value?(v(),m("button",{key:0,class:"btn btn-primary",style:ot(Re.value),onClick:H[20]||(H[20]=Q=>rn(qt.value))}," Update Location ",4)):en.value?(v(),m("button",{key:1,class:"btn btn-primary",style:ot(Re.value),onClick:H[21]||(H[21]=Q=>rn(en.value))}," Update "+_(en.value.location?.name)+" Location ",5)):D("",!0)])):D("",!0)])):D("",!0)],4))}},c7=Ye(l7,[["__scopeId","data-v-5c6a6ad7"]]),u7=[{path:"/",name:"Home",component:C_},{path:"/admin/login",name:"AdminLogin",component:gk},{path:"/admin/verify",name:"AdminVerify",component:Lk},{path:"/admin/dashboard",name:"AdminDashboard",component:xb,meta:{requiresAuth:!0}},{path:"/admin/profile",name:"AdminProfile",component:Xb,meta:{requiresAuth:!0}},{path:"/admin/event/:eventId",name:"AdminEventManage",component:U5,meta:{requiresAuth:!0}},{path:"/event/:eventId",name:"MarshalView",component:c7},{path:"/:pathMatch(.*)*",redirect:"/"}],ov=g_({history:Ky("/VolunteerCheckin/testing/"),routes:u7});ov.beforeEach((e,t,o)=>{const i=localStorage.getItem("adminEmail");e.meta.requiresAuth&&!i?o({name:"AdminLogin"}):o()});Ts().then(()=>{console.log("Offline database initialized")}).catch(e=>{console.warn("Failed to initialize offline database:",e)});const Tu=Xg(uy);Tu.use(ty());Tu.use(ov);Tu.mount("#app");
