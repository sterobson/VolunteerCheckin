(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function o(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=o(s);fetch(s.href,a)}})();function gu(e){const t=Object.create(null);for(const o of e.split(","))t[o]=1;return o=>o in t}const Bt={},xa=[],Vo=()=>{},tf=()=>!1,Dr=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),yu=e=>e.startsWith("onUpdate:"),pn=Object.assign,_u=(e,t)=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},qv=Object.prototype.hasOwnProperty,Tt=(e,t)=>qv.call(e,t),it=Array.isArray,Ia=e=>Rl(e)==="[object Map]",Ba=e=>Rl(e)==="[object Set]",hd=e=>Rl(e)==="[object Date]",ft=e=>typeof e=="function",qt=e=>typeof e=="string",Zo=e=>typeof e=="symbol",Dt=e=>e!==null&&typeof e=="object",nf=e=>(Dt(e)||ft(e))&&ft(e.then)&&ft(e.catch),of=Object.prototype.toString,Rl=e=>of.call(e),Wv=e=>Rl(e).slice(8,-1),sf=e=>Rl(e)==="[object Object]",Or=e=>qt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,pl=gu(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Rr=e=>{const t=Object.create(null);return(o=>t[o]||(t[o]=e(o)))},Kv=/-\w/g,$o=Rr(e=>e.replace(Kv,t=>t.slice(1).toUpperCase())),Yv=/\B([A-Z])/g,Ci=Rr(e=>e.replace(Yv,"-$1").toLowerCase()),Br=Rr(e=>e.charAt(0).toUpperCase()+e.slice(1)),vc=Rr(e=>e?`on${Br(e)}`:""),yi=(e,t)=>!Object.is(e,t),rr=(e,...t)=>{for(let o=0;o<e.length;o++)e[o](...t)},af=(e,t,o,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:o})},Nr=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Jv=e=>{const t=qt(e)?Number(e):NaN;return isNaN(t)?e:t};let fd;const Fr=()=>fd||(fd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function rt(e){if(it(e)){const t={};for(let o=0;o<e.length;o++){const i=e[o],s=qt(i)?tm(i):rt(i);if(s)for(const a in s)t[a]=s[a]}return t}else if(qt(e)||Dt(e))return e}const Xv=/;(?![^(]*\))/g,Qv=/:([^]+)/,em=/\/\*[^]*?\*\//g;function tm(e){const t={};return e.replace(em,"").split(Xv).forEach(o=>{if(o){const i=o.split(Qv);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function pe(e){let t="";if(qt(e))t=e;else if(it(e))for(let o=0;o<e.length;o++){const i=pe(e[o]);i&&(t+=i+" ")}else if(Dt(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}const nm="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",om=gu(nm);function lf(e){return!!e||e===""}function sm(e,t){if(e.length!==t.length)return!1;let o=!0;for(let i=0;o&&i<e.length;i++)o=Qi(e[i],t[i]);return o}function Qi(e,t){if(e===t)return!0;let o=hd(e),i=hd(t);if(o||i)return o&&i?e.getTime()===t.getTime():!1;if(o=Zo(e),i=Zo(t),o||i)return e===t;if(o=it(e),i=it(t),o||i)return o&&i?sm(e,t):!1;if(o=Dt(e),i=Dt(t),o||i){if(!o||!i)return!1;const s=Object.keys(e).length,a=Object.keys(t).length;if(s!==a)return!1;for(const c in e){const u=e.hasOwnProperty(c),d=t.hasOwnProperty(c);if(u&&!d||!u&&d||!Qi(e[c],t[c]))return!1}}return String(e)===String(t)}function ku(e,t){return e.findIndex(o=>Qi(o,t))}const rf=e=>!!(e&&e.__v_isRef===!0),w=e=>qt(e)?e:e==null?"":it(e)||Dt(e)&&(e.toString===of||!ft(e.toString))?rf(e)?w(e.value):JSON.stringify(e,cf,2):String(e),cf=(e,t)=>rf(t)?cf(e,t.value):Ia(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((o,[i,s],a)=>(o[mc(i,a)+" =>"]=s,o),{})}:Ba(t)?{[`Set(${t.size})`]:[...t.values()].map(o=>mc(o))}:Zo(t)?mc(t):Dt(t)&&!it(t)&&!sf(t)?String(t):t,mc=(e,t="")=>{var o;return Zo(e)?`Symbol(${(o=e.description)!=null?o:t})`:e};function im(e){return e==null?"initial":typeof e=="string"?e===""?" ":e:String(e)}let Sn;class uf{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Sn,!t&&Sn&&(this.index=(Sn.scopes||(Sn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].pause();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].resume();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].resume()}}run(t){if(this._active){const o=Sn;try{return Sn=this,t()}finally{Sn=o}}}on(){++this._on===1&&(this.prevScope=Sn,Sn=this)}off(){this._on>0&&--this._on===0&&(Sn=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let o,i;for(o=0,i=this.effects.length;o<i;o++)this.effects[o].stop();for(this.effects.length=0,o=0,i=this.cleanups.length;o<i;o++)this.cleanups[o]();if(this.cleanups.length=0,this.scopes){for(o=0,i=this.scopes.length;o<i;o++)this.scopes[o].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function df(e){return new uf(e)}function hf(){return Sn}function am(e,t=!1){Sn&&Sn.cleanups.push(e)}let Ut;const gc=new WeakSet;class ff{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Sn&&Sn.active&&Sn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,gc.has(this)&&(gc.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||vf(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,pd(this),mf(this);const t=Ut,o=Go;Ut=this,Go=!0;try{return this.fn()}finally{gf(this),Ut=t,Go=o,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Cu(t);this.deps=this.depsTail=void 0,pd(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?gc.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Bc(this)&&this.run()}get dirty(){return Bc(this)}}let pf=0,vl,ml;function vf(e,t=!1){if(e.flags|=8,t){e.next=ml,ml=e;return}e.next=vl,vl=e}function bu(){pf++}function wu(){if(--pf>0)return;if(ml){let t=ml;for(ml=void 0;t;){const o=t.next;t.next=void 0,t.flags&=-9,t=o}}let e;for(;vl;){let t=vl;for(vl=void 0;t;){const o=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){e||(e=i)}t=o}}if(e)throw e}function mf(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function gf(e){let t,o=e.depsTail,i=o;for(;i;){const s=i.prevDep;i.version===-1?(i===o&&(o=s),Cu(i),lm(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=s}e.deps=t,e.depsTail=o}function Bc(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(yf(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function yf(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Sl)||(e.globalVersion=Sl,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!Bc(e))))return;e.flags|=2;const t=e.dep,o=Ut,i=Go;Ut=e,Go=!0;try{mf(e);const s=e.fn(e._value);(t.version===0||yi(s,e._value))&&(e.flags|=128,e._value=s,t.version++)}catch(s){throw t.version++,s}finally{Ut=o,Go=i,gf(e),e.flags&=-3}}function Cu(e,t=!1){const{dep:o,prevSub:i,nextSub:s}=e;if(i&&(i.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=i,e.nextSub=void 0),o.subs===e&&(o.subs=i,!i&&o.computed)){o.computed.flags&=-5;for(let a=o.computed.deps;a;a=a.nextDep)Cu(a,!0)}!t&&!--o.sc&&o.map&&o.map.delete(o.key)}function lm(e){const{prevDep:t,nextDep:o}=e;t&&(t.nextDep=o,e.prevDep=void 0),o&&(o.prevDep=t,e.nextDep=void 0)}let Go=!0;const _f=[];function Hs(){_f.push(Go),Go=!1}function Vs(){const e=_f.pop();Go=e===void 0?!0:e}function pd(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const o=Ut;Ut=void 0;try{t()}finally{Ut=o}}}let Sl=0;class rm{constructor(t,o){this.sub=t,this.dep=o,this.version=o.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Lu{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!Ut||!Go||Ut===this.computed)return;let o=this.activeLink;if(o===void 0||o.sub!==Ut)o=this.activeLink=new rm(Ut,this),Ut.deps?(o.prevDep=Ut.depsTail,Ut.depsTail.nextDep=o,Ut.depsTail=o):Ut.deps=Ut.depsTail=o,kf(o);else if(o.version===-1&&(o.version=this.version,o.nextDep)){const i=o.nextDep;i.prevDep=o.prevDep,o.prevDep&&(o.prevDep.nextDep=i),o.prevDep=Ut.depsTail,o.nextDep=void 0,Ut.depsTail.nextDep=o,Ut.depsTail=o,Ut.deps===o&&(Ut.deps=i)}return o}trigger(t){this.version++,Sl++,this.notify(t)}notify(t){bu();try{for(let o=this.subs;o;o=o.prevSub)o.sub.notify()&&o.sub.dep.notify()}finally{wu()}}}function kf(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)kf(i)}const o=e.dep.subs;o!==e&&(e.prevSub=o,o&&(o.nextSub=e)),e.dep.subs=e}}const gr=new WeakMap,Ki=Symbol(""),Nc=Symbol(""),xl=Symbol("");function xn(e,t,o){if(Go&&Ut){let i=gr.get(e);i||gr.set(e,i=new Map);let s=i.get(o);s||(i.set(o,s=new Lu),s.map=i,s.key=o),s.track()}}function Os(e,t,o,i,s,a){const c=gr.get(e);if(!c){Sl++;return}const u=d=>{d&&d.trigger()};if(bu(),t==="clear")c.forEach(u);else{const d=it(e),f=d&&Or(o);if(d&&o==="length"){const p=Number(i);c.forEach((g,k)=>{(k==="length"||k===xl||!Zo(k)&&k>=p)&&u(g)})}else switch((o!==void 0||c.has(void 0))&&u(c.get(o)),f&&u(c.get(xl)),t){case"add":d?f&&u(c.get("length")):(u(c.get(Ki)),Ia(e)&&u(c.get(Nc)));break;case"delete":d||(u(c.get(Ki)),Ia(e)&&u(c.get(Nc)));break;case"set":Ia(e)&&u(c.get(Ki));break}}wu()}function cm(e,t){const o=gr.get(e);return o&&o.get(t)}function _a(e){const t=wt(e);return t===e?t:(xn(t,"iterate",xl),uo(e)?t:t.map(jo))}function Ur(e){return xn(e=wt(e),"iterate",xl),e}function hi(e,t){return Gs(e)?zs(e)?Aa(jo(t)):Aa(t):jo(t)}const um={__proto__:null,[Symbol.iterator](){return yc(this,Symbol.iterator,e=>hi(this,e))},concat(...e){return _a(this).concat(...e.map(t=>it(t)?_a(t):t))},entries(){return yc(this,"entries",e=>(e[1]=hi(this,e[1]),e))},every(e,t){return Ts(this,"every",e,t,void 0,arguments)},filter(e,t){return Ts(this,"filter",e,t,o=>o.map(i=>hi(this,i)),arguments)},find(e,t){return Ts(this,"find",e,t,o=>hi(this,o),arguments)},findIndex(e,t){return Ts(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Ts(this,"findLast",e,t,o=>hi(this,o),arguments)},findLastIndex(e,t){return Ts(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Ts(this,"forEach",e,t,void 0,arguments)},includes(...e){return _c(this,"includes",e)},indexOf(...e){return _c(this,"indexOf",e)},join(e){return _a(this).join(e)},lastIndexOf(...e){return _c(this,"lastIndexOf",e)},map(e,t){return Ts(this,"map",e,t,void 0,arguments)},pop(){return sl(this,"pop")},push(...e){return sl(this,"push",e)},reduce(e,...t){return vd(this,"reduce",e,t)},reduceRight(e,...t){return vd(this,"reduceRight",e,t)},shift(){return sl(this,"shift")},some(e,t){return Ts(this,"some",e,t,void 0,arguments)},splice(...e){return sl(this,"splice",e)},toReversed(){return _a(this).toReversed()},toSorted(e){return _a(this).toSorted(e)},toSpliced(...e){return _a(this).toSpliced(...e)},unshift(...e){return sl(this,"unshift",e)},values(){return yc(this,"values",e=>hi(this,e))}};function yc(e,t,o){const i=Ur(e),s=i[t]();return i!==e&&!uo(e)&&(s._next=s.next,s.next=()=>{const a=s._next();return a.done||(a.value=o(a.value)),a}),s}const dm=Array.prototype;function Ts(e,t,o,i,s,a){const c=Ur(e),u=c!==e&&!uo(e),d=c[t];if(d!==dm[t]){const g=d.apply(e,a);return u?jo(g):g}let f=o;c!==e&&(u?f=function(g,k){return o.call(this,hi(e,g),k,e)}:o.length>2&&(f=function(g,k){return o.call(this,g,k,e)}));const p=d.call(c,f,i);return u&&s?s(p):p}function vd(e,t,o,i){const s=Ur(e);let a=o;return s!==e&&(uo(e)?o.length>3&&(a=function(c,u,d){return o.call(this,c,u,d,e)}):a=function(c,u,d){return o.call(this,c,hi(e,u),d,e)}),s[t](a,...i)}function _c(e,t,o){const i=wt(e);xn(i,"iterate",xl);const s=i[t](...o);return(s===-1||s===!1)&&zr(o[0])?(o[0]=wt(o[0]),i[t](...o)):s}function sl(e,t,o=[]){Hs(),bu();const i=wt(e)[t].apply(e,o);return wu(),Vs(),i}const hm=gu("__proto__,__v_isRef,__isVue"),bf=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Zo));function fm(e){Zo(e)||(e=String(e));const t=wt(this);return xn(t,"has",e),t.hasOwnProperty(e)}class wf{constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,i){if(o==="__v_skip")return t.__v_skip;const s=this._isReadonly,a=this._isShallow;if(o==="__v_isReactive")return!s;if(o==="__v_isReadonly")return s;if(o==="__v_isShallow")return a;if(o==="__v_raw")return i===(s?a?Cm:xf:a?Sf:Lf).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const c=it(t);if(!s){let d;if(c&&(d=um[o]))return d;if(o==="hasOwnProperty")return fm}const u=Reflect.get(t,o,jt(t)?t:i);if((Zo(o)?bf.has(o):hm(o))||(s||xn(t,"get",o),a))return u;if(jt(u)){const d=c&&Or(o)?u:u.value;return s&&Dt(d)?Uc(d):d}return Dt(u)?s?Uc(u):Bl(u):u}}class Cf extends wf{constructor(t=!1){super(!1,t)}set(t,o,i,s){let a=t[o];const c=it(t)&&Or(o);if(!this._isShallow){const f=Gs(a);if(!uo(i)&&!Gs(i)&&(a=wt(a),i=wt(i)),!c&&jt(a)&&!jt(i))return f||(a.value=i),!0}const u=c?Number(o)<t.length:Tt(t,o),d=Reflect.set(t,o,i,jt(t)?t:s);return t===wt(s)&&(u?yi(i,a)&&Os(t,"set",o,i):Os(t,"add",o,i)),d}deleteProperty(t,o){const i=Tt(t,o);t[o];const s=Reflect.deleteProperty(t,o);return s&&i&&Os(t,"delete",o,void 0),s}has(t,o){const i=Reflect.has(t,o);return(!Zo(o)||!bf.has(o))&&xn(t,"has",o),i}ownKeys(t){return xn(t,"iterate",it(t)?"length":Ki),Reflect.ownKeys(t)}}class pm extends wf{constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const vm=new Cf,mm=new pm,gm=new Cf(!0);const Fc=e=>e,Ql=e=>Reflect.getPrototypeOf(e);function ym(e,t,o){return function(...i){const s=this.__v_raw,a=wt(s),c=Ia(a),u=e==="entries"||e===Symbol.iterator&&c,d=e==="keys"&&c,f=s[e](...i),p=o?Fc:t?Aa:jo;return!t&&xn(a,"iterate",d?Nc:Ki),{next(){const{value:g,done:k}=f.next();return k?{value:g,done:k}:{value:u?[p(g[0]),p(g[1])]:p(g),done:k}},[Symbol.iterator](){return this}}}}function er(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function _m(e,t){const o={get(s){const a=this.__v_raw,c=wt(a),u=wt(s);e||(yi(s,u)&&xn(c,"get",s),xn(c,"get",u));const{has:d}=Ql(c),f=t?Fc:e?Aa:jo;if(d.call(c,s))return f(a.get(s));if(d.call(c,u))return f(a.get(u));a!==c&&a.get(s)},get size(){const s=this.__v_raw;return!e&&xn(wt(s),"iterate",Ki),s.size},has(s){const a=this.__v_raw,c=wt(a),u=wt(s);return e||(yi(s,u)&&xn(c,"has",s),xn(c,"has",u)),s===u?a.has(s):a.has(s)||a.has(u)},forEach(s,a){const c=this,u=c.__v_raw,d=wt(u),f=t?Fc:e?Aa:jo;return!e&&xn(d,"iterate",Ki),u.forEach((p,g)=>s.call(a,f(p),f(g),c))}};return pn(o,e?{add:er("add"),set:er("set"),delete:er("delete"),clear:er("clear")}:{add(s){!t&&!uo(s)&&!Gs(s)&&(s=wt(s));const a=wt(this);return Ql(a).has.call(a,s)||(a.add(s),Os(a,"add",s,s)),this},set(s,a){!t&&!uo(a)&&!Gs(a)&&(a=wt(a));const c=wt(this),{has:u,get:d}=Ql(c);let f=u.call(c,s);f||(s=wt(s),f=u.call(c,s));const p=d.call(c,s);return c.set(s,a),f?yi(a,p)&&Os(c,"set",s,a):Os(c,"add",s,a),this},delete(s){const a=wt(this),{has:c,get:u}=Ql(a);let d=c.call(a,s);d||(s=wt(s),d=c.call(a,s)),u&&u.call(a,s);const f=a.delete(s);return d&&Os(a,"delete",s,void 0),f},clear(){const s=wt(this),a=s.size!==0,c=s.clear();return a&&Os(s,"clear",void 0,void 0),c}}),["keys","values","entries",Symbol.iterator].forEach(s=>{o[s]=ym(s,e,t)}),o}function Su(e,t){const o=_m(e,t);return(i,s,a)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?i:Reflect.get(Tt(o,s)&&s in i?o:i,s,a)}const km={get:Su(!1,!1)},bm={get:Su(!1,!0)},wm={get:Su(!0,!1)};const Lf=new WeakMap,Sf=new WeakMap,xf=new WeakMap,Cm=new WeakMap;function Lm(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Sm(e){return e.__v_skip||!Object.isExtensible(e)?0:Lm(Wv(e))}function Bl(e){return Gs(e)?e:xu(e,!1,vm,km,Lf)}function If(e){return xu(e,!1,gm,bm,Sf)}function Uc(e){return xu(e,!0,mm,wm,xf)}function xu(e,t,o,i,s){if(!Dt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=Sm(e);if(a===0)return e;const c=s.get(e);if(c)return c;const u=new Proxy(e,a===2?i:o);return s.set(e,u),u}function zs(e){return Gs(e)?zs(e.__v_raw):!!(e&&e.__v_isReactive)}function Gs(e){return!!(e&&e.__v_isReadonly)}function uo(e){return!!(e&&e.__v_isShallow)}function zr(e){return e?!!e.__v_raw:!1}function wt(e){const t=e&&e.__v_raw;return t?wt(t):e}function Iu(e){return!Tt(e,"__v_skip")&&Object.isExtensible(e)&&af(e,"__v_skip",!0),e}const jo=e=>Dt(e)?Bl(e):e,Aa=e=>Dt(e)?Uc(e):e;function jt(e){return e?e.__v_isRef===!0:!1}function T(e){return $f(e,!1)}function xm(e){return $f(e,!0)}function $f(e,t){return jt(e)?e:new Im(e,t)}class Im{constructor(t,o){this.dep=new Lu,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=o?t:wt(t),this._value=o?t:jo(t),this.__v_isShallow=o}get value(){return this.dep.track(),this._value}set value(t){const o=this._rawValue,i=this.__v_isShallow||uo(t)||Gs(t);t=i?t:wt(t),yi(t,o)&&(this._rawValue=t,this._value=i?t:jo(t),this.dep.trigger())}}function j(e){return jt(e)?e.value:e}const $m={get:(e,t,o)=>t==="__v_raw"?e:j(Reflect.get(e,t,o)),set:(e,t,o,i)=>{const s=e[t];return jt(s)&&!jt(o)?(s.value=o,!0):Reflect.set(e,t,o,i)}};function Tf(e){return zs(e)?e:new Proxy(e,$m)}function Tm(e){const t=it(e)?new Array(e.length):{};for(const o in e)t[o]=Am(e,o);return t}class Mm{constructor(t,o,i){this._object=t,this._key=o,this._defaultValue=i,this.__v_isRef=!0,this._value=void 0,this._raw=wt(t);let s=!0,a=t;if(!it(t)||!Or(String(o)))do s=!zr(a)||uo(a);while(s&&(a=a.__v_raw));this._shallow=s}get value(){let t=this._object[this._key];return this._shallow&&(t=j(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&jt(this._raw[this._key])){const o=this._object[this._key];if(jt(o)){o.value=t;return}}this._object[this._key]=t}get dep(){return cm(this._raw,this._key)}}function Am(e,t,o){return new Mm(e,t,o)}class Em{constructor(t,o,i){this.fn=t,this.setter=o,this._value=void 0,this.dep=new Lu(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Sl-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!o,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&Ut!==this)return vf(this,!0),!0}get value(){const t=this.dep.track();return yf(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Pm(e,t,o=!1){let i,s;return ft(e)?i=e:(i=e.get,s=e.set),new Em(i,s,o)}const tr={},yr=new WeakMap;let Hi;function Dm(e,t=!1,o=Hi){if(o){let i=yr.get(o);i||yr.set(o,i=[]),i.push(e)}}function Om(e,t,o=Bt){const{immediate:i,deep:s,once:a,scheduler:c,augmentJob:u,call:d}=o,f=$=>s?$:uo($)||s===!1||s===0?Rs($,1):Rs($);let p,g,k,_,b=!1,C=!1;if(jt(e)?(g=()=>e.value,b=uo(e)):zs(e)?(g=()=>f(e),b=!0):it(e)?(C=!0,b=e.some($=>zs($)||uo($)),g=()=>e.map($=>{if(jt($))return $.value;if(zs($))return f($);if(ft($))return d?d($,2):$()})):ft(e)?t?g=d?()=>d(e,2):e:g=()=>{if(k){Hs();try{k()}finally{Vs()}}const $=Hi;Hi=p;try{return d?d(e,3,[_]):e(_)}finally{Hi=$}}:g=Vo,t&&s){const $=g,A=s===!0?1/0:s;g=()=>Rs($(),A)}const E=hf(),D=()=>{p.stop(),E&&E.active&&_u(E.effects,p)};if(a&&t){const $=t;t=(...A)=>{$(...A),D()}}let M=C?new Array(e.length).fill(tr):tr;const S=$=>{if(!(!(p.flags&1)||!p.dirty&&!$))if(t){const A=p.run();if(s||b||(C?A.some((U,I)=>yi(U,M[I])):yi(A,M))){k&&k();const U=Hi;Hi=p;try{const I=[A,M===tr?void 0:C&&M[0]===tr?[]:M,_];M=A,d?d(t,3,I):t(...I)}finally{Hi=U}}}else p.run()};return u&&u(S),p=new ff(g),p.scheduler=c?()=>c(S,!1):S,_=$=>Dm($,!1,p),k=p.onStop=()=>{const $=yr.get(p);if($){if(d)d($,4);else for(const A of $)A();yr.delete(p)}},t?i?S(!0):M=p.run():c?c(S.bind(null,!0),!0):p.run(),D.pause=p.pause.bind(p),D.resume=p.resume.bind(p),D.stop=D,D}function Rs(e,t=1/0,o){if(t<=0||!Dt(e)||e.__v_skip||(o=o||new Map,(o.get(e)||0)>=t))return e;if(o.set(e,t),t--,jt(e))Rs(e.value,t,o);else if(it(e))for(let i=0;i<e.length;i++)Rs(e[i],t,o);else if(Ba(e)||Ia(e))e.forEach(i=>{Rs(i,t,o)});else if(sf(e)){for(const i in e)Rs(e[i],t,o);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&Rs(e[i],t,o)}return e}function Nl(e,t,o,i){try{return i?e(...i):e()}catch(s){Hr(s,t,o)}}function qo(e,t,o,i){if(ft(e)){const s=Nl(e,t,o,i);return s&&nf(s)&&s.catch(a=>{Hr(a,t,o)}),s}if(it(e)){const s=[];for(let a=0;a<e.length;a++)s.push(qo(e[a],t,o,i));return s}}function Hr(e,t,o,i=!0){const s=t?t.vnode:null,{errorHandler:a,throwUnhandledErrorInProduction:c}=t&&t.appContext.config||Bt;if(t){let u=t.parent;const d=t.proxy,f=`https://vuejs.org/error-reference/#runtime-${o}`;for(;u;){const p=u.ec;if(p){for(let g=0;g<p.length;g++)if(p[g](e,d,f)===!1)return}u=u.parent}if(a){Hs(),Nl(a,null,10,[e,d,f]),Vs();return}}Rm(e,o,s,i,c)}function Rm(e,t,o,i=!0,s=!1){if(s)throw e;console.error(e)}const Fn=[];let hs=-1;const $a=[];let fi=null,ba=0;const Mf=Promise.resolve();let _r=null;function Un(e){const t=_r||Mf;return e?t.then(this?e.bind(this):e):t}function Bm(e){let t=hs+1,o=Fn.length;for(;t<o;){const i=t+o>>>1,s=Fn[i],a=Il(s);a<e||a===e&&s.flags&2?t=i+1:o=i}return t}function $u(e){if(!(e.flags&1)){const t=Il(e),o=Fn[Fn.length-1];!o||!(e.flags&2)&&t>=Il(o)?Fn.push(e):Fn.splice(Bm(t),0,e),e.flags|=1,Af()}}function Af(){_r||(_r=Mf.then(Df))}function Ef(e){it(e)?$a.push(...e):fi&&e.id===-1?fi.splice(ba+1,0,e):e.flags&1||($a.push(e),e.flags|=1),Af()}function md(e,t,o=hs+1){for(;o<Fn.length;o++){const i=Fn[o];if(i&&i.flags&2){if(e&&i.id!==e.uid)continue;Fn.splice(o,1),o--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function Pf(e){if($a.length){const t=[...new Set($a)].sort((o,i)=>Il(o)-Il(i));if($a.length=0,fi){fi.push(...t);return}for(fi=t,ba=0;ba<fi.length;ba++){const o=fi[ba];o.flags&4&&(o.flags&=-2),o.flags&8||o(),o.flags&=-2}fi=null,ba=0}}const Il=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Df(e){try{for(hs=0;hs<Fn.length;hs++){const t=Fn[hs];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Nl(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;hs<Fn.length;hs++){const t=Fn[hs];t&&(t.flags&=-2)}hs=-1,Fn.length=0,Pf(),_r=null,(Fn.length||$a.length)&&Df()}}let kn=null,Of=null;function kr(e){const t=kn;return kn=e,Of=e&&e.type.__scopeId||null,t}function Ue(e,t=kn,o){if(!t||e._n)return e;const i=(...s)=>{i._d&&Cr(-1);const a=kr(t);let c;try{c=e(...s)}finally{kr(a),i._d&&Cr(1)}return c};return i._n=!0,i._c=!0,i._d=!0,i}function He(e,t){if(kn===null)return e;const o=Wr(kn),i=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[a,c,u,d=Bt]=t[s];a&&(ft(a)&&(a={mounted:a,updated:a}),a.deep&&Rs(c),i.push({dir:a,instance:o,value:c,oldValue:void 0,arg:u,modifiers:d}))}return e}function Bi(e,t,o,i){const s=e.dirs,a=t&&t.dirs;for(let c=0;c<s.length;c++){const u=s[c];a&&(u.oldValue=a[c].value);let d=u.dir[i];d&&(Hs(),qo(d,o,8,[e.el,u,e,t]),Vs())}}function cr(e,t){if($n){let o=$n.provides;const i=$n.parent&&$n.parent.provides;i===o&&(o=$n.provides=Object.create(i)),o[e]=t}}function xo(e,t,o=!1){const i=qr();if(i||Yi){let s=Yi?Yi._context.provides:i?i.parent==null||i.ce?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return o&&ft(t)?t.call(i&&i.proxy):t}}function Nm(){return!!(qr()||Yi)}const Fm=Symbol.for("v-scx"),Um=()=>xo(Fm);function Ge(e,t,o){return Rf(e,t,o)}function Rf(e,t,o=Bt){const{immediate:i,deep:s,flush:a,once:c}=o,u=pn({},o),d=t&&i||!t&&a!=="post";let f;if(Al){if(a==="sync"){const _=Um();f=_.__watcherHandles||(_.__watcherHandles=[])}else if(!d){const _=()=>{};return _.stop=Vo,_.resume=Vo,_.pause=Vo,_}}const p=$n;u.call=(_,b,C)=>qo(_,p,b,C);let g=!1;a==="post"?u.scheduler=_=>{Rn(_,p&&p.suspense)}:a!=="sync"&&(g=!0,u.scheduler=(_,b)=>{b?_():$u(_)}),u.augmentJob=_=>{t&&(_.flags|=4),g&&(_.flags|=2,p&&(_.id=p.uid,_.i=p))};const k=Om(e,t,u);return Al&&(f?f.push(k):d&&k()),k}function zm(e,t,o){const i=this.proxy,s=qt(e)?e.includes(".")?Bf(i,e):()=>i[e]:e.bind(i,i);let a;ft(t)?a=t:(a=t.handler,o=t);const c=Fl(this),u=Rf(s,a.bind(i),o);return c(),u}function Bf(e,t){const o=t.split(".");return()=>{let i=e;for(let s=0;s<o.length&&i;s++)i=i[o[s]];return i}}const Nf=Symbol("_vte"),Ff=e=>e.__isTeleport,gl=e=>e&&(e.disabled||e.disabled===""),gd=e=>e&&(e.defer||e.defer===""),yd=e=>typeof SVGElement<"u"&&e instanceof SVGElement,_d=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,zc=(e,t)=>{const o=e&&e.to;return qt(o)?t?t(o):null:o},Uf={name:"Teleport",__isTeleport:!0,process(e,t,o,i,s,a,c,u,d,f){const{mc:p,pc:g,pbc:k,o:{insert:_,querySelector:b,createText:C,createComment:E}}=f,D=gl(t.props);let{shapeFlag:M,children:S,dynamicChildren:$}=t;if(e==null){const A=t.el=C(""),U=t.anchor=C("");_(A,o,i),_(U,o,i);const I=(O,q)=>{M&16&&p(S,O,q,s,a,c,u,d)},H=()=>{const O=t.target=zc(t.props,b),q=zf(O,t,C,_);O&&(c!=="svg"&&yd(O)?c="svg":c!=="mathml"&&_d(O)&&(c="mathml"),s&&s.isCE&&(s.ce._teleportTargets||(s.ce._teleportTargets=new Set)).add(O),D||(I(O,q),ur(t,!1)))};D&&(I(o,U),ur(t,!0)),gd(t.props)?(t.el.__isMounted=!1,Rn(()=>{H(),delete t.el.__isMounted},a)):H()}else{if(gd(t.props)&&e.el.__isMounted===!1){Rn(()=>{Uf.process(e,t,o,i,s,a,c,u,d,f)},a);return}t.el=e.el,t.targetStart=e.targetStart;const A=t.anchor=e.anchor,U=t.target=e.target,I=t.targetAnchor=e.targetAnchor,H=gl(e.props),O=H?o:U,q=H?A:I;if(c==="svg"||yd(U)?c="svg":(c==="mathml"||_d(U))&&(c="mathml"),$?(k(e.dynamicChildren,$,O,s,a,c,u),Pu(e,t,!0)):d||g(e,t,O,q,s,a,c,u,!1),D)H?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):nr(t,o,A,f,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const V=t.target=zc(t.props,b);V&&nr(t,V,null,f,0)}else H&&nr(t,U,I,f,1);ur(t,D)}},remove(e,t,o,{um:i,o:{remove:s}},a){const{shapeFlag:c,children:u,anchor:d,targetStart:f,targetAnchor:p,target:g,props:k}=e;if(g&&(s(f),s(p)),a&&s(d),c&16){const _=a||!gl(k);for(let b=0;b<u.length;b++){const C=u[b];i(C,t,o,_,!!C.dynamicChildren)}}},move:nr,hydrate:Hm};function nr(e,t,o,{o:{insert:i},m:s},a=2){a===0&&i(e.targetAnchor,t,o);const{el:c,anchor:u,shapeFlag:d,children:f,props:p}=e,g=a===2;if(g&&i(c,t,o),(!g||gl(p))&&d&16)for(let k=0;k<f.length;k++)s(f[k],t,o,2);g&&i(u,t,o)}function Hm(e,t,o,i,s,a,{o:{nextSibling:c,parentNode:u,querySelector:d,insert:f,createText:p}},g){function k(C,E,D,M){E.anchor=g(c(C),E,u(C),o,i,s,a),E.targetStart=D,E.targetAnchor=M}const _=t.target=zc(t.props,d),b=gl(t.props);if(_){const C=_._lpa||_.firstChild;if(t.shapeFlag&16)if(b)k(e,t,C,C&&c(C));else{t.anchor=c(e);let E=C;for(;E;){if(E&&E.nodeType===8){if(E.data==="teleport start anchor")t.targetStart=E;else if(E.data==="teleport anchor"){t.targetAnchor=E,_._lpa=t.targetAnchor&&c(t.targetAnchor);break}}E=c(E)}t.targetAnchor||zf(_,t,p,f),g(C&&c(C),t,_,o,i,s,a)}ur(t,b)}else b&&t.shapeFlag&16&&k(e,t,e,c(e));return t.anchor&&c(t.anchor)}const Tu=Uf;function ur(e,t){const o=e.ctx;if(o&&o.ut){let i,s;for(t?(i=e.el,s=e.anchor):(i=e.targetStart,s=e.targetAnchor);i&&i!==s;)i.nodeType===1&&i.setAttribute("data-v-owner",o.uid),i=i.nextSibling;o.ut()}}function zf(e,t,o,i){const s=t.targetStart=o(""),a=t.targetAnchor=o("");return s[Nf]=a,e&&(i(s,e),i(a,e)),a}const Ps=Symbol("_leaveCb"),or=Symbol("_enterCb");function Vm(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Wt(()=>{e.isMounted=!0}),Jf(()=>{e.isUnmounting=!0}),e}const So=[Function,Array],Hf={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:So,onEnter:So,onAfterEnter:So,onEnterCancelled:So,onBeforeLeave:So,onLeave:So,onAfterLeave:So,onLeaveCancelled:So,onBeforeAppear:So,onAppear:So,onAfterAppear:So,onAppearCancelled:So},Vf=e=>{const t=e.subTree;return t.component?Vf(t.component):t},Gm={name:"BaseTransition",props:Hf,setup(e,{slots:t}){const o=qr(),i=Vm();return()=>{const s=t.default&&jf(t.default(),!0);if(!s||!s.length)return;const a=Gf(s),c=wt(e),{mode:u}=c;if(i.isLeaving)return kc(a);const d=kd(a);if(!d)return kc(a);let f=Hc(d,c,i,o,g=>f=g);d.type!==In&&$l(d,f);let p=o.subTree&&kd(o.subTree);if(p&&p.type!==In&&!Vi(p,d)&&Vf(o).type!==In){let g=Hc(p,c,i,o);if($l(p,g),u==="out-in"&&d.type!==In)return i.isLeaving=!0,g.afterLeave=()=>{i.isLeaving=!1,o.job.flags&8||o.update(),delete g.afterLeave,p=void 0},kc(a);u==="in-out"&&d.type!==In?g.delayLeave=(k,_,b)=>{const C=Zf(i,p);C[String(p.key)]=p,k[Ps]=()=>{_(),k[Ps]=void 0,delete f.delayedLeave,p=void 0},f.delayedLeave=()=>{b(),delete f.delayedLeave,p=void 0}}:p=void 0}else p&&(p=void 0);return a}}};function Gf(e){let t=e[0];if(e.length>1){for(const o of e)if(o.type!==In){t=o;break}}return t}const Zm=Gm;function Zf(e,t){const{leavingVNodes:o}=e;let i=o.get(t.type);return i||(i=Object.create(null),o.set(t.type,i)),i}function Hc(e,t,o,i,s){const{appear:a,mode:c,persisted:u=!1,onBeforeEnter:d,onEnter:f,onAfterEnter:p,onEnterCancelled:g,onBeforeLeave:k,onLeave:_,onAfterLeave:b,onLeaveCancelled:C,onBeforeAppear:E,onAppear:D,onAfterAppear:M,onAppearCancelled:S}=t,$=String(e.key),A=Zf(o,e),U=(O,q)=>{O&&qo(O,i,9,q)},I=(O,q)=>{const V=q[1];U(O,q),it(O)?O.every(Q=>Q.length<=1)&&V():O.length<=1&&V()},H={mode:c,persisted:u,beforeEnter(O){let q=d;if(!o.isMounted)if(a)q=E||d;else return;O[Ps]&&O[Ps](!0);const V=A[$];V&&Vi(e,V)&&V.el[Ps]&&V.el[Ps](),U(q,[O])},enter(O){let q=f,V=p,Q=g;if(!o.isMounted)if(a)q=D||f,V=M||p,Q=S||g;else return;let de=!1;const Ee=O[or]=ge=>{de||(de=!0,ge?U(Q,[O]):U(V,[O]),H.delayedLeave&&H.delayedLeave(),O[or]=void 0)};q?I(q,[O,Ee]):Ee()},leave(O,q){const V=String(e.key);if(O[or]&&O[or](!0),o.isUnmounting)return q();U(k,[O]);let Q=!1;const de=O[Ps]=Ee=>{Q||(Q=!0,q(),Ee?U(C,[O]):U(b,[O]),O[Ps]=void 0,A[V]===e&&delete A[V])};A[V]=e,_?I(_,[O,de]):de()},clone(O){const q=Hc(O,t,o,i,s);return s&&s(q),q}};return H}function kc(e){if(Vr(e))return e=ki(e),e.children=null,e}function kd(e){if(!Vr(e))return Ff(e.type)&&e.children?Gf(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:o}=e;if(o){if(t&16)return o[0];if(t&32&&ft(o.default))return o.default()}}function $l(e,t){e.shapeFlag&6&&e.component?(e.transition=t,$l(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function jf(e,t=!1,o){let i=[],s=0;for(let a=0;a<e.length;a++){let c=e[a];const u=o==null?c.key:String(o)+String(c.key!=null?c.key:a);c.type===Se?(c.patchFlag&128&&s++,i=i.concat(jf(c.children,t,u))):(t||c.type!==In)&&i.push(u!=null?ki(c,{key:u}):c)}if(s>1)for(let a=0;a<i.length;a++)i[a].patchFlag=-2;return i}function qf(e,t){return ft(e)?pn({name:e.name},t,{setup:e}):e}function Wf(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const br=new WeakMap;function yl(e,t,o,i,s=!1){if(it(e)){e.forEach((b,C)=>yl(b,t&&(it(t)?t[C]:t),o,i,s));return}if(Ta(i)&&!s){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&yl(e,t,o,i.component.subTree);return}const a=i.shapeFlag&4?Wr(i.component):i.el,c=s?null:a,{i:u,r:d}=e,f=t&&t.r,p=u.refs===Bt?u.refs={}:u.refs,g=u.setupState,k=wt(g),_=g===Bt?tf:b=>Tt(k,b);if(f!=null&&f!==d){if(bd(t),qt(f))p[f]=null,_(f)&&(g[f]=null);else if(jt(f)){f.value=null;const b=t;b.k&&(p[b.k]=null)}}if(ft(d))Nl(d,u,12,[c,p]);else{const b=qt(d),C=jt(d);if(b||C){const E=()=>{if(e.f){const D=b?_(d)?g[d]:p[d]:d.value;if(s)it(D)&&_u(D,a);else if(it(D))D.includes(a)||D.push(a);else if(b)p[d]=[a],_(d)&&(g[d]=p[d]);else{const M=[a];d.value=M,e.k&&(p[e.k]=M)}}else b?(p[d]=c,_(d)&&(g[d]=c)):C&&(d.value=c,e.k&&(p[e.k]=c))};if(c){const D=()=>{E(),br.delete(e)};D.id=-1,br.set(e,D),Rn(D,o)}else bd(e),E()}}}function bd(e){const t=br.get(e);t&&(t.flags|=8,br.delete(e))}Fr().requestIdleCallback;Fr().cancelIdleCallback;const Ta=e=>!!e.type.__asyncLoader,Vr=e=>e.type.__isKeepAlive;function jm(e,t){Kf(e,"a",t)}function qm(e,t){Kf(e,"da",t)}function Kf(e,t,o=$n){const i=e.__wdc||(e.__wdc=()=>{let s=o;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(Gr(t,i,o),o){let s=o.parent;for(;s&&s.parent;)Vr(s.parent.vnode)&&Wm(i,t,o,s),s=s.parent}}function Wm(e,t,o,i){const s=Gr(t,e,i,!0);zn(()=>{_u(i[t],s)},o)}function Gr(e,t,o=$n,i=!1){if(o){const s=o[e]||(o[e]=[]),a=t.__weh||(t.__weh=(...c)=>{Hs();const u=Fl(o),d=qo(t,o,e,c);return u(),Vs(),d});return i?s.unshift(a):s.push(a),a}}const js=e=>(t,o=$n)=>{(!Al||e==="sp")&&Gr(e,(...i)=>t(...i),o)},Km=js("bm"),Wt=js("m"),Yf=js("bu"),Ym=js("u"),Jf=js("bum"),zn=js("um"),Jm=js("sp"),Xm=js("rtg"),Qm=js("rtc");function eg(e,t=$n){Gr("ec",e,t)}const tg="components";function Mu(e,t){return og(tg,e,!0,t)||e}const ng=Symbol.for("v-ndc");function og(e,t,o=!0,i=!1){const s=kn||$n;if(s){const a=s.type;{const u=Ug(a,!1);if(u&&(u===t||u===$o(t)||u===Br($o(t))))return a}const c=wd(s[e]||a[e],t)||wd(s.appContext[e],t);return!c&&i?a:c}}function wd(e,t){return e&&(e[t]||e[$o(t)]||e[Br($o(t))])}function Be(e,t,o,i){let s;const a=o,c=it(e);if(c||qt(e)){const u=c&&zs(e);let d=!1,f=!1;u&&(d=!uo(e),f=Gs(e),e=Ur(e)),s=new Array(e.length);for(let p=0,g=e.length;p<g;p++)s[p]=t(d?f?Aa(jo(e[p])):jo(e[p]):e[p],p,void 0,a)}else if(typeof e=="number"){s=new Array(e);for(let u=0;u<e;u++)s[u]=t(u+1,u,void 0,a)}else if(Dt(e))if(e[Symbol.iterator])s=Array.from(e,(u,d)=>t(u,d,void 0,a));else{const u=Object.keys(e);s=new Array(u.length);for(let d=0,f=u.length;d<f;d++){const p=u[d];s[d]=t(e[p],p,d,a)}}else s=[];return s}function Cd(e,t){for(let o=0;o<t.length;o++){const i=t[o];if(it(i))for(let s=0;s<i.length;s++)e[i[s].name]=i[s].fn;else i&&(e[i.name]=i.key?(...s)=>{const a=i.fn(...s);return a&&(a.key=i.key),a}:i.fn)}return e}function Jn(e,t,o={},i,s){if(kn.ce||kn.parent&&Ta(kn.parent)&&kn.parent.ce){const f=Object.keys(o).length>0;return t!=="default"&&(o.name=t),v(),Ye(Se,null,[Oe("slot",o,i&&i())],f?-2:64)}let a=e[t];a&&a._c&&(a._d=!1),v();const c=a&&Xf(a(o)),u=o.key||c&&c.key,d=Ye(Se,{key:(u&&!Zo(u)?u:`_${t}`)+(!c&&i?"_fb":"")},c||(i?i():[]),c&&e._===1?64:-2);return a&&a._c&&(a._d=!0),d}function Xf(e){return e.some(t=>Ml(t)?!(t.type===In||t.type===Se&&!Xf(t.children)):!0)?e:null}const Vc=e=>e?gp(e)?Wr(e):Vc(e.parent):null,_l=pn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Vc(e.parent),$root:e=>Vc(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>ep(e),$forceUpdate:e=>e.f||(e.f=()=>{$u(e.update)}),$nextTick:e=>e.n||(e.n=Un.bind(e.proxy)),$watch:e=>zm.bind(e)}),bc=(e,t)=>e!==Bt&&!e.__isScriptSetup&&Tt(e,t),sg={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:o,setupState:i,data:s,props:a,accessCache:c,type:u,appContext:d}=e;if(t[0]!=="$"){const k=c[t];if(k!==void 0)switch(k){case 1:return i[t];case 2:return s[t];case 4:return o[t];case 3:return a[t]}else{if(bc(i,t))return c[t]=1,i[t];if(s!==Bt&&Tt(s,t))return c[t]=2,s[t];if(Tt(a,t))return c[t]=3,a[t];if(o!==Bt&&Tt(o,t))return c[t]=4,o[t];Gc&&(c[t]=0)}}const f=_l[t];let p,g;if(f)return t==="$attrs"&&xn(e.attrs,"get",""),f(e);if((p=u.__cssModules)&&(p=p[t]))return p;if(o!==Bt&&Tt(o,t))return c[t]=4,o[t];if(g=d.config.globalProperties,Tt(g,t))return g[t]},set({_:e},t,o){const{data:i,setupState:s,ctx:a}=e;return bc(s,t)?(s[t]=o,!0):i!==Bt&&Tt(i,t)?(i[t]=o,!0):Tt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=o,!0)},has({_:{data:e,setupState:t,accessCache:o,ctx:i,appContext:s,props:a,type:c}},u){let d;return!!(o[u]||e!==Bt&&u[0]!=="$"&&Tt(e,u)||bc(t,u)||Tt(a,u)||Tt(i,u)||Tt(_l,u)||Tt(s.config.globalProperties,u)||(d=c.__cssModules)&&d[u])},defineProperty(e,t,o){return o.get!=null?e._.accessCache[t]=0:Tt(o,"value")&&this.set(e,t,o.value,null),Reflect.defineProperty(e,t,o)}};function Ld(e){return it(e)?e.reduce((t,o)=>(t[o]=null,t),{}):e}let Gc=!0;function ig(e){const t=ep(e),o=e.proxy,i=e.ctx;Gc=!1,t.beforeCreate&&Sd(t.beforeCreate,e,"bc");const{data:s,computed:a,methods:c,watch:u,provide:d,inject:f,created:p,beforeMount:g,mounted:k,beforeUpdate:_,updated:b,activated:C,deactivated:E,beforeDestroy:D,beforeUnmount:M,destroyed:S,unmounted:$,render:A,renderTracked:U,renderTriggered:I,errorCaptured:H,serverPrefetch:O,expose:q,inheritAttrs:V,components:Q,directives:de,filters:Ee}=t;if(f&&ag(f,i,null),c)for(const Fe in c){const ce=c[Fe];ft(ce)&&(i[Fe]=ce.bind(o))}if(s){const Fe=s.call(o,o);Dt(Fe)&&(e.data=Bl(Fe))}if(Gc=!0,a)for(const Fe in a){const ce=a[Fe],Me=ft(ce)?ce.bind(o,o):ft(ce.get)?ce.get.bind(o,o):Vo,ke=!ft(ce)&&ft(ce.set)?ce.set.bind(o):Vo,re=Z({get:Me,set:ke});Object.defineProperty(i,Fe,{enumerable:!0,configurable:!0,get:()=>re.value,set:Re=>re.value=Re})}if(u)for(const Fe in u)Qf(u[Fe],i,o,Fe);if(d){const Fe=ft(d)?d.call(o):d;Reflect.ownKeys(Fe).forEach(ce=>{cr(ce,Fe[ce])})}p&&Sd(p,e,"c");function Pe(Fe,ce){it(ce)?ce.forEach(Me=>Fe(Me.bind(o))):ce&&Fe(ce.bind(o))}if(Pe(Km,g),Pe(Wt,k),Pe(Yf,_),Pe(Ym,b),Pe(jm,C),Pe(qm,E),Pe(eg,H),Pe(Qm,U),Pe(Xm,I),Pe(Jf,M),Pe(zn,$),Pe(Jm,O),it(q))if(q.length){const Fe=e.exposed||(e.exposed={});q.forEach(ce=>{Object.defineProperty(Fe,ce,{get:()=>o[ce],set:Me=>o[ce]=Me,enumerable:!0})})}else e.exposed||(e.exposed={});A&&e.render===Vo&&(e.render=A),V!=null&&(e.inheritAttrs=V),Q&&(e.components=Q),de&&(e.directives=de),O&&Wf(e)}function ag(e,t,o=Vo){it(e)&&(e=Zc(e));for(const i in e){const s=e[i];let a;Dt(s)?"default"in s?a=xo(s.from||i,s.default,!0):a=xo(s.from||i):a=xo(s),jt(a)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>a.value,set:c=>a.value=c}):t[i]=a}}function Sd(e,t,o){qo(it(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,o)}function Qf(e,t,o,i){let s=i.includes(".")?Bf(o,i):()=>o[i];if(qt(e)){const a=t[e];ft(a)&&Ge(s,a)}else if(ft(e))Ge(s,e.bind(o));else if(Dt(e))if(it(e))e.forEach(a=>Qf(a,t,o,i));else{const a=ft(e.handler)?e.handler.bind(o):t[e.handler];ft(a)&&Ge(s,a,e)}}function ep(e){const t=e.type,{mixins:o,extends:i}=t,{mixins:s,optionsCache:a,config:{optionMergeStrategies:c}}=e.appContext,u=a.get(t);let d;return u?d=u:!s.length&&!o&&!i?d=t:(d={},s.length&&s.forEach(f=>wr(d,f,c,!0)),wr(d,t,c)),Dt(t)&&a.set(t,d),d}function wr(e,t,o,i=!1){const{mixins:s,extends:a}=t;a&&wr(e,a,o,!0),s&&s.forEach(c=>wr(e,c,o,!0));for(const c in t)if(!(i&&c==="expose")){const u=lg[c]||o&&o[c];e[c]=u?u(e[c],t[c]):t[c]}return e}const lg={data:xd,props:Id,emits:Id,methods:cl,computed:cl,beforeCreate:On,created:On,beforeMount:On,mounted:On,beforeUpdate:On,updated:On,beforeDestroy:On,beforeUnmount:On,destroyed:On,unmounted:On,activated:On,deactivated:On,errorCaptured:On,serverPrefetch:On,components:cl,directives:cl,watch:cg,provide:xd,inject:rg};function xd(e,t){return t?e?function(){return pn(ft(e)?e.call(this,this):e,ft(t)?t.call(this,this):t)}:t:e}function rg(e,t){return cl(Zc(e),Zc(t))}function Zc(e){if(it(e)){const t={};for(let o=0;o<e.length;o++)t[e[o]]=e[o];return t}return e}function On(e,t){return e?[...new Set([].concat(e,t))]:t}function cl(e,t){return e?pn(Object.create(null),e,t):t}function Id(e,t){return e?it(e)&&it(t)?[...new Set([...e,...t])]:pn(Object.create(null),Ld(e),Ld(t??{})):t}function cg(e,t){if(!e)return t;if(!t)return e;const o=pn(Object.create(null),e);for(const i in t)o[i]=On(e[i],t[i]);return o}function tp(){return{app:null,config:{isNativeTag:tf,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let ug=0;function dg(e,t){return function(i,s=null){ft(i)||(i=pn({},i)),s!=null&&!Dt(s)&&(s=null);const a=tp(),c=new WeakSet,u=[];let d=!1;const f=a.app={_uid:ug++,_component:i,_props:s,_container:null,_context:a,_instance:null,version:Hg,get config(){return a.config},set config(p){},use(p,...g){return c.has(p)||(p&&ft(p.install)?(c.add(p),p.install(f,...g)):ft(p)&&(c.add(p),p(f,...g))),f},mixin(p){return a.mixins.includes(p)||a.mixins.push(p),f},component(p,g){return g?(a.components[p]=g,f):a.components[p]},directive(p,g){return g?(a.directives[p]=g,f):a.directives[p]},mount(p,g,k){if(!d){const _=f._ceVNode||Oe(i,s);return _.appContext=a,k===!0?k="svg":k===!1&&(k=void 0),e(_,p,k),d=!0,f._container=p,p.__vue_app__=f,Wr(_.component)}},onUnmount(p){u.push(p)},unmount(){d&&(qo(u,f._instance,16),e(null,f._container),delete f._container.__vue_app__)},provide(p,g){return a.provides[p]=g,f},runWithContext(p){const g=Yi;Yi=f;try{return p()}finally{Yi=g}}};return f}}let Yi=null;const hg=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${$o(t)}Modifiers`]||e[`${Ci(t)}Modifiers`];function fg(e,t,...o){if(e.isUnmounted)return;const i=e.vnode.props||Bt;let s=o;const a=t.startsWith("update:"),c=a&&hg(i,t.slice(7));c&&(c.trim&&(s=o.map(p=>qt(p)?p.trim():p)),c.number&&(s=o.map(Nr)));let u,d=i[u=vc(t)]||i[u=vc($o(t))];!d&&a&&(d=i[u=vc(Ci(t))]),d&&qo(d,e,6,s);const f=i[u+"Once"];if(f){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,qo(f,e,6,s)}}const pg=new WeakMap;function np(e,t,o=!1){const i=o?pg:t.emitsCache,s=i.get(e);if(s!==void 0)return s;const a=e.emits;let c={},u=!1;if(!ft(e)){const d=f=>{const p=np(f,t,!0);p&&(u=!0,pn(c,p))};!o&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}return!a&&!u?(Dt(e)&&i.set(e,null),null):(it(a)?a.forEach(d=>c[d]=null):pn(c,a),Dt(e)&&i.set(e,c),c)}function Zr(e,t){return!e||!Dr(t)?!1:(t=t.slice(2).replace(/Once$/,""),Tt(e,t[0].toLowerCase()+t.slice(1))||Tt(e,Ci(t))||Tt(e,t))}function $d(e){const{type:t,vnode:o,proxy:i,withProxy:s,propsOptions:[a],slots:c,attrs:u,emit:d,render:f,renderCache:p,props:g,data:k,setupState:_,ctx:b,inheritAttrs:C}=e,E=kr(e);let D,M;try{if(o.shapeFlag&4){const $=s||i,A=$;D=fs(f.call(A,$,p,g,_,k,b)),M=u}else{const $=t;D=fs($.length>1?$(g,{attrs:u,slots:c,emit:d}):$(g,null)),M=t.props?u:vg(u)}}catch($){bl.length=0,Hr($,e,1),D=Oe(In)}let S=D;if(M&&C!==!1){const $=Object.keys(M),{shapeFlag:A}=S;$.length&&A&7&&(a&&$.some(yu)&&(M=mg(M,a)),S=ki(S,M,!1,!0))}return o.dirs&&(S=ki(S,null,!1,!0),S.dirs=S.dirs?S.dirs.concat(o.dirs):o.dirs),o.transition&&$l(S,o.transition),D=S,kr(E),D}const vg=e=>{let t;for(const o in e)(o==="class"||o==="style"||Dr(o))&&((t||(t={}))[o]=e[o]);return t},mg=(e,t)=>{const o={};for(const i in e)(!yu(i)||!(i.slice(9)in t))&&(o[i]=e[i]);return o};function gg(e,t,o){const{props:i,children:s,component:a}=e,{props:c,children:u,patchFlag:d}=t,f=a.emitsOptions;if(t.dirs||t.transition)return!0;if(o&&d>=0){if(d&1024)return!0;if(d&16)return i?Td(i,c,f):!!c;if(d&8){const p=t.dynamicProps;for(let g=0;g<p.length;g++){const k=p[g];if(c[k]!==i[k]&&!Zr(f,k))return!0}}}else return(s||u)&&(!u||!u.$stable)?!0:i===c?!1:i?c?Td(i,c,f):!0:!!c;return!1}function Td(e,t,o){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let s=0;s<i.length;s++){const a=i[s];if(t[a]!==e[a]&&!Zr(o,a))return!0}return!1}function yg({vnode:e,parent:t},o){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=o,t=t.parent;else break}}const op={},sp=()=>Object.create(op),ip=e=>Object.getPrototypeOf(e)===op;function _g(e,t,o,i=!1){const s={},a=sp();e.propsDefaults=Object.create(null),ap(e,t,s,a);for(const c in e.propsOptions[0])c in s||(s[c]=void 0);o?e.props=i?s:If(s):e.type.props?e.props=s:e.props=a,e.attrs=a}function kg(e,t,o,i){const{props:s,attrs:a,vnode:{patchFlag:c}}=e,u=wt(s),[d]=e.propsOptions;let f=!1;if((i||c>0)&&!(c&16)){if(c&8){const p=e.vnode.dynamicProps;for(let g=0;g<p.length;g++){let k=p[g];if(Zr(e.emitsOptions,k))continue;const _=t[k];if(d)if(Tt(a,k))_!==a[k]&&(a[k]=_,f=!0);else{const b=$o(k);s[b]=jc(d,u,b,_,e,!1)}else _!==a[k]&&(a[k]=_,f=!0)}}}else{ap(e,t,s,a)&&(f=!0);let p;for(const g in u)(!t||!Tt(t,g)&&((p=Ci(g))===g||!Tt(t,p)))&&(d?o&&(o[g]!==void 0||o[p]!==void 0)&&(s[g]=jc(d,u,g,void 0,e,!0)):delete s[g]);if(a!==u)for(const g in a)(!t||!Tt(t,g))&&(delete a[g],f=!0)}f&&Os(e.attrs,"set","")}function ap(e,t,o,i){const[s,a]=e.propsOptions;let c=!1,u;if(t)for(let d in t){if(pl(d))continue;const f=t[d];let p;s&&Tt(s,p=$o(d))?!a||!a.includes(p)?o[p]=f:(u||(u={}))[p]=f:Zr(e.emitsOptions,d)||(!(d in i)||f!==i[d])&&(i[d]=f,c=!0)}if(a){const d=wt(o),f=u||Bt;for(let p=0;p<a.length;p++){const g=a[p];o[g]=jc(s,d,g,f[g],e,!Tt(f,g))}}return c}function jc(e,t,o,i,s,a){const c=e[o];if(c!=null){const u=Tt(c,"default");if(u&&i===void 0){const d=c.default;if(c.type!==Function&&!c.skipFactory&&ft(d)){const{propsDefaults:f}=s;if(o in f)i=f[o];else{const p=Fl(s);i=f[o]=d.call(null,t),p()}}else i=d;s.ce&&s.ce._setProp(o,i)}c[0]&&(a&&!u?i=!1:c[1]&&(i===""||i===Ci(o))&&(i=!0))}return i}const bg=new WeakMap;function lp(e,t,o=!1){const i=o?bg:t.propsCache,s=i.get(e);if(s)return s;const a=e.props,c={},u=[];let d=!1;if(!ft(e)){const p=g=>{d=!0;const[k,_]=lp(g,t,!0);pn(c,k),_&&u.push(..._)};!o&&t.mixins.length&&t.mixins.forEach(p),e.extends&&p(e.extends),e.mixins&&e.mixins.forEach(p)}if(!a&&!d)return Dt(e)&&i.set(e,xa),xa;if(it(a))for(let p=0;p<a.length;p++){const g=$o(a[p]);Md(g)&&(c[g]=Bt)}else if(a)for(const p in a){const g=$o(p);if(Md(g)){const k=a[p],_=c[g]=it(k)||ft(k)?{type:k}:pn({},k),b=_.type;let C=!1,E=!0;if(it(b))for(let D=0;D<b.length;++D){const M=b[D],S=ft(M)&&M.name;if(S==="Boolean"){C=!0;break}else S==="String"&&(E=!1)}else C=ft(b)&&b.name==="Boolean";_[0]=C,_[1]=E,(C||Tt(_,"default"))&&u.push(g)}}const f=[c,u];return Dt(e)&&i.set(e,f),f}function Md(e){return e[0]!=="$"&&!pl(e)}const Au=e=>e==="_"||e==="_ctx"||e==="$stable",Eu=e=>it(e)?e.map(fs):[fs(e)],wg=(e,t,o)=>{if(t._n)return t;const i=Ue((...s)=>Eu(t(...s)),o);return i._c=!1,i},rp=(e,t,o)=>{const i=e._ctx;for(const s in e){if(Au(s))continue;const a=e[s];if(ft(a))t[s]=wg(s,a,i);else if(a!=null){const c=Eu(a);t[s]=()=>c}}},cp=(e,t)=>{const o=Eu(t);e.slots.default=()=>o},up=(e,t,o)=>{for(const i in t)(o||!Au(i))&&(e[i]=t[i])},Cg=(e,t,o)=>{const i=e.slots=sp();if(e.vnode.shapeFlag&32){const s=t._;s?(up(i,t,o),o&&af(i,"_",s,!0)):rp(t,i)}else t&&cp(e,t)},Lg=(e,t,o)=>{const{vnode:i,slots:s}=e;let a=!0,c=Bt;if(i.shapeFlag&32){const u=t._;u?o&&u===1?a=!1:up(s,t,o):(a=!t.$stable,rp(t,s)),c=t}else t&&(cp(e,t),c={default:1});if(a)for(const u in s)!Au(u)&&c[u]==null&&delete s[u]},Rn=Tg;function Sg(e){return xg(e)}function xg(e,t){const o=Fr();o.__VUE__=!0;const{insert:i,remove:s,patchProp:a,createElement:c,createText:u,createComment:d,setText:f,setElementText:p,parentNode:g,nextSibling:k,setScopeId:_=Vo,insertStaticContent:b}=e,C=(W,J,ue,ye=null,ae=null,ie=null,he=void 0,De=null,Te=!!J.dynamicChildren)=>{if(W===J)return;W&&!Vi(W,J)&&(ye=be(W),Re(W,ae,ie,!0),W=null),J.patchFlag===-2&&(Te=!1,J.dynamicChildren=null);const{type:oe,ref:ve,shapeFlag:se}=J;switch(oe){case jr:E(W,J,ue,ye);break;case In:D(W,J,ue,ye);break;case kl:W==null&&M(J,ue,ye,he);break;case Se:Q(W,J,ue,ye,ae,ie,he,De,Te);break;default:se&1?A(W,J,ue,ye,ae,ie,he,De,Te):se&6?de(W,J,ue,ye,ae,ie,he,De,Te):(se&64||se&128)&&oe.process(W,J,ue,ye,ae,ie,he,De,Te,Le)}ve!=null&&ae?yl(ve,W&&W.ref,ie,J||W,!J):ve==null&&W&&W.ref!=null&&yl(W.ref,null,ie,W,!0)},E=(W,J,ue,ye)=>{if(W==null)i(J.el=u(J.children),ue,ye);else{const ae=J.el=W.el;J.children!==W.children&&f(ae,J.children)}},D=(W,J,ue,ye)=>{W==null?i(J.el=d(J.children||""),ue,ye):J.el=W.el},M=(W,J,ue,ye)=>{[W.el,W.anchor]=b(W.children,J,ue,ye,W.el,W.anchor)},S=({el:W,anchor:J},ue,ye)=>{let ae;for(;W&&W!==J;)ae=k(W),i(W,ue,ye),W=ae;i(J,ue,ye)},$=({el:W,anchor:J})=>{let ue;for(;W&&W!==J;)ue=k(W),s(W),W=ue;s(J)},A=(W,J,ue,ye,ae,ie,he,De,Te)=>{if(J.type==="svg"?he="svg":J.type==="math"&&(he="mathml"),W==null)U(J,ue,ye,ae,ie,he,De,Te);else{const oe=W.el&&W.el._isVueCE?W.el:null;try{oe&&oe._beginPatch(),O(W,J,ae,ie,he,De,Te)}finally{oe&&oe._endPatch()}}},U=(W,J,ue,ye,ae,ie,he,De)=>{let Te,oe;const{props:ve,shapeFlag:se,transition:te,dirs:X}=W;if(Te=W.el=c(W.type,ie,ve&&ve.is,ve),se&8?p(Te,W.children):se&16&&H(W.children,Te,null,ye,ae,wc(W,ie),he,De),X&&Bi(W,null,ye,"created"),I(Te,W,W.scopeId,he,ye),ve){for(const K in ve)K!=="value"&&!pl(K)&&a(Te,K,null,ve[K],ie,ye);"value"in ve&&a(Te,"value",null,ve.value,ie),(oe=ve.onVnodeBeforeMount)&&us(oe,ye,W)}X&&Bi(W,null,ye,"beforeMount");const N=Ig(ae,te);N&&te.beforeEnter(Te),i(Te,J,ue),((oe=ve&&ve.onVnodeMounted)||N||X)&&Rn(()=>{oe&&us(oe,ye,W),N&&te.enter(Te),X&&Bi(W,null,ye,"mounted")},ae)},I=(W,J,ue,ye,ae)=>{if(ue&&_(W,ue),ye)for(let ie=0;ie<ye.length;ie++)_(W,ye[ie]);if(ae){let ie=ae.subTree;if(J===ie||fp(ie.type)&&(ie.ssContent===J||ie.ssFallback===J)){const he=ae.vnode;I(W,he,he.scopeId,he.slotScopeIds,ae.parent)}}},H=(W,J,ue,ye,ae,ie,he,De,Te=0)=>{for(let oe=Te;oe<W.length;oe++){const ve=W[oe]=De?pi(W[oe]):fs(W[oe]);C(null,ve,J,ue,ye,ae,ie,he,De)}},O=(W,J,ue,ye,ae,ie,he)=>{const De=J.el=W.el;let{patchFlag:Te,dynamicChildren:oe,dirs:ve}=J;Te|=W.patchFlag&16;const se=W.props||Bt,te=J.props||Bt;let X;if(ue&&Ni(ue,!1),(X=te.onVnodeBeforeUpdate)&&us(X,ue,J,W),ve&&Bi(J,W,ue,"beforeUpdate"),ue&&Ni(ue,!0),(se.innerHTML&&te.innerHTML==null||se.textContent&&te.textContent==null)&&p(De,""),oe?q(W.dynamicChildren,oe,De,ue,ye,wc(J,ae),ie):he||ce(W,J,De,null,ue,ye,wc(J,ae),ie,!1),Te>0){if(Te&16)V(De,se,te,ue,ae);else if(Te&2&&se.class!==te.class&&a(De,"class",null,te.class,ae),Te&4&&a(De,"style",se.style,te.style,ae),Te&8){const N=J.dynamicProps;for(let K=0;K<N.length;K++){const ee=N[K],$e=se[ee],We=te[ee];(We!==$e||ee==="value")&&a(De,ee,$e,We,ae,ue)}}Te&1&&W.children!==J.children&&p(De,J.children)}else!he&&oe==null&&V(De,se,te,ue,ae);((X=te.onVnodeUpdated)||ve)&&Rn(()=>{X&&us(X,ue,J,W),ve&&Bi(J,W,ue,"updated")},ye)},q=(W,J,ue,ye,ae,ie,he)=>{for(let De=0;De<J.length;De++){const Te=W[De],oe=J[De],ve=Te.el&&(Te.type===Se||!Vi(Te,oe)||Te.shapeFlag&198)?g(Te.el):ue;C(Te,oe,ve,null,ye,ae,ie,he,!0)}},V=(W,J,ue,ye,ae)=>{if(J!==ue){if(J!==Bt)for(const ie in J)!pl(ie)&&!(ie in ue)&&a(W,ie,J[ie],null,ae,ye);for(const ie in ue){if(pl(ie))continue;const he=ue[ie],De=J[ie];he!==De&&ie!=="value"&&a(W,ie,De,he,ae,ye)}"value"in ue&&a(W,"value",J.value,ue.value,ae)}},Q=(W,J,ue,ye,ae,ie,he,De,Te)=>{const oe=J.el=W?W.el:u(""),ve=J.anchor=W?W.anchor:u("");let{patchFlag:se,dynamicChildren:te,slotScopeIds:X}=J;X&&(De=De?De.concat(X):X),W==null?(i(oe,ue,ye),i(ve,ue,ye),H(J.children||[],ue,ve,ae,ie,he,De,Te)):se>0&&se&64&&te&&W.dynamicChildren&&W.dynamicChildren.length===te.length?(q(W.dynamicChildren,te,ue,ae,ie,he,De),(J.key!=null||ae&&J===ae.subTree)&&Pu(W,J,!0)):ce(W,J,ue,ve,ae,ie,he,De,Te)},de=(W,J,ue,ye,ae,ie,he,De,Te)=>{J.slotScopeIds=De,W==null?J.shapeFlag&512?ae.ctx.activate(J,ue,ye,he,Te):Ee(J,ue,ye,ae,ie,he,Te):ge(W,J,Te)},Ee=(W,J,ue,ye,ae,ie,he)=>{const De=W.component=Og(W,ye,ae);if(Vr(W)&&(De.ctx.renderer=Le),Rg(De,!1,he),De.asyncDep){if(ae&&ae.registerDep(De,Pe,he),!W.el){const Te=De.subTree=Oe(In);D(null,Te,J,ue),W.placeholder=Te.el}}else Pe(De,W,J,ue,ae,ie,he)},ge=(W,J,ue)=>{const ye=J.component=W.component;if(gg(W,J,ue))if(ye.asyncDep&&!ye.asyncResolved){Fe(ye,J,ue);return}else ye.next=J,ye.update();else J.el=W.el,ye.vnode=J},Pe=(W,J,ue,ye,ae,ie,he)=>{const De=()=>{if(W.isMounted){let{next:se,bu:te,u:X,parent:N,vnode:K}=W;{const st=dp(W);if(st){se&&(se.el=K.el,Fe(W,se,he)),st.asyncDep.then(()=>{W.isUnmounted||De()});return}}let ee=se,$e;Ni(W,!1),se?(se.el=K.el,Fe(W,se,he)):se=K,te&&rr(te),($e=se.props&&se.props.onVnodeBeforeUpdate)&&us($e,N,se,K),Ni(W,!0);const We=$d(W),ot=W.subTree;W.subTree=We,C(ot,We,g(ot.el),be(ot),W,ae,ie),se.el=We.el,ee===null&&yg(W,We.el),X&&Rn(X,ae),($e=se.props&&se.props.onVnodeUpdated)&&Rn(()=>us($e,N,se,K),ae)}else{let se;const{el:te,props:X}=J,{bm:N,m:K,parent:ee,root:$e,type:We}=W,ot=Ta(J);Ni(W,!1),N&&rr(N),!ot&&(se=X&&X.onVnodeBeforeMount)&&us(se,ee,J),Ni(W,!0);{$e.ce&&$e.ce._def.shadowRoot!==!1&&$e.ce._injectChildStyle(We);const st=W.subTree=$d(W);C(null,st,ue,ye,W,ae,ie),J.el=st.el}if(K&&Rn(K,ae),!ot&&(se=X&&X.onVnodeMounted)){const st=J;Rn(()=>us(se,ee,st),ae)}(J.shapeFlag&256||ee&&Ta(ee.vnode)&&ee.vnode.shapeFlag&256)&&W.a&&Rn(W.a,ae),W.isMounted=!0,J=ue=ye=null}};W.scope.on();const Te=W.effect=new ff(De);W.scope.off();const oe=W.update=Te.run.bind(Te),ve=W.job=Te.runIfDirty.bind(Te);ve.i=W,ve.id=W.uid,Te.scheduler=()=>$u(ve),Ni(W,!0),oe()},Fe=(W,J,ue)=>{J.component=W;const ye=W.vnode.props;W.vnode=J,W.next=null,kg(W,J.props,ye,ue),Lg(W,J.children,ue),Hs(),md(W),Vs()},ce=(W,J,ue,ye,ae,ie,he,De,Te=!1)=>{const oe=W&&W.children,ve=W?W.shapeFlag:0,se=J.children,{patchFlag:te,shapeFlag:X}=J;if(te>0){if(te&128){ke(oe,se,ue,ye,ae,ie,he,De,Te);return}else if(te&256){Me(oe,se,ue,ye,ae,ie,he,De,Te);return}}X&8?(ve&16&&Qe(oe,ae,ie),se!==oe&&p(ue,se)):ve&16?X&16?ke(oe,se,ue,ye,ae,ie,he,De,Te):Qe(oe,ae,ie,!0):(ve&8&&p(ue,""),X&16&&H(se,ue,ye,ae,ie,he,De,Te))},Me=(W,J,ue,ye,ae,ie,he,De,Te)=>{W=W||xa,J=J||xa;const oe=W.length,ve=J.length,se=Math.min(oe,ve);let te;for(te=0;te<se;te++){const X=J[te]=Te?pi(J[te]):fs(J[te]);C(W[te],X,ue,null,ae,ie,he,De,Te)}oe>ve?Qe(W,ae,ie,!0,!1,se):H(J,ue,ye,ae,ie,he,De,Te,se)},ke=(W,J,ue,ye,ae,ie,he,De,Te)=>{let oe=0;const ve=J.length;let se=W.length-1,te=ve-1;for(;oe<=se&&oe<=te;){const X=W[oe],N=J[oe]=Te?pi(J[oe]):fs(J[oe]);if(Vi(X,N))C(X,N,ue,null,ae,ie,he,De,Te);else break;oe++}for(;oe<=se&&oe<=te;){const X=W[se],N=J[te]=Te?pi(J[te]):fs(J[te]);if(Vi(X,N))C(X,N,ue,null,ae,ie,he,De,Te);else break;se--,te--}if(oe>se){if(oe<=te){const X=te+1,N=X<ve?J[X].el:ye;for(;oe<=te;)C(null,J[oe]=Te?pi(J[oe]):fs(J[oe]),ue,N,ae,ie,he,De,Te),oe++}}else if(oe>te)for(;oe<=se;)Re(W[oe],ae,ie,!0),oe++;else{const X=oe,N=oe,K=new Map;for(oe=N;oe<=te;oe++){const At=J[oe]=Te?pi(J[oe]):fs(J[oe]);At.key!=null&&K.set(At.key,oe)}let ee,$e=0;const We=te-N+1;let ot=!1,st=0;const Ct=new Array(We);for(oe=0;oe<We;oe++)Ct[oe]=0;for(oe=X;oe<=se;oe++){const At=W[oe];if($e>=We){Re(At,ae,ie,!0);continue}let Kt;if(At.key!=null)Kt=K.get(At.key);else for(ee=N;ee<=te;ee++)if(Ct[ee-N]===0&&Vi(At,J[ee])){Kt=ee;break}Kt===void 0?Re(At,ae,ie,!0):(Ct[Kt-N]=oe+1,Kt>=st?st=Kt:ot=!0,C(At,J[Kt],ue,null,ae,ie,he,De,Te),$e++)}const St=ot?$g(Ct):xa;for(ee=St.length-1,oe=We-1;oe>=0;oe--){const At=N+oe,Kt=J[At],an=J[At+1],Hn=At+1<ve?an.el||hp(an):ye;Ct[oe]===0?C(null,Kt,ue,Hn,ae,ie,he,De,Te):ot&&(ee<0||oe!==St[ee]?re(Kt,ue,Hn,2):ee--)}}},re=(W,J,ue,ye,ae=null)=>{const{el:ie,type:he,transition:De,children:Te,shapeFlag:oe}=W;if(oe&6){re(W.component.subTree,J,ue,ye);return}if(oe&128){W.suspense.move(J,ue,ye);return}if(oe&64){he.move(W,J,ue,Le);return}if(he===Se){i(ie,J,ue);for(let se=0;se<Te.length;se++)re(Te[se],J,ue,ye);i(W.anchor,J,ue);return}if(he===kl){S(W,J,ue);return}if(ye!==2&&oe&1&&De)if(ye===0)De.beforeEnter(ie),i(ie,J,ue),Rn(()=>De.enter(ie),ae);else{const{leave:se,delayLeave:te,afterLeave:X}=De,N=()=>{W.ctx.isUnmounted?s(ie):i(ie,J,ue)},K=()=>{ie._isLeaving&&ie[Ps](!0),se(ie,()=>{N(),X&&X()})};te?te(ie,N,K):K()}else i(ie,J,ue)},Re=(W,J,ue,ye=!1,ae=!1)=>{const{type:ie,props:he,ref:De,children:Te,dynamicChildren:oe,shapeFlag:ve,patchFlag:se,dirs:te,cacheIndex:X}=W;if(se===-2&&(ae=!1),De!=null&&(Hs(),yl(De,null,ue,W,!0),Vs()),X!=null&&(J.renderCache[X]=void 0),ve&256){J.ctx.deactivate(W);return}const N=ve&1&&te,K=!Ta(W);let ee;if(K&&(ee=he&&he.onVnodeBeforeUnmount)&&us(ee,J,W),ve&6)qe(W.component,ue,ye);else{if(ve&128){W.suspense.unmount(ue,ye);return}N&&Bi(W,null,J,"beforeUnmount"),ve&64?W.type.remove(W,J,ue,Le,ye):oe&&!oe.hasOnce&&(ie!==Se||se>0&&se&64)?Qe(oe,J,ue,!1,!0):(ie===Se&&se&384||!ae&&ve&16)&&Qe(Te,J,ue),ye&&Je(W)}(K&&(ee=he&&he.onVnodeUnmounted)||N)&&Rn(()=>{ee&&us(ee,J,W),N&&Bi(W,null,J,"unmounted")},ue)},Je=W=>{const{type:J,el:ue,anchor:ye,transition:ae}=W;if(J===Se){tt(ue,ye);return}if(J===kl){$(W);return}const ie=()=>{s(ue),ae&&!ae.persisted&&ae.afterLeave&&ae.afterLeave()};if(W.shapeFlag&1&&ae&&!ae.persisted){const{leave:he,delayLeave:De}=ae,Te=()=>he(ue,ie);De?De(W.el,ie,Te):Te()}else ie()},tt=(W,J)=>{let ue;for(;W!==J;)ue=k(W),s(W),W=ue;s(J)},qe=(W,J,ue)=>{const{bum:ye,scope:ae,job:ie,subTree:he,um:De,m:Te,a:oe}=W;Ad(Te),Ad(oe),ye&&rr(ye),ae.stop(),ie&&(ie.flags|=8,Re(he,W,J,ue)),De&&Rn(De,J),Rn(()=>{W.isUnmounted=!0},J)},Qe=(W,J,ue,ye=!1,ae=!1,ie=0)=>{for(let he=ie;he<W.length;he++)Re(W[he],J,ue,ye,ae)},be=W=>{if(W.shapeFlag&6)return be(W.component.subTree);if(W.shapeFlag&128)return W.suspense.next();const J=k(W.anchor||W.el),ue=J&&J[Nf];return ue?k(ue):J};let ze=!1;const fe=(W,J,ue)=>{let ye;W==null?J._vnode&&(Re(J._vnode,null,null,!0),ye=J._vnode.component):C(J._vnode||null,W,J,null,null,null,ue),J._vnode=W,ze||(ze=!0,md(ye),Pf(),ze=!1)},Le={p:C,um:Re,m:re,r:Je,mt:Ee,mc:H,pc:ce,pbc:q,n:be,o:e};return{render:fe,hydrate:void 0,createApp:dg(fe)}}function wc({type:e,props:t},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:o}function Ni({effect:e,job:t},o){o?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Ig(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function Pu(e,t,o=!1){const i=e.children,s=t.children;if(it(i)&&it(s))for(let a=0;a<i.length;a++){const c=i[a];let u=s[a];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=s[a]=pi(s[a]),u.el=c.el),!o&&u.patchFlag!==-2&&Pu(c,u)),u.type===jr&&(u.patchFlag!==-1?u.el=c.el:u.__elIndex=a+(e.type===Se?1:0)),u.type===In&&!u.el&&(u.el=c.el)}}function $g(e){const t=e.slice(),o=[0];let i,s,a,c,u;const d=e.length;for(i=0;i<d;i++){const f=e[i];if(f!==0){if(s=o[o.length-1],e[s]<f){t[i]=s,o.push(i);continue}for(a=0,c=o.length-1;a<c;)u=a+c>>1,e[o[u]]<f?a=u+1:c=u;f<e[o[a]]&&(a>0&&(t[i]=o[a-1]),o[a]=i)}}for(a=o.length,c=o[a-1];a-- >0;)o[a]=c,c=t[c];return o}function dp(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:dp(t)}function Ad(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function hp(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?hp(t.subTree):null}const fp=e=>e.__isSuspense;function Tg(e,t){t&&t.pendingBranch?it(e)?t.effects.push(...e):t.effects.push(e):Ef(e)}const Se=Symbol.for("v-fgt"),jr=Symbol.for("v-txt"),In=Symbol.for("v-cmt"),kl=Symbol.for("v-stc"),bl=[];let co=null;function v(e=!1){bl.push(co=e?null:[])}function Mg(){bl.pop(),co=bl[bl.length-1]||null}let Tl=1;function Cr(e,t=!1){Tl+=e,e<0&&co&&t&&(co.hasOnce=!0)}function pp(e){return e.dynamicChildren=Tl>0?co||xa:null,Mg(),Tl>0&&co&&co.push(e),e}function m(e,t,o,i,s,a){return pp(l(e,t,o,i,s,a,!0))}function Ye(e,t,o,i,s){return pp(Oe(e,t,o,i,s,!0))}function Ml(e){return e?e.__v_isVNode===!0:!1}function Vi(e,t){return e.type===t.type&&e.key===t.key}const vp=({key:e})=>e??null,dr=({ref:e,ref_key:t,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?qt(e)||jt(e)||ft(e)?{i:kn,r:e,k:t,f:!!o}:e:null);function l(e,t=null,o=null,i=0,s=null,a=e===Se?0:1,c=!1,u=!1){const d={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&vp(t),ref:t&&dr(t),scopeId:Of,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:kn};return u?(Du(d,o),a&128&&e.normalize(d)):o&&(d.shapeFlag|=qt(o)?8:16),Tl>0&&!c&&co&&(d.patchFlag>0||a&6)&&d.patchFlag!==32&&co.push(d),d}const Oe=Ag;function Ag(e,t=null,o=null,i=0,s=null,a=!1){if((!e||e===ng)&&(e=In),Ml(e)){const u=ki(e,t,!0);return o&&Du(u,o),Tl>0&&!a&&co&&(u.shapeFlag&6?co[co.indexOf(e)]=u:co.push(u)),u.patchFlag=-2,u}if(zg(e)&&(e=e.__vccOpts),t){t=Eg(t);let{class:u,style:d}=t;u&&!qt(u)&&(t.class=pe(u)),Dt(d)&&(zr(d)&&!it(d)&&(d=pn({},d)),t.style=rt(d))}const c=qt(e)?1:fp(e)?128:Ff(e)?64:Dt(e)?4:ft(e)?2:0;return l(e,t,o,i,s,c,a,!0)}function Eg(e){return e?zr(e)||ip(e)?pn({},e):e:null}function ki(e,t,o=!1,i=!1){const{props:s,ref:a,patchFlag:c,children:u,transition:d}=e,f=t?mp(s||{},t):s,p={__v_isVNode:!0,__v_skip:!0,type:e.type,props:f,key:f&&vp(f),ref:t&&t.ref?o&&a?it(a)?a.concat(dr(t)):[a,dr(t)]:dr(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Se?c===-1?16:c|16:c,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:d,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ki(e.ssContent),ssFallback:e.ssFallback&&ki(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return d&&i&&$l(p,d.clone(p)),p}function Ke(e=" ",t=0){return Oe(jr,null,e,t)}function Lr(e,t){const o=Oe(kl,null,e);return o.staticCount=t,o}function P(e="",t=!1){return t?(v(),Ye(In,null,e)):Oe(In,null,e)}function fs(e){return e==null||typeof e=="boolean"?Oe(In):it(e)?Oe(Se,null,e.slice()):Ml(e)?pi(e):Oe(jr,null,String(e))}function pi(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:ki(e)}function Du(e,t){let o=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(it(t))o=16;else if(typeof t=="object")if(i&65){const s=t.default;s&&(s._c&&(s._d=!1),Du(e,s()),s._c&&(s._d=!0));return}else{o=32;const s=t._;!s&&!ip(t)?t._ctx=kn:s===3&&kn&&(kn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else ft(t)?(t={default:t,_ctx:kn},o=32):(t=String(t),i&64?(o=16,t=[Ke(t)]):o=8);e.children=t,e.shapeFlag|=o}function mp(...e){const t={};for(let o=0;o<e.length;o++){const i=e[o];for(const s in i)if(s==="class")t.class!==i.class&&(t.class=pe([t.class,i.class]));else if(s==="style")t.style=rt([t.style,i.style]);else if(Dr(s)){const a=t[s],c=i[s];c&&a!==c&&!(it(a)&&a.includes(c))&&(t[s]=a?[].concat(a,c):c)}else s!==""&&(t[s]=i[s])}return t}function us(e,t,o,i=null){qo(e,t,7,[o,i])}const Pg=tp();let Dg=0;function Og(e,t,o){const i=e.type,s=(t?t.appContext:e.appContext)||Pg,a={uid:Dg++,vnode:e,type:i,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new uf(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:lp(i,s),emitsOptions:np(i,s),emit:null,emitted:null,propsDefaults:Bt,inheritAttrs:i.inheritAttrs,ctx:Bt,data:Bt,props:Bt,attrs:Bt,slots:Bt,refs:Bt,setupState:Bt,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=fg.bind(null,a),e.ce&&e.ce(a),a}let $n=null;const qr=()=>$n||kn;let Sr,qc;{const e=Fr(),t=(o,i)=>{let s;return(s=e[o])||(s=e[o]=[]),s.push(i),a=>{s.length>1?s.forEach(c=>c(a)):s[0](a)}};Sr=t("__VUE_INSTANCE_SETTERS__",o=>$n=o),qc=t("__VUE_SSR_SETTERS__",o=>Al=o)}const Fl=e=>{const t=$n;return Sr(e),e.scope.on(),()=>{e.scope.off(),Sr(t)}},Ed=()=>{$n&&$n.scope.off(),Sr(null)};function gp(e){return e.vnode.shapeFlag&4}let Al=!1;function Rg(e,t=!1,o=!1){t&&qc(t);const{props:i,children:s}=e.vnode,a=gp(e);_g(e,i,a,t),Cg(e,s,o||t);const c=a?Bg(e,t):void 0;return t&&qc(!1),c}function Bg(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,sg);const{setup:i}=o;if(i){Hs();const s=e.setupContext=i.length>1?Fg(e):null,a=Fl(e),c=Nl(i,e,0,[e.props,s]),u=nf(c);if(Vs(),a(),(u||e.sp)&&!Ta(e)&&Wf(e),u){if(c.then(Ed,Ed),t)return c.then(d=>{Pd(e,d)}).catch(d=>{Hr(d,e,0)});e.asyncDep=c}else Pd(e,c)}else yp(e)}function Pd(e,t,o){ft(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Dt(t)&&(e.setupState=Tf(t)),yp(e)}function yp(e,t,o){const i=e.type;e.render||(e.render=i.render||Vo);{const s=Fl(e);Hs();try{ig(e)}finally{Vs(),s()}}}const Ng={get(e,t){return xn(e,"get",""),e[t]}};function Fg(e){const t=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,Ng),slots:e.slots,emit:e.emit,expose:t}}function Wr(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Tf(Iu(e.exposed)),{get(t,o){if(o in t)return t[o];if(o in _l)return _l[o](e)},has(t,o){return o in t||o in _l}})):e.proxy}function Ug(e,t=!0){return ft(e)?e.displayName||e.name:e.name||t&&e.__name}function zg(e){return ft(e)&&"__vccOpts"in e}const Z=(e,t)=>Pm(e,t,Al);function Ou(e,t,o){try{Cr(-1);const i=arguments.length;return i===2?Dt(t)&&!it(t)?Ml(t)?Oe(e,null,[t]):Oe(e,t):Oe(e,null,t):(i>3?o=Array.prototype.slice.call(arguments,2):i===3&&Ml(o)&&(o=[o]),Oe(e,t,o))}finally{Cr(1)}}const Hg="3.5.26";let Wc;const Dd=typeof window<"u"&&window.trustedTypes;if(Dd)try{Wc=Dd.createPolicy("vue",{createHTML:e=>e})}catch{}const _p=Wc?e=>Wc.createHTML(e):e=>e,Vg="http://www.w3.org/2000/svg",Gg="http://www.w3.org/1998/Math/MathML",Es=typeof document<"u"?document:null,Od=Es&&Es.createElement("template"),Zg={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,i)=>{const s=t==="svg"?Es.createElementNS(Vg,e):t==="mathml"?Es.createElementNS(Gg,e):o?Es.createElement(e,{is:o}):Es.createElement(e);return e==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:e=>Es.createTextNode(e),createComment:e=>Es.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Es.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,o,i,s,a){const c=o?o.previousSibling:t.lastChild;if(s&&(s===a||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),o),!(s===a||!(s=s.nextSibling)););else{Od.innerHTML=_p(i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e);const u=Od.content;if(i==="svg"||i==="mathml"){const d=u.firstChild;for(;d.firstChild;)u.appendChild(d.firstChild);u.removeChild(d)}t.insertBefore(u,o)}return[c?c.nextSibling:t.firstChild,o?o.previousSibling:t.lastChild]}},ri="transition",il="animation",El=Symbol("_vtc"),kp={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},jg=pn({},Hf,kp),qg=e=>(e.displayName="Transition",e.props=jg,e),wl=qg((e,{slots:t})=>Ou(Zm,Wg(e),t)),Fi=(e,t=[])=>{it(e)?e.forEach(o=>o(...t)):e&&e(...t)},Rd=e=>e?it(e)?e.some(t=>t.length>1):e.length>1:!1;function Wg(e){const t={};for(const Q in e)Q in kp||(t[Q]=e[Q]);if(e.css===!1)return t;const{name:o="v",type:i,duration:s,enterFromClass:a=`${o}-enter-from`,enterActiveClass:c=`${o}-enter-active`,enterToClass:u=`${o}-enter-to`,appearFromClass:d=a,appearActiveClass:f=c,appearToClass:p=u,leaveFromClass:g=`${o}-leave-from`,leaveActiveClass:k=`${o}-leave-active`,leaveToClass:_=`${o}-leave-to`}=e,b=Kg(s),C=b&&b[0],E=b&&b[1],{onBeforeEnter:D,onEnter:M,onEnterCancelled:S,onLeave:$,onLeaveCancelled:A,onBeforeAppear:U=D,onAppear:I=M,onAppearCancelled:H=S}=t,O=(Q,de,Ee,ge)=>{Q._enterCancelled=ge,Ui(Q,de?p:u),Ui(Q,de?f:c),Ee&&Ee()},q=(Q,de)=>{Q._isLeaving=!1,Ui(Q,g),Ui(Q,_),Ui(Q,k),de&&de()},V=Q=>(de,Ee)=>{const ge=Q?I:M,Pe=()=>O(de,Q,Ee);Fi(ge,[de,Pe]),Bd(()=>{Ui(de,Q?d:a),Ms(de,Q?p:u),Rd(ge)||Nd(de,i,C,Pe)})};return pn(t,{onBeforeEnter(Q){Fi(D,[Q]),Ms(Q,a),Ms(Q,c)},onBeforeAppear(Q){Fi(U,[Q]),Ms(Q,d),Ms(Q,f)},onEnter:V(!1),onAppear:V(!0),onLeave(Q,de){Q._isLeaving=!0;const Ee=()=>q(Q,de);Ms(Q,g),Q._enterCancelled?(Ms(Q,k),zd(Q)):(zd(Q),Ms(Q,k)),Bd(()=>{Q._isLeaving&&(Ui(Q,g),Ms(Q,_),Rd($)||Nd(Q,i,E,Ee))}),Fi($,[Q,Ee])},onEnterCancelled(Q){O(Q,!1,void 0,!0),Fi(S,[Q])},onAppearCancelled(Q){O(Q,!0,void 0,!0),Fi(H,[Q])},onLeaveCancelled(Q){q(Q),Fi(A,[Q])}})}function Kg(e){if(e==null)return null;if(Dt(e))return[Cc(e.enter),Cc(e.leave)];{const t=Cc(e);return[t,t]}}function Cc(e){return Jv(e)}function Ms(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e[El]||(e[El]=new Set)).add(t)}function Ui(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const o=e[El];o&&(o.delete(t),o.size||(e[El]=void 0))}function Bd(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Yg=0;function Nd(e,t,o,i){const s=e._endId=++Yg,a=()=>{s===e._endId&&i()};if(o!=null)return setTimeout(a,o);const{type:c,timeout:u,propCount:d}=Jg(e,t);if(!c)return i();const f=c+"end";let p=0;const g=()=>{e.removeEventListener(f,k),a()},k=_=>{_.target===e&&++p>=d&&g()};setTimeout(()=>{p<d&&g()},u+1),e.addEventListener(f,k)}function Jg(e,t){const o=window.getComputedStyle(e),i=b=>(o[b]||"").split(", "),s=i(`${ri}Delay`),a=i(`${ri}Duration`),c=Fd(s,a),u=i(`${il}Delay`),d=i(`${il}Duration`),f=Fd(u,d);let p=null,g=0,k=0;t===ri?c>0&&(p=ri,g=c,k=a.length):t===il?f>0&&(p=il,g=f,k=d.length):(g=Math.max(c,f),p=g>0?c>f?ri:il:null,k=p?p===ri?a.length:d.length:0);const _=p===ri&&/\b(?:transform|all)(?:,|$)/.test(i(`${ri}Property`).toString());return{type:p,timeout:g,propCount:k,hasTransform:_}}function Fd(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((o,i)=>Ud(o)+Ud(e[i])))}function Ud(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function zd(e){return(e?e.ownerDocument:document).body.offsetHeight}function Xg(e,t,o){const i=e[El];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}const xr=Symbol("_vod"),bp=Symbol("_vsh"),bi={name:"show",beforeMount(e,{value:t},{transition:o}){e[xr]=e.style.display==="none"?"":e.style.display,o&&t?o.beforeEnter(e):al(e,t)},mounted(e,{value:t},{transition:o}){o&&t&&o.enter(e)},updated(e,{value:t,oldValue:o},{transition:i}){!t!=!o&&(i?t?(i.beforeEnter(e),al(e,!0),i.enter(e)):i.leave(e,()=>{al(e,!1)}):al(e,t))},beforeUnmount(e,{value:t}){al(e,t)}};function al(e,t){e.style.display=t?e[xr]:"none",e[bp]=!t}const wp=Symbol("");function Qg(e){const t=qr();if(!t)return;const o=t.ut=(s=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(a=>Ir(a,s))},i=()=>{const s=e(t.proxy);t.ce?Ir(t.ce,s):Kc(t.subTree,s),o(s)};Yf(()=>{Ef(i)}),Wt(()=>{Ge(i,Vo,{flush:"post"});const s=new MutationObserver(i);s.observe(t.subTree.el.parentNode,{childList:!0}),zn(()=>s.disconnect())})}function Kc(e,t){if(e.shapeFlag&128){const o=e.suspense;e=o.activeBranch,o.pendingBranch&&!o.isHydrating&&o.effects.push(()=>{Kc(o.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)Ir(e.el,t);else if(e.type===Se)e.children.forEach(o=>Kc(o,t));else if(e.type===kl){let{el:o,anchor:i}=e;for(;o&&(Ir(o,t),o!==i);)o=o.nextSibling}}function Ir(e,t){if(e.nodeType===1){const o=e.style;let i="";for(const s in t){const a=im(t[s]);o.setProperty(`--${s}`,a),i+=`--${s}: ${a};`}o[wp]=i}}const ey=/(?:^|;)\s*display\s*:/;function ty(e,t,o){const i=e.style,s=qt(o);let a=!1;if(o&&!s){if(t)if(qt(t))for(const c of t.split(";")){const u=c.slice(0,c.indexOf(":")).trim();o[u]==null&&hr(i,u,"")}else for(const c in t)o[c]==null&&hr(i,c,"");for(const c in o)c==="display"&&(a=!0),hr(i,c,o[c])}else if(s){if(t!==o){const c=i[wp];c&&(o+=";"+c),i.cssText=o,a=ey.test(o)}}else t&&e.removeAttribute("style");xr in e&&(e[xr]=a?i.display:"",e[bp]&&(i.display="none"))}const Hd=/\s*!important$/;function hr(e,t,o){if(it(o))o.forEach(i=>hr(e,t,i));else if(o==null&&(o=""),t.startsWith("--"))e.setProperty(t,o);else{const i=ny(e,t);Hd.test(o)?e.setProperty(Ci(i),o.replace(Hd,""),"important"):e[i]=o}}const Vd=["Webkit","Moz","ms"],Lc={};function ny(e,t){const o=Lc[t];if(o)return o;let i=$o(t);if(i!=="filter"&&i in e)return Lc[t]=i;i=Br(i);for(let s=0;s<Vd.length;s++){const a=Vd[s]+i;if(a in e)return Lc[t]=a}return t}const Gd="http://www.w3.org/1999/xlink";function Zd(e,t,o,i,s,a=om(t)){i&&t.startsWith("xlink:")?o==null?e.removeAttributeNS(Gd,t.slice(6,t.length)):e.setAttributeNS(Gd,t,o):o==null||a&&!lf(o)?e.removeAttribute(t):e.setAttribute(t,a?"":Zo(o)?String(o):o)}function jd(e,t,o,i,s){if(t==="innerHTML"||t==="textContent"){o!=null&&(e[t]=t==="innerHTML"?_p(o):o);return}const a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){const u=a==="OPTION"?e.getAttribute("value")||"":e.value,d=o==null?e.type==="checkbox"?"on":"":String(o);(u!==d||!("_value"in e))&&(e.value=d),o==null&&e.removeAttribute(t),e._value=o;return}let c=!1;if(o===""||o==null){const u=typeof e[t];u==="boolean"?o=lf(o):o==null&&u==="string"?(o="",c=!0):u==="number"&&(o=0,c=!0)}try{e[t]=o}catch{}c&&e.removeAttribute(s||t)}function Bs(e,t,o,i){e.addEventListener(t,o,i)}function oy(e,t,o,i){e.removeEventListener(t,o,i)}const qd=Symbol("_vei");function sy(e,t,o,i,s=null){const a=e[qd]||(e[qd]={}),c=a[t];if(i&&c)c.value=i;else{const[u,d]=iy(t);if(i){const f=a[t]=ry(i,s);Bs(e,u,f,d)}else c&&(oy(e,u,c,d),a[t]=void 0)}}const Wd=/(?:Once|Passive|Capture)$/;function iy(e){let t;if(Wd.test(e)){t={};let i;for(;i=e.match(Wd);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Ci(e.slice(2)),t]}let Sc=0;const ay=Promise.resolve(),ly=()=>Sc||(ay.then(()=>Sc=0),Sc=Date.now());function ry(e,t){const o=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=o.attached)return;qo(cy(i,o.value),t,5,[i])};return o.value=e,o.attached=ly(),o}function cy(e,t){if(it(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map(i=>s=>!s._stopped&&i&&i(s))}else return t}const Kd=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,uy=(e,t,o,i,s,a)=>{const c=s==="svg";t==="class"?Xg(e,i,c):t==="style"?ty(e,o,i):Dr(t)?yu(t)||sy(e,t,o,i,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):dy(e,t,i,c))?(jd(e,t,i),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Zd(e,t,i,c,a,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!qt(i))?jd(e,$o(t),i,a,t):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),Zd(e,t,i,c))};function dy(e,t,o,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&Kd(t)&&ft(o));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Kd(t)&&qt(o)?!1:t in e}const wi=e=>{const t=e.props["onUpdate:modelValue"]||!1;return it(t)?o=>rr(t,o):t};function hy(e){e.target.composing=!0}function Yd(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Io=Symbol("_assign");function Jd(e,t,o){return t&&(e=e.trim()),o&&(e=Nr(e)),e}const nt={created(e,{modifiers:{lazy:t,trim:o,number:i}},s){e[Io]=wi(s);const a=i||s.props&&s.props.type==="number";Bs(e,t?"change":"input",c=>{c.target.composing||e[Io](Jd(e.value,o,a))}),(o||a)&&Bs(e,"change",()=>{e.value=Jd(e.value,o,a)}),t||(Bs(e,"compositionstart",hy),Bs(e,"compositionend",Yd),Bs(e,"change",Yd))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:o,modifiers:{lazy:i,trim:s,number:a}},c){if(e[Io]=wi(c),e.composing)return;const u=(a||e.type==="number")&&!/^0\d/.test(e.value)?Nr(e.value):e.value,d=t??"";u!==d&&(document.activeElement===e&&e.type!=="range"&&(i&&t===o||s&&e.value.trim()===d)||(e.value=d))}},Kr={deep:!0,created(e,t,o){e[Io]=wi(o),Bs(e,"change",()=>{const i=e._modelValue,s=Ea(e),a=e.checked,c=e[Io];if(it(i)){const u=ku(i,s),d=u!==-1;if(a&&!d)c(i.concat(s));else if(!a&&d){const f=[...i];f.splice(u,1),c(f)}}else if(Ba(i)){const u=new Set(i);a?u.add(s):u.delete(s),c(u)}else c(Cp(e,a))})},mounted:Xd,beforeUpdate(e,t,o){e[Io]=wi(o),Xd(e,t,o)}};function Xd(e,{value:t,oldValue:o},i){e._modelValue=t;let s;if(it(t))s=ku(t,i.props.value)>-1;else if(Ba(t))s=t.has(i.props.value);else{if(t===o)return;s=Qi(t,Cp(e,!0))}e.checked!==s&&(e.checked=s)}const Qd={created(e,{value:t},o){e.checked=Qi(t,o.props.value),e[Io]=wi(o),Bs(e,"change",()=>{e[Io](Ea(e))})},beforeUpdate(e,{value:t,oldValue:o},i){e[Io]=wi(i),t!==o&&(e.checked=Qi(t,i.props.value))}},Tn={deep:!0,created(e,{value:t,modifiers:{number:o}},i){const s=Ba(t);Bs(e,"change",()=>{const a=Array.prototype.filter.call(e.options,c=>c.selected).map(c=>o?Nr(Ea(c)):Ea(c));e[Io](e.multiple?s?new Set(a):a:a[0]),e._assigning=!0,Un(()=>{e._assigning=!1})}),e[Io]=wi(i)},mounted(e,{value:t}){eh(e,t)},beforeUpdate(e,t,o){e[Io]=wi(o)},updated(e,{value:t}){e._assigning||eh(e,t)}};function eh(e,t){const o=e.multiple,i=it(t);if(!(o&&!i&&!Ba(t))){for(let s=0,a=e.options.length;s<a;s++){const c=e.options[s],u=Ea(c);if(o)if(i){const d=typeof u;d==="string"||d==="number"?c.selected=t.some(f=>String(f)===String(u)):c.selected=ku(t,u)>-1}else c.selected=t.has(u);else if(Qi(Ea(c),t)){e.selectedIndex!==s&&(e.selectedIndex=s);return}}!o&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Ea(e){return"_value"in e?e._value:e.value}function Cp(e,t){const o=t?"_trueValue":"_falseValue";return o in e?e[o]:t}const fy=["ctrl","shift","alt","meta"],py={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>fy.some(o=>e[`${o}Key`]&&!t.includes(o))},ht=(e,t)=>{const o=e._withMods||(e._withMods={}),i=t.join(".");return o[i]||(o[i]=((s,...a)=>{for(let c=0;c<t.length;c++){const u=py[t[c]];if(u&&u(s,t))return}return e(s,...a)}))},vy={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Lp=(e,t)=>{const o=e._withKeys||(e._withKeys={}),i=t.join(".");return o[i]||(o[i]=(s=>{if(!("key"in s))return;const a=Ci(s.key);if(t.some(c=>c===a||vy[c]===a))return e(s)}))},my=pn({patchProp:uy},Zg);let th;function gy(){return th||(th=Sg(my))}const yy=((...e)=>{const t=gy().createApp(...e),{mount:o}=t;return t.mount=i=>{const s=ky(i);if(!s)return;const a=t._component;!ft(a)&&!a.render&&!a.template&&(a.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const c=o(s,!1,_y(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),c},t});function _y(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function ky(e){return qt(e)?document.querySelector(e):e}let Sp;const Yr=e=>Sp=e,xp=Symbol();function Yc(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Cl;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Cl||(Cl={}));function by(){const e=df(!0),t=e.run(()=>T({}));let o=[],i=[];const s=Iu({install(a){Yr(s),s._a=a,a.provide(xp,s),a.config.globalProperties.$pinia=s,i.forEach(c=>o.push(c)),i=[]},use(a){return this._a?o.push(a):i.push(a),this},_p:o,_a:null,_e:e,_s:new Map,state:t});return s}const Ip=()=>{};function nh(e,t,o,i=Ip){e.add(t);const s=()=>{e.delete(t)&&i()};return!o&&hf()&&am(s),s}function ka(e,...t){e.forEach(o=>{o(...t)})}const wy=e=>e(),oh=Symbol(),xc=Symbol();function Jc(e,t){e instanceof Map&&t instanceof Map?t.forEach((o,i)=>e.set(i,o)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const o in t){if(!t.hasOwnProperty(o))continue;const i=t[o],s=e[o];Yc(s)&&Yc(i)&&e.hasOwnProperty(o)&&!jt(i)&&!zs(i)?e[o]=Jc(s,i):e[o]=i}return e}const Cy=Symbol();function Ly(e){return!Yc(e)||!Object.prototype.hasOwnProperty.call(e,Cy)}const{assign:ui}=Object;function Sy(e){return!!(jt(e)&&e.effect)}function xy(e,t,o,i){const{state:s,actions:a,getters:c}=t,u=o.state.value[e];let d;function f(){u||(o.state.value[e]=s?s():{});const p=Tm(o.state.value[e]);return ui(p,a,Object.keys(c||{}).reduce((g,k)=>(g[k]=Iu(Z(()=>{Yr(o);const _=o._s.get(e);return c[k].call(_,_)})),g),{}))}return d=$p(e,f,t,o,i,!0),d}function $p(e,t,o={},i,s,a){let c;const u=ui({actions:{}},o),d={deep:!0};let f,p,g=new Set,k=new Set,_;const b=i.state.value[e];!a&&!b&&(i.state.value[e]={}),T({});let C;function E(H){let O;f=p=!1,typeof H=="function"?(H(i.state.value[e]),O={type:Cl.patchFunction,storeId:e,events:_}):(Jc(i.state.value[e],H),O={type:Cl.patchObject,payload:H,storeId:e,events:_});const q=C=Symbol();Un().then(()=>{C===q&&(f=!0)}),p=!0,ka(g,O,i.state.value[e])}const D=a?function(){const{state:O}=o,q=O?O():{};this.$patch(V=>{ui(V,q)})}:Ip;function M(){c.stop(),g.clear(),k.clear(),i._s.delete(e)}const S=(H,O="")=>{if(oh in H)return H[xc]=O,H;const q=function(){Yr(i);const V=Array.from(arguments),Q=new Set,de=new Set;function Ee(Fe){Q.add(Fe)}function ge(Fe){de.add(Fe)}ka(k,{args:V,name:q[xc],store:A,after:Ee,onError:ge});let Pe;try{Pe=H.apply(this&&this.$id===e?this:A,V)}catch(Fe){throw ka(de,Fe),Fe}return Pe instanceof Promise?Pe.then(Fe=>(ka(Q,Fe),Fe)).catch(Fe=>(ka(de,Fe),Promise.reject(Fe))):(ka(Q,Pe),Pe)};return q[oh]=!0,q[xc]=O,q},$={_p:i,$id:e,$onAction:nh.bind(null,k),$patch:E,$reset:D,$subscribe(H,O={}){const q=nh(g,H,O.detached,()=>V()),V=c.run(()=>Ge(()=>i.state.value[e],Q=>{(O.flush==="sync"?p:f)&&H({storeId:e,type:Cl.direct,events:_},Q)},ui({},d,O)));return q},$dispose:M},A=Bl($);i._s.set(e,A);const I=(i._a&&i._a.runWithContext||wy)(()=>i._e.run(()=>(c=df()).run(()=>t({action:S}))));for(const H in I){const O=I[H];if(jt(O)&&!Sy(O)||zs(O))a||(b&&Ly(O)&&(jt(O)?O.value=b[H]:Jc(O,b[H])),i.state.value[e][H]=O);else if(typeof O=="function"){const q=S(O,H);I[H]=q,u.actions[H]=O}}return ui(A,I),ui(wt(A),I),Object.defineProperty(A,"$state",{get:()=>i.state.value[e],set:H=>{E(O=>{ui(O,H)})}}),i._p.forEach(H=>{ui(A,c.run(()=>H({store:A,app:i._a,pinia:i,options:u})))}),b&&a&&o.hydrate&&o.hydrate(A.$state,b),f=!0,p=!0,A}function Ru(e,t,o){let i;const s=typeof t=="function";i=s?o:t;function a(c,u){const d=Nm();return c=c||(d?xo(xp,null):null),c&&Yr(c),c=Sp,c._s.has(e)||(s?$p(e,t,i,c):xy(e,i,c)),c._s.get(e)}return a.$id=e,a}const je=(e,t)=>{const o=e.__vccOpts||e;for(const[i,s]of t)o[i]=s;return o},Iy={};function $y(e,t){const o=Mu("router-view");return v(),Ye(o)}const Ty=je(Iy,[["render",$y]]);const wa=typeof document<"u";function Tp(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function My(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&Tp(e.default)}const $t=Object.assign;function Ic(e,t){const o={};for(const i in t){const s=t[i];o[i]=Wo(s)?s.map(e):e(s)}return o}const Ll=()=>{},Wo=Array.isArray;function sh(e,t){const o={};for(const i in e)o[i]=i in t?t[i]:e[i];return o}const Mp=/#/g,Ay=/&/g,Ey=/\//g,Py=/=/g,Dy=/\?/g,Ap=/\+/g,Oy=/%5B/g,Ry=/%5D/g,Ep=/%5E/g,By=/%60/g,Pp=/%7B/g,Ny=/%7C/g,Dp=/%7D/g,Fy=/%20/g;function Bu(e){return e==null?"":encodeURI(""+e).replace(Ny,"|").replace(Oy,"[").replace(Ry,"]")}function Uy(e){return Bu(e).replace(Pp,"{").replace(Dp,"}").replace(Ep,"^")}function Xc(e){return Bu(e).replace(Ap,"%2B").replace(Fy,"+").replace(Mp,"%23").replace(Ay,"%26").replace(By,"`").replace(Pp,"{").replace(Dp,"}").replace(Ep,"^")}function zy(e){return Xc(e).replace(Py,"%3D")}function Hy(e){return Bu(e).replace(Mp,"%23").replace(Dy,"%3F")}function Vy(e){return Hy(e).replace(Ey,"%2F")}function Pl(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const Gy=/\/$/,Zy=e=>e.replace(Gy,"");function $c(e,t,o="/"){let i,s={},a="",c="";const u=t.indexOf("#");let d=t.indexOf("?");return d=u>=0&&d>u?-1:d,d>=0&&(i=t.slice(0,d),a=t.slice(d,u>0?u:t.length),s=e(a.slice(1))),u>=0&&(i=i||t.slice(0,u),c=t.slice(u,t.length)),i=Ky(i??t,o),{fullPath:i+a+c,path:i,query:s,hash:Pl(c)}}function jy(e,t){const o=t.query?e(t.query):"";return t.path+(o&&"?")+o+(t.hash||"")}function ih(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function qy(e,t,o){const i=t.matched.length-1,s=o.matched.length-1;return i>-1&&i===s&&Pa(t.matched[i],o.matched[s])&&Op(t.params,o.params)&&e(t.query)===e(o.query)&&t.hash===o.hash}function Pa(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Op(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var o in e)if(!Wy(e[o],t[o]))return!1;return!0}function Wy(e,t){return Wo(e)?ah(e,t):Wo(t)?ah(t,e):e?.valueOf()===t?.valueOf()}function ah(e,t){return Wo(t)?e.length===t.length&&e.every((o,i)=>o===t[i]):e.length===1&&e[0]===t}function Ky(e,t){if(e.startsWith("/"))return e;if(!e)return t;const o=t.split("/"),i=e.split("/"),s=i[i.length-1];(s===".."||s===".")&&i.push("");let a=o.length-1,c,u;for(c=0;c<i.length;c++)if(u=i[c],u!==".")if(u==="..")a>1&&a--;else break;return o.slice(0,a).join("/")+"/"+i.slice(c).join("/")}const ci={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let Qc=(function(e){return e.pop="pop",e.push="push",e})({}),Tc=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function Yy(e){if(!e)if(wa){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Zy(e)}const Jy=/^[^#]+#/;function Xy(e,t){return e.replace(Jy,"#")+t}function Qy(e,t){const o=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-o.left-(t.left||0),top:i.top-o.top-(t.top||0)}}const Jr=()=>({left:window.scrollX,top:window.scrollY});function e_(e){let t;if("el"in e){const o=e.el,i=typeof o=="string"&&o.startsWith("#"),s=typeof o=="string"?i?document.getElementById(o.slice(1)):document.querySelector(o):o;if(!s)return;t=Qy(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function lh(e,t){return(history.state?history.state.position-t:-1)+e}const eu=new Map;function t_(e,t){eu.set(e,t)}function n_(e){const t=eu.get(e);return eu.delete(e),t}function o_(e){return typeof e=="string"||e&&typeof e=="object"}function Rp(e){return typeof e=="string"||typeof e=="symbol"}let Zt=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const Bp=Symbol("");Zt.MATCHER_NOT_FOUND+"",Zt.NAVIGATION_GUARD_REDIRECT+"",Zt.NAVIGATION_ABORTED+"",Zt.NAVIGATION_CANCELLED+"",Zt.NAVIGATION_DUPLICATED+"";function Da(e,t){return $t(new Error,{type:e,[Bp]:!0},t)}function As(e,t){return e instanceof Error&&Bp in e&&(t==null||!!(e.type&t))}const s_=["params","query","hash"];function i_(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const o of s_)o in e&&(t[o]=e[o]);return JSON.stringify(t,null,2)}function a_(e){const t={};if(e===""||e==="?")return t;const o=(e[0]==="?"?e.slice(1):e).split("&");for(let i=0;i<o.length;++i){const s=o[i].replace(Ap," "),a=s.indexOf("="),c=Pl(a<0?s:s.slice(0,a)),u=a<0?null:Pl(s.slice(a+1));if(c in t){let d=t[c];Wo(d)||(d=t[c]=[d]),d.push(u)}else t[c]=u}return t}function rh(e){let t="";for(let o in e){const i=e[o];if(o=zy(o),i==null){i!==void 0&&(t+=(t.length?"&":"")+o);continue}(Wo(i)?i.map(s=>s&&Xc(s)):[i&&Xc(i)]).forEach(s=>{s!==void 0&&(t+=(t.length?"&":"")+o,s!=null&&(t+="="+s))})}return t}function l_(e){const t={};for(const o in e){const i=e[o];i!==void 0&&(t[o]=Wo(i)?i.map(s=>s==null?null:""+s):i==null?i:""+i)}return t}const r_=Symbol(""),ch=Symbol(""),Xr=Symbol(""),Nu=Symbol(""),tu=Symbol("");function ll(){let e=[];function t(i){return e.push(i),()=>{const s=e.indexOf(i);s>-1&&e.splice(s,1)}}function o(){e=[]}return{add:t,list:()=>e.slice(),reset:o}}function vi(e,t,o,i,s,a=c=>c()){const c=i&&(i.enterCallbacks[s]=i.enterCallbacks[s]||[]);return()=>new Promise((u,d)=>{const f=k=>{k===!1?d(Da(Zt.NAVIGATION_ABORTED,{from:o,to:t})):k instanceof Error?d(k):o_(k)?d(Da(Zt.NAVIGATION_GUARD_REDIRECT,{from:t,to:k})):(c&&i.enterCallbacks[s]===c&&typeof k=="function"&&c.push(k),u())},p=a(()=>e.call(i&&i.instances[s],t,o,f));let g=Promise.resolve(p);e.length<3&&(g=g.then(f)),g.catch(k=>d(k))})}function Mc(e,t,o,i,s=a=>a()){const a=[];for(const c of e)for(const u in c.components){let d=c.components[u];if(!(t!=="beforeRouteEnter"&&!c.instances[u]))if(Tp(d)){const f=(d.__vccOpts||d)[t];f&&a.push(vi(f,o,i,c,u,s))}else{let f=d();a.push(()=>f.then(p=>{if(!p)throw new Error(`Couldn't resolve component "${u}" at "${c.path}"`);const g=My(p)?p.default:p;c.mods[u]=p,c.components[u]=g;const k=(g.__vccOpts||g)[t];return k&&vi(k,o,i,c,u,s)()}))}}return a}function c_(e,t){const o=[],i=[],s=[],a=Math.max(t.matched.length,e.matched.length);for(let c=0;c<a;c++){const u=t.matched[c];u&&(e.matched.find(f=>Pa(f,u))?i.push(u):o.push(u));const d=e.matched[c];d&&(t.matched.find(f=>Pa(f,d))||s.push(d))}return[o,i,s]}let u_=()=>location.protocol+"//"+location.host;function Np(e,t){const{pathname:o,search:i,hash:s}=t,a=e.indexOf("#");if(a>-1){let c=s.includes(e.slice(a))?e.slice(a).length:1,u=s.slice(c);return u[0]!=="/"&&(u="/"+u),ih(u,"")}return ih(o,e)+i+s}function d_(e,t,o,i){let s=[],a=[],c=null;const u=({state:k})=>{const _=Np(e,location),b=o.value,C=t.value;let E=0;if(k){if(o.value=_,t.value=k,c&&c===b){c=null;return}E=C?k.position-C.position:0}else i(_);s.forEach(D=>{D(o.value,b,{delta:E,type:Qc.pop,direction:E?E>0?Tc.forward:Tc.back:Tc.unknown})})};function d(){c=o.value}function f(k){s.push(k);const _=()=>{const b=s.indexOf(k);b>-1&&s.splice(b,1)};return a.push(_),_}function p(){if(document.visibilityState==="hidden"){const{history:k}=window;if(!k.state)return;k.replaceState($t({},k.state,{scroll:Jr()}),"")}}function g(){for(const k of a)k();a=[],window.removeEventListener("popstate",u),window.removeEventListener("pagehide",p),document.removeEventListener("visibilitychange",p)}return window.addEventListener("popstate",u),window.addEventListener("pagehide",p),document.addEventListener("visibilitychange",p),{pauseListeners:d,listen:f,destroy:g}}function uh(e,t,o,i=!1,s=!1){return{back:e,current:t,forward:o,replaced:i,position:window.history.length,scroll:s?Jr():null}}function h_(e){const{history:t,location:o}=window,i={value:Np(e,o)},s={value:t.state};s.value||a(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function a(d,f,p){const g=e.indexOf("#"),k=g>-1?(o.host&&document.querySelector("base")?e:e.slice(g))+d:u_()+e+d;try{t[p?"replaceState":"pushState"](f,"",k),s.value=f}catch(_){console.error(_),o[p?"replace":"assign"](k)}}function c(d,f){a(d,$t({},t.state,uh(s.value.back,d,s.value.forward,!0),f,{position:s.value.position}),!0),i.value=d}function u(d,f){const p=$t({},s.value,t.state,{forward:d,scroll:Jr()});a(p.current,p,!0),a(d,$t({},uh(i.value,d,null),{position:p.position+1},f),!1),i.value=d}return{location:i,state:s,push:u,replace:c}}function f_(e){e=Yy(e);const t=h_(e),o=d_(e,t.state,t.location,t.replace);function i(a,c=!0){c||o.pauseListeners(),history.go(a)}const s=$t({location:"",base:e,go:i,createHref:Xy.bind(null,e)},t,o);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function p_(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),f_(e)}let qi=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var sn=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(sn||{});const v_={type:qi.Static,value:""},m_=/[a-zA-Z0-9_]/;function g_(e){if(!e)return[[]];if(e==="/")return[[v_]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(_){throw new Error(`ERR (${o})/"${f}": ${_}`)}let o=sn.Static,i=o;const s=[];let a;function c(){a&&s.push(a),a=[]}let u=0,d,f="",p="";function g(){f&&(o===sn.Static?a.push({type:qi.Static,value:f}):o===sn.Param||o===sn.ParamRegExp||o===sn.ParamRegExpEnd?(a.length>1&&(d==="*"||d==="+")&&t(`A repeatable param (${f}) must be alone in its segment. eg: '/:ids+.`),a.push({type:qi.Param,value:f,regexp:p,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):t("Invalid state to consume buffer"),f="")}function k(){f+=d}for(;u<e.length;){if(d=e[u++],d==="\\"&&o!==sn.ParamRegExp){i=o,o=sn.EscapeNext;continue}switch(o){case sn.Static:d==="/"?(f&&g(),c()):d===":"?(g(),o=sn.Param):k();break;case sn.EscapeNext:k(),o=i;break;case sn.Param:d==="("?o=sn.ParamRegExp:m_.test(d)?k():(g(),o=sn.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--);break;case sn.ParamRegExp:d===")"?p[p.length-1]=="\\"?p=p.slice(0,-1)+d:o=sn.ParamRegExpEnd:p+=d;break;case sn.ParamRegExpEnd:g(),o=sn.Static,d!=="*"&&d!=="?"&&d!=="+"&&u--,p="";break;default:t("Unknown state");break}}return o===sn.ParamRegExp&&t(`Unfinished custom RegExp for param "${f}"`),g(),c(),s}const dh="[^/]+?",y_={sensitive:!1,strict:!1,start:!0,end:!0};var Bn=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(Bn||{});const __=/[.+*?^${}()[\]/\\]/g;function k_(e,t){const o=$t({},y_,t),i=[];let s=o.start?"^":"";const a=[];for(const f of e){const p=f.length?[]:[Bn.Root];o.strict&&!f.length&&(s+="/");for(let g=0;g<f.length;g++){const k=f[g];let _=Bn.Segment+(o.sensitive?Bn.BonusCaseSensitive:0);if(k.type===qi.Static)g||(s+="/"),s+=k.value.replace(__,"\\$&"),_+=Bn.Static;else if(k.type===qi.Param){const{value:b,repeatable:C,optional:E,regexp:D}=k;a.push({name:b,repeatable:C,optional:E});const M=D||dh;if(M!==dh){_+=Bn.BonusCustomRegExp;try{`${M}`}catch($){throw new Error(`Invalid custom RegExp for param "${b}" (${M}): `+$.message)}}let S=C?`((?:${M})(?:/(?:${M}))*)`:`(${M})`;g||(S=E&&f.length<2?`(?:/${S})`:"/"+S),E&&(S+="?"),s+=S,_+=Bn.Dynamic,E&&(_+=Bn.BonusOptional),C&&(_+=Bn.BonusRepeatable),M===".*"&&(_+=Bn.BonusWildcard)}p.push(_)}i.push(p)}if(o.strict&&o.end){const f=i.length-1;i[f][i[f].length-1]+=Bn.BonusStrict}o.strict||(s+="/?"),o.end?s+="$":o.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const c=new RegExp(s,o.sensitive?"":"i");function u(f){const p=f.match(c),g={};if(!p)return null;for(let k=1;k<p.length;k++){const _=p[k]||"",b=a[k-1];g[b.name]=_&&b.repeatable?_.split("/"):_}return g}function d(f){let p="",g=!1;for(const k of e){(!g||!p.endsWith("/"))&&(p+="/"),g=!1;for(const _ of k)if(_.type===qi.Static)p+=_.value;else if(_.type===qi.Param){const{value:b,repeatable:C,optional:E}=_,D=b in f?f[b]:"";if(Wo(D)&&!C)throw new Error(`Provided param "${b}" is an array but it is not repeatable (* or + modifiers)`);const M=Wo(D)?D.join("/"):D;if(!M)if(E)k.length<2&&(p.endsWith("/")?p=p.slice(0,-1):g=!0);else throw new Error(`Missing required param "${b}"`);p+=M}}return p||"/"}return{re:c,score:i,keys:a,parse:u,stringify:d}}function b_(e,t){let o=0;for(;o<e.length&&o<t.length;){const i=t[o]-e[o];if(i)return i;o++}return e.length<t.length?e.length===1&&e[0]===Bn.Static+Bn.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===Bn.Static+Bn.Segment?1:-1:0}function Fp(e,t){let o=0;const i=e.score,s=t.score;for(;o<i.length&&o<s.length;){const a=b_(i[o],s[o]);if(a)return a;o++}if(Math.abs(s.length-i.length)===1){if(hh(i))return 1;if(hh(s))return-1}return s.length-i.length}function hh(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const w_={strict:!1,end:!0,sensitive:!1};function C_(e,t,o){const i=k_(g_(e.path),o),s=$t(i,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function L_(e,t){const o=[],i=new Map;t=sh(w_,t);function s(g){return i.get(g)}function a(g,k,_){const b=!_,C=ph(g);C.aliasOf=_&&_.record;const E=sh(t,g),D=[C];if("alias"in g){const $=typeof g.alias=="string"?[g.alias]:g.alias;for(const A of $)D.push(ph($t({},C,{components:_?_.record.components:C.components,path:A,aliasOf:_?_.record:C})))}let M,S;for(const $ of D){const{path:A}=$;if(k&&A[0]!=="/"){const U=k.record.path,I=U[U.length-1]==="/"?"":"/";$.path=k.record.path+(A&&I+A)}if(M=C_($,k,E),_?_.alias.push(M):(S=S||M,S!==M&&S.alias.push(M),b&&g.name&&!vh(M)&&c(g.name)),Up(M)&&d(M),C.children){const U=C.children;for(let I=0;I<U.length;I++)a(U[I],M,_&&_.children[I])}_=_||M}return S?()=>{c(S)}:Ll}function c(g){if(Rp(g)){const k=i.get(g);k&&(i.delete(g),o.splice(o.indexOf(k),1),k.children.forEach(c),k.alias.forEach(c))}else{const k=o.indexOf(g);k>-1&&(o.splice(k,1),g.record.name&&i.delete(g.record.name),g.children.forEach(c),g.alias.forEach(c))}}function u(){return o}function d(g){const k=I_(g,o);o.splice(k,0,g),g.record.name&&!vh(g)&&i.set(g.record.name,g)}function f(g,k){let _,b={},C,E;if("name"in g&&g.name){if(_=i.get(g.name),!_)throw Da(Zt.MATCHER_NOT_FOUND,{location:g});E=_.record.name,b=$t(fh(k.params,_.keys.filter(S=>!S.optional).concat(_.parent?_.parent.keys.filter(S=>S.optional):[]).map(S=>S.name)),g.params&&fh(g.params,_.keys.map(S=>S.name))),C=_.stringify(b)}else if(g.path!=null)C=g.path,_=o.find(S=>S.re.test(C)),_&&(b=_.parse(C),E=_.record.name);else{if(_=k.name?i.get(k.name):o.find(S=>S.re.test(k.path)),!_)throw Da(Zt.MATCHER_NOT_FOUND,{location:g,currentLocation:k});E=_.record.name,b=$t({},k.params,g.params),C=_.stringify(b)}const D=[];let M=_;for(;M;)D.unshift(M.record),M=M.parent;return{name:E,path:C,params:b,matched:D,meta:x_(D)}}e.forEach(g=>a(g));function p(){o.length=0,i.clear()}return{addRoute:a,resolve:f,removeRoute:c,clearRoutes:p,getRoutes:u,getRecordMatcher:s}}function fh(e,t){const o={};for(const i of t)i in e&&(o[i]=e[i]);return o}function ph(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:S_(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function S_(e){const t={},o=e.props||!1;if("component"in e)t.default=o;else for(const i in e.components)t[i]=typeof o=="object"?o[i]:o;return t}function vh(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function x_(e){return e.reduce((t,o)=>$t(t,o.meta),{})}function I_(e,t){let o=0,i=t.length;for(;o!==i;){const a=o+i>>1;Fp(e,t[a])<0?i=a:o=a+1}const s=$_(e);return s&&(i=t.lastIndexOf(s,i-1)),i}function $_(e){let t=e;for(;t=t.parent;)if(Up(t)&&Fp(e,t)===0)return t}function Up({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function mh(e){const t=xo(Xr),o=xo(Nu),i=Z(()=>{const d=j(e.to);return t.resolve(d)}),s=Z(()=>{const{matched:d}=i.value,{length:f}=d,p=d[f-1],g=o.matched;if(!p||!g.length)return-1;const k=g.findIndex(Pa.bind(null,p));if(k>-1)return k;const _=gh(d[f-2]);return f>1&&gh(p)===_&&g[g.length-1].path!==_?g.findIndex(Pa.bind(null,d[f-2])):k}),a=Z(()=>s.value>-1&&P_(o.params,i.value.params)),c=Z(()=>s.value>-1&&s.value===o.matched.length-1&&Op(o.params,i.value.params));function u(d={}){if(E_(d)){const f=t[j(e.replace)?"replace":"push"](j(e.to)).catch(Ll);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>f),f}return Promise.resolve()}return{route:i,href:Z(()=>i.value.href),isActive:a,isExactActive:c,navigate:u}}function T_(e){return e.length===1?e[0]:e}const M_=qf({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:mh,setup(e,{slots:t}){const o=Bl(mh(e)),{options:i}=xo(Xr),s=Z(()=>({[yh(e.activeClass,i.linkActiveClass,"router-link-active")]:o.isActive,[yh(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:o.isExactActive}));return()=>{const a=t.default&&T_(t.default(o));return e.custom?a:Ou("a",{"aria-current":o.isExactActive?e.ariaCurrentValue:null,href:o.href,onClick:o.navigate,class:s.value},a)}}}),A_=M_;function E_(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function P_(e,t){for(const o in t){const i=t[o],s=e[o];if(typeof i=="string"){if(i!==s)return!1}else if(!Wo(s)||s.length!==i.length||i.some((a,c)=>a.valueOf()!==s[c].valueOf()))return!1}return!0}function gh(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const yh=(e,t,o)=>e??t??o,D_=qf({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:o}){const i=xo(tu),s=Z(()=>e.route||i.value),a=xo(ch,0),c=Z(()=>{let f=j(a);const{matched:p}=s.value;let g;for(;(g=p[f])&&!g.components;)f++;return f}),u=Z(()=>s.value.matched[c.value]);cr(ch,Z(()=>c.value+1)),cr(r_,u),cr(tu,s);const d=T();return Ge(()=>[d.value,u.value,e.name],([f,p,g],[k,_,b])=>{p&&(p.instances[g]=f,_&&_!==p&&f&&f===k&&(p.leaveGuards.size||(p.leaveGuards=_.leaveGuards),p.updateGuards.size||(p.updateGuards=_.updateGuards))),f&&p&&(!_||!Pa(p,_)||!k)&&(p.enterCallbacks[g]||[]).forEach(C=>C(f))},{flush:"post"}),()=>{const f=s.value,p=e.name,g=u.value,k=g&&g.components[p];if(!k)return _h(o.default,{Component:k,route:f});const _=g.props[p],b=_?_===!0?f.params:typeof _=="function"?_(f):_:null,E=Ou(k,$t({},b,t,{onVnodeUnmounted:D=>{D.component.isUnmounted&&(g.instances[p]=null)},ref:d}));return _h(o.default,{Component:E,route:f})||E}}});function _h(e,t){if(!e)return null;const o=e(t);return o.length===1?o[0]:o}const O_=D_;function R_(e){const t=L_(e.routes,e),o=e.parseQuery||a_,i=e.stringifyQuery||rh,s=e.history,a=ll(),c=ll(),u=ll(),d=xm(ci);let f=ci;wa&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const p=Ic.bind(null,be=>""+be),g=Ic.bind(null,Vy),k=Ic.bind(null,Pl);function _(be,ze){let fe,Le;return Rp(be)?(fe=t.getRecordMatcher(be),Le=ze):Le=be,t.addRoute(Le,fe)}function b(be){const ze=t.getRecordMatcher(be);ze&&t.removeRoute(ze)}function C(){return t.getRoutes().map(be=>be.record)}function E(be){return!!t.getRecordMatcher(be)}function D(be,ze){if(ze=$t({},ze||d.value),typeof be=="string"){const ue=$c(o,be,ze.path),ye=t.resolve({path:ue.path},ze),ae=s.createHref(ue.fullPath);return $t(ue,ye,{params:k(ye.params),hash:Pl(ue.hash),redirectedFrom:void 0,href:ae})}let fe;if(be.path!=null)fe=$t({},be,{path:$c(o,be.path,ze.path).path});else{const ue=$t({},be.params);for(const ye in ue)ue[ye]==null&&delete ue[ye];fe=$t({},be,{params:g(ue)}),ze.params=g(ze.params)}const Le=t.resolve(fe,ze),Ae=be.hash||"";Le.params=p(k(Le.params));const W=jy(i,$t({},be,{hash:Uy(Ae),path:Le.path})),J=s.createHref(W);return $t({fullPath:W,hash:Ae,query:i===rh?l_(be.query):be.query||{}},Le,{redirectedFrom:void 0,href:J})}function M(be){return typeof be=="string"?$c(o,be,d.value.path):$t({},be)}function S(be,ze){if(f!==be)return Da(Zt.NAVIGATION_CANCELLED,{from:ze,to:be})}function $(be){return I(be)}function A(be){return $($t(M(be),{replace:!0}))}function U(be,ze){const fe=be.matched[be.matched.length-1];if(fe&&fe.redirect){const{redirect:Le}=fe;let Ae=typeof Le=="function"?Le(be,ze):Le;return typeof Ae=="string"&&(Ae=Ae.includes("?")||Ae.includes("#")?Ae=M(Ae):{path:Ae},Ae.params={}),$t({query:be.query,hash:be.hash,params:Ae.path!=null?{}:be.params},Ae)}}function I(be,ze){const fe=f=D(be),Le=d.value,Ae=be.state,W=be.force,J=be.replace===!0,ue=U(fe,Le);if(ue)return I($t(M(ue),{state:typeof ue=="object"?$t({},Ae,ue.state):Ae,force:W,replace:J}),ze||fe);const ye=fe;ye.redirectedFrom=ze;let ae;return!W&&qy(i,Le,fe)&&(ae=Da(Zt.NAVIGATION_DUPLICATED,{to:ye,from:Le}),re(Le,Le,!0,!1)),(ae?Promise.resolve(ae):q(ye,Le)).catch(ie=>As(ie)?As(ie,Zt.NAVIGATION_GUARD_REDIRECT)?ie:ke(ie):ce(ie,ye,Le)).then(ie=>{if(ie){if(As(ie,Zt.NAVIGATION_GUARD_REDIRECT))return I($t({replace:J},M(ie.to),{state:typeof ie.to=="object"?$t({},Ae,ie.to.state):Ae,force:W}),ze||ye)}else ie=Q(ye,Le,!0,J,Ae);return V(ye,Le,ie),ie})}function H(be,ze){const fe=S(be,ze);return fe?Promise.reject(fe):Promise.resolve()}function O(be){const ze=tt.values().next().value;return ze&&typeof ze.runWithContext=="function"?ze.runWithContext(be):be()}function q(be,ze){let fe;const[Le,Ae,W]=c_(be,ze);fe=Mc(Le.reverse(),"beforeRouteLeave",be,ze);for(const ue of Le)ue.leaveGuards.forEach(ye=>{fe.push(vi(ye,be,ze))});const J=H.bind(null,be,ze);return fe.push(J),Qe(fe).then(()=>{fe=[];for(const ue of a.list())fe.push(vi(ue,be,ze));return fe.push(J),Qe(fe)}).then(()=>{fe=Mc(Ae,"beforeRouteUpdate",be,ze);for(const ue of Ae)ue.updateGuards.forEach(ye=>{fe.push(vi(ye,be,ze))});return fe.push(J),Qe(fe)}).then(()=>{fe=[];for(const ue of W)if(ue.beforeEnter)if(Wo(ue.beforeEnter))for(const ye of ue.beforeEnter)fe.push(vi(ye,be,ze));else fe.push(vi(ue.beforeEnter,be,ze));return fe.push(J),Qe(fe)}).then(()=>(be.matched.forEach(ue=>ue.enterCallbacks={}),fe=Mc(W,"beforeRouteEnter",be,ze,O),fe.push(J),Qe(fe))).then(()=>{fe=[];for(const ue of c.list())fe.push(vi(ue,be,ze));return fe.push(J),Qe(fe)}).catch(ue=>As(ue,Zt.NAVIGATION_CANCELLED)?ue:Promise.reject(ue))}function V(be,ze,fe){u.list().forEach(Le=>O(()=>Le(be,ze,fe)))}function Q(be,ze,fe,Le,Ae){const W=S(be,ze);if(W)return W;const J=ze===ci,ue=wa?history.state:{};fe&&(Le||J?s.replace(be.fullPath,$t({scroll:J&&ue&&ue.scroll},Ae)):s.push(be.fullPath,Ae)),d.value=be,re(be,ze,fe,J),ke()}let de;function Ee(){de||(de=s.listen((be,ze,fe)=>{if(!qe.listening)return;const Le=D(be),Ae=U(Le,qe.currentRoute.value);if(Ae){I($t(Ae,{replace:!0,force:!0}),Le).catch(Ll);return}f=Le;const W=d.value;wa&&t_(lh(W.fullPath,fe.delta),Jr()),q(Le,W).catch(J=>As(J,Zt.NAVIGATION_ABORTED|Zt.NAVIGATION_CANCELLED)?J:As(J,Zt.NAVIGATION_GUARD_REDIRECT)?(I($t(M(J.to),{force:!0}),Le).then(ue=>{As(ue,Zt.NAVIGATION_ABORTED|Zt.NAVIGATION_DUPLICATED)&&!fe.delta&&fe.type===Qc.pop&&s.go(-1,!1)}).catch(Ll),Promise.reject()):(fe.delta&&s.go(-fe.delta,!1),ce(J,Le,W))).then(J=>{J=J||Q(Le,W,!1),J&&(fe.delta&&!As(J,Zt.NAVIGATION_CANCELLED)?s.go(-fe.delta,!1):fe.type===Qc.pop&&As(J,Zt.NAVIGATION_ABORTED|Zt.NAVIGATION_DUPLICATED)&&s.go(-1,!1)),V(Le,W,J)}).catch(Ll)}))}let ge=ll(),Pe=ll(),Fe;function ce(be,ze,fe){ke(be);const Le=Pe.list();return Le.length?Le.forEach(Ae=>Ae(be,ze,fe)):console.error(be),Promise.reject(be)}function Me(){return Fe&&d.value!==ci?Promise.resolve():new Promise((be,ze)=>{ge.add([be,ze])})}function ke(be){return Fe||(Fe=!be,Ee(),ge.list().forEach(([ze,fe])=>be?fe(be):ze()),ge.reset()),be}function re(be,ze,fe,Le){const{scrollBehavior:Ae}=e;if(!wa||!Ae)return Promise.resolve();const W=!fe&&n_(lh(be.fullPath,0))||(Le||!fe)&&history.state&&history.state.scroll||null;return Un().then(()=>Ae(be,ze,W)).then(J=>J&&e_(J)).catch(J=>ce(J,be,ze))}const Re=be=>s.go(be);let Je;const tt=new Set,qe={currentRoute:d,listening:!0,addRoute:_,removeRoute:b,clearRoutes:t.clearRoutes,hasRoute:E,getRoutes:C,resolve:D,options:e,push:$,replace:A,go:Re,back:()=>Re(-1),forward:()=>Re(1),beforeEach:a.add,beforeResolve:c.add,afterEach:u.add,onError:Pe.add,isReady:Me,install(be){be.component("RouterLink",A_),be.component("RouterView",O_),be.config.globalProperties.$router=qe,Object.defineProperty(be.config.globalProperties,"$route",{enumerable:!0,get:()=>j(d)}),wa&&!Je&&d.value===ci&&(Je=!0,$(s.location).catch(Le=>{}));const ze={};for(const Le in ci)Object.defineProperty(ze,Le,{get:()=>d.value[Le],enumerable:!0});be.provide(Xr,qe),be.provide(Nu,If(ze)),be.provide(tu,d);const fe=be.unmount;tt.add(be),be.unmount=function(){tt.delete(be),tt.size<1&&(f=ci,de&&de(),de=null,d.value=ci,Je=!1,Fe=!1),fe()}}};function Qe(be){return be.reduce((ze,fe)=>ze.then(()=>O(fe)),Promise.resolve())}return qe}function Na(){return xo(Xr)}function Qr(e){return xo(Nu)}const B_={class:"hero-animation-container"},N_={__name:"HeroMapAnimation",setup(e){const t=T(!1);return Wt(()=>{requestAnimationFrame(()=>{t.value=!0})}),(o,i)=>(v(),m("div",B_,[(v(),m("svg",{viewBox:"0 0 400 350",class:pe(["hero-map-svg",{animate:t.value}])},[...i[0]||(i[0]=[Lr(`<defs data-v-1b7f6f65><clipPath id="mapClip" data-v-1b7f6f65><polygon points="80,0 320,0 420,350 -20,350" data-v-1b7f6f65></polygon></clipPath></defs><g class="map-group" data-v-1b7f6f65><polygon points="80,0 320,0 420,350 -20,350" fill="#c8e6c0" stroke="#8fbc8f" stroke-width="3" data-v-1b7f6f65></polygon><g clip-path="url(#mapClip)" class="contours" data-v-1b7f6f65><ellipse cx="300" cy="60" rx="35" ry="12" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="300" cy="60" rx="25" ry="8" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="300" cy="60" rx="15" ry="5" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="80" cy="220" rx="80" ry="40" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="80" cy="220" rx="55" ry="28" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="80" cy="220" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="320" cy="180" rx="50" ry="25" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse><ellipse cx="320" cy="180" rx="30" ry="15" fill="none" stroke="#b8d4b0" stroke-width="1.5" data-v-1b7f6f65></ellipse></g><g clip-path="url(#mapClip)" class="roads" data-v-1b7f6f65><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#1a5276" stroke-width="18" stroke-linecap="round" data-v-1b7f6f65></path><path d="M 30,350 Q 80,300 100,250 C 120,200 90,150 110,100 Q 130,50 160,-10" fill="none" stroke="#5dade2" stroke-width="12" stroke-linecap="round" data-v-1b7f6f65></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#cc8800" stroke-width="10" stroke-linecap="round" data-v-1b7f6f65></path><path d="M -20,180 Q 80,160 160,150 T 300,100 Q 340,80 380,50" fill="none" stroke="#ffcc00" stroke-width="6" stroke-linecap="round" data-v-1b7f6f65></path></g><path id="routePath" d="M 60,360
             L 200,250
             L 150,150
             L 280,100
             L 450,60" fill="none" stroke="none" data-v-1b7f6f65></path><g class="trail-segments" data-v-1b7f6f65><path class="trail-seg trail-seg-1" d="M 60,360 L 200,250" fill="none" stroke="#dc3545" stroke-width="12" stroke-linecap="round" stroke-linejoin="round" data-v-1b7f6f65></path><path class="trail-seg trail-seg-2" d="M 200,250 L 150,150" fill="none" stroke="#dc3545" stroke-width="9" stroke-linecap="round" stroke-linejoin="round" data-v-1b7f6f65></path><path class="trail-seg trail-seg-3" d="M 150,150 L 280,100" fill="none" stroke="#dc3545" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" data-v-1b7f6f65></path><path class="trail-seg trail-seg-4" d="M 280,100 L 450,60" fill="none" stroke="#dc3545" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" data-v-1b7f6f65></path></g><g class="checkpoint checkpoint-1" transform="translate(200, 250)" data-v-1b7f6f65><ellipse cx="0" cy="8" rx="40" ry="12" fill="#4a5aba" opacity="0.4" data-v-1b7f6f65></ellipse><ellipse cx="0" cy="4" rx="30" ry="10" fill="#667eea" data-v-1b7f6f65></ellipse><ellipse cx="0" cy="0" rx="25" ry="8" fill="#8b9ff0" data-v-1b7f6f65></ellipse></g><g class="checkpoint checkpoint-2" transform="translate(150, 150)" data-v-1b7f6f65><ellipse cx="0" cy="6" rx="18" ry="8" fill="#4a5aba" opacity="0.4" data-v-1b7f6f65></ellipse><ellipse cx="0" cy="3" rx="15" ry="6" fill="#667eea" data-v-1b7f6f65></ellipse><ellipse cx="0" cy="0" rx="12" ry="5" fill="#8b9ff0" data-v-1b7f6f65></ellipse></g><g class="checkpoint checkpoint-3" transform="translate(280, 100)" data-v-1b7f6f65><ellipse cx="0" cy="4" rx="12" ry="5" fill="#4a5aba" opacity="0.4" data-v-1b7f6f65></ellipse><ellipse cx="0" cy="2" rx="10" ry="4" fill="#667eea" data-v-1b7f6f65></ellipse><ellipse cx="0" cy="0" rx="8" ry="3" fill="#8b9ff0" data-v-1b7f6f65></ellipse></g><g class="marshal marshal-1" transform="translate(200, 250)" data-v-1b7f6f65><circle cx="0" cy="-28" r="12" fill="#444" data-v-1b7f6f65></circle><path d="M 20,0 v-8 a12 12 0 0 0-12-12 h-16 a12 12 0 0 0-12 12 v8" fill="#444" data-v-1b7f6f65></path></g><g class="marshal marshal-2" transform="translate(150, 150)" data-v-1b7f6f65><circle cx="0" cy="-18" r="8" fill="#444" data-v-1b7f6f65></circle><path d="M 12,0 v-5 a8 8 0 0 0-8-8 h-8 a8 8 0 0 0-8 8 v5" fill="#444" data-v-1b7f6f65></path></g><g class="marshal marshal-3" transform="translate(280, 100)" data-v-1b7f6f65><circle cx="0" cy="-12" r="6" fill="#444" data-v-1b7f6f65></circle><path d="M 9,0 v-4 a6 6 0 0 0-6-6 h-6 a6 6 0 0 0-6 6 v4" fill="#444" data-v-1b7f6f65></path></g><g clip-path="url(#mapClip)" class="trees" data-v-1b7f6f65><g transform="translate(45, 280)" data-v-1b7f6f65><polygon points="0,-20 12,0 -12,0" fill="#2d5a2d" data-v-1b7f6f65></polygon><polygon points="0,-34 10,-12 -10,-12" fill="#2d5a2d" data-v-1b7f6f65></polygon><polygon points="0,-46 8,-26 -8,-26" fill="#2d5a2d" data-v-1b7f6f65></polygon><rect x="-3" y="0" width="6" height="8" fill="#5d4037" data-v-1b7f6f65></rect></g><g transform="translate(75, 255)" data-v-1b7f6f65><polygon points="0,-18 10,0 -10,0" fill="#3d6a3d" data-v-1b7f6f65></polygon><polygon points="0,-30 8,-10 -8,-10" fill="#3d6a3d" data-v-1b7f6f65></polygon><polygon points="0,-40 6,-22 -6,-22" fill="#3d6a3d" data-v-1b7f6f65></polygon><rect x="-2.5" y="0" width="5" height="6" fill="#5d4037" data-v-1b7f6f65></rect></g><g transform="translate(350, 230)" data-v-1b7f6f65><polygon points="0,-20 11,0 -11,0" fill="#2d5a2d" data-v-1b7f6f65></polygon><polygon points="0,-33 9,-11 -9,-11" fill="#2d5a2d" data-v-1b7f6f65></polygon><polygon points="0,-44 7,-24 -7,-24" fill="#2d5a2d" data-v-1b7f6f65></polygon><rect x="-2.5" y="0" width="5" height="7" fill="#5d4037" data-v-1b7f6f65></rect></g><g transform="translate(60, 140)" data-v-1b7f6f65><polygon points="0,-12 7,0 -7,0" fill="#3d6a3d" data-v-1b7f6f65></polygon><polygon points="0,-20 5.5,-8 -5.5,-8" fill="#3d6a3d" data-v-1b7f6f65></polygon><polygon points="0,-27 4,-15 -4,-15" fill="#3d6a3d" data-v-1b7f6f65></polygon><rect x="-1.5" y="0" width="3" height="4" fill="#5d4037" data-v-1b7f6f65></rect></g><g transform="translate(320, 70)" data-v-1b7f6f65><polygon points="0,-9 5,0 -5,0" fill="#2d5a2d" data-v-1b7f6f65></polygon><polygon points="0,-15 4,-6 -4,-6" fill="#2d5a2d" data-v-1b7f6f65></polygon><polygon points="0,-20 3,-11 -3,-11" fill="#2d5a2d" data-v-1b7f6f65></polygon><rect x="-1" y="0" width="2" height="3" fill="#5d4037" data-v-1b7f6f65></rect></g><g transform="translate(320, 140)" data-v-1b7f6f65><polygon points="0,-14 8,0 -8,0" fill="#3d6a3d" data-v-1b7f6f65></polygon><polygon points="0,-24 6,-9 -6,-9" fill="#3d6a3d" data-v-1b7f6f65></polygon><polygon points="0,-32 5,-18 -5,-18" fill="#3d6a3d" data-v-1b7f6f65></polygon><rect x="-1.5" y="0" width="3" height="5" fill="#5d4037" data-v-1b7f6f65></rect></g></g></g>`,2)])],2))]))}},F_=je(N_,[["__scopeId","data-v-1b7f6f65"]]);function zp(e,t){return function(){return e.apply(t,arguments)}}const{toString:U_}=Object.prototype,{getPrototypeOf:Fu}=Object,{iterator:ec,toStringTag:Hp}=Symbol,tc=(e=>t=>{const o=U_.call(t);return e[o]||(e[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),Ko=e=>(e=e.toLowerCase(),t=>tc(t)===e),nc=e=>t=>typeof t===e,{isArray:Fa}=Array,Oa=nc("undefined");function Ul(e){return e!==null&&!Oa(e)&&e.constructor!==null&&!Oa(e.constructor)&&Qn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Vp=Ko("ArrayBuffer");function z_(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Vp(e.buffer),t}const H_=nc("string"),Qn=nc("function"),Gp=nc("number"),zl=e=>e!==null&&typeof e=="object",V_=e=>e===!0||e===!1,fr=e=>{if(tc(e)!=="object")return!1;const t=Fu(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Hp in e)&&!(ec in e)},G_=e=>{if(!zl(e)||Ul(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Z_=Ko("Date"),j_=Ko("File"),q_=Ko("Blob"),W_=Ko("FileList"),K_=e=>zl(e)&&Qn(e.pipe),Y_=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Qn(e.append)&&((t=tc(e))==="formdata"||t==="object"&&Qn(e.toString)&&e.toString()==="[object FormData]"))},J_=Ko("URLSearchParams"),[X_,Q_,e1,t1]=["ReadableStream","Request","Response","Headers"].map(Ko),n1=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Hl(e,t,{allOwnKeys:o=!1}={}){if(e===null||typeof e>"u")return;let i,s;if(typeof e!="object"&&(e=[e]),Fa(e))for(i=0,s=e.length;i<s;i++)t.call(null,e[i],i,e);else{if(Ul(e))return;const a=o?Object.getOwnPropertyNames(e):Object.keys(e),c=a.length;let u;for(i=0;i<c;i++)u=a[i],t.call(null,e[u],u,e)}}function Zp(e,t){if(Ul(e))return null;t=t.toLowerCase();const o=Object.keys(e);let i=o.length,s;for(;i-- >0;)if(s=o[i],t===s.toLowerCase())return s;return null}const Wi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,jp=e=>!Oa(e)&&e!==Wi;function nu(){const{caseless:e,skipUndefined:t}=jp(this)&&this||{},o={},i=(s,a)=>{const c=e&&Zp(o,a)||a;fr(o[c])&&fr(s)?o[c]=nu(o[c],s):fr(s)?o[c]=nu({},s):Fa(s)?o[c]=s.slice():(!t||!Oa(s))&&(o[c]=s)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&Hl(arguments[s],i);return o}const o1=(e,t,o,{allOwnKeys:i}={})=>(Hl(t,(s,a)=>{o&&Qn(s)?e[a]=zp(s,o):e[a]=s},{allOwnKeys:i}),e),s1=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),i1=(e,t,o,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),o&&Object.assign(e.prototype,o)},a1=(e,t,o,i)=>{let s,a,c;const u={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),a=s.length;a-- >0;)c=s[a],(!i||i(c,e,t))&&!u[c]&&(t[c]=e[c],u[c]=!0);e=o!==!1&&Fu(e)}while(e&&(!o||o(e,t))&&e!==Object.prototype);return t},l1=(e,t,o)=>{e=String(e),(o===void 0||o>e.length)&&(o=e.length),o-=t.length;const i=e.indexOf(t,o);return i!==-1&&i===o},r1=e=>{if(!e)return null;if(Fa(e))return e;let t=e.length;if(!Gp(t))return null;const o=new Array(t);for(;t-- >0;)o[t]=e[t];return o},c1=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Fu(Uint8Array)),u1=(e,t)=>{const i=(e&&e[ec]).call(e);let s;for(;(s=i.next())&&!s.done;){const a=s.value;t.call(e,a[0],a[1])}},d1=(e,t)=>{let o;const i=[];for(;(o=e.exec(t))!==null;)i.push(o);return i},h1=Ko("HTMLFormElement"),f1=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,i,s){return i.toUpperCase()+s}),kh=(({hasOwnProperty:e})=>(t,o)=>e.call(t,o))(Object.prototype),p1=Ko("RegExp"),qp=(e,t)=>{const o=Object.getOwnPropertyDescriptors(e),i={};Hl(o,(s,a)=>{let c;(c=t(s,a,e))!==!1&&(i[a]=c||s)}),Object.defineProperties(e,i)},v1=e=>{qp(e,(t,o)=>{if(Qn(e)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const i=e[o];if(Qn(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},m1=(e,t)=>{const o={},i=s=>{s.forEach(a=>{o[a]=!0})};return Fa(e)?i(e):i(String(e).split(t)),o},g1=()=>{},y1=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function _1(e){return!!(e&&Qn(e.append)&&e[Hp]==="FormData"&&e[ec])}const k1=e=>{const t=new Array(10),o=(i,s)=>{if(zl(i)){if(t.indexOf(i)>=0)return;if(Ul(i))return i;if(!("toJSON"in i)){t[s]=i;const a=Fa(i)?[]:{};return Hl(i,(c,u)=>{const d=o(c,s+1);!Oa(d)&&(a[u]=d)}),t[s]=void 0,a}}return i};return o(e,0)},b1=Ko("AsyncFunction"),w1=e=>e&&(zl(e)||Qn(e))&&Qn(e.then)&&Qn(e.catch),Wp=((e,t)=>e?setImmediate:t?((o,i)=>(Wi.addEventListener("message",({source:s,data:a})=>{s===Wi&&a===o&&i.length&&i.shift()()},!1),s=>{i.push(s),Wi.postMessage(o,"*")}))(`axios@${Math.random()}`,[]):o=>setTimeout(o))(typeof setImmediate=="function",Qn(Wi.postMessage)),C1=typeof queueMicrotask<"u"?queueMicrotask.bind(Wi):typeof process<"u"&&process.nextTick||Wp,L1=e=>e!=null&&Qn(e[ec]),Ce={isArray:Fa,isArrayBuffer:Vp,isBuffer:Ul,isFormData:Y_,isArrayBufferView:z_,isString:H_,isNumber:Gp,isBoolean:V_,isObject:zl,isPlainObject:fr,isEmptyObject:G_,isReadableStream:X_,isRequest:Q_,isResponse:e1,isHeaders:t1,isUndefined:Oa,isDate:Z_,isFile:j_,isBlob:q_,isRegExp:p1,isFunction:Qn,isStream:K_,isURLSearchParams:J_,isTypedArray:c1,isFileList:W_,forEach:Hl,merge:nu,extend:o1,trim:n1,stripBOM:s1,inherits:i1,toFlatObject:a1,kindOf:tc,kindOfTest:Ko,endsWith:l1,toArray:r1,forEachEntry:u1,matchAll:d1,isHTMLForm:h1,hasOwnProperty:kh,hasOwnProp:kh,reduceDescriptors:qp,freezeMethods:v1,toObjectSet:m1,toCamelCase:f1,noop:g1,toFiniteNumber:y1,findKey:Zp,global:Wi,isContextDefined:jp,isSpecCompliantForm:_1,toJSONObject:k1,isAsyncFn:b1,isThenable:w1,setImmediate:Wp,asap:C1,isIterable:L1};function pt(e,t,o,i,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),o&&(this.config=o),i&&(this.request=i),s&&(this.response=s,this.status=s.status?s.status:null)}Ce.inherits(pt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ce.toJSONObject(this.config),code:this.code,status:this.status}}});const Kp=pt.prototype,Yp={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Yp[e]={value:e}});Object.defineProperties(pt,Yp);Object.defineProperty(Kp,"isAxiosError",{value:!0});pt.from=(e,t,o,i,s,a)=>{const c=Object.create(Kp);Ce.toFlatObject(e,c,function(p){return p!==Error.prototype},f=>f!=="isAxiosError");const u=e&&e.message?e.message:"Error",d=t==null&&e?e.code:t;return pt.call(c,u,d,o,i,s),e&&c.cause==null&&Object.defineProperty(c,"cause",{value:e,configurable:!0}),c.name=e&&e.name||"Error",a&&Object.assign(c,a),c};const S1=null;function ou(e){return Ce.isPlainObject(e)||Ce.isArray(e)}function Jp(e){return Ce.endsWith(e,"[]")?e.slice(0,-2):e}function bh(e,t,o){return e?e.concat(t).map(function(s,a){return s=Jp(s),!o&&a?"["+s+"]":s}).join(o?".":""):t}function x1(e){return Ce.isArray(e)&&!e.some(ou)}const I1=Ce.toFlatObject(Ce,{},null,function(t){return/^is[A-Z]/.test(t)});function oc(e,t,o){if(!Ce.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,o=Ce.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(C,E){return!Ce.isUndefined(E[C])});const i=o.metaTokens,s=o.visitor||p,a=o.dots,c=o.indexes,d=(o.Blob||typeof Blob<"u"&&Blob)&&Ce.isSpecCompliantForm(t);if(!Ce.isFunction(s))throw new TypeError("visitor must be a function");function f(b){if(b===null)return"";if(Ce.isDate(b))return b.toISOString();if(Ce.isBoolean(b))return b.toString();if(!d&&Ce.isBlob(b))throw new pt("Blob is not supported. Use a Buffer instead.");return Ce.isArrayBuffer(b)||Ce.isTypedArray(b)?d&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function p(b,C,E){let D=b;if(b&&!E&&typeof b=="object"){if(Ce.endsWith(C,"{}"))C=i?C:C.slice(0,-2),b=JSON.stringify(b);else if(Ce.isArray(b)&&x1(b)||(Ce.isFileList(b)||Ce.endsWith(C,"[]"))&&(D=Ce.toArray(b)))return C=Jp(C),D.forEach(function(S,$){!(Ce.isUndefined(S)||S===null)&&t.append(c===!0?bh([C],$,a):c===null?C:C+"[]",f(S))}),!1}return ou(b)?!0:(t.append(bh(E,C,a),f(b)),!1)}const g=[],k=Object.assign(I1,{defaultVisitor:p,convertValue:f,isVisitable:ou});function _(b,C){if(!Ce.isUndefined(b)){if(g.indexOf(b)!==-1)throw Error("Circular reference detected in "+C.join("."));g.push(b),Ce.forEach(b,function(D,M){(!(Ce.isUndefined(D)||D===null)&&s.call(t,D,Ce.isString(M)?M.trim():M,C,k))===!0&&_(D,C?C.concat(M):[M])}),g.pop()}}if(!Ce.isObject(e))throw new TypeError("data must be an object");return _(e),t}function wh(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function Uu(e,t){this._pairs=[],e&&oc(e,this,t)}const Xp=Uu.prototype;Xp.append=function(t,o){this._pairs.push([t,o])};Xp.toString=function(t){const o=t?function(i){return t.call(this,i,wh)}:wh;return this._pairs.map(function(s){return o(s[0])+"="+o(s[1])},"").join("&")};function $1(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Qp(e,t,o){if(!t)return e;const i=o&&o.encode||$1;Ce.isFunction(o)&&(o={serialize:o});const s=o&&o.serialize;let a;if(s?a=s(t,o):a=Ce.isURLSearchParams(t)?t.toString():new Uu(t,o).toString(i),a){const c=e.indexOf("#");c!==-1&&(e=e.slice(0,c)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class Ch{constructor(){this.handlers=[]}use(t,o,i){return this.handlers.push({fulfilled:t,rejected:o,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Ce.forEach(this.handlers,function(i){i!==null&&t(i)})}}const ev={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},T1=typeof URLSearchParams<"u"?URLSearchParams:Uu,M1=typeof FormData<"u"?FormData:null,A1=typeof Blob<"u"?Blob:null,E1={isBrowser:!0,classes:{URLSearchParams:T1,FormData:M1,Blob:A1},protocols:["http","https","file","blob","url","data"]},zu=typeof window<"u"&&typeof document<"u",su=typeof navigator=="object"&&navigator||void 0,P1=zu&&(!su||["ReactNative","NativeScript","NS"].indexOf(su.product)<0),D1=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",O1=zu&&window.location.href||"http://localhost",R1=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:zu,hasStandardBrowserEnv:P1,hasStandardBrowserWebWorkerEnv:D1,navigator:su,origin:O1},Symbol.toStringTag,{value:"Module"})),Mn={...R1,...E1};function B1(e,t){return oc(e,new Mn.classes.URLSearchParams,{visitor:function(o,i,s,a){return Mn.isNode&&Ce.isBuffer(o)?(this.append(i,o.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function N1(e){return Ce.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function F1(e){const t={},o=Object.keys(e);let i;const s=o.length;let a;for(i=0;i<s;i++)a=o[i],t[a]=e[a];return t}function tv(e){function t(o,i,s,a){let c=o[a++];if(c==="__proto__")return!0;const u=Number.isFinite(+c),d=a>=o.length;return c=!c&&Ce.isArray(s)?s.length:c,d?(Ce.hasOwnProp(s,c)?s[c]=[s[c],i]:s[c]=i,!u):((!s[c]||!Ce.isObject(s[c]))&&(s[c]=[]),t(o,i,s[c],a)&&Ce.isArray(s[c])&&(s[c]=F1(s[c])),!u)}if(Ce.isFormData(e)&&Ce.isFunction(e.entries)){const o={};return Ce.forEachEntry(e,(i,s)=>{t(N1(i),s,o,0)}),o}return null}function U1(e,t,o){if(Ce.isString(e))try{return(t||JSON.parse)(e),Ce.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(o||JSON.stringify)(e)}const Vl={transitional:ev,adapter:["xhr","http","fetch"],transformRequest:[function(t,o){const i=o.getContentType()||"",s=i.indexOf("application/json")>-1,a=Ce.isObject(t);if(a&&Ce.isHTMLForm(t)&&(t=new FormData(t)),Ce.isFormData(t))return s?JSON.stringify(tv(t)):t;if(Ce.isArrayBuffer(t)||Ce.isBuffer(t)||Ce.isStream(t)||Ce.isFile(t)||Ce.isBlob(t)||Ce.isReadableStream(t))return t;if(Ce.isArrayBufferView(t))return t.buffer;if(Ce.isURLSearchParams(t))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(a){if(i.indexOf("application/x-www-form-urlencoded")>-1)return B1(t,this.formSerializer).toString();if((u=Ce.isFileList(t))||i.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return oc(u?{"files[]":t}:t,d&&new d,this.formSerializer)}}return a||s?(o.setContentType("application/json",!1),U1(t)):t}],transformResponse:[function(t){const o=this.transitional||Vl.transitional,i=o&&o.forcedJSONParsing,s=this.responseType==="json";if(Ce.isResponse(t)||Ce.isReadableStream(t))return t;if(t&&Ce.isString(t)&&(i&&!this.responseType||s)){const c=!(o&&o.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(u){if(c)throw u.name==="SyntaxError"?pt.from(u,pt.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Mn.classes.FormData,Blob:Mn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ce.forEach(["delete","get","head","post","put","patch"],e=>{Vl.headers[e]={}});const z1=Ce.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),H1=e=>{const t={};let o,i,s;return e&&e.split(`
`).forEach(function(c){s=c.indexOf(":"),o=c.substring(0,s).trim().toLowerCase(),i=c.substring(s+1).trim(),!(!o||t[o]&&z1[o])&&(o==="set-cookie"?t[o]?t[o].push(i):t[o]=[i]:t[o]=t[o]?t[o]+", "+i:i)}),t},Lh=Symbol("internals");function rl(e){return e&&String(e).trim().toLowerCase()}function pr(e){return e===!1||e==null?e:Ce.isArray(e)?e.map(pr):String(e)}function V1(e){const t=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=o.exec(e);)t[i[1]]=i[2];return t}const G1=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Ac(e,t,o,i,s){if(Ce.isFunction(i))return i.call(this,t,o);if(s&&(t=o),!!Ce.isString(t)){if(Ce.isString(i))return t.indexOf(i)!==-1;if(Ce.isRegExp(i))return i.test(t)}}function Z1(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,o,i)=>o.toUpperCase()+i)}function j1(e,t){const o=Ce.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+o,{value:function(s,a,c){return this[i].call(this,t,s,a,c)},configurable:!0})})}let eo=class{constructor(t){t&&this.set(t)}set(t,o,i){const s=this;function a(u,d,f){const p=rl(d);if(!p)throw new Error("header name must be a non-empty string");const g=Ce.findKey(s,p);(!g||s[g]===void 0||f===!0||f===void 0&&s[g]!==!1)&&(s[g||d]=pr(u))}const c=(u,d)=>Ce.forEach(u,(f,p)=>a(f,p,d));if(Ce.isPlainObject(t)||t instanceof this.constructor)c(t,o);else if(Ce.isString(t)&&(t=t.trim())&&!G1(t))c(H1(t),o);else if(Ce.isObject(t)&&Ce.isIterable(t)){let u={},d,f;for(const p of t){if(!Ce.isArray(p))throw TypeError("Object iterator must return a key-value pair");u[f=p[0]]=(d=u[f])?Ce.isArray(d)?[...d,p[1]]:[d,p[1]]:p[1]}c(u,o)}else t!=null&&a(o,t,i);return this}get(t,o){if(t=rl(t),t){const i=Ce.findKey(this,t);if(i){const s=this[i];if(!o)return s;if(o===!0)return V1(s);if(Ce.isFunction(o))return o.call(this,s,i);if(Ce.isRegExp(o))return o.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,o){if(t=rl(t),t){const i=Ce.findKey(this,t);return!!(i&&this[i]!==void 0&&(!o||Ac(this,this[i],i,o)))}return!1}delete(t,o){const i=this;let s=!1;function a(c){if(c=rl(c),c){const u=Ce.findKey(i,c);u&&(!o||Ac(i,i[u],u,o))&&(delete i[u],s=!0)}}return Ce.isArray(t)?t.forEach(a):a(t),s}clear(t){const o=Object.keys(this);let i=o.length,s=!1;for(;i--;){const a=o[i];(!t||Ac(this,this[a],a,t,!0))&&(delete this[a],s=!0)}return s}normalize(t){const o=this,i={};return Ce.forEach(this,(s,a)=>{const c=Ce.findKey(i,a);if(c){o[c]=pr(s),delete o[a];return}const u=t?Z1(a):String(a).trim();u!==a&&delete o[a],o[u]=pr(s),i[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const o=Object.create(null);return Ce.forEach(this,(i,s)=>{i!=null&&i!==!1&&(o[s]=t&&Ce.isArray(i)?i.join(", "):i)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,o])=>t+": "+o).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...o){const i=new this(t);return o.forEach(s=>i.set(s)),i}static accessor(t){const i=(this[Lh]=this[Lh]={accessors:{}}).accessors,s=this.prototype;function a(c){const u=rl(c);i[u]||(j1(s,c),i[u]=!0)}return Ce.isArray(t)?t.forEach(a):a(t),this}};eo.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ce.reduceDescriptors(eo.prototype,({value:e},t)=>{let o=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[o]=i}}});Ce.freezeMethods(eo);function Ec(e,t){const o=this||Vl,i=t||o,s=eo.from(i.headers);let a=i.data;return Ce.forEach(e,function(u){a=u.call(o,a,s.normalize(),t?t.status:void 0)}),s.normalize(),a}function nv(e){return!!(e&&e.__CANCEL__)}function Ua(e,t,o){pt.call(this,e??"canceled",pt.ERR_CANCELED,t,o),this.name="CanceledError"}Ce.inherits(Ua,pt,{__CANCEL__:!0});function ov(e,t,o){const i=o.config.validateStatus;!o.status||!i||i(o.status)?e(o):t(new pt("Request failed with status code "+o.status,[pt.ERR_BAD_REQUEST,pt.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}function q1(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function W1(e,t){e=e||10;const o=new Array(e),i=new Array(e);let s=0,a=0,c;return t=t!==void 0?t:1e3,function(d){const f=Date.now(),p=i[a];c||(c=f),o[s]=d,i[s]=f;let g=a,k=0;for(;g!==s;)k+=o[g++],g=g%e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),f-c<t)return;const _=p&&f-p;return _?Math.round(k*1e3/_):void 0}}function K1(e,t){let o=0,i=1e3/t,s,a;const c=(f,p=Date.now())=>{o=p,s=null,a&&(clearTimeout(a),a=null),e(...f)};return[(...f)=>{const p=Date.now(),g=p-o;g>=i?c(f,p):(s=f,a||(a=setTimeout(()=>{a=null,c(s)},i-g)))},()=>s&&c(s)]}const $r=(e,t,o=3)=>{let i=0;const s=W1(50,250);return K1(a=>{const c=a.loaded,u=a.lengthComputable?a.total:void 0,d=c-i,f=s(d),p=c<=u;i=c;const g={loaded:c,total:u,progress:u?c/u:void 0,bytes:d,rate:f||void 0,estimated:f&&u&&p?(u-c)/f:void 0,event:a,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(g)},o)},Sh=(e,t)=>{const o=e!=null;return[i=>t[0]({lengthComputable:o,total:e,loaded:i}),t[1]]},xh=e=>(...t)=>Ce.asap(()=>e(...t)),Y1=Mn.hasStandardBrowserEnv?((e,t)=>o=>(o=new URL(o,Mn.origin),e.protocol===o.protocol&&e.host===o.host&&(t||e.port===o.port)))(new URL(Mn.origin),Mn.navigator&&/(msie|trident)/i.test(Mn.navigator.userAgent)):()=>!0,J1=Mn.hasStandardBrowserEnv?{write(e,t,o,i,s,a,c){if(typeof document>"u")return;const u=[`${e}=${encodeURIComponent(t)}`];Ce.isNumber(o)&&u.push(`expires=${new Date(o).toUTCString()}`),Ce.isString(i)&&u.push(`path=${i}`),Ce.isString(s)&&u.push(`domain=${s}`),a===!0&&u.push("secure"),Ce.isString(c)&&u.push(`SameSite=${c}`),document.cookie=u.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function X1(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Q1(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function sv(e,t,o){let i=!X1(t);return e&&(i||o==!1)?Q1(e,t):t}const Ih=e=>e instanceof eo?{...e}:e;function ea(e,t){t=t||{};const o={};function i(f,p,g,k){return Ce.isPlainObject(f)&&Ce.isPlainObject(p)?Ce.merge.call({caseless:k},f,p):Ce.isPlainObject(p)?Ce.merge({},p):Ce.isArray(p)?p.slice():p}function s(f,p,g,k){if(Ce.isUndefined(p)){if(!Ce.isUndefined(f))return i(void 0,f,g,k)}else return i(f,p,g,k)}function a(f,p){if(!Ce.isUndefined(p))return i(void 0,p)}function c(f,p){if(Ce.isUndefined(p)){if(!Ce.isUndefined(f))return i(void 0,f)}else return i(void 0,p)}function u(f,p,g){if(g in t)return i(f,p);if(g in e)return i(void 0,f)}const d={url:a,method:a,data:a,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:u,headers:(f,p,g)=>s(Ih(f),Ih(p),g,!0)};return Ce.forEach(Object.keys({...e,...t}),function(p){const g=d[p]||s,k=g(e[p],t[p],p);Ce.isUndefined(k)&&g!==u||(o[p]=k)}),o}const iv=e=>{const t=ea({},e);let{data:o,withXSRFToken:i,xsrfHeaderName:s,xsrfCookieName:a,headers:c,auth:u}=t;if(t.headers=c=eo.from(c),t.url=Qp(sv(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&c.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),Ce.isFormData(o)){if(Mn.hasStandardBrowserEnv||Mn.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if(Ce.isFunction(o.getHeaders)){const d=o.getHeaders(),f=["content-type","content-length"];Object.entries(d).forEach(([p,g])=>{f.includes(p.toLowerCase())&&c.set(p,g)})}}if(Mn.hasStandardBrowserEnv&&(i&&Ce.isFunction(i)&&(i=i(t)),i||i!==!1&&Y1(t.url))){const d=s&&a&&J1.read(a);d&&c.set(s,d)}return t},ek=typeof XMLHttpRequest<"u",tk=ek&&function(e){return new Promise(function(o,i){const s=iv(e);let a=s.data;const c=eo.from(s.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:f}=s,p,g,k,_,b;function C(){_&&_(),b&&b(),s.cancelToken&&s.cancelToken.unsubscribe(p),s.signal&&s.signal.removeEventListener("abort",p)}let E=new XMLHttpRequest;E.open(s.method.toUpperCase(),s.url,!0),E.timeout=s.timeout;function D(){if(!E)return;const S=eo.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders()),A={data:!u||u==="text"||u==="json"?E.responseText:E.response,status:E.status,statusText:E.statusText,headers:S,config:e,request:E};ov(function(I){o(I),C()},function(I){i(I),C()},A),E=null}"onloadend"in E?E.onloadend=D:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(D)},E.onabort=function(){E&&(i(new pt("Request aborted",pt.ECONNABORTED,e,E)),E=null)},E.onerror=function($){const A=$&&$.message?$.message:"Network Error",U=new pt(A,pt.ERR_NETWORK,e,E);U.event=$||null,i(U),E=null},E.ontimeout=function(){let $=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const A=s.transitional||ev;s.timeoutErrorMessage&&($=s.timeoutErrorMessage),i(new pt($,A.clarifyTimeoutError?pt.ETIMEDOUT:pt.ECONNABORTED,e,E)),E=null},a===void 0&&c.setContentType(null),"setRequestHeader"in E&&Ce.forEach(c.toJSON(),function($,A){E.setRequestHeader(A,$)}),Ce.isUndefined(s.withCredentials)||(E.withCredentials=!!s.withCredentials),u&&u!=="json"&&(E.responseType=s.responseType),f&&([k,b]=$r(f,!0),E.addEventListener("progress",k)),d&&E.upload&&([g,_]=$r(d),E.upload.addEventListener("progress",g),E.upload.addEventListener("loadend",_)),(s.cancelToken||s.signal)&&(p=S=>{E&&(i(!S||S.type?new Ua(null,e,E):S),E.abort(),E=null)},s.cancelToken&&s.cancelToken.subscribe(p),s.signal&&(s.signal.aborted?p():s.signal.addEventListener("abort",p)));const M=q1(s.url);if(M&&Mn.protocols.indexOf(M)===-1){i(new pt("Unsupported protocol "+M+":",pt.ERR_BAD_REQUEST,e));return}E.send(a||null)})},nk=(e,t)=>{const{length:o}=e=e?e.filter(Boolean):[];if(t||o){let i=new AbortController,s;const a=function(f){if(!s){s=!0,u();const p=f instanceof Error?f:this.reason;i.abort(p instanceof pt?p:new Ua(p instanceof Error?p.message:p))}};let c=t&&setTimeout(()=>{c=null,a(new pt(`timeout ${t} of ms exceeded`,pt.ETIMEDOUT))},t);const u=()=>{e&&(c&&clearTimeout(c),c=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(a):f.removeEventListener("abort",a)}),e=null)};e.forEach(f=>f.addEventListener("abort",a));const{signal:d}=i;return d.unsubscribe=()=>Ce.asap(u),d}},ok=function*(e,t){let o=e.byteLength;if(o<t){yield e;return}let i=0,s;for(;i<o;)s=i+t,yield e.slice(i,s),i=s},sk=async function*(e,t){for await(const o of ik(e))yield*ok(o,t)},ik=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:o,value:i}=await t.read();if(o)break;yield i}}finally{await t.cancel()}},$h=(e,t,o,i)=>{const s=sk(e,t);let a=0,c,u=d=>{c||(c=!0,i&&i(d))};return new ReadableStream({async pull(d){try{const{done:f,value:p}=await s.next();if(f){u(),d.close();return}let g=p.byteLength;if(o){let k=a+=g;o(k)}d.enqueue(new Uint8Array(p))}catch(f){throw u(f),f}},cancel(d){return u(d),s.return()}},{highWaterMark:2})},Th=64*1024,{isFunction:sr}=Ce,ak=(({Request:e,Response:t})=>({Request:e,Response:t}))(Ce.global),{ReadableStream:Mh,TextEncoder:Ah}=Ce.global,Eh=(e,...t)=>{try{return!!e(...t)}catch{return!1}},lk=e=>{e=Ce.merge.call({skipUndefined:!0},ak,e);const{fetch:t,Request:o,Response:i}=e,s=t?sr(t):typeof fetch=="function",a=sr(o),c=sr(i);if(!s)return!1;const u=s&&sr(Mh),d=s&&(typeof Ah=="function"?(b=>C=>b.encode(C))(new Ah):async b=>new Uint8Array(await new o(b).arrayBuffer())),f=a&&u&&Eh(()=>{let b=!1;const C=new o(Mn.origin,{body:new Mh,method:"POST",get duplex(){return b=!0,"half"}}).headers.has("Content-Type");return b&&!C}),p=c&&u&&Eh(()=>Ce.isReadableStream(new i("").body)),g={stream:p&&(b=>b.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(b=>{!g[b]&&(g[b]=(C,E)=>{let D=C&&C[b];if(D)return D.call(C);throw new pt(`Response type '${b}' is not supported`,pt.ERR_NOT_SUPPORT,E)})});const k=async b=>{if(b==null)return 0;if(Ce.isBlob(b))return b.size;if(Ce.isSpecCompliantForm(b))return(await new o(Mn.origin,{method:"POST",body:b}).arrayBuffer()).byteLength;if(Ce.isArrayBufferView(b)||Ce.isArrayBuffer(b))return b.byteLength;if(Ce.isURLSearchParams(b)&&(b=b+""),Ce.isString(b))return(await d(b)).byteLength},_=async(b,C)=>{const E=Ce.toFiniteNumber(b.getContentLength());return E??k(C)};return async b=>{let{url:C,method:E,data:D,signal:M,cancelToken:S,timeout:$,onDownloadProgress:A,onUploadProgress:U,responseType:I,headers:H,withCredentials:O="same-origin",fetchOptions:q}=iv(b),V=t||fetch;I=I?(I+"").toLowerCase():"text";let Q=nk([M,S&&S.toAbortSignal()],$),de=null;const Ee=Q&&Q.unsubscribe&&(()=>{Q.unsubscribe()});let ge;try{if(U&&f&&E!=="get"&&E!=="head"&&(ge=await _(H,D))!==0){let re=new o(C,{method:"POST",body:D,duplex:"half"}),Re;if(Ce.isFormData(D)&&(Re=re.headers.get("content-type"))&&H.setContentType(Re),re.body){const[Je,tt]=Sh(ge,$r(xh(U)));D=$h(re.body,Th,Je,tt)}}Ce.isString(O)||(O=O?"include":"omit");const Pe=a&&"credentials"in o.prototype,Fe={...q,signal:Q,method:E.toUpperCase(),headers:H.normalize().toJSON(),body:D,duplex:"half",credentials:Pe?O:void 0};de=a&&new o(C,Fe);let ce=await(a?V(de,q):V(C,Fe));const Me=p&&(I==="stream"||I==="response");if(p&&(A||Me&&Ee)){const re={};["status","statusText","headers"].forEach(qe=>{re[qe]=ce[qe]});const Re=Ce.toFiniteNumber(ce.headers.get("content-length")),[Je,tt]=A&&Sh(Re,$r(xh(A),!0))||[];ce=new i($h(ce.body,Th,Je,()=>{tt&&tt(),Ee&&Ee()}),re)}I=I||"text";let ke=await g[Ce.findKey(g,I)||"text"](ce,b);return!Me&&Ee&&Ee(),await new Promise((re,Re)=>{ov(re,Re,{data:ke,headers:eo.from(ce.headers),status:ce.status,statusText:ce.statusText,config:b,request:de})})}catch(Pe){throw Ee&&Ee(),Pe&&Pe.name==="TypeError"&&/Load failed|fetch/i.test(Pe.message)?Object.assign(new pt("Network Error",pt.ERR_NETWORK,b,de),{cause:Pe.cause||Pe}):pt.from(Pe,Pe&&Pe.code,b,de)}}},rk=new Map,av=e=>{let t=e&&e.env||{};const{fetch:o,Request:i,Response:s}=t,a=[i,s,o];let c=a.length,u=c,d,f,p=rk;for(;u--;)d=a[u],f=p.get(d),f===void 0&&p.set(d,f=u?new Map:lk(t)),p=f;return f};av();const Hu={http:S1,xhr:tk,fetch:{get:av}};Ce.forEach(Hu,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Ph=e=>`- ${e}`,ck=e=>Ce.isFunction(e)||e===null||e===!1;function uk(e,t){e=Ce.isArray(e)?e:[e];const{length:o}=e;let i,s;const a={};for(let c=0;c<o;c++){i=e[c];let u;if(s=i,!ck(i)&&(s=Hu[(u=String(i)).toLowerCase()],s===void 0))throw new pt(`Unknown adapter '${u}'`);if(s&&(Ce.isFunction(s)||(s=s.get(t))))break;a[u||"#"+c]=s}if(!s){const c=Object.entries(a).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let u=o?c.length>1?`since :
`+c.map(Ph).join(`
`):" "+Ph(c[0]):"as no adapter specified";throw new pt("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return s}const lv={getAdapter:uk,adapters:Hu};function Pc(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ua(null,e)}function Dh(e){return Pc(e),e.headers=eo.from(e.headers),e.data=Ec.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),lv.getAdapter(e.adapter||Vl.adapter,e)(e).then(function(i){return Pc(e),i.data=Ec.call(e,e.transformResponse,i),i.headers=eo.from(i.headers),i},function(i){return nv(i)||(Pc(e),i&&i.response&&(i.response.data=Ec.call(e,e.transformResponse,i.response),i.response.headers=eo.from(i.response.headers))),Promise.reject(i)})}const rv="1.13.2",sc={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{sc[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});const Oh={};sc.transitional=function(t,o,i){function s(a,c){return"[Axios v"+rv+"] Transitional option '"+a+"'"+c+(i?". "+i:"")}return(a,c,u)=>{if(t===!1)throw new pt(s(c," has been removed"+(o?" in "+o:"")),pt.ERR_DEPRECATED);return o&&!Oh[c]&&(Oh[c]=!0,console.warn(s(c," has been deprecated since v"+o+" and will be removed in the near future"))),t?t(a,c,u):!0}};sc.spelling=function(t){return(o,i)=>(console.warn(`${i} is likely a misspelling of ${t}`),!0)};function dk(e,t,o){if(typeof e!="object")throw new pt("options must be an object",pt.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let s=i.length;for(;s-- >0;){const a=i[s],c=t[a];if(c){const u=e[a],d=u===void 0||c(u,a,e);if(d!==!0)throw new pt("option "+a+" must be "+d,pt.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new pt("Unknown option "+a,pt.ERR_BAD_OPTION)}}const vr={assertOptions:dk,validators:sc},ds=vr.validators;let Ji=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Ch,response:new Ch}}async request(t,o){try{return await this._request(t,o)}catch(i){if(i instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{i.stack?a&&!String(i.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+a):i.stack=a}catch{}}throw i}}_request(t,o){typeof t=="string"?(o=o||{},o.url=t):o=t||{},o=ea(this.defaults,o);const{transitional:i,paramsSerializer:s,headers:a}=o;i!==void 0&&vr.assertOptions(i,{silentJSONParsing:ds.transitional(ds.boolean),forcedJSONParsing:ds.transitional(ds.boolean),clarifyTimeoutError:ds.transitional(ds.boolean)},!1),s!=null&&(Ce.isFunction(s)?o.paramsSerializer={serialize:s}:vr.assertOptions(s,{encode:ds.function,serialize:ds.function},!0)),o.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?o.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:o.allowAbsoluteUrls=!0),vr.assertOptions(o,{baseUrl:ds.spelling("baseURL"),withXsrfToken:ds.spelling("withXSRFToken")},!0),o.method=(o.method||this.defaults.method||"get").toLowerCase();let c=a&&Ce.merge(a.common,a[o.method]);a&&Ce.forEach(["delete","get","head","post","put","patch","common"],b=>{delete a[b]}),o.headers=eo.concat(c,a);const u=[];let d=!0;this.interceptors.request.forEach(function(C){typeof C.runWhen=="function"&&C.runWhen(o)===!1||(d=d&&C.synchronous,u.unshift(C.fulfilled,C.rejected))});const f=[];this.interceptors.response.forEach(function(C){f.push(C.fulfilled,C.rejected)});let p,g=0,k;if(!d){const b=[Dh.bind(this),void 0];for(b.unshift(...u),b.push(...f),k=b.length,p=Promise.resolve(o);g<k;)p=p.then(b[g++],b[g++]);return p}k=u.length;let _=o;for(;g<k;){const b=u[g++],C=u[g++];try{_=b(_)}catch(E){C.call(this,E);break}}try{p=Dh.call(this,_)}catch(b){return Promise.reject(b)}for(g=0,k=f.length;g<k;)p=p.then(f[g++],f[g++]);return p}getUri(t){t=ea(this.defaults,t);const o=sv(t.baseURL,t.url,t.allowAbsoluteUrls);return Qp(o,t.params,t.paramsSerializer)}};Ce.forEach(["delete","get","head","options"],function(t){Ji.prototype[t]=function(o,i){return this.request(ea(i||{},{method:t,url:o,data:(i||{}).data}))}});Ce.forEach(["post","put","patch"],function(t){function o(i){return function(a,c,u){return this.request(ea(u||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:a,data:c}))}}Ji.prototype[t]=o(),Ji.prototype[t+"Form"]=o(!0)});let hk=class cv{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(a){o=a});const i=this;this.promise.then(s=>{if(!i._listeners)return;let a=i._listeners.length;for(;a-- >0;)i._listeners[a](s);i._listeners=null}),this.promise.then=s=>{let a;const c=new Promise(u=>{i.subscribe(u),a=u}).then(s);return c.cancel=function(){i.unsubscribe(a)},c},t(function(a,c,u){i.reason||(i.reason=new Ua(a,c,u),o(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const o=this._listeners.indexOf(t);o!==-1&&this._listeners.splice(o,1)}toAbortSignal(){const t=new AbortController,o=i=>{t.abort(i)};return this.subscribe(o),t.signal.unsubscribe=()=>this.unsubscribe(o),t.signal}static source(){let t;return{token:new cv(function(s){t=s}),cancel:t}}};function fk(e){return function(o){return e.apply(null,o)}}function pk(e){return Ce.isObject(e)&&e.isAxiosError===!0}const iu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(iu).forEach(([e,t])=>{iu[t]=e});function uv(e){const t=new Ji(e),o=zp(Ji.prototype.request,t);return Ce.extend(o,Ji.prototype,t,{allOwnKeys:!0}),Ce.extend(o,t,null,{allOwnKeys:!0}),o.create=function(s){return uv(ea(e,s))},o}const en=uv(Vl);en.Axios=Ji;en.CanceledError=Ua;en.CancelToken=hk;en.isCancel=nv;en.VERSION=rv;en.toFormData=oc;en.AxiosError=pt;en.Cancel=en.CanceledError;en.all=function(t){return Promise.all(t)};en.spread=fk;en.isAxiosError=pk;en.mergeConfig=ea;en.AxiosHeaders=eo;en.formToJSON=e=>tv(Ce.isHTMLForm(e)?new FormData(e):e);en.getAdapter=lv.getAdapter;en.HttpStatusCode=iu;en.default=en;const{Axios:dU,AxiosError:hU,CanceledError:fU,isCancel:pU,CancelToken:vU,VERSION:mU,all:gU,Cancel:yU,isAxiosError:_U,spread:kU,toFormData:bU,AxiosHeaders:wU,HttpStatusCode:CU,formToJSON:LU,getAdapter:SU,mergeConfig:xU}=en,au="https://sterobson-volunteercheckin-testing.azurewebsites.net/api",vk="VolunteerCheckinOffline",mk=1;let Ho=null;async function qs(){return Ho||new Promise((e,t)=>{const o=indexedDB.open(vk,mk);o.onerror=()=>{console.error("Failed to open IndexedDB:",o.error),t(o.error)},o.onsuccess=()=>{Ho=o.result,e(Ho)},o.onupgradeneeded=i=>{const s=i.target.result;s.objectStoreNames.contains("eventData")||s.createObjectStore("eventData",{keyPath:"eventId"}),s.objectStoreNames.contains("pendingActions")||s.createObjectStore("pendingActions",{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),s.objectStoreNames.contains("syncMeta")||s.createObjectStore("syncMeta",{keyPath:"key"})}})}async function Dl(e,t){return await qs(),new Promise((o,i)=>{const s=Ho.transaction(["eventData","syncMeta"],"readwrite"),a=s.objectStore("eventData"),c=s.objectStore("syncMeta"),u={eventId:e,...t,cachedAt:new Date().toISOString()};a.put(u),c.put({key:`lastSync_${e}`,value:new Date().toISOString()}),s.oncomplete=()=>o(),s.onerror=()=>i(s.error)})}async function _i(e){return await qs(),new Promise((t,o)=>{const a=Ho.transaction(["eventData"],"readonly").objectStore("eventData").get(e);a.onsuccess=()=>t(a.result||null),a.onerror=()=>o(a.error)})}async function ul(e,t,o){const i=await _i(e);i&&(i[t]=o,i.cachedAt=new Date().toISOString(),await Dl(e,i))}async function gk(e){return await qs(),new Promise((t,o)=>{const s=Ho.transaction(["pendingActions"],"readwrite").objectStore("pendingActions"),a={...e,createdAt:new Date().toISOString(),attempts:0,lastAttempt:null,status:"pending"},c=s.add(a);c.onsuccess=()=>t(c.result),c.onerror=()=>o(c.error)})}async function dv(){return await qs(),new Promise((e,t)=>{const a=Ho.transaction(["pendingActions"],"readonly").objectStore("pendingActions").index("createdAt").getAll();a.onsuccess=()=>{const c=a.result.filter(u=>u.status==="pending"||u.status==="retrying");e(c)},a.onerror=()=>t(a.error)})}async function Tr(){return(await dv()).length}async function Rh(e,t){return await qs(),new Promise((o,i)=>{const s=Ho.transaction(["pendingActions"],"readwrite"),a=s.objectStore("pendingActions"),c=a.get(e);c.onsuccess=()=>{const u=c.result;u&&(Object.assign(u,t),a.put(u))},s.oncomplete=()=>o(),s.onerror=()=>i(s.error)})}async function Bh(e){return await qs(),new Promise((t,o)=>{const a=Ho.transaction(["pendingActions"],"readwrite").objectStore("pendingActions").delete(e);a.onsuccess=()=>t(),a.onerror=()=>o(a.error)})}async function yk(e){return await qs(),new Promise((t,o)=>{const a=Ho.transaction(["syncMeta"],"readonly").objectStore("syncMeta").get(`lastSync_${e}`);a.onsuccess=()=>t(a.result?.value||null),a.onerror=()=>o(a.error)})}const Ve=en.create({baseURL:au,headers:{"Content-Type":"application/json"},timeout:15e3});let lu=!1;async function _k(){}function Nh(e){const t=[/\/events\/([^/]+)/,/\/assignments\/([^/]+)/,/\/locations\/([^/]+)/,/\/checklist-items\/([^/]+)/,/\/areas\/([^/]+)/,/\/marshals\/([^/]+)/];for(const o of t){const i=e.match(o);if(i)return i[1]}return null}function kk(e){return!!(!e.response&&e.request||e.response&&e.response.status>=500||e.code==="ECONNABORTED")}Ve.interceptors.request.use(e=>{const t=localStorage.getItem("adminEmail");t&&(e.headers["X-Admin-Email"]=t);const o=localStorage.getItem("sessionToken");return o&&(e.headers.Authorization=`Bearer ${o}`),e});let ru=0;const bk=2;function wk(){if(ru++,ru>=bk){localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken");const e=window.location.hash||"";!e.includes("login")&&!e.includes("/verify")&&(window.location.href="/VolunteerCheckin/testing/#/?login=true")}}function Ck(){ru=0}Ve.interceptors.response.use(e=>{lu=!1,Ck();const t=e.config.url,o=Nh(t);return e.config.method,e},async e=>{const t=e.config;if(e.response&&(e.response.status===401||e.response.status===403))return wk(),Promise.reject(e);if(kk(e)&&(lu=!0,t.method==="get")){const o=Nh(t.url);if(o){const i=await _i(o);if(i)return console.log("Returning cached data for:",t.url),Promise.resolve({data:i,status:200,statusText:"OK (cached)",headers:{},config:t,cached:!0})}}return Promise.reject(e)});async function Nn(e,t,o){return await gk({type:e,payload:t,eventId:t.eventId}),await _k(),{data:o,status:200,statusText:"OK (queued)",queued:!0}}function hn(){return lu||!navigator.onLine}const Lk={check:()=>Ve.head("/health")},cu=()=>{const e=window.location.href.split("#")[0];return e.endsWith("/")?e.slice(0,-1):e},vs={requestLogin:e=>Ve.post("/auth/request-login",{email:e,frontendUrl:cu()}),verifyToken:e=>Ve.post("/auth/verify-token",{token:e}),instantLogin:e=>Ve.post("/auth/instant-login",{email:e}),createAdmin:e=>Ve.post("/auth/create-admin",{email:e}),marshalLogin:(e,t)=>Ve.post("/auth/marshal-login",{eventId:e,magicCode:t}),getMe:e=>Ve.get("/auth/me",{params:{eventId:e}}),logout:()=>Ve.post("/auth/logout")},ir={getProfile:()=>Ve.get("/auth/profile"),updateProfile:e=>Ve.put("/auth/profile",e),getPerson:(e,t)=>Ve.get(`/people/${e}`,{params:{eventId:t}}),updatePerson:(e,t,o)=>Ve.put(`/people/${e}`,o,{params:{eventId:t}})},Gi={create:e=>Ve.post("/events",e),getAll:()=>Ve.get("/events"),getById:e=>Ve.get(`/events/${e}`),update:(e,t)=>Ve.put(`/events/${e}`,t),delete:e=>Ve.delete(`/events/${e}`),uploadGpx:(e,t)=>{const o=new FormData;return o.append("gpx",t),Ve.post(`/events/${e}/upload-gpx`,o,{headers:{"Content-Type":"multipart/form-data"}})}},Xn={create:e=>Ve.post("/locations",e),getById:(e,t)=>Ve.get(`/locations/${e}/${t}`),getByEvent:e=>Ve.get(`/events/${e}/locations`),update:(e,t,o)=>Ve.put(`/locations/${e}/${t}`,o),delete:(e,t)=>Ve.delete(`/locations/${e}/${t}`),importCsv:(e,t,o)=>{const i=new FormData;return i.append("csv",t),Ve.post(`/locations/import/${e}?deleteExisting=${o}`,i,{headers:{"Content-Type":"multipart/form-data"}})},bulkUpdateTimes:(e,t)=>Ve.post(`/locations/bulk-update-times/${e}`,{timeDelta:t}),updatePosition:(e,t,o)=>Ve.post(`/locations/${e}/${t}/update-position`,o),getDynamicCheckpoints:e=>Ve.get(`/events/${e}/dynamic-checkpoints`)},dl={create:e=>Ve.post("/assignments",e),getById:(e,t)=>Ve.get(`/assignments/${e}/${t}`),getByEvent:e=>Ve.get(`/assignments/event/${e}`),delete:(e,t)=>Ve.delete(`/assignments/${e}/${t}`),getEventStatus:e=>Ve.get(`/events/${e}/status`)},gs={checkIn:e=>Ve.post("/checkin",e),adminCheckIn:(e,t)=>Ve.post(`/checkin/admin/${e}/${t}`)},Dc={getAdmins:e=>Ve.get(`/events/${e}/admins`),addAdmin:(e,t)=>Ve.post(`/events/${e}/admins`,{userEmail:t}),removeAdmin:(e,t)=>Ve.delete(`/events/${e}/admins/${t}`)},ms={create:e=>Ve.post("/marshals",e),getByEvent:e=>Ve.get(`/events/${e}/marshals`),getById:(e,t)=>Ve.get(`/marshals/${e}/${t}`),update:(e,t,o)=>Ve.put(`/marshals/${e}/${t}`,o),delete:(e,t)=>Ve.delete(`/marshals/${e}/${t}`),getMagicLink:(e,t)=>Ve.get(`/marshals/${e}/${t}/magic-link`,{params:{frontendUrl:cu()}}),sendMagicLink:(e,t)=>Ve.post(`/marshals/${e}/${t}/send-magic-link`,{frontendUrl:cu()}),importCsv:(e,t)=>{const o=new FormData;return o.append("csv",t),Ve.post(`/marshals/import/${e}`,o,{headers:{"Content-Type":"multipart/form-data"}})}},mi={create:e=>Ve.post("/areas",e),getByEvent:e=>Ve.get(`/events/${e}/areas`),getById:(e,t)=>Ve.get(`/areas/${e}/${t}`),update:(e,t,o)=>Ve.put(`/areas/${e}/${t}`,o),delete:(e,t)=>Ve.delete(`/areas/${e}/${t}`),recalculate:e=>Ve.post(`/areas/recalculate/${e}`),getCheckpoints:(e,t)=>Ve.get(`/areas/${e}/${t}/locations`),getAreaLeadDashboard:e=>Ve.get(`/events/${e}/area-lead-dashboard`)},Pt={create:(e,t)=>Ve.post(`/events/${e}/checklist-items`,t),getByEvent:e=>Ve.get(`/events/${e}/checklist-items`),getById:(e,t)=>Ve.get(`/checklist-items/${e}/${t}`),update:(e,t,o)=>Ve.put(`/checklist-items/${e}/${t}`,o),delete:(e,t)=>Ve.delete(`/checklist-items/${e}/${t}`),getReport:e=>Ve.get(`/events/${e}/checklist-report`),getMarshalChecklist:(e,t)=>Ve.get(`/events/${e}/marshals/${t}/checklist`),getCheckpointChecklist:(e,t)=>Ve.get(`/events/${e}/locations/${t}/checklist`),getAreaChecklist:(e,t)=>Ve.get(`/events/${e}/areas/${t}/checklist`),complete:(e,t,o)=>Ve.post(`/checklist-items/${e}/${t}/complete`,o),uncomplete:(e,t,o)=>Ve.post(`/checklist-items/${e}/${t}/uncomplete`,o)},Ds={create:(e,t)=>Ve.post(`/events/${e}/notes`,t),getByEvent:e=>Ve.get(`/events/${e}/notes`),getById:(e,t)=>Ve.get(`/events/${e}/notes/${t}`),update:(e,t,o)=>Ve.put(`/events/${e}/notes/${t}`,o),delete:(e,t)=>Ve.delete(`/events/${e}/notes/${t}`),getMarshalNotes:(e,t)=>Ve.get(`/events/${e}/marshals/${t}/notes`),getMyNotes:e=>Ve.get(`/events/${e}/my-notes`)},di={create:(e,t)=>Ve.post(`/events/${e}/contacts`,t),getByEvent:e=>Ve.get(`/events/${e}/contacts`),getById:(e,t)=>Ve.get(`/events/${e}/contacts/${t}`),update:(e,t,o)=>Ve.put(`/events/${e}/contacts/${t}`,o),delete:(e,t)=>Ve.delete(`/events/${e}/contacts/${t}`),getRoles:e=>Ve.get(`/events/${e}/contact-roles`),getMarshalContacts:(e,t)=>Ve.get(`/events/${e}/marshals/${t}/contacts`),getMyContacts:e=>Ve.get(`/events/${e}/my-contacts`)},ps={create:(e,t)=>Ve.post(`/events/${e}/incidents`,t),getAll:(e,t={})=>Ve.get(`/events/${e}/incidents`,{params:t}),getForArea:(e,t)=>Ve.get(`/events/${e}/areas/${t}/incidents`),get:(e,t)=>Ve.get(`/events/${e}/incidents/${t}`),updateStatus:(e,t,o)=>Ve.patch(`/events/${e}/incidents/${t}`,o),addNote:(e,t,o)=>Ve.post(`/events/${e}/incidents/${t}/notes`,{note:o})},za=Ru("auth",()=>{const e=T(localStorage.getItem("adminEmail")||null),t=T(!!e.value),o=T(!1);return{adminEmail:e,isAuthenticated:t,loginPending:o,requestLogin:async u=>{const d=await vs.requestLogin(u);return d.data.success&&(o.value=!0),d.data},verifyToken:async u=>{const d=await vs.verifyToken(u);return d.data.success&&(e.value=d.data.person?.email,t.value=!0,o.value=!1,localStorage.setItem("adminEmail",d.data.person?.email),localStorage.setItem("sessionToken",d.data.sessionToken)),d.data},instantLogin:async u=>{const d=await vs.instantLogin(u);return d.data.success&&(e.value=d.data.email,t.value=!0,localStorage.setItem("adminEmail",d.data.email),d.data.sessionToken&&localStorage.setItem("sessionToken",d.data.sessionToken)),d.data},logout:async()=>{try{await vs.logout()}catch{}e.value=null,t.value=!1,o.value=!1,localStorage.removeItem("adminEmail"),localStorage.removeItem("sessionToken")}}}),Sk={class:"home"},xk={class:"hero-section"},Ik={class:"hero-content"},$k={class:"content-section"},Tk={class:"container"},Mk={class:"carousel"},Ak={class:"carousel-indicators"},Ek=["onClick"],Pk={class:"modal-card"},Dk={key:0,class:"email-sent"},Ok={key:1},Rk={class:"form-group"},Bk=["disabled"],Nk={key:0,class:"error"},Fk={__name:"Home",setup(e){const t=Qr(),o=Na(),i=za(),s=T(0);let a=null;function c(D){s.value=D,d()}function u(){s.value=(s.value+1)%2}function d(){a&&clearInterval(a),a=setInterval(u,1e4)}const f=T(!1),p=T(""),g=T(!1),k=T(null),_=T(!1);async function b(){g.value=!0,k.value=null;try{const D=await i.requestLogin(p.value);D.success?_.value=!0:k.value=D.message||"Failed to send login link. Please try again."}catch{k.value="Failed to send login link. Please try again."}finally{g.value=!1}}function C(){p.value="",_.value=!1,k.value=null}function E(){f.value=!1,t.query.login&&o.replace({query:{}})}return Wt(()=>{d(),t.query.login&&(f.value=!0)}),zn(()=>{a&&clearInterval(a)}),(D,M)=>(v(),m("div",Sk,[l("section",xk,[l("div",Ik,[Oe(F_),M[2]||(M[2]=l("div",{class:"hero-overlay"},[l("h1",null,"OnTheDay")],-1))]),M[3]||(M[3]=l("p",{class:"subtitle"},"Manage your event's marshals and volunteers with ease",-1)),l("button",{class:"btn btn-primary",onClick:M[0]||(M[0]=S=>f.value=!0)}," Join us or login ")]),l("section",$k,[l("div",Tk,[M[5]||(M[5]=Lr('<div class="features-grid" data-v-f75bc50b><div class="feature-card" data-v-f75bc50b><h3 data-v-f75bc50b>For admins</h3><ul data-v-f75bc50b><li data-v-f75bc50b>Create and manage events</li><li data-v-f75bc50b>Define marshal locations</li><li data-v-f75bc50b>Real-time check-in monitoring</li><li data-v-f75bc50b>Map view of everything in your event</li><li data-v-f75bc50b>Manage incidents</li></ul></div><div class="feature-card" data-v-f75bc50b><h3 data-v-f75bc50b>For marshals</h3><ul data-v-f75bc50b><li data-v-f75bc50b>View the entire route</li><li data-v-f75bc50b>View your assigned location</li><li data-v-f75bc50b>Check in with GPS verification</li><li data-v-f75bc50b>Access emergency contact info</li><li data-v-f75bc50b>Record incidents</li></ul></div></div>',1)),l("div",Mk,[l("div",{class:"carousel-track",style:rt({transform:`translateX(-${s.value*100}%)`})},[...M[4]||(M[4]=[Lr('<div class="feature-card" data-v-f75bc50b><h3 data-v-f75bc50b>For admins</h3><ul data-v-f75bc50b><li data-v-f75bc50b>Create and manage events</li><li data-v-f75bc50b>Define marshal locations</li><li data-v-f75bc50b>Real-time check-in monitoring</li><li data-v-f75bc50b>Map view of everything in your event</li><li data-v-f75bc50b>Manage incidents</li></ul></div><div class="feature-card" data-v-f75bc50b><h3 data-v-f75bc50b>For marshals</h3><ul data-v-f75bc50b><li data-v-f75bc50b>View the entire route</li><li data-v-f75bc50b>View your assigned location</li><li data-v-f75bc50b>Check in with GPS verification</li><li data-v-f75bc50b>Access emergency contact info</li><li data-v-f75bc50b>Record incidents</li></ul></div>',2)])],4),l("div",Ak,[(v(),m(Se,null,Be(2,(S,$)=>l("button",{key:$,class:pe(["indicator",{active:s.value===$}]),onClick:A=>c($)},null,10,Ek)),64))])])])]),(v(),Ye(Tu,{to:"body"},[Oe(wl,{name:"modal"},{default:Ue(()=>[f.value?(v(),m("div",{key:0,class:"modal-overlay",onClick:ht(E,["self"])},[l("div",Pk,[l("button",{class:"modal-close",onClick:E},""),_.value?(v(),m("div",Dk,[M[7]||(M[7]=l("div",{class:"check-icon"},"",-1)),M[8]||(M[8]=l("h3",null,"Check your email!",-1)),l("p",null,[M[6]||(M[6]=Ke("We've sent a login link to ",-1)),l("strong",null,w(p.value),1)]),M[9]||(M[9]=l("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),l("button",{onClick:C,class:"btn btn-secondary"}," Use a different email ")])):(v(),m("div",Ok,[M[10]||(M[10]=l("h2",null,"Join us or login",-1)),M[11]||(M[11]=l("p",{class:"instruction"},"Enter your email to receive a login link",-1)),l("form",{onSubmit:ht(b,["prevent"])},[l("div",Rk,[He(l("input",{"onUpdate:modelValue":M[1]||(M[1]=S=>p.value=S),type:"email",placeholder:"you@example.com",required:"",class:"form-input"},null,512),[[nt,p.value]])]),l("button",{type:"submit",class:"btn btn-primary btn-full",disabled:g.value},w(g.value?"Sending...":"Send login link"),9,Bk)],32),k.value?(v(),m("div",Nk,w(k.value),1)):P("",!0)]))])])):P("",!0)]),_:1})]))]))}},Uk=je(Fk,[["__scopeId","data-v-f75bc50b"]]),zk={class:"admin-login"},Hk={class:"login-card"},Vk={key:0,class:"email-sent"},Gk={class:"form-group"},Zk=["disabled"],jk={key:0,class:"error"},qk={__name:"AdminLogin",setup(e){const t=za(),o=T(""),i=T(!1),s=T(null),a=T(!1),c=async()=>{i.value=!0,s.value=null;try{const d=await t.requestLogin(o.value);d.success?a.value=!0:s.value=d.message||"Failed to send login link. Please try again."}catch{s.value="Failed to send login link. Please try again."}finally{i.value=!1}},u=()=>{o.value="",a.value=!1,s.value=null};return(d,f)=>{const p=Mu("router-link");return v(),m("div",zk,[l("div",Hk,[f[7]||(f[7]=l("h2",null,"Admin login",-1)),a.value?(v(),m("div",Vk,[f[2]||(f[2]=l("div",{class:"check-icon"},"",-1)),f[3]||(f[3]=l("h3",null,"Check your email!",-1)),l("p",null,[f[1]||(f[1]=Ke("We've sent a login link to ",-1)),l("strong",null,w(o.value),1)]),f[4]||(f[4]=l("p",{class:"hint"},"The link will expire in 15 minutes.",-1)),l("button",{onClick:u,class:"btn btn-secondary"}," Use a different email ")])):(v(),m(Se,{key:1},[f[5]||(f[5]=l("p",{class:"instruction"},"Enter your email to receive a login link",-1)),l("form",{onSubmit:ht(c,["prevent"])},[l("div",Gk,[He(l("input",{"onUpdate:modelValue":f[0]||(f[0]=g=>o.value=g),type:"email",placeholder:"admin@example.com",required:"",class:"form-input"},null,512),[[nt,o.value]])]),l("button",{type:"submit",class:"btn btn-primary",disabled:i.value},w(i.value?"Sending...":"Send login link"),9,Zk)],32),s.value?(v(),m("div",jk,w(s.value),1)):P("",!0)],64)),Oe(p,{to:"/",class:"back-link"},{default:Ue(()=>[...f[6]||(f[6]=[Ke(" Back to Home",-1)])]),_:1})])])}}},Wk=je(qk,[["__scopeId","data-v-5d0a88c2"]]),Kk={class:"admin-verify"},Yk={class:"verify-card"},Jk={key:0,class:"status"},Xk={key:1,class:"status error"},Qk={key:2,class:"status success"},eb={__name:"AdminVerify",setup(e){const t=Na(),o=Qr(),i=za(),s=T(!0),a=T(null);return Wt(async()=>{const c=o.query.token;if(!c){a.value="No login token provided. Please request a new login link.",s.value=!1;return}try{const u=await i.verifyToken(c);u.success?setTimeout(()=>{t.push({name:"AdminDashboard"})},1e3):a.value=u.message||"Invalid or expired login link. Please request a new one."}catch(u){console.error("Verification error:",u),a.value="Failed to verify login. Please try again."}finally{s.value=!1}}),(c,u)=>{const d=Mu("router-link");return v(),m("div",Kk,[l("div",Yk,[s.value?(v(),m("div",Jk,[...u[0]||(u[0]=[l("div",{class:"spinner"},null,-1),l("h2",null,"Verifying your login...",-1),l("p",null,"Please wait while we confirm your identity.",-1)])])):a.value?(v(),m("div",Xk,[u[2]||(u[2]=l("h2",null,"Login failed",-1)),l("p",null,w(a.value),1),Oe(d,{to:{name:"Home",query:{login:"true"}},class:"btn btn-primary"},{default:Ue(()=>[...u[1]||(u[1]=[Ke(" Try again ",-1)])]),_:1})])):(v(),m("div",Qk,[...u[3]||(u[3]=[l("h2",null,"Login successful!",-1),l("p",null,"Redirecting to dashboard...",-1)])]))])])}}},tb=je(eb,[["__scopeId","data-v-76177495"]]),hv=Ru("events",()=>{const e=T([]),t=T(null),o=T([]),i=T([]),s=T(null),a=T(!1),c=T(null),u=async()=>{a.value=!0,c.value=null;try{const U=await Gi.getAll();e.value=U.data}catch(U){throw c.value=U.message,U}finally{a.value=!1}},d=async U=>{a.value=!0,c.value=null;try{const I=await Gi.getById(U);t.value=I.data}catch(I){throw c.value=I.message,I}finally{a.value=!1}},f=async U=>{a.value=!0,c.value=null;try{const I=await Gi.create(U);return e.value.push(I.data),I.data}catch(I){throw c.value=I.message,I}finally{a.value=!1}},p=async(U,I)=>{a.value=!0,c.value=null;try{const H=await Gi.update(U,I),O=e.value.findIndex(q=>q.id===U);return O!==-1&&(e.value[O]=H.data),t.value?.id===U&&(t.value=H.data),H.data}catch(H){throw c.value=H.message,H}finally{a.value=!1}},g=async U=>{a.value=!0,c.value=null;try{await Gi.delete(U),e.value=e.value.filter(I=>I.id!==U)}catch(I){throw c.value=I.message,I}finally{a.value=!1}},k=async U=>{a.value=!0,c.value=null;try{const I=await Xn.getByEvent(U);o.value=I.data}catch(I){throw c.value=I.message,I}finally{a.value=!1}};return{events:e,currentEvent:t,locations:o,assignments:i,eventStatus:s,loading:a,error:c,fetchEvents:u,fetchEvent:d,createEvent:f,updateEvent:p,deleteEvent:g,fetchLocations:k,createLocation:async U=>{a.value=!0,c.value=null;try{const I=await Xn.create(U);return o.value.push(I.data),I.data}catch(I){throw c.value=I.message,I}finally{a.value=!1}},updateLocation:async(U,I,H)=>{a.value=!0,c.value=null;try{const O=await Xn.update(U,I,H),q=o.value.findIndex(V=>V.id===I);return q!==-1&&(o.value[q]=O.data),O.data}catch(O){throw c.value=O.message,O}finally{a.value=!1}},deleteLocation:async(U,I)=>{a.value=!0,c.value=null;try{await Xn.delete(U,I),o.value=o.value.filter(H=>H.id!==I)}catch(H){throw c.value=H.message,H}finally{a.value=!1}},bulkUpdateLocationTimes:async(U,I)=>{a.value=!0,c.value=null;try{const H=await Xn.bulkUpdateTimes(U,I);return await k(U),H.data}catch(H){throw c.value=H.message,H}finally{a.value=!1}},fetchAssignments:async U=>{a.value=!0,c.value=null;try{const I=await dl.getByEvent(U);i.value=I.data}catch(I){throw c.value=I.message,I}finally{a.value=!1}},createAssignment:async U=>{a.value=!0,c.value=null;try{const I=await dl.create(U);return i.value.push(I.data),I.data}catch(I){throw c.value=I.message,I}finally{a.value=!1}},deleteAssignment:async(U,I)=>{a.value=!0,c.value=null;try{await dl.delete(U,I),i.value=i.value.filter(H=>H.id!==I)}catch(H){throw c.value=H.message,H}finally{a.value=!1}},fetchEventStatus:async U=>{a.value=!0,c.value=null;try{const I=await dl.getEventStatus(U);return s.value=I.data,I.data}catch(I){throw c.value=I.message,I}finally{a.value=!1}},updateAssignmentCheckIn:U=>{const I=i.value.findIndex(H=>H.id===U.id);I!==-1&&(i.value[I]=U),s.value&&s.value.locations.forEach(H=>{const O=H.assignments.findIndex(q=>q.id===U.id);O!==-1&&(H.assignments[O]=U,H.checkedInCount=H.assignments.filter(q=>q.isCheckedIn).length)})}}}),nb={class:"confirm-modal"},ob={class:"confirm-actions"},sb={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},showCancel:{type:Boolean,default:!0},isDanger:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(e,{emit:t}){const o=t,i=()=>{o("confirm")},s=()=>{o("cancel")};return(a,c)=>e.show?(v(),m("div",{key:0,class:"modal-overlay",onClick:ht(s,["self"])},[l("div",nb,[l("h3",null,w(e.title),1),l("p",null,w(e.message),1),l("div",ob,[e.showCancel?(v(),m("button",{key:0,onClick:s,class:"btn btn-secondary"},w(e.cancelText),1)):P("",!0),l("button",{onClick:i,class:pe(["btn",e.isDanger?"btn-danger":"btn-primary"])},w(e.confirmText),3)])])])):P("",!0)}},Ra=je(sb,[["__scopeId","data-v-bead7a29"]]),ib={class:"base-modal-header"},ab={class:"base-modal-header-content"},lb={key:0,class:"base-modal-title"},rb={key:0,class:"base-modal-tab-header"},cb={key:1,class:"base-modal-footer"},ub={key:0,class:"base-modal-actions"},db={__name:"BaseModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},variant:{type:String,default:"center",validator:e=>["center","sidebar"].includes(e)},zIndex:{type:Number,default:1e3},closeOnOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},confirmOnClose:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=()=>{const S=document.documentElement,$=getComputedStyle(S).getPropertyValue("--modal-resize-duration").trim();return $.endsWith("s")?parseFloat($)*1e3:300},i=e,s=t,a=T(!1),c=T(!1),u=T(null),d=T(null);let f=null,p=!1,g=0;const k=()=>{if(!d.value||!u.value||p)return;const S=d.value.scrollHeight,$=g;if($===S||g===0){g=S;return}p=!0,d.value.style.height=`${$}px`,d.value.style.overflow="hidden",d.value.offsetHeight,d.value.style.transition="height var(--modal-resize-duration, 0.3s) ease",d.value.style.height=`${S}px`;const A=o();setTimeout(()=>{d.value&&(d.value.style.height="",d.value.style.overflow="",d.value.style.transition=""),p=!1,g=S},A)},_=()=>{!u.value||typeof MutationObserver>"u"||(d.value&&(g=d.value.scrollHeight),f=new MutationObserver(()=>{Un(()=>{k()})}),f.observe(u.value,{childList:!0,subtree:!0,attributes:!0,characterData:!0}))},b=()=>{f&&(f.disconnect(),f=null)};Wt(()=>{Un(()=>{i.show&&_()})}),zn(()=>{b()}),Ge(()=>i.show,S=>{S?Un(()=>{g=0,_()}):b()});const C=()=>{i.closeOnOverlay&&E()},E=()=>{i.confirmOnClose&&i.isDirty?a.value=!0:s("close")},D=()=>{a.value=!1,s("close")},M=()=>{a.value=!1};return(S,$)=>(v(),Ye(wl,{name:"modal",appear:""},{default:Ue(()=>[e.show?(v(),m("div",{key:0,class:"base-modal-overlay",style:rt({zIndex:e.zIndex}),onClick:ht(C,["self"])},[l("div",{class:pe(["base-modal",[`base-modal--${e.size}`,`base-modal--${e.variant}`]])},[l("div",ib,[l("div",ab,[Jn(S.$slots,"header",{},()=>[e.title?(v(),m("h2",lb,w(e.title),1)):P("",!0)],!0)]),e.showCloseButton?(v(),m("button",{key:0,onClick:E,class:"base-modal-close",type:"button","aria-label":"Close"},"  ")):P("",!0)]),S.$slots["tab-header"]?(v(),m("div",rb,[Jn(S.$slots,"tab-header",{},void 0,!0)])):P("",!0),l("div",{class:"base-modal-body",ref_key:"bodyRef",ref:u},[l("div",{class:"base-modal-body-content",ref_key:"contentRef",ref:d},[Jn(S.$slots,"default",{},void 0,!0)],512)],512),S.$slots.footer||S.$slots.actions?(v(),m("div",cb,[Jn(S.$slots,"footer",{},()=>[S.$slots.actions?(v(),m("div",ub,[Jn(S.$slots,"actions",{},void 0,!0)])):P("",!0)],!0)])):P("",!0)],2),e.confirmOnClose&&!c.value?(v(),Ye(Ra,{key:0,show:a.value,title:"Unsaved changes",message:"You have unsaved changes. Are you sure you want to close?",onConfirm:D,onCancel:M},null,8,["show"])):P("",!0)],4)):P("",!0)]),_:3}))}},zt=je(db,[["__scopeId","data-v-fca470de"]]);function fv(e="details",t=[]){const o=T(e),i=g=>{o.value=g},s=()=>{o.value=e},a=g=>o.value===g,c=Z(()=>t.length===0?-1:t.indexOf(o.value)),u=(g=!1)=>{if(t.length===0)return;const k=c.value;if(k===-1)return;const _=k+1;_<t.length?o.value=t[_]:g&&(o.value=t[0])},d=(g=!1)=>{if(t.length===0)return;const k=c.value;if(k===-1)return;const _=k-1;_>=0?o.value=t[_]:g&&(o.value=t[t.length-1])},f=Z(()=>{if(t.length===0)return!1;const g=c.value;return g!==-1&&g<t.length-1}),p=Z(()=>t.length===0?!1:c.value>0);return{activeTab:o,activeTabIndex:c,hasNextTab:f,hasPreviousTab:p,switchTab:i,resetTab:s,isActiveTab:a,nextTab:u,previousTab:d}}const pv=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska Time (AKT)"},{value:"Pacific/Honolulu",label:"Hawaii Time (HT)"},{value:"Europe/London",label:"London (GMT/BST)"},{value:"Europe/Paris",label:"Paris (CET/CEST)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Australia/Sydney",label:"Sydney (AEDT/AEST)"}],hb={class:"tabs"},fb={class:"tab-content"},pb={class:"form-group"},vb={class:"form-group"},mb={class:"form-group"},gb={class:"form-group"},yb=["value"],_b={class:"tab-content"},kb={class:"emergency-contacts-section"},bb={key:0,class:"empty-state"},wb={class:"card-header"},Cb=["onClick"],Lb={class:"form-group"},Sb=["onUpdate:modelValue"],xb={class:"form-group"},Ib=["onUpdate:modelValue"],$b={class:"form-group"},Tb=["onUpdate:modelValue"],Mb={__name:"EventFormModal",props:{show:{type:Boolean,default:!1},eventData:{type:Object,default:()=>({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]})},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const o=e,i=t,{activeTab:s,switchTab:a,resetTab:c}=fv("basic",["basic","emergency"]),u=T({...o.eventData});Ge(()=>o.eventData,k=>{u.value={...k},u.value.emergencyContacts||(u.value.emergencyContacts=[])},{deep:!0}),Ge(()=>o.show,k=>{k&&c()});const d=()=>{u.value.emergencyContacts.push({name:"",phone:"",details:""})},f=k=>{u.value.emergencyContacts.splice(k,1)},p=()=>{i("submit",{...u.value})},g=()=>{i("close")};return(k,_)=>(v(),Ye(zt,{show:e.show,title:e.isEditing?"Edit event":"Create new event",size:"large",onClose:g},{"tab-header":Ue(()=>[l("div",hb,[l("button",{type:"button",onClick:_[0]||(_[0]=b=>j(a)("basic")),class:pe(["tab-button",{active:j(s)==="basic"}])}," Basic details ",2),l("button",{type:"button",onClick:_[1]||(_[1]=b=>j(a)("emergency")),class:pe(["tab-button",{active:j(s)==="emergency"}])}," Emergency contacts ",2)])]),actions:Ue(()=>[l("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:p,class:"btn btn-primary"},w(e.isEditing?"Update":"Create"),1)]),default:Ue(()=>[l("form",{onSubmit:ht(p,["prevent"])},[He(l("div",fb,[l("div",pb,[_[6]||(_[6]=l("label",null,"Event name *",-1)),He(l("input",{"onUpdate:modelValue":_[2]||(_[2]=b=>u.value.name=b),type:"text",required:"",class:"form-input"},null,512),[[nt,u.value.name]])]),l("div",vb,[_[7]||(_[7]=l("label",null,"Description",-1)),He(l("textarea",{"onUpdate:modelValue":_[3]||(_[3]=b=>u.value.description=b),rows:"3",class:"form-input"},null,512),[[nt,u.value.description]])]),l("div",mb,[_[8]||(_[8]=l("label",null,"Event date *",-1)),He(l("input",{"onUpdate:modelValue":_[4]||(_[4]=b=>u.value.eventDate=b),type:"datetime-local",required:"",class:"form-input"},null,512),[[nt,u.value.eventDate]])]),l("div",gb,[_[9]||(_[9]=l("label",null,"Time zone *",-1)),He(l("select",{"onUpdate:modelValue":_[5]||(_[5]=b=>u.value.timeZoneId=b),required:"",class:"form-input"},[(v(!0),m(Se,null,Be(j(pv),b=>(v(),m("option",{key:b.value,value:b.value},w(b.label),9,yb))),128))],512),[[Tn,u.value.timeZoneId]])])],512),[[bi,j(s)==="basic"]]),He(l("div",_b,[l("div",kb,[l("div",{class:"section-header-small"},[_[10]||(_[10]=l("h3",null,"Emergency contacts",-1)),l("button",{type:"button",onClick:d,class:"btn btn-small btn-primary"}," Add contact ")]),u.value.emergencyContacts.length===0?(v(),m("div",bb,[..._[11]||(_[11]=[l("p",null,'No emergency contacts added yet. Click "Add contact" to add one.',-1)])])):P("",!0),(v(!0),m(Se,null,Be(u.value.emergencyContacts,(b,C)=>(v(),m("div",{key:C,class:"emergency-contact-card"},[l("div",wb,[l("h4",null,"Contact "+w(C+1),1),l("button",{type:"button",onClick:E=>f(C),class:"btn-remove"},"  ",8,Cb)]),l("div",Lb,[_[12]||(_[12]=l("label",null,"Name *",-1)),He(l("input",{"onUpdate:modelValue":E=>b.name=E,type:"text",required:"",class:"form-input",placeholder:"Contact person name"},null,8,Sb),[[nt,b.name]])]),l("div",xb,[_[13]||(_[13]=l("label",null,"Phone *",-1)),He(l("input",{"onUpdate:modelValue":E=>b.phone=E,type:"tel",required:"",class:"form-input",placeholder:"+1 (555) 123-4567"},null,8,Ib),[[nt,b.phone]])]),l("div",$b,[_[14]||(_[14]=l("label",null,"Additional details",-1)),He(l("textarea",{"onUpdate:modelValue":E=>b.details=E,rows:"2",class:"form-input",placeholder:"Role, availability, or other important information..."},null,8,Tb),[[nt,b.details]])])]))),128))])],512),[[bi,j(s)==="emergency"]])],32)]),_:1},8,["show","title"]))}},Ab=je(Mb,[["__scopeId","data-v-6339e6bb"]]),vv="admin-theme-preference",zi=T(Eb());function Eb(){return typeof window>"u"?"system":localStorage.getItem(vv)||"system"}function Pb(e){localStorage.setItem(vv,e)}function Vu(){const e=Z(()=>zi.value==="system"?"light dark":zi.value),t=(s,a=!0)=>{a&&typeof document<"u"&&(document.documentElement.classList.add("theme-transitioning"),setTimeout(()=>{document.documentElement.classList.remove("theme-transitioning")},1e3)),zi.value=s,Pb(s)},o=()=>{const s=["system","light","dark"],c=(s.indexOf(zi.value)+1)%s.length;t(s[c])},i=Z(()=>zi.value==="dark"?!0:zi.value==="light"?!1:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1);return{theme:zi,colorScheme:e,isDark:i,setTheme:t,cycleTheme:o}}const Db=["aria-expanded","title"],Ob=["innerHTML"],Rb={key:0,class:"dropdown-menu"},Bb=["onClick"],Nb=["innerHTML"],Fb={__name:"ThemeToggle",setup(e){const{theme:t,isDark:o,setTheme:i}=Vu(),s=T(!1),a=T(null),c={light:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
  </svg>`,dark:`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
  </svg>`,system:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
    <line x1="8" y1="21" x2="16" y2="21"></line>
    <line x1="12" y1="17" x2="12" y2="21"></line>
  </svg>`},u=[{value:"system",label:"System",icon:c.system},{value:"light",label:"Light",icon:c.light},{value:"dark",label:"Dark",icon:c.dark}],d=Z(()=>o.value?c.dark:c.light),f=()=>{s.value=!s.value},p=k=>{i(k),s.value=!1},g=k=>{a.value&&!a.value.contains(k.target)&&(s.value=!1)};return Wt(()=>{document.addEventListener("click",g)}),zn(()=>{document.removeEventListener("click",g)}),(k,_)=>(v(),m("div",{class:"theme-dropdown",ref_key:"dropdownRef",ref:a},[l("button",{class:"theme-toggle-btn",onClick:f,type:"button","aria-expanded":s.value,title:j(o)?"Dark mode":"Light mode"},[l("span",{class:"theme-icon",innerHTML:d.value},null,8,Ob)],8,Db),s.value?(v(),m("div",Rb,[(v(),m(Se,null,Be(u,b=>l("button",{key:b.value,class:pe(["dropdown-item",{active:j(t)===b.value}]),onClick:C=>p(b.value)},[l("span",{class:"option-icon",innerHTML:b.icon},null,8,Nb),l("span",null,w(b.label),1)],10,Bb)),64))])):P("",!0)],512))}},mv=je(Fb,[["__scopeId","data-v-969124a4"]]),Ub={class:"header"},zb={class:"header-actions"},Hb={class:"user-email"},Vb={class:"container"},Gb={class:"section"},Zb={class:"section-header"},jb={key:0,class:"loading"},qb={key:1,class:"empty"},Wb={key:2,class:"events-grid"},Kb=["onClick"],Yb={class:"event-date"},Jb={class:"event-desc"},Xb={class:"event-actions"},Qb=["onClick"],e0=["onClick"],t0={__name:"AdminDashboard",setup(e){const t=Na(),{colorScheme:o}=Vu(),i=za(),s=hv(),a=T(!0),c=T(!1),u=T(null),d=T({name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}),f=T([]),p=T(!1),g=T(""),k=T(""),_=T(null),b=T(!1),C=T("OK"),E=async()=>{a.value=!0;try{await s.fetchEvents(),f.value=s.events}catch(Q){console.error("Failed to load events:",Q)}finally{a.value=!1}},D=async Q=>{try{const de={...Q,adminEmail:i.adminEmail};u.value?await s.updateEvent(u.value.id,de):await s.createEvent(de),f.value=s.events,U()}catch(de){console.error("Failed to save event:",de),alert("Failed to save event. Please try again.")}},M=Q=>{u.value=Q,d.value={name:Q.name,description:Q.description,eventDate:V(Q.eventDate),timeZoneId:Q.timeZoneId||"UTC",emergencyContacts:Q.emergencyContacts?JSON.parse(JSON.stringify(Q.emergencyContacts)):[]}},S=async Q=>{g.value="Delete event",k.value=`Are you sure you want to delete "${Q.name}"?`,b.value=!0,C.value="Delete",_.value=async()=>{try{await s.deleteEvent(Q.id),f.value=s.events}catch(de){console.error("Failed to delete event:",de),alert("Failed to delete event. Please try again.")}},p.value=!0},$=()=>{p.value=!1,_.value&&(_.value(),_.value=null)},A=()=>{p.value=!1,_.value=null},U=()=>{c.value=!1,u.value=null,d.value={name:"",description:"",eventDate:"",timeZoneId:"UTC",emergencyContacts:[]}},I=Q=>{if(!Q){console.error("Cannot navigate to event: eventId is undefined");return}t.push({name:"AdminEventManage",params:{eventId:Q}})},H=()=>{t.push({name:"AdminProfile"})},O=()=>{i.logout(),t.push({name:"Home"})},q=Q=>new Date(Q).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),V=Q=>{const de=new Date(Q),Ee=de.getFullYear(),ge=String(de.getMonth()+1).padStart(2,"0"),Pe=String(de.getDate()).padStart(2,"0"),Fe=String(de.getHours()).padStart(2,"0"),ce=String(de.getMinutes()).padStart(2,"0");return`${Ee}-${ge}-${Pe}T${Fe}:${ce}`};return Wt(()=>{E()}),(Q,de)=>(v(),m("div",{class:"admin-dashboard",style:rt({colorScheme:j(o)})},[l("header",Ub,[de[1]||(de[1]=l("h1",null,"Admin dashboard",-1)),l("div",zb,[l("span",Hb,w(j(i).adminEmail),1),l("button",{onClick:H,class:"btn btn-secondary"},"Profile"),l("button",{onClick:O,class:"btn btn-secondary"},"Logout"),Oe(mv)])]),l("div",Vb,[l("div",Gb,[l("div",Zb,[de[2]||(de[2]=l("h2",null,"Your events",-1)),l("button",{onClick:de[0]||(de[0]=Ee=>c.value=!0),class:"btn btn-primary"}," Create new event ")]),a.value?(v(),m("div",jb,"Loading events...")):f.value.length===0?(v(),m("div",qb,[...de[3]||(de[3]=[l("p",null,"No events yet. Create your first event to get started!",-1)])])):(v(),m("div",Wb,[(v(!0),m(Se,null,Be(f.value,Ee=>(v(),m("div",{key:Ee.id,class:"event-card",onClick:ge=>I(Ee.id)},[l("h3",null,w(Ee.name),1),l("p",Yb,w(q(Ee.eventDate)),1),l("p",Jb,w(Ee.description),1),l("div",Xb,[l("button",{onClick:ht(ge=>M(Ee),["stop"]),class:"btn btn-small btn-secondary"}," Edit ",8,Qb),l("button",{onClick:ht(ge=>S(Ee),["stop"]),class:"btn btn-small btn-danger"}," Delete ",8,e0)])],8,Kb))),128))]))])]),Oe(Ab,{show:c.value||!!u.value,"event-data":d.value,"is-editing":!!u.value,onClose:U,onSubmit:D},null,8,["show","event-data","is-editing"]),Oe(Ra,{show:p.value,title:g.value,message:k.value,"is-danger":b.value,"confirm-text":C.value,onConfirm:$,onCancel:A},null,8,["show","title","message","is-danger","confirm-text"])],4))}},n0=je(t0,[["__scopeId","data-v-16db0525"]]),o0=Ru("profile",()=>{const e=T(null),t=T(!1),o=T(null);return{profile:e,loading:t,error:o,fetchProfile:async()=>{t.value=!0,o.value=null;try{const d=await ir.getProfile();return e.value=d.data,d.data}catch(d){throw o.value=d.response?.data?.message||"Failed to load profile",d}finally{t.value=!1}},updateProfile:async d=>{t.value=!0,o.value=null;try{const f=await ir.updateProfile(d);return e.value=f.data,f.data}catch(f){throw o.value=f.response?.data?.message||"Failed to update profile",f}finally{t.value=!1}},fetchPerson:async(d,f)=>{t.value=!0,o.value=null;try{return(await ir.getPerson(d,f)).data}catch(p){throw o.value=p.response?.data?.message||"Failed to load person",p}finally{t.value=!1}},updatePerson:async(d,f,p)=>{t.value=!0,o.value=null;try{return(await ir.updatePerson(d,f,p)).data}catch(g){throw o.value=g.response?.data?.message||"Failed to update person",g}finally{t.value=!1}},clearProfile:()=>{e.value=null,o.value=null}}}),s0={class:"form-group"},i0={class:"form-group"},a0={class:"form-group"},l0={__name:"EditProfileModal",props:{show:{type:Boolean,default:!1},profile:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=T({name:"",email:"",phone:""});Ge(()=>o.profile,d=>{d&&(s.value={name:d.name||"",email:d.email||"",phone:d.phone||""})},{immediate:!0,deep:!0}),Ge(()=>o.show,d=>{d&&o.profile&&(s.value={name:o.profile.name||"",email:o.profile.email||"",phone:o.profile.phone||""})});const a=()=>{i("update:isDirty",!0)},c=()=>{if(!s.value.name.trim()){alert("Name is required");return}if(!s.value.email.trim()){alert("Email is required");return}i("submit",{name:s.value.name.trim(),email:s.value.email.trim(),phone:s.value.phone?.trim()||""})},u=()=>{i("close")};return(d,f)=>(v(),Ye(zt,{show:e.show,title:"Edit profile",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:Ue(()=>[l("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:c,class:"btn btn-primary"}," Save changes ")]),default:Ue(()=>[l("form",{onSubmit:ht(c,["prevent"])},[l("div",s0,[f[3]||(f[3]=l("label",null,"Name *",-1)),He(l("input",{"onUpdate:modelValue":f[0]||(f[0]=p=>s.value.name=p),type:"text",required:"",class:"form-input",placeholder:"Your name",onInput:a},null,544),[[nt,s.value.name]])]),l("div",i0,[f[4]||(f[4]=l("label",null,"Email *",-1)),He(l("input",{"onUpdate:modelValue":f[1]||(f[1]=p=>s.value.email=p),type:"email",required:"",class:"form-input",placeholder:"Your email address",onInput:a},null,544),[[nt,s.value.email]])]),l("div",a0,[f[5]||(f[5]=l("label",null,"Phone",-1)),He(l("input",{"onUpdate:modelValue":f[2]||(f[2]=p=>s.value.phone=p),type:"tel",class:"form-input",placeholder:"Your phone number",onInput:a},null,544),[[nt,s.value.phone]])])],32)]),_:1},8,["show","is-dirty"]))}},r0=je(l0,[["__scopeId","data-v-5b468307"]]),c0={class:"admin-profile"},u0={class:"header"},d0={class:"header-actions"},h0={class:"user-email"},f0={class:"container"},p0={class:"section"},v0={class:"section-header"},m0={key:0,class:"loading"},g0={key:1,class:"error"},y0={key:2,class:"profile-details"},_0={class:"profile-field"},k0={class:"field-value"},b0={class:"profile-field"},w0={class:"field-value"},C0={class:"profile-field"},L0={class:"field-value"},S0={class:"profile-field"},x0={class:"field-value"},I0={__name:"AdminProfile",setup(e){const t=Na(),o=za(),i=o0(),s=T(!1),a=async()=>{try{await i.fetchProfile()}catch(f){console.error("Failed to load profile:",f)}},c=async f=>{try{await i.updateProfile(f),s.value=!1}catch(p){console.error("Failed to save profile:",p),alert("Failed to save profile. Please try again.")}},u=()=>{o.logout(),t.push({name:"Home"})},d=()=>{t.push({name:"AdminDashboard"})};return Wt(()=>{a()}),(f,p)=>(v(),m("div",c0,[l("header",u0,[p[2]||(p[2]=l("h1",null,"My profile",-1)),l("div",d0,[l("span",h0,w(j(o).adminEmail),1),l("button",{onClick:u,class:"btn btn-secondary"},"Logout")])]),l("div",f0,[l("div",p0,[l("div",v0,[p[3]||(p[3]=l("h2",null,"Profile information",-1)),l("button",{onClick:p[0]||(p[0]=g=>s.value=!0),class:"btn btn-primary"}," Edit profile ")]),j(i).loading?(v(),m("div",m0,"Loading profile...")):j(i).error?(v(),m("div",g0,[l("p",null,w(j(i).error),1),l("button",{onClick:a,class:"btn btn-secondary"},"Retry")])):j(i).profile?(v(),m("div",y0,[l("div",_0,[p[4]||(p[4]=l("label",null,"Name",-1)),l("div",k0,w(j(i).profile.name||""),1)]),l("div",b0,[p[5]||(p[5]=l("label",null,"Email",-1)),l("div",w0,w(j(i).profile.email||""),1)]),l("div",C0,[p[6]||(p[6]=l("label",null,"Phone",-1)),l("div",L0,w(j(i).profile.phone||""),1)]),l("div",S0,[p[7]||(p[7]=l("label",null,"System admin",-1)),l("div",x0,[l("span",{class:pe(["badge",j(i).profile.isSystemAdmin?"badge-success":"badge-secondary"])},w(j(i).profile.isSystemAdmin?"Yes":"No"),3)])])])):P("",!0)]),l("div",{class:"section"},[l("button",{onClick:d,class:"btn btn-secondary"}," Back to Dashboard ")])]),Oe(r0,{show:s.value,profile:j(i).profile,onClose:p[1]||(p[1]=g=>s.value=!1),onSubmit:c},null,8,["show","profile"])]))}},$0=je(I0,[["__scopeId","data-v-fdbd980a"]]);function T0(){const e=T(!1),t=T(""),o=T(""),i=T(null),s=T(!1),a=T("OK");return{showConfirmModal:e,confirmModalTitle:t,confirmModalMessage:o,confirmModalIsDanger:s,confirmModalConfirmText:a,showConfirm:(p,g,k,_={})=>{t.value=p,o.value=g,i.value=k,s.value=_.isDanger||!1,a.value=_.confirmText||"OK",e.value=!0},handleConfirmModalConfirm:()=>{e.value=!1,i.value&&(i.value(),i.value=null)},handleConfirmModalCancel:()=>{e.value=!1,i.value=null},closeConfirmModal:()=>{e.value=!1,i.value=null}}}const Ca=T({people:"Marshals",checkpoint:"Checkpoints",area:"Areas",checklist:"Checklists",course:"Course"}),Fs={people:{People:{singular:"Person",plural:"People"},Marshals:{singular:"Marshal",plural:"Marshals"},Volunteers:{singular:"Volunteer",plural:"Volunteers"},Helpers:{singular:"Helper",plural:"Helpers"},Staff:{singular:"Staff member",plural:"Staff"},Stewards:{singular:"Steward",plural:"Stewards"},"Team members":{singular:"Team member",plural:"Team members"},Drivers:{singular:"Driver",plural:"Drivers"},Pilots:{singular:"Pilot",plural:"Pilots"}},checkpoint:{Checkpoints:{singular:"Checkpoint",plural:"Checkpoints"},Stations:{singular:"Station",plural:"Stations"},Locations:{singular:"Location",plural:"Locations"},"Feed stations":{singular:"Feed station",plural:"Feed stations"},"Aid stations":{singular:"Aid station",plural:"Aid stations"},"Water stations":{singular:"Water station",plural:"Water stations"},"Person points":{singular:null,plural:null,dynamic:!0}},area:{Areas:{singular:"Area",plural:"Areas"},Regions:{singular:"Region",plural:"Regions"},Zones:{singular:"Zone",plural:"Zones"}},checklist:{Checklists:{singular:"Checklist",plural:"Checklists"},Tasks:{singular:"Task",plural:"Tasks"},Jobs:{singular:"Job",plural:"Jobs"}},course:{Course:{singular:"Course",plural:"Courses"},Route:{singular:"Route",plural:"Routes"},Track:{singular:"Track",plural:"Tracks"},Trail:{singular:"Trail",plural:"Trails"},Path:{singular:"Path",plural:"Paths"}}},Ns={people:["Drivers","Helpers","Marshals","People","Pilots","Staff","Stewards","Team members","Volunteers"],checkpoint:["Aid stations","Checkpoints","Feed stations","Locations","Person points","Stations","Water stations"],area:["Areas","Regions","Zones"],checklist:["Checklists","Jobs","Tasks"],course:["Course","Path","Route","Track","Trail"]};function Zi(e,t,o="Marshals"){if(!t)return"";const i=Fs[e]?.[t];return e==="checkpoint"&&t==="Person points"?`${Fs.people[o]?.singular||"Person"} point`:i?.singular?i.singular:t.endsWith("s")&&!t.endsWith("ss")?t.slice(0,-1):t}function gv(e,t,o="Marshals"){if(!t)return"";const i=Fs[e]?.[t];return t==="Person points"?`${Fs.people[o]?.singular||"Person"} points`:i?.plural?i.plural:t}function uu(e,t){return e==="Person points"?`${Fs.people[t]?.singular||"Person"} points`:e}function du(e){e&&(Ca.value={people:e.peopleTerm||"Marshals",checkpoint:e.checkpointTerm||"Checkpoints",area:e.areaTerm||"Areas",checklist:e.checklistTerm||"Checklists",course:e.courseTerm||"Course"})}const Fo=e=>e.toLowerCase(),Uo=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();function bt(){const e=p=>{const g=Ca.value[p],k=Fs[p]?.[g];if(p==="checkpoint"&&g==="Person points"){const _=Ca.value.people;return`${Fs.people[_]?.singular||"Person"} point`}return k?.singular||g},t=p=>{const g=Ca.value[p],k=Fs[p]?.[g];if(p==="checkpoint"&&g==="Person points"){const _=Ca.value.people;return`${Fs.people[_]?.singular||"Person"} points`}return k?.plural||g},o=Z(()=>({person:e("people"),checkpoint:e("checkpoint"),area:e("area"),checklist:e("checklist"),course:e("course"),people:t("people"),checkpoints:t("checkpoint"),areas:t("area"),checklists:t("checklist"),courses:t("course")})),i=Z(()=>({person:Fo(e("people")),checkpoint:Fo(e("checkpoint")),area:Fo(e("area")),checklist:Fo(e("checklist")),course:Fo(e("course")),people:Fo(t("people")),checkpoints:Fo(t("checkpoint")),areas:Fo(t("area")),checklists:Fo(t("checklist")),courses:Fo(t("course"))})),s=Z(()=>({person:Uo(e("people")),checkpoint:Uo(e("checkpoint")),area:Uo(e("area")),checklist:Uo(e("checklist")),course:Uo(e("course")),people:Uo(t("people")),checkpoints:Uo(t("checkpoint")),areas:Uo(t("area")),checklists:Uo(t("checklist")),courses:Uo(t("course"))})),a=Z(()=>({course:o.value.course,checkpoints:o.value.checkpoints,areas:o.value.areas,marshals:o.value.people,checklists:o.value.checklists,notes:"Notes",details:"Event details"}));return{terms:o,termsLower:i,termsSentence:s,tabLabels:a,singular:e,plural:t,formatCount:(p,g)=>g===1?`1 ${e(p)}`:`${g} ${t(p)}`,lower:(p,g=!0)=>Fo(g?t(p):e(p)),title:(p,g=!0)=>g?t(p):e(p),sentence:(p,g=!0)=>Uo(g?t(p):e(p)),terminology:Ca}}function M0(){const e=T(!1),t=T(null),o=T({}),i=T(null),s=T(null),a=T([]),c=T(null),u=T(null),d=T(!1),f=T(!1),p=T(1),g=Z(()=>t.value==="place-checkpoint"||t.value==="move-checkpoint"?i.value!==null:t.value==="draw-area"?s.value&&s.value.length>=3:t.value==="add-multiple"),k=de=>{if(de){const Ee=de.getMapCenter?.(),ge=de.getMapZoom?.();Ee&&ge!==null&&(c.value=Ee,u.value=ge)}},_=(de={})=>{i.value=null,e.value=!0,t.value="place-checkpoint",o.value={title:de.title||"Select checkpoint location",description:de.description||"Click on the map to set the location. Click again to reposition."}},b=(de,Ee="checkpoint")=>{i.value=null,e.value=!0,t.value="move-checkpoint",o.value={title:`Move ${Ee}: ${de}`,description:"Click on the map to set the new location"}},C=(de={})=>{e.value=!0,t.value="draw-area",d.value=!0,o.value={title:de.title||"Draw area boundary",description:de.description||"Click to add points. Click Done when finished to complete the area."}},E=(de=1)=>{p.value=de,a.value=[],e.value=!0,t.value="add-multiple",f.value=!0,o.value={title:"Add multiple checkpoints",description:`Click on map to add checkpoints. Next: Checkpoint ${p.value}`}},D=de=>{t.value==="place-checkpoint"||t.value==="move-checkpoint"?i.value=de:t.value==="add-multiple"&&M(de)},M=de=>{a.value.push({id:`temp-${p.value}`,name:`Checkpoint ${p.value}`,description:"",latitude:de.lat,longitude:de.lng,requiredMarshals:1,what3Words:"",assignments:[],isTemporary:!0}),p.value++,o.value={...o.value,description:`Click on map to add checkpoints. Next: Checkpoint ${p.value}`}},S=de=>{s.value=de},$=()=>s.value&&s.value.length>=3?s.value.map(de=>({lat:de.lat,lng:de.lng})):null,A=()=>{e.value=!1,t.value=null,o.value={},i.value=null,c.value=null,u.value=null,s.value=null,d.value&&(d.value=!1)};return{isFullscreenMapActive:e,fullscreenMode:t,fullscreenContext:o,tempLocationCoords:i,currentDrawingPolygon:s,tempCheckpoints:a,savedMapCenter:c,savedMapZoom:u,isDrawingAreaBoundary:d,isAddingMultipleCheckpoints:f,multiCheckpointCounter:p,canCompleteFullscreen:g,saveMapState:k,enterPlaceCheckpointMode:_,enterMoveCheckpointMode:b,enterDrawAreaMode:C,enterAddMultipleMode:E,handleFullscreenMapClick:D,handlePolygonDrawing:S,getCompletedPolygon:$,exitFullscreen:A,cancelFullscreen:()=>{t.value==="add-multiple"?(a.value=[],f.value=!1):t.value==="draw-area"&&(d.value=!1,s.value=null),A()},getTempCheckpoints:()=>[...a.value],clearTempCheckpoints:()=>{a.value=[],f.value=!1},getPlacedCoords:()=>i.value,createDisplayCheckpoints:(de,Ee,ge)=>Z(()=>{const Pe=[...de.value];return t.value==="place-checkpoint"&&i.value&&Pe.push({id:"temp-single",name:Ee.value?.name||"New Checkpoint",latitude:i.value.lat,longitude:i.value.lng,requiredMarshals:Ee.value?.requiredMarshals||1,assignments:[],isTemporary:!0}),t.value==="move-checkpoint"&&i.value&&ge.value&&Pe.push({id:"temp-move",name:ge.value.name+" (new position)",latitude:i.value.lat,longitude:i.value.lng,requiredMarshals:ge.value.requiredMarshals,assignments:[],isTemporary:!0}),t.value==="add-multiple"&&Pe.push(...a.value),Pe}),createDisplayAreas:(de,Ee)=>Z(()=>{const ge=[...de.value];if(t.value==="draw-area"&&Ee.value?.polygon?.length>0){const Pe=ge.findIndex(Fe=>Fe.id===Ee.value.id);Pe>=0?ge[Pe]={...Ee.value}:ge.push({...Ee.value,id:Ee.value.id||"temp-area"})}return ge}),calculateStartingNumber:de=>{const Ee=de.value.map(ge=>{const Pe=ge.name.match(/^Checkpoint (\d+)$/);return Pe?parseInt(Pe[1]):0}).filter(ge=>ge>0);return Ee.length>0?Math.max(...Ee)+1:1}}}function A0(e){const t=T([]),o=T(!1);return{eventAdmins:t,showAddAdmin:o,loadEventAdmins:async()=>{try{const d=await Dc.getAdmins(e.value);return t.value=d.data,d.data}catch(d){throw console.error("Failed to load event admins:",d),d}},openAddAdminModal:()=>{o.value=!0},closeAddAdminModal:()=>{o.value=!1},addAdmin:async d=>{await Dc.addAdmin(e.value,d)},removeAdmin:async d=>{await Dc.removeAdmin(e.value,d)}}}function E0(e){const t=T(!1),o=T(!1),i=T(!1),s=T(!1),a=T(!1),c=T(!1),u=T(null),d=T(null),f=T(null),p=T(null);return{showUploadRoute:t,showImportLocations:o,showImportMarshals:i,uploading:s,importing:a,importingMarshals:c,uploadError:u,importError:d,importResult:f,importMarshalsResult:p,openUploadRouteModal:()=>{u.value=null,t.value=!0},closeUploadRouteModal:()=>{t.value=!1,u.value=null},uploadRoute:async A=>{if(!A)return u.value="Please select a GPX file",null;s.value=!0,u.value=null;try{return await Gi.uploadGpx(e.value,A),!0}catch(U){return console.error("Failed to upload route:",U),u.value=U.response?.data?.message||"Failed to upload route. Please try again.",null}finally{s.value=!1}},openImportLocationsModal:()=>{d.value=null,f.value=null,o.value=!0},closeImportLocationsModal:()=>{o.value=!1,d.value=null,f.value=null},importLocations:async(A,U)=>{if(!A)return d.value="Please select a CSV file",null;a.value=!0,d.value=null,f.value=null;try{const I=await Xn.importCsv(e.value,A,U);return f.value=I.data,I.data}catch(I){return console.error("Failed to import locations:",I),d.value=I.response?.data?.message||"Failed to import locations. Please try again.",null}finally{a.value=!1}},openImportMarshalsModal:()=>{d.value=null,p.value=null,i.value=!0},closeImportMarshalsModal:()=>{i.value=!1,d.value=null,p.value=null},importMarshals:async A=>{if(!A)return d.value="Please select a CSV file",null;c.value=!0,d.value=null,p.value=null;try{const U=await ms.importCsv(e.value,A);return p.value=U.data,U.data}catch(U){return console.error("Failed to import marshals:",U),d.value=U.response?.data?.message||"Failed to import marshals. Please try again.",null}finally{c.value=!1}},formatImportResultMessage:(A,U="location")=>{const I=U==="location"?"location(s)":"marshal(s)";let O=`<p>Created <strong>${A[U==="location"?"locationsCreated":"marshalsCreated"]}</strong> ${I} and <strong>${A.assignmentsCreated}</strong> assignment(s)</p>`;return A.errors&&A.errors.length>0&&(O+='<br><p><strong>Errors:</strong></p><ul style="margin: 0; padding-left: 1.5rem;">',A.errors.forEach(q=>{O+=`<li>${q}</li>`}),O+="</ul>"),O}}}const yv=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",Ol=e=>{if(!e)return"";const t=new Date(e),o=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=String(t.getHours()).padStart(2,"0"),c=String(t.getMinutes()).padStart(2,"0");return`${o}-${i}-${s}T${a}:${c}`},Mr=e=>{if(!e||e.trim()==="")return!0;if(!/^[a-z]{1,20}[./][a-z]{1,20}[./][a-z]{1,20}$/.test(e))return!1;const o=e.includes("."),i=e.includes("/");return o!==i};function P0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var hl={exports:{}};var D0=hl.exports,Fh;function O0(){return Fh||(Fh=1,(function(e,t){(function(o,i){i(t)})(D0,(function(o){var i="1.9.4";function s(n){var r,h,y,x;for(h=1,y=arguments.length;h<y;h++){x=arguments[h];for(r in x)n[r]=x[r]}return n}var a=Object.create||(function(){function n(){}return function(r){return n.prototype=r,new n}})();function c(n,r){var h=Array.prototype.slice;if(n.bind)return n.bind.apply(n,h.call(arguments,1));var y=h.call(arguments,2);return function(){return n.apply(r,y.length?y.concat(h.call(arguments)):arguments)}}var u=0;function d(n){return"_leaflet_id"in n||(n._leaflet_id=++u),n._leaflet_id}function f(n,r,h){var y,x,F,ne;return ne=function(){y=!1,x&&(F.apply(h,x),x=!1)},F=function(){y?x=arguments:(n.apply(h,arguments),setTimeout(ne,r),y=!0)},F}function p(n,r,h){var y=r[1],x=r[0],F=y-x;return n===y&&h?n:((n-x)%F+F)%F+x}function g(){return!1}function k(n,r){if(r===!1)return n;var h=Math.pow(10,r===void 0?6:r);return Math.round(n*h)/h}function _(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function b(n){return _(n).split(/\s+/)}function C(n,r){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?a(n.options):{});for(var h in r)n.options[h]=r[h];return n.options}function E(n,r,h){var y=[];for(var x in n)y.push(encodeURIComponent(h?x.toUpperCase():x)+"="+encodeURIComponent(n[x]));return(!r||r.indexOf("?")===-1?"?":"&")+y.join("&")}var D=/\{ *([\w_ -]+) *\}/g;function M(n,r){return n.replace(D,function(h,y){var x=r[y];if(x===void 0)throw new Error("No value provided for variable "+h);return typeof x=="function"&&(x=x(r)),x})}var S=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function $(n,r){for(var h=0;h<n.length;h++)if(n[h]===r)return h;return-1}var A="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function U(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var I=0;function H(n){var r=+new Date,h=Math.max(0,16-(r-I));return I=r+h,window.setTimeout(n,h)}var O=window.requestAnimationFrame||U("RequestAnimationFrame")||H,q=window.cancelAnimationFrame||U("CancelAnimationFrame")||U("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function V(n,r,h){if(h&&O===H)n.call(r);else return O.call(window,c(n,r))}function Q(n){n&&q.call(window,n)}var de={__proto__:null,extend:s,create:a,bind:c,get lastId(){return u},stamp:d,throttle:f,wrapNum:p,falseFn:g,formatNum:k,trim:_,splitWords:b,setOptions:C,getParamString:E,template:M,isArray:S,indexOf:$,emptyImageUrl:A,requestFn:O,cancelFn:q,requestAnimFrame:V,cancelAnimFrame:Q};function Ee(){}Ee.extend=function(n){var r=function(){C(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=r.__super__=this.prototype,y=a(h);y.constructor=r,r.prototype=y;for(var x in this)Object.prototype.hasOwnProperty.call(this,x)&&x!=="prototype"&&x!=="__super__"&&(r[x]=this[x]);return n.statics&&s(r,n.statics),n.includes&&(ge(n.includes),s.apply(null,[y].concat(n.includes))),s(y,n),delete y.statics,delete y.includes,y.options&&(y.options=h.options?a(h.options):{},s(y.options,n.options)),y._initHooks=[],y.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var F=0,ne=y._initHooks.length;F<ne;F++)y._initHooks[F].call(this)}},r},Ee.include=function(n){var r=this.prototype.options;return s(this.prototype,n),n.options&&(this.prototype.options=r,this.mergeOptions(n.options)),this},Ee.mergeOptions=function(n){return s(this.prototype.options,n),this},Ee.addInitHook=function(n){var r=Array.prototype.slice.call(arguments,1),h=typeof n=="function"?n:function(){this[n].apply(this,r)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function ge(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=S(n)?n:[n];for(var r=0;r<n.length;r++)n[r]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Pe={on:function(n,r,h){if(typeof n=="object")for(var y in n)this._on(y,n[y],r);else{n=b(n);for(var x=0,F=n.length;x<F;x++)this._on(n[x],r,h)}return this},off:function(n,r,h){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var y in n)this._off(y,n[y],r);else{n=b(n);for(var x=arguments.length===1,F=0,ne=n.length;F<ne;F++)x?this._off(n[F]):this._off(n[F],r,h)}return this},_on:function(n,r,h,y){if(typeof r!="function"){console.warn("wrong listener type: "+typeof r);return}if(this._listens(n,r,h)===!1){h===this&&(h=void 0);var x={fn:r,ctx:h};y&&(x.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(x)}},_off:function(n,r,h){var y,x,F;if(this._events&&(y=this._events[n],!!y)){if(arguments.length===1){if(this._firingCount)for(x=0,F=y.length;x<F;x++)y[x].fn=g;delete this._events[n];return}if(typeof r!="function"){console.warn("wrong listener type: "+typeof r);return}var ne=this._listens(n,r,h);if(ne!==!1){var _e=y[ne];this._firingCount&&(_e.fn=g,this._events[n]=y=y.slice()),y.splice(ne,1)}}},fire:function(n,r,h){if(!this.listens(n,h))return this;var y=s({},r,{type:n,target:this,sourceTarget:r&&r.sourceTarget||this});if(this._events){var x=this._events[n];if(x){this._firingCount=this._firingCount+1||1;for(var F=0,ne=x.length;F<ne;F++){var _e=x[F],we=_e.fn;_e.once&&this.off(n,we,_e.ctx),we.call(_e.ctx||this,y)}this._firingCount--}}return h&&this._propagateEvent(y),this},listens:function(n,r,h,y){typeof n!="string"&&console.warn('"string" type argument expected');var x=r;typeof r!="function"&&(y=!!r,x=void 0,h=void 0);var F=this._events&&this._events[n];if(F&&F.length&&this._listens(n,x,h)!==!1)return!0;if(y){for(var ne in this._eventParents)if(this._eventParents[ne].listens(n,r,h,y))return!0}return!1},_listens:function(n,r,h){if(!this._events)return!1;var y=this._events[n]||[];if(!r)return!!y.length;h===this&&(h=void 0);for(var x=0,F=y.length;x<F;x++)if(y[x].fn===r&&y[x].ctx===h)return x;return!1},once:function(n,r,h){if(typeof n=="object")for(var y in n)this._on(y,n[y],r,!0);else{n=b(n);for(var x=0,F=n.length;x<F;x++)this._on(n[x],r,h,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[d(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[d(n)],this},_propagateEvent:function(n){for(var r in this._eventParents)this._eventParents[r].fire(n.type,s({layer:n.target,propagatedFrom:n.target},n),!0)}};Pe.addEventListener=Pe.on,Pe.removeEventListener=Pe.clearAllEventListeners=Pe.off,Pe.addOneTimeEventListener=Pe.once,Pe.fireEvent=Pe.fire,Pe.hasEventListeners=Pe.listens;var Fe=Ee.extend(Pe);function ce(n,r,h){this.x=h?Math.round(n):n,this.y=h?Math.round(r):r}var Me=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};ce.prototype={clone:function(){return new ce(this.x,this.y)},add:function(n){return this.clone()._add(ke(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(ke(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new ce(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new ce(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Me(this.x),this.y=Me(this.y),this},distanceTo:function(n){n=ke(n);var r=n.x-this.x,h=n.y-this.y;return Math.sqrt(r*r+h*h)},equals:function(n){return n=ke(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=ke(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+k(this.x)+", "+k(this.y)+")"}};function ke(n,r,h){return n instanceof ce?n:S(n)?new ce(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new ce(n.x,n.y):new ce(n,r,h)}function re(n,r){if(n)for(var h=r?[n,r]:n,y=0,x=h.length;y<x;y++)this.extend(h[y])}re.prototype={extend:function(n){var r,h;if(!n)return this;if(n instanceof ce||typeof n[0]=="number"||"x"in n)r=h=ke(n);else if(n=Re(n),r=n.min,h=n.max,!r||!h)return this;return!this.min&&!this.max?(this.min=r.clone(),this.max=h.clone()):(this.min.x=Math.min(r.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(r.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(n){return ke((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return ke(this.min.x,this.max.y)},getTopRight:function(){return ke(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var r,h;return typeof n[0]=="number"||n instanceof ce?n=ke(n):n=Re(n),n instanceof re?(r=n.min,h=n.max):r=h=n,r.x>=this.min.x&&h.x<=this.max.x&&r.y>=this.min.y&&h.y<=this.max.y},intersects:function(n){n=Re(n);var r=this.min,h=this.max,y=n.min,x=n.max,F=x.x>=r.x&&y.x<=h.x,ne=x.y>=r.y&&y.y<=h.y;return F&&ne},overlaps:function(n){n=Re(n);var r=this.min,h=this.max,y=n.min,x=n.max,F=x.x>r.x&&y.x<h.x,ne=x.y>r.y&&y.y<h.y;return F&&ne},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var r=this.min,h=this.max,y=Math.abs(r.x-h.x)*n,x=Math.abs(r.y-h.y)*n;return Re(ke(r.x-y,r.y-x),ke(h.x+y,h.y+x))},equals:function(n){return n?(n=Re(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function Re(n,r){return!n||n instanceof re?n:new re(n,r)}function Je(n,r){if(n)for(var h=r?[n,r]:n,y=0,x=h.length;y<x;y++)this.extend(h[y])}Je.prototype={extend:function(n){var r=this._southWest,h=this._northEast,y,x;if(n instanceof qe)y=n,x=n;else if(n instanceof Je){if(y=n._southWest,x=n._northEast,!y||!x)return this}else return n?this.extend(Qe(n)||tt(n)):this;return!r&&!h?(this._southWest=new qe(y.lat,y.lng),this._northEast=new qe(x.lat,x.lng)):(r.lat=Math.min(y.lat,r.lat),r.lng=Math.min(y.lng,r.lng),h.lat=Math.max(x.lat,h.lat),h.lng=Math.max(x.lng,h.lng)),this},pad:function(n){var r=this._southWest,h=this._northEast,y=Math.abs(r.lat-h.lat)*n,x=Math.abs(r.lng-h.lng)*n;return new Je(new qe(r.lat-y,r.lng-x),new qe(h.lat+y,h.lng+x))},getCenter:function(){return new qe((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new qe(this.getNorth(),this.getWest())},getSouthEast:function(){return new qe(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof qe||"lat"in n?n=Qe(n):n=tt(n);var r=this._southWest,h=this._northEast,y,x;return n instanceof Je?(y=n.getSouthWest(),x=n.getNorthEast()):y=x=n,y.lat>=r.lat&&x.lat<=h.lat&&y.lng>=r.lng&&x.lng<=h.lng},intersects:function(n){n=tt(n);var r=this._southWest,h=this._northEast,y=n.getSouthWest(),x=n.getNorthEast(),F=x.lat>=r.lat&&y.lat<=h.lat,ne=x.lng>=r.lng&&y.lng<=h.lng;return F&&ne},overlaps:function(n){n=tt(n);var r=this._southWest,h=this._northEast,y=n.getSouthWest(),x=n.getNorthEast(),F=x.lat>r.lat&&y.lat<h.lat,ne=x.lng>r.lng&&y.lng<h.lng;return F&&ne},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,r){return n?(n=tt(n),this._southWest.equals(n.getSouthWest(),r)&&this._northEast.equals(n.getNorthEast(),r)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function tt(n,r){return n instanceof Je?n:new Je(n,r)}function qe(n,r,h){if(isNaN(n)||isNaN(r))throw new Error("Invalid LatLng object: ("+n+", "+r+")");this.lat=+n,this.lng=+r,h!==void 0&&(this.alt=+h)}qe.prototype={equals:function(n,r){if(!n)return!1;n=Qe(n);var h=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return h<=(r===void 0?1e-9:r)},toString:function(n){return"LatLng("+k(this.lat,n)+", "+k(this.lng,n)+")"},distanceTo:function(n){return ze.distance(this,Qe(n))},wrap:function(){return ze.wrapLatLng(this)},toBounds:function(n){var r=180*n/40075017,h=r/Math.cos(Math.PI/180*this.lat);return tt([this.lat-r,this.lng-h],[this.lat+r,this.lng+h])},clone:function(){return new qe(this.lat,this.lng,this.alt)}};function Qe(n,r,h){return n instanceof qe?n:S(n)&&typeof n[0]!="object"?n.length===3?new qe(n[0],n[1],n[2]):n.length===2?new qe(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new qe(n.lat,"lng"in n?n.lng:n.lon,n.alt):r===void 0?null:new qe(n,r,h)}var be={latLngToPoint:function(n,r){var h=this.projection.project(n),y=this.scale(r);return this.transformation._transform(h,y)},pointToLatLng:function(n,r){var h=this.scale(r),y=this.transformation.untransform(n,h);return this.projection.unproject(y)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var r=this.projection.bounds,h=this.scale(n),y=this.transformation.transform(r.min,h),x=this.transformation.transform(r.max,h);return new re(y,x)},infinite:!1,wrapLatLng:function(n){var r=this.wrapLng?p(n.lng,this.wrapLng,!0):n.lng,h=this.wrapLat?p(n.lat,this.wrapLat,!0):n.lat,y=n.alt;return new qe(h,r,y)},wrapLatLngBounds:function(n){var r=n.getCenter(),h=this.wrapLatLng(r),y=r.lat-h.lat,x=r.lng-h.lng;if(y===0&&x===0)return n;var F=n.getSouthWest(),ne=n.getNorthEast(),_e=new qe(F.lat-y,F.lng-x),we=new qe(ne.lat-y,ne.lng-x);return new Je(_e,we)}},ze=s({},be,{wrapLng:[-180,180],R:6371e3,distance:function(n,r){var h=Math.PI/180,y=n.lat*h,x=r.lat*h,F=Math.sin((r.lat-n.lat)*h/2),ne=Math.sin((r.lng-n.lng)*h/2),_e=F*F+Math.cos(y)*Math.cos(x)*ne*ne,we=2*Math.atan2(Math.sqrt(_e),Math.sqrt(1-_e));return this.R*we}}),fe=6378137,Le={R:fe,MAX_LATITUDE:85.0511287798,project:function(n){var r=Math.PI/180,h=this.MAX_LATITUDE,y=Math.max(Math.min(h,n.lat),-h),x=Math.sin(y*r);return new ce(this.R*n.lng*r,this.R*Math.log((1+x)/(1-x))/2)},unproject:function(n){var r=180/Math.PI;return new qe((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*r,n.x*r/this.R)},bounds:(function(){var n=fe*Math.PI;return new re([-n,-n],[n,n])})()};function Ae(n,r,h,y){if(S(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=r,this._c=h,this._d=y}Ae.prototype={transform:function(n,r){return this._transform(n.clone(),r)},_transform:function(n,r){return r=r||1,n.x=r*(this._a*n.x+this._b),n.y=r*(this._c*n.y+this._d),n},untransform:function(n,r){return r=r||1,new ce((n.x/r-this._b)/this._a,(n.y/r-this._d)/this._c)}};function W(n,r,h,y){return new Ae(n,r,h,y)}var J=s({},ze,{code:"EPSG:3857",projection:Le,transformation:(function(){var n=.5/(Math.PI*Le.R);return W(n,.5,-n,.5)})()}),ue=s({},J,{code:"EPSG:900913"});function ye(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function ae(n,r){var h="",y,x,F,ne,_e,we;for(y=0,F=n.length;y<F;y++){for(_e=n[y],x=0,ne=_e.length;x<ne;x++)we=_e[x],h+=(x?"L":"M")+we.x+" "+we.y;h+=r?et.svg?"z":"x":""}return h||"M0 0"}var ie=document.documentElement.style,he="ActiveXObject"in window,De=he&&!document.addEventListener,Te="msLaunchUri"in navigator&&!("documentMode"in document),oe=Vt("webkit"),ve=Vt("android"),se=Vt("android 2")||Vt("android 3"),te=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),X=ve&&Vt("Google")&&te<537&&!("AudioNode"in window),N=!!window.opera,K=!Te&&Vt("chrome"),ee=Vt("gecko")&&!oe&&!N&&!he,$e=!K&&Vt("safari"),We=Vt("phantom"),ot="OTransition"in ie,st=navigator.platform.indexOf("Win")===0,Ct=he&&"transition"in ie,St="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!se,At="MozPerspective"in ie,Kt=!window.L_DISABLE_3D&&(Ct||St||At)&&!ot&&!We,an=typeof orientation<"u"||Vt("mobile"),Hn=an&&oe,An=an&&St,Et=!window.PointerEvent&&window.MSPointerEvent,gt=!!(window.PointerEvent||Et),tn="ontouchstart"in window||!!window.TouchEvent,vn=!window.L_NO_TOUCH&&(tn||gt),to=an&&N,En=an&&ee,Yt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Yo=(function(){var n=!1;try{var r=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",g,r),window.removeEventListener("testPassiveEventSupport",g,r)}catch{}return n})(),ln=(function(){return!!document.createElement("canvas").getContext})(),no=!!(document.createElementNS&&ye("svg").createSVGRect),Nt=!!no&&(function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Vn=!no&&(function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var r=n.firstChild;return r.style.behavior="url(#default#VML)",r&&typeof r.adj=="object"}catch{return!1}})(),rn=navigator.platform.indexOf("Mac")===0,To=navigator.platform.indexOf("Linux")===0;function Vt(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var et={ie:he,ielt9:De,edge:Te,webkit:oe,android:ve,android23:se,androidStock:X,opera:N,chrome:K,gecko:ee,safari:$e,phantom:We,opera12:ot,win:st,ie3d:Ct,webkit3d:St,gecko3d:At,any3d:Kt,mobile:an,mobileWebkit:Hn,mobileWebkit3d:An,msPointer:Et,pointer:gt,touch:vn,touchNative:tn,mobileOpera:to,mobileGecko:En,retina:Yt,passiveEvents:Yo,canvas:ln,svg:no,vml:Vn,inlineSvg:Nt,mac:rn,linux:To},Mo=et.msPointer?"MSPointerDown":"pointerdown",ho=et.msPointer?"MSPointerMove":"pointermove",ys=et.msPointer?"MSPointerUp":"pointerup",fo=et.msPointer?"MSPointerCancel":"pointercancel",Jo={touchstart:Mo,touchmove:ho,touchend:ys,touchcancel:fo},Xo={touchstart:Ao,touchmove:oo,touchend:oo,touchcancel:oo},Ot={},po=!1;function Gn(n,r,h){return r==="touchstart"&&gn(),Xo[r]?(h=Xo[r].bind(this,h),n.addEventListener(Jo[r],h,!1),h):(console.warn("wrong event specified:",r),g)}function bn(n,r,h){if(!Jo[r]){console.warn("wrong event specified:",r);return}n.removeEventListener(Jo[r],h,!1)}function wn(n){Ot[n.pointerId]=n}function Zn(n){Ot[n.pointerId]&&(Ot[n.pointerId]=n)}function mn(n){delete Ot[n.pointerId]}function gn(){po||(document.addEventListener(Mo,wn,!0),document.addEventListener(ho,Zn,!0),document.addEventListener(ys,mn,!0),document.addEventListener(fo,mn,!0),po=!0)}function oo(n,r){if(r.pointerType!==(r.MSPOINTER_TYPE_MOUSE||"mouse")){r.touches=[];for(var h in Ot)r.touches.push(Ot[h]);r.changedTouches=[r],n(r)}}function Ao(n,r){r.MSPOINTER_TYPE_TOUCH&&r.pointerType===r.MSPOINTER_TYPE_TOUCH&&Xt(r),oo(n,r)}function Qo(n){var r={},h,y;for(y in n)h=n[y],r[y]=h&&h.bind?h.bind(n):h;return n=r,r.type="dblclick",r.detail=2,r.isTrusted=!1,r._simulated=!0,r}var Eo=200;function Po(n,r){n.addEventListener("dblclick",r);var h=0,y;function x(F){if(F.detail!==1){y=F.detail;return}if(!(F.pointerType==="mouse"||F.sourceCapabilities&&!F.sourceCapabilities.firesTouchEvents)){var ne=na(F);if(!(ne.some(function(we){return we instanceof HTMLLabelElement&&we.attributes.for})&&!ne.some(function(we){return we instanceof HTMLInputElement||we instanceof HTMLSelectElement}))){var _e=Date.now();_e-h<=Eo?(y++,y===2&&r(Qo(F))):y=1,h=_e}}}return n.addEventListener("click",x),{dblclick:r,simDblclick:x}}function jn(n,r){n.removeEventListener("dblclick",r.dblclick),n.removeEventListener("click",r.simDblclick)}var Do=Ys(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Mt=Ys(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),vo=Mt==="webkitTransition"||Mt==="OTransition"?Mt+"End":"transitionend";function so(n){return typeof n=="string"?document.getElementById(n):n}function Pn(n,r){var h=n.style[r]||n.currentStyle&&n.currentStyle[r];if((!h||h==="auto")&&document.defaultView){var y=document.defaultView.getComputedStyle(n,null);h=y?y[r]:null}return h==="auto"?null:h}function mt(n,r,h){var y=document.createElement(n);return y.className=r||"",h&&h.appendChild(y),y}function xt(n){var r=n.parentNode;r&&r.removeChild(n)}function _s(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function es(n){var r=n.parentNode;r&&r.lastChild!==n&&r.appendChild(n)}function ts(n){var r=n.parentNode;r&&r.firstChild!==n&&r.insertBefore(n,r.firstChild)}function mo(n,r){if(n.classList!==void 0)return n.classList.contains(r);var h=Ks(n);return h.length>0&&new RegExp("(^|\\s)"+r+"(\\s|$)").test(h)}function dt(n,r){if(n.classList!==void 0)for(var h=b(r),y=0,x=h.length;y<x;y++)n.classList.add(h[y]);else if(!mo(n,r)){var F=Ks(n);Ws(n,(F?F+" ":"")+r)}}function It(n,r){n.classList!==void 0?n.classList.remove(r):Ws(n,_((" "+Ks(n)+" ").replace(" "+r+" "," ")))}function Ws(n,r){n.className.baseVal===void 0?n.className=r:n.className.baseVal=r}function Ks(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function on(n,r){"opacity"in n.style?n.style.opacity=r:"filter"in n.style&&Va(n,r)}function Va(n,r){var h=!1,y="DXImageTransform.Microsoft.Alpha";try{h=n.filters.item(y)}catch{if(r===1)return}r=Math.round(r*100),h?(h.Enabled=r!==100,h.Opacity=r):n.style.filter+=" progid:"+y+"(opacity="+r+")"}function Ys(n){for(var r=document.documentElement.style,h=0;h<n.length;h++)if(n[h]in r)return n[h];return!1}function go(n,r,h){var y=r||new ce(0,0);n.style[Do]=(et.ie3d?"translate("+y.x+"px,"+y.y+"px)":"translate3d("+y.x+"px,"+y.y+"px,0)")+(h?" scale("+h+")":"")}function Ht(n,r){n._leaflet_pos=r,et.any3d?go(n,r):(n.style.left=r.x+"px",n.style.top=r.y+"px")}function io(n){return n._leaflet_pos||new ce(0,0)}var ks,bs,Li;if("onselectstart"in document)ks=function(){at(window,"selectstart",Xt)},bs=function(){_t(window,"selectstart",Xt)};else{var Rt=Ys(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);ks=function(){if(Rt){var n=document.documentElement.style;Li=n[Rt],n[Rt]="none"}},bs=function(){Rt&&(document.documentElement.style[Rt]=Li,Li=void 0)}}function Js(){at(window,"dragstart",Xt)}function Xs(){_t(window,"dragstart",Xt)}var yo,Si;function Qs(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(cn(),yo=n,Si=n.style.outlineStyle,n.style.outlineStyle="none",at(window,"keydown",cn))}function cn(){yo&&(yo.style.outlineStyle=Si,yo=void 0,Si=void 0,_t(window,"keydown",cn))}function Oo(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function qn(n){var r=n.getBoundingClientRect();return{x:r.width/n.offsetWidth||1,y:r.height/n.offsetHeight||1,boundingClientRect:r}}var ws={__proto__:null,TRANSFORM:Do,TRANSITION:Mt,TRANSITION_END:vo,get:so,getStyle:Pn,create:mt,remove:xt,empty:_s,toFront:es,toBack:ts,hasClass:mo,addClass:dt,removeClass:It,setClass:Ws,getClass:Ks,setOpacity:on,testProp:Ys,setTransform:go,setPosition:Ht,getPosition:io,get disableTextSelection(){return ks},get enableTextSelection(){return bs},disableImageDrag:Js,enableImageDrag:Xs,preventOutline:Qs,restoreOutline:cn,getSizedParentNode:Oo,getScale:qn};function at(n,r,h,y){if(r&&typeof r=="object")for(var x in r)ti(n,x,r[x],h);else{r=b(r);for(var F=0,ne=r.length;F<ne;F++)ti(n,r[F],h,y)}return this}var Jt="_leaflet_events";function _t(n,r,h,y){if(arguments.length===1)ei(n),delete n[Jt];else if(r&&typeof r=="object")for(var x in r)xi(n,x,r[x],h);else if(r=b(r),arguments.length===2)ei(n,function(_e){return $(r,_e)!==-1});else for(var F=0,ne=r.length;F<ne;F++)xi(n,r[F],h,y);return this}function ei(n,r){for(var h in n[Jt]){var y=h.split(/\d/)[0];(!r||r(y))&&xi(n,y,null,null,h)}}var Cs={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ti(n,r,h,y){var x=r+d(h)+(y?"_"+d(y):"");if(n[Jt]&&n[Jt][x])return this;var F=function(_e){return h.call(y||n,_e||window.event)},ne=F;!et.touchNative&&et.pointer&&r.indexOf("touch")===0?F=Gn(n,r,F):et.touch&&r==="dblclick"?F=Po(n,F):"addEventListener"in n?r==="touchstart"||r==="touchmove"||r==="wheel"||r==="mousewheel"?n.addEventListener(Cs[r]||r,F,et.passiveEvents?{passive:!1}:!1):r==="mouseenter"||r==="mouseleave"?(F=function(_e){_e=_e||window.event,Ii(n,_e)&&ne(_e)},n.addEventListener(Cs[r],F,!1)):n.addEventListener(r,ne,!1):n.attachEvent("on"+r,F),n[Jt]=n[Jt]||{},n[Jt][x]=F}function xi(n,r,h,y,x){x=x||r+d(h)+(y?"_"+d(y):"");var F=n[Jt]&&n[Jt][x];if(!F)return this;!et.touchNative&&et.pointer&&r.indexOf("touch")===0?bn(n,r,F):et.touch&&r==="dblclick"?jn(n,F):"removeEventListener"in n?n.removeEventListener(Cs[r]||r,F,!1):n.detachEvent("on"+r,F),n[Jt][x]=null}function _o(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function Ls(n){return ti(n,"wheel",_o),this}function ko(n){return at(n,"mousedown touchstart dblclick contextmenu",_o),n._leaflet_disable_click=!0,this}function Xt(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function ao(n){return Xt(n),_o(n),this}function na(n){if(n.composedPath)return n.composedPath();for(var r=[],h=n.target;h;)r.push(h),h=h.parentNode;return r}function oa(n,r){if(!r)return new ce(n.clientX,n.clientY);var h=qn(r),y=h.boundingClientRect;return new ce((n.clientX-y.left)/h.x-r.clientLeft,(n.clientY-y.top)/h.y-r.clientTop)}var Ga=et.linux&&et.chrome?window.devicePixelRatio:et.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function ni(n){return et.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/Ga:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function Ii(n,r){var h=r.relatedTarget;if(!h)return!0;try{for(;h&&h!==n;)h=h.parentNode}catch{return!1}return h!==n}var sa={__proto__:null,on:at,off:_t,stopPropagation:_o,disableScrollPropagation:Ls,disableClickPropagation:ko,preventDefault:Xt,stop:ao,getPropagationPath:na,getMousePosition:oa,getWheelDelta:ni,isExternalTarget:Ii,addListener:at,removeListener:_t},ns=Fe.extend({run:function(n,r,h,y){this.stop(),this._el=n,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(y||.5,.2),this._startPos=io(n),this._offset=r.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=V(this._animate,this),this._step()},_step:function(n){var r=+new Date-this._startTime,h=this._duration*1e3;r<h?this._runFrame(this._easeOut(r/h),n):(this._runFrame(1),this._complete())},_runFrame:function(n,r){var h=this._startPos.add(this._offset.multiplyBy(n));r&&h._round(),Ht(this._el,h),this.fire("step")},_complete:function(){Q(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),ct=Fe.extend({options:{crs:J,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,r){r=C(this,r),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=c(this._onResize,this),this._initEvents(),r.maxBounds&&this.setMaxBounds(r.maxBounds),r.zoom!==void 0&&(this._zoom=this._limitZoom(r.zoom)),r.center&&r.zoom!==void 0&&this.setView(Qe(r.center),r.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Mt&&et.any3d&&!et.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),at(this._proxy,vo,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,r,h){if(r=r===void 0?this._zoom:this._limitZoom(r),n=this._limitCenter(Qe(n),r,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=s({animate:h.animate},h.zoom),h.pan=s({animate:h.animate,duration:h.duration},h.pan));var y=this._zoom!==r?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,r,h.zoom):this._tryAnimatedPan(n,h.pan);if(y)return clearTimeout(this._sizeTimer),this}return this._resetView(n,r,h.pan&&h.pan.noMoveStart),this},setZoom:function(n,r){return this._loaded?this.setView(this.getCenter(),n,{zoom:r}):(this._zoom=n,this)},zoomIn:function(n,r){return n=n||(et.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,r)},zoomOut:function(n,r){return n=n||(et.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,r)},setZoomAround:function(n,r,h){var y=this.getZoomScale(r),x=this.getSize().divideBy(2),F=n instanceof ce?n:this.latLngToContainerPoint(n),ne=F.subtract(x).multiplyBy(1-1/y),_e=this.containerPointToLatLng(x.add(ne));return this.setView(_e,r,{zoom:h})},_getBoundsCenterZoom:function(n,r){r=r||{},n=n.getBounds?n.getBounds():tt(n);var h=ke(r.paddingTopLeft||r.padding||[0,0]),y=ke(r.paddingBottomRight||r.padding||[0,0]),x=this.getBoundsZoom(n,!1,h.add(y));if(x=typeof r.maxZoom=="number"?Math.min(r.maxZoom,x):x,x===1/0)return{center:n.getCenter(),zoom:x};var F=y.subtract(h).divideBy(2),ne=this.project(n.getSouthWest(),x),_e=this.project(n.getNorthEast(),x),we=this.unproject(ne.add(_e).divideBy(2).add(F),x);return{center:we,zoom:x}},fitBounds:function(n,r){if(n=tt(n),!n.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(n,r);return this.setView(h.center,h.zoom,r)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,r){return this.setView(n,this._zoom,{pan:r})},panBy:function(n,r){if(n=ke(n).round(),r=r||{},!n.x&&!n.y)return this.fire("moveend");if(r.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ns,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),r.noMoveStart||this.fire("movestart"),r.animate!==!1){dt(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,h,r.duration||.25,r.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,r,h){if(h=h||{},h.animate===!1||!et.any3d)return this.setView(n,r,h);this._stop();var y=this.project(this.getCenter()),x=this.project(n),F=this.getSize(),ne=this._zoom;n=Qe(n),r=r===void 0?ne:r;var _e=Math.max(F.x,F.y),we=_e*this.getZoomScale(ne,r),Ne=x.distanceTo(y)||1,Xe=1.42,ut=Xe*Xe;function yt(nn){var Xl=nn?-1:1,Vv=nn?we:_e,Gv=we*we-_e*_e+Xl*ut*ut*Ne*Ne,Zv=2*Vv*ut*Ne,pc=Gv/Zv,dd=Math.sqrt(pc*pc+1)-pc,jv=dd<1e-9?-18:Math.log(dd);return jv}function Dn(nn){return(Math.exp(nn)-Math.exp(-nn))/2}function dn(nn){return(Math.exp(nn)+Math.exp(-nn))/2}function Lo(nn){return Dn(nn)/dn(nn)}var Kn=yt(0);function ya(nn){return _e*(dn(Kn)/dn(Kn+Xe*nn))}function Fv(nn){return _e*(dn(Kn)*Lo(Kn+Xe*nn)-Dn(Kn))/ut}function Uv(nn){return 1-Math.pow(1-nn,1.5)}var zv=Date.now(),cd=(yt(1)-Kn)/Xe,Hv=h.duration?1e3*h.duration:1e3*cd*.8;function ud(){var nn=(Date.now()-zv)/Hv,Xl=Uv(nn)*cd;nn<=1?(this._flyToFrame=V(ud,this),this._move(this.unproject(y.add(x.subtract(y).multiplyBy(Fv(Xl)/Ne)),ne),this.getScaleZoom(_e/ya(Xl),ne),{flyTo:!0})):this._move(n,r)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),ud.call(this),this},flyToBounds:function(n,r){var h=this._getBoundsCenterZoom(n,r);return this.flyTo(h.center,h.zoom,r)},setMaxBounds:function(n){return n=tt(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var r=this.options.minZoom;return this.options.minZoom=n,this._loaded&&r!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var r=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&r!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,r){this._enforcingBounds=!0;var h=this.getCenter(),y=this._limitCenter(h,this._zoom,tt(n));return h.equals(y)||this.panTo(y,r),this._enforcingBounds=!1,this},panInside:function(n,r){r=r||{};var h=ke(r.paddingTopLeft||r.padding||[0,0]),y=ke(r.paddingBottomRight||r.padding||[0,0]),x=this.project(this.getCenter()),F=this.project(n),ne=this.getPixelBounds(),_e=Re([ne.min.add(h),ne.max.subtract(y)]),we=_e.getSize();if(!_e.contains(F)){this._enforcingBounds=!0;var Ne=F.subtract(_e.getCenter()),Xe=_e.extend(F).getSize().subtract(we);x.x+=Ne.x<0?-Xe.x:Xe.x,x.y+=Ne.y<0?-Xe.y:Xe.y,this.panTo(this.unproject(x),r),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=s({animate:!1,pan:!0},n===!0?{animate:!0}:n);var r=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),y=r.divideBy(2).round(),x=h.divideBy(2).round(),F=y.subtract(x);return!F.x&&!F.y?this:(n.animate&&n.pan?this.panBy(F):(n.pan&&this._rawPanBy(F),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:r,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=s({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var r=c(this._handleGeolocationResponse,this),h=c(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(r,h,n):navigator.geolocation.getCurrentPosition(r,h,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var r=n.code,h=n.message||(r===1?"permission denied":r===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:r,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var r=n.coords.latitude,h=n.coords.longitude,y=new qe(r,h),x=y.toBounds(n.coords.accuracy*2),F=this._locateOptions;if(F.setView){var ne=this.getBoundsZoom(x);this.setView(y,F.maxZoom?Math.min(ne,F.maxZoom):ne)}var _e={latlng:y,bounds:x,timestamp:n.timestamp};for(var we in n.coords)typeof n.coords[we]=="number"&&(_e[we]=n.coords[we]);this.fire("locationfound",_e)}},addHandler:function(n,r){if(!r)return this;var h=this[n]=new r(this);return this._handlers.push(h),this.options[n]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),xt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Q(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)xt(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,r){var h="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),y=mt("div",h,r||this._mapPane);return n&&(this._panes[n]=y),y},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),r=this.unproject(n.getBottomLeft()),h=this.unproject(n.getTopRight());return new Je(r,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,r,h){n=tt(n),h=ke(h||[0,0]);var y=this.getZoom()||0,x=this.getMinZoom(),F=this.getMaxZoom(),ne=n.getNorthWest(),_e=n.getSouthEast(),we=this.getSize().subtract(h),Ne=Re(this.project(_e,y),this.project(ne,y)).getSize(),Xe=et.any3d?this.options.zoomSnap:1,ut=we.x/Ne.x,yt=we.y/Ne.y,Dn=r?Math.max(ut,yt):Math.min(ut,yt);return y=this.getScaleZoom(Dn,y),Xe&&(y=Math.round(y/(Xe/100))*(Xe/100),y=r?Math.ceil(y/Xe)*Xe:Math.floor(y/Xe)*Xe),Math.max(x,Math.min(F,y))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ce(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,r){var h=this._getTopLeftPoint(n,r);return new re(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,r){var h=this.options.crs;return r=r===void 0?this._zoom:r,h.scale(n)/h.scale(r)},getScaleZoom:function(n,r){var h=this.options.crs;r=r===void 0?this._zoom:r;var y=h.zoom(n*h.scale(r));return isNaN(y)?1/0:y},project:function(n,r){return r=r===void 0?this._zoom:r,this.options.crs.latLngToPoint(Qe(n),r)},unproject:function(n,r){return r=r===void 0?this._zoom:r,this.options.crs.pointToLatLng(ke(n),r)},layerPointToLatLng:function(n){var r=ke(n).add(this.getPixelOrigin());return this.unproject(r)},latLngToLayerPoint:function(n){var r=this.project(Qe(n))._round();return r._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(Qe(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(tt(n))},distance:function(n,r){return this.options.crs.distance(Qe(n),Qe(r))},containerPointToLayerPoint:function(n){return ke(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return ke(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var r=this.containerPointToLayerPoint(ke(n));return this.layerPointToLatLng(r)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Qe(n)))},mouseEventToContainerPoint:function(n){return oa(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var r=this._container=so(n);if(r){if(r._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");at(r,"scroll",this._onScroll,this),this._containerId=d(r)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&et.any3d,dt(n,"leaflet-container"+(et.touch?" leaflet-touch":"")+(et.retina?" leaflet-retina":"")+(et.ielt9?" leaflet-oldie":"")+(et.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var r=Pn(n,"position");r!=="absolute"&&r!=="relative"&&r!=="fixed"&&r!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ht(this._mapPane,new ce(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(dt(n.markerPane,"leaflet-zoom-hide"),dt(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,r,h){Ht(this._mapPane,new ce(0,0));var y=!this._loaded;this._loaded=!0,r=this._limitZoom(r),this.fire("viewprereset");var x=this._zoom!==r;this._moveStart(x,h)._move(n,r)._moveEnd(x),this.fire("viewreset"),y&&this.fire("load")},_moveStart:function(n,r){return n&&this.fire("zoomstart"),r||this.fire("movestart"),this},_move:function(n,r,h,y){r===void 0&&(r=this._zoom);var x=this._zoom!==r;return this._zoom=r,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),y?h&&h.pinch&&this.fire("zoom",h):((x||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Q(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){Ht(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[d(this._container)]=this;var r=n?_t:at;r(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&r(window,"resize",this._onResize,this),et.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Q(this._resizeRequest),this._resizeRequest=V(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,r){for(var h=[],y,x=r==="mouseout"||r==="mouseover",F=n.target||n.srcElement,ne=!1;F;){if(y=this._targets[d(F)],y&&(r==="click"||r==="preclick")&&this._draggableMoved(y)){ne=!0;break}if(y&&y.listens(r,!0)&&(x&&!Ii(F,n)||(h.push(y),x))||F===this._container)break;F=F.parentNode}return!h.length&&!ne&&!x&&this.listens(r,!0)&&(h=[this]),h},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var r=n.target||n.srcElement;if(!(!this._loaded||r._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(r))){var h=n.type;h==="mousedown"&&Qs(r),this._fireDOMEvent(n,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,r,h){if(n.type==="click"){var y=s({},n);y.type="preclick",this._fireDOMEvent(y,y.type,h)}var x=this._findEventTargets(n,r);if(h){for(var F=[],ne=0;ne<h.length;ne++)h[ne].listens(r,!0)&&F.push(h[ne]);x=F.concat(x)}if(x.length){r==="contextmenu"&&Xt(n);var _e=x[0],we={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var Ne=_e.getLatLng&&(!_e._radius||_e._radius<=10);we.containerPoint=Ne?this.latLngToContainerPoint(_e.getLatLng()):this.mouseEventToContainerPoint(n),we.layerPoint=this.containerPointToLayerPoint(we.containerPoint),we.latlng=Ne?_e.getLatLng():this.layerPointToLatLng(we.layerPoint)}for(ne=0;ne<x.length;ne++)if(x[ne].fire(r,we,!0),we.originalEvent._stopped||x[ne].options.bubblingMouseEvents===!1&&$(this._mouseEvents,r)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,r=this._handlers.length;n<r;n++)this._handlers[n].disable()},whenReady:function(n,r){return this._loaded?n.call(r||this,{target:this}):this.on("load",n,r),this},_getMapPanePos:function(){return io(this._mapPane)||new ce(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,r){var h=n&&r!==void 0?this._getNewPixelOrigin(n,r):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,r){var h=this.getSize()._divideBy(2);return this.project(n,r)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,r,h){var y=this._getNewPixelOrigin(h,r);return this.project(n,r)._subtract(y)},_latLngBoundsToNewLayerBounds:function(n,r,h){var y=this._getNewPixelOrigin(h,r);return Re([this.project(n.getSouthWest(),r)._subtract(y),this.project(n.getNorthWest(),r)._subtract(y),this.project(n.getSouthEast(),r)._subtract(y),this.project(n.getNorthEast(),r)._subtract(y)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,r,h){if(!h)return n;var y=this.project(n,r),x=this.getSize().divideBy(2),F=new re(y.subtract(x),y.add(x)),ne=this._getBoundsOffset(F,h,r);return Math.abs(ne.x)<=1&&Math.abs(ne.y)<=1?n:this.unproject(y.add(ne),r)},_limitOffset:function(n,r){if(!r)return n;var h=this.getPixelBounds(),y=new re(h.min.add(n),h.max.add(n));return n.add(this._getBoundsOffset(y,r))},_getBoundsOffset:function(n,r,h){var y=Re(this.project(r.getNorthEast(),h),this.project(r.getSouthWest(),h)),x=y.min.subtract(n.min),F=y.max.subtract(n.max),ne=this._rebound(x.x,-F.x),_e=this._rebound(x.y,-F.y);return new ce(ne,_e)},_rebound:function(n,r){return n+r>0?Math.round(n-r)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(r))},_limitZoom:function(n){var r=this.getMinZoom(),h=this.getMaxZoom(),y=et.any3d?this.options.zoomSnap:1;return y&&(n=Math.round(n/y)*y),Math.max(r,Math.min(h,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){It(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,r){var h=this._getCenterOffset(n)._trunc();return(r&&r.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,r),!0)},_createAnimProxy:function(){var n=this._proxy=mt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(r){var h=Do,y=this._proxy.style[h];go(this._proxy,this.project(r.center,r.zoom),this.getZoomScale(r.zoom,1)),y===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){xt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),r=this.getZoom();go(this._proxy,this.project(n,r),this.getZoomScale(r,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,r,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(r-this._zoom)>this.options.zoomAnimationThreshold)return!1;var y=this.getZoomScale(r),x=this._getCenterOffset(n)._divideBy(1-1/y);return h.animate!==!0&&!this.getSize().contains(x)?!1:(V(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(n,r,!0)},this),!0)},_animateZoom:function(n,r,h,y){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=r,dt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:r,noUpdate:y}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(c(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&It(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Za(n,r){return new ct(n,r)}var Cn=Ee.extend({options:{position:"topright"},initialize:function(n){C(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var r=this._map;return r&&r.removeControl(this),this.options.position=n,r&&r.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var r=this._container=this.onAdd(n),h=this.getPosition(),y=n._controlCorners[h];return dt(r,"leaflet-control"),h.indexOf("bottom")!==-1?y.insertBefore(r,y.firstChild):y.appendChild(r),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(xt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),os=function(n){return new Cn(n)};ct.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},r="leaflet-",h=this._controlContainer=mt("div",r+"control-container",this._container);function y(x,F){var ne=r+x+" "+r+F;n[x+F]=mt("div",ne,h)}y("top","left"),y("top","right"),y("bottom","left"),y("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)xt(this._controlCorners[n]);xt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var oi=Cn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,r,h,y){return h<y?-1:y<h?1:0}},initialize:function(n,r,h){C(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var y in n)this._addLayer(n[y],y);for(y in r)this._addLayer(r[y],y,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return Cn.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,r){return this._addLayer(n,r),this._map?this._update():this},addOverlay:function(n,r){return this._addLayer(n,r,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var r=this._getLayer(d(n));return r&&this._layers.splice(this._layers.indexOf(r),1),this._map?this._update():this},expand:function(){dt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(dt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):It(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return It(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",r=this._container=mt("div",n),h=this.options.collapsed;r.setAttribute("aria-haspopup",!0),ko(r),Ls(r);var y=this._section=mt("section",n+"-list");h&&(this._map.on("click",this.collapse,this),at(r,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var x=this._layersLink=mt("a",n+"-toggle",r);x.href="#",x.title="Layers",x.setAttribute("role","button"),at(x,{keydown:function(F){F.keyCode===13&&this._expandSafely()},click:function(F){Xt(F),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=mt("div",n+"-base",y),this._separator=mt("div",n+"-separator",y),this._overlaysList=mt("div",n+"-overlays",y),r.appendChild(y)},_getLayer:function(n){for(var r=0;r<this._layers.length;r++)if(this._layers[r]&&d(this._layers[r].layer)===n)return this._layers[r]},_addLayer:function(n,r,h){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:r,overlay:h}),this.options.sortLayers&&this._layers.sort(c(function(y,x){return this.options.sortFunction(y.layer,x.layer,y.name,x.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;_s(this._baseLayersList),_s(this._overlaysList),this._layerControlInputs=[];var n,r,h,y,x=0;for(h=0;h<this._layers.length;h++)y=this._layers[h],this._addItem(y),r=r||y.overlay,n=n||!y.overlay,x+=y.overlay?0:1;return this.options.hideSingleBase&&(n=n&&x>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=r&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var r=this._getLayer(d(n.target)),h=r.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;h&&this._map.fire(h,r)},_createRadioElement:function(n,r){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(r?' checked="checked"':"")+"/>",y=document.createElement("div");return y.innerHTML=h,y.firstChild},_addItem:function(n){var r=document.createElement("label"),h=this._map.hasLayer(n.layer),y;n.overlay?(y=document.createElement("input"),y.type="checkbox",y.className="leaflet-control-layers-selector",y.defaultChecked=h):y=this._createRadioElement("leaflet-base-layers_"+d(this),h),this._layerControlInputs.push(y),y.layerId=d(n.layer),at(y,"click",this._onInputClick,this);var x=document.createElement("span");x.innerHTML=" "+n.name;var F=document.createElement("span");r.appendChild(F),F.appendChild(y),F.appendChild(x);var ne=n.overlay?this._overlaysList:this._baseLayersList;return ne.appendChild(r),this._checkDisabledLayers(),r},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,r,h,y=[],x=[];this._handlingClick=!0;for(var F=n.length-1;F>=0;F--)r=n[F],h=this._getLayer(r.layerId).layer,r.checked?y.push(h):r.checked||x.push(h);for(F=0;F<x.length;F++)this._map.hasLayer(x[F])&&this._map.removeLayer(x[F]);for(F=0;F<y.length;F++)this._map.hasLayer(y[F])||this._map.addLayer(y[F]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,r,h,y=this._map.getZoom(),x=n.length-1;x>=0;x--)r=n[x],h=this._getLayer(r.layerId).layer,r.disabled=h.options.minZoom!==void 0&&y<h.options.minZoom||h.options.maxZoom!==void 0&&y>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,at(n,"click",Xt),this.expand();var r=this;setTimeout(function(){_t(n,"click",Xt),r._preventClick=!1})}}),si=function(n,r,h){return new oi(n,r,h)},$i=Cn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var r="leaflet-control-zoom",h=mt("div",r+" leaflet-bar"),y=this.options;return this._zoomInButton=this._createButton(y.zoomInText,y.zoomInTitle,r+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(y.zoomOutText,y.zoomOutTitle,r+"-out",h,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,r,h,y,x){var F=mt("a",h,y);return F.innerHTML=n,F.href="#",F.title=r,F.setAttribute("role","button"),F.setAttribute("aria-label",r),ko(F),at(F,"click",ao),at(F,"click",x,this),at(F,"click",this._refocusOnMap,this),F},_updateDisabled:function(){var n=this._map,r="leaflet-disabled";It(this._zoomInButton,r),It(this._zoomOutButton,r),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(dt(this._zoomOutButton,r),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(dt(this._zoomInButton,r),this._zoomInButton.setAttribute("aria-disabled","true"))}});ct.mergeOptions({zoomControl:!0}),ct.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new $i,this.addControl(this.zoomControl))});var ja=function(n){return new $i(n)},Ss=Cn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var r="leaflet-control-scale",h=mt("div",r),y=this.options;return this._addScales(y,r+"-line",h),n.on(y.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),h},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,r,h){n.metric&&(this._mScale=mt("div",r,h)),n.imperial&&(this._iScale=mt("div",r,h))},_update:function(){var n=this._map,r=n.getSize().y/2,h=n.distance(n.containerPointToLatLng([0,r]),n.containerPointToLatLng([this.options.maxWidth,r]));this._updateScales(h)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var r=this._getRoundNum(n),h=r<1e3?r+" m":r/1e3+" km";this._updateScale(this._mScale,h,r/n)},_updateImperial:function(n){var r=n*3.2808399,h,y,x;r>5280?(h=r/5280,y=this._getRoundNum(h),this._updateScale(this._iScale,y+" mi",y/h)):(x=this._getRoundNum(r),this._updateScale(this._iScale,x+" ft",x/r))},_updateScale:function(n,r,h){n.style.width=Math.round(this.options.maxWidth*h)+"px",n.innerHTML=r},_getRoundNum:function(n){var r=Math.pow(10,(Math.floor(n)+"").length-1),h=n/r;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,r*h}}),ia=function(n){return new Ss(n)},qa='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',ss=Cn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(et.inlineSvg?qa+" ":"")+"Leaflet</a>"},initialize:function(n){C(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=mt("div","leaflet-control-attribution"),ko(this._container);for(var r in n._layers)n._layers[r].getAttribution&&this.addAttribution(n._layers[r].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var r in this._attributions)this._attributions[r]&&n.push(r);var h=[];this.options.prefix&&h.push(this.options.prefix),n.length&&h.push(n.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});ct.mergeOptions({attributionControl:!0}),ct.addInitHook(function(){this.options.attributionControl&&new ss().addTo(this)});var ii=function(n){return new ss(n)};Cn.Layers=oi,Cn.Zoom=$i,Cn.Scale=Ss,Cn.Attribution=ss,os.layers=si,os.zoom=ja,os.scale=ia,os.attribution=ii;var Wn=Ee.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Wn.addTo=function(n,r){return n.addHandler(r,this),this};var Wa={Events:Pe},aa=et.touch?"touchstart mousedown":"mousedown",bo=Fe.extend({options:{clickTolerance:3},initialize:function(n,r,h,y){C(this,y),this._element=n,this._dragStartTarget=r||n,this._preventOutline=h},enable:function(){this._enabled||(at(this._dragStartTarget,aa,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(bo._dragging===this&&this.finishDrag(!0),_t(this._dragStartTarget,aa,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!mo(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){bo._dragging===this&&this.finishDrag();return}if(!(bo._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(bo._dragging=this,this._preventOutline&&Qs(this._element),Js(),ks(),!this._moving)){this.fire("down");var r=n.touches?n.touches[0]:n,h=Oo(this._element);this._startPoint=new ce(r.clientX,r.clientY),this._startPos=io(this._element),this._parentScale=qn(h);var y=n.type==="mousedown";at(document,y?"mousemove":"touchmove",this._onMove,this),at(document,y?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var r=n.touches&&n.touches.length===1?n.touches[0]:n,h=new ce(r.clientX,r.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,Xt(n),this._moved||(this.fire("dragstart"),this._moved=!0,dt(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),dt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),Ht(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){It(document.body,"leaflet-dragging"),this._lastTarget&&(It(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),_t(document,"mousemove touchmove",this._onMove,this),_t(document,"mouseup touchend touchcancel",this._onUp,this),Xs(),bs();var r=this._moved&&this._moving;this._moving=!1,bo._dragging=!1,r&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function Ti(n,r,h){var y,x=[1,4,2,8],F,ne,_e,we,Ne,Xe,ut,yt;for(F=0,Xe=n.length;F<Xe;F++)n[F]._code=R(n[F],r);for(_e=0;_e<4;_e++){for(ut=x[_e],y=[],F=0,Xe=n.length,ne=Xe-1;F<Xe;ne=F++)we=n[F],Ne=n[ne],we._code&ut?Ne._code&ut||(yt=B(Ne,we,ut,r,h),yt._code=R(yt,r),y.push(yt)):(Ne._code&ut&&(yt=B(Ne,we,ut,r,h),yt._code=R(yt,r),y.push(yt)),y.push(we));n=y}return n}function Ro(n,r){var h,y,x,F,ne,_e,we,Ne,Xe;if(!n||n.length===0)throw new Error("latlngs not passed");xe(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var ut=Qe([0,0]),yt=tt(n),Dn=yt.getNorthWest().distanceTo(yt.getSouthWest())*yt.getNorthEast().distanceTo(yt.getNorthWest());Dn<1700&&(ut=is(n));var dn=n.length,Lo=[];for(h=0;h<dn;h++){var Kn=Qe(n[h]);Lo.push(r.project(Qe([Kn.lat-ut.lat,Kn.lng-ut.lng])))}for(_e=we=Ne=0,h=0,y=dn-1;h<dn;y=h++)x=Lo[h],F=Lo[y],ne=x.y*F.x-F.y*x.x,we+=(x.x+F.x)*ne,Ne+=(x.y+F.y)*ne,_e+=ne*3;_e===0?Xe=Lo[0]:Xe=[we/_e,Ne/_e];var ya=r.unproject(ke(Xe));return Qe([ya.lat+ut.lat,ya.lng+ut.lng])}function is(n){for(var r=0,h=0,y=0,x=0;x<n.length;x++){var F=Qe(n[x]);r+=F.lat,h+=F.lng,y++}return Qe([r/y,h/y])}var la={__proto__:null,clipPolygon:Ti,polygonCenter:Ro,centroid:is};function ra(n,r){if(!r||!n.length)return n.slice();var h=r*r;return n=as(n,h),n=Ka(n,h),n}function ca(n,r,h){return Math.sqrt(Y(n,r,h,!0))}function Mi(n,r,h){return Y(n,r,h)}function Ka(n,r){var h=n.length,y=typeof Uint8Array<"u"?Uint8Array:Array,x=new y(h);x[0]=x[h-1]=1,Ai(n,x,r,0,h-1);var F,ne=[];for(F=0;F<h;F++)x[F]&&ne.push(n[F]);return ne}function Ai(n,r,h,y,x){var F=0,ne,_e,we;for(_e=y+1;_e<=x-1;_e++)we=Y(n[_e],n[y],n[x],!0),we>F&&(ne=_e,F=we);F>h&&(r[ne]=1,Ai(n,r,h,y,ne),Ai(n,r,h,ne,x))}function as(n,r){for(var h=[n[0]],y=1,x=0,F=n.length;y<F;y++)G(n[y],n[x])>r&&(h.push(n[y]),x=y);return x<F-1&&h.push(n[F-1]),h}var Ei;function Pi(n,r,h,y,x){var F=y?Ei:R(n,h),ne=R(r,h),_e,we,Ne;for(Ei=ne;;){if(!(F|ne))return[n,r];if(F&ne)return!1;_e=F||ne,we=B(n,r,_e,h,x),Ne=R(we,h),_e===F?(n=we,F=Ne):(r=we,ne=Ne)}}function B(n,r,h,y,x){var F=r.x-n.x,ne=r.y-n.y,_e=y.min,we=y.max,Ne,Xe;return h&8?(Ne=n.x+F*(we.y-n.y)/ne,Xe=we.y):h&4?(Ne=n.x+F*(_e.y-n.y)/ne,Xe=_e.y):h&2?(Ne=we.x,Xe=n.y+ne*(we.x-n.x)/F):h&1&&(Ne=_e.x,Xe=n.y+ne*(_e.x-n.x)/F),new ce(Ne,Xe,x)}function R(n,r){var h=0;return n.x<r.min.x?h|=1:n.x>r.max.x&&(h|=2),n.y<r.min.y?h|=4:n.y>r.max.y&&(h|=8),h}function G(n,r){var h=r.x-n.x,y=r.y-n.y;return h*h+y*y}function Y(n,r,h,y){var x=r.x,F=r.y,ne=h.x-x,_e=h.y-F,we=ne*ne+_e*_e,Ne;return we>0&&(Ne=((n.x-x)*ne+(n.y-F)*_e)/we,Ne>1?(x=h.x,F=h.y):Ne>0&&(x+=ne*Ne,F+=_e*Ne)),ne=n.x-x,_e=n.y-F,y?ne*ne+_e*_e:new ce(x,F)}function xe(n){return!S(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function Ze(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),xe(n)}function vt(n,r){var h,y,x,F,ne,_e,we,Ne;if(!n||n.length===0)throw new Error("latlngs not passed");xe(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var Xe=Qe([0,0]),ut=tt(n),yt=ut.getNorthWest().distanceTo(ut.getSouthWest())*ut.getNorthEast().distanceTo(ut.getNorthWest());yt<1700&&(Xe=is(n));var Dn=n.length,dn=[];for(h=0;h<Dn;h++){var Lo=Qe(n[h]);dn.push(r.project(Qe([Lo.lat-Xe.lat,Lo.lng-Xe.lng])))}for(h=0,y=0;h<Dn-1;h++)y+=dn[h].distanceTo(dn[h+1])/2;if(y===0)Ne=dn[0];else for(h=0,F=0;h<Dn-1;h++)if(ne=dn[h],_e=dn[h+1],x=ne.distanceTo(_e),F+=x,F>y){we=(F-y)/x,Ne=[_e.x-we*(_e.x-ne.x),_e.y-we*(_e.y-ne.y)];break}var Kn=r.unproject(ke(Ne));return Qe([Kn.lat+Xe.lat,Kn.lng+Xe.lng])}var Lt={__proto__:null,simplify:ra,pointToSegmentDistance:ca,closestPointOnSegment:Mi,clipSegment:Pi,_getEdgeIntersection:B,_getBitCode:R,_sqClosestPointOnSegment:Y,isFlat:xe,_flat:Ze,polylineCenter:vt},un={project:function(n){return new ce(n.lng,n.lat)},unproject:function(n){return new qe(n.y,n.x)},bounds:new re([-180,-90],[180,90])},ls={R:6378137,R_MINOR:6356752314245179e-9,bounds:new re([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var r=Math.PI/180,h=this.R,y=n.lat*r,x=this.R_MINOR/h,F=Math.sqrt(1-x*x),ne=F*Math.sin(y),_e=Math.tan(Math.PI/4-y/2)/Math.pow((1-ne)/(1+ne),F/2);return y=-h*Math.log(Math.max(_e,1e-10)),new ce(n.lng*r*h,y)},unproject:function(n){for(var r=180/Math.PI,h=this.R,y=this.R_MINOR/h,x=Math.sqrt(1-y*y),F=Math.exp(-n.y/h),ne=Math.PI/2-2*Math.atan(F),_e=0,we=.1,Ne;_e<15&&Math.abs(we)>1e-7;_e++)Ne=x*Math.sin(ne),Ne=Math.pow((1-Ne)/(1+Ne),x/2),we=Math.PI/2-2*Math.atan(F*Ne)-ne,ne+=we;return new qe(ne*r,n.x*r/h)}},Ft={__proto__:null,LonLat:un,Mercator:ls,SphericalMercator:Le},lo=s({},ze,{code:"EPSG:3395",projection:ls,transformation:(function(){var n=.5/(Math.PI*ls.R);return W(n,.5,-n,.5)})()}),jl=s({},ze,{code:"EPSG:4326",projection:un,transformation:W(1/180,1,-1/180,.5)}),rc=s({},be,{projection:un,transformation:W(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,r){var h=r.lng-n.lng,y=r.lat-n.lat;return Math.sqrt(h*h+y*y)},infinite:!0});be.Earth=ze,be.EPSG3395=lo,be.EPSG3857=J,be.EPSG900913=ue,be.EPSG4326=jl,be.Simple=rc;var Ln=Fe.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[d(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[d(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var r=n.target;if(r.hasLayer(this)){if(this._map=r,this._zoomAnimated=r._zoomAnimated,this.getEvents){var h=this.getEvents();r.on(h,this),this.once("remove",function(){r.off(h,this)},this)}this.onAdd(r),this.fire("add"),r.fire("layeradd",{layer:this})}}});ct.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var r=d(n);return this._layers[r]?this:(this._layers[r]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var r=d(n);return this._layers[r]?(this._loaded&&n.onRemove(this),delete this._layers[r],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return d(n)in this._layers},eachLayer:function(n,r){for(var h in this._layers)n.call(r,this._layers[h]);return this},_addLayers:function(n){n=n?S(n)?n:[n]:[];for(var r=0,h=n.length;r<h;r++)this.addLayer(n[r])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[d(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var r=d(n);this._zoomBoundLayers[r]&&(delete this._zoomBoundLayers[r],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,r=-1/0,h=this._getZoomSpan();for(var y in this._zoomBoundLayers){var x=this._zoomBoundLayers[y].options;n=x.minZoom===void 0?n:Math.min(n,x.minZoom),r=x.maxZoom===void 0?r:Math.max(r,x.maxZoom)}this._layersMaxZoom=r===-1/0?void 0:r,this._layersMinZoom=n===1/0?void 0:n,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ai=Ln.extend({initialize:function(n,r){C(this,r),this._layers={};var h,y;if(n)for(h=0,y=n.length;h<y;h++)this.addLayer(n[h])},addLayer:function(n){var r=this.getLayerId(n);return this._layers[r]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var r=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[r]&&this._map.removeLayer(this._layers[r]),delete this._layers[r],this},hasLayer:function(n){var r=typeof n=="number"?n:this.getLayerId(n);return r in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var r=Array.prototype.slice.call(arguments,1),h,y;for(h in this._layers)y=this._layers[h],y[n]&&y[n].apply(y,r);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,r){for(var h in this._layers)n.call(r,this._layers[h]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return d(n)}}),ua=function(n,r){return new ai(n,r)},Bo=ai.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),ai.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),ai.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new Je;for(var r in this._layers){var h=this._layers[r];n.extend(h.getBounds?h.getBounds():h.getLatLng())}return n}}),ql=function(n,r){return new Bo(n,r)},rs=Ee.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){C(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,r){var h=this._getIconUrl(n);if(!h){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var y=this._createImg(h,r&&r.tagName==="IMG"?r:null);return this._setIconStyles(y,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(y.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),y},_setIconStyles:function(n,r){var h=this.options,y=h[r+"Size"];typeof y=="number"&&(y=[y,y]);var x=ke(y),F=ke(r==="shadow"&&h.shadowAnchor||h.iconAnchor||x&&x.divideBy(2,!0));n.className="leaflet-marker-"+r+" "+(h.className||""),F&&(n.style.marginLeft=-F.x+"px",n.style.marginTop=-F.y+"px"),x&&(n.style.width=x.x+"px",n.style.height=x.y+"px")},_createImg:function(n,r){return r=r||document.createElement("img"),r.src=n,r},_getIconUrl:function(n){return et.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function Ya(n){return new rs(n)}var Di=rs.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof Di.imagePath!="string"&&(Di.imagePath=this._detectIconPath()),(this.options.imagePath||Di.imagePath)+rs.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var r=function(h,y,x){var F=y.exec(h);return F&&F[x]};return n=r(n,/^url\((['"])?(.+)\1\)$/,2),n&&r(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=mt("div","leaflet-default-icon-path",document.body),r=Pn(n,"background-image")||Pn(n,"backgroundImage");if(document.body.removeChild(n),r=this._stripUrl(r),r)return r;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),Wl=Wn.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new bo(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),dt(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&It(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var r=this._marker,h=r._map,y=this._marker.options.autoPanSpeed,x=this._marker.options.autoPanPadding,F=io(r._icon),ne=h.getPixelBounds(),_e=h.getPixelOrigin(),we=Re(ne.min._subtract(_e).add(x),ne.max._subtract(_e).subtract(x));if(!we.contains(F)){var Ne=ke((Math.max(we.max.x,F.x)-we.max.x)/(ne.max.x-we.max.x)-(Math.min(we.min.x,F.x)-we.min.x)/(ne.min.x-we.min.x),(Math.max(we.max.y,F.y)-we.max.y)/(ne.max.y-we.max.y)-(Math.min(we.min.y,F.y)-we.min.y)/(ne.min.y-we.min.y)).multiplyBy(y);h.panBy(Ne,{animate:!1}),this._draggable._newPos._add(Ne),this._draggable._startPos._add(Ne),Ht(r._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=V(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(Q(this._panRequest),this._panRequest=V(this._adjustPan.bind(this,n)))},_onDrag:function(n){var r=this._marker,h=r._shadow,y=io(r._icon),x=r._map.layerPointToLatLng(y);h&&Ht(h,y),r._latlng=x,n.latlng=x,n.oldLatLng=this._oldLatLng,r.fire("move",n).fire("drag",n)},_onDragEnd:function(n){Q(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),da=Ln.extend({options:{icon:new Di,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,r){C(this,r),this._latlng=Qe(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var r=this._latlng;return this._latlng=Qe(n),this.update(),this.fire("move",{oldLatLng:r,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,r="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=n.icon.createIcon(this._icon),y=!1;h!==this._icon&&(this._icon&&this._removeIcon(),y=!0,n.title&&(h.title=n.title),h.tagName==="IMG"&&(h.alt=n.alt||"")),dt(h,r),n.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&at(h,"focus",this._panOnFocus,this);var x=n.icon.createShadow(this._shadow),F=!1;x!==this._shadow&&(this._removeShadow(),F=!0),x&&(dt(x,r),x.alt=""),this._shadow=x,n.opacity<1&&this._updateOpacity(),y&&this.getPane().appendChild(this._icon),this._initInteraction(),x&&F&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&_t(this._icon,"focus",this._panOnFocus,this),xt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&xt(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&Ht(this._icon,n),this._shadow&&Ht(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var r=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(r)},_initInteraction:function(){if(this.options.interactive&&(dt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Wl)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Wl(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&on(this._icon,n),this._shadow&&on(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var r=this.options.icon.options,h=r.iconSize?ke(r.iconSize):ke(0,0),y=r.iconAnchor?ke(r.iconAnchor):ke(0,0);n.panInside(this._latlng,{paddingTopLeft:y,paddingBottomRight:h.subtract(y)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function cc(n,r){return new da(n,r)}var cs=Ln.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return C(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ha=cs.extend({options:{fill:!0,radius:10},initialize:function(n,r){C(this,r),this._latlng=Qe(n),this._radius=this.options.radius},setLatLng:function(n){var r=this._latlng;return this._latlng=Qe(n),this.redraw(),this.fire("move",{oldLatLng:r,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var r=n&&n.radius||this._radius;return cs.prototype.setStyle.call(this,n),this.setRadius(r),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,r=this._radiusY||n,h=this._clickTolerance(),y=[n+h,r+h];this._pxBounds=new re(this._point.subtract(y),this._point.add(y))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function uc(n,r){return new ha(n,r)}var Ja=ha.extend({initialize:function(n,r,h){if(typeof r=="number"&&(r=s({},h,{radius:r})),C(this,r),this._latlng=Qe(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new Je(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:cs.prototype.setStyle,_project:function(){var n=this._latlng.lng,r=this._latlng.lat,h=this._map,y=h.options.crs;if(y.distance===ze.distance){var x=Math.PI/180,F=this._mRadius/ze.R/x,ne=h.project([r+F,n]),_e=h.project([r-F,n]),we=ne.add(_e).divideBy(2),Ne=h.unproject(we).lat,Xe=Math.acos((Math.cos(F*x)-Math.sin(r*x)*Math.sin(Ne*x))/(Math.cos(r*x)*Math.cos(Ne*x)))/x;(isNaN(Xe)||Xe===0)&&(Xe=F/Math.cos(Math.PI/180*r)),this._point=we.subtract(h.getPixelOrigin()),this._radius=isNaN(Xe)?0:we.x-h.project([Ne,n-Xe]).x,this._radiusY=we.y-ne.y}else{var ut=y.unproject(y.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(ut).x}this._updateBounds()}});function dc(n,r,h){return new Ja(n,r,h)}var wo=cs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,r){C(this,r),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var r=1/0,h=null,y=Y,x,F,ne=0,_e=this._parts.length;ne<_e;ne++)for(var we=this._parts[ne],Ne=1,Xe=we.length;Ne<Xe;Ne++){x=we[Ne-1],F=we[Ne];var ut=y(n,x,F,!0);ut<r&&(r=ut,h=y(n,x,F))}return h&&(h.distance=Math.sqrt(r)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return vt(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,r){return r=r||this._defaultShape(),n=Qe(n),r.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new Je,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return xe(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var r=[],h=xe(n),y=0,x=n.length;y<x;y++)h?(r[y]=Qe(n[y]),this._bounds.extend(r[y])):r[y]=this._convertLatLngs(n[y]);return r},_project:function(){var n=new re;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),r=new ce(n,n);this._rawPxBounds&&(this._pxBounds=new re([this._rawPxBounds.min.subtract(r),this._rawPxBounds.max.add(r)]))},_projectLatlngs:function(n,r,h){var y=n[0]instanceof qe,x=n.length,F,ne;if(y){for(ne=[],F=0;F<x;F++)ne[F]=this._map.latLngToLayerPoint(n[F]),h.extend(ne[F]);r.push(ne)}else for(F=0;F<x;F++)this._projectLatlngs(n[F],r,h)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var r=this._parts,h,y,x,F,ne,_e,we;for(h=0,x=0,F=this._rings.length;h<F;h++)for(we=this._rings[h],y=0,ne=we.length;y<ne-1;y++)_e=Pi(we[y],we[y+1],n,y,!0),_e&&(r[x]=r[x]||[],r[x].push(_e[0]),(_e[1]!==we[y+1]||y===ne-2)&&(r[x].push(_e[1]),x++))}},_simplifyPoints:function(){for(var n=this._parts,r=this.options.smoothFactor,h=0,y=n.length;h<y;h++)n[h]=ra(n[h],r)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,r){var h,y,x,F,ne,_e,we=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(h=0,F=this._parts.length;h<F;h++)for(_e=this._parts[h],y=0,ne=_e.length,x=ne-1;y<ne;x=y++)if(!(!r&&y===0)&&ca(n,_e[x],_e[y])<=we)return!0;return!1}});function hc(n,r){return new wo(n,r)}wo._flat=Ze;var xs=wo.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ro(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var r=wo.prototype._convertLatLngs.call(this,n),h=r.length;return h>=2&&r[0]instanceof qe&&r[0].equals(r[h-1])&&r.pop(),r},_setLatLngs:function(n){wo.prototype._setLatLngs.call(this,n),xe(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return xe(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,r=this.options.weight,h=new ce(r,r);if(n=new re(n.min.subtract(h),n.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var y=0,x=this._rings.length,F;y<x;y++)F=Ti(this._rings[y],n,!0),F.length&&this._parts.push(F)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var r=!1,h,y,x,F,ne,_e,we,Ne;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(F=0,we=this._parts.length;F<we;F++)for(h=this._parts[F],ne=0,Ne=h.length,_e=Ne-1;ne<Ne;_e=ne++)y=h[ne],x=h[_e],y.y>n.y!=x.y>n.y&&n.x<(x.x-y.x)*(n.y-y.y)/(x.y-y.y)+y.x&&(r=!r);return r||wo.prototype._containsPoint.call(this,n,!0)}});function fc(n,r){return new xs(n,r)}var No=Bo.extend({initialize:function(n,r){C(this,r),this._layers={},n&&this.addData(n)},addData:function(n){var r=S(n)?n:n.features,h,y,x;if(r){for(h=0,y=r.length;h<y;h++)x=r[h],(x.geometries||x.geometry||x.features||x.coordinates)&&this.addData(x);return this}var F=this.options;if(F.filter&&!F.filter(n))return this;var ne=fa(n,F);return ne?(ne.feature=ma(n),ne.defaultOptions=ne.options,this.resetStyle(ne),F.onEachFeature&&F.onEachFeature(n,ne),this.addLayer(ne)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=s({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(r){this._setLayerStyle(r,n)},this)},_setLayerStyle:function(n,r){n.setStyle&&(typeof r=="function"&&(r=r(n.feature)),n.setStyle(r))}});function fa(n,r){var h=n.type==="Feature"?n.geometry:n,y=h?h.coordinates:null,x=[],F=r&&r.pointToLayer,ne=r&&r.coordsToLatLng||Xa,_e,we,Ne,Xe;if(!y&&!h)return null;switch(h.type){case"Point":return _e=ne(y),pa(F,n,_e,r);case"MultiPoint":for(Ne=0,Xe=y.length;Ne<Xe;Ne++)_e=ne(y[Ne]),x.push(pa(F,n,_e,r));return new Bo(x);case"LineString":case"MultiLineString":return we=va(y,h.type==="LineString"?0:1,ne),new wo(we,r);case"Polygon":case"MultiPolygon":return we=va(y,h.type==="Polygon"?1:2,ne),new xs(we,r);case"GeometryCollection":for(Ne=0,Xe=h.geometries.length;Ne<Xe;Ne++){var ut=fa({geometry:h.geometries[Ne],type:"Feature",properties:n.properties},r);ut&&x.push(ut)}return new Bo(x);case"FeatureCollection":for(Ne=0,Xe=h.features.length;Ne<Xe;Ne++){var yt=fa(h.features[Ne],r);yt&&x.push(yt)}return new Bo(x);default:throw new Error("Invalid GeoJSON object.")}}function pa(n,r,h,y){return n?n(r,h):new da(h,y&&y.markersInheritOptions&&y)}function Xa(n){return new qe(n[1],n[0],n[2])}function va(n,r,h){for(var y=[],x=0,F=n.length,ne;x<F;x++)ne=r?va(n[x],r-1,h):(h||Xa)(n[x]),y.push(ne);return y}function Qa(n,r){return n=Qe(n),n.alt!==void 0?[k(n.lng,r),k(n.lat,r),k(n.alt,r)]:[k(n.lng,r),k(n.lat,r)]}function Oi(n,r,h,y){for(var x=[],F=0,ne=n.length;F<ne;F++)x.push(r?Oi(n[F],xe(n[F])?0:r-1,h,y):Qa(n[F],y));return!r&&h&&x.length>0&&x.push(x[0].slice()),x}function li(n,r){return n.feature?s({},n.feature,{geometry:r}):ma(r)}function ma(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var Is={toGeoJSON:function(n){return li(this,{type:"Point",coordinates:Qa(this.getLatLng(),n)})}};da.include(Is),Ja.include(Is),ha.include(Is),wo.include({toGeoJSON:function(n){var r=!xe(this._latlngs),h=Oi(this._latlngs,r?1:0,!1,n);return li(this,{type:(r?"Multi":"")+"LineString",coordinates:h})}}),xs.include({toGeoJSON:function(n){var r=!xe(this._latlngs),h=r&&!xe(this._latlngs[0]),y=Oi(this._latlngs,h?2:r?1:0,!0,n);return r||(y=[y]),li(this,{type:(h?"Multi":"")+"Polygon",coordinates:y})}}),ai.include({toMultiPoint:function(n){var r=[];return this.eachLayer(function(h){r.push(h.toGeoJSON(n).geometry.coordinates)}),li(this,{type:"MultiPoint",coordinates:r})},toGeoJSON:function(n){var r=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(r==="MultiPoint")return this.toMultiPoint(n);var h=r==="GeometryCollection",y=[];return this.eachLayer(function(x){if(x.toGeoJSON){var F=x.toGeoJSON(n);if(h)y.push(F.geometry);else{var ne=ma(F);ne.type==="FeatureCollection"?y.push.apply(y,ne.features):y.push(ne)}}}),h?li(this,{geometries:y,type:"GeometryCollection"}):{type:"FeatureCollection",features:y}}});function el(n,r){return new No(n,r)}var Kl=el,Ri=Ln.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,r,h){this._url=n,this._bounds=tt(r),C(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(dt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){xt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&es(this._image),this},bringToBack:function(){return this._map&&ts(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=tt(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",r=this._image=n?this._url:mt("img");if(dt(r,"leaflet-image-layer"),this._zoomAnimated&&dt(r,"leaflet-zoom-animated"),this.options.className&&dt(r,this.options.className),r.onselectstart=g,r.onmousemove=g,r.onload=c(this.fire,this,"load"),r.onerror=c(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(r.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=r.src;return}r.src=this._url,r.alt=this.options.alt},_animateZoom:function(n){var r=this._map.getZoomScale(n.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;go(this._image,h,r)},_reset:function(){var n=this._image,r=new re(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=r.getSize();Ht(n,r.min),n.style.width=h.x+"px",n.style.height=h.y+"px"},_updateOpacity:function(){on(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),z=function(n,r,h){return new Ri(n,r,h)},le=Ri.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",r=this._image=n?this._url:mt("video");if(dt(r,"leaflet-image-layer"),this._zoomAnimated&&dt(r,"leaflet-zoom-animated"),this.options.className&&dt(r,this.options.className),r.onselectstart=g,r.onmousemove=g,r.onloadeddata=c(this.fire,this,"load"),n){for(var h=r.getElementsByTagName("source"),y=[],x=0;x<h.length;x++)y.push(h[x].src);this._url=h.length>0?y:[r.src];return}S(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(r.style,"objectFit")&&(r.style.objectFit="fill"),r.autoplay=!!this.options.autoplay,r.loop=!!this.options.loop,r.muted=!!this.options.muted,r.playsInline=!!this.options.playsInline;for(var F=0;F<this._url.length;F++){var ne=mt("source");ne.src=this._url[F],r.appendChild(ne)}}});function me(n,r,h){return new le(n,r,h)}var Ie=Ri.extend({_initImage:function(){var n=this._image=this._url;dt(n,"leaflet-image-layer"),this._zoomAnimated&&dt(n,"leaflet-zoom-animated"),this.options.className&&dt(n,this.options.className),n.onselectstart=g,n.onmousemove=g}});function lt(n,r,h){return new Ie(n,r,h)}var kt=Ln.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,r){n&&(n instanceof qe||S(n))?(this._latlng=Qe(n),C(this,r)):(C(this,n),this._source=r),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&on(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&on(this._container,1),this.bringToFront(),this.options.interactive&&(dt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(on(this._container,0),this._removeTimeout=setTimeout(c(xt,void 0,this._container),200)):xt(this._container),this.options.interactive&&(It(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=Qe(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&es(this._container),this},bringToBack:function(){return this._map&&ts(this._container),this},_prepareOpen:function(n){var r=this._source;if(!r._map)return!1;if(r instanceof Bo){r=null;var h=this._source._layers;for(var y in h)if(h[y]._map){r=h[y];break}if(!r)return!1;this._source=r}if(!n)if(r.getCenter)n=r.getCenter();else if(r.getLatLng)n=r.getLatLng();else if(r.getBounds)n=r.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,r=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof r=="string")n.innerHTML=r;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(r)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),r=ke(this.options.offset),h=this._getAnchor();this._zoomAnimated?Ht(this._container,n.add(h)):r=r.add(n).add(h);var y=this._containerBottom=-r.y,x=this._containerLeft=-Math.round(this._containerWidth/2)+r.x;this._container.style.bottom=y+"px",this._container.style.left=x+"px"}},_getAnchor:function(){return[0,0]}});ct.include({_initOverlay:function(n,r,h,y){var x=r;return x instanceof n||(x=new n(y).setContent(r)),h&&x.setLatLng(h),x}}),Ln.include({_initOverlay:function(n,r,h,y){var x=h;return x instanceof n?(C(x,y),x._source=this):(x=r&&!y?r:new n(y,this),x.setContent(h)),x}});var Qt=kt.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,kt.prototype.openOn.call(this,n)},onAdd:function(n){kt.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof cs||this._source.on("preclick",_o))},onRemove:function(n){kt.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof cs||this._source.off("preclick",_o))},getEvents:function(){var n=kt.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",r=this._container=mt("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=mt("div",n+"-content-wrapper",r);if(this._contentNode=mt("div",n+"-content",h),ko(r),Ls(this._contentNode),at(r,"contextmenu",_o),this._tipContainer=mt("div",n+"-tip-container",r),this._tip=mt("div",n+"-tip",this._tipContainer),this.options.closeButton){var y=this._closeButton=mt("a",n+"-close-button",r);y.setAttribute("role","button"),y.setAttribute("aria-label","Close popup"),y.href="#close",y.innerHTML='<span aria-hidden="true">&#215;</span>',at(y,"click",function(x){Xt(x),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,r=n.style;r.width="",r.whiteSpace="nowrap";var h=n.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),r.width=h+1+"px",r.whiteSpace="",r.height="";var y=n.offsetHeight,x=this.options.maxHeight,F="leaflet-popup-scrolled";x&&y>x?(r.height=x+"px",dt(n,F)):It(n,F),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var r=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),h=this._getAnchor();Ht(this._container,r.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,r=parseInt(Pn(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+r,y=this._containerWidth,x=new ce(this._containerLeft,-h-this._containerBottom);x._add(io(this._container));var F=n.layerPointToContainerPoint(x),ne=ke(this.options.autoPanPadding),_e=ke(this.options.autoPanPaddingTopLeft||ne),we=ke(this.options.autoPanPaddingBottomRight||ne),Ne=n.getSize(),Xe=0,ut=0;F.x+y+we.x>Ne.x&&(Xe=F.x+y-Ne.x+we.x),F.x-Xe-_e.x<0&&(Xe=F.x-_e.x),F.y+h+we.y>Ne.y&&(ut=F.y+h-Ne.y+we.y),F.y-ut-_e.y<0&&(ut=F.y-_e.y),(Xe||ut)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([Xe,ut]))}},_getAnchor:function(){return ke(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Co=function(n,r){return new Qt(n,r)};ct.mergeOptions({closePopupOnClick:!0}),ct.include({openPopup:function(n,r,h){return this._initOverlay(Qt,n,r,h).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),Ln.include({bindPopup:function(n,r){return this._popup=this._initOverlay(Qt,this._popup,n,r),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof Bo||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){ao(n);var r=n.layer||n.target;if(this._popup._source===r&&!(r instanceof cs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=r,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var Yl=kt.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){kt.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){kt.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=kt.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",r=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=mt("div",r),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var r,h,y=this._map,x=this._container,F=y.latLngToContainerPoint(y.getCenter()),ne=y.layerPointToContainerPoint(n),_e=this.options.direction,we=x.offsetWidth,Ne=x.offsetHeight,Xe=ke(this.options.offset),ut=this._getAnchor();_e==="top"?(r=we/2,h=Ne):_e==="bottom"?(r=we/2,h=0):_e==="center"?(r=we/2,h=Ne/2):_e==="right"?(r=0,h=Ne/2):_e==="left"?(r=we,h=Ne/2):ne.x<F.x?(_e="right",r=0,h=Ne/2):(_e="left",r=we+(Xe.x+ut.x)*2,h=Ne/2),n=n.subtract(ke(r,h,!0)).add(Xe).add(ut),It(x,"leaflet-tooltip-right"),It(x,"leaflet-tooltip-left"),It(x,"leaflet-tooltip-top"),It(x,"leaflet-tooltip-bottom"),dt(x,"leaflet-tooltip-"+_e),Ht(x,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&on(this._container,n)},_animateZoom:function(n){var r=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(r)},_getAnchor:function(){return ke(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Av=function(n,r){return new Yl(n,r)};ct.include({openTooltip:function(n,r,h){return this._initOverlay(Yl,n,r,h).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),Ln.include({bindTooltip:function(n,r){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Yl,this._tooltip,n,r),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var r=n?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[r](h),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof Bo||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var r=typeof n.getElement=="function"&&n.getElement();r&&(at(r,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),at(r,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var r=typeof n.getElement=="function"&&n.getElement();r&&r.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var r=this;this._map.once("moveend",function(){r._openOnceFlag=!1,r._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var r=n.latlng,h,y;this._tooltip.options.sticky&&n.originalEvent&&(h=this._map.mouseEventToContainerPoint(n.originalEvent),y=this._map.containerPointToLayerPoint(h),r=this._map.layerPointToLatLng(y)),this._tooltip.setLatLng(r)}});var Ku=rs.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var r=n&&n.tagName==="DIV"?n:document.createElement("div"),h=this.options;if(h.html instanceof Element?(_s(r),r.appendChild(h.html)):r.innerHTML=h.html!==!1?h.html:"",h.bgPos){var y=ke(h.bgPos);r.style.backgroundPosition=-y.x+"px "+-y.y+"px"}return this._setIconStyles(r,"icon"),r},createShadow:function(){return null}});function Ev(n){return new Ku(n)}rs.Default=Di;var tl=Ln.extend({options:{tileSize:256,opacity:1,updateWhenIdle:et.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){C(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),xt(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(es(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ts(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof ce?n:new ce(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var r=this.getPane().children,h=-n(-1/0,1/0),y=0,x=r.length,F;y<x;y++)F=r[y].style.zIndex,r[y]!==this._container&&F&&(h=n(h,+F));isFinite(h)&&(this.options.zIndex=h+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!et.ielt9){on(this._container,this.options.opacity);var n=+new Date,r=!1,h=!1;for(var y in this._tiles){var x=this._tiles[y];if(!(!x.current||!x.loaded)){var F=Math.min(1,(n-x.loaded)/200);on(x.el,F),F<1?r=!0:(x.active?h=!0:this._onOpaqueTile(x),x.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),r&&(Q(this._fadeFrame),this._fadeFrame=V(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=mt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,r=this.options.maxZoom;if(n!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===n?(this._levels[h].el.style.zIndex=r-Math.abs(n-h),this._onUpdateLevel(h)):(xt(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var y=this._levels[n],x=this._map;return y||(y=this._levels[n]={},y.el=mt("div","leaflet-tile-container leaflet-zoom-animated",this._container),y.el.style.zIndex=r,y.origin=x.project(x.unproject(x.getPixelOrigin()),n).round(),y.zoom=n,this._setZoomTransform(y,x.getCenter(),x.getZoom()),g(y.el.offsetWidth),this._onCreateLevel(y)),this._level=y,y}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var n,r,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)r=this._tiles[n],r.retain=r.current;for(n in this._tiles)if(r=this._tiles[n],r.current&&!r.active){var y=r.coords;this._retainParent(y.x,y.y,y.z,y.z-5)||this._retainChildren(y.x,y.y,y.z,y.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var r in this._tiles)this._tiles[r].coords.z===n&&this._removeTile(r)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)xt(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,r,h,y){var x=Math.floor(n/2),F=Math.floor(r/2),ne=h-1,_e=new ce(+x,+F);_e.z=+ne;var we=this._tileCoordsToKey(_e),Ne=this._tiles[we];return Ne&&Ne.active?(Ne.retain=!0,!0):(Ne&&Ne.loaded&&(Ne.retain=!0),ne>y?this._retainParent(x,F,ne,y):!1)},_retainChildren:function(n,r,h,y){for(var x=2*n;x<2*n+2;x++)for(var F=2*r;F<2*r+2;F++){var ne=new ce(x,F);ne.z=h+1;var _e=this._tileCoordsToKey(ne),we=this._tiles[_e];if(we&&we.active){we.retain=!0;continue}else we&&we.loaded&&(we.retain=!0);h+1<y&&this._retainChildren(x,F,h+1,y)}},_resetView:function(n){var r=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),r,r)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var r=this.options;return r.minNativeZoom!==void 0&&n<r.minNativeZoom?r.minNativeZoom:r.maxNativeZoom!==void 0&&r.maxNativeZoom<n?r.maxNativeZoom:n},_setView:function(n,r,h,y){var x=Math.round(r);this.options.maxZoom!==void 0&&x>this.options.maxZoom||this.options.minZoom!==void 0&&x<this.options.minZoom?x=void 0:x=this._clampZoom(x);var F=this.options.updateWhenZooming&&x!==this._tileZoom;(!y||F)&&(this._tileZoom=x,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),x!==void 0&&this._update(n),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(n,r)},_setZoomTransforms:function(n,r){for(var h in this._levels)this._setZoomTransform(this._levels[h],n,r)},_setZoomTransform:function(n,r,h){var y=this._map.getZoomScale(h,n.zoom),x=n.origin.multiplyBy(y).subtract(this._map._getNewPixelOrigin(r,h)).round();et.any3d?go(n.el,x,y):Ht(n.el,x)},_resetGrid:function(){var n=this._map,r=n.options.crs,h=this._tileSize=this.getTileSize(),y=this._tileZoom,x=this._map.getPixelWorldBounds(this._tileZoom);x&&(this._globalTileRange=this._pxBoundsToTileRange(x)),this._wrapX=r.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,r.wrapLng[0]],y).x/h.x),Math.ceil(n.project([0,r.wrapLng[1]],y).x/h.y)],this._wrapY=r.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([r.wrapLat[0],0],y).y/h.x),Math.ceil(n.project([r.wrapLat[1],0],y).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var r=this._map,h=r._animatingZoom?Math.max(r._animateToZoom,r.getZoom()):r.getZoom(),y=r.getZoomScale(h,this._tileZoom),x=r.project(n,this._tileZoom).floor(),F=r.getSize().divideBy(y*2);return new re(x.subtract(F),x.add(F))},_update:function(n){var r=this._map;if(r){var h=this._clampZoom(r.getZoom());if(n===void 0&&(n=r.getCenter()),this._tileZoom!==void 0){var y=this._getTiledPixelBounds(n),x=this._pxBoundsToTileRange(y),F=x.getCenter(),ne=[],_e=this.options.keepBuffer,we=new re(x.getBottomLeft().subtract([_e,-_e]),x.getTopRight().add([_e,-_e]));if(!(isFinite(x.min.x)&&isFinite(x.min.y)&&isFinite(x.max.x)&&isFinite(x.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ne in this._tiles){var Xe=this._tiles[Ne].coords;(Xe.z!==this._tileZoom||!we.contains(new ce(Xe.x,Xe.y)))&&(this._tiles[Ne].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(n,h);return}for(var ut=x.min.y;ut<=x.max.y;ut++)for(var yt=x.min.x;yt<=x.max.x;yt++){var Dn=new ce(yt,ut);if(Dn.z=this._tileZoom,!!this._isValidTile(Dn)){var dn=this._tiles[this._tileCoordsToKey(Dn)];dn?dn.current=!0:ne.push(Dn)}}if(ne.sort(function(Kn,ya){return Kn.distanceTo(F)-ya.distanceTo(F)}),ne.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Lo=document.createDocumentFragment();for(yt=0;yt<ne.length;yt++)this._addTile(ne[yt],Lo);this._level.el.appendChild(Lo)}}}},_isValidTile:function(n){var r=this._map.options.crs;if(!r.infinite){var h=this._globalTileRange;if(!r.wrapLng&&(n.x<h.min.x||n.x>h.max.x)||!r.wrapLat&&(n.y<h.min.y||n.y>h.max.y))return!1}if(!this.options.bounds)return!0;var y=this._tileCoordsToBounds(n);return tt(this.options.bounds).overlaps(y)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var r=this._map,h=this.getTileSize(),y=n.scaleBy(h),x=y.add(h),F=r.unproject(y,n.z),ne=r.unproject(x,n.z);return[F,ne]},_tileCoordsToBounds:function(n){var r=this._tileCoordsToNwSe(n),h=new Je(r[0],r[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var r=n.split(":"),h=new ce(+r[0],+r[1]);return h.z=+r[2],h},_removeTile:function(n){var r=this._tiles[n];r&&(xt(r.el),delete this._tiles[n],this.fire("tileunload",{tile:r.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){dt(n,"leaflet-tile");var r=this.getTileSize();n.style.width=r.x+"px",n.style.height=r.y+"px",n.onselectstart=g,n.onmousemove=g,et.ielt9&&this.options.opacity<1&&on(n,this.options.opacity)},_addTile:function(n,r){var h=this._getTilePos(n),y=this._tileCoordsToKey(n),x=this.createTile(this._wrapCoords(n),c(this._tileReady,this,n));this._initTile(x),this.createTile.length<2&&V(c(this._tileReady,this,n,null,x)),Ht(x,h),this._tiles[y]={el:x,coords:n,current:!0},r.appendChild(x),this.fire("tileloadstart",{tile:x,coords:n})},_tileReady:function(n,r,h){r&&this.fire("tileerror",{error:r,tile:h,coords:n});var y=this._tileCoordsToKey(n);h=this._tiles[y],h&&(h.loaded=+new Date,this._map._fadeAnimated?(on(h.el,0),Q(this._fadeFrame),this._fadeFrame=V(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),r||(dt(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),et.ielt9||!this._map._fadeAnimated?V(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var r=new ce(this._wrapX?p(n.x,this._wrapX):n.x,this._wrapY?p(n.y,this._wrapY):n.y);return r.z=n.z,r},_pxBoundsToTileRange:function(n){var r=this.getTileSize();return new re(n.min.unscaleBy(r).floor(),n.max.unscaleBy(r).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function Pv(n){return new tl(n)}var ga=tl.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,r){this._url=n,r=C(this,r),r.detectRetina&&et.retina&&r.maxZoom>0?(r.tileSize=Math.floor(r.tileSize/2),r.zoomReverse?(r.zoomOffset--,r.minZoom=Math.min(r.maxZoom,r.minZoom+1)):(r.zoomOffset++,r.maxZoom=Math.max(r.minZoom,r.maxZoom-1)),r.minZoom=Math.max(0,r.minZoom)):r.zoomReverse?r.minZoom=Math.min(r.maxZoom,r.minZoom):r.maxZoom=Math.max(r.minZoom,r.maxZoom),typeof r.subdomains=="string"&&(r.subdomains=r.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,r){return this._url===n&&r===void 0&&(r=!0),this._url=n,r||this.redraw(),this},createTile:function(n,r){var h=document.createElement("img");return at(h,"load",c(this._tileOnLoad,this,r,h)),at(h,"error",c(this._tileOnError,this,r,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(n),h},getTileUrl:function(n){var r={r:et.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-n.y;this.options.tms&&(r.y=h),r["-y"]=h}return M(this._url,s(r,this.options))},_tileOnLoad:function(n,r){et.ielt9?setTimeout(c(n,this,null,r),0):n(null,r)},_tileOnError:function(n,r,h){var y=this.options.errorTileUrl;y&&r.getAttribute("src")!==y&&(r.src=y),n(h,r)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,r=this.options.maxZoom,h=this.options.zoomReverse,y=this.options.zoomOffset;return h&&(n=r-n),n+y},_getSubdomain:function(n){var r=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[r]},_abortLoading:function(){var n,r;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(r=this._tiles[n].el,r.onload=g,r.onerror=g,!r.complete)){r.src=A;var h=this._tiles[n].coords;xt(r),delete this._tiles[n],this.fire("tileabort",{tile:r,coords:h})}},_removeTile:function(n){var r=this._tiles[n];if(r)return r.el.setAttribute("src",A),tl.prototype._removeTile.call(this,n)},_tileReady:function(n,r,h){if(!(!this._map||h&&h.getAttribute("src")===A))return tl.prototype._tileReady.call(this,n,r,h)}});function Yu(n,r){return new ga(n,r)}var Ju=ga.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,r){this._url=n;var h=s({},this.defaultWmsParams);for(var y in r)y in this.options||(h[y]=r[y]);r=C(this,r);var x=r.detectRetina&&et.retina?2:1,F=this.getTileSize();h.width=F.x*x,h.height=F.y*x,this.wmsParams=h},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var r=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[r]=this._crs.code,ga.prototype.onAdd.call(this,n)},getTileUrl:function(n){var r=this._tileCoordsToNwSe(n),h=this._crs,y=Re(h.project(r[0]),h.project(r[1])),x=y.min,F=y.max,ne=(this._wmsVersion>=1.3&&this._crs===jl?[x.y,x.x,F.y,F.x]:[x.x,x.y,F.x,F.y]).join(","),_e=ga.prototype.getTileUrl.call(this,n);return _e+E(this.wmsParams,_e,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ne},setParams:function(n,r){return s(this.wmsParams,n),r||this.redraw(),this}});function Dv(n,r){return new Ju(n,r)}ga.WMS=Ju,Yu.wms=Dv;var $s=Ln.extend({options:{padding:.1},initialize:function(n){C(this,n),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),dt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,r){var h=this._map.getZoomScale(r,this._zoom),y=this._map.getSize().multiplyBy(.5+this.options.padding),x=this._map.project(this._center,r),F=y.multiplyBy(-h).add(x).subtract(this._map._getNewPixelOrigin(n,r));et.any3d?go(this._container,F,h):Ht(this._container,F)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,r=this._map.getSize(),h=this._map.containerPointToLayerPoint(r.multiplyBy(-n)).round();this._bounds=new re(h,h.add(r.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Xu=$s.extend({options:{tolerance:0},getEvents:function(){var n=$s.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){$s.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");at(n,"mousemove",this._onMouseMove,this),at(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),at(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){Q(this._redrawRequest),delete this._ctx,xt(this._container),_t(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var r in this._layers)n=this._layers[r],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){$s.prototype._update.call(this);var n=this._bounds,r=this._container,h=n.getSize(),y=et.retina?2:1;Ht(r,n.min),r.width=y*h.x,r.height=y*h.y,r.style.width=h.x+"px",r.style.height=h.y+"px",et.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){$s.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[d(n)]=n;var r=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=r),this._drawLast=r,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var r=n._order,h=r.next,y=r.prev;h?h.prev=y:this._drawLast=y,y?y.next=h:this._drawFirst=h,delete n._order,delete this._layers[d(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var r=n.options.dashArray.split(/[, ]+/),h=[],y,x;for(x=0;x<r.length;x++){if(y=Number(r[x]),isNaN(y))return;h.push(y)}n.options._dashArray=h}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||V(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var r=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new re,this._redrawBounds.extend(n._pxBounds.min.subtract([r,r])),this._redrawBounds.extend(n._pxBounds.max.add([r,r]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var r=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,r.x,r.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,r=this._redrawBounds;if(this._ctx.save(),r){var h=r.getSize();this._ctx.beginPath(),this._ctx.rect(r.min.x,r.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var y=this._drawFirst;y;y=y.next)n=y.layer,(!r||n._pxBounds&&n._pxBounds.intersects(r))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,r){if(this._drawing){var h,y,x,F,ne=n._parts,_e=ne.length,we=this._ctx;if(_e){for(we.beginPath(),h=0;h<_e;h++){for(y=0,x=ne[h].length;y<x;y++)F=ne[h][y],we[y?"lineTo":"moveTo"](F.x,F.y);r&&we.closePath()}this._fillStroke(we,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var r=n._point,h=this._ctx,y=Math.max(Math.round(n._radius),1),x=(Math.max(Math.round(n._radiusY),1)||y)/y;x!==1&&(h.save(),h.scale(1,x)),h.beginPath(),h.arc(r.x,r.y/x,y,0,Math.PI*2,!1),x!==1&&h.restore(),this._fillStroke(h,n)}},_fillStroke:function(n,r){var h=r.options;h.fill&&(n.globalAlpha=h.fillOpacity,n.fillStyle=h.fillColor||h.color,n.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(n.setLineDash&&n.setLineDash(r.options&&r.options._dashArray||[]),n.globalAlpha=h.opacity,n.lineWidth=h.weight,n.strokeStyle=h.color,n.lineCap=h.lineCap,n.lineJoin=h.lineJoin,n.stroke())},_onClick:function(n){for(var r=this._map.mouseEventToLayerPoint(n),h,y,x=this._drawFirst;x;x=x.next)h=x.layer,h.options.interactive&&h._containsPoint(r)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(h))&&(y=h);this._fireEvent(y?[y]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var r=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,r)}},_handleMouseOut:function(n){var r=this._hoveredLayer;r&&(It(this._container,"leaflet-interactive"),this._fireEvent([r],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,r){if(!this._mouseHoverThrottled){for(var h,y,x=this._drawFirst;x;x=x.next)h=x.layer,h.options.interactive&&h._containsPoint(r)&&(y=h);y!==this._hoveredLayer&&(this._handleMouseOut(n),y&&(dt(this._container,"leaflet-interactive"),this._fireEvent([y],n,"mouseover"),this._hoveredLayer=y)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(c(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,r,h){this._map._fireDOMEvent(r,h||r.type,n)},_bringToFront:function(n){var r=n._order;if(r){var h=r.next,y=r.prev;if(h)h.prev=y;else return;y?y.next=h:h&&(this._drawFirst=h),r.prev=this._drawLast,this._drawLast.next=r,r.next=null,this._drawLast=r,this._requestRedraw(n)}},_bringToBack:function(n){var r=n._order;if(r){var h=r.next,y=r.prev;if(y)y.next=h;else return;h?h.prev=y:y&&(this._drawLast=y),r.prev=null,r.next=this._drawFirst,this._drawFirst.prev=r,this._drawFirst=r,this._requestRedraw(n)}}});function Qu(n){return et.canvas?new Xu(n):null}var nl=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Ov={_initContainer:function(){this._container=mt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||($s.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var r=n._container=nl("shape");dt(r,"leaflet-vml-shape "+(this.options.className||"")),r.coordsize="1 1",n._path=nl("path"),r.appendChild(n._path),this._updateStyle(n),this._layers[d(n)]=n},_addPath:function(n){var r=n._container;this._container.appendChild(r),n.options.interactive&&n.addInteractiveTarget(r)},_removePath:function(n){var r=n._container;xt(r),n.removeInteractiveTarget(r),delete this._layers[d(n)]},_updateStyle:function(n){var r=n._stroke,h=n._fill,y=n.options,x=n._container;x.stroked=!!y.stroke,x.filled=!!y.fill,y.stroke?(r||(r=n._stroke=nl("stroke")),x.appendChild(r),r.weight=y.weight+"px",r.color=y.color,r.opacity=y.opacity,y.dashArray?r.dashStyle=S(y.dashArray)?y.dashArray.join(" "):y.dashArray.replace(/( *, *)/g," "):r.dashStyle="",r.endcap=y.lineCap.replace("butt","flat"),r.joinstyle=y.lineJoin):r&&(x.removeChild(r),n._stroke=null),y.fill?(h||(h=n._fill=nl("fill")),x.appendChild(h),h.color=y.fillColor||y.color,h.opacity=y.fillOpacity):h&&(x.removeChild(h),n._fill=null)},_updateCircle:function(n){var r=n._point.round(),h=Math.round(n._radius),y=Math.round(n._radiusY||h);this._setPath(n,n._empty()?"M0 0":"AL "+r.x+","+r.y+" "+h+","+y+" 0,"+65535*360)},_setPath:function(n,r){n._path.v=r},_bringToFront:function(n){es(n._container)},_bringToBack:function(n){ts(n._container)}},Jl=et.vml?nl:ye,ol=$s.extend({_initContainer:function(){this._container=Jl("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Jl("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){xt(this._container),_t(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){$s.prototype._update.call(this);var n=this._bounds,r=n.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(r))&&(this._svgSize=r,h.setAttribute("width",r.x),h.setAttribute("height",r.y)),Ht(h,n.min),h.setAttribute("viewBox",[n.min.x,n.min.y,r.x,r.y].join(" ")),this.fire("update")}},_initPath:function(n){var r=n._path=Jl("path");n.options.className&&dt(r,n.options.className),n.options.interactive&&dt(r,"leaflet-interactive"),this._updateStyle(n),this._layers[d(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){xt(n._path),n.removeInteractiveTarget(n._path),delete this._layers[d(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var r=n._path,h=n.options;r&&(h.stroke?(r.setAttribute("stroke",h.color),r.setAttribute("stroke-opacity",h.opacity),r.setAttribute("stroke-width",h.weight),r.setAttribute("stroke-linecap",h.lineCap),r.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?r.setAttribute("stroke-dasharray",h.dashArray):r.removeAttribute("stroke-dasharray"),h.dashOffset?r.setAttribute("stroke-dashoffset",h.dashOffset):r.removeAttribute("stroke-dashoffset")):r.setAttribute("stroke","none"),h.fill?(r.setAttribute("fill",h.fillColor||h.color),r.setAttribute("fill-opacity",h.fillOpacity),r.setAttribute("fill-rule",h.fillRule||"evenodd")):r.setAttribute("fill","none"))},_updatePoly:function(n,r){this._setPath(n,ae(n._parts,r))},_updateCircle:function(n){var r=n._point,h=Math.max(Math.round(n._radius),1),y=Math.max(Math.round(n._radiusY),1)||h,x="a"+h+","+y+" 0 1,0 ",F=n._empty()?"M0 0":"M"+(r.x-h)+","+r.y+x+h*2+",0 "+x+-h*2+",0 ";this._setPath(n,F)},_setPath:function(n,r){n._path.setAttribute("d",r)},_bringToFront:function(n){es(n._path)},_bringToBack:function(n){ts(n._path)}});et.vml&&ol.include(Ov);function ed(n){return et.svg||et.vml?new ol(n):null}ct.include({getRenderer:function(n){var r=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return r||(r=this._renderer=this._createRenderer()),this.hasLayer(r)||this.addLayer(r),r},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var r=this._paneRenderers[n];return r===void 0&&(r=this._createRenderer({pane:n}),this._paneRenderers[n]=r),r},_createRenderer:function(n){return this.options.preferCanvas&&Qu(n)||ed(n)}});var td=xs.extend({initialize:function(n,r){xs.prototype.initialize.call(this,this._boundsToLatLngs(n),r)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=tt(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function Rv(n,r){return new td(n,r)}ol.create=Jl,ol.pointsToPath=ae,No.geometryToLayer=fa,No.coordsToLatLng=Xa,No.coordsToLatLngs=va,No.latLngToCoords=Qa,No.latLngsToCoords=Oi,No.getFeature=li,No.asFeature=ma,ct.mergeOptions({boxZoom:!0});var nd=Wn.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){at(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){_t(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){xt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),ks(),Js(),this._startPoint=this._map.mouseEventToContainerPoint(n),at(document,{contextmenu:ao,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=mt("div","leaflet-zoom-box",this._container),dt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var r=new re(this._point,this._startPoint),h=r.getSize();Ht(this._box,r.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(xt(this._box),It(this._container,"leaflet-crosshair")),bs(),Xs(),_t(document,{contextmenu:ao,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0);var r=new Je(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(r).fire("boxzoomend",{boxZoomBounds:r})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});ct.addInitHook("addHandler","boxZoom",nd),ct.mergeOptions({doubleClickZoom:!0});var od=Wn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var r=this._map,h=r.getZoom(),y=r.options.zoomDelta,x=n.originalEvent.shiftKey?h-y:h+y;r.options.doubleClickZoom==="center"?r.setZoom(x):r.setZoomAround(n.containerPoint,x)}});ct.addInitHook("addHandler","doubleClickZoom",od),ct.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var sd=Wn.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new bo(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}dt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){It(this._map._container,"leaflet-grab"),It(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var r=tt(this._map.options.maxBounds);this._offsetLimit=Re(this._map.latLngToContainerPoint(r.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(r.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var r=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(r),this._prunePositions(r)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),r=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=r.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,r){return n-(n-r)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),r=this._offsetLimit;n.x<r.min.x&&(n.x=this._viscousLimit(n.x,r.min.x)),n.y<r.min.y&&(n.y=this._viscousLimit(n.y,r.min.y)),n.x>r.max.x&&(n.x=this._viscousLimit(n.x,r.max.x)),n.y>r.max.y&&(n.y=this._viscousLimit(n.y,r.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,r=Math.round(n/2),h=this._initialWorldOffset,y=this._draggable._newPos.x,x=(y-r+h)%n+r-h,F=(y+r+h)%n-r-h,ne=Math.abs(x+h)<Math.abs(F+h)?x:F;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ne},_onDragEnd:function(n){var r=this._map,h=r.options,y=!h.inertia||n.noInertia||this._times.length<2;if(r.fire("dragend",n),y)r.fire("moveend");else{this._prunePositions(+new Date);var x=this._lastPos.subtract(this._positions[0]),F=(this._lastTime-this._times[0])/1e3,ne=h.easeLinearity,_e=x.multiplyBy(ne/F),we=_e.distanceTo([0,0]),Ne=Math.min(h.inertiaMaxSpeed,we),Xe=_e.multiplyBy(Ne/we),ut=Ne/(h.inertiaDeceleration*ne),yt=Xe.multiplyBy(-ut/2).round();!yt.x&&!yt.y?r.fire("moveend"):(yt=r._limitOffset(yt,r.options.maxBounds),V(function(){r.panBy(yt,{duration:ut,easeLinearity:ne,noMoveStart:!0,animate:!0})}))}}});ct.addInitHook("addHandler","dragging",sd),ct.mergeOptions({keyboard:!0,keyboardPanDelta:80});var id=Wn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),at(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),_t(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,r=document.documentElement,h=n.scrollTop||r.scrollTop,y=n.scrollLeft||r.scrollLeft;this._map._container.focus(),window.scrollTo(y,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var r=this._panKeys={},h=this.keyCodes,y,x;for(y=0,x=h.left.length;y<x;y++)r[h.left[y]]=[-1*n,0];for(y=0,x=h.right.length;y<x;y++)r[h.right[y]]=[n,0];for(y=0,x=h.down.length;y<x;y++)r[h.down[y]]=[0,n];for(y=0,x=h.up.length;y<x;y++)r[h.up[y]]=[0,-1*n]},_setZoomDelta:function(n){var r=this._zoomKeys={},h=this.keyCodes,y,x;for(y=0,x=h.zoomIn.length;y<x;y++)r[h.zoomIn[y]]=n;for(y=0,x=h.zoomOut.length;y<x;y++)r[h.zoomOut[y]]=-n},_addHooks:function(){at(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){_t(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var r=n.keyCode,h=this._map,y;if(r in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(y=this._panKeys[r],n.shiftKey&&(y=ke(y).multiplyBy(3)),h.options.maxBounds&&(y=h._limitOffset(ke(y),h.options.maxBounds)),h.options.worldCopyJump){var x=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(y)));h.panTo(x)}else h.panBy(y)}else if(r in this._zoomKeys)h.setZoom(h.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[r]);else if(r===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;ao(n)}}});ct.addInitHook("addHandler","keyboard",id),ct.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ad=Wn.extend({addHooks:function(){at(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){_t(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var r=ni(n),h=this._map.options.wheelDebounceTime;this._delta+=r,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var y=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(c(this._performZoom,this),y),ao(n)},_performZoom:function(){var n=this._map,r=n.getZoom(),h=this._map.options.zoomSnap||0;n._stop();var y=this._delta/(this._map.options.wheelPxPerZoomLevel*4),x=4*Math.log(2/(1+Math.exp(-Math.abs(y))))/Math.LN2,F=h?Math.ceil(x/h)*h:x,ne=n._limitZoom(r+(this._delta>0?F:-F))-r;this._delta=0,this._startTime=null,ne&&(n.options.scrollWheelZoom==="center"?n.setZoom(r+ne):n.setZoomAround(this._lastMousePos,r+ne))}});ct.addInitHook("addHandler","scrollWheelZoom",ad);var Bv=600;ct.mergeOptions({tapHold:et.touchNative&&et.safari&&et.mobile,tapTolerance:15});var ld=Wn.extend({addHooks:function(){at(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){_t(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var r=n.touches[0];this._startPos=this._newPos=new ce(r.clientX,r.clientY),this._holdTimeout=setTimeout(c(function(){this._cancel(),this._isTapValid()&&(at(document,"touchend",Xt),at(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",r))},this),Bv),at(document,"touchend touchcancel contextmenu",this._cancel,this),at(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){_t(document,"touchend",Xt),_t(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),_t(document,"touchend touchcancel contextmenu",this._cancel,this),_t(document,"touchmove",this._onMove,this)},_onMove:function(n){var r=n.touches[0];this._newPos=new ce(r.clientX,r.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,r){var h=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:r.screenX,screenY:r.screenY,clientX:r.clientX,clientY:r.clientY});h._simulated=!0,r.target.dispatchEvent(h)}});ct.addInitHook("addHandler","tapHold",ld),ct.mergeOptions({touchZoom:et.touch,bounceAtZoomLimits:!0});var rd=Wn.extend({addHooks:function(){dt(this._map._container,"leaflet-touch-zoom"),at(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){It(this._map._container,"leaflet-touch-zoom"),_t(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var r=this._map;if(!(!n.touches||n.touches.length!==2||r._animatingZoom||this._zooming)){var h=r.mouseEventToContainerPoint(n.touches[0]),y=r.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=r.getSize()._divideBy(2),this._startLatLng=r.containerPointToLatLng(this._centerPoint),r.options.touchZoom!=="center"&&(this._pinchStartLatLng=r.containerPointToLatLng(h.add(y)._divideBy(2))),this._startDist=h.distanceTo(y),this._startZoom=r.getZoom(),this._moved=!1,this._zooming=!0,r._stop(),at(document,"touchmove",this._onTouchMove,this),at(document,"touchend touchcancel",this._onTouchEnd,this),Xt(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var r=this._map,h=r.mouseEventToContainerPoint(n.touches[0]),y=r.mouseEventToContainerPoint(n.touches[1]),x=h.distanceTo(y)/this._startDist;if(this._zoom=r.getScaleZoom(x,this._startZoom),!r.options.bounceAtZoomLimits&&(this._zoom<r.getMinZoom()&&x<1||this._zoom>r.getMaxZoom()&&x>1)&&(this._zoom=r._limitZoom(this._zoom)),r.options.touchZoom==="center"){if(this._center=this._startLatLng,x===1)return}else{var F=h._add(y)._divideBy(2)._subtract(this._centerPoint);if(x===1&&F.x===0&&F.y===0)return;this._center=r.unproject(r.project(this._pinchStartLatLng,this._zoom).subtract(F),this._zoom)}this._moved||(r._moveStart(!0,!1),this._moved=!0),Q(this._animRequest);var ne=c(r._move,r,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=V(ne,this,!0),Xt(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Q(this._animRequest),_t(document,"touchmove",this._onTouchMove,this),_t(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});ct.addInitHook("addHandler","touchZoom",rd),ct.BoxZoom=nd,ct.DoubleClickZoom=od,ct.Drag=sd,ct.Keyboard=id,ct.ScrollWheelZoom=ad,ct.TapHold=ld,ct.TouchZoom=rd,o.Bounds=re,o.Browser=et,o.CRS=be,o.Canvas=Xu,o.Circle=Ja,o.CircleMarker=ha,o.Class=Ee,o.Control=Cn,o.DivIcon=Ku,o.DivOverlay=kt,o.DomEvent=sa,o.DomUtil=ws,o.Draggable=bo,o.Evented=Fe,o.FeatureGroup=Bo,o.GeoJSON=No,o.GridLayer=tl,o.Handler=Wn,o.Icon=rs,o.ImageOverlay=Ri,o.LatLng=qe,o.LatLngBounds=Je,o.Layer=Ln,o.LayerGroup=ai,o.LineUtil=Lt,o.Map=ct,o.Marker=da,o.Mixin=Wa,o.Path=cs,o.Point=ce,o.PolyUtil=la,o.Polygon=xs,o.Polyline=wo,o.Popup=Qt,o.PosAnimation=ns,o.Projection=Ft,o.Rectangle=td,o.Renderer=$s,o.SVG=ol,o.SVGOverlay=Ie,o.TileLayer=ga,o.Tooltip=Yl,o.Transformation=Ae,o.Util=de,o.VideoOverlay=le,o.bind=c,o.bounds=Re,o.canvas=Qu,o.circle=dc,o.circleMarker=uc,o.control=os,o.divIcon=Ev,o.extend=s,o.featureGroup=ql,o.geoJSON=el,o.geoJson=Kl,o.gridLayer=Pv,o.icon=Ya,o.imageOverlay=z,o.latLng=Qe,o.latLngBounds=tt,o.layerGroup=ua,o.map=Za,o.marker=cc,o.point=ke,o.polygon=fc,o.polyline=hc,o.popup=Co,o.rectangle=Rv,o.setOptions=C,o.stamp=d,o.svg=ed,o.svgOverlay=lt,o.tileLayer=Yu,o.tooltip=Av,o.transformation=W,o.version=i,o.videoOverlay=me;var Nv=window.L;o.noConflict=function(){return window.L=Nv,this},window.L=o}))})(hl,hl.exports)),hl.exports}var R0=O0();const Gt=P0(R0);(function(e,t,o){function i(s,a){for(;(s=s.parentElement)&&!s.classList.contains(a););return s}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(s,a){this._map=s,this._container=s._container,this._overlayPane=s._panes.overlayPane,this._popupPane=s._panes.popupPane,a&&a.shapeOptions&&(a.shapeOptions=L.Util.extend({},this.options.shapeOptions,a.shapeOptions)),L.setOptions(this,a);var c=L.version.split(".");parseInt(c[0],10)===1&&parseInt(c[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(L.DomUtil.disableTextSelection(),s.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(s){L.setOptions(this,s)},_fireCreatedEvent:function(s){this._map.fire(L.Draw.Event.CREATED,{layer:s,layerType:this.type})},_cancelDrawing:function(s){s.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(s,a){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,a&&a.drawError&&(a.drawError=L.Util.extend({},this.options.drawError,a.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var s=this._markers.pop(),a=this._poly,c=a.getLatLngs(),u=c.splice(-1,1)[0];this._poly.setLatLngs(c),this._markerGroup.removeLayer(s),a.getLatLngs().length<2&&this._map.removeLayer(a),this._vertexChanged(u,!1)}},addVertex:function(s){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(s))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(s)),this._poly.addLatLng(s),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(s,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var s=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),a=this._poly.newLatLngIntersects(s[s.length-1]);if(!this.options.allowIntersection&&a||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent),c=this._map.layerPointToLatLng(a);this._currentLatLng=c,this._updateTooltip(c),this._updateGuide(a),this._mouseMarker.setLatLng(c),L.DomEvent.preventDefault(s.originalEvent)},_vertexChanged:function(s,a){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(s,a),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(s){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(s),this._clickHandled=!0,this._disableNewMarkers();var a=s.originalEvent,c=a.clientX,u=a.clientY;this._startPoint.call(this,c,u)}},_startPoint:function(s,a){this._mouseDownOrigin=L.point(s,a)},_onMouseUp:function(s){var a=s.originalEvent,c=a.clientX,u=a.clientY;this._endPoint.call(this,c,u,s),this._clickHandled=null},_endPoint:function(s,a,c){if(this._mouseDownOrigin){var u=L.point(s,a).distanceTo(this._mouseDownOrigin),d=this._calculateFinishDistance(c.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(c.latlng),this._finishShape()):d<10&&L.Browser.touch?this._finishShape():Math.abs(u)<9*(e.devicePixelRatio||1)&&this.addVertex(c.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(s){var a,c,u=s.originalEvent;!u.touches||!u.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(a=u.touches[0].clientX,c=u.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,a,c),this._endPoint.call(this,a,c,s),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(s){var a;if(this._markers.length>0){var c;if(this.type===L.Draw.Polyline.TYPE)c=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;c=this._markers[0]}var u=this._map.latLngToContainerPoint(c.getLatLng()),d=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),f=this._map.latLngToContainerPoint(d.getLatLng());a=u.distanceTo(f)}else a=1/0;return a},_updateFinishHandler:function(){var s=this._markers.length;s>1&&this._markers[s-1].on("click",this._finishShape,this),s>2&&this._markers[s-2].off("click",this._finishShape,this)},_createMarker:function(s){var a=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(a),a},_updateGuide:function(s){var a=this._markers?this._markers.length:0;a>0&&(s=s||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[a-1].getLatLng()),s))},_updateTooltip:function(s){var a=this._getTooltipText();s&&this._tooltip.updatePosition(s),this._errorShown||this._tooltip.updateContent(a)},_drawGuide:function(s,a){var c,u,d,f=Math.floor(Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))),p=this.options.guidelineDistance,g=this.options.maxGuideLineLength,k=f>g?f-g:p;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));k<f;k+=this.options.guidelineDistance)c=k/f,u={x:Math.floor(s.x*(1-c)+c*a.x),y:Math.floor(s.y*(1-c)+c*a.y)},d=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),d.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(d,u)},_updateGuideColor:function(s){if(this._guidesContainer)for(var a=0,c=this._guidesContainer.childNodes.length;a<c;a++)this._guidesContainer.childNodes[a].style.backgroundColor=s},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var s,a,c=this.options.showLength;return this._markers.length===0?s={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(a=c?this._getMeasurementString():"",s=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:a}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:a}),s},_updateRunningMeasure:function(s,a){var c,u,d=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(c=d-(a?2:1),u=L.GeometryUtil.isVersion07x()?s.distanceTo(this._markers[c].getLatLng())*(this.options.factor||1):this._map.distance(s,this._markers[c].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=u*(a?1:-1))},_getMeasurementString:function(){var s,a=this._currentLatLng,c=this._markers[this._markers.length-1].getLatLng();return s=L.GeometryUtil.isVersion07x()?c&&a&&a.distanceTo?this._measurementRunningTotal+a.distanceTo(c)*(this.options.factor||1):this._measurementRunningTotal||0:c&&a?this._measurementRunningTotal+this._map.distance(a,c)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(s,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var s=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(s,a){L.Draw.Polyline.prototype.initialize.call(this,s,a),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var s=this._markers.length;s===1&&this._markers[0].on("click",this._finishShape,this),s>2&&(this._markers[s-1].on("dblclick",this._finishShape,this),s>3&&this._markers[s-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var s,a;return this._markers.length===0?s=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(s=L.drawLocal.draw.handlers.polygon.tooltip.cont,a=this._getMeasurementString()):(s=L.drawLocal.draw.handlers.polygon.tooltip.end,a=this._getMeasurementString()),{text:s,subtext:a}},_getMeasurementString:function(){var s=this._area,a="";return s||this.options.showLength?(this.options.showLength&&(a=L.Draw.Polyline.prototype._getMeasurementString.call(this)),s&&(a+="<br>"+L.GeometryUtil.readableArea(s,this.options.metric,this.options.precision)),a):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(s,a){var c;!this.options.allowIntersection&&this.options.showArea&&(c=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(c)),L.Draw.Polyline.prototype._vertexChanged.call(this,s,a)},_cleanUpShape:function(){var s=this._markers.length;s>0&&(this._markers[0].off("click",this._finishShape,this),s>2&&this._markers[s-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(s,a){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(s){this._isDrawing=!0,this._startLatLng=s.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(s.originalEvent)},_onMouseMove:function(s){var a=s.latlng;this._tooltip.updatePosition(a),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(a))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(s,a){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,a)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(s){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!i(s.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(s){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,s)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,s),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_getTooltipText:function(){var s,a,c,u=L.Draw.SimpleShape.prototype._getTooltipText.call(this),d=this._shape,f=this.options.showArea;return d&&(s=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),a=L.GeometryUtil.geodesicArea(s),c=f?L.GeometryUtil.readableArea(a,this.options.metric):""),{text:u.text,subtext:c}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(s,a){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(s){var a=s.latlng;this._tooltip.updatePosition(a),this._mouseMarker.setLatLng(a),this._marker?(a=this._mouseMarker.getLatLng(),this._marker.setLatLng(a)):(this._marker=this._createMarker(a),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(s){return new L.Marker(s,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(s){this._onMouseMove(s),this._onClick()},_fireCreatedEvent:function(){var s=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(s,a){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,a)},_fireCreatedEvent:function(){var s=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)},_createMarker:function(s){return new L.CircleMarker(s,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(s,a){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,a)},_drawShape:function(s){if(L.GeometryUtil.isVersion07x())var a=this._startLatLng.distanceTo(s);else var a=this._map.distance(this._startLatLng,s);this._shape?this._shape.setRadius(a):(this._shape=new L.Circle(this._startLatLng,a,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_onMouseMove:function(s){var a,c=s.latlng,u=this.options.showRadius,d=this.options.metric;if(this._tooltip.updatePosition(c),this._isDrawing){this._drawShape(c),a=this._shape.getRadius().toFixed(1);var f="";u&&(f=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(a,d,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:f})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(s,a){this._marker=s,L.setOptions(this,a)},addHooks:function(){var s=this._marker;s.dragging.enable(),s.on("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},removeHooks:function(){var s=this._marker;s.dragging.disable(),s.off("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},_onDragEnd:function(s){var a=s.target;a.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:a})},_toggleMarkerHighlight:function(){var s=this._marker._icon;s&&(s.style.display="none",L.DomUtil.hasClass(s,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,-4)):(L.DomUtil.addClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,4)),s.style.display="")},_offsetMarker:function(s,a){var c=parseInt(s.style.marginTop,10)-a,u=parseInt(s.style.marginLeft,10)-a;s.style.marginTop=c+"px",s.style.marginLeft=u+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(s){this.latlngs=[s._latlngs],s._holes&&(this.latlngs=this.latlngs.concat(s._holes)),this._poly=s,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(s){for(var a=0;a<this._verticesHandlers.length;a++)s(this._verticesHandlers[a])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(s){s.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(s){s.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(s){s.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var s=0;s<this.latlngs.length;s++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[s],this._poly.options.poly))},_updateLatLngs:function(s){this.latlngs=[s.layer._latlngs],s.layer._holes&&(this.latlngs=this.latlngs.concat(s.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(s,a,c){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=s,c&&c.drawError&&(c.drawError=L.Util.extend({},this.options.drawError,c.drawError)),this._latlngs=a,L.setOptions(this,c)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var s=this._poly,a=s._path;s instanceof L.Polygon||(s.options.fill=!1,s.options.editing&&(s.options.editing.fill=!1)),a&&s.options.editing&&s.options.editing.className&&(s.options.original.className&&s.options.original.className.split(" ").forEach(function(c){L.DomUtil.removeClass(a,c)}),s.options.editing.className.split(" ").forEach(function(c){L.DomUtil.addClass(a,c)})),s.setStyle(s.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var s=this._poly,a=s._path;a&&s.options.editing&&s.options.editing.className&&(s.options.editing.className.split(" ").forEach(function(c){L.DomUtil.removeClass(a,c)}),s.options.original.className&&s.options.original.className.split(" ").forEach(function(c){L.DomUtil.addClass(a,c)})),s.setStyle(s.options.original),s._map&&(s._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var s,a,c,u,d=this._defaultShape();for(s=0,c=d.length;s<c;s++)u=this._createMarker(d[s],s),u.on("click",this._onMarkerClick,this),u.on("contextmenu",this._onContextMenu,this),this._markers.push(u);var f,p;for(s=0,a=c-1;s<c;a=s++)(s!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(f=this._markers[a],p=this._markers[s],this._createMiddleMarker(f,p),this._updatePrevNext(f,p))},_createMarker:function(s,a){var c=new L.Marker.Touch(s,{draggable:!0,icon:this.options.icon});return c._origLatLng=s,c._index=a,c.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(c),c},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var s=this._defaultShape(),a=[].splice.apply(s,arguments);return this._poly._convertLatLngs(s,!0),this._poly.redraw(),a},_removeMarker:function(s){var a=s._index;this._markerGroup.removeLayer(s),this._markers.splice(a,1),this._spliceLatLngs(a,1),this._updateIndexes(a,-1),s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(s){var a=s.target,c=this._poly,u=L.LatLngUtil.cloneLatLng(a._origLatLng);if(L.extend(a._origLatLng,a._latlng),c.options.poly){var d=c._map._editTooltip;if(!c.options.poly.allowIntersection&&c.intersects()){L.extend(a._origLatLng,u),a.setLatLng(u);var f=c.options.color;c.setStyle({color:this.options.drawError.color}),d&&d.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){c.setStyle({color:f}),d&&d.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}a._middleLeft&&a._middleLeft.setLatLng(this._getMiddleLatLng(a._prev,a)),a._middleRight&&a._middleRight.setLatLng(this._getMiddleLatLng(a,a._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var p=this._poly.getLatLngs();this._poly._convertLatLngs(p,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(s){var a=L.Polygon&&this._poly instanceof L.Polygon?4:3,c=s.target;this._defaultShape().length<a||(this._removeMarker(c),this._updatePrevNext(c._prev,c._next),c._middleLeft&&this._markerGroup.removeLayer(c._middleLeft),c._middleRight&&this._markerGroup.removeLayer(c._middleRight),c._prev&&c._next?this._createMiddleMarker(c._prev,c._next):c._prev?c._next||(c._prev._middleRight=null):c._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(s){var a=s.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:a,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),c=this._map.layerPointToLatLng(a),u=s.target;L.extend(u._origLatLng,c),u._middleLeft&&u._middleLeft.setLatLng(this._getMiddleLatLng(u._prev,u)),u._middleRight&&u._middleRight.setLatLng(this._getMiddleLatLng(u,u._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(s,a){this._markerGroup.eachLayer(function(c){c._index>s&&(c._index+=a)})},_createMiddleMarker:function(s,a){var c,u,d,f=this._getMiddleLatLng(s,a),p=this._createMarker(f);p.setOpacity(.6),s._middleRight=a._middleLeft=p,u=function(){p.off("touchmove",u,this);var g=a._index;p._index=g,p.off("click",c,this).on("click",this._onMarkerClick,this),f.lat=p.getLatLng().lat,f.lng=p.getLatLng().lng,this._spliceLatLngs(g,0,f),this._markers.splice(g,0,p),p.setOpacity(1),this._updateIndexes(g,1),a._index++,this._updatePrevNext(s,p),this._updatePrevNext(p,a),this._poly.fire("editstart")},d=function(){p.off("dragstart",u,this),p.off("dragend",d,this),p.off("touchmove",u,this),this._createMiddleMarker(s,p),this._createMiddleMarker(p,a)},c=function(){u.call(this),d.call(this),this._fireEdit()},p.on("click",c,this).on("dragstart",u,this).on("dragend",d,this).on("touchmove",u,this),this._markerGroup.addLayer(p)},_updatePrevNext:function(s,a){s&&(s._next=a),a&&(a._prev=s)},_getMiddleLatLng:function(s,a){var c=this._poly._map,u=c.project(s.getLatLng()),d=c.project(a.getLatLng());return c.unproject(u._add(d)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(s,a){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=s,L.Util.setOptions(this,a)},addHooks:function(){var s=this._shape;this._shape._map&&(this._map=this._shape._map,s.setStyle(s.options.editing),s._map&&(this._map=s._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var s=this._shape;if(s.setStyle(s.options.original),s._map){this._unbindMarker(this._moveMarker);for(var a=0,c=this._resizeMarkers.length;a<c;a++)this._unbindMarker(this._resizeMarkers[a]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(s,a){var c=new L.Marker.Touch(s,{draggable:!0,icon:a,zIndexOffset:10});return this._bindMarker(c),this._markerGroup.addLayer(c),c},_bindMarker:function(s){s.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(s){s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(s){s.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(s){var a=s.target,c=a.getLatLng();a===this._moveMarker?this._move(c):this._resize(c),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(s){s.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(s){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s),typeof this._getCorners=="function"){var a=this._getCorners(),c=s.target,u=c._cornerIndex;c.setOpacity(0),this._oppositeCorner=a[(u+2)%4],this._toggleCornerMarkers(0,u)}this._shape.fire("editstart")},_onTouchMove:function(s){var a=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),c=this._map.layerPointToLatLng(a);return s.target===this._moveMarker?this._move(c):this._resize(c),this._shape.redraw(),!1},_onTouchEnd:function(s){s.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getBounds(),a=s.getCenter();this._moveMarker=this._createMarker(a,this.options.moveIcon)},_createResizeMarker:function(){var s=this._getCorners();this._resizeMarkers=[];for(var a=0,c=s.length;a<c;a++)this._resizeMarkers.push(this._createMarker(s[a],this.options.resizeIcon)),this._resizeMarkers[a]._cornerIndex=a},_onMarkerDragStart:function(s){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s);var a=this._getCorners(),c=s.target,u=c._cornerIndex;this._oppositeCorner=a[(u+2)%4],this._toggleCornerMarkers(0,u)},_onMarkerDragEnd:function(s){var a,c,u=s.target;u===this._moveMarker&&(a=this._shape.getBounds(),c=a.getCenter(),u.setLatLng(c)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,s)},_move:function(s){for(var a,c=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),u=this._shape.getBounds(),d=u.getCenter(),f=[],p=0,g=c.length;p<g;p++)a=[c[p].lat-d.lat,c[p].lng-d.lng],f.push([s.lat+a[0],s.lng+a[1]]);this._shape.setLatLngs(f),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(s){var a;this._shape.setBounds(L.latLngBounds(s,this._oppositeCorner)),a=this._shape.getBounds(),this._moveMarker.setLatLng(a.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var s=this._shape.getBounds();return[s.getNorthWest(),s.getNorthEast(),s.getSouthEast(),s.getSouthWest()]},_toggleCornerMarkers:function(s){for(var a=0,c=this._resizeMarkers.length;a<c;a++)this._resizeMarkers[a].setOpacity(s)},_repositionCornerMarkers:function(){for(var s=this._getCorners(),a=0,c=this._resizeMarkers.length;a<c;a++)this._resizeMarkers[a].setLatLng(s[a])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getLatLng();this._moveMarker=this._createMarker(s,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(s){if(this._resizeMarkers.length){var a=this._getResizeMarkerPoint(s);this._resizeMarkers[0].setLatLng(a)}this._shape.setLatLng(s),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var s=this._shape.getLatLng(),a=this._getResizeMarkerPoint(s);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(a,this.options.resizeIcon))},_getResizeMarkerPoint:function(s){var a=this._shape._radius*Math.cos(Math.PI/4),c=this._map.project(s);return this._map.unproject([c.x+a,c.y-a])},_resize:function(s){var a=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=a.distanceTo(s):radius=this._map.distance(a,s),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(s,a){var c={};if(s.touches!==void 0){if(!s.touches.length)return;c=s.touches[0]}else if(s.pointerType!=="touch"||(c=s,!this._filterClick(s)))return;var u=this._map.mouseEventToContainerPoint(c),d=this._map.mouseEventToLayerPoint(c),f=this._map.layerPointToLatLng(d);this._map.fire(a,{latlng:f,layerPoint:d,containerPoint:u,pageX:c.pageX,pageY:c.pageY,originalEvent:s})},_filterClick:function(s){var a=s.timeStamp||s.originalEvent.timeStamp,c=L.DomEvent._lastClick&&a-L.DomEvent._lastClick;return c&&c>100&&c<500||s.target._simulatedClick&&!s._simulated?(L.DomEvent.stop(s),!1):(L.DomEvent._lastClick=a,!0)},_onTouchStart:function(s){this._map._loaded&&this._touchEvent(s,"touchstart")},_onTouchEnd:function(s){this._map._loaded&&this._touchEvent(s,"touchend")},_onTouchCancel:function(s){if(this._map._loaded){var a="touchcancel";this._detectIE()&&(a="pointercancel"),this._touchEvent(s,a)}},_onTouchLeave:function(s){this._map._loaded&&this._touchEvent(s,"touchleave")},_onTouchMove:function(s){this._map._loaded&&this._touchEvent(s,"touchmove")},_detectIE:function(){var s=e.navigator.userAgent,a=s.indexOf("MSIE ");if(a>0)return parseInt(s.substring(a+5,s.indexOf(".",a)),10);if(s.indexOf("Trident/")>0){var c=s.indexOf("rv:");return parseInt(s.substring(c+3,s.indexOf(".",c)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var s=this._icon,a=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?a.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):a.concat(["touchcancel"]),L.DomUtil.addClass(s,"leaflet-clickable"),L.DomEvent.on(s,"click",this._onMouseClick,this),L.DomEvent.on(s,"keypress",this._onKeyPress,this);for(var c=0;c<a.length;c++)L.DomEvent.on(s,a[c],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var s=e.navigator.userAgent,a=s.indexOf("MSIE ");if(a>0)return parseInt(s.substring(a+5,s.indexOf(".",a)),10);if(s.indexOf("Trident/")>0){var c=s.indexOf("rv:");return parseInt(s.substring(c+3,s.indexOf(".",c)),10)}var u=s.indexOf("Edge/");return u>0&&parseInt(s.substring(u+5,s.indexOf(".",u)),10)}}),L.LatLngUtil={cloneLatLngs:function(s){for(var a=[],c=0,u=s.length;c<u;c++)Array.isArray(s[c])?a.push(L.LatLngUtil.cloneLatLngs(s[c])):a.push(this.cloneLatLng(s[c]));return a},cloneLatLng:function(s){return L.latLng(s.lat,s.lng)}},(function(){var s={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(a){var c,u,d=a.length,f=0,p=Math.PI/180;if(d>2){for(var g=0;g<d;g++)c=a[g],u=a[(g+1)%d],f+=(u.lng-c.lng)*p*(2+Math.sin(c.lat*p)+Math.sin(u.lat*p));f=6378137*f*6378137/2}return Math.abs(f)},formattedNumber:function(a,c){var u=parseFloat(a).toFixed(c),d=L.drawLocal.format&&L.drawLocal.format.numeric,f=d&&d.delimiters,p=f&&f.thousands,g=f&&f.decimal;if(p||g){var k=u.split(".");u=p?k[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+p):k[0],g=g||".",k.length>1&&(u=u+g+k[1])}return u},readableArea:function(a,c,p){var d,f,p=L.Util.extend({},s,p);return c?(f=["ha","m"],type=typeof c,type==="string"?f=[c]:type!=="boolean"&&(f=c),d=a>=1e6&&f.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*a,p.km)+" km":a>=1e4&&f.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*a,p.ha)+" ha":L.GeometryUtil.formattedNumber(a,p.m)+" m"):(a/=.836127,d=a>=3097600?L.GeometryUtil.formattedNumber(a/3097600,p.mi)+" mi":a>=4840?L.GeometryUtil.formattedNumber(a/4840,p.ac)+" acres":L.GeometryUtil.formattedNumber(a,p.yd)+" yd"),d},readableDistance:function(a,c,u,d,g){var p,g=L.Util.extend({},s,g);switch(c?typeof c=="string"?c:"metric":u?"feet":d?"nauticalMile":"yards"){case"metric":p=a>1e3?L.GeometryUtil.formattedNumber(a/1e3,g.km)+" km":L.GeometryUtil.formattedNumber(a,g.m)+" m";break;case"feet":a*=3.28083,p=L.GeometryUtil.formattedNumber(a,g.ft)+" ft";break;case"nauticalMile":a*=.53996,p=L.GeometryUtil.formattedNumber(a/1e3,g.nm)+" nm";break;default:a*=1.09361,p=a>1760?L.GeometryUtil.formattedNumber(a/1760,g.mi)+" miles":L.GeometryUtil.formattedNumber(a,g.yd)+" yd"}return p},isVersion07x:function(){var a=L.version.split(".");return parseInt(a[0],10)===0&&parseInt(a[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(s,a,c,u){return this._checkCounterclockwise(s,c,u)!==this._checkCounterclockwise(a,c,u)&&this._checkCounterclockwise(s,a,c)!==this._checkCounterclockwise(s,a,u)},_checkCounterclockwise:function(s,a,c){return(c.y-s.y)*(a.x-s.x)>(a.y-s.y)*(c.x-s.x)}}),L.Polyline.include({intersects:function(){var s,a,c,u=this._getProjectedPoints(),d=u?u.length:0;if(this._tooFewPointsForIntersection())return!1;for(s=d-1;s>=3;s--)if(a=u[s-1],c=u[s],this._lineSegmentsIntersectsRange(a,c,s-2))return!0;return!1},newLatLngIntersects:function(s,a){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(s),a)},newPointIntersects:function(s,a){var c=this._getProjectedPoints(),u=c?c.length:0,d=c?c[u-1]:null,f=u-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(d,s,f,a?1:0)},_tooFewPointsForIntersection:function(s){var a=this._getProjectedPoints(),c=a?a.length:0;return c+=s||0,!a||c<=3},_lineSegmentsIntersectsRange:function(s,a,c,u){var d,f,p=this._getProjectedPoints();u=u||0;for(var g=c;g>u;g--)if(d=p[g-1],f=p[g],L.LineUtil.segmentsIntersect(s,a,d,f))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var s=[],a=this._defaultShape(),c=0;c<a.length;c++)s.push(this._map.latLngToLayerPoint(a[c]));return s}}),L.Polygon.include({intersects:function(){var s,a,c,u,d=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(s=d.length,a=d[0],c=d[s-1],u=s-2,this._lineSegmentsIntersectsRange(c,a,u,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(s){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,s);var a;this._toolbars={},L.DrawToolbar&&this.options.draw&&(a=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=a,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(a=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=a,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(s){var a,c=L.DomUtil.create("div","leaflet-draw"),u=!1;for(var d in this._toolbars)this._toolbars.hasOwnProperty(d)&&(a=this._toolbars[d].addToolbar(s))&&(u||(L.DomUtil.hasClass(a,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(a.childNodes[0],"leaflet-draw-toolbar-top"),u=!0),c.appendChild(a));return c},onRemove:function(){for(var s in this._toolbars)this._toolbars.hasOwnProperty(s)&&this._toolbars[s].removeToolbar()},setDrawingOptions:function(s){for(var a in this._toolbars)this._toolbars[a]instanceof L.DrawToolbar&&this._toolbars[a].setOptions(s)},_toolbarEnabled:function(s){var a=s.target;for(var c in this._toolbars)this._toolbars[c]!==a&&this._toolbars[c].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(s){L.setOptions(this,s),this._modes={},this._actionButtons=[],this._activeMode=null;var a=L.version.split(".");parseInt(a[0],10)===1&&parseInt(a[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(s){var a,c=L.DomUtil.create("div","leaflet-draw-section"),u=0,d=this._toolbarClass||"",f=this.getModeHandlers(s);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=s,a=0;a<f.length;a++)f[a].enabled&&this._initModeHandler(f[a].handler,this._toolbarContainer,u++,d,f[a].title);if(u)return this._lastButtonIndex=--u,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),c.appendChild(this._toolbarContainer),c.appendChild(this._actionsContainer),c},removeToolbar:function(){for(var s in this._modes)this._modes.hasOwnProperty(s)&&(this._disposeButton(this._modes[s].button,this._modes[s].handler.enable,this._modes[s].handler),this._modes[s].handler.disable(),this._modes[s].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var a=0,c=this._actionButtons.length;a<c;a++)this._disposeButton(this._actionButtons[a].button,this._actionButtons[a].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(s,a,c,u,d){var f=s.type;this._modes[f]={},this._modes[f].handler=s,this._modes[f].button=this._createButton({type:f,title:d,className:u+"-"+f,container:a,callback:this._modes[f].handler.enable,context:this._modes[f].handler}),this._modes[f].buttonIndex=c,this._modes[f].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(s){var a=L.DomUtil.create("a",s.className||"",s.container),c=L.DomUtil.create("span","sr-only",s.container);a.href="#",a.appendChild(c),s.title&&(a.title=s.title,c.innerHTML=s.title),s.text&&(a.innerHTML=s.text,c.innerHTML=s.text);var u=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(a,"click",L.DomEvent.stopPropagation).on(a,"mousedown",L.DomEvent.stopPropagation).on(a,"dblclick",L.DomEvent.stopPropagation).on(a,"touchstart",L.DomEvent.stopPropagation).on(a,"click",L.DomEvent.preventDefault).on(a,u,s.callback,s.context),a},_disposeButton:function(s,a){var c=this._detectIOS()?"touchstart":"click";L.DomEvent.off(s,"click",L.DomEvent.stopPropagation).off(s,"mousedown",L.DomEvent.stopPropagation).off(s,"dblclick",L.DomEvent.stopPropagation).off(s,"touchstart",L.DomEvent.stopPropagation).off(s,"click",L.DomEvent.preventDefault).off(s,c,a)},_handlerActivated:function(s){this.disable(),this._activeMode=this._modes[s.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(s){var a,c,u,d,f=this._actionsContainer,p=this.getActions(s),g=p.length;for(c=0,u=this._actionButtons.length;c<u;c++)this._disposeButton(this._actionButtons[c].button,this._actionButtons[c].callback);for(this._actionButtons=[];f.firstChild;)f.removeChild(f.firstChild);for(var k=0;k<g;k++)"enabled"in p[k]&&!p[k].enabled||(a=L.DomUtil.create("li","",f),d=this._createButton({title:p[k].title,text:p[k].text,container:a,callback:p[k].callback,context:p[k].context}),this._actionButtons.push({button:d,callback:p[k].callback}))},_showActionsToolbar:function(){var s=this._activeMode.buttonIndex,a=this._lastButtonIndex,c=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=c+"px",s===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),s===a&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(s){this._map=s,this._popupPane=s._panes.popupPane,this._visible=!1,this._container=s.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(s){return this._container?(s.subtext=s.subtext||"",s.subtext.length!==0||this._singleLineLabel?s.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(s.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+s.subtext+"</span><br />":"")+"<span>"+s.text+"</span>",s.text||s.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(s){var a=this._map.latLngToLayerPoint(s),c=this._container;return this._container&&(this._visible&&(c.style.visibility="inherit"),L.DomUtil.setPosition(c,a)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(s){for(var a in this.options)this.options.hasOwnProperty(a)&&s[a]&&(s[a]=L.extend({},this.options[a],s[a]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,s)},getModeHandlers:function(s){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(s,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(s,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(s,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(s,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(s,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(s,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(s){return[{enabled:s.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:s.completeShape,context:s},{enabled:s.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:s.deleteLastVertex,context:s},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(s){L.setOptions(this,s);for(var a in this._modes)this._modes.hasOwnProperty(a)&&s.hasOwnProperty(a)&&this._modes[a].handler.setOptions(s[a])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(s){s.edit&&(s.edit.selectedPathOptions===void 0&&(s.edit.selectedPathOptions=this.options.edit.selectedPathOptions),s.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,s.edit.selectedPathOptions)),s.remove&&(s.remove=L.extend({},this.options.remove,s.remove)),s.poly&&(s.poly=L.extend({},this.options.poly,s.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,s),this._selectedFeatureCount=0},getModeHandlers:function(s){var a=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(s,{featureGroup:a,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(s,{featureGroup:a}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(s){var a=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return s.removeAllLayers&&a.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),a},addToolbar:function(s){var a=L.Toolbar.prototype.addToolbar.call(this,s);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),a},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var s,a=this.options.featureGroup,c=a.getLayers().length!==0;this.options.edit&&(s=this._modes[L.EditToolbar.Edit.TYPE].button,c?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",c?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(s=this._modes[L.EditToolbar.Delete.TYPE].button,c?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",c?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(s,a){if(L.Handler.prototype.initialize.call(this,s),L.setOptions(this,a),this._featureGroup=a.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var c=L.version.split(".");parseInt(c[0],10)===1&&parseInt(c[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),s._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(s){this._revertLayer(s)},this)},save:function(){var s=new L.LayerGroup;this._featureGroup.eachLayer(function(a){a.edited&&(s.addLayer(a),a.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:s})},_backupLayer:function(s){var a=L.Util.stamp(s);this._uneditedLayerProps[a]||(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?this._uneditedLayerProps[a]={latlngs:L.LatLngUtil.cloneLatLngs(s.getLatLngs())}:s instanceof L.Circle?this._uneditedLayerProps[a]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng()),radius:s.getRadius()}:(s instanceof L.Marker||s instanceof L.CircleMarker)&&(this._uneditedLayerProps[a]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(s){var a=L.Util.stamp(s);s.edited=!1,this._uneditedLayerProps.hasOwnProperty(a)&&(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?s.setLatLngs(this._uneditedLayerProps[a].latlngs):s instanceof L.Circle?(s.setLatLng(this._uneditedLayerProps[a].latlng),s.setRadius(this._uneditedLayerProps[a].radius)):(s instanceof L.Marker||s instanceof L.CircleMarker)&&s.setLatLng(this._uneditedLayerProps[a].latlng),s.fire("revert-edited",{layer:s}))},_enableLayerEdit:function(s){var a,c,u=s.layer||s.target||s;this._backupLayer(u),this.options.poly&&(c=L.Util.extend({},this.options.poly),u.options.poly=c),this.options.selectedPathOptions&&(a=L.Util.extend({},this.options.selectedPathOptions),a.maintainColor&&(a.color=u.options.color,a.fillColor=u.options.fillColor),u.options.original=L.extend({},u.options),u.options.editing=a),u instanceof L.Marker?(u.editing&&u.editing.enable(),u.dragging.enable(),u.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):u.editing.enable()},_disableLayerEdit:function(s){var a=s.layer||s.target||s;a.edited=!1,a.editing&&a.editing.disable(),delete a.options.editing,delete a.options.original,this._selectedPathOptions&&(a instanceof L.Marker?this._toggleMarkerHighlight(a):(a.setStyle(a.options.previousOptions),delete a.options.previousOptions)),a instanceof L.Marker?(a.dragging.disable(),a.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):a.editing.disable()},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_onMarkerDragEnd:function(s){var a=s.target;a.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:a})},_onTouchMove:function(s){var a=s.originalEvent.changedTouches[0],c=this._map.mouseEventToLayerPoint(a),u=this._map.layerPointToLatLng(c);s.target.setLatLng(u)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(s,a){if(L.Handler.prototype.initialize.call(this,s),L.Util.setOptions(this,a),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var c=L.version.split(".");parseInt(c[0],10)===1&&parseInt(c[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(s){this._deletableLayers.addLayer(s),s.fire("revert-deleted",{layer:s})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(s){this._removeLayer({layer:s})},this),this.save()},_enableLayerDelete:function(s){(s.layer||s.target||s).on("click",this._removeLayer,this)},_disableLayerDelete:function(s){var a=s.layer||s.target||s;a.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(a)},_removeLayer:function(s){var a=s.layer||s.target||s;this._deletableLayers.removeLayer(a),this._deletedLayers.addLayer(a),a.fire("deleted")},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const _v=(e,t)=>e?e.length<=t?e:e.substring(0,t)+"...":"",Uh=e=>e.length*6+12,Oc=(e,t)=>!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom),B0=(e,t)=>{if(!e||t.length===0)return new Set;const o=[],i=e.getBounds();t.forEach(c=>{if(i.contains(c.getLatLng())){const u=e.latLngToContainerPoint(c.getLatLng()),d=c.locationData;d&&o.push({marker:c,pixelPos:u,location:d})}});const s=o.map(({marker:c,pixelPos:u,location:d})=>{const g=Uh(d.name),k=d.description?Uh(`${d.name}: ${_v(d.description,50)}`):g;return{marker:c,location:d,markerBox:{left:u.x-15,right:u.x+15,top:u.y-15,bottom:u.y+15},baseLabelBox:{left:u.x-g/2,right:u.x+g/2,top:u.y+15+2,bottom:u.y+15+2+20},descLabelBox:d.description?{left:u.x-k/2,right:u.x+k/2,top:u.y+15+2,bottom:u.y+15+2+20}:null}}),a=new Set;return s.forEach(({marker:c,location:u,markerBox:d,baseLabelBox:f,descLabelBox:p},g)=>{if(!u.description)return;let k=!1;for(let _=0;_<s.length;_++){if(g===_)continue;const b=s[_];if(Oc(p,b.markerBox)||Oc(p,b.baseLabelBox)){k=!0;break}if(b.descLabelBox&&a.has(b.location.id)&&Oc(p,b.descLabelBox)){k=!0;break}}k||a.add(u.id)}),a},ar=[{value:"circle",label:"Circle"},{value:"square",label:"Square"},{value:"hexagon",label:"Hexagon"},{value:"pentagon",label:"Pentagon"},{value:"diamond",label:"Diamond"},{value:"star",label:"Star"},{value:"dot",label:"Dot"},{value:"none",label:"None"}],N0=[{value:"33",label:"Small (33%)"},{value:"66",label:"Medium (66%)"},{value:"100",label:"Normal (100%)"},{value:"150",label:"Large (150%)"}],Ar=[{value:"default",label:"Default",isShapeOnly:!1,category:"default"},{value:"dot",label:"Dot",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"circle",label:"Circle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"square",label:"Square",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"triangle",label:"Triangle",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"diamond",label:"Diamond",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"star",label:"Star",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"hexagon",label:"Hexagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"pentagon",label:"Pentagon",isShapeOnly:!0,category:"shape",defaultColor:"#667eea"},{value:"car",label:"Car",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"bike",label:"Bike",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"water",label:"Water",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"food",label:"Food",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"medical",label:"Medical",isShapeOnly:!1,category:"content",defaultColor:"#EF4444"},{value:"photo",label:"Photo",isShapeOnly:!1,category:"content",defaultColor:"#8B5CF6"},{value:"music",label:"Music",isShapeOnly:!1,category:"content",defaultColor:"#EC4899"},{value:"start",label:"Start",isShapeOnly:!1,category:"content",defaultColor:"#10B981"},{value:"finish",label:"Finish",isShapeOnly:!1,category:"content",defaultColor:"#1F2937"},{value:"toilet",label:"Toilet",isShapeOnly:!1,category:"content",defaultColor:"#6366F1"},{value:"shower",label:"Shower",isShapeOnly:!1,category:"content",defaultColor:"#06B6D4"},{value:"bus",label:"Bus",isShapeOnly:!1,category:"content",defaultColor:"#F97316"},{value:"info",label:"Information",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"merch",label:"Merchandise",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"cone",label:"Road closure",isShapeOnly:!1,category:"content",defaultColor:"#FF6B00"},{value:"traffic",label:"Traffic management",isShapeOnly:!1,category:"content",defaultColor:"#374151"},{value:"track",label:"Track",isShapeOnly:!1,category:"content",defaultColor:"#78716C"},{value:"tunnel",label:"Tunnel",isShapeOnly:!1,category:"content",defaultColor:"#57534E"},{value:"bridge",label:"Bridge",isShapeOnly:!1,category:"content",defaultColor:"#0284C7"},{value:"plane",label:"Plane",isShapeOnly:!1,category:"content",defaultColor:"#0EA5E9"},{value:"hill",label:"Hill",isShapeOnly:!1,category:"content",defaultColor:"#65A30D"},{value:"baggage",label:"Baggage",isShapeOnly:!1,category:"content",defaultColor:"#A855F7"},{value:"crown",label:"Crown",isShapeOnly:!1,category:"content",defaultColor:"#F59E0B"},{value:"crossing",label:"Crossing point",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"trees",label:"Trees",isShapeOnly:!1,category:"content",defaultColor:"#22C55E"},{value:"arrow-uturn-left",label:"Left u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-left",label:"Left turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-left",label:"Slight left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-straight",label:"Straight ahead",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-slight-right",label:"Slight right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-right",label:"Right turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-uturn-right",label:"Right u-turn",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-left",label:"Left fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-fork-right",label:"Right fork",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-left",label:"Keep left",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"},{value:"arrow-keep-right",label:"Keep right",isShapeOnly:!1,category:"content",defaultColor:"#3B82F6"}];function Xi(e){return Ar.find(t=>t.value===e)||Ar[0]}function F0(e){return Xi(e).defaultColor||"#667eea"}function U0(e,t){return t||F0(e)}const hu={dot:(e,t=32)=>{const o=(t/2-2)*.33;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="1.5"/>
    </svg>`},circle:(e,t=32)=>{const o=t/2-2;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <circle cx="${t/2}" cy="${t/2}" r="${o}" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`},square:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect x="4" y="4" width="${t-8}" height="${t-8}" rx="4" fill="${e}" stroke="#fff" stroke-width="2"/>
    </svg>`,triangle:(e,t=32)=>{const o=t/2,i=4,s=t-4,a=4,c=t-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${i} ${c},${s} ${a},${s}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},diamond:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4;return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${o},${i-s} ${o+s},${i} ${o},${i+s} ${o-s},${i}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},star:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-3,a=s*.4,c=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;c.push(`${o+s*Math.cos(d)},${i+s*Math.sin(d)}`);const f=d+Math.PI/5;c.push(`${o+a*Math.cos(f)},${i+a*Math.sin(f)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${c.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},hexagon:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4,a=[];for(let c=0;c<6;c++){const u=Math.PI/6+c*Math.PI/3;a.push(`${o+s*Math.cos(u)},${i+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${a.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},pentagon:(e,t=32)=>{const o=t/2,i=t/2,s=t/2-4,a=[];for(let c=0;c<5;c++){const u=Math.PI/2*-1+c*2*Math.PI/5;a.push(`${o+s*Math.cos(u)},${i+s*Math.sin(u)}`)}return`<svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <polygon points="${a.join(" ")}" fill="${e}" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
    </svg>`},car:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Car body -->
      <rect x="6" y="13" width="20" height="8" rx="2" fill="#fff"/>
      <!-- Car roof/cabin -->
      <path d="M10 13 L12 9 L20 9 L22 13" fill="#fff" stroke="#fff" stroke-width="1"/>
      <!-- Windows -->
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${e}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${e}"/>
      <!-- Tires (always black) -->
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="#fff" stroke-width="0.5"/>
      <!-- Wheel centers -->
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>
    </svg>`,bike:(e,t=32)=>`<svg width="${t}" height="${t}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${e}" stroke="#fff" stroke-width="2"/>
      <!-- Tires (same color as bike) -->
      <circle cx="9" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="#fff" stroke-width="2"/>
      <!-- Wheel centers -->
      <circle cx="9" cy="20" r="1" fill="#fff"/>
      <circle cx="23" cy="20" r="1" fill="#fff"/>
      <!-- Frame -->
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"/>
      <!-- Handlebars -->
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <!-- Seat -->
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="#fff"/>
    </svg>`},zh={water:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="#fff"/>
    </svg>`,food:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="#fff"/>
      <path d="M21 9v14h2V9h-2z" fill="#fff"/>
    </svg>`,medical:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#fff" stroke-width="2"/>
      <rect x="14" y="8" width="4" height="16" rx="1" fill="#fff"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="#fff"/>
    </svg>`,photo:(e=32)=>{const t="#8B5CF6";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="8" y="10" width="16" height="12" rx="2" fill="#fff"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" y="13" r="1" fill="${t}"/>
    </svg>`},music:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#EC4899" stroke="#fff" stroke-width="2"/>
      <path d="M12 22c1.66 0 3-1.34 3-3v-9h5v4h-3v5c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.35 0 .69.07 1 .18V10c0-.55.45-1 1-1h5c.55 0 1 .45 1 1v6h-5v5c0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.7 0 1.37.15 2 .41" fill="#fff"/>
      <ellipse cx="12" cy="21" rx="2.5" ry="2" fill="#fff"/>
      <rect x="14" y="10" width="2" height="9" fill="#fff"/>
      <rect x="14" y="10" width="6" height="2" fill="#fff"/>
    </svg>`,start:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#10B981" stroke="#fff" stroke-width="2"/>
      <path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="#fff"/>
    </svg>`,finish:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#1F2937" stroke="#fff" stroke-width="2"/>
      <rect x="10" y="8" width="4" height="4" fill="#fff"/>
      <rect x="14" y="12" width="4" height="4" fill="#fff"/>
      <rect x="18" y="8" width="4" height="4" fill="#fff"/>
      <rect x="10" y="16" width="4" height="4" fill="#fff"/>
      <rect x="18" y="16" width="4" height="4" fill="#fff"/>
      <rect x="14" y="20" width="4" height="4" fill="#fff"/>
    </svg>`,toilet:(e=32)=>{const t="#6366F1";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="11" y="7" width="10" height="3" rx="1" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="#fff"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>
    </svg>`},shower:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#06B6D4" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="3" fill="#fff"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="#fff"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
    </svg>`,bus:(e=32)=>{const t="#F97316";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <rect x="9" y="9" width="14" height="12" rx="2" fill="#fff"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="#fff"/>
      <circle cx="12" cy="21" r="1.5" fill="#fff"/>
      <circle cx="20" cy="21" r="1.5" fill="#fff"/>
    </svg>`},info:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#0EA5E9" stroke="#fff" stroke-width="2"/>
      <circle cx="16" cy="10" r="2" fill="#fff"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="#fff"/>
    </svg>`,merch:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#A855F7" stroke="#fff" stroke-width="2"/>
      <path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="#fff"/>
      <path d="M13 10 L16 7 L19 10" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>`,cone:(e=32)=>{const t="#FF6B00";return`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="${t}" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L21 22 H11 L16 6Z" fill="#fff"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="#fff"/>
    </svg>`},traffic:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#374151" stroke="#fff" stroke-width="2"/>
      <rect x="12" y="6" width="8" height="20" rx="2" fill="#fff"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>
    </svg>`,crown:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#F59E0B" stroke="#fff" stroke-width="2"/>
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="#fff"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="#fff"/>
    </svg>`,crossing:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="#fff" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="#fff" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="#fff"/>
      <path d="M16 10 L16 16" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
    </svg>`,trees:(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#22C55E" stroke="#fff" stroke-width="2"/>
      <!-- Left tree -->
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="#fff"/>
      <!-- Right tree -->
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="#fff"/>
    </svg>`,"arrow-uturn-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on right, curve left, down on left -->
      <path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on left side -->
      <path d="M7 15 L12 21 L17 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="#fff"/>
    </svg>`,"arrow-slight-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-straight":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
    </svg>`,"arrow-slight-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="#fff"/>
    </svg>`,"arrow-uturn-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- U-turn path: up on left, curve right, down on right -->
      <path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <!-- Arrow head pointing down on right side -->
      <path d="M15 15 L20 21 L25 15" fill="#fff" stroke="#fff" stroke-width="1" stroke-linejoin="round"/>
    </svg>`,"arrow-fork-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (correct way - with arrow) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M10 12 L6 10 L8 16 Z" fill="#fff"/>
      <!-- Right fork (wrong way - with X) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
    </svg>`,"arrow-fork-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <!-- Main stem coming from bottom -->
      <rect x="14" y="18" width="4" height="8" fill="#fff"/>
      <!-- Left fork (wrong way - with X) -->
      <path d="M16 18 L10 12" stroke="#fff" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <!-- Right fork (correct way - with arrow) -->
      <path d="M16 18 L22 12" stroke="#fff" stroke-width="4" stroke-linecap="round"/>
      <path d="M22 12 L26 10 L24 16 Z" fill="#fff"/>
    </svg>`,"arrow-keep-left":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`,"arrow-keep-right":(e=32)=>`<svg width="${e}" height="${e}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      <circle cx="16" cy="16" r="14" fill="#3B82F6" stroke="#fff" stroke-width="2"/>
      <g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="#fff"/>
      </g>
    </svg>`},La={circle:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="14" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,square:({backgroundColor:e,borderColor:t})=>`<rect x="4" y="4" width="24" height="24" rx="4" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}"/>`,hexagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=[];for(let a=0;a<6;a++){const c=Math.PI/6+a*Math.PI/3;s.push(`${16+12*Math.cos(c)},${16+12*Math.sin(c)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},pentagon:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=[];for(let a=0;a<5;a++){const c=Math.PI/2*-1+a*2*Math.PI/5;s.push(`${16+12*Math.cos(c)},${16+12*Math.sin(c)}`)}return`<polygon points="${s.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},diamond:({backgroundColor:e,borderColor:t})=>`<polygon points="16,4 28,16 16,28 4,16" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:2}" stroke-linejoin="round"/>`,star:({backgroundColor:e,borderColor:t})=>{const o=t==="none"?"none":t||"#fff",i=t==="none"?0:2,s=13,a=s*.4,c=[];for(let u=0;u<5;u++){const d=Math.PI/2*-1+u*2*Math.PI/5;c.push(`${16+s*Math.cos(d)},${16+s*Math.sin(d)}`);const f=d+Math.PI/5;c.push(`${16+a*Math.cos(f)},${16+a*Math.sin(f)}`)}return`<polygon points="${c.join(" ")}" fill="${e}" stroke="${o}" stroke-width="${i}" stroke-linejoin="round"/>`},dot:({backgroundColor:e,borderColor:t})=>`<circle cx="16" cy="16" r="5" fill="${e}" stroke="${t==="none"?"none":t||"#fff"}" stroke-width="${t==="none"?0:1.5}"/>`,none:()=>""},Hh={water:(e="#fff")=>`<path d="M16 8 C16 8 10 14 10 18 C10 21.3 12.7 24 16 24 C19.3 24 22 21.3 22 18 C22 14 16 8 16 8Z" fill="${e}"/>`,food:(e="#fff")=>`<path d="M11 9v6c0 1.1.9 2 2 2h1v7h2v-7h1c1.1 0 2-.9 2-2V9h-2v5h-1V9h-2v5h-1V9h-2z" fill="${e}"/>
      <path d="M21 9v14h2V9h-2z" fill="${e}"/>`,medical:(e="#fff")=>`<rect x="14" y="8" width="4" height="16" rx="1" fill="${e}"/>
      <rect x="8" y="14" width="16" height="4" rx="1" fill="${e}"/>`,photo:(e="#fff",t="#667eea")=>`<rect x="8" y="10" width="16" height="12" rx="2" fill="${e}"/>
      <circle cx="16" cy="16" r="3.5" fill="${t}"/>
      <circle cx="21" cy="13" r="1" fill="${t}"/>`,music:(e="#fff")=>`<ellipse cx="12" cy="21" rx="2.5" ry="2" fill="${e}"/>
      <rect x="14" y="10" width="2" height="9" fill="${e}"/>
      <rect x="14" y="10" width="6" height="2" fill="${e}"/>`,start:(e="#fff")=>`<path d="M11 8v16l2-2V10l7 6-7 6v-4l-2 2v4l12-10-12-10v4z" fill="${e}"/>`,finish:(e="#fff")=>`<rect x="10" y="8" width="4" height="4" fill="${e}"/>
      <rect x="14" y="12" width="4" height="4" fill="${e}"/>
      <rect x="18" y="8" width="4" height="4" fill="${e}"/>
      <rect x="10" y="16" width="4" height="4" fill="${e}"/>
      <rect x="18" y="16" width="4" height="4" fill="${e}"/>
      <rect x="14" y="20" width="4" height="4" fill="${e}"/>`,toilet:(e="#fff",t="#667eea")=>`<rect x="11" y="7" width="10" height="3" rx="1" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="6" ry="5" fill="${e}"/>
      <ellipse cx="16" cy="15" rx="4" ry="3" fill="${t}"/>
      <path d="M12 19 Q16 24 20 19" stroke="${e}" stroke-width="2" fill="none" stroke-linecap="round"/>`,shower:(e="#fff")=>`<circle cx="16" cy="10" r="3" fill="${e}"/>
      <path d="M11 14h10l-1 4h-8l-1-4z" fill="${e}"/>
      <line x1="12" y1="19" x2="12" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="14.5" y1="19" x2="14.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="17.5" y1="19" x2="17.5" y2="24" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <line x1="20" y1="19" x2="20" y2="23" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>`,bus:(e="#fff",t="#667eea")=>`<rect x="9" y="9" width="14" height="12" rx="2" fill="${e}"/>
      <rect x="10" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="17" y="11" width="5" height="4" rx="0.5" fill="${t}"/>
      <rect x="9" y="17" width="14" height="2" fill="${e}"/>
      <circle cx="12" cy="21" r="1.5" fill="${e}"/>
      <circle cx="20" cy="21" r="1.5" fill="${e}"/>`,info:(e="#fff")=>`<circle cx="16" cy="10" r="2" fill="${e}"/>
      <rect x="14" y="14" width="4" height="10" rx="1" fill="${e}"/>`,merch:(e="#fff")=>`<path d="M10 10 L13 10 L16 13 L19 10 L22 10 L22 14 L20 14 L20 24 L12 24 L12 14 L10 14 Z" fill="${e}"/>
      <path d="M13 10 L16 7 L19 10" stroke="${e}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`,cone:(e="#fff",t="#667eea")=>`<path d="M16 6 L21 22 H11 L16 6Z" fill="${e}"/>
      <rect x="11" y="17" width="10" height="2" fill="${t}"/>
      <rect x="12" y="12" width="8" height="2" fill="${t}"/>
      <rect x="9" y="22" width="14" height="3" rx="1" fill="${e}"/>`,traffic:(e="#fff")=>`<rect x="12" y="6" width="8" height="20" rx="2" fill="${e}"/>
      <circle cx="16" cy="10" r="2" fill="#EF4444"/>
      <circle cx="16" cy="16" r="2" fill="#F59E0B"/>
      <circle cx="16" cy="22" r="2" fill="#10B981"/>`,car:(e="#fff",t="#667eea")=>`<rect x="6" y="13" width="20" height="8" rx="2" fill="${e}"/>
      <path d="M10 13 L12 9 L20 9 L22 13" fill="${e}" stroke="${e}" stroke-width="1"/>
      <path d="M11 12 L12.5 9.5 L15 9.5 L15 12 Z" fill="${t}"/>
      <path d="M17 12 L17 9.5 L19.5 9.5 L21 12 Z" fill="${t}"/>
      <circle cx="10" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="22" cy="21" r="2.5" fill="#1F2937" stroke="${e}" stroke-width="0.5"/>
      <circle cx="10" cy="21" r="1" fill="#9CA3AF"/>
      <circle cx="22" cy="21" r="1" fill="#9CA3AF"/>`,bike:(e="#fff")=>`<circle cx="9" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="23" cy="20" r="4" fill="none" stroke="${e}" stroke-width="2"/>
      <circle cx="9" cy="20" r="1" fill="${e}"/>
      <circle cx="23" cy="20" r="1" fill="${e}"/>
      <path d="M9 20 L16 12 L23 20 M16 12 L16 20 L9 20" fill="none" stroke="${e}" stroke-width="2" stroke-linejoin="round"/>
      <path d="M16 12 L18 10 M16 12 L14 10" fill="none" stroke="${e}" stroke-width="1.5" stroke-linecap="round"/>
      <ellipse cx="12" cy="13" rx="2" ry="1" fill="${e}"/>`,"arrow-uturn-left":(e="#fff")=>`<path d="M20 24 L20 11 C20 7 12 7 12 11 L12 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7 15 L12 21 L17 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-left":(e="#fff")=>`<path d="M14 8 L6 16 L14 24 L14 19 L26 19 L26 13 L14 13 L14 8Z" fill="${e}"/>`,"arrow-slight-left":(e="#fff")=>`<g transform="rotate(-30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-straight":(e="#fff")=>`<path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>`,"arrow-slight-right":(e="#fff")=>`<g transform="rotate(30 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-right":(e="#fff")=>`<path d="M18 8 L26 16 L18 24 L18 19 L6 19 L6 13 L18 13 L18 8Z" fill="${e}"/>`,"arrow-uturn-right":(e="#fff")=>`<path d="M12 24 L12 11 C12 7 20 7 20 11 L20 18" fill="none" stroke="${e}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 15 L20 21 L25 15" fill="${e}" stroke="${e}" stroke-width="1" stroke-linejoin="round"/>`,"arrow-fork-left":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Left arrowhead -->
      <path d="M10 12 L6 10 L8 16 Z" fill="${e}"/>
      <!-- Wrong way indicator on right -->
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M20 8 L24 12 M24 8 L20 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>`,"arrow-fork-right":(e="#fff")=>`<rect x="14" y="18" width="4" height="8" fill="${e}"/>
      <!-- Wrong way indicator on left -->
      <path d="M16 18 L10 12" stroke="${e}" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
      <path d="M8 8 L12 12 M12 8 L8 12" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 18 L22 12" stroke="${e}" stroke-width="4" stroke-linecap="round"/>
      <!-- Right arrowhead -->
      <path d="M22 12 L26 10 L24 16 Z" fill="${e}"/>`,"arrow-keep-left":(e="#fff")=>`<g transform="rotate(-150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,"arrow-keep-right":(e="#fff")=>`<g transform="rotate(150 16 16)">
        <path d="M16 6 L8 14 L13 14 L13 26 L19 26 L19 14 L24 14 L16 6Z" fill="${e}"/>
      </g>`,track:(e="#fff")=>`
      <rect x="10" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="19.5" y="7" width="2.5" height="18" fill="${e}"/>
      <rect x="8" y="9" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="14.5" width="16" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="8" y="20" width="16" height="2.5" rx="0.5" fill="${e}"/>`,tunnel:(e="#fff")=>`
      <path d="M7 25 L7 14 C7 8 11 5 16 5 C21 5 25 8 25 14 L25 25" fill="none" stroke="${e}" stroke-width="2.5"/>
      <path d="M11 25 L11 16 C11 12 13 10 16 10 C19 10 21 12 21 16 L21 25" fill="none" stroke="${e}" stroke-width="1.5" opacity="0.6"/>`,bridge:(e="#fff")=>`
      <rect x="5" y="18" width="22" height="2.5" rx="0.5" fill="${e}"/>
      <rect x="7" y="10" width="2" height="8" fill="${e}"/>
      <rect x="23" y="10" width="2" height="8" fill="${e}"/>
      <path d="M8 10 Q16 6 24 10" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <line x1="12" y1="13" x2="12" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="16" y1="11.5" x2="16" y2="18" stroke="${e}" stroke-width="1.5"/>
      <line x1="20" y1="13" x2="20" y2="18" stroke="${e}" stroke-width="1.5"/>`,plane:(e="#fff")=>`
      <g fill="${e}">
        <!-- Fuselage body -->
        <path d="M27 16 L24 14 L8 14 Q4 16 8 18 L24 18 L27 16 Z"/>
        <!-- Nose cone -->
        <path d="M8 14 Q4 16 8 18 L8 14 Z"/>
        <!-- Tail fin -->
        <path d="M26 14 L26 9 L22 14 Z"/>
        <!-- Main wing -->
        <path d="M20 16 L16 10 L14 10 L16 16 L14 22 L16 22 L20 16 Z"/>
        <!-- Cockpit window -->
        <ellipse cx="10" cy="16" rx="1.5" ry="1" fill="none" stroke="${e}" stroke-width="0.5" opacity="0.6"/>
      </g>`,hill:(e="#fff")=>`
      <path d="M6 24 L13 12 L16 16 L20 10 L26 24 Z" fill="${e}"/>
      <path d="M20 10 L22 13 L18 13 Z" fill="${e}" opacity="0.6"/>`,baggage:(e="#fff")=>`
      <rect x="8" y="12" width="16" height="12" rx="2" fill="${e}"/>
      <rect x="12" y="8" width="8" height="4" rx="1" fill="none" stroke="${e}" stroke-width="2"/>
      <line x1="12" y1="16" x2="20" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>
      <line x1="12" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" opacity="0.3"/>`,crown:(e="#fff")=>`
      <path d="M8 21 L8 14 L12 17 L16 11 L20 17 L24 14 L24 21 Z" fill="${e}"/>
      <rect x="8" y="21" width="16" height="3" rx="1" fill="${e}"/>`,crossing:(e="#fff")=>`
      <!-- Crossing stripes -->
      <rect x="6" y="22" width="20" height="2" fill="${e}" opacity="0.5"/>
      <rect x="6" y="25" width="20" height="2" fill="${e}" opacity="0.5"/>
      <!-- Walking pedestrian -->
      <circle cx="16" cy="7" r="2.5" fill="${e}"/>
      <path d="M16 10 L16 16" stroke="${e}" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M13 13 L19 13" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L13 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>
      <path d="M16 16 L19 22" stroke="${e}" stroke-width="2" stroke-linecap="round"/>`,trees:(e="#fff")=>`
      <path d="M10 22 L10 18 L7 18 L11 12 L8 12 L11 7 L14 12 L11 12 L15 18 L12 18 L12 22 Z" fill="${e}"/>
      <path d="M20 22 L20 18 L17 18 L21 12 L18 12 L21 7 L24 12 L21 12 L25 18 L22 18 L22 22 Z" fill="${e}"/>`};function fn({type:e,backgroundShape:t="circle",backgroundColor:o,borderColor:i,iconColor:s,size:a="100",outputSize:c=null}){if(!e||e==="default"){if(!(o||i||s||t&&t!=="circle"&&t!=="default"))return null;e=t&&t!=="default"?t:"circle"}const u=Xi(e),d=parseInt(a,10)/100,f=c||Math.round(32*d);let p="";if(u.isShapeOnly){const g=o||u.defaultColor||"#667eea",k=i||"#fff";if(La[e])p=La[e]({backgroundColor:g,borderColor:k});else return hu[e]?.(g,f)||null}else{const g=o||"#667eea",k=i||"#fff",_=s||"#fff",b=t||"circle";b!=="none"&&La[b]&&(p+=La[b]({backgroundColor:g,borderColor:k})),Hh[e]&&(p+=Hh[e](_,g))}return`<svg width="${f}" height="${f}" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
    ${p}
  </svg>`}const z0={full:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#10B981" stroke="#fff" stroke-width="1.5"/>
    <path d="M4 7l2 2 4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </svg>`,partial:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#F59E0B" stroke="#fff" stroke-width="1.5"/>
    <rect x="6" y="3.5" width="2" height="4.5" rx="1" fill="#fff"/>
    <circle cx="7" cy="10" r="1" fill="#fff"/>
  </svg>`,missing:`<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">
    <circle cx="7" cy="7" r="6" fill="#EF4444" stroke="#fff" stroke-width="1.5"/>
    <path d="M4.5 4.5l5 5M9.5 4.5l-5 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
  </svg>`};function H0(e,t){return e===0?"missing":e>=t?"full":"partial"}function fu(e,t){const o=H0(e,t);return z0[o]}function V0(e,t,o=32){if(e==="default")return null;if(zh[e])return zh[e](o);if(hu[e]){const i=t||"#667eea";return hu[e](i,o)}return null}const G0=["circle","square","hexagon","pentagon"];function Z0(e){return G0.includes(e)}function j0(e,t,o,i,s=32,a=!0){const c=V0(e,t,s),u=fu(o,i);if(!c)return null;const d=a&&Z0(e),f=U0(e,t),p=W0(f),g=kv(f)?"0 1px 2px rgba(255,255,255,0.5)":"0 1px 2px rgba(0,0,0,0.5)",k=s>=36?"12px":"10px",_=d?`
    <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: ${p};
      font-weight: bold;
      font-size: ${k};
      text-shadow: ${g};
      pointer-events: none;
    ">${o}/${i}</div>
  `:"";return`
    <div style="position: relative; width: ${s}px; height: ${s}px;">
      ${c}
      ${_}
      <div style="position: absolute; bottom: -4px; right: -4px;">
        ${u}
      </div>
    </div>
  `}function q0(e){const t=e.replace("#",""),o=parseInt(t.substr(0,2),16)/255,i=parseInt(t.substr(2,2),16)/255,s=parseInt(t.substr(4,2),16)/255,a=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),c=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*a+.7152*c+.0722*u}function kv(e){return!e||e.length<6?!1:q0(e)>.4}function W0(e){return kv(e)?"#1F2937":"#FFFFFF"}const K0={class:"map-container-wrapper"},Y0="#667eea",J0={__name:"MapView",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},clickable:{type:Boolean,default:!1},areas:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1},editingPolygon:{type:Array,default:null},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","polygon-complete","polygon-drawing","polygon-update","visibility-change"],setup(e,{expose:t,emit:o}){const i=e,s=o,a=T(null);let c=null;const u=T([]),d=T([]),f=T([]);let p=null,g=null;const k=T([]);let _=null,b=null,C=!1;const E=T(!1),D=()=>{if(c){const oe=c.getCenter();return{lat:oe.lat,lng:oe.lng}}return null},M=()=>c?c.getZoom():null,S=()=>{if(u.value.length>0){f.value.push([...u.value]);const oe=d.value.pop()||[];u.value=oe,ue(),s("polygon-drawing",u.value)}},$=()=>{if(f.value.length>0){d.value.push([...u.value]);const oe=f.value.pop();u.value=oe,ue(),s("polygon-drawing",u.value)}},A=()=>u.value.length>0,U=()=>f.value.length>0,I=()=>u.value.length,H=()=>{u.value.length>=3&&(s("polygon-complete",[...u.value]),O())},O=()=>{u.value=[],d.value=[],f.value=[],ue()},q=()=>{!c||!i.userLocation||(c.setView([i.userLocation.lat,i.userLocation.lng],c.getZoom(),{animate:!0,duration:.5}),E.value=!0)},V=(oe,ve,se=null)=>{if(!c||oe==null||ve==null)return;c.setView([oe,ve],se??c.getZoom(),{animate:!0,duration:.5});const te=i.center&&Math.abs(i.center.lat-oe)<1e-4&&Math.abs(i.center.lng-ve)<1e-4;E.value=!te},Q=T(!0),de=T(!0),Ee=(oe,ve)=>{if(!c||oe==null||ve==null)return!0;const se=c.getBounds(),te=Gt.latLng(oe,ve);return se.contains(te)};t({getMapCenter:D,getMapZoom:M,undoPolygonPoint:S,redoPolygonPoint:$,canUndo:A,canRedo:U,getPolygonPointCount:I,completePolygon:H,clearPolygonDrawing:O,recenterOnUserLocation:q,recenterOnLocation:V,isLocationInView:Ee,userLocationInView:de,highlightedLocationInView:Q});const ge=T([]);let Pe=null;const Fe=T(!0),ce=T(!1),Me=T(new Set),ke=T([]);let re=null,Re=null;const Je=Z(()=>i.hideRecenterButton||!i.highlightLocationId||!E.value?!1:!Q.value),tt=()=>{if(i.highlightLocationId){const oe=i.locations.find(ve=>ve.id===i.highlightLocationId);if(oe?.latitude&&oe?.longitude){Q.value=Ee(oe.latitude,oe.longitude);return}}if(i.highlightLocationIds&&i.highlightLocationIds.length>0){const oe=i.highlightLocationIds[0],ve=i.locations.find(se=>se.id===oe);if(ve?.latitude&&ve?.longitude){Q.value=Ee(ve.latitude,ve.longitude);return}}if(!c){Q.value=!0;return}Q.value=!0},qe=()=>{if(!c||!i.userLocation){de.value=!0;return}de.value=Ee(i.userLocation.lat,i.userLocation.lng)},Qe=()=>{tt(),qe(),s("visibility-change",{userLocationInView:de.value,highlightedLocationInView:Q.value})},be=()=>{if(!c||!i.highlightLocationId)return;const oe=i.locations.find(ve=>ve.id===i.highlightLocationId);!oe||!oe.latitude||!oe.longitude||(c.setView([oe.latitude,oe.longitude],c.getZoom(),{animate:!0,duration:.5}),E.value=!1,Q.value=!0)},ze=(oe,ve,se,te,X=!1)=>{const N=se?"36px":te?"20px":"30px",K=se?"#667eea":"white",ee=X?"":fu(oe,ve);return`
    <div style="position: relative; width: ${N}; height: ${N};">
      <div style="
        background-color: ${Y0};
        width: ${N};
        height: ${N};
        border-radius: 50%;
        border: 3px solid ${K};
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      "></div>
      ${X?"":`<div style="position: absolute; bottom: -4px; right: -4px;">
        ${ee}
      </div>`}
    </div>
  `},fe=()=>{if(!c)return;const oe=B0(c,ge.value),ve=Array.from(Me.value).sort().join(","),se=Array.from(oe).sort().join(",");ve!==se&&(Me.value=oe,Te())},Le=()=>{if(Re&&(Re.remove(),Re=null),!c||!i.userLocation)return;const oe=Gt.divIcon({className:"user-location-marker",html:`
      <div style="
        position: relative;
        width: 20px;
        height: 20px;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          background-color: #4285f4;
          border: 3px solid white;
          border-radius: 50%;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        "></div>
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 40px;
          height: 40px;
          background-color: rgba(66, 133, 244, 0.2);
          border-radius: 50%;
          animation: pulse 2s ease-out infinite;
        "></div>
      </div>
    `,iconSize:[40,40],iconAnchor:[20,20]});Re=Gt.marker([i.userLocation.lat,i.userLocation.lng],{icon:oe}).addTo(c).bindPopup("Your location")},Ae=()=>{if(!a.value)return;let oe=51.505,ve=-.09,se=13;const te=i.allLocationsForBounds.length>0?i.allLocationsForBounds:i.locations,X=(K,ee)=>K!=null&&ee!=null&&!(K===0&&ee===0),N=[];te.length>0&&N.push(...te.filter(K=>X(K.latitude,K.longitude)).map(K=>({lat:K.latitude,lng:K.longitude}))),i.route&&i.route.length>0&&N.push(...i.route.filter(K=>X(K.lat,K.lng)).map(K=>({lat:K.lat,lng:K.lng}))),i.center?(oe=i.center.lat,ve=i.center.lng,se=i.zoom??13):N.length>0&&(oe=N.reduce((K,ee)=>K+ee.lat,0)/N.length,ve=N.reduce((K,ee)=>K+ee.lng,0)/N.length,se=10),c=Gt.map(a.value).setView([oe,ve],se),Gt.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(c),i.clickable&&c.on("click",K=>{i.drawingMode||s("map-click",{lat:K.latlng.lat,lng:K.latlng.lng})}),c.on("zoomstart",()=>{De=!0}),c.on("zoomend moveend",()=>{De=!1,he?Te():fe(),Qe()}),c.on("dragstart",()=>{E.value=!0}),Te(),W(),J(),Le(),ie(),ae()},W=()=>{if(Pe&&(Pe.remove(),Pe=null),!c||i.route.length===0)return;const oe=i.route.map(ve=>[ve.lat,ve.lng]);Pe=Gt.polyline(oe,{color:"blue",weight:4,opacity:.7}).addTo(c)},J=()=>{ke.value.forEach(oe=>oe.remove()),ke.value=[],!(!c||i.areas.length===0)&&i.areas.forEach(oe=>{const ve=typeof oe.polygon=="string"?JSON.parse(oe.polygon):oe.polygon;if(!ve||ve.length===0)return;const se=ve.map(K=>[K.lat,K.lng]),te=oe.id===i.selectedAreaId,X=oe.color||"#667eea",N=Gt.polygon(se,{color:X,fillColor:X,fillOpacity:te?.4:.2,weight:te?3:2,opacity:.8}).addTo(c);N.setStyle({pane:"overlayPane"}),i.drawingMode||(N.on("click",()=>s("area-click",oe)),N.on("mouseover",()=>{N.setStyle({fillOpacity:.4})}),N.on("mouseout",()=>{N.setStyle({fillOpacity:te?.4:.2})})),ke.value.push(N)})},ue=()=>{if(c&&(p&&(p.remove(),p=null),g&&(g.remove(),g=null),u.value.length!==0&&(g=Gt.layerGroup().addTo(c),u.value.forEach((oe,ve)=>{const se=ve===0,te=ve===u.value.length-1,X=Gt.divIcon({className:"polygon-point-marker",html:`<div style="
        width: ${se?"16px":"12px"};
        height: ${se?"16px":"12px"};
        background-color: ${se?"#667eea":te?"#ff9800":"white"};
        border: 3px solid #667eea;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      "></div>`,iconSize:[se?16:12,se?16:12],iconAnchor:[se?8:6,se?8:6]});Gt.marker([oe.lat,oe.lng],{icon:X,interactive:!1}).addTo(g)}),u.value.length>=2))){const oe=u.value.map(ve=>[ve.lat,ve.lng]);u.value.length>=3&&oe.push(oe[0]),p=Gt.polyline(oe,{color:"#667eea",weight:3,opacity:.8,dashArray:u.value.length<3?"10, 10":null}).addTo(c)}},ye=()=>{if(!c||(_&&(_.remove(),_=null),b&&(b.remove(),b=null),k.value.length===0))return;const oe=k.value.map(se=>[se.lat,se.lng]);_=Gt.polygon(oe,{color:"#667eea",fillColor:"#667eea",fillOpacity:.2,weight:3,opacity:.8,pane:"overlayPane"}).addTo(c),_.bringToFront(),b=Gt.layerGroup({pane:"markerPane"}).addTo(c);const ve=se=>{k.value.length<=3||(k.value.splice(se,1),C=!0,s("polygon-update",[...k.value]),ye())};k.value.forEach((se,te)=>{const X=k.value.length>3,N=Gt.divIcon({className:"polygon-edit-marker",html:`<div class="vertex-marker" style="
        position: relative;
        width: 16px;
        height: 16px;
        background-color: #667eea;
        border: 3px solid white;
        border-radius: 50%;
        box-shadow: 0 2px 6px rgba(0,0,0,0.4);
        cursor: move;
      "></div>`,iconSize:[16,16],iconAnchor:[8,8]}),K=Gt.marker([se.lat,se.lng],{icon:N,draggable:!0}).addTo(b);if(K.on("drag",ee=>{const $e=ee.target.getLatLng();k.value[te]={lat:$e.lat,lng:$e.lng};const We=k.value.map(ot=>[ot.lat,ot.lng]);_.setLatLngs(We)}),K.on("dragend",()=>{C=!0,s("polygon-update",[...k.value])}),K.on("contextmenu",ee=>{Gt.DomEvent.preventDefault(ee),X&&ve(te)}),X){const ee=document.createElement("div"),$e=document.createElement("button");$e.textContent="Delete point",$e.style.cssText=`
        background: #dc3545;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9rem;
      `;const We=ot=>{ot.preventDefault(),ot.stopPropagation(),K.closePopup(),ve(te)};$e.addEventListener("click",We),$e.addEventListener("touchend",We),ee.appendChild($e),K.bindPopup(ee,{closeButton:!1,className:"vertex-popup"})}})},ae=(oe=!0)=>{if(c){if(!i.editingPolygon||i.editingPolygon.length===0){_&&(_.remove(),_=null),b&&(b.remove(),b=null),k.value=[];return}if(k.value=i.editingPolygon.map(ve=>({lat:ve.lat,lng:ve.lng})),ye(),oe&&k.value.length>=3){const ve=Gt.latLngBounds(k.value.map(se=>[se.lat,se.lng]));c.fitBounds(ve,{padding:[50,50]})}}},ie=()=>{if(!c)return;if(re||(re=new Gt.FeatureGroup,c.addLayer(re)),c._customDrawingHandlers&&(c.off("click",c._customDrawingHandlers.handleClick),c.getContainer().removeEventListener("touchstart",c._customDrawingHandlers.handleTouchStart),c.getContainer().removeEventListener("touchend",c._customDrawingHandlers.handleTouchEnd),c.getContainer().removeEventListener("touchmove",c._customDrawingHandlers.handleTouchMove),delete c._customDrawingHandlers),!i.drawingMode){O(),re&&re.clearLayers();return}let oe=0,ve=null,se=!1,te=!1;const X=300,N=15,K=st=>{d.value.push([...u.value]),f.value=[],u.value.push({lat:st.lat,lng:st.lng}),ue(),s("polygon-drawing",u.value)},ee=st=>{st.originalEvent&&st.originalEvent.sourceCapabilities?.firesTouchEvents||K(st.latlng)},$e=st=>{if(st.touches.length>1){te=!0;return}te=!1,oe=Date.now(),ve={x:st.touches[0].clientX,y:st.touches[0].clientY},se=!1},We=st=>{if(!ve||te)return;const Ct=st.touches[0].clientX-ve.x,St=st.touches[0].clientY-ve.y;Math.sqrt(Ct*Ct+St*St)>N&&(se=!0)},ot=st=>{if(te){te=!1,ve=null;return}if(Date.now()-oe<X&&!se&&ve){const St=st.changedTouches[0],At=Gt.point(St.clientX-c.getContainer().getBoundingClientRect().left,St.clientY-c.getContainer().getBoundingClientRect().top),Kt=c.containerPointToLatLng(At);st.preventDefault(),st.stopPropagation(),K(Kt)}ve=null,se=!1};c.on("click",ee),c.getContainer().addEventListener("touchstart",$e,{passive:!0}),c.getContainer().addEventListener("touchmove",We,{passive:!0}),c.getContainer().addEventListener("touchend",ot,{passive:!1}),c._customDrawingHandlers={handleClick:ee,handleTouchStart:$e,handleTouchMove:We,handleTouchEnd:ot},ue()};let he=!1,De=!1;const Te=()=>{if(c&&(c._animatingZoom||De)){he=!0;return}if(he=!1,ge.value.forEach(se=>{se._map&&(se.off(),se.remove())}),ge.value=[],!c)return;const oe=a.value?.clientWidth||400,ve=Math.floor(oe*.75);if(i.locations.forEach(se=>{const te=se.latitude??se.Latitude,X=se.longitude??se.Longitude;if(te==null||X==null||te===0&&X===0)return;const N=se.checkedInCount||0,K=se.requiredMarshals||1,ee=i.highlightLocationId===se.id||i.highlightLocationIds.includes(se.id),$e=i.simplifyNonHighlighted&&!ee,We=se.resolvedStyleType||se.ResolvedStyleType,ot=se.resolvedStyleBackgroundColor||se.ResolvedStyleBackgroundColor||se.resolvedStyleColor||se.ResolvedStyleColor,st=se.resolvedStyleBorderColor||se.ResolvedStyleBorderColor,Ct=se.resolvedStyleIconColor||se.ResolvedStyleIconColor,St=se.resolvedStyleBackgroundShape||se.ResolvedStyleBackgroundShape,At=We&&We!=="default"||ot||st||Ct||St&&St!=="circle"&&St!=="default",Kt=se.resolvedStyleMapRotation??se.ResolvedStyleMapRotation??se.styleMapRotation??se.StyleMapRotation??0,an=parseInt(Kt,10)||0,Hn=se.areaColor||"#999",An=se.areaId&&!i.marshalMode,gt=Me.value.has(se.id)&&se.description?`${se.name}: ${_v(se.description,50)}`:se.name,tn=ee?`
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid #667eea;
        border-radius: 50%;
        animation: highlight-pulse 1.5s ease-out infinite;
      "></div>
    `:"",vn=ee?"#667eea":$e?"#e0e0e0":"white",to=ee?"white":$e?"#888":"#333";let En;if($e){const To="20px";En=`
        <div style="
          background-color: #999;
          width: ${To};
          height: ${To};
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        "></div>
      `}const Yt=!i.marshalMode,Yo=fu(N,K),ln=Yt?`<div style="
      position: absolute;
      bottom: -2px;
      right: -6px;
      background-color: white;
      border-radius: 8px;
      padding: 1px 4px;
      font-size: 9px;
      font-weight: bold;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
    ">${N}/${K}</div>`:"";if(!$e&&At){const To=ee?40:32,Vt=se.resolvedStyleSize||se.ResolvedStyleSize||"100",et=fn({type:se.resolvedStyleType||se.ResolvedStyleType,backgroundShape:se.resolvedStyleBackgroundShape||se.ResolvedStyleBackgroundShape||"circle",backgroundColor:se.resolvedStyleBackgroundColor||se.ResolvedStyleBackgroundColor||se.resolvedStyleColor||se.ResolvedStyleColor||"",borderColor:se.resolvedStyleBorderColor||se.ResolvedStyleBorderColor||"",iconColor:se.resolvedStyleIconColor||se.ResolvedStyleIconColor||"",size:Vt});et?En=et:En=j0(se.resolvedStyleType,se.resolvedStyleColor,N,K,To,Yt)||ze(N,K,ee,i.marshalMode,!0)}else $e||(En=ze(N,K,ee,i.marshalMode,!0));const no=an!==0?`transform: rotate(${an}deg);`:"",Nt=Gt.divIcon({className:"custom-marker",html:`
        <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
          ${tn}
          <div style="position: relative; display: flex; align-items: center; gap: 4px;">
            ${An?`<div style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background-color: ${Hn};
              border: 2px solid white;
              box-shadow: 0 1px 2px rgba(0,0,0,0.3);
            "></div>`:""}
            <div style="position: relative; display: inline-block;">
              <div style="${no}">
                ${En}
              </div>
              ${$e?"":`<div style="position: absolute; top: -4px; right: -4px;">
                ${Yo}
              </div>`}
              ${$e?"":ln}
            </div>
          </div>
          <div style="
            background-color: ${vn};
            padding: 2px 6px;
            border-radius: 3px;
            font-size: ${ee?"12px":"11px"};
            font-weight: bold;
            color: ${to};
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: ${ve}px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            margin-top: 2px;
          ">
            ${gt}
          </div>
        </div>
      `,iconSize:[30,50],iconAnchor:[15,25]}),Vn=i.marshalMode?`<b>${se.name}</b>${se.description?`<br>${se.description}`:""}`:`<b>${se.name}</b><br>${se.description||""}<br>Checked in: ${N}/${K}`,rn=Gt.marker([se.latitude,se.longitude],{icon:Nt}).addTo(c).bindPopup(Vn);rn.on("click",()=>{s("location-click",se)}),rn.locationData=se,ge.value.push(rn)}),c&&Fe.value&&!i.center&&!ce.value){const se=[],te=i.allLocationsForBounds.length>0?i.allLocationsForBounds:i.locations,X=(N,K)=>N!=null&&K!=null&&!(N===0&&K===0);if(te.length>0&&se.push(...te.filter(N=>X(N.latitude,N.longitude)).map(N=>[N.latitude,N.longitude])),i.route.length>0&&se.push(...i.route.filter(N=>X(N.lat,N.lng)).map(N=>[N.lat,N.lng])),se.length>0){const N=Gt.latLngBounds(se);c.fitBounds(N,{padding:[50,50]}),Fe.value=!1,ce.value=!0}}else i.center&&(Fe.value=!1);setTimeout(()=>{c&&!c._animatingZoom&&fe()},100)};return Wt(()=>{ce.value=!1,Fe.value=!0,Ae();let oe,ve=0,se=0;const te=new ResizeObserver(X=>{if(c&&X.length>0){const{width:N,height:K}=X[0].contentRect;(Math.abs(N-ve)>10||Math.abs(K-se)>10)&&(ve=N,se=K,clearTimeout(oe),oe=setTimeout(()=>{c.invalidateSize()},150))}});a.value&&te.observe(a.value),zn(()=>{clearTimeout(oe),te.disconnect()})}),Ge(()=>i.locations,oe=>{if(Te(),c&&!ce.value&&oe.length>0&&!i.center){const ve=oe.map(N=>N.latitude),se=oe.map(N=>N.longitude),te=ve.reduce((N,K)=>N+K,0)/ve.length,X=se.reduce((N,K)=>N+K,0)/se.length;c.setView([te,X],10),ce.value=!0,Fe.value=!1}},{deep:!0}),Ge(()=>i.route,oe=>{if(W(),Te(),c&&!ce.value&&oe&&oe.length>0&&!i.center){const ve=oe.map(N=>N.lat),se=oe.map(N=>N.lng),te=ve.reduce((N,K)=>N+K,0)/ve.length,X=se.reduce((N,K)=>N+K,0)/se.length;c.setView([te,X],10),ce.value=!0,Fe.value=!1}},{deep:!0}),Ge(()=>i.center,(oe,ve)=>{c&&!E.value&&(!ve||Math.abs(oe.lat-ve.lat)>1e-6||Math.abs(oe.lng-ve.lng)>1e-6)&&c.setView([oe.lat,oe.lng],i.zoom)}),Ge(()=>i.areas,()=>{J()},{deep:!0}),Ge(()=>i.selectedAreaId,()=>{J()}),Ge(()=>i.drawingMode,()=>{ie()}),Ge(()=>i.editingPolygon,()=>{if(C){C=!1;return}ae()},{deep:!0}),Ge(()=>i.userLocation,()=>{Le()},{deep:!0}),Ge(()=>i.highlightLocationId,()=>{Te()}),Ge(()=>i.highlightLocationIds,()=>{Te()},{deep:!0}),Ge(()=>i.marshalMode,()=>{Te()}),Ge(()=>i.simplifyNonHighlighted,()=>{Te()}),Ge(()=>i.clickable,oe=>{c&&(c.off("click"),oe&&c.on("click",ve=>{i.drawingMode||s("map-click",{lat:ve.latlng.lat,lng:ve.latlng.lng})}))}),(oe,ve)=>(v(),m("div",K0,[l("div",{ref_key:"mapContainer",ref:a,class:"map-container"},null,512),Je.value?(v(),m("button",{key:0,class:"recenter-btn",onClick:be,title:"Recenter on checkpoint"},[...ve[0]||(ve[0]=[l("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18"},[l("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),l("span",null,"Recenter",-1)])])):P("",!0)]))}},pu=je(J0,[["__scopeId","data-v-1730680b"]]);function Zs(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}const X0={class:"areas-selection"},Q0={key:0,class:"areas-selection-header"},ew={class:"areas-list"},tw=["checked","onChange"],nw={__name:"AreasSelection",props:{areas:{type:Array,default:()=>[]},selectedAreaIds:{type:Array,default:()=>[]}},emits:["update:selectedAreaIds"],setup(e,{emit:t}){const o=e,i=t,s=Z(()=>[...o.areas].sort((d,f)=>d.displayOrder!==f.displayOrder?d.displayOrder-f.displayOrder:Zs(d.name,f.name))),a=Z(()=>o.areas.length>0&&o.selectedAreaIds.length===o.areas.length),c=d=>{const f=[...o.selectedAreaIds],p=f.indexOf(d);p>=0?f.splice(p,1):f.push(d),i("update:selectedAreaIds",f)},u=()=>{a.value?i("update:selectedAreaIds",[]):i("update:selectedAreaIds",o.areas.map(d=>d.id))};return(d,f)=>(v(),m("div",X0,[e.areas.length>1?(v(),m("div",Q0,[l("button",{onClick:u,class:"toggle-all-btn"},w(a.value?"Deselect all":"Select all"),1)])):P("",!0),l("div",ew,[(v(!0),m(Se,null,Be(s.value,p=>(v(),m("label",{class:"area-checkbox",key:p.id},[l("input",{type:"checkbox",checked:e.selectedAreaIds.includes(p.id),onChange:g=>c(p.id)},null,40,tw),l("span",{class:"area-color-dot",style:rt({backgroundColor:p.color||"#667eea"})},null,4),Ke(" "+w(p.name),1)]))),128))])]))}},ow=je(nw,[["__scopeId","data-v-ba19009b"]]),sw={key:1,class:"toolbar-btn-wrapper filters-wrapper"},iw={key:1,class:"dropdown-content filters-dropdown"},aw={class:"filters-header"},lw={class:"filter-section"},rw={class:"filter-checkbox"},cw=["checked"],uw={class:"filter-section"},dw={class:"filter-checkbox"},hw=["checked"],fw={class:"filter-checkbox"},pw=["checked"],vw={class:"filter-checkbox"},mw=["checked"],gw={key:0,class:"filter-section"},yw=["onClick","title"],_w={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},kw={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},bw=["innerHTML"],ww={key:0,class:"dropdown-content action-dropdown"},Cw=["onClick"],Lw={__name:"MapToolbar",props:{showFullscreen:{type:Boolean,default:!1},showFilters:{type:Boolean,default:!1},filters:{type:Object,default:()=>({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},areas:{type:Array,default:()=>[]},actions:{type:Array,default:()=>[]},position:{type:String,default:"top-right",validator:e=>["top-right","top-left"].includes(e)}},emits:["fullscreen-click","filter-change","action-click"],setup(e,{expose:t,emit:o}){const{terms:i}=bt(),s=e,a=o,c=T(!1),u=T(null),d=Z(()=>u.value!==null),f=()=>{c.value=!c.value,c.value&&(u.value=null)},p=(b,C)=>{a("filter-change",{...s.filters,[b]:C})},g=b=>{b.items&&b.items.length>0?u.value===b.id?u.value=null:(u.value=b.id,c.value=!1):a("action-click",{actionId:b.id})},k=(b,C)=>{u.value=null,a("action-click",{actionId:b,itemId:C})};return t({closeDropdowns:()=>{c.value=!1,u.value=null}}),(b,C)=>(v(),m("div",{class:pe(["map-toolbar",[`position-${e.position}`]])},[e.showFullscreen?(v(),m("button",{key:0,class:"toolbar-btn",onClick:C[0]||(C[0]=E=>b.$emit("fullscreen-click")),title:"Fullscreen"},[...C[8]||(C[8]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})],-1)])])):P("",!0),e.showFilters&&!d.value?(v(),m("div",sw,[c.value?(v(),m("div",{key:0,class:"mobile-backdrop",onClick:C[1]||(C[1]=E=>c.value=!1)})):P("",!0),l("button",{class:pe(["toolbar-btn",{active:c.value}]),onClick:f,title:"Show/hide options"},[...C[9]||(C[9]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),l("circle",{cx:"12",cy:"12",r:"3"})],-1)])],2),c.value?(v(),m("div",iw,[l("div",aw,[C[11]||(C[11]=l("span",{class:"filters-title"},"Map filters",-1)),l("button",{class:"close-filters-btn",onClick:C[2]||(C[2]=E=>c.value=!1),title:"Close"},[...C[10]||(C[10]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])]),l("div",lw,[C[12]||(C[12]=l("h4",null,"Display",-1)),l("label",rw,[l("input",{type:"checkbox",checked:e.filters.showRoute,onChange:C[3]||(C[3]=E=>p("showRoute",E.target.checked))},null,40,cw),l("span",null,w(j(i).course)+" line",1)])]),l("div",uw,[l("h4",null,w(j(i).checkpoints),1),l("label",dw,[l("input",{type:"checkbox",checked:e.filters.showUncheckedIn,onChange:C[4]||(C[4]=E=>p("showUncheckedIn",E.target.checked))},null,40,hw),C[13]||(C[13]=l("span",{class:"status-indicator unchecked"},null,-1)),C[14]||(C[14]=l("span",null,"Unchecked-in",-1))]),l("label",fw,[l("input",{type:"checkbox",checked:e.filters.showPartiallyCheckedIn,onChange:C[5]||(C[5]=E=>p("showPartiallyCheckedIn",E.target.checked))},null,40,pw),C[15]||(C[15]=l("span",{class:"status-indicator partial"},null,-1)),C[16]||(C[16]=l("span",null,"Partially checked-in",-1))]),l("label",vw,[l("input",{type:"checkbox",checked:e.filters.showFullyCheckedIn,onChange:C[6]||(C[6]=E=>p("showFullyCheckedIn",E.target.checked))},null,40,mw),C[17]||(C[17]=l("span",{class:"status-indicator full"},null,-1)),C[18]||(C[18]=l("span",null,"Fully checked-in",-1))])]),e.areas.length>0?(v(),m("div",gw,[l("h4",null,w(j(i).areas),1),Oe(ow,{areas:e.areas,"selected-area-ids":e.filters.selectedAreaIds,"onUpdate:selectedAreaIds":C[7]||(C[7]=E=>p("selectedAreaIds",E))},null,8,["areas","selected-area-ids"])])):P("",!0)])):P("",!0)])):P("",!0),(v(!0),m(Se,null,Be(e.actions,E=>(v(),m("div",{key:E.id,class:pe(["toolbar-btn-wrapper",{hidden:c.value}])},[l("button",{class:pe(["toolbar-btn",{active:u.value===E.id}]),onClick:D=>g(E),title:E.label||E.id},[E.icon==="plus"?(v(),m("svg",_w,[...C[19]||(C[19]=[l("line",{x1:"12",y1:"5",x2:"12",y2:"19"},null,-1),l("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1)])])):E.icon==="edit"?(v(),m("svg",kw,[...C[20]||(C[20]=[l("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},null,-1),l("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1)])])):E.icon==="custom"?(v(),m("span",{key:2,innerHTML:E.customIcon},null,8,bw)):P("",!0)],10,yw),E.items&&u.value===E.id?(v(),m("div",ww,[(v(!0),m(Se,null,Be(E.items,D=>(v(),m("button",{key:D.id,onClick:M=>k(E.id,D.id),class:"dropdown-item"},w(D.label),9,Cw))),128))])):P("",!0)],2))),128))],2))}},Sw=je(Lw,[["__scopeId","data-v-d04b549d"]]),xw={key:0,class:"drawing-controls"},Iw={class:"point-count"},$w={class:"undo-redo-buttons"},Tw=["disabled"],Mw=["disabled"],Aw={__name:"MapDrawingControls",props:{pointCount:{type:Number,default:0},canUndo:{type:Boolean,default:!1},canRedo:{type:Boolean,default:!1},show:{type:Boolean,default:!0}},emits:["undo","redo"],setup(e,{emit:t}){const o=e,i=t,s=Z(()=>o.show&&o.pointCount>0),a=c=>{if(!s.value)return;const d=navigator.platform.toUpperCase().indexOf("MAC")>=0?c.metaKey:c.ctrlKey;d&&c.key==="z"&&!c.shiftKey?(c.preventDefault(),o.canUndo&&i("undo")):d&&(c.key==="y"||c.key==="z"&&c.shiftKey)&&(c.preventDefault(),o.canRedo&&i("redo"))};return Wt(()=>{document.addEventListener("keydown",a)}),zn(()=>{document.removeEventListener("keydown",a)}),(c,u)=>s.value?(v(),m("div",xw,[l("div",Iw,w(e.pointCount)+" point"+w(e.pointCount!==1?"s":""),1),l("div",$w,[l("button",{onClick:u[0]||(u[0]=d=>c.$emit("undo")),class:"btn-drawing undo-btn",disabled:!e.canUndo,title:"Undo last point (Ctrl+Z)"},"  Undo ",8,Tw),l("button",{onClick:u[1]||(u[1]=d=>c.$emit("redo")),class:"btn-drawing redo-btn",disabled:!e.canRedo,title:"Redo point (Ctrl+Y)"}," Redo  ",8,Mw)])])):P("",!0)}},Vh=je(Aw,[["__scopeId","data-v-6cd009cb"]]),Ew={class:"context-info"},Pw={class:"action-buttons"},Dw=["disabled"],Ow={key:0,class:"fullscreen-map-banner"},Rw={class:"fullscreen-map-container"},Bw={key:1,class:"fullscreen-map-footer"},Nw={__name:"MapFullscreenModal",props:{show:{type:Boolean,required:!0},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},title:{type:String,default:""},description:{type:String,default:""},canComplete:{type:Boolean,default:!1},headerStyle:{type:Object,default:()=>({})},headerTextColor:{type:String,default:""}},emits:["done","cancel","close"],setup(e,{emit:t}){const o=e,i=Z(()=>o.headerTextColor?{color:o.headerTextColor}:{}),s=t,a=()=>{s("done")},c=()=>{s("cancel")},u=()=>{s("close")},d=f=>{f.key==="Escape"&&o.show&&(o.mode==="view"?u():c())};return Ge(()=>o.show,f=>{f?(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"):(document.body.style.overflow="",document.documentElement.style.overflow="")},{immediate:!0}),Wt(()=>{document.addEventListener("keydown",d)}),zn(()=>{document.removeEventListener("keydown",d),document.body.style.overflow="",document.documentElement.style.overflow=""}),(f,p)=>(v(),Ye(Tu,{to:"body"},[e.show?(v(),m("div",{key:0,class:"fullscreen-map-overlay",onTouchmove:p[0]||(p[0]=ht(()=>{},["prevent","self"]))},[l("div",{class:"fullscreen-map-header",style:rt(e.headerStyle)},[l("div",Ew,[l("h3",{style:rt({color:e.headerTextColor})},w(e.title),5),e.description?(v(),m("p",{key:0,style:rt({color:e.headerTextColor,opacity:.85})},w(e.description),5)):P("",!0)]),l("div",Pw,[Jn(f.$slots,"actions",{},void 0),e.mode==="view"?(v(),m("button",{key:0,type:"button",onClick:ht(u,["stop"]),class:"btn btn-close-x",style:rt(i.value),title:"Close"},[...p[1]||(p[1]=[l("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"24",height:"24"},[l("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])],4)):(v(),m(Se,{key:1},[l("button",{type:"button",onClick:c,class:"btn btn-cancel"}," Cancel "),l("button",{type:"button",onClick:a,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,Dw)],64))])],4),f.$slots.banner?(v(),m("div",Ow,[Jn(f.$slots,"banner",{},void 0)])):P("",!0),l("div",Rw,[Jn(f.$slots,"default",{},void 0)]),f.$slots.footer?(v(),m("div",Bw,[Jn(f.$slots,"footer",{},void 0)])):P("",!0)],32)):P("",!0)]))}},Fw=je(Nw,[["__scopeId","data-v-b5d05af4"]]),Uw={class:"map-wrapper"},zw={class:"fullscreen-map-wrapper"},Hw={__name:"CommonMap",props:{locations:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},center:{type:Object,default:null},zoom:{type:Number,default:13},userLocation:{type:Object,default:null},highlightLocationId:{type:String,default:null},highlightLocationIds:{type:Array,default:()=>[]},allLocationsForBounds:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},marshalMode:{type:Boolean,default:!1},simplifyNonHighlighted:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},mode:{type:String,default:"view",validator:e=>["view","select-point","draw-polygon","edit-polygon"].includes(e)},editingPolygon:{type:Array,default:null},height:{type:String,default:"400px"},showFullscreen:{type:Boolean,default:!0},showFilters:{type:Boolean,default:!1},toolbarActions:{type:Array,default:()=>[]},toolbarPosition:{type:String,default:"top-right"},filters:{type:Object,default:()=>({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]})},fullscreenTitle:{type:String,default:""},fullscreenDescription:{type:String,default:""},fullscreenHeaderStyle:{type:Object,default:()=>({})},fullscreenHeaderTextColor:{type:String,default:""},hideRecenterButton:{type:Boolean,default:!1}},emits:["location-click","map-click","area-click","visibility-change","point-selected","polygon-complete","polygon-drawing","polygon-update","fullscreen-change","filter-change","action-click","fullscreen-done","fullscreen-cancel"],setup(e,{expose:t,emit:o}){const i=e,s=o,a=T(null),c=T(null),u=T(null),d=T(!1),f=T(0),p=T(!1),g=T(!1),k=T({...i.filters});Ge(()=>i.filters,ge=>{k.value={...ge}},{deep:!0}),Ge(()=>i.areas,ge=>{i.showFilters&&ge.length>0&&(!k.value.selectedAreaIds||k.value.selectedAreaIds.length===0)&&(k.value.selectedAreaIds=ge.map(Pe=>Pe.id))},{immediate:!0});const _=Z(()=>i.showFilters?i.locations.filter(ge=>{const Pe=ge.checkedInCount||0,Fe=ge.requiredMarshals||1,ce=Pe===0,Me=Pe>0&&Pe<Fe,ke=Pe>=Fe;if(ce&&!k.value.showUncheckedIn||Me&&!k.value.showPartiallyCheckedIn||ke&&!k.value.showFullyCheckedIn)return!1;const re=ge.areaIds||ge.AreaIds||[];return!(i.areas.length>0&&re.length>0&&(!k.value.selectedAreaIds||k.value.selectedAreaIds.length===0||!re.some(Je=>k.value.selectedAreaIds.includes(Je))))}):i.locations),b=Z(()=>i.showFilters?k.value.showRoute?i.route:[]:i.route),C=Z(()=>i.showFilters?k.value.selectedAreaIds&&k.value.selectedAreaIds.length>0?i.areas.filter(ge=>k.value.selectedAreaIds.includes(ge.id)):i.areas.length>0?[]:i.areas:i.areas),E=Z(()=>i.mode==="select-point"?!0:i.mode==="draw-polygon"?f.value>=3:!0),D=()=>d.value?c.value:a.value,M=()=>{d.value=!0,s("fullscreen-change",!0)},S=()=>{d.value=!1,s("fullscreen-change",!1)},$=()=>{if(i.mode==="draw-polygon"){const ge=D();ge&&ge.clearPolygonDrawing(),f.value=0,p.value=!1,g.value=!1}d.value=!1,s("fullscreen-cancel"),s("fullscreen-change",!1)},A=()=>{if(i.mode==="draw-polygon"&&f.value>=3){const ge=D();ge&&ge.completePolygon()}d.value=!1,s("fullscreen-done"),s("fullscreen-change",!1)},U=ge=>{k.value=ge,s("filter-change",ge)},I=ge=>{i.mode==="select-point"&&s("point-selected",ge),s("map-click",ge)},H=ge=>{f.value=ge?.length||0,V(),s("polygon-drawing",ge)},O=ge=>{s("polygon-complete",ge),f.value=0,p.value=!1,g.value=!1},q=ge=>{s("polygon-update",ge)},V=()=>{const ge=D();ge&&(p.value=ge.canUndo?ge.canUndo():!1,g.value=ge.canRedo?ge.canRedo():!1)},Q=()=>{const ge=D();ge&&ge.undoPolygonPoint&&(ge.undoPolygonPoint(),V())},de=()=>{const ge=D();ge&&ge.redoPolygonPoint&&(ge.redoPolygonPoint(),V())};return t({getMapCenter:()=>D()?.getMapCenter?.(),getMapZoom:()=>D()?.getMapZoom?.(),undoPolygonPoint:Q,redoPolygonPoint:de,canUndo:()=>p.value,canRedo:()=>g.value,getPolygonPointCount:()=>f.value,completePolygon:()=>D()?.completePolygon?.(),clearPolygonDrawing:()=>{D()?.clearPolygonDrawing?.(),f.value=0,p.value=!1,g.value=!1},recenterOnUserLocation:()=>D()?.recenterOnUserLocation?.(),recenterOnLocation:(ge,Pe,Fe)=>D()?.recenterOnLocation?.(ge,Pe,Fe),isLocationInView:(ge,Pe)=>D()?.isLocationInView?.(ge,Pe)??!0,getUserLocationInView:()=>D()?.userLocationInView?.value??!0,getHighlightedLocationInView:()=>D()?.highlightedLocationInView?.value??!0,openFullscreen:()=>{d.value=!0,s("fullscreen-change",!0)},closeFullscreen:S,closeDropdowns:()=>{u.value&&u.value.closeDropdowns()}}),(ge,Pe)=>(v(),m("div",{class:"common-map",style:rt({height:e.height})},[l("div",Uw,[Oe(pu,{ref_key:"mapViewRef",ref:a,locations:_.value,route:b.value,areas:C.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:Pe[0]||(Pe[0]=Fe=>ge.$emit("location-click",Fe)),onMapClick:I,onAreaClick:Pe[1]||(Pe[1]=Fe=>ge.$emit("area-click",Fe)),onPolygonComplete:O,onPolygonDrawing:H,onPolygonUpdate:q,onVisibilityChange:Pe[2]||(Pe[2]=Fe=>ge.$emit("visibility-change",Fe))},null,8,["locations","route","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Oe(Sw,{ref_key:"toolbarRef",ref:u,"show-fullscreen":e.showFullscreen,"show-filters":e.showFilters,filters:k.value,areas:e.areas,actions:e.toolbarActions,position:e.toolbarPosition,onFullscreenClick:M,onFilterChange:U,onActionClick:Pe[3]||(Pe[3]=Fe=>ge.$emit("action-click",Fe))},null,8,["show-fullscreen","show-filters","filters","areas","actions","position"]),Oe(Vh,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":p.value,"can-redo":g.value,onUndo:Q,onRedo:de},null,8,["show","point-count","can-undo","can-redo"])]),Oe(Fw,{show:d.value,mode:e.mode,title:e.fullscreenTitle,description:e.fullscreenDescription,"can-complete":E.value,"header-style":e.fullscreenHeaderStyle,"header-text-color":e.fullscreenHeaderTextColor,onDone:A,onCancel:$,onClose:S},{actions:Ue(()=>[Jn(ge.$slots,"fullscreen-actions",{},void 0,!0)]),banner:Ue(()=>[Jn(ge.$slots,"fullscreen-banner",{},void 0,!0)]),footer:Ue(()=>[Jn(ge.$slots,"fullscreen-footer",{},void 0,!0)]),default:Ue(()=>[l("div",zw,[Oe(pu,{ref_key:"fullscreenMapViewRef",ref:c,locations:_.value,route:b.value,areas:C.value,center:e.center,zoom:e.zoom,clickable:e.clickable||e.mode==="select-point","drawing-mode":e.mode==="draw-polygon","editing-polygon":e.mode==="edit-polygon"?e.editingPolygon:null,"user-location":e.userLocation,"highlight-location-id":e.highlightLocationId,"highlight-location-ids":e.highlightLocationIds,"all-locations-for-bounds":e.allLocationsForBounds,"marshal-mode":e.marshalMode,"simplify-non-highlighted":e.simplifyNonHighlighted,"selected-area-id":e.selectedAreaId,"hide-recenter-button":e.hideRecenterButton,onLocationClick:Pe[4]||(Pe[4]=Fe=>ge.$emit("location-click",Fe)),onMapClick:I,onAreaClick:Pe[5]||(Pe[5]=Fe=>ge.$emit("area-click",Fe)),onPolygonComplete:O,onPolygonDrawing:H,onPolygonUpdate:q,onVisibilityChange:Pe[6]||(Pe[6]=Fe=>ge.$emit("visibility-change",Fe))},null,8,["locations","route","areas","center","zoom","clickable","drawing-mode","editing-polygon","user-location","highlight-location-id","highlight-location-ids","all-locations-for-bounds","marshal-mode","simplify-non-highlighted","selected-area-id","hide-recenter-button"]),Oe(Vh,{show:e.mode==="draw-polygon","point-count":f.value,"can-undo":p.value,"can-redo":g.value,onUndo:Q,onRedo:de},null,8,["show","point-count","can-undo","can-redo"])])]),_:3},8,["show","mode","title","description","can-complete","header-style","header-text-color"])],4))}},ta=je(Hw,[["__scopeId","data-v-d6bcac0e"]]),Vw={class:"course-areas-tab"},Gw={__name:"CourseAreasTab",props:{checkpoints:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]},selectedAreaId:{type:String,default:null},drawingMode:{type:Boolean,default:!1}},emits:["map-click","location-click","area-click","import-checkpoints","upload-route","select-location","add-area","select-area","polygon-complete","cancel-drawing","add-checkpoint-from-map","add-many-checkpoints-from-map","add-area-from-map"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=bt(),a=e,c=o,u=T(null),d=T(null),f=T(0),p=T({showRoute:!0,showUncheckedIn:!0,showPartiallyCheckedIn:!0,showFullyCheckedIn:!0,showAreas:!0,selectedAreaIds:[]}),g=Z(()=>[{id:"add",icon:"plus",label:"Add",items:[{id:"checkpoint",label:i.value.checkpoint},{id:"many-checkpoints",label:`Many ${s.value.checkpoints}`},{id:"area",label:i.value.area},{id:"import",label:`Import ${s.value.checkpoints}...`},{id:"upload",label:`Upload ${s.value.course}...`}]}]),k=({actionId:M,itemId:S})=>{M==="add"&&(S==="checkpoint"?(c("add-checkpoint-from-map"),C()):S==="many-checkpoints"?(c("add-many-checkpoints-from-map"),C()):S==="area"?(c("add-area-from-map"),C()):S==="import"?c("import-checkpoints"):S==="upload"&&c("upload-route"))},_=M=>{p.value=M},b=M=>{f.value=M?.length||0},C=()=>{u.value&&u.value.scrollIntoView({behavior:"smooth",block:"start"})};return t({scrollMapIntoView:C,getMapCenter:()=>d.value?.getMapCenter()||null,getMapZoom:()=>d.value?.getMapZoom()||null}),Ge(()=>a.areas,M=>{if(M.length>0){const S=new Set(p.value.selectedAreaIds);M.forEach($=>{S.has($.id)||p.value.selectedAreaIds.push($.id)}),p.value.selectedAreaIds=p.value.selectedAreaIds.filter($=>M.some(A=>A.id===$))}},{immediate:!0}),Ge(()=>a.drawingMode,M=>{M||(f.value=0)}),(M,S)=>(v(),m("div",Vw,[l("div",{class:"map-section",ref_key:"mapSection",ref:u},[Oe(ta,{ref_key:"commonMapRef",ref:d,locations:e.checkpoints,route:e.route,areas:e.areas,"all-locations-for-bounds":e.checkpoints,"selected-area-id":e.selectedAreaId,clickable:!0,mode:e.drawingMode?"draw-polygon":"view",height:"100%","show-filters":"",filters:p.value,"toolbar-actions":g.value,"fullscreen-title":e.drawingMode?`Draw ${j(s).area} boundary`:j(i).course,"fullscreen-description":e.drawingMode?"Click on the map to draw the boundary":"",onMapClick:S[0]||(S[0]=$=>M.$emit("map-click",$)),onLocationClick:S[1]||(S[1]=$=>M.$emit("location-click",$)),onAreaClick:S[2]||(S[2]=$=>M.$emit("area-click",$)),onPolygonComplete:S[3]||(S[3]=$=>M.$emit("polygon-complete",$)),onPolygonDrawing:b,onFilterChange:_,onActionClick:k},null,8,["locations","route","areas","all-locations-for-bounds","selected-area-id","mode","filters","toolbar-actions","fullscreen-title","fullscreen-description"])],512)]))}},Zw=je(Gw,[["__scopeId","data-v-c0e54ae9"]]),jw=(e,t)=>{const o=String(e).trim(),i=String(t).trim(),s=parseFloat(o),a=parseFloat(i),c=!isNaN(s)&&String(s)===o,u=!isNaN(a)&&String(a)===i;return c&&u?s-a:o.localeCompare(i,void 0,{numeric:!0,sensitivity:"base"})},qw=e=>e&&e.isCheckedIn?"":"",Ww={__name:"StatusPill",props:{variant:{type:String,default:"neutral",validator:e=>["neutral","success","warning","danger","info","purple"].includes(e)},active:{type:Boolean,default:!1}},emits:["click"],setup(e){return(t,o)=>(v(),m("button",{class:pe(["status-pill",[e.variant,{active:e.active}]]),onClick:o[0]||(o[0]=i=>t.$emit("click"))},[Jn(t.$slots,"default",{},void 0)],2))}},_n=je(Ww,[["__scopeId","data-v-a94deea5"]]),Kw={class:"marshals-tab"},Yw={class:"tab-header"},Jw={class:"button-group"},Xw={key:0,class:"status-pills"},Qw={class:"filters-section"},eC={class:"search-group"},tC={class:"marshals-grid"},nC={class:"marshals-table"},oC={key:0,class:"sort-indicator"},sC={key:0,class:"sort-indicator"},iC={key:0,class:"sort-indicator"},aC={key:0,class:"sort-indicator"},lC=["onClick"],rC=["rowspan"],cC={class:"checkpoint-cell"},uC={class:"checkpoint-name"},dC={key:0,class:"checkpoint-description"},hC=["value","onChange"],fC=["rowspan"],pC={key:0,class:"last-active-text"},vC={key:1,class:"last-active-never"},mC=["onClick"],gC={class:"no-checkpoint-text"},yC={class:"hide-on-mobile last-active-cell"},_C={key:0,class:"last-active-text"},kC={key:1,class:"last-active-never"},bC={__name:"MarshalsTab",props:{marshals:{type:Array,required:!0},assignments:{type:Array,required:!0},locations:{type:Array,required:!0}},emits:["add-marshal","import-marshals","select-marshal","delete-marshal","change-assignment-status"],setup(e,{emit:t}){const{terms:o}=bt(),i=e,s=T("name"),a=T("asc"),c=T(""),u=T("all"),d=H=>{u.value=H},f=H=>{s.value===H?a.value=a.value==="asc"?"desc":"asc":(s.value=H,a.value="asc")},p=H=>i.assignments.filter(O=>O.marshalId===H),g=Z(()=>new Set(i.assignments.filter(H=>H.isCheckedIn).map(H=>H.marshalId))),k=Z(()=>new Set(i.assignments.map(H=>H.marshalId))),_=Z(()=>g.value.size),b=Z(()=>i.marshals.filter(H=>!k.value.has(H.id)).length),C=Z(()=>i.marshals.filter(H=>k.value.has(H.id)&&!g.value.has(H.id)).length),E=H=>i.locations.find(O=>O.id===H),D=H=>{const O=E(H);return O?O.name:"Unknown"},M=H=>{const O=E(H);return O?O.description:""},S=H=>{if(!H)return"";const O=new Date(H),V=new Date-O,Q=Math.floor(V/6e4),de=Math.floor(Q/60),Ee=Math.floor(de/24);return Q<1?"just now":Q<60?`${Q}m ago`:de<24?`${de}h ago`:Ee===1?"yesterday":Ee<7?`${Ee}d ago`:O.toLocaleDateString()},$=Z(()=>{let H=i.marshals;if(u.value==="unassigned"?H=H.filter(O=>!k.value.has(O.id)):u.value==="checked-in"?H=H.filter(O=>g.value.has(O.id)):u.value==="not-checked-in"&&(H=H.filter(O=>k.value.has(O.id)&&!g.value.has(O.id))),c.value.trim()){const O=c.value.toLowerCase().trim().split(/\s+/);H=H.filter(q=>{const Q=p(q.id).map(Ee=>{const ge=E(Ee.locationId);return ge?`${ge.name||""} ${ge.description||""}`:""}).join(" "),de=`${q.name} ${Q}`.toLowerCase();return O.every(Ee=>de.includes(Ee))})}return H}),A=Z(()=>{const H=[...$.value];return H.sort((O,q)=>{let V=0;if(s.value==="name")V=O.name.localeCompare(q.name);else if(s.value==="checkpoint"){const Q=p(O.id),de=p(q.id),Ee=Q.length>0?D(Q[0].locationId):"",ge=de.length>0?D(de[0].locationId):"";V=jw(Ee,ge)}else if(s.value==="status"){const Q=p(O.id),de=p(q.id),Ee=Q.length>0&&Q[0].isCheckedIn?1:0;V=(de.length>0&&de[0].isCheckedIn?1:0)-Ee}else if(s.value==="lastActive"){const Q=O.lastAccessedDate?new Date(O.lastAccessedDate).getTime():0;V=(q.lastAccessedDate?new Date(q.lastAccessedDate).getTime():0)-Q}return a.value==="asc"?V:-V}),H}),U=H=>H.isAdminCheckedIn?"admin-checked-in":H.isWrongLocation?"wrong-location":H.isCheckedIn?"checked-in":"not-checked-in",I=H=>H.isCheckedIn?"status-checked-in":"status-not-checked-in";return(H,O)=>(v(),m("div",Kw,[l("div",Yw,[l("div",Jw,[l("button",{onClick:O[0]||(O[0]=q=>H.$emit("add-marshal")),class:"btn btn-primary"}," Add "+w(j(o).person.toLowerCase()),1),l("button",{onClick:O[1]||(O[1]=q=>H.$emit("import-marshals")),class:"btn btn-secondary"}," Import CSV ")]),e.marshals.length>0?(v(),m("div",Xw,[Oe(_n,{variant:"neutral",active:u.value==="all",onClick:O[2]||(O[2]=q=>d("all"))},{default:Ue(()=>[Ke(w(e.marshals.length)+" total ",1)]),_:1},8,["active"]),b.value>0?(v(),Ye(_n,{key:0,variant:"warning",active:u.value==="unassigned",onClick:O[3]||(O[3]=q=>d("unassigned"))},{default:Ue(()=>[Ke(w(b.value)+" unassigned ",1)]),_:1},8,["active"])):P("",!0),_.value>0?(v(),Ye(_n,{key:1,variant:"success",active:u.value==="checked-in",onClick:O[4]||(O[4]=q=>d("checked-in"))},{default:Ue(()=>[Ke(w(_.value)+" checked in ",1)]),_:1},8,["active"])):P("",!0),C.value>0?(v(),Ye(_n,{key:2,variant:"danger",active:u.value==="not-checked-in",onClick:O[5]||(O[5]=q=>d("not-checked-in"))},{default:Ue(()=>[Ke(w(C.value)+" not checked in ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),l("div",Qw,[l("div",eC,[He(l("input",{"onUpdate:modelValue":O[6]||(O[6]=q=>c.value=q),type:"text",class:"search-input",placeholder:"Search by name, checkpoint, or description..."},null,512),[[nt,c.value]])])]),l("div",tC,[l("table",nC,[l("thead",null,[l("tr",null,[l("th",{onClick:O[7]||(O[7]=q=>f("name")),class:"sortable"},[O[12]||(O[12]=Ke(" Name ",-1)),s.value==="name"?(v(),m("span",oC,w(a.value==="asc"?"":""),1)):P("",!0)]),l("th",{onClick:O[8]||(O[8]=q=>f("checkpoint")),class:"sortable"},[Ke(w(j(o).checkpoint)+" ",1),s.value==="checkpoint"?(v(),m("span",sC,w(a.value==="asc"?"":""),1)):P("",!0)]),l("th",{onClick:O[9]||(O[9]=q=>f("status")),class:"sortable"},[O[13]||(O[13]=Ke(" Status ",-1)),s.value==="status"?(v(),m("span",iC,w(a.value==="asc"?"":""),1)):P("",!0)]),l("th",{onClick:O[10]||(O[10]=q=>f("lastActive")),class:"sortable hide-on-mobile"},[O[14]||(O[14]=Ke(" Last active ",-1)),s.value==="lastActive"?(v(),m("span",aC,w(a.value==="asc"?"":""),1)):P("",!0)])])]),l("tbody",null,[(v(!0),m(Se,null,Be(A.value,q=>(v(),m(Se,{key:q.id},[p(q.id).length>0?(v(!0),m(Se,{key:0},Be(p(q.id),(V,Q)=>(v(),m("tr",{key:`${q.id}-${V.id}`,class:"marshal-row",onClick:de=>H.$emit("select-marshal",q)},[Q===0?(v(),m("td",{key:0,rowspan:p(q.id).length},w(q.name),9,rC)):P("",!0),l("td",cC,[l("div",uC,w(D(V.locationId)),1),M(V.locationId)?(v(),m("div",dC,w(M(V.locationId)),1)):P("",!0)]),l("td",{onClick:O[11]||(O[11]=ht(()=>{},["stop"]))},[l("select",{value:U(V),onChange:de=>H.$emit("change-assignment-status",{assignment:V,status:de.target.value}),class:pe(["status-select hide-on-mobile",I(V)])},[...O[15]||(O[15]=[l("option",{value:"not-checked-in"},"Not checked-in",-1),l("option",{value:"checked-in"},"Checked-in",-1),l("option",{value:"admin-checked-in"},"Admin checked-in",-1),l("option",{value:"wrong-location"},"Checked-in but not at correct location",-1)])],42,hC),l("span",{class:pe(["status-icon show-on-mobile",I(V)])},w(j(qw)(V)),3)]),Q===0?(v(),m("td",{key:1,rowspan:p(q.id).length,class:"hide-on-mobile last-active-cell"},[q.lastAccessedDate?(v(),m("span",pC,w(S(q.lastAccessedDate)),1)):(v(),m("span",vC,"Never"))],8,fC)):P("",!0)],8,lC))),128)):(v(),m("tr",{key:1,class:"marshal-row",onClick:V=>H.$emit("select-marshal",q)},[l("td",null,w(q.name),1),l("td",gC,"No "+w(j(o).checkpoint.toLowerCase())+" assigned",1),O[16]||(O[16]=l("td",null,[l("span",{class:"hide-on-mobile"},"-"),l("span",{class:"status-icon show-on-mobile no-checkpoint-text"},"-")],-1)),l("td",yC,[q.lastAccessedDate?(v(),m("span",_C,w(S(q.lastAccessedDate)),1)):(v(),m("span",kC,"Never"))])],8,mC))],64))),128))])])])]))}},wC=je(bC,[["__scopeId","data-v-618e1dbe"]]),CC={class:"checklists-tab"},LC={class:"checklists-tab-header"},SC={class:"button-group"},xC={class:"filters-section"},IC={class:"search-group"},$C=["placeholder"],TC={class:"checklist-items-list"},MC={key:0,class:"empty-state"},AC={class:"checklist-item-content"},EC=["onClick"],PC={class:"checklist-item-scopes"},DC=["onClick"],OC={__name:"ChecklistsTab",props:{checklistItems:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},completionReport:{type:Object,default:null}},emits:["add-checklist-item","select-checklist-item"],setup(e,{emit:t}){const{terms:o,termsLower:i}=bt(),s=e,a=T(""),c=Z(()=>{if(!a.value.trim())return s.checklistItems;const p=a.value.toLowerCase().trim().split(/\s+/);return s.checklistItems.filter(g=>{const k=(g.text||"").toLowerCase();return p.every(_=>k.includes(_))})}),u=Z(()=>[...c.value].sort((p,g)=>p.displayOrder!==g.displayOrder?p.displayOrder-g.displayOrder:Zs(p.text,g.text))),d=p=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${i.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${i.value.checkpoints}`,SpecificPeople:`Specific ${i.value.people}`,OnePerArea:`One per ${i.value.area}`,OnePerCheckpoint:`One per ${i.value.checkpoint}`,EveryAreaLead:`Every ${i.value.area} lead`,OneLeadPerArea:`One lead per ${i.value.area}`,AreaLead:`${o.value.area} lead`})[p]||p,f=p=>{if(!p)return"";const g=d(p.scope);if(p.itemType===null)return g;const k=p.ids||[];if(k.includes("ALL_MARSHALS"))return`${g} (Everyone)`;if(k.includes("ALL_AREAS"))return`${g} (All ${i.value.areas})`;if(k.includes("ALL_CHECKPOINTS"))return`${g} (All ${i.value.checkpoints})`;const _=k.length;return _===0?g:`${g} (${_})`};return(p,g)=>(v(),m("div",CC,[l("div",LC,[l("div",SC,[l("button",{onClick:g[0]||(g[0]=k=>p.$emit("add-checklist-item")),class:"btn btn-primary"}," Add "+w(j(i).checklist),1)])]),l("div",xC,[l("div",IC,[He(l("input",{"onUpdate:modelValue":g[1]||(g[1]=k=>a.value=k),type:"text",class:"search-input",placeholder:`Search ${j(i).checklists}...`},null,8,$C),[[nt,a.value]])])]),l("div",TC,[c.value.length===0?(v(),m("div",MC,[l("p",null,w(a.value?`No ${j(i).checklists} match your search.`:`No ${j(i).checklists} yet. Create one to get started!`),1)])):P("",!0),(v(!0),m(Se,null,Be(u.value,k=>(v(),m("div",{key:k.itemId,class:"checklist-item-card"},[l("div",AC,[l("div",{class:"checklist-item-title",onClick:_=>p.$emit("select-checklist-item",k,"details")},[l("strong",null,w(k.text),1)],8,EC),l("div",PC,[(v(!0),m(Se,null,Be(k.scopeConfigurations,(_,b)=>(v(),m("span",{key:b,class:"scope-badge",onClick:C=>p.$emit("select-checklist-item",k,"visibility")},w(f(_)),9,DC))),128))])])]))),128))])]))}},RC=je(OC,[["__scopeId","data-v-123b7338"]]),BC={class:"notes-tab"},NC={class:"tab-header"},FC={class:"button-group"},UC={class:"filters-section"},zC={class:"search-group"},HC={class:"notes-list"},VC={key:0,class:"empty-state"},GC=["onClick"],ZC={class:"note-header"},jC={class:"note-title-row"},qC={key:0,class:"pin-icon",title:"Pinned"},WC={class:"note-meta"},KC={key:0,class:"category-badge"},YC={class:"created-info"},JC={key:0,class:"note-preview"},XC={class:"note-scopes"},QC={__name:"NotesTab",props:{notes:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["add-note","select-note"],setup(e,{emit:t}){const{termsLower:o}=bt(),i=e,s=T(""),a=Z(()=>{if(!s.value.trim())return i.notes;const g=s.value.toLowerCase().trim().split(/\s+/);return i.notes.filter(k=>{const _=`${k.title||""} ${k.content||""} ${k.priority||""}`.toLowerCase();return g.every(b=>_.includes(b))})}),c=Z(()=>{const g={Urgent:0,High:1,Normal:2,Low:3};return[...a.value].sort((k,_)=>{if(k.isPinned!==_.isPinned)return k.isPinned?-1:1;const b=g[k.priority]??2,C=g[_.priority]??2;return b!==C?b-C:k.displayOrder!==_.displayOrder?k.displayOrder-_.displayOrder:Zs(k.title,_.title)})}),u=g=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${o.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${o.value.checkpoints}`,SpecificPeople:`Specific ${o.value.people}`,EveryAreaLead:`Every ${o.value.area} lead`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,OnePerArea:`One per ${o.value.area}`,OneLeadPerArea:`One lead per ${o.value.area}`})[g]||g,d=g=>{if(!g)return"";const k=u(g.scope);if(g.itemType===null)return k;const _=g.ids||[];if(_.includes("ALL_MARSHALS"))return`${k} (Everyone)`;if(_.includes("ALL_AREAS"))return`${k} (All ${o.value.areas})`;if(_.includes("ALL_CHECKPOINTS"))return`${k} (All ${o.value.checkpoints})`;const b=_.length;return b===0?k:`${k} (${b})`},f=g=>{if(!g)return"";const k=150;return g.length<=k?g:g.substring(0,k)+"..."},p=g=>{if(!g)return"";const k=new Date(g),b=new Date-k,C=Math.floor(b/6e4),E=Math.floor(b/36e5),D=Math.floor(b/864e5);return C<1?"Just now":C<60?`${C}m ago`:E<24?`${E}h ago`:D<7?`${D}d ago`:k.toLocaleDateString()};return(g,k)=>(v(),m("div",BC,[l("div",NC,[l("div",FC,[l("button",{onClick:k[0]||(k[0]=_=>g.$emit("add-note")),class:"btn btn-primary"}," Add note ")])]),l("div",UC,[l("div",zC,[He(l("input",{"onUpdate:modelValue":k[1]||(k[1]=_=>s.value=_),type:"text",class:"search-input",placeholder:"Search by title, content, or priority..."},null,512),[[nt,s.value]])])]),l("div",HC,[a.value.length===0?(v(),m("div",VC,[l("p",null,w(s.value?"No notes match your search.":"No notes yet. Create one to get started!"),1)])):P("",!0),(v(!0),m(Se,null,Be(c.value,_=>(v(),m("div",{key:_.noteId,class:pe(["note-card",{pinned:_.isPinned}]),onClick:b=>g.$emit("select-note",_)},[l("div",ZC,[l("div",jC,[_.isPinned?(v(),m("span",qC,"")):P("",!0),l("span",{class:pe(["priority-indicator",_.priority?.toLowerCase()||"normal"])},null,2),l("strong",null,w(_.title),1)]),l("div",WC,[_.category?(v(),m("span",KC,w(_.category),1)):P("",!0),l("span",YC,w(p(_.createdAt)),1)])]),_.content?(v(),m("div",JC,w(f(_.content)),1)):P("",!0),l("div",XC,[(v(!0),m(Se,null,Be(_.scopeConfigurations,(b,C)=>(v(),m("span",{key:C,class:"scope-badge"},w(d(b)),1))),128))])],10,GC))),128))])]))}},e2=je(QC,[["__scopeId","data-v-6449d7cc"]]),t2={key:0,class:"empty-state"},n2={key:0,class:"empty-hint"},o2={__name:"CardsGrid",props:{isEmpty:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No items."},emptyHint:{type:String,default:""},gridClass:{type:String,default:""}},setup(e){return(t,o)=>e.isEmpty?(v(),m("div",t2,[l("p",null,w(e.emptyMessage),1),e.emptyHint?(v(),m("p",n2,w(e.emptyHint),1)):P("",!0)])):(v(),m("div",{key:1,class:pe(["cards-grid",e.gridClass])},[Jn(t.$slots,"default",{},void 0)],2))}},Gl=je(o2,[["__scopeId","data-v-b6ae6a77"]]),s2={class:"contact-card-header"},i2={class:"contact-name-row"},a2={key:0,class:"primary-badge",title:"Primary contact"},l2={class:"contact-name"},r2={key:0,class:"contact-role"},c2={key:0,class:"no-scope-warning",title:"This contact has no visibility scope configured"},u2=["title"],d2={key:0,class:"contact-card-details"},h2={key:0,class:"contact-phone"},f2={key:1,class:"contact-email"},p2={key:1,class:"contact-card-notes"},v2={key:2,class:"contact-card-scopes"},m2={key:3,class:"contact-card-badge"},g2={key:4,class:"contact-card-badge"},y2={__name:"ContactCard",props:{contact:{type:Object,required:!0},isPending:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:String,default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},clickable:{type:Boolean,default:!0}},emits:["click","remove","undo-remove"],setup(e,{emit:t}){const{terms:o,termsLower:i}=bt(),s=e,a=t,c=Z(()=>{const k=s.contact.scopeConfigurations;return!k||k.length===0}),u=()=>{s.clickable&&!s.isPending&&!s.isMarkedForRemoval&&a("click",s.contact)},d=k=>k?k==="AreaLead"?`${o.value.area} Lead`:k.replace(/([A-Z])/g," $1").replace(/^./,_=>_.toUpperCase()).trim():"",f=k=>({Everyone:"Everyone",EveryoneInAreas:`Everyone in ${i.value.areas}`,EveryoneAtCheckpoints:`Everyone at ${i.value.checkpoints}`,SpecificPeople:`Specific ${i.value.people}`,EveryAreaLead:`Every ${i.value.area} lead`})[k]||k,p=k=>{if(!k)return"";const _=f(k.scope);if(k.itemType===null)return _;const b=k.ids||[];if(b.includes("ALL_MARSHALS"))return`${_} (Everyone)`;if(b.includes("ALL_AREAS"))return`${_} (All ${i.value.areas})`;if(b.includes("ALL_CHECKPOINTS"))return`${_} (All ${i.value.checkpoints})`;const C=b.length;return C===0?_:`${_} (${C})`},g=k=>{if(!k)return"";const _=100;return k.length<=_?k:k.substring(0,_)+"..."};return(k,_)=>(v(),m("div",{class:pe(["contact-card",{"is-pending":e.isPending,"is-marked-for-removal":e.isMarkedForRemoval,"is-primary":e.contact.isPrimary&&!e.isMarkedForRemoval,"is-clickable":e.clickable&&!e.isMarkedForRemoval}]),onClick:u},[l("div",s2,[l("div",{class:pe(["contact-card-title",{clickable:e.clickable&&!e.isMarkedForRemoval}])},[l("div",i2,[e.contact.isPrimary&&!e.isMarkedForRemoval?(v(),m("span",a2,"")):P("",!0),l("span",l2,w(e.contact.name),1)]),e.contact.role?(v(),m("span",r2,w(d(e.contact.role)),1)):P("",!0)],2),c.value&&!e.isMarkedForRemoval&&!e.isPending?(v(),m("span",c2,"!")):P("",!0),e.showRemoveButton&&!e.isMarkedForRemoval?(v(),m("button",{key:1,type:"button",class:"contact-remove-btn",title:e.removeTitle,onClick:_[0]||(_[0]=ht(b=>k.$emit("remove",e.contact.contactId),["stop"]))},"  ",8,u2)):P("",!0),e.isMarkedForRemoval?(v(),m("button",{key:2,type:"button",class:"contact-undo-btn",title:"Cancel removal",onClick:_[1]||(_[1]=ht(b=>k.$emit("undo-remove",e.contact.contactId),["stop"]))}," Undo ")):P("",!0)]),e.contact.phone||e.contact.email?(v(),m("div",d2,[e.contact.phone?(v(),m("span",h2,w(e.contact.phone),1)):P("",!0),e.contact.email?(v(),m("span",f2,w(e.contact.email),1)):P("",!0)])):P("",!0),e.contact.notes&&e.showNotes?(v(),m("div",p2,w(g(e.contact.notes)),1)):P("",!0),e.showScopes&&e.contact.scopeConfigurations?.length>0&&!e.isMarkedForRemoval?(v(),m("div",v2,[(v(!0),m(Se,null,Be(e.contact.scopeConfigurations,(b,C)=>(v(),m("span",{key:C,class:"scope-badge"},w(p(b)),1))),128))])):P("",!0),e.isPending?(v(),m("div",m2,[..._[2]||(_[2]=[l("span",{class:"pending-indicator"},"Will be added on save",-1)])])):P("",!0),e.isMarkedForRemoval?(v(),m("div",g2,[..._[3]||(_[3]=[l("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):P("",!0)],2))}},_2=je(y2,[["__scopeId","data-v-86c5c2b6"]]),bv={__name:"ContactsGrid",props:{contacts:{type:Array,required:!0},showRemoveButton:{type:Boolean,default:!1},removeTitle:{type:[String,Function],default:"Remove"},showNotes:{type:Boolean,default:!1},showScopes:{type:Boolean,default:!1},emptyMessage:{type:String,default:"No contacts."},emptyHint:{type:String,default:""}},emits:["select","remove","undo-remove"],setup(e){const t=e,o=s=>typeof t.removeTitle=="function"?t.removeTitle(s):t.removeTitle,i=s=>!s.isPending;return(s,a)=>(v(),Ye(Gl,{"is-empty":e.contacts.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ue(()=>[(v(!0),m(Se,null,Be(e.contacts,c=>(v(),Ye(_2,{key:c.contactId,contact:c,"is-pending":c.isPending,"is-marked-for-removal":c.isMarkedForRemoval,"show-remove-button":e.showRemoveButton,"remove-title":o(c),"show-notes":e.showNotes,"show-scopes":e.showScopes,clickable:i(c),onClick:u=>s.$emit("select",c),onRemove:a[0]||(a[0]=u=>s.$emit("remove",u)),onUndoRemove:a[1]||(a[1]=u=>s.$emit("undo-remove",u))},null,8,["contact","is-pending","is-marked-for-removal","show-remove-button","remove-title","show-notes","show-scopes","clickable","onClick"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},k2={class:"contacts-tab"},b2={class:"tab-header"},w2={class:"button-group"},C2={key:0,class:"status-pills"},L2={class:"filters-section"},S2={class:"search-group"},x2={__name:"ContactsTab",props:{contacts:{type:Array,required:!0},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})}},emits:["add-contact","select-contact"],setup(e,{emit:t}){const o=e,i=T(""),s=T("all"),a=Z(()=>o.contacts.filter(_=>!_.scopeConfigurations||_.scopeConfigurations.length===0).length),c=Z(()=>o.contacts.filter(_=>_.scopeConfigurations&&_.scopeConfigurations.length>0).length),u=_=>{s.value=_},d=_=>_?_.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",f=_=>_?_.replace(/([A-Z])/g," $1").replace(/^./,b=>b.toUpperCase()).trim():"",p=Z(()=>{let _=o.contacts;if(s.value==="no-scope"?_=_.filter(b=>!b.scopeConfigurations||b.scopeConfigurations.length===0):s.value==="with-scope"&&(_=_.filter(b=>b.scopeConfigurations&&b.scopeConfigurations.length>0)),i.value.trim()){const C=d(i.value).split(" ").filter(E=>E.length>0);_=_.filter(E=>{const D=f(E.role),M=d(`${E.name||""} ${D} ${E.email||""} ${E.phone||""}`);return C.every(S=>M.includes(S))})}return _}),g=Z(()=>[...p.value].sort((_,b)=>(_.name||"").localeCompare(b.name||"",void 0,{sensitivity:"base"}))),k=Z(()=>{const _=i.value.trim();return s.value==="no-scope"?_?"No unassigned contacts match your search.":"All contacts are assigned.":s.value==="with-scope"?_?"No assigned contacts match your search.":"No contacts are assigned yet.":_?"No contacts match your search.":"No contacts yet. Create one to get started!"});return(_,b)=>(v(),m("div",k2,[l("div",b2,[l("div",w2,[l("button",{onClick:b[0]||(b[0]=C=>_.$emit("add-contact")),class:"btn btn-primary"}," Add contact ")]),e.contacts.length>0?(v(),m("div",C2,[Oe(_n,{variant:"neutral",active:s.value==="all",onClick:b[1]||(b[1]=C=>u("all"))},{default:Ue(()=>[Ke(w(e.contacts.length)+" total ",1)]),_:1},8,["active"]),c.value>0?(v(),Ye(_n,{key:0,variant:"success",active:s.value==="with-scope",onClick:b[2]||(b[2]=C=>u("with-scope"))},{default:Ue(()=>[Ke(w(c.value)+" assigned ",1)]),_:1},8,["active"])):P("",!0),a.value>0?(v(),Ye(_n,{key:1,variant:"danger",active:s.value==="no-scope",onClick:b[3]||(b[3]=C=>u("no-scope"))},{default:Ue(()=>[Ke(w(a.value)+" unassigned ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),l("div",L2,[l("div",S2,[He(l("input",{"onUpdate:modelValue":b[4]||(b[4]=C=>i.value=C),type:"text",class:"search-input",placeholder:"Search by name, role, email, or phone..."},null,512),[[nt,i.value]])])]),Oe(bv,{contacts:g.value,"show-notes":!0,"show-scopes":!0,"empty-message":k.value,onSelect:b[5]||(b[5]=C=>_.$emit("select-contact",C))},null,8,["contacts","empty-message"])]))}},I2=je(x2,[["__scopeId","data-v-ca4b1b77"]]),$2={class:"event-details-tab"},T2={class:"event-info-card"},M2={class:"form-group"},A2={class:"form-group"},E2={class:"form-row"},P2={class:"form-group"},D2={class:"form-group"},O2=["value"],R2={class:"form-actions"},B2=["disabled"],N2={__name:"EventDetailsTab",props:{eventData:{type:Object,required:!0},formDirty:{type:Boolean,default:!1}},emits:["submit","update:formDirty"],setup(e,{emit:t}){const o=e,i=t,s=T({...o.eventData});Ge(()=>o.eventData,u=>{s.value={...u}},{deep:!0});const a=()=>{i("update:formDirty",!0)},c=()=>{i("submit",{...s.value})};return(u,d)=>(v(),m("div",$2,[l("div",T2,[l("form",{onSubmit:ht(c,["prevent"]),class:"event-details-form"},[l("div",M2,[d[4]||(d[4]=l("label",null,"Event name",-1)),He(l("input",{"onUpdate:modelValue":d[0]||(d[0]=f=>s.value.name=f),type:"text",required:"",class:"form-input",onInput:a},null,544),[[nt,s.value.name]])]),l("div",A2,[d[5]||(d[5]=l("label",null,"Description",-1)),He(l("textarea",{"onUpdate:modelValue":d[1]||(d[1]=f=>s.value.description=f),rows:"3",class:"form-input",onInput:a},null,544),[[nt,s.value.description]])]),l("div",E2,[l("div",P2,[d[6]||(d[6]=l("label",null,"Event date & time",-1)),He(l("input",{"onUpdate:modelValue":d[2]||(d[2]=f=>s.value.eventDate=f),type:"datetime-local",required:"",class:"form-input",onInput:a},null,544),[[nt,s.value.eventDate]])]),l("div",D2,[d[7]||(d[7]=l("label",null,"Time zone",-1)),He(l("select",{"onUpdate:modelValue":d[3]||(d[3]=f=>s.value.timeZoneId=f),required:"",class:"form-input",onChange:a},[(v(!0),m(Se,null,Be(j(pv),f=>(v(),m("option",{key:f.value,value:f.value},w(f.label),9,O2))),128))],544),[[Tn,s.value.timeZoneId]])])]),l("div",R2,[l("button",{type:"submit",class:"btn btn-save",disabled:!e.formDirty}," Save ",8,B2)])],32)])]))}},F2=je(N2,[["__scopeId","data-v-2754c3cc"]]),U2={class:"admins-list"},z2={class:"admin-info"},H2={class:"admin-role"},V2=["onClick"],G2={__name:"AdminsList",props:{admins:{type:Array,required:!0}},emits:["add-admin","remove-admin"],setup(e){return(t,o)=>(v(),m("div",null,[l("button",{onClick:o[0]||(o[0]=i=>t.$emit("add-admin")),class:"btn btn-small btn-primary"}," Add administrator "),l("div",U2,[(v(!0),m(Se,null,Be(e.admins,i=>(v(),m("div",{key:i.userEmail,class:"admin-item"},[l("div",z2,[l("strong",null,w(i.userEmail),1),l("span",H2,w(i.role),1)]),e.admins.length>1?(v(),m("button",{key:0,onClick:s=>t.$emit("remove-admin",i.userEmail),class:"btn btn-small btn-danger"}," Remove ",8,V2)):P("",!0)]))),128))])]))}},Z2=je(G2,[["__scopeId","data-v-e526860b"]]),ro=[{name:"Charcoal",hex:"#2d3748"},{name:"Dark Gray",hex:"#4a5568"},{name:"Gray",hex:"#718096"},{name:"Red",hex:"#f56565"},{name:"Coral",hex:"#ff6b6b"},{name:"Rose",hex:"#fb7185"},{name:"Pink",hex:"#ed64a6"},{name:"Magenta",hex:"#d946ef"},{name:"Fuchsia",hex:"#e879f9"},{name:"Purple",hex:"#9f7aea"},{name:"Violet",hex:"#a78bfa"},{name:"Lavender",hex:"#b197fc"},{name:"Indigo",hex:"#5a67d8"},{name:"Navy",hex:"#4263eb"},{name:"Blue",hex:"#667eea"},{name:"Sky",hex:"#0ea5e9"},{name:"Cyan",hex:"#0bc5ea"},{name:"Aqua",hex:"#22d3ee"},{name:"Teal",hex:"#38b2ac"},{name:"Emerald",hex:"#10b981"},{name:"Green",hex:"#48bb78"},{name:"Mint",hex:"#51cf66"},{name:"Lime",hex:"#84cc16"},{name:"Olive",hex:"#a3b18a"},{name:"Yellow",hex:"#ecc94b"},{name:"Amber",hex:"#f59e0b"},{name:"Orange",hex:"#ed8936"},{name:"Peach",hex:"#ff922b"},{name:"Light Gray",hex:"#cbd5e0"},{name:"Silver",hex:"#e2e8f0"},{name:"Cream",hex:"#f7fafc"}],mr="#667eea";function Gh(e){const t=e.map(i=>i.color);return ro.find(i=>!t.includes(i.hex))?.hex||mr}const j2={class:"modal-content"},q2={class:"modal-body"},W2={class:"preview-section"},K2={class:"map-preview"},Y2=["innerHTML"],J2={class:"options-grid"},X2={class:"option-button-content"},Q2={class:"option-button-value icon-value"},eL=["innerHTML"],tL={class:"option-button-content"},nL={class:"option-button-value color-value"},oL=["disabled"],sL={class:"option-button-content"},iL={class:"option-button-value color-value"},aL={class:"option-button-content"},lL={class:"option-button-value icon-value"},rL=["innerHTML"],cL=["disabled"],uL={class:"option-button-content"},dL={class:"option-button-value color-value"},hL={class:"option-button-content"},fL={class:"option-button-value"},pL={class:"option-button-content"},vL={class:"option-button-value"},mL={key:0,class:"centered-popup"},gL={class:"popup-grid"},yL=["onClick"],_L=["innerHTML"],kL={key:0},bL={key:1,class:"centered-popup"},wL={class:"popup-grid"},CL=["title","onClick"],LL=["innerHTML"],SL={key:0},xL={key:2,class:"centered-popup"},IL={class:"popup-grid"},$L=["title","onClick"],TL=["innerHTML"],ML={key:0},AL={key:3,class:"centered-popup icon-popup"},EL={class:"popup-grid"},PL=["onClick"],DL=["innerHTML"],OL={key:0},RL={key:4,class:"centered-popup"},BL={class:"popup-grid"},NL=["title","onClick"],FL=["innerHTML"],UL={key:0},zL={key:5,class:"centered-popup"},HL={class:"size-grid"},VL=["onClick"],GL=["innerHTML"],ZL={key:6,class:"centered-popup"},jL={class:"rotation-content"},qL={class:"rotation-preview-container"},WL=["innerHTML"],KL={class:"rotation-control"},YL={class:"rotation-slider-container"},JL=["value"],XL={class:"rotation-value"},QL={class:"rotation-presets"},eS="#667eea",tS={__name:"IconCustomizationModal",props:{isOpen:{type:Boolean,default:!1},iconType:{type:String,default:"none"},backgroundShape:{type:String,default:"circle"},backgroundColor:{type:String,default:""},borderColor:{type:String,default:""},iconColor:{type:String,default:""},size:{type:String,default:"100"},mapRotation:{type:[String,Number],default:""},level:{type:String,default:"checkpoint"},inheritedType:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""}},emits:["update:isOpen","apply","cancel"],setup(e,{emit:t}){const o=e,i=t,s=T(o.backgroundShape||"circle"),a=T(o.iconType||"none"),c=T(o.backgroundColor||""),u=T(o.borderColor||""),d=T(o.iconColor||""),f=T(o.size||"100"),p=T(o.mapRotation??""),g=T(null),k=N=>N==="default"?o.inheritedBackgroundShape||"circle":N==="none"?"none":N||"circle",_=N=>N==="default"||!N?O():N==="none"?"transparent":N,b=N=>N==="default"?o.inheritedBorderColor||"#ffffff":N==="none"||!N?"transparent":N,C=N=>{if(N==="default"){const K=o.inheritedType;return K&&K!=="default"&&Xi(K).category==="content"?K:"none"}return N==="none"||!N?"none":N},E=N=>N==="default"||!N?o.inheritedIconColor||"#ffffff":N==="none"?"transparent":N,D=N=>N==="default"?o.inheritedSize||"100":N||"100",M=N=>{if(N==="default"||N===""){const K=o.inheritedMapRotation;return K!==""&&K!==void 0&&K!==null&&parseInt(K,10)||0}return parseInt(N,10)||0},S=Z(()=>{const N=o.inheritedBackgroundShape||"circle",K=ar.find(ee=>ee.value===N)?.label||"Circle";return[{value:"none",label:"None",showLabel:!0},{value:"default",label:`Default (${K})`,showLabel:!0},...ar.filter(ee=>ee.value!=="none").map(ee=>({...ee,showLabel:!1}))]}),$=Z(()=>{const N=Ar.filter($e=>$e.category==="content"),K=[{value:"none",label:"None",category:"content",showLabel:!0}],ee=o.inheritedType;if(ee&&ee!=="default"){const $e=Xi(ee);$e.category==="content"&&K.push({value:"default",label:`Default (${$e.label||ee})`,category:"content",showLabel:!0})}return K.push(...N.map($e=>({...$e,showLabel:!1}))),K}),A=Z(()=>{const N={33:"Small",66:"Medium",100:"Normal",150:"Large"};return[{value:"default",label:`Default (${N[o.inheritedSize]||"Normal"})`},...N0.map(ee=>({value:ee.value,label:N[ee.value]||ee.label}))]}),U=Z(()=>k(s.value)!=="none"),I=Z(()=>C(a.value)!=="none"),H=Z(()=>{const N=o.inheritedBackgroundColor;return N&&N!=="default"&&N.startsWith("#")?N:eS}),O=()=>H.value,q=Z(()=>c.value&&c.value!=="default"?c.value:O()),V=Z(()=>u.value==="none"?"transparent":u.value?u.value:o.inheritedBorderColor&&o.inheritedBorderColor!=="none"?o.inheritedBorderColor:"#ffffff"),Q=Z(()=>d.value?d.value:o.inheritedIconColor?o.inheritedIconColor:"#ffffff"),de=Z(()=>{const N=H.value,K=ro.find(ee=>ee.hex.toLowerCase()===N.toLowerCase())?.name||"Custom";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${K})`,showLabel:!0},...ro.map(ee=>({hex:ee.hex,name:ee.name,showLabel:!1}))]}),Ee=Z(()=>{const N=o.inheritedBorderColor||"#ffffff",K=N==="#ffffff"?"White":ro.find(ee=>ee.hex===N)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${K})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...ro.filter(ee=>ee.hex!=="#ffffff").map(ee=>({hex:ee.hex,name:ee.name,showLabel:!1}))]}),ge=Z(()=>{const N=o.inheritedIconColor||"#ffffff",K=N==="#ffffff"?"White":ro.find(ee=>ee.hex===N)?.name||"White";return[{hex:"none",name:"None",showLabel:!0},{hex:"default",name:`Default (${K})`,showLabel:!0},{hex:"#ffffff",name:"White",showLabel:!1},{hex:"#000000",name:"Black",showLabel:!1},...ro.filter(ee=>ee.hex!=="#ffffff").map(ee=>({hex:ee.hex,name:ee.name,showLabel:!1}))]}),Pe=N=>N==="default"?!c.value||c.value==="default":c.value===N,Fe=N=>N==="#ffffff"?!d.value||d.value==="#ffffff":d.value===N,ce=N=>{if(N==="none")return"None";if(N==="default"){const ee=o.inheritedBackgroundShape;return ee?`Default (${ar.find(We=>We.value===ee)?.label||"Circle"})`:"Default (Circle)"}const K=ar.find(ee=>ee.value===N);return K?K.label:"Circle"},Me=N=>{if(N==="none")return"None";if(N==="default"){const ee=o.inheritedType;if(ee&&ee!=="default"){const $e=Xi(ee);if($e.category==="content")return`Default (${$e.label||ee})`}return"Default"}const K=Ar.find(ee=>ee.value===N);return K?K.label:"None"},ke=N=>{if(N==="none")return"None";if(!N||N==="default"){const ee=H.value;return`Default (${ro.find(We=>We.hex.toLowerCase()===ee.toLowerCase())?.name||"Custom"})`}const K=[...ro].find(ee=>ee.hex.toLowerCase()===N.toLowerCase());return K?K.name:N},re=N=>{if(N==="none")return"None";if(N==="default"){const ee=o.inheritedBorderColor;return ee&&ee!=="none"?`Default (${ee==="#ffffff"?"White":ro.find(We=>We.hex===ee)?.name||"Custom"})`:"Default (White)"}if(!N||N==="#ffffff")return"White";const K=[...Ee.value].find(ee=>ee.hex===N);return K?K.name:N},Re=N=>{if(N==="none")return"None";if(N==="default"){const ee=o.inheritedIconColor;return ee?`Default (${ee==="#ffffff"?"White":ro.find(We=>We.hex===ee)?.name||"Custom"})`:"Default (White)"}if(!N||N==="#ffffff")return"White";const K=[...ge.value].find(ee=>ee.hex===N);return K?K.name:N},Je=N=>{const K={33:"Small",66:"Medium",100:"Normal",150:"Large"};if(N==="default"){const ee=o.inheritedSize;return`Default (${K[ee]||"Normal"})`}return K[N]||"Normal"},tt=N=>{if(N==="default"||N===""||N===void 0||N===null){const K=o.inheritedMapRotation;return K!==""&&K!==void 0&&K!==null?`Default (${K})`:"Default (0)"}return`${N}`},qe=N=>{if(N==="none")return`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`;const K=k(N),ee=_(c.value),$e=b(u.value);return La[K]?`<svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">${La[K]({backgroundColor:ee,borderColor:$e==="transparent"?"none":$e})}</svg>`:""},Qe=N=>{const K=C(N);return K==="none"?`<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
      <rect x="1" y="1" width="16" height="16" rx="2" fill="none" stroke="#ccc" stroke-width="1.5" stroke-dasharray="3"/>
    </svg>`:fn({type:K,backgroundShape:"circle",backgroundColor:"#94a3b8",borderColor:"none",iconColor:"#fff",size:"75"})},be=N=>{const K=k(N);if(K==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="none" stroke="#ccc" stroke-width="2" stroke-dasharray="4"/>
    </svg>`;const ee=_(c.value),$e=b(u.value),We=C(a.value),ot=E(d.value);return fn({type:We!=="none"?We:K,backgroundShape:K,backgroundColor:ee,borderColor:$e==="transparent"?"none":$e,iconColor:ot,size:"100",outputSize:28})},ze=N=>{const K=_(N),ee=k(s.value),$e=b(u.value),We=C(a.value),ot=E(d.value);return ee==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${K==="transparent"?"#e2e8f0":K}"/>
    </svg>`:fn({type:We!=="none"?We:ee,backgroundShape:ee,backgroundColor:K==="transparent"?"#e2e8f0":K,borderColor:$e==="transparent"?"none":$e,iconColor:ot,size:"100",outputSize:28})},fe=N=>{const K=b(N),ee=k(s.value),$e=_(c.value),We=C(a.value),ot=E(d.value);return ee==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0" stroke="${K}" stroke-width="2"/>
    </svg>`:fn({type:We!=="none"?We:ee,backgroundShape:ee,backgroundColor:$e,borderColor:K==="transparent"?"none":K,iconColor:ot,size:"100",outputSize:28})},Le=N=>{const K=C(N),ee=k(s.value),$e=_(c.value),We=b(u.value),ot=E(d.value);if(K==="none"&&ee==="none")return`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="#e2e8f0"/>
      <line x1="8" y1="8" x2="20" y2="20" stroke="#a0aec0" stroke-width="2" stroke-linecap="round"/>
    </svg>`;const st=ee!=="none"?ee:"circle";return fn({type:K!=="none"?K:st,backgroundShape:st,backgroundColor:$e,borderColor:We==="transparent"?"none":We,iconColor:ot,size:"100",outputSize:42})},Ae=N=>{const K=E(N),ee=k(s.value),$e=_(c.value),We=b(u.value),ot=C(a.value);return ot==="none"?`<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="24" height="24" rx="4" fill="${K==="transparent"?"#e2e8f0":K}"/>
    </svg>`:fn({type:ot,backgroundShape:ee!=="none"?ee:"circle",backgroundColor:$e,borderColor:We==="transparent"?"none":We,iconColor:K==="transparent"?"#e2e8f0":K,size:"100",outputSize:28})},W=N=>{const K=D(N),ee=k(s.value),$e=_(c.value),We=b(u.value),ot=C(a.value),st=E(d.value);if(ee==="none"&&ot==="none")return"";const Ct=ee!=="none"?ee:"circle";return fn({type:ot!=="none"?ot:Ct,backgroundShape:Ct,backgroundColor:$e,borderColor:We==="transparent"?"none":We,iconColor:st,size:K})},J=Z(()=>{const N=k(s.value),K=_(c.value),ee=b(u.value),$e=C(a.value),We=E(d.value),ot=D(f.value);return N==="none"&&$e==="none"?"":fn(N==="none"&&$e!=="none"?{type:$e,backgroundShape:"none",backgroundColor:K,borderColor:"none",iconColor:We,size:ot}:{type:$e!=="none"?$e:N,backgroundShape:N,backgroundColor:K,borderColor:ee==="transparent"?"none":ee,iconColor:We,size:ot})}),ue=N=>{g.value=g.value===N?null:N},ye=()=>{g.value=null},ae=N=>{s.value=N,ye()},ie=N=>{c.value=N,ye()},he=N=>{u.value=N,ye()},De=N=>{a.value=N,ye()},Te=N=>{d.value=N,ye()},oe=N=>{f.value=N,ye()},ve=N=>{p.value=N,ye()},se=N=>{p.value=N};Ge(()=>o.isOpen,N=>{if(N){const K=o.backgroundShape&&o.backgroundShape!=="default"&&o.backgroundShape!=="circle",ee=o.iconType&&o.iconType!=="none"&&o.iconType!=="default",$e=o.backgroundColor&&o.backgroundColor!=="",We=o.borderColor&&o.borderColor!=="",ot=o.iconColor&&o.iconColor!=="",st=o.size&&o.size!==""&&o.size!=="100",Ct=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null&&o.mapRotation!==0;K||ee||$e||We||ot||st||Ct?(s.value=o.backgroundShape||"default",a.value=o.iconType||"default",c.value=o.backgroundColor||"default",u.value=o.borderColor||"default",d.value=o.iconColor||"default",f.value=o.size||"default",p.value=o.mapRotation!==""&&o.mapRotation!==void 0&&o.mapRotation!==null?o.mapRotation:"default"):(s.value="default",a.value="default",c.value="default",u.value="default",d.value="default",f.value="default",p.value="default"),g.value=null}});const te=()=>{ye(),i("update:isOpen",!1),i("cancel")},X=()=>{ye();const N=$e=>$e==="default"?"":$e;let K="";a.value==="none"?K="none":a.value&&a.value!=="default"&&(K=a.value);let ee="";p.value!=="default"&&p.value!==""&&p.value!==void 0&&(ee=parseInt(p.value,10)||0),i("apply",{iconType:K,backgroundShape:N(s.value),backgroundColor:N(c.value),borderColor:N(u.value),iconColor:N(d.value),size:N(f.value),mapRotation:ee}),i("update:isOpen",!1)};return(N,K)=>e.isOpen?(v(),m("div",{key:0,class:"modal-overlay",onClick:ht(te,["self"])},[l("div",j2,[l("div",{class:"modal-header"},[K[15]||(K[15]=l("h3",null,"Customise marker style",-1)),l("button",{class:"close-btn",onClick:te},"")]),l("div",q2,[l("div",W2,[l("div",K2,[K[16]||(K[16]=l("div",{class:"map-background"},null,-1)),l("div",{class:"preview-icon",style:rt({transform:`rotate(${M(p.value)}deg)`}),innerHTML:J.value},null,12,Y2)])]),l("div",J2,[l("button",{type:"button",class:pe(["option-button",{active:g.value==="shape"}]),onClick:K[0]||(K[0]=ee=>ue("shape"))},[l("div",X2,[K[17]||(K[17]=l("span",{class:"option-button-label"},"Shape",-1)),l("div",Q2,[l("div",{class:"icon-preview-small",innerHTML:qe(s.value)},null,8,eL),l("span",null,w(ce(s.value)),1)])]),K[18]||(K[18]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:pe(["option-button",{active:g.value==="bgColor"}]),onClick:K[1]||(K[1]=ee=>ue("bgColor"))},[l("div",tL,[K[19]||(K[19]=l("span",{class:"option-button-label"},"Background",-1)),l("div",nL,[l("span",{class:"color-swatch",style:rt({backgroundColor:q.value})},null,4),l("span",null,w(ke(c.value)),1)])]),K[20]||(K[20]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:pe(["option-button",{active:g.value==="borderColor",disabled:!U.value}]),disabled:!U.value,onClick:K[2]||(K[2]=ee=>ue("borderColor"))},[l("div",sL,[K[21]||(K[21]=l("span",{class:"option-button-label"},"Border",-1)),l("div",iL,[l("span",{class:pe(["color-swatch",{"no-border":u.value==="none"}]),style:rt(u.value!=="none"?{backgroundColor:V.value}:{})},null,6),l("span",null,w(re(u.value)),1)])]),K[22]||(K[22]=l("span",{class:"option-button-arrow"},"",-1))],10,oL),l("button",{type:"button",class:pe(["option-button",{active:g.value==="icon"}]),onClick:K[3]||(K[3]=ee=>ue("icon"))},[l("div",aL,[K[23]||(K[23]=l("span",{class:"option-button-label"},"Icon",-1)),l("div",lL,[l("div",{class:"icon-preview-small",innerHTML:Qe(a.value)},null,8,rL),l("span",null,w(Me(a.value)),1)])]),K[24]||(K[24]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:pe(["option-button",{active:g.value==="iconColor",disabled:!I.value}]),disabled:!I.value,onClick:K[4]||(K[4]=ee=>ue("iconColor"))},[l("div",uL,[K[25]||(K[25]=l("span",{class:"option-button-label"},"Colour",-1)),l("div",dL,[l("span",{class:"color-swatch",style:rt({backgroundColor:Q.value})},null,4),l("span",null,w(Re(d.value)),1)])]),K[26]||(K[26]=l("span",{class:"option-button-arrow"},"",-1))],10,cL),l("button",{type:"button",class:pe(["option-button",{active:g.value==="size"}]),onClick:K[5]||(K[5]=ee=>ue("size"))},[l("div",hL,[K[27]||(K[27]=l("span",{class:"option-button-label"},"Size",-1)),l("span",fL,w(Je(f.value)),1)]),K[28]||(K[28]=l("span",{class:"option-button-arrow"},"",-1))],2),l("button",{type:"button",class:pe(["option-button option-button-full",{active:g.value==="mapRotation"}]),onClick:K[6]||(K[6]=ee=>ue("mapRotation"))},[l("div",pL,[K[29]||(K[29]=l("span",{class:"option-button-label"},"Map rotation",-1)),l("span",vL,w(tt(p.value)),1)]),K[30]||(K[30]=l("span",{class:"option-button-arrow"},"",-1))],2)]),g.value==="shape"?(v(),m("div",mL,[l("div",{class:"popup-header"},[K[31]||(K[31]=l("span",null,"Select shape",-1)),l("button",{type:"button",class:"popup-close",onClick:ye},"")]),l("div",gL,[(v(!0),m(Se,null,Be(S.value,ee=>(v(),m("button",{key:ee.value,type:"button",class:pe(["popup-grid-item",{selected:s.value===ee.value}]),onClick:$e=>ae(ee.value)},[l("div",{class:"popup-item-preview",innerHTML:be(ee.value)},null,8,_L),ee.showLabel?(v(),m("span",kL,w(ee.label),1)):P("",!0)],10,yL))),128))])])):P("",!0),g.value==="bgColor"?(v(),m("div",bL,[l("div",{class:"popup-header"},[K[32]||(K[32]=l("span",null,"Select background",-1)),l("button",{type:"button",class:"popup-close",onClick:ye},"")]),l("div",wL,[(v(!0),m(Se,null,Be(de.value,ee=>(v(),m("button",{key:ee.hex,type:"button",class:pe(["popup-grid-item",{selected:Pe(ee.hex)}]),title:ee.name,onClick:$e=>ie(ee.hex)},[l("div",{class:"popup-item-preview",innerHTML:ze(ee.hex)},null,8,LL),ee.showLabel?(v(),m("span",SL,w(ee.name),1)):P("",!0)],10,CL))),128))])])):P("",!0),g.value==="borderColor"?(v(),m("div",xL,[l("div",{class:"popup-header"},[K[33]||(K[33]=l("span",null,"Select border",-1)),l("button",{type:"button",class:"popup-close",onClick:ye},"")]),l("div",IL,[(v(!0),m(Se,null,Be(Ee.value,ee=>(v(),m("button",{key:ee.hex,type:"button",class:pe(["popup-grid-item",{selected:u.value===ee.hex}]),title:ee.name,onClick:$e=>he(ee.hex)},[l("div",{class:"popup-item-preview",innerHTML:fe(ee.hex)},null,8,TL),ee.showLabel?(v(),m("span",ML,w(ee.name),1)):P("",!0)],10,$L))),128))])])):P("",!0),g.value==="icon"?(v(),m("div",AL,[l("div",{class:"popup-header"},[K[34]||(K[34]=l("span",null,"Select icon",-1)),l("button",{type:"button",class:"popup-close",onClick:ye},"")]),l("div",EL,[(v(!0),m(Se,null,Be($.value,ee=>(v(),m("button",{key:ee.value,type:"button",class:pe(["popup-grid-item",{selected:a.value===ee.value}]),onClick:$e=>De(ee.value)},[l("div",{class:"popup-item-preview",innerHTML:Le(ee.value)},null,8,DL),ee.showLabel?(v(),m("span",OL,w(ee.label),1)):P("",!0)],10,PL))),128))])])):P("",!0),g.value==="iconColor"?(v(),m("div",RL,[l("div",{class:"popup-header"},[K[35]||(K[35]=l("span",null,"Select colour",-1)),l("button",{type:"button",class:"popup-close",onClick:ye},"")]),l("div",BL,[(v(!0),m(Se,null,Be(ge.value,ee=>(v(),m("button",{key:ee.hex,type:"button",class:pe(["popup-grid-item",{selected:Fe(ee.hex)}]),title:ee.name,onClick:$e=>Te(ee.hex)},[l("div",{class:"popup-item-preview",innerHTML:Ae(ee.hex)},null,8,FL),ee.showLabel?(v(),m("span",UL,w(ee.name),1)):P("",!0)],10,NL))),128))])])):P("",!0),g.value==="size"?(v(),m("div",zL,[l("div",{class:"popup-header"},[K[36]||(K[36]=l("span",null,"Select size",-1)),l("button",{type:"button",class:"popup-close",onClick:ye},"")]),l("div",HL,[(v(!0),m(Se,null,Be(A.value,ee=>(v(),m("button",{key:ee.value,type:"button",class:pe(["size-grid-item",{selected:f.value===ee.value}]),onClick:$e=>oe(ee.value)},[l("div",{class:"size-preview",innerHTML:W(ee.value)},null,8,GL),l("span",null,w(ee.label),1)],10,VL))),128))])])):P("",!0),g.value==="mapRotation"?(v(),m("div",ZL,[l("div",{class:"popup-header"},[K[37]||(K[37]=l("span",null,"Set map rotation",-1)),l("button",{type:"button",class:"popup-close",onClick:ye},"")]),l("div",jL,[l("div",qL,[l("div",{class:"rotation-preview-icon",style:rt({transform:`rotate(${M(p.value)}deg)`}),innerHTML:J.value},null,12,WL)]),K[38]||(K[38]=l("p",{class:"rotation-description"}," Rotate the marker on the map. This rotation is added to any map rotation. ",-1)),l("div",KL,[l("button",{type:"button",class:pe(["rotation-preset",{selected:p.value==="default"||p.value===""}]),onClick:K[7]||(K[7]=ee=>ve("default"))}," Default ",2),l("div",YL,[l("input",{type:"range",min:"-180",max:"180",step:"5",class:"rotation-slider",value:p.value==="default"||p.value===""?0:p.value,onInput:K[8]||(K[8]=ee=>se(parseInt(ee.target.value,10)))},null,40,JL),l("div",XL,w(p.value==="default"||p.value===""?"0":p.value)+" ",1)])]),l("div",QL,[l("button",{type:"button",class:pe(["rotation-preset-btn",{selected:p.value===-90}]),onClick:K[9]||(K[9]=ee=>ve(-90))},"-90",2),l("button",{type:"button",class:pe(["rotation-preset-btn",{selected:p.value===-45}]),onClick:K[10]||(K[10]=ee=>ve(-45))},"-45",2),l("button",{type:"button",class:pe(["rotation-preset-btn",{selected:p.value===0}]),onClick:K[11]||(K[11]=ee=>ve(0))},"0",2),l("button",{type:"button",class:pe(["rotation-preset-btn",{selected:p.value===45}]),onClick:K[12]||(K[12]=ee=>ve(45))},"+45",2),l("button",{type:"button",class:pe(["rotation-preset-btn",{selected:p.value===90}]),onClick:K[13]||(K[13]=ee=>ve(90))},"+90",2),l("button",{type:"button",class:pe(["rotation-preset-btn",{selected:p.value===180}]),onClick:K[14]||(K[14]=ee=>ve(180))},"180",2)])])])):P("",!0)]),l("div",{class:"modal-footer"},[l("button",{type:"button",class:"btn-cancel",onClick:te},"Cancel"),l("button",{type:"button",class:"btn-apply",onClick:X},"Apply")])])])):P("",!0)}},nS=je(tS,[["__scopeId","data-v-d83aaf03"]]),oS={class:"checkpoint-style-picker"},sS={class:"form-group"},iS={class:"style-options"},aS=["innerHTML"],lS={class:"option-label"},rS=["innerHTML"],cS="#667eea",uS={__name:"CheckpointStylePicker",props:{styleType:{type:String,default:"default"},styleColor:{type:String,default:""},styleBackgroundShape:{type:String,default:""},styleBackgroundColor:{type:String,default:""},styleBorderColor:{type:String,default:""},styleIconColor:{type:String,default:""},styleSize:{type:String,default:""},styleMapRotation:{type:[String,Number],default:""},iconLabel:{type:String,default:"Marker style"},showPreview:{type:Boolean,default:!0},inheritedStyleType:{type:String,default:"default"},inheritedStyleColor:{type:String,default:""},inheritedBackgroundShape:{type:String,default:""},inheritedBackgroundColor:{type:String,default:""},inheritedBorderColor:{type:String,default:""},inheritedIconColor:{type:String,default:""},inheritedSize:{type:String,default:""},inheritedMapRotation:{type:[String,Number],default:""},defaultLabel:{type:String,default:"Default"},level:{type:String,default:"checkpoint"}},emits:["update:styleType","update:styleColor","update:styleBackgroundShape","update:styleBackgroundColor","update:styleBorderColor","update:styleIconColor","update:styleSize","update:styleMapRotation","change"],setup(e,{emit:t}){const o=e,i=t,s=T(o.styleType),a=T(o.styleColor||""),c=T(o.styleBackgroundShape||"default"),u=T(o.styleBackgroundColor||""),d=T(o.styleBorderColor||""),f=T(o.styleIconColor||""),p=T(o.styleSize||"default"),g=T(o.styleMapRotation||""),k=V=>!V||V==="default"?!1:Xi(V).category==="content",_=T(o.styleType&&o.styleType!=="default"&&o.styleType!=="custom"&&k(o.styleType)?o.styleType:"default"),b=T(!1),C=Z(()=>!!(s.value&&s.value!=="default"||c.value&&c.value!=="default"&&c.value!=="circle"||u.value||d.value||f.value||p.value&&p.value!=="default"&&p.value!=="100")),E=V=>V&&V!==""&&V!=="default",D=V=>V&&V.startsWith("#"),M=Z(()=>{const Q=E(o.inheritedStyleType),de=E(o.inheritedBackgroundShape),Ee=D(o.inheritedBackgroundColor)||D(o.inheritedStyleColor),ge=D(o.inheritedBorderColor),Pe=D(o.inheritedIconColor),Fe=E(o.inheritedSize);if(Q||de||Ee||ge||Pe||Fe){const Me=Q?o.inheritedStyleType:de?o.inheritedBackgroundShape:"circle",ke=(D(o.inheritedBackgroundColor)?o.inheritedBackgroundColor:null)||(D(o.inheritedStyleColor)?o.inheritedStyleColor:null)||cS;return fn({type:Me,backgroundShape:o.inheritedBackgroundShape||"circle",backgroundColor:ke,borderColor:o.inheritedBorderColor||"#ffffff",iconColor:o.inheritedIconColor||"#ffffff",size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#10B981"/>
        <stop offset="50%" style="stop-color:#F59E0B"/>
        <stop offset="100%" style="stop-color:#EF4444"/>
      </linearGradient>
    </defs>
    <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#defaultGradient)" stroke="#fff" stroke-width="1.5"/>
  </svg>`}),S=Z(()=>{const V=o.inheritedMapRotation;return V!==""&&V!==void 0&&V!==null&&V!==0?{transform:`rotate(${V}deg)`}:{}}),$=Z(()=>{if(g.value!==""&&g.value!==void 0&&g.value!==null){const Q=parseInt(g.value,10)||0;if(Q!==0)return{transform:`rotate(${Q}deg)`}}const V=o.inheritedMapRotation;return V!==""&&V!==void 0&&V!==null&&V!==0?{transform:`rotate(${V}deg)`}:{}}),A=Z(()=>{if(C.value){const V=_.value&&_.value!=="none"&&_.value!=="default";let Q=null;o.inheritedStyleType&&o.inheritedStyleType!=="default"&&o.inheritedStyleType!=="custom"&&Xi(o.inheritedStyleType).category==="content"&&(Q=o.inheritedStyleType);const de=_.value==="default"&&Q,Ee=V||de,ge=V?_.value:de?Q:null,Pe=c.value&&c.value!=="default"?c.value:o.inheritedBackgroundShape||"circle",Fe=Ee?ge:Pe,ce=u.value||o.inheritedBackgroundColor||o.inheritedStyleColor||"#667eea",Me=d.value||o.inheritedBorderColor||"#ffffff",ke=f.value||o.inheritedIconColor||"#ffffff";return fn({type:Fe,backgroundShape:Pe,backgroundColor:ce,borderColor:Me,iconColor:ke,size:"75"})}return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#e2e8f0" stroke="#cbd5e0" stroke-width="1.5"/>
    <path d="M12 8v8M8 12h8" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
  </svg>`}),U=()=>{s.value="default",_.value="default",i("update:styleType","default"),c.value="default",u.value="",a.value="",d.value="",f.value="",p.value="default",g.value="",i("update:styleBackgroundShape",""),i("update:styleBackgroundColor",""),i("update:styleColor",""),i("update:styleBorderColor",""),i("update:styleIconColor",""),i("update:styleSize",""),i("update:styleMapRotation",""),q()},I=()=>{b.value=!0},H=V=>{V.iconType==="none"?_.value="none":V.iconType?_.value=V.iconType:_.value="default",c.value=V.backgroundShape||"default",u.value=V.backgroundColor||"",d.value=V.borderColor||"",f.value=V.iconColor||"",p.value=V.size||"default",g.value=V.mapRotation??"";const Q=V.iconType==="none"||V.iconType&&V.iconType!==""||V.backgroundShape||V.backgroundColor||V.borderColor||V.iconColor||V.size||V.mapRotation!==""&&V.mapRotation!==0;V.iconType&&V.iconType!=="none"?s.value=V.iconType:Q?s.value="custom":s.value="default",i("update:styleType",s.value),i("update:styleBackgroundShape",V.backgroundShape),i("update:styleBackgroundColor",V.backgroundColor),i("update:styleBorderColor",V.borderColor),i("update:styleIconColor",V.iconColor),i("update:styleSize",V.size),i("update:styleMapRotation",V.mapRotation??""),q()},O=()=>{},q=()=>{i("change",{styleType:s.value,styleColor:u.value||a.value,styleBackgroundShape:c.value,styleBackgroundColor:u.value,styleBorderColor:d.value,styleIconColor:f.value,styleSize:p.value,styleMapRotation:g.value})};return Ge(()=>o.styleType,V=>{s.value=V,V&&V!=="default"&&V!=="custom"&&k(V)?_.value=V:_.value="default"}),Ge(()=>o.styleColor,V=>{a.value=V||""}),Ge(()=>o.styleBackgroundShape,V=>{c.value=V||"default"}),Ge(()=>o.styleBackgroundColor,V=>{u.value=V||""}),Ge(()=>o.styleBorderColor,V=>{d.value=V||""}),Ge(()=>o.styleIconColor,V=>{f.value=V||""}),Ge(()=>o.styleSize,V=>{p.value=V||"default"}),Ge(()=>o.styleMapRotation,V=>{g.value=V??""}),(V,Q)=>(v(),m("div",oS,[l("div",sS,[l("label",null,w(e.iconLabel),1),l("div",iS,[l("button",{type:"button",class:pe(["style-option-button",{selected:!C.value}]),onClick:U},[l("div",{class:"option-preview",style:rt(S.value),innerHTML:M.value},null,12,aS),l("span",lS,w(e.defaultLabel),1)],2),l("button",{type:"button",class:pe(["style-option-button",{selected:C.value}]),onClick:I},[l("div",{class:"option-preview",style:rt($.value),innerHTML:A.value},null,12,rS),Q[1]||(Q[1]=l("span",{class:"option-label"},"Custom",-1))],2)])]),Oe(nS,{isOpen:b.value,"onUpdate:isOpen":Q[0]||(Q[0]=de=>b.value=de),"icon-type":_.value,"background-shape":c.value,"background-color":u.value,"border-color":d.value,"icon-color":f.value,size:p.value,"map-rotation":g.value,level:e.level,"inherited-type":e.inheritedStyleType,"inherited-background-shape":e.inheritedBackgroundShape,"inherited-background-color":e.inheritedBackgroundColor||e.inheritedStyleColor,"inherited-border-color":e.inheritedBorderColor,"inherited-icon-color":e.inheritedIconColor,"inherited-size":e.inheritedSize,"inherited-map-rotation":e.inheritedMapRotation,onApply:H,onCancel:O},null,8,["isOpen","icon-type","background-shape","background-color","border-color","icon-color","size","map-rotation","level","inherited-type","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])]))}},Gu=je(uS,[["__scopeId","data-v-c066da64"]]),dS={class:"logo-uploader"},hS={key:0,class:"logo-preview"},fS=["src"],pS=["disabled"],vS={key:0,class:"upload-progress"},mS={key:1,class:"upload-prompt"},gS={key:2,class:"error-message"},Zh=5*1024*1024,yS={__name:"LogoUploader",props:{modelValue:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e;function i(){const C={},E=localStorage.getItem("adminEmail");E&&(C["X-Admin-Email"]=E);const D=localStorage.getItem("sessionToken");return D&&(C.Authorization=`Bearer ${D}`),C}const s=t,a=T(null),c=T(!1),u=T(!1),d=T(""),f=["image/png","image/jpeg","image/svg+xml","image/gif","image/webp"];function p(){c.value||a.value?.click()}function g(C){const E=C.target.files?.[0];E&&_(E),a.value&&(a.value.value="")}function k(C){u.value=!1;const E=C.dataTransfer?.files?.[0];E&&_(E)}async function _(C){if(d.value="",!f.includes(C.type)){d.value="Invalid file type. Please use PNG, JPEG, SVG, GIF, or WebP.";return}if(C.size>Zh){d.value=`File too large. Maximum size is ${Zh/(1024*1024)}MB.`;return}c.value=!0;try{const E=await fetch(`${au}/events/${o.eventId}/logo`,{method:"POST",headers:{"Content-Type":C.type,...i()},body:C});if(!E.ok){const M=await E.json().catch(()=>({}));throw new Error(M.message||"Upload failed")}const D=await E.json();s("update:modelValue",D.logoUrl)}catch(E){console.error("Logo upload error:",E),E.name==="TypeError"&&E.message==="Failed to fetch"?d.value="Network error. The file may be too large or the server is unavailable.":d.value=E.message||"Failed to upload logo. Please try again."}finally{c.value=!1}}async function b(){d.value="",c.value=!0;try{const C=await fetch(`${au}/events/${o.eventId}/logo`,{method:"DELETE",headers:i()});if(!C.ok){const E=await C.json().catch(()=>({}));throw new Error(E.message||"Delete failed")}s("update:modelValue","")}catch(C){console.error("Logo delete error:",C),d.value=C.message||"Failed to remove logo. Please try again."}finally{c.value=!1}}return(C,E)=>(v(),m("div",dS,[E[4]||(E[4]=l("label",{class:"uploader-label"},"Event Logo",-1)),e.modelValue?(v(),m("div",hS,[l("img",{src:e.modelValue,alt:"Event logo",class:"logo-image"},null,8,fS),l("button",{type:"button",class:"remove-btn",onClick:b,disabled:c.value}," Remove ",8,pS)])):(v(),m("div",{key:1,class:pe(["upload-area",{"drag-over":u.value,uploading:c.value}]),onDragover:E[0]||(E[0]=ht(D=>u.value=!0,["prevent"])),onDragleave:E[1]||(E[1]=ht(D=>u.value=!1,["prevent"])),onDrop:ht(k,["prevent"]),onClick:p},[l("input",{ref_key:"fileInput",ref:a,type:"file",accept:"image/png,image/jpeg,image/svg+xml,image/gif,image/webp",class:"file-input",onChange:g},null,544),c.value?(v(),m("div",vS,[...E[2]||(E[2]=[l("div",{class:"spinner"},null,-1),l("span",null,"Uploading...",-1)])])):(v(),m("div",mS,[...E[3]||(E[3]=[l("div",{class:"upload-icon"},"+",-1),l("span",{class:"upload-text"},"Click or drag to upload logo",-1),l("span",{class:"upload-hint"},"PNG, JPEG, SVG, GIF, WebP (max 5MB)",-1)])]))],34)),d.value?(v(),m("div",gS,w(d.value),1)):P("",!0)]))}},_S=je(yS,[["__scopeId","data-v-7f31cd0c"]]),wv=[{name:"Default",headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},{name:"Wasp",headerGradientStart:"#333333",headerGradientEnd:"#333333",accentColor:"#FFD700",pageGradientStart:"#FFD700",pageGradientEnd:"#333333"},{name:"Ocean",headerGradientStart:"#0077be",headerGradientEnd:"#00a8e8",accentColor:"#0077be",pageGradientStart:"#0077be",pageGradientEnd:"#00a8e8"},{name:"Forest",headerGradientStart:"#228b22",headerGradientEnd:"#32cd32",accentColor:"#228b22",pageGradientStart:"#228b22",pageGradientEnd:"#32cd32"},{name:"Sunset",headerGradientStart:"#ff6b35",headerGradientEnd:"#f7931e",accentColor:"#ff6b35",pageGradientStart:"#ff6b35",pageGradientEnd:"#f7931e"},{name:"Berry",headerGradientStart:"#8e2de2",headerGradientEnd:"#4a00e0",accentColor:"#8e2de2",pageGradientStart:"#8e2de2",pageGradientEnd:"#4a00e0"},{name:"Coral",headerGradientStart:"#ff758c",headerGradientEnd:"#ff7eb3",accentColor:"#ff758c",pageGradientStart:"#ff758c",pageGradientEnd:"#ff7eb3"},{name:"Steel",headerGradientStart:"#485563",headerGradientEnd:"#29323c",accentColor:"#485563",pageGradientStart:"#485563",pageGradientEnd:"#29323c"},{name:"Mint",headerGradientStart:"#11998e",headerGradientEnd:"#38ef7d",accentColor:"#11998e",pageGradientStart:"#11998e",pageGradientEnd:"#38ef7d"},{name:"Cherry",headerGradientStart:"#eb3349",headerGradientEnd:"#f45c43",accentColor:"#eb3349",pageGradientStart:"#eb3349",pageGradientEnd:"#f45c43"},{name:"Midnight",headerGradientStart:"#232526",headerGradientEnd:"#414345",accentColor:"#5c5c5c",pageGradientStart:"#232526",pageGradientEnd:"#414345"},{name:"Lavender",headerGradientStart:"#a18cd1",headerGradientEnd:"#fbc2eb",accentColor:"#a18cd1",pageGradientStart:"#a18cd1",pageGradientEnd:"#fbc2eb"},{name:"Gold",headerGradientStart:"#f7971e",headerGradientEnd:"#ffd200",accentColor:"#f7971e",pageGradientStart:"#f7971e",pageGradientEnd:"#ffd200"}];function kS(){return{...wv[0]}}function bS(e,t){return{...e,headerGradientStart:t.headerGradientStart,headerGradientEnd:t.headerGradientEnd,accentColor:t.accentColor,pageGradientStart:t.pageGradientStart,pageGradientEnd:t.pageGradientEnd,logoUrl:"",logoPosition:""}}function vu(e){const t=e.replace("#",""),o=parseInt(t.slice(0,2),16)/255,i=parseInt(t.slice(2,4),16)/255,s=parseInt(t.slice(4,6),16)/255,a=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),c=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4);return .2126*a+.7152*c+.0722*u}function Cv(e){return!e||e===""?"#ffffff":vu(e)>.179?"#333333":"#ffffff"}function Lv(e,t){const o=e||Yn.headerGradientStart,i=t||Yn.headerGradientEnd,s=vu(o),a=vu(i);return(s+a)/2>.35?"#333333":"#ffffff"}const Yn={headerGradientStart:"#667eea",headerGradientEnd:"#764ba2",accentColor:"#667eea",pageGradientStart:"#667eea",pageGradientEnd:"#764ba2"},wS={class:"marshal-mockup-container"},CS={class:"presets-section"},LS={class:"presets-row"},SS=["title","onClick"],xS={class:"preset-name"},IS={class:"mockup-frame"},$S={key:0,class:"logo-cover-bg"},TS=["src"],MS=["src"],AS={key:1,class:"logo-placeholder"},ES={class:"event-name"},PS={class:"mockup-buttons"},DS=["src"],OS={key:1,class:"logo-placeholder"},RS={class:"mockup-body"},BS={class:"mockup-card"},NS={class:"card-content"},FS={class:"editor-modal"},US={class:"editor-header"},zS={class:"editor-content"},HS={class:"color-grid-inline"},VS={class:"color-field"},GS={class:"color-swatches"},ZS=["title","onClick"],jS={key:0,class:"check"},qS={class:"color-field"},WS={class:"color-swatches"},KS=["title","onClick"],YS={key:0,class:"check"},JS={class:"logo-position-section"},XS={class:"position-buttons"},QS={class:"color-swatches"},ex=["title","onClick"],tx={key:0,class:"check"},nx={class:"color-grid-inline"},ox={class:"color-field"},sx={class:"color-swatches"},ix=["title","onClick"],ax={key:0,class:"check"},lx={class:"color-field"},rx={class:"color-swatches"},cx=["title","onClick"],ux={key:0,class:"check"},dx={class:"editor-footer"},hx={__name:"MarshalModeMockup",props:{branding:{type:Object,required:!0},eventName:{type:String,default:""},eventDate:{type:String,default:""},eventId:{type:String,required:!0},adminEmail:{type:String,required:!0}},emits:["update:branding"],setup(e,{emit:t}){const o=ro,i=e,s=t,a=T(null),c=wv,u={header:"Header gradient",logo:"Event logo",accent:"Accent colour",page:"Page background"},d=Z(()=>i.branding.headerGradientStart||Yn.headerGradientStart),f=Z(()=>i.branding.headerGradientEnd||Yn.headerGradientEnd),p=Z(()=>i.branding.accentColor||Yn.accentColor),g=Z(()=>i.branding.pageGradientStart||Yn.pageGradientStart),k=Z(()=>i.branding.pageGradientEnd||Yn.pageGradientEnd),_=Z(()=>i.branding.logoPosition||"left"),b=Z(()=>({background:`linear-gradient(135deg, ${d.value} 0%, ${f.value} 100%)`})),C=Z(()=>Lv(d.value,f.value)),E=Z(()=>({background:p.value,color:Cv(p.value)})),D=Z(()=>({background:`linear-gradient(135deg, ${g.value} 0%, ${k.value} 100%)`}));function M(A){a.value=a.value===A?null:A}function S(A,U){s("update:branding",{...i.branding,[A]:U})}function $(A){s("update:branding",bS(i.branding,A)),a.value=null}return(A,U)=>(v(),m("div",wS,[l("div",CS,[U[13]||(U[13]=l("span",{class:"presets-label"},"Quick themes:",-1)),l("div",LS,[(v(!0),m(Se,null,Be(j(c),I=>(v(),m("button",{key:I.name,type:"button",class:"preset-btn",title:I.name,onClick:H=>$(I)},[l("span",{class:"preset-preview",style:rt({background:`linear-gradient(135deg, ${I.pageGradientStart} 0%, ${I.pageGradientEnd} 100%)`})},null,4),l("span",xS,w(I.name),1)],8,SS))),128))])]),l("div",IS,[l("div",{class:pe(["mockup-page",{"region-active":a.value==="page"}]),style:rt(D.value),onClick:U[5]||(U[5]=I=>M("page"))},[l("div",{class:pe(["mockup-header",[{"region-active":a.value==="header"},`logo-${_.value}`]]),style:rt(b.value),onClick:U[3]||(U[3]=ht(I=>M("header"),["stop"]))},[e.branding.logoUrl&&_.value==="cover"?(v(),m("div",$S,[l("img",{src:e.branding.logoUrl,alt:"Logo",class:"logo-cover-img"},null,8,TS)])):P("",!0),_.value==="left"?(v(),m("div",{key:1,class:pe(["mockup-logo logo-left",{"region-active":a.value==="logo"}]),onClick:U[0]||(U[0]=ht(I=>M("logo"),["stop"]))},[e.branding.logoUrl?(v(),m("img",{key:0,src:e.branding.logoUrl,alt:"Logo",class:"logo-img"},null,8,MS)):(v(),m("span",AS,"+ Logo"))],2)):P("",!0),l("div",{class:pe(["header-center",{"region-active":a.value==="logo"&&!e.branding.logoUrl&&_.value!=="left"&&_.value!=="right"}]),onClick:U[1]||(U[1]=ht(I=>M("logo"),["stop"]))},[l("div",{class:"mockup-title",style:rt({color:C.value})},[l("span",ES,w(e.eventName||"Event Name"),1)],4),l("div",{class:"mockup-date",style:rt({color:C.value})},w(e.eventDate||"Event Date"),5),l("div",PS,[U[14]||(U[14]=l("span",{class:"btn-emergency"},"Emergency",-1)),l("span",{class:"btn-logout",style:rt({color:C.value})},"Logout",4)])],2),_.value==="right"?(v(),m("div",{key:2,class:pe(["mockup-logo logo-right",{"region-active":a.value==="logo"}]),onClick:U[2]||(U[2]=ht(I=>M("logo"),["stop"]))},[e.branding.logoUrl?(v(),m("img",{key:0,src:e.branding.logoUrl,alt:"Logo",class:"logo-img"},null,8,DS)):(v(),m("span",OS,"+ Logo"))],2)):P("",!0)],6),l("div",RS,[l("div",BS,[U[15]||(U[15]=l("div",{class:"card-header"},"Your checkpoints (2)",-1)),l("div",NS,[l("div",{class:pe(["mockup-checkin-btn",{"region-active":a.value==="accent"}]),style:rt(E.value),onClick:U[4]||(U[4]=ht(I=>M("accent"),["stop"]))}," GPS Check-In ",6)])])])],6)]),a.value?(v(),m("div",{key:0,class:"editor-overlay",onClick:U[12]||(U[12]=ht(I=>a.value=null,["self"]))},[l("div",FS,[l("div",US,[l("span",null,w(u[a.value]),1),l("button",{type:"button",class:"editor-close",onClick:U[6]||(U[6]=I=>a.value=null)},"")]),l("div",zS,[a.value==="header"?(v(),m(Se,{key:0},[U[18]||(U[18]=l("p",{class:"editor-description"},"Choose the colours for the header gradient.",-1)),l("div",HS,[l("div",VS,[U[16]||(U[16]=l("label",null,"Start colour",-1)),l("div",GS,[(v(!0),m(Se,null,Be(j(o),I=>(v(),m("button",{key:"hs-"+I.hex,type:"button",class:pe(["color-swatch-btn",{selected:e.branding.headerGradientStart===I.hex}]),style:rt({backgroundColor:I.hex}),title:I.name,onClick:H=>S("headerGradientStart",I.hex)},[e.branding.headerGradientStart===I.hex?(v(),m("span",jS,"")):P("",!0)],14,ZS))),128))])]),l("div",qS,[U[17]||(U[17]=l("label",null,"End colour",-1)),l("div",WS,[(v(!0),m(Se,null,Be(j(o),I=>(v(),m("button",{key:"he-"+I.hex,type:"button",class:pe(["color-swatch-btn",{selected:e.branding.headerGradientEnd===I.hex}]),style:rt({backgroundColor:I.hex}),title:I.name,onClick:H=>S("headerGradientEnd",I.hex)},[e.branding.headerGradientEnd===I.hex?(v(),m("span",YS,"")):P("",!0)],14,KS))),128))])])])],64)):P("",!0),a.value==="logo"?(v(),m(Se,{key:1},[l("div",JS,[U[19]||(U[19]=l("label",{class:"editor-label"},"Position",-1)),l("div",XS,[l("button",{type:"button",class:pe(["position-btn",{selected:_.value==="left"}]),onClick:U[7]||(U[7]=I=>S("logoPosition","left"))}," Left ",2),l("button",{type:"button",class:pe(["position-btn",{selected:_.value==="cover"}]),onClick:U[8]||(U[8]=I=>S("logoPosition","cover"))}," Cover ",2),l("button",{type:"button",class:pe(["position-btn",{selected:_.value==="right"}]),onClick:U[9]||(U[9]=I=>S("logoPosition","right"))}," Right ",2)])]),Oe(_S,{"model-value":e.branding.logoUrl,"event-id":e.eventId,"admin-email":e.adminEmail,"onUpdate:modelValue":U[10]||(U[10]=I=>S("logoUrl",I))},null,8,["model-value","event-id","admin-email"])],64)):P("",!0),a.value==="accent"?(v(),m(Se,{key:2},[U[20]||(U[20]=l("p",{class:"editor-description"},"Choose the accent colour for buttons.",-1)),l("div",QS,[(v(!0),m(Se,null,Be(j(o),I=>(v(),m("button",{key:"ac-"+I.hex,type:"button",class:pe(["color-swatch-btn",{selected:e.branding.accentColor===I.hex}]),style:rt({backgroundColor:I.hex}),title:I.name,onClick:H=>S("accentColor",I.hex)},[e.branding.accentColor===I.hex?(v(),m("span",tx,"")):P("",!0)],14,ex))),128))])],64)):P("",!0),a.value==="page"?(v(),m(Se,{key:3},[U[23]||(U[23]=l("p",{class:"editor-description"},"Choose the colours for the page background gradient.",-1)),l("div",nx,[l("div",ox,[U[21]||(U[21]=l("label",null,"Start colour",-1)),l("div",sx,[(v(!0),m(Se,null,Be(j(o),I=>(v(),m("button",{key:"ps-"+I.hex,type:"button",class:pe(["color-swatch-btn",{selected:e.branding.pageGradientStart===I.hex}]),style:rt({backgroundColor:I.hex}),title:I.name,onClick:H=>S("pageGradientStart",I.hex)},[e.branding.pageGradientStart===I.hex?(v(),m("span",ax,"")):P("",!0)],14,ix))),128))])]),l("div",lx,[U[22]||(U[22]=l("label",null,"End colour",-1)),l("div",rx,[(v(!0),m(Se,null,Be(j(o),I=>(v(),m("button",{key:"pe-"+I.hex,type:"button",class:pe(["color-swatch-btn",{selected:e.branding.pageGradientEnd===I.hex}]),style:rt({backgroundColor:I.hex}),title:I.name,onClick:H=>S("pageGradientEnd",I.hex)},[e.branding.pageGradientEnd===I.hex?(v(),m("span",ux,"")):P("",!0)],14,cx))),128))])])])],64)):P("",!0)]),l("div",dx,[l("button",{type:"button",class:"btn-done",onClick:U[11]||(U[11]=I=>a.value=null)},"Done")])])])):P("",!0),U[24]||(U[24]=l("p",{class:"instructions"}," Click on different parts of the preview to customise them. The emergency button stays red for safety. ",-1))]))}},fx=je(hx,[["__scopeId","data-v-55faf78c"]]),px={class:"settings-tab"},vx={class:"accordion"},mx={class:"accordion-section"},gx={class:"accordion-title"},yx={class:"accordion-icon"},_x={key:0,class:"accordion-content"},kx={class:"accordion-section"},bx={class:"accordion-icon"},wx={key:0,class:"accordion-content"},Cx={class:"terminology-grid"},Lx={class:"term-group"},Sx=["value"],xx={class:"term-group"},Ix=["value"],$x={class:"term-group"},Tx=["value"],Mx={class:"term-group"},Ax=["value"],Ex={class:"term-group"},Px=["value"],Dx={class:"form-actions"},Ox=["disabled"],Rx={class:"accordion-section"},Bx={class:"accordion-title"},Nx={class:"accordion-icon"},Fx={key:0,class:"accordion-content"},Ux={class:"section-description"},zx={class:"form-actions"},Hx=["disabled"],Vx={class:"accordion-section"},Gx={class:"accordion-title"},Zx={class:"accordion-icon"},jx={key:0,class:"accordion-content"},qx={class:"section-description"},Wx={class:"form-actions"},Kx=["disabled"],jh="admin_settings_accordion",Yx={__name:"SettingsTab",props:{eventData:{type:Object,required:!0},admins:{type:Array,default:()=>[]},formDirty:{type:Boolean,default:!1},eventId:{type:String,default:""}},emits:["submit","add-admin","remove-admin","update:formDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=bt(),s=za(),a=Z(()=>s.adminEmail||""),c=e,u=t,d=T({...c.eventData}),f=()=>c.eventId?`${jh}_${c.eventId}`:jh,p=T(null);Wt(()=>{const S=localStorage.getItem(f());S&&(p.value=S)});const g=Z(()=>{const S=d.value.peopleTerm||"Marshals";return Ns.checkpoint.map($=>({value:$,label:uu($,S)}))}),k=S=>{const $=p.value===S?null:S;p.value=$,$?localStorage.setItem(f(),$):localStorage.removeItem(f())};Ge(()=>c.eventData,S=>{d.value={...S}},{deep:!0});const _=()=>{u("update:formDirty",!0)},b=(S,$)=>{d.value[S]=$,_()},C=Z(()=>({headerGradientStart:d.value.brandingHeaderGradientStart||"",headerGradientEnd:d.value.brandingHeaderGradientEnd||"",logoUrl:d.value.brandingLogoUrl||"",logoPosition:d.value.brandingLogoPosition||"",accentColor:d.value.brandingAccentColor||"",pageGradientStart:d.value.brandingPageGradientStart||"",pageGradientEnd:d.value.brandingPageGradientEnd||""})),E=S=>{d.value.brandingHeaderGradientStart=S.headerGradientStart,d.value.brandingHeaderGradientEnd=S.headerGradientEnd,d.value.brandingLogoUrl=S.logoUrl,d.value.brandingLogoPosition=S.logoPosition,d.value.brandingAccentColor=S.accentColor,d.value.brandingPageGradientStart=S.pageGradientStart,d.value.brandingPageGradientEnd=S.pageGradientEnd,_()},D=()=>{kS(),d.value.brandingHeaderGradientStart="",d.value.brandingHeaderGradientEnd="",d.value.brandingLogoUrl="",d.value.brandingLogoPosition="",d.value.brandingAccentColor="",d.value.brandingPageGradientStart="",d.value.brandingPageGradientEnd="",_()},M=()=>{u("submit",{...d.value})};return(S,$)=>(v(),m("div",px,[l("div",vx,[l("div",mx,[l("button",{class:pe(["accordion-header",{active:p.value==="admins"}]),onClick:$[0]||($[0]=A=>k("admins"))},[l("span",gx,"Administrators ("+w(e.admins.length)+")",1),l("span",yx,w(p.value==="admins"?"-":"+"),1)],2),p.value==="admins"?(v(),m("div",_x,[Oe(Z2,{admins:e.admins,onAddAdmin:$[1]||($[1]=A=>S.$emit("add-admin")),onRemoveAdmin:$[2]||($[2]=A=>S.$emit("remove-admin",A))},null,8,["admins"])])):P("",!0)]),l("div",kx,[l("button",{class:pe(["accordion-header",{active:p.value==="terminology"}]),onClick:$[3]||($[3]=A=>k("terminology"))},[$[19]||($[19]=l("span",{class:"accordion-title"},"Terminology",-1)),l("span",bx,w(p.value==="terminology"?"-":"+"),1)],2),p.value==="terminology"?(v(),m("div",wx,[$[20]||($[20]=l("p",{class:"section-description"}," Customise how things are named throughout the application. ",-1)),l("div",Cx,[l("div",Lx,[l("label",null,w(j(o).people)+" are called",1),He(l("select",{"onUpdate:modelValue":$[4]||($[4]=A=>d.value.peopleTerm=A),class:"form-input",onChange:_},[(v(!0),m(Se,null,Be(j(Ns).people,A=>(v(),m("option",{key:A,value:A},w(A),9,Sx))),128))],544),[[Tn,d.value.peopleTerm]])]),l("div",xx,[l("label",null,w(j(o).checkpoints)+" are called",1),He(l("select",{"onUpdate:modelValue":$[5]||($[5]=A=>d.value.checkpointTerm=A),class:"form-input",onChange:_},[(v(!0),m(Se,null,Be(g.value,A=>(v(),m("option",{key:A.value,value:A.value},w(A.label),9,Ix))),128))],544),[[Tn,d.value.checkpointTerm]])]),l("div",$x,[l("label",null,w(j(o).areas)+" are called",1),He(l("select",{"onUpdate:modelValue":$[6]||($[6]=A=>d.value.areaTerm=A),class:"form-input",onChange:_},[(v(!0),m(Se,null,Be(j(Ns).area,A=>(v(),m("option",{key:A,value:A},w(A),9,Tx))),128))],544),[[Tn,d.value.areaTerm]])]),l("div",Mx,[l("label",null,w(j(o).checklists)+" are called",1),He(l("select",{"onUpdate:modelValue":$[7]||($[7]=A=>d.value.checklistTerm=A),class:"form-input",onChange:_},[(v(!0),m(Se,null,Be(j(Ns).checklist,A=>(v(),m("option",{key:A,value:A},w(A),9,Ax))),128))],544),[[Tn,d.value.checklistTerm]])]),l("div",Ex,[l("label",null,w(j(o).course)+" is called",1),He(l("select",{"onUpdate:modelValue":$[8]||($[8]=A=>d.value.courseTerm=A),class:"form-input",onChange:_},[(v(!0),m(Se,null,Be(j(Ns).course,A=>(v(),m("option",{key:A,value:A},w(A),9,Px))),128))],544),[[Tn,d.value.courseTerm]])])]),l("div",Dx,[l("button",{onClick:M,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,Ox)])])):P("",!0)]),l("div",Rx,[l("button",{class:pe(["accordion-header",{active:p.value==="appearance"}]),onClick:$[9]||($[9]=A=>k("appearance"))},[l("span",Bx,w(j(o).checkpoint)+" appearance",1),l("span",Nx,w(p.value==="appearance"?"-":"+"),1)],2),p.value==="appearance"?(v(),m("div",Fx,[l("p",Ux," Set the default marker style for all "+w(j(i).checkpoints)+" in this event. Individual "+w(j(i).areas)+" and "+w(j(i).checkpoints)+" can override this setting. ",1),Oe(Gu,{"style-type":d.value.defaultCheckpointStyleType||"default","style-color":d.value.defaultCheckpointStyleColor||"","style-background-shape":d.value.defaultCheckpointStyleBackgroundShape||"","style-background-color":d.value.defaultCheckpointStyleBackgroundColor||"","style-border-color":d.value.defaultCheckpointStyleBorderColor||"","style-icon-color":d.value.defaultCheckpointStyleIconColor||"","style-size":d.value.defaultCheckpointStyleSize||"","style-map-rotation":d.value.defaultCheckpointStyleMapRotation??"","icon-label":"Default marker style",level:"event","show-preview":!0,"onUpdate:styleType":$[10]||($[10]=A=>b("defaultCheckpointStyleType",A)),"onUpdate:styleColor":$[11]||($[11]=A=>b("defaultCheckpointStyleColor",A)),"onUpdate:styleBackgroundShape":$[12]||($[12]=A=>b("defaultCheckpointStyleBackgroundShape",A)),"onUpdate:styleBackgroundColor":$[13]||($[13]=A=>b("defaultCheckpointStyleBackgroundColor",A)),"onUpdate:styleBorderColor":$[14]||($[14]=A=>b("defaultCheckpointStyleBorderColor",A)),"onUpdate:styleIconColor":$[15]||($[15]=A=>b("defaultCheckpointStyleIconColor",A)),"onUpdate:styleSize":$[16]||($[16]=A=>b("defaultCheckpointStyleSize",A)),"onUpdate:styleMapRotation":$[17]||($[17]=A=>b("defaultCheckpointStyleMapRotation",A))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation"]),l("div",zx,[l("button",{onClick:M,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,Hx)])])):P("",!0)]),l("div",Vx,[l("button",{class:pe(["accordion-header",{active:p.value==="branding"}]),onClick:$[18]||($[18]=A=>k("branding"))},[l("span",Gx,w(j(o).person)+" branding",1),l("span",Zx,w(p.value==="branding"?"-":"+"),1)],2),p.value==="branding"?(v(),m("div",jx,[l("p",qx," Customise the appearance of the "+w(j(i).person)+" view to match your organisation's branding. ",1),Oe(fx,{branding:C.value,"event-name":d.value.name,"event-date":j(yv)(d.value.eventDate),"event-id":e.eventId,"admin-email":a.value,"onUpdate:branding":E},null,8,["branding","event-name","event-date","event-id","admin-email"]),l("div",Wx,[l("button",{onClick:D,class:"btn btn-secondary"}," Reset to default "),l("button",{onClick:M,class:"btn btn-primary",disabled:!e.formDirty}," Save ",8,Kx)])])):P("",!0)])])]))}},Jx=je(Yx,[["__scopeId","data-v-c04b872a"]]),Xx={class:"incident-header"},Qx={class:"incident-title-row"},eI={class:"incident-title"},tI={class:"incident-badges"},nI={key:0,class:"incident-description"},oI={class:"incident-context"},sI={key:0,class:"context-item"},iI={key:1,class:"context-item"},aI={key:2,class:"context-item"},lI={class:"incident-footer"},rI={class:"reporter-info"},cI={class:"time-info"},uI={__name:"IncidentCard",props:{incident:{type:Object,required:!0}},emits:["select"],setup(e){const t=e,o=Z(()=>{if(t.incident.title)return t.incident.title;const u=t.incident.description||"";return u.length<=60?u:u.substring(0,57).trim()+"..."}),i=u=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[u]||u,s=u=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[u]||u,a=(u,d=120)=>!u||u.length<=d?u:u.substring(0,d).trim()+"...",c=u=>{if(!u)return"";const d=new Date(u),p=new Date-d,g=Math.floor(p/6e4),k=Math.floor(p/36e5),_=Math.floor(p/864e5);return g<1?"just now":g<60?`${g}m ago`:k<24?`${k}h ago`:_<7?`${_}d ago`:d.toLocaleDateString()};return(u,d)=>(v(),m("div",{class:pe(["incident-card",[`severity-${e.incident.severity}`,`status-${e.incident.status}`]]),onClick:d[0]||(d[0]=f=>u.$emit("select",e.incident))},[l("div",Xx,[l("div",Qx,[l("span",{class:pe(["severity-indicator",e.incident.severity])},null,2),l("strong",eI,w(o.value),1)]),l("div",tI,[l("span",{class:pe(["severity-badge",e.incident.severity])},w(i(e.incident.severity)),3),l("span",{class:pe(["status-badge",e.incident.status])},w(s(e.incident.status)),3)])]),e.incident.title&&e.incident.description?(v(),m("div",nI,w(a(e.incident.description)),1)):P("",!0),l("div",oI,[e.incident.context?.checkpoint?(v(),m("div",sI,[d[1]||(d[1]=l("span",{class:"context-icon"},"",-1)),l("span",null,w(e.incident.context.checkpoint.name),1)])):e.incident.latitude&&e.incident.longitude?(v(),m("div",iI,[...d[2]||(d[2]=[l("span",{class:"context-icon"},"",-1),l("span",null,"GPS Location",-1)])])):P("",!0),e.incident.area?(v(),m("div",aI,[d[3]||(d[3]=l("span",{class:"context-icon"},"",-1)),l("span",null,w(e.incident.area.areaName),1)])):P("",!0)]),l("div",lI,[l("span",rI," Reported by "+w(e.incident.reportedBy?.name||"Unknown"),1),l("span",cI,w(c(e.incident.incidentTime||e.incident.createdAt)),1)])],2))}},Zl=je(uI,[["__scopeId","data-v-690fd385"]]),dI={class:"incidents-tab"},hI={class:"tab-header"},fI={class:"button-group"},pI={key:0,class:"status-pills"},vI={class:"filters-section"},mI={class:"search-group"},gI={class:"incidents-list"},yI={key:0,class:"loading-state"},_I={key:1,class:"empty-state"},kI={__name:"IncidentsTab",props:{incidents:{type:Array,required:!0},areas:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["select-incident","report-incident"],setup(e,{emit:t}){const o=e,i=T(""),s=T("all"),a=k=>{s.value=k},c=Z(()=>o.incidents.filter(k=>k.status==="open").length),u=Z(()=>o.incidents.filter(k=>k.status==="in_progress"||k.status==="acknowledged").length),d=Z(()=>o.incidents.filter(k=>k.status==="resolved").length),f=Z(()=>o.incidents.filter(k=>k.status==="closed").length),p=Z(()=>{let k=o.incidents;if(s.value==="open"?k=k.filter(_=>_.status==="open"):s.value==="in-progress"?k=k.filter(_=>_.status==="in_progress"||_.status==="acknowledged"):s.value==="resolved"?k=k.filter(_=>_.status==="resolved"):s.value==="closed"&&(k=k.filter(_=>_.status==="closed")),i.value.trim()){const _=i.value.toLowerCase().trim().split(/\s+/);k=k.filter(b=>{const C=`${b.context?.checkpoint?.name||""} ${b.context?.checkpoint?.description||""}`,E=b.area?.areaName||"",D=[b.reportedBy?.name||"",...(b.context?.peopleAtCheckpoint||[]).map($=>$.name||"")].join(" "),M=(b.updates||[]).map($=>$.note||"").join(" "),S=`${b.title||""} ${b.description||""} ${C} ${E} ${D} ${M}`.toLowerCase();return _.every($=>S.includes($))})}return k}),g=Z(()=>[...p.value].sort((k,_)=>new Date(_.incidentTime||_.createdAt)-new Date(k.incidentTime||k.createdAt)));return(k,_)=>(v(),m("div",dI,[l("div",hI,[l("div",fI,[l("button",{onClick:_[0]||(_[0]=b=>k.$emit("report-incident")),class:"btn btn-primary"}," Report incident ")]),e.incidents.length>0?(v(),m("div",pI,[Oe(_n,{variant:"neutral",active:s.value==="all",onClick:_[1]||(_[1]=b=>a("all"))},{default:Ue(()=>[Ke(w(e.incidents.length)+" total ",1)]),_:1},8,["active"]),c.value>0?(v(),Ye(_n,{key:0,variant:"info",active:s.value==="open",onClick:_[2]||(_[2]=b=>a("open"))},{default:Ue(()=>[Ke(w(c.value)+" open ",1)]),_:1},8,["active"])):P("",!0),u.value>0?(v(),Ye(_n,{key:1,variant:"purple",active:s.value==="in-progress",onClick:_[3]||(_[3]=b=>a("in-progress"))},{default:Ue(()=>[Ke(w(u.value)+" in progress ",1)]),_:1},8,["active"])):P("",!0),d.value>0?(v(),Ye(_n,{key:2,variant:"success",active:s.value==="resolved",onClick:_[4]||(_[4]=b=>a("resolved"))},{default:Ue(()=>[Ke(w(d.value)+" resolved ",1)]),_:1},8,["active"])):P("",!0),f.value>0?(v(),Ye(_n,{key:3,variant:"neutral",active:s.value==="closed",onClick:_[5]||(_[5]=b=>a("closed"))},{default:Ue(()=>[Ke(w(f.value)+" closed ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),l("div",vI,[l("div",mI,[He(l("input",{"onUpdate:modelValue":_[6]||(_[6]=b=>i.value=b),type:"text",class:"search-input",placeholder:"Search by title, description, location, area, or person..."},null,512),[[nt,i.value]])])]),l("div",gI,[e.loading?(v(),m("div",yI," Loading incidents... ")):p.value.length===0?(v(),m("div",_I,[l("p",null,w(i.value||s.value!=="all"?"No incidents match your search or filter.":"No incidents reported yet."),1)])):P("",!0),(v(!0),m(Se,null,Be(g.value,b=>(v(),Ye(Zl,{key:b.incidentId,incident:b,onSelect:C=>k.$emit("select-incident",b)},null,8,["incident","onSelect"]))),128))])]))}},bI=je(kI,[["__scopeId","data-v-56bde653"]]),wI={class:"checkpoint-card-header"},CI={class:"checkpoint-name-row"},LI=["innerHTML"],SI={class:"checkpoint-name"},xI={key:0,class:"checkpoint-description"},II={key:0,class:"checkpoint-card-areas"},$I={class:"checkpoint-card-stats"},TI={key:0,class:"stat-badge"},MI={key:1,class:"checkpoint-card-marshals"},AI={__name:"CheckpointCard",props:{checkpoint:{type:Object,required:!0},areas:{type:Array,default:()=>[]},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const o=e,i=t,s=Z(()=>o.checkpoint.areaIds||o.checkpoint.AreaIds||[]),a=C=>{const E=o.areas.find(D=>D.id===C);return E?E.name:null},c=C=>{const E=o.areas.find(D=>D.id===C);return E?E.color:"#999"},u=Z(()=>{const C=o.checkpoint,E=C.resolvedStyleBackgroundColor||C.ResolvedStyleBackgroundColor||C.resolvedStyleColor||C.ResolvedStyleColor;return E||(s.value.length>0?c(s.value[0]):"#667eea")}),d=Z(()=>{const C=o.checkpoint;return C.requiredMarshals===0?null:C.checkedInCount>=C.requiredMarshals?"full":C.checkedInCount>0?"partial":"none"}),f=Z(()=>[...o.checkpoint.assignments||[]].sort((E,D)=>(E.marshalName||"").localeCompare(D.marshalName||"",void 0,{sensitivity:"base"}))),p=Z(()=>(o.checkpoint.assignments||[]).length),g=Z(()=>(o.checkpoint.assignments||[]).filter(C=>C.isCheckedIn).length),k=Z(()=>d.value?`staffing-${d.value}`:""),_=Z(()=>{const C=o.checkpoint,E=C.resolvedStyleType||C.ResolvedStyleType,D=C.resolvedStyleBackgroundColor||C.ResolvedStyleBackgroundColor||C.resolvedStyleColor||C.ResolvedStyleColor,M=C.resolvedStyleBorderColor||C.ResolvedStyleBorderColor,S=C.resolvedStyleIconColor||C.ResolvedStyleIconColor,$=C.resolvedStyleBackgroundShape||C.ResolvedStyleBackgroundShape;return E&&E!=="default"||D||M||S||$&&$!=="circle"?fn({type:E||"circle",backgroundShape:$||"circle",backgroundColor:D||"#667eea",borderColor:M||"#ffffff",iconColor:S||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),b=()=>{o.clickable&&i("click",o.checkpoint)};return(C,E)=>(v(),m("div",{class:pe(["checkpoint-card",{"is-clickable":e.clickable,"staffed-full":d.value==="full","staffed-partial":d.value==="partial","staffed-none":d.value==="none"}]),style:rt({borderLeftColor:u.value}),onClick:b},[l("div",wI,[l("div",{class:pe(["checkpoint-card-title",{clickable:e.clickable}])},[l("span",CI,[l("span",{class:"checkpoint-icon",innerHTML:_.value},null,8,LI),l("span",SI,w(e.checkpoint.name),1),e.checkpoint.description?(v(),m("span",xI,"  "+w(e.checkpoint.description),1)):P("",!0)])],2)]),s.value.length>0?(v(),m("div",II,[(v(!0),m(Se,null,Be(s.value,D=>(v(),m("span",{key:D,class:"area-badge",style:rt({backgroundColor:c(D)})},w(a(D)),5))),128))])):P("",!0),l("div",$I,[l("span",{class:pe(["stat-badge staffing-badge",k.value])},w(e.checkpoint.checkedInCount)+"/"+w(e.checkpoint.requiredMarshals)+" staffed ",3),p.value>0?(v(),m("span",TI,w(g.value)+"/"+w(p.value)+" assigned checked in ",1)):P("",!0)]),f.value.length>0?(v(),m("div",MI,[(v(!0),m(Se,null,Be(f.value,D=>(v(),m("span",{key:D.id,class:pe(["marshal-badge",{"checked-in":D.isCheckedIn}])},w(D.marshalName),3))),128))])):P("",!0)],6))}},EI=je(AI,[["__scopeId","data-v-1c5b1185"]]),Sv={__name:"CheckpointsGrid",props:{checkpoints:{type:Array,required:!0},areas:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No checkpoints."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,o)=>(v(),Ye(Gl,{"is-empty":e.checkpoints.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ue(()=>[(v(!0),m(Se,null,Be(e.checkpoints,i=>(v(),Ye(EI,{key:i.id,checkpoint:i,areas:e.areas,clickable:!0,onClick:o[0]||(o[0]=s=>t.$emit("select",s))},null,8,["checkpoint","areas"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},PI={class:"checkpoints-tab"},DI={class:"tab-header"},OI={class:"button-group"},RI={key:0,class:"status-pills"},BI={class:"filters-section"},NI={class:"search-group"},FI=["placeholder"],UI={__name:"CheckpointsList",props:{locations:{type:Array,required:!0},areas:{type:Array,default:()=>[]}},emits:["add-checkpoint-manually","import-checkpoints","select-location"],setup(e){const{termsLower:t}=bt(),o=e,i=T(""),s=T("all"),a=_=>{s.value=_},c=Z(()=>o.locations.filter(_=>_.checkedInCount>=_.requiredMarshals&&_.requiredMarshals>0).length),u=Z(()=>o.locations.filter(_=>_.checkedInCount>0&&_.checkedInCount<_.requiredMarshals).length),d=Z(()=>o.locations.filter(_=>_.checkedInCount===0&&_.requiredMarshals>0).length),f=_=>{const b=o.areas.find(C=>C.id===_);return b?b.name:null},p=Z(()=>{let _=o.locations;if(s.value==="full"?_=_.filter(b=>b.checkedInCount>=b.requiredMarshals&&b.requiredMarshals>0):s.value==="partial"?_=_.filter(b=>b.checkedInCount>0&&b.checkedInCount<b.requiredMarshals):s.value==="missing"&&(_=_.filter(b=>b.checkedInCount===0&&b.requiredMarshals>0)),i.value.trim()){const b=i.value.toLowerCase().trim().split(/\s+/);_=_.filter(C=>{const D=(C.areaIds||C.AreaIds||[]).map($=>f($)||"").join(" "),M=(C.assignments||[]).map($=>$.marshalName||"").join(" "),S=`${C.name||""} ${C.description||""} ${D} ${M}`.toLowerCase();return b.every($=>S.includes($))})}return _}),g=Z(()=>[...p.value].sort((_,b)=>Zs(_.name,b.name))),k=Z(()=>{const _=i.value.trim();return s.value==="full"?_?`No fully staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are fully staffed.`:s.value==="partial"?_?`No partially staffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are partially staffed.`:s.value==="missing"?_?`No unstaffed ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} are unstaffed.`:_?`No ${t.value.checkpoints} match your search.`:`No ${t.value.checkpoints} yet. Add one to get started!`});return(_,b)=>(v(),m("div",PI,[l("div",DI,[l("div",OI,[l("button",{onClick:b[0]||(b[0]=C=>_.$emit("add-checkpoint-manually")),class:"btn btn-primary"}," Add "+w(j(t).checkpoint),1),l("button",{onClick:b[1]||(b[1]=C=>_.$emit("import-checkpoints")),class:"btn btn-secondary"}," Import CSV ")]),e.locations.length>0?(v(),m("div",RI,[Oe(_n,{variant:"neutral",active:s.value==="all",onClick:b[2]||(b[2]=C=>a("all"))},{default:Ue(()=>[Ke(w(e.locations.length)+" total ",1)]),_:1},8,["active"]),c.value>0?(v(),Ye(_n,{key:0,variant:"success",active:s.value==="full",onClick:b[3]||(b[3]=C=>a("full"))},{default:Ue(()=>[Ke(w(c.value)+" fully staffed ",1)]),_:1},8,["active"])):P("",!0),u.value>0?(v(),Ye(_n,{key:1,variant:"warning",active:s.value==="partial",onClick:b[4]||(b[4]=C=>a("partial"))},{default:Ue(()=>[Ke(w(u.value)+" partial ",1)]),_:1},8,["active"])):P("",!0),d.value>0?(v(),Ye(_n,{key:2,variant:"danger",active:s.value==="missing",onClick:b[5]||(b[5]=C=>a("missing"))},{default:Ue(()=>[Ke(w(d.value)+" unstaffed ",1)]),_:1},8,["active"])):P("",!0)])):P("",!0)]),l("div",BI,[l("div",NI,[He(l("input",{"onUpdate:modelValue":b[6]||(b[6]=C=>i.value=C),type:"text",class:"search-input",placeholder:`Search by name, description, ${j(t).area}, or ${j(t).person}...`},null,8,FI),[[nt,i.value]])])]),Oe(Sv,{checkpoints:g.value,areas:e.areas,"empty-message":k.value,onSelect:b[7]||(b[7]=C=>_.$emit("select-location",C))},null,8,["checkpoints","areas","empty-message"])]))}},zI=je(UI,[["__scopeId","data-v-35be2364"]]),HI={class:"area-card-header"},VI={class:"area-name-row"},GI={class:"area-name"},ZI={key:0,class:"default-badge"},jI={key:0,class:"area-description"},qI={class:"area-card-stats"},WI={class:"stat-badge"},KI={class:"stat-badge"},YI={__name:"AreaCard",props:{area:{type:Object,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},clickable:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:t}){const o=e,i=t,s=Z(()=>o.area.checkpointCount!==void 0?o.area.checkpointCount:o.checkpoints.filter(p=>(p.areaIds||p.AreaIds||[]).includes(o.area.id)||p.areaId===o.area.id).length),a=Z(()=>o.contacts.filter(p=>p.scopeConfigurations?p.scopeConfigurations.some(g=>g.scope==="EveryoneInAreas"&&g.itemType==="Area"?g.ids?.includes("ALL_AREAS")?!0:g.ids?.includes(o.area.id):!1):!1).length),c=Z(()=>o.area.peopleTerm||o.eventPeopleTerm||"Marshals"),u=Z(()=>{const p=o.area.checkpointTerm||o.eventCheckpointTerm||"Checkpoints";return s.value===1?Zi("checkpoint",p,c.value):gv("checkpoint",p,c.value)}),d=Z(()=>`${s.value} ${u.value.toLowerCase()}`),f=()=>{o.clickable&&i("click",o.area)};return(p,g)=>(v(),m("div",{class:pe(["area-card",{"is-clickable":e.clickable,"is-default":e.area.isDefault}]),style:rt({borderLeftColor:e.area.color||"#667eea"}),onClick:f},[l("div",HI,[l("div",{class:pe(["area-card-title",{clickable:e.clickable}])},[l("div",VI,[l("span",GI,w(e.area.name),1),e.area.isDefault?(v(),m("span",ZI,"Default")):P("",!0)]),e.area.description?(v(),m("span",jI,w(e.area.description),1)):P("",!0)],2)]),l("div",qI,[l("span",WI,w(d.value),1),l("span",KI,w(a.value)+" contact"+w(a.value===1?"":"s"),1)])],6))}},JI=je(YI,[["__scopeId","data-v-8ac20bf2"]]),XI={__name:"AreasGrid",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},emptyMessage:{type:String,default:"No areas."},emptyHint:{type:String,default:""}},emits:["select"],setup(e){return(t,o)=>(v(),Ye(Gl,{"is-empty":e.areas.length===0,"empty-message":e.emptyMessage,"empty-hint":e.emptyHint},{default:Ue(()=>[(v(!0),m(Se,null,Be(e.areas,i=>(v(),Ye(JI,{key:i.id,area:i,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,clickable:!0,onClick:o[0]||(o[0]=s=>t.$emit("select",s))},null,8,["area","checkpoints","contacts","event-people-term","event-checkpoint-term"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]))}},QI={class:"areas-tab"},e$={class:"tab-header"},t$={class:"button-group"},n$={key:0,class:"status-pills"},o$={class:"filters-section"},s$={class:"search-group"},i$=["placeholder"],a$={__name:"AreasList",props:{areas:{type:Array,required:!0},checkpoints:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"}},emits:["add-area","select-area"],setup(e){const{termsLower:t}=bt(),o=e,i=T(""),s=d=>o.checkpoints.filter(f=>(f.areaIds||f.AreaIds||[]).includes(d)||f.areaId===d),a=Z(()=>{if(!i.value.trim())return o.areas;const d=i.value.toLowerCase().trim().split(/\s+/);return o.areas.filter(f=>{const g=s(f.id).map(_=>`${_.name||""} ${_.description||""}`).join(" "),k=`${f.name||""} ${f.description||""} ${g}`.toLowerCase();return d.every(_=>k.includes(_))})}),c=Z(()=>[...a.value].sort((d,f)=>d.displayOrder!==f.displayOrder?d.displayOrder-f.displayOrder:Zs(d.name,f.name))),u=Z(()=>i.value.trim()?`No ${t.value.areas} match your search.`:`No ${t.value.areas} yet. Click "Add ${t.value.area}" to create one.`);return(d,f)=>(v(),m("div",QI,[l("div",e$,[l("div",t$,[l("button",{onClick:f[0]||(f[0]=p=>d.$emit("add-area")),class:"btn btn-primary"}," Add "+w(j(t).area),1)]),e.areas.length>0?(v(),m("div",n$,[Oe(_n,{variant:"neutral",active:!1},{default:Ue(()=>[Ke(w(e.areas.length)+" "+w(e.areas.length===1?j(t).area:j(t).areas),1)]),_:1})])):P("",!0)]),l("div",o$,[l("div",s$,[He(l("input",{"onUpdate:modelValue":f[1]||(f[1]=p=>i.value=p),type:"text",class:"search-input",placeholder:`Search by ${j(t).area} name or ${j(t).checkpoint} name...`},null,8,i$),[[nt,i.value]])])]),Oe(XI,{areas:c.value,checkpoints:e.checkpoints,contacts:e.contacts,"event-people-term":e.eventPeopleTerm,"event-checkpoint-term":e.eventCheckpointTerm,"empty-message":u.value,onSelect:f[2]||(f[2]=p=>d.$emit("select-area",p))},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term","empty-message"])]))}},l$=je(a$,[["__scopeId","data-v-203f9606"]]),r$={course:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>',checkpoint:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',area:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',marshal:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',checklist:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>',notes:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/></svg>',incidents:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>',details:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16h6"/></svg>',location:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>',map:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>',contacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>',people:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polygon points="22 8 19.5 10 20.5 13 18 11.5 15.5 13 16.5 10 14 8 17 8 18 5 19 8 22 8" fill="currentColor"/></svg>',eventContacts:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 8V6a2 2 0 0 0-2-2h-2"/><path d="M22 12v2a2 2 0 0 1-2 2h-2"/></svg>',event:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>',appearance:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12.5" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>',logout:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>'},yn=e=>r$[e]||"",c$={class:"responsive-tabs"},u$=["onClick"],d$=["innerHTML"],h$=["innerHTML"],f$={class:"hamburger-label"},p$=["onClick"],v$=["innerHTML"],m$={__name:"ResponsiveTabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,i=t,s=T(null),a=T(null),c=T(null),u=T(!1),d=T({}),f=T(!1),p=Z(()=>o.tabs.find(D=>D.value===o.modelValue)),g=Z(()=>p.value?p.value.label:"Menu"),k=()=>{if(u.value=!u.value,u.value&&a.value){const D=a.value.getBoundingClientRect();d.value={top:`${D.bottom+4}px`}}},_=D=>{i("update:modelValue",D),u.value=!1},b=D=>{if(!s.value)return;const M=s.value.contains(D.target);u.value&&!M&&(u.value=!1)},C=()=>{if(!c.value)return;const D=c.value,M=f.value;M&&(D.style.visibility="visible",D.style.position="static");const S=D.scrollWidth>D.clientWidth;M&&(D.style.visibility="",D.style.position=""),f.value=S};let E=null;return Wt(()=>{document.addEventListener("click",b),Un(()=>{C()}),Un(()=>{const D=c.value?.parentElement;D&&(E=new ResizeObserver(()=>{C()}),E.observe(D))})}),zn(()=>{document.removeEventListener("click",b),E&&E.disconnect()}),Ge(()=>o.tabs,()=>{Un(()=>{C()})},{deep:!0}),(D,M)=>(v(),m("div",c$,[l("div",{ref_key:"visibleTabsRef",ref:c,class:pe(["visible-tabs",{"is-hidden":f.value}])},[(v(!0),m(Se,null,Be(e.tabs,S=>(v(),m("button",{key:S.value,class:pe(["tab-button",{active:e.modelValue===S.value}]),onClick:$=>D.$emit("update:modelValue",S.value),type:"button"},[S.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:j(yn)(S.icon)},null,8,d$)):P("",!0),Ke(" "+w(S.label),1)],10,u$))),128))],2),l("div",{class:pe(["hamburger-only",{"is-visible":f.value}])},[l("div",{class:"hamburger-menu",ref_key:"hamburgerMenu",ref:s},[l("button",{ref_key:"hamburgerButton",ref:a,class:pe(["hamburger-button",{active:u.value}]),onClick:ht(k,["stop"]),type:"button"},[M[1]||(M[1]=l("span",{class:"hamburger-icon"},"",-1)),p.value?.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:j(yn)(p.value.icon)},null,8,h$)):P("",!0),l("span",f$,w(g.value),1)],2),u.value?(v(),m("div",{key:0,class:"hamburger-dropdown",style:rt(d.value),onClick:M[0]||(M[0]=ht(()=>{},["stop"]))},[(v(!0),m(Se,null,Be(e.tabs,S=>(v(),m("button",{key:S.value,class:pe(["dropdown-item",{active:e.modelValue===S.value}]),onClick:ht($=>_(S.value),["stop"]),type:"button"},[S.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:j(yn)(S.icon)},null,8,v$)):P("",!0),Ke(" "+w(S.label),1)],10,p$))),128))],4)):P("",!0)],512)],2)]))}},g$=je(m$,[["__scopeId","data-v-2467c6fc"]]),y$={class:"share-link-container"},_$=["value"],k$={__name:"ShareLinkModal",props:{show:{type:Boolean,default:!1},link:{type:String,required:!0},isDirty:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const o=t,i=T(!1),s=T(null),a=()=>{s.value&&(s.value.select(),document.execCommand("copy"),i.value=!0,setTimeout(()=>{i.value=!1},2e3))},c=()=>{o("close")};return(u,d)=>(v(),Ye(zt,{show:e.show,title:"Marshal check-in link",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:c},{actions:Ue(()=>[l("button",{onClick:c,class:"btn btn-secondary"},"Close")]),default:Ue(()=>[d[0]||(d[0]=l("p",{class:"instruction"},"Share this link with marshals so they can check in:",-1)),l("div",y$,[l("input",{value:e.link,readonly:"",class:"form-input",ref_key:"linkInput",ref:s},null,8,_$),l("button",{onClick:a,class:"btn btn-primary"},w(i.value?"Copied!":"Copy"),1)])]),_:1},8,["show","is-dirty"]))}},b$=je(k$,[["__scopeId","data-v-98fe71d6"]]),w$={class:"success-content"},C$={class:"success-message"},L$={class:"link-section"},S$={class:"help-text"},x$={key:0,class:"loading-text"},I$={key:1,class:"magic-link-container"},$$=["value"],T$={class:"magic-link-actions"},M$=["disabled"],A$={key:0,class:"success-text"},E$={key:1,class:"error-text"},P$={key:2,class:"error-text"},D$={__name:"MarshalCreatedModal",props:{show:{type:Boolean,default:!1},eventId:{type:String,required:!0},marshalId:{type:String,default:null},marshalName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const{terms:o}=bt(),i=e,s=t,a=T(""),c=T(!1),u=T(!1),d=T(""),f=T(!1),p=T(!1),g=T(!1),k=T(""),_=async()=>{if(!(!i.eventId||!i.marshalId)){u.value=!0,d.value="";try{const D=await ms.getMagicLink(i.eventId,i.marshalId);a.value=D.data.magicLink,c.value=D.data.hasEmail}catch(D){console.error("Failed to fetch magic link:",D),d.value="Failed to load login link"}finally{u.value=!1}}},b=async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(a.value);else{const D=document.createElement("textarea");D.value=a.value,D.style.position="fixed",D.style.left="-9999px",document.body.appendChild(D),D.select(),document.execCommand("copy"),document.body.removeChild(D)}f.value=!0,setTimeout(()=>{f.value=!1},2e3)}catch(D){console.error("Failed to copy:",D)}},C=async()=>{if(!(!i.eventId||!i.marshalId)){p.value=!0,g.value=!1,k.value="";try{await ms.sendMagicLink(i.eventId,i.marshalId),g.value=!0,setTimeout(()=>{g.value=!1},3e3)}catch(D){console.error("Failed to send email:",D),k.value=D.response?.data?.message||"Failed to send email"}finally{p.value=!1}}},E=()=>{s("close")};return Ge(()=>i.show,D=>{D&&i.marshalId?_():(a.value="",c.value=!1,d.value="",f.value=!1,g.value=!1,k.value="")},{immediate:!0}),(D,M)=>(v(),Ye(zt,{show:e.show,title:`${j(o).person} created`,size:"medium","confirm-on-close":!1,"is-dirty":!1,onClose:E},{actions:Ue(()=>[l("button",{onClick:E,class:"btn btn-primary"},"Done")]),default:Ue(()=>[l("div",w$,[M[2]||(M[2]=l("div",{class:"success-icon"},"",-1)),l("p",C$,[l("strong",null,w(e.marshalName),1),M[1]||(M[1]=Ke(" has been added successfully. ",-1))])]),l("div",L$,[M[3]||(M[3]=l("label",null,"Login link",-1)),l("p",S$," Share this unique link with "+w(e.marshalName)+" so they can access their dashboard and check in. ",1),u.value?(v(),m("div",x$,"Loading link...")):a.value?(v(),m("div",I$,[l("input",{type:"text",value:a.value,readonly:"",class:"form-input magic-link-input",onFocus:M[0]||(M[0]=S=>S.target.select())},null,40,$$),l("div",T$,[l("button",{type:"button",class:"btn btn-secondary",onClick:b},w(f.value?"Copied!":"Copy link"),1),c.value?(v(),m("button",{key:0,type:"button",class:"btn btn-primary",disabled:p.value,onClick:C},w(p.value?"Sending...":"Send via email"),9,M$)):P("",!0)]),g.value?(v(),m("p",A$,"Email sent successfully!")):P("",!0),k.value?(v(),m("p",E$,w(k.value),1)):P("",!0)])):d.value?(v(),m("div",P$,w(d.value),1)):P("",!0)])]),_:1},8,["show","title"]))}},O$=je(D$,[["__scopeId","data-v-e99677e9"]]),R$={class:"form-group"},B$={__name:"AddAdminModal",props:{show:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=T("");Ge(()=>o.show,d=>{d||(s.value="")});const a=()=>{i("update:isDirty",!0)},c=()=>{i("submit",s.value)},u=()=>{i("close")};return(d,f)=>(v(),Ye(zt,{show:e.show,title:"Add event administrator",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:Ue(()=>[l("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:c,class:"btn btn-primary"}," Add administrator ")]),default:Ue(()=>[f[2]||(f[2]=l("p",{class:"instruction"},"Enter the email address of the administrator to add",-1)),l("form",{onSubmit:ht(c,["prevent"])},[l("div",R$,[f[1]||(f[1]=l("label",null,"Email address",-1)),He(l("input",{"onUpdate:modelValue":f[0]||(f[0]=p=>s.value=p),type:"email",required:"",class:"form-input",placeholder:"admin@example.com",onInput:a},null,544),[[nt,s.value]])])],32)]),_:1},8,["show","is-dirty"]))}},N$=je(B$,[["__scopeId","data-v-a82da194"]]),F$={class:"form-group"},U$={key:0,class:"error"},z$=["disabled"],H$={__name:"UploadRouteModal",props:{show:{type:Boolean,default:!1},uploading:{type:Boolean,default:!1},error:{type:String,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=T(null);Ge(()=>o.show,d=>{d||(s.value=null)});const a=d=>{s.value=d.target.files[0],i("update:isDirty",!0)},c=()=>{s.value&&i("submit",s.value)},u=()=>{i("close")};return(d,f)=>(v(),Ye(zt,{show:e.show,title:"Upload GPX route",size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:u},{actions:Ue(()=>[l("button",{type:"button",onClick:u,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:c,class:"btn btn-primary",disabled:e.uploading},w(e.uploading?"Uploading...":"Upload route"),9,z$)]),default:Ue(()=>[f[1]||(f[1]=l("p",{class:"instruction"},"Upload a GPX file to display the event route on the map",-1)),l("form",{onSubmit:ht(c,["prevent"])},[l("div",F$,[f[0]||(f[0]=l("label",null,"GPX file",-1)),l("input",{type:"file",accept:".gpx",onChange:a,required:"",class:"form-input"},null,32)]),e.error?(v(),m("div",U$,w(e.error),1)):P("",!0)],32)]),_:1},8,["show","is-dirty"]))}},V$=je(H$,[["__scopeId","data-v-317975db"]]),G$={class:"instruction"},Z$={class:"form-group"},j$={class:"form-group"},q$={class:"checkbox-label"},W$={key:0,class:"error"},K$={key:1,class:"import-result"},Y$={key:0,class:"import-errors"},J$=["disabled"],X$={__name:"ImportLocationsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=bt(),s=e,a=t,c=T(null),u=T(!1);Ge(()=>s.show,k=>{k||(c.value=null,u.value=!1)});const d=k=>{c.value=k.target.files[0],a("update:isDirty",!0)},f=()=>{a("update:isDirty",!0)},p=()=>{c.value&&a("submit",{file:c.value,deleteExisting:u.value})},g=()=>{a("close")};return(k,_)=>(v(),Ye(zt,{show:e.show,title:`Import ${j(i).checkpoints} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:g},{actions:Ue(()=>[l("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:p,class:"btn btn-primary",disabled:e.importing},w(e.importing?"Importing...":`Import ${j(i).checkpoints}`),9,J$)]),default:Ue(()=>[l("p",G$,"Upload a CSV file with columns: Label, Lat/Latitude, Long/Longitude, What3Words (optional), "+w(j(o).people)+" (optional)",1),_[3]||(_[3]=l("div",{class:"csv-example"},[l("strong",null,"Example CSV format:"),l("pre",null,`Label,Latitude,Longitude,What3Words,Marshals
Checkpoint 1,51.505,-0.09,filled.count.soap,"John Doe, Jane Smith"
Checkpoint 2,51.510,-0.10,index.home.raft,Bob Wilson`)],-1)),l("form",{onSubmit:ht(p,["prevent"])},[l("div",Z$,[_[1]||(_[1]=l("label",null,"CSV file",-1)),l("input",{type:"file",accept:".csv",onChange:d,required:"",class:"form-input"},null,32)]),l("div",j$,[l("label",q$,[He(l("input",{type:"checkbox","onUpdate:modelValue":_[0]||(_[0]=b=>u.value=b),onChange:f},null,544),[[Kr,u.value]]),Ke(" Delete existing "+w(j(i).checkpoints)+" before import ",1)])]),e.error?(v(),m("div",W$,w(e.error),1)):P("",!0),e.result?(v(),m("div",K$,[l("p",null,"Created "+w(e.result.locationsCreated)+" "+w(j(i).checkpoints)+" and "+w(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),m("div",Y$,[_[2]||(_[2]=l("strong",null,"Errors:",-1)),l("ul",null,[(v(!0),m(Se,null,Be(e.result.errors,(b,C)=>(v(),m("li",{key:C},w(b),1))),128))])])):P("",!0)])):P("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},Q$=je(X$,[["__scopeId","data-v-75c79d31"]]),eT={class:"instruction"},tT={class:"form-group"},nT={key:0,class:"error"},oT={key:1,class:"import-result"},sT={key:0,class:"import-errors"},iT=["disabled"],aT={__name:"ImportMarshalsModal",props:{show:{type:Boolean,default:!1},importing:{type:Boolean,default:!1},error:{type:String,default:null},result:{type:Object,default:null},isDirty:{type:Boolean,default:!1}},emits:["close","submit","update:isDirty"],setup(e,{emit:t}){const{terms:o,termsLower:i}=bt(),s=e,a=t,c=T(null);Ge(()=>s.show,p=>{p||(c.value=null)});const u=p=>{c.value=p.target.files[0],a("update:isDirty",!0)},d=()=>{c.value&&a("submit",c.value)},f=()=>{a("close")};return(p,g)=>(v(),Ye(zt,{show:e.show,title:`Import ${j(i).people} from CSV`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:f},{actions:Ue(()=>[l("button",{type:"button",onClick:f,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:d,class:"btn btn-primary",disabled:e.importing},w(e.importing?"Importing...":`Import ${j(i).people}`),9,iT)]),default:Ue(()=>[l("p",eT,"Upload a CSV file with columns: Name, Email (optional), Phone (optional), "+w(j(o).checkpoint)+" (optional)",1),g[2]||(g[2]=l("div",{class:"csv-example"},[l("strong",null,"Example CSV format:"),l("pre",null,`Name,Email,Phone,Checkpoint
John Doe,john@example.com,555-1234,Checkpoint 1
Jane Smith,jane@example.com,555-5678,Checkpoint 2`)],-1)),l("form",{onSubmit:ht(d,["prevent"])},[l("div",tT,[g[0]||(g[0]=l("label",null,"CSV file",-1)),l("input",{type:"file",accept:".csv",onChange:u,required:"",class:"form-input"},null,32)]),e.error?(v(),m("div",nT,w(e.error),1)):P("",!0),e.result?(v(),m("div",oT,[l("p",null,"Imported "+w(e.result.marshalsCreated)+" "+w(j(i).people)+" and "+w(e.result.assignmentsCreated)+" assignments",1),e.result.errors&&e.result.errors.length>0?(v(),m("div",sT,[g[1]||(g[1]=l("strong",null,"Errors:",-1)),l("ul",null,[(v(!0),m(Se,null,Be(e.result.errors,(k,_)=>(v(),m("li",{key:_},w(k),1))),128))])])):P("",!0)])):P("",!0)],32)]),_:1},8,["show","title","is-dirty"]))}},lT=je(aT,[["__scopeId","data-v-be89bf1f"]]),rT=["onClick"],cT=["innerHTML"],uT={class:"hamburger-nav"},dT=["disabled"],hT=["innerHTML"],fT={class:"current-tab-label"},pT=["disabled"],vT={key:0,class:"hamburger-menu"},mT=["onClick"],gT=["innerHTML"],yT=400,_T={__name:"TabHeader",props:{tabs:{type:Array,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,i=t,s=T(null),a=T(null),c=T(null),u=T(!1),d=T(!1),f=Z(()=>{const A=o.tabs.find(U=>U.value===o.modelValue);return A?A.label:""}),p=Z(()=>o.tabs.find(U=>U.value===o.modelValue)?.icon||null),g=Z(()=>o.tabs.findIndex(A=>A.value===o.modelValue)),k=Z(()=>g.value>0),_=Z(()=>g.value<o.tabs.length-1),b=()=>{k.value&&i("update:modelValue",o.tabs[g.value-1].value)},C=()=>{_.value&&i("update:modelValue",o.tabs[g.value+1].value)},E=()=>{if(!s.value)return;const A=s.value.clientWidth;if(A<yT){u.value=!0;return}if(a.value&&!u.value){a.value.scrollWidth>A&&(u.value=!0);return}const U=o.tabs.some(O=>O.icon)?110:90,I=o.tabs.length*U,H=(o.tabs.length-1)*8;I+H<=A&&(u.value=!1,Un(()=>{a.value&&a.value.scrollWidth>A&&(u.value=!0)}))},D=()=>{d.value=!d.value},M=A=>{i("update:modelValue",A),d.value=!1},S=A=>{c.value&&!c.value.contains(A.target)&&(d.value=!1)};let $=null;return Wt(()=>{Un(()=>{E(),s.value&&typeof ResizeObserver<"u"&&($=new ResizeObserver(()=>{E()}),$.observe(s.value)),document.addEventListener("click",S)})}),zn(()=>{$&&$.disconnect(),document.removeEventListener("click",S)}),Ge(()=>o.tabs,()=>{Un(()=>{E()})},{deep:!0}),(A,U)=>(v(),m("div",{class:"tabs-container",ref_key:"containerRef",ref:s},[u.value?(v(),m("div",{key:1,class:"hamburger-container",ref_key:"hamburgerRef",ref:c},[l("div",uT,[l("button",{class:pe(["nav-arrow",{invisible:!k.value}]),onClick:b,type:"button","aria-label":"Previous tab",disabled:!k.value},"  ",10,dT),l("button",{class:"hamburger-button",onClick:D,type:"button","aria-label":"Tab menu"},[p.value?(v(),m("span",{key:0,class:"current-tab-icon",innerHTML:j(yn)(p.value)},null,8,hT)):P("",!0),l("span",fT,w(f.value),1),U[0]||(U[0]=l("span",{class:"hamburger-chevron"},"",-1))]),l("button",{class:pe(["nav-arrow",{invisible:!_.value}]),onClick:C,type:"button","aria-label":"Next tab",disabled:!_.value},"  ",10,pT)]),d.value?(v(),m("div",vT,[(v(!0),m(Se,null,Be(e.tabs,I=>(v(),m("button",{key:I.value,class:pe(["menu-item",{active:e.modelValue===I.value}]),onClick:H=>M(I.value),type:"button"},[I.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:j(yn)(I.icon)},null,8,gT)):P("",!0),Ke(" "+w(I.label),1)],10,mT))),128))])):P("",!0)],512)):(v(),m("div",{key:0,class:"tabs",ref_key:"tabsRef",ref:a},[(v(!0),m(Se,null,Be(e.tabs,I=>(v(),m("button",{key:I.value,class:pe(["tab-button",{active:e.modelValue===I.value}]),onClick:H=>A.$emit("update:modelValue",I.value),type:"button"},[I.icon?(v(),m("span",{key:0,class:"tab-icon",innerHTML:j(yn)(I.icon)},null,8,cT)):P("",!0),Ke(" "+w(I.label),1)],10,rT))),128))],512))],512))}},Ha=je(_T,[["__scopeId","data-v-736c5d0a"]]),kT={class:"tab-content"},bT={class:"form-group"},wT=["value"],CT={class:"form-group"},LT=["value"],ST={class:"form-group"},xT={class:"area-display"},IT={key:0,class:"no-area"},$T={class:"form-help"},TT={class:"form-group checkbox-group"},MT={class:"checkbox-label"},AT=["checked"],ET={class:"form-help"},PT={key:0,class:"custom-times-section"},DT={class:"form-group"},OT=["value"],RT={class:"form-help"},BT={class:"form-group"},NT=["value"],FT={class:"form-help"},UT={__name:"LocationDetailsTab",props:{form:{type:Object,required:!0},areas:{type:Array,default:()=>[]},eventDate:{type:String,default:""},areaTermSingular:{type:String,default:"Area"},areaTermPlural:{type:String,default:"Areas"},checkpointTermSingular:{type:String,default:"checkpoint"},peopleTermPlural:{type:String,default:"marshals"}},emits:["update:form","input","save"],setup(e,{emit:t}){const o=e,i=t,s=Z(()=>(o.form.areaIds||o.form.AreaIds||[]).map(d=>o.areas.find(f=>f.id===d)).filter(d=>d!==void 0)),a=(u,d)=>{i("update:form",{...o.form,[u]:d}),i("input")},c=u=>{const d={...o.form,useCustomTimes:u};if(!u)d.startTime="",d.endTime="";else if(!d.startTime&&!d.endTime&&o.eventDate){const f=Ol(o.eventDate);d.startTime=f,d.endTime=f}i("update:form",d),i("input")};return(u,d)=>(v(),m("div",kT,[l("form",{onSubmit:d[5]||(d[5]=ht(f=>u.$emit("save"),["prevent"]))},[l("div",bT,[d[6]||(d[6]=l("label",null,"Name",-1)),l("input",{value:e.form.name,onInput:d[0]||(d[0]=f=>a("name",f.target.value)),type:"text",required:"",class:"form-input"},null,40,wT)]),l("div",CT,[d[7]||(d[7]=l("label",null,"Description (optional)",-1)),l("input",{value:e.form.description,onInput:d[1]||(d[1]=f=>a("description",f.target.value)),type:"text",class:"form-input"},null,40,LT)]),l("div",ST,[l("label",null,w(e.areaTermSingular)+" (auto-assigned by location)",1),l("div",xT,[s.value.length===0?(v(),m("span",IT," Not in any "+w(e.areaTermSingular.toLowerCase())+" polygon ",1)):P("",!0),(v(!0),m(Se,null,Be(s.value,f=>(v(),m("span",{key:f.id,class:"area-badge",style:rt({backgroundColor:f.color||"var(--brand-primary)"})},w(f.name),5))),128))]),l("small",$T,w(e.areaTermPlural)+" are automatically assigned based on "+w(e.checkpointTermSingular.toLowerCase())+" location within "+w(e.areaTermSingular.toLowerCase())+" boundaries ",1)]),l("div",TT,[l("label",MT,[l("input",{checked:e.form.useCustomTimes,onChange:d[2]||(d[2]=f=>c(f.target.checked)),type:"checkbox"},null,40,AT),l("span",null,"Use custom date/time for this "+w(e.checkpointTermSingular.toLowerCase()),1)]),l("small",ET," By default, "+w(e.peopleTermPlural.toLowerCase())+" are expected during the event date/time. Enable this to set a specific time range. ",1)]),e.form.useCustomTimes?(v(),m("div",PT,[l("div",DT,[d[8]||(d[8]=l("label",null,"Start date & time (optional)",-1)),l("input",{value:e.form.startTime,onInput:d[3]||(d[3]=f=>a("startTime",f.target.value)),type:"datetime-local",class:"form-input"},null,40,OT),l("small",RT," When "+w(e.peopleTermPlural.toLowerCase())+" should arrive at this "+w(e.checkpointTermSingular.toLowerCase()),1)]),l("div",BT,[d[9]||(d[9]=l("label",null,"End date & time (optional)",-1)),l("input",{value:e.form.endTime,onInput:d[4]||(d[4]=f=>a("endTime",f.target.value)),type:"datetime-local",class:"form-input"},null,40,NT),l("small",FT," When "+w(e.peopleTermPlural.toLowerCase())+" can leave this "+w(e.checkpointTermSingular.toLowerCase()),1)])])):P("",!0)],32)]))}},zT=je(UT,[["__scopeId","data-v-aa628901"]]),HT={class:"scope-configuration-editor"},VT={class:"editor-header"},GT={class:"scope-types-list"},ZT=["onClick"],jT={class:"scope-type-label"},qT={class:"scope-type-pill"},WT={class:"expand-label"},KT={class:"expand-icon"},YT={class:"modal-content"},JT={class:"modal-header"},XT={class:"modal-body"},QT={class:"scope-help"},eM={key:0,class:"form-group"},tM={class:"checkbox-label special-option"},nM=["checked"],oM={key:0,class:"specific-selection"},sM=["placeholder"],iM={class:"checkbox-group scrollable"},aM=["checked","onChange"],lM={key:1,class:"form-group"},rM={class:"checkbox-label special-option"},cM=["checked"],uM={key:0,class:"specific-selection"},dM={class:"checkbox-group scrollable"},hM=["checked","onChange"],fM={key:2,class:"form-group"},pM={class:"checkbox-label special-option"},vM=["checked"],mM={key:0,class:"specific-selection"},gM=["placeholder"],yM={class:"checkbox-group scrollable"},_M={key:0,class:"checkbox-label this-checkpoint-option"},kM=["checked"],bM={class:"checkpoint-info"},wM={class:"checkpoint-name"},CM=["checked","onChange"],LM={class:"checkpoint-info"},SM={class:"checkpoint-name"},xM={key:0,class:"checkpoint-description"},IM={__name:"ScopeConfigurationEditor",props:{modelValue:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},excludeScopes:{type:Array,default:()=>[]},headerText:{type:String,default:""},intent:{type:String,default:"completion",validator:e=>["completion","location-update"].includes(e)},currentCheckpointId:{type:String,default:null}},emits:["update:modelValue","user-changed"],setup(e,{emit:t}){const{termsLower:o}=bt(),i=e,s=t,a=Z(()=>[{scope:"SpecificPeople",label:`Specific ${o.value.people}`},{scope:"EveryoneAtCheckpoints",label:`Every ${o.value.person} at specified ${o.value.checkpoints}`},{scope:"OnePerCheckpoint",label:`One ${o.value.person} at each specified ${o.value.checkpoint}`},{scope:"OnePerArea",label:`One ${o.value.person} in specified ${o.value.areas}`},{scope:"EveryoneInAreas",label:`Everyone in specified ${o.value.areas}`},{scope:"EveryAreaLead",label:`Every ${o.value.area} lead at specified ${o.value.areas}`},{scope:"OneLeadPerArea",label:`One lead per specified ${o.value.area}`}]),c=T({SpecificPeople:{enabled:!0,ids:["ALL_MARSHALS"]},EveryoneInAreas:{enabled:!1,ids:[]},EveryoneAtCheckpoints:{enabled:!1,ids:[]},OnePerCheckpoint:{enabled:!1,ids:[]},OnePerArea:{enabled:!1,ids:[]},EveryAreaLead:{enabled:!1,ids:[]},OneLeadPerArea:{enabled:!1,ids:[]}}),u=T(null),d=T(""),f=T(""),p=T(!i.isEditing);let g=!0,k=!1;const _=Z(()=>a.value.filter(fe=>!i.excludeScopes.includes(fe.scope))),b=Z(()=>p.value?_.value:_.value.filter(fe=>q(fe.scope))),C=Z(()=>_.value.filter(Le=>q(Le.scope)).length<_.value.length),E=Z(()=>{const fe=_.value.filter(Le=>q(Le.scope)).length;return _.value.length-fe}),D=Z(()=>!i.currentCheckpointId&&i.intent==="location-update");Ge(()=>i.modelValue,fe=>{if(fe){if(k){k=!1;return}g=!0,Object.keys(c.value).forEach(Le=>{c.value[Le]={enabled:!1,ids:[]}}),fe.forEach(Le=>{Le.scope==="Everyone"?c.value.SpecificPeople={enabled:!0,ids:["ALL_MARSHALS"]}:Le.scope==="AreaLead"?c.value.EveryAreaLead={enabled:!0,ids:[...Le.ids]}:c.value[Le.scope]&&(c.value[Le.scope]={enabled:!0,ids:[...Le.ids]})}),g=!1}},{immediate:!0});const M=()=>{const fe=[];return Object.keys(c.value).forEach(Le=>{const Ae=c.value[Le];if(Ae.enabled){const W={scope:Le,itemType:S(Le),ids:[...Ae.ids]};fe.push(W)}}),fe};Ge(c,()=>{if(g)return;if(Object.keys(c.value).some(Ae=>Ae!=="SpecificPeople"&&c.value[Ae].enabled)&&c.value.SpecificPeople?.ids.includes("ALL_MARSHALS")){const Ae=c.value.SpecificPeople.ids.indexOf("ALL_MARSHALS");c.value.SpecificPeople.ids.splice(Ae,1),c.value.SpecificPeople.ids.length===0&&(c.value.SpecificPeople.enabled=!1)}k=!0;const Le=M();s("update:modelValue",Le),s("user-changed")},{deep:!0});const S=fe=>$(fe)?"Area":A(fe)?"Checkpoint":U(fe)?"Marshal":null,$=fe=>fe==="EveryoneInAreas"||fe==="OnePerArea"||fe==="EveryAreaLead"||fe==="OneLeadPerArea",A=fe=>fe==="EveryoneAtCheckpoints"||fe==="OnePerCheckpoint",U=fe=>fe==="SpecificPeople",I=fe=>{const Le=a.value.find(Ae=>Ae.scope===fe);return Le?Le.label:fe},H=Z(()=>i.headerText?i.headerText:i.intent==="location-update"?"Who can update this location?":"Who can see and complete this item?"),O=fe=>i.intent==="location-update"?{SpecificPeople:`Select "Everyone" or choose specific ${o.value.people} who can update the location`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} can update the location`,OnePerCheckpoint:`Any ${o.value.person} at each selected ${o.value.checkpoint} can update the location`,OnePerArea:`Any ${o.value.person} in each selected ${o.value.area} can update the location`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} can update the location`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} can update the location`,OneLeadPerArea:`Any ${o.value.area} lead at the selected ${o.value.areas} can update the location`}[fe]||"":{SpecificPeople:`Select "Everyone at the event" or choose specific ${o.value.people} who must complete this (personal completion)`,EveryoneAtCheckpoints:`Every ${o.value.person} at the selected ${o.value.checkpoints} must complete this (personal completion)`,OnePerCheckpoint:`One completion needed at each selected ${o.value.checkpoint} (shared completion)`,OnePerArea:`One completion needed in each selected ${o.value.area} (shared completion)`,EveryoneInAreas:`Every ${o.value.person} in the selected ${o.value.areas} must complete this (personal completion)`,EveryAreaLead:`Every ${o.value.area} lead at the selected ${o.value.areas} must complete this individually (personal completion)`,OneLeadPerArea:`One completion per ${o.value.area}, only ${o.value.area} leads can complete (shared among leads)`}[fe]||"",q=fe=>c.value[fe]?.enabled||!1,V=fe=>{const Le=c.value[fe];if(!Le||!Le.enabled)return"No";const Ae=Le.ids||[];if($(fe)){if(Ae.includes("ALL_AREAS"))return`All ${o.value.areas}`;const W=Ae.length;return W>0?`${W} ${W!==1?o.value.areas:o.value.area}`:`Select ${o.value.areas}...`}if(A(fe)){if(Ae.includes("ALL_CHECKPOINTS"))return`All ${o.value.checkpoints}`;if(Ae.length===1&&Ae[0]==="THIS_CHECKPOINT")return`This ${o.value.checkpoint}`;const W=Ae.length;return W>0?`${W} ${W!==1?o.value.checkpoints:o.value.checkpoint}`:`Select ${o.value.checkpoints}...`}if(U(fe)){if(Ae.includes("ALL_MARSHALS"))return"Everyone";const W=Ae.length;return W>0?`${W} ${W!==1?o.value.people:o.value.person}`:`Select ${o.value.people}...`}return"Configured"},Q=fe=>{u.value=fe,d.value="",f.value=""},de=()=>{u.value=null},Ee=()=>{u.value&&(c.value[u.value]={enabled:!1,ids:[]}),de()},ge=()=>u.value&&c.value[u.value]?.ids.includes("ALL_MARSHALS"),Pe=()=>{if(!u.value)return;const fe=c.value[u.value];ge()?(fe.ids=[],fe.enabled=!1):(fe.ids=["ALL_MARSHALS"],fe.enabled=!0)},Fe=fe=>u.value&&c.value[u.value]?.ids.includes(fe),ce=fe=>{if(!u.value)return;const Le=c.value[u.value],Ae=Le.ids.indexOf(fe);Ae>=0?(Le.ids.splice(Ae,1),Le.ids.length===0&&(Le.enabled=!1)):(Le.ids.push(fe),Le.enabled=!0)},Me=Z(()=>{if(!f.value)return i.marshals;const fe=f.value.toLowerCase();return i.marshals.filter(Le=>Le.name.toLowerCase().includes(fe)||Le.email&&Le.email.toLowerCase().includes(fe))}),ke=()=>u.value&&c.value[u.value]?.ids.includes("ALL_AREAS"),re=()=>{if(!u.value)return;const fe=c.value[u.value];ke()?(fe.ids=[],fe.enabled=!1):(fe.ids=["ALL_AREAS"],fe.enabled=!0)},Re=fe=>u.value&&c.value[u.value]?.ids.includes(fe),Je=fe=>{if(!u.value)return;const Le=c.value[u.value],Ae=Le.ids.indexOf(fe);Ae>=0?(Le.ids.splice(Ae,1),Le.ids.length===0&&(Le.enabled=!1)):(Le.ids.push(fe),Le.enabled=!0)},tt=()=>u.value&&c.value[u.value]?.ids.includes("ALL_CHECKPOINTS"),qe=()=>{if(!u.value)return;const fe=c.value[u.value];tt()?(fe.ids=[],fe.enabled=!1):(fe.ids=["ALL_CHECKPOINTS"],fe.enabled=!0)},Qe=fe=>u.value&&c.value[u.value]?.ids.includes(fe),be=fe=>{if(!u.value)return;const Le=c.value[u.value],Ae=Le.ids.indexOf(fe);Ae>=0?(Le.ids.splice(Ae,1),Le.ids.length===0&&(Le.enabled=!1)):(Le.ids.push(fe),Le.enabled=!0)},ze=Z(()=>{let fe=i.locations;if(d.value){const Le=d.value.toLowerCase();fe=fe.filter(Ae=>Ae.name.toLowerCase().includes(Le)||Ae.description&&Ae.description.toLowerCase().includes(Le))}return[...fe].sort((Le,Ae)=>Zs(Le.name,Ae.name))});return(fe,Le)=>(v(),m("div",HT,[l("div",VT,[l("h4",null,w(H.value),1)]),l("div",GT,[(v(!0),m(Se,null,Be(b.value,Ae=>(v(),m("div",{key:Ae.scope,class:pe(["scope-type-row",{active:q(Ae.scope)}]),onClick:W=>Q(Ae.scope)},[l("div",jT,w(Ae.label),1),l("div",qT,w(V(Ae.scope)),1)],10,ZT))),128)),C.value?(v(),m("div",{key:0,class:"expand-row",onClick:Le[0]||(Le[0]=Ae=>p.value=!p.value)},[l("div",WT,w(p.value?"Show less":`Show ${E.value} more option${E.value!==1?"s":""}...`),1),l("div",KT,w(p.value?"":""),1)])):P("",!0)]),u.value?(v(),m("div",{key:0,class:"scope-config-modal",onClick:ht(de,["self"])},[l("div",YT,[l("div",JT,[l("h5",null,w(I(u.value)),1),l("button",{onClick:de,class:"btn-close",type:"button"},"")]),l("div",XT,[l("p",QT,w(O(u.value)),1),U(u.value)?(v(),m("div",eM,[l("label",tM,[l("input",{type:"checkbox",checked:ge(),onChange:Pe},null,40,nM),l("span",null,[Le[4]||(Le[4]=l("strong",null,"Everyone at the event",-1)),Ke(" (all current and future "+w(j(o).people)+")",1)])]),ge()?P("",!0):(v(),m("div",oM,[He(l("input",{"onUpdate:modelValue":Le[1]||(Le[1]=Ae=>f.value=Ae),type:"text",placeholder:`Search ${j(o).people}...`,class:"search-input"},null,8,sM),[[nt,f.value]]),l("div",iM,[(v(!0),m(Se,null,Be(Me.value,Ae=>(v(),m("label",{key:Ae.id,class:"checkbox-label"},[l("input",{type:"checkbox",checked:Fe(Ae.id),onChange:W=>ce(Ae.id)},null,40,aM),l("span",null,w(Ae.name),1)]))),128))])]))])):P("",!0),$(u.value)?(v(),m("div",lM,[l("label",rM,[l("input",{type:"checkbox",checked:ke(),onChange:re},null,40,cM),l("span",null,[l("strong",null,"All "+w(j(o).areas),1),Ke(" (includes future "+w(j(o).areas)+")",1)])]),ke()?P("",!0):(v(),m("div",uM,[l("div",dM,[(v(!0),m(Se,null,Be(e.areas,Ae=>(v(),m("label",{key:Ae.id,class:"checkbox-label"},[l("input",{type:"checkbox",checked:Re(Ae.id),onChange:W=>Je(Ae.id)},null,40,hM),l("span",{class:"area-color-dot",style:rt({backgroundColor:Ae.color||"#667eea"})},null,4),l("span",null,w(Ae.name),1)]))),128))])]))])):P("",!0),A(u.value)?(v(),m("div",fM,[l("label",pM,[l("input",{type:"checkbox",checked:tt(),onChange:qe},null,40,vM),l("span",null,[l("strong",null,"All "+w(j(o).checkpoints),1),Ke(" (includes future "+w(j(o).checkpoints)+")",1)])]),tt()?P("",!0):(v(),m("div",mM,[He(l("input",{"onUpdate:modelValue":Le[2]||(Le[2]=Ae=>d.value=Ae),type:"text",placeholder:`Search ${j(o).checkpoints}...`,class:"search-input"},null,8,gM),[[nt,d.value]]),l("div",yM,[D.value?(v(),m("label",_M,[l("input",{type:"checkbox",checked:Qe("THIS_CHECKPOINT"),onChange:Le[3]||(Le[3]=Ae=>be("THIS_CHECKPOINT"))},null,40,kM),l("div",bM,[l("span",wM,[l("strong",null,"This "+w(j(o).checkpoint),1)])])])):P("",!0),(v(!0),m(Se,null,Be(ze.value,Ae=>(v(),m("label",{key:Ae.id,class:"checkbox-label"},[l("input",{type:"checkbox",checked:Qe(Ae.id),onChange:W=>be(Ae.id)},null,40,CM),l("div",LM,[l("span",SM,w(Ae.name),1),Ae.description?(v(),m("span",xM," - "+w(Ae.description),1)):P("",!0)])]))),128))])]))])):P("",!0)]),l("div",{class:"modal-footer"},[l("button",{onClick:Ee,class:"btn btn-secondary",type:"button"},"Deselect all"),l("button",{onClick:de,class:"btn btn-primary",type:"button"},"Done")])])])):P("",!0)]))}},ic=je(IM,[["__scopeId","data-v-ad360dec"]]),$M={class:"tab-content"},TM={class:"form-group"},MM=["value"],AM={key:0,class:"form-error"},EM={class:"form-row"},PM={class:"form-group"},DM=["disabled"],OM={class:"form-group"},RM=["disabled"],BM={class:"form-group"},NM={class:"accordion-item"},FM={class:"accordion-preview"},UM={class:"accordion-arrow"},zM={key:0,class:"accordion-content"},HM={class:"section-description"},VM={class:"dynamic-checkbox"},GM=["checked"],ZM={key:0,class:"dynamic-settings"},jM={__name:"LocationCoordinatesTab",props:{form:{type:Object,required:!0},isMoving:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:"Checkpoint"},peopleTermPlural:{type:String,default:"Marshals"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:form","input","save","move-location"],setup(e,{emit:t}){const o=e,i=t,s=T(!1),a=T(""),c=T(""),u=_=>_==null||_===""||isNaN(_)?"":Number(_).toFixed(6);Ge(()=>o.form.longitude,_=>{a.value=u(_)},{immediate:!0}),Ge(()=>o.form.latitude,_=>{c.value=u(_)},{immediate:!0});const d=_=>{const b=_==="longitude"?a:c,C=parseFloat(b.value);isNaN(C)?b.value.trim()===""&&(i("update:form",{...o.form,[_]:0}),i("input"),b.value=u(0)):(i("update:form",{...o.form,[_]:C}),i("input"),b.value=u(C))},f=(_,b)=>{i("update:form",{...o.form,[_]:b}),i("input")},p=_=>{if(_){const b=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],C=o.form.locationUpdateScopeConfigurations||[],E=C.length>0?C:b;i("update:form",{...o.form,isDynamic:!0,latitude:0,longitude:0,locationUpdateScopeConfigurations:E})}else i("update:form",{...o.form,isDynamic:!1});i("input")},g=_=>{i("update:form",{...o.form,locationUpdateScopeConfigurations:_}),i("input")},k=_=>{if(!_)return!0;const b=_.includes(".")?_.split("."):_.split("/");if(b.length!==3)return!1;const C=/^[a-z]{1,20}$/;return b.every(E=>C.test(E))};return(_,b)=>(v(),m("div",$M,[l("form",{onSubmit:b[6]||(b[6]=ht(C=>_.$emit("save"),["prevent"]))},[l("div",TM,[b[10]||(b[10]=l("label",null,"What3Words (optional)",-1)),l("input",{value:e.form.what3Words,onInput:b[0]||(b[0]=C=>f("what3Words",C.target.value)),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap"},null,40,MM),e.form.what3Words&&!k(e.form.what3Words)?(v(),m("small",AM," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):P("",!0)]),e.form.isDynamic?P("",!0):(v(),m(Se,{key:0},[l("div",EM,[l("div",PM,[b[11]||(b[11]=l("label",null,"Longitude",-1)),He(l("input",{"onUpdate:modelValue":b[1]||(b[1]=C=>a.value=C),onBlur:b[2]||(b[2]=C=>d("longitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., -0.091234"},null,40,DM),[[nt,a.value]])]),l("div",OM,[b[12]||(b[12]=l("label",null,"Latitude",-1)),He(l("input",{"onUpdate:modelValue":b[3]||(b[3]=C=>c.value=C),onBlur:b[4]||(b[4]=C=>d("latitude")),type:"text",inputmode:"decimal",class:"form-input",disabled:e.isMoving,placeholder:"e.g., 51.505123"},null,40,RM),[[nt,c.value]])])]),l("div",BM,[l("button",{type:"button",onClick:b[5]||(b[5]=C=>_.$emit("move-location")),class:pe(["btn btn-secondary btn-with-icon",{"btn-primary":e.isMoving}])},[b[13]||(b[13]=l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),Ke(" "+w(e.isMoving?"Click on map to set new location...":`Move ${e.checkpointTermSingular.toLowerCase()}...`),1)],2)])],64))],32),l("div",NM,[l("button",{type:"button",class:pe(["accordion-header",{expanded:s.value}]),onClick:b[7]||(b[7]=C=>s.value=!s.value)},[b[14]||(b[14]=Lr('<div class="accordion-icon" data-v-c3ce308d><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-c3ce308d><path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="#F59E0B" opacity="0.3" data-v-c3ce308d></path><path d="M12 6L13.5 9L17 9.5L14.5 12L15 15.5L12 14L9 15.5L9.5 12L7 9.5L10.5 9L12 6Z" fill="#F59E0B" data-v-c3ce308d></path><circle cx="12" cy="11" r="2" fill="white" data-v-c3ce308d></circle></svg></div><span class="accordion-title" data-v-c3ce308d>Dynamic location</span>',2)),l("span",FM,w(e.form.isDynamic?"Enabled":"Disabled"),1),l("span",UM,w(s.value?"":""),1)],2),s.value?(v(),m("div",zM,[l("p",HM," Enable this for lead cars, sweep vehicles, or other moving "+w(e.checkpointTermSingular.toLowerCase())+"s whose location can be updated by designated "+w(e.peopleTermPlural.toLowerCase())+" during the event. ",1),l("label",VM,[l("input",{type:"checkbox",checked:e.form.isDynamic,onChange:b[8]||(b[8]=C=>p(C.target.checked))},null,40,GM),l("span",null,"This "+w(e.checkpointTermSingular.toLowerCase())+" can move",1)]),e.form.isDynamic?(v(),m("div",ZM,[Oe(ic,{"model-value":e.form.locationUpdateScopeConfigurations,areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":e.isEditing,"header-text":`Who can update this ${e.checkpointTermSingular.toLowerCase()}'s location?`,"exclude-scopes":["OnePerCheckpoint","OneLeadPerArea","OnePerArea"],intent:"location-update","current-checkpoint-id":e.form.id,"onUpdate:modelValue":g,onUserChanged:b[9]||(b[9]=C=>_.$emit("input"))},null,8,["model-value","areas","locations","marshals","is-editing","header-text","current-checkpoint-id"])])):P("",!0)])):P("",!0)])]))}},qM=je(jM,[["__scopeId","data-v-c3ce308d"]]);function xv(e){const t=T(new Map),o=p=>t.value.has(p.id)?t.value.get(p.id):p.isCheckedIn;return{pendingCheckInChanges:t,getEffectiveCheckInStatus:o,handleToggleCheckIn:p=>{const k=!o(p);k===p.isCheckedIn?t.value.delete(p.id):t.value.set(p.id,k),e&&e()},getStatusIcon:p=>o(p)?"":"",getStatusColor:p=>o(p)?"#28a745":"#dc3545",getStatusText:p=>o(p)?"Checked in":"Not checked in",formatTime:p=>p?new Date(p).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",clearPendingChanges:()=>{t.value.clear()},getPendingChanges:()=>Array.from(t.value.entries()).map(([p,g])=>({assignmentId:p,shouldBeCheckedIn:g}))}}const WM={class:"card-main"},KM={class:"marshal-name"},YM={key:0,class:"card-check-in"},JM={class:"toggle-icon"},XM={class:"toggle-label"},QM={key:0,class:"check-in-time"},eA={key:0,class:"check-in-method"},tA={key:1,class:"unsaved-indicator"},nA={key:1,class:"card-status-readonly"},oA={class:"status-icon"},sA={key:0,class:"check-in-time"},iA={key:0,class:"check-in-method"},aA={key:2,class:"card-badge"},lA={key:3,class:"card-badge"},rA={__name:"MarshalAssignmentCard",props:{assignment:{type:Object,required:!0},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1}},emits:["click","toggle-check-in","remove","undo-remove"],setup(e,{emit:t}){const o=e,i=t,s=c=>c?new Date(c).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",a=()=>{!o.assignment.isPending&&!o.isMarkedForRemoval&&!o.readOnly&&i("click",o.assignment)};return(c,u)=>(v(),m("div",{class:pe(["marshal-assignment-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval}])},[l("div",WM,[l("div",{class:"card-title",onClick:a},[l("span",KM,w(e.assignment.marshalName),1)]),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.readOnly?(v(),m("div",YM,[l("button",{class:pe(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:u[0]||(u[0]=d=>c.$emit("toggle-check-in",e.assignment))},[l("span",JM,w(e.effectiveCheckInStatus?"":""),1),l("span",XM,w(e.effectiveCheckInStatus?"Checked in":"Check in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(v(),m("span",QM,[Ke(w(s(e.assignment.checkInTime))+" ",1),e.assignment.checkInMethod?(v(),m("span",eA,"("+w(e.assignment.checkInMethod)+")",1)):P("",!0)])):e.hasUnsavedChanges?(v(),m("span",tA," Unsaved ")):P("",!0)])):P("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&e.readOnly?(v(),m("div",nA,[l("span",{class:pe(["status-badge",e.effectiveCheckInStatus?"status-checked-in":"status-not-checked-in"])},[l("span",oA,w(e.effectiveCheckInStatus?"":""),1),Ke(" "+w(e.effectiveCheckInStatus?"Checked in":"Not checked in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime?(v(),m("span",sA,[Ke(w(s(e.assignment.checkInTime))+" ",1),e.assignment.checkInMethod?(v(),m("span",iA,"("+w(e.assignment.checkInMethod)+")",1)):P("",!0)])):P("",!0)])):P("",!0),e.assignment.isPending?(v(),m("div",aA,[...u[3]||(u[3]=[l("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):P("",!0),e.isMarkedForRemoval?(v(),m("div",lA,[...u[4]||(u[4]=[l("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):P("",!0)]),!e.readOnly&&!e.isMarkedForRemoval?(v(),m("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:u[1]||(u[1]=ht(d=>c.$emit("remove",e.assignment),["stop"]))},"  ")):P("",!0),e.isMarkedForRemoval?(v(),m("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:u[2]||(u[2]=ht(d=>c.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):P("",!0)],2))}},cA=je(rA,[["__scopeId","data-v-c345defb"]]),uA={class:"tab-content"},dA={key:0,class:"read-only-notice"},hA={key:1,class:"form-group"},fA=["value"],pA={class:"section-title"},vA={key:2,class:"assign-section"},mA={__name:"LocationAssignmentsTab",props:{form:{type:Object,required:!0},assignments:{type:Array,default:()=>[]},peopleTerm:{type:String,default:"Marshals"},personTerm:{type:String,default:"Marshal"},checkpointTerm:{type:String,default:"Checkpoint"},readOnly:{type:Boolean,default:!1}},emits:["update:form","input","remove-assignment","open-assign-modal","select-marshal"],setup(e,{expose:t,emit:o}){const i=e,s=Z(()=>i.peopleTerm.toLowerCase()),a=Z(()=>i.personTerm.toLowerCase()),c=Z(()=>i.checkpointTerm.toLowerCase()),u=o,{pendingCheckInChanges:d,getEffectiveCheckInStatus:f,handleToggleCheckIn:p}=xv(()=>u("input")),g=T(new Set),k=Z(()=>i.assignments?.length||0),_=Z(()=>i.assignments?[...i.assignments].sort(($,A)=>($.marshalName||"").localeCompare(A.marshalName||"",void 0,{sensitivity:"base"})):[]),b=$=>g.value.has($),C=$=>{$.isPending||u("select-marshal",$)},E=$=>{p($)},D=$=>{$.isPending?u("remove-assignment",$):(g.value.add($.id),u("input"))},M=$=>{g.value.delete($.id),u("input")},S=($,A)=>{u("update:form",{...i.form,[$]:Number(A)}),u("input")};return t({pendingCheckInChanges:d,clearPendingChanges:()=>{d.value.clear(),g.value.clear()},getPendingChanges:()=>Array.from(d.value.entries()).map(([$,A])=>({assignmentId:$,shouldBeCheckedIn:A})),getMarkedForRemoval:()=>Array.from(g.value)}),($,A)=>(v(),m("div",uA,[e.readOnly?(v(),m("div",dA," Viewing from "+w(a.value)+" - "+w(s.value)+" cannot be modified here. ",1)):P("",!0),e.readOnly?P("",!0):(v(),m("div",hA,[l("label",null,"Required "+w(s.value),1),l("input",{value:e.form.requiredMarshals,onInput:A[0]||(A[0]=U=>S("requiredMarshals",U.target.value)),type:"number",min:"1",required:"",class:"form-input"},null,40,fA)])),l("h3",pA,"Assigned "+w(s.value)+" ("+w(k.value)+")",1),Oe(Gl,{"is-empty":e.assignments.length===0,"empty-message":`No ${s.value} assigned yet.`,"empty-hint":`Use the button below to assign ${s.value} to this ${c.value}.`},{default:Ue(()=>[(v(!0),m(Se,null,Be(_.value,U=>(v(),Ye(cA,{key:U.id,assignment:U,"effective-check-in-status":j(f)(U),"has-unsaved-changes":j(d).has(U.id),"is-marked-for-removal":b(U.id),"read-only":e.readOnly,onClick:C,onToggleCheckIn:E,onRemove:D,onUndoRemove:M},null,8,["assignment","effective-check-in-status","has-unsaved-changes","is-marked-for-removal","read-only"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),e.readOnly?P("",!0):(v(),m("div",vA,[l("button",{type:"button",class:"btn btn-primary assign-btn",onClick:A[1]||(A[1]=U=>$.$emit("open-assign-modal"))}," + Assign "+w(a.value)+"... ",1)]))]))}},gA=je(mA,[["__scopeId","data-v-57fc600f"]]),yA={class:"grouped-tasks-list"},_A={key:0,class:"empty-state"},kA={key:1,class:"task-groups"},bA=["onClick"],wA={class:"task-header-content"},CA={class:"task-checkbox-area"},LA={class:"task-info"},SA={class:"task-name"},xA={class:"task-summary"},IA={key:0,class:"modified-badge"},$A={class:"task-scope"},TA=["title"],MA={class:"expand-arrow"},AA={key:0,class:"task-group-details"},EA={class:"detail-checkbox"},PA=["checked","disabled","onChange"],DA={class:"detail-content"},OA={class:"detail-context"},RA={key:0,class:"detail-completion"},BA={key:0,class:"pending-text"},NA={class:"completion-text"},FA={class:"completion-time"},UA={key:1,class:"detail-uncomplete"},zA={key:2,class:"detail-disabled"},HA={__name:"GroupedTasksList",props:{items:{type:Array,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]}},emits:["toggle-complete"],setup(e,{emit:t}){const{terms:o,termsLower:i}=bt(),s=e,a=T(new Set),c=Z(()=>{const b=new Map;for(const C of s.items){b.has(C.itemId)||b.set(C.itemId,{itemId:C.itemId,text:C.text,items:[],totalCount:0,completedCount:0,allCompleted:!1,hasModified:!1});const E=b.get(C.itemId);E.items.push(C),E.totalCount++,C.localIsCompleted&&E.completedCount++,C.isModified&&(E.hasModified=!0)}for(const C of b.values())C.allCompleted=C.completedCount===C.totalCount,C.items.sort((E,D)=>{const M=k(E),S=k(D);return M.localeCompare(S,void 0,{numeric:!0,sensitivity:"base"})});return Array.from(b.values()).sort((C,E)=>C.text.localeCompare(E.text,void 0,{sensitivity:"base"}))}),u=b=>{a.value.has(b)?a.value.delete(b):a.value.add(b),a.value=new Set(a.value)},d=b=>b.hasModified?"status-modified":b.allCompleted?"status-completed":b.completedCount>0?"status-partial":"status-pending",f=b=>b.allCompleted?"":b.completedCount>0?"":"",p=b=>({Everyone:"Everyone",SpecificPeople:"Assigned individually",EveryoneInAreas:`Per ${i.value.area}`,EveryoneAtCheckpoints:`Per ${i.value.checkpoint}`,OnePerCheckpoint:`One per ${i.value.checkpoint}`,OnePerArea:`One per ${i.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${i.value.area}`})[b.matchedScope]||b.matchedScope,g=b=>({Everyone:"This task is for everyone at the event",SpecificPeople:"This task is specifically assigned to certain people",EveryoneInAreas:`This task is for everyone in certain ${i.value.areas}`,EveryoneAtCheckpoints:`This task is for everyone at certain ${i.value.checkpoints}`,OnePerCheckpoint:`One person at the ${i.value.checkpoint} needs to complete this`,OnePerArea:`One person in the ${i.value.area} needs to complete this`,EveryAreaLead:`This task is for ${i.value.area} leads only`,OneLeadPerArea:`One ${i.value.area} lead needs to complete this`})[b.matchedScope]||"",k=b=>{if(!b.completionContextType||!b.completionContextId)return"Everyone";if(b.completionContextType==="Checkpoint"){const C=s.locations.find(E=>E.id===b.completionContextId);return C?C.description?`${C.name} - ${C.description}`:C.name:`${o.value.checkpoint} (unknown)`}if(b.completionContextType==="Area"){const C=s.areas.find(E=>E.id===b.completionContextId);return C?C.name:`${o.value.area} (unknown)`}if(b.completionContextType==="Personal"){if(b.contextOwnerName)return b.contextOwnerName;if(b.completionContextId&&s.marshals.length>0){const C=s.marshals.find(E=>E.id===b.completionContextId||E.marshalId===b.completionContextId);if(C)return C.name||C.marshalName}return"Assigned individually"}return b.completionContextType},_=b=>b?new Date(b).toLocaleString():"";return(b,C)=>(v(),m("div",yA,[c.value.length===0?(v(),m("div",_A,[...C[0]||(C[0]=[l("p",null,"No tasks available.",-1)])])):(v(),m("div",kA,[(v(!0),m(Se,null,Be(c.value,E=>(v(),m("div",{key:E.itemId,class:pe(["task-group",{"all-completed":E.allCompleted,"has-modified":E.hasModified}])},[l("button",{type:"button",class:"task-group-header",onClick:D=>u(E.itemId)},[l("div",wA,[l("div",CA,[l("span",{class:pe(["task-status-icon",d(E)])},w(f(E)),3)]),l("div",LA,[l("div",SA,w(E.text),1),l("div",xA,[l("span",{class:pe(["completion-count",{"all-done":E.allCompleted}])},w(E.completedCount)+"/"+w(E.totalCount)+" completed ",3),E.hasModified?(v(),m("span",IA," Modified ")):P("",!0)])]),l("div",$A,[l("span",{class:"scope-pill",title:g(E.items[0])},w(p(E.items[0])),9,TA)])]),l("span",MA,w(a.value.has(E.itemId)?"":""),1)],8,bA),a.value.has(E.itemId)?(v(),m("div",AA,[(v(!0),m(Se,null,Be(E.items,D=>(v(),m("div",{key:`${D.itemId}-${D.completionContextId}`,class:pe(["task-detail-item",{"item-completed":D.localIsCompleted,"item-modified":D.isModified}])},[l("div",EA,[l("input",{type:"checkbox",checked:D.localIsCompleted,disabled:!D.canBeCompletedByMe&&!D.localIsCompleted,onChange:M=>b.$emit("toggle-complete",D)},null,40,PA)]),l("div",DA,[l("div",OA,w(k(D)),1),D.localIsCompleted?(v(),m("div",RA,[D.isModified&&!D.isCompleted?(v(),m("span",BA," Will be marked as completed ")):(v(),m(Se,{key:1},[l("span",NA,w(D.completedByActorName||"Unknown"),1),l("span",FA,w(_(D.completedAt)),1)],64))])):D.isModified&&D.isCompleted?(v(),m("div",UA,[...C[1]||(C[1]=[l("span",{class:"pending-text"},"Will be marked as incomplete",-1)])])):D.canBeCompletedByMe?P("",!0):(v(),m("div",zA," Already completed by someone else "))])],2))),128))])):P("",!0)],2))),128))]))]))}},Zu=je(HA,[["__scopeId","data-v-409a65e7"]]),VA={class:"checkpoint-checklist-view"},GA={key:0,class:"loading-state"},ZA={key:1,class:"error-state"},jA={key:2,class:"empty-state"},qA={key:3,class:"empty-state"},WA={__name:"CheckpointChecklistView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{termsLower:i}=bt(),s=e,a=o,c=T([]),u=T(!1),d=T(null),f=T(new Map),p=Z(()=>s.assignments.length===0),g=Z(()=>c.value.map(E=>{const D=f.value.get(`${E.itemId}|||${E.completionContextId}`),M=D!==void 0?D.complete:E.isCompleted,S=D!==void 0&&D.complete!==E.isCompleted;return{...E,localIsCompleted:M,isModified:S}})),k=async()=>{if(!(!s.eventId||!s.locationId&&!s.areaId)){u.value=!0,d.value=null;try{const E=s.locationId?await Pt.getCheckpointChecklist(s.eventId,s.locationId):await Pt.getAreaChecklist(s.eventId,s.areaId);if(c.value=E.data||[],s.modelValue&&s.modelValue.length>0){const D=new Map;s.modelValue.forEach(M=>{D.set(`${M.itemId}|||${M.contextId}`,{complete:M.complete,contextType:M.contextType,contextId:M.contextId})}),f.value=D}}catch(E){console.error("Failed to load checklist:",E),d.value=E.response?.data?.message||"Failed to load checklist"}finally{u.value=!1}}},_=E=>{const D=E.contextOwnerMarshalId||(s.assignments.length>0?s.assignments[0].marshalId:null);if(!D)return;const M=`${E.itemId}|||${E.completionContextId}`,S=f.value.get(M),$=S!==void 0?S.complete:E.isCompleted;f.value.set(M,{complete:!$,contextType:E.completionContextType,contextId:E.completionContextId,marshalId:D}),b()},b=()=>{const E=[];for(const[D,M]of f.value.entries()){const[S,$]=D.split("|||"),A=c.value.find(U=>U.itemId===S&&U.completionContextId===$);A&&M.complete!==A.isCompleted&&E.push({itemId:S,complete:M.complete,contextType:M.contextType,contextId:M.contextId,marshalId:M.marshalId})}a("update:modelValue",E),a("change",E)};return t({resetLocalState:()=>{if(f.value=new Map,s.modelValue&&s.modelValue.length>0){const E=new Map;s.modelValue.forEach(D=>{E.set(`${D.itemId}|||${D.contextId}`,{complete:D.complete,contextType:D.contextType,contextId:D.contextId,marshalId:D.marshalId})}),f.value=E}},loadChecklist:k}),Ge(()=>[s.eventId,s.locationId,s.areaId],()=>{k()},{immediate:!0}),(E,D)=>(v(),m("div",VA,[u.value?(v(),m("div",GA," Loading checklist... ")):d.value?(v(),m("div",ZA,[l("p",null,w(d.value),1),l("button",{onClick:k,class:"btn btn-secondary btn-small"}," Retry ")])):p.value?(v(),m("div",jA,[...D[0]||(D[0]=[l("p",null,"No marshals assigned to this checkpoint yet.",-1),l("p",{class:"help-text"},"Assign marshals to enable checklist completion.",-1)])])):c.value.length===0?(v(),m("div",qA,[l("p",null,"No checklist items for this "+w(j(i).checkpoint)+".",1)])):(v(),Ye(Zu,{key:4,items:g.value,locations:e.locations,areas:e.areas,onToggleComplete:_},null,8,["items","locations","areas"]))]))}},Iv=je(WA,[["__scopeId","data-v-9206ecb2"]]),KA={class:"notes-view"},YA={key:0,class:"loading-state"},JA={key:1,class:"error-state"},XA={key:2,class:"empty-state"},QA={key:3,class:"notes-list"},eE={class:"note-header"},tE={class:"note-title-row"},nE={key:0,class:"pin-icon",title:"Pinned"},oE={class:"note-title"},sE={class:"note-meta"},iE={key:0,class:"category-badge"},aE={key:0,class:"note-content"},lE={class:"note-footer"},rE={class:"created-info"},cE={key:0,class:"scope-info"},uE={__name:"NotesView",props:{eventId:{type:String,required:!0},locationId:{type:String,default:null},areaId:{type:String,default:null},marshalId:{type:String,default:null},allNotes:{type:Array,default:null},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},showScope:{type:Boolean,default:!0}},setup(e,{expose:t}){const o=e,i=T([]),s=T(!1),a=T(null),c=Z(()=>o.marshalId?"No notes for this marshal.":o.areaId?"No notes for this area.":o.locationId?"No notes for this checkpoint.":"No notes available."),u=Z(()=>o.areaId?o.locations.filter(D=>D.areaIds&&D.areaIds.includes(o.areaId)):[]),d=Z(()=>u.value.map(D=>D.id)),f=Z(()=>{if(!o.areaId)return[];const D=new Set;return o.assignments.filter(M=>d.value.includes(M.locationId)).forEach(M=>D.add(M.marshalId)),Array.from(D)}),p=D=>o.assignments.filter(M=>M.marshalId===D).map(M=>M.locationId),g=D=>{const M=p(D),S=new Set;for(const $ of M){const A=o.locations.find(U=>U.id===$);A?.areaIds&&A.areaIds.forEach(U=>S.add(U))}return Array.from(S)},k=(D,M)=>{if(!D.scopeConfigurations)return null;for(const S of D.scopeConfigurations){if(S.itemType==="Area"){if(M.type==="area"&&(S.ids.includes(M.areaId)||S.ids.includes("ALL_AREAS")))return{matched:!0,scope:S.scope==="EveryAreaLead"?"Area leads":"Area"};if(M.type==="checkpoint"){const A=o.locations.find(U=>U.id===M.locationId)?.areaIds||[];if(S.ids.includes("ALL_AREAS")||A.some(U=>S.ids.includes(U)))return{matched:!0,scope:S.scope==="EveryAreaLead"?"Area leads":"Area"}}}if(S.itemType==="Checkpoint"){if(M.type==="checkpoint"&&(S.ids.includes(M.locationId)||S.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint"};if(M.type==="area"&&M.checkpointIds.some(A=>S.ids.includes(A)||S.ids.includes("ALL_CHECKPOINTS")))return{matched:!0,scope:"Checkpoint in area"}}if(S.itemType==="Marshal"){if(M.type==="marshal"&&(S.ids.includes(M.marshalId)||S.ids.includes("ALL_MARSHALS")))return{matched:!0,scope:"Marshal"};if(M.type==="checkpoint"){const $=o.assignments.filter(U=>U.locationId===M.locationId).map(U=>U.marshalId);if(S.ids.includes("ALL_MARSHALS")||$.some(U=>S.ids.includes(U)))return{matched:!0,scope:"Marshal at checkpoint"}}if(M.type==="area"&&(S.ids.includes("ALL_MARSHALS")||M.marshalIds.some(A=>S.ids.includes(A))))return{matched:!0,scope:"Marshal in area"}}if(M.type==="marshal"&&M.checkpointIds&&M.areaIds){if(S.itemType==="Checkpoint"&&(S.ids.includes("ALL_CHECKPOINTS")||M.checkpointIds.some(A=>S.ids.includes(A))))return{matched:!0,scope:"Assigned checkpoint"};if(S.itemType==="Area"&&(S.ids.includes("ALL_AREAS")||M.areaIds.some(A=>S.ids.includes(A))))return{matched:!0,scope:S.scope==="EveryAreaLead"?"Area lead":"Area"}}}return null},_=Z(()=>{const D=o.allNotes||i.value;if(!D||D.length===0)return[];if(o.areaId&&o.allNotes){const M={type:"area",areaId:o.areaId,checkpointIds:d.value,marshalIds:f.value},S=[],$=new Set;for(const A of D){if($.has(A.noteId))continue;const U=k(A,M);U&&($.add(A.noteId),S.push({...A,matchedScope:U.scope}))}return S}if(o.locationId&&o.allNotes){const M={type:"checkpoint",locationId:o.locationId},S=[],$=new Set;for(const A of D){if($.has(A.noteId))continue;const U=k(A,M);U&&($.add(A.noteId),S.push({...A,matchedScope:U.scope}))}return S}if(o.marshalId&&o.allNotes){const M=p(o.marshalId),S=g(o.marshalId),$={type:"marshal",marshalId:o.marshalId,checkpointIds:M,areaIds:S},A=[],U=new Set;for(const I of D){if(U.has(I.noteId))continue;const H=k(I,$);H&&(U.add(I.noteId),A.push({...I,matchedScope:H.scope}))}return A}return D}),b=Z(()=>{const D={Emergency:0,Urgent:1,High:2,Normal:3,Low:4};return[..._.value].sort((M,S)=>{if(M.isPinned!==S.isPinned)return M.isPinned?-1:1;const $=D[M.priority]??2,A=D[S.priority]??2;return $!==A?$-A:M.displayOrder!==S.displayOrder?M.displayOrder-S.displayOrder:new Date(S.createdAt)-new Date(M.createdAt)})}),C=async()=>{if(o.allNotes===null&&o.eventId){s.value=!0,a.value=null;try{let D;o.marshalId?D=await Ds.getMarshalNotes(o.eventId,o.marshalId):D=await Ds.getByEvent(o.eventId),i.value=D.data||[]}catch(D){console.error("Failed to load notes:",D),a.value=D.response?.data?.message||"Failed to load notes"}finally{s.value=!1}}};Ge(()=>[o.eventId,o.locationId,o.areaId,o.marshalId],()=>{o.allNotes===null&&C()},{immediate:!0});const E=D=>{if(!D)return"";const M=new Date(D),$=new Date-M,A=Math.floor($/6e4),U=Math.floor($/36e5),I=Math.floor($/864e5);return A<1?"just now":A<60?`${A}m ago`:U<24?`${U}h ago`:I<7?`${I}d ago`:M.toLocaleDateString()};return t({loadNotes:C}),(D,M)=>(v(),m("div",KA,[s.value?(v(),m("div",YA," Loading notes... ")):a.value?(v(),m("div",JA,[l("p",null,w(a.value),1),l("button",{onClick:C,class:"btn btn-secondary btn-small"}," Retry ")])):_.value.length===0?(v(),m("div",XA,[l("p",null,w(c.value),1)])):(v(),m("div",QA,[(v(!0),m(Se,null,Be(b.value,S=>(v(),m("div",{key:S.noteId,class:pe(["note-item",{pinned:S.isPinned}])},[l("div",eE,[l("div",tE,[S.isPinned?(v(),m("span",nE,"")):P("",!0),l("span",{class:pe(["priority-indicator",(S.priority||"Normal").toLowerCase()])},null,2),l("strong",oE,w(S.title),1)]),l("div",sE,[S.category?(v(),m("span",iE,w(S.category),1)):P("",!0),l("span",{class:pe(["priority-badge",(S.priority||"Normal").toLowerCase()])},w(S.priority||"Normal"),3)])]),S.content?(v(),m("div",aE,w(S.content),1)):P("",!0),l("div",lE,[l("span",rE," Created by "+w(S.createdByName||"Unknown")+"  "+w(E(S.createdAt)),1),S.matchedScope&&e.showScope?(v(),m("span",cE,w(S.matchedScope),1)):P("",!0)])],2))),128))]))]))}},ac=je(uE,[["__scopeId","data-v-9fdf0b0b"]]),dE={class:"checklist-preview"},hE={class:"preview-actions"},fE={class:"preview-header"},pE={key:0,class:"add-item-form"},vE=["placeholder"],mE=["disabled"],gE={key:1,class:"pending-items"},yE={class:"item-content"},_E={class:"item-header"},kE={class:"item-text"},bE={class:"item-scope"},wE=["onClick"],CE={key:2,class:"empty-state"},LE={key:0,class:"help-text"},SE={key:3,class:"checklist-items"},xE={class:"item-content"},IE={class:"item-header"},$E={class:"item-text"},TE={class:"item-scope"},ME=["title"],AE={key:0,class:"item-context"},EE={__name:"ChecklistPreviewForLocation",props:{allChecklistItems:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{terms:o,termsLower:i}=bt(),s=e,a=Z(()=>s.checkpointTermSingular?s.checkpointTermSingular.toLowerCase():i.value.checkpoint),c=t,u=T(!1),d=T(""),f=T([...s.modelValue]);Ge(()=>s.modelValue,S=>{f.value=[...S]},{deep:!0});const p=()=>{d.value.trim()&&(f.value.push({text:d.value.trim(),isNew:!0}),d.value="",u.value=!1,k())},g=S=>{f.value.splice(S,1),k()},k=()=>{c("update:modelValue",[...f.value]),c("change")},_=S=>{const $=S.scope,A=S.itemType,U=S.ids||[];return($==="EveryoneAtCheckpoints"||$==="OnePerCheckpoint")&&A==="Checkpoint"?U.includes("ALL_CHECKPOINTS"):$==="OnePerCheckpoint"&&A==="Area"?U.includes("ALL_AREAS")?!0:U.some(I=>s.pendingAreaIds.includes(I)):($==="EveryoneInAreas"||$==="OnePerArea"||$==="EveryAreaLead"||$==="OneLeadPerArea")&&A==="Area"?U.includes("ALL_AREAS")?!0:U.some(I=>s.pendingAreaIds.includes(I)):!1},b=Z(()=>s.allChecklistItems.filter(S=>S.scopeConfigurations&&S.scopeConfigurations.length>0?S.scopeConfigurations.some($=>_($)):!1)),C=S=>({EveryoneAtCheckpoints:`All at ${i.value.checkpoints}`,OnePerCheckpoint:`One per ${i.value.checkpoint}`,EveryoneInAreas:`All in ${i.value.areas}`,OnePerArea:`One per ${i.value.area}`,EveryAreaLead:`${i.value.area} leads`,OneLeadPerArea:`One lead per ${i.value.area}`})[S]||S,E=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"Unknown";const $=S.scopeConfigurations.find(U=>_(U));if(!$)return C(S.scopeConfigurations[0].scope);const A=$.ids||[];return A.includes("ALL_CHECKPOINTS")?`All ${i.value.checkpoints}`:A.includes("ALL_AREAS")?`All ${i.value.areas}`:C($.scope)},D=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"";const $=S.scopeConfigurations.find(U=>_(U));return $&&{EveryoneAtCheckpoints:`This item is for everyone at specified ${i.value.checkpoints}`,OnePerCheckpoint:`One person at each ${i.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${i.value.areas}`,OnePerArea:`One person in each ${i.value.area} needs to complete this`,EveryAreaLead:`This item is for ${i.value.area} leads only`,OneLeadPerArea:`One ${i.value.area} lead needs to complete this`}[$.scope]||""},M=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return null;const $=S.scopeConfigurations.find(I=>_(I));if(!$)return null;const A=$.itemType,U=$.ids||[];if(U.includes("ALL_CHECKPOINTS")||U.includes("ALL_AREAS"))return null;if(A==="Area"){const I=s.areas.filter(H=>U.includes(H.id)&&s.pendingAreaIds.includes(H.id)).map(H=>H.name);if(I.length>0)return`In: ${I.join(", ")}`}return null};return(S,$)=>(v(),m("div",dE,[l("div",hE,[l("p",fE,w(e.isEditing?`Add new ${j(i).checklist} for this ${a.value}:`:`${j(o).checklists} that will apply at this ${a.value}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:$[0]||($[0]=A=>u.value=!u.value)},w(u.value?"Cancel":`Add ${j(i).checklist}`),1)]),u.value?(v(),m("div",pE,[He(l("input",{"onUpdate:modelValue":$[1]||($[1]=A=>d.value=A),type:"text",placeholder:`Enter ${j(i).checklist} text...`,class:"add-item-input",onKeyup:Lp(p,["enter"])},null,40,vE),[[nt,d.value]]),l("button",{type:"button",class:"save-item-btn",disabled:!d.value.trim(),onClick:p}," Add ",8,mE)])):P("",!0),f.value.length>0?(v(),m("div",gE,[(v(!0),m(Se,null,Be(f.value,(A,U)=>(v(),m("div",{key:`pending-${U}`,class:"checklist-item pending"},[$[3]||($[3]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",yE,[l("div",_E,[l("div",kE,w(A.text),1),l("div",bE,[$[2]||($[2]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:I=>g(U),title:"Remove"},"  ",8,wE)])])])]))),128))])):P("",!0),!e.isEditing&&b.value.length===0&&f.value.length===0?(v(),m("div",CE,[l("p",null,"No "+w(j(i).checklists)+" will apply based on the current "+w(j(i).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),m("p",LE," Assign "+w(j(i).areas)+" to see relevant "+w(j(i).checklists)+". ",1)):P("",!0)])):P("",!0),!e.isEditing&&b.value.length>0?(v(),m("div",SE,[(v(!0),m(Se,null,Be(b.value,A=>(v(),m("div",{key:A.id,class:"checklist-item"},[$[4]||($[4]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",xE,[l("div",IE,[l("div",$E,w(A.text),1),l("div",TE,[l("span",{class:"scope-pill",title:D(A)},w(E(A)),9,ME)])]),M(A)?(v(),m("div",AE,w(M(A)),1)):P("",!0)])]))),128))])):P("",!0)]))}},PE=je(EE,[["__scopeId","data-v-7d943b21"]]),DE={class:"notes-preview"},OE={class:"preview-actions"},RE={class:"preview-header"},BE={key:0,class:"add-item-form"},NE={class:"add-form-fields"},FE=["disabled"],UE={key:1,class:"pending-items"},zE={class:"note-header"},HE={class:"note-title"},VE={class:"note-actions"},GE=["onClick"],ZE={key:0,class:"note-content"},jE={key:2,class:"empty-state"},qE={key:0,class:"help-text"},WE={key:3,class:"notes-list"},KE={class:"note-header"},YE={class:"note-title"},JE=["title"],XE={key:0,class:"note-content"},QE={key:1,class:"note-context"},eP={__name:"NotesPreviewForLocation",props:{allNotes:{type:Array,default:()=>[]},pendingAreaIds:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},checkpointTermSingular:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=bt(),i=e,s=t,a=Z(()=>i.checkpointTermSingular?i.checkpointTermSingular.toLowerCase():o.value.checkpoint),c=T(!1),u=T(""),d=T(""),f=T([...i.modelValue]);Ge(()=>i.modelValue,S=>{f.value=[...S]},{deep:!0});const p=()=>{!u.value.trim()&&!d.value.trim()||(f.value.push({title:u.value.trim(),content:d.value.trim(),isNew:!0}),u.value="",d.value="",c.value=!1,k())},g=S=>{f.value.splice(S,1),k()},k=()=>{s("update:modelValue",[...f.value]),s("change")},_=S=>{const $=S.scope,A=S.itemType,U=S.ids||[];return $==="EveryoneAtCheckpoints"&&A==="Checkpoint"?U.includes("ALL_CHECKPOINTS"):$==="EveryoneInAreas"&&A==="Area"?U.includes("ALL_AREAS")?!0:U.some(I=>i.pendingAreaIds.includes(I)):!1},b=Z(()=>i.allNotes.filter(S=>S.scopeConfigurations&&S.scopeConfigurations.length>0?S.scopeConfigurations.some($=>_($)):!1)),C=S=>({EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[S]||S,E=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"Unknown";const $=S.scopeConfigurations.find(U=>_(U));if(!$)return C(S.scopeConfigurations[0].scope);const A=$.ids||[];return A.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:A.includes("ALL_AREAS")?`All ${o.value.areas}`:C($.scope)},D=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"";const $=S.scopeConfigurations.find(U=>_(U));return $&&{EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[$.scope]||""},M=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return null;const $=S.scopeConfigurations.find(I=>_(I));if(!$)return null;const A=$.itemType,U=$.ids||[];if(U.includes("ALL_CHECKPOINTS")||U.includes("ALL_AREAS"))return null;if(A==="Area"){const I=i.areas.filter(H=>U.includes(H.id)&&i.pendingAreaIds.includes(H.id)).map(H=>H.name);if(I.length>0)return`In: ${I.join(", ")}`}return null};return(S,$)=>(v(),m("div",DE,[l("div",OE,[l("p",RE,w(e.isEditing?`Add new note for this ${a.value}:`:`Notes that will be visible at this ${a.value}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:$[0]||($[0]=A=>c.value=!c.value)},w(c.value?"Cancel":"Add note"),1)]),c.value?(v(),m("div",BE,[l("div",NE,[He(l("input",{"onUpdate:modelValue":$[1]||($[1]=A=>u.value=A),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[nt,u.value]]),He(l("textarea",{"onUpdate:modelValue":$[2]||($[2]=A=>d.value=A),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[nt,d.value]])]),l("button",{type:"button",class:"save-item-btn",disabled:!u.value.trim()&&!d.value.trim(),onClick:p}," Add ",8,FE)])):P("",!0),f.value.length>0?(v(),m("div",UE,[(v(!0),m(Se,null,Be(f.value,(A,U)=>(v(),m("div",{key:`pending-${U}`,class:"note-item pending"},[l("div",zE,[l("span",HE,w(A.title||"Untitled"),1),l("div",VE,[$[3]||($[3]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:I=>g(U),title:"Remove"},"  ",8,GE)])]),A.content?(v(),m("div",ZE,w(A.content),1)):P("",!0)]))),128))])):P("",!0),!e.isEditing&&b.value.length===0&&f.value.length===0?(v(),m("div",jE,[l("p",null,"No notes will apply based on the current "+w(j(o).area)+" assignments.",1),e.pendingAreaIds.length===0?(v(),m("p",qE," Assign "+w(j(o).areas)+" to see relevant notes. ",1)):P("",!0)])):P("",!0),!e.isEditing&&b.value.length>0?(v(),m("div",WE,[(v(!0),m(Se,null,Be(b.value,A=>(v(),m("div",{key:A.id,class:"note-item"},[l("div",KE,[l("span",YE,w(A.title||"Untitled"),1),l("span",{class:"scope-pill",title:D(A)},w(E(A)),9,JE)]),A.content?(v(),m("div",XE,w(A.content),1)):P("",!0),M(A)?(v(),m("div",QE,w(M(A)),1)):P("",!0)]))),128))])):P("",!0)]))}},tP=je(eP,[["__scopeId","data-v-71646c3f"]]),nP={class:"base-modal-title modal-title-with-icon"},oP=["innerHTML"],sP={key:7,class:"tab-content appearance-tab"},iP={class:"accordion-item"},aP=["innerHTML"],lP={class:"accordion-title"},rP={class:"accordion-arrow"},cP={key:0,class:"accordion-content"},uP={class:"section-description"},dP={class:"accordion-item"},hP={class:"accordion-preview"},fP={class:"accordion-arrow"},pP={key:0,class:"accordion-content"},vP={class:"section-description"},mP={class:"terminology-row"},gP={class:"terminology-field"},yP=["value"],_P={value:""},kP=["value"],bP={class:"terminology-field"},wP=["value"],CP={value:""},LP=["value"],SP={key:8,class:"tab-content incidents-tab"},xP={class:"incidents-list"},IP={class:"custom-footer"},$P={class:"footer-left"},qh="edit_location_accordion",TP={__name:"EditLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:null},assignments:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventDate:{type:String,default:""},areas:{type:Array,default:()=>[]},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},availableMarshals:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},zIndex:{type:Number,default:1e3},incidents:{type:Array,default:()=>[]},lockedFromMarshal:{type:Boolean,default:!1}},emits:["close","save","delete","move-location","toggle-check-in","remove-assignment","open-assign-modal","update:isDirty","select-incident","select-marshal"],setup(e,{emit:t}){const{terms:o}=bt(),i=e,s=t,a=T("details"),c=T(!1),u=T(null),d=T(null),f=T([]),p=T([]),g=T([]),k=T({id:null,name:"",description:"",what3Words:"",latitude:0,longitude:0,requiredMarshals:1,useCustomTimes:!1,startTime:"",endTime:"",areaIds:[],styleType:"default",styleColor:"",styleBackgroundShape:"",styleBackgroundColor:"",styleBorderColor:"",styleIconColor:"",styleSize:"",styleMapRotation:"",peopleTerm:"",checkpointTerm:"",isDynamic:!1,locationUpdateScopeConfigurations:[]}),_=()=>i.eventId?`${qh}_${i.eventId}`:qh,b=T({iconStyle:!1,terminology:!1});Wt(()=>{const ae=localStorage.getItem(_());if(ae)try{const ie=JSON.parse(ae);b.value={...b.value,...ie}}catch{}});const C=ae=>{b.value[ae]=!b.value[ae],localStorage.setItem(_(),JSON.stringify(b.value))},E=Z(()=>{const ae=k.value.areaIds||[];if(ae.length>0){const ie=i.areas.filter(he=>ae.includes(he.id)&&he.peopleTerm).sort((he,De)=>(he.checkpointCount||0)-(De.checkpointCount||0));if(ie.length>0)return ie[0].peopleTerm}return i.eventPeopleTerm||"Marshals"}),D=Z(()=>k.value.peopleTerm?k.value.peopleTerm:E.value),M=Z(()=>{const ae=k.value.areaIds||[];if(ae.length>0){const ie=i.areas.filter(he=>ae.includes(he.id)&&he.checkpointTerm).sort((he,De)=>(he.checkpointCount||0)-(De.checkpointCount||0));if(ie.length>0)return ie[0].checkpointTerm}return o.value.checkpoint});Z(()=>M.value.toLowerCase());const S=Z(()=>{const ae=k.value.checkpointTerm||i.location?.checkpointTerm||i.location?.CheckpointTerm;if(ae)return Zi("checkpoint",ae,D.value);const ie=k.value.areaIds||[];let he=null;if(ie.length>0){const De=i.areas.filter(Te=>ie.includes(Te.id)&&Te.checkpointTerm).sort((Te,oe)=>(Te.checkpointCount||0)-(oe.checkpointCount||0));De.length>0&&(he=De[0].checkpointTerm)}return he?Zi("checkpoint",he,D.value):o.value.checkpoint}),$=Z(()=>S.value.toLowerCase()),A=Z(()=>{const ae=D.value;return Zi("people",ae)});Z(()=>A.value.toLowerCase());const U=Z(()=>o.value.area);Z(()=>U.value.toLowerCase());const I=Z(()=>o.value.area),H=Z(()=>I.value.toLowerCase()),O=Z(()=>o.value.areas),q=Z(()=>!!(i.location&&i.location.id)),V=Z(()=>q.value?`Edit ${$.value}: ${i.location?.name||""}`:`Add ${$.value}`),Q=Z(()=>{const ae=[{value:"details",label:"Details",icon:"details"},{value:"location",label:"Location",icon:"location"},{value:"marshals",label:D.value,icon:"marshal"},{value:"checklists",label:o.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return i.incidents&&i.incidents.length>0&&ae.push({value:"incidents",label:"Incidents",icon:"incidents"}),ae}),de=Z(()=>Q.value.findIndex(ae=>ae.value===a.value)),Ee=Z(()=>de.value===Q.value.length-1),ge=Z(()=>{const ae=k.value.areaIds||[],ie=i.areas.filter($e=>ae.includes($e.id)).sort(($e,We)=>($e.checkpointCount||0)-(We.checkpointCount||0)),he=($e,We)=>{for(const ot of ie){const st=$e(ot);if(st&&st!=="default")return{value:st,source:"area"}}return We&&We!=="default"?{value:We,source:"event"}:{value:"",source:"none"}},De=he($e=>$e.checkpointStyleType||$e.CheckpointStyleType,i.eventDefaultStyleType),Te=he($e=>$e.checkpointStyleColor||$e.CheckpointStyleColor,i.eventDefaultStyleColor),oe=he($e=>$e.checkpointStyleBackgroundShape||$e.CheckpointStyleBackgroundShape,i.eventDefaultStyleBackgroundShape),ve=he($e=>$e.checkpointStyleBackgroundColor||$e.CheckpointStyleBackgroundColor||$e.checkpointStyleColor||$e.CheckpointStyleColor,i.eventDefaultStyleBackgroundColor||i.eventDefaultStyleColor),se=he($e=>$e.checkpointStyleBorderColor||$e.CheckpointStyleBorderColor,i.eventDefaultStyleBorderColor),te=he($e=>$e.checkpointStyleIconColor||$e.CheckpointStyleIconColor,i.eventDefaultStyleIconColor),X=he($e=>$e.checkpointStyleSize||$e.CheckpointStyleSize,i.eventDefaultStyleSize),N=he($e=>$e.checkpointStyleMapRotation??$e.CheckpointStyleMapRotation,i.eventDefaultStyleMapRotation),ee=[De,oe,ve,se,te,X,N].some($e=>$e.source==="area");return{type:De.value||"default",color:Te.value,backgroundShape:oe.value,backgroundColor:ve.value,borderColor:se.value,iconColor:te.value,size:X.value,mapRotation:N.value,source:ee?"area":De.value?"event":"none"}}),Pe=Z(()=>ge.value.source==="area"?`${I.value} default`:"Event default"),Fe=Z(()=>{const ae=k.value.styleType&&k.value.styleType!=="default"&&k.value.styleType!=="custom"?k.value.styleType:ge.value.type,ie=k.value.styleBackgroundShape||ge.value.backgroundShape||"circle",he=k.value.styleBackgroundColor||ge.value.backgroundColor||"#667eea",De=k.value.styleBorderColor||ge.value.borderColor||"#ffffff",Te=k.value.styleIconColor||ge.value.iconColor||"#ffffff";return fn({type:ae||"circle",backgroundShape:ie,backgroundColor:he,borderColor:De,iconColor:Te,size:"100"})}),ce=Z(()=>{let ae,ie,he,De,Te;return q.value&&i.location?(ae=i.location.resolvedStyleType||i.location.ResolvedStyleType,ie=i.location.resolvedStyleBackgroundShape||i.location.ResolvedStyleBackgroundShape||"circle",he=i.location.resolvedStyleBackgroundColor||i.location.ResolvedStyleBackgroundColor||i.location.resolvedStyleColor||i.location.ResolvedStyleColor||"#667eea",De=i.location.resolvedStyleBorderColor||i.location.ResolvedStyleBorderColor||"#ffffff",Te=i.location.resolvedStyleIconColor||i.location.ResolvedStyleIconColor||"#ffffff"):(ae=k.value.styleType&&k.value.styleType!=="default"&&k.value.styleType!=="custom"?k.value.styleType:ge.value.type,ie=k.value.styleBackgroundShape||ge.value.backgroundShape||"circle",he=k.value.styleBackgroundColor||ge.value.backgroundColor||"#667eea",De=k.value.styleBorderColor||ge.value.borderColor||"#ffffff",Te=k.value.styleIconColor||ge.value.iconColor||"#ffffff"),fn({type:ae||"circle",backgroundShape:ie,backgroundColor:he,borderColor:De,iconColor:Te,size:"100",outputSize:28})}),Me=Z(()=>{const ae=!!k.value.checkpointTerm,ie=!!k.value.peopleTerm;return ae&&ie?`${Zi("checkpoint",k.value.checkpointTerm,k.value.peopleTerm)}, ${k.value.peopleTerm}`:ae?Zi("checkpoint",k.value.checkpointTerm,D.value):ie?k.value.peopleTerm:"Using defaults"}),ke=Z(()=>Ee.value?null:Q.value[de.value+1]),re=Z(()=>ke.value?`${ke.value.label}...`:""),Re=T(!1),Je=T(null);Ge(()=>i.location,ae=>{if(ae){const ie=ae.id||"new";if(Je.value!==ie){Je.value=ie,Re.value=!0;let he="",De="";ae.startTime&&(he=Ol(ae.startTime)),ae.endTime&&(De=Ol(ae.endTime)),k.value={id:ae.id||null,name:ae.name||"",description:ae.description||"",what3Words:ae.what3Words||"",latitude:ae.latitude||0,longitude:ae.longitude||0,requiredMarshals:ae.requiredMarshals||1,useCustomTimes:!!(ae.startTime||ae.endTime),startTime:he,endTime:De,areaIds:ae.areaIds||ae.AreaIds||[],styleType:ae.styleType||ae.StyleType||"default",styleColor:ae.styleColor||ae.StyleColor||"",styleBackgroundShape:ae.styleBackgroundShape||ae.StyleBackgroundShape||"",styleBackgroundColor:ae.styleBackgroundColor||ae.StyleBackgroundColor||"",styleBorderColor:ae.styleBorderColor||ae.StyleBorderColor||"",styleIconColor:ae.styleIconColor||ae.StyleIconColor||"",styleSize:ae.styleSize||ae.StyleSize||"",styleMapRotation:ae.styleMapRotation??ae.StyleMapRotation??"",peopleTerm:ae.peopleTerm||"",checkpointTerm:ae.checkpointTerm||"",isDynamic:ae.isDynamic||!1,locationUpdateScopeConfigurations:ae.locationUpdateScopeConfigurations||[]}}}},{immediate:!0,deep:!0}),Ge(()=>i.show,ae=>{ae?(a.value="details",c.value=!1,f.value=[],p.value=[],g.value=[],u.value?.clearPendingChanges&&u.value.clearPendingChanges(),d.value?.resetLocalState&&d.value.resetLocalState()):(Je.value=null,Re.value=!1)});const tt=ae=>{k.value=ae},qe=()=>{s("update:isDirty",!0)},Qe=()=>{c.value=!c.value,s("move-location",{isMoving:c.value,formData:{...k.value}})},be=ae=>{f.value=ae,qe()},ze=()=>{ke.value&&(a.value=ke.value.value)},fe=()=>{const ae={...k.value,startTime:k.value.useCustomTimes&&k.value.startTime?new Date(k.value.startTime).toISOString():null,endTime:k.value.useCustomTimes&&k.value.endTime?new Date(k.value.endTime).toISOString():null,checkInChanges:u.value?.getPendingChanges?.()||[],assignmentsToRemove:u.value?.getMarkedForRemoval?.()||[],checklistChanges:f.value||[],pendingAssignments:i.assignments.filter(ie=>ie.isPending).map(ie=>({marshalId:ie.marshalId})),pendingNewChecklistItems:p.value,pendingNewNotes:g.value};s("save",ae)},Le=()=>{i.location&&i.location.id&&s("delete",i.location.id)},Ae=ae=>{s("remove-assignment",ae)},W=()=>{s("open-assign-modal")},J=ae=>{s("select-marshal",ae)},ue=()=>{s("close")},ye=(ae,ie)=>{k.value[ae]=ie,qe()};return(ae,ie)=>(v(),Ye(zt,{show:e.show,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:ue},{header:Ue(()=>[l("h2",nP,[ce.value?(v(),m("span",{key:0,class:"modal-title-icon",innerHTML:ce.value},null,8,oP)):P("",!0),Ke(" "+w(V.value),1)])]),"tab-header":Ue(()=>[Oe(Ha,{modelValue:a.value,"onUpdate:modelValue":ie[0]||(ie[0]=he=>a.value=he),tabs:Q.value},null,8,["modelValue","tabs"])]),footer:Ue(()=>[l("div",IP,[l("div",$P,[q.value&&!e.lockedFromMarshal?(v(),m("button",{key:0,type:"button",onClick:Le,class:"btn btn-danger"}," Delete "+w($.value),1)):P("",!0),!q.value&&!Ee.value?(v(),m("button",{key:1,type:"button",onClick:ze,class:"btn btn-secondary mobile-only"},w(re.value),1)):P("",!0)]),l("button",{type:"button",onClick:fe,class:"btn btn-success"}," Save ")])]),default:Ue(()=>[a.value==="details"?(v(),Ye(zT,{key:0,form:k.value,areas:e.areas,"event-date":e.eventDate,"area-term-singular":I.value,"area-term-plural":O.value,"checkpoint-term-singular":S.value,"people-term-plural":D.value,"onUpdate:form":tt,onInput:qe,onSave:fe},null,8,["form","areas","event-date","area-term-singular","area-term-plural","checkpoint-term-singular","people-term-plural"])):P("",!0),a.value==="location"?(v(),Ye(qM,{key:1,form:k.value,"is-moving":c.value,"checkpoint-term-singular":S.value,"people-term-plural":D.value,areas:e.areas,locations:e.allLocations,marshals:e.availableMarshals,"is-editing":q.value,"onUpdate:form":tt,onInput:qe,onSave:fe,onMoveLocation:Qe},null,8,["form","is-moving","checkpoint-term-singular","people-term-plural","areas","locations","marshals","is-editing"])):P("",!0),a.value==="marshals"?(v(),Ye(gA,{key:2,ref_key:"assignmentsTabRef",ref:u,form:k.value,assignments:e.assignments,"people-term":D.value,"person-term":A.value,"checkpoint-term":S.value,"read-only":e.lockedFromMarshal,"onUpdate:form":tt,onInput:qe,onRemoveAssignment:Ae,onOpenAssignModal:W,onSelectMarshal:J},null,8,["form","assignments","people-term","person-term","checkpoint-term","read-only"])):P("",!0),a.value==="checklists"&&q.value?(v(),Ye(Iv,{key:3,ref_key:"checklistTabRef",ref:d,modelValue:f.value,"onUpdate:modelValue":ie[1]||(ie[1]=he=>f.value=he),"event-id":e.eventId,"location-id":e.location.id,locations:e.allLocations,areas:e.areas,assignments:e.assignments,onChange:be},null,8,["modelValue","event-id","location-id","locations","areas","assignments"])):P("",!0),a.value==="checklists"?(v(),Ye(PE,{key:4,modelValue:p.value,"onUpdate:modelValue":ie[2]||(ie[2]=he=>p.value=he),"all-checklist-items":e.allChecklistItems,"pending-area-ids":k.value.areaIds,areas:e.areas,"is-editing":q.value,"checkpoint-term-singular":S.value,onChange:qe},null,8,["modelValue","all-checklist-items","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):P("",!0),a.value==="notes"&&q.value?(v(),Ye(ac,{key:5,"event-id":e.eventId,"location-id":e.location?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","location-id","all-notes","locations","areas","assignments"])):P("",!0),a.value==="notes"?(v(),Ye(tP,{key:6,modelValue:g.value,"onUpdate:modelValue":ie[3]||(ie[3]=he=>g.value=he),"all-notes":e.notes,"pending-area-ids":k.value.areaIds,areas:e.areas,"is-editing":q.value,"checkpoint-term-singular":S.value,onChange:qe},null,8,["modelValue","all-notes","pending-area-ids","areas","is-editing","checkpoint-term-singular"])):P("",!0),a.value==="appearance"?(v(),m("div",sP,[l("div",iP,[l("button",{type:"button",class:pe(["accordion-header",{expanded:b.value.iconStyle}]),onClick:ie[4]||(ie[4]=he=>C("iconStyle"))},[l("div",{class:"accordion-icon",innerHTML:Fe.value},null,8,aP),l("span",lP,w(S.value)+" marker style",1),l("span",rP,w(b.value.iconStyle?"":""),1)],2),b.value.iconStyle?(v(),m("div",cP,[l("p",uP," Choose a custom icon for this "+w($.value)+", or leave as Default to inherit from "+w(H.value)+" or event settings. ",1),Oe(Gu,{"style-type":k.value.styleType||"default","style-color":k.value.styleColor||"","style-background-shape":k.value.styleBackgroundShape||"","style-background-color":k.value.styleBackgroundColor||"","style-border-color":k.value.styleBorderColor||"","style-icon-color":k.value.styleIconColor||"","style-size":k.value.styleSize||"","style-map-rotation":k.value.styleMapRotation??"","inherited-style-type":ge.value.type,"inherited-style-color":ge.value.color,"inherited-background-shape":ge.value.backgroundShape||"","inherited-background-color":ge.value.backgroundColor||ge.value.color||"","inherited-border-color":ge.value.borderColor||"","inherited-icon-color":ge.value.iconColor||"","inherited-size":ge.value.size||"","inherited-map-rotation":ge.value.mapRotation??"","default-label":Pe.value,"icon-label":"Marker style",level:"checkpoint","show-preview":!0,"onUpdate:styleType":ie[5]||(ie[5]=he=>ye("styleType",he)),"onUpdate:styleColor":ie[6]||(ie[6]=he=>ye("styleColor",he)),"onUpdate:styleBackgroundShape":ie[7]||(ie[7]=he=>ye("styleBackgroundShape",he)),"onUpdate:styleBackgroundColor":ie[8]||(ie[8]=he=>ye("styleBackgroundColor",he)),"onUpdate:styleBorderColor":ie[9]||(ie[9]=he=>ye("styleBorderColor",he)),"onUpdate:styleIconColor":ie[10]||(ie[10]=he=>ye("styleIconColor",he)),"onUpdate:styleSize":ie[11]||(ie[11]=he=>ye("styleSize",he)),"onUpdate:styleMapRotation":ie[12]||(ie[12]=he=>ye("styleMapRotation",he))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation","default-label"])])):P("",!0)]),l("div",dP,[l("button",{type:"button",class:pe(["accordion-header",{expanded:b.value.terminology}]),onClick:ie[13]||(ie[13]=he=>C("terminology"))},[ie[17]||(ie[17]=l("div",{class:"accordion-icon"},[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("circle",{cx:"9",cy:"8",r:"3",fill:"#6366F1"}),l("path",{d:"M3 18c0-3.3 2.7-6 6-6s6 2.7 6 6",fill:"#6366F1",opacity:"0.5"}),l("circle",{cx:"17",cy:"14",r:"5",fill:"#10B981",opacity:"0.3"}),l("circle",{cx:"17",cy:"14",r:"3",fill:"#10B981"}),l("circle",{cx:"17",cy:"14",r:"1",fill:"white"})])],-1)),ie[18]||(ie[18]=l("span",{class:"accordion-title"},"Terminology",-1)),l("span",hP,w(Me.value),1),l("span",fP,w(b.value.terminology?"":""),1)],2),b.value.terminology?(v(),m("div",pP,[l("p",vP," Customise what this "+w($.value)+" and its "+w(D.value.toLowerCase())+" are called. ",1),l("div",mP,[l("div",gP,[l("label",null,"What is this "+w($.value)+" called?",1),l("select",{value:k.value.checkpointTerm,class:"form-input",onChange:ie[14]||(ie[14]=he=>{tt({...k.value,checkpointTerm:he.target.value}),qe()})},[l("option",_P,"Use "+w(H.value)+" default ("+w(S.value)+")",1),ie[19]||(ie[19]=l("option",{value:"Vehicle"},"Vehicle",-1)),ie[20]||(ie[20]=l("option",{value:"Car"},"Car",-1)),ie[21]||(ie[21]=l("option",{value:"Bike"},"Bike",-1)),(v(!0),m(Se,null,Be(j(Ns).checkpoint,he=>(v(),m("option",{key:he,value:he},w(he),9,kP))),128))],40,yP)]),l("div",bP,[l("label",null,"What are "+w(D.value.toLowerCase())+" called here?",1),l("select",{value:k.value.peopleTerm,class:"form-input",onChange:ie[15]||(ie[15]=he=>{tt({...k.value,peopleTerm:he.target.value}),qe()})},[l("option",CP,"Use "+w(H.value)+" default ("+w(E.value)+")",1),(v(!0),m(Se,null,Be(j(Ns).people,he=>(v(),m("option",{key:he,value:he},w(he),9,LP))),128))],40,wP)])])])):P("",!0)])])):P("",!0),a.value==="incidents"?(v(),m("div",SP,[l("div",xP,[(v(!0),m(Se,null,Be(e.incidents,he=>(v(),Ye(Zl,{key:he.incidentId,incident:he,onSelect:ie[16]||(ie[16]=De=>ae.$emit("select-incident",De))},null,8,["incident"]))),128))])])):P("",!0)]),_:1},8,["show","is-dirty","z-index"]))}},MP=je(TP,[["__scopeId","data-v-96d782d2"]]),AP={class:"tab-content"},EP={key:0,class:"error-banner"},PP=["value"],DP={key:0,class:"field-error"},OP={class:"contact-row"},RP=["value"],BP={key:0,class:"field-error"},NP=["value"],FP={key:0,class:"field-error"},UP=["value"],zP={key:0,class:"field-error"},HP={key:1,class:"magic-link-section"},VP={key:0,class:"loading-text"},GP={key:1,class:"magic-link-container"},ZP={class:"magic-link-row"},jP=["value"],qP={key:0,class:"error-text"},WP={key:1,class:"magic-link-actions"},KP=["disabled"],YP={key:2,class:"success-text"},JP={key:3,class:"error-text"},XP={key:2,class:"error-text"},QP={__name:"MarshalDetailsTab",props:{form:{type:Object,required:!0},eventId:{type:String,default:null},marshalId:{type:String,default:null},validationErrors:{type:Object,default:()=>({})}},emits:["update:form","input"],setup(e,{expose:t,emit:o}){const i=e,s=o,a=T(null),c=T(null),u=T(null),d=T(null),f=T(""),p=T(!1),g=T(!1),k=T(""),_=T(!1),b=T(!1),C=T(!1),E=T(""),D=(I,H)=>{s("update:form",{...i.form,[I]:H}),s("input")},M=async()=>{if(!(!i.eventId||!i.marshalId)){g.value=!0,k.value="";try{const I=await ms.getMagicLink(i.eventId,i.marshalId);f.value=I.data.magicLink,p.value=I.data.hasEmail}catch(I){console.error("Failed to fetch magic link:",I),k.value="Failed to load login link"}finally{g.value=!1}}},S=T(""),$=async()=>{S.value="";try{if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(f.value),_.value=!0,setTimeout(()=>{_.value=!1},2e3);return}}catch(I){console.warn("Clipboard API failed, trying fallback:",I)}try{const I=document.createElement("textarea");I.value=f.value,I.style.position="fixed",I.style.left="-9999px",I.style.top="0",document.body.appendChild(I),I.focus(),I.select();const H=document.execCommand("copy");document.body.removeChild(I),H?(_.value=!0,setTimeout(()=>{_.value=!1},2e3)):(S.value="Copy failed. Please select and copy the link manually.",setTimeout(()=>{S.value=""},4e3))}catch(I){console.error("Fallback copy failed:",I),S.value="Copy not supported. Please select and copy the link manually.",setTimeout(()=>{S.value=""},4e3)}},A=async()=>{if(!(!i.eventId||!i.marshalId)){b.value=!0,C.value=!1,E.value="";try{await ms.sendMagicLink(i.eventId,i.marshalId),C.value=!0,setTimeout(()=>{C.value=!1},3e3)}catch(I){console.error("Failed to send email:",I),E.value=I.response?.data?.message||"Failed to send email"}finally{b.value=!1}}};return Ge(()=>i.marshalId,I=>{I?M():(f.value="",p.value=!1)},{immediate:!0}),t({focusField:I=>{Un(()=>{const O={name:a,email:c,phoneNumber:u,notes:d}[I];O?.value&&(O.value.focus(),O.value.scrollIntoView({behavior:"smooth",block:"center"}))})}}),(I,H)=>(v(),m("div",AP,[e.validationErrors.general?(v(),m("div",EP,w(e.validationErrors.general),1)):P("",!0),l("div",{class:pe(["form-group",{"has-error":e.validationErrors.name}])},[H[5]||(H[5]=l("label",null,"Name *",-1)),l("input",{ref_key:"nameInputRef",ref:a,value:e.form.name,onInput:H[0]||(H[0]=O=>D("name",O.target.value)),type:"text",required:"",class:pe(["form-input",{"input-error":e.validationErrors.name}])},null,42,PP),e.validationErrors.name?(v(),m("span",DP,w(e.validationErrors.name),1)):P("",!0)],2),l("div",OP,[l("div",{class:pe(["form-group contact-email",{"has-error":e.validationErrors.email}])},[H[6]||(H[6]=l("label",null,"Email",-1)),l("input",{ref_key:"emailInputRef",ref:c,value:e.form.email,onInput:H[1]||(H[1]=O=>D("email",O.target.value)),type:"email",class:pe(["form-input",{"input-error":e.validationErrors.email}])},null,42,RP),e.validationErrors.email?(v(),m("span",BP,w(e.validationErrors.email),1)):P("",!0)],2),l("div",{class:pe(["form-group contact-phone",{"has-error":e.validationErrors.phoneNumber}])},[H[7]||(H[7]=l("label",null,"Phone number",-1)),l("input",{ref_key:"phoneInputRef",ref:u,value:e.form.phoneNumber,onInput:H[2]||(H[2]=O=>D("phoneNumber",O.target.value)),type:"tel",class:pe(["form-input",{"input-error":e.validationErrors.phoneNumber}])},null,42,NP),e.validationErrors.phoneNumber?(v(),m("span",FP,w(e.validationErrors.phoneNumber),1)):P("",!0)],2)]),l("div",{class:pe(["form-group",{"has-error":e.validationErrors.notes}])},[H[8]||(H[8]=l("label",null,"Notes",-1)),l("textarea",{ref_key:"notesInputRef",ref:d,value:e.form.notes,onInput:H[3]||(H[3]=O=>D("notes",O.target.value)),class:pe(["form-input",{"input-error":e.validationErrors.notes}]),rows:"3",placeholder:"e.g., Needs to leave by 11am"},null,42,UP),e.validationErrors.notes?(v(),m("span",zP,w(e.validationErrors.notes),1)):P("",!0)],2),e.marshalId?(v(),m("div",HP,[H[9]||(H[9]=l("label",null,"Login link",-1)),H[10]||(H[10]=l("p",{class:"help-text"},"Share this unique link with the marshal so they can access their dashboard.",-1)),g.value?(v(),m("div",VP,"Loading link...")):f.value?(v(),m("div",GP,[l("div",ZP,[l("input",{type:"text",value:f.value,readonly:"",class:"form-input magic-link-input",onFocus:H[4]||(H[4]=O=>O.target.select())},null,40,jP),l("button",{type:"button",class:"btn btn-secondary",onClick:$},w(_.value?"Copied!":"Copy link"),1)]),S.value?(v(),m("p",qP,w(S.value),1)):P("",!0),p.value?(v(),m("div",WP,[l("button",{type:"button",class:"btn btn-primary",disabled:b.value,onClick:A},w(b.value?"Sending...":"Send via email"),9,KP)])):P("",!0),C.value?(v(),m("p",YP,"Email sent successfully!")):P("",!0),E.value?(v(),m("p",JP,w(E.value),1)):P("",!0)])):k.value?(v(),m("div",XP,w(k.value),1)):P("",!0)])):P("",!0)]))}},e3=je(QP,[["__scopeId","data-v-16ffb81b"]]),t3={class:"card-header"},n3={class:"checkpoint-name-row"},o3=["innerHTML"],s3={class:"checkpoint-name"},i3={key:0,class:"checkpoint-description"},a3={key:0,class:"card-areas"},l3={key:1,class:"card-check-in"},r3={class:"toggle-icon"},c3={class:"toggle-label"},u3={key:0,class:"check-in-time"},d3={key:0,class:"check-in-method"},h3={key:1,class:"unsaved-indicator"},f3={key:2,class:"card-locked"},p3={class:"locked-badge"},v3={key:3,class:"card-badge"},m3={key:4,class:"card-badge"},g3={__name:"MarshalCheckpointCard",props:{assignment:{type:Object,required:!0},location:{type:Object,default:null},areas:{type:Array,default:()=>[]},effectiveCheckInStatus:{type:Boolean,default:!1},hasUnsavedChanges:{type:Boolean,default:!1},isLocked:{type:Boolean,default:!1},isMarkedForRemoval:{type:Boolean,default:!1}},emits:["click","toggle-check-in","remove","undo-remove"],setup(e,{emit:t}){const{termsLower:o}=bt(),i=e,s=t,a=Z(()=>i.location?i.location.areaIds||i.location.AreaIds||[]:[]),c=Z(()=>a.value.map(k=>{const _=i.areas.find(b=>b.id===k);return _?_.name:null}).filter(Boolean)),u=Z(()=>a.value.map(k=>{const _=i.areas.find(b=>b.id===k);return _?_.color:"#999"})),d=Z(()=>{if(!i.location)return"#667eea";const k=i.location,_=k.resolvedStyleBackgroundColor||k.ResolvedStyleBackgroundColor||k.resolvedStyleColor||k.ResolvedStyleColor;if(_)return _;if(a.value.length>0){const b=i.areas.find(C=>C.id===a.value[0]);if(b)return b.color}return"#667eea"}),f=Z(()=>{if(!i.location)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
    </svg>`;const k=i.location,_=k.resolvedStyleType||k.ResolvedStyleType,b=k.resolvedStyleBackgroundColor||k.ResolvedStyleBackgroundColor||k.resolvedStyleColor||k.ResolvedStyleColor,C=k.resolvedStyleBorderColor||k.ResolvedStyleBorderColor,E=k.resolvedStyleIconColor||k.ResolvedStyleIconColor,D=k.resolvedStyleBackgroundShape||k.ResolvedStyleBackgroundShape;return _&&_!=="default"||b||C||E||D&&D!=="circle"?fn({type:_||"circle",backgroundShape:D||"circle",backgroundColor:b||"#667eea",borderColor:C||"#ffffff",iconColor:E||"#ffffff",size:"75",outputSize:24}):`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#667eea" stroke="#fff" stroke-width="2"/>
  </svg>`}),p=k=>k?new Date(k).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",g=()=>{!i.assignment.isPending&&!i.isMarkedForRemoval&&s("click",i.assignment)};return(k,_)=>(v(),m("div",{class:pe(["marshal-checkpoint-card",{"is-checked-in":e.effectiveCheckInStatus&&!e.isMarkedForRemoval,"is-pending":e.assignment.isPending,"is-marked-for-removal":e.isMarkedForRemoval}]),style:rt({borderLeftColor:e.isMarkedForRemoval?void 0:d.value})},[l("div",t3,[l("div",{class:"card-title",onClick:g},[l("span",n3,[l("span",{class:"checkpoint-icon",innerHTML:f.value},null,8,o3),l("span",s3,w(e.assignment.locationName),1),e.assignment.locationDescription?(v(),m("span",i3,"  "+w(e.assignment.locationDescription),1)):P("",!0)])]),!e.isLocked&&!e.isMarkedForRemoval?(v(),m("button",{key:0,type:"button",class:"remove-btn",title:"Remove assignment",onClick:_[0]||(_[0]=ht(b=>k.$emit("remove",e.assignment),["stop"]))},"  ")):P("",!0),e.isMarkedForRemoval?(v(),m("button",{key:1,type:"button",class:"undo-btn",title:"Cancel removal",onClick:_[1]||(_[1]=ht(b=>k.$emit("undo-remove",e.assignment),["stop"]))}," Undo ")):P("",!0)]),c.value.length>0&&!e.isMarkedForRemoval?(v(),m("div",a3,[(v(!0),m(Se,null,Be(c.value,(b,C)=>(v(),m("span",{key:C,class:"area-badge",style:rt({backgroundColor:u.value[C]})},w(b),5))),128))])):P("",!0),!e.assignment.isPending&&!e.isMarkedForRemoval&&!e.isLocked?(v(),m("div",l3,[l("button",{class:pe(["check-in-toggle",{"is-checked-in":e.effectiveCheckInStatus}]),onClick:_[2]||(_[2]=b=>k.$emit("toggle-check-in",e.assignment))},[l("span",r3,w(e.effectiveCheckInStatus?"":""),1),l("span",c3,w(e.effectiveCheckInStatus?"Checked in":"Check in"),1)],2),e.effectiveCheckInStatus&&e.assignment.checkInTime&&!e.hasUnsavedChanges?(v(),m("span",u3,[Ke(w(p(e.assignment.checkInTime))+" ",1),e.assignment.checkInMethod?(v(),m("span",d3,"("+w(e.assignment.checkInMethod)+")",1)):P("",!0)])):e.hasUnsavedChanges?(v(),m("span",h3," Unsaved ")):P("",!0)])):P("",!0),e.isLocked&&!e.isMarkedForRemoval?(v(),m("div",f3,[l("span",p3,"Viewing from this "+w(j(o).checkpoint),1)])):P("",!0),e.assignment.isPending?(v(),m("div",v3,[..._[3]||(_[3]=[l("span",{class:"pending-indicator"},"Will be assigned on save",-1)])])):P("",!0),e.isMarkedForRemoval?(v(),m("div",m3,[..._[4]||(_[4]=[l("span",{class:"removal-indicator"},"Will be removed on save",-1)])])):P("",!0)],6))}},y3=je(g3,[["__scopeId","data-v-9a630c67"]]),_3={class:"tab-content"},k3={key:0,class:"read-only-notice"},b3={class:"section-title"},w3={key:1,class:"form-group",style:{"margin-top":"1.5rem"}},C3={value:""},L3=["value"],S3={__name:"MarshalCheckpointsTab",props:{assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isNewMarshal:{type:Boolean,default:!1},lockedCheckpointId:{type:String,default:null}},emits:["input","remove-assignment","assign-to-location","select-checkpoint"],setup(e,{expose:t,emit:o}){const{termsLower:i}=bt(),s=e,a=o,{pendingCheckInChanges:c,getEffectiveCheckInStatus:u,handleToggleCheckIn:d}=xv(()=>a("input")),f=T(""),p=T(new Set),g=Z(()=>s.assignments?.length||0),k=A=>s.allLocations&&s.allLocations.find(U=>U.id===A)||null,_=Z(()=>[...s.assignments].sort((A,U)=>(A.locationName||"").localeCompare(U.locationName||"",void 0,{numeric:!0,sensitivity:"base"}))),b=A=>p.value.has(A),C=A=>{A.isPending||a("select-checkpoint",A)},E=A=>{d(A)},D=A=>{A.isPending?a("remove-assignment",A):(p.value.add(A.id),a("input"))},M=A=>{p.value.delete(A.id),a("input")},S=Z(()=>{const A=[...s.availableLocations];return A.sort((U,I)=>U.name.localeCompare(I.name,void 0,{numeric:!0,sensitivity:"base"})),A}),$=()=>{f.value&&(a("assign-to-location",f.value),f.value="")};return t({pendingCheckInChanges:c,clearPendingChanges:()=>{c.value.clear(),p.value.clear(),f.value=""},getPendingChanges:()=>Array.from(c.value.entries()).map(([A,U])=>({assignmentId:A,shouldBeCheckedIn:U})),getMarkedForRemoval:()=>Array.from(p.value)}),(A,U)=>(v(),m("div",_3,[e.lockedCheckpointId?(v(),m("div",k3," Viewing from "+w(j(i).checkpoint)+" - "+w(j(i).checkpoints)+" cannot be modified here. ",1)):P("",!0),l("h3",b3,"Assigned "+w(j(i).checkpoints)+" ("+w(g.value)+")",1),Oe(Gl,{"is-empty":e.assignments.length===0,"empty-message":`No ${j(i).checkpoints} assigned yet.`,"empty-hint":e.lockedCheckpointId?"":`Use the dropdown below to assign this ${j(i).person} to ${j(i).checkpoints}.`},{default:Ue(()=>[(v(!0),m(Se,null,Be(_.value,I=>(v(),Ye(y3,{key:I.id,assignment:I,location:k(I.locationId),areas:e.areas,"effective-check-in-status":j(u)(I),"has-unsaved-changes":j(c).has(I.id),"is-locked":!!e.lockedCheckpointId,"is-marked-for-removal":b(I.id),onClick:C,onToggleCheckIn:E,onRemove:D,onUndoRemove:M},null,8,["assignment","location","areas","effective-check-in-status","has-unsaved-changes","is-locked","is-marked-for-removal"]))),128))]),_:1},8,["is-empty","empty-message","empty-hint"]),!e.lockedCheckpointId&&S.value.length>0?(v(),m("div",w3,[l("label",null,"Assign to "+w(j(i).checkpoint),1),He(l("select",{"onUpdate:modelValue":U[0]||(U[0]=I=>f.value=I),class:"form-input",onChange:$},[l("option",C3,"Select a "+w(j(i).checkpoint)+"...",1),(v(!0),m(Se,null,Be(S.value,I=>(v(),m("option",{key:I.id,value:I.id},[Ke(w(I.name),1),I.description?(v(),m(Se,{key:0},[Ke(" - "+w(I.description),1)],64)):P("",!0)],8,L3))),128))],544),[[Tn,f.value]])])):P("",!0)]))}},x3=je(S3,[["__scopeId","data-v-5c02483f"]]),I3={class:"marshal-checklist-view"},$3={key:0,class:"loading-state"},T3={key:1,class:"error-state"},M3={key:2,class:"empty-state"},A3={__name:"MarshalChecklistView",props:{eventId:{type:String,required:!0},marshalId:{type:String,required:!0},locations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:o}){const{termsLower:i}=bt(),s=e,a=o,c=T([]),u=T(!1),d=T(null),f=T(new Map),p=Z(()=>c.value.map(C=>{const E=f.value.get(C.itemId),D=E!==void 0?E.complete:C.isCompleted,M=E!==void 0&&E.complete!==C.isCompleted;return{...C,localIsCompleted:D,isModified:M}})),g=async()=>{if(!(!s.eventId||!s.marshalId)){u.value=!0,d.value=null;try{const C=await Pt.getMarshalChecklist(s.eventId,s.marshalId);if(c.value=C.data||[],s.modelValue&&s.modelValue.length>0){const E=new Map;s.modelValue.forEach(D=>{E.set(D.itemId,{complete:D.complete,contextType:D.contextType,contextId:D.contextId})}),f.value=E}}catch(C){console.error("Failed to load checklist:",C),d.value=C.response?.data?.message||"Failed to load checklist"}finally{u.value=!1}}},k=C=>{const E=f.value.get(C.itemId),D=E!==void 0?E.complete:C.isCompleted;f.value.set(C.itemId,{complete:!D,contextType:C.completionContextType,contextId:C.completionContextId}),_()},_=()=>{const C=[];for(const[E,D]of f.value.entries()){const M=c.value.find(S=>S.itemId===E);M&&D.complete!==M.isCompleted&&C.push({itemId:E,complete:D.complete,contextType:D.contextType,contextId:D.contextId})}a("update:modelValue",C),a("change",C)};return t({resetLocalState:()=>{if(f.value=new Map,s.modelValue&&s.modelValue.length>0){const C=new Map;s.modelValue.forEach(E=>{C.set(E.itemId,{complete:E.complete,contextType:E.contextType,contextId:E.contextId})}),f.value=C}},loadChecklist:g}),Ge(()=>[s.eventId,s.marshalId],()=>{g()},{immediate:!0}),(C,E)=>(v(),m("div",I3,[u.value?(v(),m("div",$3," Loading checklist... ")):d.value?(v(),m("div",T3,[l("p",null,w(d.value),1),l("button",{onClick:g,class:"btn btn-secondary btn-small"}," Retry ")])):c.value.length===0?(v(),m("div",M3,[l("p",null,"No checklist items for this "+w(j(i).person)+".",1)])):(v(),Ye(Zu,{key:3,items:p.value,locations:e.locations,areas:e.areas,onToggleComplete:k},null,8,["items","locations","areas"]))]))}},E3=je(A3,[["__scopeId","data-v-7460304c"]]),P3={class:"checklist-preview"},D3={class:"preview-actions"},O3={class:"preview-header"},R3={key:0,class:"add-item-form"},B3=["placeholder"],N3=["disabled"],F3={key:1,class:"pending-items"},U3={class:"item-content"},z3={class:"item-header"},H3={class:"item-text"},V3={class:"item-scope"},G3=["onClick"],Z3={key:2,class:"empty-state"},j3={key:0,class:"help-text"},q3={key:3,class:"checklist-items"},W3={class:"item-content"},K3={class:"item-header"},Y3={class:"item-text"},J3={class:"item-scope"},X3=["title"],Q3={key:0,class:"item-context"},e4={__name:"ChecklistPreview",props:{allChecklistItems:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=bt(),i=e,s=t,a=T(!1),c=T(""),u=T([...i.modelValue]);Ge(()=>i.modelValue,M=>{u.value=[...M]},{deep:!0});const d=()=>{c.value.trim()&&(u.value.push({text:c.value.trim(),isNew:!0}),c.value="",a.value=!1,p())},f=M=>{u.value.splice(M,1),p()},p=()=>{s("update:modelValue",[...u.value]),s("change")},g=Z(()=>{const M=new Set;for(const S of i.pendingLocationIds){const $=i.allLocations.find(A=>A.id===S);$&&($.areaIds||$.AreaIds||[]).forEach(U=>M.add(U))}return[...M]}),k=M=>{const S=M.scope,$=M.itemType,A=M.ids||[];return S==="SpecificPeople"&&$==="Marshal"?A.includes("ALL_MARSHALS"):(S==="EveryoneAtCheckpoints"||S==="OnePerCheckpoint")&&$==="Checkpoint"?A.includes("ALL_CHECKPOINTS")?!0:A.some(U=>i.pendingLocationIds.includes(U)):S==="OnePerCheckpoint"&&$==="Area"?A.includes("ALL_AREAS")?!0:A.some(U=>g.value.includes(U)):(S==="EveryoneInAreas"||S==="OnePerArea"||S==="EveryAreaLead"||S==="OneLeadPerArea")&&$==="Area"?A.includes("ALL_AREAS")?!0:A.some(U=>g.value.includes(U)):!1},_=Z(()=>i.allChecklistItems.filter(M=>M.scopeConfigurations&&M.scopeConfigurations.length>0?M.scopeConfigurations.some(S=>k(S)):!1)),b=M=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,OnePerCheckpoint:`One per ${o.value.checkpoint}`,EveryoneInAreas:`All in ${o.value.areas}`,OnePerArea:`One per ${o.value.area}`,EveryAreaLead:`${o.value.area} leads`,OneLeadPerArea:`One lead per ${o.value.area}`})[M]||M,C=M=>{if(!M.scopeConfigurations||M.scopeConfigurations.length===0)return"Unknown";const S=M.scopeConfigurations.find(A=>k(A));if(!S)return b(M.scopeConfigurations[0].scope);const $=S.ids||[];return $.includes("ALL_MARSHALS")?"Everyone":$.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:$.includes("ALL_AREAS")?`All ${o.value.areas}`:b(S.scope)},E=M=>{if(!M.scopeConfigurations||M.scopeConfigurations.length===0)return"";const S=M.scopeConfigurations.find(A=>k(A));return S&&{SpecificPeople:"This item is for everyone at the event",EveryoneAtCheckpoints:`This item is for everyone at specified ${o.value.checkpoints}`,OnePerCheckpoint:`One person at each ${o.value.checkpoint} needs to complete this`,EveryoneInAreas:`This item is for everyone in specified ${o.value.areas}`,OnePerArea:`One person in each ${o.value.area} needs to complete this`,EveryAreaLead:`This item is for ${o.value.area} leads only`,OneLeadPerArea:`One ${o.value.area} lead needs to complete this`}[S.scope]||""},D=M=>{if(!M.scopeConfigurations||M.scopeConfigurations.length===0)return null;const S=M.scopeConfigurations.find(U=>k(U));if(!S)return null;const $=S.itemType,A=S.ids||[];if(A.includes("ALL_MARSHALS")||A.includes("ALL_CHECKPOINTS")||A.includes("ALL_AREAS"))return null;if($==="Checkpoint"){const U=i.allLocations.filter(I=>A.includes(I.id)&&i.pendingLocationIds.includes(I.id)).map(I=>I.name);if(U.length>0)return`At: ${U.join(", ")}`}if($==="Area"){const U=i.areas.filter(I=>A.includes(I.id)&&g.value.includes(I.id)).map(I=>I.name);if(U.length>0)return`In: ${U.join(", ")}`}return null};return(M,S)=>(v(),m("div",P3,[l("div",D3,[l("p",O3,w(e.isEditing?`Add new ${j(o).checklist} for this ${j(o).person}:`:`${j(o).checklists} that will apply to this ${j(o).person}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:S[0]||(S[0]=$=>a.value=!a.value)},w(a.value?"Cancel":`Add ${j(o).checklist}`),1)]),a.value?(v(),m("div",R3,[He(l("input",{"onUpdate:modelValue":S[1]||(S[1]=$=>c.value=$),type:"text",placeholder:`Enter ${j(o).checklist} text...`,class:"add-item-input",onKeyup:Lp(d,["enter"])},null,40,B3),[[nt,c.value]]),l("button",{type:"button",class:"save-item-btn",disabled:!c.value.trim(),onClick:d}," Add ",8,N3)])):P("",!0),u.value.length>0?(v(),m("div",F3,[(v(!0),m(Se,null,Be(u.value,($,A)=>(v(),m("div",{key:`pending-${A}`,class:"checklist-item pending"},[S[3]||(S[3]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",U3,[l("div",z3,[l("div",H3,w($.text),1),l("div",V3,[S[2]||(S[2]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:U=>f(A),title:"Remove"},"  ",8,G3)])])])]))),128))])):P("",!0),!e.isEditing&&_.value.length===0&&u.value.length===0?(v(),m("div",Z3,[l("p",null,"No "+w(j(o).checklists)+" will apply based on the current "+w(j(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),m("p",j3," Assign "+w(j(o).checkpoints)+" to see relevant "+w(j(o).checklists)+". ",1)):P("",!0)])):P("",!0),!e.isEditing&&_.value.length>0?(v(),m("div",q3,[(v(!0),m(Se,null,Be(_.value,$=>(v(),m("div",{key:$.id,class:"checklist-item"},[S[4]||(S[4]=l("div",{class:"item-checkbox"},[l("input",{type:"checkbox",checked:!1,disabled:""})],-1)),l("div",W3,[l("div",K3,[l("div",Y3,w($.text),1),l("div",J3,[l("span",{class:"scope-pill",title:E($)},w(C($)),9,X3)])]),D($)?(v(),m("div",Q3,w(D($)),1)):P("",!0)])]))),128))])):P("",!0)]))}},t4=je(e4,[["__scopeId","data-v-6deaacc2"]]),n4={class:"notes-preview"},o4={class:"preview-actions"},s4={class:"preview-header"},i4={key:0,class:"add-item-form"},a4={class:"add-form-fields"},l4=["disabled"],r4={key:1,class:"pending-items"},c4={class:"note-header"},u4={class:"note-title"},d4={class:"note-actions"},h4=["onClick"],f4={key:0,class:"note-content"},p4={key:2,class:"empty-state"},v4={key:0,class:"help-text"},m4={key:3,class:"notes-list"},g4={class:"note-header"},y4={class:"note-title"},_4=["title"],k4={key:0,class:"note-content"},b4={key:1,class:"note-context"},w4={__name:"NotesPreview",props:{allNotes:{type:Array,default:()=>[]},pendingLocationIds:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{termsLower:o}=bt(),i=e,s=t,a=T(!1),c=T(""),u=T(""),d=T([...i.modelValue]);Ge(()=>i.modelValue,S=>{d.value=[...S]},{deep:!0});const f=()=>{!c.value.trim()&&!u.value.trim()||(d.value.push({title:c.value.trim(),content:u.value.trim(),isNew:!0}),c.value="",u.value="",a.value=!1,g())},p=S=>{d.value.splice(S,1),g()},g=()=>{s("update:modelValue",[...d.value]),s("change")},k=Z(()=>{const S=new Set;for(const $ of i.pendingLocationIds){const A=i.allLocations.find(U=>U.id===$);A&&(A.areaIds||A.AreaIds||[]).forEach(I=>S.add(I))}return[...S]}),_=S=>{const $=S.scope,A=S.itemType,U=S.ids||[];return $==="SpecificPeople"&&A==="Marshal"?U.includes("ALL_MARSHALS"):$==="EveryoneAtCheckpoints"&&A==="Checkpoint"?U.includes("ALL_CHECKPOINTS")?!0:U.some(I=>i.pendingLocationIds.includes(I)):$==="EveryoneInAreas"&&A==="Area"?U.includes("ALL_AREAS")?!0:U.some(I=>k.value.includes(I)):!1},b=Z(()=>i.allNotes.filter(S=>S.scopeConfigurations&&S.scopeConfigurations.length>0?S.scopeConfigurations.some($=>_($)):!1)),C=S=>({SpecificPeople:"Everyone",EveryoneAtCheckpoints:`All at ${o.value.checkpoints}`,EveryoneInAreas:`All in ${o.value.areas}`})[S]||S,E=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"Unknown";const $=S.scopeConfigurations.find(U=>_(U));if(!$)return C(S.scopeConfigurations[0].scope);const A=$.ids||[];return A.includes("ALL_MARSHALS")?"Everyone":A.includes("ALL_CHECKPOINTS")?`All ${o.value.checkpoints}`:A.includes("ALL_AREAS")?`All ${o.value.areas}`:C($.scope)},D=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return"";const $=S.scopeConfigurations.find(U=>_(U));return $&&{SpecificPeople:"This note is for everyone at the event",EveryoneAtCheckpoints:`This note is for everyone at specified ${o.value.checkpoints}`,EveryoneInAreas:`This note is for everyone in specified ${o.value.areas}`}[$.scope]||""},M=S=>{if(!S.scopeConfigurations||S.scopeConfigurations.length===0)return null;const $=S.scopeConfigurations.find(I=>_(I));if(!$)return null;const A=$.itemType,U=$.ids||[];if(U.includes("ALL_MARSHALS")||U.includes("ALL_CHECKPOINTS")||U.includes("ALL_AREAS"))return null;if(A==="Checkpoint"){const I=i.allLocations.filter(H=>U.includes(H.id)&&i.pendingLocationIds.includes(H.id)).map(H=>H.name);if(I.length>0)return`At: ${I.join(", ")}`}if(A==="Area"){const I=i.areas.filter(H=>U.includes(H.id)&&k.value.includes(H.id)).map(H=>H.name);if(I.length>0)return`In: ${I.join(", ")}`}return null};return(S,$)=>(v(),m("div",n4,[l("div",o4,[l("p",s4,w(e.isEditing?`Add new note for this ${j(o).person}:`:`Notes that will be visible to this ${j(o).person}:`),1),l("button",{type:"button",class:"add-item-btn",onClick:$[0]||($[0]=A=>a.value=!a.value)},w(a.value?"Cancel":"Add note"),1)]),a.value?(v(),m("div",i4,[l("div",a4,[He(l("input",{"onUpdate:modelValue":$[1]||($[1]=A=>c.value=A),type:"text",placeholder:"Note title...",class:"add-item-input title-input"},null,512),[[nt,c.value]]),He(l("textarea",{"onUpdate:modelValue":$[2]||($[2]=A=>u.value=A),placeholder:"Note content...",class:"add-item-input content-input",rows:"3"},null,512),[[nt,u.value]])]),l("button",{type:"button",class:"save-item-btn",disabled:!c.value.trim()&&!u.value.trim(),onClick:f}," Add ",8,l4)])):P("",!0),d.value.length>0?(v(),m("div",r4,[(v(!0),m(Se,null,Be(d.value,(A,U)=>(v(),m("div",{key:`pending-${U}`,class:"note-item pending"},[l("div",c4,[l("span",u4,w(A.title||"Untitled"),1),l("div",d4,[$[3]||($[3]=l("span",{class:"scope-pill new-pill",title:"Will be created when saved"}," New ",-1)),l("button",{type:"button",class:"remove-item-btn",onClick:I=>p(U),title:"Remove"},"  ",8,h4)])]),A.content?(v(),m("div",f4,w(A.content),1)):P("",!0)]))),128))])):P("",!0),!e.isEditing&&b.value.length===0&&d.value.length===0?(v(),m("div",p4,[l("p",null,"No notes will be visible based on the current "+w(j(o).checkpoint)+" assignments.",1),e.pendingLocationIds.length===0?(v(),m("p",v4," Assign "+w(j(o).checkpoints)+" to see relevant notes. ",1)):P("",!0)])):P("",!0),!e.isEditing&&b.value.length>0?(v(),m("div",m4,[(v(!0),m(Se,null,Be(b.value,A=>(v(),m("div",{key:A.id,class:"note-item"},[l("div",g4,[l("span",y4,w(A.title||"Untitled"),1),l("span",{class:"scope-pill",title:D(A)},w(E(A)),9,_4)]),A.content?(v(),m("div",k4,w(A.content),1)):P("",!0),M(A)?(v(),m("div",b4,w(M(A)),1)):P("",!0)]))),128))])):P("",!0)]))}},C4=je(w4,[["__scopeId","data-v-e8e0946a"]]),L4={key:6,class:"tab-content incidents-tab"},S4={class:"incidents-list"},x4={class:"custom-footer"},I4={class:"footer-left"},$4={__name:"EditMarshalModal",props:{show:{type:Boolean,default:!1},marshal:{type:Object,default:null},eventId:{type:String,required:!0},assignments:{type:Array,default:()=>[]},availableLocations:{type:Array,default:()=>[]},allLocations:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},isDirty:{type:Boolean,default:!1},eventNotes:{type:Array,default:()=>[]},allChecklistItems:{type:Array,default:()=>[]},incidents:{type:Array,default:()=>[]},validationErrors:{type:Object,default:()=>({})},lockedCheckpointId:{type:String,default:null},zIndex:{type:Number,default:1e3}},emits:["close","save","delete","toggle-check-in","remove-assignment","assign-to-location","update:isDirty","select-incident","select-checkpoint"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=bt(),a=e,c=o,u=T("details"),d=T(null),f=T(null),p=T(null),g=T([]),k=T([]),_=T([]),b=T([]),C=T({name:"",email:"",phoneNumber:"",notes:""}),E=Z(()=>{const re=a.isEditing?`Edit ${s.value.person}`:`Create ${s.value.person}`,Re=C.value.name?.trim();return Re?`${re} - ${Re}`:re}),D=Z(()=>{const re=[{value:"details",label:"Details",icon:"details"},{value:"checkpoints",label:i.value.checkpoints,icon:"checkpoint"},{value:"checklists",label:i.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"}];return a.incidents&&a.incidents.length>0&&re.push({value:"incidents",label:"Incidents",icon:"incidents"}),re}),M=Z(()=>D.value.findIndex(re=>re.value===u.value)),S=Z(()=>M.value===D.value.length-1),$=Z(()=>S.value?null:D.value[M.value+1]),A=Z(()=>$.value?`${$.value.label}...`:""),U=Z(()=>k.value.map(re=>re.locationId)),I=Z(()=>a.isEditing?a.assignments:k.value.map(re=>({id:`pending-${re.locationId}`,locationId:re.locationId,locationName:a.allLocations.find(Re=>Re.id===re.locationId)?.name||"Unknown",isPending:!0}))),H=Z(()=>{if(a.isEditing)return a.availableLocations;const re=k.value.map(Re=>Re.locationId);return a.allLocations.filter(Re=>!re.includes(Re.id))});Ge(()=>a.marshal,re=>{re?C.value={name:re.name||"",email:re.email||"",phoneNumber:re.phoneNumber||"",notes:re.notes||""}:C.value={name:"",email:"",phoneNumber:"",notes:""}},{immediate:!0,deep:!0}),Ge(()=>a.show,re=>{re&&(u.value="details",g.value=[],k.value=[],_.value=[],b.value=[],a.isEditing||(C.value={name:"",email:"",phoneNumber:"",notes:""}),f.value?.clearPendingChanges&&f.value.clearPendingChanges(),p.value?.resetLocalState&&p.value.resetLocalState())});const O=re=>{C.value=re},q=()=>{c("update:isDirty",!0)},V=()=>{c("update:isDirty",!0)},Q=()=>{$.value&&(u.value=$.value.value)},de=()=>{const re={...C.value,checkInChanges:f.value?.getPendingChanges?.()||[],checklistChanges:g.value||[],pendingAssignments:a.isEditing?[]:k.value,pendingNewChecklistItems:_.value,pendingNewNotes:b.value};c("save",re)},Ee=()=>{c("delete")},ge=re=>{!a.isEditing&&re.isPending?k.value=k.value.filter(Re=>Re.locationId!==re.locationId):c("remove-assignment",re)},Pe=re=>{a.isEditing?c("assign-to-location",re):(k.value.push({locationId:re}),c("update:isDirty",!0))},Fe=re=>{c("select-checkpoint",re)},ce=()=>{c("close")};return t({switchToTab:re=>{u.value=re},focusField:re=>{d.value?.focusField&&d.value.focusField(re)}}),(re,Re)=>(v(),Ye(zt,{show:e.show,title:E.value,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,"z-index":e.zIndex,onClose:ce},{"tab-header":Ue(()=>[Oe(Ha,{modelValue:u.value,"onUpdate:modelValue":Re[0]||(Re[0]=Je=>u.value=Je),tabs:D.value},null,8,["modelValue","tabs"])]),footer:Ue(()=>[l("div",x4,[l("div",I4,[e.isEditing&&!e.lockedCheckpointId?(v(),m("button",{key:0,type:"button",onClick:Ee,class:"btn btn-danger"}," Delete "+w(j(s).person),1)):P("",!0),!e.isEditing&&!S.value?(v(),m("button",{key:1,type:"button",onClick:Q,class:"btn btn-secondary mobile-only"},w(A.value),1)):P("",!0)]),l("button",{type:"button",onClick:de,class:"btn btn-success"}," Save ")])]),default:Ue(()=>[u.value==="details"?(v(),Ye(e3,{key:0,ref_key:"detailsTabRef",ref:d,form:C.value,"event-id":e.eventId,"marshal-id":e.isEditing?e.marshal?.id:null,"validation-errors":e.validationErrors,"onUpdate:form":O,onInput:q},null,8,["form","event-id","marshal-id","validation-errors"])):P("",!0),u.value==="checkpoints"?(v(),Ye(x3,{key:1,ref_key:"checkpointsTabRef",ref:f,assignments:I.value,"available-locations":H.value,"all-locations":e.allLocations,areas:e.areas,"is-new-marshal":!e.isEditing,"locked-checkpoint-id":e.lockedCheckpointId,onInput:q,onRemoveAssignment:ge,onAssignToLocation:Pe,onSelectCheckpoint:Fe},null,8,["assignments","available-locations","all-locations","areas","is-new-marshal","locked-checkpoint-id"])):P("",!0),u.value==="checklists"&&e.isEditing?(v(),Ye(E3,{key:2,ref_key:"checklistTabRef",ref:p,modelValue:g.value,"onUpdate:modelValue":Re[1]||(Re[1]=Je=>g.value=Je),"event-id":e.eventId,"marshal-id":e.marshal.id,locations:e.allLocations,areas:e.areas,onChange:V},null,8,["modelValue","event-id","marshal-id","locations","areas"])):P("",!0),u.value==="checklists"?(v(),Ye(t4,{key:3,modelValue:_.value,"onUpdate:modelValue":Re[2]||(Re[2]=Je=>_.value=Je),"all-checklist-items":e.allChecklistItems,"pending-location-ids":U.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:q},null,8,["modelValue","all-checklist-items","pending-location-ids","all-locations","areas","is-editing"])):P("",!0),u.value==="notes"&&e.isEditing?(v(),Ye(ac,{key:4,"event-id":e.eventId,"marshal-id":e.marshal?.id,"all-notes":e.eventNotes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","marshal-id","all-notes","locations","areas","assignments"])):P("",!0),u.value==="notes"?(v(),Ye(C4,{key:5,modelValue:b.value,"onUpdate:modelValue":Re[3]||(Re[3]=Je=>b.value=Je),"all-notes":e.eventNotes,"pending-location-ids":U.value,"all-locations":e.allLocations,areas:e.areas,"is-editing":e.isEditing,onChange:q},null,8,["modelValue","all-notes","pending-location-ids","all-locations","areas","is-editing"])):P("",!0),u.value==="incidents"?(v(),m("div",L4,[l("div",S4,[(v(!0),m(Se,null,Be(e.incidents,Je=>(v(),Ye(Zl,{key:Je.incidentId,incident:Je,onSelect:Re[4]||(Re[4]=tt=>re.$emit("select-incident",tt))},null,8,["incident"]))),128))])])):P("",!0)]),_:1},8,["show","title","is-dirty","z-index"]))}},T4=je($4,[["__scopeId","data-v-847d69a7"]]),M4={class:"locations-list"},A4={class:"conflict-actions"},E4={__name:"AssignmentConflictModal",props:{show:{type:Boolean,default:!1},conflictData:{type:Object,default:()=>({marshalName:"",locations:[]})}},emits:["close","choice"],setup(e,{emit:t}){const{terms:o,termsLower:i}=bt(),s=t,a=u=>{s("choice",u)},c=()=>{s("close")};return(u,d)=>(v(),Ye(zt,{show:e.show,title:`${j(o).person} already assigned`,size:"medium","z-index":1100,onClose:c},{actions:Ue(()=>[l("div",A4,[l("button",{onClick:d[0]||(d[0]=f=>a("move")),class:"btn btn-primary btn-full"}," Move to this "+w(j(i).checkpoint)+" (remove from others) ",1),l("button",{onClick:d[1]||(d[1]=f=>a("both")),class:"btn btn-secondary btn-full"}," Assign to both (keep existing assignments) "),l("button",{onClick:d[2]||(d[2]=f=>a("choose-other")),class:"btn btn-secondary btn-full"}," Choose someone else "),l("button",{onClick:d[3]||(d[3]=f=>a("cancel")),class:"btn btn-secondary btn-full"}," Cancel ")])]),default:Ue(()=>[l("p",null,[l("strong",null,w(e.conflictData.marshalName),1),d[4]||(d[4]=Ke(" is currently assigned to: ",-1))]),l("ul",M4,[(v(!0),m(Se,null,Be(e.conflictData.locations,f=>(v(),m("li",{key:f},w(f),1))),128))]),d[5]||(d[5]=l("p",null,"What would you like to do?",-1))]),_:1},8,["show","title"]))}},P4=je(E4,[["__scopeId","data-v-997e8aaa"]]),D4={key:0,class:"assign-marshal-section"},O4={value:""},R4=["value"],B4=["disabled"],N4={key:1,class:"assign-marshal-section create-mode"},F4={class:"form-group"},U4={class:"form-group"},z4={class:"form-group"},H4={__name:"AssignMarshalModal",props:{show:{type:Boolean,default:!1},locationName:{type:String,default:""},marshals:{type:Array,default:()=>[]}},emits:["close","assign-existing","create-and-assign"],setup(e,{emit:t}){const{termsLower:o}=bt(),i=e,s=t,a=T(!1),c=T(""),u=T({name:"",email:"",phoneNumber:""});Ge(()=>i.show,_=>{_||(a.value=!1,c.value="",u.value={name:"",email:"",phoneNumber:""})});const d=()=>{a.value=!0},f=()=>{c.value&&s("assign-existing",c.value)},p=()=>{u.value.name&&s("create-and-assign",{...u.value})},g=()=>{a.value=!1,u.value={name:"",email:"",phoneNumber:""}},k=()=>{s("close")};return(_,b)=>(v(),Ye(zt,{show:e.show,title:a.value?`Create new ${j(o).person}`:`Assign ${j(o).person} to ${e.locationName}`,size:"medium",onClose:k},{actions:Ue(()=>[a.value?(v(),m(Se,{key:0},[l("button",{onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{onClick:p,class:"btn btn-primary"}," Create & assign ")],64)):P("",!0)]),default:Ue(()=>[a.value?(v(),m("div",N4,[l("h3",null,"Create new "+w(j(o).person),1),l("div",F4,[b[5]||(b[5]=l("label",null,"Name *",-1)),He(l("input",{"onUpdate:modelValue":b[1]||(b[1]=C=>u.value.name=C),type:"text",required:"",class:"form-input"},null,512),[[nt,u.value.name]])]),l("div",U4,[b[6]||(b[6]=l("label",null,"Email",-1)),He(l("input",{"onUpdate:modelValue":b[2]||(b[2]=C=>u.value.email=C),type:"email",class:"form-input"},null,512),[[nt,u.value.email]])]),l("div",z4,[b[7]||(b[7]=l("label",null,"Phone",-1)),He(l("input",{"onUpdate:modelValue":b[3]||(b[3]=C=>u.value.phoneNumber=C),type:"tel",class:"form-input"},null,512),[[nt,u.value.phoneNumber]])])])):(v(),m("div",D4,[l("h3",null,"Select existing "+w(j(o).person),1),He(l("select",{"onUpdate:modelValue":b[0]||(b[0]=C=>c.value=C),class:"form-input"},[l("option",O4,"Choose a "+w(j(o).person)+"...",1),(v(!0),m(Se,null,Be(e.marshals,C=>(v(),m("option",{key:C.id,value:C.id},[Ke(w(C.name)+" ",1),C.assignedLocationIds&&C.assignedLocationIds.length>0?(v(),m(Se,{key:0},[Ke(" (assigned to "+w(C.assignedLocationIds.length)+" "+w(C.assignedLocationIds.length>1?j(o).checkpoints:j(o).checkpoint)+") ",1)],64)):P("",!0)],8,R4))),128))],512),[[Tn,c.value]]),l("button",{onClick:f,class:"btn btn-primary btn-full",style:{"margin-top":"1rem"},disabled:!c.value}," Assign selected "+w(j(o).person),9,B4),b[4]||(b[4]=l("div",{class:"divider"},"OR",-1)),l("button",{onClick:d,class:"btn btn-secondary btn-full"}," Create new "+w(j(o).person),1)]))]),_:1},8,["show","title"]))}},V4=je(H4,[["__scopeId","data-v-fa70b913"]]),G4={class:"shift-times-content"},Z4={class:"info-text"},j4={class:"time-delta-info"},q4={class:"delta-detail"},W4={class:"delta-detail"},K4={class:"delta-summary"},Y4={class:"affected-checkpoints"},J4={class:"option-selection"},X4={class:"radio-option"},Q4={class:"radio-option"},e6={__name:"ShiftCheckpointTimesModal",props:{show:{type:Boolean,default:!1},oldEventDate:{type:String,required:!0},newEventDate:{type:String,required:!0},affectedCheckpointsCount:{type:Number,default:0}},emits:["confirm","cancel"],setup(e,{emit:t}){const{terms:o,termsLower:i}=bt(),s=e,a=t,c=T("shift"),u=Z(()=>{const k=new Date(s.oldEventDate);return new Date(s.newEventDate)-k}),d=k=>new Date(k).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),f=k=>{const _=Math.abs(k),b=k>=0?"+":"-",C=Math.floor(_/(1e3*60*60*24)),E=Math.floor(_%(1e3*60*60*24)/(1e3*60*60)),D=Math.floor(_%(1e3*60*60)/(1e3*60)),M=[];return C>0&&M.push(`${C}d`),E>0&&M.push(`${E}h`),D>0&&M.push(`${D}m`),`${b}${M.join(" ")}`},p=()=>{a("confirm",{shouldShift:c.value==="shift",timeDelta:u.value})},g=()=>{a("cancel")};return(k,_)=>(v(),Ye(zt,{show:e.show,title:`Shift ${j(o).checkpoint} Times?`,size:"medium",onClose:g},{actions:Ue(()=>[l("button",{type:"button",onClick:g,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:p,class:"btn btn-primary"},w(c.value==="shift"?"Shift Times":"Keep Times"),1)]),default:Ue(()=>[l("div",G4,[l("p",Z4," You've changed the event date/time. Some "+w(j(i).checkpoints)+" have custom times set. ",1),l("div",j4,[_[2]||(_[2]=l("strong",null,"Event time change:",-1)),l("div",q4," Old: "+w(d(e.oldEventDate)),1),l("div",W4," New: "+w(d(e.newEventDate)),1),l("div",K4," Delta: "+w(f(u.value)),1)]),l("p",Y4,[l("strong",null,w(e.affectedCheckpointsCount)+" "+w(e.affectedCheckpointsCount===1?j(i).checkpoint:j(i).checkpoints),1),_[3]||(_[3]=Ke(" with custom times will be shifted by the same amount. ",-1))]),l("div",J4,[l("label",X4,[He(l("input",{"onUpdate:modelValue":_[0]||(_[0]=b=>c.value=b),type:"radio",value:"shift",name:"shift-option"},null,512),[[Qd,c.value]]),l("div",null,[l("strong",null,"Shift all "+w(j(i).checkpoint)+" times",1),_[4]||(_[4]=l("small",null,"Recommended: Maintains relative timing",-1))])]),l("label",Q4,[He(l("input",{"onUpdate:modelValue":_[1]||(_[1]=b=>c.value=b),type:"radio",value:"keep",name:"shift-option"},null,512),[[Qd,c.value]]),l("div",null,[l("strong",null,"Keep "+w(j(i).checkpoint)+" times unchanged",1),l("small",null,w(j(o).checkpoint)+" times will stay at their current values",1)])])])])]),_:1},8,["show","title"]))}},t6=je(e6,[["__scopeId","data-v-a6454aff"]]),n6={class:"search-section"},o6={class:"form-group"},s6={class:"suggestions-list"},i6={class:"suggestion-content"},a6={key:0,class:"suggestion-detail"},l6=["onClick"],r6={class:"suggestion-content"},c6={class:"suggestion-name"},u6={key:0,class:"suggestion-detail"},d6=["onClick"],h6={class:"suggestion-content"},f6={class:"suggestion-name"},p6={key:0,class:"suggestion-detail"},v6={key:1,class:"no-results"},m6={key:2,class:"no-results"},g6={__name:"AddAreaContactModal",props:{show:{type:Boolean,default:!1},areaName:{type:String,default:""},areaId:{type:String,default:""},contacts:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},excludeContactIds:{type:Array,default:()=>[]}},emits:["close","select-contact","create-from-marshal","create-new"],setup(e,{emit:t}){const{terms:o}=bt(),i=e,s=t,a=T(""),c=T(null),u=Z(()=>i.contacts.filter(I=>i.excludeContactIds.includes(I.contactId)&&I.marshalId).map(I=>I.marshalId)),d=Z(()=>i.contacts.filter(I=>I.marshalId).map(I=>I.marshalId)),f=Z(()=>i.contacts.filter(I=>!i.excludeContactIds.includes(I.contactId))),p=Z(()=>i.marshals.filter(I=>!u.value.includes(I.id)&&!d.value.includes(I.id))),g=I=>I?I.toLowerCase().replace(/[.,\-_'"()]/g," ").replace(/\s+/g," ").trim():"",k=Z(()=>{const I=g(a.value);return I?I.split(" ").filter(H=>H.length>0):[]}),_=(I,H)=>{if(H.length===0)return{score:1,isPartial:!1};const O=g(I);let q=0;for(const V of H)O.includes(V)&&q++;return{score:q,isPartial:q>0&&q<H.length,isFullMatch:q===H.length}},b=Z(()=>{const I=k.value,H=[];return f.value.forEach(O=>{const q=`${O.name||""} ${O.role||""}`,V=_(q,I);(I.length===0||V.score>0)&&H.push({key:`contact-${O.contactId}`,type:"contact",name:O.name,detail:O.role?U(O.role):null,data:O,matchScore:V.score,isPartial:V.isPartial,isFullMatch:V.isFullMatch})}),p.value.forEach(O=>{const q=`${O.name||""} ${O.email||""}`,V=_(q,I);(I.length===0||V.score>0)&&H.push({key:`marshal-${O.id}`,type:"marshal",name:O.name,detail:O.email||O.phoneNumber||null,data:O,matchScore:V.score,isPartial:V.isPartial,isFullMatch:V.isFullMatch})}),H.sort((O,q)=>q.matchScore!==O.matchScore?q.matchScore-O.matchScore:O.name.localeCompare(q.name,void 0,{sensitivity:"base"})),H}),C=Z(()=>k.value.length===0?b.value:b.value.filter(I=>I.isFullMatch)),E=Z(()=>k.value.length===0?[]:b.value.filter(I=>I.isPartial)),D=Z(()=>E.value.length>0);Ge(()=>i.show,async I=>{I&&(a.value="",await Un(),c.value?.focus())});const M=I=>{const H=i.contacts.find(O=>O.marshalId===I.id);if(H){if(i.excludeContactIds.includes(H.contactId))return;s("select-contact",H)}else s("create-from-marshal",I)},S=I=>{s("select-contact",I)},$=()=>{s("create-new",a.value.trim())},A=()=>{s("close")},U=I=>I?I.replace(/([A-Z])/g," $1").replace(/^./,H=>H.toUpperCase()).trim():"";return(I,H)=>(v(),Ye(zt,{show:e.show,title:`Add contact to ${e.areaName}`,size:"medium",onClose:A},{actions:Ue(()=>[l("button",{onClick:A,class:"btn btn-secondary"}," Cancel ")]),default:Ue(()=>[l("div",n6,[l("div",o6,[H[1]||(H[1]=l("label",null,"Search or create",-1)),He(l("input",{ref_key:"searchInputRef",ref:c,"onUpdate:modelValue":H[0]||(H[0]=O=>a.value=O),type:"text",class:"form-input",placeholder:"Filter by name..."},null,512),[[nt,a.value]])]),l("div",s6,[l("div",{class:"suggestion-item create-new",onClick:$},[H[3]||(H[3]=l("span",{class:"suggestion-icon create-icon"},"+",-1)),l("div",i6,[H[2]||(H[2]=l("span",{class:"suggestion-name"},"Create new contact",-1)),a.value.trim()?(v(),m("span",a6,'"'+w(a.value.trim())+'"',1)):P("",!0)])]),(v(!0),m(Se,null,Be(C.value,O=>(v(),m("div",{key:O.key,class:"suggestion-item",onClick:q=>O.type==="marshal"?M(O.data):S(O.data)},[l("span",{class:pe(["suggestion-icon",O.type==="marshal"?"marshal-icon":"contact-icon"])},w(O.type==="marshal"?"M":"C"),3),l("div",r6,[l("span",c6,w(O.name),1),O.detail?(v(),m("span",u6,w(O.detail),1)):P("",!0)]),l("span",{class:pe(["suggestion-badge",{"contact-badge":O.type==="contact"}])},w(O.type==="marshal"?j(o).person:"Contact"),3)],8,l6))),128)),D.value?(v(),m(Se,{key:0},[H[4]||(H[4]=l("div",{class:"suggestion-section-header"},"Partial matches",-1)),(v(!0),m(Se,null,Be(E.value,O=>(v(),m("div",{key:O.key,class:"suggestion-item",onClick:q=>O.type==="marshal"?M(O.data):S(O.data)},[l("span",{class:pe(["suggestion-icon",O.type==="marshal"?"marshal-icon":"contact-icon"])},w(O.type==="marshal"?"M":"C"),3),l("div",h6,[l("span",f6,w(O.name),1),O.detail?(v(),m("span",p6,w(O.detail),1)):P("",!0)]),l("span",{class:pe(["suggestion-badge",{"contact-badge":O.type==="contact"}])},w(O.type==="marshal"?j(o).person:"Contact"),3)],8,d6))),128))],64)):P("",!0),a.value.trim()&&C.value.length===0&&E.value.length===0?(v(),m("div",v6," No matching "+w(j(o).people.toLowerCase())+" or contacts found. ",1)):P("",!0),!a.value.trim()&&C.value.length===0?(v(),m("div",m6," No "+w(j(o).people.toLowerCase())+" or contacts available to add. ",1)):P("",!0)])])]),_:1},8,["show","title"]))}},y6=je(g6,[["__scopeId","data-v-e25ca97b"]]),_6={key:0,class:"tab-content"},k6={class:"form-group"},b6=["disabled"],w6={class:"form-group"},C6={key:1,class:"tab-content"},L6={class:"boundary-section"},S6={key:0,class:"boundary-preview"},x6={class:"boundary-actions"},I6={key:2,class:"tab-content"},$6={class:"contacts-header"},T6={class:"section-title"},M6={key:3,class:"tab-content"},A6={class:"section-title"},E6={key:4,class:"placeholder-message"},P6={key:6,class:"placeholder-message"},D6={key:8,class:"placeholder-message"},O6={key:9,class:"tab-content appearance-tab"},R6={class:"accordion-item"},B6=["innerHTML"],N6={class:"accordion-title"},F6={class:"accordion-arrow"},U6={key:0,class:"accordion-content"},z6={class:"section-description"},H6={class:"color-picker"},V6=["title","onClick"],G6={class:"accordion-item"},Z6=["innerHTML"],j6={class:"accordion-title"},q6={class:"accordion-arrow"},W6={key:0,class:"accordion-content"},K6={class:"section-description"},Y6={class:"accordion-item"},J6={class:"accordion-title"},X6={class:"accordion-preview"},Q6={class:"accordion-arrow"},e5={key:0,class:"accordion-content"},t5={class:"section-description"},n5={class:"form-group"},o5={value:""},s5=["value"],i5={class:"accordion-item"},a5={class:"accordion-title"},l5={class:"accordion-preview"},r5={class:"accordion-arrow"},c5={key:0,class:"accordion-content"},u5={class:"section-description"},d5={class:"form-group"},h5={value:""},f5=["value"],p5={key:10,class:"tab-content incidents-tab"},v5={class:"incidents-list"},m5={class:"custom-footer"},g5={class:"footer-left"},Wh="edit_area_accordion",y5={__name:"EditAreaModal",props:{show:{type:Boolean,default:!1},area:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},areas:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1},eventId:{type:String,required:!0},allLocations:{type:Array,default:()=>[]},assignments:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},contacts:{type:Array,default:()=>[]},eventDefaultStyleType:{type:String,default:"default"},eventDefaultStyleColor:{type:String,default:""},eventDefaultStyleBackgroundShape:{type:String,default:""},eventDefaultStyleBackgroundColor:{type:String,default:""},eventDefaultStyleBorderColor:{type:String,default:""},eventDefaultStyleIconColor:{type:String,default:""},eventDefaultStyleSize:{type:String,default:""},eventDefaultStyleMapRotation:{type:[String,Number],default:""},eventPeopleTerm:{type:String,default:"Marshals"},eventCheckpointTerm:{type:String,default:"Checkpoints"},incidents:{type:Array,default:()=>[]},initialTab:{type:String,default:"details"},route:{type:Array,default:()=>[]}},emits:["close","save","delete","draw-boundary","update:isDirty","select-checkpoint","create-contact-from-marshal","create-new-contact","edit-contact","select-incident"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=bt(),a=()=>S.value.peopleTerm?S.value.peopleTerm:d.eventPeopleTerm||"Marshals",c=(te=!0)=>{const X=S.value.checkpointTerm||d.eventCheckpointTerm||"Checkpoints",N=a();return te?gv("checkpoint",X,N):Zi("checkpoint",X,N)},u=(te=!0)=>c(te).toLowerCase(),d=e,f=o,p=T("details"),g=T(null),k=T([]),_=T({}),b=T({}),C=T(!1),E=T(!1),D=T([]),M=T([]),S=T({name:"",description:"",color:mr,displayOrder:0,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),$=()=>d.eventId?`${Wh}_${d.eventId}`:Wh,A=T({polygonColor:!1,iconStyle:!1,peopleTerm:!1,checkpointTerm:!1});Wt(()=>{const te=localStorage.getItem($());if(te)try{const X=JSON.parse(te);A.value={...A.value,...X}}catch{}});const U=te=>{A.value[te]=!A.value[te],localStorage.setItem($(),JSON.stringify(A.value))},I=Z(()=>`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <polygon points="4,8 7,3 14,2 20,5 22,12 19,18 12,21 5,19 2,14" fill="${S.value.color||mr}" stroke="#fff" stroke-width="1.5" opacity="0.8"/>
  </svg>`),H=Z(()=>{const te=S.value.checkpointStyleType!=="default"||S.value.checkpointStyleBackgroundShape||S.value.checkpointStyleBackgroundColor||S.value.checkpointStyleBorderColor||S.value.checkpointStyleIconColor||S.value.checkpointStyleSize,X=d.eventDefaultStyleType!=="default"||d.eventDefaultStyleBackgroundShape||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||d.eventDefaultStyleBorderColor||d.eventDefaultStyleIconColor||d.eventDefaultStyleSize;if(!te&&!X)return`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="areaDefaultGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981"/>
          <stop offset="50%" style="stop-color:#F59E0B"/>
          <stop offset="100%" style="stop-color:#EF4444"/>
        </linearGradient>
      </defs>
      <circle cx="${24/2}" cy="${24/2}" r="${24/2-2}" fill="url(#areaDefaultGrad)" stroke="#fff" stroke-width="1.5"/>
    </svg>`;const N=S.value.checkpointStyleType&&S.value.checkpointStyleType!=="default"?S.value.checkpointStyleType:d.eventDefaultStyleType&&d.eventDefaultStyleType!=="default"?d.eventDefaultStyleType:"default",K=S.value.checkpointStyleBackgroundShape||d.eventDefaultStyleBackgroundShape||"circle",ee=S.value.checkpointStyleBackgroundColor||d.eventDefaultStyleBackgroundColor||d.eventDefaultStyleColor||"#667eea",$e=S.value.checkpointStyleBorderColor||d.eventDefaultStyleBorderColor||"#ffffff",We=S.value.checkpointStyleIconColor||d.eventDefaultStyleIconColor||"#ffffff",ot=S.value.checkpointStyleSize||d.eventDefaultStyleSize||"100";return fn({type:N!=="default"?N:K,backgroundShape:K,backgroundColor:ee,borderColor:$e,iconColor:We,size:ot,outputSize:24})}),O=Z(()=>d.area&&d.area.id);Z(()=>{if(!S.value.polygon||S.value.polygon.length===0)return{lat:0,lng:0};const te=S.value.polygon.map(N=>N.lat),X=S.value.polygon.map(N=>N.lng);return{lat:te.reduce((N,K)=>N+K,0)/te.length,lng:X.reduce((N,K)=>N+K,0)/X.length}});const q=Z(()=>!S.value.polygon||S.value.polygon.length===0?[]:S.value.polygon.map((te,X)=>({id:`polygon-point-${X}`,latitude:te.lat,longitude:te.lng}))),V=Z(()=>d.area?.id?d.areas.filter(te=>te.id!==d.area.id).map(te=>({...te,color:"#999999"})):d.areas.map(te=>({...te,color:"#999999"}))),Q=Z(()=>Me.value.map(te=>te.id)),de=Z(()=>{const te=[{value:"details",label:"Details",icon:"details"},{value:"boundary",label:"Boundary",icon:"area"},{value:"contacts",label:"Contacts",icon:"marshal"},{value:"checkpoints",label:c(),icon:"checkpoint"},{value:"checklists",label:i.value.checklists,icon:"checklist"},{value:"notes",label:"Notes",icon:"notes"},{value:"appearance",label:"Appearance",icon:"appearance"}];return d.incidents&&d.incidents.length>0&&te.push({value:"incidents",label:"Incidents",icon:"incidents"}),te}),Ee=Z(()=>de.value.findIndex(te=>te.value===p.value)),ge=Z(()=>Ee.value===de.value.length-1),Pe=Z(()=>ge.value?null:de.value[Ee.value+1]),Fe=Z(()=>Pe.value?`${Pe.value.label}...`:""),ce=Z(()=>{if(!d.area||!d.area.id)return[];const te=d.checkpoints.filter(X=>X.areaIds&&X.areaIds.includes(d.area.id)).map(X=>X.id);return d.assignments.filter(X=>te.includes(X.locationId))}),Me=Z(()=>!d.area||!d.area.id?[]:d.checkpoints.filter(te=>te.areaIds&&te.areaIds.includes(d.area.id))),ke=Z(()=>{const te=[...Me.value];return te.sort((X,N)=>{const K=X.name.match(/^(\d+)/),ee=N.name.match(/^(\d+)/);if(K&&ee){const $e=parseInt(K[1]),We=parseInt(ee[1]);if($e!==We)return $e-We}return X.name.localeCompare(N.name,void 0,{numeric:!0,sensitivity:"base"})}),te}),re=Z(()=>!d.area||!d.area.id?[]:d.contacts.filter(te=>te.scopeConfigurations?te.scopeConfigurations.some(X=>X.scope==="EveryoneInAreas"&&X.itemType==="Area"?X.ids?.includes("ALL_AREAS")?!0:X.ids?.includes(d.area.id):!1):!1)),Re=Z(()=>{const te=new Set(re.value.map(K=>K.contactId)),X=re.value.map(K=>({...K,isPending:!1,isExisting:!0,isMarkedForRemoval:M.value.includes(K.contactId)})),N=D.value.filter(K=>!te.has(K.contactId)).map(K=>({...K,isPending:!0,isExisting:!1,isMarkedForRemoval:!1}));return[...X,...N].sort((K,ee)=>K.name.localeCompare(ee.name,void 0,{sensitivity:"base"}))}),Je=Z(()=>{const te=re.value.map(N=>N.contactId),X=D.value.map(N=>N.contactId);return[...te,...X]}),tt=async te=>{if(!(_.value[te]||b.value[te])){b.value[te]=!0;try{const N=(await Pt.getCheckpointChecklist(d.eventId,te)).data||[];_.value[te]={total:N.length,completed:N.filter(K=>K.isCompleted).length}}catch(X){console.error("Failed to load checklist status for checkpoint:",te,X),_.value[te]={total:0,completed:0}}finally{b.value[te]=!1}}};Ge(()=>d.area,te=>{if(te){const X=te.polygon?typeof te.polygon=="string"?JSON.parse(te.polygon):te.polygon:[];S.value={name:te.name||"",description:te.description||"",color:te.color||mr,displayOrder:te.displayOrder||0,isDefault:te.isDefault||!1,polygon:X,checkpointStyleType:te.checkpointStyleType||"default",checkpointStyleColor:te.checkpointStyleColor||"",checkpointStyleBackgroundShape:te.checkpointStyleBackgroundShape||"",checkpointStyleBackgroundColor:te.checkpointStyleBackgroundColor||"",checkpointStyleBorderColor:te.checkpointStyleBorderColor||"",checkpointStyleIconColor:te.checkpointStyleIconColor||"",checkpointStyleSize:te.checkpointStyleSize||"",checkpointStyleMapRotation:te.checkpointStyleMapRotation??"",peopleTerm:te.peopleTerm||"",checkpointTerm:te.checkpointTerm||""}}else S.value={name:"",description:"",color:Gh(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}},{immediate:!0,deep:!0}),Ge(()=>d.show,te=>{te&&(p.value=d.initialTab||"details",k.value=[],_.value={},b.value={},D.value=[],M.value=[],E.value=!1,O.value||(S.value={name:"",description:"",color:Gh(d.areas),displayOrder:d.areas.length,isDefault:!1,polygon:[],checkpointStyleType:"default",checkpointStyleColor:"",checkpointStyleBackgroundShape:"",checkpointStyleBackgroundColor:"",checkpointStyleBorderColor:"",checkpointStyleIconColor:"",checkpointStyleSize:"",checkpointStyleMapRotation:"",peopleTerm:"",checkpointTerm:""}),g.value?.resetLocalState&&g.value.resetLocalState())}),Ge(p,te=>{te==="checkpoints"&&d.area&&d.area.id&&Me.value.forEach(X=>{setTimeout(()=>tt(X.id),0)})});const qe=()=>{f("update:isDirty",!0)},Qe=te=>{S.value.color=te,qe()},be=(te,X)=>{S.value[te]=X,qe()},ze=()=>{f("draw-boundary",S.value)},fe=te=>{S.value.polygon=te,qe()},Le=()=>{S.value.polygon=[],C.value=!1,qe()},Ae=te=>{E.value=!1,f("create-contact-from-marshal",{marshal:te,area:d.area})},W=te=>{E.value=!1,f("create-new-contact",{name:te,area:d.area})},J=te=>{D.value.find(X=>X.contactId===te.contactId)||(D.value.push(te),qe()),E.value=!1},ue=te=>{D.value=D.value.filter(X=>X.contactId!==te),qe()},ye=te=>{M.value.includes(te)||(M.value.push(te),qe())},ae=te=>te.isPending?"Remove pending contact":`Remove from ${s.value.area}`,ie=te=>{Re.value.find(N=>N.contactId===te)?.isPending?ue(te):ye(te)},he=te=>{M.value=M.value.filter(X=>X!==te),qe()},De=te=>{k.value=te,qe()},Te=()=>{Pe.value&&(p.value=Pe.value.value)},oe=()=>{const te=d.area?{name:S.value.name,description:S.value.description,color:S.value.color,polygon:S.value.polygon.length>0?S.value.polygon:null,displayOrder:S.value.displayOrder,checkpointStyleType:S.value.checkpointStyleType,checkpointStyleColor:S.value.checkpointStyleColor,checkpointStyleBackgroundShape:S.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:S.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:S.value.checkpointStyleBorderColor,checkpointStyleIconColor:S.value.checkpointStyleIconColor,checkpointStyleSize:S.value.checkpointStyleSize,checkpointStyleMapRotation:S.value.checkpointStyleMapRotation!=null&&S.value.checkpointStyleMapRotation!==""?String(S.value.checkpointStyleMapRotation):null,peopleTerm:S.value.peopleTerm,checkpointTerm:S.value.checkpointTerm,checklistChanges:k.value||[],pendingContacts:D.value||[],contactsToRemove:M.value||[]}:{name:S.value.name,description:S.value.description,color:S.value.color,polygon:S.value.polygon.length>0?S.value.polygon:null,checkpointStyleType:S.value.checkpointStyleType,checkpointStyleColor:S.value.checkpointStyleColor,checkpointStyleBackgroundShape:S.value.checkpointStyleBackgroundShape,checkpointStyleBackgroundColor:S.value.checkpointStyleBackgroundColor,checkpointStyleBorderColor:S.value.checkpointStyleBorderColor,checkpointStyleIconColor:S.value.checkpointStyleIconColor,checkpointStyleSize:S.value.checkpointStyleSize,checkpointStyleMapRotation:S.value.checkpointStyleMapRotation!=null&&S.value.checkpointStyleMapRotation!==""?String(S.value.checkpointStyleMapRotation):null,peopleTerm:S.value.peopleTerm,checkpointTerm:S.value.checkpointTerm,pendingContacts:D.value||[]};f("save",te)},ve=()=>{f("delete",d.area.id)},se=()=>{f("close")};return t({addPendingContact:te=>{te&&!D.value.find(X=>X.contactId===te.contactId)&&(D.value.push(te),qe())},removeContactById:te=>{const X=D.value.some(N=>N.contactId===te);D.value=D.value.filter(N=>N.contactId!==te),M.value=M.value.filter(N=>N!==te),X&&qe()}}),(te,X)=>(v(),Ye(zt,{show:e.show,title:e.area&&e.area.id?`Edit ${j(s).area}: ${e.area.name}`:`Create new ${j(s).area}`,size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:se},{"tab-header":Ue(()=>[Oe(Ha,{modelValue:p.value,"onUpdate:modelValue":X[0]||(X[0]=N=>p.value=N),tabs:de.value},null,8,["modelValue","tabs"])]),footer:Ue(()=>[l("div",m5,[l("div",g5,[O.value&&!S.value.isDefault?(v(),m("button",{key:0,type:"button",onClick:ve,class:"btn btn-danger"}," Delete "+w(j(s).area),1)):P("",!0),!O.value&&!ge.value?(v(),m("button",{key:1,type:"button",onClick:Te,class:"btn btn-secondary mobile-only"},w(Fe.value),1)):P("",!0)]),l("button",{type:"button",onClick:oe,class:"btn btn-success"}," Save ")])]),default:Ue(()=>[p.value==="details"?(v(),m("div",_6,[l("form",{onSubmit:ht(oe,["prevent"])},[l("div",k6,[X[25]||(X[25]=l("label",null,"Name *",-1)),He(l("input",{"onUpdate:modelValue":X[1]||(X[1]=N=>S.value.name=N),type:"text",required:"",class:"form-input",disabled:S.value.isDefault,onInput:qe},null,40,b6),[[nt,S.value.name]])]),l("div",w6,[X[26]||(X[26]=l("label",null,"Description",-1)),He(l("textarea",{"onUpdate:modelValue":X[2]||(X[2]=N=>S.value.description=N),class:"form-input",rows:"3",onInput:qe},null,544),[[nt,S.value.description]])])],32)])):P("",!0),p.value==="boundary"?(v(),m("div",C6,[l("div",L6,[S.value.polygon&&S.value.polygon.length>0?(v(),m("div",S6,[Oe(ta,{mode:"edit-polygon","editing-polygon":S.value.polygon,route:e.route,locations:e.checkpoints,areas:V.value,"highlight-location-ids":Q.value,"simplify-non-highlighted":!0,"all-locations-for-bounds":q.value,height:"300px",onPolygonUpdate:fe},null,8,["editing-polygon","route","locations","areas","highlight-location-ids","all-locations-for-bounds"]),X[27]||(X[27]=l("p",{class:"boundary-hint"},"Drag points to move them. Click a point to delete it (minimum 3 required).",-1))])):P("",!0),l("div",x6,[!S.value.polygon||S.value.polygon.length===0?(v(),m("button",{key:0,onClick:ze,class:"btn btn-primary btn-full"}," Draw on map ")):(v(),m(Se,{key:1},[l("button",{onClick:ze,class:"btn btn-secondary"}," Redraw "),l("button",{onClick:X[3]||(X[3]=N=>C.value=!0),class:"btn btn-danger"}," Delete boundary ")],64))])])])):P("",!0),Oe(Ra,{show:C.value,title:"Delete boundary",message:"Are you sure you want to delete this boundary? This cannot be undone.","confirm-text":"Delete","is-danger":!0,onConfirm:Le,onCancel:X[4]||(X[4]=N=>C.value=!1)},null,8,["show"]),p.value==="contacts"?(v(),m("div",I6,[l("div",$6,[l("h3",T6,w(j(i).area)+" contacts ("+w(Re.value.length)+")",1),l("button",{onClick:X[5]||(X[5]=N=>E.value=!0),class:"btn btn-primary btn-small"}," Add contact ")]),Oe(bv,{contacts:Re.value,"show-remove-button":!0,"remove-title":ae,"empty-message":`No contacts assigned to this ${j(s).area}.`,"empty-hint":`Click 'Add contact' to assign contacts who will be visible to ${j(s).people} in this ${j(s).area}.`,onSelect:X[6]||(X[6]=N=>te.$emit("edit-contact",N)),onRemove:ie,onUndoRemove:he},null,8,["contacts","empty-message","empty-hint"])])):P("",!0),Oe(y6,{show:E.value,"area-name":S.value.name||"this "+j(s).area,"area-id":d.area?.id||"",contacts:d.contacts,marshals:d.marshals,"exclude-contact-ids":Je.value,onClose:X[7]||(X[7]=N=>E.value=!1),onSelectContact:J,onCreateFromMarshal:Ae,onCreateNew:W},null,8,["show","area-name","area-id","contacts","marshals","exclude-contact-ids"]),p.value==="checkpoints"&&O.value?(v(),m("div",M6,[l("h3",A6,w(c())+" in "+w(e.area?.name)+" ("+w(Me.value.length)+")",1),Oe(Sv,{checkpoints:ke.value,areas:e.areas,"empty-message":`No ${u()} in this ${j(s).area} yet.`,onSelect:X[8]||(X[8]=N=>te.$emit("select-checkpoint",N))},null,8,["checkpoints","areas","empty-message"])])):P("",!0),p.value==="checkpoints"&&!O.value?(v(),m("div",E6,[l("p",null,w(c())+" will be automatically assigned based on boundaries after the "+w(j(s).area)+" is created.",1)])):P("",!0),p.value==="checklists"&&O.value?(v(),Ye(Iv,{key:5,ref_key:"checklistTabRef",ref:g,modelValue:k.value,"onUpdate:modelValue":X[9]||(X[9]=N=>k.value=N),"event-id":e.eventId,"area-id":e.area.id,locations:e.allLocations,areas:e.areas,assignments:ce.value,onChange:De},null,8,["modelValue","event-id","area-id","locations","areas","assignments"])):P("",!0),p.value==="checklists"&&!O.value?(v(),m("div",P6,[l("p",null,w(j(i).checklists)+" can be assigned after the "+w(j(s).area)+" is created.",1)])):P("",!0),p.value==="notes"&&O.value?(v(),Ye(ac,{key:7,"event-id":e.eventId,"area-id":e.area?.id,"all-notes":e.notes,locations:e.allLocations,areas:e.areas,assignments:e.assignments},null,8,["event-id","area-id","all-notes","locations","areas","assignments"])):P("",!0),p.value==="notes"&&!O.value?(v(),m("div",D6,[l("p",null,"Notes can be viewed after the "+w(j(s).area)+" is created.",1)])):P("",!0),p.value==="appearance"?(v(),m("div",O6,[l("div",R6,[l("button",{type:"button",class:pe(["accordion-header",{expanded:A.value.polygonColor}]),onClick:X[10]||(X[10]=N=>U("polygonColor"))},[l("div",{class:"accordion-icon",innerHTML:I.value},null,8,B6),l("span",N6,w(j(i).area)+" polygon colour",1),l("span",F6,w(A.value.polygonColor?"":""),1)],2),A.value.polygonColor?(v(),m("div",U6,[l("p",z6," Choose a colour for this "+w(j(s).area)+"'s boundary on the map. ",1),l("div",H6,[(v(!0),m(Se,null,Be(j(ro),N=>(v(),m("div",{key:N.hex,class:pe(["color-swatch",{selected:S.value.color===N.hex}]),style:rt({backgroundColor:N.hex}),title:N.name,onClick:K=>Qe(N.hex)},null,14,V6))),128))])])):P("",!0)]),l("div",G6,[l("button",{type:"button",class:pe(["accordion-header",{expanded:A.value.iconStyle}]),onClick:X[11]||(X[11]=N=>U("iconStyle"))},[l("div",{class:"accordion-icon",innerHTML:H.value},null,8,Z6),l("span",j6,w(c(!1))+" marker style",1),l("span",q6,w(A.value.iconStyle?"":""),1)],2),A.value.iconStyle?(v(),m("div",W6,[l("p",K6," Set a default marker style for all "+w(u())+" in this "+w(j(s).area)+". Individual "+w(u())+" can override this setting. ",1),Oe(Gu,{"style-type":S.value.checkpointStyleType||"default","style-color":S.value.checkpointStyleColor||"","style-background-shape":S.value.checkpointStyleBackgroundShape||"","style-background-color":S.value.checkpointStyleBackgroundColor||"","style-border-color":S.value.checkpointStyleBorderColor||"","style-icon-color":S.value.checkpointStyleIconColor||"","style-size":S.value.checkpointStyleSize||"","style-map-rotation":S.value.checkpointStyleMapRotation??"","inherited-style-type":e.eventDefaultStyleType,"inherited-style-color":e.eventDefaultStyleColor,"inherited-background-shape":e.eventDefaultStyleBackgroundShape||"","inherited-background-color":e.eventDefaultStyleBackgroundColor||e.eventDefaultStyleColor||"","inherited-border-color":e.eventDefaultStyleBorderColor||"","inherited-icon-color":e.eventDefaultStyleIconColor||"","inherited-size":e.eventDefaultStyleSize||"","inherited-map-rotation":e.eventDefaultStyleMapRotation??"","default-label":"Event default","icon-label":"Marker style",level:"area","show-preview":!0,"onUpdate:styleType":X[12]||(X[12]=N=>be("checkpointStyleType",N)),"onUpdate:styleColor":X[13]||(X[13]=N=>be("checkpointStyleColor",N)),"onUpdate:styleBackgroundShape":X[14]||(X[14]=N=>be("checkpointStyleBackgroundShape",N)),"onUpdate:styleBackgroundColor":X[15]||(X[15]=N=>be("checkpointStyleBackgroundColor",N)),"onUpdate:styleBorderColor":X[16]||(X[16]=N=>be("checkpointStyleBorderColor",N)),"onUpdate:styleIconColor":X[17]||(X[17]=N=>be("checkpointStyleIconColor",N)),"onUpdate:styleSize":X[18]||(X[18]=N=>be("checkpointStyleSize",N)),"onUpdate:styleMapRotation":X[19]||(X[19]=N=>be("checkpointStyleMapRotation",N))},null,8,["style-type","style-color","style-background-shape","style-background-color","style-border-color","style-icon-color","style-size","style-map-rotation","inherited-style-type","inherited-style-color","inherited-background-shape","inherited-background-color","inherited-border-color","inherited-icon-color","inherited-size","inherited-map-rotation"])])):P("",!0)]),l("div",Y6,[l("button",{type:"button",class:pe(["accordion-header",{expanded:A.value.peopleTerm}]),onClick:X[20]||(X[20]=N=>U("peopleTerm"))},[X[28]||(X[28]=l("div",{class:"accordion-icon"},[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("circle",{cx:"12",cy:"8",r:"4",fill:"#6366F1"}),l("path",{d:"M4 20c0-4.4 3.6-8 8-8s8 3.6 8 8",fill:"#6366F1",opacity:"0.6"})])],-1)),l("span",J6,w(a())+" terminology",1),l("span",X6,w(S.value.peopleTerm||`${e.eventPeopleTerm} (event default)`),1),l("span",Q6,w(A.value.peopleTerm?"":""),1)],2),A.value.peopleTerm?(v(),m("div",e5,[l("p",t5," Choose what "+w(a().toLowerCase())+" are called in this "+w(j(s).area)+". This will be inherited by "+w(u())+" unless they override it. ",1),l("div",n5,[X[29]||(X[29]=l("label",null,"What are people called?",-1)),He(l("select",{"onUpdate:modelValue":X[21]||(X[21]=N=>S.value.peopleTerm=N),class:"form-input",onChange:qe},[l("option",o5,"Use event default ("+w(e.eventPeopleTerm)+")",1),(v(!0),m(Se,null,Be(j(Ns).people,N=>(v(),m("option",{key:N,value:N},w(N),9,s5))),128))],544),[[Tn,S.value.peopleTerm]])])])):P("",!0)]),l("div",i5,[l("button",{type:"button",class:pe(["accordion-header",{expanded:A.value.checkpointTerm}]),onClick:X[22]||(X[22]=N=>U("checkpointTerm"))},[X[30]||(X[30]=l("div",{class:"accordion-icon"},[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z",fill:"#10B981"}),l("circle",{cx:"12",cy:"9",r:"2.5",fill:"white"})])],-1)),l("span",a5,w(c(!1))+" terminology",1),l("span",l5,w(S.value.checkpointTerm?j(uu)(S.value.checkpointTerm,a()):`${e.eventCheckpointTerm} (event default)`),1),l("span",r5,w(A.value.checkpointTerm?"":""),1)],2),A.value.checkpointTerm?(v(),m("div",c5,[l("p",u5," Choose what "+w(u())+" are called in this "+w(j(s).area)+". ",1),l("div",d5,[l("label",null,"What are "+w(u())+" called?",1),He(l("select",{"onUpdate:modelValue":X[23]||(X[23]=N=>S.value.checkpointTerm=N),class:"form-input",onChange:qe},[l("option",h5,"Use event default ("+w(e.eventCheckpointTerm)+")",1),(v(!0),m(Se,null,Be(j(Ns).checkpoint,N=>(v(),m("option",{key:N,value:N},w(j(uu)(N,a())),9,f5))),128))],544),[[Tn,S.value.checkpointTerm]])])])):P("",!0)])])):P("",!0),p.value==="incidents"?(v(),m("div",p5,[l("div",v5,[(v(!0),m(Se,null,Be(e.incidents,N=>(v(),Ye(Zl,{key:N.incidentId,incident:N,onSelect:X[24]||(X[24]=K=>te.$emit("select-incident",K))},null,8,["incident"]))),128))])])):P("",!0)]),_:1},8,["show","title","is-dirty"]))}},_5=je(y5,[["__scopeId","data-v-02f7c9f6"]]),k5=["innerHTML"],b5={__name:"InfoModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Information"},message:{type:String,required:!0},okText:{type:String,default:"OK"}},emits:["close"],setup(e,{emit:t}){const o=t,i=()=>{o("close")};return(s,a)=>(v(),Ye(zt,{show:e.show,title:e.title,size:"small","z-index":2e3,onClose:i},{actions:Ue(()=>[l("button",{onClick:i,class:"btn btn-primary"},w(e.okText),1)]),default:Ue(()=>[l("div",{class:"info-content",innerHTML:e.message},null,8,k5)]),_:1},8,["show","title"]))}},lc=je(b5,[["__scopeId","data-v-a6e7148c"]]),w5={class:"tab-content"},C5={class:"form-group"},L5=["placeholder"],S5={key:0,class:"checkbox-label-inline create-separate-items"},x5={class:"tab-content"},I5={class:"custom-footer"},$5={class:"footer-left"},T5={__name:"EditChecklistItemModal",props:{show:{type:Boolean,default:!1},checklistItem:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=T(!1),a=T(""),c=T("details"),u=T({text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0}),d=Z(()=>!!o.checklistItem),f=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],p=Z(()=>f.findIndex(A=>A.value===c.value)),g=Z(()=>p.value===f.length-1),k=Z(()=>g.value?"":f[p.value+1]?.label||"");Ge(()=>o.show,A=>{A&&(c.value=o.initialTab,o.checklistItem?u.value={text:o.checklistItem.text||"",scopeConfigurations:o.checklistItem.scopeConfigurations?JSON.parse(JSON.stringify(o.checklistItem.scopeConfigurations)):[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:o.checklistItem.displayOrder||0,isRequired:o.checklistItem.isRequired!==!1,visibleFrom:o.checklistItem.visibleFrom?_(o.checklistItem.visibleFrom):null,visibleUntil:o.checklistItem.visibleUntil?_(o.checklistItem.visibleUntil):null,mustCompleteBy:o.checklistItem.mustCompleteBy?_(o.checklistItem.mustCompleteBy):null,createSeparateItems:!1}:u.value={text:"",scopeConfigurations:[{scope:"Everyone",itemType:null,ids:[]}],displayOrder:0,isRequired:!0,visibleFrom:null,visibleUntil:null,mustCompleteBy:null,createSeparateItems:!0},i("update:isDirty",!1))});const _=A=>{if(!A)return null;const U=new Date(A),I=U.getTimezoneOffset();return new Date(U.getTime()-I*60*1e3).toISOString().slice(0,16)},b=A=>A?new Date(A).toISOString():null,C=()=>{i("update:isDirty",!0)},E=()=>{i("close")},D=()=>{g.value||(c.value=f[p.value+1].value)},M=A=>{a.value=A,s.value=!0},S=()=>{if(!u.value.text||!u.value.text.trim()){M("Please enter checklist item text");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){M("Please select at least one scope");return}if(!u.value.scopeConfigurations.some(I=>!(I.itemType!==null&&(!I.ids||I.ids.length===0)))){M("Please configure at least one scope with valid selections");return}const U={text:u.value.text,scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,isRequired:u.value.isRequired,visibleFrom:b(u.value.visibleFrom),visibleUntil:b(u.value.visibleUntil),mustCompleteBy:b(u.value.mustCompleteBy)};d.value||(U.createSeparateItems=u.value.createSeparateItems),i("save",U)},$=()=>{i("delete",o.checklistItem.itemId)};return(A,U)=>(v(),m(Se,null,[Oe(zt,{show:e.show,title:d.value?"Edit checklist item":"Create checklist item",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:E},{"tab-header":Ue(()=>[Oe(Ha,{modelValue:c.value,"onUpdate:modelValue":U[0]||(U[0]=I=>c.value=I),tabs:f},null,8,["modelValue"])]),footer:Ue(()=>[l("div",I5,[l("div",$5,[d.value?(v(),m("button",{key:0,type:"button",onClick:$,class:"btn btn-danger"}," Delete ")):P("",!0),!d.value&&!g.value?(v(),m("button",{key:1,type:"button",onClick:D,class:"btn btn-secondary mobile-only"},w(k.value)+"... ",1)):P("",!0)]),l("button",{type:"button",onClick:S,class:"btn btn-success"}," Save ")])]),default:Ue(()=>[l("form",{onSubmit:ht(S,["prevent"]),class:"checklist-form"},[He(l("div",w5,[l("div",C5,[U[6]||(U[6]=l("label",{for:"text"},"Checklist text: *",-1)),He(l("textarea",{id:"text","onUpdate:modelValue":U[1]||(U[1]=I=>u.value.text=I),onInput:C,required:"",rows:"3",placeholder:u.value.createSeparateItems?"Enter checklist items, one per line...":"Enter the checklist item text..."},null,40,L5),[[nt,u.value.text]]),d.value?P("",!0):(v(),m("label",S5,[He(l("input",{type:"checkbox","onUpdate:modelValue":U[2]||(U[2]=I=>u.value.createSeparateItems=I),onChange:C},null,544),[[Kr,u.value.createSeparateItems]]),U[5]||(U[5]=l("span",null,"Each line creates a new item",-1))]))])],512),[[bi,c.value==="details"]]),He(l("div",x5,[Oe(ic,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":U[3]||(U[3]=I=>u.value.scopeConfigurations=I),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":d.value,onUserChanged:C},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[bi,c.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Oe(lc,{show:s.value,title:"Validation error",message:a.value,onClose:U[4]||(U[4]=I=>s.value=!1)},null,8,["show","message"])],64))}},M5=je(T5,[["__scopeId","data-v-1384b208"]]),A5={class:"tab-content"},E5={class:"form-group"},P5={class:"form-group"},D5={class:"form-row"},O5={class:"form-group"},R5={class:"form-group"},B5={class:"form-row"},N5={class:"form-group"},F5={class:"form-group checkbox-group-inline"},U5={class:"checkbox-label-inline"},z5={class:"tab-content"},H5={class:"custom-footer"},V5={class:"footer-left"},G5={__name:"EditNoteModal",props:{show:{type:Boolean,default:!1},note:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const o=e,i=t,s=T(!1),a=T(""),c=T("details"),u=T({title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1}),d=Z(()=>!!o.note),f=[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}],p=Z(()=>f.findIndex(S=>S.value===c.value)),g=Z(()=>p.value===f.length-1),k=Z(()=>g.value?"":f[p.value+1]?.label||"");Ge(()=>o.show,S=>{S&&(c.value=o.initialTab,o.note?u.value={title:o.note.title||"",content:o.note.content||"",scopeConfigurations:o.note.scopeConfigurations?JSON.parse(JSON.stringify(o.note.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:o.note.displayOrder||0,priority:o.note.priority||"Normal",category:o.note.category||"",isPinned:o.note.isPinned||!1}:u.value={title:"",content:"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}],displayOrder:0,priority:"Normal",category:"",isPinned:!1},i("update:isDirty",!1))});const _=()=>{i("update:isDirty",!0)},b=()=>{i("close")},C=()=>{g.value||(c.value=f[p.value+1].value)},E=S=>{a.value=S,s.value=!0},D=()=>{if(!u.value.title||!u.value.title.trim()){E("Please enter a note title");return}if(!u.value.scopeConfigurations||u.value.scopeConfigurations.length===0){E("Please select at least one visibility scope");return}if(!u.value.scopeConfigurations.some(A=>!(A.itemType!==null&&(!A.ids||A.ids.length===0)))){E("Please configure at least one scope with valid selections");return}const $={title:u.value.title.trim(),content:u.value.content||"",scopeConfigurations:u.value.scopeConfigurations,displayOrder:u.value.displayOrder||0,priority:u.value.priority||"Normal",category:u.value.category?.trim()||null,isPinned:u.value.isPinned||!1};i("save",$)},M=()=>{i("delete",o.note.noteId)};return(S,$)=>(v(),m(Se,null,[Oe(zt,{show:e.show,title:d.value?"Edit note":"Create note",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:b},{"tab-header":Ue(()=>[Oe(Ha,{modelValue:c.value,"onUpdate:modelValue":$[0]||($[0]=A=>c.value=A),tabs:f},null,8,["modelValue"])]),footer:Ue(()=>[l("div",H5,[l("div",V5,[d.value?(v(),m("button",{key:0,type:"button",onClick:M,class:"btn btn-danger"}," Delete ")):P("",!0),!d.value&&!g.value?(v(),m("button",{key:1,type:"button",onClick:C,class:"btn btn-secondary mobile-only"},w(k.value)+"... ",1)):P("",!0)]),l("button",{type:"button",onClick:D,class:"btn btn-success"}," Save ")])]),default:Ue(()=>[l("form",{onSubmit:ht(D,["prevent"]),class:"note-form"},[He(l("div",A5,[l("div",E5,[$[9]||($[9]=l("label",{for:"title"},"Title: *",-1)),He(l("input",{id:"title","onUpdate:modelValue":$[1]||($[1]=A=>u.value.title=A),type:"text",onInput:_,required:"",placeholder:"Enter note title..."},null,544),[[nt,u.value.title]])]),l("div",P5,[$[10]||($[10]=l("label",{for:"content"},"Content:",-1)),He(l("textarea",{id:"content","onUpdate:modelValue":$[2]||($[2]=A=>u.value.content=A),onInput:_,rows:"6",placeholder:"Enter note content (supports markdown)..."},null,544),[[nt,u.value.content]])]),l("div",D5,[l("div",O5,[$[12]||($[12]=l("label",{for:"priority"},"Priority:",-1)),He(l("select",{id:"priority","onUpdate:modelValue":$[3]||($[3]=A=>u.value.priority=A),onChange:_},[...$[11]||($[11]=[l("option",{value:"Emergency"},"Emergency",-1),l("option",{value:"Urgent"},"Urgent",-1),l("option",{value:"High"},"High",-1),l("option",{value:"Normal"},"Normal",-1),l("option",{value:"Low"},"Low",-1)])],544),[[Tn,u.value.priority]])]),l("div",R5,[$[13]||($[13]=l("label",{for:"category"},"Category:",-1)),He(l("input",{id:"category","onUpdate:modelValue":$[4]||($[4]=A=>u.value.category=A),type:"text",onInput:_,placeholder:"e.g., Safety, Logistics..."},null,544),[[nt,u.value.category]])])]),l("div",B5,[l("div",N5,[$[14]||($[14]=l("label",{for:"displayOrder"},"Display order:",-1)),He(l("input",{id:"displayOrder","onUpdate:modelValue":$[5]||($[5]=A=>u.value.displayOrder=A),type:"number",onInput:_,min:"0"},null,544),[[nt,u.value.displayOrder,void 0,{number:!0}]]),$[15]||($[15]=l("span",{class:"help-text"},"Lower numbers appear first",-1))]),l("div",F5,[l("label",U5,[He(l("input",{type:"checkbox","onUpdate:modelValue":$[6]||($[6]=A=>u.value.isPinned=A),onChange:_},null,544),[[Kr,u.value.isPinned]]),$[16]||($[16]=l("span",null,"Pin to top",-1))]),$[17]||($[17]=l("span",{class:"help-text"},"Pinned notes always appear at the top",-1))])])],512),[[bi,c.value==="details"]]),He(l("div",z5,[Oe(ic,{modelValue:u.value.scopeConfigurations,"onUpdate:modelValue":$[7]||($[7]=A=>u.value.scopeConfigurations=A),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":d.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this note?",onUserChanged:_},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[bi,c.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Oe(lc,{show:s.value,title:"Validation error",message:a.value,onClose:$[8]||($[8]=A=>s.value=!1)},null,8,["show","message"])],64))}},Z5=je(G5,[["__scopeId","data-v-aa4ca951"]]),j5={class:"incident-detail-header"},q5={class:"header-title-row"},W5={class:"modal-title"},K5={class:"header-badges"},Y5=["disabled"],J5={key:0,class:"status-dropdown-menu"},X5=["onClick","disabled"],Q5={key:0,class:"incident-detail-content"},eD={class:"accordion-section"},tD={class:"accordion-arrow"},nD={key:0,class:"accordion-content"},oD={class:"description-text"},sD={class:"accordion-section"},iD={class:"accordion-arrow"},aD={key:0,class:"accordion-content"},lD={class:"info-grid"},rD={class:"info-item"},cD={class:"info-value"},uD={class:"info-item"},dD={class:"info-value"},hD={key:0,class:"info-item"},fD={class:"info-value"},pD={key:1,class:"info-item"},vD={class:"info-value"},mD={key:2,class:"info-item"},gD={class:"info-value"},yD={key:0,class:"incident-map-container"},_D={class:"accordion-section"},kD={class:"accordion-preview"},bD={class:"accordion-arrow"},wD={key:0,class:"accordion-content"},CD={class:"reporter-info"},LD={class:"reporter-name"},SD={key:0,class:"accordion-section"},xD={class:"accordion-preview"},ID={class:"accordion-arrow"},$D={key:0,class:"accordion-content"},TD={class:"marshals-list"},MD={class:"marshal-name"},AD={key:0,class:"checkin-badge success"},ED={key:1,class:"checkin-badge not-checked-in"},PD={class:"accordion-section"},DD={key:0,class:"accordion-preview"},OD={class:"accordion-arrow"},RD={key:0,class:"accordion-content"},BD={key:0,class:"notes-timeline"},ND={class:"note-header"},FD={class:"note-author"},UD={class:"note-time"},zD={key:0,class:"note-status-change"},HD={key:1,class:"note-text"},VD={key:1,class:"no-notes"},GD={__name:"IncidentDetailModal",props:{show:{type:Boolean,required:!0},incident:{type:Object,default:null},canManage:{type:Boolean,default:!1},route:{type:Array,default:()=>[]},checkpoints:{type:Array,default:()=>[]}},emits:["close","status-change","open-add-note"],setup(e,{emit:t}){const o=e,i=t,s=T(!1),a=T(!1),c=T(null),u=T({description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1});Ge(()=>o.show,H=>{H&&(u.value={description:!0,timeLocation:!1,reporter:!1,marshals:!1,notes:!1},a.value=!1)});const d=H=>{c.value&&!c.value.contains(H.target)&&(a.value=!1)};Ge(a,H=>{H?document.addEventListener("click",d):document.removeEventListener("click",d)});const f=()=>{a.value=!a.value},p=H=>{o.incident?.status!==H&&(a.value=!1,I(H))},g=H=>{const O=u.value[H];Object.keys(u.value).forEach(q=>{u.value[q]=!1}),O||(u.value[H]=!0)},k=Z(()=>o.incident?.latitude!=null&&o.incident?.longitude!=null),_=Z(()=>k.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),b=Z(()=>k.value?{lat:o.incident.latitude,lng:o.incident.longitude}:null),C=Z(()=>{if(!o.incident)return"Incident Details";if(o.incident.title)return o.incident.title;const H=o.incident.description||"";return H.length<=50?H:H.substring(0,47)+"..."}),E=Z(()=>[...o.incident?.context?.marshalsPresentAtCheckpoint||[]].sort((O,q)=>(O.name||"").localeCompare(q.name||"",void 0,{sensitivity:"base"}))),D=[{value:"open",label:"Open"},{value:"acknowledged",label:"Acknowledged"},{value:"in_progress",label:"In Progress"},{value:"resolved",label:"Resolved"},{value:"closed",label:"Closed"}],M=H=>({low:"Low",medium:"Medium",high:"High",critical:"Critical"})[H]||H,S=H=>({open:"Open",acknowledged:"Acknowledged",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"})[H]||H,$=H=>{if(!H)return"";let O=H.name||"";if(H.description){const q=H.description,V=40,Q=q.length>V?q.substring(0,V-3)+"...":q;O+=` - ${Q}`}return O},A=H=>H?new Date(H).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",U=H=>{if(!H)return"";const O=new Date(H),V=new Date-O,Q=Math.floor(V/6e4),de=Math.floor(V/36e5),Ee=Math.floor(V/864e5);return Q<1?"just now":Q<60?`${Q}m ago`:de<24?`${de}h ago`:Ee<7?`${Ee}d ago`:O.toLocaleDateString()},I=async H=>{if(o.incident?.status!==H){s.value=!0;try{i("status-change",{incidentId:o.incident.incidentId,status:H})}finally{s.value=!1}}};return(H,O)=>(v(),Ye(zt,{show:e.show,title:C.value,size:"large",onClose:O[7]||(O[7]=q=>H.$emit("close"))},{header:Ue(()=>[l("div",j5,[l("div",q5,[l("span",{class:pe(["severity-indicator",e.incident?.severity])},null,2),l("h2",W5,w(C.value),1)]),l("div",K5,[l("span",{class:pe(["severity-badge",e.incident?.severity])},w(M(e.incident?.severity)),3),e.canManage?(v(),m("div",{key:0,class:"status-dropdown-container",ref_key:"statusDropdownRef",ref:c},[l("button",{type:"button",class:pe(["status-badge status-dropdown-trigger",e.incident?.status]),onClick:f,disabled:s.value},[Ke(w(S(e.incident?.status))+" ",1),O[8]||(O[8]=l("span",{class:"dropdown-arrow"},"",-1))],10,Y5),a.value?(v(),m("div",J5,[(v(),m(Se,null,Be(D,q=>l("button",{key:q.value,type:"button",class:pe(["status-dropdown-item",{active:e.incident?.status===q.value}]),onClick:V=>p(q.value),disabled:e.incident?.status===q.value},[l("span",{class:pe(["status-dot",q.value])},null,2),Ke(" "+w(q.label),1)],10,X5)),64))])):P("",!0)],512)):(v(),m("span",{key:1,class:pe(["status-badge",e.incident?.status])},w(S(e.incident?.status)),3))])])]),footer:Ue(()=>[l("button",{class:"btn btn-secondary",onClick:O[6]||(O[6]=q=>H.$emit("close"))},"Close")]),default:Ue(()=>[e.incident?(v(),m("div",Q5,[l("div",eD,[l("button",{type:"button",class:pe(["accordion-header",{expanded:u.value.description}]),onClick:O[0]||(O[0]=q=>g("description"))},[O[9]||(O[9]=l("span",{class:"accordion-title"},"Description",-1)),l("span",tD,w(u.value.description?"":""),1)],2),u.value.description?(v(),m("div",nD,[l("p",oD,w(e.incident.description),1)])):P("",!0)]),l("div",sD,[l("button",{type:"button",class:pe(["accordion-header",{expanded:u.value.timeLocation}]),onClick:O[1]||(O[1]=q=>g("timeLocation"))},[O[10]||(O[10]=l("span",{class:"accordion-title"},"Time & location",-1)),l("span",iD,w(u.value.timeLocation?"":""),1)],2),u.value.timeLocation?(v(),m("div",aD,[l("div",lD,[l("div",rD,[O[11]||(O[11]=l("span",{class:"info-label"},"Incident time",-1)),l("span",cD,w(A(e.incident.incidentTime)),1)]),l("div",uD,[O[12]||(O[12]=l("span",{class:"info-label"},"Reported at",-1)),l("span",dD,w(A(e.incident.createdAt)),1)]),e.incident.context?.checkpoint?(v(),m("div",hD,[O[13]||(O[13]=l("span",{class:"info-label"},"Checkpoint",-1)),l("span",fD,w($(e.incident.context.checkpoint)),1)])):P("",!0),e.incident.area?(v(),m("div",pD,[O[14]||(O[14]=l("span",{class:"info-label"},"Area",-1)),l("span",vD,w(e.incident.area.areaName),1)])):P("",!0),k.value?(v(),m("div",mD,[O[15]||(O[15]=l("span",{class:"info-label"},"GPS location",-1)),l("span",gD,w(e.incident.latitude.toFixed(6))+", "+w(e.incident.longitude.toFixed(6)),1)])):P("",!0)]),k.value?(v(),m("div",yD,[Oe(ta,{locations:e.checkpoints,route:e.route,center:_.value,zoom:15,"user-location":b.value,height:"200px"},null,8,["locations","route","center","user-location"])])):P("",!0)])):P("",!0)]),l("div",_D,[l("button",{type:"button",class:pe(["accordion-header",{expanded:u.value.reporter}]),onClick:O[2]||(O[2]=q=>g("reporter"))},[O[16]||(O[16]=l("span",{class:"accordion-title"},"Reported by",-1)),l("span",kD,w(e.incident.reportedBy?.name||"Unknown"),1),l("span",bD,w(u.value.reporter?"":""),1)],2),u.value.reporter?(v(),m("div",wD,[l("div",CD,[l("span",LD,w(e.incident.reportedBy?.name||"Unknown"),1)])])):P("",!0)]),E.value.length?(v(),m("div",SD,[l("button",{type:"button",class:pe(["accordion-header",{expanded:u.value.marshals}]),onClick:O[3]||(O[3]=q=>g("marshals"))},[O[17]||(O[17]=l("span",{class:"accordion-title"},"Marshals at checkpoint",-1)),l("span",xD,w(E.value.length),1),l("span",ID,w(u.value.marshals?"":""),1)],2),u.value.marshals?(v(),m("div",$D,[l("div",TD,[(v(!0),m(Se,null,Be(E.value,q=>(v(),m("div",{key:q.marshalId,class:pe(["marshal-item",{"checked-in":q.wasCheckedIn}])},[l("span",MD,w(q.name),1),q.wasCheckedIn?(v(),m("span",AD," Checked in "+w(U(q.checkInTime)),1)):(v(),m("span",ED," Not checked in "))],2))),128))])])):P("",!0)])):P("",!0),l("div",PD,[l("button",{type:"button",class:pe(["accordion-header",{expanded:u.value.notes}]),onClick:O[4]||(O[4]=q=>g("notes"))},[O[18]||(O[18]=l("span",{class:"accordion-title"},"Updates",-1)),e.incident.updates?.length?(v(),m("span",DD,w(e.incident.updates.length),1)):P("",!0),l("span",OD,w(u.value.notes?"":""),1)],2),u.value.notes?(v(),m("div",RD,[e.incident.updates?.length?(v(),m("div",BD,[(v(!0),m(Se,null,Be(e.incident.updates,(q,V)=>(v(),m("div",{key:V,class:"note-item"},[l("div",ND,[l("span",FD,w(q.authorName||"System"),1),l("span",UD,w(U(q.timestamp)),1)]),q.statusChange?(v(),m("div",zD,[O[19]||(O[19]=Ke(" Status changed to ",-1)),l("span",{class:pe(["status-badge",q.statusChange])},w(S(q.statusChange)),3)])):q.note?(v(),m("p",HD,w(q.note),1)):P("",!0)]))),128))])):(v(),m("div",VD," No updates yet. ")),l("button",{type:"button",class:"btn btn-primary add-note-btn",onClick:O[5]||(O[5]=q=>H.$emit("open-add-note"))}," Add update ")])):P("",!0)])])):P("",!0)]),_:1},8,["show","title"]))}},$v=je(GD,[["__scopeId","data-v-442b7089"]]),ZD={class:"form-group"},jD={class:"form-group"},qD={class:"form-row"},WD={class:"form-group form-group-half"},KD=["value"],YD={class:"form-group form-group-half"},JD={key:0,class:"form-group"},XD=["value"],QD={key:1,class:"form-group"},e8={class:"checkpoint-toggle"},t8={class:"checkbox-label"},n8={class:"checkpoint-name"},o8={key:0,class:"checkpoint-description"},s8={class:"form-group"},i8={class:"location-options"},a8={class:"location-buttons"},l8={key:0,class:"location-status"},r8={key:0,class:"location-getting"},c8={key:1,class:"location-display"},u8={key:0,class:"location-accuracy"},d8={key:2,class:"location-error"},h8={key:1,class:"map-picker-container"},f8={key:0,class:"map-picker-hint"},p8={key:2,class:"location-display"},v8={key:2,class:"error-message"},m8={class:"modal-actions"},g8=["disabled"],y8={__name:"ReportIncidentModal",props:{show:{type:Boolean,required:!0},eventId:{type:String,required:!0},checkpoint:{type:Object,default:null},initialLocation:{type:Object,default:null},checkpoints:{type:Array,default:()=>[]},route:{type:Array,default:()=>[]}},emits:["close","submit"],setup(e,{emit:t}){const o=e,i=t,s=T({title:"",description:"",severity:"medium",incidentTime:""}),a=T(""),c=T(!0),u=T("none"),d=T(!1),f=T(null),p=T(null),g=T(null),k=T(!1),_=T(!1),b=T(null),C=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],E=()=>{const V=new Date,Q=V.getFullYear(),de=String(V.getMonth()+1).padStart(2,"0"),Ee=String(V.getDate()).padStart(2,"0"),ge=String(V.getHours()).padStart(2,"0"),Pe=String(V.getMinutes()).padStart(2,"0");return`${Q}-${de}-${Ee}T${ge}:${Pe}`},D=V=>V?new Date(V).toISOString():null,M=Z(()=>o.checkpoints||[]),S=Z(()=>{if(f.value?.latitude!=null)return{lat:f.value.latitude,lng:f.value.longitude};if(a.value){const V=M.value.find(Q=>Q.id===a.value);if(V?.latitude!=null)return{lat:V.latitude,lng:V.longitude}}if(o.initialLocation?.latitude!=null)return{lat:o.initialLocation.latitude,lng:o.initialLocation.longitude};if(o.checkpoint?.latitude!=null)return{lat:o.checkpoint.latitude,lng:o.checkpoint.longitude};if(M.value.length>0){const V=M.value[0];if(V.latitude!=null)return{lat:V.latitude,lng:V.longitude}}if(o.route?.length>0){const V=o.route[0];if(V?.lat!=null)return{lat:V.lat,lng:V.lng}}return{lat:-33.9,lng:151.2}}),$=Z(()=>s.value.description.trim()!==""),A=Z(()=>s.value.description.trim()!=="");Ge(()=>o.show,V=>{V&&(s.value={title:"",description:"",severity:"medium",incidentTime:E()},a.value="",c.value=!0,_.value=!1,b.value=null,g.value=null,f.value=null,p.value=null,o.initialLocation&&o.initialLocation.latitude!=null?(f.value={latitude:o.initialLocation.latitude,longitude:o.initialLocation.longitude},p.value=o.initialLocation.accuracy,u.value="gps",d.value=!1):(u.value="none",d.value=!1),o.checkpoint&&(a.value=o.checkpoint.locationId||o.checkpoint.id||""))});const U=V=>{g.value=null,V==="map"?u.value==="map"?d.value=!d.value:(u.value="map",d.value=!0,p.value=null):V==="gps"?(u.value="gps",d.value=!1,H()):(u.value="none",d.value=!1,f.value=null,p.value=null)},I=V=>{f.value={latitude:V.lat,longitude:V.lng},p.value=null,d.value=!1},H=()=>{if(o.initialLocation&&o.initialLocation.latitude!=null){f.value={latitude:o.initialLocation.latitude,longitude:o.initialLocation.longitude},p.value=o.initialLocation.accuracy;return}if(!navigator.geolocation){g.value="GPS is not available on this device.";return}k.value=!0,navigator.geolocation.getCurrentPosition(V=>{f.value={latitude:V.coords.latitude,longitude:V.coords.longitude},p.value=V.coords.accuracy,k.value=!1},V=>{g.value="Unable to get your location.",k.value=!1},{enableHighAccuracy:!0,timeout:1e4})},O=async()=>{if(!(!A.value||_.value)){_.value=!0,b.value=null;try{const V=(u.value==="gps"||u.value==="map")&&f.value;let Q=null,de=!1;M.value.length>0?a.value?Q=a.value:de=!0:o.checkpoint&&(c.value?Q=o.checkpoint.locationId||o.checkpoint.id||null:de=!0);const Ee={title:s.value.title.trim()||null,description:s.value.description.trim(),severity:s.value.severity,incidentTime:D(s.value.incidentTime),latitude:V?f.value.latitude:null,longitude:V?f.value.longitude:null,checkpointId:Q,skipCheckpointAutoAssign:de};i("submit",Ee)}catch(V){b.value=V.message||"Failed to report incident. Please try again.",_.value=!1}}},q=()=>{i("close")};return(V,Q)=>(v(),Ye(zt,{show:e.show,title:"Report Incident",size:"medium","confirm-on-close":!0,"is-dirty":$.value,onClose:q},{footer:Ue(()=>[l("div",m8,[l("button",{type:"button",class:"btn btn-secondary",onClick:q}," Cancel "),l("button",{type:"button",class:"btn btn-primary",onClick:O,disabled:!A.value||_.value},w(_.value?"Reporting...":"Report Incident"),9,g8)])]),default:Ue(()=>[l("form",{onSubmit:ht(O,["prevent"]),class:"incident-form"},[l("div",ZD,[Q[10]||(Q[10]=l("label",{for:"title",class:"form-label"},"Title",-1)),He(l("input",{id:"title","onUpdate:modelValue":Q[0]||(Q[0]=de=>s.value.title=de),type:"text",class:"form-input",placeholder:"Brief summary (optional)"},null,512),[[nt,s.value.title]])]),l("div",jD,[Q[11]||(Q[11]=l("label",{for:"description",class:"form-label"},[Ke("Description "),l("span",{class:"required"},"*")],-1)),He(l("textarea",{id:"description","onUpdate:modelValue":Q[1]||(Q[1]=de=>s.value.description=de),class:"form-input form-textarea",placeholder:"Describe what happened...",rows:"3",required:""},null,512),[[nt,s.value.description]])]),l("div",qD,[l("div",WD,[Q[12]||(Q[12]=l("label",{for:"severity",class:"form-label"},"Severity",-1)),He(l("select",{id:"severity","onUpdate:modelValue":Q[2]||(Q[2]=de=>s.value.severity=de),class:"form-input form-select"},[(v(),m(Se,null,Be(C,de=>l("option",{key:de.value,value:de.value},w(de.label),9,KD)),64))],512),[[Tn,s.value.severity]])]),l("div",YD,[Q[13]||(Q[13]=l("label",{for:"incidentTime",class:"form-label"},"When",-1)),He(l("input",{id:"incidentTime","onUpdate:modelValue":Q[3]||(Q[3]=de=>s.value.incidentTime=de),type:"datetime-local",class:"form-input"},null,512),[[nt,s.value.incidentTime]])])]),M.value.length>0?(v(),m("div",JD,[Q[15]||(Q[15]=l("label",{for:"checkpoint",class:"form-label"},"Checkpoint",-1)),He(l("select",{id:"checkpoint","onUpdate:modelValue":Q[4]||(Q[4]=de=>a.value=de),class:"form-input form-select"},[Q[14]||(Q[14]=l("option",{value:""},"-- None / Unknown --",-1)),(v(!0),m(Se,null,Be(M.value,de=>(v(),m("option",{key:de.id,value:de.id},w(de.name)+w(de.description?` - ${de.description}`:""),9,XD))),128))],512),[[Tn,a.value]])])):e.checkpoint?(v(),m("div",QD,[Q[16]||(Q[16]=l("label",{class:"form-label"},"Checkpoint",-1)),l("div",e8,[l("label",t8,[He(l("input",{type:"checkbox","onUpdate:modelValue":Q[5]||(Q[5]=de=>c.value=de)},null,512),[[Kr,c.value]]),l("span",n8,w(e.checkpoint.name),1),e.checkpoint.description?(v(),m("span",o8," - "+w(e.checkpoint.description),1)):P("",!0)])])])):P("",!0),l("div",s8,[Q[17]||(Q[17]=l("label",{class:"form-label"},"Location (optional)",-1)),l("div",i8,[l("div",a8,[l("button",{type:"button",class:pe(["location-btn",{active:u.value==="gps"}]),onClick:Q[6]||(Q[6]=de=>U("gps"))}," GPS ",2),l("button",{type:"button",class:pe(["location-btn",{active:u.value==="map"}]),onClick:Q[7]||(Q[7]=de=>U("map"))}," Pick on map ",2),l("button",{type:"button",class:pe(["location-btn",{active:u.value==="none"}]),onClick:Q[8]||(Q[8]=de=>U("none"))}," None ",2)]),u.value==="gps"?(v(),m("div",l8,[k.value?(v(),m("div",r8," Getting location... ")):f.value&&f.value.latitude!=null?(v(),m("div",c8,[l("span",null,w(f.value.latitude.toFixed(5))+", "+w(f.value.longitude.toFixed(5)),1),p.value?(v(),m("span",u8,"("+w(Math.round(p.value))+"m)",1)):P("",!0)])):g.value?(v(),m("div",d8,w(g.value),1)):P("",!0)])):P("",!0),u.value==="map"?(v(),m("div",h8,[d.value?(v(),m("div",f8,"Tap to select location")):P("",!0),d.value?(v(),Ye(ta,{key:1,locations:M.value,route:e.route,center:S.value,zoom:14,mode:"select-point","user-location":e.initialLocation,"highlight-location-id":a.value,height:"150px",onPointSelected:I},null,8,["locations","route","center","user-location","highlight-location-id"])):P("",!0),f.value&&f.value.latitude!=null?(v(),m("div",p8,[l("span",null,w(f.value.latitude.toFixed(5))+", "+w(f.value.longitude.toFixed(5)),1),d.value?P("",!0):(v(),m("button",{key:0,type:"button",class:"location-edit-btn",onClick:Q[9]||(Q[9]=de=>d.value=!0)},"Edit"))])):P("",!0)])):P("",!0)])]),b.value?(v(),m("div",v8,w(b.value),1)):P("",!0)],32)]),_:1},8,["show","is-dirty"]))}},Tv=je(y8,[["__scopeId","data-v-0896cfc4"]]),_8={class:"tab-content"},k8={key:0,class:"form-group"},b8={for:"marshalId"},w8=["value"],C8={class:"help-text"},L8={key:1,class:"form-group"},S8={class:"linked-marshal-info"},x8={class:"linked-marshal-name"},I8={class:"linked-marshal-hint"},$8={class:"form-group"},T8=["disabled"],M8={class:"form-group"},A8={class:"role-input-group"},E8={key:0,label:"Built-in Roles"},P8=["value"],D8={key:1,label:"Custom Roles"},O8=["value"],R8={class:"form-row"},B8={class:"form-group"},N8={class:"form-group"},F8={class:"form-group"},U8={class:"tab-content"},z8={class:"custom-footer"},H8={class:"footer-left"},V8=["disabled"],G8={__name:"EditContactModal",props:{show:{type:Boolean,default:!1},contact:{type:Object,default:null},initialTab:{type:String,default:"details"},areas:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},marshals:{type:Array,default:()=>[]},availableRoles:{type:Object,default:()=>({builtInRoles:[],customRoles:[]})},isDirty:{type:Boolean,default:!1},preselectedArea:{type:Object,default:null},prefilledName:{type:String,default:""},prefilledMarshalId:{type:String,default:null},createFromAreaContext:{type:Boolean,default:!1}},emits:["close","save","delete","update:isDirty"],setup(e,{emit:t}){const{terms:o}=bt(),i=e,s=t,a=T(!1),c=T(""),u=T("details"),d=T(!1),f=T({role:"",name:"",phone:"",email:"",notes:"",marshalId:null,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}),p=Z(()=>!!i.contact),g=Z(()=>i.createFromAreaContext?[{value:"details",label:"Details"}]:[{value:"details",label:"Details"},{value:"visibility",label:"Visibility"}]),k=Z(()=>!!f.value.marshalId),_=Z(()=>!p.value&&!!i.prefilledMarshalId),b=Z(()=>p.value&&!!i.contact?.marshalId),C=Z(()=>i.contact?.marshalId?i.marshals.find(q=>q.id===i.contact.marshalId)?.name||"Unknown":""),E=Z(()=>[...i.marshals].sort((O,q)=>Zs(O.name,q.name)));Ge(()=>i.show,O=>{if(O){if(u.value=i.initialTab,i.contact){const q=[...i.availableRoles.builtInRoles||[],...i.availableRoles.customRoles||[]];d.value=i.contact.role&&!q.includes(i.contact.role),f.value={role:i.contact.role||"",name:i.contact.name||"",phone:i.contact.phone||"",email:i.contact.email||"",notes:i.contact.notes||"",marshalId:i.contact.marshalId||null,scopeConfigurations:i.contact.scopeConfigurations?JSON.parse(JSON.stringify(i.contact.scopeConfigurations)):[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}]}}else{d.value=!1;let q;i.createFromAreaContext?q=[]:i.preselectedArea?q=[{scope:"EveryoneInAreas",itemType:"Area",ids:[i.preselectedArea.id]}]:q=[{scope:"SpecificPeople",itemType:"Marshal",ids:["ALL_MARSHALS"]}];let V={name:i.prefilledName||"",phone:"",email:""};if(i.prefilledMarshalId){const Q=i.marshals.find(de=>de.id===i.prefilledMarshalId);Q&&(V={name:Q.name||"",phone:Q.phoneNumber||"",email:Q.email||""})}f.value={role:"",name:V.name,phone:V.phone,email:V.email,notes:"",marshalId:i.prefilledMarshalId||null,scopeConfigurations:q}}s("update:isDirty",!1)}});const D=O=>O?O==="AreaLead"?`${o.value.area} Lead`:O.replace(/([A-Z])/g," $1").replace(/^./,q=>q.toUpperCase()).trim():"",M=()=>{s("update:isDirty",!0)},S=()=>{if(f.value.marshalId){const O=i.marshals.find(q=>q.id===f.value.marshalId);O&&(f.value.name=O.name,!f.value.phone&&O.phoneNumber&&(f.value.phone=O.phoneNumber),!f.value.email&&O.email&&(f.value.email=O.email))}M()},$=()=>{s("close")},A=()=>{if(!f.value.role||!f.value.role.trim()){U("Please select or enter a role");return}if(!f.value.name||!f.value.name.trim()){U("Please enter a contact name");return}u.value="visibility"},U=O=>{c.value=O,a.value=!0},I=()=>{if(!f.value.role||!f.value.role.trim()){U("Please select or enter a role");return}if(!f.value.name||!f.value.name.trim()){U("Please enter a contact name");return}if(!i.createFromAreaContext){if(!f.value.scopeConfigurations||f.value.scopeConfigurations.length===0){U("Please select at least one visibility scope");return}if(!f.value.scopeConfigurations.some(V=>!(V.itemType!==null&&(!V.ids||V.ids.length===0)))){U("Please configure at least one scope with valid selections");return}}const O={role:f.value.role.trim(),name:f.value.name.trim(),phone:f.value.phone?.trim()||null,email:f.value.email?.trim()||null,notes:f.value.notes?.trim()||null,marshalId:f.value.marshalId||null,scopeConfigurations:f.value.scopeConfigurations};s("save",O)},H=()=>{s("delete",i.contact.contactId)};return(O,q)=>(v(),m(Se,null,[Oe(zt,{show:e.show,title:p.value?"Edit contact":"Create contact",size:"large","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:$},{"tab-header":Ue(()=>[Oe(Ha,{modelValue:u.value,"onUpdate:modelValue":q[0]||(q[0]=V=>u.value=V),tabs:g.value},null,8,["modelValue","tabs"])]),footer:Ue(()=>[l("div",z8,[l("div",H8,[p.value?(v(),m("button",{key:0,type:"button",onClick:H,class:"btn btn-danger"}," Delete ")):P("",!0),!p.value&&u.value==="details"?(v(),m("button",{key:1,type:"button",onClick:A,class:"btn btn-secondary mobile-only"}," Visibility... ")):P("",!0)]),l("button",{type:"button",onClick:I,class:"btn btn-success",disabled:p.value&&!e.isDirty}," Save ",8,V8)])]),default:Ue(()=>[l("form",{onSubmit:ht(I,["prevent"]),class:"contact-form"},[He(l("div",_8,[!_.value&&!b.value?(v(),m("div",k8,[l("label",b8,"Link to "+w(j(o).person.toLowerCase())+":",1),He(l("select",{id:"marshalId","onUpdate:modelValue":q[1]||(q[1]=V=>f.value.marshalId=V),onChange:S},[q[11]||(q[11]=l("option",{value:null},"-- Not linked --",-1)),(v(!0),m(Se,null,Be(E.value,V=>(v(),m("option",{key:V.id,value:V.id},w(V.name),9,w8))),128))],544),[[Tn,f.value.marshalId]]),l("span",C8,"Optionally link to an existing "+w(j(o).person.toLowerCase())+" in the system",1)])):P("",!0),b.value?(v(),m("div",L8,[l("label",null,"Linked "+w(j(o).person.toLowerCase())+":",1),l("div",S8,[l("span",x8,w(C.value),1),l("span",I8,"Contact details are synced with this "+w(j(o).person.toLowerCase()),1)])])):P("",!0),l("div",$8,[q[12]||(q[12]=l("label",{for:"name"},"Name: *",-1)),He(l("input",{id:"name","onUpdate:modelValue":q[2]||(q[2]=V=>f.value.name=V),type:"text",onInput:M,disabled:k.value,class:pe({"input-disabled":k.value}),placeholder:"Contact name..."},null,42,T8),[[nt,f.value.name]])]),l("div",M8,[q[14]||(q[14]=l("label",{for:"role"},"Role: *",-1)),l("div",A8,[d.value?He((v(),m("input",{key:1,id:"customRole","onUpdate:modelValue":q[4]||(q[4]=V=>f.value.role=V),type:"text",onInput:M,placeholder:"Enter custom role name..."},null,544)),[[nt,f.value.role]]):He((v(),m("select",{key:0,id:"role","onUpdate:modelValue":q[3]||(q[3]=V=>f.value.role=V),onChange:M},[q[13]||(q[13]=l("option",{value:"",disabled:""},"Select a role...",-1)),e.availableRoles.builtInRoles?.length>0?(v(),m("optgroup",E8,[(v(!0),m(Se,null,Be(e.availableRoles.builtInRoles,V=>(v(),m("option",{key:V,value:V},w(D(V)),9,P8))),128))])):P("",!0),e.availableRoles.customRoles?.length>0?(v(),m("optgroup",D8,[(v(!0),m(Se,null,Be(e.availableRoles.customRoles,V=>(v(),m("option",{key:V,value:V},w(D(V)),9,O8))),128))])):P("",!0)],544)),[[Tn,f.value.role]]),l("button",{type:"button",class:"toggle-custom-btn",onClick:q[5]||(q[5]=V=>d.value=!d.value)},w(d.value?"Use existing":"Custom"),1)])]),l("div",R8,[l("div",B8,[q[15]||(q[15]=l("label",{for:"phone"},"Phone:",-1)),He(l("input",{id:"phone","onUpdate:modelValue":q[6]||(q[6]=V=>f.value.phone=V),type:"tel",onInput:M,placeholder:"Phone number..."},null,544),[[nt,f.value.phone]])]),l("div",N8,[q[16]||(q[16]=l("label",{for:"email"},"Email:",-1)),He(l("input",{id:"email","onUpdate:modelValue":q[7]||(q[7]=V=>f.value.email=V),type:"email",onInput:M,placeholder:"Email address..."},null,544),[[nt,f.value.email]])])]),l("div",F8,[q[17]||(q[17]=l("label",{for:"notes"},"Notes / Instructions:",-1)),He(l("textarea",{id:"notes","onUpdate:modelValue":q[8]||(q[8]=V=>f.value.notes=V),onInput:M,rows:"3",placeholder:"Additional notes or instructions for when to contact..."},null,544),[[nt,f.value.notes]])])],512),[[bi,u.value==="details"]]),He(l("div",U8,[Oe(ic,{modelValue:f.value.scopeConfigurations,"onUpdate:modelValue":q[9]||(q[9]=V=>f.value.scopeConfigurations=V),areas:e.areas,locations:e.locations,marshals:e.marshals,"is-editing":p.value,"exclude-scopes":["OnePerCheckpoint","OnePerArea","OneLeadPerArea"],"header-text":"Who can see this contact?",onUserChanged:M},null,8,["modelValue","areas","locations","marshals","is-editing"])],512),[[bi,u.value==="visibility"]])],32)]),_:1},8,["show","title","is-dirty"]),Oe(lc,{show:a.value,title:"Validation error",message:c.value,onClose:q[10]||(q[10]=V=>a.value=!1)},null,8,["show","message"])],64))}},Z8=je(G8,[["__scopeId","data-v-933c59e2"]]),j8={key:0,class:"fullscreen-map-overlay"},q8={class:"fullscreen-map-header"},W8={class:"context-info"},K8={key:0},Y8={class:"action-buttons"},J8=["disabled"],X8={class:"fullscreen-map-container"},Q8={key:0,class:"drawing-controls"},eO={class:"point-count"},tO={class:"undo-redo-buttons"},nO=["disabled"],oO=["disabled"],sO=Object.assign({inheritAttrs:!1},{__name:"FullscreenMapOverlay",props:{show:{type:Boolean,required:!0},mode:{type:String,validator:e=>["place-checkpoint","move-checkpoint","draw-area","add-multiple","view"].includes(e)},contextTitle:{type:String,default:""},contextDescription:{type:String,default:""},canComplete:{type:Boolean,default:!1},drawingMode:{type:Boolean,default:!1}},emits:["done","cancel","map-click","polygon-complete","polygon-drawing","location-click","area-click"],setup(e,{emit:t}){const o=e,i=t,s=T(null),a=T(0),c=T(!1),u=T(!1),d=()=>{i("done")},f=()=>{i("cancel")},p=C=>{a.value=C?.length||0,g(),i("polygon-drawing",C)},g=()=>{s.value&&(c.value=s.value.canUndo(),u.value=s.value.canRedo())},k=()=>{s.value&&(s.value.undoPolygonPoint(),g())},_=()=>{s.value&&(s.value.redoPolygonPoint(),g())};Ge(()=>o.show,C=>{C||(a.value=0,c.value=!1,u.value=!1)});const b=C=>{C.key==="Escape"&&o.show&&f(),o.show&&o.drawingMode&&((C.ctrlKey||C.metaKey)&&C.key==="z"&&!C.shiftKey?(C.preventDefault(),k()):(C.ctrlKey||C.metaKey)&&(C.key==="y"||C.key==="z"&&C.shiftKey)&&(C.preventDefault(),_()))};return Wt(()=>{document.addEventListener("keydown",b)}),zn(()=>{document.removeEventListener("keydown",b)}),(C,E)=>(v(),Ye(Tu,{to:"body"},[e.show?(v(),m("div",j8,[l("div",q8,[l("div",W8,[l("h3",null,w(e.contextTitle),1),e.contextDescription?(v(),m("p",K8,w(e.contextDescription),1)):P("",!0)]),l("div",Y8,[e.mode==="view"?(v(),m("button",{key:0,onClick:f,class:"btn btn-done"}," Close ")):(v(),m(Se,{key:1},[l("button",{onClick:f,class:"btn btn-cancel"}," Cancel "),l("button",{onClick:d,class:"btn btn-done",disabled:!e.canComplete}," Done ",8,J8)],64))])]),l("div",X8,[Oe(pu,mp({ref_key:"mapViewRef",ref:s,"drawing-mode":e.drawingMode},C.$attrs,{onMapClick:E[0]||(E[0]=D=>C.$emit("map-click",D)),onPolygonComplete:E[1]||(E[1]=D=>C.$emit("polygon-complete",D)),onPolygonDrawing:p,onLocationClick:E[2]||(E[2]=D=>C.$emit("location-click",D)),onAreaClick:E[3]||(E[3]=D=>C.$emit("area-click",D))}),null,16,["drawing-mode"]),e.drawingMode&&a.value>0?(v(),m("div",Q8,[l("div",eO,w(a.value)+" point"+w(a.value!==1?"s":""),1),l("div",tO,[l("button",{onClick:k,class:"btn-drawing undo-btn",disabled:!c.value,title:"Undo last point"},"  Undo ",8,nO),l("button",{onClick:_,class:"btn-drawing redo-btn",disabled:!u.value,title:"Redo point"}," Redo  ",8,oO)])])):P("",!0)])])):P("",!0)]))}}),iO=je(sO,[["__scopeId","data-v-9ce62b55"]]),aO={class:"form-group"},lO={class:"form-group"},rO={class:"form-group"},cO={key:0,class:"form-error"},uO={class:"form-row"},dO={class:"form-group",style:{flex:"1"}},hO={class:"form-group",style:{flex:"1"}},fO={class:"form-group",style:{flex:"0 0 auto"}},pO={class:"form-group"},vO={__name:"AddLocationModal",props:{show:{type:Boolean,default:!1},location:{type:Object,default:()=>({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""})},isDirty:{type:Boolean,default:!1}},emits:["close","save","set-on-map","update:isDirty","update:location"],setup(e,{emit:t}){const{termsLower:o}=bt(),i=e,s=t,a=T({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""});Ge(()=>i.location,f=>{f&&(a.value={...f})},{immediate:!0,deep:!0});const c=()=>{s("update:isDirty",!0),s("update:location",{...a.value})},u=()=>{if(!Mr(a.value.what3Words)&&a.value.what3Words){alert("Invalid What3Words format.");return}s("save",a.value)},d=()=>{s("close")};return(f,p)=>(v(),Ye(zt,{show:e.show,title:`Add ${j(o).checkpoint}`,size:"medium","confirm-on-close":!0,"is-dirty":e.isDirty,onClose:d},{actions:Ue(()=>[l("button",{type:"button",onClick:d,class:"btn btn-secondary"}," Cancel "),l("button",{type:"button",onClick:u,class:"btn btn-primary"}," Add "+w(j(o).checkpoint),1)]),default:Ue(()=>[l("form",{onSubmit:ht(u,["prevent"])},[l("div",aO,[p[7]||(p[7]=l("label",null,"Name",-1)),He(l("input",{"onUpdate:modelValue":p[0]||(p[0]=g=>a.value.name=g),type:"text",required:"",class:"form-input",onInput:c},null,544),[[nt,a.value.name]])]),l("div",lO,[p[8]||(p[8]=l("label",null,"Description",-1)),He(l("input",{"onUpdate:modelValue":p[1]||(p[1]=g=>a.value.description=g),type:"text",class:"form-input",onInput:c},null,544),[[nt,a.value.description]])]),l("div",rO,[p[9]||(p[9]=l("label",null,"What3Words (optional)",-1)),He(l("input",{"onUpdate:modelValue":p[2]||(p[2]=g=>a.value.what3Words=g),type:"text",class:"form-input",placeholder:"e.g. filled.count.soap or filled/count/soap",onInput:c},null,544),[[nt,a.value.what3Words]]),a.value.what3Words&&!j(Mr)(a.value.what3Words)?(v(),m("small",cO," Invalid format. Must be word.word.word or word/word/word (lowercase letters only, 1-20 characters each) ")):P("",!0)]),l("div",uO,[l("div",dO,[p[10]||(p[10]=l("label",null,"Longitude",-1)),He(l("input",{"onUpdate:modelValue":p[3]||(p[3]=g=>a.value.longitude=g),type:"number",step:"0.00001",required:"",class:"form-input",onInput:c},null,544),[[nt,a.value.longitude,void 0,{number:!0}]])]),l("div",hO,[p[11]||(p[11]=l("label",null,"Latitude",-1)),He(l("input",{"onUpdate:modelValue":p[4]||(p[4]=g=>a.value.latitude=g),type:"number",step:"0.00001",required:"",class:"form-input",onInput:c},null,544),[[nt,a.value.latitude,void 0,{number:!0}]])]),l("div",fO,[p[12]||(p[12]=l("label",null,"",-1)),l("button",{type:"button",class:"icon-btn",title:"Set location on map",onClick:p[5]||(p[5]=g=>f.$emit("set-on-map"))},"  ")])]),l("div",pO,[l("label",null,"Required "+w(j(o).people),1),He(l("input",{"onUpdate:modelValue":p[6]||(p[6]=g=>a.value.requiredMarshals=g),type:"number",min:"1",required:"",class:"form-input",onInput:c},null,544),[[nt,a.value.requiredMarshals,void 0,{number:!0}]])])],32)]),_:1},8,["show","title","is-dirty"]))}},mO=je(vO,[["__scopeId","data-v-fb51fed0"]]),gO={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"app-logo"},yO=["id"],_O=["filter"],kO={__name:"AppLogo",props:{size:{type:[Number,String],default:48},animate:{type:Boolean,default:!1}},setup(e){Qg(o=>({v1c2199cd:typeof e.size=="number"?e.size+"px":e.size}));const t=Z(()=>`discShadow-${Math.random().toString(36).substr(2,9)}`);return(o,i)=>(v(),m("svg",gO,[l("defs",null,[l("filter",{id:t.value,x:"-20%",y:"-20%",width:"140%",height:"140%"},[...i[0]||(i[0]=[l("feDropShadow",{dx:"0",dy:"6",stdDeviation:"8","flood-color":"#000","flood-opacity":"0.25"},null,-1)])],8,yO)]),l("ellipse",{cx:"256",cy:"400",rx:"220",ry:"70",fill:"#667eea",filter:`url(#${t.value})`},null,8,_O),i[2]||(i[2]=l("ellipse",{cx:"256",cy:"394",rx:"185",ry:"55",fill:"none",stroke:"rgba(255,255,255,0.3)","stroke-width":"4"},null,-1)),l("g",{class:pe({"marshal-figure":e.animate})},[...i[1]||(i[1]=[l("circle",{cx:"256",cy:"160",r:"55",fill:"currentColor"},null,-1),l("path",{d:"M365 380 v-30 a55 55 0 0 0-55-55 H202 a55 55 0 0 0-55 55 v30",fill:"currentColor"},null,-1)])],2)]))}},bO=je(kO,[["__scopeId","data-v-3e647831"]]),wO={class:"header"},CO={class:"header-left"},LO={key:0},SO={class:"event-date"},xO={class:"header-actions"},IO={class:"container"},$O={class:"tabs-nav"},TO={class:"tab-content-wrapper"},MO={class:"add-note-form"},AO={class:"modal-footer-actions"},EO=["disabled"],PO=6e4,DO={__name:"AdminEventManage",setup(e){const t=Qr(),o=Na(),i=hv(),s=Z(()=>t.params.eventId),{activeTab:a,switchTab:c}=fv("details",["details","course","areas","checkpoints","marshals","notes","checklists","contacts","settings"]),{showConfirmModal:u,confirmModalTitle:d,confirmModalMessage:f,confirmModalIsDanger:p,confirmModalConfirmText:g,showConfirm:k,handleConfirmModalConfirm:_,handleConfirmModalCancel:b}=T0(),{tabLabels:C,terms:E,termsLower:D}=bt(),M=M0(),S=E0(s),$=A0(s),{colorScheme:A}=Vu(),U=Z(()=>[{value:"details",label:"Event details",icon:"details"},{value:"course",label:C.value.course,icon:"course"},{value:"areas",label:C.value.areas,icon:"area"},{value:"checkpoints",label:C.value.checkpoints,icon:"checkpoint"},{value:"marshals",label:C.value.marshals,icon:"marshal"},{value:"notes",label:"Notes",icon:"notes"},{value:"incidents",label:"Incidents",icon:"incidents"},{value:"checklists",label:C.value.checklists,icon:"checklist"},{value:"contacts",label:"Contacts",icon:"contacts"},{value:"settings",label:"Settings",icon:"settings"}]),I=T(null),H=T([]),O=T([]),q=T({marshals:0,areas:0,checkpoints:0,checklists:0,notes:0,incidents:0,contacts:0}),V=T(null),Q=T(!1),de=T(!1),Ee=T(null),ge=T(!1),Pe=T(!1),Fe=T(null),ce=T(""),Me=$.eventAdmins,ke=$.showAddAdmin,re=S.showUploadRoute,Re=S.uploading,Je=S.uploadError,tt=S.showImportLocations,qe=S.showImportMarshals,Qe=S.importing,be=S.importingMarshals,ze=S.importError,fe=S.importResult,Le=S.importMarshalsResult,Ae=T(!1),W=T(!1),J=T({id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),ue=T(!1),ye=T(!1),ae=T({marshalName:"",locations:[],marshal:null}),ie=T(null),he=T([]),De=T(!1),Te=T(null),oe=T(null),ve=T(null),se=T({}),te=T({id:"",name:"",email:"",phoneNumber:"",notes:""}),X=T(!1),N=T([]),K=T([]),ee=T([]),$e=T([]),We=T(!1),ot=T(""),st=T(""),Ct=T({name:"",description:"",eventDate:"",timeZoneId:"UTC",peopleTerm:"Marshals",defaultCheckpointStyleBackgroundShape:"",defaultCheckpointStyleBackgroundColor:"",defaultCheckpointStyleBorderColor:"",defaultCheckpointStyleIconColor:"",defaultCheckpointStyleSize:"",defaultCheckpointStyleMapRotation:"",checkpointTerm:"Checkpoints",areaTerm:"Areas",checklistTerm:"Checklists",courseTerm:"Course",defaultCheckpointStyleType:"default",defaultCheckpointStyleColor:""}),St=T(!1),At=T(!1),Kt=T(""),an=T(""),Hn=T(0),An=T({name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""}),Et=T([]),gt=T(null),tn=T(!1),vn=T("details"),to=T(null),En=T(null),Yt=T(null),Yo=M.isAddingMultipleCheckpoints,ln=M.multiCheckpointCounter,no=M.isFullscreenMapActive,Nt=M.fullscreenMode,Vn=M.fullscreenContext,rn=M.tempLocationCoords,To=M.tempCheckpoints,Vt=M.savedMapCenter,et=M.savedMapZoom,Mo=M.isDrawingAreaBoundary,ho=T(null),ys=T([]),fo=T(null),Jo=T(!1),Xo=T("details"),Ot=T(null),po=T([]),Gn=T(null),bn=T(!1),wn=T("details"),Zn=T([]),mn=T(!1),gn=T(null),oo=T(!1),Ao=T(!1),Qo=T(!1),Eo=T(""),Po=T(!1),jn=T([]),Do=T({builtInRoles:[],customRoles:[]}),Mt=T(null),vo=T(!1),so=T("details"),Pn=T(null),mt=T(""),xt=T(null),_s=T(null),es=Z(()=>_s.value?.marshalId!=null),ts=()=>{o.push(`/event/${t.params.eventId}`)},mo=Z(()=>`${window.location.origin}/#/event/${t.params.eventId}`),dt=Z(()=>{const z=[];return O.value.forEach(le=>{le.assignments&&z.push(...le.assignments)}),z}),It=Z(()=>{if(!Te.value)return O.value;const z=Te.value.assignedLocationIds||[],le=ee.value.map(Ie=>Ie.locationId),me=$e.value;return O.value.filter(Ie=>!z.includes(Ie.id)&&!le.includes(Ie.id)||me.includes(Ie.id))}),Ws=Z(()=>{let z=he.value;if(V.value){const le=V.value.assignments.map(Ie=>Ie.marshalName),me=N.value.map(Ie=>Ie.marshalName);z=he.value.filter(Ie=>!le.includes(Ie.name)&&!me.includes(Ie.name))}return z.slice().sort((le,me)=>le.name.localeCompare(me.name))}),Ks=Z(()=>Nt.value==="draw-area"&&gt.value?.polygon?.length>0||M.canCompleteFullscreen.value),on=Z(()=>{const z=[...O.value];return Nt.value==="place-checkpoint"&&rn.value&&z.push({id:"temp-single",name:An.value.name||"New Checkpoint",latitude:rn.value.lat,longitude:rn.value.lng,requiredMarshals:An.value.requiredMarshals||1,assignments:[],isTemporary:!0}),Nt.value==="move-checkpoint"&&rn.value&&V.value&&z.push({id:"temp-move",name:V.value.name+" (new position)",latitude:rn.value.lat,longitude:rn.value.lng,requiredMarshals:V.value.requiredMarshals,assignments:[],isTemporary:!0}),Nt.value==="add-multiple"&&z.push(...To.value),z}),Va=Z(()=>{let z=[...Et.value];return Nt.value==="draw-area"&&gt.value?.id&&(z=z.filter(le=>le.id!==gt.value.id)),Nt.value==="draw-area"&&gt.value?.polygon?.length>0&&z.push({...gt.value,id:gt.value.id||"temp-area"}),z}),Ys=Z(()=>{if(!Te.value||!Zn.value.length)return[];const z=Te.value.id,le=Te.value.assignedLocationIds||[];return Zn.value.filter(me=>{if(me.reportedBy?.marshalId===z)return!0;const Ie=me.context?.checkpoint?.checkpointId;return!!(Ie&&le.includes(Ie))}).sort((me,Ie)=>new Date(Ie.incidentTime||Ie.createdAt)-new Date(me.incidentTime||me.createdAt))}),go=Z(()=>{if(!V.value||!Zn.value.length)return[];const z=V.value.id;return Zn.value.filter(le=>le.context?.checkpoint?.checkpointId===z).sort((le,me)=>new Date(me.incidentTime||me.createdAt)-new Date(le.incidentTime||le.createdAt))}),Ht=Z(()=>{if(!gt.value||!Zn.value.length)return[];const z=gt.value.id,le=O.value.filter(me=>me.areaIds&&me.areaIds.includes(z)).map(me=>me.id);return Zn.value.filter(me=>{const Ie=me.context?.checkpoint?.checkpointId;return Ie&&le.includes(Ie)}).sort((me,Ie)=>new Date(Ie.incidentTime||Ie.createdAt)-new Date(me.incidentTime||me.createdAt))}),io=z=>{gn.value=z,oo.value=!0},ks=z=>{gn.value=z,oo.value=!0},bs=z=>{gn.value=z,oo.value=!0},Li=()=>{o.push("/admin/dashboard")},Rt=(z=!0)=>{X.value=z},Js=()=>{St.value=!0},Xs=async z=>{try{z&&(Ct.value={...z});const le=Ol(I.value.eventDate),me=Ct.value.eventDate;if(le!==me){const Ie=H.value.filter(lt=>lt.startTime||lt.endTime);if(Ie.length>0){Kt.value=le,an.value=me,Hn.value=Ie.length,At.value=!0;return}}await yo(!1,null)}catch(le){console.error("Failed to update event:",le),alert("Failed to update event. Please try again.")}},yo=async(z,le)=>{try{if(await i.updateEvent(t.params.eventId,{...Ct.value,defaultCheckpointStyleMapRotation:Ct.value.defaultCheckpointStyleMapRotation!=null?String(Ct.value.defaultCheckpointStyleMapRotation):null}),z&&le!==null){const me=Math.floor(Math.abs(le)/1e3),Ie=le<0,lt=Math.floor(me/3600),kt=Math.floor(me%3600/60),Qt=me%60,Co=`${Ie?"-":""}${lt.toString().padStart(2,"0")}:${kt.toString().padStart(2,"0")}:${Qt.toString().padStart(2,"0")}`;await i.bulkUpdateLocationTimes(t.params.eventId,Co)}await cn(),St.value=!1}catch(me){console.error("Failed to update event:",me),alert("Failed to update event. Please try again.")}},Si=async({shouldShift:z,timeDelta:le})=>{At.value=!1,await yo(z,le)},Qs=()=>{At.value=!1,cn()},cn=async()=>{try{await i.fetchEvent(t.params.eventId),I.value=i.currentEvent,I.value&&(Ct.value={name:I.value.name||"",description:I.value.description||"",eventDate:Ol(I.value.eventDate),timeZoneId:I.value.timeZoneId||"UTC",peopleTerm:I.value.peopleTerm||"Marshals",checkpointTerm:I.value.checkpointTerm||"Checkpoints",areaTerm:I.value.areaTerm||"Areas",checklistTerm:I.value.checklistTerm||"Checklists",courseTerm:I.value.courseTerm||"Course",defaultCheckpointStyleType:I.value.defaultCheckpointStyleType||"default",defaultCheckpointStyleColor:I.value.defaultCheckpointStyleColor||"",defaultCheckpointStyleBackgroundShape:I.value.defaultCheckpointStyleBackgroundShape||"",defaultCheckpointStyleBackgroundColor:I.value.defaultCheckpointStyleBackgroundColor||"",defaultCheckpointStyleBorderColor:I.value.defaultCheckpointStyleBorderColor||"",defaultCheckpointStyleIconColor:I.value.defaultCheckpointStyleIconColor||"",defaultCheckpointStyleSize:I.value.defaultCheckpointStyleSize||"",defaultCheckpointStyleMapRotation:I.value.defaultCheckpointStyleMapRotation??"",brandingHeaderGradientStart:I.value.brandingHeaderGradientStart||"",brandingHeaderGradientEnd:I.value.brandingHeaderGradientEnd||"",brandingLogoUrl:I.value.brandingLogoUrl||"",brandingLogoPosition:I.value.brandingLogoPosition||"",brandingAccentColor:I.value.brandingAccentColor||"",brandingPageGradientStart:I.value.brandingPageGradientStart||"",brandingPageGradientEnd:I.value.brandingPageGradientEnd||""},St.value=!1,du(I.value));const z=await Promise.allSettled([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId),Mi(),Oo(),qn(),ws(),at(),Jt(),_t()]);H.value=i.locations,O.value=i.eventStatus.locations,z.forEach((le,me)=>{le.status==="rejected"&&console.error(`Failed to load ${["locations","eventStatus","admins","marshals","areas","checklists","notes","contacts"][me]}:`,le.reason)})}catch(z){console.error("Failed to load event data:",z)}},Oo=async()=>{try{const z=await ms.getByEvent(t.params.eventId);he.value=z.data,q.value.marshals=Date.now()}catch(z){console.error("Failed to load marshals:",z)}},qn=async()=>{try{const z=await mi.getByEvent(t.params.eventId);Et.value=z.data,q.value.areas=Date.now()}catch(z){console.error("Failed to load areas:",z)}},ws=async()=>{try{const[z,le]=await Promise.all([Pt.getByEvent(t.params.eventId),Pt.getReport(t.params.eventId)]);ys.value=z.data,Ot.value=le.data,q.value.checklists=Date.now()}catch(z){console.error("Failed to load checklists:",z)}},at=async()=>{try{const z=await Ds.getByEvent(t.params.eventId);po.value=z.data,q.value.notes=Date.now()}catch(z){console.error("Failed to load notes:",z)}},Jt=async()=>{mn.value=!0;try{const z=await ps.getAll(t.params.eventId);Zn.value=z.data.incidents||[],q.value.incidents=Date.now()}catch(z){console.error("Failed to load incidents:",z)}finally{mn.value=!1}},_t=async()=>{try{const[z,le]=await Promise.all([di.getByEvent(t.params.eventId),di.getRoles(t.params.eventId)]);jn.value=z.data,Do.value=le.data,q.value.contacts=Date.now()}catch(z){console.error("Failed to load contacts:",z)}},ei=async()=>{await Promise.all([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId)]),H.value=i.locations,q.value.checkpoints=Date.now(),O.value=i.eventStatus.locations},Cs=async()=>{await Promise.all([Oo(),i.fetchEventStatus(t.params.eventId)]),O.value=i.eventStatus.locations},ti=async()=>{await Promise.all([i.fetchLocations(t.params.eventId),i.fetchEventStatus(t.params.eventId),qn()]),H.value=i.locations,O.value=i.eventStatus.locations},xi=async()=>{await i.fetchEventStatus(t.params.eventId),O.value=i.eventStatus.locations},_o=()=>{gt.value=null,vn.value="details",X.value=!1,tn.value=!0},Ls=z=>{gt.value=z,En.value=z.id,vn.value="details",X.value=!1,tn.value=!0},ko=async z=>{try{let le;if(gt.value&&gt.value.id){if(le=gt.value.id,await mi.update(t.params.eventId,le,z),z.checklistChanges&&z.checklistChanges.length>0)for(const me of z.checklistChanges)try{me.complete?await Pt.complete(t.params.eventId,me.itemId,{marshalId:me.marshalId,contextType:me.contextType,contextId:me.contextId}):await Pt.uncomplete(t.params.eventId,me.itemId,{marshalId:me.marshalId,contextType:me.contextType,contextId:me.contextId})}catch(Ie){console.error("Failed to update checklist item:",me,Ie)}}else le=(await mi.create({eventId:t.params.eventId,...z})).data.id;if(z.pendingContacts&&z.pendingContacts.length>0&&le)for(const me of z.pendingContacts)try{const Ie=me.scopeConfigurations?JSON.parse(JSON.stringify(me.scopeConfigurations)):[],lt=Ie.find(kt=>kt.scope==="EveryoneInAreas"&&kt.itemType==="Area");lt?(lt.ids||(lt.ids=[]),lt.ids.includes(le)||lt.ids.push(le)):Ie.push({scope:"EveryoneInAreas",itemType:"Area",ids:[le]}),await di.update(t.params.eventId,me.contactId,{...me,scopeConfigurations:Ie})}catch(Ie){console.error("Failed to add area to contact:",me,Ie)}if(z.contactsToRemove&&z.contactsToRemove.length>0&&le)for(const me of z.contactsToRemove)try{const Ie=jn.value.find(Qt=>Qt.contactId===me);if(!Ie)continue;const lt=Ie.scopeConfigurations?JSON.parse(JSON.stringify(Ie.scopeConfigurations)):[],kt=lt.find(Qt=>Qt.scope==="EveryoneInAreas"&&Qt.itemType==="Area");if(kt&&kt.ids){kt.ids=kt.ids.filter(Co=>Co!==le);const Qt=kt.ids.length>0?lt:lt.filter(Co=>!(Co.scope==="EveryoneInAreas"&&Co.itemType==="Area"));await di.update(t.params.eventId,me,{...Ie,scopeConfigurations:Qt})}}catch(Ie){console.error("Failed to remove area from contact:",me,Ie)}(z.pendingContacts&&z.pendingContacts.length>0||z.contactsToRemove&&z.contactsToRemove.length>0)&&await _t(),await qn(),await cn(),ao()}catch(le){console.error("Failed to save area:",le),alert(le.response?.data?.message||"Failed to save area. Please try again.")}},Xt=async z=>{k(`Delete ${D.value.area}`,`Are you sure you want to delete this ${D.value.area}? ${E.value.checkpoints} will be automatically reassigned.`,async()=>{try{await mi.delete(t.params.eventId,z),await mi.recalculate(t.params.eventId),await qn(),await cn(),ao()}catch(le){console.error(`Failed to delete ${D.value.area}:`,le),alert(le.response?.data?.message||`Failed to delete ${D.value.area}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},ao=()=>{tn.value=!1,gt.value=null,En.value=null,X.value=!1,Mo.value=!1,Yt.value=null},na=({marshal:z,area:le})=>{Mt.value=null,so.value="details",X.value=!1,Pn.value=le,mt.value="",xt.value=z.id,vo.value=!0},oa=({name:z,area:le})=>{Mt.value=null,so.value="details",X.value=!1,Pn.value=le,mt.value=z,xt.value=null,vo.value=!0},Ga=z=>{Mt.value=z,so.value="details",X.value=!1,vo.value=!0},ni=()=>{fo.value=null,Xo.value="details",X.value=!1,Jo.value=!0},Ii=(z,le="details")=>{fo.value=z,Xo.value=le,X.value=!1,Jo.value=!0},sa=async z=>{try{if(fo.value&&fo.value.itemId)await Pt.update(t.params.eventId,fo.value.itemId,z);else{const le=await Pt.create(t.params.eventId,z);le.data.count&&le.data.count>1&&(ot.value="Checklist Items Created",st.value=`Successfully created ${le.data.count} checklist items.`,We.value=!0)}await ws(),ct()}catch(le){console.error("Failed to save checklist item:",le);const me=le.response?.data?.message||"Failed to save checklist item. Please try again.";alert(me)}},ns=async z=>{k(`Delete ${D.value.checklist}`,`Are you sure you want to delete this ${D.value.checklist}?`,async()=>{try{await Pt.delete(t.params.eventId,z),await ws(),ct()}catch(le){console.error(`Failed to delete ${D.value.checklist}:`,le),alert(le.response?.data?.message||`Failed to delete ${D.value.checklist}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},ct=()=>{Jo.value=!1,fo.value=null,X.value=!1},Za=()=>{Gn.value=null,wn.value="details",X.value=!1,bn.value=!0},Cn=z=>{Gn.value=z,wn.value="details",X.value=!1,bn.value=!0},os=async z=>{try{Gn.value&&Gn.value.noteId?await Ds.update(t.params.eventId,Gn.value.noteId,z):await Ds.create(t.params.eventId,z),await at(),si()}catch(le){console.error("Failed to save note:",le);const me=le.response?.data?.message||"Failed to save note. Please try again.";alert(me)}},oi=async z=>{k("Delete note","Are you sure you want to delete this note?",async()=>{try{await Ds.delete(t.params.eventId,z),await at(),si()}catch(le){console.error("Failed to delete note:",le),alert(le.response?.data?.message||"Failed to delete note. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},si=()=>{bn.value=!1,Gn.value=null,X.value=!1},$i=()=>{Ao.value=!0},ja=async z=>{try{await ps.create(t.params.eventId,z),Ao.value=!1,await Jt()}catch(le){console.error("Failed to report incident:",le),alert(le.response?.data?.message||"Failed to report incident. Please try again.")}},Ss=z=>{gn.value=z,oo.value=!0},ia=()=>{oo.value=!1,gn.value=null},qa=async({incidentId:z,status:le})=>{try{if(await ps.updateStatus(t.params.eventId,z,{status:le}),await Jt(),gn.value?.incidentId===z){const me=Zn.value.find(Ie=>Ie.incidentId===z);me&&(gn.value=me)}}catch(me){console.error("Failed to update incident status:",me),alert(me.response?.data?.message||"Failed to update status. Please try again.")}},ss=()=>{Eo.value="",Qo.value=!0},ii=()=>{Qo.value=!1,Eo.value=""},Wn=async()=>{if(!(!Eo.value.trim()||!gn.value)){Po.value=!0;try{await ps.addNote(t.params.eventId,gn.value.incidentId,Eo.value.trim()),ii(),await Jt();const z=Zn.value.find(le=>le.incidentId===gn.value.incidentId);z&&(gn.value=z)}catch(z){console.error("Failed to add note to incident:",z),alert(z.response?.data?.message||"Failed to add note. Please try again.")}finally{Po.value=!1}}},Wa=()=>{Mt.value=null,so.value="details",Pn.value=null,X.value=!1,vo.value=!0},aa=z=>{Mt.value=z,so.value="details",X.value=!1,vo.value=!0},bo=async z=>{try{let le=null;const me=!Mt.value||!Mt.value.contactId,Ie=!!Pn.value;if(Mt.value&&Mt.value.contactId)await di.update(t.params.eventId,Mt.value.contactId,z);else{const lt=await di.create(t.params.eventId,z);le=lt.data?.contactId||lt.data?.id}if(await _t(),me&&Ie&&le&&to.value){const lt=jn.value.find(kt=>kt.contactId===le);lt&&to.value.addPendingContact(lt)}Ro()}catch(le){console.error("Failed to save contact:",le);const me=le.response?.data?.message||"Failed to save contact. Please try again.";alert(me)}},Ti=async z=>{k("Delete contact","Are you sure you want to delete this contact?",async()=>{try{await di.delete(t.params.eventId,z),await _t(),to.value&&to.value.removeContactById(z),Ro()}catch(le){console.error("Failed to delete contact:",le),alert(le.response?.data?.message||"Failed to delete contact. Please try again.")}},{isDanger:!0,confirmText:"Delete"})},Ro=()=>{vo.value=!1,Mt.value=null,Pn.value=null,mt.value="",xt.value=null,X.value=!1},is=z=>{const le={...z,polygon:[]};if(Yt.value=le,gt.value=le,tn.value=!1,Ee.value){const me=Ee.value.getMapCenter(),Ie=Ee.value.getMapZoom();me&&Ie!==null&&(Vt.value=me,et.value=Ie)}no.value=!0,Nt.value="draw-area",Mo.value=!0,Vn.value={title:"Draw area boundary",description:"Click to add points. Click Done when finished to complete the area."}},la=z=>{Yt.value?gt.value={...gt.value||{},...Yt.value,polygon:z}:gt.value={...gt.value,polygon:z}},ra=z=>{M.handlePolygonDrawing(z)},ca=()=>{Mo.value=!1,Yt.value&&(gt.value=Yt.value,tn.value=!0,Yt.value=null)},Mi=()=>$.loadEventAdmins(),Ka=async z=>{try{await $.addAdmin(z),await Mi(),as()}catch(le){console.error("Failed to add admin:",le),alert(le.response?.data?.message||"Failed to add administrator. Please try again.")}},Ai=async z=>{k("Remove administrator",`Remove ${z} as an administrator?`,async()=>{try{await $.removeAdmin(z),await Mi()}catch(le){console.error("Failed to remove admin:",le),alert(le.response?.data?.message||"Failed to remove administrator. Please try again.")}},{isDanger:!0,confirmText:"Remove"})},as=()=>{$.closeAddAdminModal(),X.value=!1},Ei=async z=>{await S.uploadRoute(z)&&(await ei(),Pi())},Pi=()=>{S.closeUploadRouteModal()},B=async({file:z,deleteExisting:le})=>{const me=await S.importLocations(z,le);if(me){await ti(),R();const Ie=S.formatImportResultMessage(me,"location");ot.value="Import Complete",st.value=Ie,We.value=!0}},R=()=>{S.closeImportLocationsModal()},G=async z=>{if(de.value)An.value.latitude=z.lat,An.value.longitude=z.lng;else if(W.value)J.value.latitude=z.lat,J.value.longitude=z.lng,V.value&&(V.value={...V.value,latitude:z.lat,longitude:z.lng}),W.value=!1,Ae.value=!0,Rt();else if(Yo.value)try{await i.createLocation({eventId:t.params.eventId,name:`Checkpoint ${ln.value}`,description:"",latitude:z.lat,longitude:z.lng,requiredMarshals:1,what3Words:""}),ln.value++,await cn()}catch(le){console.error("Failed to create checkpoint:",le),alert("Failed to create checkpoint. Please try again.")}},Y=z=>{M.handleFullscreenMapClick(z)},xe=z=>{An.value={...z}},Ze=()=>{de.value=!1,M.enterPlaceCheckpointMode()},vt=()=>{M.saveMapState(Ee.value),An.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},M.enterPlaceCheckpointMode()},Lt=()=>{M.saveMapState(Ee.value),no.value=!0,Nt.value="view",Vn.value={title:"Course map",description:""}},un=()=>{M.saveMapState(Ee.value),gt.value={id:null,name:"",description:"",color:"#667eea",polygon:[],checkpointIds:[],marshalIds:[],displayOrder:Et.value.length},M.enterDrawAreaMode()},ls=()=>{V.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},J.value={id:null,name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},N.value=[],K.value=[],X.value=!1,Ae.value=!0},Ft=()=>{const z=M.calculateStartingNumber(O);M.saveMapState(Ee.value),M.enterAddMultipleMode(z)},lo=()=>{if(Nt.value==="place-checkpoint"){const z=M.getPlacedCoords()||{lat:0,lng:0};V.value={id:null,name:"",description:"",latitude:z.lat,longitude:z.lng,requiredMarshals:1,what3Words:"",areaIds:[],assignments:[]},J.value={id:null,name:"",description:"",latitude:z.lat,longitude:z.lng,requiredMarshals:1,what3Words:""},N.value=[],K.value=[],X.value=!1,Ln(),Ae.value=!0}else if(Nt.value==="move-checkpoint"){const z=M.getPlacedCoords();z&&(J.value.latitude=z.lat,J.value.longitude=z.lng,V.value&&(V.value={...V.value,...ho.value||{},latitude:z.lat,longitude:z.lng}),Rt()),ho.value=null,Ln(),Ae.value=!0}else if(Nt.value==="draw-area"){const z=M.getCompletedPolygon();z&&(Yt.value?gt.value={...gt.value||{},...Yt.value,polygon:z}:gt.value={...gt.value||{},polygon:z}),Ln(),vn.value="boundary",tn.value=!0,Yt.value=null}else Nt.value==="add-multiple"&&jl()},jl=async()=>{const z=M.getTempCheckpoints();try{for(const le of z)await i.createLocation({eventId:t.params.eventId,name:le.name,description:le.description,latitude:le.latitude,longitude:le.longitude,requiredMarshals:le.requiredMarshals,what3Words:le.what3Words});M.clearTempCheckpoints(),Ln(),await cn()}catch(le){console.error("Failed to create checkpoints:",le),alert("Failed to create checkpoints. Please try again.")}},rc=()=>{Nt.value==="draw-area"?Yt.value&&(gt.value=Yt.value,tn.value=!0,Yt.value=null):Nt.value==="move-checkpoint"&&(ho.value&&V.value&&Object.assign(V.value,ho.value),Ae.value=!0,W.value=!1),M.cancelFullscreen()},Ln=()=>{M.exitFullscreen()},ai=z=>{ua(z)},ua=z=>{V.value=z,J.value={id:z.id,name:z.name,description:z.description||"",latitude:z.latitude,longitude:z.longitude,requiredMarshals:z.requiredMarshals,what3Words:z.what3Words||""},N.value=[],K.value=[],X.value=!1,Ae.value=!0,setTimeout(()=>{Ee.value?.scrollMapIntoView()},100)},Bo=async z=>{if(!Mr(z.what3Words)){alert("Invalid What3Words format. Please use word.word.word or word/word/word (lowercase letters only, 1-20 characters each)");return}try{await i.createLocation({eventId:t.params.eventId,...z}),await cn(),ql()}catch(le){console.error("Failed to save location:",le),alert("Failed to save location. Please try again.")}},ql=()=>{de.value=!1,An.value={name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},X.value=!1,X.value=!1},rs=()=>{Ae.value=!1,V.value=null,Q.value=!1,W.value=!1,ue.value=!1,ho.value=null,J.value={id:"",name:"",description:"",latitude:0,longitude:0,requiredMarshals:1,what3Words:""},N.value=[],K.value=[],X.value=!1},Ya=()=>{ue.value=!1},Di=()=>{ue.value=!0},Wl=z=>{if(z?.formData&&(ho.value=z.formData),Ae.value=!1,rn.value=null,Ee.value){const me=Ee.value.getMapCenter(),Ie=Ee.value.getMapZoom();me&&Ie!==null&&(Vt.value=me,et.value=Ie)}const le=ho.value?.name||V.value?.name;no.value=!0,Nt.value="move-checkpoint",Vn.value={title:`Move ${D.value.checkpoint}: ${le}`,description:"Click on the map to set the new location"}},da=async z=>{if(!Mr(z.what3Words)){alert("Invalid What3Words format.");return}try{const le=!V.value.id;if(le){const me=await i.createLocation({eventId:t.params.eventId,name:z.name,description:z.description,latitude:z.latitude,longitude:z.longitude,requiredMarshals:z.requiredMarshals,what3Words:z.what3Words||null,startTime:z.startTime,endTime:z.endTime,styleType:z.styleType,styleColor:z.styleColor,styleBackgroundShape:z.styleBackgroundShape,styleBackgroundColor:z.styleBackgroundColor,styleBorderColor:z.styleBorderColor,styleIconColor:z.styleIconColor,styleSize:z.styleSize,styleMapRotation:z.styleMapRotation!=null?String(z.styleMapRotation):null,peopleTerm:z.peopleTerm,checkpointTerm:z.checkpointTerm,isDynamic:z.isDynamic||!1,locationUpdateScopeConfigurations:z.locationUpdateScopeConfigurations||[],pendingNewChecklistItems:z.pendingNewChecklistItems||[],pendingNewNotes:z.pendingNewNotes||[]});if(z.pendingAssignments&&z.pendingAssignments.length>0)for(const Ie of z.pendingAssignments)await i.createAssignment({eventId:t.params.eventId,locationId:me.id,marshalId:Ie.marshalId})}else{const me=V.value.id;if(await Xn.update(t.params.eventId,me,{eventId:t.params.eventId,name:z.name,description:z.description,latitude:z.latitude,longitude:z.longitude,requiredMarshals:z.requiredMarshals,what3Words:z.what3Words||null,startTime:z.startTime,endTime:z.endTime,styleType:z.styleType,styleColor:z.styleColor,styleBackgroundShape:z.styleBackgroundShape,styleBackgroundColor:z.styleBackgroundColor,styleBorderColor:z.styleBorderColor,styleIconColor:z.styleIconColor,styleSize:z.styleSize,styleMapRotation:z.styleMapRotation!=null?String(z.styleMapRotation):null,peopleTerm:z.peopleTerm,checkpointTerm:z.checkpointTerm,isDynamic:z.isDynamic||!1,locationUpdateScopeConfigurations:z.locationUpdateScopeConfigurations||[]}),z.pendingNewChecklistItems&&z.pendingNewChecklistItems.length>0)for(const Ie of z.pendingNewChecklistItems)Ie.text?.trim()&&await Pt.create(t.params.eventId,{text:Ie.text,scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[me]}],displayOrder:0,isRequired:!1});if(z.pendingNewNotes&&z.pendingNewNotes.length>0)for(const Ie of z.pendingNewNotes)!Ie.title?.trim()&&!Ie.content?.trim()||await Ds.create(t.params.eventId,{title:Ie.title||"Untitled",content:Ie.content||"",scopeConfigurations:[{scope:"EveryoneAtCheckpoints",itemType:"Checkpoint",ids:[me]}],displayOrder:0,priority:"Normal",isPinned:!1});for(const Ie of K.value)await i.deleteAssignment(t.params.eventId,Ie);for(const Ie of N.value)await i.createAssignment({eventId:t.params.eventId,locationId:V.value.id,marshalId:Ie.marshalId});if(z.checkInChanges&&z.checkInChanges.length>0)for(const Ie of z.checkInChanges){const lt=V.value.assignments.find(kt=>kt.id===Ie.assignmentId);lt&&lt.isCheckedIn!==Ie.shouldBeCheckedIn&&await gs.adminCheckIn(t.params.eventId,Ie.assignmentId)}}if(!le&&z.checklistChanges&&z.checklistChanges.length>0)for(const me of z.checklistChanges)try{me.complete?await Pt.complete(t.params.eventId,me.itemId,{marshalId:me.marshalId,contextType:me.contextType,contextId:me.contextId}):await Pt.uncomplete(t.params.eventId,me.itemId,{marshalId:me.marshalId,contextType:me.contextType,contextId:me.contextId})}catch(Ie){console.error("Failed to update checklist item:",me,Ie)}await cn(),rs()}catch(le){console.error("Failed to update location:",le),alert("Failed to update location. Please try again.")}},cc=async z=>{k(`Delete ${D.value.checkpoint}`,`Are you sure you want to delete this ${D.value.checkpoint}?`,async()=>{try{await Xn.delete(t.params.eventId,z),await ti(),rs()}catch(le){console.error(`Failed to delete ${D.value.checkpoint}:`,le),alert(`Failed to delete ${D.value.checkpoint}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},cs=z=>{const le=z?.id??z;if(le?.toString().startsWith("temp-")){const me=V.value.assignments.find(Ie=>Ie.id===le);me&&(N.value=N.value.filter(Ie=>Ie.marshalId!==me.marshalId)),V.value.assignments=V.value.assignments.filter(Ie=>Ie.id!==le),Rt()}else K.value.includes(le)||(K.value.push(le),V.value.assignments=V.value.assignments.filter(me=>me.id!==le),Rt())},ha=async z=>{const le=he.value.find(Ie=>Ie.id===z);if(!le)return;const me=O.value.filter(Ie=>Ie.assignments?.some(lt=>lt.marshalId===z&&Ie.id!==V.value.id));if(me.length>0){ae.value={marshalName:le.name,locations:me.map(lt=>lt.name),marshal:le};const Ie=await new Promise(lt=>{ie.value=lt,ye.value=!0});if(Ie==="cancel"||Ie==="choose-other")return;if(Ie==="move")for(const lt of me){const kt=lt.assignments.find(Qt=>Qt.marshalId===z);if(kt){K.value.push(kt.id);const Qt=O.value.findIndex(Co=>Co.id===lt.id);Qt!==-1&&(O.value[Qt].assignments=O.value[Qt].assignments.filter(Co=>Co.id!==kt.id))}}}N.value.push({marshalId:le.id,marshalName:le.name}),V.value.assignments||(V.value.assignments=[]),V.value.assignments.push({id:`temp-${Date.now()}`,marshalId:le.id,marshalName:le.name,locationId:V.value.id,isCheckedIn:!1,isPending:!0}),Rt(),Ya()},uc=async z=>{try{const me=(await ms.create({eventId:t.params.eventId,name:z.name,email:z.email,phoneNumber:z.phoneNumber})).data;await Oo(),N.value.push({marshalId:me.id,marshalName:me.name}),V.value&&(V.value.assignments||(V.value.assignments=[]),V.value.assignments.push({id:`temp-${Date.now()}`,marshalId:me.id,marshalName:me.name,locationId:V.value.id,isCheckedIn:!1,isPending:!0})),Rt(),Ya()}catch(le){console.error("Failed to create marshal:",le),alert("Failed to create marshal. Please try again.")}},Ja=()=>{Te.value=null,se.value={},te.value={id:"",name:"",email:"",phoneNumber:"",notes:""},ee.value=[],$e.value=[],X.value=!1,De.value=!0},dc=z=>{Te.value=z,se.value={},te.value={id:z.id,name:z.name,email:z.email||"",phoneNumber:z.phoneNumber||"",notes:z.notes||""},ee.value=[],$e.value=[],X.value=!1,De.value=!0},wo=()=>{if(!Te.value)return[];const z=[];return O.value.forEach(le=>{le.assignments.filter(Ie=>Ie.marshalName===Te.value.name).forEach(Ie=>{z.push({...Ie,locationName:le.name,locationDescription:le.description||""})})}),z},hc=async z=>{try{let le=Te.value?.id,me=!1;if(Te.value){if(await ms.update(t.params.eventId,Te.value.id,{name:z.name,email:z.email,phoneNumber:z.phoneNumber,notes:z.notes}),z.pendingNewChecklistItems&&z.pendingNewChecklistItems.length>0)for(const Ie of z.pendingNewChecklistItems)Ie.text?.trim()&&await Pt.create(t.params.eventId,{text:Ie.text,scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[le]}],displayOrder:0,isRequired:!1});if(z.pendingNewNotes&&z.pendingNewNotes.length>0)for(const Ie of z.pendingNewNotes)!Ie.title?.trim()&&!Ie.content?.trim()||await Ds.create(t.params.eventId,{title:Ie.title||"Untitled",content:Ie.content||"",scopeConfigurations:[{scope:"SpecificPeople",itemType:"Marshal",ids:[le]}],displayOrder:0,priority:"Normal",isPinned:!1})}else le=(await ms.create({eventId:t.params.eventId,name:z.name,email:z.email,phoneNumber:z.phoneNumber,notes:z.notes,pendingNewChecklistItems:z.pendingNewChecklistItems||[],pendingNewNotes:z.pendingNewNotes||[]})).data.id,me=!0;for(const Ie of $e.value)await i.deleteAssignment(t.params.eventId,Ie);for(const Ie of ee.value)await i.createAssignment({eventId:t.params.eventId,locationId:Ie.locationId,marshalId:le});if(z.pendingAssignments&&z.pendingAssignments.length>0)for(const Ie of z.pendingAssignments)await i.createAssignment({eventId:t.params.eventId,locationId:Ie.locationId,marshalId:le});if(z.checkInChanges&&z.checkInChanges.length>0){const Ie=wo();for(const lt of z.checkInChanges){const kt=Ie.find(Qt=>Qt.id===lt.assignmentId);kt&&kt.isCheckedIn!==lt.shouldBeCheckedIn&&await gs.adminCheckIn(t.params.eventId,lt.assignmentId)}}if(z.checklistChanges&&z.checklistChanges.length>0)for(const Ie of z.checklistChanges)try{const lt={marshalId:le};Ie.contextType&&Ie.contextId&&(lt.contextType=Ie.contextType,lt.contextId=Ie.contextId),Ie.complete?await Pt.complete(t.params.eventId,Ie.itemId,lt):await Pt.uncomplete(t.params.eventId,Ie.itemId,lt)}catch(lt){console.error("Failed to process checklist change:",lt);const kt=lt.response?.data?.message||"Failed to update checklist item";alert(`Error: ${kt}`)}if(await cn(),V.value){const Ie=O.value.find(lt=>lt.id===V.value.id);Ie&&(V.value=Ie)}pa(),me&&(Fe.value=le,ce.value=z.name,Pe.value=!0)}catch(le){console.error("Failed to save marshal:",le);const me=le.response?.data?.message||"Failed to save marshal. Please try again.";if(le.response?.status===400){const Ie=me.toLowerCase();Ie.includes("name")?(se.value={name:me},ve.value&&(ve.value.switchToTab("details"),ve.value.focusField("name"))):Ie.includes("email")?(se.value={email:me},ve.value&&(ve.value.switchToTab("details"),ve.value.focusField("email"))):(se.value={general:me},ve.value&&ve.value.switchToTab("details"))}else se.value={general:me},ve.value&&ve.value.switchToTab("details")}},xs=async z=>{const le=z||Te.value?.id;if(!le){console.error("No marshal ID to delete");return}const me=D.value.person;k(`Delete ${me}`,`Are you sure you want to delete this ${me}?`,async()=>{try{await ms.delete(t.params.eventId,le),await Cs(),pa()}catch(Ie){console.error(`Failed to delete ${me}:`,Ie),alert(`Failed to delete ${me}. Please try again.`)}},{isDanger:!0,confirmText:"Delete"})},fc=z=>{xs(z.id)},No=z=>{$e.value.includes(z)||($e.value.push(z),Rt())},fa=z=>{ee.value.push({locationId:z}),Rt()},pa=()=>{De.value=!1,Te.value=null,oe.value=null,se.value={},te.value={id:"",name:"",email:"",phoneNumber:"",notes:""},ee.value=[],$e.value=[],X.value=!1},Xa=async z=>{const le=he.value.find(me=>me.id===z.marshalId);if(!le){console.error("Marshal not found:",z.marshalId);return}oe.value=V.value?.id||null,X.value=!1,Te.value=le,De.value=!0},va=z=>{const le=O.value.find(me=>me.id===z.locationId);if(!le){console.error("Location not found:",z.locationId);return}Q.value=!0,X.value=!1,V.value=le,Ae.value=!0},Qa=async({file:z})=>{const le=await S.importMarshals(z);if(le){await Cs(),Oi();const me=S.formatImportResultMessage(le,"marshal");ot.value="Import Complete",st.value=me,We.value=!0}},Oi=()=>{S.closeImportMarshalsModal()},li=z=>{ie.value&&(ie.value(z),ie.value=null),ye.value=!1},ma=async({assignment:z,status:le})=>{try{if(le==="not-checked-in"?z.isCheckedIn&&await gs.adminCheckIn(t.params.eventId,z.id):z.isCheckedIn||await gs.adminCheckIn(t.params.eventId,z.id),await xi(),V.value){const me=O.value.find(Ie=>Ie.id===V.value.id);me&&(V.value=me)}}catch(me){console.error("Failed to change assignment status:",me),alert("Failed to change status. Please try again.")}};let Is=null;const el=async()=>{try{const z=t.params.eventId,le=await Xn.getDynamicCheckpoints(z);if(le.data&&Array.isArray(le.data))for(const me of le.data){const Ie=O.value.find(lt=>lt.id===me.checkpointId);Ie&&(Ie.latitude=me.latitude,Ie.longitude=me.longitude,Ie.lastLocationUpdate=me.lastLocationUpdate)}}catch(z){console.warn("Failed to poll dynamic checkpoints:",z)}},Kl=()=>{Is||!O.value.some(le=>le.isDynamic||le.IsDynamic)||(el(),Is=setInterval(el,6e4))},Ri=()=>{Is&&(clearInterval(Is),Is=null)};return Ge(a,z=>{z==="course"?Kl():Ri();const le=Date.now(),me=Ie=>le-q.value[Ie]>PO;switch(z){case"marshals":me("marshals")&&Oo();break;case"areas":me("areas")&&qn();break;case"checkpoints":me("checkpoints")&&ei();break;case"checklists":me("checklists")&&ws();break;case"notes":me("notes")&&at();break;case"incidents":me("incidents")&&Jt();break;case"contacts":me("contacts")&&_t();break}}),Wt(async()=>{await cn();try{const z=await vs.getMe(t.params.eventId);_s.value=z.data}catch(z){console.warn("Failed to fetch user claims:",z)}a.value==="course"&&Kl()}),Ge(I,z=>{z&&(document.title="OnTheDay App - Admin")},{immediate:!0}),zn(()=>{Ri()}),(z,le)=>(v(),m("div",{class:"admin-event-manage",style:rt({colorScheme:j(A)})},[l("header",wO,[l("div",CO,[l("button",{onClick:Li,class:"btn-back",title:"Back to Dashboard"},[Oe(bO,{size:48,animate:""})]),I.value?(v(),m("div",LO,[l("h1",null,w(I.value.name),1),l("p",SO,w(j(yv)(I.value.eventDate)),1)])):P("",!0)]),l("div",xO,[es.value?(v(),m("button",{key:0,onClick:ts,class:"btn btn-marshal-mode"}," Switch to Marshal ")):P("",!0)]),Oe(mv,{class:"theme-toggle-fixed"})]),l("div",IO,[l("div",$O,[Oe(g$,{tabs:U.value,"model-value":j(a),"onUpdate:modelValue":j(c)},null,8,["tabs","model-value","onUpdate:modelValue"])]),l("div",TO,[j(a)==="course"?(v(),Ye(Zw,{key:0,ref_key:"courseAreasTab",ref:Ee,checkpoints:O.value,areas:Et.value,route:I.value?.route||[],"selected-area-id":En.value,"drawing-mode":j(Mo),onMapClick:G,onLocationClick:ai,onAreaClick:Ls,onImportCheckpoints:le[0]||(le[0]=me=>tt.value=!0),onUploadRoute:le[1]||(le[1]=me=>re.value=!0),onSelectLocation:ua,onAddArea:_o,onSelectArea:Ls,onPolygonComplete:la,onCancelDrawing:ca,onAddCheckpointFromMap:vt,onAddManyCheckpointsFromMap:Ft,onAddAreaFromMap:un,onFullscreen:Lt},null,8,["checkpoints","areas","route","selected-area-id","drawing-mode"])):P("",!0),j(a)==="checkpoints"?(v(),Ye(zI,{key:1,locations:O.value,areas:Et.value,onAddCheckpointManually:ls,onImportCheckpoints:le[2]||(le[2]=me=>tt.value=!0),onSelectLocation:ua},null,8,["locations","areas"])):P("",!0),j(a)==="areas"?(v(),Ye(l$,{key:2,areas:Et.value,checkpoints:O.value,contacts:jn.value,"event-people-term":I.value?.peopleTerm||"Marshals","event-checkpoint-term":I.value?.checkpointTerm||"Checkpoints",onAddArea:_o,onSelectArea:Ls},null,8,["areas","checkpoints","contacts","event-people-term","event-checkpoint-term"])):P("",!0),j(a)==="marshals"?(v(),Ye(wC,{key:3,marshals:he.value,assignments:dt.value,locations:O.value,onAddMarshal:Ja,onImportMarshals:le[3]||(le[3]=me=>qe.value=!0),onSelectMarshal:dc,onDeleteMarshal:fc,onChangeAssignmentStatus:ma},null,8,["marshals","assignments","locations"])):P("",!0),j(a)==="checklists"?(v(),Ye(RC,{key:4,"checklist-items":ys.value,areas:Et.value,locations:O.value,marshals:he.value,"completion-report":Ot.value,onAddChecklistItem:ni,onSelectChecklistItem:Ii},null,8,["checklist-items","areas","locations","marshals","completion-report"])):P("",!0),j(a)==="notes"?(v(),Ye(e2,{key:5,notes:po.value,areas:Et.value,locations:O.value,marshals:he.value,onAddNote:Za,onSelectNote:Cn},null,8,["notes","areas","locations","marshals"])):P("",!0),j(a)==="incidents"?(v(),Ye(bI,{key:6,incidents:Zn.value,areas:Et.value,loading:mn.value,onSelectIncident:Ss,onReportIncident:$i},null,8,["incidents","areas","loading"])):P("",!0),j(a)==="contacts"?(v(),Ye(I2,{key:7,contacts:jn.value,areas:Et.value,locations:O.value,marshals:he.value,"available-roles":Do.value,onAddContact:Wa,onSelectContact:aa},null,8,["contacts","areas","locations","marshals","available-roles"])):P("",!0),j(a)==="details"?(v(),Ye(F2,{key:8,"event-data":Ct.value,"form-dirty":St.value,onSubmit:Xs,"onUpdate:formDirty":Js},null,8,["event-data","form-dirty"])):P("",!0),j(a)==="settings"?(v(),Ye(Jx,{key:9,"event-data":Ct.value,"event-id":j(t).params.eventId,admins:j(Me),"form-dirty":St.value,onSubmit:Xs,onAddAdmin:le[4]||(le[4]=me=>ke.value=!0),onRemoveAdmin:Ai,"onUpdate:formDirty":Js},null,8,["event-data","event-id","admins","form-dirty"])):P("",!0)])]),Oe(mO,{show:de.value,location:An.value,"is-dirty":X.value,onClose:ql,onSave:Bo,onSetOnMap:Ze,"onUpdate:isDirty":Rt,"onUpdate:location":xe},null,8,["show","location","is-dirty"]),Oe(MP,{show:Ae.value,location:V.value,assignments:V.value?.assignments||[],"event-date":I.value?.eventDate||"",areas:Et.value,"event-id":j(t).params.eventId,"all-locations":O.value,notes:po.value,"available-marshals":Ws.value,"all-checklist-items":ys.value,incidents:go.value,"is-dirty":X.value,"event-default-style-type":I.value?.defaultCheckpointStyleType||I.value?.DefaultCheckpointStyleType||"default","event-default-style-color":I.value?.defaultCheckpointStyleColor||I.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":I.value?.defaultCheckpointStyleBackgroundShape||I.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":I.value?.defaultCheckpointStyleBackgroundColor||I.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":I.value?.defaultCheckpointStyleBorderColor||I.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":I.value?.defaultCheckpointStyleIconColor||I.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":I.value?.defaultCheckpointStyleSize||I.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":I.value?.defaultCheckpointStyleMapRotation??I.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":I.value?.peopleTerm||"Marshals","z-index":tn.value?1200:Q.value?1100:1e3,"locked-from-marshal":Q.value,onClose:rs,onSave:da,onDelete:cc,onMoveLocation:Wl,onRemoveAssignment:cs,onOpenAssignModal:Di,"onUpdate:isDirty":Rt,onSelectIncident:ks,onSelectMarshal:Xa},null,8,["show","location","assignments","event-date","areas","event-id","all-locations","notes","available-marshals","all-checklist-items","incidents","is-dirty","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","z-index","locked-from-marshal"]),Oe(b$,{show:ge.value,link:mo.value,"is-dirty":!1,onClose:le[5]||(le[5]=me=>ge.value=!1)},null,8,["show","link"]),Oe(O$,{show:Pe.value,"event-id":j(t).params.eventId,"marshal-id":Fe.value,"marshal-name":ce.value,onClose:le[6]||(le[6]=me=>Pe.value=!1)},null,8,["show","event-id","marshal-id","marshal-name"]),Oe(N$,{show:j(ke),"is-dirty":X.value,onClose:as,onSubmit:Ka,"onUpdate:isDirty":Rt},null,8,["show","is-dirty"]),Oe(V$,{show:j(re),uploading:j(Re),error:j(Je),"is-dirty":X.value,onClose:Pi,onSubmit:Ei,"onUpdate:isDirty":Rt},null,8,["show","uploading","error","is-dirty"]),Oe(Q$,{show:j(tt),importing:j(Qe),error:j(ze),result:j(fe),"is-dirty":X.value,onClose:R,onSubmit:B,"onUpdate:isDirty":Rt},null,8,["show","importing","error","result","is-dirty"]),Oe(T4,{ref_key:"editMarshalModalRef",ref:ve,show:De.value,marshal:Te.value,"event-id":j(t).params.eventId,assignments:wo(),"available-locations":It.value,"all-locations":O.value,areas:Et.value,"is-editing":!!Te.value,"event-notes":po.value,"all-checklist-items":ys.value,incidents:Ys.value,"is-dirty":X.value,"validation-errors":se.value,"locked-checkpoint-id":oe.value,"z-index":oe.value?1100:1e3,onClose:pa,onSave:hc,onDelete:xs,onRemoveAssignment:No,onAssignToLocation:fa,"onUpdate:isDirty":Rt,onSelectIncident:io,onSelectCheckpoint:va},null,8,["show","marshal","event-id","assignments","available-locations","all-locations","areas","is-editing","event-notes","all-checklist-items","incidents","is-dirty","validation-errors","locked-checkpoint-id","z-index"]),Oe(lT,{show:j(qe),importing:j(be),error:j(ze),result:j(Le),"is-dirty":X.value,onClose:Oi,onSubmit:Qa,"onUpdate:isDirty":Rt},null,8,["show","importing","error","result","is-dirty"]),Oe(P4,{show:ye.value,"conflict-data":ae.value,onClose:le[7]||(le[7]=me=>ye.value=!1),onChoice:li},null,8,["show","conflict-data"]),Oe(V4,{show:ue.value,"location-name":V.value?.name||"",marshals:Ws.value,onClose:Ya,onAssignExisting:ha,onCreateAndAssign:uc},null,8,["show","location-name","marshals"]),Oe(t6,{show:At.value,"old-event-date":Kt.value,"new-event-date":an.value,"affected-checkpoints-count":Hn.value,onConfirm:Si,onCancel:Qs},null,8,["show","old-event-date","new-event-date","affected-checkpoints-count"]),Oe(_5,{ref_key:"editAreaModalRef",ref:to,show:tn.value,area:gt.value,"initial-tab":vn.value,checkpoints:O.value,marshals:he.value,areas:Et.value,route:I.value?.route||[],"is-dirty":X.value,"event-id":j(t).params.eventId,"all-locations":O.value,assignments:dt.value,notes:po.value,contacts:jn.value,incidents:Ht.value,"event-default-style-type":I.value?.defaultCheckpointStyleType||I.value?.DefaultCheckpointStyleType||"default","event-default-style-color":I.value?.defaultCheckpointStyleColor||I.value?.DefaultCheckpointStyleColor||"","event-default-style-background-shape":I.value?.defaultCheckpointStyleBackgroundShape||I.value?.DefaultCheckpointStyleBackgroundShape||"","event-default-style-background-color":I.value?.defaultCheckpointStyleBackgroundColor||I.value?.DefaultCheckpointStyleBackgroundColor||"","event-default-style-border-color":I.value?.defaultCheckpointStyleBorderColor||I.value?.DefaultCheckpointStyleBorderColor||"","event-default-style-icon-color":I.value?.defaultCheckpointStyleIconColor||I.value?.DefaultCheckpointStyleIconColor||"","event-default-style-size":I.value?.defaultCheckpointStyleSize||I.value?.DefaultCheckpointStyleSize||"","event-default-style-map-rotation":I.value?.defaultCheckpointStyleMapRotation??I.value?.DefaultCheckpointStyleMapRotation??"","event-people-term":I.value?.peopleTerm||"Marshals","event-checkpoint-term":I.value?.checkpointTerm||"Checkpoints",onClose:ao,onSave:ko,onDelete:Xt,onDrawBoundary:is,"onUpdate:isDirty":Rt,onSelectCheckpoint:ua,onCreateContactFromMarshal:na,onCreateNewContact:oa,onEditContact:Ga,onSelectIncident:bs},null,8,["show","area","initial-tab","checkpoints","marshals","areas","route","is-dirty","event-id","all-locations","assignments","notes","contacts","incidents","event-default-style-type","event-default-style-color","event-default-style-background-shape","event-default-style-background-color","event-default-style-border-color","event-default-style-icon-color","event-default-style-size","event-default-style-map-rotation","event-people-term","event-checkpoint-term"]),Oe(M5,{show:Jo.value,"checklist-item":fo.value,"initial-tab":Xo.value,areas:Et.value,locations:O.value,marshals:he.value,"is-dirty":X.value,onClose:ct,onSave:sa,onDelete:ns,"onUpdate:isDirty":Rt},null,8,["show","checklist-item","initial-tab","areas","locations","marshals","is-dirty"]),Oe(Z5,{show:bn.value,note:Gn.value,"initial-tab":wn.value,areas:Et.value,locations:O.value,marshals:he.value,"is-dirty":X.value,onClose:si,onSave:os,onDelete:oi,"onUpdate:isDirty":Rt},null,8,["show","note","initial-tab","areas","locations","marshals","is-dirty"]),Oe($v,{show:oo.value,incident:gn.value,route:I.value?.route||[],checkpoints:O.value,"can-manage":!0,onClose:ia,onStatusChange:qa,onOpenAddNote:ss},null,8,["show","incident","route","checkpoints"]),Oe(zt,{show:Qo.value,title:"Add update",size:"small",onClose:ii},{footer:Ue(()=>[l("div",AO,[l("button",{type:"button",class:"btn btn-secondary",onClick:ii}," Cancel "),l("button",{type:"button",class:"btn btn-primary",onClick:Wn,disabled:!Eo.value.trim()||Po.value},w(Po.value?"Adding...":"Add update"),9,EO)])]),default:Ue(()=>[l("div",MO,[He(l("textarea",{"onUpdate:modelValue":le[8]||(le[8]=me=>Eo.value=me),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[nt,Eo.value]])])]),_:1},8,["show"]),Oe(Tv,{show:Ao.value,"event-id":j(t).params.eventId,checkpoint:null,"initial-location":null,checkpoints:O.value,route:I.value?.route||[],onClose:le[9]||(le[9]=me=>Ao.value=!1),onSubmit:ja},null,8,["show","event-id","checkpoints","route"]),Oe(Z8,{show:vo.value,contact:Mt.value,"initial-tab":so.value,areas:Et.value,locations:O.value,marshals:he.value,"available-roles":Do.value,"is-dirty":X.value,"prefilled-name":mt.value,"prefilled-marshal-id":xt.value,"create-from-area-context":!!Pn.value,onClose:Ro,onSave:bo,onDelete:Ti,"onUpdate:isDirty":Rt},null,8,["show","contact","initial-tab","areas","locations","marshals","available-roles","is-dirty","prefilled-name","prefilled-marshal-id","create-from-area-context"]),Oe(iO,{show:j(no),mode:j(Nt),"context-title":j(Vn).title,"context-description":j(Vn).description,"can-complete":Ks.value,clickable:j(Nt)!=="draw-area","drawing-mode":j(Nt)==="draw-area"&&j(Mo),locations:on.value,areas:Va.value,route:I.value?.route||[],"selected-area-id":En.value,center:j(Vt),zoom:j(et),onMapClick:Y,onPolygonComplete:la,onPolygonDrawing:ra,onDone:lo,onCancel:rc},null,8,["show","mode","context-title","context-description","can-complete","clickable","drawing-mode","locations","areas","route","selected-area-id","center","zoom"]),Oe(lc,{show:We.value,title:ot.value,message:st.value,onClose:le[10]||(le[10]=me=>We.value=!1)},null,8,["show","title","message"]),Oe(Ra,{show:j(u),title:j(d),message:j(f),"is-danger":j(p),"confirm-text":j(g),onConfirm:j(_),onCancel:j(b)},null,8,["show","title","message","is-danger","confirm-text","onConfirm","onCancel"])],4))}},OO=je(DO,[["__scopeId","data-v-08ea5bb1"]]),RO={key:0,class:"emergency-notes-section"},BO={class:"emergency-notes-list"},NO={class:"note-header"},FO={key:0,class:"note-content"},UO={key:1,class:"emergency-contacts-section"},zO={class:"emergency-contacts-list"},HO={class:"contact-header"},VO={key:0,class:"role-badge"},GO={class:"contact-details"},ZO={key:0,class:"info-section"},jO=["href"],qO={key:1,class:"info-section"},WO=["href"],KO={key:2,class:"info-section"},YO=["href"],JO={key:2,class:"no-contacts"},XO={__name:"EmergencyContactModal",props:{show:{type:Boolean,default:!1},contacts:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const o=e,i=t,s=Z(()=>o.notes?[...o.notes].sort((u,d)=>{const f=u.priority||u.Priority,p=d.priority||d.Priority;return f==="Emergency"&&p!=="Emergency"?-1:p==="Emergency"&&f!=="Emergency"?1:0}):[]),a=()=>{i("close")},c=u=>u?{EmergencyContact:"Emergency Contact",EventDirector:"Event Director",MedicalLead:"Medical Lead",SafetyOfficer:"Safety Officer",Logistics:"Logistics"}[u]||u.replace(/([A-Z])/g," $1").trim():"";return(u,d)=>(v(),Ye(zt,{show:e.show,title:"Emergency information",size:"medium",onClose:a},{actions:Ue(()=>[l("button",{onClick:a,class:"btn btn-secondary"},"Close")]),default:Ue(()=>[e.notes&&e.notes.length>0?(v(),m("div",RO,[d[0]||(d[0]=l("h2",{class:"section-header"},"Emergency notes",-1)),l("div",BO,[(v(!0),m(Se,null,Be(s.value,f=>(v(),m("div",{key:f.noteId||f.NoteId,class:pe(["emergency-note-item",{"is-emergency":(f.priority||f.Priority)==="Emergency"}])},[l("div",NO,[l("h3",null,w(f.title||f.Title),1),l("span",{class:pe(["priority-badge",(f.priority||f.Priority).toLowerCase()])},w(f.priority||f.Priority),3)]),f.content||f.Content?(v(),m("div",FO,w(f.content||f.Content),1)):P("",!0)],2))),128))])])):P("",!0),e.contacts&&e.contacts.length>0?(v(),m("div",UO,[d[4]||(d[4]=l("h2",{class:"section-header"},"Emergency contacts",-1)),l("div",zO,[(v(!0),m(Se,null,Be(e.contacts,f=>(v(),m("div",{key:f.contactId||f.name,class:"emergency-contact-item"},[l("div",HO,[l("h3",null,w(f.name),1),f.role?(v(),m("span",VO,w(c(f.role)),1)):P("",!0)]),l("div",GO,[f.phone?(v(),m("div",ZO,[d[1]||(d[1]=l("label",null,"Phone number",-1)),l("a",{href:`tel:${f.phone}`,class:"phone-link"},w(f.phone),9,jO)])):P("",!0),f.email?(v(),m("div",qO,[d[2]||(d[2]=l("label",null,"Email",-1)),l("a",{href:`mailto:${f.email}`,class:"email-link"},w(f.email),9,WO)])):P("",!0),f.notes||f.details?(v(),m("div",KO,[d[3]||(d[3]=l("label",null,"Details",-1)),l("p",null,w(f.notes||f.details),1)])):P("",!0)]),f.phone?(v(),m("a",{key:0,href:`tel:${f.phone}`,class:"btn btn-danger btn-full"}," Call "+w(f.name),9,YO)):P("",!0)]))),128))])])):P("",!0),(!e.contacts||e.contacts.length===0)&&(!e.notes||e.notes.length===0)?(v(),m("div",JO,[...d[5]||(d[5]=[l("p",null,"No emergency information has been set up for this event.",-1)])])):P("",!0)]),_:1},8,["show"]))}},QO=je(XO,[["__scopeId","data-v-77c03c7e"]]),fl=T(navigator.onLine),Us=T(!0),gi=T(0),lr=T(null),ji=T("idle"),Ma=T(null),mu=T(!1);let Kh=null,Rc=!1,zo=null,Yh=0;function eR(e=1e3,t=1e4){return Math.floor(Math.random()*(t-e+1))+e}function Er(){zo&&(clearTimeout(zo),zo=null);const e=eR(1e3,1e4);console.log(`Scheduling auto-sync in ${e}ms`),zo=setTimeout(async()=>{if(zo=null,!navigator.onLine){console.log("Auto-sync cancelled: offline");return}if(await Tr()===0){console.log("Auto-sync cancelled: no pending actions");return}console.log("Starting auto-sync..."),await Pr();const o=await Tr();o>0&&navigator.onLine&&(console.log(`${o} actions remaining, scheduling retry...`),Er())},e)}async function Sa(){if(!navigator.onLine)return Us.value=!1,!1;try{return await Lk.check(),Us.value=!0,!0}catch(e){return e.response?.status===404?(Us.value=!0,!0):(e.code==="ECONNABORTED"&&console.warn("Server health check timed out"),Us.value=!1,!1)}}async function ju(){const e=Date.now();if(e-Yh<2e3)return;Yh=e;const t=navigator.onLine;if(fl.value=t,!t){Us.value=!1;return}mu.value=!0;try{await Sa()&&gi.value>0&&Er()}finally{mu.value=!1}}function Jh(){document.visibilityState==="visible"&&(console.log("Page became visible, checking connectivity..."),ju())}function Xh(){console.log("Window focused, checking connectivity..."),ju()}async function tR(e){try{switch(e.type){case"checkin":await gs.checkIn(e.payload);break;case"checkin_admin":await gs.adminCheckIn(e.payload.eventId,e.payload.assignmentId);break;case"checklist_complete":await Pt.complete(e.payload.eventId,e.payload.itemId,e.payload.data);break;case"checklist_uncomplete":await Pt.uncomplete(e.payload.eventId,e.payload.itemId,e.payload.data);break;default:return console.warn("Unknown action type:",e.type),!1}return!0}catch(t){return console.error("Failed to sync action:",e,t),t.response&&t.response.status>=400&&t.response.status<500?"permanent_failure":!1}}async function Pr(){if(!Rc&&navigator.onLine){Rc=!0,ji.value="syncing",Ma.value=null;try{const e=await dv();if(e.length===0){ji.value="success",gi.value=0;return}let t=0,o=0;for(const i of e){const s=await tR(i);if(s===!0)await Bh(i.id),t++;else if(s==="permanent_failure")await Bh(i.id),o++;else{const a=(i.attempts||0)+1;a>=5?(await Rh(i.id,{status:"failed",attempts:a,lastAttempt:new Date().toISOString()}),o++):await Rh(i.id,{status:"retrying",attempts:a,lastAttempt:new Date().toISOString()})}}gi.value=await Tr(),o>0?(ji.value="error",Ma.value=`${o} action(s) failed to sync`):ji.value="success"}catch(e){console.error("Sync error:",e),ji.value="error",Ma.value="Failed to sync pending actions"}finally{Rc=!1}}}function nR(){Kh||(Kh=setInterval(async()=>{navigator.onLine&&(await Sa(),Us.value&&gi.value>0&&await Pr())},3e4))}function qu(){const e=Z(()=>fl.value&&Us.value);async function t(){gi.value=await Tr()}async function o(){fl.value=!0,await Sa()&&gi.value>0&&Er()}function i(){fl.value=!1,Us.value=!1,zo&&(clearTimeout(zo),zo=null)}Wt(async()=>{await qs(),await t(),window.addEventListener("online",o),window.addEventListener("offline",i),document.addEventListener("visibilitychange",Jh),window.addEventListener("focus",Xh),navigator.onLine&&await Sa()&&gi.value>0&&Er(),nR()}),zn(()=>{window.removeEventListener("online",o),window.removeEventListener("offline",i),document.removeEventListener("visibilitychange",Jh),window.removeEventListener("focus",Xh),zo&&(clearTimeout(zo),zo=null)});async function s(d,f){if(!e.value)return console.warn("Cannot refresh cache while offline"),!1;try{const p=await f();return await Dl(d,p),lr.value=new Date().toISOString(),!0}catch(p){return console.error("Failed to refresh cache:",p),!1}}async function a(d){const f=await _i(d);return f&&(lr.value=f.cachedAt),f}async function c(d){lr.value=await yk(d)}async function u(){return navigator.onLine?await Sa()?(await Pr(),ji.value==="success"):(Ma.value="Server is not responding",!1):(Ma.value="Cannot sync while offline",!1)}return{isOnline:fl,isServerHealthy:Us,isFullyOnline:e,isCheckingStatus:mu,pendingActionsCount:gi,lastSyncTime:lr,syncStatus:ji,syncError:Ma,checkServerHealth:Sa,quickConnectivityCheck:ju,syncPendingActions:Pr,updatePendingCount:t,refreshCache:s,getCachedData:a,loadLastSyncTime:c,forcSync:u}}const oR={class:"area-lead-content"},sR={key:0,class:"loading-state"},iR={key:1,class:"error-state"},aR={key:2,class:"empty-state"},lR={key:3,class:"checkpoint-accordion"},rR=["onClick"],cR={class:"checkpoint-header-content"},uR={class:"checkpoint-title-row"},dR={class:"checkpoint-name"},hR={key:0,class:"area-badge"},fR={key:0,class:"checkpoint-description-preview"},pR={class:"checkpoint-status-row"},vR={class:"status-badge marshals-status"},mR={key:0,class:"status-badge tasks-status"},gR={class:"accordion-icon"},yR={key:0,class:"checkpoint-accordion-content"},_R={class:"checkpoint-mini-map"},kR={class:"checkpoint-marshals-section"},bR={class:"marshals-label"},wR={key:0,class:"empty-state"},CR={key:1,class:"marshals-list"},LR=["onClick"],SR={class:"marshal-header"},xR={class:"marshal-name-row"},IR={class:"marshal-name"},$R={key:0,class:"task-count"},TR={class:"check-status-row"},MR=["onClick","disabled"],AR={key:0,class:"check-in-time"},ER={key:0},PR={key:1,class:"last-access-time"},DR={key:0,class:"checkpoint-tasks-section"},OR={class:"marshals-label"},RR={class:"tasks-list"},BR=["disabled","onChange"],NR={class:"task-text"},FR=["disabled","onChange"],UR={class:"task-text"},zR={key:0,class:"marshal-details-modal"},HR={class:"details-section"},VR={class:"contact-info"},GR={key:0,class:"contact-row"},ZR=["href"],jR={key:1,class:"contact-row"},qR=["href"],WR={key:2,class:"no-contact"},KR={class:"details-section"},YR={key:0,class:"checked-in-section"},JR={class:"checked-in-details"},XR={class:"check-time-detail"},QR={key:0,class:"check-method"},eB=["disabled"],tB={key:1,class:"not-checked-in-section"},nB=["disabled"],oB={key:2,class:"last-access-detail"},sB={class:"details-section"},iB={key:0,class:"no-tasks"},aB={key:1,class:"tasks-list modal-tasks"},lB=["disabled","onChange"],rB={class:"task-text"},cB={class:"details-section contact-actions-section"},uB={class:"contact-buttons"},dB=["href"],hB=["href"],fB=["href"],pB={__name:"AreaLeadSection",props:{eventId:{type:String,required:!0},areaIds:{type:Array,default:()=>[]},marshalId:{type:String,required:!0},route:{type:Array,default:()=>[]}},emits:["checklist-updated","loaded","checkin-updated"],setup(e,{expose:t,emit:o}){const{terms:i,termsLower:s}=bt(),{updatePendingCount:a}=qu(),c=e,u=o,d=T(!1),f=T(null),p=T([]),g=T([]),k=T(null),_=T(!1),b=T(null),C=Z(()=>{const ce=new Set(c.areaIds);return ce.size===0?[...g.value].sort((Me,ke)=>Zs(Me.name,ke.name)):g.value.filter(Me=>(Me.areaIds||[]).some(re=>ce.has(re))).sort((Me,ke)=>Zs(Me.name,ke.name))}),E=(ce,Me=60)=>ce?ce.length<=Me?ce:ce.substring(0,Me).trim()+"...":"",D=T(!1),M=T(null),S=T(null),$=async()=>{if(!(!c.eventId||c.areaIds.length===0)){if(d.value=!0,f.value=null,hn()){try{const ce=await _i(c.eventId);if(ce?.areaLeadDashboard){p.value=ce.areaLeadDashboard.areas||[],g.value=ce.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(ce){console.warn("Failed to load cached dashboard:",ce)}f.value="Offline - no cached data available",d.value=!1;return}try{const ce=await mi.getAreaLeadDashboard(c.eventId);p.value=ce.data.areas||[],g.value=ce.data.checkpoints||[];try{const Me=JSON.parse(JSON.stringify({areas:p.value,checkpoints:g.value}));await _i(c.eventId)?await ul(c.eventId,"areaLeadDashboard",Me):await Dl(c.eventId,{areaLeadDashboard:Me})}catch(Me){console.warn("Failed to cache dashboard:",Me)}}catch(ce){console.error("Failed to load area lead dashboard:",ce);try{const Me=await _i(c.eventId);if(Me?.areaLeadDashboard){console.log("Loading area lead dashboard from cache after error"),p.value=Me.areaLeadDashboard.areas||[],g.value=Me.areaLeadDashboard.checkpoints||[],d.value=!1;return}}catch(Me){console.warn("Failed to load cached dashboard:",Me)}f.value=ce.response?.data?.message||"Failed to load dashboard"}finally{d.value=!1}}},A=ce=>{k.value=k.value===ce?null:ce},U=ce=>ce.marshals.filter(Me=>Me.isCheckedIn).length,I=ce=>{const Me=ce.marshals.reduce((ke,re)=>ke+re.outstandingTaskCount,0);return ce.outstandingTaskCount+Me},H=(ce,Me)=>{M.value=ce,S.value=Me,D.value=!0},O=()=>{D.value=!1,M.value=null,S.value=null},q=async(ce,Me)=>{if(b.value)return;const ke=ce.assignmentId||ce.id;if(!ke){console.error("No assignment ID found for marshal:",ce);return}b.value=ce.marshalId;try{if(hn())await Nn("checkin_admin",{eventId:c.eventId,assignmentId:ke}),ce.isCheckedIn=!0,ce.checkInTime=new Date().toISOString(),ce.checkInMethod="AreaLead (pending)",await a(),u("checkin-updated");else if(await gs.adminCheckIn(c.eventId,ke),await $(),u("checkin-updated"),M.value?.marshalId===ce.marshalId&&S.value){const re=g.value.find(Re=>Re.checkpointId===S.value.checkpointId);if(re){const Re=re.marshals.find(Je=>Je.marshalId===ce.marshalId);Re&&(M.value=Re)}}}catch(re){console.error("Failed to check in marshal:",re),(hn()||!re.response)&&(await Nn("checkin_admin",{eventId:c.eventId,assignmentId:ke}),ce.isCheckedIn=!0,ce.checkInTime=new Date().toISOString(),ce.checkInMethod="AreaLead (pending)",await a(),u("checkin-updated"))}finally{b.value=null}},V=async(ce,Me)=>{if(_.value)return;_.value=!0;const re={marshalId:Me.marshals.length>0?Me.marshals[0].marshalId:c.marshalId,contextType:ce.contextType,contextId:ce.contextId};try{hn()?(await Nn("checklist_complete",{eventId:c.eventId,itemId:ce.itemId,data:re}),Me.outstandingTasks=Me.outstandingTasks.filter(Re=>Re.itemId!==ce.itemId),Me.outstandingTaskCount=Math.max(0,Me.outstandingTaskCount-1),await a(),u("checklist-updated")):(await Pt.complete(c.eventId,ce.itemId,re),await $(),u("checklist-updated"))}catch(Re){console.error("Failed to complete task:",Re),(hn()||!Re.response)&&(await Nn("checklist_complete",{eventId:c.eventId,itemId:ce.itemId,data:re}),Me.outstandingTasks=Me.outstandingTasks.filter(Je=>Je.itemId!==ce.itemId),Me.outstandingTaskCount=Math.max(0,Me.outstandingTaskCount-1),await a(),u("checklist-updated"))}finally{_.value=!1}},Q=async(ce,Me)=>{if(_.value)return;_.value=!0;const re={marshalId:Me.marshals.length>0?Me.marshals[0].marshalId:c.marshalId,contextType:ce.contextType,contextId:ce.contextId,actorMarshalId:c.marshalId};try{hn()?(await Nn("checklist_uncomplete",{eventId:c.eventId,itemId:ce.itemId,data:re}),Me.completedTasks&&(Me.completedTasks=Me.completedTasks.filter(Re=>Re.itemId!==ce.itemId)),Me.outstandingTasks||(Me.outstandingTasks=[]),Me.outstandingTasks.push(ce),Me.outstandingTaskCount=(Me.outstandingTaskCount||0)+1,await a(),u("checklist-updated")):(await Pt.uncomplete(c.eventId,ce.itemId,re),await $(),u("checklist-updated"))}catch(Re){console.error("Failed to uncomplete task:",Re),(hn()||!Re.response)&&(await Nn("checklist_uncomplete",{eventId:c.eventId,itemId:ce.itemId,data:re}),Me.completedTasks&&(Me.completedTasks=Me.completedTasks.filter(Je=>Je.itemId!==ce.itemId)),Me.outstandingTasks||(Me.outstandingTasks=[]),Me.outstandingTasks.push(ce),Me.outstandingTaskCount=(Me.outstandingTaskCount||0)+1,await a(),u("checklist-updated"))}finally{_.value=!1}},de=async ce=>{if(_.value||!M.value)return;_.value=!0;const Me={marshalId:M.value.marshalId,contextType:ce.contextType,contextId:ce.contextId};try{if(hn())await Nn("checklist_complete",{eventId:c.eventId,itemId:ce.itemId,data:Me}),M.value.outstandingTasks=M.value.outstandingTasks.filter(ke=>ke.itemId!==ce.itemId),M.value.outstandingTaskCount=Math.max(0,M.value.outstandingTaskCount-1),await a(),u("checklist-updated");else{if(await Pt.complete(c.eventId,ce.itemId,Me),await $(),M.value&&S.value){const ke=g.value.find(re=>re.checkpointId===S.value.checkpointId);if(ke){const re=ke.marshals.find(Re=>Re.marshalId===M.value.marshalId);re&&(M.value=re)}}u("checklist-updated")}}catch(ke){console.error("Failed to complete task:",ke),(hn()||!ke.response)&&(await Nn("checklist_complete",{eventId:c.eventId,itemId:ce.itemId,data:Me}),M.value.outstandingTasks=M.value.outstandingTasks.filter(re=>re.itemId!==ce.itemId),M.value.outstandingTaskCount=Math.max(0,M.value.outstandingTaskCount-1),await a(),u("checklist-updated"))}finally{_.value=!1}},Ee=ce=>ce?new Date(ce).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",ge=ce=>ce?new Date(ce).toLocaleString():"",Pe=ce=>{if(!ce)return"";const Me=new Date(ce),re=new Date-Me,Re=Math.floor(re/6e4),Je=Math.floor(Re/60),tt=Math.floor(Je/24);return Re<1?"just now":Re<60?`${Re}m ago`:Je<24?`${Je}h ago`:tt===1?"yesterday":tt<7?`${tt}d ago`:Me.toLocaleDateString()},Fe=ce=>({GPS:"GPS",Manual:"Manual",Admin:"Admin",AreaLead:`${i.value.area} Lead`})[ce]||ce;return t({areas:p,checkpoints:g,loading:d,loadDashboard:$}),Ge(()=>c.eventId,()=>{$()},{immediate:!0}),(ce,Me)=>(v(),m("div",oR,[d.value?(v(),m("div",sR," Loading dashboard... ")):f.value?(v(),m("div",iR,[l("p",null,w(f.value),1),l("button",{onClick:$,class:"btn btn-secondary"},"Retry")])):C.value.length===0?(v(),m("div",aR,[l("p",null,"No "+w(j(s).checkpoints)+" in your "+w(j(s).areas)+".",1)])):(v(),m("div",lR,[(v(!0),m(Se,null,Be(C.value,ke=>(v(),m("div",{key:ke.checkpointId,class:"checkpoint-accordion-section"},[l("button",{class:pe(["checkpoint-accordion-header",{active:k.value===ke.checkpointId}]),onClick:re=>A(ke.checkpointId)},[l("div",cR,[l("div",uR,[l("span",dR,w(ke.name),1),ke.areaName?(v(),m("span",hR,w(ke.areaName),1)):P("",!0)]),ke.description?(v(),m("div",fR,w(E(ke.description)),1)):P("",!0),l("div",pR,[l("span",vR,w(U(ke))+" / "+w(ke.marshals.length)+" checked in ",1),I(ke)>0?(v(),m("span",mR,w(I(ke))+" tasks ",1)):P("",!0)])]),l("span",gR,w(k.value===ke.checkpointId?"":"+"),1)],10,rR),k.value===ke.checkpointId?(v(),m("div",yR,[l("div",_R,[Oe(ta,{locations:[{id:ke.checkpointId,name:ke.name,description:ke.description,latitude:ke.latitude,longitude:ke.longitude}],route:e.route,center:{lat:ke.latitude,lng:ke.longitude},zoom:16,"highlight-location-id":ke.checkpointId,"marshal-mode":!0,height:"280px"},null,8,["locations","route","center","highlight-location-id"])]),l("div",kR,[l("div",bR,w(j(i).people)+" ("+w(ke.marshals.length)+")",1),ke.marshals.length===0?(v(),m("div",wR," No "+w(j(s).people)+" assigned to this "+w(j(s).checkpoint)+". ",1)):(v(),m("div",CR,[(v(!0),m(Se,null,Be(ke.marshals,re=>(v(),m("div",{key:re.marshalId,class:pe(["marshal-card",{"is-checked-in":re.isCheckedIn}]),onClick:Re=>H(re,ke)},[l("div",SR,[l("div",xR,[l("span",IR,w(re.name),1),re.outstandingTaskCount>0?(v(),m("span",$R,w(re.outstandingTaskCount)+" tasks ",1)):P("",!0)]),l("div",TR,[l("div",{class:pe(["check-status",{"checked-in":re.isCheckedIn}])},w(re.isCheckedIn?" Checked In":"Not Checked In"),3),l("button",{onClick:ht(Re=>q(re),["stop"]),class:pe(["quick-checkin-btn",{"undo-btn":re.isCheckedIn}]),disabled:b.value===re.marshalId},w(b.value===re.marshalId?"...":re.isCheckedIn?"Undo":"Check In"),11,MR)])]),re.isCheckedIn&&re.checkInTime?(v(),m("div",AR,[Ke(w(Ee(re.checkInTime))+" ",1),re.checkInMethod?(v(),m("span",ER," ("+w(Fe(re.checkInMethod))+")",1)):P("",!0)])):P("",!0),re.lastAccessedAt?(v(),m("div",PR," Last active: "+w(Pe(re.lastAccessedAt)),1)):P("",!0)],10,LR))),128))]))]),ke.outstandingTaskCount>0||ke.completedTasks&&ke.completedTasks.length>0?(v(),m("div",DR,[l("div",OR,w(j(i).checkpoint)+" tasks",1),l("div",RR,[(v(!0),m(Se,null,Be(ke.outstandingTasks,re=>(v(),m("div",{key:re.itemId,class:"task-item"},[l("input",{type:"checkbox",disabled:_.value,onChange:Re=>V(re,ke)},null,40,BR),l("span",NR,w(re.text),1)]))),128)),(v(!0),m(Se,null,Be(ke.completedTasks||[],re=>(v(),m("div",{key:`completed-${re.itemId}`,class:"task-item task-completed"},[l("input",{type:"checkbox",checked:"",disabled:_.value,onChange:Re=>Q(re,ke)},null,40,FR),l("span",UR,w(re.text),1)]))),128))])])):P("",!0)])):P("",!0)]))),128))])),Oe(zt,{show:D.value,title:M.value?.name||"Marshal Details",size:"large",onClose:O},{actions:Ue(()=>[l("button",{onClick:O,class:"btn btn-secondary"},"Close")]),default:Ue(()=>[M.value?(v(),m("div",zR,[l("div",HR,[Me[4]||(Me[4]=l("h4",null,"Contact Details",-1)),l("div",VR,[M.value.email?(v(),m("div",GR,[Me[2]||(Me[2]=l("span",{class:"contact-label"},"Email:",-1)),l("a",{href:`mailto:${M.value.email}`},w(M.value.email),9,ZR)])):P("",!0),M.value.phoneNumber?(v(),m("div",jR,[Me[3]||(Me[3]=l("span",{class:"contact-label"},"Phone:",-1)),l("a",{href:`tel:${M.value.phoneNumber}`},w(M.value.phoneNumber),9,qR)])):P("",!0),!M.value.email&&!M.value.phoneNumber?(v(),m("div",WR," No contact details available. ")):P("",!0)])]),l("div",KR,[Me[8]||(Me[8]=l("h4",null,"Check-in Status",-1)),M.value.isCheckedIn?(v(),m("div",YR,[l("div",JR,[Me[6]||(Me[6]=l("span",{class:"check-icon"},"",-1)),l("div",null,[Me[5]||(Me[5]=l("strong",null,"Checked In",-1)),l("p",XR,w(ge(M.value.checkInTime)),1),M.value.checkInMethod?(v(),m("p",QR," Method: "+w(Fe(M.value.checkInMethod)),1)):P("",!0)])]),l("button",{onClick:Me[0]||(Me[0]=ke=>q(M.value,S.value)),class:"btn btn-secondary undo-checkin-btn",disabled:b.value===M.value.marshalId},w(b.value===M.value.marshalId?"Undoing...":"Undo Check-in"),9,eB)])):(v(),m("div",tB,[Me[7]||(Me[7]=l("div",{class:"not-checked-in"},[l("span",{class:"not-checked-icon"},""),l("span",null,"Not checked in")],-1)),l("button",{onClick:Me[1]||(Me[1]=ke=>q(M.value,S.value)),class:"btn btn-primary check-in-btn",disabled:b.value===M.value.marshalId},w(b.value===M.value.marshalId?"Checking in...":"Check In"),9,nB)])),M.value.lastAccessedAt?(v(),m("div",oB," Last active: "+w(Pe(M.value.lastAccessedAt)),1)):P("",!0)]),l("div",sB,[l("h4",null,w(j(i).checklists)+" ("+w(M.value.outstandingTasks?.length||0)+" outstanding)",1),!M.value.outstandingTasks||M.value.outstandingTasks.length===0?(v(),m("div",iB," No outstanding tasks. ")):(v(),m("div",aB,[(v(!0),m(Se,null,Be(M.value.outstandingTasks,ke=>(v(),m("div",{key:ke.itemId,class:"task-item"},[l("input",{type:"checkbox",disabled:_.value,onChange:re=>de(ke)},null,40,lB),l("span",rB,w(ke.text),1)]))),128))]))]),l("div",cB,[l("div",uB,[M.value.phoneNumber?(v(),m("a",{key:0,href:`tel:${M.value.phoneNumber}`,class:"btn btn-primary"}," Call ",8,dB)):P("",!0),M.value.phoneNumber?(v(),m("a",{key:1,href:`sms:${M.value.phoneNumber}`,class:"btn btn-secondary"}," Text ",8,hB)):P("",!0),M.value.email?(v(),m("a",{key:2,href:`mailto:${M.value.email}`,class:"btn btn-secondary"}," Email ",8,fB)):P("",!0)])])])):P("",!0)]),_:1},8,["show","title"])]))}},vB=je(pB,[["__scopeId","data-v-689943db"]]),mB={class:"offline-indicator-container"},gB={class:"offline-icon"},yB={key:0,viewBox:"0 0 24 24",fill:"currentColor"},_B={key:1,class:"spinner",viewBox:"0 0 24 24",fill:"currentColor"},kB={class:"offline-text"},bB={key:0,class:"last-sync"},wB={class:"pending-text"},CB={key:0,class:"pending-subtext"},LB={key:1,class:"syncing-text"},SB={__name:"OfflineIndicator",setup(e){const{isOnline:t,isFullyOnline:o,isCheckingStatus:i,pendingActionsCount:s,lastSyncTime:a,syncStatus:c,syncError:u,forcSync:d}=qu(),f=T(!1),p=T(""),g=T(""),k=Z(()=>{if(!a.value)return"";const b=new Date(a.value),E=new Date-b,D=Math.floor(E/6e4),M=Math.floor(D/60);return D<1?"just now":D<60?`${D}m ago`:M<24?`${M}h ago`:b.toLocaleDateString()}),_=async()=>{await d()};return Ge(c,b=>{b==="success"&&s.value===0?(p.value="All actions synced successfully!",g.value="success",f.value=!0,setTimeout(()=>{f.value=!1},3e3)):b==="error"&&(p.value=u.value||"Sync failed",g.value="error",f.value=!0,setTimeout(()=>{f.value=!1},5e3))}),(b,C)=>(v(),m("div",mB,[Oe(wl,{name:"slide"},{default:Ue(()=>[j(o)?P("",!0):(v(),m("div",{key:0,class:pe(["offline-banner",{checking:j(i)}])},[l("span",gB,[j(i)?(v(),m("svg",_B,[...C[1]||(C[1]=[l("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8z"},null,-1)])])):(v(),m("svg",yB,[...C[0]||(C[0]=[l("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"},null,-1)])]))]),l("span",kB,w(j(i)?"Checking connection...":j(t)?"Server unavailable":"You're offline"),1),j(a)&&!j(i)?(v(),m("span",bB," Last synced: "+w(k.value),1)):P("",!0)],2))]),_:1}),Oe(wl,{name:"fade"},{default:Ue(()=>[j(s)>0?(v(),m("div",{key:0,class:pe(["pending-banner",{"offline-pending":!j(o)}])},[C[2]||(C[2]=l("span",{class:"pending-icon"},[l("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})])],-1)),l("span",wB,[Ke(w(j(s))+" pending action"+w(j(s)!==1?"s":"")+" ",1),j(o)?P("",!0):(v(),m("span",CB,"(will sync when online)"))]),j(o)&&j(c)!=="syncing"?(v(),m("button",{key:0,onClick:_,class:"sync-button"}," Sync Now ")):j(c)==="syncing"?(v(),m("span",LB,"Syncing...")):P("",!0)],2)):P("",!0)]),_:1}),Oe(wl,{name:"fade"},{default:Ue(()=>[f.value?(v(),m("div",{key:0,class:pe(["sync-toast",g.value])},w(p.value),3)):P("",!0)]),_:1})]))}},xB=je(SB,[["__scopeId","data-v-9c1e58f4"]]),IB={key:0,class:"header-logo-cover"},$B=["src"],TB=["title"],MB=["innerHTML"],AB={key:2,class:"header-logo header-logo-left"},EB=["src"],PB={class:"header-center"},DB={key:0},OB={key:1,class:"header-event-date"},RB={key:0,class:"header-actions"},BB={key:3,class:"header-logo header-logo-right"},NB=["src"],FB=["title"],UB=["innerHTML"],zB={class:"container"},HB={key:0,class:"selection-card"},VB={key:1,class:"selection-card"},GB={key:0,class:"loading"},ZB={key:2,class:"selection-card error-card"},jB={class:"error"},qB={key:3,class:"dashboard"},WB={key:0,class:"welcome-bar"},KB={class:"welcome-info"},YB={key:0,class:"welcome-email"},JB={key:0,class:"mode-switch"},XB={key:1,class:"mode-switch"},QB={class:"accordion"},eN={class:"accordion-section"},tN={class:"accordion-title"},nN=["innerHTML"],oN={key:0,class:"location-status active"},sN={key:1,class:"location-status"},iN={class:"accordion-icon"},aN={key:0,class:"accordion-content map-content"},lN={key:0,class:"map-selection-banner"},rN={class:"map-wrapper"},cN={class:"accordion-section"},uN={class:"accordion-title"},dN=["innerHTML"],hN={class:"accordion-icon"},fN={key:0,class:"accordion-content assignments-accordion-content"},pN={key:0,class:"empty-state"},vN={key:1,class:"checkpoint-accordion"},mN=["onClick"],gN={class:"checkpoint-header-content"},yN={class:"checkpoint-title-row"},_N=["innerHTML"],kN={key:0,class:"checkpoint-check-icon"},bN={class:"checkpoint-name"},wN={key:1,class:"area-badge"},CN={key:2,class:"checkpoint-time-badge"},LN={key:0,class:"checkpoint-description-preview"},SN={class:"accordion-icon"},xN={key:0,class:"checkpoint-accordion-content"},IN={key:0,class:"checkpoint-mini-map"},$N=["onClick"],TN={viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",style:{"margin-right":"0.5rem"}},MN={class:"checkpoint-marshals"},AN={class:"marshals-label"},EN={key:0,class:"marshals-list"},PN={key:0,class:"check-badge"},DN={key:1,class:"marshals-list-expanded"},ON=["onClick"],RN={class:"marshal-name-text"},BN={class:"marshal-status-icons"},NN={key:0,class:"check-badge"},FN={class:"expand-icon"},UN={key:0,class:"marshal-details-panel"},zN={class:"detail-row"},HN={key:0,class:"detail-row"},VN={key:1,class:"detail-row"},GN={key:2,class:"detail-row"},ZN=["href"],jN={key:3,class:"detail-row"},qN=["href"],WN={key:4,class:"contact-buttons-mini"},KN=["href"],YN=["href"],JN=["href"],XN={key:1,class:"checkpoint-area-contacts"},QN={class:"marshals-label"},e7={class:"contact-list"},t7={class:"contact-info"},n7={class:"contact-name"},o7={key:0,class:"contact-role"},s7={key:1,class:"contact-detail"},i7={key:2,class:"contact-detail"},a7={class:"contact-actions"},l7=["href"],r7=["href"],c7=["href"],u7={key:2,class:"checked-in-status"},d7={class:"check-time"},h7={key:3,class:"check-in-actions"},f7=["onClick","disabled"],p7=["onClick","disabled"],v7={key:4,class:"error"},m7={key:5,class:"dynamic-location-section"},g7={class:"dynamic-location-header"},y7={class:"dynamic-badge"},_7={key:0,class:"last-update"},k7={class:"dynamic-location-actions"},b7=["onClick","disabled"],w7=["onClick","title"],C7={class:"accordion-section"},L7={class:"accordion-title"},S7=["innerHTML"],x7={class:"accordion-icon"},I7={key:0,class:"accordion-content"},$7={key:0,class:"loading"},T7={key:1,class:"error"},M7={key:2,class:"empty-state"},A7={class:"checklist-section"},E7={key:0,class:"empty-state small"},P7={key:1,class:"my-jobs-list"},D7=["checked","disabled","onChange"],O7={key:0,class:"checklist-section"},R7={class:"checklist-section-title"},B7={key:0,class:"checklist-items"},N7={class:"item-checkbox"},F7=["checked","disabled","onChange"],U7={class:"item-content"},z7={key:0,class:"item-context"},H7={key:1,class:"completion-info"},V7={class:"completion-text"},G7={class:"completion-time"},Z7={key:1,class:"checklist-groups"},j7=["onClick"],q7={class:"group-title"},W7={class:"group-status"},K7={class:"group-count"},Y7={class:"group-expand-icon"},J7={key:0,class:"checklist-group-items"},X7={class:"item-checkbox"},Q7=["checked","disabled","onChange"],eF={class:"item-content"},tF={key:0,class:"completion-info"},nF={class:"completion-text"},oF={class:"completion-time"},sF={key:0,class:"accordion-section"},iF={class:"accordion-title"},aF=["innerHTML"],lF={class:"accordion-icon"},rF={key:0,class:"accordion-content"},cF={key:0,class:"loading"},uF={key:1,class:"contact-list"},dF={class:"contact-info"},hF={class:"contact-name-row"},fF={key:0,class:"primary-badge"},pF={class:"contact-name"},vF={key:0,class:"contact-notes-text"},mF={key:1,class:"contact-detail"},gF={key:2,class:"contact-detail"},yF={class:"contact-actions"},_F=["href"],kF=["href"],bF=["href"],wF={class:"accordion-section"},CF={class:"accordion-title"},LF=["innerHTML"],SF={class:"accordion-icon"},xF={key:0,class:"accordion-content"},IF={key:1,class:"accordion-section"},$F={class:"accordion-title"},TF=["innerHTML"],MF={class:"accordion-icon"},AF={key:0,class:"accordion-content"},EF={key:0,class:"loading-state"},PF={key:1,class:"empty-state"},DF={key:2,class:"incidents-list"},OF={key:2,class:"accordion-section"},RF={class:"accordion-title"},BF=["innerHTML"],NF={class:"accordion-icon"},FF={key:0,class:"accordion-content area-lead-accordion-content"},UF={key:0,class:"area-filter-pills"},zF=["onClick"],HF={key:3,class:"accordion-section"},VF={class:"accordion-title"},GF=["innerHTML"],ZF={class:"accordion-icon"},jF={key:0,class:"accordion-content area-lead-marshals-content"},qF={class:"area-lead-marshals-list"},WF=["onClick"],KF={class:"marshal-header-info"},YF={class:"marshal-name-row"},JF={class:"marshal-name"},XF={class:"marshal-meta"},QF={class:"marshal-checkpoint"},e9={key:0,class:"marshal-task-count"},t9={class:"accordion-icon"},n9={key:0,class:"area-lead-marshal-content"},o9={class:"marshal-checkin-section"},s9={class:"checkin-status-row"},i9={class:"checkin-label"},a9={key:0,class:"checkin-time"},l9=["onClick","disabled"],r9={key:0,class:"marshal-contact-section"},c9=["href"],u9=["href"],d9={key:1,class:"marshal-tasks-section"},h9={class:"tasks-label"},f9={class:"tasks-list"},p9=["checked","disabled","onChange"],v9={class:"task-text"},m9={key:2,class:"no-tasks-message"},g9={key:4,class:"accordion-section"},y9={class:"accordion-title"},_9=["innerHTML"],k9={class:"accordion-icon"},b9={key:0,class:"accordion-content"},w9={class:"event-details"},C9={key:0,class:"event-detail-row"},L9={class:"detail-value"},S9={key:1,class:"event-description"},x9={class:"detail-value"},I9={class:"add-note-form"},$9={class:"modal-actions"},T9=["disabled"],M9={class:"modal-content check-in-reminder-modal"},A9={class:"modal-header warning"},E9={class:"modal-body"},P9={class:"reminder-message"},D9={key:0},O9={class:"reminder-hint"},R9={class:"modal-footer"},B9={class:"modal-content location-update-modal"},N9={class:"modal-header"},F9={class:"modal-body"},U9={key:0,class:"success-message"},z9={key:1},H9={class:"modal-description"},V9={key:0,class:"last-update-info"},G9={key:1,class:"gps-status active"},Z9={class:"update-option"},j9=["disabled"],q9={class:"update-option auto-update-option"},W9={class:"checkbox-label"},K9=["checked"],Y9={class:"option-hint"},J9={class:"update-option"},X9=["disabled"],Q9={class:"update-option"},eU={class:"option-label"},tU={key:0,class:"checkpoint-list"},nU=["onClick","disabled"],oU={key:1,class:"no-checkpoints"},sU={key:2,class:"error"},iU=6e4,Qh='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><circle cx="12" cy="12" r="4"/><path d="M13 4.069V2h-2v2.069A8.01 8.01 0 0 0 4.069 11H2v2h2.069A8.008 8.008 0 0 0 11 19.931V22h2v-2.069A8.007 8.007 0 0 0 19.931 13H22v-2h-2.069A8.008 8.008 0 0 0 13 4.069zM12 18c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6z"/></svg>',ef='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>',aU={__name:"MarshalView",setup(e){const{terms:t,termsLower:o}=bt(),{updatePendingCount:i}=qu(),s=Qr(),a=Na(),c=Z(()=>s.params.eventId),u=T(!1),d=T(!1),f=T(null),p=T(null),g=T(null),k=T(null),_=Z(()=>k.value?.eventRoles?k.value.eventRoles.filter(R=>R.role==="EventAreaLead").flatMap(R=>R.areaIds||[]):[]),b=Z(()=>_.value.length>0),C=T(new Set),E=Z(()=>_.value.length?V.value.filter(B=>_.value.includes(B.id)).map(B=>({areaId:B.id,name:B.name,color:B.color})).sort((B,R)=>(B.name||"").localeCompare(R.name||"",void 0,{numeric:!0,sensitivity:"base"})):[]);Ge(E,B=>{B.length>0&&C.value.size===0&&(C.value=new Set(B.map(R=>R.areaId)))},{immediate:!0});const D=Z(()=>_.value.filter(B=>C.value.has(B))),M=B=>{const R=new Set(C.value);R.has(B)?R.delete(B):R.add(B),C.value=R};Z(()=>{const B=new Map;for(const R of mn.value)R.location&&B.set(R.location.id,{id:R.location.id,name:R.location.name,description:R.location.description,order:R.location.order??999});if(b.value)for(const R of O.value){if(B.has(R.id))continue;(R.areaIds||R.AreaIds||[]).some(Y=>_.value.includes(Y))&&B.set(R.id,{id:R.id,name:R.name,description:R.description,order:R.order??999})}return Array.from(B.values()).sort((R,G)=>R.order!==G.order?R.order-G.order:(R.name||"").localeCompare(G.name||"",void 0,{numeric:!0,sensitivity:"base"}))});const S=Z(()=>{const B=mn.value.find(G=>G.isCheckedIn&&!Xo(G.checkInTime)&&G.location);if(B?.location)return{id:B.location.id,locationId:B.location.id,name:B.location.name,description:B.location.description};if(wn.value){const G=mn.value.find(Y=>Y.id===wn.value);if(G?.location)return{id:G.location.id,locationId:G.location.id,name:G.location.name,description:G.location.description}}const R=mn.value[0];return R?.location?{id:R.location.id,locationId:R.location.id,name:R.location.name,description:R.location.description}:null}),$=Z(()=>k.value?.eventRoles?k.value.eventRoles.some(B=>B.role==="EventAdmin"):!1),A=Z(()=>k.value?.authMethod==="SecureEmailLink"&&$.value),U=Z(()=>k.value?.authMethod==="MarshalMagicCode"&&$.value),I=()=>{a.push(`/admin/events/${s.params.eventId}`)},H=T(null),O=T([]),q=T([]),V=T([]),Q=T(!0),de=Z(()=>{const B=H.value?.brandingPageGradientStart||Yn.pageGradientStart,R=H.value?.brandingPageGradientEnd||Yn.pageGradientEnd;return{background:`linear-gradient(135deg, ${B} 0%, ${R} 100%)`}}),Ee=Z(()=>{const B=H.value?.brandingHeaderGradientStart||Yn.headerGradientStart,R=H.value?.brandingHeaderGradientEnd||Yn.headerGradientEnd;return{background:`linear-gradient(135deg, ${B} 0%, ${R} 100%)`}}),ge=Z(()=>{const B=H.value?.brandingHeaderGradientStart||Yn.headerGradientStart,R=H.value?.brandingHeaderGradientEnd||Yn.headerGradientEnd;return Lv(B,R)}),Pe=Z(()=>H.value?.brandingAccentColor||Yn.accentColor),Fe=Z(()=>Cv(Pe.value)),ce=Z(()=>({background:Pe.value,color:Fe.value})),Me=Z(()=>H.value?.brandingLogoUrl||""),ke=Z(()=>H.value?.brandingLogoPosition||"left"),re=T("assignments"),Re=T({checklist:0,notes:0,incidents:0,eventContacts:0}),Je=T(null),tt=T(null),qe=T(null),Qe=T([]),be=T(!1),ze=T(null),fe=T(!1);T("person");const Le=T(null),Ae=T([]),W=T([]),J=T([]),ue=T(!1),ye=T(null),ae=T(!1),ie=T(!1),he=T(""),De=T(!1);Z(()=>J.value.filter(B=>B.status==="open"||B.status==="acknowledged"||B.status==="in_progress").length);const Te=T(!1),oe=T(null),ve=T(null),se=T(null),te=T(!1),X=T(!1);let N=null,K=null;const ee=T(null),$e=T(null),We=T(null),ot=T(!1),st=T(0),Ct=B=>{$e.value=$e.value===B?null:B},St=Z(()=>{st.value;const B=ee.value?.checkpoints||Ae.value||[],R=new Map;for(const G of B)for(const Y of G.marshals||[]){R.has(Y.marshalId)||R.set(Y.marshalId,{...Y,checkpoints:[],allTasks:[],totalTaskCount:0,completedTaskCount:0});const xe=R.get(Y.marshalId);if(xe.checkpoints.push({checkpointId:G.checkpointId,name:G.name,description:G.description}),Y.outstandingTasks)for(const Ze of Y.outstandingTasks)xe.allTasks.push({...Ze,isCompleted:!1,checkpointName:G.name}),xe.totalTaskCount++;if(Y.completedTasks)for(const Ze of Y.completedTasks)xe.allTasks.push({...Ze,isCompleted:!0,checkpointName:G.name}),xe.totalTaskCount++,xe.completedTaskCount++}return Array.from(R.values()).sort((G,Y)=>(G.name||"").localeCompare(Y.name||"",void 0,{sensitivity:"base"}))}),At=async B=>{if(We.value)return;const G=(ee.value?.checkpoints||Ae.value||[]).find(Ze=>Ze.marshals?.some(vt=>vt.marshalId===B.marshalId));if(!G){console.error("Could not find checkpoint for marshal:",B);return}const Y=G.marshals.find(Ze=>Ze.marshalId===B.marshalId);if(!Y)return;const xe=Y.assignmentId||Y.id;if(!xe){console.error("No assignment ID found for marshal:",Y);return}We.value=B.marshalId;try{await gs.adminCheckIn(c.value,xe),ee.value?.loadDashboard&&await ee.value.loadDashboard(),st.value++}catch(Ze){console.error("Failed to check in marshal:",Ze)}finally{We.value=null}},Kt=async(B,R)=>{if(ot.value)return;ot.value=!0;const G={marshalId:R.marshalId,contextType:B.contextType,contextId:B.contextId,actorMarshalId:g.value};try{B.isCompleted?await Pt.uncomplete(c.value,B.itemId,G):await Pt.complete(c.value,B.itemId,G),ee.value?.loadDashboard&&await ee.value.loadDashboard(),st.value++,await at(!0)}catch(Y){console.error("Failed to toggle task:",Y)}finally{ot.value=!1}},an=T(!1),Hn=T(!1),An=T(!1),Et=T(!1),gt=T(""),tn=T(""),vn=T(null),to=T(!1),En=T(""),Yt=T(""),Yo=T(!1),ln=T(null),no=T(new Set),Nt=T(null),Vn=T({userLocationInView:!0,highlightedLocationInView:!0}),rn=T({}),To={},Vt=T(null),et=B=>!B||B.length===0?!1:B.some(R=>_.value.includes(R)),Mo=B=>{Vt.value=Vt.value===B?null:B},ho=B=>B?new Date(B).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",ys=B=>{if(!B)return"";switch(B){case"GPS":return"GPS";case"Manual":return"Manual";case"AreaLead":return"By area lead";default:return B}},fo=B=>!B||B.length===0?"":B.map(R=>{if(R.description){const Y=R.description.length>40?R.description.substring(0,40).trim()+"...":R.description;return`${R.name} - ${Y}`}return R.name}).join(", "),Jo=(B,R)=>{R&&(To[B]=R)},Xo=B=>{if(!B)return!0;const R=new Date(B);return(new Date-R)/(1e3*60*60)>24},Ot=T(null),po=T(null);let Gn=null;const bn=B=>{const R=re.value===B;if(re.value=R?null:B,!R){const G=Date.now(),Y=xe=>G-Re.value[xe]>iU;switch(B){case"checklist":Y("checklist")&&at();break;case"notes":Y("notes")&&Oo();break;case"incidents":Y("incidents")&&qn();break;case"eventContacts":Y("eventContacts")&&ws();break}}},wn=T(null),Zn=B=>{wn.value=wn.value===B?null:B};Ge(()=>q.value,B=>{B.length===1&&wn.value===null&&(wn.value=B[0].id)},{immediate:!0});const mn=Z(()=>q.value.map(B=>{const R=O.value.find(Ft=>Ft.id===B.locationId),G=R?.areaIds||R?.AreaIds||[];let Y=null;G.length>0&&V.value.length>0&&(Y=V.value.find(lo=>G.includes(lo.id))?.name);const Ze=(R?.assignments||[]).map(Ft=>({...Ft,effectiveIsCheckedIn:Ft.isCheckedIn&&!Xo(Ft.checkInTime)})).sort((Ft,lo)=>(Ft.marshalName||"").localeCompare(lo.marshalName||"",void 0,{sensitivity:"base"})),vt=on.value.filter(Ft=>G.includes(Ft.areaId)&&(!Ft.marshalId||Ft.marshalId!==g.value)),Lt=new Set,un=vt.filter(Ft=>{const lo=JSON.stringify({name:Ft.name||"",marshalId:Ft.marshalId||"",role:Ft.role||"",phone:Ft.phone||"",email:Ft.email||"",notes:Ft.notes||""});return Lt.has(lo)?!1:(Lt.add(lo),!0)}).sort((Ft,lo)=>(Ft.marshalName||Ft.name||"").localeCompare(lo.marshalName||lo.name||"",void 0,{sensitivity:"base"})),ls=B.isCheckedIn&&!Xo(B.checkInTime);return{...B,location:R,areaName:Y,areaIds:G,allMarshals:Ze,areaContacts:un,locationName:R?.name||"Unknown Location",effectiveIsCheckedIn:ls}})),gn=Z(()=>q.value.length>0?q.value[0]:null),oo=Z(()=>q.value.map(B=>B.locationId)),Ao=Z(()=>mn.value.some(B=>B.location?.isDynamic||B.location?.IsDynamic)),Qo=Z(()=>mn.value.find(B=>B.location?.isDynamic||B.location?.IsDynamic)),Eo=Z(()=>{if(!H.value||!mn.value.length)return[];const B=new Date,R=H.value.eventDate?new Date(H.value.eventDate):null;return mn.value.filter(G=>{if(G.effectiveIsCheckedIn||no.value.has(G.id))return!1;const Y=G.location;if(!Y)return!1;const xe=Y.startTime?new Date(Y.startTime):R;if(!xe)return!1;let Ze;if(Y.endTime)Ze=new Date(Y.endTime);else if(R)Ze=new Date(R.getTime()+7200*1e3);else return!1;return B>=xe&&B<Ze})});Ge(Eo,B=>{B.length>0&&!Yo.value&&(ln.value=B[0],Yo.value=!0)},{immediate:!0});const Po=B=>{no.value.add(B),Yo.value=!1,ln.value=null},jn=Z(()=>H.value?.route?(typeof H.value.route=="string"?JSON.parse(H.value.route):H.value.route)||[]:[]),Do=Z(()=>!gn.value||!O.value.length?null:O.value.find(B=>B.id===gn.value.locationId)),Mt=Z(()=>Qe.value.filter(B=>B.isCompleted&&["OnePerCheckpoint","OnePerArea","OneLeadPerArea"].includes(B.matchedScope)?B.completedByActorId===g.value:!0)),vo=Z(()=>Mt.value.filter(B=>B.isCompleted).length),so=Z(()=>{const B=q.value.map(R=>R.locationId);return Mt.value.filter(R=>R.completionContextType==="Personal"?R.contextOwnerMarshalId===g.value:R.completionContextType==="Checkpoint"?B.includes(R.completionContextId):R.completionContextType==="Area"?_.value.includes(R.completionContextId):!0)}),Pn=Z(()=>{if(!b.value)return[];const B=q.value.map(R=>R.locationId);return Mt.value.filter(R=>R.completionContextType==="Personal"?R.contextOwnerMarshalId!==g.value:R.completionContextType==="Checkpoint"?!B.includes(R.completionContextId):R.completionContextType==="Area"?!_.value.includes(R.completionContextId):!1)});Z(()=>so.value.map(B=>({...B,localIsCompleted:B.isCompleted,isModified:!1})));const mt=Z(()=>Pn.value.map(B=>({...B,localIsCompleted:B.isCompleted,isModified:!1})));Z(()=>Mt.value.map(B=>({...B,localIsCompleted:B.isCompleted,isModified:!1})));const xt=Z(()=>{const B=ee.value?.checkpoints||Ae.value||[];if(B.length===0)return[];const R=[],G=new Set;for(const Y of B)for(const xe of Y.marshals||[])G.has(xe.marshalId)||(G.add(xe.marshalId),R.push(xe));return R});Z(()=>{const B=Mt.value;if(B.length<=1)return!1;const R=new Set,G=new Set;for(const Y of B)Y.completionContextType==="Checkpoint"&&Y.completionContextId&&R.add(Y.completionContextId),G.add(Y.text);return R.size>1||G.size>1});const _s=Z(()=>{if(b.value)return"none";const B=Mt.value,R=new Set;for(const G of B)G.completionContextType==="Checkpoint"&&G.completionContextId&&R.add(G.completionContextId);return R.size>1?"checkpoint":"none"}),es=Z(()=>{const B=Mt.value,R={};for(const G of B){let Y,xe;G.completionContextType==="Checkpoint"&&G.completionContextId?(Y=`checkpoint_${G.completionContextId}`,xe=O.value.find(vt=>vt.id===G.completionContextId)?.name||"Unknown "+t.value.checkpoint):G.completionContextType==="Area"&&G.completionContextId?(Y=`area_${G.completionContextId}`,xe=V.value.find(vt=>vt.id===G.completionContextId)?.name||"Unknown "+t.value.area):(Y="personal",xe="Personal"),R[Y]||(R[Y]={key:Y,name:xe,items:[],completedCount:0}),R[Y].items.push(G),G.isCompleted&&R[Y].completedCount++}return Object.values(R).sort((G,Y)=>G.name.localeCompare(Y.name,void 0,{numeric:!0,sensitivity:"base"}))}),ts=B=>{Le.value=Le.value===B?null:B},mo=T([]),dt=T(!1),It=Z(()=>{const B=mo.value.filter(Y=>!Y.marshalId||Y.marshalId!==g.value),R=new Set;return B.filter(Y=>{const xe=JSON.stringify({name:Y.name||"",marshalId:Y.marshalId||"",role:Y.role||"",phone:Y.phone||"",email:Y.email||"",notes:Y.notes||""});return R.has(xe)?!1:(R.add(xe),!0)}).sort((Y,xe)=>(Y.name||"").localeCompare(xe.name||"",void 0,{sensitivity:"base"}))}),Ws=Z(()=>{const B=["EmergencyContact","EventDirector","MedicalLead","SafetyOfficer"];return It.value.filter(R=>B.includes(R.role))}),Ks=Z(()=>W.value.filter(B=>{const R=B.priority||B.Priority;return R==="Emergency"||R==="Urgent"})),on=T([]),Va=Z(()=>{if(on.value.length===0)return[];const B=on.value.filter(Ze=>!Ze.marshalId||Ze.marshalId!==g.value),R=new Set,G=B.filter(Ze=>{const vt=JSON.stringify({name:Ze.name||"",marshalId:Ze.marshalId||"",role:Ze.role||"",phone:Ze.phone||"",email:Ze.email||"",notes:Ze.notes||"",areaId:Ze.areaId||""});return R.has(vt)?!1:(R.add(vt),!0)}),Y={};for(const Ze of G){const vt=Ze.areaId||"unknown";Y[vt]||(Y[vt]={areaId:Ze.areaId,areaName:Ze.areaName||"Unknown Area",contacts:[]}),Y[vt].contacts.push(Ze)}const xe=Object.values(Y);for(const Ze of xe)Ze.contacts.sort((vt,Lt)=>(vt.marshalName||vt.name||"").localeCompare(Lt.marshalName||Lt.name||"",void 0,{sensitivity:"base"}));return xe});Z(()=>Va.value.reduce((B,R)=>B+R.contacts.length,0));const Ys=(B,R)=>B.localeCompare(R,void 0,{numeric:!0,sensitivity:"base"}),go=Z(()=>{if(!oe.value)return[];const B=oe.value.locationId;return O.value.filter(R=>R.id!==B&&R.latitude!==0&&R.longitude!==0).sort((R,G)=>Ys(R.name,G.name))}),Ht=Z(()=>Do.value?{lat:Do.value.latitude,lng:Do.value.longitude}:Ot.value?Ot.value:O.value.length>0?{lat:O.value[0].latitude,lng:O.value[0].longitude}:{lat:51.505,lng:-.09}),io=Z(()=>mn.value.find(B=>B.location?.latitude&&B.location?.longitude&&!(B.location.latitude===0&&B.location.longitude===0))),ks=Z(()=>{const B=[];return Ot.value&&!Vn.value.userLocationInView&&B.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:Qh}),io.value&&!Vn.value.highlightedLocationInView&&B.push({id:"recenter-checkpoint",label:"My "+o.value.checkpoint,icon:"custom",customIcon:ef}),B}),bs=B=>{const R=Vn.value;(R.userLocationInView!==B.userLocationInView||R.highlightedLocationInView!==B.highlightedLocationInView)&&(Vn.value=B)},Li=({actionId:B})=>{if(B==="recenter-user"&&Ot.value)Nt.value?.recenterOnUserLocation();else if(B==="recenter-checkpoint"&&io.value){const R=io.value.location;Nt.value?.recenterOnLocation(R.latitude,R.longitude)}},Rt=B=>{const R=[],G=rn.value[B]||{userLocationInView:!0,highlightedLocationInView:!0};return Ot.value&&!G.userLocationInView&&R.push({id:"recenter-user",label:"My location",icon:"custom",customIcon:Qh}),G.highlightedLocationInView||R.push({id:"recenter-checkpoint",label:o.value.checkpoint.charAt(0).toUpperCase()+o.value.checkpoint.slice(1),icon:"custom",customIcon:ef}),R},Js=(B,R)=>{const G=rn.value[B];(!G||G.userLocationInView!==R.userLocationInView||G.highlightedLocationInView!==R.highlightedLocationInView)&&(rn.value={...rn.value,[B]:R})},Xs=(B,{actionId:R})=>{const G=To[B.id];R==="recenter-user"&&Ot.value?G?.recenterOnUserLocation():R==="recenter-checkpoint"&&B.location&&G?.recenterOnLocation(B.location.latitude,B.location.longitude)},yo=async(B,R,G=!1)=>{d.value=!0,f.value=null,console.log("Authenticating with magic code:",{eventId:B,code:R,isReauth:G});try{const Y=await vs.marshalLogin(B,R);if(console.log("Auth response:",Y.data),Y.data.success){localStorage.setItem("sessionToken",Y.data.sessionToken),localStorage.setItem(`marshal_${B}`,Y.data.marshalId),localStorage.setItem(`marshalCode_${B}`,R),p.value=Y.data.person,g.value=Y.data.marshalId,u.value=!0,console.log("Authenticated as marshal:",g.value,p.value?.name);try{const xe=await vs.getMe(B);k.value=xe.data,console.log("User claims:",k.value)}catch(xe){console.warn("Failed to fetch claims:",xe)}a.replace({path:s.path,query:{}}),Ei(),await Qs()}else f.value=Y.data.message||"Authentication failed"}catch(Y){console.error("Authentication failed:",Y),f.value=Y.response?.data?.message||"Invalid or expired login link"}finally{d.value=!1}},Si=async B=>{const R=localStorage.getItem("sessionToken"),G=localStorage.getItem(`marshal_${B}`),Y=localStorage.getItem(`marshalCode_${B}`);if(!R||!G)return Y?(console.log("No session but have stored code, attempting re-authentication..."),await yo(B,Y,!0),u.value):!1;try{const xe=await vs.getMe(B);if(xe.data&&xe.data.marshalId)return k.value=xe.data,p.value={personId:xe.data.personId,name:xe.data.personName,email:xe.data.personEmail},g.value=xe.data.marshalId,u.value=!0,Ei(),!0}catch(xe){if(console.log("Session validation failed, attempting re-authentication...",xe),Y)try{if(await yo(B,Y,!0),u.value)return console.log("Re-authentication successful"),!0}catch(Ze){console.error("Re-authentication failed:",Ze)}localStorage.removeItem("sessionToken"),localStorage.removeItem(`marshal_${B}`),localStorage.removeItem(`marshalCode_${B}`)}return!1},Qs=async()=>{const B=s.params.eventId;if(console.log("Loading event data for:",{eventId:B,marshalId:g.value}),hn()){console.log("Offline mode detected, attempting to load from cache...");const xe=await _i(B);if(xe){if(console.log("Loaded cached data from:",xe.cachedAt),H.value=xe.event,V.value=xe.areas||[],O.value=xe.locations||[],Qe.value=xe.checklist||[],mo.value=xe.contacts||[],W.value=xe.notes||[],xe.areaLeadDashboard?.checkpoints&&(Ae.value=xe.areaLeadDashboard.checkpoints),H.value&&du(H.value),g.value){const Ze=[];for(const vt of O.value){const Lt=vt.assignments?.find(un=>un.marshalId===g.value);Lt&&Ze.push(Lt)}q.value=Ze}return}else console.warn("No cached data available while offline")}console.log("Fetching event data in parallel...");const[R,G,Y]=await Promise.allSettled([Gi.getById(B),mi.getByEvent(B),dl.getEventStatus(B)]);if(R.status==="fulfilled"?(H.value=R.value.data,console.log("Event loaded:",H.value?.name),H.value&&du(H.value)):console.error("Failed to load event:",R.reason),G.status==="fulfilled"?(V.value=G.value.data||[],console.log("Areas loaded:",V.value.length)):console.error("Failed to load areas:",G.reason),Y.status==="fulfilled"){if(O.value=Y.value.data?.locations||[],console.log("Locations loaded:",O.value.length),g.value){const xe=[];for(const Ze of O.value){const vt=Ze.assignments?.find(Lt=>Lt.marshalId===g.value);vt&&xe.push(vt)}q.value=xe,console.log("Total assignments found:",q.value.length)}}else console.error("Failed to load event status:",Y.reason);await Promise.allSettled([at(),ws(),Oo(),qn()]);try{const xe=JSON.parse(JSON.stringify({event:H.value,areas:V.value,locations:O.value,checklist:Qe.value,contacts:mo.value,notes:W.value,marshalId:g.value}));await Dl(B,xe),console.log("Event data cached for offline access")}catch(xe){console.warn("Failed to cache event data:",xe)}Wn()},cn=async()=>{const B=s.params.eventId;if(hn()){console.log("Skipping background preload: offline");return}console.log("Starting background preload for offline data...");try{const R=await mi.getAreaLeadDashboard(B);if(R.data){Ae.value=R.data.checkpoints||[];const G=JSON.parse(JSON.stringify({areas:R.data.areas||[],checkpoints:R.data.checkpoints||[]}));await _i(B)?await ul(B,"areaLeadDashboard",G):await Dl(B,{areaLeadDashboard:G}),console.log("Area lead dashboard cached for offline access")}}catch(R){R.response?.status!==403&&console.warn("Failed to preload area lead dashboard:",R)}console.log("Background preload complete")},Oo=async()=>{const B=s.params.eventId;try{const R=await Ds.getMyNotes(B);W.value=R.data||[],Re.value.notes=Date.now(),console.log("Notes loaded:",W.value.length)}catch(R){console.error("Failed to load notes:",R)}},qn=async()=>{const B=s.params.eventId;ue.value=!0;try{const R=new Map;if(b.value&&_.value.length>0)for(const G of _.value)try{const xe=(await ps.getForArea(B,G)).data.incidents||[];for(const Ze of xe)R.set(Ze.incidentId,Ze)}catch(Y){console.warn(`Failed to load incidents for area ${G}:`,Y)}try{const Y=(await ps.getAll(B)).data.incidents||[];for(const xe of Y)xe.reportedBy?.marshalId===g.value&&R.set(xe.incidentId,xe)}catch(G){console.debug("Could not load all incidents:",G)}J.value=Array.from(R.values()).sort((G,Y)=>new Date(Y.incidentTime||Y.createdAt)-new Date(G.incidentTime||G.createdAt)),Re.value.incidents=Date.now(),console.log("My incidents loaded:",J.value.length)}catch(R){console.error("Failed to load incidents:",R)}finally{ue.value=!1}},ws=async()=>{const B=s.params.eventId;dt.value=!0;try{const R=await di.getMyContacts(B);mo.value=R.data||[],Re.value.eventContacts=Date.now(),console.log("Contacts loaded:",mo.value.length)}catch(R){console.warn("Failed to load contacts:",R),mo.value=[]}finally{dt.value=!1}},at=async(B=!1)=>{if(!g.value){console.warn("No marshal ID, skipping checklist load");return}B||(be.value=!0),ze.value=null;try{const R=s.params.eventId;console.log("Fetching checklist for marshal:",g.value);let Y=(await Pt.getMarshalChecklist(R,g.value)).data||[];if(b.value&&_.value.length>0){console.log("Fetching area checklists for areas:",_.value);const xe=_.value.map(Lt=>Pt.getAreaChecklist(R,Lt).catch(un=>(console.warn(`Failed to fetch checklist for area ${Lt}:`,un),{data:[]}))),Ze=await Promise.all(xe),vt=new Map;for(const Lt of Y){const un=`${Lt.itemId}_${Lt.completionContextType}_${Lt.completionContextId}`;vt.set(un,Lt)}for(const Lt of Ze)for(const un of Lt.data||[]){const ls=`${un.itemId}_${un.completionContextType}_${un.completionContextId}`;vt.has(ls)||vt.set(ls,un)}Y=Array.from(vt.values()),console.log("Merged checklist items:",Y.length)}Qe.value=Y,Re.value.checklist=Date.now(),console.log("Checklist loaded:",Qe.value.length,"items")}catch(R){console.error("Failed to load checklist:",R.response?.status,R.response?.data),ze.value=R.response?.data?.message||"Failed to load checklist"}finally{B||(be.value=!1)}},Jt=async B=>{if(fe.value)return;fe.value=!0;const R=s.params.eventId,G={marshalId:B.contextOwnerMarshalId||g.value,contextType:B.completionContextType,contextId:B.completionContextId,actorMarshalId:g.value};try{B.isCompleted?hn()?(await Nn("checklist_uncomplete",{eventId:R,itemId:B.itemId,data:G}),B.isCompleted=!1,B.completedAt=null,B.completedByActorName=null,await i()):(await Pt.uncomplete(R,B.itemId,G),await at(!0)):hn()?(await Nn("checklist_complete",{eventId:R,itemId:B.itemId,data:G}),B.isCompleted=!0,B.completedAt=new Date().toISOString(),B.completedByActorName=p.value?.name||"You",await i()):(await Pt.complete(R,B.itemId,G),await at(!0)),await ul(R,"checklist",JSON.parse(JSON.stringify(Qe.value)))}catch(Y){if(console.error("Failed to toggle checklist item:",Y),hn()||!Y.response){const xe=B.isCompleted?"checklist_uncomplete":"checklist_complete";await Nn(xe,{eventId:R,itemId:B.itemId,data:G}),B.isCompleted=!B.isCompleted,await i()}else ze.value=Y.response?.data?.message||"Failed to update checklist",setTimeout(()=>{ze.value=null},3e3)}finally{fe.value=!1}},_t=B=>{if(!B.completionContextType||!B.completionContextId)return null;if(B.completionContextType==="Checkpoint"){const R=O.value.find(Y=>Y.id===B.completionContextId);if(!R)return null;const G=R.description?` - ${R.description}`:"";return`At ${o.value.checkpoint} ${R.name}${G}`}if(B.completionContextType==="Area"){const R=V.value.find(G=>G.id===B.completionContextId);return R?`At ${o.value.area} ${R.name}`:null}return B.completionContextType==="Personal"?"Personal item":null},ei=()=>{if(!("geolocation"in navigator)){console.warn("Geolocation not supported");return}console.log("Starting location tracking..."),Gn=navigator.geolocation.watchPosition(B=>{Ot.value={lat:B.coords.latitude,lng:B.coords.longitude},po.value=Date.now()},B=>{console.warn("Geolocation error:",{1:"Location permission denied. Please allow location access in your browser settings.",2:"Location unavailable. Make sure GPS is enabled on your device.",3:"Location request timed out. Please try again."}[B.code]||B.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},Cs=()=>{Gn!==null&&(navigator.geolocation.clearWatch(Gn),Gn=null)},ti=async B=>{Je.value=B.id,tt.value=B.id,qe.value=null;const R=s.params.eventId;try{if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const G=await new Promise((xe,Ze)=>{navigator.geolocation.getCurrentPosition(xe,Ze,{enableHighAccuracy:!0,timeout:1e4})}),Y={eventId:R,assignmentId:B.id,latitude:G.coords.latitude,longitude:G.coords.longitude,manualCheckIn:!1};if(hn()){await Nn("checkin",Y);const xe=q.value.findIndex(Ze=>Ze.id===B.id);xe!==-1&&(q.value[xe]={...q.value[xe],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"GPS (pending)",checkInLatitude:G.coords.latitude,checkInLongitude:G.coords.longitude}),await i(),await ul(R,"locations",O.value)}else{const xe=await gs.checkIn(Y),Ze=q.value.findIndex(vt=>vt.id===B.id);Ze!==-1&&(q.value[Ze]=xe.data)}}catch(G){if(hn()||!G.response){const Y={eventId:R,assignmentId:B.id,latitude:Ot.value?.lat||null,longitude:Ot.value?.lng||null,manualCheckIn:!0};await Nn("checkin",Y);const xe=q.value.findIndex(Ze=>Ze.id===B.id);xe!==-1&&(q.value[xe]={...q.value[xe],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"Manual (pending)"}),await i()}else G.response?.data?.message?qe.value=G.response.data.message:G.message?qe.value=G.message:qe.value="Failed to check in. Please try manual check-in."}finally{Je.value=null,tt.value=null}},xi=B=>{gt.value="Manual Check-In",tn.value="Are you sure you want to check in manually? This should only be used if GPS is not available.",vn.value=async()=>{Je.value=B.id,tt.value=B.id,qe.value=null;const R=s.params.eventId,G={eventId:R,assignmentId:B.id,latitude:null,longitude:null,manualCheckIn:!0};try{if(hn()){await Nn("checkin",G);const Y=q.value.findIndex(xe=>xe.id===B.id);Y!==-1&&(q.value[Y]={...q.value[Y],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"Manual (pending)"}),await i(),await ul(R,"locations",O.value)}else{const Y=await gs.checkIn(G),xe=q.value.findIndex(Ze=>Ze.id===B.id);xe!==-1&&(q.value[xe]=Y.data)}}catch(Y){if(hn()||!Y.response){await Nn("checkin",G);const xe=q.value.findIndex(Ze=>Ze.id===B.id);xe!==-1&&(q.value[xe]={...q.value[xe],isCheckedIn:!0,checkInTime:new Date().toISOString(),checkInMethod:"Manual (pending)"}),await i()}else qe.value="Failed to check in manually. Please contact the admin."}finally{Je.value=null,tt.value=null}},Et.value=!0},_o=()=>{Et.value=!1,vn.value&&(vn.value(),vn.value=null)},Ls=()=>{Et.value=!1,vn.value=null},ko=(B,R)=>{En.value=B,Yt.value=R,to.value=!0},Xt=()=>{to.value=!1},ao=async B=>{An.value=!0;try{await ps.create(c.value,B),Hn.value=!1,qn(),ko("Incident Reported","An administrator will review it shortly.")}catch(R){console.error("Failed to report incident:",R),ko("Error",R.response?.data?.message||"Failed to report incident. Please try again.")}finally{An.value=!1}},na=B=>{ye.value=B,ae.value=!0},oa=async({incidentId:B,status:R})=>{try{await ps.updateStatus(c.value,B,{status:R});const G=J.value.find(Y=>Y.incidentId===B);G&&(G.status=R),ye.value?.incidentId===B&&(ye.value.status=R)}catch(G){console.error("Failed to update incident status:",G),ko("Error","Failed to update status. Please try again.")}},Ga=()=>{he.value="",ie.value=!0},ni=()=>{ie.value=!1,he.value=""},Ii=async()=>{if(!(!he.value.trim()||!ye.value)){De.value=!0;try{await ps.addNote(c.value,ye.value.incidentId,he.value.trim()),ni(),qn();const B=await ps.get(c.value,ye.value.incidentId);ye.value=B.data}catch(B){console.error("Failed to add note:",B),ko("Error","Failed to add note. Please try again.")}finally{De.value=!1}}},sa=B=>{oe.value=B,ve.value=null,se.value=null,Te.value=!0},ns=()=>{Te.value=!1,oe.value=null,ve.value=null,se.value=null,ct.value=!1},ct=T(!1),Za=()=>{ct.value=!0,Te.value=!1,re.value="map"},Cn=B=>{if(ct.value&&oe.value){oi(oe.value.locationId,B.lat,B.lng,"manual"),ct.value=!1,oe.value=null;return}if(Ao.value&&Qo.value){const R=Qo.value;gt.value="Update location",tn.value=`Update ${R.location?.name||"dynamic checkpoint"} to this location?`,vn.value=async()=>{await oi(R.locationId,B.lat,B.lng,"manual")},Et.value=!0}},os=B=>{if(!ct.value&&Ao.value&&Qo.value){const R=Qo.value;if(B.id===R.locationId)return;gt.value="Copy location",tn.value=`Copy location from "${B.name}" to ${R.location?.name||"your dynamic checkpoint"}?`,vn.value=async()=>{await oi(R.locationId,B.latitude,B.longitude,"checkpoint",B.id)},Et.value=!0}},oi=async(B,R,G,Y,xe=null)=>{te.value=!0;try{const Ze=s.params.eventId,vt={latitude:R,longitude:G,sourceType:Y};xe&&(vt.sourceCheckpointId=xe);const Lt=await Xn.updatePosition(Ze,B,vt);Lt.data.success&&(X.value&&ss(),Ss(B,Lt.data.latitude,Lt.data.longitude,Lt.data.lastLocationUpdate))}catch(Ze){console.error("Failed to update location:",Ze),Ze.response?.status===403?alert("You do not have permission to update this location."):alert("Failed to update location. Please try again.")}finally{te.value=!1}},si=()=>{ct.value=!1,Te.value=!0},$i=async()=>{if(oe.value){te.value=!0,ve.value=null;try{let B,R;if(Ot.value&&po.value&&Date.now()-po.value<3e4&&(B=Ot.value.lat,R=Ot.value.lng),!B||!R){if(!("geolocation"in navigator))throw new Error("Geolocation is not supported by your browser");const Ze=await new Promise((vt,Lt)=>{navigator.geolocation.getCurrentPosition(vt,Lt,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4})});B=Ze.coords.latitude,R=Ze.coords.longitude}const G=s.params.eventId,Y=oe.value.locationId,xe=await Xn.updatePosition(G,Y,{latitude:B,longitude:R,sourceType:"gps"});xe.data.success&&(se.value="Location updated successfully!",Ss(Y,xe.data.latitude,xe.data.longitude,xe.data.lastLocationUpdate),setTimeout(()=>ns(),1500))}catch(B){console.error("Failed to update location with GPS:",B),B.response?.status===403?ve.value="You do not have permission to update this location.":B.code===1?ve.value="Location access denied. Please enable location permissions.":B.code===2?ve.value="Unable to determine your location. Please try again.":B.code===3||B.message?.includes("Timeout")?ve.value="GPS timed out. Please ensure location services are enabled and try again.":ve.value="Failed to update location. Please try again."}finally{te.value=!1}}},ja=async B=>{if(!oe.value)return;const R=O.value.find(G=>G.id===B);if(!R){ve.value="Source checkpoint not found.";return}te.value=!0,ve.value=null;try{const G=s.params.eventId,Y=oe.value.locationId,xe=await Xn.updatePosition(G,Y,{latitude:R.latitude,longitude:R.longitude,sourceType:"checkpoint",sourceCheckpointId:B});xe.data.success&&(X.value&&ss(),se.value=`Location copied from ${R.name}!`,Ss(Y,xe.data.latitude,xe.data.longitude,xe.data.lastLocationUpdate),setTimeout(()=>ns(),1500))}catch(G){console.error("Failed to copy location from checkpoint:",G),G.response?.status===403?ve.value="You do not have permission to update this location.":ve.value="Failed to update location. Please try again."}finally{te.value=!1}},Ss=(B,R,G,Y)=>{const xe=O.value.find(Ze=>Ze.id===B);xe&&(xe.latitude=R,xe.longitude=G,xe.lastLocationUpdate=Y)},ia=B=>{X.value?ss():qa(B)},qa=B=>{X.value=!0,ii(B),N=setInterval(()=>{ii(B)},6e4)},ss=()=>{X.value=!1,N&&(clearInterval(N),N=null)},ii=async B=>{if(!(!B||!("geolocation"in navigator)))try{const R=await new Promise((xe,Ze)=>{navigator.geolocation.getCurrentPosition(xe,Ze,{enableHighAccuracy:!0,timeout:15e3})}),G=s.params.eventId,Y=B.locationId;await Xn.updatePosition(G,Y,{latitude:R.coords.latitude,longitude:R.coords.longitude,sourceType:"gps"}),Ss(Y,R.coords.latitude,R.coords.longitude,new Date().toISOString())}catch(R){console.warn("Auto-update location failed:",R)}},Wn=()=>{K||!O.value.some(R=>R.isDynamic||R.IsDynamic)||(K=setInterval(async()=>{try{const R=s.params.eventId,G=await Xn.getDynamicCheckpoints(R);if(G.data&&Array.isArray(G.data))for(const Y of G.data){const xe=O.value.find(Ze=>Ze.id===Y.checkpointId);xe&&(xe.latitude=Y.latitude,xe.longitude=Y.longitude,xe.lastLocationUpdate=Y.lastLocationUpdate)}}catch(R){console.warn("Failed to poll dynamic checkpoints:",R)}},6e4))},Wa=()=>{K&&(clearInterval(K),K=null)},aa=B=>B?.isDynamic===!0||B?.IsDynamic===!0,bo=async()=>{try{await vs.logout()}catch{}const B=s.params.eventId;localStorage.removeItem("sessionToken"),localStorage.removeItem(`marshal_${B}`),localStorage.removeItem(`marshalCode_${B}`),u.value=!1,p.value=null,g.value=null,q.value=[],Qe.value=[],on.value=[],a.push("/")},Ti=()=>{gt.value="Logout",tn.value=`Are you sure you want to logout${p.value?.name?`, ${p.value.name}`:""}?`,vn.value=bo,Et.value=!0},Ro=B=>B?new Date(B).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",is=B=>B?new Date(B).toLocaleString():"",la=(B,R)=>{if(!B&&!R)return"";const G=B?Ro(B):"?",Y=R?Ro(R):"?";return`${G} - ${Y}`},ra=B=>B?new Date(B).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",ca=B=>B?new Date(B).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",Mi=B=>B?B.replace(/([A-Z])/g," $1").replace(/^./,R=>R.toUpperCase()).trim():"",Ka=B=>B==="EmergencyContact",Ai=B=>{if(!B)return"";const R=B.resolvedStyleType||B.ResolvedStyleType,G=B.resolvedStyleBackgroundColor||B.ResolvedStyleBackgroundColor||B.resolvedStyleColor||B.ResolvedStyleColor,Y=B.resolvedStyleBorderColor||B.ResolvedStyleBorderColor,xe=B.resolvedStyleIconColor||B.ResolvedStyleIconColor,Ze=B.resolvedStyleBackgroundShape||B.ResolvedStyleBackgroundShape;return R&&R!=="default"||G||Y||xe||Ze&&Ze!=="circle"?fn({type:R||"circle",backgroundShape:Ze||"circle",backgroundColor:G||"#667eea",borderColor:Y||"#ffffff",iconColor:xe||"#ffffff",size:"75",outputSize:20}):`<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
    <circle cx="10" cy="10" r="8" fill="#667eea" stroke="#fff" stroke-width="1.5"/>
  </svg>`};Wt(async()=>{const B=s.params.eventId,R=s.query.code;Q.value=!0;try{R?await yo(B,R):await Si(B)&&await Qs()}finally{Q.value=!1}u.value&&(ei(),"requestIdleCallback"in window?requestIdleCallback(()=>{cn()},{timeout:5e3}):setTimeout(()=>{cn()},2e3))}),Ge(u,B=>{B?ei():Cs()}),Ge(()=>s.query.code,async B=>{if(B&&u.value){Q.value=!0;try{await yo(s.params.eventId,B)}finally{Q.value=!1}}}),Ge(H,B=>{B&&(document.title=`OnTheDay App - ${t.value.person}`)},{immediate:!0});let as=null;const Ei=()=>{as||(as=setInterval(async()=>{if(k.value?.marshalId)try{await vs.getMe(s.params.eventId)}catch(B){console.debug("Heartbeat failed:",B)}},300*1e3))},Pi=()=>{as&&(clearInterval(as),as=null)};return zn(()=>{Cs(),Pi(),ss(),Wa()}),(B,R)=>(v(),m("div",{class:"marshal-view",style:rt(de.value)},[Oe(xB),l("header",{class:pe(["header",`logo-${ke.value}`]),style:rt(Ee.value)},[Me.value&&ke.value==="cover"?(v(),m("div",IB,[l("img",{src:Me.value,alt:"Event logo",class:"header-logo-cover-img"},null,8,$B)])):P("",!0),u.value&&ke.value==="right"?(v(),m("button",{key:1,onClick:Ti,class:"btn-logout-icon btn-logout-left",style:rt({color:ge.value}),title:`Logout ${p.value?.name||""}`},[l("span",{innerHTML:j(yn)("logout")},null,8,MB)],12,TB)):P("",!0),Me.value&&ke.value==="left"?(v(),m("div",AB,[l("img",{src:Me.value,alt:"Event logo",class:"header-logo-img"},null,8,EB)])):P("",!0),l("div",PB,[l("div",{class:"header-title",style:rt({color:ge.value})},[H.value?(v(),m("h1",DB,w(H.value.name),1)):P("",!0),H.value?.eventDate?(v(),m("div",OB,w(ca(H.value.eventDate)),1)):P("",!0)],4),u.value?(v(),m("div",RB,[l("button",{onClick:R[0]||(R[0]=G=>Hn.value=!0),class:"btn-header-action btn-report-incident"}," Report Incident "),l("button",{onClick:R[1]||(R[1]=G=>an.value=!0),class:"btn-header-action btn-emergency"}," Emergency Info ")])):P("",!0)]),Me.value&&ke.value==="right"?(v(),m("div",BB,[l("img",{src:Me.value,alt:"Event logo",class:"header-logo-img"},null,8,NB)])):P("",!0),u.value&&ke.value!=="right"?(v(),m("button",{key:4,onClick:Ti,class:"btn-logout-icon btn-logout-right",style:rt({color:ge.value}),title:`Logout ${p.value?.name||""}`},[l("span",{innerHTML:j(yn)("logout")},null,8,UB)],12,FB)):P("",!0)],6),l("div",zB,[Q.value?(v(),m("div",HB,[...R[20]||(R[20]=[l("div",{class:"loading"},"Loading...",-1)])])):!u.value&&!f.value?(v(),m("div",VB,[R[21]||(R[21]=l("h2",null,"Welcome",-1)),R[22]||(R[22]=l("p",{class:"instruction"},"Please use the login link sent to you to access your marshal dashboard.",-1)),d.value?(v(),m("p",GB,"Authenticating...")):P("",!0)])):f.value?(v(),m("div",ZB,[R[23]||(R[23]=l("h2",null,"Login failed",-1)),l("p",jB,w(f.value),1),R[24]||(R[24]=l("p",{class:"instruction"},"Please contact the event organiser for a new login link.",-1))])):(v(),m("div",qB,[A.value||U.value?(v(),m("div",WB,[l("div",KB,[p.value?.email?(v(),m("span",YB,w(p.value.email),1)):P("",!0)]),A.value?(v(),m("div",JB,[l("button",{onClick:I,class:"btn-mode-switch"}," Switch to Admin ")])):U.value?(v(),m("div",XB,[...R[25]||(R[25]=[l("span",{class:"reauth-hint",title:"Login via admin flow to access admin features"}," Admin access requires re-login ",-1)])])):P("",!0)])):P("",!0),l("div",QB,[l("div",eN,[l("button",{class:pe(["accordion-header",{active:re.value==="map"}]),onClick:R[2]||(R[2]=G=>bn("map"))},[l("span",tN,[l("span",{class:"section-icon",innerHTML:j(yn)("course")},null,8,nN),Ke(" "+w(j(t).course)+" ",1),Ot.value?(v(),m("span",oN,"GPS Active")):(v(),m("span",sN,"GPS Inactive"))]),l("span",iN,w(re.value==="map"?"":"+"),1)],2),re.value==="map"?(v(),m("div",aN,[ct.value?(v(),m("div",lN,[l("span",null,[R[26]||(R[26]=Ke("Click on the map to set the new location for ",-1)),l("strong",null,w(oe.value?.location?.name),1)]),l("button",{onClick:si,class:"btn btn-secondary btn-sm"},"Cancel")])):P("",!0),l("div",rN,[Oe(ta,{ref_key:"courseMapRef",ref:Nt,locations:O.value,route:jn.value,center:Ht.value,zoom:15,"user-location":Ot.value,"highlight-location-ids":oo.value,"marshal-mode":!0,clickable:ct.value||Ao.value,"show-fullscreen":!0,"fullscreen-title":j(t).course,"fullscreen-header-style":Ee.value,"fullscreen-header-text-color":ge.value,"toolbar-actions":ks.value,"hide-recenter-button":!0,class:pe({"selecting-location":ct.value}),height:"100%",onMapClick:Cn,onLocationClick:os,onActionClick:Li,onVisibilityChange:bs},Cd({_:2},[ct.value?{name:"fullscreen-banner",fn:Ue(()=>[l("span",null,[R[27]||(R[27]=Ke("Click on the map to set the new location for ",-1)),l("strong",null,w(oe.value?.location?.name),1)]),l("button",{onClick:si,class:"btn btn-secondary btn-sm"},"Cancel")]),key:"0"}:void 0]),1032,["locations","route","center","user-location","highlight-location-ids","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions","class"])])])):P("",!0)]),l("div",cN,[l("button",{class:pe(["accordion-header",{active:re.value==="assignments"}]),onClick:R[3]||(R[3]=G=>bn("assignments"))},[l("span",uN,[l("span",{class:"section-icon",innerHTML:j(yn)("checkpoint")},null,8,dN),Ke(" Your "+w(q.value.length===1?j(o).checkpoint:j(o).checkpoints)+w(q.value.length>1?` (${q.value.length})`:""),1)]),l("span",hN,w(re.value==="assignments"?"":"+"),1)],2),re.value==="assignments"?(v(),m("div",fN,[q.value.length===0?(v(),m("div",pN,[l("p",null,"You don't have any "+w(j(o).checkpoint)+" assignments yet.",1)])):(v(),m("div",vN,[(v(!0),m(Se,null,Be(mn.value,G=>(v(),m("div",{key:G.id,class:"checkpoint-accordion-section"},[l("button",{class:pe(["checkpoint-accordion-header",{active:wn.value===G.id,"checked-in":G.effectiveIsCheckedIn}]),onClick:Y=>Zn(G.id)},[l("div",gN,[l("div",yN,[l("span",{class:"checkpoint-icon",innerHTML:Ai(G.location)},null,8,_N),G.effectiveIsCheckedIn?(v(),m("span",kN,"")):P("",!0),l("span",bN,w(G.location?.name||G.locationName),1),G.areaName?(v(),m("span",wN,w(G.areaName),1)):P("",!0),G.location?.startTime||G.location?.endTime?(v(),m("span",CN,w(la(G.location.startTime,G.location.endTime)),1)):P("",!0)]),G.location?.description?(v(),m("div",LN,w(G.location.description),1)):P("",!0)]),l("span",SN,w(wn.value===G.id?"":"+"),1)],10,mN),wn.value===G.id?(v(),m("div",xN,[G.location?(v(),m("div",IN,[Oe(ta,{ref_for:!0,ref:Y=>Jo(G.id,Y),locations:O.value,route:jn.value,center:{lat:G.location.latitude,lng:G.location.longitude},zoom:16,"user-location":Ot.value,"highlight-location-id":G.locationId,"marshal-mode":!0,"simplify-non-highlighted":!0,clickable:Ao.value,"show-fullscreen":!0,"fullscreen-title":G.location?.name||G.locationName,"fullscreen-header-style":Ee.value,"fullscreen-header-text-color":ge.value,"toolbar-actions":Rt(G.id),"hide-recenter-button":!0,height:"280px",onMapClick:Cn,onLocationClick:os,onActionClick:Y=>Xs(G,Y),onVisibilityChange:Y=>Js(G.id,Y)},Cd({_:2},[G.location?.isDynamic?{name:"fullscreen-footer",fn:Ue(()=>[l("button",{class:"btn btn-primary",onClick:Y=>sa(G)},[(v(),m("svg",TN,[...R[28]||(R[28]=[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"},null,-1)])])),R[29]||(R[29]=Ke(" Update location ",-1))],8,$N)]),key:"0"}:void 0]),1032,["locations","route","center","user-location","highlight-location-id","clickable","fullscreen-title","fullscreen-header-style","fullscreen-header-text-color","toolbar-actions","onActionClick","onVisibilityChange"])])):P("",!0),l("div",MN,[l("div",AN,w(j(t).people)+":",1),et(G.areaIds)?(v(),m("div",DN,[(v(!0),m(Se,null,Be(G.allMarshals,Y=>(v(),m("div",{key:Y.marshalId,class:pe(["marshal-card-mini",{"is-you":Y.marshalId===g.value,"checked-in":Y.effectiveIsCheckedIn,expanded:Vt.value===Y.marshalId}])},[l("button",{class:"marshal-card-header",onClick:xe=>Mo(Y.marshalId)},[l("span",RN,w(Y.marshalName)+w(Y.marshalId===g.value?" (you)":""),1),l("span",BN,[Y.effectiveIsCheckedIn?(v(),m("span",NN,"")):P("",!0),l("span",FN,w(Vt.value===Y.marshalId?"":"+"),1)])],8,ON),Vt.value===Y.marshalId?(v(),m("div",UN,[l("div",zN,[R[30]||(R[30]=l("span",{class:"detail-label"},"Status:",-1)),l("span",{class:pe(Y.effectiveIsCheckedIn?"status-checked-in":"status-not-checked-in")},w(Y.effectiveIsCheckedIn?"Checked in":"Not checked in"),3)]),Y.effectiveIsCheckedIn&&Y.checkInTime?(v(),m("div",HN,[R[31]||(R[31]=l("span",{class:"detail-label"},"Check-in time:",-1)),l("span",null,w(ho(Y.checkInTime)),1)])):P("",!0),Y.checkInMethod?(v(),m("div",VN,[R[32]||(R[32]=l("span",{class:"detail-label"},"Method:",-1)),l("span",null,w(ys(Y.checkInMethod)),1)])):P("",!0),Y.email?(v(),m("div",GN,[R[33]||(R[33]=l("span",{class:"detail-label"},"Email:",-1)),l("a",{href:"mailto:"+Y.email},w(Y.email),9,ZN)])):P("",!0),Y.phoneNumber?(v(),m("div",jN,[R[34]||(R[34]=l("span",{class:"detail-label"},"Phone:",-1)),l("a",{href:"tel:"+Y.phoneNumber},w(Y.phoneNumber),9,qN)])):P("",!0),Y.email||Y.phoneNumber?(v(),m("div",WN,[Y.phoneNumber?(v(),m("a",{key:0,href:"tel:"+Y.phoneNumber,class:"btn btn-sm btn-primary"},"Call",8,KN)):P("",!0),Y.phoneNumber?(v(),m("a",{key:1,href:"sms:"+Y.phoneNumber,class:"btn btn-sm btn-secondary"},"Text",8,YN)):P("",!0),Y.email?(v(),m("a",{key:2,href:"mailto:"+Y.email,class:"btn btn-sm btn-secondary"},"Email",8,JN)):P("",!0)])):P("",!0)])):P("",!0)],2))),128))])):(v(),m("div",EN,[(v(!0),m(Se,null,Be(G.allMarshals,Y=>(v(),m("span",{key:Y.marshalId,class:pe(["marshal-tag",{"is-you":Y.marshalId===g.value,"checked-in":Y.effectiveIsCheckedIn}])},[Ke(w(Y.marshalName)+w(Y.marshalId===g.value?" (you)":"")+" ",1),Y.effectiveIsCheckedIn?(v(),m("span",PN,"")):P("",!0)],2))),128))]))]),G.areaContacts.length>0?(v(),m("div",XN,[l("div",QN,w(j(t).area)+" contacts:",1),l("div",e7,[(v(!0),m(Se,null,Be(G.areaContacts,Y=>(v(),m("div",{key:Y.marshalId,class:"contact-item"},[l("div",t7,[l("div",n7,w(Y.marshalName),1),Y.role?(v(),m("div",o7,w(Y.role),1)):P("",!0),Y.phone?(v(),m("div",s7,w(Y.phone),1)):P("",!0),Y.email?(v(),m("div",i7,w(Y.email),1)):P("",!0)]),l("div",a7,[Y.phone?(v(),m("a",{key:0,href:`tel:${Y.phone}`,class:"contact-link"},[...R[35]||(R[35]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Ke(" Call ",-1)])],8,l7)):P("",!0),Y.phone?(v(),m("a",{key:1,href:`sms:${Y.phone}`,class:"contact-link"},[...R[36]||(R[36]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Ke(" Text ",-1)])],8,r7)):P("",!0),Y.email?(v(),m("a",{key:2,href:`mailto:${Y.email}`,class:"contact-link"},[...R[37]||(R[37]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Ke(" Email ",-1)])],8,c7)):P("",!0)])]))),128))])])):P("",!0),G.effectiveIsCheckedIn?(v(),m("div",u7,[R[39]||(R[39]=l("span",{class:"check-icon"},"",-1)),l("div",null,[R[38]||(R[38]=l("strong",null,"Checked In",-1)),l("p",d7,w(Ro(G.checkInTime)),1)])])):(v(),m("div",h7,[l("button",{onClick:Y=>ti(G),class:"btn btn-primary",disabled:Je.value===G.id,style:rt(ce.value)},w(Je.value===G.id?"Checking in...":"GPS Check-In"),13,f7),l("button",{onClick:Y=>xi(G),class:"btn btn-secondary",disabled:Je.value===G.id}," Manual ",8,p7)])),qe.value&&tt.value===G.id?(v(),m("div",v7,w(qe.value),1)):P("",!0),aa(G.location)?(v(),m("div",m7,[l("div",g7,[l("span",y7,"Dynamic "+w(G.location.resolvedCheckpointTerm||j(t).checkpoint),1),G.location.lastLocationUpdate?(v(),m("span",_7," Last updated: "+w(is(G.location.lastLocationUpdate)),1)):P("",!0)]),l("div",k7,[l("button",{onClick:Y=>sa(G),class:"btn btn-update-location",disabled:te.value},[...R[40]||(R[40]=[l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1),Ke(" Update location ",-1)])],8,b7),l("button",{onClick:Y=>ia(G),class:pe(["btn btn-auto-update",{active:X.value}]),title:X.value?"Stop auto-updating":"Auto-update every 60 seconds"},[R[41]||(R[41]=l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})],-1)),Ke(" "+w(X.value?"Stop":"Auto"),1)],10,w7)])])):P("",!0)])):P("",!0)]))),128))]))])):P("",!0)]),l("div",C7,[l("button",{class:pe(["accordion-header",{active:re.value==="checklist"}]),onClick:R[4]||(R[4]=G=>bn("checklist"))},[l("span",L7,[l("span",{class:"section-icon",innerHTML:j(yn)("checklist")},null,8,S7),Ke(" Your "+w(j(o).checklists)+" ("+w(vo.value)+" of "+w(Mt.value.length)+" complete) ",1)]),l("span",x7,w(re.value==="checklist"?"":"+"),1)],2),re.value==="checklist"?(v(),m("div",I7,[be.value?(v(),m("div",$7,"Loading checklist...")):ze.value?(v(),m("div",T7,w(ze.value),1)):Mt.value.length===0?(v(),m("div",M7,[l("p",null,"No "+w(j(o).checklists)+" for you.",1)])):b.value?(v(),m(Se,{key:3},[l("div",A7,[R[43]||(R[43]=l("h4",{class:"checklist-section-title"},"Your jobs",-1)),so.value.length===0?(v(),m("div",E7,[...R[42]||(R[42]=[l("p",null,"No jobs assigned to you.",-1)])])):(v(),m("div",P7,[(v(!0),m(Se,null,Be(so.value,G=>(v(),m("div",{key:`${G.itemId}_${G.completionContextType}_${G.completionContextId}`,class:"my-job-item"},[l("input",{type:"checkbox",checked:G.isCompleted,disabled:fe.value,onChange:Y=>Jt(G)},null,40,D7),l("span",{class:pe(["my-job-text",{completed:G.isCompleted}])},w(G.text),3)]))),128))]))]),Pn.value.length>0?(v(),m("div",O7,[l("h4",R7,"Your "+w(j(o).area)+"'s jobs",1),Oe(Zu,{items:mt.value,locations:O.value,areas:V.value,marshals:xt.value,onToggleComplete:Jt},null,8,["items","locations","areas","marshals"])])):P("",!0)],64)):(v(),m(Se,{key:4},[_s.value==="none"?(v(),m("div",B7,[(v(!0),m(Se,null,Be(Mt.value,G=>(v(),m("div",{key:`${G.itemId}_${G.completionContextType}_${G.completionContextId}`,class:pe(["checklist-item",{"item-completed":G.isCompleted}])},[l("div",N7,[l("input",{type:"checkbox",checked:G.isCompleted,disabled:!G.canBeCompletedByMe||fe.value,onChange:Y=>Jt(G)},null,40,F7)]),l("div",U7,[l("div",{class:pe(["item-text",{"text-completed":G.isCompleted}])},w(G.text),3),_t(G)?(v(),m("div",z7,w(_t(G)),1)):P("",!0),G.isCompleted?(v(),m("div",H7,[l("span",V7," Completed by "+w(G.completedByActorName||"Unknown"),1),l("span",G7,w(is(G.completedAt)),1)])):P("",!0)])],2))),128))])):(v(),m("div",Z7,[(v(!0),m(Se,null,Be(es.value,G=>(v(),m("div",{key:G.key,class:"checklist-group"},[l("button",{class:pe(["checklist-group-header",{expanded:Le.value===G.key,"all-complete":G.completedCount===G.items.length}]),onClick:Y=>ts(G.key)},[l("span",q7,w(G.name),1),l("span",W7,[l("span",K7,w(G.completedCount)+"/"+w(G.items.length),1),l("span",Y7,w(Le.value===G.key?"":"+"),1)])],10,j7),Le.value===G.key?(v(),m("div",J7,[(v(!0),m(Se,null,Be(G.items,Y=>(v(),m("div",{key:`${Y.itemId}_${Y.completionContextType}_${Y.completionContextId}`,class:pe(["checklist-item",{"item-completed":Y.isCompleted}])},[l("div",X7,[l("input",{type:"checkbox",checked:Y.isCompleted,disabled:!Y.canBeCompletedByMe||fe.value,onChange:xe=>Jt(Y)},null,40,Q7)]),l("div",eF,[l("div",{class:pe(["item-text",{"text-completed":Y.isCompleted}])},w(Y.text),3),Y.isCompleted?(v(),m("div",tF,[l("span",nF,w(Y.completedByActorName||"Unknown"),1),l("span",oF,w(is(Y.completedAt)),1)])):P("",!0)])],2))),128))])):P("",!0)]))),128))]))],64))])):P("",!0)]),It.value.length>0||dt.value?(v(),m("div",sF,[l("button",{class:pe(["accordion-header",{active:re.value==="eventContacts"}]),onClick:R[5]||(R[5]=G=>bn("eventContacts"))},[l("span",iF,[l("span",{class:"section-icon",innerHTML:j(yn)("contacts")},null,8,aF),Ke(" Your "+w(It.value.length===1?"contact":"contacts")+w(It.value.length>1?` (${It.value.length})`:""),1)]),l("span",lF,w(re.value==="eventContacts"?"":"+"),1)],2),re.value==="eventContacts"?(v(),m("div",rF,[dt.value?(v(),m("div",cF,"Loading contacts...")):(v(),m("div",uF,[(v(!0),m(Se,null,Be(It.value,G=>(v(),m("div",{key:G.contactId,class:pe(["contact-item",{"primary-contact":G.isPrimary}])},[l("div",dF,[l("div",hF,[G.isPrimary?(v(),m("span",fF,"")):P("",!0),l("span",pF,w(G.name),1),G.role?(v(),m("span",{key:1,class:pe(["contact-role-badge",{"emergency-role":Ka(G.role)}])},w(Mi(G.role)),3)):P("",!0)]),G.notes?(v(),m("div",vF,w(G.notes),1)):P("",!0),G.phone?(v(),m("div",mF,w(G.phone),1)):P("",!0),G.email?(v(),m("div",gF,w(G.email),1)):P("",!0)]),l("div",yF,[G.phone?(v(),m("a",{key:0,href:`tel:${G.phone}`,class:"contact-link"},[...R[44]||(R[44]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})],-1),Ke(" Call ",-1)])],8,_F)):P("",!0),G.phone?(v(),m("a",{key:1,href:`sms:${G.phone}`,class:"contact-link"},[...R[45]||(R[45]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})],-1),Ke(" Text ",-1)])],8,kF)):P("",!0),G.email?(v(),m("a",{key:2,href:`mailto:${G.email}`,class:"contact-link"},[...R[46]||(R[46]=[l("svg",{class:"contact-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Ke(" Email ",-1)])],8,bF)):P("",!0)])],2))),128))]))])):P("",!0)])):P("",!0),l("div",wF,[l("button",{class:pe(["accordion-header",{active:re.value==="notes"}]),onClick:R[6]||(R[6]=G=>bn("notes"))},[l("span",CF,[l("span",{class:"section-icon",innerHTML:j(yn)("notes")},null,8,LF),Ke(" Your "+w(W.value.length===1?"note":"notes")+w(W.value.length>1?` (${W.value.length})`:""),1)]),l("span",SF,w(re.value==="notes"?"":"+"),1)],2),re.value==="notes"?(v(),m("div",xF,[Oe(ac,{"event-id":j(s).params.eventId,"all-notes":W.value,locations:O.value,areas:V.value,assignments:q.value,"show-scope":!1,onNotesChanged:Oo},null,8,["event-id","all-notes","locations","areas","assignments"])])):P("",!0)]),J.value.length>0||ue.value?(v(),m("div",IF,[l("button",{class:pe(["accordion-header",{active:re.value==="incidents"}]),onClick:R[7]||(R[7]=G=>bn("incidents"))},[l("span",$F,[l("span",{class:"section-icon",innerHTML:j(yn)("incidents")},null,8,TF),Ke(" Your "+w(J.value.length===1?"incident":"incidents")+w(J.value.length>1?` (${J.value.length})`:""),1)]),l("span",MF,w(re.value==="incidents"?"":"+"),1)],2),re.value==="incidents"?(v(),m("div",AF,[ue.value?(v(),m("div",EF," Loading incidents... ")):J.value.length===0?(v(),m("div",PF,[...R[47]||(R[47]=[l("p",null,"No incidents to show.",-1)])])):(v(),m("div",DF,[(v(!0),m(Se,null,Be(J.value,G=>(v(),Ye(Zl,{key:G.incidentId,incident:G,onSelect:Y=>na(G)},null,8,["incident","onSelect"]))),128))]))])):P("",!0)])):P("",!0),b.value?(v(),m("div",OF,[l("button",{class:pe(["accordion-header",{active:re.value==="areaLead"}]),onClick:R[8]||(R[8]=G=>bn("areaLead"))},[l("span",RF,[l("span",{class:"section-icon",innerHTML:j(yn)("area")},null,8,BF),Ke(" Your "+w(E.value.length===1?j(o).area:j(o).areas)+w(E.value.length>1?` (${E.value.length})`:""),1)]),l("span",NF,w(re.value==="areaLead"?"":"+"),1)],2),re.value==="areaLead"?(v(),m("div",FF,[E.value.length>1?(v(),m("div",UF,[(v(!0),m(Se,null,Be(E.value,G=>(v(),m("button",{key:G.areaId,class:pe(["area-filter-pill",{selected:C.value.has(G.areaId)}]),style:rt(C.value.has(G.areaId)?{backgroundColor:G.color||"#667eea",borderColor:G.color||"#667eea"}:{}),onClick:Y=>M(G.areaId)},w(G.name),15,zF))),128))])):P("",!0),Oe(vB,{ref_key:"areaLeadRef",ref:ee,"event-id":j(s).params.eventId,"area-ids":D.value,"marshal-id":g.value,route:jn.value,onChecklistUpdated:at},null,8,["event-id","area-ids","marshal-id","route"])])):P("",!0)])):P("",!0),b.value&&St.value.length>0?(v(),m("div",HF,[l("button",{class:pe(["accordion-header",{active:re.value==="areaLeadMarshals"}]),onClick:R[9]||(R[9]=G=>bn("areaLeadMarshals"))},[l("span",VF,[l("span",{class:"section-icon",innerHTML:j(yn)("marshal")},null,8,GF),Ke(" Your "+w(St.value.length===1?j(o).person:j(o).people)+w(St.value.length>1?` (${St.value.length})`:""),1)]),l("span",ZF,w(re.value==="areaLeadMarshals"?"":"+"),1)],2),re.value==="areaLeadMarshals"?(v(),m("div",jF,[l("div",qF,[(v(!0),m(Se,null,Be(St.value,G=>(v(),m("div",{key:G.marshalId,class:"area-lead-marshal-item"},[l("button",{class:pe(["area-lead-marshal-header",{active:$e.value===G.marshalId,"is-checked-in":G.isCheckedIn}]),onClick:Y=>Ct(G.marshalId)},[l("div",KF,[l("div",YF,[l("span",JF,w(G.name),1),l("span",{class:pe(["check-status-badge",{"checked-in":G.isCheckedIn}])},w(G.isCheckedIn?"":""),3)]),l("div",XF,[l("span",QF,w(fo(G.checkpoints)),1),G.totalTaskCount>0?(v(),m("span",e9,w(G.completedTaskCount)+" / "+w(G.totalTaskCount)+" "+w(j(o).checklists)+" complete ",1)):P("",!0)])]),l("span",t9,w($e.value===G.marshalId?"":"+"),1)],10,WF),$e.value===G.marshalId?(v(),m("div",n9,[l("div",o9,[l("div",s9,[l("span",i9,[Ke(w(G.isCheckedIn?"Checked in":"Not checked in")+" ",1),G.isCheckedIn&&G.checkInTime?(v(),m("span",a9," at "+w(Ro(G.checkInTime)),1)):P("",!0)]),l("button",{onClick:Y=>At(G),class:pe(["checkin-action-btn",{"undo-btn":G.isCheckedIn}]),disabled:We.value===G.marshalId},w(We.value===G.marshalId?"...":G.isCheckedIn?"Undo check-in":"Check in"),11,l9)])]),G.email||G.phoneNumber?(v(),m("div",r9,[G.phoneNumber?(v(),m("a",{key:0,href:`tel:${G.phoneNumber}`,class:"contact-link"},w(G.phoneNumber),9,c9)):P("",!0),G.email?(v(),m("a",{key:1,href:`mailto:${G.email}`,class:"contact-link"},w(G.email),9,u9)):P("",!0)])):P("",!0),G.allTasks.length>0?(v(),m("div",d9,[l("div",h9,w(j(t).checklists),1),l("div",f9,[(v(!0),m(Se,null,Be(G.allTasks,Y=>(v(),m("div",{key:`${Y.itemId}-${Y.contextId}`,class:pe(["task-item",{"task-completed":Y.isCompleted}])},[l("input",{type:"checkbox",checked:Y.isCompleted,disabled:ot.value,onChange:xe=>Kt(Y,G)},null,40,p9),l("span",v9,w(Y.text),1)],2))),128))])])):(v(),m("div",m9," No "+w(j(o).checklists)+" assigned. ",1))])):P("",!0)]))),128))])])):P("",!0)])):P("",!0),H.value?.eventDate||H.value?.description?(v(),m("div",g9,[l("button",{class:pe(["accordion-header",{active:re.value==="eventDetails"}]),onClick:R[10]||(R[10]=G=>bn("eventDetails"))},[l("span",y9,[l("span",{class:"section-icon",innerHTML:j(yn)("event")},null,8,_9),R[48]||(R[48]=Ke(" Event details ",-1))]),l("span",k9,w(re.value==="eventDetails"?"":"+"),1)],2),re.value==="eventDetails"?(v(),m("div",b9,[l("div",w9,[H.value.eventDate?(v(),m("div",C9,[R[49]||(R[49]=l("span",{class:"detail-label"},"Date and time",-1)),l("span",L9,w(ra(H.value.eventDate)),1)])):P("",!0),H.value.description?(v(),m("div",S9,[R[50]||(R[50]=l("span",{class:"detail-label"},"Description",-1)),l("p",x9,w(H.value.description),1)])):P("",!0)])])):P("",!0)])):P("",!0)])]))]),Oe(QO,{show:an.value,contacts:Ws.value,notes:Ks.value,onClose:R[11]||(R[11]=G=>an.value=!1)},null,8,["show","contacts","notes"]),Oe(Tv,{show:Hn.value,"event-id":c.value||"",checkpoint:S.value,"initial-location":Ot.value,checkpoints:O.value,route:jn.value,onClose:R[12]||(R[12]=G=>Hn.value=!1),onSubmit:ao},null,8,["show","event-id","checkpoint","initial-location","checkpoints","route"]),Oe($v,{show:ae.value,incident:ye.value,route:jn.value,checkpoints:O.value,"can-manage":b.value,onClose:R[13]||(R[13]=G=>ae.value=!1),onStatusChange:oa,onOpenAddNote:Ga},null,8,["show","incident","route","checkpoints","can-manage"]),Oe(zt,{show:ie.value,title:"Add update",size:"small",onClose:ni},{footer:Ue(()=>[l("div",$9,[l("button",{type:"button",class:"btn btn-secondary",onClick:ni}," Cancel "),l("button",{type:"button",class:"btn btn-primary",onClick:Ii,disabled:!he.value.trim()||De.value},w(De.value?"Adding...":"Add update"),9,T9)])]),default:Ue(()=>[l("div",I9,[He(l("textarea",{"onUpdate:modelValue":R[14]||(R[14]=G=>he.value=G),class:"note-textarea",placeholder:"Enter your update...",rows:"4"},null,512),[[nt,he.value]])])]),_:1},8,["show"]),Oe(Ra,{show:Et.value,title:gt.value,message:tn.value,onConfirm:_o,onCancel:Ls},null,8,["show","title","message"]),Oe(Ra,{show:to.value,title:En.value,message:Yt.value,"show-cancel":!1,onConfirm:Xt},null,8,["show","title","message"]),Yo.value&&ln.value?(v(),m("div",{key:0,class:"modal-overlay",onClick:R[18]||(R[18]=ht(G=>Po(ln.value.id),["self"]))},[l("div",M9,[l("div",A9,[R[51]||(R[51]=l("h3",null,"Check-in reminder",-1)),l("button",{class:"modal-close",onClick:R[15]||(R[15]=G=>Po(ln.value.id))},"")]),l("div",E9,[R[53]||(R[53]=l("div",{class:"reminder-icon"},"",-1)),l("p",P9,[Ke(" You have not checked in yet to "+w(j(t).checkpoint.toLowerCase())+" ",1),l("strong",null,w(ln.value.location?.name),1),ln.value.location?.description?(v(),m("span",D9," - "+w(ln.value.location.description),1)):P("",!0),R[52]||(R[52]=Ke(". ",-1))]),l("p",O9," Please check in when you arrive at your "+w(j(t).checkpoint.toLowerCase())+". ",1)]),l("div",R9,[l("button",{onClick:R[16]||(R[16]=G=>Po(ln.value.id)),class:"btn btn-secondary"}," Dismiss "),l("button",{onClick:R[17]||(R[17]=G=>{Po(ln.value.id),re.value="assignments",wn.value=ln.value.id}),class:"btn btn-primary",style:rt(ce.value)}," Go to "+w(j(t).checkpoint),5)])])])):P("",!0),Te.value?(v(),m("div",{key:1,class:"modal-overlay",onClick:ht(ns,["self"])},[l("div",B9,[l("div",N9,[l("h3",null,"Update "+w((oe.value?.location?.resolvedCheckpointTerm||j(t).checkpoint).toLowerCase())+" location",1),l("button",{class:"modal-close",onClick:ns},"")]),l("div",F9,[se.value?(v(),m("div",U9,w(se.value),1)):(v(),m("div",z9,[l("p",H9,[R[54]||(R[54]=Ke(" Update the position of ",-1)),l("strong",null,w(oe.value?.location?.name),1)]),oe.value?.location?.lastLocationUpdate?(v(),m("div",V9," Last updated: "+w(is(oe.value.location.lastLocationUpdate)),1)):P("",!0),Ot.value?(v(),m("div",G9,[...R[55]||(R[55]=[l("svg",{class:"status-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1),Ke(" GPS active ",-1)])])):P("",!0),l("div",Z9,[l("button",{onClick:$i,class:"btn btn-primary btn-full",disabled:te.value,style:rt(ce.value)},[R[56]||(R[56]=l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),Ke(" "+w(te.value?"Updating...":"Use current GPS location"),1)],12,j9)]),l("div",q9,[l("label",W9,[l("input",{type:"checkbox",checked:X.value,onChange:R[19]||(R[19]=G=>ia(oe.value))},null,40,K9),R[57]||(R[57]=l("span",null,"Auto-update every 60 seconds",-1))]),l("p",Y9,"Automatically updates the "+w(j(o).checkpoint)+" location using your GPS every minute.",1)]),l("div",J9,[l("button",{onClick:Za,class:"btn btn-secondary btn-full",disabled:te.value},[...R[58]||(R[58]=[l("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"})],-1),Ke(" Select location on map ",-1)])],8,X9)]),l("div",Q9,[l("label",eU,"Or copy location from another "+w(j(o).checkpoint)+":",1),go.value.length>0?(v(),m("div",tU,[(v(!0),m(Se,null,Be(go.value,G=>(v(),m("button",{key:G.id,onClick:Y=>ja(G.id),class:"btn btn-secondary btn-checkpoint-source",disabled:te.value},w(G.name),9,nU))),128))])):(v(),m("p",oU," No other "+w(j(o).checkpoints)+" available to copy from. ",1))]),ve.value?(v(),m("div",sU,w(ve.value),1)):P("",!0)]))]),l("div",{class:"modal-footer"},[l("button",{onClick:ns,class:"btn btn-secondary"}," Cancel ")])])])):P("",!0)],4))}},lU=je(aU,[["__scopeId","data-v-b9817c36"]]),rU=[{path:"/",name:"Home",component:Uk},{path:"/admin/login",name:"AdminLogin",component:Wk},{path:"/admin/verify",name:"AdminVerify",component:tb},{path:"/admin/dashboard",name:"AdminDashboard",component:n0,meta:{requiresAuth:!0}},{path:"/admin/profile",name:"AdminProfile",component:$0,meta:{requiresAuth:!0}},{path:"/admin/event/:eventId",name:"AdminEventManage",component:OO,meta:{requiresAuth:!0}},{path:"/event/:eventId",name:"MarshalView",component:lU},{path:"/:pathMatch(.*)*",redirect:"/"}],Mv=R_({history:p_("/VolunteerCheckin/testing/"),routes:rU});Mv.beforeEach((e,t,o)=>{const i=localStorage.getItem("adminEmail");e.meta.requiresAuth&&!i?o({name:"AdminLogin"}):o()});qs().then(()=>{console.log("Offline database initialized")}).catch(e=>{console.warn("Failed to initialize offline database:",e)});const Wu=yy(Ty);Wu.use(by());Wu.use(Mv);Wu.mount("#app");
